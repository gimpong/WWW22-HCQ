Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 217.36518692970276 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 14.611334800720215 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 98.4012598991394 s.
Loading dataset MSRVTT_full_test in ram ...
Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 211.6974995136261 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 17.992865085601807 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 106.69628286361694 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 53.96823215484619 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch0.pth ...
Done in 1.371s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch0.pth ...
Done in 2.697s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.2012072434607646
 MSRVTT_full_val/t2v_metrics/R5: 0.4024144869215292
 MSRVTT_full_val/t2v_metrics/R10: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R50: 9.859154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 240.0
 MSRVTT_full_val/t2v_metrics/MeanR: 247.95774647887325
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.4606495945888659
 MSRVTT_full_val/v2t_metrics/R1: 0.4024144869215292
 MSRVTT_full_val/v2t_metrics/R5: 1.8108651911468814
 MSRVTT_full_val/v2t_metrics/R10: 2.6156941649899395
 MSRVTT_full_val/v2t_metrics/R50: 8.651911468812877
 MSRVTT_full_val/v2t_metrics/MedR: 248.0
 MSRVTT_full_val/v2t_metrics/MeanR: 249.13279678068412
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 1.2398873536718387
 MSRVTT_full_test/t2v_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/t2v_metrics/R5: 0.10033444816053512
 MSRVTT_full_test/t2v_metrics/R10: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R50: 1.806020066889632
 MSRVTT_full_test/t2v_metrics/MedR: 1486.5
 MSRVTT_full_test/t2v_metrics/MeanR: 1496.0063545150501
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.08765021385314037
 MSRVTT_full_test/v2t_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/v2t_metrics/R5: 0.10033444816053512
 MSRVTT_full_test/v2t_metrics/R10: 0.16722408026755853
 MSRVTT_full_test/v2t_metrics/R50: 1.705685618729097
 MSRVTT_full_test/v2t_metrics/MedR: 1462.0
 MSRVTT_full_test/v2t_metrics/MeanR: 1493.7871237458194
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.08248200917493209
 mnt_best       : 0.08765021385314037
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 0.10266 (QuantReg: 0.14085) QuantErr: 0.14085 batch_time=28.77063 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 0.09924 (QuantReg: 0.13802) QuantErr: 0.13802 batch_time=0.41313 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 0.09521 (QuantReg: 0.13885) QuantErr: 0.13885 batch_time=0.41030 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 0.08026 (QuantReg: 0.14070) QuantErr: 0.14070 batch_time=0.42695 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 0.06360 (QuantReg: 0.13927) QuantErr: 0.13927 batch_time=0.43996 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 0.05087 (QuantReg: 0.14004) QuantErr: 0.14004 batch_time=0.45513 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 0.04538 (QuantReg: 0.13844) QuantErr: 0.13844 batch_time=0.42956 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 0.03546 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.40936 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 0.03656 (QuantReg: 0.13712) QuantErr: 0.13712 batch_time=0.41907 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 0.03293 (QuantReg: 0.13854) QuantErr: 0.13854 batch_time=0.46113 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 0.03036 (QuantReg: 0.13872) QuantErr: 0.13872 batch_time=0.83663 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 0.02884 (QuantReg: 0.13710) QuantErr: 0.13710 batch_time=0.53509 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 0.02718 (QuantReg: 0.13387) QuantErr: 0.13387 batch_time=0.58686 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 0.02444 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.40951 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 0.02837 (QuantReg: 0.13350) QuantErr: 0.13350 batch_time=0.41837 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 0.02007 (QuantReg: 0.13642) QuantErr: 0.13642 batch_time=0.40631 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 0.02916 (QuantReg: 0.13871) QuantErr: 0.13871 batch_time=0.45813 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 0.02222 (QuantReg: 0.13644) QuantErr: 0.13644 batch_time=0.41396 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 0.02203 (QuantReg: 0.13590) QuantErr: 0.13590 batch_time=0.42499 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 0.01651 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.42005 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 0.02045 (QuantReg: 0.13469) QuantErr: 0.13469 batch_time=0.41661 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 0.01965 (QuantReg: 0.13766) QuantErr: 0.13766 batch_time=0.43747 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 0.01807 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=0.44190 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch1.pth ...
Done in 3.872s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch1.pth ...
Done in 7.572s
 epoch          : 1
 loss           : 0.0388739013671875
 quant_reg      : 0.13723494184017182
 quant_err      : 0.13723494184017182
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 6.237424547283702
 MSRVTT_full_val/t2v_metrics/R5: 24.346076458752513
 MSRVTT_full_val/t2v_metrics/R10: 41.24748490945674
 MSRVTT_full_val/t2v_metrics/R50: 84.90945674044265
 MSRVTT_full_val/t2v_metrics/MedR: 16.0
 MSRVTT_full_val/t2v_metrics/MeanR: 28.327967806841045
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 18.433618126319118
 MSRVTT_full_val/v2t_metrics/R1: 7.2434607645875255
 MSRVTT_full_val/v2t_metrics/R5: 29.979879275653925
 MSRVTT_full_val/v2t_metrics/R10: 45.47283702213279
 MSRVTT_full_val/v2t_metrics/R50: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/MedR: 12.0
 MSRVTT_full_val/v2t_metrics/MeanR: 26.030181086519114
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 21.45405291151144
 MSRVTT_full_test/t2v_metrics/R1: 1.806020066889632
 MSRVTT_full_test/t2v_metrics/R5: 6.622073578595318
 MSRVTT_full_test/t2v_metrics/R10: 11.806020066889632
 MSRVTT_full_test/t2v_metrics/R50: 37.324414715719065
 MSRVTT_full_test/t2v_metrics/MedR: 86.0
 MSRVTT_full_test/t2v_metrics/MeanR: 163.21839464882945
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 5.207229235340729
 MSRVTT_full_test/v2t_metrics/R1: 1.6722408026755853
 MSRVTT_full_test/v2t_metrics/R5: 8.060200668896321
 MSRVTT_full_test/v2t_metrics/R10: 14.147157190635452
 MSRVTT_full_test/v2t_metrics/R50: 41.67224080267559
 MSRVTT_full_test/v2t_metrics/MedR: 68.0
 MSRVTT_full_test/v2t_metrics/MeanR: 148.54882943143812
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 5.755785707533093
 mnt_best       : 5.207229235340729
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 0.01566 (QuantReg: 0.13633) QuantErr: 0.13633 batch_time=37.47107 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 0.02530 (QuantReg: 0.13729) QuantErr: 0.13729 batch_time=0.42947 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 0.01466 (QuantReg: 0.13659) QuantErr: 0.13659 batch_time=0.40573 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 0.01605 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=0.40388 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 0.02158 (QuantReg: 0.13925) QuantErr: 0.13925 batch_time=0.41767 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 0.01892 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.41906 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 0.01846 (QuantReg: 0.13478) QuantErr: 0.13478 batch_time=0.42248 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 0.01663 (QuantReg: 0.13576) QuantErr: 0.13576 batch_time=0.41293 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 0.01453 (QuantReg: 0.13838) QuantErr: 0.13838 batch_time=0.85529 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 0.01240 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.40585 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 0.01416 (QuantReg: 0.13831) QuantErr: 0.13831 batch_time=0.42658 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 0.01584 (QuantReg: 0.13656) QuantErr: 0.13656 batch_time=0.42465 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 0.01401 (QuantReg: 0.13798) QuantErr: 0.13798 batch_time=0.41912 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 0.01297 (QuantReg: 0.13895) QuantErr: 0.13895 batch_time=2.03916 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 0.01201 (QuantReg: 0.13696) QuantErr: 0.13696 batch_time=0.42498 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 0.02020 (QuantReg: 0.13458) QuantErr: 0.13458 batch_time=0.41245 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 0.01770 (QuantReg: 0.13506) QuantErr: 0.13506 batch_time=0.41917 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 0.01254 (QuantReg: 0.13451) QuantErr: 0.13451 batch_time=0.43627 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 0.01552 (QuantReg: 0.13624) QuantErr: 0.13624 batch_time=0.40420 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 0.01639 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=0.41065 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 0.01306 (QuantReg: 0.13699) QuantErr: 0.13699 batch_time=0.42130 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 0.01559 (QuantReg: 0.13553) QuantErr: 0.13553 batch_time=0.54766 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 0.01337 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.40763 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch2.pth ...
Done in 3.816s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch2.pth ...
Done in 7.525s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 0.016006423950195314
 quant_reg      : 0.13628272491693497
 quant_err      : 0.13628272491693497
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 9.6579476861167
 MSRVTT_full_val/t2v_metrics/R5: 35.61368209255533
 MSRVTT_full_val/t2v_metrics/R10: 53.31991951710262
 MSRVTT_full_val/t2v_metrics/R50: 90.14084507042253
 MSRVTT_full_val/t2v_metrics/MedR: 10.0
 MSRVTT_full_val/t2v_metrics/MeanR: 19.227364185110662
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 26.37123105106504
 MSRVTT_full_val/v2t_metrics/R1: 12.474849094567404
 MSRVTT_full_val/v2t_metrics/R5: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R10: 57.74647887323944
 MSRVTT_full_val/v2t_metrics/R50: 92.95774647887323
 MSRVTT_full_val/v2t_metrics/MedR: 8.0
 MSRVTT_full_val/v2t_metrics/MeanR: 16.663983903420522
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 30.4089937951046
 MSRVTT_full_test/t2v_metrics/R1: 3.3444816053511706
 MSRVTT_full_test/t2v_metrics/R5: 11.103678929765886
 MSRVTT_full_test/t2v_metrics/R10: 17.959866220735787
 MSRVTT_full_test/t2v_metrics/R50: 50.903010033444815
 MSRVTT_full_test/t2v_metrics/MedR: 49.0
 MSRVTT_full_test/t2v_metrics/MeanR: 108.29331103678929
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 8.73707911178362
 MSRVTT_full_test/v2t_metrics/R1: 3.6454849498327757
 MSRVTT_full_test/v2t_metrics/R5: 12.474916387959865
 MSRVTT_full_test/v2t_metrics/R10: 21.505016722408026
 MSRVTT_full_test/v2t_metrics/R50: 55.45150501672241
 MSRVTT_full_test/v2t_metrics/MedR: 42.0
 MSRVTT_full_test/v2t_metrics/MeanR: 95.86688963210702
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 9.926075614653227
 mnt_best       : 8.73707911178362
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 0.01253 (QuantReg: 0.13341) QuantErr: 0.13341 batch_time=33.45087 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 0.01060 (QuantReg: 0.13862) QuantErr: 0.13862 batch_time=0.43376 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 0.01500 (QuantReg: 0.13503) QuantErr: 0.13503 batch_time=0.44092 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 0.01086 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=0.42564 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 0.01105 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.41720 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 0.00971 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.47050 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 0.01350 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=0.42067 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 0.01714 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.42014 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 0.01260 (QuantReg: 0.13663) QuantErr: 0.13663 batch_time=0.43863 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 0.01418 (QuantReg: 0.13390) QuantErr: 0.13390 batch_time=0.42301 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 0.01363 (QuantReg: 0.13679) QuantErr: 0.13679 batch_time=0.44218 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 0.00887 (QuantReg: 0.13401) QuantErr: 0.13401 batch_time=0.46466 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 0.01254 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=2.86594 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 0.01054 (QuantReg: 0.13682) QuantErr: 0.13682 batch_time=0.48104 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 0.01285 (QuantReg: 0.13423) QuantErr: 0.13423 batch_time=0.43272 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 0.00864 (QuantReg: 0.13370) QuantErr: 0.13370 batch_time=0.44418 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 0.01013 (QuantReg: 0.13301) QuantErr: 0.13301 batch_time=0.45482 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 0.01283 (QuantReg: 0.13543) QuantErr: 0.13543 batch_time=0.44783 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 0.01160 (QuantReg: 0.13492) QuantErr: 0.13492 batch_time=0.42941 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 0.00822 (QuantReg: 0.13401) QuantErr: 0.13401 batch_time=0.42276 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 0.01064 (QuantReg: 0.13549) QuantErr: 0.13549 batch_time=0.42215 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 0.01180 (QuantReg: 0.13399) QuantErr: 0.13399 batch_time=0.44202 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 0.00919 (QuantReg: 0.13277) QuantErr: 0.13277 batch_time=0.42062 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch3.pth ...
Done in 3.578s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch3.pth ...
Done in 6.859s
removing stale ckpt [epoch 2] [took 0.31s]
 epoch          : 3
 loss           : 0.01211529541015625
 quant_reg      : 0.13510741955041886
 quant_err      : 0.13510741955041886
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 12.474849094567404
 MSRVTT_full_val/t2v_metrics/R5: 45.87525150905432
 MSRVTT_full_val/t2v_metrics/R10: 62.776659959758554
 MSRVTT_full_val/t2v_metrics/R50: 95.37223340040241
 MSRVTT_full_val/t2v_metrics/MedR: 6.0
 MSRVTT_full_val/t2v_metrics/MeanR: 14.585513078470825
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 32.99671113182316
 MSRVTT_full_val/v2t_metrics/R1: 13.682092555331993
 MSRVTT_full_val/v2t_metrics/R5: 47.88732394366197
 MSRVTT_full_val/v2t_metrics/R10: 68.00804828973843
 MSRVTT_full_val/v2t_metrics/R50: 94.76861167002012
 MSRVTT_full_val/v2t_metrics/MedR: 6.0
 MSRVTT_full_val/v2t_metrics/MeanR: 13.722334004024145
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 35.45230426663663
 MSRVTT_full_test/t2v_metrics/R1: 4.147157190635451
 MSRVTT_full_test/t2v_metrics/R5: 15.518394648829432
 MSRVTT_full_test/t2v_metrics/R10: 24.013377926421406
 MSRVTT_full_test/t2v_metrics/R50: 60.635451505016725
 MSRVTT_full_test/t2v_metrics/MedR: 34.0
 MSRVTT_full_test/t2v_metrics/MeanR: 82.19297658862877
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 11.561570941018749
 MSRVTT_full_test/v2t_metrics/R1: 3.879598662207358
 MSRVTT_full_test/v2t_metrics/R5: 16.387959866220736
 MSRVTT_full_test/v2t_metrics/R10: 26.65551839464883
 MSRVTT_full_test/v2t_metrics/R50: 63.57859531772575
 MSRVTT_full_test/v2t_metrics/MedR: 29.0
 MSRVTT_full_test/v2t_metrics/MeanR: 73.64598662207358
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 11.922471013419765
 mnt_best       : 11.561570941018749
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 0.01155 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=30.59860 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 0.01061 (QuantReg: 0.13819) QuantErr: 0.13819 batch_time=0.41859 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 0.01285 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.48541 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 0.01006 (QuantReg: 0.13472) QuantErr: 0.13472 batch_time=0.45443 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 0.00916 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.41670 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 0.01132 (QuantReg: 0.13288) QuantErr: 0.13288 batch_time=0.42111 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 0.01250 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.43494 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 0.00887 (QuantReg: 0.13409) QuantErr: 0.13409 batch_time=0.43651 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 0.01027 (QuantReg: 0.13392) QuantErr: 0.13392 batch_time=0.42680 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 0.01073 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=0.43775 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 0.00967 (QuantReg: 0.13521) QuantErr: 0.13521 batch_time=0.41947 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 0.01186 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.48048 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 0.01405 (QuantReg: 0.13230) QuantErr: 0.13230 batch_time=0.41739 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 0.01564 (QuantReg: 0.13360) QuantErr: 0.13360 batch_time=3.92669 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 0.01151 (QuantReg: 0.13347) QuantErr: 0.13347 batch_time=0.45414 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 0.01089 (QuantReg: 0.13484) QuantErr: 0.13484 batch_time=0.42004 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 0.01151 (QuantReg: 0.13490) QuantErr: 0.13490 batch_time=0.43869 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 0.00903 (QuantReg: 0.13611) QuantErr: 0.13611 batch_time=0.42883 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 0.00793 (QuantReg: 0.13711) QuantErr: 0.13711 batch_time=1.22904 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 0.01165 (QuantReg: 0.13417) QuantErr: 0.13417 batch_time=0.43223 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 0.00744 (QuantReg: 0.13632) QuantErr: 0.13632 batch_time=0.42548 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 0.00932 (QuantReg: 0.13716) QuantErr: 0.13716 batch_time=0.43068 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 0.00781 (QuantReg: 0.13581) QuantErr: 0.13581 batch_time=0.43745 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch4.pth ...
Done in 3.868s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch4.pth ...
Done in 7.423s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 0.010452835083007813
 quant_reg      : 0.1350173153281212
 quant_err      : 0.1350173153281212
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 15.694164989939638
 MSRVTT_full_val/t2v_metrics/R5: 43.86317907444668
 MSRVTT_full_val/t2v_metrics/R10: 63.58148893360161
 MSRVTT_full_val/t2v_metrics/R50: 94.56740442655935
 MSRVTT_full_val/t2v_metrics/MedR: 7.0
 MSRVTT_full_val/t2v_metrics/MeanR: 14.3158953722334
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 35.241658427972446
 MSRVTT_full_val/v2t_metrics/R1: 15.694164989939638
 MSRVTT_full_val/v2t_metrics/R5: 49.496981891348085
 MSRVTT_full_val/v2t_metrics/R10: 68.2092555331992
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 6.0
 MSRVTT_full_val/v2t_metrics/MeanR: 13.283702213279678
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 37.55952407595598
 MSRVTT_full_test/t2v_metrics/R1: 4.214046822742475
 MSRVTT_full_test/t2v_metrics/R5: 15.384615384615385
 MSRVTT_full_test/t2v_metrics/R10: 26.02006688963211
 MSRVTT_full_test/t2v_metrics/R50: 61.77257525083612
 MSRVTT_full_test/t2v_metrics/MedR: 31.0
 MSRVTT_full_test/t2v_metrics/MeanR: 77.37224080267559
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 11.904143028017932
 MSRVTT_full_test/v2t_metrics/R1: 5.117056856187291
 MSRVTT_full_test/v2t_metrics/R5: 18.22742474916388
 MSRVTT_full_test/v2t_metrics/R10: 29.331103678929765
 MSRVTT_full_test/v2t_metrics/R50: 66.45484949832776
 MSRVTT_full_test/v2t_metrics/MedR: 27.0
 MSRVTT_full_test/v2t_metrics/MeanR: 67.93645484949833
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 13.985929041709772
 mnt_best       : 11.904143028017932
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 0.00874 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=33.97293 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 0.00608 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.43339 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 0.00854 (QuantReg: 0.13524) QuantErr: 0.13524 batch_time=0.41802 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 0.01036 (QuantReg: 0.13684) QuantErr: 0.13684 batch_time=0.42070 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 0.01196 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=0.41057 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 0.01059 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.44381 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 0.01013 (QuantReg: 0.13693) QuantErr: 0.13693 batch_time=0.42809 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 0.01320 (QuantReg: 0.13368) QuantErr: 0.13368 batch_time=0.45618 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 0.00742 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.44965 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 0.01286 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.45112 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 0.00755 (QuantReg: 0.13666) QuantErr: 0.13666 batch_time=0.44220 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 0.01175 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.42724 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 0.00777 (QuantReg: 0.13544) QuantErr: 0.13544 batch_time=1.62501 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 0.00920 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.43059 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 0.00759 (QuantReg: 0.13569) QuantErr: 0.13569 batch_time=0.44260 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 0.00798 (QuantReg: 0.13748) QuantErr: 0.13748 batch_time=0.42352 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 0.00944 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.44893 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 0.00692 (QuantReg: 0.13735) QuantErr: 0.13735 batch_time=0.67915 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 0.00885 (QuantReg: 0.13613) QuantErr: 0.13613 batch_time=0.43935 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 0.00993 (QuantReg: 0.13731) QuantErr: 0.13731 batch_time=0.45126 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 0.01174 (QuantReg: 0.13401) QuantErr: 0.13401 batch_time=0.42931 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 0.01120 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.41578 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 0.00624 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.41972 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch5.pth ...
Done in 14.796s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch5.pth ...
Done in 18.484s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 0.00920770263671875
 quant_reg      : 0.13603034764528274
 quant_err      : 0.13603034764528274
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 15.090543259557345
 MSRVTT_full_val/t2v_metrics/R5: 47.686116700201204
 MSRVTT_full_val/t2v_metrics/R10: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R50: 94.16498993963782
 MSRVTT_full_val/t2v_metrics/MedR: 6.0
 MSRVTT_full_val/t2v_metrics/MeanR: 13.561368209255534
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 36.28703311295852
 MSRVTT_full_val/v2t_metrics/R1: 19.517102615694164
 MSRVTT_full_val/v2t_metrics/R5: 51.7102615694165
 MSRVTT_full_val/v2t_metrics/R10: 68.81287726358148
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.122736418511066
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 41.10430086913212
 MSRVTT_full_test/t2v_metrics/R1: 5.68561872909699
 MSRVTT_full_test/t2v_metrics/R5: 17.892976588628763
 MSRVTT_full_test/t2v_metrics/R10: 27.959866220735787
 MSRVTT_full_test/t2v_metrics/R50: 63.812709030100336
 MSRVTT_full_test/t2v_metrics/MedR: 29.0
 MSRVTT_full_test/t2v_metrics/MeanR: 73.09615384615384
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 14.168758737492707
 MSRVTT_full_test/v2t_metrics/R1: 5.451505016722408
 MSRVTT_full_test/v2t_metrics/R5: 20.066889632107024
 MSRVTT_full_test/v2t_metrics/R10: 31.137123745819398
 MSRVTT_full_test/v2t_metrics/R50: 68.56187290969899
 MSRVTT_full_test/v2t_metrics/MedR: 23.0
 MSRVTT_full_test/v2t_metrics/MeanR: 62.832107023411375
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 15.046136250652742
 mnt_best       : 14.168758737492707
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 0.00865 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=32.31959 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 0.01135 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=1.14959 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 0.00826 (QuantReg: 0.13488) QuantErr: 0.13488 batch_time=0.42836 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 0.01044 (QuantReg: 0.13607) QuantErr: 0.13607 batch_time=0.40855 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 0.00964 (QuantReg: 0.13559) QuantErr: 0.13559 batch_time=0.41384 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 0.00941 (QuantReg: 0.13865) QuantErr: 0.13865 batch_time=0.43603 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 0.00683 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=4.45451 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 0.00867 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=0.41619 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 0.00900 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.44213 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 0.00671 (QuantReg: 0.13648) QuantErr: 0.13648 batch_time=0.71251 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 0.00702 (QuantReg: 0.13590) QuantErr: 0.13590 batch_time=0.41047 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 0.00935 (QuantReg: 0.13676) QuantErr: 0.13676 batch_time=0.40620 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 0.01518 (QuantReg: 0.13460) QuantErr: 0.13460 batch_time=0.41544 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 0.00677 (QuantReg: 0.13347) QuantErr: 0.13347 batch_time=2.65052 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 0.00608 (QuantReg: 0.13395) QuantErr: 0.13395 batch_time=0.42695 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 0.00729 (QuantReg: 0.13489) QuantErr: 0.13489 batch_time=0.41845 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 0.01131 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=0.41901 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 0.00694 (QuantReg: 0.13662) QuantErr: 0.13662 batch_time=0.41769 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 0.00569 (QuantReg: 0.13647) QuantErr: 0.13647 batch_time=0.41562 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 0.00737 (QuantReg: 0.13897) QuantErr: 0.13897 batch_time=0.41778 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 0.00687 (QuantReg: 0.13525) QuantErr: 0.13525 batch_time=0.41865 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 0.00959 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.41433 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 0.00604 (QuantReg: 0.13640) QuantErr: 0.13640 batch_time=0.41887 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch6.pth ...
Done in 8.713s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 0.008135498046875
 quant_reg      : 0.13588493889570236
 quant_err      : 0.13588493889570236
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 14.88933601609658
 MSRVTT_full_val/t2v_metrics/R5: 44.46680080482897
 MSRVTT_full_val/t2v_metrics/R10: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R50: 94.56740442655935
 MSRVTT_full_val/t2v_metrics/MedR: 7.0
 MSRVTT_full_val/t2v_metrics/MeanR: 13.818913480885312
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 34.565181393953026
 MSRVTT_full_val/v2t_metrics/R1: 21.52917505030181
 MSRVTT_full_val/v2t_metrics/R5: 54.32595573440644
 MSRVTT_full_val/v2t_metrics/R10: 72.03219315895372
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.146881287726359
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 43.83830973193508
 MSRVTT_full_test/t2v_metrics/R1: 5.117056856187291
 MSRVTT_full_test/t2v_metrics/R5: 18.494983277591974
 MSRVTT_full_test/t2v_metrics/R10: 28.762541806020067
 MSRVTT_full_test/t2v_metrics/R50: 66.22073578595318
 MSRVTT_full_test/t2v_metrics/MedR: 27.0
 MSRVTT_full_test/t2v_metrics/MeanR: 70.69598662207358
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 13.962627421362493
 MSRVTT_full_test/v2t_metrics/R1: 6.120401337792642
 MSRVTT_full_test/v2t_metrics/R5: 21.505016722408026
 MSRVTT_full_test/v2t_metrics/R10: 33.979933110367895
 MSRVTT_full_test/v2t_metrics/R50: 71.03678929765886
 MSRVTT_full_test/v2t_metrics/MedR: 21.0
 MSRVTT_full_test/v2t_metrics/MeanR: 60.78260869565217
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 16.475833781647236
 mnt_best       : 14.168758737492707
 not_improved_count: 1
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 0.00870 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=42.38554 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 0.00832 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=0.42698 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 0.00996 (QuantReg: 0.13373) QuantErr: 0.13373 batch_time=0.44229 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 0.00903 (QuantReg: 0.13290) QuantErr: 0.13290 batch_time=0.44796 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 0.00572 (QuantReg: 0.13294) QuantErr: 0.13294 batch_time=0.41595 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 0.00877 (QuantReg: 0.13443) QuantErr: 0.13443 batch_time=0.42122 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 0.00750 (QuantReg: 0.13537) QuantErr: 0.13537 batch_time=1.61495 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 0.00602 (QuantReg: 0.13409) QuantErr: 0.13409 batch_time=0.42122 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 0.00569 (QuantReg: 0.13669) QuantErr: 0.13669 batch_time=0.42909 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 0.00894 (QuantReg: 0.13485) QuantErr: 0.13485 batch_time=0.44725 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 0.00757 (QuantReg: 0.13328) QuantErr: 0.13328 batch_time=0.45966 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 0.00595 (QuantReg: 0.13511) QuantErr: 0.13511 batch_time=0.41950 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 0.00740 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.40953 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 0.00667 (QuantReg: 0.13409) QuantErr: 0.13409 batch_time=0.42697 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 0.00917 (QuantReg: 0.13830) QuantErr: 0.13830 batch_time=0.42050 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 0.00568 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=0.42877 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 0.00758 (QuantReg: 0.13511) QuantErr: 0.13511 batch_time=0.45574 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 0.00528 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.42181 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 0.00730 (QuantReg: 0.13456) QuantErr: 0.13456 batch_time=0.40744 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 0.00529 (QuantReg: 0.13718) QuantErr: 0.13718 batch_time=2.15314 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 0.00583 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.43380 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 0.00662 (QuantReg: 0.13502) QuantErr: 0.13502 batch_time=0.42996 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 0.00576 (QuantReg: 0.13908) QuantErr: 0.13908 batch_time=0.43032 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch7.pth ...
Done in 3.417s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch7.pth ...
Done in 7.080s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 0.00735614013671875
 quant_reg      : 0.1352961921095848
 quant_err      : 0.1352961921095848
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 17.10261569416499
 MSRVTT_full_val/t2v_metrics/R5: 50.70422535211268
 MSRVTT_full_val/t2v_metrics/R10: 70.82494969818913
 MSRVTT_full_val/t2v_metrics/R50: 94.96981891348088
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.591549295774648
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 39.45460089306212
 MSRVTT_full_val/v2t_metrics/R1: 21.52917505030181
 MSRVTT_full_val/v2t_metrics/R5: 59.55734406438632
 MSRVTT_full_val/v2t_metrics/R10: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 11.03420523138833
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 45.90703001974047
 MSRVTT_full_test/t2v_metrics/R1: 5.986622073578595
 MSRVTT_full_test/t2v_metrics/R5: 19.732441471571907
 MSRVTT_full_test/t2v_metrics/R10: 30.96989966555184
 MSRVTT_full_test/t2v_metrics/R50: 66.5886287625418
 MSRVTT_full_test/t2v_metrics/MedR: 26.0
 MSRVTT_full_test/t2v_metrics/MeanR: 71.29197324414716
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.408752807197152
 MSRVTT_full_test/v2t_metrics/R1: 6.989966555183947
 MSRVTT_full_test/v2t_metrics/R5: 23.34448160535117
 MSRVTT_full_test/v2t_metrics/R10: 35.31772575250836
 MSRVTT_full_test/v2t_metrics/R50: 72.3076923076923
 MSRVTT_full_test/v2t_metrics/MedR: 19.0
 MSRVTT_full_test/v2t_metrics/MeanR: 57.907023411371235
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.928777902682423
 mnt_best       : 15.408752807197152
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 0.00512 (QuantReg: 0.13599) QuantErr: 0.13599 batch_time=45.26411 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 0.00549 (QuantReg: 0.13645) QuantErr: 0.13645 batch_time=1.05709 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 0.00542 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.41288 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 0.00633 (QuantReg: 0.13728) QuantErr: 0.13728 batch_time=0.51898 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 0.00771 (QuantReg: 0.13688) QuantErr: 0.13688 batch_time=0.43224 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 0.00706 (QuantReg: 0.13566) QuantErr: 0.13566 batch_time=0.42124 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 0.00664 (QuantReg: 0.13765) QuantErr: 0.13765 batch_time=0.42831 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 0.00810 (QuantReg: 0.13499) QuantErr: 0.13499 batch_time=0.40869 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 0.00826 (QuantReg: 0.13556) QuantErr: 0.13556 batch_time=0.41852 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 0.00669 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.40733 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 0.00984 (QuantReg: 0.13636) QuantErr: 0.13636 batch_time=0.42023 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 0.00897 (QuantReg: 0.13275) QuantErr: 0.13275 batch_time=0.41924 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 0.00748 (QuantReg: 0.13379) QuantErr: 0.13379 batch_time=0.42094 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 0.00832 (QuantReg: 0.13668) QuantErr: 0.13668 batch_time=0.41999 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 0.00673 (QuantReg: 0.13623) QuantErr: 0.13623 batch_time=0.41158 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 0.00771 (QuantReg: 0.13661) QuantErr: 0.13661 batch_time=0.41586 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 0.00654 (QuantReg: 0.13827) QuantErr: 0.13827 batch_time=0.41688 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 0.00811 (QuantReg: 0.13684) QuantErr: 0.13684 batch_time=0.41054 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 0.00610 (QuantReg: 0.13662) QuantErr: 0.13662 batch_time=0.86165 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 0.00582 (QuantReg: 0.13776) QuantErr: 0.13776 batch_time=0.40919 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 0.00746 (QuantReg: 0.13764) QuantErr: 0.13764 batch_time=0.44335 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 0.00716 (QuantReg: 0.13801) QuantErr: 0.13801 batch_time=0.46201 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 0.00690 (QuantReg: 0.13391) QuantErr: 0.13391 batch_time=0.42495 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch8.pth ...
Done in 6.638s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch8.pth ...
Done in 10.334s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 0.006649032592773437
 quant_reg      : 0.13625012350082397
 quant_err      : 0.13625012350082397
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 18.10865191146881
 MSRVTT_full_val/t2v_metrics/R5: 50.905432595573444
 MSRVTT_full_val/t2v_metrics/R10: 70.82494969818913
 MSRVTT_full_val/t2v_metrics/R50: 95.17102615694165
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.0
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 40.26665087988759
 MSRVTT_full_val/v2t_metrics/R1: 19.718309859154928
 MSRVTT_full_val/v2t_metrics/R5: 58.95372233400403
 MSRVTT_full_val/v2t_metrics/R10: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.587525150905433
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 44.470374990173454
 MSRVTT_full_test/t2v_metrics/R1: 5.986622073578595
 MSRVTT_full_test/t2v_metrics/R5: 19.899665551839465
 MSRVTT_full_test/t2v_metrics/R10: 32.608695652173914
 MSRVTT_full_test/t2v_metrics/R50: 69.33110367892976
 MSRVTT_full_test/t2v_metrics/MedR: 22.0
 MSRVTT_full_test/t2v_metrics/MeanR: 63.436120401337796
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.72004129225575
 MSRVTT_full_test/v2t_metrics/R1: 7.1237458193979935
 MSRVTT_full_test/v2t_metrics/R5: 23.110367892976587
 MSRVTT_full_test/v2t_metrics/R10: 35.551839464882946
 MSRVTT_full_test/v2t_metrics/R50: 73.61204013377926
 MSRVTT_full_test/v2t_metrics/MedR: 18.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.889966555183946
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 18.021562822764167
 mnt_best       : 15.72004129225575
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 0.00634 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=37.38682 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 0.00712 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.87755 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 0.00900 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=0.41367 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 0.00655 (QuantReg: 0.13767) QuantErr: 0.13767 batch_time=0.43234 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 0.00638 (QuantReg: 0.13643) QuantErr: 0.13643 batch_time=0.42600 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 0.00795 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=0.42102 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 0.00510 (QuantReg: 0.13750) QuantErr: 0.13750 batch_time=0.42632 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 0.00582 (QuantReg: 0.13372) QuantErr: 0.13372 batch_time=0.43043 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 0.00494 (QuantReg: 0.13622) QuantErr: 0.13622 batch_time=0.43923 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 0.00673 (QuantReg: 0.13729) QuantErr: 0.13729 batch_time=0.42649 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 0.00616 (QuantReg: 0.13728) QuantErr: 0.13728 batch_time=0.42991 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 0.00699 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.45203 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 0.00464 (QuantReg: 0.13736) QuantErr: 0.13736 batch_time=0.41539 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 0.00639 (QuantReg: 0.13639) QuantErr: 0.13639 batch_time=0.42042 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 0.00588 (QuantReg: 0.13466) QuantErr: 0.13466 batch_time=0.44591 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 0.00695 (QuantReg: 0.13538) QuantErr: 0.13538 batch_time=0.42716 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 0.00555 (QuantReg: 0.13607) QuantErr: 0.13607 batch_time=0.47428 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 0.00491 (QuantReg: 0.13500) QuantErr: 0.13500 batch_time=0.41251 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 0.00662 (QuantReg: 0.13563) QuantErr: 0.13563 batch_time=0.43303 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 0.00513 (QuantReg: 0.13790) QuantErr: 0.13790 batch_time=3.40568 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 0.00736 (QuantReg: 0.13727) QuantErr: 0.13727 batch_time=0.42637 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 0.00631 (QuantReg: 0.13525) QuantErr: 0.13525 batch_time=0.44468 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 0.00516 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.42457 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch9.pth ...
Done in 3.578s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch9.pth ...
Done in 7.017s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 0.0060645599365234375
 quant_reg      : 0.13606975531578064
 quant_err      : 0.13606975531578064
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 17.303822937625753
 MSRVTT_full_val/t2v_metrics/R5: 52.91750503018109
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 95.37223340040241
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.01609657947686
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 40.478944357679524
 MSRVTT_full_val/v2t_metrics/R1: 21.730382293762574
 MSRVTT_full_val/v2t_metrics/R5: 57.947686116700204
 MSRVTT_full_val/v2t_metrics/R10: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.911468812877263
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 45.590346510741405
 MSRVTT_full_test/t2v_metrics/R1: 6.622073578595318
 MSRVTT_full_test/t2v_metrics/R5: 21.53846153846154
 MSRVTT_full_test/t2v_metrics/R10: 32.84280936454849
 MSRVTT_full_test/t2v_metrics/R50: 69.7324414715719
 MSRVTT_full_test/t2v_metrics/MedR: 23.0
 MSRVTT_full_test/t2v_metrics/MeanR: 61.97257525083612
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 16.732069511696682
 MSRVTT_full_test/v2t_metrics/R1: 6.555183946488294
 MSRVTT_full_test/v2t_metrics/R5: 23.51170568561873
 MSRVTT_full_test/v2t_metrics/R10: 37.591973244147155
 MSRVTT_full_test/v2t_metrics/R50: 74.94983277591973
 MSRVTT_full_test/v2t_metrics/MedR: 17.0
 MSRVTT_full_test/v2t_metrics/MeanR: 50.40869565217391
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.960622334856044
 mnt_best       : 16.732069511696682
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 0.00426 (QuantReg: 0.13434) QuantErr: 0.13434 batch_time=35.88723 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 0.00481 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.44279 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 0.00597 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.41819 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 0.00756 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.43407 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 0.00551 (QuantReg: 0.13488) QuantErr: 0.13488 batch_time=0.42846 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 0.00471 (QuantReg: 0.13480) QuantErr: 0.13480 batch_time=0.41554 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 0.00503 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.41814 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 0.00463 (QuantReg: 0.13447) QuantErr: 0.13447 batch_time=0.43581 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 0.00367 (QuantReg: 0.13576) QuantErr: 0.13576 batch_time=0.41858 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 0.00767 (QuantReg: 0.13453) QuantErr: 0.13453 batch_time=0.42808 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 0.00713 (QuantReg: 0.13599) QuantErr: 0.13599 batch_time=0.41857 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 0.00573 (QuantReg: 0.13343) QuantErr: 0.13343 batch_time=0.42627 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 0.00576 (QuantReg: 0.13420) QuantErr: 0.13420 batch_time=0.42675 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 0.00696 (QuantReg: 0.13537) QuantErr: 0.13537 batch_time=0.41945 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 0.00513 (QuantReg: 0.13599) QuantErr: 0.13599 batch_time=0.89139 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 0.00571 (QuantReg: 0.13490) QuantErr: 0.13490 batch_time=0.42941 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 0.00591 (QuantReg: 0.13524) QuantErr: 0.13524 batch_time=0.41503 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 0.00410 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=0.41413 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 0.00542 (QuantReg: 0.13732) QuantErr: 0.13732 batch_time=0.41545 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 0.00516 (QuantReg: 0.13821) QuantErr: 0.13821 batch_time=2.50699 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 0.00928 (QuantReg: 0.13664) QuantErr: 0.13664 batch_time=0.79254 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 0.00490 (QuantReg: 0.13667) QuantErr: 0.13667 batch_time=0.42862 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 0.00607 (QuantReg: 0.13616) QuantErr: 0.13616 batch_time=0.41825 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch10.pth ...
Done in 3.712s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 0.005865798950195312
 quant_reg      : 0.13559187442064286
 quant_err      : 0.13559187442064286
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 15.694164989939638
 MSRVTT_full_val/t2v_metrics/R5: 52.313883299798796
 MSRVTT_full_val/t2v_metrics/R10: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R50: 93.76257545271629
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.633802816901408
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 38.557549051333595
 MSRVTT_full_val/v2t_metrics/R1: 21.12676056338028
 MSRVTT_full_val/v2t_metrics/R5: 60.36217303822938
 MSRVTT_full_val/v2t_metrics/R10: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.867203219315895
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 46.26752099995385
 MSRVTT_full_test/t2v_metrics/R1: 5.919732441471572
 MSRVTT_full_test/t2v_metrics/R5: 20.535117056856187
 MSRVTT_full_test/t2v_metrics/R10: 32.30769230769231
 MSRVTT_full_test/t2v_metrics/R50: 68.49498327759197
 MSRVTT_full_test/t2v_metrics/MedR: 24.0
 MSRVTT_full_test/t2v_metrics/MeanR: 65.98494983277592
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.777386561838359
 MSRVTT_full_test/v2t_metrics/R1: 6.923076923076923
 MSRVTT_full_test/v2t_metrics/R5: 24.2809364548495
 MSRVTT_full_test/v2t_metrics/R10: 37.458193979933114
 MSRVTT_full_test/v2t_metrics/R50: 74.84949832775919
 MSRVTT_full_test/v2t_metrics/MedR: 19.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.13344481605351
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 18.465899798450423
 mnt_best       : 16.732069511696682
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 0.00650 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=36.77464 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 0.00626 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=0.41166 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 0.00485 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=3.07364 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 0.00646 (QuantReg: 0.13503) QuantErr: 0.13503 batch_time=0.41537 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 0.00453 (QuantReg: 0.13721) QuantErr: 0.13721 batch_time=0.42109 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 0.00424 (QuantReg: 0.13732) QuantErr: 0.13732 batch_time=0.43797 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 0.00385 (QuantReg: 0.13424) QuantErr: 0.13424 batch_time=1.35090 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 0.00533 (QuantReg: 0.13686) QuantErr: 0.13686 batch_time=0.44604 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 0.00661 (QuantReg: 0.13672) QuantErr: 0.13672 batch_time=0.43468 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 0.00336 (QuantReg: 0.13777) QuantErr: 0.13777 batch_time=0.42338 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 0.00335 (QuantReg: 0.13647) QuantErr: 0.13647 batch_time=0.46190 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 0.00737 (QuantReg: 0.13753) QuantErr: 0.13753 batch_time=0.53324 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 0.00553 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.43332 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 0.00772 (QuantReg: 0.13589) QuantErr: 0.13589 batch_time=1.20799 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 0.00623 (QuantReg: 0.13772) QuantErr: 0.13772 batch_time=0.43867 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 0.00552 (QuantReg: 0.13753) QuantErr: 0.13753 batch_time=0.42562 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 0.00556 (QuantReg: 0.13671) QuantErr: 0.13671 batch_time=0.42614 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 0.00698 (QuantReg: 0.13512) QuantErr: 0.13512 batch_time=0.42519 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 0.00543 (QuantReg: 0.13817) QuantErr: 0.13817 batch_time=0.41658 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 0.00494 (QuantReg: 0.13793) QuantErr: 0.13793 batch_time=0.41191 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 0.00601 (QuantReg: 0.13733) QuantErr: 0.13733 batch_time=0.42189 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 0.00537 (QuantReg: 0.13783) QuantErr: 0.13783 batch_time=0.41885 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 0.00495 (QuantReg: 0.13689) QuantErr: 0.13689 batch_time=0.43335 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch11.pth ...
Done in 4.124s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 0.005459152221679688
 quant_reg      : 0.13668715059757233
 quant_err      : 0.13668715059757233
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 17.10261569416499
 MSRVTT_full_val/t2v_metrics/R5: 50.70422535211268
 MSRVTT_full_val/t2v_metrics/R10: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.951710261569417
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 39.00105955205883
 MSRVTT_full_val/v2t_metrics/R1: 22.132796780684103
 MSRVTT_full_val/v2t_metrics/R5: 58.35010060362173
 MSRVTT_full_val/v2t_metrics/R10: 73.44064386317908
 MSRVTT_full_val/v2t_metrics/R50: 94.56740442655935
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 11.088531187122737
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 45.604194974472286
 MSRVTT_full_test/t2v_metrics/R1: 5.88628762541806
 MSRVTT_full_test/t2v_metrics/R5: 20.96989966555184
 MSRVTT_full_test/t2v_metrics/R10: 33.34448160535117
 MSRVTT_full_test/t2v_metrics/R50: 69.23076923076923
 MSRVTT_full_test/t2v_metrics/MedR: 22.5
 MSRVTT_full_test/t2v_metrics/MeanR: 66.31538461538462
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 16.025832552547932
 MSRVTT_full_test/v2t_metrics/R1: 7.792642140468227
 MSRVTT_full_test/v2t_metrics/R5: 26.05351170568562
 MSRVTT_full_test/v2t_metrics/R10: 38.561872909699
 MSRVTT_full_test/v2t_metrics/R50: 75.05016722408027
 MSRVTT_full_test/v2t_metrics/MedR: 17.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.684615384615384
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.856515555348366
 mnt_best       : 16.732069511696682
 not_improved_count: 2
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 0.00533 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=31.57515 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 0.00427 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.40936 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 0.00526 (QuantReg: 0.13528) QuantErr: 0.13528 batch_time=0.45082 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 0.00538 (QuantReg: 0.13604) QuantErr: 0.13604 batch_time=0.41027 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 0.00584 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.40293 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 0.00751 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.45855 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 0.00484 (QuantReg: 0.13787) QuantErr: 0.13787 batch_time=0.87290 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 0.00580 (QuantReg: 0.13502) QuantErr: 0.13502 batch_time=0.43830 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 0.00427 (QuantReg: 0.13783) QuantErr: 0.13783 batch_time=0.41072 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 0.00598 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.41379 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 0.00303 (QuantReg: 0.13340) QuantErr: 0.13340 batch_time=0.40513 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 0.00355 (QuantReg: 0.13590) QuantErr: 0.13590 batch_time=0.45169 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 0.00652 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=0.40965 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 0.00700 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.40442 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 0.00499 (QuantReg: 0.13465) QuantErr: 0.13465 batch_time=0.41887 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 0.00483 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.40624 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 0.00328 (QuantReg: 0.13667) QuantErr: 0.13667 batch_time=0.41971 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 0.00359 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=0.42534 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 0.00482 (QuantReg: 0.13883) QuantErr: 0.13883 batch_time=0.43048 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 0.00633 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=1.57272 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 0.00414 (QuantReg: 0.13331) QuantErr: 0.13331 batch_time=3.14949 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 0.00482 (QuantReg: 0.13430) QuantErr: 0.13430 batch_time=0.40465 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 0.00445 (QuantReg: 0.13732) QuantErr: 0.13732 batch_time=0.43208 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch12.pth ...
Done in 3.585s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch12.pth ...
Done in 7.109s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 0.005158294677734375
 quant_reg      : 0.13611840736865996
 quant_err      : 0.13611840736865996
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 19.3158953722334
 MSRVTT_full_val/t2v_metrics/R5: 54.72837022132797
 MSRVTT_full_val/t2v_metrics/R10: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R50: 95.17102615694165
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.189134808853119
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 42.06746464531399
 MSRVTT_full_val/v2t_metrics/R1: 25.35211267605634
 MSRVTT_full_val/v2t_metrics/R5: 61.16700201207244
 MSRVTT_full_val/v2t_metrics/R10: 74.44668008048289
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.496981891348089
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.69214375568633
 MSRVTT_full_test/t2v_metrics/R1: 7.8595317725752505
 MSRVTT_full_test/t2v_metrics/R5: 22.608695652173914
 MSRVTT_full_test/t2v_metrics/R10: 35.28428093645485
 MSRVTT_full_test/t2v_metrics/R50: 70.76923076923077
 MSRVTT_full_test/t2v_metrics/MedR: 20.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.87290969899666
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.439585353737368
 MSRVTT_full_test/v2t_metrics/R1: 7.65886287625418
 MSRVTT_full_test/v2t_metrics/R5: 25.11705685618729
 MSRVTT_full_test/v2t_metrics/R10: 38.66220735785953
 MSRVTT_full_test/v2t_metrics/R50: 75.18394648829431
 MSRVTT_full_test/v2t_metrics/MedR: 17.0
 MSRVTT_full_test/v2t_metrics/MeanR: 50.17391304347826
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.51970408168433
 mnt_best       : 18.439585353737368
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 0.00443 (QuantReg: 0.13709) QuantErr: 0.13709 batch_time=32.86286 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 0.00485 (QuantReg: 0.13380) QuantErr: 0.13380 batch_time=0.41570 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 0.00399 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.41768 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 0.00552 (QuantReg: 0.13698) QuantErr: 0.13698 batch_time=0.41749 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 0.00373 (QuantReg: 0.13501) QuantErr: 0.13501 batch_time=0.43846 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 0.00412 (QuantReg: 0.13488) QuantErr: 0.13488 batch_time=0.42732 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 0.00655 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.41737 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 0.00505 (QuantReg: 0.13461) QuantErr: 0.13461 batch_time=0.40859 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 0.00373 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.41370 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 0.00396 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=0.43812 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 0.00407 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=0.42147 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 0.00418 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=0.42618 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 0.00328 (QuantReg: 0.13496) QuantErr: 0.13496 batch_time=0.43350 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 0.00511 (QuantReg: 0.13308) QuantErr: 0.13308 batch_time=0.41620 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 0.00483 (QuantReg: 0.13523) QuantErr: 0.13523 batch_time=0.44487 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 0.00525 (QuantReg: 0.13688) QuantErr: 0.13688 batch_time=0.41608 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 0.00578 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=0.42091 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 0.00425 (QuantReg: 0.13734) QuantErr: 0.13734 batch_time=0.41564 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 0.00362 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=4.54844 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 0.00407 (QuantReg: 0.13450) QuantErr: 0.13450 batch_time=1.84304 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 0.00604 (QuantReg: 0.13342) QuantErr: 0.13342 batch_time=0.41891 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 0.00439 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=0.42331 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 0.00488 (QuantReg: 0.13752) QuantErr: 0.13752 batch_time=0.45548 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch13.pth ...
Done in 12.200s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 0.004803932189941406
 quant_reg      : 0.1353490087389946
 quant_err      : 0.1353490087389946
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 21.12676056338028
 MSRVTT_full_val/t2v_metrics/R5: 54.929577464788736
 MSRVTT_full_val/t2v_metrics/R10: 70.62374245472837
 MSRVTT_full_val/t2v_metrics/R50: 94.16498993963782
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.088531187122737
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.43734765782663
 MSRVTT_full_val/v2t_metrics/R1: 23.34004024144869
 MSRVTT_full_val/v2t_metrics/R5: 60.563380281690144
 MSRVTT_full_val/v2t_metrics/R10: 74.64788732394366
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 11.325955734406438
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 47.25448953528219
 MSRVTT_full_test/t2v_metrics/R1: 7.491638795986622
 MSRVTT_full_test/t2v_metrics/R5: 23.377926421404684
 MSRVTT_full_test/t2v_metrics/R10: 35.719063545150505
 MSRVTT_full_test/t2v_metrics/R50: 70.50167224080268
 MSRVTT_full_test/t2v_metrics/MedR: 20.0
 MSRVTT_full_test/t2v_metrics/MeanR: 61.16053511705686
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.425854068861916
 MSRVTT_full_test/v2t_metrics/R1: 8.595317725752508
 MSRVTT_full_test/v2t_metrics/R5: 26.956521739130434
 MSRVTT_full_test/v2t_metrics/R10: 40.2675585284281
 MSRVTT_full_test/v2t_metrics/R50: 75.01672240802675
 MSRVTT_full_test/v2t_metrics/MedR: 16.0
 MSRVTT_full_test/v2t_metrics/MeanR: 50.97591973244147
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.05201620728207
 mnt_best       : 18.439585353737368
 not_improved_count: 1
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 0.00658 (QuantReg: 0.13347) QuantErr: 0.13347 batch_time=35.32794 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 0.00510 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.42045 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 0.00383 (QuantReg: 0.13437) QuantErr: 0.13437 batch_time=1.72360 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 0.00362 (QuantReg: 0.13344) QuantErr: 0.13344 batch_time=0.40972 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 0.00471 (QuantReg: 0.13675) QuantErr: 0.13675 batch_time=0.41642 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 0.00359 (QuantReg: 0.13260) QuantErr: 0.13260 batch_time=0.40502 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 0.00355 (QuantReg: 0.13130) QuantErr: 0.13130 batch_time=3.05205 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 0.00448 (QuantReg: 0.13643) QuantErr: 0.13643 batch_time=0.42198 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 0.00564 (QuantReg: 0.13507) QuantErr: 0.13507 batch_time=0.43418 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 0.00399 (QuantReg: 0.13445) QuantErr: 0.13445 batch_time=0.43270 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 0.00458 (QuantReg: 0.13441) QuantErr: 0.13441 batch_time=0.41739 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 0.00415 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.41102 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 0.00438 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.42208 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 0.00443 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=0.41994 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 0.00316 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=0.42912 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 0.00540 (QuantReg: 0.13575) QuantErr: 0.13575 batch_time=0.42185 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 0.00574 (QuantReg: 0.13448) QuantErr: 0.13448 batch_time=0.42742 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 0.00372 (QuantReg: 0.13307) QuantErr: 0.13307 batch_time=0.40377 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 0.00434 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.42627 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 0.00412 (QuantReg: 0.13534) QuantErr: 0.13534 batch_time=0.41991 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 0.00422 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=0.44561 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 0.00401 (QuantReg: 0.13835) QuantErr: 0.13835 batch_time=0.45450 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 0.00511 (QuantReg: 0.13239) QuantErr: 0.13239 batch_time=0.40634 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch14.pth ...
Done in 13.121s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 0.004471176147460938
 quant_reg      : 0.13511754792928696
 quant_err      : 0.13511754792928696
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 21.12676056338028
 MSRVTT_full_val/t2v_metrics/R5: 55.331991951710265
 MSRVTT_full_val/t2v_metrics/R10: 71.42857142857143
 MSRVTT_full_val/t2v_metrics/R50: 94.16498993963782
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.142857142857142
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.70794553765725
 MSRVTT_full_val/v2t_metrics/R1: 23.34004024144869
 MSRVTT_full_val/v2t_metrics/R5: 61.56941649899397
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.241448692152918
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 47.81168135488829
 MSRVTT_full_test/t2v_metrics/R1: 6.655518394648829
 MSRVTT_full_test/t2v_metrics/R5: 22.876254180602007
 MSRVTT_full_test/t2v_metrics/R10: 34.68227424749164
 MSRVTT_full_test/t2v_metrics/R50: 69.09698996655518
 MSRVTT_full_test/t2v_metrics/MedR: 21.0
 MSRVTT_full_test/t2v_metrics/MeanR: 65.12642140468228
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 17.413715969338597
 MSRVTT_full_test/v2t_metrics/R1: 7.290969899665551
 MSRVTT_full_test/v2t_metrics/R5: 25.217391304347824
 MSRVTT_full_test/v2t_metrics/R10: 39.49832775919732
 MSRVTT_full_test/v2t_metrics/R50: 75.88628762541806
 MSRVTT_full_test/v2t_metrics/MedR: 16.0
 MSRVTT_full_test/v2t_metrics/MeanR: 48.84280936454849
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.365173426644073
 mnt_best       : 18.439585353737368
 not_improved_count: 2
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 0.00550 (QuantReg: 0.13445) QuantErr: 0.13445 batch_time=29.47384 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 0.00330 (QuantReg: 0.13388) QuantErr: 0.13388 batch_time=0.40878 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 0.00384 (QuantReg: 0.13553) QuantErr: 0.13553 batch_time=0.67091 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 0.00336 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.40914 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 0.00433 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=0.41244 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 0.00437 (QuantReg: 0.13608) QuantErr: 0.13608 batch_time=0.41174 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 0.00437 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.97937 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 0.00632 (QuantReg: 0.13510) QuantErr: 0.13510 batch_time=0.42778 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 0.00504 (QuantReg: 0.13576) QuantErr: 0.13576 batch_time=0.42239 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 0.00527 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.43441 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 0.00439 (QuantReg: 0.13379) QuantErr: 0.13379 batch_time=0.40381 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 0.00412 (QuantReg: 0.13431) QuantErr: 0.13431 batch_time=0.45040 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 0.00358 (QuantReg: 0.13299) QuantErr: 0.13299 batch_time=3.92166 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 0.00333 (QuantReg: 0.13419) QuantErr: 0.13419 batch_time=0.43520 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 0.00374 (QuantReg: 0.13561) QuantErr: 0.13561 batch_time=0.41696 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 0.00341 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=0.41629 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 0.00305 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.40525 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 0.00362 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=0.41429 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 0.00514 (QuantReg: 0.13502) QuantErr: 0.13502 batch_time=0.41698 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 0.00558 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=4.36167 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 0.00531 (QuantReg: 0.13758) QuantErr: 0.13758 batch_time=0.41812 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 0.00336 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.42192 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 0.00424 (QuantReg: 0.13438) QuantErr: 0.13438 batch_time=0.52782 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch15.pth ...
Done in 15.924s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch15.pth ...
Done in 19.676s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 0.004247291564941406
 quant_reg      : 0.13527133613824843
 quant_err      : 0.13527133613824843
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 22.736418511066397
 MSRVTT_full_val/t2v_metrics/R5: 56.33802816901409
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.559356136820925
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.438386090045356
 MSRVTT_full_val/v2t_metrics/R1: 25.75452716297787
 MSRVTT_full_val/v2t_metrics/R5: 64.38631790744466
 MSRVTT_full_val/v2t_metrics/R10: 78.87323943661971
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.830985915492958
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.76046785097944
 MSRVTT_full_test/t2v_metrics/R1: 7.959866220735786
 MSRVTT_full_test/t2v_metrics/R5: 24.31438127090301
 MSRVTT_full_test/t2v_metrics/R10: 37.458193979933114
 MSRVTT_full_test/t2v_metrics/R50: 72.5752508361204
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.03879598662208
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.354053706959768
 MSRVTT_full_test/v2t_metrics/R1: 9.130434782608695
 MSRVTT_full_test/v2t_metrics/R5: 30.100334448160535
 MSRVTT_full_test/v2t_metrics/R10: 44.046822742474916
 MSRVTT_full_test/v2t_metrics/R50: 78.99665551839465
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.900334448160535
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.96108760046128
 mnt_best       : 19.354053706959768
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 0.00373 (QuantReg: 0.13412) QuantErr: 0.13412 batch_time=33.20527 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 0.00281 (QuantReg: 0.13503) QuantErr: 0.13503 batch_time=0.45989 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 0.00468 (QuantReg: 0.13623) QuantErr: 0.13623 batch_time=1.86519 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 0.00560 (QuantReg: 0.13485) QuantErr: 0.13485 batch_time=0.42180 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 0.00293 (QuantReg: 0.13323) QuantErr: 0.13323 batch_time=0.47879 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 0.00382 (QuantReg: 0.13291) QuantErr: 0.13291 batch_time=0.42466 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 0.00389 (QuantReg: 0.13738) QuantErr: 0.13738 batch_time=0.44731 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 0.00381 (QuantReg: 0.13314) QuantErr: 0.13314 batch_time=0.41360 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 0.00385 (QuantReg: 0.13539) QuantErr: 0.13539 batch_time=0.41978 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 0.00434 (QuantReg: 0.13506) QuantErr: 0.13506 batch_time=0.43875 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 0.00424 (QuantReg: 0.13271) QuantErr: 0.13271 batch_time=0.41641 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 0.00401 (QuantReg: 0.13756) QuantErr: 0.13756 batch_time=0.41886 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 0.00366 (QuantReg: 0.13345) QuantErr: 0.13345 batch_time=0.55897 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 0.00465 (QuantReg: 0.13301) QuantErr: 0.13301 batch_time=3.80896 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 0.00364 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=0.42551 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 0.00492 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.42533 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 0.00475 (QuantReg: 0.13615) QuantErr: 0.13615 batch_time=0.43467 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 0.00391 (QuantReg: 0.13759) QuantErr: 0.13759 batch_time=0.46731 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 0.00510 (QuantReg: 0.13522) QuantErr: 0.13522 batch_time=0.48632 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 0.00293 (QuantReg: 0.13472) QuantErr: 0.13472 batch_time=1.78048 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 0.00445 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=1.25301 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 0.00536 (QuantReg: 0.13342) QuantErr: 0.13342 batch_time=0.42182 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 0.00316 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.42137 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch16.pth ...
Done in 10.955s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch16.pth ...
Done in 14.389s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 0.004030670166015625
 quant_reg      : 0.13514906978607177
 quant_err      : 0.13514906978607177
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 20.523138832997986
 MSRVTT_full_val/t2v_metrics/R5: 56.74044265593562
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.263581488933601
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.855850548737386
 MSRVTT_full_val/v2t_metrics/R1: 23.74245472837022
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 78.06841046277665
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.201207243460765
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.02796677395601
 MSRVTT_full_test/t2v_metrics/R1: 7.993311036789297
 MSRVTT_full_test/t2v_metrics/R5: 24.816053511705686
 MSRVTT_full_test/t2v_metrics/R10: 37.458193979933114
 MSRVTT_full_test/t2v_metrics/R50: 72.77591973244147
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.814046822742476
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.51351116832954
 MSRVTT_full_test/v2t_metrics/R1: 8.26086956521739
 MSRVTT_full_test/v2t_metrics/R5: 27.892976588628763
 MSRVTT_full_test/v2t_metrics/R10: 41.87290969899666
 MSRVTT_full_test/v2t_metrics/R50: 77.4247491638796
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.188294314381274
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.28880362603225
 mnt_best       : 19.51351116832954
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 0.00589 (QuantReg: 0.13633) QuantErr: 0.13633 batch_time=32.63897 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 0.00322 (QuantReg: 0.13673) QuantErr: 0.13673 batch_time=0.68731 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 0.00379 (QuantReg: 0.13443) QuantErr: 0.13443 batch_time=3.75443 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 0.00360 (QuantReg: 0.13591) QuantErr: 0.13591 batch_time=0.42397 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 0.00384 (QuantReg: 0.13457) QuantErr: 0.13457 batch_time=0.45553 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 0.00293 (QuantReg: 0.13503) QuantErr: 0.13503 batch_time=0.41000 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 0.00376 (QuantReg: 0.13430) QuantErr: 0.13430 batch_time=0.42871 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 0.00481 (QuantReg: 0.13481) QuantErr: 0.13481 batch_time=0.42707 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 0.00385 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.42056 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 0.00336 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=0.42655 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 0.00377 (QuantReg: 0.13376) QuantErr: 0.13376 batch_time=0.40878 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 0.00317 (QuantReg: 0.13213) QuantErr: 0.13213 batch_time=0.43352 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 0.00487 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.41609 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 0.00445 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=0.41201 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 0.00460 (QuantReg: 0.13563) QuantErr: 0.13563 batch_time=0.41321 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 0.00420 (QuantReg: 0.13512) QuantErr: 0.13512 batch_time=0.41932 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 0.00510 (QuantReg: 0.13528) QuantErr: 0.13528 batch_time=0.42046 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 0.00394 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.42989 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 0.00225 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.77311 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 0.00411 (QuantReg: 0.13666) QuantErr: 0.13666 batch_time=0.43896 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 0.00496 (QuantReg: 0.13412) QuantErr: 0.13412 batch_time=0.41664 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 0.00246 (QuantReg: 0.13348) QuantErr: 0.13348 batch_time=0.40904 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 0.00385 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.52631 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch17.pth ...
Done in 16.301s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 0.00364825439453125
 quant_reg      : 0.13502476680278777
 quant_err      : 0.13502476680278777
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 18.712273641851105
 MSRVTT_full_val/t2v_metrics/R5: 56.53923541247485
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.61569416498994
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 42.47573158065782
 MSRVTT_full_val/v2t_metrics/R1: 21.327967806841045
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.084507042253522
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 47.22482553032211
 MSRVTT_full_test/t2v_metrics/R1: 7.625418060200669
 MSRVTT_full_test/t2v_metrics/R5: 23.879598662207357
 MSRVTT_full_test/t2v_metrics/R10: 35.35117056856188
 MSRVTT_full_test/t2v_metrics/R50: 70.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 20.0
 MSRVTT_full_test/t2v_metrics/MeanR: 60.76638795986622
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.602222174397568
 MSRVTT_full_test/v2t_metrics/R1: 8.060200668896321
 MSRVTT_full_test/v2t_metrics/R5: 27.49163879598662
 MSRVTT_full_test/v2t_metrics/R10: 40.936454849498325
 MSRVTT_full_test/v2t_metrics/R50: 76.8561872909699
 MSRVTT_full_test/v2t_metrics/MedR: 16.0
 MSRVTT_full_test/v2t_metrics/MeanR: 48.031772575250834
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.85541826847657
 mnt_best       : 19.51351116832954
 not_improved_count: 1
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 0.00427 (QuantReg: 0.13580) QuantErr: 0.13580 batch_time=27.25443 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 0.00359 (QuantReg: 0.13257) QuantErr: 0.13257 batch_time=0.45080 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 0.00364 (QuantReg: 0.13534) QuantErr: 0.13534 batch_time=0.45520 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 0.00319 (QuantReg: 0.13359) QuantErr: 0.13359 batch_time=0.49796 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 0.00334 (QuantReg: 0.13338) QuantErr: 0.13338 batch_time=0.43888 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 0.00294 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.42579 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 0.00253 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.45104 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 0.00346 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=3.00377 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 0.00268 (QuantReg: 0.13537) QuantErr: 0.13537 batch_time=0.42746 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 0.00349 (QuantReg: 0.13718) QuantErr: 0.13718 batch_time=0.87163 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 0.00439 (QuantReg: 0.13711) QuantErr: 0.13711 batch_time=0.43257 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 0.00286 (QuantReg: 0.13313) QuantErr: 0.13313 batch_time=0.46492 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 0.00350 (QuantReg: 0.13457) QuantErr: 0.13457 batch_time=0.51768 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 0.00259 (QuantReg: 0.13401) QuantErr: 0.13401 batch_time=0.40829 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 0.00375 (QuantReg: 0.13633) QuantErr: 0.13633 batch_time=0.45353 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 0.00409 (QuantReg: 0.13511) QuantErr: 0.13511 batch_time=0.42607 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 0.00245 (QuantReg: 0.13291) QuantErr: 0.13291 batch_time=0.41748 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 0.00394 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=0.43540 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 0.00377 (QuantReg: 0.13633) QuantErr: 0.13633 batch_time=0.63501 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 0.00578 (QuantReg: 0.13629) QuantErr: 0.13629 batch_time=0.41757 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 0.00354 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.44352 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 0.00334 (QuantReg: 0.13401) QuantErr: 0.13401 batch_time=0.43883 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 0.00336 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.44636 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch18.pth ...
Done in 3.661s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 0.0036947174072265625
 quant_reg      : 0.13471360558271409
 quant_err      : 0.13471360558271409
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 19.718309859154928
 MSRVTT_full_val/t2v_metrics/R5: 56.13682092555332
 MSRVTT_full_val/t2v_metrics/R10: 71.0261569416499
 MSRVTT_full_val/t2v_metrics/R50: 95.37223340040241
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.517102615694165
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 42.83958674394802
 MSRVTT_full_val/v2t_metrics/R1: 25.150905432595575
 MSRVTT_full_val/v2t_metrics/R5: 64.1851106639839
 MSRVTT_full_val/v2t_metrics/R10: 78.47082494969818
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.704225352112676
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.222544505905574
 MSRVTT_full_test/t2v_metrics/R1: 7.558528428093646
 MSRVTT_full_test/t2v_metrics/R5: 23.97993311036789
 MSRVTT_full_test/t2v_metrics/R10: 36.42140468227425
 MSRVTT_full_test/t2v_metrics/R50: 71.80602006688963
 MSRVTT_full_test/t2v_metrics/MedR: 19.0
 MSRVTT_full_test/t2v_metrics/MeanR: 61.09531772575251
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.759185151337864
 MSRVTT_full_test/v2t_metrics/R1: 8.093645484949834
 MSRVTT_full_test/v2t_metrics/R5: 27.692307692307693
 MSRVTT_full_test/v2t_metrics/R10: 41.30434782608695
 MSRVTT_full_test/v2t_metrics/R50: 77.19063545150502
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 47.955852842809364
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.9974407826622
 mnt_best       : 19.51351116832954
 not_improved_count: 2
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 0.00422 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=28.92495 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 0.00370 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.42544 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 0.00366 (QuantReg: 0.13376) QuantErr: 0.13376 batch_time=3.16222 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 0.00362 (QuantReg: 0.13533) QuantErr: 0.13533 batch_time=0.41743 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 0.00428 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.42341 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 0.00332 (QuantReg: 0.13824) QuantErr: 0.13824 batch_time=0.43823 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 0.00311 (QuantReg: 0.13353) QuantErr: 0.13353 batch_time=1.04941 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 0.00329 (QuantReg: 0.13484) QuantErr: 0.13484 batch_time=0.42454 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 0.00365 (QuantReg: 0.13601) QuantErr: 0.13601 batch_time=0.43185 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 0.00296 (QuantReg: 0.13527) QuantErr: 0.13527 batch_time=0.42117 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 0.00336 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.44063 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 0.00401 (QuantReg: 0.13526) QuantErr: 0.13526 batch_time=0.54198 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 0.00227 (QuantReg: 0.13510) QuantErr: 0.13510 batch_time=1.92471 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 0.00359 (QuantReg: 0.13877) QuantErr: 0.13877 batch_time=0.42366 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 0.00276 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=0.42733 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 0.00342 (QuantReg: 0.13661) QuantErr: 0.13661 batch_time=0.45060 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 0.00282 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.44786 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 0.00322 (QuantReg: 0.13801) QuantErr: 0.13801 batch_time=0.44132 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 0.00249 (QuantReg: 0.13692) QuantErr: 0.13692 batch_time=0.42645 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 0.00442 (QuantReg: 0.13264) QuantErr: 0.13264 batch_time=0.41915 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 0.00365 (QuantReg: 0.13741) QuantErr: 0.13741 batch_time=0.42838 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 0.00225 (QuantReg: 0.13568) QuantErr: 0.13568 batch_time=0.46043 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 0.00442 (QuantReg: 0.13363) QuantErr: 0.13363 batch_time=0.64730 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch19.pth ...
Done in 17.406s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 0.0034595413208007813
 quant_reg      : 0.13533243119716645
 quant_err      : 0.13533243119716645
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_full_val/t2v_metrics/R1: 19.718309859154928
 MSRVTT_full_val/t2v_metrics/R5: 58.95372233400403
 MSRVTT_full_val/t2v_metrics/R10: 71.42857142857143
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.158953722334005
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.62655911657313
 MSRVTT_full_val/v2t_metrics/R1: 25.553319919517104
 MSRVTT_full_val/v2t_metrics/R5: 65.3923541247485
 MSRVTT_full_val/v2t_metrics/R10: 78.87323943661971
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.480885311871228
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.8902589705553
 MSRVTT_full_test/t2v_metrics/R1: 7.357859531772576
 MSRVTT_full_test/t2v_metrics/R5: 24.448160535117058
 MSRVTT_full_test/t2v_metrics/R10: 37.558528428093645
 MSRVTT_full_test/t2v_metrics/R50: 72.17391304347827
 MSRVTT_full_test/t2v_metrics/MedR: 19.0
 MSRVTT_full_test/t2v_metrics/MeanR: 59.49632107023412
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.904654719850924
 MSRVTT_full_test/v2t_metrics/R1: 8.294314381270903
 MSRVTT_full_test/v2t_metrics/R5: 28.561872909698998
 MSRVTT_full_test/v2t_metrics/R10: 43.11036789297659
 MSRVTT_full_test/v2t_metrics/R50: 77.9933110367893
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.969565217391306
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.69616464743827
 mnt_best       : 19.51351116832954
 not_improved_count: 3
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 0.00369 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=31.40313 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 0.00343 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.43038 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 0.00339 (QuantReg: 0.13511) QuantErr: 0.13511 batch_time=0.40393 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 0.00262 (QuantReg: 0.13412) QuantErr: 0.13412 batch_time=0.43231 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 0.00380 (QuantReg: 0.13500) QuantErr: 0.13500 batch_time=0.40373 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 0.00388 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.43053 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 0.00233 (QuantReg: 0.13515) QuantErr: 0.13515 batch_time=0.41571 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 0.00416 (QuantReg: 0.13664) QuantErr: 0.13664 batch_time=0.41671 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 0.00412 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=3.11431 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 0.00466 (QuantReg: 0.13523) QuantErr: 0.13523 batch_time=0.40892 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 0.00319 (QuantReg: 0.13441) QuantErr: 0.13441 batch_time=0.41990 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 0.00299 (QuantReg: 0.13417) QuantErr: 0.13417 batch_time=0.40733 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 0.00421 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.41905 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 0.00342 (QuantReg: 0.13608) QuantErr: 0.13608 batch_time=0.42183 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 0.00295 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=0.40960 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 0.00268 (QuantReg: 0.13444) QuantErr: 0.13444 batch_time=0.40780 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 0.00280 (QuantReg: 0.13558) QuantErr: 0.13558 batch_time=0.43582 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 0.00310 (QuantReg: 0.13447) QuantErr: 0.13447 batch_time=0.41993 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 0.00329 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=1.18112 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 0.00378 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.41011 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 0.00311 (QuantReg: 0.13419) QuantErr: 0.13419 batch_time=0.40977 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 0.00211 (QuantReg: 0.13681) QuantErr: 0.13681 batch_time=0.43920 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 0.00468 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.41795 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch20.pth ...
Done in 3.580s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch20.pth ...
Done in 7.092s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 0.0033850860595703125
 quant_reg      : 0.13511964482069017
 quant_err      : 0.13511964482069017
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 21.12676056338028
 MSRVTT_full_val/t2v_metrics/R5: 57.34406438631791
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.07645875251509
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 44.602115586641986
 MSRVTT_full_val/v2t_metrics/R1: 27.766599597585515
 MSRVTT_full_val/v2t_metrics/R5: 65.79476861167002
 MSRVTT_full_val/v2t_metrics/R10: 80.48289738430583
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.012072434607646
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.78038511263305
 MSRVTT_full_test/t2v_metrics/R1: 7.625418060200669
 MSRVTT_full_test/t2v_metrics/R5: 25.585284280936456
 MSRVTT_full_test/t2v_metrics/R10: 38.929765886287626
 MSRVTT_full_test/t2v_metrics/R50: 72.0066889632107
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.46521739130435
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.656758370796876
 MSRVTT_full_test/v2t_metrics/R1: 9.866220735785953
 MSRVTT_full_test/v2t_metrics/R5: 30.334448160535118
 MSRVTT_full_test/v2t_metrics/R10: 45.21739130434783
 MSRVTT_full_test/v2t_metrics/R50: 80.13377926421404
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.47257525083612
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.830371342097514
 mnt_best       : 19.656758370796876
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 0.00220 (QuantReg: 0.13568) QuantErr: 0.13568 batch_time=33.37384 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 0.00343 (QuantReg: 0.13572) QuantErr: 0.13572 batch_time=0.46737 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 0.00237 (QuantReg: 0.13494) QuantErr: 0.13494 batch_time=0.41283 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 0.00318 (QuantReg: 0.13230) QuantErr: 0.13230 batch_time=0.42121 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 0.00352 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.40258 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 0.00226 (QuantReg: 0.13119) QuantErr: 0.13119 batch_time=0.42887 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 0.00301 (QuantReg: 0.13360) QuantErr: 0.13360 batch_time=5.16951 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 0.00420 (QuantReg: 0.13405) QuantErr: 0.13405 batch_time=0.43203 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 0.00283 (QuantReg: 0.13342) QuantErr: 0.13342 batch_time=0.41194 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 0.00238 (QuantReg: 0.13646) QuantErr: 0.13646 batch_time=0.43082 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 0.00280 (QuantReg: 0.13193) QuantErr: 0.13193 batch_time=0.41871 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 0.00271 (QuantReg: 0.13710) QuantErr: 0.13710 batch_time=0.42503 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 0.00302 (QuantReg: 0.13622) QuantErr: 0.13622 batch_time=0.42783 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 0.00439 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=0.41506 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 0.00379 (QuantReg: 0.13484) QuantErr: 0.13484 batch_time=0.41458 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 0.00564 (QuantReg: 0.13606) QuantErr: 0.13606 batch_time=0.42499 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 0.00379 (QuantReg: 0.13841) QuantErr: 0.13841 batch_time=0.60587 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 0.00336 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.95950 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 0.00339 (QuantReg: 0.13689) QuantErr: 0.13689 batch_time=0.41344 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 0.00335 (QuantReg: 0.13557) QuantErr: 0.13557 batch_time=0.41207 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 0.00327 (QuantReg: 0.13648) QuantErr: 0.13648 batch_time=0.41943 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 0.00322 (QuantReg: 0.13627) QuantErr: 0.13627 batch_time=0.41969 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 0.00362 (QuantReg: 0.13313) QuantErr: 0.13313 batch_time=0.46053 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch21.pth ...
Done in 3.480s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch21.pth ...
Done in 7.169s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 0.0031879043579101565
 quant_reg      : 0.1350109800696373
 quant_err      : 0.1350109800696373
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_full_val/t2v_metrics/R1: 22.93762575452716
 MSRVTT_full_val/t2v_metrics/R5: 59.95975855130785
 MSRVTT_full_val/t2v_metrics/R10: 74.44668008048289
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.503018108651911
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.782621885773814
 MSRVTT_full_val/v2t_metrics/R1: 26.961770623742456
 MSRVTT_full_val/v2t_metrics/R5: 66.39839034205231
 MSRVTT_full_val/v2t_metrics/R10: 79.67806841046277
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.024144869215291
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.24943348776776
 MSRVTT_full_test/t2v_metrics/R1: 7.993311036789297
 MSRVTT_full_test/t2v_metrics/R5: 26.187290969899667
 MSRVTT_full_test/t2v_metrics/R10: 38.561872909699
 MSRVTT_full_test/t2v_metrics/R50: 73.07692307692308
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.681939799331104
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.059732397373498
 MSRVTT_full_test/v2t_metrics/R1: 9.899665551839465
 MSRVTT_full_test/v2t_metrics/R5: 29.899665551839465
 MSRVTT_full_test/v2t_metrics/R10: 44.74916387959866
 MSRVTT_full_test/v2t_metrics/R50: 79.6989966555184
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.072909698996654
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.660500440674134
 mnt_best       : 20.059732397373498
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 0.00328 (QuantReg: 0.13393) QuantErr: 0.13393 batch_time=45.83832 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 0.00213 (QuantReg: 0.13289) QuantErr: 0.13289 batch_time=0.45094 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 0.00349 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=0.41759 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 0.00265 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.42062 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 0.00364 (QuantReg: 0.13366) QuantErr: 0.13366 batch_time=0.41864 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 0.00268 (QuantReg: 0.13450) QuantErr: 0.13450 batch_time=0.42572 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 0.00395 (QuantReg: 0.13629) QuantErr: 0.13629 batch_time=0.41952 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 0.00364 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=0.43479 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 0.00315 (QuantReg: 0.13374) QuantErr: 0.13374 batch_time=0.44859 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 0.00292 (QuantReg: 0.13289) QuantErr: 0.13289 batch_time=0.44203 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 0.00282 (QuantReg: 0.13619) QuantErr: 0.13619 batch_time=0.41435 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 0.00304 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.43237 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 0.00333 (QuantReg: 0.13636) QuantErr: 0.13636 batch_time=0.41305 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 0.00489 (QuantReg: 0.13441) QuantErr: 0.13441 batch_time=0.42420 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 0.00305 (QuantReg: 0.13533) QuantErr: 0.13533 batch_time=0.41713 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 0.00236 (QuantReg: 0.13836) QuantErr: 0.13836 batch_time=0.44136 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 0.00263 (QuantReg: 0.13526) QuantErr: 0.13526 batch_time=0.43895 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 0.00223 (QuantReg: 0.13632) QuantErr: 0.13632 batch_time=0.47174 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 0.00311 (QuantReg: 0.13393) QuantErr: 0.13393 batch_time=0.42960 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 0.00268 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.41730 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 0.00279 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.41684 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 0.00258 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=0.45257 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 0.00286 (QuantReg: 0.13398) QuantErr: 0.13398 batch_time=0.46309 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch22.pth ...
Done in 13.451s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 0.003142486572265625
 quant_reg      : 0.13486713898181915
 quant_err      : 0.13486713898181915
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_full_val/t2v_metrics/R1: 24.346076458752513
 MSRVTT_full_val/t2v_metrics/R5: 58.5513078470825
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.670020120724345
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.21627835323352
 MSRVTT_full_val/v2t_metrics/R1: 26.961770623742456
 MSRVTT_full_val/v2t_metrics/R5: 66.19718309859155
 MSRVTT_full_val/v2t_metrics/R10: 79.27565392354124
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.826961770623743
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.10858146221941
 MSRVTT_full_test/t2v_metrics/R1: 7.892976588628763
 MSRVTT_full_test/t2v_metrics/R5: 26.321070234113712
 MSRVTT_full_test/t2v_metrics/R10: 38.79598662207358
 MSRVTT_full_test/t2v_metrics/R50: 73.74581939799332
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.0180602006689
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.049815775403065
 MSRVTT_full_test/v2t_metrics/R1: 9.966555183946488
 MSRVTT_full_test/v2t_metrics/R5: 31.070234113712374
 MSRVTT_full_test/v2t_metrics/R10: 45.11705685618729
 MSRVTT_full_test/v2t_metrics/R50: 80.2675585284281
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.4180602006689
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.084822735779092
 mnt_best       : 20.059732397373498
 not_improved_count: 1
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 0.00252 (QuantReg: 0.13306) QuantErr: 0.13306 batch_time=33.87186 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 0.00286 (QuantReg: 0.13508) QuantErr: 0.13508 batch_time=0.42544 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 0.00345 (QuantReg: 0.13572) QuantErr: 0.13572 batch_time=0.45545 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 0.00418 (QuantReg: 0.13364) QuantErr: 0.13364 batch_time=0.43615 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 0.00335 (QuantReg: 0.13708) QuantErr: 0.13708 batch_time=0.46872 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 0.00382 (QuantReg: 0.13313) QuantErr: 0.13313 batch_time=0.42502 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 0.00319 (QuantReg: 0.13561) QuantErr: 0.13561 batch_time=2.60456 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 0.00229 (QuantReg: 0.13379) QuantErr: 0.13379 batch_time=0.42330 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 0.00236 (QuantReg: 0.13422) QuantErr: 0.13422 batch_time=0.42223 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 0.00309 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.42199 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 0.00309 (QuantReg: 0.13525) QuantErr: 0.13525 batch_time=0.41984 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 0.00300 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.49228 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 0.00270 (QuantReg: 0.13373) QuantErr: 0.13373 batch_time=0.53621 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 0.00223 (QuantReg: 0.13343) QuantErr: 0.13343 batch_time=0.42802 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 0.00334 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.49935 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 0.00290 (QuantReg: 0.13703) QuantErr: 0.13703 batch_time=0.42574 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 0.00216 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.42495 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 0.00261 (QuantReg: 0.13320) QuantErr: 0.13320 batch_time=0.43026 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 0.00425 (QuantReg: 0.13448) QuantErr: 0.13448 batch_time=0.46738 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 0.00261 (QuantReg: 0.13554) QuantErr: 0.13554 batch_time=0.44209 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 0.00308 (QuantReg: 0.13443) QuantErr: 0.13443 batch_time=0.42564 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 0.00344 (QuantReg: 0.13395) QuantErr: 0.13395 batch_time=0.43155 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 0.00290 (QuantReg: 0.13370) QuantErr: 0.13370 batch_time=0.40771 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch23.pth ...
Done in 3.673s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch23.pth ...
Done in 7.372s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 0.0028959922790527345
 quant_reg      : 0.13499850302934646
 quant_err      : 0.13499850302934646
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 57.142857142857146
 MSRVTT_full_val/t2v_metrics/R10: 70.62374245472837
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.30784708249497
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.270625841116704
 MSRVTT_full_val/v2t_metrics/R1: 27.96780684104628
 MSRVTT_full_val/v2t_metrics/R5: 65.99597585513078
 MSRVTT_full_val/v2t_metrics/R10: 80.0804828973843
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.140845070422536
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.87302805262
 MSRVTT_full_test/t2v_metrics/R1: 8.093645484949834
 MSRVTT_full_test/t2v_metrics/R5: 25.85284280936455
 MSRVTT_full_test/t2v_metrics/R10: 39.39799331103679
 MSRVTT_full_test/t2v_metrics/R50: 73.1438127090301
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.55250836120401
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.201123720519533
 MSRVTT_full_test/v2t_metrics/R1: 10.234113712374581
 MSRVTT_full_test/v2t_metrics/R5: 30.501672240802677
 MSRVTT_full_test/v2t_metrics/R10: 44.5819397993311
 MSRVTT_full_test/v2t_metrics/R50: 80.2675585284281
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.09397993311037
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.0534632999117
 mnt_best       : 20.201123720519533
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 0.00216 (QuantReg: 0.13404) QuantErr: 0.13404 batch_time=33.14487 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 0.00248 (QuantReg: 0.13796) QuantErr: 0.13796 batch_time=0.41481 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 0.00222 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.44766 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 0.00286 (QuantReg: 0.13640) QuantErr: 0.13640 batch_time=0.46987 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 0.00229 (QuantReg: 0.13470) QuantErr: 0.13470 batch_time=0.41034 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 0.00238 (QuantReg: 0.13470) QuantErr: 0.13470 batch_time=0.40947 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 0.00360 (QuantReg: 0.13568) QuantErr: 0.13568 batch_time=0.42299 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 0.00314 (QuantReg: 0.13679) QuantErr: 0.13679 batch_time=0.43037 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 0.00284 (QuantReg: 0.13300) QuantErr: 0.13300 batch_time=0.43640 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 0.00327 (QuantReg: 0.13381) QuantErr: 0.13381 batch_time=0.40962 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 0.00293 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.54334 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 0.00289 (QuantReg: 0.13538) QuantErr: 0.13538 batch_time=0.43578 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 0.00220 (QuantReg: 0.13628) QuantErr: 0.13628 batch_time=0.40881 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 0.00203 (QuantReg: 0.13385) QuantErr: 0.13385 batch_time=3.98743 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 0.00286 (QuantReg: 0.13545) QuantErr: 0.13545 batch_time=0.41459 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 0.00175 (QuantReg: 0.13886) QuantErr: 0.13886 batch_time=0.43633 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.00389 (QuantReg: 0.13431) QuantErr: 0.13431 batch_time=0.41950 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 0.00195 (QuantReg: 0.13590) QuantErr: 0.13590 batch_time=0.41562 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 0.00338 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=0.41009 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 0.00277 (QuantReg: 0.13603) QuantErr: 0.13603 batch_time=0.45083 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 0.00241 (QuantReg: 0.13609) QuantErr: 0.13609 batch_time=0.52507 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 0.00247 (QuantReg: 0.13542) QuantErr: 0.13542 batch_time=0.44619 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 0.00171 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.41773 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch24.pth ...
Done in 3.748s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch24.pth ...
Done in 7.464s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 0.0028210296630859374
 quant_reg      : 0.13549787092208862
 quant_err      : 0.13549787092208862
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 23.138832997987926
 MSRVTT_full_val/t2v_metrics/R5: 59.15492957746479
 MSRVTT_full_val/t2v_metrics/R10: 74.44668008048289
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.728370221327967
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.70814031686856
 MSRVTT_full_val/v2t_metrics/R1: 28.37022132796781
 MSRVTT_full_val/v2t_metrics/R5: 65.3923541247485
 MSRVTT_full_val/v2t_metrics/R10: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.545271629778671
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.37990169036415
 MSRVTT_full_test/t2v_metrics/R1: 8.896321070234114
 MSRVTT_full_test/t2v_metrics/R5: 27.4247491638796
 MSRVTT_full_test/t2v_metrics/R10: 41.137123745819395
 MSRVTT_full_test/t2v_metrics/R50: 74.11371237458194
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.50903010033445
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.57060594585691
 MSRVTT_full_test/v2t_metrics/R1: 10.0
 MSRVTT_full_test/v2t_metrics/R5: 30.735785953177256
 MSRVTT_full_test/v2t_metrics/R10: 45.819397993311036
 MSRVTT_full_test/v2t_metrics/R50: 80.5351170568562
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.02173913043478
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.148930445002083
 mnt_best       : 21.57060594585691
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 0.00302 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=32.21855 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 0.00238 (QuantReg: 0.13367) QuantErr: 0.13367 batch_time=0.41503 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 0.00200 (QuantReg: 0.13799) QuantErr: 0.13799 batch_time=0.40563 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 0.00250 (QuantReg: 0.13591) QuantErr: 0.13591 batch_time=0.42651 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 0.00219 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.48706 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 0.00318 (QuantReg: 0.13556) QuantErr: 0.13556 batch_time=0.43527 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 0.00272 (QuantReg: 0.13366) QuantErr: 0.13366 batch_time=4.15530 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 0.00264 (QuantReg: 0.13681) QuantErr: 0.13681 batch_time=0.41243 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 0.00225 (QuantReg: 0.13676) QuantErr: 0.13676 batch_time=0.42513 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 0.00229 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.42225 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 0.00304 (QuantReg: 0.13329) QuantErr: 0.13329 batch_time=0.42510 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 0.00361 (QuantReg: 0.13717) QuantErr: 0.13717 batch_time=0.54244 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 0.00330 (QuantReg: 0.13806) QuantErr: 0.13806 batch_time=0.41745 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 0.00281 (QuantReg: 0.13431) QuantErr: 0.13431 batch_time=0.43049 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 0.00340 (QuantReg: 0.13485) QuantErr: 0.13485 batch_time=0.42455 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 0.00278 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.42006 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 0.00420 (QuantReg: 0.13439) QuantErr: 0.13439 batch_time=0.42000 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 0.00405 (QuantReg: 0.13821) QuantErr: 0.13821 batch_time=0.46774 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.00303 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.41780 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 0.00283 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=0.42172 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 0.00276 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=0.42224 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 0.00151 (QuantReg: 0.13682) QuantErr: 0.13682 batch_time=0.42060 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 0.00257 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=0.64615 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch25.pth ...
Done in 6.975s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 0.002762565612792969
 quant_reg      : 0.13550043684244156
 quant_err      : 0.13550043684244156
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_full_val/t2v_metrics/R1: 23.541247484909455
 MSRVTT_full_val/t2v_metrics/R5: 58.5513078470825
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.072434607645874
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.6477022823031
 MSRVTT_full_val/v2t_metrics/R1: 27.16297786720322
 MSRVTT_full_val/v2t_metrics/R5: 67.6056338028169
 MSRVTT_full_val/v2t_metrics/R10: 79.27565392354124
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.694164989939638
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.60576822436117
 MSRVTT_full_test/t2v_metrics/R1: 8.561872909698996
 MSRVTT_full_test/t2v_metrics/R5: 26.52173913043478
 MSRVTT_full_test/t2v_metrics/R10: 40.06688963210702
 MSRVTT_full_test/t2v_metrics/R50: 72.44147157190635
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.14882943143812
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.8762329931616
 MSRVTT_full_test/v2t_metrics/R1: 9.19732441471572
 MSRVTT_full_test/v2t_metrics/R5: 30.93645484949833
 MSRVTT_full_test/v2t_metrics/R10: 45.719063545150505
 MSRVTT_full_test/v2t_metrics/R50: 80.2675585284281
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 41.639464882943145
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.518509362352884
 mnt_best       : 21.57060594585691
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 0.00246 (QuantReg: 0.13393) QuantErr: 0.13393 batch_time=33.20438 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 0.00224 (QuantReg: 0.13391) QuantErr: 0.13391 batch_time=0.40979 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 0.00307 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.42388 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 0.00224 (QuantReg: 0.13650) QuantErr: 0.13650 batch_time=0.44803 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 0.00289 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.41724 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 0.00234 (QuantReg: 0.13728) QuantErr: 0.13728 batch_time=0.42240 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 0.00200 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=0.43650 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 0.00221 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.40452 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 0.00291 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.41960 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 0.00257 (QuantReg: 0.13473) QuantErr: 0.13473 batch_time=0.40740 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.00298 (QuantReg: 0.13552) QuantErr: 0.13552 batch_time=0.41494 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 0.00226 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=0.40401 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 0.00230 (QuantReg: 0.13752) QuantErr: 0.13752 batch_time=0.41811 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 0.00458 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.40709 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 0.00329 (QuantReg: 0.13568) QuantErr: 0.13568 batch_time=0.41118 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 0.00269 (QuantReg: 0.13827) QuantErr: 0.13827 batch_time=0.41785 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 0.00389 (QuantReg: 0.13591) QuantErr: 0.13591 batch_time=0.40760 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 0.00260 (QuantReg: 0.13492) QuantErr: 0.13492 batch_time=0.40987 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 0.00211 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.41723 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 0.00384 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.42151 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 0.00246 (QuantReg: 0.13385) QuantErr: 0.13385 batch_time=0.41973 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 0.00211 (QuantReg: 0.13447) QuantErr: 0.13447 batch_time=0.40599 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 0.00230 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=0.42209 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch26.pth ...
Done in 3.445s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 0.002732677459716797
 quant_reg      : 0.13516407543420791
 quant_err      : 0.13516407543420791
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_full_val/t2v_metrics/R1: 22.736418511066397
 MSRVTT_full_val/t2v_metrics/R5: 57.74647887323944
 MSRVTT_full_val/t2v_metrics/R10: 72.83702213279678
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.961770623742455
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.729864532121546
 MSRVTT_full_val/v2t_metrics/R1: 26.358148893360163
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 79.87927565392354
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.380281690140846
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.155606687521875
 MSRVTT_full_test/t2v_metrics/R1: 7.993311036789297
 MSRVTT_full_test/t2v_metrics/R5: 26.02006688963211
 MSRVTT_full_test/t2v_metrics/R10: 38.66220735785953
 MSRVTT_full_test/t2v_metrics/R50: 73.61204013377926
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.11889632107023
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.03428844882771
 MSRVTT_full_test/v2t_metrics/R1: 9.364548494983278
 MSRVTT_full_test/v2t_metrics/R5: 29.431438127090303
 MSRVTT_full_test/v2t_metrics/R10: 45.719063545150505
 MSRVTT_full_test/v2t_metrics/R50: 81.10367892976589
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 40.39163879598662
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.270116150423288
 mnt_best       : 21.57060594585691
 not_improved_count: 2
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 0.00287 (QuantReg: 0.13422) QuantErr: 0.13422 batch_time=37.20247 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 0.00296 (QuantReg: 0.13549) QuantErr: 0.13549 batch_time=0.40825 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 0.00354 (QuantReg: 0.13729) QuantErr: 0.13729 batch_time=0.42876 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 0.00234 (QuantReg: 0.13476) QuantErr: 0.13476 batch_time=0.46117 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 0.00253 (QuantReg: 0.13451) QuantErr: 0.13451 batch_time=0.45539 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 0.00233 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.41320 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 0.00228 (QuantReg: 0.13523) QuantErr: 0.13523 batch_time=0.45181 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 0.00449 (QuantReg: 0.13439) QuantErr: 0.13439 batch_time=0.42323 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 0.00296 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.45695 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 0.00234 (QuantReg: 0.13448) QuantErr: 0.13448 batch_time=0.42881 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 0.00248 (QuantReg: 0.13590) QuantErr: 0.13590 batch_time=0.41519 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 0.00211 (QuantReg: 0.13412) QuantErr: 0.13412 batch_time=0.43329 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 0.00195 (QuantReg: 0.13637) QuantErr: 0.13637 batch_time=0.44067 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 0.00246 (QuantReg: 0.13437) QuantErr: 0.13437 batch_time=3.72661 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 0.00200 (QuantReg: 0.13727) QuantErr: 0.13727 batch_time=0.41326 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 0.00282 (QuantReg: 0.13510) QuantErr: 0.13510 batch_time=0.41380 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 0.00468 (QuantReg: 0.13439) QuantErr: 0.13439 batch_time=0.43280 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 0.00160 (QuantReg: 0.13719) QuantErr: 0.13719 batch_time=0.48601 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 0.00317 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.43802 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 0.00203 (QuantReg: 0.13291) QuantErr: 0.13291 batch_time=0.42064 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 0.00208 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.41154 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 0.00251 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.44532 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 0.00213 (QuantReg: 0.13323) QuantErr: 0.13323 batch_time=0.43885 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch27.pth ...
Done in 3.630s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 0.002594799041748047
 quant_reg      : 0.13498239439725876
 quant_err      : 0.13498239439725876
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_full_val/t2v_metrics/R1: 23.74245472837022
 MSRVTT_full_val/t2v_metrics/R5: 59.758551307847085
 MSRVTT_full_val/t2v_metrics/R10: 73.03822937625755
 MSRVTT_full_val/t2v_metrics/R50: 95.37223340040241
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.750503018108652
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.97051318278985
 MSRVTT_full_val/v2t_metrics/R1: 28.772635814889338
 MSRVTT_full_val/v2t_metrics/R5: 67.6056338028169
 MSRVTT_full_val/v2t_metrics/R10: 81.08651911468813
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.098591549295774
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.03026093448552
 MSRVTT_full_test/t2v_metrics/R1: 8.193979933110368
 MSRVTT_full_test/t2v_metrics/R5: 26.153846153846153
 MSRVTT_full_test/t2v_metrics/R10: 39.86622073578595
 MSRVTT_full_test/t2v_metrics/R50: 73.91304347826087
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.73411371237458
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.443025763080733
 MSRVTT_full_test/v2t_metrics/R1: 10.267558528428093
 MSRVTT_full_test/v2t_metrics/R5: 31.906354515050168
 MSRVTT_full_test/v2t_metrics/R10: 46.58862876254181
 MSRVTT_full_test/v2t_metrics/R50: 80.76923076923077
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 40.04983277591973
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.805125797771264
 mnt_best       : 21.57060594585691
 not_improved_count: 3
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 0.00200 (QuantReg: 0.13557) QuantErr: 0.13557 batch_time=33.88509 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 0.00254 (QuantReg: 0.13593) QuantErr: 0.13593 batch_time=0.40956 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.00274 (QuantReg: 0.13156) QuantErr: 0.13156 batch_time=0.40432 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 0.00312 (QuantReg: 0.13452) QuantErr: 0.13452 batch_time=0.40999 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 0.00179 (QuantReg: 0.13320) QuantErr: 0.13320 batch_time=0.44016 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 0.00169 (QuantReg: 0.13351) QuantErr: 0.13351 batch_time=0.41293 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 0.00191 (QuantReg: 0.13461) QuantErr: 0.13461 batch_time=0.41420 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 0.00317 (QuantReg: 0.13502) QuantErr: 0.13502 batch_time=0.41086 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 0.00284 (QuantReg: 0.13560) QuantErr: 0.13560 batch_time=0.43502 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 0.00320 (QuantReg: 0.13468) QuantErr: 0.13468 batch_time=0.42338 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 0.00276 (QuantReg: 0.13376) QuantErr: 0.13376 batch_time=0.41398 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 0.00177 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.41229 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 0.00224 (QuantReg: 0.13566) QuantErr: 0.13566 batch_time=0.57883 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 0.00238 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=0.42459 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 0.00189 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.41473 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 0.00272 (QuantReg: 0.13340) QuantErr: 0.13340 batch_time=0.51460 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 0.00200 (QuantReg: 0.13688) QuantErr: 0.13688 batch_time=0.40386 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 0.00303 (QuantReg: 0.13545) QuantErr: 0.13545 batch_time=0.43750 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 0.00193 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.41207 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 0.00278 (QuantReg: 0.13151) QuantErr: 0.13151 batch_time=0.46289 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 0.00313 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=0.42168 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 0.00229 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.46325 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 0.00321 (QuantReg: 0.13386) QuantErr: 0.13386 batch_time=0.41864 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch28.pth ...
Done in 7.810s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 0.002515655517578125
 quant_reg      : 0.13520271056890487
 quant_err      : 0.13520271056890487
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_full_val/t2v_metrics/R1: 24.346076458752513
 MSRVTT_full_val/t2v_metrics/R5: 59.356136820925556
 MSRVTT_full_val/t2v_metrics/R10: 71.62977867203219
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.74446680080483
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.95293439627429
 MSRVTT_full_val/v2t_metrics/R1: 28.973843058350102
 MSRVTT_full_val/v2t_metrics/R5: 65.3923541247485
 MSRVTT_full_val/v2t_metrics/R10: 80.0804828973843
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.953722334004024
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.33593583536008
 MSRVTT_full_test/t2v_metrics/R1: 8.26086956521739
 MSRVTT_full_test/t2v_metrics/R5: 26.287625418060202
 MSRVTT_full_test/t2v_metrics/R10: 39.4314381270903
 MSRVTT_full_test/t2v_metrics/R50: 73.54515050167224
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.91538461538462
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.458474469485015
 MSRVTT_full_test/v2t_metrics/R1: 10.133779264214047
 MSRVTT_full_test/v2t_metrics/R5: 31.036789297658864
 MSRVTT_full_test/v2t_metrics/R10: 46.52173913043478
 MSRVTT_full_test/v2t_metrics/R50: 81.17056856187291
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 41.32876254180602
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.45877620103071
 mnt_best       : 21.57060594585691
 not_improved_count: 4
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 0.00220 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=33.43575 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 0.00208 (QuantReg: 0.13566) QuantErr: 0.13566 batch_time=0.41838 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 0.00295 (QuantReg: 0.13636) QuantErr: 0.13636 batch_time=0.40864 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 0.00193 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.42874 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 0.00301 (QuantReg: 0.13557) QuantErr: 0.13557 batch_time=0.48965 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 0.00179 (QuantReg: 0.13423) QuantErr: 0.13423 batch_time=0.41379 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 0.00175 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.45804 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 0.00201 (QuantReg: 0.13512) QuantErr: 0.13512 batch_time=0.41915 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 0.00255 (QuantReg: 0.13686) QuantErr: 0.13686 batch_time=0.41628 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 0.00363 (QuantReg: 0.13680) QuantErr: 0.13680 batch_time=0.41256 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 0.00206 (QuantReg: 0.13658) QuantErr: 0.13658 batch_time=0.41727 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 0.00237 (QuantReg: 0.13378) QuantErr: 0.13378 batch_time=0.41622 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 0.00205 (QuantReg: 0.13608) QuantErr: 0.13608 batch_time=0.46296 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 0.00184 (QuantReg: 0.13541) QuantErr: 0.13541 batch_time=0.42012 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 0.00221 (QuantReg: 0.13541) QuantErr: 0.13541 batch_time=0.42211 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 0.00136 (QuantReg: 0.13604) QuantErr: 0.13604 batch_time=0.43110 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 0.00225 (QuantReg: 0.13526) QuantErr: 0.13526 batch_time=0.41445 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 0.00280 (QuantReg: 0.13418) QuantErr: 0.13418 batch_time=0.42971 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 0.00219 (QuantReg: 0.13386) QuantErr: 0.13386 batch_time=0.41431 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 0.00294 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.41311 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 0.00162 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=0.43302 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.00313 (QuantReg: 0.13198) QuantErr: 0.13198 batch_time=0.41887 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 0.00181 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=0.41760 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch29.pth ...
Done in 3.686s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 0.002381340026855469
 quant_reg      : 0.13541672718524933
 quant_err      : 0.13541672718524933
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_full_val/t2v_metrics/R1: 24.14486921529175
 MSRVTT_full_val/t2v_metrics/R5: 59.758551307847085
 MSRVTT_full_val/t2v_metrics/R10: 72.03219315895372
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.748490945674044
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.016524070350336
 MSRVTT_full_val/v2t_metrics/R1: 27.766599597585515
 MSRVTT_full_val/v2t_metrics/R5: 66.80080482897384
 MSRVTT_full_val/v2t_metrics/R10: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.012072434607646
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.42178072938278
 MSRVTT_full_test/t2v_metrics/R1: 8.02675585284281
 MSRVTT_full_test/t2v_metrics/R5: 26.187290969899667
 MSRVTT_full_test/t2v_metrics/R10: 39.56521739130435
 MSRVTT_full_test/t2v_metrics/R50: 73.34448160535118
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.39464882943144
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.26040213567904
 MSRVTT_full_test/v2t_metrics/R1: 9.866220735785953
 MSRVTT_full_test/v2t_metrics/R5: 31.438127090301002
 MSRVTT_full_test/v2t_metrics/R10: 46.98996655518395
 MSRVTT_full_test/v2t_metrics/R50: 80.16722408026756
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.22642140468228
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.427041839441706
 mnt_best       : 21.57060594585691
 not_improved_count: 5
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 0.00253 (QuantReg: 0.13629) QuantErr: 0.13629 batch_time=34.90278 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 0.00246 (QuantReg: 0.13645) QuantErr: 0.13645 batch_time=0.42902 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 0.00238 (QuantReg: 0.13879) QuantErr: 0.13879 batch_time=0.42368 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 0.00237 (QuantReg: 0.13568) QuantErr: 0.13568 batch_time=0.41644 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 0.00247 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.41564 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 0.00191 (QuantReg: 0.13702) QuantErr: 0.13702 batch_time=0.42018 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 0.00241 (QuantReg: 0.13750) QuantErr: 0.13750 batch_time=2.03318 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.00226 (QuantReg: 0.13682) QuantErr: 0.13682 batch_time=0.41886 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 0.00229 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.42952 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 0.00247 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.41795 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 0.00206 (QuantReg: 0.13422) QuantErr: 0.13422 batch_time=0.43808 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 0.00217 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.43104 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 0.00245 (QuantReg: 0.13536) QuantErr: 0.13536 batch_time=0.42669 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 0.00213 (QuantReg: 0.13744) QuantErr: 0.13744 batch_time=0.43776 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 0.00270 (QuantReg: 0.13350) QuantErr: 0.13350 batch_time=0.41301 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 0.00267 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.41209 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 0.00211 (QuantReg: 0.13498) QuantErr: 0.13498 batch_time=0.45037 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 0.00239 (QuantReg: 0.13465) QuantErr: 0.13465 batch_time=0.41865 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 0.00213 (QuantReg: 0.13778) QuantErr: 0.13778 batch_time=3.86293 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 0.00209 (QuantReg: 0.13593) QuantErr: 0.13593 batch_time=0.41332 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 0.00193 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=2.07058 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 0.00168 (QuantReg: 0.13680) QuantErr: 0.13680 batch_time=0.43157 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 0.00185 (QuantReg: 0.13214) QuantErr: 0.13214 batch_time=0.42107 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch30.pth ...
Done in 3.540s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 0.00235711669921875
 quant_reg      : 0.13568532347679138
 quant_err      : 0.13568532347679138
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_full_val/t2v_metrics/R1: 22.93762575452716
 MSRVTT_full_val/t2v_metrics/R5: 59.758551307847085
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.088531187122737
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.47626001142936
 MSRVTT_full_val/v2t_metrics/R1: 28.973843058350102
 MSRVTT_full_val/v2t_metrics/R5: 67.40442655935614
 MSRVTT_full_val/v2t_metrics/R10: 81.69014084507042
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.95774647887324
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.23605038304371
 MSRVTT_full_test/t2v_metrics/R1: 8.127090301003344
 MSRVTT_full_test/t2v_metrics/R5: 25.08361204013378
 MSRVTT_full_test/t2v_metrics/R10: 37.558528428093645
 MSRVTT_full_test/t2v_metrics/R50: 72.94314381270902
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 59.101003344481605
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.709604489479094
 MSRVTT_full_test/v2t_metrics/R1: 9.59866220735786
 MSRVTT_full_test/v2t_metrics/R5: 30.93645484949833
 MSRVTT_full_test/v2t_metrics/R10: 46.05351170568562
 MSRVTT_full_test/v2t_metrics/R50: 80.20066889632108
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 41.8190635451505
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.91376744799186
 mnt_best       : 21.57060594585691
 not_improved_count: 6
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 0.00242 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=34.43837 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 0.00193 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=0.42802 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 0.00238 (QuantReg: 0.13693) QuantErr: 0.13693 batch_time=0.42425 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 0.00240 (QuantReg: 0.13616) QuantErr: 0.13616 batch_time=0.41130 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 0.00216 (QuantReg: 0.13434) QuantErr: 0.13434 batch_time=0.41452 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 0.00235 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.45191 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 0.00219 (QuantReg: 0.13707) QuantErr: 0.13707 batch_time=0.40318 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 0.00230 (QuantReg: 0.14026) QuantErr: 0.14026 batch_time=0.40267 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 0.00195 (QuantReg: 0.13512) QuantErr: 0.13512 batch_time=0.40277 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 0.00211 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=0.41195 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 0.00187 (QuantReg: 0.13480) QuantErr: 0.13480 batch_time=0.43960 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 0.00221 (QuantReg: 0.13752) QuantErr: 0.13752 batch_time=0.41660 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 0.00192 (QuantReg: 0.13673) QuantErr: 0.13673 batch_time=1.27596 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 0.00203 (QuantReg: 0.13508) QuantErr: 0.13508 batch_time=0.63856 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 0.00259 (QuantReg: 0.13637) QuantErr: 0.13637 batch_time=0.42350 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 0.00250 (QuantReg: 0.13671) QuantErr: 0.13671 batch_time=0.42358 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 0.00245 (QuantReg: 0.13834) QuantErr: 0.13834 batch_time=0.40600 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 0.00237 (QuantReg: 0.13263) QuantErr: 0.13263 batch_time=0.44400 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 0.00185 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.40511 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 0.00282 (QuantReg: 0.13613) QuantErr: 0.13613 batch_time=0.46180 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 0.00163 (QuantReg: 0.13699) QuantErr: 0.13699 batch_time=0.41696 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 0.00221 (QuantReg: 0.13488) QuantErr: 0.13488 batch_time=0.41801 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 0.00270 (QuantReg: 0.13549) QuantErr: 0.13549 batch_time=0.40955 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch31.pth ...
Done in 3.603s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 0.002339313507080078
 quant_reg      : 0.13588395839929582
 quant_err      : 0.13588395839929582
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_full_val/t2v_metrics/R1: 24.14486921529175
 MSRVTT_full_val/t2v_metrics/R5: 58.95372233400403
 MSRVTT_full_val/t2v_metrics/R10: 72.63581488933602
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.283702213279678
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.93487159289189
 MSRVTT_full_val/v2t_metrics/R1: 27.96780684104628
 MSRVTT_full_val/v2t_metrics/R5: 67.80684104627767
 MSRVTT_full_val/v2t_metrics/R10: 80.88531187122736
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.670020120724345
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.53040501951508
 MSRVTT_full_test/t2v_metrics/R1: 8.528428093645484
 MSRVTT_full_test/t2v_metrics/R5: 26.956521739130434
 MSRVTT_full_test/t2v_metrics/R10: 40.869565217391305
 MSRVTT_full_test/t2v_metrics/R50: 74.0133779264214
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.54749163879599
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.101384660914285
 MSRVTT_full_test/v2t_metrics/R1: 10.0
 MSRVTT_full_test/v2t_metrics/R5: 32.97658862876254
 MSRVTT_full_test/v2t_metrics/R10: 47.759197324414714
 MSRVTT_full_test/v2t_metrics/R50: 80.2675585284281
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 40.671571906354515
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.06614698022705
 mnt_best       : 21.57060594585691
 not_improved_count: 7
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 0.00320 (QuantReg: 0.13442) QuantErr: 0.13442 batch_time=34.44409 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 0.00204 (QuantReg: 0.13638) QuantErr: 0.13638 batch_time=0.45113 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 0.00244 (QuantReg: 0.13681) QuantErr: 0.13681 batch_time=0.43038 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 0.00301 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.43858 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.00224 (QuantReg: 0.13811) QuantErr: 0.13811 batch_time=0.43931 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 0.00216 (QuantReg: 0.13527) QuantErr: 0.13527 batch_time=0.42418 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 0.00274 (QuantReg: 0.13606) QuantErr: 0.13606 batch_time=0.43396 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 0.00199 (QuantReg: 0.13608) QuantErr: 0.13608 batch_time=0.48123 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 0.00186 (QuantReg: 0.13683) QuantErr: 0.13683 batch_time=0.41806 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 0.00182 (QuantReg: 0.13707) QuantErr: 0.13707 batch_time=0.45802 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 0.00214 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.42408 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 0.00218 (QuantReg: 0.13544) QuantErr: 0.13544 batch_time=0.43392 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 0.00168 (QuantReg: 0.13610) QuantErr: 0.13610 batch_time=0.51050 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 0.00397 (QuantReg: 0.13480) QuantErr: 0.13480 batch_time=0.45437 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 0.00168 (QuantReg: 0.13530) QuantErr: 0.13530 batch_time=0.51416 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 0.00258 (QuantReg: 0.13701) QuantErr: 0.13701 batch_time=0.41643 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 0.00173 (QuantReg: 0.13647) QuantErr: 0.13647 batch_time=0.45435 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.00169 (QuantReg: 0.13593) QuantErr: 0.13593 batch_time=0.42507 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 0.00166 (QuantReg: 0.13424) QuantErr: 0.13424 batch_time=2.27714 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 0.00269 (QuantReg: 0.13413) QuantErr: 0.13413 batch_time=0.42263 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 0.00198 (QuantReg: 0.13736) QuantErr: 0.13736 batch_time=0.42447 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 0.00248 (QuantReg: 0.13500) QuantErr: 0.13500 batch_time=0.41572 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 0.00169 (QuantReg: 0.13425) QuantErr: 0.13425 batch_time=0.40307 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch32.pth ...
Done in 15.078s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch32.pth ...
Done in 18.782s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 0.0022009849548339845
 quant_reg      : 0.13561594116687775
 quant_err      : 0.13561594116687775
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 60.36217303822938
 MSRVTT_full_val/t2v_metrics/R10: 72.03219315895372
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.977867203219317
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.434935598018946
 MSRVTT_full_val/v2t_metrics/R1: 26.961770623742456
 MSRVTT_full_val/v2t_metrics/R5: 66.80080482897384
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.404426559356136
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.704984950642434
 MSRVTT_full_test/t2v_metrics/R1: 8.929765886287626
 MSRVTT_full_test/t2v_metrics/R5: 28.06020066889632
 MSRVTT_full_test/t2v_metrics/R10: 41.137123745819395
 MSRVTT_full_test/t2v_metrics/R50: 74.81605351170569
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.852842809364546
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.763141689547865
 MSRVTT_full_test/v2t_metrics/R1: 10.836120401337793
 MSRVTT_full_test/v2t_metrics/R5: 32.876254180602004
 MSRVTT_full_test/v2t_metrics/R10: 49.130434782608695
 MSRVTT_full_test/v2t_metrics/R50: 81.87290969899665
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.13846153846154
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.963839728269217
 mnt_best       : 21.763141689547865
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 0.00170 (QuantReg: 0.13509) QuantErr: 0.13509 batch_time=28.89172 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 0.00229 (QuantReg: 0.13701) QuantErr: 0.13701 batch_time=0.45090 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 0.00335 (QuantReg: 0.13616) QuantErr: 0.13616 batch_time=0.93515 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 0.00222 (QuantReg: 0.13787) QuantErr: 0.13787 batch_time=0.42151 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 0.00167 (QuantReg: 0.13489) QuantErr: 0.13489 batch_time=0.43575 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 0.00191 (QuantReg: 0.13924) QuantErr: 0.13924 batch_time=0.44460 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.00259 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.41779 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 0.00181 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.42447 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 0.00137 (QuantReg: 0.13733) QuantErr: 0.13733 batch_time=3.05306 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 0.00249 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.45582 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 0.00184 (QuantReg: 0.13664) QuantErr: 0.13664 batch_time=0.44342 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 0.00328 (QuantReg: 0.13530) QuantErr: 0.13530 batch_time=0.43629 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 0.00150 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.43110 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 0.00220 (QuantReg: 0.13448) QuantErr: 0.13448 batch_time=0.41983 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 0.00286 (QuantReg: 0.13774) QuantErr: 0.13774 batch_time=0.44904 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.00185 (QuantReg: 0.13713) QuantErr: 0.13713 batch_time=0.41436 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.00188 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.43720 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 0.00179 (QuantReg: 0.13584) QuantErr: 0.13584 batch_time=0.44135 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 0.00299 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=0.43142 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 0.00198 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.44952 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.00148 (QuantReg: 0.13562) QuantErr: 0.13562 batch_time=0.41929 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 0.00234 (QuantReg: 0.13662) QuantErr: 0.13662 batch_time=0.41832 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 0.00174 (QuantReg: 0.13879) QuantErr: 0.13879 batch_time=0.43039 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch33.pth ...
Done in 3.689s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch33.pth ...
Done in 7.653s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 0.002163421630859375
 quant_reg      : 0.13598452019691468
 quant_err      : 0.13598452019691468
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 59.55734406438632
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.07645875251509
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.75883288509929
 MSRVTT_full_val/v2t_metrics/R1: 27.96780684104628
 MSRVTT_full_val/v2t_metrics/R5: 66.80080482897384
 MSRVTT_full_val/v2t_metrics/R10: 80.6841046277666
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.398390342052313
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.22014213980229
 MSRVTT_full_test/t2v_metrics/R1: 8.929765886287626
 MSRVTT_full_test/t2v_metrics/R5: 28.99665551839465
 MSRVTT_full_test/t2v_metrics/R10: 41.17056856187291
 MSRVTT_full_test/t2v_metrics/R50: 74.88294314381271
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.478929765886285
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.008559372035766
 MSRVTT_full_test/v2t_metrics/R1: 10.869565217391305
 MSRVTT_full_test/v2t_metrics/R5: 33.24414715719063
 MSRVTT_full_test/v2t_metrics/R10: 49.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 81.53846153846153
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.26454849498328
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.175602915384065
 mnt_best       : 22.008559372035766
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 0.00189 (QuantReg: 0.13789) QuantErr: 0.13789 batch_time=33.78324 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 0.00187 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=2.55956 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 0.00172 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=0.43918 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 0.00196 (QuantReg: 0.13701) QuantErr: 0.13701 batch_time=0.42101 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 0.00233 (QuantReg: 0.13562) QuantErr: 0.13562 batch_time=0.89069 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 0.00187 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.43155 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.00278 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.44662 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 0.00160 (QuantReg: 0.13750) QuantErr: 0.13750 batch_time=1.11033 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 0.00167 (QuantReg: 0.13761) QuantErr: 0.13761 batch_time=0.43524 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 0.00184 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.41533 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 0.00177 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.45020 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 0.00221 (QuantReg: 0.13521) QuantErr: 0.13521 batch_time=0.41612 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 0.00153 (QuantReg: 0.13617) QuantErr: 0.13617 batch_time=0.40813 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 0.00193 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.42065 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 0.00232 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=0.42477 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 0.00194 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.43077 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 0.00210 (QuantReg: 0.13573) QuantErr: 0.13573 batch_time=0.64284 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 0.00193 (QuantReg: 0.13638) QuantErr: 0.13638 batch_time=0.41741 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 0.00185 (QuantReg: 0.13767) QuantErr: 0.13767 batch_time=0.85668 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 0.00181 (QuantReg: 0.13658) QuantErr: 0.13658 batch_time=0.64611 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 0.00211 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.46097 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 0.00221 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.42014 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 0.00218 (QuantReg: 0.13486) QuantErr: 0.13486 batch_time=0.42173 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch34.pth ...
Done in 3.521s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 0.0021451759338378907
 quant_reg      : 0.13595431715250014
 quant_err      : 0.13595431715250014
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_full_val/t2v_metrics/R1: 23.34004024144869
 MSRVTT_full_val/t2v_metrics/R5: 59.15492957746479
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.716297786720322
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.41726543240414
 MSRVTT_full_val/v2t_metrics/R1: 27.766599597585515
 MSRVTT_full_val/v2t_metrics/R5: 67.6056338028169
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.9476861167002
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.43717871093633
 MSRVTT_full_test/t2v_metrics/R1: 8.22742474916388
 MSRVTT_full_test/t2v_metrics/R5: 27.05685618729097
 MSRVTT_full_test/t2v_metrics/R10: 39.96655518394649
 MSRVTT_full_test/t2v_metrics/R50: 74.14715719063545
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.77357859531772
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.721092829194596
 MSRVTT_full_test/v2t_metrics/R1: 10.869565217391305
 MSRVTT_full_test/v2t_metrics/R5: 33.31103678929766
 MSRVTT_full_test/v2t_metrics/R10: 48.72909698996656
 MSRVTT_full_test/v2t_metrics/R50: 81.43812709030101
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.63612040133779
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.03332032002846
 mnt_best       : 22.008559372035766
 not_improved_count: 1
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 0.00192 (QuantReg: 0.13810) QuantErr: 0.13810 batch_time=30.85284 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 0.00222 (QuantReg: 0.13808) QuantErr: 0.13808 batch_time=0.41889 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 0.00261 (QuantReg: 0.13653) QuantErr: 0.13653 batch_time=0.43716 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 0.00287 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=0.43887 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 0.00216 (QuantReg: 0.13398) QuantErr: 0.13398 batch_time=0.43085 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 0.00206 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.41063 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 0.00224 (QuantReg: 0.13632) QuantErr: 0.13632 batch_time=0.42598 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 0.00152 (QuantReg: 0.13558) QuantErr: 0.13558 batch_time=0.41020 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 0.00140 (QuantReg: 0.13409) QuantErr: 0.13409 batch_time=0.44828 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 0.00163 (QuantReg: 0.13805) QuantErr: 0.13805 batch_time=0.43939 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.00269 (QuantReg: 0.13774) QuantErr: 0.13774 batch_time=0.42786 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 0.00331 (QuantReg: 0.13533) QuantErr: 0.13533 batch_time=0.40750 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 0.00198 (QuantReg: 0.13688) QuantErr: 0.13688 batch_time=0.48414 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 0.00154 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=0.41895 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 0.00231 (QuantReg: 0.13628) QuantErr: 0.13628 batch_time=0.42130 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.00220 (QuantReg: 0.13534) QuantErr: 0.13534 batch_time=0.40562 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 0.00255 (QuantReg: 0.13713) QuantErr: 0.13713 batch_time=0.42329 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 0.00187 (QuantReg: 0.13288) QuantErr: 0.13288 batch_time=0.40514 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 0.00184 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=0.41380 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 0.00191 (QuantReg: 0.13492) QuantErr: 0.13492 batch_time=0.42067 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.00211 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.41964 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 0.00182 (QuantReg: 0.13494) QuantErr: 0.13494 batch_time=0.43537 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.00223 (QuantReg: 0.13656) QuantErr: 0.13656 batch_time=0.40849 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch35.pth ...
Done in 3.567s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch35.pth ...
Done in 7.162s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 0.0020519828796386717
 quant_reg      : 0.1358454647064209
 quant_err      : 0.1358454647064209
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 59.95975855130785
 MSRVTT_full_val/t2v_metrics/R10: 75.85513078470825
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.88933601609658
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.92897740050484
 MSRVTT_full_val/v2t_metrics/R1: 27.16297786720322
 MSRVTT_full_val/v2t_metrics/R5: 68.81287726358148
 MSRVTT_full_val/v2t_metrics/R10: 81.69014084507042
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.64989939637827
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.4489175124134
 MSRVTT_full_test/t2v_metrics/R1: 9.264214046822742
 MSRVTT_full_test/t2v_metrics/R5: 28.327759197324415
 MSRVTT_full_test/t2v_metrics/R10: 41.47157190635451
 MSRVTT_full_test/t2v_metrics/R50: 75.15050167224081
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.90234113712375
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.161055082005316
 MSRVTT_full_test/v2t_metrics/R1: 11.237458193979933
 MSRVTT_full_test/v2t_metrics/R5: 33.54515050167224
 MSRVTT_full_test/v2t_metrics/R10: 48.929765886287626
 MSRVTT_full_test/v2t_metrics/R50: 81.63879598662207
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.661204013377926
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.42147084650457
 mnt_best       : 22.161055082005316
 not_improved_count: 0
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 0.00261 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=32.09645 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 0.00120 (QuantReg: 0.13601) QuantErr: 0.13601 batch_time=0.41387 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.00275 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=2.19180 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 0.00207 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.43332 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 0.00172 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.41665 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.00169 (QuantReg: 0.13389) QuantErr: 0.13389 batch_time=0.42972 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 0.00180 (QuantReg: 0.13498) QuantErr: 0.13498 batch_time=0.45393 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 0.00243 (QuantReg: 0.13641) QuantErr: 0.13641 batch_time=0.41672 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 0.00154 (QuantReg: 0.13646) QuantErr: 0.13646 batch_time=0.44143 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 0.00194 (QuantReg: 0.13611) QuantErr: 0.13611 batch_time=0.41824 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 0.00188 (QuantReg: 0.13706) QuantErr: 0.13706 batch_time=0.41616 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 0.00273 (QuantReg: 0.13942) QuantErr: 0.13942 batch_time=0.43410 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 0.00212 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=0.45657 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 0.00236 (QuantReg: 0.13535) QuantErr: 0.13535 batch_time=0.43197 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.00176 (QuantReg: 0.13429) QuantErr: 0.13429 batch_time=0.49031 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.00195 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=0.43097 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 0.00173 (QuantReg: 0.13440) QuantErr: 0.13440 batch_time=0.43027 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.00262 (QuantReg: 0.13716) QuantErr: 0.13716 batch_time=0.44267 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.00175 (QuantReg: 0.13410) QuantErr: 0.13410 batch_time=0.42918 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.00175 (QuantReg: 0.13757) QuantErr: 0.13757 batch_time=0.43200 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.00177 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=0.43695 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.00201 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.42427 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.00253 (QuantReg: 0.13572) QuantErr: 0.13572 batch_time=0.41423 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch36.pth ...
Done in 6.312s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 0.0020034446716308595
 quant_reg      : 0.13601828986406325
 quant_err      : 0.13601828986406325
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 59.95975855130785
 MSRVTT_full_val/t2v_metrics/R10: 74.44668008048289
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.348088531187123
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.75054899062387
 MSRVTT_full_val/v2t_metrics/R1: 28.772635814889338
 MSRVTT_full_val/v2t_metrics/R5: 69.01408450704226
 MSRVTT_full_val/v2t_metrics/R10: 81.69014084507042
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.492957746478872
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.53755638003831
 MSRVTT_full_test/t2v_metrics/R1: 8.929765886287626
 MSRVTT_full_test/t2v_metrics/R5: 28.127090301003346
 MSRVTT_full_test/t2v_metrics/R10: 40.869565217391305
 MSRVTT_full_test/t2v_metrics/R50: 74.74916387959867
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.156187290969896
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.733097717178335
 MSRVTT_full_test/v2t_metrics/R1: 10.96989966555184
 MSRVTT_full_test/v2t_metrics/R5: 33.1438127090301
 MSRVTT_full_test/v2t_metrics/R10: 48.42809364548495
 MSRVTT_full_test/v2t_metrics/R50: 81.1371237458194
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.278260869565216
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.015619079757176
 mnt_best       : 22.161055082005316
 not_improved_count: 1
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 0.00280 (QuantReg: 0.13738) QuantErr: 0.13738 batch_time=31.88975 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 0.00144 (QuantReg: 0.13692) QuantErr: 0.13692 batch_time=0.41936 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.00226 (QuantReg: 0.13658) QuantErr: 0.13658 batch_time=0.42785 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 0.00210 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=0.44959 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 0.00215 (QuantReg: 0.13721) QuantErr: 0.13721 batch_time=0.44334 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 0.00231 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.54997 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 0.00211 (QuantReg: 0.13321) QuantErr: 0.13321 batch_time=0.43839 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 0.00199 (QuantReg: 0.13526) QuantErr: 0.13526 batch_time=0.41758 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 0.00213 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.42942 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.00211 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.42586 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 0.00273 (QuantReg: 0.13819) QuantErr: 0.13819 batch_time=0.42370 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.00148 (QuantReg: 0.13609) QuantErr: 0.13609 batch_time=0.54853 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 0.00184 (QuantReg: 0.13768) QuantErr: 0.13768 batch_time=0.42604 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 0.00208 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=0.87704 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.00177 (QuantReg: 0.13718) QuantErr: 0.13718 batch_time=0.44544 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.00217 (QuantReg: 0.13686) QuantErr: 0.13686 batch_time=0.42612 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.00171 (QuantReg: 0.13616) QuantErr: 0.13616 batch_time=0.43726 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.00172 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.41397 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 0.00143 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.84485 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 0.00206 (QuantReg: 0.13744) QuantErr: 0.13744 batch_time=0.41936 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 0.00200 (QuantReg: 0.13553) QuantErr: 0.13553 batch_time=0.48202 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 0.00202 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.42077 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 0.00128 (QuantReg: 0.13799) QuantErr: 0.13799 batch_time=0.45256 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch37.pth ...
Done in 3.726s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 0.0019942207336425782
 quant_reg      : 0.1359082326889038
 quant_err      : 0.1359082326889038
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 59.95975855130785
 MSRVTT_full_val/t2v_metrics/R10: 75.0503018108652
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.88128772635815
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.755314972651
 MSRVTT_full_val/v2t_metrics/R1: 27.766599597585515
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.116700201207244
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.438662766316966
 MSRVTT_full_test/t2v_metrics/R1: 9.063545150501673
 MSRVTT_full_test/t2v_metrics/R5: 28.06020066889632
 MSRVTT_full_test/t2v_metrics/R10: 41.7056856187291
 MSRVTT_full_test/t2v_metrics/R50: 75.9866220735786
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.98377926421405
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.97158462616587
 MSRVTT_full_test/v2t_metrics/R1: 11.17056856187291
 MSRVTT_full_test/v2t_metrics/R5: 34.51505016722408
 MSRVTT_full_test/v2t_metrics/R10: 49.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 81.60535117056857
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.70200668896321
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.74743659480311
 mnt_best       : 22.161055082005316
 not_improved_count: 2
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.00257 (QuantReg: 0.13604) QuantErr: 0.13604 batch_time=33.62620 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.00352 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.42781 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.00231 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.45342 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 0.00197 (QuantReg: 0.13414) QuantErr: 0.13414 batch_time=0.43104 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 0.00204 (QuantReg: 0.13696) QuantErr: 0.13696 batch_time=0.42396 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.00286 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.42946 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 0.00263 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=0.42614 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.00204 (QuantReg: 0.13820) QuantErr: 0.13820 batch_time=0.42535 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 0.00180 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.46481 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.00140 (QuantReg: 0.13612) QuantErr: 0.13612 batch_time=0.41696 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.00165 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.45982 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 0.00203 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=0.43812 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 0.00166 (QuantReg: 0.13675) QuantErr: 0.13675 batch_time=0.43395 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 0.00203 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.44998 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 0.00254 (QuantReg: 0.13567) QuantErr: 0.13567 batch_time=0.90401 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.00293 (QuantReg: 0.13659) QuantErr: 0.13659 batch_time=0.43842 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.00189 (QuantReg: 0.13685) QuantErr: 0.13685 batch_time=0.44509 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.00144 (QuantReg: 0.13677) QuantErr: 0.13677 batch_time=0.41012 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 0.00144 (QuantReg: 0.13393) QuantErr: 0.13393 batch_time=0.41873 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 0.00142 (QuantReg: 0.13442) QuantErr: 0.13442 batch_time=0.42617 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 0.00211 (QuantReg: 0.13557) QuantErr: 0.13557 batch_time=0.45374 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 0.00223 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=0.43590 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 0.00209 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.42114 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch38.pth ...
Done in 3.561s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 0.001982471466064453
 quant_reg      : 0.13543856275081634
 quant_err      : 0.13543856275081634
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.843058350100604
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.61758987151683
 MSRVTT_full_val/v2t_metrics/R1: 29.37625754527163
 MSRVTT_full_val/v2t_metrics/R5: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R10: 83.5010060362173
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.9114688128772634
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.63982274330001
 MSRVTT_full_test/t2v_metrics/R1: 9.096989966555183
 MSRVTT_full_test/t2v_metrics/R5: 28.39464882943144
 MSRVTT_full_test/t2v_metrics/R10: 41.53846153846154
 MSRVTT_full_test/t2v_metrics/R50: 75.68561872909699
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.63612040133779
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.056073907915067
 MSRVTT_full_test/v2t_metrics/R1: 11.17056856187291
 MSRVTT_full_test/v2t_metrics/R5: 34.8494983277592
 MSRVTT_full_test/v2t_metrics/R10: 48.99665551839465
 MSRVTT_full_test/v2t_metrics/R50: 82.47491638795987
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.07759197324415
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.718541569092505
 mnt_best       : 22.161055082005316
 not_improved_count: 3
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.00222 (QuantReg: 0.13646) QuantErr: 0.13646 batch_time=31.39853 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 0.00194 (QuantReg: 0.13723) QuantErr: 0.13723 batch_time=0.40843 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 0.00175 (QuantReg: 0.13804) QuantErr: 0.13804 batch_time=0.43395 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 0.00188 (QuantReg: 0.13538) QuantErr: 0.13538 batch_time=0.41748 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 0.00275 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=0.43553 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 0.00145 (QuantReg: 0.13626) QuantErr: 0.13626 batch_time=0.41180 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 0.00240 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.40923 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 0.00149 (QuantReg: 0.13684) QuantErr: 0.13684 batch_time=0.41367 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 0.00164 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.41407 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 0.00185 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.40939 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.00155 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.41805 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.00200 (QuantReg: 0.13615) QuantErr: 0.13615 batch_time=0.41295 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 0.00200 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.41816 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 0.00175 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.42698 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 0.00111 (QuantReg: 0.13678) QuantErr: 0.13678 batch_time=0.41079 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 0.00142 (QuantReg: 0.13804) QuantErr: 0.13804 batch_time=0.44188 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 0.00189 (QuantReg: 0.13613) QuantErr: 0.13613 batch_time=0.42455 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.00172 (QuantReg: 0.13661) QuantErr: 0.13661 batch_time=0.45445 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.00177 (QuantReg: 0.13713) QuantErr: 0.13713 batch_time=0.41630 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 0.00232 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.41161 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 0.00178 (QuantReg: 0.13465) QuantErr: 0.13465 batch_time=0.41232 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 0.00195 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.41970 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.00199 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.42657 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch39.pth ...
Done in 3.786s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 0.0018821296691894532
 quant_reg      : 0.13557924610376357
 quant_err      : 0.13557924610376357
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 60.36217303822938
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.35814889336016
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.5938222571487
 MSRVTT_full_val/v2t_metrics/R1: 29.577464788732396
 MSRVTT_full_val/v2t_metrics/R5: 68.00804828973843
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.23943661971831
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.68254822629737
 MSRVTT_full_test/t2v_metrics/R1: 8.561872909698996
 MSRVTT_full_test/t2v_metrics/R5: 27.792642140468228
 MSRVTT_full_test/t2v_metrics/R10: 40.36789297658863
 MSRVTT_full_test/t2v_metrics/R50: 74.98327759197325
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.38428093645485
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.257469505494655
 MSRVTT_full_test/v2t_metrics/R1: 10.568561872909699
 MSRVTT_full_test/v2t_metrics/R5: 32.84280936454849
 MSRVTT_full_test/v2t_metrics/R10: 48.862876254180605
 MSRVTT_full_test/v2t_metrics/R50: 81.50501672240803
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.94448160535117
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.69281799761976
 mnt_best       : 22.161055082005316
 not_improved_count: 4
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 0.00182 (QuantReg: 0.13630) QuantErr: 0.13630 batch_time=31.21444 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 0.00168 (QuantReg: 0.13488) QuantErr: 0.13488 batch_time=7.39408 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 0.00255 (QuantReg: 0.13622) QuantErr: 0.13622 batch_time=0.41017 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.00252 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.40684 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 0.00208 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.41111 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 0.00194 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.42013 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 0.00179 (QuantReg: 0.13738) QuantErr: 0.13738 batch_time=0.40471 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 0.00160 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.40886 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 0.00196 (QuantReg: 0.13593) QuantErr: 0.13593 batch_time=0.44749 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.00226 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=0.41595 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 0.00138 (QuantReg: 0.13426) QuantErr: 0.13426 batch_time=0.41007 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 0.00172 (QuantReg: 0.13735) QuantErr: 0.13735 batch_time=0.44562 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 0.00176 (QuantReg: 0.13751) QuantErr: 0.13751 batch_time=0.41914 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 0.00200 (QuantReg: 0.13569) QuantErr: 0.13569 batch_time=0.40530 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 0.00139 (QuantReg: 0.13562) QuantErr: 0.13562 batch_time=0.41132 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 0.00232 (QuantReg: 0.13639) QuantErr: 0.13639 batch_time=0.40179 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 0.00145 (QuantReg: 0.13724) QuantErr: 0.13724 batch_time=0.41145 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 0.00168 (QuantReg: 0.13343) QuantErr: 0.13343 batch_time=0.44536 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 0.00152 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=0.43341 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 0.00158 (QuantReg: 0.13675) QuantErr: 0.13675 batch_time=0.42101 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 0.00192 (QuantReg: 0.13617) QuantErr: 0.13617 batch_time=0.46662 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.00242 (QuantReg: 0.13624) QuantErr: 0.13624 batch_time=0.42472 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.00180 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.40749 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch40.pth ...
Done in 3.500s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 0.0018593368530273437
 quant_reg      : 0.13547851127386093
 quant_err      : 0.13547851127386093
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 60.563380281690144
 MSRVTT_full_val/t2v_metrics/R10: 75.0503018108652
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.086519114688128
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.297604803262544
 MSRVTT_full_val/v2t_metrics/R1: 27.56539235412475
 MSRVTT_full_val/v2t_metrics/R5: 70.4225352112676
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.197183098591548
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.56794414404154
 MSRVTT_full_test/t2v_metrics/R1: 8.862876254180602
 MSRVTT_full_test/t2v_metrics/R5: 28.46153846153846
 MSRVTT_full_test/t2v_metrics/R10: 42.274247491638796
 MSRVTT_full_test/t2v_metrics/R50: 76.35451505016722
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.694648829431436
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.01082466750378
 MSRVTT_full_test/v2t_metrics/R1: 11.438127090301004
 MSRVTT_full_test/v2t_metrics/R5: 34.48160535117057
 MSRVTT_full_test/v2t_metrics/R10: 49.83277591973244
 MSRVTT_full_test/v2t_metrics/R50: 81.67224080267559
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.120066889632106
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.98686842168397
 mnt_best       : 22.161055082005316
 not_improved_count: 5
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.00218 (QuantReg: 0.13568) QuantErr: 0.13568 batch_time=34.83775 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 0.00164 (QuantReg: 0.13607) QuantErr: 0.13607 batch_time=0.41490 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 0.00176 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=0.42926 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 0.00261 (QuantReg: 0.13624) QuantErr: 0.13624 batch_time=0.42737 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 0.00201 (QuantReg: 0.13351) QuantErr: 0.13351 batch_time=0.41336 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.00216 (QuantReg: 0.13559) QuantErr: 0.13559 batch_time=0.43285 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.00201 (QuantReg: 0.13399) QuantErr: 0.13399 batch_time=0.40615 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.00154 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.41849 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 0.00215 (QuantReg: 0.13388) QuantErr: 0.13388 batch_time=0.42413 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 0.00227 (QuantReg: 0.13587) QuantErr: 0.13587 batch_time=0.42419 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 0.00237 (QuantReg: 0.13456) QuantErr: 0.13456 batch_time=0.45939 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 0.00134 (QuantReg: 0.13444) QuantErr: 0.13444 batch_time=0.43772 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 0.00139 (QuantReg: 0.13584) QuantErr: 0.13584 batch_time=0.42268 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 0.00142 (QuantReg: 0.13512) QuantErr: 0.13512 batch_time=0.42084 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 0.00192 (QuantReg: 0.13592) QuantErr: 0.13592 batch_time=0.45530 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 0.00166 (QuantReg: 0.13580) QuantErr: 0.13580 batch_time=0.43331 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 0.00182 (QuantReg: 0.13657) QuantErr: 0.13657 batch_time=0.42095 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.00174 (QuantReg: 0.13410) QuantErr: 0.13410 batch_time=0.41871 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 0.00189 (QuantReg: 0.13449) QuantErr: 0.13449 batch_time=0.43405 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 0.00194 (QuantReg: 0.13327) QuantErr: 0.13327 batch_time=0.44414 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 0.00200 (QuantReg: 0.13934) QuantErr: 0.13934 batch_time=1.92840 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 0.00204 (QuantReg: 0.13690) QuantErr: 0.13690 batch_time=0.42198 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 0.00141 (QuantReg: 0.13535) QuantErr: 0.13535 batch_time=0.42931 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch41.pth ...
Done in 7.634s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch41.pth ...
Done in 19.717s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 0.0018336181640625
 quant_reg      : 0.13550950384140015
 quant_err      : 0.13550950384140015
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_full_val/t2v_metrics/R1: 26.156941649899398
 MSRVTT_full_val/t2v_metrics/R5: 61.16700201207244
 MSRVTT_full_val/t2v_metrics/R10: 75.25150905432595
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.927565392354126
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.37871576140585
 MSRVTT_full_val/v2t_metrics/R1: 30.18108651911469
 MSRVTT_full_val/v2t_metrics/R5: 70.02012072434607
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.102615694164989
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.13471936451235
 MSRVTT_full_test/t2v_metrics/R1: 9.096989966555183
 MSRVTT_full_test/t2v_metrics/R5: 28.561872909698998
 MSRVTT_full_test/t2v_metrics/R10: 42.17391304347826
 MSRVTT_full_test/t2v_metrics/R50: 76.18729096989966
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.417391304347824
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.211408463234715
 MSRVTT_full_test/v2t_metrics/R1: 11.237458193979933
 MSRVTT_full_test/v2t_metrics/R5: 34.68227424749164
 MSRVTT_full_test/v2t_metrics/R10: 49.56521739130435
 MSRVTT_full_test/v2t_metrics/R50: 82.5752508361204
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.10217391304348
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.83186689229019
 mnt_best       : 22.211408463234715
 not_improved_count: 0
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 0.00188 (QuantReg: 0.13498) QuantErr: 0.13498 batch_time=31.27026 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.00172 (QuantReg: 0.13542) QuantErr: 0.13542 batch_time=0.41661 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 0.00185 (QuantReg: 0.13380) QuantErr: 0.13380 batch_time=0.42311 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 0.00207 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.41838 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 0.00178 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.42678 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 0.00186 (QuantReg: 0.13646) QuantErr: 0.13646 batch_time=0.42443 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 0.00153 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=0.41066 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 0.00150 (QuantReg: 0.13383) QuantErr: 0.13383 batch_time=0.41059 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.00164 (QuantReg: 0.13765) QuantErr: 0.13765 batch_time=0.41922 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 0.00248 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.42045 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 0.00174 (QuantReg: 0.13729) QuantErr: 0.13729 batch_time=0.45045 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 0.00182 (QuantReg: 0.13355) QuantErr: 0.13355 batch_time=0.53789 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 0.00116 (QuantReg: 0.13441) QuantErr: 0.13441 batch_time=0.42584 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.00224 (QuantReg: 0.13324) QuantErr: 0.13324 batch_time=0.42267 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 0.00162 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=0.42120 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 0.00130 (QuantReg: 0.13397) QuantErr: 0.13397 batch_time=0.41182 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.00155 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.43319 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.00183 (QuantReg: 0.13501) QuantErr: 0.13501 batch_time=0.43517 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.00141 (QuantReg: 0.13543) QuantErr: 0.13543 batch_time=0.41833 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 0.00202 (QuantReg: 0.13703) QuantErr: 0.13703 batch_time=3.17213 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.00172 (QuantReg: 0.13591) QuantErr: 0.13591 batch_time=0.42993 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.00130 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=0.42679 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 0.00188 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.42396 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch42.pth ...
Done in 3.781s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 0.0018054962158203125
 quant_reg      : 0.13561564743518828
 quant_err      : 0.13561564743518828
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 61.77062374245473
 MSRVTT_full_val/t2v_metrics/R10: 71.83098591549296
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.344064386317907
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.526890664575895
 MSRVTT_full_val/v2t_metrics/R1: 28.772635814889338
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.396378269617706
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.333406832529576
 MSRVTT_full_test/t2v_metrics/R1: 8.929765886287626
 MSRVTT_full_test/t2v_metrics/R5: 28.762541806020067
 MSRVTT_full_test/t2v_metrics/R10: 41.57190635451505
 MSRVTT_full_test/t2v_metrics/R50: 76.0200668896321
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.685953177257524
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.020259133508567
 MSRVTT_full_test/v2t_metrics/R1: 11.036789297658864
 MSRVTT_full_test/v2t_metrics/R5: 34.247491638795985
 MSRVTT_full_test/v2t_metrics/R10: 49.93311036789298
 MSRVTT_full_test/v2t_metrics/R50: 82.07357859531773
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.091973244147155
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.624822006439217
 mnt_best       : 22.211408463234715
 not_improved_count: 1
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.00188 (QuantReg: 0.13665) QuantErr: 0.13665 batch_time=31.35797 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.00159 (QuantReg: 0.13533) QuantErr: 0.13533 batch_time=0.43470 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 0.00259 (QuantReg: 0.13886) QuantErr: 0.13886 batch_time=0.42763 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 0.00179 (QuantReg: 0.13514) QuantErr: 0.13514 batch_time=0.41605 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 0.00165 (QuantReg: 0.13629) QuantErr: 0.13629 batch_time=0.43414 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 0.00293 (QuantReg: 0.13669) QuantErr: 0.13669 batch_time=0.42615 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 0.00151 (QuantReg: 0.13754) QuantErr: 0.13754 batch_time=3.03342 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 0.00166 (QuantReg: 0.13603) QuantErr: 0.13603 batch_time=0.43444 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.00172 (QuantReg: 0.13581) QuantErr: 0.13581 batch_time=0.43926 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 0.00192 (QuantReg: 0.13601) QuantErr: 0.13601 batch_time=0.43917 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 0.00209 (QuantReg: 0.13588) QuantErr: 0.13588 batch_time=0.42704 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.00245 (QuantReg: 0.13541) QuantErr: 0.13541 batch_time=0.42079 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 0.00136 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=1.85913 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.00154 (QuantReg: 0.13587) QuantErr: 0.13587 batch_time=0.41480 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 0.00175 (QuantReg: 0.13588) QuantErr: 0.13588 batch_time=0.42623 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 0.00186 (QuantReg: 0.13562) QuantErr: 0.13562 batch_time=0.41292 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.00198 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.45168 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.00172 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.46178 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 0.00206 (QuantReg: 0.13358) QuantErr: 0.13358 batch_time=3.79274 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 0.00163 (QuantReg: 0.13751) QuantErr: 0.13751 batch_time=0.42291 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 0.00134 (QuantReg: 0.13569) QuantErr: 0.13569 batch_time=0.43038 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.00215 (QuantReg: 0.13711) QuantErr: 0.13711 batch_time=0.44560 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 0.00120 (QuantReg: 0.13477) QuantErr: 0.13477 batch_time=0.42531 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch43.pth ...
Done in 17.893s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch43.pth ...
Done in 21.323s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 0.0017914581298828125
 quant_reg      : 0.13564913070201873
 quant_err      : 0.13564913070201873
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_full_val/t2v_metrics/R1: 25.35211267605634
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 74.64788732394366
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.71830985915493
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.00171228263651
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 69.01408450704226
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.907444668008048
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.84057428473952
 MSRVTT_full_test/t2v_metrics/R1: 9.19732441471572
 MSRVTT_full_test/t2v_metrics/R5: 29.264214046822744
 MSRVTT_full_test/t2v_metrics/R10: 42.17391304347826
 MSRVTT_full_test/t2v_metrics/R50: 76.62207357859532
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.05484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.474019644846997
 MSRVTT_full_test/v2t_metrics/R1: 11.270903010033445
 MSRVTT_full_test/v2t_metrics/R5: 35.01672240802676
 MSRVTT_full_test/v2t_metrics/R10: 50.869565217391305
 MSRVTT_full_test/v2t_metrics/R50: 82.97658862876254
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.00535117056856
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.178829166295632
 mnt_best       : 22.474019644846997
 not_improved_count: 0
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.00120 (QuantReg: 0.13749) QuantErr: 0.13749 batch_time=35.55797 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 0.00253 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=0.40764 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 0.00154 (QuantReg: 0.13569) QuantErr: 0.13569 batch_time=0.41130 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.00174 (QuantReg: 0.13511) QuantErr: 0.13511 batch_time=0.43080 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 0.00215 (QuantReg: 0.13278) QuantErr: 0.13278 batch_time=0.45504 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 0.00167 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.41879 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 0.00156 (QuantReg: 0.13653) QuantErr: 0.13653 batch_time=0.44121 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 0.00200 (QuantReg: 0.13724) QuantErr: 0.13724 batch_time=0.42279 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 0.00191 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=0.42507 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 0.00229 (QuantReg: 0.13639) QuantErr: 0.13639 batch_time=0.40717 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 0.00160 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=0.43422 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 0.00185 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.41967 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 0.00209 (QuantReg: 0.13484) QuantErr: 0.13484 batch_time=0.43027 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 0.00137 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=1.18810 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 0.00157 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=0.42788 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 0.00157 (QuantReg: 0.13740) QuantErr: 0.13740 batch_time=0.44559 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 0.00199 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=0.42835 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.00188 (QuantReg: 0.13633) QuantErr: 0.13633 batch_time=0.42659 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 0.00192 (QuantReg: 0.13691) QuantErr: 0.13691 batch_time=0.41143 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 0.00173 (QuantReg: 0.13496) QuantErr: 0.13496 batch_time=0.86776 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 0.00112 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.47511 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.00170 (QuantReg: 0.13456) QuantErr: 0.13456 batch_time=0.41181 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 0.00151 (QuantReg: 0.13723) QuantErr: 0.13723 batch_time=0.40840 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch44.pth ...
Done in 16.481s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 0.0017609748840332032
 quant_reg      : 0.13552135920524597
 quant_err      : 0.13552135920524597
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_full_val/t2v_metrics/R1: 25.35211267605634
 MSRVTT_full_val/t2v_metrics/R5: 59.95975855130785
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.036217303822937
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.92992115628219
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.142857142857142
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.709517553801426
 MSRVTT_full_test/t2v_metrics/R1: 9.297658862876254
 MSRVTT_full_test/t2v_metrics/R5: 28.494983277591974
 MSRVTT_full_test/t2v_metrics/R10: 41.73913043478261
 MSRVTT_full_test/t2v_metrics/R50: 75.91973244147157
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.03110367892977
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.278971453298745
 MSRVTT_full_test/v2t_metrics/R1: 10.80267558528428
 MSRVTT_full_test/v2t_metrics/R5: 34.34782608695652
 MSRVTT_full_test/v2t_metrics/R10: 49.96655518394649
 MSRVTT_full_test/v2t_metrics/R50: 82.70903010033445
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.08829431438127
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.4669156212364
 mnt_best       : 22.474019644846997
 not_improved_count: 1
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 0.00211 (QuantReg: 0.13628) QuantErr: 0.13628 batch_time=34.21787 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.00129 (QuantReg: 0.13630) QuantErr: 0.13630 batch_time=0.40902 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.00141 (QuantReg: 0.13566) QuantErr: 0.13566 batch_time=0.42371 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 0.00168 (QuantReg: 0.13429) QuantErr: 0.13429 batch_time=0.42601 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 0.00159 (QuantReg: 0.13468) QuantErr: 0.13468 batch_time=0.41928 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 0.00197 (QuantReg: 0.13699) QuantErr: 0.13699 batch_time=0.42700 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.00166 (QuantReg: 0.13696) QuantErr: 0.13696 batch_time=0.42728 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 0.00177 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=0.43913 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 0.00248 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.42588 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.00178 (QuantReg: 0.13766) QuantErr: 0.13766 batch_time=0.42954 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.00185 (QuantReg: 0.13762) QuantErr: 0.13762 batch_time=0.67989 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 0.00162 (QuantReg: 0.13771) QuantErr: 0.13771 batch_time=0.43345 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.00144 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=1.09524 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 0.00201 (QuantReg: 0.13647) QuantErr: 0.13647 batch_time=3.13879 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 0.00137 (QuantReg: 0.13657) QuantErr: 0.13657 batch_time=0.42631 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.00177 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.42034 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 0.00157 (QuantReg: 0.13526) QuantErr: 0.13526 batch_time=0.41437 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 0.00179 (QuantReg: 0.13543) QuantErr: 0.13543 batch_time=0.42106 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.00207 (QuantReg: 0.13429) QuantErr: 0.13429 batch_time=0.41418 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.00234 (QuantReg: 0.13818) QuantErr: 0.13818 batch_time=0.42329 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 0.00204 (QuantReg: 0.13812) QuantErr: 0.13812 batch_time=0.42135 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.00147 (QuantReg: 0.13609) QuantErr: 0.13609 batch_time=0.44882 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 0.00182 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.41923 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch45.pth ...
Done in 3.754s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch45.pth ...
Done in 12.345s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 0.0017581901550292969
 quant_reg      : 0.13572450786828993
 quant_err      : 0.13572450786828993
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 60.96579476861167
 MSRVTT_full_val/t2v_metrics/R10: 73.03822937625755
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.875251509054326
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.71057608610274
 MSRVTT_full_val/v2t_metrics/R1: 29.77867203219316
 MSRVTT_full_val/v2t_metrics/R5: 68.81287726358148
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.14486921529175
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.24767264922181
 MSRVTT_full_test/t2v_metrics/R1: 9.498327759197325
 MSRVTT_full_test/t2v_metrics/R5: 29.36454849498328
 MSRVTT_full_test/t2v_metrics/R10: 42.240802675585286
 MSRVTT_full_test/t2v_metrics/R50: 76.42140468227424
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.57658862876254
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.75451311306892
 MSRVTT_full_test/v2t_metrics/R1: 10.702341137123746
 MSRVTT_full_test/v2t_metrics/R5: 34.247491638795985
 MSRVTT_full_test/v2t_metrics/R10: 49.83277591973244
 MSRVTT_full_test/v2t_metrics/R50: 82.54180602006689
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.71103678929766
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.33545823594277
 mnt_best       : 22.75451311306892
 not_improved_count: 0
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.00165 (QuantReg: 0.13610) QuantErr: 0.13610 batch_time=32.82411 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 0.00143 (QuantReg: 0.13855) QuantErr: 0.13855 batch_time=0.41981 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.00208 (QuantReg: 0.13606) QuantErr: 0.13606 batch_time=0.42898 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.00193 (QuantReg: 0.13829) QuantErr: 0.13829 batch_time=0.42939 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 0.00113 (QuantReg: 0.13535) QuantErr: 0.13535 batch_time=0.43447 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 0.00133 (QuantReg: 0.13642) QuantErr: 0.13642 batch_time=0.41624 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.00195 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=0.42590 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 0.00179 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.42390 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.00165 (QuantReg: 0.13541) QuantErr: 0.13541 batch_time=0.42685 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.00152 (QuantReg: 0.13733) QuantErr: 0.13733 batch_time=0.41582 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 0.00182 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.42789 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 0.00185 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=0.42465 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 0.00197 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=0.42675 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 0.00124 (QuantReg: 0.13509) QuantErr: 0.13509 batch_time=3.16982 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 0.00215 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.44774 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 0.00216 (QuantReg: 0.13365) QuantErr: 0.13365 batch_time=0.43012 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 0.00164 (QuantReg: 0.13715) QuantErr: 0.13715 batch_time=0.43302 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 0.00117 (QuantReg: 0.13731) QuantErr: 0.13731 batch_time=0.43344 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.00175 (QuantReg: 0.13567) QuantErr: 0.13567 batch_time=0.44935 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.00226 (QuantReg: 0.13533) QuantErr: 0.13533 batch_time=0.44020 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.00147 (QuantReg: 0.13278) QuantErr: 0.13278 batch_time=0.43619 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 0.00198 (QuantReg: 0.13543) QuantErr: 0.13543 batch_time=0.41765 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.00153 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=0.41804 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch46.pth ...
Done in 3.824s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 0.0017362289428710937
 quant_reg      : 0.13570400214195252
 quant_err      : 0.13570400214195252
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 60.76458752515091
 MSRVTT_full_val/t2v_metrics/R10: 74.04426559356136
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.0
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.10943268150935
 MSRVTT_full_val/v2t_metrics/R1: 29.77867203219316
 MSRVTT_full_val/v2t_metrics/R5: 68.81287726358148
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.088531187122737
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.47189455704436
 MSRVTT_full_test/t2v_metrics/R1: 9.130434782608695
 MSRVTT_full_test/t2v_metrics/R5: 28.896321070234112
 MSRVTT_full_test/t2v_metrics/R10: 41.67224080267559
 MSRVTT_full_test/t2v_metrics/R50: 76.12040133779264
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.938795986622075
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.236185529603347
 MSRVTT_full_test/v2t_metrics/R1: 11.404682274247492
 MSRVTT_full_test/v2t_metrics/R5: 34.080267558528426
 MSRVTT_full_test/v2t_metrics/R10: 49.69899665551839
 MSRVTT_full_test/v2t_metrics/R50: 83.27759197324414
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.44983277591973
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.831478385189662
 mnt_best       : 22.75451311306892
 not_improved_count: 1
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 0.00188 (QuantReg: 0.13616) QuantErr: 0.13616 batch_time=35.73113 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 0.00192 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.41451 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 0.00170 (QuantReg: 0.13572) QuantErr: 0.13572 batch_time=0.43832 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 0.00145 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.42330 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 0.00160 (QuantReg: 0.13470) QuantErr: 0.13470 batch_time=0.43438 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.00183 (QuantReg: 0.13777) QuantErr: 0.13777 batch_time=0.42987 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 0.00277 (QuantReg: 0.13691) QuantErr: 0.13691 batch_time=0.42717 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 0.00167 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.41345 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 0.00156 (QuantReg: 0.13496) QuantErr: 0.13496 batch_time=0.42086 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.00143 (QuantReg: 0.13354) QuantErr: 0.13354 batch_time=0.41818 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.00140 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.41503 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.00219 (QuantReg: 0.13324) QuantErr: 0.13324 batch_time=0.42330 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 0.00174 (QuantReg: 0.13800) QuantErr: 0.13800 batch_time=0.42339 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.00173 (QuantReg: 0.13408) QuantErr: 0.13408 batch_time=0.41808 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 0.00191 (QuantReg: 0.13718) QuantErr: 0.13718 batch_time=0.42330 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.00146 (QuantReg: 0.13552) QuantErr: 0.13552 batch_time=0.42225 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 0.00146 (QuantReg: 0.13530) QuantErr: 0.13530 batch_time=0.45844 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 0.00200 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=0.42660 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 0.00128 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=0.42164 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.00123 (QuantReg: 0.13492) QuantErr: 0.13492 batch_time=1.13289 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.00267 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=0.42746 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 0.00189 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=0.44425 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 0.00163 (QuantReg: 0.13621) QuantErr: 0.13621 batch_time=0.42863 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch47.pth ...
Done in 3.750s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 0.001678516387939453
 quant_reg      : 0.13565020859241486
 quant_err      : 0.13565020859241486
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 60.36217303822938
 MSRVTT_full_val/t2v_metrics/R10: 74.64788732394366
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.126760563380282
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.133085590718984
 MSRVTT_full_val/v2t_metrics/R1: 29.37625754527163
 MSRVTT_full_val/v2t_metrics/R5: 68.61167002012073
 MSRVTT_full_val/v2t_metrics/R10: 81.89134808853119
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.253521126760564
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.85431876547926
 MSRVTT_full_test/t2v_metrics/R1: 9.063545150501673
 MSRVTT_full_test/t2v_metrics/R5: 28.929765886287626
 MSRVTT_full_test/t2v_metrics/R10: 42.0066889632107
 MSRVTT_full_test/t2v_metrics/R50: 76.25418060200668
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.5066889632107
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.249512046630755
 MSRVTT_full_test/v2t_metrics/R1: 11.471571906354516
 MSRVTT_full_test/v2t_metrics/R5: 34.68227424749164
 MSRVTT_full_test/v2t_metrics/R10: 49.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 82.44147157190635
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.823076923076925
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.029067995249203
 mnt_best       : 22.75451311306892
 not_improved_count: 2
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 0.00182 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=31.46755 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 0.00120 (QuantReg: 0.13560) QuantErr: 0.13560 batch_time=2.00562 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 0.00119 (QuantReg: 0.13498) QuantErr: 0.13498 batch_time=0.40838 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 0.00207 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.41903 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 0.00146 (QuantReg: 0.13553) QuantErr: 0.13553 batch_time=0.42776 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 0.00210 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=0.43027 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 0.00202 (QuantReg: 0.13498) QuantErr: 0.13498 batch_time=2.61419 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 0.00194 (QuantReg: 0.13460) QuantErr: 0.13460 batch_time=0.41337 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.00125 (QuantReg: 0.13530) QuantErr: 0.13530 batch_time=0.81148 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 0.00131 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.41821 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 0.00148 (QuantReg: 0.13550) QuantErr: 0.13550 batch_time=0.41434 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 0.00263 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=0.42403 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 0.00120 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.42652 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 0.00152 (QuantReg: 0.13519) QuantErr: 0.13519 batch_time=0.41223 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 0.00127 (QuantReg: 0.13727) QuantErr: 0.13727 batch_time=0.41375 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 0.00166 (QuantReg: 0.13390) QuantErr: 0.13390 batch_time=0.64309 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.00185 (QuantReg: 0.13714) QuantErr: 0.13714 batch_time=0.42934 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 0.00157 (QuantReg: 0.13556) QuantErr: 0.13556 batch_time=0.40653 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 0.00184 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=3.02954 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 0.00204 (QuantReg: 0.13573) QuantErr: 0.13573 batch_time=0.41144 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 0.00246 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=0.43199 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 0.00136 (QuantReg: 0.13627) QuantErr: 0.13627 batch_time=0.42468 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 0.00235 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=0.42895 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch48.pth ...
Done in 3.703s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 0.0016621742248535156
 quant_reg      : 0.13569866263866426
 quant_err      : 0.13569866263866426
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 61.16700201207244
 MSRVTT_full_val/t2v_metrics/R10: 74.84909456740442
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.887323943661972
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.38946526620282
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.032193158953723
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.60672843325018
 MSRVTT_full_test/t2v_metrics/R1: 9.297658862876254
 MSRVTT_full_test/t2v_metrics/R5: 28.561872909698998
 MSRVTT_full_test/t2v_metrics/R10: 41.93979933110368
 MSRVTT_full_test/t2v_metrics/R50: 76.22073578595318
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.864548494983275
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.332064801139868
 MSRVTT_full_test/v2t_metrics/R1: 11.070234113712374
 MSRVTT_full_test/v2t_metrics/R5: 34.91638795986622
 MSRVTT_full_test/v2t_metrics/R10: 50.53511705685619
 MSRVTT_full_test/v2t_metrics/R50: 82.50836120401338
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.30635451505017
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.93145376042176
 mnt_best       : 22.75451311306892
 not_improved_count: 3
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 0.00212 (QuantReg: 0.13666) QuantErr: 0.13666 batch_time=36.26352 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 0.00179 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.41988 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 0.00174 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.42013 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 0.00251 (QuantReg: 0.13617) QuantErr: 0.13617 batch_time=0.41849 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 0.00163 (QuantReg: 0.13665) QuantErr: 0.13665 batch_time=0.42418 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 0.00250 (QuantReg: 0.13270) QuantErr: 0.13270 batch_time=0.41932 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 0.00147 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.41589 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.00191 (QuantReg: 0.13583) QuantErr: 0.13583 batch_time=0.42389 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.00192 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.41872 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.00201 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.41432 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 0.00118 (QuantReg: 0.13591) QuantErr: 0.13591 batch_time=0.41268 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.00172 (QuantReg: 0.13583) QuantErr: 0.13583 batch_time=0.41696 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 0.00129 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.65929 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 0.00114 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=1.05475 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 0.00174 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.44972 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.00155 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=0.56021 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.00135 (QuantReg: 0.13410) QuantErr: 0.13410 batch_time=0.41552 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 0.00158 (QuantReg: 0.13714) QuantErr: 0.13714 batch_time=0.41048 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 0.00208 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=1.83896 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 0.00157 (QuantReg: 0.13408) QuantErr: 0.13408 batch_time=0.41534 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 0.00163 (QuantReg: 0.13443) QuantErr: 0.13443 batch_time=0.46403 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.00171 (QuantReg: 0.13356) QuantErr: 0.13356 batch_time=0.41755 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 0.00156 (QuantReg: 0.13679) QuantErr: 0.13679 batch_time=0.42320 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch49.pth ...
Done in 9.178s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch49.pth ...
Done in 21.597s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 0.0016498031616210937
 quant_reg      : 0.1356997168660164
 quant_err      : 0.1356997168660164
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_full_val/t2v_metrics/R1: 26.156941649899398
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 75.65392354124748
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.70824949698189
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.73630338250955
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 82.69617706237425
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.808853118712274
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.44639621571262
 MSRVTT_full_test/t2v_metrics/R1: 9.23076923076923
 MSRVTT_full_test/t2v_metrics/R5: 29.665551839464882
 MSRVTT_full_test/t2v_metrics/R10: 43.1438127090301
 MSRVTT_full_test/t2v_metrics/R50: 76.52173913043478
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.07625418060201
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.775588929291917
 MSRVTT_full_test/v2t_metrics/R1: 11.20401337792642
 MSRVTT_full_test/v2t_metrics/R5: 34.71571906354515
 MSRVTT_full_test/v2t_metrics/R10: 49.89966555183946
 MSRVTT_full_test/v2t_metrics/R50: 82.6086956521739
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.532775919732444
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.874009905444968
 mnt_best       : 22.775588929291917
 not_improved_count: 0
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 0.00197 (QuantReg: 0.13584) QuantErr: 0.13584 batch_time=30.46169 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 0.00117 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=0.41866 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 0.00184 (QuantReg: 0.13345) QuantErr: 0.13345 batch_time=0.42832 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 0.00169 (QuantReg: 0.13683) QuantErr: 0.13683 batch_time=0.40598 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 0.00130 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.41958 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.00188 (QuantReg: 0.13358) QuantErr: 0.13358 batch_time=0.42341 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 0.00088 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=2.48465 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.00144 (QuantReg: 0.13671) QuantErr: 0.13671 batch_time=0.42198 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.00147 (QuantReg: 0.13560) QuantErr: 0.13560 batch_time=0.41727 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 0.00173 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.41819 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.00175 (QuantReg: 0.13638) QuantErr: 0.13638 batch_time=0.42069 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.00145 (QuantReg: 0.13473) QuantErr: 0.13473 batch_time=0.42197 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 0.00111 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.44572 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 0.00180 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.45376 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 0.00155 (QuantReg: 0.13544) QuantErr: 0.13544 batch_time=3.38168 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.00172 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.42339 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 0.00175 (QuantReg: 0.13762) QuantErr: 0.13762 batch_time=0.42879 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 0.00189 (QuantReg: 0.13600) QuantErr: 0.13600 batch_time=0.44811 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.00087 (QuantReg: 0.13573) QuantErr: 0.13573 batch_time=0.43650 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.00146 (QuantReg: 0.13642) QuantErr: 0.13642 batch_time=0.75714 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 0.00170 (QuantReg: 0.13576) QuantErr: 0.13576 batch_time=0.41625 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 0.00150 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.41038 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 0.00219 (QuantReg: 0.13715) QuantErr: 0.13715 batch_time=0.40900 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch50.pth ...
Done in 3.750s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/checkpoint-epoch50.pth ...
Done in 7.480s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 0.0015924205780029296
 quant_reg      : 0.13559707725048065
 quant_err      : 0.13559707725048065
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 62.57545271629779
 MSRVTT_full_val/t2v_metrics/R10: 75.45271629778672
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.672032193158953
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.54245079715408
 MSRVTT_full_val/v2t_metrics/R1: 31.99195171026157
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 83.5010060362173
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.9476861167002015
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.353649389610524
 MSRVTT_full_test/t2v_metrics/R1: 9.297658862876254
 MSRVTT_full_test/t2v_metrics/R5: 30.0
 MSRVTT_full_test/t2v_metrics/R10: 43.44481605351171
 MSRVTT_full_test/t2v_metrics/R50: 77.49163879598662
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.99531772575251
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.969115680652845
 MSRVTT_full_test/v2t_metrics/R1: 11.438127090301004
 MSRVTT_full_test/v2t_metrics/R5: 36.2876254180602
 MSRVTT_full_test/v2t_metrics/R10: 51.30434782608695
 MSRVTT_full_test/v2t_metrics/R50: 82.8428093645485
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 36.99799331103679
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.717616374767363
 mnt_best       : 22.969115680652845
 not_improved_count: 0
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/trained_model.pth ...
Ckpt loaded at epoch 50.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 9.297658862876254
 t2v_metrics/R5/final_eval: 30.0
 t2v_metrics/R10/final_eval: 43.44481605351171
 t2v_metrics/R50/final_eval: 77.49163879598662
 t2v_metrics/MedR/final_eval: 14.0
 t2v_metrics/MeanR/final_eval: 49.99531772575251
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 22.969115680652845
 v2t_metrics/R1/final_eval: 11.438127090301004
 v2t_metrics/R5/final_eval: 36.2876254180602
 v2t_metrics/R10/final_eval: 51.30434782608695
 v2t_metrics/R50/final_eval: 82.8428093645485
 v2t_metrics/MedR/final_eval: 10.0
 v2t_metrics/MeanR/final_eval: 36.99799331103679
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 27.717616374767363
Best epoch for the monitored metric: 50
Script took 03h42m48s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_full/trained_model.pth
