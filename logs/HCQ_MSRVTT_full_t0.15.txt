Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 1072.1231582164764 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 50.19671893119812 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 366.5434219837189 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 60.78925323486328 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch0.pth ...
Done in 1.847s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch0.pth ...
Done in 3.257s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.0
 MSRVTT_full_val/t2v_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R10: 1.6096579476861168
 MSRVTT_full_val/t2v_metrics/R50: 8.450704225352112
 MSRVTT_full_val/t2v_metrics/MedR: 252.0
 MSRVTT_full_val/t2v_metrics/MeanR: 251.21730382293762
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_val/v2t_metrics/R1: 0.0
 MSRVTT_full_val/v2t_metrics/R5: 0.8048289738430584
 MSRVTT_full_val/v2t_metrics/R10: 2.0120724346076457
 MSRVTT_full_val/v2t_metrics/R50: 9.054325955734406
 MSRVTT_full_val/v2t_metrics/MedR: 243.0
 MSRVTT_full_val/v2t_metrics/MeanR: 247.7344064386318
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/t2v_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.26755852842809363
 MSRVTT_full_test/t2v_metrics/R50: 1.705685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 1515.0
 MSRVTT_full_test/t2v_metrics/MeanR: 1498.5565217391304
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.12154652794863813
 MSRVTT_full_test/v2t_metrics/R1: 0.06688963210702341
 MSRVTT_full_test/v2t_metrics/R5: 0.16722408026755853
 MSRVTT_full_test/v2t_metrics/R10: 0.3010033444816054
 MSRVTT_full_test/v2t_metrics/R50: 1.806020066889632
 MSRVTT_full_test/v2t_metrics/MedR: 1471.5
 MSRVTT_full_test/v2t_metrics/MeanR: 1495.3264214046824
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.14987975740993859
 mnt_best       : 0.12154652794863813
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.71980 (QuantReg: 22.44377) QuantErr: 22.44377 batch_time=39.89561 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.85195 (QuantReg: 22.55325) QuantErr: 22.55325 batch_time=0.51681 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.36770 (QuantReg: 22.61552) QuantErr: 22.61552 batch_time=0.50155 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 7.21120 (QuantReg: 22.61015) QuantErr: 22.61015 batch_time=0.54296 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.73242 (QuantReg: 22.61219) QuantErr: 22.61219 batch_time=0.50793 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.47584 (QuantReg: 22.59515) QuantErr: 22.59515 batch_time=0.50933 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 6.45215 (QuantReg: 22.62016) QuantErr: 22.62016 batch_time=0.53975 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 6.18735 (QuantReg: 22.61082) QuantErr: 22.61082 batch_time=0.50017 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.97641 (QuantReg: 22.63460) QuantErr: 22.63460 batch_time=0.50294 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 6.02404 (QuantReg: 22.61957) QuantErr: 22.61957 batch_time=0.52662 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.75997 (QuantReg: 22.65413) QuantErr: 22.65413 batch_time=1.06623 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 5.60003 (QuantReg: 22.63161) QuantErr: 22.63161 batch_time=0.52704 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.56505 (QuantReg: 22.61616) QuantErr: 22.61616 batch_time=0.49868 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 5.48185 (QuantReg: 22.63235) QuantErr: 22.63235 batch_time=0.49919 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 5.49767 (QuantReg: 22.61691) QuantErr: 22.61691 batch_time=0.54870 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 5.63331 (QuantReg: 22.61498) QuantErr: 22.61498 batch_time=0.50558 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 5.46654 (QuantReg: 22.60433) QuantErr: 22.60433 batch_time=0.49204 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 5.21180 (QuantReg: 22.61203) QuantErr: 22.61203 batch_time=0.50412 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 5.23559 (QuantReg: 22.57929) QuantErr: 22.57929 batch_time=0.50963 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 5.05148 (QuantReg: 22.58998) QuantErr: 22.58998 batch_time=0.50222 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 5.23411 (QuantReg: 22.62759) QuantErr: 22.62759 batch_time=0.54205 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 5.15906 (QuantReg: 22.61801) QuantErr: 22.61801 batch_time=0.49781 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 4.85784 (QuantReg: 22.57612) QuantErr: 22.57612 batch_time=0.53121 
Train Epoch: 1 codebook_update_time=1.74698
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch1.pth ...
Done in 4.112s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch1.pth ...
Done in 8.153s
 epoch          : 1
 loss           : 5.980801687240601
 quant_reg      : 22.60113138580322
 quant_err      : 22.60113138580322
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 16.498993963782695
 MSRVTT_full_val/t2v_metrics/R5: 45.67404426559356
 MSRVTT_full_val/t2v_metrics/R10: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R50: 94.16498993963782
 MSRVTT_full_val/t2v_metrics/MedR: 7.0
 MSRVTT_full_val/t2v_metrics/MeanR: 16.080482897384307
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 35.93331820482901
 MSRVTT_full_val/v2t_metrics/R1: 20.72434607645875
 MSRVTT_full_val/v2t_metrics/R5: 50.503018108651915
 MSRVTT_full_val/v2t_metrics/R10: 65.59356136820925
 MSRVTT_full_val/v2t_metrics/R50: 93.56136820925553
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 14.865191146881287
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 40.946783606268575
 MSRVTT_full_test/t2v_metrics/R1: 5.117056856187291
 MSRVTT_full_test/t2v_metrics/R5: 16.989966555183948
 MSRVTT_full_test/t2v_metrics/R10: 26.622073578595316
 MSRVTT_full_test/t2v_metrics/R50: 60.903010033444815
 MSRVTT_full_test/t2v_metrics/MedR: 31.0
 MSRVTT_full_test/t2v_metrics/MeanR: 87.74013377926421
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 13.227716607539838
 MSRVTT_full_test/v2t_metrics/R1: 5.618729096989966
 MSRVTT_full_test/v2t_metrics/R5: 18.26086956521739
 MSRVTT_full_test/v2t_metrics/R10: 28.361204013377925
 MSRVTT_full_test/v2t_metrics/R50: 64.04682274247492
 MSRVTT_full_test/v2t_metrics/MedR: 29.0
 MSRVTT_full_test/v2t_metrics/MeanR: 83.12140468227425
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 14.276707787678664
 mnt_best       : 13.227716607539838
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.80599 (QuantReg: 8.93690) QuantErr: 8.93690 batch_time=37.26274 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.86365 (QuantReg: 8.69148) QuantErr: 8.69148 batch_time=0.49905 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.84969 (QuantReg: 9.13306) QuantErr: 9.13306 batch_time=1.55224 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 4.73600 (QuantReg: 9.21926) QuantErr: 9.21926 batch_time=0.50782 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 4.76942 (QuantReg: 9.29076) QuantErr: 9.29076 batch_time=0.50231 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 4.61778 (QuantReg: 9.00625) QuantErr: 9.00625 batch_time=0.51719 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.92570 (QuantReg: 9.54889) QuantErr: 9.54889 batch_time=0.77187 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 4.67356 (QuantReg: 9.49042) QuantErr: 9.49042 batch_time=0.51220 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 5.02438 (QuantReg: 9.67104) QuantErr: 9.67104 batch_time=0.50411 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.64042 (QuantReg: 9.42451) QuantErr: 9.42451 batch_time=0.49991 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 4.58460 (QuantReg: 9.31475) QuantErr: 9.31475 batch_time=0.51309 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 4.55816 (QuantReg: 9.45503) QuantErr: 9.45503 batch_time=0.51296 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 4.29199 (QuantReg: 9.78026) QuantErr: 9.78026 batch_time=0.50891 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.42858 (QuantReg: 9.74329) QuantErr: 9.74329 batch_time=0.52729 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 4.32506 (QuantReg: 10.05841) QuantErr: 10.05841 batch_time=0.51863 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 4.48838 (QuantReg: 10.31563) QuantErr: 10.31563 batch_time=0.50773 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 4.52270 (QuantReg: 9.90040) QuantErr: 9.90040 batch_time=0.49990 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 4.55883 (QuantReg: 10.25563) QuantErr: 10.25563 batch_time=0.49759 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 4.15462 (QuantReg: 10.13753) QuantErr: 10.13753 batch_time=0.49257 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 4.34741 (QuantReg: 10.32012) QuantErr: 10.32012 batch_time=0.50113 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 4.12188 (QuantReg: 10.33519) QuantErr: 10.33519 batch_time=0.50045 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 4.69803 (QuantReg: 10.23737) QuantErr: 10.23737 batch_time=0.51584 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 4.55508 (QuantReg: 10.91043) QuantErr: 10.91043 batch_time=0.50243 
Train Epoch: 2 codebook_update_time=1.63282
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch2.pth ...
Done in 4.433s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch2.pth ...
Done in 8.650s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 4.598513472557068
 quant_reg      : 9.676484245300292
 quant_err      : 9.676484245300292
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 16.70020120724346
 MSRVTT_full_val/t2v_metrics/R5: 50.70422535211268
 MSRVTT_full_val/t2v_metrics/R10: 65.79476861167002
 MSRVTT_full_val/t2v_metrics/R50: 94.76861167002012
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 13.70824949698189
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 38.193172984595954
 MSRVTT_full_val/v2t_metrics/R1: 21.730382293762574
 MSRVTT_full_val/v2t_metrics/R5: 53.92354124748491
 MSRVTT_full_val/v2t_metrics/R10: 73.44064386317908
 MSRVTT_full_val/v2t_metrics/R50: 94.96981891348088
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.35010060362173
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 44.14966534047218
 MSRVTT_full_test/t2v_metrics/R1: 5.8193979933110365
 MSRVTT_full_test/t2v_metrics/R5: 20.367892976588628
 MSRVTT_full_test/t2v_metrics/R10: 31.036789297658864
 MSRVTT_full_test/t2v_metrics/R50: 66.82274247491638
 MSRVTT_full_test/t2v_metrics/MedR: 24.0
 MSRVTT_full_test/t2v_metrics/MeanR: 71.5304347826087
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.43714502060139
 MSRVTT_full_test/v2t_metrics/R1: 6.989966555183947
 MSRVTT_full_test/v2t_metrics/R5: 23.210702341137125
 MSRVTT_full_test/v2t_metrics/R10: 36.08695652173913
 MSRVTT_full_test/v2t_metrics/R50: 70.50167224080268
 MSRVTT_full_test/v2t_metrics/MedR: 20.0
 MSRVTT_full_test/v2t_metrics/MeanR: 64.14414715719064
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 18.023448036368976
 mnt_best       : 15.43714502060139
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 4.15265 (QuantReg: 7.77105) QuantErr: 7.77105 batch_time=43.18463 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 4.47773 (QuantReg: 8.03559) QuantErr: 8.03559 batch_time=0.48996 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 4.57136 (QuantReg: 8.36885) QuantErr: 8.36885 batch_time=0.48862 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 4.06489 (QuantReg: 7.38800) QuantErr: 7.38800 batch_time=0.53601 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 4.37694 (QuantReg: 7.85654) QuantErr: 7.85654 batch_time=0.51228 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 4.01733 (QuantReg: 7.78442) QuantErr: 7.78442 batch_time=0.52500 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 4.13443 (QuantReg: 7.78326) QuantErr: 7.78326 batch_time=0.50456 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 4.29860 (QuantReg: 7.73466) QuantErr: 7.73466 batch_time=0.62772 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 4.16914 (QuantReg: 7.75987) QuantErr: 7.75987 batch_time=0.50581 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 4.01711 (QuantReg: 7.99281) QuantErr: 7.99281 batch_time=0.49397 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 4.18565 (QuantReg: 8.07344) QuantErr: 8.07344 batch_time=0.49702 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.84076 (QuantReg: 8.06070) QuantErr: 8.06070 batch_time=0.49201 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 4.39604 (QuantReg: 8.28122) QuantErr: 8.28122 batch_time=0.48932 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 4.13635 (QuantReg: 8.56837) QuantErr: 8.56837 batch_time=0.49629 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 4.64793 (QuantReg: 8.23061) QuantErr: 8.23061 batch_time=0.49871 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 3.82570 (QuantReg: 8.56941) QuantErr: 8.56941 batch_time=1.15517 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.74509 (QuantReg: 8.26239) QuantErr: 8.26239 batch_time=0.50058 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 4.20095 (QuantReg: 8.27060) QuantErr: 8.27060 batch_time=0.51863 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.81882 (QuantReg: 8.23035) QuantErr: 8.23035 batch_time=0.49834 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 4.25564 (QuantReg: 8.45681) QuantErr: 8.45681 batch_time=0.49267 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.82808 (QuantReg: 8.57736) QuantErr: 8.57736 batch_time=0.51540 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.74846 (QuantReg: 8.65932) QuantErr: 8.65932 batch_time=0.51707 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.95860 (QuantReg: 8.64468) QuantErr: 8.64468 batch_time=0.50266 
Train Epoch: 3 codebook_update_time=1.87990
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch3.pth ...
Done in 4.216s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch3.pth ...
Done in 8.661s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 4.154468665122986
 quant_reg      : 8.181871543884277
 quant_err      : 8.181871543884277
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 23.138832997987926
 MSRVTT_full_val/t2v_metrics/R5: 56.74044265593562
 MSRVTT_full_val/t2v_metrics/R10: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.267605633802816
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.21840878005637
 MSRVTT_full_val/v2t_metrics/R1: 24.346076458752513
 MSRVTT_full_val/v2t_metrics/R5: 61.3682092555332
 MSRVTT_full_val/v2t_metrics/R10: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R50: 95.57344064386318
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.953722334004024
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.2646560067785
 MSRVTT_full_test/t2v_metrics/R1: 8.193979933110368
 MSRVTT_full_test/t2v_metrics/R5: 24.782608695652176
 MSRVTT_full_test/t2v_metrics/R10: 36.8561872909699
 MSRVTT_full_test/t2v_metrics/R50: 71.83946488294315
 MSRVTT_full_test/t2v_metrics/MedR: 19.0
 MSRVTT_full_test/t2v_metrics/MeanR: 60.56421404682274
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.5606871584151
 MSRVTT_full_test/v2t_metrics/R1: 8.361204013377927
 MSRVTT_full_test/v2t_metrics/R5: 26.65551839464883
 MSRVTT_full_test/v2t_metrics/R10: 39.23076923076923
 MSRVTT_full_test/v2t_metrics/R50: 75.01672240802675
 MSRVTT_full_test/v2t_metrics/MedR: 17.0
 MSRVTT_full_test/v2t_metrics/MeanR: 59.00752508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.601282573467344
 mnt_best       : 19.5606871584151
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 4.34748 (QuantReg: 7.34884) QuantErr: 7.34884 batch_time=41.53302 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 4.03640 (QuantReg: 7.34143) QuantErr: 7.34143 batch_time=0.50620 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 3.72095 (QuantReg: 7.39296) QuantErr: 7.39296 batch_time=0.50444 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 3.86138 (QuantReg: 7.31603) QuantErr: 7.31603 batch_time=0.50891 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 4.06921 (QuantReg: 7.37367) QuantErr: 7.37367 batch_time=0.51294 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 4.21882 (QuantReg: 7.39543) QuantErr: 7.39543 batch_time=0.48711 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 4.06902 (QuantReg: 7.45524) QuantErr: 7.45524 batch_time=0.50183 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 4.03109 (QuantReg: 7.43747) QuantErr: 7.43747 batch_time=0.49952 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 3.83535 (QuantReg: 7.33505) QuantErr: 7.33505 batch_time=0.50440 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 3.76933 (QuantReg: 7.42062) QuantErr: 7.42062 batch_time=0.50400 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 3.96317 (QuantReg: 7.68034) QuantErr: 7.68034 batch_time=0.76031 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 3.97566 (QuantReg: 7.32546) QuantErr: 7.32546 batch_time=0.50307 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.80945 (QuantReg: 7.40163) QuantErr: 7.40163 batch_time=0.48711 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 3.99487 (QuantReg: 7.94741) QuantErr: 7.94741 batch_time=0.50662 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 3.87656 (QuantReg: 7.85691) QuantErr: 7.85691 batch_time=0.50745 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 4.11499 (QuantReg: 8.18011) QuantErr: 8.18011 batch_time=0.50202 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 4.08940 (QuantReg: 7.90070) QuantErr: 7.90070 batch_time=0.50356 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 4.00631 (QuantReg: 8.17914) QuantErr: 8.17914 batch_time=0.50654 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 3.89514 (QuantReg: 7.80358) QuantErr: 7.80358 batch_time=0.50267 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 3.75872 (QuantReg: 7.78012) QuantErr: 7.78012 batch_time=0.52434 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 3.76781 (QuantReg: 8.15564) QuantErr: 8.15564 batch_time=1.03732 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 3.92667 (QuantReg: 7.79736) QuantErr: 7.79736 batch_time=0.51547 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 3.76574 (QuantReg: 7.77117) QuantErr: 7.77117 batch_time=0.50239 
Train Epoch: 4 codebook_update_time=1.83728
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch4.pth ...
Done in 4.615s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 3.9034011993408204
 quant_reg      : 7.68858025932312
 quant_err      : 7.68858025932312
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 21.52917505030181
 MSRVTT_full_val/t2v_metrics/R5: 53.521126760563384
 MSRVTT_full_val/t2v_metrics/R10: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 13.078470824949699
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.16932330350488
 MSRVTT_full_val/v2t_metrics/R1: 23.34004024144869
 MSRVTT_full_val/v2t_metrics/R5: 61.77062374245473
 MSRVTT_full_val/v2t_metrics/R10: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.69215291750503
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 47.69427669476766
 MSRVTT_full_test/t2v_metrics/R1: 7.357859531772576
 MSRVTT_full_test/t2v_metrics/R5: 23.812709030100333
 MSRVTT_full_test/t2v_metrics/R10: 35.51839464882943
 MSRVTT_full_test/t2v_metrics/R50: 70.20066889632108
 MSRVTT_full_test/t2v_metrics/MedR: 20.0
 MSRVTT_full_test/t2v_metrics/MeanR: 66.13344481605351
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.393789358849553
 MSRVTT_full_test/v2t_metrics/R1: 8.929765886287626
 MSRVTT_full_test/v2t_metrics/R5: 26.68896321070234
 MSRVTT_full_test/v2t_metrics/R10: 39.39799331103679
 MSRVTT_full_test/v2t_metrics/R50: 75.31772575250837
 MSRVTT_full_test/v2t_metrics/MedR: 17.0
 MSRVTT_full_test/v2t_metrics/MeanR: 58.095652173913045
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.096737189526046
 mnt_best       : 19.5606871584151
 not_improved_count: 1
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 3.93718 (QuantReg: 7.42785) QuantErr: 7.42785 batch_time=34.74557 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.93427 (QuantReg: 7.34909) QuantErr: 7.34909 batch_time=0.49434 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 4.00329 (QuantReg: 7.36771) QuantErr: 7.36771 batch_time=0.49503 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 3.37238 (QuantReg: 7.76951) QuantErr: 7.76951 batch_time=0.49366 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 3.80719 (QuantReg: 7.29960) QuantErr: 7.29960 batch_time=0.49404 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 3.85595 (QuantReg: 7.77625) QuantErr: 7.77625 batch_time=0.52487 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 3.70333 (QuantReg: 7.43436) QuantErr: 7.43436 batch_time=0.53697 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 3.74419 (QuantReg: 7.15678) QuantErr: 7.15678 batch_time=0.52727 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 3.49349 (QuantReg: 7.60280) QuantErr: 7.60280 batch_time=0.49359 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 3.90931 (QuantReg: 7.34971) QuantErr: 7.34971 batch_time=0.65703 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 3.78285 (QuantReg: 7.53913) QuantErr: 7.53913 batch_time=0.49064 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 3.68614 (QuantReg: 7.38876) QuantErr: 7.38876 batch_time=0.48915 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 3.67955 (QuantReg: 7.62714) QuantErr: 7.62714 batch_time=0.50608 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 3.30855 (QuantReg: 7.63469) QuantErr: 7.63469 batch_time=0.50645 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 3.72163 (QuantReg: 7.86269) QuantErr: 7.86269 batch_time=0.50850 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 3.67747 (QuantReg: 7.75086) QuantErr: 7.75086 batch_time=0.49946 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 3.65081 (QuantReg: 7.90486) QuantErr: 7.90486 batch_time=0.49315 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 3.72766 (QuantReg: 7.50088) QuantErr: 7.50088 batch_time=0.49159 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 3.52279 (QuantReg: 7.49812) QuantErr: 7.49812 batch_time=0.72020 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 3.72127 (QuantReg: 7.50700) QuantErr: 7.50700 batch_time=2.77023 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 3.68901 (QuantReg: 7.62895) QuantErr: 7.62895 batch_time=0.50577 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 3.39699 (QuantReg: 7.69105) QuantErr: 7.69105 batch_time=0.49186 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 3.56347 (QuantReg: 7.51828) QuantErr: 7.51828 batch_time=0.50592 
Train Epoch: 5 codebook_update_time=1.64931
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch5.pth ...
Done in 6.154s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch5.pth ...
Done in 10.779s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 3.682996241569519
 quant_reg      : 7.488429651260376
 quant_err      : 7.488429651260376
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 24.14486921529175
 MSRVTT_full_val/t2v_metrics/R5: 55.734406438631794
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.818913480885312
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.02192530648933
 MSRVTT_full_val/v2t_metrics/R1: 24.14486921529175
 MSRVTT_full_val/v2t_metrics/R5: 62.17303822937626
 MSRVTT_full_val/v2t_metrics/R10: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.953722334004024
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.683071863379155
 MSRVTT_full_test/t2v_metrics/R1: 8.327759197324415
 MSRVTT_full_test/t2v_metrics/R5: 25.7190635451505
 MSRVTT_full_test/t2v_metrics/R10: 38.22742474916388
 MSRVTT_full_test/t2v_metrics/R50: 72.74247491638796
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.969565217391306
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.155153842814332
 MSRVTT_full_test/v2t_metrics/R1: 9.498327759197325
 MSRVTT_full_test/v2t_metrics/R5: 28.127090301003346
 MSRVTT_full_test/v2t_metrics/R10: 41.23745819397993
 MSRVTT_full_test/v2t_metrics/R50: 76.88963210702342
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.79247491638796
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.251260381546057
 mnt_best       : 20.155153842814332
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 3.77921 (QuantReg: 6.95490) QuantErr: 6.95490 batch_time=33.68612 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 3.75697 (QuantReg: 6.71087) QuantErr: 6.71087 batch_time=0.74623 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 3.33862 (QuantReg: 7.14453) QuantErr: 7.14453 batch_time=4.13271 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 3.48619 (QuantReg: 7.21054) QuantErr: 7.21054 batch_time=1.02203 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 3.21534 (QuantReg: 7.04239) QuantErr: 7.04239 batch_time=0.49378 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 3.40786 (QuantReg: 7.41000) QuantErr: 7.41000 batch_time=0.49241 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 3.40329 (QuantReg: 7.43735) QuantErr: 7.43735 batch_time=0.50281 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 3.26153 (QuantReg: 7.10493) QuantErr: 7.10493 batch_time=0.54003 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 3.85153 (QuantReg: 7.40626) QuantErr: 7.40626 batch_time=0.51120 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 3.47366 (QuantReg: 7.20345) QuantErr: 7.20345 batch_time=0.49804 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 3.43323 (QuantReg: 6.62281) QuantErr: 6.62281 batch_time=0.50959 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 3.36810 (QuantReg: 7.31895) QuantErr: 7.31895 batch_time=0.49390 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 3.41362 (QuantReg: 7.24448) QuantErr: 7.24448 batch_time=0.51485 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 3.43000 (QuantReg: 6.95406) QuantErr: 6.95406 batch_time=0.49876 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 3.26935 (QuantReg: 7.31224) QuantErr: 7.31224 batch_time=0.50606 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 3.27773 (QuantReg: 7.12463) QuantErr: 7.12463 batch_time=0.49206 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 3.69516 (QuantReg: 7.50438) QuantErr: 7.50438 batch_time=0.50588 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 3.51124 (QuantReg: 7.80155) QuantErr: 7.80155 batch_time=0.50166 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 3.48617 (QuantReg: 7.19032) QuantErr: 7.19032 batch_time=0.49891 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 3.48059 (QuantReg: 7.48277) QuantErr: 7.48277 batch_time=0.85314 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 3.39113 (QuantReg: 7.31902) QuantErr: 7.31902 batch_time=0.50092 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 3.64324 (QuantReg: 7.35715) QuantErr: 7.35715 batch_time=0.49242 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 3.50641 (QuantReg: 7.40096) QuantErr: 7.40096 batch_time=0.49288 
Train Epoch: 6 codebook_update_time=1.82410
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch6.pth ...
Done in 6.655s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch6.pth ...
Done in 11.895s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 3.517167056083679
 quant_reg      : 7.2566107063293455
 quant_err      : 7.2566107063293455
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 59.15492957746479
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 95.37223340040241
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.507042253521126
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.63583083752205
 MSRVTT_full_val/v2t_metrics/R1: 29.77867203219316
 MSRVTT_full_val/v2t_metrics/R5: 63.17907444668008
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.0261569416499
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.30437284203782
 MSRVTT_full_test/t2v_metrics/R1: 8.963210702341136
 MSRVTT_full_test/t2v_metrics/R5: 26.354515050167223
 MSRVTT_full_test/t2v_metrics/R10: 38.96321070234114
 MSRVTT_full_test/t2v_metrics/R50: 73.67892976588628
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.829765886287625
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.95677532026571
 MSRVTT_full_test/v2t_metrics/R1: 9.464882943143813
 MSRVTT_full_test/v2t_metrics/R5: 28.729096989966557
 MSRVTT_full_test/v2t_metrics/R10: 41.67224080267559
 MSRVTT_full_test/v2t_metrics/R50: 76.82274247491638
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.30117056856187
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.460945060723205
 mnt_best       : 20.95677532026571
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 3.38228 (QuantReg: 6.58888) QuantErr: 6.58888 batch_time=33.23573 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 3.33196 (QuantReg: 7.43472) QuantErr: 7.43472 batch_time=0.53173 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 3.49908 (QuantReg: 7.34178) QuantErr: 7.34178 batch_time=0.48898 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 3.31943 (QuantReg: 7.28068) QuantErr: 7.28068 batch_time=0.48988 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 3.26083 (QuantReg: 6.74630) QuantErr: 6.74630 batch_time=0.50128 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 3.56537 (QuantReg: 6.85206) QuantErr: 6.85206 batch_time=0.52019 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 3.49358 (QuantReg: 7.23781) QuantErr: 7.23781 batch_time=0.50242 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 3.74996 (QuantReg: 7.31198) QuantErr: 7.31198 batch_time=0.49047 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 3.49473 (QuantReg: 7.29420) QuantErr: 7.29420 batch_time=0.63404 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 3.38944 (QuantReg: 7.33378) QuantErr: 7.33378 batch_time=0.56309 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 3.50655 (QuantReg: 7.29609) QuantErr: 7.29609 batch_time=0.52394 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 3.05021 (QuantReg: 7.65966) QuantErr: 7.65966 batch_time=0.50320 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 3.30137 (QuantReg: 7.09563) QuantErr: 7.09563 batch_time=1.20057 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 3.46413 (QuantReg: 7.28225) QuantErr: 7.28225 batch_time=1.14872 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 3.41473 (QuantReg: 6.94918) QuantErr: 6.94918 batch_time=0.49651 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 3.28326 (QuantReg: 7.00412) QuantErr: 7.00412 batch_time=0.48709 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 3.09899 (QuantReg: 7.29438) QuantErr: 7.29438 batch_time=0.51813 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 3.39965 (QuantReg: 6.84342) QuantErr: 6.84342 batch_time=0.50683 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 2.95492 (QuantReg: 7.40744) QuantErr: 7.40744 batch_time=0.49024 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 3.19325 (QuantReg: 7.23470) QuantErr: 7.23470 batch_time=0.49156 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 3.67165 (QuantReg: 7.27642) QuantErr: 7.27642 batch_time=0.50361 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 3.32082 (QuantReg: 7.04107) QuantErr: 7.04107 batch_time=0.49989 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 3.32756 (QuantReg: 7.13990) QuantErr: 7.13990 batch_time=0.49890 
Train Epoch: 7 codebook_update_time=1.68247
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch7.pth ...
Done in 4.915s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch7.pth ...
Done in 9.729s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 3.3896362657547
 quant_reg      : 7.198209774017334
 quant_err      : 7.198209774017334
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 59.95975855130785
 MSRVTT_full_val/t2v_metrics/R10: 71.83098591549296
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.364185110663984
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.41402326619343
 MSRVTT_full_val/v2t_metrics/R1: 26.358148893360163
 MSRVTT_full_val/v2t_metrics/R5: 63.17907444668008
 MSRVTT_full_val/v2t_metrics/R10: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.116700201207243
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.04197710948591
 MSRVTT_full_test/t2v_metrics/R1: 8.561872909698996
 MSRVTT_full_test/t2v_metrics/R5: 27.45819397993311
 MSRVTT_full_test/t2v_metrics/R10: 40.03344481605351
 MSRVTT_full_test/t2v_metrics/R50: 74.04682274247492
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.01220735785953
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.11322467717102
 MSRVTT_full_test/v2t_metrics/R1: 9.464882943143813
 MSRVTT_full_test/v2t_metrics/R5: 30.234113712374583
 MSRVTT_full_test/v2t_metrics/R10: 42.876254180602004
 MSRVTT_full_test/v2t_metrics/R50: 77.82608695652173
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.62658862876254
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.064450316063336
 mnt_best       : 21.11322467717102
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 3.37515 (QuantReg: 7.38991) QuantErr: 7.38991 batch_time=38.02983 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 3.44084 (QuantReg: 7.24196) QuantErr: 7.24196 batch_time=0.50524 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 3.61112 (QuantReg: 7.03379) QuantErr: 7.03379 batch_time=2.10483 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 3.29328 (QuantReg: 7.34944) QuantErr: 7.34944 batch_time=0.52335 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 3.63177 (QuantReg: 7.24476) QuantErr: 7.24476 batch_time=0.54117 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 3.52044 (QuantReg: 7.11571) QuantErr: 7.11571 batch_time=0.50098 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 3.22770 (QuantReg: 7.43191) QuantErr: 7.43191 batch_time=0.51230 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 3.14738 (QuantReg: 7.41061) QuantErr: 7.41061 batch_time=0.55356 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 3.60759 (QuantReg: 7.40740) QuantErr: 7.40740 batch_time=0.50540 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 3.15083 (QuantReg: 6.89683) QuantErr: 6.89683 batch_time=0.50923 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 3.31703 (QuantReg: 7.28928) QuantErr: 7.28928 batch_time=0.49777 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 3.57752 (QuantReg: 7.21335) QuantErr: 7.21335 batch_time=0.49065 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 3.22428 (QuantReg: 7.13583) QuantErr: 7.13583 batch_time=0.53998 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 3.06091 (QuantReg: 7.07867) QuantErr: 7.07867 batch_time=2.13574 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 3.50426 (QuantReg: 7.35705) QuantErr: 7.35705 batch_time=0.49710 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 3.18297 (QuantReg: 7.08635) QuantErr: 7.08635 batch_time=0.54204 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 3.37645 (QuantReg: 7.22483) QuantErr: 7.22483 batch_time=0.49717 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 3.52000 (QuantReg: 7.46441) QuantErr: 7.46441 batch_time=1.10094 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.95634 (QuantReg: 7.25012) QuantErr: 7.25012 batch_time=1.12538 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.96925 (QuantReg: 7.04629) QuantErr: 7.04629 batch_time=0.52352 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 3.05393 (QuantReg: 7.54748) QuantErr: 7.54748 batch_time=0.50219 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 2.75112 (QuantReg: 7.00264) QuantErr: 7.00264 batch_time=0.52310 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.84784 (QuantReg: 7.07934) QuantErr: 7.07934 batch_time=0.50997 
Train Epoch: 8 codebook_update_time=1.64044
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch8.pth ...
Done in 4.446s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 3.306207092285156
 quant_reg      : 7.139089624404908
 quant_err      : 7.139089624404908
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 22.132796780684103
 MSRVTT_full_val/t2v_metrics/R5: 59.15492957746479
 MSRVTT_full_val/t2v_metrics/R10: 71.42857142857143
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.235412474849095
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.39064988166291
 MSRVTT_full_val/v2t_metrics/R1: 23.943661971830984
 MSRVTT_full_val/v2t_metrics/R5: 63.17907444668008
 MSRVTT_full_val/v2t_metrics/R10: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.841046277665995
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.67981111253257
 MSRVTT_full_test/t2v_metrics/R1: 8.695652173913043
 MSRVTT_full_test/t2v_metrics/R5: 27.49163879598662
 MSRVTT_full_test/t2v_metrics/R10: 39.297658862876254
 MSRVTT_full_test/t2v_metrics/R50: 73.54515050167224
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.55150501672241
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.10035792946751
 MSRVTT_full_test/v2t_metrics/R1: 9.397993311036789
 MSRVTT_full_test/v2t_metrics/R5: 28.494983277591974
 MSRVTT_full_test/v2t_metrics/R10: 41.67224080267559
 MSRVTT_full_test/v2t_metrics/R50: 77.52508361204013
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.47742474916388
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.34687487751429
 mnt_best       : 21.11322467717102
 not_improved_count: 1
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 3.30861 (QuantReg: 6.70388) QuantErr: 6.70388 batch_time=39.23145 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 3.04909 (QuantReg: 6.77814) QuantErr: 6.77814 batch_time=0.51765 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 3.35671 (QuantReg: 6.97213) QuantErr: 6.97213 batch_time=0.50822 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 3.45221 (QuantReg: 7.03738) QuantErr: 7.03738 batch_time=0.50369 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 3.50453 (QuantReg: 6.78877) QuantErr: 6.78877 batch_time=0.50677 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 3.46782 (QuantReg: 7.23554) QuantErr: 7.23554 batch_time=0.50073 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 3.15138 (QuantReg: 7.13071) QuantErr: 7.13071 batch_time=0.51718 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 3.01827 (QuantReg: 7.05359) QuantErr: 7.05359 batch_time=0.51656 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 3.32108 (QuantReg: 6.80154) QuantErr: 6.80154 batch_time=0.49257 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 3.23644 (QuantReg: 6.88372) QuantErr: 6.88372 batch_time=0.49223 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 3.22980 (QuantReg: 7.03508) QuantErr: 7.03508 batch_time=0.50465 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 3.17072 (QuantReg: 7.09756) QuantErr: 7.09756 batch_time=0.52273 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 3.28836 (QuantReg: 7.20635) QuantErr: 7.20635 batch_time=0.51575 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 3.31384 (QuantReg: 7.13113) QuantErr: 7.13113 batch_time=0.54778 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 3.24187 (QuantReg: 7.47392) QuantErr: 7.47392 batch_time=0.49555 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 3.41031 (QuantReg: 6.93121) QuantErr: 6.93121 batch_time=0.49682 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 2.89664 (QuantReg: 7.08065) QuantErr: 7.08065 batch_time=0.50896 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 3.02996 (QuantReg: 6.96301) QuantErr: 6.96301 batch_time=0.49769 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 2.99549 (QuantReg: 7.22959) QuantErr: 7.22959 batch_time=0.49705 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 3.14304 (QuantReg: 6.97511) QuantErr: 6.97511 batch_time=0.50919 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 3.22639 (QuantReg: 7.08047) QuantErr: 7.08047 batch_time=0.50147 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 3.26344 (QuantReg: 7.08806) QuantErr: 7.08806 batch_time=0.55122 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 2.79373 (QuantReg: 7.14815) QuantErr: 7.14815 batch_time=0.52405 
Train Epoch: 9 codebook_update_time=1.94174
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch9.pth ...
Done in 20.856s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 3.199481548309326
 quant_reg      : 7.071276475906372
 quant_err      : 7.071276475906372
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 58.95372233400403
 MSRVTT_full_val/t2v_metrics/R10: 71.0261569416499
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.191146881287727
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.842959978220726
 MSRVTT_full_val/v2t_metrics/R1: 22.93762575452716
 MSRVTT_full_val/v2t_metrics/R5: 63.38028169014085
 MSRVTT_full_val/v2t_metrics/R10: 78.06841046277665
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.740442655935613
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.416417891595756
 MSRVTT_full_test/t2v_metrics/R1: 8.66220735785953
 MSRVTT_full_test/t2v_metrics/R5: 26.923076923076923
 MSRVTT_full_test/t2v_metrics/R10: 40.10033444816054
 MSRVTT_full_test/t2v_metrics/R50: 75.01672240802675
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.012040133779266
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.068506678095225
 MSRVTT_full_test/v2t_metrics/R1: 9.565217391304348
 MSRVTT_full_test/v2t_metrics/R5: 29.331103678929765
 MSRVTT_full_test/v2t_metrics/R10: 42.74247491638796
 MSRVTT_full_test/v2t_metrics/R50: 77.59197324414716
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.56605351170568
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.88904318020072
 mnt_best       : 21.11322467717102
 not_improved_count: 2
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 2.94157 (QuantReg: 6.57951) QuantErr: 6.57951 batch_time=34.77409 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 3.05040 (QuantReg: 6.98982) QuantErr: 6.98982 batch_time=0.50329 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.96333 (QuantReg: 6.67600) QuantErr: 6.67600 batch_time=0.49582 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 3.01911 (QuantReg: 6.75033) QuantErr: 6.75033 batch_time=0.49900 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 3.07335 (QuantReg: 7.20976) QuantErr: 7.20976 batch_time=0.49768 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 3.36524 (QuantReg: 6.99350) QuantErr: 6.99350 batch_time=0.50170 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.96606 (QuantReg: 6.93462) QuantErr: 6.93462 batch_time=0.56377 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 3.01489 (QuantReg: 6.79505) QuantErr: 6.79505 batch_time=1.89227 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 3.23295 (QuantReg: 7.05604) QuantErr: 7.05604 batch_time=0.50103 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 3.45297 (QuantReg: 6.73645) QuantErr: 6.73645 batch_time=0.54317 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 2.90508 (QuantReg: 6.99706) QuantErr: 6.99706 batch_time=0.52840 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 3.22559 (QuantReg: 7.11338) QuantErr: 7.11338 batch_time=0.57338 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 3.23721 (QuantReg: 7.03380) QuantErr: 7.03380 batch_time=0.97982 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 3.44165 (QuantReg: 6.99943) QuantErr: 6.99943 batch_time=1.08542 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 2.86296 (QuantReg: 7.09146) QuantErr: 7.09146 batch_time=0.49875 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.81544 (QuantReg: 6.94550) QuantErr: 6.94550 batch_time=0.50934 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 3.92630 (QuantReg: 7.12082) QuantErr: 7.12082 batch_time=0.49530 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 2.92608 (QuantReg: 7.15204) QuantErr: 7.15204 batch_time=0.50686 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 3.03272 (QuantReg: 7.46787) QuantErr: 7.46787 batch_time=0.50621 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 2.92182 (QuantReg: 6.94975) QuantErr: 6.94975 batch_time=1.70003 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 2.83570 (QuantReg: 6.67651) QuantErr: 6.67651 batch_time=0.49530 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 3.53930 (QuantReg: 7.11345) QuantErr: 7.11345 batch_time=0.50106 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 3.12736 (QuantReg: 6.88202) QuantErr: 6.88202 batch_time=0.49627 
Train Epoch: 10 codebook_update_time=2.03381
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch10.pth ...
Done in 22.337s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 3.110167073249817
 quant_reg      : 6.984330781936645
 quant_err      : 6.984330781936645
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 24.346076458752513
 MSRVTT_full_val/t2v_metrics/R5: 58.75251509054326
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.653923541247485
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.14114712896537
 MSRVTT_full_val/v2t_metrics/R1: 24.346076458752513
 MSRVTT_full_val/v2t_metrics/R5: 61.77062374245473
 MSRVTT_full_val/v2t_metrics/R10: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.841046277665995
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.45599042529375
 MSRVTT_full_test/t2v_metrics/R1: 8.461538461538462
 MSRVTT_full_test/t2v_metrics/R5: 27.123745819397993
 MSRVTT_full_test/t2v_metrics/R10: 39.59866220735786
 MSRVTT_full_test/t2v_metrics/R50: 73.9799331103679
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 59.37826086956522
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.868593088232437
 MSRVTT_full_test/v2t_metrics/R1: 9.431438127090301
 MSRVTT_full_test/v2t_metrics/R5: 29.096989966555185
 MSRVTT_full_test/v2t_metrics/R10: 42.642140468227424
 MSRVTT_full_test/v2t_metrics/R50: 77.09030100334448
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.57374581939799
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.70326544467121
 mnt_best       : 21.11322467717102
 not_improved_count: 3
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 2.97706 (QuantReg: 6.94210) QuantErr: 6.94210 batch_time=34.66133 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.81618 (QuantReg: 7.04720) QuantErr: 7.04720 batch_time=0.50237 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 3.07220 (QuantReg: 6.63745) QuantErr: 6.63745 batch_time=0.48878 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 3.12037 (QuantReg: 7.03701) QuantErr: 7.03701 batch_time=0.52066 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 3.20908 (QuantReg: 7.30381) QuantErr: 7.30381 batch_time=0.51880 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 3.04699 (QuantReg: 6.89558) QuantErr: 6.89558 batch_time=0.53772 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 3.12282 (QuantReg: 6.72826) QuantErr: 6.72826 batch_time=4.21673 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 2.84884 (QuantReg: 6.99554) QuantErr: 6.99554 batch_time=0.50146 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 3.09453 (QuantReg: 6.74710) QuantErr: 6.74710 batch_time=0.51242 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 3.40247 (QuantReg: 6.81929) QuantErr: 6.81929 batch_time=0.50672 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 3.21841 (QuantReg: 6.65894) QuantErr: 6.65894 batch_time=0.50105 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 3.11645 (QuantReg: 7.17621) QuantErr: 7.17621 batch_time=0.50840 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 3.42628 (QuantReg: 6.76453) QuantErr: 6.76453 batch_time=0.50385 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 3.25992 (QuantReg: 7.01387) QuantErr: 7.01387 batch_time=0.50339 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 3.00094 (QuantReg: 6.58572) QuantErr: 6.58572 batch_time=0.51180 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.99864 (QuantReg: 6.58507) QuantErr: 6.58507 batch_time=0.53173 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 2.98020 (QuantReg: 6.68885) QuantErr: 6.68885 batch_time=0.50726 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 2.84475 (QuantReg: 6.87744) QuantErr: 6.87744 batch_time=0.58918 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 2.94750 (QuantReg: 7.34649) QuantErr: 7.34649 batch_time=0.51290 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 3.30315 (QuantReg: 7.09049) QuantErr: 7.09049 batch_time=0.50353 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 3.14666 (QuantReg: 7.24463) QuantErr: 7.24463 batch_time=0.50208 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 2.95714 (QuantReg: 7.07733) QuantErr: 7.07733 batch_time=0.52540 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 2.87285 (QuantReg: 7.31442) QuantErr: 7.31442 batch_time=0.50102 
Train Epoch: 11 codebook_update_time=1.86478
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch11.pth ...
Done in 4.039s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch11.pth ...
Done in 7.958s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 3.0403765058517456
 quant_reg      : 6.955853029251099
 quant_err      : 6.955853029251099
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 25.35211267605634
 MSRVTT_full_val/t2v_metrics/R5: 58.75251509054326
 MSRVTT_full_val/t2v_metrics/R10: 72.63581488933602
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.303822937625755
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.65009938095121
 MSRVTT_full_val/v2t_metrics/R1: 25.35211267605634
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.736418511066399
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.93900617468437
 MSRVTT_full_test/t2v_metrics/R1: 8.62876254180602
 MSRVTT_full_test/t2v_metrics/R5: 27.49163879598662
 MSRVTT_full_test/t2v_metrics/R10: 39.69899665551839
 MSRVTT_full_test/t2v_metrics/R50: 74.51505016722408
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.20685618729097
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.117518946200104
 MSRVTT_full_test/v2t_metrics/R1: 9.297658862876254
 MSRVTT_full_test/v2t_metrics/R5: 29.39799331103679
 MSRVTT_full_test/v2t_metrics/R10: 43.44481605351171
 MSRVTT_full_test/v2t_metrics/R50: 77.75919732441471
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.147491638795984
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.814436808929724
 mnt_best       : 21.117518946200104
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 3.06344 (QuantReg: 6.70243) QuantErr: 6.70243 batch_time=50.35710 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 3.15004 (QuantReg: 6.93292) QuantErr: 6.93292 batch_time=0.49819 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 2.86933 (QuantReg: 6.84413) QuantErr: 6.84413 batch_time=0.49393 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 3.02737 (QuantReg: 6.80477) QuantErr: 6.80477 batch_time=0.50566 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 2.71628 (QuantReg: 6.98611) QuantErr: 6.98611 batch_time=0.50661 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 3.08456 (QuantReg: 6.68708) QuantErr: 6.68708 batch_time=0.48430 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 2.77372 (QuantReg: 6.84448) QuantErr: 6.84448 batch_time=0.49538 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 2.96872 (QuantReg: 6.90805) QuantErr: 6.90805 batch_time=0.50926 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 2.84356 (QuantReg: 6.82792) QuantErr: 6.82792 batch_time=0.49733 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 3.21405 (QuantReg: 6.79331) QuantErr: 6.79331 batch_time=0.49214 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 2.67607 (QuantReg: 6.80269) QuantErr: 6.80269 batch_time=0.50412 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 3.12262 (QuantReg: 6.76076) QuantErr: 6.76076 batch_time=0.49200 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 2.69960 (QuantReg: 6.84551) QuantErr: 6.84551 batch_time=0.49187 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 2.79205 (QuantReg: 7.30056) QuantErr: 7.30056 batch_time=0.51750 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 2.98572 (QuantReg: 6.88027) QuantErr: 6.88027 batch_time=0.51186 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 2.66979 (QuantReg: 7.01861) QuantErr: 7.01861 batch_time=0.49592 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 2.82318 (QuantReg: 6.81635) QuantErr: 6.81635 batch_time=0.51692 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 3.17443 (QuantReg: 6.59024) QuantErr: 6.59024 batch_time=0.51031 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 3.26146 (QuantReg: 6.78980) QuantErr: 6.78980 batch_time=0.49874 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 3.19960 (QuantReg: 6.87550) QuantErr: 6.87550 batch_time=0.50292 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 2.98337 (QuantReg: 6.29371) QuantErr: 6.29371 batch_time=0.53465 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 2.87456 (QuantReg: 7.03366) QuantErr: 7.03366 batch_time=0.50822 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 3.11399 (QuantReg: 7.35692) QuantErr: 7.35692 batch_time=0.51078 
Train Epoch: 12 codebook_update_time=1.63595
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch12.pth ...
Done in 4.460s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 2.974168775558472
 quant_reg      : 6.8922064514160155
 quant_err      : 6.8922064514160155
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 25.150905432595575
 MSRVTT_full_val/t2v_metrics/R5: 59.758551307847085
 MSRVTT_full_val/t2v_metrics/R10: 71.0261569416499
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.428571428571429
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.43774109767644
 MSRVTT_full_val/v2t_metrics/R1: 27.364185110663986
 MSRVTT_full_val/v2t_metrics/R5: 64.38631790744466
 MSRVTT_full_val/v2t_metrics/R10: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.937625754527163
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.03682660269616
 MSRVTT_full_test/t2v_metrics/R1: 8.193979933110368
 MSRVTT_full_test/t2v_metrics/R5: 27.224080267558527
 MSRVTT_full_test/t2v_metrics/R10: 39.89966555183946
 MSRVTT_full_test/t2v_metrics/R50: 74.91638795986623
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.47123745819398
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.723946190878333
 MSRVTT_full_test/v2t_metrics/R1: 10.033444816053512
 MSRVTT_full_test/v2t_metrics/R5: 29.03010033444816
 MSRVTT_full_test/v2t_metrics/R10: 42.94314381270903
 MSRVTT_full_test/v2t_metrics/R50: 78.16053511705685
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.75852842809365
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.21297549235124
 mnt_best       : 21.117518946200104
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 2.81744 (QuantReg: 6.81854) QuantErr: 6.81854 batch_time=41.31141 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 3.36040 (QuantReg: 6.43294) QuantErr: 6.43294 batch_time=0.53461 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 3.11299 (QuantReg: 6.96034) QuantErr: 6.96034 batch_time=0.49091 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 2.71574 (QuantReg: 6.89176) QuantErr: 6.89176 batch_time=0.49905 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 3.03789 (QuantReg: 6.93190) QuantErr: 6.93190 batch_time=0.50072 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 2.91667 (QuantReg: 6.96262) QuantErr: 6.96262 batch_time=0.53332 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 2.86122 (QuantReg: 7.12910) QuantErr: 7.12910 batch_time=1.36921 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 3.20714 (QuantReg: 7.22162) QuantErr: 7.22162 batch_time=0.49463 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 2.69773 (QuantReg: 6.46968) QuantErr: 6.46968 batch_time=0.49259 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 3.06590 (QuantReg: 6.87448) QuantErr: 6.87448 batch_time=0.49162 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 2.98360 (QuantReg: 6.65036) QuantErr: 6.65036 batch_time=0.54923 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 2.78778 (QuantReg: 6.74662) QuantErr: 6.74662 batch_time=0.55666 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 2.84942 (QuantReg: 6.80664) QuantErr: 6.80664 batch_time=0.86958 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 3.03356 (QuantReg: 7.10688) QuantErr: 7.10688 batch_time=0.53683 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 3.03969 (QuantReg: 6.77678) QuantErr: 6.77678 batch_time=0.49312 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 2.76036 (QuantReg: 6.79708) QuantErr: 6.79708 batch_time=0.50071 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 2.68592 (QuantReg: 7.19464) QuantErr: 7.19464 batch_time=0.49663 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 3.15377 (QuantReg: 6.77977) QuantErr: 6.77977 batch_time=0.48933 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 2.73091 (QuantReg: 7.04461) QuantErr: 7.04461 batch_time=0.49546 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 3.26087 (QuantReg: 6.84005) QuantErr: 6.84005 batch_time=0.49871 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 3.17764 (QuantReg: 7.04189) QuantErr: 7.04189 batch_time=0.49749 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 2.87068 (QuantReg: 7.09382) QuantErr: 7.09382 batch_time=0.48936 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 2.79147 (QuantReg: 6.89140) QuantErr: 6.89140 batch_time=0.50150 
Train Epoch: 13 codebook_update_time=1.68137
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch13.pth ...
Done in 4.162s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch13.pth ...
Done in 8.025s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 2.9167723903656007
 quant_reg      : 6.890765857696533
 quant_err      : 6.890765857696533
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 26.760563380281692
 MSRVTT_full_val/t2v_metrics/R5: 60.96579476861167
 MSRVTT_full_val/t2v_metrics/R10: 74.24547283702213
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.285714285714286
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.47857194324977
 MSRVTT_full_val/v2t_metrics/R1: 28.571428571428573
 MSRVTT_full_val/v2t_metrics/R5: 64.1851106639839
 MSRVTT_full_val/v2t_metrics/R10: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.179074446680081
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.22346960705232
 MSRVTT_full_test/t2v_metrics/R1: 8.929765886287626
 MSRVTT_full_test/t2v_metrics/R5: 27.558528428093645
 MSRVTT_full_test/t2v_metrics/R10: 40.468227424749166
 MSRVTT_full_test/t2v_metrics/R50: 76.72240802675586
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.86354515050167
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.51477256498174
 MSRVTT_full_test/v2t_metrics/R1: 9.765886287625419
 MSRVTT_full_test/v2t_metrics/R5: 29.19732441471572
 MSRVTT_full_test/v2t_metrics/R10: 45.21739130434783
 MSRVTT_full_test/v2t_metrics/R50: 79.36454849498328
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 50.53076923076923
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.448770383369656
 mnt_best       : 21.51477256498174
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 2.74862 (QuantReg: 6.97068) QuantErr: 6.97068 batch_time=35.10607 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 3.22625 (QuantReg: 7.06847) QuantErr: 7.06847 batch_time=0.50303 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 2.85327 (QuantReg: 7.04782) QuantErr: 7.04782 batch_time=0.49979 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 2.79826 (QuantReg: 6.76159) QuantErr: 6.76159 batch_time=0.50129 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 2.94738 (QuantReg: 6.85628) QuantErr: 6.85628 batch_time=0.57974 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 2.79500 (QuantReg: 6.62019) QuantErr: 6.62019 batch_time=0.51321 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 3.07304 (QuantReg: 6.84111) QuantErr: 6.84111 batch_time=0.49170 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 3.00692 (QuantReg: 6.34240) QuantErr: 6.34240 batch_time=0.48720 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 2.68266 (QuantReg: 6.51284) QuantErr: 6.51284 batch_time=0.50011 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 2.78439 (QuantReg: 6.63057) QuantErr: 6.63057 batch_time=0.52213 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 2.83237 (QuantReg: 6.83128) QuantErr: 6.83128 batch_time=0.50840 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 2.92454 (QuantReg: 6.67166) QuantErr: 6.67166 batch_time=0.51746 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 2.91377 (QuantReg: 7.29218) QuantErr: 7.29218 batch_time=0.50347 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 2.67623 (QuantReg: 7.03976) QuantErr: 7.03976 batch_time=0.50311 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 2.64439 (QuantReg: 6.87627) QuantErr: 6.87627 batch_time=0.50982 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 2.67920 (QuantReg: 6.78719) QuantErr: 6.78719 batch_time=0.50808 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 2.72678 (QuantReg: 6.77453) QuantErr: 6.77453 batch_time=0.56848 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 2.93462 (QuantReg: 7.16695) QuantErr: 7.16695 batch_time=0.50577 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 2.64052 (QuantReg: 6.56670) QuantErr: 6.56670 batch_time=0.50742 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 3.07432 (QuantReg: 6.62739) QuantErr: 6.62739 batch_time=0.51540 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 2.99894 (QuantReg: 7.03994) QuantErr: 7.03994 batch_time=0.49863 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 2.78502 (QuantReg: 6.99693) QuantErr: 6.99693 batch_time=1.29177 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 2.74280 (QuantReg: 6.94890) QuantErr: 6.94890 batch_time=0.51980 
Train Epoch: 14 codebook_update_time=1.61991
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch14.pth ...
Done in 4.044s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 2.8615364961624143
 quant_reg      : 6.848707180023194
 quant_err      : 6.848707180023194
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 24.14486921529175
 MSRVTT_full_val/t2v_metrics/R5: 58.75251509054326
 MSRVTT_full_val/t2v_metrics/R10: 73.03822937625755
 MSRVTT_full_val/t2v_metrics/R50: 95.17102615694165
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.392354124748492
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.967832523431035
 MSRVTT_full_val/v2t_metrics/R1: 25.75452716297787
 MSRVTT_full_val/v2t_metrics/R5: 62.57545271629779
 MSRVTT_full_val/v2t_metrics/R10: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.849094567404427
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.935661298172384
 MSRVTT_full_test/t2v_metrics/R1: 9.063545150501673
 MSRVTT_full_test/t2v_metrics/R5: 27.357859531772576
 MSRVTT_full_test/t2v_metrics/R10: 39.23076923076923
 MSRVTT_full_test/t2v_metrics/R50: 74.61538461538461
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 60.8556856187291
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.346942514094387
 MSRVTT_full_test/v2t_metrics/R1: 9.03010033444816
 MSRVTT_full_test/v2t_metrics/R5: 28.929765886287626
 MSRVTT_full_test/v2t_metrics/R10: 43.41137123745819
 MSRVTT_full_test/v2t_metrics/R50: 77.82608695652173
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 54.591471571906354
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.467099036239695
 mnt_best       : 21.51477256498174
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 3.11685 (QuantReg: 6.57115) QuantErr: 6.57115 batch_time=36.10734 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 2.79968 (QuantReg: 6.64398) QuantErr: 6.64398 batch_time=0.50866 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 2.87550 (QuantReg: 6.65415) QuantErr: 6.65415 batch_time=0.51041 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 2.90109 (QuantReg: 6.54777) QuantErr: 6.54777 batch_time=0.51131 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 2.94042 (QuantReg: 6.94475) QuantErr: 6.94475 batch_time=0.50502 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 2.84560 (QuantReg: 6.49313) QuantErr: 6.49313 batch_time=1.06857 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 3.13449 (QuantReg: 6.54219) QuantErr: 6.54219 batch_time=0.51859 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 2.83997 (QuantReg: 6.75037) QuantErr: 6.75037 batch_time=0.54450 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 2.97187 (QuantReg: 6.83611) QuantErr: 6.83611 batch_time=0.49878 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 2.73401 (QuantReg: 6.80704) QuantErr: 6.80704 batch_time=0.52198 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 2.86532 (QuantReg: 6.70668) QuantErr: 6.70668 batch_time=0.54607 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 2.62362 (QuantReg: 6.54200) QuantErr: 6.54200 batch_time=0.49742 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 2.64048 (QuantReg: 6.37432) QuantErr: 6.37432 batch_time=2.02560 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 3.24114 (QuantReg: 6.90306) QuantErr: 6.90306 batch_time=1.61401 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 2.87866 (QuantReg: 6.55702) QuantErr: 6.55702 batch_time=0.50927 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 2.92454 (QuantReg: 7.07053) QuantErr: 7.07053 batch_time=0.52758 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 3.20164 (QuantReg: 6.97658) QuantErr: 6.97658 batch_time=0.49998 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 2.70073 (QuantReg: 6.80041) QuantErr: 6.80041 batch_time=0.53871 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 2.64389 (QuantReg: 6.90570) QuantErr: 6.90570 batch_time=0.53600 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 2.86315 (QuantReg: 6.68955) QuantErr: 6.68955 batch_time=0.49838 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 3.16379 (QuantReg: 6.96690) QuantErr: 6.96690 batch_time=0.50446 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 2.98203 (QuantReg: 7.27427) QuantErr: 7.27427 batch_time=0.50223 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 3.01709 (QuantReg: 6.62417) QuantErr: 6.62417 batch_time=0.52596 
Train Epoch: 15 codebook_update_time=1.86173
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch15.pth ...
Done in 14.898s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch15.pth ...
Done in 18.717s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 2.8239939546585084
 quant_reg      : 6.804800344467163
 quant_err      : 6.804800344467163
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 27.364185110663986
 MSRVTT_full_val/t2v_metrics/R5: 60.563380281690144
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.985915492957746
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.60275225417527
 MSRVTT_full_val/v2t_metrics/R1: 25.75452716297787
 MSRVTT_full_val/v2t_metrics/R5: 62.57545271629779
 MSRVTT_full_val/v2t_metrics/R10: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.643863179074447
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.892276687887616
 MSRVTT_full_test/t2v_metrics/R1: 9.531772575250836
 MSRVTT_full_test/t2v_metrics/R5: 28.42809364548495
 MSRVTT_full_test/t2v_metrics/R10: 41.27090301003344
 MSRVTT_full_test/t2v_metrics/R50: 76.0200668896321
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.736622073578594
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.3625741431699
 MSRVTT_full_test/v2t_metrics/R1: 9.899665551839465
 MSRVTT_full_test/v2t_metrics/R5: 30.468227424749163
 MSRVTT_full_test/v2t_metrics/R10: 44.88294314381271
 MSRVTT_full_test/v2t_metrics/R50: 78.36120401337793
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.17357859531773
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.833235973016297
 mnt_best       : 22.3625741431699
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 2.63164 (QuantReg: 6.30838) QuantErr: 6.30838 batch_time=40.53368 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 2.70439 (QuantReg: 7.05255) QuantErr: 7.05255 batch_time=0.50026 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 3.04562 (QuantReg: 6.81860) QuantErr: 6.81860 batch_time=0.92371 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 2.70430 (QuantReg: 6.96250) QuantErr: 6.96250 batch_time=0.52100 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 2.60736 (QuantReg: 6.39574) QuantErr: 6.39574 batch_time=0.50652 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 2.71766 (QuantReg: 6.61480) QuantErr: 6.61480 batch_time=0.51354 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 2.90159 (QuantReg: 7.17704) QuantErr: 7.17704 batch_time=0.54408 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 2.65262 (QuantReg: 6.75613) QuantErr: 6.75613 batch_time=0.52278 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 2.81472 (QuantReg: 6.99024) QuantErr: 6.99024 batch_time=0.53414 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 2.60571 (QuantReg: 6.59415) QuantErr: 6.59415 batch_time=0.51557 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 2.91115 (QuantReg: 7.35718) QuantErr: 7.35718 batch_time=0.50541 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 3.03795 (QuantReg: 7.25861) QuantErr: 7.25861 batch_time=0.52005 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 2.84508 (QuantReg: 6.73274) QuantErr: 6.73274 batch_time=2.45869 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 2.58183 (QuantReg: 7.01184) QuantErr: 7.01184 batch_time=0.51816 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 2.82274 (QuantReg: 6.70445) QuantErr: 6.70445 batch_time=0.54098 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 2.74820 (QuantReg: 6.76767) QuantErr: 6.76767 batch_time=0.49990 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 2.81380 (QuantReg: 6.56179) QuantErr: 6.56179 batch_time=0.50891 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 2.66141 (QuantReg: 6.76398) QuantErr: 6.76398 batch_time=0.51959 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 2.94610 (QuantReg: 6.90835) QuantErr: 6.90835 batch_time=0.49222 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 2.64538 (QuantReg: 6.66300) QuantErr: 6.66300 batch_time=0.50093 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 2.62939 (QuantReg: 6.83453) QuantErr: 6.83453 batch_time=0.51065 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 2.62877 (QuantReg: 6.66456) QuantErr: 6.66456 batch_time=0.50654 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 2.88634 (QuantReg: 7.16652) QuantErr: 7.16652 batch_time=0.52737 
Train Epoch: 16 codebook_update_time=1.69183
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch16.pth ...
Done in 14.602s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch16.pth ...
Done in 18.789s
removing stale ckpt [epoch 15] [took 0.02s]
 epoch          : 16
 loss           : 2.7909779539108275
 quant_reg      : 6.829930025100708
 quant_err      : 6.829930025100708
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 27.16297786720322
 MSRVTT_full_val/t2v_metrics/R5: 59.55734406438632
 MSRVTT_full_val/t2v_metrics/R10: 74.64788732394366
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.056338028169014
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.42842144664801
 MSRVTT_full_val/v2t_metrics/R1: 27.96780684104628
 MSRVTT_full_val/v2t_metrics/R5: 63.98390342052314
 MSRVTT_full_val/v2t_metrics/R10: 78.26961770623743
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.09456740442656
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.932685986603744
 MSRVTT_full_test/t2v_metrics/R1: 9.531772575250836
 MSRVTT_full_test/t2v_metrics/R5: 29.06354515050167
 MSRVTT_full_test/t2v_metrics/R10: 41.50501672240803
 MSRVTT_full_test/t2v_metrics/R50: 76.0200668896321
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.34581939799331
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.570488097028733
 MSRVTT_full_test/v2t_metrics/R1: 9.966555183946488
 MSRVTT_full_test/v2t_metrics/R5: 30.03344481605351
 MSRVTT_full_test/v2t_metrics/R10: 44.94983277591973
 MSRVTT_full_test/v2t_metrics/R50: 78.82943143812709
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.34214046822743
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.78443110962604
 mnt_best       : 22.570488097028733
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 2.84834 (QuantReg: 6.71299) QuantErr: 6.71299 batch_time=39.61424 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 3.04875 (QuantReg: 6.71654) QuantErr: 6.71654 batch_time=0.49752 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 2.62515 (QuantReg: 6.62455) QuantErr: 6.62455 batch_time=0.53170 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 2.55001 (QuantReg: 6.45798) QuantErr: 6.45798 batch_time=0.50875 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 2.87623 (QuantReg: 6.56368) QuantErr: 6.56368 batch_time=1.54041 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 2.62648 (QuantReg: 6.57278) QuantErr: 6.57278 batch_time=0.63978 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 2.68056 (QuantReg: 7.18962) QuantErr: 7.18962 batch_time=0.49788 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 2.82438 (QuantReg: 6.67325) QuantErr: 6.67325 batch_time=0.49790 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 2.70600 (QuantReg: 7.04662) QuantErr: 7.04662 batch_time=0.49708 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 2.72065 (QuantReg: 6.94068) QuantErr: 6.94068 batch_time=0.52309 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 2.89178 (QuantReg: 6.93286) QuantErr: 6.93286 batch_time=0.50146 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 2.75357 (QuantReg: 6.69982) QuantErr: 6.69982 batch_time=0.50904 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 2.60108 (QuantReg: 6.59979) QuantErr: 6.59979 batch_time=0.56395 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 3.02234 (QuantReg: 6.68946) QuantErr: 6.68946 batch_time=0.51622 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 2.81394 (QuantReg: 6.96107) QuantErr: 6.96107 batch_time=1.48422 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 2.60404 (QuantReg: 6.59579) QuantErr: 6.59579 batch_time=0.53978 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 2.62270 (QuantReg: 6.41706) QuantErr: 6.41706 batch_time=0.49247 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 2.58609 (QuantReg: 6.74517) QuantErr: 6.74517 batch_time=0.61960 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 3.05285 (QuantReg: 7.29135) QuantErr: 7.29135 batch_time=0.50540 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 2.80662 (QuantReg: 6.91182) QuantErr: 6.91182 batch_time=0.51567 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 2.55345 (QuantReg: 6.63573) QuantErr: 6.63573 batch_time=0.50161 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 2.98175 (QuantReg: 7.31749) QuantErr: 7.31749 batch_time=0.52920 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 2.66984 (QuantReg: 6.91258) QuantErr: 6.91258 batch_time=0.48765 
Train Epoch: 17 codebook_update_time=1.63932
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch17.pth ...
Done in 4.373s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch17.pth ...
Done in 8.354s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 2.7498123893737794
 quant_reg      : 6.820907691955567
 quant_err      : 6.820907691955567
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 24.14486921529175
 MSRVTT_full_val/t2v_metrics/R5: 61.3682092555332
 MSRVTT_full_val/t2v_metrics/R10: 74.04426559356136
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.722334004024145
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.872551970162434
 MSRVTT_full_val/v2t_metrics/R1: 23.74245472837022
 MSRVTT_full_val/v2t_metrics/R5: 64.98993963782696
 MSRVTT_full_val/v2t_metrics/R10: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.364185110663984
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.21704434672591
 MSRVTT_full_test/t2v_metrics/R1: 9.732441471571907
 MSRVTT_full_test/t2v_metrics/R5: 28.695652173913043
 MSRVTT_full_test/t2v_metrics/R10: 41.40468227424749
 MSRVTT_full_test/t2v_metrics/R50: 76.0200668896321
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.02658862876254
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.61322230415529
 MSRVTT_full_test/v2t_metrics/R1: 8.79598662207358
 MSRVTT_full_test/v2t_metrics/R5: 29.83277591973244
 MSRVTT_full_test/v2t_metrics/R10: 44.71571906354515
 MSRVTT_full_test/v2t_metrics/R50: 77.9933110367893
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.9809364548495
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.723722743025096
 mnt_best       : 22.61322230415529
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 3.01761 (QuantReg: 6.94436) QuantErr: 6.94436 batch_time=39.94161 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 2.62332 (QuantReg: 6.92248) QuantErr: 6.92248 batch_time=0.50900 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 2.80461 (QuantReg: 6.87514) QuantErr: 6.87514 batch_time=0.57592 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 2.66043 (QuantReg: 6.60905) QuantErr: 6.60905 batch_time=0.55613 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 2.90115 (QuantReg: 6.86897) QuantErr: 6.86897 batch_time=0.51601 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 2.76427 (QuantReg: 6.73723) QuantErr: 6.73723 batch_time=0.49675 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 2.97400 (QuantReg: 6.59112) QuantErr: 6.59112 batch_time=0.49920 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 2.93663 (QuantReg: 6.75375) QuantErr: 6.75375 batch_time=0.54215 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 2.48842 (QuantReg: 6.74446) QuantErr: 6.74446 batch_time=0.50907 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 2.68695 (QuantReg: 6.83208) QuantErr: 6.83208 batch_time=0.88591 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 2.49015 (QuantReg: 6.71725) QuantErr: 6.71725 batch_time=0.50250 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 2.85626 (QuantReg: 6.65088) QuantErr: 6.65088 batch_time=0.50696 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 3.13879 (QuantReg: 7.03200) QuantErr: 7.03200 batch_time=0.56908 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 2.57816 (QuantReg: 6.70484) QuantErr: 6.70484 batch_time=0.50928 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 2.66518 (QuantReg: 6.90980) QuantErr: 6.90980 batch_time=0.50808 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 2.93609 (QuantReg: 6.98727) QuantErr: 6.98727 batch_time=0.50841 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 2.64939 (QuantReg: 6.82683) QuantErr: 6.82683 batch_time=0.50181 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 2.52797 (QuantReg: 6.77650) QuantErr: 6.77650 batch_time=0.50018 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 2.62699 (QuantReg: 6.45389) QuantErr: 6.45389 batch_time=1.06232 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 3.04540 (QuantReg: 7.10661) QuantErr: 7.10661 batch_time=1.06749 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 2.87669 (QuantReg: 6.88751) QuantErr: 6.88751 batch_time=0.50102 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 2.43898 (QuantReg: 6.75068) QuantErr: 6.75068 batch_time=0.50900 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 2.68308 (QuantReg: 6.98165) QuantErr: 6.98165 batch_time=0.86270 
Train Epoch: 18 codebook_update_time=1.62042
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch18.pth ...
Done in 3.961s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch18.pth ...
Done in 8.535s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 2.707187286376953
 quant_reg      : 6.81520530128479
 quant_err      : 6.81520530128479
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 60.36217303822938
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.154929577464788
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.045378566452435
 MSRVTT_full_val/v2t_metrics/R1: 26.156941649899398
 MSRVTT_full_val/v2t_metrics/R5: 64.78873239436619
 MSRVTT_full_val/v2t_metrics/R10: 77.8672032193159
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.14486921529175
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.91123992749454
 MSRVTT_full_test/t2v_metrics/R1: 10.0
 MSRVTT_full_test/t2v_metrics/R5: 28.327759197324415
 MSRVTT_full_test/t2v_metrics/R10: 41.103678929765884
 MSRVTT_full_test/t2v_metrics/R50: 76.18729096989966
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.26638795986622
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.665447889306723
 MSRVTT_full_test/v2t_metrics/R1: 9.397993311036789
 MSRVTT_full_test/v2t_metrics/R5: 30.535117056856187
 MSRVTT_full_test/v2t_metrics/R10: 44.71571906354515
 MSRVTT_full_test/v2t_metrics/R50: 78.52842809364549
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.13795986622073
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.411629715254193
 mnt_best       : 22.665447889306723
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 2.61511 (QuantReg: 6.73954) QuantErr: 6.73954 batch_time=34.47769 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 2.61410 (QuantReg: 6.89559) QuantErr: 6.89559 batch_time=0.54410 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 2.79480 (QuantReg: 6.71252) QuantErr: 6.71252 batch_time=0.49157 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 2.79818 (QuantReg: 6.99752) QuantErr: 6.99752 batch_time=0.50045 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 2.82817 (QuantReg: 6.85226) QuantErr: 6.85226 batch_time=0.49882 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 2.73841 (QuantReg: 6.98823) QuantErr: 6.98823 batch_time=0.49476 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 2.65374 (QuantReg: 6.64132) QuantErr: 6.64132 batch_time=0.90453 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 2.88408 (QuantReg: 7.17222) QuantErr: 7.17222 batch_time=0.91717 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 2.69419 (QuantReg: 6.59064) QuantErr: 6.59064 batch_time=0.93160 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 2.58228 (QuantReg: 6.80696) QuantErr: 6.80696 batch_time=0.55086 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 2.63973 (QuantReg: 6.82229) QuantErr: 6.82229 batch_time=0.55795 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 2.69187 (QuantReg: 7.08191) QuantErr: 7.08191 batch_time=0.53095 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 2.67847 (QuantReg: 6.70978) QuantErr: 6.70978 batch_time=0.56215 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 2.35578 (QuantReg: 6.71214) QuantErr: 6.71214 batch_time=0.49859 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 2.81059 (QuantReg: 6.98200) QuantErr: 6.98200 batch_time=0.49741 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 2.37391 (QuantReg: 6.69854) QuantErr: 6.69854 batch_time=0.50286 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 2.83160 (QuantReg: 6.80959) QuantErr: 6.80959 batch_time=0.51469 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 2.81547 (QuantReg: 6.95674) QuantErr: 6.95674 batch_time=0.55125 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 2.64782 (QuantReg: 6.79573) QuantErr: 6.79573 batch_time=0.50049 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 2.34478 (QuantReg: 6.91306) QuantErr: 6.91306 batch_time=0.49815 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 2.48820 (QuantReg: 6.94160) QuantErr: 6.94160 batch_time=0.52182 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 2.48075 (QuantReg: 6.98490) QuantErr: 6.98490 batch_time=0.50105 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 2.70337 (QuantReg: 6.76465) QuantErr: 6.76465 batch_time=0.52320 
Train Epoch: 19 codebook_update_time=1.68102
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch19.pth ...
Done in 3.944s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 2.6568721704483034
 quant_reg      : 6.8130868072509765
 quant_err      : 6.8130868072509765
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_full_val/t2v_metrics/R1: 23.74245472837022
 MSRVTT_full_val/t2v_metrics/R5: 60.160965794768615
 MSRVTT_full_val/t2v_metrics/R10: 73.44064386317908
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.442655935613683
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.16200912333731
 MSRVTT_full_val/v2t_metrics/R1: 26.961770623742456
 MSRVTT_full_val/v2t_metrics/R5: 63.38028169014085
 MSRVTT_full_val/v2t_metrics/R10: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.629778672032193
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.74305309495235
 MSRVTT_full_test/t2v_metrics/R1: 9.23076923076923
 MSRVTT_full_test/t2v_metrics/R5: 28.862876254180602
 MSRVTT_full_test/t2v_metrics/R10: 41.103678929765884
 MSRVTT_full_test/t2v_metrics/R50: 76.25418060200668
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.35702341137124
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.206804295755372
 MSRVTT_full_test/v2t_metrics/R1: 10.033444816053512
 MSRVTT_full_test/v2t_metrics/R5: 30.401337792642142
 MSRVTT_full_test/v2t_metrics/R10: 45.719063545150505
 MSRVTT_full_test/v2t_metrics/R50: 79.03010033444816
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.34448160535117
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.070218307728375
 mnt_best       : 22.665447889306723
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 2.67506 (QuantReg: 6.69985) QuantErr: 6.69985 batch_time=38.01201 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 2.77506 (QuantReg: 6.52037) QuantErr: 6.52037 batch_time=1.92222 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 2.59381 (QuantReg: 6.67862) QuantErr: 6.67862 batch_time=0.53854 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 2.67126 (QuantReg: 6.94223) QuantErr: 6.94223 batch_time=0.51104 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 2.74898 (QuantReg: 6.92860) QuantErr: 6.92860 batch_time=0.51364 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 2.49826 (QuantReg: 6.60362) QuantErr: 6.60362 batch_time=0.49969 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 2.53711 (QuantReg: 6.80749) QuantErr: 6.80749 batch_time=1.45847 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 2.44712 (QuantReg: 6.63780) QuantErr: 6.63780 batch_time=0.50495 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 2.99823 (QuantReg: 6.89494) QuantErr: 6.89494 batch_time=0.53821 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 2.69318 (QuantReg: 6.98108) QuantErr: 6.98108 batch_time=0.52080 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 2.35698 (QuantReg: 6.75910) QuantErr: 6.75910 batch_time=0.50137 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 2.39682 (QuantReg: 6.69464) QuantErr: 6.69464 batch_time=0.51142 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 2.67680 (QuantReg: 6.65042) QuantErr: 6.65042 batch_time=0.51851 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 2.77023 (QuantReg: 6.90400) QuantErr: 6.90400 batch_time=1.45741 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 2.73546 (QuantReg: 6.54862) QuantErr: 6.54862 batch_time=0.49928 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 2.87603 (QuantReg: 6.91568) QuantErr: 6.91568 batch_time=0.52777 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 2.67844 (QuantReg: 7.17645) QuantErr: 7.17645 batch_time=0.55544 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 2.71896 (QuantReg: 7.09160) QuantErr: 7.09160 batch_time=0.51529 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 2.53132 (QuantReg: 6.74950) QuantErr: 6.74950 batch_time=0.49858 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 3.02695 (QuantReg: 6.73827) QuantErr: 6.73827 batch_time=0.52614 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 3.12245 (QuantReg: 6.63628) QuantErr: 6.63628 batch_time=0.52096 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 2.49553 (QuantReg: 6.87019) QuantErr: 6.87019 batch_time=0.48846 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 2.42122 (QuantReg: 7.09416) QuantErr: 7.09416 batch_time=0.51684 
Train Epoch: 20 codebook_update_time=1.71072
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch20.pth ...
Done in 9.447s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 2.6557119884490965
 quant_reg      : 6.807210279464722
 quant_err      : 6.807210279464722
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 74.24547283702213
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.114688128772636
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.52217542287185
 MSRVTT_full_val/v2t_metrics/R1: 28.571428571428573
 MSRVTT_full_val/v2t_metrics/R5: 64.78873239436619
 MSRVTT_full_val/v2t_metrics/R10: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.380281690140846
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.341390967972075
 MSRVTT_full_test/t2v_metrics/R1: 8.963210702341136
 MSRVTT_full_test/t2v_metrics/R5: 29.23076923076923
 MSRVTT_full_test/t2v_metrics/R10: 42.374581939799334
 MSRVTT_full_test/t2v_metrics/R50: 76.42140468227424
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.917892976588625
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.308468619527876
 MSRVTT_full_test/v2t_metrics/R1: 10.367892976588628
 MSRVTT_full_test/v2t_metrics/R5: 31.036789297658864
 MSRVTT_full_test/v2t_metrics/R10: 44.61538461538461
 MSRVTT_full_test/v2t_metrics/R50: 78.56187290969899
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 50.17993311036789
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.304348181523384
 mnt_best       : 22.665447889306723
 not_improved_count: 2
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 2.62011 (QuantReg: 6.86251) QuantErr: 6.86251 batch_time=36.11052 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 2.61635 (QuantReg: 6.94032) QuantErr: 6.94032 batch_time=0.50430 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 2.57654 (QuantReg: 6.46387) QuantErr: 6.46387 batch_time=0.49612 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 2.48389 (QuantReg: 7.08573) QuantErr: 7.08573 batch_time=0.58807 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 2.39171 (QuantReg: 6.81390) QuantErr: 6.81390 batch_time=0.50580 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 2.53171 (QuantReg: 7.14807) QuantErr: 7.14807 batch_time=0.51073 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 2.67600 (QuantReg: 6.83383) QuantErr: 6.83383 batch_time=5.07705 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 2.58538 (QuantReg: 6.47053) QuantErr: 6.47053 batch_time=0.52088 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 2.76558 (QuantReg: 6.80499) QuantErr: 6.80499 batch_time=0.50430 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 2.75915 (QuantReg: 6.50560) QuantErr: 6.50560 batch_time=0.77056 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 2.48915 (QuantReg: 6.54186) QuantErr: 6.54186 batch_time=0.53601 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 2.60513 (QuantReg: 7.02303) QuantErr: 7.02303 batch_time=0.51404 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 2.32187 (QuantReg: 6.36082) QuantErr: 6.36082 batch_time=0.50886 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 2.78292 (QuantReg: 7.13614) QuantErr: 7.13614 batch_time=0.54929 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 2.64695 (QuantReg: 6.64258) QuantErr: 6.64258 batch_time=0.52115 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 2.67190 (QuantReg: 7.07569) QuantErr: 7.07569 batch_time=0.50068 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 2.73875 (QuantReg: 7.16760) QuantErr: 7.16760 batch_time=0.50022 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 2.51527 (QuantReg: 6.71832) QuantErr: 6.71832 batch_time=0.50976 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 2.54718 (QuantReg: 6.77021) QuantErr: 6.77021 batch_time=0.50056 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 2.82994 (QuantReg: 6.58428) QuantErr: 6.58428 batch_time=0.51428 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 2.62259 (QuantReg: 6.88612) QuantErr: 6.88612 batch_time=0.52647 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 2.61521 (QuantReg: 7.21079) QuantErr: 7.21079 batch_time=0.50525 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 2.34955 (QuantReg: 6.71299) QuantErr: 6.71299 batch_time=0.59146 
Train Epoch: 21 codebook_update_time=1.67614
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch21.pth ...
Done in 4.196s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 2.618432434082031
 quant_reg      : 6.809251203536987
 quant_err      : 6.809251203536987
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 60.96579476861167
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.346076458752515
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.76218585120019
 MSRVTT_full_val/v2t_metrics/R1: 26.156941649899398
 MSRVTT_full_val/v2t_metrics/R5: 64.78873239436619
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.513078470824949
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.513479616599184
 MSRVTT_full_test/t2v_metrics/R1: 9.264214046822742
 MSRVTT_full_test/t2v_metrics/R5: 28.99665551839465
 MSRVTT_full_test/t2v_metrics/R10: 42.34113712374582
 MSRVTT_full_test/t2v_metrics/R50: 76.2876254180602
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.142140468227424
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.489147994246824
 MSRVTT_full_test/v2t_metrics/R1: 9.966555183946488
 MSRVTT_full_test/v2t_metrics/R5: 30.96989966555184
 MSRVTT_full_test/v2t_metrics/R10: 45.719063545150505
 MSRVTT_full_test/v2t_metrics/R50: 78.32775919732441
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.65585284280937
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.165404370782728
 mnt_best       : 22.665447889306723
 not_improved_count: 3
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 2.84038 (QuantReg: 6.60332) QuantErr: 6.60332 batch_time=38.10925 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 2.58469 (QuantReg: 6.87646) QuantErr: 6.87646 batch_time=0.50900 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 2.55493 (QuantReg: 6.81640) QuantErr: 6.81640 batch_time=0.48969 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 2.54581 (QuantReg: 6.33014) QuantErr: 6.33014 batch_time=0.52223 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 2.64561 (QuantReg: 6.89769) QuantErr: 6.89769 batch_time=0.59851 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 2.43224 (QuantReg: 6.78010) QuantErr: 6.78010 batch_time=0.48089 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 2.49475 (QuantReg: 6.68153) QuantErr: 6.68153 batch_time=0.91065 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 2.32865 (QuantReg: 6.58031) QuantErr: 6.58031 batch_time=0.48882 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 2.85495 (QuantReg: 6.33007) QuantErr: 6.33007 batch_time=0.54404 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 2.71397 (QuantReg: 6.84407) QuantErr: 6.84407 batch_time=0.48944 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 2.83515 (QuantReg: 6.76513) QuantErr: 6.76513 batch_time=1.08057 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 2.51509 (QuantReg: 6.87691) QuantErr: 6.87691 batch_time=0.59125 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 2.76496 (QuantReg: 6.87006) QuantErr: 6.87006 batch_time=0.51077 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 2.72416 (QuantReg: 6.86104) QuantErr: 6.86104 batch_time=0.52270 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 2.63727 (QuantReg: 6.81961) QuantErr: 6.81961 batch_time=0.55428 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 2.73622 (QuantReg: 6.72709) QuantErr: 6.72709 batch_time=0.49066 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 2.70475 (QuantReg: 6.88744) QuantErr: 6.88744 batch_time=0.54252 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 2.76837 (QuantReg: 7.12586) QuantErr: 7.12586 batch_time=0.51172 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 2.56915 (QuantReg: 6.36742) QuantErr: 6.36742 batch_time=0.49046 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 2.64220 (QuantReg: 6.79324) QuantErr: 6.79324 batch_time=0.49966 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 2.80414 (QuantReg: 6.88386) QuantErr: 6.88386 batch_time=3.01157 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 2.49952 (QuantReg: 6.81502) QuantErr: 6.81502 batch_time=0.51716 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 2.42581 (QuantReg: 7.03715) QuantErr: 7.03715 batch_time=0.49083 
Train Epoch: 22 codebook_update_time=2.11225
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch22.pth ...
Done in 9.514s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 2.579610676765442
 quant_reg      : 6.81338950920105
 quant_err      : 6.81338950920105
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.193158953722333
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.87811382819455
 MSRVTT_full_val/v2t_metrics/R1: 26.961770623742456
 MSRVTT_full_val/v2t_metrics/R5: 63.17907444668008
 MSRVTT_full_val/v2t_metrics/R10: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.70824949698189
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.421097448096425
 MSRVTT_full_test/t2v_metrics/R1: 9.397993311036789
 MSRVTT_full_test/t2v_metrics/R5: 28.762541806020067
 MSRVTT_full_test/t2v_metrics/R10: 42.07357859531773
 MSRVTT_full_test/t2v_metrics/R50: 76.92307692307692
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.43528428093646
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.488333978057668
 MSRVTT_full_test/v2t_metrics/R1: 9.866220735785953
 MSRVTT_full_test/v2t_metrics/R5: 30.96989966555184
 MSRVTT_full_test/v2t_metrics/R10: 45.35117056856188
 MSRVTT_full_test/v2t_metrics/R50: 78.8628762541806
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 50.960033444816055
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.019264745769505
 mnt_best       : 22.665447889306723
 not_improved_count: 4
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 2.59851 (QuantReg: 6.39826) QuantErr: 6.39826 batch_time=32.99395 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 2.74524 (QuantReg: 7.06031) QuantErr: 7.06031 batch_time=0.48811 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 2.25261 (QuantReg: 6.91313) QuantErr: 6.91313 batch_time=0.48839 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 2.67938 (QuantReg: 6.83209) QuantErr: 6.83209 batch_time=0.49925 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 2.66513 (QuantReg: 7.05606) QuantErr: 7.05606 batch_time=0.49386 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 2.53584 (QuantReg: 6.81776) QuantErr: 6.81776 batch_time=0.49902 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 2.62673 (QuantReg: 6.70873) QuantErr: 6.70873 batch_time=8.29710 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 2.60337 (QuantReg: 6.97373) QuantErr: 6.97373 batch_time=0.49860 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 2.69816 (QuantReg: 6.47976) QuantErr: 6.47976 batch_time=0.48666 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 2.30470 (QuantReg: 6.66053) QuantErr: 6.66053 batch_time=0.51541 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 2.68714 (QuantReg: 6.70330) QuantErr: 6.70330 batch_time=0.50309 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 2.58275 (QuantReg: 6.53113) QuantErr: 6.53113 batch_time=0.50237 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 2.48347 (QuantReg: 6.90049) QuantErr: 6.90049 batch_time=0.49746 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 2.64362 (QuantReg: 6.88290) QuantErr: 6.88290 batch_time=0.50982 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 2.70430 (QuantReg: 6.92460) QuantErr: 6.92460 batch_time=0.51767 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 2.75513 (QuantReg: 6.66418) QuantErr: 6.66418 batch_time=0.48609 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 2.39264 (QuantReg: 7.19508) QuantErr: 7.19508 batch_time=0.50541 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 2.65964 (QuantReg: 6.93737) QuantErr: 6.93737 batch_time=0.50547 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 2.34234 (QuantReg: 7.23271) QuantErr: 7.23271 batch_time=0.51219 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 2.43263 (QuantReg: 6.88427) QuantErr: 6.88427 batch_time=0.49018 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 2.34407 (QuantReg: 6.98176) QuantErr: 6.98176 batch_time=0.55846 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 2.57134 (QuantReg: 6.98686) QuantErr: 6.98686 batch_time=0.49320 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 2.45401 (QuantReg: 6.42580) QuantErr: 6.42580 batch_time=0.51186 
Train Epoch: 23 codebook_update_time=1.91684
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch23.pth ...
Done in 3.849s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch23.pth ...
Done in 7.708s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 2.588195728302002
 quant_reg      : 6.841833061218262
 quant_err      : 6.841833061218262
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 61.16700201207244
 MSRVTT_full_val/t2v_metrics/R10: 72.83702213279678
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.714285714285714
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.95192354149008
 MSRVTT_full_val/v2t_metrics/R1: 25.553319919517104
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.87122736418511
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.89630793858589
 MSRVTT_full_test/t2v_metrics/R1: 9.565217391304348
 MSRVTT_full_test/t2v_metrics/R5: 29.39799331103679
 MSRVTT_full_test/t2v_metrics/R10: 42.374581939799334
 MSRVTT_full_test/t2v_metrics/R50: 76.0200668896321
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.99732441471572
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.840519945368506
 MSRVTT_full_test/v2t_metrics/R1: 10.40133779264214
 MSRVTT_full_test/v2t_metrics/R5: 30.702341137123746
 MSRVTT_full_test/v2t_metrics/R10: 45.618729096989966
 MSRVTT_full_test/v2t_metrics/R50: 78.96321070234114
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.12257525083612
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.423128353243033
 mnt_best       : 22.840519945368506
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 2.73134 (QuantReg: 6.60583) QuantErr: 6.60583 batch_time=39.24983 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 2.48543 (QuantReg: 6.82736) QuantErr: 6.82736 batch_time=0.63555 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 2.40249 (QuantReg: 6.98101) QuantErr: 6.98101 batch_time=0.49264 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 2.70510 (QuantReg: 6.98009) QuantErr: 6.98009 batch_time=0.51125 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 2.64709 (QuantReg: 6.75586) QuantErr: 6.75586 batch_time=0.48867 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 2.19647 (QuantReg: 6.83509) QuantErr: 6.83509 batch_time=0.48469 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 2.44701 (QuantReg: 7.05909) QuantErr: 7.05909 batch_time=0.52674 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 2.61955 (QuantReg: 6.65081) QuantErr: 6.65081 batch_time=0.48849 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 2.43624 (QuantReg: 6.89953) QuantErr: 6.89953 batch_time=0.48928 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 2.49647 (QuantReg: 6.97139) QuantErr: 6.97139 batch_time=0.51499 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 2.64906 (QuantReg: 6.58334) QuantErr: 6.58334 batch_time=0.48536 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 2.67034 (QuantReg: 6.90171) QuantErr: 6.90171 batch_time=0.49826 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 2.57249 (QuantReg: 6.81483) QuantErr: 6.81483 batch_time=0.51149 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 3.00790 (QuantReg: 7.29768) QuantErr: 7.29768 batch_time=5.78636 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 2.62382 (QuantReg: 6.37208) QuantErr: 6.37208 batch_time=0.51653 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 2.45435 (QuantReg: 6.88517) QuantErr: 6.88517 batch_time=0.49891 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 2.38730 (QuantReg: 7.18391) QuantErr: 7.18391 batch_time=0.54615 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 2.41390 (QuantReg: 6.90961) QuantErr: 6.90961 batch_time=0.50166 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 2.55246 (QuantReg: 6.80637) QuantErr: 6.80637 batch_time=0.50783 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 2.51966 (QuantReg: 7.03965) QuantErr: 7.03965 batch_time=1.40956 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 2.66650 (QuantReg: 6.65303) QuantErr: 6.65303 batch_time=0.52416 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 2.56025 (QuantReg: 6.57832) QuantErr: 6.57832 batch_time=0.50079 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 2.45828 (QuantReg: 6.78463) QuantErr: 6.78463 batch_time=0.48661 
Train Epoch: 24 codebook_update_time=1.86117
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch24.pth ...
Done in 16.556s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 2.5521372327804563
 quant_reg      : 6.85927582359314
 quant_err      : 6.85927582359314
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R10: 75.85513078470825
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.637826961770624
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.05521547228073
 MSRVTT_full_val/v2t_metrics/R1: 25.35211267605634
 MSRVTT_full_val/v2t_metrics/R5: 62.776659959758554
 MSRVTT_full_val/v2t_metrics/R10: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.010060362173038
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.59756053969905
 MSRVTT_full_test/t2v_metrics/R1: 9.23076923076923
 MSRVTT_full_test/t2v_metrics/R5: 29.096989966555185
 MSRVTT_full_test/t2v_metrics/R10: 42.441471571906355
 MSRVTT_full_test/t2v_metrics/R50: 76.52173913043478
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.272742474916384
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.505679538648568
 MSRVTT_full_test/v2t_metrics/R1: 9.698996655518394
 MSRVTT_full_test/v2t_metrics/R5: 30.267558528428093
 MSRVTT_full_test/v2t_metrics/R10: 44.78260869565217
 MSRVTT_full_test/v2t_metrics/R50: 78.46153846153847
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.41404682274248
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.60140530452345
 mnt_best       : 22.840519945368506
 not_improved_count: 1
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 2.79110 (QuantReg: 6.78219) QuantErr: 6.78219 batch_time=41.04055 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 2.53177 (QuantReg: 6.96543) QuantErr: 6.96543 batch_time=0.51747 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 2.45397 (QuantReg: 7.18107) QuantErr: 7.18107 batch_time=0.61611 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 2.60892 (QuantReg: 6.49291) QuantErr: 6.49291 batch_time=0.49781 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 2.40888 (QuantReg: 6.95138) QuantErr: 6.95138 batch_time=0.50338 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 2.54360 (QuantReg: 6.97700) QuantErr: 6.97700 batch_time=0.77498 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 2.64582 (QuantReg: 6.48326) QuantErr: 6.48326 batch_time=1.25991 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 2.63166 (QuantReg: 7.00138) QuantErr: 7.00138 batch_time=0.52642 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 2.56325 (QuantReg: 6.92825) QuantErr: 6.92825 batch_time=0.49461 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 2.54841 (QuantReg: 6.62338) QuantErr: 6.62338 batch_time=0.48543 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 2.69055 (QuantReg: 6.72845) QuantErr: 6.72845 batch_time=0.57583 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 2.33990 (QuantReg: 6.74287) QuantErr: 6.74287 batch_time=0.59604 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 2.53464 (QuantReg: 7.07703) QuantErr: 7.07703 batch_time=0.50840 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 2.47150 (QuantReg: 7.04376) QuantErr: 7.04376 batch_time=0.50445 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 2.66325 (QuantReg: 6.93462) QuantErr: 6.93462 batch_time=0.49601 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 2.69439 (QuantReg: 6.56313) QuantErr: 6.56313 batch_time=0.50825 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 2.50943 (QuantReg: 7.21723) QuantErr: 7.21723 batch_time=0.49053 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 2.59425 (QuantReg: 7.12456) QuantErr: 7.12456 batch_time=0.50784 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 2.49019 (QuantReg: 6.96055) QuantErr: 6.96055 batch_time=0.50459 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 2.47903 (QuantReg: 6.95351) QuantErr: 6.95351 batch_time=0.50685 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 2.58369 (QuantReg: 6.97215) QuantErr: 6.97215 batch_time=0.54182 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 2.71944 (QuantReg: 6.78935) QuantErr: 6.78935 batch_time=0.49726 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 2.44782 (QuantReg: 6.54173) QuantErr: 6.54173 batch_time=0.50194 
Train Epoch: 25 codebook_update_time=2.18701
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch25.pth ...
Done in 4.844s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 2.5485605659484865
 quant_reg      : 6.872445560455322
 quant_err      : 6.872445560455322
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_full_val/t2v_metrics/R1: 24.14486921529175
 MSRVTT_full_val/t2v_metrics/R5: 60.563380281690144
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.416498993963783
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.48903227698629
 MSRVTT_full_val/v2t_metrics/R1: 26.358148893360163
 MSRVTT_full_val/v2t_metrics/R5: 62.97786720321932
 MSRVTT_full_val/v2t_metrics/R10: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.569416498993963
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.298744816472215
 MSRVTT_full_test/t2v_metrics/R1: 9.331103678929766
 MSRVTT_full_test/t2v_metrics/R5: 28.795986622073578
 MSRVTT_full_test/t2v_metrics/R10: 42.575250836120404
 MSRVTT_full_test/t2v_metrics/R50: 75.88628762541806
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.21872909698997
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.532397171453137
 MSRVTT_full_test/v2t_metrics/R1: 10.133779264214047
 MSRVTT_full_test/v2t_metrics/R5: 30.869565217391305
 MSRVTT_full_test/v2t_metrics/R10: 45.08361204013378
 MSRVTT_full_test/v2t_metrics/R50: 79.1638795986622
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.764715719063545
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.16055384289742
 mnt_best       : 22.840519945368506
 not_improved_count: 2
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 2.62525 (QuantReg: 6.66927) QuantErr: 6.66927 batch_time=35.59659 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 2.42930 (QuantReg: 6.45712) QuantErr: 6.45712 batch_time=0.50225 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 2.15927 (QuantReg: 6.87098) QuantErr: 6.87098 batch_time=0.50612 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 2.38751 (QuantReg: 6.91544) QuantErr: 6.91544 batch_time=0.49518 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 2.44358 (QuantReg: 6.84287) QuantErr: 6.84287 batch_time=0.54556 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 2.50062 (QuantReg: 6.59971) QuantErr: 6.59971 batch_time=0.49351 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 2.43434 (QuantReg: 7.03054) QuantErr: 7.03054 batch_time=2.96885 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 2.60721 (QuantReg: 6.86545) QuantErr: 6.86545 batch_time=2.75163 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 2.39912 (QuantReg: 6.94548) QuantErr: 6.94548 batch_time=1.04458 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 2.46845 (QuantReg: 6.67631) QuantErr: 6.67631 batch_time=0.49916 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 2.33033 (QuantReg: 6.92160) QuantErr: 6.92160 batch_time=0.69720 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 2.34004 (QuantReg: 6.82983) QuantErr: 6.82983 batch_time=0.49696 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 2.30946 (QuantReg: 6.38116) QuantErr: 6.38116 batch_time=0.49468 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 2.44876 (QuantReg: 6.55628) QuantErr: 6.55628 batch_time=0.49095 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 2.61910 (QuantReg: 6.75609) QuantErr: 6.75609 batch_time=0.52131 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 2.62086 (QuantReg: 7.07919) QuantErr: 7.07919 batch_time=0.51655 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 2.52717 (QuantReg: 6.71838) QuantErr: 6.71838 batch_time=0.51759 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 2.32787 (QuantReg: 6.99557) QuantErr: 6.99557 batch_time=0.54599 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 2.48824 (QuantReg: 6.97305) QuantErr: 6.97305 batch_time=0.50109 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 2.35630 (QuantReg: 7.13505) QuantErr: 7.13505 batch_time=0.51572 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 2.94210 (QuantReg: 6.87776) QuantErr: 6.87776 batch_time=0.51229 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 2.35887 (QuantReg: 6.83599) QuantErr: 6.83599 batch_time=0.50106 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 2.35512 (QuantReg: 6.81841) QuantErr: 6.81841 batch_time=0.50694 
Train Epoch: 26 codebook_update_time=1.73301
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch26.pth ...
Done in 20.843s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch26.pth ...
Done in 24.714s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 2.536026189804077
 quant_reg      : 6.890607694625855
 quant_err      : 6.890607694625855
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 60.76458752515091
 MSRVTT_full_val/t2v_metrics/R10: 73.03822937625755
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.201207243460765
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.76041342499504
 MSRVTT_full_val/v2t_metrics/R1: 26.559356136820927
 MSRVTT_full_val/v2t_metrics/R5: 63.17907444668008
 MSRVTT_full_val/v2t_metrics/R10: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.595573440643863
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.213661848396995
 MSRVTT_full_test/t2v_metrics/R1: 9.698996655518394
 MSRVTT_full_test/t2v_metrics/R5: 29.531772575250837
 MSRVTT_full_test/t2v_metrics/R10: 42.508361204013376
 MSRVTT_full_test/t2v_metrics/R50: 76.45484949832776
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.43478260869565
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.00542331707246
 MSRVTT_full_test/v2t_metrics/R1: 10.100334448160535
 MSRVTT_full_test/v2t_metrics/R5: 30.468227424749163
 MSRVTT_full_test/v2t_metrics/R10: 44.180602006688964
 MSRVTT_full_test/v2t_metrics/R50: 78.59531772575251
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.69046822742475
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.867386035323086
 mnt_best       : 23.00542331707246
 not_improved_count: 0
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 2.35030 (QuantReg: 7.22821) QuantErr: 7.22821 batch_time=44.15649 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 2.61442 (QuantReg: 7.12133) QuantErr: 7.12133 batch_time=0.51176 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 2.55209 (QuantReg: 7.03770) QuantErr: 7.03770 batch_time=1.34553 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 2.62193 (QuantReg: 6.96601) QuantErr: 6.96601 batch_time=0.51029 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 2.52360 (QuantReg: 6.73270) QuantErr: 6.73270 batch_time=0.51082 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 2.22172 (QuantReg: 7.07531) QuantErr: 7.07531 batch_time=0.49738 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 2.33022 (QuantReg: 6.70988) QuantErr: 6.70988 batch_time=0.50375 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 2.35099 (QuantReg: 6.83846) QuantErr: 6.83846 batch_time=0.49484 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 2.59201 (QuantReg: 6.96662) QuantErr: 6.96662 batch_time=0.49520 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 2.59856 (QuantReg: 6.60336) QuantErr: 6.60336 batch_time=0.49158 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 2.34414 (QuantReg: 6.97154) QuantErr: 6.97154 batch_time=0.49938 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 2.52508 (QuantReg: 6.92435) QuantErr: 6.92435 batch_time=0.67898 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 2.50523 (QuantReg: 6.86817) QuantErr: 6.86817 batch_time=0.49492 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 2.42407 (QuantReg: 6.64923) QuantErr: 6.64923 batch_time=0.49379 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 2.43350 (QuantReg: 7.20021) QuantErr: 7.20021 batch_time=0.51284 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 2.54061 (QuantReg: 6.86747) QuantErr: 6.86747 batch_time=0.50306 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 2.49600 (QuantReg: 6.74890) QuantErr: 6.74890 batch_time=0.49590 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 2.47856 (QuantReg: 6.68387) QuantErr: 6.68387 batch_time=0.56463 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 2.54261 (QuantReg: 6.82729) QuantErr: 6.82729 batch_time=0.50448 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 2.45399 (QuantReg: 7.19407) QuantErr: 7.19407 batch_time=0.56808 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 2.47736 (QuantReg: 6.72152) QuantErr: 6.72152 batch_time=0.55718 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 2.39642 (QuantReg: 6.81286) QuantErr: 6.81286 batch_time=0.50802 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 2.44064 (QuantReg: 6.88494) QuantErr: 6.88494 batch_time=0.50103 
Train Epoch: 27 codebook_update_time=1.82373
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch27.pth ...
Done in 3.854s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 2.487531434059143
 quant_reg      : 6.866560152053833
 quant_err      : 6.866560152053833
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_full_val/t2v_metrics/R1: 25.553319919517104
 MSRVTT_full_val/t2v_metrics/R5: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.537223340040242
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.961995689462306
 MSRVTT_full_val/v2t_metrics/R1: 27.16297786720322
 MSRVTT_full_val/v2t_metrics/R5: 63.78269617706238
 MSRVTT_full_val/v2t_metrics/R10: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.690140845070422
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.154639641323094
 MSRVTT_full_test/t2v_metrics/R1: 9.59866220735786
 MSRVTT_full_test/t2v_metrics/R5: 29.36454849498328
 MSRVTT_full_test/t2v_metrics/R10: 42.876254180602004
 MSRVTT_full_test/t2v_metrics/R50: 76.82274247491638
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.731270903010035
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.948287964528934
 MSRVTT_full_test/v2t_metrics/R1: 10.869565217391305
 MSRVTT_full_test/v2t_metrics/R5: 30.501672240802677
 MSRVTT_full_test/v2t_metrics/R10: 45.618729096989966
 MSRVTT_full_test/v2t_metrics/R50: 78.46153846153847
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.27842809364549
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.73012632955091
 mnt_best       : 23.00542331707246
 not_improved_count: 1
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 2.42792 (QuantReg: 6.82112) QuantErr: 6.82112 batch_time=39.12887 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 2.67317 (QuantReg: 6.95255) QuantErr: 6.95255 batch_time=0.50134 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 2.36548 (QuantReg: 6.84801) QuantErr: 6.84801 batch_time=0.56165 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 2.53909 (QuantReg: 7.05300) QuantErr: 7.05300 batch_time=0.51503 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 2.79450 (QuantReg: 7.11035) QuantErr: 7.11035 batch_time=0.50276 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 2.67019 (QuantReg: 7.13669) QuantErr: 7.13669 batch_time=0.50888 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 2.89890 (QuantReg: 7.08326) QuantErr: 7.08326 batch_time=2.31660 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 2.40499 (QuantReg: 7.23363) QuantErr: 7.23363 batch_time=0.49857 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 2.62249 (QuantReg: 7.02759) QuantErr: 7.02759 batch_time=0.51976 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 2.63203 (QuantReg: 6.72275) QuantErr: 6.72275 batch_time=0.51290 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 2.58519 (QuantReg: 6.63937) QuantErr: 6.63937 batch_time=0.50925 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 2.56275 (QuantReg: 6.89897) QuantErr: 6.89897 batch_time=0.51031 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 2.47117 (QuantReg: 7.13494) QuantErr: 7.13494 batch_time=0.51318 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 2.65149 (QuantReg: 6.56649) QuantErr: 6.56649 batch_time=0.65914 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 2.74865 (QuantReg: 6.90432) QuantErr: 6.90432 batch_time=0.50946 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 2.28612 (QuantReg: 6.70036) QuantErr: 6.70036 batch_time=0.53018 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 2.67958 (QuantReg: 6.77662) QuantErr: 6.77662 batch_time=0.56266 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 2.43338 (QuantReg: 6.73617) QuantErr: 6.73617 batch_time=0.56979 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 2.38239 (QuantReg: 7.01186) QuantErr: 7.01186 batch_time=0.54713 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 2.73669 (QuantReg: 7.05500) QuantErr: 7.05500 batch_time=0.50586 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 2.65971 (QuantReg: 6.72052) QuantErr: 6.72052 batch_time=0.58299 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 2.81133 (QuantReg: 6.48848) QuantErr: 6.48848 batch_time=0.51549 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 2.53755 (QuantReg: 7.05611) QuantErr: 7.05611 batch_time=0.51087 
Train Epoch: 28 codebook_update_time=1.73218
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch28.pth ...
Done in 22.874s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch28.pth ...
Done in 26.664s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 2.503684096336365
 quant_reg      : 6.914662019729614
 quant_err      : 6.914662019729614
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 63.38028169014085
 MSRVTT_full_val/t2v_metrics/R10: 74.64788732394366
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.756539235412475
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.96074022177775
 MSRVTT_full_val/v2t_metrics/R1: 27.16297786720322
 MSRVTT_full_val/v2t_metrics/R5: 64.58752515090544
 MSRVTT_full_val/v2t_metrics/R10: 78.26961770623743
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.414486921529175
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.59089697030944
 MSRVTT_full_test/t2v_metrics/R1: 9.899665551839465
 MSRVTT_full_test/t2v_metrics/R5: 30.13377926421405
 MSRVTT_full_test/t2v_metrics/R10: 42.642140468227424
 MSRVTT_full_test/t2v_metrics/R50: 77.35785953177258
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.10484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.343772420404417
 MSRVTT_full_test/v2t_metrics/R1: 9.933110367892976
 MSRVTT_full_test/v2t_metrics/R5: 29.765886287625417
 MSRVTT_full_test/v2t_metrics/R10: 45.819397993311036
 MSRVTT_full_test/v2t_metrics/R50: 79.09698996655518
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.71973244147157
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.838805269024803
 mnt_best       : 23.343772420404417
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 2.52720 (QuantReg: 6.94031) QuantErr: 6.94031 batch_time=38.23451 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 2.68382 (QuantReg: 6.85569) QuantErr: 6.85569 batch_time=0.49486 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 2.60372 (QuantReg: 6.40492) QuantErr: 6.40492 batch_time=0.50055 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 2.39566 (QuantReg: 6.76704) QuantErr: 6.76704 batch_time=0.49307 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 2.51027 (QuantReg: 6.64859) QuantErr: 6.64859 batch_time=0.51065 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 2.60987 (QuantReg: 6.90018) QuantErr: 6.90018 batch_time=0.50079 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 2.56696 (QuantReg: 7.02908) QuantErr: 7.02908 batch_time=0.49661 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 2.55786 (QuantReg: 6.86789) QuantErr: 6.86789 batch_time=0.50435 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 2.43886 (QuantReg: 7.28768) QuantErr: 7.28768 batch_time=0.50917 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 2.30236 (QuantReg: 7.03958) QuantErr: 7.03958 batch_time=0.54430 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 2.56486 (QuantReg: 6.92041) QuantErr: 6.92041 batch_time=0.88930 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 2.37710 (QuantReg: 7.11329) QuantErr: 7.11329 batch_time=0.49288 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 2.60840 (QuantReg: 6.98317) QuantErr: 6.98317 batch_time=0.51262 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 2.60043 (QuantReg: 7.00897) QuantErr: 7.00897 batch_time=0.51115 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 2.39934 (QuantReg: 6.84876) QuantErr: 6.84876 batch_time=0.53688 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 2.49349 (QuantReg: 6.89099) QuantErr: 6.89099 batch_time=0.50537 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 2.54124 (QuantReg: 6.75054) QuantErr: 6.75054 batch_time=0.54882 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 2.26607 (QuantReg: 6.84920) QuantErr: 6.84920 batch_time=0.49503 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 2.68084 (QuantReg: 6.88228) QuantErr: 6.88228 batch_time=0.48796 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 2.32903 (QuantReg: 6.88496) QuantErr: 6.88496 batch_time=0.51145 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 2.38027 (QuantReg: 6.65357) QuantErr: 6.65357 batch_time=0.50142 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 2.48430 (QuantReg: 6.77060) QuantErr: 6.77060 batch_time=0.49788 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 2.27044 (QuantReg: 7.03581) QuantErr: 7.03581 batch_time=0.60170 
Train Epoch: 29 codebook_update_time=1.90568
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch29.pth ...
Done in 4.017s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 2.4843996410369873
 quant_reg      : 6.901202377319336
 quant_err      : 6.901202377319336
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_full_val/t2v_metrics/R1: 26.961770623742456
 MSRVTT_full_val/t2v_metrics/R5: 61.77062374245473
 MSRVTT_full_val/t2v_metrics/R10: 74.44668008048289
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.305835010060362
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.86455073980366
 MSRVTT_full_val/v2t_metrics/R1: 26.559356136820927
 MSRVTT_full_val/v2t_metrics/R5: 64.58752515090544
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.93661971830986
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.7185932263167
 MSRVTT_full_test/t2v_metrics/R1: 9.799331103678929
 MSRVTT_full_test/t2v_metrics/R5: 29.531772575250837
 MSRVTT_full_test/t2v_metrics/R10: 42.441471571906355
 MSRVTT_full_test/t2v_metrics/R50: 76.72240802675586
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.89698996655518
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.072365715923638
 MSRVTT_full_test/v2t_metrics/R1: 9.765886287625419
 MSRVTT_full_test/v2t_metrics/R5: 30.301003344481604
 MSRVTT_full_test/v2t_metrics/R10: 45.585284280936456
 MSRVTT_full_test/v2t_metrics/R50: 78.52842809364549
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.99632107023412
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.80479504680261
 mnt_best       : 23.343772420404417
 not_improved_count: 1
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 2.30538 (QuantReg: 6.91233) QuantErr: 6.91233 batch_time=36.79299 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 2.51855 (QuantReg: 6.83084) QuantErr: 6.83084 batch_time=0.54304 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 2.51299 (QuantReg: 7.06704) QuantErr: 7.06704 batch_time=0.49765 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 2.58581 (QuantReg: 7.14311) QuantErr: 7.14311 batch_time=0.48414 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 2.50744 (QuantReg: 6.80170) QuantErr: 6.80170 batch_time=0.50749 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 2.38346 (QuantReg: 7.18320) QuantErr: 7.18320 batch_time=0.50330 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 2.58621 (QuantReg: 7.10121) QuantErr: 7.10121 batch_time=0.53007 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 2.38601 (QuantReg: 7.28908) QuantErr: 7.28908 batch_time=0.52133 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 2.53804 (QuantReg: 6.75017) QuantErr: 6.75017 batch_time=0.52783 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 2.30410 (QuantReg: 7.25804) QuantErr: 7.25804 batch_time=1.37761 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 2.49280 (QuantReg: 7.05165) QuantErr: 7.05165 batch_time=0.50014 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 2.33765 (QuantReg: 6.84188) QuantErr: 6.84188 batch_time=0.48868 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 2.47048 (QuantReg: 6.97574) QuantErr: 6.97574 batch_time=0.50052 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 2.43527 (QuantReg: 6.88187) QuantErr: 6.88187 batch_time=1.28651 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 2.50434 (QuantReg: 6.99832) QuantErr: 6.99832 batch_time=0.50063 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 2.54258 (QuantReg: 7.15813) QuantErr: 7.15813 batch_time=0.50742 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 2.40297 (QuantReg: 6.89119) QuantErr: 6.89119 batch_time=0.50696 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 2.27225 (QuantReg: 6.96108) QuantErr: 6.96108 batch_time=0.51013 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 2.74504 (QuantReg: 6.91986) QuantErr: 6.91986 batch_time=0.50934 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 2.50910 (QuantReg: 6.95181) QuantErr: 6.95181 batch_time=1.39345 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 2.45136 (QuantReg: 7.03576) QuantErr: 7.03576 batch_time=0.51035 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 2.75396 (QuantReg: 7.02421) QuantErr: 7.02421 batch_time=0.54133 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 2.80463 (QuantReg: 6.82282) QuantErr: 6.82282 batch_time=0.48598 
Train Epoch: 30 codebook_update_time=1.69689
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch30.pth ...
Done in 4.142s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch30.pth ...
Done in 25.188s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 2.462269455909729
 quant_reg      : 6.944073968887329
 quant_err      : 6.944073968887329
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_full_val/t2v_metrics/R1: 23.74245472837022
 MSRVTT_full_val/t2v_metrics/R5: 62.57545271629779
 MSRVTT_full_val/t2v_metrics/R10: 74.04426559356136
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.020120724346077
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.91524166951158
 MSRVTT_full_val/v2t_metrics/R1: 28.169014084507044
 MSRVTT_full_val/v2t_metrics/R5: 63.98390342052314
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.921529175050301
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.56154590318091
 MSRVTT_full_test/t2v_metrics/R1: 10.200668896321071
 MSRVTT_full_test/t2v_metrics/R5: 29.698996655518396
 MSRVTT_full_test/t2v_metrics/R10: 42.97658862876254
 MSRVTT_full_test/t2v_metrics/R50: 77.45819397993311
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.97591973244147
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.52524324446168
 MSRVTT_full_test/v2t_metrics/R1: 9.698996655518394
 MSRVTT_full_test/v2t_metrics/R5: 30.568561872909697
 MSRVTT_full_test/v2t_metrics/R10: 45.4180602006689
 MSRVTT_full_test/v2t_metrics/R50: 78.89632107023411
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.81003344481606
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.790859535688192
 mnt_best       : 23.52524324446168
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 2.62035 (QuantReg: 7.09644) QuantErr: 7.09644 batch_time=32.25380 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 2.61789 (QuantReg: 6.77568) QuantErr: 6.77568 batch_time=0.48814 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 2.62778 (QuantReg: 6.91525) QuantErr: 6.91525 batch_time=0.49445 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 2.35082 (QuantReg: 6.85187) QuantErr: 6.85187 batch_time=0.49832 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 2.59283 (QuantReg: 7.15176) QuantErr: 7.15176 batch_time=0.50248 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 2.58218 (QuantReg: 6.21026) QuantErr: 6.21026 batch_time=0.51727 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 2.44953 (QuantReg: 6.72546) QuantErr: 6.72546 batch_time=0.52276 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 2.54509 (QuantReg: 6.90324) QuantErr: 6.90324 batch_time=0.50922 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 2.40563 (QuantReg: 6.92078) QuantErr: 6.92078 batch_time=0.53931 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 2.38668 (QuantReg: 6.88090) QuantErr: 6.88090 batch_time=0.49661 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 2.39679 (QuantReg: 7.05540) QuantErr: 7.05540 batch_time=0.52127 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 2.25352 (QuantReg: 6.93278) QuantErr: 6.93278 batch_time=0.49928 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 2.39755 (QuantReg: 7.06009) QuantErr: 7.06009 batch_time=0.71121 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 2.86740 (QuantReg: 7.23956) QuantErr: 7.23956 batch_time=0.50523 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 2.34186 (QuantReg: 6.85470) QuantErr: 6.85470 batch_time=0.52040 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 2.45116 (QuantReg: 6.62645) QuantErr: 6.62645 batch_time=0.51957 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 2.74397 (QuantReg: 6.58287) QuantErr: 6.58287 batch_time=0.49836 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 2.45183 (QuantReg: 7.08749) QuantErr: 7.08749 batch_time=0.49536 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 2.37544 (QuantReg: 6.91953) QuantErr: 6.91953 batch_time=1.13516 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 2.62743 (QuantReg: 6.76956) QuantErr: 6.76956 batch_time=0.49725 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 2.45084 (QuantReg: 7.37365) QuantErr: 7.37365 batch_time=0.50987 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 2.34400 (QuantReg: 7.05568) QuantErr: 7.05568 batch_time=0.51467 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 2.45983 (QuantReg: 7.11069) QuantErr: 7.11069 batch_time=0.57071 
Train Epoch: 31 codebook_update_time=1.85636
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch31.pth ...
Done in 4.408s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 2.4741367626190187
 quant_reg      : 6.945409496307373
 quant_err      : 6.945409496307373
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_full_val/t2v_metrics/R1: 26.961770623742456
 MSRVTT_full_val/t2v_metrics/R5: 62.57545271629779
 MSRVTT_full_val/t2v_metrics/R10: 75.65392354124748
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.100603621730382
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.34943738722034
 MSRVTT_full_val/v2t_metrics/R1: 27.364185110663986
 MSRVTT_full_val/v2t_metrics/R5: 64.78873239436619
 MSRVTT_full_val/v2t_metrics/R10: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.92354124748491
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.188352611777745
 MSRVTT_full_test/t2v_metrics/R1: 9.799331103678929
 MSRVTT_full_test/t2v_metrics/R5: 30.0
 MSRVTT_full_test/t2v_metrics/R10: 42.97658862876254
 MSRVTT_full_test/t2v_metrics/R50: 76.92307692307692
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.85133779264214
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.290735785626513
 MSRVTT_full_test/v2t_metrics/R1: 9.464882943143813
 MSRVTT_full_test/v2t_metrics/R5: 29.765886287625417
 MSRVTT_full_test/v2t_metrics/R10: 45.785953177257525
 MSRVTT_full_test/v2t_metrics/R50: 77.9933110367893
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.292809364548496
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.45248004516776
 mnt_best       : 23.52524324446168
 not_improved_count: 1
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 2.38151 (QuantReg: 6.94885) QuantErr: 6.94885 batch_time=36.46270 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 2.51245 (QuantReg: 7.06142) QuantErr: 7.06142 batch_time=0.50116 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 2.32791 (QuantReg: 6.55212) QuantErr: 6.55212 batch_time=0.52881 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 2.41531 (QuantReg: 7.11050) QuantErr: 7.11050 batch_time=0.53441 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 2.28246 (QuantReg: 7.14184) QuantErr: 7.14184 batch_time=0.52428 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 2.43579 (QuantReg: 6.89074) QuantErr: 6.89074 batch_time=0.76091 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 2.13313 (QuantReg: 7.06683) QuantErr: 7.06683 batch_time=0.52097 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 2.51539 (QuantReg: 6.85712) QuantErr: 6.85712 batch_time=0.49343 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 2.56596 (QuantReg: 7.00153) QuantErr: 7.00153 batch_time=0.49231 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 2.48009 (QuantReg: 6.87182) QuantErr: 6.87182 batch_time=0.49670 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 2.40805 (QuantReg: 7.54141) QuantErr: 7.54141 batch_time=0.49233 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 2.20498 (QuantReg: 6.61376) QuantErr: 6.61376 batch_time=0.50004 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 2.57668 (QuantReg: 6.76825) QuantErr: 6.76825 batch_time=1.32570 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 2.51908 (QuantReg: 6.83336) QuantErr: 6.83336 batch_time=0.93222 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 2.25330 (QuantReg: 6.93134) QuantErr: 6.93134 batch_time=0.56195 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 2.50932 (QuantReg: 6.97898) QuantErr: 6.97898 batch_time=0.50726 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 2.68603 (QuantReg: 7.47752) QuantErr: 7.47752 batch_time=0.52401 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 2.48095 (QuantReg: 7.09176) QuantErr: 7.09176 batch_time=0.51856 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 2.45348 (QuantReg: 7.33613) QuantErr: 7.33613 batch_time=0.52433 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 2.82654 (QuantReg: 7.03676) QuantErr: 7.03676 batch_time=0.51066 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 2.39264 (QuantReg: 7.16179) QuantErr: 7.16179 batch_time=0.85712 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 2.49292 (QuantReg: 6.79248) QuantErr: 6.79248 batch_time=1.48911 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 2.22927 (QuantReg: 7.27989) QuantErr: 7.27989 batch_time=0.50043 
Train Epoch: 32 codebook_update_time=1.77592
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch32.pth ...
Done in 3.917s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch32.pth ...
Done in 8.526s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 2.4459622488021853
 quant_reg      : 6.981121126174926
 quant_err      : 6.981121126174926
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.977867203219317
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.14590838175469
 MSRVTT_full_val/v2t_metrics/R1: 25.75452716297787
 MSRVTT_full_val/v2t_metrics/R5: 65.59356136820925
 MSRVTT_full_val/v2t_metrics/R10: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.674044265593562
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.54916662746632
 MSRVTT_full_test/t2v_metrics/R1: 9.866220735785953
 MSRVTT_full_test/t2v_metrics/R5: 30.434782608695652
 MSRVTT_full_test/t2v_metrics/R10: 43.64548494983278
 MSRVTT_full_test/t2v_metrics/R50: 77.6923076923077
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.816722408026756
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.57690453504311
 MSRVTT_full_test/v2t_metrics/R1: 9.498327759197325
 MSRVTT_full_test/v2t_metrics/R5: 30.0
 MSRVTT_full_test/v2t_metrics/R10: 46.52173913043478
 MSRVTT_full_test/v2t_metrics/R50: 79.4648829431438
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.14682274247492
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.66690401165759
 mnt_best       : 23.57690453504311
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 2.40097 (QuantReg: 7.24727) QuantErr: 7.24727 batch_time=39.38130 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 2.45941 (QuantReg: 6.98464) QuantErr: 6.98464 batch_time=0.66962 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 2.59098 (QuantReg: 7.23071) QuantErr: 7.23071 batch_time=0.49151 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 2.21041 (QuantReg: 6.64348) QuantErr: 6.64348 batch_time=0.50246 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 2.39532 (QuantReg: 7.28394) QuantErr: 7.28394 batch_time=1.20665 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 2.49053 (QuantReg: 6.98830) QuantErr: 6.98830 batch_time=0.49155 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 2.63946 (QuantReg: 6.85848) QuantErr: 6.85848 batch_time=0.51558 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 2.35070 (QuantReg: 6.86395) QuantErr: 6.86395 batch_time=0.52049 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 2.59374 (QuantReg: 6.75484) QuantErr: 6.75484 batch_time=0.49496 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 2.51528 (QuantReg: 7.02329) QuantErr: 7.02329 batch_time=0.49989 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 2.58735 (QuantReg: 7.01422) QuantErr: 7.01422 batch_time=0.52677 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 2.39458 (QuantReg: 7.00424) QuantErr: 7.00424 batch_time=0.48712 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 2.78243 (QuantReg: 7.00197) QuantErr: 7.00197 batch_time=0.50192 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 2.42031 (QuantReg: 7.09241) QuantErr: 7.09241 batch_time=1.58563 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 2.30767 (QuantReg: 6.68718) QuantErr: 6.68718 batch_time=0.51577 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 2.51387 (QuantReg: 7.13513) QuantErr: 7.13513 batch_time=0.49587 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 2.35810 (QuantReg: 6.96278) QuantErr: 6.96278 batch_time=0.50753 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 2.48695 (QuantReg: 6.98085) QuantErr: 6.98085 batch_time=0.53237 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 2.45327 (QuantReg: 6.89641) QuantErr: 6.89641 batch_time=0.54242 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 2.40037 (QuantReg: 7.12424) QuantErr: 7.12424 batch_time=0.77900 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 2.63301 (QuantReg: 6.99250) QuantErr: 6.99250 batch_time=0.50339 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 2.30154 (QuantReg: 6.84148) QuantErr: 6.84148 batch_time=0.53388 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 2.50927 (QuantReg: 6.89434) QuantErr: 6.89434 batch_time=0.53641 
Train Epoch: 33 codebook_update_time=1.66535
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch33.pth ...
Done in 4.076s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 2.4405028953552246
 quant_reg      : 6.9847191638946535
 quant_err      : 6.9847191638946535
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_full_val/t2v_metrics/R1: 26.156941649899398
 MSRVTT_full_val/t2v_metrics/R5: 61.77062374245473
 MSRVTT_full_val/t2v_metrics/R10: 73.03822937625755
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.599597585513079
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.05008099711507
 MSRVTT_full_val/v2t_metrics/R1: 27.16297786720322
 MSRVTT_full_val/v2t_metrics/R5: 65.19114688128772
 MSRVTT_full_val/v2t_metrics/R10: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.03420523138833
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.34889115154615
 MSRVTT_full_test/t2v_metrics/R1: 9.464882943143813
 MSRVTT_full_test/t2v_metrics/R5: 29.23076923076923
 MSRVTT_full_test/t2v_metrics/R10: 42.876254180602004
 MSRVTT_full_test/t2v_metrics/R50: 77.29096989966555
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.548160535117056
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.80643705748977
 MSRVTT_full_test/v2t_metrics/R1: 9.096989966555183
 MSRVTT_full_test/v2t_metrics/R5: 29.598662207357858
 MSRVTT_full_test/v2t_metrics/R10: 44.68227424749164
 MSRVTT_full_test/v2t_metrics/R50: 78.8628762541806
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.49414715719063
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.914041182577098
 mnt_best       : 23.57690453504311
 not_improved_count: 1
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 2.60180 (QuantReg: 7.03638) QuantErr: 7.03638 batch_time=34.57441 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 2.48966 (QuantReg: 7.28034) QuantErr: 7.28034 batch_time=0.48781 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 2.42293 (QuantReg: 7.01784) QuantErr: 7.01784 batch_time=0.50206 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 2.61365 (QuantReg: 7.01033) QuantErr: 7.01033 batch_time=0.49720 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 2.57789 (QuantReg: 7.05341) QuantErr: 7.05341 batch_time=0.51605 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 2.66231 (QuantReg: 7.15647) QuantErr: 7.15647 batch_time=0.51064 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 2.43955 (QuantReg: 6.99058) QuantErr: 6.99058 batch_time=1.88365 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 2.65106 (QuantReg: 6.80233) QuantErr: 6.80233 batch_time=0.51383 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 2.56840 (QuantReg: 6.89542) QuantErr: 6.89542 batch_time=0.53366 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 2.70304 (QuantReg: 6.79936) QuantErr: 6.79936 batch_time=0.49301 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 2.41597 (QuantReg: 6.79377) QuantErr: 6.79377 batch_time=0.50274 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 2.43296 (QuantReg: 7.12418) QuantErr: 7.12418 batch_time=0.49630 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 2.51455 (QuantReg: 6.96488) QuantErr: 6.96488 batch_time=0.51250 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 2.56459 (QuantReg: 6.94046) QuantErr: 6.94046 batch_time=0.49365 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 2.62986 (QuantReg: 7.47933) QuantErr: 7.47933 batch_time=0.52404 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 2.55655 (QuantReg: 6.79036) QuantErr: 6.79036 batch_time=0.51368 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 2.25900 (QuantReg: 6.75860) QuantErr: 6.75860 batch_time=0.49698 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 2.57318 (QuantReg: 6.82623) QuantErr: 6.82623 batch_time=0.50327 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 2.30585 (QuantReg: 7.05737) QuantErr: 7.05737 batch_time=6.62559 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 2.52688 (QuantReg: 6.88943) QuantErr: 6.88943 batch_time=0.49379 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 2.32647 (QuantReg: 7.04646) QuantErr: 7.04646 batch_time=0.51597 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 2.38431 (QuantReg: 7.19340) QuantErr: 7.19340 batch_time=0.51145 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 2.65721 (QuantReg: 7.19374) QuantErr: 7.19374 batch_time=0.50034 
Train Epoch: 34 codebook_update_time=1.70373
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch34.pth ...
Done in 4.176s
removing stale ckpt [epoch 33] [took 0.07s]
 epoch          : 34
 loss           : 2.467842707633972
 quant_reg      : 6.984689752578736
 quant_err      : 6.984689752578736
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 72.83702213279678
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.209255533199196
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.18673551277311
 MSRVTT_full_val/v2t_metrics/R1: 25.553319919517104
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.126760563380282
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.808616531252945
 MSRVTT_full_test/t2v_metrics/R1: 9.665551839464882
 MSRVTT_full_test/t2v_metrics/R5: 29.86622073578595
 MSRVTT_full_test/t2v_metrics/R10: 43.27759197324415
 MSRVTT_full_test/t2v_metrics/R50: 76.92307692307692
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.494816053511705
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.20366950042142
 MSRVTT_full_test/v2t_metrics/R1: 9.264214046822742
 MSRVTT_full_test/v2t_metrics/R5: 30.0
 MSRVTT_full_test/v2t_metrics/R10: 45.08361204013378
 MSRVTT_full_test/v2t_metrics/R50: 78.32775919732441
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 54.05752508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.226450558249333
 mnt_best       : 23.57690453504311
 not_improved_count: 2
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 2.42785 (QuantReg: 7.08032) QuantErr: 7.08032 batch_time=36.34462 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 2.59997 (QuantReg: 7.14629) QuantErr: 7.14629 batch_time=1.12767 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 2.47897 (QuantReg: 7.08877) QuantErr: 7.08877 batch_time=0.54740 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 2.56818 (QuantReg: 6.89356) QuantErr: 6.89356 batch_time=0.48632 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 2.51884 (QuantReg: 6.92772) QuantErr: 6.92772 batch_time=0.59026 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 2.35956 (QuantReg: 6.83258) QuantErr: 6.83258 batch_time=0.49601 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 2.41491 (QuantReg: 7.17147) QuantErr: 7.17147 batch_time=0.50184 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 2.80312 (QuantReg: 7.25372) QuantErr: 7.25372 batch_time=0.50555 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 2.37316 (QuantReg: 6.83738) QuantErr: 6.83738 batch_time=0.53791 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 2.57281 (QuantReg: 7.00724) QuantErr: 7.00724 batch_time=0.48945 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 2.43779 (QuantReg: 6.77136) QuantErr: 6.77136 batch_time=0.48957 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 2.39404 (QuantReg: 7.11042) QuantErr: 7.11042 batch_time=0.49734 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 2.67431 (QuantReg: 6.85326) QuantErr: 6.85326 batch_time=0.49043 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 2.39007 (QuantReg: 6.95337) QuantErr: 6.95337 batch_time=0.53674 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 2.26368 (QuantReg: 6.76127) QuantErr: 6.76127 batch_time=0.48447 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 2.64184 (QuantReg: 7.27810) QuantErr: 7.27810 batch_time=0.51737 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 2.59123 (QuantReg: 7.66287) QuantErr: 7.66287 batch_time=0.48981 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 2.33596 (QuantReg: 6.76373) QuantErr: 6.76373 batch_time=0.53685 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 2.41536 (QuantReg: 7.29171) QuantErr: 7.29171 batch_time=7.06288 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 2.41874 (QuantReg: 7.07649) QuantErr: 7.07649 batch_time=0.50213 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 2.49115 (QuantReg: 7.23989) QuantErr: 7.23989 batch_time=0.64464 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 2.50366 (QuantReg: 7.35365) QuantErr: 7.35365 batch_time=0.50483 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 2.32661 (QuantReg: 7.15422) QuantErr: 7.15422 batch_time=0.49276 
Train Epoch: 35 codebook_update_time=1.68272
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch35.pth ...
Done in 4.200s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch35.pth ...
Done in 8.600s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 2.4373973188400266
 quant_reg      : 7.019445053100586
 quant_err      : 7.019445053100586
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_full_val/t2v_metrics/R1: 25.553319919517104
 MSRVTT_full_val/t2v_metrics/R5: 62.97786720321932
 MSRVTT_full_val/t2v_metrics/R10: 74.04426559356136
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.263581488933601
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.208739095339475
 MSRVTT_full_val/v2t_metrics/R1: 26.559356136820927
 MSRVTT_full_val/v2t_metrics/R5: 65.79476861167002
 MSRVTT_full_val/v2t_metrics/R10: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.90543259557344
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.16729965695076
 MSRVTT_full_test/t2v_metrics/R1: 10.100334448160535
 MSRVTT_full_test/t2v_metrics/R5: 30.63545150501672
 MSRVTT_full_test/t2v_metrics/R10: 43.87959866220736
 MSRVTT_full_test/t2v_metrics/R50: 76.78929765886288
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.404849498327756
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.856545802069114
 MSRVTT_full_test/v2t_metrics/R1: 9.163879598662207
 MSRVTT_full_test/v2t_metrics/R5: 29.899665551839465
 MSRVTT_full_test/v2t_metrics/R10: 45.68561872909699
 MSRVTT_full_test/v2t_metrics/R50: 78.99665551839465
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.01304347826087
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.218905215914486
 mnt_best       : 23.856545802069114
 not_improved_count: 0
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 2.39278 (QuantReg: 6.95844) QuantErr: 6.95844 batch_time=34.31322 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 2.59330 (QuantReg: 7.21008) QuantErr: 7.21008 batch_time=0.48824 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 2.11842 (QuantReg: 6.56065) QuantErr: 6.56065 batch_time=0.50697 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 2.35815 (QuantReg: 6.95574) QuantErr: 6.95574 batch_time=0.50453 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 2.42577 (QuantReg: 6.75529) QuantErr: 6.75529 batch_time=0.50740 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 2.18189 (QuantReg: 6.91155) QuantErr: 6.91155 batch_time=0.56958 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 2.37509 (QuantReg: 6.96380) QuantErr: 6.96380 batch_time=0.49753 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 2.68820 (QuantReg: 7.15009) QuantErr: 7.15009 batch_time=0.49769 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 2.43197 (QuantReg: 6.67455) QuantErr: 6.67455 batch_time=0.50624 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 2.37700 (QuantReg: 6.85366) QuantErr: 6.85366 batch_time=0.66242 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 2.59173 (QuantReg: 6.89968) QuantErr: 6.89968 batch_time=0.53788 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 2.73700 (QuantReg: 6.77642) QuantErr: 6.77642 batch_time=0.54767 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 2.30320 (QuantReg: 6.69203) QuantErr: 6.69203 batch_time=0.49402 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 2.60175 (QuantReg: 7.18919) QuantErr: 7.18919 batch_time=0.48260 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 2.24053 (QuantReg: 6.78201) QuantErr: 6.78201 batch_time=0.48800 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 2.63794 (QuantReg: 7.26510) QuantErr: 7.26510 batch_time=0.48921 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 2.61845 (QuantReg: 7.10951) QuantErr: 7.10951 batch_time=0.49454 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 2.27266 (QuantReg: 7.02284) QuantErr: 7.02284 batch_time=0.90808 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 2.30873 (QuantReg: 6.82355) QuantErr: 6.82355 batch_time=0.54261 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 2.54039 (QuantReg: 7.06285) QuantErr: 7.06285 batch_time=3.63144 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 2.57599 (QuantReg: 6.55855) QuantErr: 6.55855 batch_time=0.49844 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 2.54237 (QuantReg: 6.94681) QuantErr: 6.94681 batch_time=0.49911 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 2.21086 (QuantReg: 6.87100) QuantErr: 6.87100 batch_time=0.52412 
Train Epoch: 36 codebook_update_time=1.87956
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch36.pth ...
Done in 4.617s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 2.450351279258728
 quant_reg      : 7.036836259841919
 quant_err      : 7.036836259841919
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_full_val/t2v_metrics/R1: 27.16297786720322
 MSRVTT_full_val/t2v_metrics/R5: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.348088531187123
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.69464573856582
 MSRVTT_full_val/v2t_metrics/R1: 25.75452716297787
 MSRVTT_full_val/v2t_metrics/R5: 63.78269617706238
 MSRVTT_full_val/v2t_metrics/R10: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.925553319919517
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.123533626567315
 MSRVTT_full_test/t2v_metrics/R1: 10.167224080267559
 MSRVTT_full_test/t2v_metrics/R5: 29.765886287625417
 MSRVTT_full_test/t2v_metrics/R10: 42.97658862876254
 MSRVTT_full_test/t2v_metrics/R50: 77.19063545150502
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.302675585284284
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.51713348794834
 MSRVTT_full_test/v2t_metrics/R1: 9.665551839464882
 MSRVTT_full_test/v2t_metrics/R5: 30.434782608695652
 MSRVTT_full_test/v2t_metrics/R10: 46.42140468227425
 MSRVTT_full_test/v2t_metrics/R50: 78.72909698996655
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.11605351170569
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.90222766895757
 mnt_best       : 23.856545802069114
 not_improved_count: 1
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 2.58995 (QuantReg: 6.91983) QuantErr: 6.91983 batch_time=38.45283 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 2.26447 (QuantReg: 7.04959) QuantErr: 7.04959 batch_time=0.49775 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 2.39964 (QuantReg: 6.73712) QuantErr: 6.73712 batch_time=0.50727 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 2.29698 (QuantReg: 7.03590) QuantErr: 7.03590 batch_time=0.50857 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 2.63980 (QuantReg: 7.04477) QuantErr: 7.04477 batch_time=0.50369 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 2.59999 (QuantReg: 6.83067) QuantErr: 6.83067 batch_time=0.51708 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 2.63789 (QuantReg: 7.09046) QuantErr: 7.09046 batch_time=4.75833 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 2.42729 (QuantReg: 7.12571) QuantErr: 7.12571 batch_time=0.52238 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 2.52306 (QuantReg: 7.10602) QuantErr: 7.10602 batch_time=0.49192 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 2.30702 (QuantReg: 6.91169) QuantErr: 6.91169 batch_time=0.49044 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 2.26528 (QuantReg: 6.92200) QuantErr: 6.92200 batch_time=0.49440 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 2.31564 (QuantReg: 7.36540) QuantErr: 7.36540 batch_time=0.52440 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 2.47894 (QuantReg: 6.57626) QuantErr: 6.57626 batch_time=0.48943 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 2.62711 (QuantReg: 6.99364) QuantErr: 6.99364 batch_time=0.50177 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 2.24807 (QuantReg: 6.58156) QuantErr: 6.58156 batch_time=0.50648 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 2.59051 (QuantReg: 7.36732) QuantErr: 7.36732 batch_time=0.49039 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 2.38213 (QuantReg: 6.91527) QuantErr: 6.91527 batch_time=0.59549 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 2.43261 (QuantReg: 7.06095) QuantErr: 7.06095 batch_time=0.49585 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 2.49270 (QuantReg: 6.96811) QuantErr: 6.96811 batch_time=0.52418 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 2.56275 (QuantReg: 7.08077) QuantErr: 7.08077 batch_time=0.53400 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 2.55687 (QuantReg: 7.53367) QuantErr: 7.53367 batch_time=0.51316 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 2.59767 (QuantReg: 6.78117) QuantErr: 6.78117 batch_time=0.50323 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 2.36187 (QuantReg: 6.99817) QuantErr: 6.99817 batch_time=0.76091 
Train Epoch: 37 codebook_update_time=1.64769
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch37.pth ...
Done in 13.307s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 2.4396198015213013
 quant_reg      : 7.014076189041138
 quant_err      : 7.014076189041138
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_full_val/t2v_metrics/R1: 26.961770623742456
 MSRVTT_full_val/t2v_metrics/R5: 61.77062374245473
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.336016096579478
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.684207208680576
 MSRVTT_full_val/v2t_metrics/R1: 27.364185110663986
 MSRVTT_full_val/v2t_metrics/R5: 63.98390342052314
 MSRVTT_full_val/v2t_metrics/R10: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.429577464788732
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.02065982037627
 MSRVTT_full_test/t2v_metrics/R1: 9.765886287625419
 MSRVTT_full_test/t2v_metrics/R5: 29.899665551839465
 MSRVTT_full_test/t2v_metrics/R10: 43.21070234113712
 MSRVTT_full_test/t2v_metrics/R50: 76.95652173913044
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.5819397993311
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.280364350407694
 MSRVTT_full_test/v2t_metrics/R1: 9.264214046822742
 MSRVTT_full_test/v2t_metrics/R5: 29.899665551839465
 MSRVTT_full_test/v2t_metrics/R10: 45.852842809364546
 MSRVTT_full_test/v2t_metrics/R50: 78.36120401337793
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.45986622073578
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.33173629590831
 mnt_best       : 23.856545802069114
 not_improved_count: 2
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 2.54344 (QuantReg: 6.84405) QuantErr: 6.84405 batch_time=35.23142 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 2.61041 (QuantReg: 7.07567) QuantErr: 7.07567 batch_time=0.51673 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 2.20490 (QuantReg: 7.04621) QuantErr: 7.04621 batch_time=0.51433 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 2.48138 (QuantReg: 7.02402) QuantErr: 7.02402 batch_time=0.50683 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 2.38847 (QuantReg: 6.99383) QuantErr: 6.99383 batch_time=0.51118 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 2.68794 (QuantReg: 7.10060) QuantErr: 7.10060 batch_time=0.53891 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 2.36332 (QuantReg: 6.73299) QuantErr: 6.73299 batch_time=3.01901 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 2.27546 (QuantReg: 7.09803) QuantErr: 7.09803 batch_time=0.48763 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 2.26688 (QuantReg: 6.78420) QuantErr: 6.78420 batch_time=1.71972 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 2.46385 (QuantReg: 7.47562) QuantErr: 7.47562 batch_time=0.49445 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 2.43765 (QuantReg: 6.95183) QuantErr: 6.95183 batch_time=0.57096 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 2.57707 (QuantReg: 7.04953) QuantErr: 7.04953 batch_time=0.52252 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 2.42048 (QuantReg: 7.11506) QuantErr: 7.11506 batch_time=0.51970 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 2.44042 (QuantReg: 6.99768) QuantErr: 6.99768 batch_time=1.28295 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 2.36114 (QuantReg: 7.18155) QuantErr: 7.18155 batch_time=0.49941 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 2.48216 (QuantReg: 7.13361) QuantErr: 7.13361 batch_time=0.49481 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 2.54677 (QuantReg: 7.09239) QuantErr: 7.09239 batch_time=0.48811 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 2.14989 (QuantReg: 6.89388) QuantErr: 6.89388 batch_time=0.50460 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 2.43104 (QuantReg: 7.00110) QuantErr: 7.00110 batch_time=0.51942 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 2.33637 (QuantReg: 6.96510) QuantErr: 6.96510 batch_time=0.51507 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 2.43865 (QuantReg: 7.27418) QuantErr: 7.27418 batch_time=0.51327 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 2.55685 (QuantReg: 6.77723) QuantErr: 6.77723 batch_time=0.53266 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 2.46662 (QuantReg: 6.96531) QuantErr: 6.96531 batch_time=0.51085 
Train Epoch: 38 codebook_update_time=1.76933
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch38.pth ...
Done in 4.081s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 2.450084318161011
 quant_reg      : 7.039235279083252
 quant_err      : 7.039235279083252
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.633802816901408
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.788919991632824
 MSRVTT_full_val/v2t_metrics/R1: 26.358148893360163
 MSRVTT_full_val/v2t_metrics/R5: 65.19114688128772
 MSRVTT_full_val/v2t_metrics/R10: 74.64788732394366
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.442655935613683
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.432095796835966
 MSRVTT_full_test/t2v_metrics/R1: 9.899665551839465
 MSRVTT_full_test/t2v_metrics/R5: 30.76923076923077
 MSRVTT_full_test/t2v_metrics/R10: 42.94314381270903
 MSRVTT_full_test/t2v_metrics/R50: 77.1571906354515
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.337458193979934
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.561901298638038
 MSRVTT_full_test/v2t_metrics/R1: 9.832775919732441
 MSRVTT_full_test/v2t_metrics/R5: 31.60535117056856
 MSRVTT_full_test/v2t_metrics/R10: 45.68561872909699
 MSRVTT_full_test/v2t_metrics/R50: 79.03010033444816
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.63394648829431
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.214309609581495
 mnt_best       : 23.856545802069114
 not_improved_count: 3
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 2.46564 (QuantReg: 7.03998) QuantErr: 7.03998 batch_time=46.08640 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 2.49509 (QuantReg: 6.83473) QuantErr: 6.83473 batch_time=0.49187 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 2.23400 (QuantReg: 6.87612) QuantErr: 6.87612 batch_time=0.52452 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 2.59380 (QuantReg: 7.14249) QuantErr: 7.14249 batch_time=0.49023 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 2.25387 (QuantReg: 6.89219) QuantErr: 6.89219 batch_time=0.48842 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 2.47043 (QuantReg: 7.27044) QuantErr: 7.27044 batch_time=0.49490 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 2.33192 (QuantReg: 6.69900) QuantErr: 6.69900 batch_time=0.50793 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 2.39140 (QuantReg: 7.27495) QuantErr: 7.27495 batch_time=0.51233 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 2.21796 (QuantReg: 6.84430) QuantErr: 6.84430 batch_time=0.48948 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 2.26075 (QuantReg: 7.19603) QuantErr: 7.19603 batch_time=0.49180 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 2.22020 (QuantReg: 6.80135) QuantErr: 6.80135 batch_time=0.49468 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 2.30204 (QuantReg: 7.27168) QuantErr: 7.27168 batch_time=0.50092 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 2.49082 (QuantReg: 7.08367) QuantErr: 7.08367 batch_time=0.50049 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 2.47632 (QuantReg: 7.03601) QuantErr: 7.03601 batch_time=0.48880 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 2.20023 (QuantReg: 6.72799) QuantErr: 6.72799 batch_time=0.48914 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 2.32980 (QuantReg: 7.15141) QuantErr: 7.15141 batch_time=0.50796 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 2.39976 (QuantReg: 7.11438) QuantErr: 7.11438 batch_time=0.51611 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 2.37974 (QuantReg: 7.15827) QuantErr: 7.15827 batch_time=0.48802 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 2.38476 (QuantReg: 6.88699) QuantErr: 6.88699 batch_time=0.53173 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 2.35625 (QuantReg: 7.23634) QuantErr: 7.23634 batch_time=0.49132 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 2.35597 (QuantReg: 7.00200) QuantErr: 7.00200 batch_time=0.50138 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 2.39111 (QuantReg: 7.36976) QuantErr: 7.36976 batch_time=0.52568 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 2.20692 (QuantReg: 6.92600) QuantErr: 6.92600 batch_time=0.49536 
Train Epoch: 39 codebook_update_time=2.07973
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch39.pth ...
Done in 4.110s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 2.4251259059906007
 quant_reg      : 7.07992880821228
 quant_err      : 7.07992880821228
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 61.971830985915496
 MSRVTT_full_val/t2v_metrics/R10: 72.03219315895372
 MSRVTT_full_val/t2v_metrics/R50: 95.37223340040241
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.87122736418511
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.75113850582405
 MSRVTT_full_val/v2t_metrics/R1: 26.961770623742456
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.58953722334004
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.7966927258995
 MSRVTT_full_test/t2v_metrics/R1: 9.59866220735786
 MSRVTT_full_test/t2v_metrics/R5: 29.96655518394649
 MSRVTT_full_test/t2v_metrics/R10: 43.11036789297659
 MSRVTT_full_test/t2v_metrics/R50: 76.5886287625418
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.709030100334445
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.146025091868186
 MSRVTT_full_test/v2t_metrics/R1: 9.19732441471572
 MSRVTT_full_test/v2t_metrics/R5: 30.100334448160535
 MSRVTT_full_test/v2t_metrics/R10: 45.25083612040134
 MSRVTT_full_test/v2t_metrics/R50: 78.69565217391305
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.52709030100335
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.224862151301807
 mnt_best       : 23.856545802069114
 not_improved_count: 4
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 2.53702 (QuantReg: 7.32513) QuantErr: 7.32513 batch_time=38.52494 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 2.47469 (QuantReg: 7.19164) QuantErr: 7.19164 batch_time=0.55218 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 2.42892 (QuantReg: 6.99537) QuantErr: 6.99537 batch_time=0.48743 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 2.29261 (QuantReg: 6.71161) QuantErr: 6.71161 batch_time=0.50635 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 2.50535 (QuantReg: 6.97882) QuantErr: 6.97882 batch_time=0.50007 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 2.67011 (QuantReg: 7.04668) QuantErr: 7.04668 batch_time=0.50097 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 2.40681 (QuantReg: 7.28381) QuantErr: 7.28381 batch_time=0.83043 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 2.50148 (QuantReg: 7.31273) QuantErr: 7.31273 batch_time=0.49354 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 2.62698 (QuantReg: 6.90512) QuantErr: 6.90512 batch_time=0.50387 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 2.28192 (QuantReg: 7.03677) QuantErr: 7.03677 batch_time=0.49686 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 2.42784 (QuantReg: 7.23975) QuantErr: 7.23975 batch_time=0.49130 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 2.37665 (QuantReg: 6.94572) QuantErr: 6.94572 batch_time=0.65310 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 2.40630 (QuantReg: 6.95677) QuantErr: 6.95677 batch_time=0.49128 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 2.26480 (QuantReg: 6.89630) QuantErr: 6.89630 batch_time=0.51916 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 2.35301 (QuantReg: 6.98002) QuantErr: 6.98002 batch_time=0.53850 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 2.38972 (QuantReg: 6.84047) QuantErr: 6.84047 batch_time=0.49865 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 2.43707 (QuantReg: 7.02819) QuantErr: 7.02819 batch_time=0.48920 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 2.64102 (QuantReg: 7.16383) QuantErr: 7.16383 batch_time=0.49361 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 2.56125 (QuantReg: 7.14978) QuantErr: 7.14978 batch_time=0.49436 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 2.42027 (QuantReg: 6.99946) QuantErr: 6.99946 batch_time=0.49630 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 2.44857 (QuantReg: 7.44214) QuantErr: 7.44214 batch_time=3.65995 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 2.55335 (QuantReg: 6.93823) QuantErr: 6.93823 batch_time=0.52012 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 2.27178 (QuantReg: 6.62694) QuantErr: 6.62694 batch_time=0.48893 
Train Epoch: 40 codebook_update_time=1.83132
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch40.pth ...
Done in 4.115s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 2.4424701623916625
 quant_reg      : 7.0674177856445315
 quant_err      : 7.0674177856445315
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 61.77062374245473
 MSRVTT_full_val/t2v_metrics/R10: 72.83702213279678
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.53118712273642
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.87902076188503
 MSRVTT_full_val/v2t_metrics/R1: 26.760563380281692
 MSRVTT_full_val/v2t_metrics/R5: 63.98390342052314
 MSRVTT_full_val/v2t_metrics/R10: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.612676056338028
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.776691191045174
 MSRVTT_full_test/t2v_metrics/R1: 10.066889632107024
 MSRVTT_full_test/t2v_metrics/R5: 29.732441471571907
 MSRVTT_full_test/t2v_metrics/R10: 42.80936454849498
 MSRVTT_full_test/t2v_metrics/R50: 76.98996655518394
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.67541806020067
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.400306923398155
 MSRVTT_full_test/v2t_metrics/R1: 9.431438127090301
 MSRVTT_full_test/v2t_metrics/R5: 30.234113712374583
 MSRVTT_full_test/v2t_metrics/R10: 45.11705685618729
 MSRVTT_full_test/v2t_metrics/R50: 78.49498327759197
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.61672240802675
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.431781441162453
 mnt_best       : 23.856545802069114
 not_improved_count: 5
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 2.44720 (QuantReg: 6.78370) QuantErr: 6.78370 batch_time=38.51506 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 2.45160 (QuantReg: 6.98592) QuantErr: 6.98592 batch_time=0.50570 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 2.42415 (QuantReg: 7.11296) QuantErr: 7.11296 batch_time=0.51118 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 2.55788 (QuantReg: 7.33379) QuantErr: 7.33379 batch_time=0.56668 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 2.18359 (QuantReg: 7.13328) QuantErr: 7.13328 batch_time=0.49823 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 2.48140 (QuantReg: 6.68368) QuantErr: 6.68368 batch_time=0.50352 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 2.62717 (QuantReg: 6.95759) QuantErr: 6.95759 batch_time=0.49586 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 2.51462 (QuantReg: 7.07589) QuantErr: 7.07589 batch_time=0.50319 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 2.55104 (QuantReg: 7.30449) QuantErr: 7.30449 batch_time=0.54467 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 2.35738 (QuantReg: 7.25065) QuantErr: 7.25065 batch_time=0.50052 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 2.49651 (QuantReg: 6.95970) QuantErr: 6.95970 batch_time=0.52526 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 2.36803 (QuantReg: 7.05729) QuantErr: 7.05729 batch_time=0.51282 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 2.30697 (QuantReg: 7.04413) QuantErr: 7.04413 batch_time=4.57051 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 2.20736 (QuantReg: 6.90157) QuantErr: 6.90157 batch_time=0.52033 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 2.47037 (QuantReg: 7.10111) QuantErr: 7.10111 batch_time=2.08680 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 2.44061 (QuantReg: 7.18278) QuantErr: 7.18278 batch_time=0.49717 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 2.43963 (QuantReg: 7.04448) QuantErr: 7.04448 batch_time=0.51217 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 2.66117 (QuantReg: 7.17737) QuantErr: 7.17737 batch_time=0.50133 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 2.43612 (QuantReg: 7.01331) QuantErr: 7.01331 batch_time=0.53062 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 2.32537 (QuantReg: 7.31413) QuantErr: 7.31413 batch_time=0.53570 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 2.43729 (QuantReg: 7.15814) QuantErr: 7.15814 batch_time=0.49011 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 2.53450 (QuantReg: 7.06855) QuantErr: 7.06855 batch_time=0.53782 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 2.51436 (QuantReg: 7.18327) QuantErr: 7.18327 batch_time=0.50054 
Train Epoch: 41 codebook_update_time=2.00568
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch41.pth ...
Done in 14.423s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 2.449191619873047
 quant_reg      : 7.119399782180786
 quant_err      : 7.119399782180786
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 61.77062374245473
 MSRVTT_full_val/t2v_metrics/R10: 73.03822937625755
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.591549295774648
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.17552932094599
 MSRVTT_full_val/v2t_metrics/R1: 26.358148893360163
 MSRVTT_full_val/v2t_metrics/R5: 65.3923541247485
 MSRVTT_full_val/v2t_metrics/R10: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.454728370221329
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.75462385514315
 MSRVTT_full_test/t2v_metrics/R1: 9.698996655518394
 MSRVTT_full_test/t2v_metrics/R5: 29.598662207357858
 MSRVTT_full_test/t2v_metrics/R10: 44.214046822742475
 MSRVTT_full_test/t2v_metrics/R50: 77.35785953177258
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.28478260869565
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.326686512970927
 MSRVTT_full_test/v2t_metrics/R1: 9.19732441471572
 MSRVTT_full_test/v2t_metrics/R5: 30.568561872909697
 MSRVTT_full_test/v2t_metrics/R10: 45.88628762541806
 MSRVTT_full_test/v2t_metrics/R50: 79.1638795986622
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.51622073578595
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.45343607958537
 mnt_best       : 23.856545802069114
 not_improved_count: 6
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 2.42439 (QuantReg: 6.82111) QuantErr: 6.82111 batch_time=38.32988 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 2.45036 (QuantReg: 6.79942) QuantErr: 6.79942 batch_time=0.57538 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 2.40963 (QuantReg: 6.90752) QuantErr: 6.90752 batch_time=0.51688 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 2.26846 (QuantReg: 7.14863) QuantErr: 7.14863 batch_time=0.49924 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 2.72261 (QuantReg: 7.54376) QuantErr: 7.54376 batch_time=0.49993 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 2.38030 (QuantReg: 6.94420) QuantErr: 6.94420 batch_time=0.52572 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 2.44223 (QuantReg: 7.46881) QuantErr: 7.46881 batch_time=0.48925 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 2.45751 (QuantReg: 6.84178) QuantErr: 6.84178 batch_time=0.50932 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 2.56098 (QuantReg: 7.10025) QuantErr: 7.10025 batch_time=0.51857 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 2.33796 (QuantReg: 7.18943) QuantErr: 7.18943 batch_time=0.49067 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 2.66995 (QuantReg: 7.26258) QuantErr: 7.26258 batch_time=0.50930 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 2.60019 (QuantReg: 7.51512) QuantErr: 7.51512 batch_time=0.48441 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 2.38705 (QuantReg: 7.15935) QuantErr: 7.15935 batch_time=0.50710 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 2.33682 (QuantReg: 7.10276) QuantErr: 7.10276 batch_time=0.49931 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 2.57985 (QuantReg: 6.92909) QuantErr: 6.92909 batch_time=1.04358 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 2.40411 (QuantReg: 7.23373) QuantErr: 7.23373 batch_time=0.49699 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 2.59826 (QuantReg: 7.25996) QuantErr: 7.25996 batch_time=0.49847 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 2.38019 (QuantReg: 6.74255) QuantErr: 6.74255 batch_time=0.49738 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 2.56350 (QuantReg: 7.15798) QuantErr: 7.15798 batch_time=5.52856 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 2.48554 (QuantReg: 7.11346) QuantErr: 7.11346 batch_time=0.51643 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 2.31490 (QuantReg: 6.98445) QuantErr: 6.98445 batch_time=0.86557 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 2.59525 (QuantReg: 7.24862) QuantErr: 7.24862 batch_time=0.96722 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 2.34421 (QuantReg: 7.17316) QuantErr: 7.17316 batch_time=0.50523 
Train Epoch: 42 codebook_update_time=2.08533
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch42.pth ...
Done in 4.234s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 2.4457254915237425
 quant_reg      : 7.099988561630249
 quant_err      : 7.099988561630249
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 72.63581488933602
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.445674044265594
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.81299945246062
 MSRVTT_full_val/v2t_metrics/R1: 27.56539235412475
 MSRVTT_full_val/v2t_metrics/R5: 65.59356136820925
 MSRVTT_full_val/v2t_metrics/R10: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.09456740442656
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.66178452131544
 MSRVTT_full_test/t2v_metrics/R1: 9.732441471571907
 MSRVTT_full_test/t2v_metrics/R5: 30.63545150501672
 MSRVTT_full_test/t2v_metrics/R10: 43.812709030100336
 MSRVTT_full_test/t2v_metrics/R50: 77.35785953177258
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.20969899665552
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.55132782932177
 MSRVTT_full_test/v2t_metrics/R1: 9.765886287625419
 MSRVTT_full_test/v2t_metrics/R5: 30.80267558528428
 MSRVTT_full_test/v2t_metrics/R10: 46.48829431438127
 MSRVTT_full_test/v2t_metrics/R50: 79.36454849498328
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.457692307692305
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.092465123951026
 mnt_best       : 23.856545802069114
 not_improved_count: 7
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 2.56062 (QuantReg: 7.06688) QuantErr: 7.06688 batch_time=39.72424 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 2.53770 (QuantReg: 7.15876) QuantErr: 7.15876 batch_time=0.50919 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 2.35636 (QuantReg: 6.88788) QuantErr: 6.88788 batch_time=0.50063 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 2.34535 (QuantReg: 7.26869) QuantErr: 7.26869 batch_time=0.50000 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 2.28025 (QuantReg: 7.02434) QuantErr: 7.02434 batch_time=0.51592 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 2.73622 (QuantReg: 7.58752) QuantErr: 7.58752 batch_time=0.50672 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 2.37899 (QuantReg: 6.85834) QuantErr: 6.85834 batch_time=0.49570 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 2.44120 (QuantReg: 7.01402) QuantErr: 7.01402 batch_time=1.70411 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 2.43853 (QuantReg: 7.00756) QuantErr: 7.00756 batch_time=0.52167 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 2.50368 (QuantReg: 7.09485) QuantErr: 7.09485 batch_time=0.54086 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 2.56317 (QuantReg: 7.12717) QuantErr: 7.12717 batch_time=0.49859 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 2.71556 (QuantReg: 6.87863) QuantErr: 6.87863 batch_time=0.49502 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 2.59368 (QuantReg: 7.41928) QuantErr: 7.41928 batch_time=0.56645 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 2.19700 (QuantReg: 7.06290) QuantErr: 7.06290 batch_time=0.55577 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 2.66297 (QuantReg: 7.07184) QuantErr: 7.07184 batch_time=0.55526 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 2.56228 (QuantReg: 7.27112) QuantErr: 7.27112 batch_time=0.50894 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 2.31696 (QuantReg: 6.93954) QuantErr: 6.93954 batch_time=0.50560 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 2.35482 (QuantReg: 7.26633) QuantErr: 7.26633 batch_time=0.49689 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 2.24985 (QuantReg: 7.46444) QuantErr: 7.46444 batch_time=2.40610 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 2.68098 (QuantReg: 7.24434) QuantErr: 7.24434 batch_time=0.99606 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 2.71231 (QuantReg: 7.39711) QuantErr: 7.39711 batch_time=0.53837 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 2.31932 (QuantReg: 7.16370) QuantErr: 7.16370 batch_time=0.62612 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 2.53602 (QuantReg: 7.12086) QuantErr: 7.12086 batch_time=0.74779 
Train Epoch: 43 codebook_update_time=1.65873
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch43.pth ...
Done in 4.130s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 2.438423710823059
 quant_reg      : 7.12722966003418
 quant_err      : 7.12722966003418
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_full_val/t2v_metrics/R1: 27.16297786720322
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 74.24547283702213
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.432595573440643
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.05142914422323
 MSRVTT_full_val/v2t_metrics/R1: 26.156941649899398
 MSRVTT_full_val/v2t_metrics/R5: 65.59356136820925
 MSRVTT_full_val/v2t_metrics/R10: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.267605633802816
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.9000704021092
 MSRVTT_full_test/t2v_metrics/R1: 9.297658862876254
 MSRVTT_full_test/t2v_metrics/R5: 30.267558528428093
 MSRVTT_full_test/t2v_metrics/R10: 44.31438127090301
 MSRVTT_full_test/t2v_metrics/R50: 77.25752508361204
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.532775919732444
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.189883283621835
 MSRVTT_full_test/v2t_metrics/R1: 9.866220735785953
 MSRVTT_full_test/v2t_metrics/R5: 30.234113712374583
 MSRVTT_full_test/v2t_metrics/R10: 46.187290969899664
 MSRVTT_full_test/v2t_metrics/R50: 79.1304347826087
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.93210702341137
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.97306263170237
 mnt_best       : 23.856545802069114
 not_improved_count: 8
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 2.19890 (QuantReg: 7.17688) QuantErr: 7.17688 batch_time=36.31971 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 2.32565 (QuantReg: 7.31744) QuantErr: 7.31744 batch_time=0.51270 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 2.44499 (QuantReg: 7.17371) QuantErr: 7.17371 batch_time=0.53071 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 2.41557 (QuantReg: 6.86531) QuantErr: 6.86531 batch_time=0.51933 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 2.68610 (QuantReg: 7.14810) QuantErr: 7.14810 batch_time=0.56283 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 2.21734 (QuantReg: 6.79627) QuantErr: 6.79627 batch_time=0.51400 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 2.33380 (QuantReg: 7.24687) QuantErr: 7.24687 batch_time=2.83563 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 2.85823 (QuantReg: 7.11978) QuantErr: 7.11978 batch_time=0.51837 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 2.46262 (QuantReg: 7.51375) QuantErr: 7.51375 batch_time=0.50957 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 2.48541 (QuantReg: 6.97792) QuantErr: 6.97792 batch_time=1.25612 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 2.71342 (QuantReg: 7.57980) QuantErr: 7.57980 batch_time=0.50774 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 2.53970 (QuantReg: 7.08439) QuantErr: 7.08439 batch_time=0.49638 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 2.43641 (QuantReg: 7.41167) QuantErr: 7.41167 batch_time=0.49915 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 2.39165 (QuantReg: 7.09733) QuantErr: 7.09733 batch_time=0.49410 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 2.55164 (QuantReg: 7.13227) QuantErr: 7.13227 batch_time=0.51658 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 2.39617 (QuantReg: 7.56131) QuantErr: 7.56131 batch_time=0.50412 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 2.28278 (QuantReg: 6.73519) QuantErr: 6.73519 batch_time=0.50653 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 2.31946 (QuantReg: 6.80241) QuantErr: 6.80241 batch_time=0.52320 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 2.52957 (QuantReg: 6.97008) QuantErr: 6.97008 batch_time=0.49978 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 2.43251 (QuantReg: 7.40067) QuantErr: 7.40067 batch_time=0.51822 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 2.41851 (QuantReg: 7.08749) QuantErr: 7.08749 batch_time=0.58684 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 2.09211 (QuantReg: 6.92707) QuantErr: 6.92707 batch_time=0.51318 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 2.30708 (QuantReg: 7.21910) QuantErr: 7.21910 batch_time=0.50958 
Train Epoch: 44 codebook_update_time=1.67717
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch44.pth ...
Done in 4.067s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 2.4578868923187254
 quant_reg      : 7.14193058013916
 quant_err      : 7.14193058013916
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_full_val/t2v_metrics/R1: 26.961770623742456
 MSRVTT_full_val/t2v_metrics/R5: 61.971830985915496
 MSRVTT_full_val/t2v_metrics/R10: 73.44064386317908
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.247484909456741
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.6927545477255
 MSRVTT_full_val/v2t_metrics/R1: 27.16297786720322
 MSRVTT_full_val/v2t_metrics/R5: 65.59356136820925
 MSRVTT_full_val/v2t_metrics/R10: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.112676056338028
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.54444349639894
 MSRVTT_full_test/t2v_metrics/R1: 9.431438127090301
 MSRVTT_full_test/t2v_metrics/R5: 30.066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 43.17725752508361
 MSRVTT_full_test/t2v_metrics/R50: 77.32441471571906
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.48210702341137
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.04838461071479
 MSRVTT_full_test/v2t_metrics/R1: 9.264214046822742
 MSRVTT_full_test/v2t_metrics/R5: 29.86622073578595
 MSRVTT_full_test/v2t_metrics/R10: 45.88628762541806
 MSRVTT_full_test/v2t_metrics/R50: 79.06354515050167
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.68361204013378
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.32870285741958
 mnt_best       : 23.856545802069114
 not_improved_count: 9
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 2.42402 (QuantReg: 6.94328) QuantErr: 6.94328 batch_time=36.04825 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 2.57030 (QuantReg: 7.40747) QuantErr: 7.40747 batch_time=0.51792 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 2.56139 (QuantReg: 7.38367) QuantErr: 7.38367 batch_time=0.48477 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 2.21498 (QuantReg: 7.05046) QuantErr: 7.05046 batch_time=0.50540 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 2.49436 (QuantReg: 6.99426) QuantErr: 6.99426 batch_time=0.52316 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 2.09768 (QuantReg: 6.81411) QuantErr: 6.81411 batch_time=0.59122 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 2.46866 (QuantReg: 6.88561) QuantErr: 6.88561 batch_time=0.51556 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 2.84030 (QuantReg: 7.07591) QuantErr: 7.07591 batch_time=1.88359 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 2.47993 (QuantReg: 7.21093) QuantErr: 7.21093 batch_time=0.48721 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 2.21352 (QuantReg: 6.95395) QuantErr: 6.95395 batch_time=0.49158 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 2.55309 (QuantReg: 7.28237) QuantErr: 7.28237 batch_time=0.50393 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 2.40571 (QuantReg: 6.78166) QuantErr: 6.78166 batch_time=0.52406 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 2.37918 (QuantReg: 6.97840) QuantErr: 6.97840 batch_time=0.54199 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 2.53846 (QuantReg: 7.15638) QuantErr: 7.15638 batch_time=0.49243 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 2.53454 (QuantReg: 7.27373) QuantErr: 7.27373 batch_time=0.73114 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 2.24911 (QuantReg: 6.85110) QuantErr: 6.85110 batch_time=0.48633 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 2.45462 (QuantReg: 7.13693) QuantErr: 7.13693 batch_time=0.49444 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 2.44098 (QuantReg: 7.49636) QuantErr: 7.49636 batch_time=0.49216 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 2.29949 (QuantReg: 7.16901) QuantErr: 7.16901 batch_time=0.59514 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 2.46395 (QuantReg: 7.14603) QuantErr: 7.14603 batch_time=3.87281 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 2.49564 (QuantReg: 6.91444) QuantErr: 6.91444 batch_time=0.64487 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 2.22951 (QuantReg: 7.16465) QuantErr: 7.16465 batch_time=0.50614 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 2.46263 (QuantReg: 6.79289) QuantErr: 6.79289 batch_time=0.56629 
Train Epoch: 45 codebook_update_time=1.66263
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch45.pth ...
Done in 5.813s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 2.4429551696777345
 quant_reg      : 7.14672596168518
 quant_err      : 7.14672596168518
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_full_val/t2v_metrics/R1: 26.559356136820927
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 73.44064386317908
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.080482897384305
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.33703186875848
 MSRVTT_full_val/v2t_metrics/R1: 26.760563380281692
 MSRVTT_full_val/v2t_metrics/R5: 66.19718309859155
 MSRVTT_full_val/v2t_metrics/R10: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.832997987927566
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.220039333481694
 MSRVTT_full_test/t2v_metrics/R1: 9.063545150501673
 MSRVTT_full_test/t2v_metrics/R5: 30.735785953177256
 MSRVTT_full_test/t2v_metrics/R10: 44.147157190635454
 MSRVTT_full_test/t2v_metrics/R50: 77.75919732441471
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.507023411371236
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.08244039823008
 MSRVTT_full_test/v2t_metrics/R1: 9.397993311036789
 MSRVTT_full_test/v2t_metrics/R5: 30.16722408026756
 MSRVTT_full_test/v2t_metrics/R10: 46.12040133779264
 MSRVTT_full_test/v2t_metrics/R50: 79.06354515050167
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.00752508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.558873463515354
 mnt_best       : 23.856545802069114
 not_improved_count: 10
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 2.38707 (QuantReg: 6.95844) QuantErr: 6.95844 batch_time=40.09196 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 2.42375 (QuantReg: 7.24983) QuantErr: 7.24983 batch_time=0.55031 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 2.17908 (QuantReg: 7.09468) QuantErr: 7.09468 batch_time=0.50133 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 2.32593 (QuantReg: 7.10846) QuantErr: 7.10846 batch_time=0.50853 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 2.57249 (QuantReg: 7.43075) QuantErr: 7.43075 batch_time=0.49718 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 2.18474 (QuantReg: 6.84748) QuantErr: 6.84748 batch_time=0.50398 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 2.47500 (QuantReg: 7.15790) QuantErr: 7.15790 batch_time=0.54557 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 2.47102 (QuantReg: 7.29536) QuantErr: 7.29536 batch_time=0.50851 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 2.45679 (QuantReg: 7.16216) QuantErr: 7.16216 batch_time=0.51956 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 2.40177 (QuantReg: 7.00443) QuantErr: 7.00443 batch_time=0.49848 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 2.22520 (QuantReg: 6.85033) QuantErr: 6.85033 batch_time=0.59592 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 2.34295 (QuantReg: 7.04908) QuantErr: 7.04908 batch_time=0.49924 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 2.70483 (QuantReg: 6.94285) QuantErr: 6.94285 batch_time=0.48823 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 2.38058 (QuantReg: 7.07033) QuantErr: 7.07033 batch_time=0.72117 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 2.46259 (QuantReg: 7.34406) QuantErr: 7.34406 batch_time=0.50140 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 2.41766 (QuantReg: 7.46093) QuantErr: 7.46093 batch_time=0.52821 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 2.50774 (QuantReg: 7.13851) QuantErr: 7.13851 batch_time=0.52190 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 2.32577 (QuantReg: 7.13045) QuantErr: 7.13045 batch_time=0.50826 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 2.43689 (QuantReg: 7.24756) QuantErr: 7.24756 batch_time=0.48737 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 2.37905 (QuantReg: 7.64978) QuantErr: 7.64978 batch_time=0.50188 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 2.25347 (QuantReg: 7.06561) QuantErr: 7.06561 batch_time=0.48917 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 2.34207 (QuantReg: 7.25229) QuantErr: 7.25229 batch_time=0.52235 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 2.38908 (QuantReg: 6.96221) QuantErr: 6.96221 batch_time=0.50965 
Train Epoch: 46 codebook_update_time=2.09897
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch46.pth ...
Done in 4.374s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 2.447876389503479
 quant_reg      : 7.144171855926514
 quant_err      : 7.144171855926514
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_full_val/t2v_metrics/R1: 25.35211267605634
 MSRVTT_full_val/t2v_metrics/R5: 61.971830985915496
 MSRVTT_full_val/t2v_metrics/R10: 73.44064386317908
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.774647887323944
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.68348429547248
 MSRVTT_full_val/v2t_metrics/R1: 26.760563380281692
 MSRVTT_full_val/v2t_metrics/R5: 65.19114688128772
 MSRVTT_full_val/v2t_metrics/R10: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.596579476861168
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.0491950318897
 MSRVTT_full_test/t2v_metrics/R1: 9.431438127090301
 MSRVTT_full_test/t2v_metrics/R5: 30.568561872909697
 MSRVTT_full_test/t2v_metrics/R10: 43.37792642140468
 MSRVTT_full_test/t2v_metrics/R50: 77.02341137123746
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.71170568561873
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.211715473177254
 MSRVTT_full_test/v2t_metrics/R1: 9.531772575250836
 MSRVTT_full_test/v2t_metrics/R5: 30.60200668896321
 MSRVTT_full_test/v2t_metrics/R10: 45.68561872909699
 MSRVTT_full_test/v2t_metrics/R50: 78.82943143812709
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.984448160535116
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.708333595309067
 mnt_best       : 23.856545802069114
 not_improved_count: 11
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 2.38152 (QuantReg: 7.51247) QuantErr: 7.51247 batch_time=35.47790 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 2.47936 (QuantReg: 7.06297) QuantErr: 7.06297 batch_time=1.16348 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 2.43179 (QuantReg: 7.03242) QuantErr: 7.03242 batch_time=0.50441 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 2.33426 (QuantReg: 6.95191) QuantErr: 6.95191 batch_time=0.50400 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 2.52037 (QuantReg: 7.26384) QuantErr: 7.26384 batch_time=0.52914 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 2.18048 (QuantReg: 7.09506) QuantErr: 7.09506 batch_time=0.52170 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 2.60128 (QuantReg: 7.00725) QuantErr: 7.00725 batch_time=0.53292 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 2.25666 (QuantReg: 6.68222) QuantErr: 6.68222 batch_time=3.04676 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 2.35005 (QuantReg: 7.48473) QuantErr: 7.48473 batch_time=0.49793 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 2.28076 (QuantReg: 7.30806) QuantErr: 7.30806 batch_time=0.51733 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 2.64038 (QuantReg: 6.78443) QuantErr: 6.78443 batch_time=0.50421 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 2.36610 (QuantReg: 7.10531) QuantErr: 7.10531 batch_time=0.50587 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 2.62057 (QuantReg: 7.45689) QuantErr: 7.45689 batch_time=0.53676 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 2.49390 (QuantReg: 7.10112) QuantErr: 7.10112 batch_time=0.51317 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 2.46688 (QuantReg: 7.21903) QuantErr: 7.21903 batch_time=0.69240 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 2.41077 (QuantReg: 7.27712) QuantErr: 7.27712 batch_time=0.49360 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 2.79935 (QuantReg: 7.06402) QuantErr: 7.06402 batch_time=0.50498 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 2.33951 (QuantReg: 7.33730) QuantErr: 7.33730 batch_time=0.48719 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 2.51600 (QuantReg: 7.09733) QuantErr: 7.09733 batch_time=0.49415 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 2.45309 (QuantReg: 7.22383) QuantErr: 7.22383 batch_time=0.49261 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 2.61762 (QuantReg: 6.90970) QuantErr: 6.90970 batch_time=0.49070 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 2.32031 (QuantReg: 7.15214) QuantErr: 7.15214 batch_time=0.49260 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 2.49548 (QuantReg: 7.25081) QuantErr: 7.25081 batch_time=0.48620 
Train Epoch: 47 codebook_update_time=1.88762
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch47.pth ...
Done in 4.583s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 2.459194887161255
 quant_reg      : 7.148982404708862
 quant_err      : 7.148982404708862
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_full_val/t2v_metrics/R1: 25.150905432595575
 MSRVTT_full_val/t2v_metrics/R5: 61.971830985915496
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.434607645875252
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.64287203409301
 MSRVTT_full_val/v2t_metrics/R1: 27.364185110663986
 MSRVTT_full_val/v2t_metrics/R5: 64.1851106639839
 MSRVTT_full_val/v2t_metrics/R10: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.253521126760564
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.25408289592743
 MSRVTT_full_test/t2v_metrics/R1: 9.966555183946488
 MSRVTT_full_test/t2v_metrics/R5: 30.903010033444815
 MSRVTT_full_test/t2v_metrics/R10: 44.046822742474916
 MSRVTT_full_test/t2v_metrics/R50: 77.49163879598662
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.69899665551839
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.84991387539981
 MSRVTT_full_test/v2t_metrics/R1: 9.163879598662207
 MSRVTT_full_test/v2t_metrics/R5: 30.13377926421405
 MSRVTT_full_test/v2t_metrics/R10: 45.819397993311036
 MSRVTT_full_test/v2t_metrics/R50: 79.23076923076923
 MSRVTT_full_test/v2t_metrics/MedR: 12.75
 MSRVTT_full_test/v2t_metrics/MeanR: 52.23595317725753
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.30204940212087
 mnt_best       : 23.856545802069114
 not_improved_count: 12
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 2.56983 (QuantReg: 6.82501) QuantErr: 6.82501 batch_time=37.99219 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 2.45948 (QuantReg: 7.31325) QuantErr: 7.31325 batch_time=0.51684 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 2.43721 (QuantReg: 7.11876) QuantErr: 7.11876 batch_time=0.52696 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 2.31710 (QuantReg: 7.11992) QuantErr: 7.11992 batch_time=0.52798 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 2.41880 (QuantReg: 7.04780) QuantErr: 7.04780 batch_time=0.51129 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 2.45629 (QuantReg: 7.32592) QuantErr: 7.32592 batch_time=0.54995 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 2.55160 (QuantReg: 7.30582) QuantErr: 7.30582 batch_time=0.51724 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 2.40060 (QuantReg: 6.78958) QuantErr: 6.78958 batch_time=0.53133 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 2.44005 (QuantReg: 7.22544) QuantErr: 7.22544 batch_time=0.50134 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 2.23526 (QuantReg: 7.34177) QuantErr: 7.34177 batch_time=0.51342 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 2.32347 (QuantReg: 7.40576) QuantErr: 7.40576 batch_time=0.49652 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 2.64887 (QuantReg: 7.20373) QuantErr: 7.20373 batch_time=0.49429 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 2.38741 (QuantReg: 7.25881) QuantErr: 7.25881 batch_time=0.49714 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 2.37060 (QuantReg: 7.13008) QuantErr: 7.13008 batch_time=3.96551 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 2.47870 (QuantReg: 7.34234) QuantErr: 7.34234 batch_time=0.50323 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 2.45699 (QuantReg: 7.00605) QuantErr: 7.00605 batch_time=0.50656 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 2.34224 (QuantReg: 7.43465) QuantErr: 7.43465 batch_time=0.59950 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 2.67065 (QuantReg: 7.33258) QuantErr: 7.33258 batch_time=0.49843 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 2.49283 (QuantReg: 7.27206) QuantErr: 7.27206 batch_time=0.79399 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 2.62014 (QuantReg: 7.31494) QuantErr: 7.31494 batch_time=0.49652 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 2.35531 (QuantReg: 6.97758) QuantErr: 6.97758 batch_time=0.49788 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 2.64005 (QuantReg: 7.35763) QuantErr: 7.35763 batch_time=0.49120 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 2.69320 (QuantReg: 7.06259) QuantErr: 7.06259 batch_time=0.48945 
Train Epoch: 48 codebook_update_time=1.77496
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch48.pth ...
Done in 3.875s
removing stale ckpt [epoch 47] [took 0.13s]
 epoch          : 48
 loss           : 2.4724454069137574
 quant_reg      : 7.172927131652832
 quant_err      : 7.172927131652832
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 61.16700201207244
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.617706237424548
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.81577071393203
 MSRVTT_full_val/v2t_metrics/R1: 27.56539235412475
 MSRVTT_full_val/v2t_metrics/R5: 65.19114688128772
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.75553319919517
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.51053615633438
 MSRVTT_full_test/t2v_metrics/R1: 9.59866220735786
 MSRVTT_full_test/t2v_metrics/R5: 30.13377926421405
 MSRVTT_full_test/t2v_metrics/R10: 44.11371237458194
 MSRVTT_full_test/t2v_metrics/R50: 77.45819397993311
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.70284280936455
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.367520880206794
 MSRVTT_full_test/v2t_metrics/R1: 9.765886287625419
 MSRVTT_full_test/v2t_metrics/R5: 30.434782608695652
 MSRVTT_full_test/v2t_metrics/R10: 45.785953177257525
 MSRVTT_full_test/v2t_metrics/R50: 79.03010033444816
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.569397993311036
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.874706552406256
 mnt_best       : 23.856545802069114
 not_improved_count: 13
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 2.29024 (QuantReg: 6.93490) QuantErr: 6.93490 batch_time=39.01778 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 2.40050 (QuantReg: 7.12978) QuantErr: 7.12978 batch_time=0.51965 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 2.34181 (QuantReg: 7.11787) QuantErr: 7.11787 batch_time=0.52075 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 2.54872 (QuantReg: 7.28314) QuantErr: 7.28314 batch_time=0.50334 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 2.33753 (QuantReg: 7.27025) QuantErr: 7.27025 batch_time=0.51016 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 2.73687 (QuantReg: 7.38213) QuantErr: 7.38213 batch_time=0.54818 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 2.54208 (QuantReg: 7.35000) QuantErr: 7.35000 batch_time=1.21790 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 2.45323 (QuantReg: 7.20170) QuantErr: 7.20170 batch_time=0.51160 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 2.54202 (QuantReg: 7.18021) QuantErr: 7.18021 batch_time=0.50508 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 2.26689 (QuantReg: 7.01914) QuantErr: 7.01914 batch_time=0.49933 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 2.41081 (QuantReg: 7.49755) QuantErr: 7.49755 batch_time=0.50187 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 2.46514 (QuantReg: 7.02013) QuantErr: 7.02013 batch_time=0.49079 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 2.54690 (QuantReg: 6.90335) QuantErr: 6.90335 batch_time=0.51938 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 2.33166 (QuantReg: 7.15644) QuantErr: 7.15644 batch_time=2.82078 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 2.45772 (QuantReg: 7.29043) QuantErr: 7.29043 batch_time=0.49685 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 2.43969 (QuantReg: 7.24781) QuantErr: 7.24781 batch_time=0.71053 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 2.41443 (QuantReg: 7.16214) QuantErr: 7.16214 batch_time=0.49509 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 2.40858 (QuantReg: 7.15023) QuantErr: 7.15023 batch_time=0.64377 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 2.50650 (QuantReg: 7.37906) QuantErr: 7.37906 batch_time=0.76016 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 2.59930 (QuantReg: 7.24637) QuantErr: 7.24637 batch_time=2.08807 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 2.36338 (QuantReg: 7.10901) QuantErr: 7.10901 batch_time=0.58522 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 2.19974 (QuantReg: 7.18670) QuantErr: 7.18670 batch_time=0.49620 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 2.30012 (QuantReg: 7.06410) QuantErr: 7.06410 batch_time=0.50369 
Train Epoch: 49 codebook_update_time=1.86026
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch49.pth ...
Done in 4.226s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 2.4601160087585447
 quant_reg      : 7.171258207321167
 quant_err      : 7.171258207321167
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.587525150905433
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.417476539093705
 MSRVTT_full_val/v2t_metrics/R1: 26.760563380281692
 MSRVTT_full_val/v2t_metrics/R5: 65.3923541247485
 MSRVTT_full_val/v2t_metrics/R10: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.535211267605634
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.146565661395734
 MSRVTT_full_test/t2v_metrics/R1: 10.167224080267559
 MSRVTT_full_test/t2v_metrics/R5: 30.100334448160535
 MSRVTT_full_test/t2v_metrics/R10: 43.57859531772575
 MSRVTT_full_test/t2v_metrics/R50: 77.45819397993311
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.732608695652175
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.714591494278675
 MSRVTT_full_test/v2t_metrics/R1: 9.59866220735786
 MSRVTT_full_test/v2t_metrics/R5: 30.367892976588628
 MSRVTT_full_test/v2t_metrics/R10: 46.12040133779264
 MSRVTT_full_test/v2t_metrics/R50: 79.1304347826087
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.93177257525084
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.77786272726964
 mnt_best       : 23.856545802069114
 not_improved_count: 14
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 2.44529 (QuantReg: 7.18474) QuantErr: 7.18474 batch_time=45.12148 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 2.35673 (QuantReg: 7.17846) QuantErr: 7.17846 batch_time=1.59588 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 2.49887 (QuantReg: 7.27926) QuantErr: 7.27926 batch_time=0.49615 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 2.48765 (QuantReg: 7.35953) QuantErr: 7.35953 batch_time=0.47815 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 2.56544 (QuantReg: 7.34803) QuantErr: 7.34803 batch_time=0.55573 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 2.57135 (QuantReg: 7.50414) QuantErr: 7.50414 batch_time=0.49500 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 2.33446 (QuantReg: 7.25778) QuantErr: 7.25778 batch_time=0.49482 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 2.60250 (QuantReg: 7.19728) QuantErr: 7.19728 batch_time=0.52780 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 2.48850 (QuantReg: 7.07600) QuantErr: 7.07600 batch_time=0.49400 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 2.25058 (QuantReg: 7.16287) QuantErr: 7.16287 batch_time=0.51585 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 2.44229 (QuantReg: 7.28823) QuantErr: 7.28823 batch_time=0.49757 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 2.79736 (QuantReg: 7.70400) QuantErr: 7.70400 batch_time=0.53576 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 2.61257 (QuantReg: 7.04368) QuantErr: 7.04368 batch_time=0.49482 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 2.38155 (QuantReg: 6.91530) QuantErr: 6.91530 batch_time=0.54674 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 2.60838 (QuantReg: 6.99464) QuantErr: 6.99464 batch_time=0.49741 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 2.30091 (QuantReg: 7.55765) QuantErr: 7.55765 batch_time=0.80941 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 2.66644 (QuantReg: 7.24898) QuantErr: 7.24898 batch_time=0.50552 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 2.79701 (QuantReg: 7.19501) QuantErr: 7.19501 batch_time=0.50178 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 2.29990 (QuantReg: 7.59090) QuantErr: 7.59090 batch_time=0.52413 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 2.51660 (QuantReg: 7.36392) QuantErr: 7.36392 batch_time=0.68703 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 2.36586 (QuantReg: 7.00013) QuantErr: 7.00013 batch_time=0.48592 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 2.46906 (QuantReg: 7.21244) QuantErr: 7.21244 batch_time=0.58732 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 2.41738 (QuantReg: 7.42909) QuantErr: 7.42909 batch_time=0.49972 
Train Epoch: 50 codebook_update_time=1.64956
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/checkpoint-epoch50.pth ...
Done in 21.945s
removing stale ckpt [epoch 49] [took 0.03s]
 epoch          : 50
 loss           : 2.468842608451843
 quant_reg      : 7.220307678222656
 quant_err      : 7.220307678222656
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 62.776659959758554
 MSRVTT_full_val/t2v_metrics/R10: 74.64788732394366
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.304828973843058
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.418523885020456
 MSRVTT_full_val/v2t_metrics/R1: 25.35211267605634
 MSRVTT_full_val/v2t_metrics/R5: 65.19114688128772
 MSRVTT_full_val/v2t_metrics/R10: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.378269617706238
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.96039756022149
 MSRVTT_full_test/t2v_metrics/R1: 9.464882943143813
 MSRVTT_full_test/t2v_metrics/R5: 30.535117056856187
 MSRVTT_full_test/t2v_metrics/R10: 44.247491638795985
 MSRVTT_full_test/t2v_metrics/R50: 77.6923076923077
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.341973244147155
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.3848450953865
 MSRVTT_full_test/v2t_metrics/R1: 9.966555183946488
 MSRVTT_full_test/v2t_metrics/R5: 30.63545150501672
 MSRVTT_full_test/v2t_metrics/R10: 45.28428093645485
 MSRVTT_full_test/v2t_metrics/R50: 78.69565217391305
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 54.49464882943144
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.001531028176217
 mnt_best       : 23.856545802069114
 not_improved_count: 15
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/trained_model.pth ...
Ckpt loaded at epoch 35.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 10.100334448160535
 t2v_metrics/R5/final_eval: 30.63545150501672
 t2v_metrics/R10/final_eval: 43.87959866220736
 t2v_metrics/R50/final_eval: 76.78929765886288
 t2v_metrics/MedR/final_eval: 14.0
 t2v_metrics/MeanR/final_eval: 55.40501672240803
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 23.856545802069114
 v2t_metrics/R1/final_eval: 9.163879598662207
 v2t_metrics/R5/final_eval: 29.899665551839465
 v2t_metrics/R10/final_eval: 45.68561872909699
 v2t_metrics/R50/final_eval: 78.99665551839465
 v2t_metrics/MedR/final_eval: 13.0
 v2t_metrics/MeanR/final_eval: 53.012876254180604
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 23.218905215914486
Best epoch for the monitored metric: 35
Script took 04h31m53s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.15/trained_model.pth
