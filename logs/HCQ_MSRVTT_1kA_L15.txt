Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 1274.2771649360657 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 73.81234693527222 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 48.862210512161255 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch0.pth ...
Done in 1.549s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch0.pth ...
Done in 3.041s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 1.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 5.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 508.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 498.491
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.3914867641168864
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 491.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 492.881
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 mnt_best       : 0.3914867641168864
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 30.37422 (QuantReg: 22.44950) QuantErr: 22.44950 batch_time=17.04816 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 27.58488 (QuantReg: 22.62272) QuantErr: 22.62272 batch_time=0.64545 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 23.98049 (QuantReg: 22.62040) QuantErr: 22.62040 batch_time=0.69534 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 21.62486 (QuantReg: 22.61346) QuantErr: 22.61346 batch_time=0.63211 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 21.55148 (QuantReg: 22.60448) QuantErr: 22.60448 batch_time=0.66409 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 18.09508 (QuantReg: 22.66546) QuantErr: 22.66546 batch_time=0.67484 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 19.37546 (QuantReg: 22.64121) QuantErr: 22.64121 batch_time=1.83118 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 17.13990 (QuantReg: 22.65406) QuantErr: 22.65406 batch_time=0.69267 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 17.77531 (QuantReg: 22.65351) QuantErr: 22.65351 batch_time=0.66193 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 15.87346 (QuantReg: 22.64672) QuantErr: 22.64672 batch_time=0.68057 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 14.88769 (QuantReg: 22.62619) QuantErr: 22.62619 batch_time=0.71213 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 14.97726 (QuantReg: 22.62910) QuantErr: 22.62910 batch_time=0.65167 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 14.47709 (QuantReg: 22.65334) QuantErr: 22.65334 batch_time=0.73481 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 15.76533 (QuantReg: 22.61733) QuantErr: 22.61733 batch_time=5.02873 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 13.68880 (QuantReg: 22.65315) QuantErr: 22.65315 batch_time=0.65491 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 14.64779 (QuantReg: 22.65578) QuantErr: 22.65578 batch_time=0.65680 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 13.40636 (QuantReg: 22.65479) QuantErr: 22.65479 batch_time=0.67313 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 15.18630 (QuantReg: 22.61470) QuantErr: 22.61470 batch_time=0.65850 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 13.95435 (QuantReg: 22.61641) QuantErr: 22.61641 batch_time=0.65958 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 13.12395 (QuantReg: 22.65346) QuantErr: 22.65346 batch_time=0.69609 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 13.59403 (QuantReg: 22.66649) QuantErr: 22.66649 batch_time=0.73776 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 13.14003 (QuantReg: 22.66279) QuantErr: 22.66279 batch_time=0.64722 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 12.27474 (QuantReg: 22.65307) QuantErr: 22.65307 batch_time=0.63977 
Train Epoch: 1 codebook_update_time=4.09348
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch1.pth ...
Done in 4.273s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch1.pth ...
Done in 8.165s
 epoch          : 1
 loss           : 17.089199127197265
 quant_reg      : 22.632978706359864
 quant_err      : 22.632978706359864
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 8.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 30.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 43.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 79.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 42.746
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.732806555982336
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 33.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 45.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 13.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 42.137
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.00925213129053
 mnt_best       : 22.732806555982336
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 13.15432 (QuantReg: 10.78074) QuantErr: 10.78074 batch_time=24.72859 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 11.12010 (QuantReg: 11.33028) QuantErr: 11.33028 batch_time=0.66315 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 12.48949 (QuantReg: 11.65358) QuantErr: 11.65358 batch_time=0.66809 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 13.07328 (QuantReg: 11.56365) QuantErr: 11.56365 batch_time=0.68514 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 12.80890 (QuantReg: 11.72416) QuantErr: 11.72416 batch_time=0.65689 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 12.12450 (QuantReg: 12.01840) QuantErr: 12.01840 batch_time=0.66067 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 11.09352 (QuantReg: 12.30861) QuantErr: 12.30861 batch_time=0.63562 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 12.20181 (QuantReg: 12.46158) QuantErr: 12.46158 batch_time=0.67232 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 12.19430 (QuantReg: 12.06218) QuantErr: 12.06218 batch_time=0.64727 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 11.93229 (QuantReg: 12.83361) QuantErr: 12.83361 batch_time=0.68733 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 10.35144 (QuantReg: 12.79028) QuantErr: 12.79028 batch_time=0.65232 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 10.81004 (QuantReg: 12.81147) QuantErr: 12.81147 batch_time=0.67300 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 13.11696 (QuantReg: 12.90938) QuantErr: 12.90938 batch_time=0.65284 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 11.43150 (QuantReg: 13.38324) QuantErr: 13.38324 batch_time=0.65364 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 10.47077 (QuantReg: 13.30187) QuantErr: 13.30187 batch_time=0.66440 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 11.94102 (QuantReg: 13.27518) QuantErr: 13.27518 batch_time=0.66307 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 11.87576 (QuantReg: 13.61311) QuantErr: 13.61311 batch_time=0.65057 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 12.76748 (QuantReg: 13.77293) QuantErr: 13.77293 batch_time=0.68189 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 10.63342 (QuantReg: 13.81152) QuantErr: 13.81152 batch_time=0.69821 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 12.01902 (QuantReg: 14.32555) QuantErr: 14.32555 batch_time=0.67386 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 10.54431 (QuantReg: 14.14965) QuantErr: 14.14965 batch_time=0.66428 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 10.83452 (QuantReg: 14.53295) QuantErr: 14.53295 batch_time=0.65798 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 12.51244 (QuantReg: 14.10012) QuantErr: 14.10012 batch_time=0.64673 
Train Epoch: 2 codebook_update_time=3.40157
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch2.pth ...
Done in 11.766s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch2.pth ...
Done in 15.597s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.04s]
 epoch          : 2
 loss           : 11.752204376220703
 quant_reg      : 12.8765330619812
 quant_err      : 12.8765330619812
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 37.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 33.411
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.886899950730633
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 39.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 53.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.585
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.673130844107945
 mnt_best       : 28.886899950730633
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 8.58336 (QuantReg: 11.22417) QuantErr: 11.22417 batch_time=30.90636 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 10.22837 (QuantReg: 11.51076) QuantErr: 11.51076 batch_time=0.64582 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 10.97130 (QuantReg: 11.09208) QuantErr: 11.09208 batch_time=0.64843 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 9.81194 (QuantReg: 11.47024) QuantErr: 11.47024 batch_time=0.64626 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 9.84888 (QuantReg: 11.42272) QuantErr: 11.42272 batch_time=0.68433 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 9.82648 (QuantReg: 11.48941) QuantErr: 11.48941 batch_time=0.65883 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 9.65894 (QuantReg: 11.88322) QuantErr: 11.88322 batch_time=0.65867 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 8.56990 (QuantReg: 11.56408) QuantErr: 11.56408 batch_time=0.79545 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 10.39313 (QuantReg: 11.82426) QuantErr: 11.82426 batch_time=0.64519 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 10.23773 (QuantReg: 12.02767) QuantErr: 12.02767 batch_time=0.64648 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 9.77637 (QuantReg: 12.22674) QuantErr: 12.22674 batch_time=0.67640 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 10.55502 (QuantReg: 12.20712) QuantErr: 12.20712 batch_time=0.66128 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 9.84198 (QuantReg: 12.29491) QuantErr: 12.29491 batch_time=0.65420 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 9.27463 (QuantReg: 12.09862) QuantErr: 12.09862 batch_time=0.64975 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 12.36048 (QuantReg: 12.09363) QuantErr: 12.09363 batch_time=0.66375 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 8.16887 (QuantReg: 12.36328) QuantErr: 12.36328 batch_time=0.65175 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 10.35241 (QuantReg: 12.57216) QuantErr: 12.57216 batch_time=0.65333 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 10.22831 (QuantReg: 12.29282) QuantErr: 12.29282 batch_time=0.64272 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 10.51596 (QuantReg: 12.54054) QuantErr: 12.54054 batch_time=0.70122 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 9.84146 (QuantReg: 12.47631) QuantErr: 12.47631 batch_time=0.65208 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 9.02822 (QuantReg: 12.49811) QuantErr: 12.49811 batch_time=0.65084 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 11.10168 (QuantReg: 12.50915) QuantErr: 12.50915 batch_time=0.64512 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 9.86820 (QuantReg: 12.90735) QuantErr: 12.90735 batch_time=0.69769 
Train Epoch: 3 codebook_update_time=3.32568
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch3.pth ...
Done in 3.975s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch3.pth ...
Done in 7.845s
removing stale ckpt [epoch 2] [took 0.02s]
 epoch          : 3
 loss           : 10.010972394943238
 quant_reg      : 12.030701400756836
 quant_err      : 12.030701400756836
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 40.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.314
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.02870601203549
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 56.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.077
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.701516154855305
 mnt_best       : 32.02870601203549
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 10.89729 (QuantReg: 11.48768) QuantErr: 11.48768 batch_time=22.60069 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 9.80488 (QuantReg: 11.11931) QuantErr: 11.11931 batch_time=0.72345 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 7.55098 (QuantReg: 11.75534) QuantErr: 11.75534 batch_time=1.12526 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 8.69904 (QuantReg: 11.50587) QuantErr: 11.50587 batch_time=0.72583 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 9.64461 (QuantReg: 11.60166) QuantErr: 11.60166 batch_time=0.67118 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 8.54059 (QuantReg: 12.02299) QuantErr: 12.02299 batch_time=0.64644 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 10.69260 (QuantReg: 12.11474) QuantErr: 12.11474 batch_time=1.09259 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 8.41961 (QuantReg: 12.03121) QuantErr: 12.03121 batch_time=0.63714 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 11.63714 (QuantReg: 12.13436) QuantErr: 12.13436 batch_time=0.73946 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 8.15287 (QuantReg: 11.82309) QuantErr: 11.82309 batch_time=0.71891 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 8.64139 (QuantReg: 11.77757) QuantErr: 11.77757 batch_time=0.70372 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 9.17578 (QuantReg: 11.56710) QuantErr: 11.56710 batch_time=0.65764 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 8.58636 (QuantReg: 12.36001) QuantErr: 12.36001 batch_time=0.68548 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 9.92561 (QuantReg: 12.31571) QuantErr: 12.31571 batch_time=0.76346 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 8.47984 (QuantReg: 12.09343) QuantErr: 12.09343 batch_time=0.63312 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 8.69728 (QuantReg: 11.90518) QuantErr: 11.90518 batch_time=0.65957 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 7.91684 (QuantReg: 11.90867) QuantErr: 11.90867 batch_time=0.65846 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 8.21842 (QuantReg: 11.92921) QuantErr: 11.92921 batch_time=0.65721 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 8.26093 (QuantReg: 12.30556) QuantErr: 12.30556 batch_time=0.66871 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 8.58070 (QuantReg: 12.02023) QuantErr: 12.02023 batch_time=0.67366 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 8.40440 (QuantReg: 12.19776) QuantErr: 12.19776 batch_time=1.65687 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 10.53127 (QuantReg: 12.40705) QuantErr: 12.40705 batch_time=0.64976 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 8.25977 (QuantReg: 12.60664) QuantErr: 12.60664 batch_time=0.64687 
Train Epoch: 4 codebook_update_time=3.76442
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch4.pth ...
Done in 4.052s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch4.pth ...
Done in 8.084s
removing stale ckpt [epoch 3] [took 0.02s]
 epoch          : 4
 loss           : 9.022286571502686
 quant_reg      : 12.022587814331054
 quant_err      : 12.022587814331054
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.452
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.61085117458011
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.553
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.16768480454966
 mnt_best       : 34.61085117458011
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 9.23338 (QuantReg: 11.74867) QuantErr: 11.74867 batch_time=21.17841 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 8.39725 (QuantReg: 11.36923) QuantErr: 11.36923 batch_time=0.65848 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 9.71361 (QuantReg: 11.42118) QuantErr: 11.42118 batch_time=0.66623 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 7.14012 (QuantReg: 11.66982) QuantErr: 11.66982 batch_time=0.65517 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 8.27874 (QuantReg: 11.91585) QuantErr: 11.91585 batch_time=0.65541 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 8.88265 (QuantReg: 11.98696) QuantErr: 11.98696 batch_time=0.64932 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 8.05416 (QuantReg: 11.67284) QuantErr: 11.67284 batch_time=0.65178 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 9.19829 (QuantReg: 12.32710) QuantErr: 12.32710 batch_time=0.70043 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 8.15560 (QuantReg: 11.55689) QuantErr: 11.55689 batch_time=0.65772 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 8.78342 (QuantReg: 12.17994) QuantErr: 12.17994 batch_time=0.64835 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 8.25491 (QuantReg: 11.96378) QuantErr: 11.96378 batch_time=0.69307 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 8.11652 (QuantReg: 12.18818) QuantErr: 12.18818 batch_time=0.70691 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 8.96559 (QuantReg: 11.98512) QuantErr: 11.98512 batch_time=0.66536 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 9.56629 (QuantReg: 12.41128) QuantErr: 12.41128 batch_time=1.31355 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 8.94101 (QuantReg: 12.13714) QuantErr: 12.13714 batch_time=0.67711 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 7.95875 (QuantReg: 12.50616) QuantErr: 12.50616 batch_time=0.67155 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 8.52824 (QuantReg: 12.35925) QuantErr: 12.35925 batch_time=0.65510 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 7.04833 (QuantReg: 11.84530) QuantErr: 11.84530 batch_time=0.71538 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 7.74957 (QuantReg: 12.01334) QuantErr: 12.01334 batch_time=0.64370 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 8.90256 (QuantReg: 12.34957) QuantErr: 12.34957 batch_time=0.98081 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 8.28686 (QuantReg: 12.22381) QuantErr: 12.22381 batch_time=0.67354 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 8.06692 (QuantReg: 12.52068) QuantErr: 12.52068 batch_time=0.65212 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 8.85611 (QuantReg: 12.17072) QuantErr: 12.17072 batch_time=0.65209 
Train Epoch: 5 codebook_update_time=3.68768
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch5.pth ...
Done in 3.950s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch5.pth ...
Done in 7.839s
removing stale ckpt [epoch 4] [took 0.02s]
 epoch          : 5
 loss           : 8.153512775421143
 quant_reg      : 12.075941024780274
 quant_err      : 12.075941024780274
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.518
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.68957788811878
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.0965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.894721291721204
 mnt_best       : 35.68957788811878
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 8.17172 (QuantReg: 12.11576) QuantErr: 12.11576 batch_time=31.06771 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 7.45406 (QuantReg: 11.68830) QuantErr: 11.68830 batch_time=0.64396 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 6.54813 (QuantReg: 12.34054) QuantErr: 12.34054 batch_time=0.64642 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 8.02212 (QuantReg: 12.09752) QuantErr: 12.09752 batch_time=0.67593 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 7.51397 (QuantReg: 11.82585) QuantErr: 11.82585 batch_time=0.67705 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 6.63882 (QuantReg: 11.92197) QuantErr: 11.92197 batch_time=0.64842 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 7.74840 (QuantReg: 11.80544) QuantErr: 11.80544 batch_time=0.65299 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 8.49214 (QuantReg: 12.32666) QuantErr: 12.32666 batch_time=0.72907 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 7.94865 (QuantReg: 12.27289) QuantErr: 12.27289 batch_time=0.65506 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 6.56864 (QuantReg: 12.42014) QuantErr: 12.42014 batch_time=0.75832 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 6.91360 (QuantReg: 12.69785) QuantErr: 12.69785 batch_time=0.65899 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 7.66723 (QuantReg: 12.08221) QuantErr: 12.08221 batch_time=0.65676 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 7.54074 (QuantReg: 12.00823) QuantErr: 12.00823 batch_time=0.65139 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 7.63752 (QuantReg: 12.33620) QuantErr: 12.33620 batch_time=2.49988 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 5.94335 (QuantReg: 12.36413) QuantErr: 12.36413 batch_time=0.66397 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 8.92804 (QuantReg: 11.79990) QuantErr: 11.79990 batch_time=0.66931 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 9.14962 (QuantReg: 11.51341) QuantErr: 11.51341 batch_time=0.65623 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 6.31114 (QuantReg: 12.51645) QuantErr: 12.51645 batch_time=0.63798 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 7.78920 (QuantReg: 12.03398) QuantErr: 12.03398 batch_time=0.66901 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 7.83864 (QuantReg: 12.15661) QuantErr: 12.15661 batch_time=0.64073 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 7.53739 (QuantReg: 12.44497) QuantErr: 12.44497 batch_time=0.64756 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 9.13879 (QuantReg: 12.29389) QuantErr: 12.29389 batch_time=0.90106 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 6.86434 (QuantReg: 12.70745) QuantErr: 12.70745 batch_time=0.67372 
Train Epoch: 6 codebook_update_time=3.69056
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch6.pth ...
Done in 3.754s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch6.pth ...
Done in 7.798s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 7.637740818023682
 quant_reg      : 12.140974784851075
 quant_err      : 12.140974784851075
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.105
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.7064534877486
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.773
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.87196428449707
 mnt_best       : 36.7064534877486
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 6.27607 (QuantReg: 11.80010) QuantErr: 11.80010 batch_time=25.83585 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 8.16981 (QuantReg: 12.06318) QuantErr: 12.06318 batch_time=0.64643 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 6.42907 (QuantReg: 11.53149) QuantErr: 11.53149 batch_time=0.65922 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 6.73756 (QuantReg: 12.18402) QuantErr: 12.18402 batch_time=0.64457 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 7.90608 (QuantReg: 12.56892) QuantErr: 12.56892 batch_time=0.64905 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 8.68400 (QuantReg: 12.18457) QuantErr: 12.18457 batch_time=0.64885 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 6.82395 (QuantReg: 12.03070) QuantErr: 12.03070 batch_time=2.40251 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 6.42024 (QuantReg: 12.36347) QuantErr: 12.36347 batch_time=0.66017 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 8.04475 (QuantReg: 11.85946) QuantErr: 11.85946 batch_time=0.66114 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 5.66141 (QuantReg: 12.11873) QuantErr: 12.11873 batch_time=0.65428 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 7.05654 (QuantReg: 12.43981) QuantErr: 12.43981 batch_time=0.74770 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 7.41550 (QuantReg: 12.15632) QuantErr: 12.15632 batch_time=0.65313 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 7.33480 (QuantReg: 11.93823) QuantErr: 11.93823 batch_time=0.83260 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 8.65933 (QuantReg: 12.51482) QuantErr: 12.51482 batch_time=0.65605 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 7.62865 (QuantReg: 11.93725) QuantErr: 11.93725 batch_time=0.64244 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 6.18448 (QuantReg: 12.18502) QuantErr: 12.18502 batch_time=0.65198 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 7.24284 (QuantReg: 12.33527) QuantErr: 12.33527 batch_time=0.65348 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 8.12802 (QuantReg: 12.04543) QuantErr: 12.04543 batch_time=1.03247 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 6.65481 (QuantReg: 12.29900) QuantErr: 12.29900 batch_time=0.65476 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 8.86360 (QuantReg: 12.78018) QuantErr: 12.78018 batch_time=0.64933 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 6.84441 (QuantReg: 12.44091) QuantErr: 12.44091 batch_time=0.69250 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 7.42280 (QuantReg: 12.51799) QuantErr: 12.51799 batch_time=0.67379 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 6.49734 (QuantReg: 12.62439) QuantErr: 12.62439 batch_time=0.67395 
Train Epoch: 7 codebook_update_time=3.50680
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch7.pth ...
Done in 3.999s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch7.pth ...
Done in 7.942s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 7.16471842956543
 quant_reg      : 12.249625999450684
 quant_err      : 12.249625999450684
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.254
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.64449351343088
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.75
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.208
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.414441133461686
 mnt_best       : 38.64449351343088
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 5.98260 (QuantReg: 12.26060) QuantErr: 12.26060 batch_time=28.52162 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 6.58390 (QuantReg: 12.09206) QuantErr: 12.09206 batch_time=0.65285 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 5.95027 (QuantReg: 12.32737) QuantErr: 12.32737 batch_time=0.65885 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 5.42573 (QuantReg: 11.61574) QuantErr: 11.61574 batch_time=0.67425 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 6.88022 (QuantReg: 12.07471) QuantErr: 12.07471 batch_time=0.66146 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 7.03395 (QuantReg: 12.11881) QuantErr: 12.11881 batch_time=0.65490 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 5.72098 (QuantReg: 12.04424) QuantErr: 12.04424 batch_time=4.71423 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 7.85007 (QuantReg: 12.54135) QuantErr: 12.54135 batch_time=0.64460 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 8.36551 (QuantReg: 12.24718) QuantErr: 12.24718 batch_time=0.65847 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 8.26829 (QuantReg: 12.26541) QuantErr: 12.26541 batch_time=0.65505 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 6.51942 (QuantReg: 12.56868) QuantErr: 12.56868 batch_time=0.67132 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 5.75685 (QuantReg: 12.28720) QuantErr: 12.28720 batch_time=0.66480 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 6.43182 (QuantReg: 12.50653) QuantErr: 12.50653 batch_time=0.64573 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 7.39522 (QuantReg: 12.34940) QuantErr: 12.34940 batch_time=0.65182 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 5.10882 (QuantReg: 12.35431) QuantErr: 12.35431 batch_time=0.68866 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 7.07553 (QuantReg: 12.38828) QuantErr: 12.38828 batch_time=0.67114 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 7.15489 (QuantReg: 12.48027) QuantErr: 12.48027 batch_time=0.64812 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 6.50436 (QuantReg: 12.33324) QuantErr: 12.33324 batch_time=0.75298 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 5.71753 (QuantReg: 12.66176) QuantErr: 12.66176 batch_time=0.64405 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 7.17936 (QuantReg: 12.47441) QuantErr: 12.47441 batch_time=0.65609 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 9.72456 (QuantReg: 12.64169) QuantErr: 12.64169 batch_time=0.67120 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 6.16525 (QuantReg: 12.33677) QuantErr: 12.33677 batch_time=0.66553 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 6.00973 (QuantReg: 12.34574) QuantErr: 12.34574 batch_time=0.65984 
Train Epoch: 8 codebook_update_time=3.69977
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch8.pth ...
Done in 4.903s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch8.pth ...
Done in 9.945s
removing stale ckpt [epoch 7] [took 0.02s]
 epoch          : 8
 loss           : 6.683614223480225
 quant_reg      : 12.315867671966553
 quant_err      : 12.315867671966553
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.718
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.974421097072884
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.295
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.78826620580687
 mnt_best       : 38.974421097072884
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 5.34427 (QuantReg: 12.34973) QuantErr: 12.34973 batch_time=25.01956 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 7.00041 (QuantReg: 12.32269) QuantErr: 12.32269 batch_time=0.65754 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 5.69016 (QuantReg: 12.07421) QuantErr: 12.07421 batch_time=0.68276 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 6.17124 (QuantReg: 12.31033) QuantErr: 12.31033 batch_time=0.65528 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 6.16763 (QuantReg: 12.39813) QuantErr: 12.39813 batch_time=0.65845 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 5.69442 (QuantReg: 12.48754) QuantErr: 12.48754 batch_time=0.75474 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 6.11738 (QuantReg: 12.11290) QuantErr: 12.11290 batch_time=0.68110 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 5.86790 (QuantReg: 12.69373) QuantErr: 12.69373 batch_time=0.66162 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 6.37697 (QuantReg: 12.38530) QuantErr: 12.38530 batch_time=0.74088 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 7.96507 (QuantReg: 12.50813) QuantErr: 12.50813 batch_time=0.67293 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 6.19337 (QuantReg: 12.55205) QuantErr: 12.55205 batch_time=0.65606 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 6.68608 (QuantReg: 12.49326) QuantErr: 12.49326 batch_time=0.63781 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 5.67302 (QuantReg: 12.60317) QuantErr: 12.60317 batch_time=0.65554 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 5.82109 (QuantReg: 12.73837) QuantErr: 12.73837 batch_time=0.67105 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 5.00347 (QuantReg: 12.41412) QuantErr: 12.41412 batch_time=0.65288 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 6.11948 (QuantReg: 12.40290) QuantErr: 12.40290 batch_time=0.70820 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 7.45402 (QuantReg: 12.26754) QuantErr: 12.26754 batch_time=0.64997 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 5.35466 (QuantReg: 12.53783) QuantErr: 12.53783 batch_time=0.64755 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 5.01008 (QuantReg: 12.58302) QuantErr: 12.58302 batch_time=0.64768 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 6.94188 (QuantReg: 12.51703) QuantErr: 12.51703 batch_time=0.65895 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 6.29229 (QuantReg: 12.53616) QuantErr: 12.53616 batch_time=0.69374 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 7.36091 (QuantReg: 12.44353) QuantErr: 12.44353 batch_time=0.65730 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 4.98264 (QuantReg: 12.90176) QuantErr: 12.90176 batch_time=0.64805 
Train Epoch: 9 codebook_update_time=3.45858
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch9.pth ...
Done in 6.943s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch9.pth ...
Done in 11.910s
removing stale ckpt [epoch 8] [took 0.02s]
 epoch          : 9
 loss           : 6.351163307189942
 quant_reg      : 12.365599281311034
 quant_err      : 12.365599281311034
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.464
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.46594939815771
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.147
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.8142327656006
 mnt_best       : 39.46594939815771
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 6.33391 (QuantReg: 12.11600) QuantErr: 12.11600 batch_time=24.03713 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 5.99394 (QuantReg: 12.13708) QuantErr: 12.13708 batch_time=0.70613 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 6.83966 (QuantReg: 12.47377) QuantErr: 12.47377 batch_time=0.65758 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 5.98926 (QuantReg: 12.22284) QuantErr: 12.22284 batch_time=0.65819 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 6.51337 (QuantReg: 12.11650) QuantErr: 12.11650 batch_time=0.65738 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 5.50566 (QuantReg: 12.10428) QuantErr: 12.10428 batch_time=0.65669 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 6.26864 (QuantReg: 12.77548) QuantErr: 12.77548 batch_time=0.66232 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 5.35926 (QuantReg: 12.43559) QuantErr: 12.43559 batch_time=0.64193 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 5.57994 (QuantReg: 12.82792) QuantErr: 12.82792 batch_time=0.67141 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 5.70354 (QuantReg: 12.64724) QuantErr: 12.64724 batch_time=0.65309 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 4.76061 (QuantReg: 12.39523) QuantErr: 12.39523 batch_time=0.65760 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 7.18166 (QuantReg: 12.32443) QuantErr: 12.32443 batch_time=0.65585 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 6.24542 (QuantReg: 12.11804) QuantErr: 12.11804 batch_time=0.64853 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 5.55031 (QuantReg: 12.95999) QuantErr: 12.95999 batch_time=0.64641 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 9.27712 (QuantReg: 12.32192) QuantErr: 12.32192 batch_time=0.64169 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 6.07613 (QuantReg: 12.62377) QuantErr: 12.62377 batch_time=0.65665 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 5.23094 (QuantReg: 12.39244) QuantErr: 12.39244 batch_time=0.65104 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 6.48966 (QuantReg: 12.61741) QuantErr: 12.61741 batch_time=0.66262 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 7.30266 (QuantReg: 12.65367) QuantErr: 12.65367 batch_time=0.66395 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 6.16696 (QuantReg: 12.97818) QuantErr: 12.97818 batch_time=0.67154 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 6.11419 (QuantReg: 12.65093) QuantErr: 12.65093 batch_time=0.86008 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 4.95063 (QuantReg: 12.77514) QuantErr: 12.77514 batch_time=0.65984 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 5.04131 (QuantReg: 12.68400) QuantErr: 12.68400 batch_time=0.63748 
Train Epoch: 10 codebook_update_time=3.47626
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch10.pth ...
Done in 6.064s
removing stale ckpt [epoch 9] [took 0.02s]
 epoch          : 10
 loss           : 6.07849605178833
 quant_reg      : 12.50825626373291
 quant_err      : 12.50825626373291
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.188
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.425829087456606
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.85
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.929787242997385
 mnt_best       : 39.46594939815771
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 6.42983 (QuantReg: 12.33393) QuantErr: 12.33393 batch_time=24.84880 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 4.96707 (QuantReg: 12.41557) QuantErr: 12.41557 batch_time=0.65416 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 6.77231 (QuantReg: 12.56819) QuantErr: 12.56819 batch_time=0.69738 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 5.50104 (QuantReg: 12.41241) QuantErr: 12.41241 batch_time=0.67230 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 6.45575 (QuantReg: 12.72278) QuantErr: 12.72278 batch_time=0.68199 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 5.39125 (QuantReg: 12.41873) QuantErr: 12.41873 batch_time=0.65791 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 4.83487 (QuantReg: 12.48208) QuantErr: 12.48208 batch_time=0.65305 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 6.76374 (QuantReg: 12.82609) QuantErr: 12.82609 batch_time=0.66456 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 6.74040 (QuantReg: 12.51501) QuantErr: 12.51501 batch_time=0.65615 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 6.38731 (QuantReg: 12.47728) QuantErr: 12.47728 batch_time=0.65006 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 6.37394 (QuantReg: 12.18820) QuantErr: 12.18820 batch_time=0.64005 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 5.90456 (QuantReg: 12.14911) QuantErr: 12.14911 batch_time=0.66325 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 5.44603 (QuantReg: 12.44290) QuantErr: 12.44290 batch_time=0.71122 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 5.91901 (QuantReg: 12.81184) QuantErr: 12.81184 batch_time=0.66400 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 4.41471 (QuantReg: 12.39616) QuantErr: 12.39616 batch_time=0.67380 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 5.76804 (QuantReg: 12.98603) QuantErr: 12.98603 batch_time=0.69514 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 5.86621 (QuantReg: 12.37442) QuantErr: 12.37442 batch_time=0.68968 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 6.27931 (QuantReg: 12.29980) QuantErr: 12.29980 batch_time=0.64605 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 7.04296 (QuantReg: 12.43708) QuantErr: 12.43708 batch_time=0.67577 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 5.25727 (QuantReg: 12.67173) QuantErr: 12.67173 batch_time=0.63977 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 6.50186 (QuantReg: 12.50514) QuantErr: 12.50514 batch_time=0.96012 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 4.94398 (QuantReg: 12.67206) QuantErr: 12.67206 batch_time=0.71623 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 5.36819 (QuantReg: 12.65341) QuantErr: 12.65341 batch_time=0.65239 
Train Epoch: 11 codebook_update_time=3.37729
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch11.pth ...
Done in 5.924s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch11.pth ...
Done in 12.511s
removing stale ckpt [epoch 10] [took 0.02s]
 epoch          : 11
 loss           : 5.799474544525147
 quant_reg      : 12.549648334503173
 quant_err      : 12.549648334503173
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.054
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.570519477662764
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0695
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.38813820306814
 mnt_best       : 41.570519477662764
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 6.81602 (QuantReg: 12.50939) QuantErr: 12.50939 batch_time=26.52352 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 5.77822 (QuantReg: 12.22094) QuantErr: 12.22094 batch_time=0.64545 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 4.86356 (QuantReg: 12.55579) QuantErr: 12.55579 batch_time=0.65385 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 4.66449 (QuantReg: 12.73215) QuantErr: 12.73215 batch_time=0.63919 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 5.01073 (QuantReg: 12.29702) QuantErr: 12.29702 batch_time=0.65325 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 4.83860 (QuantReg: 12.52416) QuantErr: 12.52416 batch_time=0.65103 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 7.50851 (QuantReg: 12.28198) QuantErr: 12.28198 batch_time=0.70480 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 6.09241 (QuantReg: 12.40140) QuantErr: 12.40140 batch_time=0.63808 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 5.80903 (QuantReg: 12.42025) QuantErr: 12.42025 batch_time=0.64935 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 6.72630 (QuantReg: 12.52447) QuantErr: 12.52447 batch_time=0.64112 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 5.91673 (QuantReg: 12.58456) QuantErr: 12.58456 batch_time=1.84887 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 4.85251 (QuantReg: 12.78848) QuantErr: 12.78848 batch_time=0.66813 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 6.70119 (QuantReg: 12.25669) QuantErr: 12.25669 batch_time=0.65863 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 5.18871 (QuantReg: 12.50491) QuantErr: 12.50491 batch_time=3.13314 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 4.88954 (QuantReg: 12.80060) QuantErr: 12.80060 batch_time=0.70633 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 4.74148 (QuantReg: 12.92975) QuantErr: 12.92975 batch_time=0.66604 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 6.23635 (QuantReg: 12.30837) QuantErr: 12.30837 batch_time=0.64984 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 5.48929 (QuantReg: 12.70244) QuantErr: 12.70244 batch_time=0.64685 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 5.92724 (QuantReg: 12.73348) QuantErr: 12.73348 batch_time=1.85866 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 5.80061 (QuantReg: 13.07209) QuantErr: 13.07209 batch_time=0.65552 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 6.23196 (QuantReg: 12.54102) QuantErr: 12.54102 batch_time=0.67459 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 6.55908 (QuantReg: 12.72670) QuantErr: 12.72670 batch_time=0.63861 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 5.21288 (QuantReg: 12.52955) QuantErr: 12.52955 batch_time=0.67915 
Train Epoch: 12 codebook_update_time=3.53691
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch12.pth ...
Done in 5.046s
removing stale ckpt [epoch 11] [took 0.14s]
 epoch          : 12
 loss           : 5.530421800613404
 quant_reg      : 12.567639335632323
 quant_err      : 12.567639335632323
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.89
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.56131064491869
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.211
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.66643032043716
 mnt_best       : 41.570519477662764
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 5.23040 (QuantReg: 12.31836) QuantErr: 12.31836 batch_time=22.85574 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 6.00412 (QuantReg: 12.30492) QuantErr: 12.30492 batch_time=0.66612 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 5.59727 (QuantReg: 12.61330) QuantErr: 12.61330 batch_time=0.64841 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 5.60109 (QuantReg: 12.32106) QuantErr: 12.32106 batch_time=0.69133 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 5.12091 (QuantReg: 12.65396) QuantErr: 12.65396 batch_time=0.65546 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 5.24139 (QuantReg: 12.61739) QuantErr: 12.61739 batch_time=0.78812 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 4.31649 (QuantReg: 12.51854) QuantErr: 12.51854 batch_time=0.67755 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 4.50686 (QuantReg: 12.94194) QuantErr: 12.94194 batch_time=0.65975 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 4.81054 (QuantReg: 12.78113) QuantErr: 12.78113 batch_time=0.65883 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 4.90136 (QuantReg: 12.71656) QuantErr: 12.71656 batch_time=0.65358 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 6.01907 (QuantReg: 12.45847) QuantErr: 12.45847 batch_time=0.65480 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 6.52129 (QuantReg: 12.33964) QuantErr: 12.33964 batch_time=0.65450 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 6.98154 (QuantReg: 12.76953) QuantErr: 12.76953 batch_time=0.65386 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 5.88274 (QuantReg: 12.50937) QuantErr: 12.50937 batch_time=1.12336 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 3.97767 (QuantReg: 13.00821) QuantErr: 13.00821 batch_time=0.66891 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 4.80189 (QuantReg: 12.99442) QuantErr: 12.99442 batch_time=0.66090 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 6.29178 (QuantReg: 12.74926) QuantErr: 12.74926 batch_time=0.65644 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 5.19666 (QuantReg: 12.71119) QuantErr: 12.71119 batch_time=0.64727 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 5.22152 (QuantReg: 12.63041) QuantErr: 12.63041 batch_time=0.64321 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 3.98836 (QuantReg: 12.79299) QuantErr: 12.79299 batch_time=0.64549 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 5.16320 (QuantReg: 12.53752) QuantErr: 12.53752 batch_time=0.64792 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 5.32895 (QuantReg: 12.70258) QuantErr: 12.70258 batch_time=0.66696 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 5.30105 (QuantReg: 13.00922) QuantErr: 13.00922 batch_time=0.64711 
Train Epoch: 13 codebook_update_time=3.49271
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch13.pth ...
Done in 6.174s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch13.pth ...
Done in 11.001s
removing stale ckpt [epoch 12] [took 0.08s]
 epoch          : 13
 loss           : 5.347531148910522
 quant_reg      : 12.630577388763427
 quant_err      : 12.630577388763427
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.19
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.65264537999151
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0135
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.60099695589051
 mnt_best       : 41.65264537999151
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 4.70201 (QuantReg: 12.63879) QuantErr: 12.63879 batch_time=22.75389 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 5.30919 (QuantReg: 12.36487) QuantErr: 12.36487 batch_time=0.66319 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 5.79933 (QuantReg: 12.29061) QuantErr: 12.29061 batch_time=0.66721 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 4.78775 (QuantReg: 12.46800) QuantErr: 12.46800 batch_time=0.65575 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 5.25464 (QuantReg: 12.58574) QuantErr: 12.58574 batch_time=0.65532 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 5.66950 (QuantReg: 12.50049) QuantErr: 12.50049 batch_time=0.65398 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 4.85198 (QuantReg: 12.78178) QuantErr: 12.78178 batch_time=2.94191 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 5.72514 (QuantReg: 12.44354) QuantErr: 12.44354 batch_time=0.65189 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 4.38246 (QuantReg: 12.97515) QuantErr: 12.97515 batch_time=0.69408 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 5.79058 (QuantReg: 12.48508) QuantErr: 12.48508 batch_time=0.65085 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 4.79178 (QuantReg: 12.42693) QuantErr: 12.42693 batch_time=0.68279 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 5.01429 (QuantReg: 12.50164) QuantErr: 12.50164 batch_time=0.65705 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 4.56000 (QuantReg: 12.74114) QuantErr: 12.74114 batch_time=0.67038 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 5.53823 (QuantReg: 12.36052) QuantErr: 12.36052 batch_time=0.64749 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 4.28752 (QuantReg: 12.67890) QuantErr: 12.67890 batch_time=0.66224 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 5.19646 (QuantReg: 12.20059) QuantErr: 12.20059 batch_time=0.70615 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 3.76350 (QuantReg: 12.60202) QuantErr: 12.60202 batch_time=0.65935 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 5.33493 (QuantReg: 12.47123) QuantErr: 12.47123 batch_time=0.64978 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 4.48306 (QuantReg: 12.68958) QuantErr: 12.68958 batch_time=1.40248 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 4.46323 (QuantReg: 12.80328) QuantErr: 12.80328 batch_time=0.66960 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 5.92631 (QuantReg: 12.17094) QuantErr: 12.17094 batch_time=2.29560 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 5.35498 (QuantReg: 12.58776) QuantErr: 12.58776 batch_time=0.65005 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 5.83346 (QuantReg: 13.00584) QuantErr: 13.00584 batch_time=1.20643 
Train Epoch: 14 codebook_update_time=4.32351
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch14.pth ...
Done in 4.200s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch14.pth ...
Done in 9.181s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 5.239548217773438
 quant_reg      : 12.625655864715576
 quant_err      : 12.625655864715576
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.364
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.643787952542084
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.2145
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.34047323444978
 mnt_best       : 42.643787952542084
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 4.93917 (QuantReg: 12.70422) QuantErr: 12.70422 batch_time=32.07491 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 5.87304 (QuantReg: 12.62104) QuantErr: 12.62104 batch_time=0.65470 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 4.37655 (QuantReg: 12.90540) QuantErr: 12.90540 batch_time=0.65436 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 4.54113 (QuantReg: 12.58976) QuantErr: 12.58976 batch_time=1.18800 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 4.65605 (QuantReg: 12.56685) QuantErr: 12.56685 batch_time=0.65111 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 5.25071 (QuantReg: 13.04259) QuantErr: 13.04259 batch_time=0.67485 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 4.89034 (QuantReg: 12.77603) QuantErr: 12.77603 batch_time=0.66481 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 4.76442 (QuantReg: 12.71393) QuantErr: 12.71393 batch_time=0.65865 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 4.86903 (QuantReg: 12.76779) QuantErr: 12.76779 batch_time=0.65314 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 4.20178 (QuantReg: 12.75378) QuantErr: 12.75378 batch_time=0.72748 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 5.45140 (QuantReg: 12.73589) QuantErr: 12.73589 batch_time=0.66594 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 5.31833 (QuantReg: 12.58272) QuantErr: 12.58272 batch_time=0.71236 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 4.30191 (QuantReg: 13.16737) QuantErr: 13.16737 batch_time=0.72523 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 4.74535 (QuantReg: 12.87776) QuantErr: 12.87776 batch_time=0.65651 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 5.04069 (QuantReg: 12.79187) QuantErr: 12.79187 batch_time=0.65757 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 4.24194 (QuantReg: 12.91020) QuantErr: 12.91020 batch_time=0.67611 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 4.81840 (QuantReg: 12.73679) QuantErr: 12.73679 batch_time=0.67317 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 4.13336 (QuantReg: 13.13447) QuantErr: 13.13447 batch_time=0.66092 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 5.43324 (QuantReg: 12.93989) QuantErr: 12.93989 batch_time=0.67553 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 3.74256 (QuantReg: 12.52510) QuantErr: 12.52510 batch_time=0.66184 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 5.70015 (QuantReg: 12.88151) QuantErr: 12.88151 batch_time=0.71855 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 5.95117 (QuantReg: 13.04764) QuantErr: 13.04764 batch_time=0.68341 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 4.97877 (QuantReg: 12.92482) QuantErr: 12.92482 batch_time=0.66184 
Train Epoch: 15 codebook_update_time=3.65035
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch15.pth ...
Done in 5.802s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 4.999465203285217
 quant_reg      : 12.733496929168702
 quant_err      : 12.733496929168702
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.471
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.06112829767913
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.187
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.69501154733098
 mnt_best       : 42.643787952542084
 not_improved_count: 1
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 5.95925 (QuantReg: 11.92506) QuantErr: 11.92506 batch_time=24.62219 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 4.77678 (QuantReg: 12.54807) QuantErr: 12.54807 batch_time=0.63279 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 4.86615 (QuantReg: 12.63967) QuantErr: 12.63967 batch_time=0.71309 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 5.30456 (QuantReg: 12.54910) QuantErr: 12.54910 batch_time=0.66840 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 4.89005 (QuantReg: 12.55607) QuantErr: 12.55607 batch_time=0.64314 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 4.88139 (QuantReg: 12.87098) QuantErr: 12.87098 batch_time=0.65608 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 5.96752 (QuantReg: 12.57647) QuantErr: 12.57647 batch_time=0.66156 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 4.46046 (QuantReg: 12.59565) QuantErr: 12.59565 batch_time=0.64510 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 5.00093 (QuantReg: 12.67394) QuantErr: 12.67394 batch_time=0.64358 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 6.24024 (QuantReg: 12.76975) QuantErr: 12.76975 batch_time=0.64512 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 4.53440 (QuantReg: 12.66610) QuantErr: 12.66610 batch_time=0.68919 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 5.21388 (QuantReg: 12.63367) QuantErr: 12.63367 batch_time=0.73989 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 4.43613 (QuantReg: 12.70297) QuantErr: 12.70297 batch_time=0.86219 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 4.14217 (QuantReg: 13.43477) QuantErr: 13.43477 batch_time=0.66802 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 5.72413 (QuantReg: 12.66120) QuantErr: 12.66120 batch_time=0.65325 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 5.73750 (QuantReg: 12.77211) QuantErr: 12.77211 batch_time=0.63485 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 4.00712 (QuantReg: 12.53422) QuantErr: 12.53422 batch_time=0.64653 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 5.56504 (QuantReg: 12.62402) QuantErr: 12.62402 batch_time=0.65506 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 4.66562 (QuantReg: 12.55698) QuantErr: 12.55698 batch_time=0.70373 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 4.56746 (QuantReg: 12.89698) QuantErr: 12.89698 batch_time=0.64675 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 5.65860 (QuantReg: 12.71257) QuantErr: 12.71257 batch_time=0.64893 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 4.00989 (QuantReg: 12.94517) QuantErr: 12.94517 batch_time=0.64392 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 3.77078 (QuantReg: 12.74943) QuantErr: 12.74943 batch_time=0.67440 
Train Epoch: 16 codebook_update_time=3.64412
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch16.pth ...
Done in 4.354s
removing stale ckpt [epoch 15] [took 0.05s]
 epoch          : 16
 loss           : 4.839705881118775
 quant_reg      : 12.757451755523682
 quant_err      : 12.757451755523682
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.337
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.06634469087434
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.911
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.31583592234888
 mnt_best       : 42.643787952542084
 not_improved_count: 2
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 5.60868 (QuantReg: 12.69976) QuantErr: 12.69976 batch_time=22.93370 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 4.21165 (QuantReg: 12.85749) QuantErr: 12.85749 batch_time=0.64670 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 4.55346 (QuantReg: 12.32388) QuantErr: 12.32388 batch_time=0.70471 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 5.58209 (QuantReg: 12.95356) QuantErr: 12.95356 batch_time=0.68292 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 4.67390 (QuantReg: 12.84426) QuantErr: 12.84426 batch_time=0.66032 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 4.27955 (QuantReg: 12.82731) QuantErr: 12.82731 batch_time=0.67503 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 5.53442 (QuantReg: 12.48807) QuantErr: 12.48807 batch_time=0.67624 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 4.52048 (QuantReg: 12.89100) QuantErr: 12.89100 batch_time=0.65707 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 5.55507 (QuantReg: 12.80412) QuantErr: 12.80412 batch_time=0.66598 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 3.93442 (QuantReg: 12.90441) QuantErr: 12.90441 batch_time=0.66229 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 5.13407 (QuantReg: 12.80118) QuantErr: 12.80118 batch_time=0.65787 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 5.40444 (QuantReg: 12.75002) QuantErr: 12.75002 batch_time=0.69667 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 5.01357 (QuantReg: 12.89533) QuantErr: 12.89533 batch_time=1.41398 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 3.43544 (QuantReg: 13.03856) QuantErr: 13.03856 batch_time=0.64945 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 5.04847 (QuantReg: 12.94853) QuantErr: 12.94853 batch_time=0.70113 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 3.82271 (QuantReg: 12.81199) QuantErr: 12.81199 batch_time=0.72068 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 4.49304 (QuantReg: 12.87594) QuantErr: 12.87594 batch_time=0.64065 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 5.58155 (QuantReg: 12.69623) QuantErr: 12.69623 batch_time=0.73358 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 3.56255 (QuantReg: 13.08766) QuantErr: 13.08766 batch_time=0.65188 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 4.59618 (QuantReg: 12.71552) QuantErr: 12.71552 batch_time=1.10627 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 5.03082 (QuantReg: 13.07200) QuantErr: 13.07200 batch_time=0.96427 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 4.35814 (QuantReg: 12.68474) QuantErr: 12.68474 batch_time=0.65581 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 5.25673 (QuantReg: 12.69268) QuantErr: 12.69268 batch_time=0.65623 
Train Epoch: 17 codebook_update_time=3.55337
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch17.pth ...
Done in 5.463s
removing stale ckpt [epoch 16] [took 0.14s]
 epoch          : 17
 loss           : 4.74646240234375
 quant_reg      : 12.798102115631103
 quant_err      : 12.798102115631103
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.569
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.3524089257731
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.26
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.19828025275583
 mnt_best       : 42.643787952542084
 not_improved_count: 3
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 4.35238 (QuantReg: 12.59269) QuantErr: 12.59269 batch_time=24.26385 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 5.15696 (QuantReg: 12.80813) QuantErr: 12.80813 batch_time=0.65021 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 5.73286 (QuantReg: 12.69025) QuantErr: 12.69025 batch_time=0.66265 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 5.18539 (QuantReg: 12.45813) QuantErr: 12.45813 batch_time=0.69408 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 3.10930 (QuantReg: 12.85783) QuantErr: 12.85783 batch_time=0.67303 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 6.09670 (QuantReg: 12.66057) QuantErr: 12.66057 batch_time=0.67549 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 3.71727 (QuantReg: 12.99767) QuantErr: 12.99767 batch_time=1.27264 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 4.22922 (QuantReg: 12.92379) QuantErr: 12.92379 batch_time=0.67250 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 3.75361 (QuantReg: 12.86456) QuantErr: 12.86456 batch_time=0.65287 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 4.28573 (QuantReg: 12.47279) QuantErr: 12.47279 batch_time=0.66941 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 4.14907 (QuantReg: 12.92087) QuantErr: 12.92087 batch_time=0.65286 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 3.78640 (QuantReg: 12.94731) QuantErr: 12.94731 batch_time=0.68491 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 5.33564 (QuantReg: 12.58181) QuantErr: 12.58181 batch_time=0.66663 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 4.61721 (QuantReg: 12.56091) QuantErr: 12.56091 batch_time=0.66598 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 4.53158 (QuantReg: 12.72247) QuantErr: 12.72247 batch_time=0.84845 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 5.39172 (QuantReg: 13.21880) QuantErr: 13.21880 batch_time=0.73820 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 3.95905 (QuantReg: 13.03467) QuantErr: 13.03467 batch_time=0.73429 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 4.12700 (QuantReg: 12.81861) QuantErr: 12.81861 batch_time=0.67929 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 4.85638 (QuantReg: 12.90088) QuantErr: 12.90088 batch_time=0.69357 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 4.05230 (QuantReg: 13.03630) QuantErr: 13.03630 batch_time=0.66526 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 4.69404 (QuantReg: 12.33483) QuantErr: 12.33483 batch_time=0.66302 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 4.46491 (QuantReg: 13.00667) QuantErr: 13.00667 batch_time=0.65572 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 4.62757 (QuantReg: 12.66239) QuantErr: 12.66239 batch_time=0.67663 
Train Epoch: 18 codebook_update_time=3.38188
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch18.pth ...
Done in 4.466s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 4.568733917236328
 quant_reg      : 12.795279041290284
 quant_err      : 12.795279041290284
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.954
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.399450420074785
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.798
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.4747646267132
 mnt_best       : 42.643787952542084
 not_improved_count: 4
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 3.81795 (QuantReg: 12.78915) QuantErr: 12.78915 batch_time=25.48625 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 4.57512 (QuantReg: 12.65680) QuantErr: 12.65680 batch_time=0.67505 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 4.65180 (QuantReg: 12.64639) QuantErr: 12.64639 batch_time=0.69035 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 4.05678 (QuantReg: 12.72013) QuantErr: 12.72013 batch_time=0.64874 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 4.42007 (QuantReg: 12.57564) QuantErr: 12.57564 batch_time=0.66831 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 4.61253 (QuantReg: 12.87971) QuantErr: 12.87971 batch_time=0.81848 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 4.79054 (QuantReg: 12.46641) QuantErr: 12.46641 batch_time=0.68555 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 4.70159 (QuantReg: 12.57285) QuantErr: 12.57285 batch_time=0.99833 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 4.50808 (QuantReg: 12.67908) QuantErr: 12.67908 batch_time=0.66224 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 4.94567 (QuantReg: 12.91755) QuantErr: 12.91755 batch_time=0.66340 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 3.83953 (QuantReg: 12.75270) QuantErr: 12.75270 batch_time=0.64737 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 4.10428 (QuantReg: 12.98309) QuantErr: 12.98309 batch_time=0.67411 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 4.22687 (QuantReg: 12.64682) QuantErr: 12.64682 batch_time=0.90076 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 4.90697 (QuantReg: 12.72045) QuantErr: 12.72045 batch_time=0.67476 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 3.77074 (QuantReg: 13.00019) QuantErr: 13.00019 batch_time=0.65565 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 4.95605 (QuantReg: 12.89621) QuantErr: 12.89621 batch_time=0.65694 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 3.94718 (QuantReg: 12.65990) QuantErr: 12.65990 batch_time=0.65146 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 5.78308 (QuantReg: 12.41548) QuantErr: 12.41548 batch_time=0.66579 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 4.64186 (QuantReg: 12.86397) QuantErr: 12.86397 batch_time=3.04142 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 4.86030 (QuantReg: 13.16725) QuantErr: 13.16725 batch_time=0.68297 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 4.62013 (QuantReg: 13.18217) QuantErr: 13.18217 batch_time=0.75560 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 5.17764 (QuantReg: 12.88044) QuantErr: 12.88044 batch_time=0.70551 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 4.73986 (QuantReg: 12.98284) QuantErr: 12.98284 batch_time=0.66909 
Train Epoch: 19 codebook_update_time=3.43478
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch19.pth ...
Done in 4.112s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch19.pth ...
Done in 8.372s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 4.532879644393921
 quant_reg      : 12.822084655761719
 quant_err      : 12.822084655761719
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.888
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.146111934153346
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.526
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.440749031510556
 mnt_best       : 43.146111934153346
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 5.31299 (QuantReg: 12.79715) QuantErr: 12.79715 batch_time=29.18495 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 4.70077 (QuantReg: 12.82478) QuantErr: 12.82478 batch_time=0.76133 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 4.03968 (QuantReg: 12.79574) QuantErr: 12.79574 batch_time=0.64878 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 4.36957 (QuantReg: 12.77678) QuantErr: 12.77678 batch_time=0.65798 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 5.15606 (QuantReg: 13.20767) QuantErr: 13.20767 batch_time=0.65949 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 4.59712 (QuantReg: 13.06597) QuantErr: 13.06597 batch_time=0.68098 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 4.87887 (QuantReg: 13.21289) QuantErr: 13.21289 batch_time=0.68143 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 3.98201 (QuantReg: 12.97817) QuantErr: 12.97817 batch_time=0.65601 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 3.79654 (QuantReg: 12.73005) QuantErr: 12.73005 batch_time=0.70473 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 4.43096 (QuantReg: 12.68321) QuantErr: 12.68321 batch_time=0.66149 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 4.34907 (QuantReg: 13.04037) QuantErr: 13.04037 batch_time=0.72970 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 3.82609 (QuantReg: 12.63057) QuantErr: 12.63057 batch_time=0.68482 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 4.02782 (QuantReg: 12.48478) QuantErr: 12.48478 batch_time=0.65082 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 4.83977 (QuantReg: 12.97679) QuantErr: 12.97679 batch_time=0.68382 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 5.12568 (QuantReg: 12.93594) QuantErr: 12.93594 batch_time=0.67166 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 4.92066 (QuantReg: 12.73966) QuantErr: 12.73966 batch_time=0.66456 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 4.43284 (QuantReg: 12.97772) QuantErr: 12.97772 batch_time=0.64690 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 5.09650 (QuantReg: 12.66494) QuantErr: 12.66494 batch_time=0.65733 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 4.10121 (QuantReg: 13.01061) QuantErr: 13.01061 batch_time=0.64880 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 5.80270 (QuantReg: 12.91692) QuantErr: 12.91692 batch_time=0.65605 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 4.72014 (QuantReg: 12.82110) QuantErr: 12.82110 batch_time=0.92378 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 5.22082 (QuantReg: 12.99014) QuantErr: 12.99014 batch_time=0.67754 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 3.89270 (QuantReg: 13.01986) QuantErr: 13.01986 batch_time=0.65943 
Train Epoch: 20 codebook_update_time=3.42973
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch20.pth ...
Done in 4.564s
removing stale ckpt [epoch 19] [took 0.01s]
 epoch          : 20
 loss           : 4.503037109375
 quant_reg      : 12.820673820495605
 quant_err      : 12.820673820495605
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.804
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.24219852920115
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.1825
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.24171068597338
 mnt_best       : 43.146111934153346
 not_improved_count: 1
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 3.95851 (QuantReg: 12.93395) QuantErr: 12.93395 batch_time=25.76795 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 3.98546 (QuantReg: 12.84621) QuantErr: 12.84621 batch_time=0.66799 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 4.42657 (QuantReg: 12.85954) QuantErr: 12.85954 batch_time=0.65070 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 4.33579 (QuantReg: 12.98405) QuantErr: 12.98405 batch_time=0.66768 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 4.31462 (QuantReg: 12.63780) QuantErr: 12.63780 batch_time=0.66975 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 4.11910 (QuantReg: 13.11766) QuantErr: 13.11766 batch_time=0.71698 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 3.65050 (QuantReg: 12.84471) QuantErr: 12.84471 batch_time=0.64721 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 4.63815 (QuantReg: 12.64633) QuantErr: 12.64633 batch_time=0.92820 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 4.57360 (QuantReg: 12.78458) QuantErr: 12.78458 batch_time=0.66773 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 4.50096 (QuantReg: 12.79889) QuantErr: 12.79889 batch_time=0.65394 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 4.69351 (QuantReg: 12.95737) QuantErr: 12.95737 batch_time=0.66150 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 4.44547 (QuantReg: 12.68374) QuantErr: 12.68374 batch_time=0.65756 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 3.45333 (QuantReg: 13.17480) QuantErr: 13.17480 batch_time=0.65131 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 4.49319 (QuantReg: 12.69014) QuantErr: 12.69014 batch_time=2.86459 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 4.50378 (QuantReg: 12.62151) QuantErr: 12.62151 batch_time=0.65450 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 3.41512 (QuantReg: 13.28788) QuantErr: 13.28788 batch_time=1.17411 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 4.27810 (QuantReg: 12.93630) QuantErr: 12.93630 batch_time=0.66586 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 4.61328 (QuantReg: 13.04246) QuantErr: 13.04246 batch_time=0.65419 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 4.03757 (QuantReg: 12.82152) QuantErr: 12.82152 batch_time=0.93961 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 4.63242 (QuantReg: 13.12671) QuantErr: 13.12671 batch_time=2.99527 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 4.24326 (QuantReg: 12.28078) QuantErr: 12.28078 batch_time=0.67107 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 3.65398 (QuantReg: 13.18321) QuantErr: 13.18321 batch_time=0.65826 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 3.70776 (QuantReg: 13.28756) QuantErr: 13.28756 batch_time=0.68337 
Train Epoch: 21 codebook_update_time=3.48135
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch21.pth ...
Done in 4.697s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch21.pth ...
Done in 9.208s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 4.3066509141922
 quant_reg      : 12.885700714111328
 quant_err      : 12.885700714111328
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.422
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.18794245111804
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.787
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.02746577712111
 mnt_best       : 43.18794245111804
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 4.07586 (QuantReg: 12.71884) QuantErr: 12.71884 batch_time=24.30028 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 5.21376 (QuantReg: 12.76957) QuantErr: 12.76957 batch_time=0.72116 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 4.24437 (QuantReg: 12.86402) QuantErr: 12.86402 batch_time=0.68431 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 3.29354 (QuantReg: 13.10844) QuantErr: 13.10844 batch_time=0.69489 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 4.41602 (QuantReg: 12.76070) QuantErr: 12.76070 batch_time=0.66963 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 3.59858 (QuantReg: 13.11630) QuantErr: 13.11630 batch_time=0.64232 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 4.70090 (QuantReg: 12.74562) QuantErr: 12.74562 batch_time=1.72010 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 4.21399 (QuantReg: 12.89062) QuantErr: 12.89062 batch_time=0.68698 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 3.68286 (QuantReg: 13.16991) QuantErr: 13.16991 batch_time=0.66151 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 4.37423 (QuantReg: 13.04560) QuantErr: 13.04560 batch_time=0.65877 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 4.69559 (QuantReg: 12.93504) QuantErr: 12.93504 batch_time=0.64868 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 4.23657 (QuantReg: 13.00780) QuantErr: 13.00780 batch_time=0.68501 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 4.23377 (QuantReg: 13.05990) QuantErr: 13.05990 batch_time=0.66418 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 4.51515 (QuantReg: 12.58470) QuantErr: 12.58470 batch_time=0.64844 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 3.56479 (QuantReg: 12.94813) QuantErr: 12.94813 batch_time=0.65990 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 4.64696 (QuantReg: 12.86399) QuantErr: 12.86399 batch_time=0.67526 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 5.00728 (QuantReg: 12.99520) QuantErr: 12.99520 batch_time=0.67416 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 2.79350 (QuantReg: 13.16411) QuantErr: 13.16411 batch_time=0.65693 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 4.26635 (QuantReg: 12.69614) QuantErr: 12.69614 batch_time=0.67624 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 3.92173 (QuantReg: 12.79679) QuantErr: 12.79679 batch_time=0.69312 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 3.91665 (QuantReg: 12.83062) QuantErr: 12.83062 batch_time=0.80226 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 4.65823 (QuantReg: 12.78818) QuantErr: 12.78818 batch_time=0.78193 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 4.56085 (QuantReg: 12.75890) QuantErr: 12.75890 batch_time=0.68909 
Train Epoch: 22 codebook_update_time=3.52931
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch22.pth ...
Done in 5.499s
removing stale ckpt [epoch 21] [took 0.01s]
 epoch          : 22
 loss           : 4.210545825958252
 quant_reg      : 12.885624271392823
 quant_err      : 12.885624271392823
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.065
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.83029415504218
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.0035
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.820833017345414
 mnt_best       : 43.18794245111804
 not_improved_count: 1
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 5.16425 (QuantReg: 12.61114) QuantErr: 12.61114 batch_time=24.40814 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 4.14119 (QuantReg: 12.82527) QuantErr: 12.82527 batch_time=0.68691 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 4.35265 (QuantReg: 12.96901) QuantErr: 12.96901 batch_time=0.70561 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 4.14076 (QuantReg: 13.13158) QuantErr: 13.13158 batch_time=0.78002 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 4.04463 (QuantReg: 12.97902) QuantErr: 12.97902 batch_time=0.69370 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 3.83883 (QuantReg: 12.84461) QuantErr: 12.84461 batch_time=1.34377 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 3.87130 (QuantReg: 12.95849) QuantErr: 12.95849 batch_time=0.64492 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 3.84414 (QuantReg: 13.10699) QuantErr: 13.10699 batch_time=2.23942 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 3.61308 (QuantReg: 12.89134) QuantErr: 12.89134 batch_time=0.66574 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 4.65999 (QuantReg: 13.17321) QuantErr: 13.17321 batch_time=0.68304 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 4.06991 (QuantReg: 12.69650) QuantErr: 12.69650 batch_time=0.66056 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 4.48329 (QuantReg: 13.19910) QuantErr: 13.19910 batch_time=0.65178 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 3.86398 (QuantReg: 12.52985) QuantErr: 12.52985 batch_time=0.65629 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 3.67147 (QuantReg: 13.00214) QuantErr: 13.00214 batch_time=0.65137 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 3.43418 (QuantReg: 13.12012) QuantErr: 13.12012 batch_time=0.72046 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 3.84765 (QuantReg: 13.08610) QuantErr: 13.08610 batch_time=0.80241 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 4.59840 (QuantReg: 13.01181) QuantErr: 13.01181 batch_time=0.67951 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 5.24496 (QuantReg: 12.97384) QuantErr: 12.97384 batch_time=0.65751 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 4.25549 (QuantReg: 13.24537) QuantErr: 13.24537 batch_time=1.73790 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 4.12658 (QuantReg: 12.64450) QuantErr: 12.64450 batch_time=0.69026 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 4.35310 (QuantReg: 12.91115) QuantErr: 12.91115 batch_time=1.92487 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 4.59860 (QuantReg: 12.80231) QuantErr: 12.80231 batch_time=0.68155 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 3.84796 (QuantReg: 12.66308) QuantErr: 12.66308 batch_time=0.67077 
Train Epoch: 23 codebook_update_time=3.48393
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch23.pth ...
Done in 5.124s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 4.193672119140625
 quant_reg      : 12.933987503051759
 quant_err      : 12.933987503051759
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.633
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.05283715788236
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.781
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.59081305608103
 mnt_best       : 43.18794245111804
 not_improved_count: 2
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 4.19167 (QuantReg: 13.07066) QuantErr: 13.07066 batch_time=36.67373 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 4.65020 (QuantReg: 12.88502) QuantErr: 12.88502 batch_time=0.79885 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 4.46592 (QuantReg: 12.85598) QuantErr: 12.85598 batch_time=0.66355 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 5.08752 (QuantReg: 12.45303) QuantErr: 12.45303 batch_time=0.73449 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 3.64902 (QuantReg: 12.92602) QuantErr: 12.92602 batch_time=0.67511 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 3.99427 (QuantReg: 12.91627) QuantErr: 12.91627 batch_time=0.65992 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 3.69119 (QuantReg: 13.15472) QuantErr: 13.15472 batch_time=1.24021 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 3.29593 (QuantReg: 13.07330) QuantErr: 13.07330 batch_time=0.66829 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 4.06453 (QuantReg: 12.94300) QuantErr: 12.94300 batch_time=0.67649 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 4.12213 (QuantReg: 12.96662) QuantErr: 12.96662 batch_time=0.68940 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 3.53432 (QuantReg: 12.88041) QuantErr: 12.88041 batch_time=0.66593 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 3.39620 (QuantReg: 13.05824) QuantErr: 13.05824 batch_time=0.67950 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 4.58931 (QuantReg: 12.85906) QuantErr: 12.85906 batch_time=1.03498 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 3.99801 (QuantReg: 12.94420) QuantErr: 12.94420 batch_time=0.66818 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 3.61379 (QuantReg: 13.12193) QuantErr: 13.12193 batch_time=0.67762 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 3.87936 (QuantReg: 13.13566) QuantErr: 13.13566 batch_time=0.68176 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 4.93984 (QuantReg: 13.20841) QuantErr: 13.20841 batch_time=0.66655 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 3.87654 (QuantReg: 13.07005) QuantErr: 13.07005 batch_time=0.66918 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 4.10372 (QuantReg: 12.91467) QuantErr: 12.91467 batch_time=0.64403 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 4.26547 (QuantReg: 12.53729) QuantErr: 12.53729 batch_time=0.68540 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 4.36560 (QuantReg: 13.05985) QuantErr: 13.05985 batch_time=0.72719 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 4.62228 (QuantReg: 13.03248) QuantErr: 13.03248 batch_time=0.63679 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 4.71652 (QuantReg: 12.79491) QuantErr: 12.79491 batch_time=0.72530 
Train Epoch: 24 codebook_update_time=3.43476
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch24.pth ...
Done in 5.451s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch24.pth ...
Done in 10.464s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 4.104558972358704
 quant_reg      : 12.980744300842286
 quant_err      : 12.980744300842286
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.92
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.23701495759874
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.043
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.48276712031589
 mnt_best       : 43.23701495759874
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 4.04763 (QuantReg: 13.15049) QuantErr: 13.15049 batch_time=22.95497 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 3.00441 (QuantReg: 13.06985) QuantErr: 13.06985 batch_time=0.73970 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 4.15135 (QuantReg: 13.00817) QuantErr: 13.00817 batch_time=0.66670 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 3.43629 (QuantReg: 13.06194) QuantErr: 13.06194 batch_time=0.65152 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 4.47021 (QuantReg: 12.97038) QuantErr: 12.97038 batch_time=0.66456 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 4.11732 (QuantReg: 13.09038) QuantErr: 13.09038 batch_time=0.66196 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 4.40510 (QuantReg: 12.78319) QuantErr: 12.78319 batch_time=2.48643 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 3.54770 (QuantReg: 13.15407) QuantErr: 13.15407 batch_time=0.67915 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 3.42545 (QuantReg: 13.15054) QuantErr: 13.15054 batch_time=0.66835 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 4.64023 (QuantReg: 12.98507) QuantErr: 12.98507 batch_time=0.66516 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 3.28214 (QuantReg: 13.41441) QuantErr: 13.41441 batch_time=0.65507 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 3.53937 (QuantReg: 13.31604) QuantErr: 13.31604 batch_time=0.82237 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 4.34799 (QuantReg: 12.97351) QuantErr: 12.97351 batch_time=0.65297 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 4.30690 (QuantReg: 13.01643) QuantErr: 13.01643 batch_time=2.25249 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 4.49759 (QuantReg: 12.74286) QuantErr: 12.74286 batch_time=1.08387 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 4.40709 (QuantReg: 12.91148) QuantErr: 12.91148 batch_time=0.65137 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 4.51558 (QuantReg: 12.95552) QuantErr: 12.95552 batch_time=0.65082 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 4.09330 (QuantReg: 13.30605) QuantErr: 13.30605 batch_time=0.70382 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 3.64374 (QuantReg: 12.97308) QuantErr: 12.97308 batch_time=0.65996 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 3.29371 (QuantReg: 12.97770) QuantErr: 12.97770 batch_time=0.68529 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 3.68755 (QuantReg: 12.93857) QuantErr: 12.93857 batch_time=0.66528 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 2.63514 (QuantReg: 13.16720) QuantErr: 13.16720 batch_time=0.65775 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 3.32252 (QuantReg: 13.19350) QuantErr: 13.19350 batch_time=0.65700 
Train Epoch: 25 codebook_update_time=3.59660
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch25.pth ...
Done in 4.330s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch25.pth ...
Done in 9.290s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 4.117384480476379
 quant_reg      : 13.000533836364745
 quant_err      : 13.000533836364745
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.717
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.25377177615193
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.473
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.92869451336
 mnt_best       : 43.25377177615193
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 4.31283 (QuantReg: 12.75357) QuantErr: 12.75357 batch_time=29.89112 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 4.13105 (QuantReg: 12.77207) QuantErr: 12.77207 batch_time=0.65856 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 3.35093 (QuantReg: 12.75449) QuantErr: 12.75449 batch_time=0.71841 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 4.94620 (QuantReg: 12.74082) QuantErr: 12.74082 batch_time=0.67906 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 4.10567 (QuantReg: 12.99613) QuantErr: 12.99613 batch_time=0.66279 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 4.26487 (QuantReg: 12.85609) QuantErr: 12.85609 batch_time=0.68094 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 3.43597 (QuantReg: 12.80950) QuantErr: 12.80950 batch_time=1.57216 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 4.19079 (QuantReg: 12.97665) QuantErr: 12.97665 batch_time=2.53943 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 3.39755 (QuantReg: 12.99121) QuantErr: 12.99121 batch_time=0.65560 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 3.30233 (QuantReg: 12.91433) QuantErr: 12.91433 batch_time=0.68308 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 4.02871 (QuantReg: 13.03416) QuantErr: 13.03416 batch_time=0.68255 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 4.64306 (QuantReg: 13.04067) QuantErr: 13.04067 batch_time=0.69784 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 3.67134 (QuantReg: 12.84472) QuantErr: 12.84472 batch_time=0.98325 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 4.02228 (QuantReg: 12.90938) QuantErr: 12.90938 batch_time=0.79112 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 3.32872 (QuantReg: 13.38116) QuantErr: 13.38116 batch_time=0.73300 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 4.78947 (QuantReg: 12.89466) QuantErr: 12.89466 batch_time=0.66430 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 3.99510 (QuantReg: 13.42745) QuantErr: 13.42745 batch_time=0.70345 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 2.62382 (QuantReg: 12.87932) QuantErr: 12.87932 batch_time=0.69848 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 5.05450 (QuantReg: 12.60923) QuantErr: 12.60923 batch_time=1.26713 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 4.27406 (QuantReg: 12.79809) QuantErr: 12.79809 batch_time=0.71086 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 4.39386 (QuantReg: 12.78469) QuantErr: 12.78469 batch_time=0.68753 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 4.01219 (QuantReg: 13.09410) QuantErr: 13.09410 batch_time=0.69986 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 3.64540 (QuantReg: 12.80093) QuantErr: 12.80093 batch_time=0.69641 
Train Epoch: 26 codebook_update_time=3.82802
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch26.pth ...
Done in 4.963s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch26.pth ...
Done in 10.051s
removing stale ckpt [epoch 25] [took 0.04s]
 epoch          : 26
 loss           : 3.997755771636963
 quant_reg      : 12.990590873718261
 quant_err      : 12.990590873718261
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.902
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.347563505292186
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.69
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.025186681701584
 mnt_best       : 43.347563505292186
 not_improved_count: 0
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 4.97117 (QuantReg: 12.74538) QuantErr: 12.74538 batch_time=29.07788 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 5.71050 (QuantReg: 12.60645) QuantErr: 12.60645 batch_time=0.66774 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 4.56021 (QuantReg: 13.15075) QuantErr: 13.15075 batch_time=0.67068 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 4.88217 (QuantReg: 13.01622) QuantErr: 13.01622 batch_time=0.66904 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 3.92596 (QuantReg: 13.15586) QuantErr: 13.15586 batch_time=0.67443 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 3.78636 (QuantReg: 13.34062) QuantErr: 13.34062 batch_time=0.65226 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 2.94879 (QuantReg: 12.97339) QuantErr: 12.97339 batch_time=0.67476 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 3.65908 (QuantReg: 13.10083) QuantErr: 13.10083 batch_time=2.56915 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 3.42730 (QuantReg: 13.23191) QuantErr: 13.23191 batch_time=0.65703 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 3.38176 (QuantReg: 12.81585) QuantErr: 12.81585 batch_time=2.13690 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 3.68874 (QuantReg: 13.13246) QuantErr: 13.13246 batch_time=0.76746 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 3.17052 (QuantReg: 13.22966) QuantErr: 13.22966 batch_time=0.75922 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 4.17045 (QuantReg: 12.82644) QuantErr: 12.82644 batch_time=1.53722 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 3.64411 (QuantReg: 13.09340) QuantErr: 13.09340 batch_time=0.74693 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 5.77185 (QuantReg: 13.01853) QuantErr: 13.01853 batch_time=0.99517 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 4.67670 (QuantReg: 13.14951) QuantErr: 13.14951 batch_time=0.68588 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 3.09201 (QuantReg: 12.83103) QuantErr: 12.83103 batch_time=0.66401 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 4.61180 (QuantReg: 13.19205) QuantErr: 13.19205 batch_time=0.66181 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 4.05187 (QuantReg: 12.92291) QuantErr: 12.92291 batch_time=1.32511 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 3.62403 (QuantReg: 13.47959) QuantErr: 13.47959 batch_time=0.66209 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 4.02005 (QuantReg: 13.02820) QuantErr: 13.02820 batch_time=0.65625 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 4.11492 (QuantReg: 12.97131) QuantErr: 12.97131 batch_time=0.72477 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 4.29674 (QuantReg: 12.98603) QuantErr: 12.98603 batch_time=0.67525 
Train Epoch: 27 codebook_update_time=3.58494
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch27.pth ...
Done in 4.996s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 3.9620454177856446
 quant_reg      : 13.022830085754395
 quant_err      : 13.022830085754395
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.995
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.8028464930731
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4565
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.058256167904
 mnt_best       : 43.347563505292186
 not_improved_count: 1
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 3.92539 (QuantReg: 13.03959) QuantErr: 13.03959 batch_time=23.96393 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 3.77057 (QuantReg: 12.68161) QuantErr: 12.68161 batch_time=0.65847 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 3.91839 (QuantReg: 12.75138) QuantErr: 12.75138 batch_time=0.66883 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 3.20076 (QuantReg: 12.76553) QuantErr: 12.76553 batch_time=0.65838 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 2.97798 (QuantReg: 13.18368) QuantErr: 13.18368 batch_time=0.65754 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 3.18474 (QuantReg: 13.05863) QuantErr: 13.05863 batch_time=0.86396 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 3.52303 (QuantReg: 12.95994) QuantErr: 12.95994 batch_time=0.98082 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 3.04719 (QuantReg: 12.78132) QuantErr: 12.78132 batch_time=0.66483 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 4.58241 (QuantReg: 12.88561) QuantErr: 12.88561 batch_time=0.66770 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 3.63374 (QuantReg: 12.71327) QuantErr: 12.71327 batch_time=0.76144 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 3.87275 (QuantReg: 13.14418) QuantErr: 13.14418 batch_time=0.65851 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 5.51445 (QuantReg: 12.94129) QuantErr: 12.94129 batch_time=0.68606 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 4.21378 (QuantReg: 12.92688) QuantErr: 12.92688 batch_time=0.65781 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 3.35366 (QuantReg: 13.06234) QuantErr: 13.06234 batch_time=0.66952 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 3.91044 (QuantReg: 13.08511) QuantErr: 13.08511 batch_time=0.65191 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 4.50193 (QuantReg: 13.06349) QuantErr: 13.06349 batch_time=0.70620 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 4.00279 (QuantReg: 12.82150) QuantErr: 12.82150 batch_time=0.82194 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 4.69542 (QuantReg: 12.80005) QuantErr: 12.80005 batch_time=0.64350 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 4.37939 (QuantReg: 12.81422) QuantErr: 12.81422 batch_time=0.68544 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 4.07132 (QuantReg: 13.16420) QuantErr: 13.16420 batch_time=0.67817 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 2.93451 (QuantReg: 13.26848) QuantErr: 13.26848 batch_time=0.71184 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 4.10718 (QuantReg: 13.18946) QuantErr: 13.18946 batch_time=0.81068 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 4.92236 (QuantReg: 13.20594) QuantErr: 13.20594 batch_time=0.67741 
Train Epoch: 28 codebook_update_time=3.89298
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch28.pth ...
Done in 4.088s
removing stale ckpt [epoch 27] [took 0.05s]
 epoch          : 28
 loss           : 3.875230179786682
 quant_reg      : 13.001105583190919
 quant_err      : 13.001105583190919
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.937
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.00956989092137
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.994
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.40376155129187
 mnt_best       : 43.347563505292186
 not_improved_count: 2
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 4.05113 (QuantReg: 12.94114) QuantErr: 12.94114 batch_time=21.45103 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 3.05510 (QuantReg: 13.19721) QuantErr: 13.19721 batch_time=0.66509 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 4.02804 (QuantReg: 13.12429) QuantErr: 13.12429 batch_time=0.68749 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 4.37751 (QuantReg: 12.58525) QuantErr: 12.58525 batch_time=0.71797 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 2.86014 (QuantReg: 13.28697) QuantErr: 13.28697 batch_time=0.68480 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 3.83301 (QuantReg: 12.95938) QuantErr: 12.95938 batch_time=0.66024 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 3.46942 (QuantReg: 12.99947) QuantErr: 12.99947 batch_time=0.75742 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 3.32396 (QuantReg: 13.03989) QuantErr: 13.03989 batch_time=0.65894 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 3.75022 (QuantReg: 13.22992) QuantErr: 13.22992 batch_time=0.66838 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 4.50465 (QuantReg: 13.00044) QuantErr: 13.00044 batch_time=0.66457 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 3.81304 (QuantReg: 13.38754) QuantErr: 13.38754 batch_time=0.65737 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 4.54042 (QuantReg: 13.12265) QuantErr: 13.12265 batch_time=0.68210 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 3.79170 (QuantReg: 13.13433) QuantErr: 13.13433 batch_time=0.64883 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 4.07622 (QuantReg: 12.96982) QuantErr: 12.96982 batch_time=4.14038 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 3.80941 (QuantReg: 13.59526) QuantErr: 13.59526 batch_time=0.67572 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 4.04390 (QuantReg: 13.30066) QuantErr: 13.30066 batch_time=0.66209 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 3.48055 (QuantReg: 12.75266) QuantErr: 12.75266 batch_time=0.71187 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 4.80762 (QuantReg: 13.17385) QuantErr: 13.17385 batch_time=0.66979 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 3.97746 (QuantReg: 13.24427) QuantErr: 13.24427 batch_time=0.72923 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 3.51679 (QuantReg: 12.94707) QuantErr: 12.94707 batch_time=0.66792 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 3.35897 (QuantReg: 13.10351) QuantErr: 13.10351 batch_time=0.76446 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 4.02464 (QuantReg: 13.10986) QuantErr: 13.10986 batch_time=0.67674 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 3.27111 (QuantReg: 13.05194) QuantErr: 13.05194 batch_time=0.66622 
Train Epoch: 29 codebook_update_time=3.78170
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch29.pth ...
Done in 4.276s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch29.pth ...
Done in 8.177s
removing stale ckpt [epoch 28] [took 0.12s]
 epoch          : 29
 loss           : 3.8128038053512574
 quant_reg      : 13.052746139526366
 quant_err      : 13.052746139526366
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.663
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.72993583380277
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.2315
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.93467096537338
 mnt_best       : 43.72993583380277
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 4.60756 (QuantReg: 12.62716) QuantErr: 12.62716 batch_time=38.97257 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 3.43856 (QuantReg: 13.13066) QuantErr: 13.13066 batch_time=0.66333 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 4.54218 (QuantReg: 13.08049) QuantErr: 13.08049 batch_time=0.66806 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 4.10634 (QuantReg: 13.07472) QuantErr: 13.07472 batch_time=0.68022 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 5.52790 (QuantReg: 12.93795) QuantErr: 12.93795 batch_time=0.65624 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 3.98298 (QuantReg: 13.15390) QuantErr: 13.15390 batch_time=0.68645 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 3.58980 (QuantReg: 13.09868) QuantErr: 13.09868 batch_time=0.72888 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 4.20941 (QuantReg: 12.88170) QuantErr: 12.88170 batch_time=0.65084 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 2.86191 (QuantReg: 13.21275) QuantErr: 13.21275 batch_time=0.66910 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 3.87210 (QuantReg: 13.27833) QuantErr: 13.27833 batch_time=0.68256 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 3.56247 (QuantReg: 13.08139) QuantErr: 13.08139 batch_time=0.68514 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 3.81567 (QuantReg: 13.28301) QuantErr: 13.28301 batch_time=0.67241 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 4.09261 (QuantReg: 13.08772) QuantErr: 13.08772 batch_time=0.65957 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 3.75398 (QuantReg: 12.94632) QuantErr: 12.94632 batch_time=1.51496 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 3.35398 (QuantReg: 13.10775) QuantErr: 13.10775 batch_time=0.64317 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 4.18561 (QuantReg: 13.16799) QuantErr: 13.16799 batch_time=0.68142 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 3.82658 (QuantReg: 12.93007) QuantErr: 12.93007 batch_time=1.17391 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 3.44740 (QuantReg: 13.19549) QuantErr: 13.19549 batch_time=0.65223 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 4.30820 (QuantReg: 12.93976) QuantErr: 12.93976 batch_time=0.71362 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 3.37971 (QuantReg: 12.95458) QuantErr: 12.95458 batch_time=0.66305 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 3.90999 (QuantReg: 13.20553) QuantErr: 13.20553 batch_time=0.69085 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 4.07262 (QuantReg: 12.76976) QuantErr: 12.76976 batch_time=0.66560 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 3.65104 (QuantReg: 13.32903) QuantErr: 13.32903 batch_time=0.65143 
Train Epoch: 30 codebook_update_time=3.58617
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch30.pth ...
Done in 4.380s
removing stale ckpt [epoch 29] [took 0.01s]
 epoch          : 30
 loss           : 3.8243320665359497
 quant_reg      : 13.092542228698731
 quant_err      : 13.092542228698731
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.435
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.218619802670375
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.2595
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.289033832730645
 mnt_best       : 43.72993583380277
 not_improved_count: 1
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 3.98045 (QuantReg: 12.90572) QuantErr: 12.90572 batch_time=23.68908 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 3.56093 (QuantReg: 13.14416) QuantErr: 13.14416 batch_time=0.81227 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 3.70695 (QuantReg: 12.95510) QuantErr: 12.95510 batch_time=0.67861 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 3.13434 (QuantReg: 13.05279) QuantErr: 13.05279 batch_time=0.70660 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 3.04855 (QuantReg: 13.42382) QuantErr: 13.42382 batch_time=0.67845 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 2.97817 (QuantReg: 13.01636) QuantErr: 13.01636 batch_time=0.64867 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 4.80001 (QuantReg: 12.82149) QuantErr: 12.82149 batch_time=0.66329 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 4.14549 (QuantReg: 12.82049) QuantErr: 12.82049 batch_time=0.66428 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 3.76838 (QuantReg: 13.18029) QuantErr: 13.18029 batch_time=0.68453 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 4.66044 (QuantReg: 12.79795) QuantErr: 12.79795 batch_time=0.64805 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 3.53687 (QuantReg: 12.86482) QuantErr: 12.86482 batch_time=0.66213 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 3.42428 (QuantReg: 13.28503) QuantErr: 13.28503 batch_time=0.66131 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 4.07062 (QuantReg: 13.06208) QuantErr: 13.06208 batch_time=0.69951 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 4.69435 (QuantReg: 13.02678) QuantErr: 13.02678 batch_time=0.65168 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 4.29024 (QuantReg: 13.21215) QuantErr: 13.21215 batch_time=0.68139 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 3.30639 (QuantReg: 12.81862) QuantErr: 12.81862 batch_time=0.68968 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 3.12430 (QuantReg: 13.01672) QuantErr: 13.01672 batch_time=0.72280 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 3.45200 (QuantReg: 13.05604) QuantErr: 13.05604 batch_time=0.84225 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 3.87265 (QuantReg: 13.00264) QuantErr: 13.00264 batch_time=5.45930 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 4.17975 (QuantReg: 13.02397) QuantErr: 13.02397 batch_time=0.65896 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 5.63732 (QuantReg: 13.20707) QuantErr: 13.20707 batch_time=0.66224 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 4.12516 (QuantReg: 13.16201) QuantErr: 13.16201 batch_time=1.19453 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 3.53076 (QuantReg: 13.00279) QuantErr: 13.00279 batch_time=0.67730 
Train Epoch: 31 codebook_update_time=3.86908
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch31.pth ...
Done in 3.948s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch31.pth ...
Done in 7.867s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 3.792232123374939
 quant_reg      : 13.052667030334472
 quant_err      : 13.052667030334472
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.915
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.818369726320306
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.024
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.576341960929106
 mnt_best       : 43.818369726320306
 not_improved_count: 0
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 2.91171 (QuantReg: 13.02689) QuantErr: 13.02689 batch_time=23.06492 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 3.77050 (QuantReg: 13.22943) QuantErr: 13.22943 batch_time=0.67706 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 3.05857 (QuantReg: 13.27934) QuantErr: 13.27934 batch_time=2.27845 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 3.63011 (QuantReg: 13.06871) QuantErr: 13.06871 batch_time=0.65611 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 3.76024 (QuantReg: 13.01759) QuantErr: 13.01759 batch_time=0.67607 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 3.63375 (QuantReg: 13.14564) QuantErr: 13.14564 batch_time=0.94750 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 3.56787 (QuantReg: 13.35928) QuantErr: 13.35928 batch_time=0.69892 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 5.37509 (QuantReg: 13.09252) QuantErr: 13.09252 batch_time=1.93885 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 3.92381 (QuantReg: 12.88687) QuantErr: 12.88687 batch_time=0.69364 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 4.18889 (QuantReg: 12.74355) QuantErr: 12.74355 batch_time=0.68860 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 4.18641 (QuantReg: 13.13790) QuantErr: 13.13790 batch_time=0.71680 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 3.40639 (QuantReg: 13.11672) QuantErr: 13.11672 batch_time=0.66596 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 3.51657 (QuantReg: 12.86980) QuantErr: 12.86980 batch_time=1.00955 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 3.55591 (QuantReg: 13.12893) QuantErr: 13.12893 batch_time=2.24607 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 3.65394 (QuantReg: 12.81072) QuantErr: 12.81072 batch_time=0.67746 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 3.58519 (QuantReg: 13.41056) QuantErr: 13.41056 batch_time=0.69863 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 5.14694 (QuantReg: 12.71534) QuantErr: 12.71534 batch_time=0.65710 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 3.81602 (QuantReg: 13.05705) QuantErr: 13.05705 batch_time=0.66375 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 4.18611 (QuantReg: 13.06687) QuantErr: 13.06687 batch_time=0.96432 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 4.24687 (QuantReg: 13.03586) QuantErr: 13.03586 batch_time=0.67164 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 3.22611 (QuantReg: 13.26184) QuantErr: 13.26184 batch_time=0.72463 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 4.20203 (QuantReg: 13.21761) QuantErr: 13.21761 batch_time=0.67643 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 2.78603 (QuantReg: 13.25694) QuantErr: 13.25694 batch_time=0.66728 
Train Epoch: 32 codebook_update_time=3.42680
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch32.pth ...
Done in 4.794s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch32.pth ...
Done in 9.445s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 3.7694755449295045
 quant_reg      : 13.101485012054443
 quant_err      : 13.101485012054443
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.115
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.06217106539819
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.14
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.79617480360765
 mnt_best       : 44.06217106539819
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 4.80197 (QuantReg: 12.94839) QuantErr: 12.94839 batch_time=29.26861 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 3.89289 (QuantReg: 13.45817) QuantErr: 13.45817 batch_time=0.69149 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 4.35665 (QuantReg: 13.06951) QuantErr: 13.06951 batch_time=0.66322 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 3.79432 (QuantReg: 13.44127) QuantErr: 13.44127 batch_time=0.69466 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 4.90926 (QuantReg: 12.95056) QuantErr: 12.95056 batch_time=0.75520 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 3.73204 (QuantReg: 13.28216) QuantErr: 13.28216 batch_time=0.67573 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 4.06935 (QuantReg: 12.65425) QuantErr: 12.65425 batch_time=1.42589 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 3.29532 (QuantReg: 13.41624) QuantErr: 13.41624 batch_time=0.68872 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 3.87826 (QuantReg: 13.07891) QuantErr: 13.07891 batch_time=0.64669 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 3.52166 (QuantReg: 13.10094) QuantErr: 13.10094 batch_time=0.65555 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 3.71081 (QuantReg: 13.21340) QuantErr: 13.21340 batch_time=0.71364 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 4.94572 (QuantReg: 12.88264) QuantErr: 12.88264 batch_time=1.01249 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 3.31925 (QuantReg: 13.07352) QuantErr: 13.07352 batch_time=0.65440 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 4.01797 (QuantReg: 13.38281) QuantErr: 13.38281 batch_time=2.48829 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 2.88033 (QuantReg: 13.36958) QuantErr: 13.36958 batch_time=0.66511 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 3.10963 (QuantReg: 13.32510) QuantErr: 13.32510 batch_time=0.66927 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 3.61352 (QuantReg: 13.02010) QuantErr: 13.02010 batch_time=0.65686 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 3.57123 (QuantReg: 13.14512) QuantErr: 13.14512 batch_time=0.65062 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 3.88052 (QuantReg: 13.14229) QuantErr: 13.14229 batch_time=0.65875 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 3.25874 (QuantReg: 13.13026) QuantErr: 13.13026 batch_time=0.65503 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 3.40921 (QuantReg: 13.07052) QuantErr: 13.07052 batch_time=0.72288 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 4.10076 (QuantReg: 13.03254) QuantErr: 13.03254 batch_time=0.71093 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 2.87567 (QuantReg: 12.95183) QuantErr: 12.95183 batch_time=0.65284 
Train Epoch: 33 codebook_update_time=3.34351
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch33.pth ...
Done in 4.102s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch33.pth ...
Done in 8.090s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 3.7210121755599976
 quant_reg      : 13.113783218383789
 quant_err      : 13.113783218383789
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.659
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.21671136343357
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.7635
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.99876441051851
 mnt_best       : 44.21671136343357
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 4.32429 (QuantReg: 13.03201) QuantErr: 13.03201 batch_time=22.75592 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 3.17327 (QuantReg: 12.93031) QuantErr: 12.93031 batch_time=0.91758 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 4.40478 (QuantReg: 13.13141) QuantErr: 13.13141 batch_time=0.69475 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 3.85094 (QuantReg: 13.01906) QuantErr: 13.01906 batch_time=0.67354 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 4.14702 (QuantReg: 13.01668) QuantErr: 13.01668 batch_time=0.66121 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 3.53782 (QuantReg: 13.42694) QuantErr: 13.42694 batch_time=0.73215 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 3.23025 (QuantReg: 13.27081) QuantErr: 13.27081 batch_time=1.00921 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 3.63410 (QuantReg: 13.02058) QuantErr: 13.02058 batch_time=0.67302 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 4.35073 (QuantReg: 13.41359) QuantErr: 13.41359 batch_time=0.67714 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 3.72309 (QuantReg: 13.15070) QuantErr: 13.15070 batch_time=0.65183 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 3.33705 (QuantReg: 12.93995) QuantErr: 12.93995 batch_time=0.64736 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 3.79808 (QuantReg: 12.93459) QuantErr: 12.93459 batch_time=0.68659 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 4.13153 (QuantReg: 13.06046) QuantErr: 13.06046 batch_time=0.77946 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 4.09460 (QuantReg: 13.17655) QuantErr: 13.17655 batch_time=4.58026 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 4.49747 (QuantReg: 13.02636) QuantErr: 13.02636 batch_time=0.66262 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 3.71323 (QuantReg: 12.95770) QuantErr: 12.95770 batch_time=0.67102 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 3.60460 (QuantReg: 13.04552) QuantErr: 13.04552 batch_time=0.67961 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 3.17951 (QuantReg: 12.86771) QuantErr: 12.86771 batch_time=0.67442 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 3.57521 (QuantReg: 13.10394) QuantErr: 13.10394 batch_time=0.92043 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 3.99147 (QuantReg: 13.30912) QuantErr: 13.30912 batch_time=0.66426 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 3.95745 (QuantReg: 12.79830) QuantErr: 12.79830 batch_time=0.65528 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 3.44284 (QuantReg: 13.34672) QuantErr: 13.34672 batch_time=0.67034 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 3.78113 (QuantReg: 13.49057) QuantErr: 13.49057 batch_time=0.68394 
Train Epoch: 34 codebook_update_time=3.60472
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch34.pth ...
Done in 16.133s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch34.pth ...
Done in 20.945s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 3.7581263084411622
 quant_reg      : 13.118299156188964
 quant_err      : 13.118299156188964
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.376
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.685895584564065
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4745
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.58853090440791
 mnt_best       : 44.685895584564065
 not_improved_count: 0
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 3.85949 (QuantReg: 13.12773) QuantErr: 13.12773 batch_time=24.25155 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 4.08910 (QuantReg: 12.90786) QuantErr: 12.90786 batch_time=0.65306 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 4.10824 (QuantReg: 12.97996) QuantErr: 12.97996 batch_time=2.40963 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 3.03882 (QuantReg: 13.13510) QuantErr: 13.13510 batch_time=0.65679 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 3.39705 (QuantReg: 13.32048) QuantErr: 13.32048 batch_time=0.73169 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 3.61827 (QuantReg: 12.92331) QuantErr: 12.92331 batch_time=0.69799 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 3.30622 (QuantReg: 13.16005) QuantErr: 13.16005 batch_time=0.77314 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 3.25710 (QuantReg: 13.38745) QuantErr: 13.38745 batch_time=0.64598 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 3.50377 (QuantReg: 13.44874) QuantErr: 13.44874 batch_time=1.44546 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 3.84942 (QuantReg: 13.34852) QuantErr: 13.34852 batch_time=0.66246 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 4.22838 (QuantReg: 13.08955) QuantErr: 13.08955 batch_time=0.64849 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 3.21233 (QuantReg: 13.18369) QuantErr: 13.18369 batch_time=0.65321 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 4.01646 (QuantReg: 13.18597) QuantErr: 13.18597 batch_time=3.12507 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 3.97073 (QuantReg: 13.18238) QuantErr: 13.18238 batch_time=0.64100 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 2.99736 (QuantReg: 13.11950) QuantErr: 13.11950 batch_time=0.68390 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 3.74766 (QuantReg: 13.02776) QuantErr: 13.02776 batch_time=0.66481 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 3.25579 (QuantReg: 13.51674) QuantErr: 13.51674 batch_time=0.65032 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 4.35337 (QuantReg: 12.84603) QuantErr: 12.84603 batch_time=1.10437 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 3.76140 (QuantReg: 13.09186) QuantErr: 13.09186 batch_time=0.67188 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 2.85300 (QuantReg: 13.22870) QuantErr: 13.22870 batch_time=0.66515 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 3.73135 (QuantReg: 13.08984) QuantErr: 13.08984 batch_time=1.61476 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 3.32837 (QuantReg: 13.26230) QuantErr: 13.26230 batch_time=0.69555 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 3.49539 (QuantReg: 13.26913) QuantErr: 13.26913 batch_time=0.64881 
Train Epoch: 35 codebook_update_time=3.54196
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch35.pth ...
Done in 13.641s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 3.6370862770080565
 quant_reg      : 13.147683605194091
 quant_err      : 13.147683605194091
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.745
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.11172707598186
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.896
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.71935108677604
 mnt_best       : 44.685895584564065
 not_improved_count: 1
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 3.91918 (QuantReg: 13.01002) QuantErr: 13.01002 batch_time=23.47960 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 4.30613 (QuantReg: 13.01030) QuantErr: 13.01030 batch_time=0.67213 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 3.65252 (QuantReg: 13.15344) QuantErr: 13.15344 batch_time=0.71855 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 3.50777 (QuantReg: 13.17984) QuantErr: 13.17984 batch_time=0.67098 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 3.78578 (QuantReg: 12.78759) QuantErr: 12.78759 batch_time=0.68885 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 3.51630 (QuantReg: 13.10880) QuantErr: 13.10880 batch_time=0.75658 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 4.35110 (QuantReg: 12.95847) QuantErr: 12.95847 batch_time=0.66602 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 3.58162 (QuantReg: 13.24367) QuantErr: 13.24367 batch_time=0.69601 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 4.46354 (QuantReg: 13.00094) QuantErr: 13.00094 batch_time=2.00699 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 3.49796 (QuantReg: 13.14577) QuantErr: 13.14577 batch_time=0.65643 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 3.88776 (QuantReg: 13.36250) QuantErr: 13.36250 batch_time=0.72141 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 3.29480 (QuantReg: 13.02050) QuantErr: 13.02050 batch_time=0.66837 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 3.46669 (QuantReg: 13.32062) QuantErr: 13.32062 batch_time=0.72237 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 3.84498 (QuantReg: 12.93495) QuantErr: 12.93495 batch_time=0.68954 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 2.63270 (QuantReg: 13.26360) QuantErr: 13.26360 batch_time=0.66826 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 3.12978 (QuantReg: 13.31053) QuantErr: 13.31053 batch_time=0.67720 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 3.49309 (QuantReg: 13.42879) QuantErr: 13.42879 batch_time=0.65128 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 3.50658 (QuantReg: 13.52847) QuantErr: 13.52847 batch_time=0.64656 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 3.95031 (QuantReg: 13.05299) QuantErr: 13.05299 batch_time=0.65928 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 3.86797 (QuantReg: 13.41256) QuantErr: 13.41256 batch_time=0.69291 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 3.51985 (QuantReg: 13.48239) QuantErr: 13.48239 batch_time=0.69082 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 4.67191 (QuantReg: 13.18719) QuantErr: 13.18719 batch_time=0.80494 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 4.11814 (QuantReg: 13.31006) QuantErr: 13.31006 batch_time=0.66754 
Train Epoch: 36 codebook_update_time=3.51696
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch36.pth ...
Done in 4.389s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch36.pth ...
Done in 8.861s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 3.6887067356109617
 quant_reg      : 13.181086059570312
 quant_err      : 13.181086059570312
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.15
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.756260455966256
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.7945
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.8275208242262
 mnt_best       : 44.756260455966256
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 3.37855 (QuantReg: 13.34233) QuantErr: 13.34233 batch_time=27.97199 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 3.01758 (QuantReg: 12.80218) QuantErr: 12.80218 batch_time=0.68322 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 4.19352 (QuantReg: 12.92408) QuantErr: 12.92408 batch_time=0.71786 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 3.45162 (QuantReg: 13.29949) QuantErr: 13.29949 batch_time=0.67383 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 3.36654 (QuantReg: 13.23797) QuantErr: 13.23797 batch_time=0.65722 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 4.21835 (QuantReg: 12.54923) QuantErr: 12.54923 batch_time=0.67695 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 3.92718 (QuantReg: 12.79972) QuantErr: 12.79972 batch_time=0.67677 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 4.15615 (QuantReg: 13.33037) QuantErr: 13.33037 batch_time=0.71954 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 4.19074 (QuantReg: 13.04642) QuantErr: 13.04642 batch_time=0.80286 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 3.53244 (QuantReg: 13.03080) QuantErr: 13.03080 batch_time=0.66484 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 3.33018 (QuantReg: 13.27368) QuantErr: 13.27368 batch_time=0.66283 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 3.39177 (QuantReg: 12.72996) QuantErr: 12.72996 batch_time=0.67016 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 3.47215 (QuantReg: 13.24375) QuantErr: 13.24375 batch_time=1.97027 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 3.83064 (QuantReg: 13.39291) QuantErr: 13.39291 batch_time=0.65662 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 3.89759 (QuantReg: 12.80593) QuantErr: 12.80593 batch_time=0.73023 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 3.09957 (QuantReg: 13.24990) QuantErr: 13.24990 batch_time=0.70380 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 3.02720 (QuantReg: 13.17737) QuantErr: 13.17737 batch_time=0.65168 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 3.86277 (QuantReg: 13.15242) QuantErr: 13.15242 batch_time=0.86157 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 3.73937 (QuantReg: 13.26917) QuantErr: 13.26917 batch_time=0.66289 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 3.38293 (QuantReg: 13.34493) QuantErr: 13.34493 batch_time=0.74946 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 2.99228 (QuantReg: 13.33575) QuantErr: 13.33575 batch_time=1.24301 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 2.77102 (QuantReg: 13.01182) QuantErr: 13.01182 batch_time=0.67591 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 3.63906 (QuantReg: 13.04268) QuantErr: 13.04268 batch_time=0.67378 
Train Epoch: 37 codebook_update_time=3.43811
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch37.pth ...
Done in 4.823s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 3.6672298645973207
 quant_reg      : 13.180733837127686
 quant_err      : 13.180733837127686
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.167
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.50874246447593
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.6235
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.98627795602098
 mnt_best       : 44.756260455966256
 not_improved_count: 1
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 3.86735 (QuantReg: 13.09450) QuantErr: 13.09450 batch_time=27.44984 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 3.18289 (QuantReg: 12.87639) QuantErr: 12.87639 batch_time=0.66795 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 3.49781 (QuantReg: 13.45047) QuantErr: 13.45047 batch_time=0.65627 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 4.06545 (QuantReg: 12.94401) QuantErr: 12.94401 batch_time=0.65968 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 3.95738 (QuantReg: 13.26950) QuantErr: 13.26950 batch_time=0.64613 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 3.74616 (QuantReg: 12.82013) QuantErr: 12.82013 batch_time=0.65239 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 3.94835 (QuantReg: 13.22092) QuantErr: 13.22092 batch_time=0.94830 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 3.85097 (QuantReg: 13.35831) QuantErr: 13.35831 batch_time=0.65225 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 3.45647 (QuantReg: 13.27571) QuantErr: 13.27571 batch_time=0.67503 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 3.76340 (QuantReg: 13.52757) QuantErr: 13.52757 batch_time=0.72263 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 4.22386 (QuantReg: 13.70179) QuantErr: 13.70179 batch_time=0.68547 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 2.74472 (QuantReg: 13.14620) QuantErr: 13.14620 batch_time=0.67674 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 4.11012 (QuantReg: 13.23534) QuantErr: 13.23534 batch_time=2.30782 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 3.14607 (QuantReg: 13.17658) QuantErr: 13.17658 batch_time=2.91395 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 3.22946 (QuantReg: 13.16076) QuantErr: 13.16076 batch_time=0.73021 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 2.76466 (QuantReg: 13.39339) QuantErr: 13.39339 batch_time=0.68502 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 4.18108 (QuantReg: 13.14104) QuantErr: 13.14104 batch_time=0.75416 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 3.33533 (QuantReg: 13.03804) QuantErr: 13.03804 batch_time=0.64880 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 3.15641 (QuantReg: 13.14949) QuantErr: 13.14949 batch_time=0.67695 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 3.76865 (QuantReg: 13.21181) QuantErr: 13.21181 batch_time=0.65020 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 3.58442 (QuantReg: 13.38621) QuantErr: 13.38621 batch_time=0.67032 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 4.18676 (QuantReg: 13.14466) QuantErr: 13.14466 batch_time=0.65443 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 3.09363 (QuantReg: 13.27691) QuantErr: 13.27691 batch_time=0.65128 
Train Epoch: 38 codebook_update_time=3.93706
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch38.pth ...
Done in 4.778s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 38
 loss           : 3.6366833181381226
 quant_reg      : 13.21267998123169
 quant_err      : 13.21267998123169
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.819
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.61221705437939
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.1025
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.82324739452438
 mnt_best       : 44.756260455966256
 not_improved_count: 2
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 5.14902 (QuantReg: 12.98760) QuantErr: 12.98760 batch_time=28.54739 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 4.57697 (QuantReg: 12.99275) QuantErr: 12.99275 batch_time=0.67515 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 3.70865 (QuantReg: 13.17222) QuantErr: 13.17222 batch_time=0.65906 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 3.31617 (QuantReg: 13.39762) QuantErr: 13.39762 batch_time=0.70451 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 3.75639 (QuantReg: 13.40835) QuantErr: 13.40835 batch_time=0.66855 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 3.42439 (QuantReg: 13.10962) QuantErr: 13.10962 batch_time=0.67308 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 3.77565 (QuantReg: 12.98851) QuantErr: 12.98851 batch_time=0.65591 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 3.82968 (QuantReg: 13.20919) QuantErr: 13.20919 batch_time=0.69410 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 3.44071 (QuantReg: 13.31531) QuantErr: 13.31531 batch_time=0.70410 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 3.73799 (QuantReg: 13.51230) QuantErr: 13.51230 batch_time=0.68154 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 2.87246 (QuantReg: 13.17349) QuantErr: 13.17349 batch_time=0.67374 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 3.74074 (QuantReg: 13.00268) QuantErr: 13.00268 batch_time=0.70872 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 3.71591 (QuantReg: 13.19613) QuantErr: 13.19613 batch_time=0.70255 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 3.50442 (QuantReg: 12.91695) QuantErr: 12.91695 batch_time=0.66869 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 3.79966 (QuantReg: 13.25173) QuantErr: 13.25173 batch_time=0.67961 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 3.28390 (QuantReg: 13.33320) QuantErr: 13.33320 batch_time=0.66996 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 3.85143 (QuantReg: 13.49294) QuantErr: 13.49294 batch_time=1.72824 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 4.79844 (QuantReg: 13.45731) QuantErr: 13.45731 batch_time=0.72302 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 4.11612 (QuantReg: 13.20054) QuantErr: 13.20054 batch_time=0.64364 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 3.65900 (QuantReg: 13.40081) QuantErr: 13.40081 batch_time=0.73703 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 3.33595 (QuantReg: 13.32071) QuantErr: 13.32071 batch_time=0.64318 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 3.16383 (QuantReg: 13.11850) QuantErr: 13.11850 batch_time=0.68098 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 4.22180 (QuantReg: 13.09018) QuantErr: 13.09018 batch_time=0.66756 
Train Epoch: 39 codebook_update_time=3.88923
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch39.pth ...
Done in 5.501s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 3.672259258270264
 quant_reg      : 13.204503116607667
 quant_err      : 13.204503116607667
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.524
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.1378596218313
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.208
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.74770510152417
 mnt_best       : 44.756260455966256
 not_improved_count: 3
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 3.58652 (QuantReg: 13.12090) QuantErr: 13.12090 batch_time=38.24821 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 4.27544 (QuantReg: 13.10972) QuantErr: 13.10972 batch_time=0.67774 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 3.80432 (QuantReg: 13.12870) QuantErr: 13.12870 batch_time=0.66636 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 4.09917 (QuantReg: 13.02640) QuantErr: 13.02640 batch_time=0.79450 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 2.81278 (QuantReg: 13.57629) QuantErr: 13.57629 batch_time=0.65367 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 3.41767 (QuantReg: 13.40995) QuantErr: 13.40995 batch_time=0.66042 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 3.04010 (QuantReg: 13.35827) QuantErr: 13.35827 batch_time=0.68715 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 3.26851 (QuantReg: 13.43657) QuantErr: 13.43657 batch_time=0.67097 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 4.25866 (QuantReg: 13.15705) QuantErr: 13.15705 batch_time=0.66317 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 3.53736 (QuantReg: 13.30752) QuantErr: 13.30752 batch_time=0.67110 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 2.88539 (QuantReg: 13.21703) QuantErr: 13.21703 batch_time=0.67743 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 2.88995 (QuantReg: 13.33476) QuantErr: 13.33476 batch_time=0.64704 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 3.25410 (QuantReg: 13.30331) QuantErr: 13.30331 batch_time=0.67340 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 3.28615 (QuantReg: 13.16896) QuantErr: 13.16896 batch_time=0.65866 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 3.20075 (QuantReg: 13.33086) QuantErr: 13.33086 batch_time=0.69870 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 4.00611 (QuantReg: 12.99653) QuantErr: 12.99653 batch_time=0.67056 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 2.87050 (QuantReg: 13.63310) QuantErr: 13.63310 batch_time=0.67398 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 2.88059 (QuantReg: 13.27338) QuantErr: 13.27338 batch_time=0.68316 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 4.89540 (QuantReg: 12.92909) QuantErr: 12.92909 batch_time=0.67030 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 3.39166 (QuantReg: 13.33139) QuantErr: 13.33139 batch_time=0.65310 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 4.99504 (QuantReg: 12.78493) QuantErr: 12.78493 batch_time=0.66429 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 3.48928 (QuantReg: 13.31190) QuantErr: 13.31190 batch_time=0.78866 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 3.66673 (QuantReg: 13.41320) QuantErr: 13.41320 batch_time=0.67593 
Train Epoch: 40 codebook_update_time=3.83715
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch40.pth ...
Done in 5.590s
removing stale ckpt [epoch 39] [took 0.02s]
 epoch          : 40
 loss           : 3.570165454864502
 quant_reg      : 13.210251781463622
 quant_err      : 13.210251781463622
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.478
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.31596426399451
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3165
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.411564650150254
 mnt_best       : 44.756260455966256
 not_improved_count: 4
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 4.34013 (QuantReg: 13.22686) QuantErr: 13.22686 batch_time=23.04505 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 3.22728 (QuantReg: 13.19897) QuantErr: 13.19897 batch_time=0.66819 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 4.31992 (QuantReg: 13.32175) QuantErr: 13.32175 batch_time=0.68939 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 3.42387 (QuantReg: 13.19419) QuantErr: 13.19419 batch_time=1.08711 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 3.74747 (QuantReg: 13.08784) QuantErr: 13.08784 batch_time=0.65737 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 2.94881 (QuantReg: 13.41260) QuantErr: 13.41260 batch_time=0.65467 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 3.36417 (QuantReg: 13.23261) QuantErr: 13.23261 batch_time=0.64957 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 2.48272 (QuantReg: 13.09802) QuantErr: 13.09802 batch_time=0.65371 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 3.29366 (QuantReg: 13.65043) QuantErr: 13.65043 batch_time=0.73864 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 4.20356 (QuantReg: 13.30041) QuantErr: 13.30041 batch_time=0.65235 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 3.62033 (QuantReg: 13.23850) QuantErr: 13.23850 batch_time=0.79405 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 2.18593 (QuantReg: 13.52503) QuantErr: 13.52503 batch_time=0.68733 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 2.84380 (QuantReg: 13.12047) QuantErr: 13.12047 batch_time=0.66544 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 3.63233 (QuantReg: 12.99538) QuantErr: 12.99538 batch_time=0.93506 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 4.38863 (QuantReg: 13.23378) QuantErr: 13.23378 batch_time=0.66908 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 4.03245 (QuantReg: 13.25960) QuantErr: 13.25960 batch_time=0.75574 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 2.89510 (QuantReg: 13.37582) QuantErr: 13.37582 batch_time=0.65708 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 3.56345 (QuantReg: 13.37130) QuantErr: 13.37130 batch_time=0.67631 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 3.93588 (QuantReg: 13.27530) QuantErr: 13.27530 batch_time=0.66283 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 2.87060 (QuantReg: 13.13556) QuantErr: 13.13556 batch_time=0.67798 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 3.68836 (QuantReg: 13.22438) QuantErr: 13.22438 batch_time=0.64541 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 3.74340 (QuantReg: 13.29379) QuantErr: 13.29379 batch_time=0.65140 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 3.47316 (QuantReg: 13.26051) QuantErr: 13.26051 batch_time=0.69197 
Train Epoch: 41 codebook_update_time=3.99166
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch41.pth ...
Done in 5.549s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 3.56507382774353
 quant_reg      : 13.252424770355224
 quant_err      : 13.252424770355224
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.871
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.94510198776522
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.6255
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.15896699008929
 mnt_best       : 44.756260455966256
 not_improved_count: 5
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 2.84567 (QuantReg: 13.23127) QuantErr: 13.23127 batch_time=23.09270 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 3.24589 (QuantReg: 13.15921) QuantErr: 13.15921 batch_time=0.64954 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 4.37484 (QuantReg: 13.23179) QuantErr: 13.23179 batch_time=0.68564 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 4.20430 (QuantReg: 13.04675) QuantErr: 13.04675 batch_time=0.90974 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 4.03664 (QuantReg: 12.76273) QuantErr: 12.76273 batch_time=0.79687 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 4.61718 (QuantReg: 13.04229) QuantErr: 13.04229 batch_time=0.66035 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 3.93281 (QuantReg: 13.15739) QuantErr: 13.15739 batch_time=0.66461 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 3.84593 (QuantReg: 12.99555) QuantErr: 12.99555 batch_time=0.67742 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 3.97589 (QuantReg: 13.35711) QuantErr: 13.35711 batch_time=0.70542 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 3.94031 (QuantReg: 13.21424) QuantErr: 13.21424 batch_time=0.65578 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 3.70301 (QuantReg: 13.29575) QuantErr: 13.29575 batch_time=0.66420 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 2.63158 (QuantReg: 13.09879) QuantErr: 13.09879 batch_time=0.64212 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 3.49651 (QuantReg: 13.46617) QuantErr: 13.46617 batch_time=1.63005 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 3.24899 (QuantReg: 13.16254) QuantErr: 13.16254 batch_time=0.66285 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 3.35862 (QuantReg: 13.33436) QuantErr: 13.33436 batch_time=0.72017 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 3.72254 (QuantReg: 13.54842) QuantErr: 13.54842 batch_time=0.65536 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 2.79214 (QuantReg: 13.21972) QuantErr: 13.21972 batch_time=0.66355 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 3.06246 (QuantReg: 13.02670) QuantErr: 13.02670 batch_time=0.65832 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 3.72797 (QuantReg: 13.28288) QuantErr: 13.28288 batch_time=0.66900 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 3.79215 (QuantReg: 13.52136) QuantErr: 13.52136 batch_time=0.75050 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 3.71341 (QuantReg: 13.51248) QuantErr: 13.51248 batch_time=0.66364 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 3.55069 (QuantReg: 13.32389) QuantErr: 13.32389 batch_time=0.74644 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 5.04097 (QuantReg: 13.21579) QuantErr: 13.21579 batch_time=0.68057 
Train Epoch: 42 codebook_update_time=3.46892
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch42.pth ...
Done in 4.835s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 3.532070209503174
 quant_reg      : 13.238947101593018
 quant_err      : 13.238947101593018
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.274
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.54224830834982
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.386
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.12354003712102
 mnt_best       : 44.756260455966256
 not_improved_count: 6
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 3.28892 (QuantReg: 12.94594) QuantErr: 12.94594 batch_time=34.85037 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 3.36611 (QuantReg: 13.17466) QuantErr: 13.17466 batch_time=0.66209 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 4.07950 (QuantReg: 13.01471) QuantErr: 13.01471 batch_time=0.67449 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 3.20711 (QuantReg: 13.19614) QuantErr: 13.19614 batch_time=0.68920 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 3.25426 (QuantReg: 12.84188) QuantErr: 12.84188 batch_time=0.65630 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 3.46711 (QuantReg: 13.02764) QuantErr: 13.02764 batch_time=0.64546 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 3.64722 (QuantReg: 13.52053) QuantErr: 13.52053 batch_time=0.68371 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 3.94888 (QuantReg: 13.07118) QuantErr: 13.07118 batch_time=1.59328 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 3.59911 (QuantReg: 13.28642) QuantErr: 13.28642 batch_time=0.65384 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 2.58792 (QuantReg: 13.12413) QuantErr: 13.12413 batch_time=0.65749 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 3.20769 (QuantReg: 13.27928) QuantErr: 13.27928 batch_time=0.64950 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 3.10043 (QuantReg: 13.41591) QuantErr: 13.41591 batch_time=0.66667 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 3.63174 (QuantReg: 12.99429) QuantErr: 12.99429 batch_time=0.64761 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 3.62063 (QuantReg: 13.32356) QuantErr: 13.32356 batch_time=0.66016 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 2.81579 (QuantReg: 13.58154) QuantErr: 13.58154 batch_time=0.66104 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 3.25356 (QuantReg: 13.17623) QuantErr: 13.17623 batch_time=0.68777 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 3.58726 (QuantReg: 12.98691) QuantErr: 12.98691 batch_time=0.67013 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 3.36706 (QuantReg: 13.22723) QuantErr: 13.22723 batch_time=0.74410 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 3.34534 (QuantReg: 13.28197) QuantErr: 13.28197 batch_time=0.69497 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 3.88353 (QuantReg: 13.29454) QuantErr: 13.29454 batch_time=0.65978 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 2.65811 (QuantReg: 13.50321) QuantErr: 13.50321 batch_time=0.65153 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 3.28121 (QuantReg: 13.13061) QuantErr: 13.13061 batch_time=0.65893 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 3.50534 (QuantReg: 13.55691) QuantErr: 13.55691 batch_time=1.32684 
Train Epoch: 43 codebook_update_time=3.63035
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch43.pth ...
Done in 5.428s
removing stale ckpt [epoch 42] [took 0.02s]
 epoch          : 43
 loss           : 3.502601131439209
 quant_reg      : 13.26437910079956
 quant_err      : 13.26437910079956
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.557
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.72885844251014
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.377
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.84002400030421
 mnt_best       : 44.756260455966256
 not_improved_count: 7
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 3.91292 (QuantReg: 13.50042) QuantErr: 13.50042 batch_time=24.50164 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 3.30657 (QuantReg: 13.22253) QuantErr: 13.22253 batch_time=0.69260 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 3.77024 (QuantReg: 13.47581) QuantErr: 13.47581 batch_time=0.65987 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 3.30228 (QuantReg: 13.08772) QuantErr: 13.08772 batch_time=0.65055 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 5.02157 (QuantReg: 13.08979) QuantErr: 13.08979 batch_time=0.99933 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 3.59476 (QuantReg: 13.22051) QuantErr: 13.22051 batch_time=0.65580 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 2.88532 (QuantReg: 13.38902) QuantErr: 13.38902 batch_time=0.68352 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 3.74730 (QuantReg: 12.80056) QuantErr: 12.80056 batch_time=0.67477 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 3.96750 (QuantReg: 13.37308) QuantErr: 13.37308 batch_time=0.64786 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 3.88930 (QuantReg: 13.61459) QuantErr: 13.61459 batch_time=0.65074 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 3.33860 (QuantReg: 13.44980) QuantErr: 13.44980 batch_time=0.64827 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 4.15242 (QuantReg: 13.14963) QuantErr: 13.14963 batch_time=0.65152 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 3.20924 (QuantReg: 13.59871) QuantErr: 13.59871 batch_time=1.35358 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 3.36836 (QuantReg: 13.07079) QuantErr: 13.07079 batch_time=0.69888 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 4.01313 (QuantReg: 13.37838) QuantErr: 13.37838 batch_time=0.66184 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 4.29886 (QuantReg: 13.48404) QuantErr: 13.48404 batch_time=0.66410 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 4.24319 (QuantReg: 12.88226) QuantErr: 12.88226 batch_time=0.64446 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 3.72354 (QuantReg: 13.21159) QuantErr: 13.21159 batch_time=0.65295 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 3.53947 (QuantReg: 13.29107) QuantErr: 13.29107 batch_time=0.67035 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 3.60030 (QuantReg: 13.03807) QuantErr: 13.03807 batch_time=0.67362 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 3.46925 (QuantReg: 13.32715) QuantErr: 13.32715 batch_time=0.67202 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 3.66014 (QuantReg: 13.06121) QuantErr: 13.06121 batch_time=0.66383 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 2.96152 (QuantReg: 13.27967) QuantErr: 13.27967 batch_time=0.65574 
Train Epoch: 44 codebook_update_time=3.47154
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch44.pth ...
Done in 5.042s
removing stale ckpt [epoch 43] [took 0.01s]
 epoch          : 44
 loss           : 3.5727086019515992
 quant_reg      : 13.279843952178956
 quant_err      : 13.279843952178956
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.585
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.034545872535716
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.437
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.20287657574474
 mnt_best       : 44.756260455966256
 not_improved_count: 8
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 3.73637 (QuantReg: 13.18363) QuantErr: 13.18363 batch_time=26.42984 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 3.75204 (QuantReg: 13.32284) QuantErr: 13.32284 batch_time=0.66066 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 3.69020 (QuantReg: 13.17579) QuantErr: 13.17579 batch_time=3.49023 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 3.45431 (QuantReg: 13.37712) QuantErr: 13.37712 batch_time=0.65013 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 2.93186 (QuantReg: 13.38439) QuantErr: 13.38439 batch_time=0.67984 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 3.89970 (QuantReg: 13.08945) QuantErr: 13.08945 batch_time=0.66846 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 3.81716 (QuantReg: 13.62668) QuantErr: 13.62668 batch_time=2.23633 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 3.12543 (QuantReg: 13.22819) QuantErr: 13.22819 batch_time=0.73466 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 3.73912 (QuantReg: 13.27909) QuantErr: 13.27909 batch_time=0.64614 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 3.54316 (QuantReg: 13.50858) QuantErr: 13.50858 batch_time=0.65528 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 3.70713 (QuantReg: 13.24076) QuantErr: 13.24076 batch_time=0.77686 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 3.14083 (QuantReg: 13.34191) QuantErr: 13.34191 batch_time=0.65383 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 4.12244 (QuantReg: 13.06424) QuantErr: 13.06424 batch_time=0.67069 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 3.93290 (QuantReg: 12.98228) QuantErr: 12.98228 batch_time=0.68530 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 3.47404 (QuantReg: 13.10774) QuantErr: 13.10774 batch_time=0.65672 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 3.32038 (QuantReg: 13.28417) QuantErr: 13.28417 batch_time=0.69092 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 4.70063 (QuantReg: 13.42575) QuantErr: 13.42575 batch_time=0.63860 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 3.06368 (QuantReg: 13.36891) QuantErr: 13.36891 batch_time=0.67311 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 3.76752 (QuantReg: 13.40317) QuantErr: 13.40317 batch_time=0.70204 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 3.49449 (QuantReg: 13.41475) QuantErr: 13.41475 batch_time=1.22782 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 3.36054 (QuantReg: 13.30663) QuantErr: 13.30663 batch_time=0.70030 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 3.12215 (QuantReg: 13.23484) QuantErr: 13.23484 batch_time=0.68156 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 3.71139 (QuantReg: 13.09379) QuantErr: 13.09379 batch_time=0.72725 
Train Epoch: 45 codebook_update_time=3.60140
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch45.pth ...
Done in 10.563s
removing stale ckpt [epoch 44] [took 0.01s]
 epoch          : 45
 loss           : 3.5661817808151244
 quant_reg      : 13.28871506500244
 quant_err      : 13.28871506500244
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.349
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.11553657529382
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.508
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.828766866598116
 mnt_best       : 44.756260455966256
 not_improved_count: 9
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 3.38366 (QuantReg: 13.11678) QuantErr: 13.11678 batch_time=24.41765 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 2.95952 (QuantReg: 13.31787) QuantErr: 13.31787 batch_time=0.65846 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 3.27615 (QuantReg: 13.40206) QuantErr: 13.40206 batch_time=0.64486 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 3.20297 (QuantReg: 13.14443) QuantErr: 13.14443 batch_time=0.64922 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 2.91745 (QuantReg: 13.08793) QuantErr: 13.08793 batch_time=0.66383 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 3.30074 (QuantReg: 13.28658) QuantErr: 13.28658 batch_time=0.64882 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 3.76292 (QuantReg: 13.28883) QuantErr: 13.28883 batch_time=0.65399 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 4.47489 (QuantReg: 13.16992) QuantErr: 13.16992 batch_time=0.67516 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 2.59051 (QuantReg: 13.51373) QuantErr: 13.51373 batch_time=0.64798 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 3.15727 (QuantReg: 13.43825) QuantErr: 13.43825 batch_time=0.66162 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 3.09583 (QuantReg: 13.68745) QuantErr: 13.68745 batch_time=0.78152 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 4.02307 (QuantReg: 13.44075) QuantErr: 13.44075 batch_time=0.73461 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 3.27212 (QuantReg: 13.31986) QuantErr: 13.31986 batch_time=3.61639 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 3.19944 (QuantReg: 13.48961) QuantErr: 13.48961 batch_time=0.66472 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 4.31205 (QuantReg: 13.61994) QuantErr: 13.61994 batch_time=0.66044 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 2.38526 (QuantReg: 13.50128) QuantErr: 13.50128 batch_time=0.67202 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 3.66698 (QuantReg: 13.34202) QuantErr: 13.34202 batch_time=0.64781 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 3.52451 (QuantReg: 13.35116) QuantErr: 13.35116 batch_time=0.78840 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 3.45694 (QuantReg: 13.14321) QuantErr: 13.14321 batch_time=0.85117 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 3.83891 (QuantReg: 13.16468) QuantErr: 13.16468 batch_time=0.64524 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 4.41174 (QuantReg: 13.16126) QuantErr: 13.16126 batch_time=0.72783 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 3.37212 (QuantReg: 13.25118) QuantErr: 13.25118 batch_time=0.67880 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 3.79914 (QuantReg: 13.08832) QuantErr: 13.08832 batch_time=0.67923 
Train Epoch: 46 codebook_update_time=4.08137
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch46.pth ...
Done in 15.983s
removing stale ckpt [epoch 45] [took 0.10s]
 epoch          : 46
 loss           : 3.5690481920242307
 quant_reg      : 13.34954169845581
 quant_err      : 13.34954169845581
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.249
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.46411684576898
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3555
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.6399126032119
 mnt_best       : 44.756260455966256
 not_improved_count: 10
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 3.60990 (QuantReg: 13.28986) QuantErr: 13.28986 batch_time=27.92244 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 2.99424 (QuantReg: 13.39404) QuantErr: 13.39404 batch_time=0.66837 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 2.64042 (QuantReg: 13.51565) QuantErr: 13.51565 batch_time=0.68546 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 3.90798 (QuantReg: 13.23503) QuantErr: 13.23503 batch_time=0.64993 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 3.41700 (QuantReg: 13.37154) QuantErr: 13.37154 batch_time=0.65010 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 4.51385 (QuantReg: 13.43878) QuantErr: 13.43878 batch_time=0.67804 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 4.04664 (QuantReg: 13.41183) QuantErr: 13.41183 batch_time=0.66053 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 2.80977 (QuantReg: 13.26567) QuantErr: 13.26567 batch_time=0.65233 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 2.62961 (QuantReg: 13.51217) QuantErr: 13.51217 batch_time=0.65447 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 3.64190 (QuantReg: 13.07994) QuantErr: 13.07994 batch_time=0.74324 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 3.78124 (QuantReg: 13.43560) QuantErr: 13.43560 batch_time=0.68275 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 3.89890 (QuantReg: 13.47519) QuantErr: 13.47519 batch_time=0.66408 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 4.84696 (QuantReg: 13.24681) QuantErr: 13.24681 batch_time=0.69905 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 4.02473 (QuantReg: 13.26158) QuantErr: 13.26158 batch_time=1.48169 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 2.89029 (QuantReg: 13.39843) QuantErr: 13.39843 batch_time=0.67661 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 3.14141 (QuantReg: 13.39496) QuantErr: 13.39496 batch_time=0.65799 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 3.27504 (QuantReg: 13.18439) QuantErr: 13.18439 batch_time=0.66719 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 3.68053 (QuantReg: 13.44910) QuantErr: 13.44910 batch_time=0.74663 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 3.27353 (QuantReg: 13.41923) QuantErr: 13.41923 batch_time=0.65993 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 3.95031 (QuantReg: 13.20662) QuantErr: 13.20662 batch_time=0.64473 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 2.77639 (QuantReg: 13.76768) QuantErr: 13.76768 batch_time=0.64775 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 3.50240 (QuantReg: 13.51720) QuantErr: 13.51720 batch_time=0.72732 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 3.65757 (QuantReg: 13.27358) QuantErr: 13.27358 batch_time=0.65305 
Train Epoch: 47 codebook_update_time=3.95389
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch47.pth ...
Done in 18.699s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 47
 loss           : 3.5675892181396485
 quant_reg      : 13.328900520324707
 quant_err      : 13.328900520324707
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.813
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.45412500842686
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.51
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.78637174528227
 mnt_best       : 44.756260455966256
 not_improved_count: 11
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 4.10561 (QuantReg: 13.08997) QuantErr: 13.08997 batch_time=24.13636 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 3.56531 (QuantReg: 13.42121) QuantErr: 13.42121 batch_time=0.69737 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 3.95742 (QuantReg: 13.48516) QuantErr: 13.48516 batch_time=0.82636 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 3.55940 (QuantReg: 13.25522) QuantErr: 13.25522 batch_time=0.67515 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 3.92266 (QuantReg: 13.39656) QuantErr: 13.39656 batch_time=0.65414 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 3.72886 (QuantReg: 13.32585) QuantErr: 13.32585 batch_time=0.69711 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 2.58068 (QuantReg: 13.64456) QuantErr: 13.64456 batch_time=4.19779 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 2.44595 (QuantReg: 13.32800) QuantErr: 13.32800 batch_time=1.13281 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 3.79834 (QuantReg: 13.15000) QuantErr: 13.15000 batch_time=0.65562 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 3.91767 (QuantReg: 13.28661) QuantErr: 13.28661 batch_time=0.79191 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 3.41320 (QuantReg: 13.50269) QuantErr: 13.50269 batch_time=1.33145 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 3.96954 (QuantReg: 13.12855) QuantErr: 13.12855 batch_time=0.67018 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 3.40218 (QuantReg: 13.35827) QuantErr: 13.35827 batch_time=0.66853 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 4.23627 (QuantReg: 13.28271) QuantErr: 13.28271 batch_time=0.70762 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 4.49194 (QuantReg: 13.39491) QuantErr: 13.39491 batch_time=0.72747 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 3.02924 (QuantReg: 13.32070) QuantErr: 13.32070 batch_time=0.68771 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 2.95931 (QuantReg: 13.32124) QuantErr: 13.32124 batch_time=0.65846 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 4.42182 (QuantReg: 13.30259) QuantErr: 13.30259 batch_time=0.66168 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 3.64751 (QuantReg: 13.06396) QuantErr: 13.06396 batch_time=2.29452 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 4.56807 (QuantReg: 13.40622) QuantErr: 13.40622 batch_time=0.67196 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 3.30649 (QuantReg: 13.33255) QuantErr: 13.33255 batch_time=0.67309 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 3.47875 (QuantReg: 13.36607) QuantErr: 13.36607 batch_time=0.68403 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 4.15153 (QuantReg: 13.32145) QuantErr: 13.32145 batch_time=0.69708 
Train Epoch: 48 codebook_update_time=3.61093
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch48.pth ...
Done in 5.564s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 3.5138371210098267
 quant_reg      : 13.34024934387207
 quant_err      : 13.34024934387207
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.284
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.53721702422763
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0105
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.46879799359609
 mnt_best       : 44.756260455966256
 not_improved_count: 12
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 3.37947 (QuantReg: 13.29623) QuantErr: 13.29623 batch_time=27.30421 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 2.91877 (QuantReg: 13.33139) QuantErr: 13.33139 batch_time=0.69714 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 3.40162 (QuantReg: 13.34891) QuantErr: 13.34891 batch_time=0.67187 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 4.35342 (QuantReg: 13.52816) QuantErr: 13.52816 batch_time=0.75597 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 5.61833 (QuantReg: 13.19603) QuantErr: 13.19603 batch_time=0.67344 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 2.82793 (QuantReg: 13.50335) QuantErr: 13.50335 batch_time=0.70839 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 3.18489 (QuantReg: 13.40940) QuantErr: 13.40940 batch_time=0.75455 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 2.88355 (QuantReg: 13.65821) QuantErr: 13.65821 batch_time=0.67835 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 3.59783 (QuantReg: 13.12255) QuantErr: 13.12255 batch_time=0.64525 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 3.99289 (QuantReg: 13.52686) QuantErr: 13.52686 batch_time=0.65264 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 3.99065 (QuantReg: 13.27432) QuantErr: 13.27432 batch_time=0.70129 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 3.12014 (QuantReg: 13.43710) QuantErr: 13.43710 batch_time=0.69548 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 3.93874 (QuantReg: 13.53809) QuantErr: 13.53809 batch_time=0.66248 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 3.28227 (QuantReg: 13.42704) QuantErr: 13.42704 batch_time=0.66834 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 4.55812 (QuantReg: 13.40401) QuantErr: 13.40401 batch_time=0.69350 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 3.63020 (QuantReg: 13.23477) QuantErr: 13.23477 batch_time=0.70298 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 3.54973 (QuantReg: 13.30171) QuantErr: 13.30171 batch_time=0.66593 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 3.75994 (QuantReg: 13.34965) QuantErr: 13.34965 batch_time=0.73616 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 3.25359 (QuantReg: 13.30096) QuantErr: 13.30096 batch_time=0.65312 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 3.95431 (QuantReg: 13.47794) QuantErr: 13.47794 batch_time=0.65302 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 3.79933 (QuantReg: 13.32029) QuantErr: 13.32029 batch_time=0.70373 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 2.88297 (QuantReg: 13.51378) QuantErr: 13.51378 batch_time=0.68296 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 3.87445 (QuantReg: 13.39417) QuantErr: 13.39417 batch_time=0.78706 
Train Epoch: 49 codebook_update_time=3.46861
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch49.pth ...
Done in 4.287s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 3.561666376113892
 quant_reg      : 13.371101596832276
 quant_err      : 13.371101596832276
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.315
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.4983484637249
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7575
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.45986139330357
 mnt_best       : 44.756260455966256
 not_improved_count: 13
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 3.16375 (QuantReg: 13.52580) QuantErr: 13.52580 batch_time=29.33352 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 2.85673 (QuantReg: 13.18766) QuantErr: 13.18766 batch_time=0.67701 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 3.38324 (QuantReg: 13.42238) QuantErr: 13.42238 batch_time=0.65832 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 4.13265 (QuantReg: 13.38658) QuantErr: 13.38658 batch_time=0.68963 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 3.78640 (QuantReg: 13.34761) QuantErr: 13.34761 batch_time=2.12549 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 3.19826 (QuantReg: 13.42685) QuantErr: 13.42685 batch_time=0.65176 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 4.22206 (QuantReg: 13.60604) QuantErr: 13.60604 batch_time=0.65491 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 3.08042 (QuantReg: 13.40830) QuantErr: 13.40830 batch_time=0.65994 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 3.22310 (QuantReg: 13.39792) QuantErr: 13.39792 batch_time=0.66020 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 3.38798 (QuantReg: 13.21924) QuantErr: 13.21924 batch_time=0.71752 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 3.79458 (QuantReg: 13.26634) QuantErr: 13.26634 batch_time=0.65183 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 3.54499 (QuantReg: 13.76141) QuantErr: 13.76141 batch_time=0.66801 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 3.97933 (QuantReg: 13.32267) QuantErr: 13.32267 batch_time=0.65943 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 3.62740 (QuantReg: 13.31415) QuantErr: 13.31415 batch_time=1.11149 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 3.07396 (QuantReg: 13.19895) QuantErr: 13.19895 batch_time=0.66541 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 4.40563 (QuantReg: 13.57180) QuantErr: 13.57180 batch_time=0.70917 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 3.78991 (QuantReg: 13.12055) QuantErr: 13.12055 batch_time=0.66169 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 3.97087 (QuantReg: 13.15902) QuantErr: 13.15902 batch_time=0.66312 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 3.33489 (QuantReg: 13.51018) QuantErr: 13.51018 batch_time=0.65634 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 3.61187 (QuantReg: 13.25264) QuantErr: 13.25264 batch_time=0.66492 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 3.19288 (QuantReg: 13.35438) QuantErr: 13.35438 batch_time=0.67360 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 3.75725 (QuantReg: 13.42514) QuantErr: 13.42514 batch_time=0.67454 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 2.75681 (QuantReg: 13.37915) QuantErr: 13.37915 batch_time=0.68745 
Train Epoch: 50 codebook_update_time=3.64889
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/checkpoint-epoch50.pth ...
Done in 4.730s
removing stale ckpt [epoch 49] [took 0.04s]
 epoch          : 50
 loss           : 3.5263565492630007
 quant_reg      : 13.3769377784729
 quant_err      : 13.3769377784729
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.265
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.32801520368332
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.717
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.50025020098927
 mnt_best       : 44.756260455966256
 not_improved_count: 14
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/trained_model.pth ...
Ckpt loaded at epoch 36.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 24.2
 t2v_metrics/R5/final_eval: 54.4
 t2v_metrics/R10/final_eval: 68.1
 t2v_metrics/R50/final_eval: 88.7
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 27.15
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 44.756260455966256
 v2t_metrics/R1/final_eval: 23.6
 v2t_metrics/R5/final_eval: 55.0
 v2t_metrics/R10/final_eval: 69.4
 v2t_metrics/R50/final_eval: 90.6
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 22.7925
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 44.8275208242262
Best epoch for the monitored metric: 36
Script took 04h05m00s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L15/trained_model.pth
