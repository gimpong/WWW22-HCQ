Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 1072.132703781128 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 50.190322399139404 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 366.5508248806 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 61.49386525154114 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch0.pth ...
Done in 1.670s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch0.pth ...
Done in 3.096s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.0
 MSRVTT_full_val/t2v_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R10: 1.6096579476861168
 MSRVTT_full_val/t2v_metrics/R50: 8.450704225352112
 MSRVTT_full_val/t2v_metrics/MedR: 252.0
 MSRVTT_full_val/t2v_metrics/MeanR: 251.21730382293762
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_val/v2t_metrics/R1: 0.0
 MSRVTT_full_val/v2t_metrics/R5: 0.8048289738430584
 MSRVTT_full_val/v2t_metrics/R10: 2.0120724346076457
 MSRVTT_full_val/v2t_metrics/R50: 9.054325955734406
 MSRVTT_full_val/v2t_metrics/MedR: 243.0
 MSRVTT_full_val/v2t_metrics/MeanR: 247.7344064386318
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/t2v_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.26755852842809363
 MSRVTT_full_test/t2v_metrics/R50: 1.705685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 1515.0
 MSRVTT_full_test/t2v_metrics/MeanR: 1498.5565217391304
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.12154652794863813
 MSRVTT_full_test/v2t_metrics/R1: 0.06688963210702341
 MSRVTT_full_test/v2t_metrics/R5: 0.16722408026755853
 MSRVTT_full_test/v2t_metrics/R10: 0.3010033444816054
 MSRVTT_full_test/v2t_metrics/R50: 1.806020066889632
 MSRVTT_full_test/v2t_metrics/MedR: 1471.5
 MSRVTT_full_test/v2t_metrics/MeanR: 1495.3264214046824
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.14987975740993859
 mnt_best       : 0.12154652794863813
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.72885 (QuantReg: 22.44570) QuantErr: 22.44570 batch_time=41.90310 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.80065 (QuantReg: 22.54847) QuantErr: 22.54847 batch_time=0.51393 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.26229 (QuantReg: 22.61779) QuantErr: 22.61779 batch_time=0.50631 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 7.14518 (QuantReg: 22.61533) QuantErr: 22.61533 batch_time=0.51276 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.63854 (QuantReg: 22.60823) QuantErr: 22.60823 batch_time=0.53270 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.36732 (QuantReg: 22.62352) QuantErr: 22.62352 batch_time=0.49190 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 6.30730 (QuantReg: 22.61246) QuantErr: 22.61246 batch_time=0.49865 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 6.04092 (QuantReg: 22.61831) QuantErr: 22.61831 batch_time=0.49554 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.76108 (QuantReg: 22.65146) QuantErr: 22.65146 batch_time=0.50425 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.85885 (QuantReg: 22.62796) QuantErr: 22.62796 batch_time=0.49862 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.56884 (QuantReg: 22.66053) QuantErr: 22.66053 batch_time=0.88913 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 5.28902 (QuantReg: 22.64396) QuantErr: 22.64396 batch_time=0.48869 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.29891 (QuantReg: 22.63265) QuantErr: 22.63265 batch_time=0.50761 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 5.19045 (QuantReg: 22.65735) QuantErr: 22.65735 batch_time=0.50199 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 5.21407 (QuantReg: 22.63473) QuantErr: 22.63473 batch_time=0.49038 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 5.36224 (QuantReg: 22.62296) QuantErr: 22.62296 batch_time=0.49774 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 5.20357 (QuantReg: 22.62401) QuantErr: 22.62401 batch_time=0.50316 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.92567 (QuantReg: 22.60976) QuantErr: 22.60976 batch_time=0.56567 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.96669 (QuantReg: 22.58120) QuantErr: 22.58120 batch_time=0.49954 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.74352 (QuantReg: 22.60469) QuantErr: 22.60469 batch_time=0.49476 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.90642 (QuantReg: 22.64165) QuantErr: 22.64165 batch_time=0.49095 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.80301 (QuantReg: 22.62801) QuantErr: 22.62801 batch_time=0.50725 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 4.52817 (QuantReg: 22.58497) QuantErr: 22.58497 batch_time=0.53663 
Train Epoch: 1 codebook_update_time=1.96650
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch1.pth ...
Done in 4.088s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch1.pth ...
Done in 8.241s
 epoch          : 1
 loss           : 5.745349178314209
 quant_reg      : 22.61379605102539
 quant_err      : 22.61379605102539
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 16.096579476861166
 MSRVTT_full_val/t2v_metrics/R5: 45.67404426559356
 MSRVTT_full_val/t2v_metrics/R10: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R50: 93.36016096579476
 MSRVTT_full_val/t2v_metrics/MedR: 7.0
 MSRVTT_full_val/t2v_metrics/MeanR: 15.826961770623743
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 36.324297956572124
 MSRVTT_full_val/v2t_metrics/R1: 18.91348088531187
 MSRVTT_full_val/v2t_metrics/R5: 51.7102615694165
 MSRVTT_full_val/v2t_metrics/R10: 67.00201207243461
 MSRVTT_full_val/v2t_metrics/R50: 94.36619718309859
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 13.943661971830986
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 40.31611556385849
 MSRVTT_full_test/t2v_metrics/R1: 5.585284280936455
 MSRVTT_full_test/t2v_metrics/R5: 17.692307692307693
 MSRVTT_full_test/t2v_metrics/R10: 28.160535117056856
 MSRVTT_full_test/t2v_metrics/R50: 62.876254180602004
 MSRVTT_full_test/t2v_metrics/MedR: 30.0
 MSRVTT_full_test/t2v_metrics/MeanR: 82.2494983277592
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 14.065555538629564
 MSRVTT_full_test/v2t_metrics/R1: 5.986622073578595
 MSRVTT_full_test/v2t_metrics/R5: 19.464882943143813
 MSRVTT_full_test/v2t_metrics/R10: 29.632107023411372
 MSRVTT_full_test/v2t_metrics/R50: 65.91973244147157
 MSRVTT_full_test/v2t_metrics/MedR: 26.0
 MSRVTT_full_test/v2t_metrics/MeanR: 75.3923076923077
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 15.114671898694434
 mnt_best       : 14.065555538629564
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.42823 (QuantReg: 10.13707) QuantErr: 10.13707 batch_time=37.86120 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.51439 (QuantReg: 10.03518) QuantErr: 10.03518 batch_time=0.48860 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.43345 (QuantReg: 10.34135) QuantErr: 10.34135 batch_time=0.50624 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 4.33597 (QuantReg: 10.48574) QuantErr: 10.48574 batch_time=0.48766 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 4.39777 (QuantReg: 10.63858) QuantErr: 10.63858 batch_time=0.52402 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 4.30148 (QuantReg: 10.34891) QuantErr: 10.34891 batch_time=0.51884 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.65588 (QuantReg: 10.84698) QuantErr: 10.84698 batch_time=0.53789 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 4.23408 (QuantReg: 10.68344) QuantErr: 10.68344 batch_time=0.49405 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 4.68635 (QuantReg: 10.95356) QuantErr: 10.95356 batch_time=0.49778 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.21802 (QuantReg: 10.82187) QuantErr: 10.82187 batch_time=0.52688 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 4.19688 (QuantReg: 10.71955) QuantErr: 10.71955 batch_time=0.48711 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 4.09379 (QuantReg: 10.81696) QuantErr: 10.81696 batch_time=0.48616 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.86894 (QuantReg: 10.96618) QuantErr: 10.96618 batch_time=4.08531 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.07488 (QuantReg: 11.07791) QuantErr: 11.07791 batch_time=0.51400 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.94696 (QuantReg: 11.37475) QuantErr: 11.37475 batch_time=1.41296 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 4.03905 (QuantReg: 11.62150) QuantErr: 11.62150 batch_time=0.50572 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 4.10564 (QuantReg: 11.34908) QuantErr: 11.34908 batch_time=0.55678 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 4.14432 (QuantReg: 11.62245) QuantErr: 11.62245 batch_time=0.74021 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.72152 (QuantReg: 11.36531) QuantErr: 11.36531 batch_time=0.51642 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.92543 (QuantReg: 11.73821) QuantErr: 11.73821 batch_time=0.52920 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.68051 (QuantReg: 11.61061) QuantErr: 11.61061 batch_time=0.53746 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 4.42551 (QuantReg: 11.52544) QuantErr: 11.52544 batch_time=0.50459 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 4.18806 (QuantReg: 12.12099) QuantErr: 12.12099 batch_time=0.49746 
Train Epoch: 2 codebook_update_time=1.69222
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch2.pth ...
Done in 4.335s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch2.pth ...
Done in 9.447s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 4.205911855697632
 quant_reg      : 10.98818658065796
 quant_err      : 10.98818658065796
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 17.706237424547282
 MSRVTT_full_val/t2v_metrics/R5: 52.11267605633803
 MSRVTT_full_val/t2v_metrics/R10: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.62374245472837
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 39.81658992875864
 MSRVTT_full_val/v2t_metrics/R1: 23.34004024144869
 MSRVTT_full_val/v2t_metrics/R5: 58.5513078470825
 MSRVTT_full_val/v2t_metrics/R10: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 11.311871227364184
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 46.8926050403427
 MSRVTT_full_test/t2v_metrics/R1: 6.8561872909699
 MSRVTT_full_test/t2v_metrics/R5: 21.672240802675585
 MSRVTT_full_test/t2v_metrics/R10: 33.24414715719063
 MSRVTT_full_test/t2v_metrics/R50: 69.93311036789298
 MSRVTT_full_test/t2v_metrics/MedR: 22.0
 MSRVTT_full_test/t2v_metrics/MeanR: 66.57190635451505
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 17.030754768917923
 MSRVTT_full_test/v2t_metrics/R1: 7.8595317725752505
 MSRVTT_full_test/v2t_metrics/R5: 24.91638795986622
 MSRVTT_full_test/v2t_metrics/R10: 37.69230769230769
 MSRVTT_full_test/v2t_metrics/R50: 73.37792642140468
 MSRVTT_full_test/v2t_metrics/MedR: 18.0
 MSRVTT_full_test/v2t_metrics/MeanR: 58.08896321070234
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.47054742116143
 mnt_best       : 17.030754768917923
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.68878 (QuantReg: 9.00932) QuantErr: 9.00932 batch_time=37.90547 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.99709 (QuantReg: 9.32326) QuantErr: 9.32326 batch_time=1.57230 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 4.22183 (QuantReg: 9.53270) QuantErr: 9.53270 batch_time=0.49876 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 3.63387 (QuantReg: 8.66118) QuantErr: 8.66118 batch_time=0.49927 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.92758 (QuantReg: 9.20904) QuantErr: 9.20904 batch_time=0.54292 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 3.50306 (QuantReg: 9.26976) QuantErr: 9.26976 batch_time=0.52824 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.62468 (QuantReg: 9.26461) QuantErr: 9.26461 batch_time=0.49264 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.83491 (QuantReg: 9.15611) QuantErr: 9.15611 batch_time=0.55917 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.71609 (QuantReg: 9.06057) QuantErr: 9.06057 batch_time=0.50007 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 3.54888 (QuantReg: 9.22374) QuantErr: 9.22374 batch_time=0.50157 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.74488 (QuantReg: 9.33908) QuantErr: 9.33908 batch_time=0.52350 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.33279 (QuantReg: 9.37748) QuantErr: 9.37748 batch_time=0.49186 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.87366 (QuantReg: 9.71930) QuantErr: 9.71930 batch_time=0.50440 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.67538 (QuantReg: 9.76959) QuantErr: 9.76959 batch_time=0.49435 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 4.29164 (QuantReg: 9.55890) QuantErr: 9.55890 batch_time=0.50897 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 3.27991 (QuantReg: 9.97247) QuantErr: 9.97247 batch_time=0.50686 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.32245 (QuantReg: 9.59984) QuantErr: 9.59984 batch_time=0.50562 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.84129 (QuantReg: 9.57587) QuantErr: 9.57587 batch_time=0.50933 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.35186 (QuantReg: 9.52397) QuantErr: 9.52397 batch_time=0.49908 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.73876 (QuantReg: 9.70943) QuantErr: 9.70943 batch_time=0.50008 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.38270 (QuantReg: 9.85117) QuantErr: 9.85117 batch_time=0.51021 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.23603 (QuantReg: 9.80564) QuantErr: 9.80564 batch_time=1.05461 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.46898 (QuantReg: 9.96078) QuantErr: 9.96078 batch_time=0.50394 
Train Epoch: 3 codebook_update_time=1.64500
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch3.pth ...
Done in 7.001s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch3.pth ...
Done in 11.517s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 3.6997866382598876
 quant_reg      : 9.498856716156006
 quant_err      : 9.498856716156006
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 23.74245472837022
 MSRVTT_full_val/t2v_metrics/R5: 57.947686116700204
 MSRVTT_full_val/t2v_metrics/R10: 72.83702213279678
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.362173038229376
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.44845789058825
 MSRVTT_full_val/v2t_metrics/R1: 27.364185110663986
 MSRVTT_full_val/v2t_metrics/R5: 63.58148893360161
 MSRVTT_full_val/v2t_metrics/R10: 78.06841046277665
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.714285714285714
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.40391342350176
 MSRVTT_full_test/t2v_metrics/R1: 8.160535117056856
 MSRVTT_full_test/t2v_metrics/R5: 25.317725752508363
 MSRVTT_full_test/t2v_metrics/R10: 37.65886287625418
 MSRVTT_full_test/t2v_metrics/R50: 72.97658862876254
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.067558528428094
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.815430428173375
 MSRVTT_full_test/v2t_metrics/R1: 9.23076923076923
 MSRVTT_full_test/v2t_metrics/R5: 28.42809364548495
 MSRVTT_full_test/v2t_metrics/R10: 41.90635451505017
 MSRVTT_full_test/v2t_metrics/R50: 77.05685618729098
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.93913043478261
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.23763023750083
 mnt_best       : 19.815430428173375
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 3.94949 (QuantReg: 8.63872) QuantErr: 8.63872 batch_time=36.54790 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 3.57177 (QuantReg: 8.68550) QuantErr: 8.68550 batch_time=0.49238 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 3.22390 (QuantReg: 8.77107) QuantErr: 8.77107 batch_time=0.49906 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 3.40838 (QuantReg: 8.62546) QuantErr: 8.62546 batch_time=0.52039 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 3.52442 (QuantReg: 8.75300) QuantErr: 8.75300 batch_time=0.51478 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.71559 (QuantReg: 8.81952) QuantErr: 8.81952 batch_time=0.52137 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 3.63731 (QuantReg: 8.84395) QuantErr: 8.84395 batch_time=0.50568 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 3.51851 (QuantReg: 8.83222) QuantErr: 8.83222 batch_time=0.51245 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 3.32339 (QuantReg: 8.75166) QuantErr: 8.75166 batch_time=0.50096 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 3.30373 (QuantReg: 8.76719) QuantErr: 8.76719 batch_time=0.51722 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 3.45772 (QuantReg: 8.95716) QuantErr: 8.95716 batch_time=0.50596 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 3.49605 (QuantReg: 8.65892) QuantErr: 8.65892 batch_time=0.49731 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.31828 (QuantReg: 8.71518) QuantErr: 8.71518 batch_time=0.49803 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 3.49837 (QuantReg: 9.22557) QuantErr: 9.22557 batch_time=4.13184 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 3.47697 (QuantReg: 9.22894) QuantErr: 9.22894 batch_time=0.51915 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 3.68503 (QuantReg: 9.45893) QuantErr: 9.45893 batch_time=0.50779 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 3.61491 (QuantReg: 9.14130) QuantErr: 9.14130 batch_time=0.50802 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 3.48902 (QuantReg: 9.40144) QuantErr: 9.40144 batch_time=0.51286 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 3.40744 (QuantReg: 9.09771) QuantErr: 9.09771 batch_time=0.50198 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 3.22204 (QuantReg: 9.10086) QuantErr: 9.10086 batch_time=0.51048 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 3.21448 (QuantReg: 9.49034) QuantErr: 9.49034 batch_time=0.49585 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 3.46248 (QuantReg: 9.01759) QuantErr: 9.01759 batch_time=0.50678 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 3.28304 (QuantReg: 9.10120) QuantErr: 9.10120 batch_time=0.49695 
Train Epoch: 4 codebook_update_time=1.70443
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch4.pth ...
Done in 4.905s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 3.413597466468811
 quant_reg      : 9.000101329803467
 quant_err      : 9.000101329803467
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 21.93158953722334
 MSRVTT_full_val/t2v_metrics/R5: 56.13682092555332
 MSRVTT_full_val/t2v_metrics/R10: 71.62977867203219
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.327967806841047
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 44.51132382859376
 MSRVTT_full_val/v2t_metrics/R1: 26.559356136820927
 MSRVTT_full_val/v2t_metrics/R5: 63.78269617706238
 MSRVTT_full_val/v2t_metrics/R10: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.142857142857142
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.68457354228465
 MSRVTT_full_test/t2v_metrics/R1: 7.190635451505017
 MSRVTT_full_test/t2v_metrics/R5: 25.016722408026755
 MSRVTT_full_test/t2v_metrics/R10: 36.72240802675585
 MSRVTT_full_test/t2v_metrics/R50: 71.90635451505017
 MSRVTT_full_test/t2v_metrics/MedR: 19.0
 MSRVTT_full_test/t2v_metrics/MeanR: 61.86220735785953
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.763316787571974
 MSRVTT_full_test/v2t_metrics/R1: 9.933110367892976
 MSRVTT_full_test/v2t_metrics/R5: 28.82943143812709
 MSRVTT_full_test/v2t_metrics/R10: 42.84280936454849
 MSRVTT_full_test/v2t_metrics/R50: 77.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.8943143812709
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.063918424044036
 mnt_best       : 19.815430428173375
 not_improved_count: 1
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 3.43253 (QuantReg: 8.74314) QuantErr: 8.74314 batch_time=40.82144 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.44422 (QuantReg: 8.86721) QuantErr: 8.86721 batch_time=0.50524 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 3.56666 (QuantReg: 8.71335) QuantErr: 8.71335 batch_time=0.50006 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.89464 (QuantReg: 8.99664) QuantErr: 8.99664 batch_time=0.82335 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 3.27848 (QuantReg: 8.62022) QuantErr: 8.62022 batch_time=0.50899 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 3.33936 (QuantReg: 9.10406) QuantErr: 9.10406 batch_time=0.51261 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 3.19051 (QuantReg: 8.70761) QuantErr: 8.70761 batch_time=0.52499 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 3.32305 (QuantReg: 8.49810) QuantErr: 8.49810 batch_time=0.50262 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.99806 (QuantReg: 8.84956) QuantErr: 8.84956 batch_time=0.53637 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 3.37835 (QuantReg: 8.66274) QuantErr: 8.66274 batch_time=0.50686 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 3.21384 (QuantReg: 8.85074) QuantErr: 8.85074 batch_time=0.49094 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 3.17471 (QuantReg: 8.68341) QuantErr: 8.68341 batch_time=0.50912 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 3.20557 (QuantReg: 9.06376) QuantErr: 9.06376 batch_time=0.55197 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.74672 (QuantReg: 8.97294) QuantErr: 8.97294 batch_time=0.55444 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 3.20401 (QuantReg: 9.12493) QuantErr: 9.12493 batch_time=0.50233 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 3.13510 (QuantReg: 9.03919) QuantErr: 9.03919 batch_time=0.54085 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 3.09642 (QuantReg: 9.28384) QuantErr: 9.28384 batch_time=0.51052 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 3.26592 (QuantReg: 8.73754) QuantErr: 8.73754 batch_time=0.50164 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.99676 (QuantReg: 8.86870) QuantErr: 8.86870 batch_time=0.53244 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 3.25919 (QuantReg: 8.75532) QuantErr: 8.75532 batch_time=0.51902 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 3.20123 (QuantReg: 8.90953) QuantErr: 8.90953 batch_time=0.51291 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.82786 (QuantReg: 8.92601) QuantErr: 8.92601 batch_time=0.54189 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 3.03959 (QuantReg: 8.71608) QuantErr: 8.71608 batch_time=0.50398 
Train Epoch: 5 codebook_update_time=1.65685
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch5.pth ...
Done in 4.643s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch5.pth ...
Done in 9.325s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 3.170547881126404
 quant_reg      : 8.805496494293212
 quant_err      : 8.805496494293212
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 59.758551307847085
 MSRVTT_full_val/t2v_metrics/R10: 75.85513078470825
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.474849094567404
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.25307044367255
 MSRVTT_full_val/v2t_metrics/R1: 29.175050301810867
 MSRVTT_full_val/v2t_metrics/R5: 64.98993963782696
 MSRVTT_full_val/v2t_metrics/R10: 79.87927565392354
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.895372233400401
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.30450994802107
 MSRVTT_full_test/t2v_metrics/R1: 9.063545150501673
 MSRVTT_full_test/t2v_metrics/R5: 27.357859531772576
 MSRVTT_full_test/t2v_metrics/R10: 40.0
 MSRVTT_full_test/t2v_metrics/R50: 74.98327759197325
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.55819397993311
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.485562908087655
 MSRVTT_full_test/v2t_metrics/R1: 11.20401337792642
 MSRVTT_full_test/v2t_metrics/R5: 31.337792642140467
 MSRVTT_full_test/v2t_metrics/R10: 45.18394648829432
 MSRVTT_full_test/v2t_metrics/R50: 79.76588628762542
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 47.94882943143813
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.127082209230114
 mnt_best       : 21.485562908087655
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 3.31503 (QuantReg: 8.28360) QuantErr: 8.28360 batch_time=40.11799 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 3.21019 (QuantReg: 8.05114) QuantErr: 8.05114 batch_time=0.57322 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.80760 (QuantReg: 8.45016) QuantErr: 8.45016 batch_time=0.51917 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.93085 (QuantReg: 8.53140) QuantErr: 8.53140 batch_time=0.49706 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.65074 (QuantReg: 8.44987) QuantErr: 8.44987 batch_time=0.52131 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.76866 (QuantReg: 8.75597) QuantErr: 8.75597 batch_time=0.53019 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.85682 (QuantReg: 8.91278) QuantErr: 8.91278 batch_time=0.49560 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.73101 (QuantReg: 8.49535) QuantErr: 8.49535 batch_time=0.51624 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 3.32742 (QuantReg: 8.77588) QuantErr: 8.77588 batch_time=0.49521 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.90812 (QuantReg: 8.60736) QuantErr: 8.60736 batch_time=0.49891 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.99106 (QuantReg: 8.11824) QuantErr: 8.11824 batch_time=0.49603 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.83778 (QuantReg: 8.69330) QuantErr: 8.69330 batch_time=0.52381 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.83509 (QuantReg: 8.60323) QuantErr: 8.60323 batch_time=0.50403 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 3.01724 (QuantReg: 8.33820) QuantErr: 8.33820 batch_time=3.40245 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.74247 (QuantReg: 8.83310) QuantErr: 8.83310 batch_time=0.50157 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.76306 (QuantReg: 8.58801) QuantErr: 8.58801 batch_time=0.48775 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 3.16142 (QuantReg: 8.94202) QuantErr: 8.94202 batch_time=0.95752 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.89222 (QuantReg: 9.16814) QuantErr: 9.16814 batch_time=0.50689 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.93823 (QuantReg: 8.55306) QuantErr: 8.55306 batch_time=0.49030 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.87368 (QuantReg: 8.81452) QuantErr: 8.81452 batch_time=0.49766 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.80878 (QuantReg: 8.62155) QuantErr: 8.62155 batch_time=1.22003 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 3.07463 (QuantReg: 8.70056) QuantErr: 8.70056 batch_time=0.90938 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 3.02184 (QuantReg: 8.73673) QuantErr: 8.73673 batch_time=0.51062 
Train Epoch: 6 codebook_update_time=1.78495
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch6.pth ...
Done in 4.322s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch6.pth ...
Done in 15.311s
removing stale ckpt [epoch 5] [took 0.10s]
 epoch          : 6
 loss           : 2.993827298164368
 quant_reg      : 8.620305374145508
 quant_err      : 8.620305374145508
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 61.77062374245473
 MSRVTT_full_val/t2v_metrics/R10: 74.84909456740442
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.181086519114688
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.19723626696388
 MSRVTT_full_val/v2t_metrics/R1: 30.58350100603622
 MSRVTT_full_val/v2t_metrics/R5: 65.59356136820925
 MSRVTT_full_val/v2t_metrics/R10: 78.26961770623743
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.6841046277666
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.948644979924524
 MSRVTT_full_test/t2v_metrics/R1: 10.0
 MSRVTT_full_test/t2v_metrics/R5: 29.36454849498328
 MSRVTT_full_test/t2v_metrics/R10: 41.20401337792642
 MSRVTT_full_test/t2v_metrics/R50: 75.81939799331104
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.161204013377926
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.957307375236496
 MSRVTT_full_test/v2t_metrics/R1: 11.070234113712374
 MSRVTT_full_test/v2t_metrics/R5: 32.04013377926422
 MSRVTT_full_test/v2t_metrics/R10: 45.852842809364546
 MSRVTT_full_test/v2t_metrics/R50: 80.5685618729097
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.38662207357859
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.336063036141834
 mnt_best       : 22.957307375236496
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.89788 (QuantReg: 7.95394) QuantErr: 7.95394 batch_time=31.83483 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.72664 (QuantReg: 8.78274) QuantErr: 8.78274 batch_time=0.53346 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.96576 (QuantReg: 8.75802) QuantErr: 8.75802 batch_time=2.84469 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.83202 (QuantReg: 8.57943) QuantErr: 8.57943 batch_time=1.13634 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.74901 (QuantReg: 8.15250) QuantErr: 8.15250 batch_time=0.50866 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.98635 (QuantReg: 8.23004) QuantErr: 8.23004 batch_time=0.49271 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.95213 (QuantReg: 8.61137) QuantErr: 8.61137 batch_time=1.20148 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 3.21553 (QuantReg: 8.55984) QuantErr: 8.55984 batch_time=0.50005 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.95393 (QuantReg: 8.60965) QuantErr: 8.60965 batch_time=0.51028 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.86588 (QuantReg: 8.64419) QuantErr: 8.64419 batch_time=0.49846 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 3.02767 (QuantReg: 8.57058) QuantErr: 8.57058 batch_time=0.50558 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.46697 (QuantReg: 8.88451) QuantErr: 8.88451 batch_time=0.50803 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.71746 (QuantReg: 8.47041) QuantErr: 8.47041 batch_time=0.49333 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.92989 (QuantReg: 8.55650) QuantErr: 8.55650 batch_time=0.49078 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.86575 (QuantReg: 8.20452) QuantErr: 8.20452 batch_time=0.49894 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.76897 (QuantReg: 8.40073) QuantErr: 8.40073 batch_time=1.21776 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 2.56974 (QuantReg: 8.64886) QuantErr: 8.64886 batch_time=0.50852 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.83508 (QuantReg: 8.20711) QuantErr: 8.20711 batch_time=0.50196 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 2.35994 (QuantReg: 8.68453) QuantErr: 8.68453 batch_time=0.52538 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.63585 (QuantReg: 8.56564) QuantErr: 8.56564 batch_time=1.10044 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 3.23311 (QuantReg: 8.62993) QuantErr: 8.62993 batch_time=0.49165 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.79244 (QuantReg: 8.36901) QuantErr: 8.36901 batch_time=0.49279 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.84946 (QuantReg: 8.48457) QuantErr: 8.48457 batch_time=0.51970 
Train Epoch: 7 codebook_update_time=1.74308
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch7.pth ...
Done in 4.795s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 2.849834909439087
 quant_reg      : 8.562337953567505
 quant_err      : 8.562337953567505
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 27.766599597585515
 MSRVTT_full_val/t2v_metrics/R5: 61.3682092555332
 MSRVTT_full_val/t2v_metrics/R10: 75.0503018108652
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.661971830985916
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.3817053634723
 MSRVTT_full_val/v2t_metrics/R1: 29.577464788732396
 MSRVTT_full_val/v2t_metrics/R5: 67.80684104627767
 MSRVTT_full_val/v2t_metrics/R10: 79.87927565392354
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.368209255533198
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.3112158579596
 MSRVTT_full_test/t2v_metrics/R1: 8.695652173913043
 MSRVTT_full_test/t2v_metrics/R5: 28.662207357859533
 MSRVTT_full_test/t2v_metrics/R10: 40.903010033444815
 MSRVTT_full_test/t2v_metrics/R50: 75.68561872909699
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.02608695652174
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.68314899137463
 MSRVTT_full_test/v2t_metrics/R1: 11.705685618729097
 MSRVTT_full_test/v2t_metrics/R5: 32.34113712374582
 MSRVTT_full_test/v2t_metrics/R10: 47.9933110367893
 MSRVTT_full_test/v2t_metrics/R50: 80.60200668896321
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.151672240802675
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.28921499858743
 mnt_best       : 22.957307375236496
 not_improved_count: 1
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.80567 (QuantReg: 8.68004) QuantErr: 8.68004 batch_time=36.36306 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.94535 (QuantReg: 8.70411) QuantErr: 8.70411 batch_time=0.50313 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 3.09446 (QuantReg: 8.45464) QuantErr: 8.45464 batch_time=0.52369 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.77800 (QuantReg: 8.66173) QuantErr: 8.66173 batch_time=0.48584 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 3.11377 (QuantReg: 8.63901) QuantErr: 8.63901 batch_time=0.50894 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.95604 (QuantReg: 8.46328) QuantErr: 8.46328 batch_time=0.54693 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.68484 (QuantReg: 8.83052) QuantErr: 8.83052 batch_time=0.49167 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.63118 (QuantReg: 8.77955) QuantErr: 8.77955 batch_time=2.66374 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 3.06515 (QuantReg: 8.73549) QuantErr: 8.73549 batch_time=0.52484 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.64398 (QuantReg: 8.28878) QuantErr: 8.28878 batch_time=0.52282 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.74270 (QuantReg: 8.71348) QuantErr: 8.71348 batch_time=0.50267 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 3.05650 (QuantReg: 8.52277) QuantErr: 8.52277 batch_time=1.38361 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.64098 (QuantReg: 8.50592) QuantErr: 8.50592 batch_time=0.49030 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.49062 (QuantReg: 8.41309) QuantErr: 8.41309 batch_time=0.48818 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 3.01232 (QuantReg: 8.69260) QuantErr: 8.69260 batch_time=0.59636 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 2.61416 (QuantReg: 8.42805) QuantErr: 8.42805 batch_time=0.52507 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.89965 (QuantReg: 8.49700) QuantErr: 8.49700 batch_time=0.49385 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.99872 (QuantReg: 8.75843) QuantErr: 8.75843 batch_time=0.50730 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.34878 (QuantReg: 8.52160) QuantErr: 8.52160 batch_time=0.52408 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.41431 (QuantReg: 8.40542) QuantErr: 8.40542 batch_time=0.59466 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.41700 (QuantReg: 8.87407) QuantErr: 8.87407 batch_time=0.50061 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 2.12503 (QuantReg: 8.43999) QuantErr: 8.43999 batch_time=0.51078 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.29575 (QuantReg: 8.54765) QuantErr: 8.54765 batch_time=0.50360 
Train Epoch: 8 codebook_update_time=1.76059
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch8.pth ...
Done in 11.701s
removing stale ckpt [epoch 7] [took 0.06s]
 epoch          : 8
 loss           : 2.761152189254761
 quant_reg      : 8.518430122375488
 quant_err      : 8.518430122375488
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 23.74245472837022
 MSRVTT_full_val/t2v_metrics/R5: 61.3682092555332
 MSRVTT_full_val/t2v_metrics/R10: 73.44064386317908
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.859154929577464
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.47538714809595
 MSRVTT_full_val/v2t_metrics/R1: 28.973843058350102
 MSRVTT_full_val/v2t_metrics/R5: 66.59959758551308
 MSRVTT_full_val/v2t_metrics/R10: 79.07444668008048
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.318913480885312
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.436494073570955
 MSRVTT_full_test/t2v_metrics/R1: 8.929765886287626
 MSRVTT_full_test/t2v_metrics/R5: 29.39799331103679
 MSRVTT_full_test/t2v_metrics/R10: 41.63879598662207
 MSRVTT_full_test/t2v_metrics/R50: 75.65217391304348
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.739297658862874
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.19313428486773
 MSRVTT_full_test/v2t_metrics/R1: 10.501672240802675
 MSRVTT_full_test/v2t_metrics/R5: 32.30769230769231
 MSRVTT_full_test/v2t_metrics/R10: 46.65551839464883
 MSRVTT_full_test/v2t_metrics/R50: 80.73578595317726
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.75769230769231
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.108598513396124
 mnt_best       : 22.957307375236496
 not_improved_count: 2
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 2.80035 (QuantReg: 8.04115) QuantErr: 8.04115 batch_time=39.47127 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.55357 (QuantReg: 8.16975) QuantErr: 8.16975 batch_time=0.95697 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.82430 (QuantReg: 8.31321) QuantErr: 8.31321 batch_time=0.77479 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.91637 (QuantReg: 8.37815) QuantErr: 8.37815 batch_time=0.49730 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 3.01461 (QuantReg: 8.21257) QuantErr: 8.21257 batch_time=0.49760 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 2.93659 (QuantReg: 8.63647) QuantErr: 8.63647 batch_time=0.49542 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 2.63062 (QuantReg: 8.49904) QuantErr: 8.49904 batch_time=0.48732 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 2.42460 (QuantReg: 8.45849) QuantErr: 8.45849 batch_time=0.52979 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.84755 (QuantReg: 8.27382) QuantErr: 8.27382 batch_time=0.49425 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 2.67829 (QuantReg: 8.44625) QuantErr: 8.44625 batch_time=0.52110 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 2.65476 (QuantReg: 8.34321) QuantErr: 8.34321 batch_time=0.51302 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 2.61293 (QuantReg: 8.55029) QuantErr: 8.55029 batch_time=0.56518 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 2.71509 (QuantReg: 8.58084) QuantErr: 8.58084 batch_time=0.48754 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.75491 (QuantReg: 8.56202) QuantErr: 8.56202 batch_time=1.21507 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.71948 (QuantReg: 8.87803) QuantErr: 8.87803 batch_time=0.49084 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 2.84826 (QuantReg: 8.33460) QuantErr: 8.33460 batch_time=0.48833 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 2.30022 (QuantReg: 8.52070) QuantErr: 8.52070 batch_time=0.51309 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 2.43517 (QuantReg: 8.36849) QuantErr: 8.36849 batch_time=0.51032 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 2.42498 (QuantReg: 8.74361) QuantErr: 8.74361 batch_time=0.69233 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 2.58857 (QuantReg: 8.30020) QuantErr: 8.30020 batch_time=0.48397 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 2.61504 (QuantReg: 8.42797) QuantErr: 8.42797 batch_time=0.49394 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 2.70220 (QuantReg: 8.48230) QuantErr: 8.48230 batch_time=0.50530 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 2.21096 (QuantReg: 8.46750) QuantErr: 8.46750 batch_time=0.52993 
Train Epoch: 9 codebook_update_time=1.84452
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch9.pth ...
Done in 5.247s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch9.pth ...
Done in 10.279s
removing stale ckpt [epoch 8] [took 0.01s]
 epoch          : 9
 loss           : 2.6465283918380735
 quant_reg      : 8.450729997634888
 quant_err      : 8.450729997634888
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 27.96780684104628
 MSRVTT_full_val/t2v_metrics/R5: 62.57545271629779
 MSRVTT_full_val/t2v_metrics/R10: 75.45271629778672
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.736418511066399
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.92281815859953
 MSRVTT_full_val/v2t_metrics/R1: 29.979879275653925
 MSRVTT_full_val/v2t_metrics/R5: 67.80684104627767
 MSRVTT_full_val/v2t_metrics/R10: 79.07444668008048
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.404426559356136
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.372568759875506
 MSRVTT_full_test/t2v_metrics/R1: 9.732441471571907
 MSRVTT_full_test/t2v_metrics/R5: 29.431438127090303
 MSRVTT_full_test/t2v_metrics/R10: 42.30769230769231
 MSRVTT_full_test/t2v_metrics/R50: 76.75585284280936
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.7489966555184
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.969464686654593
 MSRVTT_full_test/v2t_metrics/R1: 11.036789297658864
 MSRVTT_full_test/v2t_metrics/R5: 33.21070234113712
 MSRVTT_full_test/v2t_metrics/R10: 47.491638795986624
 MSRVTT_full_test/v2t_metrics/R50: 80.8695652173913
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.052675585284284
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.916677385261263
 mnt_best       : 22.969464686654593
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 2.34362 (QuantReg: 7.95790) QuantErr: 7.95790 batch_time=45.71053 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 2.52518 (QuantReg: 8.43314) QuantErr: 8.43314 batch_time=0.55126 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.36883 (QuantReg: 8.05186) QuantErr: 8.05186 batch_time=0.52713 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.41048 (QuantReg: 8.13811) QuantErr: 8.13811 batch_time=0.54194 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 2.45655 (QuantReg: 8.68238) QuantErr: 8.68238 batch_time=0.50607 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 2.86205 (QuantReg: 8.40415) QuantErr: 8.40415 batch_time=0.51352 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.33468 (QuantReg: 8.37192) QuantErr: 8.37192 batch_time=0.53918 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 2.46542 (QuantReg: 8.19285) QuantErr: 8.19285 batch_time=0.50881 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 2.59175 (QuantReg: 8.45004) QuantErr: 8.45004 batch_time=0.50309 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.97586 (QuantReg: 8.16409) QuantErr: 8.16409 batch_time=0.49664 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 2.30969 (QuantReg: 8.31900) QuantErr: 8.31900 batch_time=0.52926 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.66274 (QuantReg: 8.45964) QuantErr: 8.45964 batch_time=0.50358 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 2.69607 (QuantReg: 8.46297) QuantErr: 8.46297 batch_time=0.56507 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 2.93534 (QuantReg: 8.42823) QuantErr: 8.42823 batch_time=0.52192 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 2.28561 (QuantReg: 8.56437) QuantErr: 8.56437 batch_time=0.50705 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.22382 (QuantReg: 8.39795) QuantErr: 8.39795 batch_time=0.53508 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 3.44669 (QuantReg: 8.51436) QuantErr: 8.51436 batch_time=0.51363 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 2.34576 (QuantReg: 8.61557) QuantErr: 8.61557 batch_time=0.50592 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 2.43312 (QuantReg: 8.80298) QuantErr: 8.80298 batch_time=0.50247 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 2.32439 (QuantReg: 8.39297) QuantErr: 8.39297 batch_time=0.51196 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 2.31481 (QuantReg: 8.05573) QuantErr: 8.05573 batch_time=0.49569 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 3.00685 (QuantReg: 8.54558) QuantErr: 8.54558 batch_time=0.52047 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 2.62618 (QuantReg: 8.26210) QuantErr: 8.26210 batch_time=0.56183 
Train Epoch: 10 codebook_update_time=1.71910
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch10.pth ...
Done in 4.540s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 2.5496216144561767
 quant_reg      : 8.395909038543701
 quant_err      : 8.395909038543701
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 26.559356136820927
 MSRVTT_full_val/t2v_metrics/R5: 60.160965794768615
 MSRVTT_full_val/t2v_metrics/R10: 76.25754527162978
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.235412474849095
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.576027163597686
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 65.3923541247485
 MSRVTT_full_val/v2t_metrics/R10: 79.67806841046277
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.515090543259557
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.68623104879141
 MSRVTT_full_test/t2v_metrics/R1: 9.264214046822742
 MSRVTT_full_test/t2v_metrics/R5: 28.963210702341136
 MSRVTT_full_test/t2v_metrics/R10: 42.30769230769231
 MSRVTT_full_test/t2v_metrics/R50: 76.2876254180602
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.99598662207358
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.474577726049763
 MSRVTT_full_test/v2t_metrics/R1: 11.070234113712374
 MSRVTT_full_test/v2t_metrics/R5: 32.675585284280935
 MSRVTT_full_test/v2t_metrics/R10: 47.290969899665555
 MSRVTT_full_test/v2t_metrics/R50: 81.1371237458194
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.9994983277592
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.76634400054173
 mnt_best       : 22.969464686654593
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 2.40435 (QuantReg: 8.34536) QuantErr: 8.34536 batch_time=37.14388 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.26512 (QuantReg: 8.46232) QuantErr: 8.46232 batch_time=0.50523 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 2.48361 (QuantReg: 8.04511) QuantErr: 8.04511 batch_time=0.50649 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 2.55206 (QuantReg: 8.47365) QuantErr: 8.47365 batch_time=0.93702 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.61865 (QuantReg: 8.72427) QuantErr: 8.72427 batch_time=0.50259 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 2.41728 (QuantReg: 8.31251) QuantErr: 8.31251 batch_time=0.56359 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 2.54850 (QuantReg: 8.06738) QuantErr: 8.06738 batch_time=0.52932 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 2.29276 (QuantReg: 8.45452) QuantErr: 8.45452 batch_time=0.49566 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 2.44797 (QuantReg: 8.19229) QuantErr: 8.19229 batch_time=0.51530 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 2.90980 (QuantReg: 8.21423) QuantErr: 8.21423 batch_time=0.50154 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 2.64593 (QuantReg: 8.10622) QuantErr: 8.10622 batch_time=0.50295 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 2.50654 (QuantReg: 8.63940) QuantErr: 8.63940 batch_time=0.51333 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 2.92842 (QuantReg: 8.13276) QuantErr: 8.13276 batch_time=0.50280 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 2.65718 (QuantReg: 8.31246) QuantErr: 8.31246 batch_time=0.50803 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 2.37344 (QuantReg: 7.99287) QuantErr: 7.99287 batch_time=0.51213 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.43538 (QuantReg: 8.02904) QuantErr: 8.02904 batch_time=0.97609 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 2.32829 (QuantReg: 8.15233) QuantErr: 8.15233 batch_time=0.51383 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 2.25557 (QuantReg: 8.30895) QuantErr: 8.30895 batch_time=0.49857 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 2.37821 (QuantReg: 8.68974) QuantErr: 8.68974 batch_time=0.51405 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 2.74183 (QuantReg: 8.54065) QuantErr: 8.54065 batch_time=0.49684 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 2.59616 (QuantReg: 8.69942) QuantErr: 8.69942 batch_time=0.51921 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 2.38087 (QuantReg: 8.49596) QuantErr: 8.49596 batch_time=0.51911 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 2.23865 (QuantReg: 8.73281) QuantErr: 8.73281 batch_time=0.52507 
Train Epoch: 11 codebook_update_time=1.86263
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch11.pth ...
Done in 4.335s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch11.pth ...
Done in 8.262s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 2.4736286954879763
 quant_reg      : 8.3900371799469
 quant_err      : 8.3900371799469
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 27.96780684104628
 MSRVTT_full_val/t2v_metrics/R5: 60.563380281690144
 MSRVTT_full_val/t2v_metrics/R10: 77.46478873239437
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.154929577464788
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.81488570148408
 MSRVTT_full_val/v2t_metrics/R1: 31.58953722334004
 MSRVTT_full_val/v2t_metrics/R5: 66.80080482897384
 MSRVTT_full_val/v2t_metrics/R10: 79.67806841046277
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.418511066398391
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.193497921313245
 MSRVTT_full_test/t2v_metrics/R1: 10.0
 MSRVTT_full_test/t2v_metrics/R5: 29.665551839464882
 MSRVTT_full_test/t2v_metrics/R10: 43.24414715719063
 MSRVTT_full_test/t2v_metrics/R50: 76.25418060200668
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.01939799331104
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.40956027672761
 MSRVTT_full_test/v2t_metrics/R1: 11.538461538461538
 MSRVTT_full_test/v2t_metrics/R5: 33.37792642140468
 MSRVTT_full_test/v2t_metrics/R10: 48.62876254180602
 MSRVTT_full_test/v2t_metrics/R50: 81.40468227424749
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.40886287625418
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.556254741206455
 mnt_best       : 23.40956027672761
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 2.45388 (QuantReg: 8.29667) QuantErr: 8.29667 batch_time=35.53156 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 2.62395 (QuantReg: 8.43632) QuantErr: 8.43632 batch_time=0.50977 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 2.24141 (QuantReg: 8.20150) QuantErr: 8.20150 batch_time=0.52380 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 2.34304 (QuantReg: 8.19348) QuantErr: 8.19348 batch_time=0.50636 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 2.14762 (QuantReg: 8.30533) QuantErr: 8.30533 batch_time=0.75435 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 2.45715 (QuantReg: 8.12950) QuantErr: 8.12950 batch_time=0.52046 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 2.15424 (QuantReg: 8.30710) QuantErr: 8.30710 batch_time=5.51192 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 2.35431 (QuantReg: 8.34807) QuantErr: 8.34807 batch_time=0.51813 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 2.24414 (QuantReg: 8.29351) QuantErr: 8.29351 batch_time=0.81656 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 2.70382 (QuantReg: 8.20411) QuantErr: 8.20411 batch_time=0.51788 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 2.10203 (QuantReg: 8.29691) QuantErr: 8.29691 batch_time=0.55286 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 2.59033 (QuantReg: 8.24210) QuantErr: 8.24210 batch_time=0.53808 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 2.15598 (QuantReg: 8.33104) QuantErr: 8.33104 batch_time=0.52642 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 2.18896 (QuantReg: 8.64405) QuantErr: 8.64405 batch_time=0.50654 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 2.45406 (QuantReg: 8.37643) QuantErr: 8.37643 batch_time=0.55036 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 2.07867 (QuantReg: 8.39933) QuantErr: 8.39933 batch_time=0.54908 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 2.18007 (QuantReg: 8.23509) QuantErr: 8.23509 batch_time=0.51813 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 2.73328 (QuantReg: 8.03338) QuantErr: 8.03338 batch_time=0.49323 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 2.69458 (QuantReg: 8.24255) QuantErr: 8.24255 batch_time=0.59723 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 2.59786 (QuantReg: 8.27096) QuantErr: 8.27096 batch_time=0.49242 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 2.40526 (QuantReg: 7.85552) QuantErr: 7.85552 batch_time=0.53348 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 2.30664 (QuantReg: 8.52204) QuantErr: 8.52204 batch_time=0.50609 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 2.56673 (QuantReg: 8.76486) QuantErr: 8.76486 batch_time=0.76609 
Train Epoch: 12 codebook_update_time=1.63634
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch12.pth ...
Done in 5.048s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 2.4059512128829956
 quant_reg      : 8.329371377944947
 quant_err      : 8.329371377944947
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 27.56539235412475
 MSRVTT_full_val/t2v_metrics/R5: 61.16700201207244
 MSRVTT_full_val/t2v_metrics/R10: 75.65392354124748
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.269617706237424
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.3389643688051
 MSRVTT_full_val/v2t_metrics/R1: 29.77867203219316
 MSRVTT_full_val/v2t_metrics/R5: 67.6056338028169
 MSRVTT_full_val/v2t_metrics/R10: 80.0804828973843
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.517102615694165
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.42581814677459
 MSRVTT_full_test/t2v_metrics/R1: 9.866220735785953
 MSRVTT_full_test/t2v_metrics/R5: 29.36454849498328
 MSRVTT_full_test/t2v_metrics/R10: 42.84280936454849
 MSRVTT_full_test/t2v_metrics/R50: 76.5551839464883
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.414715719063544
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.15353812345255
 MSRVTT_full_test/v2t_metrics/R1: 10.936454849498327
 MSRVTT_full_test/v2t_metrics/R5: 33.61204013377927
 MSRVTT_full_test/v2t_metrics/R10: 48.22742474916388
 MSRVTT_full_test/v2t_metrics/R50: 81.33779264214047
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.478595317725755
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.07485107206233
 mnt_best       : 23.40956027672761
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 2.19682 (QuantReg: 8.23326) QuantErr: 8.23326 batch_time=36.77957 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 2.87841 (QuantReg: 7.87070) QuantErr: 7.87070 batch_time=0.50201 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 2.57110 (QuantReg: 8.40661) QuantErr: 8.40661 batch_time=0.51085 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 2.20812 (QuantReg: 8.30681) QuantErr: 8.30681 batch_time=0.48960 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 2.44596 (QuantReg: 8.39647) QuantErr: 8.39647 batch_time=0.49357 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 2.30643 (QuantReg: 8.52170) QuantErr: 8.52170 batch_time=0.86570 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 2.36457 (QuantReg: 8.58799) QuantErr: 8.58799 batch_time=0.51762 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 2.66467 (QuantReg: 8.63814) QuantErr: 8.63814 batch_time=1.36658 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 2.10103 (QuantReg: 7.93274) QuantErr: 7.93274 batch_time=0.49294 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 2.47558 (QuantReg: 8.34057) QuantErr: 8.34057 batch_time=0.51029 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 2.45706 (QuantReg: 8.11498) QuantErr: 8.11498 batch_time=0.54783 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 2.09987 (QuantReg: 8.17969) QuantErr: 8.17969 batch_time=0.49793 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 2.25942 (QuantReg: 8.26654) QuantErr: 8.26654 batch_time=0.49511 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 2.32816 (QuantReg: 8.63454) QuantErr: 8.63454 batch_time=2.74454 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 2.47364 (QuantReg: 8.10776) QuantErr: 8.10776 batch_time=0.50447 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 2.18718 (QuantReg: 8.24839) QuantErr: 8.24839 batch_time=0.50135 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 2.07547 (QuantReg: 8.56392) QuantErr: 8.56392 batch_time=0.49255 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 2.59760 (QuantReg: 8.19182) QuantErr: 8.19182 batch_time=0.51118 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 2.09503 (QuantReg: 8.53197) QuantErr: 8.53197 batch_time=0.49273 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 2.70988 (QuantReg: 8.41025) QuantErr: 8.41025 batch_time=0.50129 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 2.64687 (QuantReg: 8.42998) QuantErr: 8.42998 batch_time=0.49455 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 2.27886 (QuantReg: 8.45477) QuantErr: 8.45477 batch_time=0.50505 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 2.24998 (QuantReg: 8.41097) QuantErr: 8.41097 batch_time=0.49513 
Train Epoch: 13 codebook_update_time=1.88010
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch13.pth ...
Done in 4.113s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch13.pth ...
Done in 26.205s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 2.3409380464553835
 quant_reg      : 8.337442255020141
 quant_err      : 8.337442255020141
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 62.97786720321932
 MSRVTT_full_val/t2v_metrics/R10: 76.25754527162978
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.432595573440643
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.0581917846743
 MSRVTT_full_val/v2t_metrics/R1: 32.394366197183096
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.780684104627767
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.47709249715213
 MSRVTT_full_test/t2v_metrics/R1: 9.966555183946488
 MSRVTT_full_test/t2v_metrics/R5: 30.100334448160535
 MSRVTT_full_test/t2v_metrics/R10: 42.97658862876254
 MSRVTT_full_test/t2v_metrics/R50: 77.59197324414716
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.77759197324415
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.448556472532992
 MSRVTT_full_test/v2t_metrics/R1: 11.137123745819398
 MSRVTT_full_test/v2t_metrics/R5: 33.07692307692308
 MSRVTT_full_test/v2t_metrics/R10: 49.163879598662206
 MSRVTT_full_test/v2t_metrics/R50: 81.70568561872909
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.2933110367893
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.261211958146387
 mnt_best       : 23.448556472532992
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 2.20810 (QuantReg: 8.40740) QuantErr: 8.40740 batch_time=45.10745 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 2.69733 (QuantReg: 8.52735) QuantErr: 8.52735 batch_time=0.50671 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 2.23480 (QuantReg: 8.46786) QuantErr: 8.46786 batch_time=0.52277 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 2.22840 (QuantReg: 8.30952) QuantErr: 8.30952 batch_time=0.54345 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 2.49872 (QuantReg: 8.25100) QuantErr: 8.25100 batch_time=0.59524 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 2.22117 (QuantReg: 8.04845) QuantErr: 8.04845 batch_time=0.53772 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 2.56784 (QuantReg: 8.29965) QuantErr: 8.29965 batch_time=0.56459 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 2.46421 (QuantReg: 7.80682) QuantErr: 7.80682 batch_time=0.52826 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 2.06409 (QuantReg: 7.96910) QuantErr: 7.96910 batch_time=0.55383 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 2.22004 (QuantReg: 8.01488) QuantErr: 8.01488 batch_time=0.50244 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 2.28248 (QuantReg: 8.33156) QuantErr: 8.33156 batch_time=0.55640 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 2.38675 (QuantReg: 8.07142) QuantErr: 8.07142 batch_time=0.50793 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 2.26099 (QuantReg: 8.72960) QuantErr: 8.72960 batch_time=0.53531 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 2.06610 (QuantReg: 8.44509) QuantErr: 8.44509 batch_time=1.53106 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 2.10701 (QuantReg: 8.30491) QuantErr: 8.30491 batch_time=0.50323 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 2.10505 (QuantReg: 8.29241) QuantErr: 8.29241 batch_time=0.52019 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 2.10090 (QuantReg: 8.14166) QuantErr: 8.14166 batch_time=0.49580 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 2.38889 (QuantReg: 8.63279) QuantErr: 8.63279 batch_time=0.54777 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 2.09940 (QuantReg: 8.00165) QuantErr: 8.00165 batch_time=0.52831 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 2.51046 (QuantReg: 8.06996) QuantErr: 8.06996 batch_time=2.75614 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 2.43833 (QuantReg: 8.46265) QuantErr: 8.46265 batch_time=0.51132 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 2.23987 (QuantReg: 8.48841) QuantErr: 8.48841 batch_time=0.50793 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 2.17521 (QuantReg: 8.33518) QuantErr: 8.33518 batch_time=0.52778 
Train Epoch: 14 codebook_update_time=1.64188
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch14.pth ...
Done in 7.950s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 2.2927296481132506
 quant_reg      : 8.301300720214844
 quant_err      : 8.301300720214844
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 27.16297786720322
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 75.85513078470825
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.267605633802816
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.410554818453015
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 67.40442655935614
 MSRVTT_full_val/v2t_metrics/R10: 80.48289738430583
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.283702213279678
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.66269629769511
 MSRVTT_full_test/t2v_metrics/R1: 9.933110367892976
 MSRVTT_full_test/t2v_metrics/R5: 29.096989966555185
 MSRVTT_full_test/t2v_metrics/R10: 42.77591973244147
 MSRVTT_full_test/t2v_metrics/R50: 75.95317725752508
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.580267558528426
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.12300255374094
 MSRVTT_full_test/v2t_metrics/R1: 10.468227424749164
 MSRVTT_full_test/v2t_metrics/R5: 33.37792642140468
 MSRVTT_full_test/v2t_metrics/R10: 47.591973244147155
 MSRVTT_full_test/v2t_metrics/R50: 80.8695652173913
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.11254180602007
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.524391930267537
 mnt_best       : 23.448556472532992
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 2.64414 (QuantReg: 7.98986) QuantErr: 7.98986 batch_time=41.78895 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 2.24169 (QuantReg: 8.10284) QuantErr: 8.10284 batch_time=0.49005 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 2.30993 (QuantReg: 8.07542) QuantErr: 8.07542 batch_time=0.60356 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 2.37312 (QuantReg: 8.00307) QuantErr: 8.00307 batch_time=0.51035 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 2.37297 (QuantReg: 8.52014) QuantErr: 8.52014 batch_time=0.55553 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 2.31369 (QuantReg: 7.87999) QuantErr: 7.87999 batch_time=0.50707 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 2.60621 (QuantReg: 8.08046) QuantErr: 8.08046 batch_time=0.77056 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 2.17252 (QuantReg: 8.19789) QuantErr: 8.19789 batch_time=1.20455 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 2.42175 (QuantReg: 8.27815) QuantErr: 8.27815 batch_time=0.50794 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 2.15627 (QuantReg: 8.34803) QuantErr: 8.34803 batch_time=0.50873 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 2.31701 (QuantReg: 8.13134) QuantErr: 8.13134 batch_time=0.50200 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.98566 (QuantReg: 8.04528) QuantErr: 8.04528 batch_time=0.50700 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 2.10056 (QuantReg: 8.02490) QuantErr: 8.02490 batch_time=0.49193 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 2.67935 (QuantReg: 8.43626) QuantErr: 8.43626 batch_time=2.14953 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 2.28326 (QuantReg: 8.03010) QuantErr: 8.03010 batch_time=0.50906 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 2.38019 (QuantReg: 8.45613) QuantErr: 8.45613 batch_time=0.50277 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 2.66768 (QuantReg: 8.45640) QuantErr: 8.45640 batch_time=0.49377 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 2.15048 (QuantReg: 8.21418) QuantErr: 8.21418 batch_time=0.49305 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 2.08096 (QuantReg: 8.38048) QuantErr: 8.38048 batch_time=0.85124 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 2.40818 (QuantReg: 8.06625) QuantErr: 8.06625 batch_time=0.50681 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 2.56884 (QuantReg: 8.42414) QuantErr: 8.42414 batch_time=0.51725 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 2.41879 (QuantReg: 8.56157) QuantErr: 8.56157 batch_time=0.50121 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 2.44882 (QuantReg: 8.05519) QuantErr: 8.05519 batch_time=0.57392 
Train Epoch: 15 codebook_update_time=1.70485
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch15.pth ...
Done in 3.914s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch15.pth ...
Done in 15.800s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 2.250026999950409
 quant_reg      : 8.265110805511474
 quant_err      : 8.265110805511474
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R10: 77.2635814889336
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.903420523138832
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.404084419094026
 MSRVTT_full_val/v2t_metrics/R1: 30.382293762575454
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.209255533199194
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.32828904719993
 MSRVTT_full_test/t2v_metrics/R1: 10.167224080267559
 MSRVTT_full_test/t2v_metrics/R5: 31.036789297658864
 MSRVTT_full_test/t2v_metrics/R10: 44.247491638795985
 MSRVTT_full_test/t2v_metrics/R50: 77.79264214046823
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.832441471571904
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.079970267604324
 MSRVTT_full_test/v2t_metrics/R1: 11.33779264214047
 MSRVTT_full_test/v2t_metrics/R5: 34.51505016722408
 MSRVTT_full_test/v2t_metrics/R10: 48.99665551839465
 MSRVTT_full_test/v2t_metrics/R50: 82.47491638795987
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.40451505016723
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.765035170546117
 mnt_best       : 24.079970267604324
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 2.10145 (QuantReg: 7.72115) QuantErr: 7.72115 batch_time=41.20747 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 2.15469 (QuantReg: 8.45861) QuantErr: 8.45861 batch_time=0.54902 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 2.54066 (QuantReg: 8.27451) QuantErr: 8.27451 batch_time=0.55008 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 2.14872 (QuantReg: 8.39441) QuantErr: 8.39441 batch_time=1.06976 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 2.04030 (QuantReg: 7.88247) QuantErr: 7.88247 batch_time=0.57765 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 2.18831 (QuantReg: 8.17199) QuantErr: 8.17199 batch_time=0.52090 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 2.35129 (QuantReg: 8.59673) QuantErr: 8.59673 batch_time=0.50938 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 2.07239 (QuantReg: 8.21200) QuantErr: 8.21200 batch_time=3.78532 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 2.19810 (QuantReg: 8.53523) QuantErr: 8.53523 batch_time=0.51107 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 2.03744 (QuantReg: 8.15040) QuantErr: 8.15040 batch_time=0.51389 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 2.36734 (QuantReg: 8.80235) QuantErr: 8.80235 batch_time=0.51574 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 2.43864 (QuantReg: 8.57479) QuantErr: 8.57479 batch_time=0.55753 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 2.28229 (QuantReg: 8.22411) QuantErr: 8.22411 batch_time=0.95471 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 2.01681 (QuantReg: 8.41634) QuantErr: 8.41634 batch_time=0.49162 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 2.31932 (QuantReg: 8.24971) QuantErr: 8.24971 batch_time=0.85641 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 2.13214 (QuantReg: 8.29171) QuantErr: 8.29171 batch_time=0.61058 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 2.27538 (QuantReg: 7.89063) QuantErr: 7.89063 batch_time=0.49825 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 2.05606 (QuantReg: 8.22401) QuantErr: 8.22401 batch_time=0.54459 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 2.35432 (QuantReg: 8.44139) QuantErr: 8.44139 batch_time=0.50786 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 2.11424 (QuantReg: 8.19353) QuantErr: 8.19353 batch_time=0.49780 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 2.02780 (QuantReg: 8.37865) QuantErr: 8.37865 batch_time=0.56964 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 2.09230 (QuantReg: 8.11750) QuantErr: 8.11750 batch_time=0.50944 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 2.30488 (QuantReg: 8.57713) QuantErr: 8.57713 batch_time=0.53836 
Train Epoch: 16 codebook_update_time=1.97423
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch16.pth ...
Done in 20.160s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch16.pth ...
Done in 23.961s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 2.216130021095276
 quant_reg      : 8.282056791305543
 quant_err      : 8.282056791305543
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 64.1851106639839
 MSRVTT_full_val/t2v_metrics/R10: 76.65995975855131
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.338028169014084
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.83774245163637
 MSRVTT_full_val/v2t_metrics/R1: 29.979879275653925
 MSRVTT_full_val/v2t_metrics/R5: 68.00804828973843
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.020120724346077
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.97470934587136
 MSRVTT_full_test/t2v_metrics/R1: 10.735785953177258
 MSRVTT_full_test/t2v_metrics/R5: 31.337792642140467
 MSRVTT_full_test/t2v_metrics/R10: 45.01672240802676
 MSRVTT_full_test/t2v_metrics/R50: 78.66220735785953
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.73829431438127
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.741462783291624
 MSRVTT_full_test/v2t_metrics/R1: 11.705685618729097
 MSRVTT_full_test/v2t_metrics/R5: 34.51505016722408
 MSRVTT_full_test/v2t_metrics/R10: 49.063545150501675
 MSRVTT_full_test/v2t_metrics/R50: 82.0066889632107
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.137123745819395
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.063757715521316
 mnt_best       : 24.741462783291624
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 2.25056 (QuantReg: 8.12939) QuantErr: 8.12939 batch_time=38.95447 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 2.41181 (QuantReg: 8.15738) QuantErr: 8.15738 batch_time=1.57291 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 2.04244 (QuantReg: 8.11090) QuantErr: 8.11090 batch_time=0.51017 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.95051 (QuantReg: 7.95608) QuantErr: 7.95608 batch_time=0.48729 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 2.35798 (QuantReg: 8.02160) QuantErr: 8.02160 batch_time=0.49766 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 2.01541 (QuantReg: 7.96897) QuantErr: 7.96897 batch_time=0.49148 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 2.08353 (QuantReg: 8.66969) QuantErr: 8.66969 batch_time=0.49983 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 2.25548 (QuantReg: 8.13684) QuantErr: 8.13684 batch_time=0.49135 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 2.11141 (QuantReg: 8.57851) QuantErr: 8.57851 batch_time=0.48794 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 2.12022 (QuantReg: 8.41499) QuantErr: 8.41499 batch_time=0.48490 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 2.26715 (QuantReg: 8.36331) QuantErr: 8.36331 batch_time=0.52249 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 2.15112 (QuantReg: 8.17457) QuantErr: 8.17457 batch_time=0.77446 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 2.00414 (QuantReg: 8.07421) QuantErr: 8.07421 batch_time=1.12029 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 2.52842 (QuantReg: 8.07618) QuantErr: 8.07618 batch_time=0.53006 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 2.23059 (QuantReg: 8.42020) QuantErr: 8.42020 batch_time=1.24872 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.98778 (QuantReg: 7.98480) QuantErr: 7.98480 batch_time=0.48503 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 2.04778 (QuantReg: 7.96653) QuantErr: 7.96653 batch_time=0.48421 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 2.00027 (QuantReg: 8.20552) QuantErr: 8.20552 batch_time=0.48015 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 2.42271 (QuantReg: 8.78679) QuantErr: 8.78679 batch_time=1.20409 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 2.20175 (QuantReg: 8.38707) QuantErr: 8.38707 batch_time=0.48966 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.94320 (QuantReg: 8.07141) QuantErr: 8.07141 batch_time=0.50422 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 2.35763 (QuantReg: 8.72918) QuantErr: 8.72918 batch_time=0.48911 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 2.05446 (QuantReg: 8.29049) QuantErr: 8.29049 batch_time=0.50321 
Train Epoch: 17 codebook_update_time=1.64409
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch17.pth ...
Done in 4.080s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 2.1711892404556274
 quant_reg      : 8.285257997512817
 quant_err      : 8.285257997512817
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 26.156941649899398
 MSRVTT_full_val/t2v_metrics/R5: 63.98390342052314
 MSRVTT_full_val/t2v_metrics/R10: 77.8672032193159
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.024144869215291
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.699548335121804
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 67.40442655935614
 MSRVTT_full_val/v2t_metrics/R10: 80.48289738430583
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.440643863179075
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.42683458585048
 MSRVTT_full_test/t2v_metrics/R1: 10.836120401337793
 MSRVTT_full_test/t2v_metrics/R5: 31.036789297658864
 MSRVTT_full_test/t2v_metrics/R10: 44.448160535117054
 MSRVTT_full_test/t2v_metrics/R50: 77.55852842809365
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.85167224080268
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.633992269391968
 MSRVTT_full_test/v2t_metrics/R1: 10.267558528428093
 MSRVTT_full_test/v2t_metrics/R5: 34.381270903010034
 MSRVTT_full_test/v2t_metrics/R10: 48.72909698996656
 MSRVTT_full_test/v2t_metrics/R50: 81.60535117056857
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.22274247491639
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.814229034600412
 mnt_best       : 24.741462783291624
 not_improved_count: 1
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 2.40504 (QuantReg: 8.42646) QuantErr: 8.42646 batch_time=38.47575 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 2.04686 (QuantReg: 8.38764) QuantErr: 8.38764 batch_time=0.50120 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 2.19103 (QuantReg: 8.30361) QuantErr: 8.30361 batch_time=0.50543 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 2.10249 (QuantReg: 8.07303) QuantErr: 8.07303 batch_time=0.48569 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 2.32232 (QuantReg: 8.26627) QuantErr: 8.26627 batch_time=0.48482 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 2.16182 (QuantReg: 8.27394) QuantErr: 8.27394 batch_time=0.49681 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 2.42456 (QuantReg: 8.18218) QuantErr: 8.18218 batch_time=0.51935 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 2.36365 (QuantReg: 8.26038) QuantErr: 8.26038 batch_time=0.48416 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.96977 (QuantReg: 8.29432) QuantErr: 8.29432 batch_time=0.50113 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 2.05385 (QuantReg: 8.27935) QuantErr: 8.27935 batch_time=0.73034 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.89405 (QuantReg: 8.17991) QuantErr: 8.17991 batch_time=0.50723 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 2.30146 (QuantReg: 8.13871) QuantErr: 8.13871 batch_time=0.51002 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 2.59253 (QuantReg: 8.46220) QuantErr: 8.46220 batch_time=0.48736 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.99646 (QuantReg: 8.18743) QuantErr: 8.18743 batch_time=0.61498 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 2.09332 (QuantReg: 8.44595) QuantErr: 8.44595 batch_time=0.48600 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 2.36883 (QuantReg: 8.41612) QuantErr: 8.41612 batch_time=0.48405 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 2.08090 (QuantReg: 8.22621) QuantErr: 8.22621 batch_time=0.48119 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.97005 (QuantReg: 8.19661) QuantErr: 8.19661 batch_time=0.48618 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 2.00139 (QuantReg: 7.97225) QuantErr: 7.97225 batch_time=0.50147 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 2.56089 (QuantReg: 8.49303) QuantErr: 8.49303 batch_time=1.81647 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 2.29707 (QuantReg: 8.41281) QuantErr: 8.41281 batch_time=0.48783 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.75337 (QuantReg: 8.21629) QuantErr: 8.21629 batch_time=0.50680 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 2.10370 (QuantReg: 8.39651) QuantErr: 8.39651 batch_time=0.48683 
Train Epoch: 18 codebook_update_time=1.96510
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch18.pth ...
Done in 4.241s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch18.pth ...
Done in 8.710s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 2.1305343732833864
 quant_reg      : 8.274341835021973
 quant_err      : 8.274341835021973
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 27.56539235412475
 MSRVTT_full_val/t2v_metrics/R5: 63.98390342052314
 MSRVTT_full_val/t2v_metrics/R10: 77.2635814889336
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.273641851106639
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.46001578638016
 MSRVTT_full_val/v2t_metrics/R1: 30.18108651911469
 MSRVTT_full_val/v2t_metrics/R5: 68.81287726358148
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.976861167002012
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.313916195781154
 MSRVTT_full_test/t2v_metrics/R1: 10.869565217391305
 MSRVTT_full_test/t2v_metrics/R5: 31.672240802675585
 MSRVTT_full_test/t2v_metrics/R10: 45.11705685618729
 MSRVTT_full_test/t2v_metrics/R50: 77.62541806020067
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.63010033444816
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.95038443207153
 MSRVTT_full_test/v2t_metrics/R1: 11.806020066889632
 MSRVTT_full_test/v2t_metrics/R5: 34.280936454849495
 MSRVTT_full_test/v2t_metrics/R10: 48.66220735785953
 MSRVTT_full_test/v2t_metrics/R50: 82.0066889632107
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.30434782608695
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.005320324289954
 mnt_best       : 24.95038443207153
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 2.06585 (QuantReg: 8.27691) QuantErr: 8.27691 batch_time=37.54569 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 2.06084 (QuantReg: 8.32902) QuantErr: 8.32902 batch_time=0.49877 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 2.22257 (QuantReg: 8.13867) QuantErr: 8.13867 batch_time=0.49780 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 2.22324 (QuantReg: 8.48367) QuantErr: 8.48367 batch_time=0.51956 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 2.19849 (QuantReg: 8.33795) QuantErr: 8.33795 batch_time=0.50067 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 2.13580 (QuantReg: 8.44574) QuantErr: 8.44574 batch_time=0.50141 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 2.04335 (QuantReg: 8.08535) QuantErr: 8.08535 batch_time=0.60071 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 2.25517 (QuantReg: 8.61457) QuantErr: 8.61457 batch_time=0.53134 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 2.14920 (QuantReg: 8.04021) QuantErr: 8.04021 batch_time=0.49441 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 2.04121 (QuantReg: 8.28842) QuantErr: 8.28842 batch_time=0.49062 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 2.02381 (QuantReg: 8.20333) QuantErr: 8.20333 batch_time=0.50561 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 2.12772 (QuantReg: 8.43835) QuantErr: 8.43835 batch_time=0.50705 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 2.14206 (QuantReg: 8.26486) QuantErr: 8.26486 batch_time=0.49434 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.73873 (QuantReg: 8.11173) QuantErr: 8.11173 batch_time=0.49032 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 2.17901 (QuantReg: 8.42201) QuantErr: 8.42201 batch_time=0.49192 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.71324 (QuantReg: 8.04545) QuantErr: 8.04545 batch_time=0.52198 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 2.19868 (QuantReg: 8.24865) QuantErr: 8.24865 batch_time=1.92514 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 2.30672 (QuantReg: 8.39716) QuantErr: 8.39716 batch_time=0.52143 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 2.05106 (QuantReg: 8.22175) QuantErr: 8.22175 batch_time=0.51739 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.81007 (QuantReg: 8.37391) QuantErr: 8.37391 batch_time=0.58945 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.84707 (QuantReg: 8.38934) QuantErr: 8.38934 batch_time=0.50096 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.90183 (QuantReg: 8.39002) QuantErr: 8.39002 batch_time=0.50060 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 2.09987 (QuantReg: 8.24250) QuantErr: 8.24250 batch_time=0.50014 
Train Epoch: 19 codebook_update_time=2.25715
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch19.pth ...
Done in 4.007s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 2.0810467495918274
 quant_reg      : 8.265974439620972
 quant_err      : 8.265974439620972
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_full_val/t2v_metrics/R1: 28.772635814889338
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 77.06237424547284
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.317907444668007
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.53511275813604
 MSRVTT_full_val/v2t_metrics/R1: 32.19315895372233
 MSRVTT_full_val/v2t_metrics/R5: 66.80080482897384
 MSRVTT_full_val/v2t_metrics/R10: 80.28169014084507
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.134808853118713
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.68274012914706
 MSRVTT_full_test/t2v_metrics/R1: 10.367892976588628
 MSRVTT_full_test/t2v_metrics/R5: 31.270903010033443
 MSRVTT_full_test/t2v_metrics/R10: 45.45150501672241
 MSRVTT_full_test/t2v_metrics/R50: 77.52508361204013
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.939632107023414
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.516571252816178
 MSRVTT_full_test/v2t_metrics/R1: 12.107023411371237
 MSRVTT_full_test/v2t_metrics/R5: 34.91638795986622
 MSRVTT_full_test/v2t_metrics/R10: 49.39799331103679
 MSRVTT_full_test/v2t_metrics/R50: 82.40802675585284
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.71086956521739
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.53755218567201
 mnt_best       : 24.95038443207153
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 2.09456 (QuantReg: 8.14890) QuantErr: 8.14890 batch_time=38.50363 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 2.22325 (QuantReg: 7.94669) QuantErr: 7.94669 batch_time=0.51601 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.98094 (QuantReg: 8.15953) QuantErr: 8.15953 batch_time=0.50284 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 2.11105 (QuantReg: 8.41042) QuantErr: 8.41042 batch_time=0.49152 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 2.18704 (QuantReg: 8.44637) QuantErr: 8.44637 batch_time=0.50806 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.92899 (QuantReg: 8.02965) QuantErr: 8.02965 batch_time=0.48950 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.95861 (QuantReg: 8.32125) QuantErr: 8.32125 batch_time=0.55549 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.85748 (QuantReg: 8.18176) QuantErr: 8.18176 batch_time=0.51412 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 2.38689 (QuantReg: 8.18289) QuantErr: 8.18289 batch_time=0.53919 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 2.02854 (QuantReg: 8.36538) QuantErr: 8.36538 batch_time=0.49722 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.81353 (QuantReg: 8.37356) QuantErr: 8.37356 batch_time=0.53402 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.83866 (QuantReg: 8.16603) QuantErr: 8.16603 batch_time=0.49525 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 2.10683 (QuantReg: 8.05021) QuantErr: 8.05021 batch_time=1.13822 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 2.15338 (QuantReg: 8.25961) QuantErr: 8.25961 batch_time=0.59427 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 2.20364 (QuantReg: 8.03515) QuantErr: 8.03515 batch_time=0.63800 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 2.32242 (QuantReg: 8.34354) QuantErr: 8.34354 batch_time=0.49218 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 2.16839 (QuantReg: 8.60615) QuantErr: 8.60615 batch_time=0.49983 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 2.11476 (QuantReg: 8.45552) QuantErr: 8.45552 batch_time=0.51153 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.92065 (QuantReg: 8.21088) QuantErr: 8.21088 batch_time=0.50514 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 2.49274 (QuantReg: 8.02103) QuantErr: 8.02103 batch_time=0.60896 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 2.52122 (QuantReg: 8.00436) QuantErr: 8.00436 batch_time=0.50317 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.95265 (QuantReg: 8.25586) QuantErr: 8.25586 batch_time=0.49101 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.81312 (QuantReg: 8.54723) QuantErr: 8.54723 batch_time=0.51555 
Train Epoch: 20 codebook_update_time=1.73915
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch20.pth ...
Done in 4.135s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch20.pth ...
Done in 8.167s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 2.0778975439071656
 quant_reg      : 8.235774129867554
 quant_err      : 8.235774129867554
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 29.175050301810867
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.969818913480886
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.98935767549224
 MSRVTT_full_val/v2t_metrics/R1: 34.00402414486921
 MSRVTT_full_val/v2t_metrics/R5: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R10: 82.69617706237425
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.682092555331992
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.95255675457157
 MSRVTT_full_test/t2v_metrics/R1: 11.20401337792642
 MSRVTT_full_test/t2v_metrics/R5: 31.906354515050168
 MSRVTT_full_test/t2v_metrics/R10: 45.65217391304348
 MSRVTT_full_test/t2v_metrics/R50: 78.22742474916387
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.936120401337796
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.365149287385737
 MSRVTT_full_test/v2t_metrics/R1: 11.638795986622073
 MSRVTT_full_test/v2t_metrics/R5: 34.31438127090301
 MSRVTT_full_test/v2t_metrics/R10: 49.03010033444816
 MSRVTT_full_test/v2t_metrics/R50: 82.44147157190635
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.40635451505017
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.95353117267894
 mnt_best       : 25.365149287385737
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 2.08594 (QuantReg: 8.29095) QuantErr: 8.29095 batch_time=37.76170 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 2.07800 (QuantReg: 8.31822) QuantErr: 8.31822 batch_time=0.49207 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 2.01364 (QuantReg: 7.98700) QuantErr: 7.98700 batch_time=0.51196 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.86371 (QuantReg: 8.52308) QuantErr: 8.52308 batch_time=0.49445 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.76569 (QuantReg: 8.23886) QuantErr: 8.23886 batch_time=0.50122 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.90994 (QuantReg: 8.63847) QuantErr: 8.63847 batch_time=0.49995 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 2.12696 (QuantReg: 8.24650) QuantErr: 8.24650 batch_time=2.64713 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 2.01598 (QuantReg: 7.91311) QuantErr: 7.91311 batch_time=0.49561 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 2.20540 (QuantReg: 8.31055) QuantErr: 8.31055 batch_time=0.49527 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 2.20153 (QuantReg: 7.96890) QuantErr: 7.96890 batch_time=0.51643 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.99715 (QuantReg: 8.02419) QuantErr: 8.02419 batch_time=0.48328 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 2.00021 (QuantReg: 8.44606) QuantErr: 8.44606 batch_time=0.51289 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.71267 (QuantReg: 7.81342) QuantErr: 7.81342 batch_time=0.48681 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 2.19958 (QuantReg: 8.54314) QuantErr: 8.54314 batch_time=0.49410 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 2.03542 (QuantReg: 8.10298) QuantErr: 8.10298 batch_time=0.49354 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 2.06020 (QuantReg: 8.52769) QuantErr: 8.52769 batch_time=0.53867 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 2.18434 (QuantReg: 8.60666) QuantErr: 8.60666 batch_time=0.50101 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.96026 (QuantReg: 8.19468) QuantErr: 8.19468 batch_time=0.49030 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.97375 (QuantReg: 8.23021) QuantErr: 8.23021 batch_time=0.50147 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 2.23422 (QuantReg: 8.04973) QuantErr: 8.04973 batch_time=1.32078 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 2.00946 (QuantReg: 8.28802) QuantErr: 8.28802 batch_time=0.48952 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 2.05539 (QuantReg: 8.60492) QuantErr: 8.60492 batch_time=0.49989 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.81024 (QuantReg: 8.12963) QuantErr: 8.12963 batch_time=0.48925 
Train Epoch: 21 codebook_update_time=1.85536
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch21.pth ...
Done in 3.888s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 2.0420400552749634
 quant_reg      : 8.239149379730225
 quant_err      : 8.239149379730225
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_full_val/t2v_metrics/R1: 26.156941649899398
 MSRVTT_full_val/t2v_metrics/R5: 63.17907444668008
 MSRVTT_full_val/t2v_metrics/R10: 78.06841046277665
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.559356136820925
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.52952161370112
 MSRVTT_full_val/v2t_metrics/R1: 31.187122736418512
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.301810865191147
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.81258754011871
 MSRVTT_full_test/t2v_metrics/R1: 11.036789297658864
 MSRVTT_full_test/t2v_metrics/R5: 31.37123745819398
 MSRVTT_full_test/t2v_metrics/R10: 44.64882943143812
 MSRVTT_full_test/t2v_metrics/R50: 77.65886287625418
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.39096989966555
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.911210201112205
 MSRVTT_full_test/v2t_metrics/R1: 11.404682274247492
 MSRVTT_full_test/v2t_metrics/R5: 34.280936454849495
 MSRVTT_full_test/v2t_metrics/R10: 48.79598662207358
 MSRVTT_full_test/v2t_metrics/R50: 82.10702341137124
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.23076923076923
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.720217592387492
 mnt_best       : 25.365149287385737
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 2.30278 (QuantReg: 8.03608) QuantErr: 8.03608 batch_time=37.70648 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 2.05523 (QuantReg: 8.39049) QuantErr: 8.39049 batch_time=0.51000 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.99609 (QuantReg: 8.25082) QuantErr: 8.25082 batch_time=0.49858 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.95498 (QuantReg: 7.80825) QuantErr: 7.80825 batch_time=0.49245 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 2.04607 (QuantReg: 8.39365) QuantErr: 8.39365 batch_time=0.49747 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.82786 (QuantReg: 8.14964) QuantErr: 8.14964 batch_time=0.50127 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.97094 (QuantReg: 7.98800) QuantErr: 7.98800 batch_time=0.49134 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.81872 (QuantReg: 8.05603) QuantErr: 8.05603 batch_time=0.51112 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 2.26121 (QuantReg: 7.80697) QuantErr: 7.80697 batch_time=0.50654 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 2.13868 (QuantReg: 8.27645) QuantErr: 8.27645 batch_time=0.53886 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 2.28480 (QuantReg: 8.20735) QuantErr: 8.20735 batch_time=0.49026 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.95238 (QuantReg: 8.33351) QuantErr: 8.33351 batch_time=0.56456 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 2.16542 (QuantReg: 8.27817) QuantErr: 8.27817 batch_time=1.22281 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 2.15487 (QuantReg: 8.18495) QuantErr: 8.18495 batch_time=5.00031 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 2.09910 (QuantReg: 8.26601) QuantErr: 8.26601 batch_time=0.85829 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 2.17301 (QuantReg: 8.11970) QuantErr: 8.11970 batch_time=0.49775 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 2.19770 (QuantReg: 8.24016) QuantErr: 8.24016 batch_time=0.48527 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 2.12420 (QuantReg: 8.50345) QuantErr: 8.50345 batch_time=0.51437 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.99110 (QuantReg: 7.83930) QuantErr: 7.83930 batch_time=0.51511 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 2.03465 (QuantReg: 8.20151) QuantErr: 8.20151 batch_time=0.49020 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 2.20919 (QuantReg: 8.28054) QuantErr: 8.28054 batch_time=0.49332 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.94951 (QuantReg: 8.13937) QuantErr: 8.13937 batch_time=0.48359 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.79426 (QuantReg: 8.39286) QuantErr: 8.39286 batch_time=0.49834 
Train Epoch: 22 codebook_update_time=1.83258
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch22.pth ...
Done in 4.223s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch22.pth ...
Done in 8.019s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 2.004550972938538
 quant_reg      : 8.228569885253906
 quant_err      : 8.228569885253906
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 65.59356136820925
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.215291750503019
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.78377679993871
 MSRVTT_full_val/v2t_metrics/R1: 30.784708249496983
 MSRVTT_full_val/v2t_metrics/R5: 67.20321931589537
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.360160965794769
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.42393369938291
 MSRVTT_full_test/t2v_metrics/R1: 11.471571906354516
 MSRVTT_full_test/t2v_metrics/R5: 32.240802675585286
 MSRVTT_full_test/t2v_metrics/R10: 45.551839464882946
 MSRVTT_full_test/t2v_metrics/R50: 78.12709030100335
 MSRVTT_full_test/t2v_metrics/MedR: 12.5
 MSRVTT_full_test/t2v_metrics/MeanR: 51.01789297658863
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.635683366336533
 MSRVTT_full_test/v2t_metrics/R1: 11.638795986622073
 MSRVTT_full_test/v2t_metrics/R5: 35.18394648829432
 MSRVTT_full_test/v2t_metrics/R10: 49.39799331103679
 MSRVTT_full_test/v2t_metrics/R50: 82.10702341137124
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.49799331103679
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.247122107675118
 mnt_best       : 25.635683366336533
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 2.02541 (QuantReg: 7.81443) QuantErr: 7.81443 batch_time=43.89350 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 2.10603 (QuantReg: 8.42040) QuantErr: 8.42040 batch_time=0.52918 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.66724 (QuantReg: 8.33669) QuantErr: 8.33669 batch_time=0.50187 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 2.10206 (QuantReg: 8.30782) QuantErr: 8.30782 batch_time=0.53429 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 2.10682 (QuantReg: 8.41202) QuantErr: 8.41202 batch_time=0.51280 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 2.01306 (QuantReg: 8.20415) QuantErr: 8.20415 batch_time=0.52136 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.99677 (QuantReg: 8.21881) QuantErr: 8.21881 batch_time=0.52569 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 2.08770 (QuantReg: 8.39574) QuantErr: 8.39574 batch_time=2.52618 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 2.09828 (QuantReg: 7.89224) QuantErr: 7.89224 batch_time=0.50208 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.74986 (QuantReg: 8.19474) QuantErr: 8.19474 batch_time=0.50838 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 2.12435 (QuantReg: 8.00459) QuantErr: 8.00459 batch_time=0.52699 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 2.03065 (QuantReg: 7.94843) QuantErr: 7.94843 batch_time=0.50545 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.85432 (QuantReg: 8.25225) QuantErr: 8.25225 batch_time=0.63802 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 2.13086 (QuantReg: 8.36954) QuantErr: 8.36954 batch_time=0.50640 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 2.12679 (QuantReg: 8.22689) QuantErr: 8.22689 batch_time=0.50179 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 2.09215 (QuantReg: 7.95938) QuantErr: 7.95938 batch_time=0.51593 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.80847 (QuantReg: 8.55932) QuantErr: 8.55932 batch_time=0.62190 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 2.01194 (QuantReg: 8.23058) QuantErr: 8.23058 batch_time=0.48996 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.72902 (QuantReg: 8.60202) QuantErr: 8.60202 batch_time=0.51826 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.89997 (QuantReg: 8.36934) QuantErr: 8.36934 batch_time=0.49531 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.77856 (QuantReg: 8.45829) QuantErr: 8.45829 batch_time=0.53285 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 2.01932 (QuantReg: 8.36639) QuantErr: 8.36639 batch_time=0.49953 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.90908 (QuantReg: 7.81116) QuantErr: 7.81116 batch_time=0.50212 
Train Epoch: 23 codebook_update_time=1.82666
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch23.pth ...
Done in 22.855s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 2.0182587089538573
 quant_reg      : 8.231296373367309
 quant_err      : 8.231296373367309
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_full_val/t2v_metrics/R1: 28.772635814889338
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.686116700201207
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.744599647266135
 MSRVTT_full_val/v2t_metrics/R1: 31.58953722334004
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.9396378269617705
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.00544548799877
 MSRVTT_full_test/t2v_metrics/R1: 11.137123745819398
 MSRVTT_full_test/t2v_metrics/R5: 31.237458193979933
 MSRVTT_full_test/t2v_metrics/R10: 45.08361204013378
 MSRVTT_full_test/t2v_metrics/R50: 77.1571906354515
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.285451505016724
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.03163085908763
 MSRVTT_full_test/v2t_metrics/R1: 11.57190635451505
 MSRVTT_full_test/v2t_metrics/R5: 34.214046822742475
 MSRVTT_full_test/v2t_metrics/R10: 49.197324414715716
 MSRVTT_full_test/v2t_metrics/R50: 81.90635451505017
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.364214046822745
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.90607076494314
 mnt_best       : 25.635683366336533
 not_improved_count: 1
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 2.20913 (QuantReg: 7.94457) QuantErr: 7.94457 batch_time=39.06389 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.91555 (QuantReg: 8.24510) QuantErr: 8.24510 batch_time=0.49841 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.80154 (QuantReg: 8.31773) QuantErr: 8.31773 batch_time=0.49593 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 2.19041 (QuantReg: 8.34057) QuantErr: 8.34057 batch_time=0.50681 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 2.15942 (QuantReg: 8.09486) QuantErr: 8.09486 batch_time=0.49828 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.62852 (QuantReg: 8.22101) QuantErr: 8.22101 batch_time=0.50929 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.76227 (QuantReg: 8.50485) QuantErr: 8.50485 batch_time=0.50590 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 2.10274 (QuantReg: 8.05182) QuantErr: 8.05182 batch_time=0.51544 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.87127 (QuantReg: 8.17640) QuantErr: 8.17640 batch_time=0.60803 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.96051 (QuantReg: 8.31099) QuantErr: 8.31099 batch_time=0.52452 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 2.06917 (QuantReg: 8.02390) QuantErr: 8.02390 batch_time=0.49518 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 2.17037 (QuantReg: 8.20077) QuantErr: 8.20077 batch_time=0.49187 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.92141 (QuantReg: 8.19805) QuantErr: 8.19805 batch_time=0.49074 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 2.42967 (QuantReg: 8.57048) QuantErr: 8.57048 batch_time=0.48453 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 2.07845 (QuantReg: 7.73314) QuantErr: 7.73314 batch_time=0.49203 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.83553 (QuantReg: 8.23438) QuantErr: 8.23438 batch_time=0.55096 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.87823 (QuantReg: 8.42848) QuantErr: 8.42848 batch_time=0.52891 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.81427 (QuantReg: 8.20848) QuantErr: 8.20848 batch_time=0.49439 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.99411 (QuantReg: 8.17552) QuantErr: 8.17552 batch_time=3.82470 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.90497 (QuantReg: 8.37472) QuantErr: 8.37472 batch_time=0.89644 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 2.09229 (QuantReg: 7.98652) QuantErr: 7.98652 batch_time=0.50065 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 2.01966 (QuantReg: 7.97824) QuantErr: 7.97824 batch_time=0.49242 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.93495 (QuantReg: 8.10850) QuantErr: 8.10850 batch_time=0.49636 
Train Epoch: 24 codebook_update_time=1.68257
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch24.pth ...
Done in 3.878s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 1.9767571473121643
 quant_reg      : 8.227472160339355
 quant_err      : 8.227472160339355
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R10: 78.06841046277665
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.448692152917506
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.074609617656286
 MSRVTT_full_val/v2t_metrics/R1: 32.394366197183096
 MSRVTT_full_val/v2t_metrics/R5: 68.61167002012073
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.022132796780685
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.76467193965857
 MSRVTT_full_test/t2v_metrics/R1: 10.80267558528428
 MSRVTT_full_test/t2v_metrics/R5: 31.103678929765888
 MSRVTT_full_test/t2v_metrics/R10: 45.05016722408027
 MSRVTT_full_test/t2v_metrics/R50: 77.79264214046823
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.95484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.736969895933278
 MSRVTT_full_test/v2t_metrics/R1: 11.404682274247492
 MSRVTT_full_test/v2t_metrics/R5: 34.381270903010034
 MSRVTT_full_test/v2t_metrics/R10: 48.929765886287626
 MSRVTT_full_test/v2t_metrics/R50: 82.27424749163879
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.47809364548495
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.7706809529749
 mnt_best       : 25.635683366336533
 not_improved_count: 2
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 2.19859 (QuantReg: 8.14697) QuantErr: 8.14697 batch_time=40.42486 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.93511 (QuantReg: 8.31440) QuantErr: 8.31440 batch_time=0.51262 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.82721 (QuantReg: 8.58762) QuantErr: 8.58762 batch_time=0.48590 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 2.05226 (QuantReg: 7.93792) QuantErr: 7.93792 batch_time=0.48813 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.88453 (QuantReg: 8.28816) QuantErr: 8.28816 batch_time=0.49759 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.91843 (QuantReg: 8.29435) QuantErr: 8.29435 batch_time=0.52828 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 2.06753 (QuantReg: 7.88036) QuantErr: 7.88036 batch_time=0.53302 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 2.08681 (QuantReg: 8.38836) QuantErr: 8.38836 batch_time=0.48763 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.92440 (QuantReg: 8.30529) QuantErr: 8.30529 batch_time=0.48910 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 2.01624 (QuantReg: 8.03035) QuantErr: 8.03035 batch_time=0.60809 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 2.10937 (QuantReg: 8.05457) QuantErr: 8.05457 batch_time=0.49277 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.79319 (QuantReg: 8.12380) QuantErr: 8.12380 batch_time=0.49806 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.99168 (QuantReg: 8.37326) QuantErr: 8.37326 batch_time=0.50595 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.91475 (QuantReg: 8.36225) QuantErr: 8.36225 batch_time=1.91150 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 2.06098 (QuantReg: 8.23735) QuantErr: 8.23735 batch_time=0.48810 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 2.17890 (QuantReg: 7.89381) QuantErr: 7.89381 batch_time=0.48452 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.94580 (QuantReg: 8.52372) QuantErr: 8.52372 batch_time=0.52123 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.95083 (QuantReg: 8.46154) QuantErr: 8.46154 batch_time=0.49744 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 1.88179 (QuantReg: 8.26558) QuantErr: 8.26558 batch_time=0.51885 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.93518 (QuantReg: 8.32489) QuantErr: 8.32489 batch_time=0.50235 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.99096 (QuantReg: 8.28662) QuantErr: 8.28662 batch_time=0.50391 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 2.09816 (QuantReg: 8.10425) QuantErr: 8.10425 batch_time=0.48892 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.87824 (QuantReg: 7.90126) QuantErr: 7.90126 batch_time=0.58481 
Train Epoch: 25 codebook_update_time=1.95914
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch25.pth ...
Done in 5.662s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.9732503552436829
 quant_reg      : 8.228790924072266
 quant_err      : 8.228790924072266
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_full_val/t2v_metrics/R1: 27.56539235412475
 MSRVTT_full_val/t2v_metrics/R5: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R10: 77.8672032193159
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.193158953722333
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.23465957036884
 MSRVTT_full_val/v2t_metrics/R1: 30.382293762575454
 MSRVTT_full_val/v2t_metrics/R5: 67.80684104627767
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.990945674044266
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.119637030237165
 MSRVTT_full_test/t2v_metrics/R1: 10.936454849498327
 MSRVTT_full_test/t2v_metrics/R5: 32.07357859531773
 MSRVTT_full_test/t2v_metrics/R10: 46.05351170568562
 MSRVTT_full_test/t2v_metrics/R50: 78.36120401337793
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.09264214046823
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.27913708600171
 MSRVTT_full_test/v2t_metrics/R1: 11.906354515050166
 MSRVTT_full_test/v2t_metrics/R5: 34.54849498327759
 MSRVTT_full_test/v2t_metrics/R10: 49.063545150501675
 MSRVTT_full_test/v2t_metrics/R50: 81.53846153846153
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.8571906354515
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.226320721027907
 mnt_best       : 25.635683366336533
 not_improved_count: 3
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 2.07184 (QuantReg: 8.06028) QuantErr: 8.06028 batch_time=39.37903 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.89165 (QuantReg: 7.85008) QuantErr: 7.85008 batch_time=0.50542 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.55117 (QuantReg: 8.21126) QuantErr: 8.21126 batch_time=0.98811 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.89578 (QuantReg: 8.28592) QuantErr: 8.28592 batch_time=0.49921 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.88788 (QuantReg: 8.19855) QuantErr: 8.19855 batch_time=0.51772 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.97214 (QuantReg: 7.92133) QuantErr: 7.92133 batch_time=0.54995 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.88692 (QuantReg: 8.38962) QuantErr: 8.38962 batch_time=2.62891 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 2.04426 (QuantReg: 8.26365) QuantErr: 8.26365 batch_time=0.51454 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.87876 (QuantReg: 8.28713) QuantErr: 8.28713 batch_time=0.97673 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.87235 (QuantReg: 8.00196) QuantErr: 8.00196 batch_time=0.60652 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.73179 (QuantReg: 8.19537) QuantErr: 8.19537 batch_time=0.66210 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.74338 (QuantReg: 8.20527) QuantErr: 8.20527 batch_time=0.51516 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.74661 (QuantReg: 7.71975) QuantErr: 7.71975 batch_time=0.53770 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.88994 (QuantReg: 8.00826) QuantErr: 8.00826 batch_time=0.49856 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 2.09602 (QuantReg: 8.05732) QuantErr: 8.05732 batch_time=0.48635 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 2.02608 (QuantReg: 8.44097) QuantErr: 8.44097 batch_time=0.50233 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.93604 (QuantReg: 7.97529) QuantErr: 7.97529 batch_time=0.64401 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.76250 (QuantReg: 8.32554) QuantErr: 8.32554 batch_time=0.50706 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.91604 (QuantReg: 8.38894) QuantErr: 8.38894 batch_time=0.52086 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.75979 (QuantReg: 8.50319) QuantErr: 8.50319 batch_time=0.53437 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 2.41528 (QuantReg: 8.27534) QuantErr: 8.27534 batch_time=0.51390 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.83025 (QuantReg: 8.15652) QuantErr: 8.15652 batch_time=0.50160 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.80103 (QuantReg: 8.06172) QuantErr: 8.06172 batch_time=0.49744 
Train Epoch: 26 codebook_update_time=1.77441
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch26.pth ...
Done in 4.112s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 1.965772240638733
 quant_reg      : 8.22319609451294
 quant_err      : 8.22319609451294
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_full_val/t2v_metrics/R1: 27.766599597585515
 MSRVTT_full_val/t2v_metrics/R5: 63.98390342052314
 MSRVTT_full_val/t2v_metrics/R10: 77.2635814889336
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.354124748490946
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.58491922728117
 MSRVTT_full_val/v2t_metrics/R1: 30.985915492957748
 MSRVTT_full_val/v2t_metrics/R5: 69.61770623742454
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.613682092555332
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.155970709427166
 MSRVTT_full_test/t2v_metrics/R1: 11.070234113712374
 MSRVTT_full_test/t2v_metrics/R5: 32.207357859531776
 MSRVTT_full_test/t2v_metrics/R10: 45.38461538461539
 MSRVTT_full_test/t2v_metrics/R50: 77.95986622073579
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.68076923076923
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.293379170156076
 MSRVTT_full_test/v2t_metrics/R1: 11.872909698996656
 MSRVTT_full_test/v2t_metrics/R5: 35.05016722408027
 MSRVTT_full_test/v2t_metrics/R10: 49.23076923076923
 MSRVTT_full_test/v2t_metrics/R50: 82.04013377926421
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.05351170568562
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.362847724023577
 mnt_best       : 25.635683366336533
 not_improved_count: 4
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.77457 (QuantReg: 8.54407) QuantErr: 8.54407 batch_time=45.01192 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 2.05854 (QuantReg: 8.43020) QuantErr: 8.43020 batch_time=0.50205 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.98497 (QuantReg: 8.42063) QuantErr: 8.42063 batch_time=0.56695 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.98980 (QuantReg: 8.24584) QuantErr: 8.24584 batch_time=0.49228 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.89395 (QuantReg: 8.04014) QuantErr: 8.04014 batch_time=0.62726 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.63151 (QuantReg: 8.51203) QuantErr: 8.51203 batch_time=0.50248 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.77806 (QuantReg: 8.16194) QuantErr: 8.16194 batch_time=0.73818 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.74714 (QuantReg: 8.11536) QuantErr: 8.11536 batch_time=0.50719 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.98659 (QuantReg: 8.23486) QuantErr: 8.23486 batch_time=0.49200 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 2.06924 (QuantReg: 7.91767) QuantErr: 7.91767 batch_time=0.49488 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.74207 (QuantReg: 8.28901) QuantErr: 8.28901 batch_time=0.63770 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.98956 (QuantReg: 8.17949) QuantErr: 8.17949 batch_time=0.49303 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.97277 (QuantReg: 8.07185) QuantErr: 8.07185 batch_time=0.49997 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.78044 (QuantReg: 8.03356) QuantErr: 8.03356 batch_time=0.49784 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.83641 (QuantReg: 8.48544) QuantErr: 8.48544 batch_time=0.51086 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.95350 (QuantReg: 8.23031) QuantErr: 8.23031 batch_time=0.55142 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.98355 (QuantReg: 8.10379) QuantErr: 8.10379 batch_time=0.52130 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.88313 (QuantReg: 8.01098) QuantErr: 8.01098 batch_time=0.49006 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.98037 (QuantReg: 8.15513) QuantErr: 8.15513 batch_time=0.49859 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.87406 (QuantReg: 8.61487) QuantErr: 8.61487 batch_time=0.51088 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.86456 (QuantReg: 8.05215) QuantErr: 8.05215 batch_time=0.49284 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.84663 (QuantReg: 8.22186) QuantErr: 8.22186 batch_time=0.59882 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.89577 (QuantReg: 8.28405) QuantErr: 8.28405 batch_time=0.49938 
Train Epoch: 27 codebook_update_time=1.90912
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch27.pth ...
Done in 3.807s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 1.9131648669242858
 quant_reg      : 8.184969347000122
 quant_err      : 8.184969347000122
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_full_val/t2v_metrics/R1: 29.175050301810867
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.432595573440643
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.169902026687744
 MSRVTT_full_val/v2t_metrics/R1: 31.99195171026157
 MSRVTT_full_val/v2t_metrics/R5: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R10: 80.6841046277666
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.9678068410462775
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.32185166355204
 MSRVTT_full_test/t2v_metrics/R1: 10.668896321070234
 MSRVTT_full_test/t2v_metrics/R5: 32.0066889632107
 MSRVTT_full_test/t2v_metrics/R10: 46.020066889632105
 MSRVTT_full_test/t2v_metrics/R50: 78.09364548494983
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.5190635451505
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.047775566490753
 MSRVTT_full_test/v2t_metrics/R1: 11.872909698996656
 MSRVTT_full_test/v2t_metrics/R5: 34.61538461538461
 MSRVTT_full_test/v2t_metrics/R10: 49.89966555183946
 MSRVTT_full_test/v2t_metrics/R50: 81.87290969899665
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.76789297658863
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.372091746334245
 mnt_best       : 25.635683366336533
 not_improved_count: 5
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.79941 (QuantReg: 8.17583) QuantErr: 8.17583 batch_time=40.15725 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 2.11364 (QuantReg: 8.34494) QuantErr: 8.34494 batch_time=0.50614 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.81382 (QuantReg: 8.06329) QuantErr: 8.06329 batch_time=0.48720 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.98402 (QuantReg: 8.39470) QuantErr: 8.39470 batch_time=0.50318 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 2.21963 (QuantReg: 8.33691) QuantErr: 8.33691 batch_time=0.48651 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 2.05347 (QuantReg: 8.52880) QuantErr: 8.52880 batch_time=0.50913 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 2.30963 (QuantReg: 8.40355) QuantErr: 8.40355 batch_time=0.54673 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.84011 (QuantReg: 8.58037) QuantErr: 8.58037 batch_time=0.50070 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 2.05552 (QuantReg: 8.28999) QuantErr: 8.28999 batch_time=0.49561 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 2.03050 (QuantReg: 8.14657) QuantErr: 8.14657 batch_time=0.48970 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 2.00273 (QuantReg: 8.12322) QuantErr: 8.12322 batch_time=0.48558 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.98701 (QuantReg: 8.20465) QuantErr: 8.20465 batch_time=0.50565 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.97978 (QuantReg: 8.42949) QuantErr: 8.42949 batch_time=2.71487 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 2.04936 (QuantReg: 7.88744) QuantErr: 7.88744 batch_time=1.27061 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 2.17276 (QuantReg: 8.15703) QuantErr: 8.15703 batch_time=0.49503 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.71924 (QuantReg: 8.01115) QuantErr: 8.01115 batch_time=0.48683 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 2.11812 (QuantReg: 8.08959) QuantErr: 8.08959 batch_time=0.50020 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.92299 (QuantReg: 7.93961) QuantErr: 7.93961 batch_time=0.56793 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.81177 (QuantReg: 8.23609) QuantErr: 8.23609 batch_time=0.48870 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 2.09138 (QuantReg: 8.51697) QuantErr: 8.51697 batch_time=2.11836 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 2.10952 (QuantReg: 8.07968) QuantErr: 8.07968 batch_time=0.48533 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 2.23133 (QuantReg: 7.82381) QuantErr: 7.82381 batch_time=0.49339 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.96797 (QuantReg: 8.40556) QuantErr: 8.40556 batch_time=0.53977 
Train Epoch: 28 codebook_update_time=2.04423
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch28.pth ...
Done in 16.228s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch28.pth ...
Done in 20.014s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 1.92911101770401
 quant_reg      : 8.217770986557007
 quant_err      : 8.217770986557007
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_full_val/t2v_metrics/R1: 28.169014084507044
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.643863179074447
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.284343681053905
 MSRVTT_full_val/v2t_metrics/R1: 32.19315895372233
 MSRVTT_full_val/v2t_metrics/R5: 69.81891348088531
 MSRVTT_full_val/v2t_metrics/R10: 82.897384305835
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.653923541247485
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.11618203851008
 MSRVTT_full_test/t2v_metrics/R1: 11.906354515050166
 MSRVTT_full_test/t2v_metrics/R5: 32.642140468227424
 MSRVTT_full_test/t2v_metrics/R10: 47.22408026755853
 MSRVTT_full_test/t2v_metrics/R50: 79.29765886287625
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.667558528428096
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.37790597066318
 MSRVTT_full_test/v2t_metrics/R1: 12.876254180602007
 MSRVTT_full_test/v2t_metrics/R5: 35.1505016722408
 MSRVTT_full_test/v2t_metrics/R10: 50.16722408026756
 MSRVTT_full_test/v2t_metrics/R50: 82.876254180602
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.2128762541806
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.31698733317032
 mnt_best       : 26.37790597066318
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.98788 (QuantReg: 8.30128) QuantErr: 8.30128 batch_time=37.56120 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 2.10143 (QuantReg: 8.15772) QuantErr: 8.15772 batch_time=0.51166 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 2.07745 (QuantReg: 7.65020) QuantErr: 7.65020 batch_time=0.51468 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.86485 (QuantReg: 8.00215) QuantErr: 8.00215 batch_time=0.49404 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.97948 (QuantReg: 8.04080) QuantErr: 8.04080 batch_time=0.52368 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 2.10407 (QuantReg: 8.25151) QuantErr: 8.25151 batch_time=0.51807 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.96277 (QuantReg: 8.41945) QuantErr: 8.41945 batch_time=0.52266 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.99934 (QuantReg: 8.24952) QuantErr: 8.24952 batch_time=0.49993 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.83576 (QuantReg: 8.54999) QuantErr: 8.54999 batch_time=2.22868 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.66157 (QuantReg: 8.19348) QuantErr: 8.19348 batch_time=0.50929 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 2.01411 (QuantReg: 8.11709) QuantErr: 8.11709 batch_time=0.49904 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.84392 (QuantReg: 8.41933) QuantErr: 8.41933 batch_time=0.49515 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 2.06955 (QuantReg: 8.20647) QuantErr: 8.20647 batch_time=0.55297 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 2.00082 (QuantReg: 8.28172) QuantErr: 8.28172 batch_time=0.78545 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.85729 (QuantReg: 8.11373) QuantErr: 8.11373 batch_time=0.51514 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.97147 (QuantReg: 8.20509) QuantErr: 8.20509 batch_time=0.49831 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.99769 (QuantReg: 8.00227) QuantErr: 8.00227 batch_time=0.50739 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.73879 (QuantReg: 8.01795) QuantErr: 8.01795 batch_time=0.55282 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 2.04787 (QuantReg: 8.18020) QuantErr: 8.18020 batch_time=0.49903 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.71090 (QuantReg: 8.22957) QuantErr: 8.22957 batch_time=0.49944 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.81208 (QuantReg: 7.97274) QuantErr: 7.97274 batch_time=0.50972 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.88529 (QuantReg: 8.08172) QuantErr: 8.08172 batch_time=0.55941 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.67435 (QuantReg: 8.24452) QuantErr: 8.24452 batch_time=0.49781 
Train Epoch: 29 codebook_update_time=2.31786
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch29.pth ...
Done in 3.992s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 1.9127113394737243
 quant_reg      : 8.189704496383667
 quant_err      : 8.189704496383667
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 66.19718309859155
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.794768611670019
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.90967063381199
 MSRVTT_full_val/v2t_metrics/R1: 32.796780684104625
 MSRVTT_full_val/v2t_metrics/R5: 68.61167002012073
 MSRVTT_full_val/v2t_metrics/R10: 81.89134808853119
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.01006036217304
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.90569635085383
 MSRVTT_full_test/t2v_metrics/R1: 11.304347826086957
 MSRVTT_full_test/t2v_metrics/R5: 32.709030100334445
 MSRVTT_full_test/t2v_metrics/R10: 46.58862876254181
 MSRVTT_full_test/t2v_metrics/R50: 78.79598662207358
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.031438127090304
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.826429479916243
 MSRVTT_full_test/v2t_metrics/R1: 11.505016722408026
 MSRVTT_full_test/v2t_metrics/R5: 35.05016722408027
 MSRVTT_full_test/v2t_metrics/R10: 49.79933110367893
 MSRVTT_full_test/v2t_metrics/R50: 82.24080267558529
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.34080267558529
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.181095263537227
 mnt_best       : 26.37790597066318
 not_improved_count: 1
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.75229 (QuantReg: 8.10825) QuantErr: 8.10825 batch_time=45.54447 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.95930 (QuantReg: 8.13874) QuantErr: 8.13874 batch_time=0.50943 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.90397 (QuantReg: 8.21866) QuantErr: 8.21866 batch_time=0.57699 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 2.06040 (QuantReg: 8.29018) QuantErr: 8.29018 batch_time=0.51142 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.92631 (QuantReg: 8.15313) QuantErr: 8.15313 batch_time=1.39679 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.88024 (QuantReg: 8.45429) QuantErr: 8.45429 batch_time=0.55646 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.96526 (QuantReg: 8.25598) QuantErr: 8.25598 batch_time=0.52130 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.79285 (QuantReg: 8.51659) QuantErr: 8.51659 batch_time=0.49751 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.99738 (QuantReg: 7.95779) QuantErr: 7.95779 batch_time=0.50183 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.76126 (QuantReg: 8.45145) QuantErr: 8.45145 batch_time=0.56244 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.87292 (QuantReg: 8.33233) QuantErr: 8.33233 batch_time=0.52150 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.85455 (QuantReg: 8.08966) QuantErr: 8.08966 batch_time=0.49875 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.87174 (QuantReg: 8.21701) QuantErr: 8.21701 batch_time=0.49040 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.92311 (QuantReg: 8.08899) QuantErr: 8.08899 batch_time=0.49018 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.93531 (QuantReg: 8.29473) QuantErr: 8.29473 batch_time=0.57668 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.94897 (QuantReg: 8.34046) QuantErr: 8.34046 batch_time=0.52426 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.79534 (QuantReg: 8.08871) QuantErr: 8.08871 batch_time=0.49658 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.66253 (QuantReg: 8.29112) QuantErr: 8.29112 batch_time=0.49215 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 2.14935 (QuantReg: 8.04427) QuantErr: 8.04427 batch_time=0.50589 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.92453 (QuantReg: 8.15521) QuantErr: 8.15521 batch_time=0.50067 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.89386 (QuantReg: 8.32219) QuantErr: 8.32219 batch_time=0.54018 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 2.18170 (QuantReg: 8.30568) QuantErr: 8.30568 batch_time=0.50691 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 2.29232 (QuantReg: 8.09402) QuantErr: 8.09402 batch_time=0.74524 
Train Epoch: 30 codebook_update_time=1.72908
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch30.pth ...
Done in 3.847s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch30.pth ...
Done in 7.651s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 1.8864696516990662
 quant_reg      : 8.20076813697815
 quant_err      : 8.20076813697815
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_full_val/t2v_metrics/R1: 30.18108651911469
 MSRVTT_full_val/t2v_metrics/R5: 66.59959758551308
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.647887323943662
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.07654645203561
 MSRVTT_full_val/v2t_metrics/R1: 33.199195171026155
 MSRVTT_full_val/v2t_metrics/R5: 70.02012072434607
 MSRVTT_full_val/v2t_metrics/R10: 81.69014084507042
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.674044265593562
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.47866665801108
 MSRVTT_full_test/t2v_metrics/R1: 11.73913043478261
 MSRVTT_full_test/t2v_metrics/R5: 33.04347826086956
 MSRVTT_full_test/t2v_metrics/R10: 47.357859531772576
 MSRVTT_full_test/t2v_metrics/R50: 78.96321070234114
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.67240802675585
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.38585975783914
 MSRVTT_full_test/v2t_metrics/R1: 11.638795986622073
 MSRVTT_full_test/v2t_metrics/R5: 35.38461538461539
 MSRVTT_full_test/v2t_metrics/R10: 49.7324414715719
 MSRVTT_full_test/v2t_metrics/R50: 82.27424749163879
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.98628762541806
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.360294752690805
 mnt_best       : 26.38585975783914
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 2.07127 (QuantReg: 8.27119) QuantErr: 8.27119 batch_time=36.21722 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 2.00623 (QuantReg: 8.12845) QuantErr: 8.12845 batch_time=0.49905 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 2.11845 (QuantReg: 8.13660) QuantErr: 8.13660 batch_time=0.55074 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.73462 (QuantReg: 8.03052) QuantErr: 8.03052 batch_time=0.50246 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 2.01161 (QuantReg: 8.29779) QuantErr: 8.29779 batch_time=0.71185 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 2.08803 (QuantReg: 7.53047) QuantErr: 7.53047 batch_time=0.55324 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.93446 (QuantReg: 8.03126) QuantErr: 8.03126 batch_time=2.27726 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.96035 (QuantReg: 8.19640) QuantErr: 8.19640 batch_time=0.50434 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.90225 (QuantReg: 8.11581) QuantErr: 8.11581 batch_time=0.51057 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.82233 (QuantReg: 8.06312) QuantErr: 8.06312 batch_time=0.98359 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.79781 (QuantReg: 8.33160) QuantErr: 8.33160 batch_time=0.51498 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.65398 (QuantReg: 8.19714) QuantErr: 8.19714 batch_time=0.51244 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.81647 (QuantReg: 8.26038) QuantErr: 8.26038 batch_time=0.49590 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 2.24296 (QuantReg: 8.38296) QuantErr: 8.38296 batch_time=0.50670 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.82622 (QuantReg: 8.05261) QuantErr: 8.05261 batch_time=0.58679 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.82949 (QuantReg: 7.90757) QuantErr: 7.90757 batch_time=0.52353 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 2.20847 (QuantReg: 7.86429) QuantErr: 7.86429 batch_time=0.51389 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.87491 (QuantReg: 8.33165) QuantErr: 8.33165 batch_time=0.51464 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.82061 (QuantReg: 8.14816) QuantErr: 8.14816 batch_time=4.34358 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 2.09507 (QuantReg: 8.01151) QuantErr: 8.01151 batch_time=0.52622 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.86688 (QuantReg: 8.63936) QuantErr: 8.63936 batch_time=0.62368 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.81077 (QuantReg: 8.25826) QuantErr: 8.25826 batch_time=0.89512 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.90635 (QuantReg: 8.26252) QuantErr: 8.26252 batch_time=0.64424 
Train Epoch: 31 codebook_update_time=1.75051
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch31.pth ...
Done in 4.174s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch31.pth ...
Done in 8.129s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.9054523973464965
 quant_reg      : 8.191735445022584
 quant_err      : 8.191735445022584
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 66.19718309859155
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.480885311871226
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.30241247357522
 MSRVTT_full_val/v2t_metrics/R1: 32.99798792756539
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.730382293762576
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.290768334187476
 MSRVTT_full_test/t2v_metrics/R1: 11.839464882943144
 MSRVTT_full_test/t2v_metrics/R5: 33.21070234113712
 MSRVTT_full_test/t2v_metrics/R10: 46.88963210702341
 MSRVTT_full_test/t2v_metrics/R50: 78.89632107023411
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.409866220735786
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.417739480869216
 MSRVTT_full_test/v2t_metrics/R1: 12.207357859531772
 MSRVTT_full_test/v2t_metrics/R5: 35.48494983277592
 MSRVTT_full_test/v2t_metrics/R10: 49.46488294314381
 MSRVTT_full_test/v2t_metrics/R50: 82.24080267558529
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.11270903010033
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.77501395361053
 mnt_best       : 26.417739480869216
 not_improved_count: 0
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.76387 (QuantReg: 8.21509) QuantErr: 8.21509 batch_time=37.22340 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.94561 (QuantReg: 8.24788) QuantErr: 8.24788 batch_time=0.49423 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.76046 (QuantReg: 7.86441) QuantErr: 7.86441 batch_time=0.50174 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.84867 (QuantReg: 8.45641) QuantErr: 8.45641 batch_time=0.50727 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 1.66332 (QuantReg: 8.31414) QuantErr: 8.31414 batch_time=0.49309 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.86643 (QuantReg: 8.03255) QuantErr: 8.03255 batch_time=0.50672 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.56880 (QuantReg: 8.27773) QuantErr: 8.27773 batch_time=0.49821 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.92966 (QuantReg: 8.07191) QuantErr: 8.07191 batch_time=0.49539 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.91085 (QuantReg: 8.16948) QuantErr: 8.16948 batch_time=0.53967 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.89424 (QuantReg: 8.13280) QuantErr: 8.13280 batch_time=0.58686 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.81875 (QuantReg: 8.75158) QuantErr: 8.75158 batch_time=0.49121 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.65681 (QuantReg: 7.83295) QuantErr: 7.83295 batch_time=0.48620 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 2.02323 (QuantReg: 7.99807) QuantErr: 7.99807 batch_time=0.49052 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.84409 (QuantReg: 8.06537) QuantErr: 8.06537 batch_time=1.20593 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.72332 (QuantReg: 8.27881) QuantErr: 8.27881 batch_time=0.50452 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.90558 (QuantReg: 8.22037) QuantErr: 8.22037 batch_time=0.50479 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 2.04082 (QuantReg: 8.48783) QuantErr: 8.48783 batch_time=0.50655 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.93849 (QuantReg: 8.33609) QuantErr: 8.33609 batch_time=0.48618 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.80923 (QuantReg: 8.45732) QuantErr: 8.45732 batch_time=0.48077 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 2.26897 (QuantReg: 8.25087) QuantErr: 8.25087 batch_time=0.51551 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.78486 (QuantReg: 8.36844) QuantErr: 8.36844 batch_time=0.50837 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.94585 (QuantReg: 8.10146) QuantErr: 8.10146 batch_time=0.52797 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.58647 (QuantReg: 8.47289) QuantErr: 8.47289 batch_time=0.48934 
Train Epoch: 32 codebook_update_time=1.65608
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch32.pth ...
Done in 12.026s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch32.pth ...
Done in 15.820s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 1.8736946868896485
 quant_reg      : 8.196506158828736
 quant_err      : 8.196506158828736
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_full_val/t2v_metrics/R1: 32.99798792756539
 MSRVTT_full_val/t2v_metrics/R5: 68.2092555331992
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.309859154929576
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.392738979121255
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 69.61770623742454
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.686116700201207
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.80855660361003
 MSRVTT_full_test/t2v_metrics/R1: 12.14046822742475
 MSRVTT_full_test/t2v_metrics/R5: 33.67892976588629
 MSRVTT_full_test/t2v_metrics/R10: 47.123745819397996
 MSRVTT_full_test/t2v_metrics/R50: 79.79933110367892
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.1505016722408
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.808828794526725
 MSRVTT_full_test/v2t_metrics/R1: 12.809364548494983
 MSRVTT_full_test/v2t_metrics/R5: 35.31772575250836
 MSRVTT_full_test/v2t_metrics/R10: 50.53511705685619
 MSRVTT_full_test/v2t_metrics/R50: 83.01003344481606
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.26254180602007
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.381664624116663
 mnt_best       : 26.808828794526725
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.84785 (QuantReg: 8.48248) QuantErr: 8.48248 batch_time=39.37370 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.83444 (QuantReg: 8.25459) QuantErr: 8.25459 batch_time=0.49087 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 2.02924 (QuantReg: 8.36214) QuantErr: 8.36214 batch_time=0.50415 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.63010 (QuantReg: 7.79655) QuantErr: 7.79655 batch_time=0.49489 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.81128 (QuantReg: 8.35611) QuantErr: 8.35611 batch_time=0.50058 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.92039 (QuantReg: 8.16048) QuantErr: 8.16048 batch_time=0.55325 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 2.10864 (QuantReg: 8.17459) QuantErr: 8.17459 batch_time=0.50816 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.78281 (QuantReg: 8.03931) QuantErr: 8.03931 batch_time=0.48283 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 2.02710 (QuantReg: 8.03127) QuantErr: 8.03127 batch_time=0.51498 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.93868 (QuantReg: 8.25950) QuantErr: 8.25950 batch_time=0.51443 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 2.04779 (QuantReg: 8.20102) QuantErr: 8.20102 batch_time=0.52844 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.80904 (QuantReg: 8.19436) QuantErr: 8.19436 batch_time=0.54680 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 2.27132 (QuantReg: 8.16857) QuantErr: 8.16857 batch_time=0.52855 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.89234 (QuantReg: 8.33433) QuantErr: 8.33433 batch_time=1.58433 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.80272 (QuantReg: 7.87929) QuantErr: 7.87929 batch_time=0.88127 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.95419 (QuantReg: 8.37410) QuantErr: 8.37410 batch_time=0.57042 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 1.75582 (QuantReg: 8.17171) QuantErr: 8.17171 batch_time=0.51816 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.91882 (QuantReg: 8.26127) QuantErr: 8.26127 batch_time=0.51395 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.85953 (QuantReg: 8.15034) QuantErr: 8.15034 batch_time=0.51833 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.81566 (QuantReg: 8.43703) QuantErr: 8.43703 batch_time=0.49623 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 2.07350 (QuantReg: 8.16190) QuantErr: 8.16190 batch_time=0.51307 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.75789 (QuantReg: 8.16720) QuantErr: 8.16720 batch_time=0.51190 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.92914 (QuantReg: 8.06770) QuantErr: 8.06770 batch_time=0.50394 
Train Epoch: 33 codebook_update_time=2.56474
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch33.pth ...
Done in 3.846s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.865866557121277
 quant_reg      : 8.189605850219726
 quant_err      : 8.189605850219726
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_full_val/t2v_metrics/R1: 29.577464788732396
 MSRVTT_full_val/t2v_metrics/R5: 65.59356136820925
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.682092555331991
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.84870374056695
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.009054325955734
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.52867970860194
 MSRVTT_full_test/t2v_metrics/R1: 11.438127090301004
 MSRVTT_full_test/t2v_metrics/R5: 33.51170568561873
 MSRVTT_full_test/t2v_metrics/R10: 46.98996655518395
 MSRVTT_full_test/t2v_metrics/R50: 79.23076923076923
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.368729096989966
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.213128850671286
 MSRVTT_full_test/v2t_metrics/R1: 12.274247491638796
 MSRVTT_full_test/v2t_metrics/R5: 35.28428093645485
 MSRVTT_full_test/v2t_metrics/R10: 50.20066889632107
 MSRVTT_full_test/v2t_metrics/R50: 82.5752508361204
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.168896321070235
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.910131565850644
 mnt_best       : 26.808828794526725
 not_improved_count: 1
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.97975 (QuantReg: 8.21188) QuantErr: 8.21188 batch_time=38.76725 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.89795 (QuantReg: 8.49236) QuantErr: 8.49236 batch_time=0.49501 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.81755 (QuantReg: 8.24166) QuantErr: 8.24166 batch_time=0.52277 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.99661 (QuantReg: 8.21321) QuantErr: 8.21321 batch_time=0.52181 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 2.00849 (QuantReg: 8.28969) QuantErr: 8.28969 batch_time=0.52943 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 2.06542 (QuantReg: 8.28422) QuantErr: 8.28422 batch_time=0.49616 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.80723 (QuantReg: 8.18722) QuantErr: 8.18722 batch_time=1.77864 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 2.11254 (QuantReg: 8.01720) QuantErr: 8.01720 batch_time=0.49810 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 2.01045 (QuantReg: 8.12878) QuantErr: 8.12878 batch_time=0.52643 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 2.15251 (QuantReg: 8.03959) QuantErr: 8.03959 batch_time=0.55000 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.90341 (QuantReg: 8.02156) QuantErr: 8.02156 batch_time=0.49149 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.81661 (QuantReg: 8.21423) QuantErr: 8.21423 batch_time=0.49416 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.92091 (QuantReg: 8.16050) QuantErr: 8.16050 batch_time=0.51627 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.94136 (QuantReg: 8.03191) QuantErr: 8.03191 batch_time=0.50858 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 2.00907 (QuantReg: 8.68030) QuantErr: 8.68030 batch_time=0.61191 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 2.00878 (QuantReg: 7.93978) QuantErr: 7.93978 batch_time=0.50306 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.70130 (QuantReg: 8.07356) QuantErr: 8.07356 batch_time=0.98237 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 2.04505 (QuantReg: 8.01995) QuantErr: 8.01995 batch_time=0.61388 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.74365 (QuantReg: 8.29155) QuantErr: 8.29155 batch_time=0.91058 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.91306 (QuantReg: 8.13055) QuantErr: 8.13055 batch_time=0.49534 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.73778 (QuantReg: 8.31556) QuantErr: 8.31556 batch_time=0.49060 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.82654 (QuantReg: 8.30196) QuantErr: 8.30196 batch_time=0.51160 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 2.10472 (QuantReg: 8.39015) QuantErr: 8.39015 batch_time=0.50366 
Train Epoch: 34 codebook_update_time=2.27551
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch34.pth ...
Done in 4.046s
removing stale ckpt [epoch 33] [took 0.04s]
 epoch          : 34
 loss           : 1.8960408658981323
 quant_reg      : 8.18717364501953
 quant_err      : 8.18717364501953
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_full_val/t2v_metrics/R1: 29.175050301810867
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.571428571428571
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.97513834017865
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 68.00804828973843
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.116700201207244
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.77648808592465
 MSRVTT_full_test/t2v_metrics/R1: 11.20401337792642
 MSRVTT_full_test/t2v_metrics/R5: 32.709030100334445
 MSRVTT_full_test/t2v_metrics/R10: 47.558528428093645
 MSRVTT_full_test/t2v_metrics/R50: 78.39464882943143
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.03963210702341
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.92725651242916
 MSRVTT_full_test/v2t_metrics/R1: 11.806020066889632
 MSRVTT_full_test/v2t_metrics/R5: 35.1505016722408
 MSRVTT_full_test/v2t_metrics/R10: 49.197324414715716
 MSRVTT_full_test/v2t_metrics/R50: 82.0066889632107
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.10033444816054
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.331208991170854
 mnt_best       : 26.808828794526725
 not_improved_count: 2
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.84815 (QuantReg: 8.30695) QuantErr: 8.30695 batch_time=38.45835 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 2.05531 (QuantReg: 8.28143) QuantErr: 8.28143 batch_time=0.51321 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.91681 (QuantReg: 8.32277) QuantErr: 8.32277 batch_time=0.99706 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 2.06466 (QuantReg: 8.18506) QuantErr: 8.18506 batch_time=0.55880 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.92358 (QuantReg: 8.12583) QuantErr: 8.12583 batch_time=0.49503 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.78711 (QuantReg: 8.01406) QuantErr: 8.01406 batch_time=0.50325 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.79760 (QuantReg: 8.43979) QuantErr: 8.43979 batch_time=0.49533 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 2.25278 (QuantReg: 8.43589) QuantErr: 8.43589 batch_time=0.73663 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.77885 (QuantReg: 8.00298) QuantErr: 8.00298 batch_time=0.50129 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 2.01321 (QuantReg: 8.18512) QuantErr: 8.18512 batch_time=0.52022 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.87580 (QuantReg: 7.94552) QuantErr: 7.94552 batch_time=0.50891 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.82231 (QuantReg: 8.28402) QuantErr: 8.28402 batch_time=0.49358 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 2.13500 (QuantReg: 8.04208) QuantErr: 8.04208 batch_time=0.49980 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.81560 (QuantReg: 8.32365) QuantErr: 8.32365 batch_time=0.49526 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.72454 (QuantReg: 7.99487) QuantErr: 7.99487 batch_time=0.50859 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 2.03213 (QuantReg: 8.38658) QuantErr: 8.38658 batch_time=0.97354 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.95805 (QuantReg: 8.82781) QuantErr: 8.82781 batch_time=0.50194 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.72108 (QuantReg: 7.94893) QuantErr: 7.94893 batch_time=0.50783 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.82501 (QuantReg: 8.48398) QuantErr: 8.48398 batch_time=0.49775 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.84861 (QuantReg: 8.29930) QuantErr: 8.29930 batch_time=3.00675 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.89624 (QuantReg: 8.37803) QuantErr: 8.37803 batch_time=0.50024 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.92579 (QuantReg: 8.47492) QuantErr: 8.47492 batch_time=0.49190 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.71642 (QuantReg: 8.33224) QuantErr: 8.33224 batch_time=0.50813 
Train Epoch: 35 codebook_update_time=1.87047
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch35.pth ...
Done in 4.208s
removing stale ckpt [epoch 34] [took 0.02s]
 epoch          : 35
 loss           : 1.8642510905265808
 quant_reg      : 8.204439535140992
 quant_err      : 8.204439535140992
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_full_val/t2v_metrics/R1: 29.577464788732396
 MSRVTT_full_val/t2v_metrics/R5: 65.99597585513078
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.509054325955734
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.641986709804605
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 69.81891348088531
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.941649899396379
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.67447525228648
 MSRVTT_full_test/t2v_metrics/R1: 12.073578595317725
 MSRVTT_full_test/t2v_metrics/R5: 33.17725752508361
 MSRVTT_full_test/t2v_metrics/R10: 47.357859531772576
 MSRVTT_full_test/t2v_metrics/R50: 78.59531772575251
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.888628762541806
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.669990079648425
 MSRVTT_full_test/v2t_metrics/R1: 12.107023411371237
 MSRVTT_full_test/v2t_metrics/R5: 35.11705685618729
 MSRVTT_full_test/v2t_metrics/R10: 49.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 82.40802675585284
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.31571906354515
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.633723123549412
 mnt_best       : 26.808828794526725
 not_improved_count: 3
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.76106 (QuantReg: 8.02367) QuantErr: 8.02367 batch_time=35.67218 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 2.03560 (QuantReg: 8.45174) QuantErr: 8.45174 batch_time=0.49178 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 1.58886 (QuantReg: 7.86720) QuantErr: 7.86720 batch_time=0.49021 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.82785 (QuantReg: 8.10894) QuantErr: 8.10894 batch_time=0.49924 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.85500 (QuantReg: 8.03317) QuantErr: 8.03317 batch_time=0.51058 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 1.57386 (QuantReg: 7.97472) QuantErr: 7.97472 batch_time=0.50362 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.78250 (QuantReg: 8.14468) QuantErr: 8.14468 batch_time=0.49733 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 2.08833 (QuantReg: 8.19978) QuantErr: 8.19978 batch_time=0.48904 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.93237 (QuantReg: 7.87949) QuantErr: 7.87949 batch_time=0.50363 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.88922 (QuantReg: 8.11848) QuantErr: 8.11848 batch_time=0.51632 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 2.08875 (QuantReg: 8.17565) QuantErr: 8.17565 batch_time=0.54768 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 2.09707 (QuantReg: 8.03991) QuantErr: 8.03991 batch_time=0.49466 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.74749 (QuantReg: 7.92186) QuantErr: 7.92186 batch_time=2.32694 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 2.02348 (QuantReg: 8.49721) QuantErr: 8.49721 batch_time=0.48604 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.64989 (QuantReg: 8.03763) QuantErr: 8.03763 batch_time=0.48904 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 2.08885 (QuantReg: 8.35991) QuantErr: 8.35991 batch_time=0.50388 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.99178 (QuantReg: 8.24174) QuantErr: 8.24174 batch_time=0.55170 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.70332 (QuantReg: 8.22534) QuantErr: 8.22534 batch_time=0.49469 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.78064 (QuantReg: 8.03735) QuantErr: 8.03735 batch_time=0.49137 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.92825 (QuantReg: 8.20728) QuantErr: 8.20728 batch_time=0.51302 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 2.00703 (QuantReg: 7.75328) QuantErr: 7.75328 batch_time=0.49643 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.92505 (QuantReg: 8.09563) QuantErr: 8.09563 batch_time=0.49415 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 1.63688 (QuantReg: 7.93710) QuantErr: 7.93710 batch_time=0.89341 
Train Epoch: 36 codebook_update_time=1.82182
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch36.pth ...
Done in 4.016s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 1.8745366272926332
 quant_reg      : 8.203927515029907
 quant_err      : 8.203927515029907
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_full_val/t2v_metrics/R1: 30.58350100603622
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.706237424547282
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.46301570741355
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 70.02012072434607
 MSRVTT_full_val/v2t_metrics/R10: 80.6841046277666
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.925553319919517
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.58657429552989
 MSRVTT_full_test/t2v_metrics/R1: 11.57190635451505
 MSRVTT_full_test/t2v_metrics/R5: 33.24414715719063
 MSRVTT_full_test/t2v_metrics/R10: 47.725752508361204
 MSRVTT_full_test/t2v_metrics/R50: 78.8628762541806
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.433779264214046
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.380982375493478
 MSRVTT_full_test/v2t_metrics/R1: 12.809364548494983
 MSRVTT_full_test/v2t_metrics/R5: 35.28428093645485
 MSRVTT_full_test/v2t_metrics/R10: 50.06688963210702
 MSRVTT_full_test/v2t_metrics/R50: 82.54180602006689
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.24765886287626
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.284802872482285
 mnt_best       : 26.808828794526725
 not_improved_count: 4
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.92274 (QuantReg: 8.08702) QuantErr: 8.08702 batch_time=40.35176 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.69588 (QuantReg: 8.22016) QuantErr: 8.22016 batch_time=0.49042 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 1.88473 (QuantReg: 7.92303) QuantErr: 7.92303 batch_time=0.50473 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.75977 (QuantReg: 8.18179) QuantErr: 8.18179 batch_time=0.54283 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.99503 (QuantReg: 8.27149) QuantErr: 8.27149 batch_time=0.52501 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 2.06951 (QuantReg: 7.98280) QuantErr: 7.98280 batch_time=0.48744 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 2.05673 (QuantReg: 8.20762) QuantErr: 8.20762 batch_time=0.49770 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.85138 (QuantReg: 8.21709) QuantErr: 8.21709 batch_time=0.49337 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.96413 (QuantReg: 8.31499) QuantErr: 8.31499 batch_time=0.50201 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.75946 (QuantReg: 8.08040) QuantErr: 8.08040 batch_time=0.49433 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.75069 (QuantReg: 8.06800) QuantErr: 8.06800 batch_time=0.50680 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.74159 (QuantReg: 8.49044) QuantErr: 8.49044 batch_time=0.48284 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.86279 (QuantReg: 7.87891) QuantErr: 7.87891 batch_time=0.49547 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 2.04003 (QuantReg: 8.23956) QuantErr: 8.23956 batch_time=5.15123 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 1.71391 (QuantReg: 7.78888) QuantErr: 7.78888 batch_time=0.58866 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 2.02492 (QuantReg: 8.56118) QuantErr: 8.56118 batch_time=0.60526 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.86463 (QuantReg: 8.14367) QuantErr: 8.14367 batch_time=0.53097 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 1.88813 (QuantReg: 8.12189) QuantErr: 8.12189 batch_time=0.64756 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.92101 (QuantReg: 8.15359) QuantErr: 8.15359 batch_time=0.51875 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.96334 (QuantReg: 8.27164) QuantErr: 8.27164 batch_time=0.50708 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.95873 (QuantReg: 8.68271) QuantErr: 8.68271 batch_time=0.49204 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 2.08542 (QuantReg: 7.91040) QuantErr: 7.91040 batch_time=0.48881 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.72670 (QuantReg: 8.18485) QuantErr: 8.18485 batch_time=0.49070 
Train Epoch: 37 codebook_update_time=3.37218
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch37.pth ...
Done in 4.367s
removing stale ckpt [epoch 36] [took 0.38s]
 epoch          : 37
 loss           : 1.8707605752944947
 quant_reg      : 8.163742942810059
 quant_err      : 8.163742942810059
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 67.00201207243461
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.653923541247485
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.44392313162705
 MSRVTT_full_val/v2t_metrics/R1: 34.00402414486921
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.961770623742455
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.914411442164045
 MSRVTT_full_test/t2v_metrics/R1: 11.906354515050166
 MSRVTT_full_test/t2v_metrics/R5: 33.67892976588629
 MSRVTT_full_test/t2v_metrics/R10: 47.92642140468227
 MSRVTT_full_test/t2v_metrics/R50: 79.03010033444816
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.67123745819398
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.78576358168273
 MSRVTT_full_test/v2t_metrics/R1: 12.709030100334449
 MSRVTT_full_test/v2t_metrics/R5: 34.74916387959866
 MSRVTT_full_test/v2t_metrics/R10: 50.20066889632107
 MSRVTT_full_test/v2t_metrics/R50: 82.50836120401338
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.54648829431438
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.09239440857632
 mnt_best       : 26.808828794526725
 not_improved_count: 5
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 1.98042 (QuantReg: 8.03100) QuantErr: 8.03100 batch_time=41.62134 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 1.96749 (QuantReg: 8.24109) QuantErr: 8.24109 batch_time=0.49668 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 1.63285 (QuantReg: 8.37614) QuantErr: 8.37614 batch_time=0.53469 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.88428 (QuantReg: 8.17158) QuantErr: 8.17158 batch_time=0.49230 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.87567 (QuantReg: 8.16143) QuantErr: 8.16143 batch_time=0.49505 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 2.06024 (QuantReg: 8.31850) QuantErr: 8.31850 batch_time=0.50202 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.78700 (QuantReg: 7.90302) QuantErr: 7.90302 batch_time=0.49022 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.74231 (QuantReg: 8.23250) QuantErr: 8.23250 batch_time=0.49201 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.66538 (QuantReg: 8.02021) QuantErr: 8.02021 batch_time=0.56164 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.82099 (QuantReg: 8.53312) QuantErr: 8.53312 batch_time=0.50516 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.87091 (QuantReg: 8.04732) QuantErr: 8.04732 batch_time=0.50287 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 2.02717 (QuantReg: 8.19701) QuantErr: 8.19701 batch_time=0.55176 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.83497 (QuantReg: 8.20646) QuantErr: 8.20646 batch_time=0.49282 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.87730 (QuantReg: 8.16543) QuantErr: 8.16543 batch_time=0.50300 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.76157 (QuantReg: 8.24930) QuantErr: 8.24930 batch_time=0.49096 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 1.84284 (QuantReg: 8.14548) QuantErr: 8.14548 batch_time=0.49231 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.93033 (QuantReg: 8.22096) QuantErr: 8.22096 batch_time=0.54102 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.64591 (QuantReg: 8.07197) QuantErr: 8.07197 batch_time=0.50535 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.85123 (QuantReg: 8.15361) QuantErr: 8.15361 batch_time=0.50479 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.78793 (QuantReg: 8.13190) QuantErr: 8.13190 batch_time=0.79645 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.86524 (QuantReg: 8.31553) QuantErr: 8.31553 batch_time=0.49722 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.88412 (QuantReg: 7.94232) QuantErr: 7.94232 batch_time=0.51413 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.85578 (QuantReg: 8.11222) QuantErr: 8.11222 batch_time=1.03804 
Train Epoch: 38 codebook_update_time=1.75918
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch38.pth ...
Done in 4.434s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.871372275352478
 quant_reg      : 8.179568635940552
 quant_err      : 8.179568635940552
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.142857142857142
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.19492043166596
 MSRVTT_full_val/v2t_metrics/R1: 32.394366197183096
 MSRVTT_full_val/v2t_metrics/R5: 68.81287726358148
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.3158953722334
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.820106224826624
 MSRVTT_full_test/t2v_metrics/R1: 11.638795986622073
 MSRVTT_full_test/t2v_metrics/R5: 33.11036789297659
 MSRVTT_full_test/t2v_metrics/R10: 48.09364548494983
 MSRVTT_full_test/t2v_metrics/R50: 79.4314381270903
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.15752508361204
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.463863829576674
 MSRVTT_full_test/v2t_metrics/R1: 12.408026755852843
 MSRVTT_full_test/v2t_metrics/R5: 34.94983277591973
 MSRVTT_full_test/v2t_metrics/R10: 49.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 82.3076923076923
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.93160535117057
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.816565833514787
 mnt_best       : 26.808828794526725
 not_improved_count: 6
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 1.92620 (QuantReg: 8.23121) QuantErr: 8.23121 batch_time=38.18666 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.97717 (QuantReg: 8.02553) QuantErr: 8.02553 batch_time=0.49507 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.63449 (QuantReg: 8.12662) QuantErr: 8.12662 batch_time=0.48309 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 2.00521 (QuantReg: 8.24974) QuantErr: 8.24974 batch_time=0.53087 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.67395 (QuantReg: 7.98528) QuantErr: 7.98528 batch_time=0.49425 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.88909 (QuantReg: 8.43684) QuantErr: 8.43684 batch_time=0.49316 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.78938 (QuantReg: 8.02013) QuantErr: 8.02013 batch_time=0.50234 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.79743 (QuantReg: 8.36203) QuantErr: 8.36203 batch_time=3.60169 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.63521 (QuantReg: 7.92121) QuantErr: 7.92121 batch_time=0.51393 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.63248 (QuantReg: 8.34097) QuantErr: 8.34097 batch_time=0.49021 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.64931 (QuantReg: 7.94528) QuantErr: 7.94528 batch_time=0.50004 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.70240 (QuantReg: 8.42062) QuantErr: 8.42062 batch_time=0.60812 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.93575 (QuantReg: 8.26795) QuantErr: 8.26795 batch_time=0.51157 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.85467 (QuantReg: 8.08857) QuantErr: 8.08857 batch_time=0.48981 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.71555 (QuantReg: 7.96113) QuantErr: 7.96113 batch_time=0.49725 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.70356 (QuantReg: 8.29235) QuantErr: 8.29235 batch_time=0.51892 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.80184 (QuantReg: 8.23774) QuantErr: 8.23774 batch_time=0.48823 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.80682 (QuantReg: 8.18725) QuantErr: 8.18725 batch_time=0.56945 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 1.83926 (QuantReg: 8.11792) QuantErr: 8.11792 batch_time=0.49503 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.82815 (QuantReg: 8.41944) QuantErr: 8.41944 batch_time=0.48652 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.80326 (QuantReg: 8.07730) QuantErr: 8.07730 batch_time=0.50001 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.81934 (QuantReg: 8.49727) QuantErr: 8.49727 batch_time=0.51947 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 1.68523 (QuantReg: 8.04282) QuantErr: 8.04282 batch_time=0.49069 
Train Epoch: 39 codebook_update_time=1.79920
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch39.pth ...
Done in 15.131s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 1.8484219012260437
 quant_reg      : 8.208440866470337
 quant_err      : 8.208440866470337
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_full_val/t2v_metrics/R1: 30.784708249496983
 MSRVTT_full_val/t2v_metrics/R5: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R10: 78.06841046277665
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.017102615694165
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.90962780829253
 MSRVTT_full_val/v2t_metrics/R1: 31.58953722334004
 MSRVTT_full_val/v2t_metrics/R5: 68.00804828973843
 MSRVTT_full_val/v2t_metrics/R10: 81.08651911468813
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.517102615694165
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.84925842688765
 MSRVTT_full_test/t2v_metrics/R1: 11.672240802675585
 MSRVTT_full_test/t2v_metrics/R5: 33.04347826086956
 MSRVTT_full_test/t2v_metrics/R10: 47.591973244147155
 MSRVTT_full_test/t2v_metrics/R50: 78.09364548494983
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.927424749163876
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.37897414556172
 MSRVTT_full_test/v2t_metrics/R1: 11.304347826086957
 MSRVTT_full_test/v2t_metrics/R5: 34.280936454849495
 MSRVTT_full_test/v2t_metrics/R10: 49.331103678929765
 MSRVTT_full_test/v2t_metrics/R50: 82.07357859531773
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.90785953177257
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.738662138732153
 mnt_best       : 26.808828794526725
 not_improved_count: 7
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.91462 (QuantReg: 8.42674) QuantErr: 8.42674 batch_time=43.39211 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.92716 (QuantReg: 8.30498) QuantErr: 8.30498 batch_time=0.51390 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.89446 (QuantReg: 8.11622) QuantErr: 8.11622 batch_time=0.48179 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.70167 (QuantReg: 7.85547) QuantErr: 7.85547 batch_time=0.49018 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.99272 (QuantReg: 8.10069) QuantErr: 8.10069 batch_time=0.50083 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 2.06498 (QuantReg: 8.21549) QuantErr: 8.21549 batch_time=0.50974 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.85156 (QuantReg: 8.36558) QuantErr: 8.36558 batch_time=0.49012 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.92742 (QuantReg: 8.43802) QuantErr: 8.43802 batch_time=0.50670 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 2.06971 (QuantReg: 8.07202) QuantErr: 8.07202 batch_time=0.49193 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 1.69723 (QuantReg: 8.12663) QuantErr: 8.12663 batch_time=0.50458 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.82505 (QuantReg: 8.31254) QuantErr: 8.31254 batch_time=0.49768 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.77851 (QuantReg: 8.15777) QuantErr: 8.15777 batch_time=0.49759 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.80548 (QuantReg: 8.16135) QuantErr: 8.16135 batch_time=0.54150 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.69800 (QuantReg: 8.14083) QuantErr: 8.14083 batch_time=0.87114 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.76633 (QuantReg: 8.08036) QuantErr: 8.08036 batch_time=0.51056 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.84479 (QuantReg: 7.98918) QuantErr: 7.98918 batch_time=0.48990 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.92604 (QuantReg: 8.15172) QuantErr: 8.15172 batch_time=0.49129 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 2.10250 (QuantReg: 8.23922) QuantErr: 8.23922 batch_time=0.50052 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 2.06201 (QuantReg: 8.21789) QuantErr: 8.21789 batch_time=0.48756 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.81293 (QuantReg: 8.17453) QuantErr: 8.17453 batch_time=0.48842 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.91523 (QuantReg: 8.52461) QuantErr: 8.52461 batch_time=0.49254 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 2.01234 (QuantReg: 8.12162) QuantErr: 8.12162 batch_time=0.48654 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 1.70144 (QuantReg: 7.79723) QuantErr: 7.79723 batch_time=0.54333 
Train Epoch: 40 codebook_update_time=1.85914
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch40.pth ...
Done in 3.967s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 1.8679193649291992
 quant_reg      : 8.187696104049683
 quant_err      : 8.187696104049683
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.728370221327967
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.41735255990995
 MSRVTT_full_val/v2t_metrics/R1: 31.187122736418512
 MSRVTT_full_val/v2t_metrics/R5: 69.61770623742454
 MSRVTT_full_val/v2t_metrics/R10: 81.89134808853119
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.225352112676056
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.2312425126986
 MSRVTT_full_test/t2v_metrics/R1: 11.672240802675585
 MSRVTT_full_test/t2v_metrics/R5: 33.21070234113712
 MSRVTT_full_test/t2v_metrics/R10: 46.92307692307692
 MSRVTT_full_test/t2v_metrics/R50: 78.89632107023411
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.79966555183947
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.299021724900204
 MSRVTT_full_test/v2t_metrics/R1: 11.672240802675585
 MSRVTT_full_test/v2t_metrics/R5: 34.81605351170568
 MSRVTT_full_test/v2t_metrics/R10: 49.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 82.37458193979933
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.38277591973244
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.220671268763997
 mnt_best       : 26.808828794526725
 not_improved_count: 8
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.87465 (QuantReg: 7.91062) QuantErr: 7.91062 batch_time=40.18065 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.95103 (QuantReg: 8.08971) QuantErr: 8.08971 batch_time=0.48836 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.83383 (QuantReg: 8.17816) QuantErr: 8.17816 batch_time=0.50617 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.94379 (QuantReg: 8.46975) QuantErr: 8.46975 batch_time=0.51776 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.51673 (QuantReg: 8.25671) QuantErr: 8.25671 batch_time=0.48551 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 1.96272 (QuantReg: 7.79683) QuantErr: 7.79683 batch_time=0.73690 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 2.15342 (QuantReg: 7.97221) QuantErr: 7.97221 batch_time=0.49266 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.88338 (QuantReg: 8.17448) QuantErr: 8.17448 batch_time=0.50484 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.98435 (QuantReg: 8.39912) QuantErr: 8.39912 batch_time=0.49592 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.74044 (QuantReg: 8.35991) QuantErr: 8.35991 batch_time=0.50052 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.96626 (QuantReg: 8.11624) QuantErr: 8.11624 batch_time=0.82792 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.82935 (QuantReg: 8.18224) QuantErr: 8.18224 batch_time=0.50149 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.72430 (QuantReg: 8.11414) QuantErr: 8.11414 batch_time=6.25911 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.64228 (QuantReg: 8.09284) QuantErr: 8.09284 batch_time=0.48360 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.81888 (QuantReg: 8.15814) QuantErr: 8.15814 batch_time=0.49191 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.87062 (QuantReg: 8.21602) QuantErr: 8.21602 batch_time=0.49581 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.87058 (QuantReg: 8.05357) QuantErr: 8.05357 batch_time=0.48262 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 2.06321 (QuantReg: 8.23777) QuantErr: 8.23777 batch_time=0.48900 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.80952 (QuantReg: 8.14601) QuantErr: 8.14601 batch_time=0.49594 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.76244 (QuantReg: 8.36786) QuantErr: 8.36786 batch_time=0.52728 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.90590 (QuantReg: 8.21405) QuantErr: 8.21405 batch_time=0.87687 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.95898 (QuantReg: 8.13621) QuantErr: 8.13621 batch_time=0.83095 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.95066 (QuantReg: 8.29903) QuantErr: 8.29903 batch_time=0.97275 
Train Epoch: 41 codebook_update_time=1.71551
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch41.pth ...
Done in 4.030s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.8737125754356385
 quant_reg      : 8.231924474716186
 quant_err      : 8.231924474716186
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.96579476861167
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.654392521585564
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R10: 81.69014084507042
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.189134808853119
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.708278091787044
 MSRVTT_full_test/t2v_metrics/R1: 11.806020066889632
 MSRVTT_full_test/t2v_metrics/R5: 34.046822742474916
 MSRVTT_full_test/t2v_metrics/R10: 47.290969899665555
 MSRVTT_full_test/t2v_metrics/R50: 79.06354515050167
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.50133779264214
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.688209775455356
 MSRVTT_full_test/v2t_metrics/R1: 12.173913043478262
 MSRVTT_full_test/v2t_metrics/R5: 36.020066889632105
 MSRVTT_full_test/v2t_metrics/R10: 49.46488294314381
 MSRVTT_full_test/v2t_metrics/R50: 82.80936454849498
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.86471571906355
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.888419252574852
 mnt_best       : 26.808828794526725
 not_improved_count: 9
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.83136 (QuantReg: 7.99113) QuantErr: 7.99113 batch_time=40.13768 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.84754 (QuantReg: 7.91210) QuantErr: 7.91210 batch_time=0.50099 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.85256 (QuantReg: 8.11034) QuantErr: 8.11034 batch_time=0.50732 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.68447 (QuantReg: 8.19252) QuantErr: 8.19252 batch_time=0.62057 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 2.12656 (QuantReg: 8.51219) QuantErr: 8.51219 batch_time=0.63752 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.88900 (QuantReg: 8.13533) QuantErr: 8.13533 batch_time=0.49216 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.82140 (QuantReg: 8.39222) QuantErr: 8.39222 batch_time=0.50309 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.91576 (QuantReg: 7.93869) QuantErr: 7.93869 batch_time=0.49525 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 2.04141 (QuantReg: 8.22948) QuantErr: 8.22948 batch_time=0.50724 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.73444 (QuantReg: 8.27538) QuantErr: 8.27538 batch_time=0.49318 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 2.12611 (QuantReg: 8.23294) QuantErr: 8.23294 batch_time=0.49269 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 2.03168 (QuantReg: 8.63460) QuantErr: 8.63460 batch_time=0.49537 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.82702 (QuantReg: 8.36496) QuantErr: 8.36496 batch_time=0.50881 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 1.73628 (QuantReg: 8.24271) QuantErr: 8.24271 batch_time=2.24707 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.98637 (QuantReg: 7.99058) QuantErr: 7.99058 batch_time=0.52484 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.77373 (QuantReg: 8.24164) QuantErr: 8.24164 batch_time=0.51718 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 2.09147 (QuantReg: 8.20284) QuantErr: 8.20284 batch_time=0.55000 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 1.82477 (QuantReg: 7.95139) QuantErr: 7.95139 batch_time=0.52567 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 1.97212 (QuantReg: 8.31879) QuantErr: 8.31879 batch_time=0.49960 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.88055 (QuantReg: 8.21567) QuantErr: 8.21567 batch_time=0.49670 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.73997 (QuantReg: 8.08108) QuantErr: 8.08108 batch_time=0.99087 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 2.05784 (QuantReg: 8.28882) QuantErr: 8.28882 batch_time=0.53369 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.77160 (QuantReg: 8.31953) QuantErr: 8.31953 batch_time=0.51145 
Train Epoch: 42 codebook_update_time=1.81787
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch42.pth ...
Done in 4.016s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.8727242970466613
 quant_reg      : 8.200558771133423
 quant_err      : 8.200558771133423
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_full_val/t2v_metrics/R1: 31.187122736418512
 MSRVTT_full_val/t2v_metrics/R5: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.581488933601609
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.9397292258961
 MSRVTT_full_val/v2t_metrics/R1: 33.199195171026155
 MSRVTT_full_val/v2t_metrics/R5: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R10: 83.09859154929578
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.054325955734406
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.86244116671793
 MSRVTT_full_test/t2v_metrics/R1: 11.806020066889632
 MSRVTT_full_test/t2v_metrics/R5: 33.779264214046826
 MSRVTT_full_test/t2v_metrics/R10: 48.12709030100334
 MSRVTT_full_test/t2v_metrics/R50: 79.36454849498328
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.716722408026754
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.774072560984433
 MSRVTT_full_test/v2t_metrics/R1: 12.642140468227424
 MSRVTT_full_test/v2t_metrics/R5: 35.88628762541806
 MSRVTT_full_test/v2t_metrics/R10: 50.53511705685619
 MSRVTT_full_test/v2t_metrics/R50: 83.04347826086956
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.865551839464885
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.408445747845196
 mnt_best       : 26.808828794526725
 not_improved_count: 10
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 2.00570 (QuantReg: 8.17219) QuantErr: 8.17219 batch_time=40.06781 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.95102 (QuantReg: 8.20748) QuantErr: 8.20748 batch_time=0.50397 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.81235 (QuantReg: 8.03622) QuantErr: 8.03622 batch_time=0.46002 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.74798 (QuantReg: 8.36033) QuantErr: 8.36033 batch_time=0.84452 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.70190 (QuantReg: 8.14044) QuantErr: 8.14044 batch_time=0.53617 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 2.08171 (QuantReg: 8.58190) QuantErr: 8.58190 batch_time=0.50525 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.77196 (QuantReg: 7.99513) QuantErr: 7.99513 batch_time=0.50396 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.81504 (QuantReg: 8.10408) QuantErr: 8.10408 batch_time=0.51904 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.87299 (QuantReg: 8.17357) QuantErr: 8.17357 batch_time=0.51311 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.88824 (QuantReg: 8.18228) QuantErr: 8.18228 batch_time=1.73605 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.97770 (QuantReg: 8.21825) QuantErr: 8.21825 batch_time=1.39341 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 2.16899 (QuantReg: 8.01940) QuantErr: 8.01940 batch_time=0.52436 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.95949 (QuantReg: 8.48056) QuantErr: 8.48056 batch_time=0.52948 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 1.65262 (QuantReg: 8.27340) QuantErr: 8.27340 batch_time=0.50822 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 2.09692 (QuantReg: 8.12895) QuantErr: 8.12895 batch_time=0.85221 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.97041 (QuantReg: 8.27898) QuantErr: 8.27898 batch_time=0.51487 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.72609 (QuantReg: 8.09054) QuantErr: 8.09054 batch_time=0.49987 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.79845 (QuantReg: 8.34472) QuantErr: 8.34472 batch_time=0.87483 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.65701 (QuantReg: 8.44996) QuantErr: 8.44996 batch_time=0.50269 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 2.06265 (QuantReg: 8.37769) QuantErr: 8.37769 batch_time=0.55534 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 2.06079 (QuantReg: 8.40871) QuantErr: 8.40871 batch_time=0.51467 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 1.69604 (QuantReg: 8.19957) QuantErr: 8.19957 batch_time=0.49916 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.94284 (QuantReg: 8.21302) QuantErr: 8.21302 batch_time=0.51081 
Train Epoch: 43 codebook_update_time=2.05022
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch43.pth ...
Done in 4.014s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 1.858938693523407
 quant_reg      : 8.213564140319825
 quant_err      : 8.213564140319825
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.76056338028169
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.928424661234615
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.012072434607646
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.07121458795375
 MSRVTT_full_test/t2v_metrics/R1: 11.605351170568563
 MSRVTT_full_test/t2v_metrics/R5: 33.84615384615385
 MSRVTT_full_test/t2v_metrics/R10: 47.725752508361204
 MSRVTT_full_test/t2v_metrics/R50: 78.82943143812709
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.79832775919733
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.564815164671217
 MSRVTT_full_test/v2t_metrics/R1: 11.939799331103679
 MSRVTT_full_test/v2t_metrics/R5: 35.1505016722408
 MSRVTT_full_test/v2t_metrics/R10: 50.33444816053512
 MSRVTT_full_test/v2t_metrics/R50: 82.17391304347827
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.34598662207358
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.64381358757354
 mnt_best       : 26.808828794526725
 not_improved_count: 11
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 1.61833 (QuantReg: 8.26573) QuantErr: 8.26573 batch_time=40.26123 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.66973 (QuantReg: 8.33169) QuantErr: 8.33169 batch_time=0.51608 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.80376 (QuantReg: 8.31944) QuantErr: 8.31944 batch_time=0.49632 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.82938 (QuantReg: 8.05339) QuantErr: 8.05339 batch_time=0.50518 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 2.09082 (QuantReg: 8.14331) QuantErr: 8.14331 batch_time=0.49079 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.62336 (QuantReg: 7.83585) QuantErr: 7.83585 batch_time=0.49563 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.72094 (QuantReg: 8.31976) QuantErr: 8.31976 batch_time=0.50447 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 2.25786 (QuantReg: 8.14059) QuantErr: 8.14059 batch_time=0.51956 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.86466 (QuantReg: 8.46839) QuantErr: 8.46839 batch_time=0.51542 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.94266 (QuantReg: 8.09337) QuantErr: 8.09337 batch_time=0.54002 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 2.13451 (QuantReg: 8.59127) QuantErr: 8.59127 batch_time=0.51534 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.95070 (QuantReg: 8.11421) QuantErr: 8.11421 batch_time=0.54016 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.84660 (QuantReg: 8.40913) QuantErr: 8.40913 batch_time=0.54376 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.84932 (QuantReg: 8.03255) QuantErr: 8.03255 batch_time=0.53944 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.95507 (QuantReg: 8.20720) QuantErr: 8.20720 batch_time=0.50354 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.75776 (QuantReg: 8.49614) QuantErr: 8.49614 batch_time=0.53379 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.72561 (QuantReg: 7.89283) QuantErr: 7.89283 batch_time=0.49027 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.68109 (QuantReg: 7.83480) QuantErr: 7.83480 batch_time=0.53702 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.93709 (QuantReg: 8.05273) QuantErr: 8.05273 batch_time=0.52042 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.85493 (QuantReg: 8.49924) QuantErr: 8.49924 batch_time=0.50186 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.88550 (QuantReg: 8.16612) QuantErr: 8.16612 batch_time=0.51536 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.51901 (QuantReg: 8.05129) QuantErr: 8.05129 batch_time=0.51669 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.73509 (QuantReg: 8.19866) QuantErr: 8.19866 batch_time=0.49696 
Train Epoch: 44 codebook_update_time=1.83159
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch44.pth ...
Done in 4.207s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch44.pth ...
Done in 8.640s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.875107400894165
 quant_reg      : 8.212271448135375
 quant_err      : 8.212271448135375
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 65.79476861167002
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.764587525150905
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.42485565588812
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 71.42857142857143
 MSRVTT_full_val/v2t_metrics/R10: 82.49496981891348
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.869215291750503
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.400617850912994
 MSRVTT_full_test/t2v_metrics/R1: 11.939799331103679
 MSRVTT_full_test/t2v_metrics/R5: 34.080267558528426
 MSRVTT_full_test/t2v_metrics/R10: 47.725752508361204
 MSRVTT_full_test/t2v_metrics/R50: 78.36120401337793
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.17257525083612
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.879278230837375
 MSRVTT_full_test/v2t_metrics/R1: 12.341137123745819
 MSRVTT_full_test/v2t_metrics/R5: 35.819397993311036
 MSRVTT_full_test/v2t_metrics/R10: 50.13377926421405
 MSRVTT_full_test/v2t_metrics/R50: 82.94314381270902
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.8066889632107
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.088893725716414
 mnt_best       : 26.879278230837375
 not_improved_count: 0
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.88300 (QuantReg: 8.08081) QuantErr: 8.08081 batch_time=41.64883 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.90103 (QuantReg: 8.26315) QuantErr: 8.26315 batch_time=0.48607 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 1.92753 (QuantReg: 8.30577) QuantErr: 8.30577 batch_time=0.70419 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.67911 (QuantReg: 8.23402) QuantErr: 8.23402 batch_time=0.49707 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.89352 (QuantReg: 8.13136) QuantErr: 8.13136 batch_time=0.48270 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.54851 (QuantReg: 7.93435) QuantErr: 7.93435 batch_time=0.51221 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 1.88159 (QuantReg: 7.92981) QuantErr: 7.92981 batch_time=0.49848 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 2.30131 (QuantReg: 8.13985) QuantErr: 8.13985 batch_time=0.50490 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.87405 (QuantReg: 8.27632) QuantErr: 8.27632 batch_time=0.55775 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 1.61776 (QuantReg: 8.02370) QuantErr: 8.02370 batch_time=0.51533 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 2.00717 (QuantReg: 8.30443) QuantErr: 8.30443 batch_time=0.49925 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.81820 (QuantReg: 7.90637) QuantErr: 7.90637 batch_time=0.48815 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.82468 (QuantReg: 8.16732) QuantErr: 8.16732 batch_time=0.51438 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.96588 (QuantReg: 8.26894) QuantErr: 8.26894 batch_time=0.54320 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.91462 (QuantReg: 8.29647) QuantErr: 8.29647 batch_time=0.54713 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 1.69156 (QuantReg: 7.98453) QuantErr: 7.98453 batch_time=0.50585 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.89357 (QuantReg: 8.16672) QuantErr: 8.16672 batch_time=0.50111 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.85773 (QuantReg: 8.51416) QuantErr: 8.51416 batch_time=0.51599 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 1.64594 (QuantReg: 8.32476) QuantErr: 8.32476 batch_time=0.49561 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 1.92197 (QuantReg: 8.20339) QuantErr: 8.20339 batch_time=0.54473 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.94600 (QuantReg: 8.00394) QuantErr: 8.00394 batch_time=0.50140 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 1.61200 (QuantReg: 8.21979) QuantErr: 8.21979 batch_time=0.49245 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.96045 (QuantReg: 7.88975) QuantErr: 7.88975 batch_time=0.48706 
Train Epoch: 45 codebook_update_time=1.84451
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch45.pth ...
Done in 4.972s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch45.pth ...
Done in 27.575s
removing stale ckpt [epoch 44] [took 0.03s]
 epoch          : 45
 loss           : 1.8607265830039978
 quant_reg      : 8.215341083526612
 quant_err      : 8.215341083526612
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_full_val/t2v_metrics/R1: 30.58350100603622
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.515090543259557
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.05812760343738
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.7645875251509056
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.90953889288565
 MSRVTT_full_test/t2v_metrics/R1: 12.006688963210703
 MSRVTT_full_test/t2v_metrics/R5: 33.84615384615385
 MSRVTT_full_test/t2v_metrics/R10: 48.561872909699
 MSRVTT_full_test/t2v_metrics/R50: 79.06354515050167
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.56989966555184
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.023566829777963
 MSRVTT_full_test/v2t_metrics/R1: 12.608695652173912
 MSRVTT_full_test/v2t_metrics/R5: 36.12040133779264
 MSRVTT_full_test/v2t_metrics/R10: 50.903010033444815
 MSRVTT_full_test/v2t_metrics/R50: 83.07692307692308
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.64448160535117
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.513819607725534
 mnt_best       : 27.023566829777963
 not_improved_count: 0
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 1.80121 (QuantReg: 8.01101) QuantErr: 8.01101 batch_time=38.78575 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.83827 (QuantReg: 8.28944) QuantErr: 8.28944 batch_time=0.58533 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.55781 (QuantReg: 8.16995) QuantErr: 8.16995 batch_time=0.99397 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.71555 (QuantReg: 8.24882) QuantErr: 8.24882 batch_time=0.51132 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.99240 (QuantReg: 8.41736) QuantErr: 8.41736 batch_time=0.52420 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.59175 (QuantReg: 8.05493) QuantErr: 8.05493 batch_time=0.48835 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.84170 (QuantReg: 8.18377) QuantErr: 8.18377 batch_time=0.52992 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.88844 (QuantReg: 8.36590) QuantErr: 8.36590 batch_time=0.51605 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 1.90622 (QuantReg: 8.21914) QuantErr: 8.21914 batch_time=0.74128 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 1.83399 (QuantReg: 8.10335) QuantErr: 8.10335 batch_time=0.50920 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.67171 (QuantReg: 7.93351) QuantErr: 7.93351 batch_time=0.49403 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.80371 (QuantReg: 8.26057) QuantErr: 8.26057 batch_time=0.51431 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 2.17239 (QuantReg: 8.09586) QuantErr: 8.09586 batch_time=0.53554 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.80184 (QuantReg: 8.03176) QuantErr: 8.03176 batch_time=1.57818 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.85544 (QuantReg: 8.36591) QuantErr: 8.36591 batch_time=0.49295 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.79026 (QuantReg: 8.52532) QuantErr: 8.52532 batch_time=0.52112 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.89499 (QuantReg: 8.18298) QuantErr: 8.18298 batch_time=0.52104 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.73598 (QuantReg: 8.14231) QuantErr: 8.14231 batch_time=0.52735 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 1.80143 (QuantReg: 8.29902) QuantErr: 8.29902 batch_time=0.50709 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 1.71630 (QuantReg: 8.51535) QuantErr: 8.51535 batch_time=0.52358 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.63205 (QuantReg: 8.13576) QuantErr: 8.13576 batch_time=0.51570 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.73129 (QuantReg: 8.24418) QuantErr: 8.24418 batch_time=0.51494 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.81922 (QuantReg: 8.08815) QuantErr: 8.08815 batch_time=0.50506 
Train Epoch: 46 codebook_update_time=1.95321
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch46.pth ...
Done in 22.916s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 1.8618762240409852
 quant_reg      : 8.200889841079713
 quant_err      : 8.200889841079713
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 65.99597585513078
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.945674044265594
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.66449013281209
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 82.897384305835
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.158953722334005
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.76771462837674
 MSRVTT_full_test/t2v_metrics/R1: 11.73913043478261
 MSRVTT_full_test/t2v_metrics/R5: 33.94648829431438
 MSRVTT_full_test/t2v_metrics/R10: 47.85953177257525
 MSRVTT_full_test/t2v_metrics/R50: 78.49498327759197
 MSRVTT_full_test/t2v_metrics/MedR: 11.5
 MSRVTT_full_test/t2v_metrics/MeanR: 53.38612040133779
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.717741429839077
 MSRVTT_full_test/v2t_metrics/R1: 12.14046822742475
 MSRVTT_full_test/v2t_metrics/R5: 35.618729096989966
 MSRVTT_full_test/v2t_metrics/R10: 50.40133779264214
 MSRVTT_full_test/v2t_metrics/R50: 82.14046822742475
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.91421404682274
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.933068092556745
 mnt_best       : 27.023566829777963
 not_improved_count: 1
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.80959 (QuantReg: 8.55253) QuantErr: 8.55253 batch_time=45.65335 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.98158 (QuantReg: 8.11099) QuantErr: 8.11099 batch_time=0.50611 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.84963 (QuantReg: 7.99467) QuantErr: 7.99467 batch_time=0.70726 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.78384 (QuantReg: 8.15616) QuantErr: 8.15616 batch_time=0.57516 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.90672 (QuantReg: 8.32637) QuantErr: 8.32637 batch_time=0.51109 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 1.61345 (QuantReg: 8.15568) QuantErr: 8.15568 batch_time=0.49788 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 2.05479 (QuantReg: 8.09640) QuantErr: 8.09640 batch_time=0.49410 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.68780 (QuantReg: 7.82599) QuantErr: 7.82599 batch_time=0.53567 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.73296 (QuantReg: 8.43710) QuantErr: 8.43710 batch_time=0.52484 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 1.68985 (QuantReg: 8.27706) QuantErr: 8.27706 batch_time=0.49521 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 2.06958 (QuantReg: 7.91832) QuantErr: 7.91832 batch_time=0.49217 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 1.80391 (QuantReg: 8.20276) QuantErr: 8.20276 batch_time=0.49632 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 2.01430 (QuantReg: 8.54130) QuantErr: 8.54130 batch_time=0.52589 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.91172 (QuantReg: 8.08201) QuantErr: 8.08201 batch_time=0.49771 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.90438 (QuantReg: 8.20905) QuantErr: 8.20905 batch_time=0.49373 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.85153 (QuantReg: 8.31912) QuantErr: 8.31912 batch_time=0.49721 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 2.19281 (QuantReg: 8.04548) QuantErr: 8.04548 batch_time=0.53220 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.78125 (QuantReg: 8.43055) QuantErr: 8.43055 batch_time=0.49572 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.86404 (QuantReg: 8.23604) QuantErr: 8.23604 batch_time=0.50202 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.83942 (QuantReg: 8.23208) QuantErr: 8.23208 batch_time=0.49550 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 2.11390 (QuantReg: 8.03241) QuantErr: 8.03241 batch_time=0.51294 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.73186 (QuantReg: 8.26597) QuantErr: 8.26597 batch_time=0.50354 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.85220 (QuantReg: 8.26483) QuantErr: 8.26483 batch_time=0.64131 
Train Epoch: 47 codebook_update_time=1.79071
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch47.pth ...
Done in 4.234s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch47.pth ...
Done in 8.164s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 1.8794000759124756
 quant_reg      : 8.198558616638184
 quant_err      : 8.198558616638184
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_full_val/t2v_metrics/R1: 30.18108651911469
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.507042253521128
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.95227540793213
 MSRVTT_full_val/v2t_metrics/R1: 32.99798792756539
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 82.69617706237425
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.959758551307847
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.92596202973439
 MSRVTT_full_test/t2v_metrics/R1: 12.307692307692308
 MSRVTT_full_test/t2v_metrics/R5: 34.247491638795985
 MSRVTT_full_test/t2v_metrics/R10: 49.130434782608695
 MSRVTT_full_test/t2v_metrics/R50: 79.49832775919732
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.44899665551839
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.461146732791338
 MSRVTT_full_test/v2t_metrics/R1: 12.240802675585284
 MSRVTT_full_test/v2t_metrics/R5: 35.65217391304348
 MSRVTT_full_test/v2t_metrics/R10: 50.635451505016725
 MSRVTT_full_test/v2t_metrics/R50: 82.97658862876254
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.35167224080268
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.061886695406482
 mnt_best       : 27.461146732791338
 not_improved_count: 0
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 2.02911 (QuantReg: 7.88483) QuantErr: 7.88483 batch_time=41.11579 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.86761 (QuantReg: 8.29882) QuantErr: 8.29882 batch_time=0.51378 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.80714 (QuantReg: 8.14553) QuantErr: 8.14553 batch_time=0.50270 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.78759 (QuantReg: 8.20215) QuantErr: 8.20215 batch_time=0.50883 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.83039 (QuantReg: 8.08593) QuantErr: 8.08593 batch_time=0.50918 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.81388 (QuantReg: 8.32847) QuantErr: 8.32847 batch_time=0.51015 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.94492 (QuantReg: 8.32186) QuantErr: 8.32186 batch_time=0.55105 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.82989 (QuantReg: 7.95395) QuantErr: 7.95395 batch_time=0.51696 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.84388 (QuantReg: 8.25486) QuantErr: 8.25486 batch_time=0.48581 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.64406 (QuantReg: 8.21029) QuantErr: 8.21029 batch_time=0.50485 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.76638 (QuantReg: 8.35625) QuantErr: 8.35625 batch_time=0.53523 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 2.02344 (QuantReg: 8.23168) QuantErr: 8.23168 batch_time=0.85935 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.82038 (QuantReg: 8.21781) QuantErr: 8.21781 batch_time=0.50932 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.76456 (QuantReg: 8.19966) QuantErr: 8.19966 batch_time=1.20739 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.85283 (QuantReg: 8.36664) QuantErr: 8.36664 batch_time=0.50395 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.90070 (QuantReg: 8.05508) QuantErr: 8.05508 batch_time=0.57381 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 1.70918 (QuantReg: 8.45572) QuantErr: 8.45572 batch_time=0.50497 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 2.07198 (QuantReg: 8.38164) QuantErr: 8.38164 batch_time=0.56175 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.96290 (QuantReg: 8.30623) QuantErr: 8.30623 batch_time=1.90671 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.95763 (QuantReg: 8.31082) QuantErr: 8.31082 batch_time=0.49396 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.75645 (QuantReg: 8.16313) QuantErr: 8.16313 batch_time=0.51446 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 2.02996 (QuantReg: 8.41335) QuantErr: 8.41335 batch_time=0.63999 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 2.13147 (QuantReg: 8.13385) QuantErr: 8.13385 batch_time=0.60603 
Train Epoch: 48 codebook_update_time=1.71526
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch48.pth ...
Done in 3.844s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 1.884695770740509
 quant_reg      : 8.211123706817627
 quant_err      : 8.211123706817627
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.472837022132797
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.33430213567093
 MSRVTT_full_val/v2t_metrics/R1: 31.58953722334004
 MSRVTT_full_val/v2t_metrics/R5: 71.0261569416499
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.050301810865191
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.89687993541679
 MSRVTT_full_test/t2v_metrics/R1: 12.173913043478262
 MSRVTT_full_test/t2v_metrics/R5: 35.08361204013378
 MSRVTT_full_test/t2v_metrics/R10: 48.06020066889632
 MSRVTT_full_test/t2v_metrics/R50: 79.19732441471572
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.455852842809364
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.380414913651396
 MSRVTT_full_test/v2t_metrics/R1: 12.809364548494983
 MSRVTT_full_test/v2t_metrics/R5: 35.752508361204015
 MSRVTT_full_test/v2t_metrics/R10: 50.33444816053512
 MSRVTT_full_test/v2t_metrics/R50: 82.8428093645485
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.49397993311037
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.459884815153025
 mnt_best       : 27.461146732791338
 not_improved_count: 1
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.66421 (QuantReg: 8.06404) QuantErr: 8.06404 batch_time=45.02632 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.76481 (QuantReg: 8.13810) QuantErr: 8.13810 batch_time=0.49377 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.73124 (QuantReg: 8.16659) QuantErr: 8.16659 batch_time=0.48313 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.89400 (QuantReg: 8.36168) QuantErr: 8.36168 batch_time=0.48514 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.71920 (QuantReg: 8.24656) QuantErr: 8.24656 batch_time=0.48989 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 2.15846 (QuantReg: 8.34524) QuantErr: 8.34524 batch_time=0.48843 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.94406 (QuantReg: 8.33062) QuantErr: 8.33062 batch_time=0.47875 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 1.88014 (QuantReg: 8.17535) QuantErr: 8.17535 batch_time=3.06596 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 2.00126 (QuantReg: 8.24729) QuantErr: 8.24729 batch_time=0.48958 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.69937 (QuantReg: 8.06804) QuantErr: 8.06804 batch_time=0.50696 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.81237 (QuantReg: 8.38476) QuantErr: 8.38476 batch_time=0.49974 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.95295 (QuantReg: 8.04626) QuantErr: 8.04626 batch_time=0.65485 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.97591 (QuantReg: 7.94830) QuantErr: 7.94830 batch_time=0.50432 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.77814 (QuantReg: 8.26881) QuantErr: 8.26881 batch_time=0.51343 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.94120 (QuantReg: 8.33512) QuantErr: 8.33512 batch_time=0.49459 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 1.85334 (QuantReg: 8.22205) QuantErr: 8.22205 batch_time=0.49057 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 1.76637 (QuantReg: 8.25062) QuantErr: 8.25062 batch_time=0.82696 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.86070 (QuantReg: 8.21502) QuantErr: 8.21502 batch_time=0.49520 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.87638 (QuantReg: 8.36489) QuantErr: 8.36489 batch_time=0.51346 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 2.07563 (QuantReg: 8.20649) QuantErr: 8.20649 batch_time=0.49128 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.77436 (QuantReg: 8.21345) QuantErr: 8.21345 batch_time=0.66898 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 1.56492 (QuantReg: 8.31580) QuantErr: 8.31580 batch_time=0.48291 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.76316 (QuantReg: 8.17528) QuantErr: 8.17528 batch_time=0.49460 
Train Epoch: 49 codebook_update_time=1.62788
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch49.pth ...
Done in 12.603s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 1.8740790014266968
 quant_reg      : 8.213899702072144
 quant_err      : 8.213899702072144
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_full_val/t2v_metrics/R1: 30.784708249496983
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.686116700201207
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.069232149230174
 MSRVTT_full_val/v2t_metrics/R1: 31.99195171026157
 MSRVTT_full_val/v2t_metrics/R5: 70.4225352112676
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.881287726358149
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.975138361809385
 MSRVTT_full_test/t2v_metrics/R1: 12.14046822742475
 MSRVTT_full_test/t2v_metrics/R5: 34.414715719063544
 MSRVTT_full_test/t2v_metrics/R10: 47.95986622073578
 MSRVTT_full_test/t2v_metrics/R50: 78.62876254180603
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.69933110367893
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.16142360152137
 MSRVTT_full_test/v2t_metrics/R1: 12.642140468227424
 MSRVTT_full_test/v2t_metrics/R5: 35.48494983277592
 MSRVTT_full_test/v2t_metrics/R10: 50.33444816053512
 MSRVTT_full_test/v2t_metrics/R50: 82.6086956521739
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.38913043478261
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.264634440235643
 mnt_best       : 27.461146732791338
 not_improved_count: 2
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.82426 (QuantReg: 8.25922) QuantErr: 8.25922 batch_time=39.16102 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.74629 (QuantReg: 8.15650) QuantErr: 8.15650 batch_time=0.49836 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.88627 (QuantReg: 8.27691) QuantErr: 8.27691 batch_time=0.70366 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.84997 (QuantReg: 8.39286) QuantErr: 8.39286 batch_time=0.50687 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 2.01494 (QuantReg: 8.25256) QuantErr: 8.25256 batch_time=0.90608 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 1.91775 (QuantReg: 8.37270) QuantErr: 8.37270 batch_time=0.49291 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.77539 (QuantReg: 8.33624) QuantErr: 8.33624 batch_time=0.54376 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 2.04565 (QuantReg: 8.21716) QuantErr: 8.21716 batch_time=0.48500 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 1.85152 (QuantReg: 8.11969) QuantErr: 8.11969 batch_time=0.49277 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.66341 (QuantReg: 8.12357) QuantErr: 8.12357 batch_time=0.49696 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.83830 (QuantReg: 8.23050) QuantErr: 8.23050 batch_time=0.49739 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 2.11213 (QuantReg: 8.58770) QuantErr: 8.58770 batch_time=0.48596 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 2.00736 (QuantReg: 8.11720) QuantErr: 8.11720 batch_time=0.48999 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.83475 (QuantReg: 7.84116) QuantErr: 7.84116 batch_time=0.48658 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 2.04280 (QuantReg: 8.02846) QuantErr: 8.02846 batch_time=0.48907 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 1.70521 (QuantReg: 8.47655) QuantErr: 8.47655 batch_time=0.50561 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 2.09297 (QuantReg: 8.26965) QuantErr: 8.26965 batch_time=0.49957 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 2.18366 (QuantReg: 8.25715) QuantErr: 8.25715 batch_time=0.49742 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.67528 (QuantReg: 8.50045) QuantErr: 8.50045 batch_time=2.88456 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 1.89855 (QuantReg: 8.36244) QuantErr: 8.36244 batch_time=0.49177 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.83190 (QuantReg: 8.07370) QuantErr: 8.07370 batch_time=0.48336 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.90482 (QuantReg: 8.25094) QuantErr: 8.25094 batch_time=0.48171 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.85149 (QuantReg: 8.36240) QuantErr: 8.36240 batch_time=0.48774 
Train Epoch: 50 codebook_update_time=1.76483
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/checkpoint-epoch50.pth ...
Done in 4.529s
removing stale ckpt [epoch 49] [took 0.04s]
 epoch          : 50
 loss           : 1.8771663155555725
 quant_reg      : 8.239820055007934
 quant_err      : 8.239820055007934
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 67.00201207243461
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.553319919517103
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.078900202825814
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.899396378269618
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.39788188479244
 MSRVTT_full_test/t2v_metrics/R1: 12.107023411371237
 MSRVTT_full_test/t2v_metrics/R5: 34.48160535117057
 MSRVTT_full_test/t2v_metrics/R10: 48.09364548494983
 MSRVTT_full_test/t2v_metrics/R50: 78.92976588628763
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.667558528428096
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.17925316514989
 MSRVTT_full_test/v2t_metrics/R1: 12.474916387959865
 MSRVTT_full_test/v2t_metrics/R5: 35.986622073578594
 MSRVTT_full_test/v2t_metrics/R10: 50.2675585284281
 MSRVTT_full_test/v2t_metrics/R50: 82.40802675585284
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.66020066889632
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.25891650561328
 mnt_best       : 27.461146732791338
 not_improved_count: 3
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/trained_model.pth ...
Ckpt loaded at epoch 47.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 12.307692307692308
 t2v_metrics/R5/final_eval: 34.247491638795985
 t2v_metrics/R10/final_eval: 49.130434782608695
 t2v_metrics/R50/final_eval: 79.49832775919732
 t2v_metrics/MedR/final_eval: 11.0
 t2v_metrics/MeanR/final_eval: 50.44899665551839
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 27.461146732791338
 v2t_metrics/R1/final_eval: 12.240802675585284
 v2t_metrics/R5/final_eval: 35.65217391304348
 v2t_metrics/R10/final_eval: 50.668896321070235
 v2t_metrics/R50/final_eval: 82.97658862876254
 v2t_metrics/MedR/final_eval: 10.0
 v2t_metrics/MeanR/final_eval: 44.35
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 28.06806364623232
Best epoch for the monitored metric: 47
Script took 04h36m19s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.12/trained_model.pth
