Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 758.2213871479034 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 79.00582242012024 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 51.26963424682617 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch0.pth ...
Done in 1.518s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch0.pth ...
Done in 3.061s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 1.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 5.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 493.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 497.737
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.48202845283504603
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 498.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 505.3195
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.4641588833612779
 mnt_best       : 0.48202845283504603
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 29.89663 (QuantReg: 22.59459) QuantErr: 22.59459 batch_time=30.78541 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 27.79935 (QuantReg: 22.60187) QuantErr: 22.60187 batch_time=0.99034 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 24.80278 (QuantReg: 22.65713) QuantErr: 22.65713 batch_time=0.92532 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 21.40261 (QuantReg: 22.65371) QuantErr: 22.65371 batch_time=2.34367 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 19.69526 (QuantReg: 22.66428) QuantErr: 22.66428 batch_time=0.94328 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 19.55890 (QuantReg: 22.66284) QuantErr: 22.66284 batch_time=0.97457 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 18.00274 (QuantReg: 22.66956) QuantErr: 22.66956 batch_time=1.00565 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 17.55100 (QuantReg: 22.65466) QuantErr: 22.65466 batch_time=1.02917 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 17.55083 (QuantReg: 22.67546) QuantErr: 22.67546 batch_time=1.28303 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 15.37063 (QuantReg: 22.67007) QuantErr: 22.67007 batch_time=0.97952 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 17.11647 (QuantReg: 22.67727) QuantErr: 22.67727 batch_time=0.95425 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 16.70647 (QuantReg: 22.64173) QuantErr: 22.64173 batch_time=0.96146 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 15.36116 (QuantReg: 22.61941) QuantErr: 22.61941 batch_time=0.96741 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 16.66200 (QuantReg: 22.63877) QuantErr: 22.63877 batch_time=0.97336 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 14.85268 (QuantReg: 22.65720) QuantErr: 22.65720 batch_time=1.06641 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 13.63951 (QuantReg: 22.64886) QuantErr: 22.64886 batch_time=0.93828 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 14.76163 (QuantReg: 22.64895) QuantErr: 22.64895 batch_time=0.91645 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 14.14204 (QuantReg: 22.64174) QuantErr: 22.64174 batch_time=0.94333 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 14.44629 (QuantReg: 22.62582) QuantErr: 22.62582 batch_time=0.93147 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 14.17005 (QuantReg: 22.61928) QuantErr: 22.61928 batch_time=0.94994 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 15.47453 (QuantReg: 22.63895) QuantErr: 22.63895 batch_time=0.92971 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 13.17490 (QuantReg: 22.64299) QuantErr: 22.64299 batch_time=0.97028 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 13.37563 (QuantReg: 22.63142) QuantErr: 22.63142 batch_time=1.04302 
Train Epoch: 1 codebook_update_time=9.06706
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch1.pth ...
Done in 3.911s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch1.pth ...
Done in 7.860s
 epoch          : 1
 loss           : 17.15393857574463
 quant_reg      : 22.643875175476076
 quant_err      : 22.643875175476076
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 29.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 44.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 77.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 44.959
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.04281878610671
 MSRVTT_jsfusion_test/v2t_metrics/R1: 10.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 30.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 44.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 78.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 13.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 45.4105
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.02088979818282
 mnt_best       : 23.04281878610671
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 11.96206 (QuantReg: 10.71960) QuantErr: 10.71960 batch_time=31.38387 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 11.20891 (QuantReg: 10.91537) QuantErr: 10.91537 batch_time=0.90360 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 13.36488 (QuantReg: 11.30145) QuantErr: 11.30145 batch_time=1.01445 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 13.74975 (QuantReg: 11.39367) QuantErr: 11.39367 batch_time=0.92499 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 11.57125 (QuantReg: 11.94589) QuantErr: 11.94589 batch_time=1.06594 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 12.73718 (QuantReg: 11.78610) QuantErr: 11.78610 batch_time=1.02020 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 12.91330 (QuantReg: 12.04603) QuantErr: 12.04603 batch_time=0.92175 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 12.24374 (QuantReg: 12.31382) QuantErr: 12.31382 batch_time=0.96735 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 10.92780 (QuantReg: 12.37266) QuantErr: 12.37266 batch_time=0.91331 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 12.75985 (QuantReg: 12.51236) QuantErr: 12.51236 batch_time=0.92098 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 11.55750 (QuantReg: 12.09157) QuantErr: 12.09157 batch_time=0.98177 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 12.40373 (QuantReg: 12.77722) QuantErr: 12.77722 batch_time=0.89583 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 11.48190 (QuantReg: 12.99397) QuantErr: 12.99397 batch_time=1.08634 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 12.47346 (QuantReg: 12.94310) QuantErr: 12.94310 batch_time=1.11984 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 10.96754 (QuantReg: 12.74644) QuantErr: 12.74644 batch_time=0.92053 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 10.50140 (QuantReg: 13.27167) QuantErr: 13.27167 batch_time=0.94573 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 10.90514 (QuantReg: 13.08710) QuantErr: 13.08710 batch_time=0.95792 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 10.48556 (QuantReg: 13.85788) QuantErr: 13.85788 batch_time=0.91899 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 11.78537 (QuantReg: 13.14997) QuantErr: 13.14997 batch_time=0.91749 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 11.29182 (QuantReg: 13.70763) QuantErr: 13.70763 batch_time=0.97704 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 11.84098 (QuantReg: 13.56371) QuantErr: 13.56371 batch_time=0.94195 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 11.39963 (QuantReg: 13.31595) QuantErr: 13.31595 batch_time=1.01952 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 10.78001 (QuantReg: 14.17490) QuantErr: 14.17490 batch_time=0.94436 
Train Epoch: 2 codebook_update_time=7.87210
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch2.pth ...
Done in 3.962s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch2.pth ...
Done in 7.805s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 11.7922179107666
 quant_reg      : 12.609162910461425
 quant_err      : 12.609162910461425
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 38.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.246
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.03937939726272
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.482
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.2342805831229
 mnt_best       : 30.03937939726272
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 10.05675 (QuantReg: 11.06346) QuantErr: 11.06346 batch_time=31.62554 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 9.89226 (QuantReg: 11.23579) QuantErr: 11.23579 batch_time=0.98339 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 12.29387 (QuantReg: 11.31264) QuantErr: 11.31264 batch_time=0.90123 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 9.87854 (QuantReg: 11.44449) QuantErr: 11.44449 batch_time=0.93215 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 9.67014 (QuantReg: 11.27541) QuantErr: 11.27541 batch_time=0.88623 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 8.94147 (QuantReg: 11.78840) QuantErr: 11.78840 batch_time=0.97009 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 9.25067 (QuantReg: 11.66095) QuantErr: 11.66095 batch_time=1.10417 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 10.42632 (QuantReg: 11.64065) QuantErr: 11.64065 batch_time=1.39603 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 10.39649 (QuantReg: 11.44969) QuantErr: 11.44969 batch_time=0.90346 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 10.87288 (QuantReg: 11.73318) QuantErr: 11.73318 batch_time=0.90002 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 9.10459 (QuantReg: 11.84946) QuantErr: 11.84946 batch_time=0.92381 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 9.69590 (QuantReg: 11.28630) QuantErr: 11.28630 batch_time=0.94042 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 10.27170 (QuantReg: 12.06752) QuantErr: 12.06752 batch_time=0.92411 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 9.66831 (QuantReg: 12.02289) QuantErr: 12.02289 batch_time=0.95652 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 11.47026 (QuantReg: 12.53286) QuantErr: 12.53286 batch_time=0.91148 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 8.13538 (QuantReg: 11.97316) QuantErr: 11.97316 batch_time=0.94703 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 10.28497 (QuantReg: 12.07623) QuantErr: 12.07623 batch_time=0.99789 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 8.93641 (QuantReg: 12.16033) QuantErr: 12.16033 batch_time=1.08799 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 9.73000 (QuantReg: 12.04339) QuantErr: 12.04339 batch_time=0.96547 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 9.11312 (QuantReg: 11.86605) QuantErr: 11.86605 batch_time=1.00852 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 10.25916 (QuantReg: 12.14403) QuantErr: 12.14403 batch_time=1.15069 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 8.65078 (QuantReg: 12.62565) QuantErr: 12.62565 batch_time=0.92940 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 8.92398 (QuantReg: 12.89548) QuantErr: 12.89548 batch_time=1.06786 
Train Epoch: 3 codebook_update_time=8.29778
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch3.pth ...
Done in 4.090s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch3.pth ...
Done in 8.017s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 10.021158624649049
 quant_reg      : 11.845990913391113
 quant_err      : 11.845990913391113
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.701
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.08396737267789
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.6885
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.73546853157946
 mnt_best       : 33.08396737267789
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 8.33785 (QuantReg: 11.35355) QuantErr: 11.35355 batch_time=35.23021 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 8.66937 (QuantReg: 11.14832) QuantErr: 11.14832 batch_time=0.90819 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 8.97486 (QuantReg: 11.02062) QuantErr: 11.02062 batch_time=0.99545 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 9.08324 (QuantReg: 11.56318) QuantErr: 11.56318 batch_time=0.91705 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 8.19890 (QuantReg: 11.69799) QuantErr: 11.69799 batch_time=0.91260 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 10.53128 (QuantReg: 11.33715) QuantErr: 11.33715 batch_time=1.00389 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 8.83362 (QuantReg: 11.43836) QuantErr: 11.43836 batch_time=0.91980 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 9.30530 (QuantReg: 11.36424) QuantErr: 11.36424 batch_time=1.07547 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 8.98974 (QuantReg: 11.60433) QuantErr: 11.60433 batch_time=0.95317 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 7.47298 (QuantReg: 11.86235) QuantErr: 11.86235 batch_time=0.92475 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 8.75361 (QuantReg: 11.83891) QuantErr: 11.83891 batch_time=0.89723 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 9.62312 (QuantReg: 12.00655) QuantErr: 12.00655 batch_time=1.04381 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 8.65762 (QuantReg: 12.16595) QuantErr: 12.16595 batch_time=0.91905 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 7.88925 (QuantReg: 11.99639) QuantErr: 11.99639 batch_time=0.96546 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 8.61724 (QuantReg: 12.01461) QuantErr: 12.01461 batch_time=0.98742 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 8.20235 (QuantReg: 12.33181) QuantErr: 12.33181 batch_time=1.77863 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 8.03303 (QuantReg: 11.86526) QuantErr: 11.86526 batch_time=0.93650 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 8.54440 (QuantReg: 12.91282) QuantErr: 12.91282 batch_time=1.05449 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 8.45618 (QuantReg: 11.90481) QuantErr: 11.90481 batch_time=1.00377 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 8.47740 (QuantReg: 12.08376) QuantErr: 12.08376 batch_time=1.09401 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 9.54697 (QuantReg: 11.73556) QuantErr: 11.73556 batch_time=1.02689 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 8.43944 (QuantReg: 12.02864) QuantErr: 12.02864 batch_time=0.93305 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 8.02739 (QuantReg: 12.35726) QuantErr: 12.35726 batch_time=1.02819 
Train Epoch: 4 codebook_update_time=7.52439
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch4.pth ...
Done in 3.737s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch4.pth ...
Done in 7.461s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 9.017835218429566
 quant_reg      : 11.804735935211182
 quant_err      : 11.804735935211182
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.669
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.10347608855931
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.3035
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.79696821073893
 mnt_best       : 35.10347608855931
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 9.22158 (QuantReg: 11.42153) QuantErr: 11.42153 batch_time=34.44043 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 8.58214 (QuantReg: 11.65588) QuantErr: 11.65588 batch_time=0.94217 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 7.99061 (QuantReg: 11.39879) QuantErr: 11.39879 batch_time=0.93521 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 7.79143 (QuantReg: 11.61077) QuantErr: 11.61077 batch_time=0.90177 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 8.27966 (QuantReg: 11.37678) QuantErr: 11.37678 batch_time=0.98652 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 7.90541 (QuantReg: 11.63148) QuantErr: 11.63148 batch_time=0.93518 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 7.44440 (QuantReg: 11.81653) QuantErr: 11.81653 batch_time=0.90109 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 8.48808 (QuantReg: 12.11825) QuantErr: 12.11825 batch_time=0.96461 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 8.80060 (QuantReg: 11.57908) QuantErr: 11.57908 batch_time=1.08354 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 8.07593 (QuantReg: 12.08099) QuantErr: 12.08099 batch_time=0.99750 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 7.39989 (QuantReg: 11.76292) QuantErr: 11.76292 batch_time=0.92819 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 7.43649 (QuantReg: 11.87479) QuantErr: 11.87479 batch_time=0.99809 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 7.64015 (QuantReg: 12.22478) QuantErr: 12.22478 batch_time=0.92036 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 10.30635 (QuantReg: 11.68318) QuantErr: 11.68318 batch_time=0.88589 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 7.78902 (QuantReg: 12.06333) QuantErr: 12.06333 batch_time=0.91892 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 7.29179 (QuantReg: 12.08873) QuantErr: 12.08873 batch_time=0.97913 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 8.25657 (QuantReg: 12.16709) QuantErr: 12.16709 batch_time=1.02546 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 10.35471 (QuantReg: 12.09931) QuantErr: 12.09931 batch_time=0.92534 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 9.36801 (QuantReg: 11.98592) QuantErr: 11.98592 batch_time=1.08109 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 6.52090 (QuantReg: 12.27213) QuantErr: 12.27213 batch_time=0.97228 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 8.29219 (QuantReg: 12.21975) QuantErr: 12.21975 batch_time=1.12171 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 8.53941 (QuantReg: 12.42756) QuantErr: 12.42756 batch_time=1.03812 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 8.00555 (QuantReg: 12.50358) QuantErr: 12.50358 batch_time=1.06316 
Train Epoch: 5 codebook_update_time=7.43942
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch5.pth ...
Done in 11.514s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch5.pth ...
Done in 26.626s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 8.239827648162843
 quant_reg      : 11.93704672241211
 quant_err      : 11.93704672241211
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.531
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.46138657495352
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.75
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.006
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.503121019167125
 mnt_best       : 36.46138657495352
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 8.17666 (QuantReg: 11.91494) QuantErr: 11.91494 batch_time=27.12494 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 8.65153 (QuantReg: 11.41498) QuantErr: 11.41498 batch_time=0.92710 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 8.08615 (QuantReg: 11.90158) QuantErr: 11.90158 batch_time=0.90656 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 8.36471 (QuantReg: 11.76171) QuantErr: 11.76171 batch_time=0.90913 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 8.22078 (QuantReg: 12.16668) QuantErr: 12.16668 batch_time=1.21503 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 7.57943 (QuantReg: 11.75274) QuantErr: 11.75274 batch_time=0.92900 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 7.59143 (QuantReg: 12.30954) QuantErr: 12.30954 batch_time=3.12774 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 8.11985 (QuantReg: 12.23140) QuantErr: 12.23140 batch_time=2.29333 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 6.73448 (QuantReg: 11.69144) QuantErr: 11.69144 batch_time=0.92124 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 7.65239 (QuantReg: 11.88413) QuantErr: 11.88413 batch_time=0.93343 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 7.34239 (QuantReg: 11.99796) QuantErr: 11.99796 batch_time=1.00850 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 7.49199 (QuantReg: 12.14928) QuantErr: 12.14928 batch_time=1.03189 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 7.80537 (QuantReg: 12.05897) QuantErr: 12.05897 batch_time=0.90203 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 7.88249 (QuantReg: 11.97816) QuantErr: 11.97816 batch_time=0.95022 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 8.42248 (QuantReg: 11.74190) QuantErr: 11.74190 batch_time=1.02504 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 6.82735 (QuantReg: 12.36847) QuantErr: 12.36847 batch_time=0.99383 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 6.69309 (QuantReg: 12.37868) QuantErr: 12.37868 batch_time=0.92366 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 6.54963 (QuantReg: 12.08106) QuantErr: 12.08106 batch_time=0.98931 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 8.98012 (QuantReg: 11.98508) QuantErr: 11.98508 batch_time=0.99792 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 7.04940 (QuantReg: 12.30404) QuantErr: 12.30404 batch_time=1.05763 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 8.10459 (QuantReg: 12.07385) QuantErr: 12.07385 batch_time=1.20169 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 6.88451 (QuantReg: 12.33691) QuantErr: 12.33691 batch_time=1.18100 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 5.94051 (QuantReg: 12.40258) QuantErr: 12.40258 batch_time=1.31314 
Train Epoch: 6 codebook_update_time=7.97058
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch6.pth ...
Done in 4.269s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch6.pth ...
Done in 8.039s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 7.547654710769653
 quant_reg      : 12.01076031112671
 quant_err      : 12.01076031112671
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.322
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.88231686272776
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.527
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.16453127983747
 mnt_best       : 36.88231686272776
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 8.48895 (QuantReg: 11.51937) QuantErr: 11.51937 batch_time=29.69923 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 7.37632 (QuantReg: 11.90444) QuantErr: 11.90444 batch_time=0.93598 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 7.89413 (QuantReg: 11.84307) QuantErr: 11.84307 batch_time=0.95112 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 6.44785 (QuantReg: 11.48405) QuantErr: 11.48405 batch_time=1.03876 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 9.42924 (QuantReg: 11.83582) QuantErr: 11.83582 batch_time=1.05023 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 7.68100 (QuantReg: 12.16512) QuantErr: 12.16512 batch_time=0.93392 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 6.94985 (QuantReg: 12.40033) QuantErr: 12.40033 batch_time=0.97006 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 7.95409 (QuantReg: 11.86034) QuantErr: 11.86034 batch_time=1.06155 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 7.30388 (QuantReg: 12.08392) QuantErr: 12.08392 batch_time=1.08066 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 7.96718 (QuantReg: 11.90397) QuantErr: 11.90397 batch_time=1.39453 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 8.05359 (QuantReg: 12.22099) QuantErr: 12.22099 batch_time=0.92865 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 6.81834 (QuantReg: 12.14985) QuantErr: 12.14985 batch_time=0.97151 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 7.63637 (QuantReg: 12.09117) QuantErr: 12.09117 batch_time=1.19584 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 7.38614 (QuantReg: 11.99434) QuantErr: 11.99434 batch_time=0.90936 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 5.78378 (QuantReg: 12.31098) QuantErr: 12.31098 batch_time=1.06329 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 6.29795 (QuantReg: 12.62754) QuantErr: 12.62754 batch_time=1.05515 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 6.48530 (QuantReg: 12.46906) QuantErr: 12.46906 batch_time=0.99500 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 7.73289 (QuantReg: 12.59218) QuantErr: 12.59218 batch_time=1.07689 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 6.95243 (QuantReg: 12.51854) QuantErr: 12.51854 batch_time=0.96348 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 7.26615 (QuantReg: 12.36139) QuantErr: 12.36139 batch_time=1.41002 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 7.30516 (QuantReg: 12.39910) QuantErr: 12.39910 batch_time=1.12272 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 6.57745 (QuantReg: 12.20697) QuantErr: 12.20697 batch_time=1.00151 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 7.36373 (QuantReg: 11.80540) QuantErr: 11.80540 batch_time=1.15966 
Train Epoch: 7 codebook_update_time=7.34115
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch7.pth ...
Done in 3.833s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch7.pth ...
Done in 8.018s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 7.113863626480103
 quant_reg      : 12.131113471984863
 quant_err      : 12.131113471984863
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.908
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.953837758490266
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.383
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.885297704246504
 mnt_best       : 37.953837758490266
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 6.41432 (QuantReg: 11.69509) QuantErr: 11.69509 batch_time=30.38549 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 7.10320 (QuantReg: 12.24871) QuantErr: 12.24871 batch_time=0.90819 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 7.09839 (QuantReg: 12.23728) QuantErr: 12.23728 batch_time=0.90330 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 6.34128 (QuantReg: 12.08358) QuantErr: 12.08358 batch_time=1.71839 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 5.61586 (QuantReg: 11.84954) QuantErr: 11.84954 batch_time=1.00358 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 6.70553 (QuantReg: 12.43398) QuantErr: 12.43398 batch_time=0.93559 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 7.22322 (QuantReg: 12.29445) QuantErr: 12.29445 batch_time=0.96017 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 7.09875 (QuantReg: 12.28846) QuantErr: 12.28846 batch_time=0.91366 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 6.62183 (QuantReg: 12.02832) QuantErr: 12.02832 batch_time=1.10359 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 5.15735 (QuantReg: 12.04876) QuantErr: 12.04876 batch_time=1.04629 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 6.31785 (QuantReg: 11.77727) QuantErr: 11.77727 batch_time=1.07045 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 7.48994 (QuantReg: 11.89030) QuantErr: 11.89030 batch_time=0.95713 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 6.17583 (QuantReg: 12.10913) QuantErr: 12.10913 batch_time=1.08092 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 7.28262 (QuantReg: 12.06775) QuantErr: 12.06775 batch_time=0.94872 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 6.23295 (QuantReg: 12.16010) QuantErr: 12.16010 batch_time=1.54345 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 7.22641 (QuantReg: 12.22238) QuantErr: 12.22238 batch_time=1.14010 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 5.75925 (QuantReg: 12.51381) QuantErr: 12.51381 batch_time=1.01661 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 7.54344 (QuantReg: 12.20480) QuantErr: 12.20480 batch_time=0.97614 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 7.43318 (QuantReg: 12.56181) QuantErr: 12.56181 batch_time=1.00886 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 6.33734 (QuantReg: 12.40749) QuantErr: 12.40749 batch_time=1.12113 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 7.07535 (QuantReg: 12.41529) QuantErr: 12.41529 batch_time=0.95434 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 6.46835 (QuantReg: 12.61271) QuantErr: 12.61271 batch_time=1.05415 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 6.77307 (QuantReg: 12.15791) QuantErr: 12.15791 batch_time=1.13828 
Train Epoch: 8 codebook_update_time=8.25736
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch8.pth ...
Done in 4.047s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch8.pth ...
Done in 10.035s
removing stale ckpt [epoch 7] [took 0.03s]
 epoch          : 8
 loss           : 6.690860202789307
 quant_reg      : 12.189224243164062
 quant_err      : 12.189224243164062
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.027
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.85788910712561
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.468
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.9428350096816
 mnt_best       : 38.85788910712561
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 7.14910 (QuantReg: 11.59703) QuantErr: 11.59703 batch_time=29.55181 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 5.23460 (QuantReg: 12.16928) QuantErr: 12.16928 batch_time=0.93048 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 6.90129 (QuantReg: 12.04012) QuantErr: 12.04012 batch_time=0.94399 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 7.92804 (QuantReg: 11.64655) QuantErr: 11.64655 batch_time=1.46300 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 5.12842 (QuantReg: 11.84109) QuantErr: 11.84109 batch_time=0.93826 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 6.76341 (QuantReg: 12.21298) QuantErr: 12.21298 batch_time=0.92406 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 6.30157 (QuantReg: 12.14713) QuantErr: 12.14713 batch_time=0.91918 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 6.47254 (QuantReg: 11.88835) QuantErr: 11.88835 batch_time=0.91026 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 6.88298 (QuantReg: 12.25117) QuantErr: 12.25117 batch_time=0.96648 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 6.55942 (QuantReg: 12.17188) QuantErr: 12.17188 batch_time=1.07633 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 7.12662 (QuantReg: 12.32297) QuantErr: 12.32297 batch_time=0.94582 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 6.11418 (QuantReg: 12.18241) QuantErr: 12.18241 batch_time=1.06500 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 6.55718 (QuantReg: 12.00848) QuantErr: 12.00848 batch_time=0.90624 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 6.52577 (QuantReg: 12.53968) QuantErr: 12.53968 batch_time=0.92025 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 6.58682 (QuantReg: 12.38054) QuantErr: 12.38054 batch_time=0.94259 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 5.87319 (QuantReg: 12.46218) QuantErr: 12.46218 batch_time=0.92593 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 5.82963 (QuantReg: 12.76253) QuantErr: 12.76253 batch_time=0.92317 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 6.06493 (QuantReg: 12.03833) QuantErr: 12.03833 batch_time=1.15599 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 5.85999 (QuantReg: 12.42848) QuantErr: 12.42848 batch_time=0.96139 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 6.65382 (QuantReg: 12.51868) QuantErr: 12.51868 batch_time=1.80233 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 6.59486 (QuantReg: 12.79606) QuantErr: 12.79606 batch_time=0.96475 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 6.30577 (QuantReg: 12.67943) QuantErr: 12.67943 batch_time=0.91039 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 6.17443 (QuantReg: 12.23636) QuantErr: 12.23636 batch_time=1.04583 
Train Epoch: 9 codebook_update_time=8.05266
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch9.pth ...
Done in 4.914s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch9.pth ...
Done in 9.530s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 6.257290893554687
 quant_reg      : 12.268948093414307
 quant_err      : 12.268948093414307
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.177
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.36689911451742
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.6935
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.532045698882804
 mnt_best       : 39.36689911451742
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 5.84402 (QuantReg: 12.12847) QuantErr: 12.12847 batch_time=35.48949 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 5.62168 (QuantReg: 12.34149) QuantErr: 12.34149 batch_time=0.89203 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 6.39787 (QuantReg: 12.27483) QuantErr: 12.27483 batch_time=0.98425 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 6.27447 (QuantReg: 11.81720) QuantErr: 11.81720 batch_time=0.90150 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 5.35615 (QuantReg: 12.03295) QuantErr: 12.03295 batch_time=0.97227 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 6.89126 (QuantReg: 12.42489) QuantErr: 12.42489 batch_time=0.94835 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 5.85166 (QuantReg: 12.20419) QuantErr: 12.20419 batch_time=0.95519 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 5.58666 (QuantReg: 12.19190) QuantErr: 12.19190 batch_time=1.05072 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 5.70173 (QuantReg: 12.44352) QuantErr: 12.44352 batch_time=0.90295 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 8.35999 (QuantReg: 12.40791) QuantErr: 12.40791 batch_time=0.94859 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 6.90363 (QuantReg: 12.05187) QuantErr: 12.05187 batch_time=0.91304 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 5.70661 (QuantReg: 11.99230) QuantErr: 11.99230 batch_time=0.97803 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 7.10211 (QuantReg: 12.17511) QuantErr: 12.17511 batch_time=1.14004 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 6.76533 (QuantReg: 12.21097) QuantErr: 12.21097 batch_time=2.18834 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 6.64756 (QuantReg: 12.37872) QuantErr: 12.37872 batch_time=0.90778 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 6.50409 (QuantReg: 12.35318) QuantErr: 12.35318 batch_time=0.95673 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 5.89025 (QuantReg: 12.36266) QuantErr: 12.36266 batch_time=0.95328 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 6.48579 (QuantReg: 12.15399) QuantErr: 12.15399 batch_time=1.06218 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 6.57148 (QuantReg: 12.27868) QuantErr: 12.27868 batch_time=0.96723 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 5.71843 (QuantReg: 12.74081) QuantErr: 12.74081 batch_time=1.00230 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 6.80639 (QuantReg: 12.30921) QuantErr: 12.30921 batch_time=1.74305 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 7.17360 (QuantReg: 11.98293) QuantErr: 11.98293 batch_time=1.19528 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 5.04670 (QuantReg: 12.53939) QuantErr: 12.53939 batch_time=1.21244 
Train Epoch: 10 codebook_update_time=8.16343
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch10.pth ...
Done in 5.079s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch10.pth ...
Done in 10.208s
removing stale ckpt [epoch 9] [took 0.07s]
 epoch          : 10
 loss           : 6.01626043510437
 quant_reg      : 12.31114507293701
 quant_err      : 12.31114507293701
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.891
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.59814295954342
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.676
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.05562053970779
 mnt_best       : 39.59814295954342
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 5.80107 (QuantReg: 12.20724) QuantErr: 12.20724 batch_time=26.80875 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 6.57766 (QuantReg: 12.09975) QuantErr: 12.09975 batch_time=0.98844 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 6.84067 (QuantReg: 12.34076) QuantErr: 12.34076 batch_time=0.91009 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 5.98382 (QuantReg: 12.52073) QuantErr: 12.52073 batch_time=0.91316 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 5.56190 (QuantReg: 12.15871) QuantErr: 12.15871 batch_time=0.91106 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 6.04195 (QuantReg: 12.35335) QuantErr: 12.35335 batch_time=0.96597 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 5.60648 (QuantReg: 12.83893) QuantErr: 12.83893 batch_time=3.29065 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 5.48284 (QuantReg: 12.15624) QuantErr: 12.15624 batch_time=1.00978 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 5.07867 (QuantReg: 12.56170) QuantErr: 12.56170 batch_time=0.91906 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 5.43068 (QuantReg: 12.44787) QuantErr: 12.44787 batch_time=0.95018 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 6.35623 (QuantReg: 12.42851) QuantErr: 12.42851 batch_time=0.91465 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 6.24707 (QuantReg: 12.33964) QuantErr: 12.33964 batch_time=0.92937 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 6.33618 (QuantReg: 12.12516) QuantErr: 12.12516 batch_time=0.90249 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 5.55167 (QuantReg: 12.82127) QuantErr: 12.82127 batch_time=6.02549 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 4.43285 (QuantReg: 12.71914) QuantErr: 12.71914 batch_time=0.99313 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 5.12720 (QuantReg: 12.59423) QuantErr: 12.59423 batch_time=0.96292 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 5.91594 (QuantReg: 12.37014) QuantErr: 12.37014 batch_time=0.98037 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 5.55114 (QuantReg: 12.51161) QuantErr: 12.51161 batch_time=0.88859 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 7.42899 (QuantReg: 12.40521) QuantErr: 12.40521 batch_time=0.96299 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 3.98865 (QuantReg: 12.25915) QuantErr: 12.25915 batch_time=1.13666 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 5.24488 (QuantReg: 12.52248) QuantErr: 12.52248 batch_time=0.95575 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 5.62450 (QuantReg: 12.69919) QuantErr: 12.69919 batch_time=0.96372 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 6.72807 (QuantReg: 12.22840) QuantErr: 12.22840 batch_time=0.97499 
Train Epoch: 11 codebook_update_time=7.79724
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch11.pth ...
Done in 5.007s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch11.pth ...
Done in 10.382s
removing stale ckpt [epoch 10] [took 0.02s]
 epoch          : 11
 loss           : 5.7063061113357545
 quant_reg      : 12.392695747375488
 quant_err      : 12.392695747375488
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.157
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.76398205380343
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3155
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.180263585608856
 mnt_best       : 40.76398205380343
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 5.67519 (QuantReg: 12.34134) QuantErr: 12.34134 batch_time=28.22425 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 5.92739 (QuantReg: 12.14830) QuantErr: 12.14830 batch_time=1.10268 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 6.33580 (QuantReg: 12.48585) QuantErr: 12.48585 batch_time=1.05294 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 5.84091 (QuantReg: 12.19869) QuantErr: 12.19869 batch_time=0.96614 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 4.85371 (QuantReg: 12.36919) QuantErr: 12.36919 batch_time=1.00119 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 4.90984 (QuantReg: 12.33763) QuantErr: 12.33763 batch_time=0.96121 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 5.05103 (QuantReg: 12.49275) QuantErr: 12.49275 batch_time=1.04434 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 4.96498 (QuantReg: 12.70373) QuantErr: 12.70373 batch_time=0.91731 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 5.75939 (QuantReg: 12.26521) QuantErr: 12.26521 batch_time=0.93911 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 7.01282 (QuantReg: 12.35601) QuantErr: 12.35601 batch_time=0.92567 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 6.01044 (QuantReg: 12.41616) QuantErr: 12.41616 batch_time=0.97140 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 4.88792 (QuantReg: 12.49844) QuantErr: 12.49844 batch_time=0.93619 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 4.83667 (QuantReg: 12.80782) QuantErr: 12.80782 batch_time=2.54245 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 5.36068 (QuantReg: 12.49973) QuantErr: 12.49973 batch_time=4.82695 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 6.37823 (QuantReg: 12.41814) QuantErr: 12.41814 batch_time=0.95449 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 4.48098 (QuantReg: 12.62485) QuantErr: 12.62485 batch_time=0.99235 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 6.05470 (QuantReg: 12.85495) QuantErr: 12.85495 batch_time=0.97087 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 5.78635 (QuantReg: 12.65171) QuantErr: 12.65171 batch_time=0.93078 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 5.25459 (QuantReg: 12.46487) QuantErr: 12.46487 batch_time=0.96831 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 5.30220 (QuantReg: 12.18705) QuantErr: 12.18705 batch_time=0.98066 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 6.12178 (QuantReg: 12.39992) QuantErr: 12.39992 batch_time=1.06051 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 4.94881 (QuantReg: 12.72706) QuantErr: 12.72706 batch_time=1.12947 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 5.81857 (QuantReg: 12.82779) QuantErr: 12.82779 batch_time=1.05608 
Train Epoch: 12 codebook_update_time=7.99697
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch12.pth ...
Done in 4.907s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch12.pth ...
Done in 10.198s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 5.480696293830872
 quant_reg      : 12.478915390014649
 quant_err      : 12.478915390014649
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.878
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.22617025846929
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1555
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.85192755860147
 mnt_best       : 41.22617025846929
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 4.64774 (QuantReg: 12.31171) QuantErr: 12.31171 batch_time=28.78817 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 6.15952 (QuantReg: 12.36440) QuantErr: 12.36440 batch_time=0.91212 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 5.60586 (QuantReg: 12.32911) QuantErr: 12.32911 batch_time=0.93250 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 5.62928 (QuantReg: 12.20570) QuantErr: 12.20570 batch_time=0.96188 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 6.73336 (QuantReg: 12.02742) QuantErr: 12.02742 batch_time=1.00712 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 4.33454 (QuantReg: 12.71368) QuantErr: 12.71368 batch_time=0.92658 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 5.54450 (QuantReg: 11.91213) QuantErr: 11.91213 batch_time=1.21842 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 5.21436 (QuantReg: 12.13471) QuantErr: 12.13471 batch_time=0.92400 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 5.93322 (QuantReg: 12.29018) QuantErr: 12.29018 batch_time=0.90081 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 6.01535 (QuantReg: 12.07633) QuantErr: 12.07633 batch_time=0.92383 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 5.07092 (QuantReg: 12.46831) QuantErr: 12.46831 batch_time=0.89117 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 5.56783 (QuantReg: 12.73764) QuantErr: 12.73764 batch_time=0.92166 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 6.57917 (QuantReg: 12.31355) QuantErr: 12.31355 batch_time=0.90579 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 5.77894 (QuantReg: 12.28590) QuantErr: 12.28590 batch_time=0.91800 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 4.85973 (QuantReg: 12.48315) QuantErr: 12.48315 batch_time=0.90605 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 5.22497 (QuantReg: 12.58038) QuantErr: 12.58038 batch_time=0.96542 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 5.20830 (QuantReg: 12.39988) QuantErr: 12.39988 batch_time=1.16735 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 4.58949 (QuantReg: 12.78255) QuantErr: 12.78255 batch_time=1.04090 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 6.09244 (QuantReg: 12.46771) QuantErr: 12.46771 batch_time=0.95736 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 5.33509 (QuantReg: 12.56738) QuantErr: 12.56738 batch_time=1.03881 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 5.11963 (QuantReg: 12.63902) QuantErr: 12.63902 batch_time=0.93305 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 5.30067 (QuantReg: 12.31384) QuantErr: 12.31384 batch_time=0.93312 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 5.05392 (QuantReg: 12.24374) QuantErr: 12.24374 batch_time=1.04466 
Train Epoch: 13 codebook_update_time=7.54448
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch13.pth ...
Done in 4.310s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch13.pth ...
Done in 9.257s
removing stale ckpt [epoch 12] [took 0.04s]
 epoch          : 13
 loss           : 5.299593955993652
 quant_reg      : 12.43711763381958
 quant_err      : 12.43711763381958
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.58
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.65601178937618
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.981
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.67910628358642
 mnt_best       : 41.65601178937618
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 4.36849 (QuantReg: 12.44402) QuantErr: 12.44402 batch_time=30.09784 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 5.13260 (QuantReg: 12.23795) QuantErr: 12.23795 batch_time=0.89997 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 5.44059 (QuantReg: 12.48708) QuantErr: 12.48708 batch_time=0.90829 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 4.56893 (QuantReg: 12.60854) QuantErr: 12.60854 batch_time=0.93406 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 5.67000 (QuantReg: 12.27391) QuantErr: 12.27391 batch_time=0.95374 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 5.78825 (QuantReg: 12.25562) QuantErr: 12.25562 batch_time=0.95793 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 6.31358 (QuantReg: 12.41081) QuantErr: 12.41081 batch_time=0.98586 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 4.20808 (QuantReg: 12.54713) QuantErr: 12.54713 batch_time=0.93551 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 6.14180 (QuantReg: 12.28298) QuantErr: 12.28298 batch_time=1.06404 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 5.33063 (QuantReg: 12.57296) QuantErr: 12.57296 batch_time=0.92878 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 4.39136 (QuantReg: 12.49556) QuantErr: 12.49556 batch_time=0.90043 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 4.99062 (QuantReg: 12.53273) QuantErr: 12.53273 batch_time=0.91475 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 4.86525 (QuantReg: 12.62713) QuantErr: 12.62713 batch_time=0.89576 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 5.47418 (QuantReg: 12.12033) QuantErr: 12.12033 batch_time=1.40902 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 5.21623 (QuantReg: 12.57976) QuantErr: 12.57976 batch_time=0.91211 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 6.26264 (QuantReg: 12.43276) QuantErr: 12.43276 batch_time=0.93975 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 4.27640 (QuantReg: 12.74977) QuantErr: 12.74977 batch_time=0.95357 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 5.08075 (QuantReg: 12.77315) QuantErr: 12.77315 batch_time=0.93882 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 4.07978 (QuantReg: 12.50399) QuantErr: 12.50399 batch_time=1.89799 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 6.65376 (QuantReg: 12.52885) QuantErr: 12.52885 batch_time=3.32612 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 4.68737 (QuantReg: 12.45402) QuantErr: 12.45402 batch_time=1.06577 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 5.83468 (QuantReg: 12.64823) QuantErr: 12.64823 batch_time=1.03965 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 7.13540 (QuantReg: 12.59863) QuantErr: 12.59863 batch_time=0.96920 
Train Epoch: 14 codebook_update_time=8.16268
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch14.pth ...
Done in 4.508s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch14.pth ...
Done in 9.433s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 5.1926002111434935
 quant_reg      : 12.531077583312989
 quant_err      : 12.531077583312989
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.488
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.66131533052406
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5005
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.140195023501256
 mnt_best       : 41.66131533052406
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 5.02535 (QuantReg: 12.21950) QuantErr: 12.21950 batch_time=32.05150 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 5.77758 (QuantReg: 12.47419) QuantErr: 12.47419 batch_time=0.92048 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 3.63670 (QuantReg: 12.92006) QuantErr: 12.92006 batch_time=0.90281 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 4.39463 (QuantReg: 12.22848) QuantErr: 12.22848 batch_time=1.13100 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 5.42169 (QuantReg: 12.48432) QuantErr: 12.48432 batch_time=0.94261 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 4.63011 (QuantReg: 12.50243) QuantErr: 12.50243 batch_time=0.94148 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 6.76070 (QuantReg: 12.88929) QuantErr: 12.88929 batch_time=1.53801 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 4.55496 (QuantReg: 12.80331) QuantErr: 12.80331 batch_time=0.96448 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 5.17812 (QuantReg: 12.22725) QuantErr: 12.22725 batch_time=1.03425 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 5.21073 (QuantReg: 12.68780) QuantErr: 12.68780 batch_time=0.92484 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 5.32046 (QuantReg: 12.47110) QuantErr: 12.47110 batch_time=0.96982 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 6.02831 (QuantReg: 12.78886) QuantErr: 12.78886 batch_time=1.04562 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 5.13874 (QuantReg: 12.58686) QuantErr: 12.58686 batch_time=2.99403 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 5.88022 (QuantReg: 12.38744) QuantErr: 12.38744 batch_time=0.90846 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 6.01669 (QuantReg: 12.63366) QuantErr: 12.63366 batch_time=0.95750 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 4.22392 (QuantReg: 12.13203) QuantErr: 12.13203 batch_time=0.95189 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 5.83346 (QuantReg: 12.26209) QuantErr: 12.26209 batch_time=0.92698 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 5.10558 (QuantReg: 12.79511) QuantErr: 12.79511 batch_time=0.96527 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 5.64138 (QuantReg: 12.37844) QuantErr: 12.37844 batch_time=0.93118 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 6.19367 (QuantReg: 12.68220) QuantErr: 12.68220 batch_time=0.97436 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 5.05901 (QuantReg: 12.76260) QuantErr: 12.76260 batch_time=1.03745 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 4.79343 (QuantReg: 12.38033) QuantErr: 12.38033 batch_time=1.01396 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 5.83931 (QuantReg: 12.33023) QuantErr: 12.33023 batch_time=1.40932 
Train Epoch: 15 codebook_update_time=8.11101
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch15.pth ...
Done in 12.933s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch15.pth ...
Done in 28.805s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 5.072844372749328
 quant_reg      : 12.551437675476075
 quant_err      : 12.551437675476075
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.166
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.90693680089957
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.288
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.85054286120769
 mnt_best       : 41.90693680089957
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 5.00583 (QuantReg: 12.26865) QuantErr: 12.26865 batch_time=29.52793 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 4.90659 (QuantReg: 12.69276) QuantErr: 12.69276 batch_time=0.92451 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 5.33241 (QuantReg: 12.46820) QuantErr: 12.46820 batch_time=0.93070 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 5.37750 (QuantReg: 12.44134) QuantErr: 12.44134 batch_time=0.93284 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 4.36388 (QuantReg: 12.45918) QuantErr: 12.45918 batch_time=1.02987 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 5.68187 (QuantReg: 12.41495) QuantErr: 12.41495 batch_time=0.89336 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 4.88490 (QuantReg: 12.56320) QuantErr: 12.56320 batch_time=3.24097 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 6.25846 (QuantReg: 12.39051) QuantErr: 12.39051 batch_time=0.93107 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 4.08241 (QuantReg: 12.55400) QuantErr: 12.55400 batch_time=0.95414 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 4.06927 (QuantReg: 12.45288) QuantErr: 12.45288 batch_time=0.92779 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 4.26819 (QuantReg: 12.60897) QuantErr: 12.60897 batch_time=0.92763 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 5.62388 (QuantReg: 12.56394) QuantErr: 12.56394 batch_time=0.92658 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 4.75392 (QuantReg: 12.39842) QuantErr: 12.39842 batch_time=0.95369 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 4.52142 (QuantReg: 12.35541) QuantErr: 12.35541 batch_time=3.36222 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 4.74821 (QuantReg: 12.71277) QuantErr: 12.71277 batch_time=0.91394 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 5.09080 (QuantReg: 12.30803) QuantErr: 12.30803 batch_time=1.31149 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 5.16471 (QuantReg: 12.66429) QuantErr: 12.66429 batch_time=0.90742 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 5.10919 (QuantReg: 12.74024) QuantErr: 12.74024 batch_time=0.92268 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 3.23033 (QuantReg: 12.46298) QuantErr: 12.46298 batch_time=0.94351 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 4.57399 (QuantReg: 12.60537) QuantErr: 12.60537 batch_time=0.95124 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 5.48557 (QuantReg: 12.32385) QuantErr: 12.32385 batch_time=0.92172 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 5.61222 (QuantReg: 12.78159) QuantErr: 12.78159 batch_time=1.05744 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 3.89466 (QuantReg: 12.95083) QuantErr: 12.95083 batch_time=1.08065 
Train Epoch: 16 codebook_update_time=7.48383
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch16.pth ...
Done in 6.398s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch16.pth ...
Done in 11.065s
removing stale ckpt [epoch 15] [took 0.11s]
 epoch          : 16
 loss           : 4.798682402610779
 quant_reg      : 12.548522205352784
 quant_err      : 12.548522205352784
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.91
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.6977053066136
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.479
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.29651397256349
 mnt_best       : 42.6977053066136
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 3.55123 (QuantReg: 12.46644) QuantErr: 12.46644 batch_time=34.63673 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 3.67390 (QuantReg: 12.81275) QuantErr: 12.81275 batch_time=0.93391 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 4.07139 (QuantReg: 12.56474) QuantErr: 12.56474 batch_time=0.92509 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 4.31028 (QuantReg: 12.74636) QuantErr: 12.74636 batch_time=0.91384 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 4.27723 (QuantReg: 12.41350) QuantErr: 12.41350 batch_time=0.92404 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 4.86805 (QuantReg: 12.52683) QuantErr: 12.52683 batch_time=0.91916 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 4.83726 (QuantReg: 12.21334) QuantErr: 12.21334 batch_time=0.91216 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 4.83089 (QuantReg: 12.69393) QuantErr: 12.69393 batch_time=1.01434 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 4.74836 (QuantReg: 12.50063) QuantErr: 12.50063 batch_time=0.97937 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 6.52468 (QuantReg: 12.41227) QuantErr: 12.41227 batch_time=0.91936 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 4.96878 (QuantReg: 12.76955) QuantErr: 12.76955 batch_time=0.91435 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 4.76446 (QuantReg: 12.41378) QuantErr: 12.41378 batch_time=0.90815 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 4.57992 (QuantReg: 12.58714) QuantErr: 12.58714 batch_time=0.98339 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 4.75187 (QuantReg: 12.57065) QuantErr: 12.57065 batch_time=1.04424 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 3.91299 (QuantReg: 12.79752) QuantErr: 12.79752 batch_time=0.92661 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 4.89452 (QuantReg: 12.72094) QuantErr: 12.72094 batch_time=0.97674 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 4.29031 (QuantReg: 12.54585) QuantErr: 12.54585 batch_time=0.94662 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 4.65297 (QuantReg: 12.56357) QuantErr: 12.56357 batch_time=0.95912 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 3.57231 (QuantReg: 12.99846) QuantErr: 12.99846 batch_time=0.92874 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 4.02393 (QuantReg: 12.79629) QuantErr: 12.79629 batch_time=3.80325 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 5.10728 (QuantReg: 12.60134) QuantErr: 12.60134 batch_time=0.97828 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 4.89863 (QuantReg: 13.10923) QuantErr: 13.10923 batch_time=1.04271 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 4.21154 (QuantReg: 12.68439) QuantErr: 12.68439 batch_time=1.01696 
Train Epoch: 17 codebook_update_time=8.09980
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch17.pth ...
Done in 5.701s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch17.pth ...
Done in 10.697s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 4.693273175239563
 quant_reg      : 12.6377329788208
 quant_err      : 12.6377329788208
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.312
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.37824374803496
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7905
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.48088792338978
 mnt_best       : 43.37824374803496
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 4.20805 (QuantReg: 12.62279) QuantErr: 12.62279 batch_time=29.81159 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 4.87069 (QuantReg: 12.47697) QuantErr: 12.47697 batch_time=0.93092 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 4.31129 (QuantReg: 12.46980) QuantErr: 12.46980 batch_time=1.00086 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 5.78816 (QuantReg: 12.65169) QuantErr: 12.65169 batch_time=0.92018 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 4.38357 (QuantReg: 12.32058) QuantErr: 12.32058 batch_time=0.88568 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 4.38094 (QuantReg: 13.08155) QuantErr: 13.08155 batch_time=0.97281 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 5.92697 (QuantReg: 12.65125) QuantErr: 12.65125 batch_time=0.90377 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 5.22621 (QuantReg: 12.53559) QuantErr: 12.53559 batch_time=0.92143 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 5.27836 (QuantReg: 12.59892) QuantErr: 12.59892 batch_time=0.97769 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 5.04099 (QuantReg: 12.71879) QuantErr: 12.71879 batch_time=0.94296 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 4.78003 (QuantReg: 12.97723) QuantErr: 12.97723 batch_time=1.11401 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 3.79664 (QuantReg: 12.90137) QuantErr: 12.90137 batch_time=0.93833 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 3.63822 (QuantReg: 12.62925) QuantErr: 12.62925 batch_time=1.48875 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 4.81321 (QuantReg: 12.90918) QuantErr: 12.90918 batch_time=0.91371 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 4.81461 (QuantReg: 12.93146) QuantErr: 12.93146 batch_time=1.01948 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 5.02519 (QuantReg: 12.52938) QuantErr: 12.52938 batch_time=0.99907 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 3.94891 (QuantReg: 12.79066) QuantErr: 12.79066 batch_time=0.99928 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 4.69619 (QuantReg: 12.58621) QuantErr: 12.58621 batch_time=0.93858 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 5.88967 (QuantReg: 12.50097) QuantErr: 12.50097 batch_time=1.09120 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 5.19370 (QuantReg: 12.46911) QuantErr: 12.46911 batch_time=0.96686 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 4.37665 (QuantReg: 13.05015) QuantErr: 13.05015 batch_time=0.97311 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 3.81732 (QuantReg: 13.05424) QuantErr: 13.05424 batch_time=0.91428 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 4.55533 (QuantReg: 12.71132) QuantErr: 12.71132 batch_time=1.02640 
Train Epoch: 18 codebook_update_time=7.61721
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch18.pth ...
Done in 4.157s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 4.58987645149231
 quant_reg      : 12.704057807922362
 quant_err      : 12.704057807922362
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.474
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.32724010314757
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.0565
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.182210932783036
 mnt_best       : 43.37824374803496
 not_improved_count: 1
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 4.66761 (QuantReg: 12.31478) QuantErr: 12.31478 batch_time=32.16276 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 4.12198 (QuantReg: 12.46523) QuantErr: 12.46523 batch_time=0.90363 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 4.53864 (QuantReg: 12.78951) QuantErr: 12.78951 batch_time=0.93182 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 4.38225 (QuantReg: 12.29114) QuantErr: 12.29114 batch_time=0.90618 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 4.47328 (QuantReg: 12.77241) QuantErr: 12.77241 batch_time=0.92991 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 5.38002 (QuantReg: 12.72467) QuantErr: 12.72467 batch_time=0.92040 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 4.60655 (QuantReg: 13.16564) QuantErr: 13.16564 batch_time=0.92575 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 4.95188 (QuantReg: 12.74011) QuantErr: 12.74011 batch_time=1.01916 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 4.28876 (QuantReg: 12.69079) QuantErr: 12.69079 batch_time=1.13678 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 4.22324 (QuantReg: 12.65416) QuantErr: 12.65416 batch_time=0.95064 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 5.32343 (QuantReg: 12.60724) QuantErr: 12.60724 batch_time=0.99594 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 5.11610 (QuantReg: 12.66482) QuantErr: 12.66482 batch_time=0.94133 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 4.93546 (QuantReg: 12.64615) QuantErr: 12.64615 batch_time=3.10821 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 4.94893 (QuantReg: 12.91899) QuantErr: 12.91899 batch_time=1.80322 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 5.14031 (QuantReg: 12.49503) QuantErr: 12.49503 batch_time=0.91605 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 4.28074 (QuantReg: 12.96413) QuantErr: 12.96413 batch_time=1.03727 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 4.68037 (QuantReg: 12.54290) QuantErr: 12.54290 batch_time=0.96215 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 3.86674 (QuantReg: 12.73893) QuantErr: 12.73893 batch_time=1.01558 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 4.10606 (QuantReg: 12.83650) QuantErr: 12.83650 batch_time=0.92697 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 4.11771 (QuantReg: 12.82211) QuantErr: 12.82211 batch_time=0.95465 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 5.18290 (QuantReg: 12.89425) QuantErr: 12.89425 batch_time=0.94951 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 4.50801 (QuantReg: 13.04972) QuantErr: 13.04972 batch_time=1.05797 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 3.91433 (QuantReg: 12.84581) QuantErr: 12.84581 batch_time=1.08162 
Train Epoch: 19 codebook_update_time=7.66636
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch19.pth ...
Done in 6.172s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 4.4823583965301514
 quant_reg      : 12.728129306793212
 quant_err      : 12.728129306793212
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.063
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.830737884019996
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.278
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.26887967307213
 mnt_best       : 43.37824374803496
 not_improved_count: 2
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 3.83625 (QuantReg: 12.68350) QuantErr: 12.68350 batch_time=35.69571 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 4.36928 (QuantReg: 12.72152) QuantErr: 12.72152 batch_time=0.91121 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 4.57508 (QuantReg: 12.67711) QuantErr: 12.67711 batch_time=1.03631 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 3.60345 (QuantReg: 12.42831) QuantErr: 12.42831 batch_time=0.94447 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 4.23922 (QuantReg: 12.74601) QuantErr: 12.74601 batch_time=1.06879 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 4.70601 (QuantReg: 12.52461) QuantErr: 12.52461 batch_time=1.20983 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 3.88272 (QuantReg: 12.72289) QuantErr: 12.72289 batch_time=0.99145 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 3.95769 (QuantReg: 12.86036) QuantErr: 12.86036 batch_time=0.95853 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 6.13488 (QuantReg: 12.34604) QuantErr: 12.34604 batch_time=0.95938 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 3.57818 (QuantReg: 12.51802) QuantErr: 12.51802 batch_time=0.93780 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 4.07797 (QuantReg: 12.55104) QuantErr: 12.55104 batch_time=0.94594 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 4.81301 (QuantReg: 12.56343) QuantErr: 12.56343 batch_time=0.97540 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 3.93409 (QuantReg: 12.82439) QuantErr: 12.82439 batch_time=0.92214 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 4.53808 (QuantReg: 12.67381) QuantErr: 12.67381 batch_time=0.91961 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 3.50273 (QuantReg: 12.64966) QuantErr: 12.64966 batch_time=0.95596 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 4.31009 (QuantReg: 12.88344) QuantErr: 12.88344 batch_time=1.11328 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 3.96138 (QuantReg: 12.73851) QuantErr: 12.73851 batch_time=0.91059 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 2.60612 (QuantReg: 13.05934) QuantErr: 13.05934 batch_time=1.03504 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 3.27937 (QuantReg: 12.44869) QuantErr: 12.44869 batch_time=1.07333 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 4.25017 (QuantReg: 13.15620) QuantErr: 13.15620 batch_time=1.11775 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 4.51462 (QuantReg: 12.75320) QuantErr: 12.75320 batch_time=1.03652 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 4.01202 (QuantReg: 12.58718) QuantErr: 12.58718 batch_time=1.29902 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 3.22532 (QuantReg: 13.03730) QuantErr: 13.03730 batch_time=0.99521 
Train Epoch: 20 codebook_update_time=8.99126
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch20.pth ...
Done in 4.716s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch20.pth ...
Done in 9.691s
removing stale ckpt [epoch 19] [took 0.27s]
 epoch          : 20
 loss           : 4.345163557052612
 quant_reg      : 12.719438537597656
 quant_err      : 12.719438537597656
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.905
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.8032025416993
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.963
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.37726002613919
 mnt_best       : 43.8032025416993
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 3.94960 (QuantReg: 12.50393) QuantErr: 12.50393 batch_time=34.79011 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 4.72154 (QuantReg: 12.42918) QuantErr: 12.42918 batch_time=0.92010 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 4.47953 (QuantReg: 12.55218) QuantErr: 12.55218 batch_time=1.03297 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 3.80530 (QuantReg: 12.62100) QuantErr: 12.62100 batch_time=1.00396 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 4.36493 (QuantReg: 13.06109) QuantErr: 13.06109 batch_time=1.38751 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 4.76557 (QuantReg: 12.41208) QuantErr: 12.41208 batch_time=0.92102 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 4.71694 (QuantReg: 12.69684) QuantErr: 12.69684 batch_time=0.91996 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 3.92083 (QuantReg: 12.69282) QuantErr: 12.69282 batch_time=0.91782 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 4.68992 (QuantReg: 12.49649) QuantErr: 12.49649 batch_time=0.99797 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 3.95676 (QuantReg: 12.92625) QuantErr: 12.92625 batch_time=0.94592 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 4.55148 (QuantReg: 12.69760) QuantErr: 12.69760 batch_time=0.96932 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 4.92091 (QuantReg: 12.55870) QuantErr: 12.55870 batch_time=0.91175 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 4.09514 (QuantReg: 12.75703) QuantErr: 12.75703 batch_time=0.93046 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 3.96202 (QuantReg: 12.66916) QuantErr: 12.66916 batch_time=2.08449 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 3.63392 (QuantReg: 12.71120) QuantErr: 12.71120 batch_time=0.87869 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 5.13995 (QuantReg: 12.64714) QuantErr: 12.64714 batch_time=1.02102 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 4.22676 (QuantReg: 12.59443) QuantErr: 12.59443 batch_time=1.19510 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 4.49241 (QuantReg: 13.03849) QuantErr: 13.03849 batch_time=1.12282 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 4.17243 (QuantReg: 12.77580) QuantErr: 12.77580 batch_time=1.39470 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 4.49153 (QuantReg: 12.79314) QuantErr: 12.79314 batch_time=0.98062 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 3.69062 (QuantReg: 12.75232) QuantErr: 12.75232 batch_time=0.98164 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 4.30204 (QuantReg: 13.06107) QuantErr: 13.06107 batch_time=0.90968 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 4.28470 (QuantReg: 12.81475) QuantErr: 12.81475 batch_time=1.02055 
Train Epoch: 21 codebook_update_time=8.46863
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch21.pth ...
Done in 6.424s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch21.pth ...
Done in 11.436s
removing stale ckpt [epoch 20] [took 0.18s]
 epoch          : 21
 loss           : 4.300799641609192
 quant_reg      : 12.765660575866699
 quant_err      : 12.765660575866699
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.832
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.86382139056049
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.491
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.23067831900273
 mnt_best       : 43.86382139056049
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 3.61930 (QuantReg: 12.79814) QuantErr: 12.79814 batch_time=31.13337 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 4.56181 (QuantReg: 12.45238) QuantErr: 12.45238 batch_time=1.26020 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 4.46592 (QuantReg: 12.63256) QuantErr: 12.63256 batch_time=1.06852 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 3.35183 (QuantReg: 12.82783) QuantErr: 12.82783 batch_time=0.93471 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 4.33783 (QuantReg: 12.70802) QuantErr: 12.70802 batch_time=0.92667 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 4.33447 (QuantReg: 12.95347) QuantErr: 12.95347 batch_time=1.01673 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 4.81361 (QuantReg: 12.65847) QuantErr: 12.65847 batch_time=1.06749 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 4.02463 (QuantReg: 12.61738) QuantErr: 12.61738 batch_time=0.94476 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 5.39512 (QuantReg: 12.68575) QuantErr: 12.68575 batch_time=0.91099 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 3.77955 (QuantReg: 12.54122) QuantErr: 12.54122 batch_time=1.06683 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 3.95423 (QuantReg: 12.98950) QuantErr: 12.98950 batch_time=2.21117 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 4.95035 (QuantReg: 13.01525) QuantErr: 13.01525 batch_time=1.09443 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 4.15631 (QuantReg: 12.80097) QuantErr: 12.80097 batch_time=0.89391 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 4.13562 (QuantReg: 12.74370) QuantErr: 12.74370 batch_time=3.39332 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 4.16417 (QuantReg: 12.78509) QuantErr: 12.78509 batch_time=0.95720 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 3.65659 (QuantReg: 13.06776) QuantErr: 13.06776 batch_time=1.17328 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 4.47010 (QuantReg: 12.80873) QuantErr: 12.80873 batch_time=0.96731 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 3.74765 (QuantReg: 12.93444) QuantErr: 12.93444 batch_time=0.90221 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 5.19404 (QuantReg: 12.63110) QuantErr: 12.63110 batch_time=0.93922 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 4.15947 (QuantReg: 12.70530) QuantErr: 12.70530 batch_time=1.18981 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 4.30423 (QuantReg: 12.55660) QuantErr: 12.55660 batch_time=0.95009 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 4.61603 (QuantReg: 12.91308) QuantErr: 12.91308 batch_time=0.97696 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 4.46031 (QuantReg: 12.73128) QuantErr: 12.73128 batch_time=1.26206 
Train Epoch: 22 codebook_update_time=8.67094
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch22.pth ...
Done in 3.883s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch22.pth ...
Done in 8.083s
removing stale ckpt [epoch 21] [took 0.02s]
 epoch          : 22
 loss           : 4.309409836769104
 quant_reg      : 12.74806209564209
 quant_err      : 12.74806209564209
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.617
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.95169699257407
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.5695
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.70947654281784
 mnt_best       : 43.95169699257407
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 3.06058 (QuantReg: 12.83139) QuantErr: 12.83139 batch_time=31.08213 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 3.37326 (QuantReg: 12.75282) QuantErr: 12.75282 batch_time=1.00752 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 4.30135 (QuantReg: 12.55892) QuantErr: 12.55892 batch_time=0.95236 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 5.52768 (QuantReg: 12.51657) QuantErr: 12.51657 batch_time=0.92655 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 4.27785 (QuantReg: 12.72557) QuantErr: 12.72557 batch_time=0.90718 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 2.93796 (QuantReg: 13.13882) QuantErr: 13.13882 batch_time=0.90540 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 3.79913 (QuantReg: 12.80569) QuantErr: 12.80569 batch_time=1.04202 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 2.97197 (QuantReg: 13.16601) QuantErr: 13.16601 batch_time=0.91003 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 4.00553 (QuantReg: 12.74537) QuantErr: 12.74537 batch_time=0.92271 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 4.03514 (QuantReg: 12.74165) QuantErr: 12.74165 batch_time=0.93400 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 4.07695 (QuantReg: 13.20955) QuantErr: 13.20955 batch_time=0.88916 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 6.10918 (QuantReg: 12.76012) QuantErr: 12.76012 batch_time=0.91208 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 5.02290 (QuantReg: 13.28546) QuantErr: 13.28546 batch_time=1.70894 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 4.56122 (QuantReg: 13.05033) QuantErr: 13.05033 batch_time=2.05663 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 4.12916 (QuantReg: 12.69730) QuantErr: 12.69730 batch_time=0.93980 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 4.63963 (QuantReg: 13.19071) QuantErr: 13.19071 batch_time=2.23385 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 4.54123 (QuantReg: 12.77570) QuantErr: 12.77570 batch_time=1.01276 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 4.03225 (QuantReg: 12.72381) QuantErr: 12.72381 batch_time=0.88989 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 4.46821 (QuantReg: 13.35908) QuantErr: 13.35908 batch_time=0.90759 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 3.86116 (QuantReg: 12.95467) QuantErr: 12.95467 batch_time=0.96335 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 4.03522 (QuantReg: 12.87786) QuantErr: 12.87786 batch_time=0.97381 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 3.72998 (QuantReg: 12.89872) QuantErr: 12.89872 batch_time=0.90631 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 4.26110 (QuantReg: 12.83907) QuantErr: 12.83907 batch_time=1.02760 
Train Epoch: 23 codebook_update_time=8.21325
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch23.pth ...
Done in 4.007s
removing stale ckpt [epoch 22] [took 0.02s]
 epoch          : 23
 loss           : 4.151715963363648
 quant_reg      : 12.82959009552002
 quant_err      : 12.82959009552002
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.091
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.930154337076644
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.487
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.805368287617846
 mnt_best       : 43.95169699257407
 not_improved_count: 1
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 3.65152 (QuantReg: 12.77860) QuantErr: 12.77860 batch_time=31.58941 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 4.40370 (QuantReg: 12.72564) QuantErr: 12.72564 batch_time=0.93170 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 4.49103 (QuantReg: 12.89126) QuantErr: 12.89126 batch_time=0.97667 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 3.05416 (QuantReg: 12.96272) QuantErr: 12.96272 batch_time=0.94759 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 4.97961 (QuantReg: 12.88593) QuantErr: 12.88593 batch_time=0.91307 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 4.09848 (QuantReg: 12.90749) QuantErr: 12.90749 batch_time=0.91384 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 3.34777 (QuantReg: 12.73657) QuantErr: 12.73657 batch_time=1.36018 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 4.21317 (QuantReg: 13.12075) QuantErr: 13.12075 batch_time=0.87438 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 4.15616 (QuantReg: 13.08453) QuantErr: 13.08453 batch_time=0.92382 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 3.59697 (QuantReg: 12.65252) QuantErr: 12.65252 batch_time=0.90030 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 4.23906 (QuantReg: 12.81913) QuantErr: 12.81913 batch_time=0.93960 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 4.98656 (QuantReg: 12.80181) QuantErr: 12.80181 batch_time=0.92686 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 3.10414 (QuantReg: 13.16252) QuantErr: 13.16252 batch_time=0.89927 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 5.16380 (QuantReg: 12.94435) QuantErr: 12.94435 batch_time=0.92742 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 3.32594 (QuantReg: 12.84082) QuantErr: 12.84082 batch_time=0.96139 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 4.16310 (QuantReg: 12.84086) QuantErr: 12.84086 batch_time=1.09614 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 4.78805 (QuantReg: 12.52701) QuantErr: 12.52701 batch_time=1.05662 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 3.80572 (QuantReg: 12.91273) QuantErr: 12.91273 batch_time=0.88747 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 4.60886 (QuantReg: 12.95888) QuantErr: 12.95888 batch_time=0.95172 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 3.92865 (QuantReg: 13.05203) QuantErr: 13.05203 batch_time=1.08462 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 3.62950 (QuantReg: 12.68261) QuantErr: 12.68261 batch_time=1.00445 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 4.98089 (QuantReg: 13.03972) QuantErr: 13.03972 batch_time=0.99479 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 3.55163 (QuantReg: 12.79091) QuantErr: 12.79091 batch_time=1.14372 
Train Epoch: 24 codebook_update_time=7.93699
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch24.pth ...
Done in 4.092s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 4.099113788604736
 quant_reg      : 12.844336311340331
 quant_err      : 12.844336311340331
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.947
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.09822865479579
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.5555
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.887422299930165
 mnt_best       : 43.95169699257407
 not_improved_count: 2
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 4.43499 (QuantReg: 12.80302) QuantErr: 12.80302 batch_time=26.96569 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 2.92148 (QuantReg: 13.19988) QuantErr: 13.19988 batch_time=0.95883 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 4.50623 (QuantReg: 12.78003) QuantErr: 12.78003 batch_time=0.99931 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 3.38046 (QuantReg: 12.68135) QuantErr: 12.68135 batch_time=1.06198 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 4.21247 (QuantReg: 12.79694) QuantErr: 12.79694 batch_time=0.92715 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 4.23829 (QuantReg: 12.71846) QuantErr: 12.71846 batch_time=0.92083 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 3.73360 (QuantReg: 12.55211) QuantErr: 12.55211 batch_time=3.71100 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 2.85057 (QuantReg: 13.02720) QuantErr: 13.02720 batch_time=0.92803 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 4.13537 (QuantReg: 13.07079) QuantErr: 13.07079 batch_time=2.70761 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 4.81107 (QuantReg: 12.98982) QuantErr: 12.98982 batch_time=0.93093 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 4.13528 (QuantReg: 13.20950) QuantErr: 13.20950 batch_time=0.95728 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 3.73838 (QuantReg: 13.26603) QuantErr: 13.26603 batch_time=0.90841 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 4.10607 (QuantReg: 12.97068) QuantErr: 12.97068 batch_time=0.93349 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 4.25257 (QuantReg: 13.10653) QuantErr: 13.10653 batch_time=0.91785 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 3.83665 (QuantReg: 13.31588) QuantErr: 13.31588 batch_time=0.93906 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 5.24043 (QuantReg: 12.57362) QuantErr: 12.57362 batch_time=0.98021 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 4.01645 (QuantReg: 13.10569) QuantErr: 13.10569 batch_time=1.03219 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 4.77150 (QuantReg: 12.85800) QuantErr: 12.85800 batch_time=0.92647 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 4.23195 (QuantReg: 13.00179) QuantErr: 13.00179 batch_time=0.95724 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 3.65586 (QuantReg: 12.77690) QuantErr: 12.77690 batch_time=1.08667 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 3.36206 (QuantReg: 12.91533) QuantErr: 12.91533 batch_time=1.04919 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 3.98296 (QuantReg: 12.91145) QuantErr: 12.91145 batch_time=1.04385 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 4.84605 (QuantReg: 13.03938) QuantErr: 13.03938 batch_time=0.99942 
Train Epoch: 25 codebook_update_time=7.59157
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch25.pth ...
Done in 3.776s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 4.0229910478591915
 quant_reg      : 12.878604351043702
 quant_err      : 12.878604351043702
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.276
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.64409869192128
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.1815
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.752899451138326
 mnt_best       : 43.95169699257407
 not_improved_count: 3
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 3.84385 (QuantReg: 12.63596) QuantErr: 12.63596 batch_time=27.96307 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 5.19237 (QuantReg: 13.03431) QuantErr: 13.03431 batch_time=0.90000 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 4.49324 (QuantReg: 12.96672) QuantErr: 12.96672 batch_time=0.93566 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 4.06399 (QuantReg: 12.81073) QuantErr: 12.81073 batch_time=0.92315 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 4.54416 (QuantReg: 12.67216) QuantErr: 12.67216 batch_time=1.07781 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 3.77849 (QuantReg: 12.71979) QuantErr: 12.71979 batch_time=1.38863 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 5.38644 (QuantReg: 13.00321) QuantErr: 13.00321 batch_time=0.92371 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 4.62226 (QuantReg: 12.78862) QuantErr: 12.78862 batch_time=0.94200 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 4.26078 (QuantReg: 13.12280) QuantErr: 13.12280 batch_time=0.94114 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 3.28098 (QuantReg: 12.76541) QuantErr: 12.76541 batch_time=0.91969 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 4.29877 (QuantReg: 12.67261) QuantErr: 12.67261 batch_time=1.02075 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 3.52135 (QuantReg: 12.89510) QuantErr: 12.89510 batch_time=0.98682 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 3.42727 (QuantReg: 12.94076) QuantErr: 12.94076 batch_time=0.96870 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 3.64032 (QuantReg: 12.46201) QuantErr: 12.46201 batch_time=2.08907 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 4.31558 (QuantReg: 12.89948) QuantErr: 12.89948 batch_time=1.08533 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 4.35351 (QuantReg: 13.08481) QuantErr: 13.08481 batch_time=0.96026 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 4.28382 (QuantReg: 12.72349) QuantErr: 12.72349 batch_time=1.11391 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 4.73678 (QuantReg: 12.97984) QuantErr: 12.97984 batch_time=0.95674 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 4.13059 (QuantReg: 12.57909) QuantErr: 12.57909 batch_time=0.96318 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 4.48555 (QuantReg: 12.91976) QuantErr: 12.91976 batch_time=0.93500 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 4.32642 (QuantReg: 13.06686) QuantErr: 13.06686 batch_time=1.03426 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 5.07254 (QuantReg: 12.77941) QuantErr: 12.77941 batch_time=0.97147 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 3.59308 (QuantReg: 12.52100) QuantErr: 12.52100 batch_time=1.00063 
Train Epoch: 26 codebook_update_time=7.24333
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch26.pth ...
Done in 4.717s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 3.9833270273208616
 quant_reg      : 12.900765422821046
 quant_err      : 12.900765422821046
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.16
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.812221105494146
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.31
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.28138231547636
 mnt_best       : 43.95169699257407
 not_improved_count: 4
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 3.93383 (QuantReg: 12.81666) QuantErr: 12.81666 batch_time=29.20377 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 4.38502 (QuantReg: 13.09097) QuantErr: 13.09097 batch_time=1.03639 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 3.86170 (QuantReg: 13.08665) QuantErr: 13.08665 batch_time=0.93401 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 3.64001 (QuantReg: 13.08866) QuantErr: 13.08866 batch_time=1.05746 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 4.62565 (QuantReg: 12.68959) QuantErr: 12.68959 batch_time=1.03260 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 2.71490 (QuantReg: 12.88489) QuantErr: 12.88489 batch_time=0.99100 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 3.54996 (QuantReg: 13.29068) QuantErr: 13.29068 batch_time=1.02168 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 3.98758 (QuantReg: 12.99647) QuantErr: 12.99647 batch_time=1.39201 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 3.95079 (QuantReg: 13.23820) QuantErr: 13.23820 batch_time=1.00827 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 3.38987 (QuantReg: 12.71773) QuantErr: 12.71773 batch_time=0.94014 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 3.55839 (QuantReg: 13.02061) QuantErr: 13.02061 batch_time=0.92498 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 3.07971 (QuantReg: 12.84396) QuantErr: 12.84396 batch_time=1.00179 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 3.35751 (QuantReg: 12.83893) QuantErr: 12.83893 batch_time=3.11745 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 4.15210 (QuantReg: 13.04206) QuantErr: 13.04206 batch_time=1.34948 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 3.15250 (QuantReg: 12.68658) QuantErr: 12.68658 batch_time=0.98880 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 2.64391 (QuantReg: 12.93950) QuantErr: 12.93950 batch_time=0.90306 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 3.93782 (QuantReg: 12.68798) QuantErr: 12.68798 batch_time=0.94720 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 3.02163 (QuantReg: 13.31372) QuantErr: 13.31372 batch_time=0.95118 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 5.31141 (QuantReg: 12.60569) QuantErr: 12.60569 batch_time=1.01033 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 3.94517 (QuantReg: 12.80122) QuantErr: 12.80122 batch_time=2.72667 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 4.46273 (QuantReg: 12.78619) QuantErr: 12.78619 batch_time=0.95826 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 4.43745 (QuantReg: 13.10722) QuantErr: 13.10722 batch_time=0.99248 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 3.86424 (QuantReg: 12.98841) QuantErr: 12.98841 batch_time=1.25486 
Train Epoch: 27 codebook_update_time=7.44342
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch27.pth ...
Done in 4.066s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 3.8837422275543214
 quant_reg      : 12.937187049865722
 quant_err      : 12.937187049865722
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.207
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.80838732785995
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.4465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.66131149162776
 mnt_best       : 43.95169699257407
 not_improved_count: 5
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 3.49382 (QuantReg: 13.24528) QuantErr: 13.24528 batch_time=29.66764 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 4.64212 (QuantReg: 12.86708) QuantErr: 12.86708 batch_time=0.93110 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 3.31188 (QuantReg: 12.96594) QuantErr: 12.96594 batch_time=0.97592 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 3.23638 (QuantReg: 13.18379) QuantErr: 13.18379 batch_time=0.94901 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 5.32180 (QuantReg: 12.92098) QuantErr: 12.92098 batch_time=0.96825 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 3.13215 (QuantReg: 12.88717) QuantErr: 12.88717 batch_time=0.95193 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 3.82492 (QuantReg: 13.04024) QuantErr: 13.04024 batch_time=1.08810 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 3.53597 (QuantReg: 12.90387) QuantErr: 12.90387 batch_time=1.14099 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 4.07341 (QuantReg: 13.09706) QuantErr: 13.09706 batch_time=0.91367 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 4.01894 (QuantReg: 12.79963) QuantErr: 12.79963 batch_time=0.93404 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 3.98373 (QuantReg: 12.86156) QuantErr: 12.86156 batch_time=0.94406 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 2.75268 (QuantReg: 13.10696) QuantErr: 13.10696 batch_time=0.91804 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 5.21678 (QuantReg: 12.96027) QuantErr: 12.96027 batch_time=0.88855 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 4.10876 (QuantReg: 12.71067) QuantErr: 12.71067 batch_time=1.65102 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 4.28352 (QuantReg: 12.70419) QuantErr: 12.70419 batch_time=0.94390 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 3.43341 (QuantReg: 12.89246) QuantErr: 12.89246 batch_time=0.92896 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 4.21694 (QuantReg: 12.69147) QuantErr: 12.69147 batch_time=1.01593 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 4.60716 (QuantReg: 12.69902) QuantErr: 12.69902 batch_time=1.01680 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 3.68499 (QuantReg: 13.07993) QuantErr: 13.07993 batch_time=1.06302 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 3.59095 (QuantReg: 13.08654) QuantErr: 13.08654 batch_time=1.73591 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 3.97806 (QuantReg: 12.80819) QuantErr: 12.80819 batch_time=1.10399 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 4.12737 (QuantReg: 13.25755) QuantErr: 13.25755 batch_time=1.06384 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 4.60624 (QuantReg: 12.75233) QuantErr: 12.75233 batch_time=0.99977 
Train Epoch: 28 codebook_update_time=8.47752
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch28.pth ...
Done in 6.107s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 3.79903071308136
 quant_reg      : 12.954435745239257
 quant_err      : 12.954435745239257
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.892
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.22267488897913
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.812
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.42479744580689
 mnt_best       : 43.95169699257407
 not_improved_count: 6
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 3.34525 (QuantReg: 13.26099) QuantErr: 13.26099 batch_time=30.28214 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 3.45270 (QuantReg: 12.72502) QuantErr: 12.72502 batch_time=0.91578 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 3.43484 (QuantReg: 12.96824) QuantErr: 12.96824 batch_time=0.94375 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 3.60651 (QuantReg: 13.09008) QuantErr: 13.09008 batch_time=0.91063 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 3.72684 (QuantReg: 13.10336) QuantErr: 13.10336 batch_time=0.94121 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 3.62065 (QuantReg: 13.15706) QuantErr: 13.15706 batch_time=1.04509 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 3.67838 (QuantReg: 13.10040) QuantErr: 13.10040 batch_time=1.05779 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 3.33599 (QuantReg: 13.16403) QuantErr: 13.16403 batch_time=0.91573 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 4.08915 (QuantReg: 12.90240) QuantErr: 12.90240 batch_time=0.92292 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 3.73596 (QuantReg: 12.70528) QuantErr: 12.70528 batch_time=0.90767 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 3.00955 (QuantReg: 13.10095) QuantErr: 13.10095 batch_time=0.98694 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 4.01233 (QuantReg: 13.10755) QuantErr: 13.10755 batch_time=0.90868 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 3.13762 (QuantReg: 13.05315) QuantErr: 13.05315 batch_time=1.65670 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 3.81939 (QuantReg: 13.15815) QuantErr: 13.15815 batch_time=0.88724 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 3.51505 (QuantReg: 13.23057) QuantErr: 13.23057 batch_time=0.96223 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 3.52555 (QuantReg: 12.91441) QuantErr: 12.91441 batch_time=1.07791 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 4.16598 (QuantReg: 13.08701) QuantErr: 13.08701 batch_time=0.97456 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 4.20294 (QuantReg: 12.83989) QuantErr: 12.83989 batch_time=0.89905 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 5.31812 (QuantReg: 12.59079) QuantErr: 12.59079 batch_time=0.96847 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 3.78219 (QuantReg: 12.81144) QuantErr: 12.81144 batch_time=4.56344 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 3.36390 (QuantReg: 13.04353) QuantErr: 13.04353 batch_time=1.01327 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 4.08231 (QuantReg: 12.69411) QuantErr: 12.69411 batch_time=1.47647 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 3.63188 (QuantReg: 12.60391) QuantErr: 12.60391 batch_time=1.13077 
Train Epoch: 29 codebook_update_time=7.78023
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch29.pth ...
Done in 4.733s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 3.7792023334503173
 quant_reg      : 12.980252487182618
 quant_err      : 12.980252487182618
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.095
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.37345386167644
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.006
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.94528598579735
 mnt_best       : 43.95169699257407
 not_improved_count: 7
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 3.72614 (QuantReg: 12.94428) QuantErr: 12.94428 batch_time=29.00583 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 4.19785 (QuantReg: 13.28503) QuantErr: 13.28503 batch_time=2.94067 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 4.29350 (QuantReg: 12.73625) QuantErr: 12.73625 batch_time=0.94325 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 4.44342 (QuantReg: 13.07628) QuantErr: 13.07628 batch_time=0.94633 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 3.37742 (QuantReg: 13.08621) QuantErr: 13.08621 batch_time=0.91662 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 3.71856 (QuantReg: 12.80317) QuantErr: 12.80317 batch_time=0.96404 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 4.19548 (QuantReg: 13.05729) QuantErr: 13.05729 batch_time=1.03963 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 2.90059 (QuantReg: 13.18856) QuantErr: 13.18856 batch_time=1.01554 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 4.24524 (QuantReg: 13.08700) QuantErr: 13.08700 batch_time=0.93058 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 4.16038 (QuantReg: 12.87894) QuantErr: 12.87894 batch_time=1.04964 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 4.80130 (QuantReg: 12.71101) QuantErr: 12.71101 batch_time=1.01509 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 4.51548 (QuantReg: 13.02275) QuantErr: 13.02275 batch_time=0.94922 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 3.95511 (QuantReg: 13.01786) QuantErr: 13.01786 batch_time=2.51412 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 4.09016 (QuantReg: 13.07747) QuantErr: 13.07747 batch_time=0.89562 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 4.42757 (QuantReg: 12.80021) QuantErr: 12.80021 batch_time=0.86807 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 3.43505 (QuantReg: 13.21631) QuantErr: 13.21631 batch_time=0.93714 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 3.43968 (QuantReg: 13.27702) QuantErr: 13.27702 batch_time=0.97444 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 4.76809 (QuantReg: 13.06233) QuantErr: 13.06233 batch_time=1.23168 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 3.18408 (QuantReg: 12.89643) QuantErr: 12.89643 batch_time=1.03409 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 3.43750 (QuantReg: 12.83078) QuantErr: 12.83078 batch_time=1.33680 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 4.34985 (QuantReg: 12.74623) QuantErr: 12.74623 batch_time=1.18302 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 3.42837 (QuantReg: 12.76771) QuantErr: 12.76771 batch_time=2.81610 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 4.15273 (QuantReg: 12.95415) QuantErr: 12.95415 batch_time=0.98950 
Train Epoch: 30 codebook_update_time=7.60600
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch30.pth ...
Done in 5.016s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch30.pth ...
Done in 9.761s
removing stale ckpt [epoch 29] [took 0.01s]
 epoch          : 30
 loss           : 3.831663549423218
 quant_reg      : 12.983551635742188
 quant_err      : 12.983551635742188
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.37
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.585263955370536
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.265
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.52336306334695
 mnt_best       : 44.585263955370536
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 3.00532 (QuantReg: 13.20331) QuantErr: 13.20331 batch_time=28.77714 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 3.33713 (QuantReg: 13.22166) QuantErr: 13.22166 batch_time=1.54122 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 3.93071 (QuantReg: 12.42294) QuantErr: 12.42294 batch_time=0.90430 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 3.27224 (QuantReg: 12.91383) QuantErr: 12.91383 batch_time=0.91465 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 3.47509 (QuantReg: 13.05908) QuantErr: 13.05908 batch_time=0.91894 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 4.04574 (QuantReg: 12.71599) QuantErr: 12.71599 batch_time=0.88613 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 3.53031 (QuantReg: 12.85353) QuantErr: 12.85353 batch_time=1.00869 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 3.58390 (QuantReg: 13.14370) QuantErr: 13.14370 batch_time=1.11685 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 4.11288 (QuantReg: 12.44084) QuantErr: 12.44084 batch_time=0.92539 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 4.11367 (QuantReg: 12.81968) QuantErr: 12.81968 batch_time=1.07985 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 2.96470 (QuantReg: 12.78078) QuantErr: 12.78078 batch_time=0.96837 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 4.32983 (QuantReg: 12.86804) QuantErr: 12.86804 batch_time=0.89950 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 3.22538 (QuantReg: 12.87402) QuantErr: 12.87402 batch_time=0.90325 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 4.43453 (QuantReg: 13.11021) QuantErr: 13.11021 batch_time=0.92883 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 3.24309 (QuantReg: 13.17676) QuantErr: 13.17676 batch_time=0.95681 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 3.46544 (QuantReg: 13.21453) QuantErr: 13.21453 batch_time=1.07644 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 2.21722 (QuantReg: 13.27775) QuantErr: 13.27775 batch_time=1.12345 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 4.47905 (QuantReg: 12.78641) QuantErr: 12.78641 batch_time=0.93632 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 3.10965 (QuantReg: 13.14152) QuantErr: 13.14152 batch_time=1.06062 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 3.69217 (QuantReg: 12.87710) QuantErr: 12.87710 batch_time=1.04967 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 4.37926 (QuantReg: 13.15794) QuantErr: 13.15794 batch_time=0.92168 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 3.21858 (QuantReg: 13.30014) QuantErr: 13.30014 batch_time=1.36435 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 3.83442 (QuantReg: 12.83876) QuantErr: 12.83876 batch_time=1.10377 
Train Epoch: 31 codebook_update_time=8.62936
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch31.pth ...
Done in 6.087s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 3.7390217952728273
 quant_reg      : 12.988531032562255
 quant_err      : 12.988531032562255
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.597
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.35993057312026
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4985
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.46160185530049
 mnt_best       : 44.585263955370536
 not_improved_count: 1
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 3.75506 (QuantReg: 13.02726) QuantErr: 13.02726 batch_time=30.52375 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 3.20519 (QuantReg: 12.92306) QuantErr: 12.92306 batch_time=3.17658 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 3.43157 (QuantReg: 13.14624) QuantErr: 13.14624 batch_time=0.92787 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 3.56779 (QuantReg: 13.07680) QuantErr: 13.07680 batch_time=1.04929 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 3.50226 (QuantReg: 13.02139) QuantErr: 13.02139 batch_time=1.05406 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 3.81238 (QuantReg: 13.07847) QuantErr: 13.07847 batch_time=0.96310 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 3.72174 (QuantReg: 13.01284) QuantErr: 13.01284 batch_time=0.93813 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 3.33494 (QuantReg: 12.98143) QuantErr: 12.98143 batch_time=1.09136 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 4.61790 (QuantReg: 12.66871) QuantErr: 12.66871 batch_time=1.00614 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 5.05990 (QuantReg: 13.04917) QuantErr: 13.04917 batch_time=1.04344 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 3.47738 (QuantReg: 12.98661) QuantErr: 12.98661 batch_time=0.93347 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 3.71217 (QuantReg: 12.51545) QuantErr: 12.51545 batch_time=0.91878 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 3.73577 (QuantReg: 13.39199) QuantErr: 13.39199 batch_time=0.93666 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 3.07705 (QuantReg: 13.06009) QuantErr: 13.06009 batch_time=0.95518 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 4.17672 (QuantReg: 13.07059) QuantErr: 13.07059 batch_time=0.88923 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 3.49426 (QuantReg: 13.10127) QuantErr: 13.10127 batch_time=0.95172 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 2.56265 (QuantReg: 13.21246) QuantErr: 13.21246 batch_time=1.01033 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 3.04091 (QuantReg: 12.94185) QuantErr: 12.94185 batch_time=1.09558 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 4.40627 (QuantReg: 12.99320) QuantErr: 12.99320 batch_time=1.04390 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 4.04758 (QuantReg: 12.90822) QuantErr: 12.90822 batch_time=1.98446 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 3.77944 (QuantReg: 13.04090) QuantErr: 13.04090 batch_time=1.01474 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 3.56977 (QuantReg: 13.18942) QuantErr: 13.18942 batch_time=1.06439 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 3.17794 (QuantReg: 12.98873) QuantErr: 12.98873 batch_time=1.00449 
Train Epoch: 32 codebook_update_time=8.00324
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch32.pth ...
Done in 5.000s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 3.7892789716720583
 quant_reg      : 13.010694999694824
 quant_err      : 13.010694999694824
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.91
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.552068664875925
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.609
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.03452165815636
 mnt_best       : 44.585263955370536
 not_improved_count: 2
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 3.00481 (QuantReg: 12.90480) QuantErr: 12.90480 batch_time=31.37830 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 4.27310 (QuantReg: 12.80325) QuantErr: 12.80325 batch_time=0.95105 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 4.00718 (QuantReg: 12.74516) QuantErr: 12.74516 batch_time=0.92727 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 4.42108 (QuantReg: 13.09196) QuantErr: 13.09196 batch_time=0.92735 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 3.46548 (QuantReg: 12.93943) QuantErr: 12.93943 batch_time=0.90907 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 4.04187 (QuantReg: 12.91826) QuantErr: 12.91826 batch_time=0.96554 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 2.97986 (QuantReg: 13.25555) QuantErr: 13.25555 batch_time=0.97068 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 4.23265 (QuantReg: 13.01494) QuantErr: 13.01494 batch_time=0.92313 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 3.45979 (QuantReg: 13.20906) QuantErr: 13.20906 batch_time=0.93523 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 2.99212 (QuantReg: 13.24481) QuantErr: 13.24481 batch_time=0.90113 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 2.83871 (QuantReg: 13.35069) QuantErr: 13.35069 batch_time=0.90179 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 5.15533 (QuantReg: 12.62212) QuantErr: 12.62212 batch_time=0.93005 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 3.92648 (QuantReg: 12.67098) QuantErr: 12.67098 batch_time=0.88737 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 4.38441 (QuantReg: 13.09993) QuantErr: 13.09993 batch_time=1.84649 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 3.27867 (QuantReg: 12.71077) QuantErr: 12.71077 batch_time=0.89776 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 3.90718 (QuantReg: 13.16554) QuantErr: 13.16554 batch_time=1.35043 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 3.47705 (QuantReg: 13.21354) QuantErr: 13.21354 batch_time=0.93426 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 3.42662 (QuantReg: 13.48908) QuantErr: 13.48908 batch_time=1.15139 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 4.23358 (QuantReg: 12.90770) QuantErr: 12.90770 batch_time=0.96799 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 2.93961 (QuantReg: 13.05614) QuantErr: 13.05614 batch_time=0.95197 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 3.29349 (QuantReg: 13.05832) QuantErr: 13.05832 batch_time=0.96265 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 3.21248 (QuantReg: 13.18991) QuantErr: 13.18991 batch_time=0.92868 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 3.97707 (QuantReg: 13.09465) QuantErr: 13.09465 batch_time=1.13002 
Train Epoch: 33 codebook_update_time=7.64225
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch33.pth ...
Done in 6.267s
removing stale ckpt [epoch 32] [took 0.08s]
 epoch          : 33
 loss           : 3.713738522529602
 quant_reg      : 13.033279319763183
 quant_err      : 13.033279319763183
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.192
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.2554187029253
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.007
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.96260893990788
 mnt_best       : 44.585263955370536
 not_improved_count: 3
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 4.73139 (QuantReg: 12.65917) QuantErr: 12.65917 batch_time=28.65171 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 4.31947 (QuantReg: 12.72614) QuantErr: 12.72614 batch_time=0.96012 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 4.69475 (QuantReg: 12.78881) QuantErr: 12.78881 batch_time=0.91550 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 4.08609 (QuantReg: 12.81534) QuantErr: 12.81534 batch_time=0.92368 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 3.93155 (QuantReg: 13.05973) QuantErr: 13.05973 batch_time=0.97562 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 3.76178 (QuantReg: 13.09135) QuantErr: 13.09135 batch_time=0.97536 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 3.10713 (QuantReg: 12.94871) QuantErr: 12.94871 batch_time=1.13263 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 3.10236 (QuantReg: 13.30420) QuantErr: 13.30420 batch_time=1.03632 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 3.99687 (QuantReg: 13.02454) QuantErr: 13.02454 batch_time=1.98745 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 3.58252 (QuantReg: 12.82342) QuantErr: 12.82342 batch_time=0.93710 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 3.87548 (QuantReg: 13.07404) QuantErr: 13.07404 batch_time=0.97685 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 3.56553 (QuantReg: 13.07123) QuantErr: 13.07123 batch_time=0.98842 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 2.77514 (QuantReg: 13.35341) QuantErr: 13.35341 batch_time=3.16166 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 3.36603 (QuantReg: 13.19894) QuantErr: 13.19894 batch_time=1.38825 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 4.02949 (QuantReg: 12.97408) QuantErr: 12.97408 batch_time=1.40826 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 3.05946 (QuantReg: 13.06144) QuantErr: 13.06144 batch_time=1.15314 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 3.79420 (QuantReg: 12.79385) QuantErr: 12.79385 batch_time=1.08811 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 3.82445 (QuantReg: 12.93181) QuantErr: 12.93181 batch_time=1.10693 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 4.43470 (QuantReg: 12.85906) QuantErr: 12.85906 batch_time=1.07698 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 3.67547 (QuantReg: 13.21609) QuantErr: 13.21609 batch_time=1.12140 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 3.99035 (QuantReg: 13.30054) QuantErr: 13.30054 batch_time=3.93816 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 3.86939 (QuantReg: 12.94586) QuantErr: 12.94586 batch_time=0.98854 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 3.56204 (QuantReg: 13.19827) QuantErr: 13.19827 batch_time=1.01350 
Train Epoch: 34 codebook_update_time=7.68879
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch34.pth ...
Done in 4.908s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 3.668135384559631
 quant_reg      : 13.058239040374756
 quant_err      : 13.058239040374756
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.111
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.01266852842185
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0225
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.249160103658035
 mnt_best       : 44.585263955370536
 not_improved_count: 4
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 3.99069 (QuantReg: 12.73637) QuantErr: 12.73637 batch_time=26.77629 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 3.94056 (QuantReg: 12.81230) QuantErr: 12.81230 batch_time=0.92105 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 3.78767 (QuantReg: 13.08141) QuantErr: 13.08141 batch_time=0.91353 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 4.08166 (QuantReg: 12.87094) QuantErr: 12.87094 batch_time=0.91180 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 2.64125 (QuantReg: 13.05420) QuantErr: 13.05420 batch_time=1.09102 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 4.16227 (QuantReg: 13.01741) QuantErr: 13.01741 batch_time=0.91877 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 3.62004 (QuantReg: 12.98297) QuantErr: 12.98297 batch_time=1.03659 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 3.89531 (QuantReg: 13.06932) QuantErr: 13.06932 batch_time=0.92185 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 3.51761 (QuantReg: 12.97894) QuantErr: 12.97894 batch_time=0.89540 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 3.75976 (QuantReg: 13.02327) QuantErr: 13.02327 batch_time=0.93937 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 2.59680 (QuantReg: 13.19907) QuantErr: 13.19907 batch_time=0.90413 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 3.73057 (QuantReg: 12.87432) QuantErr: 12.87432 batch_time=1.02929 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 3.98186 (QuantReg: 13.03712) QuantErr: 13.03712 batch_time=2.13646 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 3.57955 (QuantReg: 12.88546) QuantErr: 12.88546 batch_time=0.91971 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 4.14032 (QuantReg: 12.74169) QuantErr: 12.74169 batch_time=0.98519 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 3.53945 (QuantReg: 12.89429) QuantErr: 12.89429 batch_time=0.94226 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 4.70092 (QuantReg: 12.95351) QuantErr: 12.95351 batch_time=1.15566 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 3.63042 (QuantReg: 13.35097) QuantErr: 13.35097 batch_time=0.91101 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 4.53742 (QuantReg: 12.54813) QuantErr: 12.54813 batch_time=0.92319 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 2.67925 (QuantReg: 12.91570) QuantErr: 12.91570 batch_time=1.07173 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 3.10126 (QuantReg: 13.12345) QuantErr: 13.12345 batch_time=1.01200 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 3.47485 (QuantReg: 12.94276) QuantErr: 12.94276 batch_time=0.93107 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 3.15886 (QuantReg: 12.94153) QuantErr: 12.94153 batch_time=1.01641 
Train Epoch: 35 codebook_update_time=7.94789
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch35.pth ...
Done in 4.857s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch35.pth ...
Done in 9.963s
removing stale ckpt [epoch 34] [took 0.01s]
 epoch          : 35
 loss           : 3.6433635911941527
 quant_reg      : 13.026146739959717
 quant_err      : 13.026146739959717
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.937
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.19592906532018
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.426
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.92143900003567
 mnt_best       : 45.19592906532018
 not_improved_count: 0
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 3.66576 (QuantReg: 13.05832) QuantErr: 13.05832 batch_time=30.48342 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 3.09257 (QuantReg: 13.19401) QuantErr: 13.19401 batch_time=0.96486 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 3.16660 (QuantReg: 13.05829) QuantErr: 13.05829 batch_time=0.96658 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 3.56516 (QuantReg: 12.72189) QuantErr: 12.72189 batch_time=1.42363 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 3.37179 (QuantReg: 13.20253) QuantErr: 13.20253 batch_time=0.90905 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 4.58111 (QuantReg: 12.99543) QuantErr: 12.99543 batch_time=0.98637 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 3.56084 (QuantReg: 13.27534) QuantErr: 13.27534 batch_time=1.70005 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 3.15247 (QuantReg: 13.37817) QuantErr: 13.37817 batch_time=0.91045 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 3.41445 (QuantReg: 13.08392) QuantErr: 13.08392 batch_time=0.95755 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 3.46809 (QuantReg: 12.89409) QuantErr: 12.89409 batch_time=0.91164 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 3.16909 (QuantReg: 13.12408) QuantErr: 13.12408 batch_time=0.89911 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 3.30809 (QuantReg: 13.36061) QuantErr: 13.36061 batch_time=0.91793 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 3.70302 (QuantReg: 13.08959) QuantErr: 13.08959 batch_time=0.89966 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 3.30486 (QuantReg: 13.04874) QuantErr: 13.04874 batch_time=3.10436 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 3.63021 (QuantReg: 12.86065) QuantErr: 12.86065 batch_time=0.90671 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 4.12657 (QuantReg: 13.21737) QuantErr: 13.21737 batch_time=0.91292 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 2.88194 (QuantReg: 13.27302) QuantErr: 13.27302 batch_time=1.12713 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 2.80745 (QuantReg: 12.92616) QuantErr: 12.92616 batch_time=0.93221 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 3.51289 (QuantReg: 13.01410) QuantErr: 13.01410 batch_time=0.95618 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 3.43952 (QuantReg: 13.18132) QuantErr: 13.18132 batch_time=0.98217 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 3.42364 (QuantReg: 12.95360) QuantErr: 12.95360 batch_time=1.08660 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 2.95150 (QuantReg: 13.37029) QuantErr: 13.37029 batch_time=0.94286 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 3.75151 (QuantReg: 13.38419) QuantErr: 13.38419 batch_time=0.98022 
Train Epoch: 36 codebook_update_time=8.45222
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch36.pth ...
Done in 4.182s
removing stale ckpt [epoch 35] [took 0.13s]
 epoch          : 36
 loss           : 3.629546669960022
 quant_reg      : 13.076083450317382
 quant_err      : 13.076083450317382
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.485
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.06390919292235
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.724
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.497356848431394
 mnt_best       : 45.19592906532018
 not_improved_count: 1
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 3.79124 (QuantReg: 12.98918) QuantErr: 12.98918 batch_time=29.74321 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 3.72000 (QuantReg: 13.31973) QuantErr: 13.31973 batch_time=1.03921 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 3.60480 (QuantReg: 12.86870) QuantErr: 12.86870 batch_time=1.70304 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 4.18587 (QuantReg: 13.06625) QuantErr: 13.06625 batch_time=0.92682 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 3.05972 (QuantReg: 13.20032) QuantErr: 13.20032 batch_time=0.99586 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 3.51938 (QuantReg: 13.09019) QuantErr: 13.09019 batch_time=1.05382 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 4.09955 (QuantReg: 12.75143) QuantErr: 12.75143 batch_time=0.92032 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 3.51548 (QuantReg: 12.96956) QuantErr: 12.96956 batch_time=0.92867 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 3.76566 (QuantReg: 12.88184) QuantErr: 12.88184 batch_time=0.89337 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 3.10788 (QuantReg: 12.94247) QuantErr: 12.94247 batch_time=0.96674 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 3.85705 (QuantReg: 13.23392) QuantErr: 13.23392 batch_time=0.94451 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 3.04862 (QuantReg: 13.18918) QuantErr: 13.18918 batch_time=0.89460 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 4.43283 (QuantReg: 12.91247) QuantErr: 12.91247 batch_time=1.16738 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 4.03560 (QuantReg: 13.32558) QuantErr: 13.32558 batch_time=2.25001 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 2.68044 (QuantReg: 13.32117) QuantErr: 13.32117 batch_time=0.97515 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 4.14300 (QuantReg: 13.28103) QuantErr: 13.28103 batch_time=1.28795 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 4.07766 (QuantReg: 13.37098) QuantErr: 13.37098 batch_time=1.02214 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 3.12894 (QuantReg: 13.13017) QuantErr: 13.13017 batch_time=0.97640 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 3.82400 (QuantReg: 13.21466) QuantErr: 13.21466 batch_time=1.19375 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 4.02652 (QuantReg: 12.92494) QuantErr: 12.92494 batch_time=0.98168 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 3.33983 (QuantReg: 12.97111) QuantErr: 12.97111 batch_time=1.08366 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 3.64077 (QuantReg: 13.08827) QuantErr: 13.08827 batch_time=1.20186 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 3.75774 (QuantReg: 13.13811) QuantErr: 13.13811 batch_time=1.27282 
Train Epoch: 37 codebook_update_time=7.78728
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch37.pth ...
Done in 6.383s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 3.693058081626892
 quant_reg      : 13.083567863464355
 quant_err      : 13.083567863464355
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.875
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.71816613863782
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.374
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.69298911821695
 mnt_best       : 45.19592906532018
 not_improved_count: 2
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 4.10395 (QuantReg: 12.98301) QuantErr: 12.98301 batch_time=27.20250 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 3.46955 (QuantReg: 13.21636) QuantErr: 13.21636 batch_time=0.91713 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 3.29633 (QuantReg: 13.31133) QuantErr: 13.31133 batch_time=0.94066 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 3.62959 (QuantReg: 13.03634) QuantErr: 13.03634 batch_time=0.94386 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 3.81613 (QuantReg: 13.13936) QuantErr: 13.13936 batch_time=1.07337 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 3.24637 (QuantReg: 12.94847) QuantErr: 12.94847 batch_time=0.92426 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 2.68533 (QuantReg: 13.12725) QuantErr: 13.12725 batch_time=0.92748 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 3.08127 (QuantReg: 13.05588) QuantErr: 13.05588 batch_time=0.96795 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 4.37716 (QuantReg: 13.00919) QuantErr: 13.00919 batch_time=0.91606 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 4.15162 (QuantReg: 13.25454) QuantErr: 13.25454 batch_time=0.95086 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 3.58973 (QuantReg: 13.04451) QuantErr: 13.04451 batch_time=0.91304 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 3.51619 (QuantReg: 12.99197) QuantErr: 12.99197 batch_time=0.91334 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 3.96301 (QuantReg: 13.05579) QuantErr: 13.05579 batch_time=0.91990 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 3.39111 (QuantReg: 13.17996) QuantErr: 13.17996 batch_time=2.12369 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 3.54674 (QuantReg: 13.14356) QuantErr: 13.14356 batch_time=1.01044 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 3.94612 (QuantReg: 13.40675) QuantErr: 13.40675 batch_time=0.93641 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 3.19042 (QuantReg: 12.94141) QuantErr: 12.94141 batch_time=0.92783 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 3.57439 (QuantReg: 13.00551) QuantErr: 13.00551 batch_time=0.95463 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 3.88798 (QuantReg: 13.15923) QuantErr: 13.15923 batch_time=1.01056 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 3.60849 (QuantReg: 13.00882) QuantErr: 13.00882 batch_time=1.32958 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 4.20990 (QuantReg: 13.42202) QuantErr: 13.42202 batch_time=1.20776 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 2.81070 (QuantReg: 13.21579) QuantErr: 13.21579 batch_time=0.94868 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 3.18028 (QuantReg: 13.40707) QuantErr: 13.40707 batch_time=1.11712 
Train Epoch: 38 codebook_update_time=8.43516
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch38.pth ...
Done in 4.302s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 3.5873591089248658
 quant_reg      : 13.126882762908936
 quant_err      : 13.126882762908936
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.314
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.91289074534713
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.238
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.566025786492006
 mnt_best       : 45.19592906532018
 not_improved_count: 3
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 3.21102 (QuantReg: 13.35154) QuantErr: 13.35154 batch_time=29.95642 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 4.34763 (QuantReg: 12.93738) QuantErr: 12.93738 batch_time=0.98678 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 3.84448 (QuantReg: 12.89467) QuantErr: 12.89467 batch_time=0.95715 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 3.05614 (QuantReg: 13.02062) QuantErr: 13.02062 batch_time=0.88668 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 4.03565 (QuantReg: 13.19930) QuantErr: 13.19930 batch_time=0.90681 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 4.14338 (QuantReg: 13.14185) QuantErr: 13.14185 batch_time=1.00392 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 3.97774 (QuantReg: 13.20079) QuantErr: 13.20079 batch_time=1.01916 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 4.26591 (QuantReg: 12.92621) QuantErr: 12.92621 batch_time=1.02367 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 3.75826 (QuantReg: 12.93666) QuantErr: 12.93666 batch_time=0.88273 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 3.33390 (QuantReg: 13.09854) QuantErr: 13.09854 batch_time=0.89742 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 4.04913 (QuantReg: 12.89244) QuantErr: 12.89244 batch_time=0.90061 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 2.47603 (QuantReg: 13.34998) QuantErr: 13.34998 batch_time=0.89200 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 3.39723 (QuantReg: 12.98543) QuantErr: 12.98543 batch_time=0.92098 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 3.20617 (QuantReg: 12.95639) QuantErr: 12.95639 batch_time=2.69634 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 3.94994 (QuantReg: 12.98621) QuantErr: 12.98621 batch_time=1.36350 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 3.94214 (QuantReg: 12.99863) QuantErr: 12.99863 batch_time=0.96796 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 2.92693 (QuantReg: 13.31904) QuantErr: 13.31904 batch_time=0.92957 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 3.23526 (QuantReg: 13.53907) QuantErr: 13.53907 batch_time=0.91707 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 3.35393 (QuantReg: 13.43590) QuantErr: 13.43590 batch_time=0.96194 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 3.68418 (QuantReg: 13.23625) QuantErr: 13.23625 batch_time=2.35089 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 3.57617 (QuantReg: 13.25112) QuantErr: 13.25112 batch_time=0.96741 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 3.76522 (QuantReg: 12.77306) QuantErr: 12.77306 batch_time=0.97042 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 3.60598 (QuantReg: 12.92563) QuantErr: 12.92563 batch_time=0.96449 
Train Epoch: 39 codebook_update_time=7.92200
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch39.pth ...
Done in 3.733s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch39.pth ...
Done in 8.181s
removing stale ckpt [epoch 38] [took 0.12s]
 epoch          : 39
 loss           : 3.5775403413772584
 quant_reg      : 13.128211380004883
 quant_err      : 13.128211380004883
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.691
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.21919867978011
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.097
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.370147011883674
 mnt_best       : 45.21919867978011
 not_improved_count: 0
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 3.65390 (QuantReg: 13.64939) QuantErr: 13.64939 batch_time=30.36445 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 2.84880 (QuantReg: 13.26426) QuantErr: 13.26426 batch_time=0.93553 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 2.81798 (QuantReg: 13.14757) QuantErr: 13.14757 batch_time=0.93568 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 3.05697 (QuantReg: 13.12461) QuantErr: 13.12461 batch_time=1.06939 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 3.46749 (QuantReg: 13.21031) QuantErr: 13.21031 batch_time=0.95012 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 3.93833 (QuantReg: 13.10572) QuantErr: 13.10572 batch_time=0.91793 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 3.38315 (QuantReg: 13.09762) QuantErr: 13.09762 batch_time=0.97028 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 3.55210 (QuantReg: 13.13975) QuantErr: 13.13975 batch_time=0.92227 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 3.78672 (QuantReg: 12.85562) QuantErr: 12.85562 batch_time=0.98554 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 3.60886 (QuantReg: 13.28075) QuantErr: 13.28075 batch_time=0.92530 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 4.71240 (QuantReg: 13.05571) QuantErr: 13.05571 batch_time=0.96678 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 3.23646 (QuantReg: 12.99067) QuantErr: 12.99067 batch_time=0.96994 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 3.36987 (QuantReg: 12.99191) QuantErr: 12.99191 batch_time=0.94551 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 3.47706 (QuantReg: 13.03509) QuantErr: 13.03509 batch_time=1.01859 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 3.66657 (QuantReg: 13.10751) QuantErr: 13.10751 batch_time=2.22688 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 3.72483 (QuantReg: 13.32197) QuantErr: 13.32197 batch_time=0.92817 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 3.60528 (QuantReg: 13.04607) QuantErr: 13.04607 batch_time=0.95005 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 3.40702 (QuantReg: 13.17955) QuantErr: 13.17955 batch_time=0.96298 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 3.67419 (QuantReg: 13.28333) QuantErr: 13.28333 batch_time=1.01822 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 3.44494 (QuantReg: 12.93728) QuantErr: 12.93728 batch_time=2.68309 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 4.01721 (QuantReg: 12.91419) QuantErr: 12.91419 batch_time=1.12772 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 3.22751 (QuantReg: 13.38337) QuantErr: 13.38337 batch_time=1.01545 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 3.16046 (QuantReg: 13.25295) QuantErr: 13.25295 batch_time=1.01398 
Train Epoch: 40 codebook_update_time=8.18645
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch40.pth ...
Done in 5.210s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 3.5969451932907104
 quant_reg      : 13.141000926971435
 quant_err      : 13.141000926971435
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.785
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.949474650123356
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.04
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.220375795232854
 mnt_best       : 45.21919867978011
 not_improved_count: 1
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 3.45295 (QuantReg: 13.04878) QuantErr: 13.04878 batch_time=29.24817 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 3.13231 (QuantReg: 13.32826) QuantErr: 13.32826 batch_time=0.91895 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 3.11418 (QuantReg: 13.35628) QuantErr: 13.35628 batch_time=1.05011 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 3.12857 (QuantReg: 13.21035) QuantErr: 13.21035 batch_time=0.97283 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 3.37217 (QuantReg: 13.04064) QuantErr: 13.04064 batch_time=0.91486 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 3.22008 (QuantReg: 13.72146) QuantErr: 13.72146 batch_time=0.93228 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 3.33902 (QuantReg: 12.96128) QuantErr: 12.96128 batch_time=0.93564 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 3.01015 (QuantReg: 13.26490) QuantErr: 13.26490 batch_time=0.97928 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 3.59863 (QuantReg: 12.99598) QuantErr: 12.99598 batch_time=0.96278 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 3.21942 (QuantReg: 13.42654) QuantErr: 13.42654 batch_time=1.05902 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 2.83406 (QuantReg: 13.34637) QuantErr: 13.34637 batch_time=0.98543 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 3.94996 (QuantReg: 12.83229) QuantErr: 12.83229 batch_time=0.88374 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 4.26026 (QuantReg: 13.03983) QuantErr: 13.03983 batch_time=1.11726 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 3.46421 (QuantReg: 13.28711) QuantErr: 13.28711 batch_time=1.39963 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 3.48794 (QuantReg: 13.17628) QuantErr: 13.17628 batch_time=1.00924 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 3.04894 (QuantReg: 13.00403) QuantErr: 13.00403 batch_time=0.94098 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 3.61694 (QuantReg: 13.38053) QuantErr: 13.38053 batch_time=1.11569 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 4.15106 (QuantReg: 13.16499) QuantErr: 13.16499 batch_time=1.08666 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 3.24658 (QuantReg: 12.85588) QuantErr: 12.85588 batch_time=1.05504 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 3.22548 (QuantReg: 13.37998) QuantErr: 13.37998 batch_time=2.48501 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 3.26831 (QuantReg: 13.38376) QuantErr: 13.38376 batch_time=0.97579 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 3.44257 (QuantReg: 13.21860) QuantErr: 13.21860 batch_time=0.94512 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 3.48861 (QuantReg: 13.44592) QuantErr: 13.44592 batch_time=1.02607 
Train Epoch: 41 codebook_update_time=7.53394
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch41.pth ...
Done in 4.197s
removing stale ckpt [epoch 40] [took 0.03s]
 epoch          : 41
 loss           : 3.5761882305145263
 quant_reg      : 13.14950467300415
 quant_err      : 13.14950467300415
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.003
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.97611407260271
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1435
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.54542177482628
 mnt_best       : 45.21919867978011
 not_improved_count: 2
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 3.12335 (QuantReg: 13.14185) QuantErr: 13.14185 batch_time=27.58593 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 2.80730 (QuantReg: 13.38102) QuantErr: 13.38102 batch_time=0.90311 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 3.38230 (QuantReg: 12.95306) QuantErr: 12.95306 batch_time=0.93760 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 3.24998 (QuantReg: 13.11795) QuantErr: 13.11795 batch_time=0.96218 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 3.30327 (QuantReg: 12.95921) QuantErr: 12.95921 batch_time=0.88447 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 2.80106 (QuantReg: 13.10071) QuantErr: 13.10071 batch_time=0.88061 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 3.11059 (QuantReg: 12.98003) QuantErr: 12.98003 batch_time=2.72196 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 4.01251 (QuantReg: 12.75166) QuantErr: 12.75166 batch_time=0.94807 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 2.82683 (QuantReg: 13.20715) QuantErr: 13.20715 batch_time=1.37364 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 3.37621 (QuantReg: 13.31649) QuantErr: 13.31649 batch_time=1.12871 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 4.21718 (QuantReg: 13.15110) QuantErr: 13.15110 batch_time=0.95538 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 2.90691 (QuantReg: 13.35369) QuantErr: 13.35369 batch_time=0.97995 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 3.03192 (QuantReg: 13.43571) QuantErr: 13.43571 batch_time=0.89787 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 3.18076 (QuantReg: 13.31848) QuantErr: 13.31848 batch_time=0.93951 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 3.91697 (QuantReg: 12.90467) QuantErr: 12.90467 batch_time=0.92482 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 3.69296 (QuantReg: 13.42628) QuantErr: 13.42628 batch_time=2.33858 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 3.92348 (QuantReg: 13.10464) QuantErr: 13.10464 batch_time=0.95411 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 3.47719 (QuantReg: 12.97779) QuantErr: 12.97779 batch_time=1.11545 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 3.65190 (QuantReg: 13.37212) QuantErr: 13.37212 batch_time=1.05986 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 3.42232 (QuantReg: 13.22513) QuantErr: 13.22513 batch_time=1.57472 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 4.27827 (QuantReg: 13.13806) QuantErr: 13.13806 batch_time=0.92864 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 3.20351 (QuantReg: 13.33823) QuantErr: 13.33823 batch_time=0.92523 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 3.06226 (QuantReg: 13.36523) QuantErr: 13.36523 batch_time=1.13321 
Train Epoch: 42 codebook_update_time=7.98505
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch42.pth ...
Done in 4.658s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 3.5432948389053345
 quant_reg      : 13.163529106140137
 quant_err      : 13.163529106140137
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.684
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.106299458501645
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0735
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.58280778232793
 mnt_best       : 45.21919867978011
 not_improved_count: 3
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 4.25145 (QuantReg: 13.50945) QuantErr: 13.50945 batch_time=30.83598 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 3.15529 (QuantReg: 13.08830) QuantErr: 13.08830 batch_time=0.89622 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 3.23683 (QuantReg: 13.20878) QuantErr: 13.20878 batch_time=1.03613 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 4.57072 (QuantReg: 13.24494) QuantErr: 13.24494 batch_time=0.89959 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 3.72615 (QuantReg: 13.32053) QuantErr: 13.32053 batch_time=0.97625 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 3.32294 (QuantReg: 13.28984) QuantErr: 13.28984 batch_time=0.92511 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 2.82758 (QuantReg: 13.12190) QuantErr: 13.12190 batch_time=1.08232 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 3.82255 (QuantReg: 12.77496) QuantErr: 12.77496 batch_time=0.93091 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 4.54539 (QuantReg: 13.28600) QuantErr: 13.28600 batch_time=0.90529 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 2.76472 (QuantReg: 13.30197) QuantErr: 13.30197 batch_time=0.94427 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 3.51489 (QuantReg: 13.21445) QuantErr: 13.21445 batch_time=0.90243 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 4.42963 (QuantReg: 13.02300) QuantErr: 13.02300 batch_time=1.03959 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 3.59699 (QuantReg: 13.04272) QuantErr: 13.04272 batch_time=1.48725 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 3.66652 (QuantReg: 13.30344) QuantErr: 13.30344 batch_time=0.93461 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 3.54698 (QuantReg: 13.15873) QuantErr: 13.15873 batch_time=0.99640 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 3.19637 (QuantReg: 13.30086) QuantErr: 13.30086 batch_time=1.04547 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 4.20394 (QuantReg: 12.91105) QuantErr: 12.91105 batch_time=1.00773 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 3.71144 (QuantReg: 13.13309) QuantErr: 13.13309 batch_time=1.07607 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 3.41597 (QuantReg: 13.15289) QuantErr: 13.15289 batch_time=1.00933 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 3.62884 (QuantReg: 13.06505) QuantErr: 13.06505 batch_time=1.06132 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 4.25035 (QuantReg: 13.40760) QuantErr: 13.40760 batch_time=0.98758 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 3.31715 (QuantReg: 13.24430) QuantErr: 13.24430 batch_time=0.94967 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 3.52011 (QuantReg: 13.31435) QuantErr: 13.31435 batch_time=0.96644 
Train Epoch: 43 codebook_update_time=7.78043
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch43.pth ...
Done in 4.851s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 3.5447790994644164
 quant_reg      : 13.17527487564087
 quant_err      : 13.17527487564087
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.958
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.12297556160665
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0855
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.023376429756645
 mnt_best       : 45.21919867978011
 not_improved_count: 4
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 3.30822 (QuantReg: 13.59188) QuantErr: 13.59188 batch_time=31.33638 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 3.63618 (QuantReg: 13.16215) QuantErr: 13.16215 batch_time=1.03326 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 3.32981 (QuantReg: 13.16633) QuantErr: 13.16633 batch_time=1.18325 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 3.54891 (QuantReg: 13.17131) QuantErr: 13.17131 batch_time=0.96527 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 3.18575 (QuantReg: 13.39802) QuantErr: 13.39802 batch_time=0.91986 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 4.03359 (QuantReg: 13.36213) QuantErr: 13.36213 batch_time=0.93997 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 3.47457 (QuantReg: 13.24192) QuantErr: 13.24192 batch_time=0.92256 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 3.82672 (QuantReg: 13.22189) QuantErr: 13.22189 batch_time=0.90601 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 3.13768 (QuantReg: 13.28539) QuantErr: 13.28539 batch_time=0.90029 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 3.15029 (QuantReg: 13.19956) QuantErr: 13.19956 batch_time=0.89564 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 3.39703 (QuantReg: 13.57284) QuantErr: 13.57284 batch_time=1.69270 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 3.77384 (QuantReg: 13.19140) QuantErr: 13.19140 batch_time=0.90464 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 3.86943 (QuantReg: 12.99119) QuantErr: 12.99119 batch_time=0.91205 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 3.47847 (QuantReg: 13.11806) QuantErr: 13.11806 batch_time=0.92764 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 3.39718 (QuantReg: 13.09034) QuantErr: 13.09034 batch_time=0.92064 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 4.08049 (QuantReg: 13.31424) QuantErr: 13.31424 batch_time=1.07298 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 3.67908 (QuantReg: 13.14542) QuantErr: 13.14542 batch_time=1.03825 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 3.63855 (QuantReg: 12.76203) QuantErr: 12.76203 batch_time=1.13771 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 4.67910 (QuantReg: 13.10961) QuantErr: 13.10961 batch_time=0.97162 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 3.99634 (QuantReg: 13.01648) QuantErr: 13.01648 batch_time=0.97012 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 2.50762 (QuantReg: 13.11925) QuantErr: 13.11925 batch_time=0.90984 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 3.76834 (QuantReg: 12.93968) QuantErr: 12.93968 batch_time=0.91405 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 3.15963 (QuantReg: 13.30885) QuantErr: 13.30885 batch_time=1.09721 
Train Epoch: 44 codebook_update_time=7.81795
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch44.pth ...
Done in 6.257s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch44.pth ...
Done in 10.277s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 3.5126656827926634
 quant_reg      : 13.226684432983399
 quant_err      : 13.226684432983399
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.944
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.62298507145925
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.989
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.491653099951776
 mnt_best       : 45.62298507145925
 not_improved_count: 0
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 3.25332 (QuantReg: 13.21374) QuantErr: 13.21374 batch_time=27.99140 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 3.68242 (QuantReg: 13.10530) QuantErr: 13.10530 batch_time=0.91582 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 3.49933 (QuantReg: 13.46687) QuantErr: 13.46687 batch_time=0.96095 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 3.09431 (QuantReg: 13.42730) QuantErr: 13.42730 batch_time=0.92618 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 2.86532 (QuantReg: 13.28229) QuantErr: 13.28229 batch_time=1.03561 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 3.99577 (QuantReg: 13.38519) QuantErr: 13.38519 batch_time=1.19410 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 3.15217 (QuantReg: 13.07718) QuantErr: 13.07718 batch_time=2.66580 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 3.11288 (QuantReg: 13.47564) QuantErr: 13.47564 batch_time=0.93647 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 3.40271 (QuantReg: 13.25223) QuantErr: 13.25223 batch_time=0.89845 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 3.91423 (QuantReg: 13.39456) QuantErr: 13.39456 batch_time=0.90608 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 4.15003 (QuantReg: 13.18806) QuantErr: 13.18806 batch_time=0.92974 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 3.47017 (QuantReg: 13.21875) QuantErr: 13.21875 batch_time=0.90984 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 3.91355 (QuantReg: 13.04891) QuantErr: 13.04891 batch_time=0.95473 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 3.87288 (QuantReg: 13.50093) QuantErr: 13.50093 batch_time=1.08035 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 3.79255 (QuantReg: 13.39832) QuantErr: 13.39832 batch_time=1.14107 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 3.86931 (QuantReg: 13.34583) QuantErr: 13.34583 batch_time=1.04624 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 3.03548 (QuantReg: 13.51462) QuantErr: 13.51462 batch_time=0.94461 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 3.30576 (QuantReg: 13.47528) QuantErr: 13.47528 batch_time=0.92218 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 3.64419 (QuantReg: 13.30831) QuantErr: 13.30831 batch_time=0.93077 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 4.13814 (QuantReg: 13.21225) QuantErr: 13.21225 batch_time=0.93693 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 2.97046 (QuantReg: 13.21584) QuantErr: 13.21584 batch_time=0.94381 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 3.52937 (QuantReg: 12.95034) QuantErr: 12.95034 batch_time=0.92719 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 4.34722 (QuantReg: 13.33858) QuantErr: 13.33858 batch_time=1.00382 
Train Epoch: 45 codebook_update_time=8.17506
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch45.pth ...
Done in 5.678s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 3.4364921312332153
 quant_reg      : 13.229782161712647
 quant_err      : 13.229782161712647
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.493
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.104162001207285
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.437
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.09821485237977
 mnt_best       : 45.62298507145925
 not_improved_count: 1
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 3.23907 (QuantReg: 13.32171) QuantErr: 13.32171 batch_time=28.91750 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 3.16586 (QuantReg: 13.43855) QuantErr: 13.43855 batch_time=0.94114 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 3.44492 (QuantReg: 13.30096) QuantErr: 13.30096 batch_time=1.01380 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 2.95954 (QuantReg: 13.45648) QuantErr: 13.45648 batch_time=0.96295 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 4.06830 (QuantReg: 13.33578) QuantErr: 13.33578 batch_time=0.98489 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 3.45961 (QuantReg: 13.19546) QuantErr: 13.19546 batch_time=0.93327 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 3.47111 (QuantReg: 13.10040) QuantErr: 13.10040 batch_time=1.22171 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 2.83040 (QuantReg: 13.41075) QuantErr: 13.41075 batch_time=1.03230 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 3.38262 (QuantReg: 12.93720) QuantErr: 12.93720 batch_time=1.07665 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 3.72895 (QuantReg: 12.95343) QuantErr: 12.95343 batch_time=0.90300 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 3.01191 (QuantReg: 13.00882) QuantErr: 13.00882 batch_time=0.94309 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 3.62234 (QuantReg: 13.19901) QuantErr: 13.19901 batch_time=1.00620 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 3.40656 (QuantReg: 13.22085) QuantErr: 13.22085 batch_time=1.50290 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 3.41768 (QuantReg: 13.05849) QuantErr: 13.05849 batch_time=1.62859 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 4.52937 (QuantReg: 13.09313) QuantErr: 13.09313 batch_time=1.02143 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 3.71080 (QuantReg: 13.20214) QuantErr: 13.20214 batch_time=1.16677 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 2.85147 (QuantReg: 13.20433) QuantErr: 13.20433 batch_time=1.04911 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 3.88779 (QuantReg: 13.05802) QuantErr: 13.05802 batch_time=0.89254 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 4.08181 (QuantReg: 13.16493) QuantErr: 13.16493 batch_time=1.05059 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 3.52869 (QuantReg: 13.46456) QuantErr: 13.46456 batch_time=5.89613 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 3.71147 (QuantReg: 13.21243) QuantErr: 13.21243 batch_time=0.92635 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 3.13176 (QuantReg: 13.05563) QuantErr: 13.05563 batch_time=1.07792 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 4.11509 (QuantReg: 13.56356) QuantErr: 13.56356 batch_time=0.99241 
Train Epoch: 46 codebook_update_time=8.07962
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch46.pth ...
Done in 5.641s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 3.462521718978882
 quant_reg      : 13.238689632415772
 quant_err      : 13.238689632415772
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.198
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.989868665696925
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.834
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.72313212354036
 mnt_best       : 45.62298507145925
 not_improved_count: 2
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 3.51573 (QuantReg: 13.26091) QuantErr: 13.26091 batch_time=32.30133 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 4.11628 (QuantReg: 13.08951) QuantErr: 13.08951 batch_time=1.06201 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 2.92848 (QuantReg: 13.29974) QuantErr: 13.29974 batch_time=1.06852 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 2.10777 (QuantReg: 13.51897) QuantErr: 13.51897 batch_time=0.93837 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 3.17984 (QuantReg: 13.38097) QuantErr: 13.38097 batch_time=0.94567 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 3.22505 (QuantReg: 13.23912) QuantErr: 13.23912 batch_time=1.00053 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 3.04642 (QuantReg: 13.37578) QuantErr: 13.37578 batch_time=0.96469 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 3.19630 (QuantReg: 13.32726) QuantErr: 13.32726 batch_time=0.92510 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 3.52589 (QuantReg: 13.29261) QuantErr: 13.29261 batch_time=0.91647 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 3.35725 (QuantReg: 13.27195) QuantErr: 13.27195 batch_time=0.93964 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 3.46916 (QuantReg: 13.23694) QuantErr: 13.23694 batch_time=0.93447 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 3.89527 (QuantReg: 13.27824) QuantErr: 13.27824 batch_time=0.92168 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 3.37274 (QuantReg: 13.17088) QuantErr: 13.17088 batch_time=0.90839 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 3.64269 (QuantReg: 13.10041) QuantErr: 13.10041 batch_time=0.89852 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 4.24897 (QuantReg: 13.01589) QuantErr: 13.01589 batch_time=1.00119 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 2.85881 (QuantReg: 13.32548) QuantErr: 13.32548 batch_time=1.15383 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 3.61768 (QuantReg: 13.33953) QuantErr: 13.33953 batch_time=1.06910 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 4.03192 (QuantReg: 13.03801) QuantErr: 13.03801 batch_time=0.90570 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 2.59977 (QuantReg: 13.12350) QuantErr: 13.12350 batch_time=1.11219 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 3.02226 (QuantReg: 13.27839) QuantErr: 13.27839 batch_time=2.41957 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 4.03370 (QuantReg: 12.98043) QuantErr: 12.98043 batch_time=1.06440 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 4.08875 (QuantReg: 13.47315) QuantErr: 13.47315 batch_time=0.95312 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 3.51110 (QuantReg: 13.41688) QuantErr: 13.41688 batch_time=0.96252 
Train Epoch: 47 codebook_update_time=7.63868
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch47.pth ...
Done in 3.866s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch47.pth ...
Done in 7.718s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 3.499583640098572
 quant_reg      : 13.262921760559083
 quant_err      : 13.262921760559083
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.57
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.93980942930089
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.382
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.79635879342914
 mnt_best       : 45.93980942930089
 not_improved_count: 0
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 3.83018 (QuantReg: 12.91924) QuantErr: 12.91924 batch_time=29.08191 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 3.14002 (QuantReg: 13.58109) QuantErr: 13.58109 batch_time=0.94481 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 4.31941 (QuantReg: 13.23496) QuantErr: 13.23496 batch_time=0.92046 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 3.73339 (QuantReg: 13.35152) QuantErr: 13.35152 batch_time=0.92328 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 4.10701 (QuantReg: 13.24703) QuantErr: 13.24703 batch_time=1.02511 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 3.26311 (QuantReg: 13.19965) QuantErr: 13.19965 batch_time=0.93233 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 3.12489 (QuantReg: 13.07614) QuantErr: 13.07614 batch_time=1.00733 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 3.17522 (QuantReg: 13.39318) QuantErr: 13.39318 batch_time=1.72293 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 3.71455 (QuantReg: 13.50822) QuantErr: 13.50822 batch_time=0.98568 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 3.68535 (QuantReg: 13.24876) QuantErr: 13.24876 batch_time=0.90474 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 3.26968 (QuantReg: 12.98429) QuantErr: 12.98429 batch_time=0.90132 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 4.08287 (QuantReg: 13.13104) QuantErr: 13.13104 batch_time=0.89331 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 3.63431 (QuantReg: 13.04475) QuantErr: 13.04475 batch_time=0.92113 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 3.32785 (QuantReg: 13.36051) QuantErr: 13.36051 batch_time=4.05466 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 3.36781 (QuantReg: 13.39165) QuantErr: 13.39165 batch_time=0.89155 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 3.56957 (QuantReg: 13.34882) QuantErr: 13.34882 batch_time=0.93876 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 3.07044 (QuantReg: 13.09107) QuantErr: 13.09107 batch_time=0.94809 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 3.43551 (QuantReg: 13.36518) QuantErr: 13.36518 batch_time=0.89214 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 4.14527 (QuantReg: 12.90218) QuantErr: 12.90218 batch_time=1.15792 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 3.90938 (QuantReg: 12.88511) QuantErr: 12.88511 batch_time=1.10476 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 3.53234 (QuantReg: 13.30463) QuantErr: 13.30463 batch_time=0.93128 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 3.51434 (QuantReg: 13.52131) QuantErr: 13.52131 batch_time=0.90023 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 3.37926 (QuantReg: 13.39226) QuantErr: 13.39226 batch_time=0.97418 
Train Epoch: 48 codebook_update_time=8.12924
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch48.pth ...
Done in 21.306s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 3.5200800561904906
 quant_reg      : 13.256350471496582
 quant_err      : 13.256350471496582
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.251
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.40794494399006
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.472
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.66403905056946
 mnt_best       : 45.93980942930089
 not_improved_count: 1
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 2.62274 (QuantReg: 13.29259) QuantErr: 13.29259 batch_time=33.71341 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 3.31194 (QuantReg: 13.17885) QuantErr: 13.17885 batch_time=1.06798 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 3.31636 (QuantReg: 13.37077) QuantErr: 13.37077 batch_time=0.95622 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 3.50374 (QuantReg: 13.32089) QuantErr: 13.32089 batch_time=0.94134 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 4.01781 (QuantReg: 13.23602) QuantErr: 13.23602 batch_time=0.94679 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 4.49981 (QuantReg: 13.13647) QuantErr: 13.13647 batch_time=0.94482 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 2.92736 (QuantReg: 13.35099) QuantErr: 13.35099 batch_time=0.89139 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 2.92824 (QuantReg: 13.49948) QuantErr: 13.49948 batch_time=1.01915 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 3.91973 (QuantReg: 13.33646) QuantErr: 13.33646 batch_time=0.93765 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 3.21052 (QuantReg: 13.19676) QuantErr: 13.19676 batch_time=0.91132 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 2.61923 (QuantReg: 13.25648) QuantErr: 13.25648 batch_time=0.92051 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 3.40615 (QuantReg: 13.31726) QuantErr: 13.31726 batch_time=0.91663 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 3.49349 (QuantReg: 13.09250) QuantErr: 13.09250 batch_time=0.89032 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 4.37951 (QuantReg: 13.10256) QuantErr: 13.10256 batch_time=0.92938 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 3.58648 (QuantReg: 13.13097) QuantErr: 13.13097 batch_time=0.90422 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 3.29807 (QuantReg: 13.40630) QuantErr: 13.40630 batch_time=0.94354 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 4.14836 (QuantReg: 13.01139) QuantErr: 13.01139 batch_time=0.98415 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 3.24099 (QuantReg: 13.08668) QuantErr: 13.08668 batch_time=0.88959 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 3.55876 (QuantReg: 13.46935) QuantErr: 13.46935 batch_time=1.13052 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 3.97679 (QuantReg: 12.85636) QuantErr: 12.85636 batch_time=0.97256 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 4.36844 (QuantReg: 13.14706) QuantErr: 13.14706 batch_time=1.00245 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 3.61029 (QuantReg: 13.31523) QuantErr: 13.31523 batch_time=0.93294 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 3.54362 (QuantReg: 13.40724) QuantErr: 13.40724 batch_time=0.93924 
Train Epoch: 49 codebook_update_time=8.24386
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch49.pth ...
Done in 3.898s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 3.44716545009613
 quant_reg      : 13.293890560150146
 quant_err      : 13.293890560150146
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.677
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.647919163904184
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.515
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.303471790192155
 mnt_best       : 45.93980942930089
 not_improved_count: 2
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 3.51451 (QuantReg: 13.38239) QuantErr: 13.38239 batch_time=30.20018 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 3.17363 (QuantReg: 13.05700) QuantErr: 13.05700 batch_time=0.92967 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 3.39605 (QuantReg: 13.15199) QuantErr: 13.15199 batch_time=1.07221 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 3.70251 (QuantReg: 13.10702) QuantErr: 13.10702 batch_time=0.89854 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 3.82977 (QuantReg: 13.14491) QuantErr: 13.14491 batch_time=0.91338 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 4.24567 (QuantReg: 13.29744) QuantErr: 13.29744 batch_time=0.91224 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 3.50429 (QuantReg: 13.34642) QuantErr: 13.34642 batch_time=1.50222 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 3.13725 (QuantReg: 13.14545) QuantErr: 13.14545 batch_time=0.92031 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 3.41473 (QuantReg: 13.26449) QuantErr: 13.26449 batch_time=1.81813 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 3.25594 (QuantReg: 13.39234) QuantErr: 13.39234 batch_time=0.90661 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 3.16167 (QuantReg: 12.98678) QuantErr: 12.98678 batch_time=0.93934 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 3.08466 (QuantReg: 13.39136) QuantErr: 13.39136 batch_time=1.13629 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 2.75466 (QuantReg: 13.30889) QuantErr: 13.30889 batch_time=1.39373 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 4.22276 (QuantReg: 13.15212) QuantErr: 13.15212 batch_time=0.90009 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 4.27291 (QuantReg: 13.38344) QuantErr: 13.38344 batch_time=1.02047 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 4.13663 (QuantReg: 13.37368) QuantErr: 13.37368 batch_time=0.94663 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 2.97903 (QuantReg: 13.48151) QuantErr: 13.48151 batch_time=0.93100 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 3.49821 (QuantReg: 13.31241) QuantErr: 13.31241 batch_time=0.90200 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 3.66879 (QuantReg: 13.44985) QuantErr: 13.44985 batch_time=0.94957 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 3.20726 (QuantReg: 13.63766) QuantErr: 13.63766 batch_time=2.07808 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 4.20248 (QuantReg: 13.56162) QuantErr: 13.56162 batch_time=0.95920 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 3.63809 (QuantReg: 13.09755) QuantErr: 13.09755 batch_time=0.96945 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 3.74621 (QuantReg: 13.19599) QuantErr: 13.19599 batch_time=0.98879 
Train Epoch: 50 codebook_update_time=8.43237
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/checkpoint-epoch50.pth ...
Done in 5.034s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 3.4909292659759523
 quant_reg      : 13.293274620056152
 quant_err      : 13.293274620056152
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.863
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.50276564051144
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.128
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.92274208708112
 mnt_best       : 45.93980942930089
 not_improved_count: 3
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/trained_model.pth ...
Ckpt loaded at epoch 47.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 26.2
 t2v_metrics/R5/final_eval: 54.5
 t2v_metrics/R10/final_eval: 67.9
 t2v_metrics/R50/final_eval: 88.0
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 27.57
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 45.93980942930089
 v2t_metrics/R1/final_eval: 25.0
 v2t_metrics/R5/final_eval: 55.6
 v2t_metrics/R10/final_eval: 69.1
 v2t_metrics/R50/final_eval: 90.0
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 24.381
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 45.79635879342914
Best epoch for the monitored metric: 47
Script took 05h06m40s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L31/trained_model.pth
