Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 974.5945658683777 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 87.90278005599976 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 63.44787096977234 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch0.pth ...
Done in 1.836s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch0.pth ...
Done in 4.031s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 486.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 496.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 6.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 509.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.537
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.5192494101851104
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 10.02876 (QuantReg: 22.49989) QuantErr: 22.49989 batch_time=32.58669 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 9.02484 (QuantReg: 22.41601) QuantErr: 22.41601 batch_time=0.54696 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.71158 (QuantReg: 22.53222) QuantErr: 22.53222 batch_time=0.56557 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.39254 (QuantReg: 22.49412) QuantErr: 22.49412 batch_time=0.52268 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.48074 (QuantReg: 22.53743) QuantErr: 22.53743 batch_time=0.57367 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 5.80397 (QuantReg: 22.53082) QuantErr: 22.53082 batch_time=0.58207 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.86857 (QuantReg: 22.50875) QuantErr: 22.50875 batch_time=0.62730 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 4.93898 (QuantReg: 22.52799) QuantErr: 22.52799 batch_time=0.55227 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.38216 (QuantReg: 22.52645) QuantErr: 22.52645 batch_time=0.59547 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.29039 (QuantReg: 22.52378) QuantErr: 22.52378 batch_time=0.53073 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 4.72509 (QuantReg: 22.54294) QuantErr: 22.54294 batch_time=0.54195 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 4.66611 (QuantReg: 22.56499) QuantErr: 22.56499 batch_time=0.59734 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.02625 (QuantReg: 22.53927) QuantErr: 22.53927 batch_time=3.84415 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.20085 (QuantReg: 22.57690) QuantErr: 22.57690 batch_time=0.57553 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.69292 (QuantReg: 22.52621) QuantErr: 22.52621 batch_time=0.56940 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.05884 (QuantReg: 22.55178) QuantErr: 22.55178 batch_time=0.60380 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.79348 (QuantReg: 22.52709) QuantErr: 22.52709 batch_time=0.83168 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.55102 (QuantReg: 22.51549) QuantErr: 22.51549 batch_time=0.58941 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.14414 (QuantReg: 22.51702) QuantErr: 22.51702 batch_time=0.53123 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.41579 (QuantReg: 22.56558) QuantErr: 22.56558 batch_time=0.55037 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 3.56396 (QuantReg: 22.60607) QuantErr: 22.60607 batch_time=0.53757 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.08674 (QuantReg: 22.57864) QuantErr: 22.57864 batch_time=0.53112 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.72783 (QuantReg: 22.61997) QuantErr: 22.61997 batch_time=0.56769 
Train Epoch: 1 codebook_update_time=2.34507
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch1.pth ...
Done in 4.390s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch1.pth ...
Done in 16.115s
 epoch          : 1
 loss           : 5.365193214416504
 quant_reg      : 22.532890480041505
 quant_err      : 22.532890480041505
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 31.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 46.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 78.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 43.075
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.453195662947756
 MSRVTT_jsfusion_test/v2t_metrics/R1: 10.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 32.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 46.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 78.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 40.0315
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.09479953422108
 mnt_best       : 24.453195662947756
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.15948 (QuantReg: 9.01939) QuantErr: 9.01939 batch_time=39.54104 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 3.90411 (QuantReg: 8.98873) QuantErr: 8.98873 batch_time=0.56201 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.04051 (QuantReg: 9.68902) QuantErr: 9.68902 batch_time=0.52638 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.80909 (QuantReg: 9.58694) QuantErr: 9.58694 batch_time=0.57870 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.88675 (QuantReg: 10.31475) QuantErr: 10.31475 batch_time=0.62533 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 3.82945 (QuantReg: 10.18469) QuantErr: 10.18469 batch_time=0.52743 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 3.64430 (QuantReg: 9.99830) QuantErr: 9.99830 batch_time=0.52518 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.74978 (QuantReg: 10.43515) QuantErr: 10.43515 batch_time=0.52352 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 3.63979 (QuantReg: 10.70087) QuantErr: 10.70087 batch_time=0.81807 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.25690 (QuantReg: 10.08051) QuantErr: 10.08051 batch_time=0.55641 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.68227 (QuantReg: 10.37638) QuantErr: 10.37638 batch_time=0.52734 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.10885 (QuantReg: 10.76155) QuantErr: 10.76155 batch_time=0.55080 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.48231 (QuantReg: 10.85149) QuantErr: 10.85149 batch_time=0.51740 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.00083 (QuantReg: 10.86836) QuantErr: 10.86836 batch_time=0.58952 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.87478 (QuantReg: 11.01954) QuantErr: 11.01954 batch_time=0.61262 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.41617 (QuantReg: 11.19603) QuantErr: 11.19603 batch_time=0.68369 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.75723 (QuantReg: 11.05264) QuantErr: 11.05264 batch_time=0.56341 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.51556 (QuantReg: 11.51578) QuantErr: 11.51578 batch_time=0.57777 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.24760 (QuantReg: 11.75384) QuantErr: 11.75384 batch_time=0.54603 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.23895 (QuantReg: 11.88455) QuantErr: 11.88455 batch_time=0.53621 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.40373 (QuantReg: 11.77323) QuantErr: 11.77323 batch_time=0.50470 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.53068 (QuantReg: 11.61518) QuantErr: 11.61518 batch_time=0.56016 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.67777 (QuantReg: 11.68677) QuantErr: 11.68677 batch_time=5.20641 
Train Epoch: 2 codebook_update_time=1.83275
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch2.pth ...
Done in 12.701s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch2.pth ...
Done in 17.133s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 3.6479547595977784
 quant_reg      : 10.694982028961181
 quant_err      : 10.694982028961181
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 11.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 37.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 82.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.695
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.609824326315852
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 39.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 53.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 82.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.8465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.55621238539634
 mnt_best       : 28.609824326315852
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.20546 (QuantReg: 9.53543) QuantErr: 9.53543 batch_time=38.77961 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.07566 (QuantReg: 9.95069) QuantErr: 9.95069 batch_time=0.51554 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.42723 (QuantReg: 9.87097) QuantErr: 9.87097 batch_time=0.58399 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 2.84642 (QuantReg: 10.07668) QuantErr: 10.07668 batch_time=0.54514 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 2.85343 (QuantReg: 10.37559) QuantErr: 10.37559 batch_time=0.57817 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 2.42143 (QuantReg: 10.43814) QuantErr: 10.43814 batch_time=0.51946 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.65707 (QuantReg: 10.29533) QuantErr: 10.29533 batch_time=0.53576 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.46102 (QuantReg: 10.59333) QuantErr: 10.59333 batch_time=0.57251 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.38909 (QuantReg: 10.20278) QuantErr: 10.20278 batch_time=0.57181 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 2.55980 (QuantReg: 10.65861) QuantErr: 10.65861 batch_time=0.54250 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.46119 (QuantReg: 10.54830) QuantErr: 10.54830 batch_time=0.57097 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.04103 (QuantReg: 10.44193) QuantErr: 10.44193 batch_time=0.58587 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 2.78629 (QuantReg: 10.52778) QuantErr: 10.52778 batch_time=0.54315 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.29568 (QuantReg: 10.51325) QuantErr: 10.51325 batch_time=0.75789 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.44907 (QuantReg: 10.71007) QuantErr: 10.71007 batch_time=0.51326 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.73783 (QuantReg: 11.01702) QuantErr: 11.01702 batch_time=0.55896 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.20051 (QuantReg: 11.09759) QuantErr: 11.09759 batch_time=0.55871 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 2.76483 (QuantReg: 11.06096) QuantErr: 11.06096 batch_time=0.50683 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 2.87171 (QuantReg: 10.85855) QuantErr: 10.85855 batch_time=0.58984 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 2.95508 (QuantReg: 11.19415) QuantErr: 11.19415 batch_time=4.47558 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 2.98337 (QuantReg: 11.17523) QuantErr: 11.17523 batch_time=0.57523 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 2.95431 (QuantReg: 11.18961) QuantErr: 11.18961 batch_time=0.52919 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.10481 (QuantReg: 11.12600) QuantErr: 11.12600 batch_time=0.51761 
Train Epoch: 3 codebook_update_time=1.92719
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch3.pth ...
Done in 4.298s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch3.pth ...
Done in 8.483s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 3.078625859260559
 quant_reg      : 10.618713760375977
 quant_err      : 10.618713760375977
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.546
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.085669660685646
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.2825
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.06873637742349
 mnt_best       : 33.085669660685646
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 2.91472 (QuantReg: 10.22027) QuantErr: 10.22027 batch_time=35.23962 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.73816 (QuantReg: 10.55529) QuantErr: 10.55529 batch_time=2.95171 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.65411 (QuantReg: 10.60437) QuantErr: 10.60437 batch_time=1.09941 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.56435 (QuantReg: 10.80359) QuantErr: 10.80359 batch_time=0.52944 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.63032 (QuantReg: 11.03859) QuantErr: 11.03859 batch_time=0.54423 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 2.85089 (QuantReg: 10.73528) QuantErr: 10.73528 batch_time=0.53849 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.52292 (QuantReg: 10.60240) QuantErr: 10.60240 batch_time=1.79437 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.72803 (QuantReg: 10.77089) QuantErr: 10.77089 batch_time=0.58800 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 2.97776 (QuantReg: 10.61660) QuantErr: 10.61660 batch_time=0.55457 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.36617 (QuantReg: 11.06787) QuantErr: 11.06787 batch_time=0.57564 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 2.73273 (QuantReg: 11.65799) QuantErr: 11.65799 batch_time=0.55675 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.46418 (QuantReg: 11.64611) QuantErr: 11.64611 batch_time=0.59025 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 2.95755 (QuantReg: 11.17359) QuantErr: 11.17359 batch_time=1.02115 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.58087 (QuantReg: 11.39120) QuantErr: 11.39120 batch_time=1.43249 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.54330 (QuantReg: 11.37361) QuantErr: 11.37361 batch_time=0.51879 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.78453 (QuantReg: 11.30855) QuantErr: 11.30855 batch_time=0.56583 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.68865 (QuantReg: 11.23495) QuantErr: 11.23495 batch_time=0.59132 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.61322 (QuantReg: 11.38949) QuantErr: 11.38949 batch_time=0.55206 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.43275 (QuantReg: 11.62392) QuantErr: 11.62392 batch_time=0.55156 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.30748 (QuantReg: 11.57031) QuantErr: 11.57031 batch_time=1.07580 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.30041 (QuantReg: 11.85154) QuantErr: 11.85154 batch_time=0.57325 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.12594 (QuantReg: 12.10512) QuantErr: 12.10512 batch_time=0.53210 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.70719 (QuantReg: 11.67930) QuantErr: 11.67930 batch_time=0.53677 
Train Epoch: 4 codebook_update_time=2.23408
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch4.pth ...
Done in 11.351s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch4.pth ...
Done in 15.449s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 2.7689069385528566
 quant_reg      : 11.086144584655761
 quant_err      : 11.086144584655761
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.958
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.66765110199053
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.1165
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.415266803878396
 mnt_best       : 35.66765110199053
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.82022 (QuantReg: 10.71519) QuantErr: 10.71519 batch_time=35.89126 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.08755 (QuantReg: 11.03462) QuantErr: 11.03462 batch_time=0.52235 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.08917 (QuantReg: 11.04524) QuantErr: 11.04524 batch_time=0.56189 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.41003 (QuantReg: 11.10707) QuantErr: 11.10707 batch_time=0.57086 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.59800 (QuantReg: 11.20139) QuantErr: 11.20139 batch_time=0.51765 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.24213 (QuantReg: 11.29139) QuantErr: 11.29139 batch_time=0.55152 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.59154 (QuantReg: 11.11478) QuantErr: 11.11478 batch_time=0.51206 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 2.97436 (QuantReg: 10.70343) QuantErr: 10.70343 batch_time=0.50950 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.44099 (QuantReg: 11.47832) QuantErr: 11.47832 batch_time=0.56748 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.47591 (QuantReg: 11.13460) QuantErr: 11.13460 batch_time=1.22114 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.54874 (QuantReg: 11.51268) QuantErr: 11.51268 batch_time=0.53850 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.58132 (QuantReg: 11.29262) QuantErr: 11.29262 batch_time=0.57277 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.42397 (QuantReg: 11.73921) QuantErr: 11.73921 batch_time=0.54611 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.07607 (QuantReg: 11.45949) QuantErr: 11.45949 batch_time=0.53312 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.76115 (QuantReg: 11.49100) QuantErr: 11.49100 batch_time=0.56306 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.30961 (QuantReg: 11.74481) QuantErr: 11.74481 batch_time=0.96866 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.58854 (QuantReg: 11.45506) QuantErr: 11.45506 batch_time=0.60561 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.48894 (QuantReg: 11.58608) QuantErr: 11.58608 batch_time=0.51244 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.54435 (QuantReg: 11.84856) QuantErr: 11.84856 batch_time=1.52292 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.49249 (QuantReg: 11.74698) QuantErr: 11.74698 batch_time=0.54468 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.75506 (QuantReg: 11.72796) QuantErr: 11.72796 batch_time=0.50715 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.30029 (QuantReg: 11.76689) QuantErr: 11.76689 batch_time=0.57996 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.77683 (QuantReg: 11.80853) QuantErr: 11.80853 batch_time=0.56209 
Train Epoch: 5 codebook_update_time=2.18563
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch5.pth ...
Done in 4.092s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 2.49213094329834
 quant_reg      : 11.47167614364624
 quant_err      : 11.47167614364624
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.574
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.45639451954613
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.8905
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.45839608181488
 mnt_best       : 35.66765110199053
 not_improved_count: 1
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.62073 (QuantReg: 11.01402) QuantErr: 11.01402 batch_time=36.76708 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.63222 (QuantReg: 10.89770) QuantErr: 10.89770 batch_time=0.59714 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.40122 (QuantReg: 11.11276) QuantErr: 11.11276 batch_time=0.51079 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.34581 (QuantReg: 11.29353) QuantErr: 11.29353 batch_time=0.52478 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.16314 (QuantReg: 11.23720) QuantErr: 11.23720 batch_time=0.53330 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.14548 (QuantReg: 11.54247) QuantErr: 11.54247 batch_time=0.53507 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.69151 (QuantReg: 11.80203) QuantErr: 11.80203 batch_time=0.52602 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.35417 (QuantReg: 11.85767) QuantErr: 11.85767 batch_time=0.51763 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.34696 (QuantReg: 11.79883) QuantErr: 11.79883 batch_time=0.51486 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 1.99615 (QuantReg: 11.55888) QuantErr: 11.55888 batch_time=0.54658 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.17716 (QuantReg: 12.05142) QuantErr: 12.05142 batch_time=0.50402 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.21294 (QuantReg: 11.48416) QuantErr: 11.48416 batch_time=0.54908 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.12656 (QuantReg: 11.98695) QuantErr: 11.98695 batch_time=0.51451 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.18414 (QuantReg: 11.46620) QuantErr: 11.46620 batch_time=0.56674 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.48107 (QuantReg: 12.08366) QuantErr: 12.08366 batch_time=0.57102 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.32993 (QuantReg: 11.87683) QuantErr: 11.87683 batch_time=0.52454 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.12433 (QuantReg: 12.20901) QuantErr: 12.20901 batch_time=0.57461 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.44163 (QuantReg: 11.90924) QuantErr: 11.90924 batch_time=0.57434 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.55282 (QuantReg: 12.12537) QuantErr: 12.12537 batch_time=0.54566 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.40019 (QuantReg: 12.09247) QuantErr: 12.09247 batch_time=0.59841 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.16869 (QuantReg: 12.43141) QuantErr: 12.43141 batch_time=0.53680 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.01935 (QuantReg: 12.04833) QuantErr: 12.04833 batch_time=0.61289 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 1.93225 (QuantReg: 12.24376) QuantErr: 12.24376 batch_time=0.56480 
Train Epoch: 6 codebook_update_time=1.96785
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch6.pth ...
Done in 7.882s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch6.pth ...
Done in 12.407s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 2.3039336981773375
 quant_reg      : 11.816265438079833
 quant_err      : 11.816265438079833
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.971
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.34068017259891
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.3655
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.037598498179875
 mnt_best       : 37.34068017259891
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.32304 (QuantReg: 11.38595) QuantErr: 11.38595 batch_time=36.55312 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.32813 (QuantReg: 11.76931) QuantErr: 11.76931 batch_time=0.54239 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.07772 (QuantReg: 11.26183) QuantErr: 11.26183 batch_time=0.57973 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 1.87193 (QuantReg: 11.80820) QuantErr: 11.80820 batch_time=0.55405 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.00332 (QuantReg: 11.79894) QuantErr: 11.79894 batch_time=0.54201 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.08098 (QuantReg: 12.18635) QuantErr: 12.18635 batch_time=0.51569 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.21801 (QuantReg: 11.80910) QuantErr: 11.80910 batch_time=0.57894 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.07873 (QuantReg: 11.89858) QuantErr: 11.89858 batch_time=0.53553 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.16845 (QuantReg: 12.23880) QuantErr: 12.23880 batch_time=1.60733 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 1.78231 (QuantReg: 12.03247) QuantErr: 12.03247 batch_time=0.53623 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.63163 (QuantReg: 11.90342) QuantErr: 11.90342 batch_time=0.53223 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.04459 (QuantReg: 12.22876) QuantErr: 12.22876 batch_time=0.51668 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.03950 (QuantReg: 12.26177) QuantErr: 12.26177 batch_time=0.57657 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.23844 (QuantReg: 12.20332) QuantErr: 12.20332 batch_time=0.54846 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 1.56490 (QuantReg: 12.05758) QuantErr: 12.05758 batch_time=0.50817 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.19063 (QuantReg: 12.36848) QuantErr: 12.36848 batch_time=0.54485 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 1.71944 (QuantReg: 12.60380) QuantErr: 12.60380 batch_time=0.62334 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.31399 (QuantReg: 12.26746) QuantErr: 12.26746 batch_time=0.56850 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.61262 (QuantReg: 12.51473) QuantErr: 12.51473 batch_time=0.73434 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.48342 (QuantReg: 12.72585) QuantErr: 12.72585 batch_time=0.86154 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.01662 (QuantReg: 12.63237) QuantErr: 12.63237 batch_time=0.51484 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.09251 (QuantReg: 12.94096) QuantErr: 12.94096 batch_time=0.51125 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.16048 (QuantReg: 12.61533) QuantErr: 12.61533 batch_time=0.58742 
Train Epoch: 7 codebook_update_time=1.78637
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch7.pth ...
Done in 4.456s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch7.pth ...
Done in 8.801s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 2.1160386476516724
 quant_reg      : 12.179861724853515
 quant_err      : 12.179861724853515
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.494
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.80359418246868
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.1965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.93717689735291
 mnt_best       : 37.80359418246868
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.27425 (QuantReg: 12.02553) QuantErr: 12.02553 batch_time=35.02597 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.39587 (QuantReg: 12.08929) QuantErr: 12.08929 batch_time=0.55437 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.53578 (QuantReg: 12.16206) QuantErr: 12.16206 batch_time=4.01041 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.01781 (QuantReg: 11.88329) QuantErr: 11.88329 batch_time=0.52609 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.05025 (QuantReg: 12.40365) QuantErr: 12.40365 batch_time=0.53604 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 1.96983 (QuantReg: 12.08589) QuantErr: 12.08589 batch_time=0.56083 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 1.99371 (QuantReg: 12.42113) QuantErr: 12.42113 batch_time=0.57749 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.23675 (QuantReg: 12.55848) QuantErr: 12.55848 batch_time=0.54684 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.27441 (QuantReg: 12.34791) QuantErr: 12.34791 batch_time=0.51942 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.44005 (QuantReg: 12.49910) QuantErr: 12.49910 batch_time=0.55133 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.31231 (QuantReg: 12.49706) QuantErr: 12.49706 batch_time=1.03875 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.04941 (QuantReg: 12.34741) QuantErr: 12.34741 batch_time=0.50096 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.20833 (QuantReg: 12.40288) QuantErr: 12.40288 batch_time=0.51941 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.29362 (QuantReg: 12.87201) QuantErr: 12.87201 batch_time=0.54432 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.01464 (QuantReg: 12.87212) QuantErr: 12.87212 batch_time=0.60717 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 1.76018 (QuantReg: 12.23674) QuantErr: 12.23674 batch_time=0.57290 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 1.86714 (QuantReg: 12.42446) QuantErr: 12.42446 batch_time=0.57117 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.61638 (QuantReg: 12.47894) QuantErr: 12.47894 batch_time=0.56310 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.12674 (QuantReg: 12.50910) QuantErr: 12.50910 batch_time=0.56661 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.15788 (QuantReg: 12.25735) QuantErr: 12.25735 batch_time=2.04117 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.13896 (QuantReg: 12.68444) QuantErr: 12.68444 batch_time=0.57952 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 1.56086 (QuantReg: 12.76606) QuantErr: 12.76606 batch_time=0.54923 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.13084 (QuantReg: 12.78443) QuantErr: 12.78443 batch_time=0.85770 
Train Epoch: 8 codebook_update_time=2.08814
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch8.pth ...
Done in 4.304s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch8.pth ...
Done in 8.647s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 2.0277540111541748
 quant_reg      : 12.439874855041504
 quant_err      : 12.439874855041504
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.419
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.072724265521686
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.7
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.24025847198873
 mnt_best       : 39.072724265521686
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 1.66497 (QuantReg: 12.73631) QuantErr: 12.73631 batch_time=36.96553 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.10859 (QuantReg: 12.39280) QuantErr: 12.39280 batch_time=0.55532 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 1.64059 (QuantReg: 12.30936) QuantErr: 12.30936 batch_time=0.58717 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.10116 (QuantReg: 12.68623) QuantErr: 12.68623 batch_time=0.57019 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 1.91623 (QuantReg: 12.75368) QuantErr: 12.75368 batch_time=0.55402 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 1.63554 (QuantReg: 12.78493) QuantErr: 12.78493 batch_time=0.55276 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.63013 (QuantReg: 12.99095) QuantErr: 12.99095 batch_time=0.57482 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.88760 (QuantReg: 12.82943) QuantErr: 12.82943 batch_time=0.52108 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 1.96522 (QuantReg: 12.31941) QuantErr: 12.31941 batch_time=0.53443 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.81930 (QuantReg: 12.77526) QuantErr: 12.77526 batch_time=0.55033 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 1.89122 (QuantReg: 12.57127) QuantErr: 12.57127 batch_time=0.54524 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.58609 (QuantReg: 12.69921) QuantErr: 12.69921 batch_time=0.55073 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 1.93962 (QuantReg: 12.62312) QuantErr: 12.62312 batch_time=0.57839 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 1.76967 (QuantReg: 12.80263) QuantErr: 12.80263 batch_time=0.55752 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 1.98790 (QuantReg: 12.43595) QuantErr: 12.43595 batch_time=0.52331 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.62637 (QuantReg: 13.16329) QuantErr: 13.16329 batch_time=0.51669 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 1.99571 (QuantReg: 13.13731) QuantErr: 13.13731 batch_time=0.55473 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.31479 (QuantReg: 12.98221) QuantErr: 12.98221 batch_time=0.59082 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 1.83845 (QuantReg: 12.78280) QuantErr: 12.78280 batch_time=0.56060 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.94772 (QuantReg: 12.83359) QuantErr: 12.83359 batch_time=0.58386 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.62711 (QuantReg: 13.14478) QuantErr: 13.14478 batch_time=0.55044 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.76429 (QuantReg: 12.58054) QuantErr: 12.58054 batch_time=0.55695 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.75685 (QuantReg: 12.53851) QuantErr: 12.53851 batch_time=0.51949 
Train Epoch: 9 codebook_update_time=1.93809
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch9.pth ...
Done in 6.343s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch9.pth ...
Done in 11.307s
removing stale ckpt [epoch 8] [took 0.14s]
 epoch          : 9
 loss           : 1.8858279175758361
 quant_reg      : 12.679026329040527
 quant_err      : 12.679026329040527
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.195
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.90413961987165
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.379
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.89689110895558
 mnt_best       : 39.90413961987165
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.83536 (QuantReg: 12.70021) QuantErr: 12.70021 batch_time=38.36347 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 1.83956 (QuantReg: 12.53177) QuantErr: 12.53177 batch_time=0.54514 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.22245 (QuantReg: 12.90121) QuantErr: 12.90121 batch_time=0.57356 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 1.84333 (QuantReg: 12.40102) QuantErr: 12.40102 batch_time=0.54592 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 1.50370 (QuantReg: 12.52585) QuantErr: 12.52585 batch_time=0.55053 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 1.82718 (QuantReg: 12.83668) QuantErr: 12.83668 batch_time=0.56123 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.30870 (QuantReg: 12.23475) QuantErr: 12.23475 batch_time=0.53404 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 1.91640 (QuantReg: 12.71163) QuantErr: 12.71163 batch_time=0.59947 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 1.89934 (QuantReg: 12.49147) QuantErr: 12.49147 batch_time=0.53122 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 1.90205 (QuantReg: 12.75770) QuantErr: 12.75770 batch_time=0.61291 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.56679 (QuantReg: 12.75045) QuantErr: 12.75045 batch_time=0.56679 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 1.79643 (QuantReg: 12.95070) QuantErr: 12.95070 batch_time=0.52563 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 1.88890 (QuantReg: 12.63148) QuantErr: 12.63148 batch_time=2.36601 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.36613 (QuantReg: 13.34169) QuantErr: 13.34169 batch_time=0.58636 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.79354 (QuantReg: 12.66322) QuantErr: 12.66322 batch_time=0.55372 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 1.99482 (QuantReg: 13.12137) QuantErr: 13.12137 batch_time=0.56936 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 1.89505 (QuantReg: 12.93789) QuantErr: 12.93789 batch_time=0.54223 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 1.66087 (QuantReg: 13.18338) QuantErr: 13.18338 batch_time=0.53478 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.34416 (QuantReg: 13.16018) QuantErr: 13.16018 batch_time=0.56131 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.43864 (QuantReg: 13.52051) QuantErr: 13.52051 batch_time=2.47101 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.78009 (QuantReg: 12.96513) QuantErr: 12.96513 batch_time=0.55855 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 1.96358 (QuantReg: 12.96768) QuantErr: 12.96768 batch_time=0.60246 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 1.95551 (QuantReg: 13.28050) QuantErr: 13.28050 batch_time=0.54156 
Train Epoch: 10 codebook_update_time=2.11356
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch10.pth ...
Done in 19.957s
removing stale ckpt [epoch 9] [took 0.22s]
 epoch          : 10
 loss           : 1.786734960079193
 quant_reg      : 12.883144535064698
 quant_err      : 12.883144535064698
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.442
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.674754214065665
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.9315
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.01297427979136
 mnt_best       : 39.90413961987165
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 1.70539 (QuantReg: 12.60551) QuantErr: 12.60551 batch_time=37.81386 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.01646 (QuantReg: 12.52336) QuantErr: 12.52336 batch_time=0.50691 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 2.13373 (QuantReg: 12.82700) QuantErr: 12.82700 batch_time=0.58958 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 1.85542 (QuantReg: 12.97635) QuantErr: 12.97635 batch_time=0.51572 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.00358 (QuantReg: 12.85028) QuantErr: 12.85028 batch_time=0.60305 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 2.28389 (QuantReg: 13.56890) QuantErr: 13.56890 batch_time=0.53621 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 1.51295 (QuantReg: 13.13612) QuantErr: 13.13612 batch_time=0.54031 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 1.96856 (QuantReg: 12.67210) QuantErr: 12.67210 batch_time=0.53309 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.63807 (QuantReg: 13.08327) QuantErr: 13.08327 batch_time=0.62876 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.60363 (QuantReg: 13.31747) QuantErr: 13.31747 batch_time=0.54200 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.46718 (QuantReg: 13.27476) QuantErr: 13.27476 batch_time=0.55468 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.51049 (QuantReg: 13.03330) QuantErr: 13.03330 batch_time=0.61087 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 1.95212 (QuantReg: 13.07162) QuantErr: 13.07162 batch_time=0.57307 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.67777 (QuantReg: 13.15534) QuantErr: 13.15534 batch_time=0.60981 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.35537 (QuantReg: 13.37844) QuantErr: 13.37844 batch_time=0.53759 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.20181 (QuantReg: 12.86350) QuantErr: 12.86350 batch_time=0.52003 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.60148 (QuantReg: 13.40428) QuantErr: 13.40428 batch_time=0.55271 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.63646 (QuantReg: 13.53162) QuantErr: 13.53162 batch_time=0.61080 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.75089 (QuantReg: 12.92929) QuantErr: 12.92929 batch_time=0.57052 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.59376 (QuantReg: 13.35964) QuantErr: 13.35964 batch_time=0.52033 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.68100 (QuantReg: 13.16617) QuantErr: 13.16617 batch_time=0.58324 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.71937 (QuantReg: 13.46618) QuantErr: 13.46618 batch_time=0.55167 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.64961 (QuantReg: 13.57228) QuantErr: 13.57228 batch_time=0.55008 
Train Epoch: 11 codebook_update_time=1.89409
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch11.pth ...
Done in 5.939s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch11.pth ...
Done in 10.997s
removing stale ckpt [epoch 10] [took 0.21s]
 epoch          : 11
 loss           : 1.700813175201416
 quant_reg      : 13.151041416168212
 quant_err      : 13.151041416168212
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.144
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.932494108873875
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.1745
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.3541482499114
 mnt_best       : 40.932494108873875
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.53445 (QuantReg: 13.01768) QuantErr: 13.01768 batch_time=35.69703 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.61916 (QuantReg: 13.16354) QuantErr: 13.16354 batch_time=0.51212 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.73734 (QuantReg: 13.05319) QuantErr: 13.05319 batch_time=0.52837 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 1.94119 (QuantReg: 13.20445) QuantErr: 13.20445 batch_time=0.51996 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.55926 (QuantReg: 13.11301) QuantErr: 13.11301 batch_time=0.52876 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.61051 (QuantReg: 13.30202) QuantErr: 13.30202 batch_time=0.58337 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.65524 (QuantReg: 13.49623) QuantErr: 13.49623 batch_time=0.52819 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.77327 (QuantReg: 12.91685) QuantErr: 12.91685 batch_time=1.21759 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.73012 (QuantReg: 13.21727) QuantErr: 13.21727 batch_time=0.56185 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.45931 (QuantReg: 13.33764) QuantErr: 13.33764 batch_time=0.52760 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.50981 (QuantReg: 13.25101) QuantErr: 13.25101 batch_time=0.54439 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.40621 (QuantReg: 13.44068) QuantErr: 13.44068 batch_time=0.51108 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.48024 (QuantReg: 13.10738) QuantErr: 13.10738 batch_time=0.58516 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.60111 (QuantReg: 13.15454) QuantErr: 13.15454 batch_time=0.54235 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.97413 (QuantReg: 13.76062) QuantErr: 13.76062 batch_time=0.64146 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.54988 (QuantReg: 13.49907) QuantErr: 13.49907 batch_time=0.55800 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.79121 (QuantReg: 13.57594) QuantErr: 13.57594 batch_time=0.61103 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.27645 (QuantReg: 13.72522) QuantErr: 13.72522 batch_time=0.53724 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.85535 (QuantReg: 13.38056) QuantErr: 13.38056 batch_time=0.55190 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.33610 (QuantReg: 13.70567) QuantErr: 13.70567 batch_time=0.55182 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.26620 (QuantReg: 13.86208) QuantErr: 13.86208 batch_time=0.66088 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.72263 (QuantReg: 13.65953) QuantErr: 13.65953 batch_time=0.55849 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.46698 (QuantReg: 13.32895) QuantErr: 13.32895 batch_time=0.55228 
Train Epoch: 12 codebook_update_time=1.89137
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch12.pth ...
Done in 5.316s
removing stale ckpt [epoch 11] [took 0.09s]
 epoch          : 12
 loss           : 1.6315488271713257
 quant_reg      : 13.299734371185302
 quant_err      : 13.299734371185302
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.827
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.86923967589396
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.023
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.05104607686846
 mnt_best       : 40.932494108873875
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.70500 (QuantReg: 12.91316) QuantErr: 12.91316 batch_time=36.17541 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.13531 (QuantReg: 13.67617) QuantErr: 13.67617 batch_time=0.57943 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.55083 (QuantReg: 13.26554) QuantErr: 13.26554 batch_time=0.58028 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.26453 (QuantReg: 13.59634) QuantErr: 13.59634 batch_time=0.56105 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.72978 (QuantReg: 13.54667) QuantErr: 13.54667 batch_time=0.54747 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.72887 (QuantReg: 13.08155) QuantErr: 13.08155 batch_time=0.53712 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.61747 (QuantReg: 13.71927) QuantErr: 13.71927 batch_time=5.99802 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.68305 (QuantReg: 13.76252) QuantErr: 13.76252 batch_time=0.58123 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.55235 (QuantReg: 13.70761) QuantErr: 13.70761 batch_time=0.53310 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.39758 (QuantReg: 13.50022) QuantErr: 13.50022 batch_time=0.53404 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.48009 (QuantReg: 13.56337) QuantErr: 13.56337 batch_time=0.52934 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.31939 (QuantReg: 13.73066) QuantErr: 13.73066 batch_time=0.54275 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.61343 (QuantReg: 13.34625) QuantErr: 13.34625 batch_time=0.58141 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.59275 (QuantReg: 13.62960) QuantErr: 13.62960 batch_time=0.56703 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.28837 (QuantReg: 13.67068) QuantErr: 13.67068 batch_time=0.54496 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.84870 (QuantReg: 13.47408) QuantErr: 13.47408 batch_time=0.55620 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.51005 (QuantReg: 13.77838) QuantErr: 13.77838 batch_time=0.52368 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.69052 (QuantReg: 13.49655) QuantErr: 13.49655 batch_time=0.58206 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.34874 (QuantReg: 13.69231) QuantErr: 13.69231 batch_time=0.52737 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.73655 (QuantReg: 13.50677) QuantErr: 13.50677 batch_time=0.55775 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.24038 (QuantReg: 13.98494) QuantErr: 13.98494 batch_time=0.51673 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.56166 (QuantReg: 13.66071) QuantErr: 13.66071 batch_time=0.54823 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.80718 (QuantReg: 13.53470) QuantErr: 13.53470 batch_time=0.58618 
Train Epoch: 13 codebook_update_time=1.92827
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch13.pth ...
Done in 13.922s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch13.pth ...
Done in 19.775s
removing stale ckpt [epoch 12] [took 0.04s]
 epoch          : 13
 loss           : 1.5761362500190734
 quant_reg      : 13.515619247436524
 quant_err      : 13.515619247436524
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.643
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.19818463739063
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.98640830045152
 mnt_best       : 41.19818463739063
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.52009 (QuantReg: 13.61273) QuantErr: 13.61273 batch_time=35.88498 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.43019 (QuantReg: 13.42814) QuantErr: 13.42814 batch_time=0.61070 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.39790 (QuantReg: 13.59758) QuantErr: 13.59758 batch_time=0.56741 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.31997 (QuantReg: 13.64278) QuantErr: 13.64278 batch_time=0.57292 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.37733 (QuantReg: 13.62203) QuantErr: 13.62203 batch_time=0.75169 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.87899 (QuantReg: 13.20510) QuantErr: 13.20510 batch_time=0.57904 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.81115 (QuantReg: 13.58936) QuantErr: 13.58936 batch_time=0.52923 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.38216 (QuantReg: 13.52147) QuantErr: 13.52147 batch_time=0.53059 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.37040 (QuantReg: 13.21872) QuantErr: 13.21872 batch_time=0.56585 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.21307 (QuantReg: 13.59072) QuantErr: 13.59072 batch_time=0.55295 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 2.01638 (QuantReg: 13.47875) QuantErr: 13.47875 batch_time=0.59408 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.30608 (QuantReg: 13.70394) QuantErr: 13.70394 batch_time=0.57124 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.26445 (QuantReg: 13.85737) QuantErr: 13.85737 batch_time=0.55129 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.79142 (QuantReg: 13.38852) QuantErr: 13.38852 batch_time=0.63286 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.33578 (QuantReg: 13.71864) QuantErr: 13.71864 batch_time=0.56775 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.68312 (QuantReg: 13.58455) QuantErr: 13.58455 batch_time=0.53115 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.44554 (QuantReg: 13.89783) QuantErr: 13.89783 batch_time=0.55373 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.72181 (QuantReg: 13.63371) QuantErr: 13.63371 batch_time=0.55515 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.42007 (QuantReg: 13.90423) QuantErr: 13.90423 batch_time=0.56036 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.49241 (QuantReg: 13.51384) QuantErr: 13.51384 batch_time=2.42561 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.62587 (QuantReg: 13.58747) QuantErr: 13.58747 batch_time=0.51131 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.29473 (QuantReg: 14.39055) QuantErr: 14.39055 batch_time=0.53654 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.20252 (QuantReg: 14.05593) QuantErr: 14.05593 batch_time=0.51589 
Train Epoch: 14 codebook_update_time=1.80481
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch14.pth ...
Done in 5.063s
removing stale ckpt [epoch 13] [took 0.02s]
 epoch          : 14
 loss           : 1.5027634556293488
 quant_reg      : 13.64565140914917
 quant_err      : 13.64565140914917
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.799
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.69725847672348
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.587
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.64141339077035
 mnt_best       : 41.19818463739063
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.34774 (QuantReg: 13.62905) QuantErr: 13.62905 batch_time=38.23665 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.05461 (QuantReg: 13.70122) QuantErr: 13.70122 batch_time=0.52268 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.46680 (QuantReg: 13.74487) QuantErr: 13.74487 batch_time=0.56074 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.30899 (QuantReg: 13.40222) QuantErr: 13.40222 batch_time=0.56247 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.72009 (QuantReg: 13.72574) QuantErr: 13.72574 batch_time=0.57811 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.64707 (QuantReg: 13.70954) QuantErr: 13.70954 batch_time=0.55647 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.69769 (QuantReg: 14.10766) QuantErr: 14.10766 batch_time=0.50683 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.21158 (QuantReg: 13.72325) QuantErr: 13.72325 batch_time=0.54997 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.81709 (QuantReg: 13.99048) QuantErr: 13.99048 batch_time=0.56787 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.29388 (QuantReg: 13.93869) QuantErr: 13.93869 batch_time=0.56459 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.73020 (QuantReg: 13.84831) QuantErr: 13.84831 batch_time=0.59608 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.23055 (QuantReg: 14.14728) QuantErr: 14.14728 batch_time=0.53909 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.54012 (QuantReg: 13.92504) QuantErr: 13.92504 batch_time=0.55154 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.43096 (QuantReg: 13.85972) QuantErr: 13.85972 batch_time=4.85674 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.50951 (QuantReg: 13.89357) QuantErr: 13.89357 batch_time=0.59436 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.44039 (QuantReg: 13.79960) QuantErr: 13.79960 batch_time=0.57761 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.30456 (QuantReg: 13.98984) QuantErr: 13.98984 batch_time=0.57089 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.57456 (QuantReg: 13.81552) QuantErr: 13.81552 batch_time=0.52419 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.73278 (QuantReg: 13.61856) QuantErr: 13.61856 batch_time=0.51676 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.23021 (QuantReg: 14.08494) QuantErr: 14.08494 batch_time=0.64938 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.27067 (QuantReg: 14.00265) QuantErr: 14.00265 batch_time=0.53881 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.59847 (QuantReg: 14.13858) QuantErr: 14.13858 batch_time=0.53097 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.29506 (QuantReg: 13.96204) QuantErr: 13.96204 batch_time=0.57143 
Train Epoch: 15 codebook_update_time=1.78004
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch15.pth ...
Done in 4.826s
removing stale ckpt [epoch 14] [took 0.53s]
 epoch          : 15
 loss           : 1.4367010972499847
 quant_reg      : 13.824031967163085
 quant_err      : 13.824031967163085
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.68
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.077819681278584
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.54
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.15028361208397
 mnt_best       : 41.19818463739063
 not_improved_count: 2
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.58314 (QuantReg: 13.57404) QuantErr: 13.57404 batch_time=33.22275 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.45882 (QuantReg: 13.45728) QuantErr: 13.45728 batch_time=0.51296 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.29190 (QuantReg: 13.66893) QuantErr: 13.66893 batch_time=1.06857 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 2.06734 (QuantReg: 13.30089) QuantErr: 13.30089 batch_time=0.52975 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.51636 (QuantReg: 14.17410) QuantErr: 14.17410 batch_time=0.57903 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.50781 (QuantReg: 14.04478) QuantErr: 14.04478 batch_time=0.55496 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.12108 (QuantReg: 14.08356) QuantErr: 14.08356 batch_time=0.54944 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.40914 (QuantReg: 13.49253) QuantErr: 13.49253 batch_time=0.55451 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.37045 (QuantReg: 13.77872) QuantErr: 13.77872 batch_time=0.55813 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.27423 (QuantReg: 14.07961) QuantErr: 14.07961 batch_time=0.52672 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.27409 (QuantReg: 14.05866) QuantErr: 14.05866 batch_time=0.61304 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.52296 (QuantReg: 13.95644) QuantErr: 13.95644 batch_time=0.56475 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.29619 (QuantReg: 13.88102) QuantErr: 13.88102 batch_time=0.58825 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.74360 (QuantReg: 13.87797) QuantErr: 13.87797 batch_time=0.65194 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.69343 (QuantReg: 14.13528) QuantErr: 14.13528 batch_time=0.54291 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.52658 (QuantReg: 14.12181) QuantErr: 14.12181 batch_time=0.57392 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.15566 (QuantReg: 14.33250) QuantErr: 14.33250 batch_time=0.58649 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.52734 (QuantReg: 14.04809) QuantErr: 14.04809 batch_time=0.54215 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.36897 (QuantReg: 14.22539) QuantErr: 14.22539 batch_time=2.78761 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.16164 (QuantReg: 14.39582) QuantErr: 14.39582 batch_time=0.51857 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.39936 (QuantReg: 13.99905) QuantErr: 13.99905 batch_time=1.64025 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.67899 (QuantReg: 13.73922) QuantErr: 13.73922 batch_time=0.54271 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.40495 (QuantReg: 13.91766) QuantErr: 13.91766 batch_time=0.52330 
Train Epoch: 16 codebook_update_time=2.26603
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch16.pth ...
Done in 4.742s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch16.pth ...
Done in 9.252s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 1.440385494709015
 quant_reg      : 13.906950862884521
 quant_err      : 13.906950862884521
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.098
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.38222525399104
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.8975
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.35992713194375
 mnt_best       : 42.38222525399104
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.10318 (QuantReg: 14.06154) QuantErr: 14.06154 batch_time=43.94632 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.44537 (QuantReg: 13.42159) QuantErr: 13.42159 batch_time=0.52695 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.26150 (QuantReg: 13.71315) QuantErr: 13.71315 batch_time=0.58274 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.88307 (QuantReg: 14.04290) QuantErr: 14.04290 batch_time=0.64313 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.45130 (QuantReg: 13.41956) QuantErr: 13.41956 batch_time=0.57848 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.35015 (QuantReg: 13.99237) QuantErr: 13.99237 batch_time=0.53146 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.68745 (QuantReg: 14.13094) QuantErr: 14.13094 batch_time=0.57348 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.07520 (QuantReg: 13.94429) QuantErr: 13.94429 batch_time=0.53608 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.34414 (QuantReg: 13.75468) QuantErr: 13.75468 batch_time=0.58503 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.48135 (QuantReg: 13.92606) QuantErr: 13.92606 batch_time=0.56384 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.48128 (QuantReg: 14.10293) QuantErr: 14.10293 batch_time=0.55707 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.45398 (QuantReg: 13.90475) QuantErr: 13.90475 batch_time=0.54316 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.52957 (QuantReg: 13.91396) QuantErr: 13.91396 batch_time=0.51601 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.26917 (QuantReg: 14.21767) QuantErr: 14.21767 batch_time=0.56706 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.79160 (QuantReg: 13.65192) QuantErr: 13.65192 batch_time=0.53871 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.30078 (QuantReg: 14.02083) QuantErr: 14.02083 batch_time=0.54303 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.48624 (QuantReg: 14.26959) QuantErr: 14.26959 batch_time=0.50642 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.18070 (QuantReg: 14.42859) QuantErr: 14.42859 batch_time=0.55715 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.36447 (QuantReg: 13.71043) QuantErr: 13.71043 batch_time=0.56660 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.24516 (QuantReg: 14.32525) QuantErr: 14.32525 batch_time=0.53595 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.38712 (QuantReg: 13.88755) QuantErr: 13.88755 batch_time=0.53142 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.46635 (QuantReg: 14.47150) QuantErr: 14.47150 batch_time=0.57443 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.13654 (QuantReg: 14.06585) QuantErr: 14.06585 batch_time=0.54962 
Train Epoch: 17 codebook_update_time=2.33719
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch17.pth ...
Done in 13.690s
removing stale ckpt [epoch 16] [took 0.02s]
 epoch          : 17
 loss           : 1.3733231134414672
 quant_reg      : 14.036452915191651
 quant_err      : 14.036452915191651
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.444
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.35237770582959
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.169
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.96746682889879
 mnt_best       : 42.38222525399104
 not_improved_count: 1
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.36115 (QuantReg: 13.87973) QuantErr: 13.87973 batch_time=37.66380 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.27297 (QuantReg: 13.94315) QuantErr: 13.94315 batch_time=0.56498 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.21384 (QuantReg: 14.08607) QuantErr: 14.08607 batch_time=0.50116 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.14658 (QuantReg: 14.25710) QuantErr: 14.25710 batch_time=0.58928 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.38269 (QuantReg: 13.75348) QuantErr: 13.75348 batch_time=0.76755 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.08297 (QuantReg: 14.40557) QuantErr: 14.40557 batch_time=0.55168 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 0.97129 (QuantReg: 14.63864) QuantErr: 14.63864 batch_time=0.51070 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.09058 (QuantReg: 14.40231) QuantErr: 14.40231 batch_time=0.53525 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.63919 (QuantReg: 14.46728) QuantErr: 14.46728 batch_time=0.51116 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.23934 (QuantReg: 14.10114) QuantErr: 14.10114 batch_time=0.50575 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.55970 (QuantReg: 14.14750) QuantErr: 14.14750 batch_time=0.51051 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.34807 (QuantReg: 14.30202) QuantErr: 14.30202 batch_time=0.50460 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.41596 (QuantReg: 14.16864) QuantErr: 14.16864 batch_time=0.53856 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.54455 (QuantReg: 14.09618) QuantErr: 14.09618 batch_time=0.66397 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.50009 (QuantReg: 14.00326) QuantErr: 14.00326 batch_time=0.52205 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.37992 (QuantReg: 14.66383) QuantErr: 14.66383 batch_time=0.51160 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.22281 (QuantReg: 14.09934) QuantErr: 14.09934 batch_time=0.50520 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.10700 (QuantReg: 14.26558) QuantErr: 14.26558 batch_time=0.54364 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.26243 (QuantReg: 14.41823) QuantErr: 14.41823 batch_time=0.50729 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 0.84940 (QuantReg: 14.36943) QuantErr: 14.36943 batch_time=0.58243 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.72632 (QuantReg: 13.98377) QuantErr: 13.98377 batch_time=0.54946 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.18673 (QuantReg: 14.28427) QuantErr: 14.28427 batch_time=0.52406 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.21755 (QuantReg: 14.41697) QuantErr: 14.41697 batch_time=0.51905 
Train Epoch: 18 codebook_update_time=1.92627
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch18.pth ...
Done in 5.850s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch18.pth ...
Done in 12.888s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 1.3159167428016663
 quant_reg      : 14.230369262695312
 quant_err      : 14.230369262695312
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.412
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.700739675698614
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.1475
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.60635533567132
 mnt_best       : 42.700739675698614
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.09609 (QuantReg: 14.33232) QuantErr: 14.33232 batch_time=37.22356 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.18782 (QuantReg: 14.35553) QuantErr: 14.35553 batch_time=0.53641 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.50137 (QuantReg: 13.90294) QuantErr: 13.90294 batch_time=0.54680 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.53360 (QuantReg: 14.19654) QuantErr: 14.19654 batch_time=0.51470 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.18148 (QuantReg: 14.18224) QuantErr: 14.18224 batch_time=0.51570 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 0.90561 (QuantReg: 14.41300) QuantErr: 14.41300 batch_time=0.52624 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.02796 (QuantReg: 14.43344) QuantErr: 14.43344 batch_time=0.63417 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.07931 (QuantReg: 14.09113) QuantErr: 14.09113 batch_time=0.56510 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.05884 (QuantReg: 14.34923) QuantErr: 14.34923 batch_time=0.55866 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.49406 (QuantReg: 14.00695) QuantErr: 14.00695 batch_time=0.55881 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.25403 (QuantReg: 14.12390) QuantErr: 14.12390 batch_time=0.51526 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.02231 (QuantReg: 14.56426) QuantErr: 14.56426 batch_time=0.54529 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.32635 (QuantReg: 14.64159) QuantErr: 14.64159 batch_time=0.54533 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.32766 (QuantReg: 14.38091) QuantErr: 14.38091 batch_time=0.57037 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.63556 (QuantReg: 14.12589) QuantErr: 14.12589 batch_time=0.57997 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 0.92388 (QuantReg: 14.37493) QuantErr: 14.37493 batch_time=0.54440 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.11152 (QuantReg: 14.27488) QuantErr: 14.27488 batch_time=0.54803 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.39320 (QuantReg: 14.27303) QuantErr: 14.27303 batch_time=0.54278 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.38031 (QuantReg: 13.94229) QuantErr: 13.94229 batch_time=0.52451 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.28175 (QuantReg: 14.36359) QuantErr: 14.36359 batch_time=0.57867 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.34441 (QuantReg: 14.45797) QuantErr: 14.45797 batch_time=0.54996 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.77459 (QuantReg: 14.21695) QuantErr: 14.21695 batch_time=0.60101 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.36965 (QuantReg: 14.72274) QuantErr: 14.72274 batch_time=0.55442 
Train Epoch: 19 codebook_update_time=2.08406
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch19.pth ...
Done in 4.733s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch19.pth ...
Done in 9.845s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 1.2927898151874542
 quant_reg      : 14.31296494293213
 quant_err      : 14.31296494293213
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.231
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.890923346973125
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.078
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.78022750980984
 mnt_best       : 43.890923346973125
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 0.89060 (QuantReg: 14.62616) QuantErr: 14.62616 batch_time=33.34680 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.11325 (QuantReg: 14.21357) QuantErr: 14.21357 batch_time=0.54624 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.24744 (QuantReg: 14.26917) QuantErr: 14.26917 batch_time=0.56086 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.05089 (QuantReg: 14.02971) QuantErr: 14.02971 batch_time=0.53560 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.27152 (QuantReg: 13.93698) QuantErr: 13.93698 batch_time=0.52695 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.06987 (QuantReg: 14.41862) QuantErr: 14.41862 batch_time=0.51788 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 0.86010 (QuantReg: 14.57915) QuantErr: 14.57915 batch_time=7.49457 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.20585 (QuantReg: 14.30243) QuantErr: 14.30243 batch_time=0.58202 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.21589 (QuantReg: 14.38086) QuantErr: 14.38086 batch_time=0.59027 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 0.94265 (QuantReg: 14.53350) QuantErr: 14.53350 batch_time=0.53920 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.23879 (QuantReg: 14.29100) QuantErr: 14.29100 batch_time=0.55843 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.28339 (QuantReg: 14.60244) QuantErr: 14.60244 batch_time=0.56091 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.24652 (QuantReg: 14.12547) QuantErr: 14.12547 batch_time=0.51518 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.21883 (QuantReg: 14.57138) QuantErr: 14.57138 batch_time=0.57329 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.26135 (QuantReg: 14.51932) QuantErr: 14.51932 batch_time=0.58540 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.47344 (QuantReg: 14.65495) QuantErr: 14.65495 batch_time=0.53247 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.28921 (QuantReg: 14.39152) QuantErr: 14.39152 batch_time=0.51518 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.13319 (QuantReg: 14.53463) QuantErr: 14.53463 batch_time=0.56962 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.13512 (QuantReg: 14.47313) QuantErr: 14.47313 batch_time=0.54653 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.15519 (QuantReg: 14.46450) QuantErr: 14.46450 batch_time=0.55543 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.28736 (QuantReg: 14.71830) QuantErr: 14.71830 batch_time=0.53785 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.34304 (QuantReg: 14.65840) QuantErr: 14.65840 batch_time=0.51725 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.32336 (QuantReg: 14.53397) QuantErr: 14.53397 batch_time=0.58748 
Train Epoch: 20 codebook_update_time=2.04114
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch20.pth ...
Done in 7.133s
removing stale ckpt [epoch 19] [took 0.03s]
 epoch          : 20
 loss           : 1.2715795595645905
 quant_reg      : 14.412840175628663
 quant_err      : 14.412840175628663
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.497
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.00411894922468
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.383
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.05239969353378
 mnt_best       : 43.890923346973125
 not_improved_count: 1
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.39402 (QuantReg: 14.49062) QuantErr: 14.49062 batch_time=38.32561 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.20237 (QuantReg: 14.56327) QuantErr: 14.56327 batch_time=0.56577 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.33246 (QuantReg: 14.58707) QuantErr: 14.58707 batch_time=0.57420 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.48914 (QuantReg: 14.26402) QuantErr: 14.26402 batch_time=1.68857 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.14961 (QuantReg: 14.02251) QuantErr: 14.02251 batch_time=0.59314 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.19274 (QuantReg: 14.57232) QuantErr: 14.57232 batch_time=0.63348 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.73777 (QuantReg: 14.23442) QuantErr: 14.23442 batch_time=3.54990 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.35542 (QuantReg: 14.34944) QuantErr: 14.34944 batch_time=0.56811 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.20283 (QuantReg: 14.42635) QuantErr: 14.42635 batch_time=0.54164 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.19738 (QuantReg: 14.10891) QuantErr: 14.10891 batch_time=1.12845 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 0.90837 (QuantReg: 14.73825) QuantErr: 14.73825 batch_time=1.08380 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.06794 (QuantReg: 14.37310) QuantErr: 14.37310 batch_time=0.55660 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.14134 (QuantReg: 14.49735) QuantErr: 14.49735 batch_time=0.58624 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.03666 (QuantReg: 14.40320) QuantErr: 14.40320 batch_time=0.52001 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.32457 (QuantReg: 14.16064) QuantErr: 14.16064 batch_time=0.52289 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.13672 (QuantReg: 14.91945) QuantErr: 14.91945 batch_time=0.50785 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.34859 (QuantReg: 14.23330) QuantErr: 14.23330 batch_time=0.51915 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.19895 (QuantReg: 14.28966) QuantErr: 14.28966 batch_time=0.52750 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.35836 (QuantReg: 14.71244) QuantErr: 14.71244 batch_time=0.51870 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.61425 (QuantReg: 14.17557) QuantErr: 14.17557 batch_time=0.54412 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.12839 (QuantReg: 14.77255) QuantErr: 14.77255 batch_time=0.57208 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.25763 (QuantReg: 14.75907) QuantErr: 14.75907 batch_time=0.69407 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.27768 (QuantReg: 14.61309) QuantErr: 14.61309 batch_time=0.57306 
Train Epoch: 21 codebook_update_time=1.81506
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch21.pth ...
Done in 6.260s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 1.2468120605945587
 quant_reg      : 14.49463017654419
 quant_err      : 14.49463017654419
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.125
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.47703901203959
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.652
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.17659059464966
 mnt_best       : 43.890923346973125
 not_improved_count: 2
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.28033 (QuantReg: 14.55102) QuantErr: 14.55102 batch_time=33.05540 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.03843 (QuantReg: 14.60509) QuantErr: 14.60509 batch_time=0.53396 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.26495 (QuantReg: 14.63530) QuantErr: 14.63530 batch_time=0.57789 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.46608 (QuantReg: 14.42706) QuantErr: 14.42706 batch_time=0.55605 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.68628 (QuantReg: 14.48732) QuantErr: 14.48732 batch_time=0.52626 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.44256 (QuantReg: 14.28724) QuantErr: 14.28724 batch_time=0.56840 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.52168 (QuantReg: 14.64671) QuantErr: 14.64671 batch_time=0.54048 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.17378 (QuantReg: 14.46673) QuantErr: 14.46673 batch_time=0.61728 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.26674 (QuantReg: 14.65254) QuantErr: 14.65254 batch_time=0.51347 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.37624 (QuantReg: 14.23062) QuantErr: 14.23062 batch_time=0.55319 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.28226 (QuantReg: 14.81331) QuantErr: 14.81331 batch_time=0.52446 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.16524 (QuantReg: 14.37217) QuantErr: 14.37217 batch_time=0.58320 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 0.98611 (QuantReg: 14.40837) QuantErr: 14.40837 batch_time=0.55489 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.22928 (QuantReg: 14.37753) QuantErr: 14.37753 batch_time=0.51490 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.04596 (QuantReg: 14.42930) QuantErr: 14.42930 batch_time=0.55224 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.57011 (QuantReg: 14.57166) QuantErr: 14.57166 batch_time=0.56942 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.08187 (QuantReg: 14.72209) QuantErr: 14.72209 batch_time=0.59457 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.07736 (QuantReg: 14.59852) QuantErr: 14.59852 batch_time=0.55830 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 0.94773 (QuantReg: 14.55884) QuantErr: 14.55884 batch_time=0.54421 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.17681 (QuantReg: 14.83574) QuantErr: 14.83574 batch_time=0.51853 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.57432 (QuantReg: 14.65017) QuantErr: 14.65017 batch_time=0.63014 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 0.89663 (QuantReg: 14.92306) QuantErr: 14.92306 batch_time=0.57265 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.20603 (QuantReg: 14.97977) QuantErr: 14.97977 batch_time=0.55404 
Train Epoch: 22 codebook_update_time=1.80448
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch22.pth ...
Done in 4.742s
removing stale ckpt [epoch 21] [took 0.02s]
 epoch          : 22
 loss           : 1.2266874980926514
 quant_reg      : 14.599253097534179
 quant_err      : 14.599253097534179
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.366
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.06976128795489
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.348
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.33128727185748
 mnt_best       : 43.890923346973125
 not_improved_count: 3
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.27364 (QuantReg: 14.53490) QuantErr: 14.53490 batch_time=38.04801 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.10592 (QuantReg: 14.49197) QuantErr: 14.49197 batch_time=0.51563 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.39700 (QuantReg: 14.60341) QuantErr: 14.60341 batch_time=0.59670 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.36627 (QuantReg: 14.40435) QuantErr: 14.40435 batch_time=0.55422 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.16561 (QuantReg: 14.42900) QuantErr: 14.42900 batch_time=0.55294 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.43312 (QuantReg: 14.52818) QuantErr: 14.52818 batch_time=0.54861 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.11856 (QuantReg: 14.37790) QuantErr: 14.37790 batch_time=1.00939 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.31471 (QuantReg: 14.32563) QuantErr: 14.32563 batch_time=0.57113 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.20632 (QuantReg: 14.86270) QuantErr: 14.86270 batch_time=0.58927 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.49237 (QuantReg: 14.36699) QuantErr: 14.36699 batch_time=0.54114 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 0.98163 (QuantReg: 14.47323) QuantErr: 14.47323 batch_time=0.52280 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.07073 (QuantReg: 14.23351) QuantErr: 14.23351 batch_time=0.56235 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.12553 (QuantReg: 14.81241) QuantErr: 14.81241 batch_time=0.57051 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.07952 (QuantReg: 14.72456) QuantErr: 14.72456 batch_time=0.51159 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.32466 (QuantReg: 14.56330) QuantErr: 14.56330 batch_time=0.51849 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.11314 (QuantReg: 14.56974) QuantErr: 14.56974 batch_time=0.58276 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.28165 (QuantReg: 14.86830) QuantErr: 14.86830 batch_time=0.54459 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 0.79761 (QuantReg: 14.67098) QuantErr: 14.67098 batch_time=0.56562 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.11458 (QuantReg: 14.52462) QuantErr: 14.52462 batch_time=0.57598 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.30433 (QuantReg: 14.63473) QuantErr: 14.63473 batch_time=0.52615 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.32668 (QuantReg: 14.74122) QuantErr: 14.74122 batch_time=0.52253 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 0.98142 (QuantReg: 14.93716) QuantErr: 14.93716 batch_time=0.53801 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.05538 (QuantReg: 14.63777) QuantErr: 14.63777 batch_time=0.54142 
Train Epoch: 23 codebook_update_time=1.89029
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch23.pth ...
Done in 5.407s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 1.1906345703601837
 quant_reg      : 14.640568065643311
 quant_err      : 14.640568065643311
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.778
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.5503784146109
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.759
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.644191089521115
 mnt_best       : 43.890923346973125
 not_improved_count: 4
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.20831 (QuantReg: 14.56420) QuantErr: 14.56420 batch_time=32.19867 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 0.95946 (QuantReg: 14.50883) QuantErr: 14.50883 batch_time=0.57275 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.10244 (QuantReg: 14.33847) QuantErr: 14.33847 batch_time=0.51597 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.20911 (QuantReg: 14.55494) QuantErr: 14.55494 batch_time=0.54962 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.38545 (QuantReg: 14.42067) QuantErr: 14.42067 batch_time=0.52648 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.14982 (QuantReg: 14.85428) QuantErr: 14.85428 batch_time=0.56906 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.16157 (QuantReg: 14.38088) QuantErr: 14.38088 batch_time=0.50771 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.32893 (QuantReg: 14.84733) QuantErr: 14.84733 batch_time=0.55557 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.09685 (QuantReg: 14.81475) QuantErr: 14.81475 batch_time=0.51037 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.22844 (QuantReg: 14.74066) QuantErr: 14.74066 batch_time=0.55979 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.29043 (QuantReg: 14.84111) QuantErr: 14.84111 batch_time=0.51788 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.22063 (QuantReg: 14.82302) QuantErr: 14.82302 batch_time=0.53249 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 0.99811 (QuantReg: 14.78308) QuantErr: 14.78308 batch_time=0.50138 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.06561 (QuantReg: 14.62702) QuantErr: 14.62702 batch_time=0.55904 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.18030 (QuantReg: 14.90902) QuantErr: 14.90902 batch_time=0.50990 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.56365 (QuantReg: 14.81371) QuantErr: 14.81371 batch_time=0.53435 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.86240 (QuantReg: 15.03223) QuantErr: 15.03223 batch_time=0.51099 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.27386 (QuantReg: 15.08988) QuantErr: 15.08988 batch_time=0.58420 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.24027 (QuantReg: 14.59005) QuantErr: 14.59005 batch_time=0.53014 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 0.99248 (QuantReg: 14.85049) QuantErr: 14.85049 batch_time=0.56119 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.19376 (QuantReg: 15.05072) QuantErr: 15.05072 batch_time=0.54818 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.04912 (QuantReg: 14.84758) QuantErr: 14.84758 batch_time=0.53124 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 0.90194 (QuantReg: 14.79444) QuantErr: 14.79444 batch_time=0.58003 
Train Epoch: 24 codebook_update_time=1.91036
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch24.pth ...
Done in 5.913s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 1.1644394006729126
 quant_reg      : 14.770503280639648
 quant_err      : 14.770503280639648
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.686
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.05430762174797
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6075
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.08056863374283
 mnt_best       : 43.890923346973125
 not_improved_count: 5
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.17087 (QuantReg: 14.68251) QuantErr: 14.68251 batch_time=35.67553 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.00330 (QuantReg: 14.78980) QuantErr: 14.78980 batch_time=1.88255 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.16551 (QuantReg: 15.03139) QuantErr: 15.03139 batch_time=0.54040 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.01945 (QuantReg: 14.85632) QuantErr: 14.85632 batch_time=0.52164 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 0.96067 (QuantReg: 14.95491) QuantErr: 14.95491 batch_time=0.50636 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 0.87009 (QuantReg: 14.95115) QuantErr: 14.95115 batch_time=0.56196 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.26317 (QuantReg: 14.97130) QuantErr: 14.97130 batch_time=0.52720 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.32429 (QuantReg: 14.69549) QuantErr: 14.69549 batch_time=0.51511 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.30449 (QuantReg: 14.69067) QuantErr: 14.69067 batch_time=0.56825 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.23192 (QuantReg: 14.67160) QuantErr: 14.67160 batch_time=0.54407 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.42959 (QuantReg: 14.70992) QuantErr: 14.70992 batch_time=0.59795 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.52105 (QuantReg: 14.73958) QuantErr: 14.73958 batch_time=0.52527 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 0.93082 (QuantReg: 14.84599) QuantErr: 14.84599 batch_time=0.58190 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 0.94304 (QuantReg: 15.06874) QuantErr: 15.06874 batch_time=0.56353 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.14820 (QuantReg: 14.73834) QuantErr: 14.73834 batch_time=1.28549 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.52633 (QuantReg: 14.53129) QuantErr: 14.53129 batch_time=0.51821 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 0.99600 (QuantReg: 14.99046) QuantErr: 14.99046 batch_time=0.54095 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.00288 (QuantReg: 14.99432) QuantErr: 14.99432 batch_time=0.56336 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.83574 (QuantReg: 15.00280) QuantErr: 15.00280 batch_time=1.16771 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.04717 (QuantReg: 14.92068) QuantErr: 14.92068 batch_time=3.80312 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.48962 (QuantReg: 15.07206) QuantErr: 15.07206 batch_time=1.77432 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 0.80758 (QuantReg: 15.17080) QuantErr: 15.17080 batch_time=0.54856 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.16924 (QuantReg: 14.87668) QuantErr: 14.87668 batch_time=0.57705 
Train Epoch: 25 codebook_update_time=1.97908
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch25.pth ...
Done in 4.683s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch25.pth ...
Done in 9.985s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.1342117874622344
 quant_reg      : 14.859089321136475
 quant_err      : 14.859089321136475
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.268
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.14150380295421
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.42632459348239
 mnt_best       : 44.14150380295421
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.18647 (QuantReg: 14.63796) QuantErr: 14.63796 batch_time=35.25500 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.19204 (QuantReg: 14.51528) QuantErr: 14.51528 batch_time=0.55623 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.25620 (QuantReg: 14.90868) QuantErr: 14.90868 batch_time=0.54682 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.24627 (QuantReg: 14.90453) QuantErr: 14.90453 batch_time=0.56977 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.23184 (QuantReg: 14.82933) QuantErr: 14.82933 batch_time=0.57867 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.06511 (QuantReg: 15.20012) QuantErr: 15.20012 batch_time=0.51694 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 0.86205 (QuantReg: 14.92718) QuantErr: 14.92718 batch_time=3.45143 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.21444 (QuantReg: 14.92503) QuantErr: 14.92503 batch_time=0.51936 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.15741 (QuantReg: 14.68262) QuantErr: 14.68262 batch_time=0.53572 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 0.81783 (QuantReg: 14.96112) QuantErr: 14.96112 batch_time=0.59800 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.99305 (QuantReg: 14.93331) QuantErr: 14.93331 batch_time=0.55382 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.42922 (QuantReg: 14.99725) QuantErr: 14.99725 batch_time=0.54651 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.28716 (QuantReg: 15.05417) QuantErr: 15.05417 batch_time=0.57536 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.21528 (QuantReg: 14.34223) QuantErr: 14.34223 batch_time=1.42853 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.25949 (QuantReg: 14.98375) QuantErr: 14.98375 batch_time=0.54976 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.07869 (QuantReg: 15.15093) QuantErr: 15.15093 batch_time=0.52454 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.08222 (QuantReg: 15.06946) QuantErr: 15.06946 batch_time=0.52401 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.34443 (QuantReg: 14.96088) QuantErr: 14.96088 batch_time=0.65937 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.08808 (QuantReg: 14.56865) QuantErr: 14.56865 batch_time=0.57254 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.19314 (QuantReg: 15.11075) QuantErr: 15.11075 batch_time=0.55839 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.07349 (QuantReg: 15.21788) QuantErr: 15.21788 batch_time=0.57146 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.25013 (QuantReg: 15.30591) QuantErr: 15.30591 batch_time=0.52225 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.10413 (QuantReg: 15.22155) QuantErr: 15.22155 batch_time=0.63675 
Train Epoch: 26 codebook_update_time=1.89905
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch26.pth ...
Done in 5.774s
removing stale ckpt [epoch 25] [took 0.10s]
 epoch          : 26
 loss           : 1.147558750152588
 quant_reg      : 14.89322364807129
 quant_err      : 14.89322364807129
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.314
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.04037066148132
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4295
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.233901133888246
 mnt_best       : 44.14150380295421
 not_improved_count: 1
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.08017 (QuantReg: 14.92486) QuantErr: 14.92486 batch_time=37.35526 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.07046 (QuantReg: 14.67080) QuantErr: 14.67080 batch_time=0.52534 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.27220 (QuantReg: 14.74883) QuantErr: 14.74883 batch_time=0.55470 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.16232 (QuantReg: 14.97600) QuantErr: 14.97600 batch_time=0.50842 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.00976 (QuantReg: 14.61967) QuantErr: 14.61967 batch_time=0.52416 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.06239 (QuantReg: 14.93691) QuantErr: 14.93691 batch_time=0.52070 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.14410 (QuantReg: 15.03764) QuantErr: 15.03764 batch_time=0.57691 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.17567 (QuantReg: 14.77864) QuantErr: 14.77864 batch_time=0.52874 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.26265 (QuantReg: 14.85202) QuantErr: 14.85202 batch_time=0.54279 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.03830 (QuantReg: 15.36559) QuantErr: 15.36559 batch_time=0.53443 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.14579 (QuantReg: 15.12369) QuantErr: 15.12369 batch_time=0.54869 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.14235 (QuantReg: 14.69536) QuantErr: 14.69536 batch_time=0.51284 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 0.86129 (QuantReg: 15.11704) QuantErr: 15.11704 batch_time=4.19113 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.31116 (QuantReg: 14.99604) QuantErr: 14.99604 batch_time=0.53919 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.01254 (QuantReg: 15.26502) QuantErr: 15.26502 batch_time=0.55012 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.25240 (QuantReg: 14.76019) QuantErr: 14.76019 batch_time=0.54228 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.34175 (QuantReg: 14.89359) QuantErr: 14.89359 batch_time=0.54155 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 0.94428 (QuantReg: 15.16697) QuantErr: 15.16697 batch_time=0.58011 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.21063 (QuantReg: 14.62530) QuantErr: 14.62530 batch_time=0.56746 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.28838 (QuantReg: 15.22639) QuantErr: 15.22639 batch_time=1.40717 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 0.98776 (QuantReg: 15.05936) QuantErr: 15.05936 batch_time=0.52799 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.15923 (QuantReg: 14.82972) QuantErr: 14.82972 batch_time=0.53560 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.03437 (QuantReg: 15.23119) QuantErr: 15.23119 batch_time=0.51611 
Train Epoch: 27 codebook_update_time=1.96289
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch27.pth ...
Done in 6.746s
removing stale ckpt [epoch 26] [took 0.13s]
 epoch          : 27
 loss           : 1.1215814771652222
 quant_reg      : 14.990291549682617
 quant_err      : 14.990291549682617
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.724
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.797256627101824
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.219
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.504607526960406
 mnt_best       : 44.14150380295421
 not_improved_count: 2
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 0.89940 (QuantReg: 14.68079) QuantErr: 14.68079 batch_time=37.44690 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.28828 (QuantReg: 15.21319) QuantErr: 15.21319 batch_time=0.51253 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.81887 (QuantReg: 14.91913) QuantErr: 14.91913 batch_time=0.60777 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 0.84583 (QuantReg: 14.90840) QuantErr: 14.90840 batch_time=0.54742 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 0.84571 (QuantReg: 15.30733) QuantErr: 15.30733 batch_time=0.50225 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.07580 (QuantReg: 14.93285) QuantErr: 14.93285 batch_time=0.51805 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.39970 (QuantReg: 14.91951) QuantErr: 14.91951 batch_time=0.51869 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.04774 (QuantReg: 14.94477) QuantErr: 14.94477 batch_time=0.55543 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.68219 (QuantReg: 14.79449) QuantErr: 14.79449 batch_time=0.57567 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.26910 (QuantReg: 15.19923) QuantErr: 15.19923 batch_time=0.55243 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.29729 (QuantReg: 15.19690) QuantErr: 15.19690 batch_time=0.57167 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 0.92919 (QuantReg: 14.91978) QuantErr: 14.91978 batch_time=0.54911 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.45242 (QuantReg: 15.15148) QuantErr: 15.15148 batch_time=4.75992 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.09337 (QuantReg: 14.82269) QuantErr: 14.82269 batch_time=0.57278 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.23150 (QuantReg: 15.05703) QuantErr: 15.05703 batch_time=0.53029 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.09135 (QuantReg: 15.20821) QuantErr: 15.20821 batch_time=0.58072 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.15982 (QuantReg: 15.16280) QuantErr: 15.16280 batch_time=0.55865 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 0.89391 (QuantReg: 15.49570) QuantErr: 15.49570 batch_time=0.57024 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.18806 (QuantReg: 14.73265) QuantErr: 14.73265 batch_time=0.55505 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 0.96053 (QuantReg: 15.30560) QuantErr: 15.30560 batch_time=0.60166 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 0.89344 (QuantReg: 15.19548) QuantErr: 15.19548 batch_time=0.53302 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.09190 (QuantReg: 15.25207) QuantErr: 15.25207 batch_time=0.58836 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.19480 (QuantReg: 15.16596) QuantErr: 15.16596 batch_time=0.53551 
Train Epoch: 28 codebook_update_time=2.47313
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch28.pth ...
Done in 16.458s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch28.pth ...
Done in 21.350s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 1.1051474409103395
 quant_reg      : 15.042935764312745
 quant_err      : 15.042935764312745
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.41
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.30590463582356
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.84
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.1271302161169
 mnt_best       : 44.30590463582356
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.53254 (QuantReg: 14.84289) QuantErr: 14.84289 batch_time=36.03078 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.29864 (QuantReg: 15.11600) QuantErr: 15.11600 batch_time=0.53665 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.15743 (QuantReg: 15.31203) QuantErr: 15.31203 batch_time=0.55796 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.10346 (QuantReg: 15.01691) QuantErr: 15.01691 batch_time=0.61449 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.35928 (QuantReg: 14.86024) QuantErr: 14.86024 batch_time=0.89495 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.01446 (QuantReg: 15.16622) QuantErr: 15.16622 batch_time=0.53742 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.02874 (QuantReg: 14.93809) QuantErr: 14.93809 batch_time=2.58290 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.06876 (QuantReg: 15.42525) QuantErr: 15.42525 batch_time=0.52755 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.07249 (QuantReg: 15.20348) QuantErr: 15.20348 batch_time=0.52108 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.19885 (QuantReg: 15.47742) QuantErr: 15.47742 batch_time=0.52367 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.64538 (QuantReg: 15.06252) QuantErr: 15.06252 batch_time=0.51946 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.01631 (QuantReg: 14.94930) QuantErr: 14.94930 batch_time=0.57302 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.44858 (QuantReg: 14.94256) QuantErr: 14.94256 batch_time=5.15608 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 0.94406 (QuantReg: 15.13213) QuantErr: 15.13213 batch_time=0.54247 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 0.87866 (QuantReg: 15.51558) QuantErr: 15.51558 batch_time=0.54852 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.17228 (QuantReg: 15.05879) QuantErr: 15.05879 batch_time=0.57922 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.16203 (QuantReg: 15.27244) QuantErr: 15.27244 batch_time=0.57129 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.06693 (QuantReg: 15.32342) QuantErr: 15.32342 batch_time=0.53556 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.27006 (QuantReg: 14.96372) QuantErr: 14.96372 batch_time=0.54191 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.10410 (QuantReg: 15.16027) QuantErr: 15.16027 batch_time=0.53500 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.07345 (QuantReg: 14.99304) QuantErr: 14.99304 batch_time=0.50862 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.62674 (QuantReg: 15.45621) QuantErr: 15.45621 batch_time=0.55618 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.26507 (QuantReg: 15.12418) QuantErr: 15.12418 batch_time=0.59545 
Train Epoch: 29 codebook_update_time=2.53615
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch29.pth ...
Done in 14.944s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch29.pth ...
Done in 19.946s
removing stale ckpt [epoch 28] [took 0.04s]
 epoch          : 29
 loss           : 1.0868352646827697
 quant_reg      : 15.085927879333497
 quant_err      : 15.085927879333497
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.979
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.080495923173125
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.36007409261617
 mnt_best       : 45.080495923173125
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 0.99254 (QuantReg: 15.14567) QuantErr: 15.14567 batch_time=37.20340 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.20683 (QuantReg: 14.72173) QuantErr: 14.72173 batch_time=0.54486 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.06747 (QuantReg: 14.82592) QuantErr: 14.82592 batch_time=0.53532 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 0.93189 (QuantReg: 15.23931) QuantErr: 15.23931 batch_time=0.52978 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.09292 (QuantReg: 15.19040) QuantErr: 15.19040 batch_time=0.53413 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.00056 (QuantReg: 15.05685) QuantErr: 15.05685 batch_time=0.53167 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.32081 (QuantReg: 15.22691) QuantErr: 15.22691 batch_time=0.83907 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.93237 (QuantReg: 15.35365) QuantErr: 15.35365 batch_time=1.77381 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.12654 (QuantReg: 15.00425) QuantErr: 15.00425 batch_time=4.70993 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.20265 (QuantReg: 15.39323) QuantErr: 15.39323 batch_time=0.53140 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.01610 (QuantReg: 15.28654) QuantErr: 15.28654 batch_time=0.62709 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 0.89346 (QuantReg: 15.18299) QuantErr: 15.18299 batch_time=0.51109 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 0.86782 (QuantReg: 15.36656) QuantErr: 15.36656 batch_time=0.52355 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.26794 (QuantReg: 15.34881) QuantErr: 15.34881 batch_time=0.55532 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.43901 (QuantReg: 15.05340) QuantErr: 15.05340 batch_time=0.50511 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.05463 (QuantReg: 15.04609) QuantErr: 15.04609 batch_time=0.63137 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.24308 (QuantReg: 14.59488) QuantErr: 14.59488 batch_time=0.53432 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.28741 (QuantReg: 14.84551) QuantErr: 14.84551 batch_time=0.54865 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 0.89970 (QuantReg: 15.20948) QuantErr: 15.20948 batch_time=0.55944 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.48634 (QuantReg: 15.27842) QuantErr: 15.27842 batch_time=0.55954 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 0.99959 (QuantReg: 15.17940) QuantErr: 15.17940 batch_time=0.51434 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 0.99806 (QuantReg: 15.24872) QuantErr: 15.24872 batch_time=0.57582 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.00046 (QuantReg: 15.40375) QuantErr: 15.40375 batch_time=0.54827 
Train Epoch: 30 codebook_update_time=1.76458
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch30.pth ...
Done in 5.080s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch30.pth ...
Done in 9.907s
removing stale ckpt [epoch 29] [took 0.01s]
 epoch          : 30
 loss           : 1.1026032073497771
 quant_reg      : 15.12242102432251
 quant_err      : 15.12242102432251
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.723
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.086789542212074
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.592
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.23690306027649
 mnt_best       : 45.086789542212074
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.23802 (QuantReg: 15.00136) QuantErr: 15.00136 batch_time=37.63923 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.09559 (QuantReg: 15.05488) QuantErr: 15.05488 batch_time=0.54153 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.06248 (QuantReg: 14.74580) QuantErr: 14.74580 batch_time=0.58355 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.20374 (QuantReg: 14.82644) QuantErr: 14.82644 batch_time=0.56319 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.07268 (QuantReg: 15.26917) QuantErr: 15.26917 batch_time=0.56127 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.28175 (QuantReg: 15.06335) QuantErr: 15.06335 batch_time=0.51906 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.02756 (QuantReg: 15.26064) QuantErr: 15.26064 batch_time=4.78418 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 0.97305 (QuantReg: 15.28267) QuantErr: 15.28267 batch_time=0.52698 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.06564 (QuantReg: 14.82851) QuantErr: 14.82851 batch_time=0.53959 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.05945 (QuantReg: 15.24014) QuantErr: 15.24014 batch_time=0.51872 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 0.99007 (QuantReg: 15.38779) QuantErr: 15.38779 batch_time=0.56546 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 0.91587 (QuantReg: 15.18411) QuantErr: 15.18411 batch_time=0.54173 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 0.86338 (QuantReg: 15.23503) QuantErr: 15.23503 batch_time=0.51169 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.13954 (QuantReg: 14.85111) QuantErr: 14.85111 batch_time=0.52684 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 0.90827 (QuantReg: 15.32552) QuantErr: 15.32552 batch_time=0.59190 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.01806 (QuantReg: 15.23011) QuantErr: 15.23011 batch_time=0.57015 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 0.99095 (QuantReg: 15.26039) QuantErr: 15.26039 batch_time=0.56883 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.15523 (QuantReg: 15.01824) QuantErr: 15.01824 batch_time=0.59743 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 0.92294 (QuantReg: 15.19615) QuantErr: 15.19615 batch_time=0.57884 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.06921 (QuantReg: 14.96313) QuantErr: 14.96313 batch_time=0.57320 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.05571 (QuantReg: 15.07206) QuantErr: 15.07206 batch_time=0.59593 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.11884 (QuantReg: 15.33746) QuantErr: 15.33746 batch_time=0.58318 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.35505 (QuantReg: 14.67212) QuantErr: 14.67212 batch_time=0.56486 
Train Epoch: 31 codebook_update_time=1.95109
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch31.pth ...
Done in 4.751s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch31.pth ...
Done in 9.210s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 31
 loss           : 1.0796567373275756
 quant_reg      : 15.205628604888917
 quant_err      : 15.205628604888917
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.398
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.26278116411462
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2145
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.016568070938526
 mnt_best       : 45.26278116411462
 not_improved_count: 0
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.06928 (QuantReg: 14.98746) QuantErr: 14.98746 batch_time=37.97543 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.17966 (QuantReg: 14.97894) QuantErr: 14.97894 batch_time=0.58135 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.25057 (QuantReg: 15.44112) QuantErr: 15.44112 batch_time=0.66143 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.04790 (QuantReg: 14.92210) QuantErr: 14.92210 batch_time=0.55388 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.78927 (QuantReg: 15.35383) QuantErr: 15.35383 batch_time=0.76198 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 0.92429 (QuantReg: 15.28872) QuantErr: 15.28872 batch_time=0.56179 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.09345 (QuantReg: 15.27474) QuantErr: 15.27474 batch_time=0.58923 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.27251 (QuantReg: 15.49155) QuantErr: 15.49155 batch_time=0.54005 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 0.92840 (QuantReg: 15.57211) QuantErr: 15.57211 batch_time=1.01887 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.47168 (QuantReg: 14.95543) QuantErr: 14.95543 batch_time=0.55856 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.35478 (QuantReg: 14.93421) QuantErr: 14.93421 batch_time=0.57043 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.18793 (QuantReg: 15.14128) QuantErr: 15.14128 batch_time=0.57620 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.21810 (QuantReg: 15.23987) QuantErr: 15.23987 batch_time=0.51534 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 0.98484 (QuantReg: 15.31904) QuantErr: 15.31904 batch_time=2.15315 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.29157 (QuantReg: 14.99313) QuantErr: 14.99313 batch_time=0.57715 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.10703 (QuantReg: 15.06733) QuantErr: 15.06733 batch_time=0.56397 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.16259 (QuantReg: 15.14890) QuantErr: 15.14890 batch_time=0.51612 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.73236 (QuantReg: 15.50366) QuantErr: 15.50366 batch_time=0.53910 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.27443 (QuantReg: 15.08805) QuantErr: 15.08805 batch_time=0.56215 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 0.92624 (QuantReg: 15.37255) QuantErr: 15.37255 batch_time=0.64694 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.02624 (QuantReg: 15.34289) QuantErr: 15.34289 batch_time=0.50169 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 0.87505 (QuantReg: 15.61330) QuantErr: 15.61330 batch_time=0.61653 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.31332 (QuantReg: 15.29230) QuantErr: 15.29230 batch_time=0.51160 
Train Epoch: 32 codebook_update_time=1.88516
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch32.pth ...
Done in 4.427s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch32.pth ...
Done in 8.805s
removing stale ckpt [epoch 31] [took 0.01s]
 epoch          : 32
 loss           : 1.0741682572364808
 quant_reg      : 15.281033294677734
 quant_err      : 15.281033294677734
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.692
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.55698692265952
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.5585
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.824058855830394
 mnt_best       : 45.55698692265952
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.15125 (QuantReg: 15.13299) QuantErr: 15.13299 batch_time=35.87310 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.04803 (QuantReg: 15.47945) QuantErr: 15.47945 batch_time=0.52019 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.19853 (QuantReg: 15.10596) QuantErr: 15.10596 batch_time=0.57780 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.16684 (QuantReg: 15.33509) QuantErr: 15.33509 batch_time=0.54946 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.36889 (QuantReg: 14.79704) QuantErr: 14.79704 batch_time=0.54183 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.15640 (QuantReg: 15.28619) QuantErr: 15.28619 batch_time=0.53205 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.78538 (QuantReg: 15.26785) QuantErr: 15.26785 batch_time=0.55266 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 0.88253 (QuantReg: 15.27205) QuantErr: 15.27205 batch_time=0.55205 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.08544 (QuantReg: 15.09966) QuantErr: 15.09966 batch_time=0.59957 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 0.99221 (QuantReg: 15.31007) QuantErr: 15.31007 batch_time=0.54131 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.19498 (QuantReg: 15.04718) QuantErr: 15.04718 batch_time=0.51887 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 0.97437 (QuantReg: 15.36687) QuantErr: 15.36687 batch_time=0.55224 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.13581 (QuantReg: 15.11079) QuantErr: 15.11079 batch_time=0.61680 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 0.88636 (QuantReg: 15.19887) QuantErr: 15.19887 batch_time=0.60282 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.07722 (QuantReg: 15.57391) QuantErr: 15.57391 batch_time=0.54995 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.83477 (QuantReg: 15.68790) QuantErr: 15.68790 batch_time=0.53928 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.77918 (QuantReg: 15.29010) QuantErr: 15.29010 batch_time=0.53684 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.51079 (QuantReg: 15.45517) QuantErr: 15.45517 batch_time=0.52752 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.28080 (QuantReg: 15.05667) QuantErr: 15.05667 batch_time=0.57309 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.11660 (QuantReg: 15.07297) QuantErr: 15.07297 batch_time=0.55463 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.92135 (QuantReg: 15.23621) QuantErr: 15.23621 batch_time=0.58887 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 0.99538 (QuantReg: 15.19069) QuantErr: 15.19069 batch_time=0.58434 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 0.99372 (QuantReg: 15.34507) QuantErr: 15.34507 batch_time=0.54359 
Train Epoch: 33 codebook_update_time=1.89455
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch33.pth ...
Done in 4.464s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.0546351127624511
 quant_reg      : 15.338555053710937
 quant_err      : 15.338555053710937
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.063
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.9453242121498
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.792
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.79554185803404
 mnt_best       : 45.55698692265952
 not_improved_count: 1
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.11404 (QuantReg: 15.35486) QuantErr: 15.35486 batch_time=37.57660 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.00923 (QuantReg: 15.43423) QuantErr: 15.43423 batch_time=5.43066 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.15881 (QuantReg: 15.44477) QuantErr: 15.44477 batch_time=0.54721 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 0.73964 (QuantReg: 15.29055) QuantErr: 15.29055 batch_time=0.55012 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 0.79122 (QuantReg: 14.98612) QuantErr: 14.98612 batch_time=0.57916 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.17486 (QuantReg: 15.34155) QuantErr: 15.34155 batch_time=0.58421 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.82177 (QuantReg: 15.40320) QuantErr: 15.40320 batch_time=0.54247 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.11762 (QuantReg: 15.28799) QuantErr: 15.28799 batch_time=0.51268 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.27855 (QuantReg: 15.37304) QuantErr: 15.37304 batch_time=0.54105 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.32413 (QuantReg: 15.50505) QuantErr: 15.50505 batch_time=0.57171 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.07460 (QuantReg: 15.39927) QuantErr: 15.39927 batch_time=0.57406 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 0.90480 (QuantReg: 15.23726) QuantErr: 15.23726 batch_time=0.56377 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.04375 (QuantReg: 15.64912) QuantErr: 15.64912 batch_time=0.55773 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 0.93065 (QuantReg: 15.22809) QuantErr: 15.22809 batch_time=0.52596 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.06372 (QuantReg: 15.19298) QuantErr: 15.19298 batch_time=0.54942 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 0.96244 (QuantReg: 15.25865) QuantErr: 15.25865 batch_time=0.54783 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.24348 (QuantReg: 15.39562) QuantErr: 15.39562 batch_time=1.38027 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.05668 (QuantReg: 15.50319) QuantErr: 15.50319 batch_time=0.59246 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.16001 (QuantReg: 15.30099) QuantErr: 15.30099 batch_time=0.52466 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.02965 (QuantReg: 15.40388) QuantErr: 15.40388 batch_time=0.56874 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.00098 (QuantReg: 15.27964) QuantErr: 15.27964 batch_time=0.64785 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 0.96436 (QuantReg: 15.48479) QuantErr: 15.48479 batch_time=0.54944 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.24060 (QuantReg: 15.37733) QuantErr: 15.37733 batch_time=0.54129 
Train Epoch: 34 codebook_update_time=2.02661
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch34.pth ...
Done in 4.341s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch34.pth ...
Done in 8.908s
removing stale ckpt [epoch 33] [took 0.01s]
 epoch          : 34
 loss           : 1.036724629163742
 quant_reg      : 15.362457557678223
 quant_err      : 15.362457557678223
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.952
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.91402972476713
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.905
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.385122432110876
 mnt_best       : 45.91402972476713
 not_improved_count: 0
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 0.85856 (QuantReg: 15.47273) QuantErr: 15.47273 batch_time=35.68608 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.26680 (QuantReg: 15.51271) QuantErr: 15.51271 batch_time=0.51849 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.33506 (QuantReg: 15.48943) QuantErr: 15.48943 batch_time=0.51536 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.15366 (QuantReg: 15.36741) QuantErr: 15.36741 batch_time=0.52592 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.24834 (QuantReg: 15.58570) QuantErr: 15.58570 batch_time=0.55349 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 0.95520 (QuantReg: 15.24422) QuantErr: 15.24422 batch_time=0.52749 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.06134 (QuantReg: 15.43233) QuantErr: 15.43233 batch_time=5.74258 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.14229 (QuantReg: 15.36024) QuantErr: 15.36024 batch_time=0.55490 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.04629 (QuantReg: 15.33688) QuantErr: 15.33688 batch_time=0.55585 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.27363 (QuantReg: 15.48397) QuantErr: 15.48397 batch_time=0.55060 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.91712 (QuantReg: 15.36059) QuantErr: 15.36059 batch_time=0.54206 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.16038 (QuantReg: 15.29156) QuantErr: 15.29156 batch_time=0.55105 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.10706 (QuantReg: 15.48854) QuantErr: 15.48854 batch_time=0.55434 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.14706 (QuantReg: 15.55357) QuantErr: 15.55357 batch_time=0.57555 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.39913 (QuantReg: 15.47782) QuantErr: 15.47782 batch_time=0.54710 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.88962 (QuantReg: 15.43383) QuantErr: 15.43383 batch_time=0.57788 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 0.96327 (QuantReg: 15.35571) QuantErr: 15.35571 batch_time=0.60177 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.16686 (QuantReg: 14.85911) QuantErr: 14.85911 batch_time=0.54109 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.14519 (QuantReg: 15.32052) QuantErr: 15.32052 batch_time=0.58106 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 0.93640 (QuantReg: 15.79002) QuantErr: 15.79002 batch_time=0.59344 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.81230 (QuantReg: 15.47143) QuantErr: 15.47143 batch_time=0.66670 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 0.99420 (QuantReg: 15.53459) QuantErr: 15.53459 batch_time=0.52068 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.91248 (QuantReg: 15.41467) QuantErr: 15.41467 batch_time=0.55454 
Train Epoch: 35 codebook_update_time=2.15549
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch35.pth ...
Done in 4.534s
removing stale ckpt [epoch 34] [took 0.07s]
 epoch          : 35
 loss           : 1.0322105708122253
 quant_reg      : 15.428474140167236
 quant_err      : 15.428474140167236
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.991
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.74669268026355
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1765
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.779658275371936
 mnt_best       : 45.91402972476713
 not_improved_count: 1
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 0.99225 (QuantReg: 15.39000) QuantErr: 15.39000 batch_time=34.42360 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.23527 (QuantReg: 15.51197) QuantErr: 15.51197 batch_time=0.54318 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.83528 (QuantReg: 15.53331) QuantErr: 15.53331 batch_time=0.54601 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.32521 (QuantReg: 15.27243) QuantErr: 15.27243 batch_time=0.53454 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.09172 (QuantReg: 15.07590) QuantErr: 15.07590 batch_time=0.55351 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.77554 (QuantReg: 15.22203) QuantErr: 15.22203 batch_time=0.56099 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.16881 (QuantReg: 14.92239) QuantErr: 14.92239 batch_time=0.57358 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.01690 (QuantReg: 15.22341) QuantErr: 15.22341 batch_time=0.55038 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.09700 (QuantReg: 15.40407) QuantErr: 15.40407 batch_time=0.58095 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.01434 (QuantReg: 15.25963) QuantErr: 15.25963 batch_time=0.53994 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.07999 (QuantReg: 15.39102) QuantErr: 15.39102 batch_time=1.32091 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.23446 (QuantReg: 15.39993) QuantErr: 15.39993 batch_time=0.54763 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.00421 (QuantReg: 15.37004) QuantErr: 15.37004 batch_time=0.53962 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.02572 (QuantReg: 15.50618) QuantErr: 15.50618 batch_time=0.56934 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.33844 (QuantReg: 15.30848) QuantErr: 15.30848 batch_time=0.57726 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.87437 (QuantReg: 15.51171) QuantErr: 15.51171 batch_time=0.56913 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.14650 (QuantReg: 15.65565) QuantErr: 15.65565 batch_time=0.51658 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.06197 (QuantReg: 15.09866) QuantErr: 15.09866 batch_time=0.55591 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.93030 (QuantReg: 15.29947) QuantErr: 15.29947 batch_time=1.44203 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.87756 (QuantReg: 15.69855) QuantErr: 15.69855 batch_time=0.64678 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.80767 (QuantReg: 15.65568) QuantErr: 15.65568 batch_time=0.55338 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.96015 (QuantReg: 15.50152) QuantErr: 15.50152 batch_time=0.57402 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.75185 (QuantReg: 15.30378) QuantErr: 15.30378 batch_time=0.56312 
Train Epoch: 36 codebook_update_time=2.37363
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch36.pth ...
Done in 4.964s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 1.0386477608680724
 quant_reg      : 15.47151526260376
 quant_err      : 15.47151526260376
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.676
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.686151191900635
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.02
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.12188219317633
 mnt_best       : 45.91402972476713
 not_improved_count: 2
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.19671 (QuantReg: 15.21342) QuantErr: 15.21342 batch_time=35.63688 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 0.91307 (QuantReg: 15.64678) QuantErr: 15.64678 batch_time=0.59770 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.79031 (QuantReg: 15.47255) QuantErr: 15.47255 batch_time=0.61943 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.07967 (QuantReg: 15.39971) QuantErr: 15.39971 batch_time=0.57878 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 0.88525 (QuantReg: 15.75671) QuantErr: 15.75671 batch_time=0.51819 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 0.88540 (QuantReg: 15.23750) QuantErr: 15.23750 batch_time=0.58760 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.10791 (QuantReg: 15.11495) QuantErr: 15.11495 batch_time=1.11530 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.13536 (QuantReg: 15.81564) QuantErr: 15.81564 batch_time=0.50989 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.01052 (QuantReg: 15.48175) QuantErr: 15.48175 batch_time=0.58995 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.82533 (QuantReg: 15.60886) QuantErr: 15.60886 batch_time=0.55159 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.13084 (QuantReg: 15.57316) QuantErr: 15.57316 batch_time=0.51050 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.82754 (QuantReg: 15.51787) QuantErr: 15.51787 batch_time=0.53127 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 0.99325 (QuantReg: 15.42283) QuantErr: 15.42283 batch_time=0.60821 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.09783 (QuantReg: 15.53568) QuantErr: 15.53568 batch_time=0.58092 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.71438 (QuantReg: 15.70242) QuantErr: 15.70242 batch_time=0.50803 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.91187 (QuantReg: 15.36927) QuantErr: 15.36927 batch_time=0.57688 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.79367 (QuantReg: 15.71101) QuantErr: 15.71101 batch_time=0.55500 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.65576 (QuantReg: 15.75959) QuantErr: 15.75959 batch_time=0.50304 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.11856 (QuantReg: 15.38009) QuantErr: 15.38009 batch_time=0.61621 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.11183 (QuantReg: 15.80797) QuantErr: 15.80797 batch_time=1.14564 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.13565 (QuantReg: 15.26057) QuantErr: 15.26057 batch_time=0.52333 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.17764 (QuantReg: 15.62184) QuantErr: 15.62184 batch_time=0.54786 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.10551 (QuantReg: 15.99996) QuantErr: 15.99996 batch_time=0.54678 
Train Epoch: 37 codebook_update_time=1.84049
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch37.pth ...
Done in 4.570s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 1.0166604969501496
 quant_reg      : 15.51539947128296
 quant_err      : 15.51539947128296
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.501
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.470355443366344
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.236
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.71373865323759
 mnt_best       : 45.91402972476713
 not_improved_count: 3
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.64795 (QuantReg: 15.89533) QuantErr: 15.89533 batch_time=36.16845 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.73977 (QuantReg: 15.74738) QuantErr: 15.74738 batch_time=0.61525 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.92750 (QuantReg: 15.33157) QuantErr: 15.33157 batch_time=0.52236 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.00937 (QuantReg: 15.17902) QuantErr: 15.17902 batch_time=0.56160 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.07770 (QuantReg: 15.55778) QuantErr: 15.55778 batch_time=0.52834 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.78464 (QuantReg: 15.89680) QuantErr: 15.89680 batch_time=0.56984 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 0.85051 (QuantReg: 15.76073) QuantErr: 15.76073 batch_time=0.54410 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.14323 (QuantReg: 15.42402) QuantErr: 15.42402 batch_time=0.58539 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.18752 (QuantReg: 15.73094) QuantErr: 15.73094 batch_time=0.52946 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.07268 (QuantReg: 15.95569) QuantErr: 15.95569 batch_time=0.55874 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.87060 (QuantReg: 15.84417) QuantErr: 15.84417 batch_time=0.54312 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.19541 (QuantReg: 15.52088) QuantErr: 15.52088 batch_time=0.54751 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.12980 (QuantReg: 15.70327) QuantErr: 15.70327 batch_time=1.87589 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 0.99455 (QuantReg: 15.71602) QuantErr: 15.71602 batch_time=5.54813 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.19976 (QuantReg: 15.25477) QuantErr: 15.25477 batch_time=0.58007 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.83572 (QuantReg: 16.00031) QuantErr: 16.00031 batch_time=0.57612 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.93708 (QuantReg: 15.65577) QuantErr: 15.65577 batch_time=0.57463 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.70419 (QuantReg: 15.65547) QuantErr: 15.65547 batch_time=0.52934 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.00804 (QuantReg: 15.90611) QuantErr: 15.90611 batch_time=0.80072 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 0.90212 (QuantReg: 15.70357) QuantErr: 15.70357 batch_time=0.51665 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 0.89857 (QuantReg: 15.74836) QuantErr: 15.74836 batch_time=0.54844 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.19873 (QuantReg: 15.15559) QuantErr: 15.15559 batch_time=0.52646 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.07837 (QuantReg: 15.64479) QuantErr: 15.64479 batch_time=0.57910 
Train Epoch: 38 codebook_update_time=1.96376
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch38.pth ...
Done in 5.283s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 38
 loss           : 1.0094008674621582
 quant_reg      : 15.55774779510498
 quant_err      : 15.55774779510498
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.43
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.05900014113106
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0205
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.84589260960889
 mnt_best       : 45.91402972476713
 not_improved_count: 4
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.89067 (QuantReg: 15.40490) QuantErr: 15.40490 batch_time=37.04705 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 0.91483 (QuantReg: 16.12730) QuantErr: 16.12730 batch_time=0.54777 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.39158 (QuantReg: 15.33875) QuantErr: 15.33875 batch_time=0.84993 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 0.87169 (QuantReg: 15.38726) QuantErr: 15.38726 batch_time=0.58872 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.38265 (QuantReg: 15.58797) QuantErr: 15.58797 batch_time=0.55768 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 0.91851 (QuantReg: 15.46769) QuantErr: 15.46769 batch_time=0.54687 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.27384 (QuantReg: 15.20298) QuantErr: 15.20298 batch_time=0.53114 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.17976 (QuantReg: 15.48402) QuantErr: 15.48402 batch_time=0.57709 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.00784 (QuantReg: 15.76123) QuantErr: 15.76123 batch_time=0.58453 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.02034 (QuantReg: 15.42881) QuantErr: 15.42881 batch_time=0.55877 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.30472 (QuantReg: 15.78355) QuantErr: 15.78355 batch_time=0.56984 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.21484 (QuantReg: 15.63458) QuantErr: 15.63458 batch_time=0.54511 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.45907 (QuantReg: 15.30206) QuantErr: 15.30206 batch_time=0.60544 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.07264 (QuantReg: 15.76161) QuantErr: 15.76161 batch_time=0.53832 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.12373 (QuantReg: 15.78970) QuantErr: 15.78970 batch_time=0.93159 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.11507 (QuantReg: 15.70791) QuantErr: 15.70791 batch_time=0.51544 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.20312 (QuantReg: 15.65191) QuantErr: 15.65191 batch_time=0.53247 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.96314 (QuantReg: 15.72571) QuantErr: 15.72571 batch_time=0.52984 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.79295 (QuantReg: 15.67043) QuantErr: 15.67043 batch_time=0.56893 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.20550 (QuantReg: 15.54866) QuantErr: 15.54866 batch_time=0.55694 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.07917 (QuantReg: 15.55924) QuantErr: 15.55924 batch_time=0.52665 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.14154 (QuantReg: 15.40571) QuantErr: 15.40571 batch_time=0.76986 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.98664 (QuantReg: 15.58422) QuantErr: 15.58422 batch_time=0.51668 
Train Epoch: 39 codebook_update_time=1.82895
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch39.pth ...
Done in 4.768s
removing stale ckpt [epoch 38] [took 0.01s]
 epoch          : 39
 loss           : 1.03060808634758
 quant_reg      : 15.600729038238525
 quant_err      : 15.600729038238525
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.193
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.38359273922839
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.088
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.31902187853475
 mnt_best       : 45.91402972476713
 not_improved_count: 5
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.56785 (QuantReg: 15.29400) QuantErr: 15.29400 batch_time=37.63460 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 0.74791 (QuantReg: 15.68384) QuantErr: 15.68384 batch_time=0.57348 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.04076 (QuantReg: 15.66881) QuantErr: 15.66881 batch_time=0.55866 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.88667 (QuantReg: 15.85219) QuantErr: 15.85219 batch_time=0.53287 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.23115 (QuantReg: 15.40724) QuantErr: 15.40724 batch_time=0.52895 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.07714 (QuantReg: 15.56785) QuantErr: 15.56785 batch_time=0.57301 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.11627 (QuantReg: 15.47141) QuantErr: 15.47141 batch_time=1.54997 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.25010 (QuantReg: 15.32886) QuantErr: 15.32886 batch_time=0.55330 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.15629 (QuantReg: 15.72192) QuantErr: 15.72192 batch_time=0.56968 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.78390 (QuantReg: 15.91412) QuantErr: 15.91412 batch_time=0.56513 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.18784 (QuantReg: 15.35945) QuantErr: 15.35945 batch_time=0.55171 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 0.98359 (QuantReg: 15.73868) QuantErr: 15.73868 batch_time=0.54023 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.10624 (QuantReg: 15.53568) QuantErr: 15.53568 batch_time=1.44962 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.15067 (QuantReg: 15.39245) QuantErr: 15.39245 batch_time=0.53150 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 0.73777 (QuantReg: 15.75137) QuantErr: 15.75137 batch_time=0.58952 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 0.92480 (QuantReg: 15.76736) QuantErr: 15.76736 batch_time=0.51347 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.33158 (QuantReg: 15.11247) QuantErr: 15.11247 batch_time=0.52891 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.00136 (QuantReg: 15.62970) QuantErr: 15.62970 batch_time=0.52668 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 0.93874 (QuantReg: 15.56789) QuantErr: 15.56789 batch_time=0.53953 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.17911 (QuantReg: 15.40086) QuantErr: 15.40086 batch_time=1.97706 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.20581 (QuantReg: 15.64294) QuantErr: 15.64294 batch_time=0.53519 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.93047 (QuantReg: 15.91885) QuantErr: 15.91885 batch_time=0.57672 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.79639 (QuantReg: 15.75667) QuantErr: 15.75667 batch_time=0.55007 
Train Epoch: 40 codebook_update_time=2.06881
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch40.pth ...
Done in 5.710s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 1.0279911248683928
 quant_reg      : 15.628125476837159
 quant_err      : 15.628125476837159
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.897
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.967116717476664
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.263
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.038097770316504
 mnt_best       : 45.91402972476713
 not_improved_count: 6
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.03480 (QuantReg: 15.87345) QuantErr: 15.87345 batch_time=38.32432 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.06814 (QuantReg: 15.74059) QuantErr: 15.74059 batch_time=0.57476 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 0.99157 (QuantReg: 15.30274) QuantErr: 15.30274 batch_time=0.51588 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.10578 (QuantReg: 15.56492) QuantErr: 15.56492 batch_time=0.58548 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.01574 (QuantReg: 15.84365) QuantErr: 15.84365 batch_time=0.59761 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.84298 (QuantReg: 15.78767) QuantErr: 15.78767 batch_time=0.51339 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.85834 (QuantReg: 15.76107) QuantErr: 15.76107 batch_time=0.68682 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.87305 (QuantReg: 15.36063) QuantErr: 15.36063 batch_time=0.57726 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.15060 (QuantReg: 15.91582) QuantErr: 15.91582 batch_time=0.50612 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 0.97749 (QuantReg: 15.78925) QuantErr: 15.78925 batch_time=0.56321 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 0.95990 (QuantReg: 15.83138) QuantErr: 15.83138 batch_time=0.53528 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 0.94787 (QuantReg: 15.57029) QuantErr: 15.57029 batch_time=0.58501 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.17935 (QuantReg: 15.65091) QuantErr: 15.65091 batch_time=1.37175 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.17283 (QuantReg: 15.68825) QuantErr: 15.68825 batch_time=0.78408 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.01642 (QuantReg: 15.89248) QuantErr: 15.89248 batch_time=0.54262 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 0.93403 (QuantReg: 15.82411) QuantErr: 15.82411 batch_time=0.52843 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.10627 (QuantReg: 15.79527) QuantErr: 15.79527 batch_time=0.57402 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.92926 (QuantReg: 15.75822) QuantErr: 15.75822 batch_time=0.50805 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.45520 (QuantReg: 15.65909) QuantErr: 15.65909 batch_time=0.58145 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.18805 (QuantReg: 15.54252) QuantErr: 15.54252 batch_time=0.53709 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 0.94998 (QuantReg: 15.89745) QuantErr: 15.89745 batch_time=0.56576 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.21654 (QuantReg: 15.49227) QuantErr: 15.49227 batch_time=0.53422 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.08658 (QuantReg: 15.54350) QuantErr: 15.54350 batch_time=0.54983 
Train Epoch: 41 codebook_update_time=1.98451
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch41.pth ...
Done in 5.056s
removing stale ckpt [epoch 40] [took 0.02s]
 epoch          : 41
 loss           : 1.02795942568779
 quant_reg      : 15.678276611328124
 quant_err      : 15.678276611328124
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.474
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.109972344243026
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.9905
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.91103725915664
 mnt_best       : 45.91402972476713
 not_improved_count: 7
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 0.94420 (QuantReg: 15.84669) QuantErr: 15.84669 batch_time=41.92145 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.91527 (QuantReg: 16.08628) QuantErr: 16.08628 batch_time=0.56839 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.09989 (QuantReg: 15.77772) QuantErr: 15.77772 batch_time=1.01969 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.20607 (QuantReg: 15.37896) QuantErr: 15.37896 batch_time=0.55778 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.21752 (QuantReg: 15.43893) QuantErr: 15.43893 batch_time=0.59259 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 0.81972 (QuantReg: 15.74090) QuantErr: 15.74090 batch_time=0.53183 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.08685 (QuantReg: 15.65404) QuantErr: 15.65404 batch_time=0.54928 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.18186 (QuantReg: 15.87108) QuantErr: 15.87108 batch_time=3.32673 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.82588 (QuantReg: 15.61414) QuantErr: 15.61414 batch_time=0.52659 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.03893 (QuantReg: 15.70438) QuantErr: 15.70438 batch_time=0.52104 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 0.89682 (QuantReg: 15.50889) QuantErr: 15.50889 batch_time=0.54530 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.11330 (QuantReg: 15.25138) QuantErr: 15.25138 batch_time=0.56705 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 0.97658 (QuantReg: 15.61588) QuantErr: 15.61588 batch_time=0.54052 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.84138 (QuantReg: 15.88359) QuantErr: 15.88359 batch_time=0.55305 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.02387 (QuantReg: 15.87261) QuantErr: 15.87261 batch_time=0.56143 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.20606 (QuantReg: 15.82524) QuantErr: 15.82524 batch_time=0.97736 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.93729 (QuantReg: 15.68107) QuantErr: 15.68107 batch_time=0.59849 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.80132 (QuantReg: 15.87152) QuantErr: 15.87152 batch_time=0.55989 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.83009 (QuantReg: 15.94575) QuantErr: 15.94575 batch_time=0.57294 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 0.98041 (QuantReg: 15.45013) QuantErr: 15.45013 batch_time=0.55241 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.87846 (QuantReg: 15.61740) QuantErr: 15.61740 batch_time=0.53460 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.93584 (QuantReg: 15.57844) QuantErr: 15.57844 batch_time=0.70317 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.25109 (QuantReg: 15.94207) QuantErr: 15.94207 batch_time=0.59390 
Train Epoch: 42 codebook_update_time=1.96127
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch42.pth ...
Done in 6.087s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.0135997154712677
 quant_reg      : 15.70399953842163
 quant_err      : 15.70399953842163
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.344
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.20383578798005
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6485
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.71107788781746
 mnt_best       : 45.91402972476713
 not_improved_count: 8
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.88113 (QuantReg: 15.97475) QuantErr: 15.97475 batch_time=38.67241 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.85204 (QuantReg: 15.58130) QuantErr: 15.58130 batch_time=5.20313 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.03904 (QuantReg: 15.80845) QuantErr: 15.80845 batch_time=0.58492 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.00832 (QuantReg: 15.68978) QuantErr: 15.68978 batch_time=0.56134 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.08671 (QuantReg: 15.78734) QuantErr: 15.78734 batch_time=0.59258 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 0.79624 (QuantReg: 15.92214) QuantErr: 15.92214 batch_time=0.52913 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.29628 (QuantReg: 15.72639) QuantErr: 15.72639 batch_time=0.50665 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 0.95310 (QuantReg: 15.79212) QuantErr: 15.79212 batch_time=0.53493 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.83238 (QuantReg: 15.68058) QuantErr: 15.68058 batch_time=0.55718 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.08391 (QuantReg: 15.75820) QuantErr: 15.75820 batch_time=0.54151 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 0.95625 (QuantReg: 15.83768) QuantErr: 15.83768 batch_time=0.55549 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.90287 (QuantReg: 15.77468) QuantErr: 15.77468 batch_time=0.51012 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 0.78968 (QuantReg: 15.88046) QuantErr: 15.88046 batch_time=0.50840 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.91614 (QuantReg: 15.39643) QuantErr: 15.39643 batch_time=0.53672 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.02815 (QuantReg: 15.89890) QuantErr: 15.89890 batch_time=0.53486 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 0.88693 (QuantReg: 15.69351) QuantErr: 15.69351 batch_time=0.59479 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.73914 (QuantReg: 16.05168) QuantErr: 16.05168 batch_time=0.53877 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.92075 (QuantReg: 15.75085) QuantErr: 15.75085 batch_time=0.55501 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.27966 (QuantReg: 15.83058) QuantErr: 15.83058 batch_time=0.58446 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.24484 (QuantReg: 15.92477) QuantErr: 15.92477 batch_time=0.56323 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.04155 (QuantReg: 15.89104) QuantErr: 15.89104 batch_time=0.53533 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.83347 (QuantReg: 15.71335) QuantErr: 15.71335 batch_time=0.87268 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.01773 (QuantReg: 15.42969) QuantErr: 15.42969 batch_time=0.52052 
Train Epoch: 43 codebook_update_time=1.92195
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch43.pth ...
Done in 4.687s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 1.0093346953392028
 quant_reg      : 15.72687646484375
 quant_err      : 15.72687646484375
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.215
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.39358458256539
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2225
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.32512323977704
 mnt_best       : 45.91402972476713
 not_improved_count: 9
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.90334 (QuantReg: 15.69091) QuantErr: 15.69091 batch_time=40.82513 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.03166 (QuantReg: 15.88461) QuantErr: 15.88461 batch_time=0.57905 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 0.92713 (QuantReg: 15.72821) QuantErr: 15.72821 batch_time=0.52852 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.88121 (QuantReg: 15.72477) QuantErr: 15.72477 batch_time=0.54637 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.12522 (QuantReg: 15.63774) QuantErr: 15.63774 batch_time=0.51238 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.25375 (QuantReg: 15.34673) QuantErr: 15.34673 batch_time=0.52788 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 0.91129 (QuantReg: 15.66986) QuantErr: 15.66986 batch_time=0.55284 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.13810 (QuantReg: 15.66688) QuantErr: 15.66688 batch_time=0.50509 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.26436 (QuantReg: 15.72614) QuantErr: 15.72614 batch_time=0.52553 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 0.99378 (QuantReg: 15.26511) QuantErr: 15.26511 batch_time=0.51985 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.08377 (QuantReg: 15.79349) QuantErr: 15.79349 batch_time=0.51142 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 0.97455 (QuantReg: 15.70654) QuantErr: 15.70654 batch_time=0.55429 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.15148 (QuantReg: 15.90839) QuantErr: 15.90839 batch_time=0.51154 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.18558 (QuantReg: 15.69349) QuantErr: 15.69349 batch_time=0.54527 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.09405 (QuantReg: 15.87374) QuantErr: 15.87374 batch_time=0.60614 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.18764 (QuantReg: 15.83263) QuantErr: 15.83263 batch_time=0.54342 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.02761 (QuantReg: 15.67304) QuantErr: 15.67304 batch_time=0.60001 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.92560 (QuantReg: 15.85080) QuantErr: 15.85080 batch_time=0.54426 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.09880 (QuantReg: 15.84414) QuantErr: 15.84414 batch_time=0.55355 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.10926 (QuantReg: 15.87035) QuantErr: 15.87035 batch_time=0.57230 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.11141 (QuantReg: 15.76801) QuantErr: 15.76801 batch_time=0.56353 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.29715 (QuantReg: 15.75626) QuantErr: 15.75626 batch_time=0.52468 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.14526 (QuantReg: 15.77310) QuantErr: 15.77310 batch_time=0.52607 
Train Epoch: 44 codebook_update_time=1.91725
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch44.pth ...
Done in 6.139s
removing stale ckpt [epoch 43] [took 0.02s]
 epoch          : 44
 loss           : 1.0125712974071504
 quant_reg      : 15.76879581451416
 quant_err      : 15.76879581451416
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.497
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.00617857550071
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.0205
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.52940491864278
 mnt_best       : 45.91402972476713
 not_improved_count: 10
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.08688 (QuantReg: 15.92327) QuantErr: 15.92327 batch_time=40.77258 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.99439 (QuantReg: 15.51185) QuantErr: 15.51185 batch_time=0.57094 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.69490 (QuantReg: 16.21307) QuantErr: 16.21307 batch_time=0.57290 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.23291 (QuantReg: 15.48671) QuantErr: 15.48671 batch_time=0.53501 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.04298 (QuantReg: 15.76211) QuantErr: 15.76211 batch_time=0.57842 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.09751 (QuantReg: 15.85597) QuantErr: 15.85597 batch_time=0.62855 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.54904 (QuantReg: 16.08532) QuantErr: 16.08532 batch_time=0.57190 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 0.92087 (QuantReg: 16.01040) QuantErr: 16.01040 batch_time=0.54014 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 0.98773 (QuantReg: 15.63634) QuantErr: 15.63634 batch_time=0.58433 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.93126 (QuantReg: 16.11891) QuantErr: 16.11891 batch_time=0.54099 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.93019 (QuantReg: 15.96498) QuantErr: 15.96498 batch_time=0.58841 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 0.92537 (QuantReg: 16.09805) QuantErr: 16.09805 batch_time=0.51828 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.77839 (QuantReg: 15.92070) QuantErr: 15.92070 batch_time=0.57183 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.01525 (QuantReg: 15.85592) QuantErr: 15.85592 batch_time=0.55078 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.12936 (QuantReg: 15.68666) QuantErr: 15.68666 batch_time=0.59204 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.83087 (QuantReg: 16.01009) QuantErr: 16.01009 batch_time=0.55017 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.07437 (QuantReg: 15.54761) QuantErr: 15.54761 batch_time=0.55754 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.03902 (QuantReg: 16.16708) QuantErr: 16.16708 batch_time=0.54660 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.90287 (QuantReg: 15.99776) QuantErr: 15.99776 batch_time=0.53564 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.88882 (QuantReg: 15.91792) QuantErr: 15.91792 batch_time=0.58384 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.08923 (QuantReg: 15.58732) QuantErr: 15.58732 batch_time=0.53042 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.73062 (QuantReg: 16.24910) QuantErr: 16.24910 batch_time=0.56626 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.12855 (QuantReg: 15.89825) QuantErr: 15.89825 batch_time=0.56861 
Train Epoch: 45 codebook_update_time=1.87655
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch45.pth ...
Done in 6.609s
removing stale ckpt [epoch 44] [took 0.04s]
 epoch          : 45
 loss           : 1.0011082596778869
 quant_reg      : 15.80975867843628
 quant_err      : 15.80975867843628
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.777
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.97218429138752
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5015
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.83393832742468
 mnt_best       : 45.91402972476713
 not_improved_count: 11
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.99501 (QuantReg: 15.91369) QuantErr: 15.91369 batch_time=36.64751 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.26120 (QuantReg: 15.54454) QuantErr: 15.54454 batch_time=0.54769 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.02813 (QuantReg: 15.98799) QuantErr: 15.98799 batch_time=0.55554 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.92932 (QuantReg: 15.81490) QuantErr: 15.81490 batch_time=0.58365 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 0.96277 (QuantReg: 15.66300) QuantErr: 15.66300 batch_time=0.77361 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.00340 (QuantReg: 15.80226) QuantErr: 15.80226 batch_time=0.55348 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.93188 (QuantReg: 15.91156) QuantErr: 15.91156 batch_time=0.53295 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 0.88613 (QuantReg: 15.49043) QuantErr: 15.49043 batch_time=0.55136 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.70272 (QuantReg: 15.80824) QuantErr: 15.80824 batch_time=0.55231 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.78124 (QuantReg: 16.28192) QuantErr: 16.28192 batch_time=0.52468 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.34879 (QuantReg: 15.90882) QuantErr: 15.90882 batch_time=0.55404 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.08844 (QuantReg: 15.75261) QuantErr: 15.75261 batch_time=0.57558 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.15992 (QuantReg: 15.40165) QuantErr: 15.40165 batch_time=0.56850 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.33970 (QuantReg: 15.58627) QuantErr: 15.58627 batch_time=0.61053 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.24830 (QuantReg: 15.75601) QuantErr: 15.75601 batch_time=0.51951 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.14359 (QuantReg: 15.85279) QuantErr: 15.85279 batch_time=0.64015 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 0.97618 (QuantReg: 15.68716) QuantErr: 15.68716 batch_time=0.52841 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.04497 (QuantReg: 16.04207) QuantErr: 16.04207 batch_time=0.55142 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.91938 (QuantReg: 16.05224) QuantErr: 16.05224 batch_time=0.57847 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.94622 (QuantReg: 16.19364) QuantErr: 16.19364 batch_time=0.54842 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.98984 (QuantReg: 15.80934) QuantErr: 15.80934 batch_time=0.54474 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 0.65051 (QuantReg: 16.07825) QuantErr: 16.07825 batch_time=0.54229 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.01848 (QuantReg: 16.15303) QuantErr: 16.15303 batch_time=0.99857 
Train Epoch: 46 codebook_update_time=2.31784
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch46.pth ...
Done in 4.300s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 1.0056318926811219
 quant_reg      : 15.848232723236084
 quant_err      : 15.848232723236084
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.143
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.09438297276934
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.9025
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.11507420763526
 mnt_best       : 45.91402972476713
 not_improved_count: 12
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.30257 (QuantReg: 15.51974) QuantErr: 15.51974 batch_time=37.37400 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 0.91714 (QuantReg: 15.62314) QuantErr: 15.62314 batch_time=0.89130 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.15017 (QuantReg: 15.85732) QuantErr: 15.85732 batch_time=0.55084 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.24224 (QuantReg: 15.82097) QuantErr: 15.82097 batch_time=0.56236 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 0.97026 (QuantReg: 16.12598) QuantErr: 16.12598 batch_time=0.50175 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.89457 (QuantReg: 16.10008) QuantErr: 16.10008 batch_time=0.71512 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 0.96114 (QuantReg: 16.14113) QuantErr: 16.14113 batch_time=0.81498 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.16040 (QuantReg: 15.79623) QuantErr: 15.79623 batch_time=0.55105 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.20794 (QuantReg: 15.82972) QuantErr: 15.82972 batch_time=0.55373 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.79337 (QuantReg: 16.08937) QuantErr: 16.08937 batch_time=0.67215 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.88246 (QuantReg: 15.97860) QuantErr: 15.97860 batch_time=0.54245 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.93403 (QuantReg: 15.78875) QuantErr: 15.78875 batch_time=0.53623 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.06259 (QuantReg: 16.01286) QuantErr: 16.01286 batch_time=0.55676 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.66385 (QuantReg: 15.73934) QuantErr: 15.73934 batch_time=0.56671 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.07398 (QuantReg: 16.04608) QuantErr: 16.04608 batch_time=0.58537 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.80938 (QuantReg: 15.98145) QuantErr: 15.98145 batch_time=0.52812 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.30211 (QuantReg: 16.12039) QuantErr: 16.12039 batch_time=0.55163 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.18913 (QuantReg: 15.78161) QuantErr: 15.78161 batch_time=0.53300 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.01671 (QuantReg: 15.74589) QuantErr: 15.74589 batch_time=0.53406 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.95055 (QuantReg: 15.70616) QuantErr: 15.70616 batch_time=0.54998 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.68739 (QuantReg: 16.10519) QuantErr: 16.10519 batch_time=0.57585 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.05875 (QuantReg: 15.99784) QuantErr: 15.99784 batch_time=0.54717 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.02561 (QuantReg: 15.91757) QuantErr: 15.91757 batch_time=0.52930 
Train Epoch: 47 codebook_update_time=2.29465
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch47.pth ...
Done in 16.707s
removing stale ckpt [epoch 46] [took 0.10s]
 epoch          : 47
 loss           : 1.0124283721446992
 quant_reg      : 15.878840942382812
 quant_err      : 15.878840942382812
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.531
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.55436859332131
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.907
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.27337590177596
 mnt_best       : 45.91402972476713
 not_improved_count: 13
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.15427 (QuantReg: 15.65228) QuantErr: 15.65228 batch_time=34.80338 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.11848 (QuantReg: 16.01281) QuantErr: 16.01281 batch_time=0.55800 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.04578 (QuantReg: 15.88096) QuantErr: 15.88096 batch_time=0.54411 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.02847 (QuantReg: 15.74093) QuantErr: 15.74093 batch_time=0.57391 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.01996 (QuantReg: 15.68949) QuantErr: 15.68949 batch_time=0.54392 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 0.90699 (QuantReg: 16.05704) QuantErr: 16.05704 batch_time=0.53217 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 0.92969 (QuantReg: 15.88982) QuantErr: 15.88982 batch_time=0.52454 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.12938 (QuantReg: 15.80411) QuantErr: 15.80411 batch_time=0.55693 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.86763 (QuantReg: 16.23256) QuantErr: 16.23256 batch_time=0.52916 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.02737 (QuantReg: 15.98560) QuantErr: 15.98560 batch_time=0.54690 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 0.96301 (QuantReg: 15.96511) QuantErr: 15.96511 batch_time=0.53804 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 0.97061 (QuantReg: 15.54292) QuantErr: 15.54292 batch_time=0.56247 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.13252 (QuantReg: 15.85823) QuantErr: 15.85823 batch_time=0.54926 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.30495 (QuantReg: 15.79618) QuantErr: 15.79618 batch_time=1.76273 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.15452 (QuantReg: 15.79985) QuantErr: 15.79985 batch_time=0.65058 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.18693 (QuantReg: 15.86571) QuantErr: 15.86571 batch_time=0.54274 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.78615 (QuantReg: 16.00128) QuantErr: 16.00128 batch_time=0.52171 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 0.89245 (QuantReg: 16.20256) QuantErr: 16.20256 batch_time=0.53085 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.05146 (QuantReg: 15.88880) QuantErr: 15.88880 batch_time=0.79537 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 0.81170 (QuantReg: 15.90775) QuantErr: 15.90775 batch_time=0.60650 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.16096 (QuantReg: 15.92161) QuantErr: 15.92161 batch_time=0.56032 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.12374 (QuantReg: 15.77503) QuantErr: 15.77503 batch_time=0.57992 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 0.94974 (QuantReg: 15.95325) QuantErr: 15.95325 batch_time=0.53745 
Train Epoch: 48 codebook_update_time=1.83515
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch48.pth ...
Done in 4.215s
removing stale ckpt [epoch 47] [took 0.80s]
 epoch          : 48
 loss           : 1.0040621728897094
 quant_reg      : 15.898938495635987
 quant_err      : 15.898938495635987
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.65
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.54527393939731
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.883
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.04144783481731
 mnt_best       : 45.91402972476713
 not_improved_count: 14
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.04634 (QuantReg: 15.93239) QuantErr: 15.93239 batch_time=35.51146 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.00625 (QuantReg: 15.96148) QuantErr: 15.96148 batch_time=0.53152 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.18149 (QuantReg: 15.97645) QuantErr: 15.97645 batch_time=0.53622 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.18195 (QuantReg: 15.96458) QuantErr: 15.96458 batch_time=0.52480 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.12597 (QuantReg: 15.68548) QuantErr: 15.68548 batch_time=0.95784 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.13646 (QuantReg: 15.95660) QuantErr: 15.95660 batch_time=0.59471 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 0.92409 (QuantReg: 15.75371) QuantErr: 15.75371 batch_time=4.55124 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.76795 (QuantReg: 16.01124) QuantErr: 16.01124 batch_time=0.52213 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.87092 (QuantReg: 15.63495) QuantErr: 15.63495 batch_time=0.60557 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.95756 (QuantReg: 15.94227) QuantErr: 15.94227 batch_time=0.56526 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.06193 (QuantReg: 16.13370) QuantErr: 16.13370 batch_time=0.52724 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.89810 (QuantReg: 15.95630) QuantErr: 15.95630 batch_time=0.54684 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.13176 (QuantReg: 15.67214) QuantErr: 15.67214 batch_time=0.55133 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.19370 (QuantReg: 15.83690) QuantErr: 15.83690 batch_time=0.51298 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.01523 (QuantReg: 15.81894) QuantErr: 15.81894 batch_time=0.54357 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.77995 (QuantReg: 15.96196) QuantErr: 15.96196 batch_time=0.57302 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.85449 (QuantReg: 15.86316) QuantErr: 15.86316 batch_time=0.55897 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 0.97920 (QuantReg: 16.21204) QuantErr: 16.21204 batch_time=0.57157 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.06904 (QuantReg: 15.95325) QuantErr: 15.95325 batch_time=0.51275 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.18163 (QuantReg: 15.75302) QuantErr: 15.75302 batch_time=0.52190 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 0.85115 (QuantReg: 16.04857) QuantErr: 16.04857 batch_time=0.62306 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.73210 (QuantReg: 15.85217) QuantErr: 15.85217 batch_time=0.59475 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.11558 (QuantReg: 15.93599) QuantErr: 15.93599 batch_time=0.52933 
Train Epoch: 49 codebook_update_time=2.21320
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch49.pth ...
Done in 4.875s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 1.0080901684761048
 quant_reg      : 15.925743141174316
 quant_err      : 15.925743141174316
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.432
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.962435812147696
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.0675
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.27378999118772
 mnt_best       : 45.91402972476713
 not_improved_count: 15
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.05203 (QuantReg: 16.01822) QuantErr: 16.01822 batch_time=43.88520 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.51427 (QuantReg: 15.88521) QuantErr: 15.88521 batch_time=0.55129 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 0.81676 (QuantReg: 16.12453) QuantErr: 16.12453 batch_time=0.52915 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 0.88839 (QuantReg: 16.11127) QuantErr: 16.11127 batch_time=0.58636 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.12036 (QuantReg: 15.88702) QuantErr: 15.88702 batch_time=0.55239 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.90680 (QuantReg: 16.03744) QuantErr: 16.03744 batch_time=0.60272 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.22058 (QuantReg: 15.84409) QuantErr: 15.84409 batch_time=0.51863 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.89572 (QuantReg: 15.85339) QuantErr: 15.85339 batch_time=0.57006 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.83730 (QuantReg: 15.89013) QuantErr: 15.89013 batch_time=0.53666 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.02206 (QuantReg: 16.14511) QuantErr: 16.14511 batch_time=0.55848 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.77076 (QuantReg: 16.20450) QuantErr: 16.20450 batch_time=0.54039 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.86814 (QuantReg: 15.80037) QuantErr: 15.80037 batch_time=0.54364 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.03439 (QuantReg: 15.99032) QuantErr: 15.99032 batch_time=0.55448 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.17586 (QuantReg: 15.77483) QuantErr: 15.77483 batch_time=0.52658 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.09540 (QuantReg: 15.89195) QuantErr: 15.89195 batch_time=0.56781 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.75910 (QuantReg: 15.93563) QuantErr: 15.93563 batch_time=0.53871 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.15482 (QuantReg: 16.24323) QuantErr: 16.24323 batch_time=0.59488 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.10224 (QuantReg: 15.98449) QuantErr: 15.98449 batch_time=0.59058 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.05211 (QuantReg: 15.97309) QuantErr: 15.97309 batch_time=0.52314 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.81457 (QuantReg: 16.16358) QuantErr: 16.16358 batch_time=0.56995 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 0.95958 (QuantReg: 15.96733) QuantErr: 15.96733 batch_time=0.52420 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.01067 (QuantReg: 15.90069) QuantErr: 15.90069 batch_time=0.51889 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.00569 (QuantReg: 15.77511) QuantErr: 15.77511 batch_time=0.57450 
Train Epoch: 50 codebook_update_time=2.31078
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/checkpoint-epoch50.pth ...
Done in 6.851s
removing stale ckpt [epoch 49] [took 0.09s]
 epoch          : 50
 loss           : 0.9910432035923005
 quant_reg      : 15.99321955871582
 quant_err      : 15.99321955871582
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.162
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.21127906581954
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.152
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.828396091637615
 mnt_best       : 45.91402972476713
 not_improved_count: 16
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/trained_model.pth ...
Ckpt loaded at epoch 34.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 24.9
 t2v_metrics/R5/final_eval: 56.5
 t2v_metrics/R10/final_eval: 68.8
 t2v_metrics/R50/final_eval: 88.8
 t2v_metrics/MedR/final_eval: 4.0
 t2v_metrics/MeanR/final_eval: 26.952
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 45.91402972476713
 v2t_metrics/R1/final_eval: 25.1
 v2t_metrics/R5/final_eval: 53.9
 v2t_metrics/R10/final_eval: 69.1
 v2t_metrics/R50/final_eval: 89.7
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 24.905
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 45.385122432110876
Best epoch for the monitored metric: 34
Script took 03h56m04s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.03/trained_model.pth
