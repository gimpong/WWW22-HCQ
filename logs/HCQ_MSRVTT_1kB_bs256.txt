Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256
Preparing the dataloaders ...
Loading dataset MSRVTT_miech_trainval in ram ...
Finish loading dataset MSRVTT_miech_trainval in ram, taking 724.9304451942444 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 78.15461421012878 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 59.922539472579956 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch0.pth ...
Done in 10.312s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch0.pth ...
Done in 12.149s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_miech_test/t2v_metrics/R1: 0.1
 MSRVTT_miech_test/t2v_metrics/R5: 0.6
 MSRVTT_miech_test/t2v_metrics/R10: 1.0
 MSRVTT_miech_test/t2v_metrics/R50: 5.0
 MSRVTT_miech_test/t2v_metrics/MedR: 503.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 505.179
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.3914867641168864
 MSRVTT_miech_test/v2t_metrics/R1: 0.1
 MSRVTT_miech_test/v2t_metrics/R5: 0.4
 MSRVTT_miech_test/v2t_metrics/R10: 1.0
 MSRVTT_miech_test/v2t_metrics/R50: 5.4
 MSRVTT_miech_test/v2t_metrics/MedR: 511.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 499.895
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3419951893353394
 mnt_best       : 0.3914867641168864
 not_improved_count: 0
Train Epoch: 1 [1/125 256/32000 (1%)] Loss: 11.22054 (QuantReg: 22.46321) QuantErr: 22.46321 batch_time=34.79225 
Train Epoch: 1 [17/125 4352/32000 (14%)] Loss: 8.83601 (QuantReg: 22.52362) QuantErr: 22.52362 batch_time=0.77490 
Train Epoch: 1 [33/125 8448/32000 (26%)] Loss: 7.88499 (QuantReg: 22.58893) QuantErr: 22.58893 batch_time=0.76594 
Train Epoch: 1 [49/125 12544/32000 (39%)] Loss: 7.06694 (QuantReg: 22.61485) QuantErr: 22.61485 batch_time=0.72749 
Train Epoch: 1 [65/125 16640/32000 (52%)] Loss: 6.64561 (QuantReg: 22.61652) QuantErr: 22.61652 batch_time=9.84259 
Train Epoch: 1 [81/125 20736/32000 (65%)] Loss: 6.33554 (QuantReg: 22.65222) QuantErr: 22.65222 batch_time=0.76161 
Train Epoch: 1 [97/125 24832/32000 (78%)] Loss: 5.86814 (QuantReg: 22.67168) QuantErr: 22.67168 batch_time=0.73820 
Train Epoch: 1 [113/125 28928/32000 (90%)] Loss: 5.55723 (QuantReg: 22.63212) QuantErr: 22.63212 batch_time=0.90274 
Train Epoch: 1 codebook_update_time=2.17825
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch1.pth ...
Done in 3.924s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch1.pth ...
Done in 7.687s
 epoch          : 1
 loss           : 7.144907962799072
 quant_reg      : 22.613368759155275
 quant_err      : 22.613368759155275
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 125
 MSRVTT_miech_test/t2v_metrics/R1: 9.4
 MSRVTT_miech_test/t2v_metrics/R5: 31.0
 MSRVTT_miech_test/t2v_metrics/R10: 44.2
 MSRVTT_miech_test/t2v_metrics/R50: 76.5
 MSRVTT_miech_test/t2v_metrics/MedR: 14.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 46.478
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.440701559684452
 MSRVTT_miech_test/v2t_metrics/R1: 9.3
 MSRVTT_miech_test/v2t_metrics/R5: 28.8
 MSRVTT_miech_test/v2t_metrics/R10: 43.0
 MSRVTT_miech_test/v2t_metrics/R50: 77.0
 MSRVTT_miech_test/v2t_metrics/MedR: 14.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 47.315
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.5829824642258
 mnt_best       : 23.440701559684452
 not_improved_count: 0
Train Epoch: 2 [1/125 256/32000 (1%)] Loss: 5.52022 (QuantReg: 11.53638) QuantErr: 11.53638 batch_time=27.95471 
Train Epoch: 2 [17/125 4352/32000 (14%)] Loss: 5.38947 (QuantReg: 12.41603) QuantErr: 12.41603 batch_time=0.76120 
Train Epoch: 2 [33/125 8448/32000 (26%)] Loss: 5.40120 (QuantReg: 12.59070) QuantErr: 12.59070 batch_time=1.22059 
Train Epoch: 2 [49/125 12544/32000 (39%)] Loss: 5.41590 (QuantReg: 13.02706) QuantErr: 13.02706 batch_time=0.75392 
Train Epoch: 2 [65/125 16640/32000 (52%)] Loss: 4.99132 (QuantReg: 13.82278) QuantErr: 13.82278 batch_time=0.96431 
Train Epoch: 2 [81/125 20736/32000 (65%)] Loss: 5.42638 (QuantReg: 14.16435) QuantErr: 14.16435 batch_time=0.76264 
Train Epoch: 2 [97/125 24832/32000 (78%)] Loss: 4.18448 (QuantReg: 14.55785) QuantErr: 14.55785 batch_time=1.20482 
Train Epoch: 2 [113/125 28928/32000 (90%)] Loss: 4.57510 (QuantReg: 14.90474) QuantErr: 14.90474 batch_time=0.88409 
Train Epoch: 2 codebook_update_time=1.65757
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch2.pth ...
Done in 3.774s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch2.pth ...
Done in 7.701s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 5.071351188659668
 quant_reg      : 13.634022781372071
 quant_err      : 13.634022781372071
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 250
 MSRVTT_miech_test/t2v_metrics/R1: 12.9
 MSRVTT_miech_test/t2v_metrics/R5: 36.4
 MSRVTT_miech_test/t2v_metrics/R10: 51.0
 MSRVTT_miech_test/t2v_metrics/R50: 82.9
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 40.293
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.82396731741951
 MSRVTT_miech_test/v2t_metrics/R1: 11.9
 MSRVTT_miech_test/v2t_metrics/R5: 38.4
 MSRVTT_miech_test/v2t_metrics/R10: 52.1
 MSRVTT_miech_test/v2t_metrics/R50: 83.7
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 38.8975
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.767710725816723
 mnt_best       : 28.82396731741951
 not_improved_count: 0
Train Epoch: 3 [1/125 256/32000 (1%)] Loss: 4.60108 (QuantReg: 12.23358) QuantErr: 12.23358 batch_time=34.15481 
Train Epoch: 3 [17/125 4352/32000 (14%)] Loss: 4.76697 (QuantReg: 12.12225) QuantErr: 12.12225 batch_time=0.75959 
Train Epoch: 3 [33/125 8448/32000 (26%)] Loss: 4.89459 (QuantReg: 12.57542) QuantErr: 12.57542 batch_time=0.75797 
Train Epoch: 3 [49/125 12544/32000 (39%)] Loss: 4.93502 (QuantReg: 12.94420) QuantErr: 12.94420 batch_time=0.75914 
Train Epoch: 3 [65/125 16640/32000 (52%)] Loss: 4.38434 (QuantReg: 13.04647) QuantErr: 13.04647 batch_time=2.39535 
Train Epoch: 3 [81/125 20736/32000 (65%)] Loss: 4.31914 (QuantReg: 13.11998) QuantErr: 13.11998 batch_time=0.76451 
Train Epoch: 3 [97/125 24832/32000 (78%)] Loss: 4.17131 (QuantReg: 13.18764) QuantErr: 13.18764 batch_time=0.75199 
Train Epoch: 3 [113/125 28928/32000 (90%)] Loss: 4.16846 (QuantReg: 13.38591) QuantErr: 13.38591 batch_time=0.89375 
Train Epoch: 3 codebook_update_time=2.31939
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch3.pth ...
Done in 4.036s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch3.pth ...
Done in 7.817s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 4.371496242523193
 quant_reg      : 12.856187561035156
 quant_err      : 12.856187561035156
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 375
 MSRVTT_miech_test/t2v_metrics/R1: 13.8
 MSRVTT_miech_test/t2v_metrics/R5: 39.7
 MSRVTT_miech_test/t2v_metrics/R10: 52.8
 MSRVTT_miech_test/t2v_metrics/R50: 85.1
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 36.236
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.69737021544917
 MSRVTT_miech_test/v2t_metrics/R1: 15.8
 MSRVTT_miech_test/v2t_metrics/R5: 40.4
 MSRVTT_miech_test/v2t_metrics/R10: 54.6
 MSRVTT_miech_test/v2t_metrics/R50: 85.6
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 35.324
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.66457647785836
 mnt_best       : 30.69737021544917
 not_improved_count: 0
Train Epoch: 4 [1/125 256/32000 (1%)] Loss: 3.95077 (QuantReg: 12.11315) QuantErr: 12.11315 batch_time=31.81301 
Train Epoch: 4 [17/125 4352/32000 (14%)] Loss: 4.23675 (QuantReg: 12.52317) QuantErr: 12.52317 batch_time=0.77357 
Train Epoch: 4 [33/125 8448/32000 (26%)] Loss: 3.81531 (QuantReg: 12.53982) QuantErr: 12.53982 batch_time=0.74293 
Train Epoch: 4 [49/125 12544/32000 (39%)] Loss: 3.68556 (QuantReg: 12.53161) QuantErr: 12.53161 batch_time=0.76659 
Train Epoch: 4 [65/125 16640/32000 (52%)] Loss: 3.52479 (QuantReg: 12.72593) QuantErr: 12.72593 batch_time=3.53010 
Train Epoch: 4 [81/125 20736/32000 (65%)] Loss: 3.83458 (QuantReg: 12.68947) QuantErr: 12.68947 batch_time=1.00241 
Train Epoch: 4 [97/125 24832/32000 (78%)] Loss: 3.74380 (QuantReg: 12.92042) QuantErr: 12.92042 batch_time=0.76298 
Train Epoch: 4 [113/125 28928/32000 (90%)] Loss: 3.93080 (QuantReg: 13.18123) QuantErr: 13.18123 batch_time=0.76121 
Train Epoch: 4 codebook_update_time=3.18517
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch4.pth ...
Done in 22.435s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch4.pth ...
Done in 26.273s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 3.8963804359436036
 quant_reg      : 12.77668042755127
 quant_err      : 12.77668042755127
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 500
 MSRVTT_miech_test/t2v_metrics/R1: 15.4
 MSRVTT_miech_test/t2v_metrics/R5: 42.4
 MSRVTT_miech_test/t2v_metrics/R10: 56.6
 MSRVTT_miech_test/t2v_metrics/R50: 85.6
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.663
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.30946593672243
 MSRVTT_miech_test/v2t_metrics/R1: 15.9
 MSRVTT_miech_test/v2t_metrics/R5: 43.4
 MSRVTT_miech_test/v2t_metrics/R10: 57.3
 MSRVTT_miech_test/v2t_metrics/R50: 86.7
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 34.286
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.068040793237685
 mnt_best       : 33.30946593672243
 not_improved_count: 0
Train Epoch: 5 [1/125 256/32000 (1%)] Loss: 3.83292 (QuantReg: 12.58282) QuantErr: 12.58282 batch_time=35.33960 
Train Epoch: 5 [17/125 4352/32000 (14%)] Loss: 3.52401 (QuantReg: 12.75240) QuantErr: 12.75240 batch_time=0.76127 
Train Epoch: 5 [33/125 8448/32000 (26%)] Loss: 3.77440 (QuantReg: 12.81210) QuantErr: 12.81210 batch_time=0.77390 
Train Epoch: 5 [49/125 12544/32000 (39%)] Loss: 3.70792 (QuantReg: 12.88883) QuantErr: 12.88883 batch_time=0.86399 
Train Epoch: 5 [65/125 16640/32000 (52%)] Loss: 3.67928 (QuantReg: 12.75724) QuantErr: 12.75724 batch_time=3.50809 
Train Epoch: 5 [81/125 20736/32000 (65%)] Loss: 3.86171 (QuantReg: 12.83417) QuantErr: 12.83417 batch_time=0.76069 
Train Epoch: 5 [97/125 24832/32000 (78%)] Loss: 3.54681 (QuantReg: 13.23334) QuantErr: 13.23334 batch_time=0.91114 
Train Epoch: 5 [113/125 28928/32000 (90%)] Loss: 3.06033 (QuantReg: 12.82787) QuantErr: 12.82787 batch_time=0.77386 
Train Epoch: 5 codebook_update_time=1.64773
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch5.pth ...
Done in 22.139s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch5.pth ...
Done in 25.788s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 3.6124702129364015
 quant_reg      : 12.839418548583984
 quant_err      : 12.839418548583984
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 625
 MSRVTT_miech_test/t2v_metrics/R1: 16.2
 MSRVTT_miech_test/t2v_metrics/R5: 42.1
 MSRVTT_miech_test/t2v_metrics/R10: 56.5
 MSRVTT_miech_test/t2v_metrics/R50: 86.5
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.217
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.77654208394383
 MSRVTT_miech_test/v2t_metrics/R1: 16.6
 MSRVTT_miech_test/v2t_metrics/R5: 44.0
 MSRVTT_miech_test/v2t_metrics/R10: 58.2
 MSRVTT_miech_test/v2t_metrics/R50: 87.1
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.2115
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.900200051945326
 mnt_best       : 33.77654208394383
 not_improved_count: 0
Train Epoch: 6 [1/125 256/32000 (1%)] Loss: 3.33970 (QuantReg: 12.69226) QuantErr: 12.69226 batch_time=41.98878 
Train Epoch: 6 [17/125 4352/32000 (14%)] Loss: 3.44872 (QuantReg: 12.81182) QuantErr: 12.81182 batch_time=0.75717 
Train Epoch: 6 [33/125 8448/32000 (26%)] Loss: 3.56695 (QuantReg: 12.95270) QuantErr: 12.95270 batch_time=1.38223 
Train Epoch: 6 [49/125 12544/32000 (39%)] Loss: 3.06959 (QuantReg: 12.83099) QuantErr: 12.83099 batch_time=0.76649 
Train Epoch: 6 [65/125 16640/32000 (52%)] Loss: 3.50120 (QuantReg: 12.94109) QuantErr: 12.94109 batch_time=5.31284 
Train Epoch: 6 [81/125 20736/32000 (65%)] Loss: 3.04072 (QuantReg: 12.99586) QuantErr: 12.99586 batch_time=0.75910 
Train Epoch: 6 [97/125 24832/32000 (78%)] Loss: 2.88846 (QuantReg: 12.86917) QuantErr: 12.86917 batch_time=0.79204 
Train Epoch: 6 [113/125 28928/32000 (90%)] Loss: 3.53938 (QuantReg: 12.92261) QuantErr: 12.92261 batch_time=1.58447 
Train Epoch: 6 codebook_update_time=1.67127
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch6.pth ...
Done in 3.735s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 3.316091413497925
 quant_reg      : 12.927182022094726
 quant_err      : 12.927182022094726
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 750
 MSRVTT_miech_test/t2v_metrics/R1: 15.3
 MSRVTT_miech_test/t2v_metrics/R5: 43.3
 MSRVTT_miech_test/t2v_metrics/R10: 57.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.0
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.134
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.58859093935576
 MSRVTT_miech_test/v2t_metrics/R1: 17.0
 MSRVTT_miech_test/v2t_metrics/R5: 45.2
 MSRVTT_miech_test/v2t_metrics/R10: 59.0
 MSRVTT_miech_test/v2t_metrics/R50: 86.8
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 32.241
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.65713587405159
 mnt_best       : 33.77654208394383
 not_improved_count: 1
Train Epoch: 7 [1/125 256/32000 (1%)] Loss: 3.26170 (QuantReg: 12.84764) QuantErr: 12.84764 batch_time=42.21487 
Train Epoch: 7 [17/125 4352/32000 (14%)] Loss: 3.18372 (QuantReg: 12.61767) QuantErr: 12.61767 batch_time=0.77901 
Train Epoch: 7 [33/125 8448/32000 (26%)] Loss: 2.93705 (QuantReg: 13.17697) QuantErr: 13.17697 batch_time=0.75521 
Train Epoch: 7 [49/125 12544/32000 (39%)] Loss: 3.12082 (QuantReg: 13.06590) QuantErr: 13.06590 batch_time=0.86322 
Train Epoch: 7 [65/125 16640/32000 (52%)] Loss: 2.97362 (QuantReg: 12.92366) QuantErr: 12.92366 batch_time=7.53894 
Train Epoch: 7 [81/125 20736/32000 (65%)] Loss: 3.27278 (QuantReg: 12.93341) QuantErr: 12.93341 batch_time=0.77463 
Train Epoch: 7 [97/125 24832/32000 (78%)] Loss: 3.21535 (QuantReg: 13.07325) QuantErr: 13.07325 batch_time=0.73164 
Train Epoch: 7 [113/125 28928/32000 (90%)] Loss: 2.84619 (QuantReg: 13.28358) QuantErr: 13.28358 batch_time=0.75947 
Train Epoch: 7 codebook_update_time=1.70604
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch7.pth ...
Done in 4.053s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch7.pth ...
Done in 7.827s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 3.160963333129883
 quant_reg      : 13.00173585510254
 quant_err      : 13.00173585510254
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 875
 MSRVTT_miech_test/t2v_metrics/R1: 16.6
 MSRVTT_miech_test/t2v_metrics/R5: 43.1
 MSRVTT_miech_test/t2v_metrics/R10: 58.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.596
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.62085459110449
 MSRVTT_miech_test/v2t_metrics/R1: 18.4
 MSRVTT_miech_test/v2t_metrics/R5: 46.4
 MSRVTT_miech_test/v2t_metrics/R10: 60.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.7
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.7225
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.13889842283594
 mnt_best       : 34.62085459110449
 not_improved_count: 0
Train Epoch: 8 [1/125 256/32000 (1%)] Loss: 3.04016 (QuantReg: 13.10106) QuantErr: 13.10106 batch_time=34.24174 
Train Epoch: 8 [17/125 4352/32000 (14%)] Loss: 2.86220 (QuantReg: 13.14320) QuantErr: 13.14320 batch_time=0.83768 
Train Epoch: 8 [33/125 8448/32000 (26%)] Loss: 2.80309 (QuantReg: 13.11233) QuantErr: 13.11233 batch_time=0.76498 
Train Epoch: 8 [49/125 12544/32000 (39%)] Loss: 3.04036 (QuantReg: 12.95486) QuantErr: 12.95486 batch_time=1.53070 
Train Epoch: 8 [65/125 16640/32000 (52%)] Loss: 2.91120 (QuantReg: 13.02761) QuantErr: 13.02761 batch_time=2.05352 
Train Epoch: 8 [81/125 20736/32000 (65%)] Loss: 3.05304 (QuantReg: 13.12555) QuantErr: 13.12555 batch_time=0.74795 
Train Epoch: 8 [97/125 24832/32000 (78%)] Loss: 2.75692 (QuantReg: 13.15223) QuantErr: 13.15223 batch_time=0.75527 
Train Epoch: 8 [113/125 28928/32000 (90%)] Loss: 3.10613 (QuantReg: 13.25929) QuantErr: 13.25929 batch_time=0.75281 
Train Epoch: 8 codebook_update_time=2.03663
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch8.pth ...
Done in 3.953s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch8.pth ...
Done in 7.712s
removing stale ckpt [epoch 7] [took 0.01s]
 epoch          : 8
 loss           : 2.9592648906707764
 quant_reg      : 13.121990676879882
 quant_err      : 13.121990676879882
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 1000
 MSRVTT_miech_test/t2v_metrics/R1: 16.5
 MSRVTT_miech_test/t2v_metrics/R5: 45.4
 MSRVTT_miech_test/t2v_metrics/R10: 59.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.0
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.37602992835178
 MSRVTT_miech_test/v2t_metrics/R1: 19.1
 MSRVTT_miech_test/v2t_metrics/R5: 46.9
 MSRVTT_miech_test/v2t_metrics/R10: 60.5
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.838
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.843142654081106
 mnt_best       : 35.37602992835178
 not_improved_count: 0
Train Epoch: 9 [1/125 256/32000 (1%)] Loss: 3.05329 (QuantReg: 13.13045) QuantErr: 13.13045 batch_time=38.17026 
Train Epoch: 9 [17/125 4352/32000 (14%)] Loss: 2.87447 (QuantReg: 13.23116) QuantErr: 13.23116 batch_time=0.94278 
Train Epoch: 9 [33/125 8448/32000 (26%)] Loss: 2.97846 (QuantReg: 12.87894) QuantErr: 12.87894 batch_time=0.77274 
Train Epoch: 9 [49/125 12544/32000 (39%)] Loss: 2.87823 (QuantReg: 13.46488) QuantErr: 13.46488 batch_time=0.88656 
Train Epoch: 9 [65/125 16640/32000 (52%)] Loss: 2.66600 (QuantReg: 13.48670) QuantErr: 13.48670 batch_time=4.06824 
Train Epoch: 9 [81/125 20736/32000 (65%)] Loss: 2.94758 (QuantReg: 13.17516) QuantErr: 13.17516 batch_time=0.77640 
Train Epoch: 9 [97/125 24832/32000 (78%)] Loss: 2.53943 (QuantReg: 13.28413) QuantErr: 13.28413 batch_time=0.77177 
Train Epoch: 9 [113/125 28928/32000 (90%)] Loss: 2.90423 (QuantReg: 13.50380) QuantErr: 13.50380 batch_time=0.74580 
Train Epoch: 9 codebook_update_time=1.59324
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch9.pth ...
Done in 3.774s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch9.pth ...
Done in 7.612s
removing stale ckpt [epoch 8] [took 0.01s]
 epoch          : 9
 loss           : 2.8091419048309327
 quant_reg      : 13.272320838928223
 quant_err      : 13.272320838928223
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 1125
 MSRVTT_miech_test/t2v_metrics/R1: 19.4
 MSRVTT_miech_test/t2v_metrics/R5: 46.2
 MSRVTT_miech_test/t2v_metrics/R10: 60.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.873
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.87088404117484
 MSRVTT_miech_test/v2t_metrics/R1: 18.8
 MSRVTT_miech_test/v2t_metrics/R5: 47.8
 MSRVTT_miech_test/v2t_metrics/R10: 61.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.3
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 30.884
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.07016031695507
 mnt_best       : 37.87088404117484
 not_improved_count: 0
Train Epoch: 10 [1/125 256/32000 (1%)] Loss: 2.81863 (QuantReg: 13.16295) QuantErr: 13.16295 batch_time=37.81713 
Train Epoch: 10 [17/125 4352/32000 (14%)] Loss: 3.09858 (QuantReg: 13.13674) QuantErr: 13.13674 batch_time=0.74322 
Train Epoch: 10 [33/125 8448/32000 (26%)] Loss: 2.78056 (QuantReg: 13.06147) QuantErr: 13.06147 batch_time=0.76414 
Train Epoch: 10 [49/125 12544/32000 (39%)] Loss: 2.73698 (QuantReg: 13.27669) QuantErr: 13.27669 batch_time=0.75798 
Train Epoch: 10 [65/125 16640/32000 (52%)] Loss: 2.61468 (QuantReg: 13.32524) QuantErr: 13.32524 batch_time=3.46484 
Train Epoch: 10 [81/125 20736/32000 (65%)] Loss: 2.53674 (QuantReg: 13.43327) QuantErr: 13.43327 batch_time=0.81200 
Train Epoch: 10 [97/125 24832/32000 (78%)] Loss: 2.63230 (QuantReg: 13.31630) QuantErr: 13.31630 batch_time=0.75491 
Train Epoch: 10 [113/125 28928/32000 (90%)] Loss: 3.09888 (QuantReg: 13.16811) QuantErr: 13.16811 batch_time=0.75541 
Train Epoch: 10 codebook_update_time=1.65501
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch10.pth ...
Done in 3.864s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 2.699671257019043
 quant_reg      : 13.295018173217773
 quant_err      : 13.295018173217773
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 1250
 MSRVTT_miech_test/t2v_metrics/R1: 18.3
 MSRVTT_miech_test/t2v_metrics/R5: 47.3
 MSRVTT_miech_test/t2v_metrics/R10: 60.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.023
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.35105792788078
 MSRVTT_miech_test/v2t_metrics/R1: 18.7
 MSRVTT_miech_test/v2t_metrics/R5: 48.6
 MSRVTT_miech_test/v2t_metrics/R10: 61.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.853
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.275512391455464
 mnt_best       : 37.87088404117484
 not_improved_count: 1
Train Epoch: 11 [1/125 256/32000 (1%)] Loss: 2.71066 (QuantReg: 13.04454) QuantErr: 13.04454 batch_time=33.52196 
Train Epoch: 11 [17/125 4352/32000 (14%)] Loss: 2.74612 (QuantReg: 13.33845) QuantErr: 13.33845 batch_time=0.76137 
Train Epoch: 11 [33/125 8448/32000 (26%)] Loss: 1.98763 (QuantReg: 13.57366) QuantErr: 13.57366 batch_time=0.75589 
Train Epoch: 11 [49/125 12544/32000 (39%)] Loss: 2.79581 (QuantReg: 13.16792) QuantErr: 13.16792 batch_time=0.92463 
Train Epoch: 11 [65/125 16640/32000 (52%)] Loss: 2.48982 (QuantReg: 13.44580) QuantErr: 13.44580 batch_time=0.76934 
Train Epoch: 11 [81/125 20736/32000 (65%)] Loss: 2.61511 (QuantReg: 13.49733) QuantErr: 13.49733 batch_time=0.76647 
Train Epoch: 11 [97/125 24832/32000 (78%)] Loss: 2.81871 (QuantReg: 13.45825) QuantErr: 13.45825 batch_time=0.77300 
Train Epoch: 11 [113/125 28928/32000 (90%)] Loss: 2.51169 (QuantReg: 13.37259) QuantErr: 13.37259 batch_time=0.88851 
Train Epoch: 11 codebook_update_time=1.66409
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch11.pth ...
Done in 5.878s
removing stale ckpt [epoch 10] [took 0.03s]
 epoch          : 11
 loss           : 2.5978224487304686
 quant_reg      : 13.348742897033691
 quant_err      : 13.348742897033691
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 1375
 MSRVTT_miech_test/t2v_metrics/R1: 18.7
 MSRVTT_miech_test/t2v_metrics/R5: 47.6
 MSRVTT_miech_test/t2v_metrics/R10: 59.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.985
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.448422128846744
 MSRVTT_miech_test/v2t_metrics/R1: 17.4
 MSRVTT_miech_test/v2t_metrics/R5: 48.9
 MSRVTT_miech_test/v2t_metrics/R10: 63.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 30.899
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.76480725492101
 mnt_best       : 37.87088404117484
 not_improved_count: 2
Train Epoch: 12 [1/125 256/32000 (1%)] Loss: 2.66013 (QuantReg: 13.15077) QuantErr: 13.15077 batch_time=43.52095 
Train Epoch: 12 [17/125 4352/32000 (14%)] Loss: 2.67346 (QuantReg: 13.33377) QuantErr: 13.33377 batch_time=0.74375 
Train Epoch: 12 [33/125 8448/32000 (26%)] Loss: 2.75860 (QuantReg: 13.28835) QuantErr: 13.28835 batch_time=0.78121 
Train Epoch: 12 [49/125 12544/32000 (39%)] Loss: 2.38593 (QuantReg: 13.31092) QuantErr: 13.31092 batch_time=0.79524 
Train Epoch: 12 [65/125 16640/32000 (52%)] Loss: 2.60153 (QuantReg: 13.57591) QuantErr: 13.57591 batch_time=6.86558 
Train Epoch: 12 [81/125 20736/32000 (65%)] Loss: 2.55709 (QuantReg: 13.28694) QuantErr: 13.28694 batch_time=0.80462 
Train Epoch: 12 [97/125 24832/32000 (78%)] Loss: 2.52469 (QuantReg: 13.34095) QuantErr: 13.34095 batch_time=0.75043 
Train Epoch: 12 [113/125 28928/32000 (90%)] Loss: 2.38160 (QuantReg: 13.39792) QuantErr: 13.39792 batch_time=0.76892 
Train Epoch: 12 codebook_update_time=1.67530
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch12.pth ...
Done in 4.886s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch12.pth ...
Done in 9.409s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 2.541605522155762
 quant_reg      : 13.418046325683594
 quant_err      : 13.418046325683594
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 1500
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 47.6
 MSRVTT_miech_test/t2v_metrics/R10: 61.9
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.31
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.78414876650286
 MSRVTT_miech_test/v2t_metrics/R1: 19.0
 MSRVTT_miech_test/v2t_metrics/R5: 50.7
 MSRVTT_miech_test/v2t_metrics/R10: 63.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.411
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.36000003098355
 mnt_best       : 38.78414876650286
 not_improved_count: 0
Train Epoch: 13 [1/125 256/32000 (1%)] Loss: 2.48427 (QuantReg: 13.30207) QuantErr: 13.30207 batch_time=48.51157 
Train Epoch: 13 [17/125 4352/32000 (14%)] Loss: 2.48679 (QuantReg: 13.48452) QuantErr: 13.48452 batch_time=0.82184 
Train Epoch: 13 [33/125 8448/32000 (26%)] Loss: 2.29593 (QuantReg: 13.55871) QuantErr: 13.55871 batch_time=0.76304 
Train Epoch: 13 [49/125 12544/32000 (39%)] Loss: 2.48356 (QuantReg: 13.59196) QuantErr: 13.59196 batch_time=0.73869 
Train Epoch: 13 [65/125 16640/32000 (52%)] Loss: 2.78542 (QuantReg: 13.47021) QuantErr: 13.47021 batch_time=6.44139 
Train Epoch: 13 [81/125 20736/32000 (65%)] Loss: 2.42386 (QuantReg: 13.36807) QuantErr: 13.36807 batch_time=0.74369 
Train Epoch: 13 [97/125 24832/32000 (78%)] Loss: 2.72571 (QuantReg: 13.35732) QuantErr: 13.35732 batch_time=0.73993 
Train Epoch: 13 [113/125 28928/32000 (90%)] Loss: 2.29342 (QuantReg: 13.41796) QuantErr: 13.41796 batch_time=0.73567 
Train Epoch: 13 codebook_update_time=1.68515
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch13.pth ...
Done in 4.823s
removing stale ckpt [epoch 12] [took 0.01s]
 epoch          : 13
 loss           : 2.45477956199646
 quant_reg      : 13.433018974304199
 quant_err      : 13.433018974304199
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 1625
 MSRVTT_miech_test/t2v_metrics/R1: 18.6
 MSRVTT_miech_test/t2v_metrics/R5: 48.5
 MSRVTT_miech_test/t2v_metrics/R10: 61.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.827
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.03600004823359
 MSRVTT_miech_test/v2t_metrics/R1: 20.2
 MSRVTT_miech_test/v2t_metrics/R5: 49.8
 MSRVTT_miech_test/v2t_metrics/R10: 63.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.8875
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.890549957022344
 mnt_best       : 38.78414876650286
 not_improved_count: 1
Train Epoch: 14 [1/125 256/32000 (1%)] Loss: 2.56142 (QuantReg: 13.22317) QuantErr: 13.22317 batch_time=53.86773 
Train Epoch: 14 [17/125 4352/32000 (14%)] Loss: 2.41168 (QuantReg: 13.42042) QuantErr: 13.42042 batch_time=0.73854 
Train Epoch: 14 [33/125 8448/32000 (26%)] Loss: 2.02065 (QuantReg: 13.10384) QuantErr: 13.10384 batch_time=0.75980 
Train Epoch: 14 [49/125 12544/32000 (39%)] Loss: 2.73865 (QuantReg: 13.49423) QuantErr: 13.49423 batch_time=0.86651 
Train Epoch: 14 [65/125 16640/32000 (52%)] Loss: 2.20571 (QuantReg: 13.42170) QuantErr: 13.42170 batch_time=9.99751 
Train Epoch: 14 [81/125 20736/32000 (65%)] Loss: 2.57919 (QuantReg: 13.31494) QuantErr: 13.31494 batch_time=1.01953 
Train Epoch: 14 [97/125 24832/32000 (78%)] Loss: 2.18104 (QuantReg: 13.50519) QuantErr: 13.50519 batch_time=0.76737 
Train Epoch: 14 [113/125 28928/32000 (90%)] Loss: 2.16231 (QuantReg: 13.54060) QuantErr: 13.54060 batch_time=0.75199 
Train Epoch: 14 codebook_update_time=1.81981
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch14.pth ...
Done in 6.704s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch14.pth ...
Done in 11.624s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 2.3561461324691773
 quant_reg      : 13.469171844482421
 quant_err      : 13.469171844482421
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 1750
 MSRVTT_miech_test/t2v_metrics/R1: 20.6
 MSRVTT_miech_test/t2v_metrics/R5: 46.9
 MSRVTT_miech_test/t2v_metrics/R10: 62.9
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.62
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.315478841579946
 MSRVTT_miech_test/v2t_metrics/R1: 18.7
 MSRVTT_miech_test/v2t_metrics/R5: 48.2
 MSRVTT_miech_test/v2t_metrics/R10: 62.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.7615
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.39571530607271
 mnt_best       : 39.315478841579946
 not_improved_count: 0
Train Epoch: 15 [1/125 256/32000 (1%)] Loss: 2.53239 (QuantReg: 13.40847) QuantErr: 13.40847 batch_time=47.45547 
Train Epoch: 15 [17/125 4352/32000 (14%)] Loss: 2.35978 (QuantReg: 13.48501) QuantErr: 13.48501 batch_time=0.91132 
Train Epoch: 15 [33/125 8448/32000 (26%)] Loss: 2.68925 (QuantReg: 13.55022) QuantErr: 13.55022 batch_time=0.74297 
Train Epoch: 15 [49/125 12544/32000 (39%)] Loss: 2.52270 (QuantReg: 13.67785) QuantErr: 13.67785 batch_time=0.84565 
Train Epoch: 15 [65/125 16640/32000 (52%)] Loss: 2.42125 (QuantReg: 13.50107) QuantErr: 13.50107 batch_time=5.25319 
Train Epoch: 15 [81/125 20736/32000 (65%)] Loss: 2.13859 (QuantReg: 13.49362) QuantErr: 13.49362 batch_time=0.76308 
Train Epoch: 15 [97/125 24832/32000 (78%)] Loss: 2.02929 (QuantReg: 13.67009) QuantErr: 13.67009 batch_time=1.12708 
Train Epoch: 15 [113/125 28928/32000 (90%)] Loss: 2.21211 (QuantReg: 13.40882) QuantErr: 13.40882 batch_time=0.74599 
Train Epoch: 15 codebook_update_time=1.70772
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch15.pth ...
Done in 4.373s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 2.334986927986145
 quant_reg      : 13.528429977416993
 quant_err      : 13.528429977416993
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 1875
 MSRVTT_miech_test/t2v_metrics/R1: 19.5
 MSRVTT_miech_test/t2v_metrics/R5: 47.5
 MSRVTT_miech_test/t2v_metrics/R10: 62.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.455
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.643111603174205
 MSRVTT_miech_test/v2t_metrics/R1: 20.2
 MSRVTT_miech_test/v2t_metrics/R5: 48.6
 MSRVTT_miech_test/v2t_metrics/R10: 63.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.5955
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.67177067136644
 mnt_best       : 39.315478841579946
 not_improved_count: 1
Train Epoch: 16 [1/125 256/32000 (1%)] Loss: 2.41194 (QuantReg: 13.25203) QuantErr: 13.25203 batch_time=40.84880 
Train Epoch: 16 [17/125 4352/32000 (14%)] Loss: 2.76208 (QuantReg: 13.40850) QuantErr: 13.40850 batch_time=0.76211 
Train Epoch: 16 [33/125 8448/32000 (26%)] Loss: 2.52333 (QuantReg: 13.54211) QuantErr: 13.54211 batch_time=0.76116 
Train Epoch: 16 [49/125 12544/32000 (39%)] Loss: 2.30124 (QuantReg: 13.69122) QuantErr: 13.69122 batch_time=0.88001 
Train Epoch: 16 [65/125 16640/32000 (52%)] Loss: 2.44018 (QuantReg: 13.54159) QuantErr: 13.54159 batch_time=1.29062 
Train Epoch: 16 [81/125 20736/32000 (65%)] Loss: 2.42700 (QuantReg: 13.48810) QuantErr: 13.48810 batch_time=0.77007 
Train Epoch: 16 [97/125 24832/32000 (78%)] Loss: 2.13526 (QuantReg: 13.68351) QuantErr: 13.68351 batch_time=0.95810 
Train Epoch: 16 [113/125 28928/32000 (90%)] Loss: 2.34522 (QuantReg: 13.51759) QuantErr: 13.51759 batch_time=0.73752 
Train Epoch: 16 codebook_update_time=1.67027
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch16.pth ...
Done in 4.732s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 2.2664709510803225
 quant_reg      : 13.568635719299316
 quant_err      : 13.568635719299316
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 2000
 MSRVTT_miech_test/t2v_metrics/R1: 19.0
 MSRVTT_miech_test/t2v_metrics/R5: 48.1
 MSRVTT_miech_test/t2v_metrics/R10: 61.4
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.825
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.28444445978813
 MSRVTT_miech_test/v2t_metrics/R1: 20.5
 MSRVTT_miech_test/v2t_metrics/R5: 50.0
 MSRVTT_miech_test/v2t_metrics/R10: 63.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.882
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.246395778239865
 mnt_best       : 39.315478841579946
 not_improved_count: 2
Train Epoch: 17 [1/125 256/32000 (1%)] Loss: 2.62894 (QuantReg: 13.48268) QuantErr: 13.48268 batch_time=48.63512 
Train Epoch: 17 [17/125 4352/32000 (14%)] Loss: 2.35916 (QuantReg: 13.51303) QuantErr: 13.51303 batch_time=0.90781 
Train Epoch: 17 [33/125 8448/32000 (26%)] Loss: 2.00197 (QuantReg: 13.67505) QuantErr: 13.67505 batch_time=0.79106 
Train Epoch: 17 [49/125 12544/32000 (39%)] Loss: 2.48691 (QuantReg: 13.75295) QuantErr: 13.75295 batch_time=0.74356 
Train Epoch: 17 [65/125 16640/32000 (52%)] Loss: 1.95489 (QuantReg: 13.74450) QuantErr: 13.74450 batch_time=6.87840 
Train Epoch: 17 [81/125 20736/32000 (65%)] Loss: 2.38144 (QuantReg: 13.61131) QuantErr: 13.61131 batch_time=0.75386 
Train Epoch: 17 [97/125 24832/32000 (78%)] Loss: 2.20662 (QuantReg: 13.60362) QuantErr: 13.60362 batch_time=0.75373 
Train Epoch: 17 [113/125 28928/32000 (90%)] Loss: 1.97655 (QuantReg: 13.49603) QuantErr: 13.49603 batch_time=0.75257 
Train Epoch: 17 codebook_update_time=1.70638
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch17.pth ...
Done in 5.913s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch17.pth ...
Done in 10.846s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 2.204135766029358
 quant_reg      : 13.599672798156739
 quant_err      : 13.599672798156739
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 2125
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 48.2
 MSRVTT_miech_test/t2v_metrics/R10: 63.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.265
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.93038223780712
 MSRVTT_miech_test/v2t_metrics/R1: 21.7
 MSRVTT_miech_test/v2t_metrics/R5: 49.1
 MSRVTT_miech_test/v2t_metrics/R10: 63.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.1285
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.833257557358564
 mnt_best       : 39.93038223780712
 not_improved_count: 0
Train Epoch: 18 [1/125 256/32000 (1%)] Loss: 2.20422 (QuantReg: 13.28604) QuantErr: 13.28604 batch_time=49.10953 
Train Epoch: 18 [17/125 4352/32000 (14%)] Loss: 2.24933 (QuantReg: 13.58803) QuantErr: 13.58803 batch_time=0.77693 
Train Epoch: 18 [33/125 8448/32000 (26%)] Loss: 2.14100 (QuantReg: 13.86625) QuantErr: 13.86625 batch_time=0.73584 
Train Epoch: 18 [49/125 12544/32000 (39%)] Loss: 2.26032 (QuantReg: 13.53915) QuantErr: 13.53915 batch_time=2.15728 
Train Epoch: 18 [65/125 16640/32000 (52%)] Loss: 2.23030 (QuantReg: 13.62925) QuantErr: 13.62925 batch_time=5.13077 
Train Epoch: 18 [81/125 20736/32000 (65%)] Loss: 2.03100 (QuantReg: 13.70715) QuantErr: 13.70715 batch_time=0.93758 
Train Epoch: 18 [97/125 24832/32000 (78%)] Loss: 2.41885 (QuantReg: 13.78539) QuantErr: 13.78539 batch_time=0.75172 
Train Epoch: 18 [113/125 28928/32000 (90%)] Loss: 2.33932 (QuantReg: 13.59776) QuantErr: 13.59776 batch_time=2.15187 
Train Epoch: 18 codebook_update_time=1.68026
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch18.pth ...
Done in 5.046s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch18.pth ...
Done in 9.462s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 2.1720503492355347
 quant_reg      : 13.62142780303955
 quant_err      : 13.62142780303955
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 2250
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 48.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.76
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.053046287852915
 MSRVTT_miech_test/v2t_metrics/R1: 21.3
 MSRVTT_miech_test/v2t_metrics/R5: 49.3
 MSRVTT_miech_test/v2t_metrics/R10: 65.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.045
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.90955035892519
 mnt_best       : 40.053046287852915
 not_improved_count: 0
Train Epoch: 19 [1/125 256/32000 (1%)] Loss: 2.18141 (QuantReg: 13.55417) QuantErr: 13.55417 batch_time=44.00640 
Train Epoch: 19 [17/125 4352/32000 (14%)] Loss: 2.15215 (QuantReg: 13.44067) QuantErr: 13.44067 batch_time=0.86109 
Train Epoch: 19 [33/125 8448/32000 (26%)] Loss: 2.06571 (QuantReg: 13.46336) QuantErr: 13.46336 batch_time=0.73660 
Train Epoch: 19 [49/125 12544/32000 (39%)] Loss: 2.41448 (QuantReg: 13.55572) QuantErr: 13.55572 batch_time=0.76350 
Train Epoch: 19 [65/125 16640/32000 (52%)] Loss: 1.92896 (QuantReg: 13.64305) QuantErr: 13.64305 batch_time=1.50978 
Train Epoch: 19 [81/125 20736/32000 (65%)] Loss: 1.89604 (QuantReg: 13.99496) QuantErr: 13.99496 batch_time=1.06944 
Train Epoch: 19 [97/125 24832/32000 (78%)] Loss: 2.13643 (QuantReg: 13.65690) QuantErr: 13.65690 batch_time=0.76909 
Train Epoch: 19 [113/125 28928/32000 (90%)] Loss: 2.18733 (QuantReg: 13.81044) QuantErr: 13.81044 batch_time=0.74428 
Train Epoch: 19 codebook_update_time=1.60276
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch19.pth ...
Done in 4.722s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 2.0826405639648438
 quant_reg      : 13.661567077636718
 quant_err      : 13.661567077636718
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 2375
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 49.1
 MSRVTT_miech_test/t2v_metrics/R10: 62.4
 MSRVTT_miech_test/t2v_metrics/R50: 86.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.622
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.87911168510388
 MSRVTT_miech_test/v2t_metrics/R1: 20.5
 MSRVTT_miech_test/v2t_metrics/R5: 51.4
 MSRVTT_miech_test/v2t_metrics/R10: 65.0
 MSRVTT_miech_test/v2t_metrics/R50: 89.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.5825
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.91445578724553
 mnt_best       : 40.053046287852915
 not_improved_count: 1
Train Epoch: 20 [1/125 256/32000 (1%)] Loss: 2.42830 (QuantReg: 13.70326) QuantErr: 13.70326 batch_time=40.38097 
Train Epoch: 20 [17/125 4352/32000 (14%)] Loss: 2.16669 (QuantReg: 13.69431) QuantErr: 13.69431 batch_time=0.75650 
Train Epoch: 20 [33/125 8448/32000 (26%)] Loss: 2.07693 (QuantReg: 13.60111) QuantErr: 13.60111 batch_time=0.87683 
Train Epoch: 20 [49/125 12544/32000 (39%)] Loss: 2.02824 (QuantReg: 13.95107) QuantErr: 13.95107 batch_time=0.78634 
Train Epoch: 20 [65/125 16640/32000 (52%)] Loss: 2.31153 (QuantReg: 13.76853) QuantErr: 13.76853 batch_time=2.61354 
Train Epoch: 20 [81/125 20736/32000 (65%)] Loss: 2.17808 (QuantReg: 13.81916) QuantErr: 13.81916 batch_time=0.75499 
Train Epoch: 20 [97/125 24832/32000 (78%)] Loss: 2.10172 (QuantReg: 13.64573) QuantErr: 13.64573 batch_time=0.82103 
Train Epoch: 20 [113/125 28928/32000 (90%)] Loss: 1.85423 (QuantReg: 13.96392) QuantErr: 13.96392 batch_time=0.77453 
Train Epoch: 20 codebook_update_time=1.72508
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch20.pth ...
Done in 4.696s
removing stale ckpt [epoch 19] [took 0.01s]
 epoch          : 20
 loss           : 2.0529684944152833
 quant_reg      : 13.739807838439942
 quant_err      : 13.739807838439942
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 2500
 MSRVTT_miech_test/t2v_metrics/R1: 19.4
 MSRVTT_miech_test/t2v_metrics/R5: 49.8
 MSRVTT_miech_test/t2v_metrics/R10: 62.8
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.42
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.29436173151652
 MSRVTT_miech_test/v2t_metrics/R1: 20.1
 MSRVTT_miech_test/v2t_metrics/R5: 50.7
 MSRVTT_miech_test/v2t_metrics/R10: 65.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.281
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.60596121225484
 mnt_best       : 40.053046287852915
 not_improved_count: 2
Train Epoch: 21 [1/125 256/32000 (1%)] Loss: 1.98311 (QuantReg: 13.58353) QuantErr: 13.58353 batch_time=48.89091 
Train Epoch: 21 [17/125 4352/32000 (14%)] Loss: 2.45533 (QuantReg: 13.60883) QuantErr: 13.60883 batch_time=0.74841 
Train Epoch: 21 [33/125 8448/32000 (26%)] Loss: 1.84404 (QuantReg: 13.70539) QuantErr: 13.70539 batch_time=0.98337 
Train Epoch: 21 [49/125 12544/32000 (39%)] Loss: 1.97338 (QuantReg: 13.49461) QuantErr: 13.49461 batch_time=0.94131 
Train Epoch: 21 [65/125 16640/32000 (52%)] Loss: 2.16207 (QuantReg: 13.61793) QuantErr: 13.61793 batch_time=10.77687 
Train Epoch: 21 [81/125 20736/32000 (65%)] Loss: 1.97316 (QuantReg: 13.83328) QuantErr: 13.83328 batch_time=0.95737 
Train Epoch: 21 [97/125 24832/32000 (78%)] Loss: 1.89764 (QuantReg: 13.60732) QuantErr: 13.60732 batch_time=0.73842 
Train Epoch: 21 [113/125 28928/32000 (90%)] Loss: 2.07589 (QuantReg: 13.61283) QuantErr: 13.61283 batch_time=0.73555 
Train Epoch: 21 codebook_update_time=1.67216
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch21.pth ...
Done in 4.434s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 2.0231476726531983
 quant_reg      : 13.771922416687012
 quant_err      : 13.771922416687012
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 2625
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.4
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.349
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.60244092698029
 MSRVTT_miech_test/v2t_metrics/R1: 20.0
 MSRVTT_miech_test/v2t_metrics/R5: 51.0
 MSRVTT_miech_test/v2t_metrics/R10: 65.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.007
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.61830974641457
 mnt_best       : 40.053046287852915
 not_improved_count: 3
Train Epoch: 22 [1/125 256/32000 (1%)] Loss: 2.04477 (QuantReg: 13.56216) QuantErr: 13.56216 batch_time=36.71061 
Train Epoch: 22 [17/125 4352/32000 (14%)] Loss: 1.80119 (QuantReg: 13.76640) QuantErr: 13.76640 batch_time=0.73539 
Train Epoch: 22 [33/125 8448/32000 (26%)] Loss: 1.92718 (QuantReg: 13.69635) QuantErr: 13.69635 batch_time=0.78949 
Train Epoch: 22 [49/125 12544/32000 (39%)] Loss: 2.17488 (QuantReg: 13.65924) QuantErr: 13.65924 batch_time=0.94488 
Train Epoch: 22 [65/125 16640/32000 (52%)] Loss: 2.27940 (QuantReg: 13.66930) QuantErr: 13.66930 batch_time=1.20232 
Train Epoch: 22 [81/125 20736/32000 (65%)] Loss: 1.86143 (QuantReg: 13.90684) QuantErr: 13.90684 batch_time=0.75715 
Train Epoch: 22 [97/125 24832/32000 (78%)] Loss: 2.29977 (QuantReg: 13.65008) QuantErr: 13.65008 batch_time=0.78305 
Train Epoch: 22 [113/125 28928/32000 (90%)] Loss: 1.97236 (QuantReg: 13.71314) QuantErr: 13.71314 batch_time=0.90260 
Train Epoch: 22 codebook_update_time=1.69179
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch22.pth ...
Done in 4.983s
removing stale ckpt [epoch 21] [took 0.01s]
 epoch          : 22
 loss           : 2.001939820289612
 quant_reg      : 13.765511558532715
 quant_err      : 13.765511558532715
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 2750
 MSRVTT_miech_test/t2v_metrics/R1: 20.5
 MSRVTT_miech_test/t2v_metrics/R5: 49.4
 MSRVTT_miech_test/t2v_metrics/R10: 62.6
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.75
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.873563264893924
 MSRVTT_miech_test/v2t_metrics/R1: 20.8
 MSRVTT_miech_test/v2t_metrics/R5: 51.3
 MSRVTT_miech_test/v2t_metrics/R10: 65.9
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.1605
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.27515424460387
 mnt_best       : 40.053046287852915
 not_improved_count: 4
Train Epoch: 23 [1/125 256/32000 (1%)] Loss: 2.09348 (QuantReg: 13.59674) QuantErr: 13.59674 batch_time=39.76056 
Train Epoch: 23 [17/125 4352/32000 (14%)] Loss: 1.88114 (QuantReg: 14.02988) QuantErr: 14.02988 batch_time=0.87056 
Train Epoch: 23 [33/125 8448/32000 (26%)] Loss: 1.84935 (QuantReg: 13.51458) QuantErr: 13.51458 batch_time=0.94684 
Train Epoch: 23 [49/125 12544/32000 (39%)] Loss: 1.86078 (QuantReg: 13.80385) QuantErr: 13.80385 batch_time=0.74899 
Train Epoch: 23 [65/125 16640/32000 (52%)] Loss: 1.79694 (QuantReg: 13.83773) QuantErr: 13.83773 batch_time=2.88928 
Train Epoch: 23 [81/125 20736/32000 (65%)] Loss: 2.05847 (QuantReg: 13.97825) QuantErr: 13.97825 batch_time=0.92403 
Train Epoch: 23 [97/125 24832/32000 (78%)] Loss: 1.71007 (QuantReg: 14.00518) QuantErr: 14.00518 batch_time=0.75427 
Train Epoch: 23 [113/125 28928/32000 (90%)] Loss: 1.97989 (QuantReg: 14.03445) QuantErr: 14.03445 batch_time=0.79449 
Train Epoch: 23 codebook_update_time=1.77424
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch23.pth ...
Done in 5.251s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch23.pth ...
Done in 10.251s
removing stale ckpt [epoch 22] [took 0.06s]
 epoch          : 23
 loss           : 1.9597919788360596
 quant_reg      : 13.815939735412597
 quant_err      : 13.815939735412597
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 2875
 MSRVTT_miech_test/t2v_metrics/R1: 22.1
 MSRVTT_miech_test/t2v_metrics/R5: 50.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.529
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.424283869742865
 MSRVTT_miech_test/v2t_metrics/R1: 20.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.0
 MSRVTT_miech_test/v2t_metrics/R10: 66.9
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.261
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.73738631940688
 mnt_best       : 41.424283869742865
 not_improved_count: 0
Train Epoch: 24 [1/125 256/32000 (1%)] Loss: 1.86350 (QuantReg: 13.59664) QuantErr: 13.59664 batch_time=36.90065 
Train Epoch: 24 [17/125 4352/32000 (14%)] Loss: 2.08664 (QuantReg: 13.81259) QuantErr: 13.81259 batch_time=0.76052 
Train Epoch: 24 [33/125 8448/32000 (26%)] Loss: 2.04111 (QuantReg: 13.91562) QuantErr: 13.91562 batch_time=0.75128 
Train Epoch: 24 [49/125 12544/32000 (39%)] Loss: 1.69146 (QuantReg: 13.93958) QuantErr: 13.93958 batch_time=0.75462 
Train Epoch: 24 [65/125 16640/32000 (52%)] Loss: 1.95676 (QuantReg: 13.84752) QuantErr: 13.84752 batch_time=1.12712 
Train Epoch: 24 [81/125 20736/32000 (65%)] Loss: 2.17756 (QuantReg: 14.04591) QuantErr: 14.04591 batch_time=0.80151 
Train Epoch: 24 [97/125 24832/32000 (78%)] Loss: 1.86770 (QuantReg: 13.75359) QuantErr: 13.75359 batch_time=0.91515 
Train Epoch: 24 [113/125 28928/32000 (90%)] Loss: 2.03895 (QuantReg: 13.85777) QuantErr: 13.85777 batch_time=0.81789 
Train Epoch: 24 codebook_update_time=1.68352
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch24.pth ...
Done in 5.370s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 1.9508346548080444
 quant_reg      : 13.839537651062011
 quant_err      : 13.839537651062011
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 3000
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 50.1
 MSRVTT_miech_test/t2v_metrics/R10: 62.6
 MSRVTT_miech_test/t2v_metrics/R50: 88.1
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.023
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.19087563020558
 MSRVTT_miech_test/v2t_metrics/R1: 19.8
 MSRVTT_miech_test/v2t_metrics/R5: 51.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.141
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.6143271687102
 mnt_best       : 41.424283869742865
 not_improved_count: 1
Train Epoch: 25 [1/125 256/32000 (1%)] Loss: 1.95137 (QuantReg: 13.70841) QuantErr: 13.70841 batch_time=45.46909 
Train Epoch: 25 [17/125 4352/32000 (14%)] Loss: 2.03101 (QuantReg: 13.85451) QuantErr: 13.85451 batch_time=0.81344 
Train Epoch: 25 [33/125 8448/32000 (26%)] Loss: 2.09199 (QuantReg: 14.02697) QuantErr: 14.02697 batch_time=0.82948 
Train Epoch: 25 [49/125 12544/32000 (39%)] Loss: 1.81067 (QuantReg: 13.94399) QuantErr: 13.94399 batch_time=0.93893 
Train Epoch: 25 [65/125 16640/32000 (52%)] Loss: 1.81931 (QuantReg: 14.00824) QuantErr: 14.00824 batch_time=9.05342 
Train Epoch: 25 [81/125 20736/32000 (65%)] Loss: 2.00177 (QuantReg: 13.76741) QuantErr: 13.76741 batch_time=0.74340 
Train Epoch: 25 [97/125 24832/32000 (78%)] Loss: 2.04159 (QuantReg: 13.80578) QuantErr: 13.80578 batch_time=0.75015 
Train Epoch: 25 [113/125 28928/32000 (90%)] Loss: 1.95666 (QuantReg: 13.88327) QuantErr: 13.88327 batch_time=0.97312 
Train Epoch: 25 codebook_update_time=1.66735
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch25.pth ...
Done in 5.914s
removing stale ckpt [epoch 24] [took 0.01s]
 epoch          : 25
 loss           : 1.9254265727996827
 quant_reg      : 13.834141342163086
 quant_err      : 13.834141342163086
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 3125
 MSRVTT_miech_test/t2v_metrics/R1: 20.4
 MSRVTT_miech_test/t2v_metrics/R5: 48.7
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.59
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.8086654027462
 MSRVTT_miech_test/v2t_metrics/R1: 19.8
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 89.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.613
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.84424985743682
 mnt_best       : 41.424283869742865
 not_improved_count: 2
Train Epoch: 26 [1/125 256/32000 (1%)] Loss: 2.24081 (QuantReg: 13.81204) QuantErr: 13.81204 batch_time=41.67219 
Train Epoch: 26 [17/125 4352/32000 (14%)] Loss: 1.73692 (QuantReg: 13.96371) QuantErr: 13.96371 batch_time=0.75578 
Train Epoch: 26 [33/125 8448/32000 (26%)] Loss: 1.80292 (QuantReg: 14.06556) QuantErr: 14.06556 batch_time=0.74690 
Train Epoch: 26 [49/125 12544/32000 (39%)] Loss: 1.94858 (QuantReg: 13.99531) QuantErr: 13.99531 batch_time=0.74031 
Train Epoch: 26 [65/125 16640/32000 (52%)] Loss: 1.95051 (QuantReg: 13.85513) QuantErr: 13.85513 batch_time=9.47905 
Train Epoch: 26 [81/125 20736/32000 (65%)] Loss: 1.81051 (QuantReg: 14.07513) QuantErr: 14.07513 batch_time=0.92224 
Train Epoch: 26 [97/125 24832/32000 (78%)] Loss: 2.15280 (QuantReg: 13.95129) QuantErr: 13.95129 batch_time=0.96895 
Train Epoch: 26 [113/125 28928/32000 (90%)] Loss: 2.05496 (QuantReg: 13.96871) QuantErr: 13.96871 batch_time=0.78596 
Train Epoch: 26 codebook_update_time=1.64939
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch26.pth ...
Done in 14.495s
removing stale ckpt [epoch 25] [took 0.22s]
 epoch          : 26
 loss           : 1.9163724565505982
 quant_reg      : 13.902491485595704
 quant_err      : 13.902491485595704
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 3250
 MSRVTT_miech_test/t2v_metrics/R1: 20.4
 MSRVTT_miech_test/t2v_metrics/R5: 49.6
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.112
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.19903465417825
 MSRVTT_miech_test/v2t_metrics/R1: 20.8
 MSRVTT_miech_test/v2t_metrics/R5: 51.4
 MSRVTT_miech_test/v2t_metrics/R10: 66.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.9915
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.42692515965441
 mnt_best       : 41.424283869742865
 not_improved_count: 3
Train Epoch: 27 [1/125 256/32000 (1%)] Loss: 1.74988 (QuantReg: 13.77476) QuantErr: 13.77476 batch_time=38.86135 
Train Epoch: 27 [17/125 4352/32000 (14%)] Loss: 1.85879 (QuantReg: 13.78182) QuantErr: 13.78182 batch_time=6.36640 
Train Epoch: 27 [33/125 8448/32000 (26%)] Loss: 2.00047 (QuantReg: 13.79410) QuantErr: 13.79410 batch_time=0.77901 
Train Epoch: 27 [49/125 12544/32000 (39%)] Loss: 1.79641 (QuantReg: 13.88369) QuantErr: 13.88369 batch_time=0.73767 
Train Epoch: 27 [65/125 16640/32000 (52%)] Loss: 1.91764 (QuantReg: 14.10116) QuantErr: 14.10116 batch_time=0.97032 
Train Epoch: 27 [81/125 20736/32000 (65%)] Loss: 1.80549 (QuantReg: 13.93476) QuantErr: 13.93476 batch_time=5.10951 
Train Epoch: 27 [97/125 24832/32000 (78%)] Loss: 1.71196 (QuantReg: 13.87364) QuantErr: 13.87364 batch_time=0.78616 
Train Epoch: 27 [113/125 28928/32000 (90%)] Loss: 1.82820 (QuantReg: 14.09123) QuantErr: 14.09123 batch_time=0.74627 
Train Epoch: 27 codebook_update_time=1.62287
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch27.pth ...
Done in 6.465s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 1.891932131767273
 quant_reg      : 13.895119407653809
 quant_err      : 13.895119407653809
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 3375
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.977
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.275333767764366
 MSRVTT_miech_test/v2t_metrics/R1: 20.5
 MSRVTT_miech_test/v2t_metrics/R5: 51.7
 MSRVTT_miech_test/v2t_metrics/R10: 66.6
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.1845
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.327539004499634
 mnt_best       : 41.424283869742865
 not_improved_count: 4
Train Epoch: 28 [1/125 256/32000 (1%)] Loss: 1.92196 (QuantReg: 14.00453) QuantErr: 14.00453 batch_time=45.91486 
Train Epoch: 28 [17/125 4352/32000 (14%)] Loss: 1.99533 (QuantReg: 13.91866) QuantErr: 13.91866 batch_time=0.93370 
Train Epoch: 28 [33/125 8448/32000 (26%)] Loss: 2.01035 (QuantReg: 13.74963) QuantErr: 13.74963 batch_time=0.75902 
Train Epoch: 28 [49/125 12544/32000 (39%)] Loss: 1.67981 (QuantReg: 13.87043) QuantErr: 13.87043 batch_time=0.79529 
Train Epoch: 28 [65/125 16640/32000 (52%)] Loss: 1.88137 (QuantReg: 14.01373) QuantErr: 14.01373 batch_time=7.24338 
Train Epoch: 28 [81/125 20736/32000 (65%)] Loss: 1.74571 (QuantReg: 13.97671) QuantErr: 13.97671 batch_time=0.76724 
Train Epoch: 28 [97/125 24832/32000 (78%)] Loss: 1.66750 (QuantReg: 13.94196) QuantErr: 13.94196 batch_time=0.74699 
Train Epoch: 28 [113/125 28928/32000 (90%)] Loss: 1.70680 (QuantReg: 13.85940) QuantErr: 13.85940 batch_time=0.74906 
Train Epoch: 28 codebook_update_time=1.77494
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch28.pth ...
Done in 4.695s
removing stale ckpt [epoch 27] [took 0.02s]
 epoch          : 28
 loss           : 1.8783066835403441
 quant_reg      : 13.899159393310548
 quant_err      : 13.899159393310548
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 3500
 MSRVTT_miech_test/t2v_metrics/R1: 21.6
 MSRVTT_miech_test/t2v_metrics/R5: 48.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.9
 MSRVTT_miech_test/t2v_metrics/R50: 88.0
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.861
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.92629550287182
 MSRVTT_miech_test/v2t_metrics/R1: 22.3
 MSRVTT_miech_test/v2t_metrics/R5: 52.1
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.048
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.441379666462346
 mnt_best       : 41.424283869742865
 not_improved_count: 5
Train Epoch: 29 [1/125 256/32000 (1%)] Loss: 2.00640 (QuantReg: 13.85055) QuantErr: 13.85055 batch_time=38.74511 
Train Epoch: 29 [17/125 4352/32000 (14%)] Loss: 1.74788 (QuantReg: 13.91898) QuantErr: 13.91898 batch_time=4.68505 
Train Epoch: 29 [33/125 8448/32000 (26%)] Loss: 1.91198 (QuantReg: 13.90275) QuantErr: 13.90275 batch_time=0.88094 
Train Epoch: 29 [49/125 12544/32000 (39%)] Loss: 2.02695 (QuantReg: 13.89642) QuantErr: 13.89642 batch_time=0.76570 
Train Epoch: 29 [65/125 16640/32000 (52%)] Loss: 1.58849 (QuantReg: 13.94681) QuantErr: 13.94681 batch_time=3.27252 
Train Epoch: 29 [81/125 20736/32000 (65%)] Loss: 1.96295 (QuantReg: 13.92408) QuantErr: 13.92408 batch_time=3.82053 
Train Epoch: 29 [97/125 24832/32000 (78%)] Loss: 1.65159 (QuantReg: 13.80670) QuantErr: 13.80670 batch_time=0.90024 
Train Epoch: 29 [113/125 28928/32000 (90%)] Loss: 1.84956 (QuantReg: 13.77927) QuantErr: 13.77927 batch_time=0.77843 
Train Epoch: 29 codebook_update_time=1.71519
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch29.pth ...
Done in 12.004s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 1.8754233379364014
 quant_reg      : 13.950641624450684
 quant_err      : 13.950641624450684
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 3625
 MSRVTT_miech_test/t2v_metrics/R1: 20.4
 MSRVTT_miech_test/t2v_metrics/R5: 49.3
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.895
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.096983830039306
 MSRVTT_miech_test/v2t_metrics/R1: 20.4
 MSRVTT_miech_test/v2t_metrics/R5: 52.7
 MSRVTT_miech_test/v2t_metrics/R10: 65.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.9745
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.378562496924836
 mnt_best       : 41.424283869742865
 not_improved_count: 6
Train Epoch: 30 [1/125 256/32000 (1%)] Loss: 1.51806 (QuantReg: 13.84069) QuantErr: 13.84069 batch_time=42.19455 
Train Epoch: 30 [17/125 4352/32000 (14%)] Loss: 2.02120 (QuantReg: 13.78665) QuantErr: 13.78665 batch_time=0.75838 
Train Epoch: 30 [33/125 8448/32000 (26%)] Loss: 1.92321 (QuantReg: 13.89542) QuantErr: 13.89542 batch_time=0.92384 
Train Epoch: 30 [49/125 12544/32000 (39%)] Loss: 1.83387 (QuantReg: 13.88828) QuantErr: 13.88828 batch_time=0.75131 
Train Epoch: 30 [65/125 16640/32000 (52%)] Loss: 2.10003 (QuantReg: 13.91800) QuantErr: 13.91800 batch_time=5.19994 
Train Epoch: 30 [81/125 20736/32000 (65%)] Loss: 1.96709 (QuantReg: 13.85707) QuantErr: 13.85707 batch_time=2.04525 
Train Epoch: 30 [97/125 24832/32000 (78%)] Loss: 1.66128 (QuantReg: 13.94140) QuantErr: 13.94140 batch_time=0.75976 
Train Epoch: 30 [113/125 28928/32000 (90%)] Loss: 1.70818 (QuantReg: 14.04625) QuantErr: 14.04625 batch_time=0.76542 
Train Epoch: 30 codebook_update_time=1.76241
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch30.pth ...
Done in 5.554s
removing stale ckpt [epoch 29] [took 0.02s]
 epoch          : 30
 loss           : 1.8791937675476074
 quant_reg      : 13.934897857666016
 quant_err      : 13.934897857666016
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 3750
 MSRVTT_miech_test/t2v_metrics/R1: 20.3
 MSRVTT_miech_test/t2v_metrics/R5: 50.2
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.898
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.29442174553904
 MSRVTT_miech_test/v2t_metrics/R1: 21.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.9
 MSRVTT_miech_test/v2t_metrics/R10: 66.5
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.557
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.8912065285779
 mnt_best       : 41.424283869742865
 not_improved_count: 7
Train Epoch: 31 [1/125 256/32000 (1%)] Loss: 1.67119 (QuantReg: 13.95694) QuantErr: 13.95694 batch_time=46.10137 
Train Epoch: 31 [17/125 4352/32000 (14%)] Loss: 2.10543 (QuantReg: 13.93321) QuantErr: 13.93321 batch_time=0.77870 
Train Epoch: 31 [33/125 8448/32000 (26%)] Loss: 1.89476 (QuantReg: 14.09972) QuantErr: 14.09972 batch_time=0.74970 
Train Epoch: 31 [49/125 12544/32000 (39%)] Loss: 1.61904 (QuantReg: 14.12189) QuantErr: 14.12189 batch_time=0.87179 
Train Epoch: 31 [65/125 16640/32000 (52%)] Loss: 1.91343 (QuantReg: 14.07046) QuantErr: 14.07046 batch_time=7.93747 
Train Epoch: 31 [81/125 20736/32000 (65%)] Loss: 1.80982 (QuantReg: 14.02113) QuantErr: 14.02113 batch_time=0.78013 
Train Epoch: 31 [97/125 24832/32000 (78%)] Loss: 1.73254 (QuantReg: 13.69458) QuantErr: 13.69458 batch_time=0.88062 
Train Epoch: 31 [113/125 28928/32000 (90%)] Loss: 1.85402 (QuantReg: 13.82537) QuantErr: 13.82537 batch_time=0.75221 
Train Epoch: 31 codebook_update_time=1.77583
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch31.pth ...
Done in 4.425s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 31
 loss           : 1.8471965188980102
 quant_reg      : 13.972015876770019
 quant_err      : 13.972015876770019
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 3875
 MSRVTT_miech_test/t2v_metrics/R1: 20.5
 MSRVTT_miech_test/t2v_metrics/R5: 49.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.827
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.18470825862206
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.3
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 89.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.298
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.92101828375612
 mnt_best       : 41.424283869742865
 not_improved_count: 8
Train Epoch: 32 [1/125 256/32000 (1%)] Loss: 1.46913 (QuantReg: 14.11601) QuantErr: 14.11601 batch_time=59.88959 
Train Epoch: 32 [17/125 4352/32000 (14%)] Loss: 1.77590 (QuantReg: 14.13761) QuantErr: 14.13761 batch_time=0.81842 
Train Epoch: 32 [33/125 8448/32000 (26%)] Loss: 1.61777 (QuantReg: 14.07640) QuantErr: 14.07640 batch_time=0.73909 
Train Epoch: 32 [49/125 12544/32000 (39%)] Loss: 1.66577 (QuantReg: 13.88458) QuantErr: 13.88458 batch_time=0.78007 
Train Epoch: 32 [65/125 16640/32000 (52%)] Loss: 1.69845 (QuantReg: 13.99116) QuantErr: 13.99116 batch_time=14.94086 
Train Epoch: 32 [81/125 20736/32000 (65%)] Loss: 1.93797 (QuantReg: 14.09501) QuantErr: 14.09501 batch_time=0.84140 
Train Epoch: 32 [97/125 24832/32000 (78%)] Loss: 1.79652 (QuantReg: 14.10522) QuantErr: 14.10522 batch_time=0.75488 
Train Epoch: 32 [113/125 28928/32000 (90%)] Loss: 1.70007 (QuantReg: 14.02570) QuantErr: 14.02570 batch_time=0.95194 
Train Epoch: 32 codebook_update_time=1.72685
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch32.pth ...
Done in 5.440s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch32.pth ...
Done in 10.399s
removing stale ckpt [epoch 31] [took 0.01s]
 epoch          : 32
 loss           : 1.8145114879608155
 quant_reg      : 14.000967056274414
 quant_err      : 14.000967056274414
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 4000
 MSRVTT_miech_test/t2v_metrics/R1: 22.2
 MSRVTT_miech_test/t2v_metrics/R5: 50.4
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.199
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.547718468734956
 MSRVTT_miech_test/v2t_metrics/R1: 22.2
 MSRVTT_miech_test/v2t_metrics/R5: 51.9
 MSRVTT_miech_test/v2t_metrics/R10: 66.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.909
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.45180270951104
 mnt_best       : 41.547718468734956
 not_improved_count: 0
Train Epoch: 33 [1/125 256/32000 (1%)] Loss: 1.67337 (QuantReg: 14.10749) QuantErr: 14.10749 batch_time=44.92581 
Train Epoch: 33 [17/125 4352/32000 (14%)] Loss: 1.67013 (QuantReg: 14.08774) QuantErr: 14.08774 batch_time=0.74682 
Train Epoch: 33 [33/125 8448/32000 (26%)] Loss: 1.76278 (QuantReg: 14.30005) QuantErr: 14.30005 batch_time=0.75662 
Train Epoch: 33 [49/125 12544/32000 (39%)] Loss: 2.12000 (QuantReg: 14.18747) QuantErr: 14.18747 batch_time=0.75274 
Train Epoch: 33 [65/125 16640/32000 (52%)] Loss: 1.72588 (QuantReg: 14.29734) QuantErr: 14.29734 batch_time=8.42751 
Train Epoch: 33 [81/125 20736/32000 (65%)] Loss: 2.26336 (QuantReg: 13.96238) QuantErr: 13.96238 batch_time=0.82970 
Train Epoch: 33 [97/125 24832/32000 (78%)] Loss: 1.62893 (QuantReg: 14.03862) QuantErr: 14.03862 batch_time=0.80271 
Train Epoch: 33 [113/125 28928/32000 (90%)] Loss: 1.83324 (QuantReg: 14.38180) QuantErr: 14.38180 batch_time=0.76418 
Train Epoch: 33 codebook_update_time=1.79935
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch33.pth ...
Done in 10.653s
removing stale ckpt [epoch 32] [took 0.01s]
 epoch          : 33
 loss           : 1.8289260101318359
 quant_reg      : 14.026308586120605
 quant_err      : 14.026308586120605
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 4125
 MSRVTT_miech_test/t2v_metrics/R1: 21.2
 MSRVTT_miech_test/t2v_metrics/R5: 50.4
 MSRVTT_miech_test/t2v_metrics/R10: 64.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.866
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.99919887389621
 MSRVTT_miech_test/v2t_metrics/R1: 21.8
 MSRVTT_miech_test/v2t_metrics/R5: 53.7
 MSRVTT_miech_test/v2t_metrics/R10: 65.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.22
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.527062256710316
 mnt_best       : 41.547718468734956
 not_improved_count: 1
Train Epoch: 34 [1/125 256/32000 (1%)] Loss: 2.01771 (QuantReg: 14.00572) QuantErr: 14.00572 batch_time=46.70127 
Train Epoch: 34 [17/125 4352/32000 (14%)] Loss: 1.78571 (QuantReg: 13.99635) QuantErr: 13.99635 batch_time=0.93333 
Train Epoch: 34 [33/125 8448/32000 (26%)] Loss: 2.08366 (QuantReg: 14.08798) QuantErr: 14.08798 batch_time=0.84579 
Train Epoch: 34 [49/125 12544/32000 (39%)] Loss: 1.72416 (QuantReg: 13.93060) QuantErr: 13.93060 batch_time=0.77988 
Train Epoch: 34 [65/125 16640/32000 (52%)] Loss: 1.68012 (QuantReg: 14.14662) QuantErr: 14.14662 batch_time=8.48706 
Train Epoch: 34 [81/125 20736/32000 (65%)] Loss: 1.74807 (QuantReg: 14.14490) QuantErr: 14.14490 batch_time=0.76443 
Train Epoch: 34 [97/125 24832/32000 (78%)] Loss: 1.54282 (QuantReg: 14.10833) QuantErr: 14.10833 batch_time=0.91258 
Train Epoch: 34 [113/125 28928/32000 (90%)] Loss: 1.87577 (QuantReg: 14.11054) QuantErr: 14.11054 batch_time=0.84620 
Train Epoch: 34 codebook_update_time=1.89028
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch34.pth ...
Done in 4.066s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 1.8036488819122314
 quant_reg      : 14.032193313598633
 quant_err      : 14.032193313598633
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 4250
 MSRVTT_miech_test/t2v_metrics/R1: 21.4
 MSRVTT_miech_test/t2v_metrics/R5: 49.9
 MSRVTT_miech_test/t2v_metrics/R10: 63.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.643
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.75690454723914
 MSRVTT_miech_test/v2t_metrics/R1: 22.4
 MSRVTT_miech_test/v2t_metrics/R5: 52.4
 MSRVTT_miech_test/v2t_metrics/R10: 65.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.671
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.52133277354929
 mnt_best       : 41.547718468734956
 not_improved_count: 2
Train Epoch: 35 [1/125 256/32000 (1%)] Loss: 1.80343 (QuantReg: 14.22721) QuantErr: 14.22721 batch_time=42.04135 
Train Epoch: 35 [17/125 4352/32000 (14%)] Loss: 1.88872 (QuantReg: 13.93770) QuantErr: 13.93770 batch_time=0.84288 
Train Epoch: 35 [33/125 8448/32000 (26%)] Loss: 2.09462 (QuantReg: 14.12513) QuantErr: 14.12513 batch_time=4.07084 
Train Epoch: 35 [49/125 12544/32000 (39%)] Loss: 1.50385 (QuantReg: 14.09460) QuantErr: 14.09460 batch_time=1.83132 
Train Epoch: 35 [65/125 16640/32000 (52%)] Loss: 1.59357 (QuantReg: 14.19873) QuantErr: 14.19873 batch_time=3.56570 
Train Epoch: 35 [81/125 20736/32000 (65%)] Loss: 2.14740 (QuantReg: 13.85802) QuantErr: 13.85802 batch_time=1.33073 
Train Epoch: 35 [97/125 24832/32000 (78%)] Loss: 1.66005 (QuantReg: 13.91368) QuantErr: 13.91368 batch_time=3.48489 
Train Epoch: 35 [113/125 28928/32000 (90%)] Loss: 1.77156 (QuantReg: 14.11942) QuantErr: 14.11942 batch_time=1.94859 
Train Epoch: 35 codebook_update_time=1.73580
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch35.pth ...
Done in 6.053s
removing stale ckpt [epoch 34] [took 0.01s]
 epoch          : 35
 loss           : 1.7877181272506715
 quant_reg      : 14.031017082214355
 quant_err      : 14.031017082214355
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 4375
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 50.2
 MSRVTT_miech_test/t2v_metrics/R10: 64.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.578
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.72976992771116
 MSRVTT_miech_test/v2t_metrics/R1: 21.6
 MSRVTT_miech_test/v2t_metrics/R5: 52.6
 MSRVTT_miech_test/v2t_metrics/R10: 65.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.547
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.06235635484697
 mnt_best       : 41.547718468734956
 not_improved_count: 3
Train Epoch: 36 [1/125 256/32000 (1%)] Loss: 2.02410 (QuantReg: 13.99404) QuantErr: 13.99404 batch_time=44.93811 
Train Epoch: 36 [17/125 4352/32000 (14%)] Loss: 1.74585 (QuantReg: 14.08855) QuantErr: 14.08855 batch_time=0.76242 
Train Epoch: 36 [33/125 8448/32000 (26%)] Loss: 1.76516 (QuantReg: 14.28482) QuantErr: 14.28482 batch_time=0.78465 
Train Epoch: 36 [49/125 12544/32000 (39%)] Loss: 1.93792 (QuantReg: 14.12937) QuantErr: 14.12937 batch_time=0.81880 
Train Epoch: 36 [65/125 16640/32000 (52%)] Loss: 1.95831 (QuantReg: 14.05800) QuantErr: 14.05800 batch_time=6.04493 
Train Epoch: 36 [81/125 20736/32000 (65%)] Loss: 1.85692 (QuantReg: 14.10129) QuantErr: 14.10129 batch_time=0.81807 
Train Epoch: 36 [97/125 24832/32000 (78%)] Loss: 1.89887 (QuantReg: 14.17582) QuantErr: 14.17582 batch_time=0.91087 
Train Epoch: 36 [113/125 28928/32000 (90%)] Loss: 1.98584 (QuantReg: 13.98475) QuantErr: 13.98475 batch_time=0.74482 
Train Epoch: 36 codebook_update_time=1.70867
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch36.pth ...
Done in 4.954s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 1.8134949970245362
 quant_reg      : 14.052913696289062
 quant_err      : 14.052913696289062
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 4500
 MSRVTT_miech_test/t2v_metrics/R1: 21.0
 MSRVTT_miech_test/t2v_metrics/R5: 49.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.444
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.77632108337474
 MSRVTT_miech_test/v2t_metrics/R1: 22.1
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.41
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.36819400326516
 mnt_best       : 41.547718468734956
 not_improved_count: 4
Train Epoch: 37 [1/125 256/32000 (1%)] Loss: 1.84011 (QuantReg: 14.05747) QuantErr: 14.05747 batch_time=43.57177 
Train Epoch: 37 [17/125 4352/32000 (14%)] Loss: 1.86534 (QuantReg: 13.99563) QuantErr: 13.99563 batch_time=0.75924 
Train Epoch: 37 [33/125 8448/32000 (26%)] Loss: 1.76609 (QuantReg: 14.03209) QuantErr: 14.03209 batch_time=0.75536 
Train Epoch: 37 [49/125 12544/32000 (39%)] Loss: 1.92610 (QuantReg: 13.94993) QuantErr: 13.94993 batch_time=0.76593 
Train Epoch: 37 [65/125 16640/32000 (52%)] Loss: 1.70831 (QuantReg: 14.07636) QuantErr: 14.07636 batch_time=4.11768 
Train Epoch: 37 [81/125 20736/32000 (65%)] Loss: 1.67904 (QuantReg: 14.06572) QuantErr: 14.06572 batch_time=0.90426 
Train Epoch: 37 [97/125 24832/32000 (78%)] Loss: 1.70795 (QuantReg: 14.03281) QuantErr: 14.03281 batch_time=0.77165 
Train Epoch: 37 [113/125 28928/32000 (90%)] Loss: 1.75154 (QuantReg: 14.29135) QuantErr: 14.29135 batch_time=0.74301 
Train Epoch: 37 codebook_update_time=1.65246
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch37.pth ...
Done in 4.061s
removing stale ckpt [epoch 36] [took 0.01s]
 epoch          : 37
 loss           : 1.817153956413269
 quant_reg      : 14.064955062866211
 quant_err      : 14.064955062866211
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 4625
 MSRVTT_miech_test/t2v_metrics/R1: 21.7
 MSRVTT_miech_test/t2v_metrics/R5: 50.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.53
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.25604823465929
 MSRVTT_miech_test/v2t_metrics/R1: 22.6
 MSRVTT_miech_test/v2t_metrics/R5: 52.0
 MSRVTT_miech_test/v2t_metrics/R10: 65.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.208
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.495373890931695
 mnt_best       : 41.547718468734956
 not_improved_count: 5
Train Epoch: 38 [1/125 256/32000 (1%)] Loss: 1.91430 (QuantReg: 13.99880) QuantErr: 13.99880 batch_time=53.43126 
Train Epoch: 38 [17/125 4352/32000 (14%)] Loss: 1.93386 (QuantReg: 14.12007) QuantErr: 14.12007 batch_time=0.76115 
Train Epoch: 38 [33/125 8448/32000 (26%)] Loss: 1.70719 (QuantReg: 13.97937) QuantErr: 13.97937 batch_time=0.99506 
Train Epoch: 38 [49/125 12544/32000 (39%)] Loss: 1.86181 (QuantReg: 13.98891) QuantErr: 13.98891 batch_time=0.74591 
Train Epoch: 38 [65/125 16640/32000 (52%)] Loss: 1.75585 (QuantReg: 13.99774) QuantErr: 13.99774 batch_time=11.76978 
Train Epoch: 38 [81/125 20736/32000 (65%)] Loss: 1.76255 (QuantReg: 14.22345) QuantErr: 14.22345 batch_time=0.76009 
Train Epoch: 38 [97/125 24832/32000 (78%)] Loss: 1.86374 (QuantReg: 13.92534) QuantErr: 13.92534 batch_time=0.76286 
Train Epoch: 38 [113/125 28928/32000 (90%)] Loss: 1.85670 (QuantReg: 14.09809) QuantErr: 14.09809 batch_time=0.87139 
Train Epoch: 38 codebook_update_time=1.65673
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch38.pth ...
Done in 4.423s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 38
 loss           : 1.813748028755188
 quant_reg      : 14.080217590332031
 quant_err      : 14.080217590332031
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 4750
 MSRVTT_miech_test/t2v_metrics/R1: 22.2
 MSRVTT_miech_test/t2v_metrics/R5: 49.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.536
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.24483681932659
 MSRVTT_miech_test/v2t_metrics/R1: 21.4
 MSRVTT_miech_test/v2t_metrics/R5: 51.9
 MSRVTT_miech_test/v2t_metrics/R10: 65.6
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.341
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.76652310719433
 mnt_best       : 41.547718468734956
 not_improved_count: 6
Train Epoch: 39 [1/125 256/32000 (1%)] Loss: 1.77061 (QuantReg: 14.04232) QuantErr: 14.04232 batch_time=44.24404 
Train Epoch: 39 [17/125 4352/32000 (14%)] Loss: 1.83540 (QuantReg: 13.89036) QuantErr: 13.89036 batch_time=0.74831 
Train Epoch: 39 [33/125 8448/32000 (26%)] Loss: 2.08357 (QuantReg: 13.94813) QuantErr: 13.94813 batch_time=0.88130 
Train Epoch: 39 [49/125 12544/32000 (39%)] Loss: 1.89511 (QuantReg: 14.14232) QuantErr: 14.14232 batch_time=0.75832 
Train Epoch: 39 [65/125 16640/32000 (52%)] Loss: 1.94775 (QuantReg: 14.25389) QuantErr: 14.25389 batch_time=5.50757 
Train Epoch: 39 [81/125 20736/32000 (65%)] Loss: 1.67954 (QuantReg: 13.90273) QuantErr: 13.90273 batch_time=0.75700 
Train Epoch: 39 [97/125 24832/32000 (78%)] Loss: 1.84361 (QuantReg: 14.08203) QuantErr: 14.08203 batch_time=0.74279 
Train Epoch: 39 [113/125 28928/32000 (90%)] Loss: 1.82733 (QuantReg: 14.11047) QuantErr: 14.11047 batch_time=0.76349 
Train Epoch: 39 codebook_update_time=1.69275
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch39.pth ...
Done in 3.639s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 1.7666018705368043
 quant_reg      : 14.107086448669433
 quant_err      : 14.107086448669433
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 4875
 MSRVTT_miech_test/t2v_metrics/R1: 21.2
 MSRVTT_miech_test/t2v_metrics/R5: 49.8
 MSRVTT_miech_test/t2v_metrics/R10: 64.9
 MSRVTT_miech_test/t2v_metrics/R50: 86.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.480000000000004
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.9200950186465
 MSRVTT_miech_test/v2t_metrics/R1: 20.8
 MSRVTT_miech_test/v2t_metrics/R5: 52.7
 MSRVTT_miech_test/v2t_metrics/R10: 66.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.671
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.689351217404315
 mnt_best       : 41.547718468734956
 not_improved_count: 7
Train Epoch: 40 [1/125 256/32000 (1%)] Loss: 1.55858 (QuantReg: 14.21659) QuantErr: 14.21659 batch_time=48.78217 
Train Epoch: 40 [17/125 4352/32000 (14%)] Loss: 1.82788 (QuantReg: 14.09247) QuantErr: 14.09247 batch_time=0.80478 
Train Epoch: 40 [33/125 8448/32000 (26%)] Loss: 1.65436 (QuantReg: 14.06258) QuantErr: 14.06258 batch_time=0.76669 
Train Epoch: 40 [49/125 12544/32000 (39%)] Loss: 1.82287 (QuantReg: 13.96016) QuantErr: 13.96016 batch_time=0.87809 
Train Epoch: 40 [65/125 16640/32000 (52%)] Loss: 1.61160 (QuantReg: 14.20538) QuantErr: 14.20538 batch_time=10.34058 
Train Epoch: 40 [81/125 20736/32000 (65%)] Loss: 1.72211 (QuantReg: 14.14176) QuantErr: 14.14176 batch_time=0.79001 
Train Epoch: 40 [97/125 24832/32000 (78%)] Loss: 1.84427 (QuantReg: 14.19331) QuantErr: 14.19331 batch_time=0.75911 
Train Epoch: 40 [113/125 28928/32000 (90%)] Loss: 1.58961 (QuantReg: 14.16562) QuantErr: 14.16562 batch_time=0.73633 
Train Epoch: 40 codebook_update_time=1.58813
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch40.pth ...
Done in 4.824s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 1.7812495374679564
 quant_reg      : 14.097806282043457
 quant_err      : 14.097806282043457
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 5000
 MSRVTT_miech_test/t2v_metrics/R1: 21.6
 MSRVTT_miech_test/t2v_metrics/R5: 50.6
 MSRVTT_miech_test/t2v_metrics/R10: 64.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.708
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.395168518301766
 MSRVTT_miech_test/v2t_metrics/R1: 22.2
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.8615
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.53920773993118
 mnt_best       : 41.547718468734956
 not_improved_count: 8
Train Epoch: 41 [1/125 256/32000 (1%)] Loss: 1.81103 (QuantReg: 14.13707) QuantErr: 14.13707 batch_time=42.79171 
Train Epoch: 41 [17/125 4352/32000 (14%)] Loss: 1.81208 (QuantReg: 14.27287) QuantErr: 14.27287 batch_time=0.73655 
Train Epoch: 41 [33/125 8448/32000 (26%)] Loss: 1.77363 (QuantReg: 14.27580) QuantErr: 14.27580 batch_time=0.75790 
Train Epoch: 41 [49/125 12544/32000 (39%)] Loss: 1.82675 (QuantReg: 14.12323) QuantErr: 14.12323 batch_time=0.75857 
Train Epoch: 41 [65/125 16640/32000 (52%)] Loss: 1.91356 (QuantReg: 14.08162) QuantErr: 14.08162 batch_time=2.03946 
Train Epoch: 41 [81/125 20736/32000 (65%)] Loss: 2.06890 (QuantReg: 13.94685) QuantErr: 13.94685 batch_time=0.83111 
Train Epoch: 41 [97/125 24832/32000 (78%)] Loss: 1.72003 (QuantReg: 14.19769) QuantErr: 14.19769 batch_time=0.76129 
Train Epoch: 41 [113/125 28928/32000 (90%)] Loss: 1.79730 (QuantReg: 14.12212) QuantErr: 14.12212 batch_time=0.73795 
Train Epoch: 41 codebook_update_time=1.61303
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch41.pth ...
Done in 10.914s
removing stale ckpt [epoch 40] [took 0.85s]
 epoch          : 41
 loss           : 1.7882448825836181
 quant_reg      : 14.14476368713379
 quant_err      : 14.14476368713379
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 5125
 MSRVTT_miech_test/t2v_metrics/R1: 21.1
 MSRVTT_miech_test/t2v_metrics/R5: 50.4
 MSRVTT_miech_test/t2v_metrics/R10: 65.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.84
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.08218454611296
 MSRVTT_miech_test/v2t_metrics/R1: 21.6
 MSRVTT_miech_test/v2t_metrics/R5: 53.0
 MSRVTT_miech_test/v2t_metrics/R10: 64.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.794
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.03955457350988
 mnt_best       : 41.547718468734956
 not_improved_count: 9
Train Epoch: 42 [1/125 256/32000 (1%)] Loss: 1.89044 (QuantReg: 14.05572) QuantErr: 14.05572 batch_time=47.11798 
Train Epoch: 42 [17/125 4352/32000 (14%)] Loss: 2.02073 (QuantReg: 14.24322) QuantErr: 14.24322 batch_time=0.77315 
Train Epoch: 42 [33/125 8448/32000 (26%)] Loss: 1.61501 (QuantReg: 14.12226) QuantErr: 14.12226 batch_time=0.90195 
Train Epoch: 42 [49/125 12544/32000 (39%)] Loss: 1.82727 (QuantReg: 14.13380) QuantErr: 14.13380 batch_time=0.74611 
Train Epoch: 42 [65/125 16640/32000 (52%)] Loss: 1.79623 (QuantReg: 14.15150) QuantErr: 14.15150 batch_time=4.52977 
Train Epoch: 42 [81/125 20736/32000 (65%)] Loss: 1.70105 (QuantReg: 14.10415) QuantErr: 14.10415 batch_time=0.94402 
Train Epoch: 42 [97/125 24832/32000 (78%)] Loss: 1.61782 (QuantReg: 14.26698) QuantErr: 14.26698 batch_time=0.77391 
Train Epoch: 42 [113/125 28928/32000 (90%)] Loss: 1.87084 (QuantReg: 14.15597) QuantErr: 14.15597 batch_time=0.80553 
Train Epoch: 42 codebook_update_time=1.96996
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch42.pth ...
Done in 4.177s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.776454339981079
 quant_reg      : 14.158787719726563
 quant_err      : 14.158787719726563
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 5250
 MSRVTT_miech_test/t2v_metrics/R1: 21.1
 MSRVTT_miech_test/t2v_metrics/R5: 50.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.259
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.027060660286715
 MSRVTT_miech_test/v2t_metrics/R1: 22.3
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 65.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.535
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.446991258741
 mnt_best       : 41.547718468734956
 not_improved_count: 10
Train Epoch: 43 [1/125 256/32000 (1%)] Loss: 1.70540 (QuantReg: 14.09399) QuantErr: 14.09399 batch_time=43.74016 
Train Epoch: 43 [17/125 4352/32000 (14%)] Loss: 1.80046 (QuantReg: 14.18858) QuantErr: 14.18858 batch_time=0.98203 
Train Epoch: 43 [33/125 8448/32000 (26%)] Loss: 1.81028 (QuantReg: 14.09016) QuantErr: 14.09016 batch_time=0.74989 
Train Epoch: 43 [49/125 12544/32000 (39%)] Loss: 1.58118 (QuantReg: 14.32612) QuantErr: 14.32612 batch_time=0.82411 
Train Epoch: 43 [65/125 16640/32000 (52%)] Loss: 1.64422 (QuantReg: 14.14536) QuantErr: 14.14536 batch_time=2.67057 
Train Epoch: 43 [81/125 20736/32000 (65%)] Loss: 1.81834 (QuantReg: 14.20396) QuantErr: 14.20396 batch_time=0.76511 
Train Epoch: 43 [97/125 24832/32000 (78%)] Loss: 1.99996 (QuantReg: 14.10648) QuantErr: 14.10648 batch_time=0.77982 
Train Epoch: 43 [113/125 28928/32000 (90%)] Loss: 1.94836 (QuantReg: 14.15197) QuantErr: 14.15197 batch_time=0.77233 
Train Epoch: 43 codebook_update_time=1.71016
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch43.pth ...
Done in 19.369s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 1.7874088172912597
 quant_reg      : 14.1576358795166
 quant_err      : 14.1576358795166
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 5375
 MSRVTT_miech_test/t2v_metrics/R1: 21.8
 MSRVTT_miech_test/t2v_metrics/R5: 50.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.362
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.45431737087357
 MSRVTT_miech_test/v2t_metrics/R1: 22.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.201
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.25960445959709
 mnt_best       : 41.547718468734956
 not_improved_count: 11
Train Epoch: 44 [1/125 256/32000 (1%)] Loss: 1.78797 (QuantReg: 14.40129) QuantErr: 14.40129 batch_time=38.27841 
Train Epoch: 44 [17/125 4352/32000 (14%)] Loss: 1.99071 (QuantReg: 13.87977) QuantErr: 13.87977 batch_time=0.82918 
Train Epoch: 44 [33/125 8448/32000 (26%)] Loss: 1.49023 (QuantReg: 14.31283) QuantErr: 14.31283 batch_time=0.88904 
Train Epoch: 44 [49/125 12544/32000 (39%)] Loss: 1.93570 (QuantReg: 14.02650) QuantErr: 14.02650 batch_time=0.74845 
Train Epoch: 44 [65/125 16640/32000 (52%)] Loss: 1.74257 (QuantReg: 14.27180) QuantErr: 14.27180 batch_time=1.17744 
Train Epoch: 44 [81/125 20736/32000 (65%)] Loss: 1.77076 (QuantReg: 14.33412) QuantErr: 14.33412 batch_time=0.94655 
Train Epoch: 44 [97/125 24832/32000 (78%)] Loss: 1.83177 (QuantReg: 14.02179) QuantErr: 14.02179 batch_time=0.89054 
Train Epoch: 44 [113/125 28928/32000 (90%)] Loss: 1.90497 (QuantReg: 14.06160) QuantErr: 14.06160 batch_time=0.77221 
Train Epoch: 44 codebook_update_time=1.67112
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch44.pth ...
Done in 4.489s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.778657702445984
 quant_reg      : 14.168458641052245
 quant_err      : 14.168458641052245
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 5500
 MSRVTT_miech_test/t2v_metrics/R1: 21.0
 MSRVTT_miech_test/t2v_metrics/R5: 50.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.4
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.672
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.87572920918503
 MSRVTT_miech_test/v2t_metrics/R1: 21.6
 MSRVTT_miech_test/v2t_metrics/R5: 52.7
 MSRVTT_miech_test/v2t_metrics/R10: 66.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.362
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.28089273349677
 mnt_best       : 41.547718468734956
 not_improved_count: 12
Train Epoch: 45 [1/125 256/32000 (1%)] Loss: 1.80019 (QuantReg: 14.19225) QuantErr: 14.19225 batch_time=53.53954 
Train Epoch: 45 [17/125 4352/32000 (14%)] Loss: 2.04725 (QuantReg: 14.02331) QuantErr: 14.02331 batch_time=0.77270 
Train Epoch: 45 [33/125 8448/32000 (26%)] Loss: 1.77289 (QuantReg: 14.19755) QuantErr: 14.19755 batch_time=0.81587 
Train Epoch: 45 [49/125 12544/32000 (39%)] Loss: 1.50123 (QuantReg: 14.33253) QuantErr: 14.33253 batch_time=0.87816 
Train Epoch: 45 [65/125 16640/32000 (52%)] Loss: 1.91412 (QuantReg: 14.18936) QuantErr: 14.18936 batch_time=8.99404 
Train Epoch: 45 [81/125 20736/32000 (65%)] Loss: 1.91778 (QuantReg: 13.99675) QuantErr: 13.99675 batch_time=0.75541 
Train Epoch: 45 [97/125 24832/32000 (78%)] Loss: 1.82165 (QuantReg: 14.30081) QuantErr: 14.30081 batch_time=0.77058 
Train Epoch: 45 [113/125 28928/32000 (90%)] Loss: 1.61223 (QuantReg: 14.35099) QuantErr: 14.35099 batch_time=2.02395 
Train Epoch: 45 codebook_update_time=1.60941
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch45.pth ...
Done in 4.169s
removing stale ckpt [epoch 44] [took 0.13s]
 epoch          : 45
 loss           : 1.76151238155365
 quant_reg      : 14.182793136596679
 quant_err      : 14.182793136596679
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 5625
 MSRVTT_miech_test/t2v_metrics/R1: 21.6
 MSRVTT_miech_test/t2v_metrics/R5: 50.4
 MSRVTT_miech_test/t2v_metrics/R10: 64.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.927
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.25545051943983
 MSRVTT_miech_test/v2t_metrics/R1: 21.6
 MSRVTT_miech_test/v2t_metrics/R5: 53.4
 MSRVTT_miech_test/v2t_metrics/R10: 66.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.642
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.38182441580032
 mnt_best       : 41.547718468734956
 not_improved_count: 13
Train Epoch: 46 [1/125 256/32000 (1%)] Loss: 1.88540 (QuantReg: 13.92244) QuantErr: 13.92244 batch_time=40.92787 
Train Epoch: 46 [17/125 4352/32000 (14%)] Loss: 1.65490 (QuantReg: 14.27592) QuantErr: 14.27592 batch_time=0.78916 
Train Epoch: 46 [33/125 8448/32000 (26%)] Loss: 1.70095 (QuantReg: 14.20803) QuantErr: 14.20803 batch_time=0.80754 
Train Epoch: 46 [49/125 12544/32000 (39%)] Loss: 1.78407 (QuantReg: 14.27615) QuantErr: 14.27615 batch_time=0.75558 
Train Epoch: 46 [65/125 16640/32000 (52%)] Loss: 2.13916 (QuantReg: 13.96941) QuantErr: 13.96941 batch_time=0.94283 
Train Epoch: 46 [81/125 20736/32000 (65%)] Loss: 2.04646 (QuantReg: 14.11255) QuantErr: 14.11255 batch_time=0.78367 
Train Epoch: 46 [97/125 24832/32000 (78%)] Loss: 1.52488 (QuantReg: 14.25543) QuantErr: 14.25543 batch_time=0.92061 
Train Epoch: 46 [113/125 28928/32000 (90%)] Loss: 1.61122 (QuantReg: 14.23647) QuantErr: 14.23647 batch_time=0.81384 
Train Epoch: 46 codebook_update_time=1.72562
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch46.pth ...
Done in 12.684s
removing stale ckpt [epoch 45] [took 0.05s]
 epoch          : 46
 loss           : 1.7830179357528686
 quant_reg      : 14.191882675170898
 quant_err      : 14.191882675170898
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 5750
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 51.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.4
 MSRVTT_miech_test/t2v_metrics/R50: 86.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.951
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.9717346329709
 MSRVTT_miech_test/v2t_metrics/R1: 21.6
 MSRVTT_miech_test/v2t_metrics/R5: 51.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.665
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.92414881096747
 mnt_best       : 41.547718468734956
 not_improved_count: 14
Train Epoch: 47 [1/125 256/32000 (1%)] Loss: 1.63969 (QuantReg: 14.04376) QuantErr: 14.04376 batch_time=45.02274 
Train Epoch: 47 [17/125 4352/32000 (14%)] Loss: 1.64647 (QuantReg: 14.31583) QuantErr: 14.31583 batch_time=0.77929 
Train Epoch: 47 [33/125 8448/32000 (26%)] Loss: 1.90953 (QuantReg: 14.18356) QuantErr: 14.18356 batch_time=0.77295 
Train Epoch: 47 [49/125 12544/32000 (39%)] Loss: 1.74313 (QuantReg: 14.21768) QuantErr: 14.21768 batch_time=0.75637 
Train Epoch: 47 [65/125 16640/32000 (52%)] Loss: 1.70087 (QuantReg: 14.19859) QuantErr: 14.19859 batch_time=2.90561 
Train Epoch: 47 [81/125 20736/32000 (65%)] Loss: 1.66025 (QuantReg: 14.18770) QuantErr: 14.18770 batch_time=0.79001 
Train Epoch: 47 [97/125 24832/32000 (78%)] Loss: 1.77915 (QuantReg: 14.24211) QuantErr: 14.24211 batch_time=0.76498 
Train Epoch: 47 [113/125 28928/32000 (90%)] Loss: 1.75668 (QuantReg: 14.23940) QuantErr: 14.23940 batch_time=0.87068 
Train Epoch: 47 codebook_update_time=1.66794
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch47.pth ...
Done in 6.225s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 47
 loss           : 1.7762736406326294
 quant_reg      : 14.223442153930664
 quant_err      : 14.223442153930664
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 5875
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 51.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.724
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.9717346329709
 MSRVTT_miech_test/v2t_metrics/R1: 22.0
 MSRVTT_miech_test/v2t_metrics/R5: 52.7
 MSRVTT_miech_test/v2t_metrics/R10: 66.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.6535
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.49753711217963
 mnt_best       : 41.547718468734956
 not_improved_count: 15
Train Epoch: 48 [1/125 256/32000 (1%)] Loss: 1.76966 (QuantReg: 14.18659) QuantErr: 14.18659 batch_time=47.38577 
Train Epoch: 48 [17/125 4352/32000 (14%)] Loss: 1.65912 (QuantReg: 14.39566) QuantErr: 14.39566 batch_time=0.75695 
Train Epoch: 48 [33/125 8448/32000 (26%)] Loss: 1.82339 (QuantReg: 14.34920) QuantErr: 14.34920 batch_time=0.86005 
Train Epoch: 48 [49/125 12544/32000 (39%)] Loss: 1.98658 (QuantReg: 14.25107) QuantErr: 14.25107 batch_time=0.76747 
Train Epoch: 48 [65/125 16640/32000 (52%)] Loss: 1.95396 (QuantReg: 14.25132) QuantErr: 14.25132 batch_time=6.16796 
Train Epoch: 48 [81/125 20736/32000 (65%)] Loss: 1.93039 (QuantReg: 14.01987) QuantErr: 14.01987 batch_time=0.86754 
Train Epoch: 48 [97/125 24832/32000 (78%)] Loss: 1.91640 (QuantReg: 14.14929) QuantErr: 14.14929 batch_time=0.90941 
Train Epoch: 48 [113/125 28928/32000 (90%)] Loss: 1.85159 (QuantReg: 14.16534) QuantErr: 14.16534 batch_time=0.74742 
Train Epoch: 48 codebook_update_time=1.62471
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch48.pth ...
Done in 4.400s
removing stale ckpt [epoch 47] [took 0.02s]
 epoch          : 48
 loss           : 1.7812469406127929
 quant_reg      : 14.242154350280762
 quant_err      : 14.242154350280762
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 6000
 MSRVTT_miech_test/t2v_metrics/R1: 21.4
 MSRVTT_miech_test/t2v_metrics/R5: 51.8
 MSRVTT_miech_test/t2v_metrics/R10: 64.5
 MSRVTT_miech_test/t2v_metrics/R50: 86.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.583
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.5050634940375
 MSRVTT_miech_test/v2t_metrics/R1: 22.3
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.8245
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.68257474292083
 mnt_best       : 41.547718468734956
 not_improved_count: 16
Train Epoch: 49 [1/125 256/32000 (1%)] Loss: 1.97747 (QuantReg: 14.38099) QuantErr: 14.38099 batch_time=49.82764 
Train Epoch: 49 [17/125 4352/32000 (14%)] Loss: 1.58663 (QuantReg: 14.24802) QuantErr: 14.24802 batch_time=0.76139 
Train Epoch: 49 [33/125 8448/32000 (26%)] Loss: 1.72997 (QuantReg: 14.19647) QuantErr: 14.19647 batch_time=3.36142 
Train Epoch: 49 [49/125 12544/32000 (39%)] Loss: 1.92607 (QuantReg: 14.15347) QuantErr: 14.15347 batch_time=0.75716 
Train Epoch: 49 [65/125 16640/32000 (52%)] Loss: 1.78560 (QuantReg: 14.34663) QuantErr: 14.34663 batch_time=5.11218 
Train Epoch: 49 [81/125 20736/32000 (65%)] Loss: 1.95306 (QuantReg: 14.28885) QuantErr: 14.28885 batch_time=0.74471 
Train Epoch: 49 [97/125 24832/32000 (78%)] Loss: 1.88057 (QuantReg: 14.23974) QuantErr: 14.23974 batch_time=3.31109 
Train Epoch: 49 [113/125 28928/32000 (90%)] Loss: 1.73510 (QuantReg: 14.02828) QuantErr: 14.02828 batch_time=0.88567 
Train Epoch: 49 codebook_update_time=1.64270
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch49.pth ...
Done in 5.204s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 1.7744393882751466
 quant_reg      : 14.232034568786622
 quant_err      : 14.232034568786622
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 6125
 MSRVTT_miech_test/t2v_metrics/R1: 21.4
 MSRVTT_miech_test/t2v_metrics/R5: 50.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 86.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.343
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.06965553818694
 MSRVTT_miech_test/v2t_metrics/R1: 22.1
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 87.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.551
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.42213192783828
 mnt_best       : 41.547718468734956
 not_improved_count: 17
Train Epoch: 50 [1/125 256/32000 (1%)] Loss: 1.70790 (QuantReg: 14.09267) QuantErr: 14.09267 batch_time=46.04190 
Train Epoch: 50 [17/125 4352/32000 (14%)] Loss: 1.60049 (QuantReg: 14.16596) QuantErr: 14.16596 batch_time=0.75191 
Train Epoch: 50 [33/125 8448/32000 (26%)] Loss: 1.60439 (QuantReg: 14.43861) QuantErr: 14.43861 batch_time=0.89026 
Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256
Preparing the dataloaders ...
Loading dataset MSRVTT_miech_trainval in ram ...
Finish loading dataset MSRVTT_miech_trainval in ram, taking 599.3731639385223 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 106.8291368484497 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 66.01493978500366 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch0.pth ...
Done in 2.772s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch0.pth ...
Done in 4.730s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_miech_test/t2v_metrics/R1: 0.1
 MSRVTT_miech_test/t2v_metrics/R5: 0.6
 MSRVTT_miech_test/t2v_metrics/R10: 1.0
 MSRVTT_miech_test/t2v_metrics/R50: 5.0
 MSRVTT_miech_test/t2v_metrics/MedR: 503.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 505.179
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.3914867641168864
 MSRVTT_miech_test/v2t_metrics/R1: 0.1
 MSRVTT_miech_test/v2t_metrics/R5: 0.4
 MSRVTT_miech_test/v2t_metrics/R10: 1.0
 MSRVTT_miech_test/v2t_metrics/R50: 5.4
 MSRVTT_miech_test/v2t_metrics/MedR: 511.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 499.895
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3419951893353394
 mnt_best       : 0.3914867641168864
 not_improved_count: 0
Train Epoch: 1 [1/125 256/32000 (1%)] Loss: 11.21741 (QuantReg: 22.46410) QuantErr: 22.46410 batch_time=43.20221 
Train Epoch: 1 [17/125 4352/32000 (14%)] Loss: 8.96628 (QuantReg: 22.52086) QuantErr: 22.52086 batch_time=0.85995 
Train Epoch: 1 [33/125 8448/32000 (26%)] Loss: 7.98096 (QuantReg: 22.57301) QuantErr: 22.57301 batch_time=0.87679 
Train Epoch: 1 [49/125 12544/32000 (39%)] Loss: 7.12379 (QuantReg: 22.59755) QuantErr: 22.59755 batch_time=0.76884 
Train Epoch: 1 [65/125 16640/32000 (52%)] Loss: 6.70287 (QuantReg: 22.60032) QuantErr: 22.60032 batch_time=5.05998 
Train Epoch: 1 [81/125 20736/32000 (65%)] Loss: 6.37580 (QuantReg: 22.64108) QuantErr: 22.64108 batch_time=1.03534 
Train Epoch: 1 [97/125 24832/32000 (78%)] Loss: 5.92142 (QuantReg: 22.66753) QuantErr: 22.66753 batch_time=0.78901 
Train Epoch: 1 [113/125 28928/32000 (90%)] Loss: 5.61722 (QuantReg: 22.62523) QuantErr: 22.62523 batch_time=0.74060 
Train Epoch: 1 codebook_update_time=1.83235
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch1.pth ...
Done in 10.915s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch1.pth ...
Done in 15.374s
 epoch          : 1
 loss           : 7.197768699645996
 quant_reg      : 22.60306330871582
 quant_err      : 22.60306330871582
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 125
 MSRVTT_miech_test/t2v_metrics/R1: 10.8
 MSRVTT_miech_test/t2v_metrics/R5: 29.5
 MSRVTT_miech_test/t2v_metrics/R10: 43.2
 MSRVTT_miech_test/t2v_metrics/R50: 77.2
 MSRVTT_miech_test/t2v_metrics/MedR: 14.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 46.986
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.96494883391072
 MSRVTT_miech_test/v2t_metrics/R1: 10.0
 MSRVTT_miech_test/v2t_metrics/R5: 28.0
 MSRVTT_miech_test/v2t_metrics/R10: 43.0
 MSRVTT_miech_test/v2t_metrics/R50: 76.7
 MSRVTT_miech_test/v2t_metrics/MedR: 14.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 46.9475
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.91969473302212
 mnt_best       : 23.96494883391072
 not_improved_count: 0
Train Epoch: 2 [1/125 256/32000 (1%)] Loss: 5.52720 (QuantReg: 11.53671) QuantErr: 11.53671 batch_time=34.31258 
Train Epoch: 2 [17/125 4352/32000 (14%)] Loss: 5.40985 (QuantReg: 12.43529) QuantErr: 12.43529 batch_time=0.75550 
Train Epoch: 2 [33/125 8448/32000 (26%)] Loss: 5.43299 (QuantReg: 12.58150) QuantErr: 12.58150 batch_time=0.75320 
Train Epoch: 2 [49/125 12544/32000 (39%)] Loss: 5.41559 (QuantReg: 13.07150) QuantErr: 13.07150 batch_time=0.80710 
Train Epoch: 2 [65/125 16640/32000 (52%)] Loss: 5.03353 (QuantReg: 13.85657) QuantErr: 13.85657 batch_time=2.70371 
Train Epoch: 2 [81/125 20736/32000 (65%)] Loss: 5.45287 (QuantReg: 14.20920) QuantErr: 14.20920 batch_time=0.75772 
Train Epoch: 2 [97/125 24832/32000 (78%)] Loss: 4.22629 (QuantReg: 14.67138) QuantErr: 14.67138 batch_time=0.80399 
Train Epoch: 2 [113/125 28928/32000 (90%)] Loss: 4.57005 (QuantReg: 14.98380) QuantErr: 14.98380 batch_time=0.76099 
Train Epoch: 2 codebook_update_time=1.66703
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch2.pth ...
Done in 4.234s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch2.pth ...
Done in 8.690s
removing stale ckpt [epoch 2] [took 0.01s]
removing stale ckpt [epoch 1] [took 0.03s]
removing stale ckpt [epoch 0] [took 0.02s]
 epoch          : 2
 loss           : 5.095565055847168
 quant_reg      : 13.678807502746581
 quant_err      : 13.678807502746581
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 250
 MSRVTT_miech_test/t2v_metrics/R1: 12.6
 MSRVTT_miech_test/t2v_metrics/R5: 35.3
 MSRVTT_miech_test/t2v_metrics/R10: 50.0
 MSRVTT_miech_test/t2v_metrics/R50: 82.5
 MSRVTT_miech_test/t2v_metrics/MedR: 10.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 41.165
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.1214958597278
 MSRVTT_miech_test/v2t_metrics/R1: 11.8
 MSRVTT_miech_test/v2t_metrics/R5: 36.7
 MSRVTT_miech_test/v2t_metrics/R10: 50.9
 MSRVTT_miech_test/v2t_metrics/R50: 82.4
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 40.933
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.038532832201543
 mnt_best       : 28.1214958597278
 not_improved_count: 0
Train Epoch: 3 [1/125 256/32000 (1%)] Loss: 4.72433 (QuantReg: 12.37420) QuantErr: 12.37420 batch_time=37.54085 
Train Epoch: 3 [17/125 4352/32000 (14%)] Loss: 4.79170 (QuantReg: 12.12721) QuantErr: 12.12721 batch_time=0.99859 
Train Epoch: 3 [33/125 8448/32000 (26%)] Loss: 4.88965 (QuantReg: 12.56346) QuantErr: 12.56346 batch_time=0.74322 
Train Epoch: 3 [49/125 12544/32000 (39%)] Loss: 4.95888 (QuantReg: 12.91522) QuantErr: 12.91522 batch_time=0.94484 
Train Epoch: 3 [65/125 16640/32000 (52%)] Loss: 4.42330 (QuantReg: 13.00818) QuantErr: 13.00818 batch_time=3.76618 
Train Epoch: 3 [81/125 20736/32000 (65%)] Loss: 4.34102 (QuantReg: 13.11948) QuantErr: 13.11948 batch_time=0.88522 
Train Epoch: 3 [97/125 24832/32000 (78%)] Loss: 4.20124 (QuantReg: 13.20174) QuantErr: 13.20174 batch_time=0.77319 
Train Epoch: 3 [113/125 28928/32000 (90%)] Loss: 4.16202 (QuantReg: 13.39905) QuantErr: 13.39905 batch_time=0.72658 
Train Epoch: 3 codebook_update_time=1.80175
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch3.pth ...
Done in 4.132s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch3.pth ...
Done in 8.298s
removing stale ckpt [epoch 3] [took 0.10s]
 epoch          : 3
 loss           : 4.3891751670837404
 quant_reg      : 12.852207412719727
 quant_err      : 12.852207412719727
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 375
 MSRVTT_miech_test/t2v_metrics/R1: 13.3
 MSRVTT_miech_test/t2v_metrics/R5: 39.2
 MSRVTT_miech_test/t2v_metrics/R10: 53.6
 MSRVTT_miech_test/t2v_metrics/R50: 85.3
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.924
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.345956613259656
 MSRVTT_miech_test/v2t_metrics/R1: 15.3
 MSRVTT_miech_test/v2t_metrics/R5: 41.6
 MSRVTT_miech_test/v2t_metrics/R10: 55.2
 MSRVTT_miech_test/v2t_metrics/R50: 85.3
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 35.417
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.75226051253862
 mnt_best       : 30.345956613259656
 not_improved_count: 0
Train Epoch: 4 [1/125 256/32000 (1%)] Loss: 3.98937 (QuantReg: 12.12928) QuantErr: 12.12928 batch_time=36.61310 
Train Epoch: 4 [17/125 4352/32000 (14%)] Loss: 4.23874 (QuantReg: 12.51233) QuantErr: 12.51233 batch_time=0.73300 
Train Epoch: 4 [33/125 8448/32000 (26%)] Loss: 3.83787 (QuantReg: 12.55113) QuantErr: 12.55113 batch_time=0.74844 
Train Epoch: 4 [49/125 12544/32000 (39%)] Loss: 3.73812 (QuantReg: 12.55952) QuantErr: 12.55952 batch_time=0.85451 
Train Epoch: 4 [65/125 16640/32000 (52%)] Loss: 3.54737 (QuantReg: 12.75879) QuantErr: 12.75879 batch_time=2.35124 
Train Epoch: 4 [81/125 20736/32000 (65%)] Loss: 3.82538 (QuantReg: 12.69350) QuantErr: 12.69350 batch_time=0.73202 
Train Epoch: 4 [97/125 24832/32000 (78%)] Loss: 3.74024 (QuantReg: 12.90066) QuantErr: 12.90066 batch_time=0.75035 
Train Epoch: 4 [113/125 28928/32000 (90%)] Loss: 3.94810 (QuantReg: 13.13690) QuantErr: 13.13690 batch_time=0.73623 
Train Epoch: 4 codebook_update_time=1.67630
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch4.pth ...
Done in 3.981s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch4.pth ...
Done in 8.256s
removing stale ckpt [epoch 4] [took 0.26s]
 epoch          : 4
 loss           : 3.9070032024383545
 quant_reg      : 12.782577461242676
 quant_err      : 12.782577461242676
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 500
 MSRVTT_miech_test/t2v_metrics/R1: 15.8
 MSRVTT_miech_test/t2v_metrics/R5: 42.2
 MSRVTT_miech_test/t2v_metrics/R10: 55.9
 MSRVTT_miech_test/t2v_metrics/R50: 85.4
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.849
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.403639031233475
 MSRVTT_miech_test/v2t_metrics/R1: 16.1
 MSRVTT_miech_test/v2t_metrics/R5: 42.9
 MSRVTT_miech_test/v2t_metrics/R10: 57.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.1
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 34.154
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.018827519269585
 mnt_best       : 33.403639031233475
 not_improved_count: 0
Train Epoch: 5 [1/125 256/32000 (1%)] Loss: 3.82778 (QuantReg: 12.57741) QuantErr: 12.57741 batch_time=45.09069 
Train Epoch: 5 [17/125 4352/32000 (14%)] Loss: 3.53992 (QuantReg: 12.75915) QuantErr: 12.75915 batch_time=0.72894 
Train Epoch: 5 [33/125 8448/32000 (26%)] Loss: 3.77619 (QuantReg: 12.83578) QuantErr: 12.83578 batch_time=0.80714 
Train Epoch: 5 [49/125 12544/32000 (39%)] Loss: 3.69020 (QuantReg: 12.86575) QuantErr: 12.86575 batch_time=0.77002 
Train Epoch: 5 [65/125 16640/32000 (52%)] Loss: 3.70943 (QuantReg: 12.69686) QuantErr: 12.69686 batch_time=6.40612 
Train Epoch: 5 [81/125 20736/32000 (65%)] Loss: 3.84783 (QuantReg: 12.86576) QuantErr: 12.86576 batch_time=0.75223 
Train Epoch: 5 [97/125 24832/32000 (78%)] Loss: 3.55924 (QuantReg: 13.25174) QuantErr: 13.25174 batch_time=0.89201 
Train Epoch: 5 [113/125 28928/32000 (90%)] Loss: 3.08444 (QuantReg: 12.81999) QuantErr: 12.81999 batch_time=0.76249 
Train Epoch: 5 codebook_update_time=1.86100
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch5.pth ...
Done in 4.261s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch5.pth ...
Done in 8.530s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 5
 loss           : 3.613669885635376
 quant_reg      : 12.836453620910644
 quant_err      : 12.836453620910644
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 625
 MSRVTT_miech_test/t2v_metrics/R1: 16.1
 MSRVTT_miech_test/t2v_metrics/R5: 43.2
 MSRVTT_miech_test/t2v_metrics/R10: 57.3
 MSRVTT_miech_test/t2v_metrics/R50: 86.6
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.834
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.15765766306831
 MSRVTT_miech_test/v2t_metrics/R1: 17.4
 MSRVTT_miech_test/v2t_metrics/R5: 43.0
 MSRVTT_miech_test/v2t_metrics/R10: 58.2
 MSRVTT_miech_test/v2t_metrics/R50: 86.3
 MSRVTT_miech_test/v2t_metrics/MedR: 7.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.277
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.18143606193693
 mnt_best       : 34.15765766306831
 not_improved_count: 0
Train Epoch: 6 [1/125 256/32000 (1%)] Loss: 3.33740 (QuantReg: 12.69707) QuantErr: 12.69707 batch_time=46.52213 
Train Epoch: 6 [17/125 4352/32000 (14%)] Loss: 3.45406 (QuantReg: 12.81668) QuantErr: 12.81668 batch_time=2.02940 
Train Epoch: 6 [33/125 8448/32000 (26%)] Loss: 3.57026 (QuantReg: 12.95340) QuantErr: 12.95340 batch_time=0.73852 
Train Epoch: 6 [49/125 12544/32000 (39%)] Loss: 3.04800 (QuantReg: 12.83438) QuantErr: 12.83438 batch_time=0.74556 
Train Epoch: 6 [65/125 16640/32000 (52%)] Loss: 3.48805 (QuantReg: 12.94952) QuantErr: 12.94952 batch_time=7.97509 
Train Epoch: 6 [81/125 20736/32000 (65%)] Loss: 3.03759 (QuantReg: 12.97324) QuantErr: 12.97324 batch_time=1.60782 
Train Epoch: 6 [97/125 24832/32000 (78%)] Loss: 2.89576 (QuantReg: 12.88270) QuantErr: 12.88270 batch_time=0.89328 
Train Epoch: 6 [113/125 28928/32000 (90%)] Loss: 3.57612 (QuantReg: 12.95543) QuantErr: 12.95543 batch_time=0.86118 
Train Epoch: 6 codebook_update_time=1.65344
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch6.pth ...
Done in 4.262s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch6.pth ...
Done in 9.025s
removing stale ckpt [epoch 6] [took 0.02s]
 epoch          : 6
 loss           : 3.3221049976348875
 quant_reg      : 12.929072692871094
 quant_err      : 12.929072692871094
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 750
 MSRVTT_miech_test/t2v_metrics/R1: 15.9
 MSRVTT_miech_test/t2v_metrics/R5: 43.2
 MSRVTT_miech_test/t2v_metrics/R10: 58.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.753
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.32933483666033
 MSRVTT_miech_test/v2t_metrics/R1: 16.6
 MSRVTT_miech_test/v2t_metrics/R5: 45.7
 MSRVTT_miech_test/v2t_metrics/R10: 59.6
 MSRVTT_miech_test/v2t_metrics/R50: 87.1
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.84
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.62516211273312
 mnt_best       : 34.32933483666033
 not_improved_count: 0
Train Epoch: 7 [1/125 256/32000 (1%)] Loss: 3.26690 (QuantReg: 12.86987) QuantErr: 12.86987 batch_time=35.98014 
Train Epoch: 7 [17/125 4352/32000 (14%)] Loss: 3.15196 (QuantReg: 12.64528) QuantErr: 12.64528 batch_time=0.78815 
Train Epoch: 7 [33/125 8448/32000 (26%)] Loss: 2.93902 (QuantReg: 13.15351) QuantErr: 13.15351 batch_time=0.73511 
Train Epoch: 7 [49/125 12544/32000 (39%)] Loss: 3.12454 (QuantReg: 13.05793) QuantErr: 13.05793 batch_time=0.90134 
Train Epoch: 7 [65/125 16640/32000 (52%)] Loss: 2.97170 (QuantReg: 12.94268) QuantErr: 12.94268 batch_time=1.64281 
Train Epoch: 7 [81/125 20736/32000 (65%)] Loss: 3.23762 (QuantReg: 12.92179) QuantErr: 12.92179 batch_time=0.72986 
Train Epoch: 7 [97/125 24832/32000 (78%)] Loss: 3.23725 (QuantReg: 13.11573) QuantErr: 13.11573 batch_time=0.74561 
Train Epoch: 7 [113/125 28928/32000 (90%)] Loss: 2.85358 (QuantReg: 13.28384) QuantErr: 13.28384 batch_time=0.73963 
Train Epoch: 7 codebook_update_time=1.72587
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch7.pth ...
Done in 4.904s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch7.pth ...
Done in 9.879s
removing stale ckpt [epoch 7] [took 0.05s]
 epoch          : 7
 loss           : 3.167802888870239
 quant_reg      : 13.001379508972168
 quant_err      : 13.001379508972168
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 875
 MSRVTT_miech_test/t2v_metrics/R1: 17.0
 MSRVTT_miech_test/t2v_metrics/R5: 43.4
 MSRVTT_miech_test/t2v_metrics/R10: 57.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.192
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.87670906266777
 MSRVTT_miech_test/v2t_metrics/R1: 18.5
 MSRVTT_miech_test/v2t_metrics/R5: 47.9
 MSRVTT_miech_test/v2t_metrics/R10: 60.2
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.656
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.644474967712796
 mnt_best       : 34.87670906266777
 not_improved_count: 0
Train Epoch: 8 [1/125 256/32000 (1%)] Loss: 3.05569 (QuantReg: 13.10098) QuantErr: 13.10098 batch_time=46.17962 
Train Epoch: 8 [17/125 4352/32000 (14%)] Loss: 2.84674 (QuantReg: 13.12735) QuantErr: 13.12735 batch_time=0.89852 
Train Epoch: 8 [33/125 8448/32000 (26%)] Loss: 2.80801 (QuantReg: 13.11777) QuantErr: 13.11777 batch_time=0.89391 
Train Epoch: 8 [49/125 12544/32000 (39%)] Loss: 3.04988 (QuantReg: 12.97716) QuantErr: 12.97716 batch_time=0.75405 
Train Epoch: 8 [65/125 16640/32000 (52%)] Loss: 2.91836 (QuantReg: 12.99598) QuantErr: 12.99598 batch_time=6.78082 
Train Epoch: 8 [81/125 20736/32000 (65%)] Loss: 3.04910 (QuantReg: 13.11055) QuantErr: 13.11055 batch_time=0.76281 
Train Epoch: 8 [97/125 24832/32000 (78%)] Loss: 2.74082 (QuantReg: 13.14666) QuantErr: 13.14666 batch_time=0.88181 
Train Epoch: 8 [113/125 28928/32000 (90%)] Loss: 3.11986 (QuantReg: 13.27256) QuantErr: 13.27256 batch_time=0.74406 
Train Epoch: 8 codebook_update_time=1.71114
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch8.pth ...
Done in 6.534s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch8.pth ...
Done in 11.512s
removing stale ckpt [epoch 8] [took 0.01s]
 epoch          : 8
 loss           : 2.9614433555603026
 quant_reg      : 13.12472925567627
 quant_err      : 13.12472925567627
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 1000
 MSRVTT_miech_test/t2v_metrics/R1: 16.9
 MSRVTT_miech_test/t2v_metrics/R5: 44.7
 MSRVTT_miech_test/t2v_metrics/R10: 59.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.022
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.51536701630851
 MSRVTT_miech_test/v2t_metrics/R1: 18.6
 MSRVTT_miech_test/v2t_metrics/R5: 47.3
 MSRVTT_miech_test/v2t_metrics/R10: 61.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.842
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.801945534084034
 mnt_best       : 35.51536701630851
 not_improved_count: 0
Train Epoch: 9 [1/125 256/32000 (1%)] Loss: 3.04628 (QuantReg: 13.12613) QuantErr: 13.12613 batch_time=39.66007 
Train Epoch: 9 [17/125 4352/32000 (14%)] Loss: 2.88302 (QuantReg: 13.23216) QuantErr: 13.23216 batch_time=2.64437 
Train Epoch: 9 [33/125 8448/32000 (26%)] Loss: 2.97521 (QuantReg: 12.89892) QuantErr: 12.89892 batch_time=2.01446 
Train Epoch: 9 [49/125 12544/32000 (39%)] Loss: 2.85233 (QuantReg: 13.45520) QuantErr: 13.45520 batch_time=0.77147 
Train Epoch: 9 [65/125 16640/32000 (52%)] Loss: 2.65938 (QuantReg: 13.47434) QuantErr: 13.47434 batch_time=3.10814 
Train Epoch: 9 [81/125 20736/32000 (65%)] Loss: 2.95605 (QuantReg: 13.18116) QuantErr: 13.18116 batch_time=2.55556 
Train Epoch: 9 [97/125 24832/32000 (78%)] Loss: 2.54424 (QuantReg: 13.30289) QuantErr: 13.30289 batch_time=1.93527 
Train Epoch: 9 [113/125 28928/32000 (90%)] Loss: 2.92531 (QuantReg: 13.49944) QuantErr: 13.49944 batch_time=0.76207 
Train Epoch: 9 codebook_update_time=1.70249
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch9.pth ...
Done in 4.067s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch9.pth ...
Done in 8.201s
removing stale ckpt [epoch 9] [took 0.01s]
 epoch          : 9
 loss           : 2.807633728027344
 quant_reg      : 13.274724647521973
 quant_err      : 13.274724647521973
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 1125
 MSRVTT_miech_test/t2v_metrics/R1: 18.2
 MSRVTT_miech_test/t2v_metrics/R5: 45.5
 MSRVTT_miech_test/t2v_metrics/R10: 59.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.123999999999995
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.7016597981715
 MSRVTT_miech_test/v2t_metrics/R1: 19.2
 MSRVTT_miech_test/v2t_metrics/R5: 47.9
 MSRVTT_miech_test/v2t_metrics/R10: 60.8
 MSRVTT_miech_test/v2t_metrics/R50: 87.3
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 30.954
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.23960877969066
 mnt_best       : 36.7016597981715
 not_improved_count: 0
Train Epoch: 10 [1/125 256/32000 (1%)] Loss: 2.79822 (QuantReg: 13.15299) QuantErr: 13.15299 batch_time=57.11986 
Train Epoch: 10 [17/125 4352/32000 (14%)] Loss: 3.09352 (QuantReg: 13.16178) QuantErr: 13.16178 batch_time=0.74485 
Train Epoch: 10 [33/125 8448/32000 (26%)] Loss: 2.72540 (QuantReg: 13.07067) QuantErr: 13.07067 batch_time=0.81702 
Train Epoch: 10 [49/125 12544/32000 (39%)] Loss: 2.73947 (QuantReg: 13.25374) QuantErr: 13.25374 batch_time=0.72911 
Train Epoch: 10 [65/125 16640/32000 (52%)] Loss: 2.63133 (QuantReg: 13.34232) QuantErr: 13.34232 batch_time=18.11068 
Train Epoch: 10 [81/125 20736/32000 (65%)] Loss: 2.56769 (QuantReg: 13.41874) QuantErr: 13.41874 batch_time=0.90534 
Train Epoch: 10 [97/125 24832/32000 (78%)] Loss: 2.64937 (QuantReg: 13.32192) QuantErr: 13.32192 batch_time=0.92667 
Train Epoch: 10 [113/125 28928/32000 (90%)] Loss: 3.11719 (QuantReg: 13.18900) QuantErr: 13.18900 batch_time=0.89092 
Train Epoch: 10 codebook_update_time=1.75323
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch10.pth ...
Done in 4.317s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch10.pth ...
Done in 8.763s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 10
 loss           : 2.7018572978973387
 quant_reg      : 13.29768522644043
 quant_err      : 13.29768522644043
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 1250
 MSRVTT_miech_test/t2v_metrics/R1: 18.5
 MSRVTT_miech_test/t2v_metrics/R5: 46.8
 MSRVTT_miech_test/t2v_metrics/R10: 60.1
 MSRVTT_miech_test/t2v_metrics/R50: 88.6
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.544
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.33338346790318
 MSRVTT_miech_test/v2t_metrics/R1: 18.3
 MSRVTT_miech_test/v2t_metrics/R5: 48.5
 MSRVTT_miech_test/v2t_metrics/R10: 61.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.3095
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.99505706712973
 mnt_best       : 37.33338346790318
 not_improved_count: 0
Train Epoch: 11 [1/125 256/32000 (1%)] Loss: 2.72269 (QuantReg: 13.03548) QuantErr: 13.03548 batch_time=37.78643 
Train Epoch: 11 [17/125 4352/32000 (14%)] Loss: 2.76007 (QuantReg: 13.35184) QuantErr: 13.35184 batch_time=0.79246 
Train Epoch: 11 [33/125 8448/32000 (26%)] Loss: 1.98656 (QuantReg: 13.57815) QuantErr: 13.57815 batch_time=0.80372 
Train Epoch: 11 [49/125 12544/32000 (39%)] Loss: 2.78320 (QuantReg: 13.14348) QuantErr: 13.14348 batch_time=0.77684 
Train Epoch: 11 [65/125 16640/32000 (52%)] Loss: 2.48294 (QuantReg: 13.46745) QuantErr: 13.46745 batch_time=1.17712 
Train Epoch: 11 [81/125 20736/32000 (65%)] Loss: 2.62469 (QuantReg: 13.48170) QuantErr: 13.48170 batch_time=0.76372 
Train Epoch: 11 [97/125 24832/32000 (78%)] Loss: 2.80237 (QuantReg: 13.46742) QuantErr: 13.46742 batch_time=0.76831 
Train Epoch: 11 [113/125 28928/32000 (90%)] Loss: 2.48604 (QuantReg: 13.38226) QuantErr: 13.38226 batch_time=0.76231 
Train Epoch: 11 codebook_update_time=1.71832
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch11.pth ...
Done in 4.875s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch11.pth ...
Done in 9.333s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 11
 loss           : 2.6001751947402956
 quant_reg      : 13.345651679992676
 quant_err      : 13.345651679992676
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 1375
 MSRVTT_miech_test/t2v_metrics/R1: 19.4
 MSRVTT_miech_test/t2v_metrics/R5: 47.8
 MSRVTT_miech_test/t2v_metrics/R10: 60.1
 MSRVTT_miech_test/t2v_metrics/R50: 88.0
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.866
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.19747888663892
 MSRVTT_miech_test/v2t_metrics/R1: 17.0
 MSRVTT_miech_test/v2t_metrics/R5: 49.2
 MSRVTT_miech_test/v2t_metrics/R10: 61.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.16
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.27075791516458
 mnt_best       : 38.19747888663892
 not_improved_count: 0
Train Epoch: 12 [1/125 256/32000 (1%)] Loss: 2.65945 (QuantReg: 13.14517) QuantErr: 13.14517 batch_time=40.05432 
Train Epoch: 12 [17/125 4352/32000 (14%)] Loss: 2.67990 (QuantReg: 13.33911) QuantErr: 13.33911 batch_time=0.74600 
Train Epoch: 12 [33/125 8448/32000 (26%)] Loss: 2.77681 (QuantReg: 13.31500) QuantErr: 13.31500 batch_time=0.76268 
Train Epoch: 12 [49/125 12544/32000 (39%)] Loss: 2.38276 (QuantReg: 13.30216) QuantErr: 13.30216 batch_time=0.89496 
Train Epoch: 12 [65/125 16640/32000 (52%)] Loss: 2.60515 (QuantReg: 13.56962) QuantErr: 13.56962 batch_time=2.27490 
Train Epoch: 12 [81/125 20736/32000 (65%)] Loss: 2.57785 (QuantReg: 13.28421) QuantErr: 13.28421 batch_time=0.92793 
Train Epoch: 12 [97/125 24832/32000 (78%)] Loss: 2.53987 (QuantReg: 13.33428) QuantErr: 13.33428 batch_time=0.90062 
Train Epoch: 12 [113/125 28928/32000 (90%)] Loss: 2.40406 (QuantReg: 13.40476) QuantErr: 13.40476 batch_time=0.73138 
Train Epoch: 12 codebook_update_time=1.83058
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch12.pth ...
Done in 12.922s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch12.pth ...
Done in 17.735s
removing stale ckpt [epoch 12] [took 0.01s]
 epoch          : 12
 loss           : 2.5442882690429687
 quant_reg      : 13.414248100280762
 quant_err      : 13.414248100280762
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 1500
 MSRVTT_miech_test/t2v_metrics/R1: 19.5
 MSRVTT_miech_test/t2v_metrics/R5: 47.5
 MSRVTT_miech_test/t2v_metrics/R10: 62.3
 MSRVTT_miech_test/t2v_metrics/R50: 88.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.218
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.643111603174205
 MSRVTT_miech_test/v2t_metrics/R1: 19.3
 MSRVTT_miech_test/v2t_metrics/R5: 50.2
 MSRVTT_miech_test/v2t_metrics/R10: 63.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.337
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.559788535598045
 mnt_best       : 38.643111603174205
 not_improved_count: 0
Train Epoch: 13 [1/125 256/32000 (1%)] Loss: 2.48664 (QuantReg: 13.30808) QuantErr: 13.30808 batch_time=39.14425 
Train Epoch: 13 [17/125 4352/32000 (14%)] Loss: 2.50461 (QuantReg: 13.47447) QuantErr: 13.47447 batch_time=5.90937 
Train Epoch: 13 [33/125 8448/32000 (26%)] Loss: 2.31938 (QuantReg: 13.56849) QuantErr: 13.56849 batch_time=0.75904 
Train Epoch: 13 [49/125 12544/32000 (39%)] Loss: 2.48456 (QuantReg: 13.60749) QuantErr: 13.60749 batch_time=0.77375 
Train Epoch: 13 [65/125 16640/32000 (52%)] Loss: 2.78638 (QuantReg: 13.46425) QuantErr: 13.46425 batch_time=2.18977 
Train Epoch: 13 [81/125 20736/32000 (65%)] Loss: 2.43629 (QuantReg: 13.36565) QuantErr: 13.36565 batch_time=4.80321 
Train Epoch: 13 [97/125 24832/32000 (78%)] Loss: 2.76567 (QuantReg: 13.35144) QuantErr: 13.35144 batch_time=0.77106 
Train Epoch: 13 [113/125 28928/32000 (90%)] Loss: 2.28713 (QuantReg: 13.40346) QuantErr: 13.40346 batch_time=0.94584 
Train Epoch: 13 codebook_update_time=2.03133
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch13.pth ...
Done in 4.542s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch13.pth ...
Done in 8.987s
removing stale ckpt [epoch 13] [took 0.02s]
 epoch          : 13
 loss           : 2.456074451446533
 quant_reg      : 13.429542633056641
 quant_err      : 13.429542633056641
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 1625
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 48.1
 MSRVTT_miech_test/t2v_metrics/R10: 62.1
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.89
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.96134631760129
 MSRVTT_miech_test/v2t_metrics/R1: 20.7
 MSRVTT_miech_test/v2t_metrics/R5: 50.1
 MSRVTT_miech_test/v2t_metrics/R10: 62.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.876
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.2549760189323
 mnt_best       : 38.96134631760129
 not_improved_count: 0
Train Epoch: 14 [1/125 256/32000 (1%)] Loss: 2.57129 (QuantReg: 13.19743) QuantErr: 13.19743 batch_time=38.81640 
Train Epoch: 14 [17/125 4352/32000 (14%)] Loss: 2.39885 (QuantReg: 13.43248) QuantErr: 13.43248 batch_time=7.57258 
Train Epoch: 14 [33/125 8448/32000 (26%)] Loss: 2.04156 (QuantReg: 13.09129) QuantErr: 13.09129 batch_time=0.73757 
Train Epoch: 14 [49/125 12544/32000 (39%)] Loss: 2.73289 (QuantReg: 13.48167) QuantErr: 13.48167 batch_time=0.73067 
Train Epoch: 14 [65/125 16640/32000 (52%)] Loss: 2.22448 (QuantReg: 13.41312) QuantErr: 13.41312 batch_time=2.71842 
Train Epoch: 14 [81/125 20736/32000 (65%)] Loss: 2.56796 (QuantReg: 13.33382) QuantErr: 13.33382 batch_time=5.05839 
Train Epoch: 14 [97/125 24832/32000 (78%)] Loss: 2.20506 (QuantReg: 13.49570) QuantErr: 13.49570 batch_time=0.73221 
Train Epoch: 14 [113/125 28928/32000 (90%)] Loss: 2.17724 (QuantReg: 13.55258) QuantErr: 13.55258 batch_time=0.77797 
Train Epoch: 14 codebook_update_time=1.95382
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch14.pth ...
Done in 4.308s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch14.pth ...
Done in 8.528s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 14
 loss           : 2.3585738821029665
 quant_reg      : 13.470196754455566
 quant_err      : 13.470196754455566
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 1750
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 46.7
 MSRVTT_miech_test/t2v_metrics/R10: 62.6
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.242
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.32344122269908
 MSRVTT_miech_test/v2t_metrics/R1: 19.5
 MSRVTT_miech_test/v2t_metrics/R5: 49.2
 MSRVTT_miech_test/v2t_metrics/R10: 62.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.8635
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.22384100881353
 mnt_best       : 39.32344122269908
 not_improved_count: 0
Train Epoch: 15 [1/125 256/32000 (1%)] Loss: 2.55296 (QuantReg: 13.40791) QuantErr: 13.40791 batch_time=47.32788 
Train Epoch: 15 [17/125 4352/32000 (14%)] Loss: 2.35918 (QuantReg: 13.49488) QuantErr: 13.49488 batch_time=1.19534 
Train Epoch: 15 [33/125 8448/32000 (26%)] Loss: 2.72578 (QuantReg: 13.56115) QuantErr: 13.56115 batch_time=0.89362 
Train Epoch: 15 [49/125 12544/32000 (39%)] Loss: 2.53416 (QuantReg: 13.68297) QuantErr: 13.68297 batch_time=0.74812 
Train Epoch: 15 [65/125 16640/32000 (52%)] Loss: 2.44916 (QuantReg: 13.45482) QuantErr: 13.45482 batch_time=6.71339 
Train Epoch: 15 [81/125 20736/32000 (65%)] Loss: 2.12189 (QuantReg: 13.48440) QuantErr: 13.48440 batch_time=1.24697 
Train Epoch: 15 [97/125 24832/32000 (78%)] Loss: 2.00877 (QuantReg: 13.63394) QuantErr: 13.63394 batch_time=0.77239 
Train Epoch: 15 [113/125 28928/32000 (90%)] Loss: 2.22833 (QuantReg: 13.44307) QuantErr: 13.44307 batch_time=0.76438 
Train Epoch: 15 codebook_update_time=1.71881
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch15.pth ...
Done in 8.101s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 15
 loss           : 2.336775164604187
 quant_reg      : 13.525437263488769
 quant_err      : 13.525437263488769
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 1875
 MSRVTT_miech_test/t2v_metrics/R1: 20.0
 MSRVTT_miech_test/t2v_metrics/R5: 48.2
 MSRVTT_miech_test/t2v_metrics/R10: 62.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.883
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.09815294244609
 MSRVTT_miech_test/v2t_metrics/R1: 20.6
 MSRVTT_miech_test/v2t_metrics/R5: 49.3
 MSRVTT_miech_test/v2t_metrics/R10: 64.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.854
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.22759382025779
 mnt_best       : 39.32344122269908
 not_improved_count: 1
Train Epoch: 16 [1/125 256/32000 (1%)] Loss: 2.40790 (QuantReg: 13.23400) QuantErr: 13.23400 batch_time=39.74004 
Train Epoch: 16 [17/125 4352/32000 (14%)] Loss: 2.76185 (QuantReg: 13.41112) QuantErr: 13.41112 batch_time=0.92511 
Train Epoch: 16 [33/125 8448/32000 (26%)] Loss: 2.52513 (QuantReg: 13.53730) QuantErr: 13.53730 batch_time=0.87560 
Train Epoch: 16 [49/125 12544/32000 (39%)] Loss: 2.31365 (QuantReg: 13.67955) QuantErr: 13.67955 batch_time=0.84184 
Train Epoch: 16 [65/125 16640/32000 (52%)] Loss: 2.42997 (QuantReg: 13.53658) QuantErr: 13.53658 batch_time=2.91841 
Train Epoch: 16 [81/125 20736/32000 (65%)] Loss: 2.44295 (QuantReg: 13.48556) QuantErr: 13.48556 batch_time=0.71571 
Train Epoch: 16 [97/125 24832/32000 (78%)] Loss: 2.16419 (QuantReg: 13.68277) QuantErr: 13.68277 batch_time=0.81713 
Train Epoch: 16 [113/125 28928/32000 (90%)] Loss: 2.32952 (QuantReg: 13.54643) QuantErr: 13.54643 batch_time=0.76232 
Train Epoch: 16 codebook_update_time=1.69030
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch16.pth ...
Done in 4.407s
removing stale ckpt [epoch 16] [took 0.02s]
 epoch          : 16
 loss           : 2.266385666847229
 quant_reg      : 13.569229217529298
 quant_err      : 13.569229217529298
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 2000
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 48.5
 MSRVTT_miech_test/t2v_metrics/R10: 61.7
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.318
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.984984357539304
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 50.4
 MSRVTT_miech_test/v2t_metrics/R10: 63.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.835
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.15843331031032
 mnt_best       : 39.32344122269908
 not_improved_count: 2
Train Epoch: 17 [1/125 256/32000 (1%)] Loss: 2.62203 (QuantReg: 13.49256) QuantErr: 13.49256 batch_time=36.25685 
Train Epoch: 17 [17/125 4352/32000 (14%)] Loss: 2.36017 (QuantReg: 13.51365) QuantErr: 13.51365 batch_time=1.24761 
Train Epoch: 17 [33/125 8448/32000 (26%)] Loss: 2.00974 (QuantReg: 13.68151) QuantErr: 13.68151 batch_time=0.77238 
Train Epoch: 17 [49/125 12544/32000 (39%)] Loss: 2.50440 (QuantReg: 13.77829) QuantErr: 13.77829 batch_time=0.86925 
Train Epoch: 17 [65/125 16640/32000 (52%)] Loss: 1.94465 (QuantReg: 13.72871) QuantErr: 13.72871 batch_time=1.74067 
Train Epoch: 17 [81/125 20736/32000 (65%)] Loss: 2.40426 (QuantReg: 13.61636) QuantErr: 13.61636 batch_time=1.42807 
Train Epoch: 17 [97/125 24832/32000 (78%)] Loss: 2.18884 (QuantReg: 13.59795) QuantErr: 13.59795 batch_time=0.82628 
Train Epoch: 17 [113/125 28928/32000 (90%)] Loss: 1.98781 (QuantReg: 13.50917) QuantErr: 13.50917 batch_time=0.72152 
Train Epoch: 17 codebook_update_time=1.67058
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch17.pth ...
Done in 4.210s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch17.pth ...
Done in 8.257s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 17
 loss           : 2.2049767293930054
 quant_reg      : 13.603093521118165
 quant_err      : 13.603093521118165
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 2125
 MSRVTT_miech_test/t2v_metrics/R1: 21.3
 MSRVTT_miech_test/t2v_metrics/R5: 47.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.212
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.072046820147534
 MSRVTT_miech_test/v2t_metrics/R1: 20.1
 MSRVTT_miech_test/v2t_metrics/R5: 50.3
 MSRVTT_miech_test/v2t_metrics/R10: 64.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.25
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.019
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.16742801041546
 mnt_best       : 40.072046820147534
 not_improved_count: 0
Train Epoch: 18 [1/125 256/32000 (1%)] Loss: 2.22027 (QuantReg: 13.28926) QuantErr: 13.28926 batch_time=36.71369 
Train Epoch: 18 [17/125 4352/32000 (14%)] Loss: 2.25636 (QuantReg: 13.59343) QuantErr: 13.59343 batch_time=0.75788 
Train Epoch: 18 [33/125 8448/32000 (26%)] Loss: 2.12707 (QuantReg: 13.86194) QuantErr: 13.86194 batch_time=0.77261 
Train Epoch: 18 [49/125 12544/32000 (39%)] Loss: 2.27685 (QuantReg: 13.53579) QuantErr: 13.53579 batch_time=0.91313 
Train Epoch: 18 [65/125 16640/32000 (52%)] Loss: 2.24404 (QuantReg: 13.64703) QuantErr: 13.64703 batch_time=2.19139 
Train Epoch: 18 [81/125 20736/32000 (65%)] Loss: 2.02047 (QuantReg: 13.67931) QuantErr: 13.67931 batch_time=0.86277 
Train Epoch: 18 [97/125 24832/32000 (78%)] Loss: 2.39986 (QuantReg: 13.77700) QuantErr: 13.77700 batch_time=0.75221 
Train Epoch: 18 [113/125 28928/32000 (90%)] Loss: 2.33054 (QuantReg: 13.59996) QuantErr: 13.59996 batch_time=0.75310 
Train Epoch: 18 codebook_update_time=1.73852
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch18.pth ...
Done in 4.954s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 18
 loss           : 2.1738730411529543
 quant_reg      : 13.6195474319458
 quant_err      : 13.6195474319458
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 2250
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 48.4
 MSRVTT_miech_test/t2v_metrics/R10: 62.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.685
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.79441434032447
 MSRVTT_miech_test/v2t_metrics/R1: 21.3
 MSRVTT_miech_test/v2t_metrics/R5: 50.4
 MSRVTT_miech_test/v2t_metrics/R10: 64.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.4135
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.99979853162948
 mnt_best       : 40.072046820147534
 not_improved_count: 1
Train Epoch: 19 [1/125 256/32000 (1%)] Loss: 2.17492 (QuantReg: 13.56718) QuantErr: 13.56718 batch_time=35.24122 
Train Epoch: 19 [17/125 4352/32000 (14%)] Loss: 2.15985 (QuantReg: 13.44400) QuantErr: 13.44400 batch_time=1.20313 
Train Epoch: 19 [33/125 8448/32000 (26%)] Loss: 2.05996 (QuantReg: 13.45599) QuantErr: 13.45599 batch_time=0.89997 
Train Epoch: 19 [49/125 12544/32000 (39%)] Loss: 2.42406 (QuantReg: 13.55707) QuantErr: 13.55707 batch_time=0.77196 
Train Epoch: 19 [65/125 16640/32000 (52%)] Loss: 1.94571 (QuantReg: 13.65771) QuantErr: 13.65771 batch_time=0.75567 
Train Epoch: 19 [81/125 20736/32000 (65%)] Loss: 1.90658 (QuantReg: 13.98544) QuantErr: 13.98544 batch_time=0.75681 
Train Epoch: 19 [97/125 24832/32000 (78%)] Loss: 2.12411 (QuantReg: 13.65374) QuantErr: 13.65374 batch_time=0.77128 
Train Epoch: 19 [113/125 28928/32000 (90%)] Loss: 2.17283 (QuantReg: 13.81982) QuantErr: 13.81982 batch_time=0.75167 
Train Epoch: 19 codebook_update_time=1.67432
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch19.pth ...
Done in 3.834s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 19
 loss           : 2.083871910095215
 quant_reg      : 13.66378776550293
 quant_err      : 13.66378776550293
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 2375
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.1
 MSRVTT_miech_test/t2v_metrics/R10: 62.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.72
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.921877521289474
 MSRVTT_miech_test/v2t_metrics/R1: 20.4
 MSRVTT_miech_test/v2t_metrics/R5: 51.6
 MSRVTT_miech_test/v2t_metrics/R10: 64.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.4935
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.858738923605316
 mnt_best       : 40.072046820147534
 not_improved_count: 2
Train Epoch: 20 [1/125 256/32000 (1%)] Loss: 2.41058 (QuantReg: 13.70109) QuantErr: 13.70109 batch_time=39.30584 
Train Epoch: 20 [17/125 4352/32000 (14%)] Loss: 2.18798 (QuantReg: 13.68951) QuantErr: 13.68951 batch_time=0.92508 
Train Epoch: 20 [33/125 8448/32000 (26%)] Loss: 2.07567 (QuantReg: 13.60196) QuantErr: 13.60196 batch_time=0.75511 
Train Epoch: 20 [49/125 12544/32000 (39%)] Loss: 2.00466 (QuantReg: 13.94849) QuantErr: 13.94849 batch_time=1.00068 
Train Epoch: 20 [65/125 16640/32000 (52%)] Loss: 2.30463 (QuantReg: 13.72861) QuantErr: 13.72861 batch_time=2.47947 
Train Epoch: 20 [81/125 20736/32000 (65%)] Loss: 2.17136 (QuantReg: 13.84188) QuantErr: 13.84188 batch_time=0.77828 
Train Epoch: 20 [97/125 24832/32000 (78%)] Loss: 2.09806 (QuantReg: 13.65128) QuantErr: 13.65128 batch_time=0.75695 
Train Epoch: 20 [113/125 28928/32000 (90%)] Loss: 1.86590 (QuantReg: 13.95629) QuantErr: 13.95629 batch_time=0.76581 
Train Epoch: 20 codebook_update_time=1.77714
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch20.pth ...
Done in 4.094s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 20
 loss           : 2.055504921913147
 quant_reg      : 13.739928886413574
 quant_err      : 13.739928886413574
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 2500
 MSRVTT_miech_test/t2v_metrics/R1: 20.3
 MSRVTT_miech_test/t2v_metrics/R5: 49.0
 MSRVTT_miech_test/t2v_metrics/R10: 63.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.703
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.78309889028793
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.2145
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.01833484936193
 mnt_best       : 40.072046820147534
 not_improved_count: 3
Train Epoch: 21 [1/125 256/32000 (1%)] Loss: 1.99100 (QuantReg: 13.58217) QuantErr: 13.58217 batch_time=36.57952 
Train Epoch: 21 [17/125 4352/32000 (14%)] Loss: 2.44143 (QuantReg: 13.58751) QuantErr: 13.58751 batch_time=0.75226 
Train Epoch: 21 [33/125 8448/32000 (26%)] Loss: 1.84160 (QuantReg: 13.70279) QuantErr: 13.70279 batch_time=0.91188 
Train Epoch: 21 [49/125 12544/32000 (39%)] Loss: 1.96765 (QuantReg: 13.47447) QuantErr: 13.47447 batch_time=0.74066 
Train Epoch: 21 [65/125 16640/32000 (52%)] Loss: 2.14845 (QuantReg: 13.62107) QuantErr: 13.62107 batch_time=2.17341 
Train Epoch: 21 [81/125 20736/32000 (65%)] Loss: 1.96274 (QuantReg: 13.84633) QuantErr: 13.84633 batch_time=0.84498 
Train Epoch: 21 [97/125 24832/32000 (78%)] Loss: 1.87879 (QuantReg: 13.60585) QuantErr: 13.60585 batch_time=0.74723 
Train Epoch: 21 [113/125 28928/32000 (90%)] Loss: 2.08003 (QuantReg: 13.63481) QuantErr: 13.63481 batch_time=0.76305 
Train Epoch: 21 codebook_update_time=1.93646
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch21.pth ...
Done in 4.397s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 21
 loss           : 2.0239299573898317
 quant_reg      : 13.771035987854004
 quant_err      : 13.771035987854004
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 2625
 MSRVTT_miech_test/t2v_metrics/R1: 20.0
 MSRVTT_miech_test/t2v_metrics/R5: 48.6
 MSRVTT_miech_test/t2v_metrics/R10: 63.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.538
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.41567225899101
 MSRVTT_miech_test/v2t_metrics/R1: 21.5
 MSRVTT_miech_test/v2t_metrics/R5: 50.8
 MSRVTT_miech_test/v2t_metrics/R10: 65.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.916
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.491580040466445
 mnt_best       : 40.072046820147534
 not_improved_count: 4
Train Epoch: 22 [1/125 256/32000 (1%)] Loss: 2.02240 (QuantReg: 13.54324) QuantErr: 13.54324 batch_time=56.48832 
Train Epoch: 22 [17/125 4352/32000 (14%)] Loss: 1.82942 (QuantReg: 13.76492) QuantErr: 13.76492 batch_time=0.86108 
Train Epoch: 22 [33/125 8448/32000 (26%)] Loss: 1.93666 (QuantReg: 13.71185) QuantErr: 13.71185 batch_time=0.82724 
Train Epoch: 22 [49/125 12544/32000 (39%)] Loss: 2.19731 (QuantReg: 13.64094) QuantErr: 13.64094 batch_time=0.75941 
Train Epoch: 22 [65/125 16640/32000 (52%)] Loss: 2.28273 (QuantReg: 13.67983) QuantErr: 13.67983 batch_time=12.50334 
Train Epoch: 22 [81/125 20736/32000 (65%)] Loss: 1.84671 (QuantReg: 13.90432) QuantErr: 13.90432 batch_time=0.79260 
Train Epoch: 22 [97/125 24832/32000 (78%)] Loss: 2.31941 (QuantReg: 13.64688) QuantErr: 13.64688 batch_time=0.76284 
Train Epoch: 22 [113/125 28928/32000 (90%)] Loss: 1.97063 (QuantReg: 13.70816) QuantErr: 13.70816 batch_time=0.74221 
Train Epoch: 22 codebook_update_time=1.69597
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch22.pth ...
Done in 3.710s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 22
 loss           : 2.003537805557251
 quant_reg      : 13.763699638366699
 quant_err      : 13.763699638366699
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 2750
 MSRVTT_miech_test/t2v_metrics/R1: 20.1
 MSRVTT_miech_test/t2v_metrics/R5: 49.1
 MSRVTT_miech_test/t2v_metrics/R10: 62.4
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.179
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.490022369053825
 MSRVTT_miech_test/v2t_metrics/R1: 21.4
 MSRVTT_miech_test/v2t_metrics/R5: 52.1
 MSRVTT_miech_test/v2t_metrics/R10: 66.6
 MSRVTT_miech_test/v2t_metrics/R50: 89.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.623
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.03153414096458
 mnt_best       : 40.072046820147534
 not_improved_count: 5
Train Epoch: 23 [1/125 256/32000 (1%)] Loss: 2.07708 (QuantReg: 13.59232) QuantErr: 13.59232 batch_time=38.99738 
Train Epoch: 23 [17/125 4352/32000 (14%)] Loss: 1.91262 (QuantReg: 14.02452) QuantErr: 14.02452 batch_time=0.72821 
Train Epoch: 23 [33/125 8448/32000 (26%)] Loss: 1.84160 (QuantReg: 13.51516) QuantErr: 13.51516 batch_time=0.75293 
Train Epoch: 23 [49/125 12544/32000 (39%)] Loss: 1.83541 (QuantReg: 13.79187) QuantErr: 13.79187 batch_time=0.75096 
Train Epoch: 23 [65/125 16640/32000 (52%)] Loss: 1.80782 (QuantReg: 13.82150) QuantErr: 13.82150 batch_time=5.34059 
Train Epoch: 23 [81/125 20736/32000 (65%)] Loss: 2.06870 (QuantReg: 13.95820) QuantErr: 13.95820 batch_time=0.73241 
Train Epoch: 23 [97/125 24832/32000 (78%)] Loss: 1.68189 (QuantReg: 13.99389) QuantErr: 13.99389 batch_time=0.86419 
Train Epoch: 23 [113/125 28928/32000 (90%)] Loss: 1.98416 (QuantReg: 14.02398) QuantErr: 14.02398 batch_time=0.75204 
Train Epoch: 23 codebook_update_time=1.66749
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch23.pth ...
Done in 3.989s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch23.pth ...
Done in 8.378s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 23
 loss           : 1.9602974338531494
 quant_reg      : 13.813811485290527
 quant_err      : 13.813811485290527
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 2875
 MSRVTT_miech_test/t2v_metrics/R1: 20.1
 MSRVTT_miech_test/t2v_metrics/R5: 50.7
 MSRVTT_miech_test/t2v_metrics/R10: 63.4
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.917
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.12648254923368
 MSRVTT_miech_test/v2t_metrics/R1: 20.9
 MSRVTT_miech_test/v2t_metrics/R5: 51.7
 MSRVTT_miech_test/v2t_metrics/R10: 66.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.796
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.61541415194058
 mnt_best       : 40.12648254923368
 not_improved_count: 0
Train Epoch: 24 [1/125 256/32000 (1%)] Loss: 1.86372 (QuantReg: 13.60361) QuantErr: 13.60361 batch_time=44.95315 
Train Epoch: 24 [17/125 4352/32000 (14%)] Loss: 2.08793 (QuantReg: 13.80735) QuantErr: 13.80735 batch_time=0.73586 
Train Epoch: 24 [33/125 8448/32000 (26%)] Loss: 2.06940 (QuantReg: 13.93048) QuantErr: 13.93048 batch_time=0.75676 
Train Epoch: 24 [49/125 12544/32000 (39%)] Loss: 1.68709 (QuantReg: 13.94641) QuantErr: 13.94641 batch_time=0.73057 
Train Epoch: 24 [65/125 16640/32000 (52%)] Loss: 1.94464 (QuantReg: 13.85593) QuantErr: 13.85593 batch_time=8.36510 
Train Epoch: 24 [81/125 20736/32000 (65%)] Loss: 2.20097 (QuantReg: 14.03815) QuantErr: 14.03815 batch_time=0.77764 
Train Epoch: 24 [97/125 24832/32000 (78%)] Loss: 1.86984 (QuantReg: 13.75861) QuantErr: 13.75861 batch_time=0.77780 
Train Epoch: 24 [113/125 28928/32000 (90%)] Loss: 2.01095 (QuantReg: 13.84708) QuantErr: 13.84708 batch_time=0.75410 
Train Epoch: 24 codebook_update_time=1.67169
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch24.pth ...
Done in 4.025s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch24.pth ...
Done in 7.945s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 24
 loss           : 1.9511338920593262
 quant_reg      : 13.83983991241455
 quant_err      : 13.83983991241455
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 3000
 MSRVTT_miech_test/t2v_metrics/R1: 20.6
 MSRVTT_miech_test/t2v_metrics/R5: 50.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.047
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.41709403074279
 MSRVTT_miech_test/v2t_metrics/R1: 19.4
 MSRVTT_miech_test/v2t_metrics/R5: 51.4
 MSRVTT_miech_test/v2t_metrics/R10: 65.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.152
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.23086249924592
 mnt_best       : 40.41709403074279
 not_improved_count: 0
Train Epoch: 25 [1/125 256/32000 (1%)] Loss: 1.97424 (QuantReg: 13.71260) QuantErr: 13.71260 batch_time=34.12637 
Train Epoch: 25 [17/125 4352/32000 (14%)] Loss: 2.02969 (QuantReg: 13.86772) QuantErr: 13.86772 batch_time=0.73531 
Train Epoch: 25 [33/125 8448/32000 (26%)] Loss: 2.10755 (QuantReg: 14.01048) QuantErr: 14.01048 batch_time=0.73165 
Train Epoch: 25 [49/125 12544/32000 (39%)] Loss: 1.80230 (QuantReg: 13.94064) QuantErr: 13.94064 batch_time=0.76821 
Train Epoch: 25 [65/125 16640/32000 (52%)] Loss: 1.81064 (QuantReg: 13.98614) QuantErr: 13.98614 batch_time=1.09762 
Train Epoch: 25 [81/125 20736/32000 (65%)] Loss: 2.01747 (QuantReg: 13.77172) QuantErr: 13.77172 batch_time=0.78706 
Train Epoch: 25 [97/125 24832/32000 (78%)] Loss: 2.05746 (QuantReg: 13.80378) QuantErr: 13.80378 batch_time=0.74912 
Train Epoch: 25 [113/125 28928/32000 (90%)] Loss: 1.96829 (QuantReg: 13.87070) QuantErr: 13.87070 batch_time=0.75870 
Train Epoch: 25 codebook_update_time=1.95444
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch25.pth ...
Done in 3.822s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 25
 loss           : 1.9268566579818727
 quant_reg      : 13.831238037109374
 quant_err      : 13.831238037109374
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 3125
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 49.5
 MSRVTT_miech_test/t2v_metrics/R10: 63.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.21
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.178441325293015
 MSRVTT_miech_test/v2t_metrics/R1: 19.2
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.251
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.52958423695927
 mnt_best       : 40.41709403074279
 not_improved_count: 1
Train Epoch: 26 [1/125 256/32000 (1%)] Loss: 2.26102 (QuantReg: 13.79372) QuantErr: 13.79372 batch_time=49.09939 
Train Epoch: 26 [17/125 4352/32000 (14%)] Loss: 1.73842 (QuantReg: 13.97053) QuantErr: 13.97053 batch_time=0.75627 
Train Epoch: 26 [33/125 8448/32000 (26%)] Loss: 1.79244 (QuantReg: 14.07937) QuantErr: 14.07937 batch_time=0.74895 
Train Epoch: 26 [49/125 12544/32000 (39%)] Loss: 1.94759 (QuantReg: 13.99424) QuantErr: 13.99424 batch_time=0.76063 
Train Epoch: 26 [65/125 16640/32000 (52%)] Loss: 1.94106 (QuantReg: 13.84575) QuantErr: 13.84575 batch_time=10.47824 
Train Epoch: 26 [81/125 20736/32000 (65%)] Loss: 1.80631 (QuantReg: 14.09937) QuantErr: 14.09937 batch_time=0.72652 
Train Epoch: 26 [97/125 24832/32000 (78%)] Loss: 2.15080 (QuantReg: 13.95130) QuantErr: 13.95130 batch_time=0.75100 
Train Epoch: 26 [113/125 28928/32000 (90%)] Loss: 2.06534 (QuantReg: 13.98584) QuantErr: 13.98584 batch_time=0.73999 
Train Epoch: 26 codebook_update_time=1.70579
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch26.pth ...
Done in 4.427s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch26.pth ...
Done in 8.351s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 26
 loss           : 1.915502724647522
 quant_reg      : 13.903463302612305
 quant_err      : 13.903463302612305
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 3250
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.1
 MSRVTT_miech_test/t2v_metrics/R10: 65.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.942
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.51121530578561
 MSRVTT_miech_test/v2t_metrics/R1: 20.6
 MSRVTT_miech_test/v2t_metrics/R5: 50.9
 MSRVTT_miech_test/v2t_metrics/R10: 66.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.712
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.221186514271956
 mnt_best       : 40.51121530578561
 not_improved_count: 0
Train Epoch: 27 [1/125 256/32000 (1%)] Loss: 1.75372 (QuantReg: 13.75931) QuantErr: 13.75931 batch_time=42.09995 
Train Epoch: 27 [17/125 4352/32000 (14%)] Loss: 1.85341 (QuantReg: 13.74809) QuantErr: 13.74809 batch_time=0.74929 
Train Epoch: 27 [33/125 8448/32000 (26%)] Loss: 2.04139 (QuantReg: 13.79755) QuantErr: 13.79755 batch_time=0.73983 
Train Epoch: 27 [49/125 12544/32000 (39%)] Loss: 1.80961 (QuantReg: 13.88628) QuantErr: 13.88628 batch_time=0.74579 
Train Epoch: 27 [65/125 16640/32000 (52%)] Loss: 1.93790 (QuantReg: 14.08208) QuantErr: 14.08208 batch_time=3.02484 
Train Epoch: 27 [81/125 20736/32000 (65%)] Loss: 1.81544 (QuantReg: 13.95020) QuantErr: 13.95020 batch_time=0.73397 
Train Epoch: 27 [97/125 24832/32000 (78%)] Loss: 1.68481 (QuantReg: 13.86604) QuantErr: 13.86604 batch_time=0.73352 
Train Epoch: 27 [113/125 28928/32000 (90%)] Loss: 1.84783 (QuantReg: 14.10273) QuantErr: 14.10273 batch_time=0.77296 
Train Epoch: 27 codebook_update_time=1.64053
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch27.pth ...
Done in 3.992s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 27
 loss           : 1.8952574253082275
 quant_reg      : 13.89043302154541
 quant_err      : 13.89043302154541
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 3375
 MSRVTT_miech_test/t2v_metrics/R1: 20.4
 MSRVTT_miech_test/t2v_metrics/R5: 49.7
 MSRVTT_miech_test/t2v_metrics/R10: 63.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.46
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.14231472912003
 MSRVTT_miech_test/v2t_metrics/R1: 21.4
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.71
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.00082462477677
 mnt_best       : 40.51121530578561
 not_improved_count: 1
Train Epoch: 28 [1/125 256/32000 (1%)] Loss: 1.91562 (QuantReg: 13.98800) QuantErr: 13.98800 batch_time=40.18433 
Train Epoch: 28 [17/125 4352/32000 (14%)] Loss: 2.02476 (QuantReg: 13.92173) QuantErr: 13.92173 batch_time=3.44743 
Train Epoch: 28 [33/125 8448/32000 (26%)] Loss: 2.00904 (QuantReg: 13.74483) QuantErr: 13.74483 batch_time=0.79496 
Train Epoch: 28 [49/125 12544/32000 (39%)] Loss: 1.69774 (QuantReg: 13.87645) QuantErr: 13.87645 batch_time=1.36194 
Train Epoch: 28 [65/125 16640/32000 (52%)] Loss: 1.90050 (QuantReg: 14.02612) QuantErr: 14.02612 batch_time=2.21835 
Train Epoch: 28 [81/125 20736/32000 (65%)] Loss: 1.74419 (QuantReg: 13.97680) QuantErr: 13.97680 batch_time=3.36731 
Train Epoch: 28 [97/125 24832/32000 (78%)] Loss: 1.68866 (QuantReg: 13.94953) QuantErr: 13.94953 batch_time=0.75533 
Train Epoch: 28 [113/125 28928/32000 (90%)] Loss: 1.68399 (QuantReg: 13.87447) QuantErr: 13.87447 batch_time=1.35924 
Train Epoch: 28 codebook_update_time=1.70236
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch28.pth ...
Done in 3.867s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch28.pth ...
Done in 7.630s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 28
 loss           : 1.8813537731170655
 quant_reg      : 13.902155166625976
 quant_err      : 13.902155166625976
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 3500
 MSRVTT_miech_test/t2v_metrics/R1: 22.1
 MSRVTT_miech_test/t2v_metrics/R5: 49.8
 MSRVTT_miech_test/t2v_metrics/R10: 64.8
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.261
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.46982545504044
 MSRVTT_miech_test/v2t_metrics/R1: 22.0
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.641
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.153932493528686
 mnt_best       : 41.46982545504044
 not_improved_count: 0
Train Epoch: 29 [1/125 256/32000 (1%)] Loss: 2.00409 (QuantReg: 13.83938) QuantErr: 13.83938 batch_time=40.01691 
Train Epoch: 29 [17/125 4352/32000 (14%)] Loss: 1.72393 (QuantReg: 13.91819) QuantErr: 13.91819 batch_time=0.79136 
Train Epoch: 29 [33/125 8448/32000 (26%)] Loss: 1.92926 (QuantReg: 13.92019) QuantErr: 13.92019 batch_time=0.78291 
Train Epoch: 29 [49/125 12544/32000 (39%)] Loss: 2.04427 (QuantReg: 13.88315) QuantErr: 13.88315 batch_time=0.80220 
Train Epoch: 29 [65/125 16640/32000 (52%)] Loss: 1.59508 (QuantReg: 13.97181) QuantErr: 13.97181 batch_time=3.16493 
Train Epoch: 29 [81/125 20736/32000 (65%)] Loss: 1.97558 (QuantReg: 13.92773) QuantErr: 13.92773 batch_time=0.73222 
Train Epoch: 29 [97/125 24832/32000 (78%)] Loss: 1.67477 (QuantReg: 13.81809) QuantErr: 13.81809 batch_time=0.75326 
Train Epoch: 29 [113/125 28928/32000 (90%)] Loss: 1.86880 (QuantReg: 13.77865) QuantErr: 13.77865 batch_time=0.73200 
Train Epoch: 29 codebook_update_time=1.66223
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch29.pth ...
Done in 3.967s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 29
 loss           : 1.876551070213318
 quant_reg      : 13.949544204711914
 quant_err      : 13.949544204711914
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 3625
 MSRVTT_miech_test/t2v_metrics/R1: 21.8
 MSRVTT_miech_test/t2v_metrics/R5: 50.3
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.647
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.14016867605926
 MSRVTT_miech_test/v2t_metrics/R1: 20.0
 MSRVTT_miech_test/v2t_metrics/R5: 52.1
 MSRVTT_miech_test/v2t_metrics/R10: 67.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.906
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.19679335334501
 mnt_best       : 41.46982545504044
 not_improved_count: 1
Train Epoch: 30 [1/125 256/32000 (1%)] Loss: 1.52460 (QuantReg: 13.85256) QuantErr: 13.85256 batch_time=37.54956 
Train Epoch: 30 [17/125 4352/32000 (14%)] Loss: 2.03991 (QuantReg: 13.80516) QuantErr: 13.80516 batch_time=9.46250 
Train Epoch: 30 [33/125 8448/32000 (26%)] Loss: 1.93935 (QuantReg: 13.92272) QuantErr: 13.92272 batch_time=0.71616 
Train Epoch: 30 [49/125 12544/32000 (39%)] Loss: 1.85162 (QuantReg: 13.88108) QuantErr: 13.88108 batch_time=0.74538 
Train Epoch: 30 [65/125 16640/32000 (52%)] Loss: 2.12174 (QuantReg: 13.91246) QuantErr: 13.91246 batch_time=2.87382 
Train Epoch: 30 [81/125 20736/32000 (65%)] Loss: 1.95589 (QuantReg: 13.86082) QuantErr: 13.86082 batch_time=6.93033 
Train Epoch: 30 [97/125 24832/32000 (78%)] Loss: 1.69631 (QuantReg: 13.92969) QuantErr: 13.92969 batch_time=0.71598 
Train Epoch: 30 [113/125 28928/32000 (90%)] Loss: 1.70332 (QuantReg: 14.04370) QuantErr: 14.04370 batch_time=0.74257 
Train Epoch: 30 codebook_update_time=1.64013
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch30.pth ...
Done in 3.802s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 30
 loss           : 1.8812928667068483
 quant_reg      : 13.934415603637696
 quant_err      : 13.934415603637696
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 3750
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 49.7
 MSRVTT_miech_test/t2v_metrics/R10: 64.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.197
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.506036594474935
 MSRVTT_miech_test/v2t_metrics/R1: 20.7
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 66.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.119
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.54874033376968
 mnt_best       : 41.46982545504044
 not_improved_count: 2
Train Epoch: 31 [1/125 256/32000 (1%)] Loss: 1.67285 (QuantReg: 13.96023) QuantErr: 13.96023 batch_time=36.20626 
Train Epoch: 31 [17/125 4352/32000 (14%)] Loss: 2.10551 (QuantReg: 13.93295) QuantErr: 13.93295 batch_time=0.72226 
Train Epoch: 31 [33/125 8448/32000 (26%)] Loss: 1.87792 (QuantReg: 14.07087) QuantErr: 14.07087 batch_time=0.74466 
Train Epoch: 31 [49/125 12544/32000 (39%)] Loss: 1.61113 (QuantReg: 14.11443) QuantErr: 14.11443 batch_time=0.91961 
Train Epoch: 31 [65/125 16640/32000 (52%)] Loss: 1.92017 (QuantReg: 14.07368) QuantErr: 14.07368 batch_time=0.97799 
Train Epoch: 31 [81/125 20736/32000 (65%)] Loss: 1.77731 (QuantReg: 14.04347) QuantErr: 14.04347 batch_time=0.74963 
Train Epoch: 31 [97/125 24832/32000 (78%)] Loss: 1.75197 (QuantReg: 13.69993) QuantErr: 13.69993 batch_time=0.81112 
Train Epoch: 31 [113/125 28928/32000 (90%)] Loss: 1.83836 (QuantReg: 13.82937) QuantErr: 13.82937 batch_time=0.73585 
Train Epoch: 31 codebook_update_time=1.71217
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch31.pth ...
Done in 3.858s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 31
 loss           : 1.84755828666687
 quant_reg      : 13.968099151611328
 quant_err      : 13.968099151611328
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 3875
 MSRVTT_miech_test/t2v_metrics/R1: 20.5
 MSRVTT_miech_test/t2v_metrics/R5: 49.3
 MSRVTT_miech_test/t2v_metrics/R10: 64.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.697
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.30806300544061
 MSRVTT_miech_test/v2t_metrics/R1: 19.5
 MSRVTT_miech_test/v2t_metrics/R5: 52.4
 MSRVTT_miech_test/v2t_metrics/R10: 66.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.7
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.888138469258415
 mnt_best       : 41.46982545504044
 not_improved_count: 3
Train Epoch: 32 [1/125 256/32000 (1%)] Loss: 1.46502 (QuantReg: 14.12635) QuantErr: 14.12635 batch_time=35.85545 
Train Epoch: 32 [17/125 4352/32000 (14%)] Loss: 1.76961 (QuantReg: 14.14546) QuantErr: 14.14546 batch_time=0.75343 
Train Epoch: 32 [33/125 8448/32000 (26%)] Loss: 1.64643 (QuantReg: 14.06389) QuantErr: 14.06389 batch_time=0.74829 
Train Epoch: 32 [49/125 12544/32000 (39%)] Loss: 1.65827 (QuantReg: 13.90440) QuantErr: 13.90440 batch_time=0.75480 
Train Epoch: 32 [65/125 16640/32000 (52%)] Loss: 1.71678 (QuantReg: 13.96610) QuantErr: 13.96610 batch_time=1.90205 
Train Epoch: 32 [81/125 20736/32000 (65%)] Loss: 1.96343 (QuantReg: 14.09446) QuantErr: 14.09446 batch_time=0.74171 
Train Epoch: 32 [97/125 24832/32000 (78%)] Loss: 1.78866 (QuantReg: 14.06131) QuantErr: 14.06131 batch_time=0.74295 
Train Epoch: 32 [113/125 28928/32000 (90%)] Loss: 1.70499 (QuantReg: 14.02260) QuantErr: 14.02260 batch_time=0.74926 
Train Epoch: 32 codebook_update_time=1.64093
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch32.pth ...
Done in 8.317s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch32.pth ...
Done in 12.178s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 32
 loss           : 1.817382050514221
 quant_reg      : 13.998808128356934
 quant_err      : 13.998808128356934
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 4000
 MSRVTT_miech_test/t2v_metrics/R1: 22.5
 MSRVTT_miech_test/t2v_metrics/R5: 50.2
 MSRVTT_miech_test/t2v_metrics/R10: 63.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.96
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.61363350602879
 MSRVTT_miech_test/v2t_metrics/R1: 21.3
 MSRVTT_miech_test/v2t_metrics/R5: 52.4
 MSRVTT_miech_test/v2t_metrics/R10: 65.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.497
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.89852828508681
 mnt_best       : 41.61363350602879
 not_improved_count: 0
Train Epoch: 33 [1/125 256/32000 (1%)] Loss: 1.70380 (QuantReg: 14.12831) QuantErr: 14.12831 batch_time=34.44672 
Train Epoch: 33 [17/125 4352/32000 (14%)] Loss: 1.68271 (QuantReg: 14.09746) QuantErr: 14.09746 batch_time=0.75122 
Train Epoch: 33 [33/125 8448/32000 (26%)] Loss: 1.74941 (QuantReg: 14.31302) QuantErr: 14.31302 batch_time=0.74153 
Train Epoch: 33 [49/125 12544/32000 (39%)] Loss: 2.10962 (QuantReg: 14.17494) QuantErr: 14.17494 batch_time=0.75383 
Train Epoch: 33 [65/125 16640/32000 (52%)] Loss: 1.70714 (QuantReg: 14.28580) QuantErr: 14.28580 batch_time=1.47184 
Train Epoch: 33 [81/125 20736/32000 (65%)] Loss: 2.26115 (QuantReg: 13.93803) QuantErr: 13.93803 batch_time=0.78106 
Train Epoch: 33 [97/125 24832/32000 (78%)] Loss: 1.66053 (QuantReg: 14.03479) QuantErr: 14.03479 batch_time=0.74338 
Train Epoch: 33 [113/125 28928/32000 (90%)] Loss: 1.84784 (QuantReg: 14.41203) QuantErr: 14.41203 batch_time=0.72767 
Train Epoch: 33 codebook_update_time=1.72069
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch33.pth ...
Done in 3.827s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 33
 loss           : 1.8316670780181885
 quant_reg      : 14.02614720916748
 quant_err      : 14.02614720916748
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 4125
 MSRVTT_miech_test/t2v_metrics/R1: 21.4
 MSRVTT_miech_test/t2v_metrics/R5: 49.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.007000000000005
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.97007215122773
 MSRVTT_miech_test/v2t_metrics/R1: 21.2
 MSRVTT_miech_test/v2t_metrics/R5: 52.0
 MSRVTT_miech_test/v2t_metrics/R10: 66.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.811
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.74723468841782
 mnt_best       : 41.61363350602879
 not_improved_count: 1
Train Epoch: 34 [1/125 256/32000 (1%)] Loss: 2.01728 (QuantReg: 14.01779) QuantErr: 14.01779 batch_time=34.99804 
Train Epoch: 34 [17/125 4352/32000 (14%)] Loss: 1.81882 (QuantReg: 13.98811) QuantErr: 13.98811 batch_time=0.76297 
Train Epoch: 34 [33/125 8448/32000 (26%)] Loss: 2.12270 (QuantReg: 14.09608) QuantErr: 14.09608 batch_time=0.75692 
Train Epoch: 34 [49/125 12544/32000 (39%)] Loss: 1.72128 (QuantReg: 13.90781) QuantErr: 13.90781 batch_time=0.76478 
Train Epoch: 34 [65/125 16640/32000 (52%)] Loss: 1.67139 (QuantReg: 14.15375) QuantErr: 14.15375 batch_time=3.38198 
Train Epoch: 34 [81/125 20736/32000 (65%)] Loss: 1.74381 (QuantReg: 14.12587) QuantErr: 14.12587 batch_time=0.78461 
Train Epoch: 34 [97/125 24832/32000 (78%)] Loss: 1.56109 (QuantReg: 14.09221) QuantErr: 14.09221 batch_time=0.74246 
Train Epoch: 34 [113/125 28928/32000 (90%)] Loss: 1.85623 (QuantReg: 14.12426) QuantErr: 14.12426 batch_time=0.76029 
Train Epoch: 34 codebook_update_time=1.66006
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch34.pth ...
Done in 6.189s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 34
 loss           : 1.807036057472229
 quant_reg      : 14.035761054992676
 quant_err      : 14.035761054992676
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 4250
 MSRVTT_miech_test/t2v_metrics/R1: 21.3
 MSRVTT_miech_test/t2v_metrics/R5: 50.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.831
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.89703152555946
 MSRVTT_miech_test/v2t_metrics/R1: 21.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.7
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.356
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.69001135195118
 mnt_best       : 41.61363350602879
 not_improved_count: 2
Train Epoch: 35 [1/125 256/32000 (1%)] Loss: 1.79156 (QuantReg: 14.24554) QuantErr: 14.24554 batch_time=43.25918 
Train Epoch: 35 [17/125 4352/32000 (14%)] Loss: 1.89320 (QuantReg: 13.96793) QuantErr: 13.96793 batch_time=0.75196 
Train Epoch: 35 [33/125 8448/32000 (26%)] Loss: 2.13105 (QuantReg: 14.14157) QuantErr: 14.14157 batch_time=0.73793 
Train Epoch: 35 [49/125 12544/32000 (39%)] Loss: 1.51320 (QuantReg: 14.09733) QuantErr: 14.09733 batch_time=0.75284 
Train Epoch: 35 [65/125 16640/32000 (52%)] Loss: 1.59645 (QuantReg: 14.21612) QuantErr: 14.21612 batch_time=8.40885 
Train Epoch: 35 [81/125 20736/32000 (65%)] Loss: 2.15670 (QuantReg: 13.87377) QuantErr: 13.87377 batch_time=0.75181 
Train Epoch: 35 [97/125 24832/32000 (78%)] Loss: 1.65842 (QuantReg: 13.89367) QuantErr: 13.89367 batch_time=0.74961 
Train Epoch: 35 [113/125 28928/32000 (90%)] Loss: 1.77356 (QuantReg: 14.13844) QuantErr: 14.13844 batch_time=0.76024 
Train Epoch: 35 codebook_update_time=1.59133
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch35.pth ...
Done in 10.514s
removing stale ckpt [epoch 35] [took 0.03s]
 epoch          : 35
 loss           : 1.790861623764038
 quant_reg      : 14.0331830368042
 quant_err      : 14.0331830368042
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 4375
 MSRVTT_miech_test/t2v_metrics/R1: 21.0
 MSRVTT_miech_test/t2v_metrics/R5: 49.1
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.547
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.30492995287082
 MSRVTT_miech_test/v2t_metrics/R1: 20.9
 MSRVTT_miech_test/v2t_metrics/R5: 51.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.297
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.36209511040778
 mnt_best       : 41.61363350602879
 not_improved_count: 3
Train Epoch: 36 [1/125 256/32000 (1%)] Loss: 2.08042 (QuantReg: 14.01035) QuantErr: 14.01035 batch_time=50.77614 
Train Epoch: 36 [17/125 4352/32000 (14%)] Loss: 1.78133 (QuantReg: 14.07295) QuantErr: 14.07295 batch_time=0.75161 
Train Epoch: 36 [33/125 8448/32000 (26%)] Loss: 1.76786 (QuantReg: 14.28931) QuantErr: 14.28931 batch_time=0.75997 
Train Epoch: 36 [49/125 12544/32000 (39%)] Loss: 1.95260 (QuantReg: 14.12755) QuantErr: 14.12755 batch_time=0.72084 
Train Epoch: 36 [65/125 16640/32000 (52%)] Loss: 1.92279 (QuantReg: 14.08063) QuantErr: 14.08063 batch_time=10.96688 
Train Epoch: 36 [81/125 20736/32000 (65%)] Loss: 1.85673 (QuantReg: 14.12083) QuantErr: 14.12083 batch_time=0.76153 
Train Epoch: 36 [97/125 24832/32000 (78%)] Loss: 1.93709 (QuantReg: 14.18432) QuantErr: 14.18432 batch_time=0.75654 
Train Epoch: 36 [113/125 28928/32000 (90%)] Loss: 1.97645 (QuantReg: 13.97758) QuantErr: 13.97758 batch_time=0.74178 
Train Epoch: 36 codebook_update_time=2.10532
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch36.pth ...
Done in 4.887s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 36
 loss           : 1.8139700288772582
 quant_reg      : 14.054937995910645
 quant_err      : 14.054937995910645
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 4500
 MSRVTT_miech_test/t2v_metrics/R1: 21.1
 MSRVTT_miech_test/t2v_metrics/R5: 50.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.715
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.86820659138844
 MSRVTT_miech_test/v2t_metrics/R1: 21.9
 MSRVTT_miech_test/v2t_metrics/R5: 51.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.253
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.07508507518044
 mnt_best       : 41.61363350602879
 not_improved_count: 4
Train Epoch: 37 [1/125 256/32000 (1%)] Loss: 1.83883 (QuantReg: 14.05977) QuantErr: 14.05977 batch_time=48.51850 
Train Epoch: 37 [17/125 4352/32000 (14%)] Loss: 1.87224 (QuantReg: 13.97778) QuantErr: 13.97778 batch_time=0.75532 
Train Epoch: 37 [33/125 8448/32000 (26%)] Loss: 1.76696 (QuantReg: 14.03693) QuantErr: 14.03693 batch_time=0.84407 
Train Epoch: 37 [49/125 12544/32000 (39%)] Loss: 1.90752 (QuantReg: 13.95251) QuantErr: 13.95251 batch_time=0.73190 
Train Epoch: 37 [65/125 16640/32000 (52%)] Loss: 1.71051 (QuantReg: 14.06761) QuantErr: 14.06761 batch_time=10.36643 
Train Epoch: 37 [81/125 20736/32000 (65%)] Loss: 1.67085 (QuantReg: 14.04964) QuantErr: 14.04964 batch_time=0.87114 
Train Epoch: 37 [97/125 24832/32000 (78%)] Loss: 1.72867 (QuantReg: 14.00628) QuantErr: 14.00628 batch_time=0.74289 
Train Epoch: 37 [113/125 28928/32000 (90%)] Loss: 1.76841 (QuantReg: 14.31653) QuantErr: 14.31653 batch_time=0.85916 
Train Epoch: 37 codebook_update_time=1.61446
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch37.pth ...
Done in 3.953s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 37
 loss           : 1.817184226989746
 quant_reg      : 14.064419616699219
 quant_err      : 14.064419616699219
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 4625
 MSRVTT_miech_test/t2v_metrics/R1: 21.6
 MSRVTT_miech_test/t2v_metrics/R5: 50.4
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.328
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.14857063510429
 MSRVTT_miech_test/v2t_metrics/R1: 22.0
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 65.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.297
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.23433636185221
 mnt_best       : 41.61363350602879
 not_improved_count: 5
Train Epoch: 38 [1/125 256/32000 (1%)] Loss: 1.90745 (QuantReg: 13.98405) QuantErr: 13.98405 batch_time=46.05452 
Train Epoch: 38 [17/125 4352/32000 (14%)] Loss: 1.94838 (QuantReg: 14.11310) QuantErr: 14.11310 batch_time=0.75070 
Train Epoch: 38 [33/125 8448/32000 (26%)] Loss: 1.70947 (QuantReg: 13.98315) QuantErr: 13.98315 batch_time=0.75599 
Train Epoch: 38 [49/125 12544/32000 (39%)] Loss: 1.89200 (QuantReg: 13.98918) QuantErr: 13.98918 batch_time=0.75121 
Train Epoch: 38 [65/125 16640/32000 (52%)] Loss: 1.77923 (QuantReg: 13.98251) QuantErr: 13.98251 batch_time=6.01817 
Train Epoch: 38 [81/125 20736/32000 (65%)] Loss: 1.76038 (QuantReg: 14.25813) QuantErr: 14.25813 batch_time=0.75693 
Train Epoch: 38 [97/125 24832/32000 (78%)] Loss: 1.87343 (QuantReg: 13.92689) QuantErr: 13.92689 batch_time=0.75635 
Train Epoch: 38 [113/125 28928/32000 (90%)] Loss: 1.86322 (QuantReg: 14.07535) QuantErr: 14.07535 batch_time=0.83833 
Train Epoch: 38 codebook_update_time=1.65365
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch38.pth ...
Done in 4.790s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 38
 loss           : 1.8163607940673827
 quant_reg      : 14.077967887878417
 quant_err      : 14.077967887878417
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 4750
 MSRVTT_miech_test/t2v_metrics/R1: 22.0
 MSRVTT_miech_test/t2v_metrics/R5: 49.4
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.391999999999996
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.12537470056445
 MSRVTT_miech_test/v2t_metrics/R1: 21.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.778
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.315188281889945
 mnt_best       : 41.61363350602879
 not_improved_count: 6
Train Epoch: 39 [1/125 256/32000 (1%)] Loss: 1.79005 (QuantReg: 14.05831) QuantErr: 14.05831 batch_time=34.62909 
Train Epoch: 39 [17/125 4352/32000 (14%)] Loss: 1.81345 (QuantReg: 13.91510) QuantErr: 13.91510 batch_time=3.63260 
Train Epoch: 39 [33/125 8448/32000 (26%)] Loss: 2.06003 (QuantReg: 13.97453) QuantErr: 13.97453 batch_time=0.78300 
Train Epoch: 39 [49/125 12544/32000 (39%)] Loss: 1.89627 (QuantReg: 14.13197) QuantErr: 14.13197 batch_time=0.75013 
Train Epoch: 39 [65/125 16640/32000 (52%)] Loss: 1.92104 (QuantReg: 14.26957) QuantErr: 14.26957 batch_time=0.74605 
Train Epoch: 39 [81/125 20736/32000 (65%)] Loss: 1.70162 (QuantReg: 13.92778) QuantErr: 13.92778 batch_time=3.53250 
Train Epoch: 39 [97/125 24832/32000 (78%)] Loss: 1.88150 (QuantReg: 14.05924) QuantErr: 14.05924 batch_time=0.88130 
Train Epoch: 39 [113/125 28928/32000 (90%)] Loss: 1.86115 (QuantReg: 14.10732) QuantErr: 14.10732 batch_time=0.74261 
Train Epoch: 39 codebook_update_time=1.76502
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch39.pth ...
Done in 3.865s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 39
 loss           : 1.768370400428772
 quant_reg      : 14.108706695556641
 quant_err      : 14.108706695556641
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 4875
 MSRVTT_miech_test/t2v_metrics/R1: 21.2
 MSRVTT_miech_test/t2v_metrics/R5: 49.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.194
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.71152251396172
 MSRVTT_miech_test/v2t_metrics/R1: 21.0
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.057
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.4636561860629
 mnt_best       : 41.61363350602879
 not_improved_count: 7
Train Epoch: 40 [1/125 256/32000 (1%)] Loss: 1.55990 (QuantReg: 14.18492) QuantErr: 14.18492 batch_time=50.56500 
Train Epoch: 40 [17/125 4352/32000 (14%)] Loss: 1.83301 (QuantReg: 14.10078) QuantErr: 14.10078 batch_time=0.75135 
Train Epoch: 40 [33/125 8448/32000 (26%)] Loss: 1.65616 (QuantReg: 14.06171) QuantErr: 14.06171 batch_time=0.75159 
Train Epoch: 40 [49/125 12544/32000 (39%)] Loss: 1.81803 (QuantReg: 13.93269) QuantErr: 13.93269 batch_time=0.72341 
Train Epoch: 40 [65/125 16640/32000 (52%)] Loss: 1.62472 (QuantReg: 14.17372) QuantErr: 14.17372 batch_time=10.19795 
Train Epoch: 40 [81/125 20736/32000 (65%)] Loss: 1.71708 (QuantReg: 14.14479) QuantErr: 14.14479 batch_time=0.77546 
Train Epoch: 40 [97/125 24832/32000 (78%)] Loss: 1.85770 (QuantReg: 14.20708) QuantErr: 14.20708 batch_time=0.77997 
Train Epoch: 40 [113/125 28928/32000 (90%)] Loss: 1.58531 (QuantReg: 14.17235) QuantErr: 14.17235 batch_time=0.75185 
Train Epoch: 40 codebook_update_time=2.02281
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch40.pth ...
Done in 4.231s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 40
 loss           : 1.7820718250274659
 quant_reg      : 14.099824920654298
 quant_err      : 14.099824920654298
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 5000
 MSRVTT_miech_test/t2v_metrics/R1: 21.0
 MSRVTT_miech_test/t2v_metrics/R5: 50.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.760999999999996
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.746408154436764
 MSRVTT_miech_test/v2t_metrics/R1: 21.6
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.464
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.12558330544452
 mnt_best       : 41.61363350602879
 not_improved_count: 8
Train Epoch: 41 [1/125 256/32000 (1%)] Loss: 1.79958 (QuantReg: 14.14389) QuantErr: 14.14389 batch_time=35.03003 
Train Epoch: 41 [17/125 4352/32000 (14%)] Loss: 1.82215 (QuantReg: 14.24684) QuantErr: 14.24684 batch_time=6.30441 
Train Epoch: 41 [33/125 8448/32000 (26%)] Loss: 1.76332 (QuantReg: 14.26285) QuantErr: 14.26285 batch_time=1.24754 
Train Epoch: 41 [49/125 12544/32000 (39%)] Loss: 1.82818 (QuantReg: 14.11870) QuantErr: 14.11870 batch_time=0.76064 
Train Epoch: 41 [65/125 16640/32000 (52%)] Loss: 1.90575 (QuantReg: 14.07747) QuantErr: 14.07747 batch_time=0.96654 
Train Epoch: 41 [81/125 20736/32000 (65%)] Loss: 2.06596 (QuantReg: 13.94547) QuantErr: 13.94547 batch_time=4.87967 
Train Epoch: 41 [97/125 24832/32000 (78%)] Loss: 1.72418 (QuantReg: 14.22459) QuantErr: 14.22459 batch_time=1.23757 
Train Epoch: 41 [113/125 28928/32000 (90%)] Loss: 1.76330 (QuantReg: 14.13008) QuantErr: 14.13008 batch_time=0.74973 
Train Epoch: 41 codebook_update_time=1.77590
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch41.pth ...
Done in 3.769s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 41
 loss           : 1.788570071220398
 quant_reg      : 14.141083534240723
 quant_err      : 14.141083534240723
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 5125
 MSRVTT_miech_test/t2v_metrics/R1: 21.0
 MSRVTT_miech_test/t2v_metrics/R5: 50.7
 MSRVTT_miech_test/t2v_metrics/R10: 64.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.751000000000005
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.03527204634054
 MSRVTT_miech_test/v2t_metrics/R1: 21.5
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 65.3
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.531
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.847936504073104
 mnt_best       : 41.61363350602879
 not_improved_count: 9
Train Epoch: 42 [1/125 256/32000 (1%)] Loss: 1.86712 (QuantReg: 14.06198) QuantErr: 14.06198 batch_time=39.35067 
Train Epoch: 42 [17/125 4352/32000 (14%)] Loss: 2.00570 (QuantReg: 14.24209) QuantErr: 14.24209 batch_time=0.85431 
Train Epoch: 42 [33/125 8448/32000 (26%)] Loss: 1.61753 (QuantReg: 14.14893) QuantErr: 14.14893 batch_time=0.74364 
Train Epoch: 42 [49/125 12544/32000 (39%)] Loss: 1.84762 (QuantReg: 14.15886) QuantErr: 14.15886 batch_time=0.75446 
Train Epoch: 42 [65/125 16640/32000 (52%)] Loss: 1.76882 (QuantReg: 14.15434) QuantErr: 14.15434 batch_time=3.53805 
Train Epoch: 42 [81/125 20736/32000 (65%)] Loss: 1.69499 (QuantReg: 14.12306) QuantErr: 14.12306 batch_time=0.76325 
Train Epoch: 42 [97/125 24832/32000 (78%)] Loss: 1.59135 (QuantReg: 14.28879) QuantErr: 14.28879 batch_time=0.75704 
Train Epoch: 42 [113/125 28928/32000 (90%)] Loss: 1.86684 (QuantReg: 14.14407) QuantErr: 14.14407 batch_time=0.89510 
Train Epoch: 42 codebook_update_time=1.61287
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch42.pth ...
Done in 4.082s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 42
 loss           : 1.7763202447891235
 quant_reg      : 14.163397918701172
 quant_err      : 14.163397918701172
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 5250
 MSRVTT_miech_test/t2v_metrics/R1: 21.2
 MSRVTT_miech_test/t2v_metrics/R5: 50.3
 MSRVTT_miech_test/t2v_metrics/R10: 65.0
 MSRVTT_miech_test/t2v_metrics/R50: 86.9
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.702
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.07766362087769
 MSRVTT_miech_test/v2t_metrics/R1: 21.4
 MSRVTT_miech_test/v2t_metrics/R5: 53.0
 MSRVTT_miech_test/v2t_metrics/R10: 66.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.512
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.29332460464184
 mnt_best       : 41.61363350602879
 not_improved_count: 10
Train Epoch: 43 [1/125 256/32000 (1%)] Loss: 1.73507 (QuantReg: 14.09489) QuantErr: 14.09489 batch_time=37.09247 
Train Epoch: 43 [17/125 4352/32000 (14%)] Loss: 1.79414 (QuantReg: 14.17270) QuantErr: 14.17270 batch_time=2.72328 
Train Epoch: 43 [33/125 8448/32000 (26%)] Loss: 1.79131 (QuantReg: 14.08266) QuantErr: 14.08266 batch_time=0.74605 
Train Epoch: 43 [49/125 12544/32000 (39%)] Loss: 1.59809 (QuantReg: 14.30789) QuantErr: 14.30789 batch_time=0.75392 
Train Epoch: 43 [65/125 16640/32000 (52%)] Loss: 1.63722 (QuantReg: 14.15123) QuantErr: 14.15123 batch_time=1.01462 
Train Epoch: 43 [81/125 20736/32000 (65%)] Loss: 1.83029 (QuantReg: 14.21921) QuantErr: 14.21921 batch_time=2.11302 
Train Epoch: 43 [97/125 24832/32000 (78%)] Loss: 2.01140 (QuantReg: 14.08676) QuantErr: 14.08676 batch_time=0.75754 
Train Epoch: 43 [113/125 28928/32000 (90%)] Loss: 1.95403 (QuantReg: 14.15527) QuantErr: 14.15527 batch_time=0.78148 
Train Epoch: 43 codebook_update_time=1.59929
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch43.pth ...
Done in 4.015s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 43
 loss           : 1.7914953279495238
 quant_reg      : 14.152817420959472
 quant_err      : 14.152817420959472
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 5375
 MSRVTT_miech_test/t2v_metrics/R1: 21.3
 MSRVTT_miech_test/t2v_metrics/R5: 51.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 86.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.721
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.16734361212235
 MSRVTT_miech_test/v2t_metrics/R1: 21.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 66.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.196
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.44322291474214
 mnt_best       : 41.61363350602879
 not_improved_count: 11
Train Epoch: 44 [1/125 256/32000 (1%)] Loss: 1.77114 (QuantReg: 14.39801) QuantErr: 14.39801 batch_time=49.52392 
Train Epoch: 44 [17/125 4352/32000 (14%)] Loss: 2.00707 (QuantReg: 13.88565) QuantErr: 13.88565 batch_time=0.75234 
Train Epoch: 44 [33/125 8448/32000 (26%)] Loss: 1.49152 (QuantReg: 14.30873) QuantErr: 14.30873 batch_time=0.75512 
Train Epoch: 44 [49/125 12544/32000 (39%)] Loss: 1.93774 (QuantReg: 14.05546) QuantErr: 14.05546 batch_time=0.72746 
Train Epoch: 44 [65/125 16640/32000 (52%)] Loss: 1.75815 (QuantReg: 14.26670) QuantErr: 14.26670 batch_time=9.56235 
Train Epoch: 44 [81/125 20736/32000 (65%)] Loss: 1.77261 (QuantReg: 14.34254) QuantErr: 14.34254 batch_time=0.75194 
Train Epoch: 44 [97/125 24832/32000 (78%)] Loss: 1.83468 (QuantReg: 14.02307) QuantErr: 14.02307 batch_time=0.73840 
Train Epoch: 44 [113/125 28928/32000 (90%)] Loss: 1.90175 (QuantReg: 14.06108) QuantErr: 14.06108 batch_time=0.75391 
Train Epoch: 44 codebook_update_time=1.65016
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch44.pth ...
Done in 4.394s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 44
 loss           : 1.7803328285217286
 quant_reg      : 14.168563652038575
 quant_err      : 14.168563652038575
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 5500
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 50.8
 MSRVTT_miech_test/t2v_metrics/R10: 64.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.52
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.870221407969645
 MSRVTT_miech_test/v2t_metrics/R1: 21.0
 MSRVTT_miech_test/v2t_metrics/R5: 53.0
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.439
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.83826688832655
 mnt_best       : 41.61363350602879
 not_improved_count: 12
Train Epoch: 45 [1/125 256/32000 (1%)] Loss: 1.78438 (QuantReg: 14.18938) QuantErr: 14.18938 batch_time=36.37950 
Train Epoch: 45 [17/125 4352/32000 (14%)] Loss: 2.05694 (QuantReg: 14.01934) QuantErr: 14.01934 batch_time=0.75044 
Train Epoch: 45 [33/125 8448/32000 (26%)] Loss: 1.78561 (QuantReg: 14.17466) QuantErr: 14.17466 batch_time=0.71467 
Train Epoch: 45 [49/125 12544/32000 (39%)] Loss: 1.50691 (QuantReg: 14.33343) QuantErr: 14.33343 batch_time=0.80244 
Train Epoch: 45 [65/125 16640/32000 (52%)] Loss: 1.91215 (QuantReg: 14.17099) QuantErr: 14.17099 batch_time=1.00513 
Train Epoch: 45 [81/125 20736/32000 (65%)] Loss: 1.90747 (QuantReg: 13.99431) QuantErr: 13.99431 batch_time=0.72105 
Train Epoch: 45 [97/125 24832/32000 (78%)] Loss: 1.80467 (QuantReg: 14.31609) QuantErr: 14.31609 batch_time=0.76244 
Train Epoch: 45 [113/125 28928/32000 (90%)] Loss: 1.59612 (QuantReg: 14.35716) QuantErr: 14.35716 batch_time=0.74834 
Train Epoch: 45 codebook_update_time=1.61892
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch45.pth ...
Done in 4.443s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 45
 loss           : 1.7642070865631103
 quant_reg      : 14.179806816101074
 quant_err      : 14.179806816101074
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 5625
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 49.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.371
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.49475438843606
 MSRVTT_miech_test/v2t_metrics/R1: 21.0
 MSRVTT_miech_test/v2t_metrics/R5: 52.9
 MSRVTT_miech_test/v2t_metrics/R10: 67.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.286
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.08550042974394
 mnt_best       : 41.61363350602879
 not_improved_count: 13
Train Epoch: 46 [1/125 256/32000 (1%)] Loss: 1.89548 (QuantReg: 13.95144) QuantErr: 13.95144 batch_time=49.44130 
Train Epoch: 46 [17/125 4352/32000 (14%)] Loss: 1.63839 (QuantReg: 14.27297) QuantErr: 14.27297 batch_time=0.76070 
Train Epoch: 46 [33/125 8448/32000 (26%)] Loss: 1.71896 (QuantReg: 14.23740) QuantErr: 14.23740 batch_time=0.74303 
Train Epoch: 46 [49/125 12544/32000 (39%)] Loss: 1.79736 (QuantReg: 14.28667) QuantErr: 14.28667 batch_time=0.72971 
Train Epoch: 46 [65/125 16640/32000 (52%)] Loss: 2.16198 (QuantReg: 13.99021) QuantErr: 13.99021 batch_time=8.64832 
Train Epoch: 46 [81/125 20736/32000 (65%)] Loss: 2.08766 (QuantReg: 14.11431) QuantErr: 14.11431 batch_time=0.76432 
Train Epoch: 46 [97/125 24832/32000 (78%)] Loss: 1.52564 (QuantReg: 14.24742) QuantErr: 14.24742 batch_time=0.75251 
Train Epoch: 46 [113/125 28928/32000 (90%)] Loss: 1.61491 (QuantReg: 14.24244) QuantErr: 14.24244 batch_time=0.85509 
Train Epoch: 46 codebook_update_time=1.78097
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch46.pth ...
Done in 3.892s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 46
 loss           : 1.7847582368850707
 quant_reg      : 14.190847702026367
 quant_err      : 14.190847702026367
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 5750
 MSRVTT_miech_test/t2v_metrics/R1: 21.7
 MSRVTT_miech_test/t2v_metrics/R5: 50.6
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 86.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.226
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.15866931652824
 MSRVTT_miech_test/v2t_metrics/R1: 21.1
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.663
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.782574981099295
 mnt_best       : 41.61363350602879
 not_improved_count: 14
Train Epoch: 47 [1/125 256/32000 (1%)] Loss: 1.63699 (QuantReg: 14.07568) QuantErr: 14.07568 batch_time=42.93678 
Train Epoch: 47 [17/125 4352/32000 (14%)] Loss: 1.64213 (QuantReg: 14.31191) QuantErr: 14.31191 batch_time=11.50447 
Train Epoch: 47 [33/125 8448/32000 (26%)] Loss: 1.87677 (QuantReg: 14.18007) QuantErr: 14.18007 batch_time=0.76073 
Train Epoch: 47 [49/125 12544/32000 (39%)] Loss: 1.74757 (QuantReg: 14.22273) QuantErr: 14.22273 batch_time=0.77720 
Train Epoch: 47 [65/125 16640/32000 (52%)] Loss: 1.69636 (QuantReg: 14.16077) QuantErr: 14.16077 batch_time=5.84885 
Train Epoch: 47 [81/125 20736/32000 (65%)] Loss: 1.65208 (QuantReg: 14.17606) QuantErr: 14.17606 batch_time=9.85965 
Train Epoch: 47 [97/125 24832/32000 (78%)] Loss: 1.79254 (QuantReg: 14.22894) QuantErr: 14.22894 batch_time=0.85234 
Train Epoch: 47 [113/125 28928/32000 (90%)] Loss: 1.78373 (QuantReg: 14.23293) QuantErr: 14.23293 batch_time=0.76889 
Train Epoch: 47 codebook_update_time=1.64192
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch47.pth ...
Done in 6.885s
removing stale ckpt [epoch 47] [took 0.02s]
 epoch          : 47
 loss           : 1.7784161520004274
 quant_reg      : 14.218562980651855
 quant_err      : 14.218562980651855
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 5875
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 50.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.6
 MSRVTT_miech_test/t2v_metrics/R50: 86.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.623
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.656318905618605
 MSRVTT_miech_test/v2t_metrics/R1: 22.0
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 87.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.355
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.46506933764173
 mnt_best       : 41.61363350602879
 not_improved_count: 15
Train Epoch: 48 [1/125 256/32000 (1%)] Loss: 1.79600 (QuantReg: 14.18199) QuantErr: 14.18199 batch_time=35.75083 
Train Epoch: 48 [17/125 4352/32000 (14%)] Loss: 1.69180 (QuantReg: 14.40471) QuantErr: 14.40471 batch_time=0.85608 
Train Epoch: 48 [33/125 8448/32000 (26%)] Loss: 1.81701 (QuantReg: 14.32311) QuantErr: 14.32311 batch_time=0.75782 
Train Epoch: 48 [49/125 12544/32000 (39%)] Loss: 1.96984 (QuantReg: 14.24095) QuantErr: 14.24095 batch_time=0.75111 
Train Epoch: 48 [65/125 16640/32000 (52%)] Loss: 1.99334 (QuantReg: 14.24514) QuantErr: 14.24514 batch_time=1.21148 
Train Epoch: 48 [81/125 20736/32000 (65%)] Loss: 1.92883 (QuantReg: 13.99154) QuantErr: 13.99154 batch_time=0.74721 
Train Epoch: 48 [97/125 24832/32000 (78%)] Loss: 1.89186 (QuantReg: 14.13849) QuantErr: 14.13849 batch_time=0.76183 
Train Epoch: 48 [113/125 28928/32000 (90%)] Loss: 1.86253 (QuantReg: 14.16111) QuantErr: 14.16111 batch_time=0.73479 
Train Epoch: 48 codebook_update_time=1.83632
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch48.pth ...
Done in 12.426s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 48
 loss           : 1.786330514907837
 quant_reg      : 14.237420776367188
 quant_err      : 14.237420776367188
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 6000
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 50.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.4335
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.76808987688298
 MSRVTT_miech_test/v2t_metrics/R1: 21.5
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.8115
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.81115519219788
 mnt_best       : 41.61363350602879
 not_improved_count: 16
Train Epoch: 49 [1/125 256/32000 (1%)] Loss: 1.98355 (QuantReg: 14.37263) QuantErr: 14.37263 batch_time=34.64351 
Train Epoch: 49 [17/125 4352/32000 (14%)] Loss: 1.54950 (QuantReg: 14.22809) QuantErr: 14.22809 batch_time=0.75043 
Train Epoch: 49 [33/125 8448/32000 (26%)] Loss: 1.70592 (QuantReg: 14.21011) QuantErr: 14.21011 batch_time=0.77912 
Train Epoch: 49 [49/125 12544/32000 (39%)] Loss: 1.93136 (QuantReg: 14.16468) QuantErr: 14.16468 batch_time=1.37938 
Train Epoch: 49 [65/125 16640/32000 (52%)] Loss: 1.77886 (QuantReg: 14.34853) QuantErr: 14.34853 batch_time=1.78284 
Train Epoch: 49 [81/125 20736/32000 (65%)] Loss: 1.92611 (QuantReg: 14.30977) QuantErr: 14.30977 batch_time=0.77433 
Train Epoch: 49 [97/125 24832/32000 (78%)] Loss: 1.88047 (QuantReg: 14.22281) QuantErr: 14.22281 batch_time=0.79214 
Train Epoch: 49 [113/125 28928/32000 (90%)] Loss: 1.74390 (QuantReg: 14.02264) QuantErr: 14.02264 batch_time=1.33681 
Train Epoch: 49 codebook_update_time=1.63210
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch49.pth ...
Done in 12.247s
 epoch          : 49
 loss           : 1.7755822105407715
 quant_reg      : 14.230929656982422
 quant_err      : 14.230929656982422
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 6125
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 51.3
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.813
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.89588176363798
 MSRVTT_miech_test/v2t_metrics/R1: 21.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.335
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.6392135175409
 mnt_best       : 41.61363350602879
 not_improved_count: 17
Train Epoch: 50 [1/125 256/32000 (1%)] Loss: 1.72344 (QuantReg: 14.10490) QuantErr: 14.10490 batch_time=45.53382 
Train Epoch: 50 [17/125 4352/32000 (14%)] Loss: 1.63150 (QuantReg: 14.17843) QuantErr: 14.17843 batch_time=0.76706 
Train Epoch: 50 [33/125 8448/32000 (26%)] Loss: 1.59627 (QuantReg: 14.44703) QuantErr: 14.44703 batch_time=0.77855 
Train Epoch: 50 [49/125 12544/32000 (39%)] Loss: 2.14194 (QuantReg: 14.06527) QuantErr: 14.06527 batch_time=0.98768 
Train Epoch: 50 [65/125 16640/32000 (52%)] Loss: 1.82993 (QuantReg: 14.14930) QuantErr: 14.14930 batch_time=7.91900 
Train Epoch: 50 [81/125 20736/32000 (65%)] Loss: 1.84362 (QuantReg: 14.22155) QuantErr: 14.22155 batch_time=0.83459 
Train Epoch: 50 [97/125 24832/32000 (78%)] Loss: 1.86391 (QuantReg: 14.18964) QuantErr: 14.18964 batch_time=0.74705 
Train Epoch: 50 [113/125 28928/32000 (90%)] Loss: 1.65836 (QuantReg: 14.38175) QuantErr: 14.38175 batch_time=1.04894 
Train Epoch: 50 codebook_update_time=1.62505
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/checkpoint-epoch50.pth ...
Done in 3.974s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 1.763978964805603
 quant_reg      : 14.24163552093506
 quant_err      : 14.24163552093506
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 6250
 MSRVTT_miech_test/t2v_metrics/R1: 21.9
 MSRVTT_miech_test/t2v_metrics/R5: 51.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 86.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.122
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.528699362561
 MSRVTT_miech_test/v2t_metrics/R1: 21.1
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.9
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.1055
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.92370844168783
 mnt_best       : 41.61363350602879
 not_improved_count: 18
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/trained_model.pth ...
Ckpt loaded at epoch 32.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/MSRVTT-test-qt-sims.npy
MSRVTT_miech_test:
 t2v_metrics/R1/final_eval: 22.5
 t2v_metrics/R5/final_eval: 50.2
 t2v_metrics/R10/final_eval: 63.8
 t2v_metrics/R50/final_eval: 87.0
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 30.96
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 41.61363350602879
 v2t_metrics/R1/final_eval: 21.3
 v2t_metrics/R5/final_eval: 52.4
 v2t_metrics/R10/final_eval: 65.9
 v2t_metrics/R50/final_eval: 88.3
 v2t_metrics/MedR/final_eval: 5.0
 v2t_metrics/MeanR/final_eval: 27.496
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 41.89852828508681
Best epoch for the monitored metric: 32
Script took 03h15m23s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs256/trained_model.pth
