Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 1399.3037362098694 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 83.50736212730408 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 61.18068528175354 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch0.pth ...
Done in 5.122s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch0.pth ...
Done in 6.955s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 510.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 502.005
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 510.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 504.663
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.43795191398878897
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 32.83125 (QuantReg: 22.82731) QuantErr: 22.82731 batch_time=43.85550 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 30.60303 (QuantReg: 22.83835) QuantErr: 22.83835 batch_time=0.47750 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 27.57227 (QuantReg: 22.68104) QuantErr: 22.68104 batch_time=0.48669 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 22.35240 (QuantReg: 22.67958) QuantErr: 22.67958 batch_time=0.50392 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 22.80320 (QuantReg: 22.66862) QuantErr: 22.66862 batch_time=0.44018 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 20.06005 (QuantReg: 22.71804) QuantErr: 22.71804 batch_time=0.44240 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 20.04149 (QuantReg: 22.64183) QuantErr: 22.64183 batch_time=0.44190 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 19.45669 (QuantReg: 22.61533) QuantErr: 22.61533 batch_time=0.42179 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 18.20087 (QuantReg: 22.63413) QuantErr: 22.63413 batch_time=0.44230 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 18.20848 (QuantReg: 22.70575) QuantErr: 22.70575 batch_time=0.46585 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 16.83438 (QuantReg: 22.61252) QuantErr: 22.61252 batch_time=0.45029 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 18.02362 (QuantReg: 22.60206) QuantErr: 22.60206 batch_time=0.45388 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 17.47155 (QuantReg: 22.62625) QuantErr: 22.62625 batch_time=0.49979 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 16.99991 (QuantReg: 22.64014) QuantErr: 22.64014 batch_time=0.51420 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 14.56367 (QuantReg: 22.62826) QuantErr: 22.62826 batch_time=0.46800 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 14.92841 (QuantReg: 22.66840) QuantErr: 22.66840 batch_time=0.47441 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 16.36340 (QuantReg: 22.62175) QuantErr: 22.62175 batch_time=0.47866 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 14.96557 (QuantReg: 22.61112) QuantErr: 22.61112 batch_time=0.44001 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 16.08274 (QuantReg: 22.69087) QuantErr: 22.69087 batch_time=0.48742 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 14.83075 (QuantReg: 22.65704) QuantErr: 22.65704 batch_time=0.46384 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 13.70708 (QuantReg: 22.60753) QuantErr: 22.60753 batch_time=0.52184 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 16.01554 (QuantReg: 22.61163) QuantErr: 22.61163 batch_time=0.44290 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 13.38301 (QuantReg: 22.62234) QuantErr: 22.62234 batch_time=0.45087 
Train Epoch: 1 codebook_update_time=0.96127
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch1.pth ...
Done in 3.938s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch1.pth ...
Done in 7.965s
 epoch          : 1
 loss           : 18.566399478912352
 quant_reg      : 22.65883716583252
 quant_err      : 22.65883716583252
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 29.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 43.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 79.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 42.874
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.833582654259274
 MSRVTT_jsfusion_test/v2t_metrics/R1: 8.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 32.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 46.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 41.999
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.167942122785814
 mnt_best       : 22.833582654259274
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 13.09873 (QuantReg: 11.60903) QuantErr: 11.60903 batch_time=43.81042 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 15.51215 (QuantReg: 11.35355) QuantErr: 11.35355 batch_time=0.47912 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 12.63166 (QuantReg: 11.58446) QuantErr: 11.58446 batch_time=0.50988 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 14.50120 (QuantReg: 12.04102) QuantErr: 12.04102 batch_time=0.44435 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 14.14351 (QuantReg: 11.91783) QuantErr: 11.91783 batch_time=0.44045 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 12.55157 (QuantReg: 12.04705) QuantErr: 12.04705 batch_time=0.45983 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 13.43394 (QuantReg: 12.15230) QuantErr: 12.15230 batch_time=0.44205 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 14.32668 (QuantReg: 12.52283) QuantErr: 12.52283 batch_time=0.47107 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 14.74108 (QuantReg: 12.83707) QuantErr: 12.83707 batch_time=0.46597 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 12.58172 (QuantReg: 12.45203) QuantErr: 12.45203 batch_time=0.44083 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 12.58557 (QuantReg: 12.70559) QuantErr: 12.70559 batch_time=0.43757 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 11.79485 (QuantReg: 12.94580) QuantErr: 12.94580 batch_time=0.44329 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 13.72666 (QuantReg: 13.27091) QuantErr: 13.27091 batch_time=0.46659 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 12.90316 (QuantReg: 13.59238) QuantErr: 13.59238 batch_time=0.43576 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 12.32447 (QuantReg: 13.69081) QuantErr: 13.69081 batch_time=0.46618 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 12.22063 (QuantReg: 13.48847) QuantErr: 13.48847 batch_time=0.43952 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 11.55470 (QuantReg: 13.97384) QuantErr: 13.97384 batch_time=0.43978 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 12.13988 (QuantReg: 13.74501) QuantErr: 13.74501 batch_time=0.43637 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 10.37850 (QuantReg: 13.91778) QuantErr: 13.91778 batch_time=0.44506 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 11.04460 (QuantReg: 14.27949) QuantErr: 14.27949 batch_time=0.43723 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 10.95867 (QuantReg: 14.31577) QuantErr: 14.31577 batch_time=0.47403 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 11.72800 (QuantReg: 13.98548) QuantErr: 13.98548 batch_time=0.43485 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 11.20017 (QuantReg: 14.23133) QuantErr: 14.23133 batch_time=0.49009 
Train Epoch: 2 codebook_update_time=0.90039
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch2.pth ...
Done in 5.520s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch2.pth ...
Done in 9.492s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 12.817329372406006
 quant_reg      : 13.027298622131347
 quant_err      : 13.027298622131347
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 38.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.301
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.100509353672667
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.92610193844254
 mnt_best       : 29.100509353672667
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 12.06062 (QuantReg: 11.44259) QuantErr: 11.44259 batch_time=36.14632 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 11.35840 (QuantReg: 11.87926) QuantErr: 11.87926 batch_time=0.43156 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 11.20785 (QuantReg: 11.40909) QuantErr: 11.40909 batch_time=0.44268 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 10.70342 (QuantReg: 11.83622) QuantErr: 11.83622 batch_time=0.44180 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 9.90324 (QuantReg: 11.61013) QuantErr: 11.61013 batch_time=0.44952 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 11.39174 (QuantReg: 11.54603) QuantErr: 11.54603 batch_time=0.43477 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 11.61854 (QuantReg: 11.97667) QuantErr: 11.97667 batch_time=0.43393 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 11.77129 (QuantReg: 11.93829) QuantErr: 11.93829 batch_time=0.47715 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 11.75396 (QuantReg: 11.72993) QuantErr: 11.72993 batch_time=0.71545 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 12.87441 (QuantReg: 11.95269) QuantErr: 11.95269 batch_time=0.50232 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 11.58214 (QuantReg: 12.23561) QuantErr: 12.23561 batch_time=0.42897 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 10.79363 (QuantReg: 12.13221) QuantErr: 12.13221 batch_time=0.45346 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 9.88701 (QuantReg: 12.15233) QuantErr: 12.15233 batch_time=0.47769 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 10.74149 (QuantReg: 12.20969) QuantErr: 12.20969 batch_time=0.42566 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 10.05471 (QuantReg: 12.21230) QuantErr: 12.21230 batch_time=0.48662 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 10.49986 (QuantReg: 12.38680) QuantErr: 12.38680 batch_time=0.45322 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 10.00033 (QuantReg: 12.56349) QuantErr: 12.56349 batch_time=0.45063 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 10.01628 (QuantReg: 12.51929) QuantErr: 12.51929 batch_time=0.45115 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 11.65317 (QuantReg: 12.62611) QuantErr: 12.62611 batch_time=0.44521 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 10.26978 (QuantReg: 12.68830) QuantErr: 12.68830 batch_time=0.43390 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 10.70022 (QuantReg: 12.95265) QuantErr: 12.95265 batch_time=0.43313 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 10.61561 (QuantReg: 12.90516) QuantErr: 12.90516 batch_time=0.44076 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 9.50581 (QuantReg: 13.35578) QuantErr: 13.35578 batch_time=0.44107 
Train Epoch: 3 codebook_update_time=1.00870
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch3.pth ...
Done in 4.172s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch3.pth ...
Done in 8.340s
removing stale ckpt [epoch 2] [took 0.02s]
 epoch          : 3
 loss           : 10.952469360351563
 quant_reg      : 12.190602237701416
 quant_err      : 12.190602237701416
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 40.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.209
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.98238874689571
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.149
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.42345251140843
 mnt_best       : 31.98238874689571
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 11.44930 (QuantReg: 11.38882) QuantErr: 11.38882 batch_time=36.61996 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 9.13384 (QuantReg: 11.57896) QuantErr: 11.57896 batch_time=0.59030 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 8.73876 (QuantReg: 11.67418) QuantErr: 11.67418 batch_time=0.50335 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 10.53733 (QuantReg: 11.62023) QuantErr: 11.62023 batch_time=0.43096 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 9.55077 (QuantReg: 12.09265) QuantErr: 12.09265 batch_time=0.46845 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 10.64332 (QuantReg: 11.79316) QuantErr: 11.79316 batch_time=0.47998 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 10.39478 (QuantReg: 11.83850) QuantErr: 11.83850 batch_time=1.70828 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 9.44104 (QuantReg: 12.43796) QuantErr: 12.43796 batch_time=1.58867 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 9.09528 (QuantReg: 11.98465) QuantErr: 11.98465 batch_time=0.43600 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 10.31756 (QuantReg: 12.25072) QuantErr: 12.25072 batch_time=0.43433 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 9.69282 (QuantReg: 12.42768) QuantErr: 12.42768 batch_time=0.42162 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 10.72278 (QuantReg: 12.06815) QuantErr: 12.06815 batch_time=0.42961 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 9.45379 (QuantReg: 12.05396) QuantErr: 12.05396 batch_time=0.42276 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 9.40115 (QuantReg: 12.42507) QuantErr: 12.42507 batch_time=0.47592 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 9.01040 (QuantReg: 12.34481) QuantErr: 12.34481 batch_time=0.44149 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 10.54159 (QuantReg: 12.57438) QuantErr: 12.57438 batch_time=0.50513 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 10.11916 (QuantReg: 12.55103) QuantErr: 12.55103 batch_time=0.45036 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 9.39581 (QuantReg: 12.58825) QuantErr: 12.58825 batch_time=0.46829 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 9.58508 (QuantReg: 12.25649) QuantErr: 12.25649 batch_time=0.45379 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 8.32013 (QuantReg: 12.66826) QuantErr: 12.66826 batch_time=0.46081 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 9.18411 (QuantReg: 12.66631) QuantErr: 12.66631 batch_time=0.42764 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 9.69078 (QuantReg: 12.48672) QuantErr: 12.48672 batch_time=0.45342 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 8.83247 (QuantReg: 12.45794) QuantErr: 12.45794 batch_time=0.44147 
Train Epoch: 4 codebook_update_time=0.82298
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch4.pth ...
Done in 3.946s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch4.pth ...
Done in 7.875s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 9.788853378295899
 quant_reg      : 12.217399677276612
 quant_err      : 12.217399677276612
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.718
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.20672220101715
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.19
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.22293078008761
 mnt_best       : 35.20672220101715
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 9.95337 (QuantReg: 11.86706) QuantErr: 11.86706 batch_time=40.16910 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 8.18843 (QuantReg: 12.05030) QuantErr: 12.05030 batch_time=0.45412 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 9.04331 (QuantReg: 12.05496) QuantErr: 12.05496 batch_time=0.42985 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 8.23559 (QuantReg: 12.04685) QuantErr: 12.04685 batch_time=0.45999 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 8.97485 (QuantReg: 11.71347) QuantErr: 11.71347 batch_time=0.93398 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 10.30818 (QuantReg: 12.25002) QuantErr: 12.25002 batch_time=0.45193 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 9.74421 (QuantReg: 12.19296) QuantErr: 12.19296 batch_time=0.44050 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 9.53052 (QuantReg: 12.16427) QuantErr: 12.16427 batch_time=0.43035 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 8.54571 (QuantReg: 12.35797) QuantErr: 12.35797 batch_time=0.43896 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 9.46775 (QuantReg: 12.15966) QuantErr: 12.15966 batch_time=0.44260 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 9.68130 (QuantReg: 12.23354) QuantErr: 12.23354 batch_time=0.51181 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 7.87275 (QuantReg: 12.26372) QuantErr: 12.26372 batch_time=0.46536 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 9.09422 (QuantReg: 12.15833) QuantErr: 12.15833 batch_time=0.45199 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 8.68091 (QuantReg: 12.05550) QuantErr: 12.05550 batch_time=0.43949 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 9.68669 (QuantReg: 12.46503) QuantErr: 12.46503 batch_time=0.43068 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 7.52363 (QuantReg: 12.60557) QuantErr: 12.60557 batch_time=0.45826 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 8.79836 (QuantReg: 12.54465) QuantErr: 12.54465 batch_time=0.47795 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 9.29198 (QuantReg: 12.43630) QuantErr: 12.43630 batch_time=0.69366 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 6.91105 (QuantReg: 12.69849) QuantErr: 12.69849 batch_time=0.44000 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 7.88353 (QuantReg: 12.92059) QuantErr: 12.92059 batch_time=0.44932 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 9.58816 (QuantReg: 12.76789) QuantErr: 12.76789 batch_time=0.46837 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 8.46835 (QuantReg: 12.67284) QuantErr: 12.67284 batch_time=0.46884 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 7.85264 (QuantReg: 12.66855) QuantErr: 12.66855 batch_time=0.46251 
Train Epoch: 5 codebook_update_time=0.86855
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch5.pth ...
Done in 10.093s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch5.pth ...
Done in 13.860s
removing stale ckpt [epoch 4] [took 0.02s]
 epoch          : 5
 loss           : 9.039031126022339
 quant_reg      : 12.347215183258056
 quant_err      : 12.347215183258056
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.106
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.1048557178105
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.233
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.680886069876955
 mnt_best       : 37.1048557178105
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 8.83435 (QuantReg: 12.51050) QuantErr: 12.51050 batch_time=35.33500 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 9.53157 (QuantReg: 12.14843) QuantErr: 12.14843 batch_time=0.43711 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 8.24592 (QuantReg: 12.12432) QuantErr: 12.12432 batch_time=0.44806 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 9.15562 (QuantReg: 12.56200) QuantErr: 12.56200 batch_time=0.44051 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 9.85272 (QuantReg: 12.28611) QuantErr: 12.28611 batch_time=0.44343 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 8.07504 (QuantReg: 12.07554) QuantErr: 12.07554 batch_time=0.44370 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 8.52167 (QuantReg: 12.11064) QuantErr: 12.11064 batch_time=0.88821 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 8.06989 (QuantReg: 12.21470) QuantErr: 12.21470 batch_time=0.42587 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 8.12128 (QuantReg: 12.52693) QuantErr: 12.52693 batch_time=0.43289 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 9.09133 (QuantReg: 12.24650) QuantErr: 12.24650 batch_time=0.47888 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 10.11119 (QuantReg: 12.23168) QuantErr: 12.23168 batch_time=0.42686 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 8.40886 (QuantReg: 12.32557) QuantErr: 12.32557 batch_time=0.43042 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 8.54484 (QuantReg: 12.52634) QuantErr: 12.52634 batch_time=0.52372 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 8.03995 (QuantReg: 12.49967) QuantErr: 12.49967 batch_time=0.77183 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 9.15015 (QuantReg: 12.77551) QuantErr: 12.77551 batch_time=0.45468 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 7.97784 (QuantReg: 12.41195) QuantErr: 12.41195 batch_time=0.50605 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 7.97878 (QuantReg: 12.42679) QuantErr: 12.42679 batch_time=0.45989 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 7.75268 (QuantReg: 12.79352) QuantErr: 12.79352 batch_time=0.43626 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 7.63631 (QuantReg: 12.48400) QuantErr: 12.48400 batch_time=4.28945 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 6.20903 (QuantReg: 12.61933) QuantErr: 12.61933 batch_time=0.43162 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 8.97249 (QuantReg: 12.38035) QuantErr: 12.38035 batch_time=0.49475 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 8.70732 (QuantReg: 12.82257) QuantErr: 12.82257 batch_time=0.45461 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 7.44357 (QuantReg: 12.77844) QuantErr: 12.77844 batch_time=0.43223 
Train Epoch: 6 codebook_update_time=0.97663
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch6.pth ...
Done in 4.140s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 8.340163831710816
 quant_reg      : 12.416304889678955
 quant_err      : 12.416304889678955
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.385
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.95871811146236
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.549
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.435831265161866
 mnt_best       : 37.1048557178105
 not_improved_count: 1
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 8.78065 (QuantReg: 12.00459) QuantErr: 12.00459 batch_time=34.03501 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 7.42361 (QuantReg: 12.40001) QuantErr: 12.40001 batch_time=0.44406 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 8.84435 (QuantReg: 12.15129) QuantErr: 12.15129 batch_time=0.42647 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 7.13295 (QuantReg: 11.80920) QuantErr: 11.80920 batch_time=0.44960 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 7.43465 (QuantReg: 12.24323) QuantErr: 12.24323 batch_time=0.43916 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 7.02870 (QuantReg: 12.04548) QuantErr: 12.04548 batch_time=0.44780 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 6.44055 (QuantReg: 12.38646) QuantErr: 12.38646 batch_time=4.95446 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 8.59543 (QuantReg: 12.65621) QuantErr: 12.65621 batch_time=0.47060 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 8.49204 (QuantReg: 12.41478) QuantErr: 12.41478 batch_time=0.45441 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 7.85544 (QuantReg: 12.51474) QuantErr: 12.51474 batch_time=0.42850 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 6.46204 (QuantReg: 12.48075) QuantErr: 12.48075 batch_time=0.43950 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 6.15616 (QuantReg: 12.51491) QuantErr: 12.51491 batch_time=0.49897 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 8.33362 (QuantReg: 12.52547) QuantErr: 12.52547 batch_time=0.89148 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 7.42147 (QuantReg: 12.14680) QuantErr: 12.14680 batch_time=0.42249 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 7.42013 (QuantReg: 12.36652) QuantErr: 12.36652 batch_time=0.42910 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 7.94611 (QuantReg: 12.57547) QuantErr: 12.57547 batch_time=0.47176 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 8.55206 (QuantReg: 12.53772) QuantErr: 12.53772 batch_time=0.43132 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 8.60866 (QuantReg: 12.42687) QuantErr: 12.42687 batch_time=0.44642 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 6.21436 (QuantReg: 12.50636) QuantErr: 12.50636 batch_time=0.44353 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 7.78000 (QuantReg: 12.87903) QuantErr: 12.87903 batch_time=0.76620 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 8.00854 (QuantReg: 12.48201) QuantErr: 12.48201 batch_time=0.97545 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 8.21336 (QuantReg: 12.33379) QuantErr: 12.33379 batch_time=0.46321 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 7.03958 (QuantReg: 12.65308) QuantErr: 12.65308 batch_time=0.43023 
Train Epoch: 7 codebook_update_time=0.81736
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch7.pth ...
Done in 3.872s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch7.pth ...
Done in 7.986s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 7.736541116714478
 quant_reg      : 12.501497966766358
 quant_err      : 12.501497966766358
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.6
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.72147130402437
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.9985
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.759805773707456
 mnt_best       : 37.72147130402437
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 7.27719 (QuantReg: 12.35727) QuantErr: 12.35727 batch_time=34.96891 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 6.74069 (QuantReg: 12.26834) QuantErr: 12.26834 batch_time=0.44041 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 7.34260 (QuantReg: 12.56522) QuantErr: 12.56522 batch_time=0.44347 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 8.55385 (QuantReg: 12.47588) QuantErr: 12.47588 batch_time=0.45491 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 6.86548 (QuantReg: 12.83172) QuantErr: 12.83172 batch_time=0.45916 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 6.68177 (QuantReg: 12.61390) QuantErr: 12.61390 batch_time=0.46361 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 7.42016 (QuantReg: 11.77381) QuantErr: 11.77381 batch_time=0.45538 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 8.04611 (QuantReg: 12.68692) QuantErr: 12.68692 batch_time=0.43336 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 7.68259 (QuantReg: 12.69226) QuantErr: 12.69226 batch_time=0.44769 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 7.29241 (QuantReg: 12.87856) QuantErr: 12.87856 batch_time=0.52180 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 7.66222 (QuantReg: 12.32039) QuantErr: 12.32039 batch_time=0.44877 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 6.03377 (QuantReg: 12.54185) QuantErr: 12.54185 batch_time=0.43507 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 8.40032 (QuantReg: 12.60897) QuantErr: 12.60897 batch_time=0.67655 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 6.50713 (QuantReg: 12.78468) QuantErr: 12.78468 batch_time=0.44049 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 7.83658 (QuantReg: 12.71741) QuantErr: 12.71741 batch_time=0.42564 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 6.73093 (QuantReg: 13.00007) QuantErr: 13.00007 batch_time=0.43121 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 7.12723 (QuantReg: 12.64676) QuantErr: 12.64676 batch_time=0.43871 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 7.94445 (QuantReg: 12.19280) QuantErr: 12.19280 batch_time=0.46410 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 6.88029 (QuantReg: 12.54877) QuantErr: 12.54877 batch_time=0.62138 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 7.35685 (QuantReg: 12.59092) QuantErr: 12.59092 batch_time=0.48055 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 7.47722 (QuantReg: 12.92703) QuantErr: 12.92703 batch_time=0.43439 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 7.34276 (QuantReg: 12.58528) QuantErr: 12.58528 batch_time=0.44517 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 5.78367 (QuantReg: 12.94667) QuantErr: 12.94667 batch_time=0.44323 
Train Epoch: 8 codebook_update_time=0.84333
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch8.pth ...
Done in 4.268s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch8.pth ...
Done in 8.575s
removing stale ckpt [epoch 7] [took 0.01s]
 epoch          : 8
 loss           : 7.26406202507019
 quant_reg      : 12.601601432800292
 quant_err      : 12.601601432800292
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.785
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.16138255759405
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.7225
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.74760970340723
 mnt_best       : 39.16138255759405
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 7.35309 (QuantReg: 12.82009) QuantErr: 12.82009 batch_time=31.51401 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 7.22241 (QuantReg: 12.18414) QuantErr: 12.18414 batch_time=0.44373 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 7.09137 (QuantReg: 12.37309) QuantErr: 12.37309 batch_time=0.54900 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 7.59582 (QuantReg: 12.14407) QuantErr: 12.14407 batch_time=0.46690 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 6.31563 (QuantReg: 12.45616) QuantErr: 12.45616 batch_time=0.42971 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 7.62519 (QuantReg: 12.14870) QuantErr: 12.14870 batch_time=0.49013 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 6.97316 (QuantReg: 12.89897) QuantErr: 12.89897 batch_time=0.75648 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 6.29674 (QuantReg: 12.93623) QuantErr: 12.93623 batch_time=0.45657 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 6.80941 (QuantReg: 12.38357) QuantErr: 12.38357 batch_time=0.42320 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 7.95538 (QuantReg: 12.44637) QuantErr: 12.44637 batch_time=0.48336 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 6.56419 (QuantReg: 12.79359) QuantErr: 12.79359 batch_time=0.44776 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 9.70020 (QuantReg: 12.75809) QuantErr: 12.75809 batch_time=0.45183 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 6.57877 (QuantReg: 12.69367) QuantErr: 12.69367 batch_time=0.55183 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 5.66924 (QuantReg: 12.54642) QuantErr: 12.54642 batch_time=0.45070 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 5.19848 (QuantReg: 12.61232) QuantErr: 12.61232 batch_time=0.42965 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 7.19742 (QuantReg: 12.58417) QuantErr: 12.58417 batch_time=0.82090 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 8.62126 (QuantReg: 12.87934) QuantErr: 12.87934 batch_time=0.43905 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 7.73235 (QuantReg: 12.24652) QuantErr: 12.24652 batch_time=0.45029 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 6.65107 (QuantReg: 12.34350) QuantErr: 12.34350 batch_time=0.42985 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 6.16306 (QuantReg: 12.63750) QuantErr: 12.63750 batch_time=0.47856 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 5.95574 (QuantReg: 12.90009) QuantErr: 12.90009 batch_time=1.08564 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 7.67670 (QuantReg: 12.89914) QuantErr: 12.89914 batch_time=0.46311 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 6.86312 (QuantReg: 12.62319) QuantErr: 12.62319 batch_time=0.95585 
Train Epoch: 9 codebook_update_time=0.85190
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch9.pth ...
Done in 14.142s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch9.pth ...
Done in 19.013s
removing stale ckpt [epoch 8] [took 0.62s]
 epoch          : 9
 loss           : 6.949498327255249
 quant_reg      : 12.572703582763673
 quant_err      : 12.572703582763673
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.654
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.33207567238599
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.346
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.81305402680257
 mnt_best       : 39.33207567238599
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 9.64240 (QuantReg: 12.45832) QuantErr: 12.45832 batch_time=40.79518 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 5.86795 (QuantReg: 12.77669) QuantErr: 12.77669 batch_time=0.45428 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 6.82776 (QuantReg: 12.42654) QuantErr: 12.42654 batch_time=0.46269 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 5.61373 (QuantReg: 12.32398) QuantErr: 12.32398 batch_time=0.47357 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 5.63104 (QuantReg: 12.67479) QuantErr: 12.67479 batch_time=0.43540 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 7.52662 (QuantReg: 12.26425) QuantErr: 12.26425 batch_time=0.42927 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 6.11760 (QuantReg: 12.97516) QuantErr: 12.97516 batch_time=0.49496 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 6.23472 (QuantReg: 12.51823) QuantErr: 12.51823 batch_time=0.47157 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 6.62832 (QuantReg: 12.35540) QuantErr: 12.35540 batch_time=0.48280 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 7.25573 (QuantReg: 12.71241) QuantErr: 12.71241 batch_time=0.42589 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 6.14731 (QuantReg: 12.97672) QuantErr: 12.97672 batch_time=0.47894 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 7.16526 (QuantReg: 12.60312) QuantErr: 12.60312 batch_time=0.46370 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 6.42739 (QuantReg: 12.52941) QuantErr: 12.52941 batch_time=0.44746 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 6.26651 (QuantReg: 13.08371) QuantErr: 13.08371 batch_time=0.45840 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 7.50382 (QuantReg: 12.66911) QuantErr: 12.66911 batch_time=0.44662 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 7.37232 (QuantReg: 12.72648) QuantErr: 12.72648 batch_time=0.46384 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 5.36141 (QuantReg: 12.90325) QuantErr: 12.90325 batch_time=0.46907 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 6.08001 (QuantReg: 12.94646) QuantErr: 12.94646 batch_time=0.48335 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 6.41303 (QuantReg: 13.01624) QuantErr: 13.01624 batch_time=0.43282 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 7.05852 (QuantReg: 12.86827) QuantErr: 12.86827 batch_time=0.47923 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 6.10226 (QuantReg: 12.98083) QuantErr: 12.98083 batch_time=0.43714 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 7.08199 (QuantReg: 12.85072) QuantErr: 12.85072 batch_time=0.89621 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 6.42241 (QuantReg: 12.87077) QuantErr: 12.87077 batch_time=0.44793 
Train Epoch: 10 codebook_update_time=0.83816
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch10.pth ...
Done in 4.219s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch10.pth ...
Done in 9.590s
removing stale ckpt [epoch 9] [took 0.06s]
 epoch          : 10
 loss           : 6.623721956253052
 quant_reg      : 12.723752265930175
 quant_err      : 12.723752265930175
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.245
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.10466630191795
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.142
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.9201323015737
 mnt_best       : 40.10466630191795
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 6.57911 (QuantReg: 12.24247) QuantErr: 12.24247 batch_time=32.13807 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 6.06979 (QuantReg: 12.70928) QuantErr: 12.70928 batch_time=0.48406 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 6.46562 (QuantReg: 12.60772) QuantErr: 12.60772 batch_time=0.49342 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 6.23592 (QuantReg: 13.03246) QuantErr: 13.03246 batch_time=0.47665 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 6.16024 (QuantReg: 12.80082) QuantErr: 12.80082 batch_time=0.43772 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 6.57143 (QuantReg: 12.63651) QuantErr: 12.63651 batch_time=0.54089 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 6.03609 (QuantReg: 12.75341) QuantErr: 12.75341 batch_time=1.06622 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 7.07162 (QuantReg: 12.69960) QuantErr: 12.69960 batch_time=0.44240 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 6.67005 (QuantReg: 12.50513) QuantErr: 12.50513 batch_time=0.49718 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 7.17235 (QuantReg: 12.41867) QuantErr: 12.41867 batch_time=0.47177 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 5.48453 (QuantReg: 12.80367) QuantErr: 12.80367 batch_time=0.42875 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 7.82363 (QuantReg: 12.71257) QuantErr: 12.71257 batch_time=0.42467 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 6.66270 (QuantReg: 12.71639) QuantErr: 12.71639 batch_time=0.66217 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 5.68612 (QuantReg: 13.13256) QuantErr: 13.13256 batch_time=0.42994 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 5.88441 (QuantReg: 13.12373) QuantErr: 13.12373 batch_time=0.43264 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 6.01885 (QuantReg: 12.42695) QuantErr: 12.42695 batch_time=0.45845 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 5.80212 (QuantReg: 12.50165) QuantErr: 12.50165 batch_time=0.44121 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 7.16878 (QuantReg: 12.66839) QuantErr: 12.66839 batch_time=0.43346 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 5.50427 (QuantReg: 12.82311) QuantErr: 12.82311 batch_time=0.46360 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 6.59805 (QuantReg: 12.50465) QuantErr: 12.50465 batch_time=0.54318 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 6.11138 (QuantReg: 12.91292) QuantErr: 12.91292 batch_time=0.42795 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 6.35429 (QuantReg: 12.88437) QuantErr: 12.88437 batch_time=0.43727 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 7.50396 (QuantReg: 13.02508) QuantErr: 13.02508 batch_time=0.43163 
Train Epoch: 11 codebook_update_time=0.91173
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch11.pth ...
Done in 5.202s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch11.pth ...
Done in 10.858s
removing stale ckpt [epoch 10] [took 0.07s]
 epoch          : 11
 loss           : 6.323669538497925
 quant_reg      : 12.716312957763671
 quant_err      : 12.716312957763671
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.385
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.12906229191178
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.525
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.3843302723228
 mnt_best       : 40.12906229191178
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 5.46731 (QuantReg: 12.44892) QuantErr: 12.44892 batch_time=33.76574 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 7.12926 (QuantReg: 12.50900) QuantErr: 12.50900 batch_time=0.43173 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 6.74616 (QuantReg: 12.86113) QuantErr: 12.86113 batch_time=0.43100 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 6.28451 (QuantReg: 12.54025) QuantErr: 12.54025 batch_time=0.44358 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 5.17279 (QuantReg: 12.68000) QuantErr: 12.68000 batch_time=0.43779 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 6.65758 (QuantReg: 12.94282) QuantErr: 12.94282 batch_time=0.45222 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 6.07324 (QuantReg: 12.58420) QuantErr: 12.58420 batch_time=5.22658 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 6.02424 (QuantReg: 12.51514) QuantErr: 12.51514 batch_time=0.47459 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 5.36616 (QuantReg: 12.21901) QuantErr: 12.21901 batch_time=0.48710 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 8.15154 (QuantReg: 12.55299) QuantErr: 12.55299 batch_time=0.43994 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 6.76884 (QuantReg: 12.58890) QuantErr: 12.58890 batch_time=0.47268 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 8.15976 (QuantReg: 12.84366) QuantErr: 12.84366 batch_time=0.43775 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 6.07221 (QuantReg: 12.35528) QuantErr: 12.35528 batch_time=0.45567 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 4.76413 (QuantReg: 12.77607) QuantErr: 12.77607 batch_time=0.48162 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 6.95701 (QuantReg: 12.73765) QuantErr: 12.73765 batch_time=0.45349 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 6.13578 (QuantReg: 12.85414) QuantErr: 12.85414 batch_time=0.43229 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 4.77136 (QuantReg: 12.88798) QuantErr: 12.88798 batch_time=0.44080 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 6.37746 (QuantReg: 12.73063) QuantErr: 12.73063 batch_time=0.44810 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 6.76908 (QuantReg: 12.95208) QuantErr: 12.95208 batch_time=1.02887 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 6.99887 (QuantReg: 12.71913) QuantErr: 12.71913 batch_time=0.43087 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 6.11837 (QuantReg: 12.33100) QuantErr: 12.33100 batch_time=0.45965 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 6.19339 (QuantReg: 12.86785) QuantErr: 12.86785 batch_time=0.47405 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 4.77813 (QuantReg: 13.05545) QuantErr: 13.05545 batch_time=0.44280 
Train Epoch: 12 codebook_update_time=0.87827
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch12.pth ...
Done in 4.745s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch12.pth ...
Done in 9.840s
removing stale ckpt [epoch 11] [took 0.03s]
 epoch          : 12
 loss           : 6.035094451904297
 quant_reg      : 12.759136753082275
 quant_err      : 12.759136753082275
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.839
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.374868642013524
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.86
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.639914845615344
 mnt_best       : 41.374868642013524
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 6.34729 (QuantReg: 12.49700) QuantErr: 12.49700 batch_time=34.46744 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 6.72392 (QuantReg: 12.60175) QuantErr: 12.60175 batch_time=0.45063 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 5.26484 (QuantReg: 12.58747) QuantErr: 12.58747 batch_time=0.47170 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 4.97597 (QuantReg: 12.74365) QuantErr: 12.74365 batch_time=0.42102 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 6.83810 (QuantReg: 12.63359) QuantErr: 12.63359 batch_time=0.45721 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 5.67031 (QuantReg: 12.65903) QuantErr: 12.65903 batch_time=0.43272 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 6.52979 (QuantReg: 12.45891) QuantErr: 12.45891 batch_time=0.43940 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 5.51254 (QuantReg: 12.57109) QuantErr: 12.57109 batch_time=0.45743 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 6.97235 (QuantReg: 12.63547) QuantErr: 12.63547 batch_time=0.44997 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 5.40520 (QuantReg: 12.98596) QuantErr: 12.98596 batch_time=0.45802 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 5.31070 (QuantReg: 12.51354) QuantErr: 12.51354 batch_time=0.45811 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 5.70351 (QuantReg: 12.69886) QuantErr: 12.69886 batch_time=0.43597 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 5.91428 (QuantReg: 12.93650) QuantErr: 12.93650 batch_time=0.46566 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 6.19095 (QuantReg: 12.86820) QuantErr: 12.86820 batch_time=0.48135 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 6.16410 (QuantReg: 12.88587) QuantErr: 12.88587 batch_time=0.43621 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 4.97724 (QuantReg: 13.55271) QuantErr: 13.55271 batch_time=0.44857 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 5.59041 (QuantReg: 13.14562) QuantErr: 13.14562 batch_time=0.44776 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 5.86592 (QuantReg: 12.93934) QuantErr: 12.93934 batch_time=0.43039 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 6.12566 (QuantReg: 12.52328) QuantErr: 12.52328 batch_time=0.47882 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 4.97705 (QuantReg: 12.92218) QuantErr: 12.92218 batch_time=0.48776 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 6.14528 (QuantReg: 13.04573) QuantErr: 13.04573 batch_time=0.44641 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 5.90673 (QuantReg: 12.77876) QuantErr: 12.77876 batch_time=0.44527 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 6.48067 (QuantReg: 12.92029) QuantErr: 12.92029 batch_time=0.43866 
Train Epoch: 13 codebook_update_time=0.92310
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch13.pth ...
Done in 4.903s
removing stale ckpt [epoch 12] [took 0.13s]
 epoch          : 13
 loss           : 5.8579316997528075
 quant_reg      : 12.766504890441894
 quant_err      : 12.766504890441894
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.444
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.320139268961306
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.423
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.03931692476018
 mnt_best       : 41.374868642013524
 not_improved_count: 1
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 4.89523 (QuantReg: 12.51422) QuantErr: 12.51422 batch_time=39.17042 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 5.89018 (QuantReg: 12.61719) QuantErr: 12.61719 batch_time=0.43712 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 6.43818 (QuantReg: 12.73387) QuantErr: 12.73387 batch_time=0.66439 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 4.50565 (QuantReg: 12.64110) QuantErr: 12.64110 batch_time=0.84366 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 5.31117 (QuantReg: 12.75432) QuantErr: 12.75432 batch_time=0.65260 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 4.67133 (QuantReg: 13.09315) QuantErr: 13.09315 batch_time=0.44368 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 6.68525 (QuantReg: 12.71621) QuantErr: 12.71621 batch_time=0.46270 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 5.98087 (QuantReg: 12.63349) QuantErr: 12.63349 batch_time=0.47164 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 6.89675 (QuantReg: 13.00384) QuantErr: 13.00384 batch_time=0.47863 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 6.06289 (QuantReg: 12.77107) QuantErr: 12.77107 batch_time=0.57679 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 5.51695 (QuantReg: 13.02040) QuantErr: 13.02040 batch_time=0.45004 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 5.34513 (QuantReg: 12.79675) QuantErr: 12.79675 batch_time=0.43075 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 5.02327 (QuantReg: 12.75355) QuantErr: 12.75355 batch_time=0.46120 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 6.09545 (QuantReg: 12.94664) QuantErr: 12.94664 batch_time=0.47273 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 5.66827 (QuantReg: 12.73441) QuantErr: 12.73441 batch_time=0.47037 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 6.20992 (QuantReg: 12.48534) QuantErr: 12.48534 batch_time=0.49191 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 4.47668 (QuantReg: 13.18070) QuantErr: 13.18070 batch_time=0.44368 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 3.62865 (QuantReg: 13.16245) QuantErr: 13.16245 batch_time=0.43663 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 5.34764 (QuantReg: 12.76668) QuantErr: 12.76668 batch_time=0.47893 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 5.99629 (QuantReg: 12.94887) QuantErr: 12.94887 batch_time=0.43350 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 6.26806 (QuantReg: 12.65168) QuantErr: 12.65168 batch_time=0.45829 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 5.54734 (QuantReg: 13.12836) QuantErr: 13.12836 batch_time=0.44289 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 4.69684 (QuantReg: 12.98477) QuantErr: 12.98477 batch_time=0.46065 
Train Epoch: 14 codebook_update_time=0.81725
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch14.pth ...
Done in 6.992s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch14.pth ...
Done in 12.474s
removing stale ckpt [epoch 13] [took 0.25s]
 epoch          : 14
 loss           : 5.6459108829498295
 quant_reg      : 12.814208446502686
 quant_err      : 12.814208446502686
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.27
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.65378659667916
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.07
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.105717802437304
 mnt_best       : 41.65378659667916
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 5.51352 (QuantReg: 12.70065) QuantErr: 12.70065 batch_time=33.99276 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 6.44742 (QuantReg: 12.73079) QuantErr: 12.73079 batch_time=0.45666 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 5.62172 (QuantReg: 12.79024) QuantErr: 12.79024 batch_time=0.43426 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 5.77518 (QuantReg: 12.72455) QuantErr: 12.72455 batch_time=0.76185 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 5.58634 (QuantReg: 12.74755) QuantErr: 12.74755 batch_time=0.49904 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 5.54750 (QuantReg: 12.78760) QuantErr: 12.78760 batch_time=0.45302 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 5.86000 (QuantReg: 12.83187) QuantErr: 12.83187 batch_time=0.74811 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 4.27829 (QuantReg: 12.88298) QuantErr: 12.88298 batch_time=0.43759 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 5.11688 (QuantReg: 12.61309) QuantErr: 12.61309 batch_time=0.43764 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 7.63640 (QuantReg: 12.91029) QuantErr: 12.91029 batch_time=0.44143 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 5.95085 (QuantReg: 12.80833) QuantErr: 12.80833 batch_time=0.46405 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 5.67575 (QuantReg: 12.80137) QuantErr: 12.80137 batch_time=0.44036 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 5.44792 (QuantReg: 12.97953) QuantErr: 12.97953 batch_time=0.44820 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 6.34223 (QuantReg: 12.98839) QuantErr: 12.98839 batch_time=0.46392 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 5.90870 (QuantReg: 12.48590) QuantErr: 12.48590 batch_time=0.43581 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 5.27757 (QuantReg: 12.79318) QuantErr: 12.79318 batch_time=0.42250 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 7.35503 (QuantReg: 12.80166) QuantErr: 12.80166 batch_time=0.45991 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 5.70275 (QuantReg: 12.53505) QuantErr: 12.53505 batch_time=0.47117 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 5.58192 (QuantReg: 12.74040) QuantErr: 12.74040 batch_time=0.43351 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 4.72705 (QuantReg: 13.18221) QuantErr: 13.18221 batch_time=3.56919 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 3.98288 (QuantReg: 13.11997) QuantErr: 13.11997 batch_time=0.43075 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 4.84123 (QuantReg: 12.76921) QuantErr: 12.76921 batch_time=0.44210 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 5.75659 (QuantReg: 13.24665) QuantErr: 13.24665 batch_time=0.51357 
Train Epoch: 15 codebook_update_time=0.89789
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch15.pth ...
Done in 6.471s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch15.pth ...
Done in 12.333s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 5.465325452804565
 quant_reg      : 12.846569816589355
 quant_err      : 12.846569816589355
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.326
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.771187687092564
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7185
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.8893008022798
 mnt_best       : 41.771187687092564
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 5.80335 (QuantReg: 12.43698) QuantErr: 12.43698 batch_time=31.30250 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 4.78886 (QuantReg: 12.86228) QuantErr: 12.86228 batch_time=0.44177 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 5.81632 (QuantReg: 12.88665) QuantErr: 12.88665 batch_time=0.47491 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 4.76781 (QuantReg: 13.01186) QuantErr: 13.01186 batch_time=0.44117 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 4.66127 (QuantReg: 12.99827) QuantErr: 12.99827 batch_time=0.43936 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 4.49042 (QuantReg: 12.71127) QuantErr: 12.71127 batch_time=0.42506 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 5.71592 (QuantReg: 12.64052) QuantErr: 12.64052 batch_time=2.28511 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 5.64259 (QuantReg: 12.79655) QuantErr: 12.79655 batch_time=0.49439 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 5.09714 (QuantReg: 12.77061) QuantErr: 12.77061 batch_time=0.48133 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 5.78072 (QuantReg: 12.75083) QuantErr: 12.75083 batch_time=0.44492 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 4.93932 (QuantReg: 12.84992) QuantErr: 12.84992 batch_time=0.43692 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 5.32952 (QuantReg: 12.89946) QuantErr: 12.89946 batch_time=0.43543 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 6.32180 (QuantReg: 12.77149) QuantErr: 12.77149 batch_time=0.46789 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 5.71808 (QuantReg: 13.18291) QuantErr: 13.18291 batch_time=1.22256 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 4.19472 (QuantReg: 13.01720) QuantErr: 13.01720 batch_time=0.44755 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 6.01964 (QuantReg: 12.77306) QuantErr: 12.77306 batch_time=0.43983 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 4.63029 (QuantReg: 12.87913) QuantErr: 12.87913 batch_time=0.46951 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 4.85387 (QuantReg: 12.84404) QuantErr: 12.84404 batch_time=0.44447 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 4.71203 (QuantReg: 12.65442) QuantErr: 12.65442 batch_time=0.49415 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 5.08306 (QuantReg: 12.73127) QuantErr: 12.73127 batch_time=0.43806 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 5.30163 (QuantReg: 12.74316) QuantErr: 12.74316 batch_time=0.69437 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 5.44623 (QuantReg: 13.07905) QuantErr: 13.07905 batch_time=0.43479 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 5.68255 (QuantReg: 12.88440) QuantErr: 12.88440 batch_time=0.44241 
Train Epoch: 16 codebook_update_time=0.83313
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch16.pth ...
Done in 4.719s
removing stale ckpt [epoch 15] [took 0.21s]
 epoch          : 16
 loss           : 5.329007749557495
 quant_reg      : 12.873565444946289
 quant_err      : 12.873565444946289
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.721
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.68192566100982
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4125
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.63344781300215
 mnt_best       : 41.771187687092564
 not_improved_count: 1
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 6.17467 (QuantReg: 12.84096) QuantErr: 12.84096 batch_time=37.78498 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 5.86657 (QuantReg: 12.61172) QuantErr: 12.61172 batch_time=0.43393 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 5.47078 (QuantReg: 12.63507) QuantErr: 12.63507 batch_time=0.43600 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 4.43911 (QuantReg: 12.92326) QuantErr: 12.92326 batch_time=0.43863 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 4.78205 (QuantReg: 12.82391) QuantErr: 12.82391 batch_time=0.47710 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 4.25905 (QuantReg: 12.80255) QuantErr: 12.80255 batch_time=0.43561 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 4.75178 (QuantReg: 12.88118) QuantErr: 12.88118 batch_time=0.44502 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 5.00059 (QuantReg: 12.90600) QuantErr: 12.90600 batch_time=0.45247 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 5.55295 (QuantReg: 12.55315) QuantErr: 12.55315 batch_time=0.43974 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 5.35525 (QuantReg: 13.20118) QuantErr: 13.20118 batch_time=0.44463 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 4.90898 (QuantReg: 12.73168) QuantErr: 12.73168 batch_time=0.47385 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 5.21768 (QuantReg: 12.78734) QuantErr: 12.78734 batch_time=0.44932 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 4.66258 (QuantReg: 12.99283) QuantErr: 12.99283 batch_time=0.46482 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 5.68964 (QuantReg: 12.84130) QuantErr: 12.84130 batch_time=0.44730 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 6.19249 (QuantReg: 12.74007) QuantErr: 12.74007 batch_time=0.44848 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 4.83957 (QuantReg: 12.82446) QuantErr: 12.82446 batch_time=0.43579 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 5.05763 (QuantReg: 12.52489) QuantErr: 12.52489 batch_time=0.51734 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 4.15693 (QuantReg: 13.18572) QuantErr: 13.18572 batch_time=0.48451 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 4.98089 (QuantReg: 12.92828) QuantErr: 12.92828 batch_time=0.52929 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 5.23064 (QuantReg: 12.89619) QuantErr: 12.89619 batch_time=0.43226 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 4.67185 (QuantReg: 12.65114) QuantErr: 12.65114 batch_time=0.46415 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 4.26191 (QuantReg: 12.86043) QuantErr: 12.86043 batch_time=0.44046 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 4.59985 (QuantReg: 13.15664) QuantErr: 13.15664 batch_time=0.48338 
Train Epoch: 17 codebook_update_time=0.89893
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch17.pth ...
Done in 4.882s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch17.pth ...
Done in 9.979s
removing stale ckpt [epoch 16] [took 0.10s]
 epoch          : 17
 loss           : 5.172454194068909
 quant_reg      : 12.864629558563232
 quant_err      : 12.864629558563232
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.126
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.840898060391126
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9435
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.89818157933313
 mnt_best       : 41.840898060391126
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 4.95954 (QuantReg: 12.55362) QuantErr: 12.55362 batch_time=36.57540 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 4.80784 (QuantReg: 12.87540) QuantErr: 12.87540 batch_time=0.47005 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 5.89837 (QuantReg: 12.84291) QuantErr: 12.84291 batch_time=0.44531 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 5.00528 (QuantReg: 13.12797) QuantErr: 13.12797 batch_time=0.45362 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 6.25172 (QuantReg: 12.95459) QuantErr: 12.95459 batch_time=0.44669 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 6.19726 (QuantReg: 12.70006) QuantErr: 12.70006 batch_time=0.42683 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 6.08030 (QuantReg: 12.87752) QuantErr: 12.87752 batch_time=0.53405 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 5.87493 (QuantReg: 13.34417) QuantErr: 13.34417 batch_time=0.43731 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 4.77198 (QuantReg: 13.22663) QuantErr: 13.22663 batch_time=0.49694 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 6.34516 (QuantReg: 12.42311) QuantErr: 12.42311 batch_time=0.67007 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 3.77899 (QuantReg: 13.00386) QuantErr: 13.00386 batch_time=0.50274 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 5.36833 (QuantReg: 12.99224) QuantErr: 12.99224 batch_time=0.46007 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 4.29227 (QuantReg: 13.15481) QuantErr: 13.15481 batch_time=0.46231 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 4.22272 (QuantReg: 12.75667) QuantErr: 12.75667 batch_time=0.44981 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 5.25625 (QuantReg: 13.10066) QuantErr: 13.10066 batch_time=0.46246 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 5.15408 (QuantReg: 13.27261) QuantErr: 13.27261 batch_time=0.44804 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 4.47825 (QuantReg: 13.16567) QuantErr: 13.16567 batch_time=0.47126 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 6.92678 (QuantReg: 12.91647) QuantErr: 12.91647 batch_time=0.46630 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 5.54290 (QuantReg: 13.02566) QuantErr: 13.02566 batch_time=0.44287 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 5.86957 (QuantReg: 12.90027) QuantErr: 12.90027 batch_time=0.44541 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 5.13737 (QuantReg: 12.94506) QuantErr: 12.94506 batch_time=0.42813 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 4.60280 (QuantReg: 12.85895) QuantErr: 12.85895 batch_time=0.45333 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 5.69484 (QuantReg: 12.86862) QuantErr: 12.86862 batch_time=0.45155 
Train Epoch: 18 codebook_update_time=0.84657
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch18.pth ...
Done in 4.961s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch18.pth ...
Done in 10.024s
removing stale ckpt [epoch 17] [took 0.02s]
 epoch          : 18
 loss           : 5.054880195617676
 quant_reg      : 12.974631008148194
 quant_err      : 12.974631008148194
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.9
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.96110685214228
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.48
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.771680577495054
 mnt_best       : 41.96110685214228
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 5.04807 (QuantReg: 12.72191) QuantErr: 12.72191 batch_time=31.50367 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 4.76501 (QuantReg: 13.05006) QuantErr: 13.05006 batch_time=0.42397 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 4.18486 (QuantReg: 12.72200) QuantErr: 12.72200 batch_time=0.42882 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 3.85611 (QuantReg: 13.22548) QuantErr: 13.22548 batch_time=0.73858 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 4.64414 (QuantReg: 12.99193) QuantErr: 12.99193 batch_time=0.43369 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 5.20969 (QuantReg: 13.00700) QuantErr: 13.00700 batch_time=0.43055 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 4.58974 (QuantReg: 13.11093) QuantErr: 13.11093 batch_time=0.44599 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 4.36976 (QuantReg: 12.81047) QuantErr: 12.81047 batch_time=0.43240 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 4.57177 (QuantReg: 12.64293) QuantErr: 12.64293 batch_time=0.42566 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 4.37840 (QuantReg: 13.01058) QuantErr: 13.01058 batch_time=0.47061 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 5.82476 (QuantReg: 12.97648) QuantErr: 12.97648 batch_time=0.49869 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 5.68190 (QuantReg: 13.04120) QuantErr: 13.04120 batch_time=0.44320 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 5.21025 (QuantReg: 13.00919) QuantErr: 13.00919 batch_time=0.46532 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 4.51230 (QuantReg: 12.87225) QuantErr: 12.87225 batch_time=0.43462 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 4.31006 (QuantReg: 13.27975) QuantErr: 13.27975 batch_time=0.43758 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 5.18265 (QuantReg: 12.95189) QuantErr: 12.95189 batch_time=0.44973 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 3.96763 (QuantReg: 13.22038) QuantErr: 13.22038 batch_time=0.45919 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 5.02620 (QuantReg: 12.95633) QuantErr: 12.95633 batch_time=1.01409 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 4.58592 (QuantReg: 13.03451) QuantErr: 13.03451 batch_time=0.48512 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 4.59246 (QuantReg: 12.70414) QuantErr: 12.70414 batch_time=0.46487 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 4.60097 (QuantReg: 12.66146) QuantErr: 12.66146 batch_time=0.42892 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 5.17558 (QuantReg: 13.29051) QuantErr: 13.29051 batch_time=0.42483 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 4.67630 (QuantReg: 12.74276) QuantErr: 12.74276 batch_time=0.44042 
Train Epoch: 19 codebook_update_time=0.83823
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch19.pth ...
Done in 4.863s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch19.pth ...
Done in 9.230s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 4.87741821193695
 quant_reg      : 12.965199855804443
 quant_err      : 12.965199855804443
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.316
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.60063478522458
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5045
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.53180868083627
 mnt_best       : 42.60063478522458
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 4.50616 (QuantReg: 12.73071) QuantErr: 12.73071 batch_time=29.85477 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 3.85363 (QuantReg: 12.86967) QuantErr: 12.86967 batch_time=3.25050 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 4.45669 (QuantReg: 13.14431) QuantErr: 13.14431 batch_time=0.43505 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 5.15186 (QuantReg: 12.57265) QuantErr: 12.57265 batch_time=0.44289 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 3.51453 (QuantReg: 13.14422) QuantErr: 13.14422 batch_time=0.57714 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 5.61030 (QuantReg: 12.52276) QuantErr: 12.52276 batch_time=0.46671 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 4.77840 (QuantReg: 12.88305) QuantErr: 12.88305 batch_time=0.47361 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 5.00023 (QuantReg: 12.92929) QuantErr: 12.92929 batch_time=0.42233 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 5.02400 (QuantReg: 12.89928) QuantErr: 12.89928 batch_time=0.50829 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 3.75639 (QuantReg: 12.72473) QuantErr: 12.72473 batch_time=0.43156 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 4.78271 (QuantReg: 12.98439) QuantErr: 12.98439 batch_time=0.46351 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 4.54293 (QuantReg: 12.75897) QuantErr: 12.75897 batch_time=0.44219 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 5.17277 (QuantReg: 12.65508) QuantErr: 12.65508 batch_time=0.46171 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 4.25419 (QuantReg: 13.00579) QuantErr: 13.00579 batch_time=0.67411 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 3.89762 (QuantReg: 12.81231) QuantErr: 12.81231 batch_time=0.48215 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 4.81971 (QuantReg: 13.04761) QuantErr: 13.04761 batch_time=0.45264 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 3.98818 (QuantReg: 12.95870) QuantErr: 12.95870 batch_time=0.45991 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 3.30390 (QuantReg: 13.06376) QuantErr: 13.06376 batch_time=0.44171 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 4.73925 (QuantReg: 13.08417) QuantErr: 13.08417 batch_time=0.83226 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 4.33300 (QuantReg: 13.11521) QuantErr: 13.11521 batch_time=0.46418 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 5.28011 (QuantReg: 12.81947) QuantErr: 12.81947 batch_time=0.44649 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 4.26629 (QuantReg: 12.89762) QuantErr: 12.89762 batch_time=0.43499 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 5.34730 (QuantReg: 12.86498) QuantErr: 12.86498 batch_time=0.46612 
Train Epoch: 20 codebook_update_time=0.85174
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch20.pth ...
Done in 4.911s
removing stale ckpt [epoch 19] [took 0.03s]
 epoch          : 20
 loss           : 4.814473134040832
 quant_reg      : 12.93004189300537
 quant_err      : 12.93004189300537
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.195
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.11460761461988
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.764
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.287577459732006
 mnt_best       : 42.60063478522458
 not_improved_count: 1
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 4.76147 (QuantReg: 13.16501) QuantErr: 13.16501 batch_time=41.58329 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 5.57369 (QuantReg: 12.83119) QuantErr: 12.83119 batch_time=0.42640 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 4.40042 (QuantReg: 13.12601) QuantErr: 13.12601 batch_time=0.45411 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 4.99796 (QuantReg: 12.87313) QuantErr: 12.87313 batch_time=0.47128 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 5.67577 (QuantReg: 13.07737) QuantErr: 13.07737 batch_time=0.49324 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 4.62681 (QuantReg: 13.06971) QuantErr: 13.06971 batch_time=0.43211 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 4.35605 (QuantReg: 12.76152) QuantErr: 12.76152 batch_time=0.45426 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 5.15195 (QuantReg: 12.83158) QuantErr: 12.83158 batch_time=0.48850 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 4.29900 (QuantReg: 13.15220) QuantErr: 13.15220 batch_time=0.42626 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 5.30143 (QuantReg: 13.16594) QuantErr: 13.16594 batch_time=0.43214 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 5.25013 (QuantReg: 12.70299) QuantErr: 12.70299 batch_time=0.44523 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 3.62319 (QuantReg: 13.10191) QuantErr: 13.10191 batch_time=0.44109 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 4.00673 (QuantReg: 12.92475) QuantErr: 12.92475 batch_time=0.43219 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 4.24455 (QuantReg: 13.23232) QuantErr: 13.23232 batch_time=0.44633 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 5.19240 (QuantReg: 12.83046) QuantErr: 12.83046 batch_time=0.42650 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 4.48746 (QuantReg: 12.62487) QuantErr: 12.62487 batch_time=0.44024 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 4.57293 (QuantReg: 12.84906) QuantErr: 12.84906 batch_time=0.42426 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 4.25334 (QuantReg: 12.79187) QuantErr: 12.79187 batch_time=0.44266 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 3.95149 (QuantReg: 13.37616) QuantErr: 13.37616 batch_time=0.43531 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 3.87736 (QuantReg: 13.47160) QuantErr: 13.47160 batch_time=0.45700 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 3.67930 (QuantReg: 13.49437) QuantErr: 13.49437 batch_time=0.75953 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 5.72429 (QuantReg: 12.64180) QuantErr: 12.64180 batch_time=0.45835 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 5.14810 (QuantReg: 13.00548) QuantErr: 13.00548 batch_time=0.44578 
Train Epoch: 21 codebook_update_time=1.12666
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch21.pth ...
Done in 8.279s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch21.pth ...
Done in 13.375s
removing stale ckpt [epoch 20] [took 0.07s]
 epoch          : 21
 loss           : 4.689449731826782
 quant_reg      : 12.983920379638672
 quant_err      : 12.983920379638672
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.897
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.207191875342566
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.271
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.985328441726594
 mnt_best       : 43.207191875342566
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 4.86708 (QuantReg: 12.71881) QuantErr: 12.71881 batch_time=41.47292 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 4.07355 (QuantReg: 12.96157) QuantErr: 12.96157 batch_time=0.47399 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 4.61792 (QuantReg: 12.95725) QuantErr: 12.95725 batch_time=0.44153 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 4.44501 (QuantReg: 12.93736) QuantErr: 12.93736 batch_time=0.43495 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 4.64762 (QuantReg: 12.86493) QuantErr: 12.86493 batch_time=0.43157 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 4.92596 (QuantReg: 12.52286) QuantErr: 12.52286 batch_time=0.45478 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 4.23347 (QuantReg: 12.71707) QuantErr: 12.71707 batch_time=0.43899 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 4.38909 (QuantReg: 13.22679) QuantErr: 13.22679 batch_time=0.70317 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 4.97392 (QuantReg: 13.07362) QuantErr: 13.07362 batch_time=0.44238 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 3.71090 (QuantReg: 13.21698) QuantErr: 13.21698 batch_time=0.44269 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 5.04715 (QuantReg: 12.28675) QuantErr: 12.28675 batch_time=0.52479 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 4.43791 (QuantReg: 12.66299) QuantErr: 12.66299 batch_time=0.45810 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 4.41488 (QuantReg: 13.07371) QuantErr: 13.07371 batch_time=0.46044 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 4.49306 (QuantReg: 12.90692) QuantErr: 12.90692 batch_time=0.45228 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 4.46322 (QuantReg: 12.97129) QuantErr: 12.97129 batch_time=0.49329 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 4.85821 (QuantReg: 13.22548) QuantErr: 13.22548 batch_time=0.43677 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 3.79552 (QuantReg: 13.23802) QuantErr: 13.23802 batch_time=0.44009 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 4.35840 (QuantReg: 12.86662) QuantErr: 12.86662 batch_time=0.42519 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 5.24447 (QuantReg: 13.00283) QuantErr: 13.00283 batch_time=0.42852 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 5.70620 (QuantReg: 12.53110) QuantErr: 12.53110 batch_time=1.01378 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 4.18980 (QuantReg: 13.20555) QuantErr: 13.20555 batch_time=0.76750 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 4.34715 (QuantReg: 13.00266) QuantErr: 13.00266 batch_time=0.45311 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 4.29965 (QuantReg: 13.00274) QuantErr: 13.00274 batch_time=0.44171 
Train Epoch: 22 codebook_update_time=0.84449
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch22.pth ...
Done in 5.412s
removing stale ckpt [epoch 21] [took 0.02s]
 epoch          : 22
 loss           : 4.69668568611145
 quant_reg      : 12.987244800567627
 quant_err      : 12.987244800567627
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.075
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.109698274947846
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.868
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.53517144915099
 mnt_best       : 43.207191875342566
 not_improved_count: 1
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 5.10349 (QuantReg: 12.86542) QuantErr: 12.86542 batch_time=44.06253 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 3.76756 (QuantReg: 12.70851) QuantErr: 12.70851 batch_time=0.43961 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 4.71167 (QuantReg: 12.95123) QuantErr: 12.95123 batch_time=0.44202 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 4.55952 (QuantReg: 13.34715) QuantErr: 13.34715 batch_time=0.44599 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 4.47351 (QuantReg: 12.83783) QuantErr: 12.83783 batch_time=0.46036 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 3.81189 (QuantReg: 12.80031) QuantErr: 12.80031 batch_time=0.43325 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 5.30512 (QuantReg: 12.55443) QuantErr: 12.55443 batch_time=0.42989 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 6.12491 (QuantReg: 13.05423) QuantErr: 13.05423 batch_time=0.44577 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 3.54807 (QuantReg: 13.29140) QuantErr: 13.29140 batch_time=0.46002 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 3.84277 (QuantReg: 13.13380) QuantErr: 13.13380 batch_time=0.44984 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 5.62731 (QuantReg: 13.22274) QuantErr: 13.22274 batch_time=0.46345 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 5.01426 (QuantReg: 13.27245) QuantErr: 13.27245 batch_time=0.46018 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 5.05183 (QuantReg: 13.24140) QuantErr: 13.24140 batch_time=0.57040 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 4.94059 (QuantReg: 13.02268) QuantErr: 13.02268 batch_time=0.42444 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 4.62631 (QuantReg: 12.79541) QuantErr: 12.79541 batch_time=0.46746 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 5.02241 (QuantReg: 12.75648) QuantErr: 12.75648 batch_time=0.45143 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 4.55998 (QuantReg: 13.33311) QuantErr: 13.33311 batch_time=0.47211 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 4.68469 (QuantReg: 13.12772) QuantErr: 13.12772 batch_time=0.46990 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 4.49879 (QuantReg: 13.10911) QuantErr: 13.10911 batch_time=0.46040 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 4.26752 (QuantReg: 13.00703) QuantErr: 13.00703 batch_time=0.42834 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 4.87628 (QuantReg: 12.89265) QuantErr: 12.89265 batch_time=0.42304 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 4.58338 (QuantReg: 12.70638) QuantErr: 12.70638 batch_time=0.47690 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 4.25829 (QuantReg: 12.63008) QuantErr: 12.63008 batch_time=0.46098 
Train Epoch: 23 codebook_update_time=1.18299
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch23.pth ...
Done in 5.301s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 4.579397652626038
 quant_reg      : 13.006142623901367
 quant_err      : 13.006142623901367
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.871
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.78057755605002
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.308
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.90133193690266
 mnt_best       : 43.207191875342566
 not_improved_count: 2
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 3.44578 (QuantReg: 12.86208) QuantErr: 12.86208 batch_time=35.62977 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 5.35564 (QuantReg: 12.97879) QuantErr: 12.97879 batch_time=0.43438 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 4.81188 (QuantReg: 13.04755) QuantErr: 13.04755 batch_time=0.42924 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 4.77512 (QuantReg: 12.87289) QuantErr: 12.87289 batch_time=0.44241 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 4.17133 (QuantReg: 12.85674) QuantErr: 12.85674 batch_time=0.42355 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 4.76987 (QuantReg: 13.16397) QuantErr: 13.16397 batch_time=0.44966 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 5.00406 (QuantReg: 12.94151) QuantErr: 12.94151 batch_time=2.03637 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 4.03477 (QuantReg: 13.30911) QuantErr: 13.30911 batch_time=0.42299 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 5.96271 (QuantReg: 12.67406) QuantErr: 12.67406 batch_time=0.44370 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 3.84579 (QuantReg: 13.04860) QuantErr: 13.04860 batch_time=0.45926 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 4.43780 (QuantReg: 12.98804) QuantErr: 12.98804 batch_time=0.47665 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 3.92742 (QuantReg: 13.32212) QuantErr: 13.32212 batch_time=0.45770 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 4.64277 (QuantReg: 13.25484) QuantErr: 13.25484 batch_time=0.45007 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 4.14365 (QuantReg: 13.04932) QuantErr: 13.04932 batch_time=0.45509 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 5.12845 (QuantReg: 12.92107) QuantErr: 12.92107 batch_time=0.50994 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 4.54215 (QuantReg: 12.81945) QuantErr: 12.81945 batch_time=0.81534 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 4.59643 (QuantReg: 12.78768) QuantErr: 12.78768 batch_time=0.44411 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 4.85555 (QuantReg: 13.23333) QuantErr: 13.23333 batch_time=0.44452 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 4.26647 (QuantReg: 12.90567) QuantErr: 12.90567 batch_time=0.44302 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 6.25067 (QuantReg: 12.96422) QuantErr: 12.96422 batch_time=0.50685 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 6.01355 (QuantReg: 12.79941) QuantErr: 12.79941 batch_time=0.43713 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 3.56414 (QuantReg: 13.04892) QuantErr: 13.04892 batch_time=0.43405 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 4.33386 (QuantReg: 13.03440) QuantErr: 13.03440 batch_time=0.65399 
Train Epoch: 24 codebook_update_time=0.81478
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch24.pth ...
Done in 5.225s
removing stale ckpt [epoch 23] [took 0.02s]
 epoch          : 24
 loss           : 4.509072232246399
 quant_reg      : 13.025783012390137
 quant_err      : 13.025783012390137
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.206
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.83406828348606
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4105
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.34908181653176
 mnt_best       : 43.207191875342566
 not_improved_count: 3
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 5.36152 (QuantReg: 13.04125) QuantErr: 13.04125 batch_time=32.74510 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 3.90924 (QuantReg: 12.92066) QuantErr: 12.92066 batch_time=0.45129 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 5.21134 (QuantReg: 12.95339) QuantErr: 12.95339 batch_time=0.46971 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 4.18926 (QuantReg: 13.00147) QuantErr: 13.00147 batch_time=0.43850 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 4.36391 (QuantReg: 12.91921) QuantErr: 12.91921 batch_time=0.46385 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 3.74219 (QuantReg: 12.84016) QuantErr: 12.84016 batch_time=0.44789 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 5.19320 (QuantReg: 12.89090) QuantErr: 12.89090 batch_time=2.80065 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 4.38642 (QuantReg: 12.93830) QuantErr: 12.93830 batch_time=0.47515 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 3.83222 (QuantReg: 13.07945) QuantErr: 13.07945 batch_time=0.45209 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 5.23584 (QuantReg: 12.65398) QuantErr: 12.65398 batch_time=0.44373 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 4.48167 (QuantReg: 13.07000) QuantErr: 13.07000 batch_time=0.42749 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 4.81551 (QuantReg: 13.09691) QuantErr: 13.09691 batch_time=0.52476 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 4.16357 (QuantReg: 13.07425) QuantErr: 13.07425 batch_time=0.49527 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 4.09965 (QuantReg: 13.08258) QuantErr: 13.08258 batch_time=0.47958 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 4.48733 (QuantReg: 12.89671) QuantErr: 12.89671 batch_time=0.48388 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 4.23478 (QuantReg: 12.92713) QuantErr: 12.92713 batch_time=0.49729 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 4.19526 (QuantReg: 13.08818) QuantErr: 13.08818 batch_time=0.44623 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 5.36167 (QuantReg: 12.67516) QuantErr: 12.67516 batch_time=0.44474 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 3.39748 (QuantReg: 13.26870) QuantErr: 13.26870 batch_time=0.44913 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 4.88275 (QuantReg: 12.84040) QuantErr: 12.84040 batch_time=0.44159 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 3.81798 (QuantReg: 13.10712) QuantErr: 13.10712 batch_time=0.44957 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 4.39006 (QuantReg: 12.91769) QuantErr: 12.91769 batch_time=0.44638 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 5.20975 (QuantReg: 12.95281) QuantErr: 12.95281 batch_time=0.45487 
Train Epoch: 25 codebook_update_time=0.84380
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch25.pth ...
Done in 4.941s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch25.pth ...
Done in 11.900s
removing stale ckpt [epoch 24] [took 0.02s]
 epoch          : 25
 loss           : 4.406893030166626
 quant_reg      : 13.003486122131347
 quant_err      : 13.003486122131347
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.873
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.45741373210223
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.865
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.84367286586231
 mnt_best       : 43.45741373210223
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 4.25900 (QuantReg: 12.90572) QuantErr: 12.90572 batch_time=35.37370 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 4.68775 (QuantReg: 12.99910) QuantErr: 12.99910 batch_time=0.42720 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 4.96512 (QuantReg: 12.90489) QuantErr: 12.90489 batch_time=0.44071 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 3.99600 (QuantReg: 13.08354) QuantErr: 13.08354 batch_time=0.47870 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 4.22609 (QuantReg: 13.45271) QuantErr: 13.45271 batch_time=0.43680 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 4.60609 (QuantReg: 12.90597) QuantErr: 12.90597 batch_time=0.43311 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 3.66737 (QuantReg: 13.14900) QuantErr: 13.14900 batch_time=0.49210 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 3.98933 (QuantReg: 13.35644) QuantErr: 13.35644 batch_time=0.43611 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 4.64476 (QuantReg: 12.86830) QuantErr: 12.86830 batch_time=0.44208 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 3.90961 (QuantReg: 12.97507) QuantErr: 12.97507 batch_time=0.48851 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 4.62170 (QuantReg: 13.03367) QuantErr: 13.03367 batch_time=0.43177 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 4.64468 (QuantReg: 13.21065) QuantErr: 13.21065 batch_time=0.44700 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 3.42025 (QuantReg: 13.45732) QuantErr: 13.45732 batch_time=0.44028 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 4.04793 (QuantReg: 12.92666) QuantErr: 12.92666 batch_time=0.47063 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 4.60790 (QuantReg: 12.99869) QuantErr: 12.99869 batch_time=0.58160 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 4.67708 (QuantReg: 12.98005) QuantErr: 12.98005 batch_time=0.46783 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 4.06480 (QuantReg: 12.79695) QuantErr: 12.79695 batch_time=0.45130 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 4.96895 (QuantReg: 13.39069) QuantErr: 13.39069 batch_time=0.45105 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 4.06650 (QuantReg: 13.15265) QuantErr: 13.15265 batch_time=0.47139 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 3.44815 (QuantReg: 13.27710) QuantErr: 13.27710 batch_time=0.44652 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 5.25472 (QuantReg: 13.05313) QuantErr: 13.05313 batch_time=0.43901 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 3.33377 (QuantReg: 13.25724) QuantErr: 13.25724 batch_time=0.43769 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 4.20391 (QuantReg: 13.26749) QuantErr: 13.26749 batch_time=0.43419 
Train Epoch: 26 codebook_update_time=0.84583
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch26.pth ...
Done in 5.274s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch26.pth ...
Done in 11.026s
removing stale ckpt [epoch 25] [took 0.01s]
 epoch          : 26
 loss           : 4.309570976257325
 quant_reg      : 13.071101169586182
 quant_err      : 13.071101169586182
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.886
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.881651656683495
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3555
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.50070054872758
 mnt_best       : 43.881651656683495
 not_improved_count: 0
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 5.00699 (QuantReg: 13.22986) QuantErr: 13.22986 batch_time=34.84549 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 3.02159 (QuantReg: 13.00742) QuantErr: 13.00742 batch_time=0.46891 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 4.86167 (QuantReg: 12.83872) QuantErr: 12.83872 batch_time=0.42863 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 4.82614 (QuantReg: 13.12025) QuantErr: 13.12025 batch_time=0.43232 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 5.39827 (QuantReg: 13.20188) QuantErr: 13.20188 batch_time=0.43533 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 4.88862 (QuantReg: 12.91836) QuantErr: 12.91836 batch_time=0.47086 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 3.99190 (QuantReg: 13.35091) QuantErr: 13.35091 batch_time=0.44597 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 4.75182 (QuantReg: 13.45000) QuantErr: 13.45000 batch_time=0.44742 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 4.96135 (QuantReg: 13.04970) QuantErr: 13.04970 batch_time=0.42819 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 4.52078 (QuantReg: 12.87032) QuantErr: 12.87032 batch_time=0.45421 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 3.85156 (QuantReg: 13.17297) QuantErr: 13.17297 batch_time=0.48925 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 5.81575 (QuantReg: 13.02986) QuantErr: 13.02986 batch_time=0.47878 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 4.88862 (QuantReg: 13.15157) QuantErr: 13.15157 batch_time=0.81618 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 4.61894 (QuantReg: 13.15060) QuantErr: 13.15060 batch_time=1.22800 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 4.73955 (QuantReg: 12.78048) QuantErr: 12.78048 batch_time=0.44775 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 5.36397 (QuantReg: 12.95496) QuantErr: 12.95496 batch_time=0.44569 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 4.55359 (QuantReg: 12.79795) QuantErr: 12.79795 batch_time=0.45193 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 3.72094 (QuantReg: 13.40284) QuantErr: 13.40284 batch_time=0.48943 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 3.95722 (QuantReg: 13.41175) QuantErr: 13.41175 batch_time=0.82478 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 3.88339 (QuantReg: 13.12042) QuantErr: 13.12042 batch_time=0.43462 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 3.57315 (QuantReg: 13.50194) QuantErr: 13.50194 batch_time=0.48096 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 3.70389 (QuantReg: 13.30128) QuantErr: 13.30128 batch_time=0.44332 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 4.48160 (QuantReg: 13.48236) QuantErr: 13.48236 batch_time=0.44235 
Train Epoch: 27 codebook_update_time=1.37893
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch27.pth ...
Done in 4.344s
removing stale ckpt [epoch 26] [took 0.04s]
 epoch          : 27
 loss           : 4.32316312122345
 quant_reg      : 13.101397861480713
 quant_err      : 13.101397861480713
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.616
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.23143859207485
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5095
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.65843955056259
 mnt_best       : 43.881651656683495
 not_improved_count: 1
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 5.34290 (QuantReg: 12.58771) QuantErr: 12.58771 batch_time=28.93976 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 4.52563 (QuantReg: 13.15538) QuantErr: 13.15538 batch_time=0.44122 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 3.92132 (QuantReg: 13.32218) QuantErr: 13.32218 batch_time=0.44441 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 4.46665 (QuantReg: 12.80011) QuantErr: 12.80011 batch_time=0.44140 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 4.10261 (QuantReg: 13.10519) QuantErr: 13.10519 batch_time=0.46916 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 4.82200 (QuantReg: 13.23846) QuantErr: 13.23846 batch_time=0.45051 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 3.99573 (QuantReg: 13.43877) QuantErr: 13.43877 batch_time=1.04251 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 4.39416 (QuantReg: 12.92384) QuantErr: 12.92384 batch_time=0.45349 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 4.69052 (QuantReg: 12.90966) QuantErr: 12.90966 batch_time=0.44294 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 4.00068 (QuantReg: 13.16316) QuantErr: 13.16316 batch_time=0.43559 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 3.73332 (QuantReg: 13.11375) QuantErr: 13.11375 batch_time=0.44235 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 3.73352 (QuantReg: 13.38760) QuantErr: 13.38760 batch_time=0.48652 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 4.16128 (QuantReg: 13.01556) QuantErr: 13.01556 batch_time=4.91645 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 2.87506 (QuantReg: 13.36718) QuantErr: 13.36718 batch_time=0.44930 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 4.57858 (QuantReg: 12.60286) QuantErr: 12.60286 batch_time=0.43929 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 4.05548 (QuantReg: 13.41159) QuantErr: 13.41159 batch_time=0.44317 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 3.58665 (QuantReg: 13.24169) QuantErr: 13.24169 batch_time=0.44766 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 3.77618 (QuantReg: 13.47890) QuantErr: 13.47890 batch_time=0.44756 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 3.72182 (QuantReg: 13.09789) QuantErr: 13.09789 batch_time=0.46351 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 3.69218 (QuantReg: 13.43086) QuantErr: 13.43086 batch_time=0.43871 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 3.35602 (QuantReg: 13.28283) QuantErr: 13.28283 batch_time=1.42849 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 4.02142 (QuantReg: 13.13557) QuantErr: 13.13557 batch_time=0.47509 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 4.24563 (QuantReg: 13.06473) QuantErr: 13.06473 batch_time=0.44909 
Train Epoch: 28 codebook_update_time=0.92989
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch28.pth ...
Done in 20.911s
removing stale ckpt [epoch 27] [took 0.09s]
 epoch          : 28
 loss           : 4.217551645278931
 quant_reg      : 13.118123683929444
 quant_err      : 13.118123683929444
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.546
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.275081623855954
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.893
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.773905935237686
 mnt_best       : 43.881651656683495
 not_improved_count: 2
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 5.44902 (QuantReg: 13.12581) QuantErr: 13.12581 batch_time=33.35468 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 4.46408 (QuantReg: 13.02283) QuantErr: 13.02283 batch_time=0.88913 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 3.34536 (QuantReg: 12.97454) QuantErr: 12.97454 batch_time=0.48518 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 3.50018 (QuantReg: 13.09963) QuantErr: 13.09963 batch_time=0.47078 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 3.35227 (QuantReg: 13.29046) QuantErr: 13.29046 batch_time=0.45471 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 3.91179 (QuantReg: 13.17834) QuantErr: 13.17834 batch_time=0.44543 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 4.63488 (QuantReg: 13.32628) QuantErr: 13.32628 batch_time=0.44029 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 4.38371 (QuantReg: 13.32433) QuantErr: 13.32433 batch_time=0.48397 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 3.39432 (QuantReg: 13.10473) QuantErr: 13.10473 batch_time=0.47039 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 3.61378 (QuantReg: 12.89259) QuantErr: 12.89259 batch_time=0.44211 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 3.41214 (QuantReg: 13.16771) QuantErr: 13.16771 batch_time=0.89826 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 4.08223 (QuantReg: 13.34388) QuantErr: 13.34388 batch_time=0.43924 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 4.34140 (QuantReg: 13.04219) QuantErr: 13.04219 batch_time=3.29863 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 3.87614 (QuantReg: 12.97189) QuantErr: 12.97189 batch_time=0.46505 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 4.14568 (QuantReg: 13.12063) QuantErr: 13.12063 batch_time=1.16586 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 4.78743 (QuantReg: 13.00544) QuantErr: 13.00544 batch_time=0.44020 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 3.47408 (QuantReg: 13.19027) QuantErr: 13.19027 batch_time=0.45118 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 4.12528 (QuantReg: 13.03282) QuantErr: 13.03282 batch_time=0.56573 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 4.16077 (QuantReg: 12.85647) QuantErr: 12.85647 batch_time=0.44430 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 3.03215 (QuantReg: 13.21845) QuantErr: 13.21845 batch_time=0.45721 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 4.18612 (QuantReg: 13.04363) QuantErr: 13.04363 batch_time=0.44023 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 3.86928 (QuantReg: 13.21188) QuantErr: 13.21188 batch_time=0.45366 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 3.83783 (QuantReg: 13.36797) QuantErr: 13.36797 batch_time=0.50869 
Train Epoch: 29 codebook_update_time=0.91342
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch29.pth ...
Done in 4.931s
removing stale ckpt [epoch 28] [took 0.02s]
 epoch          : 29
 loss           : 4.200164947509766
 quant_reg      : 13.106555030822754
 quant_err      : 13.106555030822754
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.163
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.54536264020491
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.513
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.49610174709237
 mnt_best       : 43.881651656683495
 not_improved_count: 3
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 4.70562 (QuantReg: 13.33061) QuantErr: 13.33061 batch_time=34.79832 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 4.32829 (QuantReg: 13.10240) QuantErr: 13.10240 batch_time=0.47355 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 3.70512 (QuantReg: 13.21813) QuantErr: 13.21813 batch_time=0.46373 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 4.14746 (QuantReg: 13.30759) QuantErr: 13.30759 batch_time=0.45525 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 4.95168 (QuantReg: 13.09747) QuantErr: 13.09747 batch_time=0.43950 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 4.02521 (QuantReg: 12.88527) QuantErr: 12.88527 batch_time=0.45067 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 6.11432 (QuantReg: 12.77787) QuantErr: 12.77787 batch_time=1.69171 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 4.22182 (QuantReg: 12.95537) QuantErr: 12.95537 batch_time=0.44344 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 4.31890 (QuantReg: 13.02674) QuantErr: 13.02674 batch_time=0.80725 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 5.09806 (QuantReg: 12.80602) QuantErr: 12.80602 batch_time=0.44396 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 3.30010 (QuantReg: 13.26707) QuantErr: 13.26707 batch_time=0.51821 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 5.36311 (QuantReg: 13.13258) QuantErr: 13.13258 batch_time=0.47075 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 3.42448 (QuantReg: 13.06399) QuantErr: 13.06399 batch_time=0.45568 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 4.64508 (QuantReg: 13.30156) QuantErr: 13.30156 batch_time=0.45197 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 3.55947 (QuantReg: 13.30845) QuantErr: 13.30845 batch_time=0.45239 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 3.58700 (QuantReg: 13.07532) QuantErr: 13.07532 batch_time=0.56538 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 4.36937 (QuantReg: 13.12653) QuantErr: 13.12653 batch_time=0.46412 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 3.46847 (QuantReg: 13.33447) QuantErr: 13.33447 batch_time=0.45805 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 3.62394 (QuantReg: 13.08215) QuantErr: 13.08215 batch_time=0.99006 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 3.80868 (QuantReg: 13.14495) QuantErr: 13.14495 batch_time=0.46739 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 3.40191 (QuantReg: 13.26927) QuantErr: 13.26927 batch_time=0.90367 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 4.45408 (QuantReg: 13.28616) QuantErr: 13.28616 batch_time=0.49928 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 4.24481 (QuantReg: 13.41148) QuantErr: 13.41148 batch_time=0.46511 
Train Epoch: 30 codebook_update_time=1.10185
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch30.pth ...
Done in 5.471s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 4.173004604339599
 quant_reg      : 13.139109519958495
 quant_err      : 13.139109519958495
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.57
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.9789115991373
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9985
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.49610174709237
 mnt_best       : 43.881651656683495
 not_improved_count: 4
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 4.33617 (QuantReg: 13.02500) QuantErr: 13.02500 batch_time=37.56381 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 4.41131 (QuantReg: 13.31414) QuantErr: 13.31414 batch_time=0.42546 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 4.49273 (QuantReg: 12.82302) QuantErr: 12.82302 batch_time=0.44116 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 3.55523 (QuantReg: 13.38768) QuantErr: 13.38768 batch_time=0.46444 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 3.77807 (QuantReg: 12.83818) QuantErr: 12.83818 batch_time=0.46770 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 3.96029 (QuantReg: 13.14897) QuantErr: 13.14897 batch_time=0.45870 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 3.59683 (QuantReg: 13.12800) QuantErr: 13.12800 batch_time=0.46391 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 4.07155 (QuantReg: 13.31761) QuantErr: 13.31761 batch_time=0.46105 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 4.15712 (QuantReg: 13.12237) QuantErr: 13.12237 batch_time=0.54082 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 3.95533 (QuantReg: 13.23677) QuantErr: 13.23677 batch_time=0.85487 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 3.46977 (QuantReg: 13.11250) QuantErr: 13.11250 batch_time=0.48595 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 5.20765 (QuantReg: 13.07158) QuantErr: 13.07158 batch_time=0.44050 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 4.61410 (QuantReg: 13.22486) QuantErr: 13.22486 batch_time=0.42928 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 3.40867 (QuantReg: 13.10935) QuantErr: 13.10935 batch_time=0.44120 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 3.61497 (QuantReg: 12.94609) QuantErr: 12.94609 batch_time=0.46457 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 5.12074 (QuantReg: 13.11646) QuantErr: 13.11646 batch_time=0.42525 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 3.73680 (QuantReg: 13.04643) QuantErr: 13.04643 batch_time=0.53118 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 4.46525 (QuantReg: 13.10700) QuantErr: 13.10700 batch_time=0.45622 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 3.37840 (QuantReg: 13.38491) QuantErr: 13.38491 batch_time=0.43400 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 3.11891 (QuantReg: 13.43356) QuantErr: 13.43356 batch_time=0.43265 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 4.20946 (QuantReg: 13.17755) QuantErr: 13.17755 batch_time=0.44022 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 4.57644 (QuantReg: 12.83955) QuantErr: 12.83955 batch_time=0.42392 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 4.15245 (QuantReg: 13.06679) QuantErr: 13.06679 batch_time=0.49084 
Train Epoch: 31 codebook_update_time=0.92742
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch31.pth ...
Done in 5.465s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch31.pth ...
Done in 10.475s
removing stale ckpt [epoch 30] [took 0.02s]
 epoch          : 31
 loss           : 4.107770177841187
 quant_reg      : 13.148564262390137
 quant_err      : 13.148564262390137
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.801
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.94448059465503
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.9225
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.76756394104355
 mnt_best       : 43.94448059465503
 not_improved_count: 0
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 4.67723 (QuantReg: 13.03300) QuantErr: 13.03300 batch_time=34.95581 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 4.39000 (QuantReg: 12.84029) QuantErr: 12.84029 batch_time=1.28507 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 4.46622 (QuantReg: 12.89523) QuantErr: 12.89523 batch_time=0.45407 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 4.26604 (QuantReg: 13.20081) QuantErr: 13.20081 batch_time=0.82027 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 3.43288 (QuantReg: 13.21611) QuantErr: 13.21611 batch_time=0.48760 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 3.75624 (QuantReg: 13.10608) QuantErr: 13.10608 batch_time=0.43473 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 4.87630 (QuantReg: 13.03921) QuantErr: 13.03921 batch_time=0.99650 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 3.59310 (QuantReg: 13.41486) QuantErr: 13.41486 batch_time=0.48910 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 4.51667 (QuantReg: 13.58731) QuantErr: 13.58731 batch_time=2.49744 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 4.23436 (QuantReg: 12.91048) QuantErr: 12.91048 batch_time=0.48105 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 4.45705 (QuantReg: 12.95845) QuantErr: 12.95845 batch_time=0.44345 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 3.27815 (QuantReg: 13.37210) QuantErr: 13.37210 batch_time=0.44642 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 5.58796 (QuantReg: 13.30727) QuantErr: 13.30727 batch_time=1.11733 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 3.59793 (QuantReg: 13.13103) QuantErr: 13.13103 batch_time=0.44003 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 3.91211 (QuantReg: 12.96086) QuantErr: 12.96086 batch_time=0.44163 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 4.56069 (QuantReg: 13.10005) QuantErr: 13.10005 batch_time=0.43258 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 4.40067 (QuantReg: 13.15462) QuantErr: 13.15462 batch_time=0.46811 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 4.67345 (QuantReg: 13.24464) QuantErr: 13.24464 batch_time=0.45845 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 4.37413 (QuantReg: 13.29285) QuantErr: 13.29285 batch_time=0.46230 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 4.73066 (QuantReg: 13.01760) QuantErr: 13.01760 batch_time=0.48976 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 4.76391 (QuantReg: 12.98313) QuantErr: 12.98313 batch_time=0.58200 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 3.76834 (QuantReg: 13.33377) QuantErr: 13.33377 batch_time=0.47455 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 3.58344 (QuantReg: 13.05874) QuantErr: 13.05874 batch_time=0.98273 
Train Epoch: 32 codebook_update_time=0.93900
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch32.pth ...
Done in 4.742s
removing stale ckpt [epoch 31] [took 0.01s]
 epoch          : 32
 loss           : 4.098959429740906
 quant_reg      : 13.146970523834229
 quant_err      : 13.146970523834229
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.191
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.690248772504994
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.8605
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.431842565652566
 mnt_best       : 43.94448059465503
 not_improved_count: 1
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 4.90633 (QuantReg: 12.85189) QuantErr: 12.85189 batch_time=35.47291 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 4.28664 (QuantReg: 13.11135) QuantErr: 13.11135 batch_time=0.44474 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 3.08728 (QuantReg: 13.24670) QuantErr: 13.24670 batch_time=0.42955 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 3.26776 (QuantReg: 13.01621) QuantErr: 13.01621 batch_time=0.46440 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 4.46515 (QuantReg: 12.95996) QuantErr: 12.95996 batch_time=0.51874 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 3.78934 (QuantReg: 13.27181) QuantErr: 13.27181 batch_time=0.53337 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 5.10766 (QuantReg: 13.07662) QuantErr: 13.07662 batch_time=0.46479 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 4.67758 (QuantReg: 12.89342) QuantErr: 12.89342 batch_time=0.44044 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 4.22934 (QuantReg: 13.30225) QuantErr: 13.30225 batch_time=0.43587 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 3.45717 (QuantReg: 13.14707) QuantErr: 13.14707 batch_time=0.43728 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 4.44891 (QuantReg: 12.72414) QuantErr: 12.72414 batch_time=0.43722 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 2.90849 (QuantReg: 13.21773) QuantErr: 13.21773 batch_time=0.48185 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 3.43628 (QuantReg: 13.03094) QuantErr: 13.03094 batch_time=0.57564 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 4.39698 (QuantReg: 13.34841) QuantErr: 13.34841 batch_time=0.44261 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 4.00631 (QuantReg: 13.22105) QuantErr: 13.22105 batch_time=0.77795 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 4.77395 (QuantReg: 13.48788) QuantErr: 13.48788 batch_time=0.46834 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 4.42732 (QuantReg: 13.36558) QuantErr: 13.36558 batch_time=0.44201 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 3.59285 (QuantReg: 13.21356) QuantErr: 13.21356 batch_time=0.44776 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 3.75974 (QuantReg: 13.03408) QuantErr: 13.03408 batch_time=0.43133 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 3.89909 (QuantReg: 13.28235) QuantErr: 13.28235 batch_time=1.28076 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 3.60582 (QuantReg: 13.43575) QuantErr: 13.43575 batch_time=0.48215 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 4.03941 (QuantReg: 13.08672) QuantErr: 13.08672 batch_time=0.47448 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 4.41334 (QuantReg: 13.29336) QuantErr: 13.29336 batch_time=0.45246 
Train Epoch: 33 codebook_update_time=0.83031
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch33.pth ...
Done in 4.107s
removing stale ckpt [epoch 32] [took 0.01s]
 epoch          : 33
 loss           : 4.066647519111633
 quant_reg      : 13.158991527557372
 quant_err      : 13.158991527557372
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.999
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.658415653186175
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.583
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.87453942829
 mnt_best       : 43.94448059465503
 not_improved_count: 2
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 3.24965 (QuantReg: 13.15074) QuantErr: 13.15074 batch_time=30.95149 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 4.58027 (QuantReg: 13.27038) QuantErr: 13.27038 batch_time=0.43817 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 3.27273 (QuantReg: 13.27532) QuantErr: 13.27532 batch_time=0.47772 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 4.25334 (QuantReg: 12.96145) QuantErr: 12.96145 batch_time=0.44633 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 4.60228 (QuantReg: 13.44005) QuantErr: 13.44005 batch_time=0.46189 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 4.19336 (QuantReg: 13.34792) QuantErr: 13.34792 batch_time=0.46371 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 4.29957 (QuantReg: 12.80880) QuantErr: 12.80880 batch_time=0.68857 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 3.89931 (QuantReg: 13.29124) QuantErr: 13.29124 batch_time=0.45586 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 4.92071 (QuantReg: 13.13509) QuantErr: 13.13509 batch_time=0.42646 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 4.45562 (QuantReg: 13.03529) QuantErr: 13.03529 batch_time=0.50063 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 4.64892 (QuantReg: 12.70133) QuantErr: 12.70133 batch_time=0.42713 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 4.58166 (QuantReg: 13.03537) QuantErr: 13.03537 batch_time=0.42435 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 5.14847 (QuantReg: 13.22882) QuantErr: 13.22882 batch_time=0.47827 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 4.18748 (QuantReg: 13.18816) QuantErr: 13.18816 batch_time=0.99197 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 4.28662 (QuantReg: 13.27871) QuantErr: 13.27871 batch_time=0.44452 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 3.93149 (QuantReg: 13.15736) QuantErr: 13.15736 batch_time=0.46640 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 3.05759 (QuantReg: 13.29363) QuantErr: 13.29363 batch_time=0.43842 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 4.97004 (QuantReg: 12.67116) QuantErr: 12.67116 batch_time=0.44262 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 3.94441 (QuantReg: 13.24383) QuantErr: 13.24383 batch_time=0.44249 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 2.74353 (QuantReg: 13.29509) QuantErr: 13.29509 batch_time=0.46370 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 3.25689 (QuantReg: 12.87069) QuantErr: 12.87069 batch_time=0.45637 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 4.21461 (QuantReg: 13.25390) QuantErr: 13.25390 batch_time=0.47568 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 4.13181 (QuantReg: 13.36187) QuantErr: 13.36187 batch_time=0.45880 
Train Epoch: 34 codebook_update_time=0.84962
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch34.pth ...
Done in 4.630s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 4.084823477745056
 quant_reg      : 13.179073760986329
 quant_err      : 13.179073760986329
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.211
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.550049408469604
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.2465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.4339838833121
 mnt_best       : 43.94448059465503
 not_improved_count: 3
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 3.85819 (QuantReg: 13.34160) QuantErr: 13.34160 batch_time=34.50422 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 4.33124 (QuantReg: 12.86803) QuantErr: 12.86803 batch_time=0.44831 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 3.07257 (QuantReg: 13.48070) QuantErr: 13.48070 batch_time=0.46476 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 4.27002 (QuantReg: 13.11977) QuantErr: 13.11977 batch_time=0.49703 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 4.31356 (QuantReg: 12.99112) QuantErr: 12.99112 batch_time=0.94495 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 3.66173 (QuantReg: 13.55495) QuantErr: 13.55495 batch_time=0.43013 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 3.89433 (QuantReg: 13.28351) QuantErr: 13.28351 batch_time=0.43313 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 4.44774 (QuantReg: 12.98931) QuantErr: 12.98931 batch_time=0.54442 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 3.94026 (QuantReg: 12.98790) QuantErr: 12.98790 batch_time=0.45391 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 4.63505 (QuantReg: 13.14660) QuantErr: 13.14660 batch_time=1.58680 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 3.68591 (QuantReg: 13.11213) QuantErr: 13.11213 batch_time=0.45006 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 3.33218 (QuantReg: 13.24937) QuantErr: 13.24937 batch_time=0.43591 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 4.32039 (QuantReg: 13.14123) QuantErr: 13.14123 batch_time=0.46670 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 2.98900 (QuantReg: 13.39190) QuantErr: 13.39190 batch_time=0.54445 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 3.71824 (QuantReg: 13.04750) QuantErr: 13.04750 batch_time=0.43012 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 2.62622 (QuantReg: 13.42116) QuantErr: 13.42116 batch_time=0.43661 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 3.88984 (QuantReg: 13.22392) QuantErr: 13.22392 batch_time=0.45445 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 3.93502 (QuantReg: 13.36798) QuantErr: 13.36798 batch_time=0.43968 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 4.63915 (QuantReg: 13.19221) QuantErr: 13.19221 batch_time=0.49489 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 3.75332 (QuantReg: 12.99589) QuantErr: 12.99589 batch_time=0.72407 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 3.36831 (QuantReg: 13.22304) QuantErr: 13.22304 batch_time=0.45525 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 3.69899 (QuantReg: 13.31150) QuantErr: 13.31150 batch_time=0.80681 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 3.83246 (QuantReg: 13.12927) QuantErr: 13.12927 batch_time=0.45782 
Train Epoch: 35 codebook_update_time=0.84957
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch35.pth ...
Done in 4.078s
removing stale ckpt [epoch 34] [took 0.01s]
 epoch          : 35
 loss           : 4.0028467445373535
 quant_reg      : 13.187809314727783
 quant_err      : 13.187809314727783
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.515
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.795149689133076
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.611
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.847609766038964
 mnt_best       : 43.94448059465503
 not_improved_count: 4
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 4.15895 (QuantReg: 13.12667) QuantErr: 13.12667 batch_time=33.24805 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 4.45160 (QuantReg: 13.36919) QuantErr: 13.36919 batch_time=0.48589 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 4.21414 (QuantReg: 12.93178) QuantErr: 12.93178 batch_time=0.45649 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 4.04069 (QuantReg: 13.16801) QuantErr: 13.16801 batch_time=0.45052 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 4.25815 (QuantReg: 13.02699) QuantErr: 13.02699 batch_time=1.00036 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 4.00911 (QuantReg: 12.81868) QuantErr: 12.81868 batch_time=0.59379 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 3.38463 (QuantReg: 13.19815) QuantErr: 13.19815 batch_time=0.50901 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 3.76272 (QuantReg: 13.24086) QuantErr: 13.24086 batch_time=0.46524 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 3.55910 (QuantReg: 13.57048) QuantErr: 13.57048 batch_time=0.48229 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 3.96152 (QuantReg: 13.16762) QuantErr: 13.16762 batch_time=0.53444 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 3.56586 (QuantReg: 13.02743) QuantErr: 13.02743 batch_time=0.45328 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 3.31126 (QuantReg: 13.37657) QuantErr: 13.37657 batch_time=0.43832 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 3.29391 (QuantReg: 13.47902) QuantErr: 13.47902 batch_time=0.46090 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 4.40854 (QuantReg: 13.04013) QuantErr: 13.04013 batch_time=2.86543 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 5.13961 (QuantReg: 13.28844) QuantErr: 13.28844 batch_time=0.47183 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 3.64681 (QuantReg: 13.04757) QuantErr: 13.04757 batch_time=0.48329 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 4.38956 (QuantReg: 13.15353) QuantErr: 13.15353 batch_time=0.44327 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 4.06050 (QuantReg: 13.04431) QuantErr: 13.04431 batch_time=0.47292 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 4.56028 (QuantReg: 13.12911) QuantErr: 13.12911 batch_time=0.49472 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 4.23727 (QuantReg: 13.06275) QuantErr: 13.06275 batch_time=0.43205 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 4.55082 (QuantReg: 13.18274) QuantErr: 13.18274 batch_time=0.45628 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 4.51372 (QuantReg: 13.19525) QuantErr: 13.19525 batch_time=1.20401 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 4.80765 (QuantReg: 12.85211) QuantErr: 12.85211 batch_time=0.46706 
Train Epoch: 36 codebook_update_time=0.83462
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch36.pth ...
Done in 4.229s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch36.pth ...
Done in 7.982s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 4.044794028759003
 quant_reg      : 13.19408748626709
 quant_err      : 13.19408748626709
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.784
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.10536302511609
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3585
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.17285288711143
 mnt_best       : 44.10536302511609
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 4.26353 (QuantReg: 13.26923) QuantErr: 13.26923 batch_time=31.87118 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 3.73038 (QuantReg: 13.49043) QuantErr: 13.49043 batch_time=0.49272 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 4.15853 (QuantReg: 13.00103) QuantErr: 13.00103 batch_time=1.51989 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 4.42444 (QuantReg: 12.93064) QuantErr: 12.93064 batch_time=0.44789 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 4.44053 (QuantReg: 13.12949) QuantErr: 13.12949 batch_time=0.45233 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 4.12236 (QuantReg: 13.49846) QuantErr: 13.49846 batch_time=0.60334 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 4.82011 (QuantReg: 13.05801) QuantErr: 13.05801 batch_time=0.43281 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 3.26422 (QuantReg: 13.33527) QuantErr: 13.33527 batch_time=0.46999 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 4.41168 (QuantReg: 13.15397) QuantErr: 13.15397 batch_time=0.45438 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 4.40998 (QuantReg: 13.38610) QuantErr: 13.38610 batch_time=0.44653 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 3.66553 (QuantReg: 13.24727) QuantErr: 13.24727 batch_time=0.48798 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 3.17627 (QuantReg: 13.34135) QuantErr: 13.34135 batch_time=0.44470 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 3.81571 (QuantReg: 13.11406) QuantErr: 13.11406 batch_time=0.61135 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 4.13912 (QuantReg: 13.53972) QuantErr: 13.53972 batch_time=0.45029 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 4.01972 (QuantReg: 13.19540) QuantErr: 13.19540 batch_time=0.74637 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 4.75026 (QuantReg: 13.34272) QuantErr: 13.34272 batch_time=0.46763 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 3.18823 (QuantReg: 13.19263) QuantErr: 13.19263 batch_time=0.44680 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 4.17243 (QuantReg: 13.11819) QuantErr: 13.11819 batch_time=0.44629 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 4.87182 (QuantReg: 13.03111) QuantErr: 13.03111 batch_time=1.05936 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 3.42387 (QuantReg: 13.48442) QuantErr: 13.48442 batch_time=0.45669 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 4.46356 (QuantReg: 12.96685) QuantErr: 12.96685 batch_time=0.51233 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 4.63223 (QuantReg: 13.12014) QuantErr: 13.12014 batch_time=0.44229 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 3.68487 (QuantReg: 13.28976) QuantErr: 13.28976 batch_time=0.45246 
Train Epoch: 37 codebook_update_time=0.85678
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch37.pth ...
Done in 4.993s
removing stale ckpt [epoch 36] [took 0.01s]
 epoch          : 37
 loss           : 4.004217309951782
 quant_reg      : 13.229072380065919
 quant_err      : 13.229072380065919
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.205
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.93539865522527
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1235
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.39181733794845
 mnt_best       : 44.10536302511609
 not_improved_count: 1
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 3.93074 (QuantReg: 13.24021) QuantErr: 13.24021 batch_time=33.04335 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 2.86265 (QuantReg: 12.98243) QuantErr: 12.98243 batch_time=0.74466 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 4.07602 (QuantReg: 13.10355) QuantErr: 13.10355 batch_time=0.44088 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 5.27281 (QuantReg: 12.95067) QuantErr: 12.95067 batch_time=0.45121 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 3.33988 (QuantReg: 13.57118) QuantErr: 13.57118 batch_time=0.46449 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 3.71729 (QuantReg: 12.88944) QuantErr: 12.88944 batch_time=0.49195 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 4.34137 (QuantReg: 13.40707) QuantErr: 13.40707 batch_time=0.45722 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 4.30948 (QuantReg: 12.95940) QuantErr: 12.95940 batch_time=0.46058 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 3.24609 (QuantReg: 12.94591) QuantErr: 12.94591 batch_time=0.45734 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 3.42560 (QuantReg: 13.39578) QuantErr: 13.39578 batch_time=0.44768 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 3.24504 (QuantReg: 13.18829) QuantErr: 13.18829 batch_time=0.49705 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 3.95668 (QuantReg: 13.13361) QuantErr: 13.13361 batch_time=0.56956 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 4.49882 (QuantReg: 13.38134) QuantErr: 13.38134 batch_time=0.45856 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 4.44329 (QuantReg: 13.17561) QuantErr: 13.17561 batch_time=0.44195 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 3.44223 (QuantReg: 13.34347) QuantErr: 13.34347 batch_time=0.46696 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 3.80464 (QuantReg: 13.32627) QuantErr: 13.32627 batch_time=0.90630 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 4.11534 (QuantReg: 13.23231) QuantErr: 13.23231 batch_time=0.44525 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 4.14224 (QuantReg: 13.27775) QuantErr: 13.27775 batch_time=0.45604 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 4.86541 (QuantReg: 12.98279) QuantErr: 12.98279 batch_time=0.69208 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 3.57081 (QuantReg: 13.52238) QuantErr: 13.52238 batch_time=0.57337 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 4.75253 (QuantReg: 13.42401) QuantErr: 13.42401 batch_time=0.49730 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 3.80275 (QuantReg: 13.00884) QuantErr: 13.00884 batch_time=0.77683 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 3.92228 (QuantReg: 13.30924) QuantErr: 13.30924 batch_time=0.47949 
Train Epoch: 38 codebook_update_time=0.90831
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch38.pth ...
Done in 3.857s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch38.pth ...
Done in 8.121s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 4.0116503753662105
 quant_reg      : 13.233792896270751
 quant_err      : 13.233792896270751
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.368
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.38514910622487
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3355
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.49760032427425
 mnt_best       : 44.38514910622487
 not_improved_count: 0
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 4.63266 (QuantReg: 13.26715) QuantErr: 13.26715 batch_time=36.64966 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 3.67724 (QuantReg: 13.18542) QuantErr: 13.18542 batch_time=0.43318 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 4.90564 (QuantReg: 13.23123) QuantErr: 13.23123 batch_time=0.44388 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 4.55968 (QuantReg: 13.18833) QuantErr: 13.18833 batch_time=0.47426 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 3.30231 (QuantReg: 13.28850) QuantErr: 13.28850 batch_time=0.44353 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 3.72268 (QuantReg: 13.38920) QuantErr: 13.38920 batch_time=0.46139 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 4.12345 (QuantReg: 13.04974) QuantErr: 13.04974 batch_time=3.45578 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 4.71470 (QuantReg: 13.03055) QuantErr: 13.03055 batch_time=0.51229 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 3.69693 (QuantReg: 13.21242) QuantErr: 13.21242 batch_time=0.45942 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 4.40541 (QuantReg: 13.35270) QuantErr: 13.35270 batch_time=0.43768 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 3.91833 (QuantReg: 13.36750) QuantErr: 13.36750 batch_time=0.44975 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 3.33289 (QuantReg: 13.34221) QuantErr: 13.34221 batch_time=0.45476 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 3.45333 (QuantReg: 13.44346) QuantErr: 13.44346 batch_time=0.46342 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 4.26594 (QuantReg: 13.46964) QuantErr: 13.46964 batch_time=0.92045 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 3.98669 (QuantReg: 13.25327) QuantErr: 13.25327 batch_time=0.42878 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 4.35372 (QuantReg: 13.26632) QuantErr: 13.26632 batch_time=0.44261 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 3.48098 (QuantReg: 13.46509) QuantErr: 13.46509 batch_time=0.42656 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 4.26426 (QuantReg: 13.17749) QuantErr: 13.17749 batch_time=0.47322 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 4.96269 (QuantReg: 13.08004) QuantErr: 13.08004 batch_time=0.44511 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 3.63214 (QuantReg: 13.09920) QuantErr: 13.09920 batch_time=0.45033 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 3.80167 (QuantReg: 13.46015) QuantErr: 13.46015 batch_time=0.43580 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 3.59668 (QuantReg: 13.32897) QuantErr: 13.32897 batch_time=0.44700 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 2.79917 (QuantReg: 13.55328) QuantErr: 13.55328 batch_time=0.47802 
Train Epoch: 39 codebook_update_time=0.81666
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch39.pth ...
Done in 3.841s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 3.97578657245636
 quant_reg      : 13.251869415283203
 quant_err      : 13.251869415283203
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.253
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.14373005020141
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9875
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.89819562145054
 mnt_best       : 44.38514910622487
 not_improved_count: 1
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 4.26032 (QuantReg: 13.17135) QuantErr: 13.17135 batch_time=28.79831 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 3.55925 (QuantReg: 13.14803) QuantErr: 13.14803 batch_time=0.44643 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 4.44068 (QuantReg: 12.94053) QuantErr: 12.94053 batch_time=0.42206 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 3.16038 (QuantReg: 13.29395) QuantErr: 13.29395 batch_time=1.79536 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 4.34237 (QuantReg: 13.34435) QuantErr: 13.34435 batch_time=0.47598 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 4.00587 (QuantReg: 13.22531) QuantErr: 13.22531 batch_time=0.44534 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 4.32600 (QuantReg: 12.94837) QuantErr: 12.94837 batch_time=4.61481 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 3.80362 (QuantReg: 13.49365) QuantErr: 13.49365 batch_time=0.43587 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 3.37356 (QuantReg: 12.91775) QuantErr: 12.91775 batch_time=0.44009 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 3.11109 (QuantReg: 13.11106) QuantErr: 13.11106 batch_time=0.48798 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 4.37181 (QuantReg: 13.27873) QuantErr: 13.27873 batch_time=0.44708 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 3.59661 (QuantReg: 13.29431) QuantErr: 13.29431 batch_time=0.45461 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 4.05866 (QuantReg: 13.22486) QuantErr: 13.22486 batch_time=0.44496 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 3.71454 (QuantReg: 13.37257) QuantErr: 13.37257 batch_time=0.42887 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 4.30330 (QuantReg: 13.02552) QuantErr: 13.02552 batch_time=0.43538 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 3.79944 (QuantReg: 13.03294) QuantErr: 13.03294 batch_time=0.44211 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 4.18580 (QuantReg: 12.75739) QuantErr: 12.75739 batch_time=0.46858 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 4.40986 (QuantReg: 13.32119) QuantErr: 13.32119 batch_time=0.44881 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 3.74767 (QuantReg: 13.22713) QuantErr: 13.22713 batch_time=0.46795 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 3.97166 (QuantReg: 13.38849) QuantErr: 13.38849 batch_time=0.44601 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 4.18187 (QuantReg: 13.46822) QuantErr: 13.46822 batch_time=0.43406 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 4.14060 (QuantReg: 13.49575) QuantErr: 13.49575 batch_time=0.44910 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 3.70246 (QuantReg: 13.22295) QuantErr: 13.22295 batch_time=0.44663 
Train Epoch: 40 codebook_update_time=0.88096
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch40.pth ...
Done in 4.409s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch40.pth ...
Done in 9.219s
removing stale ckpt [epoch 39] [took 0.04s]
 epoch          : 40
 loss           : 3.8977560348510742
 quant_reg      : 13.267229736328124
 quant_err      : 13.267229736328124
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.537
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.44645463870844
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5905
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.92346188293361
 mnt_best       : 44.44645463870844
 not_improved_count: 0
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 3.34547 (QuantReg: 13.24314) QuantErr: 13.24314 batch_time=35.71449 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 3.35711 (QuantReg: 13.31106) QuantErr: 13.31106 batch_time=0.45152 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 3.77550 (QuantReg: 13.23701) QuantErr: 13.23701 batch_time=0.61175 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 3.28281 (QuantReg: 13.52308) QuantErr: 13.52308 batch_time=0.55750 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 4.51903 (QuantReg: 13.22399) QuantErr: 13.22399 batch_time=0.43988 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 3.23372 (QuantReg: 13.49957) QuantErr: 13.49957 batch_time=0.43924 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 4.02567 (QuantReg: 13.41360) QuantErr: 13.41360 batch_time=0.73849 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 3.10488 (QuantReg: 13.27784) QuantErr: 13.27784 batch_time=0.44189 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 4.26155 (QuantReg: 13.51716) QuantErr: 13.51716 batch_time=0.44569 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 4.54208 (QuantReg: 13.32064) QuantErr: 13.32064 batch_time=0.45151 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 4.15130 (QuantReg: 13.10321) QuantErr: 13.10321 batch_time=0.44327 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 4.31822 (QuantReg: 13.22319) QuantErr: 13.22319 batch_time=0.43931 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 4.23883 (QuantReg: 13.13967) QuantErr: 13.13967 batch_time=0.46530 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 3.89101 (QuantReg: 12.97964) QuantErr: 12.97964 batch_time=0.43808 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 4.07505 (QuantReg: 13.44273) QuantErr: 13.44273 batch_time=0.44174 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 3.93865 (QuantReg: 13.30980) QuantErr: 13.30980 batch_time=0.44702 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 4.44964 (QuantReg: 13.09363) QuantErr: 13.09363 batch_time=0.43776 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 4.18063 (QuantReg: 13.25779) QuantErr: 13.25779 batch_time=0.46903 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 4.00244 (QuantReg: 13.27207) QuantErr: 13.27207 batch_time=0.50196 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 4.16609 (QuantReg: 13.37160) QuantErr: 13.37160 batch_time=0.45076 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 4.65372 (QuantReg: 13.36792) QuantErr: 13.36792 batch_time=0.50324 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 3.58955 (QuantReg: 13.24409) QuantErr: 13.24409 batch_time=0.44648 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 3.44001 (QuantReg: 13.25420) QuantErr: 13.25420 batch_time=0.44284 
Train Epoch: 41 codebook_update_time=0.82373
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch41.pth ...
Done in 4.587s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch41.pth ...
Done in 9.312s
removing stale ckpt [epoch 40] [took 0.01s]
 epoch          : 41
 loss           : 3.8468760690689088
 quant_reg      : 13.295313102722169
 quant_err      : 13.295313102722169
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.801
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.91281621828687
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.8315
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.335337122709554
 mnt_best       : 44.91281621828687
 not_improved_count: 0
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 3.95541 (QuantReg: 13.33680) QuantErr: 13.33680 batch_time=32.80975 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 3.44842 (QuantReg: 13.52790) QuantErr: 13.52790 batch_time=0.48880 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 4.23718 (QuantReg: 13.28178) QuantErr: 13.28178 batch_time=0.43933 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 4.57152 (QuantReg: 13.50938) QuantErr: 13.50938 batch_time=0.43460 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 4.48586 (QuantReg: 13.27434) QuantErr: 13.27434 batch_time=0.46569 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 4.19906 (QuantReg: 13.21244) QuantErr: 13.21244 batch_time=0.42284 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 4.86448 (QuantReg: 13.17387) QuantErr: 13.17387 batch_time=0.43802 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 3.70176 (QuantReg: 13.39926) QuantErr: 13.39926 batch_time=0.99684 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 3.41512 (QuantReg: 13.47549) QuantErr: 13.47549 batch_time=0.45681 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 4.46493 (QuantReg: 13.43354) QuantErr: 13.43354 batch_time=0.49848 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 4.01562 (QuantReg: 13.18667) QuantErr: 13.18667 batch_time=0.56018 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 3.43453 (QuantReg: 13.49754) QuantErr: 13.49754 batch_time=0.43744 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 3.12331 (QuantReg: 13.30481) QuantErr: 13.30481 batch_time=0.45109 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 3.99467 (QuantReg: 13.27733) QuantErr: 13.27733 batch_time=0.44777 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 4.54558 (QuantReg: 13.30983) QuantErr: 13.30983 batch_time=1.10341 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 4.06671 (QuantReg: 13.26803) QuantErr: 13.26803 batch_time=0.42983 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 3.67496 (QuantReg: 13.44995) QuantErr: 13.44995 batch_time=0.42601 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 3.39179 (QuantReg: 13.25976) QuantErr: 13.25976 batch_time=0.43093 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 3.57976 (QuantReg: 13.81799) QuantErr: 13.81799 batch_time=5.17382 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 3.29209 (QuantReg: 13.41645) QuantErr: 13.41645 batch_time=0.43469 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 3.27912 (QuantReg: 13.41797) QuantErr: 13.41797 batch_time=0.43282 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 3.31106 (QuantReg: 13.67297) QuantErr: 13.67297 batch_time=0.42526 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 3.83569 (QuantReg: 13.28849) QuantErr: 13.28849 batch_time=0.43425 
Train Epoch: 42 codebook_update_time=0.83476
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch42.pth ...
Done in 4.248s
removing stale ckpt [epoch 41] [took 0.01s]
 epoch          : 42
 loss           : 3.859879240989685
 quant_reg      : 13.345535865783692
 quant_err      : 13.345535865783692
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.822
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.564281630314795
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.195
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.00211867998351
 mnt_best       : 44.91281621828687
 not_improved_count: 1
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 4.11842 (QuantReg: 12.90601) QuantErr: 12.90601 batch_time=30.58652 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 3.59530 (QuantReg: 13.39438) QuantErr: 13.39438 batch_time=0.44299 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 4.85476 (QuantReg: 13.11423) QuantErr: 13.11423 batch_time=0.43013 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 3.21176 (QuantReg: 13.60292) QuantErr: 13.60292 batch_time=0.44951 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 4.33252 (QuantReg: 13.35661) QuantErr: 13.35661 batch_time=0.43661 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 3.82709 (QuantReg: 13.11974) QuantErr: 13.11974 batch_time=0.45751 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 4.71246 (QuantReg: 13.11684) QuantErr: 13.11684 batch_time=0.48424 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 3.69565 (QuantReg: 13.48758) QuantErr: 13.48758 batch_time=0.42887 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 4.08695 (QuantReg: 13.13613) QuantErr: 13.13613 batch_time=0.45446 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 3.94002 (QuantReg: 13.62852) QuantErr: 13.62852 batch_time=0.44635 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 3.57156 (QuantReg: 13.25841) QuantErr: 13.25841 batch_time=0.43979 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 3.87912 (QuantReg: 13.33609) QuantErr: 13.33609 batch_time=0.60970 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 4.64460 (QuantReg: 13.37930) QuantErr: 13.37930 batch_time=0.93028 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 4.39256 (QuantReg: 13.10380) QuantErr: 13.10380 batch_time=3.24519 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 4.80398 (QuantReg: 13.37428) QuantErr: 13.37428 batch_time=0.45581 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 4.72219 (QuantReg: 13.36966) QuantErr: 13.36966 batch_time=0.68757 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 4.31807 (QuantReg: 13.32310) QuantErr: 13.32310 batch_time=0.47547 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 3.88562 (QuantReg: 13.45156) QuantErr: 13.45156 batch_time=0.44668 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 3.59583 (QuantReg: 13.28728) QuantErr: 13.28728 batch_time=1.50728 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 3.62488 (QuantReg: 13.44841) QuantErr: 13.44841 batch_time=0.44337 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 3.29741 (QuantReg: 13.20639) QuantErr: 13.20639 batch_time=0.47788 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 4.10351 (QuantReg: 13.34005) QuantErr: 13.34005 batch_time=0.47676 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 4.57896 (QuantReg: 13.22581) QuantErr: 13.22581 batch_time=0.43886 
Train Epoch: 43 codebook_update_time=0.87684
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch43.pth ...
Done in 4.859s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 3.89189359664917
 quant_reg      : 13.318856636047363
 quant_err      : 13.318856636047363
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.48
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.784362899341176
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.235
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.78005764641837
 mnt_best       : 44.91281621828687
 not_improved_count: 2
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 3.16752 (QuantReg: 13.23506) QuantErr: 13.23506 batch_time=32.51233 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 4.62287 (QuantReg: 13.20707) QuantErr: 13.20707 batch_time=0.44450 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 3.89131 (QuantReg: 13.68662) QuantErr: 13.68662 batch_time=0.45339 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 3.61379 (QuantReg: 13.33605) QuantErr: 13.33605 batch_time=0.43950 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 4.47460 (QuantReg: 13.18588) QuantErr: 13.18588 batch_time=0.45571 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 3.39772 (QuantReg: 12.96463) QuantErr: 12.96463 batch_time=0.44588 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 3.31107 (QuantReg: 13.54190) QuantErr: 13.54190 batch_time=0.44882 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 4.27609 (QuantReg: 13.29973) QuantErr: 13.29973 batch_time=0.43391 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 3.60420 (QuantReg: 13.48200) QuantErr: 13.48200 batch_time=0.43622 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 3.51501 (QuantReg: 13.20162) QuantErr: 13.20162 batch_time=0.44162 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 4.90925 (QuantReg: 13.26973) QuantErr: 13.26973 batch_time=0.44581 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 3.98486 (QuantReg: 13.08459) QuantErr: 13.08459 batch_time=0.44101 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 4.63452 (QuantReg: 13.20116) QuantErr: 13.20116 batch_time=0.43371 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 4.23519 (QuantReg: 13.35379) QuantErr: 13.35379 batch_time=0.97547 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 3.67189 (QuantReg: 13.55042) QuantErr: 13.55042 batch_time=0.73082 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 4.64707 (QuantReg: 13.36903) QuantErr: 13.36903 batch_time=0.56299 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 3.75292 (QuantReg: 13.25039) QuantErr: 13.25039 batch_time=0.44995 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 4.00942 (QuantReg: 13.20625) QuantErr: 13.20625 batch_time=0.42717 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 4.03936 (QuantReg: 13.56903) QuantErr: 13.56903 batch_time=0.42727 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 3.35803 (QuantReg: 13.75865) QuantErr: 13.75865 batch_time=0.43246 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 3.46461 (QuantReg: 13.48949) QuantErr: 13.48949 batch_time=0.46294 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 3.18919 (QuantReg: 13.68011) QuantErr: 13.68011 batch_time=0.46078 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 3.67236 (QuantReg: 13.36952) QuantErr: 13.36952 batch_time=0.46301 
Train Epoch: 44 codebook_update_time=0.82500
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch44.pth ...
Done in 5.445s
removing stale ckpt [epoch 43] [took 0.06s]
 epoch          : 44
 loss           : 3.9148230514526365
 quant_reg      : 13.34705096435547
 quant_err      : 13.34705096435547
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.826
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.77849700158989
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.462
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.33860290059447
 mnt_best       : 44.91281621828687
 not_improved_count: 3
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 3.43845 (QuantReg: 13.30496) QuantErr: 13.30496 batch_time=30.52764 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 3.60976 (QuantReg: 13.47686) QuantErr: 13.47686 batch_time=0.47760 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 3.88530 (QuantReg: 13.53146) QuantErr: 13.53146 batch_time=0.45080 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 4.70408 (QuantReg: 13.23270) QuantErr: 13.23270 batch_time=0.49341 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 5.14902 (QuantReg: 13.29954) QuantErr: 13.29954 batch_time=0.77799 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 3.41350 (QuantReg: 13.47809) QuantErr: 13.47809 batch_time=0.44708 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 3.63827 (QuantReg: 13.40720) QuantErr: 13.40720 batch_time=3.44011 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 4.03591 (QuantReg: 13.27176) QuantErr: 13.27176 batch_time=0.46791 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 4.15160 (QuantReg: 13.51736) QuantErr: 13.51736 batch_time=0.47678 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 4.33170 (QuantReg: 13.24925) QuantErr: 13.24925 batch_time=0.44003 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 3.77596 (QuantReg: 13.17006) QuantErr: 13.17006 batch_time=0.44462 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 4.15372 (QuantReg: 13.32513) QuantErr: 13.32513 batch_time=0.45622 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 4.07597 (QuantReg: 13.28596) QuantErr: 13.28596 batch_time=0.42410 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 3.80156 (QuantReg: 13.48507) QuantErr: 13.48507 batch_time=0.48847 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 4.50005 (QuantReg: 13.24004) QuantErr: 13.24004 batch_time=0.44733 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 3.60814 (QuantReg: 13.37755) QuantErr: 13.37755 batch_time=0.47725 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 5.12033 (QuantReg: 13.61707) QuantErr: 13.61707 batch_time=0.53381 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 3.72532 (QuantReg: 13.16016) QuantErr: 13.16016 batch_time=0.70664 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 3.30309 (QuantReg: 13.35989) QuantErr: 13.35989 batch_time=0.68942 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 3.46183 (QuantReg: 13.08284) QuantErr: 13.08284 batch_time=0.95919 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 4.19077 (QuantReg: 13.24714) QuantErr: 13.24714 batch_time=0.48438 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 3.47386 (QuantReg: 13.22008) QuantErr: 13.22008 batch_time=0.44948 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 4.11208 (QuantReg: 13.27756) QuantErr: 13.27756 batch_time=0.45123 
Train Epoch: 45 codebook_update_time=0.83403
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch45.pth ...
Done in 5.015s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 3.8938188266754152
 quant_reg      : 13.336063907623291
 quant_err      : 13.336063907623291
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.065
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.54686272200811
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.524
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.87188675301892
 mnt_best       : 44.91281621828687
 not_improved_count: 4
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 3.35792 (QuantReg: 13.45991) QuantErr: 13.45991 batch_time=31.03776 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 3.68453 (QuantReg: 13.35349) QuantErr: 13.35349 batch_time=0.45764 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 4.59630 (QuantReg: 13.29343) QuantErr: 13.29343 batch_time=0.68208 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 4.36568 (QuantReg: 13.09003) QuantErr: 13.09003 batch_time=0.45151 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 4.11815 (QuantReg: 13.18219) QuantErr: 13.18219 batch_time=0.44363 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 4.51436 (QuantReg: 13.25908) QuantErr: 13.25908 batch_time=0.43524 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 3.96067 (QuantReg: 13.12910) QuantErr: 13.12910 batch_time=2.06944 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 5.00806 (QuantReg: 13.25973) QuantErr: 13.25973 batch_time=0.44212 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 4.30576 (QuantReg: 13.38265) QuantErr: 13.38265 batch_time=0.43769 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 4.47514 (QuantReg: 13.25894) QuantErr: 13.25894 batch_time=0.46313 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 2.92322 (QuantReg: 13.65331) QuantErr: 13.65331 batch_time=0.44728 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 4.64428 (QuantReg: 13.06627) QuantErr: 13.06627 batch_time=0.57428 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 4.95973 (QuantReg: 13.33365) QuantErr: 13.33365 batch_time=0.42217 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 5.10961 (QuantReg: 13.32223) QuantErr: 13.32223 batch_time=1.34187 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 2.79377 (QuantReg: 13.57411) QuantErr: 13.57411 batch_time=0.49240 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 3.40177 (QuantReg: 13.63777) QuantErr: 13.63777 batch_time=0.44002 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 4.47553 (QuantReg: 13.06926) QuantErr: 13.06926 batch_time=0.49310 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 3.58658 (QuantReg: 13.33069) QuantErr: 13.33069 batch_time=0.43091 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 4.35081 (QuantReg: 13.32004) QuantErr: 13.32004 batch_time=1.00148 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 3.93118 (QuantReg: 13.38693) QuantErr: 13.38693 batch_time=0.44693 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 3.01995 (QuantReg: 13.71761) QuantErr: 13.71761 batch_time=0.48934 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 4.56618 (QuantReg: 13.63361) QuantErr: 13.63361 batch_time=0.46415 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 4.00510 (QuantReg: 13.10601) QuantErr: 13.10601 batch_time=0.43645 
Train Epoch: 46 codebook_update_time=0.91051
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch46.pth ...
Done in 4.914s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 3.8684174280166626
 quant_reg      : 13.346294418334962
 quant_err      : 13.346294418334962
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.231
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.74652520276371
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.8995
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.43848960271852
 mnt_best       : 44.91281621828687
 not_improved_count: 5
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 3.14211 (QuantReg: 13.22793) QuantErr: 13.22793 batch_time=29.19780 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 3.40348 (QuantReg: 13.22794) QuantErr: 13.22794 batch_time=0.43945 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 3.46659 (QuantReg: 13.42546) QuantErr: 13.42546 batch_time=0.44986 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 3.95973 (QuantReg: 13.42887) QuantErr: 13.42887 batch_time=0.45086 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 4.26849 (QuantReg: 13.26004) QuantErr: 13.26004 batch_time=0.45237 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 3.85087 (QuantReg: 13.35886) QuantErr: 13.35886 batch_time=0.45201 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 4.13297 (QuantReg: 13.19773) QuantErr: 13.19773 batch_time=1.09020 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 3.72409 (QuantReg: 13.23267) QuantErr: 13.23267 batch_time=0.43684 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 3.43582 (QuantReg: 13.41794) QuantErr: 13.41794 batch_time=0.47011 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 3.87005 (QuantReg: 13.36532) QuantErr: 13.36532 batch_time=0.44156 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 3.36079 (QuantReg: 13.37081) QuantErr: 13.37081 batch_time=0.45521 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 4.27798 (QuantReg: 13.48159) QuantErr: 13.48159 batch_time=0.44849 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 3.70313 (QuantReg: 13.38154) QuantErr: 13.38154 batch_time=0.96338 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 4.66312 (QuantReg: 13.06082) QuantErr: 13.06082 batch_time=0.92307 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 4.39351 (QuantReg: 13.24552) QuantErr: 13.24552 batch_time=0.44275 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 3.15206 (QuantReg: 13.65322) QuantErr: 13.65322 batch_time=0.44075 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 3.81235 (QuantReg: 13.42157) QuantErr: 13.42157 batch_time=0.45043 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 3.40298 (QuantReg: 13.37590) QuantErr: 13.37590 batch_time=0.44789 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 4.08159 (QuantReg: 13.34130) QuantErr: 13.34130 batch_time=0.42728 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 3.97837 (QuantReg: 13.00608) QuantErr: 13.00608 batch_time=0.43016 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 4.25920 (QuantReg: 13.58811) QuantErr: 13.58811 batch_time=0.47618 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 3.71320 (QuantReg: 13.59761) QuantErr: 13.59761 batch_time=0.45896 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 3.74522 (QuantReg: 13.43363) QuantErr: 13.43363 batch_time=0.47613 
Train Epoch: 47 codebook_update_time=0.88349
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch47.pth ...
Done in 4.274s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch47.pth ...
Done in 8.600s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 47
 loss           : 3.846392611503601
 quant_reg      : 13.334043575286865
 quant_err      : 13.334043575286865
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.387
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.971596396655606
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.202
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.50734073032913
 mnt_best       : 44.971596396655606
 not_improved_count: 0
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 4.29964 (QuantReg: 13.59823) QuantErr: 13.59823 batch_time=39.41454 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 3.54854 (QuantReg: 13.33015) QuantErr: 13.33015 batch_time=0.42611 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 3.78003 (QuantReg: 13.37829) QuantErr: 13.37829 batch_time=0.46353 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 3.53946 (QuantReg: 13.49786) QuantErr: 13.49786 batch_time=0.49035 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 3.38896 (QuantReg: 13.45743) QuantErr: 13.45743 batch_time=0.43435 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 3.34568 (QuantReg: 13.46322) QuantErr: 13.46322 batch_time=0.44120 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 3.77647 (QuantReg: 13.28905) QuantErr: 13.28905 batch_time=0.43678 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 4.65990 (QuantReg: 13.43909) QuantErr: 13.43909 batch_time=0.44427 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 4.00840 (QuantReg: 13.33508) QuantErr: 13.33508 batch_time=0.48327 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 4.05702 (QuantReg: 13.13287) QuantErr: 13.13287 batch_time=0.47580 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 4.17597 (QuantReg: 13.32966) QuantErr: 13.32966 batch_time=0.47848 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 3.11698 (QuantReg: 13.61656) QuantErr: 13.61656 batch_time=0.44957 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 4.51977 (QuantReg: 13.46179) QuantErr: 13.46179 batch_time=0.47275 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 4.43744 (QuantReg: 13.39930) QuantErr: 13.39930 batch_time=2.23190 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 4.96041 (QuantReg: 13.56649) QuantErr: 13.56649 batch_time=0.45402 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 3.83376 (QuantReg: 13.29458) QuantErr: 13.29458 batch_time=0.47434 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 3.68514 (QuantReg: 13.43752) QuantErr: 13.43752 batch_time=0.45601 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 4.01952 (QuantReg: 13.43975) QuantErr: 13.43975 batch_time=0.43783 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 4.37949 (QuantReg: 13.13570) QuantErr: 13.13570 batch_time=0.47995 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 3.36047 (QuantReg: 13.36398) QuantErr: 13.36398 batch_time=0.43561 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 4.09722 (QuantReg: 13.24577) QuantErr: 13.24577 batch_time=0.46363 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 3.56135 (QuantReg: 13.48485) QuantErr: 13.48485 batch_time=0.43972 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 3.95147 (QuantReg: 13.37607) QuantErr: 13.37607 batch_time=0.46555 
Train Epoch: 48 codebook_update_time=0.84430
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch48.pth ...
Done in 4.155s
removing stale ckpt [epoch 47] [took 0.21s]
 epoch          : 48
 loss           : 3.899571318626404
 quant_reg      : 13.38060803604126
 quant_err      : 13.38060803604126
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.822
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.74488981731045
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.529
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.9409204860973
 mnt_best       : 44.971596396655606
 not_improved_count: 1
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 3.94351 (QuantReg: 13.43272) QuantErr: 13.43272 batch_time=34.42756 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 3.61125 (QuantReg: 13.47989) QuantErr: 13.47989 batch_time=0.46194 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 3.99769 (QuantReg: 13.28807) QuantErr: 13.28807 batch_time=0.52727 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 4.95103 (QuantReg: 13.27752) QuantErr: 13.27752 batch_time=0.44143 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 3.61614 (QuantReg: 13.16475) QuantErr: 13.16475 batch_time=0.46449 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 4.47520 (QuantReg: 13.62605) QuantErr: 13.62605 batch_time=0.46216 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 3.93889 (QuantReg: 13.21183) QuantErr: 13.21183 batch_time=0.46091 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 4.02698 (QuantReg: 13.35964) QuantErr: 13.35964 batch_time=0.42786 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 3.45094 (QuantReg: 13.49109) QuantErr: 13.49109 batch_time=0.46753 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 3.92550 (QuantReg: 13.50164) QuantErr: 13.50164 batch_time=0.42949 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 2.87126 (QuantReg: 13.49599) QuantErr: 13.49599 batch_time=0.43934 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 3.88840 (QuantReg: 13.66216) QuantErr: 13.66216 batch_time=0.46677 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 5.53125 (QuantReg: 13.31283) QuantErr: 13.31283 batch_time=0.48429 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 4.31089 (QuantReg: 13.45511) QuantErr: 13.45511 batch_time=0.44835 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 3.02831 (QuantReg: 13.42961) QuantErr: 13.42961 batch_time=1.03719 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 3.69544 (QuantReg: 13.68194) QuantErr: 13.68194 batch_time=0.43221 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 3.60019 (QuantReg: 13.70322) QuantErr: 13.70322 batch_time=0.48597 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 3.35948 (QuantReg: 13.59587) QuantErr: 13.59587 batch_time=0.43544 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 3.46442 (QuantReg: 13.67975) QuantErr: 13.67975 batch_time=0.42367 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 3.49091 (QuantReg: 13.34591) QuantErr: 13.34591 batch_time=0.45647 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 3.33046 (QuantReg: 13.16783) QuantErr: 13.16783 batch_time=0.55103 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 3.23225 (QuantReg: 13.40525) QuantErr: 13.40525 batch_time=0.43943 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 3.80420 (QuantReg: 13.38837) QuantErr: 13.38837 batch_time=0.42957 
Train Epoch: 49 codebook_update_time=0.83160
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch49.pth ...
Done in 7.879s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 3.8247519311904905
 quant_reg      : 13.423799221038818
 quant_err      : 13.423799221038818
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.005
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.60242534753911
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.746
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.80228730876462
 mnt_best       : 44.971596396655606
 not_improved_count: 2
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 3.54482 (QuantReg: 13.47056) QuantErr: 13.47056 batch_time=37.79760 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 2.92663 (QuantReg: 13.29026) QuantErr: 13.29026 batch_time=0.43654 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 3.81121 (QuantReg: 13.50451) QuantErr: 13.50451 batch_time=0.47468 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 2.93097 (QuantReg: 13.57055) QuantErr: 13.57055 batch_time=0.49056 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 3.74730 (QuantReg: 13.57467) QuantErr: 13.57467 batch_time=0.44587 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 5.31204 (QuantReg: 13.18672) QuantErr: 13.18672 batch_time=0.42782 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 3.56243 (QuantReg: 13.25212) QuantErr: 13.25212 batch_time=0.43159 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 4.26621 (QuantReg: 13.41546) QuantErr: 13.41546 batch_time=0.46208 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 4.36999 (QuantReg: 13.40721) QuantErr: 13.40721 batch_time=0.43483 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 4.06949 (QuantReg: 13.36192) QuantErr: 13.36192 batch_time=0.44228 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 4.16557 (QuantReg: 13.67300) QuantErr: 13.67300 batch_time=0.44199 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 2.82526 (QuantReg: 13.68761) QuantErr: 13.68761 batch_time=0.43917 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 3.80961 (QuantReg: 13.25576) QuantErr: 13.25576 batch_time=0.44386 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 3.69435 (QuantReg: 13.52779) QuantErr: 13.52779 batch_time=0.45139 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 3.62617 (QuantReg: 13.57855) QuantErr: 13.57855 batch_time=0.49728 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 3.89391 (QuantReg: 13.13532) QuantErr: 13.13532 batch_time=0.45924 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 3.71137 (QuantReg: 13.82479) QuantErr: 13.82479 batch_time=0.43987 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 4.65403 (QuantReg: 13.23109) QuantErr: 13.23109 batch_time=0.45906 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 4.97389 (QuantReg: 12.87836) QuantErr: 12.87836 batch_time=0.52823 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 4.29723 (QuantReg: 13.46963) QuantErr: 13.46963 batch_time=0.47607 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 4.27504 (QuantReg: 13.22754) QuantErr: 13.22754 batch_time=0.45143 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 3.74309 (QuantReg: 13.46173) QuantErr: 13.46173 batch_time=0.43204 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 3.02270 (QuantReg: 13.45714) QuantErr: 13.45714 batch_time=0.70647 
Train Epoch: 50 codebook_update_time=0.82267
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/checkpoint-epoch50.pth ...
Done in 4.911s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 3.8472163190841675
 quant_reg      : 13.419807998657227
 quant_err      : 13.419807998657227
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.889
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.854343863263445
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.737
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.546370669742146
 mnt_best       : 44.971596396655606
 not_improved_count: 3
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/trained_model.pth ...
Ckpt loaded at epoch 47.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 25.7
 t2v_metrics/R5/final_eval: 52.9
 t2v_metrics/R10/final_eval: 66.9
 t2v_metrics/R50/final_eval: 89.3
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 28.387
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 44.971596396655606
 v2t_metrics/R1/final_eval: 26.7
 v2t_metrics/R5/final_eval: 55.0
 v2t_metrics/R10/final_eval: 68.5
 v2t_metrics/R50/final_eval: 90.5
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 24.2005
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 46.50734073032913
Best epoch for the monitored metric: 47
Script took 03h37m08s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L3/trained_model.pth
