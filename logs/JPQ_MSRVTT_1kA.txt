Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 282.4452736377716 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 27.18897771835327 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 31.39389395713806 s.
Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 295.9216055870056 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 32.31790208816528 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 24.342007637023926 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch0.pth ...
Done in 1.625s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch0.pth ...
Done in 3.176s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 498.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 501.728
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.26207413942088975
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 503.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.615
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 mnt_best       : 0.26207413942088975
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 0.10620 (QuantReg: 0.13934) QuantErr: 0.13934 batch_time=28.20778 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 0.09766 (QuantReg: 0.14360) QuantErr: 0.14360 batch_time=0.41727 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 0.09229 (QuantReg: 0.13917) QuantErr: 0.13917 batch_time=0.42636 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 0.07764 (QuantReg: 0.13491) QuantErr: 0.13491 batch_time=0.43412 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 0.06555 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.43370 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 0.05127 (QuantReg: 0.13993) QuantErr: 0.13993 batch_time=0.43641 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 0.04156 (QuantReg: 0.14314) QuantErr: 0.14314 batch_time=0.43698 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 0.03424 (QuantReg: 0.14037) QuantErr: 0.14037 batch_time=0.42260 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 0.03308 (QuantReg: 0.13772) QuantErr: 0.13772 batch_time=0.42746 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 0.03271 (QuantReg: 0.14062) QuantErr: 0.14062 batch_time=0.43890 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 0.03430 (QuantReg: 0.13845) QuantErr: 0.13845 batch_time=0.43402 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 0.02701 (QuantReg: 0.14077) QuantErr: 0.14077 batch_time=0.43139 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 0.03099 (QuantReg: 0.13917) QuantErr: 0.13917 batch_time=0.43604 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 0.02725 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.42667 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 0.02667 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.43477 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 0.02393 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.47189 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 0.02455 (QuantReg: 0.13913) QuantErr: 0.13913 batch_time=0.42551 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 0.02356 (QuantReg: 0.14077) QuantErr: 0.14077 batch_time=0.45764 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 0.01877 (QuantReg: 0.13868) QuantErr: 0.13868 batch_time=0.41653 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 0.02202 (QuantReg: 0.13761) QuantErr: 0.13761 batch_time=0.47180 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 0.02255 (QuantReg: 0.13644) QuantErr: 0.13644 batch_time=0.41668 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 0.01884 (QuantReg: 0.13762) QuantErr: 0.13762 batch_time=0.41779 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 0.01935 (QuantReg: 0.13637) QuantErr: 0.13637 batch_time=0.41444 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch1.pth ...
Done in 3.800s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch1.pth ...
Done in 7.486s
 epoch          : 1
 loss           : 0.039697021484375
 quant_reg      : 0.13852145028114318
 quant_err      : 0.13852145028114318
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 3.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 13.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 60.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 35.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 75.479
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 9.972940175972777
 MSRVTT_jsfusion_test/v2t_metrics/R1: 4.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 13.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 23.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 61.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 31.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 72.793
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 10.865141283288725
 mnt_best       : 9.972940175972777
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 0.01848 (QuantReg: 0.13503) QuantErr: 0.13503 batch_time=32.34617 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 0.01756 (QuantReg: 0.13621) QuantErr: 0.13621 batch_time=0.41763 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 0.01767 (QuantReg: 0.13657) QuantErr: 0.13657 batch_time=0.43211 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 0.02039 (QuantReg: 0.13831) QuantErr: 0.13831 batch_time=0.45435 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 0.01256 (QuantReg: 0.13773) QuantErr: 0.13773 batch_time=0.68720 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 0.01478 (QuantReg: 0.13862) QuantErr: 0.13862 batch_time=0.45573 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 0.01224 (QuantReg: 0.13708) QuantErr: 0.13708 batch_time=2.59813 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 0.01553 (QuantReg: 0.13857) QuantErr: 0.13857 batch_time=0.40989 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 0.01495 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=0.44144 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 0.01584 (QuantReg: 0.13599) QuantErr: 0.13599 batch_time=0.42544 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 0.01965 (QuantReg: 0.13658) QuantErr: 0.13658 batch_time=0.41681 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 0.01508 (QuantReg: 0.13590) QuantErr: 0.13590 batch_time=0.41738 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 0.01807 (QuantReg: 0.13787) QuantErr: 0.13787 batch_time=0.41394 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 0.01422 (QuantReg: 0.13706) QuantErr: 0.13706 batch_time=0.44007 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 0.02557 (QuantReg: 0.13780) QuantErr: 0.13780 batch_time=0.41386 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 0.01270 (QuantReg: 0.13840) QuantErr: 0.13840 batch_time=0.47553 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 0.01929 (QuantReg: 0.13538) QuantErr: 0.13538 batch_time=0.41628 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 0.01663 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.41862 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 0.01642 (QuantReg: 0.14029) QuantErr: 0.14029 batch_time=0.43982 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 0.01396 (QuantReg: 0.14027) QuantErr: 0.14027 batch_time=0.42945 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 0.01139 (QuantReg: 0.13695) QuantErr: 0.13695 batch_time=0.42837 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 0.01239 (QuantReg: 0.13948) QuantErr: 0.13948 batch_time=0.43972 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 0.01481 (QuantReg: 0.13862) QuantErr: 0.13862 batch_time=0.42118 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch2.pth ...
Done in 5.933s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch2.pth ...
Done in 9.710s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 0.016452178955078126
 quant_reg      : 0.13729151290655137
 quant_err      : 0.13729151290655137
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 5.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 20.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 31.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 70.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 56.913
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.011984496313852
 MSRVTT_jsfusion_test/v2t_metrics/R1: 5.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 19.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 31.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 22.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 55.881
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 14.469537314860128
 mnt_best       : 15.011984496313852
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 0.01300 (QuantReg: 0.13743) QuantErr: 0.13743 batch_time=28.96844 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 0.01234 (QuantReg: 0.13742) QuantErr: 0.13742 batch_time=0.42752 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 0.01432 (QuantReg: 0.14009) QuantErr: 0.14009 batch_time=0.41896 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 0.01639 (QuantReg: 0.13838) QuantErr: 0.13838 batch_time=0.42278 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 0.01463 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.42049 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 0.01324 (QuantReg: 0.13723) QuantErr: 0.13723 batch_time=0.42233 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 0.01265 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.41824 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 0.01485 (QuantReg: 0.13753) QuantErr: 0.13753 batch_time=0.44257 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 0.01173 (QuantReg: 0.13766) QuantErr: 0.13766 batch_time=0.44316 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 0.01218 (QuantReg: 0.13657) QuantErr: 0.13657 batch_time=0.42736 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 0.01192 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.43204 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 0.01376 (QuantReg: 0.14018) QuantErr: 0.14018 batch_time=0.42543 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 0.01434 (QuantReg: 0.13804) QuantErr: 0.13804 batch_time=0.41661 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 0.01436 (QuantReg: 0.13790) QuantErr: 0.13790 batch_time=2.35777 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 0.01086 (QuantReg: 0.13599) QuantErr: 0.13599 batch_time=0.43284 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 0.01068 (QuantReg: 0.13850) QuantErr: 0.13850 batch_time=0.42398 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 0.01469 (QuantReg: 0.13862) QuantErr: 0.13862 batch_time=0.42777 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 0.01138 (QuantReg: 0.13870) QuantErr: 0.13870 batch_time=0.53215 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 0.01134 (QuantReg: 0.13925) QuantErr: 0.13925 batch_time=0.99890 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 0.01065 (QuantReg: 0.13872) QuantErr: 0.13872 batch_time=3.43877 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 0.00894 (QuantReg: 0.13810) QuantErr: 0.13810 batch_time=0.42242 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 0.01590 (QuantReg: 0.13697) QuantErr: 0.13697 batch_time=0.42314 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 0.01249 (QuantReg: 0.14029) QuantErr: 0.14029 batch_time=0.42139 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch3.pth ...
Done in 3.941s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch3.pth ...
Done in 7.826s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 0.012883636474609375
 quant_reg      : 0.1381472162604332
 quant_err      : 0.1381472162604332
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 6.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 35.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 73.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 19.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 48.761
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 17.591494685179068
 MSRVTT_jsfusion_test/v2t_metrics/R1: 8.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 38.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 74.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 18.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 47.699
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.775727833468025
 mnt_best       : 17.591494685179068
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 0.00986 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=29.20283 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 0.01471 (QuantReg: 0.13626) QuantErr: 0.13626 batch_time=0.45329 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 0.01125 (QuantReg: 0.13778) QuantErr: 0.13778 batch_time=0.45174 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 0.01017 (QuantReg: 0.13853) QuantErr: 0.13853 batch_time=0.42249 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 0.01131 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.42641 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 0.01096 (QuantReg: 0.13626) QuantErr: 0.13626 batch_time=0.44800 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 0.01212 (QuantReg: 0.13440) QuantErr: 0.13440 batch_time=0.42567 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 0.01401 (QuantReg: 0.13575) QuantErr: 0.13575 batch_time=0.42214 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 0.01137 (QuantReg: 0.13855) QuantErr: 0.13855 batch_time=0.42513 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 0.01282 (QuantReg: 0.13948) QuantErr: 0.13948 batch_time=0.42550 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 0.00732 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=0.42752 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 0.01199 (QuantReg: 0.13626) QuantErr: 0.13626 batch_time=0.42993 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 0.00879 (QuantReg: 0.13611) QuantErr: 0.13611 batch_time=0.43301 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 0.01022 (QuantReg: 0.13648) QuantErr: 0.13648 batch_time=2.96981 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 0.01349 (QuantReg: 0.13842) QuantErr: 0.13842 batch_time=0.42264 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 0.01169 (QuantReg: 0.13713) QuantErr: 0.13713 batch_time=0.45286 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 0.01131 (QuantReg: 0.13519) QuantErr: 0.13519 batch_time=0.41765 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 0.00854 (QuantReg: 0.13871) QuantErr: 0.13871 batch_time=0.47593 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 0.00970 (QuantReg: 0.14014) QuantErr: 0.14014 batch_time=0.42611 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 0.01048 (QuantReg: 0.13898) QuantErr: 0.13898 batch_time=0.43342 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 0.00931 (QuantReg: 0.13670) QuantErr: 0.13670 batch_time=0.42222 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 0.01154 (QuantReg: 0.13814) QuantErr: 0.13814 batch_time=0.42739 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 0.01117 (QuantReg: 0.13879) QuantErr: 0.13879 batch_time=0.42604 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch4.pth ...
Done in 3.839s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch4.pth ...
Done in 7.620s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 0.01086553955078125
 quant_reg      : 0.13740485805273056
 quant_err      : 0.13740485805273056
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 8.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 25.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 38.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 76.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 17.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 46.076
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.565318525454806
 MSRVTT_jsfusion_test/v2t_metrics/R1: 8.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 27.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 40.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 76.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 16.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 45.3455
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.197759938942152
 mnt_best       : 20.565318525454806
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 0.00978 (QuantReg: 0.13670) QuantErr: 0.13670 batch_time=27.97334 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 0.01077 (QuantReg: 0.13792) QuantErr: 0.13792 batch_time=0.41965 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 0.01145 (QuantReg: 0.13636) QuantErr: 0.13636 batch_time=0.64700 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 0.00757 (QuantReg: 0.13764) QuantErr: 0.13764 batch_time=0.41809 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 0.00903 (QuantReg: 0.13670) QuantErr: 0.13670 batch_time=0.42794 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 0.00601 (QuantReg: 0.13932) QuantErr: 0.13932 batch_time=0.41768 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 0.01308 (QuantReg: 0.14009) QuantErr: 0.14009 batch_time=0.43647 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 0.00801 (QuantReg: 0.14057) QuantErr: 0.14057 batch_time=1.54459 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 0.00933 (QuantReg: 0.14034) QuantErr: 0.14034 batch_time=1.76952 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 0.01003 (QuantReg: 0.14126) QuantErr: 0.14126 batch_time=3.14539 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 0.00976 (QuantReg: 0.13706) QuantErr: 0.13706 batch_time=0.43219 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 0.00684 (QuantReg: 0.14063) QuantErr: 0.14063 batch_time=0.42953 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 0.01254 (QuantReg: 0.13911) QuantErr: 0.13911 batch_time=0.42236 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 0.01334 (QuantReg: 0.13935) QuantErr: 0.13935 batch_time=0.44368 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 0.00914 (QuantReg: 0.14229) QuantErr: 0.14229 batch_time=0.42713 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 0.00954 (QuantReg: 0.13959) QuantErr: 0.13959 batch_time=0.43897 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 0.01110 (QuantReg: 0.13964) QuantErr: 0.13964 batch_time=0.43451 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 0.00957 (QuantReg: 0.13952) QuantErr: 0.13952 batch_time=0.41834 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 0.01231 (QuantReg: 0.14039) QuantErr: 0.14039 batch_time=2.21158 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 0.00912 (QuantReg: 0.14001) QuantErr: 0.14001 batch_time=0.42093 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 0.00698 (QuantReg: 0.14128) QuantErr: 0.14128 batch_time=0.43254 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 0.00978 (QuantReg: 0.13926) QuantErr: 0.13926 batch_time=0.42875 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 0.00808 (QuantReg: 0.14158) QuantErr: 0.14158 batch_time=0.43196 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch5.pth ...
Done in 4.093s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch5.pth ...
Done in 8.065s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 0.00952801513671875
 quant_reg      : 0.13906184780597686
 quant_err      : 0.13906184780597686
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 29.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 41.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 78.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 15.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 42.053
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.92596484100372
 MSRVTT_jsfusion_test/v2t_metrics/R1: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 31.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 43.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 80.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 40.568
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.952441109043136
 mnt_best       : 22.92596484100372
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 0.00807 (QuantReg: 0.13661) QuantErr: 0.13661 batch_time=26.55855 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 0.00476 (QuantReg: 0.13821) QuantErr: 0.13821 batch_time=0.42139 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 0.00836 (QuantReg: 0.13893) QuantErr: 0.13893 batch_time=0.44567 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 0.00745 (QuantReg: 0.13928) QuantErr: 0.13928 batch_time=0.43937 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 0.01037 (QuantReg: 0.14137) QuantErr: 0.14137 batch_time=0.43102 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 0.01244 (QuantReg: 0.14008) QuantErr: 0.14008 batch_time=0.43228 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 0.00810 (QuantReg: 0.13783) QuantErr: 0.13783 batch_time=0.42121 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 0.00873 (QuantReg: 0.13880) QuantErr: 0.13880 batch_time=0.42750 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 0.00896 (QuantReg: 0.13983) QuantErr: 0.13983 batch_time=0.42526 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 0.00707 (QuantReg: 0.13583) QuantErr: 0.13583 batch_time=0.43875 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 0.01015 (QuantReg: 0.14025) QuantErr: 0.14025 batch_time=0.45756 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 0.00944 (QuantReg: 0.13695) QuantErr: 0.13695 batch_time=0.42846 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 0.00787 (QuantReg: 0.13795) QuantErr: 0.13795 batch_time=0.45074 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 0.00887 (QuantReg: 0.13943) QuantErr: 0.13943 batch_time=0.45244 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 0.00513 (QuantReg: 0.13756) QuantErr: 0.13756 batch_time=0.42691 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 0.01096 (QuantReg: 0.14135) QuantErr: 0.14135 batch_time=0.42681 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 0.00721 (QuantReg: 0.13888) QuantErr: 0.13888 batch_time=0.46028 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 0.00833 (QuantReg: 0.13644) QuantErr: 0.13644 batch_time=0.44915 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 0.00790 (QuantReg: 0.13943) QuantErr: 0.13943 batch_time=0.42976 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 0.00826 (QuantReg: 0.13814) QuantErr: 0.13814 batch_time=0.42810 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 0.00912 (QuantReg: 0.13914) QuantErr: 0.13914 batch_time=0.42942 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 0.01139 (QuantReg: 0.14177) QuantErr: 0.14177 batch_time=0.42606 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 0.00707 (QuantReg: 0.13712) QuantErr: 0.13712 batch_time=0.42556 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch6.pth ...
Done in 15.452s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch6.pth ...
Done in 19.455s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 0.008568832397460938
 quant_reg      : 0.1389672200679779
 quant_err      : 0.1389672200679779
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 10.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 29.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 43.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 81.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 39.886
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.778226090058308
 MSRVTT_jsfusion_test/v2t_metrics/R1: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 30.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 81.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 13.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 38.712
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.227039420805678
 mnt_best       : 23.778226090058308
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 0.00905 (QuantReg: 0.14009) QuantErr: 0.14009 batch_time=35.36343 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 0.00813 (QuantReg: 0.13993) QuantErr: 0.13993 batch_time=0.41378 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 0.01057 (QuantReg: 0.13839) QuantErr: 0.13839 batch_time=0.43570 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 0.01348 (QuantReg: 0.14158) QuantErr: 0.14158 batch_time=0.42956 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 0.00652 (QuantReg: 0.14094) QuantErr: 0.14094 batch_time=0.42511 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 0.00789 (QuantReg: 0.14200) QuantErr: 0.14200 batch_time=0.46327 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 0.00831 (QuantReg: 0.13869) QuantErr: 0.13869 batch_time=0.41708 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 0.00750 (QuantReg: 0.13921) QuantErr: 0.13921 batch_time=0.43104 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 0.00895 (QuantReg: 0.14051) QuantErr: 0.14051 batch_time=0.46811 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 0.00793 (QuantReg: 0.14091) QuantErr: 0.14091 batch_time=0.42785 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 0.00626 (QuantReg: 0.13879) QuantErr: 0.13879 batch_time=0.47487 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 0.00679 (QuantReg: 0.13985) QuantErr: 0.13985 batch_time=0.43913 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 0.01059 (QuantReg: 0.14007) QuantErr: 0.14007 batch_time=0.42886 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 0.01115 (QuantReg: 0.13771) QuantErr: 0.13771 batch_time=0.65314 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 0.00713 (QuantReg: 0.14004) QuantErr: 0.14004 batch_time=0.42567 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 0.00836 (QuantReg: 0.14107) QuantErr: 0.14107 batch_time=0.42405 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 0.00859 (QuantReg: 0.14023) QuantErr: 0.14023 batch_time=0.41870 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 0.00638 (QuantReg: 0.13985) QuantErr: 0.13985 batch_time=0.55241 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 0.00724 (QuantReg: 0.14016) QuantErr: 0.14016 batch_time=0.42158 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 0.00830 (QuantReg: 0.13939) QuantErr: 0.13939 batch_time=0.43165 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 0.00836 (QuantReg: 0.14375) QuantErr: 0.14375 batch_time=1.77661 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 0.00993 (QuantReg: 0.13939) QuantErr: 0.13939 batch_time=0.45498 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 0.00614 (QuantReg: 0.13930) QuantErr: 0.13930 batch_time=0.42159 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch7.pth ...
Done in 4.039s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch7.pth ...
Done in 7.730s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 0.00796148681640625
 quant_reg      : 0.13999895709753035
 quant_err      : 0.13999895709753035
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 31.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 46.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 81.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 40.184
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.91627073176257
 MSRVTT_jsfusion_test/v2t_metrics/R1: 10.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 32.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 47.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 81.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 38.631
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.801109905234377
 mnt_best       : 23.91627073176257
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 0.00819 (QuantReg: 0.14261) QuantErr: 0.14261 batch_time=27.57566 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 0.00717 (QuantReg: 0.14114) QuantErr: 0.14114 batch_time=0.47840 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 0.01064 (QuantReg: 0.13883) QuantErr: 0.13883 batch_time=0.42663 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 0.00720 (QuantReg: 0.14003) QuantErr: 0.14003 batch_time=0.42633 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 0.01009 (QuantReg: 0.14098) QuantErr: 0.14098 batch_time=0.41863 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 0.00655 (QuantReg: 0.14093) QuantErr: 0.14093 batch_time=0.45754 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 0.00610 (QuantReg: 0.14098) QuantErr: 0.14098 batch_time=0.42550 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 0.00691 (QuantReg: 0.13965) QuantErr: 0.13965 batch_time=0.41646 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 0.00574 (QuantReg: 0.14106) QuantErr: 0.14106 batch_time=0.42336 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 0.00546 (QuantReg: 0.13896) QuantErr: 0.13896 batch_time=0.42202 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 0.00793 (QuantReg: 0.13952) QuantErr: 0.13952 batch_time=0.43178 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 0.00839 (QuantReg: 0.14263) QuantErr: 0.14263 batch_time=0.42575 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 0.00896 (QuantReg: 0.14274) QuantErr: 0.14274 batch_time=0.41911 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 0.00642 (QuantReg: 0.13914) QuantErr: 0.13914 batch_time=1.90061 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 0.00852 (QuantReg: 0.14286) QuantErr: 0.14286 batch_time=0.41276 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 0.00657 (QuantReg: 0.13875) QuantErr: 0.13875 batch_time=0.42512 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 0.00816 (QuantReg: 0.13830) QuantErr: 0.13830 batch_time=0.43174 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 0.00578 (QuantReg: 0.14055) QuantErr: 0.14055 batch_time=0.42400 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 0.00877 (QuantReg: 0.13909) QuantErr: 0.13909 batch_time=0.42167 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 0.00660 (QuantReg: 0.13874) QuantErr: 0.13874 batch_time=0.44047 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 0.00657 (QuantReg: 0.13940) QuantErr: 0.13940 batch_time=0.42400 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 0.00923 (QuantReg: 0.13900) QuantErr: 0.13900 batch_time=0.42561 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 0.00568 (QuantReg: 0.14098) QuantErr: 0.14098 batch_time=0.42807 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch8.pth ...
Done in 3.857s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch8.pth ...
Done in 7.831s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 0.00748321533203125
 quant_reg      : 0.14013711959123612
 quant_err      : 0.14013711959123612
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 10.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 31.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 47.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 82.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.218
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.734921945575273
 MSRVTT_jsfusion_test/v2t_metrics/R1: 8.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 31.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 47.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 82.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.9545
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.457599717796533
 mnt_best       : 24.734921945575273
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 0.00729 (QuantReg: 0.14152) QuantErr: 0.14152 batch_time=28.47999 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 0.00451 (QuantReg: 0.13989) QuantErr: 0.13989 batch_time=0.42950 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 0.00786 (QuantReg: 0.14287) QuantErr: 0.14287 batch_time=0.42503 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 0.00698 (QuantReg: 0.14080) QuantErr: 0.14080 batch_time=0.42774 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 0.00673 (QuantReg: 0.14132) QuantErr: 0.14132 batch_time=0.42694 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 0.00600 (QuantReg: 0.13784) QuantErr: 0.13784 batch_time=0.42893 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 0.00673 (QuantReg: 0.14122) QuantErr: 0.14122 batch_time=1.42401 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 0.00606 (QuantReg: 0.13957) QuantErr: 0.13957 batch_time=0.45137 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 0.00658 (QuantReg: 0.13911) QuantErr: 0.13911 batch_time=0.41389 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 0.00562 (QuantReg: 0.13916) QuantErr: 0.13916 batch_time=0.42445 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 0.00649 (QuantReg: 0.14238) QuantErr: 0.14238 batch_time=0.42501 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 0.00742 (QuantReg: 0.14138) QuantErr: 0.14138 batch_time=0.44122 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 0.00515 (QuantReg: 0.14320) QuantErr: 0.14320 batch_time=0.47956 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 0.00504 (QuantReg: 0.14155) QuantErr: 0.14155 batch_time=0.42582 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 0.00574 (QuantReg: 0.14224) QuantErr: 0.14224 batch_time=0.44578 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 0.00742 (QuantReg: 0.13973) QuantErr: 0.13973 batch_time=0.43099 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 0.00494 (QuantReg: 0.14322) QuantErr: 0.14322 batch_time=0.42803 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 0.01048 (QuantReg: 0.14122) QuantErr: 0.14122 batch_time=0.44049 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 0.00844 (QuantReg: 0.14101) QuantErr: 0.14101 batch_time=0.45208 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 0.00548 (QuantReg: 0.14133) QuantErr: 0.14133 batch_time=0.42778 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 0.00445 (QuantReg: 0.13920) QuantErr: 0.13920 batch_time=0.46817 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 0.00524 (QuantReg: 0.13974) QuantErr: 0.13974 batch_time=0.42974 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 0.00695 (QuantReg: 0.14189) QuantErr: 0.14189 batch_time=0.42055 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch9.pth ...
Done in 3.848s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch9.pth ...
Done in 7.722s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 0.006872406005859375
 quant_reg      : 0.14095720207691192
 quant_err      : 0.14095720207691192
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 33.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 48.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 82.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.856
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.233154422430726
 MSRVTT_jsfusion_test/v2t_metrics/R1: 9.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 34.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 51.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 82.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.045
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.46924396522724
 mnt_best       : 26.233154422430726
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 0.00565 (QuantReg: 0.14271) QuantErr: 0.14271 batch_time=31.10418 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 0.00710 (QuantReg: 0.13985) QuantErr: 0.13985 batch_time=0.42708 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 0.00650 (QuantReg: 0.13865) QuantErr: 0.13865 batch_time=0.43894 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 0.00693 (QuantReg: 0.14018) QuantErr: 0.14018 batch_time=0.41709 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 0.00999 (QuantReg: 0.13912) QuantErr: 0.13912 batch_time=0.44724 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 0.01051 (QuantReg: 0.14367) QuantErr: 0.14367 batch_time=0.43916 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 0.00874 (QuantReg: 0.13807) QuantErr: 0.13807 batch_time=1.69454 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 0.00818 (QuantReg: 0.13820) QuantErr: 0.13820 batch_time=1.81101 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 0.00510 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.42013 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 0.00686 (QuantReg: 0.13901) QuantErr: 0.13901 batch_time=0.43689 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 0.00621 (QuantReg: 0.13913) QuantErr: 0.13913 batch_time=0.42268 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 0.00671 (QuantReg: 0.13935) QuantErr: 0.13935 batch_time=0.43353 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 0.00457 (QuantReg: 0.14004) QuantErr: 0.14004 batch_time=0.41991 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 0.00789 (QuantReg: 0.13814) QuantErr: 0.13814 batch_time=0.42234 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 0.00703 (QuantReg: 0.13763) QuantErr: 0.13763 batch_time=0.53195 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 0.00604 (QuantReg: 0.13889) QuantErr: 0.13889 batch_time=0.43724 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 0.00735 (QuantReg: 0.13882) QuantErr: 0.13882 batch_time=1.12516 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 0.00669 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.42035 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 0.00585 (QuantReg: 0.13865) QuantErr: 0.13865 batch_time=0.42006 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 0.00694 (QuantReg: 0.13920) QuantErr: 0.13920 batch_time=0.80456 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 0.00470 (QuantReg: 0.14026) QuantErr: 0.14026 batch_time=0.54888 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 0.00545 (QuantReg: 0.13992) QuantErr: 0.13992 batch_time=0.45792 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 0.00780 (QuantReg: 0.14108) QuantErr: 0.14108 batch_time=0.41824 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch10.pth ...
Done in 17.924s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch10.pth ...
Done in 21.784s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 0.00723614501953125
 quant_reg      : 0.13948549807071686
 quant_err      : 0.13948549807071686
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 34.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 50.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.456
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.227150552823815
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 36.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 51.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 83.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.650999999999996
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.380969860491728
 mnt_best       : 28.227150552823815
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 0.00795 (QuantReg: 0.13721) QuantErr: 0.13721 batch_time=30.75900 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 0.00647 (QuantReg: 0.14137) QuantErr: 0.14137 batch_time=0.43768 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 0.00578 (QuantReg: 0.14068) QuantErr: 0.14068 batch_time=0.42710 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 0.00619 (QuantReg: 0.13616) QuantErr: 0.13616 batch_time=0.41791 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 0.00708 (QuantReg: 0.13800) QuantErr: 0.13800 batch_time=0.42240 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 0.00592 (QuantReg: 0.13765) QuantErr: 0.13765 batch_time=0.42921 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 0.00658 (QuantReg: 0.14012) QuantErr: 0.14012 batch_time=0.44418 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 0.00659 (QuantReg: 0.13858) QuantErr: 0.13858 batch_time=0.42043 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 0.00559 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.45968 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 0.00649 (QuantReg: 0.13910) QuantErr: 0.13910 batch_time=0.43071 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 0.00864 (QuantReg: 0.13944) QuantErr: 0.13944 batch_time=0.42660 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 0.00421 (QuantReg: 0.13970) QuantErr: 0.13970 batch_time=0.41833 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 0.00619 (QuantReg: 0.13691) QuantErr: 0.13691 batch_time=1.11108 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 0.00457 (QuantReg: 0.13888) QuantErr: 0.13888 batch_time=2.57734 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 0.00501 (QuantReg: 0.13905) QuantErr: 0.13905 batch_time=0.44157 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 0.00624 (QuantReg: 0.14072) QuantErr: 0.14072 batch_time=0.42406 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 0.00621 (QuantReg: 0.13918) QuantErr: 0.13918 batch_time=0.72057 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 0.00665 (QuantReg: 0.14093) QuantErr: 0.14093 batch_time=0.42705 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 0.00675 (QuantReg: 0.14219) QuantErr: 0.14219 batch_time=0.98569 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 0.00632 (QuantReg: 0.14000) QuantErr: 0.14000 batch_time=0.43242 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 0.00340 (QuantReg: 0.14112) QuantErr: 0.14112 batch_time=0.42720 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 0.00653 (QuantReg: 0.14083) QuantErr: 0.14083 batch_time=0.41251 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 0.00700 (QuantReg: 0.14130) QuantErr: 0.14130 batch_time=0.41792 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch11.pth ...
Done in 3.839s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 0.0062576675415039066
 quant_reg      : 0.13938977295160293
 quant_err      : 0.13938977295160293
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 34.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 49.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.128
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.852008295708163
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 36.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 51.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 83.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.951
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.56331466025944
 mnt_best       : 28.227150552823815
 not_improved_count: 1
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 0.00643 (QuantReg: 0.14274) QuantErr: 0.14274 batch_time=26.19226 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 0.00838 (QuantReg: 0.14045) QuantErr: 0.14045 batch_time=0.41443 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 0.00674 (QuantReg: 0.13986) QuantErr: 0.13986 batch_time=0.43913 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 0.00434 (QuantReg: 0.13911) QuantErr: 0.13911 batch_time=0.40892 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 0.00601 (QuantReg: 0.14138) QuantErr: 0.14138 batch_time=0.42833 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 0.00724 (QuantReg: 0.14398) QuantErr: 0.14398 batch_time=0.44459 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 0.01012 (QuantReg: 0.13979) QuantErr: 0.13979 batch_time=1.67860 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 0.00571 (QuantReg: 0.14108) QuantErr: 0.14108 batch_time=0.43800 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 0.00552 (QuantReg: 0.14158) QuantErr: 0.14158 batch_time=0.64567 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 0.00531 (QuantReg: 0.14168) QuantErr: 0.14168 batch_time=0.42346 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 0.00626 (QuantReg: 0.14051) QuantErr: 0.14051 batch_time=0.41434 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 0.00726 (QuantReg: 0.14094) QuantErr: 0.14094 batch_time=0.41612 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 0.00376 (QuantReg: 0.14417) QuantErr: 0.14417 batch_time=0.43354 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 0.00501 (QuantReg: 0.13938) QuantErr: 0.13938 batch_time=1.51720 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 0.00433 (QuantReg: 0.14256) QuantErr: 0.14256 batch_time=0.41228 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 0.00458 (QuantReg: 0.14071) QuantErr: 0.14071 batch_time=0.46702 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 0.00703 (QuantReg: 0.14329) QuantErr: 0.14329 batch_time=0.41704 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 0.00718 (QuantReg: 0.14126) QuantErr: 0.14126 batch_time=0.44337 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 0.00452 (QuantReg: 0.13826) QuantErr: 0.13826 batch_time=0.49832 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 0.00413 (QuantReg: 0.14156) QuantErr: 0.14156 batch_time=0.45845 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 0.00615 (QuantReg: 0.14287) QuantErr: 0.14287 batch_time=0.44790 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 0.00681 (QuantReg: 0.14310) QuantErr: 0.14310 batch_time=0.41555 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 0.00434 (QuantReg: 0.13859) QuantErr: 0.13859 batch_time=0.44427 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch12.pth ...
Done in 3.898s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 0.006017578125
 quant_reg      : 0.14072130954265594
 quant_err      : 0.14072130954265594
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 33.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 49.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.215
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.00660732024559
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 33.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 49.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 83.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.176
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.280223389483137
 mnt_best       : 28.227150552823815
 not_improved_count: 2
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 0.00573 (QuantReg: 0.14119) QuantErr: 0.14119 batch_time=26.89130 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 0.00454 (QuantReg: 0.13972) QuantErr: 0.13972 batch_time=0.41437 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 0.00521 (QuantReg: 0.14143) QuantErr: 0.14143 batch_time=0.43518 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 0.00523 (QuantReg: 0.14103) QuantErr: 0.14103 batch_time=0.41399 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 0.00444 (QuantReg: 0.14064) QuantErr: 0.14064 batch_time=0.52518 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 0.00493 (QuantReg: 0.14009) QuantErr: 0.14009 batch_time=0.41593 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 0.00702 (QuantReg: 0.14170) QuantErr: 0.14170 batch_time=2.18463 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 0.00597 (QuantReg: 0.14086) QuantErr: 0.14086 batch_time=0.42258 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 0.00755 (QuantReg: 0.13917) QuantErr: 0.13917 batch_time=0.41182 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 0.00626 (QuantReg: 0.13922) QuantErr: 0.13922 batch_time=0.41623 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 0.00792 (QuantReg: 0.13827) QuantErr: 0.13827 batch_time=0.42185 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 0.00484 (QuantReg: 0.14050) QuantErr: 0.14050 batch_time=0.41422 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 0.00555 (QuantReg: 0.13996) QuantErr: 0.13996 batch_time=0.45437 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 0.00541 (QuantReg: 0.14225) QuantErr: 0.14225 batch_time=0.46525 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 0.00517 (QuantReg: 0.14012) QuantErr: 0.14012 batch_time=0.41035 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 0.00593 (QuantReg: 0.14118) QuantErr: 0.14118 batch_time=0.45287 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 0.00626 (QuantReg: 0.14278) QuantErr: 0.14278 batch_time=0.41810 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 0.00591 (QuantReg: 0.14079) QuantErr: 0.14079 batch_time=0.41705 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 0.00563 (QuantReg: 0.14152) QuantErr: 0.14152 batch_time=0.41642 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 0.00490 (QuantReg: 0.14046) QuantErr: 0.14046 batch_time=3.78422 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 0.00468 (QuantReg: 0.14042) QuantErr: 0.14042 batch_time=0.75572 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 0.00443 (QuantReg: 0.13951) QuantErr: 0.13951 batch_time=0.41961 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 0.00557 (QuantReg: 0.14030) QuantErr: 0.14030 batch_time=0.42218 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch13.pth ...
Done in 3.800s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 0.00570269775390625
 quant_reg      : 0.14067046117782592
 quant_err      : 0.14067046117782592
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 11.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 36.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.769999999999996
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.99904418505951
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 37.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 53.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.309
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.152341409722514
 mnt_best       : 28.227150552823815
 not_improved_count: 3
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 0.00644 (QuantReg: 0.13706) QuantErr: 0.13706 batch_time=27.49305 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 0.00557 (QuantReg: 0.14165) QuantErr: 0.14165 batch_time=0.42060 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 0.00406 (QuantReg: 0.14158) QuantErr: 0.14158 batch_time=0.42536 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 0.00610 (QuantReg: 0.13914) QuantErr: 0.13914 batch_time=0.42123 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 0.00502 (QuantReg: 0.13911) QuantErr: 0.13911 batch_time=0.41775 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 0.00365 (QuantReg: 0.14066) QuantErr: 0.14066 batch_time=0.70253 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 0.00591 (QuantReg: 0.14085) QuantErr: 0.14085 batch_time=0.46541 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 0.00562 (QuantReg: 0.14034) QuantErr: 0.14034 batch_time=0.42500 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 0.00554 (QuantReg: 0.14129) QuantErr: 0.14129 batch_time=0.48293 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 0.00646 (QuantReg: 0.13780) QuantErr: 0.13780 batch_time=0.42557 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 0.00630 (QuantReg: 0.13909) QuantErr: 0.13909 batch_time=0.42736 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 0.00466 (QuantReg: 0.14053) QuantErr: 0.14053 batch_time=0.54229 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 0.00339 (QuantReg: 0.13871) QuantErr: 0.13871 batch_time=0.48036 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 0.00512 (QuantReg: 0.13995) QuantErr: 0.13995 batch_time=0.41272 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 0.00573 (QuantReg: 0.13841) QuantErr: 0.13841 batch_time=1.18785 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 0.00549 (QuantReg: 0.13893) QuantErr: 0.13893 batch_time=0.46741 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 0.00504 (QuantReg: 0.13875) QuantErr: 0.13875 batch_time=0.49805 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 0.00552 (QuantReg: 0.13932) QuantErr: 0.13932 batch_time=0.42758 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 0.00546 (QuantReg: 0.14257) QuantErr: 0.14257 batch_time=0.42969 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 0.00462 (QuantReg: 0.14168) QuantErr: 0.14168 batch_time=0.42218 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 0.00588 (QuantReg: 0.13866) QuantErr: 0.13866 batch_time=0.44033 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 0.00357 (QuantReg: 0.13961) QuantErr: 0.13961 batch_time=0.42063 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 0.00436 (QuantReg: 0.14091) QuantErr: 0.14091 batch_time=0.42999 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch14.pth ...
Done in 4.071s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch14.pth ...
Done in 8.004s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 0.0052602005004882815
 quant_reg      : 0.13983992159366607
 quant_err      : 0.13983992159366607
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 37.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.135
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.887235495993664
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 38.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.265
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.609580384375125
 mnt_best       : 28.887235495993664
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 0.00475 (QuantReg: 0.13782) QuantErr: 0.13782 batch_time=26.66417 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 0.00572 (QuantReg: 0.13857) QuantErr: 0.13857 batch_time=0.44100 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 0.00374 (QuantReg: 0.13738) QuantErr: 0.13738 batch_time=0.41598 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 0.00699 (QuantReg: 0.13960) QuantErr: 0.13960 batch_time=0.47925 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 0.00606 (QuantReg: 0.14007) QuantErr: 0.14007 batch_time=0.43890 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 0.00531 (QuantReg: 0.13880) QuantErr: 0.13880 batch_time=0.41302 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 0.00449 (QuantReg: 0.14015) QuantErr: 0.14015 batch_time=1.82449 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 0.00445 (QuantReg: 0.14110) QuantErr: 0.14110 batch_time=0.43123 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 0.00719 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.42158 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 0.00463 (QuantReg: 0.13991) QuantErr: 0.13991 batch_time=0.42218 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 0.00969 (QuantReg: 0.14006) QuantErr: 0.14006 batch_time=0.43343 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 0.00699 (QuantReg: 0.13780) QuantErr: 0.13780 batch_time=0.43340 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 0.00533 (QuantReg: 0.13807) QuantErr: 0.13807 batch_time=0.42138 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 0.00468 (QuantReg: 0.13784) QuantErr: 0.13784 batch_time=0.65655 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 0.00407 (QuantReg: 0.13916) QuantErr: 0.13916 batch_time=0.64198 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 0.00470 (QuantReg: 0.14090) QuantErr: 0.14090 batch_time=0.41993 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 0.00544 (QuantReg: 0.13822) QuantErr: 0.13822 batch_time=0.42368 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 0.00576 (QuantReg: 0.13967) QuantErr: 0.13967 batch_time=0.43446 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 0.00519 (QuantReg: 0.13878) QuantErr: 0.13878 batch_time=2.08424 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 0.00503 (QuantReg: 0.14192) QuantErr: 0.14192 batch_time=2.69890 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 0.00575 (QuantReg: 0.14227) QuantErr: 0.14227 batch_time=0.45158 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 0.00629 (QuantReg: 0.14129) QuantErr: 0.14129 batch_time=0.42324 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 0.00459 (QuantReg: 0.14213) QuantErr: 0.14213 batch_time=0.42042 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch15.pth ...
Done in 3.765s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch15.pth ...
Done in 12.667s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 0.005177894592285156
 quant_reg      : 0.13989657413959503
 quant_err      : 0.13989657413959503
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 39.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.662
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.773722457092664
 MSRVTT_jsfusion_test/v2t_metrics/R1: 13.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.644
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.003483479513427
 mnt_best       : 30.773722457092664
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 0.00548 (QuantReg: 0.13935) QuantErr: 0.13935 batch_time=29.40927 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 0.00836 (QuantReg: 0.13987) QuantErr: 0.13987 batch_time=0.41768 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 0.00433 (QuantReg: 0.13746) QuantErr: 0.13746 batch_time=0.43576 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 0.00563 (QuantReg: 0.14029) QuantErr: 0.14029 batch_time=0.42266 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 0.00535 (QuantReg: 0.13836) QuantErr: 0.13836 batch_time=0.42589 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 0.00413 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.43247 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 0.00555 (QuantReg: 0.13750) QuantErr: 0.13750 batch_time=0.98762 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 0.00475 (QuantReg: 0.13799) QuantErr: 0.13799 batch_time=0.42100 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 0.00486 (QuantReg: 0.13753) QuantErr: 0.13753 batch_time=0.42545 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 0.00784 (QuantReg: 0.14048) QuantErr: 0.14048 batch_time=0.46415 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 0.00616 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.41996 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 0.00568 (QuantReg: 0.13778) QuantErr: 0.13778 batch_time=0.41446 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 0.00420 (QuantReg: 0.13964) QuantErr: 0.13964 batch_time=2.07257 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 0.00407 (QuantReg: 0.13583) QuantErr: 0.13583 batch_time=0.41899 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 0.00470 (QuantReg: 0.14165) QuantErr: 0.14165 batch_time=0.42604 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 0.00378 (QuantReg: 0.14087) QuantErr: 0.14087 batch_time=0.42241 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 0.00587 (QuantReg: 0.13705) QuantErr: 0.13705 batch_time=0.41921 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 0.00346 (QuantReg: 0.14190) QuantErr: 0.14190 batch_time=0.41882 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 0.00436 (QuantReg: 0.14323) QuantErr: 0.14323 batch_time=0.42482 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 0.00383 (QuantReg: 0.13798) QuantErr: 0.13798 batch_time=1.67223 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 0.00411 (QuantReg: 0.13850) QuantErr: 0.13850 batch_time=0.43246 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 0.00436 (QuantReg: 0.14011) QuantErr: 0.14011 batch_time=0.43402 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 0.00396 (QuantReg: 0.14005) QuantErr: 0.14005 batch_time=0.45933 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch16.pth ...
Done in 15.410s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 0.004848968505859375
 quant_reg      : 0.13924625903367996
 quant_err      : 0.13924625903367996
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 38.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.197
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.023943847617524
 MSRVTT_jsfusion_test/v2t_metrics/R1: 13.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.526574701918435
 mnt_best       : 30.773722457092664
 not_improved_count: 1
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 0.00345 (QuantReg: 0.13740) QuantErr: 0.13740 batch_time=26.55193 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 0.00432 (QuantReg: 0.14018) QuantErr: 0.14018 batch_time=0.43994 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 0.00340 (QuantReg: 0.13908) QuantErr: 0.13908 batch_time=0.44485 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 0.00351 (QuantReg: 0.13848) QuantErr: 0.13848 batch_time=0.44574 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 0.00359 (QuantReg: 0.14118) QuantErr: 0.14118 batch_time=0.42470 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 0.00559 (QuantReg: 0.14113) QuantErr: 0.14113 batch_time=0.65325 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 0.00323 (QuantReg: 0.13792) QuantErr: 0.13792 batch_time=1.47987 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 0.00658 (QuantReg: 0.13919) QuantErr: 0.13919 batch_time=0.42075 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 0.00562 (QuantReg: 0.14136) QuantErr: 0.14136 batch_time=0.42213 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 0.00331 (QuantReg: 0.14319) QuantErr: 0.14319 batch_time=0.43239 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 0.00540 (QuantReg: 0.13826) QuantErr: 0.13826 batch_time=0.43028 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 0.00436 (QuantReg: 0.13983) QuantErr: 0.13983 batch_time=0.44433 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 0.00422 (QuantReg: 0.13997) QuantErr: 0.13997 batch_time=5.18399 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 0.00566 (QuantReg: 0.13948) QuantErr: 0.13948 batch_time=0.41639 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 0.00313 (QuantReg: 0.13938) QuantErr: 0.13938 batch_time=0.42994 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 0.00538 (QuantReg: 0.13977) QuantErr: 0.13977 batch_time=0.42445 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 0.00376 (QuantReg: 0.13628) QuantErr: 0.13628 batch_time=0.41693 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 0.00506 (QuantReg: 0.13930) QuantErr: 0.13930 batch_time=0.43143 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 0.00444 (QuantReg: 0.14097) QuantErr: 0.14097 batch_time=0.45575 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 0.00634 (QuantReg: 0.13657) QuantErr: 0.13657 batch_time=0.41982 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 0.00251 (QuantReg: 0.14023) QuantErr: 0.14023 batch_time=0.44171 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 0.00437 (QuantReg: 0.14047) QuantErr: 0.14047 batch_time=0.44690 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 0.00402 (QuantReg: 0.14004) QuantErr: 0.14004 batch_time=0.42745 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch17.pth ...
Done in 3.991s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 0.004515228271484375
 quant_reg      : 0.13968290811777115
 quant_err      : 0.13968290811777115
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 37.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.007000000000005
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.067771231167104
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.661
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.186324957100933
 mnt_best       : 30.773722457092664
 not_improved_count: 2
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 0.00304 (QuantReg: 0.13979) QuantErr: 0.13979 batch_time=32.09628 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 0.00514 (QuantReg: 0.13777) QuantErr: 0.13777 batch_time=0.42658 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 0.00623 (QuantReg: 0.14103) QuantErr: 0.14103 batch_time=0.43136 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 0.00361 (QuantReg: 0.14139) QuantErr: 0.14139 batch_time=0.43933 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 0.00345 (QuantReg: 0.13933) QuantErr: 0.13933 batch_time=0.45242 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 0.00520 (QuantReg: 0.14110) QuantErr: 0.14110 batch_time=0.43591 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 0.00430 (QuantReg: 0.14019) QuantErr: 0.14019 batch_time=0.45944 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 0.00437 (QuantReg: 0.14238) QuantErr: 0.14238 batch_time=0.44723 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 0.00414 (QuantReg: 0.13976) QuantErr: 0.13976 batch_time=0.43262 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 0.00670 (QuantReg: 0.14000) QuantErr: 0.14000 batch_time=0.43130 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 0.00439 (QuantReg: 0.13936) QuantErr: 0.13936 batch_time=0.42613 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 0.00233 (QuantReg: 0.14014) QuantErr: 0.14014 batch_time=0.50082 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 0.00490 (QuantReg: 0.13966) QuantErr: 0.13966 batch_time=0.42805 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 0.00539 (QuantReg: 0.13905) QuantErr: 0.13905 batch_time=0.79641 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 0.00334 (QuantReg: 0.14093) QuantErr: 0.14093 batch_time=0.43172 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 0.00541 (QuantReg: 0.14094) QuantErr: 0.14094 batch_time=0.42627 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 0.00452 (QuantReg: 0.13779) QuantErr: 0.13779 batch_time=0.41654 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 0.00319 (QuantReg: 0.13991) QuantErr: 0.13991 batch_time=0.42476 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 0.00639 (QuantReg: 0.13934) QuantErr: 0.13934 batch_time=0.42459 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 0.00383 (QuantReg: 0.14025) QuantErr: 0.14025 batch_time=0.43332 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 0.00414 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.42591 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 0.00277 (QuantReg: 0.13812) QuantErr: 0.13812 batch_time=0.44014 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 0.00367 (QuantReg: 0.13927) QuantErr: 0.13927 batch_time=0.42510 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch18.pth ...
Done in 3.968s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch18.pth ...
Done in 7.728s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 0.004371391296386719
 quant_reg      : 0.1397896457314491
 quant_err      : 0.1397896457314491
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.643
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.09307537216633
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 56.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.135
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.2142768322632
 mnt_best       : 32.09307537216633
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 0.00529 (QuantReg: 0.13724) QuantErr: 0.13724 batch_time=29.81985 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 0.00514 (QuantReg: 0.14043) QuantErr: 0.14043 batch_time=0.43638 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 0.00486 (QuantReg: 0.13918) QuantErr: 0.13918 batch_time=0.43271 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 0.00358 (QuantReg: 0.13909) QuantErr: 0.13909 batch_time=0.64884 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 0.00361 (QuantReg: 0.14032) QuantErr: 0.14032 batch_time=0.74055 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 0.00393 (QuantReg: 0.13718) QuantErr: 0.13718 batch_time=0.42623 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 0.00312 (QuantReg: 0.13906) QuantErr: 0.13906 batch_time=0.41960 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 0.00397 (QuantReg: 0.13884) QuantErr: 0.13884 batch_time=0.43258 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 0.00319 (QuantReg: 0.13745) QuantErr: 0.13745 batch_time=0.42275 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 0.00565 (QuantReg: 0.13855) QuantErr: 0.13855 batch_time=0.41502 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 0.00434 (QuantReg: 0.14065) QuantErr: 0.14065 batch_time=0.41567 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 0.00330 (QuantReg: 0.14028) QuantErr: 0.14028 batch_time=0.45512 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 0.00361 (QuantReg: 0.13903) QuantErr: 0.13903 batch_time=0.43780 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 0.00649 (QuantReg: 0.13694) QuantErr: 0.13694 batch_time=1.14480 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 0.00303 (QuantReg: 0.13749) QuantErr: 0.13749 batch_time=0.41611 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 0.00422 (QuantReg: 0.13714) QuantErr: 0.13714 batch_time=0.42216 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 0.00391 (QuantReg: 0.13833) QuantErr: 0.13833 batch_time=0.43857 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 0.00492 (QuantReg: 0.14136) QuantErr: 0.14136 batch_time=0.43687 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 0.00362 (QuantReg: 0.13601) QuantErr: 0.13601 batch_time=0.43075 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 0.00301 (QuantReg: 0.13910) QuantErr: 0.13910 batch_time=0.43122 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 0.00440 (QuantReg: 0.13818) QuantErr: 0.13818 batch_time=0.42171 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 0.00616 (QuantReg: 0.14068) QuantErr: 0.14068 batch_time=0.43678 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 0.00484 (QuantReg: 0.13977) QuantErr: 0.13977 batch_time=0.48380 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch19.pth ...
Done in 4.300s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch19.pth ...
Done in 8.173s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 0.004342544555664063
 quant_reg      : 0.1390343315601349
 quant_err      : 0.1390343315601349
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 40.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.544
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.572439602057194
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.399
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.733039487584957
 mnt_best       : 32.572439602057194
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 0.00337 (QuantReg: 0.13906) QuantErr: 0.13906 batch_time=28.72126 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 0.00417 (QuantReg: 0.14067) QuantErr: 0.14067 batch_time=0.41786 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 0.00615 (QuantReg: 0.13782) QuantErr: 0.13782 batch_time=0.42465 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 0.00581 (QuantReg: 0.13945) QuantErr: 0.13945 batch_time=0.41707 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 0.00417 (QuantReg: 0.13940) QuantErr: 0.13940 batch_time=0.42846 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 0.00403 (QuantReg: 0.13898) QuantErr: 0.13898 batch_time=0.43112 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 0.00686 (QuantReg: 0.13735) QuantErr: 0.13735 batch_time=0.87635 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 0.00391 (QuantReg: 0.13668) QuantErr: 0.13668 batch_time=0.43239 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 0.00315 (QuantReg: 0.13869) QuantErr: 0.13869 batch_time=0.42128 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 0.00446 (QuantReg: 0.14016) QuantErr: 0.14016 batch_time=0.41775 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 0.00394 (QuantReg: 0.13888) QuantErr: 0.13888 batch_time=0.42405 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 0.00477 (QuantReg: 0.13611) QuantErr: 0.13611 batch_time=0.42678 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 0.00471 (QuantReg: 0.13968) QuantErr: 0.13968 batch_time=0.41647 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 0.00433 (QuantReg: 0.13907) QuantErr: 0.13907 batch_time=0.41839 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 0.00260 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.41349 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 0.00351 (QuantReg: 0.13785) QuantErr: 0.13785 batch_time=0.41412 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 0.00369 (QuantReg: 0.13856) QuantErr: 0.13856 batch_time=0.42610 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 0.00354 (QuantReg: 0.13553) QuantErr: 0.13553 batch_time=0.43441 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 0.00314 (QuantReg: 0.13739) QuantErr: 0.13739 batch_time=1.93824 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 0.00586 (QuantReg: 0.13997) QuantErr: 0.13997 batch_time=0.41048 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 0.00261 (QuantReg: 0.13878) QuantErr: 0.13878 batch_time=0.42614 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 0.00430 (QuantReg: 0.13996) QuantErr: 0.13996 batch_time=0.41778 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 0.00517 (QuantReg: 0.13748) QuantErr: 0.13748 batch_time=0.43563 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch20.pth ...
Done in 3.955s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch20.pth ...
Done in 7.955s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 0.00433197021484375
 quant_reg      : 0.13893512809276581
 quant_err      : 0.13893512809276581
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 40.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.929
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.62275626441948
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.278
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.830799636309273
 mnt_best       : 32.62275626441948
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 0.00335 (QuantReg: 0.13715) QuantErr: 0.13715 batch_time=31.73757 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 0.00431 (QuantReg: 0.14079) QuantErr: 0.14079 batch_time=0.44020 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 0.00360 (QuantReg: 0.13995) QuantErr: 0.13995 batch_time=0.43193 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 0.00457 (QuantReg: 0.13980) QuantErr: 0.13980 batch_time=0.45958 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 0.00385 (QuantReg: 0.13925) QuantErr: 0.13925 batch_time=0.43844 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 0.00331 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.42625 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 0.00522 (QuantReg: 0.14014) QuantErr: 0.14014 batch_time=3.15375 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 0.00523 (QuantReg: 0.13741) QuantErr: 0.13741 batch_time=0.47101 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 0.00348 (QuantReg: 0.13826) QuantErr: 0.13826 batch_time=0.48833 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 0.00404 (QuantReg: 0.13904) QuantErr: 0.13904 batch_time=0.46210 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 0.00353 (QuantReg: 0.13937) QuantErr: 0.13937 batch_time=0.47274 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 0.00284 (QuantReg: 0.13832) QuantErr: 0.13832 batch_time=0.48231 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 0.00419 (QuantReg: 0.13976) QuantErr: 0.13976 batch_time=0.47249 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 0.00511 (QuantReg: 0.13885) QuantErr: 0.13885 batch_time=0.44222 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 0.00345 (QuantReg: 0.14056) QuantErr: 0.14056 batch_time=0.43328 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 0.00358 (QuantReg: 0.14104) QuantErr: 0.14104 batch_time=0.43102 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 0.00369 (QuantReg: 0.13955) QuantErr: 0.13955 batch_time=0.42297 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 0.00307 (QuantReg: 0.13978) QuantErr: 0.13978 batch_time=0.44090 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 0.00230 (QuantReg: 0.13974) QuantErr: 0.13974 batch_time=0.43016 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 0.00553 (QuantReg: 0.14060) QuantErr: 0.14060 batch_time=0.42687 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 0.00351 (QuantReg: 0.13924) QuantErr: 0.13924 batch_time=0.42129 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 0.00346 (QuantReg: 0.14000) QuantErr: 0.14000 batch_time=0.42235 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 0.00505 (QuantReg: 0.13672) QuantErr: 0.13672 batch_time=0.41951 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch21.pth ...
Done in 3.920s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch21.pth ...
Done in 7.844s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 0.004001434326171875
 quant_reg      : 0.1394899542927742
 quant_err      : 0.1394899542927742
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.852
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.443328852543615
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.986
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.42033601147029
 mnt_best       : 33.443328852543615
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 0.00259 (QuantReg: 0.13997) QuantErr: 0.13997 batch_time=29.80992 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 0.00469 (QuantReg: 0.14123) QuantErr: 0.14123 batch_time=0.43550 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 0.00449 (QuantReg: 0.14160) QuantErr: 0.14160 batch_time=0.41627 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 0.00477 (QuantReg: 0.13870) QuantErr: 0.13870 batch_time=0.42561 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 0.00319 (QuantReg: 0.13963) QuantErr: 0.13963 batch_time=0.42336 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 0.00259 (QuantReg: 0.13969) QuantErr: 0.13969 batch_time=0.41625 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 0.00389 (QuantReg: 0.14009) QuantErr: 0.14009 batch_time=0.43400 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 0.00499 (QuantReg: 0.14076) QuantErr: 0.14076 batch_time=0.41728 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 0.00327 (QuantReg: 0.13760) QuantErr: 0.13760 batch_time=0.43026 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 0.00403 (QuantReg: 0.13818) QuantErr: 0.13818 batch_time=4.26512 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 0.00430 (QuantReg: 0.14071) QuantErr: 0.14071 batch_time=0.41487 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 0.00576 (QuantReg: 0.13847) QuantErr: 0.13847 batch_time=0.45656 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 0.00367 (QuantReg: 0.14199) QuantErr: 0.14199 batch_time=0.42926 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 0.00306 (QuantReg: 0.13864) QuantErr: 0.13864 batch_time=0.42671 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 0.00394 (QuantReg: 0.13978) QuantErr: 0.13978 batch_time=0.42635 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 0.00299 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.41124 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 0.00381 (QuantReg: 0.14021) QuantErr: 0.14021 batch_time=0.41167 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 0.00629 (QuantReg: 0.14064) QuantErr: 0.14064 batch_time=0.41943 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 0.00372 (QuantReg: 0.13915) QuantErr: 0.13915 batch_time=0.43497 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 0.00396 (QuantReg: 0.14015) QuantErr: 0.14015 batch_time=0.44544 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 0.00351 (QuantReg: 0.13953) QuantErr: 0.13953 batch_time=0.42792 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 0.00473 (QuantReg: 0.14080) QuantErr: 0.14080 batch_time=0.43242 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 0.00447 (QuantReg: 0.13846) QuantErr: 0.13846 batch_time=0.43512 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch22.pth ...
Done in 4.153s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 0.0040200653076171875
 quant_reg      : 0.13927690768241882
 quant_err      : 0.13927690768241882
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.008
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.64088988787128
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 56.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.983
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.66549118820786
 mnt_best       : 33.443328852543615
 not_improved_count: 1
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 0.00484 (QuantReg: 0.13880) QuantErr: 0.13880 batch_time=33.04285 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 0.00352 (QuantReg: 0.13898) QuantErr: 0.13898 batch_time=0.41720 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 0.00301 (QuantReg: 0.13780) QuantErr: 0.13780 batch_time=0.41684 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 0.00253 (QuantReg: 0.13776) QuantErr: 0.13776 batch_time=1.37421 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 0.00372 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.43357 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 0.00415 (QuantReg: 0.13807) QuantErr: 0.13807 batch_time=0.42951 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 0.00411 (QuantReg: 0.13806) QuantErr: 0.13806 batch_time=0.43042 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 0.00542 (QuantReg: 0.13633) QuantErr: 0.13633 batch_time=0.43989 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 0.00615 (QuantReg: 0.13882) QuantErr: 0.13882 batch_time=0.46250 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 0.00354 (QuantReg: 0.13857) QuantErr: 0.13857 batch_time=0.43872 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 0.00401 (QuantReg: 0.14003) QuantErr: 0.14003 batch_time=0.42374 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 0.00313 (QuantReg: 0.13865) QuantErr: 0.13865 batch_time=0.43057 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 0.00458 (QuantReg: 0.13788) QuantErr: 0.13788 batch_time=0.42146 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 0.00346 (QuantReg: 0.13783) QuantErr: 0.13783 batch_time=2.02607 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 0.00349 (QuantReg: 0.14059) QuantErr: 0.14059 batch_time=0.43117 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 0.00377 (QuantReg: 0.13825) QuantErr: 0.13825 batch_time=0.41882 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 0.00368 (QuantReg: 0.13748) QuantErr: 0.13748 batch_time=0.44137 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 0.00339 (QuantReg: 0.14121) QuantErr: 0.14121 batch_time=0.45639 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 0.00370 (QuantReg: 0.13587) QuantErr: 0.13587 batch_time=0.42574 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 0.00344 (QuantReg: 0.13809) QuantErr: 0.13809 batch_time=0.42698 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 0.00254 (QuantReg: 0.13750) QuantErr: 0.13750 batch_time=0.43026 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 0.00484 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.43442 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 0.00363 (QuantReg: 0.13905) QuantErr: 0.13905 batch_time=0.44625 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch23.pth ...
Done in 16.565s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 0.003742683410644531
 quant_reg      : 0.13841498172283173
 quant_err      : 0.13841498172283173
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.743
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.39224843121139
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.169
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.136120971196114
 mnt_best       : 33.443328852543615
 not_improved_count: 2
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 0.00342 (QuantReg: 0.13953) QuantErr: 0.13953 batch_time=36.25852 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 0.00406 (QuantReg: 0.13436) QuantErr: 0.13436 batch_time=0.45682 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 0.00344 (QuantReg: 0.13831) QuantErr: 0.13831 batch_time=0.44228 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 0.00344 (QuantReg: 0.13814) QuantErr: 0.13814 batch_time=0.45544 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 0.00281 (QuantReg: 0.13919) QuantErr: 0.13919 batch_time=0.42506 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 0.00331 (QuantReg: 0.13893) QuantErr: 0.13893 batch_time=0.42199 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 0.00386 (QuantReg: 0.14136) QuantErr: 0.14136 batch_time=0.43047 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 0.00319 (QuantReg: 0.13691) QuantErr: 0.13691 batch_time=0.42463 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 0.00238 (QuantReg: 0.13784) QuantErr: 0.13784 batch_time=0.43763 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 0.00319 (QuantReg: 0.13668) QuantErr: 0.13668 batch_time=0.43370 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 0.00434 (QuantReg: 0.13771) QuantErr: 0.13771 batch_time=0.42640 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 0.00326 (QuantReg: 0.13965) QuantErr: 0.13965 batch_time=0.41571 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 0.00256 (QuantReg: 0.14139) QuantErr: 0.14139 batch_time=0.42531 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 0.00515 (QuantReg: 0.13736) QuantErr: 0.13736 batch_time=1.01468 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 0.00409 (QuantReg: 0.13845) QuantErr: 0.13845 batch_time=0.46113 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 0.00328 (QuantReg: 0.13949) QuantErr: 0.13949 batch_time=0.44622 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.00296 (QuantReg: 0.14057) QuantErr: 0.14057 batch_time=0.44210 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 0.00416 (QuantReg: 0.13865) QuantErr: 0.13865 batch_time=0.41136 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 0.00222 (QuantReg: 0.13739) QuantErr: 0.13739 batch_time=0.55348 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 0.00493 (QuantReg: 0.14171) QuantErr: 0.14171 batch_time=0.42623 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 0.00364 (QuantReg: 0.13957) QuantErr: 0.13957 batch_time=0.42652 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 0.00325 (QuantReg: 0.13858) QuantErr: 0.13858 batch_time=0.46041 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 0.00308 (QuantReg: 0.13771) QuantErr: 0.13771 batch_time=0.43490 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch24.pth ...
Done in 16.374s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch24.pth ...
Done in 20.395s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 0.0036886711120605467
 quant_reg      : 0.13865775048732756
 quant_err      : 0.13865775048732756
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.791
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.999114740503146
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.092
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.6741427055169
 mnt_best       : 33.999114740503146
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 0.00342 (QuantReg: 0.13747) QuantErr: 0.13747 batch_time=33.49234 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 0.00293 (QuantReg: 0.13754) QuantErr: 0.13754 batch_time=0.43482 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 0.00363 (QuantReg: 0.13768) QuantErr: 0.13768 batch_time=0.42100 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 0.00308 (QuantReg: 0.13720) QuantErr: 0.13720 batch_time=0.43943 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 0.00434 (QuantReg: 0.13873) QuantErr: 0.13873 batch_time=0.46020 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 0.00267 (QuantReg: 0.13938) QuantErr: 0.13938 batch_time=0.45925 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 0.00305 (QuantReg: 0.14029) QuantErr: 0.14029 batch_time=0.67044 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 0.00281 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.45681 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 0.00237 (QuantReg: 0.13754) QuantErr: 0.13754 batch_time=0.44058 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 0.00361 (QuantReg: 0.13928) QuantErr: 0.13928 batch_time=0.42084 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 0.00305 (QuantReg: 0.14088) QuantErr: 0.14088 batch_time=0.41999 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 0.00342 (QuantReg: 0.13977) QuantErr: 0.13977 batch_time=0.42873 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 0.00253 (QuantReg: 0.13884) QuantErr: 0.13884 batch_time=0.42069 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 0.00280 (QuantReg: 0.13751) QuantErr: 0.13751 batch_time=4.36892 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 0.00330 (QuantReg: 0.14070) QuantErr: 0.14070 batch_time=0.42010 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 0.00399 (QuantReg: 0.13985) QuantErr: 0.13985 batch_time=0.43078 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 0.00274 (QuantReg: 0.13981) QuantErr: 0.13981 batch_time=0.42298 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 0.00275 (QuantReg: 0.13832) QuantErr: 0.13832 batch_time=0.42366 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.00402 (QuantReg: 0.13886) QuantErr: 0.13886 batch_time=0.42454 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 0.00370 (QuantReg: 0.13876) QuantErr: 0.13876 batch_time=0.43238 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 0.00291 (QuantReg: 0.14073) QuantErr: 0.14073 batch_time=0.42210 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 0.00203 (QuantReg: 0.13792) QuantErr: 0.13792 batch_time=0.42420 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 0.00269 (QuantReg: 0.13754) QuantErr: 0.13754 batch_time=0.45703 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch25.pth ...
Done in 10.849s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch25.pth ...
Done in 14.719s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 0.0034634857177734376
 quant_reg      : 0.13848395228385926
 quant_err      : 0.13848395228385926
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.2535
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.13208424977604
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.782
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.96982501541129
 mnt_best       : 34.13208424977604
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 0.00197 (QuantReg: 0.13665) QuantErr: 0.13665 batch_time=27.46078 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 0.00316 (QuantReg: 0.13773) QuantErr: 0.13773 batch_time=0.69278 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 0.00320 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.44076 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 0.00315 (QuantReg: 0.14059) QuantErr: 0.14059 batch_time=0.43306 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 0.00484 (QuantReg: 0.13809) QuantErr: 0.13809 batch_time=0.42445 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 0.00208 (QuantReg: 0.13690) QuantErr: 0.13690 batch_time=0.41884 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 0.00459 (QuantReg: 0.13888) QuantErr: 0.13888 batch_time=1.89582 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 0.00240 (QuantReg: 0.13891) QuantErr: 0.13891 batch_time=0.43003 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 0.00420 (QuantReg: 0.13857) QuantErr: 0.13857 batch_time=0.42051 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 0.00225 (QuantReg: 0.14044) QuantErr: 0.14044 batch_time=0.43844 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.00344 (QuantReg: 0.13793) QuantErr: 0.13793 batch_time=0.42660 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 0.00414 (QuantReg: 0.13836) QuantErr: 0.13836 batch_time=0.44849 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 0.00260 (QuantReg: 0.13820) QuantErr: 0.13820 batch_time=1.55387 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 0.00257 (QuantReg: 0.13947) QuantErr: 0.13947 batch_time=0.43759 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 0.00244 (QuantReg: 0.13776) QuantErr: 0.13776 batch_time=0.42280 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 0.00294 (QuantReg: 0.13965) QuantErr: 0.13965 batch_time=0.44252 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 0.00409 (QuantReg: 0.14024) QuantErr: 0.14024 batch_time=0.45924 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 0.00336 (QuantReg: 0.13825) QuantErr: 0.13825 batch_time=0.44028 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 0.00404 (QuantReg: 0.13757) QuantErr: 0.13757 batch_time=1.77738 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 0.00313 (QuantReg: 0.14002) QuantErr: 0.14002 batch_time=1.00276 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 0.00317 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.45773 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 0.00390 (QuantReg: 0.13957) QuantErr: 0.13957 batch_time=0.44346 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 0.00250 (QuantReg: 0.14003) QuantErr: 0.14003 batch_time=0.42249 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch26.pth ...
Done in 10.948s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 0.0033960342407226562
 quant_reg      : 0.13863623929023744
 quant_err      : 0.13863623929023744
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.755
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.151552698282494
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.643
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.43761884252297
 mnt_best       : 34.13208424977604
 not_improved_count: 1
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 0.00290 (QuantReg: 0.13827) QuantErr: 0.13827 batch_time=33.06425 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 0.00280 (QuantReg: 0.13696) QuantErr: 0.13696 batch_time=0.42462 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 0.00332 (QuantReg: 0.13788) QuantErr: 0.13788 batch_time=0.42430 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 0.00338 (QuantReg: 0.13906) QuantErr: 0.13906 batch_time=0.43220 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 0.00302 (QuantReg: 0.13777) QuantErr: 0.13777 batch_time=0.41638 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 0.00319 (QuantReg: 0.13957) QuantErr: 0.13957 batch_time=0.44831 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 0.00379 (QuantReg: 0.13985) QuantErr: 0.13985 batch_time=0.42518 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 0.00331 (QuantReg: 0.13896) QuantErr: 0.13896 batch_time=0.43050 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 0.00280 (QuantReg: 0.13675) QuantErr: 0.13675 batch_time=0.42006 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 0.00290 (QuantReg: 0.13921) QuantErr: 0.13921 batch_time=0.41918 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 0.00207 (QuantReg: 0.14017) QuantErr: 0.14017 batch_time=0.41308 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 0.00329 (QuantReg: 0.13963) QuantErr: 0.13963 batch_time=0.42235 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 0.00336 (QuantReg: 0.13978) QuantErr: 0.13978 batch_time=0.44827 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 0.00360 (QuantReg: 0.13790) QuantErr: 0.13790 batch_time=0.42706 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 0.00275 (QuantReg: 0.13945) QuantErr: 0.13945 batch_time=0.42116 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 0.00235 (QuantReg: 0.13829) QuantErr: 0.13829 batch_time=0.41484 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 0.00332 (QuantReg: 0.13899) QuantErr: 0.13899 batch_time=0.52451 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 0.00333 (QuantReg: 0.14023) QuantErr: 0.14023 batch_time=0.42030 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 0.00332 (QuantReg: 0.14016) QuantErr: 0.14016 batch_time=0.45113 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 0.00293 (QuantReg: 0.14193) QuantErr: 0.14193 batch_time=0.43889 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 0.00255 (QuantReg: 0.13690) QuantErr: 0.13690 batch_time=0.42136 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 0.00285 (QuantReg: 0.13810) QuantErr: 0.13810 batch_time=0.42153 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 0.00284 (QuantReg: 0.13953) QuantErr: 0.13953 batch_time=0.44431 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch27.pth ...
Done in 4.195s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch27.pth ...
Done in 21.736s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 0.0033522796630859374
 quant_reg      : 0.13879817336797715
 quant_err      : 0.13879817336797715
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.538
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.49393129970152
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.907
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.98227946496369
 mnt_best       : 34.49393129970152
 not_improved_count: 0
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 0.00307 (QuantReg: 0.14054) QuantErr: 0.14054 batch_time=31.71471 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 0.00257 (QuantReg: 0.13795) QuantErr: 0.13795 batch_time=0.88474 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.00348 (QuantReg: 0.13807) QuantErr: 0.13807 batch_time=0.41946 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 0.00362 (QuantReg: 0.13775) QuantErr: 0.13775 batch_time=0.41093 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 0.00379 (QuantReg: 0.13810) QuantErr: 0.13810 batch_time=0.42310 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 0.00262 (QuantReg: 0.13866) QuantErr: 0.13866 batch_time=0.41860 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 0.00351 (QuantReg: 0.13772) QuantErr: 0.13772 batch_time=0.43634 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 0.00195 (QuantReg: 0.14092) QuantErr: 0.14092 batch_time=0.65352 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 0.00211 (QuantReg: 0.13877) QuantErr: 0.13877 batch_time=0.41391 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 0.00252 (QuantReg: 0.13735) QuantErr: 0.13735 batch_time=0.92259 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 0.00440 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=0.43029 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 0.00249 (QuantReg: 0.13916) QuantErr: 0.13916 batch_time=0.41395 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 0.00330 (QuantReg: 0.13650) QuantErr: 0.13650 batch_time=0.64029 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 0.00518 (QuantReg: 0.13799) QuantErr: 0.13799 batch_time=0.92893 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 0.00270 (QuantReg: 0.13876) QuantErr: 0.13876 batch_time=0.41946 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 0.00303 (QuantReg: 0.13895) QuantErr: 0.13895 batch_time=0.41996 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 0.00251 (QuantReg: 0.13548) QuantErr: 0.13548 batch_time=0.43890 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 0.00264 (QuantReg: 0.13723) QuantErr: 0.13723 batch_time=0.47558 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 0.00293 (QuantReg: 0.13756) QuantErr: 0.13756 batch_time=1.99286 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 0.00356 (QuantReg: 0.13807) QuantErr: 0.13807 batch_time=0.63936 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 0.00256 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.43230 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 0.00443 (QuantReg: 0.13850) QuantErr: 0.13850 batch_time=0.42910 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 0.00376 (QuantReg: 0.13692) QuantErr: 0.13692 batch_time=0.43868 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch28.pth ...
Done in 13.471s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 0.0032773780822753906
 quant_reg      : 0.13834410417079926
 quant_err      : 0.13834410417079926
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.404
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.1323272553216
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.232
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.10665470407633
 mnt_best       : 34.49393129970152
 not_improved_count: 1
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 0.00382 (QuantReg: 0.13934) QuantErr: 0.13934 batch_time=31.80022 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 0.00333 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.42562 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 0.00241 (QuantReg: 0.14213) QuantErr: 0.14213 batch_time=0.43443 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 0.00269 (QuantReg: 0.14129) QuantErr: 0.14129 batch_time=0.44097 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 0.00279 (QuantReg: 0.13785) QuantErr: 0.13785 batch_time=0.43325 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 0.00248 (QuantReg: 0.13934) QuantErr: 0.13934 batch_time=0.43418 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 0.00327 (QuantReg: 0.13808) QuantErr: 0.13808 batch_time=0.43448 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 0.00366 (QuantReg: 0.13782) QuantErr: 0.13782 batch_time=5.28162 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 0.00420 (QuantReg: 0.13821) QuantErr: 0.13821 batch_time=0.42199 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 0.00382 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.43839 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 0.00260 (QuantReg: 0.14123) QuantErr: 0.14123 batch_time=0.43565 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 0.00356 (QuantReg: 0.13881) QuantErr: 0.13881 batch_time=0.44066 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 0.00250 (QuantReg: 0.13952) QuantErr: 0.13952 batch_time=0.44527 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 0.00344 (QuantReg: 0.13928) QuantErr: 0.13928 batch_time=0.41798 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 0.00270 (QuantReg: 0.13812) QuantErr: 0.13812 batch_time=0.42336 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 0.00338 (QuantReg: 0.14043) QuantErr: 0.14043 batch_time=0.42578 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 0.00356 (QuantReg: 0.13949) QuantErr: 0.13949 batch_time=0.41801 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 0.00258 (QuantReg: 0.13604) QuantErr: 0.13604 batch_time=0.42040 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 0.00347 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.41719 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 0.00306 (QuantReg: 0.13930) QuantErr: 0.13930 batch_time=0.41323 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 0.00323 (QuantReg: 0.14007) QuantErr: 0.14007 batch_time=0.42555 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.00196 (QuantReg: 0.13868) QuantErr: 0.13868 batch_time=0.46124 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 0.00303 (QuantReg: 0.13675) QuantErr: 0.13675 batch_time=0.42262 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch29.pth ...
Done in 13.327s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch29.pth ...
Done in 17.333s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 0.0031973228454589843
 quant_reg      : 0.13890156483650207
 quant_err      : 0.13890156483650207
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.133
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.64345226292939
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.436
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.971749441457895
 mnt_best       : 34.64345226292939
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 0.00285 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=36.29472 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 0.00232 (QuantReg: 0.13681) QuantErr: 0.13681 batch_time=0.42451 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 0.00275 (QuantReg: 0.13701) QuantErr: 0.13701 batch_time=0.42492 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 0.00208 (QuantReg: 0.13792) QuantErr: 0.13792 batch_time=0.42090 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 0.00356 (QuantReg: 0.13593) QuantErr: 0.13593 batch_time=0.41793 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 0.00407 (QuantReg: 0.13919) QuantErr: 0.13919 batch_time=0.42325 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 0.00328 (QuantReg: 0.13799) QuantErr: 0.13799 batch_time=0.42568 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.00544 (QuantReg: 0.13854) QuantErr: 0.13854 batch_time=0.44061 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 0.00252 (QuantReg: 0.13884) QuantErr: 0.13884 batch_time=0.47782 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 0.00290 (QuantReg: 0.13811) QuantErr: 0.13811 batch_time=0.43101 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 0.00303 (QuantReg: 0.13643) QuantErr: 0.13643 batch_time=0.44636 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 0.00280 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.44117 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 0.00244 (QuantReg: 0.13803) QuantErr: 0.13803 batch_time=0.42459 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 0.00269 (QuantReg: 0.13883) QuantErr: 0.13883 batch_time=0.81362 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 0.00230 (QuantReg: 0.13882) QuantErr: 0.13882 batch_time=0.41687 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 0.00216 (QuantReg: 0.13711) QuantErr: 0.13711 batch_time=0.42883 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 0.00294 (QuantReg: 0.13944) QuantErr: 0.13944 batch_time=0.43288 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 0.00340 (QuantReg: 0.13941) QuantErr: 0.13941 batch_time=0.54092 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 0.00275 (QuantReg: 0.13923) QuantErr: 0.13923 batch_time=0.41963 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 0.00339 (QuantReg: 0.13782) QuantErr: 0.13782 batch_time=0.42865 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 0.00223 (QuantReg: 0.13653) QuantErr: 0.13653 batch_time=0.41950 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 0.00215 (QuantReg: 0.13773) QuantErr: 0.13773 batch_time=0.42234 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 0.00285 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=0.41957 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch30.pth ...
Done in 13.075s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch30.pth ...
Done in 16.982s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 0.0030140838623046876
 quant_reg      : 0.13804320102930068
 quant_err      : 0.13804320102930068
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.551
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.048922062381436
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.745
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.7514609082363
 mnt_best       : 35.048922062381436
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 0.00265 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=31.10892 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 0.00260 (QuantReg: 0.13749) QuantErr: 0.13749 batch_time=0.42385 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 0.00333 (QuantReg: 0.13672) QuantErr: 0.13672 batch_time=0.43713 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 0.00224 (QuantReg: 0.13774) QuantErr: 0.13774 batch_time=0.44898 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 0.00321 (QuantReg: 0.13658) QuantErr: 0.13658 batch_time=0.41461 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 0.00320 (QuantReg: 0.13663) QuantErr: 0.13663 batch_time=0.43114 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 0.00230 (QuantReg: 0.13791) QuantErr: 0.13791 batch_time=0.42190 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 0.00202 (QuantReg: 0.13909) QuantErr: 0.13909 batch_time=0.44435 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 0.00236 (QuantReg: 0.13837) QuantErr: 0.13837 batch_time=0.43443 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 0.00416 (QuantReg: 0.13831) QuantErr: 0.13831 batch_time=0.45298 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 0.00275 (QuantReg: 0.13916) QuantErr: 0.13916 batch_time=0.44517 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 0.00355 (QuantReg: 0.13845) QuantErr: 0.13845 batch_time=0.45938 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 0.00286 (QuantReg: 0.14024) QuantErr: 0.14024 batch_time=0.43567 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 0.00234 (QuantReg: 0.13850) QuantErr: 0.13850 batch_time=0.41889 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 0.00305 (QuantReg: 0.14158) QuantErr: 0.14158 batch_time=0.41751 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 0.00276 (QuantReg: 0.13845) QuantErr: 0.13845 batch_time=0.42060 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 0.00301 (QuantReg: 0.13827) QuantErr: 0.13827 batch_time=0.41698 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 0.00190 (QuantReg: 0.14032) QuantErr: 0.14032 batch_time=0.41684 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 0.00385 (QuantReg: 0.13714) QuantErr: 0.13714 batch_time=0.68483 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 0.00363 (QuantReg: 0.13874) QuantErr: 0.13874 batch_time=0.45868 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 0.00196 (QuantReg: 0.13718) QuantErr: 0.13718 batch_time=0.44121 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 0.00334 (QuantReg: 0.13732) QuantErr: 0.13732 batch_time=0.90367 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 0.00304 (QuantReg: 0.13935) QuantErr: 0.13935 batch_time=0.43707 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch31.pth ...
Done in 17.656s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 0.0028750267028808596
 quant_reg      : 0.13828820580244064
 quant_err      : 0.13828820580244064
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.46
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.827888365940524
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.153
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.796100144249074
 mnt_best       : 35.048922062381436
 not_improved_count: 1
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 0.00299 (QuantReg: 0.14022) QuantErr: 0.14022 batch_time=31.13529 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 0.00161 (QuantReg: 0.13970) QuantErr: 0.13970 batch_time=0.43097 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 0.00225 (QuantReg: 0.13859) QuantErr: 0.13859 batch_time=0.44289 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 0.00388 (QuantReg: 0.13716) QuantErr: 0.13716 batch_time=0.43201 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.00303 (QuantReg: 0.13729) QuantErr: 0.13729 batch_time=0.40866 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 0.00266 (QuantReg: 0.13770) QuantErr: 0.13770 batch_time=0.40958 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 0.00290 (QuantReg: 0.13758) QuantErr: 0.13758 batch_time=0.43523 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 0.00279 (QuantReg: 0.13881) QuantErr: 0.13881 batch_time=0.42533 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 0.00292 (QuantReg: 0.13607) QuantErr: 0.13607 batch_time=0.43549 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 0.00304 (QuantReg: 0.13699) QuantErr: 0.13699 batch_time=0.44159 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 0.00265 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=0.46553 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 0.00341 (QuantReg: 0.13714) QuantErr: 0.13714 batch_time=0.43154 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 0.00246 (QuantReg: 0.13956) QuantErr: 0.13956 batch_time=0.42812 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 0.00195 (QuantReg: 0.13908) QuantErr: 0.13908 batch_time=1.09324 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 0.00277 (QuantReg: 0.13704) QuantErr: 0.13704 batch_time=0.41234 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 0.00227 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.41443 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 0.00277 (QuantReg: 0.13793) QuantErr: 0.13793 batch_time=0.44456 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.00192 (QuantReg: 0.13820) QuantErr: 0.13820 batch_time=0.40980 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 0.00235 (QuantReg: 0.13626) QuantErr: 0.13626 batch_time=0.64819 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 0.00310 (QuantReg: 0.13761) QuantErr: 0.13761 batch_time=0.97948 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 0.00259 (QuantReg: 0.13902) QuantErr: 0.13902 batch_time=0.41082 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 0.00182 (QuantReg: 0.13982) QuantErr: 0.13982 batch_time=0.42686 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 0.00240 (QuantReg: 0.13936) QuantErr: 0.13936 batch_time=0.44358 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch32.pth ...
Done in 9.646s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch32.pth ...
Done in 13.274s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 0.0029027976989746095
 quant_reg      : 0.1381021812558174
 quant_err      : 0.1381021812558174
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.895
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.2423190011077
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.7
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.904566681374455
 mnt_best       : 35.2423190011077
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 0.00449 (QuantReg: 0.13889) QuantErr: 0.13889 batch_time=25.52254 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 0.00287 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=7.29138 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 0.00351 (QuantReg: 0.13933) QuantErr: 0.13933 batch_time=0.42298 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 0.00310 (QuantReg: 0.13698) QuantErr: 0.13698 batch_time=0.43490 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 0.00227 (QuantReg: 0.13844) QuantErr: 0.13844 batch_time=0.42519 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 0.00249 (QuantReg: 0.13940) QuantErr: 0.13940 batch_time=0.44519 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.00292 (QuantReg: 0.13962) QuantErr: 0.13962 batch_time=4.05116 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 0.00258 (QuantReg: 0.13712) QuantErr: 0.13712 batch_time=0.42547 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 0.00240 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.42343 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 0.00216 (QuantReg: 0.13762) QuantErr: 0.13762 batch_time=0.46319 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 0.00266 (QuantReg: 0.13776) QuantErr: 0.13776 batch_time=0.42898 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 0.00302 (QuantReg: 0.14111) QuantErr: 0.14111 batch_time=0.43216 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 0.00470 (QuantReg: 0.13646) QuantErr: 0.13646 batch_time=0.43548 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 0.00353 (QuantReg: 0.13741) QuantErr: 0.13741 batch_time=0.45210 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 0.00342 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.42389 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.00265 (QuantReg: 0.13548) QuantErr: 0.13548 batch_time=0.53910 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.00276 (QuantReg: 0.13836) QuantErr: 0.13836 batch_time=0.43214 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 0.00200 (QuantReg: 0.13829) QuantErr: 0.13829 batch_time=0.42281 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 0.00217 (QuantReg: 0.13920) QuantErr: 0.13920 batch_time=0.40853 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 0.00194 (QuantReg: 0.14087) QuantErr: 0.14087 batch_time=0.42845 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.00276 (QuantReg: 0.13627) QuantErr: 0.13627 batch_time=0.41283 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 0.00340 (QuantReg: 0.13654) QuantErr: 0.13654 batch_time=0.42641 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 0.00236 (QuantReg: 0.13741) QuantErr: 0.13741 batch_time=0.45761 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch33.pth ...
Done in 3.619s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch33.pth ...
Done in 7.327s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 0.002839496612548828
 quant_reg      : 0.1377464146018028
 quant_err      : 0.1377464146018028
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.905
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.217670930591225
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.23
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.12533474304985
 mnt_best       : 36.217670930591225
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 0.00289 (QuantReg: 0.13702) QuantErr: 0.13702 batch_time=41.28656 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 0.00195 (QuantReg: 0.13911) QuantErr: 0.13911 batch_time=0.42473 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 0.00386 (QuantReg: 0.13840) QuantErr: 0.13840 batch_time=0.42563 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 0.00245 (QuantReg: 0.13863) QuantErr: 0.13863 batch_time=0.45189 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 0.00339 (QuantReg: 0.13808) QuantErr: 0.13808 batch_time=0.44570 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 0.00267 (QuantReg: 0.13856) QuantErr: 0.13856 batch_time=0.43297 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.00181 (QuantReg: 0.14001) QuantErr: 0.14001 batch_time=0.44155 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 0.00319 (QuantReg: 0.13514) QuantErr: 0.13514 batch_time=0.45472 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 0.00252 (QuantReg: 0.13819) QuantErr: 0.13819 batch_time=0.42292 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 0.00375 (QuantReg: 0.13801) QuantErr: 0.13801 batch_time=0.43080 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 0.00210 (QuantReg: 0.13623) QuantErr: 0.13623 batch_time=0.42378 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 0.00315 (QuantReg: 0.13747) QuantErr: 0.13747 batch_time=0.44023 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 0.00211 (QuantReg: 0.13872) QuantErr: 0.13872 batch_time=0.43065 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 0.00229 (QuantReg: 0.13945) QuantErr: 0.13945 batch_time=0.43082 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 0.00359 (QuantReg: 0.13910) QuantErr: 0.13910 batch_time=0.42578 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 0.00324 (QuantReg: 0.13858) QuantErr: 0.13858 batch_time=0.42246 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 0.00272 (QuantReg: 0.13811) QuantErr: 0.13811 batch_time=0.42270 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 0.00318 (QuantReg: 0.13755) QuantErr: 0.13755 batch_time=0.43128 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 0.00193 (QuantReg: 0.13831) QuantErr: 0.13831 batch_time=0.47993 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 0.00255 (QuantReg: 0.13982) QuantErr: 0.13982 batch_time=0.45794 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 0.00190 (QuantReg: 0.13694) QuantErr: 0.13694 batch_time=0.42627 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 0.00229 (QuantReg: 0.14014) QuantErr: 0.14014 batch_time=0.43015 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 0.00430 (QuantReg: 0.13918) QuantErr: 0.13918 batch_time=0.70250 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch34.pth ...
Done in 14.831s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 0.0027184104919433594
 quant_reg      : 0.13797448998689651
 quant_err      : 0.13797448998689651
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.988
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.46016013063421
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.217
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.598598849560695
 mnt_best       : 36.217670930591225
 not_improved_count: 1
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 0.00299 (QuantReg: 0.13732) QuantErr: 0.13732 batch_time=33.23156 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 0.00336 (QuantReg: 0.13824) QuantErr: 0.13824 batch_time=0.42417 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 0.00222 (QuantReg: 0.13752) QuantErr: 0.13752 batch_time=0.44947 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 0.00296 (QuantReg: 0.13818) QuantErr: 0.13818 batch_time=0.41878 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 0.00175 (QuantReg: 0.13981) QuantErr: 0.13981 batch_time=0.43776 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 0.00220 (QuantReg: 0.13959) QuantErr: 0.13959 batch_time=0.43135 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 0.00312 (QuantReg: 0.13883) QuantErr: 0.13883 batch_time=1.43121 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 0.00373 (QuantReg: 0.13947) QuantErr: 0.13947 batch_time=0.42156 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 0.00298 (QuantReg: 0.13622) QuantErr: 0.13622 batch_time=0.43236 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 0.00291 (QuantReg: 0.13624) QuantErr: 0.13624 batch_time=0.43299 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.00303 (QuantReg: 0.13707) QuantErr: 0.13707 batch_time=0.42873 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 0.00383 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.43878 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 0.00214 (QuantReg: 0.13695) QuantErr: 0.13695 batch_time=0.42869 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 0.00278 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.47575 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 0.00449 (QuantReg: 0.13693) QuantErr: 0.13693 batch_time=0.42510 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.00335 (QuantReg: 0.13817) QuantErr: 0.13817 batch_time=0.43324 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 0.00238 (QuantReg: 0.13751) QuantErr: 0.13751 batch_time=0.42248 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 0.00213 (QuantReg: 0.13765) QuantErr: 0.13765 batch_time=0.42371 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 0.00202 (QuantReg: 0.13800) QuantErr: 0.13800 batch_time=0.43133 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 0.00232 (QuantReg: 0.13854) QuantErr: 0.13854 batch_time=0.42647 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.00287 (QuantReg: 0.13911) QuantErr: 0.13911 batch_time=0.43126 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 0.00216 (QuantReg: 0.13792) QuantErr: 0.13792 batch_time=0.42224 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.00193 (QuantReg: 0.13979) QuantErr: 0.13979 batch_time=0.42124 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch35.pth ...
Done in 4.052s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 0.0027509117126464843
 quant_reg      : 0.13805051565170287
 quant_err      : 0.13805051565170287
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.173
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.64269537646929
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.696
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.189782990091544
 mnt_best       : 36.217670930591225
 not_improved_count: 2
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 0.00247 (QuantReg: 0.13789) QuantErr: 0.13789 batch_time=39.87397 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 0.00277 (QuantReg: 0.13612) QuantErr: 0.13612 batch_time=0.42381 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.00201 (QuantReg: 0.13809) QuantErr: 0.13809 batch_time=0.41947 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 0.00281 (QuantReg: 0.13767) QuantErr: 0.13767 batch_time=0.44750 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 0.00166 (QuantReg: 0.13682) QuantErr: 0.13682 batch_time=0.43627 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.00314 (QuantReg: 0.13800) QuantErr: 0.13800 batch_time=0.42510 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 0.00209 (QuantReg: 0.13990) QuantErr: 0.13990 batch_time=0.42686 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 0.00431 (QuantReg: 0.13920) QuantErr: 0.13920 batch_time=0.44419 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 0.00200 (QuantReg: 0.13773) QuantErr: 0.13773 batch_time=0.41522 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 0.00320 (QuantReg: 0.13869) QuantErr: 0.13869 batch_time=0.41635 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 0.00238 (QuantReg: 0.13810) QuantErr: 0.13810 batch_time=0.42309 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 0.00298 (QuantReg: 0.13998) QuantErr: 0.13998 batch_time=0.41325 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 0.00210 (QuantReg: 0.13916) QuantErr: 0.13916 batch_time=0.42612 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 0.00332 (QuantReg: 0.13938) QuantErr: 0.13938 batch_time=0.41718 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.00240 (QuantReg: 0.13835) QuantErr: 0.13835 batch_time=0.41709 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.00354 (QuantReg: 0.14033) QuantErr: 0.14033 batch_time=0.43242 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 0.00462 (QuantReg: 0.13759) QuantErr: 0.13759 batch_time=0.41934 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.00225 (QuantReg: 0.13825) QuantErr: 0.13825 batch_time=0.46219 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.00315 (QuantReg: 0.13954) QuantErr: 0.13954 batch_time=0.42056 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.00191 (QuantReg: 0.13711) QuantErr: 0.13711 batch_time=0.43041 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.00314 (QuantReg: 0.13975) QuantErr: 0.13975 batch_time=0.43585 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.00264 (QuantReg: 0.13947) QuantErr: 0.13947 batch_time=0.42010 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.00231 (QuantReg: 0.13904) QuantErr: 0.13904 batch_time=0.42157 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch36.pth ...
Done in 12.147s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch36.pth ...
Done in 15.992s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 0.0026981124877929687
 quant_reg      : 0.13842086660861969
 quant_err      : 0.13842086660861969
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.927
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.34804002078472
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.612
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.752941285867664
 mnt_best       : 36.34804002078472
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 0.00345 (QuantReg: 0.13771) QuantErr: 0.13771 batch_time=32.69037 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 0.00274 (QuantReg: 0.13783) QuantErr: 0.13783 batch_time=0.49201 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.00336 (QuantReg: 0.13901) QuantErr: 0.13901 batch_time=0.48219 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 0.00152 (QuantReg: 0.13902) QuantErr: 0.13902 batch_time=1.46828 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 0.00297 (QuantReg: 0.13886) QuantErr: 0.13886 batch_time=0.41864 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 0.00306 (QuantReg: 0.14056) QuantErr: 0.14056 batch_time=0.42043 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 0.00203 (QuantReg: 0.13765) QuantErr: 0.13765 batch_time=2.15665 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 0.00413 (QuantReg: 0.13720) QuantErr: 0.13720 batch_time=0.41941 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 0.00319 (QuantReg: 0.13889) QuantErr: 0.13889 batch_time=0.42303 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.00218 (QuantReg: 0.13881) QuantErr: 0.13881 batch_time=0.44298 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 0.00263 (QuantReg: 0.13632) QuantErr: 0.13632 batch_time=0.42843 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.00225 (QuantReg: 0.13918) QuantErr: 0.13918 batch_time=0.42886 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 0.00326 (QuantReg: 0.13866) QuantErr: 0.13866 batch_time=0.43592 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 0.00274 (QuantReg: 0.13885) QuantErr: 0.13885 batch_time=0.45301 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.00271 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.42602 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.00217 (QuantReg: 0.13844) QuantErr: 0.13844 batch_time=0.42035 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.00235 (QuantReg: 0.13847) QuantErr: 0.13847 batch_time=0.43182 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.00251 (QuantReg: 0.13716) QuantErr: 0.13716 batch_time=0.45956 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 0.00265 (QuantReg: 0.14116) QuantErr: 0.14116 batch_time=0.43199 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 0.00168 (QuantReg: 0.13733) QuantErr: 0.13733 batch_time=0.43051 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 0.00213 (QuantReg: 0.13814) QuantErr: 0.13814 batch_time=0.42648 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 0.00223 (QuantReg: 0.13925) QuantErr: 0.13925 batch_time=0.42597 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 0.00261 (QuantReg: 0.13923) QuantErr: 0.13923 batch_time=0.42932 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch37.pth ...
Done in 3.748s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 0.0026656532287597655
 quant_reg      : 0.1383128547668457
 quant_err      : 0.1383128547668457
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.266
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.21980715255077
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.303
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.17392177735001
 mnt_best       : 36.34804002078472
 not_improved_count: 1
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.00174 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=34.32997 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.00230 (QuantReg: 0.13995) QuantErr: 0.13995 batch_time=0.41392 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.00230 (QuantReg: 0.14004) QuantErr: 0.14004 batch_time=0.45143 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 0.00241 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.55137 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 0.00268 (QuantReg: 0.13815) QuantErr: 0.13815 batch_time=0.43907 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.00279 (QuantReg: 0.13871) QuantErr: 0.13871 batch_time=0.41891 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 0.00373 (QuantReg: 0.13920) QuantErr: 0.13920 batch_time=0.42775 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.00256 (QuantReg: 0.13774) QuantErr: 0.13774 batch_time=0.43137 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 0.00232 (QuantReg: 0.13576) QuantErr: 0.13576 batch_time=1.61353 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.00246 (QuantReg: 0.13560) QuantErr: 0.13560 batch_time=0.52991 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.00262 (QuantReg: 0.13678) QuantErr: 0.13678 batch_time=0.42001 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 0.00260 (QuantReg: 0.13824) QuantErr: 0.13824 batch_time=0.41917 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 0.00187 (QuantReg: 0.13888) QuantErr: 0.13888 batch_time=0.42074 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 0.00201 (QuantReg: 0.13936) QuantErr: 0.13936 batch_time=0.42655 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 0.00226 (QuantReg: 0.13783) QuantErr: 0.13783 batch_time=0.46107 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.00329 (QuantReg: 0.13896) QuantErr: 0.13896 batch_time=0.42542 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.00280 (QuantReg: 0.13731) QuantErr: 0.13731 batch_time=0.43903 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.00297 (QuantReg: 0.13784) QuantErr: 0.13784 batch_time=0.43999 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 0.00296 (QuantReg: 0.13711) QuantErr: 0.13711 batch_time=0.43213 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 0.00163 (QuantReg: 0.13947) QuantErr: 0.13947 batch_time=0.79465 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 0.00310 (QuantReg: 0.14071) QuantErr: 0.14071 batch_time=0.44078 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 0.00208 (QuantReg: 0.13842) QuantErr: 0.13842 batch_time=0.42810 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 0.00243 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.44576 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch38.pth ...
Done in 3.930s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 0.0025950927734375
 quant_reg      : 0.1382783180475235
 quant_err      : 0.1382783180475235
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.664
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.74637686398085
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.6865
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.29231902689352
 mnt_best       : 36.34804002078472
 not_improved_count: 2
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.00251 (QuantReg: 0.13808) QuantErr: 0.13808 batch_time=29.68988 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 0.00222 (QuantReg: 0.14118) QuantErr: 0.14118 batch_time=0.46235 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 0.00222 (QuantReg: 0.13780) QuantErr: 0.13780 batch_time=0.42864 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 0.00299 (QuantReg: 0.13728) QuantErr: 0.13728 batch_time=0.42738 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 0.00169 (QuantReg: 0.13812) QuantErr: 0.13812 batch_time=0.42244 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 0.00281 (QuantReg: 0.13978) QuantErr: 0.13978 batch_time=0.42206 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 0.00248 (QuantReg: 0.13781) QuantErr: 0.13781 batch_time=0.41700 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 0.00212 (QuantReg: 0.13941) QuantErr: 0.13941 batch_time=0.42599 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 0.00251 (QuantReg: 0.13814) QuantErr: 0.13814 batch_time=0.44518 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 0.00311 (QuantReg: 0.13782) QuantErr: 0.13782 batch_time=0.42003 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.00191 (QuantReg: 0.13924) QuantErr: 0.13924 batch_time=0.44676 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.00276 (QuantReg: 0.14091) QuantErr: 0.14091 batch_time=0.41829 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 0.00334 (QuantReg: 0.13854) QuantErr: 0.13854 batch_time=0.42873 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 0.00349 (QuantReg: 0.13891) QuantErr: 0.13891 batch_time=0.42213 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 0.00329 (QuantReg: 0.13775) QuantErr: 0.13775 batch_time=0.42316 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 0.00223 (QuantReg: 0.13638) QuantErr: 0.13638 batch_time=0.46946 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 0.00204 (QuantReg: 0.13952) QuantErr: 0.13952 batch_time=0.42540 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.00361 (QuantReg: 0.13948) QuantErr: 0.13948 batch_time=0.43155 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.00190 (QuantReg: 0.13976) QuantErr: 0.13976 batch_time=4.32778 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 0.00329 (QuantReg: 0.13763) QuantErr: 0.13763 batch_time=0.42483 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 0.00224 (QuantReg: 0.13970) QuantErr: 0.13970 batch_time=0.43337 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 0.00247 (QuantReg: 0.13973) QuantErr: 0.13973 batch_time=0.42675 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.00171 (QuantReg: 0.13732) QuantErr: 0.13732 batch_time=0.43493 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch39.pth ...
Done in 4.394s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 0.002517753601074219
 quant_reg      : 0.13837214773893355
 quant_err      : 0.13837214773893355
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.843
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.77988685348048
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.933
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.890030919117784
 mnt_best       : 36.34804002078472
 not_improved_count: 3
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 0.00228 (QuantReg: 0.13924) QuantErr: 0.13924 batch_time=34.02679 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 0.00277 (QuantReg: 0.13854) QuantErr: 0.13854 batch_time=0.42331 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 0.00193 (QuantReg: 0.13836) QuantErr: 0.13836 batch_time=0.42654 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.00264 (QuantReg: 0.13829) QuantErr: 0.13829 batch_time=0.43012 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 0.00223 (QuantReg: 0.13925) QuantErr: 0.13925 batch_time=0.54856 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 0.00291 (QuantReg: 0.13789) QuantErr: 0.13789 batch_time=0.44390 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 0.00191 (QuantReg: 0.13792) QuantErr: 0.13792 batch_time=0.45904 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 0.00228 (QuantReg: 0.13876) QuantErr: 0.13876 batch_time=0.43380 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 0.00237 (QuantReg: 0.13645) QuantErr: 0.13645 batch_time=0.44054 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.00186 (QuantReg: 0.13684) QuantErr: 0.13684 batch_time=0.42176 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 0.00226 (QuantReg: 0.13753) QuantErr: 0.13753 batch_time=0.43910 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 0.00201 (QuantReg: 0.14085) QuantErr: 0.14085 batch_time=0.52311 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 0.00179 (QuantReg: 0.13874) QuantErr: 0.13874 batch_time=0.44511 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 0.00221 (QuantReg: 0.13834) QuantErr: 0.13834 batch_time=0.43311 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 0.00269 (QuantReg: 0.13714) QuantErr: 0.13714 batch_time=0.43294 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 0.00197 (QuantReg: 0.13975) QuantErr: 0.13975 batch_time=0.42321 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 0.00217 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.42260 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 0.00235 (QuantReg: 0.13894) QuantErr: 0.13894 batch_time=0.45627 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 0.00219 (QuantReg: 0.13887) QuantErr: 0.13887 batch_time=0.42561 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 0.00249 (QuantReg: 0.13973) QuantErr: 0.13973 batch_time=0.45369 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 0.00243 (QuantReg: 0.13966) QuantErr: 0.13966 batch_time=0.42749 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.00220 (QuantReg: 0.13763) QuantErr: 0.13763 batch_time=0.43039 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.00235 (QuantReg: 0.13770) QuantErr: 0.13770 batch_time=0.48101 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch40.pth ...
Done in 12.819s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 0.0024260330200195314
 quant_reg      : 0.13846204257011413
 quant_err      : 0.13846204257011413
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.598
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.526242316927465
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.4
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.420915408046824
 mnt_best       : 36.34804002078472
 not_improved_count: 4
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.00200 (QuantReg: 0.13896) QuantErr: 0.13896 batch_time=31.04187 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 0.00181 (QuantReg: 0.13890) QuantErr: 0.13890 batch_time=0.41748 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 0.00223 (QuantReg: 0.13819) QuantErr: 0.13819 batch_time=0.42211 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 0.00286 (QuantReg: 0.13743) QuantErr: 0.13743 batch_time=0.41920 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 0.00351 (QuantReg: 0.13691) QuantErr: 0.13691 batch_time=0.41151 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.00184 (QuantReg: 0.13782) QuantErr: 0.13782 batch_time=0.42006 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.00237 (QuantReg: 0.13850) QuantErr: 0.13850 batch_time=0.44278 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.00234 (QuantReg: 0.14021) QuantErr: 0.14021 batch_time=0.43742 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 0.00245 (QuantReg: 0.14054) QuantErr: 0.14054 batch_time=0.78969 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 0.00224 (QuantReg: 0.13753) QuantErr: 0.13753 batch_time=0.42461 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 0.00317 (QuantReg: 0.13950) QuantErr: 0.13950 batch_time=0.43392 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 0.00205 (QuantReg: 0.13894) QuantErr: 0.13894 batch_time=0.42564 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 0.00258 (QuantReg: 0.13747) QuantErr: 0.13747 batch_time=0.42400 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 0.00190 (QuantReg: 0.13553) QuantErr: 0.13553 batch_time=1.37771 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 0.00221 (QuantReg: 0.13804) QuantErr: 0.13804 batch_time=0.41989 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 0.00240 (QuantReg: 0.13881) QuantErr: 0.13881 batch_time=0.41625 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 0.00207 (QuantReg: 0.13774) QuantErr: 0.13774 batch_time=0.43078 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.00237 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.42636 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 0.00523 (QuantReg: 0.13954) QuantErr: 0.13954 batch_time=0.42792 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 0.00239 (QuantReg: 0.13704) QuantErr: 0.13704 batch_time=0.45020 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 0.00216 (QuantReg: 0.13776) QuantErr: 0.13776 batch_time=0.42740 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 0.00242 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=0.42535 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 0.00156 (QuantReg: 0.13827) QuantErr: 0.13827 batch_time=0.43243 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch41.pth ...
Done in 3.997s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 0.002458812713623047
 quant_reg      : 0.138442577958107
 quant_err      : 0.138442577958107
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.68
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.98865700456793
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.672
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.845029943259135
 mnt_best       : 36.34804002078472
 not_improved_count: 5
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 0.00212 (QuantReg: 0.13757) QuantErr: 0.13757 batch_time=30.32554 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.00253 (QuantReg: 0.13882) QuantErr: 0.13882 batch_time=0.42284 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 0.00245 (QuantReg: 0.13922) QuantErr: 0.13922 batch_time=0.41849 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 0.00236 (QuantReg: 0.13708) QuantErr: 0.13708 batch_time=0.41985 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 0.00325 (QuantReg: 0.13796) QuantErr: 0.13796 batch_time=0.41626 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 0.00230 (QuantReg: 0.13678) QuantErr: 0.13678 batch_time=0.43330 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 0.00283 (QuantReg: 0.13963) QuantErr: 0.13963 batch_time=0.45043 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 0.00276 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.42270 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.00212 (QuantReg: 0.14231) QuantErr: 0.14231 batch_time=0.46746 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 0.00258 (QuantReg: 0.13703) QuantErr: 0.13703 batch_time=0.44546 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 0.00484 (QuantReg: 0.13917) QuantErr: 0.13917 batch_time=0.41647 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 0.00286 (QuantReg: 0.13707) QuantErr: 0.13707 batch_time=0.44789 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 0.00315 (QuantReg: 0.13696) QuantErr: 0.13696 batch_time=0.43985 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.00395 (QuantReg: 0.13678) QuantErr: 0.13678 batch_time=0.43247 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 0.00139 (QuantReg: 0.13800) QuantErr: 0.13800 batch_time=0.41799 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 0.00165 (QuantReg: 0.13815) QuantErr: 0.13815 batch_time=0.44804 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.00276 (QuantReg: 0.13705) QuantErr: 0.13705 batch_time=0.62249 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.00329 (QuantReg: 0.13726) QuantErr: 0.13726 batch_time=0.41992 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.00227 (QuantReg: 0.13613) QuantErr: 0.13613 batch_time=0.41682 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 0.00182 (QuantReg: 0.13749) QuantErr: 0.13749 batch_time=0.44888 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.00352 (QuantReg: 0.13701) QuantErr: 0.13701 batch_time=0.41505 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.00185 (QuantReg: 0.13754) QuantErr: 0.13754 batch_time=1.11840 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 0.00319 (QuantReg: 0.13920) QuantErr: 0.13920 batch_time=0.42671 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch42.pth ...
Done in 3.995s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 0.0024889068603515625
 quant_reg      : 0.1381944534778595
 quant_err      : 0.1381944534778595
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.254
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.940522157439325
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.699
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.62763199449183
 mnt_best       : 36.34804002078472
 not_improved_count: 6
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.00251 (QuantReg: 0.14003) QuantErr: 0.14003 batch_time=32.71609 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.00243 (QuantReg: 0.13721) QuantErr: 0.13721 batch_time=0.43023 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 0.00250 (QuantReg: 0.13601) QuantErr: 0.13601 batch_time=0.43574 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 0.00281 (QuantReg: 0.13811) QuantErr: 0.13811 batch_time=0.45239 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 0.00319 (QuantReg: 0.13842) QuantErr: 0.13842 batch_time=0.43882 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 0.00332 (QuantReg: 0.13870) QuantErr: 0.13870 batch_time=0.42413 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 0.00199 (QuantReg: 0.13712) QuantErr: 0.13712 batch_time=0.42403 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 0.00226 (QuantReg: 0.13588) QuantErr: 0.13588 batch_time=0.42467 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.00217 (QuantReg: 0.13982) QuantErr: 0.13982 batch_time=0.44560 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 0.00281 (QuantReg: 0.13659) QuantErr: 0.13659 batch_time=0.94048 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 0.00257 (QuantReg: 0.14033) QuantErr: 0.14033 batch_time=0.42501 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.00255 (QuantReg: 0.13952) QuantErr: 0.13952 batch_time=0.44099 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 0.00173 (QuantReg: 0.14005) QuantErr: 0.14005 batch_time=0.43116 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.00193 (QuantReg: 0.13815) QuantErr: 0.13815 batch_time=0.48023 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 0.00348 (QuantReg: 0.13890) QuantErr: 0.13890 batch_time=0.41609 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 0.00190 (QuantReg: 0.13832) QuantErr: 0.13832 batch_time=0.42806 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.00256 (QuantReg: 0.13778) QuantErr: 0.13778 batch_time=0.44548 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.00217 (QuantReg: 0.13962) QuantErr: 0.13962 batch_time=0.44906 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 0.00237 (QuantReg: 0.13583) QuantErr: 0.13583 batch_time=1.29663 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 0.00318 (QuantReg: 0.13671) QuantErr: 0.13671 batch_time=0.47600 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 0.00279 (QuantReg: 0.13686) QuantErr: 0.13686 batch_time=0.42080 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.00222 (QuantReg: 0.13996) QuantErr: 0.13996 batch_time=0.43047 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 0.00241 (QuantReg: 0.13772) QuantErr: 0.13772 batch_time=0.42640 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch43.pth ...
Done in 3.986s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 0.0023748397827148436
 quant_reg      : 0.13810951048135758
 quant_err      : 0.13810951048135758
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.023
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.770968838585134
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.857
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.28467353802049
 mnt_best       : 36.34804002078472
 not_improved_count: 7
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.00204 (QuantReg: 0.13717) QuantErr: 0.13717 batch_time=33.32311 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 0.00238 (QuantReg: 0.13642) QuantErr: 0.13642 batch_time=0.42995 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 0.00341 (QuantReg: 0.13985) QuantErr: 0.13985 batch_time=0.56450 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.00244 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.42805 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 0.00224 (QuantReg: 0.14010) QuantErr: 0.14010 batch_time=0.42342 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 0.00291 (QuantReg: 0.13875) QuantErr: 0.13875 batch_time=0.43274 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 0.00233 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.42049 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 0.00198 (QuantReg: 0.13826) QuantErr: 0.13826 batch_time=2.01317 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 0.00292 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.45074 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 0.00204 (QuantReg: 0.13606) QuantErr: 0.13606 batch_time=0.43559 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 0.00235 (QuantReg: 0.13782) QuantErr: 0.13782 batch_time=0.46549 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 0.00200 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.43866 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 0.00203 (QuantReg: 0.13759) QuantErr: 0.13759 batch_time=0.44856 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 0.00193 (QuantReg: 0.13725) QuantErr: 0.13725 batch_time=0.42723 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 0.00300 (QuantReg: 0.13915) QuantErr: 0.13915 batch_time=0.43142 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 0.00361 (QuantReg: 0.14001) QuantErr: 0.14001 batch_time=0.41858 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 0.00180 (QuantReg: 0.13923) QuantErr: 0.13923 batch_time=0.42941 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.00224 (QuantReg: 0.13933) QuantErr: 0.13933 batch_time=0.42160 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 0.00255 (QuantReg: 0.13879) QuantErr: 0.13879 batch_time=0.44272 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 0.00216 (QuantReg: 0.13973) QuantErr: 0.13973 batch_time=0.45561 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 0.00209 (QuantReg: 0.14163) QuantErr: 0.14163 batch_time=1.86570 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.00226 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.98375 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 0.00197 (QuantReg: 0.13849) QuantErr: 0.13849 batch_time=0.43779 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch44.pth ...
Done in 14.066s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch44.pth ...
Done in 17.982s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 0.002326671600341797
 quant_reg      : 0.1381721447110176
 quant_err      : 0.1381721447110176
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.908
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.67304333541912
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.291
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.70404418059497
 mnt_best       : 36.67304333541912
 not_improved_count: 0
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 0.00201 (QuantReg: 0.13780) QuantErr: 0.13780 batch_time=34.82198 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.00205 (QuantReg: 0.13987) QuantErr: 0.13987 batch_time=0.42344 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.00345 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.42502 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 0.00160 (QuantReg: 0.13791) QuantErr: 0.13791 batch_time=0.45618 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 0.00268 (QuantReg: 0.13774) QuantErr: 0.13774 batch_time=0.42425 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 0.00228 (QuantReg: 0.13740) QuantErr: 0.13740 batch_time=0.43582 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.00244 (QuantReg: 0.13738) QuantErr: 0.13738 batch_time=0.76677 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 0.00233 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.42609 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 0.00179 (QuantReg: 0.13850) QuantErr: 0.13850 batch_time=0.42338 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.00199 (QuantReg: 0.13757) QuantErr: 0.13757 batch_time=0.44278 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.00213 (QuantReg: 0.13628) QuantErr: 0.13628 batch_time=0.41901 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 0.00238 (QuantReg: 0.13944) QuantErr: 0.13944 batch_time=0.43812 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.00208 (QuantReg: 0.13510) QuantErr: 0.13510 batch_time=0.42042 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 0.00203 (QuantReg: 0.13977) QuantErr: 0.13977 batch_time=0.42725 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 0.00260 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.42210 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.00216 (QuantReg: 0.13762) QuantErr: 0.13762 batch_time=0.76689 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 0.00368 (QuantReg: 0.13895) QuantErr: 0.13895 batch_time=0.45176 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 0.00289 (QuantReg: 0.13956) QuantErr: 0.13956 batch_time=0.44424 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.00180 (QuantReg: 0.13822) QuantErr: 0.13822 batch_time=1.51905 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.00150 (QuantReg: 0.13676) QuantErr: 0.13676 batch_time=0.42794 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 0.00201 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.43393 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.00229 (QuantReg: 0.13871) QuantErr: 0.13871 batch_time=0.45208 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 0.00372 (QuantReg: 0.13703) QuantErr: 0.13703 batch_time=0.44266 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch45.pth ...
Done in 11.457s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 0.002273284912109375
 quant_reg      : 0.13792194181680678
 quant_err      : 0.13792194181680678
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.825
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.50121169430912
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.838
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.79097094051214
 mnt_best       : 36.67304333541912
 not_improved_count: 1
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.00206 (QuantReg: 0.13780) QuantErr: 0.13780 batch_time=32.66812 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 0.00190 (QuantReg: 0.13980) QuantErr: 0.13980 batch_time=0.42656 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.00249 (QuantReg: 0.13796) QuantErr: 0.13796 batch_time=0.41214 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.00319 (QuantReg: 0.13795) QuantErr: 0.13795 batch_time=0.49425 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 0.00218 (QuantReg: 0.13996) QuantErr: 0.13996 batch_time=0.43112 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 0.00143 (QuantReg: 0.13785) QuantErr: 0.13785 batch_time=0.41783 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.00191 (QuantReg: 0.13949) QuantErr: 0.13949 batch_time=0.42117 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 0.00242 (QuantReg: 0.13894) QuantErr: 0.13894 batch_time=0.42337 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.00239 (QuantReg: 0.13758) QuantErr: 0.13758 batch_time=0.42314 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.00245 (QuantReg: 0.13842) QuantErr: 0.13842 batch_time=0.42228 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 0.00228 (QuantReg: 0.13786) QuantErr: 0.13786 batch_time=0.42364 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 0.00194 (QuantReg: 0.13908) QuantErr: 0.13908 batch_time=0.41134 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 0.00301 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.43337 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 0.00402 (QuantReg: 0.13791) QuantErr: 0.13791 batch_time=0.42384 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 0.00266 (QuantReg: 0.13811) QuantErr: 0.13811 batch_time=0.46334 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 0.00217 (QuantReg: 0.13746) QuantErr: 0.13746 batch_time=0.42820 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 0.00181 (QuantReg: 0.13693) QuantErr: 0.13693 batch_time=0.41734 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 0.00200 (QuantReg: 0.13604) QuantErr: 0.13604 batch_time=0.42838 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.00353 (QuantReg: 0.13701) QuantErr: 0.13701 batch_time=0.86572 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.00197 (QuantReg: 0.13893) QuantErr: 0.13893 batch_time=0.44248 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.00301 (QuantReg: 0.13791) QuantErr: 0.13791 batch_time=0.49276 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 0.00151 (QuantReg: 0.13938) QuantErr: 0.13938 batch_time=0.41909 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.00215 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.43824 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch46.pth ...
Done in 15.796s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 0.0022369384765625
 quant_reg      : 0.1379538538455963
 quant_err      : 0.1379538538455963
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.945
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.403171643292424
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.674
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.785119219779354
 mnt_best       : 36.67304333541912
 not_improved_count: 2
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 0.00169 (QuantReg: 0.13646) QuantErr: 0.13646 batch_time=31.00499 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 0.00180 (QuantReg: 0.13957) QuantErr: 0.13957 batch_time=0.45546 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 0.00211 (QuantReg: 0.13723) QuantErr: 0.13723 batch_time=0.52428 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 0.00234 (QuantReg: 0.13856) QuantErr: 0.13856 batch_time=0.42542 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 0.00174 (QuantReg: 0.13836) QuantErr: 0.13836 batch_time=0.45517 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.00235 (QuantReg: 0.13663) QuantErr: 0.13663 batch_time=0.42645 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 0.00402 (QuantReg: 0.13939) QuantErr: 0.13939 batch_time=0.45451 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 0.00164 (QuantReg: 0.13917) QuantErr: 0.13917 batch_time=0.45974 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 0.00244 (QuantReg: 0.13888) QuantErr: 0.13888 batch_time=0.43468 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.00236 (QuantReg: 0.13559) QuantErr: 0.13559 batch_time=0.46936 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.00143 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.44141 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.00166 (QuantReg: 0.13567) QuantErr: 0.13567 batch_time=0.42709 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 0.00216 (QuantReg: 0.13857) QuantErr: 0.13857 batch_time=0.43708 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.00255 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.43099 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 0.00244 (QuantReg: 0.13890) QuantErr: 0.13890 batch_time=1.79611 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.00242 (QuantReg: 0.13890) QuantErr: 0.13890 batch_time=0.44023 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 0.00229 (QuantReg: 0.13852) QuantErr: 0.13852 batch_time=0.66219 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 0.00256 (QuantReg: 0.13858) QuantErr: 0.13858 batch_time=0.42441 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 0.00307 (QuantReg: 0.13802) QuantErr: 0.13802 batch_time=0.45523 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.00186 (QuantReg: 0.13804) QuantErr: 0.13804 batch_time=2.62002 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.00244 (QuantReg: 0.13705) QuantErr: 0.13705 batch_time=0.42850 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 0.00219 (QuantReg: 0.13842) QuantErr: 0.13842 batch_time=0.43910 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 0.00181 (QuantReg: 0.14046) QuantErr: 0.14046 batch_time=0.44174 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch47.pth ...
Done in 16.781s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch47.pth ...
Done in 20.454s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 0.00217132568359375
 quant_reg      : 0.13815370124578477
 quant_err      : 0.13815370124578477
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.503
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.07874148701436
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.346
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.68253523598326
 mnt_best       : 37.07874148701436
 not_improved_count: 0
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 0.00154 (QuantReg: 0.13844) QuantErr: 0.13844 batch_time=28.40236 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 0.00309 (QuantReg: 0.13920) QuantErr: 0.13920 batch_time=0.46458 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 0.00233 (QuantReg: 0.13849) QuantErr: 0.13849 batch_time=0.66235 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 0.00149 (QuantReg: 0.13760) QuantErr: 0.13760 batch_time=0.44436 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 0.00218 (QuantReg: 0.13830) QuantErr: 0.13830 batch_time=0.42135 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 0.00253 (QuantReg: 0.13617) QuantErr: 0.13617 batch_time=0.43545 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 0.00218 (QuantReg: 0.14020) QuantErr: 0.14020 batch_time=0.41456 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 0.00241 (QuantReg: 0.13743) QuantErr: 0.13743 batch_time=0.42110 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.00233 (QuantReg: 0.13803) QuantErr: 0.13803 batch_time=0.42065 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 0.00187 (QuantReg: 0.13926) QuantErr: 0.13926 batch_time=0.43791 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 0.00209 (QuantReg: 0.13859) QuantErr: 0.13859 batch_time=0.44647 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 0.00242 (QuantReg: 0.13727) QuantErr: 0.13727 batch_time=0.44379 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 0.00159 (QuantReg: 0.13860) QuantErr: 0.13860 batch_time=0.43009 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 0.00202 (QuantReg: 0.13756) QuantErr: 0.13756 batch_time=1.39954 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 0.00217 (QuantReg: 0.13793) QuantErr: 0.13793 batch_time=0.42934 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 0.00191 (QuantReg: 0.13639) QuantErr: 0.13639 batch_time=0.42712 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.00197 (QuantReg: 0.13825) QuantErr: 0.13825 batch_time=0.45028 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 0.00241 (QuantReg: 0.13944) QuantErr: 0.13944 batch_time=0.45445 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 0.00280 (QuantReg: 0.13963) QuantErr: 0.13963 batch_time=0.43901 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 0.00284 (QuantReg: 0.13958) QuantErr: 0.13958 batch_time=1.08888 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 0.00253 (QuantReg: 0.13832) QuantErr: 0.13832 batch_time=0.42355 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 0.00209 (QuantReg: 0.13771) QuantErr: 0.13771 batch_time=0.44380 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 0.00179 (QuantReg: 0.13765) QuantErr: 0.13765 batch_time=0.46519 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch48.pth ...
Done in 9.251s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch48.pth ...
Done in 13.100s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 0.0022306365966796877
 quant_reg      : 0.13828605830669402
 quant_err      : 0.13828605830669402
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.43
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.247966797422016
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.1955
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.02880180242654
 mnt_best       : 37.247966797422016
 not_improved_count: 0
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 0.00185 (QuantReg: 0.14122) QuantErr: 0.14122 batch_time=28.29574 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 0.00241 (QuantReg: 0.13917) QuantErr: 0.13917 batch_time=0.43008 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 0.00183 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.42603 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 0.00232 (QuantReg: 0.13613) QuantErr: 0.13613 batch_time=0.42945 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 0.00194 (QuantReg: 0.14015) QuantErr: 0.14015 batch_time=0.44150 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 0.00228 (QuantReg: 0.13537) QuantErr: 0.13537 batch_time=0.42836 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 0.00348 (QuantReg: 0.14019) QuantErr: 0.14019 batch_time=3.36886 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.00202 (QuantReg: 0.13675) QuantErr: 0.13675 batch_time=0.42672 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.00142 (QuantReg: 0.13984) QuantErr: 0.13984 batch_time=0.41873 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.00228 (QuantReg: 0.13777) QuantErr: 0.13777 batch_time=0.41882 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 0.00236 (QuantReg: 0.13797) QuantErr: 0.13797 batch_time=0.63991 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.00161 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.47568 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 0.00263 (QuantReg: 0.13768) QuantErr: 0.13768 batch_time=0.43535 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 0.00181 (QuantReg: 0.13736) QuantErr: 0.13736 batch_time=0.42783 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 0.00299 (QuantReg: 0.13787) QuantErr: 0.13787 batch_time=0.42192 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.00272 (QuantReg: 0.13642) QuantErr: 0.13642 batch_time=0.41930 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.00211 (QuantReg: 0.13745) QuantErr: 0.13745 batch_time=0.44062 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 0.00271 (QuantReg: 0.13961) QuantErr: 0.13961 batch_time=0.42776 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 0.00179 (QuantReg: 0.13848) QuantErr: 0.13848 batch_time=0.41838 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 0.00211 (QuantReg: 0.13957) QuantErr: 0.13957 batch_time=1.80693 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 0.00190 (QuantReg: 0.13876) QuantErr: 0.13876 batch_time=0.42337 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.00163 (QuantReg: 0.13822) QuantErr: 0.13822 batch_time=0.44578 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 0.00161 (QuantReg: 0.13840) QuantErr: 0.13840 batch_time=0.43118 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch49.pth ...
Done in 4.522s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch49.pth ...
Done in 8.493s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 0.002201805114746094
 quant_reg      : 0.13804703372716903
 quant_err      : 0.13804703372716903
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.818
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.2495163818719
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.815
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.40363048250138
 mnt_best       : 37.2495163818719
 not_improved_count: 0
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 0.00224 (QuantReg: 0.13869) QuantErr: 0.13869 batch_time=28.79363 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 0.00206 (QuantReg: 0.13725) QuantErr: 0.13725 batch_time=0.42538 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 0.00218 (QuantReg: 0.14059) QuantErr: 0.14059 batch_time=0.42195 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 0.00317 (QuantReg: 0.14159) QuantErr: 0.14159 batch_time=0.42971 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 0.00245 (QuantReg: 0.13913) QuantErr: 0.13913 batch_time=0.42515 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.00222 (QuantReg: 0.13756) QuantErr: 0.13756 batch_time=0.42965 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 0.00312 (QuantReg: 0.13785) QuantErr: 0.13785 batch_time=1.58026 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.00168 (QuantReg: 0.13834) QuantErr: 0.13834 batch_time=0.41349 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.00264 (QuantReg: 0.13834) QuantErr: 0.13834 batch_time=0.42277 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 0.00248 (QuantReg: 0.13700) QuantErr: 0.13700 batch_time=0.42807 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.00169 (QuantReg: 0.13966) QuantErr: 0.13966 batch_time=0.45769 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.00213 (QuantReg: 0.14012) QuantErr: 0.14012 batch_time=0.42083 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 0.00168 (QuantReg: 0.14093) QuantErr: 0.14093 batch_time=0.41885 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 0.00207 (QuantReg: 0.13707) QuantErr: 0.13707 batch_time=0.54128 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 0.00199 (QuantReg: 0.13698) QuantErr: 0.13698 batch_time=0.44351 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.00233 (QuantReg: 0.13835) QuantErr: 0.13835 batch_time=0.48761 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 0.00200 (QuantReg: 0.13983) QuantErr: 0.13983 batch_time=0.44010 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 0.00206 (QuantReg: 0.13800) QuantErr: 0.13800 batch_time=0.51028 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.00288 (QuantReg: 0.13718) QuantErr: 0.13718 batch_time=2.19269 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.00190 (QuantReg: 0.13612) QuantErr: 0.13612 batch_time=0.42831 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 0.00199 (QuantReg: 0.13694) QuantErr: 0.13694 batch_time=0.42013 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 0.00221 (QuantReg: 0.13916) QuantErr: 0.13916 batch_time=0.42308 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 0.00228 (QuantReg: 0.13855) QuantErr: 0.13855 batch_time=0.42677 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch50.pth ...
Done in 3.934s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/checkpoint-epoch50.pth ...
Done in 7.750s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 0.002216991424560547
 quant_reg      : 0.13807891303300857
 quant_err      : 0.13807891303300857
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.115
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.74595450997598
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.631
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.91888885633012
 mnt_best       : 37.74595450997598
 not_improved_count: 0
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/trained_model.pth ...
Ckpt loaded at epoch 50.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 18.9
 t2v_metrics/R5/final_eval: 46.8
 t2v_metrics/R10/final_eval: 60.8
 t2v_metrics/R50/final_eval: 87.9
 t2v_metrics/MedR/final_eval: 6.0
 t2v_metrics/MeanR/final_eval: 29.115
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 37.74595450997598
 v2t_metrics/R1/final_eval: 18.2
 v2t_metrics/R5/final_eval: 47.4
 v2t_metrics/R10/final_eval: 63.2
 v2t_metrics/R50/final_eval: 87.8
 v2t_metrics/MedR/final_eval: 6.0
 v2t_metrics/MeanR/final_eval: 26.631
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 37.91888885633012
Best epoch for the monitored metric: 50
Script took 03h06m53s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kA/trained_model.pth
