Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB
Preparing the dataloaders ...
Loading dataset MSRVTT_miech_trainval in ram ...
Finish loading dataset MSRVTT_miech_trainval in ram, taking 379.74728417396545 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 66.88046956062317 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 47.25347709655762 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch0.pth ...
Done in 1.574s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch0.pth ...
Done in 3.097s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_miech_test/t2v_metrics/R1: 0.2
 MSRVTT_miech_test/t2v_metrics/R5: 0.6
 MSRVTT_miech_test/t2v_metrics/R10: 0.9
 MSRVTT_miech_test/t2v_metrics/R50: 5.2
 MSRVTT_miech_test/t2v_metrics/MedR: 514.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 503.203
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.47622031559045985
 MSRVTT_miech_test/v2t_metrics/R1: 0.1
 MSRVTT_miech_test/v2t_metrics/R5: 0.3
 MSRVTT_miech_test/v2t_metrics/R10: 1.1
 MSRVTT_miech_test/v2t_metrics/R50: 4.9
 MSRVTT_miech_test/v2t_metrics/MedR: 496.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 503.3395
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.32075343299958264
 mnt_best       : 0.47622031559045985
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.81301 batch_time=20.68054 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.51052 batch_time=0.35663 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.10561 batch_time=0.49005 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.79951 batch_time=0.34142 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.68773 batch_time=0.35577 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.07005 batch_time=0.38790 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.62990 batch_time=0.37594 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.77235 batch_time=0.36710 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.97230 batch_time=0.35833 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.23799 batch_time=0.37515 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.34634 batch_time=0.38769 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 5.04708 batch_time=0.39643 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 4.75130 batch_time=0.41639 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.62108 batch_time=0.37549 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.55384 batch_time=0.36827 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.65518 batch_time=0.36450 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.51432 batch_time=0.34794 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 5.37140 batch_time=0.35830 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.36436 batch_time=0.35655 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 3.68632 batch_time=0.36921 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 3.82443 batch_time=0.37674 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.69323 batch_time=0.35044 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.83129 batch_time=0.38771 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch1.pth ...
Done in 4.005s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch1.pth ...
Done in 7.866s
 epoch          : 1
 loss           : 5.336124703407288
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_miech_test/t2v_metrics/R1: 13.3
 MSRVTT_miech_test/t2v_metrics/R5: 37.4
 MSRVTT_miech_test/t2v_metrics/R10: 51.2
 MSRVTT_miech_test/t2v_metrics/R50: 83.1
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 41.338
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.42147227418173
 MSRVTT_miech_test/v2t_metrics/R1: 14.0
 MSRVTT_miech_test/v2t_metrics/R5: 38.3
 MSRVTT_miech_test/v2t_metrics/R10: 51.5
 MSRVTT_miech_test/v2t_metrics/R50: 82.5
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 40.6855
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.225814513962185
 mnt_best       : 29.42147227418173
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 3.61214 batch_time=27.56297 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.35404 batch_time=0.41324 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 3.78257 batch_time=0.38241 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 4.13511 batch_time=0.37122 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.75864 batch_time=0.35476 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 3.49039 batch_time=0.35366 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 3.84900 batch_time=0.34348 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.93844 batch_time=0.35036 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 3.67693 batch_time=0.35193 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 3.48052 batch_time=0.36386 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.45724 batch_time=0.36282 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.97946 batch_time=0.35633 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.21649 batch_time=5.28163 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 3.55057 batch_time=0.34521 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 2.97193 batch_time=0.38915 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.47757 batch_time=0.35260 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.28672 batch_time=0.35835 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 4.07319 batch_time=0.35577 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.22883 batch_time=0.35478 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.57827 batch_time=0.35424 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.22640 batch_time=0.58992 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.72927 batch_time=0.35080 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.50107 batch_time=0.35036 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch2.pth ...
Done in 3.855s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch2.pth ...
Done in 7.591s
removing stale ckpt [epoch 1] [took 0.03s]
removing stale ckpt [epoch 0] [took 0.02s]
 epoch          : 2
 loss           : 3.668350088119507
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_miech_test/t2v_metrics/R1: 16.8
 MSRVTT_miech_test/t2v_metrics/R5: 42.7
 MSRVTT_miech_test/t2v_metrics/R10: 58.0
 MSRVTT_miech_test/t2v_metrics/R50: 85.0
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.319
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.65147427662521
 MSRVTT_miech_test/v2t_metrics/R1: 15.7
 MSRVTT_miech_test/v2t_metrics/R5: 43.6
 MSRVTT_miech_test/v2t_metrics/R10: 58.6
 MSRVTT_miech_test/v2t_metrics/R50: 86.0
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.3435
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.2316567911028
 mnt_best       : 34.65147427662521
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.85604 batch_time=25.80228 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.32972 batch_time=0.34142 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.33273 batch_time=0.33935 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 3.12736 batch_time=0.38966 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.37505 batch_time=0.63811 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 3.24445 batch_time=0.35001 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.35771 batch_time=2.83152 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.31402 batch_time=0.36971 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.14861 batch_time=0.39184 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 2.98134 batch_time=0.39607 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.41648 batch_time=0.38271 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.08556 batch_time=0.53938 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.49060 batch_time=0.36224 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.48905 batch_time=0.37703 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.09768 batch_time=0.37647 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.67791 batch_time=0.35881 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 2.97187 batch_time=0.39742 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 2.57511 batch_time=0.40423 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.10334 batch_time=0.38667 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 2.51827 batch_time=0.34492 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 2.76552 batch_time=0.36238 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.54261 batch_time=0.35045 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.60128 batch_time=0.34462 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch3.pth ...
Done in 3.915s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch3.pth ...
Done in 7.680s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 3.067719319343567
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_miech_test/t2v_metrics/R1: 19.2
 MSRVTT_miech_test/t2v_metrics/R5: 45.7
 MSRVTT_miech_test/t2v_metrics/R10: 58.5
 MSRVTT_miech_test/t2v_metrics/R50: 86.5
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.046
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.164169453788205
 MSRVTT_miech_test/v2t_metrics/R1: 18.4
 MSRVTT_miech_test/v2t_metrics/R5: 47.4
 MSRVTT_miech_test/v2t_metrics/R10: 59.7
 MSRVTT_miech_test/v2t_metrics/R50: 86.9
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.7985
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.34136292707899
 mnt_best       : 37.164169453788205
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 2.90370 batch_time=25.20949 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.74206 batch_time=0.57948 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.97002 batch_time=0.36488 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 3.05718 batch_time=0.35592 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.89057 batch_time=0.41745 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.38286 batch_time=0.38073 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 3.02573 batch_time=0.42150 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 3.04091 batch_time=0.38127 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 2.82917 batch_time=0.36843 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.80626 batch_time=0.35677 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 3.08599 batch_time=0.36959 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.68519 batch_time=0.37094 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 2.41285 batch_time=0.35928 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.94896 batch_time=0.38713 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.71765 batch_time=0.36409 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.73569 batch_time=0.34302 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.26930 batch_time=0.36711 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.87302 batch_time=0.35586 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.87631 batch_time=0.40082 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.89010 batch_time=0.74819 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.84118 batch_time=1.26823 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 3.11151 batch_time=0.38761 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.72281 batch_time=0.35587 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch4.pth ...
Done in 3.764s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch4.pth ...
Done in 7.905s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 2.715348472595215
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_miech_test/t2v_metrics/R1: 18.8
 MSRVTT_miech_test/t2v_metrics/R5: 46.1
 MSRVTT_miech_test/t2v_metrics/R10: 60.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.179
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.469896076938866
 MSRVTT_miech_test/v2t_metrics/R1: 19.6
 MSRVTT_miech_test/v2t_metrics/R5: 46.4
 MSRVTT_miech_test/v2t_metrics/R10: 61.6
 MSRVTT_miech_test/v2t_metrics/R50: 86.6
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 30.426
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.26352013258008
 mnt_best       : 37.469896076938866
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.76511 batch_time=23.83909 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 2.59770 batch_time=0.36498 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.59699 batch_time=0.35230 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.36201 batch_time=0.39964 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.10042 batch_time=0.71424 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.46977 batch_time=0.35665 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.29154 batch_time=1.44292 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 2.30084 batch_time=0.35144 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.53296 batch_time=0.35741 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 1.98317 batch_time=0.34547 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.25765 batch_time=0.41091 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.39943 batch_time=0.39978 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.39108 batch_time=0.34812 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.54602 batch_time=0.56155 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.66904 batch_time=0.36861 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.36406 batch_time=0.35526 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.49855 batch_time=0.38978 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.55291 batch_time=0.41336 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.43786 batch_time=0.34735 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.16695 batch_time=0.41915 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 1.94490 batch_time=0.35436 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.47068 batch_time=0.34302 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.36113 batch_time=0.37014 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch5.pth ...
Done in 3.520s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch5.pth ...
Done in 7.048s
removing stale ckpt [epoch 4] [took 0.03s]
 epoch          : 5
 loss           : 2.4457504491806032
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_miech_test/t2v_metrics/R1: 18.7
 MSRVTT_miech_test/t2v_metrics/R5: 48.0
 MSRVTT_miech_test/t2v_metrics/R10: 61.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.1
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.99338758442951
 MSRVTT_miech_test/v2t_metrics/R1: 20.0
 MSRVTT_miech_test/v2t_metrics/R5: 48.9
 MSRVTT_miech_test/v2t_metrics/R10: 62.6
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.39
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.41283991493113
 mnt_best       : 37.99338758442951
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.24500 batch_time=25.84644 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.34721 batch_time=0.34611 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.59372 batch_time=0.36045 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.36703 batch_time=0.34155 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.43131 batch_time=0.36063 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.35656 batch_time=0.34924 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.71568 batch_time=3.75456 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.24728 batch_time=0.33973 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.45869 batch_time=0.35651 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.53544 batch_time=0.35322 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.29201 batch_time=0.35302 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 1.78285 batch_time=0.35075 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.97119 batch_time=0.38638 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.25519 batch_time=0.41799 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 1.84983 batch_time=0.36999 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 1.87494 batch_time=0.35663 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.06321 batch_time=0.48792 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.23616 batch_time=0.36447 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.61769 batch_time=0.60031 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.19221 batch_time=0.36128 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 1.87513 batch_time=0.34885 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.26768 batch_time=0.35480 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 1.91976 batch_time=0.37817 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch6.pth ...
Done in 4.024s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch6.pth ...
Done in 7.921s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 2.2521901683807375
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_miech_test/t2v_metrics/R1: 20.0
 MSRVTT_miech_test/t2v_metrics/R5: 49.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.086
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.907703866056416
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.3
 MSRVTT_miech_test/v2t_metrics/R10: 64.8
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.3025
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.71265918314143
 mnt_best       : 39.907703866056416
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.54986 batch_time=25.59043 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.28502 batch_time=0.79748 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.29780 batch_time=0.38928 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.35498 batch_time=0.37872 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.86906 batch_time=0.40055 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.41225 batch_time=0.34520 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.03384 batch_time=0.46874 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.22494 batch_time=0.33941 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 1.62496 batch_time=0.36469 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.28709 batch_time=0.35659 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.45548 batch_time=0.38084 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.01827 batch_time=0.37023 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 1.74968 batch_time=0.39923 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.40829 batch_time=0.39514 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.20810 batch_time=0.34429 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.32850 batch_time=0.40551 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 1.87997 batch_time=0.36995 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.09166 batch_time=0.35532 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.66215 batch_time=0.35591 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 1.97489 batch_time=1.41443 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.09368 batch_time=0.36149 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 1.95802 batch_time=0.35101 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 1.85928 batch_time=0.34752 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch7.pth ...
Done in 3.700s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch7.pth ...
Done in 7.597s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 2.1153629417419433
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_miech_test/t2v_metrics/R1: 21.1
 MSRVTT_miech_test/t2v_metrics/R5: 49.6
 MSRVTT_miech_test/t2v_metrics/R10: 62.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.258
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.37739152636484
 MSRVTT_miech_test/v2t_metrics/R1: 20.1
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 65.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.8125
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.94526087851158
 mnt_best       : 40.37739152636484
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 1.84155 batch_time=30.90837 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 1.77638 batch_time=0.44871 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.67367 batch_time=0.36634 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 1.74566 batch_time=0.36206 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 1.70479 batch_time=0.35004 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 1.88148 batch_time=0.36151 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.06548 batch_time=0.35078 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.30791 batch_time=0.36576 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.20003 batch_time=0.40387 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 1.66321 batch_time=0.37135 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 1.64435 batch_time=0.38223 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.07288 batch_time=0.37424 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.03468 batch_time=0.35324 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 1.75662 batch_time=0.42129 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 1.95899 batch_time=0.39876 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 2.01601 batch_time=0.40502 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 1.56369 batch_time=0.43747 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 1.68275 batch_time=0.36494 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 1.76722 batch_time=0.35294 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 1.80824 batch_time=1.98193 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 1.86952 batch_time=0.36627 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 1.97603 batch_time=0.35454 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.23706 batch_time=0.40867 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch8.pth ...
Done in 3.909s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch8.pth ...
Done in 7.490s
removing stale ckpt [epoch 7] [took 0.01s]
 epoch          : 8
 loss           : 1.9578331189155578
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_miech_test/t2v_metrics/R1: 21.9
 MSRVTT_miech_test/t2v_metrics/R5: 49.5
 MSRVTT_miech_test/t2v_metrics/R10: 63.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.207
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.04781057525799
 MSRVTT_miech_test/v2t_metrics/R1: 21.5
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.1
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.739
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.88510263413009
 mnt_best       : 41.04781057525799
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 1.97703 batch_time=32.41846 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 1.71466 batch_time=0.36277 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.53815 batch_time=0.34792 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.19617 batch_time=0.35620 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 1.72506 batch_time=0.35117 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 1.88625 batch_time=0.34325 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.80783 batch_time=0.34028 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.65418 batch_time=0.34302 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 1.65969 batch_time=0.34160 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 2.04401 batch_time=0.35243 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 1.73167 batch_time=0.34526 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.49793 batch_time=0.34860 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 1.65518 batch_time=0.34149 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 1.77520 batch_time=1.33533 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.34728 batch_time=0.35103 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.67099 batch_time=0.48517 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 1.55370 batch_time=0.34308 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.68859 batch_time=0.34277 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 1.95727 batch_time=0.36295 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.84181 batch_time=0.40015 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.65784 batch_time=0.35776 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.94232 batch_time=0.34747 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.58709 batch_time=0.36713 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch9.pth ...
Done in 20.296s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch9.pth ...
Done in 23.994s
removing stale ckpt [epoch 8] [took 0.01s]
 epoch          : 9
 loss           : 1.8345636019706726
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_miech_test/t2v_metrics/R1: 21.9
 MSRVTT_miech_test/t2v_metrics/R5: 50.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.8
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.597
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.427203293248546
 MSRVTT_miech_test/v2t_metrics/R1: 22.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.1
 MSRVTT_miech_test/v2t_metrics/R10: 66.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.353
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.01299463039693
 mnt_best       : 41.427203293248546
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.87531 batch_time=28.08419 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 2.03991 batch_time=0.36252 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.17499 batch_time=0.39014 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.20833 batch_time=0.35930 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 1.55775 batch_time=0.37012 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 1.84384 batch_time=0.36344 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 1.95941 batch_time=0.35642 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 2.34298 batch_time=0.42453 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 1.41549 batch_time=0.36027 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 1.62825 batch_time=0.36236 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.97509 batch_time=0.37230 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 1.47225 batch_time=0.35345 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 1.91047 batch_time=4.62403 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.78640 batch_time=0.38028 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.64833 batch_time=0.55703 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 1.34891 batch_time=0.36011 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 1.44978 batch_time=0.37490 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 1.55432 batch_time=0.38889 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.58583 batch_time=0.34896 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.55773 batch_time=0.35650 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.59405 batch_time=0.35293 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 2.00770 batch_time=0.35613 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 1.64896 batch_time=0.35205 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch10.pth ...
Done in 3.798s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch10.pth ...
Done in 7.614s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 1.7579918656349183
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_miech_test/t2v_metrics/R1: 23.0
 MSRVTT_miech_test/t2v_metrics/R5: 49.4
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.358
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.63029643997359
 MSRVTT_miech_test/v2t_metrics/R1: 21.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.0
 MSRVTT_miech_test/v2t_metrics/R10: 65.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.7845
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.05202170648426
 mnt_best       : 41.63029643997359
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 1.47363 batch_time=26.51306 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 1.58359 batch_time=0.34328 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 1.79510 batch_time=0.34684 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 1.66708 batch_time=0.36131 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 1.63964 batch_time=1.08028 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 1.54998 batch_time=0.35720 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 1.49087 batch_time=0.36549 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 1.70937 batch_time=0.40833 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.29518 batch_time=0.37169 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.84490 batch_time=0.34760 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 2.07655 batch_time=0.35080 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.89554 batch_time=0.34669 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 1.35216 batch_time=0.43813 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.85272 batch_time=0.38206 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.95058 batch_time=0.37729 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 1.51932 batch_time=0.40281 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.99375 batch_time=0.35767 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.46431 batch_time=0.35537 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.56833 batch_time=0.35468 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.52077 batch_time=0.36173 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.75650 batch_time=0.34373 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.43236 batch_time=0.36995 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.53416 batch_time=0.37401 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch11.pth ...
Done in 3.868s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch11.pth ...
Done in 7.835s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 1.6620072050094605
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_miech_test/t2v_metrics/R1: 22.6
 MSRVTT_miech_test/t2v_metrics/R5: 52.0
 MSRVTT_miech_test/t2v_metrics/R10: 63.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.224000000000004
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.189483989000266
 MSRVTT_miech_test/v2t_metrics/R1: 22.1
 MSRVTT_miech_test/v2t_metrics/R5: 54.9
 MSRVTT_miech_test/v2t_metrics/R10: 66.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.598
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.25438591404339
 mnt_best       : 42.189483989000266
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.75555 batch_time=27.49348 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.83401 batch_time=0.35666 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 2.03526 batch_time=0.38647 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 1.40293 batch_time=0.35424 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 2.06760 batch_time=0.33770 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.74652 batch_time=0.36247 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.45977 batch_time=1.96002 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.70281 batch_time=0.49851 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.94596 batch_time=0.35556 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.90159 batch_time=0.40255 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.36056 batch_time=0.37257 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 2.02544 batch_time=0.35579 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.41979 batch_time=0.44028 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.33884 batch_time=0.36793 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.83579 batch_time=0.35509 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.54935 batch_time=0.34290 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.66817 batch_time=0.35185 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.50979 batch_time=0.34786 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.53627 batch_time=0.34838 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.32392 batch_time=0.38502 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.58680 batch_time=0.34277 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.46130 batch_time=0.67088 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.51918 batch_time=0.35283 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch12.pth ...
Done in 3.865s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch12.pth ...
Done in 7.653s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 1.573335865497589
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_miech_test/t2v_metrics/R1: 23.2
 MSRVTT_miech_test/t2v_metrics/R5: 51.5
 MSRVTT_miech_test/t2v_metrics/R10: 65.8
 MSRVTT_miech_test/t2v_metrics/R50: 88.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.354
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.83910305309571
 MSRVTT_miech_test/v2t_metrics/R1: 22.5
 MSRVTT_miech_test/v2t_metrics/R5: 55.2
 MSRVTT_miech_test/v2t_metrics/R10: 67.4
 MSRVTT_miech_test/v2t_metrics/R50: 90.0
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.699
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.74487341289988
 mnt_best       : 42.83910305309571
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.16406 batch_time=27.59269 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.49269 batch_time=0.35150 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.67586 batch_time=0.41032 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.87999 batch_time=0.37467 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.73075 batch_time=0.36037 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.12939 batch_time=0.36913 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.39588 batch_time=0.38788 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.56129 batch_time=3.31118 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.39197 batch_time=0.34279 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.85482 batch_time=0.34391 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.45414 batch_time=0.33906 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.65983 batch_time=0.39916 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.34475 batch_time=0.35683 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.43357 batch_time=0.34888 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.64406 batch_time=0.36204 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.54350 batch_time=0.52148 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.78459 batch_time=0.35901 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.66198 batch_time=0.36621 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.52257 batch_time=0.34238 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.79538 batch_time=0.34694 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.69186 batch_time=0.44923 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.10738 batch_time=0.34996 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.46056 batch_time=0.35589 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch13.pth ...
Done in 3.731s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch13.pth ...
Done in 7.396s
removing stale ckpt [epoch 12] [took 0.01s]
 epoch          : 13
 loss           : 1.5342960953712463
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_miech_test/t2v_metrics/R1: 23.4
 MSRVTT_miech_test/t2v_metrics/R5: 52.8
 MSRVTT_miech_test/t2v_metrics/R10: 66.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.723
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.364189988293056
 MSRVTT_miech_test/v2t_metrics/R1: 23.1
 MSRVTT_miech_test/v2t_metrics/R5: 53.9
 MSRVTT_miech_test/v2t_metrics/R10: 66.2
 MSRVTT_miech_test/v2t_metrics/R50: 90.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.157
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.51973526491117
 mnt_best       : 43.364189988293056
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.41987 batch_time=28.05829 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.36072 batch_time=0.35653 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.54980 batch_time=0.36658 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.25283 batch_time=0.40324 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.17606 batch_time=0.34522 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.79735 batch_time=0.36243 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.35880 batch_time=0.84489 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.63399 batch_time=0.40147 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.37703 batch_time=0.41057 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.30396 batch_time=0.36931 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.50300 batch_time=0.35886 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.47987 batch_time=0.36044 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.60873 batch_time=4.61287 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.62592 batch_time=0.34895 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.97823 batch_time=0.35715 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.53617 batch_time=0.35508 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.51306 batch_time=0.36658 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.02641 batch_time=0.38550 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.33779 batch_time=0.38131 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.52214 batch_time=0.35052 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.46985 batch_time=0.36939 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.41774 batch_time=0.36569 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.34712 batch_time=0.35074 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch14.pth ...
Done in 3.957s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 1.43575910115242
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_miech_test/t2v_metrics/R1: 23.2
 MSRVTT_miech_test/t2v_metrics/R5: 52.2
 MSRVTT_miech_test/t2v_metrics/R10: 66.1
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.932
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.09762280014443
 MSRVTT_miech_test/v2t_metrics/R1: 22.6
 MSRVTT_miech_test/v2t_metrics/R5: 56.0
 MSRVTT_miech_test/v2t_metrics/R10: 68.6
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.968
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.27992336945139
 mnt_best       : 43.364189988293056
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.60090 batch_time=31.74711 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.57451 batch_time=0.40771 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.43439 batch_time=0.35856 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.44726 batch_time=0.35515 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.09729 batch_time=0.34964 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.65165 batch_time=0.34166 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.51159 batch_time=0.38619 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.30225 batch_time=0.39679 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.06621 batch_time=0.37361 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.03385 batch_time=0.34848 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.45477 batch_time=0.37420 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.16658 batch_time=0.38926 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.34381 batch_time=0.36424 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.42346 batch_time=0.34216 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.21149 batch_time=0.34535 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.39654 batch_time=0.36309 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.44432 batch_time=0.38454 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.35245 batch_time=0.36862 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.32302 batch_time=0.42640 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.63492 batch_time=0.36292 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.00457 batch_time=0.35088 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.51420 batch_time=0.35739 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.33207 batch_time=0.34942 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch15.pth ...
Done in 9.895s
removing stale ckpt [epoch 14] [took 0.10s]
 epoch          : 15
 loss           : 1.381222734451294
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_miech_test/t2v_metrics/R1: 23.7
 MSRVTT_miech_test/t2v_metrics/R5: 51.1
 MSRVTT_miech_test/t2v_metrics/R10: 65.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.401
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.857569122744366
 MSRVTT_miech_test/v2t_metrics/R1: 23.2
 MSRVTT_miech_test/v2t_metrics/R5: 53.5
 MSRVTT_miech_test/v2t_metrics/R10: 67.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.9305
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.670493096175946
 mnt_best       : 43.364189988293056
 not_improved_count: 2
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.46118 batch_time=28.54155 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.12036 batch_time=0.35323 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.05996 batch_time=3.68280 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 1.06063 batch_time=0.42353 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.38461 batch_time=0.39053 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.32176 batch_time=0.34582 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.61301 batch_time=0.35260 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.43234 batch_time=0.36770 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.23902 batch_time=0.36202 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.31571 batch_time=0.34632 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.28370 batch_time=0.47078 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.11165 batch_time=0.35438 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.14607 batch_time=0.35299 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.40557 batch_time=0.98279 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.07216 batch_time=0.35281 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.49114 batch_time=0.35999 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.36805 batch_time=0.35135 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.36150 batch_time=0.36250 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.33868 batch_time=1.34001 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.55424 batch_time=0.34940 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.48288 batch_time=0.35149 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.39617 batch_time=0.35562 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.26422 batch_time=0.36416 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch16.pth ...
Done in 4.340s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 1.3506860921382904
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_miech_test/t2v_metrics/R1: 22.9
 MSRVTT_miech_test/t2v_metrics/R5: 52.4
 MSRVTT_miech_test/t2v_metrics/R10: 66.1
 MSRVTT_miech_test/t2v_metrics/R50: 88.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.821
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.96578421077108
 MSRVTT_miech_test/v2t_metrics/R1: 23.3
 MSRVTT_miech_test/v2t_metrics/R5: 53.6
 MSRVTT_miech_test/v2t_metrics/R10: 67.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.4645
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.76037922995852
 mnt_best       : 43.364189988293056
 not_improved_count: 3
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.31874 batch_time=28.85642 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.35951 batch_time=0.36108 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.47159 batch_time=0.34663 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.40127 batch_time=0.39587 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.24886 batch_time=0.59783 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.73453 batch_time=0.35612 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.01472 batch_time=4.57280 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.32960 batch_time=1.58048 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.24484 batch_time=0.49120 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.04786 batch_time=1.76755 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.32878 batch_time=0.34245 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.56339 batch_time=0.34983 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.39114 batch_time=0.34928 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.19721 batch_time=0.36810 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.31059 batch_time=0.37397 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.41799 batch_time=0.34693 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.31240 batch_time=0.35285 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.30655 batch_time=0.36612 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.32822 batch_time=0.34266 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.27101 batch_time=0.36747 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.30083 batch_time=0.34685 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.30629 batch_time=0.35701 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.51228 batch_time=0.36067 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch17.pth ...
Done in 5.444s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch17.pth ...
Done in 10.190s
removing stale ckpt [epoch 16] [took 0.04s]
 epoch          : 17
 loss           : 1.309631707906723
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_miech_test/t2v_metrics/R1: 23.5
 MSRVTT_miech_test/t2v_metrics/R5: 52.5
 MSRVTT_miech_test/t2v_metrics/R10: 66.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.527
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.409044990577506
 MSRVTT_miech_test/v2t_metrics/R1: 24.3
 MSRVTT_miech_test/v2t_metrics/R5: 54.6
 MSRVTT_miech_test/v2t_metrics/R10: 67.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.8665
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.674125830341104
 mnt_best       : 43.409044990577506
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.32018 batch_time=22.21709 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.23068 batch_time=2.28849 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.34335 batch_time=0.36724 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.31106 batch_time=0.35845 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.22076 batch_time=0.35934 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.39904 batch_time=0.37893 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.03904 batch_time=2.60490 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.35513 batch_time=0.42063 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.09037 batch_time=0.37075 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.16705 batch_time=0.34956 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.07854 batch_time=0.36590 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.21500 batch_time=0.36072 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.23186 batch_time=0.35223 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.27840 batch_time=0.35620 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.11765 batch_time=0.36024 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.74810 batch_time=0.38143 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.00492 batch_time=0.35210 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.53199 batch_time=0.35120 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.33770 batch_time=0.34680 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.31344 batch_time=0.36086 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.34606 batch_time=0.35815 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.20225 batch_time=0.34735 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 0.97979 batch_time=0.36025 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch18.pth ...
Done in 5.941s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 1.2556621260643006
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_miech_test/t2v_metrics/R1: 23.7
 MSRVTT_miech_test/t2v_metrics/R5: 52.4
 MSRVTT_miech_test/t2v_metrics/R10: 65.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.749
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.28435378498381
 MSRVTT_miech_test/v2t_metrics/R1: 23.7
 MSRVTT_miech_test/v2t_metrics/R5: 54.9
 MSRVTT_miech_test/v2t_metrics/R10: 67.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.6125
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.49417101616151
 mnt_best       : 43.409044990577506
 not_improved_count: 1
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.39931 batch_time=23.89570 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.36793 batch_time=0.34040 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.10841 batch_time=0.34013 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.19366 batch_time=0.34242 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.15596 batch_time=0.33727 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.51505 batch_time=0.34927 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.33787 batch_time=2.77195 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.37172 batch_time=0.34343 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.12388 batch_time=0.34775 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.10573 batch_time=0.37473 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.15684 batch_time=0.34938 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.07767 batch_time=0.35757 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 0.96112 batch_time=0.37657 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.37308 batch_time=0.35264 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.48699 batch_time=0.34412 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.83772 batch_time=0.37304 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.33748 batch_time=0.35745 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.10016 batch_time=0.36328 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.25450 batch_time=0.36991 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.20271 batch_time=0.35719 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.21903 batch_time=0.34512 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.35166 batch_time=0.36507 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.37708 batch_time=0.36521 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch19.pth ...
Done in 5.120s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 1.222164200782776
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_miech_test/t2v_metrics/R1: 23.3
 MSRVTT_miech_test/t2v_metrics/R5: 52.7
 MSRVTT_miech_test/t2v_metrics/R10: 65.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.328
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.12143840081546
 MSRVTT_miech_test/v2t_metrics/R1: 23.5
 MSRVTT_miech_test/v2t_metrics/R5: 56.7
 MSRVTT_miech_test/v2t_metrics/R10: 67.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.5
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.4
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.84835622212356
 mnt_best       : 43.409044990577506
 not_improved_count: 2
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.10748 batch_time=22.64185 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.29006 batch_time=0.58126 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.30621 batch_time=0.34788 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.04994 batch_time=0.35453 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.19601 batch_time=0.34839 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.15970 batch_time=0.34307 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.23060 batch_time=0.37352 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.24667 batch_time=0.35375 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.38678 batch_time=0.35409 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.36055 batch_time=0.39722 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.07742 batch_time=0.37678 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.00168 batch_time=0.35753 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.68373 batch_time=0.35813 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.21054 batch_time=0.36665 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.28025 batch_time=0.35815 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.11267 batch_time=0.34426 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.16337 batch_time=0.34322 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.10453 batch_time=0.35100 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 0.95041 batch_time=0.34079 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.34897 batch_time=0.45127 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.12416 batch_time=0.40301 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.10923 batch_time=0.36791 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.05857 batch_time=0.35208 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch20.pth ...
Done in 5.353s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch20.pth ...
Done in 10.015s
removing stale ckpt [epoch 19] [took 0.05s]
 epoch          : 20
 loss           : 1.1909048681259156
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_miech_test/t2v_metrics/R1: 24.7
 MSRVTT_miech_test/t2v_metrics/R5: 52.6
 MSRVTT_miech_test/t2v_metrics/R10: 66.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.1
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.088
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.14148053685193
 MSRVTT_miech_test/v2t_metrics/R1: 23.8
 MSRVTT_miech_test/v2t_metrics/R5: 56.5
 MSRVTT_miech_test/v2t_metrics/R10: 67.9
 MSRVTT_miech_test/v2t_metrics/R50: 89.7
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.003
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.02963151282277
 mnt_best       : 44.14148053685193
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.03518 batch_time=30.27694 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 0.91994 batch_time=0.35982 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.30671 batch_time=0.38291 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.53197 batch_time=0.38864 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.08547 batch_time=0.35126 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.08492 batch_time=0.36329 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.43063 batch_time=0.35435 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.39262 batch_time=0.36583 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.14115 batch_time=0.36162 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.26797 batch_time=0.42155 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.00133 batch_time=0.35812 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 0.86972 batch_time=0.38093 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.04910 batch_time=0.35681 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.15547 batch_time=0.39503 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.05822 batch_time=0.35274 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.01385 batch_time=0.36820 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.29376 batch_time=0.37539 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 0.98799 batch_time=0.35325 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.23539 batch_time=0.38932 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.11155 batch_time=0.35930 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 0.91577 batch_time=0.38151 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.14871 batch_time=0.34972 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.15052 batch_time=0.39586 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch21.pth ...
Done in 6.140s
removing stale ckpt [epoch 20] [took 0.02s]
 epoch          : 21
 loss           : 1.1489547781944276
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_miech_test/t2v_metrics/R1: 23.7
 MSRVTT_miech_test/t2v_metrics/R5: 52.1
 MSRVTT_miech_test/t2v_metrics/R10: 66.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.645
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.46462178325669
 MSRVTT_miech_test/v2t_metrics/R1: 24.9
 MSRVTT_miech_test/v2t_metrics/R5: 56.5
 MSRVTT_miech_test/v2t_metrics/R10: 68.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.532
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.80253334194224
 mnt_best       : 44.14148053685193
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.30279 batch_time=31.86608 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.04092 batch_time=0.33878 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.25659 batch_time=0.56741 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.12992 batch_time=1.01992 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.28938 batch_time=0.34467 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.12735 batch_time=0.41445 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 0.88560 batch_time=0.40106 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.41136 batch_time=0.35232 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.05175 batch_time=0.38983 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.36319 batch_time=0.34445 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.26834 batch_time=0.36230 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 0.96789 batch_time=0.34018 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.07473 batch_time=0.38550 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.00246 batch_time=0.72445 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.32940 batch_time=0.34377 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 0.99668 batch_time=0.34051 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.36589 batch_time=0.35428 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 0.95935 batch_time=0.36286 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.03938 batch_time=0.35345 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.08209 batch_time=0.34085 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.18208 batch_time=0.34238 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.09682 batch_time=0.35990 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 0.92498 batch_time=0.36159 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch22.pth ...
Done in 4.583s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch22.pth ...
Done in 9.322s
removing stale ckpt [epoch 21] [took 0.01s]
 epoch          : 22
 loss           : 1.134627767086029
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_miech_test/t2v_metrics/R1: 25.3
 MSRVTT_miech_test/t2v_metrics/R5: 53.4
 MSRVTT_miech_test/t2v_metrics/R10: 66.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.717
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.74300022637969
 MSRVTT_miech_test/v2t_metrics/R1: 24.8
 MSRVTT_miech_test/v2t_metrics/R5: 55.8
 MSRVTT_miech_test/v2t_metrics/R10: 67.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.2
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.626
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.41766989937562
 mnt_best       : 44.74300022637969
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.32454 batch_time=35.44059 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.12931 batch_time=0.36163 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.22075 batch_time=0.35876 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.15066 batch_time=0.35976 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.34913 batch_time=0.39251 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.17177 batch_time=0.37494 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.10094 batch_time=0.38489 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.07869 batch_time=0.39690 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 0.98007 batch_time=0.41484 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.21393 batch_time=0.37054 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.16154 batch_time=0.65493 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 0.88459 batch_time=0.37051 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.19093 batch_time=0.34884 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.03510 batch_time=0.37839 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 0.93143 batch_time=0.37097 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.54344 batch_time=0.37848 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 0.96049 batch_time=0.38376 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 0.93307 batch_time=0.38515 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.12716 batch_time=2.98956 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.05834 batch_time=0.60198 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.29594 batch_time=0.36782 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.30615 batch_time=0.38828 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 0.99076 batch_time=0.58302 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch23.pth ...
Done in 5.130s
removing stale ckpt [epoch 22] [took 0.02s]
 epoch          : 23
 loss           : 1.0897922298908234
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_miech_test/t2v_metrics/R1: 25.2
 MSRVTT_miech_test/t2v_metrics/R5: 53.1
 MSRVTT_miech_test/t2v_metrics/R10: 66.5
 MSRVTT_miech_test/t2v_metrics/R50: 88.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.254000000000005
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.64493918640139
 MSRVTT_miech_test/v2t_metrics/R1: 25.1
 MSRVTT_miech_test/v2t_metrics/R5: 56.2
 MSRVTT_miech_test/v2t_metrics/R10: 68.2
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.757
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.82102541436336
 mnt_best       : 44.74300022637969
 not_improved_count: 1
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.07912 batch_time=30.56022 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.07013 batch_time=0.66438 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.24788 batch_time=0.35382 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 0.86474 batch_time=0.38183 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.44934 batch_time=0.71196 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 0.89826 batch_time=0.40190 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.25057 batch_time=0.98404 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.09733 batch_time=0.39446 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 0.98654 batch_time=0.45139 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.34614 batch_time=0.40558 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.53448 batch_time=0.51982 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.03641 batch_time=0.35624 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 0.85321 batch_time=0.41792 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 0.95764 batch_time=0.37189 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.06404 batch_time=0.38699 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.36949 batch_time=0.40237 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.97556 batch_time=0.35929 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.28624 batch_time=0.35596 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 0.97820 batch_time=0.36151 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.23556 batch_time=0.40354 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 0.82739 batch_time=0.40859 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.08843 batch_time=0.36866 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 0.78517 batch_time=0.39534 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch24.pth ...
Done in 6.250s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch24.pth ...
Done in 11.231s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 1.0756859974861146
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_miech_test/t2v_metrics/R1: 25.5
 MSRVTT_miech_test/t2v_metrics/R5: 53.4
 MSRVTT_miech_test/t2v_metrics/R10: 66.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.219
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.95062733106088
 MSRVTT_miech_test/v2t_metrics/R1: 24.5
 MSRVTT_miech_test/v2t_metrics/R5: 55.0
 MSRVTT_miech_test/v2t_metrics/R10: 67.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.134
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.06086414396534
 mnt_best       : 44.95062733106088
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.02935 batch_time=27.78533 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 0.93222 batch_time=0.38968 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.18527 batch_time=0.35021 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 0.78263 batch_time=0.35217 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.26709 batch_time=0.42155 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 0.90762 batch_time=0.60066 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.14936 batch_time=0.36466 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.24622 batch_time=5.79878 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 0.93633 batch_time=0.48803 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 0.92007 batch_time=0.43559 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 0.91013 batch_time=0.43878 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 0.97288 batch_time=0.34940 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.05709 batch_time=1.26124 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 0.91128 batch_time=0.70901 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 0.87835 batch_time=0.43469 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.10069 batch_time=0.39743 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.02735 batch_time=0.36047 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 0.82130 batch_time=0.35542 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.90193 batch_time=0.37239 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.15357 batch_time=0.34032 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.03661 batch_time=0.35429 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 0.71270 batch_time=0.36302 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.16825 batch_time=0.36392 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch25.pth ...
Done in 4.660s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch25.pth ...
Done in 9.642s
removing stale ckpt [epoch 24] [took 0.01s]
 epoch          : 25
 loss           : 1.0478536550998687
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_miech_test/t2v_metrics/R1: 24.9
 MSRVTT_miech_test/t2v_metrics/R5: 54.7
 MSRVTT_miech_test/t2v_metrics/R10: 67.1
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.182
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.04394275469628
 MSRVTT_miech_test/v2t_metrics/R1: 26.2
 MSRVTT_miech_test/v2t_metrics/R5: 55.4
 MSRVTT_miech_test/v2t_metrics/R10: 68.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.5125
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.37201108791951
 mnt_best       : 45.04394275469628
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 0.94290 batch_time=27.92354 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 0.93065 batch_time=0.36017 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.08198 batch_time=0.36943 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.22112 batch_time=0.38466 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.15512 batch_time=0.36092 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 0.94127 batch_time=0.35422 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.15897 batch_time=0.34409 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.19951 batch_time=0.35494 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.02909 batch_time=0.37121 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 0.94127 batch_time=0.39001 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.90726 batch_time=0.35882 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 0.99790 batch_time=0.37594 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.21130 batch_time=0.37827 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.13402 batch_time=0.38282 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 0.96902 batch_time=0.37007 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.04088 batch_time=0.37747 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 0.94632 batch_time=0.36557 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.00113 batch_time=0.35062 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.12941 batch_time=0.39399 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.16024 batch_time=0.39057 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 0.95104 batch_time=0.37924 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 0.91280 batch_time=0.39788 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.27235 batch_time=0.35779 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch26.pth ...
Done in 6.374s
removing stale ckpt [epoch 25] [took 0.01s]
 epoch          : 26
 loss           : 1.0182495522499084
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_miech_test/t2v_metrics/R1: 24.7
 MSRVTT_miech_test/t2v_metrics/R5: 53.1
 MSRVTT_miech_test/t2v_metrics/R10: 66.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.681
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.25859719962425
 MSRVTT_miech_test/v2t_metrics/R1: 25.2
 MSRVTT_miech_test/v2t_metrics/R5: 54.0
 MSRVTT_miech_test/v2t_metrics/R10: 67.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.29
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.09738907833782
 mnt_best       : 45.04394275469628
 not_improved_count: 1
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 0.85354 batch_time=27.10737 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.07966 batch_time=0.38687 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.19811 batch_time=0.35953 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.39661 batch_time=0.45371 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 0.99110 batch_time=0.46620 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 0.89950 batch_time=0.37877 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 0.75635 batch_time=9.01735 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 0.99677 batch_time=0.41960 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.04871 batch_time=0.36039 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.02567 batch_time=0.38042 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 0.96178 batch_time=0.41740 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 0.86849 batch_time=0.36547 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.06144 batch_time=0.35652 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.14928 batch_time=0.37770 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.10381 batch_time=0.35689 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.33859 batch_time=0.38169 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 0.78633 batch_time=0.34703 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.01057 batch_time=0.34946 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.11251 batch_time=0.35523 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.04040 batch_time=0.35750 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.14290 batch_time=0.34467 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.17372 batch_time=0.47819 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 0.85773 batch_time=0.36513 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch27.pth ...
Done in 14.782s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 1.0008130960464479
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_miech_test/t2v_metrics/R1: 24.8
 MSRVTT_miech_test/t2v_metrics/R5: 53.1
 MSRVTT_miech_test/t2v_metrics/R10: 66.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.454
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.49632120411099
 MSRVTT_miech_test/v2t_metrics/R1: 24.6
 MSRVTT_miech_test/v2t_metrics/R5: 55.8
 MSRVTT_miech_test/v2t_metrics/R10: 68.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.6
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.173
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.517180003479496
 mnt_best       : 45.04394275469628
 not_improved_count: 2
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 0.94055 batch_time=39.77397 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 0.93747 batch_time=0.37686 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.74604 batch_time=3.77321 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.08774 batch_time=0.37970 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 0.99916 batch_time=0.38689 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.24071 batch_time=0.38265 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.04908 batch_time=0.36650 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 0.95205 batch_time=0.34886 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.28036 batch_time=0.38703 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.21786 batch_time=0.35639 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 0.71883 batch_time=0.37027 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 0.77109 batch_time=0.39737 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.04101 batch_time=0.35082 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.07261 batch_time=0.35486 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.24298 batch_time=0.38862 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 0.83193 batch_time=0.39638 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 0.90885 batch_time=0.34847 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 0.60297 batch_time=0.41594 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.00966 batch_time=0.38047 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.11734 batch_time=0.35784 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.14812 batch_time=0.35742 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.36814 batch_time=0.39287 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 0.85467 batch_time=0.58945 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch28.pth ...
Done in 4.616s
removing stale ckpt [epoch 27] [took 0.02s]
 epoch          : 28
 loss           : 0.9852812657356262
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_miech_test/t2v_metrics/R1: 24.8
 MSRVTT_miech_test/t2v_metrics/R5: 52.6
 MSRVTT_miech_test/t2v_metrics/R10: 68.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.232
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.598006439610835
 MSRVTT_miech_test/v2t_metrics/R1: 24.1
 MSRVTT_miech_test/v2t_metrics/R5: 56.3
 MSRVTT_miech_test/v2t_metrics/R10: 69.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.763
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.472925002257575
 mnt_best       : 45.04394275469628
 not_improved_count: 3
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 0.74552 batch_time=29.52352 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 0.97547 batch_time=0.37773 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 0.90359 batch_time=0.37517 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 0.93092 batch_time=0.39014 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 0.83579 batch_time=0.37508 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 0.83472 batch_time=0.39680 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.44645 batch_time=0.36221 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 0.94739 batch_time=0.39747 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 0.91233 batch_time=0.41918 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 0.99234 batch_time=0.40022 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.02593 batch_time=0.42336 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 0.82205 batch_time=0.37739 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 0.78507 batch_time=3.69355 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.03204 batch_time=0.34469 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.25979 batch_time=0.94622 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 0.76488 batch_time=0.36974 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.09136 batch_time=0.42825 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 0.80417 batch_time=0.35543 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.50254 batch_time=0.36743 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.01514 batch_time=0.34927 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.09715 batch_time=0.38122 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.74543 batch_time=0.40314 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.12345 batch_time=0.36904 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch29.pth ...
Done in 4.786s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 0.9646983258724212
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_miech_test/t2v_metrics/R1: 24.3
 MSRVTT_miech_test/t2v_metrics/R5: 53.6
 MSRVTT_miech_test/t2v_metrics/R10: 67.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.525
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.421720563177225
 MSRVTT_miech_test/v2t_metrics/R1: 24.5
 MSRVTT_miech_test/v2t_metrics/R5: 56.4
 MSRVTT_miech_test/v2t_metrics/R10: 69.1
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 24.8915
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.70612593385803
 mnt_best       : 45.04394275469628
 not_improved_count: 4
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.14521 batch_time=36.62794 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 0.63149 batch_time=2.87966 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.09301 batch_time=1.43826 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.12319 batch_time=0.36661 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 0.97108 batch_time=0.36311 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 0.76367 batch_time=0.39577 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.00917 batch_time=0.35904 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.96204 batch_time=0.43543 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 0.81572 batch_time=0.37578 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.18661 batch_time=0.38162 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 0.97783 batch_time=0.36000 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 0.75884 batch_time=0.36410 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.18833 batch_time=0.69976 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.05860 batch_time=1.53249 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 0.93608 batch_time=0.42499 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.06956 batch_time=0.80463 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.07946 batch_time=0.39320 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 0.87643 batch_time=0.36622 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.07383 batch_time=0.40968 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 0.99893 batch_time=0.37685 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.00611 batch_time=0.88847 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 0.82283 batch_time=0.35794 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 0.88652 batch_time=0.39944 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch30.pth ...
Done in 5.634s
removing stale ckpt [epoch 29] [took 0.02s]
 epoch          : 30
 loss           : 0.9518920984268189
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_miech_test/t2v_metrics/R1: 24.3
 MSRVTT_miech_test/t2v_metrics/R5: 53.3
 MSRVTT_miech_test/t2v_metrics/R10: 67.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.962
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.27270882659683
 MSRVTT_miech_test/v2t_metrics/R1: 24.0
 MSRVTT_miech_test/v2t_metrics/R5: 54.4
 MSRVTT_miech_test/v2t_metrics/R10: 68.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 24.5825
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.676274263095436
 mnt_best       : 45.04394275469628
 not_improved_count: 5
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 0.88722 batch_time=31.09806 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.17238 batch_time=0.36885 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.15394 batch_time=0.35821 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 0.92622 batch_time=0.51569 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 0.66989 batch_time=0.37039 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 0.61956 batch_time=0.37570 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.00725 batch_time=0.39640 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 0.86884 batch_time=0.37409 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.09904 batch_time=0.39951 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.17599 batch_time=0.44897 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.12081 batch_time=0.35666 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.24176 batch_time=0.41527 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 0.73270 batch_time=0.35918 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 0.94224 batch_time=0.40758 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 0.74470 batch_time=0.35861 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 0.91202 batch_time=0.45772 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 0.60713 batch_time=0.34457 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.06793 batch_time=0.34816 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 0.71764 batch_time=0.35527 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 0.85453 batch_time=1.55768 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.00626 batch_time=0.42709 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.05282 batch_time=0.38261 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 0.99805 batch_time=0.40142 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch31.pth ...
Done in 5.150s
removing stale ckpt [epoch 30] [took 0.62s]
 epoch          : 31
 loss           : 0.942622662782669
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_miech_test/t2v_metrics/R1: 24.5
 MSRVTT_miech_test/t2v_metrics/R5: 53.0
 MSRVTT_miech_test/t2v_metrics/R10: 67.8
 MSRVTT_miech_test/t2v_metrics/R50: 88.1
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.285
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.48605378738097
 MSRVTT_miech_test/v2t_metrics/R1: 25.3
 MSRVTT_miech_test/v2t_metrics/R5: 56.2
 MSRVTT_miech_test/v2t_metrics/R10: 68.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.22
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.00967187930857
 mnt_best       : 45.04394275469628
 not_improved_count: 6
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.01433 batch_time=28.98876 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 0.69182 batch_time=0.39362 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 0.68763 batch_time=0.36088 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.17405 batch_time=0.36249 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.79968 batch_time=0.37924 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 0.72750 batch_time=0.36024 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 0.77485 batch_time=0.40209 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 0.89422 batch_time=0.37465 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 0.96248 batch_time=0.38810 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 0.66273 batch_time=0.38224 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 0.91437 batch_time=0.37207 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 0.95614 batch_time=0.36857 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 0.93059 batch_time=0.40999 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 0.91086 batch_time=0.36223 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 0.84944 batch_time=0.38399 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 0.95261 batch_time=0.41704 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.03673 batch_time=0.36851 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.93369 batch_time=0.40933 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 0.88125 batch_time=0.38565 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 0.83895 batch_time=0.34424 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 0.86895 batch_time=0.37798 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 0.98365 batch_time=0.36641 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.07891 batch_time=0.36141 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch32.pth ...
Done in 5.597s
removing stale ckpt [epoch 31] [took 0.22s]
 epoch          : 32
 loss           : 0.9151745228767395
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_miech_test/t2v_metrics/R1: 24.8
 MSRVTT_miech_test/t2v_metrics/R5: 52.8
 MSRVTT_miech_test/t2v_metrics/R10: 67.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.558
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.63255949267557
 MSRVTT_miech_test/v2t_metrics/R1: 24.4
 MSRVTT_miech_test/v2t_metrics/R5: 56.0
 MSRVTT_miech_test/v2t_metrics/R10: 68.0
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.0815
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.292774180583905
 mnt_best       : 45.04394275469628
 not_improved_count: 7
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.01516 batch_time=36.25268 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 0.99852 batch_time=0.42647 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 0.73037 batch_time=0.37282 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.01167 batch_time=0.38696 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.32862 batch_time=0.41322 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 0.90712 batch_time=0.39024 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.67992 batch_time=0.39656 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.14219 batch_time=0.43808 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 0.65541 batch_time=0.35890 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 0.96877 batch_time=0.38795 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 0.87831 batch_time=0.40115 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 0.88291 batch_time=0.42343 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 0.86778 batch_time=0.39076 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.04203 batch_time=0.38544 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 0.90177 batch_time=0.36201 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.95665 batch_time=0.39768 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.83025 batch_time=0.37517 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 0.97043 batch_time=0.41037 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 0.88501 batch_time=0.37623 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.08398 batch_time=0.37148 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.86675 batch_time=0.65559 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 0.83358 batch_time=1.07292 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 0.75333 batch_time=0.35954 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch33.pth ...
Done in 5.297s
removing stale ckpt [epoch 32] [took 0.01s]
 epoch          : 33
 loss           : 0.9013087513446808
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_miech_test/t2v_metrics/R1: 25.0
 MSRVTT_miech_test/t2v_metrics/R5: 53.5
 MSRVTT_miech_test/t2v_metrics/R10: 67.5
 MSRVTT_miech_test/t2v_metrics/R50: 88.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.435
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.86068022290664
 MSRVTT_miech_test/v2t_metrics/R1: 25.6
 MSRVTT_miech_test/v2t_metrics/R5: 56.5
 MSRVTT_miech_test/v2t_metrics/R10: 69.0
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.527
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.38517163903403
 mnt_best       : 45.04394275469628
 not_improved_count: 8
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 0.84800 batch_time=32.67380 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 0.86992 batch_time=0.38071 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 0.94282 batch_time=0.40936 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.02412 batch_time=0.40421 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.06796 batch_time=0.37563 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 0.65802 batch_time=0.41413 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.72181 batch_time=0.39283 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.01571 batch_time=0.40121 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.02632 batch_time=0.41357 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 0.77009 batch_time=0.36335 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 0.75280 batch_time=0.37303 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 0.84694 batch_time=1.12087 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 0.76083 batch_time=0.39627 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 0.73818 batch_time=0.42149 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 0.76148 batch_time=0.42283 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 0.98873 batch_time=0.37151 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.14428 batch_time=0.44509 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.09785 batch_time=0.35430 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 0.80295 batch_time=1.93989 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.01801 batch_time=0.38170 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.13585 batch_time=0.59945 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.03210 batch_time=0.39041 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 0.95490 batch_time=0.35465 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch34.pth ...
Done in 4.333s
removing stale ckpt [epoch 33] [took 0.01s]
 epoch          : 34
 loss           : 0.889008507490158
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_miech_test/t2v_metrics/R1: 24.6
 MSRVTT_miech_test/t2v_metrics/R5: 52.6
 MSRVTT_miech_test/t2v_metrics/R10: 67.3
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.657
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.32464899839082
 MSRVTT_miech_test/v2t_metrics/R1: 25.5
 MSRVTT_miech_test/v2t_metrics/R5: 56.8
 MSRVTT_miech_test/v2t_metrics/R10: 68.6
 MSRVTT_miech_test/v2t_metrics/R50: 89.5
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.8445
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.316693068133226
 mnt_best       : 45.04394275469628
 not_improved_count: 9
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 0.92620 batch_time=27.35411 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 0.81424 batch_time=0.35702 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.01883 batch_time=0.35295 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 0.74354 batch_time=0.36375 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.16398 batch_time=1.51545 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 0.83889 batch_time=0.37370 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 0.93941 batch_time=1.44393 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 0.88229 batch_time=0.36578 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 0.78540 batch_time=0.37151 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 0.89572 batch_time=1.19456 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.75382 batch_time=0.36788 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 0.68157 batch_time=0.35519 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.01298 batch_time=0.37432 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.07808 batch_time=0.35158 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 0.81989 batch_time=0.35623 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.98936 batch_time=0.36954 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 0.87719 batch_time=0.39947 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 0.84231 batch_time=0.36400 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 0.95546 batch_time=0.36661 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 0.91250 batch_time=0.42682 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.76883 batch_time=0.36750 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 0.92184 batch_time=0.35743 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.66216 batch_time=0.36854 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch35.pth ...
Done in 6.631s
removing stale ckpt [epoch 34] [took 0.02s]
 epoch          : 35
 loss           : 0.8969807207584382
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_miech_test/t2v_metrics/R1: 24.1
 MSRVTT_miech_test/t2v_metrics/R5: 53.2
 MSRVTT_miech_test/t2v_metrics/R10: 66.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.065
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.969082274448155
 MSRVTT_miech_test/v2t_metrics/R1: 25.7
 MSRVTT_miech_test/v2t_metrics/R5: 56.8
 MSRVTT_miech_test/v2t_metrics/R10: 68.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.2
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.742
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.36967524103533
 mnt_best       : 45.04394275469628
 not_improved_count: 10
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 0.85650 batch_time=32.23346 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 0.99901 batch_time=1.59824 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.71406 batch_time=0.34666 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 0.86630 batch_time=0.39879 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 0.98729 batch_time=0.37310 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.79357 batch_time=0.36465 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 0.84721 batch_time=1.30251 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 0.85493 batch_time=0.40480 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 0.85749 batch_time=0.43290 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 0.89312 batch_time=0.39662 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 0.70065 batch_time=0.41476 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 0.95184 batch_time=0.39475 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 0.94151 batch_time=0.35366 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.26463 batch_time=0.40977 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.89394 batch_time=0.35410 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.78950 batch_time=0.38770 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 0.90024 batch_time=0.37364 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.89849 batch_time=0.37494 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.05757 batch_time=0.38018 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.65917 batch_time=1.21097 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.91470 batch_time=0.38625 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.64678 batch_time=0.39876 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.94391 batch_time=0.34882 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch36.pth ...
Done in 4.450s
removing stale ckpt [epoch 35] [took 0.06s]
 epoch          : 36
 loss           : 0.8843433448076248
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_miech_test/t2v_metrics/R1: 24.2
 MSRVTT_miech_test/t2v_metrics/R5: 54.4
 MSRVTT_miech_test/t2v_metrics/R10: 66.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.447
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.425210907428976
 MSRVTT_miech_test/v2t_metrics/R1: 25.9
 MSRVTT_miech_test/v2t_metrics/R5: 55.9
 MSRVTT_miech_test/v2t_metrics/R10: 68.8
 MSRVTT_miech_test/v2t_metrics/R50: 89.2
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.772
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.355364825004806
 mnt_best       : 45.04394275469628
 not_improved_count: 11
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 0.99391 batch_time=33.53809 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 0.82694 batch_time=0.39797 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.91109 batch_time=0.40471 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 0.87544 batch_time=0.38148 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 0.80167 batch_time=0.38253 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 0.77101 batch_time=0.36411 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 0.76043 batch_time=0.39039 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 0.66695 batch_time=0.38204 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 0.80439 batch_time=0.36173 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.54347 batch_time=0.40349 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 0.71613 batch_time=1.46058 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.84283 batch_time=0.37391 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 0.90089 batch_time=2.82736 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 0.85260 batch_time=0.39236 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.84118 batch_time=0.35636 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.91743 batch_time=0.38949 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.75055 batch_time=0.37195 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.86855 batch_time=0.37164 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 0.76380 batch_time=0.37065 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 0.68722 batch_time=0.36200 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 0.79074 batch_time=0.37764 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 0.79503 batch_time=0.36225 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.26486 batch_time=0.36897 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch37.pth ...
Done in 5.727s
removing stale ckpt [epoch 36] [took 0.03s]
 epoch          : 37
 loss           : 0.8438566579818726
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_miech_test/t2v_metrics/R1: 24.3
 MSRVTT_miech_test/t2v_metrics/R5: 53.4
 MSRVTT_miech_test/t2v_metrics/R10: 66.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.069
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.25625536387864
 MSRVTT_miech_test/v2t_metrics/R1: 25.7
 MSRVTT_miech_test/v2t_metrics/R5: 54.5
 MSRVTT_miech_test/v2t_metrics/R10: 68.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.147
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.735150206520075
 mnt_best       : 45.04394275469628
 not_improved_count: 12
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.69897 batch_time=24.95758 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.97575 batch_time=0.37365 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.86578 batch_time=1.27812 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 0.59664 batch_time=0.34901 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 0.69376 batch_time=0.35275 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.80252 batch_time=0.38109 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.10824 batch_time=0.39680 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.79860 batch_time=0.39344 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 0.92849 batch_time=0.37040 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.78750 batch_time=0.36015 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.86860 batch_time=0.35530 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 0.99947 batch_time=0.41801 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 0.90964 batch_time=3.25977 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.07792 batch_time=0.43672 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 0.73985 batch_time=0.43262 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.85716 batch_time=0.43654 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.87042 batch_time=0.43171 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.94767 batch_time=0.39110 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 0.89991 batch_time=0.36071 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.00865 batch_time=0.40049 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 0.77909 batch_time=0.37457 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 0.91236 batch_time=0.37742 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 0.77253 batch_time=0.39954 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch38.pth ...
Done in 4.346s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch38.pth ...
Done in 9.436s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 38
 loss           : 0.8489421019554139
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_miech_test/t2v_metrics/R1: 25.7
 MSRVTT_miech_test/t2v_metrics/R5: 53.7
 MSRVTT_miech_test/t2v_metrics/R10: 67.3
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.092
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.287063149871095
 MSRVTT_miech_test/v2t_metrics/R1: 24.7
 MSRVTT_miech_test/v2t_metrics/R5: 55.5
 MSRVTT_miech_test/v2t_metrics/R10: 68.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.544
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.496943803095
 mnt_best       : 45.287063149871095
 not_improved_count: 0
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.83791 batch_time=41.33918 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.00063 batch_time=0.35826 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 0.81484 batch_time=1.09427 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 0.68877 batch_time=0.39544 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 0.96135 batch_time=0.42645 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 0.96590 batch_time=0.61480 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.02837 batch_time=0.36927 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 0.82189 batch_time=0.35507 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.08324 batch_time=1.37849 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 0.74371 batch_time=0.38892 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.84213 batch_time=0.40808 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.89148 batch_time=0.39498 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 0.73824 batch_time=0.39495 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 0.80454 batch_time=0.35636 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 0.89011 batch_time=0.41653 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 0.90828 batch_time=0.40806 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 0.94046 batch_time=0.36711 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.78806 batch_time=0.37507 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.81868 batch_time=0.36952 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 0.88700 batch_time=0.37138 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 0.91772 batch_time=0.36776 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 0.94304 batch_time=0.41103 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.93168 batch_time=0.43078 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch39.pth ...
Done in 4.838s
removing stale ckpt [epoch 38] [took 0.03s]
 epoch          : 39
 loss           : 0.8539929535388947
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_miech_test/t2v_metrics/R1: 25.1
 MSRVTT_miech_test/t2v_metrics/R5: 53.1
 MSRVTT_miech_test/t2v_metrics/R10: 66.8
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.186
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.65275250373578
 MSRVTT_miech_test/v2t_metrics/R1: 26.5
 MSRVTT_miech_test/v2t_metrics/R5: 55.4
 MSRVTT_miech_test/v2t_metrics/R10: 67.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.5665
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.32137428645064
 mnt_best       : 45.287063149871095
 not_improved_count: 1
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.02757 batch_time=42.01133 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 0.70261 batch_time=0.36335 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 0.82337 batch_time=0.37201 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.89916 batch_time=0.37178 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 0.75740 batch_time=0.36498 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 0.83630 batch_time=0.37409 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 0.61857 batch_time=0.38577 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.19787 batch_time=0.40746 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 0.62132 batch_time=0.36932 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.58587 batch_time=0.38844 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 0.73405 batch_time=0.36106 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 0.70382 batch_time=0.35970 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 0.68313 batch_time=0.34669 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 0.95424 batch_time=0.35572 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 0.78860 batch_time=0.35861 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 0.86828 batch_time=0.41581 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.17946 batch_time=0.40693 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 0.83275 batch_time=0.35913 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 0.63654 batch_time=0.66801 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 0.90768 batch_time=0.36399 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 0.95460 batch_time=0.40046 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.96606 batch_time=0.38279 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.95992 batch_time=0.37630 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch40.pth ...
Done in 6.506s
removing stale ckpt [epoch 39] [took 0.02s]
 epoch          : 40
 loss           : 0.8314688725471496
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_miech_test/t2v_metrics/R1: 24.2
 MSRVTT_miech_test/t2v_metrics/R5: 53.1
 MSRVTT_miech_test/t2v_metrics/R10: 66.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.802
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.04640936545926
 MSRVTT_miech_test/v2t_metrics/R1: 25.2
 MSRVTT_miech_test/v2t_metrics/R5: 56.0
 MSRVTT_miech_test/v2t_metrics/R10: 67.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.3655
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.71503733883235
 mnt_best       : 45.287063149871095
 not_improved_count: 2
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.72339 batch_time=31.69244 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 0.91453 batch_time=0.39897 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 0.94993 batch_time=0.39902 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 0.98662 batch_time=0.37487 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 0.63691 batch_time=0.35275 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.67966 batch_time=0.35858 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 1.10918 batch_time=5.46443 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.63647 batch_time=0.34991 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 0.87267 batch_time=0.35212 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 0.91851 batch_time=0.37053 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 0.78650 batch_time=0.39383 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 0.66976 batch_time=0.34809 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 0.71601 batch_time=0.46147 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 0.95510 batch_time=0.37955 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 0.87508 batch_time=0.38385 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 0.79192 batch_time=0.43206 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 0.67540 batch_time=0.35670 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.84914 batch_time=0.36364 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 0.72759 batch_time=0.41025 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 0.66766 batch_time=0.38504 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 0.77164 batch_time=0.41306 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 0.86124 batch_time=0.35647 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 0.74382 batch_time=0.40547 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch41.pth ...
Done in 5.652s
removing stale ckpt [epoch 40] [took 0.03s]
 epoch          : 41
 loss           : 0.824235475063324
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_miech_test/t2v_metrics/R1: 24.0
 MSRVTT_miech_test/t2v_metrics/R5: 53.8
 MSRVTT_miech_test/t2v_metrics/R10: 66.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.601
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.116906737903825
 MSRVTT_miech_test/v2t_metrics/R1: 25.8
 MSRVTT_miech_test/v2t_metrics/R5: 55.6
 MSRVTT_miech_test/v2t_metrics/R10: 68.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.2305
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.05539765622975
 mnt_best       : 45.287063149871095
 not_improved_count: 3
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 0.93990 batch_time=30.65209 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.94532 batch_time=0.37975 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 0.72914 batch_time=0.39436 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 0.83248 batch_time=0.35762 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 0.91866 batch_time=0.36487 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 0.90003 batch_time=0.39415 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.03583 batch_time=0.41194 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 0.96013 batch_time=0.35619 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.98881 batch_time=0.36598 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 0.80658 batch_time=0.36709 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 0.76766 batch_time=0.39528 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 0.64976 batch_time=0.35098 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.09382 batch_time=0.38089 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.71649 batch_time=0.36861 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 0.61576 batch_time=0.36273 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 0.86020 batch_time=0.37365 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.82073 batch_time=0.35398 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.67962 batch_time=0.41441 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.59612 batch_time=5.10248 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 0.80736 batch_time=0.34779 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.89039 batch_time=0.36756 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.71558 batch_time=0.36059 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.20741 batch_time=0.42435 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch42.pth ...
Done in 19.295s
removing stale ckpt [epoch 41] [took 0.01s]
 epoch          : 42
 loss           : 0.8155262954235077
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_miech_test/t2v_metrics/R1: 24.2
 MSRVTT_miech_test/t2v_metrics/R5: 53.2
 MSRVTT_miech_test/t2v_metrics/R10: 66.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.951
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.07404200091647
 MSRVTT_miech_test/v2t_metrics/R1: 25.8
 MSRVTT_miech_test/v2t_metrics/R5: 55.4
 MSRVTT_miech_test/v2t_metrics/R10: 67.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.8
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.6675
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.88725254866575
 mnt_best       : 45.287063149871095
 not_improved_count: 4
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.74493 batch_time=24.33788 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.88604 batch_time=0.35300 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 0.89727 batch_time=0.39785 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 0.89634 batch_time=0.36275 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.06110 batch_time=0.35578 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 0.96044 batch_time=0.37940 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 0.74619 batch_time=1.24652 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 0.83968 batch_time=0.36210 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.85152 batch_time=0.36858 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 0.91306 batch_time=0.41279 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 0.91520 batch_time=0.39870 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.58189 batch_time=0.38412 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 0.66415 batch_time=0.34861 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.87626 batch_time=1.45255 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 0.84407 batch_time=0.40356 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.10322 batch_time=0.43101 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.74150 batch_time=0.39387 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.93538 batch_time=0.37372 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 0.59584 batch_time=0.38512 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 0.76176 batch_time=4.11138 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.07105 batch_time=0.35794 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 1.00765 batch_time=0.36208 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 0.74413 batch_time=0.35671 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch43.pth ...
Done in 4.176s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 0.818945865392685
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_miech_test/t2v_metrics/R1: 23.2
 MSRVTT_miech_test/t2v_metrics/R5: 53.3
 MSRVTT_miech_test/t2v_metrics/R10: 66.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.372
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.37635385709042
 MSRVTT_miech_test/v2t_metrics/R1: 25.6
 MSRVTT_miech_test/v2t_metrics/R5: 55.1
 MSRVTT_miech_test/v2t_metrics/R10: 68.7
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.8855
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.93207871420837
 mnt_best       : 45.287063149871095
 not_improved_count: 5
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 1.07475 batch_time=32.75955 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 0.68132 batch_time=0.35794 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 0.68184 batch_time=0.34976 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.82817 batch_time=0.38010 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.11517 batch_time=0.39195 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 0.86354 batch_time=0.34855 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 0.76579 batch_time=0.38188 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 0.89920 batch_time=0.37187 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 0.81241 batch_time=0.36522 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 0.68446 batch_time=0.35308 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 0.86541 batch_time=0.34996 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.01004 batch_time=0.36748 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 0.90220 batch_time=1.06626 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 0.79390 batch_time=0.34332 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 0.58396 batch_time=0.34984 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 0.94467 batch_time=0.35013 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 0.82485 batch_time=0.34179 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.54275 batch_time=0.34541 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 0.83779 batch_time=0.35099 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 0.64692 batch_time=0.38152 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 0.78852 batch_time=0.34784 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.77577 batch_time=0.40412 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 0.74294 batch_time=0.38538 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch44.pth ...
Done in 4.276s
removing stale ckpt [epoch 43] [took 0.01s]
 epoch          : 44
 loss           : 0.80011949634552
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_miech_test/t2v_metrics/R1: 24.9
 MSRVTT_miech_test/t2v_metrics/R5: 53.6
 MSRVTT_miech_test/t2v_metrics/R10: 67.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.896
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.762170446302186
 MSRVTT_miech_test/v2t_metrics/R1: 24.8
 MSRVTT_miech_test/v2t_metrics/R5: 56.1
 MSRVTT_miech_test/v2t_metrics/R10: 68.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.088
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.699651260532114
 mnt_best       : 45.287063149871095
 not_improved_count: 6
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 0.88494 batch_time=33.52824 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.57824 batch_time=0.36268 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.92146 batch_time=0.41627 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 0.69146 batch_time=0.35672 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 0.88274 batch_time=0.38633 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 0.91706 batch_time=0.42660 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.69800 batch_time=0.77999 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.05018 batch_time=0.35159 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 0.75194 batch_time=0.38410 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.87273 batch_time=0.43587 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.96994 batch_time=0.38948 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 0.73521 batch_time=0.44847 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.78348 batch_time=0.35841 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 0.88258 batch_time=0.43235 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 0.75163 batch_time=0.37500 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.99991 batch_time=0.36800 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.00518 batch_time=0.37510 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 0.62732 batch_time=0.46111 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.68423 batch_time=0.42435 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.65690 batch_time=0.38976 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 0.72055 batch_time=0.39660 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.91235 batch_time=0.34889 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 0.73254 batch_time=0.38832 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch45.pth ...
Done in 4.064s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 0.7864392371177673
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_miech_test/t2v_metrics/R1: 24.5
 MSRVTT_miech_test/t2v_metrics/R5: 53.9
 MSRVTT_miech_test/t2v_metrics/R10: 66.9
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.477
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.53761831853834
 MSRVTT_miech_test/v2t_metrics/R1: 24.8
 MSRVTT_miech_test/v2t_metrics/R5: 55.7
 MSRVTT_miech_test/v2t_metrics/R10: 68.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.8835
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.63504026738267
 mnt_best       : 45.287063149871095
 not_improved_count: 7
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.81139 batch_time=27.00141 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 0.81809 batch_time=0.36000 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.84036 batch_time=0.41523 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.00734 batch_time=0.35609 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 0.89112 batch_time=0.37924 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.03764 batch_time=0.38930 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.96013 batch_time=1.15362 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 0.73095 batch_time=0.38415 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.86176 batch_time=0.35965 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.70276 batch_time=0.38025 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 0.77513 batch_time=0.37969 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 0.70618 batch_time=0.48778 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 0.60569 batch_time=0.40693 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 0.83760 batch_time=0.36917 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 0.65255 batch_time=0.36619 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 0.81211 batch_time=0.37049 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 0.64644 batch_time=0.39696 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 0.63091 batch_time=0.38163 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.84902 batch_time=0.35696 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.70097 batch_time=0.40409 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.11712 batch_time=0.35386 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 0.68423 batch_time=0.40804 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.92028 batch_time=0.39503 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch46.pth ...
Done in 11.082s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 0.7965617053508759
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_miech_test/t2v_metrics/R1: 24.3
 MSRVTT_miech_test/t2v_metrics/R5: 54.6
 MSRVTT_miech_test/t2v_metrics/R10: 67.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 4.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.593
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.78465108491913
 MSRVTT_miech_test/v2t_metrics/R1: 24.5
 MSRVTT_miech_test/v2t_metrics/R5: 56.0
 MSRVTT_miech_test/v2t_metrics/R10: 68.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.4525
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.44332193197433
 mnt_best       : 45.287063149871095
 not_improved_count: 8
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 0.93114 batch_time=26.13271 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 0.91986 batch_time=0.36530 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 0.89356 batch_time=0.39093 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 0.92135 batch_time=0.55915 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 0.78571 batch_time=0.36160 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.52668 batch_time=0.63413 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 0.62956 batch_time=1.40357 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 0.83059 batch_time=2.13093 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 0.78782 batch_time=0.37271 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.89040 batch_time=0.36127 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.90916 batch_time=0.35758 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.65559 batch_time=0.37089 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 0.68562 batch_time=0.92497 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.93135 batch_time=0.36500 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 0.77059 batch_time=0.37344 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.90059 batch_time=0.36181 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 0.83389 batch_time=0.35216 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 0.77669 batch_time=0.39440 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 0.83270 batch_time=0.37771 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.72307 batch_time=0.37591 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.99809 batch_time=0.36790 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 0.82059 batch_time=0.36558 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 0.70115 batch_time=0.36017 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch47.pth ...
Done in 4.661s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 47
 loss           : 0.7784348531961441
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_miech_test/t2v_metrics/R1: 24.8
 MSRVTT_miech_test/t2v_metrics/R5: 54.0
 MSRVTT_miech_test/t2v_metrics/R10: 68.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 4.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.903
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.012263324382516
 MSRVTT_miech_test/v2t_metrics/R1: 24.9
 MSRVTT_miech_test/v2t_metrics/R5: 55.2
 MSRVTT_miech_test/v2t_metrics/R10: 68.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.986
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.47068626678385
 mnt_best       : 45.287063149871095
 not_improved_count: 9
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 0.64538 batch_time=29.38096 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.04528 batch_time=0.43410 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 0.70843 batch_time=0.37369 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 0.86906 batch_time=1.22278 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 0.64033 batch_time=0.38581 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 0.75031 batch_time=0.34572 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 0.66874 batch_time=0.38455 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 0.87515 batch_time=0.38243 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.72172 batch_time=0.40556 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 0.60561 batch_time=0.39165 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 0.59734 batch_time=0.42531 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 0.73184 batch_time=0.40484 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 0.67871 batch_time=0.35854 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 0.79368 batch_time=0.90403 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 0.73111 batch_time=0.39263 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 0.62879 batch_time=0.35851 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.60567 batch_time=0.38507 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 0.76001 batch_time=0.35849 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 0.72621 batch_time=0.41434 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 0.78897 batch_time=0.41006 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 0.75320 batch_time=0.36770 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 0.75916 batch_time=0.36396 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 0.56173 batch_time=0.38497 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch48.pth ...
Done in 9.969s
removing stale ckpt [epoch 47] [took 0.07s]
 epoch          : 48
 loss           : 0.7735847871303558
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_miech_test/t2v_metrics/R1: 24.9
 MSRVTT_miech_test/t2v_metrics/R5: 53.7
 MSRVTT_miech_test/t2v_metrics/R10: 66.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 4.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.932
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.67862738154641
 MSRVTT_miech_test/v2t_metrics/R1: 25.3
 MSRVTT_miech_test/v2t_metrics/R5: 55.3
 MSRVTT_miech_test/v2t_metrics/R10: 68.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.2995
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.67349595652998
 mnt_best       : 45.287063149871095
 not_improved_count: 10
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 0.77138 batch_time=30.24453 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 0.66261 batch_time=0.37765 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 0.84867 batch_time=0.36081 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 0.82062 batch_time=0.40154 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 0.78642 batch_time=0.35372 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 0.59038 batch_time=0.37675 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 0.75889 batch_time=0.40543 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.80560 batch_time=0.44104 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.56424 batch_time=0.36018 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.75728 batch_time=0.37826 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 0.72458 batch_time=0.38839 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.67631 batch_time=0.40120 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 0.94242 batch_time=0.36828 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 0.67679 batch_time=0.38658 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 0.79677 batch_time=0.40737 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.71385 batch_time=0.36168 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.50680 batch_time=0.36532 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 0.80749 batch_time=0.36753 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 0.87094 batch_time=0.35936 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 0.71113 batch_time=0.35476 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 0.87232 batch_time=0.39546 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.78014 batch_time=0.36868 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 0.62138 batch_time=0.35801 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch49.pth ...
Done in 4.886s
removing stale ckpt [epoch 48] [took 0.02s]
 epoch          : 49
 loss           : 0.7674293375015259
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_miech_test/t2v_metrics/R1: 25.0
 MSRVTT_miech_test/t2v_metrics/R5: 53.6
 MSRVTT_miech_test/t2v_metrics/R10: 66.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.834
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.55361126868942
 MSRVTT_miech_test/v2t_metrics/R1: 25.8
 MSRVTT_miech_test/v2t_metrics/R5: 55.7
 MSRVTT_miech_test/v2t_metrics/R10: 68.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.4125
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.08299226897713
 mnt_best       : 45.287063149871095
 not_improved_count: 11
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 0.73380 batch_time=38.89283 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 0.69883 batch_time=0.40047 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 0.59727 batch_time=0.39310 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 0.71225 batch_time=0.36933 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 0.77400 batch_time=0.40290 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.68012 batch_time=0.36189 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 0.72879 batch_time=0.37741 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.91679 batch_time=0.36883 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.71962 batch_time=0.38826 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 0.83120 batch_time=0.39729 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.65498 batch_time=0.35258 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.90418 batch_time=0.35209 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 0.76199 batch_time=0.36866 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 0.82116 batch_time=0.35238 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 0.84029 batch_time=0.36450 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.74898 batch_time=0.34472 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 0.64360 batch_time=0.34181 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 0.66234 batch_time=0.35061 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.85278 batch_time=1.75058 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.75521 batch_time=0.35298 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 0.63380 batch_time=0.34700 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 0.94390 batch_time=0.39633 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 0.62374 batch_time=0.36551 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/checkpoint-epoch50.pth ...
Done in 20.531s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 0.742249904870987
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_miech_test/t2v_metrics/R1: 25.2
 MSRVTT_miech_test/t2v_metrics/R5: 54.2
 MSRVTT_miech_test/t2v_metrics/R10: 67.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.802
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.13065436111538
 MSRVTT_miech_test/v2t_metrics/R1: 26.0
 MSRVTT_miech_test/v2t_metrics/R5: 55.8
 MSRVTT_miech_test/v2t_metrics/R10: 68.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 4.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.5965
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.29718116835131
 mnt_best       : 45.287063149871095
 not_improved_count: 12
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/trained_model.pth ...
Ckpt loaded at epoch 38.
Saved v2t similarity matrix to /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/MSRVTT-test-sims.npy
MSRVTT_miech_test:
 t2v_metrics/R1/final_eval: 25.7
 t2v_metrics/R5/final_eval: 53.7
 t2v_metrics/R10/final_eval: 67.3
 t2v_metrics/R50/final_eval: 88.3
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 31.092
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 45.287063149871095
 v2t_metrics/R1/final_eval: 24.7
 v2t_metrics/R5/final_eval: 55.5
 v2t_metrics/R10/final_eval: 68.7
 v2t_metrics/R50/final_eval: 88.8
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 25.544
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 45.496943803095
Best epoch for the monitored metric: 38
Script took 02h52m54s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kB/trained_model.pth
