Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 939.168178319931 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 83.42376852035522 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 64.12942886352539 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch0.pth ...
Done in 8.534s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch0.pth ...
Done in 10.402s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 486.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 496.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 6.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 509.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.537
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.5192494101851104
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.75770 (QuantReg: 22.49995) QuantErr: 22.49995 batch_time=25.04878 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.63326 (QuantReg: 22.52905) QuantErr: 22.52905 batch_time=1.38398 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.45945 (QuantReg: 22.59101) QuantErr: 22.59101 batch_time=0.52107 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.35111 (QuantReg: 22.63788) QuantErr: 22.63788 batch_time=0.50170 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.50255 (QuantReg: 22.66911) QuantErr: 22.66911 batch_time=0.50006 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 5.76515 (QuantReg: 22.63972) QuantErr: 22.63972 batch_time=0.79503 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.89738 (QuantReg: 22.58620) QuantErr: 22.58620 batch_time=0.49385 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.14738 (QuantReg: 22.62769) QuantErr: 22.62769 batch_time=0.49388 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.58241 (QuantReg: 22.62558) QuantErr: 22.62558 batch_time=0.49662 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.48778 (QuantReg: 22.65053) QuantErr: 22.65053 batch_time=0.51717 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 4.79116 (QuantReg: 22.62049) QuantErr: 22.62049 batch_time=0.52141 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 4.87858 (QuantReg: 22.63858) QuantErr: 22.63858 batch_time=0.48929 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.24421 (QuantReg: 22.61843) QuantErr: 22.61843 batch_time=0.49802 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.51504 (QuantReg: 22.63256) QuantErr: 22.63256 batch_time=0.51403 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.84998 (QuantReg: 22.61064) QuantErr: 22.61064 batch_time=0.50833 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.26080 (QuantReg: 22.62599) QuantErr: 22.62599 batch_time=0.48806 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.98276 (QuantReg: 22.64291) QuantErr: 22.64291 batch_time=0.50051 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.58471 (QuantReg: 22.63447) QuantErr: 22.63447 batch_time=0.48326 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.18234 (QuantReg: 22.62408) QuantErr: 22.62408 batch_time=0.49758 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.54063 (QuantReg: 22.62067) QuantErr: 22.62067 batch_time=0.54103 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 3.75853 (QuantReg: 22.67110) QuantErr: 22.67110 batch_time=0.50574 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.33773 (QuantReg: 22.65599) QuantErr: 22.65599 batch_time=0.49277 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.78661 (QuantReg: 22.64566) QuantErr: 22.64566 batch_time=0.48772 
Train Epoch: 1 codebook_update_time=2.11587
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch1.pth ...
Done in 3.980s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch1.pth ...
Done in 7.787s
 epoch          : 1
 loss           : 5.457815495491028
 quant_reg      : 22.622351364135742
 quant_err      : 22.622351364135742
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 11.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 31.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 45.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 77.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 43.171
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.776306794171642
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 32.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 45.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 13.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 41.329
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.871390520807314
 mnt_best       : 25.776306794171642
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.29878 (QuantReg: 11.91046) QuantErr: 11.91046 batch_time=25.64396 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.14213 (QuantReg: 12.02885) QuantErr: 12.02885 batch_time=0.69414 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.10042 (QuantReg: 12.44516) QuantErr: 12.44516 batch_time=0.47757 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.99988 (QuantReg: 12.31501) QuantErr: 12.31501 batch_time=0.49222 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.96264 (QuantReg: 12.92193) QuantErr: 12.92193 batch_time=0.49250 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 4.09270 (QuantReg: 12.81605) QuantErr: 12.81605 batch_time=0.49656 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 3.83910 (QuantReg: 12.67014) QuantErr: 12.67014 batch_time=0.48843 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.93331 (QuantReg: 12.91660) QuantErr: 12.91660 batch_time=0.49958 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 3.74319 (QuantReg: 13.22709) QuantErr: 13.22709 batch_time=0.50732 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.34224 (QuantReg: 13.18706) QuantErr: 13.18706 batch_time=0.49175 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.84694 (QuantReg: 13.04625) QuantErr: 13.04625 batch_time=0.48892 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.45452 (QuantReg: 13.50145) QuantErr: 13.50145 batch_time=0.49064 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.75394 (QuantReg: 13.16448) QuantErr: 13.16448 batch_time=1.19959 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.21062 (QuantReg: 13.35965) QuantErr: 13.35965 batch_time=0.50489 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 4.13746 (QuantReg: 13.52014) QuantErr: 13.52014 batch_time=0.48944 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.65509 (QuantReg: 13.89092) QuantErr: 13.89092 batch_time=0.51127 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.99241 (QuantReg: 13.81053) QuantErr: 13.81053 batch_time=0.50023 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.82146 (QuantReg: 14.01621) QuantErr: 14.01621 batch_time=1.08761 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.52297 (QuantReg: 14.06157) QuantErr: 14.06157 batch_time=0.50067 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.43768 (QuantReg: 13.98330) QuantErr: 13.98330 batch_time=3.49718 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.58319 (QuantReg: 14.11912) QuantErr: 14.11912 batch_time=0.49945 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.76404 (QuantReg: 14.00258) QuantErr: 14.00258 batch_time=0.52813 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.90958 (QuantReg: 14.26298) QuantErr: 14.26298 batch_time=1.18623 
Train Epoch: 2 codebook_update_time=1.62094
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch2.pth ...
Done in 18.755s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch2.pth ...
Done in 22.469s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 3.8444110975265504
 quant_reg      : 13.284837577819824
 quant_err      : 13.284837577819824
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 38.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.615
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.250699161947434
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 38.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 83.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.7325
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.75114129858992
 mnt_best       : 30.250699161947434
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.49838 (QuantReg: 11.77237) QuantErr: 11.77237 batch_time=31.63481 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.40566 (QuantReg: 11.84024) QuantErr: 11.84024 batch_time=0.48899 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.37447 (QuantReg: 11.93193) QuantErr: 11.93193 batch_time=0.49575 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 3.08928 (QuantReg: 11.78542) QuantErr: 11.78542 batch_time=0.49330 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.09311 (QuantReg: 11.99265) QuantErr: 11.99265 batch_time=0.49792 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 2.56256 (QuantReg: 11.66378) QuantErr: 11.66378 batch_time=0.48786 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.85358 (QuantReg: 12.29888) QuantErr: 12.29888 batch_time=3.68100 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.58512 (QuantReg: 12.09770) QuantErr: 12.09770 batch_time=0.51724 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.59439 (QuantReg: 12.01664) QuantErr: 12.01664 batch_time=0.48730 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 2.87183 (QuantReg: 12.26513) QuantErr: 12.26513 batch_time=0.49273 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.51806 (QuantReg: 12.03567) QuantErr: 12.03567 batch_time=0.48363 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.32854 (QuantReg: 11.91719) QuantErr: 11.91719 batch_time=0.48666 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.02997 (QuantReg: 11.83606) QuantErr: 11.83606 batch_time=0.49868 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.40278 (QuantReg: 11.85056) QuantErr: 11.85056 batch_time=0.49881 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.74530 (QuantReg: 11.61157) QuantErr: 11.61157 batch_time=0.49723 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.99375 (QuantReg: 11.93274) QuantErr: 11.93274 batch_time=0.49210 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.52014 (QuantReg: 12.49755) QuantErr: 12.49755 batch_time=0.49121 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.12796 (QuantReg: 12.34988) QuantErr: 12.34988 batch_time=0.51373 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.05535 (QuantReg: 12.33231) QuantErr: 12.33231 batch_time=0.84313 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.16954 (QuantReg: 12.22341) QuantErr: 12.22341 batch_time=1.06110 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.21924 (QuantReg: 12.22651) QuantErr: 12.22651 batch_time=0.49513 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.24256 (QuantReg: 12.64134) QuantErr: 12.64134 batch_time=0.49294 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.22784 (QuantReg: 12.62834) QuantErr: 12.62834 batch_time=0.54557 
Train Epoch: 3 codebook_update_time=1.84865
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch3.pth ...
Done in 3.754s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch3.pth ...
Done in 7.616s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 3.29838449382782
 quant_reg      : 12.085818374633789
 quant_err      : 12.085818374633789
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.227
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.03843455736734
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.278
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.862680994800606
 mnt_best       : 33.03843455736734
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 3.20176 (QuantReg: 11.61950) QuantErr: 11.61950 batch_time=34.06675 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.96222 (QuantReg: 11.47842) QuantErr: 11.47842 batch_time=2.61055 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 3.04241 (QuantReg: 11.60315) QuantErr: 11.60315 batch_time=0.49106 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.92793 (QuantReg: 11.74773) QuantErr: 11.74773 batch_time=0.50343 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.92060 (QuantReg: 11.75323) QuantErr: 11.75323 batch_time=0.59612 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.05256 (QuantReg: 11.58287) QuantErr: 11.58287 batch_time=0.50992 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.78976 (QuantReg: 11.54184) QuantErr: 11.54184 batch_time=1.29641 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.96202 (QuantReg: 11.78972) QuantErr: 11.78972 batch_time=0.53429 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 3.21651 (QuantReg: 11.49547) QuantErr: 11.49547 batch_time=0.50951 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.60078 (QuantReg: 11.71122) QuantErr: 11.71122 batch_time=0.48930 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 2.95602 (QuantReg: 12.23099) QuantErr: 12.23099 batch_time=0.52143 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.68420 (QuantReg: 12.29442) QuantErr: 12.29442 batch_time=0.56704 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.17559 (QuantReg: 11.85896) QuantErr: 11.85896 batch_time=0.54760 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.75863 (QuantReg: 11.99495) QuantErr: 11.99495 batch_time=1.05845 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.86032 (QuantReg: 11.92704) QuantErr: 11.92704 batch_time=0.50818 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.97042 (QuantReg: 11.84617) QuantErr: 11.84617 batch_time=0.90173 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.94605 (QuantReg: 11.81625) QuantErr: 11.81625 batch_time=0.49195 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.97900 (QuantReg: 11.96197) QuantErr: 11.96197 batch_time=0.49500 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.81569 (QuantReg: 12.36781) QuantErr: 12.36781 batch_time=0.48769 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.67165 (QuantReg: 11.88810) QuantErr: 11.88810 batch_time=0.49471 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.44359 (QuantReg: 12.37128) QuantErr: 12.37128 batch_time=0.53351 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.36971 (QuantReg: 12.41091) QuantErr: 12.41091 batch_time=0.49899 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 3.01883 (QuantReg: 11.97498) QuantErr: 11.97498 batch_time=0.48488 
Train Epoch: 4 codebook_update_time=1.67599
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch4.pth ...
Done in 3.710s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch4.pth ...
Done in 7.330s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 3.0121521730422973
 quant_reg      : 11.805778053283692
 quant_err      : 11.805778053283692
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.212
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.02898605593065
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.058
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.97650215558529
 mnt_best       : 35.02898605593065
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.85170 (QuantReg: 11.26032) QuantErr: 11.26032 batch_time=32.53799 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.22008 (QuantReg: 11.70573) QuantErr: 11.70573 batch_time=0.49692 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.47684 (QuantReg: 11.23778) QuantErr: 11.23778 batch_time=0.50953 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.70010 (QuantReg: 11.75146) QuantErr: 11.75146 batch_time=0.50682 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.89483 (QuantReg: 11.44058) QuantErr: 11.44058 batch_time=0.49945 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.59401 (QuantReg: 11.78171) QuantErr: 11.78171 batch_time=0.49814 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.79932 (QuantReg: 11.41721) QuantErr: 11.41721 batch_time=0.52249 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 3.24907 (QuantReg: 11.24996) QuantErr: 11.24996 batch_time=0.49926 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.81203 (QuantReg: 11.77327) QuantErr: 11.77327 batch_time=0.49349 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.75213 (QuantReg: 11.58409) QuantErr: 11.58409 batch_time=0.49240 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.75248 (QuantReg: 11.67718) QuantErr: 11.67718 batch_time=0.49365 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.77529 (QuantReg: 11.49786) QuantErr: 11.49786 batch_time=0.49332 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.61554 (QuantReg: 12.00043) QuantErr: 12.00043 batch_time=0.70558 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.31038 (QuantReg: 11.48089) QuantErr: 11.48089 batch_time=3.83716 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 3.14970 (QuantReg: 11.79284) QuantErr: 11.79284 batch_time=0.49726 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.44291 (QuantReg: 11.93482) QuantErr: 11.93482 batch_time=1.13817 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.88130 (QuantReg: 11.66491) QuantErr: 11.66491 batch_time=0.53219 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.77518 (QuantReg: 11.65548) QuantErr: 11.65548 batch_time=0.50329 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.75810 (QuantReg: 11.97480) QuantErr: 11.97480 batch_time=0.62531 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.69871 (QuantReg: 11.56259) QuantErr: 11.56259 batch_time=0.48454 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.98074 (QuantReg: 11.91811) QuantErr: 11.91811 batch_time=0.49422 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.61246 (QuantReg: 11.72700) QuantErr: 11.72700 batch_time=0.48911 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.99053 (QuantReg: 11.95722) QuantErr: 11.95722 batch_time=0.52087 
Train Epoch: 5 codebook_update_time=1.97262
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch5.pth ...
Done in 3.812s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch5.pth ...
Done in 7.514s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 2.7489051914215086
 quant_reg      : 11.695408233642578
 quant_err      : 11.695408233642578
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.634
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.330189006724666
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.003
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.57878311073783
 mnt_best       : 37.330189006724666
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.82594 (QuantReg: 11.50925) QuantErr: 11.50925 batch_time=29.40365 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.85786 (QuantReg: 11.07087) QuantErr: 11.07087 batch_time=0.50436 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.68063 (QuantReg: 11.41031) QuantErr: 11.41031 batch_time=0.49095 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.59787 (QuantReg: 11.42636) QuantErr: 11.42636 batch_time=0.49689 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.55309 (QuantReg: 11.39882) QuantErr: 11.39882 batch_time=1.16529 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.39271 (QuantReg: 11.41479) QuantErr: 11.41479 batch_time=0.49919 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.77088 (QuantReg: 11.77224) QuantErr: 11.77224 batch_time=0.99384 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.48460 (QuantReg: 11.82412) QuantErr: 11.82412 batch_time=0.50011 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.54821 (QuantReg: 11.60222) QuantErr: 11.60222 batch_time=0.59454 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.45743 (QuantReg: 11.49053) QuantErr: 11.49053 batch_time=0.66231 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.50052 (QuantReg: 12.07500) QuantErr: 12.07500 batch_time=0.50456 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.56832 (QuantReg: 11.58521) QuantErr: 11.58521 batch_time=0.50393 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.39333 (QuantReg: 11.66343) QuantErr: 11.66343 batch_time=0.62146 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.47969 (QuantReg: 11.58190) QuantErr: 11.58190 batch_time=0.97425 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.92701 (QuantReg: 11.93435) QuantErr: 11.93435 batch_time=0.49813 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.62671 (QuantReg: 11.74826) QuantErr: 11.74826 batch_time=0.50480 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.28159 (QuantReg: 11.86662) QuantErr: 11.86662 batch_time=0.49655 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.72787 (QuantReg: 11.72702) QuantErr: 11.72702 batch_time=0.49577 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.82499 (QuantReg: 11.78284) QuantErr: 11.78284 batch_time=0.49011 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.52356 (QuantReg: 11.75659) QuantErr: 11.75659 batch_time=0.51117 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.34914 (QuantReg: 11.77438) QuantErr: 11.77438 batch_time=0.50125 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.29148 (QuantReg: 11.55948) QuantErr: 11.55948 batch_time=0.49525 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.20663 (QuantReg: 11.74120) QuantErr: 11.74120 batch_time=0.49167 
Train Epoch: 6 codebook_update_time=1.75234
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch6.pth ...
Done in 3.484s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 2.5711864070892334
 quant_reg      : 11.699482761383056
 quant_err      : 11.699482761383056
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.884
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.95111635500847
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.6855
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.36594266791382
 mnt_best       : 37.330189006724666
 not_improved_count: 1
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.65123 (QuantReg: 11.08297) QuantErr: 11.08297 batch_time=29.30091 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.55499 (QuantReg: 11.43448) QuantErr: 11.43448 batch_time=0.50064 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.43593 (QuantReg: 11.09379) QuantErr: 11.09379 batch_time=0.50217 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.18169 (QuantReg: 11.36485) QuantErr: 11.36485 batch_time=0.50914 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.13786 (QuantReg: 11.39536) QuantErr: 11.39536 batch_time=0.50281 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.14560 (QuantReg: 11.73713) QuantErr: 11.73713 batch_time=0.53980 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.41448 (QuantReg: 11.78739) QuantErr: 11.78739 batch_time=3.12620 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.44966 (QuantReg: 11.62578) QuantErr: 11.62578 batch_time=0.49458 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.45002 (QuantReg: 11.81228) QuantErr: 11.81228 batch_time=0.50050 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.07741 (QuantReg: 11.73675) QuantErr: 11.73675 batch_time=0.51637 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.85914 (QuantReg: 11.80843) QuantErr: 11.80843 batch_time=0.51342 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.47368 (QuantReg: 11.67689) QuantErr: 11.67689 batch_time=0.50172 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.32180 (QuantReg: 11.65050) QuantErr: 11.65050 batch_time=0.49553 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.41734 (QuantReg: 11.37372) QuantErr: 11.37372 batch_time=0.49983 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 1.96370 (QuantReg: 11.50105) QuantErr: 11.50105 batch_time=0.50474 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.46306 (QuantReg: 11.62813) QuantErr: 11.62813 batch_time=0.51319 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 1.98109 (QuantReg: 11.86618) QuantErr: 11.86618 batch_time=0.49724 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.39546 (QuantReg: 11.53845) QuantErr: 11.53845 batch_time=0.71463 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.87813 (QuantReg: 11.79422) QuantErr: 11.79422 batch_time=0.50050 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.63079 (QuantReg: 11.91217) QuantErr: 11.91217 batch_time=0.48696 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.34527 (QuantReg: 11.87488) QuantErr: 11.87488 batch_time=0.50974 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.28279 (QuantReg: 12.28812) QuantErr: 12.28812 batch_time=0.50170 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.40432 (QuantReg: 11.81554) QuantErr: 11.81554 batch_time=0.49496 
Train Epoch: 7 codebook_update_time=1.61524
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch7.pth ...
Done in 4.761s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch7.pth ...
Done in 8.409s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 2.4022769312858583
 quant_reg      : 11.646035930633545
 quant_err      : 11.646035930633545
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.052
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.16715456361193
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.07
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.11561219026715
 mnt_best       : 39.16715456361193
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.61802 (QuantReg: 11.41349) QuantErr: 11.41349 batch_time=26.55590 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.60292 (QuantReg: 11.40925) QuantErr: 11.40925 batch_time=0.49693 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.85554 (QuantReg: 11.64435) QuantErr: 11.64435 batch_time=0.49051 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.40559 (QuantReg: 11.32045) QuantErr: 11.32045 batch_time=0.50361 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.47580 (QuantReg: 11.80800) QuantErr: 11.80800 batch_time=0.48281 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.14088 (QuantReg: 11.32491) QuantErr: 11.32491 batch_time=0.49298 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.36516 (QuantReg: 11.80098) QuantErr: 11.80098 batch_time=0.50164 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.54526 (QuantReg: 11.82983) QuantErr: 11.82983 batch_time=0.49383 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.51269 (QuantReg: 11.57488) QuantErr: 11.57488 batch_time=0.66536 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.70406 (QuantReg: 11.73942) QuantErr: 11.73942 batch_time=0.48773 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.58066 (QuantReg: 11.86380) QuantErr: 11.86380 batch_time=0.49920 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.28713 (QuantReg: 11.57133) QuantErr: 11.57133 batch_time=0.49906 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.34316 (QuantReg: 11.56165) QuantErr: 11.56165 batch_time=0.49248 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.51853 (QuantReg: 11.97151) QuantErr: 11.97151 batch_time=0.49927 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.25684 (QuantReg: 11.94013) QuantErr: 11.94013 batch_time=0.48135 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 2.13222 (QuantReg: 11.51758) QuantErr: 11.51758 batch_time=0.49017 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.16479 (QuantReg: 11.56124) QuantErr: 11.56124 batch_time=0.50503 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.79494 (QuantReg: 11.71108) QuantErr: 11.71108 batch_time=0.52254 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.50270 (QuantReg: 11.77541) QuantErr: 11.77541 batch_time=0.51299 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.46199 (QuantReg: 11.39030) QuantErr: 11.39030 batch_time=0.48991 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.39003 (QuantReg: 11.71115) QuantErr: 11.71115 batch_time=0.48449 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 1.89245 (QuantReg: 11.78155) QuantErr: 11.78155 batch_time=0.49326 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.56009 (QuantReg: 11.83689) QuantErr: 11.83689 batch_time=0.49369 
Train Epoch: 8 codebook_update_time=1.62622
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch8.pth ...
Done in 3.570s
removing stale ckpt [epoch 7] [took 0.01s]
 epoch          : 8
 loss           : 2.3137659759521485
 quant_reg      : 11.654494705200195
 quant_err      : 11.654494705200195
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.036
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.874071137809516
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.7895
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.5309969479668
 mnt_best       : 39.16715456361193
 not_improved_count: 1
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 1.94050 (QuantReg: 11.87071) QuantErr: 11.87071 batch_time=27.21038 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.42344 (QuantReg: 11.72441) QuantErr: 11.72441 batch_time=0.50455 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 1.91283 (QuantReg: 11.33228) QuantErr: 11.33228 batch_time=0.49323 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.33893 (QuantReg: 11.55259) QuantErr: 11.55259 batch_time=0.50696 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.15280 (QuantReg: 11.78662) QuantErr: 11.78662 batch_time=0.49927 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 1.90756 (QuantReg: 11.83543) QuantErr: 11.83543 batch_time=0.52305 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.99873 (QuantReg: 11.81831) QuantErr: 11.81831 batch_time=0.57427 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 2.15277 (QuantReg: 11.94272) QuantErr: 11.94272 batch_time=0.50166 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.37408 (QuantReg: 11.44879) QuantErr: 11.44879 batch_time=0.49864 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 2.02424 (QuantReg: 11.70028) QuantErr: 11.70028 batch_time=0.85116 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 2.19069 (QuantReg: 11.80773) QuantErr: 11.80773 batch_time=0.56036 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.80488 (QuantReg: 11.64323) QuantErr: 11.64323 batch_time=0.49341 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 2.21231 (QuantReg: 11.62040) QuantErr: 11.62040 batch_time=0.61146 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.05354 (QuantReg: 11.44669) QuantErr: 11.44669 batch_time=0.49080 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.25757 (QuantReg: 11.26276) QuantErr: 11.26276 batch_time=0.51501 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.90232 (QuantReg: 12.02817) QuantErr: 12.02817 batch_time=0.49471 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 2.45933 (QuantReg: 11.96879) QuantErr: 11.96879 batch_time=0.50189 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.71620 (QuantReg: 11.83312) QuantErr: 11.83312 batch_time=0.53044 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 2.25036 (QuantReg: 11.82197) QuantErr: 11.82197 batch_time=0.50049 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 2.10058 (QuantReg: 11.88523) QuantErr: 11.88523 batch_time=1.72874 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.98090 (QuantReg: 12.07209) QuantErr: 12.07209 batch_time=0.49911 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 2.00942 (QuantReg: 11.40877) QuantErr: 11.40877 batch_time=0.49290 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 2.03539 (QuantReg: 11.53467) QuantErr: 11.53467 batch_time=0.49167 
Train Epoch: 9 codebook_update_time=1.70794
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch9.pth ...
Done in 3.998s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 2.180047679424286
 quant_reg      : 11.657114269256592
 quant_err      : 11.657114269256592
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.928
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.04372304338925
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.654
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.00579082828389
 mnt_best       : 39.16715456361193
 not_improved_count: 2
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.94587 (QuantReg: 11.76104) QuantErr: 11.76104 batch_time=31.66100 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 2.19523 (QuantReg: 11.59434) QuantErr: 11.59434 batch_time=0.97279 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.49358 (QuantReg: 11.77807) QuantErr: 11.77807 batch_time=0.50480 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.11477 (QuantReg: 11.35999) QuantErr: 11.35999 batch_time=0.49695 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 1.83542 (QuantReg: 11.51327) QuantErr: 11.51327 batch_time=0.49211 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 2.08383 (QuantReg: 11.70291) QuantErr: 11.70291 batch_time=0.49830 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.50388 (QuantReg: 11.46190) QuantErr: 11.46190 batch_time=4.17313 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 2.13147 (QuantReg: 11.78397) QuantErr: 11.78397 batch_time=0.49048 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 2.20843 (QuantReg: 11.59874) QuantErr: 11.59874 batch_time=0.50385 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.07857 (QuantReg: 11.63511) QuantErr: 11.63511 batch_time=0.49841 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.92008 (QuantReg: 11.55277) QuantErr: 11.55277 batch_time=0.50089 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.23384 (QuantReg: 11.75201) QuantErr: 11.75201 batch_time=0.50553 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 2.18511 (QuantReg: 11.40049) QuantErr: 11.40049 batch_time=0.50515 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.83090 (QuantReg: 12.03710) QuantErr: 12.03710 batch_time=0.50541 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 2.13084 (QuantReg: 11.42074) QuantErr: 11.42074 batch_time=0.48770 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.30539 (QuantReg: 11.92447) QuantErr: 11.92447 batch_time=0.49440 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 2.25984 (QuantReg: 11.64336) QuantErr: 11.64336 batch_time=0.50753 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 2.02128 (QuantReg: 11.81517) QuantErr: 11.81517 batch_time=0.49503 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.83579 (QuantReg: 11.86671) QuantErr: 11.86671 batch_time=0.50268 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.69741 (QuantReg: 12.06993) QuantErr: 12.06993 batch_time=0.54627 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 2.16377 (QuantReg: 11.69491) QuantErr: 11.69491 batch_time=0.50562 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 2.43905 (QuantReg: 11.64402) QuantErr: 11.64402 batch_time=0.49280 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 2.21333 (QuantReg: 11.92410) QuantErr: 11.92410 batch_time=0.49649 
Train Epoch: 10 codebook_update_time=1.65784
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch10.pth ...
Done in 4.432s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch10.pth ...
Done in 8.439s
removing stale ckpt [epoch 9] [took 0.01s]
 epoch          : 10
 loss           : 2.0824551396369935
 quant_reg      : 11.69760541152954
 quant_err      : 11.69760541152954
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.655
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.878212907258906
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.101
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.24889473965625
 mnt_best       : 39.878212907258906
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 2.00793 (QuantReg: 11.45037) QuantErr: 11.45037 batch_time=31.89953 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.32123 (QuantReg: 11.29046) QuantErr: 11.29046 batch_time=0.49966 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 2.19971 (QuantReg: 11.58358) QuantErr: 11.58358 batch_time=0.49548 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 2.16745 (QuantReg: 11.69909) QuantErr: 11.69909 batch_time=0.50223 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.15132 (QuantReg: 11.58395) QuantErr: 11.58395 batch_time=0.53914 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 2.50542 (QuantReg: 12.18027) QuantErr: 12.18027 batch_time=0.48437 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 1.70875 (QuantReg: 11.64710) QuantErr: 11.64710 batch_time=2.23607 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 2.17798 (QuantReg: 11.34832) QuantErr: 11.34832 batch_time=0.55917 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 2.04088 (QuantReg: 11.56152) QuantErr: 11.56152 batch_time=0.49414 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.96639 (QuantReg: 11.78713) QuantErr: 11.78713 batch_time=2.48706 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.74843 (QuantReg: 11.82249) QuantErr: 11.82249 batch_time=0.75205 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.78629 (QuantReg: 11.78811) QuantErr: 11.78811 batch_time=0.55121 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 2.06794 (QuantReg: 11.50090) QuantErr: 11.50090 batch_time=0.52474 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.87887 (QuantReg: 11.59877) QuantErr: 11.59877 batch_time=0.49177 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.71052 (QuantReg: 11.76459) QuantErr: 11.76459 batch_time=0.49392 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.38305 (QuantReg: 11.25255) QuantErr: 11.25255 batch_time=0.53548 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.88121 (QuantReg: 11.59166) QuantErr: 11.59166 batch_time=0.48883 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.96387 (QuantReg: 11.92093) QuantErr: 11.92093 batch_time=0.84885 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 2.00256 (QuantReg: 11.57096) QuantErr: 11.57096 batch_time=0.49871 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.81869 (QuantReg: 11.77925) QuantErr: 11.77925 batch_time=0.49572 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.93363 (QuantReg: 11.64817) QuantErr: 11.64817 batch_time=0.49634 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 2.04789 (QuantReg: 11.84145) QuantErr: 11.84145 batch_time=0.61182 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.92673 (QuantReg: 11.94153) QuantErr: 11.94153 batch_time=0.51744 
Train Epoch: 11 codebook_update_time=1.59967
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch11.pth ...
Done in 4.765s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch11.pth ...
Done in 9.676s
removing stale ckpt [epoch 10] [took 0.10s]
 epoch          : 11
 loss           : 1.9959793186187744
 quant_reg      : 11.677843952178955
 quant_err      : 11.677843952178955
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.901
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.21118793155395
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.1065
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.28218151988247
 mnt_best       : 41.21118793155395
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.76152 (QuantReg: 11.38160) QuantErr: 11.38160 batch_time=26.74566 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.92255 (QuantReg: 11.58846) QuantErr: 11.58846 batch_time=0.49877 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 2.03885 (QuantReg: 11.66586) QuantErr: 11.66586 batch_time=0.49830 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 2.17615 (QuantReg: 11.64092) QuantErr: 11.64092 batch_time=0.48878 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.85206 (QuantReg: 11.57335) QuantErr: 11.57335 batch_time=0.48954 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.92388 (QuantReg: 11.67140) QuantErr: 11.67140 batch_time=0.49603 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 2.23595 (QuantReg: 11.99403) QuantErr: 11.99403 batch_time=0.51643 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 2.10303 (QuantReg: 11.28702) QuantErr: 11.28702 batch_time=1.53949 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.88974 (QuantReg: 11.67731) QuantErr: 11.67731 batch_time=0.49386 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.80708 (QuantReg: 11.74828) QuantErr: 11.74828 batch_time=0.49679 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.78699 (QuantReg: 11.73780) QuantErr: 11.73780 batch_time=0.49872 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.68654 (QuantReg: 11.84158) QuantErr: 11.84158 batch_time=0.49271 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.82397 (QuantReg: 11.49906) QuantErr: 11.49906 batch_time=0.50684 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.85774 (QuantReg: 11.41680) QuantErr: 11.41680 batch_time=0.49773 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 2.09738 (QuantReg: 12.06208) QuantErr: 12.06208 batch_time=0.50518 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.98188 (QuantReg: 11.79749) QuantErr: 11.79749 batch_time=0.49770 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 2.06638 (QuantReg: 11.91449) QuantErr: 11.91449 batch_time=0.50820 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.69662 (QuantReg: 11.82273) QuantErr: 11.82273 batch_time=0.49514 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 2.09918 (QuantReg: 11.63617) QuantErr: 11.63617 batch_time=3.05242 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.76744 (QuantReg: 11.83157) QuantErr: 11.83157 batch_time=0.50877 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.63352 (QuantReg: 11.96317) QuantErr: 11.96317 batch_time=0.49309 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 2.01678 (QuantReg: 11.93656) QuantErr: 11.93656 batch_time=0.58063 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.83019 (QuantReg: 11.73783) QuantErr: 11.73783 batch_time=0.50955 
Train Epoch: 12 codebook_update_time=1.60144
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch12.pth ...
Done in 4.340s
removing stale ckpt [epoch 11] [took 0.02s]
 epoch          : 12
 loss           : 1.937915223121643
 quant_reg      : 11.682352642059326
 quant_err      : 11.682352642059326
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.12
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.34861945160592
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.394
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.308170052229144
 mnt_best       : 41.21118793155395
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 2.04340 (QuantReg: 11.42254) QuantErr: 11.42254 batch_time=39.28424 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.49075 (QuantReg: 12.00422) QuantErr: 12.00422 batch_time=0.50050 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.96609 (QuantReg: 11.44065) QuantErr: 11.44065 batch_time=0.48981 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.59893 (QuantReg: 11.86154) QuantErr: 11.86154 batch_time=0.48091 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.99761 (QuantReg: 11.99395) QuantErr: 11.99395 batch_time=0.58774 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 2.09933 (QuantReg: 11.35783) QuantErr: 11.35783 batch_time=0.48898 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.79815 (QuantReg: 11.85272) QuantErr: 11.85272 batch_time=0.49666 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.94640 (QuantReg: 11.75588) QuantErr: 11.75588 batch_time=0.51195 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.78186 (QuantReg: 11.81899) QuantErr: 11.81899 batch_time=0.50069 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.68966 (QuantReg: 11.70083) QuantErr: 11.70083 batch_time=0.49159 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.75626 (QuantReg: 11.85921) QuantErr: 11.85921 batch_time=0.49172 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.78625 (QuantReg: 12.06444) QuantErr: 12.06444 batch_time=0.50110 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.86503 (QuantReg: 11.64062) QuantErr: 11.64062 batch_time=0.51464 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.86273 (QuantReg: 11.79840) QuantErr: 11.79840 batch_time=0.49096 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.67372 (QuantReg: 11.80117) QuantErr: 11.80117 batch_time=0.49715 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 2.16297 (QuantReg: 11.79405) QuantErr: 11.79405 batch_time=0.51071 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.86099 (QuantReg: 11.91264) QuantErr: 11.91264 batch_time=0.49288 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 2.11972 (QuantReg: 11.63208) QuantErr: 11.63208 batch_time=0.48736 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.69646 (QuantReg: 11.83399) QuantErr: 11.83399 batch_time=0.48763 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 2.00456 (QuantReg: 11.70647) QuantErr: 11.70647 batch_time=0.50255 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.48150 (QuantReg: 11.87008) QuantErr: 11.87008 batch_time=0.48704 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.85294 (QuantReg: 11.75589) QuantErr: 11.75589 batch_time=0.48322 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 2.10735 (QuantReg: 11.69657) QuantErr: 11.69657 batch_time=0.49557 
Train Epoch: 13 codebook_update_time=2.00635
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch13.pth ...
Done in 4.881s
removing stale ckpt [epoch 12] [took 0.01s]
 epoch          : 13
 loss           : 1.8828507232666016
 quant_reg      : 11.722905517578125
 quant_err      : 11.722905517578125
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.359
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.824552695720186
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.0915
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.3456972782244
 mnt_best       : 41.21118793155395
 not_improved_count: 2
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.78506 (QuantReg: 11.79044) QuantErr: 11.79044 batch_time=31.20355 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.64814 (QuantReg: 11.55676) QuantErr: 11.55676 batch_time=1.56989 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.83067 (QuantReg: 11.58197) QuantErr: 11.58197 batch_time=0.49026 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.71309 (QuantReg: 11.94009) QuantErr: 11.94009 batch_time=0.76201 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.59144 (QuantReg: 11.69077) QuantErr: 11.69077 batch_time=0.49277 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 2.15454 (QuantReg: 11.36077) QuantErr: 11.36077 batch_time=0.49217 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 2.01182 (QuantReg: 11.49815) QuantErr: 11.49815 batch_time=1.20719 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.90526 (QuantReg: 11.67334) QuantErr: 11.67334 batch_time=0.48836 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.62049 (QuantReg: 11.31393) QuantErr: 11.31393 batch_time=0.50966 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.56030 (QuantReg: 11.69759) QuantErr: 11.69759 batch_time=0.48711 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 2.15105 (QuantReg: 11.60551) QuantErr: 11.60551 batch_time=0.50508 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.62674 (QuantReg: 11.56166) QuantErr: 11.56166 batch_time=0.49299 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.68124 (QuantReg: 11.87864) QuantErr: 11.87864 batch_time=0.48331 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 2.08098 (QuantReg: 11.45795) QuantErr: 11.45795 batch_time=0.49146 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.78483 (QuantReg: 11.64850) QuantErr: 11.64850 batch_time=0.49017 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 2.07524 (QuantReg: 11.59998) QuantErr: 11.59998 batch_time=0.50310 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.72136 (QuantReg: 11.90548) QuantErr: 11.90548 batch_time=0.50096 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.98404 (QuantReg: 11.58949) QuantErr: 11.58949 batch_time=0.49757 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.83003 (QuantReg: 11.91714) QuantErr: 11.91714 batch_time=0.49200 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.85419 (QuantReg: 11.65454) QuantErr: 11.65454 batch_time=2.53652 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 2.00444 (QuantReg: 11.71759) QuantErr: 11.71759 batch_time=0.49646 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.57686 (QuantReg: 12.15079) QuantErr: 12.15079 batch_time=0.53620 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.46791 (QuantReg: 11.85559) QuantErr: 11.85559 batch_time=0.48858 
Train Epoch: 14 codebook_update_time=1.66118
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch14.pth ...
Done in 4.418s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch14.pth ...
Done in 8.389s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 1.8135969672203065
 quant_reg      : 11.683833583831786
 quant_err      : 11.683833583831786
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.712
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.86992067299294
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.3655
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.716821012163045
 mnt_best       : 41.86992067299294
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.69412 (QuantReg: 11.64164) QuantErr: 11.64164 batch_time=34.62941 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.27031 (QuantReg: 11.74502) QuantErr: 11.74502 batch_time=0.53259 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.81389 (QuantReg: 11.69112) QuantErr: 11.69112 batch_time=0.50406 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.52661 (QuantReg: 11.37015) QuantErr: 11.37015 batch_time=0.50646 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.91361 (QuantReg: 11.78189) QuantErr: 11.78189 batch_time=0.54342 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.85509 (QuantReg: 11.60126) QuantErr: 11.60126 batch_time=0.73656 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.86413 (QuantReg: 11.95014) QuantErr: 11.95014 batch_time=0.48232 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.47150 (QuantReg: 11.56355) QuantErr: 11.56355 batch_time=0.48961 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 2.03930 (QuantReg: 11.78081) QuantErr: 11.78081 batch_time=0.54349 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.68243 (QuantReg: 11.58844) QuantErr: 11.58844 batch_time=0.49276 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 2.11301 (QuantReg: 11.86027) QuantErr: 11.86027 batch_time=0.49208 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.54695 (QuantReg: 11.94890) QuantErr: 11.94890 batch_time=0.49984 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.76693 (QuantReg: 11.76665) QuantErr: 11.76665 batch_time=0.51592 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.61275 (QuantReg: 11.69785) QuantErr: 11.69785 batch_time=0.51422 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.76296 (QuantReg: 11.81032) QuantErr: 11.81032 batch_time=0.50439 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.58707 (QuantReg: 11.67765) QuantErr: 11.67765 batch_time=0.52765 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.54886 (QuantReg: 11.83716) QuantErr: 11.83716 batch_time=0.55437 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.68506 (QuantReg: 11.70525) QuantErr: 11.70525 batch_time=0.51240 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 2.16815 (QuantReg: 11.56808) QuantErr: 11.56808 batch_time=0.50930 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.60370 (QuantReg: 11.93199) QuantErr: 11.93199 batch_time=1.54800 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.50265 (QuantReg: 11.73559) QuantErr: 11.73559 batch_time=0.53886 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.82043 (QuantReg: 11.91375) QuantErr: 11.91375 batch_time=0.55262 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.64147 (QuantReg: 11.71342) QuantErr: 11.71342 batch_time=0.54522 
Train Epoch: 15 codebook_update_time=1.81522
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch15.pth ...
Done in 5.940s
removing stale ckpt [epoch 14] [took 0.15s]
 epoch          : 15
 loss           : 1.7508210430145263
 quant_reg      : 11.703841304779052
 quant_err      : 11.703841304779052
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.02
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.76398205380343
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.2715
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.13902907185565
 mnt_best       : 41.86992067299294
 not_improved_count: 1
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.97400 (QuantReg: 11.54064) QuantErr: 11.54064 batch_time=37.91599 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.81116 (QuantReg: 11.34474) QuantErr: 11.34474 batch_time=0.59718 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.66478 (QuantReg: 11.66927) QuantErr: 11.66927 batch_time=1.24857 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 2.29158 (QuantReg: 11.27719) QuantErr: 11.27719 batch_time=0.54851 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.69985 (QuantReg: 11.80675) QuantErr: 11.80675 batch_time=0.50748 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.90726 (QuantReg: 11.90016) QuantErr: 11.90016 batch_time=0.52507 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.46225 (QuantReg: 11.83074) QuantErr: 11.83074 batch_time=0.51616 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.76546 (QuantReg: 11.52280) QuantErr: 11.52280 batch_time=0.53039 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.72867 (QuantReg: 11.62815) QuantErr: 11.62815 batch_time=0.51736 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.61989 (QuantReg: 11.92871) QuantErr: 11.92871 batch_time=0.74630 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.48518 (QuantReg: 11.85624) QuantErr: 11.85624 batch_time=0.50953 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.65768 (QuantReg: 11.71790) QuantErr: 11.71790 batch_time=0.49617 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.59057 (QuantReg: 11.73006) QuantErr: 11.73006 batch_time=0.63125 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 2.13672 (QuantReg: 11.79545) QuantErr: 11.79545 batch_time=0.52557 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 2.07591 (QuantReg: 11.83274) QuantErr: 11.83274 batch_time=0.49988 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.84424 (QuantReg: 11.75590) QuantErr: 11.75590 batch_time=0.54208 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.52345 (QuantReg: 12.04464) QuantErr: 12.04464 batch_time=0.51113 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.91111 (QuantReg: 11.64525) QuantErr: 11.64525 batch_time=0.50450 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.70616 (QuantReg: 11.73325) QuantErr: 11.73325 batch_time=0.54118 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.58321 (QuantReg: 11.97224) QuantErr: 11.97224 batch_time=1.00213 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.71904 (QuantReg: 11.72902) QuantErr: 11.72902 batch_time=0.52023 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.86193 (QuantReg: 11.64134) QuantErr: 11.64134 batch_time=0.66016 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.81043 (QuantReg: 11.72597) QuantErr: 11.72597 batch_time=0.53064 
Train Epoch: 16 codebook_update_time=1.77493
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch16.pth ...
Done in 4.949s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 1.7409626169204713
 quant_reg      : 11.697281410217284
 quant_err      : 11.697281410217284
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.838
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.3331179893972
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.269
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.301151822164265
 mnt_best       : 41.86992067299294
 not_improved_count: 2
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.53200 (QuantReg: 11.84306) QuantErr: 11.84306 batch_time=34.57727 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.88573 (QuantReg: 11.40873) QuantErr: 11.40873 batch_time=0.52187 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.57836 (QuantReg: 11.44728) QuantErr: 11.44728 batch_time=0.53361 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 2.13589 (QuantReg: 11.77336) QuantErr: 11.77336 batch_time=0.49573 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.80306 (QuantReg: 11.41647) QuantErr: 11.41647 batch_time=0.51971 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.74899 (QuantReg: 11.80018) QuantErr: 11.80018 batch_time=0.51340 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.90876 (QuantReg: 11.72919) QuantErr: 11.72919 batch_time=0.53991 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.50672 (QuantReg: 11.63526) QuantErr: 11.63526 batch_time=0.54983 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.68113 (QuantReg: 11.44149) QuantErr: 11.44149 batch_time=0.49846 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.81090 (QuantReg: 11.82267) QuantErr: 11.82267 batch_time=0.79341 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.77494 (QuantReg: 11.76961) QuantErr: 11.76961 batch_time=0.50661 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.65930 (QuantReg: 11.67058) QuantErr: 11.67058 batch_time=0.49777 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.90802 (QuantReg: 11.64628) QuantErr: 11.64628 batch_time=0.55663 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.72185 (QuantReg: 11.85050) QuantErr: 11.85050 batch_time=0.49910 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 2.01838 (QuantReg: 11.33745) QuantErr: 11.33745 batch_time=0.49609 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.58767 (QuantReg: 11.65280) QuantErr: 11.65280 batch_time=0.51710 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.89934 (QuantReg: 11.89505) QuantErr: 11.89505 batch_time=0.49763 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.51312 (QuantReg: 12.00755) QuantErr: 12.00755 batch_time=0.51382 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.71601 (QuantReg: 11.41910) QuantErr: 11.41910 batch_time=1.00729 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.49702 (QuantReg: 11.86026) QuantErr: 11.86026 batch_time=1.02720 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.68436 (QuantReg: 11.56851) QuantErr: 11.56851 batch_time=0.56065 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.73957 (QuantReg: 12.08476) QuantErr: 12.08476 batch_time=0.52185 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.40265 (QuantReg: 11.59479) QuantErr: 11.59479 batch_time=0.55565 
Train Epoch: 17 codebook_update_time=2.03429
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch17.pth ...
Done in 4.848s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch17.pth ...
Done in 9.705s
removing stale ckpt [epoch 16] [took 0.02s]
 epoch          : 17
 loss           : 1.6905624680519105
 quant_reg      : 11.72966760635376
 quant_err      : 11.72966760635376
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.635
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.45094150111946
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.6675
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.625794953110955
 mnt_best       : 42.45094150111946
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.77496 (QuantReg: 11.51497) QuantErr: 11.51497 batch_time=34.48347 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.63087 (QuantReg: 11.56630) QuantErr: 11.56630 batch_time=0.50368 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.52165 (QuantReg: 11.75935) QuantErr: 11.75935 batch_time=0.50794 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.39520 (QuantReg: 11.84839) QuantErr: 11.84839 batch_time=0.51702 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.63295 (QuantReg: 11.46411) QuantErr: 11.46411 batch_time=0.50839 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.47503 (QuantReg: 11.96200) QuantErr: 11.96200 batch_time=0.50457 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.24922 (QuantReg: 11.98670) QuantErr: 11.98670 batch_time=0.87732 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.47194 (QuantReg: 11.79028) QuantErr: 11.79028 batch_time=0.50235 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.94376 (QuantReg: 11.87077) QuantErr: 11.87077 batch_time=0.51311 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.56071 (QuantReg: 11.52288) QuantErr: 11.52288 batch_time=0.50031 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.91214 (QuantReg: 11.64868) QuantErr: 11.64868 batch_time=0.49378 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.79679 (QuantReg: 11.73249) QuantErr: 11.73249 batch_time=0.50821 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.64721 (QuantReg: 11.60610) QuantErr: 11.60610 batch_time=0.49204 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.90295 (QuantReg: 11.49692) QuantErr: 11.49692 batch_time=1.96175 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.68284 (QuantReg: 11.41279) QuantErr: 11.41279 batch_time=0.51045 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.67711 (QuantReg: 12.08247) QuantErr: 12.08247 batch_time=0.52460 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.54927 (QuantReg: 11.52655) QuantErr: 11.52655 batch_time=0.51174 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.50606 (QuantReg: 11.71715) QuantErr: 11.71715 batch_time=0.51000 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.60605 (QuantReg: 11.81597) QuantErr: 11.81597 batch_time=0.49998 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.32903 (QuantReg: 11.80433) QuantErr: 11.80433 batch_time=0.49556 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.95629 (QuantReg: 11.49994) QuantErr: 11.49994 batch_time=0.50361 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.56490 (QuantReg: 11.79450) QuantErr: 11.79450 batch_time=0.54442 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.61987 (QuantReg: 11.80861) QuantErr: 11.80861 batch_time=0.51115 
Train Epoch: 18 codebook_update_time=2.00652
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch18.pth ...
Done in 4.437s
removing stale ckpt [epoch 17] [took 0.02s]
 epoch          : 18
 loss           : 1.6324078965187072
 quant_reg      : 11.732792835235596
 quant_err      : 11.732792835235596
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.125
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.353907428935855
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.7925
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.653195878473994
 mnt_best       : 42.45094150111946
 not_improved_count: 1
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.46927 (QuantReg: 11.83071) QuantErr: 11.83071 batch_time=43.83839 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.50168 (QuantReg: 11.71607) QuantErr: 11.71607 batch_time=0.50823 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.80537 (QuantReg: 11.51280) QuantErr: 11.51280 batch_time=0.51306 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.88427 (QuantReg: 11.73114) QuantErr: 11.73114 batch_time=0.51750 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.47559 (QuantReg: 11.63965) QuantErr: 11.63965 batch_time=0.51882 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.30644 (QuantReg: 11.86008) QuantErr: 11.86008 batch_time=0.54318 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.26613 (QuantReg: 11.73852) QuantErr: 11.73852 batch_time=0.51485 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.51236 (QuantReg: 11.54187) QuantErr: 11.54187 batch_time=0.51699 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.43897 (QuantReg: 11.70592) QuantErr: 11.70592 batch_time=0.49230 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.80737 (QuantReg: 11.37287) QuantErr: 11.37287 batch_time=0.52215 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.64161 (QuantReg: 11.56489) QuantErr: 11.56489 batch_time=0.53691 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.52192 (QuantReg: 11.95199) QuantErr: 11.95199 batch_time=0.51106 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.71065 (QuantReg: 11.98440) QuantErr: 11.98440 batch_time=0.51794 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.58737 (QuantReg: 11.79988) QuantErr: 11.79988 batch_time=0.55974 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.97720 (QuantReg: 11.56878) QuantErr: 11.56878 batch_time=0.51221 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.17365 (QuantReg: 11.77995) QuantErr: 11.77995 batch_time=0.55726 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.48428 (QuantReg: 11.73509) QuantErr: 11.73509 batch_time=0.51370 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.61324 (QuantReg: 11.68927) QuantErr: 11.68927 batch_time=0.65196 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.61763 (QuantReg: 11.48047) QuantErr: 11.48047 batch_time=0.56359 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.51941 (QuantReg: 11.71028) QuantErr: 11.71028 batch_time=0.50914 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.68866 (QuantReg: 11.92160) QuantErr: 11.92160 batch_time=2.11869 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.90394 (QuantReg: 11.56173) QuantErr: 11.56173 batch_time=0.49656 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.63679 (QuantReg: 12.03522) QuantErr: 12.03522 batch_time=0.53105 
Train Epoch: 19 codebook_update_time=2.03955
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch19.pth ...
Done in 4.189s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch19.pth ...
Done in 8.951s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 1.606006980895996
 quant_reg      : 11.750016399383545
 quant_err      : 11.750016399383545
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.215
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.592766226742036
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.257
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.295701132074065
 mnt_best       : 42.592766226742036
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.21805 (QuantReg: 11.89565) QuantErr: 11.89565 batch_time=33.07264 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.57500 (QuantReg: 11.63760) QuantErr: 11.63760 batch_time=0.52591 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.53019 (QuantReg: 11.64288) QuantErr: 11.64288 batch_time=0.51093 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.31024 (QuantReg: 11.39429) QuantErr: 11.39429 batch_time=0.50272 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.72245 (QuantReg: 11.51490) QuantErr: 11.51490 batch_time=0.52034 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.44010 (QuantReg: 11.74443) QuantErr: 11.74443 batch_time=0.53864 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.31196 (QuantReg: 11.90449) QuantErr: 11.90449 batch_time=1.38339 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.70476 (QuantReg: 11.64293) QuantErr: 11.64293 batch_time=0.50056 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.66666 (QuantReg: 11.78872) QuantErr: 11.78872 batch_time=0.50735 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.27925 (QuantReg: 11.73647) QuantErr: 11.73647 batch_time=0.60790 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.63437 (QuantReg: 11.60498) QuantErr: 11.60498 batch_time=0.49609 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.68366 (QuantReg: 11.98925) QuantErr: 11.98925 batch_time=0.73580 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.47966 (QuantReg: 11.60828) QuantErr: 11.60828 batch_time=0.52201 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.44390 (QuantReg: 11.83758) QuantErr: 11.83758 batch_time=0.50620 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.59515 (QuantReg: 11.78955) QuantErr: 11.78955 batch_time=0.49857 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.67577 (QuantReg: 12.06099) QuantErr: 12.06099 batch_time=0.54878 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.54565 (QuantReg: 11.73227) QuantErr: 11.73227 batch_time=0.50961 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.43971 (QuantReg: 11.91978) QuantErr: 11.91978 batch_time=0.50346 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.56995 (QuantReg: 11.70608) QuantErr: 11.70608 batch_time=0.52359 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.44000 (QuantReg: 11.66548) QuantErr: 11.66548 batch_time=0.63602 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.69716 (QuantReg: 11.92804) QuantErr: 11.92804 batch_time=0.54224 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.65316 (QuantReg: 12.02423) QuantErr: 12.02423 batch_time=0.51267 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.61564 (QuantReg: 11.73016) QuantErr: 11.73016 batch_time=0.86593 
Train Epoch: 20 codebook_update_time=1.67465
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch20.pth ...
Done in 5.036s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch20.pth ...
Done in 10.035s
removing stale ckpt [epoch 19] [took 0.02s]
 epoch          : 20
 loss           : 1.59137140417099
 quant_reg      : 11.748839382171631
 quant_err      : 11.748839382171631
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.431
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.76755190491828
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.75
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.5055
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.65027587018891
 mnt_best       : 42.76755190491828
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.74967 (QuantReg: 11.72707) QuantErr: 11.72707 batch_time=43.33252 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.49481 (QuantReg: 11.96265) QuantErr: 11.96265 batch_time=0.52742 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.74332 (QuantReg: 11.95164) QuantErr: 11.95164 batch_time=0.50744 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.90067 (QuantReg: 11.76837) QuantErr: 11.76837 batch_time=0.49452 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.47055 (QuantReg: 11.39915) QuantErr: 11.39915 batch_time=0.50631 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.49072 (QuantReg: 11.72103) QuantErr: 11.72103 batch_time=0.53150 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 2.03907 (QuantReg: 11.71522) QuantErr: 11.71522 batch_time=0.52407 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.55791 (QuantReg: 11.63617) QuantErr: 11.63617 batch_time=0.54242 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.40066 (QuantReg: 11.64657) QuantErr: 11.64657 batch_time=0.51307 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.59665 (QuantReg: 11.47367) QuantErr: 11.47367 batch_time=0.49896 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.29805 (QuantReg: 11.95355) QuantErr: 11.95355 batch_time=0.49712 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.32667 (QuantReg: 11.48010) QuantErr: 11.48010 batch_time=0.50766 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.55480 (QuantReg: 11.80464) QuantErr: 11.80464 batch_time=0.55298 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.28941 (QuantReg: 11.66937) QuantErr: 11.66937 batch_time=0.50200 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.67800 (QuantReg: 11.50457) QuantErr: 11.50457 batch_time=0.50401 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.62445 (QuantReg: 12.02710) QuantErr: 12.02710 batch_time=0.50838 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.67779 (QuantReg: 11.45803) QuantErr: 11.45803 batch_time=0.50354 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.52262 (QuantReg: 11.56095) QuantErr: 11.56095 batch_time=0.53247 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.64255 (QuantReg: 11.88142) QuantErr: 11.88142 batch_time=0.53120 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.76112 (QuantReg: 11.35246) QuantErr: 11.35246 batch_time=0.49214 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.62268 (QuantReg: 12.12257) QuantErr: 12.12257 batch_time=0.51145 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.50639 (QuantReg: 11.97460) QuantErr: 11.97460 batch_time=0.51813 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.70616 (QuantReg: 12.03633) QuantErr: 12.03633 batch_time=0.51195 
Train Epoch: 21 codebook_update_time=1.71597
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch21.pth ...
Done in 7.887s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 1.569474353790283
 quant_reg      : 11.749472297668458
 quant_err      : 11.749472297668458
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.348
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.38120941135399
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.023
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.375656243683906
 mnt_best       : 42.76755190491828
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.70021 (QuantReg: 11.77239) QuantErr: 11.77239 batch_time=30.50393 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.33038 (QuantReg: 11.93917) QuantErr: 11.93917 batch_time=0.55482 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.59041 (QuantReg: 11.80332) QuantErr: 11.80332 batch_time=0.53059 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.75007 (QuantReg: 11.74744) QuantErr: 11.74744 batch_time=0.53104 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 2.14571 (QuantReg: 11.88780) QuantErr: 11.88780 batch_time=0.51191 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.67358 (QuantReg: 11.45661) QuantErr: 11.45661 batch_time=0.52469 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.93989 (QuantReg: 12.01172) QuantErr: 12.01172 batch_time=0.49055 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.43355 (QuantReg: 11.73351) QuantErr: 11.73351 batch_time=0.53169 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.57353 (QuantReg: 11.92676) QuantErr: 11.92676 batch_time=0.50324 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.61406 (QuantReg: 11.43847) QuantErr: 11.43847 batch_time=0.50143 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.52163 (QuantReg: 12.04203) QuantErr: 12.04203 batch_time=0.51103 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.50461 (QuantReg: 11.52498) QuantErr: 11.52498 batch_time=0.88392 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.32857 (QuantReg: 11.60760) QuantErr: 11.60760 batch_time=0.53713 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.69854 (QuantReg: 11.68905) QuantErr: 11.68905 batch_time=0.98874 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.35597 (QuantReg: 11.51256) QuantErr: 11.51256 batch_time=0.53407 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 2.01565 (QuantReg: 11.69016) QuantErr: 11.69016 batch_time=0.50949 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.32243 (QuantReg: 11.82756) QuantErr: 11.82756 batch_time=0.51496 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.24747 (QuantReg: 11.82579) QuantErr: 11.82579 batch_time=0.53637 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.37418 (QuantReg: 11.68924) QuantErr: 11.68924 batch_time=0.50379 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.38083 (QuantReg: 11.84015) QuantErr: 11.84015 batch_time=3.34398 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.96629 (QuantReg: 11.73151) QuantErr: 11.73151 batch_time=0.51357 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.23002 (QuantReg: 12.00198) QuantErr: 12.00198 batch_time=0.52248 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.53414 (QuantReg: 12.04494) QuantErr: 12.04494 batch_time=0.50238 
Train Epoch: 22 codebook_update_time=1.96093
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch22.pth ...
Done in 4.878s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch22.pth ...
Done in 30.257s
removing stale ckpt [epoch 21] [took 0.06s]
 epoch          : 22
 loss           : 1.5370761632919312
 quant_reg      : 11.769282722473145
 quant_err      : 11.769282722473145
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.596
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.9837061034755
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.844
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.00447337438846
 mnt_best       : 42.9837061034755
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.45050 (QuantReg: 11.84756) QuantErr: 11.84756 batch_time=29.52983 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.40931 (QuantReg: 11.69104) QuantErr: 11.69104 batch_time=1.19033 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.83106 (QuantReg: 11.86487) QuantErr: 11.86487 batch_time=0.51863 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.59774 (QuantReg: 11.58424) QuantErr: 11.58424 batch_time=0.49183 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.42973 (QuantReg: 11.55475) QuantErr: 11.55475 batch_time=0.52719 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.64653 (QuantReg: 11.55121) QuantErr: 11.55121 batch_time=0.53326 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.43860 (QuantReg: 11.63837) QuantErr: 11.63837 batch_time=2.75472 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.57566 (QuantReg: 11.45333) QuantErr: 11.45333 batch_time=0.49946 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.56949 (QuantReg: 11.81825) QuantErr: 11.81825 batch_time=0.49812 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.81356 (QuantReg: 11.51931) QuantErr: 11.51931 batch_time=0.50238 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.38933 (QuantReg: 11.52710) QuantErr: 11.52710 batch_time=0.51272 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.42474 (QuantReg: 11.49429) QuantErr: 11.49429 batch_time=0.49793 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.58215 (QuantReg: 11.99105) QuantErr: 11.99105 batch_time=0.55064 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.29094 (QuantReg: 11.80822) QuantErr: 11.80822 batch_time=2.58401 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.68744 (QuantReg: 11.66010) QuantErr: 11.66010 batch_time=0.50878 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.54601 (QuantReg: 11.59329) QuantErr: 11.59329 batch_time=0.52081 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.46499 (QuantReg: 11.88927) QuantErr: 11.88927 batch_time=0.50160 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.17902 (QuantReg: 11.72249) QuantErr: 11.72249 batch_time=0.49724 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.41697 (QuantReg: 11.76217) QuantErr: 11.76217 batch_time=0.50025 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.66151 (QuantReg: 11.79077) QuantErr: 11.79077 batch_time=0.49344 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.56044 (QuantReg: 11.80003) QuantErr: 11.80003 batch_time=0.50700 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.33552 (QuantReg: 11.96370) QuantErr: 11.96370 batch_time=0.49910 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.43417 (QuantReg: 11.65779) QuantErr: 11.65779 batch_time=0.54856 
Train Epoch: 23 codebook_update_time=2.00103
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch23.pth ...
Done in 4.672s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch23.pth ...
Done in 8.554s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 1.5050902948379516
 quant_reg      : 11.758795299530028
 quant_err      : 11.758795299530028
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.334
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.09460224570003
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.8345
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.1647114992259
 mnt_best       : 43.09460224570003
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.59296 (QuantReg: 11.83253) QuantErr: 11.83253 batch_time=30.95295 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.28423 (QuantReg: 11.49223) QuantErr: 11.49223 batch_time=0.49472 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.41432 (QuantReg: 11.35867) QuantErr: 11.35867 batch_time=0.55767 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.55022 (QuantReg: 11.70419) QuantErr: 11.70419 batch_time=0.49729 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.75677 (QuantReg: 11.50275) QuantErr: 11.50275 batch_time=0.50964 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.45169 (QuantReg: 11.81966) QuantErr: 11.81966 batch_time=0.50543 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.52889 (QuantReg: 11.42548) QuantErr: 11.42548 batch_time=0.51687 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.55306 (QuantReg: 11.75982) QuantErr: 11.75982 batch_time=0.49704 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.50572 (QuantReg: 11.88342) QuantErr: 11.88342 batch_time=0.50905 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.49685 (QuantReg: 11.67029) QuantErr: 11.67029 batch_time=0.54593 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.71785 (QuantReg: 11.81919) QuantErr: 11.81919 batch_time=0.51642 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.51636 (QuantReg: 11.81594) QuantErr: 11.81594 batch_time=0.51260 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.26509 (QuantReg: 11.67309) QuantErr: 11.67309 batch_time=2.98245 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.32922 (QuantReg: 11.54980) QuantErr: 11.54980 batch_time=0.50751 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.41077 (QuantReg: 11.89148) QuantErr: 11.89148 batch_time=0.51832 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.81022 (QuantReg: 11.70057) QuantErr: 11.70057 batch_time=0.52698 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.17629 (QuantReg: 12.07920) QuantErr: 12.07920 batch_time=0.49607 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.64162 (QuantReg: 11.99820) QuantErr: 11.99820 batch_time=0.50228 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.48638 (QuantReg: 11.66348) QuantErr: 11.66348 batch_time=0.50911 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.17466 (QuantReg: 11.67375) QuantErr: 11.67375 batch_time=0.51197 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.44037 (QuantReg: 12.06578) QuantErr: 12.06578 batch_time=0.52425 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.23538 (QuantReg: 11.70220) QuantErr: 11.70220 batch_time=0.63220 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.30569 (QuantReg: 11.62627) QuantErr: 11.62627 batch_time=0.53314 
Train Epoch: 24 codebook_update_time=1.92073
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch24.pth ...
Done in 5.406s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch24.pth ...
Done in 10.780s
removing stale ckpt [epoch 23] [took 0.02s]
 epoch          : 24
 loss           : 1.4776658596992494
 quant_reg      : 11.773831214904785
 quant_err      : 11.773831214904785
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.944
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.47342014744723
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.747
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.446416958606804
 mnt_best       : 43.47342014744723
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.44811 (QuantReg: 11.67558) QuantErr: 11.67558 batch_time=33.81901 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.28454 (QuantReg: 11.65070) QuantErr: 11.65070 batch_time=4.07252 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.48957 (QuantReg: 12.04520) QuantErr: 12.04520 batch_time=1.45048 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.40330 (QuantReg: 11.70587) QuantErr: 11.70587 batch_time=0.51063 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.29881 (QuantReg: 11.93847) QuantErr: 11.93847 batch_time=0.49619 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.15937 (QuantReg: 11.94006) QuantErr: 11.94006 batch_time=0.54805 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.75914 (QuantReg: 11.88563) QuantErr: 11.88563 batch_time=0.51561 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.69153 (QuantReg: 11.75380) QuantErr: 11.75380 batch_time=0.50139 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.59813 (QuantReg: 11.62433) QuantErr: 11.62433 batch_time=0.49608 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.46210 (QuantReg: 11.68677) QuantErr: 11.68677 batch_time=0.50076 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.71287 (QuantReg: 11.81157) QuantErr: 11.81157 batch_time=0.57183 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.84944 (QuantReg: 11.90208) QuantErr: 11.90208 batch_time=0.50684 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.15601 (QuantReg: 11.50355) QuantErr: 11.50355 batch_time=0.50808 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.26489 (QuantReg: 11.82313) QuantErr: 11.82313 batch_time=0.52636 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.31325 (QuantReg: 11.73010) QuantErr: 11.73010 batch_time=0.49293 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.82065 (QuantReg: 11.61024) QuantErr: 11.61024 batch_time=0.50856 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.34284 (QuantReg: 11.90481) QuantErr: 11.90481 batch_time=0.49476 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.30073 (QuantReg: 11.75232) QuantErr: 11.75232 batch_time=0.52676 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 1.16661 (QuantReg: 11.89485) QuantErr: 11.89485 batch_time=0.51778 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.40674 (QuantReg: 11.70180) QuantErr: 11.70180 batch_time=0.53016 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.71684 (QuantReg: 11.95768) QuantErr: 11.95768 batch_time=0.54179 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.17864 (QuantReg: 11.94118) QuantErr: 11.94118 batch_time=0.49435 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.42198 (QuantReg: 11.87325) QuantErr: 11.87325 batch_time=0.51111 
Train Epoch: 25 codebook_update_time=1.61618
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch25.pth ...
Done in 4.466s
removing stale ckpt [epoch 24] [took 0.03s]
 epoch          : 25
 loss           : 1.459395498752594
 quant_reg      : 11.779059452056885
 quant_err      : 11.779059452056885
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.76
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.589780219447775
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.2905
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.07979494098194
 mnt_best       : 43.47342014744723
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.51679 (QuantReg: 11.55254) QuantErr: 11.55254 batch_time=36.42336 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.42118 (QuantReg: 11.69459) QuantErr: 11.69459 batch_time=0.51596 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.59506 (QuantReg: 11.84297) QuantErr: 11.84297 batch_time=0.53306 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.58933 (QuantReg: 11.79577) QuantErr: 11.79577 batch_time=0.51775 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.54871 (QuantReg: 11.75311) QuantErr: 11.75311 batch_time=0.51006 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.26000 (QuantReg: 11.99735) QuantErr: 11.99735 batch_time=0.50747 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.06415 (QuantReg: 11.82659) QuantErr: 11.82659 batch_time=0.52004 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.49899 (QuantReg: 11.97225) QuantErr: 11.97225 batch_time=0.49290 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.49098 (QuantReg: 11.55980) QuantErr: 11.55980 batch_time=0.51005 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.18433 (QuantReg: 11.82247) QuantErr: 11.82247 batch_time=0.49728 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.30467 (QuantReg: 11.96654) QuantErr: 11.96654 batch_time=0.51864 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.47454 (QuantReg: 11.81372) QuantErr: 11.81372 batch_time=0.49626 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.55995 (QuantReg: 11.85202) QuantErr: 11.85202 batch_time=0.49850 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.55955 (QuantReg: 11.24475) QuantErr: 11.24475 batch_time=0.51687 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.62066 (QuantReg: 11.99994) QuantErr: 11.99994 batch_time=0.49493 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.48512 (QuantReg: 12.01822) QuantErr: 12.01822 batch_time=0.50964 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.45761 (QuantReg: 11.90281) QuantErr: 11.90281 batch_time=0.54616 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.57460 (QuantReg: 11.91789) QuantErr: 11.91789 batch_time=0.50030 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.37899 (QuantReg: 11.40714) QuantErr: 11.40714 batch_time=0.50497 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.52793 (QuantReg: 11.93697) QuantErr: 11.93697 batch_time=0.65995 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.44287 (QuantReg: 11.89501) QuantErr: 11.89501 batch_time=0.57965 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.53035 (QuantReg: 12.08364) QuantErr: 12.08364 batch_time=0.49962 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.37463 (QuantReg: 12.03975) QuantErr: 12.03975 batch_time=0.50789 
Train Epoch: 26 codebook_update_time=1.66320
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch26.pth ...
Done in 6.584s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch26.pth ...
Done in 11.415s
removing stale ckpt [epoch 25] [took 0.19s]
 epoch          : 26
 loss           : 1.4689981427192689
 quant_reg      : 11.783183654785157
 quant_err      : 11.783183654785157
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.933
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.061449952341974
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.639
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.33718222122733
 mnt_best       : 44.061449952341974
 not_improved_count: 0
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.47360 (QuantReg: 11.85358) QuantErr: 11.85358 batch_time=32.10241 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.45171 (QuantReg: 11.57842) QuantErr: 11.57842 batch_time=0.49294 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.50397 (QuantReg: 11.64670) QuantErr: 11.64670 batch_time=0.52340 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.42429 (QuantReg: 11.85086) QuantErr: 11.85086 batch_time=0.53146 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.38590 (QuantReg: 11.65980) QuantErr: 11.65980 batch_time=0.49951 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.40208 (QuantReg: 11.73717) QuantErr: 11.73717 batch_time=0.50005 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.32740 (QuantReg: 11.98841) QuantErr: 11.98841 batch_time=0.51521 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.45290 (QuantReg: 11.79416) QuantErr: 11.79416 batch_time=0.50479 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.61745 (QuantReg: 11.76682) QuantErr: 11.76682 batch_time=0.57272 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.39615 (QuantReg: 12.09668) QuantErr: 12.09668 batch_time=0.72726 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.43116 (QuantReg: 11.92845) QuantErr: 11.92845 batch_time=0.49852 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.38257 (QuantReg: 11.45407) QuantErr: 11.45407 batch_time=0.51631 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.29441 (QuantReg: 11.84173) QuantErr: 11.84173 batch_time=1.31589 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.50299 (QuantReg: 11.87084) QuantErr: 11.87084 batch_time=0.49857 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.44068 (QuantReg: 11.91276) QuantErr: 11.91276 batch_time=0.49510 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.65363 (QuantReg: 11.70002) QuantErr: 11.70002 batch_time=0.50600 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.47467 (QuantReg: 11.79095) QuantErr: 11.79095 batch_time=0.73085 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.22447 (QuantReg: 11.94255) QuantErr: 11.94255 batch_time=0.54692 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.49441 (QuantReg: 11.56712) QuantErr: 11.56712 batch_time=2.70644 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.65881 (QuantReg: 12.04356) QuantErr: 12.04356 batch_time=0.51894 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.32663 (QuantReg: 11.73207) QuantErr: 11.73207 batch_time=0.50851 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.70286 (QuantReg: 11.51561) QuantErr: 11.51561 batch_time=0.50484 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.27779 (QuantReg: 11.85712) QuantErr: 11.85712 batch_time=0.55146 
Train Epoch: 27 codebook_update_time=1.65337
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch27.pth ...
Done in 5.158s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 1.4461540765762328
 quant_reg      : 11.795475334167481
 quant_err      : 11.795475334167481
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.407
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.58110802319789
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.3155
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.80845662836847
 mnt_best       : 44.061449952341974
 not_improved_count: 1
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.27889 (QuantReg: 11.52481) QuantErr: 11.52481 batch_time=31.83872 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.49942 (QuantReg: 12.14376) QuantErr: 12.14376 batch_time=0.51188 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.03667 (QuantReg: 11.68377) QuantErr: 11.68377 batch_time=2.19729 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.26472 (QuantReg: 11.80546) QuantErr: 11.80546 batch_time=0.50967 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.25316 (QuantReg: 11.96477) QuantErr: 11.96477 batch_time=0.50584 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.32143 (QuantReg: 11.86775) QuantErr: 11.86775 batch_time=0.50060 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.57106 (QuantReg: 11.73566) QuantErr: 11.73566 batch_time=1.78457 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.41243 (QuantReg: 11.82386) QuantErr: 11.82386 batch_time=0.51604 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.98761 (QuantReg: 11.68781) QuantErr: 11.68781 batch_time=0.49800 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.64775 (QuantReg: 12.04596) QuantErr: 12.04596 batch_time=0.53014 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.48936 (QuantReg: 11.93327) QuantErr: 11.93327 batch_time=0.49597 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.14314 (QuantReg: 11.69020) QuantErr: 11.69020 batch_time=0.60510 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.61188 (QuantReg: 11.90071) QuantErr: 11.90071 batch_time=0.49998 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.36798 (QuantReg: 11.70214) QuantErr: 11.70214 batch_time=1.67904 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.43229 (QuantReg: 11.89034) QuantErr: 11.89034 batch_time=0.49251 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.45000 (QuantReg: 12.07965) QuantErr: 12.07965 batch_time=0.50023 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.47482 (QuantReg: 11.96911) QuantErr: 11.96911 batch_time=0.50602 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.26945 (QuantReg: 12.16839) QuantErr: 12.16839 batch_time=0.55584 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.43688 (QuantReg: 11.64492) QuantErr: 11.64492 batch_time=0.50680 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.13995 (QuantReg: 12.01161) QuantErr: 12.01161 batch_time=0.50774 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.25893 (QuantReg: 11.88704) QuantErr: 11.88704 batch_time=0.49240 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.47891 (QuantReg: 11.89219) QuantErr: 11.89219 batch_time=0.52036 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.54871 (QuantReg: 12.12937) QuantErr: 12.12937 batch_time=1.02290 
Train Epoch: 28 codebook_update_time=1.65339
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch28.pth ...
Done in 4.445s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 1.413786473274231
 quant_reg      : 11.815241458892823
 quant_err      : 11.815241458892823
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.758
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.32765737623314
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.37
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.80129673117337
 mnt_best       : 44.061449952341974
 not_improved_count: 2
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.92151 (QuantReg: 11.78118) QuantErr: 11.78118 batch_time=35.13222 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.62669 (QuantReg: 11.81615) QuantErr: 11.81615 batch_time=0.54442 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.45680 (QuantReg: 12.07285) QuantErr: 12.07285 batch_time=0.51490 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.46778 (QuantReg: 11.71403) QuantErr: 11.71403 batch_time=0.51068 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.65213 (QuantReg: 11.62669) QuantErr: 11.62669 batch_time=0.51304 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.23392 (QuantReg: 11.83909) QuantErr: 11.83909 batch_time=0.50315 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.29069 (QuantReg: 11.63856) QuantErr: 11.63856 batch_time=0.51230 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.35038 (QuantReg: 12.01531) QuantErr: 12.01531 batch_time=0.53330 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.47089 (QuantReg: 11.76208) QuantErr: 11.76208 batch_time=0.56509 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.49195 (QuantReg: 12.19397) QuantErr: 12.19397 batch_time=0.51144 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.92661 (QuantReg: 11.89217) QuantErr: 11.89217 batch_time=0.52841 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.45571 (QuantReg: 11.60620) QuantErr: 11.60620 batch_time=0.50512 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.66491 (QuantReg: 11.74939) QuantErr: 11.74939 batch_time=0.50236 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.34991 (QuantReg: 11.90802) QuantErr: 11.90802 batch_time=0.51298 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.21515 (QuantReg: 12.23189) QuantErr: 12.23189 batch_time=0.51866 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.42687 (QuantReg: 11.74642) QuantErr: 11.74642 batch_time=0.50609 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.39646 (QuantReg: 11.90840) QuantErr: 11.90840 batch_time=0.63776 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.51216 (QuantReg: 12.04391) QuantErr: 12.04391 batch_time=0.50026 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.52647 (QuantReg: 11.60699) QuantErr: 11.60699 batch_time=0.50080 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.35768 (QuantReg: 11.82596) QuantErr: 11.82596 batch_time=0.51200 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.40022 (QuantReg: 11.62938) QuantErr: 11.62938 batch_time=0.49443 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.97404 (QuantReg: 11.94881) QuantErr: 11.94881 batch_time=0.51045 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.51924 (QuantReg: 11.75483) QuantErr: 11.75483 batch_time=0.50713 
Train Epoch: 29 codebook_update_time=1.60837
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch29.pth ...
Done in 4.208s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 1.4000486397743226
 quant_reg      : 11.80837519454956
 quant_err      : 11.80837519454956
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.627
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.039817993672564
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.8005
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.653239992997435
 mnt_best       : 44.061449952341974
 not_improved_count: 3
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.31506 (QuantReg: 11.90824) QuantErr: 11.90824 batch_time=30.38469 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.35957 (QuantReg: 11.53467) QuantErr: 11.53467 batch_time=0.51661 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.27512 (QuantReg: 11.62639) QuantErr: 11.62639 batch_time=0.58658 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.31690 (QuantReg: 11.84945) QuantErr: 11.84945 batch_time=0.58698 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.33832 (QuantReg: 11.85389) QuantErr: 11.85389 batch_time=0.55787 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.35632 (QuantReg: 11.78442) QuantErr: 11.78442 batch_time=0.54285 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.67480 (QuantReg: 12.08499) QuantErr: 12.08499 batch_time=0.50017 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.35301 (QuantReg: 11.99845) QuantErr: 11.99845 batch_time=0.50057 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.42107 (QuantReg: 11.70487) QuantErr: 11.70487 batch_time=0.96283 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.48048 (QuantReg: 11.98983) QuantErr: 11.98983 batch_time=0.49831 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.30731 (QuantReg: 11.94615) QuantErr: 11.94615 batch_time=0.50369 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.20635 (QuantReg: 11.82358) QuantErr: 11.82358 batch_time=0.50640 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.18697 (QuantReg: 11.92752) QuantErr: 11.92752 batch_time=0.50318 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.54938 (QuantReg: 11.96280) QuantErr: 11.96280 batch_time=0.51355 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.62189 (QuantReg: 11.71713) QuantErr: 11.71713 batch_time=0.50353 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.23204 (QuantReg: 11.79900) QuantErr: 11.79900 batch_time=0.50962 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.55948 (QuantReg: 11.29831) QuantErr: 11.29831 batch_time=0.50482 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.52281 (QuantReg: 11.56068) QuantErr: 11.56068 batch_time=0.49420 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.24050 (QuantReg: 11.79798) QuantErr: 11.79798 batch_time=0.52898 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.71251 (QuantReg: 11.74258) QuantErr: 11.74258 batch_time=0.51595 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.38706 (QuantReg: 11.82884) QuantErr: 11.82884 batch_time=0.58169 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.36398 (QuantReg: 11.85636) QuantErr: 11.85636 batch_time=0.50972 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.31287 (QuantReg: 12.03453) QuantErr: 12.03453 batch_time=0.51343 
Train Epoch: 30 codebook_update_time=1.67715
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch30.pth ...
Done in 24.539s
removing stale ckpt [epoch 29] [took 0.02s]
 epoch          : 30
 loss           : 1.4083358402252197
 quant_reg      : 11.804943729400636
 quant_err      : 11.804943729400636
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.217
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.39994372351426
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.9335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.44178897097316
 mnt_best       : 44.061449952341974
 not_improved_count: 4
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.64890 (QuantReg: 11.79751) QuantErr: 11.79751 batch_time=33.86446 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.28862 (QuantReg: 11.65772) QuantErr: 11.65772 batch_time=0.51598 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.15482 (QuantReg: 11.47758) QuantErr: 11.47758 batch_time=0.53098 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.56437 (QuantReg: 11.71134) QuantErr: 11.71134 batch_time=0.51103 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.33295 (QuantReg: 11.96170) QuantErr: 11.96170 batch_time=0.53383 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.59460 (QuantReg: 11.78779) QuantErr: 11.78779 batch_time=0.49480 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.36722 (QuantReg: 11.92847) QuantErr: 11.92847 batch_time=0.50168 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.16234 (QuantReg: 11.88686) QuantErr: 11.88686 batch_time=0.55532 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.38405 (QuantReg: 11.64304) QuantErr: 11.64304 batch_time=0.52772 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.36629 (QuantReg: 12.03827) QuantErr: 12.03827 batch_time=0.51161 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.42388 (QuantReg: 12.10174) QuantErr: 12.10174 batch_time=0.50337 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.17563 (QuantReg: 11.84768) QuantErr: 11.84768 batch_time=0.53767 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.21576 (QuantReg: 11.82982) QuantErr: 11.82982 batch_time=0.50149 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.55628 (QuantReg: 11.54508) QuantErr: 11.54508 batch_time=0.52678 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.31574 (QuantReg: 11.89844) QuantErr: 11.89844 batch_time=0.54281 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.25488 (QuantReg: 11.82406) QuantErr: 11.82406 batch_time=0.50909 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.31366 (QuantReg: 11.94174) QuantErr: 11.94174 batch_time=0.51057 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.39963 (QuantReg: 11.76044) QuantErr: 11.76044 batch_time=0.50531 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.31593 (QuantReg: 11.78951) QuantErr: 11.78951 batch_time=0.50505 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.38793 (QuantReg: 11.68332) QuantErr: 11.68332 batch_time=0.50050 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.39959 (QuantReg: 11.71984) QuantErr: 11.71984 batch_time=0.55646 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.34780 (QuantReg: 11.97243) QuantErr: 11.97243 batch_time=0.51785 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.52633 (QuantReg: 11.50184) QuantErr: 11.50184 batch_time=0.50413 
Train Epoch: 31 codebook_update_time=1.85191
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch31.pth ...
Done in 4.505s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch31.pth ...
Done in 11.976s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 31
 loss           : 1.4028984467983245
 quant_reg      : 11.85371268081665
 quant_err      : 11.85371268081665
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.941
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.87446791888312
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.679
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.45750248399097
 mnt_best       : 44.87446791888312
 not_improved_count: 0
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.44843 (QuantReg: 11.66167) QuantErr: 11.66167 batch_time=29.13744 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.43741 (QuantReg: 11.80388) QuantErr: 11.80388 batch_time=0.56186 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.63720 (QuantReg: 12.01132) QuantErr: 12.01132 batch_time=0.50621 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.28706 (QuantReg: 11.50865) QuantErr: 11.50865 batch_time=0.58033 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 1.17153 (QuantReg: 11.92736) QuantErr: 11.92736 batch_time=0.50722 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.16620 (QuantReg: 11.89631) QuantErr: 11.89631 batch_time=0.84263 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.37449 (QuantReg: 11.81117) QuantErr: 11.81117 batch_time=0.50315 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.59690 (QuantReg: 11.96028) QuantErr: 11.96028 batch_time=0.56408 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.21548 (QuantReg: 11.79541) QuantErr: 11.79541 batch_time=0.50851 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.65892 (QuantReg: 11.60992) QuantErr: 11.60992 batch_time=0.52457 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.62987 (QuantReg: 11.60590) QuantErr: 11.60590 batch_time=0.50465 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.49495 (QuantReg: 11.68543) QuantErr: 11.68543 batch_time=0.50923 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.53279 (QuantReg: 11.86643) QuantErr: 11.86643 batch_time=0.51386 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.41037 (QuantReg: 11.79657) QuantErr: 11.79657 batch_time=0.63706 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.63083 (QuantReg: 11.73471) QuantErr: 11.73471 batch_time=0.49660 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.52544 (QuantReg: 11.74398) QuantErr: 11.74398 batch_time=0.50044 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.50252 (QuantReg: 11.61777) QuantErr: 11.61777 batch_time=0.50615 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.18427 (QuantReg: 11.91902) QuantErr: 11.91902 batch_time=0.51053 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.61678 (QuantReg: 11.80905) QuantErr: 11.80905 batch_time=0.55465 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.25257 (QuantReg: 11.78231) QuantErr: 11.78231 batch_time=0.50261 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.28749 (QuantReg: 11.86858) QuantErr: 11.86858 batch_time=0.52459 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.08206 (QuantReg: 12.00797) QuantErr: 12.00797 batch_time=0.53204 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.61869 (QuantReg: 11.83239) QuantErr: 11.83239 batch_time=0.51316 
Train Epoch: 32 codebook_update_time=1.70778
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch32.pth ...
Done in 4.370s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 1.3897073366641999
 quant_reg      : 11.82042601776123
 quant_err      : 11.82042601776123
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.559
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.11172707598186
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.719
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.251010223034406
 mnt_best       : 44.87446791888312
 not_improved_count: 1
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.40230 (QuantReg: 11.70640) QuantErr: 11.70640 batch_time=26.15361 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.54850 (QuantReg: 11.97292) QuantErr: 11.97292 batch_time=0.50786 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.54202 (QuantReg: 11.74479) QuantErr: 11.74479 batch_time=2.16208 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.44160 (QuantReg: 11.84167) QuantErr: 11.84167 batch_time=0.54737 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.69997 (QuantReg: 11.63881) QuantErr: 11.63881 batch_time=0.51592 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.47086 (QuantReg: 11.89037) QuantErr: 11.89037 batch_time=0.96856 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 1.13006 (QuantReg: 11.71953) QuantErr: 11.71953 batch_time=1.63490 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.34125 (QuantReg: 11.87601) QuantErr: 11.87601 batch_time=0.51898 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.39713 (QuantReg: 11.79290) QuantErr: 11.79290 batch_time=0.50523 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.33758 (QuantReg: 11.82852) QuantErr: 11.82852 batch_time=0.50279 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.49895 (QuantReg: 11.74444) QuantErr: 11.74444 batch_time=0.50315 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.31084 (QuantReg: 11.98259) QuantErr: 11.98259 batch_time=0.50479 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.47917 (QuantReg: 11.79169) QuantErr: 11.79169 batch_time=0.51036 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.28312 (QuantReg: 11.74556) QuantErr: 11.74556 batch_time=1.11968 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.36983 (QuantReg: 12.03877) QuantErr: 12.03877 batch_time=0.51833 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.17186 (QuantReg: 12.07103) QuantErr: 12.07103 batch_time=0.50681 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 1.12520 (QuantReg: 11.76777) QuantErr: 11.76777 batch_time=0.50931 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.88249 (QuantReg: 11.98237) QuantErr: 11.98237 batch_time=0.51948 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.47595 (QuantReg: 11.60628) QuantErr: 11.60628 batch_time=0.50155 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.30787 (QuantReg: 11.70703) QuantErr: 11.70703 batch_time=0.62683 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 1.25802 (QuantReg: 11.69093) QuantErr: 11.69093 batch_time=0.50122 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.33872 (QuantReg: 11.79055) QuantErr: 11.79055 batch_time=0.51130 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.42682 (QuantReg: 11.84097) QuantErr: 11.84097 batch_time=0.53077 
Train Epoch: 33 codebook_update_time=2.12514
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch33.pth ...
Done in 7.110s
removing stale ckpt [epoch 32] [took 0.06s]
 epoch          : 33
 loss           : 1.3809912948608398
 quant_reg      : 11.852169174194335
 quant_err      : 11.852169174194335
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.366
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.79692228327245
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.435
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.573400052898315
 mnt_best       : 44.87446791888312
 not_improved_count: 2
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.34636 (QuantReg: 11.87234) QuantErr: 11.87234 batch_time=27.36673 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.30071 (QuantReg: 11.77423) QuantErr: 11.77423 batch_time=0.52184 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.55673 (QuantReg: 11.97448) QuantErr: 11.97448 batch_time=0.50505 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.08952 (QuantReg: 11.86197) QuantErr: 11.86197 batch_time=0.50278 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.08841 (QuantReg: 11.46878) QuantErr: 11.46878 batch_time=0.51005 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.56001 (QuantReg: 12.03198) QuantErr: 12.03198 batch_time=0.50312 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.17393 (QuantReg: 11.83990) QuantErr: 11.83990 batch_time=0.53130 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.47914 (QuantReg: 11.81414) QuantErr: 11.81414 batch_time=0.53079 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.61066 (QuantReg: 11.94021) QuantErr: 11.94021 batch_time=0.54422 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.47327 (QuantReg: 12.06380) QuantErr: 12.06380 batch_time=0.50862 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.25631 (QuantReg: 11.76174) QuantErr: 11.76174 batch_time=0.50073 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.24679 (QuantReg: 11.79213) QuantErr: 11.79213 batch_time=0.51867 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.37121 (QuantReg: 12.09786) QuantErr: 12.09786 batch_time=4.60818 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.39265 (QuantReg: 11.76054) QuantErr: 11.76054 batch_time=0.50732 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.50271 (QuantReg: 11.81625) QuantErr: 11.81625 batch_time=0.53455 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.24686 (QuantReg: 11.61058) QuantErr: 11.61058 batch_time=0.50656 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.56175 (QuantReg: 11.97511) QuantErr: 11.97511 batch_time=0.53558 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.39980 (QuantReg: 12.02210) QuantErr: 12.02210 batch_time=0.50552 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.50837 (QuantReg: 11.67080) QuantErr: 11.67080 batch_time=0.50195 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.28584 (QuantReg: 11.72655) QuantErr: 11.72655 batch_time=0.51643 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.27729 (QuantReg: 11.65995) QuantErr: 11.65995 batch_time=0.53354 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.22079 (QuantReg: 11.73527) QuantErr: 11.73527 batch_time=0.50479 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.47371 (QuantReg: 11.92076) QuantErr: 11.92076 batch_time=0.52063 
Train Epoch: 34 codebook_update_time=1.91412
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch34.pth ...
Done in 5.025s
removing stale ckpt [epoch 33] [took 0.04s]
 epoch          : 34
 loss           : 1.3604811289310454
 quant_reg      : 11.841746742248535
 quant_err      : 11.841746742248535
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.106
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.730780347036394
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.687
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.38081855124734
 mnt_best       : 44.87446791888312
 not_improved_count: 3
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.18049 (QuantReg: 11.85885) QuantErr: 11.85885 batch_time=41.48186 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.55664 (QuantReg: 12.01608) QuantErr: 12.01608 batch_time=0.50119 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.49021 (QuantReg: 11.94203) QuantErr: 11.94203 batch_time=0.51092 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.46928 (QuantReg: 12.03232) QuantErr: 12.03232 batch_time=0.54233 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.40230 (QuantReg: 12.07526) QuantErr: 12.07526 batch_time=0.49850 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.24616 (QuantReg: 11.71584) QuantErr: 11.71584 batch_time=0.49895 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.51571 (QuantReg: 11.82404) QuantErr: 11.82404 batch_time=2.51603 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.43939 (QuantReg: 11.93333) QuantErr: 11.93333 batch_time=0.51173 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.37811 (QuantReg: 11.68020) QuantErr: 11.68020 batch_time=0.51871 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.63817 (QuantReg: 11.96803) QuantErr: 11.96803 batch_time=0.49532 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.18015 (QuantReg: 11.70491) QuantErr: 11.70491 batch_time=0.55190 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.40209 (QuantReg: 11.85487) QuantErr: 11.85487 batch_time=0.50273 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.41072 (QuantReg: 11.91652) QuantErr: 11.91652 batch_time=0.49336 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.26602 (QuantReg: 11.89507) QuantErr: 11.89507 batch_time=0.50934 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.60022 (QuantReg: 11.88691) QuantErr: 11.88691 batch_time=0.49836 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 1.17577 (QuantReg: 11.89803) QuantErr: 11.89803 batch_time=0.50023 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.22804 (QuantReg: 11.77964) QuantErr: 11.77964 batch_time=0.50589 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.51299 (QuantReg: 11.42469) QuantErr: 11.42469 batch_time=0.53797 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.54897 (QuantReg: 11.78923) QuantErr: 11.78923 batch_time=0.49991 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.42415 (QuantReg: 12.06005) QuantErr: 12.06005 batch_time=0.50132 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.07623 (QuantReg: 11.93766) QuantErr: 11.93766 batch_time=0.51041 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.29124 (QuantReg: 11.98915) QuantErr: 11.98915 batch_time=0.84722 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.31277 (QuantReg: 11.89883) QuantErr: 11.89883 batch_time=0.50678 
Train Epoch: 35 codebook_update_time=1.69228
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch35.pth ...
Done in 3.887s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 1.3446813824176789
 quant_reg      : 11.851633041381836
 quant_err      : 11.851633041381836
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.154
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.99912498259884
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.1855
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.05049653199029
 mnt_best       : 44.87446791888312
 not_improved_count: 4
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.46453 (QuantReg: 11.83244) QuantErr: 11.83244 batch_time=32.51215 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.47635 (QuantReg: 11.90545) QuantErr: 11.90545 batch_time=0.49678 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 1.10922 (QuantReg: 12.00715) QuantErr: 12.00715 batch_time=0.51187 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.56503 (QuantReg: 11.74591) QuantErr: 11.74591 batch_time=0.52171 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.41391 (QuantReg: 11.57342) QuantErr: 11.57342 batch_time=0.51818 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 1.06307 (QuantReg: 11.65108) QuantErr: 11.65108 batch_time=0.49636 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.44211 (QuantReg: 11.44913) QuantErr: 11.44913 batch_time=0.49766 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.21364 (QuantReg: 11.58722) QuantErr: 11.58722 batch_time=0.53105 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.50211 (QuantReg: 11.87158) QuantErr: 11.87158 batch_time=1.24400 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.25122 (QuantReg: 11.64860) QuantErr: 11.64860 batch_time=0.50447 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.45440 (QuantReg: 11.80173) QuantErr: 11.80173 batch_time=0.50902 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.55845 (QuantReg: 11.91949) QuantErr: 11.91949 batch_time=0.51485 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.17626 (QuantReg: 11.84158) QuantErr: 11.84158 batch_time=0.51098 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.36428 (QuantReg: 11.85930) QuantErr: 11.85930 batch_time=0.73918 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.61127 (QuantReg: 11.93856) QuantErr: 11.93856 batch_time=0.53208 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 1.18430 (QuantReg: 11.86704) QuantErr: 11.86704 batch_time=0.72393 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.42037 (QuantReg: 11.99051) QuantErr: 11.99051 batch_time=0.49757 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.43639 (QuantReg: 11.40584) QuantErr: 11.40584 batch_time=0.49887 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.22782 (QuantReg: 11.90105) QuantErr: 11.90105 batch_time=0.50779 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.31103 (QuantReg: 11.98377) QuantErr: 11.98377 batch_time=0.52286 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 1.24063 (QuantReg: 12.03797) QuantErr: 12.03797 batch_time=0.60510 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.16353 (QuantReg: 11.79095) QuantErr: 11.79095 batch_time=0.50886 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 1.02035 (QuantReg: 11.79481) QuantErr: 11.79481 batch_time=0.60873 
Train Epoch: 36 codebook_update_time=1.74680
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch36.pth ...
Done in 3.958s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 1.3500880045890808
 quant_reg      : 11.867761459350586
 quant_err      : 11.867761459350586
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.288
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.09612318797771
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.246
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.83214374286218
 mnt_best       : 44.87446791888312
 not_improved_count: 5
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.51631 (QuantReg: 11.75576) QuantErr: 11.75576 batch_time=35.34960 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.22041 (QuantReg: 11.91450) QuantErr: 11.91450 batch_time=0.51579 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 1.17511 (QuantReg: 11.78901) QuantErr: 11.78901 batch_time=0.52059 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.34127 (QuantReg: 11.80134) QuantErr: 11.80134 batch_time=0.54722 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.15732 (QuantReg: 12.10923) QuantErr: 12.10923 batch_time=0.51373 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.19169 (QuantReg: 11.69579) QuantErr: 11.69579 batch_time=0.52341 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.33465 (QuantReg: 11.50402) QuantErr: 11.50402 batch_time=0.50451 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.47220 (QuantReg: 12.16226) QuantErr: 12.16226 batch_time=0.52578 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.33964 (QuantReg: 11.92286) QuantErr: 11.92286 batch_time=0.51560 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.09683 (QuantReg: 12.04099) QuantErr: 12.04099 batch_time=0.50466 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.33926 (QuantReg: 11.86016) QuantErr: 11.86016 batch_time=0.51795 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.05976 (QuantReg: 11.82420) QuantErr: 11.82420 batch_time=0.53017 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.24853 (QuantReg: 11.81266) QuantErr: 11.81266 batch_time=0.52225 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.41602 (QuantReg: 11.96059) QuantErr: 11.96059 batch_time=0.52853 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 1.05258 (QuantReg: 11.98736) QuantErr: 11.98736 batch_time=0.51859 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 1.20870 (QuantReg: 11.82510) QuantErr: 11.82510 batch_time=0.51094 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.17752 (QuantReg: 11.94924) QuantErr: 11.94924 batch_time=0.53548 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.90711 (QuantReg: 11.97525) QuantErr: 11.97525 batch_time=0.49725 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.33496 (QuantReg: 11.61782) QuantErr: 11.61782 batch_time=0.50378 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.30370 (QuantReg: 12.20741) QuantErr: 12.20741 batch_time=0.51738 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.43353 (QuantReg: 11.71694) QuantErr: 11.71694 batch_time=0.51223 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.49862 (QuantReg: 11.89294) QuantErr: 11.89294 batch_time=0.50107 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.40222 (QuantReg: 12.17461) QuantErr: 12.17461 batch_time=0.53071 
Train Epoch: 37 codebook_update_time=1.77284
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch37.pth ...
Done in 3.885s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 1.3283567080497742
 quant_reg      : 11.888734119415282
 quant_err      : 11.888734119415282
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.61584092798334
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.283
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.565269607589244
 mnt_best       : 44.87446791888312
 not_improved_count: 6
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 1.03841 (QuantReg: 12.26561) QuantErr: 12.26561 batch_time=28.59937 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 1.06238 (QuantReg: 12.03393) QuantErr: 12.03393 batch_time=0.60318 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 1.18927 (QuantReg: 11.65752) QuantErr: 11.65752 batch_time=0.49781 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.14160 (QuantReg: 11.69188) QuantErr: 11.69188 batch_time=0.50806 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.44840 (QuantReg: 11.94709) QuantErr: 11.94709 batch_time=0.51598 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 1.21281 (QuantReg: 12.12657) QuantErr: 12.12657 batch_time=0.52324 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.13263 (QuantReg: 11.92952) QuantErr: 11.92952 batch_time=5.72028 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.49784 (QuantReg: 11.85974) QuantErr: 11.85974 batch_time=0.52077 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.51333 (QuantReg: 12.01007) QuantErr: 12.01007 batch_time=0.50653 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.34251 (QuantReg: 12.19013) QuantErr: 12.19013 batch_time=0.52064 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.30798 (QuantReg: 12.14768) QuantErr: 12.14768 batch_time=0.52462 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.46059 (QuantReg: 11.91322) QuantErr: 11.91322 batch_time=0.50720 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.47257 (QuantReg: 11.89678) QuantErr: 11.89678 batch_time=0.50061 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.44059 (QuantReg: 12.12028) QuantErr: 12.12028 batch_time=0.50139 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.44497 (QuantReg: 11.70265) QuantErr: 11.70265 batch_time=0.53237 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 1.12183 (QuantReg: 12.20979) QuantErr: 12.20979 batch_time=0.49985 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.30441 (QuantReg: 11.82224) QuantErr: 11.82224 batch_time=0.51094 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.00952 (QuantReg: 11.95404) QuantErr: 11.95404 batch_time=0.51377 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.32408 (QuantReg: 12.17316) QuantErr: 12.17316 batch_time=0.52514 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.20994 (QuantReg: 11.91538) QuantErr: 11.91538 batch_time=1.80285 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.25975 (QuantReg: 11.99839) QuantErr: 11.99839 batch_time=0.50649 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.38490 (QuantReg: 11.53203) QuantErr: 11.53203 batch_time=0.53168 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.44301 (QuantReg: 11.79036) QuantErr: 11.79036 batch_time=0.50983 
Train Epoch: 38 codebook_update_time=1.64732
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch38.pth ...
Done in 4.777s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.3189821093082428
 quant_reg      : 11.868667541503907
 quant_err      : 11.868667541503907
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.332
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.93432212298227
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.3115
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.95269696014338
 mnt_best       : 44.87446791888312
 not_improved_count: 7
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 1.09517 (QuantReg: 11.81352) QuantErr: 11.81352 batch_time=31.23974 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.26117 (QuantReg: 12.32183) QuantErr: 12.32183 batch_time=0.57223 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.72580 (QuantReg: 11.87189) QuantErr: 11.87189 batch_time=0.49706 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.31203 (QuantReg: 11.88215) QuantErr: 11.88215 batch_time=0.52246 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.71058 (QuantReg: 11.87273) QuantErr: 11.87273 batch_time=0.51388 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.26177 (QuantReg: 11.75597) QuantErr: 11.75597 batch_time=0.48970 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.55222 (QuantReg: 11.67798) QuantErr: 11.67798 batch_time=1.94313 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.46715 (QuantReg: 11.72491) QuantErr: 11.72491 batch_time=0.51698 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.42086 (QuantReg: 12.14988) QuantErr: 12.14988 batch_time=0.51000 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.44624 (QuantReg: 11.82668) QuantErr: 11.82668 batch_time=0.49489 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.54583 (QuantReg: 12.20656) QuantErr: 12.20656 batch_time=0.51485 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.43656 (QuantReg: 11.97204) QuantErr: 11.97204 batch_time=0.50226 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.76604 (QuantReg: 11.60498) QuantErr: 11.60498 batch_time=0.50597 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.50798 (QuantReg: 11.95071) QuantErr: 11.95071 batch_time=0.58161 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.45663 (QuantReg: 12.07401) QuantErr: 12.07401 batch_time=0.54510 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.51713 (QuantReg: 11.98671) QuantErr: 11.98671 batch_time=0.50423 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.51832 (QuantReg: 11.91324) QuantErr: 11.91324 batch_time=0.54035 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.27094 (QuantReg: 11.99000) QuantErr: 11.99000 batch_time=0.51065 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 1.21577 (QuantReg: 11.95024) QuantErr: 11.95024 batch_time=0.51338 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.63637 (QuantReg: 11.71631) QuantErr: 11.71631 batch_time=0.54141 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.48070 (QuantReg: 11.75910) QuantErr: 11.75910 batch_time=0.53555 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.48462 (QuantReg: 11.83085) QuantErr: 11.83085 batch_time=0.50232 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 1.38508 (QuantReg: 11.99165) QuantErr: 11.99165 batch_time=0.50362 
Train Epoch: 39 codebook_update_time=1.63079
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch39.pth ...
Done in 3.903s
removing stale ckpt [epoch 38] [took 0.02s]
 epoch          : 39
 loss           : 1.3570754189491272
 quant_reg      : 11.911822692871095
 quant_err      : 11.911822692871095
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.589
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.84512145022806
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.467
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.16809819826723
 mnt_best       : 44.87446791888312
 not_improved_count: 8
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.74380 (QuantReg: 11.66241) QuantErr: 11.66241 batch_time=31.27781 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.13676 (QuantReg: 11.75547) QuantErr: 11.75547 batch_time=0.63478 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.27283 (QuantReg: 11.86803) QuantErr: 11.86803 batch_time=0.51367 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.20369 (QuantReg: 12.06758) QuantErr: 12.06758 batch_time=0.51341 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.43671 (QuantReg: 11.58116) QuantErr: 11.58116 batch_time=0.52636 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.47921 (QuantReg: 11.81279) QuantErr: 11.81279 batch_time=0.51580 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.38744 (QuantReg: 11.73649) QuantErr: 11.73649 batch_time=1.10153 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.49415 (QuantReg: 11.64516) QuantErr: 11.64516 batch_time=0.50523 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.46787 (QuantReg: 12.05618) QuantErr: 12.05618 batch_time=0.50676 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 1.14477 (QuantReg: 12.14719) QuantErr: 12.14719 batch_time=0.50596 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.64122 (QuantReg: 11.73105) QuantErr: 11.73105 batch_time=0.51193 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.32810 (QuantReg: 11.87003) QuantErr: 11.87003 batch_time=0.51143 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.51629 (QuantReg: 11.72598) QuantErr: 11.72598 batch_time=0.49765 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.48408 (QuantReg: 11.61950) QuantErr: 11.61950 batch_time=0.50352 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.01871 (QuantReg: 11.98676) QuantErr: 11.98676 batch_time=0.50113 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.23079 (QuantReg: 12.05642) QuantErr: 12.05642 batch_time=0.51999 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.61559 (QuantReg: 11.51298) QuantErr: 11.51298 batch_time=0.50650 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.41009 (QuantReg: 11.90676) QuantErr: 11.90676 batch_time=0.49198 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.31405 (QuantReg: 11.89222) QuantErr: 11.89222 batch_time=0.62102 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.47957 (QuantReg: 11.79591) QuantErr: 11.79591 batch_time=2.17740 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.56098 (QuantReg: 11.89561) QuantErr: 11.89561 batch_time=0.50663 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 1.35598 (QuantReg: 12.17434) QuantErr: 12.17434 batch_time=0.54202 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 1.06158 (QuantReg: 11.99084) QuantErr: 11.99084 batch_time=0.56560 
Train Epoch: 40 codebook_update_time=1.71433
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch40.pth ...
Done in 5.078s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 1.3458890914916992
 quant_reg      : 11.896391639709472
 quant_err      : 11.896391639709472
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.541
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.20062105417835
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.8205
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.27511461565837
 mnt_best       : 44.87446791888312
 not_improved_count: 9
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.27675 (QuantReg: 11.99693) QuantErr: 11.99693 batch_time=36.94255 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.43872 (QuantReg: 12.02856) QuantErr: 12.02856 batch_time=0.49942 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.43774 (QuantReg: 11.57493) QuantErr: 11.57493 batch_time=0.51390 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.46809 (QuantReg: 11.77937) QuantErr: 11.77937 batch_time=0.55187 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.45844 (QuantReg: 12.01545) QuantErr: 12.01545 batch_time=0.51119 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 1.06655 (QuantReg: 11.99830) QuantErr: 11.99830 batch_time=0.49724 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 1.16146 (QuantReg: 11.95451) QuantErr: 11.95451 batch_time=0.52192 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.17785 (QuantReg: 11.61470) QuantErr: 11.61470 batch_time=0.49593 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.41403 (QuantReg: 12.06632) QuantErr: 12.06632 batch_time=0.50965 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.38964 (QuantReg: 12.00311) QuantErr: 12.00311 batch_time=0.49875 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.20943 (QuantReg: 12.07504) QuantErr: 12.07504 batch_time=0.50201 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.31994 (QuantReg: 11.79059) QuantErr: 11.79059 batch_time=0.49583 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.47334 (QuantReg: 11.88183) QuantErr: 11.88183 batch_time=0.49783 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.38936 (QuantReg: 11.97172) QuantErr: 11.97172 batch_time=0.50358 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.41367 (QuantReg: 12.00498) QuantErr: 12.00498 batch_time=0.49710 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.34543 (QuantReg: 11.98602) QuantErr: 11.98602 batch_time=0.50981 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.44409 (QuantReg: 12.00901) QuantErr: 12.00901 batch_time=0.50387 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 1.26776 (QuantReg: 11.99010) QuantErr: 11.99010 batch_time=0.58233 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.68191 (QuantReg: 11.83373) QuantErr: 11.83373 batch_time=0.49802 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.41283 (QuantReg: 11.75627) QuantErr: 11.75627 batch_time=1.15197 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.29852 (QuantReg: 12.16029) QuantErr: 12.16029 batch_time=0.50812 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.52468 (QuantReg: 11.89243) QuantErr: 11.89243 batch_time=0.53540 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.42976 (QuantReg: 11.72509) QuantErr: 11.72509 batch_time=0.51572 
Train Epoch: 41 codebook_update_time=1.63378
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch41.pth ...
Done in 4.629s
removing stale ckpt [epoch 40] [took 0.01s]
 epoch          : 41
 loss           : 1.3465768866539
 quant_reg      : 11.894277702331543
 quant_err      : 11.894277702331543
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.685
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.85217609825267
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.4875
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.41563242845254
 mnt_best       : 44.87446791888312
 not_improved_count: 10
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.20188 (QuantReg: 11.99159) QuantErr: 11.99159 batch_time=34.33040 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.20970 (QuantReg: 12.29627) QuantErr: 12.29627 batch_time=0.54449 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.51413 (QuantReg: 11.88050) QuantErr: 11.88050 batch_time=0.50708 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.48991 (QuantReg: 11.74016) QuantErr: 11.74016 batch_time=0.50241 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.55401 (QuantReg: 11.78204) QuantErr: 11.78204 batch_time=0.51022 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.21415 (QuantReg: 12.00156) QuantErr: 12.00156 batch_time=0.56603 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.30303 (QuantReg: 11.80470) QuantErr: 11.80470 batch_time=0.57293 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.33879 (QuantReg: 12.11247) QuantErr: 12.11247 batch_time=0.54811 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 1.15339 (QuantReg: 11.90012) QuantErr: 11.90012 batch_time=0.97663 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.27655 (QuantReg: 11.95217) QuantErr: 11.95217 batch_time=0.76440 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.27380 (QuantReg: 11.71621) QuantErr: 11.71621 batch_time=0.52392 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.46025 (QuantReg: 11.63757) QuantErr: 11.63757 batch_time=0.52234 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.19117 (QuantReg: 11.86880) QuantErr: 11.86880 batch_time=0.49251 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 1.13957 (QuantReg: 12.06546) QuantErr: 12.06546 batch_time=0.55635 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.37460 (QuantReg: 11.90947) QuantErr: 11.90947 batch_time=0.50582 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.46167 (QuantReg: 12.07319) QuantErr: 12.07319 batch_time=0.51187 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 1.33760 (QuantReg: 11.94389) QuantErr: 11.94389 batch_time=0.50760 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 1.12875 (QuantReg: 12.00796) QuantErr: 12.00796 batch_time=0.51669 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 1.14774 (QuantReg: 12.09581) QuantErr: 12.09581 batch_time=0.49524 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.27824 (QuantReg: 11.73805) QuantErr: 11.73805 batch_time=0.50576 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.18404 (QuantReg: 11.82449) QuantErr: 11.82449 batch_time=0.52489 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 1.28493 (QuantReg: 11.75001) QuantErr: 11.75001 batch_time=0.50346 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.47757 (QuantReg: 12.11808) QuantErr: 12.11808 batch_time=0.52268 
Train Epoch: 42 codebook_update_time=1.61835
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch42.pth ...
Done in 4.258s
removing stale ckpt [epoch 41] [took 0.02s]
 epoch          : 42
 loss           : 1.3274712281227112
 quant_reg      : 11.90352426147461
 quant_err      : 11.90352426147461
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.342
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.18387924494244
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.6575
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.34976087285838
 mnt_best       : 44.87446791888312
 not_improved_count: 11
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 1.23100 (QuantReg: 12.17823) QuantErr: 12.17823 batch_time=26.55294 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.07945 (QuantReg: 11.88054) QuantErr: 11.88054 batch_time=0.50286 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.27735 (QuantReg: 11.98931) QuantErr: 11.98931 batch_time=0.51414 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.41022 (QuantReg: 12.03546) QuantErr: 12.03546 batch_time=0.49743 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.38192 (QuantReg: 11.94041) QuantErr: 11.94041 batch_time=0.50746 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.21859 (QuantReg: 12.10113) QuantErr: 12.10113 batch_time=0.49400 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.53038 (QuantReg: 11.93559) QuantErr: 11.93559 batch_time=0.53350 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.23553 (QuantReg: 12.00677) QuantErr: 12.00677 batch_time=0.49890 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.19580 (QuantReg: 11.83211) QuantErr: 11.83211 batch_time=0.50817 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.32959 (QuantReg: 11.95621) QuantErr: 11.95621 batch_time=0.52115 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.32304 (QuantReg: 12.04913) QuantErr: 12.04913 batch_time=0.49322 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 1.25608 (QuantReg: 12.12513) QuantErr: 12.12513 batch_time=0.50275 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.07637 (QuantReg: 12.01696) QuantErr: 12.01696 batch_time=0.69108 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 1.24991 (QuantReg: 11.68016) QuantErr: 11.68016 batch_time=0.51384 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.36324 (QuantReg: 12.15700) QuantErr: 12.15700 batch_time=0.52753 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.17897 (QuantReg: 12.01777) QuantErr: 12.01777 batch_time=0.58330 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.08185 (QuantReg: 12.19137) QuantErr: 12.19137 batch_time=0.50399 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.23453 (QuantReg: 11.96444) QuantErr: 11.96444 batch_time=0.50516 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.60224 (QuantReg: 12.04752) QuantErr: 12.04752 batch_time=0.51579 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.59440 (QuantReg: 12.10566) QuantErr: 12.10566 batch_time=0.50082 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.28369 (QuantReg: 12.18653) QuantErr: 12.18653 batch_time=0.50897 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 1.23257 (QuantReg: 11.91391) QuantErr: 11.91391 batch_time=0.50557 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.39974 (QuantReg: 11.72089) QuantErr: 11.72089 batch_time=0.50207 
Train Epoch: 43 codebook_update_time=1.60865
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch43.pth ...
Done in 3.826s
removing stale ckpt [epoch 42] [took 0.10s]
 epoch          : 43
 loss           : 1.3237921917438507
 quant_reg      : 11.919699413299561
 quant_err      : 11.919699413299561
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.666
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.985229201778104
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.898
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.95552680254437
 mnt_best       : 44.87446791888312
 not_improved_count: 12
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 1.24309 (QuantReg: 11.94826) QuantErr: 11.94826 batch_time=29.13979 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.38551 (QuantReg: 12.13157) QuantErr: 12.13157 batch_time=0.50575 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.30058 (QuantReg: 11.87334) QuantErr: 11.87334 batch_time=0.51338 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.14677 (QuantReg: 11.85707) QuantErr: 11.85707 batch_time=0.84470 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.42801 (QuantReg: 11.83227) QuantErr: 11.83227 batch_time=0.50309 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.59096 (QuantReg: 11.70331) QuantErr: 11.70331 batch_time=0.51458 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.37472 (QuantReg: 11.90098) QuantErr: 11.90098 batch_time=0.50546 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.47370 (QuantReg: 11.88186) QuantErr: 11.88186 batch_time=0.50462 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.49545 (QuantReg: 11.79156) QuantErr: 11.79156 batch_time=0.53815 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.31973 (QuantReg: 11.58598) QuantErr: 11.58598 batch_time=0.52449 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.35887 (QuantReg: 11.93560) QuantErr: 11.93560 batch_time=0.50008 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.35737 (QuantReg: 11.85180) QuantErr: 11.85180 batch_time=0.50067 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.54357 (QuantReg: 12.02499) QuantErr: 12.02499 batch_time=0.55888 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.49222 (QuantReg: 11.87622) QuantErr: 11.87622 batch_time=0.87325 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.41357 (QuantReg: 11.88921) QuantErr: 11.88921 batch_time=0.49793 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.55574 (QuantReg: 11.95506) QuantErr: 11.95506 batch_time=0.59441 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.37073 (QuantReg: 11.97413) QuantErr: 11.97413 batch_time=0.53195 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.27637 (QuantReg: 11.94716) QuantErr: 11.94716 batch_time=0.52189 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.37942 (QuantReg: 11.91154) QuantErr: 11.91154 batch_time=0.85361 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.36965 (QuantReg: 11.92551) QuantErr: 11.92551 batch_time=0.54253 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.36255 (QuantReg: 11.92836) QuantErr: 11.92836 batch_time=0.51572 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.57797 (QuantReg: 11.93614) QuantErr: 11.93614 batch_time=0.50702 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.46626 (QuantReg: 11.89612) QuantErr: 11.89612 batch_time=0.52453 
Train Epoch: 44 codebook_update_time=1.70048
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch44.pth ...
Done in 4.889s
removing stale ckpt [epoch 43] [took 0.01s]
 epoch          : 44
 loss           : 1.3274899916648866
 quant_reg      : 11.929880619049072
 quant_err      : 11.929880619049072
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.397
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.94023825411316
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.1305
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.74138111897582
 mnt_best       : 44.87446791888312
 not_improved_count: 13
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.52660 (QuantReg: 12.20286) QuantErr: 12.20286 batch_time=27.30348 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.29558 (QuantReg: 11.77655) QuantErr: 11.77655 batch_time=0.52235 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 1.03557 (QuantReg: 12.26261) QuantErr: 12.26261 batch_time=0.48877 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.50095 (QuantReg: 11.80516) QuantErr: 11.80516 batch_time=0.52868 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.35419 (QuantReg: 11.70617) QuantErr: 11.70617 batch_time=0.50233 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.41864 (QuantReg: 11.93752) QuantErr: 11.93752 batch_time=0.49694 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.99146 (QuantReg: 12.10825) QuantErr: 12.10825 batch_time=0.99211 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.37584 (QuantReg: 12.10735) QuantErr: 12.10735 batch_time=0.49426 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.32522 (QuantReg: 11.88826) QuantErr: 11.88826 batch_time=0.49596 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 1.21897 (QuantReg: 12.29100) QuantErr: 12.29100 batch_time=0.51017 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 1.16861 (QuantReg: 12.10563) QuantErr: 12.10563 batch_time=0.50371 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.29091 (QuantReg: 12.14286) QuantErr: 12.14286 batch_time=0.49946 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.05463 (QuantReg: 11.88540) QuantErr: 11.88540 batch_time=0.81446 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.46059 (QuantReg: 11.90382) QuantErr: 11.90382 batch_time=0.50329 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.48522 (QuantReg: 11.89933) QuantErr: 11.89933 batch_time=0.50468 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 1.18426 (QuantReg: 12.06275) QuantErr: 12.06275 batch_time=0.51006 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.49454 (QuantReg: 11.67667) QuantErr: 11.67667 batch_time=0.49835 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.35933 (QuantReg: 12.10908) QuantErr: 12.10908 batch_time=0.50459 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 1.13811 (QuantReg: 12.06281) QuantErr: 12.06281 batch_time=0.49378 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 1.07877 (QuantReg: 11.91222) QuantErr: 11.91222 batch_time=1.78865 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.38572 (QuantReg: 11.80841) QuantErr: 11.80841 batch_time=2.01501 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 1.11477 (QuantReg: 12.19375) QuantErr: 12.19375 batch_time=0.51078 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.40089 (QuantReg: 11.95658) QuantErr: 11.95658 batch_time=0.52063 
Train Epoch: 45 codebook_update_time=2.01457
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch45.pth ...
Done in 4.502s
removing stale ckpt [epoch 44] [took 0.07s]
 epoch          : 45
 loss           : 1.3188686599731445
 quant_reg      : 11.930449188232421
 quant_err      : 11.930449188232421
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.757
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.54213238132313
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.5875
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.209407578056
 mnt_best       : 44.87446791888312
 not_improved_count: 14
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 1.27119 (QuantReg: 11.99845) QuantErr: 11.99845 batch_time=32.91935 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.63924 (QuantReg: 11.55820) QuantErr: 11.55820 batch_time=0.54026 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.44829 (QuantReg: 12.11565) QuantErr: 12.11565 batch_time=0.50843 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.31831 (QuantReg: 12.03329) QuantErr: 12.03329 batch_time=0.50136 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.41685 (QuantReg: 11.85495) QuantErr: 11.85495 batch_time=0.52909 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.30214 (QuantReg: 11.94050) QuantErr: 11.94050 batch_time=0.52529 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.30041 (QuantReg: 11.97609) QuantErr: 11.97609 batch_time=0.50927 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.16675 (QuantReg: 11.59021) QuantErr: 11.59021 batch_time=0.52441 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.98857 (QuantReg: 11.75068) QuantErr: 11.75068 batch_time=0.54905 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 1.21216 (QuantReg: 12.30328) QuantErr: 12.30328 batch_time=0.74555 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.59646 (QuantReg: 11.98656) QuantErr: 11.98656 batch_time=0.52105 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.33271 (QuantReg: 11.84954) QuantErr: 11.84954 batch_time=0.51170 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.43743 (QuantReg: 11.71744) QuantErr: 11.71744 batch_time=0.50461 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.61753 (QuantReg: 11.74382) QuantErr: 11.74382 batch_time=0.52800 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.60750 (QuantReg: 11.95970) QuantErr: 11.95970 batch_time=0.50046 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.45425 (QuantReg: 11.85716) QuantErr: 11.85716 batch_time=0.49198 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.26027 (QuantReg: 11.78218) QuantErr: 11.78218 batch_time=0.50240 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.29527 (QuantReg: 12.10144) QuantErr: 12.10144 batch_time=0.49927 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 1.34167 (QuantReg: 12.06749) QuantErr: 12.06749 batch_time=0.89943 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 1.28383 (QuantReg: 12.17348) QuantErr: 12.17348 batch_time=0.51642 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.19118 (QuantReg: 11.89497) QuantErr: 11.89497 batch_time=0.51974 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.01301 (QuantReg: 12.04255) QuantErr: 12.04255 batch_time=0.52430 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.39996 (QuantReg: 12.22898) QuantErr: 12.22898 batch_time=0.50009 
Train Epoch: 46 codebook_update_time=1.68371
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch46.pth ...
Done in 4.415s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 1.3227157962322236
 quant_reg      : 11.926586540222168
 quant_err      : 11.926586540222168
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.489
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.73402561235399
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.8335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.77788082269791
 mnt_best       : 44.87446791888312
 not_improved_count: 15
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.52756 (QuantReg: 11.61417) QuantErr: 11.61417 batch_time=32.36125 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.24596 (QuantReg: 11.82832) QuantErr: 11.82832 batch_time=0.50529 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.48319 (QuantReg: 12.00395) QuantErr: 12.00395 batch_time=0.93096 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.46648 (QuantReg: 11.86215) QuantErr: 11.86215 batch_time=0.56937 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.34945 (QuantReg: 12.14495) QuantErr: 12.14495 batch_time=0.82730 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 1.16252 (QuantReg: 12.18624) QuantErr: 12.18624 batch_time=0.53400 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.26986 (QuantReg: 12.25087) QuantErr: 12.25087 batch_time=0.51380 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.40051 (QuantReg: 12.08035) QuantErr: 12.08035 batch_time=0.51362 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.49006 (QuantReg: 11.81913) QuantErr: 11.81913 batch_time=0.50108 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 1.15154 (QuantReg: 12.12049) QuantErr: 12.12049 batch_time=0.53472 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 1.27760 (QuantReg: 11.95552) QuantErr: 11.95552 batch_time=0.50688 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 1.24923 (QuantReg: 11.90894) QuantErr: 11.90894 batch_time=0.49294 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.31260 (QuantReg: 12.07973) QuantErr: 12.07973 batch_time=0.50447 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.01082 (QuantReg: 11.89338) QuantErr: 11.89338 batch_time=1.05481 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.44994 (QuantReg: 12.09099) QuantErr: 12.09099 batch_time=0.51198 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.13827 (QuantReg: 11.98900) QuantErr: 11.98900 batch_time=0.49989 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.53463 (QuantReg: 12.16634) QuantErr: 12.16634 batch_time=0.59793 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.50361 (QuantReg: 11.94105) QuantErr: 11.94105 batch_time=0.50199 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.22327 (QuantReg: 11.90767) QuantErr: 11.90767 batch_time=0.50007 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.24994 (QuantReg: 11.80546) QuantErr: 11.80546 batch_time=0.50497 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 1.00779 (QuantReg: 12.12630) QuantErr: 12.12630 batch_time=0.52966 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.45812 (QuantReg: 11.97313) QuantErr: 11.97313 batch_time=0.61357 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.29520 (QuantReg: 11.80516) QuantErr: 11.80516 batch_time=0.51951 
Train Epoch: 47 codebook_update_time=1.79506
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch47.pth ...
Done in 4.231s
removing stale ckpt [epoch 46] [took 0.02s]
 epoch          : 47
 loss           : 1.3224630765914918
 quant_reg      : 11.954667407989502
 quant_err      : 11.954667407989502
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.627
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.364722200819934
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.666
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.57436617140184
 mnt_best       : 44.87446791888312
 not_improved_count: 16
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.41172 (QuantReg: 11.76889) QuantErr: 11.76889 batch_time=30.20776 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.35965 (QuantReg: 12.01486) QuantErr: 12.01486 batch_time=0.60848 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.44425 (QuantReg: 11.90408) QuantErr: 11.90408 batch_time=0.96036 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.34376 (QuantReg: 11.77866) QuantErr: 11.77866 batch_time=0.52680 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.34225 (QuantReg: 11.84082) QuantErr: 11.84082 batch_time=0.50570 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.45004 (QuantReg: 12.19281) QuantErr: 12.19281 batch_time=0.50507 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.25479 (QuantReg: 11.98259) QuantErr: 11.98259 batch_time=0.50086 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.49832 (QuantReg: 12.01507) QuantErr: 12.01507 batch_time=0.52325 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.20823 (QuantReg: 12.24540) QuantErr: 12.24540 batch_time=0.49686 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.25551 (QuantReg: 12.03402) QuantErr: 12.03402 batch_time=0.51306 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.36270 (QuantReg: 12.04433) QuantErr: 12.04433 batch_time=0.50838 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.19113 (QuantReg: 11.66584) QuantErr: 11.66584 batch_time=0.51810 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.40443 (QuantReg: 11.79337) QuantErr: 11.79337 batch_time=0.50453 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.65137 (QuantReg: 11.86863) QuantErr: 11.86863 batch_time=0.54143 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.39103 (QuantReg: 11.91959) QuantErr: 11.91959 batch_time=1.27027 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.48130 (QuantReg: 11.83465) QuantErr: 11.83465 batch_time=0.49888 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 1.02251 (QuantReg: 12.03414) QuantErr: 12.03414 batch_time=0.54779 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.12612 (QuantReg: 12.17393) QuantErr: 12.17393 batch_time=0.50285 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.38476 (QuantReg: 11.94172) QuantErr: 11.94172 batch_time=0.50507 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.22358 (QuantReg: 11.95422) QuantErr: 11.95422 batch_time=2.98296 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.44715 (QuantReg: 11.99774) QuantErr: 11.99774 batch_time=0.50972 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.35600 (QuantReg: 11.79650) QuantErr: 11.79650 batch_time=0.51034 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.17379 (QuantReg: 11.88183) QuantErr: 11.88183 batch_time=0.53840 
Train Epoch: 48 codebook_update_time=1.66250
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch48.pth ...
Done in 6.388s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch48.pth ...
Done in 11.789s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 1.3195478184223175
 quant_reg      : 11.953315212249755
 quant_err      : 11.953315212249755
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.399
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.901116203486815
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.78
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.475903806465205
 mnt_best       : 44.901116203486815
 not_improved_count: 0
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.40087 (QuantReg: 11.86869) QuantErr: 11.86869 batch_time=30.47919 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.43476 (QuantReg: 12.02109) QuantErr: 12.02109 batch_time=0.56748 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.25952 (QuantReg: 11.93367) QuantErr: 11.93367 batch_time=0.52969 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.55728 (QuantReg: 12.08490) QuantErr: 12.08490 batch_time=0.51490 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.41974 (QuantReg: 11.76608) QuantErr: 11.76608 batch_time=0.52094 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.33957 (QuantReg: 11.94772) QuantErr: 11.94772 batch_time=0.54794 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.18935 (QuantReg: 11.79582) QuantErr: 11.79582 batch_time=0.55434 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 1.14700 (QuantReg: 12.14571) QuantErr: 12.14571 batch_time=0.51389 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 1.07236 (QuantReg: 11.70320) QuantErr: 11.70320 batch_time=0.52339 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.28290 (QuantReg: 11.89455) QuantErr: 11.89455 batch_time=0.54296 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.30882 (QuantReg: 12.04645) QuantErr: 12.04645 batch_time=0.54578 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.15059 (QuantReg: 11.90339) QuantErr: 11.90339 batch_time=0.50888 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.47212 (QuantReg: 11.76417) QuantErr: 11.76417 batch_time=0.49769 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.39522 (QuantReg: 11.85130) QuantErr: 11.85130 batch_time=0.50922 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.23137 (QuantReg: 11.86563) QuantErr: 11.86563 batch_time=2.07031 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 1.08876 (QuantReg: 11.90803) QuantErr: 11.90803 batch_time=0.55429 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 1.21691 (QuantReg: 11.84815) QuantErr: 11.84815 batch_time=0.49723 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.39966 (QuantReg: 12.09817) QuantErr: 12.09817 batch_time=0.52795 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.40149 (QuantReg: 12.00891) QuantErr: 12.00891 batch_time=0.58252 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.48837 (QuantReg: 11.79164) QuantErr: 11.79164 batch_time=0.54595 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.15540 (QuantReg: 11.93516) QuantErr: 11.93516 batch_time=0.51111 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.93500 (QuantReg: 11.87251) QuantErr: 11.87251 batch_time=0.51614 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.32912 (QuantReg: 11.85205) QuantErr: 11.85205 batch_time=0.51336 
Train Epoch: 49 codebook_update_time=1.76828
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch49.pth ...
Done in 5.250s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 1.324833872795105
 quant_reg      : 11.956625205993653
 quant_err      : 11.956625205993653
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.542
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.018284411791484
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.964
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.27853436651484
 mnt_best       : 44.901116203486815
 not_improved_count: 1
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.32199 (QuantReg: 12.03910) QuantErr: 12.03910 batch_time=29.91085 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.86665 (QuantReg: 11.96409) QuantErr: 11.96409 batch_time=0.52638 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.14059 (QuantReg: 12.09858) QuantErr: 12.09858 batch_time=0.49146 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.26796 (QuantReg: 12.10900) QuantErr: 12.10900 batch_time=0.52142 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.39449 (QuantReg: 11.82672) QuantErr: 11.82672 batch_time=0.49663 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 1.30709 (QuantReg: 11.96920) QuantErr: 11.96920 batch_time=0.49490 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.36158 (QuantReg: 12.00483) QuantErr: 12.00483 batch_time=0.76610 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 1.23625 (QuantReg: 12.01332) QuantErr: 12.01332 batch_time=0.50798 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 1.21417 (QuantReg: 11.98775) QuantErr: 11.98775 batch_time=1.46476 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.32730 (QuantReg: 12.17267) QuantErr: 12.17267 batch_time=1.80478 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.06710 (QuantReg: 12.20772) QuantErr: 12.20772 batch_time=0.54097 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 1.19463 (QuantReg: 11.84817) QuantErr: 11.84817 batch_time=0.50030 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.31703 (QuantReg: 11.98205) QuantErr: 11.98205 batch_time=0.49821 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.51268 (QuantReg: 11.82803) QuantErr: 11.82803 batch_time=0.50767 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.33937 (QuantReg: 11.79572) QuantErr: 11.79572 batch_time=0.49503 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 1.01533 (QuantReg: 11.95232) QuantErr: 11.95232 batch_time=0.50226 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.46654 (QuantReg: 12.12205) QuantErr: 12.12205 batch_time=0.52748 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.47568 (QuantReg: 12.06739) QuantErr: 12.06739 batch_time=0.53383 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.44223 (QuantReg: 11.97377) QuantErr: 11.97377 batch_time=0.49629 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 1.22868 (QuantReg: 12.09898) QuantErr: 12.09898 batch_time=0.54125 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.29464 (QuantReg: 12.01480) QuantErr: 12.01480 batch_time=0.49493 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.37348 (QuantReg: 11.90380) QuantErr: 11.90380 batch_time=0.51164 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.33162 (QuantReg: 11.93444) QuantErr: 11.93444 batch_time=0.68055 
Train Epoch: 50 codebook_update_time=1.86173
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/checkpoint-epoch50.pth ...
Done in 5.360s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 1.3125354945659637
 quant_reg      : 12.00062590789795
 quant_err      : 12.00062590789795
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.532
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.565084244211576
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.737
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.55638848720531
 mnt_best       : 44.901116203486815
 not_improved_count: 2
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/trained_model.pth ...
Ckpt loaded at epoch 48.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 25.4
 t2v_metrics/R5/final_eval: 52.8
 t2v_metrics/R10/final_eval: 67.5
 t2v_metrics/R50/final_eval: 88.6
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 30.399
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 44.901116203486815
 v2t_metrics/R1/final_eval: 25.9
 v2t_metrics/R5/final_eval: 57.0
 v2t_metrics/R10/final_eval: 68.0
 v2t_metrics/R50/final_eval: 90.0
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 27.78
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 46.475903806465205
Best epoch for the monitored metric: 48
Script took 03h35m26s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.07/trained_model.pth
