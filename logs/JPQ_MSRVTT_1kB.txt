Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB
Preparing the dataloaders ...
Loading dataset MSRVTT_miech_trainval in ram ...
Finish loading dataset MSRVTT_miech_trainval in ram, taking 226.37497901916504 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 29.59237766265869 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 36.01080846786499 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch0.pth ...
Done in 15.156s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch0.pth ...
Done in 16.729s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_miech_test/t2v_metrics/R1: 0.2
 MSRVTT_miech_test/t2v_metrics/R5: 0.5
 MSRVTT_miech_test/t2v_metrics/R10: 1.1
 MSRVTT_miech_test/t2v_metrics/R50: 4.6
 MSRVTT_miech_test/t2v_metrics/MedR: 499.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 500.947
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.4791419857062784
 MSRVTT_miech_test/v2t_metrics/R1: 0.1
 MSRVTT_miech_test/v2t_metrics/R5: 0.4
 MSRVTT_miech_test/v2t_metrics/R10: 1.1
 MSRVTT_miech_test/v2t_metrics/R50: 4.9
 MSRVTT_miech_test/v2t_metrics/MedR: 513.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 502.58
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3530348335326063
 mnt_best       : 0.4791419857062784
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 0.10645 (QuantReg: 0.14098) QuantErr: 0.14098 batch_time=25.39863 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 0.09863 (QuantReg: 0.14058) QuantErr: 0.14058 batch_time=0.52269 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 0.09070 (QuantReg: 0.13757) QuantErr: 0.13757 batch_time=0.43933 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 0.07904 (QuantReg: 0.13656) QuantErr: 0.13656 batch_time=0.45008 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 0.06500 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.47692 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 0.05145 (QuantReg: 0.13515) QuantErr: 0.13515 batch_time=0.43938 
Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB
Preparing the dataloaders ...
Loading dataset MSRVTT_miech_trainval in ram ...
Finish loading dataset MSRVTT_miech_trainval in ram, taking 215.7493917942047 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 35.81242370605469 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 39.24282789230347 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch0.pth ...
Done in 1.593s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch0.pth ...
Done in 3.113s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_miech_test/t2v_metrics/R1: 0.2
 MSRVTT_miech_test/t2v_metrics/R5: 0.5
 MSRVTT_miech_test/t2v_metrics/R10: 1.1
 MSRVTT_miech_test/t2v_metrics/R50: 4.6
 MSRVTT_miech_test/t2v_metrics/MedR: 499.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 500.947
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.4791419857062784
 MSRVTT_miech_test/v2t_metrics/R1: 0.1
 MSRVTT_miech_test/v2t_metrics/R5: 0.4
 MSRVTT_miech_test/v2t_metrics/R10: 1.1
 MSRVTT_miech_test/v2t_metrics/R50: 4.9
 MSRVTT_miech_test/v2t_metrics/MedR: 513.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 502.58
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3530348335326063
 mnt_best       : 0.4791419857062784
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 0.10718 (QuantReg: 0.14075) QuantErr: 0.14075 batch_time=21.22404 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 0.10107 (QuantReg: 0.13972) QuantErr: 0.13972 batch_time=0.45459 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 0.08960 (QuantReg: 0.14112) QuantErr: 0.14112 batch_time=0.43437 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 0.08008 (QuantReg: 0.13774) QuantErr: 0.13774 batch_time=0.44218 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 0.06091 (QuantReg: 0.13721) QuantErr: 0.13721 batch_time=0.43990 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 0.05289 (QuantReg: 0.13905) QuantErr: 0.13905 batch_time=0.42764 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 0.04919 (QuantReg: 0.13638) QuantErr: 0.13638 batch_time=7.13697 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 0.03583 (QuantReg: 0.13729) QuantErr: 0.13729 batch_time=0.41266 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 0.03510 (QuantReg: 0.13610) QuantErr: 0.13610 batch_time=0.46232 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 0.03665 (QuantReg: 0.13668) QuantErr: 0.13668 batch_time=0.44448 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 0.02586 (QuantReg: 0.13795) QuantErr: 0.13795 batch_time=0.42687 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 0.02562 (QuantReg: 0.13802) QuantErr: 0.13802 batch_time=0.45068 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 0.02805 (QuantReg: 0.13772) QuantErr: 0.13772 batch_time=0.48664 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 0.02422 (QuantReg: 0.13790) QuantErr: 0.13790 batch_time=0.42895 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 0.02664 (QuantReg: 0.13823) QuantErr: 0.13823 batch_time=0.44857 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 0.02176 (QuantReg: 0.13762) QuantErr: 0.13762 batch_time=0.45035 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 0.02097 (QuantReg: 0.13839) QuantErr: 0.13839 batch_time=0.46375 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 0.02496 (QuantReg: 0.13739) QuantErr: 0.13739 batch_time=0.43404 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 0.02426 (QuantReg: 0.13575) QuantErr: 0.13575 batch_time=0.80779 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 0.02301 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.46476 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 0.02191 (QuantReg: 0.13351) QuantErr: 0.13351 batch_time=0.43754 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 0.02057 (QuantReg: 0.13453) QuantErr: 0.13453 batch_time=0.41491 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 0.01608 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.43182 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch1.pth ...
Done in 12.302s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch1.pth ...
Done in 16.376s
 epoch          : 1
 loss           : 0.040294342041015625
 quant_reg      : 0.13712939101457597
 quant_err      : 0.13712939101457597
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_miech_test/t2v_metrics/R1: 4.1
 MSRVTT_miech_test/t2v_metrics/R5: 14.6
 MSRVTT_miech_test/t2v_metrics/R10: 22.2
 MSRVTT_miech_test/t2v_metrics/R50: 59.9
 MSRVTT_miech_test/t2v_metrics/MedR: 35.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 76.638
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 10.994189769025553
 MSRVTT_miech_test/v2t_metrics/R1: 3.0
 MSRVTT_miech_test/v2t_metrics/R5: 12.5
 MSRVTT_miech_test/v2t_metrics/R10: 22.5
 MSRVTT_miech_test/v2t_metrics/R50: 61.1
 MSRVTT_miech_test/v2t_metrics/MedR: 34.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 76.7785
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 9.44940787421155
 mnt_best       : 10.994189769025553
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 0.02122 (QuantReg: 0.13524) QuantErr: 0.13524 batch_time=27.57047 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 0.02386 (QuantReg: 0.13733) QuantErr: 0.13733 batch_time=0.45430 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 0.02129 (QuantReg: 0.13556) QuantErr: 0.13556 batch_time=0.44100 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 0.02141 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.45551 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 0.01874 (QuantReg: 0.13400) QuantErr: 0.13400 batch_time=0.45515 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 0.02002 (QuantReg: 0.13653) QuantErr: 0.13653 batch_time=0.43717 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 0.01553 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=1.42129 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 0.01802 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.42262 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 0.01369 (QuantReg: 0.13442) QuantErr: 0.13442 batch_time=0.45129 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 0.02039 (QuantReg: 0.13340) QuantErr: 0.13340 batch_time=0.45184 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 0.01657 (QuantReg: 0.13581) QuantErr: 0.13581 batch_time=0.45056 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 0.01339 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.45071 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 0.01678 (QuantReg: 0.13603) QuantErr: 0.13603 batch_time=0.49511 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 0.01831 (QuantReg: 0.13684) QuantErr: 0.13684 batch_time=0.45295 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 0.01273 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.44407 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 0.01617 (QuantReg: 0.13822) QuantErr: 0.13822 batch_time=0.46029 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 0.01724 (QuantReg: 0.13846) QuantErr: 0.13846 batch_time=0.46459 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 0.01487 (QuantReg: 0.13558) QuantErr: 0.13558 batch_time=0.45790 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 0.01219 (QuantReg: 0.13809) QuantErr: 0.13809 batch_time=0.45614 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 0.01286 (QuantReg: 0.13607) QuantErr: 0.13607 batch_time=0.43822 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 0.01535 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.43773 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 0.01096 (QuantReg: 0.13561) QuantErr: 0.13561 batch_time=0.47767 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 0.01694 (QuantReg: 0.13396) QuantErr: 0.13396 batch_time=0.45922 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch2.pth ...
Done in 4.822s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch2.pth ...
Done in 9.451s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 0.016915557861328125
 quant_reg      : 0.1358870968222618
 quant_err      : 0.1358870968222618
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_miech_test/t2v_metrics/R1: 6.4
 MSRVTT_miech_test/t2v_metrics/R5: 19.8
 MSRVTT_miech_test/t2v_metrics/R10: 30.1
 MSRVTT_miech_test/t2v_metrics/R50: 69.7
 MSRVTT_miech_test/t2v_metrics/MedR: 26.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 57.764
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.624419349088981
 MSRVTT_miech_test/v2t_metrics/R1: 4.6
 MSRVTT_miech_test/v2t_metrics/R5: 18.8
 MSRVTT_miech_test/v2t_metrics/R10: 30.7
 MSRVTT_miech_test/v2t_metrics/R50: 68.9
 MSRVTT_miech_test/v2t_metrics/MedR: 24.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 58.762
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 13.846861622572616
 mnt_best       : 15.624419349088981
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 0.01645 (QuantReg: 0.13486) QuantErr: 0.13486 batch_time=26.62894 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 0.01469 (QuantReg: 0.13403) QuantErr: 0.13403 batch_time=0.72175 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 0.01377 (QuantReg: 0.13589) QuantErr: 0.13589 batch_time=1.31271 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 0.01268 (QuantReg: 0.13550) QuantErr: 0.13550 batch_time=0.44734 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 0.01599 (QuantReg: 0.13789) QuantErr: 0.13789 batch_time=0.43118 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 0.01217 (QuantReg: 0.13743) QuantErr: 0.13743 batch_time=0.47590 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 0.01367 (QuantReg: 0.13662) QuantErr: 0.13662 batch_time=0.44840 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 0.01219 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.46375 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 0.01131 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.45834 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 0.01387 (QuantReg: 0.13678) QuantErr: 0.13678 batch_time=0.45268 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 0.01627 (QuantReg: 0.13659) QuantErr: 0.13659 batch_time=0.43676 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 0.01196 (QuantReg: 0.13761) QuantErr: 0.13761 batch_time=0.44596 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 0.01331 (QuantReg: 0.13403) QuantErr: 0.13403 batch_time=0.48316 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 0.01160 (QuantReg: 0.13396) QuantErr: 0.13396 batch_time=1.07420 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 0.01314 (QuantReg: 0.13611) QuantErr: 0.13611 batch_time=0.42546 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 0.01588 (QuantReg: 0.13498) QuantErr: 0.13498 batch_time=0.42487 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 0.01183 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.42714 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 0.01598 (QuantReg: 0.13847) QuantErr: 0.13847 batch_time=0.43036 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 0.01247 (QuantReg: 0.13708) QuantErr: 0.13708 batch_time=0.42209 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 0.01163 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.41896 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 0.01639 (QuantReg: 0.13615) QuantErr: 0.13615 batch_time=0.42086 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 0.01051 (QuantReg: 0.13720) QuantErr: 0.13720 batch_time=0.41981 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 0.01295 (QuantReg: 0.13686) QuantErr: 0.13686 batch_time=0.42774 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch3.pth ...
Done in 11.891s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch3.pth ...
Done in 16.321s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 0.0130787353515625
 quant_reg      : 0.13611697101593018
 quant_err      : 0.13611697101593018
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_miech_test/t2v_metrics/R1: 6.3
 MSRVTT_miech_test/t2v_metrics/R5: 23.5
 MSRVTT_miech_test/t2v_metrics/R10: 35.8
 MSRVTT_miech_test/t2v_metrics/R50: 73.3
 MSRVTT_miech_test/t2v_metrics/MedR: 19.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 54.12
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 17.435342354530384
 MSRVTT_miech_test/v2t_metrics/R1: 5.9
 MSRVTT_miech_test/v2t_metrics/R5: 23.0
 MSRVTT_miech_test/v2t_metrics/R10: 36.1
 MSRVTT_miech_test/v2t_metrics/R50: 74.8
 MSRVTT_miech_test/v2t_metrics/MedR: 19.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 53.055
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 16.983571210233475
 mnt_best       : 17.435342354530384
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 0.00948 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=33.54015 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 0.01086 (QuantReg: 0.13291) QuantErr: 0.13291 batch_time=0.44176 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 0.01385 (QuantReg: 0.13766) QuantErr: 0.13766 batch_time=0.51002 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 0.01245 (QuantReg: 0.13603) QuantErr: 0.13603 batch_time=0.44492 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 0.01109 (QuantReg: 0.13608) QuantErr: 0.13608 batch_time=0.56888 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 0.01071 (QuantReg: 0.13715) QuantErr: 0.13715 batch_time=0.43725 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 0.01042 (QuantReg: 0.13687) QuantErr: 0.13687 batch_time=0.44070 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 0.01009 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.46636 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 0.01262 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.42664 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 0.00877 (QuantReg: 0.13389) QuantErr: 0.13389 batch_time=0.44927 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 0.01192 (QuantReg: 0.13476) QuantErr: 0.13476 batch_time=0.43861 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 0.01120 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.41818 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 0.01068 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=3.37597 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 0.00946 (QuantReg: 0.13613) QuantErr: 0.13613 batch_time=0.45090 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 0.00932 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=0.50888 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 0.00963 (QuantReg: 0.13418) QuantErr: 0.13418 batch_time=0.43973 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 0.00963 (QuantReg: 0.13671) QuantErr: 0.13671 batch_time=0.44456 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 0.00851 (QuantReg: 0.13472) QuantErr: 0.13472 batch_time=0.44684 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 0.00880 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=1.38702 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 0.01295 (QuantReg: 0.13422) QuantErr: 0.13422 batch_time=2.66112 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 0.01300 (QuantReg: 0.13329) QuantErr: 0.13329 batch_time=0.47734 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 0.01352 (QuantReg: 0.13554) QuantErr: 0.13554 batch_time=0.42503 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 0.01244 (QuantReg: 0.13412) QuantErr: 0.13412 batch_time=0.43275 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch4.pth ...
Done in 4.086s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch4.pth ...
Done in 8.798s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 0.01096270751953125
 quant_reg      : 0.13539467459917068
 quant_err      : 0.13539467459917068
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_miech_test/t2v_metrics/R1: 7.3
 MSRVTT_miech_test/t2v_metrics/R5: 25.1
 MSRVTT_miech_test/t2v_metrics/R10: 38.6
 MSRVTT_miech_test/t2v_metrics/R50: 76.7
 MSRVTT_miech_test/t2v_metrics/MedR: 18.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 48.358
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.19528783377172
 MSRVTT_miech_test/v2t_metrics/R1: 7.0
 MSRVTT_miech_test/v2t_metrics/R5: 21.8
 MSRVTT_miech_test/v2t_metrics/R10: 35.3
 MSRVTT_miech_test/v2t_metrics/R50: 76.9
 MSRVTT_miech_test/v2t_metrics/MedR: 18.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 47.738
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.529777872876597
 mnt_best       : 19.19528783377172
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 0.00841 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=31.37263 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 0.00930 (QuantReg: 0.13409) QuantErr: 0.13409 batch_time=0.47293 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 0.00823 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=0.41811 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 0.01559 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.47808 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 0.01205 (QuantReg: 0.13669) QuantErr: 0.13669 batch_time=0.48292 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 0.00981 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=0.42951 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 0.00839 (QuantReg: 0.13665) QuantErr: 0.13665 batch_time=0.45254 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 0.01031 (QuantReg: 0.13488) QuantErr: 0.13488 batch_time=0.44062 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 0.01013 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.44171 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 0.01085 (QuantReg: 0.13665) QuantErr: 0.13665 batch_time=0.44409 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 0.01041 (QuantReg: 0.13452) QuantErr: 0.13452 batch_time=0.44661 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 0.00877 (QuantReg: 0.13618) QuantErr: 0.13618 batch_time=0.43964 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 0.00848 (QuantReg: 0.13550) QuantErr: 0.13550 batch_time=0.42979 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 0.00842 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.45080 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 0.00925 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.43034 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 0.00848 (QuantReg: 0.13736) QuantErr: 0.13736 batch_time=0.45459 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 0.00822 (QuantReg: 0.13469) QuantErr: 0.13469 batch_time=0.44521 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 0.00844 (QuantReg: 0.13415) QuantErr: 0.13415 batch_time=0.44602 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 0.01012 (QuantReg: 0.13292) QuantErr: 0.13292 batch_time=0.44689 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 0.00757 (QuantReg: 0.13407) QuantErr: 0.13407 batch_time=0.44055 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 0.00739 (QuantReg: 0.13449) QuantErr: 0.13449 batch_time=0.42839 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 0.00996 (QuantReg: 0.13237) QuantErr: 0.13237 batch_time=0.44500 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 0.00667 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=0.45667 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch5.pth ...
Done in 10.949s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch5.pth ...
Done in 14.971s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 0.009823516845703125
 quant_reg      : 0.1354585691690445
 quant_err      : 0.1354585691690445
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_miech_test/t2v_metrics/R1: 8.0
 MSRVTT_miech_test/t2v_metrics/R5: 27.8
 MSRVTT_miech_test/t2v_metrics/R10: 40.6
 MSRVTT_miech_test/t2v_metrics/R50: 78.0
 MSRVTT_miech_test/t2v_metrics/MedR: 15.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 46.412
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.823494162775123
 MSRVTT_miech_test/v2t_metrics/R1: 8.7
 MSRVTT_miech_test/v2t_metrics/R5: 27.2
 MSRVTT_miech_test/v2t_metrics/R10: 41.7
 MSRVTT_miech_test/v2t_metrics/R50: 78.4
 MSRVTT_miech_test/v2t_metrics/MedR: 14.75
 MSRVTT_miech_test/v2t_metrics/MeanR: 45.573
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.44905044128132
 mnt_best       : 20.823494162775123
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 0.00920 (QuantReg: 0.13544) QuantErr: 0.13544 batch_time=32.18695 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 0.01271 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.43901 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 0.00765 (QuantReg: 0.13563) QuantErr: 0.13563 batch_time=0.44762 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 0.00787 (QuantReg: 0.13636) QuantErr: 0.13636 batch_time=0.43076 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 0.01202 (QuantReg: 0.13727) QuantErr: 0.13727 batch_time=0.43136 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 0.00738 (QuantReg: 0.13575) QuantErr: 0.13575 batch_time=0.43852 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 0.00925 (QuantReg: 0.13561) QuantErr: 0.13561 batch_time=2.66382 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 0.00586 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.41532 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 0.01105 (QuantReg: 0.13243) QuantErr: 0.13243 batch_time=0.42881 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 0.00839 (QuantReg: 0.13251) QuantErr: 0.13251 batch_time=0.53081 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 0.00747 (QuantReg: 0.13496) QuantErr: 0.13496 batch_time=0.43339 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 0.00862 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.42628 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 0.00703 (QuantReg: 0.13491) QuantErr: 0.13491 batch_time=0.43563 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 0.00767 (QuantReg: 0.13790) QuantErr: 0.13790 batch_time=0.41544 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 0.00839 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.42832 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 0.01172 (QuantReg: 0.13437) QuantErr: 0.13437 batch_time=0.44134 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 0.00935 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=0.41271 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 0.00858 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.43722 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 0.00941 (QuantReg: 0.13490) QuantErr: 0.13490 batch_time=0.44585 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 0.00640 (QuantReg: 0.13676) QuantErr: 0.13676 batch_time=0.42828 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 0.00926 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.45106 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 0.00684 (QuantReg: 0.13690) QuantErr: 0.13690 batch_time=0.45009 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 0.00691 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.45595 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch6.pth ...
Done in 4.448s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch6.pth ...
Done in 8.424s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 0.008554336547851562
 quant_reg      : 0.13536486107110976
 quant_err      : 0.13536486107110976
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_miech_test/t2v_metrics/R1: 8.7
 MSRVTT_miech_test/t2v_metrics/R5: 27.9
 MSRVTT_miech_test/t2v_metrics/R10: 41.9
 MSRVTT_miech_test/t2v_metrics/R50: 79.2
 MSRVTT_miech_test/t2v_metrics/MedR: 14.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 46.67
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.666020993250697
 MSRVTT_miech_test/v2t_metrics/R1: 7.1
 MSRVTT_miech_test/v2t_metrics/R5: 26.0
 MSRVTT_miech_test/v2t_metrics/R10: 40.5
 MSRVTT_miech_test/v2t_metrics/R50: 79.5
 MSRVTT_miech_test/v2t_metrics/MedR: 16.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 45.466
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.553698146780864
 mnt_best       : 21.666020993250697
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 0.00512 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=33.21777 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 0.00748 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.40911 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 0.01083 (QuantReg: 0.13208) QuantErr: 0.13208 batch_time=0.43466 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 0.01085 (QuantReg: 0.13386) QuantErr: 0.13386 batch_time=0.41710 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 0.00830 (QuantReg: 0.13557) QuantErr: 0.13557 batch_time=0.44828 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 0.01320 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=0.42460 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 0.00890 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.43996 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 0.00892 (QuantReg: 0.13438) QuantErr: 0.13438 batch_time=0.43046 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 0.00966 (QuantReg: 0.13510) QuantErr: 0.13510 batch_time=0.42155 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 0.00940 (QuantReg: 0.13563) QuantErr: 0.13563 batch_time=0.43389 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 0.01155 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.43940 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 0.00949 (QuantReg: 0.13338) QuantErr: 0.13338 batch_time=0.42385 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 0.00548 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=0.43085 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 0.00845 (QuantReg: 0.13725) QuantErr: 0.13725 batch_time=0.93727 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 0.00746 (QuantReg: 0.13709) QuantErr: 0.13709 batch_time=0.44915 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 0.00706 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=0.43525 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 0.00887 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=0.43817 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 0.00897 (QuantReg: 0.13288) QuantErr: 0.13288 batch_time=0.44609 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 0.00603 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=0.46504 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 0.00658 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.44680 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 0.00629 (QuantReg: 0.13478) QuantErr: 0.13478 batch_time=0.42678 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 0.00601 (QuantReg: 0.13612) QuantErr: 0.13612 batch_time=0.44942 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 0.00750 (QuantReg: 0.13607) QuantErr: 0.13607 batch_time=0.41541 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch7.pth ...
Done in 4.105s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch7.pth ...
Done in 8.084s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 0.008110855102539062
 quant_reg      : 0.13530167800188064
 quant_err      : 0.13530167800188064
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_miech_test/t2v_metrics/R1: 8.7
 MSRVTT_miech_test/t2v_metrics/R5: 29.0
 MSRVTT_miech_test/t2v_metrics/R10: 43.8
 MSRVTT_miech_test/t2v_metrics/R50: 78.9
 MSRVTT_miech_test/t2v_metrics/MedR: 14.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 43.74
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.27394384075849
 MSRVTT_miech_test/v2t_metrics/R1: 9.0
 MSRVTT_miech_test/v2t_metrics/R5: 28.5
 MSRVTT_miech_test/v2t_metrics/R10: 44.3
 MSRVTT_miech_test/v2t_metrics/R50: 80.3
 MSRVTT_miech_test/v2t_metrics/MedR: 13.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 42.261
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.48176300007518
 mnt_best       : 22.27394384075849
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 0.01060 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=26.64528 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 0.00750 (QuantReg: 0.13594) QuantErr: 0.13594 batch_time=0.43892 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 0.00527 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.42990 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 0.00855 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.43209 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 0.00609 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=0.43595 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 0.00821 (QuantReg: 0.13588) QuantErr: 0.13588 batch_time=0.44697 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 0.00797 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.42117 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 0.00506 (QuantReg: 0.13589) QuantErr: 0.13589 batch_time=1.42686 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 0.00885 (QuantReg: 0.13543) QuantErr: 0.13543 batch_time=0.43215 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 0.00805 (QuantReg: 0.13387) QuantErr: 0.13387 batch_time=0.47852 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 0.00729 (QuantReg: 0.13538) QuantErr: 0.13538 batch_time=0.43706 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 0.00858 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=0.42709 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 0.01041 (QuantReg: 0.13694) QuantErr: 0.13694 batch_time=0.43384 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 0.00764 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.43353 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 0.00628 (QuantReg: 0.13411) QuantErr: 0.13411 batch_time=0.43705 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 0.00944 (QuantReg: 0.13421) QuantErr: 0.13421 batch_time=0.43331 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 0.00741 (QuantReg: 0.13686) QuantErr: 0.13686 batch_time=0.53805 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 0.00764 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.43207 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 0.00749 (QuantReg: 0.13606) QuantErr: 0.13606 batch_time=0.44530 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 0.00542 (QuantReg: 0.13584) QuantErr: 0.13584 batch_time=2.00320 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 0.00548 (QuantReg: 0.13572) QuantErr: 0.13572 batch_time=0.43145 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 0.00743 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.41926 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 0.00665 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.53605 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch8.pth ...
Done in 3.905s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch8.pth ...
Done in 8.034s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 0.007696823120117187
 quant_reg      : 0.13552460992336274
 quant_err      : 0.13552460992336274
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_miech_test/t2v_metrics/R1: 9.2
 MSRVTT_miech_test/t2v_metrics/R5: 29.9
 MSRVTT_miech_test/t2v_metrics/R10: 44.3
 MSRVTT_miech_test/t2v_metrics/R50: 78.9
 MSRVTT_miech_test/t2v_metrics/MedR: 13.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 42.955
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.011993744568997
 MSRVTT_miech_test/v2t_metrics/R1: 9.5
 MSRVTT_miech_test/v2t_metrics/R5: 30.8
 MSRVTT_miech_test/v2t_metrics/R10: 45.7
 MSRVTT_miech_test/v2t_metrics/R50: 81.4
 MSRVTT_miech_test/v2t_metrics/MedR: 13.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 39.685
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.735415607257313
 mnt_best       : 23.011993744568997
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 0.00550 (QuantReg: 0.13470) QuantErr: 0.13470 batch_time=27.38218 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 0.00845 (QuantReg: 0.13583) QuantErr: 0.13583 batch_time=0.40958 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 0.00552 (QuantReg: 0.13407) QuantErr: 0.13407 batch_time=0.41368 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 0.00746 (QuantReg: 0.13607) QuantErr: 0.13607 batch_time=0.43146 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 0.01396 (QuantReg: 0.13429) QuantErr: 0.13429 batch_time=0.44371 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 0.00896 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.42379 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 0.00614 (QuantReg: 0.13378) QuantErr: 0.13378 batch_time=0.43839 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 0.00856 (QuantReg: 0.13610) QuantErr: 0.13610 batch_time=0.46005 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 0.00528 (QuantReg: 0.13485) QuantErr: 0.13485 batch_time=0.42527 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 0.00575 (QuantReg: 0.13593) QuantErr: 0.13593 batch_time=0.41438 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 0.00620 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.43566 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 0.00524 (QuantReg: 0.13336) QuantErr: 0.13336 batch_time=0.43525 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 0.00743 (QuantReg: 0.13404) QuantErr: 0.13404 batch_time=0.41879 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 0.00699 (QuantReg: 0.13559) QuantErr: 0.13559 batch_time=0.44453 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 0.00718 (QuantReg: 0.13654) QuantErr: 0.13654 batch_time=0.44992 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 0.00822 (QuantReg: 0.13521) QuantErr: 0.13521 batch_time=0.44354 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 0.00618 (QuantReg: 0.13480) QuantErr: 0.13480 batch_time=0.44486 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 0.00635 (QuantReg: 0.13668) QuantErr: 0.13668 batch_time=0.45516 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 0.00680 (QuantReg: 0.13370) QuantErr: 0.13370 batch_time=0.45440 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 0.00758 (QuantReg: 0.13311) QuantErr: 0.13311 batch_time=0.44411 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 0.00630 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.45918 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 0.00537 (QuantReg: 0.13429) QuantErr: 0.13429 batch_time=0.42586 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 0.01010 (QuantReg: 0.13724) QuantErr: 0.13724 batch_time=0.44291 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch9.pth ...
Done in 9.825s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch9.pth ...
Done in 13.928s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 0.00689166259765625
 quant_reg      : 0.13511994010210038
 quant_err      : 0.13511994010210038
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_miech_test/t2v_metrics/R1: 9.4
 MSRVTT_miech_test/t2v_metrics/R5: 31.9
 MSRVTT_miech_test/t2v_metrics/R10: 46.2
 MSRVTT_miech_test/t2v_metrics/R50: 81.7
 MSRVTT_miech_test/t2v_metrics/MedR: 13.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 42.926
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.017078122301008
 MSRVTT_miech_test/v2t_metrics/R1: 9.8
 MSRVTT_miech_test/v2t_metrics/R5: 32.1
 MSRVTT_miech_test/v2t_metrics/R10: 46.9
 MSRVTT_miech_test/v2t_metrics/R50: 82.0
 MSRVTT_miech_test/v2t_metrics/MedR: 12.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 39.373
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.526447630115666
 mnt_best       : 24.017078122301008
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 0.00636 (QuantReg: 0.13542) QuantErr: 0.13542 batch_time=32.23955 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 0.00685 (QuantReg: 0.13543) QuantErr: 0.13543 batch_time=0.42723 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 0.00422 (QuantReg: 0.13544) QuantErr: 0.13544 batch_time=0.46940 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 0.00672 (QuantReg: 0.13381) QuantErr: 0.13381 batch_time=0.43292 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 0.00762 (QuantReg: 0.13288) QuantErr: 0.13288 batch_time=0.44595 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 0.00577 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.43562 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 0.00639 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.42465 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 0.00829 (QuantReg: 0.13679) QuantErr: 0.13679 batch_time=0.46056 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 0.00505 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.42440 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 0.00808 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.41891 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 0.00554 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.42682 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 0.00541 (QuantReg: 0.13509) QuantErr: 0.13509 batch_time=0.42579 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 0.00694 (QuantReg: 0.13663) QuantErr: 0.13663 batch_time=0.42024 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 0.00925 (QuantReg: 0.13492) QuantErr: 0.13492 batch_time=0.42396 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 0.00695 (QuantReg: 0.13319) QuantErr: 0.13319 batch_time=0.44523 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 0.00638 (QuantReg: 0.13536) QuantErr: 0.13536 batch_time=1.11976 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 0.00739 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.43590 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 0.00874 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=0.42718 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 0.00714 (QuantReg: 0.13481) QuantErr: 0.13481 batch_time=0.47754 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 0.00639 (QuantReg: 0.13561) QuantErr: 0.13561 batch_time=2.83657 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 0.00612 (QuantReg: 0.13445) QuantErr: 0.13445 batch_time=0.44482 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 0.00645 (QuantReg: 0.13572) QuantErr: 0.13572 batch_time=0.46493 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 0.00628 (QuantReg: 0.13377) QuantErr: 0.13377 batch_time=0.43907 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch10.pth ...
Done in 4.195s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 0.006518417358398437
 quant_reg      : 0.13508903270959854
 quant_err      : 0.13508903270959854
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_miech_test/t2v_metrics/R1: 9.1
 MSRVTT_miech_test/t2v_metrics/R5: 32.2
 MSRVTT_miech_test/t2v_metrics/R10: 47.2
 MSRVTT_miech_test/t2v_metrics/R50: 82.4
 MSRVTT_miech_test/t2v_metrics/MedR: 12.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 40.544
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.00378643962541
 MSRVTT_miech_test/v2t_metrics/R1: 9.3
 MSRVTT_miech_test/v2t_metrics/R5: 32.7
 MSRVTT_miech_test/v2t_metrics/R10: 47.5
 MSRVTT_miech_test/v2t_metrics/R50: 83.3
 MSRVTT_miech_test/v2t_metrics/MedR: 12.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 38.876
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.354250586483833
 mnt_best       : 24.017078122301008
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 0.00443 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=30.20116 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 0.00635 (QuantReg: 0.13640) QuantErr: 0.13640 batch_time=0.44432 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 0.00463 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.43562 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 0.00463 (QuantReg: 0.13536) QuantErr: 0.13536 batch_time=0.43410 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 0.00670 (QuantReg: 0.13310) QuantErr: 0.13310 batch_time=0.43321 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 0.00882 (QuantReg: 0.13262) QuantErr: 0.13262 batch_time=0.46902 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 0.00759 (QuantReg: 0.13316) QuantErr: 0.13316 batch_time=1.50659 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 0.00352 (QuantReg: 0.13612) QuantErr: 0.13612 batch_time=0.44978 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 0.00793 (QuantReg: 0.13460) QuantErr: 0.13460 batch_time=0.46776 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 0.00631 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.42201 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 0.00531 (QuantReg: 0.13536) QuantErr: 0.13536 batch_time=0.44448 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 0.00585 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.42259 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 0.00720 (QuantReg: 0.13512) QuantErr: 0.13512 batch_time=0.44198 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 0.00452 (QuantReg: 0.13775) QuantErr: 0.13775 batch_time=0.43024 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 0.00492 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=0.49432 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 0.00605 (QuantReg: 0.13436) QuantErr: 0.13436 batch_time=0.43485 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 0.00489 (QuantReg: 0.13308) QuantErr: 0.13308 batch_time=0.46140 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 0.00422 (QuantReg: 0.13553) QuantErr: 0.13553 batch_time=0.41225 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 0.00646 (QuantReg: 0.13667) QuantErr: 0.13667 batch_time=0.43057 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 0.00418 (QuantReg: 0.13358) QuantErr: 0.13358 batch_time=0.41781 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 0.00515 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.45989 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 0.00615 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=0.44501 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 0.00504 (QuantReg: 0.13541) QuantErr: 0.13541 batch_time=0.43877 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch11.pth ...
Done in 14.691s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch11.pth ...
Done in 18.534s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 0.00585369873046875
 quant_reg      : 0.13483017587661744
 quant_err      : 0.13483017587661744
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_miech_test/t2v_metrics/R1: 9.0
 MSRVTT_miech_test/t2v_metrics/R5: 34.4
 MSRVTT_miech_test/t2v_metrics/R10: 49.9
 MSRVTT_miech_test/t2v_metrics/R50: 83.2
 MSRVTT_miech_test/t2v_metrics/MedR: 11.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 40.151
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.905800168143085
 MSRVTT_miech_test/v2t_metrics/R1: 10.4
 MSRVTT_miech_test/v2t_metrics/R5: 32.7
 MSRVTT_miech_test/v2t_metrics/R10: 45.5
 MSRVTT_miech_test/v2t_metrics/R50: 81.8
 MSRVTT_miech_test/v2t_metrics/MedR: 12.75
 MSRVTT_miech_test/v2t_metrics/MeanR: 37.76
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.919012591556655
 mnt_best       : 24.905800168143085
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 0.00633 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=29.71834 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 0.00785 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.50649 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 0.00525 (QuantReg: 0.13719) QuantErr: 0.13719 batch_time=0.42385 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 0.00542 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=0.57608 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 0.00587 (QuantReg: 0.13587) QuantErr: 0.13587 batch_time=0.44937 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 0.00632 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.43127 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 0.00650 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=0.41785 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 0.00483 (QuantReg: 0.13584) QuantErr: 0.13584 batch_time=0.43386 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 0.00514 (QuantReg: 0.13415) QuantErr: 0.13415 batch_time=0.47526 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 0.00715 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=0.42479 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 0.00474 (QuantReg: 0.13351) QuantErr: 0.13351 batch_time=0.42758 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 0.00480 (QuantReg: 0.13407) QuantErr: 0.13407 batch_time=0.42155 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 0.00534 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.53981 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 0.00538 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.42808 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 0.00359 (QuantReg: 0.13406) QuantErr: 0.13406 batch_time=0.43829 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 0.00472 (QuantReg: 0.13583) QuantErr: 0.13583 batch_time=0.44596 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 0.00517 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.42639 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 0.00412 (QuantReg: 0.13415) QuantErr: 0.13415 batch_time=0.43472 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 0.00581 (QuantReg: 0.13492) QuantErr: 0.13492 batch_time=0.85098 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 0.00406 (QuantReg: 0.13345) QuantErr: 0.13345 batch_time=0.66804 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 0.00331 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.54905 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 0.00526 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=0.43008 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 0.00589 (QuantReg: 0.13542) QuantErr: 0.13542 batch_time=0.47466 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch12.pth ...
Done in 4.001s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch12.pth ...
Done in 7.918s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 0.005613990783691406
 quant_reg      : 0.134960775077343
 quant_err      : 0.134960775077343
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_miech_test/t2v_metrics/R1: 11.7
 MSRVTT_miech_test/t2v_metrics/R5: 35.5
 MSRVTT_miech_test/t2v_metrics/R10: 49.0
 MSRVTT_miech_test/t2v_metrics/R50: 82.0
 MSRVTT_miech_test/t2v_metrics/MedR: 11.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 38.85
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.302563861773148
 MSRVTT_miech_test/v2t_metrics/R1: 10.6
 MSRVTT_miech_test/v2t_metrics/R5: 34.4
 MSRVTT_miech_test/v2t_metrics/R10: 49.0
 MSRVTT_miech_test/v2t_metrics/R50: 83.3
 MSRVTT_miech_test/v2t_metrics/MedR: 11.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 36.223
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.142881998187587
 mnt_best       : 27.302563861773148
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 0.00665 (QuantReg: 0.13299) QuantErr: 0.13299 batch_time=27.37090 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 0.00408 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=0.48005 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 0.00597 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=0.41394 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 0.00535 (QuantReg: 0.13449) QuantErr: 0.13449 batch_time=0.43380 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 0.00642 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.42071 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 0.00414 (QuantReg: 0.13665) QuantErr: 0.13665 batch_time=0.47996 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 0.00688 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.44849 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 0.00499 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=0.42456 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 0.00495 (QuantReg: 0.13519) QuantErr: 0.13519 batch_time=0.44927 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 0.00554 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.42497 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 0.00597 (QuantReg: 0.13425) QuantErr: 0.13425 batch_time=0.46117 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 0.00643 (QuantReg: 0.13308) QuantErr: 0.13308 batch_time=0.44645 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 0.00612 (QuantReg: 0.13321) QuantErr: 0.13321 batch_time=0.44550 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 0.00596 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=0.44808 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 0.00659 (QuantReg: 0.13363) QuantErr: 0.13363 batch_time=0.45422 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 0.00785 (QuantReg: 0.13383) QuantErr: 0.13383 batch_time=0.44303 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 0.00438 (QuantReg: 0.13313) QuantErr: 0.13313 batch_time=0.43207 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 0.00451 (QuantReg: 0.13355) QuantErr: 0.13355 batch_time=0.48521 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 0.00738 (QuantReg: 0.13297) QuantErr: 0.13297 batch_time=0.42968 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 0.00682 (QuantReg: 0.13091) QuantErr: 0.13091 batch_time=0.44615 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 0.00469 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=0.42492 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 0.00592 (QuantReg: 0.13347) QuantErr: 0.13347 batch_time=0.43924 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 0.00480 (QuantReg: 0.13295) QuantErr: 0.13295 batch_time=0.47319 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch13.pth ...
Done in 5.750s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch13.pth ...
Done in 9.717s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 0.005287498474121094
 quant_reg      : 0.1342472143769264
 quant_err      : 0.1342472143769264
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_miech_test/t2v_metrics/R1: 11.9
 MSRVTT_miech_test/t2v_metrics/R5: 36.1
 MSRVTT_miech_test/t2v_metrics/R10: 50.8
 MSRVTT_miech_test/t2v_metrics/R50: 82.4
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 38.935
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.945118690824852
 MSRVTT_miech_test/v2t_metrics/R1: 11.3
 MSRVTT_miech_test/v2t_metrics/R5: 34.0
 MSRVTT_miech_test/v2t_metrics/R10: 49.7
 MSRVTT_miech_test/v2t_metrics/R50: 83.2
 MSRVTT_miech_test/v2t_metrics/MedR: 11.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 36.745
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.728294617896665
 mnt_best       : 27.945118690824852
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 0.00315 (QuantReg: 0.13315) QuantErr: 0.13315 batch_time=25.78187 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 0.00543 (QuantReg: 0.13434) QuantErr: 0.13434 batch_time=0.45133 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 0.00455 (QuantReg: 0.13289) QuantErr: 0.13289 batch_time=0.43930 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 0.00510 (QuantReg: 0.13308) QuantErr: 0.13308 batch_time=0.43456 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 0.00478 (QuantReg: 0.13426) QuantErr: 0.13426 batch_time=0.43404 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 0.00433 (QuantReg: 0.13364) QuantErr: 0.13364 batch_time=0.44954 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 0.00469 (QuantReg: 0.13412) QuantErr: 0.13412 batch_time=1.65259 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 0.00397 (QuantReg: 0.13396) QuantErr: 0.13396 batch_time=0.42222 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 0.00483 (QuantReg: 0.13328) QuantErr: 0.13328 batch_time=1.48910 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 0.00428 (QuantReg: 0.13405) QuantErr: 0.13405 batch_time=0.42465 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 0.00418 (QuantReg: 0.13422) QuantErr: 0.13422 batch_time=0.42881 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 0.00409 (QuantReg: 0.13306) QuantErr: 0.13306 batch_time=0.41041 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 0.00440 (QuantReg: 0.13449) QuantErr: 0.13449 batch_time=0.42542 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 0.00562 (QuantReg: 0.13246) QuantErr: 0.13246 batch_time=0.48207 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 0.00463 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.41650 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 0.00382 (QuantReg: 0.13502) QuantErr: 0.13502 batch_time=0.42719 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 0.00528 (QuantReg: 0.13617) QuantErr: 0.13617 batch_time=0.43413 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 0.00337 (QuantReg: 0.13359) QuantErr: 0.13359 batch_time=0.42495 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 0.00483 (QuantReg: 0.13340) QuantErr: 0.13340 batch_time=0.41933 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 0.00353 (QuantReg: 0.13314) QuantErr: 0.13314 batch_time=1.00899 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 0.00381 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=2.14548 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 0.00399 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.41881 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 0.00415 (QuantReg: 0.13380) QuantErr: 0.13380 batch_time=0.40716 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch14.pth ...
Done in 4.147s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 0.004935134887695312
 quant_reg      : 0.13401958298683167
 quant_err      : 0.13401958298683167
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_miech_test/t2v_metrics/R1: 11.6
 MSRVTT_miech_test/t2v_metrics/R5: 36.1
 MSRVTT_miech_test/t2v_metrics/R10: 51.0
 MSRVTT_miech_test/t2v_metrics/R50: 83.7
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.309
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.744599224907333
 MSRVTT_miech_test/v2t_metrics/R1: 11.7
 MSRVTT_miech_test/v2t_metrics/R5: 33.5
 MSRVTT_miech_test/v2t_metrics/R10: 50.9
 MSRVTT_miech_test/v2t_metrics/R50: 84.9
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 35.199
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.121652697726404
 mnt_best       : 27.945118690824852
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 0.00640 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=26.26806 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 0.00479 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.45593 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 0.00436 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.47011 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 0.00500 (QuantReg: 0.13420) QuantErr: 0.13420 batch_time=0.56532 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 0.00513 (QuantReg: 0.13460) QuantErr: 0.13460 batch_time=0.59503 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 0.00311 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.46883 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 0.00562 (QuantReg: 0.13351) QuantErr: 0.13351 batch_time=5.67927 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 0.00567 (QuantReg: 0.13327) QuantErr: 0.13327 batch_time=0.46707 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 0.00482 (QuantReg: 0.13342) QuantErr: 0.13342 batch_time=0.44150 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 0.00515 (QuantReg: 0.13238) QuantErr: 0.13238 batch_time=0.42055 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 0.00537 (QuantReg: 0.13274) QuantErr: 0.13274 batch_time=0.44003 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 0.00448 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.44760 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 0.00394 (QuantReg: 0.13375) QuantErr: 0.13375 batch_time=0.44051 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 0.00529 (QuantReg: 0.13318) QuantErr: 0.13318 batch_time=0.45725 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 0.00314 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=0.43663 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 0.00549 (QuantReg: 0.13243) QuantErr: 0.13243 batch_time=0.43935 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 0.00560 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=0.45380 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 0.00456 (QuantReg: 0.13299) QuantErr: 0.13299 batch_time=0.44391 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 0.00446 (QuantReg: 0.13194) QuantErr: 0.13194 batch_time=0.43358 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 0.00425 (QuantReg: 0.13645) QuantErr: 0.13645 batch_time=0.62732 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 0.00534 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.43215 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 0.00520 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.43835 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 0.00390 (QuantReg: 0.13296) QuantErr: 0.13296 batch_time=0.46304 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch15.pth ...
Done in 18.207s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 0.00478167724609375
 quant_reg      : 0.134310448884964
 quant_err      : 0.134310448884964
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_miech_test/t2v_metrics/R1: 11.6
 MSRVTT_miech_test/t2v_metrics/R5: 35.4
 MSRVTT_miech_test/t2v_metrics/R10: 49.7
 MSRVTT_miech_test/t2v_metrics/R50: 84.0
 MSRVTT_miech_test/t2v_metrics/MedR: 11.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.515
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.32787610001287
 MSRVTT_miech_test/v2t_metrics/R1: 12.0
 MSRVTT_miech_test/v2t_metrics/R5: 36.1
 MSRVTT_miech_test/v2t_metrics/R10: 51.6
 MSRVTT_miech_test/v2t_metrics/R50: 84.4
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.669
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.16951587406599
 mnt_best       : 27.945118690824852
 not_improved_count: 2
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 0.00352 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=29.38869 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 0.00581 (QuantReg: 0.13387) QuantErr: 0.13387 batch_time=0.45804 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 0.00539 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.42791 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 0.00495 (QuantReg: 0.13367) QuantErr: 0.13367 batch_time=0.45503 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 0.00419 (QuantReg: 0.13644) QuantErr: 0.13644 batch_time=0.44728 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 0.00672 (QuantReg: 0.13387) QuantErr: 0.13387 batch_time=0.43674 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 0.00694 (QuantReg: 0.13561) QuantErr: 0.13561 batch_time=0.44226 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 0.00445 (QuantReg: 0.13468) QuantErr: 0.13468 batch_time=0.42286 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 0.00439 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.46382 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 0.00525 (QuantReg: 0.13484) QuantErr: 0.13484 batch_time=0.45941 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 0.00420 (QuantReg: 0.13307) QuantErr: 0.13307 batch_time=0.42985 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 0.00401 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.46880 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 0.00395 (QuantReg: 0.13451) QuantErr: 0.13451 batch_time=0.45416 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 0.00547 (QuantReg: 0.13527) QuantErr: 0.13527 batch_time=2.52470 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 0.00377 (QuantReg: 0.13389) QuantErr: 0.13389 batch_time=0.46840 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 0.00482 (QuantReg: 0.13245) QuantErr: 0.13245 batch_time=0.45104 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 0.00469 (QuantReg: 0.13368) QuantErr: 0.13368 batch_time=0.43553 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 0.00730 (QuantReg: 0.13199) QuantErr: 0.13199 batch_time=0.44193 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 0.00607 (QuantReg: 0.13560) QuantErr: 0.13560 batch_time=0.43941 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 0.00455 (QuantReg: 0.13671) QuantErr: 0.13671 batch_time=0.44536 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 0.00383 (QuantReg: 0.13436) QuantErr: 0.13436 batch_time=0.47317 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 0.00414 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=0.42669 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 0.00526 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.43621 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch16.pth ...
Done in 3.927s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch16.pth ...
Done in 7.800s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 0.004735565185546875
 quant_reg      : 0.13410751813650132
 quant_err      : 0.13410751813650132
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_miech_test/t2v_metrics/R1: 12.6
 MSRVTT_miech_test/t2v_metrics/R5: 38.2
 MSRVTT_miech_test/t2v_metrics/R10: 52.9
 MSRVTT_miech_test/t2v_metrics/R50: 83.6
 MSRVTT_miech_test/t2v_metrics/MedR: 9.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.328
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.419132347507926
 MSRVTT_miech_test/v2t_metrics/R1: 12.9
 MSRVTT_miech_test/v2t_metrics/R5: 35.9
 MSRVTT_miech_test/v2t_metrics/R10: 52.1
 MSRVTT_miech_test/v2t_metrics/R50: 84.9
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.438
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.896192871016616
 mnt_best       : 29.419132347507926
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 0.00397 (QuantReg: 0.13153) QuantErr: 0.13153 batch_time=27.18867 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 0.00491 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=0.43525 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 0.00388 (QuantReg: 0.13280) QuantErr: 0.13280 batch_time=1.54278 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 0.00347 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.55077 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 0.00603 (QuantReg: 0.13380) QuantErr: 0.13380 batch_time=0.55706 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 0.00309 (QuantReg: 0.13445) QuantErr: 0.13445 batch_time=0.42465 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 0.00350 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.55133 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 0.00356 (QuantReg: 0.13373) QuantErr: 0.13373 batch_time=0.44069 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 0.00428 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.41957 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 0.00359 (QuantReg: 0.13251) QuantErr: 0.13251 batch_time=0.75919 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 0.00460 (QuantReg: 0.13258) QuantErr: 0.13258 batch_time=0.48477 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 0.00510 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.43571 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 0.00401 (QuantReg: 0.13358) QuantErr: 0.13358 batch_time=6.00152 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 0.00421 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=0.42630 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 0.00453 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.44705 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 0.00735 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=0.46863 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 0.00302 (QuantReg: 0.13244) QuantErr: 0.13244 batch_time=0.42643 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 0.00555 (QuantReg: 0.13410) QuantErr: 0.13410 batch_time=0.44037 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 0.00391 (QuantReg: 0.13414) QuantErr: 0.13414 batch_time=0.42765 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 0.00480 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.45755 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 0.00405 (QuantReg: 0.13507) QuantErr: 0.13507 batch_time=0.42982 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 0.00519 (QuantReg: 0.13496) QuantErr: 0.13496 batch_time=0.49852 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 0.00420 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.44202 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch17.pth ...
Done in 4.296s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 0.004459068298339843
 quant_reg      : 0.13398552960157395
 quant_err      : 0.13398552960157395
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_miech_test/t2v_metrics/R1: 11.0
 MSRVTT_miech_test/t2v_metrics/R5: 35.5
 MSRVTT_miech_test/t2v_metrics/R10: 51.2
 MSRVTT_miech_test/t2v_metrics/R50: 82.5
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 39.412
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.14128047826272
 MSRVTT_miech_test/v2t_metrics/R1: 12.2
 MSRVTT_miech_test/v2t_metrics/R5: 34.9
 MSRVTT_miech_test/v2t_metrics/R10: 50.2
 MSRVTT_miech_test/v2t_metrics/R50: 83.2
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 36.345
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.752130237138463
 mnt_best       : 29.419132347507926
 not_improved_count: 1
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 0.00399 (QuantReg: 0.13549) QuantErr: 0.13549 batch_time=31.85329 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 0.00541 (QuantReg: 0.13460) QuantErr: 0.13460 batch_time=0.49538 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 0.00431 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.41392 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 0.00278 (QuantReg: 0.13558) QuantErr: 0.13558 batch_time=0.41889 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 0.00341 (QuantReg: 0.13585) QuantErr: 0.13585 batch_time=0.46477 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 0.00312 (QuantReg: 0.13397) QuantErr: 0.13397 batch_time=0.41041 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 0.00404 (QuantReg: 0.13661) QuantErr: 0.13661 batch_time=0.44629 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 0.00436 (QuantReg: 0.13447) QuantErr: 0.13447 batch_time=0.43632 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 0.00531 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.41215 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 0.00339 (QuantReg: 0.13379) QuantErr: 0.13379 batch_time=0.43717 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 0.00416 (QuantReg: 0.13456) QuantErr: 0.13456 batch_time=0.42108 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 0.00566 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.46819 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 0.00448 (QuantReg: 0.13642) QuantErr: 0.13642 batch_time=0.43048 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 0.00284 (QuantReg: 0.13417) QuantErr: 0.13417 batch_time=0.43437 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 0.00369 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=0.43184 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 0.00396 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.43819 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 0.00410 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.42302 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 0.00558 (QuantReg: 0.13408) QuantErr: 0.13408 batch_time=0.45772 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 0.00404 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.44670 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 0.00447 (QuantReg: 0.13387) QuantErr: 0.13387 batch_time=0.44969 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 0.00375 (QuantReg: 0.13414) QuantErr: 0.13414 batch_time=0.45195 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 0.00402 (QuantReg: 0.13477) QuantErr: 0.13477 batch_time=0.46126 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 0.00387 (QuantReg: 0.13369) QuantErr: 0.13369 batch_time=0.42584 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch18.pth ...
Done in 4.132s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 0.004235595703125
 quant_reg      : 0.13483116805553436
 quant_err      : 0.13483116805553436
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_miech_test/t2v_metrics/R1: 11.8
 MSRVTT_miech_test/t2v_metrics/R5: 38.2
 MSRVTT_miech_test/t2v_metrics/R10: 53.6
 MSRVTT_miech_test/t2v_metrics/R50: 83.5
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.818
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.909243021567605
 MSRVTT_miech_test/v2t_metrics/R1: 13.1
 MSRVTT_miech_test/v2t_metrics/R5: 36.2
 MSRVTT_miech_test/v2t_metrics/R10: 53.6
 MSRVTT_miech_test/v2t_metrics/R50: 84.3
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.12
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.402316753277063
 mnt_best       : 29.419132347507926
 not_improved_count: 2
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 0.00227 (QuantReg: 0.13501) QuantErr: 0.13501 batch_time=32.59169 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 0.00405 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.45341 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 0.00306 (QuantReg: 0.13445) QuantErr: 0.13445 batch_time=0.42684 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 0.00308 (QuantReg: 0.13415) QuantErr: 0.13415 batch_time=0.43732 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 0.00315 (QuantReg: 0.13798) QuantErr: 0.13798 batch_time=0.43071 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 0.00394 (QuantReg: 0.13286) QuantErr: 0.13286 batch_time=0.44071 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 0.00376 (QuantReg: 0.13400) QuantErr: 0.13400 batch_time=0.43199 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 0.00492 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.43747 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 0.00430 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.47362 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 0.00268 (QuantReg: 0.13779) QuantErr: 0.13779 batch_time=0.42349 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 0.00362 (QuantReg: 0.13494) QuantErr: 0.13494 batch_time=0.48982 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 0.00363 (QuantReg: 0.13568) QuantErr: 0.13568 batch_time=0.42663 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 0.00499 (QuantReg: 0.13338) QuantErr: 0.13338 batch_time=0.48654 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 0.00386 (QuantReg: 0.13773) QuantErr: 0.13773 batch_time=0.43001 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 0.00546 (QuantReg: 0.13366) QuantErr: 0.13366 batch_time=0.43207 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 0.00239 (QuantReg: 0.13480) QuantErr: 0.13480 batch_time=0.45746 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 0.00358 (QuantReg: 0.13676) QuantErr: 0.13676 batch_time=0.42741 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 0.00384 (QuantReg: 0.13647) QuantErr: 0.13647 batch_time=0.46501 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 0.00370 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.43031 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 0.00500 (QuantReg: 0.13478) QuantErr: 0.13478 batch_time=1.12281 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 0.00460 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.43356 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 0.00323 (QuantReg: 0.13542) QuantErr: 0.13542 batch_time=0.42015 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 0.00399 (QuantReg: 0.13729) QuantErr: 0.13729 batch_time=0.46519 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch19.pth ...
Done in 18.407s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch19.pth ...
Done in 22.413s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 0.004097160339355469
 quant_reg      : 0.13530495589971542
 quant_err      : 0.13530495589971542
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_miech_test/t2v_metrics/R1: 13.4
 MSRVTT_miech_test/t2v_metrics/R5: 38.6
 MSRVTT_miech_test/t2v_metrics/R10: 52.1
 MSRVTT_miech_test/t2v_metrics/R50: 82.6
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 38.059
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.9808040160561
 MSRVTT_miech_test/v2t_metrics/R1: 11.8
 MSRVTT_miech_test/v2t_metrics/R5: 36.2
 MSRVTT_miech_test/v2t_metrics/R10: 51.2
 MSRVTT_miech_test/v2t_metrics/R50: 84.7
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.633
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.96534488075155
 mnt_best       : 29.9808040160561
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 0.00343 (QuantReg: 0.13550) QuantErr: 0.13550 batch_time=27.53237 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 0.00344 (QuantReg: 0.13662) QuantErr: 0.13662 batch_time=0.41537 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 0.00418 (QuantReg: 0.13388) QuantErr: 0.13388 batch_time=0.43748 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 0.00359 (QuantReg: 0.13569) QuantErr: 0.13569 batch_time=0.91092 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 0.00346 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=0.45256 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 0.00287 (QuantReg: 0.13413) QuantErr: 0.13413 batch_time=0.40998 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 0.00397 (QuantReg: 0.13599) QuantErr: 0.13599 batch_time=0.41159 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 0.00412 (QuantReg: 0.13368) QuantErr: 0.13368 batch_time=4.90629 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 0.00256 (QuantReg: 0.13443) QuantErr: 0.13443 batch_time=0.51529 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 0.00392 (QuantReg: 0.13733) QuantErr: 0.13733 batch_time=0.44206 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 0.00393 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.43904 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 0.00412 (QuantReg: 0.13377) QuantErr: 0.13377 batch_time=0.46622 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 0.00293 (QuantReg: 0.13473) QuantErr: 0.13473 batch_time=0.78784 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 0.00307 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.43213 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 0.00294 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.41421 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 0.00300 (QuantReg: 0.13597) QuantErr: 0.13597 batch_time=0.45164 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 0.00515 (QuantReg: 0.13481) QuantErr: 0.13481 batch_time=0.44611 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 0.00283 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.77036 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 0.00314 (QuantReg: 0.13514) QuantErr: 0.13514 batch_time=0.42120 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 0.00268 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.43993 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 0.00474 (QuantReg: 0.13754) QuantErr: 0.13754 batch_time=0.42182 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 0.00409 (QuantReg: 0.13528) QuantErr: 0.13528 batch_time=0.42172 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 0.00321 (QuantReg: 0.13627) QuantErr: 0.13627 batch_time=0.43655 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch20.pth ...
Done in 4.204s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch20.pth ...
Done in 8.275s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 0.0037389678955078126
 quant_reg      : 0.1354394416809082
 quant_err      : 0.1354394416809082
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_miech_test/t2v_metrics/R1: 13.7
 MSRVTT_miech_test/t2v_metrics/R5: 37.9
 MSRVTT_miech_test/t2v_metrics/R10: 53.4
 MSRVTT_miech_test/t2v_metrics/R50: 83.9
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.497
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.26683515229834
 MSRVTT_miech_test/v2t_metrics/R1: 12.0
 MSRVTT_miech_test/v2t_metrics/R5: 36.2
 MSRVTT_miech_test/v2t_metrics/R10: 51.3
 MSRVTT_miech_test/v2t_metrics/R50: 83.9
 MSRVTT_miech_test/v2t_metrics/MedR: 10.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.345
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.140753840716943
 mnt_best       : 30.26683515229834
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 0.00605 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=27.78269 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 0.00348 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=0.43891 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 0.00343 (QuantReg: 0.13677) QuantErr: 0.13677 batch_time=0.49348 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 0.00382 (QuantReg: 0.13509) QuantErr: 0.13509 batch_time=0.45191 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 0.00320 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.48425 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 0.00397 (QuantReg: 0.13348) QuantErr: 0.13348 batch_time=0.44804 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 0.00351 (QuantReg: 0.13623) QuantErr: 0.13623 batch_time=0.43135 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 0.00330 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.43937 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 0.00540 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.43861 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 0.00360 (QuantReg: 0.13373) QuantErr: 0.13373 batch_time=0.43840 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 0.00430 (QuantReg: 0.13401) QuantErr: 0.13401 batch_time=0.50298 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 0.00380 (QuantReg: 0.13406) QuantErr: 0.13406 batch_time=0.44097 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 0.00407 (QuantReg: 0.13351) QuantErr: 0.13351 batch_time=4.52843 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 0.00369 (QuantReg: 0.13399) QuantErr: 0.13399 batch_time=0.43592 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 0.00309 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.44997 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 0.00327 (QuantReg: 0.13674) QuantErr: 0.13674 batch_time=0.46004 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 0.00202 (QuantReg: 0.13461) QuantErr: 0.13461 batch_time=0.48875 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 0.00368 (QuantReg: 0.13584) QuantErr: 0.13584 batch_time=0.44107 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 0.00331 (QuantReg: 0.13604) QuantErr: 0.13604 batch_time=0.43549 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 0.00456 (QuantReg: 0.13277) QuantErr: 0.13277 batch_time=0.45402 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 0.00590 (QuantReg: 0.13258) QuantErr: 0.13258 batch_time=0.45017 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 0.00371 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=0.44265 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 0.00382 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.43851 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch21.pth ...
Done in 6.064s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 0.003715118408203125
 quant_reg      : 0.13496177750825883
 quant_err      : 0.13496177750825883
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_miech_test/t2v_metrics/R1: 12.8
 MSRVTT_miech_test/t2v_metrics/R5: 39.7
 MSRVTT_miech_test/t2v_metrics/R10: 54.0
 MSRVTT_miech_test/t2v_metrics/R50: 83.7
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.049
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.162320154916095
 MSRVTT_miech_test/v2t_metrics/R1: 14.1
 MSRVTT_miech_test/v2t_metrics/R5: 39.2
 MSRVTT_miech_test/v2t_metrics/R10: 54.0
 MSRVTT_miech_test/v2t_metrics/R50: 84.9
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 32.620000000000005
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.019370481334036
 mnt_best       : 30.26683515229834
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 0.00242 (QuantReg: 0.13344) QuantErr: 0.13344 batch_time=30.89323 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 0.00507 (QuantReg: 0.13407) QuantErr: 0.13407 batch_time=0.42882 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 0.00480 (QuantReg: 0.13485) QuantErr: 0.13485 batch_time=0.41150 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 0.00251 (QuantReg: 0.13541) QuantErr: 0.13541 batch_time=0.48182 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 0.00297 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.45382 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 0.00603 (QuantReg: 0.13301) QuantErr: 0.13301 batch_time=0.42146 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 0.00328 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=3.10427 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 0.00535 (QuantReg: 0.13366) QuantErr: 0.13366 batch_time=0.54311 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 0.00303 (QuantReg: 0.13353) QuantErr: 0.13353 batch_time=0.44683 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 0.00344 (QuantReg: 0.13241) QuantErr: 0.13241 batch_time=0.43109 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 0.00321 (QuantReg: 0.13397) QuantErr: 0.13397 batch_time=0.44552 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 0.00262 (QuantReg: 0.13375) QuantErr: 0.13375 batch_time=0.43680 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 0.00414 (QuantReg: 0.13457) QuantErr: 0.13457 batch_time=0.42070 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 0.00365 (QuantReg: 0.13383) QuantErr: 0.13383 batch_time=0.46264 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 0.00453 (QuantReg: 0.13383) QuantErr: 0.13383 batch_time=0.43834 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 0.00232 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.47521 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 0.00415 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.44247 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 0.00380 (QuantReg: 0.13294) QuantErr: 0.13294 batch_time=0.41471 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 0.00290 (QuantReg: 0.13477) QuantErr: 0.13477 batch_time=0.44002 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 0.00399 (QuantReg: 0.13526) QuantErr: 0.13526 batch_time=2.02867 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 0.00430 (QuantReg: 0.13417) QuantErr: 0.13417 batch_time=0.44054 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 0.00272 (QuantReg: 0.13536) QuantErr: 0.13536 batch_time=0.43442 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 0.00416 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.44848 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch22.pth ...
Done in 17.753s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch22.pth ...
Done in 21.802s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 0.0036329879760742187
 quant_reg      : 0.13415624314546584
 quant_err      : 0.13415624314546584
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_miech_test/t2v_metrics/R1: 14.1
 MSRVTT_miech_test/t2v_metrics/R5: 39.4
 MSRVTT_miech_test/t2v_metrics/R10: 53.6
 MSRVTT_miech_test/t2v_metrics/R50: 83.8
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 38.229
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.99512375608212
 MSRVTT_miech_test/v2t_metrics/R1: 13.6
 MSRVTT_miech_test/v2t_metrics/R5: 38.2
 MSRVTT_miech_test/v2t_metrics/R10: 52.9
 MSRVTT_miech_test/v2t_metrics/R50: 85.4
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 34.478
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.17768917770083
 mnt_best       : 30.99512375608212
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 0.00294 (QuantReg: 0.13355) QuantErr: 0.13355 batch_time=31.57865 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 0.00372 (QuantReg: 0.13506) QuantErr: 0.13506 batch_time=0.46164 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 0.00340 (QuantReg: 0.13649) QuantErr: 0.13649 batch_time=0.44424 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 0.00251 (QuantReg: 0.13301) QuantErr: 0.13301 batch_time=0.45331 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 0.00331 (QuantReg: 0.13247) QuantErr: 0.13247 batch_time=0.44972 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 0.00473 (QuantReg: 0.13211) QuantErr: 0.13211 batch_time=0.47209 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 0.00714 (QuantReg: 0.13453) QuantErr: 0.13453 batch_time=0.89651 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 0.00404 (QuantReg: 0.13429) QuantErr: 0.13429 batch_time=0.50780 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 0.00393 (QuantReg: 0.13320) QuantErr: 0.13320 batch_time=0.43863 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 0.00267 (QuantReg: 0.13549) QuantErr: 0.13549 batch_time=0.44491 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 0.00317 (QuantReg: 0.13442) QuantErr: 0.13442 batch_time=0.41692 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 0.00374 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=0.44245 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 0.00289 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=0.44722 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 0.00312 (QuantReg: 0.13397) QuantErr: 0.13397 batch_time=0.47759 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 0.00278 (QuantReg: 0.13358) QuantErr: 0.13358 batch_time=0.44777 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 0.00296 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.43769 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 0.00249 (QuantReg: 0.13621) QuantErr: 0.13621 batch_time=0.43195 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 0.00446 (QuantReg: 0.13373) QuantErr: 0.13373 batch_time=0.43301 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 0.00331 (QuantReg: 0.13206) QuantErr: 0.13206 batch_time=0.54432 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 0.00292 (QuantReg: 0.13391) QuantErr: 0.13391 batch_time=0.47045 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 0.00261 (QuantReg: 0.13333) QuantErr: 0.13333 batch_time=0.44051 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 0.00419 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.44630 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 0.00423 (QuantReg: 0.13336) QuantErr: 0.13336 batch_time=0.47972 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch23.pth ...
Done in 11.274s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 0.0033885536193847656
 quant_reg      : 0.13431967824697494
 quant_err      : 0.13431967824697494
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_miech_test/t2v_metrics/R1: 13.5
 MSRVTT_miech_test/t2v_metrics/R5: 40.7
 MSRVTT_miech_test/t2v_metrics/R10: 53.8
 MSRVTT_miech_test/t2v_metrics/R50: 84.5
 MSRVTT_miech_test/t2v_metrics/MedR: 8.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.04
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.91981008894356
 MSRVTT_miech_test/v2t_metrics/R1: 13.6
 MSRVTT_miech_test/v2t_metrics/R5: 38.5
 MSRVTT_miech_test/v2t_metrics/R10: 54.7
 MSRVTT_miech_test/v2t_metrics/R50: 84.9
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 32.0235
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.59583579257372
 mnt_best       : 30.99512375608212
 not_improved_count: 1
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 0.00325 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=27.90513 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 0.00360 (QuantReg: 0.13582) QuantErr: 0.13582 batch_time=0.44729 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 0.00255 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.44134 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 0.00322 (QuantReg: 0.13306) QuantErr: 0.13306 batch_time=0.43270 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 0.00252 (QuantReg: 0.13297) QuantErr: 0.13297 batch_time=0.41540 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 0.00325 (QuantReg: 0.13362) QuantErr: 0.13362 batch_time=0.43414 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 0.00388 (QuantReg: 0.13460) QuantErr: 0.13460 batch_time=1.78822 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 0.00442 (QuantReg: 0.13362) QuantErr: 0.13362 batch_time=0.43106 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 0.00571 (QuantReg: 0.13513) QuantErr: 0.13513 batch_time=0.45022 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 0.00305 (QuantReg: 0.13396) QuantErr: 0.13396 batch_time=0.42569 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 0.00392 (QuantReg: 0.13472) QuantErr: 0.13472 batch_time=0.43161 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 0.00290 (QuantReg: 0.13359) QuantErr: 0.13359 batch_time=0.42883 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 0.00326 (QuantReg: 0.13424) QuantErr: 0.13424 batch_time=2.06336 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 0.00251 (QuantReg: 0.13451) QuantErr: 0.13451 batch_time=0.42853 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 0.00315 (QuantReg: 0.13356) QuantErr: 0.13356 batch_time=0.41249 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 0.00282 (QuantReg: 0.13399) QuantErr: 0.13399 batch_time=0.46733 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.00240 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=0.43732 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 0.00515 (QuantReg: 0.13425) QuantErr: 0.13425 batch_time=0.42652 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 0.00293 (QuantReg: 0.13596) QuantErr: 0.13596 batch_time=0.41854 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 0.00304 (QuantReg: 0.13619) QuantErr: 0.13619 batch_time=0.44791 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 0.00464 (QuantReg: 0.13352) QuantErr: 0.13352 batch_time=0.45721 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 0.00253 (QuantReg: 0.13417) QuantErr: 0.13417 batch_time=0.48973 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 0.00328 (QuantReg: 0.13445) QuantErr: 0.13445 batch_time=0.42389 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch24.pth ...
Done in 10.870s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch24.pth ...
Done in 14.939s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 0.003363727569580078
 quant_reg      : 0.13470921713113784
 quant_err      : 0.13470921713113784
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_miech_test/t2v_metrics/R1: 14.4
 MSRVTT_miech_test/t2v_metrics/R5: 40.2
 MSRVTT_miech_test/t2v_metrics/R10: 54.6
 MSRVTT_miech_test/t2v_metrics/R50: 84.7
 MSRVTT_miech_test/t2v_metrics/MedR: 8.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 36.883
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.617466176057203
 MSRVTT_miech_test/v2t_metrics/R1: 14.2
 MSRVTT_miech_test/v2t_metrics/R5: 39.8
 MSRVTT_miech_test/v2t_metrics/R10: 54.2
 MSRVTT_miech_test/v2t_metrics/R50: 84.8
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 32.457
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.288895610788032
 mnt_best       : 31.617466176057203
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 0.00528 (QuantReg: 0.13506) QuantErr: 0.13506 batch_time=25.31124 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 0.00264 (QuantReg: 0.13377) QuantErr: 0.13377 batch_time=0.43293 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 0.00291 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=0.43387 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 0.00363 (QuantReg: 0.13539) QuantErr: 0.13539 batch_time=0.45488 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 0.00354 (QuantReg: 0.13515) QuantErr: 0.13515 batch_time=0.42320 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 0.00220 (QuantReg: 0.13230) QuantErr: 0.13230 batch_time=0.45392 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 0.00310 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=0.65430 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 0.00258 (QuantReg: 0.13355) QuantErr: 0.13355 batch_time=0.53786 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 0.00356 (QuantReg: 0.13442) QuantErr: 0.13442 batch_time=0.44361 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 0.00233 (QuantReg: 0.13226) QuantErr: 0.13226 batch_time=0.43769 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 0.00349 (QuantReg: 0.13637) QuantErr: 0.13637 batch_time=0.41907 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 0.00204 (QuantReg: 0.13619) QuantErr: 0.13619 batch_time=0.44167 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 0.00281 (QuantReg: 0.13234) QuantErr: 0.13234 batch_time=0.88514 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 0.00318 (QuantReg: 0.13405) QuantErr: 0.13405 batch_time=6.39317 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 0.00286 (QuantReg: 0.13271) QuantErr: 0.13271 batch_time=0.41968 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 0.00175 (QuantReg: 0.13420) QuantErr: 0.13420 batch_time=0.41728 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 0.00372 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.40948 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 0.00466 (QuantReg: 0.13563) QuantErr: 0.13563 batch_time=0.44935 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.00545 (QuantReg: 0.13789) QuantErr: 0.13789 batch_time=0.41299 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 0.00252 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.42009 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 0.00385 (QuantReg: 0.13275) QuantErr: 0.13275 batch_time=0.42205 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 0.00227 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=0.42531 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 0.00311 (QuantReg: 0.13477) QuantErr: 0.13477 batch_time=0.44932 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch25.pth ...
Done in 18.182s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 0.0033023643493652346
 quant_reg      : 0.13473867022991182
 quant_err      : 0.13473867022991182
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_miech_test/t2v_metrics/R1: 13.7
 MSRVTT_miech_test/t2v_metrics/R5: 40.2
 MSRVTT_miech_test/t2v_metrics/R10: 54.9
 MSRVTT_miech_test/t2v_metrics/R50: 84.2
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.523
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.153462424312245
 MSRVTT_miech_test/v2t_metrics/R1: 14.1
 MSRVTT_miech_test/v2t_metrics/R5: 39.6
 MSRVTT_miech_test/v2t_metrics/R10: 54.6
 MSRVTT_miech_test/v2t_metrics/R50: 84.5
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 32.5985
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.239373368133187
 mnt_best       : 31.617466176057203
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 0.00327 (QuantReg: 0.13269) QuantErr: 0.13269 batch_time=29.36299 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 0.00316 (QuantReg: 0.13501) QuantErr: 0.13501 batch_time=0.43406 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 0.00378 (QuantReg: 0.13535) QuantErr: 0.13535 batch_time=0.46738 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 0.00361 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.42382 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 0.00348 (QuantReg: 0.13717) QuantErr: 0.13717 batch_time=0.43723 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 0.00418 (QuantReg: 0.13469) QuantErr: 0.13469 batch_time=0.42398 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 0.00303 (QuantReg: 0.13377) QuantErr: 0.13377 batch_time=0.41313 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 0.00324 (QuantReg: 0.13618) QuantErr: 0.13618 batch_time=0.53429 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 0.00468 (QuantReg: 0.13122) QuantErr: 0.13122 batch_time=0.43839 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 0.00267 (QuantReg: 0.13387) QuantErr: 0.13387 batch_time=0.44506 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.00383 (QuantReg: 0.13261) QuantErr: 0.13261 batch_time=0.41639 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 0.00307 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=0.44887 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 0.00298 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.48295 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 0.00392 (QuantReg: 0.13264) QuantErr: 0.13264 batch_time=0.71809 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 0.00311 (QuantReg: 0.13251) QuantErr: 0.13251 batch_time=0.41808 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 0.00308 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.48830 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 0.00342 (QuantReg: 0.13277) QuantErr: 0.13277 batch_time=0.43154 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 0.00320 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.42867 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 0.00237 (QuantReg: 0.13469) QuantErr: 0.13469 batch_time=0.44528 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 0.00408 (QuantReg: 0.13303) QuantErr: 0.13303 batch_time=0.44416 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 0.00286 (QuantReg: 0.13325) QuantErr: 0.13325 batch_time=0.41713 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 0.00317 (QuantReg: 0.13546) QuantErr: 0.13546 batch_time=0.56306 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 0.00335 (QuantReg: 0.13242) QuantErr: 0.13242 batch_time=0.41945 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch26.pth ...
Done in 9.637s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 0.0032375030517578125
 quant_reg      : 0.13460492306947708
 quant_err      : 0.13460492306947708
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_miech_test/t2v_metrics/R1: 12.9
 MSRVTT_miech_test/t2v_metrics/R5: 38.7
 MSRVTT_miech_test/t2v_metrics/R10: 54.8
 MSRVTT_miech_test/t2v_metrics/R50: 83.8
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.257
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.131938887012407
 MSRVTT_miech_test/v2t_metrics/R1: 13.2
 MSRVTT_miech_test/v2t_metrics/R5: 38.4
 MSRVTT_miech_test/v2t_metrics/R10: 53.9
 MSRVTT_miech_test/v2t_metrics/R50: 85.8
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.337
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.118359090090266
 mnt_best       : 31.617466176057203
 not_improved_count: 2
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 0.00255 (QuantReg: 0.13490) QuantErr: 0.13490 batch_time=26.70084 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 0.00291 (QuantReg: 0.13324) QuantErr: 0.13324 batch_time=0.43513 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 0.00627 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.43509 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 0.00268 (QuantReg: 0.13413) QuantErr: 0.13413 batch_time=0.44975 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 0.00436 (QuantReg: 0.13228) QuantErr: 0.13228 batch_time=0.47674 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 0.00347 (QuantReg: 0.13491) QuantErr: 0.13491 batch_time=0.45443 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 0.00305 (QuantReg: 0.13352) QuantErr: 0.13352 batch_time=0.42343 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 0.00257 (QuantReg: 0.13272) QuantErr: 0.13272 batch_time=0.44415 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 0.00380 (QuantReg: 0.13365) QuantErr: 0.13365 batch_time=0.44147 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 0.00283 (QuantReg: 0.13670) QuantErr: 0.13670 batch_time=0.46634 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 0.00261 (QuantReg: 0.13637) QuantErr: 0.13637 batch_time=0.45221 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 0.00236 (QuantReg: 0.13529) QuantErr: 0.13529 batch_time=0.56102 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 0.00380 (QuantReg: 0.13386) QuantErr: 0.13386 batch_time=0.45121 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 0.00289 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=0.43203 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 0.00254 (QuantReg: 0.13238) QuantErr: 0.13238 batch_time=0.42171 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 0.00354 (QuantReg: 0.13611) QuantErr: 0.13611 batch_time=0.41724 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 0.00299 (QuantReg: 0.13219) QuantErr: 0.13219 batch_time=0.44137 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 0.00201 (QuantReg: 0.13377) QuantErr: 0.13377 batch_time=0.44061 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 0.00278 (QuantReg: 0.13289) QuantErr: 0.13289 batch_time=0.42027 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 0.00261 (QuantReg: 0.13264) QuantErr: 0.13264 batch_time=0.48377 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 0.00410 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.43358 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 0.00286 (QuantReg: 0.13255) QuantErr: 0.13255 batch_time=1.09734 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 0.00287 (QuantReg: 0.13441) QuantErr: 0.13441 batch_time=0.44257 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch27.pth ...
Done in 16.764s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 0.0031158332824707032
 quant_reg      : 0.13440914231538773
 quant_err      : 0.13440914231538773
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_miech_test/t2v_metrics/R1: 13.1
 MSRVTT_miech_test/t2v_metrics/R5: 38.7
 MSRVTT_miech_test/t2v_metrics/R10: 55.0
 MSRVTT_miech_test/t2v_metrics/R50: 85.4
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.681
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.323662201549347
 MSRVTT_miech_test/v2t_metrics/R1: 13.7
 MSRVTT_miech_test/v2t_metrics/R5: 40.0
 MSRVTT_miech_test/v2t_metrics/R10: 53.6
 MSRVTT_miech_test/v2t_metrics/R50: 85.2
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 30.944
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.854258663078923
 mnt_best       : 31.617466176057203
 not_improved_count: 3
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 0.00428 (QuantReg: 0.13377) QuantErr: 0.13377 batch_time=26.36852 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 0.00218 (QuantReg: 0.13445) QuantErr: 0.13445 batch_time=0.46783 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.00259 (QuantReg: 0.13612) QuantErr: 0.13612 batch_time=0.43502 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 0.00326 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=0.42853 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 0.00279 (QuantReg: 0.13444) QuantErr: 0.13444 batch_time=0.45079 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 0.00430 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.44433 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 0.00353 (QuantReg: 0.13340) QuantErr: 0.13340 batch_time=0.43619 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 0.00329 (QuantReg: 0.13310) QuantErr: 0.13310 batch_time=0.45217 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 0.00312 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.43559 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 0.00323 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=0.80852 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 0.00241 (QuantReg: 0.13337) QuantErr: 0.13337 batch_time=0.44189 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 0.00258 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.42588 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 0.00256 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.46756 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 0.00294 (QuantReg: 0.13362) QuantErr: 0.13362 batch_time=1.07506 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 0.00423 (QuantReg: 0.13457) QuantErr: 0.13457 batch_time=0.46726 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 0.00245 (QuantReg: 0.13408) QuantErr: 0.13408 batch_time=0.43924 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 0.00254 (QuantReg: 0.13353) QuantErr: 0.13353 batch_time=0.42282 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 0.00360 (QuantReg: 0.13559) QuantErr: 0.13559 batch_time=0.41036 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 0.00354 (QuantReg: 0.13276) QuantErr: 0.13276 batch_time=0.42911 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 0.00347 (QuantReg: 0.13357) QuantErr: 0.13357 batch_time=1.27348 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 0.00329 (QuantReg: 0.13226) QuantErr: 0.13226 batch_time=0.45018 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 0.00217 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.94613 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 0.00212 (QuantReg: 0.13440) QuantErr: 0.13440 batch_time=0.45675 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch28.pth ...
Done in 13.438s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 0.0030286407470703127
 quant_reg      : 0.13415233242511748
 quant_err      : 0.13415233242511748
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_miech_test/t2v_metrics/R1: 13.5
 MSRVTT_miech_test/t2v_metrics/R5: 39.7
 MSRVTT_miech_test/t2v_metrics/R10: 55.5
 MSRVTT_miech_test/t2v_metrics/R50: 85.5
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.924
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.984114302795312
 MSRVTT_miech_test/v2t_metrics/R1: 13.7
 MSRVTT_miech_test/v2t_metrics/R5: 41.4
 MSRVTT_miech_test/v2t_metrics/R10: 55.9
 MSRVTT_miech_test/v2t_metrics/R50: 86.1
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.949
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.650281138237794
 mnt_best       : 31.617466176057203
 not_improved_count: 4
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 0.00315 (QuantReg: 0.13464) QuantErr: 0.13464 batch_time=29.29069 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 0.00270 (QuantReg: 0.13478) QuantErr: 0.13478 batch_time=0.43491 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 0.00271 (QuantReg: 0.13434) QuantErr: 0.13434 batch_time=0.42481 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 0.00341 (QuantReg: 0.13430) QuantErr: 0.13430 batch_time=0.44082 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 0.00194 (QuantReg: 0.13403) QuantErr: 0.13403 batch_time=0.46314 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 0.00232 (QuantReg: 0.13230) QuantErr: 0.13230 batch_time=0.44116 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 0.00277 (QuantReg: 0.13570) QuantErr: 0.13570 batch_time=0.47213 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 0.00234 (QuantReg: 0.13500) QuantErr: 0.13500 batch_time=0.41808 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 0.00245 (QuantReg: 0.13343) QuantErr: 0.13343 batch_time=0.43648 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 0.00286 (QuantReg: 0.13322) QuantErr: 0.13322 batch_time=0.43726 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 0.00226 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=0.44250 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 0.00275 (QuantReg: 0.13533) QuantErr: 0.13533 batch_time=0.47291 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 0.00274 (QuantReg: 0.13496) QuantErr: 0.13496 batch_time=0.44323 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 0.00246 (QuantReg: 0.13338) QuantErr: 0.13338 batch_time=0.44258 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 0.00261 (QuantReg: 0.13499) QuantErr: 0.13499 batch_time=0.89042 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 0.00285 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.42947 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 0.00327 (QuantReg: 0.13397) QuantErr: 0.13397 batch_time=0.44470 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 0.00372 (QuantReg: 0.13587) QuantErr: 0.13587 batch_time=0.47322 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 0.00310 (QuantReg: 0.13622) QuantErr: 0.13622 batch_time=0.42669 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 0.00144 (QuantReg: 0.13441) QuantErr: 0.13441 batch_time=0.44626 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 0.00225 (QuantReg: 0.13295) QuantErr: 0.13295 batch_time=0.43907 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.00335 (QuantReg: 0.13351) QuantErr: 0.13351 batch_time=0.41093 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 0.00215 (QuantReg: 0.13442) QuantErr: 0.13442 batch_time=0.42597 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch29.pth ...
Done in 4.159s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 0.0028288345336914063
 quant_reg      : 0.13445191955566407
 quant_err      : 0.13445191955566407
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_miech_test/t2v_metrics/R1: 13.1
 MSRVTT_miech_test/t2v_metrics/R5: 39.0
 MSRVTT_miech_test/t2v_metrics/R10: 55.9
 MSRVTT_miech_test/t2v_metrics/R50: 85.6
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 36.327
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.566748022147618
 MSRVTT_miech_test/v2t_metrics/R1: 14.6
 MSRVTT_miech_test/v2t_metrics/R5: 39.7
 MSRVTT_miech_test/v2t_metrics/R10: 55.7
 MSRVTT_miech_test/v2t_metrics/R50: 85.6
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.101
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.841939968538156
 mnt_best       : 31.617466176057203
 not_improved_count: 5
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 0.00281 (QuantReg: 0.13716) QuantErr: 0.13716 batch_time=27.22670 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 0.00334 (QuantReg: 0.13319) QuantErr: 0.13319 batch_time=0.46142 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 0.00334 (QuantReg: 0.13730) QuantErr: 0.13730 batch_time=0.43614 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 0.00336 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.50233 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 0.00288 (QuantReg: 0.13542) QuantErr: 0.13542 batch_time=0.43529 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 0.00391 (QuantReg: 0.13792) QuantErr: 0.13792 batch_time=0.43494 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 0.00390 (QuantReg: 0.13660) QuantErr: 0.13660 batch_time=0.41997 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.00240 (QuantReg: 0.13851) QuantErr: 0.13851 batch_time=0.42916 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 0.00277 (QuantReg: 0.13805) QuantErr: 0.13805 batch_time=0.43812 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 0.00258 (QuantReg: 0.13403) QuantErr: 0.13403 batch_time=0.43484 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 0.00198 (QuantReg: 0.13449) QuantErr: 0.13449 batch_time=0.43672 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 0.00371 (QuantReg: 0.13466) QuantErr: 0.13466 batch_time=0.44358 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 0.00195 (QuantReg: 0.13735) QuantErr: 0.13735 batch_time=0.43449 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 0.00308 (QuantReg: 0.13442) QuantErr: 0.13442 batch_time=0.42166 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 0.00280 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.41957 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 0.00400 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.41048 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 0.00269 (QuantReg: 0.13523) QuantErr: 0.13523 batch_time=0.42033 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 0.00231 (QuantReg: 0.13433) QuantErr: 0.13433 batch_time=0.43642 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 0.00328 (QuantReg: 0.13423) QuantErr: 0.13423 batch_time=0.44379 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 0.00330 (QuantReg: 0.13431) QuantErr: 0.13431 batch_time=0.45732 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 0.00303 (QuantReg: 0.13379) QuantErr: 0.13379 batch_time=0.49297 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 0.00335 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.45536 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 0.00386 (QuantReg: 0.13566) QuantErr: 0.13566 batch_time=2.99841 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch30.pth ...
Done in 9.542s
removing stale ckpt [epoch 29] [took 0.01s]
 epoch          : 30
 loss           : 0.002829261779785156
 quant_reg      : 0.13460669785737991
 quant_err      : 0.13460669785737991
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_miech_test/t2v_metrics/R1: 13.4
 MSRVTT_miech_test/t2v_metrics/R5: 39.6
 MSRVTT_miech_test/t2v_metrics/R10: 55.8
 MSRVTT_miech_test/t2v_metrics/R50: 86.3
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.443
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.93699029463277
 MSRVTT_miech_test/v2t_metrics/R1: 14.4
 MSRVTT_miech_test/v2t_metrics/R5: 39.3
 MSRVTT_miech_test/v2t_metrics/R10: 55.8
 MSRVTT_miech_test/v2t_metrics/R50: 87.2
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.862
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.60795612303931
 mnt_best       : 31.617466176057203
 not_improved_count: 6
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 0.00176 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=24.90873 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 0.00238 (QuantReg: 0.13348) QuantErr: 0.13348 batch_time=0.44087 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 0.00271 (QuantReg: 0.13498) QuantErr: 0.13498 batch_time=0.41690 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 0.00300 (QuantReg: 0.13350) QuantErr: 0.13350 batch_time=0.43911 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 0.00323 (QuantReg: 0.13688) QuantErr: 0.13688 batch_time=0.44268 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 0.00332 (QuantReg: 0.13401) QuantErr: 0.13401 batch_time=0.46568 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 0.00256 (QuantReg: 0.13404) QuantErr: 0.13404 batch_time=0.44005 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 0.00380 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.44497 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 0.00214 (QuantReg: 0.13362) QuantErr: 0.13362 batch_time=0.43168 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 0.00308 (QuantReg: 0.13567) QuantErr: 0.13567 batch_time=0.45735 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 0.00377 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.46139 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 0.00277 (QuantReg: 0.13268) QuantErr: 0.13268 batch_time=0.47365 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 0.00307 (QuantReg: 0.13576) QuantErr: 0.13576 batch_time=1.52944 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 0.00224 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.46233 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 0.00311 (QuantReg: 0.13207) QuantErr: 0.13207 batch_time=0.46498 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 0.00294 (QuantReg: 0.13617) QuantErr: 0.13617 batch_time=0.41903 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 0.00471 (QuantReg: 0.13688) QuantErr: 0.13688 batch_time=0.42346 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 0.00215 (QuantReg: 0.13322) QuantErr: 0.13322 batch_time=0.43916 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 0.00241 (QuantReg: 0.13434) QuantErr: 0.13434 batch_time=5.07413 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 0.00335 (QuantReg: 0.13339) QuantErr: 0.13339 batch_time=0.43680 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 0.00309 (QuantReg: 0.13517) QuantErr: 0.13517 batch_time=0.42568 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 0.00299 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.46714 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 0.00216 (QuantReg: 0.13554) QuantErr: 0.13554 batch_time=0.42724 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch31.pth ...
Done in 13.982s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 0.002755523681640625
 quant_reg      : 0.13471579939126968
 quant_err      : 0.13471579939126968
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_miech_test/t2v_metrics/R1: 12.6
 MSRVTT_miech_test/t2v_metrics/R5: 39.3
 MSRVTT_miech_test/t2v_metrics/R10: 55.4
 MSRVTT_miech_test/t2v_metrics/R50: 85.4
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.66
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.15951037815608
 MSRVTT_miech_test/v2t_metrics/R1: 12.7
 MSRVTT_miech_test/v2t_metrics/R5: 40.8
 MSRVTT_miech_test/v2t_metrics/R10: 55.5
 MSRVTT_miech_test/v2t_metrics/R50: 86.5
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.717
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.637426971156778
 mnt_best       : 31.617466176057203
 not_improved_count: 7
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 0.00386 (QuantReg: 0.13443) QuantErr: 0.13443 batch_time=27.99071 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 0.00238 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=2.72575 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 0.00217 (QuantReg: 0.13420) QuantErr: 0.13420 batch_time=0.45394 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 0.00233 (QuantReg: 0.13737) QuantErr: 0.13737 batch_time=0.43842 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.00203 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.44835 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 0.00364 (QuantReg: 0.13431) QuantErr: 0.13431 batch_time=0.44609 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 0.00389 (QuantReg: 0.13383) QuantErr: 0.13383 batch_time=0.45979 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 0.00384 (QuantReg: 0.13461) QuantErr: 0.13461 batch_time=0.42500 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 0.00237 (QuantReg: 0.13664) QuantErr: 0.13664 batch_time=0.43157 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 0.00235 (QuantReg: 0.13577) QuantErr: 0.13577 batch_time=0.42447 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 0.00224 (QuantReg: 0.13508) QuantErr: 0.13508 batch_time=0.42920 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 0.00216 (QuantReg: 0.13634) QuantErr: 0.13634 batch_time=0.43752 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 0.00276 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.44492 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 0.00315 (QuantReg: 0.13185) QuantErr: 0.13185 batch_time=2.89320 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 0.00186 (QuantReg: 0.13735) QuantErr: 0.13735 batch_time=0.41887 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 0.00191 (QuantReg: 0.13544) QuantErr: 0.13544 batch_time=0.43423 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 0.00339 (QuantReg: 0.13578) QuantErr: 0.13578 batch_time=0.43904 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.00275 (QuantReg: 0.13666) QuantErr: 0.13666 batch_time=0.50577 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 0.00228 (QuantReg: 0.13447) QuantErr: 0.13447 batch_time=0.41494 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 0.00196 (QuantReg: 0.13405) QuantErr: 0.13405 batch_time=0.93787 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 0.00155 (QuantReg: 0.13509) QuantErr: 0.13509 batch_time=0.43019 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 0.00264 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=0.58076 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 0.00333 (QuantReg: 0.13419) QuantErr: 0.13419 batch_time=0.43691 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch32.pth ...
Done in 3.915s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 0.002583518981933594
 quant_reg      : 0.1349157413840294
 quant_err      : 0.1349157413840294
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_miech_test/t2v_metrics/R1: 13.1
 MSRVTT_miech_test/t2v_metrics/R5: 39.9
 MSRVTT_miech_test/t2v_metrics/R10: 56.4
 MSRVTT_miech_test/t2v_metrics/R50: 86.1
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.197
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.891649485765218
 MSRVTT_miech_test/v2t_metrics/R1: 13.9
 MSRVTT_miech_test/v2t_metrics/R5: 41.0
 MSRVTT_miech_test/v2t_metrics/R10: 57.6
 MSRVTT_miech_test/v2t_metrics/R50: 87.2
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.519
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.01894711258557
 mnt_best       : 31.617466176057203
 not_improved_count: 8
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 0.00314 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=28.71088 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 0.00310 (QuantReg: 0.13595) QuantErr: 0.13595 batch_time=0.41264 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 0.00275 (QuantReg: 0.13615) QuantErr: 0.13615 batch_time=0.42846 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 0.00261 (QuantReg: 0.13600) QuantErr: 0.13600 batch_time=0.44587 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 0.00244 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.41790 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 0.00219 (QuantReg: 0.13566) QuantErr: 0.13566 batch_time=0.43657 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.00157 (QuantReg: 0.13581) QuantErr: 0.13581 batch_time=0.42385 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 0.00281 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.42312 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 0.00200 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.42633 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 0.00376 (QuantReg: 0.13419) QuantErr: 0.13419 batch_time=0.45523 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 0.00247 (QuantReg: 0.13478) QuantErr: 0.13478 batch_time=0.46819 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 0.00277 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.48516 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 0.00253 (QuantReg: 0.13521) QuantErr: 0.13521 batch_time=0.42831 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 0.00308 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=0.44547 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 0.00192 (QuantReg: 0.13381) QuantErr: 0.13381 batch_time=0.44330 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.00283 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.42519 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.00221 (QuantReg: 0.13636) QuantErr: 0.13636 batch_time=0.42773 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 0.00234 (QuantReg: 0.13414) QuantErr: 0.13414 batch_time=0.43528 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 0.00521 (QuantReg: 0.13486) QuantErr: 0.13486 batch_time=0.41697 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 0.00199 (QuantReg: 0.13723) QuantErr: 0.13723 batch_time=0.41609 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.00296 (QuantReg: 0.13310) QuantErr: 0.13310 batch_time=0.44087 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 0.00233 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.54715 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 0.00235 (QuantReg: 0.13525) QuantErr: 0.13525 batch_time=0.43630 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch33.pth ...
Done in 3.983s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch33.pth ...
Done in 7.777s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 0.002669475555419922
 quant_reg      : 0.13488843846321105
 quant_err      : 0.13488843846321105
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_miech_test/t2v_metrics/R1: 14.4
 MSRVTT_miech_test/t2v_metrics/R5: 40.7
 MSRVTT_miech_test/t2v_metrics/R10: 55.1
 MSRVTT_miech_test/t2v_metrics/R50: 86.5
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.42
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.844627030565423
 MSRVTT_miech_test/v2t_metrics/R1: 14.2
 MSRVTT_miech_test/v2t_metrics/R5: 40.4
 MSRVTT_miech_test/v2t_metrics/R10: 57.3
 MSRVTT_miech_test/v2t_metrics/R50: 86.7
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.6685
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.03377423644701
 mnt_best       : 31.844627030565423
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 0.00270 (QuantReg: 0.13342) QuantErr: 0.13342 batch_time=29.35532 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 0.00235 (QuantReg: 0.13362) QuantErr: 0.13362 batch_time=0.43181 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 0.00247 (QuantReg: 0.13486) QuantErr: 0.13486 batch_time=0.42715 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 0.00289 (QuantReg: 0.13411) QuantErr: 0.13411 batch_time=0.46274 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 0.00360 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.44934 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 0.00279 (QuantReg: 0.13510) QuantErr: 0.13510 batch_time=0.47585 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.00222 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.46080 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 0.00234 (QuantReg: 0.13547) QuantErr: 0.13547 batch_time=0.42562 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 0.00221 (QuantReg: 0.13423) QuantErr: 0.13423 batch_time=0.48668 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 0.00258 (QuantReg: 0.13458) QuantErr: 0.13458 batch_time=1.78547 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 0.00264 (QuantReg: 0.13651) QuantErr: 0.13651 batch_time=0.42349 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 0.00215 (QuantReg: 0.13448) QuantErr: 0.13448 batch_time=0.45331 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 0.00184 (QuantReg: 0.13741) QuantErr: 0.13741 batch_time=0.42206 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 0.00211 (QuantReg: 0.13282) QuantErr: 0.13282 batch_time=0.42972 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 0.00235 (QuantReg: 0.13676) QuantErr: 0.13676 batch_time=0.44494 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 0.00209 (QuantReg: 0.13439) QuantErr: 0.13439 batch_time=0.44183 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 0.00189 (QuantReg: 0.13476) QuantErr: 0.13476 batch_time=0.45221 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 0.00271 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.44043 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 0.00172 (QuantReg: 0.13620) QuantErr: 0.13620 batch_time=3.02461 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 0.00148 (QuantReg: 0.13365) QuantErr: 0.13365 batch_time=0.43916 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 0.00233 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.42157 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 0.00356 (QuantReg: 0.13560) QuantErr: 0.13560 batch_time=0.43421 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 0.00216 (QuantReg: 0.13521) QuantErr: 0.13521 batch_time=0.42801 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch34.pth ...
Done in 15.926s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch34.pth ...
Done in 19.795s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 0.002545055389404297
 quant_reg      : 0.13507341867685319
 quant_err      : 0.13507341867685319
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_miech_test/t2v_metrics/R1: 14.7
 MSRVTT_miech_test/t2v_metrics/R5: 40.5
 MSRVTT_miech_test/t2v_metrics/R10: 57.1
 MSRVTT_miech_test/t2v_metrics/R50: 85.7
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.023
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.39436630442326
 MSRVTT_miech_test/v2t_metrics/R1: 14.2
 MSRVTT_miech_test/v2t_metrics/R5: 40.6
 MSRVTT_miech_test/v2t_metrics/R10: 56.9
 MSRVTT_miech_test/v2t_metrics/R50: 86.8
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.53
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.01171055769093
 mnt_best       : 32.39436630442326
 not_improved_count: 0
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 0.00170 (QuantReg: 0.13686) QuantErr: 0.13686 batch_time=41.53393 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 0.00225 (QuantReg: 0.13589) QuantErr: 0.13589 batch_time=0.44787 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 0.00245 (QuantReg: 0.13334) QuantErr: 0.13334 batch_time=0.46737 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 0.00208 (QuantReg: 0.13333) QuantErr: 0.13333 batch_time=0.50091 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 0.00201 (QuantReg: 0.13743) QuantErr: 0.13743 batch_time=0.52871 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 0.00305 (QuantReg: 0.13573) QuantErr: 0.13573 batch_time=0.46270 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 0.00179 (QuantReg: 0.13535) QuantErr: 0.13535 batch_time=0.43863 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 0.00154 (QuantReg: 0.13569) QuantErr: 0.13569 batch_time=0.46897 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 0.00285 (QuantReg: 0.13591) QuantErr: 0.13591 batch_time=0.43461 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 0.00299 (QuantReg: 0.13203) QuantErr: 0.13203 batch_time=0.43163 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.00317 (QuantReg: 0.13477) QuantErr: 0.13477 batch_time=0.44755 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 0.00235 (QuantReg: 0.13688) QuantErr: 0.13688 batch_time=0.43412 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 0.00181 (QuantReg: 0.13604) QuantErr: 0.13604 batch_time=0.45585 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 0.00272 (QuantReg: 0.13450) QuantErr: 0.13450 batch_time=0.45142 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 0.00215 (QuantReg: 0.13380) QuantErr: 0.13380 batch_time=0.47068 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.00241 (QuantReg: 0.13447) QuantErr: 0.13447 batch_time=0.44395 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 0.00365 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.44662 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 0.00393 (QuantReg: 0.13671) QuantErr: 0.13671 batch_time=0.43069 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 0.00215 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=0.42356 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 0.00256 (QuantReg: 0.13656) QuantErr: 0.13656 batch_time=0.42592 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.00204 (QuantReg: 0.13318) QuantErr: 0.13318 batch_time=0.43786 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 0.00301 (QuantReg: 0.13523) QuantErr: 0.13523 batch_time=0.43035 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.00270 (QuantReg: 0.13434) QuantErr: 0.13434 batch_time=0.44828 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch35.pth ...
Done in 16.886s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 0.0025008163452148436
 quant_reg      : 0.13480958914756774
 quant_err      : 0.13480958914756774
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_miech_test/t2v_metrics/R1: 14.0
 MSRVTT_miech_test/t2v_metrics/R5: 40.9
 MSRVTT_miech_test/t2v_metrics/R10: 57.4
 MSRVTT_miech_test/t2v_metrics/R50: 85.7
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.522
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.03227212998471
 MSRVTT_miech_test/v2t_metrics/R1: 15.8
 MSRVTT_miech_test/v2t_metrics/R5: 42.7
 MSRVTT_miech_test/v2t_metrics/R10: 57.3
 MSRVTT_miech_test/v2t_metrics/R50: 86.9
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.945
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.81270078111567
 mnt_best       : 32.39436630442326
 not_improved_count: 1
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 0.00228 (QuantReg: 0.13742) QuantErr: 0.13742 batch_time=28.97505 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 0.00280 (QuantReg: 0.13542) QuantErr: 0.13542 batch_time=0.44833 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.00265 (QuantReg: 0.13344) QuantErr: 0.13344 batch_time=0.41858 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 0.00296 (QuantReg: 0.13472) QuantErr: 0.13472 batch_time=0.44926 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 0.00243 (QuantReg: 0.13736) QuantErr: 0.13736 batch_time=0.45192 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.00278 (QuantReg: 0.13515) QuantErr: 0.13515 batch_time=0.42328 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 0.00311 (QuantReg: 0.13631) QuantErr: 0.13631 batch_time=0.55960 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 0.00286 (QuantReg: 0.13544) QuantErr: 0.13544 batch_time=0.41791 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 0.00371 (QuantReg: 0.13728) QuantErr: 0.13728 batch_time=0.43115 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 0.00179 (QuantReg: 0.13450) QuantErr: 0.13450 batch_time=0.42626 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 0.00163 (QuantReg: 0.13657) QuantErr: 0.13657 batch_time=0.44461 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 0.00217 (QuantReg: 0.13423) QuantErr: 0.13423 batch_time=0.43463 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 0.00258 (QuantReg: 0.13602) QuantErr: 0.13602 batch_time=0.44436 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 0.00427 (QuantReg: 0.13642) QuantErr: 0.13642 batch_time=0.42424 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.00298 (QuantReg: 0.13221) QuantErr: 0.13221 batch_time=0.44105 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.00180 (QuantReg: 0.13574) QuantErr: 0.13574 batch_time=0.41686 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 0.00306 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.65790 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.00272 (QuantReg: 0.13365) QuantErr: 0.13365 batch_time=0.42931 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.00217 (QuantReg: 0.13576) QuantErr: 0.13576 batch_time=0.42721 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.00284 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.43203 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.00225 (QuantReg: 0.13489) QuantErr: 0.13489 batch_time=0.42618 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.00155 (QuantReg: 0.13666) QuantErr: 0.13666 batch_time=0.42570 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.00192 (QuantReg: 0.13382) QuantErr: 0.13382 batch_time=0.44463 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch36.pth ...
Done in 4.058s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 0.0024476394653320313
 quant_reg      : 0.1350168317556381
 quant_err      : 0.1350168317556381
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_miech_test/t2v_metrics/R1: 13.5
 MSRVTT_miech_test/t2v_metrics/R5: 42.0
 MSRVTT_miech_test/t2v_metrics/R10: 56.7
 MSRVTT_miech_test/t2v_metrics/R50: 86.1
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.453
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.797187362485516
 MSRVTT_miech_test/v2t_metrics/R1: 13.6
 MSRVTT_miech_test/v2t_metrics/R5: 43.3
 MSRVTT_miech_test/v2t_metrics/R10: 58.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.5
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.381
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.44528545320359
 mnt_best       : 32.39436630442326
 not_improved_count: 2
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 0.00249 (QuantReg: 0.13537) QuantErr: 0.13537 batch_time=28.67330 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 0.00224 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.42943 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.00187 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.44221 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 0.00206 (QuantReg: 0.13149) QuantErr: 0.13149 batch_time=0.44115 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 0.00204 (QuantReg: 0.13407) QuantErr: 0.13407 batch_time=0.45864 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 0.00184 (QuantReg: 0.13437) QuantErr: 0.13437 batch_time=0.43519 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 0.00194 (QuantReg: 0.13206) QuantErr: 0.13206 batch_time=0.90273 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 0.00230 (QuantReg: 0.13519) QuantErr: 0.13519 batch_time=1.24273 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 0.00171 (QuantReg: 0.13630) QuantErr: 0.13630 batch_time=0.46906 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.00195 (QuantReg: 0.13494) QuantErr: 0.13494 batch_time=0.42166 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 0.00192 (QuantReg: 0.13488) QuantErr: 0.13488 batch_time=0.42718 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.00204 (QuantReg: 0.13824) QuantErr: 0.13824 batch_time=0.43208 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 0.00217 (QuantReg: 0.13396) QuantErr: 0.13396 batch_time=3.64388 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 0.00206 (QuantReg: 0.13511) QuantErr: 0.13511 batch_time=0.42589 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.00233 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.43947 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.00185 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=0.43601 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.00237 (QuantReg: 0.13468) QuantErr: 0.13468 batch_time=0.42901 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.00403 (QuantReg: 0.13628) QuantErr: 0.13628 batch_time=0.43577 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 0.00198 (QuantReg: 0.13459) QuantErr: 0.13459 batch_time=0.40946 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 0.00256 (QuantReg: 0.13581) QuantErr: 0.13581 batch_time=0.44048 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 0.00160 (QuantReg: 0.13581) QuantErr: 0.13581 batch_time=0.44663 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 0.00294 (QuantReg: 0.13392) QuantErr: 0.13392 batch_time=0.42099 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 0.00261 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.42214 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch37.pth ...
Done in 4.061s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch37.pth ...
Done in 8.041s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 0.0023518829345703126
 quant_reg      : 0.13505398523807527
 quant_err      : 0.13505398523807527
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_miech_test/t2v_metrics/R1: 14.2
 MSRVTT_miech_test/t2v_metrics/R5: 42.7
 MSRVTT_miech_test/t2v_metrics/R10: 57.3
 MSRVTT_miech_test/t2v_metrics/R50: 86.2
 MSRVTT_miech_test/t2v_metrics/MedR: 7.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.965
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.63049137611581
 MSRVTT_miech_test/v2t_metrics/R1: 15.0
 MSRVTT_miech_test/v2t_metrics/R5: 42.0
 MSRVTT_miech_test/v2t_metrics/R10: 58.1
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.213
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.20261023654078
 mnt_best       : 32.63049137611581
 not_improved_count: 0
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.00198 (QuantReg: 0.13500) QuantErr: 0.13500 batch_time=29.57210 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.00256 (QuantReg: 0.13456) QuantErr: 0.13456 batch_time=0.43238 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.00303 (QuantReg: 0.13647) QuantErr: 0.13647 batch_time=0.42198 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 0.00263 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.72388 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 0.00237 (QuantReg: 0.13331) QuantErr: 0.13331 batch_time=0.48784 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.00211 (QuantReg: 0.13627) QuantErr: 0.13627 batch_time=0.46655 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 0.00204 (QuantReg: 0.13347) QuantErr: 0.13347 batch_time=0.41983 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.00207 (QuantReg: 0.13235) QuantErr: 0.13235 batch_time=0.42360 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 0.00249 (QuantReg: 0.13742) QuantErr: 0.13742 batch_time=0.44502 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.00176 (QuantReg: 0.13638) QuantErr: 0.13638 batch_time=0.43549 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.00207 (QuantReg: 0.13477) QuantErr: 0.13477 batch_time=0.48069 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 0.00302 (QuantReg: 0.13524) QuantErr: 0.13524 batch_time=0.45195 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 0.00211 (QuantReg: 0.13449) QuantErr: 0.13449 batch_time=1.00684 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 0.00196 (QuantReg: 0.13426) QuantErr: 0.13426 batch_time=0.46317 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 0.00292 (QuantReg: 0.13348) QuantErr: 0.13348 batch_time=0.44347 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.00250 (QuantReg: 0.13521) QuantErr: 0.13521 batch_time=0.41209 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.00229 (QuantReg: 0.13554) QuantErr: 0.13554 batch_time=0.44472 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.00236 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=0.41520 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 0.00275 (QuantReg: 0.13409) QuantErr: 0.13409 batch_time=0.45313 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 0.00302 (QuantReg: 0.13758) QuantErr: 0.13758 batch_time=1.43749 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 0.00294 (QuantReg: 0.13328) QuantErr: 0.13328 batch_time=0.41584 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 0.00224 (QuantReg: 0.13287) QuantErr: 0.13287 batch_time=0.43673 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 0.00245 (QuantReg: 0.13548) QuantErr: 0.13548 batch_time=0.45575 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch38.pth ...
Done in 3.925s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 0.0023907737731933593
 quant_reg      : 0.13468997830152513
 quant_err      : 0.13468997830152513
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_miech_test/t2v_metrics/R1: 13.2
 MSRVTT_miech_test/t2v_metrics/R5: 42.1
 MSRVTT_miech_test/t2v_metrics/R10: 56.9
 MSRVTT_miech_test/t2v_metrics/R50: 86.4
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.557
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.62200704906199
 MSRVTT_miech_test/v2t_metrics/R1: 14.0
 MSRVTT_miech_test/v2t_metrics/R5: 41.1
 MSRVTT_miech_test/v2t_metrics/R10: 57.5
 MSRVTT_miech_test/v2t_metrics/R50: 87.6
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.1375
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.103020843220136
 mnt_best       : 32.63049137611581
 not_improved_count: 1
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.00167 (QuantReg: 0.13367) QuantErr: 0.13367 batch_time=27.96909 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 0.00241 (QuantReg: 0.13326) QuantErr: 0.13326 batch_time=0.49196 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 0.00196 (QuantReg: 0.13435) QuantErr: 0.13435 batch_time=0.42526 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 0.00286 (QuantReg: 0.13548) QuantErr: 0.13548 batch_time=0.41969 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 0.00298 (QuantReg: 0.13417) QuantErr: 0.13417 batch_time=0.45860 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 0.00185 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.46050 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 0.00202 (QuantReg: 0.13480) QuantErr: 0.13480 batch_time=0.43145 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 0.00206 (QuantReg: 0.13431) QuantErr: 0.13431 batch_time=0.43406 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 0.00193 (QuantReg: 0.13233) QuantErr: 0.13233 batch_time=0.43493 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 0.00224 (QuantReg: 0.13541) QuantErr: 0.13541 batch_time=0.43330 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.00156 (QuantReg: 0.13590) QuantErr: 0.13590 batch_time=0.44647 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.00238 (QuantReg: 0.13628) QuantErr: 0.13628 batch_time=0.49858 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 0.00213 (QuantReg: 0.13665) QuantErr: 0.13665 batch_time=0.42011 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 0.00164 (QuantReg: 0.13499) QuantErr: 0.13499 batch_time=4.19863 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 0.00338 (QuantReg: 0.13430) QuantErr: 0.13430 batch_time=0.42746 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 0.00258 (QuantReg: 0.13530) QuantErr: 0.13530 batch_time=1.74602 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 0.00159 (QuantReg: 0.13691) QuantErr: 0.13691 batch_time=0.45642 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.00249 (QuantReg: 0.13562) QuantErr: 0.13562 batch_time=0.43195 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.00326 (QuantReg: 0.13142) QuantErr: 0.13142 batch_time=1.19523 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 0.00268 (QuantReg: 0.13415) QuantErr: 0.13415 batch_time=0.42746 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 0.00252 (QuantReg: 0.13343) QuantErr: 0.13343 batch_time=0.44637 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 0.00205 (QuantReg: 0.13465) QuantErr: 0.13465 batch_time=0.44438 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.00250 (QuantReg: 0.13389) QuantErr: 0.13389 batch_time=0.45738 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch39.pth ...
Done in 4.026s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 0.002308055877685547
 quant_reg      : 0.13447521644830704
 quant_err      : 0.13447521644830704
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_miech_test/t2v_metrics/R1: 13.1
 MSRVTT_miech_test/t2v_metrics/R5: 42.3
 MSRVTT_miech_test/t2v_metrics/R10: 55.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.532
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.40565269377115
 MSRVTT_miech_test/v2t_metrics/R1: 14.2
 MSRVTT_miech_test/v2t_metrics/R5: 41.4
 MSRVTT_miech_test/v2t_metrics/R10: 57.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.891
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.295928071583575
 mnt_best       : 32.63049137611581
 not_improved_count: 2
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 0.00295 (QuantReg: 0.13431) QuantErr: 0.13431 batch_time=31.96633 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 0.00247 (QuantReg: 0.13330) QuantErr: 0.13330 batch_time=0.43659 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 0.00298 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.45830 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.00174 (QuantReg: 0.13468) QuantErr: 0.13468 batch_time=0.43531 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 0.00213 (QuantReg: 0.13510) QuantErr: 0.13510 batch_time=0.41630 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 0.00240 (QuantReg: 0.13555) QuantErr: 0.13555 batch_time=0.44695 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 0.00346 (QuantReg: 0.13635) QuantErr: 0.13635 batch_time=0.45317 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 0.00212 (QuantReg: 0.13318) QuantErr: 0.13318 batch_time=0.43536 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 0.00219 (QuantReg: 0.13453) QuantErr: 0.13453 batch_time=0.46956 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.00216 (QuantReg: 0.13278) QuantErr: 0.13278 batch_time=0.43926 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 0.00272 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.67768 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 0.00203 (QuantReg: 0.13418) QuantErr: 0.13418 batch_time=0.40780 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 0.00190 (QuantReg: 0.13466) QuantErr: 0.13466 batch_time=0.42607 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 0.00209 (QuantReg: 0.13652) QuantErr: 0.13652 batch_time=0.93819 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 0.00209 (QuantReg: 0.13334) QuantErr: 0.13334 batch_time=0.43639 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 0.00337 (QuantReg: 0.13403) QuantErr: 0.13403 batch_time=0.41820 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 0.00319 (QuantReg: 0.13484) QuantErr: 0.13484 batch_time=0.43291 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 0.00214 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.43920 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 0.00240 (QuantReg: 0.13261) QuantErr: 0.13261 batch_time=0.44143 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 0.00188 (QuantReg: 0.13148) QuantErr: 0.13148 batch_time=0.64862 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 0.00226 (QuantReg: 0.13579) QuantErr: 0.13579 batch_time=0.46770 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.00188 (QuantReg: 0.13360) QuantErr: 0.13360 batch_time=0.42754 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.00274 (QuantReg: 0.13622) QuantErr: 0.13622 batch_time=0.43688 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch40.pth ...
Done in 10.029s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 0.0022861900329589845
 quant_reg      : 0.13420602440834045
 quant_err      : 0.13420602440834045
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_miech_test/t2v_metrics/R1: 14.3
 MSRVTT_miech_test/t2v_metrics/R5: 42.2
 MSRVTT_miech_test/t2v_metrics/R10: 57.3
 MSRVTT_miech_test/t2v_metrics/R50: 86.3
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.275
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.578746481539355
 MSRVTT_miech_test/v2t_metrics/R1: 13.4
 MSRVTT_miech_test/v2t_metrics/R5: 41.0
 MSRVTT_miech_test/v2t_metrics/R10: 57.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.7
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.811
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.59367763274985
 mnt_best       : 32.63049137611581
 not_improved_count: 3
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.00186 (QuantReg: 0.13357) QuantErr: 0.13357 batch_time=30.88597 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 0.00222 (QuantReg: 0.13593) QuantErr: 0.13593 batch_time=0.43480 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 0.00200 (QuantReg: 0.13256) QuantErr: 0.13256 batch_time=0.44084 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 0.00204 (QuantReg: 0.13253) QuantErr: 0.13253 batch_time=0.45466 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 0.00239 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=0.44693 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.00193 (QuantReg: 0.13603) QuantErr: 0.13603 batch_time=0.45926 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.00252 (QuantReg: 0.13539) QuantErr: 0.13539 batch_time=0.56055 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.00250 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=1.16299 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 0.00187 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.43102 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 0.00187 (QuantReg: 0.13186) QuantErr: 0.13186 batch_time=0.44252 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 0.00169 (QuantReg: 0.13663) QuantErr: 0.13663 batch_time=0.44043 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 0.00284 (QuantReg: 0.13365) QuantErr: 0.13365 batch_time=0.46592 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 0.00178 (QuantReg: 0.13532) QuantErr: 0.13532 batch_time=0.43122 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 0.00186 (QuantReg: 0.13479) QuantErr: 0.13479 batch_time=1.69786 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 0.00206 (QuantReg: 0.13360) QuantErr: 0.13360 batch_time=0.42736 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 0.00345 (QuantReg: 0.13515) QuantErr: 0.13515 batch_time=0.43311 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 0.00200 (QuantReg: 0.13247) QuantErr: 0.13247 batch_time=0.42583 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.00209 (QuantReg: 0.13395) QuantErr: 0.13395 batch_time=0.41752 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 0.00230 (QuantReg: 0.13227) QuantErr: 0.13227 batch_time=0.42687 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 0.00258 (QuantReg: 0.13461) QuantErr: 0.13461 batch_time=0.49877 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 0.00166 (QuantReg: 0.13290) QuantErr: 0.13290 batch_time=0.42796 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 0.00293 (QuantReg: 0.13502) QuantErr: 0.13502 batch_time=0.42700 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 0.00282 (QuantReg: 0.13466) QuantErr: 0.13466 batch_time=0.42677 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch41.pth ...
Done in 10.173s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 0.002258628845214844
 quant_reg      : 0.13439206671714782
 quant_err      : 0.13439206671714782
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_miech_test/t2v_metrics/R1: 13.7
 MSRVTT_miech_test/t2v_metrics/R5: 41.4
 MSRVTT_miech_test/t2v_metrics/R10: 56.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.244
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.687982521275313
 MSRVTT_miech_test/v2t_metrics/R1: 14.1
 MSRVTT_miech_test/v2t_metrics/R5: 42.4
 MSRVTT_miech_test/v2t_metrics/R10: 57.2
 MSRVTT_miech_test/v2t_metrics/R50: 87.6
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.974
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.458391882153876
 mnt_best       : 32.63049137611581
 not_improved_count: 4
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 0.00202 (QuantReg: 0.13630) QuantErr: 0.13630 batch_time=31.30049 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.00264 (QuantReg: 0.13384) QuantErr: 0.13384 batch_time=0.43584 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 0.00213 (QuantReg: 0.13403) QuantErr: 0.13403 batch_time=0.44373 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 0.00254 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.43863 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 0.00169 (QuantReg: 0.13259) QuantErr: 0.13259 batch_time=0.46268 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 0.00249 (QuantReg: 0.13430) QuantErr: 0.13430 batch_time=0.41159 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 0.00184 (QuantReg: 0.13565) QuantErr: 0.13565 batch_time=0.42910 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 0.00203 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.43626 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.00169 (QuantReg: 0.13516) QuantErr: 0.13516 batch_time=0.43308 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 0.00154 (QuantReg: 0.13519) QuantErr: 0.13519 batch_time=0.43356 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 0.00208 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=0.44052 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 0.00170 (QuantReg: 0.13526) QuantErr: 0.13526 batch_time=0.45689 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 0.00183 (QuantReg: 0.13439) QuantErr: 0.13439 batch_time=0.44929 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.00199 (QuantReg: 0.13333) QuantErr: 0.13333 batch_time=0.41766 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 0.00163 (QuantReg: 0.13589) QuantErr: 0.13589 batch_time=0.43252 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 0.00158 (QuantReg: 0.13625) QuantErr: 0.13625 batch_time=0.44763 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.00206 (QuantReg: 0.13559) QuantErr: 0.13559 batch_time=0.44367 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.00193 (QuantReg: 0.13656) QuantErr: 0.13656 batch_time=0.43731 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.00216 (QuantReg: 0.13598) QuantErr: 0.13598 batch_time=0.44686 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 0.00225 (QuantReg: 0.13383) QuantErr: 0.13383 batch_time=0.43498 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.00217 (QuantReg: 0.13409) QuantErr: 0.13409 batch_time=0.56232 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.00227 (QuantReg: 0.13412) QuantErr: 0.13412 batch_time=0.41158 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 0.00283 (QuantReg: 0.13567) QuantErr: 0.13567 batch_time=0.42841 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch42.pth ...
Done in 9.564s
removing stale ckpt [epoch 41] [took 0.01s]
 epoch          : 42
 loss           : 0.0021938018798828124
 quant_reg      : 0.13446526622772217
 quant_err      : 0.13446526622772217
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_miech_test/t2v_metrics/R1: 13.8
 MSRVTT_miech_test/t2v_metrics/R5: 40.8
 MSRVTT_miech_test/t2v_metrics/R10: 56.3
 MSRVTT_miech_test/t2v_metrics/R50: 86.2
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.077
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.648214599465046
 MSRVTT_miech_test/v2t_metrics/R1: 14.4
 MSRVTT_miech_test/v2t_metrics/R5: 41.5
 MSRVTT_miech_test/v2t_metrics/R10: 57.6
 MSRVTT_miech_test/v2t_metrics/R50: 87.1
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.505
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.52952268066988
 mnt_best       : 32.63049137611581
 not_improved_count: 5
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.00216 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=30.73074 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.00171 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=0.44525 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 0.00174 (QuantReg: 0.13293) QuantErr: 0.13293 batch_time=0.43052 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 0.00214 (QuantReg: 0.13321) QuantErr: 0.13321 batch_time=0.45919 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 0.00159 (QuantReg: 0.13461) QuantErr: 0.13461 batch_time=0.46238 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 0.00210 (QuantReg: 0.13557) QuantErr: 0.13557 batch_time=0.45353 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 0.00264 (QuantReg: 0.13298) QuantErr: 0.13298 batch_time=0.48547 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 0.00259 (QuantReg: 0.13416) QuantErr: 0.13416 batch_time=0.42239 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.00160 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.42636 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 0.00168 (QuantReg: 0.13349) QuantErr: 0.13349 batch_time=0.46530 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 0.00210 (QuantReg: 0.13347) QuantErr: 0.13347 batch_time=0.46653 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.00198 (QuantReg: 0.13668) QuantErr: 0.13668 batch_time=0.45124 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 0.00180 (QuantReg: 0.13306) QuantErr: 0.13306 batch_time=0.44526 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.00187 (QuantReg: 0.13232) QuantErr: 0.13232 batch_time=0.41734 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 0.00223 (QuantReg: 0.13306) QuantErr: 0.13306 batch_time=0.45795 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 0.00186 (QuantReg: 0.13300) QuantErr: 0.13300 batch_time=0.44244 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.00247 (QuantReg: 0.13321) QuantErr: 0.13321 batch_time=0.43664 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.00203 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.44900 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 0.00270 (QuantReg: 0.13304) QuantErr: 0.13304 batch_time=0.42237 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 0.00212 (QuantReg: 0.13417) QuantErr: 0.13417 batch_time=2.24479 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 0.00193 (QuantReg: 0.13644) QuantErr: 0.13644 batch_time=0.43160 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.00152 (QuantReg: 0.13586) QuantErr: 0.13586 batch_time=0.85960 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 0.00185 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.44054 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch43.pth ...
Done in 4.230s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 0.002148490905761719
 quant_reg      : 0.13430214583873748
 quant_err      : 0.13430214583873748
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_miech_test/t2v_metrics/R1: 14.0
 MSRVTT_miech_test/t2v_metrics/R5: 41.2
 MSRVTT_miech_test/t2v_metrics/R10: 57.1
 MSRVTT_miech_test/t2v_metrics/R50: 86.4
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.398
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.05436072619083
 MSRVTT_miech_test/v2t_metrics/R1: 14.1
 MSRVTT_miech_test/v2t_metrics/R5: 43.0
 MSRVTT_miech_test/v2t_metrics/R10: 58.9
 MSRVTT_miech_test/v2t_metrics/R50: 87.6
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.064
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.930699381027935
 mnt_best       : 32.63049137611581
 not_improved_count: 6
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.00186 (QuantReg: 0.13619) QuantErr: 0.13619 batch_time=30.36981 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 0.00230 (QuantReg: 0.13221) QuantErr: 0.13221 batch_time=0.42642 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 0.00194 (QuantReg: 0.13482) QuantErr: 0.13482 batch_time=0.45103 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.00242 (QuantReg: 0.13369) QuantErr: 0.13369 batch_time=0.42701 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 0.00299 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=0.45543 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 0.00226 (QuantReg: 0.13186) QuantErr: 0.13186 batch_time=0.45487 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 0.00195 (QuantReg: 0.13443) QuantErr: 0.13443 batch_time=0.42188 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 0.00163 (QuantReg: 0.13383) QuantErr: 0.13383 batch_time=0.43997 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 0.00172 (QuantReg: 0.13425) QuantErr: 0.13425 batch_time=0.46725 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 0.00205 (QuantReg: 0.13218) QuantErr: 0.13218 batch_time=0.45513 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 0.00177 (QuantReg: 0.13288) QuantErr: 0.13288 batch_time=0.45795 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 0.00188 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.64435 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 0.00186 (QuantReg: 0.13275) QuantErr: 0.13275 batch_time=0.43443 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 0.00257 (QuantReg: 0.13357) QuantErr: 0.13357 batch_time=0.42722 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 0.00227 (QuantReg: 0.13535) QuantErr: 0.13535 batch_time=0.46488 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 0.00204 (QuantReg: 0.13314) QuantErr: 0.13314 batch_time=0.43794 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 0.00273 (QuantReg: 0.13455) QuantErr: 0.13455 batch_time=0.42880 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.00236 (QuantReg: 0.13571) QuantErr: 0.13571 batch_time=0.41346 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 0.00249 (QuantReg: 0.13375) QuantErr: 0.13375 batch_time=0.41304 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 0.00145 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=3.27537 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 0.00165 (QuantReg: 0.13506) QuantErr: 0.13506 batch_time=0.43061 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.00163 (QuantReg: 0.13358) QuantErr: 0.13358 batch_time=0.44002 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 0.00248 (QuantReg: 0.13522) QuantErr: 0.13522 batch_time=0.45171 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch44.pth ...
Done in 9.778s
removing stale ckpt [epoch 43] [took 0.01s]
 epoch          : 44
 loss           : 0.0020548973083496093
 quant_reg      : 0.1343471873998642
 quant_err      : 0.1343471873998642
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_miech_test/t2v_metrics/R1: 13.5
 MSRVTT_miech_test/t2v_metrics/R5: 42.6
 MSRVTT_miech_test/t2v_metrics/R10: 57.2
 MSRVTT_miech_test/t2v_metrics/R50: 86.4
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.949
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.04152162112397
 MSRVTT_miech_test/v2t_metrics/R1: 14.1
 MSRVTT_miech_test/v2t_metrics/R5: 41.9
 MSRVTT_miech_test/v2t_metrics/R10: 58.7
 MSRVTT_miech_test/v2t_metrics/R50: 86.9
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.628
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.61047156295142
 mnt_best       : 32.63049137611581
 not_improved_count: 7
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 0.00174 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=28.12452 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.00219 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=6.96756 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.00205 (QuantReg: 0.13492) QuantErr: 0.13492 batch_time=0.42286 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 0.00186 (QuantReg: 0.13269) QuantErr: 0.13269 batch_time=0.45146 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 0.00197 (QuantReg: 0.13611) QuantErr: 0.13611 batch_time=0.44137 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 0.00256 (QuantReg: 0.13330) QuantErr: 0.13330 batch_time=0.45031 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.00298 (QuantReg: 0.13354) QuantErr: 0.13354 batch_time=0.44552 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 0.00249 (QuantReg: 0.13432) QuantErr: 0.13432 batch_time=0.46746 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 0.00194 (QuantReg: 0.13342) QuantErr: 0.13342 batch_time=0.45971 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.00170 (QuantReg: 0.13550) QuantErr: 0.13550 batch_time=0.42475 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.00238 (QuantReg: 0.13460) QuantErr: 0.13460 batch_time=0.43127 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 0.00230 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=0.48740 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.00220 (QuantReg: 0.13334) QuantErr: 0.13334 batch_time=0.45786 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 0.00226 (QuantReg: 0.13648) QuantErr: 0.13648 batch_time=0.41792 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 0.00328 (QuantReg: 0.13552) QuantErr: 0.13552 batch_time=0.48401 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.00209 (QuantReg: 0.13623) QuantErr: 0.13623 batch_time=0.44689 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 0.00185 (QuantReg: 0.13408) QuantErr: 0.13408 batch_time=0.44951 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 0.00274 (QuantReg: 0.13680) QuantErr: 0.13680 batch_time=0.46667 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.00250 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=0.42976 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.00296 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.42296 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 0.00179 (QuantReg: 0.13429) QuantErr: 0.13429 batch_time=0.42889 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.00220 (QuantReg: 0.13360) QuantErr: 0.13360 batch_time=0.42838 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 0.00251 (QuantReg: 0.13269) QuantErr: 0.13269 batch_time=0.44091 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch45.pth ...
Done in 9.809s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 0.0020814743041992186
 quant_reg      : 0.13445697098970413
 quant_err      : 0.13445697098970413
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_miech_test/t2v_metrics/R1: 14.1
 MSRVTT_miech_test/t2v_metrics/R5: 42.0
 MSRVTT_miech_test/t2v_metrics/R10: 57.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.455
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.33713232248412
 MSRVTT_miech_test/v2t_metrics/R1: 13.9
 MSRVTT_miech_test/v2t_metrics/R5: 42.6
 MSRVTT_miech_test/v2t_metrics/R10: 58.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.2
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.9995
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.579600069102256
 mnt_best       : 32.63049137611581
 not_improved_count: 8
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.00193 (QuantReg: 0.13468) QuantErr: 0.13468 batch_time=27.52906 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 0.00177 (QuantReg: 0.13323) QuantErr: 0.13323 batch_time=0.44244 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.00243 (QuantReg: 0.13219) QuantErr: 0.13219 batch_time=0.43182 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.00218 (QuantReg: 0.13343) QuantErr: 0.13343 batch_time=0.44197 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 0.00210 (QuantReg: 0.13427) QuantErr: 0.13427 batch_time=0.43276 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 0.00167 (QuantReg: 0.13709) QuantErr: 0.13709 batch_time=0.47660 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.00222 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=0.44512 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 0.00191 (QuantReg: 0.13614) QuantErr: 0.13614 batch_time=0.43763 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.00247 (QuantReg: 0.13454) QuantErr: 0.13454 batch_time=0.46280 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.00191 (QuantReg: 0.13521) QuantErr: 0.13521 batch_time=0.44405 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 0.00162 (QuantReg: 0.13391) QuantErr: 0.13391 batch_time=0.44032 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 0.00195 (QuantReg: 0.13617) QuantErr: 0.13617 batch_time=0.47229 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 0.00178 (QuantReg: 0.13368) QuantErr: 0.13368 batch_time=0.43478 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 0.00188 (QuantReg: 0.13407) QuantErr: 0.13407 batch_time=0.41871 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 0.00196 (QuantReg: 0.13525) QuantErr: 0.13525 batch_time=0.43744 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 0.00228 (QuantReg: 0.13518) QuantErr: 0.13518 batch_time=0.41855 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 0.00201 (QuantReg: 0.13375) QuantErr: 0.13375 batch_time=0.41790 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 0.00272 (QuantReg: 0.13399) QuantErr: 0.13399 batch_time=0.43203 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.00155 (QuantReg: 0.13467) QuantErr: 0.13467 batch_time=0.63968 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.00217 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=0.42393 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.00294 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.46978 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 0.00187 (QuantReg: 0.13569) QuantErr: 0.13569 batch_time=0.46307 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.00276 (QuantReg: 0.13610) QuantErr: 0.13610 batch_time=0.43186 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch46.pth ...
Done in 10.572s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 0.0020246925354003905
 quant_reg      : 0.13453327810764312
 quant_err      : 0.13453327810764312
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_miech_test/t2v_metrics/R1: 14.0
 MSRVTT_miech_test/t2v_metrics/R5: 43.1
 MSRVTT_miech_test/t2v_metrics/R10: 57.4
 MSRVTT_miech_test/t2v_metrics/R50: 86.6
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.805
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.59660722216022
 MSRVTT_miech_test/v2t_metrics/R1: 14.9
 MSRVTT_miech_test/v2t_metrics/R5: 42.6
 MSRVTT_miech_test/v2t_metrics/R10: 59.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.224
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.45666335066129
 mnt_best       : 32.63049137611581
 not_improved_count: 9
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 0.00209 (QuantReg: 0.13389) QuantErr: 0.13389 batch_time=27.77050 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 0.00305 (QuantReg: 0.13524) QuantErr: 0.13524 batch_time=0.42160 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 0.00201 (QuantReg: 0.13483) QuantErr: 0.13483 batch_time=0.43278 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 0.00212 (QuantReg: 0.13205) QuantErr: 0.13205 batch_time=0.45040 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 0.00212 (QuantReg: 0.13471) QuantErr: 0.13471 batch_time=0.42606 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.00218 (QuantReg: 0.13470) QuantErr: 0.13470 batch_time=0.75769 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 0.00188 (QuantReg: 0.13537) QuantErr: 0.13537 batch_time=0.70793 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 0.00216 (QuantReg: 0.13551) QuantErr: 0.13551 batch_time=0.42353 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 0.00171 (QuantReg: 0.13605) QuantErr: 0.13605 batch_time=0.42122 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.00156 (QuantReg: 0.13487) QuantErr: 0.13487 batch_time=0.43463 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.00197 (QuantReg: 0.13408) QuantErr: 0.13408 batch_time=0.43345 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.00176 (QuantReg: 0.13332) QuantErr: 0.13332 batch_time=0.43433 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 0.00254 (QuantReg: 0.13396) QuantErr: 0.13396 batch_time=0.43804 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.00220 (QuantReg: 0.13193) QuantErr: 0.13193 batch_time=1.15067 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 0.00272 (QuantReg: 0.13419) QuantErr: 0.13419 batch_time=0.86947 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.00157 (QuantReg: 0.13389) QuantErr: 0.13389 batch_time=0.43039 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 0.00178 (QuantReg: 0.13540) QuantErr: 0.13540 batch_time=0.51616 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 0.00169 (QuantReg: 0.13506) QuantErr: 0.13506 batch_time=0.72488 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 0.00220 (QuantReg: 0.13632) QuantErr: 0.13632 batch_time=0.41495 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.00212 (QuantReg: 0.13355) QuantErr: 0.13355 batch_time=0.52598 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.00184 (QuantReg: 0.13298) QuantErr: 0.13298 batch_time=0.41692 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 0.00193 (QuantReg: 0.13632) QuantErr: 0.13632 batch_time=0.42885 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 0.00228 (QuantReg: 0.13519) QuantErr: 0.13519 batch_time=0.46456 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch47.pth ...
Done in 14.062s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch47.pth ...
Done in 17.887s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 0.0020054588317871096
 quant_reg      : 0.13450728386640548
 quant_err      : 0.13450728386640548
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_miech_test/t2v_metrics/R1: 14.5
 MSRVTT_miech_test/t2v_metrics/R5: 42.3
 MSRVTT_miech_test/t2v_metrics/R10: 57.7
 MSRVTT_miech_test/t2v_metrics/R50: 86.3
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.569
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.83180257464103
 MSRVTT_miech_test/v2t_metrics/R1: 14.1
 MSRVTT_miech_test/v2t_metrics/R5: 42.9
 MSRVTT_miech_test/v2t_metrics/R10: 58.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.1
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.808
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.7366925325697
 mnt_best       : 32.83180257464103
 not_improved_count: 0
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 0.00271 (QuantReg: 0.13434) QuantErr: 0.13434 batch_time=25.37438 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 0.00262 (QuantReg: 0.13599) QuantErr: 0.13599 batch_time=0.43755 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 0.00226 (QuantReg: 0.13428) QuantErr: 0.13428 batch_time=0.44947 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 0.00322 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.42531 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 0.00126 (QuantReg: 0.13495) QuantErr: 0.13495 batch_time=0.40641 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 0.00190 (QuantReg: 0.13452) QuantErr: 0.13452 batch_time=0.40908 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 0.00198 (QuantReg: 0.13475) QuantErr: 0.13475 batch_time=0.47652 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 0.00189 (QuantReg: 0.13446) QuantErr: 0.13446 batch_time=0.54541 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.00166 (QuantReg: 0.13549) QuantErr: 0.13549 batch_time=0.44379 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 0.00213 (QuantReg: 0.13410) QuantErr: 0.13410 batch_time=0.41532 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 0.00251 (QuantReg: 0.13394) QuantErr: 0.13394 batch_time=0.43451 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 0.00192 (QuantReg: 0.13422) QuantErr: 0.13422 batch_time=0.42854 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 0.00162 (QuantReg: 0.13462) QuantErr: 0.13462 batch_time=1.05639 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 0.00174 (QuantReg: 0.13502) QuantErr: 0.13502 batch_time=2.11568 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 0.00233 (QuantReg: 0.13550) QuantErr: 0.13550 batch_time=0.44339 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 0.00254 (QuantReg: 0.13410) QuantErr: 0.13410 batch_time=0.41811 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.00259 (QuantReg: 0.13520) QuantErr: 0.13520 batch_time=0.50184 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 0.00174 (QuantReg: 0.13327) QuantErr: 0.13327 batch_time=0.49107 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 0.00219 (QuantReg: 0.13589) QuantErr: 0.13589 batch_time=0.42572 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 0.00204 (QuantReg: 0.13372) QuantErr: 0.13372 batch_time=2.21675 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 0.00229 (QuantReg: 0.13291) QuantErr: 0.13291 batch_time=0.42857 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 0.00249 (QuantReg: 0.13141) QuantErr: 0.13141 batch_time=0.43731 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 0.00227 (QuantReg: 0.13589) QuantErr: 0.13589 batch_time=0.43808 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch48.pth ...
Done in 11.364s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 0.0020163307189941405
 quant_reg      : 0.1346991201043129
 quant_err      : 0.1346991201043129
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_miech_test/t2v_metrics/R1: 14.2
 MSRVTT_miech_test/t2v_metrics/R5: 41.3
 MSRVTT_miech_test/t2v_metrics/R10: 57.0
 MSRVTT_miech_test/t2v_metrics/R50: 86.4
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.353
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.21348791318073
 MSRVTT_miech_test/v2t_metrics/R1: 15.1
 MSRVTT_miech_test/v2t_metrics/R5: 42.0
 MSRVTT_miech_test/v2t_metrics/R10: 57.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.6205
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.064886108453045
 mnt_best       : 32.83180257464103
 not_improved_count: 1
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 0.00227 (QuantReg: 0.13375) QuantErr: 0.13375 batch_time=28.62879 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 0.00132 (QuantReg: 0.13216) QuantErr: 0.13216 batch_time=0.43618 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 0.00218 (QuantReg: 0.13365) QuantErr: 0.13365 batch_time=0.43080 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 0.00235 (QuantReg: 0.13366) QuantErr: 0.13366 batch_time=0.44916 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 0.00176 (QuantReg: 0.13396) QuantErr: 0.13396 batch_time=0.44136 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 0.00146 (QuantReg: 0.13658) QuantErr: 0.13658 batch_time=0.44874 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 0.00226 (QuantReg: 0.13627) QuantErr: 0.13627 batch_time=0.42948 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.00191 (QuantReg: 0.13563) QuantErr: 0.13563 batch_time=0.42225 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.00227 (QuantReg: 0.13504) QuantErr: 0.13504 batch_time=0.43835 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.00160 (QuantReg: 0.13405) QuantErr: 0.13405 batch_time=0.45922 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 0.00204 (QuantReg: 0.13619) QuantErr: 0.13619 batch_time=0.43921 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.00218 (QuantReg: 0.13449) QuantErr: 0.13449 batch_time=0.44373 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 0.00161 (QuantReg: 0.13609) QuantErr: 0.13609 batch_time=0.44758 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 0.00175 (QuantReg: 0.13493) QuantErr: 0.13493 batch_time=0.49893 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 0.00141 (QuantReg: 0.13263) QuantErr: 0.13263 batch_time=0.45303 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.00251 (QuantReg: 0.13533) QuantErr: 0.13533 batch_time=0.68023 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.00245 (QuantReg: 0.13505) QuantErr: 0.13505 batch_time=0.42226 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 0.00172 (QuantReg: 0.13339) QuantErr: 0.13339 batch_time=0.42409 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 0.00280 (QuantReg: 0.13564) QuantErr: 0.13564 batch_time=0.44594 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 0.00142 (QuantReg: 0.13850) QuantErr: 0.13850 batch_time=0.43493 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 0.00200 (QuantReg: 0.13490) QuantErr: 0.13490 batch_time=0.45087 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.00179 (QuantReg: 0.13655) QuantErr: 0.13655 batch_time=0.45746 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 0.00191 (QuantReg: 0.13331) QuantErr: 0.13331 batch_time=0.43164 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch49.pth ...
Done in 10.785s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch49.pth ...
Done in 14.804s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 0.0020432357788085936
 quant_reg      : 0.13470131337642668
 quant_err      : 0.13470131337642668
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_miech_test/t2v_metrics/R1: 14.9
 MSRVTT_miech_test/t2v_metrics/R5: 42.5
 MSRVTT_miech_test/t2v_metrics/R10: 57.7
 MSRVTT_miech_test/t2v_metrics/R50: 86.9
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.046
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.18310367083518
 MSRVTT_miech_test/v2t_metrics/R1: 15.3
 MSRVTT_miech_test/v2t_metrics/R5: 43.5
 MSRVTT_miech_test/v2t_metrics/R10: 59.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.785
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.00864976005801
 mnt_best       : 33.18310367083518
 not_improved_count: 0
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 0.00201 (QuantReg: 0.13463) QuantErr: 0.13463 batch_time=28.38735 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 0.00214 (QuantReg: 0.13397) QuantErr: 0.13397 batch_time=0.41238 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 0.00179 (QuantReg: 0.13345) QuantErr: 0.13345 batch_time=0.59151 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 0.00170 (QuantReg: 0.13270) QuantErr: 0.13270 batch_time=0.42195 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 0.00201 (QuantReg: 0.13373) QuantErr: 0.13373 batch_time=0.43614 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.00241 (QuantReg: 0.13453) QuantErr: 0.13453 batch_time=0.42238 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 0.00215 (QuantReg: 0.13450) QuantErr: 0.13450 batch_time=0.90848 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.00219 (QuantReg: 0.13474) QuantErr: 0.13474 batch_time=0.45736 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.00196 (QuantReg: 0.13497) QuantErr: 0.13497 batch_time=0.43204 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 0.00171 (QuantReg: 0.13693) QuantErr: 0.13693 batch_time=0.45535 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.00177 (QuantReg: 0.13735) QuantErr: 0.13735 batch_time=0.42787 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.00272 (QuantReg: 0.13522) QuantErr: 0.13522 batch_time=0.43022 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 0.00216 (QuantReg: 0.13606) QuantErr: 0.13606 batch_time=0.44523 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 0.00214 (QuantReg: 0.13413) QuantErr: 0.13413 batch_time=1.77723 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 0.00115 (QuantReg: 0.13543) QuantErr: 0.13543 batch_time=0.48200 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.00129 (QuantReg: 0.13531) QuantErr: 0.13531 batch_time=0.46665 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 0.00266 (QuantReg: 0.13681) QuantErr: 0.13681 batch_time=0.56586 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 0.00394 (QuantReg: 0.13748) QuantErr: 0.13748 batch_time=0.46448 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.00154 (QuantReg: 0.13407) QuantErr: 0.13407 batch_time=0.43201 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.00153 (QuantReg: 0.13512) QuantErr: 0.13512 batch_time=0.43939 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 0.00212 (QuantReg: 0.13129) QuantErr: 0.13129 batch_time=0.45008 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 0.00211 (QuantReg: 0.13402) QuantErr: 0.13402 batch_time=0.43630 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 0.00207 (QuantReg: 0.13254) QuantErr: 0.13254 batch_time=0.42549 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/checkpoint-epoch50.pth ...
Done in 7.389s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 0.00195703125
 quant_reg      : 0.13479655504226684
 quant_err      : 0.13479655504226684
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_miech_test/t2v_metrics/R1: 15.0
 MSRVTT_miech_test/t2v_metrics/R5: 41.2
 MSRVTT_miech_test/t2v_metrics/R10: 57.0
 MSRVTT_miech_test/t2v_metrics/R50: 86.2
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.168
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.780917911256616
 MSRVTT_miech_test/v2t_metrics/R1: 15.3
 MSRVTT_miech_test/v2t_metrics/R5: 42.8
 MSRVTT_miech_test/v2t_metrics/R10: 58.5
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.98
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.71038314426221
 mnt_best       : 33.18310367083518
 not_improved_count: 1
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/trained_model.pth ...
Ckpt loaded at epoch 49.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/MSRVTT-test-qt-sims.npy
MSRVTT_miech_test:
 t2v_metrics/R1/final_eval: 14.9
 t2v_metrics/R5/final_eval: 42.5
 t2v_metrics/R10/final_eval: 57.7
 t2v_metrics/R50/final_eval: 86.9
 t2v_metrics/MedR/final_eval: 7.0
 t2v_metrics/MeanR/final_eval: 33.046
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 33.18310367083518
 v2t_metrics/R1/final_eval: 15.3
 v2t_metrics/R5/final_eval: 43.5
 v2t_metrics/R10/final_eval: 59.1
 v2t_metrics/R50/final_eval: 88.3
 v2t_metrics/MedR/final_eval: 7.0
 v2t_metrics/MeanR/final_eval: 27.785
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 34.00864976005801
Best epoch for the monitored metric: 49
Script took 03h09m31s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/JPQ_MSRVTT_1kB/trained_model.pth
