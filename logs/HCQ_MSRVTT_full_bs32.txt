Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 868.8662850856781 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 54.46300005912781 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 294.0882821083069 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 163.2998170852661 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch0.pth ...
Done in 2.277s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch0.pth ...
Done in 4.023s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.0
 MSRVTT_full_val/t2v_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R10: 1.6096579476861168
 MSRVTT_full_val/t2v_metrics/R50: 8.450704225352112
 MSRVTT_full_val/t2v_metrics/MedR: 252.0
 MSRVTT_full_val/t2v_metrics/MeanR: 251.21730382293762
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_val/v2t_metrics/R1: 0.0
 MSRVTT_full_val/v2t_metrics/R5: 0.8048289738430584
 MSRVTT_full_val/v2t_metrics/R10: 2.0120724346076457
 MSRVTT_full_val/v2t_metrics/R50: 9.054325955734406
 MSRVTT_full_val/v2t_metrics/MedR: 243.0
 MSRVTT_full_val/v2t_metrics/MeanR: 247.7344064386318
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/t2v_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.26755852842809363
 MSRVTT_full_test/t2v_metrics/R50: 1.705685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 1515.0
 MSRVTT_full_test/t2v_metrics/MeanR: 1498.556856187291
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.12154652794863813
 MSRVTT_full_test/v2t_metrics/R1: 0.06688963210702341
 MSRVTT_full_test/v2t_metrics/R5: 0.16722408026755853
 MSRVTT_full_test/v2t_metrics/R10: 0.3010033444816054
 MSRVTT_full_test/v2t_metrics/R50: 1.806020066889632
 MSRVTT_full_test/v2t_metrics/MedR: 1471.5
 MSRVTT_full_test/v2t_metrics/MeanR: 1495.3257525083611
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.14987975740993859
 mnt_best       : 0.12154652794863813
 not_improved_count: 0
Train Epoch: 1 [1/1000 32/32000 (0%)] Loss: 7.04272 (QuantReg: 22.48269) QuantErr: 22.48269 batch_time=31.97240 
Train Epoch: 1 [6/1000 192/32000 (1%)] Loss: 6.81952 (QuantReg: 22.34209) QuantErr: 22.34209 batch_time=0.41603 
Train Epoch: 1 [11/1000 352/32000 (1%)] Loss: 6.66473 (QuantReg: 22.38163) QuantErr: 22.38163 batch_time=0.38937 
Train Epoch: 1 [16/1000 512/32000 (2%)] Loss: 6.44596 (QuantReg: 22.50530) QuantErr: 22.50530 batch_time=0.41054 
Train Epoch: 1 [21/1000 672/32000 (2%)] Loss: 6.26222 (QuantReg: 22.68782) QuantErr: 22.68782 batch_time=0.34383 
Train Epoch: 1 [26/1000 832/32000 (3%)] Loss: 5.32076 (QuantReg: 22.72933) QuantErr: 22.72933 batch_time=0.34525 
Train Epoch: 1 [31/1000 992/32000 (3%)] Loss: 6.12830 (QuantReg: 22.70938) QuantErr: 22.70938 batch_time=0.34413 
Train Epoch: 1 [36/1000 1152/32000 (4%)] Loss: 5.47971 (QuantReg: 22.64778) QuantErr: 22.64778 batch_time=0.34158 
Train Epoch: 1 [41/1000 1312/32000 (4%)] Loss: 4.54023 (QuantReg: 22.73712) QuantErr: 22.73712 batch_time=0.34508 
Train Epoch: 1 [46/1000 1472/32000 (5%)] Loss: 5.12996 (QuantReg: 22.64641) QuantErr: 22.64641 batch_time=0.33980 
Train Epoch: 1 [51/1000 1632/32000 (5%)] Loss: 3.86754 (QuantReg: 22.73706) QuantErr: 22.73706 batch_time=0.40030 
Train Epoch: 1 [56/1000 1792/32000 (6%)] Loss: 4.98529 (QuantReg: 22.68209) QuantErr: 22.68209 batch_time=0.35335 
Train Epoch: 1 [61/1000 1952/32000 (6%)] Loss: 3.77340 (QuantReg: 22.69673) QuantErr: 22.69673 batch_time=0.34630 
Train Epoch: 1 [66/1000 2112/32000 (7%)] Loss: 4.45645 (QuantReg: 22.68913) QuantErr: 22.68913 batch_time=0.40156 
Train Epoch: 1 [71/1000 2272/32000 (7%)] Loss: 4.18332 (QuantReg: 22.77599) QuantErr: 22.77599 batch_time=0.85999 
Train Epoch: 1 [76/1000 2432/32000 (8%)] Loss: 4.45962 (QuantReg: 22.76240) QuantErr: 22.76240 batch_time=0.35034 
Train Epoch: 1 [81/1000 2592/32000 (8%)] Loss: 3.44982 (QuantReg: 22.75740) QuantErr: 22.75740 batch_time=0.36545 
Train Epoch: 1 [86/1000 2752/32000 (9%)] Loss: 3.85904 (QuantReg: 22.67442) QuantErr: 22.67442 batch_time=0.34696 
Train Epoch: 1 [91/1000 2912/32000 (9%)] Loss: 3.47777 (QuantReg: 22.63681) QuantErr: 22.63681 batch_time=0.34633 
Train Epoch: 1 [96/1000 3072/32000 (10%)] Loss: 2.92091 (QuantReg: 22.65938) QuantErr: 22.65938 batch_time=0.35095 
Train Epoch: 1 [101/1000 3232/32000 (10%)] Loss: 4.83942 (QuantReg: 22.75492) QuantErr: 22.75492 batch_time=0.74292 
Train Epoch: 1 [106/1000 3392/32000 (11%)] Loss: 4.16246 (QuantReg: 22.60150) QuantErr: 22.60150 batch_time=0.35257 
Train Epoch: 1 [111/1000 3552/32000 (11%)] Loss: 3.49350 (QuantReg: 22.65672) QuantErr: 22.65672 batch_time=0.36796 
Train Epoch: 1 [116/1000 3712/32000 (12%)] Loss: 3.69647 (QuantReg: 22.71702) QuantErr: 22.71702 batch_time=0.34376 
Train Epoch: 1 [121/1000 3872/32000 (12%)] Loss: 3.19094 (QuantReg: 22.65881) QuantErr: 22.65881 batch_time=0.33847 
Train Epoch: 1 [126/1000 4032/32000 (13%)] Loss: 3.25526 (QuantReg: 22.64042) QuantErr: 22.64042 batch_time=0.33648 
Train Epoch: 1 [131/1000 4192/32000 (13%)] Loss: 3.78201 (QuantReg: 22.62104) QuantErr: 22.62104 batch_time=0.40123 
Train Epoch: 1 [136/1000 4352/32000 (14%)] Loss: 3.66934 (QuantReg: 22.67488) QuantErr: 22.67488 batch_time=0.34181 
Train Epoch: 1 [141/1000 4512/32000 (14%)] Loss: 3.16117 (QuantReg: 22.69384) QuantErr: 22.69384 batch_time=0.36822 
Train Epoch: 1 [146/1000 4672/32000 (15%)] Loss: 3.90185 (QuantReg: 22.62122) QuantErr: 22.62122 batch_time=0.38084 
Train Epoch: 1 [151/1000 4832/32000 (15%)] Loss: 3.43556 (QuantReg: 22.68815) QuantErr: 22.68815 batch_time=0.38518 
Train Epoch: 1 [156/1000 4992/32000 (16%)] Loss: 3.26768 (QuantReg: 22.70041) QuantErr: 22.70041 batch_time=0.44483 
Train Epoch: 1 [161/1000 5152/32000 (16%)] Loss: 2.92971 (QuantReg: 22.63896) QuantErr: 22.63896 batch_time=0.37594 
Train Epoch: 1 [166/1000 5312/32000 (17%)] Loss: 2.90026 (QuantReg: 22.60519) QuantErr: 22.60519 batch_time=0.34347 
Train Epoch: 1 [171/1000 5472/32000 (17%)] Loss: 4.51664 (QuantReg: 22.64097) QuantErr: 22.64097 batch_time=0.36527 
Train Epoch: 1 [176/1000 5632/32000 (18%)] Loss: 3.06233 (QuantReg: 22.66745) QuantErr: 22.66745 batch_time=0.34317 
Train Epoch: 1 [181/1000 5792/32000 (18%)] Loss: 3.48683 (QuantReg: 22.67006) QuantErr: 22.67006 batch_time=0.34850 
Train Epoch: 1 [186/1000 5952/32000 (19%)] Loss: 2.68890 (QuantReg: 22.67271) QuantErr: 22.67271 batch_time=0.37450 
Train Epoch: 1 [191/1000 6112/32000 (19%)] Loss: 3.42845 (QuantReg: 22.65973) QuantErr: 22.65973 batch_time=0.35106 
Train Epoch: 1 [196/1000 6272/32000 (20%)] Loss: 3.31125 (QuantReg: 22.65620) QuantErr: 22.65620 batch_time=0.34593 
Train Epoch: 1 [201/1000 6432/32000 (20%)] Loss: 4.02432 (QuantReg: 22.65170) QuantErr: 22.65170 batch_time=0.77877 
Train Epoch: 1 [206/1000 6592/32000 (21%)] Loss: 2.84479 (QuantReg: 22.62074) QuantErr: 22.62074 batch_time=0.84016 
Train Epoch: 1 [211/1000 6752/32000 (21%)] Loss: 3.42311 (QuantReg: 22.63823) QuantErr: 22.63823 batch_time=0.36304 
Train Epoch: 1 [216/1000 6912/32000 (22%)] Loss: 3.31975 (QuantReg: 22.70119) QuantErr: 22.70119 batch_time=0.36201 
Train Epoch: 1 [221/1000 7072/32000 (22%)] Loss: 3.04678 (QuantReg: 22.71708) QuantErr: 22.71708 batch_time=0.34071 
Train Epoch: 1 [226/1000 7232/32000 (23%)] Loss: 2.82963 (QuantReg: 22.74298) QuantErr: 22.74298 batch_time=0.37830 
Train Epoch: 1 [231/1000 7392/32000 (23%)] Loss: 2.76983 (QuantReg: 22.66928) QuantErr: 22.66928 batch_time=0.34541 
Train Epoch: 1 [236/1000 7552/32000 (24%)] Loss: 3.06088 (QuantReg: 22.63371) QuantErr: 22.63371 batch_time=0.34364 
Train Epoch: 1 [241/1000 7712/32000 (24%)] Loss: 3.80241 (QuantReg: 22.70824) QuantErr: 22.70824 batch_time=0.35399 
Train Epoch: 1 [246/1000 7872/32000 (25%)] Loss: 3.94669 (QuantReg: 22.71899) QuantErr: 22.71899 batch_time=0.44391 
Train Epoch: 1 [251/1000 8032/32000 (25%)] Loss: 2.76480 (QuantReg: 22.73082) QuantErr: 22.73082 batch_time=0.41519 
Train Epoch: 1 [256/1000 8192/32000 (26%)] Loss: 3.13825 (QuantReg: 22.76425) QuantErr: 22.76425 batch_time=0.35589 
Train Epoch: 1 [261/1000 8352/32000 (26%)] Loss: 3.29936 (QuantReg: 22.72875) QuantErr: 22.72875 batch_time=0.33977 
Train Epoch: 1 [266/1000 8512/32000 (27%)] Loss: 2.88026 (QuantReg: 22.69217) QuantErr: 22.69217 batch_time=0.36381 
Train Epoch: 1 [271/1000 8672/32000 (27%)] Loss: 2.66330 (QuantReg: 22.74224) QuantErr: 22.74224 batch_time=0.35406 
Train Epoch: 1 [276/1000 8832/32000 (28%)] Loss: 1.98751 (QuantReg: 22.70329) QuantErr: 22.70329 batch_time=0.34144 
Train Epoch: 1 [281/1000 8992/32000 (28%)] Loss: 2.79783 (QuantReg: 22.70666) QuantErr: 22.70666 batch_time=0.37615 
Train Epoch: 1 [286/1000 9152/32000 (29%)] Loss: 3.07128 (QuantReg: 22.71151) QuantErr: 22.71151 batch_time=0.40828 
Train Epoch: 1 [291/1000 9312/32000 (29%)] Loss: 2.28354 (QuantReg: 22.67202) QuantErr: 22.67202 batch_time=0.41533 
Train Epoch: 1 [296/1000 9472/32000 (30%)] Loss: 2.55235 (QuantReg: 22.64293) QuantErr: 22.64293 batch_time=0.39280 
Train Epoch: 1 [301/1000 9632/32000 (30%)] Loss: 2.63599 (QuantReg: 22.68405) QuantErr: 22.68405 batch_time=0.43425 
Train Epoch: 1 [306/1000 9792/32000 (31%)] Loss: 2.23134 (QuantReg: 22.69449) QuantErr: 22.69449 batch_time=0.52128 
Train Epoch: 1 [311/1000 9952/32000 (31%)] Loss: 2.94406 (QuantReg: 22.67337) QuantErr: 22.67337 batch_time=0.35835 
Train Epoch: 1 [316/1000 10112/32000 (32%)] Loss: 2.59906 (QuantReg: 22.75315) QuantErr: 22.75315 batch_time=0.35382 
Train Epoch: 1 [321/1000 10272/32000 (32%)] Loss: 3.24747 (QuantReg: 22.66147) QuantErr: 22.66147 batch_time=0.38338 
Train Epoch: 1 [326/1000 10432/32000 (33%)] Loss: 2.10128 (QuantReg: 22.65427) QuantErr: 22.65427 batch_time=0.34839 
Train Epoch: 1 [331/1000 10592/32000 (33%)] Loss: 3.02655 (QuantReg: 22.66092) QuantErr: 22.66092 batch_time=0.34520 
Train Epoch: 1 [336/1000 10752/32000 (34%)] Loss: 2.59360 (QuantReg: 22.66982) QuantErr: 22.66982 batch_time=0.40166 
Train Epoch: 1 [341/1000 10912/32000 (34%)] Loss: 3.59259 (QuantReg: 22.81258) QuantErr: 22.81258 batch_time=0.34661 
Train Epoch: 1 [346/1000 11072/32000 (35%)] Loss: 2.68538 (QuantReg: 22.64242) QuantErr: 22.64242 batch_time=0.35004 
Train Epoch: 1 [351/1000 11232/32000 (35%)] Loss: 2.41547 (QuantReg: 22.71288) QuantErr: 22.71288 batch_time=0.35570 
Train Epoch: 1 [356/1000 11392/32000 (36%)] Loss: 2.52414 (QuantReg: 22.66645) QuantErr: 22.66645 batch_time=0.34056 
Train Epoch: 1 [361/1000 11552/32000 (36%)] Loss: 2.46600 (QuantReg: 22.62478) QuantErr: 22.62478 batch_time=0.35405 
Train Epoch: 1 [366/1000 11712/32000 (37%)] Loss: 2.22186 (QuantReg: 22.63989) QuantErr: 22.63989 batch_time=0.34356 
Train Epoch: 1 [371/1000 11872/32000 (37%)] Loss: 2.97589 (QuantReg: 22.70384) QuantErr: 22.70384 batch_time=0.34830 
Train Epoch: 1 [376/1000 12032/32000 (38%)] Loss: 3.34927 (QuantReg: 22.66461) QuantErr: 22.66461 batch_time=0.34590 
Train Epoch: 1 [381/1000 12192/32000 (38%)] Loss: 1.92389 (QuantReg: 22.63211) QuantErr: 22.63211 batch_time=0.34131 
Train Epoch: 1 [386/1000 12352/32000 (39%)] Loss: 2.76545 (QuantReg: 22.79970) QuantErr: 22.79970 batch_time=0.37998 
Train Epoch: 1 [391/1000 12512/32000 (39%)] Loss: 2.16010 (QuantReg: 22.67632) QuantErr: 22.67632 batch_time=0.88338 
Train Epoch: 1 [396/1000 12672/32000 (40%)] Loss: 2.97161 (QuantReg: 22.74187) QuantErr: 22.74187 batch_time=0.35391 
Train Epoch: 1 [401/1000 12832/32000 (40%)] Loss: 1.75995 (QuantReg: 22.70959) QuantErr: 22.70959 batch_time=0.36646 
Train Epoch: 1 [406/1000 12992/32000 (41%)] Loss: 2.10928 (QuantReg: 22.69950) QuantErr: 22.69950 batch_time=0.41719 
Train Epoch: 1 [411/1000 13152/32000 (41%)] Loss: 3.10104 (QuantReg: 22.67245) QuantErr: 22.67245 batch_time=0.42483 
Train Epoch: 1 [416/1000 13312/32000 (42%)] Loss: 2.55819 (QuantReg: 22.69368) QuantErr: 22.69368 batch_time=0.40865 
Train Epoch: 1 [421/1000 13472/32000 (42%)] Loss: 2.40749 (QuantReg: 22.72647) QuantErr: 22.72647 batch_time=0.58778 
Train Epoch: 1 [426/1000 13632/32000 (43%)] Loss: 2.96215 (QuantReg: 22.72155) QuantErr: 22.72155 batch_time=0.35161 
Train Epoch: 1 [431/1000 13792/32000 (43%)] Loss: 2.40423 (QuantReg: 22.74042) QuantErr: 22.74042 batch_time=0.36853 
Train Epoch: 1 [436/1000 13952/32000 (44%)] Loss: 2.34294 (QuantReg: 22.66149) QuantErr: 22.66149 batch_time=0.37981 
Train Epoch: 1 [441/1000 14112/32000 (44%)] Loss: 2.46813 (QuantReg: 22.77653) QuantErr: 22.77653 batch_time=0.34688 
Train Epoch: 1 [446/1000 14272/32000 (45%)] Loss: 2.19618 (QuantReg: 22.69067) QuantErr: 22.69067 batch_time=0.35065 
Train Epoch: 1 [451/1000 14432/32000 (45%)] Loss: 2.49690 (QuantReg: 22.76560) QuantErr: 22.76560 batch_time=0.47083 
Train Epoch: 1 [456/1000 14592/32000 (46%)] Loss: 1.96745 (QuantReg: 22.73124) QuantErr: 22.73124 batch_time=0.35487 
Train Epoch: 1 [461/1000 14752/32000 (46%)] Loss: 2.50556 (QuantReg: 22.73091) QuantErr: 22.73091 batch_time=0.39136 
Train Epoch: 1 [466/1000 14912/32000 (47%)] Loss: 1.86776 (QuantReg: 22.74369) QuantErr: 22.74369 batch_time=0.36752 
Train Epoch: 1 [471/1000 15072/32000 (47%)] Loss: 2.80571 (QuantReg: 22.65197) QuantErr: 22.65197 batch_time=0.35371 
Train Epoch: 1 [476/1000 15232/32000 (48%)] Loss: 2.76326 (QuantReg: 22.64577) QuantErr: 22.64577 batch_time=0.37797 
Train Epoch: 1 [481/1000 15392/32000 (48%)] Loss: 2.48664 (QuantReg: 22.63783) QuantErr: 22.63783 batch_time=0.38842 
Train Epoch: 1 [486/1000 15552/32000 (49%)] Loss: 3.02494 (QuantReg: 22.67094) QuantErr: 22.67094 batch_time=0.35710 
Train Epoch: 1 [491/1000 15712/32000 (49%)] Loss: 3.23380 (QuantReg: 22.60925) QuantErr: 22.60925 batch_time=0.35015 
Train Epoch: 1 [496/1000 15872/32000 (50%)] Loss: 2.07007 (QuantReg: 22.67678) QuantErr: 22.67678 batch_time=0.38637 
Train Epoch: 1 [501/1000 16032/32000 (50%)] Loss: 2.62004 (QuantReg: 22.67497) QuantErr: 22.67497 batch_time=0.34999 
Train Epoch: 1 [506/1000 16192/32000 (51%)] Loss: 1.83674 (QuantReg: 22.75694) QuantErr: 22.75694 batch_time=0.38598 
Train Epoch: 1 [511/1000 16352/32000 (51%)] Loss: 2.62527 (QuantReg: 22.66453) QuantErr: 22.66453 batch_time=0.39873 
Train Epoch: 1 [516/1000 16512/32000 (52%)] Loss: 2.47823 (QuantReg: 22.77145) QuantErr: 22.77145 batch_time=0.34512 
Train Epoch: 1 [521/1000 16672/32000 (52%)] Loss: 2.38470 (QuantReg: 22.65091) QuantErr: 22.65091 batch_time=0.80848 
Train Epoch: 1 [526/1000 16832/32000 (53%)] Loss: 3.55794 (QuantReg: 22.73225) QuantErr: 22.73225 batch_time=0.81445 
Train Epoch: 1 [531/1000 16992/32000 (53%)] Loss: 2.59809 (QuantReg: 22.71475) QuantErr: 22.71475 batch_time=0.35915 
Train Epoch: 1 [536/1000 17152/32000 (54%)] Loss: 2.32770 (QuantReg: 22.64711) QuantErr: 22.64711 batch_time=0.35855 
Train Epoch: 1 [541/1000 17312/32000 (54%)] Loss: 2.83099 (QuantReg: 22.68849) QuantErr: 22.68849 batch_time=0.34884 
Train Epoch: 1 [546/1000 17472/32000 (55%)] Loss: 2.06568 (QuantReg: 22.73232) QuantErr: 22.73232 batch_time=0.34331 
Train Epoch: 1 [551/1000 17632/32000 (55%)] Loss: 2.38990 (QuantReg: 22.77782) QuantErr: 22.77782 batch_time=0.36026 
Train Epoch: 1 [556/1000 17792/32000 (56%)] Loss: 3.05263 (QuantReg: 22.67388) QuantErr: 22.67388 batch_time=0.40741 
Train Epoch: 1 [561/1000 17952/32000 (56%)] Loss: 2.47965 (QuantReg: 22.72561) QuantErr: 22.72561 batch_time=0.50913 
Train Epoch: 1 [566/1000 18112/32000 (57%)] Loss: 2.64950 (QuantReg: 22.69998) QuantErr: 22.69998 batch_time=0.51306 
Train Epoch: 1 [571/1000 18272/32000 (57%)] Loss: 2.94006 (QuantReg: 22.67748) QuantErr: 22.67748 batch_time=0.40070 
Train Epoch: 1 [576/1000 18432/32000 (58%)] Loss: 2.76905 (QuantReg: 22.63289) QuantErr: 22.63289 batch_time=0.36739 
Train Epoch: 1 [581/1000 18592/32000 (58%)] Loss: 2.17896 (QuantReg: 22.59227) QuantErr: 22.59227 batch_time=0.34855 
Train Epoch: 1 [586/1000 18752/32000 (59%)] Loss: 2.78691 (QuantReg: 22.60645) QuantErr: 22.60645 batch_time=0.33928 
Train Epoch: 1 [591/1000 18912/32000 (59%)] Loss: 2.13620 (QuantReg: 22.59343) QuantErr: 22.59343 batch_time=0.33787 
Train Epoch: 1 [596/1000 19072/32000 (60%)] Loss: 2.40707 (QuantReg: 22.58446) QuantErr: 22.58446 batch_time=0.34661 
Train Epoch: 1 [601/1000 19232/32000 (60%)] Loss: 2.21073 (QuantReg: 22.59999) QuantErr: 22.59999 batch_time=0.36277 
Train Epoch: 1 [606/1000 19392/32000 (61%)] Loss: 1.65059 (QuantReg: 22.60907) QuantErr: 22.60907 batch_time=0.35996 
Train Epoch: 1 [611/1000 19552/32000 (61%)] Loss: 2.68322 (QuantReg: 22.61990) QuantErr: 22.61990 batch_time=0.34938 
Train Epoch: 1 [616/1000 19712/32000 (62%)] Loss: 1.99740 (QuantReg: 22.64708) QuantErr: 22.64708 batch_time=0.34485 
Train Epoch: 1 [621/1000 19872/32000 (62%)] Loss: 2.64607 (QuantReg: 22.58323) QuantErr: 22.58323 batch_time=0.35282 
Train Epoch: 1 [626/1000 20032/32000 (63%)] Loss: 1.81786 (QuantReg: 22.62790) QuantErr: 22.62790 batch_time=0.45856 
Train Epoch: 1 [631/1000 20192/32000 (63%)] Loss: 2.86763 (QuantReg: 22.69928) QuantErr: 22.69928 batch_time=0.37069 
Train Epoch: 1 [636/1000 20352/32000 (64%)] Loss: 2.07411 (QuantReg: 22.64809) QuantErr: 22.64809 batch_time=0.41187 
Train Epoch: 1 [641/1000 20512/32000 (64%)] Loss: 2.52744 (QuantReg: 22.63502) QuantErr: 22.63502 batch_time=0.44999 
Train Epoch: 1 [646/1000 20672/32000 (65%)] Loss: 2.42471 (QuantReg: 22.60588) QuantErr: 22.60588 batch_time=0.40761 
Train Epoch: 1 [651/1000 20832/32000 (65%)] Loss: 2.86680 (QuantReg: 22.66224) QuantErr: 22.66224 batch_time=0.37855 
Train Epoch: 1 [656/1000 20992/32000 (66%)] Loss: 2.88534 (QuantReg: 22.64927) QuantErr: 22.64927 batch_time=0.45505 
Train Epoch: 1 [661/1000 21152/32000 (66%)] Loss: 2.92971 (QuantReg: 22.64375) QuantErr: 22.64375 batch_time=0.40551 
Train Epoch: 1 [666/1000 21312/32000 (67%)] Loss: 2.93842 (QuantReg: 22.68085) QuantErr: 22.68085 batch_time=0.35714 
Train Epoch: 1 [671/1000 21472/32000 (67%)] Loss: 2.36747 (QuantReg: 22.67841) QuantErr: 22.67841 batch_time=0.36105 
Train Epoch: 1 [676/1000 21632/32000 (68%)] Loss: 3.27208 (QuantReg: 22.66646) QuantErr: 22.66646 batch_time=0.38787 
Train Epoch: 1 [681/1000 21792/32000 (68%)] Loss: 2.10942 (QuantReg: 22.64262) QuantErr: 22.64262 batch_time=0.35507 
Train Epoch: 1 [686/1000 21952/32000 (69%)] Loss: 2.04161 (QuantReg: 22.70693) QuantErr: 22.70693 batch_time=0.40430 
Train Epoch: 1 [691/1000 22112/32000 (69%)] Loss: 2.35344 (QuantReg: 22.63346) QuantErr: 22.63346 batch_time=0.34677 
Train Epoch: 1 [696/1000 22272/32000 (70%)] Loss: 2.03320 (QuantReg: 22.65210) QuantErr: 22.65210 batch_time=0.34416 
Train Epoch: 1 [701/1000 22432/32000 (70%)] Loss: 1.96230 (QuantReg: 22.70963) QuantErr: 22.70963 batch_time=0.34914 
Train Epoch: 1 [706/1000 22592/32000 (71%)] Loss: 2.61015 (QuantReg: 22.69826) QuantErr: 22.69826 batch_time=0.43410 
Train Epoch: 1 [711/1000 22752/32000 (71%)] Loss: 2.19425 (QuantReg: 22.62624) QuantErr: 22.62624 batch_time=0.97956 
Train Epoch: 1 [716/1000 22912/32000 (72%)] Loss: 2.82141 (QuantReg: 22.73886) QuantErr: 22.73886 batch_time=0.35132 
Train Epoch: 1 [721/1000 23072/32000 (72%)] Loss: 2.13057 (QuantReg: 22.65240) QuantErr: 22.65240 batch_time=0.35106 
Train Epoch: 1 [726/1000 23232/32000 (73%)] Loss: 2.31536 (QuantReg: 22.71860) QuantErr: 22.71860 batch_time=0.35370 
Train Epoch: 1 [731/1000 23392/32000 (73%)] Loss: 2.34494 (QuantReg: 22.69121) QuantErr: 22.69121 batch_time=0.34138 
Train Epoch: 1 [736/1000 23552/32000 (74%)] Loss: 2.32014 (QuantReg: 22.74516) QuantErr: 22.74516 batch_time=0.38228 
Train Epoch: 1 [741/1000 23712/32000 (74%)] Loss: 2.16393 (QuantReg: 22.72364) QuantErr: 22.72364 batch_time=0.60758 
Train Epoch: 1 [746/1000 23872/32000 (75%)] Loss: 2.30602 (QuantReg: 22.69243) QuantErr: 22.69243 batch_time=0.41957 
Train Epoch: 1 [751/1000 24032/32000 (75%)] Loss: 1.57574 (QuantReg: 22.67947) QuantErr: 22.67947 batch_time=0.43714 
Train Epoch: 1 [756/1000 24192/32000 (76%)] Loss: 1.90492 (QuantReg: 22.66558) QuantErr: 22.66558 batch_time=0.38288 
Train Epoch: 1 [761/1000 24352/32000 (76%)] Loss: 2.36381 (QuantReg: 22.63128) QuantErr: 22.63128 batch_time=0.46463 
Train Epoch: 1 [766/1000 24512/32000 (77%)] Loss: 1.84868 (QuantReg: 22.66857) QuantErr: 22.66857 batch_time=0.45801 
Train Epoch: 1 [771/1000 24672/32000 (77%)] Loss: 1.96855 (QuantReg: 22.62863) QuantErr: 22.62863 batch_time=0.43836 
Train Epoch: 1 [776/1000 24832/32000 (78%)] Loss: 1.81536 (QuantReg: 22.67056) QuantErr: 22.67056 batch_time=0.38798 
Train Epoch: 1 [781/1000 24992/32000 (78%)] Loss: 1.69564 (QuantReg: 22.67250) QuantErr: 22.67250 batch_time=0.42780 
Train Epoch: 1 [786/1000 25152/32000 (79%)] Loss: 3.21535 (QuantReg: 22.64255) QuantErr: 22.64255 batch_time=0.35856 
Train Epoch: 1 [791/1000 25312/32000 (79%)] Loss: 1.95301 (QuantReg: 22.67228) QuantErr: 22.67228 batch_time=0.41308 
Train Epoch: 1 [796/1000 25472/32000 (80%)] Loss: 2.75114 (QuantReg: 22.63896) QuantErr: 22.63896 batch_time=0.35005 
Train Epoch: 1 [801/1000 25632/32000 (80%)] Loss: 2.15996 (QuantReg: 22.66648) QuantErr: 22.66648 batch_time=0.40365 
Train Epoch: 1 [806/1000 25792/32000 (81%)] Loss: 2.11019 (QuantReg: 22.66666) QuantErr: 22.66666 batch_time=0.38124 
Train Epoch: 1 [811/1000 25952/32000 (81%)] Loss: 1.78083 (QuantReg: 22.66971) QuantErr: 22.66971 batch_time=0.38434 
Train Epoch: 1 [816/1000 26112/32000 (82%)] Loss: 2.04614 (QuantReg: 22.65459) QuantErr: 22.65459 batch_time=0.38960 
Train Epoch: 1 [821/1000 26272/32000 (82%)] Loss: 1.92731 (QuantReg: 22.65490) QuantErr: 22.65490 batch_time=0.36058 
Train Epoch: 1 [826/1000 26432/32000 (83%)] Loss: 2.23991 (QuantReg: 22.68044) QuantErr: 22.68044 batch_time=0.36435 
Train Epoch: 1 [831/1000 26592/32000 (83%)] Loss: 1.89255 (QuantReg: 22.66753) QuantErr: 22.66753 batch_time=0.38963 
Train Epoch: 1 [836/1000 26752/32000 (84%)] Loss: 2.26743 (QuantReg: 22.71796) QuantErr: 22.71796 batch_time=0.37153 
Train Epoch: 1 [841/1000 26912/32000 (84%)] Loss: 1.58520 (QuantReg: 22.67906) QuantErr: 22.67906 batch_time=0.80848 
Train Epoch: 1 [846/1000 27072/32000 (85%)] Loss: 2.60500 (QuantReg: 22.64437) QuantErr: 22.64437 batch_time=0.81125 
Train Epoch: 1 [851/1000 27232/32000 (85%)] Loss: 2.59904 (QuantReg: 22.61300) QuantErr: 22.61300 batch_time=0.39113 
Train Epoch: 1 [856/1000 27392/32000 (86%)] Loss: 2.72421 (QuantReg: 22.58391) QuantErr: 22.58391 batch_time=0.38020 
Train Epoch: 1 [861/1000 27552/32000 (86%)] Loss: 2.23808 (QuantReg: 22.69029) QuantErr: 22.69029 batch_time=0.36771 
Train Epoch: 1 [866/1000 27712/32000 (87%)] Loss: 2.39511 (QuantReg: 22.68571) QuantErr: 22.68571 batch_time=0.36074 
Train Epoch: 1 [871/1000 27872/32000 (87%)] Loss: 2.51952 (QuantReg: 22.68300) QuantErr: 22.68300 batch_time=0.34205 
Train Epoch: 1 [876/1000 28032/32000 (88%)] Loss: 2.18947 (QuantReg: 22.61882) QuantErr: 22.61882 batch_time=0.34251 
Train Epoch: 1 [881/1000 28192/32000 (88%)] Loss: 1.88889 (QuantReg: 22.62156) QuantErr: 22.62156 batch_time=0.41162 
Train Epoch: 1 [886/1000 28352/32000 (89%)] Loss: 2.28891 (QuantReg: 22.65576) QuantErr: 22.65576 batch_time=0.35798 
Train Epoch: 1 [891/1000 28512/32000 (89%)] Loss: 1.62614 (QuantReg: 22.67657) QuantErr: 22.67657 batch_time=0.38061 
Train Epoch: 1 [896/1000 28672/32000 (90%)] Loss: 2.31019 (QuantReg: 22.63632) QuantErr: 22.63632 batch_time=0.38773 
Train Epoch: 1 [901/1000 28832/32000 (90%)] Loss: 2.14594 (QuantReg: 22.62632) QuantErr: 22.62632 batch_time=0.39172 
Train Epoch: 1 [906/1000 28992/32000 (91%)] Loss: 2.45079 (QuantReg: 22.60976) QuantErr: 22.60976 batch_time=0.35711 
Train Epoch: 1 [911/1000 29152/32000 (91%)] Loss: 3.38156 (QuantReg: 22.62475) QuantErr: 22.62475 batch_time=0.44566 
Train Epoch: 1 [916/1000 29312/32000 (92%)] Loss: 2.20132 (QuantReg: 22.64540) QuantErr: 22.64540 batch_time=0.36242 
Train Epoch: 1 [921/1000 29472/32000 (92%)] Loss: 2.31360 (QuantReg: 22.59940) QuantErr: 22.59940 batch_time=0.41536 
Train Epoch: 1 [926/1000 29632/32000 (93%)] Loss: 3.24919 (QuantReg: 22.64973) QuantErr: 22.64973 batch_time=0.35790 
Train Epoch: 1 [931/1000 29792/32000 (93%)] Loss: 1.93847 (QuantReg: 22.66596) QuantErr: 22.66596 batch_time=0.40040 
Train Epoch: 1 [936/1000 29952/32000 (94%)] Loss: 1.52591 (QuantReg: 22.59373) QuantErr: 22.59373 batch_time=0.34332 
Train Epoch: 1 [941/1000 30112/32000 (94%)] Loss: 1.64233 (QuantReg: 22.66472) QuantErr: 22.66472 batch_time=0.37340 
Train Epoch: 1 [946/1000 30272/32000 (95%)] Loss: 3.41945 (QuantReg: 22.68638) QuantErr: 22.68638 batch_time=0.45843 
Train Epoch: 1 [951/1000 30432/32000 (95%)] Loss: 2.23658 (QuantReg: 22.61050) QuantErr: 22.61050 batch_time=0.35009 
Train Epoch: 1 [956/1000 30592/32000 (96%)] Loss: 1.29916 (QuantReg: 22.60302) QuantErr: 22.60302 batch_time=0.34693 
Train Epoch: 1 [961/1000 30752/32000 (96%)] Loss: 1.92706 (QuantReg: 22.65675) QuantErr: 22.65675 batch_time=0.34999 
Train Epoch: 1 [966/1000 30912/32000 (97%)] Loss: 1.56147 (QuantReg: 22.72001) QuantErr: 22.72001 batch_time=0.34918 
Train Epoch: 1 [971/1000 31072/32000 (97%)] Loss: 2.22146 (QuantReg: 22.59580) QuantErr: 22.59580 batch_time=0.35981 
Train Epoch: 1 [976/1000 31232/32000 (98%)] Loss: 2.30628 (QuantReg: 22.66761) QuantErr: 22.66761 batch_time=0.40124 
Train Epoch: 1 [981/1000 31392/32000 (98%)] Loss: 2.39772 (QuantReg: 22.68364) QuantErr: 22.68364 batch_time=0.34655 
Train Epoch: 1 [986/1000 31552/32000 (99%)] Loss: 0.81638 (QuantReg: 22.64985) QuantErr: 22.64985 batch_time=0.34666 
Train Epoch: 1 [991/1000 31712/32000 (99%)] Loss: 2.72404 (QuantReg: 22.66607) QuantErr: 22.66607 batch_time=0.37189 
Train Epoch: 1 [996/1000 31872/32000 (100%)] Loss: 2.24508 (QuantReg: 22.65187) QuantErr: 22.65187 batch_time=0.34474 
Train Epoch: 1 codebook_update_time=2.01225
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch1.pth ...
Done in 4.375s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch1.pth ...
Done in 8.583s
 epoch          : 1
 loss           : 2.824323961913586
 quant_reg      : 22.667049739837648
 quant_err      : 22.667049739837648
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 15.694164989939638
 MSRVTT_full_val/t2v_metrics/R5: 49.094567404426556
 MSRVTT_full_val/t2v_metrics/R10: 66.19718309859155
 MSRVTT_full_val/t2v_metrics/R50: 93.76257545271629
 MSRVTT_full_val/t2v_metrics/MedR: 6.0
 MSRVTT_full_val/t2v_metrics/MeanR: 15.424547283702212
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 37.08546426825323
 MSRVTT_full_val/v2t_metrics/R1: 21.12676056338028
 MSRVTT_full_val/v2t_metrics/R5: 54.929577464788736
 MSRVTT_full_val/v2t_metrics/R10: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R50: 94.16498993963782
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.80281690140845
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 43.354688375957515
 MSRVTT_full_test/t2v_metrics/R1: 6.053511705685619
 MSRVTT_full_test/t2v_metrics/R5: 20.20066889632107
 MSRVTT_full_test/t2v_metrics/R10: 31.204013377926422
 MSRVTT_full_test/t2v_metrics/R50: 63.74581939799331
 MSRVTT_full_test/t2v_metrics/MedR: 27.0
 MSRVTT_full_test/t2v_metrics/MeanR: 77.65317725752509
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.626481330582505
 MSRVTT_full_test/v2t_metrics/R1: 7.190635451505017
 MSRVTT_full_test/v2t_metrics/R5: 23.076923076923077
 MSRVTT_full_test/v2t_metrics/R10: 34.94983277591973
 MSRVTT_full_test/v2t_metrics/R50: 69.96655518394648
 MSRVTT_full_test/v2t_metrics/MedR: 21.0
 MSRVTT_full_test/v2t_metrics/MeanR: 70.24816053511705
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.966497668128444
 mnt_best       : 15.626481330582505
 not_improved_count: 0
Train Epoch: 2 [1/1000 32/32000 (0%)] Loss: 2.03545 (QuantReg: 10.03383) QuantErr: 10.03383 batch_time=27.80829 
Train Epoch: 2 [6/1000 192/32000 (1%)] Loss: 3.04712 (QuantReg: 10.85708) QuantErr: 10.85708 batch_time=0.34934 
Train Epoch: 2 [11/1000 352/32000 (1%)] Loss: 1.96679 (QuantReg: 11.03605) QuantErr: 11.03605 batch_time=0.39854 
Train Epoch: 2 [16/1000 512/32000 (2%)] Loss: 1.85332 (QuantReg: 11.00344) QuantErr: 11.00344 batch_time=0.50965 
Train Epoch: 2 [21/1000 672/32000 (2%)] Loss: 2.15378 (QuantReg: 11.24862) QuantErr: 11.24862 batch_time=1.36553 
Train Epoch: 2 [26/1000 832/32000 (3%)] Loss: 2.35753 (QuantReg: 10.38152) QuantErr: 10.38152 batch_time=0.36003 
Train Epoch: 2 [31/1000 992/32000 (3%)] Loss: 1.74915 (QuantReg: 11.31318) QuantErr: 11.31318 batch_time=0.34579 
Train Epoch: 2 [36/1000 1152/32000 (4%)] Loss: 1.80372 (QuantReg: 11.56348) QuantErr: 11.56348 batch_time=0.35218 
Train Epoch: 2 [41/1000 1312/32000 (4%)] Loss: 2.58254 (QuantReg: 11.07460) QuantErr: 11.07460 batch_time=0.37023 
Train Epoch: 2 [46/1000 1472/32000 (5%)] Loss: 1.92246 (QuantReg: 10.44912) QuantErr: 10.44912 batch_time=0.34690 
Train Epoch: 2 [51/1000 1632/32000 (5%)] Loss: 1.51751 (QuantReg: 10.42621) QuantErr: 10.42621 batch_time=0.36571 
Train Epoch: 2 [56/1000 1792/32000 (6%)] Loss: 2.40068 (QuantReg: 10.79548) QuantErr: 10.79548 batch_time=0.34168 
Train Epoch: 2 [61/1000 1952/32000 (6%)] Loss: 2.37034 (QuantReg: 10.93010) QuantErr: 10.93010 batch_time=0.37736 
Train Epoch: 2 [66/1000 2112/32000 (7%)] Loss: 2.22302 (QuantReg: 10.96521) QuantErr: 10.96521 batch_time=0.35375 
Train Epoch: 2 [71/1000 2272/32000 (7%)] Loss: 3.04806 (QuantReg: 11.29230) QuantErr: 11.29230 batch_time=0.35843 
Train Epoch: 2 [76/1000 2432/32000 (8%)] Loss: 1.91858 (QuantReg: 11.47872) QuantErr: 11.47872 batch_time=0.38469 
Train Epoch: 2 [81/1000 2592/32000 (8%)] Loss: 1.59050 (QuantReg: 10.75311) QuantErr: 10.75311 batch_time=0.89302 
Train Epoch: 2 [86/1000 2752/32000 (9%)] Loss: 1.68806 (QuantReg: 10.93185) QuantErr: 10.93185 batch_time=0.35091 
Train Epoch: 2 [91/1000 2912/32000 (9%)] Loss: 1.72061 (QuantReg: 11.57955) QuantErr: 11.57955 batch_time=0.34778 
Train Epoch: 2 [96/1000 3072/32000 (10%)] Loss: 1.82271 (QuantReg: 11.04081) QuantErr: 11.04081 batch_time=0.36267 
Train Epoch: 2 [101/1000 3232/32000 (10%)] Loss: 1.72150 (QuantReg: 10.98842) QuantErr: 10.98842 batch_time=0.37099 
Train Epoch: 2 [106/1000 3392/32000 (11%)] Loss: 1.44365 (QuantReg: 11.84033) QuantErr: 11.84033 batch_time=0.36097 
Train Epoch: 2 [111/1000 3552/32000 (11%)] Loss: 2.48403 (QuantReg: 11.58347) QuantErr: 11.58347 batch_time=0.35886 
Train Epoch: 2 [116/1000 3712/32000 (12%)] Loss: 1.66792 (QuantReg: 11.30816) QuantErr: 11.30816 batch_time=0.36228 
Train Epoch: 2 [121/1000 3872/32000 (12%)] Loss: 2.28337 (QuantReg: 11.54299) QuantErr: 11.54299 batch_time=0.35464 
Train Epoch: 2 [126/1000 4032/32000 (13%)] Loss: 1.88206 (QuantReg: 11.23290) QuantErr: 11.23290 batch_time=0.40285 
Train Epoch: 2 [131/1000 4192/32000 (13%)] Loss: 2.03352 (QuantReg: 11.20909) QuantErr: 11.20909 batch_time=0.35281 
Train Epoch: 2 [136/1000 4352/32000 (14%)] Loss: 2.09494 (QuantReg: 10.94389) QuantErr: 10.94389 batch_time=0.38218 
Train Epoch: 2 [141/1000 4512/32000 (14%)] Loss: 1.91909 (QuantReg: 10.99637) QuantErr: 10.99637 batch_time=0.36505 
Train Epoch: 2 [146/1000 4672/32000 (15%)] Loss: 2.33361 (QuantReg: 10.97635) QuantErr: 10.97635 batch_time=0.34875 
Train Epoch: 2 [151/1000 4832/32000 (15%)] Loss: 2.09828 (QuantReg: 11.06771) QuantErr: 11.06771 batch_time=0.34996 
Train Epoch: 2 [156/1000 4992/32000 (16%)] Loss: 1.48121 (QuantReg: 11.69616) QuantErr: 11.69616 batch_time=0.34760 
Train Epoch: 2 [161/1000 5152/32000 (16%)] Loss: 2.18700 (QuantReg: 10.96305) QuantErr: 10.96305 batch_time=0.41627 
Train Epoch: 2 [166/1000 5312/32000 (17%)] Loss: 1.33210 (QuantReg: 11.19763) QuantErr: 11.19763 batch_time=0.35773 
Train Epoch: 2 [171/1000 5472/32000 (17%)] Loss: 1.53318 (QuantReg: 10.98135) QuantErr: 10.98135 batch_time=0.41754 
Train Epoch: 2 [176/1000 5632/32000 (18%)] Loss: 2.90753 (QuantReg: 11.42381) QuantErr: 11.42381 batch_time=0.41187 
Train Epoch: 2 [181/1000 5792/32000 (18%)] Loss: 1.17916 (QuantReg: 11.41305) QuantErr: 11.41305 batch_time=0.36279 
Train Epoch: 2 [186/1000 5952/32000 (19%)] Loss: 2.91272 (QuantReg: 11.26285) QuantErr: 11.26285 batch_time=0.36191 
Train Epoch: 2 [191/1000 6112/32000 (19%)] Loss: 1.46239 (QuantReg: 11.24259) QuantErr: 11.24259 batch_time=0.36063 
Train Epoch: 2 [196/1000 6272/32000 (20%)] Loss: 1.80224 (QuantReg: 11.08899) QuantErr: 11.08899 batch_time=0.34859 
Train Epoch: 2 [201/1000 6432/32000 (20%)] Loss: 1.64023 (QuantReg: 11.35492) QuantErr: 11.35492 batch_time=0.43829 
Train Epoch: 2 [206/1000 6592/32000 (21%)] Loss: 1.51140 (QuantReg: 11.67033) QuantErr: 11.67033 batch_time=0.36151 
Train Epoch: 2 [211/1000 6752/32000 (21%)] Loss: 1.51499 (QuantReg: 11.24949) QuantErr: 11.24949 batch_time=0.35585 
Train Epoch: 2 [216/1000 6912/32000 (22%)] Loss: 2.44392 (QuantReg: 11.46000) QuantErr: 11.46000 batch_time=0.38120 
Train Epoch: 2 [221/1000 7072/32000 (22%)] Loss: 2.70704 (QuantReg: 11.16069) QuantErr: 11.16069 batch_time=0.36139 
Train Epoch: 2 [226/1000 7232/32000 (23%)] Loss: 1.82384 (QuantReg: 12.12825) QuantErr: 12.12825 batch_time=0.35104 
Train Epoch: 2 [231/1000 7392/32000 (23%)] Loss: 1.86610 (QuantReg: 11.34204) QuantErr: 11.34204 batch_time=0.35631 
Train Epoch: 2 [236/1000 7552/32000 (24%)] Loss: 2.63500 (QuantReg: 11.46350) QuantErr: 11.46350 batch_time=0.35210 
Train Epoch: 2 [241/1000 7712/32000 (24%)] Loss: 1.98736 (QuantReg: 11.26215) QuantErr: 11.26215 batch_time=0.35314 
Train Epoch: 2 [246/1000 7872/32000 (25%)] Loss: 1.37682 (QuantReg: 11.69847) QuantErr: 11.69847 batch_time=0.39857 
Train Epoch: 2 [251/1000 8032/32000 (25%)] Loss: 2.68885 (QuantReg: 11.43072) QuantErr: 11.43072 batch_time=0.41767 
Train Epoch: 2 [256/1000 8192/32000 (26%)] Loss: 1.83469 (QuantReg: 11.28064) QuantErr: 11.28064 batch_time=0.35574 
Train Epoch: 2 [261/1000 8352/32000 (26%)] Loss: 1.21614 (QuantReg: 11.24045) QuantErr: 11.24045 batch_time=0.34917 
Train Epoch: 2 [266/1000 8512/32000 (27%)] Loss: 2.34326 (QuantReg: 12.06567) QuantErr: 12.06567 batch_time=0.35660 
Train Epoch: 2 [271/1000 8672/32000 (27%)] Loss: 1.32234 (QuantReg: 11.54176) QuantErr: 11.54176 batch_time=0.36881 
Train Epoch: 2 [276/1000 8832/32000 (28%)] Loss: 1.76383 (QuantReg: 11.85563) QuantErr: 11.85563 batch_time=0.37536 
Train Epoch: 2 [281/1000 8992/32000 (28%)] Loss: 1.42338 (QuantReg: 12.55490) QuantErr: 12.55490 batch_time=0.37813 
Train Epoch: 2 [286/1000 9152/32000 (29%)] Loss: 2.32208 (QuantReg: 12.26281) QuantErr: 12.26281 batch_time=0.38623 
Train Epoch: 2 [291/1000 9312/32000 (29%)] Loss: 2.58819 (QuantReg: 12.38385) QuantErr: 12.38385 batch_time=0.36332 
Train Epoch: 2 [296/1000 9472/32000 (30%)] Loss: 1.94950 (QuantReg: 11.28909) QuantErr: 11.28909 batch_time=0.35202 
Train Epoch: 2 [301/1000 9632/32000 (30%)] Loss: 1.45054 (QuantReg: 12.02092) QuantErr: 12.02092 batch_time=0.59884 
Train Epoch: 2 [306/1000 9792/32000 (31%)] Loss: 1.08862 (QuantReg: 11.77742) QuantErr: 11.77742 batch_time=0.38742 
Train Epoch: 2 [311/1000 9952/32000 (31%)] Loss: 1.52073 (QuantReg: 11.54107) QuantErr: 11.54107 batch_time=0.35298 
Train Epoch: 2 [316/1000 10112/32000 (32%)] Loss: 1.48768 (QuantReg: 11.61289) QuantErr: 11.61289 batch_time=0.35026 
Train Epoch: 2 [321/1000 10272/32000 (32%)] Loss: 2.01556 (QuantReg: 11.95591) QuantErr: 11.95591 batch_time=0.48756 
Train Epoch: 2 [326/1000 10432/32000 (33%)] Loss: 1.68167 (QuantReg: 11.90245) QuantErr: 11.90245 batch_time=0.37117 
Train Epoch: 2 [331/1000 10592/32000 (33%)] Loss: 2.02195 (QuantReg: 12.31273) QuantErr: 12.31273 batch_time=0.38269 
Train Epoch: 2 [336/1000 10752/32000 (34%)] Loss: 1.84029 (QuantReg: 11.31697) QuantErr: 11.31697 batch_time=0.50333 
Train Epoch: 2 [341/1000 10912/32000 (34%)] Loss: 1.61304 (QuantReg: 11.51298) QuantErr: 11.51298 batch_time=1.21003 
Train Epoch: 2 [346/1000 11072/32000 (35%)] Loss: 1.62072 (QuantReg: 12.40561) QuantErr: 12.40561 batch_time=0.35374 
Train Epoch: 2 [351/1000 11232/32000 (35%)] Loss: 2.10177 (QuantReg: 12.11434) QuantErr: 12.11434 batch_time=0.41548 
Train Epoch: 2 [356/1000 11392/32000 (36%)] Loss: 2.14443 (QuantReg: 11.82415) QuantErr: 11.82415 batch_time=0.34623 
Train Epoch: 2 [361/1000 11552/32000 (36%)] Loss: 2.03039 (QuantReg: 11.97868) QuantErr: 11.97868 batch_time=0.36520 
Train Epoch: 2 [366/1000 11712/32000 (37%)] Loss: 1.74276 (QuantReg: 11.62063) QuantErr: 11.62063 batch_time=0.38562 
Train Epoch: 2 [371/1000 11872/32000 (37%)] Loss: 1.99386 (QuantReg: 12.01977) QuantErr: 12.01977 batch_time=0.36162 
Train Epoch: 2 [376/1000 12032/32000 (38%)] Loss: 1.98114 (QuantReg: 11.82525) QuantErr: 11.82525 batch_time=0.35833 
Train Epoch: 2 [381/1000 12192/32000 (38%)] Loss: 1.58247 (QuantReg: 11.99188) QuantErr: 11.99188 batch_time=0.35037 
Train Epoch: 2 [386/1000 12352/32000 (39%)] Loss: 1.25033 (QuantReg: 11.72802) QuantErr: 11.72802 batch_time=0.34588 
Train Epoch: 2 [391/1000 12512/32000 (39%)] Loss: 3.12953 (QuantReg: 11.96085) QuantErr: 11.96085 batch_time=0.35868 
Train Epoch: 2 [396/1000 12672/32000 (40%)] Loss: 2.34767 (QuantReg: 12.63461) QuantErr: 12.63461 batch_time=0.35595 
Train Epoch: 2 [401/1000 12832/32000 (40%)] Loss: 1.50939 (QuantReg: 12.18122) QuantErr: 12.18122 batch_time=0.88795 
Train Epoch: 2 [406/1000 12992/32000 (41%)] Loss: 1.50296 (QuantReg: 12.13224) QuantErr: 12.13224 batch_time=0.43120 
Train Epoch: 2 [411/1000 13152/32000 (41%)] Loss: 2.25960 (QuantReg: 12.12195) QuantErr: 12.12195 batch_time=0.37260 
Train Epoch: 2 [416/1000 13312/32000 (42%)] Loss: 2.23914 (QuantReg: 11.36464) QuantErr: 11.36464 batch_time=0.37445 
Train Epoch: 2 [421/1000 13472/32000 (42%)] Loss: 1.42063 (QuantReg: 12.07348) QuantErr: 12.07348 batch_time=0.36217 
Train Epoch: 2 [426/1000 13632/32000 (43%)] Loss: 1.83746 (QuantReg: 12.61101) QuantErr: 12.61101 batch_time=0.35970 
Train Epoch: 2 [431/1000 13792/32000 (43%)] Loss: 1.76013 (QuantReg: 12.10499) QuantErr: 12.10499 batch_time=0.35996 
Train Epoch: 2 [436/1000 13952/32000 (44%)] Loss: 1.53625 (QuantReg: 12.08827) QuantErr: 12.08827 batch_time=0.37259 
Train Epoch: 2 [441/1000 14112/32000 (44%)] Loss: 2.38613 (QuantReg: 12.06890) QuantErr: 12.06890 batch_time=0.39497 
Train Epoch: 2 [446/1000 14272/32000 (45%)] Loss: 1.21636 (QuantReg: 11.99225) QuantErr: 11.99225 batch_time=0.38175 
Train Epoch: 2 [451/1000 14432/32000 (45%)] Loss: 1.51335 (QuantReg: 12.22833) QuantErr: 12.22833 batch_time=0.36113 
Train Epoch: 2 [456/1000 14592/32000 (46%)] Loss: 1.74082 (QuantReg: 12.12012) QuantErr: 12.12012 batch_time=0.35202 
Train Epoch: 2 [461/1000 14752/32000 (46%)] Loss: 1.46557 (QuantReg: 12.51424) QuantErr: 12.51424 batch_time=0.34958 
Train Epoch: 2 [466/1000 14912/32000 (47%)] Loss: 2.41672 (QuantReg: 12.05886) QuantErr: 12.05886 batch_time=0.35233 
Train Epoch: 2 [471/1000 15072/32000 (47%)] Loss: 1.62130 (QuantReg: 12.42389) QuantErr: 12.42389 batch_time=0.36659 
Train Epoch: 2 [476/1000 15232/32000 (48%)] Loss: 2.34775 (QuantReg: 12.08670) QuantErr: 12.08670 batch_time=0.35440 
Train Epoch: 2 [481/1000 15392/32000 (48%)] Loss: 2.53019 (QuantReg: 12.45855) QuantErr: 12.45855 batch_time=0.31347 
Train Epoch: 2 [486/1000 15552/32000 (49%)] Loss: 1.69890 (QuantReg: 12.36259) QuantErr: 12.36259 batch_time=0.39429 
Train Epoch: 2 [491/1000 15712/32000 (49%)] Loss: 1.60614 (QuantReg: 11.97768) QuantErr: 11.97768 batch_time=0.43552 
Train Epoch: 2 [496/1000 15872/32000 (50%)] Loss: 0.90733 (QuantReg: 12.71911) QuantErr: 12.71911 batch_time=0.34608 
Train Epoch: 2 [501/1000 16032/32000 (50%)] Loss: 1.56073 (QuantReg: 12.49132) QuantErr: 12.49132 batch_time=0.36127 
Train Epoch: 2 [506/1000 16192/32000 (51%)] Loss: 1.96037 (QuantReg: 12.81034) QuantErr: 12.81034 batch_time=0.35368 
Train Epoch: 2 [511/1000 16352/32000 (51%)] Loss: 1.68565 (QuantReg: 12.77911) QuantErr: 12.77911 batch_time=0.36442 
Train Epoch: 2 [516/1000 16512/32000 (52%)] Loss: 2.21537 (QuantReg: 12.46502) QuantErr: 12.46502 batch_time=0.41434 
Train Epoch: 2 [521/1000 16672/32000 (52%)] Loss: 1.29600 (QuantReg: 12.77843) QuantErr: 12.77843 batch_time=0.35550 
Train Epoch: 2 [526/1000 16832/32000 (53%)] Loss: 1.41197 (QuantReg: 12.60885) QuantErr: 12.60885 batch_time=0.40568 
Train Epoch: 2 [531/1000 16992/32000 (53%)] Loss: 1.55949 (QuantReg: 12.67510) QuantErr: 12.67510 batch_time=0.60955 
Train Epoch: 2 [536/1000 17152/32000 (54%)] Loss: 1.31898 (QuantReg: 12.65830) QuantErr: 12.65830 batch_time=0.36568 
Train Epoch: 2 [541/1000 17312/32000 (54%)] Loss: 2.19725 (QuantReg: 13.07535) QuantErr: 13.07535 batch_time=0.35259 
Train Epoch: 2 [546/1000 17472/32000 (55%)] Loss: 1.28159 (QuantReg: 13.17570) QuantErr: 13.17570 batch_time=0.42319 
Train Epoch: 2 [551/1000 17632/32000 (55%)] Loss: 1.81362 (QuantReg: 12.23224) QuantErr: 12.23224 batch_time=0.41180 
Train Epoch: 2 [556/1000 17792/32000 (56%)] Loss: 1.87943 (QuantReg: 12.54298) QuantErr: 12.54298 batch_time=0.43882 
Train Epoch: 2 [561/1000 17952/32000 (56%)] Loss: 1.19770 (QuantReg: 12.57006) QuantErr: 12.57006 batch_time=0.35849 
Train Epoch: 2 [566/1000 18112/32000 (57%)] Loss: 1.88756 (QuantReg: 12.85465) QuantErr: 12.85465 batch_time=0.35487 
Train Epoch: 2 [571/1000 18272/32000 (57%)] Loss: 1.79677 (QuantReg: 12.74716) QuantErr: 12.74716 batch_time=0.34909 
Train Epoch: 2 [576/1000 18432/32000 (58%)] Loss: 1.79557 (QuantReg: 13.12495) QuantErr: 13.12495 batch_time=0.34676 
Train Epoch: 2 [581/1000 18592/32000 (58%)] Loss: 1.79466 (QuantReg: 13.01739) QuantErr: 13.01739 batch_time=0.36198 
Train Epoch: 2 [586/1000 18752/32000 (59%)] Loss: 1.70796 (QuantReg: 12.90441) QuantErr: 12.90441 batch_time=0.37929 
Train Epoch: 2 [591/1000 18912/32000 (59%)] Loss: 1.97037 (QuantReg: 12.67211) QuantErr: 12.67211 batch_time=0.38390 
Train Epoch: 2 [596/1000 19072/32000 (60%)] Loss: 1.59729 (QuantReg: 13.48032) QuantErr: 13.48032 batch_time=0.41883 
Train Epoch: 2 [601/1000 19232/32000 (60%)] Loss: 1.80004 (QuantReg: 12.93542) QuantErr: 12.93542 batch_time=0.37033 
Train Epoch: 2 [606/1000 19392/32000 (61%)] Loss: 1.96046 (QuantReg: 12.55173) QuantErr: 12.55173 batch_time=0.35365 
Train Epoch: 2 [611/1000 19552/32000 (61%)] Loss: 2.97516 (QuantReg: 12.97643) QuantErr: 12.97643 batch_time=0.35408 
Train Epoch: 2 [616/1000 19712/32000 (62%)] Loss: 1.02051 (QuantReg: 12.86480) QuantErr: 12.86480 batch_time=0.35685 
Train Epoch: 2 [621/1000 19872/32000 (62%)] Loss: 2.47188 (QuantReg: 13.15428) QuantErr: 13.15428 batch_time=0.64514 
Train Epoch: 2 [626/1000 20032/32000 (63%)] Loss: 1.26719 (QuantReg: 12.67937) QuantErr: 12.67937 batch_time=0.36152 
Train Epoch: 2 [631/1000 20192/32000 (63%)] Loss: 1.88780 (QuantReg: 12.56266) QuantErr: 12.56266 batch_time=0.36438 
Train Epoch: 2 [636/1000 20352/32000 (64%)] Loss: 1.88623 (QuantReg: 12.41495) QuantErr: 12.41495 batch_time=0.37871 
Train Epoch: 2 [641/1000 20512/32000 (64%)] Loss: 1.59238 (QuantReg: 12.71285) QuantErr: 12.71285 batch_time=0.47068 
Train Epoch: 2 [646/1000 20672/32000 (65%)] Loss: 1.70320 (QuantReg: 12.56666) QuantErr: 12.56666 batch_time=0.35612 
Train Epoch: 2 [651/1000 20832/32000 (65%)] Loss: 1.78343 (QuantReg: 12.59001) QuantErr: 12.59001 batch_time=0.38488 
Train Epoch: 2 [656/1000 20992/32000 (66%)] Loss: 2.07780 (QuantReg: 12.64123) QuantErr: 12.64123 batch_time=0.50688 
Train Epoch: 2 [661/1000 21152/32000 (66%)] Loss: 2.17346 (QuantReg: 12.96375) QuantErr: 12.96375 batch_time=1.13372 
Train Epoch: 2 [666/1000 21312/32000 (67%)] Loss: 1.28678 (QuantReg: 12.87966) QuantErr: 12.87966 batch_time=0.36658 
Train Epoch: 2 [671/1000 21472/32000 (67%)] Loss: 1.63881 (QuantReg: 12.83419) QuantErr: 12.83419 batch_time=0.37712 
Train Epoch: 2 [676/1000 21632/32000 (68%)] Loss: 1.41225 (QuantReg: 12.47285) QuantErr: 12.47285 batch_time=0.36489 
Train Epoch: 2 [681/1000 21792/32000 (68%)] Loss: 2.05972 (QuantReg: 12.25853) QuantErr: 12.25853 batch_time=0.35739 
Train Epoch: 2 [686/1000 21952/32000 (69%)] Loss: 1.34283 (QuantReg: 12.17660) QuantErr: 12.17660 batch_time=0.37128 
Train Epoch: 2 [691/1000 22112/32000 (69%)] Loss: 2.53705 (QuantReg: 12.67815) QuantErr: 12.67815 batch_time=0.35760 
Train Epoch: 2 [696/1000 22272/32000 (70%)] Loss: 1.81145 (QuantReg: 12.81580) QuantErr: 12.81580 batch_time=0.36732 
Train Epoch: 2 [701/1000 22432/32000 (70%)] Loss: 2.24474 (QuantReg: 12.96820) QuantErr: 12.96820 batch_time=0.37332 
Train Epoch: 2 [706/1000 22592/32000 (71%)] Loss: 1.63487 (QuantReg: 12.50017) QuantErr: 12.50017 batch_time=0.35243 
Train Epoch: 2 [711/1000 22752/32000 (71%)] Loss: 1.23878 (QuantReg: 13.46183) QuantErr: 13.46183 batch_time=0.35691 
Train Epoch: 2 [716/1000 22912/32000 (72%)] Loss: 1.36896 (QuantReg: 12.60877) QuantErr: 12.60877 batch_time=0.36427 
Train Epoch: 2 [721/1000 23072/32000 (72%)] Loss: 1.66498 (QuantReg: 13.19182) QuantErr: 13.19182 batch_time=0.88392 
Train Epoch: 2 [726/1000 23232/32000 (73%)] Loss: 1.27285 (QuantReg: 13.04045) QuantErr: 13.04045 batch_time=0.36087 
Train Epoch: 2 [731/1000 23392/32000 (73%)] Loss: 0.78316 (QuantReg: 12.22390) QuantErr: 12.22390 batch_time=0.35277 
Train Epoch: 2 [736/1000 23552/32000 (74%)] Loss: 1.41479 (QuantReg: 13.19768) QuantErr: 13.19768 batch_time=0.35153 
Train Epoch: 2 [741/1000 23712/32000 (74%)] Loss: 2.02519 (QuantReg: 12.81631) QuantErr: 12.81631 batch_time=0.35050 
Train Epoch: 2 [746/1000 23872/32000 (75%)] Loss: 1.86204 (QuantReg: 12.42833) QuantErr: 12.42833 batch_time=0.35442 
Train Epoch: 2 [751/1000 24032/32000 (75%)] Loss: 1.81245 (QuantReg: 13.43986) QuantErr: 13.43986 batch_time=0.38839 
Train Epoch: 2 [756/1000 24192/32000 (76%)] Loss: 1.41169 (QuantReg: 13.37510) QuantErr: 13.37510 batch_time=0.34761 
Train Epoch: 2 [761/1000 24352/32000 (76%)] Loss: 1.92876 (QuantReg: 13.53453) QuantErr: 13.53453 batch_time=0.35617 
Train Epoch: 2 [766/1000 24512/32000 (77%)] Loss: 2.16106 (QuantReg: 12.57582) QuantErr: 12.57582 batch_time=0.38818 
Train Epoch: 2 [771/1000 24672/32000 (77%)] Loss: 1.82271 (QuantReg: 12.67183) QuantErr: 12.67183 batch_time=0.35807 
Train Epoch: 2 [776/1000 24832/32000 (78%)] Loss: 1.11176 (QuantReg: 12.62200) QuantErr: 12.62200 batch_time=0.35090 
Train Epoch: 2 [781/1000 24992/32000 (78%)] Loss: 1.22308 (QuantReg: 13.12049) QuantErr: 13.12049 batch_time=0.38787 
Train Epoch: 2 [786/1000 25152/32000 (79%)] Loss: 1.35458 (QuantReg: 13.04153) QuantErr: 13.04153 batch_time=0.35300 
Train Epoch: 2 [791/1000 25312/32000 (79%)] Loss: 1.89827 (QuantReg: 12.88540) QuantErr: 12.88540 batch_time=0.34678 
Train Epoch: 2 [796/1000 25472/32000 (80%)] Loss: 2.66939 (QuantReg: 12.95040) QuantErr: 12.95040 batch_time=0.34893 
Train Epoch: 2 [801/1000 25632/32000 (80%)] Loss: 1.74640 (QuantReg: 12.31626) QuantErr: 12.31626 batch_time=0.35202 
Train Epoch: 2 [806/1000 25792/32000 (81%)] Loss: 1.15862 (QuantReg: 12.90486) QuantErr: 12.90486 batch_time=0.34447 
Train Epoch: 2 [811/1000 25952/32000 (81%)] Loss: 2.28960 (QuantReg: 12.79584) QuantErr: 12.79584 batch_time=0.42081 
Train Epoch: 2 [816/1000 26112/32000 (82%)] Loss: 2.32875 (QuantReg: 12.68211) QuantErr: 12.68211 batch_time=0.38963 
Train Epoch: 2 [821/1000 26272/32000 (82%)] Loss: 1.70213 (QuantReg: 12.99710) QuantErr: 12.99710 batch_time=0.36677 
Train Epoch: 2 [826/1000 26432/32000 (83%)] Loss: 2.00794 (QuantReg: 12.68190) QuantErr: 12.68190 batch_time=0.35362 
Train Epoch: 2 [831/1000 26592/32000 (83%)] Loss: 1.91097 (QuantReg: 13.12969) QuantErr: 13.12969 batch_time=0.34923 
Train Epoch: 2 [836/1000 26752/32000 (84%)] Loss: 1.84732 (QuantReg: 12.93714) QuantErr: 12.93714 batch_time=0.35639 
Train Epoch: 2 [841/1000 26912/32000 (84%)] Loss: 1.29013 (QuantReg: 13.25939) QuantErr: 13.25939 batch_time=0.38182 
Train Epoch: 2 [846/1000 27072/32000 (85%)] Loss: 2.05984 (QuantReg: 12.88721) QuantErr: 12.88721 batch_time=0.35350 
Train Epoch: 2 [851/1000 27232/32000 (85%)] Loss: 1.00449 (QuantReg: 12.54505) QuantErr: 12.54505 batch_time=0.36766 
Train Epoch: 2 [856/1000 27392/32000 (86%)] Loss: 2.02389 (QuantReg: 12.92603) QuantErr: 12.92603 batch_time=0.36761 
Train Epoch: 2 [861/1000 27552/32000 (86%)] Loss: 1.23969 (QuantReg: 12.91130) QuantErr: 12.91130 batch_time=0.35330 
Train Epoch: 2 [866/1000 27712/32000 (87%)] Loss: 1.17935 (QuantReg: 12.87456) QuantErr: 12.87456 batch_time=0.35140 
Train Epoch: 2 [871/1000 27872/32000 (87%)] Loss: 1.28818 (QuantReg: 12.78519) QuantErr: 12.78519 batch_time=0.39540 
Train Epoch: 2 [876/1000 28032/32000 (88%)] Loss: 1.21687 (QuantReg: 13.55532) QuantErr: 13.55532 batch_time=0.35470 
Train Epoch: 2 [881/1000 28192/32000 (88%)] Loss: 1.93941 (QuantReg: 12.68460) QuantErr: 12.68460 batch_time=0.34528 
Train Epoch: 2 [886/1000 28352/32000 (89%)] Loss: 1.47848 (QuantReg: 13.01607) QuantErr: 13.01607 batch_time=0.36641 
Train Epoch: 2 [891/1000 28512/32000 (89%)] Loss: 1.37996 (QuantReg: 13.93639) QuantErr: 13.93639 batch_time=0.39562 
Train Epoch: 2 [896/1000 28672/32000 (90%)] Loss: 1.44042 (QuantReg: 13.29652) QuantErr: 13.29652 batch_time=0.43369 
Train Epoch: 2 [901/1000 28832/32000 (90%)] Loss: 1.36808 (QuantReg: 13.92670) QuantErr: 13.92670 batch_time=0.35218 
Train Epoch: 2 [906/1000 28992/32000 (91%)] Loss: 2.09654 (QuantReg: 13.88162) QuantErr: 13.88162 batch_time=0.38219 
Train Epoch: 2 [911/1000 29152/32000 (91%)] Loss: 2.13552 (QuantReg: 12.39810) QuantErr: 12.39810 batch_time=0.35634 
Train Epoch: 2 [916/1000 29312/32000 (92%)] Loss: 1.22693 (QuantReg: 13.15676) QuantErr: 13.15676 batch_time=0.38539 
Train Epoch: 2 [921/1000 29472/32000 (92%)] Loss: 1.47385 (QuantReg: 12.82908) QuantErr: 12.82908 batch_time=0.36777 
Train Epoch: 2 [926/1000 29632/32000 (93%)] Loss: 1.86698 (QuantReg: 12.36071) QuantErr: 12.36071 batch_time=0.35365 
Train Epoch: 2 [931/1000 29792/32000 (93%)] Loss: 1.53696 (QuantReg: 13.02190) QuantErr: 13.02190 batch_time=0.36176 
Train Epoch: 2 [936/1000 29952/32000 (94%)] Loss: 2.65076 (QuantReg: 13.11662) QuantErr: 13.11662 batch_time=0.35647 
Train Epoch: 2 [941/1000 30112/32000 (94%)] Loss: 1.64047 (QuantReg: 13.17775) QuantErr: 13.17775 batch_time=0.60441 
Train Epoch: 2 [946/1000 30272/32000 (95%)] Loss: 1.04900 (QuantReg: 13.23452) QuantErr: 13.23452 batch_time=0.37633 
Train Epoch: 2 [951/1000 30432/32000 (95%)] Loss: 1.44192 (QuantReg: 13.11538) QuantErr: 13.11538 batch_time=0.35957 
Train Epoch: 2 [956/1000 30592/32000 (96%)] Loss: 1.59494 (QuantReg: 13.27349) QuantErr: 13.27349 batch_time=0.35501 
Train Epoch: 2 [961/1000 30752/32000 (96%)] Loss: 1.37035 (QuantReg: 13.40746) QuantErr: 13.40746 batch_time=0.45764 
Train Epoch: 2 [966/1000 30912/32000 (97%)] Loss: 1.89843 (QuantReg: 12.78258) QuantErr: 12.78258 batch_time=0.35359 
Train Epoch: 2 [971/1000 31072/32000 (97%)] Loss: 1.15861 (QuantReg: 14.53376) QuantErr: 14.53376 batch_time=0.38756 
Train Epoch: 2 [976/1000 31232/32000 (98%)] Loss: 1.79356 (QuantReg: 13.55908) QuantErr: 13.55908 batch_time=0.51655 
Train Epoch: 2 [981/1000 31392/32000 (98%)] Loss: 1.01045 (QuantReg: 14.24888) QuantErr: 14.24888 batch_time=1.09428 
Train Epoch: 2 [986/1000 31552/32000 (99%)] Loss: 1.27601 (QuantReg: 13.86307) QuantErr: 13.86307 batch_time=0.35221 
Train Epoch: 2 [991/1000 31712/32000 (99%)] Loss: 1.44180 (QuantReg: 13.75867) QuantErr: 13.75867 batch_time=0.35941 
Train Epoch: 2 [996/1000 31872/32000 (100%)] Loss: 1.47671 (QuantReg: 13.98962) QuantErr: 13.98962 batch_time=0.39209 
Train Epoch: 2 codebook_update_time=1.72621
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch2.pth ...
Done in 4.935s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch2.pth ...
Done in 10.528s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 1.8012693760991096
 quant_reg      : 12.283975063323975
 quant_err      : 12.283975063323975
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 21.93158953722334
 MSRVTT_full_val/t2v_metrics/R5: 54.929577464788736
 MSRVTT_full_val/t2v_metrics/R10: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.609657947686117
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.68772942521455
 MSRVTT_full_val/v2t_metrics/R1: 23.943661971830984
 MSRVTT_full_val/v2t_metrics/R5: 61.16700201207244
 MSRVTT_full_val/v2t_metrics/R10: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.297786720321932
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.326282048482554
 MSRVTT_full_test/t2v_metrics/R1: 7.25752508361204
 MSRVTT_full_test/t2v_metrics/R5: 24.180602006688964
 MSRVTT_full_test/t2v_metrics/R10: 35.919732441471574
 MSRVTT_full_test/t2v_metrics/R50: 70.70234113712375
 MSRVTT_full_test/t2v_metrics/MedR: 19.0
 MSRVTT_full_test/t2v_metrics/MeanR: 62.81471571906354
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.472666194973744
 MSRVTT_full_test/v2t_metrics/R1: 9.130434782608695
 MSRVTT_full_test/v2t_metrics/R5: 28.528428093645484
 MSRVTT_full_test/v2t_metrics/R10: 41.30434782608695
 MSRVTT_full_test/v2t_metrics/R50: 76.75585284280936
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.69498327759197
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.07606632977456
 mnt_best       : 18.472666194973744
 not_improved_count: 0
Train Epoch: 3 [1/1000 32/32000 (0%)] Loss: 1.72695 (QuantReg: 10.92156) QuantErr: 10.92156 batch_time=28.80284 
Train Epoch: 3 [6/1000 192/32000 (1%)] Loss: 0.93646 (QuantReg: 10.38822) QuantErr: 10.38822 batch_time=0.41704 
Train Epoch: 3 [11/1000 352/32000 (1%)] Loss: 1.19058 (QuantReg: 10.82346) QuantErr: 10.82346 batch_time=0.37580 
Train Epoch: 3 [16/1000 512/32000 (2%)] Loss: 1.42079 (QuantReg: 11.04568) QuantErr: 11.04568 batch_time=0.37558 
Train Epoch: 3 [21/1000 672/32000 (2%)] Loss: 1.46536 (QuantReg: 11.03115) QuantErr: 11.03115 batch_time=0.55514 
Train Epoch: 3 [26/1000 832/32000 (3%)] Loss: 1.25257 (QuantReg: 10.83248) QuantErr: 10.83248 batch_time=0.34979 
Train Epoch: 3 [31/1000 992/32000 (3%)] Loss: 1.42216 (QuantReg: 10.91531) QuantErr: 10.91531 batch_time=0.35330 
Train Epoch: 3 [36/1000 1152/32000 (4%)] Loss: 2.62419 (QuantReg: 10.88671) QuantErr: 10.88671 batch_time=0.36456 
Train Epoch: 3 [41/1000 1312/32000 (4%)] Loss: 1.60714 (QuantReg: 10.07058) QuantErr: 10.07058 batch_time=0.36031 
Train Epoch: 3 [46/1000 1472/32000 (5%)] Loss: 1.18517 (QuantReg: 10.98759) QuantErr: 10.98759 batch_time=0.34599 
Train Epoch: 3 [51/1000 1632/32000 (5%)] Loss: 1.56528 (QuantReg: 10.42228) QuantErr: 10.42228 batch_time=0.39347 
Train Epoch: 3 [56/1000 1792/32000 (6%)] Loss: 1.82443 (QuantReg: 10.82130) QuantErr: 10.82130 batch_time=0.39390 
Train Epoch: 3 [61/1000 1952/32000 (6%)] Loss: 1.10860 (QuantReg: 10.06990) QuantErr: 10.06990 batch_time=0.41081 
Train Epoch: 3 [66/1000 2112/32000 (7%)] Loss: 1.34070 (QuantReg: 10.51378) QuantErr: 10.51378 batch_time=0.65827 
Train Epoch: 3 [71/1000 2272/32000 (7%)] Loss: 1.06900 (QuantReg: 10.52853) QuantErr: 10.52853 batch_time=0.37241 
Train Epoch: 3 [76/1000 2432/32000 (8%)] Loss: 1.97519 (QuantReg: 11.20466) QuantErr: 11.20466 batch_time=0.40637 
Train Epoch: 3 [81/1000 2592/32000 (8%)] Loss: 1.55208 (QuantReg: 11.18595) QuantErr: 11.18595 batch_time=0.39651 
Train Epoch: 3 [86/1000 2752/32000 (9%)] Loss: 1.32704 (QuantReg: 11.08908) QuantErr: 11.08908 batch_time=0.35159 
Train Epoch: 3 [91/1000 2912/32000 (9%)] Loss: 2.54617 (QuantReg: 11.18378) QuantErr: 11.18378 batch_time=0.35168 
Train Epoch: 3 [96/1000 3072/32000 (10%)] Loss: 1.31603 (QuantReg: 11.21337) QuantErr: 11.21337 batch_time=0.36895 
Train Epoch: 3 [101/1000 3232/32000 (10%)] Loss: 1.73373 (QuantReg: 10.82477) QuantErr: 10.82477 batch_time=0.34908 
Train Epoch: 3 [106/1000 3392/32000 (11%)] Loss: 1.84397 (QuantReg: 10.52050) QuantErr: 10.52050 batch_time=0.38019 
Train Epoch: 3 [111/1000 3552/32000 (11%)] Loss: 1.28754 (QuantReg: 10.37440) QuantErr: 10.37440 batch_time=0.34694 
Train Epoch: 3 [116/1000 3712/32000 (12%)] Loss: 1.29651 (QuantReg: 10.62401) QuantErr: 10.62401 batch_time=0.36217 
Train Epoch: 3 [121/1000 3872/32000 (12%)] Loss: 1.49179 (QuantReg: 10.58940) QuantErr: 10.58940 batch_time=0.43268 
Train Epoch: 3 [126/1000 4032/32000 (13%)] Loss: 1.15325 (QuantReg: 10.53341) QuantErr: 10.53341 batch_time=0.41640 
Train Epoch: 3 [131/1000 4192/32000 (13%)] Loss: 1.37287 (QuantReg: 10.60278) QuantErr: 10.60278 batch_time=0.35483 
Train Epoch: 3 [136/1000 4352/32000 (14%)] Loss: 1.25421 (QuantReg: 10.68701) QuantErr: 10.68701 batch_time=0.35508 
Train Epoch: 3 [141/1000 4512/32000 (14%)] Loss: 1.53320 (QuantReg: 10.64728) QuantErr: 10.64728 batch_time=0.35522 
Train Epoch: 3 [146/1000 4672/32000 (15%)] Loss: 1.48739 (QuantReg: 10.61234) QuantErr: 10.61234 batch_time=0.37835 
Train Epoch: 3 [151/1000 4832/32000 (15%)] Loss: 0.71637 (QuantReg: 10.80022) QuantErr: 10.80022 batch_time=0.43331 
Train Epoch: 3 [156/1000 4992/32000 (16%)] Loss: 2.20682 (QuantReg: 10.88348) QuantErr: 10.88348 batch_time=0.37423 
Train Epoch: 3 [161/1000 5152/32000 (16%)] Loss: 1.34454 (QuantReg: 11.11732) QuantErr: 11.11732 batch_time=0.40134 
Train Epoch: 3 [166/1000 5312/32000 (17%)] Loss: 0.91412 (QuantReg: 11.12349) QuantErr: 11.12349 batch_time=0.45334 
Train Epoch: 3 [171/1000 5472/32000 (17%)] Loss: 1.75335 (QuantReg: 10.77960) QuantErr: 10.77960 batch_time=0.38401 
Train Epoch: 3 [176/1000 5632/32000 (18%)] Loss: 2.36850 (QuantReg: 11.28850) QuantErr: 11.28850 batch_time=0.41258 
Train Epoch: 3 [181/1000 5792/32000 (18%)] Loss: 1.90882 (QuantReg: 10.64059) QuantErr: 10.64059 batch_time=0.36645 
Train Epoch: 3 [186/1000 5952/32000 (19%)] Loss: 1.31909 (QuantReg: 11.24710) QuantErr: 11.24710 batch_time=0.34582 
Train Epoch: 3 [191/1000 6112/32000 (19%)] Loss: 1.59088 (QuantReg: 10.44841) QuantErr: 10.44841 batch_time=0.36937 
Train Epoch: 3 [196/1000 6272/32000 (20%)] Loss: 1.74878 (QuantReg: 10.79492) QuantErr: 10.79492 batch_time=0.35736 
Train Epoch: 3 [201/1000 6432/32000 (20%)] Loss: 0.90731 (QuantReg: 11.44851) QuantErr: 11.44851 batch_time=0.34259 
Train Epoch: 3 [206/1000 6592/32000 (21%)] Loss: 2.74065 (QuantReg: 10.86576) QuantErr: 10.86576 batch_time=0.37468 
Train Epoch: 3 [211/1000 6752/32000 (21%)] Loss: 1.86296 (QuantReg: 11.25775) QuantErr: 11.25775 batch_time=0.65813 
Train Epoch: 3 [216/1000 6912/32000 (22%)] Loss: 1.71846 (QuantReg: 11.03700) QuantErr: 11.03700 batch_time=0.34864 
Train Epoch: 3 [221/1000 7072/32000 (22%)] Loss: 1.68880 (QuantReg: 10.84566) QuantErr: 10.84566 batch_time=0.34462 
Train Epoch: 3 [226/1000 7232/32000 (23%)] Loss: 1.73618 (QuantReg: 11.32093) QuantErr: 11.32093 batch_time=0.36844 
Train Epoch: 3 [231/1000 7392/32000 (23%)] Loss: 1.38086 (QuantReg: 10.63806) QuantErr: 10.63806 batch_time=0.42280 
Train Epoch: 3 [236/1000 7552/32000 (24%)] Loss: 1.68207 (QuantReg: 10.37666) QuantErr: 10.37666 batch_time=0.35505 
Train Epoch: 3 [241/1000 7712/32000 (24%)] Loss: 1.63249 (QuantReg: 11.28551) QuantErr: 11.28551 batch_time=0.35265 
Train Epoch: 3 [246/1000 7872/32000 (25%)] Loss: 1.20244 (QuantReg: 11.36115) QuantErr: 11.36115 batch_time=0.36199 
Train Epoch: 3 [251/1000 8032/32000 (25%)] Loss: 2.20627 (QuantReg: 11.94527) QuantErr: 11.94527 batch_time=0.42199 
Train Epoch: 3 [256/1000 8192/32000 (26%)] Loss: 1.50545 (QuantReg: 10.96884) QuantErr: 10.96884 batch_time=0.35901 
Train Epoch: 3 [261/1000 8352/32000 (26%)] Loss: 1.98095 (QuantReg: 10.81665) QuantErr: 10.81665 batch_time=0.33807 
Train Epoch: 3 [266/1000 8512/32000 (27%)] Loss: 1.81175 (QuantReg: 11.48906) QuantErr: 11.48906 batch_time=0.34070 
Train Epoch: 3 [271/1000 8672/32000 (27%)] Loss: 1.57268 (QuantReg: 11.45384) QuantErr: 11.45384 batch_time=1.37206 
Train Epoch: 3 [276/1000 8832/32000 (28%)] Loss: 1.52771 (QuantReg: 11.46826) QuantErr: 11.46826 batch_time=0.43008 
Train Epoch: 3 [281/1000 8992/32000 (28%)] Loss: 1.57574 (QuantReg: 11.91203) QuantErr: 11.91203 batch_time=0.40743 
Train Epoch: 3 [286/1000 9152/32000 (29%)] Loss: 1.79204 (QuantReg: 11.91658) QuantErr: 11.91658 batch_time=0.37587 
Train Epoch: 3 [291/1000 9312/32000 (29%)] Loss: 1.15640 (QuantReg: 11.40022) QuantErr: 11.40022 batch_time=0.36902 
Train Epoch: 3 [296/1000 9472/32000 (30%)] Loss: 1.61272 (QuantReg: 11.14769) QuantErr: 11.14769 batch_time=0.34420 
Train Epoch: 3 [301/1000 9632/32000 (30%)] Loss: 1.15679 (QuantReg: 11.56939) QuantErr: 11.56939 batch_time=0.45378 
Train Epoch: 3 [306/1000 9792/32000 (31%)] Loss: 0.72256 (QuantReg: 11.37793) QuantErr: 11.37793 batch_time=0.37866 
Train Epoch: 3 [311/1000 9952/32000 (31%)] Loss: 1.77531 (QuantReg: 11.13833) QuantErr: 11.13833 batch_time=0.34241 
Train Epoch: 3 [316/1000 10112/32000 (32%)] Loss: 0.59306 (QuantReg: 11.53241) QuantErr: 11.53241 batch_time=0.34367 
Train Epoch: 3 [321/1000 10272/32000 (32%)] Loss: 1.73188 (QuantReg: 11.58100) QuantErr: 11.58100 batch_time=0.35509 
Train Epoch: 3 [326/1000 10432/32000 (33%)] Loss: 1.26222 (QuantReg: 11.51555) QuantErr: 11.51555 batch_time=0.34864 
Train Epoch: 3 [331/1000 10592/32000 (33%)] Loss: 1.43723 (QuantReg: 11.56572) QuantErr: 11.56572 batch_time=0.37379 
Train Epoch: 3 [336/1000 10752/32000 (34%)] Loss: 0.93176 (QuantReg: 11.85185) QuantErr: 11.85185 batch_time=0.36273 
Train Epoch: 3 [341/1000 10912/32000 (34%)] Loss: 2.36822 (QuantReg: 11.61333) QuantErr: 11.61333 batch_time=0.60768 
Train Epoch: 3 [346/1000 11072/32000 (35%)] Loss: 1.83390 (QuantReg: 11.38548) QuantErr: 11.38548 batch_time=0.39708 
Train Epoch: 3 [351/1000 11232/32000 (35%)] Loss: 1.23455 (QuantReg: 10.98743) QuantErr: 10.98743 batch_time=0.41536 
Train Epoch: 3 [356/1000 11392/32000 (36%)] Loss: 1.65703 (QuantReg: 11.44870) QuantErr: 11.44870 batch_time=0.39361 
Train Epoch: 3 [361/1000 11552/32000 (36%)] Loss: 1.57512 (QuantReg: 11.83495) QuantErr: 11.83495 batch_time=0.40040 
Train Epoch: 3 [366/1000 11712/32000 (37%)] Loss: 1.64271 (QuantReg: 11.34943) QuantErr: 11.34943 batch_time=0.40782 
Train Epoch: 3 [371/1000 11872/32000 (37%)] Loss: 1.24480 (QuantReg: 11.31825) QuantErr: 11.31825 batch_time=0.44993 
Train Epoch: 3 [376/1000 12032/32000 (38%)] Loss: 1.05136 (QuantReg: 11.27953) QuantErr: 11.27953 batch_time=0.38909 
Train Epoch: 3 [381/1000 12192/32000 (38%)] Loss: 0.97551 (QuantReg: 11.17746) QuantErr: 11.17746 batch_time=0.35795 
Train Epoch: 3 [386/1000 12352/32000 (39%)] Loss: 1.31138 (QuantReg: 11.25959) QuantErr: 11.25959 batch_time=0.74167 
Train Epoch: 3 [391/1000 12512/32000 (39%)] Loss: 1.22690 (QuantReg: 11.04681) QuantErr: 11.04681 batch_time=0.34898 
Train Epoch: 3 [396/1000 12672/32000 (40%)] Loss: 1.29438 (QuantReg: 11.99452) QuantErr: 11.99452 batch_time=0.34444 
Train Epoch: 3 [401/1000 12832/32000 (40%)] Loss: 1.30960 (QuantReg: 11.41620) QuantErr: 11.41620 batch_time=0.42911 
Train Epoch: 3 [406/1000 12992/32000 (41%)] Loss: 1.06467 (QuantReg: 11.74490) QuantErr: 11.74490 batch_time=0.41943 
Train Epoch: 3 [411/1000 13152/32000 (41%)] Loss: 1.74098 (QuantReg: 12.03572) QuantErr: 12.03572 batch_time=0.37774 
Train Epoch: 3 [416/1000 13312/32000 (42%)] Loss: 1.09584 (QuantReg: 11.66543) QuantErr: 11.66543 batch_time=0.42526 
Train Epoch: 3 [421/1000 13472/32000 (42%)] Loss: 0.97622 (QuantReg: 11.32968) QuantErr: 11.32968 batch_time=0.47867 
Train Epoch: 3 [426/1000 13632/32000 (43%)] Loss: 0.83445 (QuantReg: 11.47794) QuantErr: 11.47794 batch_time=0.41792 
Train Epoch: 3 [431/1000 13792/32000 (43%)] Loss: 1.69523 (QuantReg: 11.44792) QuantErr: 11.44792 batch_time=0.37515 
Train Epoch: 3 [436/1000 13952/32000 (44%)] Loss: 1.11311 (QuantReg: 11.52053) QuantErr: 11.52053 batch_time=0.41356 
Train Epoch: 3 [441/1000 14112/32000 (44%)] Loss: 1.58687 (QuantReg: 11.46837) QuantErr: 11.46837 batch_time=0.38433 
Train Epoch: 3 [446/1000 14272/32000 (45%)] Loss: 2.14842 (QuantReg: 11.26753) QuantErr: 11.26753 batch_time=0.37664 
Train Epoch: 3 [451/1000 14432/32000 (45%)] Loss: 1.79602 (QuantReg: 11.21413) QuantErr: 11.21413 batch_time=0.43047 
Train Epoch: 3 [456/1000 14592/32000 (46%)] Loss: 1.31628 (QuantReg: 11.57874) QuantErr: 11.57874 batch_time=0.38958 
Train Epoch: 3 [461/1000 14752/32000 (46%)] Loss: 1.54830 (QuantReg: 10.97245) QuantErr: 10.97245 batch_time=0.36617 
Train Epoch: 3 [466/1000 14912/32000 (47%)] Loss: 1.42966 (QuantReg: 11.33088) QuantErr: 11.33088 batch_time=0.42480 
Train Epoch: 3 [471/1000 15072/32000 (47%)] Loss: 1.54584 (QuantReg: 10.86928) QuantErr: 10.86928 batch_time=0.43139 
Train Epoch: 3 [476/1000 15232/32000 (48%)] Loss: 1.63896 (QuantReg: 11.03528) QuantErr: 11.03528 batch_time=0.37628 
Train Epoch: 3 [481/1000 15392/32000 (48%)] Loss: 0.89723 (QuantReg: 11.90522) QuantErr: 11.90522 batch_time=0.40665 
Train Epoch: 3 [486/1000 15552/32000 (49%)] Loss: 1.57338 (QuantReg: 11.43136) QuantErr: 11.43136 batch_time=0.42453 
Train Epoch: 3 [491/1000 15712/32000 (49%)] Loss: 1.93443 (QuantReg: 11.19598) QuantErr: 11.19598 batch_time=0.39103 
Train Epoch: 3 [496/1000 15872/32000 (50%)] Loss: 1.54414 (QuantReg: 11.77929) QuantErr: 11.77929 batch_time=0.35593 
Train Epoch: 3 [501/1000 16032/32000 (50%)] Loss: 0.98134 (QuantReg: 11.62325) QuantErr: 11.62325 batch_time=0.34698 
Train Epoch: 3 [506/1000 16192/32000 (51%)] Loss: 2.30635 (QuantReg: 11.05030) QuantErr: 11.05030 batch_time=0.35502 
Train Epoch: 3 [511/1000 16352/32000 (51%)] Loss: 1.51368 (QuantReg: 11.45170) QuantErr: 11.45170 batch_time=0.34793 
Train Epoch: 3 [516/1000 16512/32000 (52%)] Loss: 0.96093 (QuantReg: 11.68920) QuantErr: 11.68920 batch_time=0.36651 
Train Epoch: 3 [521/1000 16672/32000 (52%)] Loss: 1.86852 (QuantReg: 11.35372) QuantErr: 11.35372 batch_time=0.37726 
Train Epoch: 3 [526/1000 16832/32000 (53%)] Loss: 1.40132 (QuantReg: 11.97087) QuantErr: 11.97087 batch_time=0.43222 
Train Epoch: 3 [531/1000 16992/32000 (53%)] Loss: 1.19661 (QuantReg: 11.69179) QuantErr: 11.69179 batch_time=0.64474 
Train Epoch: 3 [536/1000 17152/32000 (54%)] Loss: 2.15039 (QuantReg: 12.41003) QuantErr: 12.41003 batch_time=0.35333 
Train Epoch: 3 [541/1000 17312/32000 (54%)] Loss: 1.61293 (QuantReg: 10.82284) QuantErr: 10.82284 batch_time=0.34949 
Train Epoch: 3 [546/1000 17472/32000 (55%)] Loss: 1.32621 (QuantReg: 11.29204) QuantErr: 11.29204 batch_time=0.35005 
Train Epoch: 3 [551/1000 17632/32000 (55%)] Loss: 1.34055 (QuantReg: 11.51141) QuantErr: 11.51141 batch_time=0.36066 
Train Epoch: 3 [556/1000 17792/32000 (56%)] Loss: 1.14504 (QuantReg: 11.61529) QuantErr: 11.61529 batch_time=0.41640 
Train Epoch: 3 [561/1000 17952/32000 (56%)] Loss: 1.31591 (QuantReg: 11.23343) QuantErr: 11.23343 batch_time=0.49736 
Train Epoch: 3 [566/1000 18112/32000 (57%)] Loss: 1.13232 (QuantReg: 11.07597) QuantErr: 11.07597 batch_time=0.42352 
Train Epoch: 3 [571/1000 18272/32000 (57%)] Loss: 1.07260 (QuantReg: 11.40658) QuantErr: 11.40658 batch_time=0.37542 
Train Epoch: 3 [576/1000 18432/32000 (58%)] Loss: 1.04243 (QuantReg: 11.56878) QuantErr: 11.56878 batch_time=0.38479 
Train Epoch: 3 [581/1000 18592/32000 (58%)] Loss: 1.42099 (QuantReg: 11.91996) QuantErr: 11.91996 batch_time=0.40539 
Train Epoch: 3 [586/1000 18752/32000 (59%)] Loss: 1.20195 (QuantReg: 12.07689) QuantErr: 12.07689 batch_time=0.36083 
Train Epoch: 3 [591/1000 18912/32000 (59%)] Loss: 1.19621 (QuantReg: 11.96042) QuantErr: 11.96042 batch_time=1.46150 
Train Epoch: 3 [596/1000 19072/32000 (60%)] Loss: 1.55927 (QuantReg: 12.16098) QuantErr: 12.16098 batch_time=0.40551 
Train Epoch: 3 [601/1000 19232/32000 (60%)] Loss: 1.23443 (QuantReg: 11.99306) QuantErr: 11.99306 batch_time=0.36059 
Train Epoch: 3 [606/1000 19392/32000 (61%)] Loss: 1.25723 (QuantReg: 12.12275) QuantErr: 12.12275 batch_time=0.36400 
Train Epoch: 3 [611/1000 19552/32000 (61%)] Loss: 1.04287 (QuantReg: 12.47466) QuantErr: 12.47466 batch_time=0.38282 
Train Epoch: 3 [616/1000 19712/32000 (62%)] Loss: 1.59191 (QuantReg: 11.92281) QuantErr: 11.92281 batch_time=0.40431 
Train Epoch: 3 [621/1000 19872/32000 (62%)] Loss: 1.34755 (QuantReg: 11.54964) QuantErr: 11.54964 batch_time=0.48257 
Train Epoch: 3 [626/1000 20032/32000 (63%)] Loss: 1.31746 (QuantReg: 11.67790) QuantErr: 11.67790 batch_time=0.36214 
Train Epoch: 3 [631/1000 20192/32000 (63%)] Loss: 1.28395 (QuantReg: 12.34592) QuantErr: 12.34592 batch_time=0.35492 
Train Epoch: 3 [636/1000 20352/32000 (64%)] Loss: 2.26390 (QuantReg: 12.41806) QuantErr: 12.41806 batch_time=0.35751 
Train Epoch: 3 [641/1000 20512/32000 (64%)] Loss: 1.74634 (QuantReg: 11.38067) QuantErr: 11.38067 batch_time=0.37963 
Train Epoch: 3 [646/1000 20672/32000 (65%)] Loss: 2.13830 (QuantReg: 10.96345) QuantErr: 10.96345 batch_time=0.38885 
Train Epoch: 3 [651/1000 20832/32000 (65%)] Loss: 1.71180 (QuantReg: 10.89969) QuantErr: 10.89969 batch_time=0.41292 
Train Epoch: 3 [656/1000 20992/32000 (66%)] Loss: 2.22662 (QuantReg: 10.85630) QuantErr: 10.85630 batch_time=0.36543 
Train Epoch: 3 [661/1000 21152/32000 (66%)] Loss: 1.33962 (QuantReg: 11.59048) QuantErr: 11.59048 batch_time=0.54583 
Train Epoch: 3 [666/1000 21312/32000 (67%)] Loss: 1.38634 (QuantReg: 11.37986) QuantErr: 11.37986 batch_time=0.38863 
Train Epoch: 3 [671/1000 21472/32000 (67%)] Loss: 1.29589 (QuantReg: 11.46842) QuantErr: 11.46842 batch_time=0.41962 
Train Epoch: 3 [676/1000 21632/32000 (68%)] Loss: 1.68908 (QuantReg: 11.69183) QuantErr: 11.69183 batch_time=0.42058 
Train Epoch: 3 [681/1000 21792/32000 (68%)] Loss: 0.95889 (QuantReg: 11.44219) QuantErr: 11.44219 batch_time=0.42278 
Train Epoch: 3 [686/1000 21952/32000 (69%)] Loss: 0.87595 (QuantReg: 11.80931) QuantErr: 11.80931 batch_time=0.39297 
Train Epoch: 3 [691/1000 22112/32000 (69%)] Loss: 1.31539 (QuantReg: 12.42142) QuantErr: 12.42142 batch_time=0.35813 
Train Epoch: 3 [696/1000 22272/32000 (70%)] Loss: 1.37773 (QuantReg: 12.41035) QuantErr: 12.41035 batch_time=0.36018 
Train Epoch: 3 [701/1000 22432/32000 (70%)] Loss: 1.79372 (QuantReg: 12.27289) QuantErr: 12.27289 batch_time=0.35583 
Train Epoch: 3 [706/1000 22592/32000 (71%)] Loss: 1.11572 (QuantReg: 11.73229) QuantErr: 11.73229 batch_time=0.76277 
Train Epoch: 3 [711/1000 22752/32000 (71%)] Loss: 1.08758 (QuantReg: 11.88753) QuantErr: 11.88753 batch_time=0.37923 
Train Epoch: 3 [716/1000 22912/32000 (72%)] Loss: 0.90902 (QuantReg: 12.02917) QuantErr: 12.02917 batch_time=0.45828 
Train Epoch: 3 [721/1000 23072/32000 (72%)] Loss: 1.52561 (QuantReg: 11.67694) QuantErr: 11.67694 batch_time=0.35635 
Train Epoch: 3 [726/1000 23232/32000 (73%)] Loss: 2.19561 (QuantReg: 11.33919) QuantErr: 11.33919 batch_time=0.36270 
Train Epoch: 3 [731/1000 23392/32000 (73%)] Loss: 1.09715 (QuantReg: 11.53862) QuantErr: 11.53862 batch_time=0.38256 
Train Epoch: 3 [736/1000 23552/32000 (74%)] Loss: 1.26168 (QuantReg: 10.93193) QuantErr: 10.93193 batch_time=0.34793 
Train Epoch: 3 [741/1000 23712/32000 (74%)] Loss: 0.96514 (QuantReg: 11.26025) QuantErr: 11.26025 batch_time=0.37212 
Train Epoch: 3 [746/1000 23872/32000 (75%)] Loss: 1.38171 (QuantReg: 12.12755) QuantErr: 12.12755 batch_time=0.36385 
Train Epoch: 3 [751/1000 24032/32000 (75%)] Loss: 1.21456 (QuantReg: 11.95076) QuantErr: 11.95076 batch_time=0.36256 
Train Epoch: 3 [756/1000 24192/32000 (76%)] Loss: 1.43621 (QuantReg: 12.10143) QuantErr: 12.10143 batch_time=0.36647 
Train Epoch: 3 [761/1000 24352/32000 (76%)] Loss: 0.99161 (QuantReg: 12.26579) QuantErr: 12.26579 batch_time=0.33871 
Train Epoch: 3 [766/1000 24512/32000 (77%)] Loss: 1.50055 (QuantReg: 12.15021) QuantErr: 12.15021 batch_time=0.36760 
Train Epoch: 3 [771/1000 24672/32000 (77%)] Loss: 1.61703 (QuantReg: 12.44676) QuantErr: 12.44676 batch_time=0.34995 
Train Epoch: 3 [776/1000 24832/32000 (78%)] Loss: 1.22759 (QuantReg: 12.49156) QuantErr: 12.49156 batch_time=0.36098 
Train Epoch: 3 [781/1000 24992/32000 (78%)] Loss: 1.00411 (QuantReg: 12.68493) QuantErr: 12.68493 batch_time=0.36697 
Train Epoch: 3 [786/1000 25152/32000 (79%)] Loss: 1.59544 (QuantReg: 12.18319) QuantErr: 12.18319 batch_time=0.38613 
Train Epoch: 3 [791/1000 25312/32000 (79%)] Loss: 0.92813 (QuantReg: 12.14844) QuantErr: 12.14844 batch_time=0.36739 
Train Epoch: 3 [796/1000 25472/32000 (80%)] Loss: 1.08429 (QuantReg: 11.94579) QuantErr: 11.94579 batch_time=0.35162 
Train Epoch: 3 [801/1000 25632/32000 (80%)] Loss: 1.83601 (QuantReg: 11.72123) QuantErr: 11.72123 batch_time=0.42194 
Train Epoch: 3 [806/1000 25792/32000 (81%)] Loss: 1.40165 (QuantReg: 11.96823) QuantErr: 11.96823 batch_time=0.39891 
Train Epoch: 3 [811/1000 25952/32000 (81%)] Loss: 1.43498 (QuantReg: 12.15864) QuantErr: 12.15864 batch_time=0.43252 
Train Epoch: 3 [816/1000 26112/32000 (82%)] Loss: 1.04753 (QuantReg: 11.87187) QuantErr: 11.87187 batch_time=0.41498 
Train Epoch: 3 [821/1000 26272/32000 (82%)] Loss: 1.67722 (QuantReg: 11.98087) QuantErr: 11.98087 batch_time=0.35091 
Train Epoch: 3 [826/1000 26432/32000 (83%)] Loss: 1.16112 (QuantReg: 11.68595) QuantErr: 11.68595 batch_time=0.34751 
Train Epoch: 3 [831/1000 26592/32000 (83%)] Loss: 1.31330 (QuantReg: 11.91404) QuantErr: 11.91404 batch_time=0.35423 
Train Epoch: 3 [836/1000 26752/32000 (84%)] Loss: 1.92582 (QuantReg: 11.58987) QuantErr: 11.58987 batch_time=0.37384 
Train Epoch: 3 [841/1000 26912/32000 (84%)] Loss: 0.70714 (QuantReg: 12.00880) QuantErr: 12.00880 batch_time=0.35260 
Train Epoch: 3 [846/1000 27072/32000 (85%)] Loss: 1.97778 (QuantReg: 11.57543) QuantErr: 11.57543 batch_time=0.38641 
Train Epoch: 3 [851/1000 27232/32000 (85%)] Loss: 1.63855 (QuantReg: 12.25120) QuantErr: 12.25120 batch_time=0.68264 
Train Epoch: 3 [856/1000 27392/32000 (86%)] Loss: 1.43408 (QuantReg: 12.20693) QuantErr: 12.20693 batch_time=0.42624 
Train Epoch: 3 [861/1000 27552/32000 (86%)] Loss: 1.36132 (QuantReg: 11.82349) QuantErr: 11.82349 batch_time=0.38612 
Train Epoch: 3 [866/1000 27712/32000 (87%)] Loss: 1.26846 (QuantReg: 11.49372) QuantErr: 11.49372 batch_time=0.38215 
Train Epoch: 3 [871/1000 27872/32000 (87%)] Loss: 1.23048 (QuantReg: 12.01626) QuantErr: 12.01626 batch_time=0.39434 
Train Epoch: 3 [876/1000 28032/32000 (88%)] Loss: 1.32763 (QuantReg: 11.66323) QuantErr: 11.66323 batch_time=0.39097 
Train Epoch: 3 [881/1000 28192/32000 (88%)] Loss: 1.83628 (QuantReg: 11.59816) QuantErr: 11.59816 batch_time=0.40616 
Train Epoch: 3 [886/1000 28352/32000 (89%)] Loss: 1.32939 (QuantReg: 11.85608) QuantErr: 11.85608 batch_time=0.38151 
Train Epoch: 3 [891/1000 28512/32000 (89%)] Loss: 1.25366 (QuantReg: 11.71295) QuantErr: 11.71295 batch_time=0.34611 
Train Epoch: 3 [896/1000 28672/32000 (90%)] Loss: 1.14821 (QuantReg: 11.88292) QuantErr: 11.88292 batch_time=0.34755 
Train Epoch: 3 [901/1000 28832/32000 (90%)] Loss: 1.50092 (QuantReg: 11.55181) QuantErr: 11.55181 batch_time=0.35538 
Train Epoch: 3 [906/1000 28992/32000 (91%)] Loss: 1.56353 (QuantReg: 12.45495) QuantErr: 12.45495 batch_time=0.35253 
Train Epoch: 3 [911/1000 29152/32000 (91%)] Loss: 1.63411 (QuantReg: 12.04683) QuantErr: 12.04683 batch_time=1.34393 
Train Epoch: 3 [916/1000 29312/32000 (92%)] Loss: 1.07967 (QuantReg: 12.24035) QuantErr: 12.24035 batch_time=0.36226 
Train Epoch: 3 [921/1000 29472/32000 (92%)] Loss: 0.96554 (QuantReg: 12.28212) QuantErr: 12.28212 batch_time=0.36749 
Train Epoch: 3 [926/1000 29632/32000 (93%)] Loss: 1.25160 (QuantReg: 12.55821) QuantErr: 12.55821 batch_time=0.36424 
Train Epoch: 3 [931/1000 29792/32000 (93%)] Loss: 1.04656 (QuantReg: 12.10317) QuantErr: 12.10317 batch_time=0.38693 
Train Epoch: 3 [936/1000 29952/32000 (94%)] Loss: 1.32257 (QuantReg: 12.17383) QuantErr: 12.17383 batch_time=0.42639 
Train Epoch: 3 [941/1000 30112/32000 (94%)] Loss: 1.26674 (QuantReg: 12.09473) QuantErr: 12.09473 batch_time=0.47489 
Train Epoch: 3 [946/1000 30272/32000 (95%)] Loss: 1.51642 (QuantReg: 12.16865) QuantErr: 12.16865 batch_time=0.37159 
Train Epoch: 3 [951/1000 30432/32000 (95%)] Loss: 1.07881 (QuantReg: 12.96110) QuantErr: 12.96110 batch_time=0.37217 
Train Epoch: 3 [956/1000 30592/32000 (96%)] Loss: 1.06430 (QuantReg: 11.84169) QuantErr: 11.84169 batch_time=0.36724 
Train Epoch: 3 [961/1000 30752/32000 (96%)] Loss: 1.50676 (QuantReg: 12.31511) QuantErr: 12.31511 batch_time=0.34997 
Train Epoch: 3 [966/1000 30912/32000 (97%)] Loss: 1.19398 (QuantReg: 12.37823) QuantErr: 12.37823 batch_time=0.34550 
Train Epoch: 3 [971/1000 31072/32000 (97%)] Loss: 1.09660 (QuantReg: 12.50009) QuantErr: 12.50009 batch_time=0.40719 
Train Epoch: 3 [976/1000 31232/32000 (98%)] Loss: 1.16463 (QuantReg: 11.90133) QuantErr: 11.90133 batch_time=0.36682 
Train Epoch: 3 [981/1000 31392/32000 (98%)] Loss: 0.83200 (QuantReg: 11.96369) QuantErr: 11.96369 batch_time=0.52400 
Train Epoch: 3 [986/1000 31552/32000 (99%)] Loss: 1.41769 (QuantReg: 12.37357) QuantErr: 12.37357 batch_time=0.36622 
Train Epoch: 3 [991/1000 31712/32000 (99%)] Loss: 1.22428 (QuantReg: 12.34901) QuantErr: 12.34901 batch_time=0.36405 
Train Epoch: 3 [996/1000 31872/32000 (100%)] Loss: 1.61299 (QuantReg: 11.73411) QuantErr: 11.73411 batch_time=0.41320 
Train Epoch: 3 codebook_update_time=1.73904
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch3.pth ...
Done in 5.498s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch3.pth ...
Done in 11.730s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 1.4534327801465987
 quant_reg      : 11.535980700492859
 quant_err      : 11.535980700492859
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 21.93158953722334
 MSRVTT_full_val/t2v_metrics/R5: 59.15492957746479
 MSRVTT_full_val/t2v_metrics/R10: 74.04426559356136
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.635814889336016
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.7984549485693
 MSRVTT_full_val/v2t_metrics/R1: 25.35211267605634
 MSRVTT_full_val/v2t_metrics/R5: 65.59356136820925
 MSRVTT_full_val/v2t_metrics/R10: 78.87323943661971
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.981891348088531
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.80834109694425
 MSRVTT_full_test/t2v_metrics/R1: 8.060200668896321
 MSRVTT_full_test/t2v_metrics/R5: 26.153846153846153
 MSRVTT_full_test/t2v_metrics/R10: 38.39464882943144
 MSRVTT_full_test/t2v_metrics/R50: 75.01672240802675
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.49866220735786
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.077857747322128
 MSRVTT_full_test/v2t_metrics/R1: 9.866220735785953
 MSRVTT_full_test/v2t_metrics/R5: 30.568561872909697
 MSRVTT_full_test/v2t_metrics/R10: 44.247491638795985
 MSRVTT_full_test/v2t_metrics/R50: 79.03010033444816
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 48.844314381270905
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.719461786105473
 mnt_best       : 20.077857747322128
 not_improved_count: 0
Train Epoch: 4 [1/1000 32/32000 (0%)] Loss: 1.12386 (QuantReg: 10.34636) QuantErr: 10.34636 batch_time=25.77478 
Train Epoch: 4 [6/1000 192/32000 (1%)] Loss: 1.65470 (QuantReg: 10.91533) QuantErr: 10.91533 batch_time=0.33859 
Train Epoch: 4 [11/1000 352/32000 (1%)] Loss: 1.87908 (QuantReg: 10.95987) QuantErr: 10.95987 batch_time=0.38632 
Train Epoch: 4 [16/1000 512/32000 (2%)] Loss: 1.26431 (QuantReg: 10.01782) QuantErr: 10.01782 batch_time=0.38765 
Train Epoch: 4 [21/1000 672/32000 (2%)] Loss: 1.46315 (QuantReg: 11.04662) QuantErr: 11.04662 batch_time=0.34171 
Train Epoch: 4 [26/1000 832/32000 (3%)] Loss: 1.00081 (QuantReg: 10.94565) QuantErr: 10.94565 batch_time=0.36030 
Train Epoch: 4 [31/1000 992/32000 (3%)] Loss: 1.56811 (QuantReg: 11.59233) QuantErr: 11.59233 batch_time=0.34164 
Train Epoch: 4 [36/1000 1152/32000 (4%)] Loss: 1.49248 (QuantReg: 11.21443) QuantErr: 11.21443 batch_time=0.34275 
Train Epoch: 4 [41/1000 1312/32000 (4%)] Loss: 0.80914 (QuantReg: 10.72559) QuantErr: 10.72559 batch_time=0.35684 
Train Epoch: 4 [46/1000 1472/32000 (5%)] Loss: 1.81205 (QuantReg: 11.16991) QuantErr: 11.16991 batch_time=0.37878 
Train Epoch: 4 [51/1000 1632/32000 (5%)] Loss: 1.52676 (QuantReg: 10.58070) QuantErr: 10.58070 batch_time=0.36847 
Train Epoch: 4 [56/1000 1792/32000 (6%)] Loss: 2.16543 (QuantReg: 10.66307) QuantErr: 10.66307 batch_time=0.38173 
Train Epoch: 4 [61/1000 1952/32000 (6%)] Loss: 1.37481 (QuantReg: 11.13906) QuantErr: 11.13906 batch_time=0.39105 
Train Epoch: 4 [66/1000 2112/32000 (7%)] Loss: 1.62864 (QuantReg: 11.30538) QuantErr: 11.30538 batch_time=0.36294 
Train Epoch: 4 [71/1000 2272/32000 (7%)] Loss: 1.32944 (QuantReg: 10.90402) QuantErr: 10.90402 batch_time=0.42322 
Train Epoch: 4 [76/1000 2432/32000 (8%)] Loss: 1.01465 (QuantReg: 10.82826) QuantErr: 10.82826 batch_time=0.42050 
Train Epoch: 4 [81/1000 2592/32000 (8%)] Loss: 1.41027 (QuantReg: 10.42536) QuantErr: 10.42536 batch_time=0.75967 
Train Epoch: 4 [86/1000 2752/32000 (9%)] Loss: 1.75177 (QuantReg: 10.85041) QuantErr: 10.85041 batch_time=0.35501 
Train Epoch: 4 [91/1000 2912/32000 (9%)] Loss: 1.16497 (QuantReg: 10.44587) QuantErr: 10.44587 batch_time=0.35698 
Train Epoch: 4 [96/1000 3072/32000 (10%)] Loss: 1.16599 (QuantReg: 10.61362) QuantErr: 10.61362 batch_time=0.35662 
Train Epoch: 4 [101/1000 3232/32000 (10%)] Loss: 1.07224 (QuantReg: 10.83358) QuantErr: 10.83358 batch_time=0.67852 
Train Epoch: 4 [106/1000 3392/32000 (11%)] Loss: 1.27909 (QuantReg: 11.45662) QuantErr: 11.45662 batch_time=0.34400 
Train Epoch: 4 [111/1000 3552/32000 (11%)] Loss: 1.18548 (QuantReg: 10.96910) QuantErr: 10.96910 batch_time=0.36231 
Train Epoch: 4 [116/1000 3712/32000 (12%)] Loss: 1.54920 (QuantReg: 11.08904) QuantErr: 11.08904 batch_time=0.34878 
Train Epoch: 4 [121/1000 3872/32000 (12%)] Loss: 1.19512 (QuantReg: 11.19780) QuantErr: 11.19780 batch_time=0.34929 
Train Epoch: 4 [126/1000 4032/32000 (13%)] Loss: 0.88334 (QuantReg: 10.96766) QuantErr: 10.96766 batch_time=0.34356 
Train Epoch: 4 [131/1000 4192/32000 (13%)] Loss: 2.06442 (QuantReg: 11.11798) QuantErr: 11.11798 batch_time=0.36964 
Train Epoch: 4 [136/1000 4352/32000 (14%)] Loss: 1.66493 (QuantReg: 10.60965) QuantErr: 10.60965 batch_time=0.34966 
Train Epoch: 4 [141/1000 4512/32000 (14%)] Loss: 0.89968 (QuantReg: 10.78391) QuantErr: 10.78391 batch_time=0.40132 
Train Epoch: 4 [146/1000 4672/32000 (15%)] Loss: 1.76141 (QuantReg: 10.63532) QuantErr: 10.63532 batch_time=1.22628 
Train Epoch: 4 [151/1000 4832/32000 (15%)] Loss: 1.09756 (QuantReg: 10.72176) QuantErr: 10.72176 batch_time=0.33445 
Train Epoch: 4 [156/1000 4992/32000 (16%)] Loss: 1.11673 (QuantReg: 10.09869) QuantErr: 10.09869 batch_time=0.34106 
Train Epoch: 4 [161/1000 5152/32000 (16%)] Loss: 0.90794 (QuantReg: 10.55982) QuantErr: 10.55982 batch_time=0.36689 
Train Epoch: 4 [166/1000 5312/32000 (17%)] Loss: 1.34873 (QuantReg: 10.94918) QuantErr: 10.94918 batch_time=0.36347 
Train Epoch: 4 [171/1000 5472/32000 (17%)] Loss: 1.48079 (QuantReg: 10.86933) QuantErr: 10.86933 batch_time=0.35974 
Train Epoch: 4 [176/1000 5632/32000 (18%)] Loss: 1.14029 (QuantReg: 10.91858) QuantErr: 10.91858 batch_time=0.33697 
Train Epoch: 4 [181/1000 5792/32000 (18%)] Loss: 1.53405 (QuantReg: 11.27956) QuantErr: 11.27956 batch_time=0.34473 
Train Epoch: 4 [186/1000 5952/32000 (19%)] Loss: 1.22702 (QuantReg: 10.53194) QuantErr: 10.53194 batch_time=0.36350 
Train Epoch: 4 [191/1000 6112/32000 (19%)] Loss: 1.07131 (QuantReg: 11.37356) QuantErr: 11.37356 batch_time=0.35607 
Train Epoch: 4 [196/1000 6272/32000 (20%)] Loss: 0.93673 (QuantReg: 10.83490) QuantErr: 10.83490 batch_time=0.37558 
Train Epoch: 4 [201/1000 6432/32000 (20%)] Loss: 0.85529 (QuantReg: 11.20622) QuantErr: 11.20622 batch_time=0.37188 
Train Epoch: 4 [206/1000 6592/32000 (21%)] Loss: 1.00343 (QuantReg: 11.20886) QuantErr: 11.20886 batch_time=0.36002 
Train Epoch: 4 [211/1000 6752/32000 (21%)] Loss: 0.91164 (QuantReg: 10.84694) QuantErr: 10.84694 batch_time=0.34067 
Train Epoch: 4 [216/1000 6912/32000 (22%)] Loss: 1.80875 (QuantReg: 10.91460) QuantErr: 10.91460 batch_time=0.42868 
Train Epoch: 4 [221/1000 7072/32000 (22%)] Loss: 0.83357 (QuantReg: 10.66900) QuantErr: 10.66900 batch_time=0.34586 
Train Epoch: 4 [226/1000 7232/32000 (23%)] Loss: 1.25133 (QuantReg: 11.21801) QuantErr: 11.21801 batch_time=0.37069 
Train Epoch: 4 [231/1000 7392/32000 (23%)] Loss: 2.01608 (QuantReg: 10.87649) QuantErr: 10.87649 batch_time=0.34379 
Train Epoch: 4 [236/1000 7552/32000 (24%)] Loss: 0.64059 (QuantReg: 11.58602) QuantErr: 11.58602 batch_time=0.35073 
Train Epoch: 4 [241/1000 7712/32000 (24%)] Loss: 0.89010 (QuantReg: 10.15833) QuantErr: 10.15833 batch_time=0.35670 
Train Epoch: 4 [246/1000 7872/32000 (25%)] Loss: 1.36347 (QuantReg: 10.40638) QuantErr: 10.40638 batch_time=0.36963 
Train Epoch: 4 [251/1000 8032/32000 (25%)] Loss: 0.75125 (QuantReg: 11.87844) QuantErr: 11.87844 batch_time=0.35861 
Train Epoch: 4 [256/1000 8192/32000 (26%)] Loss: 1.37699 (QuantReg: 10.94012) QuantErr: 10.94012 batch_time=0.34277 
Train Epoch: 4 [261/1000 8352/32000 (26%)] Loss: 0.92294 (QuantReg: 11.90754) QuantErr: 11.90754 batch_time=0.39111 
Train Epoch: 4 [266/1000 8512/32000 (27%)] Loss: 2.25109 (QuantReg: 11.27125) QuantErr: 11.27125 batch_time=0.35295 
Train Epoch: 4 [271/1000 8672/32000 (27%)] Loss: 1.90601 (QuantReg: 11.65472) QuantErr: 11.65472 batch_time=0.38787 
Train Epoch: 4 [276/1000 8832/32000 (28%)] Loss: 1.77711 (QuantReg: 11.76749) QuantErr: 11.76749 batch_time=0.34940 
Train Epoch: 4 [281/1000 8992/32000 (28%)] Loss: 0.74584 (QuantReg: 11.71496) QuantErr: 11.71496 batch_time=0.36277 
Train Epoch: 4 [286/1000 9152/32000 (29%)] Loss: 0.78310 (QuantReg: 11.81483) QuantErr: 11.81483 batch_time=0.35169 
Train Epoch: 4 [291/1000 9312/32000 (29%)] Loss: 1.11965 (QuantReg: 11.08590) QuantErr: 11.08590 batch_time=0.38365 
Train Epoch: 4 [296/1000 9472/32000 (30%)] Loss: 0.79438 (QuantReg: 11.31688) QuantErr: 11.31688 batch_time=0.34881 
Train Epoch: 4 [301/1000 9632/32000 (30%)] Loss: 0.81034 (QuantReg: 12.35385) QuantErr: 12.35385 batch_time=0.40940 
Train Epoch: 4 [306/1000 9792/32000 (31%)] Loss: 1.95277 (QuantReg: 12.11827) QuantErr: 12.11827 batch_time=0.35343 
Train Epoch: 4 [311/1000 9952/32000 (31%)] Loss: 0.91879 (QuantReg: 11.40559) QuantErr: 11.40559 batch_time=0.38083 
Train Epoch: 4 [316/1000 10112/32000 (32%)] Loss: 1.07846 (QuantReg: 11.66162) QuantErr: 11.66162 batch_time=0.40594 
Train Epoch: 4 [321/1000 10272/32000 (32%)] Loss: 2.22396 (QuantReg: 10.71361) QuantErr: 10.71361 batch_time=0.61777 
Train Epoch: 4 [326/1000 10432/32000 (33%)] Loss: 0.97413 (QuantReg: 11.44596) QuantErr: 11.44596 batch_time=0.35227 
Train Epoch: 4 [331/1000 10592/32000 (33%)] Loss: 1.45000 (QuantReg: 11.40689) QuantErr: 11.40689 batch_time=0.34921 
Train Epoch: 4 [336/1000 10752/32000 (34%)] Loss: 1.39919 (QuantReg: 11.68072) QuantErr: 11.68072 batch_time=0.37969 
Train Epoch: 4 [341/1000 10912/32000 (34%)] Loss: 0.74932 (QuantReg: 10.90322) QuantErr: 10.90322 batch_time=0.33579 
Train Epoch: 4 [346/1000 11072/32000 (35%)] Loss: 1.03678 (QuantReg: 11.69892) QuantErr: 11.69892 batch_time=0.34428 
Train Epoch: 4 [351/1000 11232/32000 (35%)] Loss: 0.83494 (QuantReg: 11.23200) QuantErr: 11.23200 batch_time=0.34596 
Train Epoch: 4 [356/1000 11392/32000 (36%)] Loss: 1.55796 (QuantReg: 11.28830) QuantErr: 11.28830 batch_time=0.35688 
Train Epoch: 4 [361/1000 11552/32000 (36%)] Loss: 1.08440 (QuantReg: 11.07843) QuantErr: 11.07843 batch_time=0.35454 
Train Epoch: 4 [366/1000 11712/32000 (37%)] Loss: 1.86830 (QuantReg: 11.15651) QuantErr: 11.15651 batch_time=0.35451 
Train Epoch: 4 [371/1000 11872/32000 (37%)] Loss: 0.89263 (QuantReg: 11.90995) QuantErr: 11.90995 batch_time=0.39969 
Train Epoch: 4 [376/1000 12032/32000 (38%)] Loss: 0.75924 (QuantReg: 11.41353) QuantErr: 11.41353 batch_time=0.35588 
Train Epoch: 4 [381/1000 12192/32000 (38%)] Loss: 1.61214 (QuantReg: 11.37805) QuantErr: 11.37805 batch_time=0.35110 
Train Epoch: 4 [386/1000 12352/32000 (39%)] Loss: 1.35135 (QuantReg: 11.81641) QuantErr: 11.81641 batch_time=0.34419 
Train Epoch: 4 [391/1000 12512/32000 (39%)] Loss: 1.44778 (QuantReg: 11.39335) QuantErr: 11.39335 batch_time=0.35887 
Train Epoch: 4 [396/1000 12672/32000 (40%)] Loss: 1.22347 (QuantReg: 11.33986) QuantErr: 11.33986 batch_time=0.35576 
Train Epoch: 4 [401/1000 12832/32000 (40%)] Loss: 1.88540 (QuantReg: 11.04158) QuantErr: 11.04158 batch_time=0.66426 
Train Epoch: 4 [406/1000 12992/32000 (41%)] Loss: 1.27391 (QuantReg: 10.70076) QuantErr: 10.70076 batch_time=0.35624 
Train Epoch: 4 [411/1000 13152/32000 (41%)] Loss: 0.86141 (QuantReg: 10.73577) QuantErr: 10.73577 batch_time=0.34386 
Train Epoch: 4 [416/1000 13312/32000 (42%)] Loss: 1.71423 (QuantReg: 11.83694) QuantErr: 11.83694 batch_time=0.34670 
Train Epoch: 4 [421/1000 13472/32000 (42%)] Loss: 1.46821 (QuantReg: 11.29256) QuantErr: 11.29256 batch_time=0.75233 
Train Epoch: 4 [426/1000 13632/32000 (43%)] Loss: 1.67713 (QuantReg: 11.32981) QuantErr: 11.32981 batch_time=0.39394 
Train Epoch: 4 [431/1000 13792/32000 (43%)] Loss: 1.41422 (QuantReg: 11.29355) QuantErr: 11.29355 batch_time=0.36105 
Train Epoch: 4 [436/1000 13952/32000 (44%)] Loss: 1.24191 (QuantReg: 11.68811) QuantErr: 11.68811 batch_time=0.35434 
Train Epoch: 4 [441/1000 14112/32000 (44%)] Loss: 1.28997 (QuantReg: 11.63224) QuantErr: 11.63224 batch_time=0.35226 
Train Epoch: 4 [446/1000 14272/32000 (45%)] Loss: 1.80813 (QuantReg: 11.11112) QuantErr: 11.11112 batch_time=0.35315 
Train Epoch: 4 [451/1000 14432/32000 (45%)] Loss: 1.81768 (QuantReg: 11.45284) QuantErr: 11.45284 batch_time=0.34802 
Train Epoch: 4 [456/1000 14592/32000 (46%)] Loss: 2.52446 (QuantReg: 11.58569) QuantErr: 11.58569 batch_time=0.38901 
Train Epoch: 4 [461/1000 14752/32000 (46%)] Loss: 0.96441 (QuantReg: 11.38031) QuantErr: 11.38031 batch_time=0.34658 
Train Epoch: 4 [466/1000 14912/32000 (47%)] Loss: 0.92319 (QuantReg: 11.40198) QuantErr: 11.40198 batch_time=1.30518 
Train Epoch: 4 [471/1000 15072/32000 (47%)] Loss: 0.90416 (QuantReg: 11.74739) QuantErr: 11.74739 batch_time=0.34171 
Train Epoch: 4 [476/1000 15232/32000 (48%)] Loss: 0.71989 (QuantReg: 11.38846) QuantErr: 11.38846 batch_time=0.36336 
Train Epoch: 4 [481/1000 15392/32000 (48%)] Loss: 1.44001 (QuantReg: 11.33880) QuantErr: 11.33880 batch_time=0.42580 
Train Epoch: 4 [486/1000 15552/32000 (49%)] Loss: 1.20283 (QuantReg: 11.90568) QuantErr: 11.90568 batch_time=0.34449 
Train Epoch: 4 [491/1000 15712/32000 (49%)] Loss: 1.29387 (QuantReg: 11.61418) QuantErr: 11.61418 batch_time=0.35143 
Train Epoch: 4 [496/1000 15872/32000 (50%)] Loss: 0.72606 (QuantReg: 12.13276) QuantErr: 12.13276 batch_time=0.37628 
Train Epoch: 4 [501/1000 16032/32000 (50%)] Loss: 1.09545 (QuantReg: 11.85587) QuantErr: 11.85587 batch_time=0.34793 
Train Epoch: 4 [506/1000 16192/32000 (51%)] Loss: 1.53059 (QuantReg: 11.62100) QuantErr: 11.62100 batch_time=0.36681 
Train Epoch: 4 [511/1000 16352/32000 (51%)] Loss: 1.46343 (QuantReg: 11.51748) QuantErr: 11.51748 batch_time=0.35341 
Train Epoch: 4 [516/1000 16512/32000 (52%)] Loss: 0.89097 (QuantReg: 11.47754) QuantErr: 11.47754 batch_time=0.38785 
Train Epoch: 4 [521/1000 16672/32000 (52%)] Loss: 1.38952 (QuantReg: 12.27271) QuantErr: 12.27271 batch_time=0.34936 
Train Epoch: 4 [526/1000 16832/32000 (53%)] Loss: 1.44717 (QuantReg: 11.96540) QuantErr: 11.96540 batch_time=0.34746 
Train Epoch: 4 [531/1000 16992/32000 (53%)] Loss: 0.98831 (QuantReg: 11.63492) QuantErr: 11.63492 batch_time=0.34976 
Train Epoch: 4 [536/1000 17152/32000 (54%)] Loss: 1.65469 (QuantReg: 11.15799) QuantErr: 11.15799 batch_time=0.35070 
Train Epoch: 4 [541/1000 17312/32000 (54%)] Loss: 0.96236 (QuantReg: 11.80400) QuantErr: 11.80400 batch_time=0.35082 
Train Epoch: 4 [546/1000 17472/32000 (55%)] Loss: 1.30553 (QuantReg: 11.63918) QuantErr: 11.63918 batch_time=0.37563 
Train Epoch: 4 [551/1000 17632/32000 (55%)] Loss: 1.44514 (QuantReg: 11.79959) QuantErr: 11.79959 batch_time=0.36595 
Train Epoch: 4 [556/1000 17792/32000 (56%)] Loss: 2.27549 (QuantReg: 11.45660) QuantErr: 11.45660 batch_time=0.37389 
Train Epoch: 4 [561/1000 17952/32000 (56%)] Loss: 1.34788 (QuantReg: 11.58592) QuantErr: 11.58592 batch_time=0.34513 
Train Epoch: 4 [566/1000 18112/32000 (57%)] Loss: 1.25611 (QuantReg: 11.18422) QuantErr: 11.18422 batch_time=0.34827 
Train Epoch: 4 [571/1000 18272/32000 (57%)] Loss: 0.69936 (QuantReg: 11.07231) QuantErr: 11.07231 batch_time=0.36948 
Train Epoch: 4 [576/1000 18432/32000 (58%)] Loss: 0.79463 (QuantReg: 12.18279) QuantErr: 12.18279 batch_time=0.34967 
Train Epoch: 4 [581/1000 18592/32000 (58%)] Loss: 1.33687 (QuantReg: 11.58686) QuantErr: 11.58686 batch_time=0.37953 
Train Epoch: 4 [586/1000 18752/32000 (59%)] Loss: 0.87813 (QuantReg: 12.17233) QuantErr: 12.17233 batch_time=0.34977 
Train Epoch: 4 [591/1000 18912/32000 (59%)] Loss: 2.28870 (QuantReg: 12.05174) QuantErr: 12.05174 batch_time=0.35098 
Train Epoch: 4 [596/1000 19072/32000 (60%)] Loss: 1.45742 (QuantReg: 11.79415) QuantErr: 11.79415 batch_time=0.35333 
Train Epoch: 4 [601/1000 19232/32000 (60%)] Loss: 1.34101 (QuantReg: 11.41357) QuantErr: 11.41357 batch_time=0.34379 
Train Epoch: 4 [606/1000 19392/32000 (61%)] Loss: 0.95938 (QuantReg: 11.76305) QuantErr: 11.76305 batch_time=0.34355 
Train Epoch: 4 [611/1000 19552/32000 (61%)] Loss: 1.75017 (QuantReg: 11.76818) QuantErr: 11.76818 batch_time=0.34259 
Train Epoch: 4 [616/1000 19712/32000 (62%)] Loss: 1.36932 (QuantReg: 11.75026) QuantErr: 11.75026 batch_time=0.34365 
Train Epoch: 4 [621/1000 19872/32000 (62%)] Loss: 0.94683 (QuantReg: 12.20250) QuantErr: 12.20250 batch_time=0.36570 
Train Epoch: 4 [626/1000 20032/32000 (63%)] Loss: 1.66507 (QuantReg: 12.28560) QuantErr: 12.28560 batch_time=0.37953 
Train Epoch: 4 [631/1000 20192/32000 (63%)] Loss: 1.49996 (QuantReg: 11.60707) QuantErr: 11.60707 batch_time=0.40216 
Train Epoch: 4 [636/1000 20352/32000 (64%)] Loss: 1.07412 (QuantReg: 12.15153) QuantErr: 12.15153 batch_time=0.35238 
Train Epoch: 4 [641/1000 20512/32000 (64%)] Loss: 2.09689 (QuantReg: 11.62302) QuantErr: 11.62302 batch_time=0.62681 
Train Epoch: 4 [646/1000 20672/32000 (65%)] Loss: 1.59450 (QuantReg: 11.98932) QuantErr: 11.98932 batch_time=0.39344 
Train Epoch: 4 [651/1000 20832/32000 (65%)] Loss: 0.49334 (QuantReg: 12.08441) QuantErr: 12.08441 batch_time=0.37479 
Train Epoch: 4 [656/1000 20992/32000 (66%)] Loss: 1.63322 (QuantReg: 11.45884) QuantErr: 11.45884 batch_time=0.37464 
Train Epoch: 4 [661/1000 21152/32000 (66%)] Loss: 1.69667 (QuantReg: 11.34579) QuantErr: 11.34579 batch_time=0.35134 
Train Epoch: 4 [666/1000 21312/32000 (67%)] Loss: 1.44401 (QuantReg: 11.44472) QuantErr: 11.44472 batch_time=0.37898 
Train Epoch: 4 [671/1000 21472/32000 (67%)] Loss: 0.98595 (QuantReg: 12.12633) QuantErr: 12.12633 batch_time=0.34777 
Train Epoch: 4 [676/1000 21632/32000 (68%)] Loss: 1.14139 (QuantReg: 11.80598) QuantErr: 11.80598 batch_time=0.34676 
Train Epoch: 4 [681/1000 21792/32000 (68%)] Loss: 1.39419 (QuantReg: 12.22165) QuantErr: 12.22165 batch_time=0.35739 
Train Epoch: 4 [686/1000 21952/32000 (69%)] Loss: 1.22240 (QuantReg: 11.50385) QuantErr: 11.50385 batch_time=0.37941 
Train Epoch: 4 [691/1000 22112/32000 (69%)] Loss: 1.22563 (QuantReg: 11.83153) QuantErr: 11.83153 batch_time=0.34821 
Train Epoch: 4 [696/1000 22272/32000 (70%)] Loss: 0.98807 (QuantReg: 11.91549) QuantErr: 11.91549 batch_time=0.34893 
Train Epoch: 4 [701/1000 22432/32000 (70%)] Loss: 0.94944 (QuantReg: 11.49312) QuantErr: 11.49312 batch_time=0.36220 
Train Epoch: 4 [706/1000 22592/32000 (71%)] Loss: 1.00466 (QuantReg: 12.03522) QuantErr: 12.03522 batch_time=0.35901 
Train Epoch: 4 [711/1000 22752/32000 (71%)] Loss: 1.24507 (QuantReg: 11.87013) QuantErr: 11.87013 batch_time=0.35314 
Train Epoch: 4 [716/1000 22912/32000 (72%)] Loss: 0.84959 (QuantReg: 11.83282) QuantErr: 11.83282 batch_time=0.36433 
Train Epoch: 4 [721/1000 23072/32000 (72%)] Loss: 0.51627 (QuantReg: 11.72932) QuantErr: 11.72932 batch_time=0.68878 
Train Epoch: 4 [726/1000 23232/32000 (73%)] Loss: 1.66732 (QuantReg: 11.46320) QuantErr: 11.46320 batch_time=0.39329 
Train Epoch: 4 [731/1000 23392/32000 (73%)] Loss: 1.63267 (QuantReg: 11.39305) QuantErr: 11.39305 batch_time=0.44127 
Train Epoch: 4 [736/1000 23552/32000 (74%)] Loss: 0.72838 (QuantReg: 11.97319) QuantErr: 11.97319 batch_time=0.44814 
Train Epoch: 4 [741/1000 23712/32000 (74%)] Loss: 1.10480 (QuantReg: 11.66606) QuantErr: 11.66606 batch_time=0.80606 
Train Epoch: 4 [746/1000 23872/32000 (75%)] Loss: 1.48930 (QuantReg: 11.20821) QuantErr: 11.20821 batch_time=0.42028 
Train Epoch: 4 [751/1000 24032/32000 (75%)] Loss: 1.03431 (QuantReg: 11.91032) QuantErr: 11.91032 batch_time=0.37822 
Train Epoch: 4 [756/1000 24192/32000 (76%)] Loss: 0.73002 (QuantReg: 11.47677) QuantErr: 11.47677 batch_time=0.38256 
Train Epoch: 4 [761/1000 24352/32000 (76%)] Loss: 0.93621 (QuantReg: 11.67867) QuantErr: 11.67867 batch_time=0.34137 
Train Epoch: 4 [766/1000 24512/32000 (77%)] Loss: 1.70521 (QuantReg: 11.96580) QuantErr: 11.96580 batch_time=0.34265 
Train Epoch: 4 [771/1000 24672/32000 (77%)] Loss: 0.83343 (QuantReg: 11.57373) QuantErr: 11.57373 batch_time=0.34168 
Train Epoch: 4 [776/1000 24832/32000 (78%)] Loss: 1.87698 (QuantReg: 12.09083) QuantErr: 12.09083 batch_time=0.36718 
Train Epoch: 4 [781/1000 24992/32000 (78%)] Loss: 1.14158 (QuantReg: 11.94407) QuantErr: 11.94407 batch_time=0.39346 
Train Epoch: 4 [786/1000 25152/32000 (79%)] Loss: 1.13787 (QuantReg: 11.31791) QuantErr: 11.31791 batch_time=1.29400 
Train Epoch: 4 [791/1000 25312/32000 (79%)] Loss: 2.33355 (QuantReg: 12.02308) QuantErr: 12.02308 batch_time=0.37923 
Train Epoch: 4 [796/1000 25472/32000 (80%)] Loss: 1.87154 (QuantReg: 12.08114) QuantErr: 12.08114 batch_time=0.35136 
Train Epoch: 4 [801/1000 25632/32000 (80%)] Loss: 1.16267 (QuantReg: 11.46022) QuantErr: 11.46022 batch_time=0.36236 
Train Epoch: 4 [806/1000 25792/32000 (81%)] Loss: 1.00870 (QuantReg: 12.02963) QuantErr: 12.02963 batch_time=0.34794 
Train Epoch: 4 [811/1000 25952/32000 (81%)] Loss: 1.27405 (QuantReg: 10.96243) QuantErr: 10.96243 batch_time=0.35437 
Train Epoch: 4 [816/1000 26112/32000 (82%)] Loss: 0.81459 (QuantReg: 12.06874) QuantErr: 12.06874 batch_time=0.37685 
Train Epoch: 4 [821/1000 26272/32000 (82%)] Loss: 1.03884 (QuantReg: 11.51163) QuantErr: 11.51163 batch_time=0.42396 
Train Epoch: 4 [826/1000 26432/32000 (83%)] Loss: 1.11370 (QuantReg: 11.96548) QuantErr: 11.96548 batch_time=0.35592 
Train Epoch: 4 [831/1000 26592/32000 (83%)] Loss: 1.44542 (QuantReg: 12.02598) QuantErr: 12.02598 batch_time=0.35189 
Train Epoch: 4 [836/1000 26752/32000 (84%)] Loss: 1.48285 (QuantReg: 12.05594) QuantErr: 12.05594 batch_time=0.34946 
Train Epoch: 4 [841/1000 26912/32000 (84%)] Loss: 1.33513 (QuantReg: 12.39741) QuantErr: 12.39741 batch_time=0.34780 
Train Epoch: 4 [846/1000 27072/32000 (85%)] Loss: 1.29885 (QuantReg: 12.03506) QuantErr: 12.03506 batch_time=0.34872 
Train Epoch: 4 [851/1000 27232/32000 (85%)] Loss: 0.81959 (QuantReg: 12.53165) QuantErr: 12.53165 batch_time=0.40753 
Train Epoch: 4 [856/1000 27392/32000 (86%)] Loss: 1.04445 (QuantReg: 11.26246) QuantErr: 11.26246 batch_time=0.38749 
Train Epoch: 4 [861/1000 27552/32000 (86%)] Loss: 0.85163 (QuantReg: 12.53065) QuantErr: 12.53065 batch_time=0.43842 
Train Epoch: 4 [866/1000 27712/32000 (87%)] Loss: 1.94188 (QuantReg: 12.43234) QuantErr: 12.43234 batch_time=0.44853 
Train Epoch: 4 [871/1000 27872/32000 (87%)] Loss: 0.86247 (QuantReg: 12.38196) QuantErr: 12.38196 batch_time=0.39974 
Train Epoch: 4 [876/1000 28032/32000 (88%)] Loss: 2.06198 (QuantReg: 12.16134) QuantErr: 12.16134 batch_time=0.42548 
Train Epoch: 4 [881/1000 28192/32000 (88%)] Loss: 0.84605 (QuantReg: 12.26774) QuantErr: 12.26774 batch_time=0.37326 
Train Epoch: 4 [886/1000 28352/32000 (89%)] Loss: 1.17683 (QuantReg: 12.09549) QuantErr: 12.09549 batch_time=0.40695 
Train Epoch: 4 [891/1000 28512/32000 (89%)] Loss: 1.00034 (QuantReg: 12.26042) QuantErr: 12.26042 batch_time=0.35987 
Train Epoch: 4 [896/1000 28672/32000 (90%)] Loss: 1.07458 (QuantReg: 11.61680) QuantErr: 11.61680 batch_time=0.39070 
Train Epoch: 4 [901/1000 28832/32000 (90%)] Loss: 1.43278 (QuantReg: 11.45211) QuantErr: 11.45211 batch_time=0.37920 
Train Epoch: 4 [906/1000 28992/32000 (91%)] Loss: 1.14927 (QuantReg: 11.72421) QuantErr: 11.72421 batch_time=0.36246 
Train Epoch: 4 [911/1000 29152/32000 (91%)] Loss: 1.51976 (QuantReg: 11.08740) QuantErr: 11.08740 batch_time=0.36038 
Train Epoch: 4 [916/1000 29312/32000 (92%)] Loss: 1.77937 (QuantReg: 11.09842) QuantErr: 11.09842 batch_time=0.34164 
Train Epoch: 4 [921/1000 29472/32000 (92%)] Loss: 1.46098 (QuantReg: 11.49658) QuantErr: 11.49658 batch_time=0.36230 
Train Epoch: 4 [926/1000 29632/32000 (93%)] Loss: 1.58518 (QuantReg: 11.31420) QuantErr: 11.31420 batch_time=0.35390 
Train Epoch: 4 [931/1000 29792/32000 (93%)] Loss: 0.71557 (QuantReg: 12.27386) QuantErr: 12.27386 batch_time=0.48759 
Train Epoch: 4 [936/1000 29952/32000 (94%)] Loss: 1.34178 (QuantReg: 11.45964) QuantErr: 11.45964 batch_time=0.41941 
Train Epoch: 4 [941/1000 30112/32000 (94%)] Loss: 1.44267 (QuantReg: 11.73820) QuantErr: 11.73820 batch_time=0.36910 
Train Epoch: 4 [946/1000 30272/32000 (95%)] Loss: 1.64934 (QuantReg: 11.72425) QuantErr: 11.72425 batch_time=0.35027 
Train Epoch: 4 [951/1000 30432/32000 (95%)] Loss: 0.66412 (QuantReg: 12.51880) QuantErr: 12.51880 batch_time=0.34562 
Train Epoch: 4 [956/1000 30592/32000 (96%)] Loss: 0.71893 (QuantReg: 11.75828) QuantErr: 11.75828 batch_time=0.34113 
Train Epoch: 4 [961/1000 30752/32000 (96%)] Loss: 0.88949 (QuantReg: 12.02532) QuantErr: 12.02532 batch_time=0.63554 
Train Epoch: 4 [966/1000 30912/32000 (97%)] Loss: 0.83178 (QuantReg: 12.00878) QuantErr: 12.00878 batch_time=0.34897 
Train Epoch: 4 [971/1000 31072/32000 (97%)] Loss: 0.63131 (QuantReg: 12.39248) QuantErr: 12.39248 batch_time=0.35592 
Train Epoch: 4 [976/1000 31232/32000 (98%)] Loss: 2.06811 (QuantReg: 11.94509) QuantErr: 11.94509 batch_time=0.39677 
Train Epoch: 4 [981/1000 31392/32000 (98%)] Loss: 0.97224 (QuantReg: 11.98300) QuantErr: 11.98300 batch_time=0.34990 
Train Epoch: 4 [986/1000 31552/32000 (99%)] Loss: 1.21225 (QuantReg: 12.09627) QuantErr: 12.09627 batch_time=0.34326 
Train Epoch: 4 [991/1000 31712/32000 (99%)] Loss: 1.16338 (QuantReg: 12.38461) QuantErr: 12.38461 batch_time=0.35818 
Train Epoch: 4 [996/1000 31872/32000 (100%)] Loss: 0.91419 (QuantReg: 12.03843) QuantErr: 12.03843 batch_time=0.36414 
Train Epoch: 4 codebook_update_time=1.80189
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch4.pth ...
Done in 5.640s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 1.2791777183711528
 quant_reg      : 11.486413223266602
 quant_err      : 11.486413223266602
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 23.74245472837022
 MSRVTT_full_val/t2v_metrics/R5: 58.14889336016097
 MSRVTT_full_val/t2v_metrics/R10: 71.22736418511066
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.364185110663984
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.15704337415758
 MSRVTT_full_val/v2t_metrics/R1: 25.35211267605634
 MSRVTT_full_val/v2t_metrics/R5: 65.79476861167002
 MSRVTT_full_val/v2t_metrics/R10: 80.0804828973843
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.663983903420522
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.11841756399216
 MSRVTT_full_test/t2v_metrics/R1: 7.759197324414716
 MSRVTT_full_test/t2v_metrics/R5: 24.648829431438127
 MSRVTT_full_test/t2v_metrics/R10: 36.75585284280937
 MSRVTT_full_test/t2v_metrics/R50: 72.3076923076923
 MSRVTT_full_test/t2v_metrics/MedR: 19.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.80652173913043
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.156369265012028
 MSRVTT_full_test/v2t_metrics/R1: 10.167224080267559
 MSRVTT_full_test/v2t_metrics/R5: 29.19732441471572
 MSRVTT_full_test/v2t_metrics/R10: 42.508361204013376
 MSRVTT_full_test/v2t_metrics/R50: 77.72575250836121
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 47.44983277591973
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.281266611223256
 mnt_best       : 20.077857747322128
 not_improved_count: 1
Train Epoch: 5 [1/1000 32/32000 (0%)] Loss: 1.13951 (QuantReg: 11.06128) QuantErr: 11.06128 batch_time=28.88407 
Train Epoch: 5 [6/1000 192/32000 (1%)] Loss: 1.12384 (QuantReg: 11.06400) QuantErr: 11.06400 batch_time=0.34919 
Train Epoch: 5 [11/1000 352/32000 (1%)] Loss: 1.18414 (QuantReg: 10.83732) QuantErr: 10.83732 batch_time=0.35543 
Train Epoch: 5 [16/1000 512/32000 (2%)] Loss: 1.73014 (QuantReg: 11.01413) QuantErr: 11.01413 batch_time=0.34939 
Train Epoch: 5 [21/1000 672/32000 (2%)] Loss: 1.39489 (QuantReg: 10.36826) QuantErr: 10.36826 batch_time=0.36005 
Train Epoch: 5 [26/1000 832/32000 (3%)] Loss: 1.00940 (QuantReg: 10.54677) QuantErr: 10.54677 batch_time=0.35366 
Train Epoch: 5 [31/1000 992/32000 (3%)] Loss: 1.06962 (QuantReg: 11.75001) QuantErr: 11.75001 batch_time=0.35550 
Train Epoch: 5 [36/1000 1152/32000 (4%)] Loss: 1.52584 (QuantReg: 11.40725) QuantErr: 11.40725 batch_time=0.34754 
Train Epoch: 5 [41/1000 1312/32000 (4%)] Loss: 1.36991 (QuantReg: 11.09343) QuantErr: 11.09343 batch_time=0.40030 
Train Epoch: 5 [46/1000 1472/32000 (5%)] Loss: 1.16050 (QuantReg: 11.71319) QuantErr: 11.71319 batch_time=0.36873 
Train Epoch: 5 [51/1000 1632/32000 (5%)] Loss: 1.31458 (QuantReg: 11.00680) QuantErr: 11.00680 batch_time=0.41758 
Train Epoch: 5 [56/1000 1792/32000 (6%)] Loss: 1.08981 (QuantReg: 11.20376) QuantErr: 11.20376 batch_time=0.39830 
Train Epoch: 5 [61/1000 1952/32000 (6%)] Loss: 1.73275 (QuantReg: 11.67215) QuantErr: 11.67215 batch_time=0.35272 
Train Epoch: 5 [66/1000 2112/32000 (7%)] Loss: 0.82641 (QuantReg: 11.52173) QuantErr: 11.52173 batch_time=0.36244 
Train Epoch: 5 [71/1000 2272/32000 (7%)] Loss: 1.42988 (QuantReg: 11.74987) QuantErr: 11.74987 batch_time=0.36271 
Train Epoch: 5 [76/1000 2432/32000 (8%)] Loss: 0.88532 (QuantReg: 11.54935) QuantErr: 11.54935 batch_time=0.34154 
Train Epoch: 5 [81/1000 2592/32000 (8%)] Loss: 1.36478 (QuantReg: 10.97598) QuantErr: 10.97598 batch_time=0.34340 
Train Epoch: 5 [86/1000 2752/32000 (9%)] Loss: 1.84714 (QuantReg: 11.54018) QuantErr: 11.54018 batch_time=0.34528 
Train Epoch: 5 [91/1000 2912/32000 (9%)] Loss: 1.77020 (QuantReg: 11.44770) QuantErr: 11.44770 batch_time=0.34631 
Train Epoch: 5 [96/1000 3072/32000 (10%)] Loss: 0.98937 (QuantReg: 11.31926) QuantErr: 11.31926 batch_time=0.43101 
Train Epoch: 5 [101/1000 3232/32000 (10%)] Loss: 0.99938 (QuantReg: 11.33757) QuantErr: 11.33757 batch_time=0.35978 
Train Epoch: 5 [106/1000 3392/32000 (11%)] Loss: 1.17399 (QuantReg: 11.37474) QuantErr: 11.37474 batch_time=0.38800 
Train Epoch: 5 [111/1000 3552/32000 (11%)] Loss: 0.64991 (QuantReg: 10.76908) QuantErr: 10.76908 batch_time=0.35604 
Train Epoch: 5 [116/1000 3712/32000 (12%)] Loss: 1.00199 (QuantReg: 10.93413) QuantErr: 10.93413 batch_time=0.43505 
Train Epoch: 5 [121/1000 3872/32000 (12%)] Loss: 0.89151 (QuantReg: 11.22787) QuantErr: 11.22787 batch_time=0.38772 
Train Epoch: 5 [126/1000 4032/32000 (13%)] Loss: 0.97621 (QuantReg: 11.59740) QuantErr: 11.59740 batch_time=0.37099 
Train Epoch: 5 [131/1000 4192/32000 (13%)] Loss: 1.29595 (QuantReg: 11.37176) QuantErr: 11.37176 batch_time=0.36551 
Train Epoch: 5 [136/1000 4352/32000 (14%)] Loss: 1.31097 (QuantReg: 11.26660) QuantErr: 11.26660 batch_time=0.34773 
Train Epoch: 5 [141/1000 4512/32000 (14%)] Loss: 0.63089 (QuantReg: 10.83376) QuantErr: 10.83376 batch_time=0.35168 
Train Epoch: 5 [146/1000 4672/32000 (15%)] Loss: 1.41942 (QuantReg: 11.21254) QuantErr: 11.21254 batch_time=0.40265 
Train Epoch: 5 [151/1000 4832/32000 (15%)] Loss: 1.37293 (QuantReg: 11.39983) QuantErr: 11.39983 batch_time=0.36238 
Train Epoch: 5 [156/1000 4992/32000 (16%)] Loss: 0.98263 (QuantReg: 11.37912) QuantErr: 11.37912 batch_time=0.35995 
Train Epoch: 5 [161/1000 5152/32000 (16%)] Loss: 1.78208 (QuantReg: 11.56003) QuantErr: 11.56003 batch_time=0.35555 
Train Epoch: 5 [166/1000 5312/32000 (17%)] Loss: 0.77542 (QuantReg: 11.43434) QuantErr: 11.43434 batch_time=0.34453 
Train Epoch: 5 [171/1000 5472/32000 (17%)] Loss: 1.15898 (QuantReg: 11.22365) QuantErr: 11.22365 batch_time=0.34647 
Train Epoch: 5 [176/1000 5632/32000 (18%)] Loss: 1.23235 (QuantReg: 11.10161) QuantErr: 11.10161 batch_time=0.35176 
Train Epoch: 5 [181/1000 5792/32000 (18%)] Loss: 0.48278 (QuantReg: 11.98213) QuantErr: 11.98213 batch_time=0.34206 
Train Epoch: 5 [186/1000 5952/32000 (19%)] Loss: 0.97184 (QuantReg: 11.39695) QuantErr: 11.39695 batch_time=0.34172 
Train Epoch: 5 [191/1000 6112/32000 (19%)] Loss: 1.32318 (QuantReg: 11.65998) QuantErr: 11.65998 batch_time=0.34673 
Train Epoch: 5 [196/1000 6272/32000 (20%)] Loss: 1.10200 (QuantReg: 11.18944) QuantErr: 11.18944 batch_time=0.35400 
Train Epoch: 5 [201/1000 6432/32000 (20%)] Loss: 1.60869 (QuantReg: 12.03397) QuantErr: 12.03397 batch_time=0.34588 
Train Epoch: 5 [206/1000 6592/32000 (21%)] Loss: 1.67976 (QuantReg: 11.75753) QuantErr: 11.75753 batch_time=0.57971 
Train Epoch: 5 [211/1000 6752/32000 (21%)] Loss: 1.25174 (QuantReg: 11.49348) QuantErr: 11.49348 batch_time=0.52689 
Train Epoch: 5 [216/1000 6912/32000 (22%)] Loss: 1.16294 (QuantReg: 11.40252) QuantErr: 11.40252 batch_time=0.36152 
Train Epoch: 5 [221/1000 7072/32000 (22%)] Loss: 0.85024 (QuantReg: 11.68428) QuantErr: 11.68428 batch_time=0.34137 
Train Epoch: 5 [226/1000 7232/32000 (23%)] Loss: 0.66128 (QuantReg: 11.39121) QuantErr: 11.39121 batch_time=0.39654 
Train Epoch: 5 [231/1000 7392/32000 (23%)] Loss: 1.18795 (QuantReg: 11.14495) QuantErr: 11.14495 batch_time=0.34394 
Train Epoch: 5 [236/1000 7552/32000 (24%)] Loss: 0.80565 (QuantReg: 11.83821) QuantErr: 11.83821 batch_time=0.34724 
Train Epoch: 5 [241/1000 7712/32000 (24%)] Loss: 1.32123 (QuantReg: 11.45856) QuantErr: 11.45856 batch_time=0.34119 
Train Epoch: 5 [246/1000 7872/32000 (25%)] Loss: 0.48607 (QuantReg: 11.58224) QuantErr: 11.58224 batch_time=0.61805 
Train Epoch: 5 [251/1000 8032/32000 (25%)] Loss: 1.81719 (QuantReg: 11.22965) QuantErr: 11.22965 batch_time=0.37356 
Train Epoch: 5 [256/1000 8192/32000 (26%)] Loss: 1.03113 (QuantReg: 11.38262) QuantErr: 11.38262 batch_time=0.35441 
Train Epoch: 5 [261/1000 8352/32000 (26%)] Loss: 0.74208 (QuantReg: 11.12218) QuantErr: 11.12218 batch_time=0.35170 
Train Epoch: 5 [266/1000 8512/32000 (27%)] Loss: 1.43749 (QuantReg: 11.77453) QuantErr: 11.77453 batch_time=0.34782 
Train Epoch: 5 [271/1000 8672/32000 (27%)] Loss: 0.66555 (QuantReg: 11.18696) QuantErr: 11.18696 batch_time=0.34100 
Train Epoch: 5 [276/1000 8832/32000 (28%)] Loss: 1.00132 (QuantReg: 11.55597) QuantErr: 11.55597 batch_time=0.34683 
Train Epoch: 5 [281/1000 8992/32000 (28%)] Loss: 1.39597 (QuantReg: 11.72156) QuantErr: 11.72156 batch_time=0.35624 
Train Epoch: 5 [286/1000 9152/32000 (29%)] Loss: 1.11350 (QuantReg: 11.17796) QuantErr: 11.17796 batch_time=0.34461 
Train Epoch: 5 [291/1000 9312/32000 (29%)] Loss: 0.87926 (QuantReg: 11.44560) QuantErr: 11.44560 batch_time=1.10718 
Train Epoch: 5 [296/1000 9472/32000 (30%)] Loss: 1.14929 (QuantReg: 10.98069) QuantErr: 10.98069 batch_time=0.34479 
Train Epoch: 5 [301/1000 9632/32000 (30%)] Loss: 1.04447 (QuantReg: 11.71910) QuantErr: 11.71910 batch_time=0.34070 
Train Epoch: 5 [306/1000 9792/32000 (31%)] Loss: 1.12733 (QuantReg: 12.10318) QuantErr: 12.10318 batch_time=0.34016 
Train Epoch: 5 [311/1000 9952/32000 (31%)] Loss: 1.10023 (QuantReg: 11.31102) QuantErr: 11.31102 batch_time=0.38375 
Train Epoch: 5 [316/1000 10112/32000 (32%)] Loss: 1.30514 (QuantReg: 11.97460) QuantErr: 11.97460 batch_time=0.37018 
Train Epoch: 5 [321/1000 10272/32000 (32%)] Loss: 1.37433 (QuantReg: 10.96972) QuantErr: 10.96972 batch_time=0.67678 
Train Epoch: 5 [326/1000 10432/32000 (33%)] Loss: 1.28084 (QuantReg: 11.81195) QuantErr: 11.81195 batch_time=0.34912 
Train Epoch: 5 [331/1000 10592/32000 (33%)] Loss: 1.08086 (QuantReg: 11.48718) QuantErr: 11.48718 batch_time=0.35606 
Train Epoch: 5 [336/1000 10752/32000 (34%)] Loss: 1.55639 (QuantReg: 11.04150) QuantErr: 11.04150 batch_time=0.34750 
Train Epoch: 5 [341/1000 10912/32000 (34%)] Loss: 0.85549 (QuantReg: 11.15668) QuantErr: 11.15668 batch_time=0.34508 
Train Epoch: 5 [346/1000 11072/32000 (35%)] Loss: 0.93068 (QuantReg: 11.60356) QuantErr: 11.60356 batch_time=0.39102 
Train Epoch: 5 [351/1000 11232/32000 (35%)] Loss: 0.92452 (QuantReg: 11.57280) QuantErr: 11.57280 batch_time=0.37597 
Train Epoch: 5 [356/1000 11392/32000 (36%)] Loss: 0.88045 (QuantReg: 11.83900) QuantErr: 11.83900 batch_time=0.36782 
Train Epoch: 5 [361/1000 11552/32000 (36%)] Loss: 0.86043 (QuantReg: 11.35855) QuantErr: 11.35855 batch_time=0.36156 
Train Epoch: 5 [366/1000 11712/32000 (37%)] Loss: 1.13746 (QuantReg: 11.45187) QuantErr: 11.45187 batch_time=0.34652 
Train Epoch: 5 [371/1000 11872/32000 (37%)] Loss: 1.00460 (QuantReg: 11.64049) QuantErr: 11.64049 batch_time=0.34687 
Train Epoch: 5 [376/1000 12032/32000 (38%)] Loss: 1.82661 (QuantReg: 11.18606) QuantErr: 11.18606 batch_time=0.34541 
Train Epoch: 5 [381/1000 12192/32000 (38%)] Loss: 1.66020 (QuantReg: 11.54058) QuantErr: 11.54058 batch_time=0.34059 
Train Epoch: 5 [386/1000 12352/32000 (39%)] Loss: 1.02640 (QuantReg: 11.83770) QuantErr: 11.83770 batch_time=0.37093 
Train Epoch: 5 [391/1000 12512/32000 (39%)] Loss: 0.77969 (QuantReg: 11.51291) QuantErr: 11.51291 batch_time=0.33702 
Train Epoch: 5 [396/1000 12672/32000 (40%)] Loss: 1.09373 (QuantReg: 11.07098) QuantErr: 11.07098 batch_time=0.33914 
Train Epoch: 5 [401/1000 12832/32000 (40%)] Loss: 0.74066 (QuantReg: 10.89410) QuantErr: 10.89410 batch_time=0.33721 
Train Epoch: 5 [406/1000 12992/32000 (41%)] Loss: 1.21838 (QuantReg: 11.38326) QuantErr: 11.38326 batch_time=0.35707 
Train Epoch: 5 [411/1000 13152/32000 (41%)] Loss: 1.11869 (QuantReg: 11.56849) QuantErr: 11.56849 batch_time=0.36589 
Train Epoch: 5 [416/1000 13312/32000 (42%)] Loss: 1.50436 (QuantReg: 11.27771) QuantErr: 11.27771 batch_time=0.47249 
Train Epoch: 5 [421/1000 13472/32000 (42%)] Loss: 1.15497 (QuantReg: 12.06741) QuantErr: 12.06741 batch_time=0.35991 
Train Epoch: 5 [426/1000 13632/32000 (43%)] Loss: 1.36208 (QuantReg: 11.67619) QuantErr: 11.67619 batch_time=0.34846 
Train Epoch: 5 [431/1000 13792/32000 (43%)] Loss: 0.67683 (QuantReg: 11.19641) QuantErr: 11.19641 batch_time=0.34546 
Train Epoch: 5 [436/1000 13952/32000 (44%)] Loss: 1.64318 (QuantReg: 10.90490) QuantErr: 10.90490 batch_time=0.35128 
Train Epoch: 5 [441/1000 14112/32000 (44%)] Loss: 1.73642 (QuantReg: 11.61455) QuantErr: 11.61455 batch_time=0.35016 
Train Epoch: 5 [446/1000 14272/32000 (45%)] Loss: 0.93847 (QuantReg: 12.54280) QuantErr: 12.54280 batch_time=0.34319 
Train Epoch: 5 [451/1000 14432/32000 (45%)] Loss: 2.41187 (QuantReg: 11.18163) QuantErr: 11.18163 batch_time=0.36556 
Train Epoch: 5 [456/1000 14592/32000 (46%)] Loss: 0.73890 (QuantReg: 11.31231) QuantErr: 11.31231 batch_time=0.35175 
Train Epoch: 5 [461/1000 14752/32000 (46%)] Loss: 1.01450 (QuantReg: 11.55986) QuantErr: 11.55986 batch_time=0.34128 
Train Epoch: 5 [466/1000 14912/32000 (47%)] Loss: 1.37087 (QuantReg: 12.20025) QuantErr: 12.20025 batch_time=0.34382 
Train Epoch: 5 [471/1000 15072/32000 (47%)] Loss: 1.04646 (QuantReg: 11.50366) QuantErr: 11.50366 batch_time=0.35648 
Train Epoch: 5 [476/1000 15232/32000 (48%)] Loss: 1.12825 (QuantReg: 11.69653) QuantErr: 11.69653 batch_time=0.37993 
Train Epoch: 5 [481/1000 15392/32000 (48%)] Loss: 1.27020 (QuantReg: 11.31730) QuantErr: 11.31730 batch_time=0.34829 
Train Epoch: 5 [486/1000 15552/32000 (49%)] Loss: 0.51397 (QuantReg: 12.39195) QuantErr: 12.39195 batch_time=0.35109 
Train Epoch: 5 [491/1000 15712/32000 (49%)] Loss: 1.12600 (QuantReg: 11.42596) QuantErr: 11.42596 batch_time=0.36859 
Train Epoch: 5 [496/1000 15872/32000 (50%)] Loss: 1.14022 (QuantReg: 12.21500) QuantErr: 12.21500 batch_time=0.34681 
Train Epoch: 5 [501/1000 16032/32000 (50%)] Loss: 0.66259 (QuantReg: 11.63804) QuantErr: 11.63804 batch_time=0.36164 
Train Epoch: 5 [506/1000 16192/32000 (51%)] Loss: 1.24675 (QuantReg: 11.89769) QuantErr: 11.89769 batch_time=0.34785 
Train Epoch: 5 [511/1000 16352/32000 (51%)] Loss: 1.15587 (QuantReg: 11.88704) QuantErr: 11.88704 batch_time=0.36002 
Train Epoch: 5 [516/1000 16512/32000 (52%)] Loss: 1.06643 (QuantReg: 11.53765) QuantErr: 11.53765 batch_time=0.36497 
Train Epoch: 5 [521/1000 16672/32000 (52%)] Loss: 1.31799 (QuantReg: 11.91158) QuantErr: 11.91158 batch_time=0.35014 
Train Epoch: 5 [526/1000 16832/32000 (53%)] Loss: 1.21260 (QuantReg: 11.82240) QuantErr: 11.82240 batch_time=0.61573 
Train Epoch: 5 [531/1000 16992/32000 (53%)] Loss: 1.71549 (QuantReg: 11.65254) QuantErr: 11.65254 batch_time=0.56706 
Train Epoch: 5 [536/1000 17152/32000 (54%)] Loss: 1.83004 (QuantReg: 10.70776) QuantErr: 10.70776 batch_time=0.38126 
Train Epoch: 5 [541/1000 17312/32000 (54%)] Loss: 0.82800 (QuantReg: 11.79157) QuantErr: 11.79157 batch_time=0.35374 
Train Epoch: 5 [546/1000 17472/32000 (55%)] Loss: 1.11261 (QuantReg: 12.24120) QuantErr: 12.24120 batch_time=0.41816 
Train Epoch: 5 [551/1000 17632/32000 (55%)] Loss: 1.14634 (QuantReg: 12.02781) QuantErr: 12.02781 batch_time=0.34974 
Train Epoch: 5 [556/1000 17792/32000 (56%)] Loss: 1.30396 (QuantReg: 11.70615) QuantErr: 11.70615 batch_time=0.35508 
Train Epoch: 5 [561/1000 17952/32000 (56%)] Loss: 0.95359 (QuantReg: 12.03981) QuantErr: 12.03981 batch_time=0.42780 
Train Epoch: 5 [566/1000 18112/32000 (57%)] Loss: 1.78218 (QuantReg: 11.94838) QuantErr: 11.94838 batch_time=0.70268 
Train Epoch: 5 [571/1000 18272/32000 (57%)] Loss: 0.84844 (QuantReg: 12.23825) QuantErr: 12.23825 batch_time=0.35974 
Train Epoch: 5 [576/1000 18432/32000 (58%)] Loss: 1.60281 (QuantReg: 12.01655) QuantErr: 12.01655 batch_time=0.34912 
Train Epoch: 5 [581/1000 18592/32000 (58%)] Loss: 0.94208 (QuantReg: 11.84766) QuantErr: 11.84766 batch_time=0.42687 
Train Epoch: 5 [586/1000 18752/32000 (59%)] Loss: 1.20821 (QuantReg: 11.96518) QuantErr: 11.96518 batch_time=0.40065 
Train Epoch: 5 [591/1000 18912/32000 (59%)] Loss: 1.44843 (QuantReg: 11.73241) QuantErr: 11.73241 batch_time=0.37087 
Train Epoch: 5 [596/1000 19072/32000 (60%)] Loss: 0.97594 (QuantReg: 11.32308) QuantErr: 11.32308 batch_time=0.40874 
Train Epoch: 5 [601/1000 19232/32000 (60%)] Loss: 0.94146 (QuantReg: 12.37124) QuantErr: 12.37124 batch_time=0.36227 
Train Epoch: 5 [606/1000 19392/32000 (61%)] Loss: 1.03798 (QuantReg: 12.05730) QuantErr: 12.05730 batch_time=0.34817 
Train Epoch: 5 [611/1000 19552/32000 (61%)] Loss: 1.31625 (QuantReg: 11.62206) QuantErr: 11.62206 batch_time=1.08773 
Train Epoch: 5 [616/1000 19712/32000 (62%)] Loss: 1.18616 (QuantReg: 11.81109) QuantErr: 11.81109 batch_time=0.40715 
Train Epoch: 5 [621/1000 19872/32000 (62%)] Loss: 0.65433 (QuantReg: 11.42125) QuantErr: 11.42125 batch_time=0.38634 
Train Epoch: 5 [626/1000 20032/32000 (63%)] Loss: 2.01568 (QuantReg: 11.30416) QuantErr: 11.30416 batch_time=0.34588 
Train Epoch: 5 [631/1000 20192/32000 (63%)] Loss: 1.93518 (QuantReg: 11.69308) QuantErr: 11.69308 batch_time=0.34765 
Train Epoch: 5 [636/1000 20352/32000 (64%)] Loss: 1.17219 (QuantReg: 12.65256) QuantErr: 12.65256 batch_time=0.34657 
Train Epoch: 5 [641/1000 20512/32000 (64%)] Loss: 0.99917 (QuantReg: 12.08990) QuantErr: 12.08990 batch_time=0.69813 
Train Epoch: 5 [646/1000 20672/32000 (65%)] Loss: 1.06699 (QuantReg: 12.31522) QuantErr: 12.31522 batch_time=0.34378 
Train Epoch: 5 [651/1000 20832/32000 (65%)] Loss: 1.05957 (QuantReg: 12.19736) QuantErr: 12.19736 batch_time=0.35219 
Train Epoch: 5 [656/1000 20992/32000 (66%)] Loss: 1.11438 (QuantReg: 11.25768) QuantErr: 11.25768 batch_time=0.34785 
Train Epoch: 5 [661/1000 21152/32000 (66%)] Loss: 0.91379 (QuantReg: 11.80865) QuantErr: 11.80865 batch_time=0.34488 
Train Epoch: 5 [666/1000 21312/32000 (67%)] Loss: 1.16828 (QuantReg: 12.05581) QuantErr: 12.05581 batch_time=0.34752 
Train Epoch: 5 [671/1000 21472/32000 (67%)] Loss: 0.84207 (QuantReg: 11.36312) QuantErr: 11.36312 batch_time=0.38763 
Train Epoch: 5 [676/1000 21632/32000 (68%)] Loss: 1.94032 (QuantReg: 10.90600) QuantErr: 10.90600 batch_time=0.35096 
Train Epoch: 5 [681/1000 21792/32000 (68%)] Loss: 0.66948 (QuantReg: 11.52441) QuantErr: 11.52441 batch_time=0.38674 
Train Epoch: 5 [686/1000 21952/32000 (69%)] Loss: 1.16354 (QuantReg: 11.47533) QuantErr: 11.47533 batch_time=0.37337 
Train Epoch: 5 [691/1000 22112/32000 (69%)] Loss: 0.79266 (QuantReg: 11.63342) QuantErr: 11.63342 batch_time=0.39625 
Train Epoch: 5 [696/1000 22272/32000 (70%)] Loss: 1.45823 (QuantReg: 11.25441) QuantErr: 11.25441 batch_time=0.35049 
Train Epoch: 5 [701/1000 22432/32000 (70%)] Loss: 0.93594 (QuantReg: 11.69967) QuantErr: 11.69967 batch_time=0.34520 
Train Epoch: 5 [706/1000 22592/32000 (71%)] Loss: 0.80611 (QuantReg: 12.19645) QuantErr: 12.19645 batch_time=0.37399 
Train Epoch: 5 [711/1000 22752/32000 (71%)] Loss: 1.29214 (QuantReg: 11.89407) QuantErr: 11.89407 batch_time=0.41696 
Train Epoch: 5 [716/1000 22912/32000 (72%)] Loss: 1.21093 (QuantReg: 11.46002) QuantErr: 11.46002 batch_time=0.37751 
Train Epoch: 5 [721/1000 23072/32000 (72%)] Loss: 0.82854 (QuantReg: 11.68662) QuantErr: 11.68662 batch_time=0.42273 
Train Epoch: 5 [726/1000 23232/32000 (73%)] Loss: 0.82594 (QuantReg: 12.34501) QuantErr: 12.34501 batch_time=0.37791 
Train Epoch: 5 [731/1000 23392/32000 (73%)] Loss: 0.98765 (QuantReg: 11.78001) QuantErr: 11.78001 batch_time=0.35316 
Train Epoch: 5 [736/1000 23552/32000 (74%)] Loss: 0.92599 (QuantReg: 11.44666) QuantErr: 11.44666 batch_time=0.44973 
Train Epoch: 5 [741/1000 23712/32000 (74%)] Loss: 1.11566 (QuantReg: 12.15617) QuantErr: 12.15617 batch_time=0.42737 
Train Epoch: 5 [746/1000 23872/32000 (75%)] Loss: 1.66968 (QuantReg: 11.56430) QuantErr: 11.56430 batch_time=0.40924 
Train Epoch: 5 [751/1000 24032/32000 (75%)] Loss: 0.92647 (QuantReg: 11.39467) QuantErr: 11.39467 batch_time=0.34733 
Train Epoch: 5 [756/1000 24192/32000 (76%)] Loss: 0.91770 (QuantReg: 11.84750) QuantErr: 11.84750 batch_time=0.42688 
Train Epoch: 5 [761/1000 24352/32000 (76%)] Loss: 2.17832 (QuantReg: 11.68047) QuantErr: 11.68047 batch_time=0.34879 
Train Epoch: 5 [766/1000 24512/32000 (77%)] Loss: 1.23864 (QuantReg: 12.34253) QuantErr: 12.34253 batch_time=0.34976 
Train Epoch: 5 [771/1000 24672/32000 (77%)] Loss: 0.89423 (QuantReg: 11.58226) QuantErr: 11.58226 batch_time=0.36992 
Train Epoch: 5 [776/1000 24832/32000 (78%)] Loss: 1.00576 (QuantReg: 12.08940) QuantErr: 12.08940 batch_time=0.41245 
Train Epoch: 5 [781/1000 24992/32000 (78%)] Loss: 0.94989 (QuantReg: 10.83491) QuantErr: 10.83491 batch_time=0.38493 
Train Epoch: 5 [786/1000 25152/32000 (79%)] Loss: 0.72110 (QuantReg: 12.54153) QuantErr: 12.54153 batch_time=0.36765 
Train Epoch: 5 [791/1000 25312/32000 (79%)] Loss: 1.44100 (QuantReg: 11.86253) QuantErr: 11.86253 batch_time=0.36448 
Train Epoch: 5 [796/1000 25472/32000 (80%)] Loss: 1.08271 (QuantReg: 11.01644) QuantErr: 11.01644 batch_time=0.34902 
Train Epoch: 5 [801/1000 25632/32000 (80%)] Loss: 1.25272 (QuantReg: 11.52719) QuantErr: 11.52719 batch_time=0.38227 
Train Epoch: 5 [806/1000 25792/32000 (81%)] Loss: 0.84684 (QuantReg: 11.27712) QuantErr: 11.27712 batch_time=0.35994 
Train Epoch: 5 [811/1000 25952/32000 (81%)] Loss: 0.68517 (QuantReg: 11.95347) QuantErr: 11.95347 batch_time=0.39458 
Train Epoch: 5 [816/1000 26112/32000 (82%)] Loss: 0.99059 (QuantReg: 11.76121) QuantErr: 11.76121 batch_time=0.34867 
Train Epoch: 5 [821/1000 26272/32000 (82%)] Loss: 0.79236 (QuantReg: 12.09247) QuantErr: 12.09247 batch_time=0.35783 
Train Epoch: 5 [826/1000 26432/32000 (83%)] Loss: 1.05426 (QuantReg: 11.91671) QuantErr: 11.91671 batch_time=0.34509 
Train Epoch: 5 [831/1000 26592/32000 (83%)] Loss: 1.13327 (QuantReg: 11.98993) QuantErr: 11.98993 batch_time=0.35650 
Train Epoch: 5 [836/1000 26752/32000 (84%)] Loss: 1.33685 (QuantReg: 11.60175) QuantErr: 11.60175 batch_time=0.38697 
Train Epoch: 5 [841/1000 26912/32000 (84%)] Loss: 1.37029 (QuantReg: 11.78210) QuantErr: 11.78210 batch_time=0.35618 
Train Epoch: 5 [846/1000 27072/32000 (85%)] Loss: 1.55232 (QuantReg: 11.72547) QuantErr: 11.72547 batch_time=0.57648 
Train Epoch: 5 [851/1000 27232/32000 (85%)] Loss: 0.84114 (QuantReg: 11.66688) QuantErr: 11.66688 batch_time=0.51522 
Train Epoch: 5 [856/1000 27392/32000 (86%)] Loss: 1.72252 (QuantReg: 12.19472) QuantErr: 12.19472 batch_time=0.41944 
Train Epoch: 5 [861/1000 27552/32000 (86%)] Loss: 1.05382 (QuantReg: 12.21666) QuantErr: 12.21666 batch_time=0.36594 
Train Epoch: 5 [866/1000 27712/32000 (87%)] Loss: 0.98786 (QuantReg: 11.97900) QuantErr: 11.97900 batch_time=0.43006 
Train Epoch: 5 [871/1000 27872/32000 (87%)] Loss: 0.66456 (QuantReg: 12.12997) QuantErr: 12.12997 batch_time=0.36305 
Train Epoch: 5 [876/1000 28032/32000 (88%)] Loss: 1.67918 (QuantReg: 11.45378) QuantErr: 11.45378 batch_time=0.35144 
Train Epoch: 5 [881/1000 28192/32000 (88%)] Loss: 1.70650 (QuantReg: 12.13137) QuantErr: 12.13137 batch_time=0.45121 
Train Epoch: 5 [886/1000 28352/32000 (89%)] Loss: 1.83001 (QuantReg: 11.37428) QuantErr: 11.37428 batch_time=0.66506 
Train Epoch: 5 [891/1000 28512/32000 (89%)] Loss: 0.59727 (QuantReg: 12.18933) QuantErr: 12.18933 batch_time=0.34378 
Train Epoch: 5 [896/1000 28672/32000 (90%)] Loss: 0.52556 (QuantReg: 11.58373) QuantErr: 11.58373 batch_time=0.40174 
Train Epoch: 5 [901/1000 28832/32000 (90%)] Loss: 1.29962 (QuantReg: 11.68518) QuantErr: 11.68518 batch_time=0.41442 
Train Epoch: 5 [906/1000 28992/32000 (91%)] Loss: 0.99812 (QuantReg: 11.24542) QuantErr: 11.24542 batch_time=0.42240 
Train Epoch: 5 [911/1000 29152/32000 (91%)] Loss: 0.95943 (QuantReg: 11.78579) QuantErr: 11.78579 batch_time=0.35183 
Train Epoch: 5 [916/1000 29312/32000 (92%)] Loss: 1.03381 (QuantReg: 11.76453) QuantErr: 11.76453 batch_time=0.36265 
Train Epoch: 5 [921/1000 29472/32000 (92%)] Loss: 1.47063 (QuantReg: 11.71714) QuantErr: 11.71714 batch_time=0.38795 
Train Epoch: 5 [926/1000 29632/32000 (93%)] Loss: 0.97053 (QuantReg: 11.94052) QuantErr: 11.94052 batch_time=0.43241 
Train Epoch: 5 [931/1000 29792/32000 (93%)] Loss: 0.50560 (QuantReg: 11.72291) QuantErr: 11.72291 batch_time=1.10773 
Train Epoch: 5 [936/1000 29952/32000 (94%)] Loss: 1.40193 (QuantReg: 11.58712) QuantErr: 11.58712 batch_time=0.39371 
Train Epoch: 5 [941/1000 30112/32000 (94%)] Loss: 1.15642 (QuantReg: 11.85041) QuantErr: 11.85041 batch_time=0.35107 
Train Epoch: 5 [946/1000 30272/32000 (95%)] Loss: 1.02691 (QuantReg: 11.86188) QuantErr: 11.86188 batch_time=0.36944 
Train Epoch: 5 [951/1000 30432/32000 (95%)] Loss: 1.36597 (QuantReg: 11.86483) QuantErr: 11.86483 batch_time=0.34932 
Train Epoch: 5 [956/1000 30592/32000 (96%)] Loss: 1.18187 (QuantReg: 12.18458) QuantErr: 12.18458 batch_time=0.39232 
Train Epoch: 5 [961/1000 30752/32000 (96%)] Loss: 1.44488 (QuantReg: 11.69361) QuantErr: 11.69361 batch_time=0.79001 
Train Epoch: 5 [966/1000 30912/32000 (97%)] Loss: 0.82481 (QuantReg: 12.05026) QuantErr: 12.05026 batch_time=0.38681 
Train Epoch: 5 [971/1000 31072/32000 (97%)] Loss: 1.39182 (QuantReg: 12.17025) QuantErr: 12.17025 batch_time=0.37039 
Train Epoch: 5 [976/1000 31232/32000 (98%)] Loss: 0.88073 (QuantReg: 11.59769) QuantErr: 11.59769 batch_time=0.38477 
Train Epoch: 5 [981/1000 31392/32000 (98%)] Loss: 0.93706 (QuantReg: 11.87314) QuantErr: 11.87314 batch_time=0.43254 
Train Epoch: 5 [986/1000 31552/32000 (99%)] Loss: 0.82171 (QuantReg: 11.54437) QuantErr: 11.54437 batch_time=0.36602 
Train Epoch: 5 [991/1000 31712/32000 (99%)] Loss: 0.81860 (QuantReg: 11.85380) QuantErr: 11.85380 batch_time=0.40730 
Train Epoch: 5 [996/1000 31872/32000 (100%)] Loss: 2.08994 (QuantReg: 11.91771) QuantErr: 11.91771 batch_time=0.42633 
Train Epoch: 5 codebook_update_time=2.00099
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch5.pth ...
Done in 17.471s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch5.pth ...
Done in 22.200s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 1.1420099577158689
 quant_reg      : 11.582453966140747
 quant_err      : 11.582453966140747
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 64.38631790744466
 MSRVTT_full_val/t2v_metrics/R10: 76.45875251509054
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.832997987927566
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.367613413072064
 MSRVTT_full_val/v2t_metrics/R1: 28.772635814889338
 MSRVTT_full_val/v2t_metrics/R5: 67.00201207243461
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.35814889336016
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.957941878991356
 MSRVTT_full_test/t2v_metrics/R1: 8.494983277591974
 MSRVTT_full_test/t2v_metrics/R5: 28.361204013377925
 MSRVTT_full_test/t2v_metrics/R10: 41.67224080267559
 MSRVTT_full_test/t2v_metrics/R50: 76.25418060200668
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.958193979933114
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.57304000071178
 MSRVTT_full_test/v2t_metrics/R1: 10.936454849498327
 MSRVTT_full_test/v2t_metrics/R5: 32.876254180602004
 MSRVTT_full_test/v2t_metrics/R10: 46.8561872909699
 MSRVTT_full_test/v2t_metrics/R50: 80.5351170568562
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.224414715719064
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.63550912029575
 mnt_best       : 21.57304000071178
 not_improved_count: 0
Train Epoch: 6 [1/1000 32/32000 (0%)] Loss: 2.13251 (QuantReg: 11.21784) QuantErr: 11.21784 batch_time=26.34839 
Train Epoch: 6 [6/1000 192/32000 (1%)] Loss: 1.00073 (QuantReg: 11.56502) QuantErr: 11.56502 batch_time=0.38464 
Train Epoch: 6 [11/1000 352/32000 (1%)] Loss: 1.10176 (QuantReg: 11.13931) QuantErr: 11.13931 batch_time=0.82818 
Train Epoch: 6 [16/1000 512/32000 (2%)] Loss: 1.42615 (QuantReg: 11.33333) QuantErr: 11.33333 batch_time=0.81504 
Train Epoch: 6 [21/1000 672/32000 (2%)] Loss: 1.39547 (QuantReg: 11.59661) QuantErr: 11.59661 batch_time=0.39373 
Train Epoch: 6 [26/1000 832/32000 (3%)] Loss: 0.86401 (QuantReg: 11.88820) QuantErr: 11.88820 batch_time=0.36060 
Train Epoch: 6 [31/1000 992/32000 (3%)] Loss: 1.02425 (QuantReg: 11.51701) QuantErr: 11.51701 batch_time=0.45242 
Train Epoch: 6 [36/1000 1152/32000 (4%)] Loss: 1.22432 (QuantReg: 11.64845) QuantErr: 11.64845 batch_time=0.39320 
Train Epoch: 6 [41/1000 1312/32000 (4%)] Loss: 0.51168 (QuantReg: 11.17491) QuantErr: 11.17491 batch_time=0.41030 
Train Epoch: 6 [46/1000 1472/32000 (5%)] Loss: 0.85577 (QuantReg: 10.47037) QuantErr: 10.47037 batch_time=0.42799 
Train Epoch: 6 [51/1000 1632/32000 (5%)] Loss: 1.41538 (QuantReg: 10.80232) QuantErr: 10.80232 batch_time=0.44318 
Train Epoch: 6 [56/1000 1792/32000 (6%)] Loss: 0.56568 (QuantReg: 12.12053) QuantErr: 12.12053 batch_time=0.46569 
Train Epoch: 6 [61/1000 1952/32000 (6%)] Loss: 2.57961 (QuantReg: 11.00577) QuantErr: 11.00577 batch_time=0.38313 
Train Epoch: 6 [66/1000 2112/32000 (7%)] Loss: 1.49834 (QuantReg: 11.86276) QuantErr: 11.86276 batch_time=0.43210 
Train Epoch: 6 [71/1000 2272/32000 (7%)] Loss: 1.12718 (QuantReg: 11.01218) QuantErr: 11.01218 batch_time=0.39559 
Train Epoch: 6 [76/1000 2432/32000 (8%)] Loss: 1.02548 (QuantReg: 11.63130) QuantErr: 11.63130 batch_time=0.37058 
Train Epoch: 6 [81/1000 2592/32000 (8%)] Loss: 1.73145 (QuantReg: 10.52564) QuantErr: 10.52564 batch_time=1.12938 
Train Epoch: 6 [86/1000 2752/32000 (9%)] Loss: 0.95013 (QuantReg: 11.22107) QuantErr: 11.22107 batch_time=0.40896 
Train Epoch: 6 [91/1000 2912/32000 (9%)] Loss: 0.79167 (QuantReg: 11.34331) QuantErr: 11.34331 batch_time=0.44771 
Train Epoch: 6 [96/1000 3072/32000 (10%)] Loss: 0.72443 (QuantReg: 11.13935) QuantErr: 11.13935 batch_time=0.43516 
Train Epoch: 6 [101/1000 3232/32000 (10%)] Loss: 0.81188 (QuantReg: 11.36476) QuantErr: 11.36476 batch_time=0.50019 
Train Epoch: 6 [106/1000 3392/32000 (11%)] Loss: 1.25890 (QuantReg: 11.16056) QuantErr: 11.16056 batch_time=0.35081 
Train Epoch: 6 [111/1000 3552/32000 (11%)] Loss: 1.38994 (QuantReg: 11.26667) QuantErr: 11.26667 batch_time=0.38751 
Train Epoch: 6 [116/1000 3712/32000 (12%)] Loss: 1.63815 (QuantReg: 11.35562) QuantErr: 11.35562 batch_time=0.45553 
Train Epoch: 6 [121/1000 3872/32000 (12%)] Loss: 0.97827 (QuantReg: 11.18580) QuantErr: 11.18580 batch_time=0.46238 
Train Epoch: 6 [126/1000 4032/32000 (13%)] Loss: 0.71421 (QuantReg: 10.47811) QuantErr: 10.47811 batch_time=0.42932 
Train Epoch: 6 [131/1000 4192/32000 (13%)] Loss: 0.97641 (QuantReg: 11.52392) QuantErr: 11.52392 batch_time=0.37393 
Train Epoch: 6 [136/1000 4352/32000 (14%)] Loss: 1.65468 (QuantReg: 11.39931) QuantErr: 11.39931 batch_time=0.43889 
Train Epoch: 6 [141/1000 4512/32000 (14%)] Loss: 0.67115 (QuantReg: 11.58322) QuantErr: 11.58322 batch_time=0.44223 
Train Epoch: 6 [146/1000 4672/32000 (15%)] Loss: 0.83076 (QuantReg: 11.37558) QuantErr: 11.37558 batch_time=0.46413 
Train Epoch: 6 [151/1000 4832/32000 (15%)] Loss: 0.88765 (QuantReg: 10.45686) QuantErr: 10.45686 batch_time=0.62075 
Train Epoch: 6 [156/1000 4992/32000 (16%)] Loss: 0.93302 (QuantReg: 11.71216) QuantErr: 11.71216 batch_time=0.36660 
Train Epoch: 6 [161/1000 5152/32000 (16%)] Loss: 1.22720 (QuantReg: 11.82988) QuantErr: 11.82988 batch_time=0.39366 
Train Epoch: 6 [166/1000 5312/32000 (17%)] Loss: 1.14382 (QuantReg: 11.30532) QuantErr: 11.30532 batch_time=0.41086 
Train Epoch: 6 [171/1000 5472/32000 (17%)] Loss: 0.53062 (QuantReg: 11.71674) QuantErr: 11.71674 batch_time=0.45380 
Train Epoch: 6 [176/1000 5632/32000 (18%)] Loss: 1.25201 (QuantReg: 11.32315) QuantErr: 11.32315 batch_time=0.36234 
Train Epoch: 6 [181/1000 5792/32000 (18%)] Loss: 0.99272 (QuantReg: 11.92388) QuantErr: 11.92388 batch_time=0.42637 
Train Epoch: 6 [186/1000 5952/32000 (19%)] Loss: 0.38030 (QuantReg: 11.67474) QuantErr: 11.67474 batch_time=0.49309 
Train Epoch: 6 [191/1000 6112/32000 (19%)] Loss: 1.19189 (QuantReg: 11.40348) QuantErr: 11.40348 batch_time=0.42333 
Train Epoch: 6 [196/1000 6272/32000 (20%)] Loss: 0.57276 (QuantReg: 11.19458) QuantErr: 11.19458 batch_time=0.41020 
Train Epoch: 6 [201/1000 6432/32000 (20%)] Loss: 1.77885 (QuantReg: 11.30908) QuantErr: 11.30908 batch_time=0.42517 
Train Epoch: 6 [206/1000 6592/32000 (21%)] Loss: 0.58262 (QuantReg: 11.30911) QuantErr: 11.30911 batch_time=0.36316 
Train Epoch: 6 [211/1000 6752/32000 (21%)] Loss: 0.91990 (QuantReg: 11.89879) QuantErr: 11.89879 batch_time=0.36544 
Train Epoch: 6 [216/1000 6912/32000 (22%)] Loss: 1.59548 (QuantReg: 11.20006) QuantErr: 11.20006 batch_time=0.43190 
Train Epoch: 6 [221/1000 7072/32000 (22%)] Loss: 1.25411 (QuantReg: 11.83890) QuantErr: 11.83890 batch_time=0.41584 
Train Epoch: 6 [226/1000 7232/32000 (23%)] Loss: 0.57348 (QuantReg: 11.26081) QuantErr: 11.26081 batch_time=0.37339 
Train Epoch: 6 [231/1000 7392/32000 (23%)] Loss: 1.05789 (QuantReg: 10.75893) QuantErr: 10.75893 batch_time=0.38540 
Train Epoch: 6 [236/1000 7552/32000 (24%)] Loss: 0.61906 (QuantReg: 12.19024) QuantErr: 12.19024 batch_time=0.46920 
Train Epoch: 6 [241/1000 7712/32000 (24%)] Loss: 1.31635 (QuantReg: 12.32113) QuantErr: 12.32113 batch_time=0.40957 
Train Epoch: 6 [246/1000 7872/32000 (25%)] Loss: 1.07983 (QuantReg: 11.92412) QuantErr: 11.92412 batch_time=0.42234 
Train Epoch: 6 [251/1000 8032/32000 (25%)] Loss: 0.67609 (QuantReg: 11.79044) QuantErr: 11.79044 batch_time=0.42890 
Train Epoch: 6 [256/1000 8192/32000 (26%)] Loss: 0.72372 (QuantReg: 11.45818) QuantErr: 11.45818 batch_time=0.35709 
Train Epoch: 6 [261/1000 8352/32000 (26%)] Loss: 1.32926 (QuantReg: 11.62414) QuantErr: 11.62414 batch_time=0.40120 
Train Epoch: 6 [266/1000 8512/32000 (27%)] Loss: 1.43154 (QuantReg: 11.65121) QuantErr: 11.65121 batch_time=0.42029 
Train Epoch: 6 [271/1000 8672/32000 (27%)] Loss: 0.70424 (QuantReg: 12.02006) QuantErr: 12.02006 batch_time=0.40422 
Train Epoch: 6 [276/1000 8832/32000 (28%)] Loss: 0.98314 (QuantReg: 11.42194) QuantErr: 11.42194 batch_time=0.35143 
Train Epoch: 6 [281/1000 8992/32000 (28%)] Loss: 1.43496 (QuantReg: 10.71020) QuantErr: 10.71020 batch_time=0.40899 
Train Epoch: 6 [286/1000 9152/32000 (29%)] Loss: 1.00686 (QuantReg: 11.26695) QuantErr: 11.26695 batch_time=0.41764 
Train Epoch: 6 [291/1000 9312/32000 (29%)] Loss: 0.76951 (QuantReg: 11.27518) QuantErr: 11.27518 batch_time=0.39015 
Train Epoch: 6 [296/1000 9472/32000 (30%)] Loss: 0.89607 (QuantReg: 11.49473) QuantErr: 11.49473 batch_time=0.38154 
Train Epoch: 6 [301/1000 9632/32000 (30%)] Loss: 0.68615 (QuantReg: 11.32840) QuantErr: 11.32840 batch_time=0.38563 
Train Epoch: 6 [306/1000 9792/32000 (31%)] Loss: 0.72415 (QuantReg: 11.47556) QuantErr: 11.47556 batch_time=0.37959 
Train Epoch: 6 [311/1000 9952/32000 (31%)] Loss: 1.25850 (QuantReg: 11.80622) QuantErr: 11.80622 batch_time=0.46270 
Train Epoch: 6 [316/1000 10112/32000 (32%)] Loss: 1.58730 (QuantReg: 11.61762) QuantErr: 11.61762 batch_time=0.36661 
Train Epoch: 6 [321/1000 10272/32000 (32%)] Loss: 1.37863 (QuantReg: 12.25747) QuantErr: 12.25747 batch_time=0.50872 
Train Epoch: 6 [326/1000 10432/32000 (33%)] Loss: 1.08790 (QuantReg: 11.47989) QuantErr: 11.47989 batch_time=0.44167 
Train Epoch: 6 [331/1000 10592/32000 (33%)] Loss: 1.06810 (QuantReg: 11.40993) QuantErr: 11.40993 batch_time=0.80988 
Train Epoch: 6 [336/1000 10752/32000 (34%)] Loss: 0.97859 (QuantReg: 11.79120) QuantErr: 11.79120 batch_time=0.74108 
Train Epoch: 6 [341/1000 10912/32000 (34%)] Loss: 0.76452 (QuantReg: 11.42329) QuantErr: 11.42329 batch_time=0.34641 
Train Epoch: 6 [346/1000 11072/32000 (35%)] Loss: 0.87993 (QuantReg: 12.24909) QuantErr: 12.24909 batch_time=0.36698 
Train Epoch: 6 [351/1000 11232/32000 (35%)] Loss: 1.58078 (QuantReg: 11.45195) QuantErr: 11.45195 batch_time=0.41563 
Train Epoch: 6 [356/1000 11392/32000 (36%)] Loss: 0.89284 (QuantReg: 12.15389) QuantErr: 12.15389 batch_time=0.45829 
Train Epoch: 6 [361/1000 11552/32000 (36%)] Loss: 0.46309 (QuantReg: 11.63957) QuantErr: 11.63957 batch_time=0.38565 
Train Epoch: 6 [366/1000 11712/32000 (37%)] Loss: 0.30870 (QuantReg: 11.79947) QuantErr: 11.79947 batch_time=0.39726 
Train Epoch: 6 [371/1000 11872/32000 (37%)] Loss: 1.33380 (QuantReg: 11.31628) QuantErr: 11.31628 batch_time=0.42455 
Train Epoch: 6 [376/1000 12032/32000 (38%)] Loss: 1.27811 (QuantReg: 11.34348) QuantErr: 11.34348 batch_time=0.44970 
Train Epoch: 6 [381/1000 12192/32000 (38%)] Loss: 0.34201 (QuantReg: 11.54328) QuantErr: 11.54328 batch_time=0.35658 
Train Epoch: 6 [386/1000 12352/32000 (39%)] Loss: 0.47708 (QuantReg: 12.11971) QuantErr: 12.11971 batch_time=0.39320 
Train Epoch: 6 [391/1000 12512/32000 (39%)] Loss: 1.69350 (QuantReg: 11.17069) QuantErr: 11.17069 batch_time=0.38099 
Train Epoch: 6 [396/1000 12672/32000 (40%)] Loss: 0.87430 (QuantReg: 11.76601) QuantErr: 11.76601 batch_time=0.36373 
Train Epoch: 6 [401/1000 12832/32000 (40%)] Loss: 1.01289 (QuantReg: 10.77510) QuantErr: 10.77510 batch_time=1.40024 
Train Epoch: 6 [406/1000 12992/32000 (41%)] Loss: 0.93182 (QuantReg: 11.29381) QuantErr: 11.29381 batch_time=0.38918 
Train Epoch: 6 [411/1000 13152/32000 (41%)] Loss: 1.60948 (QuantReg: 11.77290) QuantErr: 11.77290 batch_time=0.38558 
Train Epoch: 6 [416/1000 13312/32000 (42%)] Loss: 0.69672 (QuantReg: 12.05844) QuantErr: 12.05844 batch_time=0.45893 
Train Epoch: 6 [421/1000 13472/32000 (42%)] Loss: 0.91568 (QuantReg: 11.90331) QuantErr: 11.90331 batch_time=0.40538 
Train Epoch: 6 [426/1000 13632/32000 (43%)] Loss: 0.56992 (QuantReg: 11.28593) QuantErr: 11.28593 batch_time=0.36938 
Train Epoch: 6 [431/1000 13792/32000 (43%)] Loss: 0.82718 (QuantReg: 11.98575) QuantErr: 11.98575 batch_time=0.41103 
Train Epoch: 6 [436/1000 13952/32000 (44%)] Loss: 0.74277 (QuantReg: 12.04018) QuantErr: 12.04018 batch_time=0.52323 
Train Epoch: 6 [441/1000 14112/32000 (44%)] Loss: 1.08103 (QuantReg: 11.08036) QuantErr: 11.08036 batch_time=0.40761 
Train Epoch: 6 [446/1000 14272/32000 (45%)] Loss: 1.14524 (QuantReg: 10.97566) QuantErr: 10.97566 batch_time=0.43771 
Train Epoch: 6 [451/1000 14432/32000 (45%)] Loss: 0.82486 (QuantReg: 11.38172) QuantErr: 11.38172 batch_time=0.36663 
Train Epoch: 6 [456/1000 14592/32000 (46%)] Loss: 0.75398 (QuantReg: 11.56132) QuantErr: 11.56132 batch_time=0.38134 
Train Epoch: 6 [461/1000 14752/32000 (46%)] Loss: 1.63026 (QuantReg: 12.24614) QuantErr: 12.24614 batch_time=0.35092 
Train Epoch: 6 [466/1000 14912/32000 (47%)] Loss: 1.07606 (QuantReg: 11.90146) QuantErr: 11.90146 batch_time=0.53491 
Train Epoch: 6 [471/1000 15072/32000 (47%)] Loss: 0.65295 (QuantReg: 11.74521) QuantErr: 11.74521 batch_time=0.66547 
Train Epoch: 6 [476/1000 15232/32000 (48%)] Loss: 0.93257 (QuantReg: 11.92127) QuantErr: 11.92127 batch_time=0.36579 
Train Epoch: 6 [481/1000 15392/32000 (48%)] Loss: 2.39512 (QuantReg: 11.49804) QuantErr: 11.49804 batch_time=0.36225 
Train Epoch: 6 [486/1000 15552/32000 (49%)] Loss: 0.79010 (QuantReg: 11.21459) QuantErr: 11.21459 batch_time=0.36186 
Train Epoch: 6 [491/1000 15712/32000 (49%)] Loss: 1.14822 (QuantReg: 11.75983) QuantErr: 11.75983 batch_time=0.36467 
Train Epoch: 6 [496/1000 15872/32000 (50%)] Loss: 0.97642 (QuantReg: 10.94656) QuantErr: 10.94656 batch_time=0.38411 
Train Epoch: 6 [501/1000 16032/32000 (50%)] Loss: 0.77659 (QuantReg: 12.34149) QuantErr: 12.34149 batch_time=0.38989 
Train Epoch: 6 [506/1000 16192/32000 (51%)] Loss: 0.61158 (QuantReg: 10.69221) QuantErr: 10.69221 batch_time=0.42855 
Train Epoch: 6 [511/1000 16352/32000 (51%)] Loss: 1.67457 (QuantReg: 10.98437) QuantErr: 10.98437 batch_time=0.39361 
Train Epoch: 6 [516/1000 16512/32000 (52%)] Loss: 0.98276 (QuantReg: 11.81617) QuantErr: 11.81617 batch_time=0.41837 
Train Epoch: 6 [521/1000 16672/32000 (52%)] Loss: 0.56593 (QuantReg: 10.91499) QuantErr: 10.91499 batch_time=0.38473 
Train Epoch: 6 [526/1000 16832/32000 (53%)] Loss: 1.02912 (QuantReg: 11.11038) QuantErr: 11.11038 batch_time=0.43646 
Train Epoch: 6 [531/1000 16992/32000 (53%)] Loss: 0.55752 (QuantReg: 11.39940) QuantErr: 11.39940 batch_time=0.34459 
Train Epoch: 6 [536/1000 17152/32000 (54%)] Loss: 0.84788 (QuantReg: 11.00020) QuantErr: 11.00020 batch_time=0.46196 
Train Epoch: 6 [541/1000 17312/32000 (54%)] Loss: 0.72460 (QuantReg: 11.56428) QuantErr: 11.56428 batch_time=0.37218 
Train Epoch: 6 [546/1000 17472/32000 (55%)] Loss: 1.56784 (QuantReg: 11.53128) QuantErr: 11.53128 batch_time=0.35015 
Train Epoch: 6 [551/1000 17632/32000 (55%)] Loss: 0.83111 (QuantReg: 11.76109) QuantErr: 11.76109 batch_time=0.33710 
Train Epoch: 6 [556/1000 17792/32000 (56%)] Loss: 1.05588 (QuantReg: 11.35951) QuantErr: 11.35951 batch_time=0.35228 
Train Epoch: 6 [561/1000 17952/32000 (56%)] Loss: 0.45328 (QuantReg: 12.00730) QuantErr: 12.00730 batch_time=0.36152 
Train Epoch: 6 [566/1000 18112/32000 (57%)] Loss: 1.84308 (QuantReg: 11.43463) QuantErr: 11.43463 batch_time=0.34814 
Train Epoch: 6 [571/1000 18272/32000 (57%)] Loss: 0.72225 (QuantReg: 10.99570) QuantErr: 10.99570 batch_time=0.38198 
Train Epoch: 6 [576/1000 18432/32000 (58%)] Loss: 0.74319 (QuantReg: 11.04259) QuantErr: 11.04259 batch_time=0.38523 
Train Epoch: 6 [581/1000 18592/32000 (58%)] Loss: 1.02724 (QuantReg: 11.47763) QuantErr: 11.47763 batch_time=0.41337 
Train Epoch: 6 [586/1000 18752/32000 (59%)] Loss: 1.11233 (QuantReg: 11.16562) QuantErr: 11.16562 batch_time=0.44597 
Train Epoch: 6 [591/1000 18912/32000 (59%)] Loss: 1.42104 (QuantReg: 11.48584) QuantErr: 11.48584 batch_time=0.38061 
Train Epoch: 6 [596/1000 19072/32000 (60%)] Loss: 0.84150 (QuantReg: 11.91843) QuantErr: 11.91843 batch_time=0.36145 
Train Epoch: 6 [601/1000 19232/32000 (60%)] Loss: 1.38423 (QuantReg: 11.18389) QuantErr: 11.18389 batch_time=0.42716 
Train Epoch: 6 [606/1000 19392/32000 (61%)] Loss: 1.76329 (QuantReg: 10.98261) QuantErr: 10.98261 batch_time=0.43612 
Train Epoch: 6 [611/1000 19552/32000 (61%)] Loss: 1.63548 (QuantReg: 10.88929) QuantErr: 10.88929 batch_time=0.34210 
Train Epoch: 6 [616/1000 19712/32000 (62%)] Loss: 1.67758 (QuantReg: 11.71598) QuantErr: 11.71598 batch_time=0.37288 
Train Epoch: 6 [621/1000 19872/32000 (62%)] Loss: 0.88846 (QuantReg: 12.07787) QuantErr: 12.07787 batch_time=0.44156 
Train Epoch: 6 [626/1000 20032/32000 (63%)] Loss: 0.95368 (QuantReg: 11.84912) QuantErr: 11.84912 batch_time=0.41028 
Train Epoch: 6 [631/1000 20192/32000 (63%)] Loss: 1.61588 (QuantReg: 11.10063) QuantErr: 11.10063 batch_time=0.36074 
Train Epoch: 6 [636/1000 20352/32000 (64%)] Loss: 1.18254 (QuantReg: 12.00055) QuantErr: 12.00055 batch_time=0.37635 
Train Epoch: 6 [641/1000 20512/32000 (64%)] Loss: 1.63853 (QuantReg: 11.66236) QuantErr: 11.66236 batch_time=0.44716 
Train Epoch: 6 [646/1000 20672/32000 (65%)] Loss: 0.63418 (QuantReg: 11.49960) QuantErr: 11.49960 batch_time=0.38023 
Train Epoch: 6 [651/1000 20832/32000 (65%)] Loss: 0.69194 (QuantReg: 11.57224) QuantErr: 11.57224 batch_time=0.79155 
Train Epoch: 6 [656/1000 20992/32000 (66%)] Loss: 0.51875 (QuantReg: 11.36663) QuantErr: 11.36663 batch_time=0.75250 
Train Epoch: 6 [661/1000 21152/32000 (66%)] Loss: 0.78853 (QuantReg: 11.87631) QuantErr: 11.87631 batch_time=0.36348 
Train Epoch: 6 [666/1000 21312/32000 (67%)] Loss: 1.49599 (QuantReg: 11.61712) QuantErr: 11.61712 batch_time=0.40409 
Train Epoch: 6 [671/1000 21472/32000 (67%)] Loss: 0.79169 (QuantReg: 10.90407) QuantErr: 10.90407 batch_time=0.38881 
Train Epoch: 6 [676/1000 21632/32000 (68%)] Loss: 0.61801 (QuantReg: 11.85368) QuantErr: 11.85368 batch_time=0.36851 
Train Epoch: 6 [681/1000 21792/32000 (68%)] Loss: 0.53051 (QuantReg: 11.36771) QuantErr: 11.36771 batch_time=0.41870 
Train Epoch: 6 [686/1000 21952/32000 (69%)] Loss: 0.99496 (QuantReg: 11.32523) QuantErr: 11.32523 batch_time=0.42273 
Train Epoch: 6 [691/1000 22112/32000 (69%)] Loss: 1.04194 (QuantReg: 11.50134) QuantErr: 11.50134 batch_time=0.45574 
Train Epoch: 6 [696/1000 22272/32000 (70%)] Loss: 0.50142 (QuantReg: 11.84825) QuantErr: 11.84825 batch_time=0.39243 
Train Epoch: 6 [701/1000 22432/32000 (70%)] Loss: 1.00958 (QuantReg: 11.88321) QuantErr: 11.88321 batch_time=0.40487 
Train Epoch: 6 [706/1000 22592/32000 (71%)] Loss: 1.30048 (QuantReg: 11.80724) QuantErr: 11.80724 batch_time=0.38777 
Train Epoch: 6 [711/1000 22752/32000 (71%)] Loss: 1.27671 (QuantReg: 11.01080) QuantErr: 11.01080 batch_time=0.39719 
Train Epoch: 6 [716/1000 22912/32000 (72%)] Loss: 0.62943 (QuantReg: 11.42628) QuantErr: 11.42628 batch_time=0.35026 
Train Epoch: 6 [721/1000 23072/32000 (72%)] Loss: 0.62545 (QuantReg: 11.61666) QuantErr: 11.61666 batch_time=1.35129 
Train Epoch: 6 [726/1000 23232/32000 (73%)] Loss: 1.34908 (QuantReg: 11.78820) QuantErr: 11.78820 batch_time=0.38052 
Train Epoch: 6 [731/1000 23392/32000 (73%)] Loss: 0.82870 (QuantReg: 11.76597) QuantErr: 11.76597 batch_time=0.36506 
Train Epoch: 6 [736/1000 23552/32000 (74%)] Loss: 0.56577 (QuantReg: 11.66751) QuantErr: 11.66751 batch_time=0.36954 
Train Epoch: 6 [741/1000 23712/32000 (74%)] Loss: 1.40865 (QuantReg: 11.76886) QuantErr: 11.76886 batch_time=0.41932 
Train Epoch: 6 [746/1000 23872/32000 (75%)] Loss: 1.48082 (QuantReg: 11.19146) QuantErr: 11.19146 batch_time=0.36743 
Train Epoch: 6 [751/1000 24032/32000 (75%)] Loss: 0.50893 (QuantReg: 11.62097) QuantErr: 11.62097 batch_time=0.38115 
Train Epoch: 6 [756/1000 24192/32000 (76%)] Loss: 0.68719 (QuantReg: 11.12998) QuantErr: 11.12998 batch_time=0.40970 
Train Epoch: 6 [761/1000 24352/32000 (76%)] Loss: 1.28265 (QuantReg: 11.60680) QuantErr: 11.60680 batch_time=0.34661 
Train Epoch: 6 [766/1000 24512/32000 (77%)] Loss: 1.16469 (QuantReg: 11.60296) QuantErr: 11.60296 batch_time=0.40634 
Train Epoch: 6 [771/1000 24672/32000 (77%)] Loss: 0.72024 (QuantReg: 11.53473) QuantErr: 11.53473 batch_time=0.36182 
Train Epoch: 6 [776/1000 24832/32000 (78%)] Loss: 0.90855 (QuantReg: 12.31896) QuantErr: 12.31896 batch_time=0.35563 
Train Epoch: 6 [781/1000 24992/32000 (78%)] Loss: 0.85709 (QuantReg: 11.74162) QuantErr: 11.74162 batch_time=0.38413 
Train Epoch: 6 [786/1000 25152/32000 (79%)] Loss: 1.20458 (QuantReg: 12.20741) QuantErr: 12.20741 batch_time=0.52262 
Train Epoch: 6 [791/1000 25312/32000 (79%)] Loss: 0.84693 (QuantReg: 11.96248) QuantErr: 11.96248 batch_time=0.54460 
Train Epoch: 6 [796/1000 25472/32000 (80%)] Loss: 0.56547 (QuantReg: 12.30904) QuantErr: 12.30904 batch_time=0.42211 
Train Epoch: 6 [801/1000 25632/32000 (80%)] Loss: 0.93975 (QuantReg: 12.34849) QuantErr: 12.34849 batch_time=0.38298 
Train Epoch: 6 [806/1000 25792/32000 (81%)] Loss: 0.80352 (QuantReg: 11.33290) QuantErr: 11.33290 batch_time=0.41917 
Train Epoch: 6 [811/1000 25952/32000 (81%)] Loss: 1.44509 (QuantReg: 11.64088) QuantErr: 11.64088 batch_time=0.39079 
Train Epoch: 6 [816/1000 26112/32000 (82%)] Loss: 1.50088 (QuantReg: 11.22454) QuantErr: 11.22454 batch_time=0.40500 
Train Epoch: 6 [821/1000 26272/32000 (82%)] Loss: 1.50878 (QuantReg: 11.00719) QuantErr: 11.00719 batch_time=0.41435 
Train Epoch: 6 [826/1000 26432/32000 (83%)] Loss: 1.12200 (QuantReg: 11.96126) QuantErr: 11.96126 batch_time=0.41795 
Train Epoch: 6 [831/1000 26592/32000 (83%)] Loss: 0.92591 (QuantReg: 11.98401) QuantErr: 11.98401 batch_time=0.48119 
Train Epoch: 6 [836/1000 26752/32000 (84%)] Loss: 0.83376 (QuantReg: 11.38241) QuantErr: 11.38241 batch_time=0.38463 
Train Epoch: 6 [841/1000 26912/32000 (84%)] Loss: 0.46361 (QuantReg: 11.70108) QuantErr: 11.70108 batch_time=0.37650 
Train Epoch: 6 [846/1000 27072/32000 (85%)] Loss: 1.11921 (QuantReg: 11.57745) QuantErr: 11.57745 batch_time=0.37032 
Train Epoch: 6 [851/1000 27232/32000 (85%)] Loss: 0.50221 (QuantReg: 11.47539) QuantErr: 11.47539 batch_time=0.46371 
Train Epoch: 6 [856/1000 27392/32000 (86%)] Loss: 1.44627 (QuantReg: 11.64099) QuantErr: 11.64099 batch_time=0.35271 
Train Epoch: 6 [861/1000 27552/32000 (86%)] Loss: 0.80127 (QuantReg: 11.79615) QuantErr: 11.79615 batch_time=0.46804 
Train Epoch: 6 [866/1000 27712/32000 (87%)] Loss: 0.27498 (QuantReg: 12.21935) QuantErr: 12.21935 batch_time=0.37511 
Train Epoch: 6 [871/1000 27872/32000 (87%)] Loss: 0.63297 (QuantReg: 12.18322) QuantErr: 12.18322 batch_time=0.40318 
Train Epoch: 6 [876/1000 28032/32000 (88%)] Loss: 0.92525 (QuantReg: 12.11074) QuantErr: 12.11074 batch_time=0.40283 
Train Epoch: 6 [881/1000 28192/32000 (88%)] Loss: 1.08737 (QuantReg: 11.66865) QuantErr: 11.66865 batch_time=0.39673 
Train Epoch: 6 [886/1000 28352/32000 (89%)] Loss: 2.25628 (QuantReg: 11.86768) QuantErr: 11.86768 batch_time=0.38472 
Train Epoch: 6 [891/1000 28512/32000 (89%)] Loss: 1.10292 (QuantReg: 11.65263) QuantErr: 11.65263 batch_time=0.43136 
Train Epoch: 6 [896/1000 28672/32000 (90%)] Loss: 0.83287 (QuantReg: 12.70659) QuantErr: 12.70659 batch_time=0.40442 
Train Epoch: 6 [901/1000 28832/32000 (90%)] Loss: 1.05734 (QuantReg: 11.70320) QuantErr: 11.70320 batch_time=0.42873 
Train Epoch: 6 [906/1000 28992/32000 (91%)] Loss: 1.16396 (QuantReg: 12.00806) QuantErr: 12.00806 batch_time=0.44046 
Train Epoch: 6 [911/1000 29152/32000 (91%)] Loss: 0.77509 (QuantReg: 11.79137) QuantErr: 11.79137 batch_time=0.35802 
Train Epoch: 6 [916/1000 29312/32000 (92%)] Loss: 1.06659 (QuantReg: 11.55016) QuantErr: 11.55016 batch_time=0.35033 
Train Epoch: 6 [921/1000 29472/32000 (92%)] Loss: 0.99344 (QuantReg: 11.94118) QuantErr: 11.94118 batch_time=0.35870 
Train Epoch: 6 [926/1000 29632/32000 (93%)] Loss: 0.61170 (QuantReg: 12.49895) QuantErr: 12.49895 batch_time=0.42312 
Train Epoch: 6 [931/1000 29792/32000 (93%)] Loss: 1.25052 (QuantReg: 11.25714) QuantErr: 11.25714 batch_time=0.39316 
Train Epoch: 6 [936/1000 29952/32000 (94%)] Loss: 0.92852 (QuantReg: 12.02989) QuantErr: 12.02989 batch_time=0.44256 
Train Epoch: 6 [941/1000 30112/32000 (94%)] Loss: 0.66234 (QuantReg: 12.52188) QuantErr: 12.52188 batch_time=0.38388 
Train Epoch: 6 [946/1000 30272/32000 (95%)] Loss: 0.95953 (QuantReg: 11.55676) QuantErr: 11.55676 batch_time=0.37274 
Train Epoch: 6 [951/1000 30432/32000 (95%)] Loss: 0.47181 (QuantReg: 12.11960) QuantErr: 12.11960 batch_time=0.43265 
Train Epoch: 6 [956/1000 30592/32000 (96%)] Loss: 0.88989 (QuantReg: 12.52958) QuantErr: 12.52958 batch_time=0.40549 
Train Epoch: 6 [961/1000 30752/32000 (96%)] Loss: 1.40153 (QuantReg: 12.04587) QuantErr: 12.04587 batch_time=0.47966 
Train Epoch: 6 [966/1000 30912/32000 (97%)] Loss: 0.74299 (QuantReg: 11.87579) QuantErr: 11.87579 batch_time=0.39196 
Train Epoch: 6 [971/1000 31072/32000 (97%)] Loss: 1.08028 (QuantReg: 12.49851) QuantErr: 12.49851 batch_time=0.84604 
Train Epoch: 6 [976/1000 31232/32000 (98%)] Loss: 0.78766 (QuantReg: 12.07971) QuantErr: 12.07971 batch_time=0.72457 
Train Epoch: 6 [981/1000 31392/32000 (98%)] Loss: 1.07946 (QuantReg: 11.73152) QuantErr: 11.73152 batch_time=0.38928 
Train Epoch: 6 [986/1000 31552/32000 (99%)] Loss: 1.08851 (QuantReg: 12.67913) QuantErr: 12.67913 batch_time=0.38130 
Train Epoch: 6 [991/1000 31712/32000 (99%)] Loss: 0.84335 (QuantReg: 11.92214) QuantErr: 11.92214 batch_time=0.34602 
Train Epoch: 6 [996/1000 31872/32000 (100%)] Loss: 1.28812 (QuantReg: 12.16256) QuantErr: 12.16256 batch_time=0.41995 
Train Epoch: 6 codebook_update_time=1.96332
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch6.pth ...
Done in 23.462s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch6.pth ...
Done in 28.041s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 1.0282916963398456
 quant_reg      : 11.563174331665039
 quant_err      : 11.563174331665039
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 27.16297786720322
 MSRVTT_full_val/t2v_metrics/R5: 60.160965794768615
 MSRVTT_full_val/t2v_metrics/R10: 76.65995975855131
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.557344064386317
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.03649982165258
 MSRVTT_full_val/v2t_metrics/R1: 28.37022132796781
 MSRVTT_full_val/v2t_metrics/R5: 68.61167002012073
 MSRVTT_full_val/v2t_metrics/R10: 80.88531187122736
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.016096579476862
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.99789037393051
 MSRVTT_full_test/t2v_metrics/R1: 10.033444816053512
 MSRVTT_full_test/t2v_metrics/R5: 29.565217391304348
 MSRVTT_full_test/t2v_metrics/R10: 41.60535117056856
 MSRVTT_full_test/t2v_metrics/R50: 76.2876254180602
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.26622073578595
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.109654096300698
 MSRVTT_full_test/v2t_metrics/R1: 10.903010033444817
 MSRVTT_full_test/v2t_metrics/R5: 33.41137123745819
 MSRVTT_full_test/v2t_metrics/R10: 47.290969899665555
 MSRVTT_full_test/v2t_metrics/R50: 81.80602006688963
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.89147157190636
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.826941426583325
 mnt_best       : 23.109654096300698
 not_improved_count: 0
Train Epoch: 7 [1/1000 32/32000 (0%)] Loss: 0.80863 (QuantReg: 10.79837) QuantErr: 10.79837 batch_time=27.19117 
Train Epoch: 7 [6/1000 192/32000 (1%)] Loss: 0.82413 (QuantReg: 11.96562) QuantErr: 11.96562 batch_time=0.38000 
Train Epoch: 7 [11/1000 352/32000 (1%)] Loss: 1.22397 (QuantReg: 11.47251) QuantErr: 11.47251 batch_time=0.38908 
Train Epoch: 7 [16/1000 512/32000 (2%)] Loss: 0.61512 (QuantReg: 11.74973) QuantErr: 11.74973 batch_time=1.50794 
Train Epoch: 7 [21/1000 672/32000 (2%)] Loss: 0.78579 (QuantReg: 11.81755) QuantErr: 11.81755 batch_time=0.37099 
Train Epoch: 7 [26/1000 832/32000 (3%)] Loss: 1.03056 (QuantReg: 10.62885) QuantErr: 10.62885 batch_time=0.35766 
Train Epoch: 7 [31/1000 992/32000 (3%)] Loss: 1.08722 (QuantReg: 10.79070) QuantErr: 10.79070 batch_time=0.38787 
Train Epoch: 7 [36/1000 1152/32000 (4%)] Loss: 1.08115 (QuantReg: 11.89234) QuantErr: 11.89234 batch_time=0.37445 
Train Epoch: 7 [41/1000 1312/32000 (4%)] Loss: 0.64045 (QuantReg: 11.05647) QuantErr: 11.05647 batch_time=0.35068 
Train Epoch: 7 [46/1000 1472/32000 (5%)] Loss: 0.50205 (QuantReg: 11.66289) QuantErr: 11.66289 batch_time=0.42379 
Train Epoch: 7 [51/1000 1632/32000 (5%)] Loss: 0.55745 (QuantReg: 11.27875) QuantErr: 11.27875 batch_time=0.34527 
Train Epoch: 7 [56/1000 1792/32000 (6%)] Loss: 0.76236 (QuantReg: 11.46164) QuantErr: 11.46164 batch_time=0.34730 
Train Epoch: 7 [61/1000 1952/32000 (6%)] Loss: 0.99280 (QuantReg: 11.56158) QuantErr: 11.56158 batch_time=0.36564 
Train Epoch: 7 [66/1000 2112/32000 (7%)] Loss: 1.10816 (QuantReg: 11.46847) QuantErr: 11.46847 batch_time=0.38972 
Train Epoch: 7 [71/1000 2272/32000 (7%)] Loss: 0.63219 (QuantReg: 10.99174) QuantErr: 10.99174 batch_time=0.36144 
Train Epoch: 7 [76/1000 2432/32000 (8%)] Loss: 0.74294 (QuantReg: 11.98500) QuantErr: 11.98500 batch_time=0.38180 
Train Epoch: 7 [81/1000 2592/32000 (8%)] Loss: 0.97395 (QuantReg: 11.90496) QuantErr: 11.90496 batch_time=0.42669 
Train Epoch: 7 [86/1000 2752/32000 (9%)] Loss: 0.68843 (QuantReg: 11.53032) QuantErr: 11.53032 batch_time=0.44675 
Train Epoch: 7 [91/1000 2912/32000 (9%)] Loss: 1.71543 (QuantReg: 11.13372) QuantErr: 11.13372 batch_time=0.39810 
Train Epoch: 7 [96/1000 3072/32000 (10%)] Loss: 0.75099 (QuantReg: 11.84826) QuantErr: 11.84826 batch_time=0.35938 
Train Epoch: 7 [101/1000 3232/32000 (10%)] Loss: 0.84770 (QuantReg: 10.55463) QuantErr: 10.55463 batch_time=0.37095 
Train Epoch: 7 [106/1000 3392/32000 (11%)] Loss: 0.97479 (QuantReg: 11.17991) QuantErr: 11.17991 batch_time=0.36040 
Train Epoch: 7 [111/1000 3552/32000 (11%)] Loss: 0.92248 (QuantReg: 11.90644) QuantErr: 11.90644 batch_time=0.34543 
Train Epoch: 7 [116/1000 3712/32000 (12%)] Loss: 1.30248 (QuantReg: 11.32491) QuantErr: 11.32491 batch_time=0.38579 
Train Epoch: 7 [121/1000 3872/32000 (12%)] Loss: 1.21883 (QuantReg: 11.36073) QuantErr: 11.36073 batch_time=0.37553 
Train Epoch: 7 [126/1000 4032/32000 (13%)] Loss: 0.74523 (QuantReg: 11.60450) QuantErr: 11.60450 batch_time=0.35192 
Train Epoch: 7 [131/1000 4192/32000 (13%)] Loss: 1.06547 (QuantReg: 11.61205) QuantErr: 11.61205 batch_time=0.39871 
Train Epoch: 7 [136/1000 4352/32000 (14%)] Loss: 0.42594 (QuantReg: 11.41986) QuantErr: 11.41986 batch_time=0.40034 
Train Epoch: 7 [141/1000 4512/32000 (14%)] Loss: 1.75437 (QuantReg: 11.97904) QuantErr: 11.97904 batch_time=0.37004 
Train Epoch: 7 [146/1000 4672/32000 (15%)] Loss: 1.25180 (QuantReg: 12.30103) QuantErr: 12.30103 batch_time=1.05940 
Train Epoch: 7 [151/1000 4832/32000 (15%)] Loss: 0.42092 (QuantReg: 11.88943) QuantErr: 11.88943 batch_time=0.34702 
Train Epoch: 7 [156/1000 4992/32000 (16%)] Loss: 0.77031 (QuantReg: 11.85189) QuantErr: 11.85189 batch_time=0.46029 
Train Epoch: 7 [161/1000 5152/32000 (16%)] Loss: 0.94619 (QuantReg: 11.19179) QuantErr: 11.19179 batch_time=0.36817 
Train Epoch: 7 [166/1000 5312/32000 (17%)] Loss: 0.89966 (QuantReg: 11.94058) QuantErr: 11.94058 batch_time=0.34471 
Train Epoch: 7 [171/1000 5472/32000 (17%)] Loss: 0.23263 (QuantReg: 11.94445) QuantErr: 11.94445 batch_time=0.37000 
Train Epoch: 7 [176/1000 5632/32000 (18%)] Loss: 1.77174 (QuantReg: 11.44761) QuantErr: 11.44761 batch_time=0.33891 
Train Epoch: 7 [181/1000 5792/32000 (18%)] Loss: 0.58719 (QuantReg: 11.34509) QuantErr: 11.34509 batch_time=0.41294 
Train Epoch: 7 [186/1000 5952/32000 (19%)] Loss: 0.57991 (QuantReg: 11.73673) QuantErr: 11.73673 batch_time=0.43647 
Train Epoch: 7 [191/1000 6112/32000 (19%)] Loss: 0.55529 (QuantReg: 11.49426) QuantErr: 11.49426 batch_time=0.34724 
Train Epoch: 7 [196/1000 6272/32000 (20%)] Loss: 1.30417 (QuantReg: 10.86924) QuantErr: 10.86924 batch_time=0.38231 
Train Epoch: 7 [201/1000 6432/32000 (20%)] Loss: 0.98120 (QuantReg: 11.50375) QuantErr: 11.50375 batch_time=0.39670 
Train Epoch: 7 [206/1000 6592/32000 (21%)] Loss: 1.40247 (QuantReg: 11.38432) QuantErr: 11.38432 batch_time=0.42189 
Train Epoch: 7 [211/1000 6752/32000 (21%)] Loss: 1.56539 (QuantReg: 11.41776) QuantErr: 11.41776 batch_time=0.41500 
Train Epoch: 7 [216/1000 6912/32000 (22%)] Loss: 1.11401 (QuantReg: 11.57179) QuantErr: 11.57179 batch_time=0.58757 
Train Epoch: 7 [221/1000 7072/32000 (22%)] Loss: 1.22501 (QuantReg: 10.90907) QuantErr: 10.90907 batch_time=0.41414 
Train Epoch: 7 [226/1000 7232/32000 (23%)] Loss: 1.67357 (QuantReg: 11.11258) QuantErr: 11.11258 batch_time=0.35402 
Train Epoch: 7 [231/1000 7392/32000 (23%)] Loss: 1.04757 (QuantReg: 11.82572) QuantErr: 11.82572 batch_time=0.40117 
Train Epoch: 7 [236/1000 7552/32000 (24%)] Loss: 0.47547 (QuantReg: 12.05276) QuantErr: 12.05276 batch_time=0.37854 
Train Epoch: 7 [241/1000 7712/32000 (24%)] Loss: 0.68696 (QuantReg: 11.62610) QuantErr: 11.62610 batch_time=0.35841 
Train Epoch: 7 [246/1000 7872/32000 (25%)] Loss: 0.88033 (QuantReg: 11.49519) QuantErr: 11.49519 batch_time=0.40554 
Train Epoch: 7 [251/1000 8032/32000 (25%)] Loss: 0.89173 (QuantReg: 12.12033) QuantErr: 12.12033 batch_time=0.36333 
Train Epoch: 7 [256/1000 8192/32000 (26%)] Loss: 0.83483 (QuantReg: 11.94216) QuantErr: 11.94216 batch_time=0.39443 
Train Epoch: 7 [261/1000 8352/32000 (26%)] Loss: 0.78553 (QuantReg: 11.56161) QuantErr: 11.56161 batch_time=0.37669 
Train Epoch: 7 [266/1000 8512/32000 (27%)] Loss: 0.94106 (QuantReg: 12.06792) QuantErr: 12.06792 batch_time=0.35686 
Train Epoch: 7 [271/1000 8672/32000 (27%)] Loss: 0.78034 (QuantReg: 11.73855) QuantErr: 11.73855 batch_time=0.40315 
Train Epoch: 7 [276/1000 8832/32000 (28%)] Loss: 1.15172 (QuantReg: 11.59237) QuantErr: 11.59237 batch_time=0.43542 
Train Epoch: 7 [281/1000 8992/32000 (28%)] Loss: 0.90791 (QuantReg: 11.05699) QuantErr: 11.05699 batch_time=0.35577 
Train Epoch: 7 [286/1000 9152/32000 (29%)] Loss: 1.29639 (QuantReg: 11.28896) QuantErr: 11.28896 batch_time=0.43825 
Train Epoch: 7 [291/1000 9312/32000 (29%)] Loss: 0.92475 (QuantReg: 11.74787) QuantErr: 11.74787 batch_time=0.37538 
Train Epoch: 7 [296/1000 9472/32000 (30%)] Loss: 1.14445 (QuantReg: 11.28255) QuantErr: 11.28255 batch_time=0.35274 
Train Epoch: 7 [301/1000 9632/32000 (30%)] Loss: 1.38388 (QuantReg: 12.19829) QuantErr: 12.19829 batch_time=0.34870 
Train Epoch: 7 [306/1000 9792/32000 (31%)] Loss: 0.51233 (QuantReg: 11.51021) QuantErr: 11.51021 batch_time=0.34944 
Train Epoch: 7 [311/1000 9952/32000 (31%)] Loss: 1.25513 (QuantReg: 11.95649) QuantErr: 11.95649 batch_time=0.37629 
Train Epoch: 7 [316/1000 10112/32000 (32%)] Loss: 0.83754 (QuantReg: 10.84878) QuantErr: 10.84878 batch_time=0.36896 
Train Epoch: 7 [321/1000 10272/32000 (32%)] Loss: 0.97610 (QuantReg: 10.91078) QuantErr: 10.91078 batch_time=0.64484 
Train Epoch: 7 [326/1000 10432/32000 (33%)] Loss: 0.99321 (QuantReg: 10.83957) QuantErr: 10.83957 batch_time=0.40851 
Train Epoch: 7 [331/1000 10592/32000 (33%)] Loss: 1.10246 (QuantReg: 12.43044) QuantErr: 12.43044 batch_time=0.41717 
Train Epoch: 7 [336/1000 10752/32000 (34%)] Loss: 0.61785 (QuantReg: 11.73085) QuantErr: 11.73085 batch_time=1.29305 
Train Epoch: 7 [341/1000 10912/32000 (34%)] Loss: 0.62660 (QuantReg: 11.42475) QuantErr: 11.42475 batch_time=0.39574 
Train Epoch: 7 [346/1000 11072/32000 (35%)] Loss: 1.16155 (QuantReg: 11.62550) QuantErr: 11.62550 batch_time=0.34819 
Train Epoch: 7 [351/1000 11232/32000 (35%)] Loss: 0.61756 (QuantReg: 11.00417) QuantErr: 11.00417 batch_time=0.35852 
Train Epoch: 7 [356/1000 11392/32000 (36%)] Loss: 1.00154 (QuantReg: 11.38153) QuantErr: 11.38153 batch_time=0.35706 
Train Epoch: 7 [361/1000 11552/32000 (36%)] Loss: 1.94318 (QuantReg: 11.46255) QuantErr: 11.46255 batch_time=0.34367 
Train Epoch: 7 [366/1000 11712/32000 (37%)] Loss: 1.43868 (QuantReg: 10.68532) QuantErr: 10.68532 batch_time=0.42411 
Train Epoch: 7 [371/1000 11872/32000 (37%)] Loss: 0.72942 (QuantReg: 11.94265) QuantErr: 11.94265 batch_time=0.36374 
Train Epoch: 7 [376/1000 12032/32000 (38%)] Loss: 1.33706 (QuantReg: 11.54577) QuantErr: 11.54577 batch_time=0.44681 
Train Epoch: 7 [381/1000 12192/32000 (38%)] Loss: 0.82565 (QuantReg: 12.04822) QuantErr: 12.04822 batch_time=0.40425 
Train Epoch: 7 [386/1000 12352/32000 (39%)] Loss: 0.37137 (QuantReg: 11.58523) QuantErr: 11.58523 batch_time=0.41587 
Train Epoch: 7 [391/1000 12512/32000 (39%)] Loss: 1.32165 (QuantReg: 10.89146) QuantErr: 10.89146 batch_time=0.35257 
Train Epoch: 7 [396/1000 12672/32000 (40%)] Loss: 0.52394 (QuantReg: 11.56201) QuantErr: 11.56201 batch_time=0.38121 
Train Epoch: 7 [401/1000 12832/32000 (40%)] Loss: 0.78519 (QuantReg: 11.92791) QuantErr: 11.92791 batch_time=0.35827 
Train Epoch: 7 [406/1000 12992/32000 (41%)] Loss: 1.20311 (QuantReg: 11.81266) QuantErr: 11.81266 batch_time=0.35821 
Train Epoch: 7 [411/1000 13152/32000 (41%)] Loss: 0.66049 (QuantReg: 11.55651) QuantErr: 11.55651 batch_time=0.34476 
Train Epoch: 7 [416/1000 13312/32000 (42%)] Loss: 1.56897 (QuantReg: 11.26740) QuantErr: 11.26740 batch_time=0.35854 
Train Epoch: 7 [421/1000 13472/32000 (42%)] Loss: 1.13150 (QuantReg: 11.63052) QuantErr: 11.63052 batch_time=0.38764 
Train Epoch: 7 [426/1000 13632/32000 (43%)] Loss: 0.80901 (QuantReg: 11.70740) QuantErr: 11.70740 batch_time=0.35777 
Train Epoch: 7 [431/1000 13792/32000 (43%)] Loss: 0.84718 (QuantReg: 12.03035) QuantErr: 12.03035 batch_time=0.37083 
Train Epoch: 7 [436/1000 13952/32000 (44%)] Loss: 0.60326 (QuantReg: 11.90181) QuantErr: 11.90181 batch_time=0.35032 
Train Epoch: 7 [441/1000 14112/32000 (44%)] Loss: 1.02433 (QuantReg: 11.34835) QuantErr: 11.34835 batch_time=0.34719 
Train Epoch: 7 [446/1000 14272/32000 (45%)] Loss: 0.73608 (QuantReg: 11.79329) QuantErr: 11.79329 batch_time=0.35919 
Train Epoch: 7 [451/1000 14432/32000 (45%)] Loss: 0.60848 (QuantReg: 11.77193) QuantErr: 11.77193 batch_time=0.34495 
Train Epoch: 7 [456/1000 14592/32000 (46%)] Loss: 0.74516 (QuantReg: 11.04300) QuantErr: 11.04300 batch_time=0.38047 
Train Epoch: 7 [461/1000 14752/32000 (46%)] Loss: 0.83175 (QuantReg: 11.47705) QuantErr: 11.47705 batch_time=0.35157 
Train Epoch: 7 [466/1000 14912/32000 (47%)] Loss: 1.35299 (QuantReg: 11.19656) QuantErr: 11.19656 batch_time=1.10440 
Train Epoch: 7 [471/1000 15072/32000 (47%)] Loss: 0.87274 (QuantReg: 11.84994) QuantErr: 11.84994 batch_time=0.42805 
Train Epoch: 7 [476/1000 15232/32000 (48%)] Loss: 0.72786 (QuantReg: 11.72596) QuantErr: 11.72596 batch_time=0.37551 
Train Epoch: 7 [481/1000 15392/32000 (48%)] Loss: 1.08627 (QuantReg: 12.17682) QuantErr: 12.17682 batch_time=0.34376 
Train Epoch: 7 [486/1000 15552/32000 (49%)] Loss: 1.07641 (QuantReg: 12.44765) QuantErr: 12.44765 batch_time=0.38681 
Train Epoch: 7 [491/1000 15712/32000 (49%)] Loss: 0.62952 (QuantReg: 11.58183) QuantErr: 11.58183 batch_time=0.36333 
Train Epoch: 7 [496/1000 15872/32000 (50%)] Loss: 1.43259 (QuantReg: 10.79575) QuantErr: 10.79575 batch_time=0.35554 
Train Epoch: 7 [501/1000 16032/32000 (50%)] Loss: 0.66095 (QuantReg: 11.58034) QuantErr: 11.58034 batch_time=0.35633 
Train Epoch: 7 [506/1000 16192/32000 (51%)] Loss: 0.78457 (QuantReg: 11.63331) QuantErr: 11.63331 batch_time=0.35947 
Train Epoch: 7 [511/1000 16352/32000 (51%)] Loss: 1.24059 (QuantReg: 12.10450) QuantErr: 12.10450 batch_time=1.47050 
Train Epoch: 7 [516/1000 16512/32000 (52%)] Loss: 0.47500 (QuantReg: 12.09019) QuantErr: 12.09019 batch_time=0.37471 
Train Epoch: 7 [521/1000 16672/32000 (52%)] Loss: 0.55946 (QuantReg: 12.07536) QuantErr: 12.07536 batch_time=0.38326 
Train Epoch: 7 [526/1000 16832/32000 (53%)] Loss: 0.23053 (QuantReg: 12.58096) QuantErr: 12.58096 batch_time=0.43616 
Train Epoch: 7 [531/1000 16992/32000 (53%)] Loss: 0.84702 (QuantReg: 11.54239) QuantErr: 11.54239 batch_time=0.47892 
Train Epoch: 7 [536/1000 17152/32000 (54%)] Loss: 0.30505 (QuantReg: 11.57754) QuantErr: 11.57754 batch_time=0.56264 
Train Epoch: 7 [541/1000 17312/32000 (54%)] Loss: 1.19651 (QuantReg: 12.53343) QuantErr: 12.53343 batch_time=0.42556 
Train Epoch: 7 [546/1000 17472/32000 (55%)] Loss: 0.82850 (QuantReg: 11.23779) QuantErr: 11.23779 batch_time=0.38118 
Train Epoch: 7 [551/1000 17632/32000 (55%)] Loss: 1.16192 (QuantReg: 11.26097) QuantErr: 11.26097 batch_time=0.42346 
Train Epoch: 7 [556/1000 17792/32000 (56%)] Loss: 0.74115 (QuantReg: 11.09295) QuantErr: 11.09295 batch_time=0.33897 
Train Epoch: 7 [561/1000 17952/32000 (56%)] Loss: 1.13606 (QuantReg: 11.79456) QuantErr: 11.79456 batch_time=0.34758 
Train Epoch: 7 [566/1000 18112/32000 (57%)] Loss: 0.90498 (QuantReg: 11.12707) QuantErr: 11.12707 batch_time=0.36723 
Train Epoch: 7 [571/1000 18272/32000 (57%)] Loss: 0.71606 (QuantReg: 11.16594) QuantErr: 11.16594 batch_time=0.41509 
Train Epoch: 7 [576/1000 18432/32000 (58%)] Loss: 0.61201 (QuantReg: 11.56904) QuantErr: 11.56904 batch_time=0.37473 
Train Epoch: 7 [581/1000 18592/32000 (58%)] Loss: 0.70107 (QuantReg: 11.76040) QuantErr: 11.76040 batch_time=0.35150 
Train Epoch: 7 [586/1000 18752/32000 (59%)] Loss: 0.95094 (QuantReg: 11.43044) QuantErr: 11.43044 batch_time=0.34638 
Train Epoch: 7 [591/1000 18912/32000 (59%)] Loss: 0.54769 (QuantReg: 11.74690) QuantErr: 11.74690 batch_time=0.34787 
Train Epoch: 7 [596/1000 19072/32000 (60%)] Loss: 0.82305 (QuantReg: 11.70351) QuantErr: 11.70351 batch_time=0.35261 
Train Epoch: 7 [601/1000 19232/32000 (60%)] Loss: 0.53450 (QuantReg: 12.10784) QuantErr: 12.10784 batch_time=0.35051 
Train Epoch: 7 [606/1000 19392/32000 (61%)] Loss: 1.29487 (QuantReg: 11.50245) QuantErr: 11.50245 batch_time=0.34113 
Train Epoch: 7 [611/1000 19552/32000 (61%)] Loss: 0.99117 (QuantReg: 12.56787) QuantErr: 12.56787 batch_time=0.34855 
Train Epoch: 7 [616/1000 19712/32000 (62%)] Loss: 1.83675 (QuantReg: 11.33298) QuantErr: 11.33298 batch_time=0.40652 
Train Epoch: 7 [621/1000 19872/32000 (62%)] Loss: 0.45734 (QuantReg: 11.50773) QuantErr: 11.50773 batch_time=0.35545 
Train Epoch: 7 [626/1000 20032/32000 (63%)] Loss: 1.13594 (QuantReg: 11.64028) QuantErr: 11.64028 batch_time=0.40707 
Train Epoch: 7 [631/1000 20192/32000 (63%)] Loss: 1.13627 (QuantReg: 11.70327) QuantErr: 11.70327 batch_time=0.34700 
Train Epoch: 7 [636/1000 20352/32000 (64%)] Loss: 1.15482 (QuantReg: 11.48253) QuantErr: 11.48253 batch_time=0.36126 
Train Epoch: 7 [641/1000 20512/32000 (64%)] Loss: 1.25914 (QuantReg: 12.03752) QuantErr: 12.03752 batch_time=0.39685 
Train Epoch: 7 [646/1000 20672/32000 (65%)] Loss: 0.66900 (QuantReg: 12.36820) QuantErr: 12.36820 batch_time=0.34458 
Train Epoch: 7 [651/1000 20832/32000 (65%)] Loss: 0.81929 (QuantReg: 11.25282) QuantErr: 11.25282 batch_time=0.33450 
Train Epoch: 7 [656/1000 20992/32000 (66%)] Loss: 0.86041 (QuantReg: 11.94271) QuantErr: 11.94271 batch_time=0.44011 
Train Epoch: 7 [661/1000 21152/32000 (66%)] Loss: 1.00640 (QuantReg: 11.88854) QuantErr: 11.88854 batch_time=0.37946 
Train Epoch: 7 [666/1000 21312/32000 (67%)] Loss: 0.65906 (QuantReg: 12.02911) QuantErr: 12.02911 batch_time=0.38904 
Train Epoch: 7 [671/1000 21472/32000 (67%)] Loss: 0.51006 (QuantReg: 11.99140) QuantErr: 11.99140 batch_time=0.39291 
Train Epoch: 7 [676/1000 21632/32000 (68%)] Loss: 0.86378 (QuantReg: 11.78415) QuantErr: 11.78415 batch_time=0.39011 
Train Epoch: 7 [681/1000 21792/32000 (68%)] Loss: 1.03909 (QuantReg: 11.53296) QuantErr: 11.53296 batch_time=0.40587 
Train Epoch: 7 [686/1000 21952/32000 (69%)] Loss: 0.66712 (QuantReg: 11.45525) QuantErr: 11.45525 batch_time=0.36815 
Train Epoch: 7 [691/1000 22112/32000 (69%)] Loss: 0.87417 (QuantReg: 11.78687) QuantErr: 11.78687 batch_time=0.38604 
Train Epoch: 7 [696/1000 22272/32000 (70%)] Loss: 0.60850 (QuantReg: 12.05981) QuantErr: 12.05981 batch_time=0.37041 
Train Epoch: 7 [701/1000 22432/32000 (70%)] Loss: 0.60130 (QuantReg: 11.69241) QuantErr: 11.69241 batch_time=0.39111 
Train Epoch: 7 [706/1000 22592/32000 (71%)] Loss: 1.37057 (QuantReg: 11.65190) QuantErr: 11.65190 batch_time=0.41890 
Train Epoch: 7 [711/1000 22752/32000 (71%)] Loss: 0.48202 (QuantReg: 12.05128) QuantErr: 12.05128 batch_time=0.40140 
Train Epoch: 7 [716/1000 22912/32000 (72%)] Loss: 0.80903 (QuantReg: 12.00740) QuantErr: 12.00740 batch_time=0.37005 
Train Epoch: 7 [721/1000 23072/32000 (72%)] Loss: 0.32424 (QuantReg: 11.71991) QuantErr: 11.71991 batch_time=0.41237 
Train Epoch: 7 [726/1000 23232/32000 (73%)] Loss: 0.48504 (QuantReg: 11.88853) QuantErr: 11.88853 batch_time=0.36265 
Train Epoch: 7 [731/1000 23392/32000 (73%)] Loss: 0.61790 (QuantReg: 12.52166) QuantErr: 12.52166 batch_time=0.39044 
Train Epoch: 7 [736/1000 23552/32000 (74%)] Loss: 0.75002 (QuantReg: 12.14558) QuantErr: 12.14558 batch_time=0.40784 
Train Epoch: 7 [741/1000 23712/32000 (74%)] Loss: 0.92116 (QuantReg: 11.33597) QuantErr: 11.33597 batch_time=0.35104 
Train Epoch: 7 [746/1000 23872/32000 (75%)] Loss: 0.89090 (QuantReg: 12.13276) QuantErr: 12.13276 batch_time=0.35138 
Train Epoch: 7 [751/1000 24032/32000 (75%)] Loss: 0.76920 (QuantReg: 11.26430) QuantErr: 11.26430 batch_time=0.37129 
Train Epoch: 7 [756/1000 24192/32000 (76%)] Loss: 0.79996 (QuantReg: 12.58325) QuantErr: 12.58325 batch_time=0.39817 
Train Epoch: 7 [761/1000 24352/32000 (76%)] Loss: 1.29991 (QuantReg: 11.79067) QuantErr: 11.79067 batch_time=0.36929 
Train Epoch: 7 [766/1000 24512/32000 (77%)] Loss: 1.31807 (QuantReg: 11.46032) QuantErr: 11.46032 batch_time=0.43289 
Train Epoch: 7 [771/1000 24672/32000 (77%)] Loss: 1.13776 (QuantReg: 11.96329) QuantErr: 11.96329 batch_time=0.43769 
Train Epoch: 7 [776/1000 24832/32000 (78%)] Loss: 0.42270 (QuantReg: 11.96199) QuantErr: 11.96199 batch_time=0.37110 
Train Epoch: 7 [781/1000 24992/32000 (78%)] Loss: 0.80680 (QuantReg: 12.64165) QuantErr: 12.64165 batch_time=0.41887 
Train Epoch: 7 [786/1000 25152/32000 (79%)] Loss: 0.94931 (QuantReg: 11.97001) QuantErr: 11.97001 batch_time=1.11984 
Train Epoch: 7 [791/1000 25312/32000 (79%)] Loss: 0.70179 (QuantReg: 11.28220) QuantErr: 11.28220 batch_time=0.40730 
Train Epoch: 7 [796/1000 25472/32000 (80%)] Loss: 1.12594 (QuantReg: 11.70955) QuantErr: 11.70955 batch_time=0.39668 
Train Epoch: 7 [801/1000 25632/32000 (80%)] Loss: 0.88621 (QuantReg: 12.30931) QuantErr: 12.30931 batch_time=0.38307 
Train Epoch: 7 [806/1000 25792/32000 (81%)] Loss: 0.97443 (QuantReg: 11.42019) QuantErr: 11.42019 batch_time=0.36186 
Train Epoch: 7 [811/1000 25952/32000 (81%)] Loss: 0.88720 (QuantReg: 12.08561) QuantErr: 12.08561 batch_time=0.38833 
Train Epoch: 7 [816/1000 26112/32000 (82%)] Loss: 0.62203 (QuantReg: 11.56036) QuantErr: 11.56036 batch_time=0.35495 
Train Epoch: 7 [821/1000 26272/32000 (82%)] Loss: 1.31572 (QuantReg: 11.43986) QuantErr: 11.43986 batch_time=0.38672 
Train Epoch: 7 [826/1000 26432/32000 (83%)] Loss: 0.48088 (QuantReg: 11.91236) QuantErr: 11.91236 batch_time=0.39431 
Train Epoch: 7 [831/1000 26592/32000 (83%)] Loss: 0.63631 (QuantReg: 12.02816) QuantErr: 12.02816 batch_time=1.57103 
Train Epoch: 7 [836/1000 26752/32000 (84%)] Loss: 0.93757 (QuantReg: 12.31646) QuantErr: 12.31646 batch_time=0.40590 
Train Epoch: 7 [841/1000 26912/32000 (84%)] Loss: 1.18841 (QuantReg: 12.17089) QuantErr: 12.17089 batch_time=0.37335 
Train Epoch: 7 [846/1000 27072/32000 (85%)] Loss: 1.40732 (QuantReg: 12.19200) QuantErr: 12.19200 batch_time=0.36789 
Train Epoch: 7 [851/1000 27232/32000 (85%)] Loss: 0.82666 (QuantReg: 11.12337) QuantErr: 11.12337 batch_time=0.42373 
Train Epoch: 7 [856/1000 27392/32000 (86%)] Loss: 1.27701 (QuantReg: 11.97125) QuantErr: 11.97125 batch_time=0.52246 
Train Epoch: 7 [861/1000 27552/32000 (86%)] Loss: 1.89069 (QuantReg: 11.44567) QuantErr: 11.44567 batch_time=0.36454 
Train Epoch: 7 [866/1000 27712/32000 (87%)] Loss: 0.46681 (QuantReg: 11.45774) QuantErr: 11.45774 batch_time=0.37055 
Train Epoch: 7 [871/1000 27872/32000 (87%)] Loss: 1.13931 (QuantReg: 11.21558) QuantErr: 11.21558 batch_time=0.34944 
Train Epoch: 7 [876/1000 28032/32000 (88%)] Loss: 0.74213 (QuantReg: 12.05546) QuantErr: 12.05546 batch_time=0.36342 
Train Epoch: 7 [881/1000 28192/32000 (88%)] Loss: 0.90963 (QuantReg: 11.80563) QuantErr: 11.80563 batch_time=0.38098 
Train Epoch: 7 [886/1000 28352/32000 (89%)] Loss: 0.59322 (QuantReg: 12.39957) QuantErr: 12.39957 batch_time=0.43874 
Train Epoch: 7 [891/1000 28512/32000 (89%)] Loss: 0.65186 (QuantReg: 12.12981) QuantErr: 12.12981 batch_time=0.38180 
Train Epoch: 7 [896/1000 28672/32000 (90%)] Loss: 0.88485 (QuantReg: 12.57029) QuantErr: 12.57029 batch_time=0.37001 
Train Epoch: 7 [901/1000 28832/32000 (90%)] Loss: 0.43104 (QuantReg: 11.61857) QuantErr: 11.61857 batch_time=0.37975 
Train Epoch: 7 [906/1000 28992/32000 (91%)] Loss: 1.12564 (QuantReg: 11.74273) QuantErr: 11.74273 batch_time=0.37451 
Train Epoch: 7 [911/1000 29152/32000 (91%)] Loss: 0.80060 (QuantReg: 11.96115) QuantErr: 11.96115 batch_time=0.40735 
Train Epoch: 7 [916/1000 29312/32000 (92%)] Loss: 1.11846 (QuantReg: 12.40962) QuantErr: 12.40962 batch_time=0.36544 
Train Epoch: 7 [921/1000 29472/32000 (92%)] Loss: 1.40999 (QuantReg: 11.62840) QuantErr: 11.62840 batch_time=0.34772 
Train Epoch: 7 [926/1000 29632/32000 (93%)] Loss: 1.33447 (QuantReg: 11.86429) QuantErr: 11.86429 batch_time=0.34340 
Train Epoch: 7 [931/1000 29792/32000 (93%)] Loss: 0.74240 (QuantReg: 12.29271) QuantErr: 12.29271 batch_time=0.34857 
Train Epoch: 7 [936/1000 29952/32000 (94%)] Loss: 0.95072 (QuantReg: 12.31753) QuantErr: 12.31753 batch_time=0.40239 
Train Epoch: 7 [941/1000 30112/32000 (94%)] Loss: 0.73608 (QuantReg: 12.11068) QuantErr: 12.11068 batch_time=0.34432 
Train Epoch: 7 [946/1000 30272/32000 (95%)] Loss: 0.93602 (QuantReg: 12.54600) QuantErr: 12.54600 batch_time=0.45403 
Train Epoch: 7 [951/1000 30432/32000 (95%)] Loss: 1.76412 (QuantReg: 12.15427) QuantErr: 12.15427 batch_time=0.41977 
Train Epoch: 7 [956/1000 30592/32000 (96%)] Loss: 0.67176 (QuantReg: 12.22292) QuantErr: 12.22292 batch_time=0.43654 
Train Epoch: 7 [961/1000 30752/32000 (96%)] Loss: 1.04344 (QuantReg: 12.56976) QuantErr: 12.56976 batch_time=0.39759 
Train Epoch: 7 [966/1000 30912/32000 (97%)] Loss: 0.76291 (QuantReg: 12.49609) QuantErr: 12.49609 batch_time=0.36713 
Train Epoch: 7 [971/1000 31072/32000 (97%)] Loss: 1.34772 (QuantReg: 11.59162) QuantErr: 11.59162 batch_time=0.36511 
Train Epoch: 7 [976/1000 31232/32000 (98%)] Loss: 1.56714 (QuantReg: 12.78486) QuantErr: 12.78486 batch_time=0.45212 
Train Epoch: 7 [981/1000 31392/32000 (98%)] Loss: 0.57471 (QuantReg: 11.93769) QuantErr: 11.93769 batch_time=0.39543 
Train Epoch: 7 [986/1000 31552/32000 (99%)] Loss: 1.31535 (QuantReg: 11.96253) QuantErr: 11.96253 batch_time=0.40312 
Train Epoch: 7 [991/1000 31712/32000 (99%)] Loss: 0.67332 (QuantReg: 12.08882) QuantErr: 12.08882 batch_time=0.34644 
Train Epoch: 7 [996/1000 31872/32000 (100%)] Loss: 0.73183 (QuantReg: 12.53027) QuantErr: 12.53027 batch_time=0.35422 
Train Epoch: 7 codebook_update_time=2.01997
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch7.pth ...
Done in 4.566s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 0.9237629996091128
 quant_reg      : 11.700109749794006
 quant_err      : 11.700109749794006
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 7000
 MSRVTT_full_val/t2v_metrics/R1: 27.364185110663986
 MSRVTT_full_val/t2v_metrics/R5: 64.1851106639839
 MSRVTT_full_val/t2v_metrics/R10: 76.86116700201207
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.704225352112676
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.298885438753715
 MSRVTT_full_val/v2t_metrics/R1: 29.77867203219316
 MSRVTT_full_val/v2t_metrics/R5: 68.2092555331992
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.971830985915493
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.08565508363288
 MSRVTT_full_test/t2v_metrics/R1: 9.531772575250836
 MSRVTT_full_test/t2v_metrics/R5: 29.163879598662206
 MSRVTT_full_test/t2v_metrics/R10: 43.979933110367895
 MSRVTT_full_test/t2v_metrics/R50: 77.29096989966555
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.08996655518395
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.036925134095288
 MSRVTT_full_test/v2t_metrics/R1: 10.367892976588628
 MSRVTT_full_test/v2t_metrics/R5: 32.675585284280935
 MSRVTT_full_test/v2t_metrics/R10: 46.62207357859532
 MSRVTT_full_test/v2t_metrics/R50: 81.23745819397993
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.77224080267558
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.090067061624556
 mnt_best       : 23.109654096300698
 not_improved_count: 1
Train Epoch: 8 [1/1000 32/32000 (0%)] Loss: 1.05306 (QuantReg: 11.01842) QuantErr: 11.01842 batch_time=26.89199 
Train Epoch: 8 [6/1000 192/32000 (1%)] Loss: 1.09428 (QuantReg: 10.18541) QuantErr: 10.18541 batch_time=0.43421 
Train Epoch: 8 [11/1000 352/32000 (1%)] Loss: 0.54886 (QuantReg: 11.85925) QuantErr: 11.85925 batch_time=0.37443 
Train Epoch: 8 [16/1000 512/32000 (2%)] Loss: 1.07570 (QuantReg: 11.43595) QuantErr: 11.43595 batch_time=1.37807 
Train Epoch: 8 [21/1000 672/32000 (2%)] Loss: 1.68383 (QuantReg: 11.19343) QuantErr: 11.19343 batch_time=0.34509 
Train Epoch: 8 [26/1000 832/32000 (3%)] Loss: 0.80230 (QuantReg: 11.61512) QuantErr: 11.61512 batch_time=0.38345 
Train Epoch: 8 [31/1000 992/32000 (3%)] Loss: 1.23730 (QuantReg: 11.78709) QuantErr: 11.78709 batch_time=0.38821 
Train Epoch: 8 [36/1000 1152/32000 (4%)] Loss: 0.70956 (QuantReg: 11.37389) QuantErr: 11.37389 batch_time=0.38620 
Train Epoch: 8 [41/1000 1312/32000 (4%)] Loss: 1.28068 (QuantReg: 11.17345) QuantErr: 11.17345 batch_time=0.41776 
Train Epoch: 8 [46/1000 1472/32000 (5%)] Loss: 0.83539 (QuantReg: 11.71253) QuantErr: 11.71253 batch_time=0.38313 
Train Epoch: 8 [51/1000 1632/32000 (5%)] Loss: 0.80751 (QuantReg: 11.52174) QuantErr: 11.52174 batch_time=0.42235 
Train Epoch: 8 [56/1000 1792/32000 (6%)] Loss: 0.62304 (QuantReg: 11.41028) QuantErr: 11.41028 batch_time=0.39023 
Train Epoch: 8 [61/1000 1952/32000 (6%)] Loss: 0.67784 (QuantReg: 11.60069) QuantErr: 11.60069 batch_time=0.49162 
Train Epoch: 8 [66/1000 2112/32000 (7%)] Loss: 1.06086 (QuantReg: 11.28760) QuantErr: 11.28760 batch_time=0.51304 
Train Epoch: 8 [71/1000 2272/32000 (7%)] Loss: 0.57590 (QuantReg: 11.62233) QuantErr: 11.62233 batch_time=0.38926 
Train Epoch: 8 [76/1000 2432/32000 (8%)] Loss: 1.14271 (QuantReg: 11.98437) QuantErr: 11.98437 batch_time=0.44931 
Train Epoch: 8 [81/1000 2592/32000 (8%)] Loss: 0.87813 (QuantReg: 11.37487) QuantErr: 11.37487 batch_time=1.08367 
Train Epoch: 8 [86/1000 2752/32000 (9%)] Loss: 1.33223 (QuantReg: 11.48753) QuantErr: 11.48753 batch_time=0.34615 
Train Epoch: 8 [91/1000 2912/32000 (9%)] Loss: 1.13077 (QuantReg: 10.92556) QuantErr: 10.92556 batch_time=0.39534 
Train Epoch: 8 [96/1000 3072/32000 (10%)] Loss: 1.72271 (QuantReg: 11.58013) QuantErr: 11.58013 batch_time=0.44140 
Train Epoch: 8 [101/1000 3232/32000 (10%)] Loss: 0.73185 (QuantReg: 11.07627) QuantErr: 11.07627 batch_time=0.39086 
Train Epoch: 8 [106/1000 3392/32000 (11%)] Loss: 0.51411 (QuantReg: 10.82125) QuantErr: 10.82125 batch_time=0.39358 
Train Epoch: 8 [111/1000 3552/32000 (11%)] Loss: 0.52902 (QuantReg: 11.69059) QuantErr: 11.69059 batch_time=0.36986 
Train Epoch: 8 [116/1000 3712/32000 (12%)] Loss: 0.87772 (QuantReg: 12.14658) QuantErr: 12.14658 batch_time=0.43356 
Train Epoch: 8 [121/1000 3872/32000 (12%)] Loss: 1.26912 (QuantReg: 11.63021) QuantErr: 11.63021 batch_time=0.39853 
Train Epoch: 8 [126/1000 4032/32000 (13%)] Loss: 0.45762 (QuantReg: 11.53895) QuantErr: 11.53895 batch_time=0.38860 
Train Epoch: 8 [131/1000 4192/32000 (13%)] Loss: 1.74079 (QuantReg: 12.11140) QuantErr: 12.11140 batch_time=0.41553 
Train Epoch: 8 [136/1000 4352/32000 (14%)] Loss: 0.38075 (QuantReg: 12.02398) QuantErr: 12.02398 batch_time=0.37335 
Train Epoch: 8 [141/1000 4512/32000 (14%)] Loss: 0.73265 (QuantReg: 11.29731) QuantErr: 11.29731 batch_time=0.35472 
Train Epoch: 8 [146/1000 4672/32000 (15%)] Loss: 0.84724 (QuantReg: 11.98002) QuantErr: 11.98002 batch_time=0.46991 
Train Epoch: 8 [151/1000 4832/32000 (15%)] Loss: 0.59543 (QuantReg: 11.64681) QuantErr: 11.64681 batch_time=0.40514 
Train Epoch: 8 [156/1000 4992/32000 (16%)] Loss: 0.73971 (QuantReg: 11.50427) QuantErr: 11.50427 batch_time=0.35954 
Train Epoch: 8 [161/1000 5152/32000 (16%)] Loss: 0.62488 (QuantReg: 11.17888) QuantErr: 11.17888 batch_time=0.42511 
Train Epoch: 8 [166/1000 5312/32000 (17%)] Loss: 0.86151 (QuantReg: 11.95451) QuantErr: 11.95451 batch_time=0.36507 
Train Epoch: 8 [171/1000 5472/32000 (17%)] Loss: 1.02280 (QuantReg: 11.86568) QuantErr: 11.86568 batch_time=0.41750 
Train Epoch: 8 [176/1000 5632/32000 (18%)] Loss: 0.94947 (QuantReg: 11.44180) QuantErr: 11.44180 batch_time=0.42303 
Train Epoch: 8 [181/1000 5792/32000 (18%)] Loss: 1.24943 (QuantReg: 11.61338) QuantErr: 11.61338 batch_time=0.37869 
Train Epoch: 8 [186/1000 5952/32000 (19%)] Loss: 0.73301 (QuantReg: 12.09598) QuantErr: 12.09598 batch_time=0.41371 
Train Epoch: 8 [191/1000 6112/32000 (19%)] Loss: 0.94566 (QuantReg: 11.29879) QuantErr: 11.29879 batch_time=0.39967 
Train Epoch: 8 [196/1000 6272/32000 (20%)] Loss: 0.49776 (QuantReg: 11.59658) QuantErr: 11.59658 batch_time=0.37281 
Train Epoch: 8 [201/1000 6432/32000 (20%)] Loss: 1.09410 (QuantReg: 11.69005) QuantErr: 11.69005 batch_time=0.39122 
Train Epoch: 8 [206/1000 6592/32000 (21%)] Loss: 1.08122 (QuantReg: 11.85548) QuantErr: 11.85548 batch_time=0.35131 
Train Epoch: 8 [211/1000 6752/32000 (21%)] Loss: 0.81763 (QuantReg: 12.10152) QuantErr: 12.10152 batch_time=0.43584 
Train Epoch: 8 [216/1000 6912/32000 (22%)] Loss: 0.92986 (QuantReg: 12.02991) QuantErr: 12.02991 batch_time=0.40410 
Train Epoch: 8 [221/1000 7072/32000 (22%)] Loss: 0.92818 (QuantReg: 11.71936) QuantErr: 11.71936 batch_time=0.37558 
Train Epoch: 8 [226/1000 7232/32000 (23%)] Loss: 1.11491 (QuantReg: 11.47234) QuantErr: 11.47234 batch_time=0.37496 
Train Epoch: 8 [231/1000 7392/32000 (23%)] Loss: 0.45545 (QuantReg: 12.05107) QuantErr: 12.05107 batch_time=0.36305 
Train Epoch: 8 [236/1000 7552/32000 (24%)] Loss: 0.87070 (QuantReg: 11.67948) QuantErr: 11.67948 batch_time=0.42326 
Train Epoch: 8 [241/1000 7712/32000 (24%)] Loss: 0.97082 (QuantReg: 12.12106) QuantErr: 12.12106 batch_time=0.38529 
Train Epoch: 8 [246/1000 7872/32000 (25%)] Loss: 1.62792 (QuantReg: 11.53836) QuantErr: 11.53836 batch_time=0.40479 
Train Epoch: 8 [251/1000 8032/32000 (25%)] Loss: 0.88858 (QuantReg: 12.21227) QuantErr: 12.21227 batch_time=0.38440 
Train Epoch: 8 [256/1000 8192/32000 (26%)] Loss: 0.95408 (QuantReg: 11.61232) QuantErr: 11.61232 batch_time=0.36880 
Train Epoch: 8 [261/1000 8352/32000 (26%)] Loss: 1.02664 (QuantReg: 11.70176) QuantErr: 11.70176 batch_time=0.54793 
Train Epoch: 8 [266/1000 8512/32000 (27%)] Loss: 0.45168 (QuantReg: 12.10355) QuantErr: 12.10355 batch_time=0.36238 
Train Epoch: 8 [271/1000 8672/32000 (27%)] Loss: 0.86139 (QuantReg: 12.06706) QuantErr: 12.06706 batch_time=0.37286 
Train Epoch: 8 [276/1000 8832/32000 (28%)] Loss: 0.68550 (QuantReg: 11.41977) QuantErr: 11.41977 batch_time=0.34708 
Train Epoch: 8 [281/1000 8992/32000 (28%)] Loss: 1.28824 (QuantReg: 11.51869) QuantErr: 11.51869 batch_time=0.38666 
Train Epoch: 8 [286/1000 9152/32000 (29%)] Loss: 1.11019 (QuantReg: 11.35918) QuantErr: 11.35918 batch_time=0.50177 
Train Epoch: 8 [291/1000 9312/32000 (29%)] Loss: 1.14145 (QuantReg: 11.62762) QuantErr: 11.62762 batch_time=0.38937 
Train Epoch: 8 [296/1000 9472/32000 (30%)] Loss: 0.84145 (QuantReg: 12.14010) QuantErr: 12.14010 batch_time=0.36288 
Train Epoch: 8 [301/1000 9632/32000 (30%)] Loss: 0.79078 (QuantReg: 12.45015) QuantErr: 12.45015 batch_time=0.36418 
Train Epoch: 8 [306/1000 9792/32000 (31%)] Loss: 0.56431 (QuantReg: 11.28921) QuantErr: 11.28921 batch_time=0.46189 
Train Epoch: 8 [311/1000 9952/32000 (31%)] Loss: 0.78124 (QuantReg: 11.58749) QuantErr: 11.58749 batch_time=0.39860 
Train Epoch: 8 [316/1000 10112/32000 (32%)] Loss: 0.90445 (QuantReg: 12.33295) QuantErr: 12.33295 batch_time=0.37169 
Train Epoch: 8 [321/1000 10272/32000 (32%)] Loss: 1.00073 (QuantReg: 12.43965) QuantErr: 12.43965 batch_time=0.45054 
Train Epoch: 8 [326/1000 10432/32000 (33%)] Loss: 0.80706 (QuantReg: 11.73729) QuantErr: 11.73729 batch_time=0.47589 
Train Epoch: 8 [331/1000 10592/32000 (33%)] Loss: 0.90726 (QuantReg: 11.83686) QuantErr: 11.83686 batch_time=0.37759 
Train Epoch: 8 [336/1000 10752/32000 (34%)] Loss: 0.66879 (QuantReg: 12.86008) QuantErr: 12.86008 batch_time=1.26271 
Train Epoch: 8 [341/1000 10912/32000 (34%)] Loss: 0.30649 (QuantReg: 12.82718) QuantErr: 12.82718 batch_time=0.40988 
Train Epoch: 8 [346/1000 11072/32000 (35%)] Loss: 0.94705 (QuantReg: 11.85223) QuantErr: 11.85223 batch_time=0.34482 
Train Epoch: 8 [351/1000 11232/32000 (35%)] Loss: 0.41581 (QuantReg: 11.34481) QuantErr: 11.34481 batch_time=0.34188 
Train Epoch: 8 [356/1000 11392/32000 (36%)] Loss: 0.77371 (QuantReg: 11.63891) QuantErr: 11.63891 batch_time=0.36751 
Train Epoch: 8 [361/1000 11552/32000 (36%)] Loss: 0.83363 (QuantReg: 12.51347) QuantErr: 12.51347 batch_time=0.40593 
Train Epoch: 8 [366/1000 11712/32000 (37%)] Loss: 0.72682 (QuantReg: 11.75378) QuantErr: 11.75378 batch_time=0.39740 
Train Epoch: 8 [371/1000 11872/32000 (37%)] Loss: 0.69192 (QuantReg: 12.00455) QuantErr: 12.00455 batch_time=0.39884 
Train Epoch: 8 [376/1000 12032/32000 (38%)] Loss: 0.90036 (QuantReg: 11.61356) QuantErr: 11.61356 batch_time=0.38523 
Train Epoch: 8 [381/1000 12192/32000 (38%)] Loss: 0.36121 (QuantReg: 11.93033) QuantErr: 11.93033 batch_time=0.35945 
Train Epoch: 8 [386/1000 12352/32000 (39%)] Loss: 0.78038 (QuantReg: 11.91603) QuantErr: 11.91603 batch_time=0.68373 
Train Epoch: 8 [391/1000 12512/32000 (39%)] Loss: 0.44187 (QuantReg: 12.41980) QuantErr: 12.41980 batch_time=0.39951 
Train Epoch: 8 [396/1000 12672/32000 (40%)] Loss: 0.27215 (QuantReg: 12.27399) QuantErr: 12.27399 batch_time=0.38952 
Train Epoch: 8 [401/1000 12832/32000 (40%)] Loss: 1.06719 (QuantReg: 11.72544) QuantErr: 11.72544 batch_time=1.13638 
Train Epoch: 8 [406/1000 12992/32000 (41%)] Loss: 1.19239 (QuantReg: 12.02407) QuantErr: 12.02407 batch_time=0.44077 
Train Epoch: 8 [411/1000 13152/32000 (41%)] Loss: 0.85263 (QuantReg: 11.88123) QuantErr: 11.88123 batch_time=0.40747 
Train Epoch: 8 [416/1000 13312/32000 (42%)] Loss: 0.85370 (QuantReg: 11.73343) QuantErr: 11.73343 batch_time=0.37941 
Train Epoch: 8 [421/1000 13472/32000 (42%)] Loss: 0.84929 (QuantReg: 11.58482) QuantErr: 11.58482 batch_time=0.37202 
Train Epoch: 8 [426/1000 13632/32000 (43%)] Loss: 0.95741 (QuantReg: 11.62292) QuantErr: 11.62292 batch_time=0.39143 
Train Epoch: 8 [431/1000 13792/32000 (43%)] Loss: 2.05875 (QuantReg: 11.64164) QuantErr: 11.64164 batch_time=0.41589 
Train Epoch: 8 [436/1000 13952/32000 (44%)] Loss: 0.72569 (QuantReg: 11.63644) QuantErr: 11.63644 batch_time=0.42063 
Train Epoch: 8 [441/1000 14112/32000 (44%)] Loss: 1.12404 (QuantReg: 11.62012) QuantErr: 11.62012 batch_time=0.41562 
Train Epoch: 8 [446/1000 14272/32000 (45%)] Loss: 0.46410 (QuantReg: 12.25016) QuantErr: 12.25016 batch_time=0.45054 
Train Epoch: 8 [451/1000 14432/32000 (45%)] Loss: 0.57938 (QuantReg: 11.82051) QuantErr: 11.82051 batch_time=0.39138 
Train Epoch: 8 [456/1000 14592/32000 (46%)] Loss: 0.82528 (QuantReg: 11.69947) QuantErr: 11.69947 batch_time=0.35283 
Train Epoch: 8 [461/1000 14752/32000 (46%)] Loss: 0.76991 (QuantReg: 11.60584) QuantErr: 11.60584 batch_time=0.37446 
Train Epoch: 8 [466/1000 14912/32000 (47%)] Loss: 0.59315 (QuantReg: 12.19000) QuantErr: 12.19000 batch_time=0.44141 
Train Epoch: 8 [471/1000 15072/32000 (47%)] Loss: 1.20436 (QuantReg: 12.40485) QuantErr: 12.40485 batch_time=0.35328 
Train Epoch: 8 [476/1000 15232/32000 (48%)] Loss: 0.56101 (QuantReg: 11.26164) QuantErr: 11.26164 batch_time=0.35258 
Train Epoch: 8 [481/1000 15392/32000 (48%)] Loss: 0.65119 (QuantReg: 12.06070) QuantErr: 12.06070 batch_time=0.36781 
Train Epoch: 8 [486/1000 15552/32000 (49%)] Loss: 0.90568 (QuantReg: 11.65864) QuantErr: 11.65864 batch_time=0.43378 
Train Epoch: 8 [491/1000 15712/32000 (49%)] Loss: 1.43719 (QuantReg: 11.67630) QuantErr: 11.67630 batch_time=0.36226 
Train Epoch: 8 [496/1000 15872/32000 (50%)] Loss: 0.38542 (QuantReg: 11.86421) QuantErr: 11.86421 batch_time=0.36704 
Train Epoch: 8 [501/1000 16032/32000 (50%)] Loss: 1.08632 (QuantReg: 11.52143) QuantErr: 11.52143 batch_time=0.39717 
Train Epoch: 8 [506/1000 16192/32000 (51%)] Loss: 0.80185 (QuantReg: 12.27977) QuantErr: 12.27977 batch_time=0.41707 
Train Epoch: 8 [511/1000 16352/32000 (51%)] Loss: 1.00668 (QuantReg: 11.70689) QuantErr: 11.70689 batch_time=0.38660 
Train Epoch: 8 [516/1000 16512/32000 (52%)] Loss: 0.83723 (QuantReg: 11.70878) QuantErr: 11.70878 batch_time=0.37972 
Train Epoch: 8 [521/1000 16672/32000 (52%)] Loss: 0.53653 (QuantReg: 11.24408) QuantErr: 11.24408 batch_time=0.34401 
Train Epoch: 8 [526/1000 16832/32000 (53%)] Loss: 1.18488 (QuantReg: 11.98465) QuantErr: 11.98465 batch_time=0.34118 
Train Epoch: 8 [531/1000 16992/32000 (53%)] Loss: 0.70126 (QuantReg: 12.08474) QuantErr: 12.08474 batch_time=0.34197 
Train Epoch: 8 [536/1000 17152/32000 (54%)] Loss: 0.61101 (QuantReg: 12.12453) QuantErr: 12.12453 batch_time=0.34477 
Train Epoch: 8 [541/1000 17312/32000 (54%)] Loss: 0.86421 (QuantReg: 12.35543) QuantErr: 12.35543 batch_time=0.39210 
Train Epoch: 8 [546/1000 17472/32000 (55%)] Loss: 1.38016 (QuantReg: 11.30466) QuantErr: 11.30466 batch_time=0.35226 
Train Epoch: 8 [551/1000 17632/32000 (55%)] Loss: 1.09191 (QuantReg: 11.86082) QuantErr: 11.86082 batch_time=0.38604 
Train Epoch: 8 [556/1000 17792/32000 (56%)] Loss: 0.49506 (QuantReg: 12.33740) QuantErr: 12.33740 batch_time=0.39552 
Train Epoch: 8 [561/1000 17952/32000 (56%)] Loss: 0.64303 (QuantReg: 11.86514) QuantErr: 11.86514 batch_time=0.44353 
Train Epoch: 8 [566/1000 18112/32000 (57%)] Loss: 1.08267 (QuantReg: 12.14003) QuantErr: 12.14003 batch_time=0.39225 
Train Epoch: 8 [571/1000 18272/32000 (57%)] Loss: 0.50675 (QuantReg: 11.33943) QuantErr: 11.33943 batch_time=0.38804 
Train Epoch: 8 [576/1000 18432/32000 (58%)] Loss: 1.65686 (QuantReg: 12.14017) QuantErr: 12.14017 batch_time=0.34792 
Train Epoch: 8 [581/1000 18592/32000 (58%)] Loss: 1.52284 (QuantReg: 12.76359) QuantErr: 12.76359 batch_time=0.44388 
Train Epoch: 8 [586/1000 18752/32000 (59%)] Loss: 0.61165 (QuantReg: 11.85438) QuantErr: 11.85438 batch_time=0.35436 
Train Epoch: 8 [591/1000 18912/32000 (59%)] Loss: 1.01655 (QuantReg: 11.45808) QuantErr: 11.45808 batch_time=0.37540 
Train Epoch: 8 [596/1000 19072/32000 (60%)] Loss: 1.40230 (QuantReg: 11.63954) QuantErr: 11.63954 batch_time=0.37154 
Train Epoch: 8 [601/1000 19232/32000 (60%)] Loss: 0.66863 (QuantReg: 11.54038) QuantErr: 11.54038 batch_time=0.35634 
Train Epoch: 8 [606/1000 19392/32000 (61%)] Loss: 1.35982 (QuantReg: 11.42106) QuantErr: 11.42106 batch_time=0.41273 
Train Epoch: 8 [611/1000 19552/32000 (61%)] Loss: 0.87590 (QuantReg: 10.90806) QuantErr: 10.90806 batch_time=0.39997 
Train Epoch: 8 [616/1000 19712/32000 (62%)] Loss: 0.98719 (QuantReg: 11.54933) QuantErr: 11.54933 batch_time=0.41358 
Train Epoch: 8 [621/1000 19872/32000 (62%)] Loss: 0.79625 (QuantReg: 11.91915) QuantErr: 11.91915 batch_time=0.37670 
Train Epoch: 8 [626/1000 20032/32000 (63%)] Loss: 1.15194 (QuantReg: 11.73326) QuantErr: 11.73326 batch_time=0.46606 
Train Epoch: 8 [631/1000 20192/32000 (63%)] Loss: 0.36723 (QuantReg: 12.41741) QuantErr: 12.41741 batch_time=0.40193 
Train Epoch: 8 [636/1000 20352/32000 (64%)] Loss: 1.00301 (QuantReg: 11.82322) QuantErr: 11.82322 batch_time=0.40364 
Train Epoch: 8 [641/1000 20512/32000 (64%)] Loss: 0.87653 (QuantReg: 11.85724) QuantErr: 11.85724 batch_time=0.40723 
Train Epoch: 8 [646/1000 20672/32000 (65%)] Loss: 1.29862 (QuantReg: 11.98418) QuantErr: 11.98418 batch_time=0.36070 
Train Epoch: 8 [651/1000 20832/32000 (65%)] Loss: 0.82421 (QuantReg: 12.23685) QuantErr: 12.23685 batch_time=0.39015 
Train Epoch: 8 [656/1000 20992/32000 (66%)] Loss: 0.77507 (QuantReg: 11.30927) QuantErr: 11.30927 batch_time=1.24697 
Train Epoch: 8 [661/1000 21152/32000 (66%)] Loss: 0.49249 (QuantReg: 12.22719) QuantErr: 12.22719 batch_time=0.36517 
Train Epoch: 8 [666/1000 21312/32000 (67%)] Loss: 1.09395 (QuantReg: 11.31332) QuantErr: 11.31332 batch_time=0.38556 
Train Epoch: 8 [671/1000 21472/32000 (67%)] Loss: 1.84191 (QuantReg: 12.48772) QuantErr: 12.48772 batch_time=0.39962 
Train Epoch: 8 [676/1000 21632/32000 (68%)] Loss: 1.09807 (QuantReg: 11.31172) QuantErr: 11.31172 batch_time=0.42219 
Train Epoch: 8 [681/1000 21792/32000 (68%)] Loss: 0.66195 (QuantReg: 11.21470) QuantErr: 11.21470 batch_time=0.37244 
Train Epoch: 8 [686/1000 21952/32000 (69%)] Loss: 1.01556 (QuantReg: 11.43442) QuantErr: 11.43442 batch_time=0.40495 
Train Epoch: 8 [691/1000 22112/32000 (69%)] Loss: 1.32605 (QuantReg: 11.75224) QuantErr: 11.75224 batch_time=0.42891 
Train Epoch: 8 [696/1000 22272/32000 (70%)] Loss: 0.69921 (QuantReg: 12.05140) QuantErr: 12.05140 batch_time=0.41897 
Train Epoch: 8 [701/1000 22432/32000 (70%)] Loss: 1.02856 (QuantReg: 11.88932) QuantErr: 11.88932 batch_time=0.37463 
Train Epoch: 8 [706/1000 22592/32000 (71%)] Loss: 0.94688 (QuantReg: 11.74032) QuantErr: 11.74032 batch_time=0.56933 
Train Epoch: 8 [711/1000 22752/32000 (71%)] Loss: 1.01056 (QuantReg: 11.86983) QuantErr: 11.86983 batch_time=0.37210 
Train Epoch: 8 [716/1000 22912/32000 (72%)] Loss: 0.70912 (QuantReg: 11.85032) QuantErr: 11.85032 batch_time=0.34977 
Train Epoch: 8 [721/1000 23072/32000 (72%)] Loss: 0.49621 (QuantReg: 12.11884) QuantErr: 12.11884 batch_time=1.09969 
Train Epoch: 8 [726/1000 23232/32000 (73%)] Loss: 1.52240 (QuantReg: 11.67437) QuantErr: 11.67437 batch_time=0.34555 
Train Epoch: 8 [731/1000 23392/32000 (73%)] Loss: 0.20387 (QuantReg: 12.15578) QuantErr: 12.15578 batch_time=0.34274 
Train Epoch: 8 [736/1000 23552/32000 (74%)] Loss: 0.57070 (QuantReg: 11.77805) QuantErr: 11.77805 batch_time=0.35455 
Train Epoch: 8 [741/1000 23712/32000 (74%)] Loss: 0.96941 (QuantReg: 12.34084) QuantErr: 12.34084 batch_time=0.34528 
Train Epoch: 8 [746/1000 23872/32000 (75%)] Loss: 0.67336 (QuantReg: 11.71680) QuantErr: 11.71680 batch_time=0.34788 
Train Epoch: 8 [751/1000 24032/32000 (75%)] Loss: 0.69236 (QuantReg: 11.72946) QuantErr: 11.72946 batch_time=0.40288 
Train Epoch: 8 [756/1000 24192/32000 (76%)] Loss: 1.50370 (QuantReg: 11.53103) QuantErr: 11.53103 batch_time=0.37625 
Train Epoch: 8 [761/1000 24352/32000 (76%)] Loss: 1.24382 (QuantReg: 11.37978) QuantErr: 11.37978 batch_time=0.35686 
Train Epoch: 8 [766/1000 24512/32000 (77%)] Loss: 0.80410 (QuantReg: 11.87249) QuantErr: 11.87249 batch_time=0.38020 
Train Epoch: 8 [771/1000 24672/32000 (77%)] Loss: 0.56881 (QuantReg: 12.10135) QuantErr: 12.10135 batch_time=0.34487 
Train Epoch: 8 [776/1000 24832/32000 (78%)] Loss: 1.32155 (QuantReg: 12.17973) QuantErr: 12.17973 batch_time=0.35089 
Train Epoch: 8 [781/1000 24992/32000 (78%)] Loss: 0.56030 (QuantReg: 12.24795) QuantErr: 12.24795 batch_time=0.34225 
Train Epoch: 8 [786/1000 25152/32000 (79%)] Loss: 0.73470 (QuantReg: 11.44009) QuantErr: 11.44009 batch_time=0.42365 
Train Epoch: 8 [791/1000 25312/32000 (79%)] Loss: 0.89056 (QuantReg: 12.17678) QuantErr: 12.17678 batch_time=0.34414 
Train Epoch: 8 [796/1000 25472/32000 (80%)] Loss: 0.40378 (QuantReg: 12.24434) QuantErr: 12.24434 batch_time=0.34948 
Train Epoch: 8 [801/1000 25632/32000 (80%)] Loss: 0.96181 (QuantReg: 11.73191) QuantErr: 11.73191 batch_time=0.34116 
Train Epoch: 8 [806/1000 25792/32000 (81%)] Loss: 1.12987 (QuantReg: 11.91211) QuantErr: 11.91211 batch_time=0.37107 
Train Epoch: 8 [811/1000 25952/32000 (81%)] Loss: 0.87745 (QuantReg: 12.17382) QuantErr: 12.17382 batch_time=0.34477 
Train Epoch: 8 [816/1000 26112/32000 (82%)] Loss: 0.59599 (QuantReg: 11.80129) QuantErr: 11.80129 batch_time=0.34160 
Train Epoch: 8 [821/1000 26272/32000 (82%)] Loss: 0.77130 (QuantReg: 12.08536) QuantErr: 12.08536 batch_time=0.37882 
Train Epoch: 8 [826/1000 26432/32000 (83%)] Loss: 0.40203 (QuantReg: 11.83828) QuantErr: 11.83828 batch_time=0.34433 
Train Epoch: 8 [831/1000 26592/32000 (83%)] Loss: 0.51054 (QuantReg: 11.76763) QuantErr: 11.76763 batch_time=0.33869 
Train Epoch: 8 [836/1000 26752/32000 (84%)] Loss: 0.28440 (QuantReg: 12.24021) QuantErr: 12.24021 batch_time=0.37691 
Train Epoch: 8 [841/1000 26912/32000 (84%)] Loss: 0.95110 (QuantReg: 11.51238) QuantErr: 11.51238 batch_time=0.42630 
Train Epoch: 8 [846/1000 27072/32000 (85%)] Loss: 0.57871 (QuantReg: 12.05723) QuantErr: 12.05723 batch_time=0.34879 
Train Epoch: 8 [851/1000 27232/32000 (85%)] Loss: 0.80101 (QuantReg: 11.32123) QuantErr: 11.32123 batch_time=0.34642 
Train Epoch: 8 [856/1000 27392/32000 (86%)] Loss: 0.70372 (QuantReg: 11.82314) QuantErr: 11.82314 batch_time=0.39571 
Train Epoch: 8 [861/1000 27552/32000 (86%)] Loss: 0.75731 (QuantReg: 12.03359) QuantErr: 12.03359 batch_time=0.34749 
Train Epoch: 8 [866/1000 27712/32000 (87%)] Loss: 0.82831 (QuantReg: 12.03650) QuantErr: 12.03650 batch_time=0.34754 
Train Epoch: 8 [871/1000 27872/32000 (87%)] Loss: 1.07697 (QuantReg: 12.27155) QuantErr: 12.27155 batch_time=0.34730 
Train Epoch: 8 [876/1000 28032/32000 (88%)] Loss: 1.22198 (QuantReg: 12.10909) QuantErr: 12.10909 batch_time=0.36960 
Train Epoch: 8 [881/1000 28192/32000 (88%)] Loss: 0.57505 (QuantReg: 13.03952) QuantErr: 13.03952 batch_time=0.37453 
Train Epoch: 8 [886/1000 28352/32000 (89%)] Loss: 0.98857 (QuantReg: 11.66448) QuantErr: 11.66448 batch_time=0.34523 
Train Epoch: 8 [891/1000 28512/32000 (89%)] Loss: 1.23999 (QuantReg: 12.70042) QuantErr: 12.70042 batch_time=0.34848 
Train Epoch: 8 [896/1000 28672/32000 (90%)] Loss: 0.61983 (QuantReg: 11.80203) QuantErr: 11.80203 batch_time=0.34988 
Train Epoch: 8 [901/1000 28832/32000 (90%)] Loss: 0.89074 (QuantReg: 12.18974) QuantErr: 12.18974 batch_time=0.41998 
Train Epoch: 8 [906/1000 28992/32000 (91%)] Loss: 1.00515 (QuantReg: 12.73760) QuantErr: 12.73760 batch_time=0.38703 
Train Epoch: 8 [911/1000 29152/32000 (91%)] Loss: 0.66033 (QuantReg: 12.30568) QuantErr: 12.30568 batch_time=0.36840 
Train Epoch: 8 [916/1000 29312/32000 (92%)] Loss: 0.71247 (QuantReg: 11.83212) QuantErr: 11.83212 batch_time=0.36317 
Train Epoch: 8 [921/1000 29472/32000 (92%)] Loss: 0.78501 (QuantReg: 12.00324) QuantErr: 12.00324 batch_time=0.37466 
Train Epoch: 8 [926/1000 29632/32000 (93%)] Loss: 1.23404 (QuantReg: 12.35188) QuantErr: 12.35188 batch_time=0.41582 
Train Epoch: 8 [931/1000 29792/32000 (93%)] Loss: 1.10498 (QuantReg: 11.89081) QuantErr: 11.89081 batch_time=0.34836 
Train Epoch: 8 [936/1000 29952/32000 (94%)] Loss: 0.49963 (QuantReg: 12.53139) QuantErr: 12.53139 batch_time=0.43098 
Train Epoch: 8 [941/1000 30112/32000 (94%)] Loss: 0.57774 (QuantReg: 11.14019) QuantErr: 11.14019 batch_time=0.36379 
Train Epoch: 8 [946/1000 30272/32000 (95%)] Loss: 0.66572 (QuantReg: 12.47313) QuantErr: 12.47313 batch_time=0.42796 
Train Epoch: 8 [951/1000 30432/32000 (95%)] Loss: 0.59590 (QuantReg: 11.98868) QuantErr: 11.98868 batch_time=0.37453 
Train Epoch: 8 [956/1000 30592/32000 (96%)] Loss: 1.16062 (QuantReg: 11.76933) QuantErr: 11.76933 batch_time=0.36640 
Train Epoch: 8 [961/1000 30752/32000 (96%)] Loss: 0.80182 (QuantReg: 11.91656) QuantErr: 11.91656 batch_time=0.40934 
Train Epoch: 8 [966/1000 30912/32000 (97%)] Loss: 0.80364 (QuantReg: 12.71233) QuantErr: 12.71233 batch_time=0.35272 
Train Epoch: 8 [971/1000 31072/32000 (97%)] Loss: 0.82777 (QuantReg: 12.02459) QuantErr: 12.02459 batch_time=0.34054 
Train Epoch: 8 [976/1000 31232/32000 (98%)] Loss: 0.81885 (QuantReg: 13.23415) QuantErr: 13.23415 batch_time=1.20847 
Train Epoch: 8 [981/1000 31392/32000 (98%)] Loss: 0.37886 (QuantReg: 12.70697) QuantErr: 12.70697 batch_time=0.43671 
Train Epoch: 8 [986/1000 31552/32000 (99%)] Loss: 1.06785 (QuantReg: 11.75028) QuantErr: 11.75028 batch_time=0.39061 
Train Epoch: 8 [991/1000 31712/32000 (99%)] Loss: 0.71234 (QuantReg: 12.44382) QuantErr: 12.44382 batch_time=0.37510 
Train Epoch: 8 [996/1000 31872/32000 (100%)] Loss: 1.02170 (QuantReg: 12.09063) QuantErr: 12.09063 batch_time=0.37239 
Train Epoch: 8 codebook_update_time=1.83074
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch8.pth ...
Done in 4.695s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch8.pth ...
Done in 9.512s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 0.8734729648381472
 quant_reg      : 11.803356335639954
 quant_err      : 11.803356335639954
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 8000
 MSRVTT_full_val/t2v_metrics/R1: 27.766599597585515
 MSRVTT_full_val/t2v_metrics/R5: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.571428571428571
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.22084511436677
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 70.82494969818913
 MSRVTT_full_val/v2t_metrics/R10: 80.48289738430583
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.627766599597585
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.348976095478776
 MSRVTT_full_test/t2v_metrics/R1: 10.468227424749164
 MSRVTT_full_test/t2v_metrics/R5: 30.903010033444815
 MSRVTT_full_test/t2v_metrics/R10: 44.381270903010034
 MSRVTT_full_test/t2v_metrics/R50: 78.22742474916387
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.903010033444815
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.304753579593697
 MSRVTT_full_test/v2t_metrics/R1: 10.668896321070234
 MSRVTT_full_test/v2t_metrics/R5: 34.31438127090301
 MSRVTT_full_test/v2t_metrics/R10: 48.49498327759197
 MSRVTT_full_test/v2t_metrics/R50: 82.64214046822742
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.329765886287625
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.087401785358793
 mnt_best       : 24.304753579593697
 not_improved_count: 0
Train Epoch: 9 [1/1000 32/32000 (0%)] Loss: 0.33688 (QuantReg: 11.28283) QuantErr: 11.28283 batch_time=26.47007 
Train Epoch: 9 [6/1000 192/32000 (1%)] Loss: 0.52557 (QuantReg: 11.79414) QuantErr: 11.79414 batch_time=0.38768 
Train Epoch: 9 [11/1000 352/32000 (1%)] Loss: 1.36497 (QuantReg: 11.39223) QuantErr: 11.39223 batch_time=0.35915 
Train Epoch: 9 [16/1000 512/32000 (2%)] Loss: 0.52706 (QuantReg: 11.40243) QuantErr: 11.40243 batch_time=0.38405 
Train Epoch: 9 [21/1000 672/32000 (2%)] Loss: 0.55636 (QuantReg: 11.14583) QuantErr: 11.14583 batch_time=0.34411 
Train Epoch: 9 [26/1000 832/32000 (3%)] Loss: 1.19459 (QuantReg: 10.65292) QuantErr: 10.65292 batch_time=0.34811 
Train Epoch: 9 [31/1000 992/32000 (3%)] Loss: 0.53090 (QuantReg: 12.24639) QuantErr: 12.24639 batch_time=0.35393 
Train Epoch: 9 [36/1000 1152/32000 (4%)] Loss: 1.45685 (QuantReg: 11.69393) QuantErr: 11.69393 batch_time=0.36233 
Train Epoch: 9 [41/1000 1312/32000 (4%)] Loss: 1.35633 (QuantReg: 12.08757) QuantErr: 12.08757 batch_time=0.34915 
Train Epoch: 9 [46/1000 1472/32000 (5%)] Loss: 0.65883 (QuantReg: 11.28240) QuantErr: 11.28240 batch_time=0.35239 
Train Epoch: 9 [51/1000 1632/32000 (5%)] Loss: 0.89010 (QuantReg: 11.85518) QuantErr: 11.85518 batch_time=0.34864 
Train Epoch: 9 [56/1000 1792/32000 (6%)] Loss: 1.47207 (QuantReg: 12.26227) QuantErr: 12.26227 batch_time=0.34703 
Train Epoch: 9 [61/1000 1952/32000 (6%)] Loss: 0.90644 (QuantReg: 11.74774) QuantErr: 11.74774 batch_time=0.41418 
Train Epoch: 9 [66/1000 2112/32000 (7%)] Loss: 0.56054 (QuantReg: 12.14882) QuantErr: 12.14882 batch_time=0.49806 
Train Epoch: 9 [71/1000 2272/32000 (7%)] Loss: 0.59850 (QuantReg: 11.63544) QuantErr: 11.63544 batch_time=0.48195 
Train Epoch: 9 [76/1000 2432/32000 (8%)] Loss: 0.39464 (QuantReg: 11.82576) QuantErr: 11.82576 batch_time=0.35016 
Train Epoch: 9 [81/1000 2592/32000 (8%)] Loss: 0.72510 (QuantReg: 12.41549) QuantErr: 12.41549 batch_time=0.49934 
Train Epoch: 9 [86/1000 2752/32000 (9%)] Loss: 0.69544 (QuantReg: 11.86157) QuantErr: 11.86157 batch_time=0.40433 
Train Epoch: 9 [91/1000 2912/32000 (9%)] Loss: 0.93217 (QuantReg: 10.98943) QuantErr: 10.98943 batch_time=0.34754 
Train Epoch: 9 [96/1000 3072/32000 (10%)] Loss: 0.60861 (QuantReg: 11.47421) QuantErr: 11.47421 batch_time=0.34652 
Train Epoch: 9 [101/1000 3232/32000 (10%)] Loss: 1.46745 (QuantReg: 12.04642) QuantErr: 12.04642 batch_time=0.35423 
Train Epoch: 9 [106/1000 3392/32000 (11%)] Loss: 0.61582 (QuantReg: 11.60070) QuantErr: 11.60070 batch_time=0.36109 
Train Epoch: 9 [111/1000 3552/32000 (11%)] Loss: 0.84913 (QuantReg: 11.82670) QuantErr: 11.82670 batch_time=0.36704 
Train Epoch: 9 [116/1000 3712/32000 (12%)] Loss: 0.61622 (QuantReg: 11.80147) QuantErr: 11.80147 batch_time=0.38178 
Train Epoch: 9 [121/1000 3872/32000 (12%)] Loss: 0.93689 (QuantReg: 11.03237) QuantErr: 11.03237 batch_time=0.35056 
Train Epoch: 9 [126/1000 4032/32000 (13%)] Loss: 0.72001 (QuantReg: 11.60426) QuantErr: 11.60426 batch_time=0.37044 
Train Epoch: 9 [131/1000 4192/32000 (13%)] Loss: 1.58411 (QuantReg: 11.05993) QuantErr: 11.05993 batch_time=0.35198 
Train Epoch: 9 [136/1000 4352/32000 (14%)] Loss: 1.57243 (QuantReg: 12.21413) QuantErr: 12.21413 batch_time=0.37159 
Train Epoch: 9 [141/1000 4512/32000 (14%)] Loss: 0.37672 (QuantReg: 11.90411) QuantErr: 11.90411 batch_time=0.34219 
Train Epoch: 9 [146/1000 4672/32000 (15%)] Loss: 1.06814 (QuantReg: 11.54172) QuantErr: 11.54172 batch_time=0.34047 
Train Epoch: 9 [151/1000 4832/32000 (15%)] Loss: 1.33656 (QuantReg: 11.32824) QuantErr: 11.32824 batch_time=1.19412 
Train Epoch: 9 [156/1000 4992/32000 (16%)] Loss: 0.52575 (QuantReg: 12.24241) QuantErr: 12.24241 batch_time=0.39650 
Train Epoch: 9 [161/1000 5152/32000 (16%)] Loss: 0.35265 (QuantReg: 12.17260) QuantErr: 12.17260 batch_time=0.36275 
Train Epoch: 9 [166/1000 5312/32000 (17%)] Loss: 0.86659 (QuantReg: 11.58301) QuantErr: 11.58301 batch_time=0.41761 
Train Epoch: 9 [171/1000 5472/32000 (17%)] Loss: 0.61843 (QuantReg: 11.99906) QuantErr: 11.99906 batch_time=0.34254 
Train Epoch: 9 [176/1000 5632/32000 (18%)] Loss: 0.40115 (QuantReg: 11.46011) QuantErr: 11.46011 batch_time=0.38737 
Train Epoch: 9 [181/1000 5792/32000 (18%)] Loss: 0.53927 (QuantReg: 11.85730) QuantErr: 11.85730 batch_time=0.35561 
Train Epoch: 9 [186/1000 5952/32000 (19%)] Loss: 1.42651 (QuantReg: 12.17829) QuantErr: 12.17829 batch_time=0.36283 
Train Epoch: 9 [191/1000 6112/32000 (19%)] Loss: 0.35309 (QuantReg: 11.31545) QuantErr: 11.31545 batch_time=0.36699 
Train Epoch: 9 [196/1000 6272/32000 (20%)] Loss: 0.98449 (QuantReg: 12.33720) QuantErr: 12.33720 batch_time=0.37018 
Train Epoch: 9 [201/1000 6432/32000 (20%)] Loss: 0.79073 (QuantReg: 12.24528) QuantErr: 12.24528 batch_time=0.34916 
Train Epoch: 9 [206/1000 6592/32000 (21%)] Loss: 0.93799 (QuantReg: 11.69362) QuantErr: 11.69362 batch_time=0.38499 
Train Epoch: 9 [211/1000 6752/32000 (21%)] Loss: 0.86461 (QuantReg: 12.54108) QuantErr: 12.54108 batch_time=0.34365 
Train Epoch: 9 [216/1000 6912/32000 (22%)] Loss: 0.61617 (QuantReg: 11.89173) QuantErr: 11.89173 batch_time=0.34361 
Train Epoch: 9 [221/1000 7072/32000 (22%)] Loss: 0.63071 (QuantReg: 13.00307) QuantErr: 13.00307 batch_time=0.34064 
Train Epoch: 9 [226/1000 7232/32000 (23%)] Loss: 1.44709 (QuantReg: 11.67269) QuantErr: 11.67269 batch_time=0.35588 
Train Epoch: 9 [231/1000 7392/32000 (23%)] Loss: 0.90219 (QuantReg: 11.20463) QuantErr: 11.20463 batch_time=0.34497 
Train Epoch: 9 [236/1000 7552/32000 (24%)] Loss: 0.77189 (QuantReg: 11.78280) QuantErr: 11.78280 batch_time=0.35863 
Train Epoch: 9 [241/1000 7712/32000 (24%)] Loss: 0.70848 (QuantReg: 12.13160) QuantErr: 12.13160 batch_time=0.39121 
Train Epoch: 9 [246/1000 7872/32000 (25%)] Loss: 0.58198 (QuantReg: 12.40009) QuantErr: 12.40009 batch_time=0.34162 
Train Epoch: 9 [251/1000 8032/32000 (25%)] Loss: 0.51938 (QuantReg: 12.43500) QuantErr: 12.43500 batch_time=0.43800 
Train Epoch: 9 [256/1000 8192/32000 (26%)] Loss: 1.17499 (QuantReg: 11.42407) QuantErr: 11.42407 batch_time=0.35169 
Train Epoch: 9 [261/1000 8352/32000 (26%)] Loss: 1.03371 (QuantReg: 11.83615) QuantErr: 11.83615 batch_time=0.36159 
Train Epoch: 9 [266/1000 8512/32000 (27%)] Loss: 0.59020 (QuantReg: 11.43147) QuantErr: 11.43147 batch_time=0.34526 
Train Epoch: 9 [271/1000 8672/32000 (27%)] Loss: 0.81370 (QuantReg: 11.79887) QuantErr: 11.79887 batch_time=0.37198 
Train Epoch: 9 [276/1000 8832/32000 (28%)] Loss: 0.44725 (QuantReg: 11.27683) QuantErr: 11.27683 batch_time=0.79177 
Train Epoch: 9 [281/1000 8992/32000 (28%)] Loss: 0.78558 (QuantReg: 11.70947) QuantErr: 11.70947 batch_time=0.33988 
Train Epoch: 9 [286/1000 9152/32000 (29%)] Loss: 0.49872 (QuantReg: 12.80632) QuantErr: 12.80632 batch_time=0.34599 
Train Epoch: 9 [291/1000 9312/32000 (29%)] Loss: 0.47735 (QuantReg: 11.98544) QuantErr: 11.98544 batch_time=0.34128 
Train Epoch: 9 [296/1000 9472/32000 (30%)] Loss: 1.18100 (QuantReg: 11.33595) QuantErr: 11.33595 batch_time=0.36234 
Train Epoch: 9 [301/1000 9632/32000 (30%)] Loss: 0.60441 (QuantReg: 11.59490) QuantErr: 11.59490 batch_time=0.39068 
Train Epoch: 9 [306/1000 9792/32000 (31%)] Loss: 0.48866 (QuantReg: 11.77974) QuantErr: 11.77974 batch_time=0.36636 
Train Epoch: 9 [311/1000 9952/32000 (31%)] Loss: 0.44382 (QuantReg: 12.64863) QuantErr: 12.64863 batch_time=0.36079 
Train Epoch: 9 [316/1000 10112/32000 (32%)] Loss: 1.40463 (QuantReg: 12.27566) QuantErr: 12.27566 batch_time=0.39913 
Train Epoch: 9 [321/1000 10272/32000 (32%)] Loss: 0.80130 (QuantReg: 11.55594) QuantErr: 11.55594 batch_time=0.34591 
Train Epoch: 9 [326/1000 10432/32000 (33%)] Loss: 1.02870 (QuantReg: 12.18818) QuantErr: 12.18818 batch_time=0.34306 
Train Epoch: 9 [331/1000 10592/32000 (33%)] Loss: 1.31921 (QuantReg: 11.35085) QuantErr: 11.35085 batch_time=0.34850 
Train Epoch: 9 [336/1000 10752/32000 (34%)] Loss: 1.29967 (QuantReg: 11.66935) QuantErr: 11.66935 batch_time=0.41070 
Train Epoch: 9 [341/1000 10912/32000 (34%)] Loss: 0.87804 (QuantReg: 11.26016) QuantErr: 11.26016 batch_time=0.34438 
Train Epoch: 9 [346/1000 11072/32000 (35%)] Loss: 0.65152 (QuantReg: 11.51262) QuantErr: 11.51262 batch_time=0.34957 
Train Epoch: 9 [351/1000 11232/32000 (35%)] Loss: 0.39197 (QuantReg: 11.85958) QuantErr: 11.85958 batch_time=0.41751 
Train Epoch: 9 [356/1000 11392/32000 (36%)] Loss: 0.70738 (QuantReg: 11.58849) QuantErr: 11.58849 batch_time=0.36513 
Train Epoch: 9 [361/1000 11552/32000 (36%)] Loss: 0.83216 (QuantReg: 11.37006) QuantErr: 11.37006 batch_time=0.34231 
Train Epoch: 9 [366/1000 11712/32000 (37%)] Loss: 0.56088 (QuantReg: 12.56380) QuantErr: 12.56380 batch_time=0.39978 
Train Epoch: 9 [371/1000 11872/32000 (37%)] Loss: 1.16391 (QuantReg: 11.48233) QuantErr: 11.48233 batch_time=0.39602 
Train Epoch: 9 [376/1000 12032/32000 (38%)] Loss: 0.85933 (QuantReg: 11.47949) QuantErr: 11.47949 batch_time=0.35816 
Train Epoch: 9 [381/1000 12192/32000 (38%)] Loss: 0.80999 (QuantReg: 11.30235) QuantErr: 11.30235 batch_time=0.34411 
Train Epoch: 9 [386/1000 12352/32000 (39%)] Loss: 1.03660 (QuantReg: 11.72718) QuantErr: 11.72718 batch_time=0.49468 
Train Epoch: 9 [391/1000 12512/32000 (39%)] Loss: 0.51609 (QuantReg: 11.85624) QuantErr: 11.85624 batch_time=0.53327 
Train Epoch: 9 [396/1000 12672/32000 (40%)] Loss: 2.01296 (QuantReg: 11.74273) QuantErr: 11.74273 batch_time=0.36080 
Train Epoch: 9 [401/1000 12832/32000 (40%)] Loss: 1.71102 (QuantReg: 11.90624) QuantErr: 11.90624 batch_time=0.51188 
Train Epoch: 9 [406/1000 12992/32000 (41%)] Loss: 0.92815 (QuantReg: 11.44807) QuantErr: 11.44807 batch_time=0.34591 
Train Epoch: 9 [411/1000 13152/32000 (41%)] Loss: 0.64949 (QuantReg: 11.15525) QuantErr: 11.15525 batch_time=0.35041 
Train Epoch: 9 [416/1000 13312/32000 (42%)] Loss: 0.64100 (QuantReg: 11.66662) QuantErr: 11.66662 batch_time=0.36712 
Train Epoch: 9 [421/1000 13472/32000 (42%)] Loss: 0.87375 (QuantReg: 11.71789) QuantErr: 11.71789 batch_time=0.44244 
Train Epoch: 9 [426/1000 13632/32000 (43%)] Loss: 0.56678 (QuantReg: 12.48173) QuantErr: 12.48173 batch_time=0.35701 
Train Epoch: 9 [431/1000 13792/32000 (43%)] Loss: 0.53215 (QuantReg: 11.84909) QuantErr: 11.84909 batch_time=0.37982 
Train Epoch: 9 [436/1000 13952/32000 (44%)] Loss: 1.08186 (QuantReg: 11.97294) QuantErr: 11.97294 batch_time=0.37858 
Train Epoch: 9 [441/1000 14112/32000 (44%)] Loss: 1.07656 (QuantReg: 11.70890) QuantErr: 11.70890 batch_time=0.34689 
Train Epoch: 9 [446/1000 14272/32000 (45%)] Loss: 0.77954 (QuantReg: 11.89515) QuantErr: 11.89515 batch_time=0.34512 
Train Epoch: 9 [451/1000 14432/32000 (45%)] Loss: 1.28654 (QuantReg: 11.28801) QuantErr: 11.28801 batch_time=0.34959 
Train Epoch: 9 [456/1000 14592/32000 (46%)] Loss: 1.02154 (QuantReg: 11.66463) QuantErr: 11.66463 batch_time=0.34062 
Train Epoch: 9 [461/1000 14752/32000 (46%)] Loss: 0.58130 (QuantReg: 12.19809) QuantErr: 12.19809 batch_time=0.34446 
Train Epoch: 9 [466/1000 14912/32000 (47%)] Loss: 0.24392 (QuantReg: 12.27222) QuantErr: 12.27222 batch_time=0.35492 
Train Epoch: 9 [471/1000 15072/32000 (47%)] Loss: 0.45072 (QuantReg: 11.59575) QuantErr: 11.59575 batch_time=1.13416 
Train Epoch: 9 [476/1000 15232/32000 (48%)] Loss: 0.68301 (QuantReg: 12.17728) QuantErr: 12.17728 batch_time=0.35722 
Train Epoch: 9 [481/1000 15392/32000 (48%)] Loss: 0.67569 (QuantReg: 12.30568) QuantErr: 12.30568 batch_time=0.40506 
Train Epoch: 9 [486/1000 15552/32000 (49%)] Loss: 0.84646 (QuantReg: 11.54644) QuantErr: 11.54644 batch_time=0.52396 
Train Epoch: 9 [491/1000 15712/32000 (49%)] Loss: 1.49093 (QuantReg: 11.92387) QuantErr: 11.92387 batch_time=0.35613 
Train Epoch: 9 [496/1000 15872/32000 (50%)] Loss: 0.68898 (QuantReg: 11.95265) QuantErr: 11.95265 batch_time=0.35146 
Train Epoch: 9 [501/1000 16032/32000 (50%)] Loss: 0.93607 (QuantReg: 12.31799) QuantErr: 12.31799 batch_time=0.36714 
Train Epoch: 9 [506/1000 16192/32000 (51%)] Loss: 0.82018 (QuantReg: 11.98686) QuantErr: 11.98686 batch_time=0.35658 
Train Epoch: 9 [511/1000 16352/32000 (51%)] Loss: 1.16985 (QuantReg: 12.79023) QuantErr: 12.79023 batch_time=0.37417 
Train Epoch: 9 [516/1000 16512/32000 (52%)] Loss: 1.32034 (QuantReg: 12.44921) QuantErr: 12.44921 batch_time=0.38363 
Train Epoch: 9 [521/1000 16672/32000 (52%)] Loss: 0.83779 (QuantReg: 11.47367) QuantErr: 11.47367 batch_time=0.36357 
Train Epoch: 9 [526/1000 16832/32000 (53%)] Loss: 0.98828 (QuantReg: 11.45332) QuantErr: 11.45332 batch_time=0.34950 
Train Epoch: 9 [531/1000 16992/32000 (53%)] Loss: 0.60665 (QuantReg: 12.71532) QuantErr: 12.71532 batch_time=0.41412 
Train Epoch: 9 [536/1000 17152/32000 (54%)] Loss: 0.92508 (QuantReg: 12.10609) QuantErr: 12.10609 batch_time=0.42306 
Train Epoch: 9 [541/1000 17312/32000 (54%)] Loss: 0.81978 (QuantReg: 11.78410) QuantErr: 11.78410 batch_time=0.46691 
Train Epoch: 9 [546/1000 17472/32000 (55%)] Loss: 0.77770 (QuantReg: 11.49502) QuantErr: 11.49502 batch_time=0.42025 
Train Epoch: 9 [551/1000 17632/32000 (55%)] Loss: 0.46472 (QuantReg: 12.29715) QuantErr: 12.29715 batch_time=0.34938 
Train Epoch: 9 [556/1000 17792/32000 (56%)] Loss: 0.99465 (QuantReg: 11.00258) QuantErr: 11.00258 batch_time=0.41646 
Train Epoch: 9 [561/1000 17952/32000 (56%)] Loss: 0.33876 (QuantReg: 11.95958) QuantErr: 11.95958 batch_time=0.36808 
Train Epoch: 9 [566/1000 18112/32000 (57%)] Loss: 0.89249 (QuantReg: 11.95245) QuantErr: 11.95245 batch_time=0.35732 
Train Epoch: 9 [571/1000 18272/32000 (57%)] Loss: 0.78088 (QuantReg: 11.70959) QuantErr: 11.70959 batch_time=0.44326 
Train Epoch: 9 [576/1000 18432/32000 (58%)] Loss: 0.53294 (QuantReg: 12.55490) QuantErr: 12.55490 batch_time=0.34782 
Train Epoch: 9 [581/1000 18592/32000 (58%)] Loss: 1.40454 (QuantReg: 11.75457) QuantErr: 11.75457 batch_time=0.34575 
Train Epoch: 9 [586/1000 18752/32000 (59%)] Loss: 1.02358 (QuantReg: 12.27892) QuantErr: 12.27892 batch_time=0.35753 
Train Epoch: 9 [591/1000 18912/32000 (59%)] Loss: 0.72979 (QuantReg: 12.35618) QuantErr: 12.35618 batch_time=0.37870 
Train Epoch: 9 [596/1000 19072/32000 (60%)] Loss: 0.64900 (QuantReg: 12.39904) QuantErr: 12.39904 batch_time=0.79942 
Train Epoch: 9 [601/1000 19232/32000 (60%)] Loss: 0.67732 (QuantReg: 11.31572) QuantErr: 11.31572 batch_time=0.36201 
Train Epoch: 9 [606/1000 19392/32000 (61%)] Loss: 0.80930 (QuantReg: 11.75791) QuantErr: 11.75791 batch_time=0.39866 
Train Epoch: 9 [611/1000 19552/32000 (61%)] Loss: 0.80396 (QuantReg: 11.64616) QuantErr: 11.64616 batch_time=0.44130 
Train Epoch: 9 [616/1000 19712/32000 (62%)] Loss: 1.24050 (QuantReg: 11.77716) QuantErr: 11.77716 batch_time=0.38999 
Train Epoch: 9 [621/1000 19872/32000 (62%)] Loss: 1.49457 (QuantReg: 10.83871) QuantErr: 10.83871 batch_time=0.39768 
Train Epoch: 9 [626/1000 20032/32000 (63%)] Loss: 1.14513 (QuantReg: 11.35986) QuantErr: 11.35986 batch_time=0.34750 
Train Epoch: 9 [631/1000 20192/32000 (63%)] Loss: 1.07681 (QuantReg: 12.04822) QuantErr: 12.04822 batch_time=0.39445 
Train Epoch: 9 [636/1000 20352/32000 (64%)] Loss: 0.65381 (QuantReg: 12.20716) QuantErr: 12.20716 batch_time=0.38968 
Train Epoch: 9 [641/1000 20512/32000 (64%)] Loss: 0.71652 (QuantReg: 11.74290) QuantErr: 11.74290 batch_time=0.38547 
Train Epoch: 9 [646/1000 20672/32000 (65%)] Loss: 0.67343 (QuantReg: 12.27038) QuantErr: 12.27038 batch_time=0.40270 
Train Epoch: 9 [651/1000 20832/32000 (65%)] Loss: 0.71940 (QuantReg: 11.08514) QuantErr: 11.08514 batch_time=0.34167 
Train Epoch: 9 [656/1000 20992/32000 (66%)] Loss: 0.85339 (QuantReg: 12.09094) QuantErr: 12.09094 batch_time=0.35764 
Train Epoch: 9 [661/1000 21152/32000 (66%)] Loss: 0.87676 (QuantReg: 11.72733) QuantErr: 11.72733 batch_time=0.40405 
Train Epoch: 9 [666/1000 21312/32000 (67%)] Loss: 0.51220 (QuantReg: 11.70234) QuantErr: 11.70234 batch_time=0.42596 
Train Epoch: 9 [671/1000 21472/32000 (67%)] Loss: 0.74390 (QuantReg: 12.56788) QuantErr: 12.56788 batch_time=0.38114 
Train Epoch: 9 [676/1000 21632/32000 (68%)] Loss: 0.46918 (QuantReg: 12.35880) QuantErr: 12.35880 batch_time=0.38862 
Train Epoch: 9 [681/1000 21792/32000 (68%)] Loss: 0.76710 (QuantReg: 11.18184) QuantErr: 11.18184 batch_time=0.34799 
Train Epoch: 9 [686/1000 21952/32000 (69%)] Loss: 0.54732 (QuantReg: 12.41352) QuantErr: 12.41352 batch_time=0.35920 
Train Epoch: 9 [691/1000 22112/32000 (69%)] Loss: 0.56681 (QuantReg: 11.93784) QuantErr: 11.93784 batch_time=0.35293 
Train Epoch: 9 [696/1000 22272/32000 (70%)] Loss: 0.55204 (QuantReg: 12.07520) QuantErr: 12.07520 batch_time=0.35089 
Train Epoch: 9 [701/1000 22432/32000 (70%)] Loss: 0.85186 (QuantReg: 11.58278) QuantErr: 11.58278 batch_time=0.39363 
Train Epoch: 9 [706/1000 22592/32000 (71%)] Loss: 0.21576 (QuantReg: 12.06503) QuantErr: 12.06503 batch_time=0.52916 
Train Epoch: 9 [711/1000 22752/32000 (71%)] Loss: 0.82737 (QuantReg: 12.20569) QuantErr: 12.20569 batch_time=0.46257 
Train Epoch: 9 [716/1000 22912/32000 (72%)] Loss: 0.63044 (QuantReg: 12.81471) QuantErr: 12.81471 batch_time=0.33972 
Train Epoch: 9 [721/1000 23072/32000 (72%)] Loss: 0.94473 (QuantReg: 11.92454) QuantErr: 11.92454 batch_time=0.49236 
Train Epoch: 9 [726/1000 23232/32000 (73%)] Loss: 0.43959 (QuantReg: 12.58249) QuantErr: 12.58249 batch_time=0.37476 
Train Epoch: 9 [731/1000 23392/32000 (73%)] Loss: 0.62521 (QuantReg: 12.38379) QuantErr: 12.38379 batch_time=0.33931 
Train Epoch: 9 [736/1000 23552/32000 (74%)] Loss: 1.43602 (QuantReg: 11.82059) QuantErr: 11.82059 batch_time=0.45316 
Train Epoch: 9 [741/1000 23712/32000 (74%)] Loss: 0.72588 (QuantReg: 11.60448) QuantErr: 11.60448 batch_time=0.45923 
Train Epoch: 9 [746/1000 23872/32000 (75%)] Loss: 0.81006 (QuantReg: 12.15549) QuantErr: 12.15549 batch_time=0.41877 
Train Epoch: 9 [751/1000 24032/32000 (75%)] Loss: 0.61615 (QuantReg: 12.13178) QuantErr: 12.13178 batch_time=0.35835 
Train Epoch: 9 [756/1000 24192/32000 (76%)] Loss: 0.55875 (QuantReg: 12.45747) QuantErr: 12.45747 batch_time=0.41517 
Train Epoch: 9 [761/1000 24352/32000 (76%)] Loss: 0.18132 (QuantReg: 11.75953) QuantErr: 11.75953 batch_time=0.35478 
Train Epoch: 9 [766/1000 24512/32000 (77%)] Loss: 0.85913 (QuantReg: 11.60941) QuantErr: 11.60941 batch_time=0.40793 
Train Epoch: 9 [771/1000 24672/32000 (77%)] Loss: 0.85281 (QuantReg: 12.06852) QuantErr: 12.06852 batch_time=0.41961 
Train Epoch: 9 [776/1000 24832/32000 (78%)] Loss: 0.53772 (QuantReg: 12.50195) QuantErr: 12.50195 batch_time=0.42588 
Train Epoch: 9 [781/1000 24992/32000 (78%)] Loss: 0.45877 (QuantReg: 11.58039) QuantErr: 11.58039 batch_time=0.44099 
Train Epoch: 9 [786/1000 25152/32000 (79%)] Loss: 0.44228 (QuantReg: 11.60010) QuantErr: 11.60010 batch_time=0.34720 
Train Epoch: 9 [791/1000 25312/32000 (79%)] Loss: 0.73839 (QuantReg: 11.88482) QuantErr: 11.88482 batch_time=1.33718 
Train Epoch: 9 [796/1000 25472/32000 (80%)] Loss: 1.06485 (QuantReg: 12.10247) QuantErr: 12.10247 batch_time=0.36460 
Train Epoch: 9 [801/1000 25632/32000 (80%)] Loss: 0.81156 (QuantReg: 11.92553) QuantErr: 11.92553 batch_time=0.51259 
Train Epoch: 9 [806/1000 25792/32000 (81%)] Loss: 0.85434 (QuantReg: 12.22488) QuantErr: 12.22488 batch_time=0.51096 
Train Epoch: 9 [811/1000 25952/32000 (81%)] Loss: 0.81028 (QuantReg: 12.27145) QuantErr: 12.27145 batch_time=0.37934 
Train Epoch: 9 [816/1000 26112/32000 (82%)] Loss: 0.47219 (QuantReg: 12.16584) QuantErr: 12.16584 batch_time=0.49321 
Train Epoch: 9 [821/1000 26272/32000 (82%)] Loss: 0.73337 (QuantReg: 11.84485) QuantErr: 11.84485 batch_time=0.39388 
Train Epoch: 9 [826/1000 26432/32000 (83%)] Loss: 0.87899 (QuantReg: 12.06337) QuantErr: 12.06337 batch_time=0.38799 
Train Epoch: 9 [831/1000 26592/32000 (83%)] Loss: 0.84415 (QuantReg: 12.39975) QuantErr: 12.39975 batch_time=0.39688 
Train Epoch: 9 [836/1000 26752/32000 (84%)] Loss: 1.02584 (QuantReg: 11.81584) QuantErr: 11.81584 batch_time=0.43040 
Train Epoch: 9 [841/1000 26912/32000 (84%)] Loss: 0.66643 (QuantReg: 12.51409) QuantErr: 12.51409 batch_time=0.41032 
Train Epoch: 9 [846/1000 27072/32000 (85%)] Loss: 0.48933 (QuantReg: 11.52092) QuantErr: 11.52092 batch_time=0.36240 
Train Epoch: 9 [851/1000 27232/32000 (85%)] Loss: 0.50918 (QuantReg: 11.68567) QuantErr: 11.68567 batch_time=0.38017 
Train Epoch: 9 [856/1000 27392/32000 (86%)] Loss: 1.19844 (QuantReg: 11.53330) QuantErr: 11.53330 batch_time=0.36549 
Train Epoch: 9 [861/1000 27552/32000 (86%)] Loss: 0.54643 (QuantReg: 12.04820) QuantErr: 12.04820 batch_time=0.40739 
Train Epoch: 9 [866/1000 27712/32000 (87%)] Loss: 0.61630 (QuantReg: 12.29830) QuantErr: 12.29830 batch_time=0.42521 
Train Epoch: 9 [871/1000 27872/32000 (87%)] Loss: 1.02358 (QuantReg: 11.63550) QuantErr: 11.63550 batch_time=0.37175 
Train Epoch: 9 [876/1000 28032/32000 (88%)] Loss: 0.37356 (QuantReg: 11.78546) QuantErr: 11.78546 batch_time=0.43178 
Train Epoch: 9 [881/1000 28192/32000 (88%)] Loss: 0.89036 (QuantReg: 12.36824) QuantErr: 12.36824 batch_time=0.34326 
Train Epoch: 9 [886/1000 28352/32000 (89%)] Loss: 0.83979 (QuantReg: 12.17155) QuantErr: 12.17155 batch_time=0.36555 
Train Epoch: 9 [891/1000 28512/32000 (89%)] Loss: 0.67383 (QuantReg: 11.77355) QuantErr: 11.77355 batch_time=0.44801 
Train Epoch: 9 [896/1000 28672/32000 (90%)] Loss: 0.42702 (QuantReg: 12.31819) QuantErr: 12.31819 batch_time=0.35055 
Train Epoch: 9 [901/1000 28832/32000 (90%)] Loss: 0.64424 (QuantReg: 11.84917) QuantErr: 11.84917 batch_time=0.37450 
Train Epoch: 9 [906/1000 28992/32000 (91%)] Loss: 0.37962 (QuantReg: 12.72752) QuantErr: 12.72752 batch_time=0.41535 
Train Epoch: 9 [911/1000 29152/32000 (91%)] Loss: 1.51274 (QuantReg: 12.02993) QuantErr: 12.02993 batch_time=0.36847 
Train Epoch: 9 [916/1000 29312/32000 (92%)] Loss: 0.94868 (QuantReg: 11.42565) QuantErr: 11.42565 batch_time=0.76495 
Train Epoch: 9 [921/1000 29472/32000 (92%)] Loss: 0.55639 (QuantReg: 11.68716) QuantErr: 11.68716 batch_time=0.34243 
Train Epoch: 9 [926/1000 29632/32000 (93%)] Loss: 1.26303 (QuantReg: 11.53184) QuantErr: 11.53184 batch_time=0.39040 
Train Epoch: 9 [931/1000 29792/32000 (93%)] Loss: 1.01655 (QuantReg: 11.53497) QuantErr: 11.53497 batch_time=0.36971 
Train Epoch: 9 [936/1000 29952/32000 (94%)] Loss: 1.21371 (QuantReg: 13.15737) QuantErr: 13.15737 batch_time=0.43519 
Train Epoch: 9 [941/1000 30112/32000 (94%)] Loss: 0.86404 (QuantReg: 11.81639) QuantErr: 11.81639 batch_time=0.48251 
Train Epoch: 9 [946/1000 30272/32000 (95%)] Loss: 1.14502 (QuantReg: 11.62057) QuantErr: 11.62057 batch_time=0.36605 
Train Epoch: 9 [951/1000 30432/32000 (95%)] Loss: 0.25933 (QuantReg: 12.43857) QuantErr: 12.43857 batch_time=0.42304 
Train Epoch: 9 [956/1000 30592/32000 (96%)] Loss: 0.91512 (QuantReg: 11.26940) QuantErr: 11.26940 batch_time=0.37262 
Train Epoch: 9 [961/1000 30752/32000 (96%)] Loss: 0.57884 (QuantReg: 12.18315) QuantErr: 12.18315 batch_time=0.46100 
Train Epoch: 9 [966/1000 30912/32000 (97%)] Loss: 0.89390 (QuantReg: 12.55021) QuantErr: 12.55021 batch_time=0.43988 
Train Epoch: 9 [971/1000 31072/32000 (97%)] Loss: 0.75601 (QuantReg: 11.93286) QuantErr: 11.93286 batch_time=0.39028 
Train Epoch: 9 [976/1000 31232/32000 (98%)] Loss: 0.82367 (QuantReg: 11.38401) QuantErr: 11.38401 batch_time=0.38010 
Train Epoch: 9 [981/1000 31392/32000 (98%)] Loss: 0.65741 (QuantReg: 12.33447) QuantErr: 12.33447 batch_time=0.40272 
Train Epoch: 9 [986/1000 31552/32000 (99%)] Loss: 0.71871 (QuantReg: 11.52346) QuantErr: 11.52346 batch_time=0.35991 
Train Epoch: 9 [991/1000 31712/32000 (99%)] Loss: 1.61854 (QuantReg: 12.23583) QuantErr: 12.23583 batch_time=0.38349 
Train Epoch: 9 [996/1000 31872/32000 (100%)] Loss: 0.59218 (QuantReg: 11.99099) QuantErr: 11.99099 batch_time=0.39859 
Train Epoch: 9 codebook_update_time=1.78922
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch9.pth ...
Done in 21.715s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 0.7954117936342955
 quant_reg      : 11.873730309486389
 quant_err      : 11.873730309486389
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 9000
 MSRVTT_full_val/t2v_metrics/R1: 25.553319919517104
 MSRVTT_full_val/t2v_metrics/R5: 65.59356136820925
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.04225352112676
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.02889047646752
 MSRVTT_full_val/v2t_metrics/R1: 31.99195171026157
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 84.50704225352112
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.396378269617706
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.58306642942229
 MSRVTT_full_test/t2v_metrics/R1: 10.334448160535118
 MSRVTT_full_test/t2v_metrics/R5: 30.76923076923077
 MSRVTT_full_test/t2v_metrics/R10: 44.98327759197324
 MSRVTT_full_test/t2v_metrics/R50: 78.46153846153847
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.21872909698997
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.27457725661684
 MSRVTT_full_test/v2t_metrics/R1: 11.77257525083612
 MSRVTT_full_test/v2t_metrics/R5: 36.25418060200669
 MSRVTT_full_test/v2t_metrics/R10: 50.23411371237458
 MSRVTT_full_test/v2t_metrics/R50: 82.97658862876254
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.095150501672244
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.78067355050041
 mnt_best       : 24.304753579593697
 not_improved_count: 1
Train Epoch: 10 [1/1000 32/32000 (0%)] Loss: 1.40336 (QuantReg: 10.99816) QuantErr: 10.99816 batch_time=27.17363 
Train Epoch: 10 [6/1000 192/32000 (1%)] Loss: 0.80018 (QuantReg: 11.56197) QuantErr: 11.56197 batch_time=0.42790 
Train Epoch: 10 [11/1000 352/32000 (1%)] Loss: 0.78647 (QuantReg: 10.97514) QuantErr: 10.97514 batch_time=0.40978 
Train Epoch: 10 [16/1000 512/32000 (2%)] Loss: 0.91181 (QuantReg: 11.35358) QuantErr: 11.35358 batch_time=0.62409 
Train Epoch: 10 [21/1000 672/32000 (2%)] Loss: 0.71473 (QuantReg: 11.51579) QuantErr: 11.51579 batch_time=0.35192 
Train Epoch: 10 [26/1000 832/32000 (3%)] Loss: 0.12852 (QuantReg: 11.38706) QuantErr: 11.38706 batch_time=0.47603 
Train Epoch: 10 [31/1000 992/32000 (3%)] Loss: 0.97613 (QuantReg: 11.88435) QuantErr: 11.88435 batch_time=0.38221 
Train Epoch: 10 [36/1000 1152/32000 (4%)] Loss: 0.62247 (QuantReg: 11.12700) QuantErr: 11.12700 batch_time=0.38820 
Train Epoch: 10 [41/1000 1312/32000 (4%)] Loss: 0.62272 (QuantReg: 11.91696) QuantErr: 11.91696 batch_time=0.36754 
Train Epoch: 10 [46/1000 1472/32000 (5%)] Loss: 0.31100 (QuantReg: 12.23174) QuantErr: 12.23174 batch_time=0.41535 
Train Epoch: 10 [51/1000 1632/32000 (5%)] Loss: 0.82012 (QuantReg: 10.87957) QuantErr: 10.87957 batch_time=0.45414 
Train Epoch: 10 [56/1000 1792/32000 (6%)] Loss: 0.73666 (QuantReg: 11.32906) QuantErr: 11.32906 batch_time=0.35713 
Train Epoch: 10 [61/1000 1952/32000 (6%)] Loss: 0.54589 (QuantReg: 11.90974) QuantErr: 11.90974 batch_time=0.35953 
Train Epoch: 10 [66/1000 2112/32000 (7%)] Loss: 1.14876 (QuantReg: 12.18187) QuantErr: 12.18187 batch_time=0.49381 
Train Epoch: 10 [71/1000 2272/32000 (7%)] Loss: 1.15292 (QuantReg: 11.62329) QuantErr: 11.62329 batch_time=0.39011 
Train Epoch: 10 [76/1000 2432/32000 (8%)] Loss: 0.62081 (QuantReg: 11.03247) QuantErr: 11.03247 batch_time=0.36276 
Train Epoch: 10 [81/1000 2592/32000 (8%)] Loss: 0.98669 (QuantReg: 11.64802) QuantErr: 11.64802 batch_time=1.68166 
Train Epoch: 10 [86/1000 2752/32000 (9%)] Loss: 0.50855 (QuantReg: 11.82342) QuantErr: 11.82342 batch_time=0.38193 
Train Epoch: 10 [91/1000 2912/32000 (9%)] Loss: 0.70302 (QuantReg: 11.75869) QuantErr: 11.75869 batch_time=0.39502 
Train Epoch: 10 [96/1000 3072/32000 (10%)] Loss: 1.03829 (QuantReg: 11.06505) QuantErr: 11.06505 batch_time=0.38170 
Train Epoch: 10 [101/1000 3232/32000 (10%)] Loss: 1.30673 (QuantReg: 11.72571) QuantErr: 11.72571 batch_time=0.38332 
Train Epoch: 10 [106/1000 3392/32000 (11%)] Loss: 1.05591 (QuantReg: 10.76460) QuantErr: 10.76460 batch_time=0.42751 
Train Epoch: 10 [111/1000 3552/32000 (11%)] Loss: 1.14837 (QuantReg: 11.26225) QuantErr: 11.26225 batch_time=0.36996 
Train Epoch: 10 [116/1000 3712/32000 (12%)] Loss: 0.97809 (QuantReg: 11.10868) QuantErr: 11.10868 batch_time=0.38404 
Train Epoch: 10 [121/1000 3872/32000 (12%)] Loss: 0.81784 (QuantReg: 12.18396) QuantErr: 12.18396 batch_time=0.37456 
Train Epoch: 10 [126/1000 4032/32000 (13%)] Loss: 1.05792 (QuantReg: 11.58051) QuantErr: 11.58051 batch_time=0.46059 
Train Epoch: 10 [131/1000 4192/32000 (13%)] Loss: 1.43732 (QuantReg: 11.90267) QuantErr: 11.90267 batch_time=0.48809 
Train Epoch: 10 [136/1000 4352/32000 (14%)] Loss: 0.81768 (QuantReg: 11.35416) QuantErr: 11.35416 batch_time=0.37585 
Train Epoch: 10 [141/1000 4512/32000 (14%)] Loss: 1.31355 (QuantReg: 11.75644) QuantErr: 11.75644 batch_time=0.42592 
Train Epoch: 10 [146/1000 4672/32000 (15%)] Loss: 0.71309 (QuantReg: 11.54064) QuantErr: 11.54064 batch_time=0.40090 
Train Epoch: 10 [151/1000 4832/32000 (15%)] Loss: 0.80288 (QuantReg: 12.34903) QuantErr: 12.34903 batch_time=0.42870 
Train Epoch: 10 [156/1000 4992/32000 (16%)] Loss: 0.88220 (QuantReg: 12.33290) QuantErr: 12.33290 batch_time=0.44802 
Train Epoch: 10 [161/1000 5152/32000 (16%)] Loss: 1.61634 (QuantReg: 10.89005) QuantErr: 10.89005 batch_time=0.37668 
Train Epoch: 10 [166/1000 5312/32000 (17%)] Loss: 0.58366 (QuantReg: 11.85205) QuantErr: 11.85205 batch_time=0.35905 
Train Epoch: 10 [171/1000 5472/32000 (17%)] Loss: 0.55009 (QuantReg: 11.70339) QuantErr: 11.70339 batch_time=0.37847 
Train Epoch: 10 [176/1000 5632/32000 (18%)] Loss: 0.71772 (QuantReg: 11.54420) QuantErr: 11.54420 batch_time=0.40988 
Train Epoch: 10 [181/1000 5792/32000 (18%)] Loss: 0.40050 (QuantReg: 11.59300) QuantErr: 11.59300 batch_time=0.37309 
Train Epoch: 10 [186/1000 5952/32000 (19%)] Loss: 0.42105 (QuantReg: 11.80412) QuantErr: 11.80412 batch_time=0.45129 
Train Epoch: 10 [191/1000 6112/32000 (19%)] Loss: 0.53557 (QuantReg: 12.22292) QuantErr: 12.22292 batch_time=0.36083 
Train Epoch: 10 [196/1000 6272/32000 (20%)] Loss: 0.41352 (QuantReg: 12.32949) QuantErr: 12.32949 batch_time=0.35044 
Train Epoch: 10 [201/1000 6432/32000 (20%)] Loss: 0.74110 (QuantReg: 11.37243) QuantErr: 11.37243 batch_time=0.35118 
Train Epoch: 10 [206/1000 6592/32000 (21%)] Loss: 0.56123 (QuantReg: 11.80240) QuantErr: 11.80240 batch_time=0.36531 
Train Epoch: 10 [211/1000 6752/32000 (21%)] Loss: 0.76202 (QuantReg: 11.96433) QuantErr: 11.96433 batch_time=0.35634 
Train Epoch: 10 [216/1000 6912/32000 (22%)] Loss: 0.81050 (QuantReg: 11.58278) QuantErr: 11.58278 batch_time=0.41165 
Train Epoch: 10 [221/1000 7072/32000 (22%)] Loss: 0.91235 (QuantReg: 11.59327) QuantErr: 11.59327 batch_time=0.43058 
Train Epoch: 10 [226/1000 7232/32000 (23%)] Loss: 0.41212 (QuantReg: 11.32774) QuantErr: 11.32774 batch_time=0.35775 
Train Epoch: 10 [231/1000 7392/32000 (23%)] Loss: 0.40260 (QuantReg: 12.06378) QuantErr: 12.06378 batch_time=0.36013 
Train Epoch: 10 [236/1000 7552/32000 (24%)] Loss: 0.77821 (QuantReg: 11.83036) QuantErr: 11.83036 batch_time=0.48085 
Train Epoch: 10 [241/1000 7712/32000 (24%)] Loss: 1.03082 (QuantReg: 11.77964) QuantErr: 11.77964 batch_time=0.39628 
Train Epoch: 10 [246/1000 7872/32000 (25%)] Loss: 0.68755 (QuantReg: 11.42895) QuantErr: 11.42895 batch_time=0.38551 
Train Epoch: 10 [251/1000 8032/32000 (25%)] Loss: 0.44586 (QuantReg: 11.73144) QuantErr: 11.73144 batch_time=0.37427 
Train Epoch: 10 [256/1000 8192/32000 (26%)] Loss: 0.47845 (QuantReg: 11.41692) QuantErr: 11.41692 batch_time=0.37798 
Train Epoch: 10 [261/1000 8352/32000 (26%)] Loss: 0.59121 (QuantReg: 11.58445) QuantErr: 11.58445 batch_time=0.36194 
Train Epoch: 10 [266/1000 8512/32000 (27%)] Loss: 0.34277 (QuantReg: 12.12154) QuantErr: 12.12154 batch_time=0.34603 
Train Epoch: 10 [271/1000 8672/32000 (27%)] Loss: 0.89884 (QuantReg: 11.20028) QuantErr: 11.20028 batch_time=0.66718 
Train Epoch: 10 [276/1000 8832/32000 (28%)] Loss: 1.15947 (QuantReg: 12.02798) QuantErr: 12.02798 batch_time=0.41420 
Train Epoch: 10 [281/1000 8992/32000 (28%)] Loss: 0.92451 (QuantReg: 12.05260) QuantErr: 12.05260 batch_time=0.36502 
Train Epoch: 10 [286/1000 9152/32000 (29%)] Loss: 0.43574 (QuantReg: 12.41561) QuantErr: 12.41561 batch_time=0.38192 
Train Epoch: 10 [291/1000 9312/32000 (29%)] Loss: 0.40512 (QuantReg: 11.49949) QuantErr: 11.49949 batch_time=0.40831 
Train Epoch: 10 [296/1000 9472/32000 (30%)] Loss: 0.50411 (QuantReg: 12.17258) QuantErr: 12.17258 batch_time=0.39160 
Train Epoch: 10 [301/1000 9632/32000 (30%)] Loss: 0.84693 (QuantReg: 11.46956) QuantErr: 11.46956 batch_time=0.36880 
Train Epoch: 10 [306/1000 9792/32000 (31%)] Loss: 0.37510 (QuantReg: 12.39005) QuantErr: 12.39005 batch_time=0.41914 
Train Epoch: 10 [311/1000 9952/32000 (31%)] Loss: 0.46346 (QuantReg: 11.22995) QuantErr: 11.22995 batch_time=0.39950 
Train Epoch: 10 [316/1000 10112/32000 (32%)] Loss: 0.89086 (QuantReg: 11.32555) QuantErr: 11.32555 batch_time=0.39220 
Train Epoch: 10 [321/1000 10272/32000 (32%)] Loss: 0.63546 (QuantReg: 11.78655) QuantErr: 11.78655 batch_time=0.36105 
Train Epoch: 10 [326/1000 10432/32000 (33%)] Loss: 0.90480 (QuantReg: 12.13781) QuantErr: 12.13781 batch_time=0.37881 
Train Epoch: 10 [331/1000 10592/32000 (33%)] Loss: 1.32188 (QuantReg: 11.96364) QuantErr: 11.96364 batch_time=0.37379 
Train Epoch: 10 [336/1000 10752/32000 (34%)] Loss: 0.34868 (QuantReg: 12.26468) QuantErr: 12.26468 batch_time=0.47576 
Train Epoch: 10 [341/1000 10912/32000 (34%)] Loss: 0.35023 (QuantReg: 12.36668) QuantErr: 12.36668 batch_time=0.38376 
Train Epoch: 10 [346/1000 11072/32000 (35%)] Loss: 0.96252 (QuantReg: 12.14404) QuantErr: 12.14404 batch_time=0.50456 
Train Epoch: 10 [351/1000 11232/32000 (35%)] Loss: 1.00724 (QuantReg: 11.21252) QuantErr: 11.21252 batch_time=0.40145 
Train Epoch: 10 [356/1000 11392/32000 (36%)] Loss: 1.03519 (QuantReg: 11.77339) QuantErr: 11.77339 batch_time=0.44093 
Train Epoch: 10 [361/1000 11552/32000 (36%)] Loss: 0.65559 (QuantReg: 11.40015) QuantErr: 11.40015 batch_time=0.44434 
Train Epoch: 10 [366/1000 11712/32000 (37%)] Loss: 1.25972 (QuantReg: 10.97522) QuantErr: 10.97522 batch_time=0.46659 
Train Epoch: 10 [371/1000 11872/32000 (37%)] Loss: 1.27399 (QuantReg: 12.66707) QuantErr: 12.66707 batch_time=0.40378 
Train Epoch: 10 [376/1000 12032/32000 (38%)] Loss: 0.78783 (QuantReg: 12.03576) QuantErr: 12.03576 batch_time=0.38144 
Train Epoch: 10 [381/1000 12192/32000 (38%)] Loss: 1.00274 (QuantReg: 12.03275) QuantErr: 12.03275 batch_time=0.40342 
Train Epoch: 10 [386/1000 12352/32000 (39%)] Loss: 0.52035 (QuantReg: 12.53733) QuantErr: 12.53733 batch_time=0.57540 
Train Epoch: 10 [391/1000 12512/32000 (39%)] Loss: 0.76444 (QuantReg: 11.23428) QuantErr: 11.23428 batch_time=0.41291 
Train Epoch: 10 [396/1000 12672/32000 (40%)] Loss: 0.55235 (QuantReg: 12.08337) QuantErr: 12.08337 batch_time=0.35381 
Train Epoch: 10 [401/1000 12832/32000 (40%)] Loss: 0.44449 (QuantReg: 12.02032) QuantErr: 12.02032 batch_time=1.50255 
Train Epoch: 10 [406/1000 12992/32000 (41%)] Loss: 0.70649 (QuantReg: 11.59557) QuantErr: 11.59557 batch_time=0.36825 
Train Epoch: 10 [411/1000 13152/32000 (41%)] Loss: 0.70341 (QuantReg: 12.12473) QuantErr: 12.12473 batch_time=0.37650 
Train Epoch: 10 [416/1000 13312/32000 (42%)] Loss: 0.61620 (QuantReg: 12.51944) QuantErr: 12.51944 batch_time=0.46058 
Train Epoch: 10 [421/1000 13472/32000 (42%)] Loss: 0.35413 (QuantReg: 11.95947) QuantErr: 11.95947 batch_time=0.38941 
Train Epoch: 10 [426/1000 13632/32000 (43%)] Loss: 0.62728 (QuantReg: 12.30443) QuantErr: 12.30443 batch_time=0.40802 
Train Epoch: 10 [431/1000 13792/32000 (43%)] Loss: 0.38664 (QuantReg: 11.93007) QuantErr: 11.93007 batch_time=0.41721 
Train Epoch: 10 [436/1000 13952/32000 (44%)] Loss: 0.54451 (QuantReg: 10.79779) QuantErr: 10.79779 batch_time=0.40361 
Train Epoch: 10 [441/1000 14112/32000 (44%)] Loss: 0.80669 (QuantReg: 12.16175) QuantErr: 12.16175 batch_time=0.36268 
Train Epoch: 10 [446/1000 14272/32000 (45%)] Loss: 0.67267 (QuantReg: 12.03474) QuantErr: 12.03474 batch_time=0.40100 
Train Epoch: 10 [451/1000 14432/32000 (45%)] Loss: 0.43891 (QuantReg: 11.88020) QuantErr: 11.88020 batch_time=0.52515 
Train Epoch: 10 [456/1000 14592/32000 (46%)] Loss: 0.77689 (QuantReg: 12.83723) QuantErr: 12.83723 batch_time=0.41516 
Train Epoch: 10 [461/1000 14752/32000 (46%)] Loss: 0.33062 (QuantReg: 12.69906) QuantErr: 12.69906 batch_time=0.34911 
Train Epoch: 10 [466/1000 14912/32000 (47%)] Loss: 0.53924 (QuantReg: 12.14820) QuantErr: 12.14820 batch_time=0.43074 
Train Epoch: 10 [471/1000 15072/32000 (47%)] Loss: 0.87254 (QuantReg: 12.16414) QuantErr: 12.16414 batch_time=0.37899 
Train Epoch: 10 [476/1000 15232/32000 (48%)] Loss: 0.66921 (QuantReg: 11.87278) QuantErr: 11.87278 batch_time=0.37285 
Train Epoch: 10 [481/1000 15392/32000 (48%)] Loss: 0.58723 (QuantReg: 11.86697) QuantErr: 11.86697 batch_time=0.36320 
Train Epoch: 10 [486/1000 15552/32000 (49%)] Loss: 0.91994 (QuantReg: 11.66088) QuantErr: 11.66088 batch_time=0.43816 
Train Epoch: 10 [491/1000 15712/32000 (49%)] Loss: 0.92237 (QuantReg: 12.41550) QuantErr: 12.41550 batch_time=0.40375 
Train Epoch: 10 [496/1000 15872/32000 (50%)] Loss: 1.01738 (QuantReg: 11.62912) QuantErr: 11.62912 batch_time=0.37405 
Train Epoch: 10 [501/1000 16032/32000 (50%)] Loss: 1.17964 (QuantReg: 11.47558) QuantErr: 11.47558 batch_time=0.38226 
Train Epoch: 10 [506/1000 16192/32000 (51%)] Loss: 0.88941 (QuantReg: 11.37283) QuantErr: 11.37283 batch_time=0.40246 
Train Epoch: 10 [511/1000 16352/32000 (51%)] Loss: 0.59366 (QuantReg: 11.77220) QuantErr: 11.77220 batch_time=0.40807 
Train Epoch: 10 [516/1000 16512/32000 (52%)] Loss: 0.75579 (QuantReg: 12.20860) QuantErr: 12.20860 batch_time=0.36649 
Train Epoch: 10 [521/1000 16672/32000 (52%)] Loss: 0.75323 (QuantReg: 11.61303) QuantErr: 11.61303 batch_time=0.41613 
Train Epoch: 10 [526/1000 16832/32000 (53%)] Loss: 0.39303 (QuantReg: 11.80662) QuantErr: 11.80662 batch_time=0.38560 
Train Epoch: 10 [531/1000 16992/32000 (53%)] Loss: 0.35587 (QuantReg: 12.54459) QuantErr: 12.54459 batch_time=0.37937 
Train Epoch: 10 [536/1000 17152/32000 (54%)] Loss: 0.35933 (QuantReg: 11.41668) QuantErr: 11.41668 batch_time=0.44838 
Train Epoch: 10 [541/1000 17312/32000 (54%)] Loss: 0.91857 (QuantReg: 11.72252) QuantErr: 11.72252 batch_time=0.43781 
Train Epoch: 10 [546/1000 17472/32000 (55%)] Loss: 0.68913 (QuantReg: 12.38952) QuantErr: 12.38952 batch_time=0.35989 
Train Epoch: 10 [551/1000 17632/32000 (55%)] Loss: 0.30898 (QuantReg: 11.91569) QuantErr: 11.91569 batch_time=0.45174 
Train Epoch: 10 [556/1000 17792/32000 (56%)] Loss: 0.45007 (QuantReg: 12.71747) QuantErr: 12.71747 batch_time=0.37155 
Train Epoch: 10 [561/1000 17952/32000 (56%)] Loss: 0.48141 (QuantReg: 11.74576) QuantErr: 11.74576 batch_time=0.44688 
Train Epoch: 10 [566/1000 18112/32000 (57%)] Loss: 1.02780 (QuantReg: 11.76372) QuantErr: 11.76372 batch_time=0.38300 
Train Epoch: 10 [571/1000 18272/32000 (57%)] Loss: 1.10900 (QuantReg: 12.16213) QuantErr: 12.16213 batch_time=0.34955 
Train Epoch: 10 [576/1000 18432/32000 (58%)] Loss: 0.59513 (QuantReg: 11.66040) QuantErr: 11.66040 batch_time=0.39168 
Train Epoch: 10 [581/1000 18592/32000 (58%)] Loss: 1.16151 (QuantReg: 11.00472) QuantErr: 11.00472 batch_time=0.35371 
Train Epoch: 10 [586/1000 18752/32000 (59%)] Loss: 1.02823 (QuantReg: 11.52975) QuantErr: 11.52975 batch_time=0.35641 
Train Epoch: 10 [591/1000 18912/32000 (59%)] Loss: 0.43477 (QuantReg: 12.09904) QuantErr: 12.09904 batch_time=0.74561 
Train Epoch: 10 [596/1000 19072/32000 (60%)] Loss: 0.53607 (QuantReg: 11.88148) QuantErr: 11.88148 batch_time=0.43920 
Train Epoch: 10 [601/1000 19232/32000 (60%)] Loss: 0.87458 (QuantReg: 12.25009) QuantErr: 12.25009 batch_time=0.40896 
Train Epoch: 10 [606/1000 19392/32000 (61%)] Loss: 0.65193 (QuantReg: 11.19822) QuantErr: 11.19822 batch_time=0.38704 
Train Epoch: 10 [611/1000 19552/32000 (61%)] Loss: 1.12475 (QuantReg: 11.78130) QuantErr: 11.78130 batch_time=0.37840 
Train Epoch: 10 [616/1000 19712/32000 (62%)] Loss: 0.83573 (QuantReg: 11.36713) QuantErr: 11.36713 batch_time=0.38089 
Train Epoch: 10 [621/1000 19872/32000 (62%)] Loss: 0.62829 (QuantReg: 11.90837) QuantErr: 11.90837 batch_time=0.37783 
Train Epoch: 10 [626/1000 20032/32000 (63%)] Loss: 0.58648 (QuantReg: 12.02734) QuantErr: 12.02734 batch_time=0.40318 
Train Epoch: 10 [631/1000 20192/32000 (63%)] Loss: 0.69967 (QuantReg: 11.94885) QuantErr: 11.94885 batch_time=0.38040 
Train Epoch: 10 [636/1000 20352/32000 (64%)] Loss: 0.86579 (QuantReg: 12.65061) QuantErr: 12.65061 batch_time=0.36083 
Train Epoch: 10 [641/1000 20512/32000 (64%)] Loss: 0.67538 (QuantReg: 12.16439) QuantErr: 12.16439 batch_time=0.35637 
Train Epoch: 10 [646/1000 20672/32000 (65%)] Loss: 0.62666 (QuantReg: 11.32697) QuantErr: 11.32697 batch_time=0.35448 
Train Epoch: 10 [651/1000 20832/32000 (65%)] Loss: 1.16500 (QuantReg: 12.74563) QuantErr: 12.74563 batch_time=0.35275 
Train Epoch: 10 [656/1000 20992/32000 (66%)] Loss: 1.18873 (QuantReg: 12.78349) QuantErr: 12.78349 batch_time=0.52273 
Train Epoch: 10 [661/1000 21152/32000 (66%)] Loss: 0.42120 (QuantReg: 11.82170) QuantErr: 11.82170 batch_time=0.43030 
Train Epoch: 10 [666/1000 21312/32000 (67%)] Loss: 0.88245 (QuantReg: 12.15348) QuantErr: 12.15348 batch_time=0.42590 
Train Epoch: 10 [671/1000 21472/32000 (67%)] Loss: 1.02648 (QuantReg: 11.99306) QuantErr: 11.99306 batch_time=0.37116 
Train Epoch: 10 [676/1000 21632/32000 (68%)] Loss: 0.66678 (QuantReg: 12.42828) QuantErr: 12.42828 batch_time=0.40482 
Train Epoch: 10 [681/1000 21792/32000 (68%)] Loss: 0.65315 (QuantReg: 12.67935) QuantErr: 12.67935 batch_time=0.37065 
Train Epoch: 10 [686/1000 21952/32000 (69%)] Loss: 0.83282 (QuantReg: 12.06907) QuantErr: 12.06907 batch_time=0.37491 
Train Epoch: 10 [691/1000 22112/32000 (69%)] Loss: 0.65514 (QuantReg: 11.94464) QuantErr: 11.94464 batch_time=0.36630 
Train Epoch: 10 [696/1000 22272/32000 (70%)] Loss: 0.48311 (QuantReg: 11.54164) QuantErr: 11.54164 batch_time=0.37384 
Train Epoch: 10 [701/1000 22432/32000 (70%)] Loss: 0.96708 (QuantReg: 12.74782) QuantErr: 12.74782 batch_time=0.35859 
Train Epoch: 10 [706/1000 22592/32000 (71%)] Loss: 0.67705 (QuantReg: 12.56386) QuantErr: 12.56386 batch_time=0.48483 
Train Epoch: 10 [711/1000 22752/32000 (71%)] Loss: 0.66482 (QuantReg: 11.90865) QuantErr: 11.90865 batch_time=0.34846 
Train Epoch: 10 [716/1000 22912/32000 (72%)] Loss: 0.37206 (QuantReg: 12.43830) QuantErr: 12.43830 batch_time=0.36479 
Train Epoch: 10 [721/1000 23072/32000 (72%)] Loss: 0.29679 (QuantReg: 12.65262) QuantErr: 12.65262 batch_time=1.40105 
Train Epoch: 10 [726/1000 23232/32000 (73%)] Loss: 0.55190 (QuantReg: 12.04923) QuantErr: 12.04923 batch_time=0.37714 
Train Epoch: 10 [731/1000 23392/32000 (73%)] Loss: 0.78556 (QuantReg: 12.35740) QuantErr: 12.35740 batch_time=0.34778 
Train Epoch: 10 [736/1000 23552/32000 (74%)] Loss: 0.54061 (QuantReg: 12.08669) QuantErr: 12.08669 batch_time=0.42554 
Train Epoch: 10 [741/1000 23712/32000 (74%)] Loss: 0.42366 (QuantReg: 12.37321) QuantErr: 12.37321 batch_time=0.41687 
Train Epoch: 10 [746/1000 23872/32000 (75%)] Loss: 0.45748 (QuantReg: 12.40910) QuantErr: 12.40910 batch_time=0.37602 
Train Epoch: 10 [751/1000 24032/32000 (75%)] Loss: 0.58772 (QuantReg: 12.61362) QuantErr: 12.61362 batch_time=0.38430 
Train Epoch: 10 [756/1000 24192/32000 (76%)] Loss: 0.45650 (QuantReg: 11.83107) QuantErr: 11.83107 batch_time=0.41374 
Train Epoch: 10 [761/1000 24352/32000 (76%)] Loss: 1.35501 (QuantReg: 12.12060) QuantErr: 12.12060 batch_time=0.35618 
Train Epoch: 10 [766/1000 24512/32000 (77%)] Loss: 0.42002 (QuantReg: 12.20337) QuantErr: 12.20337 batch_time=0.35665 
Train Epoch: 10 [771/1000 24672/32000 (77%)] Loss: 0.87483 (QuantReg: 12.81758) QuantErr: 12.81758 batch_time=0.49582 
Train Epoch: 10 [776/1000 24832/32000 (78%)] Loss: 0.97895 (QuantReg: 11.12135) QuantErr: 11.12135 batch_time=0.40538 
Train Epoch: 10 [781/1000 24992/32000 (78%)] Loss: 1.08657 (QuantReg: 11.29896) QuantErr: 11.29896 batch_time=0.34931 
Train Epoch: 10 [786/1000 25152/32000 (79%)] Loss: 0.40908 (QuantReg: 12.35026) QuantErr: 12.35026 batch_time=0.39866 
Train Epoch: 10 [791/1000 25312/32000 (79%)] Loss: 0.61493 (QuantReg: 12.19450) QuantErr: 12.19450 batch_time=0.40753 
Train Epoch: 10 [796/1000 25472/32000 (80%)] Loss: 0.38621 (QuantReg: 12.62584) QuantErr: 12.62584 batch_time=0.35703 
Train Epoch: 10 [801/1000 25632/32000 (80%)] Loss: 0.78350 (QuantReg: 12.12203) QuantErr: 12.12203 batch_time=0.45496 
Train Epoch: 10 [806/1000 25792/32000 (81%)] Loss: 0.98678 (QuantReg: 12.05157) QuantErr: 12.05157 batch_time=0.42247 
Train Epoch: 10 [811/1000 25952/32000 (81%)] Loss: 0.57172 (QuantReg: 12.25342) QuantErr: 12.25342 batch_time=0.36914 
Train Epoch: 10 [816/1000 26112/32000 (82%)] Loss: 0.41798 (QuantReg: 11.69606) QuantErr: 11.69606 batch_time=0.39624 
Train Epoch: 10 [821/1000 26272/32000 (82%)] Loss: 0.73627 (QuantReg: 12.56400) QuantErr: 12.56400 batch_time=0.37557 
Train Epoch: 10 [826/1000 26432/32000 (83%)] Loss: 0.37466 (QuantReg: 12.16708) QuantErr: 12.16708 batch_time=0.43549 
Train Epoch: 10 [831/1000 26592/32000 (83%)] Loss: 0.93570 (QuantReg: 11.79250) QuantErr: 11.79250 batch_time=0.41511 
Train Epoch: 10 [836/1000 26752/32000 (84%)] Loss: 0.53249 (QuantReg: 12.34133) QuantErr: 12.34133 batch_time=0.35363 
Train Epoch: 10 [841/1000 26912/32000 (84%)] Loss: 0.70248 (QuantReg: 12.29664) QuantErr: 12.29664 batch_time=0.37696 
Train Epoch: 10 [846/1000 27072/32000 (85%)] Loss: 0.48489 (QuantReg: 12.00305) QuantErr: 12.00305 batch_time=0.42060 
Train Epoch: 10 [851/1000 27232/32000 (85%)] Loss: 0.72079 (QuantReg: 12.23893) QuantErr: 12.23893 batch_time=0.39733 
Train Epoch: 10 [856/1000 27392/32000 (86%)] Loss: 1.39957 (QuantReg: 11.54272) QuantErr: 11.54272 batch_time=0.39463 
Train Epoch: 10 [861/1000 27552/32000 (86%)] Loss: 0.76083 (QuantReg: 12.94302) QuantErr: 12.94302 batch_time=0.39911 
Train Epoch: 10 [866/1000 27712/32000 (87%)] Loss: 0.55100 (QuantReg: 12.69697) QuantErr: 12.69697 batch_time=0.42870 
Train Epoch: 10 [871/1000 27872/32000 (87%)] Loss: 0.75795 (QuantReg: 11.95925) QuantErr: 11.95925 batch_time=0.45055 
Train Epoch: 10 [876/1000 28032/32000 (88%)] Loss: 0.51476 (QuantReg: 11.90992) QuantErr: 11.90992 batch_time=0.46534 
Train Epoch: 10 [881/1000 28192/32000 (88%)] Loss: 0.46485 (QuantReg: 11.96344) QuantErr: 11.96344 batch_time=0.40802 
Train Epoch: 10 [886/1000 28352/32000 (89%)] Loss: 0.38419 (QuantReg: 11.73808) QuantErr: 11.73808 batch_time=0.37270 
Train Epoch: 10 [891/1000 28512/32000 (89%)] Loss: 0.99637 (QuantReg: 11.26460) QuantErr: 11.26460 batch_time=0.37295 
Train Epoch: 10 [896/1000 28672/32000 (90%)] Loss: 1.20422 (QuantReg: 12.13028) QuantErr: 12.13028 batch_time=0.46162 
Train Epoch: 10 [901/1000 28832/32000 (90%)] Loss: 0.52803 (QuantReg: 11.29160) QuantErr: 11.29160 batch_time=0.37523 
Train Epoch: 10 [906/1000 28992/32000 (91%)] Loss: 0.33022 (QuantReg: 11.89382) QuantErr: 11.89382 batch_time=0.38529 
Train Epoch: 10 [911/1000 29152/32000 (91%)] Loss: 0.68523 (QuantReg: 12.24603) QuantErr: 12.24603 batch_time=0.71766 
Train Epoch: 10 [916/1000 29312/32000 (92%)] Loss: 0.65183 (QuantReg: 11.47801) QuantErr: 11.47801 batch_time=0.37459 
Train Epoch: 10 [921/1000 29472/32000 (92%)] Loss: 0.85561 (QuantReg: 12.35144) QuantErr: 12.35144 batch_time=0.40197 
Train Epoch: 10 [926/1000 29632/32000 (93%)] Loss: 0.78510 (QuantReg: 12.09260) QuantErr: 12.09260 batch_time=0.38790 
Train Epoch: 10 [931/1000 29792/32000 (93%)] Loss: 0.85887 (QuantReg: 11.90599) QuantErr: 11.90599 batch_time=0.39228 
Train Epoch: 10 [936/1000 29952/32000 (94%)] Loss: 0.65236 (QuantReg: 12.62049) QuantErr: 12.62049 batch_time=0.41235 
Train Epoch: 10 [941/1000 30112/32000 (94%)] Loss: 0.84757 (QuantReg: 12.03840) QuantErr: 12.03840 batch_time=0.43710 
Train Epoch: 10 [946/1000 30272/32000 (95%)] Loss: 0.83755 (QuantReg: 12.25479) QuantErr: 12.25479 batch_time=0.38385 
Train Epoch: 10 [951/1000 30432/32000 (95%)] Loss: 0.69949 (QuantReg: 12.77328) QuantErr: 12.77328 batch_time=0.35866 
Train Epoch: 10 [956/1000 30592/32000 (96%)] Loss: 0.49878 (QuantReg: 12.00928) QuantErr: 12.00928 batch_time=0.41471 
Train Epoch: 10 [961/1000 30752/32000 (96%)] Loss: 0.27800 (QuantReg: 11.90119) QuantErr: 11.90119 batch_time=0.61095 
Train Epoch: 10 [966/1000 30912/32000 (97%)] Loss: 0.81860 (QuantReg: 12.41580) QuantErr: 12.41580 batch_time=0.36286 
Train Epoch: 10 [971/1000 31072/32000 (97%)] Loss: 0.47249 (QuantReg: 12.13522) QuantErr: 12.13522 batch_time=0.35014 
Train Epoch: 10 [976/1000 31232/32000 (98%)] Loss: 0.45449 (QuantReg: 12.12980) QuantErr: 12.12980 batch_time=0.49501 
Train Epoch: 10 [981/1000 31392/32000 (98%)] Loss: 0.86198 (QuantReg: 11.65824) QuantErr: 11.65824 batch_time=0.34837 
Train Epoch: 10 [986/1000 31552/32000 (99%)] Loss: 0.67317 (QuantReg: 12.58924) QuantErr: 12.58924 batch_time=0.41106 
Train Epoch: 10 [991/1000 31712/32000 (99%)] Loss: 0.52666 (QuantReg: 11.67589) QuantErr: 11.67589 batch_time=0.33789 
Train Epoch: 10 [996/1000 31872/32000 (100%)] Loss: 0.68739 (QuantReg: 11.60361) QuantErr: 11.60361 batch_time=0.34954 
Train Epoch: 10 codebook_update_time=1.93900
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch10.pth ...
Done in 4.392s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 0.7358155066668988
 quant_reg      : 11.933168591499328
 quant_err      : 11.933168591499328
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 10000
 MSRVTT_full_val/t2v_metrics/R1: 27.56539235412475
 MSRVTT_full_val/t2v_metrics/R5: 63.58148893360161
 MSRVTT_full_val/t2v_metrics/R10: 74.84909456740442
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.754527162977867
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.811319663698704
 MSRVTT_full_val/v2t_metrics/R1: 25.75452716297787
 MSRVTT_full_val/v2t_metrics/R5: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.76056338028169
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.20946069804425
 MSRVTT_full_test/t2v_metrics/R1: 8.929765886287626
 MSRVTT_full_test/t2v_metrics/R5: 29.36454849498328
 MSRVTT_full_test/t2v_metrics/R10: 43.34448160535117
 MSRVTT_full_test/t2v_metrics/R50: 76.45484949832776
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.553177257525086
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.483594184986206
 MSRVTT_full_test/v2t_metrics/R1: 11.705685618729097
 MSRVTT_full_test/v2t_metrics/R5: 33.91304347826087
 MSRVTT_full_test/v2t_metrics/R10: 47.424749163879596
 MSRVTT_full_test/v2t_metrics/R50: 82.54180602006689
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.97608695652174
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.602526740274396
 mnt_best       : 24.304753579593697
 not_improved_count: 2
Train Epoch: 11 [1/1000 32/32000 (0%)] Loss: 0.64731 (QuantReg: 11.47395) QuantErr: 11.47395 batch_time=26.79329 
Train Epoch: 11 [6/1000 192/32000 (1%)] Loss: 1.26108 (QuantReg: 11.97039) QuantErr: 11.97039 batch_time=0.36246 
Train Epoch: 11 [11/1000 352/32000 (1%)] Loss: 0.77193 (QuantReg: 11.38989) QuantErr: 11.38989 batch_time=0.37422 
Train Epoch: 11 [16/1000 512/32000 (2%)] Loss: 0.68007 (QuantReg: 11.83146) QuantErr: 11.83146 batch_time=0.48999 
Train Epoch: 11 [21/1000 672/32000 (2%)] Loss: 0.53013 (QuantReg: 11.42542) QuantErr: 11.42542 batch_time=0.43364 
Train Epoch: 11 [26/1000 832/32000 (3%)] Loss: 0.83672 (QuantReg: 11.66126) QuantErr: 11.66126 batch_time=0.43450 
Train Epoch: 11 [31/1000 992/32000 (3%)] Loss: 0.34945 (QuantReg: 11.84230) QuantErr: 11.84230 batch_time=0.40050 
Train Epoch: 11 [36/1000 1152/32000 (4%)] Loss: 0.39824 (QuantReg: 11.85322) QuantErr: 11.85322 batch_time=0.50309 
Train Epoch: 11 [41/1000 1312/32000 (4%)] Loss: 0.36906 (QuantReg: 12.37487) QuantErr: 12.37487 batch_time=0.49954 
Train Epoch: 11 [46/1000 1472/32000 (5%)] Loss: 0.45514 (QuantReg: 11.43513) QuantErr: 11.43513 batch_time=0.41317 
Train Epoch: 11 [51/1000 1632/32000 (5%)] Loss: 0.28657 (QuantReg: 12.40602) QuantErr: 12.40602 batch_time=0.34282 
Train Epoch: 11 [56/1000 1792/32000 (6%)] Loss: 0.78388 (QuantReg: 11.44765) QuantErr: 11.44765 batch_time=0.43346 
Train Epoch: 11 [61/1000 1952/32000 (6%)] Loss: 1.14470 (QuantReg: 11.75747) QuantErr: 11.75747 batch_time=0.48327 
Train Epoch: 11 [66/1000 2112/32000 (7%)] Loss: 0.89776 (QuantReg: 11.30462) QuantErr: 11.30462 batch_time=0.47355 
Train Epoch: 11 [71/1000 2272/32000 (7%)] Loss: 0.59401 (QuantReg: 11.56684) QuantErr: 11.56684 batch_time=0.35695 
Train Epoch: 11 [76/1000 2432/32000 (8%)] Loss: 0.41507 (QuantReg: 12.17976) QuantErr: 12.17976 batch_time=0.36748 
Train Epoch: 11 [81/1000 2592/32000 (8%)] Loss: 1.36643 (QuantReg: 11.76147) QuantErr: 11.76147 batch_time=0.40450 
Train Epoch: 11 [86/1000 2752/32000 (9%)] Loss: 0.83105 (QuantReg: 11.88233) QuantErr: 11.88233 batch_time=1.28192 
Train Epoch: 11 [91/1000 2912/32000 (9%)] Loss: 0.33214 (QuantReg: 12.39486) QuantErr: 12.39486 batch_time=0.36178 
Train Epoch: 11 [96/1000 3072/32000 (10%)] Loss: 1.41526 (QuantReg: 11.65616) QuantErr: 11.65616 batch_time=0.37255 
Train Epoch: 11 [101/1000 3232/32000 (10%)] Loss: 0.51986 (QuantReg: 11.70758) QuantErr: 11.70758 batch_time=0.37929 
Train Epoch: 11 [106/1000 3392/32000 (11%)] Loss: 0.63243 (QuantReg: 12.38973) QuantErr: 12.38973 batch_time=0.42519 
Train Epoch: 11 [111/1000 3552/32000 (11%)] Loss: 0.24988 (QuantReg: 12.91806) QuantErr: 12.91806 batch_time=0.37473 
Train Epoch: 11 [116/1000 3712/32000 (12%)] Loss: 0.60083 (QuantReg: 12.14872) QuantErr: 12.14872 batch_time=0.43619 
Train Epoch: 11 [121/1000 3872/32000 (12%)] Loss: 0.22419 (QuantReg: 11.91197) QuantErr: 11.91197 batch_time=0.39324 
Train Epoch: 11 [126/1000 4032/32000 (13%)] Loss: 0.71967 (QuantReg: 11.35675) QuantErr: 11.35675 batch_time=0.37721 
Train Epoch: 11 [131/1000 4192/32000 (13%)] Loss: 0.70897 (QuantReg: 11.80774) QuantErr: 11.80774 batch_time=0.45973 
Train Epoch: 11 [136/1000 4352/32000 (14%)] Loss: 0.99289 (QuantReg: 12.06019) QuantErr: 12.06019 batch_time=0.37114 
Train Epoch: 11 [141/1000 4512/32000 (14%)] Loss: 0.70117 (QuantReg: 11.47080) QuantErr: 11.47080 batch_time=0.37568 
Train Epoch: 11 [146/1000 4672/32000 (15%)] Loss: 0.36892 (QuantReg: 12.01827) QuantErr: 12.01827 batch_time=0.55011 
Train Epoch: 11 [151/1000 4832/32000 (15%)] Loss: 0.30319 (QuantReg: 13.10992) QuantErr: 13.10992 batch_time=0.37234 
Train Epoch: 11 [156/1000 4992/32000 (16%)] Loss: 0.58083 (QuantReg: 12.06707) QuantErr: 12.06707 batch_time=0.34884 
Train Epoch: 11 [161/1000 5152/32000 (16%)] Loss: 1.13112 (QuantReg: 11.84203) QuantErr: 11.84203 batch_time=0.40843 
Train Epoch: 11 [166/1000 5312/32000 (17%)] Loss: 0.60291 (QuantReg: 11.25987) QuantErr: 11.25987 batch_time=0.49106 
Train Epoch: 11 [171/1000 5472/32000 (17%)] Loss: 0.44882 (QuantReg: 11.83398) QuantErr: 11.83398 batch_time=0.50520 
Train Epoch: 11 [176/1000 5632/32000 (18%)] Loss: 0.63963 (QuantReg: 12.06477) QuantErr: 12.06477 batch_time=0.43208 
Train Epoch: 11 [181/1000 5792/32000 (18%)] Loss: 1.03955 (QuantReg: 12.10169) QuantErr: 12.10169 batch_time=0.38231 
Train Epoch: 11 [186/1000 5952/32000 (19%)] Loss: 0.65838 (QuantReg: 12.09264) QuantErr: 12.09264 batch_time=0.36582 
Train Epoch: 11 [191/1000 6112/32000 (19%)] Loss: 0.84657 (QuantReg: 12.31099) QuantErr: 12.31099 batch_time=0.37030 
Train Epoch: 11 [196/1000 6272/32000 (20%)] Loss: 0.47500 (QuantReg: 11.17080) QuantErr: 11.17080 batch_time=0.39245 
Train Epoch: 11 [201/1000 6432/32000 (20%)] Loss: 0.55184 (QuantReg: 12.20986) QuantErr: 12.20986 batch_time=0.35136 
Train Epoch: 11 [206/1000 6592/32000 (21%)] Loss: 0.68160 (QuantReg: 12.23659) QuantErr: 12.23659 batch_time=0.35507 
Train Epoch: 11 [211/1000 6752/32000 (21%)] Loss: 0.37957 (QuantReg: 11.47808) QuantErr: 11.47808 batch_time=0.35761 
Train Epoch: 11 [216/1000 6912/32000 (22%)] Loss: 0.80772 (QuantReg: 10.57342) QuantErr: 10.57342 batch_time=0.34545 
Train Epoch: 11 [221/1000 7072/32000 (22%)] Loss: 0.76518 (QuantReg: 12.42783) QuantErr: 12.42783 batch_time=0.35417 
Train Epoch: 11 [226/1000 7232/32000 (23%)] Loss: 0.73976 (QuantReg: 11.96278) QuantErr: 11.96278 batch_time=0.34328 
Train Epoch: 11 [231/1000 7392/32000 (23%)] Loss: 0.59794 (QuantReg: 11.59032) QuantErr: 11.59032 batch_time=0.34430 
Train Epoch: 11 [236/1000 7552/32000 (24%)] Loss: 0.48485 (QuantReg: 12.59375) QuantErr: 12.59375 batch_time=0.58851 
Train Epoch: 11 [241/1000 7712/32000 (24%)] Loss: 1.54580 (QuantReg: 11.53446) QuantErr: 11.53446 batch_time=0.38869 
Train Epoch: 11 [246/1000 7872/32000 (25%)] Loss: 0.58119 (QuantReg: 11.51679) QuantErr: 11.51679 batch_time=0.41069 
Train Epoch: 11 [251/1000 8032/32000 (25%)] Loss: 0.71619 (QuantReg: 11.10165) QuantErr: 11.10165 batch_time=0.37946 
Train Epoch: 11 [256/1000 8192/32000 (26%)] Loss: 0.87962 (QuantReg: 12.05758) QuantErr: 12.05758 batch_time=0.36465 
Train Epoch: 11 [261/1000 8352/32000 (26%)] Loss: 0.87078 (QuantReg: 11.99126) QuantErr: 11.99126 batch_time=0.40442 
Train Epoch: 11 [266/1000 8512/32000 (27%)] Loss: 0.56487 (QuantReg: 11.53899) QuantErr: 11.53899 batch_time=0.38302 
Train Epoch: 11 [271/1000 8672/32000 (27%)] Loss: 0.54100 (QuantReg: 11.42955) QuantErr: 11.42955 batch_time=0.34319 
Train Epoch: 11 [276/1000 8832/32000 (28%)] Loss: 0.37625 (QuantReg: 11.98518) QuantErr: 11.98518 batch_time=0.34455 
Train Epoch: 11 [281/1000 8992/32000 (28%)] Loss: 0.33625 (QuantReg: 11.89205) QuantErr: 11.89205 batch_time=0.34723 
Train Epoch: 11 [286/1000 9152/32000 (29%)] Loss: 0.55722 (QuantReg: 12.17085) QuantErr: 12.17085 batch_time=0.34693 
Train Epoch: 11 [291/1000 9312/32000 (29%)] Loss: 0.50771 (QuantReg: 11.62553) QuantErr: 11.62553 batch_time=0.34346 
Train Epoch: 11 [296/1000 9472/32000 (30%)] Loss: 0.50276 (QuantReg: 12.03924) QuantErr: 12.03924 batch_time=0.35949 
Train Epoch: 11 [301/1000 9632/32000 (30%)] Loss: 0.50839 (QuantReg: 11.97826) QuantErr: 11.97826 batch_time=0.39855 
Train Epoch: 11 [306/1000 9792/32000 (31%)] Loss: 0.44772 (QuantReg: 12.10589) QuantErr: 12.10589 batch_time=0.34734 
Train Epoch: 11 [311/1000 9952/32000 (31%)] Loss: 0.30977 (QuantReg: 12.79677) QuantErr: 12.79677 batch_time=0.45663 
Train Epoch: 11 [316/1000 10112/32000 (32%)] Loss: 0.85006 (QuantReg: 12.01459) QuantErr: 12.01459 batch_time=0.40834 
Train Epoch: 11 [321/1000 10272/32000 (32%)] Loss: 0.35933 (QuantReg: 12.15655) QuantErr: 12.15655 batch_time=0.53753 
Train Epoch: 11 [326/1000 10432/32000 (33%)] Loss: 0.62952 (QuantReg: 11.56533) QuantErr: 11.56533 batch_time=0.36709 
Train Epoch: 11 [331/1000 10592/32000 (33%)] Loss: 0.25310 (QuantReg: 11.89766) QuantErr: 11.89766 batch_time=0.41607 
Train Epoch: 11 [336/1000 10752/32000 (34%)] Loss: 0.26615 (QuantReg: 12.28026) QuantErr: 12.28026 batch_time=0.43907 
Train Epoch: 11 [341/1000 10912/32000 (34%)] Loss: 0.62296 (QuantReg: 12.50576) QuantErr: 12.50576 batch_time=0.43617 
Train Epoch: 11 [346/1000 11072/32000 (35%)] Loss: 1.21027 (QuantReg: 11.40501) QuantErr: 11.40501 batch_time=0.46483 
Train Epoch: 11 [351/1000 11232/32000 (35%)] Loss: 0.94078 (QuantReg: 12.15448) QuantErr: 12.15448 batch_time=0.41309 
Train Epoch: 11 [356/1000 11392/32000 (36%)] Loss: 0.67365 (QuantReg: 11.17091) QuantErr: 11.17091 batch_time=0.42308 
Train Epoch: 11 [361/1000 11552/32000 (36%)] Loss: 0.61055 (QuantReg: 11.99557) QuantErr: 11.99557 batch_time=0.49016 
Train Epoch: 11 [366/1000 11712/32000 (37%)] Loss: 0.52477 (QuantReg: 12.24282) QuantErr: 12.24282 batch_time=0.38311 
Train Epoch: 11 [371/1000 11872/32000 (37%)] Loss: 0.70789 (QuantReg: 11.53418) QuantErr: 11.53418 batch_time=0.41891 
Train Epoch: 11 [376/1000 12032/32000 (38%)] Loss: 0.59436 (QuantReg: 11.69142) QuantErr: 11.69142 batch_time=0.36182 
Train Epoch: 11 [381/1000 12192/32000 (38%)] Loss: 0.46040 (QuantReg: 12.48304) QuantErr: 12.48304 batch_time=0.39482 
Train Epoch: 11 [386/1000 12352/32000 (39%)] Loss: 0.34694 (QuantReg: 11.96876) QuantErr: 11.96876 batch_time=0.51537 
Train Epoch: 11 [391/1000 12512/32000 (39%)] Loss: 0.47547 (QuantReg: 12.06448) QuantErr: 12.06448 batch_time=0.38280 
Train Epoch: 11 [396/1000 12672/32000 (40%)] Loss: 0.53539 (QuantReg: 11.73133) QuantErr: 11.73133 batch_time=0.36204 
Train Epoch: 11 [401/1000 12832/32000 (40%)] Loss: 0.34473 (QuantReg: 12.12062) QuantErr: 12.12062 batch_time=0.37077 
Train Epoch: 11 [406/1000 12992/32000 (41%)] Loss: 0.27555 (QuantReg: 12.04055) QuantErr: 12.04055 batch_time=1.25093 
Train Epoch: 11 [411/1000 13152/32000 (41%)] Loss: 0.15916 (QuantReg: 12.06942) QuantErr: 12.06942 batch_time=0.34515 
Train Epoch: 11 [416/1000 13312/32000 (42%)] Loss: 0.18747 (QuantReg: 11.77636) QuantErr: 11.77636 batch_time=0.34628 
Train Epoch: 11 [421/1000 13472/32000 (42%)] Loss: 0.91064 (QuantReg: 12.63704) QuantErr: 12.63704 batch_time=0.37974 
Train Epoch: 11 [426/1000 13632/32000 (43%)] Loss: 0.58302 (QuantReg: 12.28277) QuantErr: 12.28277 batch_time=0.45006 
Train Epoch: 11 [431/1000 13792/32000 (43%)] Loss: 0.40125 (QuantReg: 13.02019) QuantErr: 13.02019 batch_time=0.39823 
Train Epoch: 11 [436/1000 13952/32000 (44%)] Loss: 0.84706 (QuantReg: 11.93540) QuantErr: 11.93540 batch_time=0.38967 
Train Epoch: 11 [441/1000 14112/32000 (44%)] Loss: 1.02816 (QuantReg: 11.54742) QuantErr: 11.54742 batch_time=0.34168 
Train Epoch: 11 [446/1000 14272/32000 (45%)] Loss: 0.81273 (QuantReg: 13.18171) QuantErr: 13.18171 batch_time=0.34341 
Train Epoch: 11 [451/1000 14432/32000 (45%)] Loss: 0.43530 (QuantReg: 12.30585) QuantErr: 12.30585 batch_time=0.40241 
Train Epoch: 11 [456/1000 14592/32000 (46%)] Loss: 0.60974 (QuantReg: 12.03623) QuantErr: 12.03623 batch_time=0.42142 
Train Epoch: 11 [461/1000 14752/32000 (46%)] Loss: 0.89877 (QuantReg: 11.78364) QuantErr: 11.78364 batch_time=0.34502 
Train Epoch: 11 [466/1000 14912/32000 (47%)] Loss: 1.09296 (QuantReg: 12.07362) QuantErr: 12.07362 batch_time=0.47263 
Train Epoch: 11 [471/1000 15072/32000 (47%)] Loss: 0.61927 (QuantReg: 11.63149) QuantErr: 11.63149 batch_time=0.34505 
Train Epoch: 11 [476/1000 15232/32000 (48%)] Loss: 0.51517 (QuantReg: 12.10617) QuantErr: 12.10617 batch_time=0.34805 
Train Epoch: 11 [481/1000 15392/32000 (48%)] Loss: 0.65730 (QuantReg: 11.62456) QuantErr: 11.62456 batch_time=0.35944 
Train Epoch: 11 [486/1000 15552/32000 (49%)] Loss: 0.77537 (QuantReg: 11.26030) QuantErr: 11.26030 batch_time=0.38226 
Train Epoch: 11 [491/1000 15712/32000 (49%)] Loss: 0.43222 (QuantReg: 12.15477) QuantErr: 12.15477 batch_time=0.43572 
Train Epoch: 11 [496/1000 15872/32000 (50%)] Loss: 0.91660 (QuantReg: 11.78616) QuantErr: 11.78616 batch_time=0.37493 
Train Epoch: 11 [501/1000 16032/32000 (50%)] Loss: 1.22677 (QuantReg: 10.68631) QuantErr: 10.68631 batch_time=0.35655 
Train Epoch: 11 [506/1000 16192/32000 (51%)] Loss: 0.97444 (QuantReg: 12.00444) QuantErr: 12.00444 batch_time=0.35382 
Train Epoch: 11 [511/1000 16352/32000 (51%)] Loss: 0.60734 (QuantReg: 12.49054) QuantErr: 12.49054 batch_time=0.36421 
Train Epoch: 11 [516/1000 16512/32000 (52%)] Loss: 0.46143 (QuantReg: 11.91161) QuantErr: 11.91161 batch_time=0.38997 
Train Epoch: 11 [521/1000 16672/32000 (52%)] Loss: 0.69545 (QuantReg: 11.75737) QuantErr: 11.75737 batch_time=0.35339 
Train Epoch: 11 [526/1000 16832/32000 (53%)] Loss: 1.00320 (QuantReg: 12.65385) QuantErr: 12.65385 batch_time=0.36738 
Train Epoch: 11 [531/1000 16992/32000 (53%)] Loss: 0.68659 (QuantReg: 12.18332) QuantErr: 12.18332 batch_time=0.44746 
Train Epoch: 11 [536/1000 17152/32000 (54%)] Loss: 0.53865 (QuantReg: 12.19567) QuantErr: 12.19567 batch_time=0.36559 
Train Epoch: 11 [541/1000 17312/32000 (54%)] Loss: 0.79570 (QuantReg: 12.11551) QuantErr: 12.11551 batch_time=0.36283 
Train Epoch: 11 [546/1000 17472/32000 (55%)] Loss: 0.89575 (QuantReg: 11.84786) QuantErr: 11.84786 batch_time=0.48591 
Train Epoch: 11 [551/1000 17632/32000 (55%)] Loss: 0.37048 (QuantReg: 11.58295) QuantErr: 11.58295 batch_time=0.38244 
Train Epoch: 11 [556/1000 17792/32000 (56%)] Loss: 0.50481 (QuantReg: 12.76895) QuantErr: 12.76895 batch_time=0.61258 
Train Epoch: 11 [561/1000 17952/32000 (56%)] Loss: 0.37557 (QuantReg: 13.30683) QuantErr: 13.30683 batch_time=0.35099 
Train Epoch: 11 [566/1000 18112/32000 (57%)] Loss: 0.97179 (QuantReg: 11.25047) QuantErr: 11.25047 batch_time=0.41219 
Train Epoch: 11 [571/1000 18272/32000 (57%)] Loss: 0.60815 (QuantReg: 12.13394) QuantErr: 12.13394 batch_time=0.35260 
Train Epoch: 11 [576/1000 18432/32000 (58%)] Loss: 0.55590 (QuantReg: 12.07605) QuantErr: 12.07605 batch_time=0.34613 
Train Epoch: 11 [581/1000 18592/32000 (58%)] Loss: 0.36396 (QuantReg: 12.96998) QuantErr: 12.96998 batch_time=0.43417 
Train Epoch: 11 [586/1000 18752/32000 (59%)] Loss: 0.71742 (QuantReg: 12.31663) QuantErr: 12.31663 batch_time=0.39401 
Train Epoch: 11 [591/1000 18912/32000 (59%)] Loss: 0.70406 (QuantReg: 12.50344) QuantErr: 12.50344 batch_time=0.36871 
Train Epoch: 11 [596/1000 19072/32000 (60%)] Loss: 0.98402 (QuantReg: 11.76003) QuantErr: 11.76003 batch_time=0.38114 
Train Epoch: 11 [601/1000 19232/32000 (60%)] Loss: 0.75848 (QuantReg: 12.56871) QuantErr: 12.56871 batch_time=0.38865 
Train Epoch: 11 [606/1000 19392/32000 (61%)] Loss: 0.54638 (QuantReg: 12.36540) QuantErr: 12.36540 batch_time=0.35620 
Train Epoch: 11 [611/1000 19552/32000 (61%)] Loss: 0.94214 (QuantReg: 11.84638) QuantErr: 11.84638 batch_time=0.42021 
Train Epoch: 11 [616/1000 19712/32000 (62%)] Loss: 0.75185 (QuantReg: 12.37606) QuantErr: 12.37606 batch_time=0.38380 
Train Epoch: 11 [621/1000 19872/32000 (62%)] Loss: 0.21294 (QuantReg: 12.05073) QuantErr: 12.05073 batch_time=0.34290 
Train Epoch: 11 [626/1000 20032/32000 (63%)] Loss: 0.85713 (QuantReg: 11.45073) QuantErr: 11.45073 batch_time=0.34339 
Train Epoch: 11 [631/1000 20192/32000 (63%)] Loss: 0.86962 (QuantReg: 12.45838) QuantErr: 12.45838 batch_time=0.44005 
Train Epoch: 11 [636/1000 20352/32000 (64%)] Loss: 0.80228 (QuantReg: 11.62517) QuantErr: 11.62517 batch_time=0.38049 
Train Epoch: 11 [641/1000 20512/32000 (64%)] Loss: 0.91473 (QuantReg: 12.18116) QuantErr: 12.18116 batch_time=0.48501 
Train Epoch: 11 [646/1000 20672/32000 (65%)] Loss: 0.72556 (QuantReg: 12.19986) QuantErr: 12.19986 batch_time=0.37773 
Train Epoch: 11 [651/1000 20832/32000 (65%)] Loss: 0.62409 (QuantReg: 12.14823) QuantErr: 12.14823 batch_time=0.35803 
Train Epoch: 11 [656/1000 20992/32000 (66%)] Loss: 0.93736 (QuantReg: 11.76320) QuantErr: 11.76320 batch_time=0.43028 
Train Epoch: 11 [661/1000 21152/32000 (66%)] Loss: 0.77117 (QuantReg: 12.11190) QuantErr: 12.11190 batch_time=0.43496 
Train Epoch: 11 [666/1000 21312/32000 (67%)] Loss: 0.89131 (QuantReg: 12.05330) QuantErr: 12.05330 batch_time=0.40823 
Train Epoch: 11 [671/1000 21472/32000 (67%)] Loss: 0.88774 (QuantReg: 11.87461) QuantErr: 11.87461 batch_time=0.36745 
Train Epoch: 11 [676/1000 21632/32000 (68%)] Loss: 0.51196 (QuantReg: 11.70049) QuantErr: 11.70049 batch_time=0.40602 
Train Epoch: 11 [681/1000 21792/32000 (68%)] Loss: 0.89868 (QuantReg: 11.41095) QuantErr: 11.41095 batch_time=0.46820 
Train Epoch: 11 [686/1000 21952/32000 (69%)] Loss: 0.71712 (QuantReg: 11.91232) QuantErr: 11.91232 batch_time=0.36949 
Train Epoch: 11 [691/1000 22112/32000 (69%)] Loss: 1.09337 (QuantReg: 11.43449) QuantErr: 11.43449 batch_time=0.36809 
Train Epoch: 11 [696/1000 22272/32000 (70%)] Loss: 0.58261 (QuantReg: 11.32309) QuantErr: 11.32309 batch_time=0.37942 
Train Epoch: 11 [701/1000 22432/32000 (70%)] Loss: 0.58450 (QuantReg: 12.37658) QuantErr: 12.37658 batch_time=0.36701 
Train Epoch: 11 [706/1000 22592/32000 (71%)] Loss: 0.36453 (QuantReg: 12.00681) QuantErr: 12.00681 batch_time=0.46036 
Train Epoch: 11 [711/1000 22752/32000 (71%)] Loss: 0.37197 (QuantReg: 12.36462) QuantErr: 12.36462 batch_time=0.35395 
Train Epoch: 11 [716/1000 22912/32000 (72%)] Loss: 0.44753 (QuantReg: 12.50400) QuantErr: 12.50400 batch_time=0.39204 
Train Epoch: 11 [721/1000 23072/32000 (72%)] Loss: 0.50689 (QuantReg: 12.20577) QuantErr: 12.20577 batch_time=0.38720 
Train Epoch: 11 [726/1000 23232/32000 (73%)] Loss: 0.77016 (QuantReg: 13.07570) QuantErr: 13.07570 batch_time=1.30509 
Train Epoch: 11 [731/1000 23392/32000 (73%)] Loss: 0.69434 (QuantReg: 11.35702) QuantErr: 11.35702 batch_time=0.35878 
Train Epoch: 11 [736/1000 23552/32000 (74%)] Loss: 0.44817 (QuantReg: 11.24628) QuantErr: 11.24628 batch_time=0.35841 
Train Epoch: 11 [741/1000 23712/32000 (74%)] Loss: 0.68719 (QuantReg: 11.77242) QuantErr: 11.77242 batch_time=0.35948 
Train Epoch: 11 [746/1000 23872/32000 (75%)] Loss: 1.10990 (QuantReg: 12.11840) QuantErr: 12.11840 batch_time=0.37019 
Train Epoch: 11 [751/1000 24032/32000 (75%)] Loss: 0.58110 (QuantReg: 11.74171) QuantErr: 11.74171 batch_time=0.35200 
Train Epoch: 11 [756/1000 24192/32000 (76%)] Loss: 0.97456 (QuantReg: 11.47877) QuantErr: 11.47877 batch_time=0.38172 
Train Epoch: 11 [761/1000 24352/32000 (76%)] Loss: 0.31242 (QuantReg: 12.82807) QuantErr: 12.82807 batch_time=0.35421 
Train Epoch: 11 [766/1000 24512/32000 (77%)] Loss: 0.82057 (QuantReg: 11.86699) QuantErr: 11.86699 batch_time=0.42659 
Train Epoch: 11 [771/1000 24672/32000 (77%)] Loss: 0.52182 (QuantReg: 11.72798) QuantErr: 11.72798 batch_time=0.42646 
Train Epoch: 11 [776/1000 24832/32000 (78%)] Loss: 1.29380 (QuantReg: 12.34452) QuantErr: 12.34452 batch_time=0.35197 
Train Epoch: 11 [781/1000 24992/32000 (78%)] Loss: 0.77355 (QuantReg: 12.13287) QuantErr: 12.13287 batch_time=0.40829 
Train Epoch: 11 [786/1000 25152/32000 (79%)] Loss: 0.45720 (QuantReg: 11.69972) QuantErr: 11.69972 batch_time=0.46721 
Train Epoch: 11 [791/1000 25312/32000 (79%)] Loss: 0.70118 (QuantReg: 11.95438) QuantErr: 11.95438 batch_time=0.36806 
Train Epoch: 11 [796/1000 25472/32000 (80%)] Loss: 0.74652 (QuantReg: 12.39171) QuantErr: 12.39171 batch_time=0.40739 
Train Epoch: 11 [801/1000 25632/32000 (80%)] Loss: 0.67226 (QuantReg: 11.35655) QuantErr: 11.35655 batch_time=0.38868 
Train Epoch: 11 [806/1000 25792/32000 (81%)] Loss: 0.96733 (QuantReg: 12.00310) QuantErr: 12.00310 batch_time=0.36264 
Train Epoch: 11 [811/1000 25952/32000 (81%)] Loss: 0.84551 (QuantReg: 12.04784) QuantErr: 12.04784 batch_time=0.42876 
Train Epoch: 11 [816/1000 26112/32000 (82%)] Loss: 0.46954 (QuantReg: 11.92916) QuantErr: 11.92916 batch_time=0.43803 
Train Epoch: 11 [821/1000 26272/32000 (82%)] Loss: 0.48788 (QuantReg: 11.90260) QuantErr: 11.90260 batch_time=0.35208 
Train Epoch: 11 [826/1000 26432/32000 (83%)] Loss: 0.47447 (QuantReg: 13.07957) QuantErr: 13.07957 batch_time=0.35461 
Train Epoch: 11 [831/1000 26592/32000 (83%)] Loss: 0.65209 (QuantReg: 11.16140) QuantErr: 11.16140 batch_time=0.35988 
Train Epoch: 11 [836/1000 26752/32000 (84%)] Loss: 0.67564 (QuantReg: 12.03192) QuantErr: 12.03192 batch_time=0.42586 
Train Epoch: 11 [841/1000 26912/32000 (84%)] Loss: 0.39382 (QuantReg: 12.79210) QuantErr: 12.79210 batch_time=0.35425 
Train Epoch: 11 [846/1000 27072/32000 (85%)] Loss: 0.59849 (QuantReg: 11.59777) QuantErr: 11.59777 batch_time=0.38337 
Train Epoch: 11 [851/1000 27232/32000 (85%)] Loss: 0.77054 (QuantReg: 11.91485) QuantErr: 11.91485 batch_time=0.34401 
Train Epoch: 11 [856/1000 27392/32000 (86%)] Loss: 0.38757 (QuantReg: 11.93681) QuantErr: 11.93681 batch_time=0.38508 
Train Epoch: 11 [861/1000 27552/32000 (86%)] Loss: 1.16577 (QuantReg: 11.66511) QuantErr: 11.66511 batch_time=0.35037 
Train Epoch: 11 [866/1000 27712/32000 (87%)] Loss: 0.53099 (QuantReg: 12.33040) QuantErr: 12.33040 batch_time=0.34469 
Train Epoch: 11 [871/1000 27872/32000 (87%)] Loss: 0.90917 (QuantReg: 11.93366) QuantErr: 11.93366 batch_time=0.35721 
Train Epoch: 11 [876/1000 28032/32000 (88%)] Loss: 0.58225 (QuantReg: 11.38655) QuantErr: 11.38655 batch_time=0.58067 
Train Epoch: 11 [881/1000 28192/32000 (88%)] Loss: 0.38480 (QuantReg: 12.19670) QuantErr: 12.19670 batch_time=0.35449 
Train Epoch: 11 [886/1000 28352/32000 (89%)] Loss: 0.82810 (QuantReg: 12.25581) QuantErr: 12.25581 batch_time=0.34716 
Train Epoch: 11 [891/1000 28512/32000 (89%)] Loss: 0.70235 (QuantReg: 11.76475) QuantErr: 11.76475 batch_time=0.34783 
Train Epoch: 11 [896/1000 28672/32000 (90%)] Loss: 0.95908 (QuantReg: 11.18110) QuantErr: 11.18110 batch_time=0.36739 
Train Epoch: 11 [901/1000 28832/32000 (90%)] Loss: 0.36426 (QuantReg: 12.33615) QuantErr: 12.33615 batch_time=0.36330 
Train Epoch: 11 [906/1000 28992/32000 (91%)] Loss: 0.27802 (QuantReg: 12.39527) QuantErr: 12.39527 batch_time=0.39265 
Train Epoch: 11 [911/1000 29152/32000 (91%)] Loss: 0.51769 (QuantReg: 12.43979) QuantErr: 12.43979 batch_time=0.35027 
Train Epoch: 11 [916/1000 29312/32000 (92%)] Loss: 0.30541 (QuantReg: 13.14888) QuantErr: 13.14888 batch_time=0.36603 
Train Epoch: 11 [921/1000 29472/32000 (92%)] Loss: 0.52880 (QuantReg: 11.92456) QuantErr: 11.92456 batch_time=0.34953 
Train Epoch: 11 [926/1000 29632/32000 (93%)] Loss: 1.20388 (QuantReg: 11.93161) QuantErr: 11.93161 batch_time=0.39320 
Train Epoch: 11 [931/1000 29792/32000 (93%)] Loss: 0.67794 (QuantReg: 12.22022) QuantErr: 12.22022 batch_time=0.34228 
Train Epoch: 11 [936/1000 29952/32000 (94%)] Loss: 0.56488 (QuantReg: 11.41639) QuantErr: 11.41639 batch_time=0.34338 
Train Epoch: 11 [941/1000 30112/32000 (94%)] Loss: 0.81296 (QuantReg: 13.15103) QuantErr: 13.15103 batch_time=0.36912 
Train Epoch: 11 [946/1000 30272/32000 (95%)] Loss: 0.40275 (QuantReg: 12.27501) QuantErr: 12.27501 batch_time=0.34481 
Train Epoch: 11 [951/1000 30432/32000 (95%)] Loss: 0.54589 (QuantReg: 12.37366) QuantErr: 12.37366 batch_time=0.36943 
Train Epoch: 11 [956/1000 30592/32000 (96%)] Loss: 0.50335 (QuantReg: 12.51199) QuantErr: 12.51199 batch_time=0.34730 
Train Epoch: 11 [961/1000 30752/32000 (96%)] Loss: 0.27850 (QuantReg: 11.92045) QuantErr: 11.92045 batch_time=0.36547 
Train Epoch: 11 [966/1000 30912/32000 (97%)] Loss: 0.38490 (QuantReg: 12.56174) QuantErr: 12.56174 batch_time=0.34242 
Train Epoch: 11 [971/1000 31072/32000 (97%)] Loss: 0.43156 (QuantReg: 12.21257) QuantErr: 12.21257 batch_time=0.35830 
Train Epoch: 11 [976/1000 31232/32000 (98%)] Loss: 0.60677 (QuantReg: 11.91121) QuantErr: 11.91121 batch_time=0.37330 
Train Epoch: 11 [981/1000 31392/32000 (98%)] Loss: 0.63561 (QuantReg: 12.18110) QuantErr: 12.18110 batch_time=0.45673 
Train Epoch: 11 [986/1000 31552/32000 (99%)] Loss: 0.35845 (QuantReg: 12.70331) QuantErr: 12.70331 batch_time=0.42934 
Train Epoch: 11 [991/1000 31712/32000 (99%)] Loss: 0.62760 (QuantReg: 12.96121) QuantErr: 12.96121 batch_time=0.38187 
Train Epoch: 11 [996/1000 31872/32000 (100%)] Loss: 0.69157 (QuantReg: 12.12997) QuantErr: 12.12997 batch_time=0.34900 
Train Epoch: 11 codebook_update_time=1.81776
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch11.pth ...
Done in 17.401s
removing stale ckpt [epoch 10] [took 0.06s]
 epoch          : 11
 loss           : 0.6950797068029642
 quant_reg      : 11.973224695205689
 quant_err      : 11.973224695205689
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 11000
 MSRVTT_full_val/t2v_metrics/R1: 30.18108651911469
 MSRVTT_full_val/t2v_metrics/R5: 64.1851106639839
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.372233400402415
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.41499324028412
 MSRVTT_full_val/v2t_metrics/R1: 31.790744466800806
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 82.49496981891348
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.957746478873239
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.00237680442953
 MSRVTT_full_test/t2v_metrics/R1: 9.899665551839465
 MSRVTT_full_test/t2v_metrics/R5: 31.204013377926422
 MSRVTT_full_test/t2v_metrics/R10: 46.05351170568562
 MSRVTT_full_test/t2v_metrics/R50: 77.89297658862876
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.710033444816055
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.230622785432846
 MSRVTT_full_test/v2t_metrics/R1: 12.006688963210703
 MSRVTT_full_test/v2t_metrics/R5: 35.986622073578594
 MSRVTT_full_test/v2t_metrics/R10: 49.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 83.4113712374582
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 39.284113712374584
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.78277906285629
 mnt_best       : 24.304753579593697
 not_improved_count: 3
Train Epoch: 12 [1/1000 32/32000 (0%)] Loss: 0.59999 (QuantReg: 11.87274) QuantErr: 11.87274 batch_time=28.85173 
Train Epoch: 12 [6/1000 192/32000 (1%)] Loss: 0.46534 (QuantReg: 11.35028) QuantErr: 11.35028 batch_time=0.35914 
Train Epoch: 12 [11/1000 352/32000 (1%)] Loss: 2.10423 (QuantReg: 11.42278) QuantErr: 11.42278 batch_time=0.44247 
Train Epoch: 12 [16/1000 512/32000 (2%)] Loss: 0.57045 (QuantReg: 10.73719) QuantErr: 10.73719 batch_time=0.69070 
Train Epoch: 12 [21/1000 672/32000 (2%)] Loss: 1.17624 (QuantReg: 11.29368) QuantErr: 11.29368 batch_time=0.36429 
Train Epoch: 12 [26/1000 832/32000 (3%)] Loss: 0.89189 (QuantReg: 11.42966) QuantErr: 11.42966 batch_time=0.35851 
Train Epoch: 12 [31/1000 992/32000 (3%)] Loss: 0.28868 (QuantReg: 11.51977) QuantErr: 11.51977 batch_time=0.34859 
Train Epoch: 12 [36/1000 1152/32000 (4%)] Loss: 0.34475 (QuantReg: 12.22693) QuantErr: 12.22693 batch_time=0.34468 
Train Epoch: 12 [41/1000 1312/32000 (4%)] Loss: 1.03497 (QuantReg: 11.25170) QuantErr: 11.25170 batch_time=0.34334 
Train Epoch: 12 [46/1000 1472/32000 (5%)] Loss: 0.50233 (QuantReg: 11.49795) QuantErr: 11.49795 batch_time=0.37310 
Train Epoch: 12 [51/1000 1632/32000 (5%)] Loss: 0.92414 (QuantReg: 11.67484) QuantErr: 11.67484 batch_time=0.36969 
Train Epoch: 12 [56/1000 1792/32000 (6%)] Loss: 0.58938 (QuantReg: 12.04112) QuantErr: 12.04112 batch_time=0.40548 
Train Epoch: 12 [61/1000 1952/32000 (6%)] Loss: 0.83235 (QuantReg: 11.99579) QuantErr: 11.99579 batch_time=0.37611 
Train Epoch: 12 [66/1000 2112/32000 (7%)] Loss: 0.95246 (QuantReg: 12.04873) QuantErr: 12.04873 batch_time=0.69625 
Train Epoch: 12 [71/1000 2272/32000 (7%)] Loss: 1.05682 (QuantReg: 11.36545) QuantErr: 11.36545 batch_time=0.36922 
Train Epoch: 12 [76/1000 2432/32000 (8%)] Loss: 0.52868 (QuantReg: 12.58440) QuantErr: 12.58440 batch_time=0.39361 
Train Epoch: 12 [81/1000 2592/32000 (8%)] Loss: 0.41567 (QuantReg: 12.22631) QuantErr: 12.22631 batch_time=1.08771 
Train Epoch: 12 [86/1000 2752/32000 (9%)] Loss: 0.67171 (QuantReg: 11.22230) QuantErr: 11.22230 batch_time=0.37985 
Train Epoch: 12 [91/1000 2912/32000 (9%)] Loss: 0.59585 (QuantReg: 11.97280) QuantErr: 11.97280 batch_time=0.43541 
Train Epoch: 12 [96/1000 3072/32000 (10%)] Loss: 0.55101 (QuantReg: 11.83202) QuantErr: 11.83202 batch_time=0.38729 
Train Epoch: 12 [101/1000 3232/32000 (10%)] Loss: 0.28660 (QuantReg: 11.99267) QuantErr: 11.99267 batch_time=0.38798 
Train Epoch: 12 [106/1000 3392/32000 (11%)] Loss: 0.66883 (QuantReg: 11.83526) QuantErr: 11.83526 batch_time=0.38377 
Train Epoch: 12 [111/1000 3552/32000 (11%)] Loss: 0.31392 (QuantReg: 10.80066) QuantErr: 10.80066 batch_time=0.34482 
Train Epoch: 12 [116/1000 3712/32000 (12%)] Loss: 1.43110 (QuantReg: 11.46543) QuantErr: 11.46543 batch_time=0.50768 
Train Epoch: 12 [121/1000 3872/32000 (12%)] Loss: 0.53747 (QuantReg: 12.10489) QuantErr: 12.10489 batch_time=0.37110 
Train Epoch: 12 [126/1000 4032/32000 (13%)] Loss: 0.39765 (QuantReg: 11.57907) QuantErr: 11.57907 batch_time=0.35330 
Train Epoch: 12 [131/1000 4192/32000 (13%)] Loss: 0.34805 (QuantReg: 12.22433) QuantErr: 12.22433 batch_time=0.36299 
Train Epoch: 12 [136/1000 4352/32000 (14%)] Loss: 0.80398 (QuantReg: 11.92083) QuantErr: 11.92083 batch_time=0.39551 
Train Epoch: 12 [141/1000 4512/32000 (14%)] Loss: 0.42093 (QuantReg: 12.30373) QuantErr: 12.30373 batch_time=0.41521 
Train Epoch: 12 [146/1000 4672/32000 (15%)] Loss: 0.35913 (QuantReg: 11.75630) QuantErr: 11.75630 batch_time=0.40170 
Train Epoch: 12 [151/1000 4832/32000 (15%)] Loss: 0.40985 (QuantReg: 11.93718) QuantErr: 11.93718 batch_time=0.36250 
Train Epoch: 12 [156/1000 4992/32000 (16%)] Loss: 0.38609 (QuantReg: 11.63333) QuantErr: 11.63333 batch_time=0.43954 
Train Epoch: 12 [161/1000 5152/32000 (16%)] Loss: 0.63283 (QuantReg: 11.74379) QuantErr: 11.74379 batch_time=0.36828 
Train Epoch: 12 [166/1000 5312/32000 (17%)] Loss: 0.99220 (QuantReg: 12.22325) QuantErr: 12.22325 batch_time=0.35794 
Train Epoch: 12 [171/1000 5472/32000 (17%)] Loss: 0.51265 (QuantReg: 12.36046) QuantErr: 12.36046 batch_time=0.35986 
Train Epoch: 12 [176/1000 5632/32000 (18%)] Loss: 0.47642 (QuantReg: 11.68653) QuantErr: 11.68653 batch_time=0.36597 
Train Epoch: 12 [181/1000 5792/32000 (18%)] Loss: 1.07497 (QuantReg: 12.36328) QuantErr: 12.36328 batch_time=0.38343 
Train Epoch: 12 [186/1000 5952/32000 (19%)] Loss: 0.84258 (QuantReg: 12.44091) QuantErr: 12.44091 batch_time=0.40155 
Train Epoch: 12 [191/1000 6112/32000 (19%)] Loss: 0.54344 (QuantReg: 11.63415) QuantErr: 11.63415 batch_time=0.43391 
Train Epoch: 12 [196/1000 6272/32000 (20%)] Loss: 0.46968 (QuantReg: 11.48625) QuantErr: 11.48625 batch_time=0.35696 
Train Epoch: 12 [201/1000 6432/32000 (20%)] Loss: 0.84719 (QuantReg: 12.16367) QuantErr: 12.16367 batch_time=0.35323 
Train Epoch: 12 [206/1000 6592/32000 (21%)] Loss: 0.70259 (QuantReg: 11.70482) QuantErr: 11.70482 batch_time=0.37701 
Train Epoch: 12 [211/1000 6752/32000 (21%)] Loss: 0.77404 (QuantReg: 11.63973) QuantErr: 11.63973 batch_time=0.37517 
Train Epoch: 12 [216/1000 6912/32000 (22%)] Loss: 0.47565 (QuantReg: 12.29657) QuantErr: 12.29657 batch_time=0.37833 
Train Epoch: 12 [221/1000 7072/32000 (22%)] Loss: 0.77247 (QuantReg: 11.99398) QuantErr: 11.99398 batch_time=0.37201 
Train Epoch: 12 [226/1000 7232/32000 (23%)] Loss: 0.57043 (QuantReg: 11.63894) QuantErr: 11.63894 batch_time=0.44141 
Train Epoch: 12 [231/1000 7392/32000 (23%)] Loss: 0.43902 (QuantReg: 11.66279) QuantErr: 11.66279 batch_time=0.35365 
Train Epoch: 12 [236/1000 7552/32000 (24%)] Loss: 0.73146 (QuantReg: 11.28220) QuantErr: 11.28220 batch_time=0.40362 
Train Epoch: 12 [241/1000 7712/32000 (24%)] Loss: 0.78919 (QuantReg: 11.87623) QuantErr: 11.87623 batch_time=0.38082 
Train Epoch: 12 [246/1000 7872/32000 (25%)] Loss: 0.78661 (QuantReg: 12.50165) QuantErr: 12.50165 batch_time=0.48037 
Train Epoch: 12 [251/1000 8032/32000 (25%)] Loss: 0.42332 (QuantReg: 11.70778) QuantErr: 11.70778 batch_time=0.36558 
Train Epoch: 12 [256/1000 8192/32000 (26%)] Loss: 0.53632 (QuantReg: 12.32489) QuantErr: 12.32489 batch_time=0.36275 
Train Epoch: 12 [261/1000 8352/32000 (26%)] Loss: 0.94394 (QuantReg: 11.36781) QuantErr: 11.36781 batch_time=0.37703 
Train Epoch: 12 [266/1000 8512/32000 (27%)] Loss: 0.88110 (QuantReg: 12.01737) QuantErr: 12.01737 batch_time=0.37602 
Train Epoch: 12 [271/1000 8672/32000 (27%)] Loss: 0.80779 (QuantReg: 11.79648) QuantErr: 11.79648 batch_time=0.35837 
Train Epoch: 12 [276/1000 8832/32000 (28%)] Loss: 0.98326 (QuantReg: 11.56631) QuantErr: 11.56631 batch_time=0.51266 
Train Epoch: 12 [281/1000 8992/32000 (28%)] Loss: 0.90414 (QuantReg: 12.49638) QuantErr: 12.49638 batch_time=0.42930 
Train Epoch: 12 [286/1000 9152/32000 (29%)] Loss: 0.70355 (QuantReg: 12.43693) QuantErr: 12.43693 batch_time=0.35754 
Train Epoch: 12 [291/1000 9312/32000 (29%)] Loss: 1.02798 (QuantReg: 11.20729) QuantErr: 11.20729 batch_time=0.38303 
Train Epoch: 12 [296/1000 9472/32000 (30%)] Loss: 1.07805 (QuantReg: 11.14019) QuantErr: 11.14019 batch_time=0.36813 
Train Epoch: 12 [301/1000 9632/32000 (30%)] Loss: 0.13521 (QuantReg: 12.62150) QuantErr: 12.62150 batch_time=0.35412 
Train Epoch: 12 [306/1000 9792/32000 (31%)] Loss: 0.91616 (QuantReg: 11.71498) QuantErr: 11.71498 batch_time=0.35436 
Train Epoch: 12 [311/1000 9952/32000 (31%)] Loss: 0.43086 (QuantReg: 11.59684) QuantErr: 11.59684 batch_time=0.34948 
Train Epoch: 12 [316/1000 10112/32000 (32%)] Loss: 0.53080 (QuantReg: 11.64700) QuantErr: 11.64700 batch_time=0.35768 
Train Epoch: 12 [321/1000 10272/32000 (32%)] Loss: 0.56443 (QuantReg: 11.81423) QuantErr: 11.81423 batch_time=0.35845 
Train Epoch: 12 [326/1000 10432/32000 (33%)] Loss: 1.49612 (QuantReg: 11.93229) QuantErr: 11.93229 batch_time=0.40574 
Train Epoch: 12 [331/1000 10592/32000 (33%)] Loss: 0.53207 (QuantReg: 12.05468) QuantErr: 12.05468 batch_time=0.36058 
Train Epoch: 12 [336/1000 10752/32000 (34%)] Loss: 0.57918 (QuantReg: 11.71890) QuantErr: 11.71890 batch_time=0.66198 
Train Epoch: 12 [341/1000 10912/32000 (34%)] Loss: 0.78871 (QuantReg: 12.17414) QuantErr: 12.17414 batch_time=0.35011 
Train Epoch: 12 [346/1000 11072/32000 (35%)] Loss: 1.20731 (QuantReg: 11.59207) QuantErr: 11.59207 batch_time=0.36034 
Train Epoch: 12 [351/1000 11232/32000 (35%)] Loss: 0.27802 (QuantReg: 11.66775) QuantErr: 11.66775 batch_time=0.35908 
Train Epoch: 12 [356/1000 11392/32000 (36%)] Loss: 0.32102 (QuantReg: 11.20914) QuantErr: 11.20914 batch_time=0.37064 
Train Epoch: 12 [361/1000 11552/32000 (36%)] Loss: 0.32235 (QuantReg: 11.08257) QuantErr: 11.08257 batch_time=0.35437 
Train Epoch: 12 [366/1000 11712/32000 (37%)] Loss: 0.48478 (QuantReg: 11.91812) QuantErr: 11.91812 batch_time=0.37109 
Train Epoch: 12 [371/1000 11872/32000 (37%)] Loss: 0.88310 (QuantReg: 11.97676) QuantErr: 11.97676 batch_time=0.41817 
Train Epoch: 12 [376/1000 12032/32000 (38%)] Loss: 0.66097 (QuantReg: 11.93940) QuantErr: 11.93940 batch_time=0.40309 
Train Epoch: 12 [381/1000 12192/32000 (38%)] Loss: 0.51375 (QuantReg: 11.42573) QuantErr: 11.42573 batch_time=0.39727 
Train Epoch: 12 [386/1000 12352/32000 (39%)] Loss: 0.46572 (QuantReg: 11.27382) QuantErr: 11.27382 batch_time=0.77415 
Train Epoch: 12 [391/1000 12512/32000 (39%)] Loss: 0.53059 (QuantReg: 11.79045) QuantErr: 11.79045 batch_time=0.38454 
Train Epoch: 12 [396/1000 12672/32000 (40%)] Loss: 0.61622 (QuantReg: 11.69208) QuantErr: 11.69208 batch_time=0.40157 
Train Epoch: 12 [401/1000 12832/32000 (40%)] Loss: 0.95705 (QuantReg: 11.88186) QuantErr: 11.88186 batch_time=1.06064 
Train Epoch: 12 [406/1000 12992/32000 (41%)] Loss: 0.60515 (QuantReg: 12.06672) QuantErr: 12.06672 batch_time=0.35577 
Train Epoch: 12 [411/1000 13152/32000 (41%)] Loss: 1.16515 (QuantReg: 11.24591) QuantErr: 11.24591 batch_time=0.38568 
Train Epoch: 12 [416/1000 13312/32000 (42%)] Loss: 1.09336 (QuantReg: 12.42313) QuantErr: 12.42313 batch_time=0.36264 
Train Epoch: 12 [421/1000 13472/32000 (42%)] Loss: 0.31910 (QuantReg: 11.86944) QuantErr: 11.86944 batch_time=0.40406 
Train Epoch: 12 [426/1000 13632/32000 (43%)] Loss: 0.68691 (QuantReg: 11.82356) QuantErr: 11.82356 batch_time=0.36522 
Train Epoch: 12 [431/1000 13792/32000 (43%)] Loss: 0.53273 (QuantReg: 11.77289) QuantErr: 11.77289 batch_time=0.40137 
Train Epoch: 12 [436/1000 13952/32000 (44%)] Loss: 0.89992 (QuantReg: 11.72793) QuantErr: 11.72793 batch_time=0.52061 
Train Epoch: 12 [441/1000 14112/32000 (44%)] Loss: 0.44347 (QuantReg: 11.67983) QuantErr: 11.67983 batch_time=0.35404 
Train Epoch: 12 [446/1000 14272/32000 (45%)] Loss: 0.44022 (QuantReg: 12.40143) QuantErr: 12.40143 batch_time=0.36421 
Train Epoch: 12 [451/1000 14432/32000 (45%)] Loss: 0.92933 (QuantReg: 12.13753) QuantErr: 12.13753 batch_time=0.37407 
Train Epoch: 12 [456/1000 14592/32000 (46%)] Loss: 0.73628 (QuantReg: 11.47856) QuantErr: 11.47856 batch_time=0.38181 
Train Epoch: 12 [461/1000 14752/32000 (46%)] Loss: 0.54330 (QuantReg: 11.97871) QuantErr: 11.97871 batch_time=0.35604 
Train Epoch: 12 [466/1000 14912/32000 (47%)] Loss: 0.37201 (QuantReg: 12.44812) QuantErr: 12.44812 batch_time=0.38556 
Train Epoch: 12 [471/1000 15072/32000 (47%)] Loss: 0.40914 (QuantReg: 11.85235) QuantErr: 11.85235 batch_time=0.36402 
Train Epoch: 12 [476/1000 15232/32000 (48%)] Loss: 0.85189 (QuantReg: 12.15018) QuantErr: 12.15018 batch_time=0.43287 
Train Epoch: 12 [481/1000 15392/32000 (48%)] Loss: 0.36990 (QuantReg: 12.07468) QuantErr: 12.07468 batch_time=0.35587 
Train Epoch: 12 [486/1000 15552/32000 (49%)] Loss: 0.61832 (QuantReg: 11.76311) QuantErr: 11.76311 batch_time=0.36344 
Train Epoch: 12 [491/1000 15712/32000 (49%)] Loss: 0.81476 (QuantReg: 11.98497) QuantErr: 11.98497 batch_time=0.35947 
Train Epoch: 12 [496/1000 15872/32000 (50%)] Loss: 0.32447 (QuantReg: 11.88264) QuantErr: 11.88264 batch_time=0.35443 
Train Epoch: 12 [501/1000 16032/32000 (50%)] Loss: 1.14300 (QuantReg: 11.30818) QuantErr: 11.30818 batch_time=0.35953 
Train Epoch: 12 [506/1000 16192/32000 (51%)] Loss: 0.72432 (QuantReg: 11.49888) QuantErr: 11.49888 batch_time=0.36294 
Train Epoch: 12 [511/1000 16352/32000 (51%)] Loss: 0.68451 (QuantReg: 11.51970) QuantErr: 11.51970 batch_time=0.38637 
Train Epoch: 12 [516/1000 16512/32000 (52%)] Loss: 0.44574 (QuantReg: 12.18597) QuantErr: 12.18597 batch_time=0.39118 
Train Epoch: 12 [521/1000 16672/32000 (52%)] Loss: 0.65024 (QuantReg: 11.63064) QuantErr: 11.63064 batch_time=0.36025 
Train Epoch: 12 [526/1000 16832/32000 (53%)] Loss: 0.71613 (QuantReg: 11.62591) QuantErr: 11.62591 batch_time=0.35608 
Train Epoch: 12 [531/1000 16992/32000 (53%)] Loss: 0.64907 (QuantReg: 12.09392) QuantErr: 12.09392 batch_time=0.36131 
Train Epoch: 12 [536/1000 17152/32000 (54%)] Loss: 0.56909 (QuantReg: 11.90924) QuantErr: 11.90924 batch_time=0.36908 
Train Epoch: 12 [541/1000 17312/32000 (54%)] Loss: 0.53644 (QuantReg: 11.74606) QuantErr: 11.74606 batch_time=0.40959 
Train Epoch: 12 [546/1000 17472/32000 (55%)] Loss: 1.23600 (QuantReg: 11.87038) QuantErr: 11.87038 batch_time=0.44614 
Train Epoch: 12 [551/1000 17632/32000 (55%)] Loss: 0.51609 (QuantReg: 11.55206) QuantErr: 11.55206 batch_time=0.38497 
Train Epoch: 12 [556/1000 17792/32000 (56%)] Loss: 0.71959 (QuantReg: 12.48635) QuantErr: 12.48635 batch_time=0.36411 
Train Epoch: 12 [561/1000 17952/32000 (56%)] Loss: 0.51439 (QuantReg: 11.77415) QuantErr: 11.77415 batch_time=0.38301 
Train Epoch: 12 [566/1000 18112/32000 (57%)] Loss: 0.40175 (QuantReg: 12.55375) QuantErr: 12.55375 batch_time=0.42031 
Train Epoch: 12 [571/1000 18272/32000 (57%)] Loss: 1.46059 (QuantReg: 12.21112) QuantErr: 12.21112 batch_time=0.35831 
Train Epoch: 12 [576/1000 18432/32000 (58%)] Loss: 0.79188 (QuantReg: 12.86071) QuantErr: 12.86071 batch_time=0.37056 
Train Epoch: 12 [581/1000 18592/32000 (58%)] Loss: 0.63620 (QuantReg: 11.76574) QuantErr: 11.76574 batch_time=0.35746 
Train Epoch: 12 [586/1000 18752/32000 (59%)] Loss: 1.10726 (QuantReg: 11.95030) QuantErr: 11.95030 batch_time=0.35734 
Train Epoch: 12 [591/1000 18912/32000 (59%)] Loss: 1.07105 (QuantReg: 11.75473) QuantErr: 11.75473 batch_time=0.38370 
Train Epoch: 12 [596/1000 19072/32000 (60%)] Loss: 0.72645 (QuantReg: 12.38386) QuantErr: 12.38386 batch_time=0.55418 
Train Epoch: 12 [601/1000 19232/32000 (60%)] Loss: 0.28918 (QuantReg: 11.84568) QuantErr: 11.84568 batch_time=0.42065 
Train Epoch: 12 [606/1000 19392/32000 (61%)] Loss: 0.17493 (QuantReg: 12.15416) QuantErr: 12.15416 batch_time=0.36605 
Train Epoch: 12 [611/1000 19552/32000 (61%)] Loss: 0.39106 (QuantReg: 11.73635) QuantErr: 11.73635 batch_time=0.42250 
Train Epoch: 12 [616/1000 19712/32000 (62%)] Loss: 0.25219 (QuantReg: 12.10983) QuantErr: 12.10983 batch_time=0.35762 
Train Epoch: 12 [621/1000 19872/32000 (62%)] Loss: 0.93176 (QuantReg: 12.54332) QuantErr: 12.54332 batch_time=0.37172 
Train Epoch: 12 [626/1000 20032/32000 (63%)] Loss: 0.95036 (QuantReg: 11.75647) QuantErr: 11.75647 batch_time=0.38531 
Train Epoch: 12 [631/1000 20192/32000 (63%)] Loss: 0.96534 (QuantReg: 11.93084) QuantErr: 11.93084 batch_time=0.36266 
Train Epoch: 12 [636/1000 20352/32000 (64%)] Loss: 0.32288 (QuantReg: 11.98518) QuantErr: 11.98518 batch_time=0.35286 
Train Epoch: 12 [641/1000 20512/32000 (64%)] Loss: 0.84847 (QuantReg: 11.45149) QuantErr: 11.45149 batch_time=0.35917 
Train Epoch: 12 [646/1000 20672/32000 (65%)] Loss: 0.38560 (QuantReg: 12.53320) QuantErr: 12.53320 batch_time=0.36172 
Train Epoch: 12 [651/1000 20832/32000 (65%)] Loss: 0.75838 (QuantReg: 12.17908) QuantErr: 12.17908 batch_time=0.34929 
Train Epoch: 12 [656/1000 20992/32000 (66%)] Loss: 0.31479 (QuantReg: 12.40288) QuantErr: 12.40288 batch_time=0.64084 
Train Epoch: 12 [661/1000 21152/32000 (66%)] Loss: 0.24794 (QuantReg: 11.90972) QuantErr: 11.90972 batch_time=0.41127 
Train Epoch: 12 [666/1000 21312/32000 (67%)] Loss: 0.57671 (QuantReg: 12.08923) QuantErr: 12.08923 batch_time=0.38574 
Train Epoch: 12 [671/1000 21472/32000 (67%)] Loss: 0.53029 (QuantReg: 11.89771) QuantErr: 11.89771 batch_time=0.35699 
Train Epoch: 12 [676/1000 21632/32000 (68%)] Loss: 1.02999 (QuantReg: 12.52332) QuantErr: 12.52332 batch_time=0.37090 
Train Epoch: 12 [681/1000 21792/32000 (68%)] Loss: 0.66646 (QuantReg: 12.39405) QuantErr: 12.39405 batch_time=0.43591 
Train Epoch: 12 [686/1000 21952/32000 (69%)] Loss: 0.38838 (QuantReg: 12.09528) QuantErr: 12.09528 batch_time=0.40705 
Train Epoch: 12 [691/1000 22112/32000 (69%)] Loss: 0.31869 (QuantReg: 12.58303) QuantErr: 12.58303 batch_time=0.37365 
Train Epoch: 12 [696/1000 22272/32000 (70%)] Loss: 0.51779 (QuantReg: 11.74348) QuantErr: 11.74348 batch_time=0.39163 
Train Epoch: 12 [701/1000 22432/32000 (70%)] Loss: 0.68548 (QuantReg: 12.14418) QuantErr: 12.14418 batch_time=0.39961 
Train Epoch: 12 [706/1000 22592/32000 (71%)] Loss: 0.37526 (QuantReg: 12.53777) QuantErr: 12.53777 batch_time=0.74561 
Train Epoch: 12 [711/1000 22752/32000 (71%)] Loss: 0.42935 (QuantReg: 12.00156) QuantErr: 12.00156 batch_time=0.38834 
Train Epoch: 12 [716/1000 22912/32000 (72%)] Loss: 0.78310 (QuantReg: 11.49677) QuantErr: 11.49677 batch_time=0.40483 
Train Epoch: 12 [721/1000 23072/32000 (72%)] Loss: 0.59452 (QuantReg: 11.87340) QuantErr: 11.87340 batch_time=1.04907 
Train Epoch: 12 [726/1000 23232/32000 (73%)] Loss: 0.90846 (QuantReg: 11.78149) QuantErr: 11.78149 batch_time=0.36265 
Train Epoch: 12 [731/1000 23392/32000 (73%)] Loss: 0.83073 (QuantReg: 12.46589) QuantErr: 12.46589 batch_time=0.37220 
Train Epoch: 12 [736/1000 23552/32000 (74%)] Loss: 1.09734 (QuantReg: 11.84278) QuantErr: 11.84278 batch_time=0.36083 
Train Epoch: 12 [741/1000 23712/32000 (74%)] Loss: 0.66993 (QuantReg: 12.10190) QuantErr: 12.10190 batch_time=0.39420 
Train Epoch: 12 [746/1000 23872/32000 (75%)] Loss: 0.95033 (QuantReg: 11.87174) QuantErr: 11.87174 batch_time=0.36782 
Train Epoch: 12 [751/1000 24032/32000 (75%)] Loss: 0.37169 (QuantReg: 12.31208) QuantErr: 12.31208 batch_time=0.40678 
Train Epoch: 12 [756/1000 24192/32000 (76%)] Loss: 0.41880 (QuantReg: 11.74898) QuantErr: 11.74898 batch_time=0.50838 
Train Epoch: 12 [761/1000 24352/32000 (76%)] Loss: 0.74407 (QuantReg: 11.56202) QuantErr: 11.56202 batch_time=0.35744 
Train Epoch: 12 [766/1000 24512/32000 (77%)] Loss: 0.80098 (QuantReg: 12.39620) QuantErr: 12.39620 batch_time=0.37644 
Train Epoch: 12 [771/1000 24672/32000 (77%)] Loss: 0.99369 (QuantReg: 12.09730) QuantErr: 12.09730 batch_time=0.34907 
Train Epoch: 12 [776/1000 24832/32000 (78%)] Loss: 0.90196 (QuantReg: 11.75912) QuantErr: 11.75912 batch_time=0.35680 
Train Epoch: 12 [781/1000 24992/32000 (78%)] Loss: 0.38372 (QuantReg: 11.63258) QuantErr: 11.63258 batch_time=0.38495 
Train Epoch: 12 [786/1000 25152/32000 (79%)] Loss: 0.28742 (QuantReg: 12.63611) QuantErr: 12.63611 batch_time=0.39395 
Train Epoch: 12 [791/1000 25312/32000 (79%)] Loss: 1.36979 (QuantReg: 11.92527) QuantErr: 11.92527 batch_time=0.37208 
Train Epoch: 12 [796/1000 25472/32000 (80%)] Loss: 0.51847 (QuantReg: 12.33391) QuantErr: 12.33391 batch_time=0.43456 
Train Epoch: 12 [801/1000 25632/32000 (80%)] Loss: 0.93001 (QuantReg: 11.86534) QuantErr: 11.86534 batch_time=0.36408 
Train Epoch: 12 [806/1000 25792/32000 (81%)] Loss: 0.39582 (QuantReg: 12.62104) QuantErr: 12.62104 batch_time=0.35218 
Train Epoch: 12 [811/1000 25952/32000 (81%)] Loss: 0.98037 (QuantReg: 12.37116) QuantErr: 12.37116 batch_time=0.37516 
Train Epoch: 12 [816/1000 26112/32000 (82%)] Loss: 0.37239 (QuantReg: 12.57129) QuantErr: 12.57129 batch_time=0.40861 
Train Epoch: 12 [821/1000 26272/32000 (82%)] Loss: 0.24805 (QuantReg: 11.75337) QuantErr: 11.75337 batch_time=0.36756 
Train Epoch: 12 [826/1000 26432/32000 (83%)] Loss: 0.38174 (QuantReg: 11.92889) QuantErr: 11.92889 batch_time=0.35350 
Train Epoch: 12 [831/1000 26592/32000 (83%)] Loss: 0.69987 (QuantReg: 11.93126) QuantErr: 11.93126 batch_time=0.36322 
Train Epoch: 12 [836/1000 26752/32000 (84%)] Loss: 1.01108 (QuantReg: 12.16942) QuantErr: 12.16942 batch_time=0.36564 
Train Epoch: 12 [841/1000 26912/32000 (84%)] Loss: 0.64928 (QuantReg: 12.00339) QuantErr: 12.00339 batch_time=0.35553 
Train Epoch: 12 [846/1000 27072/32000 (85%)] Loss: 0.25289 (QuantReg: 12.39191) QuantErr: 12.39191 batch_time=0.37960 
Train Epoch: 12 [851/1000 27232/32000 (85%)] Loss: 0.70158 (QuantReg: 11.41143) QuantErr: 11.41143 batch_time=0.36148 
Train Epoch: 12 [856/1000 27392/32000 (86%)] Loss: 0.56985 (QuantReg: 12.31824) QuantErr: 12.31824 batch_time=0.36477 
Train Epoch: 12 [861/1000 27552/32000 (86%)] Loss: 1.27309 (QuantReg: 11.63659) QuantErr: 11.63659 batch_time=0.35875 
Train Epoch: 12 [866/1000 27712/32000 (87%)] Loss: 0.27195 (QuantReg: 12.29884) QuantErr: 12.29884 batch_time=0.47314 
Train Epoch: 12 [871/1000 27872/32000 (87%)] Loss: 0.50411 (QuantReg: 12.49547) QuantErr: 12.49547 batch_time=0.43251 
Train Epoch: 12 [876/1000 28032/32000 (88%)] Loss: 1.05798 (QuantReg: 11.82937) QuantErr: 11.82937 batch_time=0.41769 
Train Epoch: 12 [881/1000 28192/32000 (88%)] Loss: 0.79566 (QuantReg: 11.47609) QuantErr: 11.47609 batch_time=0.36015 
Train Epoch: 12 [886/1000 28352/32000 (89%)] Loss: 1.16252 (QuantReg: 11.98446) QuantErr: 11.98446 batch_time=0.40845 
Train Epoch: 12 [891/1000 28512/32000 (89%)] Loss: 0.57272 (QuantReg: 12.32301) QuantErr: 12.32301 batch_time=0.36253 
Train Epoch: 12 [896/1000 28672/32000 (90%)] Loss: 0.26821 (QuantReg: 12.26985) QuantErr: 12.26985 batch_time=0.41861 
Train Epoch: 12 [901/1000 28832/32000 (90%)] Loss: 0.67567 (QuantReg: 12.09615) QuantErr: 12.09615 batch_time=0.39611 
Train Epoch: 12 [906/1000 28992/32000 (91%)] Loss: 0.54645 (QuantReg: 12.15459) QuantErr: 12.15459 batch_time=0.40467 
Train Epoch: 12 [911/1000 29152/32000 (91%)] Loss: 0.21646 (QuantReg: 11.67835) QuantErr: 11.67835 batch_time=0.37373 
Train Epoch: 12 [916/1000 29312/32000 (92%)] Loss: 0.61137 (QuantReg: 12.25250) QuantErr: 12.25250 batch_time=0.56191 
Train Epoch: 12 [921/1000 29472/32000 (92%)] Loss: 0.72767 (QuantReg: 12.40379) QuantErr: 12.40379 batch_time=0.44524 
Train Epoch: 12 [926/1000 29632/32000 (93%)] Loss: 0.46906 (QuantReg: 12.60181) QuantErr: 12.60181 batch_time=0.35894 
Train Epoch: 12 [931/1000 29792/32000 (93%)] Loss: 0.76138 (QuantReg: 12.53930) QuantErr: 12.53930 batch_time=0.38773 
Train Epoch: 12 [936/1000 29952/32000 (94%)] Loss: 0.89171 (QuantReg: 12.29419) QuantErr: 12.29419 batch_time=0.36415 
Train Epoch: 12 [941/1000 30112/32000 (94%)] Loss: 0.55882 (QuantReg: 12.33739) QuantErr: 12.33739 batch_time=0.35620 
Train Epoch: 12 [946/1000 30272/32000 (95%)] Loss: 1.34466 (QuantReg: 12.98532) QuantErr: 12.98532 batch_time=0.36231 
Train Epoch: 12 [951/1000 30432/32000 (95%)] Loss: 0.79566 (QuantReg: 12.18676) QuantErr: 12.18676 batch_time=0.38410 
Train Epoch: 12 [956/1000 30592/32000 (96%)] Loss: 0.52556 (QuantReg: 12.06303) QuantErr: 12.06303 batch_time=0.37176 
Train Epoch: 12 [961/1000 30752/32000 (96%)] Loss: 0.32507 (QuantReg: 11.52157) QuantErr: 11.52157 batch_time=0.36242 
Train Epoch: 12 [966/1000 30912/32000 (97%)] Loss: 0.80970 (QuantReg: 12.08253) QuantErr: 12.08253 batch_time=0.36540 
Train Epoch: 12 [971/1000 31072/32000 (97%)] Loss: 0.76723 (QuantReg: 11.86597) QuantErr: 11.86597 batch_time=0.36884 
Train Epoch: 12 [976/1000 31232/32000 (98%)] Loss: 0.81358 (QuantReg: 12.51773) QuantErr: 12.51773 batch_time=0.69181 
Train Epoch: 12 [981/1000 31392/32000 (98%)] Loss: 0.50203 (QuantReg: 11.67762) QuantErr: 11.67762 batch_time=0.35786 
Train Epoch: 12 [986/1000 31552/32000 (99%)] Loss: 0.47874 (QuantReg: 12.30324) QuantErr: 12.30324 batch_time=0.36337 
Train Epoch: 12 [991/1000 31712/32000 (99%)] Loss: 0.40675 (QuantReg: 11.55353) QuantErr: 11.55353 batch_time=0.35772 
Train Epoch: 12 [996/1000 31872/32000 (100%)] Loss: 0.28976 (QuantReg: 12.57818) QuantErr: 12.57818 batch_time=0.38814 
Train Epoch: 12 codebook_update_time=2.11405
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch12.pth ...
Done in 7.576s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch12.pth ...
Done in 11.877s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 0.6621419106051326
 quant_reg      : 11.994697016716003
 quant_err      : 11.994697016716003
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 12000
 MSRVTT_full_val/t2v_metrics/R1: 27.16297786720322
 MSRVTT_full_val/t2v_metrics/R5: 65.59356136820925
 MSRVTT_full_val/t2v_metrics/R10: 77.46478873239437
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.78672032193159
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.67902489966321
 MSRVTT_full_val/v2t_metrics/R1: 31.187122736418512
 MSRVTT_full_val/v2t_metrics/R5: 70.82494969818913
 MSRVTT_full_val/v2t_metrics/R10: 84.10462776659959
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.104627766599598
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.05939454640754
 MSRVTT_full_test/t2v_metrics/R1: 10.40133779264214
 MSRVTT_full_test/t2v_metrics/R5: 30.76923076923077
 MSRVTT_full_test/t2v_metrics/R10: 45.88628762541806
 MSRVTT_full_test/t2v_metrics/R50: 79.03010033444816
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.0123745819398
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.488541553119894
 MSRVTT_full_test/v2t_metrics/R1: 12.54180602006689
 MSRVTT_full_test/v2t_metrics/R5: 36.08695652173913
 MSRVTT_full_test/v2t_metrics/R10: 51.00334448160535
 MSRVTT_full_test/v2t_metrics/R50: 84.84949832775919
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 36.02759197324415
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.473203389351777
 mnt_best       : 24.488541553119894
 not_improved_count: 0
Train Epoch: 13 [1/1000 32/32000 (0%)] Loss: 0.79430 (QuantReg: 12.35070) QuantErr: 12.35070 batch_time=29.05464 
Train Epoch: 13 [6/1000 192/32000 (1%)] Loss: 0.96394 (QuantReg: 11.53781) QuantErr: 11.53781 batch_time=0.37240 
Train Epoch: 13 [11/1000 352/32000 (1%)] Loss: 0.55657 (QuantReg: 12.51621) QuantErr: 12.51621 batch_time=0.40631 
Train Epoch: 13 [16/1000 512/32000 (2%)] Loss: 0.74451 (QuantReg: 11.29367) QuantErr: 11.29367 batch_time=0.34646 
Train Epoch: 13 [21/1000 672/32000 (2%)] Loss: 0.85256 (QuantReg: 11.73864) QuantErr: 11.73864 batch_time=0.38167 
Train Epoch: 13 [26/1000 832/32000 (3%)] Loss: 0.34323 (QuantReg: 11.61761) QuantErr: 11.61761 batch_time=0.34668 
Train Epoch: 13 [31/1000 992/32000 (3%)] Loss: 0.50631 (QuantReg: 12.48277) QuantErr: 12.48277 batch_time=0.34827 
Train Epoch: 13 [36/1000 1152/32000 (4%)] Loss: 0.87376 (QuantReg: 11.93801) QuantErr: 11.93801 batch_time=0.38266 
Train Epoch: 13 [41/1000 1312/32000 (4%)] Loss: 0.74990 (QuantReg: 12.53627) QuantErr: 12.53627 batch_time=0.36538 
Train Epoch: 13 [46/1000 1472/32000 (5%)] Loss: 0.56969 (QuantReg: 10.97248) QuantErr: 10.97248 batch_time=0.36964 
Train Epoch: 13 [51/1000 1632/32000 (5%)] Loss: 0.86834 (QuantReg: 12.44075) QuantErr: 12.44075 batch_time=0.35484 
Train Epoch: 13 [56/1000 1792/32000 (6%)] Loss: 0.76981 (QuantReg: 12.18534) QuantErr: 12.18534 batch_time=0.34985 
Train Epoch: 13 [61/1000 1952/32000 (6%)] Loss: 0.24293 (QuantReg: 12.86862) QuantErr: 12.86862 batch_time=0.35484 
Train Epoch: 13 [66/1000 2112/32000 (7%)] Loss: 0.45557 (QuantReg: 11.90551) QuantErr: 11.90551 batch_time=0.44360 
Train Epoch: 13 [71/1000 2272/32000 (7%)] Loss: 0.64130 (QuantReg: 11.79967) QuantErr: 11.79967 batch_time=0.34906 
Train Epoch: 13 [76/1000 2432/32000 (8%)] Loss: 0.89558 (QuantReg: 12.20535) QuantErr: 12.20535 batch_time=0.37560 
Train Epoch: 13 [81/1000 2592/32000 (8%)] Loss: 0.32013 (QuantReg: 12.44143) QuantErr: 12.44143 batch_time=0.34731 
Train Epoch: 13 [86/1000 2752/32000 (9%)] Loss: 0.53454 (QuantReg: 11.56318) QuantErr: 11.56318 batch_time=0.34677 
Train Epoch: 13 [91/1000 2912/32000 (9%)] Loss: 0.44216 (QuantReg: 12.02455) QuantErr: 12.02455 batch_time=0.34134 
Train Epoch: 13 [96/1000 3072/32000 (10%)] Loss: 0.79093 (QuantReg: 11.30402) QuantErr: 11.30402 batch_time=0.34874 
Train Epoch: 13 [101/1000 3232/32000 (10%)] Loss: 0.62377 (QuantReg: 11.89799) QuantErr: 11.89799 batch_time=0.36050 
Train Epoch: 13 [106/1000 3392/32000 (11%)] Loss: 0.61742 (QuantReg: 12.29162) QuantErr: 12.29162 batch_time=0.34827 
Train Epoch: 13 [111/1000 3552/32000 (11%)] Loss: 0.64001 (QuantReg: 11.98686) QuantErr: 11.98686 batch_time=0.36575 
Train Epoch: 13 [116/1000 3712/32000 (12%)] Loss: 0.40468 (QuantReg: 11.80807) QuantErr: 11.80807 batch_time=0.40054 
Train Epoch: 13 [121/1000 3872/32000 (12%)] Loss: 1.24378 (QuantReg: 10.57628) QuantErr: 10.57628 batch_time=0.35853 
Train Epoch: 13 [126/1000 4032/32000 (13%)] Loss: 0.79622 (QuantReg: 11.23611) QuantErr: 11.23611 batch_time=0.36027 
Train Epoch: 13 [131/1000 4192/32000 (13%)] Loss: 0.78355 (QuantReg: 11.86212) QuantErr: 11.86212 batch_time=0.42962 
Train Epoch: 13 [136/1000 4352/32000 (14%)] Loss: 0.31445 (QuantReg: 12.45260) QuantErr: 12.45260 batch_time=0.36883 
Train Epoch: 13 [141/1000 4512/32000 (14%)] Loss: 0.36197 (QuantReg: 11.95864) QuantErr: 11.95864 batch_time=0.34890 
Train Epoch: 13 [146/1000 4672/32000 (15%)] Loss: 0.72197 (QuantReg: 12.32959) QuantErr: 12.32959 batch_time=0.36674 
Train Epoch: 13 [151/1000 4832/32000 (15%)] Loss: 0.83229 (QuantReg: 12.51235) QuantErr: 12.51235 batch_time=0.35636 
Train Epoch: 13 [156/1000 4992/32000 (16%)] Loss: 0.60309 (QuantReg: 11.52122) QuantErr: 11.52122 batch_time=0.34959 
Train Epoch: 13 [161/1000 5152/32000 (16%)] Loss: 0.65511 (QuantReg: 12.50982) QuantErr: 12.50982 batch_time=0.34815 
Train Epoch: 13 [166/1000 5312/32000 (17%)] Loss: 0.38004 (QuantReg: 12.53174) QuantErr: 12.53174 batch_time=0.36117 
Train Epoch: 13 [171/1000 5472/32000 (17%)] Loss: 1.02243 (QuantReg: 12.61012) QuantErr: 12.61012 batch_time=0.35202 
Train Epoch: 13 [176/1000 5632/32000 (18%)] Loss: 0.46106 (QuantReg: 12.17558) QuantErr: 12.17558 batch_time=0.35356 
Train Epoch: 13 [181/1000 5792/32000 (18%)] Loss: 0.99257 (QuantReg: 11.36572) QuantErr: 11.36572 batch_time=0.35501 
Train Epoch: 13 [186/1000 5952/32000 (19%)] Loss: 0.47432 (QuantReg: 11.50514) QuantErr: 11.50514 batch_time=0.35358 
Train Epoch: 13 [191/1000 6112/32000 (19%)] Loss: 0.39668 (QuantReg: 11.79158) QuantErr: 11.79158 batch_time=0.37135 
Train Epoch: 13 [196/1000 6272/32000 (20%)] Loss: 0.68665 (QuantReg: 12.17383) QuantErr: 12.17383 batch_time=0.35111 
Train Epoch: 13 [201/1000 6432/32000 (20%)] Loss: 0.35180 (QuantReg: 11.77343) QuantErr: 11.77343 batch_time=0.35520 
Train Epoch: 13 [206/1000 6592/32000 (21%)] Loss: 1.07703 (QuantReg: 11.66912) QuantErr: 11.66912 batch_time=0.34987 
Train Epoch: 13 [211/1000 6752/32000 (21%)] Loss: 0.49328 (QuantReg: 12.00770) QuantErr: 12.00770 batch_time=0.34824 
Train Epoch: 13 [216/1000 6912/32000 (22%)] Loss: 0.57485 (QuantReg: 11.51347) QuantErr: 11.51347 batch_time=0.36818 
Train Epoch: 13 [221/1000 7072/32000 (22%)] Loss: 0.55108 (QuantReg: 12.61047) QuantErr: 12.61047 batch_time=0.34892 
Train Epoch: 13 [226/1000 7232/32000 (23%)] Loss: 0.71469 (QuantReg: 12.71447) QuantErr: 12.71447 batch_time=0.36371 
Train Epoch: 13 [231/1000 7392/32000 (23%)] Loss: 0.75313 (QuantReg: 11.94542) QuantErr: 11.94542 batch_time=0.34727 
Train Epoch: 13 [236/1000 7552/32000 (24%)] Loss: 0.33779 (QuantReg: 12.05630) QuantErr: 12.05630 batch_time=0.34765 
Train Epoch: 13 [241/1000 7712/32000 (24%)] Loss: 0.98799 (QuantReg: 12.20306) QuantErr: 12.20306 batch_time=0.35380 
Train Epoch: 13 [246/1000 7872/32000 (25%)] Loss: 0.84023 (QuantReg: 12.12727) QuantErr: 12.12727 batch_time=0.38988 
Train Epoch: 13 [251/1000 8032/32000 (25%)] Loss: 0.86411 (QuantReg: 12.08426) QuantErr: 12.08426 batch_time=0.38415 
Train Epoch: 13 [256/1000 8192/32000 (26%)] Loss: 0.69246 (QuantReg: 12.00035) QuantErr: 12.00035 batch_time=0.34497 
Train Epoch: 13 [261/1000 8352/32000 (26%)] Loss: 0.53587 (QuantReg: 11.67096) QuantErr: 11.67096 batch_time=0.36437 
Train Epoch: 13 [266/1000 8512/32000 (27%)] Loss: 0.30047 (QuantReg: 12.32765) QuantErr: 12.32765 batch_time=0.35877 
Train Epoch: 13 [271/1000 8672/32000 (27%)] Loss: 1.30109 (QuantReg: 11.53798) QuantErr: 11.53798 batch_time=0.35289 
Train Epoch: 13 [276/1000 8832/32000 (28%)] Loss: 0.36083 (QuantReg: 11.84562) QuantErr: 11.84562 batch_time=0.36770 
Train Epoch: 13 [281/1000 8992/32000 (28%)] Loss: 0.43649 (QuantReg: 11.45733) QuantErr: 11.45733 batch_time=0.36495 
Train Epoch: 13 [286/1000 9152/32000 (29%)] Loss: 0.42457 (QuantReg: 12.25895) QuantErr: 12.25895 batch_time=0.38471 
Train Epoch: 13 [291/1000 9312/32000 (29%)] Loss: 0.30403 (QuantReg: 12.80857) QuantErr: 12.80857 batch_time=0.35408 
Train Epoch: 13 [296/1000 9472/32000 (30%)] Loss: 1.30126 (QuantReg: 11.83139) QuantErr: 11.83139 batch_time=0.35260 
Train Epoch: 13 [301/1000 9632/32000 (30%)] Loss: 1.04988 (QuantReg: 12.12844) QuantErr: 12.12844 batch_time=0.35316 
Train Epoch: 13 [306/1000 9792/32000 (31%)] Loss: 0.23730 (QuantReg: 12.29458) QuantErr: 12.29458 batch_time=0.35167 
Train Epoch: 13 [311/1000 9952/32000 (31%)] Loss: 0.29344 (QuantReg: 11.94543) QuantErr: 11.94543 batch_time=0.35765 
Train Epoch: 13 [316/1000 10112/32000 (32%)] Loss: 0.76308 (QuantReg: 12.47114) QuantErr: 12.47114 batch_time=0.37502 
Train Epoch: 13 [321/1000 10272/32000 (32%)] Loss: 0.86527 (QuantReg: 11.54414) QuantErr: 11.54414 batch_time=0.35390 
Train Epoch: 13 [326/1000 10432/32000 (33%)] Loss: 0.60232 (QuantReg: 12.67208) QuantErr: 12.67208 batch_time=0.36648 
Train Epoch: 13 [331/1000 10592/32000 (33%)] Loss: 0.42278 (QuantReg: 12.27129) QuantErr: 12.27129 batch_time=0.41844 
Train Epoch: 13 [336/1000 10752/32000 (34%)] Loss: 0.55050 (QuantReg: 11.79863) QuantErr: 11.79863 batch_time=0.36463 
Train Epoch: 13 [341/1000 10912/32000 (34%)] Loss: 0.76360 (QuantReg: 12.28497) QuantErr: 12.28497 batch_time=0.38722 
Train Epoch: 13 [346/1000 11072/32000 (35%)] Loss: 0.65360 (QuantReg: 12.61149) QuantErr: 12.61149 batch_time=0.35495 
Train Epoch: 13 [351/1000 11232/32000 (35%)] Loss: 0.72140 (QuantReg: 12.58406) QuantErr: 12.58406 batch_time=0.35590 
Train Epoch: 13 [356/1000 11392/32000 (36%)] Loss: 0.62504 (QuantReg: 11.67367) QuantErr: 11.67367 batch_time=0.36031 
Train Epoch: 13 [361/1000 11552/32000 (36%)] Loss: 0.36723 (QuantReg: 12.36729) QuantErr: 12.36729 batch_time=0.45455 
Train Epoch: 13 [366/1000 11712/32000 (37%)] Loss: 0.58121 (QuantReg: 12.20928) QuantErr: 12.20928 batch_time=0.40105 
Train Epoch: 13 [371/1000 11872/32000 (37%)] Loss: 0.50651 (QuantReg: 11.76528) QuantErr: 11.76528 batch_time=0.38029 
Train Epoch: 13 [376/1000 12032/32000 (38%)] Loss: 0.82878 (QuantReg: 11.70694) QuantErr: 11.70694 batch_time=0.35328 
Train Epoch: 13 [381/1000 12192/32000 (38%)] Loss: 0.37612 (QuantReg: 11.73075) QuantErr: 11.73075 batch_time=0.35895 
Train Epoch: 13 [386/1000 12352/32000 (39%)] Loss: 0.55459 (QuantReg: 12.63087) QuantErr: 12.63087 batch_time=2.36046 
Train Epoch: 13 [391/1000 12512/32000 (39%)] Loss: 0.22788 (QuantReg: 12.52531) QuantErr: 12.52531 batch_time=0.36111 
Train Epoch: 13 [396/1000 12672/32000 (40%)] Loss: 0.61843 (QuantReg: 12.52293) QuantErr: 12.52293 batch_time=0.39166 
Train Epoch: 13 [401/1000 12832/32000 (40%)] Loss: 0.92222 (QuantReg: 11.21218) QuantErr: 11.21218 batch_time=0.35463 
Train Epoch: 13 [406/1000 12992/32000 (41%)] Loss: 0.43653 (QuantReg: 11.53178) QuantErr: 11.53178 batch_time=0.35308 
Train Epoch: 13 [411/1000 13152/32000 (41%)] Loss: 0.50210 (QuantReg: 11.93627) QuantErr: 11.93627 batch_time=0.37570 
Train Epoch: 13 [416/1000 13312/32000 (42%)] Loss: 0.71900 (QuantReg: 12.30117) QuantErr: 12.30117 batch_time=0.35733 
Train Epoch: 13 [421/1000 13472/32000 (42%)] Loss: 0.59432 (QuantReg: 12.08240) QuantErr: 12.08240 batch_time=0.38576 
Train Epoch: 13 [426/1000 13632/32000 (43%)] Loss: 1.20962 (QuantReg: 11.26702) QuantErr: 11.26702 batch_time=0.36482 
Train Epoch: 13 [431/1000 13792/32000 (43%)] Loss: 0.74560 (QuantReg: 11.29998) QuantErr: 11.29998 batch_time=0.38464 
Train Epoch: 13 [436/1000 13952/32000 (44%)] Loss: 1.28041 (QuantReg: 11.52193) QuantErr: 11.52193 batch_time=0.35335 
Train Epoch: 13 [441/1000 14112/32000 (44%)] Loss: 0.65162 (QuantReg: 12.27627) QuantErr: 12.27627 batch_time=0.35775 
Train Epoch: 13 [446/1000 14272/32000 (45%)] Loss: 0.74482 (QuantReg: 11.93380) QuantErr: 11.93380 batch_time=0.36586 
Train Epoch: 13 [451/1000 14432/32000 (45%)] Loss: 0.52502 (QuantReg: 11.99504) QuantErr: 11.99504 batch_time=0.37726 
Train Epoch: 13 [456/1000 14592/32000 (46%)] Loss: 0.20003 (QuantReg: 12.14877) QuantErr: 12.14877 batch_time=0.38654 
Train Epoch: 13 [461/1000 14752/32000 (46%)] Loss: 0.38461 (QuantReg: 12.24917) QuantErr: 12.24917 batch_time=0.37225 
Train Epoch: 13 [466/1000 14912/32000 (47%)] Loss: 0.51548 (QuantReg: 12.41894) QuantErr: 12.41894 batch_time=0.35514 
Train Epoch: 13 [471/1000 15072/32000 (47%)] Loss: 0.78092 (QuantReg: 11.85603) QuantErr: 11.85603 batch_time=0.35332 
Train Epoch: 13 [476/1000 15232/32000 (48%)] Loss: 0.82309 (QuantReg: 11.94187) QuantErr: 11.94187 batch_time=0.35107 
Train Epoch: 13 [481/1000 15392/32000 (48%)] Loss: 0.65470 (QuantReg: 11.65889) QuantErr: 11.65889 batch_time=0.35363 
Train Epoch: 13 [486/1000 15552/32000 (49%)] Loss: 0.64586 (QuantReg: 12.07590) QuantErr: 12.07590 batch_time=0.36248 
Train Epoch: 13 [491/1000 15712/32000 (49%)] Loss: 0.78115 (QuantReg: 12.80132) QuantErr: 12.80132 batch_time=0.43744 
Train Epoch: 13 [496/1000 15872/32000 (50%)] Loss: 0.53177 (QuantReg: 12.69034) QuantErr: 12.69034 batch_time=0.35615 
Train Epoch: 13 [501/1000 16032/32000 (50%)] Loss: 0.93570 (QuantReg: 11.37906) QuantErr: 11.37906 batch_time=0.35118 
Train Epoch: 13 [506/1000 16192/32000 (51%)] Loss: 0.34879 (QuantReg: 12.16814) QuantErr: 12.16814 batch_time=0.36008 
Train Epoch: 13 [511/1000 16352/32000 (51%)] Loss: 0.92222 (QuantReg: 11.59658) QuantErr: 11.59658 batch_time=0.38492 
Train Epoch: 13 [516/1000 16512/32000 (52%)] Loss: 0.64532 (QuantReg: 11.30588) QuantErr: 11.30588 batch_time=0.35156 
Train Epoch: 13 [521/1000 16672/32000 (52%)] Loss: 0.96914 (QuantReg: 12.19162) QuantErr: 12.19162 batch_time=0.35308 
Train Epoch: 13 [526/1000 16832/32000 (53%)] Loss: 0.43669 (QuantReg: 11.13754) QuantErr: 11.13754 batch_time=0.35971 
Train Epoch: 13 [531/1000 16992/32000 (53%)] Loss: 0.28901 (QuantReg: 12.88909) QuantErr: 12.88909 batch_time=0.36179 
Train Epoch: 13 [536/1000 17152/32000 (54%)] Loss: 0.72557 (QuantReg: 12.66688) QuantErr: 12.66688 batch_time=0.36556 
Train Epoch: 13 [541/1000 17312/32000 (54%)] Loss: 0.74837 (QuantReg: 11.96132) QuantErr: 11.96132 batch_time=0.35002 
Train Epoch: 13 [546/1000 17472/32000 (55%)] Loss: 0.71049 (QuantReg: 12.08334) QuantErr: 12.08334 batch_time=0.34959 
Train Epoch: 13 [551/1000 17632/32000 (55%)] Loss: 0.43946 (QuantReg: 12.58179) QuantErr: 12.58179 batch_time=0.41018 
Train Epoch: 13 [556/1000 17792/32000 (56%)] Loss: 0.42466 (QuantReg: 12.62165) QuantErr: 12.62165 batch_time=0.41044 
Train Epoch: 13 [561/1000 17952/32000 (56%)] Loss: 1.24052 (QuantReg: 11.72458) QuantErr: 11.72458 batch_time=0.41357 
Train Epoch: 13 [566/1000 18112/32000 (57%)] Loss: 0.54494 (QuantReg: 11.89037) QuantErr: 11.89037 batch_time=0.45587 
Train Epoch: 13 [571/1000 18272/32000 (57%)] Loss: 0.60911 (QuantReg: 11.64277) QuantErr: 11.64277 batch_time=0.35359 
Train Epoch: 13 [576/1000 18432/32000 (58%)] Loss: 0.65099 (QuantReg: 12.15192) QuantErr: 12.15192 batch_time=0.39400 
Train Epoch: 13 [581/1000 18592/32000 (58%)] Loss: 0.60635 (QuantReg: 12.69620) QuantErr: 12.69620 batch_time=0.35912 
Train Epoch: 13 [586/1000 18752/32000 (59%)] Loss: 0.40982 (QuantReg: 12.76594) QuantErr: 12.76594 batch_time=0.35476 
Train Epoch: 13 [591/1000 18912/32000 (59%)] Loss: 0.29012 (QuantReg: 12.88387) QuantErr: 12.88387 batch_time=0.38122 
Train Epoch: 13 [596/1000 19072/32000 (60%)] Loss: 0.88338 (QuantReg: 11.39179) QuantErr: 11.39179 batch_time=0.38958 
Train Epoch: 13 [601/1000 19232/32000 (60%)] Loss: 0.48231 (QuantReg: 11.80388) QuantErr: 11.80388 batch_time=0.35549 
Train Epoch: 13 [606/1000 19392/32000 (61%)] Loss: 0.68025 (QuantReg: 12.22357) QuantErr: 12.22357 batch_time=0.37484 
Train Epoch: 13 [611/1000 19552/32000 (61%)] Loss: 1.03408 (QuantReg: 11.69407) QuantErr: 11.69407 batch_time=0.35087 
Train Epoch: 13 [616/1000 19712/32000 (62%)] Loss: 0.75331 (QuantReg: 11.92346) QuantErr: 11.92346 batch_time=0.40891 
Train Epoch: 13 [621/1000 19872/32000 (62%)] Loss: 1.10881 (QuantReg: 12.37703) QuantErr: 12.37703 batch_time=0.37355 
Train Epoch: 13 [626/1000 20032/32000 (63%)] Loss: 0.63461 (QuantReg: 11.07180) QuantErr: 11.07180 batch_time=0.35818 
Train Epoch: 13 [631/1000 20192/32000 (63%)] Loss: 0.60122 (QuantReg: 12.20367) QuantErr: 12.20367 batch_time=0.36454 
Train Epoch: 13 [636/1000 20352/32000 (64%)] Loss: 0.37174 (QuantReg: 12.17182) QuantErr: 12.17182 batch_time=0.36568 
Train Epoch: 13 [641/1000 20512/32000 (64%)] Loss: 0.50763 (QuantReg: 11.98258) QuantErr: 11.98258 batch_time=0.37777 
Train Epoch: 13 [646/1000 20672/32000 (65%)] Loss: 0.42029 (QuantReg: 12.75351) QuantErr: 12.75351 batch_time=0.35788 
Train Epoch: 13 [651/1000 20832/32000 (65%)] Loss: 0.33410 (QuantReg: 12.55695) QuantErr: 12.55695 batch_time=0.36043 
Train Epoch: 13 [656/1000 20992/32000 (66%)] Loss: 0.79127 (QuantReg: 12.59725) QuantErr: 12.59725 batch_time=0.37358 
Train Epoch: 13 [661/1000 21152/32000 (66%)] Loss: 0.51069 (QuantReg: 11.73023) QuantErr: 11.73023 batch_time=0.35498 
Train Epoch: 13 [666/1000 21312/32000 (67%)] Loss: 0.28462 (QuantReg: 12.57014) QuantErr: 12.57014 batch_time=0.35669 
Train Epoch: 13 [671/1000 21472/32000 (67%)] Loss: 0.83297 (QuantReg: 11.08043) QuantErr: 11.08043 batch_time=0.35732 
Train Epoch: 13 [676/1000 21632/32000 (68%)] Loss: 0.32004 (QuantReg: 12.66470) QuantErr: 12.66470 batch_time=0.35523 
Train Epoch: 13 [681/1000 21792/32000 (68%)] Loss: 0.61539 (QuantReg: 12.39414) QuantErr: 12.39414 batch_time=0.36973 
Train Epoch: 13 [686/1000 21952/32000 (69%)] Loss: 0.70366 (QuantReg: 11.95609) QuantErr: 11.95609 batch_time=0.37210 
Train Epoch: 13 [691/1000 22112/32000 (69%)] Loss: 0.30994 (QuantReg: 12.22480) QuantErr: 12.22480 batch_time=0.36357 
Train Epoch: 13 [696/1000 22272/32000 (70%)] Loss: 0.42613 (QuantReg: 12.37634) QuantErr: 12.37634 batch_time=0.35941 
Train Epoch: 13 [701/1000 22432/32000 (70%)] Loss: 0.06778 (QuantReg: 12.62199) QuantErr: 12.62199 batch_time=0.35507 
Train Epoch: 13 [706/1000 22592/32000 (71%)] Loss: 0.82374 (QuantReg: 12.42827) QuantErr: 12.42827 batch_time=2.26173 
Train Epoch: 13 [711/1000 22752/32000 (71%)] Loss: 0.70211 (QuantReg: 12.59738) QuantErr: 12.59738 batch_time=0.36084 
Train Epoch: 13 [716/1000 22912/32000 (72%)] Loss: 0.65511 (QuantReg: 12.27605) QuantErr: 12.27605 batch_time=0.37544 
Train Epoch: 13 [721/1000 23072/32000 (72%)] Loss: 0.56608 (QuantReg: 12.12067) QuantErr: 12.12067 batch_time=0.36556 
Train Epoch: 13 [726/1000 23232/32000 (73%)] Loss: 0.53036 (QuantReg: 11.91725) QuantErr: 11.91725 batch_time=0.39997 
Train Epoch: 13 [731/1000 23392/32000 (73%)] Loss: 0.60620 (QuantReg: 12.46693) QuantErr: 12.46693 batch_time=0.35515 
Train Epoch: 13 [736/1000 23552/32000 (74%)] Loss: 0.34147 (QuantReg: 11.96055) QuantErr: 11.96055 batch_time=0.37840 
Train Epoch: 13 [741/1000 23712/32000 (74%)] Loss: 0.45400 (QuantReg: 12.14947) QuantErr: 12.14947 batch_time=0.38139 
Train Epoch: 13 [746/1000 23872/32000 (75%)] Loss: 0.70252 (QuantReg: 11.18325) QuantErr: 11.18325 batch_time=0.34691 
Train Epoch: 13 [751/1000 24032/32000 (75%)] Loss: 0.66225 (QuantReg: 11.57231) QuantErr: 11.57231 batch_time=0.39034 
Train Epoch: 13 [756/1000 24192/32000 (76%)] Loss: 0.31826 (QuantReg: 12.54805) QuantErr: 12.54805 batch_time=0.34831 
Train Epoch: 13 [761/1000 24352/32000 (76%)] Loss: 0.85520 (QuantReg: 12.39651) QuantErr: 12.39651 batch_time=0.35710 
Train Epoch: 13 [766/1000 24512/32000 (77%)] Loss: 0.50525 (QuantReg: 12.17909) QuantErr: 12.17909 batch_time=0.36241 
Train Epoch: 13 [771/1000 24672/32000 (77%)] Loss: 0.49314 (QuantReg: 12.75100) QuantErr: 12.75100 batch_time=0.37985 
Train Epoch: 13 [776/1000 24832/32000 (78%)] Loss: 0.51707 (QuantReg: 12.60460) QuantErr: 12.60460 batch_time=0.40756 
Train Epoch: 13 [781/1000 24992/32000 (78%)] Loss: 0.36820 (QuantReg: 12.00969) QuantErr: 12.00969 batch_time=0.35793 
Train Epoch: 13 [786/1000 25152/32000 (79%)] Loss: 0.21707 (QuantReg: 12.48716) QuantErr: 12.48716 batch_time=0.36916 
Train Epoch: 13 [791/1000 25312/32000 (79%)] Loss: 1.15455 (QuantReg: 12.05171) QuantErr: 12.05171 batch_time=0.36577 
Train Epoch: 13 [796/1000 25472/32000 (80%)] Loss: 0.38267 (QuantReg: 13.14934) QuantErr: 13.14934 batch_time=0.38563 
Train Epoch: 13 [801/1000 25632/32000 (80%)] Loss: 0.42872 (QuantReg: 11.70569) QuantErr: 11.70569 batch_time=0.38641 
Train Epoch: 13 [806/1000 25792/32000 (81%)] Loss: 0.58059 (QuantReg: 11.86815) QuantErr: 11.86815 batch_time=0.35402 
Train Epoch: 13 [811/1000 25952/32000 (81%)] Loss: 0.62884 (QuantReg: 12.73240) QuantErr: 12.73240 batch_time=0.37382 
Train Epoch: 13 [816/1000 26112/32000 (82%)] Loss: 0.22408 (QuantReg: 11.90149) QuantErr: 11.90149 batch_time=0.35193 
Train Epoch: 13 [821/1000 26272/32000 (82%)] Loss: 0.45292 (QuantReg: 12.46636) QuantErr: 12.46636 batch_time=0.34769 
Train Epoch: 13 [826/1000 26432/32000 (83%)] Loss: 1.00242 (QuantReg: 11.90489) QuantErr: 11.90489 batch_time=0.38043 
Train Epoch: 13 [831/1000 26592/32000 (83%)] Loss: 0.31029 (QuantReg: 13.06416) QuantErr: 13.06416 batch_time=0.35106 
Train Epoch: 13 [836/1000 26752/32000 (84%)] Loss: 0.67405 (QuantReg: 12.12383) QuantErr: 12.12383 batch_time=0.36280 
Train Epoch: 13 [841/1000 26912/32000 (84%)] Loss: 0.31381 (QuantReg: 12.95439) QuantErr: 12.95439 batch_time=0.40345 
Train Epoch: 13 [846/1000 27072/32000 (85%)] Loss: 0.63142 (QuantReg: 11.81907) QuantErr: 11.81907 batch_time=0.36224 
Train Epoch: 13 [851/1000 27232/32000 (85%)] Loss: 1.32885 (QuantReg: 12.18085) QuantErr: 12.18085 batch_time=0.36500 
Train Epoch: 13 [856/1000 27392/32000 (86%)] Loss: 0.64015 (QuantReg: 12.20087) QuantErr: 12.20087 batch_time=0.35205 
Train Epoch: 13 [861/1000 27552/32000 (86%)] Loss: 0.35074 (QuantReg: 12.57559) QuantErr: 12.57559 batch_time=0.37375 
Train Epoch: 13 [866/1000 27712/32000 (87%)] Loss: 0.53243 (QuantReg: 11.73658) QuantErr: 11.73658 batch_time=0.36693 
Train Epoch: 13 [871/1000 27872/32000 (87%)] Loss: 0.58196 (QuantReg: 11.97098) QuantErr: 11.97098 batch_time=0.41633 
Train Epoch: 13 [876/1000 28032/32000 (88%)] Loss: 0.51551 (QuantReg: 12.50124) QuantErr: 12.50124 batch_time=0.35209 
Train Epoch: 13 [881/1000 28192/32000 (88%)] Loss: 0.22514 (QuantReg: 12.47907) QuantErr: 12.47907 batch_time=0.35882 
Train Epoch: 13 [886/1000 28352/32000 (89%)] Loss: 0.50392 (QuantReg: 11.63310) QuantErr: 11.63310 batch_time=0.35870 
Train Epoch: 13 [891/1000 28512/32000 (89%)] Loss: 0.56024 (QuantReg: 12.34987) QuantErr: 12.34987 batch_time=0.35906 
Train Epoch: 13 [896/1000 28672/32000 (90%)] Loss: 1.12182 (QuantReg: 11.49463) QuantErr: 11.49463 batch_time=0.38801 
Train Epoch: 13 [901/1000 28832/32000 (90%)] Loss: 0.59256 (QuantReg: 12.45248) QuantErr: 12.45248 batch_time=0.37367 
Train Epoch: 13 [906/1000 28992/32000 (91%)] Loss: 0.93046 (QuantReg: 12.36397) QuantErr: 12.36397 batch_time=0.36932 
Train Epoch: 13 [911/1000 29152/32000 (91%)] Loss: 0.49073 (QuantReg: 12.61350) QuantErr: 12.61350 batch_time=0.35305 
Train Epoch: 13 [916/1000 29312/32000 (92%)] Loss: 0.36559 (QuantReg: 12.69648) QuantErr: 12.69648 batch_time=0.40294 
Train Epoch: 13 [921/1000 29472/32000 (92%)] Loss: 0.73587 (QuantReg: 12.40082) QuantErr: 12.40082 batch_time=0.35403 
Train Epoch: 13 [926/1000 29632/32000 (93%)] Loss: 0.62615 (QuantReg: 12.14822) QuantErr: 12.14822 batch_time=0.39740 
Train Epoch: 13 [931/1000 29792/32000 (93%)] Loss: 0.83539 (QuantReg: 12.42417) QuantErr: 12.42417 batch_time=0.42763 
Train Epoch: 13 [936/1000 29952/32000 (94%)] Loss: 0.56442 (QuantReg: 11.80510) QuantErr: 11.80510 batch_time=0.37090 
Train Epoch: 13 [941/1000 30112/32000 (94%)] Loss: 0.88064 (QuantReg: 12.40293) QuantErr: 12.40293 batch_time=0.36758 
Train Epoch: 13 [946/1000 30272/32000 (95%)] Loss: 0.30561 (QuantReg: 11.99996) QuantErr: 11.99996 batch_time=0.36929 
Train Epoch: 13 [951/1000 30432/32000 (95%)] Loss: 0.49568 (QuantReg: 12.15754) QuantErr: 12.15754 batch_time=0.38971 
Train Epoch: 13 [956/1000 30592/32000 (96%)] Loss: 0.33772 (QuantReg: 13.04225) QuantErr: 13.04225 batch_time=0.37259 
Train Epoch: 13 [961/1000 30752/32000 (96%)] Loss: 0.26693 (QuantReg: 12.29468) QuantErr: 12.29468 batch_time=0.43177 
Train Epoch: 13 [966/1000 30912/32000 (97%)] Loss: 0.43387 (QuantReg: 12.11533) QuantErr: 12.11533 batch_time=0.34824 
Train Epoch: 13 [971/1000 31072/32000 (97%)] Loss: 0.37442 (QuantReg: 11.60032) QuantErr: 11.60032 batch_time=0.34956 
Train Epoch: 13 [976/1000 31232/32000 (98%)] Loss: 0.49587 (QuantReg: 12.66278) QuantErr: 12.66278 batch_time=0.37125 
Train Epoch: 13 [981/1000 31392/32000 (98%)] Loss: 0.91088 (QuantReg: 11.60635) QuantErr: 11.60635 batch_time=0.42410 
Train Epoch: 13 [986/1000 31552/32000 (99%)] Loss: 0.58544 (QuantReg: 12.68813) QuantErr: 12.68813 batch_time=0.39163 
Train Epoch: 13 [991/1000 31712/32000 (99%)] Loss: 0.19623 (QuantReg: 12.62655) QuantErr: 12.62655 batch_time=0.36426 
Train Epoch: 13 [996/1000 31872/32000 (100%)] Loss: 1.03763 (QuantReg: 11.98130) QuantErr: 11.98130 batch_time=0.38490 
Train Epoch: 13 codebook_update_time=2.35551
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch13.pth ...
Done in 21.714s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch13.pth ...
Done in 26.438s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 0.616600078098476
 quant_reg      : 12.069235516548156
 quant_err      : 12.069235516548156
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 13000
 MSRVTT_full_val/t2v_metrics/R1: 28.169014084507044
 MSRVTT_full_val/t2v_metrics/R5: 64.38631790744466
 MSRVTT_full_val/t2v_metrics/R10: 76.65995975855131
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.750503018108652
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.80574710416676
 MSRVTT_full_val/v2t_metrics/R1: 33.40040241448692
 MSRVTT_full_val/v2t_metrics/R5: 72.03219315895372
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.203219315895372
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.61450382849936
 MSRVTT_full_test/t2v_metrics/R1: 10.869565217391305
 MSRVTT_full_test/t2v_metrics/R5: 31.60535117056856
 MSRVTT_full_test/t2v_metrics/R10: 44.54849498327759
 MSRVTT_full_test/t2v_metrics/R50: 78.32775919732441
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.83444816053512
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.827630678630275
 MSRVTT_full_test/v2t_metrics/R1: 12.775919732441471
 MSRVTT_full_test/v2t_metrics/R5: 36.45484949832776
 MSRVTT_full_test/v2t_metrics/R10: 50.735785953177256
 MSRVTT_full_test/v2t_metrics/R50: 83.94648829431438
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.26354515050167
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.695951229261365
 mnt_best       : 24.827630678630275
 not_improved_count: 0
Train Epoch: 14 [1/1000 32/32000 (0%)] Loss: 0.41074 (QuantReg: 11.65098) QuantErr: 11.65098 batch_time=26.66159 
Train Epoch: 14 [6/1000 192/32000 (1%)] Loss: 0.92456 (QuantReg: 11.92822) QuantErr: 11.92822 batch_time=0.36974 
Train Epoch: 14 [11/1000 352/32000 (1%)] Loss: 0.63764 (QuantReg: 12.49135) QuantErr: 12.49135 batch_time=0.37128 
Train Epoch: 14 [16/1000 512/32000 (2%)] Loss: 0.95049 (QuantReg: 11.84663) QuantErr: 11.84663 batch_time=0.47355 
Train Epoch: 14 [21/1000 672/32000 (2%)] Loss: 0.92335 (QuantReg: 11.69158) QuantErr: 11.69158 batch_time=0.33913 
Train Epoch: 14 [26/1000 832/32000 (3%)] Loss: 0.31091 (QuantReg: 12.05173) QuantErr: 12.05173 batch_time=0.34182 
Train Epoch: 14 [31/1000 992/32000 (3%)] Loss: 0.57120 (QuantReg: 12.26633) QuantErr: 12.26633 batch_time=0.34291 
Train Epoch: 14 [36/1000 1152/32000 (4%)] Loss: 0.56190 (QuantReg: 12.07554) QuantErr: 12.07554 batch_time=0.34689 
Train Epoch: 14 [41/1000 1312/32000 (4%)] Loss: 0.56293 (QuantReg: 11.61997) QuantErr: 11.61997 batch_time=0.35339 
Train Epoch: 14 [46/1000 1472/32000 (5%)] Loss: 1.31233 (QuantReg: 12.06352) QuantErr: 12.06352 batch_time=0.34539 
Train Epoch: 14 [51/1000 1632/32000 (5%)] Loss: 0.40731 (QuantReg: 12.45049) QuantErr: 12.45049 batch_time=0.35611 
Train Epoch: 14 [56/1000 1792/32000 (6%)] Loss: 0.35746 (QuantReg: 12.16571) QuantErr: 12.16571 batch_time=0.37311 
Train Epoch: 14 [61/1000 1952/32000 (6%)] Loss: 0.40075 (QuantReg: 12.27223) QuantErr: 12.27223 batch_time=0.38794 
Train Epoch: 14 [66/1000 2112/32000 (7%)] Loss: 0.82082 (QuantReg: 11.48109) QuantErr: 11.48109 batch_time=0.48421 
Train Epoch: 14 [71/1000 2272/32000 (7%)] Loss: 0.35789 (QuantReg: 11.82353) QuantErr: 11.82353 batch_time=0.41243 
Train Epoch: 14 [76/1000 2432/32000 (8%)] Loss: 0.42175 (QuantReg: 11.09279) QuantErr: 11.09279 batch_time=0.35325 
Train Epoch: 14 [81/1000 2592/32000 (8%)] Loss: 0.23026 (QuantReg: 11.85808) QuantErr: 11.85808 batch_time=0.35692 
Train Epoch: 14 [86/1000 2752/32000 (9%)] Loss: 0.54660 (QuantReg: 11.72721) QuantErr: 11.72721 batch_time=0.39020 
Train Epoch: 14 [91/1000 2912/32000 (9%)] Loss: 0.93458 (QuantReg: 11.82814) QuantErr: 11.82814 batch_time=0.34288 
Train Epoch: 14 [96/1000 3072/32000 (10%)] Loss: 0.32587 (QuantReg: 12.09899) QuantErr: 12.09899 batch_time=0.34227 
Train Epoch: 14 [101/1000 3232/32000 (10%)] Loss: 0.48034 (QuantReg: 11.12055) QuantErr: 11.12055 batch_time=0.35322 
Train Epoch: 14 [106/1000 3392/32000 (11%)] Loss: 0.24858 (QuantReg: 12.00030) QuantErr: 12.00030 batch_time=0.34239 
Train Epoch: 14 [111/1000 3552/32000 (11%)] Loss: 1.04417 (QuantReg: 11.63619) QuantErr: 11.63619 batch_time=0.35523 
Train Epoch: 14 [116/1000 3712/32000 (12%)] Loss: 0.29191 (QuantReg: 12.05101) QuantErr: 12.05101 batch_time=0.35539 
Train Epoch: 14 [121/1000 3872/32000 (12%)] Loss: 0.73442 (QuantReg: 12.04809) QuantErr: 12.04809 batch_time=0.44179 
Train Epoch: 14 [126/1000 4032/32000 (13%)] Loss: 0.47454 (QuantReg: 11.38231) QuantErr: 11.38231 batch_time=0.41610 
Train Epoch: 14 [131/1000 4192/32000 (13%)] Loss: 0.27966 (QuantReg: 12.36217) QuantErr: 12.36217 batch_time=0.38598 
Train Epoch: 14 [136/1000 4352/32000 (14%)] Loss: 0.51215 (QuantReg: 11.57381) QuantErr: 11.57381 batch_time=0.47379 
Train Epoch: 14 [141/1000 4512/32000 (14%)] Loss: 0.58046 (QuantReg: 12.35018) QuantErr: 12.35018 batch_time=0.34643 
Train Epoch: 14 [146/1000 4672/32000 (15%)] Loss: 0.67243 (QuantReg: 11.67301) QuantErr: 11.67301 batch_time=0.63560 
Train Epoch: 14 [151/1000 4832/32000 (15%)] Loss: 0.58491 (QuantReg: 11.50675) QuantErr: 11.50675 batch_time=0.34406 
Train Epoch: 14 [156/1000 4992/32000 (16%)] Loss: 0.33687 (QuantReg: 11.98914) QuantErr: 11.98914 batch_time=0.36061 
Train Epoch: 14 [161/1000 5152/32000 (16%)] Loss: 0.59603 (QuantReg: 12.20891) QuantErr: 12.20891 batch_time=0.35661 
Train Epoch: 14 [166/1000 5312/32000 (17%)] Loss: 1.05832 (QuantReg: 12.29825) QuantErr: 12.29825 batch_time=0.38997 
Train Epoch: 14 [171/1000 5472/32000 (17%)] Loss: 0.80908 (QuantReg: 12.49352) QuantErr: 12.49352 batch_time=0.35286 
Train Epoch: 14 [176/1000 5632/32000 (18%)] Loss: 0.61789 (QuantReg: 12.15786) QuantErr: 12.15786 batch_time=0.40523 
Train Epoch: 14 [181/1000 5792/32000 (18%)] Loss: 0.63157 (QuantReg: 12.09303) QuantErr: 12.09303 batch_time=0.41939 
Train Epoch: 14 [186/1000 5952/32000 (19%)] Loss: 0.68069 (QuantReg: 11.36713) QuantErr: 11.36713 batch_time=0.39121 
Train Epoch: 14 [191/1000 6112/32000 (19%)] Loss: 0.90855 (QuantReg: 11.96900) QuantErr: 11.96900 batch_time=0.39801 
Train Epoch: 14 [196/1000 6272/32000 (20%)] Loss: 0.49995 (QuantReg: 11.58602) QuantErr: 11.58602 batch_time=0.40085 
Train Epoch: 14 [201/1000 6432/32000 (20%)] Loss: 1.03273 (QuantReg: 11.54568) QuantErr: 11.54568 batch_time=0.36153 
Train Epoch: 14 [206/1000 6592/32000 (21%)] Loss: 0.33743 (QuantReg: 11.58104) QuantErr: 11.58104 batch_time=0.37077 
Train Epoch: 14 [211/1000 6752/32000 (21%)] Loss: 0.85127 (QuantReg: 12.42132) QuantErr: 12.42132 batch_time=0.68464 
Train Epoch: 14 [216/1000 6912/32000 (22%)] Loss: 0.52830 (QuantReg: 11.66738) QuantErr: 11.66738 batch_time=0.35262 
Train Epoch: 14 [221/1000 7072/32000 (22%)] Loss: 1.11646 (QuantReg: 12.20757) QuantErr: 12.20757 batch_time=0.35864 
Train Epoch: 14 [226/1000 7232/32000 (23%)] Loss: 0.30558 (QuantReg: 12.13610) QuantErr: 12.13610 batch_time=0.36709 
Train Epoch: 14 [231/1000 7392/32000 (23%)] Loss: 0.90298 (QuantReg: 12.02620) QuantErr: 12.02620 batch_time=0.37913 
Train Epoch: 14 [236/1000 7552/32000 (24%)] Loss: 0.92546 (QuantReg: 11.25094) QuantErr: 11.25094 batch_time=0.36357 
Train Epoch: 14 [241/1000 7712/32000 (24%)] Loss: 0.74329 (QuantReg: 11.93967) QuantErr: 11.93967 batch_time=0.40336 
Train Epoch: 14 [246/1000 7872/32000 (25%)] Loss: 0.61708 (QuantReg: 12.28243) QuantErr: 12.28243 batch_time=0.34868 
Train Epoch: 14 [251/1000 8032/32000 (25%)] Loss: 0.92541 (QuantReg: 11.91148) QuantErr: 11.91148 batch_time=0.44448 
Train Epoch: 14 [256/1000 8192/32000 (26%)] Loss: 0.48237 (QuantReg: 11.88583) QuantErr: 11.88583 batch_time=0.44153 
Train Epoch: 14 [261/1000 8352/32000 (26%)] Loss: 0.39431 (QuantReg: 12.18869) QuantErr: 12.18869 batch_time=0.52994 
Train Epoch: 14 [266/1000 8512/32000 (27%)] Loss: 0.87642 (QuantReg: 12.39029) QuantErr: 12.39029 batch_time=0.35155 
Train Epoch: 14 [271/1000 8672/32000 (27%)] Loss: 0.53852 (QuantReg: 11.36833) QuantErr: 11.36833 batch_time=0.34563 
Train Epoch: 14 [276/1000 8832/32000 (28%)] Loss: 0.32700 (QuantReg: 12.68064) QuantErr: 12.68064 batch_time=0.49818 
Train Epoch: 14 [281/1000 8992/32000 (28%)] Loss: 1.31994 (QuantReg: 12.17090) QuantErr: 12.17090 batch_time=0.35157 
Train Epoch: 14 [286/1000 9152/32000 (29%)] Loss: 0.84562 (QuantReg: 12.13744) QuantErr: 12.13744 batch_time=0.34815 
Train Epoch: 14 [291/1000 9312/32000 (29%)] Loss: 0.81256 (QuantReg: 11.86809) QuantErr: 11.86809 batch_time=0.44478 
Train Epoch: 14 [296/1000 9472/32000 (30%)] Loss: 0.42020 (QuantReg: 11.90899) QuantErr: 11.90899 batch_time=0.79680 
Train Epoch: 14 [301/1000 9632/32000 (30%)] Loss: 0.21205 (QuantReg: 12.24335) QuantErr: 12.24335 batch_time=0.65647 
Train Epoch: 14 [306/1000 9792/32000 (31%)] Loss: 0.60798 (QuantReg: 12.40228) QuantErr: 12.40228 batch_time=0.48376 
Train Epoch: 14 [311/1000 9952/32000 (31%)] Loss: 0.75224 (QuantReg: 11.55305) QuantErr: 11.55305 batch_time=0.34850 
Train Epoch: 14 [316/1000 10112/32000 (32%)] Loss: 0.23298 (QuantReg: 11.76792) QuantErr: 11.76792 batch_time=0.37170 
Train Epoch: 14 [321/1000 10272/32000 (32%)] Loss: 0.58829 (QuantReg: 12.69189) QuantErr: 12.69189 batch_time=0.50289 
Train Epoch: 14 [326/1000 10432/32000 (33%)] Loss: 0.24073 (QuantReg: 12.06952) QuantErr: 12.06952 batch_time=0.37385 
Train Epoch: 14 [331/1000 10592/32000 (33%)] Loss: 0.44509 (QuantReg: 12.47602) QuantErr: 12.47602 batch_time=0.37802 
Train Epoch: 14 [336/1000 10752/32000 (34%)] Loss: 0.97094 (QuantReg: 12.03551) QuantErr: 12.03551 batch_time=0.48660 
Train Epoch: 14 [341/1000 10912/32000 (34%)] Loss: 0.72438 (QuantReg: 11.95905) QuantErr: 11.95905 batch_time=0.34699 
Train Epoch: 14 [346/1000 11072/32000 (35%)] Loss: 0.46661 (QuantReg: 11.92670) QuantErr: 11.92670 batch_time=0.34643 
Train Epoch: 14 [351/1000 11232/32000 (35%)] Loss: 0.33134 (QuantReg: 12.34524) QuantErr: 12.34524 batch_time=0.37598 
Train Epoch: 14 [356/1000 11392/32000 (36%)] Loss: 0.24386 (QuantReg: 12.30787) QuantErr: 12.30787 batch_time=0.35074 
Train Epoch: 14 [361/1000 11552/32000 (36%)] Loss: 0.65864 (QuantReg: 11.75479) QuantErr: 11.75479 batch_time=0.34232 
Train Epoch: 14 [366/1000 11712/32000 (37%)] Loss: 0.37605 (QuantReg: 12.28513) QuantErr: 12.28513 batch_time=0.34297 
Train Epoch: 14 [371/1000 11872/32000 (37%)] Loss: 0.24083 (QuantReg: 12.40040) QuantErr: 12.40040 batch_time=0.33711 
Train Epoch: 14 [376/1000 12032/32000 (38%)] Loss: 1.11891 (QuantReg: 12.22224) QuantErr: 12.22224 batch_time=0.39385 
Train Epoch: 14 [381/1000 12192/32000 (38%)] Loss: 1.00378 (QuantReg: 12.02391) QuantErr: 12.02391 batch_time=0.37782 
Train Epoch: 14 [386/1000 12352/32000 (39%)] Loss: 0.74126 (QuantReg: 11.39364) QuantErr: 11.39364 batch_time=0.47773 
Train Epoch: 14 [391/1000 12512/32000 (39%)] Loss: 0.59690 (QuantReg: 12.27901) QuantErr: 12.27901 batch_time=0.42314 
Train Epoch: 14 [396/1000 12672/32000 (40%)] Loss: 0.99319 (QuantReg: 11.85159) QuantErr: 11.85159 batch_time=0.41795 
Train Epoch: 14 [401/1000 12832/32000 (40%)] Loss: 1.16207 (QuantReg: 11.98890) QuantErr: 11.98890 batch_time=0.37774 
Train Epoch: 14 [406/1000 12992/32000 (41%)] Loss: 0.77152 (QuantReg: 12.40445) QuantErr: 12.40445 batch_time=0.33966 
Train Epoch: 14 [411/1000 13152/32000 (41%)] Loss: 0.70265 (QuantReg: 12.11418) QuantErr: 12.11418 batch_time=0.36503 
Train Epoch: 14 [416/1000 13312/32000 (42%)] Loss: 0.15570 (QuantReg: 12.14147) QuantErr: 12.14147 batch_time=0.34984 
Train Epoch: 14 [421/1000 13472/32000 (42%)] Loss: 0.61844 (QuantReg: 11.83871) QuantErr: 11.83871 batch_time=0.34833 
Train Epoch: 14 [426/1000 13632/32000 (43%)] Loss: 0.31634 (QuantReg: 12.50312) QuantErr: 12.50312 batch_time=0.34618 
Train Epoch: 14 [431/1000 13792/32000 (43%)] Loss: 0.73294 (QuantReg: 12.60824) QuantErr: 12.60824 batch_time=0.34639 
Train Epoch: 14 [436/1000 13952/32000 (44%)] Loss: 0.79412 (QuantReg: 11.95762) QuantErr: 11.95762 batch_time=0.35122 
Train Epoch: 14 [441/1000 14112/32000 (44%)] Loss: 0.42883 (QuantReg: 12.46362) QuantErr: 12.46362 batch_time=0.38347 
Train Epoch: 14 [446/1000 14272/32000 (45%)] Loss: 0.48365 (QuantReg: 12.75596) QuantErr: 12.75596 batch_time=0.33935 
Train Epoch: 14 [451/1000 14432/32000 (45%)] Loss: 0.48903 (QuantReg: 12.08906) QuantErr: 12.08906 batch_time=0.34227 
Train Epoch: 14 [456/1000 14592/32000 (46%)] Loss: 0.39306 (QuantReg: 12.71687) QuantErr: 12.71687 batch_time=0.48296 
Train Epoch: 14 [461/1000 14752/32000 (46%)] Loss: 0.23926 (QuantReg: 11.67206) QuantErr: 11.67206 batch_time=0.34204 
Train Epoch: 14 [466/1000 14912/32000 (47%)] Loss: 0.45643 (QuantReg: 12.31342) QuantErr: 12.31342 batch_time=0.65170 
Train Epoch: 14 [471/1000 15072/32000 (47%)] Loss: 1.00270 (QuantReg: 12.72031) QuantErr: 12.72031 batch_time=0.38985 
Train Epoch: 14 [476/1000 15232/32000 (48%)] Loss: 0.81637 (QuantReg: 12.63678) QuantErr: 12.63678 batch_time=0.34754 
Train Epoch: 14 [481/1000 15392/32000 (48%)] Loss: 0.85527 (QuantReg: 11.62611) QuantErr: 11.62611 batch_time=0.36719 
Train Epoch: 14 [486/1000 15552/32000 (49%)] Loss: 0.23458 (QuantReg: 12.38210) QuantErr: 12.38210 batch_time=0.37636 
Train Epoch: 14 [491/1000 15712/32000 (49%)] Loss: 0.69578 (QuantReg: 12.11692) QuantErr: 12.11692 batch_time=0.40394 
Train Epoch: 14 [496/1000 15872/32000 (50%)] Loss: 0.35495 (QuantReg: 11.72986) QuantErr: 11.72986 batch_time=0.42669 
Train Epoch: 14 [501/1000 16032/32000 (50%)] Loss: 1.00606 (QuantReg: 12.29248) QuantErr: 12.29248 batch_time=0.36462 
Train Epoch: 14 [506/1000 16192/32000 (51%)] Loss: 0.21446 (QuantReg: 12.48378) QuantErr: 12.48378 batch_time=0.36907 
Train Epoch: 14 [511/1000 16352/32000 (51%)] Loss: 0.46774 (QuantReg: 12.02776) QuantErr: 12.02776 batch_time=0.36966 
Train Epoch: 14 [516/1000 16512/32000 (52%)] Loss: 0.44625 (QuantReg: 12.09518) QuantErr: 12.09518 batch_time=0.37350 
Train Epoch: 14 [521/1000 16672/32000 (52%)] Loss: 0.79265 (QuantReg: 11.88997) QuantErr: 11.88997 batch_time=0.36166 
Train Epoch: 14 [526/1000 16832/32000 (53%)] Loss: 1.01903 (QuantReg: 12.12338) QuantErr: 12.12338 batch_time=0.35591 
Train Epoch: 14 [531/1000 16992/32000 (53%)] Loss: 0.47488 (QuantReg: 12.81184) QuantErr: 12.81184 batch_time=0.59940 
Train Epoch: 14 [536/1000 17152/32000 (54%)] Loss: 0.71251 (QuantReg: 11.57202) QuantErr: 11.57202 batch_time=0.37534 
Train Epoch: 14 [541/1000 17312/32000 (54%)] Loss: 0.39761 (QuantReg: 12.52139) QuantErr: 12.52139 batch_time=0.36018 
Train Epoch: 14 [546/1000 17472/32000 (55%)] Loss: 0.74399 (QuantReg: 12.30263) QuantErr: 12.30263 batch_time=0.34872 
Train Epoch: 14 [551/1000 17632/32000 (55%)] Loss: 0.28070 (QuantReg: 12.93227) QuantErr: 12.93227 batch_time=0.35513 
Train Epoch: 14 [556/1000 17792/32000 (56%)] Loss: 1.00100 (QuantReg: 12.61729) QuantErr: 12.61729 batch_time=0.34984 
Train Epoch: 14 [561/1000 17952/32000 (56%)] Loss: 0.34711 (QuantReg: 12.64320) QuantErr: 12.64320 batch_time=0.40283 
Train Epoch: 14 [566/1000 18112/32000 (57%)] Loss: 0.18225 (QuantReg: 11.92689) QuantErr: 11.92689 batch_time=0.35130 
Train Epoch: 14 [571/1000 18272/32000 (57%)] Loss: 0.89258 (QuantReg: 11.90142) QuantErr: 11.90142 batch_time=0.36980 
Train Epoch: 14 [576/1000 18432/32000 (58%)] Loss: 0.79474 (QuantReg: 12.09894) QuantErr: 12.09894 batch_time=0.38291 
Train Epoch: 14 [581/1000 18592/32000 (58%)] Loss: 0.37672 (QuantReg: 11.89390) QuantErr: 11.89390 batch_time=0.34733 
Train Epoch: 14 [586/1000 18752/32000 (59%)] Loss: 0.43583 (QuantReg: 11.54723) QuantErr: 11.54723 batch_time=0.51925 
Train Epoch: 14 [591/1000 18912/32000 (59%)] Loss: 0.63479 (QuantReg: 12.05600) QuantErr: 12.05600 batch_time=0.36488 
Train Epoch: 14 [596/1000 19072/32000 (60%)] Loss: 0.46539 (QuantReg: 12.64196) QuantErr: 12.64196 batch_time=0.48364 
Train Epoch: 14 [601/1000 19232/32000 (60%)] Loss: 0.59276 (QuantReg: 12.44212) QuantErr: 12.44212 batch_time=0.45130 
Train Epoch: 14 [606/1000 19392/32000 (61%)] Loss: 0.69116 (QuantReg: 12.28128) QuantErr: 12.28128 batch_time=0.36236 
Train Epoch: 14 [611/1000 19552/32000 (61%)] Loss: 0.30748 (QuantReg: 11.73403) QuantErr: 11.73403 batch_time=0.37380 
Train Epoch: 14 [616/1000 19712/32000 (62%)] Loss: 0.49017 (QuantReg: 11.94227) QuantErr: 11.94227 batch_time=0.68505 
Train Epoch: 14 [621/1000 19872/32000 (62%)] Loss: 0.30261 (QuantReg: 12.65091) QuantErr: 12.65091 batch_time=0.62347 
Train Epoch: 14 [626/1000 20032/32000 (63%)] Loss: 1.13933 (QuantReg: 11.92264) QuantErr: 11.92264 batch_time=0.50173 
Train Epoch: 14 [631/1000 20192/32000 (63%)] Loss: 0.46171 (QuantReg: 12.08614) QuantErr: 12.08614 batch_time=0.36008 
Train Epoch: 14 [636/1000 20352/32000 (64%)] Loss: 1.01229 (QuantReg: 11.38024) QuantErr: 11.38024 batch_time=0.43552 
Train Epoch: 14 [641/1000 20512/32000 (64%)] Loss: 0.16532 (QuantReg: 11.79881) QuantErr: 11.79881 batch_time=0.49849 
Train Epoch: 14 [646/1000 20672/32000 (65%)] Loss: 0.78512 (QuantReg: 12.06959) QuantErr: 12.06959 batch_time=0.36177 
Train Epoch: 14 [651/1000 20832/32000 (65%)] Loss: 0.72281 (QuantReg: 12.42968) QuantErr: 12.42968 batch_time=0.46867 
Train Epoch: 14 [656/1000 20992/32000 (66%)] Loss: 1.09754 (QuantReg: 11.99834) QuantErr: 11.99834 batch_time=0.51099 
Train Epoch: 14 [661/1000 21152/32000 (66%)] Loss: 0.37552 (QuantReg: 11.34013) QuantErr: 11.34013 batch_time=0.39317 
Train Epoch: 14 [666/1000 21312/32000 (67%)] Loss: 0.86804 (QuantReg: 12.29735) QuantErr: 12.29735 batch_time=0.39317 
Train Epoch: 14 [671/1000 21472/32000 (67%)] Loss: 0.50449 (QuantReg: 12.16226) QuantErr: 12.16226 batch_time=0.42495 
Train Epoch: 14 [676/1000 21632/32000 (68%)] Loss: 0.36250 (QuantReg: 11.97540) QuantErr: 11.97540 batch_time=0.34759 
Train Epoch: 14 [681/1000 21792/32000 (68%)] Loss: 0.81219 (QuantReg: 11.57984) QuantErr: 11.57984 batch_time=0.39617 
Train Epoch: 14 [686/1000 21952/32000 (69%)] Loss: 1.21706 (QuantReg: 11.94565) QuantErr: 11.94565 batch_time=0.35320 
Train Epoch: 14 [691/1000 22112/32000 (69%)] Loss: 0.70648 (QuantReg: 11.19199) QuantErr: 11.19199 batch_time=0.34458 
Train Epoch: 14 [696/1000 22272/32000 (70%)] Loss: 0.59541 (QuantReg: 12.43041) QuantErr: 12.43041 batch_time=0.34697 
Train Epoch: 14 [701/1000 22432/32000 (70%)] Loss: 0.34787 (QuantReg: 12.58147) QuantErr: 12.58147 batch_time=0.38035 
Train Epoch: 14 [706/1000 22592/32000 (71%)] Loss: 0.58476 (QuantReg: 12.62038) QuantErr: 12.62038 batch_time=0.53911 
Train Epoch: 14 [711/1000 22752/32000 (71%)] Loss: 0.38387 (QuantReg: 12.16085) QuantErr: 12.16085 batch_time=0.46409 
Train Epoch: 14 [716/1000 22912/32000 (72%)] Loss: 0.35906 (QuantReg: 11.90507) QuantErr: 11.90507 batch_time=0.37763 
Train Epoch: 14 [721/1000 23072/32000 (72%)] Loss: 0.16221 (QuantReg: 12.87191) QuantErr: 12.87191 batch_time=0.37056 
Train Epoch: 14 [726/1000 23232/32000 (73%)] Loss: 0.42180 (QuantReg: 13.21375) QuantErr: 13.21375 batch_time=0.42293 
Train Epoch: 14 [731/1000 23392/32000 (73%)] Loss: 0.40962 (QuantReg: 12.15622) QuantErr: 12.15622 batch_time=0.37375 
Train Epoch: 14 [736/1000 23552/32000 (74%)] Loss: 0.65769 (QuantReg: 11.93357) QuantErr: 11.93357 batch_time=0.35561 
Train Epoch: 14 [741/1000 23712/32000 (74%)] Loss: 0.65463 (QuantReg: 12.30600) QuantErr: 12.30600 batch_time=0.35500 
Train Epoch: 14 [746/1000 23872/32000 (75%)] Loss: 0.28837 (QuantReg: 12.40347) QuantErr: 12.40347 batch_time=0.34631 
Train Epoch: 14 [751/1000 24032/32000 (75%)] Loss: 0.58419 (QuantReg: 12.51378) QuantErr: 12.51378 batch_time=0.35984 
Train Epoch: 14 [756/1000 24192/32000 (76%)] Loss: 0.49688 (QuantReg: 12.54761) QuantErr: 12.54761 batch_time=0.34261 
Train Epoch: 14 [761/1000 24352/32000 (76%)] Loss: 0.42692 (QuantReg: 12.04793) QuantErr: 12.04793 batch_time=0.34992 
Train Epoch: 14 [766/1000 24512/32000 (77%)] Loss: 0.56531 (QuantReg: 12.86143) QuantErr: 12.86143 batch_time=0.37082 
Train Epoch: 14 [771/1000 24672/32000 (77%)] Loss: 0.66374 (QuantReg: 12.11081) QuantErr: 12.11081 batch_time=0.36895 
Train Epoch: 14 [776/1000 24832/32000 (78%)] Loss: 0.33003 (QuantReg: 11.82128) QuantErr: 11.82128 batch_time=0.46036 
Train Epoch: 14 [781/1000 24992/32000 (78%)] Loss: 1.18864 (QuantReg: 11.81714) QuantErr: 11.81714 batch_time=0.35228 
Train Epoch: 14 [786/1000 25152/32000 (79%)] Loss: 0.70458 (QuantReg: 12.09464) QuantErr: 12.09464 batch_time=0.61978 
Train Epoch: 14 [791/1000 25312/32000 (79%)] Loss: 1.11801 (QuantReg: 11.33252) QuantErr: 11.33252 batch_time=0.38438 
Train Epoch: 14 [796/1000 25472/32000 (80%)] Loss: 0.55293 (QuantReg: 11.76823) QuantErr: 11.76823 batch_time=0.36184 
Train Epoch: 14 [801/1000 25632/32000 (80%)] Loss: 0.90900 (QuantReg: 12.19894) QuantErr: 12.19894 batch_time=0.37087 
Train Epoch: 14 [806/1000 25792/32000 (81%)] Loss: 0.51956 (QuantReg: 12.27183) QuantErr: 12.27183 batch_time=0.35029 
Train Epoch: 14 [811/1000 25952/32000 (81%)] Loss: 0.44323 (QuantReg: 12.11843) QuantErr: 12.11843 batch_time=0.36827 
Train Epoch: 14 [816/1000 26112/32000 (82%)] Loss: 0.52103 (QuantReg: 12.07557) QuantErr: 12.07557 batch_time=0.40248 
Train Epoch: 14 [821/1000 26272/32000 (82%)] Loss: 0.63081 (QuantReg: 12.34059) QuantErr: 12.34059 batch_time=0.36485 
Train Epoch: 14 [826/1000 26432/32000 (83%)] Loss: 0.36059 (QuantReg: 12.64482) QuantErr: 12.64482 batch_time=0.35987 
Train Epoch: 14 [831/1000 26592/32000 (83%)] Loss: 0.81057 (QuantReg: 12.56423) QuantErr: 12.56423 batch_time=0.45261 
Train Epoch: 14 [836/1000 26752/32000 (84%)] Loss: 0.59708 (QuantReg: 12.31790) QuantErr: 12.31790 batch_time=0.36230 
Train Epoch: 14 [841/1000 26912/32000 (84%)] Loss: 0.61366 (QuantReg: 11.81244) QuantErr: 11.81244 batch_time=0.34531 
Train Epoch: 14 [846/1000 27072/32000 (85%)] Loss: 0.19469 (QuantReg: 12.24234) QuantErr: 12.24234 batch_time=0.34491 
Train Epoch: 14 [851/1000 27232/32000 (85%)] Loss: 0.69707 (QuantReg: 11.74234) QuantErr: 11.74234 batch_time=0.63698 
Train Epoch: 14 [856/1000 27392/32000 (86%)] Loss: 0.37154 (QuantReg: 12.08295) QuantErr: 12.08295 batch_time=0.47419 
Train Epoch: 14 [861/1000 27552/32000 (86%)] Loss: 0.59084 (QuantReg: 12.16586) QuantErr: 12.16586 batch_time=0.40849 
Train Epoch: 14 [866/1000 27712/32000 (87%)] Loss: 0.57495 (QuantReg: 13.03276) QuantErr: 13.03276 batch_time=0.47430 
Train Epoch: 14 [871/1000 27872/32000 (87%)] Loss: 0.67944 (QuantReg: 12.91673) QuantErr: 12.91673 batch_time=0.38200 
Train Epoch: 14 [876/1000 28032/32000 (88%)] Loss: 0.39801 (QuantReg: 12.15501) QuantErr: 12.15501 batch_time=0.37729 
Train Epoch: 14 [881/1000 28192/32000 (88%)] Loss: 0.53850 (QuantReg: 11.75103) QuantErr: 11.75103 batch_time=0.40793 
Train Epoch: 14 [886/1000 28352/32000 (89%)] Loss: 0.54713 (QuantReg: 12.16227) QuantErr: 12.16227 batch_time=0.34257 
Train Epoch: 14 [891/1000 28512/32000 (89%)] Loss: 0.91577 (QuantReg: 12.12200) QuantErr: 12.12200 batch_time=0.42926 
Train Epoch: 14 [896/1000 28672/32000 (90%)] Loss: 0.26161 (QuantReg: 12.61000) QuantErr: 12.61000 batch_time=0.41981 
Train Epoch: 14 [901/1000 28832/32000 (90%)] Loss: 0.69183 (QuantReg: 11.79336) QuantErr: 11.79336 batch_time=0.34647 
Train Epoch: 14 [906/1000 28992/32000 (91%)] Loss: 0.48486 (QuantReg: 12.02058) QuantErr: 12.02058 batch_time=0.37131 
Train Epoch: 14 [911/1000 29152/32000 (91%)] Loss: 0.34888 (QuantReg: 12.49284) QuantErr: 12.49284 batch_time=0.36124 
Train Epoch: 14 [916/1000 29312/32000 (92%)] Loss: 1.12503 (QuantReg: 12.18696) QuantErr: 12.18696 batch_time=0.47265 
Train Epoch: 14 [921/1000 29472/32000 (92%)] Loss: 0.38968 (QuantReg: 11.74375) QuantErr: 11.74375 batch_time=0.39574 
Train Epoch: 14 [926/1000 29632/32000 (93%)] Loss: 0.38428 (QuantReg: 12.71748) QuantErr: 12.71748 batch_time=0.35505 
Train Epoch: 14 [931/1000 29792/32000 (93%)] Loss: 1.08359 (QuantReg: 11.97005) QuantErr: 11.97005 batch_time=0.36658 
Train Epoch: 14 [936/1000 29952/32000 (94%)] Loss: 0.09786 (QuantReg: 13.08747) QuantErr: 13.08747 batch_time=0.75864 
Train Epoch: 14 [941/1000 30112/32000 (94%)] Loss: 0.23510 (QuantReg: 12.18226) QuantErr: 12.18226 batch_time=0.65855 
Train Epoch: 14 [946/1000 30272/32000 (95%)] Loss: 0.35945 (QuantReg: 12.44831) QuantErr: 12.44831 batch_time=0.48262 
Train Epoch: 14 [951/1000 30432/32000 (95%)] Loss: 0.24540 (QuantReg: 12.17247) QuantErr: 12.17247 batch_time=0.35091 
Train Epoch: 14 [956/1000 30592/32000 (96%)] Loss: 1.12793 (QuantReg: 12.01539) QuantErr: 12.01539 batch_time=0.38284 
Train Epoch: 14 [961/1000 30752/32000 (96%)] Loss: 0.50621 (QuantReg: 12.41931) QuantErr: 12.41931 batch_time=0.43668 
Train Epoch: 14 [966/1000 30912/32000 (97%)] Loss: 0.42033 (QuantReg: 12.51146) QuantErr: 12.51146 batch_time=0.34887 
Train Epoch: 14 [971/1000 31072/32000 (97%)] Loss: 0.22790 (QuantReg: 13.07628) QuantErr: 13.07628 batch_time=0.35537 
Train Epoch: 14 [976/1000 31232/32000 (98%)] Loss: 0.53983 (QuantReg: 12.66524) QuantErr: 12.66524 batch_time=0.48172 
Train Epoch: 14 [981/1000 31392/32000 (98%)] Loss: 0.30185 (QuantReg: 12.86042) QuantErr: 12.86042 batch_time=0.36162 
Train Epoch: 14 [986/1000 31552/32000 (99%)] Loss: 0.38930 (QuantReg: 12.16021) QuantErr: 12.16021 batch_time=0.37657 
Train Epoch: 14 [991/1000 31712/32000 (99%)] Loss: 0.51510 (QuantReg: 12.24671) QuantErr: 12.24671 batch_time=0.36384 
Train Epoch: 14 [996/1000 31872/32000 (100%)] Loss: 0.42968 (QuantReg: 11.76138) QuantErr: 11.76138 batch_time=0.35170 
Train Epoch: 14 codebook_update_time=2.44139
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch14.pth ...
Done in 4.351s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 0.5990548081025481
 quant_reg      : 12.099415857315064
 quant_err      : 12.099415857315064
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 14000
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 62.776659959758554
 MSRVTT_full_val/t2v_metrics/R10: 74.84909456740442
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.92354124748491
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.59136084456699
 MSRVTT_full_val/v2t_metrics/R1: 29.577464788732396
 MSRVTT_full_val/v2t_metrics/R5: 69.81891348088531
 MSRVTT_full_val/v2t_metrics/R10: 83.5010060362173
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.9325955734406435
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.65983484473249
 MSRVTT_full_test/t2v_metrics/R1: 9.765886287625419
 MSRVTT_full_test/t2v_metrics/R5: 29.130434782608695
 MSRVTT_full_test/t2v_metrics/R10: 42.441471571906355
 MSRVTT_full_test/t2v_metrics/R50: 78.02675585284281
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.43177257525084
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.94121180341349
 MSRVTT_full_test/v2t_metrics/R1: 11.672240802675585
 MSRVTT_full_test/v2t_metrics/R5: 34.046822742474916
 MSRVTT_full_test/v2t_metrics/R10: 49.46488294314381
 MSRVTT_full_test/v2t_metrics/R50: 83.37792642140468
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.95936454849498
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.988325410115785
 mnt_best       : 24.827630678630275
 not_improved_count: 1
Train Epoch: 15 [1/1000 32/32000 (0%)] Loss: 0.42992 (QuantReg: 11.57388) QuantErr: 11.57388 batch_time=27.69079 
Train Epoch: 15 [6/1000 192/32000 (1%)] Loss: 0.31641 (QuantReg: 11.92352) QuantErr: 11.92352 batch_time=0.52777 
Train Epoch: 15 [11/1000 352/32000 (1%)] Loss: 0.75031 (QuantReg: 12.07173) QuantErr: 12.07173 batch_time=0.35377 
Train Epoch: 15 [16/1000 512/32000 (2%)] Loss: 0.49765 (QuantReg: 12.33551) QuantErr: 12.33551 batch_time=0.40686 
Train Epoch: 15 [21/1000 672/32000 (2%)] Loss: 0.75723 (QuantReg: 12.04071) QuantErr: 12.04071 batch_time=0.38018 
Train Epoch: 15 [26/1000 832/32000 (3%)] Loss: 0.52553 (QuantReg: 11.28950) QuantErr: 11.28950 batch_time=0.39620 
Train Epoch: 15 [31/1000 992/32000 (3%)] Loss: 0.62725 (QuantReg: 12.40584) QuantErr: 12.40584 batch_time=0.35726 
Train Epoch: 15 [36/1000 1152/32000 (4%)] Loss: 0.40229 (QuantReg: 11.89266) QuantErr: 11.89266 batch_time=0.42609 
Train Epoch: 15 [41/1000 1312/32000 (4%)] Loss: 0.70745 (QuantReg: 12.01976) QuantErr: 12.01976 batch_time=0.45069 
Train Epoch: 15 [46/1000 1472/32000 (5%)] Loss: 0.37671 (QuantReg: 12.44398) QuantErr: 12.44398 batch_time=0.38392 
Train Epoch: 15 [51/1000 1632/32000 (5%)] Loss: 0.33290 (QuantReg: 12.15846) QuantErr: 12.15846 batch_time=0.39927 
Train Epoch: 15 [56/1000 1792/32000 (6%)] Loss: 0.26910 (QuantReg: 12.25426) QuantErr: 12.25426 batch_time=0.35850 
Train Epoch: 15 [61/1000 1952/32000 (6%)] Loss: 0.46633 (QuantReg: 11.80007) QuantErr: 11.80007 batch_time=0.36394 
Train Epoch: 15 [66/1000 2112/32000 (7%)] Loss: 0.55929 (QuantReg: 11.99114) QuantErr: 11.99114 batch_time=0.60667 
Train Epoch: 15 [71/1000 2272/32000 (7%)] Loss: 1.08553 (QuantReg: 12.12318) QuantErr: 12.12318 batch_time=0.38408 
Train Epoch: 15 [76/1000 2432/32000 (8%)] Loss: 0.42624 (QuantReg: 11.97552) QuantErr: 11.97552 batch_time=0.36565 
Train Epoch: 15 [81/1000 2592/32000 (8%)] Loss: 0.49681 (QuantReg: 12.03081) QuantErr: 12.03081 batch_time=0.34658 
Train Epoch: 15 [86/1000 2752/32000 (9%)] Loss: 0.61795 (QuantReg: 12.30180) QuantErr: 12.30180 batch_time=0.44363 
Train Epoch: 15 [91/1000 2912/32000 (9%)] Loss: 0.77330 (QuantReg: 11.68387) QuantErr: 11.68387 batch_time=0.34600 
Train Epoch: 15 [96/1000 3072/32000 (10%)] Loss: 0.50334 (QuantReg: 11.47561) QuantErr: 11.47561 batch_time=0.60714 
Train Epoch: 15 [101/1000 3232/32000 (10%)] Loss: 0.82013 (QuantReg: 11.19158) QuantErr: 11.19158 batch_time=0.35320 
Train Epoch: 15 [106/1000 3392/32000 (11%)] Loss: 0.26641 (QuantReg: 11.55499) QuantErr: 11.55499 batch_time=0.60074 
Train Epoch: 15 [111/1000 3552/32000 (11%)] Loss: 0.33192 (QuantReg: 12.04141) QuantErr: 12.04141 batch_time=0.38552 
Train Epoch: 15 [116/1000 3712/32000 (12%)] Loss: 0.50770 (QuantReg: 12.13136) QuantErr: 12.13136 batch_time=0.40975 
Train Epoch: 15 [121/1000 3872/32000 (12%)] Loss: 0.75852 (QuantReg: 12.34273) QuantErr: 12.34273 batch_time=0.36900 
Train Epoch: 15 [126/1000 4032/32000 (13%)] Loss: 0.67080 (QuantReg: 13.19835) QuantErr: 13.19835 batch_time=0.36577 
Train Epoch: 15 [131/1000 4192/32000 (13%)] Loss: 0.96047 (QuantReg: 12.03448) QuantErr: 12.03448 batch_time=0.37687 
Train Epoch: 15 [136/1000 4352/32000 (14%)] Loss: 1.29653 (QuantReg: 11.56781) QuantErr: 11.56781 batch_time=0.34486 
Train Epoch: 15 [141/1000 4512/32000 (14%)] Loss: 0.48794 (QuantReg: 12.29858) QuantErr: 12.29858 batch_time=0.35990 
Train Epoch: 15 [146/1000 4672/32000 (15%)] Loss: 0.31094 (QuantReg: 12.39691) QuantErr: 12.39691 batch_time=0.90119 
Train Epoch: 15 [151/1000 4832/32000 (15%)] Loss: 0.57649 (QuantReg: 11.94025) QuantErr: 11.94025 batch_time=0.40106 
Train Epoch: 15 [156/1000 4992/32000 (16%)] Loss: 0.52011 (QuantReg: 11.32791) QuantErr: 11.32791 batch_time=0.47718 
Train Epoch: 15 [161/1000 5152/32000 (16%)] Loss: 0.73091 (QuantReg: 11.41611) QuantErr: 11.41611 batch_time=0.42591 
Train Epoch: 15 [166/1000 5312/32000 (17%)] Loss: 0.40471 (QuantReg: 12.01874) QuantErr: 12.01874 batch_time=0.38706 
Train Epoch: 15 [171/1000 5472/32000 (17%)] Loss: 0.57952 (QuantReg: 12.13470) QuantErr: 12.13470 batch_time=0.34550 
Train Epoch: 15 [176/1000 5632/32000 (18%)] Loss: 0.62795 (QuantReg: 11.66868) QuantErr: 11.66868 batch_time=0.48960 
Train Epoch: 15 [181/1000 5792/32000 (18%)] Loss: 0.76860 (QuantReg: 10.96718) QuantErr: 10.96718 batch_time=0.34884 
Train Epoch: 15 [186/1000 5952/32000 (19%)] Loss: 0.41405 (QuantReg: 11.84434) QuantErr: 11.84434 batch_time=0.38833 
Train Epoch: 15 [191/1000 6112/32000 (19%)] Loss: 0.71728 (QuantReg: 11.51022) QuantErr: 11.51022 batch_time=0.35451 
Train Epoch: 15 [196/1000 6272/32000 (20%)] Loss: 0.44742 (QuantReg: 11.72441) QuantErr: 11.72441 batch_time=0.39169 
Train Epoch: 15 [201/1000 6432/32000 (20%)] Loss: 0.31214 (QuantReg: 12.41342) QuantErr: 12.41342 batch_time=0.34404 
Train Epoch: 15 [206/1000 6592/32000 (21%)] Loss: 0.36927 (QuantReg: 11.97705) QuantErr: 11.97705 batch_time=0.37613 
Train Epoch: 15 [211/1000 6752/32000 (21%)] Loss: 0.40579 (QuantReg: 12.09569) QuantErr: 12.09569 batch_time=0.37322 
Train Epoch: 15 [216/1000 6912/32000 (22%)] Loss: 0.68074 (QuantReg: 12.61958) QuantErr: 12.61958 batch_time=0.36892 
Train Epoch: 15 [221/1000 7072/32000 (22%)] Loss: 1.12275 (QuantReg: 11.73324) QuantErr: 11.73324 batch_time=0.36177 
Train Epoch: 15 [226/1000 7232/32000 (23%)] Loss: 0.47094 (QuantReg: 12.06230) QuantErr: 12.06230 batch_time=0.36184 
Train Epoch: 15 [231/1000 7392/32000 (23%)] Loss: 0.75614 (QuantReg: 11.27905) QuantErr: 11.27905 batch_time=0.45531 
Train Epoch: 15 [236/1000 7552/32000 (24%)] Loss: 0.40599 (QuantReg: 11.91085) QuantErr: 11.91085 batch_time=0.36225 
Train Epoch: 15 [241/1000 7712/32000 (24%)] Loss: 0.47903 (QuantReg: 11.63299) QuantErr: 11.63299 batch_time=0.34694 
Train Epoch: 15 [246/1000 7872/32000 (25%)] Loss: 0.31404 (QuantReg: 12.42209) QuantErr: 12.42209 batch_time=0.34772 
Train Epoch: 15 [251/1000 8032/32000 (25%)] Loss: 0.49995 (QuantReg: 12.32908) QuantErr: 12.32908 batch_time=0.41389 
Train Epoch: 15 [256/1000 8192/32000 (26%)] Loss: 0.73297 (QuantReg: 11.77106) QuantErr: 11.77106 batch_time=0.34700 
Train Epoch: 15 [261/1000 8352/32000 (26%)] Loss: 0.26614 (QuantReg: 11.89085) QuantErr: 11.89085 batch_time=0.36359 
Train Epoch: 15 [266/1000 8512/32000 (27%)] Loss: 1.03196 (QuantReg: 11.89291) QuantErr: 11.89291 batch_time=0.34833 
Train Epoch: 15 [271/1000 8672/32000 (27%)] Loss: 0.25761 (QuantReg: 12.29562) QuantErr: 12.29562 batch_time=0.39993 
Train Epoch: 15 [276/1000 8832/32000 (28%)] Loss: 0.52380 (QuantReg: 12.22040) QuantErr: 12.22040 batch_time=0.82432 
Train Epoch: 15 [281/1000 8992/32000 (28%)] Loss: 0.47775 (QuantReg: 12.47199) QuantErr: 12.47199 batch_time=0.34372 
Train Epoch: 15 [286/1000 9152/32000 (29%)] Loss: 1.09036 (QuantReg: 11.80577) QuantErr: 11.80577 batch_time=0.34584 
Train Epoch: 15 [291/1000 9312/32000 (29%)] Loss: 0.99864 (QuantReg: 12.34133) QuantErr: 12.34133 batch_time=0.38395 
Train Epoch: 15 [296/1000 9472/32000 (30%)] Loss: 0.36634 (QuantReg: 12.39213) QuantErr: 12.39213 batch_time=0.36604 
Train Epoch: 15 [301/1000 9632/32000 (30%)] Loss: 0.92724 (QuantReg: 12.84627) QuantErr: 12.84627 batch_time=0.36781 
Train Epoch: 15 [306/1000 9792/32000 (31%)] Loss: 0.46244 (QuantReg: 12.21367) QuantErr: 12.21367 batch_time=0.38411 
Train Epoch: 15 [311/1000 9952/32000 (31%)] Loss: 0.79852 (QuantReg: 12.10275) QuantErr: 12.10275 batch_time=0.37190 
Train Epoch: 15 [316/1000 10112/32000 (32%)] Loss: 0.89361 (QuantReg: 11.71471) QuantErr: 11.71471 batch_time=0.39285 
Train Epoch: 15 [321/1000 10272/32000 (32%)] Loss: 0.84478 (QuantReg: 11.39242) QuantErr: 11.39242 batch_time=0.35594 
Train Epoch: 15 [326/1000 10432/32000 (33%)] Loss: 0.39612 (QuantReg: 12.36288) QuantErr: 12.36288 batch_time=0.57033 
Train Epoch: 15 [331/1000 10592/32000 (33%)] Loss: 0.35519 (QuantReg: 12.15934) QuantErr: 12.15934 batch_time=0.36684 
Train Epoch: 15 [336/1000 10752/32000 (34%)] Loss: 0.57473 (QuantReg: 12.26791) QuantErr: 12.26791 batch_time=0.54084 
Train Epoch: 15 [341/1000 10912/32000 (34%)] Loss: 0.50197 (QuantReg: 11.86373) QuantErr: 11.86373 batch_time=0.34958 
Train Epoch: 15 [346/1000 11072/32000 (35%)] Loss: 0.84663 (QuantReg: 11.79414) QuantErr: 11.79414 batch_time=0.40479 
Train Epoch: 15 [351/1000 11232/32000 (35%)] Loss: 0.78855 (QuantReg: 11.99795) QuantErr: 11.99795 batch_time=0.35657 
Train Epoch: 15 [356/1000 11392/32000 (36%)] Loss: 0.47049 (QuantReg: 11.94400) QuantErr: 11.94400 batch_time=0.35022 
Train Epoch: 15 [361/1000 11552/32000 (36%)] Loss: 0.86617 (QuantReg: 12.54727) QuantErr: 12.54727 batch_time=0.35947 
Train Epoch: 15 [366/1000 11712/32000 (37%)] Loss: 0.41539 (QuantReg: 12.01181) QuantErr: 12.01181 batch_time=0.36450 
Train Epoch: 15 [371/1000 11872/32000 (37%)] Loss: 0.22602 (QuantReg: 12.45548) QuantErr: 12.45548 batch_time=0.36360 
Train Epoch: 15 [376/1000 12032/32000 (38%)] Loss: 0.48185 (QuantReg: 11.94556) QuantErr: 11.94556 batch_time=0.34481 
Train Epoch: 15 [381/1000 12192/32000 (38%)] Loss: 0.71162 (QuantReg: 12.10180) QuantErr: 12.10180 batch_time=0.38815 
Train Epoch: 15 [386/1000 12352/32000 (39%)] Loss: 0.56245 (QuantReg: 12.23800) QuantErr: 12.23800 batch_time=0.68994 
Train Epoch: 15 [391/1000 12512/32000 (39%)] Loss: 0.55105 (QuantReg: 12.36238) QuantErr: 12.36238 batch_time=0.38656 
Train Epoch: 15 [396/1000 12672/32000 (40%)] Loss: 0.49040 (QuantReg: 12.26336) QuantErr: 12.26336 batch_time=0.44075 
Train Epoch: 15 [401/1000 12832/32000 (40%)] Loss: 0.87404 (QuantReg: 11.76511) QuantErr: 11.76511 batch_time=0.34601 
Train Epoch: 15 [406/1000 12992/32000 (41%)] Loss: 0.46346 (QuantReg: 12.40580) QuantErr: 12.40580 batch_time=0.43460 
Train Epoch: 15 [411/1000 13152/32000 (41%)] Loss: 0.62844 (QuantReg: 10.93322) QuantErr: 10.93322 batch_time=0.34498 
Train Epoch: 15 [416/1000 13312/32000 (42%)] Loss: 0.71953 (QuantReg: 12.61641) QuantErr: 12.61641 batch_time=0.59411 
Train Epoch: 15 [421/1000 13472/32000 (42%)] Loss: 0.59819 (QuantReg: 12.09984) QuantErr: 12.09984 batch_time=0.34834 
Train Epoch: 15 [426/1000 13632/32000 (43%)] Loss: 0.45401 (QuantReg: 12.24631) QuantErr: 12.24631 batch_time=0.53346 
Train Epoch: 15 [431/1000 13792/32000 (43%)] Loss: 0.37794 (QuantReg: 12.21060) QuantErr: 12.21060 batch_time=0.37037 
Train Epoch: 15 [436/1000 13952/32000 (44%)] Loss: 0.40691 (QuantReg: 11.20961) QuantErr: 11.20961 batch_time=0.42609 
Train Epoch: 15 [441/1000 14112/32000 (44%)] Loss: 0.21657 (QuantReg: 12.30179) QuantErr: 12.30179 batch_time=0.35128 
Train Epoch: 15 [446/1000 14272/32000 (45%)] Loss: 0.65733 (QuantReg: 12.07537) QuantErr: 12.07537 batch_time=0.37990 
Train Epoch: 15 [451/1000 14432/32000 (45%)] Loss: 0.31123 (QuantReg: 11.97252) QuantErr: 11.97252 batch_time=0.35976 
Train Epoch: 15 [456/1000 14592/32000 (46%)] Loss: 0.48217 (QuantReg: 11.81258) QuantErr: 11.81258 batch_time=0.36510 
Train Epoch: 15 [461/1000 14752/32000 (46%)] Loss: 0.78416 (QuantReg: 12.31974) QuantErr: 12.31974 batch_time=0.34407 
Train Epoch: 15 [466/1000 14912/32000 (47%)] Loss: 0.44945 (QuantReg: 12.17572) QuantErr: 12.17572 batch_time=0.79502 
Train Epoch: 15 [471/1000 15072/32000 (47%)] Loss: 0.39532 (QuantReg: 11.52476) QuantErr: 11.52476 batch_time=0.45381 
Train Epoch: 15 [476/1000 15232/32000 (48%)] Loss: 1.05133 (QuantReg: 12.01475) QuantErr: 12.01475 batch_time=0.35002 
Train Epoch: 15 [481/1000 15392/32000 (48%)] Loss: 0.60610 (QuantReg: 11.61752) QuantErr: 11.61752 batch_time=0.35914 
Train Epoch: 15 [486/1000 15552/32000 (49%)] Loss: 0.59512 (QuantReg: 11.58651) QuantErr: 11.58651 batch_time=0.35645 
Train Epoch: 15 [491/1000 15712/32000 (49%)] Loss: 0.52002 (QuantReg: 12.29105) QuantErr: 12.29105 batch_time=0.36968 
Train Epoch: 15 [496/1000 15872/32000 (50%)] Loss: 0.78689 (QuantReg: 11.86275) QuantErr: 11.86275 batch_time=0.42942 
Train Epoch: 15 [501/1000 16032/32000 (50%)] Loss: 0.77624 (QuantReg: 12.61223) QuantErr: 12.61223 batch_time=0.35006 
Train Epoch: 15 [506/1000 16192/32000 (51%)] Loss: 0.42663 (QuantReg: 12.11644) QuantErr: 12.11644 batch_time=0.33562 
Train Epoch: 15 [511/1000 16352/32000 (51%)] Loss: 0.16096 (QuantReg: 12.39937) QuantErr: 12.39937 batch_time=0.34027 
Train Epoch: 15 [516/1000 16512/32000 (52%)] Loss: 0.58238 (QuantReg: 12.10545) QuantErr: 12.10545 batch_time=0.34356 
Train Epoch: 15 [521/1000 16672/32000 (52%)] Loss: 0.77789 (QuantReg: 11.71264) QuantErr: 11.71264 batch_time=0.34357 
Train Epoch: 15 [526/1000 16832/32000 (53%)] Loss: 0.51851 (QuantReg: 11.92255) QuantErr: 11.92255 batch_time=0.34398 
Train Epoch: 15 [531/1000 16992/32000 (53%)] Loss: 0.48080 (QuantReg: 11.53925) QuantErr: 11.53925 batch_time=0.36871 
Train Epoch: 15 [536/1000 17152/32000 (54%)] Loss: 0.55984 (QuantReg: 11.86578) QuantErr: 11.86578 batch_time=0.37290 
Train Epoch: 15 [541/1000 17312/32000 (54%)] Loss: 0.23655 (QuantReg: 12.06295) QuantErr: 12.06295 batch_time=0.35933 
Train Epoch: 15 [546/1000 17472/32000 (55%)] Loss: 0.89319 (QuantReg: 12.25935) QuantErr: 12.25935 batch_time=0.47515 
Train Epoch: 15 [551/1000 17632/32000 (55%)] Loss: 0.49940 (QuantReg: 12.40954) QuantErr: 12.40954 batch_time=0.36026 
Train Epoch: 15 [556/1000 17792/32000 (56%)] Loss: 0.53422 (QuantReg: 12.59604) QuantErr: 12.59604 batch_time=0.36451 
Train Epoch: 15 [561/1000 17952/32000 (56%)] Loss: 0.37317 (QuantReg: 12.69035) QuantErr: 12.69035 batch_time=0.39913 
Train Epoch: 15 [566/1000 18112/32000 (57%)] Loss: 0.58841 (QuantReg: 12.61870) QuantErr: 12.61870 batch_time=0.40343 
Train Epoch: 15 [571/1000 18272/32000 (57%)] Loss: 0.67294 (QuantReg: 12.82480) QuantErr: 12.82480 batch_time=0.34777 
Train Epoch: 15 [576/1000 18432/32000 (58%)] Loss: 1.06233 (QuantReg: 12.30061) QuantErr: 12.30061 batch_time=0.34622 
Train Epoch: 15 [581/1000 18592/32000 (58%)] Loss: 0.43962 (QuantReg: 12.30843) QuantErr: 12.30843 batch_time=0.34445 
Train Epoch: 15 [586/1000 18752/32000 (59%)] Loss: 0.42624 (QuantReg: 11.24258) QuantErr: 11.24258 batch_time=0.36125 
Train Epoch: 15 [591/1000 18912/32000 (59%)] Loss: 0.51817 (QuantReg: 12.46015) QuantErr: 12.46015 batch_time=0.39739 
Train Epoch: 15 [596/1000 19072/32000 (60%)] Loss: 0.79011 (QuantReg: 11.52961) QuantErr: 11.52961 batch_time=0.88109 
Train Epoch: 15 [601/1000 19232/32000 (60%)] Loss: 1.10910 (QuantReg: 12.58753) QuantErr: 12.58753 batch_time=0.33888 
Train Epoch: 15 [606/1000 19392/32000 (61%)] Loss: 0.96705 (QuantReg: 11.27153) QuantErr: 11.27153 batch_time=0.38002 
Train Epoch: 15 [611/1000 19552/32000 (61%)] Loss: 0.56719 (QuantReg: 12.27682) QuantErr: 12.27682 batch_time=0.39756 
Train Epoch: 15 [616/1000 19712/32000 (62%)] Loss: 0.38296 (QuantReg: 12.90925) QuantErr: 12.90925 batch_time=0.39113 
Train Epoch: 15 [621/1000 19872/32000 (62%)] Loss: 0.41836 (QuantReg: 12.17779) QuantErr: 12.17779 batch_time=0.34694 
Train Epoch: 15 [626/1000 20032/32000 (63%)] Loss: 0.60636 (QuantReg: 12.08271) QuantErr: 12.08271 batch_time=0.39618 
Train Epoch: 15 [631/1000 20192/32000 (63%)] Loss: 0.75003 (QuantReg: 11.67967) QuantErr: 11.67967 batch_time=0.36368 
Train Epoch: 15 [636/1000 20352/32000 (64%)] Loss: 0.49390 (QuantReg: 12.11735) QuantErr: 12.11735 batch_time=0.36743 
Train Epoch: 15 [641/1000 20512/32000 (64%)] Loss: 0.84555 (QuantReg: 12.56827) QuantErr: 12.56827 batch_time=0.34614 
Train Epoch: 15 [646/1000 20672/32000 (65%)] Loss: 0.62058 (QuantReg: 12.02951) QuantErr: 12.02951 batch_time=0.50929 
Train Epoch: 15 [651/1000 20832/32000 (65%)] Loss: 0.43745 (QuantReg: 12.73084) QuantErr: 12.73084 batch_time=0.34877 
Train Epoch: 15 [656/1000 20992/32000 (66%)] Loss: 0.58429 (QuantReg: 11.65168) QuantErr: 11.65168 batch_time=0.40918 
Train Epoch: 15 [661/1000 21152/32000 (66%)] Loss: 0.59874 (QuantReg: 12.82494) QuantErr: 12.82494 batch_time=0.37891 
Train Epoch: 15 [666/1000 21312/32000 (67%)] Loss: 0.65997 (QuantReg: 11.29147) QuantErr: 11.29147 batch_time=0.38401 
Train Epoch: 15 [671/1000 21472/32000 (67%)] Loss: 0.36364 (QuantReg: 11.53205) QuantErr: 11.53205 batch_time=0.35143 
Train Epoch: 15 [676/1000 21632/32000 (68%)] Loss: 0.46417 (QuantReg: 12.45567) QuantErr: 12.45567 batch_time=0.38913 
Train Epoch: 15 [681/1000 21792/32000 (68%)] Loss: 0.82900 (QuantReg: 12.17543) QuantErr: 12.17543 batch_time=0.40244 
Train Epoch: 15 [686/1000 21952/32000 (69%)] Loss: 0.28018 (QuantReg: 12.03629) QuantErr: 12.03629 batch_time=0.44997 
Train Epoch: 15 [691/1000 22112/32000 (69%)] Loss: 0.26117 (QuantReg: 12.93698) QuantErr: 12.93698 batch_time=0.37492 
Train Epoch: 15 [696/1000 22272/32000 (70%)] Loss: 0.61761 (QuantReg: 12.53009) QuantErr: 12.53009 batch_time=0.39271 
Train Epoch: 15 [701/1000 22432/32000 (70%)] Loss: 0.83168 (QuantReg: 12.41257) QuantErr: 12.41257 batch_time=0.35939 
Train Epoch: 15 [706/1000 22592/32000 (71%)] Loss: 0.64677 (QuantReg: 12.27442) QuantErr: 12.27442 batch_time=0.62255 
Train Epoch: 15 [711/1000 22752/32000 (71%)] Loss: 0.36532 (QuantReg: 12.15934) QuantErr: 12.15934 batch_time=0.35899 
Train Epoch: 15 [716/1000 22912/32000 (72%)] Loss: 0.27136 (QuantReg: 12.11238) QuantErr: 12.11238 batch_time=0.35819 
Train Epoch: 15 [721/1000 23072/32000 (72%)] Loss: 0.71691 (QuantReg: 12.27251) QuantErr: 12.27251 batch_time=0.35269 
Train Epoch: 15 [726/1000 23232/32000 (73%)] Loss: 0.37992 (QuantReg: 12.29213) QuantErr: 12.29213 batch_time=0.42359 
Train Epoch: 15 [731/1000 23392/32000 (73%)] Loss: 0.69313 (QuantReg: 12.32780) QuantErr: 12.32780 batch_time=0.35160 
Train Epoch: 15 [736/1000 23552/32000 (74%)] Loss: 0.88574 (QuantReg: 12.17194) QuantErr: 12.17194 batch_time=0.60037 
Train Epoch: 15 [741/1000 23712/32000 (74%)] Loss: 0.13902 (QuantReg: 12.18467) QuantErr: 12.18467 batch_time=0.35059 
Train Epoch: 15 [746/1000 23872/32000 (75%)] Loss: 0.76315 (QuantReg: 11.89140) QuantErr: 11.89140 batch_time=0.50194 
Train Epoch: 15 [751/1000 24032/32000 (75%)] Loss: 0.41699 (QuantReg: 11.52546) QuantErr: 11.52546 batch_time=0.40649 
Train Epoch: 15 [756/1000 24192/32000 (76%)] Loss: 0.43774 (QuantReg: 12.48677) QuantErr: 12.48677 batch_time=0.45306 
Train Epoch: 15 [761/1000 24352/32000 (76%)] Loss: 0.35660 (QuantReg: 12.51569) QuantErr: 12.51569 batch_time=0.35465 
Train Epoch: 15 [766/1000 24512/32000 (77%)] Loss: 1.07561 (QuantReg: 11.98687) QuantErr: 11.98687 batch_time=0.38750 
Train Epoch: 15 [771/1000 24672/32000 (77%)] Loss: 0.31316 (QuantReg: 11.88103) QuantErr: 11.88103 batch_time=0.36541 
Train Epoch: 15 [776/1000 24832/32000 (78%)] Loss: 0.58636 (QuantReg: 11.88441) QuantErr: 11.88441 batch_time=0.35914 
Train Epoch: 15 [781/1000 24992/32000 (78%)] Loss: 0.72492 (QuantReg: 12.56054) QuantErr: 12.56054 batch_time=0.35904 
Train Epoch: 15 [786/1000 25152/32000 (79%)] Loss: 0.38456 (QuantReg: 12.14508) QuantErr: 12.14508 batch_time=0.82361 
Train Epoch: 15 [791/1000 25312/32000 (79%)] Loss: 1.03206 (QuantReg: 11.58908) QuantErr: 11.58908 batch_time=0.36393 
Train Epoch: 15 [796/1000 25472/32000 (80%)] Loss: 0.37179 (QuantReg: 12.26026) QuantErr: 12.26026 batch_time=0.35341 
Train Epoch: 15 [801/1000 25632/32000 (80%)] Loss: 0.78210 (QuantReg: 12.67947) QuantErr: 12.67947 batch_time=0.38841 
Train Epoch: 15 [806/1000 25792/32000 (81%)] Loss: 0.52537 (QuantReg: 12.65160) QuantErr: 12.65160 batch_time=0.35585 
Train Epoch: 15 [811/1000 25952/32000 (81%)] Loss: 0.51994 (QuantReg: 12.36946) QuantErr: 12.36946 batch_time=0.37889 
Train Epoch: 15 [816/1000 26112/32000 (82%)] Loss: 0.39250 (QuantReg: 12.21073) QuantErr: 12.21073 batch_time=0.48074 
Train Epoch: 15 [821/1000 26272/32000 (82%)] Loss: 0.62298 (QuantReg: 12.28039) QuantErr: 12.28039 batch_time=0.40856 
Train Epoch: 15 [826/1000 26432/32000 (83%)] Loss: 0.65858 (QuantReg: 12.26436) QuantErr: 12.26436 batch_time=0.41108 
Train Epoch: 15 [831/1000 26592/32000 (83%)] Loss: 0.70825 (QuantReg: 11.89695) QuantErr: 11.89695 batch_time=0.38089 
Train Epoch: 15 [836/1000 26752/32000 (84%)] Loss: 0.15118 (QuantReg: 11.64529) QuantErr: 11.64529 batch_time=0.37013 
Train Epoch: 15 [841/1000 26912/32000 (84%)] Loss: 0.21920 (QuantReg: 12.41525) QuantErr: 12.41525 batch_time=0.36208 
Train Epoch: 15 [846/1000 27072/32000 (85%)] Loss: 0.55579 (QuantReg: 12.69310) QuantErr: 12.69310 batch_time=0.34868 
Train Epoch: 15 [851/1000 27232/32000 (85%)] Loss: 0.51727 (QuantReg: 12.51088) QuantErr: 12.51088 batch_time=0.35750 
Train Epoch: 15 [856/1000 27392/32000 (86%)] Loss: 0.84530 (QuantReg: 11.54223) QuantErr: 11.54223 batch_time=0.35153 
Train Epoch: 15 [861/1000 27552/32000 (86%)] Loss: 0.74526 (QuantReg: 11.78103) QuantErr: 11.78103 batch_time=0.35273 
Train Epoch: 15 [866/1000 27712/32000 (87%)] Loss: 0.41452 (QuantReg: 12.09543) QuantErr: 12.09543 batch_time=0.38088 
Train Epoch: 15 [871/1000 27872/32000 (87%)] Loss: 0.47561 (QuantReg: 12.24194) QuantErr: 12.24194 batch_time=0.35122 
Train Epoch: 15 [876/1000 28032/32000 (88%)] Loss: 0.29944 (QuantReg: 11.64834) QuantErr: 11.64834 batch_time=0.34217 
Train Epoch: 15 [881/1000 28192/32000 (88%)] Loss: 0.42223 (QuantReg: 12.72157) QuantErr: 12.72157 batch_time=0.36511 
Train Epoch: 15 [886/1000 28352/32000 (89%)] Loss: 0.41475 (QuantReg: 12.21791) QuantErr: 12.21791 batch_time=0.39944 
Train Epoch: 15 [891/1000 28512/32000 (89%)] Loss: 0.79400 (QuantReg: 11.86985) QuantErr: 11.86985 batch_time=0.35712 
Train Epoch: 15 [896/1000 28672/32000 (90%)] Loss: 0.52834 (QuantReg: 12.24369) QuantErr: 12.24369 batch_time=0.38822 
Train Epoch: 15 [901/1000 28832/32000 (90%)] Loss: 0.68840 (QuantReg: 12.54106) QuantErr: 12.54106 batch_time=0.34616 
Train Epoch: 15 [906/1000 28992/32000 (91%)] Loss: 0.47227 (QuantReg: 12.10950) QuantErr: 12.10950 batch_time=0.35979 
Train Epoch: 15 [911/1000 29152/32000 (91%)] Loss: 0.47229 (QuantReg: 11.96668) QuantErr: 11.96668 batch_time=0.34795 
Train Epoch: 15 [916/1000 29312/32000 (92%)] Loss: 0.35177 (QuantReg: 12.70511) QuantErr: 12.70511 batch_time=0.78862 
Train Epoch: 15 [921/1000 29472/32000 (92%)] Loss: 0.42644 (QuantReg: 12.13012) QuantErr: 12.13012 batch_time=0.39276 
Train Epoch: 15 [926/1000 29632/32000 (93%)] Loss: 0.39377 (QuantReg: 12.04763) QuantErr: 12.04763 batch_time=0.38674 
Train Epoch: 15 [931/1000 29792/32000 (93%)] Loss: 0.40425 (QuantReg: 12.41613) QuantErr: 12.41613 batch_time=0.36810 
Train Epoch: 15 [936/1000 29952/32000 (94%)] Loss: 0.25616 (QuantReg: 12.01056) QuantErr: 12.01056 batch_time=0.36530 
Train Epoch: 15 [941/1000 30112/32000 (94%)] Loss: 0.53235 (QuantReg: 11.61526) QuantErr: 11.61526 batch_time=0.36881 
Train Epoch: 15 [946/1000 30272/32000 (95%)] Loss: 0.37343 (QuantReg: 12.65097) QuantErr: 12.65097 batch_time=0.43296 
Train Epoch: 15 [951/1000 30432/32000 (95%)] Loss: 0.48561 (QuantReg: 12.23038) QuantErr: 12.23038 batch_time=0.38384 
Train Epoch: 15 [956/1000 30592/32000 (96%)] Loss: 0.51651 (QuantReg: 12.36197) QuantErr: 12.36197 batch_time=0.47307 
Train Epoch: 15 [961/1000 30752/32000 (96%)] Loss: 0.31205 (QuantReg: 11.97169) QuantErr: 11.97169 batch_time=0.37640 
Train Epoch: 15 [966/1000 30912/32000 (97%)] Loss: 0.33210 (QuantReg: 12.43622) QuantErr: 12.43622 batch_time=0.50009 
Train Epoch: 15 [971/1000 31072/32000 (97%)] Loss: 0.43608 (QuantReg: 12.42038) QuantErr: 12.42038 batch_time=0.38691 
Train Epoch: 15 [976/1000 31232/32000 (98%)] Loss: 0.17239 (QuantReg: 12.61023) QuantErr: 12.61023 batch_time=0.42214 
Train Epoch: 15 [981/1000 31392/32000 (98%)] Loss: 0.60799 (QuantReg: 12.79882) QuantErr: 12.79882 batch_time=0.35634 
Train Epoch: 15 [986/1000 31552/32000 (99%)] Loss: 0.65418 (QuantReg: 12.33069) QuantErr: 12.33069 batch_time=0.42392 
Train Epoch: 15 [991/1000 31712/32000 (99%)] Loss: 0.23063 (QuantReg: 12.19876) QuantErr: 12.19876 batch_time=0.39628 
Train Epoch: 15 [996/1000 31872/32000 (100%)] Loss: 0.60625 (QuantReg: 13.11310) QuantErr: 13.11310 batch_time=0.36873 
Train Epoch: 15 codebook_update_time=2.24304
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch15.pth ...
Done in 4.281s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 0.5615255618095398
 quant_reg      : 12.095509442329407
 quant_err      : 12.095509442329407
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 15000
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 63.17907444668008
 MSRVTT_full_val/t2v_metrics/R10: 77.06237424547284
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.593561368209256
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.65203662859213
 MSRVTT_full_val/v2t_metrics/R1: 34.40643863179074
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 83.90342052313883
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.458752515090543
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.023109699454004
 MSRVTT_full_test/t2v_metrics/R1: 10.100334448160535
 MSRVTT_full_test/t2v_metrics/R5: 30.96989966555184
 MSRVTT_full_test/t2v_metrics/R10: 45.65217391304348
 MSRVTT_full_test/t2v_metrics/R50: 78.02675585284281
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.862876254180605
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.26120338975009
 MSRVTT_full_test/v2t_metrics/R1: 12.508361204013378
 MSRVTT_full_test/v2t_metrics/R5: 37.65886287625418
 MSRVTT_full_test/v2t_metrics/R10: 52.30769230769231
 MSRVTT_full_test/v2t_metrics/R50: 84.34782608695652
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.11939799331104
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.098977283894502
 mnt_best       : 24.827630678630275
 not_improved_count: 2
Train Epoch: 16 [1/1000 32/32000 (0%)] Loss: 0.48537 (QuantReg: 11.71805) QuantErr: 11.71805 batch_time=28.64271 
Train Epoch: 16 [6/1000 192/32000 (1%)] Loss: 0.83679 (QuantReg: 12.41742) QuantErr: 12.41742 batch_time=0.37833 
Train Epoch: 16 [11/1000 352/32000 (1%)] Loss: 0.36043 (QuantReg: 12.22016) QuantErr: 12.22016 batch_time=0.37214 
Train Epoch: 16 [16/1000 512/32000 (2%)] Loss: 0.65443 (QuantReg: 11.48040) QuantErr: 11.48040 batch_time=0.35864 
Train Epoch: 16 [21/1000 672/32000 (2%)] Loss: 0.49224 (QuantReg: 11.81816) QuantErr: 11.81816 batch_time=0.40908 
Train Epoch: 16 [26/1000 832/32000 (3%)] Loss: 0.32062 (QuantReg: 12.70612) QuantErr: 12.70612 batch_time=0.40639 
Train Epoch: 16 [31/1000 992/32000 (3%)] Loss: 1.03015 (QuantReg: 11.92631) QuantErr: 11.92631 batch_time=0.62189 
Train Epoch: 16 [36/1000 1152/32000 (4%)] Loss: 0.29051 (QuantReg: 12.29770) QuantErr: 12.29770 batch_time=0.37593 
Train Epoch: 16 [41/1000 1312/32000 (4%)] Loss: 0.28074 (QuantReg: 11.88854) QuantErr: 11.88854 batch_time=0.37162 
Train Epoch: 16 [46/1000 1472/32000 (5%)] Loss: 0.60233 (QuantReg: 12.01260) QuantErr: 12.01260 batch_time=0.41275 
Train Epoch: 16 [51/1000 1632/32000 (5%)] Loss: 0.25955 (QuantReg: 11.81059) QuantErr: 11.81059 batch_time=0.36906 
Train Epoch: 16 [56/1000 1792/32000 (6%)] Loss: 0.30930 (QuantReg: 12.08898) QuantErr: 12.08898 batch_time=0.35337 
Train Epoch: 16 [61/1000 1952/32000 (6%)] Loss: 0.72537 (QuantReg: 12.12157) QuantErr: 12.12157 batch_time=0.34560 
Train Epoch: 16 [66/1000 2112/32000 (7%)] Loss: 0.64665 (QuantReg: 12.22420) QuantErr: 12.22420 batch_time=0.50299 
Train Epoch: 16 [71/1000 2272/32000 (7%)] Loss: 0.23240 (QuantReg: 11.76127) QuantErr: 11.76127 batch_time=0.46029 
Train Epoch: 16 [76/1000 2432/32000 (8%)] Loss: 1.21786 (QuantReg: 11.63418) QuantErr: 11.63418 batch_time=0.35831 
Train Epoch: 16 [81/1000 2592/32000 (8%)] Loss: 0.85355 (QuantReg: 11.42833) QuantErr: 11.42833 batch_time=0.36119 
Train Epoch: 16 [86/1000 2752/32000 (9%)] Loss: 0.72508 (QuantReg: 12.22377) QuantErr: 12.22377 batch_time=0.40982 
Train Epoch: 16 [91/1000 2912/32000 (9%)] Loss: 0.43869 (QuantReg: 12.05491) QuantErr: 12.05491 batch_time=0.36979 
Train Epoch: 16 [96/1000 3072/32000 (10%)] Loss: 0.82106 (QuantReg: 11.89782) QuantErr: 11.89782 batch_time=0.41644 
Train Epoch: 16 [101/1000 3232/32000 (10%)] Loss: 0.47733 (QuantReg: 11.77779) QuantErr: 11.77779 batch_time=0.38686 
Train Epoch: 16 [106/1000 3392/32000 (11%)] Loss: 0.56576 (QuantReg: 11.90318) QuantErr: 11.90318 batch_time=0.38652 
Train Epoch: 16 [111/1000 3552/32000 (11%)] Loss: 0.45513 (QuantReg: 12.26928) QuantErr: 12.26928 batch_time=0.36781 
Train Epoch: 16 [116/1000 3712/32000 (12%)] Loss: 0.43385 (QuantReg: 13.17537) QuantErr: 13.17537 batch_time=0.42196 
Train Epoch: 16 [121/1000 3872/32000 (12%)] Loss: 0.53693 (QuantReg: 11.75916) QuantErr: 11.75916 batch_time=0.38092 
Train Epoch: 16 [126/1000 4032/32000 (13%)] Loss: 0.60127 (QuantReg: 11.66433) QuantErr: 11.66433 batch_time=0.37038 
Train Epoch: 16 [131/1000 4192/32000 (13%)] Loss: 0.35632 (QuantReg: 11.85422) QuantErr: 11.85422 batch_time=1.86629 
Train Epoch: 16 [136/1000 4352/32000 (14%)] Loss: 0.24325 (QuantReg: 12.27551) QuantErr: 12.27551 batch_time=0.35499 
Train Epoch: 16 [141/1000 4512/32000 (14%)] Loss: 0.79761 (QuantReg: 11.89461) QuantErr: 11.89461 batch_time=0.38818 
Train Epoch: 16 [146/1000 4672/32000 (15%)] Loss: 0.17475 (QuantReg: 11.70595) QuantErr: 11.70595 batch_time=0.35103 
Train Epoch: 16 [151/1000 4832/32000 (15%)] Loss: 1.01322 (QuantReg: 11.57918) QuantErr: 11.57918 batch_time=0.39302 
Train Epoch: 16 [156/1000 4992/32000 (16%)] Loss: 0.51824 (QuantReg: 11.79128) QuantErr: 11.79128 batch_time=0.35659 
Train Epoch: 16 [161/1000 5152/32000 (16%)] Loss: 0.36068 (QuantReg: 12.11001) QuantErr: 12.11001 batch_time=0.42897 
Train Epoch: 16 [166/1000 5312/32000 (17%)] Loss: 0.35880 (QuantReg: 11.61151) QuantErr: 11.61151 batch_time=0.38751 
Train Epoch: 16 [171/1000 5472/32000 (17%)] Loss: 0.45186 (QuantReg: 12.37418) QuantErr: 12.37418 batch_time=0.41345 
Train Epoch: 16 [176/1000 5632/32000 (18%)] Loss: 0.76281 (QuantReg: 11.40094) QuantErr: 11.40094 batch_time=0.37019 
Train Epoch: 16 [181/1000 5792/32000 (18%)] Loss: 0.51334 (QuantReg: 12.11803) QuantErr: 12.11803 batch_time=0.40100 
Train Epoch: 16 [186/1000 5952/32000 (19%)] Loss: 0.39112 (QuantReg: 12.36722) QuantErr: 12.36722 batch_time=0.34701 
Train Epoch: 16 [191/1000 6112/32000 (19%)] Loss: 0.29277 (QuantReg: 11.83148) QuantErr: 11.83148 batch_time=0.34203 
Train Epoch: 16 [196/1000 6272/32000 (20%)] Loss: 0.38946 (QuantReg: 12.73239) QuantErr: 12.73239 batch_time=0.34845 
Train Epoch: 16 [201/1000 6432/32000 (20%)] Loss: 0.58022 (QuantReg: 11.70994) QuantErr: 11.70994 batch_time=0.34459 
Train Epoch: 16 [206/1000 6592/32000 (21%)] Loss: 0.60559 (QuantReg: 12.36309) QuantErr: 12.36309 batch_time=0.37304 
Train Epoch: 16 [211/1000 6752/32000 (21%)] Loss: 0.47366 (QuantReg: 11.73692) QuantErr: 11.73692 batch_time=0.40840 
Train Epoch: 16 [216/1000 6912/32000 (22%)] Loss: 0.62415 (QuantReg: 12.02000) QuantErr: 12.02000 batch_time=0.39128 
Train Epoch: 16 [221/1000 7072/32000 (22%)] Loss: 0.88762 (QuantReg: 11.97779) QuantErr: 11.97779 batch_time=0.38490 
Train Epoch: 16 [226/1000 7232/32000 (23%)] Loss: 0.44760 (QuantReg: 12.30699) QuantErr: 12.30699 batch_time=0.38211 
Train Epoch: 16 [231/1000 7392/32000 (23%)] Loss: 0.81610 (QuantReg: 11.67953) QuantErr: 11.67953 batch_time=0.39374 
Train Epoch: 16 [236/1000 7552/32000 (24%)] Loss: 0.42106 (QuantReg: 12.07527) QuantErr: 12.07527 batch_time=0.41102 
Train Epoch: 16 [241/1000 7712/32000 (24%)] Loss: 0.33236 (QuantReg: 11.28643) QuantErr: 11.28643 batch_time=0.37768 
Train Epoch: 16 [246/1000 7872/32000 (25%)] Loss: 0.29934 (QuantReg: 12.80601) QuantErr: 12.80601 batch_time=0.41180 
Train Epoch: 16 [251/1000 8032/32000 (25%)] Loss: 0.44740 (QuantReg: 11.19592) QuantErr: 11.19592 batch_time=0.42576 
Train Epoch: 16 [256/1000 8192/32000 (26%)] Loss: 0.39223 (QuantReg: 11.57196) QuantErr: 11.57196 batch_time=0.35653 
Train Epoch: 16 [261/1000 8352/32000 (26%)] Loss: 0.84431 (QuantReg: 12.26762) QuantErr: 12.26762 batch_time=0.39505 
Train Epoch: 16 [266/1000 8512/32000 (27%)] Loss: 0.32725 (QuantReg: 12.02115) QuantErr: 12.02115 batch_time=0.34886 
Train Epoch: 16 [271/1000 8672/32000 (27%)] Loss: 0.21941 (QuantReg: 12.15753) QuantErr: 12.15753 batch_time=0.34346 
Train Epoch: 16 [276/1000 8832/32000 (28%)] Loss: 0.68103 (QuantReg: 11.94436) QuantErr: 11.94436 batch_time=0.35277 
Train Epoch: 16 [281/1000 8992/32000 (28%)] Loss: 0.39126 (QuantReg: 11.94969) QuantErr: 11.94969 batch_time=0.40798 
Train Epoch: 16 [286/1000 9152/32000 (29%)] Loss: 0.25147 (QuantReg: 11.93612) QuantErr: 11.93612 batch_time=0.37767 
Train Epoch: 16 [291/1000 9312/32000 (29%)] Loss: 0.68133 (QuantReg: 11.75703) QuantErr: 11.75703 batch_time=0.35925 
Train Epoch: 16 [296/1000 9472/32000 (30%)] Loss: 0.50396 (QuantReg: 11.83800) QuantErr: 11.83800 batch_time=0.40836 
Train Epoch: 16 [301/1000 9632/32000 (30%)] Loss: 0.67441 (QuantReg: 12.60828) QuantErr: 12.60828 batch_time=0.41705 
Train Epoch: 16 [306/1000 9792/32000 (31%)] Loss: 0.30042 (QuantReg: 12.40277) QuantErr: 12.40277 batch_time=0.39417 
Train Epoch: 16 [311/1000 9952/32000 (31%)] Loss: 0.26007 (QuantReg: 12.29309) QuantErr: 12.29309 batch_time=0.39684 
Train Epoch: 16 [316/1000 10112/32000 (32%)] Loss: 0.36940 (QuantReg: 12.28908) QuantErr: 12.28908 batch_time=0.44521 
Train Epoch: 16 [321/1000 10272/32000 (32%)] Loss: 0.90372 (QuantReg: 12.43468) QuantErr: 12.43468 batch_time=0.34663 
Train Epoch: 16 [326/1000 10432/32000 (33%)] Loss: 0.67035 (QuantReg: 12.53646) QuantErr: 12.53646 batch_time=0.34371 
Train Epoch: 16 [331/1000 10592/32000 (33%)] Loss: 0.45453 (QuantReg: 11.51411) QuantErr: 11.51411 batch_time=0.34706 
Train Epoch: 16 [336/1000 10752/32000 (34%)] Loss: 0.56415 (QuantReg: 12.34868) QuantErr: 12.34868 batch_time=0.34398 
Train Epoch: 16 [341/1000 10912/32000 (34%)] Loss: 0.37976 (QuantReg: 12.09187) QuantErr: 12.09187 batch_time=0.34291 
Train Epoch: 16 [346/1000 11072/32000 (35%)] Loss: 0.68744 (QuantReg: 11.96257) QuantErr: 11.96257 batch_time=0.41525 
Train Epoch: 16 [351/1000 11232/32000 (35%)] Loss: 0.34688 (QuantReg: 12.24951) QuantErr: 12.24951 batch_time=0.63272 
Train Epoch: 16 [356/1000 11392/32000 (36%)] Loss: 0.49164 (QuantReg: 12.45186) QuantErr: 12.45186 batch_time=0.36974 
Train Epoch: 16 [361/1000 11552/32000 (36%)] Loss: 0.37619 (QuantReg: 11.90277) QuantErr: 11.90277 batch_time=0.38858 
Train Epoch: 16 [366/1000 11712/32000 (37%)] Loss: 0.28729 (QuantReg: 11.87160) QuantErr: 11.87160 batch_time=0.41910 
Train Epoch: 16 [371/1000 11872/32000 (37%)] Loss: 1.09513 (QuantReg: 12.89300) QuantErr: 12.89300 batch_time=0.46995 
Train Epoch: 16 [376/1000 12032/32000 (38%)] Loss: 0.57880 (QuantReg: 12.25834) QuantErr: 12.25834 batch_time=0.44481 
Train Epoch: 16 [381/1000 12192/32000 (38%)] Loss: 0.46681 (QuantReg: 11.93402) QuantErr: 11.93402 batch_time=0.43494 
Train Epoch: 16 [386/1000 12352/32000 (39%)] Loss: 0.56441 (QuantReg: 12.60915) QuantErr: 12.60915 batch_time=0.61831 
Train Epoch: 16 [391/1000 12512/32000 (39%)] Loss: 0.29638 (QuantReg: 12.15263) QuantErr: 12.15263 batch_time=0.52190 
Train Epoch: 16 [396/1000 12672/32000 (40%)] Loss: 0.32652 (QuantReg: 12.41355) QuantErr: 12.41355 batch_time=0.37073 
Train Epoch: 16 [401/1000 12832/32000 (40%)] Loss: 0.46943 (QuantReg: 12.26620) QuantErr: 12.26620 batch_time=0.34464 
Train Epoch: 16 [406/1000 12992/32000 (41%)] Loss: 0.51110 (QuantReg: 11.91490) QuantErr: 11.91490 batch_time=0.37747 
Train Epoch: 16 [411/1000 13152/32000 (41%)] Loss: 0.44981 (QuantReg: 12.20219) QuantErr: 12.20219 batch_time=0.44758 
Train Epoch: 16 [416/1000 13312/32000 (42%)] Loss: 1.15757 (QuantReg: 11.41822) QuantErr: 11.41822 batch_time=0.41588 
Train Epoch: 16 [421/1000 13472/32000 (42%)] Loss: 0.39164 (QuantReg: 11.41785) QuantErr: 11.41785 batch_time=0.36796 
Train Epoch: 16 [426/1000 13632/32000 (43%)] Loss: 0.16306 (QuantReg: 11.74964) QuantErr: 11.74964 batch_time=0.37859 
Train Epoch: 16 [431/1000 13792/32000 (43%)] Loss: 0.70170 (QuantReg: 11.87555) QuantErr: 11.87555 batch_time=0.44776 
Train Epoch: 16 [436/1000 13952/32000 (44%)] Loss: 0.82270 (QuantReg: 11.33941) QuantErr: 11.33941 batch_time=0.36055 
Train Epoch: 16 [441/1000 14112/32000 (44%)] Loss: 0.32001 (QuantReg: 12.24901) QuantErr: 12.24901 batch_time=0.42500 
Train Epoch: 16 [446/1000 14272/32000 (45%)] Loss: 0.25524 (QuantReg: 11.83547) QuantErr: 11.83547 batch_time=0.40459 
Train Epoch: 16 [451/1000 14432/32000 (45%)] Loss: 0.69927 (QuantReg: 11.66071) QuantErr: 11.66071 batch_time=2.26438 
Train Epoch: 16 [456/1000 14592/32000 (46%)] Loss: 0.42627 (QuantReg: 12.64346) QuantErr: 12.64346 batch_time=0.36353 
Train Epoch: 16 [461/1000 14752/32000 (46%)] Loss: 0.94277 (QuantReg: 11.58818) QuantErr: 11.58818 batch_time=0.36002 
Train Epoch: 16 [466/1000 14912/32000 (47%)] Loss: 0.69931 (QuantReg: 11.70725) QuantErr: 11.70725 batch_time=0.34767 
Train Epoch: 16 [471/1000 15072/32000 (47%)] Loss: 0.43076 (QuantReg: 12.33434) QuantErr: 12.33434 batch_time=0.40652 
Train Epoch: 16 [476/1000 15232/32000 (48%)] Loss: 0.34933 (QuantReg: 12.01995) QuantErr: 12.01995 batch_time=0.43319 
Train Epoch: 16 [481/1000 15392/32000 (48%)] Loss: 0.50284 (QuantReg: 11.57426) QuantErr: 11.57426 batch_time=0.42553 
Train Epoch: 16 [486/1000 15552/32000 (49%)] Loss: 0.26881 (QuantReg: 12.62026) QuantErr: 12.62026 batch_time=0.37877 
Train Epoch: 16 [491/1000 15712/32000 (49%)] Loss: 0.69157 (QuantReg: 12.67644) QuantErr: 12.67644 batch_time=0.37113 
Train Epoch: 16 [496/1000 15872/32000 (50%)] Loss: 0.60084 (QuantReg: 12.70473) QuantErr: 12.70473 batch_time=0.40988 
Train Epoch: 16 [501/1000 16032/32000 (50%)] Loss: 0.31161 (QuantReg: 11.99456) QuantErr: 11.99456 batch_time=0.38742 
Train Epoch: 16 [506/1000 16192/32000 (51%)] Loss: 0.61652 (QuantReg: 12.54846) QuantErr: 12.54846 batch_time=0.39509 
Train Epoch: 16 [511/1000 16352/32000 (51%)] Loss: 0.67199 (QuantReg: 12.87757) QuantErr: 12.87757 batch_time=0.42502 
Train Epoch: 16 [516/1000 16512/32000 (52%)] Loss: 0.63150 (QuantReg: 11.72786) QuantErr: 11.72786 batch_time=0.36900 
Train Epoch: 16 [521/1000 16672/32000 (52%)] Loss: 0.75185 (QuantReg: 11.52576) QuantErr: 11.52576 batch_time=0.36241 
Train Epoch: 16 [526/1000 16832/32000 (53%)] Loss: 0.22441 (QuantReg: 12.23462) QuantErr: 12.23462 batch_time=0.37577 
Train Epoch: 16 [531/1000 16992/32000 (53%)] Loss: 0.82646 (QuantReg: 12.18895) QuantErr: 12.18895 batch_time=0.42693 
Train Epoch: 16 [536/1000 17152/32000 (54%)] Loss: 0.60947 (QuantReg: 12.08313) QuantErr: 12.08313 batch_time=0.36369 
Train Epoch: 16 [541/1000 17312/32000 (54%)] Loss: 0.53626 (QuantReg: 10.86430) QuantErr: 10.86430 batch_time=0.35805 
Train Epoch: 16 [546/1000 17472/32000 (55%)] Loss: 0.83842 (QuantReg: 12.02242) QuantErr: 12.02242 batch_time=0.41070 
Train Epoch: 16 [551/1000 17632/32000 (55%)] Loss: 0.99551 (QuantReg: 12.23120) QuantErr: 12.23120 batch_time=0.40195 
Train Epoch: 16 [556/1000 17792/32000 (56%)] Loss: 0.04842 (QuantReg: 12.73734) QuantErr: 12.73734 batch_time=0.39464 
Train Epoch: 16 [561/1000 17952/32000 (56%)] Loss: 0.43251 (QuantReg: 11.29649) QuantErr: 11.29649 batch_time=0.38631 
Train Epoch: 16 [566/1000 18112/32000 (57%)] Loss: 0.65755 (QuantReg: 11.82290) QuantErr: 11.82290 batch_time=0.40648 
Train Epoch: 16 [571/1000 18272/32000 (57%)] Loss: 0.55899 (QuantReg: 11.52266) QuantErr: 11.52266 batch_time=0.46478 
Train Epoch: 16 [576/1000 18432/32000 (58%)] Loss: 0.79474 (QuantReg: 12.38337) QuantErr: 12.38337 batch_time=0.38406 
Train Epoch: 16 [581/1000 18592/32000 (58%)] Loss: 0.49143 (QuantReg: 12.20407) QuantErr: 12.20407 batch_time=0.35967 
Train Epoch: 16 [586/1000 18752/32000 (59%)] Loss: 0.66831 (QuantReg: 11.56511) QuantErr: 11.56511 batch_time=0.38606 
Train Epoch: 16 [591/1000 18912/32000 (59%)] Loss: 0.50149 (QuantReg: 12.25034) QuantErr: 12.25034 batch_time=0.40627 
Train Epoch: 16 [596/1000 19072/32000 (60%)] Loss: 0.48765 (QuantReg: 12.39218) QuantErr: 12.39218 batch_time=0.40934 
Train Epoch: 16 [601/1000 19232/32000 (60%)] Loss: 0.73471 (QuantReg: 12.45315) QuantErr: 12.45315 batch_time=0.41873 
Train Epoch: 16 [606/1000 19392/32000 (61%)] Loss: 0.38753 (QuantReg: 12.92625) QuantErr: 12.92625 batch_time=0.34556 
Train Epoch: 16 [611/1000 19552/32000 (61%)] Loss: 0.34175 (QuantReg: 12.38926) QuantErr: 12.38926 batch_time=0.37348 
Train Epoch: 16 [616/1000 19712/32000 (62%)] Loss: 0.35471 (QuantReg: 12.61662) QuantErr: 12.61662 batch_time=0.36752 
Train Epoch: 16 [621/1000 19872/32000 (62%)] Loss: 0.77713 (QuantReg: 12.16367) QuantErr: 12.16367 batch_time=0.35784 
Train Epoch: 16 [626/1000 20032/32000 (63%)] Loss: 0.72180 (QuantReg: 11.91925) QuantErr: 11.91925 batch_time=0.39652 
Train Epoch: 16 [631/1000 20192/32000 (63%)] Loss: 0.32027 (QuantReg: 12.84139) QuantErr: 12.84139 batch_time=0.45013 
Train Epoch: 16 [636/1000 20352/32000 (64%)] Loss: 0.61811 (QuantReg: 12.21867) QuantErr: 12.21867 batch_time=0.46800 
Train Epoch: 16 [641/1000 20512/32000 (64%)] Loss: 0.79456 (QuantReg: 11.59640) QuantErr: 11.59640 batch_time=0.37941 
Train Epoch: 16 [646/1000 20672/32000 (65%)] Loss: 0.69087 (QuantReg: 12.43022) QuantErr: 12.43022 batch_time=0.37220 
Train Epoch: 16 [651/1000 20832/32000 (65%)] Loss: 0.42948 (QuantReg: 12.66299) QuantErr: 12.66299 batch_time=0.36954 
Train Epoch: 16 [656/1000 20992/32000 (66%)] Loss: 0.37444 (QuantReg: 13.07249) QuantErr: 13.07249 batch_time=0.37170 
Train Epoch: 16 [661/1000 21152/32000 (66%)] Loss: 0.37123 (QuantReg: 12.55808) QuantErr: 12.55808 batch_time=0.38785 
Train Epoch: 16 [666/1000 21312/32000 (67%)] Loss: 0.52323 (QuantReg: 12.64641) QuantErr: 12.64641 batch_time=0.38347 
Train Epoch: 16 [671/1000 21472/32000 (67%)] Loss: 1.11512 (QuantReg: 11.45833) QuantErr: 11.45833 batch_time=0.63731 
Train Epoch: 16 [676/1000 21632/32000 (68%)] Loss: 0.51209 (QuantReg: 12.11246) QuantErr: 12.11246 batch_time=0.39856 
Train Epoch: 16 [681/1000 21792/32000 (68%)] Loss: 0.48000 (QuantReg: 11.44033) QuantErr: 11.44033 batch_time=0.41374 
Train Epoch: 16 [686/1000 21952/32000 (69%)] Loss: 0.34688 (QuantReg: 11.98413) QuantErr: 11.98413 batch_time=0.43095 
Train Epoch: 16 [691/1000 22112/32000 (69%)] Loss: 0.28290 (QuantReg: 12.99238) QuantErr: 12.99238 batch_time=0.43102 
Train Epoch: 16 [696/1000 22272/32000 (70%)] Loss: 0.38495 (QuantReg: 12.09857) QuantErr: 12.09857 batch_time=0.44958 
Train Epoch: 16 [701/1000 22432/32000 (70%)] Loss: 0.25846 (QuantReg: 12.46285) QuantErr: 12.46285 batch_time=0.37425 
Train Epoch: 16 [706/1000 22592/32000 (71%)] Loss: 0.22566 (QuantReg: 11.59460) QuantErr: 11.59460 batch_time=0.59039 
Train Epoch: 16 [711/1000 22752/32000 (71%)] Loss: 0.71718 (QuantReg: 13.07743) QuantErr: 13.07743 batch_time=0.42673 
Train Epoch: 16 [716/1000 22912/32000 (72%)] Loss: 0.31913 (QuantReg: 12.51541) QuantErr: 12.51541 batch_time=0.41563 
Train Epoch: 16 [721/1000 23072/32000 (72%)] Loss: 0.28635 (QuantReg: 11.65114) QuantErr: 11.65114 batch_time=0.43308 
Train Epoch: 16 [726/1000 23232/32000 (73%)] Loss: 0.57632 (QuantReg: 12.82523) QuantErr: 12.82523 batch_time=0.42214 
Train Epoch: 16 [731/1000 23392/32000 (73%)] Loss: 0.62258 (QuantReg: 12.25010) QuantErr: 12.25010 batch_time=0.43168 
Train Epoch: 16 [736/1000 23552/32000 (74%)] Loss: 0.26448 (QuantReg: 12.02874) QuantErr: 12.02874 batch_time=0.39312 
Train Epoch: 16 [741/1000 23712/32000 (74%)] Loss: 0.56741 (QuantReg: 11.90380) QuantErr: 11.90380 batch_time=0.35948 
Train Epoch: 16 [746/1000 23872/32000 (75%)] Loss: 0.78098 (QuantReg: 12.32880) QuantErr: 12.32880 batch_time=0.34119 
Train Epoch: 16 [751/1000 24032/32000 (75%)] Loss: 0.44053 (QuantReg: 11.78310) QuantErr: 11.78310 batch_time=0.35987 
Train Epoch: 16 [756/1000 24192/32000 (76%)] Loss: 0.53416 (QuantReg: 12.28486) QuantErr: 12.28486 batch_time=0.34213 
Train Epoch: 16 [761/1000 24352/32000 (76%)] Loss: 0.56206 (QuantReg: 11.67348) QuantErr: 11.67348 batch_time=0.33669 
Train Epoch: 16 [766/1000 24512/32000 (77%)] Loss: 0.21741 (QuantReg: 12.23087) QuantErr: 12.23087 batch_time=0.34892 
Train Epoch: 16 [771/1000 24672/32000 (77%)] Loss: 0.19164 (QuantReg: 12.91232) QuantErr: 12.91232 batch_time=1.66528 
Train Epoch: 16 [776/1000 24832/32000 (78%)] Loss: 1.09125 (QuantReg: 12.90806) QuantErr: 12.90806 batch_time=0.36862 
Train Epoch: 16 [781/1000 24992/32000 (78%)] Loss: 0.43199 (QuantReg: 12.88826) QuantErr: 12.88826 batch_time=0.34312 
Train Epoch: 16 [786/1000 25152/32000 (79%)] Loss: 0.42491 (QuantReg: 12.04552) QuantErr: 12.04552 batch_time=0.45210 
Train Epoch: 16 [791/1000 25312/32000 (79%)] Loss: 0.71759 (QuantReg: 12.49075) QuantErr: 12.49075 batch_time=0.38103 
Train Epoch: 16 [796/1000 25472/32000 (80%)] Loss: 0.41156 (QuantReg: 13.10644) QuantErr: 13.10644 batch_time=0.40097 
Train Epoch: 16 [801/1000 25632/32000 (80%)] Loss: 0.58772 (QuantReg: 12.25913) QuantErr: 12.25913 batch_time=0.37050 
Train Epoch: 16 [806/1000 25792/32000 (81%)] Loss: 0.53988 (QuantReg: 12.91082) QuantErr: 12.91082 batch_time=0.41954 
Train Epoch: 16 [811/1000 25952/32000 (81%)] Loss: 0.21780 (QuantReg: 12.42688) QuantErr: 12.42688 batch_time=0.36801 
Train Epoch: 16 [816/1000 26112/32000 (82%)] Loss: 0.28580 (QuantReg: 12.34971) QuantErr: 12.34971 batch_time=0.40277 
Train Epoch: 16 [821/1000 26272/32000 (82%)] Loss: 0.81850 (QuantReg: 12.10725) QuantErr: 12.10725 batch_time=0.40117 
Train Epoch: 16 [826/1000 26432/32000 (83%)] Loss: 0.38885 (QuantReg: 12.16827) QuantErr: 12.16827 batch_time=0.40497 
Train Epoch: 16 [831/1000 26592/32000 (83%)] Loss: 1.26961 (QuantReg: 11.68085) QuantErr: 11.68085 batch_time=0.41271 
Train Epoch: 16 [836/1000 26752/32000 (84%)] Loss: 0.83796 (QuantReg: 12.12280) QuantErr: 12.12280 batch_time=0.43881 
Train Epoch: 16 [841/1000 26912/32000 (84%)] Loss: 0.63136 (QuantReg: 12.62963) QuantErr: 12.62963 batch_time=0.36155 
Train Epoch: 16 [846/1000 27072/32000 (85%)] Loss: 0.45602 (QuantReg: 12.09444) QuantErr: 12.09444 batch_time=0.40335 
Train Epoch: 16 [851/1000 27232/32000 (85%)] Loss: 0.37470 (QuantReg: 12.50093) QuantErr: 12.50093 batch_time=0.37491 
Train Epoch: 16 [856/1000 27392/32000 (86%)] Loss: 0.37371 (QuantReg: 12.63497) QuantErr: 12.63497 batch_time=0.39910 
Train Epoch: 16 [861/1000 27552/32000 (86%)] Loss: 0.46257 (QuantReg: 12.53932) QuantErr: 12.53932 batch_time=0.40910 
Train Epoch: 16 [866/1000 27712/32000 (87%)] Loss: 0.65000 (QuantReg: 11.80221) QuantErr: 11.80221 batch_time=0.40386 
Train Epoch: 16 [871/1000 27872/32000 (87%)] Loss: 0.41121 (QuantReg: 12.38833) QuantErr: 12.38833 batch_time=0.40884 
Train Epoch: 16 [876/1000 28032/32000 (88%)] Loss: 0.44751 (QuantReg: 12.21253) QuantErr: 12.21253 batch_time=0.37490 
Train Epoch: 16 [881/1000 28192/32000 (88%)] Loss: 0.25073 (QuantReg: 12.39851) QuantErr: 12.39851 batch_time=0.36636 
Train Epoch: 16 [886/1000 28352/32000 (89%)] Loss: 0.74169 (QuantReg: 11.53078) QuantErr: 11.53078 batch_time=0.46709 
Train Epoch: 16 [891/1000 28512/32000 (89%)] Loss: 0.42912 (QuantReg: 12.48455) QuantErr: 12.48455 batch_time=0.40649 
Train Epoch: 16 [896/1000 28672/32000 (90%)] Loss: 0.40195 (QuantReg: 12.19747) QuantErr: 12.19747 batch_time=0.38809 
Train Epoch: 16 [901/1000 28832/32000 (90%)] Loss: 0.20391 (QuantReg: 11.63026) QuantErr: 11.63026 batch_time=0.43690 
Train Epoch: 16 [906/1000 28992/32000 (91%)] Loss: 0.79513 (QuantReg: 11.64239) QuantErr: 11.64239 batch_time=0.36997 
Train Epoch: 16 [911/1000 29152/32000 (91%)] Loss: 0.45752 (QuantReg: 12.44547) QuantErr: 12.44547 batch_time=0.44533 
Train Epoch: 16 [916/1000 29312/32000 (92%)] Loss: 0.77122 (QuantReg: 12.88363) QuantErr: 12.88363 batch_time=0.38786 
Train Epoch: 16 [921/1000 29472/32000 (92%)] Loss: 0.37604 (QuantReg: 12.17333) QuantErr: 12.17333 batch_time=0.39243 
Train Epoch: 16 [926/1000 29632/32000 (93%)] Loss: 0.45780 (QuantReg: 12.29706) QuantErr: 12.29706 batch_time=0.40971 
Train Epoch: 16 [931/1000 29792/32000 (93%)] Loss: 0.79410 (QuantReg: 11.97749) QuantErr: 11.97749 batch_time=0.37384 
Train Epoch: 16 [936/1000 29952/32000 (94%)] Loss: 0.74443 (QuantReg: 11.95275) QuantErr: 11.95275 batch_time=0.34909 
Train Epoch: 16 [941/1000 30112/32000 (94%)] Loss: 0.87221 (QuantReg: 12.31059) QuantErr: 12.31059 batch_time=0.40934 
Train Epoch: 16 [946/1000 30272/32000 (95%)] Loss: 0.55023 (QuantReg: 12.55796) QuantErr: 12.55796 batch_time=0.40753 
Train Epoch: 16 [951/1000 30432/32000 (95%)] Loss: 0.40484 (QuantReg: 11.92322) QuantErr: 11.92322 batch_time=0.39655 
Train Epoch: 16 [956/1000 30592/32000 (96%)] Loss: 0.49006 (QuantReg: 12.44700) QuantErr: 12.44700 batch_time=0.52082 
Train Epoch: 16 [961/1000 30752/32000 (96%)] Loss: 0.15903 (QuantReg: 12.40777) QuantErr: 12.40777 batch_time=0.37356 
Train Epoch: 16 [966/1000 30912/32000 (97%)] Loss: 0.49526 (QuantReg: 12.24333) QuantErr: 12.24333 batch_time=0.45751 
Train Epoch: 16 [971/1000 31072/32000 (97%)] Loss: 0.66380 (QuantReg: 12.83166) QuantErr: 12.83166 batch_time=0.34562 
Train Epoch: 16 [976/1000 31232/32000 (98%)] Loss: 0.25464 (QuantReg: 12.58297) QuantErr: 12.58297 batch_time=0.35142 
Train Epoch: 16 [981/1000 31392/32000 (98%)] Loss: 0.44338 (QuantReg: 12.04986) QuantErr: 12.04986 batch_time=0.34887 
Train Epoch: 16 [986/1000 31552/32000 (99%)] Loss: 0.39153 (QuantReg: 12.71679) QuantErr: 12.71679 batch_time=0.34784 
Train Epoch: 16 [991/1000 31712/32000 (99%)] Loss: 1.35382 (QuantReg: 12.60086) QuantErr: 12.60086 batch_time=0.69695 
Train Epoch: 16 [996/1000 31872/32000 (100%)] Loss: 0.25591 (QuantReg: 12.31782) QuantErr: 12.31782 batch_time=0.34846 
Train Epoch: 16 codebook_update_time=1.75871
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch16.pth ...
Done in 4.305s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch16.pth ...
Done in 8.635s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 0.5346823801398277
 quant_reg      : 12.18483494567871
 quant_err      : 12.18483494567871
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 16000
 MSRVTT_full_val/t2v_metrics/R1: 29.175050301810867
 MSRVTT_full_val/t2v_metrics/R5: 63.78269617706238
 MSRVTT_full_val/t2v_metrics/R10: 77.66599597585513
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.583501006036217
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.47854687567554
 MSRVTT_full_val/v2t_metrics/R1: 34.40643863179074
 MSRVTT_full_val/v2t_metrics/R5: 72.43460764587525
 MSRVTT_full_val/v2t_metrics/R10: 84.30583501006036
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.885311871227364
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.449447477021444
 MSRVTT_full_test/t2v_metrics/R1: 10.836120401337793
 MSRVTT_full_test/t2v_metrics/R5: 33.01003344481605
 MSRVTT_full_test/t2v_metrics/R10: 46.38795986622073
 MSRVTT_full_test/t2v_metrics/R50: 79.63210702341136
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.279264214046826
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.5059607083484
 MSRVTT_full_test/v2t_metrics/R1: 13.010033444816054
 MSRVTT_full_test/v2t_metrics/R5: 38.39464882943144
 MSRVTT_full_test/v2t_metrics/R10: 52.541806020066886
 MSRVTT_full_test/v2t_metrics/R50: 85.38461538461539
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 36.17859531772575
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.717894491987433
 mnt_best       : 25.5059607083484
 not_improved_count: 0
Train Epoch: 17 [1/1000 32/32000 (0%)] Loss: 0.60509 (QuantReg: 11.53493) QuantErr: 11.53493 batch_time=29.39368 
Train Epoch: 17 [6/1000 192/32000 (1%)] Loss: 0.84905 (QuantReg: 11.07302) QuantErr: 11.07302 batch_time=0.35568 
Train Epoch: 17 [11/1000 352/32000 (1%)] Loss: 0.45750 (QuantReg: 11.75188) QuantErr: 11.75188 batch_time=0.43164 
Train Epoch: 17 [16/1000 512/32000 (2%)] Loss: 0.52727 (QuantReg: 11.90595) QuantErr: 11.90595 batch_time=0.36834 
Train Epoch: 17 [21/1000 672/32000 (2%)] Loss: 0.75379 (QuantReg: 12.60030) QuantErr: 12.60030 batch_time=0.40121 
Train Epoch: 17 [26/1000 832/32000 (3%)] Loss: 0.55500 (QuantReg: 12.07740) QuantErr: 12.07740 batch_time=0.36487 
Train Epoch: 17 [31/1000 992/32000 (3%)] Loss: 0.78648 (QuantReg: 11.56670) QuantErr: 11.56670 batch_time=0.66811 
Train Epoch: 17 [36/1000 1152/32000 (4%)] Loss: 0.24260 (QuantReg: 12.38988) QuantErr: 12.38988 batch_time=0.46051 
Train Epoch: 17 [41/1000 1312/32000 (4%)] Loss: 0.21615 (QuantReg: 11.80698) QuantErr: 11.80698 batch_time=0.41541 
Train Epoch: 17 [46/1000 1472/32000 (5%)] Loss: 1.10190 (QuantReg: 12.05474) QuantErr: 12.05474 batch_time=0.54081 
Train Epoch: 17 [51/1000 1632/32000 (5%)] Loss: 0.34453 (QuantReg: 12.45902) QuantErr: 12.45902 batch_time=0.36427 
Train Epoch: 17 [56/1000 1792/32000 (6%)] Loss: 0.55712 (QuantReg: 12.40762) QuantErr: 12.40762 batch_time=0.38197 
Train Epoch: 17 [61/1000 1952/32000 (6%)] Loss: 0.78405 (QuantReg: 12.05375) QuantErr: 12.05375 batch_time=0.36773 
Train Epoch: 17 [66/1000 2112/32000 (7%)] Loss: 0.38633 (QuantReg: 11.34675) QuantErr: 11.34675 batch_time=0.40094 
Train Epoch: 17 [71/1000 2272/32000 (7%)] Loss: 0.60271 (QuantReg: 12.23002) QuantErr: 12.23002 batch_time=0.37132 
Train Epoch: 17 [76/1000 2432/32000 (8%)] Loss: 0.51704 (QuantReg: 12.27773) QuantErr: 12.27773 batch_time=0.43494 
Train Epoch: 17 [81/1000 2592/32000 (8%)] Loss: 0.54117 (QuantReg: 11.82571) QuantErr: 11.82571 batch_time=0.39885 
Train Epoch: 17 [86/1000 2752/32000 (9%)] Loss: 0.65710 (QuantReg: 12.30488) QuantErr: 12.30488 batch_time=0.52128 
Train Epoch: 17 [91/1000 2912/32000 (9%)] Loss: 0.42917 (QuantReg: 11.93762) QuantErr: 11.93762 batch_time=0.41285 
Train Epoch: 17 [96/1000 3072/32000 (10%)] Loss: 0.26735 (QuantReg: 12.90640) QuantErr: 12.90640 batch_time=0.74541 
Train Epoch: 17 [101/1000 3232/32000 (10%)] Loss: 0.34110 (QuantReg: 12.01150) QuantErr: 12.01150 batch_time=0.40281 
Train Epoch: 17 [106/1000 3392/32000 (11%)] Loss: 0.65310 (QuantReg: 12.28607) QuantErr: 12.28607 batch_time=0.41353 
Train Epoch: 17 [111/1000 3552/32000 (11%)] Loss: 0.69043 (QuantReg: 12.12029) QuantErr: 12.12029 batch_time=0.36288 
Train Epoch: 17 [116/1000 3712/32000 (12%)] Loss: 0.48897 (QuantReg: 12.16427) QuantErr: 12.16427 batch_time=0.36475 
Train Epoch: 17 [121/1000 3872/32000 (12%)] Loss: 0.55293 (QuantReg: 11.27627) QuantErr: 11.27627 batch_time=0.37759 
Train Epoch: 17 [126/1000 4032/32000 (13%)] Loss: 0.30985 (QuantReg: 11.67047) QuantErr: 11.67047 batch_time=0.43141 
Train Epoch: 17 [131/1000 4192/32000 (13%)] Loss: 0.68681 (QuantReg: 11.73323) QuantErr: 11.73323 batch_time=0.39800 
Train Epoch: 17 [136/1000 4352/32000 (14%)] Loss: 0.65451 (QuantReg: 11.87621) QuantErr: 11.87621 batch_time=0.41047 
Train Epoch: 17 [141/1000 4512/32000 (14%)] Loss: 0.62798 (QuantReg: 11.49281) QuantErr: 11.49281 batch_time=0.39998 
Train Epoch: 17 [146/1000 4672/32000 (15%)] Loss: 0.28904 (QuantReg: 12.50295) QuantErr: 12.50295 batch_time=0.42903 
Train Epoch: 17 [151/1000 4832/32000 (15%)] Loss: 0.28443 (QuantReg: 12.66115) QuantErr: 12.66115 batch_time=0.45041 
Train Epoch: 17 [156/1000 4992/32000 (16%)] Loss: 0.28541 (QuantReg: 12.67393) QuantErr: 12.67393 batch_time=0.45005 
Train Epoch: 17 [161/1000 5152/32000 (16%)] Loss: 0.29544 (QuantReg: 12.22365) QuantErr: 12.22365 batch_time=0.45589 
Train Epoch: 17 [166/1000 5312/32000 (17%)] Loss: 0.52085 (QuantReg: 12.88651) QuantErr: 12.88651 batch_time=0.36019 
Train Epoch: 17 [171/1000 5472/32000 (17%)] Loss: 0.43990 (QuantReg: 12.34670) QuantErr: 12.34670 batch_time=0.38471 
Train Epoch: 17 [176/1000 5632/32000 (18%)] Loss: 0.26122 (QuantReg: 12.31447) QuantErr: 12.31447 batch_time=0.42171 
Train Epoch: 17 [181/1000 5792/32000 (18%)] Loss: 0.27900 (QuantReg: 12.19088) QuantErr: 12.19088 batch_time=0.35784 
Train Epoch: 17 [186/1000 5952/32000 (19%)] Loss: 0.38666 (QuantReg: 11.71086) QuantErr: 11.71086 batch_time=0.37181 
Train Epoch: 17 [191/1000 6112/32000 (19%)] Loss: 0.35724 (QuantReg: 12.11163) QuantErr: 12.11163 batch_time=0.38148 
Train Epoch: 17 [196/1000 6272/32000 (20%)] Loss: 0.55411 (QuantReg: 12.38012) QuantErr: 12.38012 batch_time=0.73809 
Train Epoch: 17 [201/1000 6432/32000 (20%)] Loss: 0.33201 (QuantReg: 12.14423) QuantErr: 12.14423 batch_time=0.37330 
Train Epoch: 17 [206/1000 6592/32000 (21%)] Loss: 0.79520 (QuantReg: 11.78728) QuantErr: 11.78728 batch_time=0.38877 
Train Epoch: 17 [211/1000 6752/32000 (21%)] Loss: 1.15260 (QuantReg: 11.85158) QuantErr: 11.85158 batch_time=0.41224 
Train Epoch: 17 [216/1000 6912/32000 (22%)] Loss: 0.65689 (QuantReg: 12.32012) QuantErr: 12.32012 batch_time=0.34270 
Train Epoch: 17 [221/1000 7072/32000 (22%)] Loss: 0.27045 (QuantReg: 11.95431) QuantErr: 11.95431 batch_time=0.41392 
Train Epoch: 17 [226/1000 7232/32000 (23%)] Loss: 0.31150 (QuantReg: 11.76109) QuantErr: 11.76109 batch_time=0.36054 
Train Epoch: 17 [231/1000 7392/32000 (23%)] Loss: 0.34531 (QuantReg: 12.05605) QuantErr: 12.05605 batch_time=0.39745 
Train Epoch: 17 [236/1000 7552/32000 (24%)] Loss: 0.45882 (QuantReg: 12.34724) QuantErr: 12.34724 batch_time=0.36274 
Train Epoch: 17 [241/1000 7712/32000 (24%)] Loss: 0.54203 (QuantReg: 12.67635) QuantErr: 12.67635 batch_time=0.43653 
Train Epoch: 17 [246/1000 7872/32000 (25%)] Loss: 0.47473 (QuantReg: 11.55278) QuantErr: 11.55278 batch_time=0.41675 
Train Epoch: 17 [251/1000 8032/32000 (25%)] Loss: 0.94132 (QuantReg: 11.36605) QuantErr: 11.36605 batch_time=0.35582 
Train Epoch: 17 [256/1000 8192/32000 (26%)] Loss: 0.56673 (QuantReg: 11.52593) QuantErr: 11.52593 batch_time=0.37304 
Train Epoch: 17 [261/1000 8352/32000 (26%)] Loss: 0.48849 (QuantReg: 11.97081) QuantErr: 11.97081 batch_time=0.34409 
Train Epoch: 17 [266/1000 8512/32000 (27%)] Loss: 0.57596 (QuantReg: 12.29977) QuantErr: 12.29977 batch_time=0.34900 
Train Epoch: 17 [271/1000 8672/32000 (27%)] Loss: 0.34440 (QuantReg: 11.99809) QuantErr: 11.99809 batch_time=0.35743 
Train Epoch: 17 [276/1000 8832/32000 (28%)] Loss: 0.57355 (QuantReg: 12.27445) QuantErr: 12.27445 batch_time=0.36578 
Train Epoch: 17 [281/1000 8992/32000 (28%)] Loss: 0.53398 (QuantReg: 11.83200) QuantErr: 11.83200 batch_time=1.75581 
Train Epoch: 17 [286/1000 9152/32000 (29%)] Loss: 0.70926 (QuantReg: 11.95788) QuantErr: 11.95788 batch_time=0.35530 
Train Epoch: 17 [291/1000 9312/32000 (29%)] Loss: 0.42355 (QuantReg: 11.90223) QuantErr: 11.90223 batch_time=0.35937 
Train Epoch: 17 [296/1000 9472/32000 (30%)] Loss: 0.41548 (QuantReg: 11.75298) QuantErr: 11.75298 batch_time=0.35743 
Train Epoch: 17 [301/1000 9632/32000 (30%)] Loss: 0.67210 (QuantReg: 12.65988) QuantErr: 12.65988 batch_time=0.36551 
Train Epoch: 17 [306/1000 9792/32000 (31%)] Loss: 0.57880 (QuantReg: 11.54401) QuantErr: 11.54401 batch_time=0.36795 
Train Epoch: 17 [311/1000 9952/32000 (31%)] Loss: 0.43606 (QuantReg: 11.77122) QuantErr: 11.77122 batch_time=0.38496 
Train Epoch: 17 [316/1000 10112/32000 (32%)] Loss: 0.34995 (QuantReg: 12.79991) QuantErr: 12.79991 batch_time=0.39946 
Train Epoch: 17 [321/1000 10272/32000 (32%)] Loss: 0.44363 (QuantReg: 12.08015) QuantErr: 12.08015 batch_time=0.38930 
Train Epoch: 17 [326/1000 10432/32000 (33%)] Loss: 0.51955 (QuantReg: 12.14846) QuantErr: 12.14846 batch_time=0.35360 
Train Epoch: 17 [331/1000 10592/32000 (33%)] Loss: 0.62671 (QuantReg: 12.08734) QuantErr: 12.08734 batch_time=0.42616 
Train Epoch: 17 [336/1000 10752/32000 (34%)] Loss: 0.56334 (QuantReg: 12.39337) QuantErr: 12.39337 batch_time=0.35197 
Train Epoch: 17 [341/1000 10912/32000 (34%)] Loss: 0.52779 (QuantReg: 11.08101) QuantErr: 11.08101 batch_time=0.38072 
Train Epoch: 17 [346/1000 11072/32000 (35%)] Loss: 0.76297 (QuantReg: 12.03469) QuantErr: 12.03469 batch_time=0.36838 
Train Epoch: 17 [351/1000 11232/32000 (35%)] Loss: 0.83422 (QuantReg: 12.25349) QuantErr: 12.25349 batch_time=0.40503 
Train Epoch: 17 [356/1000 11392/32000 (36%)] Loss: 0.72480 (QuantReg: 13.03149) QuantErr: 13.03149 batch_time=0.40691 
Train Epoch: 17 [361/1000 11552/32000 (36%)] Loss: 0.68026 (QuantReg: 11.46783) QuantErr: 11.46783 batch_time=0.39705 
Train Epoch: 17 [366/1000 11712/32000 (37%)] Loss: 0.39655 (QuantReg: 12.42997) QuantErr: 12.42997 batch_time=0.35769 
Train Epoch: 17 [371/1000 11872/32000 (37%)] Loss: 0.86493 (QuantReg: 12.06335) QuantErr: 12.06335 batch_time=0.39052 
Train Epoch: 17 [376/1000 12032/32000 (38%)] Loss: 0.61292 (QuantReg: 12.33697) QuantErr: 12.33697 batch_time=0.43583 
Train Epoch: 17 [381/1000 12192/32000 (38%)] Loss: 0.88944 (QuantReg: 11.86796) QuantErr: 11.86796 batch_time=0.45439 
Train Epoch: 17 [386/1000 12352/32000 (39%)] Loss: 0.92513 (QuantReg: 11.89524) QuantErr: 11.89524 batch_time=0.37421 
Train Epoch: 17 [391/1000 12512/32000 (39%)] Loss: 0.30530 (QuantReg: 11.93614) QuantErr: 11.93614 batch_time=0.40803 
Train Epoch: 17 [396/1000 12672/32000 (40%)] Loss: 0.33531 (QuantReg: 12.13583) QuantErr: 12.13583 batch_time=0.35370 
Train Epoch: 17 [401/1000 12832/32000 (40%)] Loss: 0.33322 (QuantReg: 12.07458) QuantErr: 12.07458 batch_time=0.39269 
Train Epoch: 17 [406/1000 12992/32000 (41%)] Loss: 0.53563 (QuantReg: 11.96137) QuantErr: 11.96137 batch_time=0.56946 
Train Epoch: 17 [411/1000 13152/32000 (41%)] Loss: 0.36608 (QuantReg: 11.67812) QuantErr: 11.67812 batch_time=0.36806 
Train Epoch: 17 [416/1000 13312/32000 (42%)] Loss: 0.66142 (QuantReg: 11.68902) QuantErr: 11.68902 batch_time=0.44855 
Train Epoch: 17 [421/1000 13472/32000 (42%)] Loss: 0.80859 (QuantReg: 12.26370) QuantErr: 12.26370 batch_time=0.36368 
Train Epoch: 17 [426/1000 13632/32000 (43%)] Loss: 1.10255 (QuantReg: 12.12925) QuantErr: 12.12925 batch_time=0.37332 
Train Epoch: 17 [431/1000 13792/32000 (43%)] Loss: 0.62584 (QuantReg: 11.94877) QuantErr: 11.94877 batch_time=0.41527 
Train Epoch: 17 [436/1000 13952/32000 (44%)] Loss: 0.48920 (QuantReg: 11.93171) QuantErr: 11.93171 batch_time=0.39937 
Train Epoch: 17 [441/1000 14112/32000 (44%)] Loss: 0.40651 (QuantReg: 11.73680) QuantErr: 11.73680 batch_time=0.40771 
Train Epoch: 17 [446/1000 14272/32000 (45%)] Loss: 0.39679 (QuantReg: 11.94855) QuantErr: 11.94855 batch_time=0.34326 
Train Epoch: 17 [451/1000 14432/32000 (45%)] Loss: 0.28643 (QuantReg: 12.10162) QuantErr: 12.10162 batch_time=0.45412 
Train Epoch: 17 [456/1000 14592/32000 (46%)] Loss: 0.56225 (QuantReg: 11.66770) QuantErr: 11.66770 batch_time=0.39596 
Train Epoch: 17 [461/1000 14752/32000 (46%)] Loss: 0.47647 (QuantReg: 12.89374) QuantErr: 12.89374 batch_time=0.37764 
Train Epoch: 17 [466/1000 14912/32000 (47%)] Loss: 0.42660 (QuantReg: 12.16442) QuantErr: 12.16442 batch_time=0.36594 
Train Epoch: 17 [471/1000 15072/32000 (47%)] Loss: 0.34713 (QuantReg: 12.09173) QuantErr: 12.09173 batch_time=0.40715 
Train Epoch: 17 [476/1000 15232/32000 (48%)] Loss: 0.52186 (QuantReg: 11.90589) QuantErr: 11.90589 batch_time=0.36384 
Train Epoch: 17 [481/1000 15392/32000 (48%)] Loss: 0.19262 (QuantReg: 12.74736) QuantErr: 12.74736 batch_time=0.35733 
Train Epoch: 17 [486/1000 15552/32000 (49%)] Loss: 0.70921 (QuantReg: 12.48903) QuantErr: 12.48903 batch_time=0.37680 
Train Epoch: 17 [491/1000 15712/32000 (49%)] Loss: 0.15902 (QuantReg: 12.54584) QuantErr: 12.54584 batch_time=0.39652 
Train Epoch: 17 [496/1000 15872/32000 (50%)] Loss: 0.38418 (QuantReg: 12.16763) QuantErr: 12.16763 batch_time=0.40196 
Train Epoch: 17 [501/1000 16032/32000 (50%)] Loss: 0.56468 (QuantReg: 12.50727) QuantErr: 12.50727 batch_time=0.38262 
Train Epoch: 17 [506/1000 16192/32000 (51%)] Loss: 0.42171 (QuantReg: 11.92551) QuantErr: 11.92551 batch_time=0.45112 
Train Epoch: 17 [511/1000 16352/32000 (51%)] Loss: 0.77324 (QuantReg: 12.13032) QuantErr: 12.13032 batch_time=0.40740 
Train Epoch: 17 [516/1000 16512/32000 (52%)] Loss: 0.32591 (QuantReg: 12.30723) QuantErr: 12.30723 batch_time=0.81181 
Train Epoch: 17 [521/1000 16672/32000 (52%)] Loss: 0.27563 (QuantReg: 12.37768) QuantErr: 12.37768 batch_time=0.35526 
Train Epoch: 17 [526/1000 16832/32000 (53%)] Loss: 0.57088 (QuantReg: 12.04519) QuantErr: 12.04519 batch_time=0.36075 
Train Epoch: 17 [531/1000 16992/32000 (53%)] Loss: 0.59812 (QuantReg: 12.04792) QuantErr: 12.04792 batch_time=0.34977 
Train Epoch: 17 [536/1000 17152/32000 (54%)] Loss: 0.54397 (QuantReg: 11.66605) QuantErr: 11.66605 batch_time=0.36919 
Train Epoch: 17 [541/1000 17312/32000 (54%)] Loss: 0.26682 (QuantReg: 12.02775) QuantErr: 12.02775 batch_time=0.42192 
Train Epoch: 17 [546/1000 17472/32000 (55%)] Loss: 0.52743 (QuantReg: 12.04096) QuantErr: 12.04096 batch_time=0.40336 
Train Epoch: 17 [551/1000 17632/32000 (55%)] Loss: 0.37537 (QuantReg: 11.94628) QuantErr: 11.94628 batch_time=0.38746 
Train Epoch: 17 [556/1000 17792/32000 (56%)] Loss: 0.33378 (QuantReg: 12.17733) QuantErr: 12.17733 batch_time=0.37364 
Train Epoch: 17 [561/1000 17952/32000 (56%)] Loss: 0.67629 (QuantReg: 12.08725) QuantErr: 12.08725 batch_time=0.42247 
Train Epoch: 17 [566/1000 18112/32000 (57%)] Loss: 0.34729 (QuantReg: 12.81625) QuantErr: 12.81625 batch_time=0.36468 
Train Epoch: 17 [571/1000 18272/32000 (57%)] Loss: 0.59367 (QuantReg: 11.86524) QuantErr: 11.86524 batch_time=0.36155 
Train Epoch: 17 [576/1000 18432/32000 (58%)] Loss: 0.57534 (QuantReg: 12.82638) QuantErr: 12.82638 batch_time=0.44052 
Train Epoch: 17 [581/1000 18592/32000 (58%)] Loss: 0.36630 (QuantReg: 12.08036) QuantErr: 12.08036 batch_time=0.43133 
Train Epoch: 17 [586/1000 18752/32000 (59%)] Loss: 0.36793 (QuantReg: 12.45434) QuantErr: 12.45434 batch_time=0.41241 
Train Epoch: 17 [591/1000 18912/32000 (59%)] Loss: 0.34452 (QuantReg: 13.26559) QuantErr: 13.26559 batch_time=0.36587 
Train Epoch: 17 [596/1000 19072/32000 (60%)] Loss: 0.49022 (QuantReg: 12.59289) QuantErr: 12.59289 batch_time=0.35101 
Train Epoch: 17 [601/1000 19232/32000 (60%)] Loss: 0.21666 (QuantReg: 12.09824) QuantErr: 12.09824 batch_time=1.69215 
Train Epoch: 17 [606/1000 19392/32000 (61%)] Loss: 0.79208 (QuantReg: 12.06097) QuantErr: 12.06097 batch_time=0.34360 
Train Epoch: 17 [611/1000 19552/32000 (61%)] Loss: 0.83966 (QuantReg: 12.07759) QuantErr: 12.07759 batch_time=0.34787 
Train Epoch: 17 [616/1000 19712/32000 (62%)] Loss: 0.31575 (QuantReg: 12.28023) QuantErr: 12.28023 batch_time=0.35799 
Train Epoch: 17 [621/1000 19872/32000 (62%)] Loss: 0.40920 (QuantReg: 12.16616) QuantErr: 12.16616 batch_time=0.39488 
Train Epoch: 17 [626/1000 20032/32000 (63%)] Loss: 0.31067 (QuantReg: 12.75754) QuantErr: 12.75754 batch_time=0.40292 
Train Epoch: 17 [631/1000 20192/32000 (63%)] Loss: 0.28147 (QuantReg: 12.45537) QuantErr: 12.45537 batch_time=0.41248 
Train Epoch: 17 [636/1000 20352/32000 (64%)] Loss: 0.33941 (QuantReg: 12.68360) QuantErr: 12.68360 batch_time=0.43418 
Train Epoch: 17 [641/1000 20512/32000 (64%)] Loss: 0.77082 (QuantReg: 12.54423) QuantErr: 12.54423 batch_time=0.37005 
Train Epoch: 17 [646/1000 20672/32000 (65%)] Loss: 0.79904 (QuantReg: 12.19639) QuantErr: 12.19639 batch_time=0.42744 
Train Epoch: 17 [651/1000 20832/32000 (65%)] Loss: 0.34838 (QuantReg: 11.87685) QuantErr: 11.87685 batch_time=0.42406 
Train Epoch: 17 [656/1000 20992/32000 (66%)] Loss: 0.34698 (QuantReg: 11.84715) QuantErr: 11.84715 batch_time=0.39616 
Train Epoch: 17 [661/1000 21152/32000 (66%)] Loss: 0.76016 (QuantReg: 11.33410) QuantErr: 11.33410 batch_time=0.50299 
Train Epoch: 17 [666/1000 21312/32000 (67%)] Loss: 0.55237 (QuantReg: 12.58595) QuantErr: 12.58595 batch_time=0.36715 
Train Epoch: 17 [671/1000 21472/32000 (67%)] Loss: 0.97526 (QuantReg: 11.84240) QuantErr: 11.84240 batch_time=0.35107 
Train Epoch: 17 [676/1000 21632/32000 (68%)] Loss: 0.53796 (QuantReg: 12.02493) QuantErr: 12.02493 batch_time=0.34955 
Train Epoch: 17 [681/1000 21792/32000 (68%)] Loss: 0.77948 (QuantReg: 12.36897) QuantErr: 12.36897 batch_time=0.34975 
Train Epoch: 17 [686/1000 21952/32000 (69%)] Loss: 0.85018 (QuantReg: 13.33470) QuantErr: 13.33470 batch_time=0.34834 
Train Epoch: 17 [691/1000 22112/32000 (69%)] Loss: 0.66202 (QuantReg: 12.82999) QuantErr: 12.82999 batch_time=0.34685 
Train Epoch: 17 [696/1000 22272/32000 (70%)] Loss: 0.36577 (QuantReg: 12.72701) QuantErr: 12.72701 batch_time=0.34870 
Train Epoch: 17 [701/1000 22432/32000 (70%)] Loss: 0.41569 (QuantReg: 11.97933) QuantErr: 11.97933 batch_time=0.35241 
Train Epoch: 17 [706/1000 22592/32000 (71%)] Loss: 0.51533 (QuantReg: 12.42557) QuantErr: 12.42557 batch_time=0.34527 
Train Epoch: 17 [711/1000 22752/32000 (71%)] Loss: 0.80477 (QuantReg: 12.06432) QuantErr: 12.06432 batch_time=0.35119 
Train Epoch: 17 [716/1000 22912/32000 (72%)] Loss: 0.51740 (QuantReg: 12.91303) QuantErr: 12.91303 batch_time=0.34949 
Train Epoch: 17 [721/1000 23072/32000 (72%)] Loss: 0.67463 (QuantReg: 12.60263) QuantErr: 12.60263 batch_time=0.34810 
Train Epoch: 17 [726/1000 23232/32000 (73%)] Loss: 0.23750 (QuantReg: 12.59356) QuantErr: 12.59356 batch_time=0.50246 
Train Epoch: 17 [731/1000 23392/32000 (73%)] Loss: 0.35629 (QuantReg: 12.03519) QuantErr: 12.03519 batch_time=0.34823 
Train Epoch: 17 [736/1000 23552/32000 (74%)] Loss: 0.87379 (QuantReg: 12.28552) QuantErr: 12.28552 batch_time=0.34855 
Train Epoch: 17 [741/1000 23712/32000 (74%)] Loss: 0.64256 (QuantReg: 11.55114) QuantErr: 11.55114 batch_time=0.36071 
Train Epoch: 17 [746/1000 23872/32000 (75%)] Loss: 0.41831 (QuantReg: 11.75264) QuantErr: 11.75264 batch_time=0.34290 
Train Epoch: 17 [751/1000 24032/32000 (75%)] Loss: 0.62961 (QuantReg: 12.74986) QuantErr: 12.74986 batch_time=0.35928 
Train Epoch: 17 [756/1000 24192/32000 (76%)] Loss: 0.44027 (QuantReg: 11.95391) QuantErr: 11.95391 batch_time=0.34590 
Train Epoch: 17 [761/1000 24352/32000 (76%)] Loss: 0.71257 (QuantReg: 11.68229) QuantErr: 11.68229 batch_time=0.34522 
Train Epoch: 17 [766/1000 24512/32000 (77%)] Loss: 0.25399 (QuantReg: 12.52522) QuantErr: 12.52522 batch_time=0.34678 
Train Epoch: 17 [771/1000 24672/32000 (77%)] Loss: 0.41045 (QuantReg: 12.62807) QuantErr: 12.62807 batch_time=0.34930 
Train Epoch: 17 [776/1000 24832/32000 (78%)] Loss: 0.83454 (QuantReg: 12.06093) QuantErr: 12.06093 batch_time=0.36114 
Train Epoch: 17 [781/1000 24992/32000 (78%)] Loss: 1.15275 (QuantReg: 12.85280) QuantErr: 12.85280 batch_time=0.36220 
Train Epoch: 17 [786/1000 25152/32000 (79%)] Loss: 0.15905 (QuantReg: 12.88974) QuantErr: 12.88974 batch_time=0.38679 
Train Epoch: 17 [791/1000 25312/32000 (79%)] Loss: 0.75131 (QuantReg: 12.57816) QuantErr: 12.57816 batch_time=0.36786 
Train Epoch: 17 [796/1000 25472/32000 (80%)] Loss: 0.52113 (QuantReg: 12.61868) QuantErr: 12.61868 batch_time=0.36825 
Train Epoch: 17 [801/1000 25632/32000 (80%)] Loss: 0.43995 (QuantReg: 12.58551) QuantErr: 12.58551 batch_time=0.38363 
Train Epoch: 17 [806/1000 25792/32000 (81%)] Loss: 0.31862 (QuantReg: 12.45325) QuantErr: 12.45325 batch_time=0.37275 
Train Epoch: 17 [811/1000 25952/32000 (81%)] Loss: 0.42246 (QuantReg: 12.37840) QuantErr: 12.37840 batch_time=0.38287 
Train Epoch: 17 [816/1000 26112/32000 (82%)] Loss: 0.64133 (QuantReg: 12.77930) QuantErr: 12.77930 batch_time=0.39875 
Train Epoch: 17 [821/1000 26272/32000 (82%)] Loss: 0.29139 (QuantReg: 11.96907) QuantErr: 11.96907 batch_time=0.40168 
Train Epoch: 17 [826/1000 26432/32000 (83%)] Loss: 0.43846 (QuantReg: 13.35576) QuantErr: 13.35576 batch_time=0.37542 
Train Epoch: 17 [831/1000 26592/32000 (83%)] Loss: 0.78618 (QuantReg: 11.28331) QuantErr: 11.28331 batch_time=0.35663 
Train Epoch: 17 [836/1000 26752/32000 (84%)] Loss: 0.39898 (QuantReg: 12.48974) QuantErr: 12.48974 batch_time=0.76909 
Train Epoch: 17 [841/1000 26912/32000 (84%)] Loss: 0.27894 (QuantReg: 13.17654) QuantErr: 13.17654 batch_time=0.35844 
Train Epoch: 17 [846/1000 27072/32000 (85%)] Loss: 0.38148 (QuantReg: 11.88336) QuantErr: 11.88336 batch_time=0.39460 
Train Epoch: 17 [851/1000 27232/32000 (85%)] Loss: 0.33947 (QuantReg: 11.54333) QuantErr: 11.54333 batch_time=0.35145 
Train Epoch: 17 [856/1000 27392/32000 (86%)] Loss: 0.40858 (QuantReg: 12.31695) QuantErr: 12.31695 batch_time=0.34993 
Train Epoch: 17 [861/1000 27552/32000 (86%)] Loss: 0.84589 (QuantReg: 11.76301) QuantErr: 11.76301 batch_time=0.35107 
Train Epoch: 17 [866/1000 27712/32000 (87%)] Loss: 0.80533 (QuantReg: 12.47214) QuantErr: 12.47214 batch_time=0.34982 
Train Epoch: 17 [871/1000 27872/32000 (87%)] Loss: 0.32413 (QuantReg: 12.05653) QuantErr: 12.05653 batch_time=0.37897 
Train Epoch: 17 [876/1000 28032/32000 (88%)] Loss: 0.53076 (QuantReg: 12.84432) QuantErr: 12.84432 batch_time=0.35048 
Train Epoch: 17 [881/1000 28192/32000 (88%)] Loss: 0.46389 (QuantReg: 12.27678) QuantErr: 12.27678 batch_time=0.41465 
Train Epoch: 17 [886/1000 28352/32000 (89%)] Loss: 0.49235 (QuantReg: 12.69970) QuantErr: 12.69970 batch_time=0.37090 
Train Epoch: 17 [891/1000 28512/32000 (89%)] Loss: 0.40467 (QuantReg: 12.37449) QuantErr: 12.37449 batch_time=0.41477 
Train Epoch: 17 [896/1000 28672/32000 (90%)] Loss: 0.35425 (QuantReg: 12.25912) QuantErr: 12.25912 batch_time=0.38160 
Train Epoch: 17 [901/1000 28832/32000 (90%)] Loss: 0.30155 (QuantReg: 11.76138) QuantErr: 11.76138 batch_time=0.34042 
Train Epoch: 17 [906/1000 28992/32000 (91%)] Loss: 0.79378 (QuantReg: 12.70555) QuantErr: 12.70555 batch_time=0.39035 
Train Epoch: 17 [911/1000 29152/32000 (91%)] Loss: 0.28543 (QuantReg: 12.33963) QuantErr: 12.33963 batch_time=0.33752 
Train Epoch: 17 [916/1000 29312/32000 (92%)] Loss: 0.42090 (QuantReg: 11.82551) QuantErr: 11.82551 batch_time=0.34402 
Train Epoch: 17 [921/1000 29472/32000 (92%)] Loss: 0.45388 (QuantReg: 12.17336) QuantErr: 12.17336 batch_time=1.84605 
Train Epoch: 17 [926/1000 29632/32000 (93%)] Loss: 0.56579 (QuantReg: 12.44380) QuantErr: 12.44380 batch_time=0.34034 
Train Epoch: 17 [931/1000 29792/32000 (93%)] Loss: 0.82313 (QuantReg: 12.45199) QuantErr: 12.45199 batch_time=0.36858 
Train Epoch: 17 [936/1000 29952/32000 (94%)] Loss: 0.45208 (QuantReg: 12.75833) QuantErr: 12.75833 batch_time=0.35286 
Train Epoch: 17 [941/1000 30112/32000 (94%)] Loss: 0.82105 (QuantReg: 12.47825) QuantErr: 12.47825 batch_time=0.35390 
Train Epoch: 17 [946/1000 30272/32000 (95%)] Loss: 0.26975 (QuantReg: 12.20677) QuantErr: 12.20677 batch_time=0.37419 
Train Epoch: 17 [951/1000 30432/32000 (95%)] Loss: 0.52437 (QuantReg: 12.34844) QuantErr: 12.34844 batch_time=0.39908 
Train Epoch: 17 [956/1000 30592/32000 (96%)] Loss: 0.27739 (QuantReg: 12.69532) QuantErr: 12.69532 batch_time=0.44826 
Train Epoch: 17 [961/1000 30752/32000 (96%)] Loss: 0.17085 (QuantReg: 12.24085) QuantErr: 12.24085 batch_time=0.38422 
Train Epoch: 17 [966/1000 30912/32000 (97%)] Loss: 0.41722 (QuantReg: 12.27708) QuantErr: 12.27708 batch_time=0.35418 
Train Epoch: 17 [971/1000 31072/32000 (97%)] Loss: 0.61257 (QuantReg: 12.31100) QuantErr: 12.31100 batch_time=0.34873 
Train Epoch: 17 [976/1000 31232/32000 (98%)] Loss: 0.41866 (QuantReg: 12.63059) QuantErr: 12.63059 batch_time=0.35825 
Train Epoch: 17 [981/1000 31392/32000 (98%)] Loss: 0.62578 (QuantReg: 12.39982) QuantErr: 12.39982 batch_time=0.40147 
Train Epoch: 17 [986/1000 31552/32000 (99%)] Loss: 0.37862 (QuantReg: 12.10478) QuantErr: 12.10478 batch_time=0.35189 
Train Epoch: 17 [991/1000 31712/32000 (99%)] Loss: 0.66103 (QuantReg: 12.69280) QuantErr: 12.69280 batch_time=0.34862 
Train Epoch: 17 [996/1000 31872/32000 (100%)] Loss: 0.37970 (QuantReg: 12.56234) QuantErr: 12.56234 batch_time=0.35070 
Train Epoch: 17 codebook_update_time=1.81321
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch17.pth ...
Done in 21.092s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch17.pth ...
Done in 25.419s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 0.5149562222957611
 quant_reg      : 12.207388343811035
 quant_err      : 12.207388343811035
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 17000
 MSRVTT_full_val/t2v_metrics/R1: 28.973843058350102
 MSRVTT_full_val/t2v_metrics/R5: 64.78873239436619
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.517102615694165
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.99258923553192
 MSRVTT_full_val/v2t_metrics/R1: 32.19315895372233
 MSRVTT_full_val/v2t_metrics/R5: 72.43460764587525
 MSRVTT_full_val/v2t_metrics/R10: 83.5010060362173
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.5392354124748495
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.96072439308169
 MSRVTT_full_test/t2v_metrics/R1: 11.471571906354516
 MSRVTT_full_test/t2v_metrics/R5: 32.876254180602004
 MSRVTT_full_test/t2v_metrics/R10: 46.92307692307692
 MSRVTT_full_test/t2v_metrics/R50: 79.59866220735786
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.37926421404682
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.059370147275818
 MSRVTT_full_test/v2t_metrics/R1: 13.7123745819398
 MSRVTT_full_test/v2t_metrics/R5: 38.2943143812709
 MSRVTT_full_test/v2t_metrics/R10: 53.1438127090301
 MSRVTT_full_test/v2t_metrics/R50: 84.11371237458194
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.667892976588625
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.331919301997477
 mnt_best       : 26.059370147275818
 not_improved_count: 0
Train Epoch: 18 [1/1000 32/32000 (0%)] Loss: 1.26781 (QuantReg: 11.50752) QuantErr: 11.50752 batch_time=28.06519 
Train Epoch: 18 [6/1000 192/32000 (1%)] Loss: 0.19176 (QuantReg: 12.24808) QuantErr: 12.24808 batch_time=0.43342 
Train Epoch: 18 [11/1000 352/32000 (1%)] Loss: 0.82938 (QuantReg: 11.75413) QuantErr: 11.75413 batch_time=0.36324 
Train Epoch: 18 [16/1000 512/32000 (2%)] Loss: 0.37552 (QuantReg: 12.50358) QuantErr: 12.50358 batch_time=0.93855 
Train Epoch: 18 [21/1000 672/32000 (2%)] Loss: 0.34092 (QuantReg: 12.49245) QuantErr: 12.49245 batch_time=0.34202 
Train Epoch: 18 [26/1000 832/32000 (3%)] Loss: 0.57054 (QuantReg: 12.10691) QuantErr: 12.10691 batch_time=0.35277 
Train Epoch: 18 [31/1000 992/32000 (3%)] Loss: 0.42484 (QuantReg: 12.16870) QuantErr: 12.16870 batch_time=0.36589 
Train Epoch: 18 [36/1000 1152/32000 (4%)] Loss: 0.46479 (QuantReg: 11.95915) QuantErr: 11.95915 batch_time=0.34827 
Train Epoch: 18 [41/1000 1312/32000 (4%)] Loss: 0.36898 (QuantReg: 11.73843) QuantErr: 11.73843 batch_time=0.64620 
Train Epoch: 18 [46/1000 1472/32000 (5%)] Loss: 0.34306 (QuantReg: 12.52972) QuantErr: 12.52972 batch_time=0.37936 
Train Epoch: 18 [51/1000 1632/32000 (5%)] Loss: 0.53395 (QuantReg: 11.92338) QuantErr: 11.92338 batch_time=0.36641 
Train Epoch: 18 [56/1000 1792/32000 (6%)] Loss: 0.79371 (QuantReg: 12.52326) QuantErr: 12.52326 batch_time=0.35890 
Train Epoch: 18 [61/1000 1952/32000 (6%)] Loss: 0.63596 (QuantReg: 11.67740) QuantErr: 11.67740 batch_time=0.38968 
Train Epoch: 18 [66/1000 2112/32000 (7%)] Loss: 0.87934 (QuantReg: 12.26447) QuantErr: 12.26447 batch_time=0.53256 
Train Epoch: 18 [71/1000 2272/32000 (7%)] Loss: 0.27194 (QuantReg: 11.97143) QuantErr: 11.97143 batch_time=0.48169 
Train Epoch: 18 [76/1000 2432/32000 (8%)] Loss: 0.54691 (QuantReg: 12.10808) QuantErr: 12.10808 batch_time=0.37373 
Train Epoch: 18 [81/1000 2592/32000 (8%)] Loss: 1.11469 (QuantReg: 11.64657) QuantErr: 11.64657 batch_time=0.77827 
Train Epoch: 18 [86/1000 2752/32000 (9%)] Loss: 0.45015 (QuantReg: 12.37551) QuantErr: 12.37551 batch_time=0.34666 
Train Epoch: 18 [91/1000 2912/32000 (9%)] Loss: 0.50777 (QuantReg: 12.30385) QuantErr: 12.30385 batch_time=0.35090 
Train Epoch: 18 [96/1000 3072/32000 (10%)] Loss: 0.67304 (QuantReg: 11.69360) QuantErr: 11.69360 batch_time=0.40398 
Train Epoch: 18 [101/1000 3232/32000 (10%)] Loss: 0.45638 (QuantReg: 12.91616) QuantErr: 12.91616 batch_time=0.35653 
Train Epoch: 18 [106/1000 3392/32000 (11%)] Loss: 0.46875 (QuantReg: 12.24135) QuantErr: 12.24135 batch_time=0.41465 
Train Epoch: 18 [111/1000 3552/32000 (11%)] Loss: 0.22337 (QuantReg: 12.97396) QuantErr: 12.97396 batch_time=0.42442 
Train Epoch: 18 [116/1000 3712/32000 (12%)] Loss: 0.50621 (QuantReg: 12.09985) QuantErr: 12.09985 batch_time=0.48352 
Train Epoch: 18 [121/1000 3872/32000 (12%)] Loss: 0.62969 (QuantReg: 12.97315) QuantErr: 12.97315 batch_time=0.39579 
Train Epoch: 18 [126/1000 4032/32000 (13%)] Loss: 0.80542 (QuantReg: 11.75981) QuantErr: 11.75981 batch_time=0.36237 
Train Epoch: 18 [131/1000 4192/32000 (13%)] Loss: 1.39062 (QuantReg: 11.42367) QuantErr: 11.42367 batch_time=0.37794 
Train Epoch: 18 [136/1000 4352/32000 (14%)] Loss: 0.33010 (QuantReg: 12.50860) QuantErr: 12.50860 batch_time=0.35788 
Train Epoch: 18 [141/1000 4512/32000 (14%)] Loss: 0.40450 (QuantReg: 12.35122) QuantErr: 12.35122 batch_time=0.43307 
Train Epoch: 18 [146/1000 4672/32000 (15%)] Loss: 0.51649 (QuantReg: 11.89007) QuantErr: 11.89007 batch_time=0.38335 
Train Epoch: 18 [151/1000 4832/32000 (15%)] Loss: 0.52716 (QuantReg: 11.26296) QuantErr: 11.26296 batch_time=0.71027 
Train Epoch: 18 [156/1000 4992/32000 (16%)] Loss: 0.65115 (QuantReg: 11.93286) QuantErr: 11.93286 batch_time=0.38393 
Train Epoch: 18 [161/1000 5152/32000 (16%)] Loss: 0.51667 (QuantReg: 12.67778) QuantErr: 12.67778 batch_time=0.37250 
Train Epoch: 18 [166/1000 5312/32000 (17%)] Loss: 0.51142 (QuantReg: 12.58116) QuantErr: 12.58116 batch_time=0.36337 
Train Epoch: 18 [171/1000 5472/32000 (17%)] Loss: 0.58356 (QuantReg: 12.12952) QuantErr: 12.12952 batch_time=0.40094 
Train Epoch: 18 [176/1000 5632/32000 (18%)] Loss: 0.21493 (QuantReg: 12.11559) QuantErr: 12.11559 batch_time=0.41540 
Train Epoch: 18 [181/1000 5792/32000 (18%)] Loss: 0.28588 (QuantReg: 12.48606) QuantErr: 12.48606 batch_time=0.38092 
Train Epoch: 18 [186/1000 5952/32000 (19%)] Loss: 0.64808 (QuantReg: 13.05616) QuantErr: 13.05616 batch_time=0.39070 
Train Epoch: 18 [191/1000 6112/32000 (19%)] Loss: 0.56535 (QuantReg: 12.23906) QuantErr: 12.23906 batch_time=0.41032 
Train Epoch: 18 [196/1000 6272/32000 (20%)] Loss: 0.85867 (QuantReg: 11.96219) QuantErr: 11.96219 batch_time=0.35903 
Train Epoch: 18 [201/1000 6432/32000 (20%)] Loss: 0.37257 (QuantReg: 12.25095) QuantErr: 12.25095 batch_time=0.37525 
Train Epoch: 18 [206/1000 6592/32000 (21%)] Loss: 0.30037 (QuantReg: 12.87026) QuantErr: 12.87026 batch_time=0.34526 
Train Epoch: 18 [211/1000 6752/32000 (21%)] Loss: 0.31887 (QuantReg: 11.40685) QuantErr: 11.40685 batch_time=0.36459 
Train Epoch: 18 [216/1000 6912/32000 (22%)] Loss: 0.57163 (QuantReg: 10.96276) QuantErr: 10.96276 batch_time=0.41265 
Train Epoch: 18 [221/1000 7072/32000 (22%)] Loss: 0.48183 (QuantReg: 12.29871) QuantErr: 12.29871 batch_time=0.37605 
Train Epoch: 18 [226/1000 7232/32000 (23%)] Loss: 0.27582 (QuantReg: 11.82664) QuantErr: 11.82664 batch_time=0.36802 
Train Epoch: 18 [231/1000 7392/32000 (23%)] Loss: 0.27855 (QuantReg: 12.52974) QuantErr: 12.52974 batch_time=0.34828 
Train Epoch: 18 [236/1000 7552/32000 (24%)] Loss: 0.33539 (QuantReg: 12.58286) QuantErr: 12.58286 batch_time=0.36415 
Train Epoch: 18 [241/1000 7712/32000 (24%)] Loss: 0.75983 (QuantReg: 11.78007) QuantErr: 11.78007 batch_time=0.37432 
Train Epoch: 18 [246/1000 7872/32000 (25%)] Loss: 0.31000 (QuantReg: 12.22411) QuantErr: 12.22411 batch_time=0.41952 
Train Epoch: 18 [251/1000 8032/32000 (25%)] Loss: 0.29216 (QuantReg: 12.96547) QuantErr: 12.96547 batch_time=0.45324 
Train Epoch: 18 [256/1000 8192/32000 (26%)] Loss: 0.63511 (QuantReg: 11.69321) QuantErr: 11.69321 batch_time=0.41343 
Train Epoch: 18 [261/1000 8352/32000 (26%)] Loss: 0.48508 (QuantReg: 11.70655) QuantErr: 11.70655 batch_time=0.35741 
Train Epoch: 18 [266/1000 8512/32000 (27%)] Loss: 0.26016 (QuantReg: 12.58661) QuantErr: 12.58661 batch_time=0.36496 
Train Epoch: 18 [271/1000 8672/32000 (27%)] Loss: 0.49865 (QuantReg: 12.00089) QuantErr: 12.00089 batch_time=0.34849 
Train Epoch: 18 [276/1000 8832/32000 (28%)] Loss: 0.37963 (QuantReg: 12.30713) QuantErr: 12.30713 batch_time=0.35488 
Train Epoch: 18 [281/1000 8992/32000 (28%)] Loss: 0.61951 (QuantReg: 12.26894) QuantErr: 12.26894 batch_time=0.35177 
Train Epoch: 18 [286/1000 9152/32000 (29%)] Loss: 0.19737 (QuantReg: 12.76476) QuantErr: 12.76476 batch_time=0.35611 
Train Epoch: 18 [291/1000 9312/32000 (29%)] Loss: 0.59165 (QuantReg: 12.32020) QuantErr: 12.32020 batch_time=0.34173 
Train Epoch: 18 [296/1000 9472/32000 (30%)] Loss: 0.64074 (QuantReg: 12.05147) QuantErr: 12.05147 batch_time=0.38290 
Train Epoch: 18 [301/1000 9632/32000 (30%)] Loss: 0.65011 (QuantReg: 11.82522) QuantErr: 11.82522 batch_time=0.34427 
Train Epoch: 18 [306/1000 9792/32000 (31%)] Loss: 0.65801 (QuantReg: 12.17606) QuantErr: 12.17606 batch_time=0.34963 
Train Epoch: 18 [311/1000 9952/32000 (31%)] Loss: 1.00359 (QuantReg: 11.39742) QuantErr: 11.39742 batch_time=0.34796 
Train Epoch: 18 [316/1000 10112/32000 (32%)] Loss: 0.27288 (QuantReg: 12.70862) QuantErr: 12.70862 batch_time=0.37982 
Train Epoch: 18 [321/1000 10272/32000 (32%)] Loss: 0.29698 (QuantReg: 12.44189) QuantErr: 12.44189 batch_time=0.36120 
Train Epoch: 18 [326/1000 10432/32000 (33%)] Loss: 0.49718 (QuantReg: 12.23907) QuantErr: 12.23907 batch_time=0.34524 
Train Epoch: 18 [331/1000 10592/32000 (33%)] Loss: 0.28661 (QuantReg: 11.74186) QuantErr: 11.74186 batch_time=0.34205 
Train Epoch: 18 [336/1000 10752/32000 (34%)] Loss: 0.67771 (QuantReg: 12.19488) QuantErr: 12.19488 batch_time=0.84226 
Train Epoch: 18 [341/1000 10912/32000 (34%)] Loss: 0.24314 (QuantReg: 12.57060) QuantErr: 12.57060 batch_time=0.38846 
Train Epoch: 18 [346/1000 11072/32000 (35%)] Loss: 0.32347 (QuantReg: 12.63074) QuantErr: 12.63074 batch_time=0.34949 
Train Epoch: 18 [351/1000 11232/32000 (35%)] Loss: 0.42838 (QuantReg: 12.71200) QuantErr: 12.71200 batch_time=0.34842 
Train Epoch: 18 [356/1000 11392/32000 (36%)] Loss: 0.46709 (QuantReg: 12.09032) QuantErr: 12.09032 batch_time=0.34943 
Train Epoch: 18 [361/1000 11552/32000 (36%)] Loss: 1.18307 (QuantReg: 12.04954) QuantErr: 12.04954 batch_time=0.52486 
Train Epoch: 18 [366/1000 11712/32000 (37%)] Loss: 0.57494 (QuantReg: 12.59866) QuantErr: 12.59866 batch_time=0.38912 
Train Epoch: 18 [371/1000 11872/32000 (37%)] Loss: 0.24293 (QuantReg: 12.57741) QuantErr: 12.57741 batch_time=0.34271 
Train Epoch: 18 [376/1000 12032/32000 (38%)] Loss: 0.37891 (QuantReg: 12.34105) QuantErr: 12.34105 batch_time=0.34911 
Train Epoch: 18 [381/1000 12192/32000 (38%)] Loss: 0.36951 (QuantReg: 13.00585) QuantErr: 13.00585 batch_time=0.37638 
Train Epoch: 18 [386/1000 12352/32000 (39%)] Loss: 0.44429 (QuantReg: 12.62039) QuantErr: 12.62039 batch_time=0.52549 
Train Epoch: 18 [391/1000 12512/32000 (39%)] Loss: 0.51559 (QuantReg: 12.24738) QuantErr: 12.24738 batch_time=0.46977 
Train Epoch: 18 [396/1000 12672/32000 (40%)] Loss: 0.34160 (QuantReg: 11.77831) QuantErr: 11.77831 batch_time=0.35022 
Train Epoch: 18 [401/1000 12832/32000 (40%)] Loss: 0.32652 (QuantReg: 11.55636) QuantErr: 11.55636 batch_time=0.83069 
Train Epoch: 18 [406/1000 12992/32000 (41%)] Loss: 0.21167 (QuantReg: 11.94754) QuantErr: 11.94754 batch_time=0.36650 
Train Epoch: 18 [411/1000 13152/32000 (41%)] Loss: 0.41987 (QuantReg: 12.82153) QuantErr: 12.82153 batch_time=0.34896 
Train Epoch: 18 [416/1000 13312/32000 (42%)] Loss: 0.41085 (QuantReg: 12.40448) QuantErr: 12.40448 batch_time=0.35730 
Train Epoch: 18 [421/1000 13472/32000 (42%)] Loss: 0.34774 (QuantReg: 11.96055) QuantErr: 11.96055 batch_time=0.39412 
Train Epoch: 18 [426/1000 13632/32000 (43%)] Loss: 0.24566 (QuantReg: 12.10570) QuantErr: 12.10570 batch_time=0.35723 
Train Epoch: 18 [431/1000 13792/32000 (43%)] Loss: 0.42744 (QuantReg: 11.93704) QuantErr: 11.93704 batch_time=0.42286 
Train Epoch: 18 [436/1000 13952/32000 (44%)] Loss: 0.77571 (QuantReg: 11.87689) QuantErr: 11.87689 batch_time=0.46881 
Train Epoch: 18 [441/1000 14112/32000 (44%)] Loss: 0.58995 (QuantReg: 11.62823) QuantErr: 11.62823 batch_time=0.35781 
Train Epoch: 18 [446/1000 14272/32000 (45%)] Loss: 0.53259 (QuantReg: 11.94931) QuantErr: 11.94931 batch_time=0.35189 
Train Epoch: 18 [451/1000 14432/32000 (45%)] Loss: 0.52111 (QuantReg: 12.62687) QuantErr: 12.62687 batch_time=0.36264 
Train Epoch: 18 [456/1000 14592/32000 (46%)] Loss: 0.19726 (QuantReg: 12.65975) QuantErr: 12.65975 batch_time=0.35180 
Train Epoch: 18 [461/1000 14752/32000 (46%)] Loss: 0.35578 (QuantReg: 12.19886) QuantErr: 12.19886 batch_time=0.41107 
Train Epoch: 18 [466/1000 14912/32000 (47%)] Loss: 0.68084 (QuantReg: 12.15065) QuantErr: 12.15065 batch_time=0.35550 
Train Epoch: 18 [471/1000 15072/32000 (47%)] Loss: 0.68178 (QuantReg: 11.71545) QuantErr: 11.71545 batch_time=0.67890 
Train Epoch: 18 [476/1000 15232/32000 (48%)] Loss: 0.32650 (QuantReg: 12.40571) QuantErr: 12.40571 batch_time=0.36019 
Train Epoch: 18 [481/1000 15392/32000 (48%)] Loss: 0.44307 (QuantReg: 11.94720) QuantErr: 11.94720 batch_time=0.35805 
Train Epoch: 18 [486/1000 15552/32000 (49%)] Loss: 0.35994 (QuantReg: 11.56079) QuantErr: 11.56079 batch_time=0.36130 
Train Epoch: 18 [491/1000 15712/32000 (49%)] Loss: 0.56049 (QuantReg: 11.24065) QuantErr: 11.24065 batch_time=0.42200 
Train Epoch: 18 [496/1000 15872/32000 (50%)] Loss: 0.46595 (QuantReg: 12.41893) QuantErr: 12.41893 batch_time=0.43347 
Train Epoch: 18 [501/1000 16032/32000 (50%)] Loss: 0.67060 (QuantReg: 11.76005) QuantErr: 11.76005 batch_time=0.35755 
Train Epoch: 18 [506/1000 16192/32000 (51%)] Loss: 0.70455 (QuantReg: 12.03093) QuantErr: 12.03093 batch_time=0.36206 
Train Epoch: 18 [511/1000 16352/32000 (51%)] Loss: 0.52352 (QuantReg: 12.23655) QuantErr: 12.23655 batch_time=0.35380 
Train Epoch: 18 [516/1000 16512/32000 (52%)] Loss: 0.47146 (QuantReg: 12.84774) QuantErr: 12.84774 batch_time=0.35459 
Train Epoch: 18 [521/1000 16672/32000 (52%)] Loss: 0.48126 (QuantReg: 11.87138) QuantErr: 11.87138 batch_time=0.38713 
Train Epoch: 18 [526/1000 16832/32000 (53%)] Loss: 0.73468 (QuantReg: 12.27932) QuantErr: 12.27932 batch_time=0.35806 
Train Epoch: 18 [531/1000 16992/32000 (53%)] Loss: 0.43350 (QuantReg: 11.58763) QuantErr: 11.58763 batch_time=0.35430 
Train Epoch: 18 [536/1000 17152/32000 (54%)] Loss: 0.63641 (QuantReg: 12.41928) QuantErr: 12.41928 batch_time=0.36184 
Train Epoch: 18 [541/1000 17312/32000 (54%)] Loss: 0.60237 (QuantReg: 12.26151) QuantErr: 12.26151 batch_time=0.36125 
Train Epoch: 18 [546/1000 17472/32000 (55%)] Loss: 0.63979 (QuantReg: 12.69068) QuantErr: 12.69068 batch_time=0.35871 
Train Epoch: 18 [551/1000 17632/32000 (55%)] Loss: 0.30374 (QuantReg: 11.81180) QuantErr: 11.81180 batch_time=0.35203 
Train Epoch: 18 [556/1000 17792/32000 (56%)] Loss: 0.31574 (QuantReg: 12.09994) QuantErr: 12.09994 batch_time=0.34742 
Train Epoch: 18 [561/1000 17952/32000 (56%)] Loss: 0.09564 (QuantReg: 12.20222) QuantErr: 12.20222 batch_time=0.35875 
Train Epoch: 18 [566/1000 18112/32000 (57%)] Loss: 0.67647 (QuantReg: 12.46113) QuantErr: 12.46113 batch_time=0.36656 
Train Epoch: 18 [571/1000 18272/32000 (57%)] Loss: 0.99801 (QuantReg: 11.48826) QuantErr: 11.48826 batch_time=0.35952 
Train Epoch: 18 [576/1000 18432/32000 (58%)] Loss: 0.61026 (QuantReg: 11.94179) QuantErr: 11.94179 batch_time=0.40342 
Train Epoch: 18 [581/1000 18592/32000 (58%)] Loss: 0.75089 (QuantReg: 11.68011) QuantErr: 11.68011 batch_time=0.35539 
Train Epoch: 18 [586/1000 18752/32000 (59%)] Loss: 0.26492 (QuantReg: 12.90726) QuantErr: 12.90726 batch_time=0.36783 
Train Epoch: 18 [591/1000 18912/32000 (59%)] Loss: 0.41192 (QuantReg: 12.47932) QuantErr: 12.47932 batch_time=0.34816 
Train Epoch: 18 [596/1000 19072/32000 (60%)] Loss: 0.96570 (QuantReg: 11.76503) QuantErr: 11.76503 batch_time=0.40240 
Train Epoch: 18 [601/1000 19232/32000 (60%)] Loss: 0.28854 (QuantReg: 11.82625) QuantErr: 11.82625 batch_time=0.35348 
Train Epoch: 18 [606/1000 19392/32000 (61%)] Loss: 0.29666 (QuantReg: 12.91349) QuantErr: 12.91349 batch_time=0.35227 
Train Epoch: 18 [611/1000 19552/32000 (61%)] Loss: 0.29936 (QuantReg: 12.50938) QuantErr: 12.50938 batch_time=0.46666 
Train Epoch: 18 [616/1000 19712/32000 (62%)] Loss: 0.23555 (QuantReg: 13.01062) QuantErr: 13.01062 batch_time=0.43803 
Train Epoch: 18 [621/1000 19872/32000 (62%)] Loss: 0.75485 (QuantReg: 11.76385) QuantErr: 11.76385 batch_time=0.39518 
Train Epoch: 18 [626/1000 20032/32000 (63%)] Loss: 0.69621 (QuantReg: 12.26080) QuantErr: 12.26080 batch_time=0.34993 
Train Epoch: 18 [631/1000 20192/32000 (63%)] Loss: 0.52850 (QuantReg: 11.90109) QuantErr: 11.90109 batch_time=0.35145 
Train Epoch: 18 [636/1000 20352/32000 (64%)] Loss: 0.37652 (QuantReg: 11.84908) QuantErr: 11.84908 batch_time=0.41387 
Train Epoch: 18 [641/1000 20512/32000 (64%)] Loss: 0.81129 (QuantReg: 12.31371) QuantErr: 12.31371 batch_time=0.40839 
Train Epoch: 18 [646/1000 20672/32000 (65%)] Loss: 0.33746 (QuantReg: 12.04171) QuantErr: 12.04171 batch_time=0.35139 
Train Epoch: 18 [651/1000 20832/32000 (65%)] Loss: 0.23063 (QuantReg: 12.77329) QuantErr: 12.77329 batch_time=0.34938 
Train Epoch: 18 [656/1000 20992/32000 (66%)] Loss: 0.57156 (QuantReg: 13.04557) QuantErr: 13.04557 batch_time=0.79798 
Train Epoch: 18 [661/1000 21152/32000 (66%)] Loss: 0.46982 (QuantReg: 11.75510) QuantErr: 11.75510 batch_time=0.34973 
Train Epoch: 18 [666/1000 21312/32000 (67%)] Loss: 0.38078 (QuantReg: 12.31275) QuantErr: 12.31275 batch_time=0.34905 
Train Epoch: 18 [671/1000 21472/32000 (67%)] Loss: 0.49203 (QuantReg: 12.64530) QuantErr: 12.64530 batch_time=0.36916 
Train Epoch: 18 [676/1000 21632/32000 (68%)] Loss: 1.02132 (QuantReg: 12.02959) QuantErr: 12.02959 batch_time=0.35686 
Train Epoch: 18 [681/1000 21792/32000 (68%)] Loss: 0.32908 (QuantReg: 11.74749) QuantErr: 11.74749 batch_time=0.53966 
Train Epoch: 18 [686/1000 21952/32000 (69%)] Loss: 0.28221 (QuantReg: 12.42272) QuantErr: 12.42272 batch_time=0.35084 
Train Epoch: 18 [691/1000 22112/32000 (69%)] Loss: 0.41767 (QuantReg: 12.74755) QuantErr: 12.74755 batch_time=0.40613 
Train Epoch: 18 [696/1000 22272/32000 (70%)] Loss: 0.66198 (QuantReg: 12.31982) QuantErr: 12.31982 batch_time=0.35184 
Train Epoch: 18 [701/1000 22432/32000 (70%)] Loss: 0.25104 (QuantReg: 12.66026) QuantErr: 12.66026 batch_time=0.38792 
Train Epoch: 18 [706/1000 22592/32000 (71%)] Loss: 0.65729 (QuantReg: 12.57828) QuantErr: 12.57828 batch_time=0.53794 
Train Epoch: 18 [711/1000 22752/32000 (71%)] Loss: 0.31565 (QuantReg: 12.91121) QuantErr: 12.91121 batch_time=0.50458 
Train Epoch: 18 [716/1000 22912/32000 (72%)] Loss: 0.57830 (QuantReg: 12.97660) QuantErr: 12.97660 batch_time=0.40578 
Train Epoch: 18 [721/1000 23072/32000 (72%)] Loss: 0.39814 (QuantReg: 11.68997) QuantErr: 11.68997 batch_time=0.77264 
Train Epoch: 18 [726/1000 23232/32000 (73%)] Loss: 0.22290 (QuantReg: 12.30002) QuantErr: 12.30002 batch_time=0.37750 
Train Epoch: 18 [731/1000 23392/32000 (73%)] Loss: 0.72124 (QuantReg: 12.57552) QuantErr: 12.57552 batch_time=0.45851 
Train Epoch: 18 [736/1000 23552/32000 (74%)] Loss: 0.27422 (QuantReg: 12.48203) QuantErr: 12.48203 batch_time=0.35183 
Train Epoch: 18 [741/1000 23712/32000 (74%)] Loss: 0.24502 (QuantReg: 11.76108) QuantErr: 11.76108 batch_time=0.34870 
Train Epoch: 18 [746/1000 23872/32000 (75%)] Loss: 0.57035 (QuantReg: 11.67619) QuantErr: 11.67619 batch_time=0.35884 
Train Epoch: 18 [751/1000 24032/32000 (75%)] Loss: 0.39223 (QuantReg: 12.76298) QuantErr: 12.76298 batch_time=0.37710 
Train Epoch: 18 [756/1000 24192/32000 (76%)] Loss: 0.71470 (QuantReg: 12.49439) QuantErr: 12.49439 batch_time=0.51519 
Train Epoch: 18 [761/1000 24352/32000 (76%)] Loss: 0.32845 (QuantReg: 12.34801) QuantErr: 12.34801 batch_time=0.36121 
Train Epoch: 18 [766/1000 24512/32000 (77%)] Loss: 0.36634 (QuantReg: 12.74159) QuantErr: 12.74159 batch_time=0.35899 
Train Epoch: 18 [771/1000 24672/32000 (77%)] Loss: 0.59160 (QuantReg: 12.13078) QuantErr: 12.13078 batch_time=0.36241 
Train Epoch: 18 [776/1000 24832/32000 (78%)] Loss: 0.88219 (QuantReg: 12.21844) QuantErr: 12.21844 batch_time=0.35729 
Train Epoch: 18 [781/1000 24992/32000 (78%)] Loss: 0.71194 (QuantReg: 10.99135) QuantErr: 10.99135 batch_time=0.40082 
Train Epoch: 18 [786/1000 25152/32000 (79%)] Loss: 0.41628 (QuantReg: 12.74286) QuantErr: 12.74286 batch_time=0.37078 
Train Epoch: 18 [791/1000 25312/32000 (79%)] Loss: 0.23860 (QuantReg: 12.21035) QuantErr: 12.21035 batch_time=0.69222 
Train Epoch: 18 [796/1000 25472/32000 (80%)] Loss: 0.20699 (QuantReg: 12.78944) QuantErr: 12.78944 batch_time=0.37644 
Train Epoch: 18 [801/1000 25632/32000 (80%)] Loss: 0.72176 (QuantReg: 11.88508) QuantErr: 11.88508 batch_time=0.40777 
Train Epoch: 18 [806/1000 25792/32000 (81%)] Loss: 0.62821 (QuantReg: 11.85497) QuantErr: 11.85497 batch_time=0.34483 
Train Epoch: 18 [811/1000 25952/32000 (81%)] Loss: 0.34467 (QuantReg: 11.72434) QuantErr: 11.72434 batch_time=0.35864 
Train Epoch: 18 [816/1000 26112/32000 (82%)] Loss: 0.89223 (QuantReg: 11.95639) QuantErr: 11.95639 batch_time=0.37054 
Train Epoch: 18 [821/1000 26272/32000 (82%)] Loss: 0.89486 (QuantReg: 12.14581) QuantErr: 12.14581 batch_time=0.36404 
Train Epoch: 18 [826/1000 26432/32000 (83%)] Loss: 0.79249 (QuantReg: 11.83158) QuantErr: 11.83158 batch_time=0.36975 
Train Epoch: 18 [831/1000 26592/32000 (83%)] Loss: 0.34536 (QuantReg: 12.23085) QuantErr: 12.23085 batch_time=0.35714 
Train Epoch: 18 [836/1000 26752/32000 (84%)] Loss: 0.83260 (QuantReg: 12.24479) QuantErr: 12.24479 batch_time=0.35049 
Train Epoch: 18 [841/1000 26912/32000 (84%)] Loss: 0.71606 (QuantReg: 12.41941) QuantErr: 12.41941 batch_time=0.34833 
Train Epoch: 18 [846/1000 27072/32000 (85%)] Loss: 0.35582 (QuantReg: 12.56787) QuantErr: 12.56787 batch_time=0.36643 
Train Epoch: 18 [851/1000 27232/32000 (85%)] Loss: 0.53634 (QuantReg: 12.51110) QuantErr: 12.51110 batch_time=0.36412 
Train Epoch: 18 [856/1000 27392/32000 (86%)] Loss: 0.61122 (QuantReg: 12.12772) QuantErr: 12.12772 batch_time=0.48861 
Train Epoch: 18 [861/1000 27552/32000 (86%)] Loss: 0.59258 (QuantReg: 11.64354) QuantErr: 11.64354 batch_time=0.34336 
Train Epoch: 18 [866/1000 27712/32000 (87%)] Loss: 0.31187 (QuantReg: 12.99479) QuantErr: 12.99479 batch_time=0.35438 
Train Epoch: 18 [871/1000 27872/32000 (87%)] Loss: 0.45107 (QuantReg: 12.19205) QuantErr: 12.19205 batch_time=0.36195 
Train Epoch: 18 [876/1000 28032/32000 (88%)] Loss: 0.34922 (QuantReg: 12.74681) QuantErr: 12.74681 batch_time=0.36791 
Train Epoch: 18 [881/1000 28192/32000 (88%)] Loss: 0.89680 (QuantReg: 11.80081) QuantErr: 11.80081 batch_time=0.35320 
Train Epoch: 18 [886/1000 28352/32000 (89%)] Loss: 0.51708 (QuantReg: 12.14258) QuantErr: 12.14258 batch_time=0.35366 
Train Epoch: 18 [891/1000 28512/32000 (89%)] Loss: 0.25293 (QuantReg: 12.20114) QuantErr: 12.20114 batch_time=0.34785 
Train Epoch: 18 [896/1000 28672/32000 (90%)] Loss: 0.68346 (QuantReg: 13.20453) QuantErr: 13.20453 batch_time=0.37857 
Train Epoch: 18 [901/1000 28832/32000 (90%)] Loss: 0.46648 (QuantReg: 12.88511) QuantErr: 12.88511 batch_time=0.35583 
Train Epoch: 18 [906/1000 28992/32000 (91%)] Loss: 0.69455 (QuantReg: 11.96718) QuantErr: 11.96718 batch_time=0.34567 
Train Epoch: 18 [911/1000 29152/32000 (91%)] Loss: 0.47121 (QuantReg: 11.75832) QuantErr: 11.75832 batch_time=0.35317 
Train Epoch: 18 [916/1000 29312/32000 (92%)] Loss: 0.27983 (QuantReg: 12.92411) QuantErr: 12.92411 batch_time=0.34609 
Train Epoch: 18 [921/1000 29472/32000 (92%)] Loss: 0.52862 (QuantReg: 12.68323) QuantErr: 12.68323 batch_time=0.35963 
Train Epoch: 18 [926/1000 29632/32000 (93%)] Loss: 0.23808 (QuantReg: 12.50243) QuantErr: 12.50243 batch_time=0.35638 
Train Epoch: 18 [931/1000 29792/32000 (93%)] Loss: 0.24420 (QuantReg: 12.68227) QuantErr: 12.68227 batch_time=0.35183 
Train Epoch: 18 [936/1000 29952/32000 (94%)] Loss: 0.48906 (QuantReg: 12.01892) QuantErr: 12.01892 batch_time=0.36082 
Train Epoch: 18 [941/1000 30112/32000 (94%)] Loss: 0.41906 (QuantReg: 12.26277) QuantErr: 12.26277 batch_time=0.36887 
Train Epoch: 18 [946/1000 30272/32000 (95%)] Loss: 0.33837 (QuantReg: 12.05515) QuantErr: 12.05515 batch_time=0.37598 
Train Epoch: 18 [951/1000 30432/32000 (95%)] Loss: 0.45373 (QuantReg: 12.19959) QuantErr: 12.19959 batch_time=0.36826 
Train Epoch: 18 [956/1000 30592/32000 (96%)] Loss: 0.31867 (QuantReg: 12.79558) QuantErr: 12.79558 batch_time=0.37207 
Train Epoch: 18 [961/1000 30752/32000 (96%)] Loss: 0.67942 (QuantReg: 12.00593) QuantErr: 12.00593 batch_time=0.35137 
Train Epoch: 18 [966/1000 30912/32000 (97%)] Loss: 0.75018 (QuantReg: 12.75267) QuantErr: 12.75267 batch_time=0.35230 
Train Epoch: 18 [971/1000 31072/32000 (97%)] Loss: 0.57984 (QuantReg: 12.59855) QuantErr: 12.59855 batch_time=0.38015 
Train Epoch: 18 [976/1000 31232/32000 (98%)] Loss: 0.84838 (QuantReg: 12.67197) QuantErr: 12.67197 batch_time=0.81265 
Train Epoch: 18 [981/1000 31392/32000 (98%)] Loss: 0.24094 (QuantReg: 12.44997) QuantErr: 12.44997 batch_time=0.35477 
Train Epoch: 18 [986/1000 31552/32000 (99%)] Loss: 0.27400 (QuantReg: 11.80665) QuantErr: 11.80665 batch_time=0.34528 
Train Epoch: 18 [991/1000 31712/32000 (99%)] Loss: 0.31151 (QuantReg: 12.45949) QuantErr: 12.45949 batch_time=0.34467 
Train Epoch: 18 [996/1000 31872/32000 (100%)] Loss: 0.80011 (QuantReg: 11.94692) QuantErr: 11.94692 batch_time=0.34925 
Train Epoch: 18 codebook_update_time=1.78628
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch18.pth ...
Done in 17.598s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 0.4929627533331513
 quant_reg      : 12.21463184261322
 quant_err      : 12.21463184261322
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 18000
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 64.58752515090544
 MSRVTT_full_val/t2v_metrics/R10: 77.66599597585513
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.37625754527163
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.33238226789698
 MSRVTT_full_val/v2t_metrics/R1: 30.784708249496983
 MSRVTT_full_val/v2t_metrics/R5: 73.8430583501006
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.881287726358149
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.51669018628996
 MSRVTT_full_test/t2v_metrics/R1: 10.635451505016722
 MSRVTT_full_test/t2v_metrics/R5: 32.608695652173914
 MSRVTT_full_test/t2v_metrics/R10: 45.88628762541806
 MSRVTT_full_test/t2v_metrics/R50: 78.82943143812709
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.89966555183946
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.153056172542197
 MSRVTT_full_test/v2t_metrics/R1: 13.377926421404682
 MSRVTT_full_test/v2t_metrics/R5: 37.391304347826086
 MSRVTT_full_test/v2t_metrics/R10: 52.474916387959865
 MSRVTT_full_test/v2t_metrics/R50: 85.08361204013377
 MSRVTT_full_test/v2t_metrics/MedR: 9.75
 MSRVTT_full_test/v2t_metrics/MeanR: 35.85886287625418
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.7191961127839
 mnt_best       : 26.059370147275818
 not_improved_count: 1
Train Epoch: 19 [1/1000 32/32000 (0%)] Loss: 0.40074 (QuantReg: 11.96994) QuantErr: 11.96994 batch_time=30.19686 
Train Epoch: 19 [6/1000 192/32000 (1%)] Loss: 0.77623 (QuantReg: 11.87620) QuantErr: 11.87620 batch_time=0.39131 
Train Epoch: 19 [11/1000 352/32000 (1%)] Loss: 0.36444 (QuantReg: 12.33427) QuantErr: 12.33427 batch_time=0.39189 
Train Epoch: 19 [16/1000 512/32000 (2%)] Loss: 0.21726 (QuantReg: 12.02726) QuantErr: 12.02726 batch_time=0.37408 
Train Epoch: 19 [21/1000 672/32000 (2%)] Loss: 0.37428 (QuantReg: 12.11953) QuantErr: 12.11953 batch_time=0.43237 
Train Epoch: 19 [26/1000 832/32000 (3%)] Loss: 0.53772 (QuantReg: 11.93344) QuantErr: 11.93344 batch_time=0.43972 
Train Epoch: 19 [31/1000 992/32000 (3%)] Loss: 0.54058 (QuantReg: 12.14570) QuantErr: 12.14570 batch_time=0.35790 
Train Epoch: 19 [36/1000 1152/32000 (4%)] Loss: 0.41328 (QuantReg: 12.09167) QuantErr: 12.09167 batch_time=0.40024 
Train Epoch: 19 [41/1000 1312/32000 (4%)] Loss: 0.67106 (QuantReg: 11.92605) QuantErr: 11.92605 batch_time=0.37065 
Train Epoch: 19 [46/1000 1472/32000 (5%)] Loss: 0.60623 (QuantReg: 11.50720) QuantErr: 11.50720 batch_time=0.41239 
Train Epoch: 19 [51/1000 1632/32000 (5%)] Loss: 0.29573 (QuantReg: 12.71750) QuantErr: 12.71750 batch_time=0.33583 
Train Epoch: 19 [56/1000 1792/32000 (6%)] Loss: 0.58689 (QuantReg: 11.64333) QuantErr: 11.64333 batch_time=0.35656 
Train Epoch: 19 [61/1000 1952/32000 (6%)] Loss: 0.13304 (QuantReg: 12.67163) QuantErr: 12.67163 batch_time=0.38818 
Train Epoch: 19 [66/1000 2112/32000 (7%)] Loss: 0.30346 (QuantReg: 11.78372) QuantErr: 11.78372 batch_time=0.41396 
Train Epoch: 19 [71/1000 2272/32000 (7%)] Loss: 0.47706 (QuantReg: 12.72331) QuantErr: 12.72331 batch_time=0.36080 
Train Epoch: 19 [76/1000 2432/32000 (8%)] Loss: 0.39733 (QuantReg: 12.30153) QuantErr: 12.30153 batch_time=0.40426 
Train Epoch: 19 [81/1000 2592/32000 (8%)] Loss: 0.34034 (QuantReg: 11.37814) QuantErr: 11.37814 batch_time=0.37516 
Train Epoch: 19 [86/1000 2752/32000 (9%)] Loss: 1.18987 (QuantReg: 12.49717) QuantErr: 12.49717 batch_time=0.37412 
Train Epoch: 19 [91/1000 2912/32000 (9%)] Loss: 0.64930 (QuantReg: 11.24245) QuantErr: 11.24245 batch_time=0.36193 
Train Epoch: 19 [96/1000 3072/32000 (10%)] Loss: 0.65349 (QuantReg: 12.35765) QuantErr: 12.35765 batch_time=0.34789 
Train Epoch: 19 [101/1000 3232/32000 (10%)] Loss: 0.88927 (QuantReg: 11.47440) QuantErr: 11.47440 batch_time=0.34323 
Train Epoch: 19 [106/1000 3392/32000 (11%)] Loss: 0.45857 (QuantReg: 12.25735) QuantErr: 12.25735 batch_time=0.51193 
Train Epoch: 19 [111/1000 3552/32000 (11%)] Loss: 0.82463 (QuantReg: 12.22589) QuantErr: 12.22589 batch_time=0.34974 
Train Epoch: 19 [116/1000 3712/32000 (12%)] Loss: 0.50867 (QuantReg: 12.07401) QuantErr: 12.07401 batch_time=0.37653 
Train Epoch: 19 [121/1000 3872/32000 (12%)] Loss: 0.41648 (QuantReg: 11.70592) QuantErr: 11.70592 batch_time=0.42603 
Train Epoch: 19 [126/1000 4032/32000 (13%)] Loss: 0.56806 (QuantReg: 11.98104) QuantErr: 11.98104 batch_time=0.42671 
Train Epoch: 19 [131/1000 4192/32000 (13%)] Loss: 0.34477 (QuantReg: 12.45548) QuantErr: 12.45548 batch_time=0.34384 
Train Epoch: 19 [136/1000 4352/32000 (14%)] Loss: 0.71216 (QuantReg: 12.08942) QuantErr: 12.08942 batch_time=0.37430 
Train Epoch: 19 [141/1000 4512/32000 (14%)] Loss: 0.30708 (QuantReg: 11.61950) QuantErr: 11.61950 batch_time=0.43067 
Train Epoch: 19 [146/1000 4672/32000 (15%)] Loss: 0.50830 (QuantReg: 12.06113) QuantErr: 12.06113 batch_time=0.47175 
Train Epoch: 19 [151/1000 4832/32000 (15%)] Loss: 0.59158 (QuantReg: 12.26131) QuantErr: 12.26131 batch_time=0.49832 
Train Epoch: 19 [156/1000 4992/32000 (16%)] Loss: 0.49273 (QuantReg: 12.26004) QuantErr: 12.26004 batch_time=0.42664 
Train Epoch: 19 [161/1000 5152/32000 (16%)] Loss: 0.29871 (QuantReg: 12.34121) QuantErr: 12.34121 batch_time=0.37043 
Train Epoch: 19 [166/1000 5312/32000 (17%)] Loss: 0.61836 (QuantReg: 12.42538) QuantErr: 12.42538 batch_time=0.33995 
Train Epoch: 19 [171/1000 5472/32000 (17%)] Loss: 0.41090 (QuantReg: 12.29483) QuantErr: 12.29483 batch_time=0.42212 
Train Epoch: 19 [176/1000 5632/32000 (18%)] Loss: 0.39774 (QuantReg: 11.82499) QuantErr: 11.82499 batch_time=0.39473 
Train Epoch: 19 [181/1000 5792/32000 (18%)] Loss: 0.23447 (QuantReg: 12.14107) QuantErr: 12.14107 batch_time=0.36849 
Train Epoch: 19 [186/1000 5952/32000 (19%)] Loss: 0.36473 (QuantReg: 11.63089) QuantErr: 11.63089 batch_time=0.50699 
Train Epoch: 19 [191/1000 6112/32000 (19%)] Loss: 0.67744 (QuantReg: 12.17868) QuantErr: 12.17868 batch_time=0.35649 
Train Epoch: 19 [196/1000 6272/32000 (20%)] Loss: 0.42249 (QuantReg: 12.48036) QuantErr: 12.48036 batch_time=0.37058 
Train Epoch: 19 [201/1000 6432/32000 (20%)] Loss: 0.39425 (QuantReg: 12.38845) QuantErr: 12.38845 batch_time=0.35868 
Train Epoch: 19 [206/1000 6592/32000 (21%)] Loss: 0.35144 (QuantReg: 11.85722) QuantErr: 11.85722 batch_time=0.38991 
Train Epoch: 19 [211/1000 6752/32000 (21%)] Loss: 0.88942 (QuantReg: 10.89929) QuantErr: 10.89929 batch_time=0.36384 
Train Epoch: 19 [216/1000 6912/32000 (22%)] Loss: 0.35037 (QuantReg: 12.04820) QuantErr: 12.04820 batch_time=0.41422 
Train Epoch: 19 [221/1000 7072/32000 (22%)] Loss: 0.62743 (QuantReg: 13.08892) QuantErr: 13.08892 batch_time=0.34948 
Train Epoch: 19 [226/1000 7232/32000 (23%)] Loss: 0.59618 (QuantReg: 12.46238) QuantErr: 12.46238 batch_time=0.54643 
Train Epoch: 19 [231/1000 7392/32000 (23%)] Loss: 0.71277 (QuantReg: 12.31249) QuantErr: 12.31249 batch_time=0.34494 
Train Epoch: 19 [236/1000 7552/32000 (24%)] Loss: 0.53824 (QuantReg: 12.69682) QuantErr: 12.69682 batch_time=0.35160 
Train Epoch: 19 [241/1000 7712/32000 (24%)] Loss: 0.21655 (QuantReg: 11.86647) QuantErr: 11.86647 batch_time=0.40150 
Train Epoch: 19 [246/1000 7872/32000 (25%)] Loss: 0.20806 (QuantReg: 12.02583) QuantErr: 12.02583 batch_time=0.36395 
Train Epoch: 19 [251/1000 8032/32000 (25%)] Loss: 0.34926 (QuantReg: 11.66366) QuantErr: 11.66366 batch_time=0.35081 
Train Epoch: 19 [256/1000 8192/32000 (26%)] Loss: 0.46614 (QuantReg: 12.29002) QuantErr: 12.29002 batch_time=0.44553 
Train Epoch: 19 [261/1000 8352/32000 (26%)] Loss: 0.31815 (QuantReg: 12.57536) QuantErr: 12.57536 batch_time=0.38405 
Train Epoch: 19 [266/1000 8512/32000 (27%)] Loss: 0.30337 (QuantReg: 12.50151) QuantErr: 12.50151 batch_time=0.37883 
Train Epoch: 19 [271/1000 8672/32000 (27%)] Loss: 0.33544 (QuantReg: 12.69216) QuantErr: 12.69216 batch_time=0.39087 
Train Epoch: 19 [276/1000 8832/32000 (28%)] Loss: 0.29326 (QuantReg: 11.70350) QuantErr: 11.70350 batch_time=0.38898 
Train Epoch: 19 [281/1000 8992/32000 (28%)] Loss: 0.36622 (QuantReg: 12.43901) QuantErr: 12.43901 batch_time=0.74207 
Train Epoch: 19 [286/1000 9152/32000 (29%)] Loss: 0.24974 (QuantReg: 12.28427) QuantErr: 12.28427 batch_time=0.43517 
Train Epoch: 19 [291/1000 9312/32000 (29%)] Loss: 0.54371 (QuantReg: 12.36069) QuantErr: 12.36069 batch_time=0.34712 
Train Epoch: 19 [296/1000 9472/32000 (30%)] Loss: 0.17057 (QuantReg: 12.01197) QuantErr: 12.01197 batch_time=0.34271 
Train Epoch: 19 [301/1000 9632/32000 (30%)] Loss: 0.49837 (QuantReg: 11.73391) QuantErr: 11.73391 batch_time=0.38099 
Train Epoch: 19 [306/1000 9792/32000 (31%)] Loss: 0.64382 (QuantReg: 12.17102) QuantErr: 12.17102 batch_time=0.39195 
Train Epoch: 19 [311/1000 9952/32000 (31%)] Loss: 0.55443 (QuantReg: 12.32126) QuantErr: 12.32126 batch_time=0.36685 
Train Epoch: 19 [316/1000 10112/32000 (32%)] Loss: 0.23021 (QuantReg: 12.33826) QuantErr: 12.33826 batch_time=0.35625 
Train Epoch: 19 [321/1000 10272/32000 (32%)] Loss: 0.56346 (QuantReg: 12.09589) QuantErr: 12.09589 batch_time=2.00042 
Train Epoch: 19 [326/1000 10432/32000 (33%)] Loss: 0.61541 (QuantReg: 12.10928) QuantErr: 12.10928 batch_time=0.36155 
Train Epoch: 19 [331/1000 10592/32000 (33%)] Loss: 0.65143 (QuantReg: 12.72070) QuantErr: 12.72070 batch_time=0.48953 
Train Epoch: 19 [336/1000 10752/32000 (34%)] Loss: 0.14177 (QuantReg: 12.36173) QuantErr: 12.36173 batch_time=0.36444 
Train Epoch: 19 [341/1000 10912/32000 (34%)] Loss: 0.68804 (QuantReg: 11.11066) QuantErr: 11.11066 batch_time=0.40146 
Train Epoch: 19 [346/1000 11072/32000 (35%)] Loss: 0.29477 (QuantReg: 11.84385) QuantErr: 11.84385 batch_time=0.37621 
Train Epoch: 19 [351/1000 11232/32000 (35%)] Loss: 1.03967 (QuantReg: 11.75730) QuantErr: 11.75730 batch_time=0.43303 
Train Epoch: 19 [356/1000 11392/32000 (36%)] Loss: 0.21105 (QuantReg: 12.58734) QuantErr: 12.58734 batch_time=0.36346 
Train Epoch: 19 [361/1000 11552/32000 (36%)] Loss: 0.48581 (QuantReg: 13.03005) QuantErr: 13.03005 batch_time=0.38509 
Train Epoch: 19 [366/1000 11712/32000 (37%)] Loss: 0.59665 (QuantReg: 12.40438) QuantErr: 12.40438 batch_time=0.37035 
Train Epoch: 19 [371/1000 11872/32000 (37%)] Loss: 0.70123 (QuantReg: 11.07486) QuantErr: 11.07486 batch_time=0.38301 
Train Epoch: 19 [376/1000 12032/32000 (38%)] Loss: 0.55450 (QuantReg: 12.69849) QuantErr: 12.69849 batch_time=0.36493 
Train Epoch: 19 [381/1000 12192/32000 (38%)] Loss: 0.43363 (QuantReg: 12.20477) QuantErr: 12.20477 batch_time=0.41845 
Train Epoch: 19 [386/1000 12352/32000 (39%)] Loss: 0.39775 (QuantReg: 12.55362) QuantErr: 12.55362 batch_time=0.37751 
Train Epoch: 19 [391/1000 12512/32000 (39%)] Loss: 0.48603 (QuantReg: 11.82527) QuantErr: 11.82527 batch_time=0.36705 
Train Epoch: 19 [396/1000 12672/32000 (40%)] Loss: 0.91642 (QuantReg: 12.44986) QuantErr: 12.44986 batch_time=0.39915 
Train Epoch: 19 [401/1000 12832/32000 (40%)] Loss: 1.34793 (QuantReg: 12.11793) QuantErr: 12.11793 batch_time=0.48335 
Train Epoch: 19 [406/1000 12992/32000 (41%)] Loss: 0.48117 (QuantReg: 11.71309) QuantErr: 11.71309 batch_time=0.42182 
Train Epoch: 19 [411/1000 13152/32000 (41%)] Loss: 0.77637 (QuantReg: 12.02509) QuantErr: 12.02509 batch_time=0.39486 
Train Epoch: 19 [416/1000 13312/32000 (42%)] Loss: 0.35185 (QuantReg: 12.07920) QuantErr: 12.07920 batch_time=0.37979 
Train Epoch: 19 [421/1000 13472/32000 (42%)] Loss: 0.68821 (QuantReg: 11.89251) QuantErr: 11.89251 batch_time=0.36504 
Train Epoch: 19 [426/1000 13632/32000 (43%)] Loss: 0.55977 (QuantReg: 11.78363) QuantErr: 11.78363 batch_time=0.53440 
Train Epoch: 19 [431/1000 13792/32000 (43%)] Loss: 0.46011 (QuantReg: 12.27405) QuantErr: 12.27405 batch_time=0.36611 
Train Epoch: 19 [436/1000 13952/32000 (44%)] Loss: 0.60308 (QuantReg: 12.12951) QuantErr: 12.12951 batch_time=0.36824 
Train Epoch: 19 [441/1000 14112/32000 (44%)] Loss: 0.53241 (QuantReg: 11.79354) QuantErr: 11.79354 batch_time=0.46200 
Train Epoch: 19 [446/1000 14272/32000 (45%)] Loss: 0.58022 (QuantReg: 11.63205) QuantErr: 11.63205 batch_time=0.36653 
Train Epoch: 19 [451/1000 14432/32000 (45%)] Loss: 0.66570 (QuantReg: 13.09875) QuantErr: 13.09875 batch_time=0.35630 
Train Epoch: 19 [456/1000 14592/32000 (46%)] Loss: 0.78987 (QuantReg: 12.63259) QuantErr: 12.63259 batch_time=0.46669 
Train Epoch: 19 [461/1000 14752/32000 (46%)] Loss: 0.48973 (QuantReg: 12.07271) QuantErr: 12.07271 batch_time=0.39680 
Train Epoch: 19 [466/1000 14912/32000 (47%)] Loss: 0.50003 (QuantReg: 11.67142) QuantErr: 11.67142 batch_time=0.37598 
Train Epoch: 19 [471/1000 15072/32000 (47%)] Loss: 0.20435 (QuantReg: 12.93017) QuantErr: 12.93017 batch_time=0.38191 
Train Epoch: 19 [476/1000 15232/32000 (48%)] Loss: 0.33400 (QuantReg: 12.14905) QuantErr: 12.14905 batch_time=0.43532 
Train Epoch: 19 [481/1000 15392/32000 (48%)] Loss: 0.61861 (QuantReg: 11.80298) QuantErr: 11.80298 batch_time=0.37245 
Train Epoch: 19 [486/1000 15552/32000 (49%)] Loss: 0.56447 (QuantReg: 12.18194) QuantErr: 12.18194 batch_time=0.44840 
Train Epoch: 19 [491/1000 15712/32000 (49%)] Loss: 0.65459 (QuantReg: 12.24893) QuantErr: 12.24893 batch_time=0.39913 
Train Epoch: 19 [496/1000 15872/32000 (50%)] Loss: 0.58586 (QuantReg: 11.75742) QuantErr: 11.75742 batch_time=0.39870 
Train Epoch: 19 [501/1000 16032/32000 (50%)] Loss: 0.31676 (QuantReg: 12.07934) QuantErr: 12.07934 batch_time=0.40055 
Train Epoch: 19 [506/1000 16192/32000 (51%)] Loss: 0.30867 (QuantReg: 12.69598) QuantErr: 12.69598 batch_time=0.50253 
Train Epoch: 19 [511/1000 16352/32000 (51%)] Loss: 0.34150 (QuantReg: 13.04530) QuantErr: 13.04530 batch_time=0.34245 
Train Epoch: 19 [516/1000 16512/32000 (52%)] Loss: 0.31256 (QuantReg: 12.65645) QuantErr: 12.65645 batch_time=0.34630 
Train Epoch: 19 [521/1000 16672/32000 (52%)] Loss: 0.75631 (QuantReg: 12.18781) QuantErr: 12.18781 batch_time=0.39583 
Train Epoch: 19 [526/1000 16832/32000 (53%)] Loss: 0.44091 (QuantReg: 11.49089) QuantErr: 11.49089 batch_time=0.38930 
Train Epoch: 19 [531/1000 16992/32000 (53%)] Loss: 0.72911 (QuantReg: 12.05667) QuantErr: 12.05667 batch_time=0.36759 
Train Epoch: 19 [536/1000 17152/32000 (54%)] Loss: 0.23684 (QuantReg: 12.34442) QuantErr: 12.34442 batch_time=0.46065 
Train Epoch: 19 [541/1000 17312/32000 (54%)] Loss: 0.25350 (QuantReg: 11.77130) QuantErr: 11.77130 batch_time=0.42751 
Train Epoch: 19 [546/1000 17472/32000 (55%)] Loss: 0.51057 (QuantReg: 12.20307) QuantErr: 12.20307 batch_time=0.62423 
Train Epoch: 19 [551/1000 17632/32000 (55%)] Loss: 0.46097 (QuantReg: 12.11959) QuantErr: 12.11959 batch_time=0.46603 
Train Epoch: 19 [556/1000 17792/32000 (56%)] Loss: 0.36399 (QuantReg: 12.19086) QuantErr: 12.19086 batch_time=0.47381 
Train Epoch: 19 [561/1000 17952/32000 (56%)] Loss: 0.64509 (QuantReg: 12.32001) QuantErr: 12.32001 batch_time=0.44103 
Train Epoch: 19 [566/1000 18112/32000 (57%)] Loss: 0.11297 (QuantReg: 12.04099) QuantErr: 12.04099 batch_time=0.38277 
Train Epoch: 19 [571/1000 18272/32000 (57%)] Loss: 0.33521 (QuantReg: 12.06404) QuantErr: 12.06404 batch_time=0.39602 
Train Epoch: 19 [576/1000 18432/32000 (58%)] Loss: 0.37662 (QuantReg: 12.58815) QuantErr: 12.58815 batch_time=0.38757 
Train Epoch: 19 [581/1000 18592/32000 (58%)] Loss: 0.66806 (QuantReg: 12.45782) QuantErr: 12.45782 batch_time=0.37729 
Train Epoch: 19 [586/1000 18752/32000 (59%)] Loss: 0.63960 (QuantReg: 12.23792) QuantErr: 12.23792 batch_time=0.44891 
Train Epoch: 19 [591/1000 18912/32000 (59%)] Loss: 0.60439 (QuantReg: 12.59626) QuantErr: 12.59626 batch_time=0.37351 
Train Epoch: 19 [596/1000 19072/32000 (60%)] Loss: 0.26692 (QuantReg: 12.88074) QuantErr: 12.88074 batch_time=0.37955 
Train Epoch: 19 [601/1000 19232/32000 (60%)] Loss: 0.32170 (QuantReg: 12.64511) QuantErr: 12.64511 batch_time=0.39267 
Train Epoch: 19 [606/1000 19392/32000 (61%)] Loss: 0.30232 (QuantReg: 12.17455) QuantErr: 12.17455 batch_time=0.37117 
Train Epoch: 19 [611/1000 19552/32000 (61%)] Loss: 0.40984 (QuantReg: 12.99846) QuantErr: 12.99846 batch_time=0.41189 
Train Epoch: 19 [616/1000 19712/32000 (62%)] Loss: 0.39839 (QuantReg: 12.70390) QuantErr: 12.70390 batch_time=0.39841 
Train Epoch: 19 [621/1000 19872/32000 (62%)] Loss: 0.50358 (QuantReg: 11.75695) QuantErr: 11.75695 batch_time=0.32601 
Train Epoch: 19 [626/1000 20032/32000 (63%)] Loss: 0.46209 (QuantReg: 11.83175) QuantErr: 11.83175 batch_time=0.37850 
Train Epoch: 19 [631/1000 20192/32000 (63%)] Loss: 0.42783 (QuantReg: 12.17664) QuantErr: 12.17664 batch_time=0.40873 
Train Epoch: 19 [636/1000 20352/32000 (64%)] Loss: 0.86658 (QuantReg: 12.78251) QuantErr: 12.78251 batch_time=0.39420 
Train Epoch: 19 [641/1000 20512/32000 (64%)] Loss: 0.43889 (QuantReg: 12.79309) QuantErr: 12.79309 batch_time=2.04529 
Train Epoch: 19 [646/1000 20672/32000 (65%)] Loss: 0.20451 (QuantReg: 12.34444) QuantErr: 12.34444 batch_time=0.37763 
Train Epoch: 19 [651/1000 20832/32000 (65%)] Loss: 0.61757 (QuantReg: 12.53618) QuantErr: 12.53618 batch_time=0.36800 
Train Epoch: 19 [656/1000 20992/32000 (66%)] Loss: 0.28454 (QuantReg: 12.28223) QuantErr: 12.28223 batch_time=0.41697 
Train Epoch: 19 [661/1000 21152/32000 (66%)] Loss: 0.91908 (QuantReg: 11.70842) QuantErr: 11.70842 batch_time=0.36772 
Train Epoch: 19 [666/1000 21312/32000 (67%)] Loss: 0.81301 (QuantReg: 12.44843) QuantErr: 12.44843 batch_time=0.51217 
Train Epoch: 19 [671/1000 21472/32000 (67%)] Loss: 0.79223 (QuantReg: 12.32129) QuantErr: 12.32129 batch_time=0.41468 
Train Epoch: 19 [676/1000 21632/32000 (68%)] Loss: 0.25133 (QuantReg: 12.50409) QuantErr: 12.50409 batch_time=0.37780 
Train Epoch: 19 [681/1000 21792/32000 (68%)] Loss: 0.49663 (QuantReg: 12.12085) QuantErr: 12.12085 batch_time=0.35405 
Train Epoch: 19 [686/1000 21952/32000 (69%)] Loss: 0.45111 (QuantReg: 12.74361) QuantErr: 12.74361 batch_time=0.37985 
Train Epoch: 19 [691/1000 22112/32000 (69%)] Loss: 0.60466 (QuantReg: 11.86807) QuantErr: 11.86807 batch_time=0.35273 
Train Epoch: 19 [696/1000 22272/32000 (70%)] Loss: 0.50003 (QuantReg: 11.79966) QuantErr: 11.79966 batch_time=0.36046 
Train Epoch: 19 [701/1000 22432/32000 (70%)] Loss: 0.65607 (QuantReg: 11.91926) QuantErr: 11.91926 batch_time=0.40758 
Train Epoch: 19 [706/1000 22592/32000 (71%)] Loss: 0.64862 (QuantReg: 11.45565) QuantErr: 11.45565 batch_time=0.37225 
Train Epoch: 19 [711/1000 22752/32000 (71%)] Loss: 0.42419 (QuantReg: 12.01815) QuantErr: 12.01815 batch_time=0.42947 
Train Epoch: 19 [716/1000 22912/32000 (72%)] Loss: 0.45707 (QuantReg: 11.63500) QuantErr: 11.63500 batch_time=0.35759 
Train Epoch: 19 [721/1000 23072/32000 (72%)] Loss: 0.64272 (QuantReg: 12.22222) QuantErr: 12.22222 batch_time=0.37106 
Train Epoch: 19 [726/1000 23232/32000 (73%)] Loss: 0.59109 (QuantReg: 12.61493) QuantErr: 12.61493 batch_time=0.36909 
Train Epoch: 19 [731/1000 23392/32000 (73%)] Loss: 0.14974 (QuantReg: 12.26073) QuantErr: 12.26073 batch_time=0.37585 
Train Epoch: 19 [736/1000 23552/32000 (74%)] Loss: 0.94877 (QuantReg: 12.30421) QuantErr: 12.30421 batch_time=0.38850 
Train Epoch: 19 [741/1000 23712/32000 (74%)] Loss: 0.38706 (QuantReg: 12.61815) QuantErr: 12.61815 batch_time=0.41828 
Train Epoch: 19 [746/1000 23872/32000 (75%)] Loss: 0.30490 (QuantReg: 12.21094) QuantErr: 12.21094 batch_time=0.46811 
Train Epoch: 19 [751/1000 24032/32000 (75%)] Loss: 0.66742 (QuantReg: 12.23214) QuantErr: 12.23214 batch_time=0.34474 
Train Epoch: 19 [756/1000 24192/32000 (76%)] Loss: 0.41200 (QuantReg: 12.45421) QuantErr: 12.45421 batch_time=0.38547 
Train Epoch: 19 [761/1000 24352/32000 (76%)] Loss: 0.35125 (QuantReg: 13.05341) QuantErr: 13.05341 batch_time=0.39493 
Train Epoch: 19 [766/1000 24512/32000 (77%)] Loss: 0.35600 (QuantReg: 12.53569) QuantErr: 12.53569 batch_time=0.37416 
Train Epoch: 19 [771/1000 24672/32000 (77%)] Loss: 0.72855 (QuantReg: 12.33750) QuantErr: 12.33750 batch_time=0.36970 
Train Epoch: 19 [776/1000 24832/32000 (78%)] Loss: 0.12824 (QuantReg: 12.63475) QuantErr: 12.63475 batch_time=0.39444 
Train Epoch: 19 [781/1000 24992/32000 (78%)] Loss: 0.35102 (QuantReg: 13.26926) QuantErr: 13.26926 batch_time=0.40661 
Train Epoch: 19 [786/1000 25152/32000 (79%)] Loss: 0.59429 (QuantReg: 12.33263) QuantErr: 12.33263 batch_time=0.38239 
Train Epoch: 19 [791/1000 25312/32000 (79%)] Loss: 0.58624 (QuantReg: 12.06944) QuantErr: 12.06944 batch_time=0.37328 
Train Epoch: 19 [796/1000 25472/32000 (80%)] Loss: 0.25775 (QuantReg: 12.45516) QuantErr: 12.45516 batch_time=0.39793 
Train Epoch: 19 [801/1000 25632/32000 (80%)] Loss: 0.49782 (QuantReg: 12.41033) QuantErr: 12.41033 batch_time=0.43163 
Train Epoch: 19 [806/1000 25792/32000 (81%)] Loss: 0.37807 (QuantReg: 12.08254) QuantErr: 12.08254 batch_time=0.40600 
Train Epoch: 19 [811/1000 25952/32000 (81%)] Loss: 0.62545 (QuantReg: 12.16858) QuantErr: 12.16858 batch_time=0.43072 
Train Epoch: 19 [816/1000 26112/32000 (82%)] Loss: 0.54053 (QuantReg: 12.22573) QuantErr: 12.22573 batch_time=0.38067 
Train Epoch: 19 [821/1000 26272/32000 (82%)] Loss: 0.39515 (QuantReg: 13.01699) QuantErr: 13.01699 batch_time=0.46870 
Train Epoch: 19 [826/1000 26432/32000 (83%)] Loss: 0.46319 (QuantReg: 12.38276) QuantErr: 12.38276 batch_time=0.49267 
Train Epoch: 19 [831/1000 26592/32000 (83%)] Loss: 0.50629 (QuantReg: 11.74316) QuantErr: 11.74316 batch_time=0.36169 
Train Epoch: 19 [836/1000 26752/32000 (84%)] Loss: 0.58185 (QuantReg: 12.77772) QuantErr: 12.77772 batch_time=0.37239 
Train Epoch: 19 [841/1000 26912/32000 (84%)] Loss: 0.27532 (QuantReg: 11.82625) QuantErr: 11.82625 batch_time=0.35936 
Train Epoch: 19 [846/1000 27072/32000 (85%)] Loss: 0.47932 (QuantReg: 12.70481) QuantErr: 12.70481 batch_time=0.39080 
Train Epoch: 19 [851/1000 27232/32000 (85%)] Loss: 0.56954 (QuantReg: 12.32968) QuantErr: 12.32968 batch_time=0.46310 
Train Epoch: 19 [856/1000 27392/32000 (86%)] Loss: 0.43915 (QuantReg: 12.90444) QuantErr: 12.90444 batch_time=0.44492 
Train Epoch: 19 [861/1000 27552/32000 (86%)] Loss: 0.30286 (QuantReg: 11.56012) QuantErr: 11.56012 batch_time=0.41992 
Train Epoch: 19 [866/1000 27712/32000 (87%)] Loss: 0.72688 (QuantReg: 12.09594) QuantErr: 12.09594 batch_time=0.61536 
Train Epoch: 19 [871/1000 27872/32000 (87%)] Loss: 0.29205 (QuantReg: 11.89336) QuantErr: 11.89336 batch_time=0.35931 
Train Epoch: 19 [876/1000 28032/32000 (88%)] Loss: 0.54025 (QuantReg: 12.16646) QuantErr: 12.16646 batch_time=0.36307 
Train Epoch: 19 [881/1000 28192/32000 (88%)] Loss: 0.45614 (QuantReg: 13.09761) QuantErr: 13.09761 batch_time=0.34594 
Train Epoch: 19 [886/1000 28352/32000 (89%)] Loss: 0.63097 (QuantReg: 11.67811) QuantErr: 11.67811 batch_time=0.36882 
Train Epoch: 19 [891/1000 28512/32000 (89%)] Loss: 0.75615 (QuantReg: 10.95779) QuantErr: 10.95779 batch_time=0.41244 
Train Epoch: 19 [896/1000 28672/32000 (90%)] Loss: 1.00094 (QuantReg: 12.14466) QuantErr: 12.14466 batch_time=0.38344 
Train Epoch: 19 [901/1000 28832/32000 (90%)] Loss: 0.68242 (QuantReg: 12.29056) QuantErr: 12.29056 batch_time=0.34684 
Train Epoch: 19 [906/1000 28992/32000 (91%)] Loss: 0.60515 (QuantReg: 12.40662) QuantErr: 12.40662 batch_time=0.38140 
Train Epoch: 19 [911/1000 29152/32000 (91%)] Loss: 0.71986 (QuantReg: 12.23238) QuantErr: 12.23238 batch_time=0.40353 
Train Epoch: 19 [916/1000 29312/32000 (92%)] Loss: 0.49970 (QuantReg: 12.28944) QuantErr: 12.28944 batch_time=0.36448 
Train Epoch: 19 [921/1000 29472/32000 (92%)] Loss: 0.78343 (QuantReg: 12.60567) QuantErr: 12.60567 batch_time=0.37111 
Train Epoch: 19 [926/1000 29632/32000 (93%)] Loss: 0.27691 (QuantReg: 12.87522) QuantErr: 12.87522 batch_time=0.34586 
Train Epoch: 19 [931/1000 29792/32000 (93%)] Loss: 0.41561 (QuantReg: 12.31695) QuantErr: 12.31695 batch_time=0.46171 
Train Epoch: 19 [936/1000 29952/32000 (94%)] Loss: 0.46768 (QuantReg: 11.57112) QuantErr: 11.57112 batch_time=0.42232 
Train Epoch: 19 [941/1000 30112/32000 (94%)] Loss: 1.27109 (QuantReg: 11.73182) QuantErr: 11.73182 batch_time=0.38811 
Train Epoch: 19 [946/1000 30272/32000 (95%)] Loss: 0.34855 (QuantReg: 11.75292) QuantErr: 11.75292 batch_time=0.37694 
Train Epoch: 19 [951/1000 30432/32000 (95%)] Loss: 0.97892 (QuantReg: 11.62436) QuantErr: 11.62436 batch_time=0.40393 
Train Epoch: 19 [956/1000 30592/32000 (96%)] Loss: 0.50832 (QuantReg: 12.56693) QuantErr: 12.56693 batch_time=0.40606 
Train Epoch: 19 [961/1000 30752/32000 (96%)] Loss: 0.60043 (QuantReg: 12.67777) QuantErr: 12.67777 batch_time=1.82634 
Train Epoch: 19 [966/1000 30912/32000 (97%)] Loss: 0.68537 (QuantReg: 12.10971) QuantErr: 12.10971 batch_time=0.44744 
Train Epoch: 19 [971/1000 31072/32000 (97%)] Loss: 0.64376 (QuantReg: 12.34297) QuantErr: 12.34297 batch_time=0.36912 
Train Epoch: 19 [976/1000 31232/32000 (98%)] Loss: 0.33650 (QuantReg: 12.34377) QuantErr: 12.34377 batch_time=0.43059 
Train Epoch: 19 [981/1000 31392/32000 (98%)] Loss: 0.43608 (QuantReg: 12.36088) QuantErr: 12.36088 batch_time=0.39643 
Train Epoch: 19 [986/1000 31552/32000 (99%)] Loss: 0.38324 (QuantReg: 12.90037) QuantErr: 12.90037 batch_time=0.36610 
Train Epoch: 19 [991/1000 31712/32000 (99%)] Loss: 0.32512 (QuantReg: 12.33262) QuantErr: 12.33262 batch_time=0.42509 
Train Epoch: 19 [996/1000 31872/32000 (100%)] Loss: 0.48573 (QuantReg: 12.91775) QuantErr: 12.91775 batch_time=0.43088 
Train Epoch: 19 codebook_update_time=1.96112
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch19.pth ...
Done in 4.230s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 0.47830257736891507
 quant_reg      : 12.267734651565553
 quant_err      : 12.267734651565553
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 19000
 MSRVTT_full_val/t2v_metrics/R1: 27.766599597585515
 MSRVTT_full_val/t2v_metrics/R5: 64.58752515090544
 MSRVTT_full_val/t2v_metrics/R10: 77.2635814889336
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.09456740442656
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.746628495778786
 MSRVTT_full_val/v2t_metrics/R1: 33.40040241448692
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.152917505030181
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.445063404513014
 MSRVTT_full_test/t2v_metrics/R1: 11.103678929765886
 MSRVTT_full_test/t2v_metrics/R5: 33.11036789297659
 MSRVTT_full_test/t2v_metrics/R10: 47.22408026755853
 MSRVTT_full_test/t2v_metrics/R50: 79.63210702341136
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.25284280936455
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.893939960506504
 MSRVTT_full_test/v2t_metrics/R1: 13.91304347826087
 MSRVTT_full_test/v2t_metrics/R5: 38.66220735785953
 MSRVTT_full_test/v2t_metrics/R10: 54.080267558528426
 MSRVTT_full_test/v2t_metrics/R50: 85.08361204013377
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.32675585284281
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.755010045607506
 mnt_best       : 26.059370147275818
 not_improved_count: 2
Train Epoch: 20 [1/1000 32/32000 (0%)] Loss: 0.29509 (QuantReg: 12.02446) QuantErr: 12.02446 batch_time=30.03877 
Train Epoch: 20 [6/1000 192/32000 (1%)] Loss: 0.52082 (QuantReg: 11.46974) QuantErr: 11.46974 batch_time=0.37326 
Train Epoch: 20 [11/1000 352/32000 (1%)] Loss: 0.32637 (QuantReg: 12.47333) QuantErr: 12.47333 batch_time=0.35462 
Train Epoch: 20 [16/1000 512/32000 (2%)] Loss: 0.32267 (QuantReg: 12.51945) QuantErr: 12.51945 batch_time=0.42220 
Train Epoch: 20 [21/1000 672/32000 (2%)] Loss: 0.61757 (QuantReg: 12.16491) QuantErr: 12.16491 batch_time=0.34609 
Train Epoch: 20 [26/1000 832/32000 (3%)] Loss: 0.49692 (QuantReg: 12.28327) QuantErr: 12.28327 batch_time=0.36270 
Train Epoch: 20 [31/1000 992/32000 (3%)] Loss: 0.35105 (QuantReg: 12.41019) QuantErr: 12.41019 batch_time=0.35078 
Train Epoch: 20 [36/1000 1152/32000 (4%)] Loss: 0.44019 (QuantReg: 12.50741) QuantErr: 12.50741 batch_time=0.34701 
Train Epoch: 20 [41/1000 1312/32000 (4%)] Loss: 0.57561 (QuantReg: 11.42043) QuantErr: 11.42043 batch_time=0.34956 
Train Epoch: 20 [46/1000 1472/32000 (5%)] Loss: 0.21055 (QuantReg: 12.53832) QuantErr: 12.53832 batch_time=0.51151 
Train Epoch: 20 [51/1000 1632/32000 (5%)] Loss: 0.29871 (QuantReg: 11.58717) QuantErr: 11.58717 batch_time=0.35478 
Train Epoch: 20 [56/1000 1792/32000 (6%)] Loss: 0.40482 (QuantReg: 12.18471) QuantErr: 12.18471 batch_time=0.38751 
Train Epoch: 20 [61/1000 1952/32000 (6%)] Loss: 0.35995 (QuantReg: 12.02729) QuantErr: 12.02729 batch_time=0.35047 
Train Epoch: 20 [66/1000 2112/32000 (7%)] Loss: 0.47511 (QuantReg: 12.16789) QuantErr: 12.16789 batch_time=0.46874 
Train Epoch: 20 [71/1000 2272/32000 (7%)] Loss: 0.45759 (QuantReg: 12.33844) QuantErr: 12.33844 batch_time=0.35961 
Train Epoch: 20 [76/1000 2432/32000 (8%)] Loss: 0.62060 (QuantReg: 11.77770) QuantErr: 11.77770 batch_time=0.37036 
Train Epoch: 20 [81/1000 2592/32000 (8%)] Loss: 0.49000 (QuantReg: 12.53767) QuantErr: 12.53767 batch_time=0.38375 
Train Epoch: 20 [86/1000 2752/32000 (9%)] Loss: 0.12006 (QuantReg: 13.26012) QuantErr: 13.26012 batch_time=0.41288 
Train Epoch: 20 [91/1000 2912/32000 (9%)] Loss: 0.25788 (QuantReg: 12.50118) QuantErr: 12.50118 batch_time=0.36583 
Train Epoch: 20 [96/1000 3072/32000 (10%)] Loss: 0.37969 (QuantReg: 12.91484) QuantErr: 12.91484 batch_time=0.36011 
Train Epoch: 20 [101/1000 3232/32000 (10%)] Loss: 0.73680 (QuantReg: 11.87158) QuantErr: 11.87158 batch_time=0.35692 
Train Epoch: 20 [106/1000 3392/32000 (11%)] Loss: 0.30776 (QuantReg: 12.14050) QuantErr: 12.14050 batch_time=0.39627 
Train Epoch: 20 [111/1000 3552/32000 (11%)] Loss: 0.28320 (QuantReg: 12.74398) QuantErr: 12.74398 batch_time=0.36652 
Train Epoch: 20 [116/1000 3712/32000 (12%)] Loss: 0.47369 (QuantReg: 11.74546) QuantErr: 11.74546 batch_time=0.36782 
Train Epoch: 20 [121/1000 3872/32000 (12%)] Loss: 0.66302 (QuantReg: 12.40333) QuantErr: 12.40333 batch_time=0.35690 
Train Epoch: 20 [126/1000 4032/32000 (13%)] Loss: 0.34963 (QuantReg: 12.57570) QuantErr: 12.57570 batch_time=0.35551 
Train Epoch: 20 [131/1000 4192/32000 (13%)] Loss: 0.48232 (QuantReg: 11.70985) QuantErr: 11.70985 batch_time=0.41800 
Train Epoch: 20 [136/1000 4352/32000 (14%)] Loss: 0.31986 (QuantReg: 12.00667) QuantErr: 12.00667 batch_time=0.35567 
Train Epoch: 20 [141/1000 4512/32000 (14%)] Loss: 0.27221 (QuantReg: 12.33478) QuantErr: 12.33478 batch_time=1.13669 
Train Epoch: 20 [146/1000 4672/32000 (15%)] Loss: 0.21714 (QuantReg: 12.47933) QuantErr: 12.47933 batch_time=0.37412 
Train Epoch: 20 [151/1000 4832/32000 (15%)] Loss: 0.39747 (QuantReg: 11.70989) QuantErr: 11.70989 batch_time=0.47070 
Train Epoch: 20 [156/1000 4992/32000 (16%)] Loss: 0.06775 (QuantReg: 12.03295) QuantErr: 12.03295 batch_time=0.35773 
Train Epoch: 20 [161/1000 5152/32000 (16%)] Loss: 0.42544 (QuantReg: 12.23381) QuantErr: 12.23381 batch_time=0.42103 
Train Epoch: 20 [166/1000 5312/32000 (17%)] Loss: 0.22965 (QuantReg: 12.46223) QuantErr: 12.46223 batch_time=0.34490 
Train Epoch: 20 [171/1000 5472/32000 (17%)] Loss: 0.36263 (QuantReg: 12.42805) QuantErr: 12.42805 batch_time=0.42186 
Train Epoch: 20 [176/1000 5632/32000 (18%)] Loss: 0.43328 (QuantReg: 12.63986) QuantErr: 12.63986 batch_time=0.35408 
Train Epoch: 20 [181/1000 5792/32000 (18%)] Loss: 0.67892 (QuantReg: 11.99658) QuantErr: 11.99658 batch_time=0.34643 
Train Epoch: 20 [186/1000 5952/32000 (19%)] Loss: 0.28386 (QuantReg: 12.39933) QuantErr: 12.39933 batch_time=0.34738 
Train Epoch: 20 [191/1000 6112/32000 (19%)] Loss: 0.29768 (QuantReg: 11.76524) QuantErr: 11.76524 batch_time=0.37464 
Train Epoch: 20 [196/1000 6272/32000 (20%)] Loss: 0.33186 (QuantReg: 12.00635) QuantErr: 12.00635 batch_time=0.42763 
Train Epoch: 20 [201/1000 6432/32000 (20%)] Loss: 0.27125 (QuantReg: 12.96024) QuantErr: 12.96024 batch_time=0.38997 
Train Epoch: 20 [206/1000 6592/32000 (21%)] Loss: 0.46524 (QuantReg: 12.11535) QuantErr: 12.11535 batch_time=0.38792 
Train Epoch: 20 [211/1000 6752/32000 (21%)] Loss: 0.23669 (QuantReg: 12.49775) QuantErr: 12.49775 batch_time=0.39419 
Train Epoch: 20 [216/1000 6912/32000 (22%)] Loss: 0.82361 (QuantReg: 11.68902) QuantErr: 11.68902 batch_time=0.36849 
Train Epoch: 20 [221/1000 7072/32000 (22%)] Loss: 0.33825 (QuantReg: 12.80947) QuantErr: 12.80947 batch_time=0.38853 
Train Epoch: 20 [226/1000 7232/32000 (23%)] Loss: 0.29468 (QuantReg: 12.36273) QuantErr: 12.36273 batch_time=0.34968 
Train Epoch: 20 [231/1000 7392/32000 (23%)] Loss: 0.53247 (QuantReg: 12.27302) QuantErr: 12.27302 batch_time=0.39017 
Train Epoch: 20 [236/1000 7552/32000 (24%)] Loss: 0.23532 (QuantReg: 12.36262) QuantErr: 12.36262 batch_time=0.37428 
Train Epoch: 20 [241/1000 7712/32000 (24%)] Loss: 0.23507 (QuantReg: 12.51533) QuantErr: 12.51533 batch_time=0.34899 
Train Epoch: 20 [246/1000 7872/32000 (25%)] Loss: 0.72927 (QuantReg: 12.76143) QuantErr: 12.76143 batch_time=0.36744 
Train Epoch: 20 [251/1000 8032/32000 (25%)] Loss: 0.23768 (QuantReg: 12.42413) QuantErr: 12.42413 batch_time=0.34939 
Train Epoch: 20 [256/1000 8192/32000 (26%)] Loss: 0.29780 (QuantReg: 12.02129) QuantErr: 12.02129 batch_time=0.34282 
Train Epoch: 20 [261/1000 8352/32000 (26%)] Loss: 0.18588 (QuantReg: 12.21011) QuantErr: 12.21011 batch_time=0.88360 
Train Epoch: 20 [266/1000 8512/32000 (27%)] Loss: 0.27029 (QuantReg: 12.02023) QuantErr: 12.02023 batch_time=0.34859 
Train Epoch: 20 [271/1000 8672/32000 (27%)] Loss: 0.39306 (QuantReg: 11.09604) QuantErr: 11.09604 batch_time=0.41773 
Train Epoch: 20 [276/1000 8832/32000 (28%)] Loss: 0.35653 (QuantReg: 12.39963) QuantErr: 12.39963 batch_time=0.68674 
Train Epoch: 20 [281/1000 8992/32000 (28%)] Loss: 0.69064 (QuantReg: 12.05626) QuantErr: 12.05626 batch_time=0.36332 
Train Epoch: 20 [286/1000 9152/32000 (29%)] Loss: 0.28528 (QuantReg: 12.29536) QuantErr: 12.29536 batch_time=0.38984 
Train Epoch: 20 [291/1000 9312/32000 (29%)] Loss: 0.45002 (QuantReg: 11.73421) QuantErr: 11.73421 batch_time=0.34572 
Train Epoch: 20 [296/1000 9472/32000 (30%)] Loss: 0.27613 (QuantReg: 12.68130) QuantErr: 12.68130 batch_time=0.34790 
Train Epoch: 20 [301/1000 9632/32000 (30%)] Loss: 0.37668 (QuantReg: 12.10552) QuantErr: 12.10552 batch_time=0.34894 
Train Epoch: 20 [306/1000 9792/32000 (31%)] Loss: 0.17188 (QuantReg: 12.88472) QuantErr: 12.88472 batch_time=0.34956 
Train Epoch: 20 [311/1000 9952/32000 (31%)] Loss: 0.26503 (QuantReg: 12.62666) QuantErr: 12.62666 batch_time=0.36273 
Train Epoch: 20 [316/1000 10112/32000 (32%)] Loss: 0.28649 (QuantReg: 12.39606) QuantErr: 12.39606 batch_time=0.34912 
Train Epoch: 20 [321/1000 10272/32000 (32%)] Loss: 0.37286 (QuantReg: 12.71511) QuantErr: 12.71511 batch_time=0.35434 
Train Epoch: 20 [326/1000 10432/32000 (33%)] Loss: 0.23186 (QuantReg: 11.87354) QuantErr: 11.87354 batch_time=0.74285 
Train Epoch: 20 [331/1000 10592/32000 (33%)] Loss: 0.53516 (QuantReg: 12.17522) QuantErr: 12.17522 batch_time=0.37467 
Train Epoch: 20 [336/1000 10752/32000 (34%)] Loss: 0.53451 (QuantReg: 12.40457) QuantErr: 12.40457 batch_time=0.42855 
Train Epoch: 20 [341/1000 10912/32000 (34%)] Loss: 0.43124 (QuantReg: 11.77778) QuantErr: 11.77778 batch_time=0.34605 
Train Epoch: 20 [346/1000 11072/32000 (35%)] Loss: 0.61895 (QuantReg: 12.55393) QuantErr: 12.55393 batch_time=0.34572 
Train Epoch: 20 [351/1000 11232/32000 (35%)] Loss: 0.26818 (QuantReg: 12.61643) QuantErr: 12.61643 batch_time=0.36475 
Train Epoch: 20 [356/1000 11392/32000 (36%)] Loss: 0.30774 (QuantReg: 11.84821) QuantErr: 11.84821 batch_time=0.42056 
Train Epoch: 20 [361/1000 11552/32000 (36%)] Loss: 0.91608 (QuantReg: 12.20388) QuantErr: 12.20388 batch_time=0.41756 
Train Epoch: 20 [366/1000 11712/32000 (37%)] Loss: 0.68794 (QuantReg: 11.76651) QuantErr: 11.76651 batch_time=0.54433 
Train Epoch: 20 [371/1000 11872/32000 (37%)] Loss: 0.50919 (QuantReg: 12.06495) QuantErr: 12.06495 batch_time=0.35567 
Train Epoch: 20 [376/1000 12032/32000 (38%)] Loss: 0.24629 (QuantReg: 13.06633) QuantErr: 13.06633 batch_time=0.34793 
Train Epoch: 20 [381/1000 12192/32000 (38%)] Loss: 0.51078 (QuantReg: 12.54651) QuantErr: 12.54651 batch_time=0.36472 
Train Epoch: 20 [386/1000 12352/32000 (39%)] Loss: 0.34304 (QuantReg: 12.44274) QuantErr: 12.44274 batch_time=0.50072 
Train Epoch: 20 [391/1000 12512/32000 (39%)] Loss: 0.84216 (QuantReg: 12.45248) QuantErr: 12.45248 batch_time=0.44949 
Train Epoch: 20 [396/1000 12672/32000 (40%)] Loss: 0.28006 (QuantReg: 12.02404) QuantErr: 12.02404 batch_time=0.40105 
Train Epoch: 20 [401/1000 12832/32000 (40%)] Loss: 0.58445 (QuantReg: 12.25732) QuantErr: 12.25732 batch_time=0.36533 
Train Epoch: 20 [406/1000 12992/32000 (41%)] Loss: 0.24561 (QuantReg: 12.54919) QuantErr: 12.54919 batch_time=0.41640 
Train Epoch: 20 [411/1000 13152/32000 (41%)] Loss: 0.66965 (QuantReg: 11.70555) QuantErr: 11.70555 batch_time=0.39641 
Train Epoch: 20 [416/1000 13312/32000 (42%)] Loss: 0.55654 (QuantReg: 12.00456) QuantErr: 12.00456 batch_time=0.38831 
Train Epoch: 20 [421/1000 13472/32000 (42%)] Loss: 0.48837 (QuantReg: 11.63538) QuantErr: 11.63538 batch_time=0.35377 
Train Epoch: 20 [426/1000 13632/32000 (43%)] Loss: 0.53515 (QuantReg: 12.17865) QuantErr: 12.17865 batch_time=0.44307 
Train Epoch: 20 [431/1000 13792/32000 (43%)] Loss: 0.37873 (QuantReg: 12.16902) QuantErr: 12.16902 batch_time=0.35462 
Train Epoch: 20 [436/1000 13952/32000 (44%)] Loss: 0.88639 (QuantReg: 11.34231) QuantErr: 11.34231 batch_time=0.41315 
Train Epoch: 20 [441/1000 14112/32000 (44%)] Loss: 0.12345 (QuantReg: 12.34786) QuantErr: 12.34786 batch_time=0.34439 
Train Epoch: 20 [446/1000 14272/32000 (45%)] Loss: 0.23808 (QuantReg: 12.13601) QuantErr: 12.13601 batch_time=0.35326 
Train Epoch: 20 [451/1000 14432/32000 (45%)] Loss: 0.31675 (QuantReg: 13.12121) QuantErr: 13.12121 batch_time=0.34957 
Train Epoch: 20 [456/1000 14592/32000 (46%)] Loss: 0.33199 (QuantReg: 12.44350) QuantErr: 12.44350 batch_time=0.42827 
Train Epoch: 20 [461/1000 14752/32000 (46%)] Loss: 0.57784 (QuantReg: 12.96768) QuantErr: 12.96768 batch_time=1.16439 
Train Epoch: 20 [466/1000 14912/32000 (47%)] Loss: 0.50372 (QuantReg: 12.36537) QuantErr: 12.36537 batch_time=0.40420 
Train Epoch: 20 [471/1000 15072/32000 (47%)] Loss: 0.18541 (QuantReg: 12.41603) QuantErr: 12.41603 batch_time=0.52834 
Train Epoch: 20 [476/1000 15232/32000 (48%)] Loss: 0.47495 (QuantReg: 12.35873) QuantErr: 12.35873 batch_time=0.42602 
Train Epoch: 20 [481/1000 15392/32000 (48%)] Loss: 0.80232 (QuantReg: 12.07502) QuantErr: 12.07502 batch_time=0.49601 
Train Epoch: 20 [486/1000 15552/32000 (49%)] Loss: 0.43098 (QuantReg: 11.83340) QuantErr: 11.83340 batch_time=0.36593 
Train Epoch: 20 [491/1000 15712/32000 (49%)] Loss: 0.72175 (QuantReg: 11.92793) QuantErr: 11.92793 batch_time=0.40085 
Train Epoch: 20 [496/1000 15872/32000 (50%)] Loss: 0.49612 (QuantReg: 12.17287) QuantErr: 12.17287 batch_time=0.36831 
Train Epoch: 20 [501/1000 16032/32000 (50%)] Loss: 0.26262 (QuantReg: 13.04224) QuantErr: 13.04224 batch_time=0.34510 
Train Epoch: 20 [506/1000 16192/32000 (51%)] Loss: 0.52520 (QuantReg: 12.01970) QuantErr: 12.01970 batch_time=0.34815 
Train Epoch: 20 [511/1000 16352/32000 (51%)] Loss: 0.34353 (QuantReg: 12.39686) QuantErr: 12.39686 batch_time=0.40393 
Train Epoch: 20 [516/1000 16512/32000 (52%)] Loss: 0.42812 (QuantReg: 13.31582) QuantErr: 13.31582 batch_time=0.40045 
Train Epoch: 20 [521/1000 16672/32000 (52%)] Loss: 0.58887 (QuantReg: 12.48882) QuantErr: 12.48882 batch_time=0.37882 
Train Epoch: 20 [526/1000 16832/32000 (53%)] Loss: 0.66472 (QuantReg: 12.54611) QuantErr: 12.54611 batch_time=0.36127 
Train Epoch: 20 [531/1000 16992/32000 (53%)] Loss: 0.16894 (QuantReg: 11.80086) QuantErr: 11.80086 batch_time=0.37664 
Train Epoch: 20 [536/1000 17152/32000 (54%)] Loss: 0.43032 (QuantReg: 12.54319) QuantErr: 12.54319 batch_time=0.36165 
Train Epoch: 20 [541/1000 17312/32000 (54%)] Loss: 0.22357 (QuantReg: 12.15312) QuantErr: 12.15312 batch_time=0.35632 
Train Epoch: 20 [546/1000 17472/32000 (55%)] Loss: 0.58541 (QuantReg: 12.41143) QuantErr: 12.41143 batch_time=0.37183 
Train Epoch: 20 [551/1000 17632/32000 (55%)] Loss: 0.61117 (QuantReg: 12.54731) QuantErr: 12.54731 batch_time=0.36466 
Train Epoch: 20 [556/1000 17792/32000 (56%)] Loss: 0.16871 (QuantReg: 13.04693) QuantErr: 13.04693 batch_time=0.44009 
Train Epoch: 20 [561/1000 17952/32000 (56%)] Loss: 0.67264 (QuantReg: 11.29176) QuantErr: 11.29176 batch_time=0.50396 
Train Epoch: 20 [566/1000 18112/32000 (57%)] Loss: 0.47942 (QuantReg: 12.59222) QuantErr: 12.59222 batch_time=0.35021 
Train Epoch: 20 [571/1000 18272/32000 (57%)] Loss: 0.43085 (QuantReg: 12.16194) QuantErr: 12.16194 batch_time=0.37800 
Train Epoch: 20 [576/1000 18432/32000 (58%)] Loss: 0.34892 (QuantReg: 12.74110) QuantErr: 12.74110 batch_time=0.37980 
Train Epoch: 20 [581/1000 18592/32000 (58%)] Loss: 0.19445 (QuantReg: 12.58081) QuantErr: 12.58081 batch_time=0.83633 
Train Epoch: 20 [586/1000 18752/32000 (59%)] Loss: 0.35102 (QuantReg: 11.77624) QuantErr: 11.77624 batch_time=0.36169 
Train Epoch: 20 [591/1000 18912/32000 (59%)] Loss: 0.46077 (QuantReg: 13.16438) QuantErr: 13.16438 batch_time=0.37128 
Train Epoch: 20 [596/1000 19072/32000 (60%)] Loss: 0.44292 (QuantReg: 12.53691) QuantErr: 12.53691 batch_time=0.64586 
Train Epoch: 20 [601/1000 19232/32000 (60%)] Loss: 0.21417 (QuantReg: 12.74166) QuantErr: 12.74166 batch_time=0.41700 
Train Epoch: 20 [606/1000 19392/32000 (61%)] Loss: 0.37170 (QuantReg: 12.00811) QuantErr: 12.00811 batch_time=0.35274 
Train Epoch: 20 [611/1000 19552/32000 (61%)] Loss: 0.24743 (QuantReg: 12.87199) QuantErr: 12.87199 batch_time=0.37013 
Train Epoch: 20 [616/1000 19712/32000 (62%)] Loss: 0.36993 (QuantReg: 12.29828) QuantErr: 12.29828 batch_time=0.34912 
Train Epoch: 20 [621/1000 19872/32000 (62%)] Loss: 0.53413 (QuantReg: 12.27981) QuantErr: 12.27981 batch_time=0.42778 
Train Epoch: 20 [626/1000 20032/32000 (63%)] Loss: 0.35519 (QuantReg: 12.36621) QuantErr: 12.36621 batch_time=0.36887 
Train Epoch: 20 [631/1000 20192/32000 (63%)] Loss: 0.36271 (QuantReg: 12.93322) QuantErr: 12.93322 batch_time=0.35853 
Train Epoch: 20 [636/1000 20352/32000 (64%)] Loss: 0.49752 (QuantReg: 13.03040) QuantErr: 13.03040 batch_time=0.34825 
Train Epoch: 20 [641/1000 20512/32000 (64%)] Loss: 0.26406 (QuantReg: 12.03654) QuantErr: 12.03654 batch_time=0.34388 
Train Epoch: 20 [646/1000 20672/32000 (65%)] Loss: 0.54139 (QuantReg: 12.28223) QuantErr: 12.28223 batch_time=0.34666 
Train Epoch: 20 [651/1000 20832/32000 (65%)] Loss: 0.58776 (QuantReg: 12.33508) QuantErr: 12.33508 batch_time=0.41255 
Train Epoch: 20 [656/1000 20992/32000 (66%)] Loss: 0.19308 (QuantReg: 12.42011) QuantErr: 12.42011 batch_time=0.41182 
Train Epoch: 20 [661/1000 21152/32000 (66%)] Loss: 0.26723 (QuantReg: 12.98901) QuantErr: 12.98901 batch_time=0.36217 
Train Epoch: 20 [666/1000 21312/32000 (67%)] Loss: 0.53035 (QuantReg: 12.36824) QuantErr: 12.36824 batch_time=0.36525 
Train Epoch: 20 [671/1000 21472/32000 (67%)] Loss: 0.53253 (QuantReg: 12.93520) QuantErr: 12.93520 batch_time=0.43151 
Train Epoch: 20 [676/1000 21632/32000 (68%)] Loss: 0.23169 (QuantReg: 12.45488) QuantErr: 12.45488 batch_time=0.35698 
Train Epoch: 20 [681/1000 21792/32000 (68%)] Loss: 0.86860 (QuantReg: 11.55993) QuantErr: 11.55993 batch_time=0.42156 
Train Epoch: 20 [686/1000 21952/32000 (69%)] Loss: 0.93879 (QuantReg: 12.16978) QuantErr: 12.16978 batch_time=0.54180 
Train Epoch: 20 [691/1000 22112/32000 (69%)] Loss: 0.26656 (QuantReg: 12.88599) QuantErr: 12.88599 batch_time=0.34975 
Train Epoch: 20 [696/1000 22272/32000 (70%)] Loss: 0.72261 (QuantReg: 11.83862) QuantErr: 11.83862 batch_time=0.36589 
Train Epoch: 20 [701/1000 22432/32000 (70%)] Loss: 0.19612 (QuantReg: 12.34868) QuantErr: 12.34868 batch_time=0.37050 
Train Epoch: 20 [706/1000 22592/32000 (71%)] Loss: 0.70932 (QuantReg: 12.52315) QuantErr: 12.52315 batch_time=0.47408 
Train Epoch: 20 [711/1000 22752/32000 (71%)] Loss: 0.38092 (QuantReg: 12.21218) QuantErr: 12.21218 batch_time=0.35476 
Train Epoch: 20 [716/1000 22912/32000 (72%)] Loss: 0.32400 (QuantReg: 11.89183) QuantErr: 11.89183 batch_time=0.40770 
Train Epoch: 20 [721/1000 23072/32000 (72%)] Loss: 0.35431 (QuantReg: 12.11188) QuantErr: 12.11188 batch_time=0.39553 
Train Epoch: 20 [726/1000 23232/32000 (73%)] Loss: 0.49473 (QuantReg: 12.00932) QuantErr: 12.00932 batch_time=0.46543 
Train Epoch: 20 [731/1000 23392/32000 (73%)] Loss: 0.35355 (QuantReg: 11.81678) QuantErr: 11.81678 batch_time=0.39744 
Train Epoch: 20 [736/1000 23552/32000 (74%)] Loss: 0.33199 (QuantReg: 11.90038) QuantErr: 11.90038 batch_time=0.35030 
Train Epoch: 20 [741/1000 23712/32000 (74%)] Loss: 0.21643 (QuantReg: 12.88832) QuantErr: 12.88832 batch_time=0.36035 
Train Epoch: 20 [746/1000 23872/32000 (75%)] Loss: 0.42291 (QuantReg: 12.59386) QuantErr: 12.59386 batch_time=0.43849 
Train Epoch: 20 [751/1000 24032/32000 (75%)] Loss: 0.40105 (QuantReg: 12.65573) QuantErr: 12.65573 batch_time=0.36819 
Train Epoch: 20 [756/1000 24192/32000 (76%)] Loss: 0.45783 (QuantReg: 12.20407) QuantErr: 12.20407 batch_time=0.38019 
Train Epoch: 20 [761/1000 24352/32000 (76%)] Loss: 0.61338 (QuantReg: 11.78239) QuantErr: 11.78239 batch_time=0.35833 
Train Epoch: 20 [766/1000 24512/32000 (77%)] Loss: 0.69029 (QuantReg: 11.66231) QuantErr: 11.66231 batch_time=0.34937 
Train Epoch: 20 [771/1000 24672/32000 (77%)] Loss: 0.69194 (QuantReg: 12.74597) QuantErr: 12.74597 batch_time=0.37902 
Train Epoch: 20 [776/1000 24832/32000 (78%)] Loss: 0.25175 (QuantReg: 12.94392) QuantErr: 12.94392 batch_time=0.37637 
Train Epoch: 20 [781/1000 24992/32000 (78%)] Loss: 0.27793 (QuantReg: 13.18710) QuantErr: 13.18710 batch_time=0.93295 
Train Epoch: 20 [786/1000 25152/32000 (79%)] Loss: 0.39777 (QuantReg: 12.81620) QuantErr: 12.81620 batch_time=0.35293 
Train Epoch: 20 [791/1000 25312/32000 (79%)] Loss: 0.49657 (QuantReg: 12.52531) QuantErr: 12.52531 batch_time=0.54754 
Train Epoch: 20 [796/1000 25472/32000 (80%)] Loss: 0.27456 (QuantReg: 12.62864) QuantErr: 12.62864 batch_time=0.37312 
Train Epoch: 20 [801/1000 25632/32000 (80%)] Loss: 0.28781 (QuantReg: 12.83282) QuantErr: 12.83282 batch_time=0.41910 
Train Epoch: 20 [806/1000 25792/32000 (81%)] Loss: 0.45119 (QuantReg: 12.74271) QuantErr: 12.74271 batch_time=0.44767 
Train Epoch: 20 [811/1000 25952/32000 (81%)] Loss: 0.60953 (QuantReg: 11.69136) QuantErr: 11.69136 batch_time=0.39219 
Train Epoch: 20 [816/1000 26112/32000 (82%)] Loss: 0.28775 (QuantReg: 12.74988) QuantErr: 12.74988 batch_time=0.46941 
Train Epoch: 20 [821/1000 26272/32000 (82%)] Loss: 0.89234 (QuantReg: 12.40504) QuantErr: 12.40504 batch_time=0.38315 
Train Epoch: 20 [826/1000 26432/32000 (83%)] Loss: 0.42970 (QuantReg: 12.90495) QuantErr: 12.90495 batch_time=0.35808 
Train Epoch: 20 [831/1000 26592/32000 (83%)] Loss: 0.15715 (QuantReg: 12.93908) QuantErr: 12.93908 batch_time=0.34646 
Train Epoch: 20 [836/1000 26752/32000 (84%)] Loss: 0.38619 (QuantReg: 12.66735) QuantErr: 12.66735 batch_time=0.42969 
Train Epoch: 20 [841/1000 26912/32000 (84%)] Loss: 0.34616 (QuantReg: 12.89887) QuantErr: 12.89887 batch_time=0.39413 
Train Epoch: 20 [846/1000 27072/32000 (85%)] Loss: 0.25073 (QuantReg: 12.42891) QuantErr: 12.42891 batch_time=0.35923 
Train Epoch: 20 [851/1000 27232/32000 (85%)] Loss: 0.22923 (QuantReg: 12.68340) QuantErr: 12.68340 batch_time=0.39175 
Train Epoch: 20 [856/1000 27392/32000 (86%)] Loss: 0.34623 (QuantReg: 11.84109) QuantErr: 11.84109 batch_time=0.37378 
Train Epoch: 20 [861/1000 27552/32000 (86%)] Loss: 0.66133 (QuantReg: 12.67736) QuantErr: 12.67736 batch_time=0.36347 
Train Epoch: 20 [866/1000 27712/32000 (87%)] Loss: 0.63141 (QuantReg: 12.49003) QuantErr: 12.49003 batch_time=0.41535 
Train Epoch: 20 [871/1000 27872/32000 (87%)] Loss: 0.13689 (QuantReg: 12.44244) QuantErr: 12.44244 batch_time=0.34778 
Train Epoch: 20 [876/1000 28032/32000 (88%)] Loss: 0.77476 (QuantReg: 12.93732) QuantErr: 12.93732 batch_time=0.34646 
Train Epoch: 20 [881/1000 28192/32000 (88%)] Loss: 0.62107 (QuantReg: 12.34473) QuantErr: 12.34473 batch_time=0.38057 
Train Epoch: 20 [886/1000 28352/32000 (89%)] Loss: 0.31347 (QuantReg: 12.94836) QuantErr: 12.94836 batch_time=0.37532 
Train Epoch: 20 [891/1000 28512/32000 (89%)] Loss: 0.25920 (QuantReg: 12.35172) QuantErr: 12.35172 batch_time=0.41009 
Train Epoch: 20 [896/1000 28672/32000 (90%)] Loss: 0.36416 (QuantReg: 12.59992) QuantErr: 12.59992 batch_time=0.39276 
Train Epoch: 20 [901/1000 28832/32000 (90%)] Loss: 0.73674 (QuantReg: 12.64872) QuantErr: 12.64872 batch_time=0.84075 
Train Epoch: 20 [906/1000 28992/32000 (91%)] Loss: 0.36486 (QuantReg: 12.80050) QuantErr: 12.80050 batch_time=0.39897 
Train Epoch: 20 [911/1000 29152/32000 (91%)] Loss: 0.18622 (QuantReg: 12.31879) QuantErr: 12.31879 batch_time=0.43157 
Train Epoch: 20 [916/1000 29312/32000 (92%)] Loss: 0.32719 (QuantReg: 13.24855) QuantErr: 13.24855 batch_time=0.60844 
Train Epoch: 20 [921/1000 29472/32000 (92%)] Loss: 0.80837 (QuantReg: 12.83137) QuantErr: 12.83137 batch_time=0.39878 
Train Epoch: 20 [926/1000 29632/32000 (93%)] Loss: 0.56583 (QuantReg: 12.63855) QuantErr: 12.63855 batch_time=0.36959 
Train Epoch: 20 [931/1000 29792/32000 (93%)] Loss: 0.79499 (QuantReg: 12.48896) QuantErr: 12.48896 batch_time=0.34815 
Train Epoch: 20 [936/1000 29952/32000 (94%)] Loss: 0.48209 (QuantReg: 12.31801) QuantErr: 12.31801 batch_time=0.36987 
Train Epoch: 20 [941/1000 30112/32000 (94%)] Loss: 0.64307 (QuantReg: 12.62396) QuantErr: 12.62396 batch_time=0.39161 
Train Epoch: 20 [946/1000 30272/32000 (95%)] Loss: 0.21289 (QuantReg: 12.84539) QuantErr: 12.84539 batch_time=0.34834 
Train Epoch: 20 [951/1000 30432/32000 (95%)] Loss: 0.76406 (QuantReg: 12.42016) QuantErr: 12.42016 batch_time=0.36152 
Train Epoch: 20 [956/1000 30592/32000 (96%)] Loss: 1.27340 (QuantReg: 11.49638) QuantErr: 11.49638 batch_time=0.36975 
Train Epoch: 20 [961/1000 30752/32000 (96%)] Loss: 0.18768 (QuantReg: 11.87647) QuantErr: 11.87647 batch_time=0.38171 
Train Epoch: 20 [966/1000 30912/32000 (97%)] Loss: 0.49325 (QuantReg: 12.22210) QuantErr: 12.22210 batch_time=0.37650 
Train Epoch: 20 [971/1000 31072/32000 (97%)] Loss: 0.51038 (QuantReg: 12.91908) QuantErr: 12.91908 batch_time=0.37666 
Train Epoch: 20 [976/1000 31232/32000 (98%)] Loss: 0.35619 (QuantReg: 12.01495) QuantErr: 12.01495 batch_time=0.36727 
Train Epoch: 20 [981/1000 31392/32000 (98%)] Loss: 0.13925 (QuantReg: 12.51717) QuantErr: 12.51717 batch_time=0.35099 
Train Epoch: 20 [986/1000 31552/32000 (99%)] Loss: 0.26760 (QuantReg: 11.99166) QuantErr: 11.99166 batch_time=0.36701 
Train Epoch: 20 [991/1000 31712/32000 (99%)] Loss: 0.27909 (QuantReg: 12.52024) QuantErr: 12.52024 batch_time=0.41904 
Train Epoch: 20 [996/1000 31872/32000 (100%)] Loss: 0.50570 (QuantReg: 12.32194) QuantErr: 12.32194 batch_time=0.36480 
Train Epoch: 20 codebook_update_time=1.92661
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch20.pth ...
Done in 5.502s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch20.pth ...
Done in 11.915s
removing stale ckpt [epoch 19] [took 0.03s]
 epoch          : 20
 loss           : 0.45470512871444224
 quant_reg      : 12.336603442192077
 quant_err      : 12.336603442192077
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 20000
 MSRVTT_full_val/t2v_metrics/R1: 30.18108651911469
 MSRVTT_full_val/t2v_metrics/R5: 65.99597585513078
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.408450704225352
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.86667652465941
 MSRVTT_full_val/v2t_metrics/R1: 30.985915492957748
 MSRVTT_full_val/v2t_metrics/R5: 72.03219315895372
 MSRVTT_full_val/v2t_metrics/R10: 83.90342052313883
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.837022132796781
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.21240602565173
 MSRVTT_full_test/t2v_metrics/R1: 11.538461538461538
 MSRVTT_full_test/t2v_metrics/R5: 33.17725752508361
 MSRVTT_full_test/t2v_metrics/R10: 47.25752508361204
 MSRVTT_full_test/t2v_metrics/R50: 79.19732441471572
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.56555183946488
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.251439403069927
 MSRVTT_full_test/v2t_metrics/R1: 14.013377926421406
 MSRVTT_full_test/v2t_metrics/R5: 38.62876254180602
 MSRVTT_full_test/v2t_metrics/R10: 53.04347826086956
 MSRVTT_full_test/v2t_metrics/R50: 84.2809364548495
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.54983277591973
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.62164671841437
 mnt_best       : 26.251439403069927
 not_improved_count: 0
Train Epoch: 21 [1/1000 32/32000 (0%)] Loss: 0.34109 (QuantReg: 12.26601) QuantErr: 12.26601 batch_time=28.00151 
Train Epoch: 21 [6/1000 192/32000 (1%)] Loss: 0.53106 (QuantReg: 12.08251) QuantErr: 12.08251 batch_time=1.99138 
Train Epoch: 21 [11/1000 352/32000 (1%)] Loss: 0.36371 (QuantReg: 11.91299) QuantErr: 11.91299 batch_time=0.37135 
Train Epoch: 21 [16/1000 512/32000 (2%)] Loss: 0.29018 (QuantReg: 12.28243) QuantErr: 12.28243 batch_time=0.37160 
Train Epoch: 21 [21/1000 672/32000 (2%)] Loss: 0.41570 (QuantReg: 13.07847) QuantErr: 13.07847 batch_time=0.35159 
Train Epoch: 21 [26/1000 832/32000 (3%)] Loss: 0.62413 (QuantReg: 12.35091) QuantErr: 12.35091 batch_time=0.36032 
Train Epoch: 21 [31/1000 992/32000 (3%)] Loss: 0.56312 (QuantReg: 12.97622) QuantErr: 12.97622 batch_time=0.35096 
Train Epoch: 21 [36/1000 1152/32000 (4%)] Loss: 0.41323 (QuantReg: 12.76068) QuantErr: 12.76068 batch_time=0.35254 
Train Epoch: 21 [41/1000 1312/32000 (4%)] Loss: 0.47923 (QuantReg: 13.11931) QuantErr: 13.11931 batch_time=0.35326 
Train Epoch: 21 [46/1000 1472/32000 (5%)] Loss: 0.51385 (QuantReg: 12.39307) QuantErr: 12.39307 batch_time=0.51060 
Train Epoch: 21 [51/1000 1632/32000 (5%)] Loss: 0.32000 (QuantReg: 12.39831) QuantErr: 12.39831 batch_time=0.35309 
Train Epoch: 21 [56/1000 1792/32000 (6%)] Loss: 0.59326 (QuantReg: 12.16682) QuantErr: 12.16682 batch_time=0.36043 
Train Epoch: 21 [61/1000 1952/32000 (6%)] Loss: 0.44088 (QuantReg: 11.89345) QuantErr: 11.89345 batch_time=0.35695 
Train Epoch: 21 [66/1000 2112/32000 (7%)] Loss: 0.52982 (QuantReg: 12.63287) QuantErr: 12.63287 batch_time=0.63544 
Train Epoch: 21 [71/1000 2272/32000 (7%)] Loss: 0.48041 (QuantReg: 12.07611) QuantErr: 12.07611 batch_time=0.35132 
Train Epoch: 21 [76/1000 2432/32000 (8%)] Loss: 0.30287 (QuantReg: 12.09453) QuantErr: 12.09453 batch_time=0.35124 
Train Epoch: 21 [81/1000 2592/32000 (8%)] Loss: 0.65692 (QuantReg: 11.97739) QuantErr: 11.97739 batch_time=0.34941 
Train Epoch: 21 [86/1000 2752/32000 (9%)] Loss: 0.28769 (QuantReg: 11.82495) QuantErr: 11.82495 batch_time=0.35176 
Train Epoch: 21 [91/1000 2912/32000 (9%)] Loss: 0.21645 (QuantReg: 12.49970) QuantErr: 12.49970 batch_time=0.44750 
Train Epoch: 21 [96/1000 3072/32000 (10%)] Loss: 0.49602 (QuantReg: 12.55077) QuantErr: 12.55077 batch_time=0.34673 
Train Epoch: 21 [101/1000 3232/32000 (10%)] Loss: 0.48844 (QuantReg: 12.17917) QuantErr: 12.17917 batch_time=0.34935 
Train Epoch: 21 [106/1000 3392/32000 (11%)] Loss: 0.41746 (QuantReg: 12.44554) QuantErr: 12.44554 batch_time=0.34799 
Train Epoch: 21 [111/1000 3552/32000 (11%)] Loss: 0.29417 (QuantReg: 12.29092) QuantErr: 12.29092 batch_time=0.37008 
Train Epoch: 21 [116/1000 3712/32000 (12%)] Loss: 0.44314 (QuantReg: 12.87988) QuantErr: 12.87988 batch_time=0.36108 
Train Epoch: 21 [121/1000 3872/32000 (12%)] Loss: 0.25720 (QuantReg: 12.39599) QuantErr: 12.39599 batch_time=0.52345 
Train Epoch: 21 [126/1000 4032/32000 (13%)] Loss: 0.49710 (QuantReg: 11.90361) QuantErr: 11.90361 batch_time=0.36229 
Train Epoch: 21 [131/1000 4192/32000 (13%)] Loss: 0.47000 (QuantReg: 11.84301) QuantErr: 11.84301 batch_time=0.36354 
Train Epoch: 21 [136/1000 4352/32000 (14%)] Loss: 0.87100 (QuantReg: 12.15862) QuantErr: 12.15862 batch_time=0.34581 
Train Epoch: 21 [141/1000 4512/32000 (14%)] Loss: 0.44698 (QuantReg: 12.30541) QuantErr: 12.30541 batch_time=0.34978 
Train Epoch: 21 [146/1000 4672/32000 (15%)] Loss: 0.53041 (QuantReg: 12.41772) QuantErr: 12.41772 batch_time=0.35704 
Train Epoch: 21 [151/1000 4832/32000 (15%)] Loss: 0.20256 (QuantReg: 12.57972) QuantErr: 12.57972 batch_time=0.35485 
Train Epoch: 21 [156/1000 4992/32000 (16%)] Loss: 0.36204 (QuantReg: 12.28573) QuantErr: 12.28573 batch_time=0.35464 
Train Epoch: 21 [161/1000 5152/32000 (16%)] Loss: 0.22882 (QuantReg: 12.26666) QuantErr: 12.26666 batch_time=0.35191 
Train Epoch: 21 [166/1000 5312/32000 (17%)] Loss: 0.46304 (QuantReg: 11.95578) QuantErr: 11.95578 batch_time=0.35498 
Train Epoch: 21 [171/1000 5472/32000 (17%)] Loss: 0.35951 (QuantReg: 12.37649) QuantErr: 12.37649 batch_time=0.36388 
Train Epoch: 21 [176/1000 5632/32000 (18%)] Loss: 0.49862 (QuantReg: 12.69356) QuantErr: 12.69356 batch_time=0.36150 
Train Epoch: 21 [181/1000 5792/32000 (18%)] Loss: 0.49549 (QuantReg: 13.02303) QuantErr: 13.02303 batch_time=0.35806 
Train Epoch: 21 [186/1000 5952/32000 (19%)] Loss: 0.42505 (QuantReg: 11.57738) QuantErr: 11.57738 batch_time=0.36307 
Train Epoch: 21 [191/1000 6112/32000 (19%)] Loss: 0.18918 (QuantReg: 11.70344) QuantErr: 11.70344 batch_time=0.37097 
Train Epoch: 21 [196/1000 6272/32000 (20%)] Loss: 0.36219 (QuantReg: 12.11706) QuantErr: 12.11706 batch_time=0.39169 
Train Epoch: 21 [201/1000 6432/32000 (20%)] Loss: 0.63073 (QuantReg: 12.82080) QuantErr: 12.82080 batch_time=0.38217 
Train Epoch: 21 [206/1000 6592/32000 (21%)] Loss: 0.51254 (QuantReg: 11.98365) QuantErr: 11.98365 batch_time=0.35948 
Train Epoch: 21 [211/1000 6752/32000 (21%)] Loss: 0.86906 (QuantReg: 12.52096) QuantErr: 12.52096 batch_time=0.36718 
Train Epoch: 21 [216/1000 6912/32000 (22%)] Loss: 0.34676 (QuantReg: 12.53646) QuantErr: 12.53646 batch_time=0.40001 
Train Epoch: 21 [221/1000 7072/32000 (22%)] Loss: 0.17116 (QuantReg: 12.64148) QuantErr: 12.64148 batch_time=0.36243 
Train Epoch: 21 [226/1000 7232/32000 (23%)] Loss: 0.60816 (QuantReg: 12.51584) QuantErr: 12.51584 batch_time=0.53105 
Train Epoch: 21 [231/1000 7392/32000 (23%)] Loss: 0.26033 (QuantReg: 12.11956) QuantErr: 12.11956 batch_time=0.39623 
Train Epoch: 21 [236/1000 7552/32000 (24%)] Loss: 0.44758 (QuantReg: 12.80992) QuantErr: 12.80992 batch_time=0.35660 
Train Epoch: 21 [241/1000 7712/32000 (24%)] Loss: 0.45819 (QuantReg: 12.32787) QuantErr: 12.32787 batch_time=0.37153 
Train Epoch: 21 [246/1000 7872/32000 (25%)] Loss: 0.20367 (QuantReg: 11.98078) QuantErr: 11.98078 batch_time=0.36425 
Train Epoch: 21 [251/1000 8032/32000 (25%)] Loss: 0.71525 (QuantReg: 12.35702) QuantErr: 12.35702 batch_time=0.35331 
Train Epoch: 21 [256/1000 8192/32000 (26%)] Loss: 0.34772 (QuantReg: 12.64030) QuantErr: 12.64030 batch_time=0.41620 
Train Epoch: 21 [261/1000 8352/32000 (26%)] Loss: 0.52470 (QuantReg: 12.57554) QuantErr: 12.57554 batch_time=0.41001 
Train Epoch: 21 [266/1000 8512/32000 (27%)] Loss: 0.37419 (QuantReg: 12.31803) QuantErr: 12.31803 batch_time=0.40682 
Train Epoch: 21 [271/1000 8672/32000 (27%)] Loss: 0.38129 (QuantReg: 11.90965) QuantErr: 11.90965 batch_time=0.42079 
Train Epoch: 21 [276/1000 8832/32000 (28%)] Loss: 0.31836 (QuantReg: 12.83931) QuantErr: 12.83931 batch_time=0.36217 
Train Epoch: 21 [281/1000 8992/32000 (28%)] Loss: 0.46629 (QuantReg: 12.19629) QuantErr: 12.19629 batch_time=0.70939 
Train Epoch: 21 [286/1000 9152/32000 (29%)] Loss: 0.17058 (QuantReg: 11.64876) QuantErr: 11.64876 batch_time=0.44073 
Train Epoch: 21 [291/1000 9312/32000 (29%)] Loss: 0.64815 (QuantReg: 12.57404) QuantErr: 12.57404 batch_time=0.35946 
Train Epoch: 21 [296/1000 9472/32000 (30%)] Loss: 0.38733 (QuantReg: 12.69515) QuantErr: 12.69515 batch_time=0.37661 
Train Epoch: 21 [301/1000 9632/32000 (30%)] Loss: 0.30706 (QuantReg: 11.92409) QuantErr: 11.92409 batch_time=0.36152 
Train Epoch: 21 [306/1000 9792/32000 (31%)] Loss: 0.36287 (QuantReg: 12.13984) QuantErr: 12.13984 batch_time=0.42264 
Train Epoch: 21 [311/1000 9952/32000 (31%)] Loss: 0.39688 (QuantReg: 12.28603) QuantErr: 12.28603 batch_time=0.35385 
Train Epoch: 21 [316/1000 10112/32000 (32%)] Loss: 0.38168 (QuantReg: 13.00674) QuantErr: 13.00674 batch_time=0.35997 
Train Epoch: 21 [321/1000 10272/32000 (32%)] Loss: 0.72444 (QuantReg: 11.83595) QuantErr: 11.83595 batch_time=0.42117 
Train Epoch: 21 [326/1000 10432/32000 (33%)] Loss: 0.46621 (QuantReg: 11.98898) QuantErr: 11.98898 batch_time=1.45708 
Train Epoch: 21 [331/1000 10592/32000 (33%)] Loss: 0.44730 (QuantReg: 12.01675) QuantErr: 12.01675 batch_time=0.35105 
Train Epoch: 21 [336/1000 10752/32000 (34%)] Loss: 0.35698 (QuantReg: 12.01364) QuantErr: 12.01364 batch_time=0.42782 
Train Epoch: 21 [341/1000 10912/32000 (34%)] Loss: 0.61054 (QuantReg: 12.32863) QuantErr: 12.32863 batch_time=0.35525 
Train Epoch: 21 [346/1000 11072/32000 (35%)] Loss: 0.45400 (QuantReg: 11.72807) QuantErr: 11.72807 batch_time=0.37055 
Train Epoch: 21 [351/1000 11232/32000 (35%)] Loss: 0.21271 (QuantReg: 12.85922) QuantErr: 12.85922 batch_time=0.39081 
Train Epoch: 21 [356/1000 11392/32000 (36%)] Loss: 0.38579 (QuantReg: 12.32615) QuantErr: 12.32615 batch_time=0.41866 
Train Epoch: 21 [361/1000 11552/32000 (36%)] Loss: 0.61396 (QuantReg: 12.68214) QuantErr: 12.68214 batch_time=0.35743 
Train Epoch: 21 [366/1000 11712/32000 (37%)] Loss: 0.45673 (QuantReg: 11.69488) QuantErr: 11.69488 batch_time=0.57102 
Train Epoch: 21 [371/1000 11872/32000 (37%)] Loss: 0.87275 (QuantReg: 11.54632) QuantErr: 11.54632 batch_time=0.35998 
Train Epoch: 21 [376/1000 12032/32000 (38%)] Loss: 0.25362 (QuantReg: 12.56491) QuantErr: 12.56491 batch_time=0.35607 
Train Epoch: 21 [381/1000 12192/32000 (38%)] Loss: 0.52405 (QuantReg: 12.37786) QuantErr: 12.37786 batch_time=0.34949 
Train Epoch: 21 [386/1000 12352/32000 (39%)] Loss: 0.41486 (QuantReg: 12.31893) QuantErr: 12.31893 batch_time=0.68688 
Train Epoch: 21 [391/1000 12512/32000 (39%)] Loss: 0.18672 (QuantReg: 13.30168) QuantErr: 13.30168 batch_time=0.36446 
Train Epoch: 21 [396/1000 12672/32000 (40%)] Loss: 0.12717 (QuantReg: 12.62354) QuantErr: 12.62354 batch_time=0.35097 
Train Epoch: 21 [401/1000 12832/32000 (40%)] Loss: 0.16716 (QuantReg: 12.42148) QuantErr: 12.42148 batch_time=0.37822 
Train Epoch: 21 [406/1000 12992/32000 (41%)] Loss: 0.38542 (QuantReg: 11.98752) QuantErr: 11.98752 batch_time=0.36665 
Train Epoch: 21 [411/1000 13152/32000 (41%)] Loss: 0.41107 (QuantReg: 12.45289) QuantErr: 12.45289 batch_time=0.49089 
Train Epoch: 21 [416/1000 13312/32000 (42%)] Loss: 0.21380 (QuantReg: 12.20515) QuantErr: 12.20515 batch_time=0.39060 
Train Epoch: 21 [421/1000 13472/32000 (42%)] Loss: 0.32911 (QuantReg: 12.91362) QuantErr: 12.91362 batch_time=0.39769 
Train Epoch: 21 [426/1000 13632/32000 (43%)] Loss: 0.91822 (QuantReg: 11.70720) QuantErr: 11.70720 batch_time=0.36178 
Train Epoch: 21 [431/1000 13792/32000 (43%)] Loss: 0.52184 (QuantReg: 12.08650) QuantErr: 12.08650 batch_time=0.36879 
Train Epoch: 21 [436/1000 13952/32000 (44%)] Loss: 0.39603 (QuantReg: 12.96897) QuantErr: 12.96897 batch_time=0.35374 
Train Epoch: 21 [441/1000 14112/32000 (44%)] Loss: 0.62848 (QuantReg: 12.01020) QuantErr: 12.01020 batch_time=0.36802 
Train Epoch: 21 [446/1000 14272/32000 (45%)] Loss: 0.62057 (QuantReg: 12.91731) QuantErr: 12.91731 batch_time=0.38812 
Train Epoch: 21 [451/1000 14432/32000 (45%)] Loss: 0.35646 (QuantReg: 12.42278) QuantErr: 12.42278 batch_time=0.37490 
Train Epoch: 21 [456/1000 14592/32000 (46%)] Loss: 0.70910 (QuantReg: 11.30547) QuantErr: 11.30547 batch_time=0.36205 
Train Epoch: 21 [461/1000 14752/32000 (46%)] Loss: 0.31894 (QuantReg: 12.83537) QuantErr: 12.83537 batch_time=0.36758 
Train Epoch: 21 [466/1000 14912/32000 (47%)] Loss: 0.45552 (QuantReg: 12.29892) QuantErr: 12.29892 batch_time=0.35887 
Train Epoch: 21 [471/1000 15072/32000 (47%)] Loss: 0.33375 (QuantReg: 12.47024) QuantErr: 12.47024 batch_time=0.35550 
Train Epoch: 21 [476/1000 15232/32000 (48%)] Loss: 0.46169 (QuantReg: 12.25849) QuantErr: 12.25849 batch_time=0.37057 
Train Epoch: 21 [481/1000 15392/32000 (48%)] Loss: 0.20351 (QuantReg: 11.75781) QuantErr: 11.75781 batch_time=0.38374 
Train Epoch: 21 [486/1000 15552/32000 (49%)] Loss: 0.26260 (QuantReg: 12.72603) QuantErr: 12.72603 batch_time=0.36075 
Train Epoch: 21 [491/1000 15712/32000 (49%)] Loss: 0.66694 (QuantReg: 11.87807) QuantErr: 11.87807 batch_time=0.41179 
Train Epoch: 21 [496/1000 15872/32000 (50%)] Loss: 0.64466 (QuantReg: 12.59930) QuantErr: 12.59930 batch_time=0.35087 
Train Epoch: 21 [501/1000 16032/32000 (50%)] Loss: 0.61271 (QuantReg: 12.14164) QuantErr: 12.14164 batch_time=0.38813 
Train Epoch: 21 [506/1000 16192/32000 (51%)] Loss: 0.15344 (QuantReg: 12.17474) QuantErr: 12.17474 batch_time=0.40813 
Train Epoch: 21 [511/1000 16352/32000 (51%)] Loss: 0.50970 (QuantReg: 12.00463) QuantErr: 12.00463 batch_time=0.37248 
Train Epoch: 21 [516/1000 16512/32000 (52%)] Loss: 0.53578 (QuantReg: 11.55176) QuantErr: 11.55176 batch_time=0.35690 
Train Epoch: 21 [521/1000 16672/32000 (52%)] Loss: 0.44393 (QuantReg: 12.73238) QuantErr: 12.73238 batch_time=0.35635 
Train Epoch: 21 [526/1000 16832/32000 (53%)] Loss: 0.86345 (QuantReg: 12.16639) QuantErr: 12.16639 batch_time=0.34803 
Train Epoch: 21 [531/1000 16992/32000 (53%)] Loss: 0.35531 (QuantReg: 11.93249) QuantErr: 11.93249 batch_time=0.38195 
Train Epoch: 21 [536/1000 17152/32000 (54%)] Loss: 0.19023 (QuantReg: 12.36645) QuantErr: 12.36645 batch_time=0.37362 
Train Epoch: 21 [541/1000 17312/32000 (54%)] Loss: 0.21640 (QuantReg: 12.98605) QuantErr: 12.98605 batch_time=0.36965 
Train Epoch: 21 [546/1000 17472/32000 (55%)] Loss: 0.27795 (QuantReg: 12.02399) QuantErr: 12.02399 batch_time=0.49688 
Train Epoch: 21 [551/1000 17632/32000 (55%)] Loss: 0.70304 (QuantReg: 12.62099) QuantErr: 12.62099 batch_time=0.38701 
Train Epoch: 21 [556/1000 17792/32000 (56%)] Loss: 0.48398 (QuantReg: 12.31710) QuantErr: 12.31710 batch_time=0.36379 
Train Epoch: 21 [561/1000 17952/32000 (56%)] Loss: 0.14243 (QuantReg: 12.29280) QuantErr: 12.29280 batch_time=0.40344 
Train Epoch: 21 [566/1000 18112/32000 (57%)] Loss: 0.28041 (QuantReg: 12.04770) QuantErr: 12.04770 batch_time=0.35899 
Train Epoch: 21 [571/1000 18272/32000 (57%)] Loss: 0.26603 (QuantReg: 12.10847) QuantErr: 12.10847 batch_time=0.40521 
Train Epoch: 21 [576/1000 18432/32000 (58%)] Loss: 0.74576 (QuantReg: 12.59644) QuantErr: 12.59644 batch_time=0.35448 
Train Epoch: 21 [581/1000 18592/32000 (58%)] Loss: 0.50837 (QuantReg: 12.87125) QuantErr: 12.87125 batch_time=0.37115 
Train Epoch: 21 [586/1000 18752/32000 (59%)] Loss: 0.22628 (QuantReg: 12.45960) QuantErr: 12.45960 batch_time=0.47858 
Train Epoch: 21 [591/1000 18912/32000 (59%)] Loss: 0.18433 (QuantReg: 12.24520) QuantErr: 12.24520 batch_time=0.36368 
Train Epoch: 21 [596/1000 19072/32000 (60%)] Loss: 0.16612 (QuantReg: 11.89666) QuantErr: 11.89666 batch_time=0.41231 
Train Epoch: 21 [601/1000 19232/32000 (60%)] Loss: 0.44411 (QuantReg: 12.38350) QuantErr: 12.38350 batch_time=0.62840 
Train Epoch: 21 [606/1000 19392/32000 (61%)] Loss: 0.38305 (QuantReg: 12.77751) QuantErr: 12.77751 batch_time=0.37222 
Train Epoch: 21 [611/1000 19552/32000 (61%)] Loss: 0.34226 (QuantReg: 12.20669) QuantErr: 12.20669 batch_time=0.36228 
Train Epoch: 21 [616/1000 19712/32000 (62%)] Loss: 0.52917 (QuantReg: 12.77255) QuantErr: 12.77255 batch_time=0.36560 
Train Epoch: 21 [621/1000 19872/32000 (62%)] Loss: 0.65855 (QuantReg: 12.48815) QuantErr: 12.48815 batch_time=0.36087 
Train Epoch: 21 [626/1000 20032/32000 (63%)] Loss: 0.27306 (QuantReg: 12.05386) QuantErr: 12.05386 batch_time=0.35927 
Train Epoch: 21 [631/1000 20192/32000 (63%)] Loss: 0.27721 (QuantReg: 12.23079) QuantErr: 12.23079 batch_time=0.35455 
Train Epoch: 21 [636/1000 20352/32000 (64%)] Loss: 0.61953 (QuantReg: 12.17520) QuantErr: 12.17520 batch_time=0.35922 
Train Epoch: 21 [641/1000 20512/32000 (64%)] Loss: 0.55542 (QuantReg: 12.53584) QuantErr: 12.53584 batch_time=0.37979 
Train Epoch: 21 [646/1000 20672/32000 (65%)] Loss: 0.45386 (QuantReg: 12.38915) QuantErr: 12.38915 batch_time=1.48413 
Train Epoch: 21 [651/1000 20832/32000 (65%)] Loss: 0.34788 (QuantReg: 12.05596) QuantErr: 12.05596 batch_time=0.36302 
Train Epoch: 21 [656/1000 20992/32000 (66%)] Loss: 0.37911 (QuantReg: 12.75286) QuantErr: 12.75286 batch_time=0.35562 
Train Epoch: 21 [661/1000 21152/32000 (66%)] Loss: 0.15939 (QuantReg: 12.43470) QuantErr: 12.43470 batch_time=0.35856 
Train Epoch: 21 [666/1000 21312/32000 (67%)] Loss: 0.28125 (QuantReg: 12.12757) QuantErr: 12.12757 batch_time=0.37482 
Train Epoch: 21 [671/1000 21472/32000 (67%)] Loss: 0.59066 (QuantReg: 11.75342) QuantErr: 11.75342 batch_time=0.46536 
Train Epoch: 21 [676/1000 21632/32000 (68%)] Loss: 0.57572 (QuantReg: 12.38475) QuantErr: 12.38475 batch_time=0.36756 
Train Epoch: 21 [681/1000 21792/32000 (68%)] Loss: 0.25072 (QuantReg: 12.73165) QuantErr: 12.73165 batch_time=0.34642 
Train Epoch: 21 [686/1000 21952/32000 (69%)] Loss: 0.65867 (QuantReg: 12.00897) QuantErr: 12.00897 batch_time=0.49651 
Train Epoch: 21 [691/1000 22112/32000 (69%)] Loss: 0.58390 (QuantReg: 12.35700) QuantErr: 12.35700 batch_time=0.35138 
Train Epoch: 21 [696/1000 22272/32000 (70%)] Loss: 0.32299 (QuantReg: 13.24140) QuantErr: 13.24140 batch_time=0.35547 
Train Epoch: 21 [701/1000 22432/32000 (70%)] Loss: 0.13034 (QuantReg: 12.46282) QuantErr: 12.46282 batch_time=0.39637 
Train Epoch: 21 [706/1000 22592/32000 (71%)] Loss: 0.74908 (QuantReg: 12.38658) QuantErr: 12.38658 batch_time=0.67331 
Train Epoch: 21 [711/1000 22752/32000 (71%)] Loss: 0.35177 (QuantReg: 12.64507) QuantErr: 12.64507 batch_time=0.38279 
Train Epoch: 21 [716/1000 22912/32000 (72%)] Loss: 0.06882 (QuantReg: 11.93670) QuantErr: 11.93670 batch_time=0.40652 
Train Epoch: 21 [721/1000 23072/32000 (72%)] Loss: 0.36980 (QuantReg: 12.01481) QuantErr: 12.01481 batch_time=0.42802 
Train Epoch: 21 [726/1000 23232/32000 (73%)] Loss: 0.33428 (QuantReg: 12.11796) QuantErr: 12.11796 batch_time=0.35533 
Train Epoch: 21 [731/1000 23392/32000 (73%)] Loss: 0.54172 (QuantReg: 12.40969) QuantErr: 12.40969 batch_time=0.44094 
Train Epoch: 21 [736/1000 23552/32000 (74%)] Loss: 0.23235 (QuantReg: 12.35527) QuantErr: 12.35527 batch_time=0.36286 
Train Epoch: 21 [741/1000 23712/32000 (74%)] Loss: 0.49952 (QuantReg: 12.68511) QuantErr: 12.68511 batch_time=0.35991 
Train Epoch: 21 [746/1000 23872/32000 (75%)] Loss: 0.70302 (QuantReg: 12.35104) QuantErr: 12.35104 batch_time=0.35260 
Train Epoch: 21 [751/1000 24032/32000 (75%)] Loss: 0.26605 (QuantReg: 12.27395) QuantErr: 12.27395 batch_time=0.39064 
Train Epoch: 21 [756/1000 24192/32000 (76%)] Loss: 0.29613 (QuantReg: 12.83997) QuantErr: 12.83997 batch_time=0.37929 
Train Epoch: 21 [761/1000 24352/32000 (76%)] Loss: 0.36073 (QuantReg: 11.97728) QuantErr: 11.97728 batch_time=0.36870 
Train Epoch: 21 [766/1000 24512/32000 (77%)] Loss: 0.77533 (QuantReg: 11.06085) QuantErr: 11.06085 batch_time=0.34954 
Train Epoch: 21 [771/1000 24672/32000 (77%)] Loss: 0.58720 (QuantReg: 11.76046) QuantErr: 11.76046 batch_time=0.35092 
Train Epoch: 21 [776/1000 24832/32000 (78%)] Loss: 0.33119 (QuantReg: 12.02816) QuantErr: 12.02816 batch_time=0.40271 
Train Epoch: 21 [781/1000 24992/32000 (78%)] Loss: 0.45154 (QuantReg: 12.17381) QuantErr: 12.17381 batch_time=0.35835 
Train Epoch: 21 [786/1000 25152/32000 (79%)] Loss: 0.43453 (QuantReg: 12.35381) QuantErr: 12.35381 batch_time=0.40451 
Train Epoch: 21 [791/1000 25312/32000 (79%)] Loss: 0.15544 (QuantReg: 13.47183) QuantErr: 13.47183 batch_time=0.35340 
Train Epoch: 21 [796/1000 25472/32000 (80%)] Loss: 0.24982 (QuantReg: 12.28531) QuantErr: 12.28531 batch_time=0.35364 
Train Epoch: 21 [801/1000 25632/32000 (80%)] Loss: 0.74305 (QuantReg: 12.46534) QuantErr: 12.46534 batch_time=0.35917 
Train Epoch: 21 [806/1000 25792/32000 (81%)] Loss: 0.54124 (QuantReg: 12.25368) QuantErr: 12.25368 batch_time=0.39809 
Train Epoch: 21 [811/1000 25952/32000 (81%)] Loss: 0.24653 (QuantReg: 12.47185) QuantErr: 12.47185 batch_time=0.39497 
Train Epoch: 21 [816/1000 26112/32000 (82%)] Loss: 0.61143 (QuantReg: 12.04782) QuantErr: 12.04782 batch_time=0.39022 
Train Epoch: 21 [821/1000 26272/32000 (82%)] Loss: 0.37505 (QuantReg: 12.47190) QuantErr: 12.47190 batch_time=0.35694 
Train Epoch: 21 [826/1000 26432/32000 (83%)] Loss: 0.57421 (QuantReg: 12.26744) QuantErr: 12.26744 batch_time=0.34982 
Train Epoch: 21 [831/1000 26592/32000 (83%)] Loss: 0.30719 (QuantReg: 11.85827) QuantErr: 11.85827 batch_time=0.34907 
Train Epoch: 21 [836/1000 26752/32000 (84%)] Loss: 0.46863 (QuantReg: 12.63191) QuantErr: 12.63191 batch_time=0.35619 
Train Epoch: 21 [841/1000 26912/32000 (84%)] Loss: 0.37754 (QuantReg: 12.57404) QuantErr: 12.57404 batch_time=0.35476 
Train Epoch: 21 [846/1000 27072/32000 (85%)] Loss: 0.37059 (QuantReg: 11.93368) QuantErr: 11.93368 batch_time=0.35819 
Train Epoch: 21 [851/1000 27232/32000 (85%)] Loss: 0.23123 (QuantReg: 12.44358) QuantErr: 12.44358 batch_time=0.37176 
Train Epoch: 21 [856/1000 27392/32000 (86%)] Loss: 0.32446 (QuantReg: 12.25738) QuantErr: 12.25738 batch_time=0.43642 
Train Epoch: 21 [861/1000 27552/32000 (86%)] Loss: 0.28147 (QuantReg: 13.20530) QuantErr: 13.20530 batch_time=0.36269 
Train Epoch: 21 [866/1000 27712/32000 (87%)] Loss: 0.46619 (QuantReg: 12.32659) QuantErr: 12.32659 batch_time=0.50655 
Train Epoch: 21 [871/1000 27872/32000 (87%)] Loss: 0.17497 (QuantReg: 12.99351) QuantErr: 12.99351 batch_time=0.42181 
Train Epoch: 21 [876/1000 28032/32000 (88%)] Loss: 0.32314 (QuantReg: 12.80190) QuantErr: 12.80190 batch_time=0.36380 
Train Epoch: 21 [881/1000 28192/32000 (88%)] Loss: 0.48691 (QuantReg: 12.13326) QuantErr: 12.13326 batch_time=0.40066 
Train Epoch: 21 [886/1000 28352/32000 (89%)] Loss: 0.62144 (QuantReg: 12.91916) QuantErr: 12.91916 batch_time=0.35818 
Train Epoch: 21 [891/1000 28512/32000 (89%)] Loss: 0.27857 (QuantReg: 12.76445) QuantErr: 12.76445 batch_time=0.36331 
Train Epoch: 21 [896/1000 28672/32000 (90%)] Loss: 0.71671 (QuantReg: 11.58370) QuantErr: 11.58370 batch_time=0.43596 
Train Epoch: 21 [901/1000 28832/32000 (90%)] Loss: 0.81012 (QuantReg: 12.21014) QuantErr: 12.21014 batch_time=0.38192 
Train Epoch: 21 [906/1000 28992/32000 (91%)] Loss: 0.46122 (QuantReg: 11.68025) QuantErr: 11.68025 batch_time=0.35778 
Train Epoch: 21 [911/1000 29152/32000 (91%)] Loss: 0.46330 (QuantReg: 12.14575) QuantErr: 12.14575 batch_time=0.35761 
Train Epoch: 21 [916/1000 29312/32000 (92%)] Loss: 0.27507 (QuantReg: 12.99034) QuantErr: 12.99034 batch_time=0.36250 
Train Epoch: 21 [921/1000 29472/32000 (92%)] Loss: 0.49831 (QuantReg: 12.50805) QuantErr: 12.50805 batch_time=0.61789 
Train Epoch: 21 [926/1000 29632/32000 (93%)] Loss: 0.52637 (QuantReg: 12.38100) QuantErr: 12.38100 batch_time=0.38072 
Train Epoch: 21 [931/1000 29792/32000 (93%)] Loss: 0.89265 (QuantReg: 11.55322) QuantErr: 11.55322 batch_time=0.37911 
Train Epoch: 21 [936/1000 29952/32000 (94%)] Loss: 0.42845 (QuantReg: 12.63702) QuantErr: 12.63702 batch_time=0.36641 
Train Epoch: 21 [941/1000 30112/32000 (94%)] Loss: 0.26971 (QuantReg: 11.86693) QuantErr: 11.86693 batch_time=0.36439 
Train Epoch: 21 [946/1000 30272/32000 (95%)] Loss: 0.53073 (QuantReg: 12.07807) QuantErr: 12.07807 batch_time=0.36424 
Train Epoch: 21 [951/1000 30432/32000 (95%)] Loss: 0.34834 (QuantReg: 12.26847) QuantErr: 12.26847 batch_time=0.38956 
Train Epoch: 21 [956/1000 30592/32000 (96%)] Loss: 0.59640 (QuantReg: 12.62811) QuantErr: 12.62811 batch_time=0.38264 
Train Epoch: 21 [961/1000 30752/32000 (96%)] Loss: 0.24005 (QuantReg: 12.66714) QuantErr: 12.66714 batch_time=0.41170 
Train Epoch: 21 [966/1000 30912/32000 (97%)] Loss: 0.37780 (QuantReg: 12.00637) QuantErr: 12.00637 batch_time=1.42952 
Train Epoch: 21 [971/1000 31072/32000 (97%)] Loss: 0.17489 (QuantReg: 11.91881) QuantErr: 11.91881 batch_time=0.37519 
Train Epoch: 21 [976/1000 31232/32000 (98%)] Loss: 0.37232 (QuantReg: 12.09705) QuantErr: 12.09705 batch_time=0.36156 
Train Epoch: 21 [981/1000 31392/32000 (98%)] Loss: 0.52394 (QuantReg: 12.82893) QuantErr: 12.82893 batch_time=0.35873 
Train Epoch: 21 [986/1000 31552/32000 (99%)] Loss: 0.42039 (QuantReg: 13.00038) QuantErr: 13.00038 batch_time=0.36305 
Train Epoch: 21 [991/1000 31712/32000 (99%)] Loss: 0.54129 (QuantReg: 11.95485) QuantErr: 11.95485 batch_time=0.35770 
Train Epoch: 21 [996/1000 31872/32000 (100%)] Loss: 0.56868 (QuantReg: 12.51138) QuantErr: 12.51138 batch_time=0.42205 
Train Epoch: 21 codebook_update_time=2.44733
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch21.pth ...
Done in 4.945s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 0.43054327146708965
 quant_reg      : 12.328561729431152
 quant_err      : 12.328561729431152
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 21000
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.995975855130784
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.336899849189045
 MSRVTT_full_val/v2t_metrics/R1: 34.40643863179074
 MSRVTT_full_val/v2t_metrics/R5: 73.03822937625755
 MSRVTT_full_val/v2t_metrics/R10: 85.31187122736418
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.063380281690141
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.850319792609426
 MSRVTT_full_test/t2v_metrics/R1: 11.304347826086957
 MSRVTT_full_test/t2v_metrics/R5: 33.31103678929766
 MSRVTT_full_test/t2v_metrics/R10: 47.491638795986624
 MSRVTT_full_test/t2v_metrics/R50: 79.86622073578596
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.7943143812709
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.150717312533473
 MSRVTT_full_test/v2t_metrics/R1: 14.91638795986622
 MSRVTT_full_test/v2t_metrics/R5: 40.23411371237458
 MSRVTT_full_test/v2t_metrics/R10: 55.31772575250836
 MSRVTT_full_test/v2t_metrics/R50: 85.61872909698997
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.49732441471572
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.1396252654299
 mnt_best       : 26.251439403069927
 not_improved_count: 1
Train Epoch: 22 [1/1000 32/32000 (0%)] Loss: 0.31602 (QuantReg: 12.51482) QuantErr: 12.51482 batch_time=30.38609 
Train Epoch: 22 [6/1000 192/32000 (1%)] Loss: 0.61930 (QuantReg: 11.83877) QuantErr: 11.83877 batch_time=0.35044 
Train Epoch: 22 [11/1000 352/32000 (1%)] Loss: 0.45564 (QuantReg: 12.11981) QuantErr: 12.11981 batch_time=0.35117 
Train Epoch: 22 [16/1000 512/32000 (2%)] Loss: 0.26739 (QuantReg: 11.94157) QuantErr: 11.94157 batch_time=0.43874 
Train Epoch: 22 [21/1000 672/32000 (2%)] Loss: 0.21606 (QuantReg: 12.50451) QuantErr: 12.50451 batch_time=0.80483 
Train Epoch: 22 [26/1000 832/32000 (3%)] Loss: 0.22293 (QuantReg: 13.35088) QuantErr: 13.35088 batch_time=0.35857 
Train Epoch: 22 [31/1000 992/32000 (3%)] Loss: 0.33557 (QuantReg: 11.94670) QuantErr: 11.94670 batch_time=0.35763 
Train Epoch: 22 [36/1000 1152/32000 (4%)] Loss: 0.52737 (QuantReg: 12.20525) QuantErr: 12.20525 batch_time=0.39814 
Train Epoch: 22 [41/1000 1312/32000 (4%)] Loss: 0.45620 (QuantReg: 12.71655) QuantErr: 12.71655 batch_time=0.95910 
Train Epoch: 22 [46/1000 1472/32000 (5%)] Loss: 0.69245 (QuantReg: 12.34273) QuantErr: 12.34273 batch_time=0.41431 
Train Epoch: 22 [51/1000 1632/32000 (5%)] Loss: 0.19778 (QuantReg: 12.03515) QuantErr: 12.03515 batch_time=0.47723 
Train Epoch: 22 [56/1000 1792/32000 (6%)] Loss: 0.48724 (QuantReg: 12.47712) QuantErr: 12.47712 batch_time=0.35440 
Train Epoch: 22 [61/1000 1952/32000 (6%)] Loss: 0.63176 (QuantReg: 12.35635) QuantErr: 12.35635 batch_time=0.35715 
Train Epoch: 22 [66/1000 2112/32000 (7%)] Loss: 0.76381 (QuantReg: 11.81201) QuantErr: 11.81201 batch_time=0.57059 
Train Epoch: 22 [71/1000 2272/32000 (7%)] Loss: 0.15406 (QuantReg: 12.16718) QuantErr: 12.16718 batch_time=0.37538 
Train Epoch: 22 [76/1000 2432/32000 (8%)] Loss: 0.43726 (QuantReg: 12.02884) QuantErr: 12.02884 batch_time=0.42160 
Train Epoch: 22 [81/1000 2592/32000 (8%)] Loss: 0.19665 (QuantReg: 12.65185) QuantErr: 12.65185 batch_time=0.35783 
Train Epoch: 22 [86/1000 2752/32000 (9%)] Loss: 0.38610 (QuantReg: 12.64707) QuantErr: 12.64707 batch_time=0.35691 
Train Epoch: 22 [91/1000 2912/32000 (9%)] Loss: 0.44081 (QuantReg: 12.87443) QuantErr: 12.87443 batch_time=0.47602 
Train Epoch: 22 [96/1000 3072/32000 (10%)] Loss: 0.49876 (QuantReg: 11.74565) QuantErr: 11.74565 batch_time=0.39445 
Train Epoch: 22 [101/1000 3232/32000 (10%)] Loss: 0.35843 (QuantReg: 12.62766) QuantErr: 12.62766 batch_time=0.37988 
Train Epoch: 22 [106/1000 3392/32000 (11%)] Loss: 0.27202 (QuantReg: 12.29910) QuantErr: 12.29910 batch_time=0.41217 
Train Epoch: 22 [111/1000 3552/32000 (11%)] Loss: 0.36316 (QuantReg: 11.88209) QuantErr: 11.88209 batch_time=0.40817 
Train Epoch: 22 [116/1000 3712/32000 (12%)] Loss: 0.34587 (QuantReg: 11.86818) QuantErr: 11.86818 batch_time=0.43414 
Train Epoch: 22 [121/1000 3872/32000 (12%)] Loss: 0.27055 (QuantReg: 11.73600) QuantErr: 11.73600 batch_time=0.39246 
Train Epoch: 22 [126/1000 4032/32000 (13%)] Loss: 0.37675 (QuantReg: 12.82565) QuantErr: 12.82565 batch_time=0.37336 
Train Epoch: 22 [131/1000 4192/32000 (13%)] Loss: 0.48731 (QuantReg: 12.39495) QuantErr: 12.39495 batch_time=0.51996 
Train Epoch: 22 [136/1000 4352/32000 (14%)] Loss: 0.38898 (QuantReg: 12.44346) QuantErr: 12.44346 batch_time=0.40674 
Train Epoch: 22 [141/1000 4512/32000 (14%)] Loss: 0.61601 (QuantReg: 11.76984) QuantErr: 11.76984 batch_time=0.35261 
Train Epoch: 22 [146/1000 4672/32000 (15%)] Loss: 0.41217 (QuantReg: 12.57687) QuantErr: 12.57687 batch_time=0.57668 
Train Epoch: 22 [151/1000 4832/32000 (15%)] Loss: 0.42807 (QuantReg: 12.02094) QuantErr: 12.02094 batch_time=0.35508 
Train Epoch: 22 [156/1000 4992/32000 (16%)] Loss: 0.81265 (QuantReg: 12.26645) QuantErr: 12.26645 batch_time=0.47064 
Train Epoch: 22 [161/1000 5152/32000 (16%)] Loss: 0.73095 (QuantReg: 11.93279) QuantErr: 11.93279 batch_time=0.41825 
Train Epoch: 22 [166/1000 5312/32000 (17%)] Loss: 0.37362 (QuantReg: 13.00007) QuantErr: 13.00007 batch_time=0.52284 
Train Epoch: 22 [171/1000 5472/32000 (17%)] Loss: 0.54875 (QuantReg: 11.97126) QuantErr: 11.97126 batch_time=0.35081 
Train Epoch: 22 [176/1000 5632/32000 (18%)] Loss: 0.17000 (QuantReg: 11.95051) QuantErr: 11.95051 batch_time=0.37129 
Train Epoch: 22 [181/1000 5792/32000 (18%)] Loss: 0.37401 (QuantReg: 12.17845) QuantErr: 12.17845 batch_time=0.35470 
Train Epoch: 22 [186/1000 5952/32000 (19%)] Loss: 0.43799 (QuantReg: 12.45493) QuantErr: 12.45493 batch_time=0.37052 
Train Epoch: 22 [191/1000 6112/32000 (19%)] Loss: 0.54115 (QuantReg: 12.74215) QuantErr: 12.74215 batch_time=0.35233 
Train Epoch: 22 [196/1000 6272/32000 (20%)] Loss: 0.35992 (QuantReg: 12.22044) QuantErr: 12.22044 batch_time=0.46297 
Train Epoch: 22 [201/1000 6432/32000 (20%)] Loss: 0.49363 (QuantReg: 12.11262) QuantErr: 12.11262 batch_time=0.35727 
Train Epoch: 22 [206/1000 6592/32000 (21%)] Loss: 0.12133 (QuantReg: 12.80966) QuantErr: 12.80966 batch_time=0.35111 
Train Epoch: 22 [211/1000 6752/32000 (21%)] Loss: 0.35880 (QuantReg: 12.58313) QuantErr: 12.58313 batch_time=0.35457 
Train Epoch: 22 [216/1000 6912/32000 (22%)] Loss: 1.17458 (QuantReg: 11.85576) QuantErr: 11.85576 batch_time=0.37784 
Train Epoch: 22 [221/1000 7072/32000 (22%)] Loss: 0.25743 (QuantReg: 12.92361) QuantErr: 12.92361 batch_time=0.35652 
Train Epoch: 22 [226/1000 7232/32000 (23%)] Loss: 0.88937 (QuantReg: 12.70055) QuantErr: 12.70055 batch_time=0.36696 
Train Epoch: 22 [231/1000 7392/32000 (23%)] Loss: 0.26164 (QuantReg: 12.25695) QuantErr: 12.25695 batch_time=0.35480 
Train Epoch: 22 [236/1000 7552/32000 (24%)] Loss: 0.31950 (QuantReg: 12.99833) QuantErr: 12.99833 batch_time=0.35909 
Train Epoch: 22 [241/1000 7712/32000 (24%)] Loss: 0.37835 (QuantReg: 12.00369) QuantErr: 12.00369 batch_time=0.36394 
Train Epoch: 22 [246/1000 7872/32000 (25%)] Loss: 0.30956 (QuantReg: 12.63508) QuantErr: 12.63508 batch_time=0.35421 
Train Epoch: 22 [251/1000 8032/32000 (25%)] Loss: 0.42235 (QuantReg: 12.06847) QuantErr: 12.06847 batch_time=0.35245 
Train Epoch: 22 [256/1000 8192/32000 (26%)] Loss: 0.25668 (QuantReg: 13.05242) QuantErr: 13.05242 batch_time=0.35426 
Train Epoch: 22 [261/1000 8352/32000 (26%)] Loss: 0.87027 (QuantReg: 11.52554) QuantErr: 11.52554 batch_time=0.37667 
Train Epoch: 22 [266/1000 8512/32000 (27%)] Loss: 0.80090 (QuantReg: 11.78254) QuantErr: 11.78254 batch_time=0.35927 
Train Epoch: 22 [271/1000 8672/32000 (27%)] Loss: 0.67874 (QuantReg: 11.99342) QuantErr: 11.99342 batch_time=0.37716 
Train Epoch: 22 [276/1000 8832/32000 (28%)] Loss: 0.32567 (QuantReg: 12.86255) QuantErr: 12.86255 batch_time=0.35366 
Train Epoch: 22 [281/1000 8992/32000 (28%)] Loss: 0.65505 (QuantReg: 12.25799) QuantErr: 12.25799 batch_time=0.45872 
Train Epoch: 22 [286/1000 9152/32000 (29%)] Loss: 0.49350 (QuantReg: 12.84434) QuantErr: 12.84434 batch_time=0.35303 
Train Epoch: 22 [291/1000 9312/32000 (29%)] Loss: 0.44931 (QuantReg: 11.95275) QuantErr: 11.95275 batch_time=0.34375 
Train Epoch: 22 [296/1000 9472/32000 (30%)] Loss: 0.33217 (QuantReg: 11.84197) QuantErr: 11.84197 batch_time=0.41877 
Train Epoch: 22 [301/1000 9632/32000 (30%)] Loss: 0.94391 (QuantReg: 12.18785) QuantErr: 12.18785 batch_time=0.35129 
Train Epoch: 22 [306/1000 9792/32000 (31%)] Loss: 0.54659 (QuantReg: 12.39125) QuantErr: 12.39125 batch_time=0.34748 
Train Epoch: 22 [311/1000 9952/32000 (31%)] Loss: 0.15481 (QuantReg: 12.75157) QuantErr: 12.75157 batch_time=0.45996 
Train Epoch: 22 [316/1000 10112/32000 (32%)] Loss: 0.33610 (QuantReg: 12.51043) QuantErr: 12.51043 batch_time=0.35118 
Train Epoch: 22 [321/1000 10272/32000 (32%)] Loss: 0.81848 (QuantReg: 12.07917) QuantErr: 12.07917 batch_time=0.38243 
Train Epoch: 22 [326/1000 10432/32000 (33%)] Loss: 0.24715 (QuantReg: 12.48426) QuantErr: 12.48426 batch_time=0.37158 
Train Epoch: 22 [331/1000 10592/32000 (33%)] Loss: 0.41457 (QuantReg: 12.59345) QuantErr: 12.59345 batch_time=0.35924 
Train Epoch: 22 [336/1000 10752/32000 (34%)] Loss: 0.60186 (QuantReg: 11.88442) QuantErr: 11.88442 batch_time=0.42922 
Train Epoch: 22 [341/1000 10912/32000 (34%)] Loss: 0.60613 (QuantReg: 12.70702) QuantErr: 12.70702 batch_time=0.72321 
Train Epoch: 22 [346/1000 11072/32000 (35%)] Loss: 0.21445 (QuantReg: 12.95686) QuantErr: 12.95686 batch_time=0.35755 
Train Epoch: 22 [351/1000 11232/32000 (35%)] Loss: 0.55095 (QuantReg: 12.32642) QuantErr: 12.32642 batch_time=0.36165 
Train Epoch: 22 [356/1000 11392/32000 (36%)] Loss: 0.15094 (QuantReg: 11.75777) QuantErr: 11.75777 batch_time=0.35128 
Train Epoch: 22 [361/1000 11552/32000 (36%)] Loss: 0.57108 (QuantReg: 12.14542) QuantErr: 12.14542 batch_time=0.87257 
Train Epoch: 22 [366/1000 11712/32000 (37%)] Loss: 0.48818 (QuantReg: 12.53998) QuantErr: 12.53998 batch_time=0.35008 
Train Epoch: 22 [371/1000 11872/32000 (37%)] Loss: 0.22288 (QuantReg: 12.23610) QuantErr: 12.23610 batch_time=0.39001 
Train Epoch: 22 [376/1000 12032/32000 (38%)] Loss: 0.14838 (QuantReg: 12.53055) QuantErr: 12.53055 batch_time=0.39399 
Train Epoch: 22 [381/1000 12192/32000 (38%)] Loss: 0.25730 (QuantReg: 12.96828) QuantErr: 12.96828 batch_time=0.41433 
Train Epoch: 22 [386/1000 12352/32000 (39%)] Loss: 0.43317 (QuantReg: 12.19020) QuantErr: 12.19020 batch_time=0.54542 
Train Epoch: 22 [391/1000 12512/32000 (39%)] Loss: 0.22911 (QuantReg: 12.34314) QuantErr: 12.34314 batch_time=0.37592 
Train Epoch: 22 [396/1000 12672/32000 (40%)] Loss: 0.25899 (QuantReg: 12.87744) QuantErr: 12.87744 batch_time=0.43209 
Train Epoch: 22 [401/1000 12832/32000 (40%)] Loss: 0.39929 (QuantReg: 13.27524) QuantErr: 13.27524 batch_time=0.39279 
Train Epoch: 22 [406/1000 12992/32000 (41%)] Loss: 0.30172 (QuantReg: 12.92538) QuantErr: 12.92538 batch_time=0.40906 
Train Epoch: 22 [411/1000 13152/32000 (41%)] Loss: 0.68424 (QuantReg: 12.41404) QuantErr: 12.41404 batch_time=0.52473 
Train Epoch: 22 [416/1000 13312/32000 (42%)] Loss: 0.49077 (QuantReg: 11.77454) QuantErr: 11.77454 batch_time=0.40113 
Train Epoch: 22 [421/1000 13472/32000 (42%)] Loss: 0.47304 (QuantReg: 11.75826) QuantErr: 11.75826 batch_time=0.44074 
Train Epoch: 22 [426/1000 13632/32000 (43%)] Loss: 0.29228 (QuantReg: 12.37499) QuantErr: 12.37499 batch_time=0.43859 
Train Epoch: 22 [431/1000 13792/32000 (43%)] Loss: 0.35554 (QuantReg: 12.41319) QuantErr: 12.41319 batch_time=0.36225 
Train Epoch: 22 [436/1000 13952/32000 (44%)] Loss: 0.28132 (QuantReg: 12.55853) QuantErr: 12.55853 batch_time=0.36025 
Train Epoch: 22 [441/1000 14112/32000 (44%)] Loss: 0.69378 (QuantReg: 12.34642) QuantErr: 12.34642 batch_time=0.39673 
Train Epoch: 22 [446/1000 14272/32000 (45%)] Loss: 0.37041 (QuantReg: 13.23475) QuantErr: 13.23475 batch_time=0.35741 
Train Epoch: 22 [451/1000 14432/32000 (45%)] Loss: 0.48132 (QuantReg: 13.14975) QuantErr: 13.14975 batch_time=0.56253 
Train Epoch: 22 [456/1000 14592/32000 (46%)] Loss: 0.40334 (QuantReg: 12.58457) QuantErr: 12.58457 batch_time=0.39798 
Train Epoch: 22 [461/1000 14752/32000 (46%)] Loss: 0.31263 (QuantReg: 12.63820) QuantErr: 12.63820 batch_time=0.37109 
Train Epoch: 22 [466/1000 14912/32000 (47%)] Loss: 0.52550 (QuantReg: 12.56074) QuantErr: 12.56074 batch_time=0.58161 
Train Epoch: 22 [471/1000 15072/32000 (47%)] Loss: 0.43365 (QuantReg: 11.86965) QuantErr: 11.86965 batch_time=0.35697 
Train Epoch: 22 [476/1000 15232/32000 (48%)] Loss: 0.24309 (QuantReg: 12.11139) QuantErr: 12.11139 batch_time=0.36701 
Train Epoch: 22 [481/1000 15392/32000 (48%)] Loss: 0.19563 (QuantReg: 12.16489) QuantErr: 12.16489 batch_time=0.35956 
Train Epoch: 22 [486/1000 15552/32000 (49%)] Loss: 0.76286 (QuantReg: 12.48131) QuantErr: 12.48131 batch_time=0.79647 
Train Epoch: 22 [491/1000 15712/32000 (49%)] Loss: 0.35220 (QuantReg: 12.37412) QuantErr: 12.37412 batch_time=0.40004 
Train Epoch: 22 [496/1000 15872/32000 (50%)] Loss: 0.23806 (QuantReg: 12.57677) QuantErr: 12.57677 batch_time=0.36151 
Train Epoch: 22 [501/1000 16032/32000 (50%)] Loss: 0.37728 (QuantReg: 12.73106) QuantErr: 12.73106 batch_time=0.36150 
Train Epoch: 22 [506/1000 16192/32000 (51%)] Loss: 0.46299 (QuantReg: 12.39584) QuantErr: 12.39584 batch_time=0.38394 
Train Epoch: 22 [511/1000 16352/32000 (51%)] Loss: 0.12809 (QuantReg: 12.51925) QuantErr: 12.51925 batch_time=0.37042 
Train Epoch: 22 [516/1000 16512/32000 (52%)] Loss: 0.26092 (QuantReg: 12.25851) QuantErr: 12.25851 batch_time=0.49199 
Train Epoch: 22 [521/1000 16672/32000 (52%)] Loss: 0.29686 (QuantReg: 12.95579) QuantErr: 12.95579 batch_time=0.35439 
Train Epoch: 22 [526/1000 16832/32000 (53%)] Loss: 0.38905 (QuantReg: 12.37691) QuantErr: 12.37691 batch_time=0.39613 
Train Epoch: 22 [531/1000 16992/32000 (53%)] Loss: 0.42986 (QuantReg: 12.28983) QuantErr: 12.28983 batch_time=0.42092 
Train Epoch: 22 [536/1000 17152/32000 (54%)] Loss: 0.32557 (QuantReg: 12.71583) QuantErr: 12.71583 batch_time=0.36329 
Train Epoch: 22 [541/1000 17312/32000 (54%)] Loss: 0.14139 (QuantReg: 12.53672) QuantErr: 12.53672 batch_time=0.36397 
Train Epoch: 22 [546/1000 17472/32000 (55%)] Loss: 0.32831 (QuantReg: 12.83784) QuantErr: 12.83784 batch_time=0.35634 
Train Epoch: 22 [551/1000 17632/32000 (55%)] Loss: 0.35510 (QuantReg: 12.62753) QuantErr: 12.62753 batch_time=0.35635 
Train Epoch: 22 [556/1000 17792/32000 (56%)] Loss: 0.29209 (QuantReg: 12.11959) QuantErr: 12.11959 batch_time=0.37824 
Train Epoch: 22 [561/1000 17952/32000 (56%)] Loss: 0.13591 (QuantReg: 12.46881) QuantErr: 12.46881 batch_time=0.37644 
Train Epoch: 22 [566/1000 18112/32000 (57%)] Loss: 0.28971 (QuantReg: 12.85189) QuantErr: 12.85189 batch_time=0.39425 
Train Epoch: 22 [571/1000 18272/32000 (57%)] Loss: 0.57628 (QuantReg: 12.15692) QuantErr: 12.15692 batch_time=0.41858 
Train Epoch: 22 [576/1000 18432/32000 (58%)] Loss: 0.67724 (QuantReg: 12.57334) QuantErr: 12.57334 batch_time=0.34656 
Train Epoch: 22 [581/1000 18592/32000 (58%)] Loss: 0.43742 (QuantReg: 12.27025) QuantErr: 12.27025 batch_time=0.36552 
Train Epoch: 22 [586/1000 18752/32000 (59%)] Loss: 0.31939 (QuantReg: 12.53283) QuantErr: 12.53283 batch_time=0.36003 
Train Epoch: 22 [591/1000 18912/32000 (59%)] Loss: 0.56964 (QuantReg: 12.58722) QuantErr: 12.58722 batch_time=0.36308 
Train Epoch: 22 [596/1000 19072/32000 (60%)] Loss: 0.18551 (QuantReg: 12.23907) QuantErr: 12.23907 batch_time=0.36011 
Train Epoch: 22 [601/1000 19232/32000 (60%)] Loss: 0.23591 (QuantReg: 13.04389) QuantErr: 13.04389 batch_time=0.49922 
Train Epoch: 22 [606/1000 19392/32000 (61%)] Loss: 0.37175 (QuantReg: 12.42115) QuantErr: 12.42115 batch_time=0.38941 
Train Epoch: 22 [611/1000 19552/32000 (61%)] Loss: 0.46861 (QuantReg: 11.92022) QuantErr: 11.92022 batch_time=0.36037 
Train Epoch: 22 [616/1000 19712/32000 (62%)] Loss: 0.06998 (QuantReg: 12.09811) QuantErr: 12.09811 batch_time=0.37719 
Train Epoch: 22 [621/1000 19872/32000 (62%)] Loss: 0.47639 (QuantReg: 12.76033) QuantErr: 12.76033 batch_time=0.36097 
Train Epoch: 22 [626/1000 20032/32000 (63%)] Loss: 0.47881 (QuantReg: 12.95978) QuantErr: 12.95978 batch_time=0.35532 
Train Epoch: 22 [631/1000 20192/32000 (63%)] Loss: 0.15300 (QuantReg: 12.21440) QuantErr: 12.21440 batch_time=0.41737 
Train Epoch: 22 [636/1000 20352/32000 (64%)] Loss: 0.53131 (QuantReg: 12.09580) QuantErr: 12.09580 batch_time=0.41336 
Train Epoch: 22 [641/1000 20512/32000 (64%)] Loss: 0.15674 (QuantReg: 12.36120) QuantErr: 12.36120 batch_time=0.35462 
Train Epoch: 22 [646/1000 20672/32000 (65%)] Loss: 0.46508 (QuantReg: 12.06779) QuantErr: 12.06779 batch_time=0.37252 
Train Epoch: 22 [651/1000 20832/32000 (65%)] Loss: 0.60838 (QuantReg: 12.51806) QuantErr: 12.51806 batch_time=0.38853 
Train Epoch: 22 [656/1000 20992/32000 (66%)] Loss: 0.31402 (QuantReg: 12.42420) QuantErr: 12.42420 batch_time=0.51239 
Train Epoch: 22 [661/1000 21152/32000 (66%)] Loss: 0.39447 (QuantReg: 12.13599) QuantErr: 12.13599 batch_time=0.73308 
Train Epoch: 22 [666/1000 21312/32000 (67%)] Loss: 0.40372 (QuantReg: 12.86184) QuantErr: 12.86184 batch_time=0.38074 
Train Epoch: 22 [671/1000 21472/32000 (67%)] Loss: 0.31639 (QuantReg: 11.75952) QuantErr: 11.75952 batch_time=0.43463 
Train Epoch: 22 [676/1000 21632/32000 (68%)] Loss: 0.32548 (QuantReg: 12.59753) QuantErr: 12.59753 batch_time=0.42620 
Train Epoch: 22 [681/1000 21792/32000 (68%)] Loss: 0.72732 (QuantReg: 12.81200) QuantErr: 12.81200 batch_time=0.97386 
Train Epoch: 22 [686/1000 21952/32000 (69%)] Loss: 0.36690 (QuantReg: 12.54439) QuantErr: 12.54439 batch_time=0.39975 
Train Epoch: 22 [691/1000 22112/32000 (69%)] Loss: 0.72093 (QuantReg: 11.44705) QuantErr: 11.44705 batch_time=0.37483 
Train Epoch: 22 [696/1000 22272/32000 (70%)] Loss: 0.59619 (QuantReg: 12.29041) QuantErr: 12.29041 batch_time=0.41596 
Train Epoch: 22 [701/1000 22432/32000 (70%)] Loss: 0.46966 (QuantReg: 12.42041) QuantErr: 12.42041 batch_time=0.38582 
Train Epoch: 22 [706/1000 22592/32000 (71%)] Loss: 0.56959 (QuantReg: 12.47716) QuantErr: 12.47716 batch_time=0.57323 
Train Epoch: 22 [711/1000 22752/32000 (71%)] Loss: 0.28403 (QuantReg: 12.35903) QuantErr: 12.35903 batch_time=0.38037 
Train Epoch: 22 [716/1000 22912/32000 (72%)] Loss: 0.25941 (QuantReg: 12.70193) QuantErr: 12.70193 batch_time=0.35141 
Train Epoch: 22 [721/1000 23072/32000 (72%)] Loss: 0.57290 (QuantReg: 12.64117) QuantErr: 12.64117 batch_time=0.35703 
Train Epoch: 22 [726/1000 23232/32000 (73%)] Loss: 0.63990 (QuantReg: 12.36053) QuantErr: 12.36053 batch_time=0.34805 
Train Epoch: 22 [731/1000 23392/32000 (73%)] Loss: 0.30118 (QuantReg: 12.96169) QuantErr: 12.96169 batch_time=0.46456 
Train Epoch: 22 [736/1000 23552/32000 (74%)] Loss: 0.66754 (QuantReg: 12.14074) QuantErr: 12.14074 batch_time=0.36116 
Train Epoch: 22 [741/1000 23712/32000 (74%)] Loss: 0.42079 (QuantReg: 11.97605) QuantErr: 11.97605 batch_time=0.35896 
Train Epoch: 22 [746/1000 23872/32000 (75%)] Loss: 0.51744 (QuantReg: 12.70252) QuantErr: 12.70252 batch_time=0.36126 
Train Epoch: 22 [751/1000 24032/32000 (75%)] Loss: 0.16247 (QuantReg: 12.93629) QuantErr: 12.93629 batch_time=0.38198 
Train Epoch: 22 [756/1000 24192/32000 (76%)] Loss: 0.52788 (QuantReg: 12.19320) QuantErr: 12.19320 batch_time=0.36455 
Train Epoch: 22 [761/1000 24352/32000 (76%)] Loss: 0.51042 (QuantReg: 12.57849) QuantErr: 12.57849 batch_time=0.40304 
Train Epoch: 22 [766/1000 24512/32000 (77%)] Loss: 0.10801 (QuantReg: 12.43635) QuantErr: 12.43635 batch_time=0.38993 
Train Epoch: 22 [771/1000 24672/32000 (77%)] Loss: 0.24883 (QuantReg: 11.97347) QuantErr: 11.97347 batch_time=0.52821 
Train Epoch: 22 [776/1000 24832/32000 (78%)] Loss: 0.24318 (QuantReg: 13.15693) QuantErr: 13.15693 batch_time=0.36012 
Train Epoch: 22 [781/1000 24992/32000 (78%)] Loss: 0.23004 (QuantReg: 12.88710) QuantErr: 12.88710 batch_time=0.36269 
Train Epoch: 22 [786/1000 25152/32000 (79%)] Loss: 0.87040 (QuantReg: 12.45456) QuantErr: 12.45456 batch_time=0.57919 
Train Epoch: 22 [791/1000 25312/32000 (79%)] Loss: 0.25512 (QuantReg: 12.13924) QuantErr: 12.13924 batch_time=0.40723 
Train Epoch: 22 [796/1000 25472/32000 (80%)] Loss: 0.28401 (QuantReg: 12.32313) QuantErr: 12.32313 batch_time=0.37429 
Train Epoch: 22 [801/1000 25632/32000 (80%)] Loss: 0.27450 (QuantReg: 11.94222) QuantErr: 11.94222 batch_time=0.37446 
Train Epoch: 22 [806/1000 25792/32000 (81%)] Loss: 0.35867 (QuantReg: 12.41776) QuantErr: 12.41776 batch_time=0.48179 
Train Epoch: 22 [811/1000 25952/32000 (81%)] Loss: 0.98560 (QuantReg: 12.27844) QuantErr: 12.27844 batch_time=0.43482 
Train Epoch: 22 [816/1000 26112/32000 (82%)] Loss: 0.55175 (QuantReg: 12.66239) QuantErr: 12.66239 batch_time=0.42329 
Train Epoch: 22 [821/1000 26272/32000 (82%)] Loss: 0.29479 (QuantReg: 12.05629) QuantErr: 12.05629 batch_time=0.44552 
Train Epoch: 22 [826/1000 26432/32000 (83%)] Loss: 0.77080 (QuantReg: 11.48262) QuantErr: 11.48262 batch_time=0.36289 
Train Epoch: 22 [831/1000 26592/32000 (83%)] Loss: 0.48068 (QuantReg: 12.19060) QuantErr: 12.19060 batch_time=0.37851 
Train Epoch: 22 [836/1000 26752/32000 (84%)] Loss: 0.19502 (QuantReg: 13.17342) QuantErr: 13.17342 batch_time=0.49536 
Train Epoch: 22 [841/1000 26912/32000 (84%)] Loss: 0.27761 (QuantReg: 12.57721) QuantErr: 12.57721 batch_time=0.38271 
Train Epoch: 22 [846/1000 27072/32000 (85%)] Loss: 0.17921 (QuantReg: 12.27173) QuantErr: 12.27173 batch_time=0.36182 
Train Epoch: 22 [851/1000 27232/32000 (85%)] Loss: 0.17695 (QuantReg: 12.55183) QuantErr: 12.55183 batch_time=0.35700 
Train Epoch: 22 [856/1000 27392/32000 (86%)] Loss: 0.29655 (QuantReg: 12.44201) QuantErr: 12.44201 batch_time=0.37438 
Train Epoch: 22 [861/1000 27552/32000 (86%)] Loss: 0.15276 (QuantReg: 12.62982) QuantErr: 12.62982 batch_time=0.37403 
Train Epoch: 22 [866/1000 27712/32000 (87%)] Loss: 0.33122 (QuantReg: 12.17329) QuantErr: 12.17329 batch_time=0.35888 
Train Epoch: 22 [871/1000 27872/32000 (87%)] Loss: 0.35164 (QuantReg: 12.80021) QuantErr: 12.80021 batch_time=0.34989 
Train Epoch: 22 [876/1000 28032/32000 (88%)] Loss: 0.22295 (QuantReg: 12.70747) QuantErr: 12.70747 batch_time=0.35714 
Train Epoch: 22 [881/1000 28192/32000 (88%)] Loss: 0.26265 (QuantReg: 12.89779) QuantErr: 12.89779 batch_time=0.35887 
Train Epoch: 22 [886/1000 28352/32000 (89%)] Loss: 0.20093 (QuantReg: 13.36746) QuantErr: 13.36746 batch_time=0.35894 
Train Epoch: 22 [891/1000 28512/32000 (89%)] Loss: 0.62677 (QuantReg: 12.63641) QuantErr: 12.63641 batch_time=0.41422 
Train Epoch: 22 [896/1000 28672/32000 (90%)] Loss: 0.31027 (QuantReg: 12.86515) QuantErr: 12.86515 batch_time=0.35795 
Train Epoch: 22 [901/1000 28832/32000 (90%)] Loss: 0.40332 (QuantReg: 12.37554) QuantErr: 12.37554 batch_time=0.36907 
Train Epoch: 22 [906/1000 28992/32000 (91%)] Loss: 1.36706 (QuantReg: 12.13440) QuantErr: 12.13440 batch_time=0.38514 
Train Epoch: 22 [911/1000 29152/32000 (91%)] Loss: 0.34626 (QuantReg: 12.35944) QuantErr: 12.35944 batch_time=0.37586 
Train Epoch: 22 [916/1000 29312/32000 (92%)] Loss: 0.54105 (QuantReg: 12.28337) QuantErr: 12.28337 batch_time=0.36606 
Train Epoch: 22 [921/1000 29472/32000 (92%)] Loss: 0.57244 (QuantReg: 12.04777) QuantErr: 12.04777 batch_time=0.48807 
Train Epoch: 22 [926/1000 29632/32000 (93%)] Loss: 0.34607 (QuantReg: 12.95764) QuantErr: 12.95764 batch_time=0.36985 
Train Epoch: 22 [931/1000 29792/32000 (93%)] Loss: 0.42691 (QuantReg: 12.46396) QuantErr: 12.46396 batch_time=0.35889 
Train Epoch: 22 [936/1000 29952/32000 (94%)] Loss: 0.57371 (QuantReg: 12.59062) QuantErr: 12.59062 batch_time=0.37115 
Train Epoch: 22 [941/1000 30112/32000 (94%)] Loss: 0.24167 (QuantReg: 12.19607) QuantErr: 12.19607 batch_time=0.39928 
Train Epoch: 22 [946/1000 30272/32000 (95%)] Loss: 0.40665 (QuantReg: 12.91152) QuantErr: 12.91152 batch_time=0.45065 
Train Epoch: 22 [951/1000 30432/32000 (95%)] Loss: 0.36664 (QuantReg: 12.32105) QuantErr: 12.32105 batch_time=0.44689 
Train Epoch: 22 [956/1000 30592/32000 (96%)] Loss: 0.33418 (QuantReg: 12.44943) QuantErr: 12.44943 batch_time=0.36429 
Train Epoch: 22 [961/1000 30752/32000 (96%)] Loss: 0.51701 (QuantReg: 12.41988) QuantErr: 12.41988 batch_time=0.36084 
Train Epoch: 22 [966/1000 30912/32000 (97%)] Loss: 0.27518 (QuantReg: 12.44928) QuantErr: 12.44928 batch_time=0.38255 
Train Epoch: 22 [971/1000 31072/32000 (97%)] Loss: 0.31336 (QuantReg: 12.89561) QuantErr: 12.89561 batch_time=0.50696 
Train Epoch: 22 [976/1000 31232/32000 (98%)] Loss: 0.17374 (QuantReg: 12.88373) QuantErr: 12.88373 batch_time=0.43440 
Train Epoch: 22 [981/1000 31392/32000 (98%)] Loss: 0.27010 (QuantReg: 12.51567) QuantErr: 12.51567 batch_time=0.67791 
Train Epoch: 22 [986/1000 31552/32000 (99%)] Loss: 0.31374 (QuantReg: 11.99798) QuantErr: 11.99798 batch_time=0.36507 
Train Epoch: 22 [991/1000 31712/32000 (99%)] Loss: 0.28009 (QuantReg: 13.07278) QuantErr: 13.07278 batch_time=0.36891 
Train Epoch: 22 [996/1000 31872/32000 (100%)] Loss: 0.40034 (QuantReg: 12.50107) QuantErr: 12.50107 batch_time=0.36979 
Train Epoch: 22 codebook_update_time=1.77508
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch22.pth ...
Done in 22.473s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 0.41615400909632444
 quant_reg      : 12.415605701446534
 quant_err      : 12.415605701446534
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 22000
 MSRVTT_full_val/t2v_metrics/R1: 29.577464788732396
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.533199195171026
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.56850691786368
 MSRVTT_full_val/v2t_metrics/R1: 35.010060362173036
 MSRVTT_full_val/v2t_metrics/R5: 72.83702213279678
 MSRVTT_full_val/v2t_metrics/R10: 85.71428571428571
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.601609657947686
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.237381354021835
 MSRVTT_full_test/t2v_metrics/R1: 11.20401337792642
 MSRVTT_full_test/t2v_metrics/R5: 33.44481605351171
 MSRVTT_full_test/t2v_metrics/R10: 47.95986622073578
 MSRVTT_full_test/t2v_metrics/R50: 79.83277591973244
 MSRVTT_full_test/t2v_metrics/MedR: 11.5
 MSRVTT_full_test/t2v_metrics/MeanR: 47.16153846153846
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.193495858146957
 MSRVTT_full_test/v2t_metrics/R1: 14.11371237458194
 MSRVTT_full_test/v2t_metrics/R5: 39.76588628762542
 MSRVTT_full_test/v2t_metrics/R10: 54.54849498327759
 MSRVTT_full_test/v2t_metrics/R50: 85.45150501672241
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.52859531772575
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.283228524588733
 mnt_best       : 26.251439403069927
 not_improved_count: 2
Train Epoch: 23 [1/1000 32/32000 (0%)] Loss: 0.35055 (QuantReg: 13.03688) QuantErr: 13.03688 batch_time=27.40229 
Train Epoch: 23 [6/1000 192/32000 (1%)] Loss: 0.37937 (QuantReg: 12.54457) QuantErr: 12.54457 batch_time=0.34436 
Train Epoch: 23 [11/1000 352/32000 (1%)] Loss: 0.36513 (QuantReg: 11.98975) QuantErr: 11.98975 batch_time=0.35544 
Train Epoch: 23 [16/1000 512/32000 (2%)] Loss: 0.25603 (QuantReg: 12.51016) QuantErr: 12.51016 batch_time=0.71333 
Train Epoch: 23 [21/1000 672/32000 (2%)] Loss: 0.20536 (QuantReg: 12.81352) QuantErr: 12.81352 batch_time=0.33640 
Train Epoch: 23 [26/1000 832/32000 (3%)] Loss: 0.74909 (QuantReg: 12.87564) QuantErr: 12.87564 batch_time=0.39620 
Train Epoch: 23 [31/1000 992/32000 (3%)] Loss: 0.37444 (QuantReg: 11.36158) QuantErr: 11.36158 batch_time=0.38225 
Train Epoch: 23 [36/1000 1152/32000 (4%)] Loss: 0.50995 (QuantReg: 11.88210) QuantErr: 11.88210 batch_time=0.42686 
Train Epoch: 23 [41/1000 1312/32000 (4%)] Loss: 0.31017 (QuantReg: 12.25558) QuantErr: 12.25558 batch_time=0.55432 
Train Epoch: 23 [46/1000 1472/32000 (5%)] Loss: 0.22434 (QuantReg: 12.68335) QuantErr: 12.68335 batch_time=0.36922 
Train Epoch: 23 [51/1000 1632/32000 (5%)] Loss: 0.28974 (QuantReg: 12.61134) QuantErr: 12.61134 batch_time=0.37861 
Train Epoch: 23 [56/1000 1792/32000 (6%)] Loss: 0.52977 (QuantReg: 12.12803) QuantErr: 12.12803 batch_time=0.36033 
Train Epoch: 23 [61/1000 1952/32000 (6%)] Loss: 0.69475 (QuantReg: 11.93051) QuantErr: 11.93051 batch_time=0.36250 
Train Epoch: 23 [66/1000 2112/32000 (7%)] Loss: 0.75697 (QuantReg: 12.24725) QuantErr: 12.24725 batch_time=0.34239 
Train Epoch: 23 [71/1000 2272/32000 (7%)] Loss: 0.70758 (QuantReg: 11.98030) QuantErr: 11.98030 batch_time=0.34762 
Train Epoch: 23 [76/1000 2432/32000 (8%)] Loss: 0.78703 (QuantReg: 12.64535) QuantErr: 12.64535 batch_time=0.39336 
Train Epoch: 23 [81/1000 2592/32000 (8%)] Loss: 0.34996 (QuantReg: 12.35943) QuantErr: 12.35943 batch_time=0.34660 
Train Epoch: 23 [86/1000 2752/32000 (9%)] Loss: 0.32271 (QuantReg: 12.41803) QuantErr: 12.41803 batch_time=0.36470 
Train Epoch: 23 [91/1000 2912/32000 (9%)] Loss: 0.40828 (QuantReg: 13.46564) QuantErr: 13.46564 batch_time=0.35214 
Train Epoch: 23 [96/1000 3072/32000 (10%)] Loss: 0.44895 (QuantReg: 12.24657) QuantErr: 12.24657 batch_time=0.36249 
Train Epoch: 23 [101/1000 3232/32000 (10%)] Loss: 0.38145 (QuantReg: 13.14178) QuantErr: 13.14178 batch_time=0.40270 
Train Epoch: 23 [106/1000 3392/32000 (11%)] Loss: 0.35698 (QuantReg: 12.76675) QuantErr: 12.76675 batch_time=0.34887 
Train Epoch: 23 [111/1000 3552/32000 (11%)] Loss: 0.25374 (QuantReg: 12.56472) QuantErr: 12.56472 batch_time=0.40638 
Train Epoch: 23 [116/1000 3712/32000 (12%)] Loss: 0.28691 (QuantReg: 12.42950) QuantErr: 12.42950 batch_time=0.36306 
Train Epoch: 23 [121/1000 3872/32000 (12%)] Loss: 0.37975 (QuantReg: 12.65808) QuantErr: 12.65808 batch_time=0.45359 
Train Epoch: 23 [126/1000 4032/32000 (13%)] Loss: 0.50144 (QuantReg: 12.19981) QuantErr: 12.19981 batch_time=0.38939 
Train Epoch: 23 [131/1000 4192/32000 (13%)] Loss: 0.77035 (QuantReg: 12.05545) QuantErr: 12.05545 batch_time=0.48166 
Train Epoch: 23 [136/1000 4352/32000 (14%)] Loss: 0.14114 (QuantReg: 12.77622) QuantErr: 12.77622 batch_time=0.53916 
Train Epoch: 23 [141/1000 4512/32000 (14%)] Loss: 0.48003 (QuantReg: 11.48982) QuantErr: 11.48982 batch_time=0.41976 
Train Epoch: 23 [146/1000 4672/32000 (15%)] Loss: 0.22136 (QuantReg: 12.51815) QuantErr: 12.51815 batch_time=0.60427 
Train Epoch: 23 [151/1000 4832/32000 (15%)] Loss: 0.73802 (QuantReg: 11.73576) QuantErr: 11.73576 batch_time=0.33829 
Train Epoch: 23 [156/1000 4992/32000 (16%)] Loss: 0.45227 (QuantReg: 11.80753) QuantErr: 11.80753 batch_time=0.34803 
Train Epoch: 23 [161/1000 5152/32000 (16%)] Loss: 0.26692 (QuantReg: 12.30327) QuantErr: 12.30327 batch_time=0.37878 
Train Epoch: 23 [166/1000 5312/32000 (17%)] Loss: 0.49318 (QuantReg: 11.52034) QuantErr: 11.52034 batch_time=0.35762 
Train Epoch: 23 [171/1000 5472/32000 (17%)] Loss: 0.34055 (QuantReg: 12.26572) QuantErr: 12.26572 batch_time=0.34348 
Train Epoch: 23 [176/1000 5632/32000 (18%)] Loss: 0.13038 (QuantReg: 12.85370) QuantErr: 12.85370 batch_time=0.58439 
Train Epoch: 23 [181/1000 5792/32000 (18%)] Loss: 0.61321 (QuantReg: 12.36645) QuantErr: 12.36645 batch_time=0.61950 
Train Epoch: 23 [186/1000 5952/32000 (19%)] Loss: 0.23611 (QuantReg: 12.45452) QuantErr: 12.45452 batch_time=0.35250 
Train Epoch: 23 [191/1000 6112/32000 (19%)] Loss: 0.12584 (QuantReg: 12.86970) QuantErr: 12.86970 batch_time=0.37882 
Train Epoch: 23 [196/1000 6272/32000 (20%)] Loss: 0.89842 (QuantReg: 11.51107) QuantErr: 11.51107 batch_time=0.81421 
Train Epoch: 23 [201/1000 6432/32000 (20%)] Loss: 0.86583 (QuantReg: 11.82709) QuantErr: 11.82709 batch_time=0.36576 
Train Epoch: 23 [206/1000 6592/32000 (21%)] Loss: 0.26294 (QuantReg: 12.17373) QuantErr: 12.17373 batch_time=0.38206 
Train Epoch: 23 [211/1000 6752/32000 (21%)] Loss: 0.37255 (QuantReg: 11.73869) QuantErr: 11.73869 batch_time=0.57748 
Train Epoch: 23 [216/1000 6912/32000 (22%)] Loss: 1.15505 (QuantReg: 12.43852) QuantErr: 12.43852 batch_time=0.43622 
Train Epoch: 23 [221/1000 7072/32000 (22%)] Loss: 0.40736 (QuantReg: 12.45237) QuantErr: 12.45237 batch_time=0.40522 
Train Epoch: 23 [226/1000 7232/32000 (23%)] Loss: 0.46177 (QuantReg: 12.91028) QuantErr: 12.91028 batch_time=0.40724 
Train Epoch: 23 [231/1000 7392/32000 (23%)] Loss: 0.27509 (QuantReg: 12.52697) QuantErr: 12.52697 batch_time=0.37665 
Train Epoch: 23 [236/1000 7552/32000 (24%)] Loss: 0.51758 (QuantReg: 12.13530) QuantErr: 12.13530 batch_time=0.40039 
Train Epoch: 23 [241/1000 7712/32000 (24%)] Loss: 0.96258 (QuantReg: 12.54268) QuantErr: 12.54268 batch_time=0.36475 
Train Epoch: 23 [246/1000 7872/32000 (25%)] Loss: 0.59078 (QuantReg: 12.22652) QuantErr: 12.22652 batch_time=0.41095 
Train Epoch: 23 [251/1000 8032/32000 (25%)] Loss: 0.41502 (QuantReg: 12.43194) QuantErr: 12.43194 batch_time=0.36322 
Train Epoch: 23 [256/1000 8192/32000 (26%)] Loss: 0.34250 (QuantReg: 12.40197) QuantErr: 12.40197 batch_time=0.34790 
Train Epoch: 23 [261/1000 8352/32000 (26%)] Loss: 0.55344 (QuantReg: 12.40521) QuantErr: 12.40521 batch_time=0.40298 
Train Epoch: 23 [266/1000 8512/32000 (27%)] Loss: 0.53154 (QuantReg: 12.40703) QuantErr: 12.40703 batch_time=0.36603 
Train Epoch: 23 [271/1000 8672/32000 (27%)] Loss: 0.47340 (QuantReg: 12.23986) QuantErr: 12.23986 batch_time=0.36404 
Train Epoch: 23 [276/1000 8832/32000 (28%)] Loss: 0.29201 (QuantReg: 12.47882) QuantErr: 12.47882 batch_time=0.36717 
Train Epoch: 23 [281/1000 8992/32000 (28%)] Loss: 0.34941 (QuantReg: 12.01672) QuantErr: 12.01672 batch_time=0.35892 
Train Epoch: 23 [286/1000 9152/32000 (29%)] Loss: 0.48499 (QuantReg: 12.10133) QuantErr: 12.10133 batch_time=0.34512 
Train Epoch: 23 [291/1000 9312/32000 (29%)] Loss: 0.42289 (QuantReg: 11.97319) QuantErr: 11.97319 batch_time=0.33990 
Train Epoch: 23 [296/1000 9472/32000 (30%)] Loss: 0.27624 (QuantReg: 12.73114) QuantErr: 12.73114 batch_time=0.34135 
Train Epoch: 23 [301/1000 9632/32000 (30%)] Loss: 0.35453 (QuantReg: 12.76663) QuantErr: 12.76663 batch_time=0.33674 
Train Epoch: 23 [306/1000 9792/32000 (31%)] Loss: 0.68753 (QuantReg: 12.18614) QuantErr: 12.18614 batch_time=0.33323 
Train Epoch: 23 [311/1000 9952/32000 (31%)] Loss: 0.64653 (QuantReg: 12.34944) QuantErr: 12.34944 batch_time=0.33901 
Train Epoch: 23 [316/1000 10112/32000 (32%)] Loss: 0.59178 (QuantReg: 12.11824) QuantErr: 12.11824 batch_time=0.34570 
Train Epoch: 23 [321/1000 10272/32000 (32%)] Loss: 0.21014 (QuantReg: 12.84556) QuantErr: 12.84556 batch_time=0.43252 
Train Epoch: 23 [326/1000 10432/32000 (33%)] Loss: 0.37916 (QuantReg: 12.38452) QuantErr: 12.38452 batch_time=0.35088 
Train Epoch: 23 [331/1000 10592/32000 (33%)] Loss: 0.37795 (QuantReg: 12.51843) QuantErr: 12.51843 batch_time=0.35248 
Train Epoch: 23 [336/1000 10752/32000 (34%)] Loss: 0.39181 (QuantReg: 12.34067) QuantErr: 12.34067 batch_time=0.73702 
Train Epoch: 23 [341/1000 10912/32000 (34%)] Loss: 0.21407 (QuantReg: 12.13856) QuantErr: 12.13856 batch_time=0.35038 
Train Epoch: 23 [346/1000 11072/32000 (35%)] Loss: 0.63030 (QuantReg: 12.51025) QuantErr: 12.51025 batch_time=0.41099 
Train Epoch: 23 [351/1000 11232/32000 (35%)] Loss: 0.26913 (QuantReg: 12.50137) QuantErr: 12.50137 batch_time=0.34646 
Train Epoch: 23 [356/1000 11392/32000 (36%)] Loss: 0.42515 (QuantReg: 12.35016) QuantErr: 12.35016 batch_time=0.34045 
Train Epoch: 23 [361/1000 11552/32000 (36%)] Loss: 0.38026 (QuantReg: 12.18864) QuantErr: 12.18864 batch_time=0.56121 
Train Epoch: 23 [366/1000 11712/32000 (37%)] Loss: 0.24183 (QuantReg: 11.82537) QuantErr: 11.82537 batch_time=0.38335 
Train Epoch: 23 [371/1000 11872/32000 (37%)] Loss: 0.44939 (QuantReg: 12.13114) QuantErr: 12.13114 batch_time=0.34651 
Train Epoch: 23 [376/1000 12032/32000 (38%)] Loss: 0.78982 (QuantReg: 11.81686) QuantErr: 11.81686 batch_time=0.34142 
Train Epoch: 23 [381/1000 12192/32000 (38%)] Loss: 0.77191 (QuantReg: 12.28874) QuantErr: 12.28874 batch_time=0.34154 
Train Epoch: 23 [386/1000 12352/32000 (39%)] Loss: 0.48542 (QuantReg: 12.57759) QuantErr: 12.57759 batch_time=0.34379 
Train Epoch: 23 [391/1000 12512/32000 (39%)] Loss: 0.21657 (QuantReg: 11.29271) QuantErr: 11.29271 batch_time=0.34378 
Train Epoch: 23 [396/1000 12672/32000 (40%)] Loss: 0.19944 (QuantReg: 12.16698) QuantErr: 12.16698 batch_time=0.36791 
Train Epoch: 23 [401/1000 12832/32000 (40%)] Loss: 0.30667 (QuantReg: 12.49113) QuantErr: 12.49113 batch_time=0.34320 
Train Epoch: 23 [406/1000 12992/32000 (41%)] Loss: 0.36186 (QuantReg: 12.13282) QuantErr: 12.13282 batch_time=0.34283 
Train Epoch: 23 [411/1000 13152/32000 (41%)] Loss: 0.29838 (QuantReg: 12.15089) QuantErr: 12.15089 batch_time=0.34148 
Train Epoch: 23 [416/1000 13312/32000 (42%)] Loss: 0.57449 (QuantReg: 12.03215) QuantErr: 12.03215 batch_time=0.37581 
Train Epoch: 23 [421/1000 13472/32000 (42%)] Loss: 0.29028 (QuantReg: 11.84782) QuantErr: 11.84782 batch_time=0.34345 
Train Epoch: 23 [426/1000 13632/32000 (43%)] Loss: 0.50295 (QuantReg: 12.18776) QuantErr: 12.18776 batch_time=0.39705 
Train Epoch: 23 [431/1000 13792/32000 (43%)] Loss: 0.30677 (QuantReg: 12.31360) QuantErr: 12.31360 batch_time=0.38687 
Train Epoch: 23 [436/1000 13952/32000 (44%)] Loss: 0.57007 (QuantReg: 12.71802) QuantErr: 12.71802 batch_time=0.34120 
Train Epoch: 23 [441/1000 14112/32000 (44%)] Loss: 0.51137 (QuantReg: 12.42369) QuantErr: 12.42369 batch_time=0.35089 
Train Epoch: 23 [446/1000 14272/32000 (45%)] Loss: 0.17096 (QuantReg: 12.95930) QuantErr: 12.95930 batch_time=0.34412 
Train Epoch: 23 [451/1000 14432/32000 (45%)] Loss: 0.47950 (QuantReg: 12.49429) QuantErr: 12.49429 batch_time=0.44669 
Train Epoch: 23 [456/1000 14592/32000 (46%)] Loss: 0.29892 (QuantReg: 13.11793) QuantErr: 13.11793 batch_time=0.44737 
Train Epoch: 23 [461/1000 14752/32000 (46%)] Loss: 0.83858 (QuantReg: 12.31107) QuantErr: 12.31107 batch_time=0.33688 
Train Epoch: 23 [466/1000 14912/32000 (47%)] Loss: 0.10403 (QuantReg: 13.11497) QuantErr: 13.11497 batch_time=0.54740 
Train Epoch: 23 [471/1000 15072/32000 (47%)] Loss: 0.53060 (QuantReg: 12.90278) QuantErr: 12.90278 batch_time=0.34060 
Train Epoch: 23 [476/1000 15232/32000 (48%)] Loss: 0.23630 (QuantReg: 12.92592) QuantErr: 12.92592 batch_time=0.34220 
Train Epoch: 23 [481/1000 15392/32000 (48%)] Loss: 0.46920 (QuantReg: 12.31436) QuantErr: 12.31436 batch_time=0.34586 
Train Epoch: 23 [486/1000 15552/32000 (49%)] Loss: 0.40401 (QuantReg: 12.24503) QuantErr: 12.24503 batch_time=0.42386 
Train Epoch: 23 [491/1000 15712/32000 (49%)] Loss: 0.40008 (QuantReg: 12.68566) QuantErr: 12.68566 batch_time=0.43629 
Train Epoch: 23 [496/1000 15872/32000 (50%)] Loss: 0.53061 (QuantReg: 11.79624) QuantErr: 11.79624 batch_time=0.66842 
Train Epoch: 23 [501/1000 16032/32000 (50%)] Loss: 0.76477 (QuantReg: 12.15695) QuantErr: 12.15695 batch_time=0.36470 
Train Epoch: 23 [506/1000 16192/32000 (51%)] Loss: 0.77054 (QuantReg: 12.04422) QuantErr: 12.04422 batch_time=0.38920 
Train Epoch: 23 [511/1000 16352/32000 (51%)] Loss: 0.51587 (QuantReg: 12.76219) QuantErr: 12.76219 batch_time=0.42842 
Train Epoch: 23 [516/1000 16512/32000 (52%)] Loss: 0.16652 (QuantReg: 12.45650) QuantErr: 12.45650 batch_time=0.81659 
Train Epoch: 23 [521/1000 16672/32000 (52%)] Loss: 0.33293 (QuantReg: 12.40555) QuantErr: 12.40555 batch_time=0.34028 
Train Epoch: 23 [526/1000 16832/32000 (53%)] Loss: 0.31794 (QuantReg: 12.68958) QuantErr: 12.68958 batch_time=0.34213 
Train Epoch: 23 [531/1000 16992/32000 (53%)] Loss: 0.43211 (QuantReg: 13.56254) QuantErr: 13.56254 batch_time=0.43238 
Train Epoch: 23 [536/1000 17152/32000 (54%)] Loss: 0.25417 (QuantReg: 12.24616) QuantErr: 12.24616 batch_time=0.34602 
Train Epoch: 23 [541/1000 17312/32000 (54%)] Loss: 0.22301 (QuantReg: 12.66353) QuantErr: 12.66353 batch_time=0.34425 
Train Epoch: 23 [546/1000 17472/32000 (55%)] Loss: 0.18759 (QuantReg: 12.78677) QuantErr: 12.78677 batch_time=0.35529 
Train Epoch: 23 [551/1000 17632/32000 (55%)] Loss: 0.58665 (QuantReg: 12.84395) QuantErr: 12.84395 batch_time=0.34803 
Train Epoch: 23 [556/1000 17792/32000 (56%)] Loss: 0.48938 (QuantReg: 12.29110) QuantErr: 12.29110 batch_time=0.34629 
Train Epoch: 23 [561/1000 17952/32000 (56%)] Loss: 0.48092 (QuantReg: 13.05587) QuantErr: 13.05587 batch_time=0.34705 
Train Epoch: 23 [566/1000 18112/32000 (57%)] Loss: 0.65238 (QuantReg: 12.13751) QuantErr: 12.13751 batch_time=0.36159 
Train Epoch: 23 [571/1000 18272/32000 (57%)] Loss: 0.27673 (QuantReg: 12.31488) QuantErr: 12.31488 batch_time=0.36189 
Train Epoch: 23 [576/1000 18432/32000 (58%)] Loss: 0.42039 (QuantReg: 12.66939) QuantErr: 12.66939 batch_time=0.38578 
Train Epoch: 23 [581/1000 18592/32000 (58%)] Loss: 0.53250 (QuantReg: 12.45223) QuantErr: 12.45223 batch_time=0.39433 
Train Epoch: 23 [586/1000 18752/32000 (59%)] Loss: 0.54860 (QuantReg: 12.14813) QuantErr: 12.14813 batch_time=0.36669 
Train Epoch: 23 [591/1000 18912/32000 (59%)] Loss: 0.27354 (QuantReg: 12.30824) QuantErr: 12.30824 batch_time=0.34943 
Train Epoch: 23 [596/1000 19072/32000 (60%)] Loss: 0.39718 (QuantReg: 12.38492) QuantErr: 12.38492 batch_time=0.63479 
Train Epoch: 23 [601/1000 19232/32000 (60%)] Loss: 0.61262 (QuantReg: 12.48931) QuantErr: 12.48931 batch_time=0.34504 
Train Epoch: 23 [606/1000 19392/32000 (61%)] Loss: 0.48441 (QuantReg: 12.73400) QuantErr: 12.73400 batch_time=0.34319 
Train Epoch: 23 [611/1000 19552/32000 (61%)] Loss: 0.66729 (QuantReg: 12.68835) QuantErr: 12.68835 batch_time=0.34093 
Train Epoch: 23 [616/1000 19712/32000 (62%)] Loss: 0.47135 (QuantReg: 12.62842) QuantErr: 12.62842 batch_time=0.34894 
Train Epoch: 23 [621/1000 19872/32000 (62%)] Loss: 0.34072 (QuantReg: 12.71967) QuantErr: 12.71967 batch_time=0.35247 
Train Epoch: 23 [626/1000 20032/32000 (63%)] Loss: 0.43640 (QuantReg: 12.30264) QuantErr: 12.30264 batch_time=0.34687 
Train Epoch: 23 [631/1000 20192/32000 (63%)] Loss: 0.34800 (QuantReg: 12.89808) QuantErr: 12.89808 batch_time=0.41234 
Train Epoch: 23 [636/1000 20352/32000 (64%)] Loss: 0.37087 (QuantReg: 12.87202) QuantErr: 12.87202 batch_time=0.35950 
Train Epoch: 23 [641/1000 20512/32000 (64%)] Loss: 0.16678 (QuantReg: 12.39648) QuantErr: 12.39648 batch_time=0.45292 
Train Epoch: 23 [646/1000 20672/32000 (65%)] Loss: 0.76453 (QuantReg: 12.86153) QuantErr: 12.86153 batch_time=0.35171 
Train Epoch: 23 [651/1000 20832/32000 (65%)] Loss: 0.27659 (QuantReg: 12.62552) QuantErr: 12.62552 batch_time=0.35187 
Train Epoch: 23 [656/1000 20992/32000 (66%)] Loss: 0.10553 (QuantReg: 12.52706) QuantErr: 12.52706 batch_time=0.70178 
Train Epoch: 23 [661/1000 21152/32000 (66%)] Loss: 0.33039 (QuantReg: 12.50705) QuantErr: 12.50705 batch_time=0.38394 
Train Epoch: 23 [666/1000 21312/32000 (67%)] Loss: 0.21977 (QuantReg: 12.32817) QuantErr: 12.32817 batch_time=0.41912 
Train Epoch: 23 [671/1000 21472/32000 (67%)] Loss: 0.71683 (QuantReg: 11.65615) QuantErr: 11.65615 batch_time=0.35215 
Train Epoch: 23 [676/1000 21632/32000 (68%)] Loss: 0.40298 (QuantReg: 12.37680) QuantErr: 12.37680 batch_time=0.35650 
Train Epoch: 23 [681/1000 21792/32000 (68%)] Loss: 0.51693 (QuantReg: 12.46691) QuantErr: 12.46691 batch_time=0.55780 
Train Epoch: 23 [686/1000 21952/32000 (69%)] Loss: 0.48935 (QuantReg: 12.12141) QuantErr: 12.12141 batch_time=0.38003 
Train Epoch: 23 [691/1000 22112/32000 (69%)] Loss: 0.43140 (QuantReg: 11.88224) QuantErr: 11.88224 batch_time=0.36757 
Train Epoch: 23 [696/1000 22272/32000 (70%)] Loss: 0.48070 (QuantReg: 12.61686) QuantErr: 12.61686 batch_time=0.35648 
Train Epoch: 23 [701/1000 22432/32000 (70%)] Loss: 0.74199 (QuantReg: 12.71798) QuantErr: 12.71798 batch_time=0.36936 
Train Epoch: 23 [706/1000 22592/32000 (71%)] Loss: 0.75076 (QuantReg: 13.35209) QuantErr: 13.35209 batch_time=0.34806 
Train Epoch: 23 [711/1000 22752/32000 (71%)] Loss: 0.31306 (QuantReg: 13.06964) QuantErr: 13.06964 batch_time=0.35792 
Train Epoch: 23 [716/1000 22912/32000 (72%)] Loss: 0.67402 (QuantReg: 13.35886) QuantErr: 13.35886 batch_time=0.36056 
Train Epoch: 23 [721/1000 23072/32000 (72%)] Loss: 0.57094 (QuantReg: 12.26417) QuantErr: 12.26417 batch_time=0.34462 
Train Epoch: 23 [726/1000 23232/32000 (73%)] Loss: 0.61459 (QuantReg: 12.41087) QuantErr: 12.41087 batch_time=0.35279 
Train Epoch: 23 [731/1000 23392/32000 (73%)] Loss: 1.30859 (QuantReg: 12.80751) QuantErr: 12.80751 batch_time=0.36570 
Train Epoch: 23 [736/1000 23552/32000 (74%)] Loss: 0.24743 (QuantReg: 12.51600) QuantErr: 12.51600 batch_time=0.35810 
Train Epoch: 23 [741/1000 23712/32000 (74%)] Loss: 0.37359 (QuantReg: 13.13595) QuantErr: 13.13595 batch_time=0.35404 
Train Epoch: 23 [746/1000 23872/32000 (75%)] Loss: 0.15171 (QuantReg: 12.56050) QuantErr: 12.56050 batch_time=0.35948 
Train Epoch: 23 [751/1000 24032/32000 (75%)] Loss: 0.32877 (QuantReg: 12.86349) QuantErr: 12.86349 batch_time=0.37666 
Train Epoch: 23 [756/1000 24192/32000 (76%)] Loss: 0.30020 (QuantReg: 12.69083) QuantErr: 12.69083 batch_time=0.35842 
Train Epoch: 23 [761/1000 24352/32000 (76%)] Loss: 0.55384 (QuantReg: 11.81023) QuantErr: 11.81023 batch_time=0.34676 
Train Epoch: 23 [766/1000 24512/32000 (77%)] Loss: 0.53061 (QuantReg: 13.12224) QuantErr: 13.12224 batch_time=0.34374 
Train Epoch: 23 [771/1000 24672/32000 (77%)] Loss: 0.88789 (QuantReg: 11.68368) QuantErr: 11.68368 batch_time=0.44936 
Train Epoch: 23 [776/1000 24832/32000 (78%)] Loss: 0.26825 (QuantReg: 12.60078) QuantErr: 12.60078 batch_time=0.50512 
Train Epoch: 23 [781/1000 24992/32000 (78%)] Loss: 0.62778 (QuantReg: 13.38729) QuantErr: 13.38729 batch_time=0.38572 
Train Epoch: 23 [786/1000 25152/32000 (79%)] Loss: 0.71779 (QuantReg: 12.73561) QuantErr: 12.73561 batch_time=0.63821 
Train Epoch: 23 [791/1000 25312/32000 (79%)] Loss: 0.14734 (QuantReg: 12.03266) QuantErr: 12.03266 batch_time=0.40757 
Train Epoch: 23 [796/1000 25472/32000 (80%)] Loss: 0.22666 (QuantReg: 13.20077) QuantErr: 13.20077 batch_time=0.37675 
Train Epoch: 23 [801/1000 25632/32000 (80%)] Loss: 0.56956 (QuantReg: 12.91621) QuantErr: 12.91621 batch_time=0.41761 
Train Epoch: 23 [806/1000 25792/32000 (81%)] Loss: 0.75804 (QuantReg: 11.78844) QuantErr: 11.78844 batch_time=0.38308 
Train Epoch: 23 [811/1000 25952/32000 (81%)] Loss: 0.36344 (QuantReg: 12.54819) QuantErr: 12.54819 batch_time=0.45980 
Train Epoch: 23 [816/1000 26112/32000 (82%)] Loss: 0.14517 (QuantReg: 13.02886) QuantErr: 13.02886 batch_time=0.72820 
Train Epoch: 23 [821/1000 26272/32000 (82%)] Loss: 0.43285 (QuantReg: 12.89876) QuantErr: 12.89876 batch_time=0.44014 
Train Epoch: 23 [826/1000 26432/32000 (83%)] Loss: 0.38566 (QuantReg: 12.20216) QuantErr: 12.20216 batch_time=0.36403 
Train Epoch: 23 [831/1000 26592/32000 (83%)] Loss: 0.18848 (QuantReg: 12.32609) QuantErr: 12.32609 batch_time=0.37126 
Train Epoch: 23 [836/1000 26752/32000 (84%)] Loss: 0.19273 (QuantReg: 12.45083) QuantErr: 12.45083 batch_time=0.94014 
Train Epoch: 23 [841/1000 26912/32000 (84%)] Loss: 0.32236 (QuantReg: 12.22033) QuantErr: 12.22033 batch_time=0.41736 
Train Epoch: 23 [846/1000 27072/32000 (85%)] Loss: 0.42552 (QuantReg: 12.45994) QuantErr: 12.45994 batch_time=0.36258 
Train Epoch: 23 [851/1000 27232/32000 (85%)] Loss: 0.18234 (QuantReg: 12.50924) QuantErr: 12.50924 batch_time=0.48271 
Train Epoch: 23 [856/1000 27392/32000 (86%)] Loss: 0.20168 (QuantReg: 12.47351) QuantErr: 12.47351 batch_time=0.38030 
Train Epoch: 23 [861/1000 27552/32000 (86%)] Loss: 0.51406 (QuantReg: 12.66215) QuantErr: 12.66215 batch_time=0.35114 
Train Epoch: 23 [866/1000 27712/32000 (87%)] Loss: 0.22236 (QuantReg: 12.85284) QuantErr: 12.85284 batch_time=0.35133 
Train Epoch: 23 [871/1000 27872/32000 (87%)] Loss: 0.19929 (QuantReg: 12.54176) QuantErr: 12.54176 batch_time=0.36340 
Train Epoch: 23 [876/1000 28032/32000 (88%)] Loss: 0.54146 (QuantReg: 12.12147) QuantErr: 12.12147 batch_time=0.34568 
Train Epoch: 23 [881/1000 28192/32000 (88%)] Loss: 0.86048 (QuantReg: 12.13202) QuantErr: 12.13202 batch_time=0.35123 
Train Epoch: 23 [886/1000 28352/32000 (89%)] Loss: 0.32051 (QuantReg: 13.04393) QuantErr: 13.04393 batch_time=0.35102 
Train Epoch: 23 [891/1000 28512/32000 (89%)] Loss: 0.53091 (QuantReg: 12.04974) QuantErr: 12.04974 batch_time=0.35288 
Train Epoch: 23 [896/1000 28672/32000 (90%)] Loss: 0.34626 (QuantReg: 12.56618) QuantErr: 12.56618 batch_time=0.34872 
Train Epoch: 23 [901/1000 28832/32000 (90%)] Loss: 0.45206 (QuantReg: 12.36882) QuantErr: 12.36882 batch_time=0.34843 
Train Epoch: 23 [906/1000 28992/32000 (91%)] Loss: 0.18172 (QuantReg: 12.77119) QuantErr: 12.77119 batch_time=0.34373 
Train Epoch: 23 [911/1000 29152/32000 (91%)] Loss: 0.20521 (QuantReg: 12.91596) QuantErr: 12.91596 batch_time=0.34248 
Train Epoch: 23 [916/1000 29312/32000 (92%)] Loss: 0.39943 (QuantReg: 13.06951) QuantErr: 13.06951 batch_time=0.34779 
Train Epoch: 23 [921/1000 29472/32000 (92%)] Loss: 0.24760 (QuantReg: 12.40213) QuantErr: 12.40213 batch_time=0.35515 
Train Epoch: 23 [926/1000 29632/32000 (93%)] Loss: 0.61389 (QuantReg: 13.23421) QuantErr: 13.23421 batch_time=0.35080 
Train Epoch: 23 [931/1000 29792/32000 (93%)] Loss: 0.68682 (QuantReg: 12.74193) QuantErr: 12.74193 batch_time=0.39786 
Train Epoch: 23 [936/1000 29952/32000 (94%)] Loss: 0.47849 (QuantReg: 12.86574) QuantErr: 12.86574 batch_time=0.40855 
Train Epoch: 23 [941/1000 30112/32000 (94%)] Loss: 0.38313 (QuantReg: 12.46972) QuantErr: 12.46972 batch_time=0.37843 
Train Epoch: 23 [946/1000 30272/32000 (95%)] Loss: 0.79531 (QuantReg: 12.60183) QuantErr: 12.60183 batch_time=0.34725 
Train Epoch: 23 [951/1000 30432/32000 (95%)] Loss: 0.19118 (QuantReg: 13.13024) QuantErr: 13.13024 batch_time=0.34531 
Train Epoch: 23 [956/1000 30592/32000 (96%)] Loss: 0.30493 (QuantReg: 13.50285) QuantErr: 13.50285 batch_time=0.37025 
Train Epoch: 23 [961/1000 30752/32000 (96%)] Loss: 0.78421 (QuantReg: 12.42654) QuantErr: 12.42654 batch_time=0.43334 
Train Epoch: 23 [966/1000 30912/32000 (97%)] Loss: 0.38394 (QuantReg: 12.36103) QuantErr: 12.36103 batch_time=0.35472 
Train Epoch: 23 [971/1000 31072/32000 (97%)] Loss: 0.28575 (QuantReg: 11.79721) QuantErr: 11.79721 batch_time=0.35836 
Train Epoch: 23 [976/1000 31232/32000 (98%)] Loss: 0.22784 (QuantReg: 12.60767) QuantErr: 12.60767 batch_time=0.70720 
Train Epoch: 23 [981/1000 31392/32000 (98%)] Loss: 0.30753 (QuantReg: 12.30307) QuantErr: 12.30307 batch_time=0.35645 
Train Epoch: 23 [986/1000 31552/32000 (99%)] Loss: 0.42419 (QuantReg: 11.80021) QuantErr: 11.80021 batch_time=0.43957 
Train Epoch: 23 [991/1000 31712/32000 (99%)] Loss: 0.31341 (QuantReg: 12.39226) QuantErr: 12.39226 batch_time=0.45144 
Train Epoch: 23 [996/1000 31872/32000 (100%)] Loss: 0.21718 (QuantReg: 12.59581) QuantErr: 12.59581 batch_time=0.38306 
Train Epoch: 23 codebook_update_time=1.74310
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch23.pth ...
Done in 4.098s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch23.pth ...
Done in 8.087s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 0.42469127348810437
 quant_reg      : 12.463534629821778
 quant_err      : 12.463534629821778
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 23000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 71.0261569416499
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.824949698189135
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.58967080476207
 MSRVTT_full_val/v2t_metrics/R1: 33.40040241448692
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 85.31187122736418
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.577464788732394
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.585929010385954
 MSRVTT_full_test/t2v_metrics/R1: 11.806020066889632
 MSRVTT_full_test/t2v_metrics/R5: 35.68561872909699
 MSRVTT_full_test/t2v_metrics/R10: 49.89966555183946
 MSRVTT_full_test/t2v_metrics/R50: 82.40802675585284
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.81070234113712
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.599303841463385
 MSRVTT_full_test/v2t_metrics/R1: 14.949832775919733
 MSRVTT_full_test/v2t_metrics/R5: 41.23745819397993
 MSRVTT_full_test/v2t_metrics/R10: 55.551839464882946
 MSRVTT_full_test/v2t_metrics/R50: 85.38461538461539
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.225752508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.47448125424446
 mnt_best       : 27.599303841463385
 not_improved_count: 0
Train Epoch: 24 [1/1000 32/32000 (0%)] Loss: 0.26729 (QuantReg: 12.77470) QuantErr: 12.77470 batch_time=27.20490 
Train Epoch: 24 [6/1000 192/32000 (1%)] Loss: 0.39978 (QuantReg: 12.16203) QuantErr: 12.16203 batch_time=0.34739 
Train Epoch: 24 [11/1000 352/32000 (1%)] Loss: 0.98028 (QuantReg: 12.06056) QuantErr: 12.06056 batch_time=0.34548 
Train Epoch: 24 [16/1000 512/32000 (2%)] Loss: 0.45030 (QuantReg: 12.24755) QuantErr: 12.24755 batch_time=0.38329 
Train Epoch: 24 [21/1000 672/32000 (2%)] Loss: 0.69118 (QuantReg: 12.09087) QuantErr: 12.09087 batch_time=0.39966 
Train Epoch: 24 [26/1000 832/32000 (3%)] Loss: 0.70113 (QuantReg: 11.58014) QuantErr: 11.58014 batch_time=0.74516 
Train Epoch: 24 [31/1000 992/32000 (3%)] Loss: 0.43414 (QuantReg: 11.64380) QuantErr: 11.64380 batch_time=0.35605 
Train Epoch: 24 [36/1000 1152/32000 (4%)] Loss: 0.30049 (QuantReg: 12.81693) QuantErr: 12.81693 batch_time=0.35531 
Train Epoch: 24 [41/1000 1312/32000 (4%)] Loss: 0.31958 (QuantReg: 12.17218) QuantErr: 12.17218 batch_time=0.37195 
Train Epoch: 24 [46/1000 1472/32000 (5%)] Loss: 0.30019 (QuantReg: 12.26614) QuantErr: 12.26614 batch_time=0.36391 
Train Epoch: 24 [51/1000 1632/32000 (5%)] Loss: 0.39645 (QuantReg: 12.45588) QuantErr: 12.45588 batch_time=0.35784 
Train Epoch: 24 [56/1000 1792/32000 (6%)] Loss: 0.19484 (QuantReg: 12.56448) QuantErr: 12.56448 batch_time=0.38639 
Train Epoch: 24 [61/1000 1952/32000 (6%)] Loss: 0.23426 (QuantReg: 12.64089) QuantErr: 12.64089 batch_time=0.35309 
Train Epoch: 24 [66/1000 2112/32000 (7%)] Loss: 0.82168 (QuantReg: 12.00588) QuantErr: 12.00588 batch_time=1.30667 
Train Epoch: 24 [71/1000 2272/32000 (7%)] Loss: 0.56940 (QuantReg: 12.19368) QuantErr: 12.19368 batch_time=0.35491 
Train Epoch: 24 [76/1000 2432/32000 (8%)] Loss: 0.20442 (QuantReg: 12.53545) QuantErr: 12.53545 batch_time=0.34949 
Train Epoch: 24 [81/1000 2592/32000 (8%)] Loss: 0.67608 (QuantReg: 11.84403) QuantErr: 11.84403 batch_time=0.75752 
Train Epoch: 24 [86/1000 2752/32000 (9%)] Loss: 0.42567 (QuantReg: 12.49422) QuantErr: 12.49422 batch_time=0.34737 
Train Epoch: 24 [91/1000 2912/32000 (9%)] Loss: 0.57046 (QuantReg: 12.45987) QuantErr: 12.45987 batch_time=0.39661 
Train Epoch: 24 [96/1000 3072/32000 (10%)] Loss: 0.48411 (QuantReg: 12.67637) QuantErr: 12.67637 batch_time=0.35451 
Train Epoch: 24 [101/1000 3232/32000 (10%)] Loss: 0.49539 (QuantReg: 12.52899) QuantErr: 12.52899 batch_time=0.40535 
Train Epoch: 24 [106/1000 3392/32000 (11%)] Loss: 0.35552 (QuantReg: 12.19372) QuantErr: 12.19372 batch_time=0.42482 
Train Epoch: 24 [111/1000 3552/32000 (11%)] Loss: 0.25618 (QuantReg: 12.08257) QuantErr: 12.08257 batch_time=0.37677 
Train Epoch: 24 [116/1000 3712/32000 (12%)] Loss: 0.33349 (QuantReg: 12.72755) QuantErr: 12.72755 batch_time=0.34918 
Train Epoch: 24 [121/1000 3872/32000 (12%)] Loss: 0.87086 (QuantReg: 10.89790) QuantErr: 10.89790 batch_time=0.36001 
Train Epoch: 24 [126/1000 4032/32000 (13%)] Loss: 0.97455 (QuantReg: 12.17685) QuantErr: 12.17685 batch_time=0.34889 
Train Epoch: 24 [131/1000 4192/32000 (13%)] Loss: 0.20420 (QuantReg: 12.19673) QuantErr: 12.19673 batch_time=0.35143 
Train Epoch: 24 [136/1000 4352/32000 (14%)] Loss: 0.28945 (QuantReg: 12.84158) QuantErr: 12.84158 batch_time=0.34776 
Train Epoch: 24 [141/1000 4512/32000 (14%)] Loss: 0.38380 (QuantReg: 12.48237) QuantErr: 12.48237 batch_time=0.37155 
Train Epoch: 24 [146/1000 4672/32000 (15%)] Loss: 0.41080 (QuantReg: 12.22357) QuantErr: 12.22357 batch_time=0.37229 
Train Epoch: 24 [151/1000 4832/32000 (15%)] Loss: 0.39972 (QuantReg: 12.78878) QuantErr: 12.78878 batch_time=0.37440 
Train Epoch: 24 [156/1000 4992/32000 (16%)] Loss: 0.19558 (QuantReg: 12.29293) QuantErr: 12.29293 batch_time=0.35825 
Train Epoch: 24 [161/1000 5152/32000 (16%)] Loss: 0.40359 (QuantReg: 12.53788) QuantErr: 12.53788 batch_time=0.34719 
Train Epoch: 24 [166/1000 5312/32000 (17%)] Loss: 0.46885 (QuantReg: 12.98937) QuantErr: 12.98937 batch_time=0.35138 
Train Epoch: 24 [171/1000 5472/32000 (17%)] Loss: 0.43566 (QuantReg: 12.25500) QuantErr: 12.25500 batch_time=0.40134 
Train Epoch: 24 [176/1000 5632/32000 (18%)] Loss: 0.36594 (QuantReg: 13.06477) QuantErr: 13.06477 batch_time=0.34812 
Train Epoch: 24 [181/1000 5792/32000 (18%)] Loss: 0.34529 (QuantReg: 12.58598) QuantErr: 12.58598 batch_time=0.34238 
Train Epoch: 24 [186/1000 5952/32000 (19%)] Loss: 0.22685 (QuantReg: 12.69512) QuantErr: 12.69512 batch_time=0.34819 
Train Epoch: 24 [191/1000 6112/32000 (19%)] Loss: 0.37849 (QuantReg: 12.39139) QuantErr: 12.39139 batch_time=0.40092 
Train Epoch: 24 [196/1000 6272/32000 (20%)] Loss: 1.08889 (QuantReg: 12.14133) QuantErr: 12.14133 batch_time=0.35780 
Train Epoch: 24 [201/1000 6432/32000 (20%)] Loss: 0.32515 (QuantReg: 12.21968) QuantErr: 12.21968 batch_time=0.35450 
Train Epoch: 24 [206/1000 6592/32000 (21%)] Loss: 0.90174 (QuantReg: 12.52686) QuantErr: 12.52686 batch_time=0.34415 
Train Epoch: 24 [211/1000 6752/32000 (21%)] Loss: 0.50449 (QuantReg: 11.92385) QuantErr: 11.92385 batch_time=0.34867 
Train Epoch: 24 [216/1000 6912/32000 (22%)] Loss: 0.53286 (QuantReg: 12.24932) QuantErr: 12.24932 batch_time=0.36577 
Train Epoch: 24 [221/1000 7072/32000 (22%)] Loss: 0.28710 (QuantReg: 12.33536) QuantErr: 12.33536 batch_time=0.34402 
Train Epoch: 24 [226/1000 7232/32000 (23%)] Loss: 0.18743 (QuantReg: 12.80321) QuantErr: 12.80321 batch_time=0.35525 
Train Epoch: 24 [231/1000 7392/32000 (23%)] Loss: 0.29558 (QuantReg: 12.27129) QuantErr: 12.27129 batch_time=0.35045 
Train Epoch: 24 [236/1000 7552/32000 (24%)] Loss: 0.24356 (QuantReg: 12.56918) QuantErr: 12.56918 batch_time=0.33680 
Train Epoch: 24 [241/1000 7712/32000 (24%)] Loss: 0.31611 (QuantReg: 12.65241) QuantErr: 12.65241 batch_time=0.34117 
Train Epoch: 24 [246/1000 7872/32000 (25%)] Loss: 0.36826 (QuantReg: 12.28262) QuantErr: 12.28262 batch_time=0.34283 
Train Epoch: 24 [251/1000 8032/32000 (25%)] Loss: 0.62692 (QuantReg: 12.79868) QuantErr: 12.79868 batch_time=0.34544 
Train Epoch: 24 [256/1000 8192/32000 (26%)] Loss: 0.37535 (QuantReg: 12.23767) QuantErr: 12.23767 batch_time=0.49202 
Train Epoch: 24 [261/1000 8352/32000 (26%)] Loss: 0.23412 (QuantReg: 13.31393) QuantErr: 13.31393 batch_time=0.34897 
Train Epoch: 24 [266/1000 8512/32000 (27%)] Loss: 0.18848 (QuantReg: 12.25743) QuantErr: 12.25743 batch_time=0.34680 
Train Epoch: 24 [271/1000 8672/32000 (27%)] Loss: 0.38764 (QuantReg: 12.09181) QuantErr: 12.09181 batch_time=0.34572 
Train Epoch: 24 [276/1000 8832/32000 (28%)] Loss: 0.32875 (QuantReg: 12.51993) QuantErr: 12.51993 batch_time=0.45953 
Train Epoch: 24 [281/1000 8992/32000 (28%)] Loss: 0.60706 (QuantReg: 13.39744) QuantErr: 13.39744 batch_time=0.34476 
Train Epoch: 24 [286/1000 9152/32000 (29%)] Loss: 0.14156 (QuantReg: 12.10793) QuantErr: 12.10793 batch_time=0.35985 
Train Epoch: 24 [291/1000 9312/32000 (29%)] Loss: 0.60949 (QuantReg: 12.27727) QuantErr: 12.27727 batch_time=0.34702 
Train Epoch: 24 [296/1000 9472/32000 (30%)] Loss: 0.42609 (QuantReg: 12.39469) QuantErr: 12.39469 batch_time=0.34587 
Train Epoch: 24 [301/1000 9632/32000 (30%)] Loss: 1.08527 (QuantReg: 11.99295) QuantErr: 11.99295 batch_time=0.37315 
Train Epoch: 24 [306/1000 9792/32000 (31%)] Loss: 0.44636 (QuantReg: 12.56721) QuantErr: 12.56721 batch_time=0.37051 
Train Epoch: 24 [311/1000 9952/32000 (31%)] Loss: 0.38028 (QuantReg: 12.37665) QuantErr: 12.37665 batch_time=0.35877 
Train Epoch: 24 [316/1000 10112/32000 (32%)] Loss: 0.29493 (QuantReg: 12.42154) QuantErr: 12.42154 batch_time=0.37005 
Train Epoch: 24 [321/1000 10272/32000 (32%)] Loss: 0.37079 (QuantReg: 12.53767) QuantErr: 12.53767 batch_time=0.40684 
Train Epoch: 24 [326/1000 10432/32000 (33%)] Loss: 0.18625 (QuantReg: 13.32969) QuantErr: 13.32969 batch_time=0.36020 
Train Epoch: 24 [331/1000 10592/32000 (33%)] Loss: 0.42620 (QuantReg: 12.70025) QuantErr: 12.70025 batch_time=0.34295 
Train Epoch: 24 [336/1000 10752/32000 (34%)] Loss: 0.29555 (QuantReg: 13.13086) QuantErr: 13.13086 batch_time=0.34834 
Train Epoch: 24 [341/1000 10912/32000 (34%)] Loss: 0.48695 (QuantReg: 12.51189) QuantErr: 12.51189 batch_time=0.38126 
Train Epoch: 24 [346/1000 11072/32000 (35%)] Loss: 0.17605 (QuantReg: 12.66020) QuantErr: 12.66020 batch_time=0.73104 
Train Epoch: 24 [351/1000 11232/32000 (35%)] Loss: 0.26034 (QuantReg: 12.23531) QuantErr: 12.23531 batch_time=0.46518 
Train Epoch: 24 [356/1000 11392/32000 (36%)] Loss: 0.46999 (QuantReg: 12.50488) QuantErr: 12.50488 batch_time=0.44700 
Train Epoch: 24 [361/1000 11552/32000 (36%)] Loss: 0.14104 (QuantReg: 12.06216) QuantErr: 12.06216 batch_time=0.38973 
Train Epoch: 24 [366/1000 11712/32000 (37%)] Loss: 0.18330 (QuantReg: 12.26080) QuantErr: 12.26080 batch_time=0.38503 
Train Epoch: 24 [371/1000 11872/32000 (37%)] Loss: 0.68721 (QuantReg: 13.04300) QuantErr: 13.04300 batch_time=0.35636 
Train Epoch: 24 [376/1000 12032/32000 (38%)] Loss: 0.38779 (QuantReg: 11.79293) QuantErr: 11.79293 batch_time=0.36180 
Train Epoch: 24 [381/1000 12192/32000 (38%)] Loss: 0.33855 (QuantReg: 12.57606) QuantErr: 12.57606 batch_time=0.37579 
Train Epoch: 24 [386/1000 12352/32000 (39%)] Loss: 0.37007 (QuantReg: 13.12760) QuantErr: 13.12760 batch_time=1.29036 
Train Epoch: 24 [391/1000 12512/32000 (39%)] Loss: 0.31322 (QuantReg: 12.21672) QuantErr: 12.21672 batch_time=0.36633 
Train Epoch: 24 [396/1000 12672/32000 (40%)] Loss: 0.43810 (QuantReg: 11.93890) QuantErr: 11.93890 batch_time=0.40209 
Train Epoch: 24 [401/1000 12832/32000 (40%)] Loss: 0.23284 (QuantReg: 13.03008) QuantErr: 13.03008 batch_time=0.87774 
Train Epoch: 24 [406/1000 12992/32000 (41%)] Loss: 0.27165 (QuantReg: 12.79932) QuantErr: 12.79932 batch_time=0.35429 
Train Epoch: 24 [411/1000 13152/32000 (41%)] Loss: 0.49575 (QuantReg: 12.00593) QuantErr: 12.00593 batch_time=0.37157 
Train Epoch: 24 [416/1000 13312/32000 (42%)] Loss: 0.71032 (QuantReg: 12.36894) QuantErr: 12.36894 batch_time=0.36947 
Train Epoch: 24 [421/1000 13472/32000 (42%)] Loss: 0.47014 (QuantReg: 12.08329) QuantErr: 12.08329 batch_time=0.34281 
Train Epoch: 24 [426/1000 13632/32000 (43%)] Loss: 0.48438 (QuantReg: 12.71160) QuantErr: 12.71160 batch_time=0.34274 
Train Epoch: 24 [431/1000 13792/32000 (43%)] Loss: 0.38939 (QuantReg: 13.05177) QuantErr: 13.05177 batch_time=0.34403 
Train Epoch: 24 [436/1000 13952/32000 (44%)] Loss: 0.27778 (QuantReg: 13.18009) QuantErr: 13.18009 batch_time=0.34505 
Train Epoch: 24 [441/1000 14112/32000 (44%)] Loss: 0.09983 (QuantReg: 12.50405) QuantErr: 12.50405 batch_time=0.34583 
Train Epoch: 24 [446/1000 14272/32000 (45%)] Loss: 0.29832 (QuantReg: 12.33899) QuantErr: 12.33899 batch_time=0.35535 
Train Epoch: 24 [451/1000 14432/32000 (45%)] Loss: 0.29353 (QuantReg: 12.47362) QuantErr: 12.47362 batch_time=0.34938 
Train Epoch: 24 [456/1000 14592/32000 (46%)] Loss: 0.42915 (QuantReg: 12.84825) QuantErr: 12.84825 batch_time=0.34547 
Train Epoch: 24 [461/1000 14752/32000 (46%)] Loss: 0.37391 (QuantReg: 12.31583) QuantErr: 12.31583 batch_time=0.35423 
Train Epoch: 24 [466/1000 14912/32000 (47%)] Loss: 0.44597 (QuantReg: 12.82109) QuantErr: 12.82109 batch_time=0.34584 
Train Epoch: 24 [471/1000 15072/32000 (47%)] Loss: 0.15288 (QuantReg: 13.05515) QuantErr: 13.05515 batch_time=0.34021 
Train Epoch: 24 [476/1000 15232/32000 (48%)] Loss: 0.84289 (QuantReg: 12.29693) QuantErr: 12.29693 batch_time=0.35649 
Train Epoch: 24 [481/1000 15392/32000 (48%)] Loss: 0.40816 (QuantReg: 12.63373) QuantErr: 12.63373 batch_time=0.36353 
Train Epoch: 24 [486/1000 15552/32000 (49%)] Loss: 0.48436 (QuantReg: 12.67210) QuantErr: 12.67210 batch_time=0.34195 
Train Epoch: 24 [491/1000 15712/32000 (49%)] Loss: 0.38942 (QuantReg: 12.11486) QuantErr: 12.11486 batch_time=0.35434 
Train Epoch: 24 [496/1000 15872/32000 (50%)] Loss: 0.27598 (QuantReg: 12.37154) QuantErr: 12.37154 batch_time=0.38746 
Train Epoch: 24 [501/1000 16032/32000 (50%)] Loss: 0.43000 (QuantReg: 11.51132) QuantErr: 11.51132 batch_time=0.34964 
Train Epoch: 24 [506/1000 16192/32000 (51%)] Loss: 0.24179 (QuantReg: 12.96472) QuantErr: 12.96472 batch_time=0.36418 
Train Epoch: 24 [511/1000 16352/32000 (51%)] Loss: 0.15209 (QuantReg: 12.32496) QuantErr: 12.32496 batch_time=0.40778 
Train Epoch: 24 [516/1000 16512/32000 (52%)] Loss: 0.43019 (QuantReg: 12.82025) QuantErr: 12.82025 batch_time=0.34527 
Train Epoch: 24 [521/1000 16672/32000 (52%)] Loss: 0.36433 (QuantReg: 12.66037) QuantErr: 12.66037 batch_time=0.34698 
Train Epoch: 24 [526/1000 16832/32000 (53%)] Loss: 0.21544 (QuantReg: 12.79876) QuantErr: 12.79876 batch_time=0.34401 
Train Epoch: 24 [531/1000 16992/32000 (53%)] Loss: 0.35602 (QuantReg: 13.14520) QuantErr: 13.14520 batch_time=0.34184 
Train Epoch: 24 [536/1000 17152/32000 (54%)] Loss: 0.61408 (QuantReg: 12.29693) QuantErr: 12.29693 batch_time=0.34268 
Train Epoch: 24 [541/1000 17312/32000 (54%)] Loss: 0.49062 (QuantReg: 12.40827) QuantErr: 12.40827 batch_time=0.33806 
Train Epoch: 24 [546/1000 17472/32000 (55%)] Loss: 0.18628 (QuantReg: 12.97135) QuantErr: 12.97135 batch_time=0.38807 
Train Epoch: 24 [551/1000 17632/32000 (55%)] Loss: 0.49835 (QuantReg: 12.76753) QuantErr: 12.76753 batch_time=0.33744 
Train Epoch: 24 [556/1000 17792/32000 (56%)] Loss: 0.34945 (QuantReg: 13.00015) QuantErr: 13.00015 batch_time=0.33927 
Train Epoch: 24 [561/1000 17952/32000 (56%)] Loss: 0.75228 (QuantReg: 12.35468) QuantErr: 12.35468 batch_time=0.35160 
Train Epoch: 24 [566/1000 18112/32000 (57%)] Loss: 0.42373 (QuantReg: 12.36101) QuantErr: 12.36101 batch_time=0.40040 
Train Epoch: 24 [571/1000 18272/32000 (57%)] Loss: 0.41026 (QuantReg: 12.71598) QuantErr: 12.71598 batch_time=0.43068 
Train Epoch: 24 [576/1000 18432/32000 (58%)] Loss: 0.32631 (QuantReg: 12.66544) QuantErr: 12.66544 batch_time=0.36792 
Train Epoch: 24 [581/1000 18592/32000 (58%)] Loss: 0.48600 (QuantReg: 12.77130) QuantErr: 12.77130 batch_time=0.38980 
Train Epoch: 24 [586/1000 18752/32000 (59%)] Loss: 0.29328 (QuantReg: 11.66435) QuantErr: 11.66435 batch_time=0.35253 
Train Epoch: 24 [591/1000 18912/32000 (59%)] Loss: 0.52007 (QuantReg: 12.48559) QuantErr: 12.48559 batch_time=0.35418 
Train Epoch: 24 [596/1000 19072/32000 (60%)] Loss: 0.65186 (QuantReg: 12.53499) QuantErr: 12.53499 batch_time=0.45753 
Train Epoch: 24 [601/1000 19232/32000 (60%)] Loss: 0.80323 (QuantReg: 12.17168) QuantErr: 12.17168 batch_time=0.34749 
Train Epoch: 24 [606/1000 19392/32000 (61%)] Loss: 0.19124 (QuantReg: 12.56674) QuantErr: 12.56674 batch_time=0.38841 
Train Epoch: 24 [611/1000 19552/32000 (61%)] Loss: 0.52010 (QuantReg: 12.63156) QuantErr: 12.63156 batch_time=0.40172 
Train Epoch: 24 [616/1000 19712/32000 (62%)] Loss: 0.40239 (QuantReg: 12.71229) QuantErr: 12.71229 batch_time=0.33987 
Train Epoch: 24 [621/1000 19872/32000 (62%)] Loss: 0.56598 (QuantReg: 12.40677) QuantErr: 12.40677 batch_time=0.33907 
Train Epoch: 24 [626/1000 20032/32000 (63%)] Loss: 0.17123 (QuantReg: 12.31770) QuantErr: 12.31770 batch_time=0.34648 
Train Epoch: 24 [631/1000 20192/32000 (63%)] Loss: 0.19267 (QuantReg: 12.85997) QuantErr: 12.85997 batch_time=0.36540 
Train Epoch: 24 [636/1000 20352/32000 (64%)] Loss: 0.10575 (QuantReg: 12.94738) QuantErr: 12.94738 batch_time=0.36004 
Train Epoch: 24 [641/1000 20512/32000 (64%)] Loss: 0.38346 (QuantReg: 12.42813) QuantErr: 12.42813 batch_time=0.40264 
Train Epoch: 24 [646/1000 20672/32000 (65%)] Loss: 0.70217 (QuantReg: 12.18985) QuantErr: 12.18985 batch_time=0.34285 
Train Epoch: 24 [651/1000 20832/32000 (65%)] Loss: 0.21467 (QuantReg: 12.52290) QuantErr: 12.52290 batch_time=0.34762 
Train Epoch: 24 [656/1000 20992/32000 (66%)] Loss: 0.40175 (QuantReg: 12.54411) QuantErr: 12.54411 batch_time=0.36558 
Train Epoch: 24 [661/1000 21152/32000 (66%)] Loss: 0.22260 (QuantReg: 12.56407) QuantErr: 12.56407 batch_time=0.37355 
Train Epoch: 24 [666/1000 21312/32000 (67%)] Loss: 0.34787 (QuantReg: 13.14857) QuantErr: 13.14857 batch_time=0.64520 
Train Epoch: 24 [671/1000 21472/32000 (67%)] Loss: 0.22808 (QuantReg: 12.34980) QuantErr: 12.34980 batch_time=0.34792 
Train Epoch: 24 [676/1000 21632/32000 (68%)] Loss: 0.47706 (QuantReg: 12.95651) QuantErr: 12.95651 batch_time=0.55422 
Train Epoch: 24 [681/1000 21792/32000 (68%)] Loss: 0.12712 (QuantReg: 12.73632) QuantErr: 12.73632 batch_time=0.33875 
Train Epoch: 24 [686/1000 21952/32000 (69%)] Loss: 0.57992 (QuantReg: 12.02910) QuantErr: 12.02910 batch_time=0.34511 
Train Epoch: 24 [691/1000 22112/32000 (69%)] Loss: 0.50444 (QuantReg: 12.24164) QuantErr: 12.24164 batch_time=0.37036 
Train Epoch: 24 [696/1000 22272/32000 (70%)] Loss: 0.19857 (QuantReg: 12.79186) QuantErr: 12.79186 batch_time=0.34058 
Train Epoch: 24 [701/1000 22432/32000 (70%)] Loss: 0.40278 (QuantReg: 11.82587) QuantErr: 11.82587 batch_time=0.34296 
Train Epoch: 24 [706/1000 22592/32000 (71%)] Loss: 0.61816 (QuantReg: 12.33651) QuantErr: 12.33651 batch_time=1.18524 
Train Epoch: 24 [711/1000 22752/32000 (71%)] Loss: 0.20104 (QuantReg: 12.99367) QuantErr: 12.99367 batch_time=0.34335 
Train Epoch: 24 [716/1000 22912/32000 (72%)] Loss: 0.44855 (QuantReg: 12.51305) QuantErr: 12.51305 batch_time=0.35196 
Train Epoch: 24 [721/1000 23072/32000 (72%)] Loss: 0.38217 (QuantReg: 13.08954) QuantErr: 13.08954 batch_time=0.79309 
Train Epoch: 24 [726/1000 23232/32000 (73%)] Loss: 0.42714 (QuantReg: 12.70955) QuantErr: 12.70955 batch_time=0.35099 
Train Epoch: 24 [731/1000 23392/32000 (73%)] Loss: 0.33877 (QuantReg: 11.94211) QuantErr: 11.94211 batch_time=0.35821 
Train Epoch: 24 [736/1000 23552/32000 (74%)] Loss: 0.44252 (QuantReg: 12.23588) QuantErr: 12.23588 batch_time=0.34147 
Train Epoch: 24 [741/1000 23712/32000 (74%)] Loss: 0.41740 (QuantReg: 12.34368) QuantErr: 12.34368 batch_time=0.34678 
Train Epoch: 24 [746/1000 23872/32000 (75%)] Loss: 0.32051 (QuantReg: 13.07502) QuantErr: 13.07502 batch_time=0.34242 
Train Epoch: 24 [751/1000 24032/32000 (75%)] Loss: 0.44438 (QuantReg: 13.00294) QuantErr: 13.00294 batch_time=0.35835 
Train Epoch: 24 [756/1000 24192/32000 (76%)] Loss: 0.43169 (QuantReg: 12.22722) QuantErr: 12.22722 batch_time=0.35889 
Train Epoch: 24 [761/1000 24352/32000 (76%)] Loss: 0.53921 (QuantReg: 11.77726) QuantErr: 11.77726 batch_time=0.34361 
Train Epoch: 24 [766/1000 24512/32000 (77%)] Loss: 0.46112 (QuantReg: 12.24709) QuantErr: 12.24709 batch_time=0.35453 
Train Epoch: 24 [771/1000 24672/32000 (77%)] Loss: 0.45033 (QuantReg: 12.37154) QuantErr: 12.37154 batch_time=0.36121 
Train Epoch: 24 [776/1000 24832/32000 (78%)] Loss: 0.88891 (QuantReg: 12.07183) QuantErr: 12.07183 batch_time=0.34820 
Train Epoch: 24 [781/1000 24992/32000 (78%)] Loss: 0.30508 (QuantReg: 12.38297) QuantErr: 12.38297 batch_time=0.35209 
Train Epoch: 24 [786/1000 25152/32000 (79%)] Loss: 0.21159 (QuantReg: 12.40728) QuantErr: 12.40728 batch_time=0.37335 
Train Epoch: 24 [791/1000 25312/32000 (79%)] Loss: 0.16380 (QuantReg: 13.18388) QuantErr: 13.18388 batch_time=0.35103 
Train Epoch: 24 [796/1000 25472/32000 (80%)] Loss: 0.97294 (QuantReg: 12.38971) QuantErr: 12.38971 batch_time=0.36199 
Train Epoch: 24 [801/1000 25632/32000 (80%)] Loss: 0.29009 (QuantReg: 12.63039) QuantErr: 12.63039 batch_time=0.36823 
Train Epoch: 24 [806/1000 25792/32000 (81%)] Loss: 0.41337 (QuantReg: 12.10442) QuantErr: 12.10442 batch_time=0.41583 
Train Epoch: 24 [811/1000 25952/32000 (81%)] Loss: 1.22719 (QuantReg: 12.48698) QuantErr: 12.48698 batch_time=0.36885 
Train Epoch: 24 [816/1000 26112/32000 (82%)] Loss: 0.63154 (QuantReg: 12.53567) QuantErr: 12.53567 batch_time=0.39193 
Train Epoch: 24 [821/1000 26272/32000 (82%)] Loss: 0.41444 (QuantReg: 13.36740) QuantErr: 13.36740 batch_time=0.34649 
Train Epoch: 24 [826/1000 26432/32000 (83%)] Loss: 0.09971 (QuantReg: 12.82772) QuantErr: 12.82772 batch_time=0.35509 
Train Epoch: 24 [831/1000 26592/32000 (83%)] Loss: 0.44511 (QuantReg: 12.38369) QuantErr: 12.38369 batch_time=0.45928 
Train Epoch: 24 [836/1000 26752/32000 (84%)] Loss: 0.61975 (QuantReg: 12.17219) QuantErr: 12.17219 batch_time=0.38922 
Train Epoch: 24 [841/1000 26912/32000 (84%)] Loss: 0.71645 (QuantReg: 11.66195) QuantErr: 11.66195 batch_time=0.35430 
Train Epoch: 24 [846/1000 27072/32000 (85%)] Loss: 0.42405 (QuantReg: 12.41963) QuantErr: 12.41963 batch_time=0.34953 
Train Epoch: 24 [851/1000 27232/32000 (85%)] Loss: 0.43068 (QuantReg: 11.94424) QuantErr: 11.94424 batch_time=0.35063 
Train Epoch: 24 [856/1000 27392/32000 (86%)] Loss: 0.26761 (QuantReg: 12.45437) QuantErr: 12.45437 batch_time=0.34993 
Train Epoch: 24 [861/1000 27552/32000 (86%)] Loss: 0.82896 (QuantReg: 12.17379) QuantErr: 12.17379 batch_time=0.36551 
Train Epoch: 24 [866/1000 27712/32000 (87%)] Loss: 0.17197 (QuantReg: 12.30864) QuantErr: 12.30864 batch_time=0.46788 
Train Epoch: 24 [871/1000 27872/32000 (87%)] Loss: 0.65118 (QuantReg: 11.63439) QuantErr: 11.63439 batch_time=0.44648 
Train Epoch: 24 [876/1000 28032/32000 (88%)] Loss: 0.30056 (QuantReg: 13.04365) QuantErr: 13.04365 batch_time=0.35703 
Train Epoch: 24 [881/1000 28192/32000 (88%)] Loss: 0.44126 (QuantReg: 12.30481) QuantErr: 12.30481 batch_time=0.41072 
Train Epoch: 24 [886/1000 28352/32000 (89%)] Loss: 0.66936 (QuantReg: 12.16562) QuantErr: 12.16562 batch_time=0.37151 
Train Epoch: 24 [891/1000 28512/32000 (89%)] Loss: 0.23662 (QuantReg: 12.77810) QuantErr: 12.77810 batch_time=0.43852 
Train Epoch: 24 [896/1000 28672/32000 (90%)] Loss: 0.35985 (QuantReg: 12.51562) QuantErr: 12.51562 batch_time=0.37449 
Train Epoch: 24 [901/1000 28832/32000 (90%)] Loss: 0.26965 (QuantReg: 12.14337) QuantErr: 12.14337 batch_time=0.35364 
Train Epoch: 24 [906/1000 28992/32000 (91%)] Loss: 0.22494 (QuantReg: 13.15694) QuantErr: 13.15694 batch_time=0.34620 
Train Epoch: 24 [911/1000 29152/32000 (91%)] Loss: 0.16759 (QuantReg: 12.85857) QuantErr: 12.85857 batch_time=0.37778 
Train Epoch: 24 [916/1000 29312/32000 (92%)] Loss: 1.11316 (QuantReg: 12.67735) QuantErr: 12.67735 batch_time=0.48696 
Train Epoch: 24 [921/1000 29472/32000 (92%)] Loss: 0.12549 (QuantReg: 12.28969) QuantErr: 12.28969 batch_time=0.35283 
Train Epoch: 24 [926/1000 29632/32000 (93%)] Loss: 0.93876 (QuantReg: 12.53558) QuantErr: 12.53558 batch_time=0.37440 
Train Epoch: 24 [931/1000 29792/32000 (93%)] Loss: 0.68524 (QuantReg: 11.86076) QuantErr: 11.86076 batch_time=0.36467 
Train Epoch: 24 [936/1000 29952/32000 (94%)] Loss: 0.20284 (QuantReg: 12.50338) QuantErr: 12.50338 batch_time=0.38473 
Train Epoch: 24 [941/1000 30112/32000 (94%)] Loss: 0.27966 (QuantReg: 12.18042) QuantErr: 12.18042 batch_time=0.34606 
Train Epoch: 24 [946/1000 30272/32000 (95%)] Loss: 0.27619 (QuantReg: 12.80002) QuantErr: 12.80002 batch_time=0.34047 
Train Epoch: 24 [951/1000 30432/32000 (95%)] Loss: 0.68877 (QuantReg: 12.43537) QuantErr: 12.43537 batch_time=0.35248 
Train Epoch: 24 [956/1000 30592/32000 (96%)] Loss: 0.30775 (QuantReg: 12.23747) QuantErr: 12.23747 batch_time=0.35762 
Train Epoch: 24 [961/1000 30752/32000 (96%)] Loss: 0.32233 (QuantReg: 12.11695) QuantErr: 12.11695 batch_time=0.51476 
Train Epoch: 24 [966/1000 30912/32000 (97%)] Loss: 0.42639 (QuantReg: 13.08893) QuantErr: 13.08893 batch_time=0.34049 
Train Epoch: 24 [971/1000 31072/32000 (97%)] Loss: 0.16606 (QuantReg: 12.40341) QuantErr: 12.40341 batch_time=0.38394 
Train Epoch: 24 [976/1000 31232/32000 (98%)] Loss: 0.40946 (QuantReg: 13.05258) QuantErr: 13.05258 batch_time=0.37609 
Train Epoch: 24 [981/1000 31392/32000 (98%)] Loss: 0.27176 (QuantReg: 12.69879) QuantErr: 12.69879 batch_time=0.40293 
Train Epoch: 24 [986/1000 31552/32000 (99%)] Loss: 0.21587 (QuantReg: 12.83378) QuantErr: 12.83378 batch_time=0.64606 
Train Epoch: 24 [991/1000 31712/32000 (99%)] Loss: 0.25217 (QuantReg: 12.92970) QuantErr: 12.92970 batch_time=0.39365 
Train Epoch: 24 [996/1000 31872/32000 (100%)] Loss: 0.57881 (QuantReg: 12.14816) QuantErr: 12.14816 batch_time=0.42978 
Train Epoch: 24 codebook_update_time=1.82133
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch24.pth ...
Done in 4.096s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 0.39119010787457226
 quant_reg      : 12.46777942276001
 quant_err      : 12.46777942276001
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 24000
 MSRVTT_full_val/t2v_metrics/R1: 29.77867203219316
 MSRVTT_full_val/t2v_metrics/R5: 68.81287726358148
 MSRVTT_full_val/t2v_metrics/R10: 82.49496981891348
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.909456740442656
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.29266263054412
 MSRVTT_full_val/v2t_metrics/R1: 32.796780684104625
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.927565392354125
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.92978891106003
 MSRVTT_full_test/t2v_metrics/R1: 11.538461538461538
 MSRVTT_full_test/t2v_metrics/R5: 35.551839464882946
 MSRVTT_full_test/t2v_metrics/R10: 49.331103678929765
 MSRVTT_full_test/t2v_metrics/R50: 81.40468227424749
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.634949832775916
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.25065454949611
 MSRVTT_full_test/v2t_metrics/R1: 14.782608695652174
 MSRVTT_full_test/v2t_metrics/R5: 40.836120401337794
 MSRVTT_full_test/v2t_metrics/R10: 55.752508361204015
 MSRVTT_full_test/v2t_metrics/R50: 85.78595317725753
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.09983277591973
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.28642723854937
 mnt_best       : 27.599303841463385
 not_improved_count: 1
Train Epoch: 25 [1/1000 32/32000 (0%)] Loss: 1.27560 (QuantReg: 12.28719) QuantErr: 12.28719 batch_time=31.46175 
Train Epoch: 25 [6/1000 192/32000 (1%)] Loss: 0.71259 (QuantReg: 12.55565) QuantErr: 12.55565 batch_time=0.35795 
Train Epoch: 25 [11/1000 352/32000 (1%)] Loss: 0.41316 (QuantReg: 12.56314) QuantErr: 12.56314 batch_time=0.34729 
Train Epoch: 25 [16/1000 512/32000 (2%)] Loss: 0.37134 (QuantReg: 12.17328) QuantErr: 12.17328 batch_time=0.43248 
Train Epoch: 25 [21/1000 672/32000 (2%)] Loss: 0.21242 (QuantReg: 12.69292) QuantErr: 12.69292 batch_time=0.37434 
Train Epoch: 25 [26/1000 832/32000 (3%)] Loss: 0.17665 (QuantReg: 12.62413) QuantErr: 12.62413 batch_time=0.35145 
Train Epoch: 25 [31/1000 992/32000 (3%)] Loss: 0.42885 (QuantReg: 12.38163) QuantErr: 12.38163 batch_time=0.37494 
Train Epoch: 25 [36/1000 1152/32000 (4%)] Loss: 0.45975 (QuantReg: 12.88732) QuantErr: 12.88732 batch_time=0.36123 
Train Epoch: 25 [41/1000 1312/32000 (4%)] Loss: 0.78944 (QuantReg: 11.88811) QuantErr: 11.88811 batch_time=0.38262 
Train Epoch: 25 [46/1000 1472/32000 (5%)] Loss: 0.35726 (QuantReg: 11.91714) QuantErr: 11.91714 batch_time=0.38621 
Train Epoch: 25 [51/1000 1632/32000 (5%)] Loss: 0.22038 (QuantReg: 11.87118) QuantErr: 11.87118 batch_time=0.43184 
Train Epoch: 25 [56/1000 1792/32000 (6%)] Loss: 0.25305 (QuantReg: 12.14619) QuantErr: 12.14619 batch_time=0.37259 
Train Epoch: 25 [61/1000 1952/32000 (6%)] Loss: 0.41336 (QuantReg: 12.48436) QuantErr: 12.48436 batch_time=0.34924 
Train Epoch: 25 [66/1000 2112/32000 (7%)] Loss: 0.55750 (QuantReg: 12.30195) QuantErr: 12.30195 batch_time=0.52969 
Train Epoch: 25 [71/1000 2272/32000 (7%)] Loss: 0.29964 (QuantReg: 11.98067) QuantErr: 11.98067 batch_time=1.56817 
Train Epoch: 25 [76/1000 2432/32000 (8%)] Loss: 0.58092 (QuantReg: 12.25861) QuantErr: 12.25861 batch_time=0.35282 
Train Epoch: 25 [81/1000 2592/32000 (8%)] Loss: 0.59494 (QuantReg: 12.15822) QuantErr: 12.15822 batch_time=0.35656 
Train Epoch: 25 [86/1000 2752/32000 (9%)] Loss: 0.57929 (QuantReg: 12.26154) QuantErr: 12.26154 batch_time=0.36158 
Train Epoch: 25 [91/1000 2912/32000 (9%)] Loss: 0.41721 (QuantReg: 13.50093) QuantErr: 13.50093 batch_time=0.39430 
Train Epoch: 25 [96/1000 3072/32000 (10%)] Loss: 0.56171 (QuantReg: 12.33278) QuantErr: 12.33278 batch_time=0.35320 
Train Epoch: 25 [101/1000 3232/32000 (10%)] Loss: 0.34380 (QuantReg: 12.91811) QuantErr: 12.91811 batch_time=0.35802 
Train Epoch: 25 [106/1000 3392/32000 (11%)] Loss: 0.28582 (QuantReg: 12.26309) QuantErr: 12.26309 batch_time=0.53039 
Train Epoch: 25 [111/1000 3552/32000 (11%)] Loss: 0.25007 (QuantReg: 11.99027) QuantErr: 11.99027 batch_time=0.43586 
Train Epoch: 25 [116/1000 3712/32000 (12%)] Loss: 0.18357 (QuantReg: 12.87249) QuantErr: 12.87249 batch_time=0.36219 
Train Epoch: 25 [121/1000 3872/32000 (12%)] Loss: 0.34097 (QuantReg: 12.38012) QuantErr: 12.38012 batch_time=0.36752 
Train Epoch: 25 [126/1000 4032/32000 (13%)] Loss: 0.54693 (QuantReg: 11.75699) QuantErr: 11.75699 batch_time=0.41884 
Train Epoch: 25 [131/1000 4192/32000 (13%)] Loss: 0.66587 (QuantReg: 12.09198) QuantErr: 12.09198 batch_time=0.48316 
Train Epoch: 25 [136/1000 4352/32000 (14%)] Loss: 0.29093 (QuantReg: 12.04936) QuantErr: 12.04936 batch_time=0.37480 
Train Epoch: 25 [141/1000 4512/32000 (14%)] Loss: 0.88377 (QuantReg: 12.07043) QuantErr: 12.07043 batch_time=0.56584 
Train Epoch: 25 [146/1000 4672/32000 (15%)] Loss: 0.33395 (QuantReg: 12.20935) QuantErr: 12.20935 batch_time=0.40369 
Train Epoch: 25 [151/1000 4832/32000 (15%)] Loss: 0.21379 (QuantReg: 13.06552) QuantErr: 13.06552 batch_time=0.37522 
Train Epoch: 25 [156/1000 4992/32000 (16%)] Loss: 0.19405 (QuantReg: 12.04658) QuantErr: 12.04658 batch_time=0.38187 
Train Epoch: 25 [161/1000 5152/32000 (16%)] Loss: 0.25983 (QuantReg: 12.82398) QuantErr: 12.82398 batch_time=0.34364 
Train Epoch: 25 [166/1000 5312/32000 (17%)] Loss: 0.69892 (QuantReg: 12.82178) QuantErr: 12.82178 batch_time=0.34324 
Train Epoch: 25 [171/1000 5472/32000 (17%)] Loss: 0.37027 (QuantReg: 12.26005) QuantErr: 12.26005 batch_time=0.36726 
Train Epoch: 25 [176/1000 5632/32000 (18%)] Loss: 0.24325 (QuantReg: 11.58485) QuantErr: 11.58485 batch_time=0.37706 
Train Epoch: 25 [181/1000 5792/32000 (18%)] Loss: 0.46532 (QuantReg: 12.70167) QuantErr: 12.70167 batch_time=0.40904 
Train Epoch: 25 [186/1000 5952/32000 (19%)] Loss: 0.74953 (QuantReg: 12.39807) QuantErr: 12.39807 batch_time=0.45097 
Train Epoch: 25 [191/1000 6112/32000 (19%)] Loss: 0.49766 (QuantReg: 12.34964) QuantErr: 12.34964 batch_time=0.40999 
Train Epoch: 25 [196/1000 6272/32000 (20%)] Loss: 0.16600 (QuantReg: 12.82401) QuantErr: 12.82401 batch_time=0.45924 
Train Epoch: 25 [201/1000 6432/32000 (20%)] Loss: 0.11686 (QuantReg: 12.59134) QuantErr: 12.59134 batch_time=0.35645 
Train Epoch: 25 [206/1000 6592/32000 (21%)] Loss: 0.17988 (QuantReg: 12.81613) QuantErr: 12.81613 batch_time=0.36561 
Train Epoch: 25 [211/1000 6752/32000 (21%)] Loss: 0.37534 (QuantReg: 12.32336) QuantErr: 12.32336 batch_time=0.44968 
Train Epoch: 25 [216/1000 6912/32000 (22%)] Loss: 0.63952 (QuantReg: 12.90268) QuantErr: 12.90268 batch_time=0.60522 
Train Epoch: 25 [221/1000 7072/32000 (22%)] Loss: 0.25397 (QuantReg: 13.42034) QuantErr: 13.42034 batch_time=0.39971 
Train Epoch: 25 [226/1000 7232/32000 (23%)] Loss: 0.24544 (QuantReg: 12.67647) QuantErr: 12.67647 batch_time=0.35487 
Train Epoch: 25 [231/1000 7392/32000 (23%)] Loss: 0.51190 (QuantReg: 12.56766) QuantErr: 12.56766 batch_time=0.43329 
Train Epoch: 25 [236/1000 7552/32000 (24%)] Loss: 0.20660 (QuantReg: 12.31414) QuantErr: 12.31414 batch_time=0.35061 
Train Epoch: 25 [241/1000 7712/32000 (24%)] Loss: 0.20124 (QuantReg: 13.12663) QuantErr: 13.12663 batch_time=0.36000 
Train Epoch: 25 [246/1000 7872/32000 (25%)] Loss: 0.41794 (QuantReg: 12.18764) QuantErr: 12.18764 batch_time=0.35505 
Train Epoch: 25 [251/1000 8032/32000 (25%)] Loss: 0.30846 (QuantReg: 12.85651) QuantErr: 12.85651 batch_time=0.41327 
Train Epoch: 25 [256/1000 8192/32000 (26%)] Loss: 0.41690 (QuantReg: 12.18430) QuantErr: 12.18430 batch_time=0.37197 
Train Epoch: 25 [261/1000 8352/32000 (26%)] Loss: 0.57572 (QuantReg: 12.17439) QuantErr: 12.17439 batch_time=0.36170 
Train Epoch: 25 [266/1000 8512/32000 (27%)] Loss: 0.37971 (QuantReg: 12.10086) QuantErr: 12.10086 batch_time=0.36378 
Train Epoch: 25 [271/1000 8672/32000 (27%)] Loss: 0.23048 (QuantReg: 12.96873) QuantErr: 12.96873 batch_time=0.36401 
Train Epoch: 25 [276/1000 8832/32000 (28%)] Loss: 0.48785 (QuantReg: 12.63245) QuantErr: 12.63245 batch_time=0.43903 
Train Epoch: 25 [281/1000 8992/32000 (28%)] Loss: 0.50901 (QuantReg: 12.83926) QuantErr: 12.83926 batch_time=0.36313 
Train Epoch: 25 [286/1000 9152/32000 (29%)] Loss: 0.10025 (QuantReg: 12.80577) QuantErr: 12.80577 batch_time=0.35560 
Train Epoch: 25 [291/1000 9312/32000 (29%)] Loss: 0.37047 (QuantReg: 12.51587) QuantErr: 12.51587 batch_time=0.35666 
Train Epoch: 25 [296/1000 9472/32000 (30%)] Loss: 0.17162 (QuantReg: 12.65366) QuantErr: 12.65366 batch_time=0.42454 
Train Epoch: 25 [301/1000 9632/32000 (30%)] Loss: 0.45166 (QuantReg: 11.86237) QuantErr: 11.86237 batch_time=0.36162 
Train Epoch: 25 [306/1000 9792/32000 (31%)] Loss: 0.25713 (QuantReg: 12.55701) QuantErr: 12.55701 batch_time=0.35520 
Train Epoch: 25 [311/1000 9952/32000 (31%)] Loss: 0.29739 (QuantReg: 12.37529) QuantErr: 12.37529 batch_time=0.36980 
Train Epoch: 25 [316/1000 10112/32000 (32%)] Loss: 0.23743 (QuantReg: 12.75929) QuantErr: 12.75929 batch_time=0.36127 
Train Epoch: 25 [321/1000 10272/32000 (32%)] Loss: 0.27719 (QuantReg: 12.57595) QuantErr: 12.57595 batch_time=0.37097 
Train Epoch: 25 [326/1000 10432/32000 (33%)] Loss: 0.44632 (QuantReg: 12.86760) QuantErr: 12.86760 batch_time=0.39324 
Train Epoch: 25 [331/1000 10592/32000 (33%)] Loss: 0.72367 (QuantReg: 12.81382) QuantErr: 12.81382 batch_time=0.35535 
Train Epoch: 25 [336/1000 10752/32000 (34%)] Loss: 0.38678 (QuantReg: 12.73357) QuantErr: 12.73357 batch_time=0.35737 
Train Epoch: 25 [341/1000 10912/32000 (34%)] Loss: 0.29529 (QuantReg: 12.50452) QuantErr: 12.50452 batch_time=0.39789 
Train Epoch: 25 [346/1000 11072/32000 (35%)] Loss: 0.27534 (QuantReg: 12.01367) QuantErr: 12.01367 batch_time=0.37144 
Train Epoch: 25 [351/1000 11232/32000 (35%)] Loss: 0.55479 (QuantReg: 12.52127) QuantErr: 12.52127 batch_time=0.36453 
Train Epoch: 25 [356/1000 11392/32000 (36%)] Loss: 0.19997 (QuantReg: 12.59684) QuantErr: 12.59684 batch_time=0.39756 
Train Epoch: 25 [361/1000 11552/32000 (36%)] Loss: 0.23129 (QuantReg: 12.47947) QuantErr: 12.47947 batch_time=0.40221 
Train Epoch: 25 [366/1000 11712/32000 (37%)] Loss: 0.42719 (QuantReg: 12.59086) QuantErr: 12.59086 batch_time=0.37064 
Train Epoch: 25 [371/1000 11872/32000 (37%)] Loss: 0.31944 (QuantReg: 12.51213) QuantErr: 12.51213 batch_time=0.38125 
Train Epoch: 25 [376/1000 12032/32000 (38%)] Loss: 0.60635 (QuantReg: 12.70700) QuantErr: 12.70700 batch_time=0.50676 
Train Epoch: 25 [381/1000 12192/32000 (38%)] Loss: 0.26218 (QuantReg: 12.41974) QuantErr: 12.41974 batch_time=0.39367 
Train Epoch: 25 [386/1000 12352/32000 (39%)] Loss: 0.28014 (QuantReg: 12.59947) QuantErr: 12.59947 batch_time=0.53383 
Train Epoch: 25 [391/1000 12512/32000 (39%)] Loss: 0.40093 (QuantReg: 13.02389) QuantErr: 13.02389 batch_time=1.45609 
Train Epoch: 25 [396/1000 12672/32000 (40%)] Loss: 0.54984 (QuantReg: 13.14954) QuantErr: 13.14954 batch_time=0.36046 
Train Epoch: 25 [401/1000 12832/32000 (40%)] Loss: 0.28683 (QuantReg: 12.77658) QuantErr: 12.77658 batch_time=0.39327 
Train Epoch: 25 [406/1000 12992/32000 (41%)] Loss: 0.57691 (QuantReg: 12.47166) QuantErr: 12.47166 batch_time=0.38768 
Train Epoch: 25 [411/1000 13152/32000 (41%)] Loss: 0.53542 (QuantReg: 12.09817) QuantErr: 12.09817 batch_time=0.40733 
Train Epoch: 25 [416/1000 13312/32000 (42%)] Loss: 0.29865 (QuantReg: 12.11661) QuantErr: 12.11661 batch_time=0.41075 
Train Epoch: 25 [421/1000 13472/32000 (42%)] Loss: 0.27410 (QuantReg: 12.79665) QuantErr: 12.79665 batch_time=0.37856 
Train Epoch: 25 [426/1000 13632/32000 (43%)] Loss: 0.28193 (QuantReg: 12.38953) QuantErr: 12.38953 batch_time=0.52957 
Train Epoch: 25 [431/1000 13792/32000 (43%)] Loss: 0.26083 (QuantReg: 11.71511) QuantErr: 11.71511 batch_time=0.38460 
Train Epoch: 25 [436/1000 13952/32000 (44%)] Loss: 0.41571 (QuantReg: 12.96977) QuantErr: 12.96977 batch_time=0.36370 
Train Epoch: 25 [441/1000 14112/32000 (44%)] Loss: 1.03059 (QuantReg: 12.20019) QuantErr: 12.20019 batch_time=0.37369 
Train Epoch: 25 [446/1000 14272/32000 (45%)] Loss: 0.50732 (QuantReg: 11.96056) QuantErr: 11.96056 batch_time=0.39567 
Train Epoch: 25 [451/1000 14432/32000 (45%)] Loss: 0.20020 (QuantReg: 12.64480) QuantErr: 12.64480 batch_time=0.45610 
Train Epoch: 25 [456/1000 14592/32000 (46%)] Loss: 0.29567 (QuantReg: 12.25232) QuantErr: 12.25232 batch_time=0.35923 
Train Epoch: 25 [461/1000 14752/32000 (46%)] Loss: 0.20374 (QuantReg: 12.75289) QuantErr: 12.75289 batch_time=0.58841 
Train Epoch: 25 [466/1000 14912/32000 (47%)] Loss: 0.41904 (QuantReg: 12.28273) QuantErr: 12.28273 batch_time=0.48916 
Train Epoch: 25 [471/1000 15072/32000 (47%)] Loss: 0.40063 (QuantReg: 12.46990) QuantErr: 12.46990 batch_time=0.45008 
Train Epoch: 25 [476/1000 15232/32000 (48%)] Loss: 0.23516 (QuantReg: 12.58274) QuantErr: 12.58274 batch_time=0.43545 
Train Epoch: 25 [481/1000 15392/32000 (48%)] Loss: 0.39825 (QuantReg: 13.03198) QuantErr: 13.03198 batch_time=0.38775 
Train Epoch: 25 [486/1000 15552/32000 (49%)] Loss: 0.24264 (QuantReg: 12.37929) QuantErr: 12.37929 batch_time=0.35556 
Train Epoch: 25 [491/1000 15712/32000 (49%)] Loss: 0.27382 (QuantReg: 11.96418) QuantErr: 11.96418 batch_time=0.36530 
Train Epoch: 25 [496/1000 15872/32000 (50%)] Loss: 0.49730 (QuantReg: 12.36283) QuantErr: 12.36283 batch_time=0.34777 
Train Epoch: 25 [501/1000 16032/32000 (50%)] Loss: 0.43891 (QuantReg: 12.46610) QuantErr: 12.46610 batch_time=0.36851 
Train Epoch: 25 [506/1000 16192/32000 (51%)] Loss: 0.51712 (QuantReg: 12.51958) QuantErr: 12.51958 batch_time=0.35867 
Train Epoch: 25 [511/1000 16352/32000 (51%)] Loss: 0.32510 (QuantReg: 12.51221) QuantErr: 12.51221 batch_time=0.39339 
Train Epoch: 25 [516/1000 16512/32000 (52%)] Loss: 0.29244 (QuantReg: 12.48961) QuantErr: 12.48961 batch_time=0.38138 
Train Epoch: 25 [521/1000 16672/32000 (52%)] Loss: 0.35610 (QuantReg: 12.47841) QuantErr: 12.47841 batch_time=0.37068 
Train Epoch: 25 [526/1000 16832/32000 (53%)] Loss: 0.29725 (QuantReg: 12.41290) QuantErr: 12.41290 batch_time=0.37649 
Train Epoch: 25 [531/1000 16992/32000 (53%)] Loss: 0.34453 (QuantReg: 12.57289) QuantErr: 12.57289 batch_time=0.39075 
Train Epoch: 25 [536/1000 17152/32000 (54%)] Loss: 0.34455 (QuantReg: 12.02880) QuantErr: 12.02880 batch_time=0.47331 
Train Epoch: 25 [541/1000 17312/32000 (54%)] Loss: 0.26073 (QuantReg: 12.75440) QuantErr: 12.75440 batch_time=0.35847 
Train Epoch: 25 [546/1000 17472/32000 (55%)] Loss: 0.43249 (QuantReg: 12.11648) QuantErr: 12.11648 batch_time=0.37780 
Train Epoch: 25 [551/1000 17632/32000 (55%)] Loss: 0.23740 (QuantReg: 12.31959) QuantErr: 12.31959 batch_time=0.35235 
Train Epoch: 25 [556/1000 17792/32000 (56%)] Loss: 0.35714 (QuantReg: 12.35120) QuantErr: 12.35120 batch_time=0.35550 
Train Epoch: 25 [561/1000 17952/32000 (56%)] Loss: 0.41669 (QuantReg: 12.42202) QuantErr: 12.42202 batch_time=0.40093 
Train Epoch: 25 [566/1000 18112/32000 (57%)] Loss: 0.31946 (QuantReg: 12.32436) QuantErr: 12.32436 batch_time=0.35291 
Train Epoch: 25 [571/1000 18272/32000 (57%)] Loss: 0.26888 (QuantReg: 12.55506) QuantErr: 12.55506 batch_time=0.36318 
Train Epoch: 25 [576/1000 18432/32000 (58%)] Loss: 0.21250 (QuantReg: 13.30539) QuantErr: 13.30539 batch_time=0.35937 
Train Epoch: 25 [581/1000 18592/32000 (58%)] Loss: 0.54061 (QuantReg: 12.90575) QuantErr: 12.90575 batch_time=0.40144 
Train Epoch: 25 [586/1000 18752/32000 (59%)] Loss: 0.28334 (QuantReg: 11.88316) QuantErr: 11.88316 batch_time=0.35631 
Train Epoch: 25 [591/1000 18912/32000 (59%)] Loss: 0.33986 (QuantReg: 12.67786) QuantErr: 12.67786 batch_time=0.38846 
Train Epoch: 25 [596/1000 19072/32000 (60%)] Loss: 0.38201 (QuantReg: 12.68003) QuantErr: 12.68003 batch_time=0.34957 
Train Epoch: 25 [601/1000 19232/32000 (60%)] Loss: 0.61549 (QuantReg: 12.64305) QuantErr: 12.64305 batch_time=0.34635 
Train Epoch: 25 [606/1000 19392/32000 (61%)] Loss: 0.49395 (QuantReg: 13.14645) QuantErr: 13.14645 batch_time=0.38167 
Train Epoch: 25 [611/1000 19552/32000 (61%)] Loss: 0.31720 (QuantReg: 12.39527) QuantErr: 12.39527 batch_time=0.37178 
Train Epoch: 25 [616/1000 19712/32000 (62%)] Loss: 0.12884 (QuantReg: 12.27496) QuantErr: 12.27496 batch_time=0.39682 
Train Epoch: 25 [621/1000 19872/32000 (62%)] Loss: 0.12246 (QuantReg: 13.23424) QuantErr: 13.23424 batch_time=0.41673 
Train Epoch: 25 [626/1000 20032/32000 (63%)] Loss: 0.41028 (QuantReg: 12.35195) QuantErr: 12.35195 batch_time=0.39088 
Train Epoch: 25 [631/1000 20192/32000 (63%)] Loss: 0.24701 (QuantReg: 12.53691) QuantErr: 12.53691 batch_time=0.44627 
Train Epoch: 25 [636/1000 20352/32000 (64%)] Loss: 0.40485 (QuantReg: 12.41655) QuantErr: 12.41655 batch_time=0.35253 
Train Epoch: 25 [641/1000 20512/32000 (64%)] Loss: 0.46729 (QuantReg: 12.90612) QuantErr: 12.90612 batch_time=0.41773 
Train Epoch: 25 [646/1000 20672/32000 (65%)] Loss: 0.56967 (QuantReg: 12.35487) QuantErr: 12.35487 batch_time=0.38066 
Train Epoch: 25 [651/1000 20832/32000 (65%)] Loss: 0.46497 (QuantReg: 12.28933) QuantErr: 12.28933 batch_time=0.35919 
Train Epoch: 25 [656/1000 20992/32000 (66%)] Loss: 0.35824 (QuantReg: 12.30779) QuantErr: 12.30779 batch_time=0.35675 
Train Epoch: 25 [661/1000 21152/32000 (66%)] Loss: 0.32054 (QuantReg: 12.40901) QuantErr: 12.40901 batch_time=0.38186 
Train Epoch: 25 [666/1000 21312/32000 (67%)] Loss: 0.41153 (QuantReg: 12.61917) QuantErr: 12.61917 batch_time=0.34893 
Train Epoch: 25 [671/1000 21472/32000 (67%)] Loss: 0.45860 (QuantReg: 12.76712) QuantErr: 12.76712 batch_time=0.38468 
Train Epoch: 25 [676/1000 21632/32000 (68%)] Loss: 0.87078 (QuantReg: 12.23556) QuantErr: 12.23556 batch_time=0.37204 
Train Epoch: 25 [681/1000 21792/32000 (68%)] Loss: 0.08932 (QuantReg: 12.72531) QuantErr: 12.72531 batch_time=0.35446 
Train Epoch: 25 [686/1000 21952/32000 (69%)] Loss: 0.13491 (QuantReg: 12.72295) QuantErr: 12.72295 batch_time=0.42659 
Train Epoch: 25 [691/1000 22112/32000 (69%)] Loss: 0.91929 (QuantReg: 12.22473) QuantErr: 12.22473 batch_time=0.36129 
Train Epoch: 25 [696/1000 22272/32000 (70%)] Loss: 0.35204 (QuantReg: 12.73980) QuantErr: 12.73980 batch_time=0.35483 
Train Epoch: 25 [701/1000 22432/32000 (70%)] Loss: 0.45440 (QuantReg: 12.45602) QuantErr: 12.45602 batch_time=0.38293 
Train Epoch: 25 [706/1000 22592/32000 (71%)] Loss: 0.86071 (QuantReg: 11.98336) QuantErr: 11.98336 batch_time=0.56552 
Train Epoch: 25 [711/1000 22752/32000 (71%)] Loss: 0.22343 (QuantReg: 12.56727) QuantErr: 12.56727 batch_time=1.45647 
Train Epoch: 25 [716/1000 22912/32000 (72%)] Loss: 0.57582 (QuantReg: 11.89729) QuantErr: 11.89729 batch_time=0.35607 
Train Epoch: 25 [721/1000 23072/32000 (72%)] Loss: 0.38807 (QuantReg: 12.76188) QuantErr: 12.76188 batch_time=0.35455 
Train Epoch: 25 [726/1000 23232/32000 (73%)] Loss: 0.89896 (QuantReg: 12.28421) QuantErr: 12.28421 batch_time=0.35356 
Train Epoch: 25 [731/1000 23392/32000 (73%)] Loss: 0.67510 (QuantReg: 12.27948) QuantErr: 12.27948 batch_time=0.41363 
Train Epoch: 25 [736/1000 23552/32000 (74%)] Loss: 0.28721 (QuantReg: 12.69931) QuantErr: 12.69931 batch_time=0.36515 
Train Epoch: 25 [741/1000 23712/32000 (74%)] Loss: 0.13568 (QuantReg: 12.12237) QuantErr: 12.12237 batch_time=0.35091 
Train Epoch: 25 [746/1000 23872/32000 (75%)] Loss: 0.63793 (QuantReg: 13.00088) QuantErr: 13.00088 batch_time=0.50460 
Train Epoch: 25 [751/1000 24032/32000 (75%)] Loss: 0.43071 (QuantReg: 12.85013) QuantErr: 12.85013 batch_time=0.36991 
Train Epoch: 25 [756/1000 24192/32000 (76%)] Loss: 0.13160 (QuantReg: 12.83683) QuantErr: 12.83683 batch_time=0.36175 
Train Epoch: 25 [761/1000 24352/32000 (76%)] Loss: 0.65840 (QuantReg: 12.48908) QuantErr: 12.48908 batch_time=0.45007 
Train Epoch: 25 [766/1000 24512/32000 (77%)] Loss: 0.14073 (QuantReg: 11.96505) QuantErr: 11.96505 batch_time=0.43217 
Train Epoch: 25 [771/1000 24672/32000 (77%)] Loss: 0.40680 (QuantReg: 12.60735) QuantErr: 12.60735 batch_time=0.44097 
Train Epoch: 25 [776/1000 24832/32000 (78%)] Loss: 0.42906 (QuantReg: 12.71017) QuantErr: 12.71017 batch_time=0.34976 
Train Epoch: 25 [781/1000 24992/32000 (78%)] Loss: 0.38709 (QuantReg: 12.87083) QuantErr: 12.87083 batch_time=0.55026 
Train Epoch: 25 [786/1000 25152/32000 (79%)] Loss: 0.33614 (QuantReg: 12.10745) QuantErr: 12.10745 batch_time=0.35033 
Train Epoch: 25 [791/1000 25312/32000 (79%)] Loss: 0.16470 (QuantReg: 12.14752) QuantErr: 12.14752 batch_time=0.34894 
Train Epoch: 25 [796/1000 25472/32000 (80%)] Loss: 0.29955 (QuantReg: 11.60438) QuantErr: 11.60438 batch_time=0.36599 
Train Epoch: 25 [801/1000 25632/32000 (80%)] Loss: 0.40763 (QuantReg: 12.44141) QuantErr: 12.44141 batch_time=0.35647 
Train Epoch: 25 [806/1000 25792/32000 (81%)] Loss: 0.25074 (QuantReg: 12.57946) QuantErr: 12.57946 batch_time=0.36947 
Train Epoch: 25 [811/1000 25952/32000 (81%)] Loss: 0.34332 (QuantReg: 12.44742) QuantErr: 12.44742 batch_time=0.35452 
Train Epoch: 25 [816/1000 26112/32000 (82%)] Loss: 0.35570 (QuantReg: 12.07356) QuantErr: 12.07356 batch_time=0.36233 
Train Epoch: 25 [821/1000 26272/32000 (82%)] Loss: 0.90330 (QuantReg: 12.01099) QuantErr: 12.01099 batch_time=0.35535 
Train Epoch: 25 [826/1000 26432/32000 (83%)] Loss: 0.16822 (QuantReg: 13.65673) QuantErr: 13.65673 batch_time=0.35454 
Train Epoch: 25 [831/1000 26592/32000 (83%)] Loss: 0.60320 (QuantReg: 11.84548) QuantErr: 11.84548 batch_time=0.38156 
Train Epoch: 25 [836/1000 26752/32000 (84%)] Loss: 0.36432 (QuantReg: 13.09527) QuantErr: 13.09527 batch_time=0.38374 
Train Epoch: 25 [841/1000 26912/32000 (84%)] Loss: 0.31267 (QuantReg: 12.55916) QuantErr: 12.55916 batch_time=0.35409 
Train Epoch: 25 [846/1000 27072/32000 (85%)] Loss: 0.21316 (QuantReg: 12.51905) QuantErr: 12.51905 batch_time=0.37230 
Train Epoch: 25 [851/1000 27232/32000 (85%)] Loss: 0.45246 (QuantReg: 12.72982) QuantErr: 12.72982 batch_time=0.36352 
Train Epoch: 25 [856/1000 27392/32000 (86%)] Loss: 0.16489 (QuantReg: 12.42879) QuantErr: 12.42879 batch_time=0.47165 
Train Epoch: 25 [861/1000 27552/32000 (86%)] Loss: 0.37826 (QuantReg: 12.07686) QuantErr: 12.07686 batch_time=0.40011 
Train Epoch: 25 [866/1000 27712/32000 (87%)] Loss: 0.36889 (QuantReg: 12.62230) QuantErr: 12.62230 batch_time=0.39605 
Train Epoch: 25 [871/1000 27872/32000 (87%)] Loss: 0.37229 (QuantReg: 12.73565) QuantErr: 12.73565 batch_time=0.37399 
Train Epoch: 25 [876/1000 28032/32000 (88%)] Loss: 0.21205 (QuantReg: 12.80626) QuantErr: 12.80626 batch_time=0.39322 
Train Epoch: 25 [881/1000 28192/32000 (88%)] Loss: 0.04921 (QuantReg: 13.07170) QuantErr: 13.07170 batch_time=0.35819 
Train Epoch: 25 [886/1000 28352/32000 (89%)] Loss: 0.28750 (QuantReg: 12.92908) QuantErr: 12.92908 batch_time=0.36741 
Train Epoch: 25 [891/1000 28512/32000 (89%)] Loss: 0.41366 (QuantReg: 12.50705) QuantErr: 12.50705 batch_time=0.46615 
Train Epoch: 25 [896/1000 28672/32000 (90%)] Loss: 0.26230 (QuantReg: 13.04612) QuantErr: 13.04612 batch_time=0.45470 
Train Epoch: 25 [901/1000 28832/32000 (90%)] Loss: 0.17139 (QuantReg: 12.99786) QuantErr: 12.99786 batch_time=0.38906 
Train Epoch: 25 [906/1000 28992/32000 (91%)] Loss: 0.18030 (QuantReg: 13.21291) QuantErr: 13.21291 batch_time=0.44238 
Train Epoch: 25 [911/1000 29152/32000 (91%)] Loss: 0.28488 (QuantReg: 12.71783) QuantErr: 12.71783 batch_time=0.43692 
Train Epoch: 25 [916/1000 29312/32000 (92%)] Loss: 0.33975 (QuantReg: 12.83821) QuantErr: 12.83821 batch_time=0.35368 
Train Epoch: 25 [921/1000 29472/32000 (92%)] Loss: 0.30191 (QuantReg: 12.23308) QuantErr: 12.23308 batch_time=0.35482 
Train Epoch: 25 [926/1000 29632/32000 (93%)] Loss: 0.30855 (QuantReg: 12.10837) QuantErr: 12.10837 batch_time=0.35093 
Train Epoch: 25 [931/1000 29792/32000 (93%)] Loss: 0.14859 (QuantReg: 12.93181) QuantErr: 12.93181 batch_time=0.34974 
Train Epoch: 25 [936/1000 29952/32000 (94%)] Loss: 0.49987 (QuantReg: 12.51579) QuantErr: 12.51579 batch_time=0.36233 
Train Epoch: 25 [941/1000 30112/32000 (94%)] Loss: 0.79069 (QuantReg: 12.33970) QuantErr: 12.33970 batch_time=0.34874 
Train Epoch: 25 [946/1000 30272/32000 (95%)] Loss: 0.58015 (QuantReg: 12.33610) QuantErr: 12.33610 batch_time=0.35550 
Train Epoch: 25 [951/1000 30432/32000 (95%)] Loss: 0.21055 (QuantReg: 12.54953) QuantErr: 12.54953 batch_time=0.35167 
Train Epoch: 25 [956/1000 30592/32000 (96%)] Loss: 0.46649 (QuantReg: 12.77739) QuantErr: 12.77739 batch_time=0.36863 
Train Epoch: 25 [961/1000 30752/32000 (96%)] Loss: 0.13464 (QuantReg: 12.92008) QuantErr: 12.92008 batch_time=0.35445 
Train Epoch: 25 [966/1000 30912/32000 (97%)] Loss: 0.20485 (QuantReg: 13.10762) QuantErr: 13.10762 batch_time=0.44250 
Train Epoch: 25 [971/1000 31072/32000 (97%)] Loss: 0.76286 (QuantReg: 12.15616) QuantErr: 12.15616 batch_time=0.38340 
Train Epoch: 25 [976/1000 31232/32000 (98%)] Loss: 0.41811 (QuantReg: 12.67425) QuantErr: 12.67425 batch_time=0.38219 
Train Epoch: 25 [981/1000 31392/32000 (98%)] Loss: 0.70770 (QuantReg: 12.22190) QuantErr: 12.22190 batch_time=0.38755 
Train Epoch: 25 [986/1000 31552/32000 (99%)] Loss: 0.14397 (QuantReg: 12.61509) QuantErr: 12.61509 batch_time=0.35351 
Train Epoch: 25 [991/1000 31712/32000 (99%)] Loss: 0.11246 (QuantReg: 12.23491) QuantErr: 12.23491 batch_time=0.35827 
Train Epoch: 25 [996/1000 31872/32000 (100%)] Loss: 0.55117 (QuantReg: 12.68706) QuantErr: 12.68706 batch_time=0.36559 
Train Epoch: 25 codebook_update_time=1.85557
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch25.pth ...
Done in 4.268s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 0.3830011136382818
 quant_reg      : 12.50156293773651
 quant_err      : 12.50156293773651
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 25000
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 66.59959758551308
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.458752515090543
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.3669574426374
 MSRVTT_full_val/v2t_metrics/R1: 34.20523138832998
 MSRVTT_full_val/v2t_metrics/R5: 73.8430583501006
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.641851106639839
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.09309397294581
 MSRVTT_full_test/t2v_metrics/R1: 10.936454849498327
 MSRVTT_full_test/t2v_metrics/R5: 33.7123745819398
 MSRVTT_full_test/t2v_metrics/R10: 47.95986622073578
 MSRVTT_full_test/t2v_metrics/R50: 79.29765886287625
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.34749163879599
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.05241316581507
 MSRVTT_full_test/v2t_metrics/R1: 14.882943143812708
 MSRVTT_full_test/v2t_metrics/R5: 40.2675585284281
 MSRVTT_full_test/v2t_metrics/R10: 55.35117056856188
 MSRVTT_full_test/v2t_metrics/R50: 85.88628762541806
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.538127090301
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.13095572398722
 mnt_best       : 27.599303841463385
 not_improved_count: 2
Train Epoch: 26 [1/1000 32/32000 (0%)] Loss: 0.49161 (QuantReg: 12.13906) QuantErr: 12.13906 batch_time=26.81338 
Train Epoch: 26 [6/1000 192/32000 (1%)] Loss: 0.35774 (QuantReg: 13.06427) QuantErr: 13.06427 batch_time=0.34848 
Train Epoch: 26 [11/1000 352/32000 (1%)] Loss: 0.31799 (QuantReg: 12.38605) QuantErr: 12.38605 batch_time=0.38369 
Train Epoch: 26 [16/1000 512/32000 (2%)] Loss: 0.29573 (QuantReg: 12.35567) QuantErr: 12.35567 batch_time=0.51347 
Train Epoch: 26 [21/1000 672/32000 (2%)] Loss: 0.36004 (QuantReg: 12.31491) QuantErr: 12.31491 batch_time=0.34483 
Train Epoch: 26 [26/1000 832/32000 (3%)] Loss: 0.41193 (QuantReg: 12.28306) QuantErr: 12.28306 batch_time=0.36485 
Train Epoch: 26 [31/1000 992/32000 (3%)] Loss: 0.51306 (QuantReg: 12.38759) QuantErr: 12.38759 batch_time=0.34513 
Train Epoch: 26 [36/1000 1152/32000 (4%)] Loss: 0.52384 (QuantReg: 12.47013) QuantErr: 12.47013 batch_time=0.37469 
Train Epoch: 26 [41/1000 1312/32000 (4%)] Loss: 0.30089 (QuantReg: 12.31121) QuantErr: 12.31121 batch_time=0.56813 
Train Epoch: 26 [46/1000 1472/32000 (5%)] Loss: 0.33663 (QuantReg: 12.12262) QuantErr: 12.12262 batch_time=0.72315 
Train Epoch: 26 [51/1000 1632/32000 (5%)] Loss: 0.25277 (QuantReg: 12.06244) QuantErr: 12.06244 batch_time=0.35661 
Train Epoch: 26 [56/1000 1792/32000 (6%)] Loss: 0.42759 (QuantReg: 12.82858) QuantErr: 12.82858 batch_time=0.36968 
Train Epoch: 26 [61/1000 1952/32000 (6%)] Loss: 0.37968 (QuantReg: 12.53446) QuantErr: 12.53446 batch_time=2.71887 
Train Epoch: 26 [66/1000 2112/32000 (7%)] Loss: 0.18070 (QuantReg: 12.48231) QuantErr: 12.48231 batch_time=0.35765 
Train Epoch: 26 [71/1000 2272/32000 (7%)] Loss: 0.25203 (QuantReg: 12.78455) QuantErr: 12.78455 batch_time=0.40901 
Train Epoch: 26 [76/1000 2432/32000 (8%)] Loss: 0.10295 (QuantReg: 11.87434) QuantErr: 11.87434 batch_time=0.37123 
Train Epoch: 26 [81/1000 2592/32000 (8%)] Loss: 0.81090 (QuantReg: 13.00435) QuantErr: 13.00435 batch_time=0.43058 
Train Epoch: 26 [86/1000 2752/32000 (9%)] Loss: 0.32790 (QuantReg: 12.28395) QuantErr: 12.28395 batch_time=0.43924 
Train Epoch: 26 [91/1000 2912/32000 (9%)] Loss: 0.21655 (QuantReg: 12.58409) QuantErr: 12.58409 batch_time=0.42427 
Train Epoch: 26 [96/1000 3072/32000 (10%)] Loss: 0.22754 (QuantReg: 12.80721) QuantErr: 12.80721 batch_time=0.40445 
Train Epoch: 26 [101/1000 3232/32000 (10%)] Loss: 0.28699 (QuantReg: 12.25751) QuantErr: 12.25751 batch_time=0.41218 
Train Epoch: 26 [106/1000 3392/32000 (11%)] Loss: 0.17965 (QuantReg: 11.91769) QuantErr: 11.91769 batch_time=0.36399 
Train Epoch: 26 [111/1000 3552/32000 (11%)] Loss: 0.43371 (QuantReg: 12.92234) QuantErr: 12.92234 batch_time=0.38358 
Train Epoch: 26 [116/1000 3712/32000 (12%)] Loss: 0.29201 (QuantReg: 11.79605) QuantErr: 11.79605 batch_time=0.37413 
Train Epoch: 26 [121/1000 3872/32000 (12%)] Loss: 0.23479 (QuantReg: 12.18632) QuantErr: 12.18632 batch_time=0.39936 
Train Epoch: 26 [126/1000 4032/32000 (13%)] Loss: 0.38236 (QuantReg: 13.02360) QuantErr: 13.02360 batch_time=0.37211 
Train Epoch: 26 [131/1000 4192/32000 (13%)] Loss: 0.22155 (QuantReg: 12.24393) QuantErr: 12.24393 batch_time=0.34710 
Train Epoch: 26 [136/1000 4352/32000 (14%)] Loss: 0.63993 (QuantReg: 12.51157) QuantErr: 12.51157 batch_time=0.42272 
Train Epoch: 26 [141/1000 4512/32000 (14%)] Loss: 0.44142 (QuantReg: 12.89080) QuantErr: 12.89080 batch_time=0.37442 
Train Epoch: 26 [146/1000 4672/32000 (15%)] Loss: 0.34148 (QuantReg: 12.10144) QuantErr: 12.10144 batch_time=0.39273 
Train Epoch: 26 [151/1000 4832/32000 (15%)] Loss: 0.77320 (QuantReg: 12.59193) QuantErr: 12.59193 batch_time=0.34478 
Train Epoch: 26 [156/1000 4992/32000 (16%)] Loss: 0.27669 (QuantReg: 12.26029) QuantErr: 12.26029 batch_time=0.34629 
Train Epoch: 26 [161/1000 5152/32000 (16%)] Loss: 0.51493 (QuantReg: 11.99651) QuantErr: 11.99651 batch_time=0.34417 
Train Epoch: 26 [166/1000 5312/32000 (17%)] Loss: 0.16272 (QuantReg: 11.95433) QuantErr: 11.95433 batch_time=0.37417 
Train Epoch: 26 [171/1000 5472/32000 (17%)] Loss: 0.36428 (QuantReg: 13.55832) QuantErr: 13.55832 batch_time=0.40249 
Train Epoch: 26 [176/1000 5632/32000 (18%)] Loss: 0.42366 (QuantReg: 12.67226) QuantErr: 12.67226 batch_time=0.37888 
Train Epoch: 26 [181/1000 5792/32000 (18%)] Loss: 0.22999 (QuantReg: 13.01181) QuantErr: 13.01181 batch_time=0.36367 
Train Epoch: 26 [186/1000 5952/32000 (19%)] Loss: 0.25141 (QuantReg: 12.84758) QuantErr: 12.84758 batch_time=0.36908 
Train Epoch: 26 [191/1000 6112/32000 (19%)] Loss: 0.55961 (QuantReg: 12.10364) QuantErr: 12.10364 batch_time=0.40717 
Train Epoch: 26 [196/1000 6272/32000 (20%)] Loss: 0.31606 (QuantReg: 13.01841) QuantErr: 13.01841 batch_time=0.36462 
Train Epoch: 26 [201/1000 6432/32000 (20%)] Loss: 0.19844 (QuantReg: 12.03163) QuantErr: 12.03163 batch_time=0.36978 
Train Epoch: 26 [206/1000 6592/32000 (21%)] Loss: 0.17745 (QuantReg: 12.40855) QuantErr: 12.40855 batch_time=0.41168 
Train Epoch: 26 [211/1000 6752/32000 (21%)] Loss: 0.27037 (QuantReg: 12.03111) QuantErr: 12.03111 batch_time=0.36159 
Train Epoch: 26 [216/1000 6912/32000 (22%)] Loss: 0.60165 (QuantReg: 11.24925) QuantErr: 11.24925 batch_time=0.35488 
Train Epoch: 26 [221/1000 7072/32000 (22%)] Loss: 0.22342 (QuantReg: 12.40499) QuantErr: 12.40499 batch_time=0.35037 
Train Epoch: 26 [226/1000 7232/32000 (23%)] Loss: 0.13929 (QuantReg: 12.64365) QuantErr: 12.64365 batch_time=0.37762 
Train Epoch: 26 [231/1000 7392/32000 (23%)] Loss: 0.32248 (QuantReg: 11.95632) QuantErr: 11.95632 batch_time=0.38353 
Train Epoch: 26 [236/1000 7552/32000 (24%)] Loss: 0.75765 (QuantReg: 11.82590) QuantErr: 11.82590 batch_time=0.38134 
Train Epoch: 26 [241/1000 7712/32000 (24%)] Loss: 0.59170 (QuantReg: 12.60859) QuantErr: 12.60859 batch_time=0.36824 
Train Epoch: 26 [246/1000 7872/32000 (25%)] Loss: 0.63112 (QuantReg: 12.77131) QuantErr: 12.77131 batch_time=0.36421 
Train Epoch: 26 [251/1000 8032/32000 (25%)] Loss: 0.27613 (QuantReg: 13.02550) QuantErr: 13.02550 batch_time=0.35202 
Train Epoch: 26 [256/1000 8192/32000 (26%)] Loss: 0.08465 (QuantReg: 13.55789) QuantErr: 13.55789 batch_time=0.34961 
Train Epoch: 26 [261/1000 8352/32000 (26%)] Loss: 0.50868 (QuantReg: 12.42147) QuantErr: 12.42147 batch_time=0.40457 
Train Epoch: 26 [266/1000 8512/32000 (27%)] Loss: 0.34993 (QuantReg: 12.77198) QuantErr: 12.77198 batch_time=0.35297 
Train Epoch: 26 [271/1000 8672/32000 (27%)] Loss: 0.47660 (QuantReg: 12.58565) QuantErr: 12.58565 batch_time=0.34726 
Train Epoch: 26 [276/1000 8832/32000 (28%)] Loss: 0.60906 (QuantReg: 12.47414) QuantErr: 12.47414 batch_time=0.34602 
Train Epoch: 26 [281/1000 8992/32000 (28%)] Loss: 0.30576 (QuantReg: 12.81238) QuantErr: 12.81238 batch_time=0.34542 
Train Epoch: 26 [286/1000 9152/32000 (29%)] Loss: 0.23914 (QuantReg: 12.96789) QuantErr: 12.96789 batch_time=0.35819 
Train Epoch: 26 [291/1000 9312/32000 (29%)] Loss: 0.31468 (QuantReg: 12.74979) QuantErr: 12.74979 batch_time=0.36516 
Train Epoch: 26 [296/1000 9472/32000 (30%)] Loss: 0.28839 (QuantReg: 12.10819) QuantErr: 12.10819 batch_time=0.36342 
Train Epoch: 26 [301/1000 9632/32000 (30%)] Loss: 0.35462 (QuantReg: 12.37305) QuantErr: 12.37305 batch_time=0.36012 
Train Epoch: 26 [306/1000 9792/32000 (31%)] Loss: 0.35570 (QuantReg: 12.92823) QuantErr: 12.92823 batch_time=0.37633 
Train Epoch: 26 [311/1000 9952/32000 (31%)] Loss: 0.17429 (QuantReg: 12.79633) QuantErr: 12.79633 batch_time=0.36378 
Train Epoch: 26 [316/1000 10112/32000 (32%)] Loss: 0.19509 (QuantReg: 12.96451) QuantErr: 12.96451 batch_time=0.36391 
Train Epoch: 26 [321/1000 10272/32000 (32%)] Loss: 0.83793 (QuantReg: 12.65249) QuantErr: 12.65249 batch_time=0.35956 
Train Epoch: 26 [326/1000 10432/32000 (33%)] Loss: 0.34362 (QuantReg: 12.62830) QuantErr: 12.62830 batch_time=0.37307 
Train Epoch: 26 [331/1000 10592/32000 (33%)] Loss: 0.16121 (QuantReg: 12.17770) QuantErr: 12.17770 batch_time=0.34549 
Train Epoch: 26 [336/1000 10752/32000 (34%)] Loss: 0.36784 (QuantReg: 12.22631) QuantErr: 12.22631 batch_time=0.35220 
Train Epoch: 26 [341/1000 10912/32000 (34%)] Loss: 0.56172 (QuantReg: 12.48406) QuantErr: 12.48406 batch_time=0.35299 
Train Epoch: 26 [346/1000 11072/32000 (35%)] Loss: 0.46173 (QuantReg: 12.55785) QuantErr: 12.55785 batch_time=0.34840 
Train Epoch: 26 [351/1000 11232/32000 (35%)] Loss: 0.22224 (QuantReg: 12.78807) QuantErr: 12.78807 batch_time=0.34782 
Train Epoch: 26 [356/1000 11392/32000 (36%)] Loss: 0.50195 (QuantReg: 12.79099) QuantErr: 12.79099 batch_time=0.34072 
Train Epoch: 26 [361/1000 11552/32000 (36%)] Loss: 0.69091 (QuantReg: 12.78087) QuantErr: 12.78087 batch_time=0.35597 
Train Epoch: 26 [366/1000 11712/32000 (37%)] Loss: 0.41775 (QuantReg: 12.62688) QuantErr: 12.62688 batch_time=0.73088 
Train Epoch: 26 [371/1000 11872/32000 (37%)] Loss: 0.33998 (QuantReg: 12.16734) QuantErr: 12.16734 batch_time=0.36143 
Train Epoch: 26 [376/1000 12032/32000 (38%)] Loss: 0.51053 (QuantReg: 12.48305) QuantErr: 12.48305 batch_time=0.43902 
Train Epoch: 26 [381/1000 12192/32000 (38%)] Loss: 0.20116 (QuantReg: 12.25941) QuantErr: 12.25941 batch_time=2.11836 
Train Epoch: 26 [386/1000 12352/32000 (39%)] Loss: 0.49260 (QuantReg: 12.67593) QuantErr: 12.67593 batch_time=0.36554 
Train Epoch: 26 [391/1000 12512/32000 (39%)] Loss: 0.37270 (QuantReg: 12.21865) QuantErr: 12.21865 batch_time=0.43008 
Train Epoch: 26 [396/1000 12672/32000 (40%)] Loss: 0.26575 (QuantReg: 12.65034) QuantErr: 12.65034 batch_time=0.42920 
Train Epoch: 26 [401/1000 12832/32000 (40%)] Loss: 0.51098 (QuantReg: 11.71110) QuantErr: 11.71110 batch_time=0.37905 
Train Epoch: 26 [406/1000 12992/32000 (41%)] Loss: 0.34447 (QuantReg: 12.48461) QuantErr: 12.48461 batch_time=0.35225 
Train Epoch: 26 [411/1000 13152/32000 (41%)] Loss: 0.87377 (QuantReg: 11.83250) QuantErr: 11.83250 batch_time=0.36991 
Train Epoch: 26 [416/1000 13312/32000 (42%)] Loss: 0.62406 (QuantReg: 12.74997) QuantErr: 12.74997 batch_time=0.35119 
Train Epoch: 26 [421/1000 13472/32000 (42%)] Loss: 0.30861 (QuantReg: 12.42690) QuantErr: 12.42690 batch_time=0.36945 
Train Epoch: 26 [426/1000 13632/32000 (43%)] Loss: 0.08788 (QuantReg: 12.57505) QuantErr: 12.57505 batch_time=0.35006 
Train Epoch: 26 [431/1000 13792/32000 (43%)] Loss: 0.76434 (QuantReg: 12.78364) QuantErr: 12.78364 batch_time=0.37640 
Train Epoch: 26 [436/1000 13952/32000 (44%)] Loss: 0.34906 (QuantReg: 12.81333) QuantErr: 12.81333 batch_time=0.42060 
Train Epoch: 26 [441/1000 14112/32000 (44%)] Loss: 0.18231 (QuantReg: 12.17107) QuantErr: 12.17107 batch_time=0.37020 
Train Epoch: 26 [446/1000 14272/32000 (45%)] Loss: 0.72488 (QuantReg: 12.10731) QuantErr: 12.10731 batch_time=0.36113 
Train Epoch: 26 [451/1000 14432/32000 (45%)] Loss: 0.55181 (QuantReg: 12.73428) QuantErr: 12.73428 batch_time=0.36880 
Train Epoch: 26 [456/1000 14592/32000 (46%)] Loss: 0.29965 (QuantReg: 12.26502) QuantErr: 12.26502 batch_time=0.36228 
Train Epoch: 26 [461/1000 14752/32000 (46%)] Loss: 0.37811 (QuantReg: 11.98212) QuantErr: 11.98212 batch_time=0.36109 
Train Epoch: 26 [466/1000 14912/32000 (47%)] Loss: 0.61593 (QuantReg: 12.40884) QuantErr: 12.40884 batch_time=0.36627 
Train Epoch: 26 [471/1000 15072/32000 (47%)] Loss: 0.36748 (QuantReg: 12.48040) QuantErr: 12.48040 batch_time=0.38538 
Train Epoch: 26 [476/1000 15232/32000 (48%)] Loss: 0.15031 (QuantReg: 12.99630) QuantErr: 12.99630 batch_time=0.40440 
Train Epoch: 26 [481/1000 15392/32000 (48%)] Loss: 0.49634 (QuantReg: 12.63524) QuantErr: 12.63524 batch_time=0.41977 
Train Epoch: 26 [486/1000 15552/32000 (49%)] Loss: 0.37689 (QuantReg: 12.42637) QuantErr: 12.42637 batch_time=0.38031 
Train Epoch: 26 [491/1000 15712/32000 (49%)] Loss: 0.48006 (QuantReg: 12.29925) QuantErr: 12.29925 batch_time=0.35920 
Train Epoch: 26 [496/1000 15872/32000 (50%)] Loss: 0.28945 (QuantReg: 13.00204) QuantErr: 13.00204 batch_time=0.37277 
Train Epoch: 26 [501/1000 16032/32000 (50%)] Loss: 0.59648 (QuantReg: 12.14244) QuantErr: 12.14244 batch_time=0.35927 
Train Epoch: 26 [506/1000 16192/32000 (51%)] Loss: 0.08439 (QuantReg: 13.07244) QuantErr: 13.07244 batch_time=0.38727 
Train Epoch: 26 [511/1000 16352/32000 (51%)] Loss: 0.49880 (QuantReg: 12.64297) QuantErr: 12.64297 batch_time=0.37753 
Train Epoch: 26 [516/1000 16512/32000 (52%)] Loss: 0.34545 (QuantReg: 11.64324) QuantErr: 11.64324 batch_time=0.43543 
Train Epoch: 26 [521/1000 16672/32000 (52%)] Loss: 0.34984 (QuantReg: 12.99732) QuantErr: 12.99732 batch_time=0.40576 
Train Epoch: 26 [526/1000 16832/32000 (53%)] Loss: 0.15775 (QuantReg: 13.19032) QuantErr: 13.19032 batch_time=0.36219 
Train Epoch: 26 [531/1000 16992/32000 (53%)] Loss: 0.32696 (QuantReg: 12.27319) QuantErr: 12.27319 batch_time=0.39530 
Train Epoch: 26 [536/1000 17152/32000 (54%)] Loss: 0.16469 (QuantReg: 13.05981) QuantErr: 13.05981 batch_time=0.41049 
Train Epoch: 26 [541/1000 17312/32000 (54%)] Loss: 0.23489 (QuantReg: 13.01834) QuantErr: 13.01834 batch_time=0.39663 
Train Epoch: 26 [546/1000 17472/32000 (55%)] Loss: 0.43319 (QuantReg: 11.98436) QuantErr: 11.98436 batch_time=0.37273 
Train Epoch: 26 [551/1000 17632/32000 (55%)] Loss: 0.38635 (QuantReg: 12.43026) QuantErr: 12.43026 batch_time=0.36610 
Train Epoch: 26 [556/1000 17792/32000 (56%)] Loss: 0.52299 (QuantReg: 12.47120) QuantErr: 12.47120 batch_time=0.38650 
Train Epoch: 26 [561/1000 17952/32000 (56%)] Loss: 0.55621 (QuantReg: 13.01867) QuantErr: 13.01867 batch_time=0.36205 
Train Epoch: 26 [566/1000 18112/32000 (57%)] Loss: 0.81574 (QuantReg: 13.20751) QuantErr: 13.20751 batch_time=0.36750 
Train Epoch: 26 [571/1000 18272/32000 (57%)] Loss: 0.60736 (QuantReg: 12.04671) QuantErr: 12.04671 batch_time=0.42297 
Train Epoch: 26 [576/1000 18432/32000 (58%)] Loss: 0.25126 (QuantReg: 13.11659) QuantErr: 13.11659 batch_time=0.36423 
Train Epoch: 26 [581/1000 18592/32000 (58%)] Loss: 0.25750 (QuantReg: 13.22275) QuantErr: 13.22275 batch_time=0.39380 
Train Epoch: 26 [586/1000 18752/32000 (59%)] Loss: 0.70954 (QuantReg: 13.60187) QuantErr: 13.60187 batch_time=0.35143 
Train Epoch: 26 [591/1000 18912/32000 (59%)] Loss: 0.46768 (QuantReg: 12.20824) QuantErr: 12.20824 batch_time=0.36985 
Train Epoch: 26 [596/1000 19072/32000 (60%)] Loss: 0.47069 (QuantReg: 13.25430) QuantErr: 13.25430 batch_time=0.35631 
Train Epoch: 26 [601/1000 19232/32000 (60%)] Loss: 0.25532 (QuantReg: 12.69388) QuantErr: 12.69388 batch_time=0.36848 
Train Epoch: 26 [606/1000 19392/32000 (61%)] Loss: 0.66642 (QuantReg: 12.11536) QuantErr: 12.11536 batch_time=0.35650 
Train Epoch: 26 [611/1000 19552/32000 (61%)] Loss: 0.49251 (QuantReg: 12.77248) QuantErr: 12.77248 batch_time=0.35321 
Train Epoch: 26 [616/1000 19712/32000 (62%)] Loss: 0.28550 (QuantReg: 12.51358) QuantErr: 12.51358 batch_time=0.36232 
Train Epoch: 26 [621/1000 19872/32000 (62%)] Loss: 0.31987 (QuantReg: 13.30635) QuantErr: 13.30635 batch_time=0.37331 
Train Epoch: 26 [626/1000 20032/32000 (63%)] Loss: 0.47854 (QuantReg: 12.81737) QuantErr: 12.81737 batch_time=0.37216 
Train Epoch: 26 [631/1000 20192/32000 (63%)] Loss: 0.43234 (QuantReg: 12.17111) QuantErr: 12.17111 batch_time=0.38090 
Train Epoch: 26 [636/1000 20352/32000 (64%)] Loss: 0.50616 (QuantReg: 12.84762) QuantErr: 12.84762 batch_time=0.36833 
Train Epoch: 26 [641/1000 20512/32000 (64%)] Loss: 0.45135 (QuantReg: 12.03786) QuantErr: 12.03786 batch_time=0.35405 
Train Epoch: 26 [646/1000 20672/32000 (65%)] Loss: 0.34694 (QuantReg: 12.41247) QuantErr: 12.41247 batch_time=0.34850 
Train Epoch: 26 [651/1000 20832/32000 (65%)] Loss: 0.31318 (QuantReg: 12.53420) QuantErr: 12.53420 batch_time=0.35991 
Train Epoch: 26 [656/1000 20992/32000 (66%)] Loss: 0.27164 (QuantReg: 12.57059) QuantErr: 12.57059 batch_time=0.34741 
Train Epoch: 26 [661/1000 21152/32000 (66%)] Loss: 0.33022 (QuantReg: 12.31124) QuantErr: 12.31124 batch_time=0.35636 
Train Epoch: 26 [666/1000 21312/32000 (67%)] Loss: 0.16776 (QuantReg: 12.93512) QuantErr: 12.93512 batch_time=0.35197 
Train Epoch: 26 [671/1000 21472/32000 (67%)] Loss: 0.43971 (QuantReg: 12.61630) QuantErr: 12.61630 batch_time=0.37289 
Train Epoch: 26 [676/1000 21632/32000 (68%)] Loss: 1.10374 (QuantReg: 12.37994) QuantErr: 12.37994 batch_time=0.37520 
Train Epoch: 26 [681/1000 21792/32000 (68%)] Loss: 0.56381 (QuantReg: 12.74103) QuantErr: 12.74103 batch_time=0.37715 
Train Epoch: 26 [686/1000 21952/32000 (69%)] Loss: 0.36318 (QuantReg: 12.48448) QuantErr: 12.48448 batch_time=0.71927 
Train Epoch: 26 [691/1000 22112/32000 (69%)] Loss: 0.33997 (QuantReg: 12.22161) QuantErr: 12.22161 batch_time=0.35544 
Train Epoch: 26 [696/1000 22272/32000 (70%)] Loss: 0.34072 (QuantReg: 12.29753) QuantErr: 12.29753 batch_time=0.42250 
Train Epoch: 26 [701/1000 22432/32000 (70%)] Loss: 0.45811 (QuantReg: 11.77324) QuantErr: 11.77324 batch_time=2.01683 
Train Epoch: 26 [706/1000 22592/32000 (71%)] Loss: 0.22055 (QuantReg: 12.79931) QuantErr: 12.79931 batch_time=0.35301 
Train Epoch: 26 [711/1000 22752/32000 (71%)] Loss: 0.49267 (QuantReg: 12.49507) QuantErr: 12.49507 batch_time=0.35348 
Train Epoch: 26 [716/1000 22912/32000 (72%)] Loss: 0.18903 (QuantReg: 12.80364) QuantErr: 12.80364 batch_time=0.35766 
Train Epoch: 26 [721/1000 23072/32000 (72%)] Loss: 0.31962 (QuantReg: 12.08464) QuantErr: 12.08464 batch_time=0.35603 
Train Epoch: 26 [726/1000 23232/32000 (73%)] Loss: 0.39532 (QuantReg: 13.02710) QuantErr: 13.02710 batch_time=0.35514 
Train Epoch: 26 [731/1000 23392/32000 (73%)] Loss: 0.37272 (QuantReg: 12.26238) QuantErr: 12.26238 batch_time=0.35354 
Train Epoch: 26 [736/1000 23552/32000 (74%)] Loss: 0.33227 (QuantReg: 12.58000) QuantErr: 12.58000 batch_time=0.37403 
Train Epoch: 26 [741/1000 23712/32000 (74%)] Loss: 0.21704 (QuantReg: 12.24207) QuantErr: 12.24207 batch_time=0.35617 
Train Epoch: 26 [746/1000 23872/32000 (75%)] Loss: 0.38119 (QuantReg: 12.58704) QuantErr: 12.58704 batch_time=0.35259 
Train Epoch: 26 [751/1000 24032/32000 (75%)] Loss: 0.54595 (QuantReg: 12.25803) QuantErr: 12.25803 batch_time=0.35292 
Train Epoch: 26 [756/1000 24192/32000 (76%)] Loss: 0.50780 (QuantReg: 11.96565) QuantErr: 11.96565 batch_time=0.41148 
Train Epoch: 26 [761/1000 24352/32000 (76%)] Loss: 0.54537 (QuantReg: 12.20548) QuantErr: 12.20548 batch_time=0.36718 
Train Epoch: 26 [766/1000 24512/32000 (77%)] Loss: 0.13245 (QuantReg: 12.63444) QuantErr: 12.63444 batch_time=0.35140 
Train Epoch: 26 [771/1000 24672/32000 (77%)] Loss: 0.45841 (QuantReg: 12.88659) QuantErr: 12.88659 batch_time=0.35311 
Train Epoch: 26 [776/1000 24832/32000 (78%)] Loss: 0.33042 (QuantReg: 11.83146) QuantErr: 11.83146 batch_time=0.35773 
Train Epoch: 26 [781/1000 24992/32000 (78%)] Loss: 0.32044 (QuantReg: 12.48927) QuantErr: 12.48927 batch_time=0.35788 
Train Epoch: 26 [786/1000 25152/32000 (79%)] Loss: 0.44123 (QuantReg: 12.39970) QuantErr: 12.39970 batch_time=0.36416 
Train Epoch: 26 [791/1000 25312/32000 (79%)] Loss: 0.13600 (QuantReg: 12.79342) QuantErr: 12.79342 batch_time=0.35898 
Train Epoch: 26 [796/1000 25472/32000 (80%)] Loss: 0.27594 (QuantReg: 12.94497) QuantErr: 12.94497 batch_time=0.34778 
Train Epoch: 26 [801/1000 25632/32000 (80%)] Loss: 0.11869 (QuantReg: 12.65732) QuantErr: 12.65732 batch_time=0.36304 
Train Epoch: 26 [806/1000 25792/32000 (81%)] Loss: 0.35465 (QuantReg: 12.53678) QuantErr: 12.53678 batch_time=0.34311 
Train Epoch: 26 [811/1000 25952/32000 (81%)] Loss: 0.21949 (QuantReg: 12.64728) QuantErr: 12.64728 batch_time=0.34538 
Train Epoch: 26 [816/1000 26112/32000 (82%)] Loss: 0.27044 (QuantReg: 12.29050) QuantErr: 12.29050 batch_time=0.35585 
Train Epoch: 26 [821/1000 26272/32000 (82%)] Loss: 0.44396 (QuantReg: 12.87290) QuantErr: 12.87290 batch_time=0.36803 
Train Epoch: 26 [826/1000 26432/32000 (83%)] Loss: 0.22843 (QuantReg: 12.99792) QuantErr: 12.99792 batch_time=0.35894 
Train Epoch: 26 [831/1000 26592/32000 (83%)] Loss: 0.48687 (QuantReg: 12.49417) QuantErr: 12.49417 batch_time=0.35503 
Train Epoch: 26 [836/1000 26752/32000 (84%)] Loss: 0.18154 (QuantReg: 12.46900) QuantErr: 12.46900 batch_time=0.38640 
Train Epoch: 26 [841/1000 26912/32000 (84%)] Loss: 0.26900 (QuantReg: 12.40601) QuantErr: 12.40601 batch_time=0.36342 
Train Epoch: 26 [846/1000 27072/32000 (85%)] Loss: 0.14581 (QuantReg: 12.98113) QuantErr: 12.98113 batch_time=0.40844 
Train Epoch: 26 [851/1000 27232/32000 (85%)] Loss: 0.68526 (QuantReg: 12.37035) QuantErr: 12.37035 batch_time=0.34933 
Train Epoch: 26 [856/1000 27392/32000 (86%)] Loss: 0.74133 (QuantReg: 13.30899) QuantErr: 13.30899 batch_time=0.35336 
Train Epoch: 26 [861/1000 27552/32000 (86%)] Loss: 0.33424 (QuantReg: 12.53013) QuantErr: 12.53013 batch_time=0.35721 
Train Epoch: 26 [866/1000 27712/32000 (87%)] Loss: 0.25797 (QuantReg: 12.99072) QuantErr: 12.99072 batch_time=0.35080 
Train Epoch: 26 [871/1000 27872/32000 (87%)] Loss: 0.22292 (QuantReg: 12.98803) QuantErr: 12.98803 batch_time=0.35550 
Train Epoch: 26 [876/1000 28032/32000 (88%)] Loss: 0.72798 (QuantReg: 13.21015) QuantErr: 13.21015 batch_time=0.38321 
Train Epoch: 26 [881/1000 28192/32000 (88%)] Loss: 0.41875 (QuantReg: 12.58659) QuantErr: 12.58659 batch_time=0.35290 
Train Epoch: 26 [886/1000 28352/32000 (89%)] Loss: 0.28829 (QuantReg: 12.71951) QuantErr: 12.71951 batch_time=0.35057 
Train Epoch: 26 [891/1000 28512/32000 (89%)] Loss: 0.20419 (QuantReg: 12.72535) QuantErr: 12.72535 batch_time=0.35295 
Train Epoch: 26 [896/1000 28672/32000 (90%)] Loss: 0.33814 (QuantReg: 12.81226) QuantErr: 12.81226 batch_time=0.34909 
Train Epoch: 26 [901/1000 28832/32000 (90%)] Loss: 0.26749 (QuantReg: 12.67311) QuantErr: 12.67311 batch_time=0.37625 
Train Epoch: 26 [906/1000 28992/32000 (91%)] Loss: 0.32665 (QuantReg: 12.38614) QuantErr: 12.38614 batch_time=0.34959 
Train Epoch: 26 [911/1000 29152/32000 (91%)] Loss: 0.30315 (QuantReg: 12.83121) QuantErr: 12.83121 batch_time=0.39570 
Train Epoch: 26 [916/1000 29312/32000 (92%)] Loss: 0.36646 (QuantReg: 12.93554) QuantErr: 12.93554 batch_time=0.35625 
Train Epoch: 26 [921/1000 29472/32000 (92%)] Loss: 0.20740 (QuantReg: 12.80898) QuantErr: 12.80898 batch_time=0.35746 
Train Epoch: 26 [926/1000 29632/32000 (93%)] Loss: 0.28945 (QuantReg: 13.01637) QuantErr: 13.01637 batch_time=0.34800 
Train Epoch: 26 [931/1000 29792/32000 (93%)] Loss: 0.46415 (QuantReg: 12.53534) QuantErr: 12.53534 batch_time=0.35162 
Train Epoch: 26 [936/1000 29952/32000 (94%)] Loss: 0.64103 (QuantReg: 12.49329) QuantErr: 12.49329 batch_time=0.34991 
Train Epoch: 26 [941/1000 30112/32000 (94%)] Loss: 0.30148 (QuantReg: 13.06208) QuantErr: 13.06208 batch_time=0.34687 
Train Epoch: 26 [946/1000 30272/32000 (95%)] Loss: 0.12308 (QuantReg: 13.37309) QuantErr: 13.37309 batch_time=0.34187 
Train Epoch: 26 [951/1000 30432/32000 (95%)] Loss: 0.72206 (QuantReg: 12.57478) QuantErr: 12.57478 batch_time=0.34648 
Train Epoch: 26 [956/1000 30592/32000 (96%)] Loss: 0.79364 (QuantReg: 12.07589) QuantErr: 12.07589 batch_time=0.34172 
Train Epoch: 26 [961/1000 30752/32000 (96%)] Loss: 0.31869 (QuantReg: 13.10629) QuantErr: 13.10629 batch_time=0.34415 
Train Epoch: 26 [966/1000 30912/32000 (97%)] Loss: 0.26133 (QuantReg: 12.91567) QuantErr: 12.91567 batch_time=0.34808 
Train Epoch: 26 [971/1000 31072/32000 (97%)] Loss: 0.49602 (QuantReg: 12.52829) QuantErr: 12.52829 batch_time=0.36163 
Train Epoch: 26 [976/1000 31232/32000 (98%)] Loss: 0.27994 (QuantReg: 12.43494) QuantErr: 12.43494 batch_time=0.38636 
Train Epoch: 26 [981/1000 31392/32000 (98%)] Loss: 0.29400 (QuantReg: 12.22435) QuantErr: 12.22435 batch_time=0.35258 
Train Epoch: 26 [986/1000 31552/32000 (99%)] Loss: 0.13789 (QuantReg: 12.22124) QuantErr: 12.22124 batch_time=0.34613 
Train Epoch: 26 [991/1000 31712/32000 (99%)] Loss: 0.29051 (QuantReg: 12.67056) QuantErr: 12.67056 batch_time=0.35163 
Train Epoch: 26 [996/1000 31872/32000 (100%)] Loss: 0.33149 (QuantReg: 12.70667) QuantErr: 12.70667 batch_time=0.36632 
Train Epoch: 26 codebook_update_time=1.80161
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch26.pth ...
Done in 3.992s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 0.3835428064092994
 quant_reg      : 12.54904983997345
 quant_err      : 12.54904983997345
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 26000
 MSRVTT_full_val/t2v_metrics/R1: 29.577464788732396
 MSRVTT_full_val/t2v_metrics/R5: 65.59356136820925
 MSRVTT_full_val/t2v_metrics/R10: 82.897384305835
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.949698189134809
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.381893899070846
 MSRVTT_full_val/v2t_metrics/R1: 33.199195171026155
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.701207243460765
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.74522484869832
 MSRVTT_full_test/t2v_metrics/R1: 11.672240802675585
 MSRVTT_full_test/t2v_metrics/R5: 35.852842809364546
 MSRVTT_full_test/t2v_metrics/R10: 50.20066889632107
 MSRVTT_full_test/t2v_metrics/R50: 81.10367892976589
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.96789297658863
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.59280043136934
 MSRVTT_full_test/v2t_metrics/R1: 14.448160535117056
 MSRVTT_full_test/v2t_metrics/R5: 41.137123745819395
 MSRVTT_full_test/v2t_metrics/R10: 55.08361204013378
 MSRVTT_full_test/v2t_metrics/R50: 85.75250836120401
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.307190635451505
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.99064261852483
 mnt_best       : 27.599303841463385
 not_improved_count: 3
Train Epoch: 27 [1/1000 32/32000 (0%)] Loss: 0.07412 (QuantReg: 13.06406) QuantErr: 13.06406 batch_time=28.74909 
Train Epoch: 27 [6/1000 192/32000 (1%)] Loss: 0.49678 (QuantReg: 12.72384) QuantErr: 12.72384 batch_time=0.35838 
Train Epoch: 27 [11/1000 352/32000 (1%)] Loss: 0.37302 (QuantReg: 12.61955) QuantErr: 12.61955 batch_time=0.35337 
Train Epoch: 27 [16/1000 512/32000 (2%)] Loss: 0.32676 (QuantReg: 12.52166) QuantErr: 12.52166 batch_time=0.44012 
Train Epoch: 27 [21/1000 672/32000 (2%)] Loss: 0.23407 (QuantReg: 12.43931) QuantErr: 12.43931 batch_time=0.53765 
Train Epoch: 27 [26/1000 832/32000 (3%)] Loss: 0.44372 (QuantReg: 12.23711) QuantErr: 12.23711 batch_time=0.35418 
Train Epoch: 27 [31/1000 992/32000 (3%)] Loss: 0.09521 (QuantReg: 12.49900) QuantErr: 12.49900 batch_time=0.40853 
Train Epoch: 27 [36/1000 1152/32000 (4%)] Loss: 0.25120 (QuantReg: 12.24419) QuantErr: 12.24419 batch_time=0.35369 
Train Epoch: 27 [41/1000 1312/32000 (4%)] Loss: 0.30926 (QuantReg: 12.35427) QuantErr: 12.35427 batch_time=0.35053 
Train Epoch: 27 [46/1000 1472/32000 (5%)] Loss: 0.41076 (QuantReg: 12.94227) QuantErr: 12.94227 batch_time=0.35530 
Train Epoch: 27 [51/1000 1632/32000 (5%)] Loss: 0.32426 (QuantReg: 12.39854) QuantErr: 12.39854 batch_time=0.35210 
Train Epoch: 27 [56/1000 1792/32000 (6%)] Loss: 0.21392 (QuantReg: 12.11115) QuantErr: 12.11115 batch_time=0.35343 
Train Epoch: 27 [61/1000 1952/32000 (6%)] Loss: 0.23348 (QuantReg: 11.65791) QuantErr: 11.65791 batch_time=0.34772 
Train Epoch: 27 [66/1000 2112/32000 (7%)] Loss: 0.45022 (QuantReg: 12.85382) QuantErr: 12.85382 batch_time=0.46980 
Train Epoch: 27 [71/1000 2272/32000 (7%)] Loss: 0.28045 (QuantReg: 12.64918) QuantErr: 12.64918 batch_time=0.38333 
Train Epoch: 27 [76/1000 2432/32000 (8%)] Loss: 0.23190 (QuantReg: 12.37732) QuantErr: 12.37732 batch_time=0.34603 
Train Epoch: 27 [81/1000 2592/32000 (8%)] Loss: 0.28225 (QuantReg: 12.47842) QuantErr: 12.47842 batch_time=0.38767 
Train Epoch: 27 [86/1000 2752/32000 (9%)] Loss: 0.65685 (QuantReg: 12.35429) QuantErr: 12.35429 batch_time=0.35276 
Train Epoch: 27 [91/1000 2912/32000 (9%)] Loss: 0.19874 (QuantReg: 12.97308) QuantErr: 12.97308 batch_time=0.36102 
Train Epoch: 27 [96/1000 3072/32000 (10%)] Loss: 0.76406 (QuantReg: 11.70446) QuantErr: 11.70446 batch_time=0.37462 
Train Epoch: 27 [101/1000 3232/32000 (10%)] Loss: 0.28757 (QuantReg: 12.35827) QuantErr: 12.35827 batch_time=0.36017 
Train Epoch: 27 [106/1000 3392/32000 (11%)] Loss: 0.21780 (QuantReg: 12.57776) QuantErr: 12.57776 batch_time=0.38899 
Train Epoch: 27 [111/1000 3552/32000 (11%)] Loss: 0.18874 (QuantReg: 12.41845) QuantErr: 12.41845 batch_time=0.42518 
Train Epoch: 27 [116/1000 3712/32000 (12%)] Loss: 0.43953 (QuantReg: 12.20677) QuantErr: 12.20677 batch_time=0.43750 
Train Epoch: 27 [121/1000 3872/32000 (12%)] Loss: 0.68946 (QuantReg: 12.53037) QuantErr: 12.53037 batch_time=0.38544 
Train Epoch: 27 [126/1000 4032/32000 (13%)] Loss: 0.27226 (QuantReg: 12.10045) QuantErr: 12.10045 batch_time=0.38229 
Train Epoch: 27 [131/1000 4192/32000 (13%)] Loss: 0.13547 (QuantReg: 12.69196) QuantErr: 12.69196 batch_time=0.36315 
Train Epoch: 27 [136/1000 4352/32000 (14%)] Loss: 0.43385 (QuantReg: 13.10769) QuantErr: 13.10769 batch_time=0.39122 
Train Epoch: 27 [141/1000 4512/32000 (14%)] Loss: 0.34917 (QuantReg: 12.96680) QuantErr: 12.96680 batch_time=0.35319 
Train Epoch: 27 [146/1000 4672/32000 (15%)] Loss: 0.49038 (QuantReg: 12.40981) QuantErr: 12.40981 batch_time=0.38058 
Train Epoch: 27 [151/1000 4832/32000 (15%)] Loss: 0.42439 (QuantReg: 12.53573) QuantErr: 12.53573 batch_time=1.47283 
Train Epoch: 27 [156/1000 4992/32000 (16%)] Loss: 0.25385 (QuantReg: 12.63066) QuantErr: 12.63066 batch_time=0.36122 
Train Epoch: 27 [161/1000 5152/32000 (16%)] Loss: 0.37030 (QuantReg: 13.30674) QuantErr: 13.30674 batch_time=0.35422 
Train Epoch: 27 [166/1000 5312/32000 (17%)] Loss: 0.43098 (QuantReg: 11.79591) QuantErr: 11.79591 batch_time=0.36342 
Train Epoch: 27 [171/1000 5472/32000 (17%)] Loss: 0.38041 (QuantReg: 12.59030) QuantErr: 12.59030 batch_time=0.34879 
Train Epoch: 27 [176/1000 5632/32000 (18%)] Loss: 0.09250 (QuantReg: 12.79996) QuantErr: 12.79996 batch_time=0.36050 
Train Epoch: 27 [181/1000 5792/32000 (18%)] Loss: 0.35946 (QuantReg: 12.60585) QuantErr: 12.60585 batch_time=0.34925 
Train Epoch: 27 [186/1000 5952/32000 (19%)] Loss: 0.51598 (QuantReg: 12.80654) QuantErr: 12.80654 batch_time=0.34820 
Train Epoch: 27 [191/1000 6112/32000 (19%)] Loss: 0.19205 (QuantReg: 12.40731) QuantErr: 12.40731 batch_time=0.34893 
Train Epoch: 27 [196/1000 6272/32000 (20%)] Loss: 0.15644 (QuantReg: 13.10030) QuantErr: 13.10030 batch_time=0.35371 
Train Epoch: 27 [201/1000 6432/32000 (20%)] Loss: 0.40722 (QuantReg: 12.20144) QuantErr: 12.20144 batch_time=0.39722 
Train Epoch: 27 [206/1000 6592/32000 (21%)] Loss: 0.44323 (QuantReg: 12.17396) QuantErr: 12.17396 batch_time=0.35260 
Train Epoch: 27 [211/1000 6752/32000 (21%)] Loss: 0.44433 (QuantReg: 12.84838) QuantErr: 12.84838 batch_time=0.39380 
Train Epoch: 27 [216/1000 6912/32000 (22%)] Loss: 0.31332 (QuantReg: 13.15497) QuantErr: 13.15497 batch_time=0.40814 
Train Epoch: 27 [221/1000 7072/32000 (22%)] Loss: 0.38686 (QuantReg: 12.69417) QuantErr: 12.69417 batch_time=0.34870 
Train Epoch: 27 [226/1000 7232/32000 (23%)] Loss: 0.48184 (QuantReg: 12.37881) QuantErr: 12.37881 batch_time=0.38678 
Train Epoch: 27 [231/1000 7392/32000 (23%)] Loss: 0.29087 (QuantReg: 12.57956) QuantErr: 12.57956 batch_time=0.34887 
Train Epoch: 27 [236/1000 7552/32000 (24%)] Loss: 0.38537 (QuantReg: 12.08357) QuantErr: 12.08357 batch_time=0.43990 
Train Epoch: 27 [241/1000 7712/32000 (24%)] Loss: 0.21735 (QuantReg: 12.10366) QuantErr: 12.10366 batch_time=0.42262 
Train Epoch: 27 [246/1000 7872/32000 (25%)] Loss: 0.32710 (QuantReg: 12.82770) QuantErr: 12.82770 batch_time=0.35417 
Train Epoch: 27 [251/1000 8032/32000 (25%)] Loss: 0.09979 (QuantReg: 12.50914) QuantErr: 12.50914 batch_time=0.38968 
Train Epoch: 27 [256/1000 8192/32000 (26%)] Loss: 0.15139 (QuantReg: 13.01995) QuantErr: 13.01995 batch_time=0.36615 
Train Epoch: 27 [261/1000 8352/32000 (26%)] Loss: 0.30260 (QuantReg: 12.67384) QuantErr: 12.67384 batch_time=0.36100 
Train Epoch: 27 [266/1000 8512/32000 (27%)] Loss: 0.42229 (QuantReg: 12.46897) QuantErr: 12.46897 batch_time=0.35856 
Train Epoch: 27 [271/1000 8672/32000 (27%)] Loss: 0.08183 (QuantReg: 12.82308) QuantErr: 12.82308 batch_time=0.34421 
Train Epoch: 27 [276/1000 8832/32000 (28%)] Loss: 0.13663 (QuantReg: 12.42845) QuantErr: 12.42845 batch_time=0.37092 
Train Epoch: 27 [281/1000 8992/32000 (28%)] Loss: 0.61298 (QuantReg: 12.40364) QuantErr: 12.40364 batch_time=0.46222 
Train Epoch: 27 [286/1000 9152/32000 (29%)] Loss: 0.16560 (QuantReg: 12.64722) QuantErr: 12.64722 batch_time=0.34708 
Train Epoch: 27 [291/1000 9312/32000 (29%)] Loss: 0.47085 (QuantReg: 12.75547) QuantErr: 12.75547 batch_time=0.37592 
Train Epoch: 27 [296/1000 9472/32000 (30%)] Loss: 0.25385 (QuantReg: 12.50095) QuantErr: 12.50095 batch_time=0.40879 
Train Epoch: 27 [301/1000 9632/32000 (30%)] Loss: 0.30338 (QuantReg: 13.37101) QuantErr: 13.37101 batch_time=0.38714 
Train Epoch: 27 [306/1000 9792/32000 (31%)] Loss: 0.08658 (QuantReg: 13.15584) QuantErr: 13.15584 batch_time=0.36148 
Train Epoch: 27 [311/1000 9952/32000 (31%)] Loss: 0.25052 (QuantReg: 12.23804) QuantErr: 12.23804 batch_time=0.35121 
Train Epoch: 27 [316/1000 10112/32000 (32%)] Loss: 0.48294 (QuantReg: 12.25276) QuantErr: 12.25276 batch_time=0.36705 
Train Epoch: 27 [321/1000 10272/32000 (32%)] Loss: 0.37795 (QuantReg: 12.31021) QuantErr: 12.31021 batch_time=0.54260 
Train Epoch: 27 [326/1000 10432/32000 (33%)] Loss: 0.43169 (QuantReg: 12.05093) QuantErr: 12.05093 batch_time=0.35742 
Train Epoch: 27 [331/1000 10592/32000 (33%)] Loss: 0.17095 (QuantReg: 12.57894) QuantErr: 12.57894 batch_time=0.34973 
Train Epoch: 27 [336/1000 10752/32000 (34%)] Loss: 0.73047 (QuantReg: 13.16501) QuantErr: 13.16501 batch_time=0.40990 
Train Epoch: 27 [341/1000 10912/32000 (34%)] Loss: 0.29582 (QuantReg: 12.63782) QuantErr: 12.63782 batch_time=0.57889 
Train Epoch: 27 [346/1000 11072/32000 (35%)] Loss: 0.72230 (QuantReg: 12.62313) QuantErr: 12.62313 batch_time=0.36553 
Train Epoch: 27 [351/1000 11232/32000 (35%)] Loss: 0.45285 (QuantReg: 13.12705) QuantErr: 13.12705 batch_time=0.35065 
Train Epoch: 27 [356/1000 11392/32000 (36%)] Loss: 0.38292 (QuantReg: 12.59246) QuantErr: 12.59246 batch_time=0.39595 
Train Epoch: 27 [361/1000 11552/32000 (36%)] Loss: 0.32357 (QuantReg: 12.74040) QuantErr: 12.74040 batch_time=0.43516 
Train Epoch: 27 [366/1000 11712/32000 (37%)] Loss: 0.21352 (QuantReg: 12.82057) QuantErr: 12.82057 batch_time=0.40089 
Train Epoch: 27 [371/1000 11872/32000 (37%)] Loss: 0.18203 (QuantReg: 12.90957) QuantErr: 12.90957 batch_time=0.41134 
Train Epoch: 27 [376/1000 12032/32000 (38%)] Loss: 0.60596 (QuantReg: 11.84620) QuantErr: 11.84620 batch_time=0.36064 
Train Epoch: 27 [381/1000 12192/32000 (38%)] Loss: 0.18741 (QuantReg: 13.13856) QuantErr: 13.13856 batch_time=0.39131 
Train Epoch: 27 [386/1000 12352/32000 (39%)] Loss: 0.29787 (QuantReg: 11.97297) QuantErr: 11.97297 batch_time=0.54607 
Train Epoch: 27 [391/1000 12512/32000 (39%)] Loss: 0.68818 (QuantReg: 12.52811) QuantErr: 12.52811 batch_time=0.39318 
Train Epoch: 27 [396/1000 12672/32000 (40%)] Loss: 0.23271 (QuantReg: 13.39408) QuantErr: 13.39408 batch_time=0.34858 
Train Epoch: 27 [401/1000 12832/32000 (40%)] Loss: 0.42108 (QuantReg: 13.63169) QuantErr: 13.63169 batch_time=0.38372 
Train Epoch: 27 [406/1000 12992/32000 (41%)] Loss: 0.31146 (QuantReg: 13.07246) QuantErr: 13.07246 batch_time=0.34998 
Train Epoch: 27 [411/1000 13152/32000 (41%)] Loss: 0.32124 (QuantReg: 12.80209) QuantErr: 12.80209 batch_time=0.35120 
Train Epoch: 27 [416/1000 13312/32000 (42%)] Loss: 0.35525 (QuantReg: 12.34309) QuantErr: 12.34309 batch_time=0.35028 
Train Epoch: 27 [421/1000 13472/32000 (42%)] Loss: 0.42866 (QuantReg: 12.72643) QuantErr: 12.72643 batch_time=0.35719 
Train Epoch: 27 [426/1000 13632/32000 (43%)] Loss: 0.34371 (QuantReg: 12.57254) QuantErr: 12.57254 batch_time=0.34663 
Train Epoch: 27 [431/1000 13792/32000 (43%)] Loss: 0.60951 (QuantReg: 12.29582) QuantErr: 12.29582 batch_time=0.35138 
Train Epoch: 27 [436/1000 13952/32000 (44%)] Loss: 0.52866 (QuantReg: 12.18714) QuantErr: 12.18714 batch_time=0.33827 
Train Epoch: 27 [441/1000 14112/32000 (44%)] Loss: 0.50554 (QuantReg: 12.49567) QuantErr: 12.49567 batch_time=0.34922 
Train Epoch: 27 [446/1000 14272/32000 (45%)] Loss: 0.53306 (QuantReg: 12.04200) QuantErr: 12.04200 batch_time=0.36363 
Train Epoch: 27 [451/1000 14432/32000 (45%)] Loss: 0.37284 (QuantReg: 12.65533) QuantErr: 12.65533 batch_time=0.40707 
Train Epoch: 27 [456/1000 14592/32000 (46%)] Loss: 0.62030 (QuantReg: 12.06985) QuantErr: 12.06985 batch_time=0.41619 
Train Epoch: 27 [461/1000 14752/32000 (46%)] Loss: 0.23778 (QuantReg: 12.81398) QuantErr: 12.81398 batch_time=0.35834 
Train Epoch: 27 [466/1000 14912/32000 (47%)] Loss: 0.37734 (QuantReg: 12.10559) QuantErr: 12.10559 batch_time=0.45233 
Train Epoch: 27 [471/1000 15072/32000 (47%)] Loss: 0.26706 (QuantReg: 12.77284) QuantErr: 12.77284 batch_time=1.42726 
Train Epoch: 27 [476/1000 15232/32000 (48%)] Loss: 0.20501 (QuantReg: 12.58037) QuantErr: 12.58037 batch_time=0.35167 
Train Epoch: 27 [481/1000 15392/32000 (48%)] Loss: 0.20256 (QuantReg: 12.43070) QuantErr: 12.43070 batch_time=0.35131 
Train Epoch: 27 [486/1000 15552/32000 (49%)] Loss: 0.28428 (QuantReg: 12.22495) QuantErr: 12.22495 batch_time=0.36964 
Train Epoch: 27 [491/1000 15712/32000 (49%)] Loss: 0.43412 (QuantReg: 12.03518) QuantErr: 12.03518 batch_time=0.38334 
Train Epoch: 27 [496/1000 15872/32000 (50%)] Loss: 0.33496 (QuantReg: 12.83652) QuantErr: 12.83652 batch_time=0.35343 
Train Epoch: 27 [501/1000 16032/32000 (50%)] Loss: 0.37369 (QuantReg: 12.14528) QuantErr: 12.14528 batch_time=0.35338 
Train Epoch: 27 [506/1000 16192/32000 (51%)] Loss: 0.18163 (QuantReg: 12.34967) QuantErr: 12.34967 batch_time=0.35093 
Train Epoch: 27 [511/1000 16352/32000 (51%)] Loss: 0.30351 (QuantReg: 11.69823) QuantErr: 11.69823 batch_time=0.34831 
Train Epoch: 27 [516/1000 16512/32000 (52%)] Loss: 0.19767 (QuantReg: 13.31710) QuantErr: 13.31710 batch_time=0.38069 
Train Epoch: 27 [521/1000 16672/32000 (52%)] Loss: 0.61896 (QuantReg: 12.63238) QuantErr: 12.63238 batch_time=0.40520 
Train Epoch: 27 [526/1000 16832/32000 (53%)] Loss: 0.59449 (QuantReg: 12.78808) QuantErr: 12.78808 batch_time=0.37525 
Train Epoch: 27 [531/1000 16992/32000 (53%)] Loss: 0.27828 (QuantReg: 12.73006) QuantErr: 12.73006 batch_time=0.37671 
Train Epoch: 27 [536/1000 17152/32000 (54%)] Loss: 0.91803 (QuantReg: 12.10136) QuantErr: 12.10136 batch_time=0.36113 
Train Epoch: 27 [541/1000 17312/32000 (54%)] Loss: 0.26369 (QuantReg: 12.87772) QuantErr: 12.87772 batch_time=0.35297 
Train Epoch: 27 [546/1000 17472/32000 (55%)] Loss: 0.15862 (QuantReg: 12.44496) QuantErr: 12.44496 batch_time=0.39099 
Train Epoch: 27 [551/1000 17632/32000 (55%)] Loss: 0.78066 (QuantReg: 12.36989) QuantErr: 12.36989 batch_time=0.35316 
Train Epoch: 27 [556/1000 17792/32000 (56%)] Loss: 0.31656 (QuantReg: 12.74384) QuantErr: 12.74384 batch_time=0.40574 
Train Epoch: 27 [561/1000 17952/32000 (56%)] Loss: 0.26495 (QuantReg: 13.03338) QuantErr: 13.03338 batch_time=0.35138 
Train Epoch: 27 [566/1000 18112/32000 (57%)] Loss: 0.38146 (QuantReg: 12.23587) QuantErr: 12.23587 batch_time=0.34617 
Train Epoch: 27 [571/1000 18272/32000 (57%)] Loss: 0.65585 (QuantReg: 12.47002) QuantErr: 12.47002 batch_time=0.38570 
Train Epoch: 27 [576/1000 18432/32000 (58%)] Loss: 0.29093 (QuantReg: 12.58639) QuantErr: 12.58639 batch_time=0.35239 
Train Epoch: 27 [581/1000 18592/32000 (58%)] Loss: 0.24338 (QuantReg: 12.80301) QuantErr: 12.80301 batch_time=0.36047 
Train Epoch: 27 [586/1000 18752/32000 (59%)] Loss: 0.66159 (QuantReg: 12.50063) QuantErr: 12.50063 batch_time=0.34241 
Train Epoch: 27 [591/1000 18912/32000 (59%)] Loss: 0.12872 (QuantReg: 12.34045) QuantErr: 12.34045 batch_time=0.34275 
Train Epoch: 27 [596/1000 19072/32000 (60%)] Loss: 0.43745 (QuantReg: 12.60403) QuantErr: 12.60403 batch_time=0.38861 
Train Epoch: 27 [601/1000 19232/32000 (60%)] Loss: 0.16435 (QuantReg: 12.38126) QuantErr: 12.38126 batch_time=0.45746 
Train Epoch: 27 [606/1000 19392/32000 (61%)] Loss: 0.43276 (QuantReg: 12.34459) QuantErr: 12.34459 batch_time=0.34966 
Train Epoch: 27 [611/1000 19552/32000 (61%)] Loss: 0.60378 (QuantReg: 11.62405) QuantErr: 11.62405 batch_time=0.40931 
Train Epoch: 27 [616/1000 19712/32000 (62%)] Loss: 0.30335 (QuantReg: 11.95448) QuantErr: 11.95448 batch_time=0.43468 
Train Epoch: 27 [621/1000 19872/32000 (62%)] Loss: 0.72941 (QuantReg: 12.40787) QuantErr: 12.40787 batch_time=0.37682 
Train Epoch: 27 [626/1000 20032/32000 (63%)] Loss: 0.55892 (QuantReg: 12.31235) QuantErr: 12.31235 batch_time=0.37350 
Train Epoch: 27 [631/1000 20192/32000 (63%)] Loss: 0.20291 (QuantReg: 12.63535) QuantErr: 12.63535 batch_time=0.37113 
Train Epoch: 27 [636/1000 20352/32000 (64%)] Loss: 0.25073 (QuantReg: 12.85793) QuantErr: 12.85793 batch_time=0.38802 
Train Epoch: 27 [641/1000 20512/32000 (64%)] Loss: 0.37991 (QuantReg: 12.07441) QuantErr: 12.07441 batch_time=0.57263 
Train Epoch: 27 [646/1000 20672/32000 (65%)] Loss: 0.30895 (QuantReg: 11.77336) QuantErr: 11.77336 batch_time=0.40597 
Train Epoch: 27 [651/1000 20832/32000 (65%)] Loss: 0.37632 (QuantReg: 12.62253) QuantErr: 12.62253 batch_time=0.41574 
Train Epoch: 27 [656/1000 20992/32000 (66%)] Loss: 0.51311 (QuantReg: 12.39567) QuantErr: 12.39567 batch_time=0.41832 
Train Epoch: 27 [661/1000 21152/32000 (66%)] Loss: 0.52371 (QuantReg: 12.49763) QuantErr: 12.49763 batch_time=0.56312 
Train Epoch: 27 [666/1000 21312/32000 (67%)] Loss: 0.24658 (QuantReg: 12.67072) QuantErr: 12.67072 batch_time=0.41846 
Train Epoch: 27 [671/1000 21472/32000 (67%)] Loss: 0.41682 (QuantReg: 12.13409) QuantErr: 12.13409 batch_time=0.41089 
Train Epoch: 27 [676/1000 21632/32000 (68%)] Loss: 0.37809 (QuantReg: 12.57855) QuantErr: 12.57855 batch_time=0.36125 
Train Epoch: 27 [681/1000 21792/32000 (68%)] Loss: 0.29817 (QuantReg: 12.19654) QuantErr: 12.19654 batch_time=0.48369 
Train Epoch: 27 [686/1000 21952/32000 (69%)] Loss: 0.34426 (QuantReg: 12.43025) QuantErr: 12.43025 batch_time=0.36527 
Train Epoch: 27 [691/1000 22112/32000 (69%)] Loss: 0.19952 (QuantReg: 12.83085) QuantErr: 12.83085 batch_time=0.40982 
Train Epoch: 27 [696/1000 22272/32000 (70%)] Loss: 0.38426 (QuantReg: 12.68483) QuantErr: 12.68483 batch_time=0.39816 
Train Epoch: 27 [701/1000 22432/32000 (70%)] Loss: 0.34662 (QuantReg: 12.34737) QuantErr: 12.34737 batch_time=0.44628 
Train Epoch: 27 [706/1000 22592/32000 (71%)] Loss: 0.46308 (QuantReg: 12.74643) QuantErr: 12.74643 batch_time=0.48933 
Train Epoch: 27 [711/1000 22752/32000 (71%)] Loss: 0.67160 (QuantReg: 12.30924) QuantErr: 12.30924 batch_time=0.48569 
Train Epoch: 27 [716/1000 22912/32000 (72%)] Loss: 0.53661 (QuantReg: 12.99896) QuantErr: 12.99896 batch_time=0.39000 
Train Epoch: 27 [721/1000 23072/32000 (72%)] Loss: 0.38836 (QuantReg: 12.05934) QuantErr: 12.05934 batch_time=0.47921 
Train Epoch: 27 [726/1000 23232/32000 (73%)] Loss: 0.40972 (QuantReg: 12.40955) QuantErr: 12.40955 batch_time=0.40839 
Train Epoch: 27 [731/1000 23392/32000 (73%)] Loss: 0.24099 (QuantReg: 11.92753) QuantErr: 11.92753 batch_time=0.41643 
Train Epoch: 27 [736/1000 23552/32000 (74%)] Loss: 0.44926 (QuantReg: 12.54534) QuantErr: 12.54534 batch_time=0.35654 
Train Epoch: 27 [741/1000 23712/32000 (74%)] Loss: 0.31262 (QuantReg: 11.98963) QuantErr: 11.98963 batch_time=0.37394 
Train Epoch: 27 [746/1000 23872/32000 (75%)] Loss: 0.37817 (QuantReg: 12.16908) QuantErr: 12.16908 batch_time=0.39090 
Train Epoch: 27 [751/1000 24032/32000 (75%)] Loss: 0.64904 (QuantReg: 11.85405) QuantErr: 11.85405 batch_time=0.36282 
Train Epoch: 27 [756/1000 24192/32000 (76%)] Loss: 0.53290 (QuantReg: 12.74783) QuantErr: 12.74783 batch_time=0.38477 
Train Epoch: 27 [761/1000 24352/32000 (76%)] Loss: 0.64138 (QuantReg: 13.36411) QuantErr: 13.36411 batch_time=0.36644 
Train Epoch: 27 [766/1000 24512/32000 (77%)] Loss: 0.30946 (QuantReg: 11.79991) QuantErr: 11.79991 batch_time=0.35575 
Train Epoch: 27 [771/1000 24672/32000 (77%)] Loss: 0.16651 (QuantReg: 12.31714) QuantErr: 12.31714 batch_time=0.43401 
Train Epoch: 27 [776/1000 24832/32000 (78%)] Loss: 0.31150 (QuantReg: 12.54395) QuantErr: 12.54395 batch_time=0.40492 
Train Epoch: 27 [781/1000 24992/32000 (78%)] Loss: 0.56806 (QuantReg: 11.45075) QuantErr: 11.45075 batch_time=0.41512 
Train Epoch: 27 [786/1000 25152/32000 (79%)] Loss: 0.37356 (QuantReg: 12.65119) QuantErr: 12.65119 batch_time=0.41776 
Train Epoch: 27 [791/1000 25312/32000 (79%)] Loss: 0.10968 (QuantReg: 12.39203) QuantErr: 12.39203 batch_time=1.46126 
Train Epoch: 27 [796/1000 25472/32000 (80%)] Loss: 0.26960 (QuantReg: 12.37855) QuantErr: 12.37855 batch_time=0.37125 
Train Epoch: 27 [801/1000 25632/32000 (80%)] Loss: 0.36737 (QuantReg: 12.59266) QuantErr: 12.59266 batch_time=0.35513 
Train Epoch: 27 [806/1000 25792/32000 (81%)] Loss: 0.80123 (QuantReg: 13.09705) QuantErr: 13.09705 batch_time=0.35605 
Train Epoch: 27 [811/1000 25952/32000 (81%)] Loss: 0.39538 (QuantReg: 12.32358) QuantErr: 12.32358 batch_time=0.35927 
Train Epoch: 27 [816/1000 26112/32000 (82%)] Loss: 0.28591 (QuantReg: 12.16480) QuantErr: 12.16480 batch_time=0.36775 
Train Epoch: 27 [821/1000 26272/32000 (82%)] Loss: 0.35117 (QuantReg: 12.60101) QuantErr: 12.60101 batch_time=0.36033 
Train Epoch: 27 [826/1000 26432/32000 (83%)] Loss: 0.80018 (QuantReg: 13.40903) QuantErr: 13.40903 batch_time=0.34832 
Train Epoch: 27 [831/1000 26592/32000 (83%)] Loss: 0.27228 (QuantReg: 12.79448) QuantErr: 12.79448 batch_time=0.35587 
Train Epoch: 27 [836/1000 26752/32000 (84%)] Loss: 0.60785 (QuantReg: 12.87562) QuantErr: 12.87562 batch_time=0.36955 
Train Epoch: 27 [841/1000 26912/32000 (84%)] Loss: 0.26750 (QuantReg: 12.31588) QuantErr: 12.31588 batch_time=0.42692 
Train Epoch: 27 [846/1000 27072/32000 (85%)] Loss: 0.38802 (QuantReg: 12.78690) QuantErr: 12.78690 batch_time=0.43504 
Train Epoch: 27 [851/1000 27232/32000 (85%)] Loss: 0.80238 (QuantReg: 12.54867) QuantErr: 12.54867 batch_time=0.45379 
Train Epoch: 27 [856/1000 27392/32000 (86%)] Loss: 0.38609 (QuantReg: 12.25890) QuantErr: 12.25890 batch_time=0.36363 
Train Epoch: 27 [861/1000 27552/32000 (86%)] Loss: 0.27854 (QuantReg: 12.28281) QuantErr: 12.28281 batch_time=0.41708 
Train Epoch: 27 [866/1000 27712/32000 (87%)] Loss: 0.33030 (QuantReg: 12.76708) QuantErr: 12.76708 batch_time=0.35013 
Train Epoch: 27 [871/1000 27872/32000 (87%)] Loss: 0.10351 (QuantReg: 12.75428) QuantErr: 12.75428 batch_time=0.38760 
Train Epoch: 27 [876/1000 28032/32000 (88%)] Loss: 0.33828 (QuantReg: 12.77103) QuantErr: 12.77103 batch_time=0.44902 
Train Epoch: 27 [881/1000 28192/32000 (88%)] Loss: 0.39317 (QuantReg: 12.28251) QuantErr: 12.28251 batch_time=0.46857 
Train Epoch: 27 [886/1000 28352/32000 (89%)] Loss: 0.19542 (QuantReg: 12.81363) QuantErr: 12.81363 batch_time=0.40471 
Train Epoch: 27 [891/1000 28512/32000 (89%)] Loss: 0.20703 (QuantReg: 12.51443) QuantErr: 12.51443 batch_time=0.41996 
Train Epoch: 27 [896/1000 28672/32000 (90%)] Loss: 0.80176 (QuantReg: 12.48014) QuantErr: 12.48014 batch_time=0.45467 
Train Epoch: 27 [901/1000 28832/32000 (90%)] Loss: 0.33628 (QuantReg: 12.80660) QuantErr: 12.80660 batch_time=0.39213 
Train Epoch: 27 [906/1000 28992/32000 (91%)] Loss: 0.53782 (QuantReg: 12.68424) QuantErr: 12.68424 batch_time=0.34934 
Train Epoch: 27 [911/1000 29152/32000 (91%)] Loss: 0.15462 (QuantReg: 12.74011) QuantErr: 12.74011 batch_time=0.37672 
Train Epoch: 27 [916/1000 29312/32000 (92%)] Loss: 0.26304 (QuantReg: 12.50811) QuantErr: 12.50811 batch_time=0.40925 
Train Epoch: 27 [921/1000 29472/32000 (92%)] Loss: 0.31629 (QuantReg: 12.43969) QuantErr: 12.43969 batch_time=0.45569 
Train Epoch: 27 [926/1000 29632/32000 (93%)] Loss: 0.19867 (QuantReg: 12.74264) QuantErr: 12.74264 batch_time=0.35966 
Train Epoch: 27 [931/1000 29792/32000 (93%)] Loss: 0.55084 (QuantReg: 12.30813) QuantErr: 12.30813 batch_time=0.37076 
Train Epoch: 27 [936/1000 29952/32000 (94%)] Loss: 0.55826 (QuantReg: 12.39158) QuantErr: 12.39158 batch_time=0.41537 
Train Epoch: 27 [941/1000 30112/32000 (94%)] Loss: 0.60983 (QuantReg: 12.86078) QuantErr: 12.86078 batch_time=0.36105 
Train Epoch: 27 [946/1000 30272/32000 (95%)] Loss: 0.15912 (QuantReg: 13.04423) QuantErr: 13.04423 batch_time=0.37558 
Train Epoch: 27 [951/1000 30432/32000 (95%)] Loss: 0.68200 (QuantReg: 12.74747) QuantErr: 12.74747 batch_time=0.39578 
Train Epoch: 27 [956/1000 30592/32000 (96%)] Loss: 0.46090 (QuantReg: 12.44731) QuantErr: 12.44731 batch_time=0.35141 
Train Epoch: 27 [961/1000 30752/32000 (96%)] Loss: 0.38280 (QuantReg: 12.83962) QuantErr: 12.83962 batch_time=0.50650 
Train Epoch: 27 [966/1000 30912/32000 (97%)] Loss: 0.59139 (QuantReg: 12.89635) QuantErr: 12.89635 batch_time=0.36397 
Train Epoch: 27 [971/1000 31072/32000 (97%)] Loss: 0.08269 (QuantReg: 12.36193) QuantErr: 12.36193 batch_time=0.35111 
Train Epoch: 27 [976/1000 31232/32000 (98%)] Loss: 0.29116 (QuantReg: 12.75350) QuantErr: 12.75350 batch_time=0.40556 
Train Epoch: 27 [981/1000 31392/32000 (98%)] Loss: 0.54568 (QuantReg: 12.16564) QuantErr: 12.16564 batch_time=0.61949 
Train Epoch: 27 [986/1000 31552/32000 (99%)] Loss: 0.32519 (QuantReg: 12.95787) QuantErr: 12.95787 batch_time=0.35423 
Train Epoch: 27 [991/1000 31712/32000 (99%)] Loss: 0.57073 (QuantReg: 11.93389) QuantErr: 11.93389 batch_time=0.35259 
Train Epoch: 27 [996/1000 31872/32000 (100%)] Loss: 0.43201 (QuantReg: 13.21838) QuantErr: 13.21838 batch_time=0.36097 
Train Epoch: 27 codebook_update_time=1.80537
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch27.pth ...
Done in 4.057s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch27.pth ...
Done in 7.994s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 0.36989129273593424
 quant_reg      : 12.537862873077392
 quant_err      : 12.537862873077392
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 27000
 MSRVTT_full_val/t2v_metrics/R1: 30.58350100603622
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 83.09859154929578
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.301810865191147
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.64824316964884
 MSRVTT_full_val/v2t_metrics/R1: 34.60764587525151
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.1156941649899395
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.07800838529315
 MSRVTT_full_test/t2v_metrics/R1: 12.441471571906355
 MSRVTT_full_test/t2v_metrics/R5: 35.18394648829432
 MSRVTT_full_test/t2v_metrics/R10: 49.39799331103679
 MSRVTT_full_test/t2v_metrics/R50: 79.86622073578596
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.15886287625418
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.859620956666472
 MSRVTT_full_test/v2t_metrics/R1: 14.247491638795987
 MSRVTT_full_test/v2t_metrics/R5: 41.438127090301
 MSRVTT_full_test/v2t_metrics/R10: 56.32107023411371
 MSRVTT_full_test/v2t_metrics/R50: 85.51839464882943
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.328929765886286
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.15657673496955
 mnt_best       : 27.859620956666472
 not_improved_count: 0
Train Epoch: 28 [1/1000 32/32000 (0%)] Loss: 0.24382 (QuantReg: 12.74243) QuantErr: 12.74243 batch_time=25.95593 
Train Epoch: 28 [6/1000 192/32000 (1%)] Loss: 0.69701 (QuantReg: 12.42923) QuantErr: 12.42923 batch_time=0.34928 
Train Epoch: 28 [11/1000 352/32000 (1%)] Loss: 0.31364 (QuantReg: 12.37104) QuantErr: 12.37104 batch_time=0.34657 
Train Epoch: 28 [16/1000 512/32000 (2%)] Loss: 0.08242 (QuantReg: 13.22232) QuantErr: 13.22232 batch_time=1.11880 
Train Epoch: 28 [21/1000 672/32000 (2%)] Loss: 0.52107 (QuantReg: 12.32640) QuantErr: 12.32640 batch_time=0.34764 
Train Epoch: 28 [26/1000 832/32000 (3%)] Loss: 0.45634 (QuantReg: 13.15465) QuantErr: 13.15465 batch_time=0.36927 
Train Epoch: 28 [31/1000 992/32000 (3%)] Loss: 0.17820 (QuantReg: 12.32212) QuantErr: 12.32212 batch_time=0.89560 
Train Epoch: 28 [36/1000 1152/32000 (4%)] Loss: 0.45418 (QuantReg: 11.94781) QuantErr: 11.94781 batch_time=0.39311 
Train Epoch: 28 [41/1000 1312/32000 (4%)] Loss: 0.48218 (QuantReg: 12.84167) QuantErr: 12.84167 batch_time=0.38424 
Train Epoch: 28 [46/1000 1472/32000 (5%)] Loss: 0.24921 (QuantReg: 12.82542) QuantErr: 12.82542 batch_time=0.36246 
Train Epoch: 28 [51/1000 1632/32000 (5%)] Loss: 0.41265 (QuantReg: 12.56437) QuantErr: 12.56437 batch_time=0.39354 
Train Epoch: 28 [56/1000 1792/32000 (6%)] Loss: 0.24246 (QuantReg: 12.51927) QuantErr: 12.51927 batch_time=0.39845 
Train Epoch: 28 [61/1000 1952/32000 (6%)] Loss: 0.48517 (QuantReg: 12.35771) QuantErr: 12.35771 batch_time=0.38323 
Train Epoch: 28 [66/1000 2112/32000 (7%)] Loss: 0.38141 (QuantReg: 11.74833) QuantErr: 11.74833 batch_time=0.35060 
Train Epoch: 28 [71/1000 2272/32000 (7%)] Loss: 0.27462 (QuantReg: 12.52182) QuantErr: 12.52182 batch_time=0.37915 
Train Epoch: 28 [76/1000 2432/32000 (8%)] Loss: 0.49218 (QuantReg: 11.94003) QuantErr: 11.94003 batch_time=0.57299 
Train Epoch: 28 [81/1000 2592/32000 (8%)] Loss: 0.11209 (QuantReg: 13.17774) QuantErr: 13.17774 batch_time=0.34033 
Train Epoch: 28 [86/1000 2752/32000 (9%)] Loss: 0.29618 (QuantReg: 12.40303) QuantErr: 12.40303 batch_time=0.34496 
Train Epoch: 28 [91/1000 2912/32000 (9%)] Loss: 0.19159 (QuantReg: 12.70014) QuantErr: 12.70014 batch_time=0.38684 
Train Epoch: 28 [96/1000 3072/32000 (10%)] Loss: 0.35043 (QuantReg: 12.52897) QuantErr: 12.52897 batch_time=0.33971 
Train Epoch: 28 [101/1000 3232/32000 (10%)] Loss: 0.19960 (QuantReg: 12.52221) QuantErr: 12.52221 batch_time=0.39796 
Train Epoch: 28 [106/1000 3392/32000 (11%)] Loss: 0.36064 (QuantReg: 11.86389) QuantErr: 11.86389 batch_time=0.35924 
Train Epoch: 28 [111/1000 3552/32000 (11%)] Loss: 0.38222 (QuantReg: 12.77870) QuantErr: 12.77870 batch_time=0.38949 
Train Epoch: 28 [116/1000 3712/32000 (12%)] Loss: 0.11744 (QuantReg: 12.55268) QuantErr: 12.55268 batch_time=0.37924 
Train Epoch: 28 [121/1000 3872/32000 (12%)] Loss: 0.21433 (QuantReg: 12.59874) QuantErr: 12.59874 batch_time=0.35435 
Train Epoch: 28 [126/1000 4032/32000 (13%)] Loss: 0.36083 (QuantReg: 12.05286) QuantErr: 12.05286 batch_time=0.35719 
Train Epoch: 28 [131/1000 4192/32000 (13%)] Loss: 0.29766 (QuantReg: 12.41879) QuantErr: 12.41879 batch_time=0.41723 
Train Epoch: 28 [136/1000 4352/32000 (14%)] Loss: 1.00650 (QuantReg: 12.92204) QuantErr: 12.92204 batch_time=0.41170 
Train Epoch: 28 [141/1000 4512/32000 (14%)] Loss: 0.60823 (QuantReg: 12.21496) QuantErr: 12.21496 batch_time=0.41438 
Train Epoch: 28 [146/1000 4672/32000 (15%)] Loss: 0.13150 (QuantReg: 12.67923) QuantErr: 12.67923 batch_time=0.37646 
Train Epoch: 28 [151/1000 4832/32000 (15%)] Loss: 0.48050 (QuantReg: 12.41007) QuantErr: 12.41007 batch_time=0.43513 
Train Epoch: 28 [156/1000 4992/32000 (16%)] Loss: 0.20856 (QuantReg: 12.32068) QuantErr: 12.32068 batch_time=0.35743 
Train Epoch: 28 [161/1000 5152/32000 (16%)] Loss: 0.51351 (QuantReg: 13.12833) QuantErr: 13.12833 batch_time=0.36061 
Train Epoch: 28 [166/1000 5312/32000 (17%)] Loss: 0.41103 (QuantReg: 12.58436) QuantErr: 12.58436 batch_time=0.36323 
Train Epoch: 28 [171/1000 5472/32000 (17%)] Loss: 0.62568 (QuantReg: 12.46306) QuantErr: 12.46306 batch_time=0.37416 
Train Epoch: 28 [176/1000 5632/32000 (18%)] Loss: 0.35605 (QuantReg: 12.31183) QuantErr: 12.31183 batch_time=0.36749 
Train Epoch: 28 [181/1000 5792/32000 (18%)] Loss: 0.19107 (QuantReg: 12.65824) QuantErr: 12.65824 batch_time=0.39386 
Train Epoch: 28 [186/1000 5952/32000 (19%)] Loss: 0.30314 (QuantReg: 12.26957) QuantErr: 12.26957 batch_time=0.40907 
Train Epoch: 28 [191/1000 6112/32000 (19%)] Loss: 0.41254 (QuantReg: 12.04698) QuantErr: 12.04698 batch_time=0.37261 
Train Epoch: 28 [196/1000 6272/32000 (20%)] Loss: 0.70563 (QuantReg: 11.70236) QuantErr: 11.70236 batch_time=0.41393 
Train Epoch: 28 [201/1000 6432/32000 (20%)] Loss: 0.45641 (QuantReg: 12.60483) QuantErr: 12.60483 batch_time=0.35677 
Train Epoch: 28 [206/1000 6592/32000 (21%)] Loss: 0.40386 (QuantReg: 12.28434) QuantErr: 12.28434 batch_time=0.36180 
Train Epoch: 28 [211/1000 6752/32000 (21%)] Loss: 0.50736 (QuantReg: 12.62848) QuantErr: 12.62848 batch_time=0.38572 
Train Epoch: 28 [216/1000 6912/32000 (22%)] Loss: 0.11171 (QuantReg: 12.59513) QuantErr: 12.59513 batch_time=0.36972 
Train Epoch: 28 [221/1000 7072/32000 (22%)] Loss: 0.12746 (QuantReg: 13.03941) QuantErr: 13.03941 batch_time=0.37206 
Train Epoch: 28 [226/1000 7232/32000 (23%)] Loss: 0.48352 (QuantReg: 12.69177) QuantErr: 12.69177 batch_time=0.36518 
Train Epoch: 28 [231/1000 7392/32000 (23%)] Loss: 0.49744 (QuantReg: 12.31021) QuantErr: 12.31021 batch_time=0.35788 
Train Epoch: 28 [236/1000 7552/32000 (24%)] Loss: 0.16846 (QuantReg: 12.43830) QuantErr: 12.43830 batch_time=0.36566 
Train Epoch: 28 [241/1000 7712/32000 (24%)] Loss: 0.40863 (QuantReg: 13.19942) QuantErr: 13.19942 batch_time=0.41220 
Train Epoch: 28 [246/1000 7872/32000 (25%)] Loss: 0.27320 (QuantReg: 12.72307) QuantErr: 12.72307 batch_time=0.41437 
Train Epoch: 28 [251/1000 8032/32000 (25%)] Loss: 0.38957 (QuantReg: 12.18863) QuantErr: 12.18863 batch_time=0.38314 
Train Epoch: 28 [256/1000 8192/32000 (26%)] Loss: 0.32745 (QuantReg: 12.33587) QuantErr: 12.33587 batch_time=0.36674 
Train Epoch: 28 [261/1000 8352/32000 (26%)] Loss: 0.45243 (QuantReg: 13.37039) QuantErr: 13.37039 batch_time=0.64667 
Train Epoch: 28 [266/1000 8512/32000 (27%)] Loss: 0.36020 (QuantReg: 11.98016) QuantErr: 11.98016 batch_time=0.35338 
Train Epoch: 28 [271/1000 8672/32000 (27%)] Loss: 0.25960 (QuantReg: 13.05806) QuantErr: 13.05806 batch_time=0.34908 
Train Epoch: 28 [276/1000 8832/32000 (28%)] Loss: 0.36699 (QuantReg: 12.92926) QuantErr: 12.92926 batch_time=0.36424 
Train Epoch: 28 [281/1000 8992/32000 (28%)] Loss: 0.15469 (QuantReg: 12.28736) QuantErr: 12.28736 batch_time=0.38975 
Train Epoch: 28 [286/1000 9152/32000 (29%)] Loss: 0.51958 (QuantReg: 13.08363) QuantErr: 13.08363 batch_time=0.60747 
Train Epoch: 28 [291/1000 9312/32000 (29%)] Loss: 0.21839 (QuantReg: 12.07519) QuantErr: 12.07519 batch_time=0.37259 
Train Epoch: 28 [296/1000 9472/32000 (30%)] Loss: 0.19384 (QuantReg: 12.41995) QuantErr: 12.41995 batch_time=0.41247 
Train Epoch: 28 [301/1000 9632/32000 (30%)] Loss: 0.38732 (QuantReg: 12.85060) QuantErr: 12.85060 batch_time=0.40166 
Train Epoch: 28 [306/1000 9792/32000 (31%)] Loss: 0.40815 (QuantReg: 11.84122) QuantErr: 11.84122 batch_time=0.45754 
Train Epoch: 28 [311/1000 9952/32000 (31%)] Loss: 0.79225 (QuantReg: 11.41415) QuantErr: 11.41415 batch_time=0.36413 
Train Epoch: 28 [316/1000 10112/32000 (32%)] Loss: 0.27535 (QuantReg: 12.59356) QuantErr: 12.59356 batch_time=0.38257 
Train Epoch: 28 [321/1000 10272/32000 (32%)] Loss: 0.50284 (QuantReg: 12.56733) QuantErr: 12.56733 batch_time=0.39415 
Train Epoch: 28 [326/1000 10432/32000 (33%)] Loss: 0.40031 (QuantReg: 12.94424) QuantErr: 12.94424 batch_time=0.38916 
Train Epoch: 28 [331/1000 10592/32000 (33%)] Loss: 0.76962 (QuantReg: 12.15564) QuantErr: 12.15564 batch_time=0.35245 
Train Epoch: 28 [336/1000 10752/32000 (34%)] Loss: 0.39729 (QuantReg: 12.24830) QuantErr: 12.24830 batch_time=0.96476 
Train Epoch: 28 [341/1000 10912/32000 (34%)] Loss: 0.31922 (QuantReg: 13.01122) QuantErr: 13.01122 batch_time=0.34013 
Train Epoch: 28 [346/1000 11072/32000 (35%)] Loss: 0.24049 (QuantReg: 12.80156) QuantErr: 12.80156 batch_time=0.34871 
Train Epoch: 28 [351/1000 11232/32000 (35%)] Loss: 0.17774 (QuantReg: 12.54662) QuantErr: 12.54662 batch_time=0.79429 
Train Epoch: 28 [356/1000 11392/32000 (36%)] Loss: 0.23446 (QuantReg: 12.69518) QuantErr: 12.69518 batch_time=0.41240 
Train Epoch: 28 [361/1000 11552/32000 (36%)] Loss: 0.45561 (QuantReg: 12.85604) QuantErr: 12.85604 batch_time=0.43218 
Train Epoch: 28 [366/1000 11712/32000 (37%)] Loss: 0.27240 (QuantReg: 12.97495) QuantErr: 12.97495 batch_time=0.42833 
Train Epoch: 28 [371/1000 11872/32000 (37%)] Loss: 0.33878 (QuantReg: 12.68925) QuantErr: 12.68925 batch_time=0.39337 
Train Epoch: 28 [376/1000 12032/32000 (38%)] Loss: 0.29897 (QuantReg: 12.97594) QuantErr: 12.97594 batch_time=0.38362 
Train Epoch: 28 [381/1000 12192/32000 (38%)] Loss: 0.27220 (QuantReg: 12.62238) QuantErr: 12.62238 batch_time=0.38919 
Train Epoch: 28 [386/1000 12352/32000 (39%)] Loss: 0.28623 (QuantReg: 12.52068) QuantErr: 12.52068 batch_time=0.40141 
Train Epoch: 28 [391/1000 12512/32000 (39%)] Loss: 0.15999 (QuantReg: 12.38064) QuantErr: 12.38064 batch_time=0.38565 
Train Epoch: 28 [396/1000 12672/32000 (40%)] Loss: 0.26698 (QuantReg: 12.27062) QuantErr: 12.27062 batch_time=0.55889 
Train Epoch: 28 [401/1000 12832/32000 (40%)] Loss: 0.46410 (QuantReg: 12.68498) QuantErr: 12.68498 batch_time=0.46133 
Train Epoch: 28 [406/1000 12992/32000 (41%)] Loss: 0.71701 (QuantReg: 12.31494) QuantErr: 12.31494 batch_time=0.40583 
Train Epoch: 28 [411/1000 13152/32000 (41%)] Loss: 0.37467 (QuantReg: 12.98563) QuantErr: 12.98563 batch_time=0.35286 
Train Epoch: 28 [416/1000 13312/32000 (42%)] Loss: 0.41307 (QuantReg: 12.29713) QuantErr: 12.29713 batch_time=0.36942 
Train Epoch: 28 [421/1000 13472/32000 (42%)] Loss: 0.18510 (QuantReg: 12.87595) QuantErr: 12.87595 batch_time=0.38363 
Train Epoch: 28 [426/1000 13632/32000 (43%)] Loss: 0.16526 (QuantReg: 12.72104) QuantErr: 12.72104 batch_time=0.43032 
Train Epoch: 28 [431/1000 13792/32000 (43%)] Loss: 0.55488 (QuantReg: 12.65907) QuantErr: 12.65907 batch_time=0.37420 
Train Epoch: 28 [436/1000 13952/32000 (44%)] Loss: 0.17352 (QuantReg: 12.65456) QuantErr: 12.65456 batch_time=0.42522 
Train Epoch: 28 [441/1000 14112/32000 (44%)] Loss: 0.29467 (QuantReg: 12.83024) QuantErr: 12.83024 batch_time=0.41151 
Train Epoch: 28 [446/1000 14272/32000 (45%)] Loss: 0.49202 (QuantReg: 13.37897) QuantErr: 13.37897 batch_time=0.36979 
Train Epoch: 28 [451/1000 14432/32000 (45%)] Loss: 0.22613 (QuantReg: 12.57094) QuantErr: 12.57094 batch_time=0.41424 
Train Epoch: 28 [456/1000 14592/32000 (46%)] Loss: 0.39150 (QuantReg: 13.15621) QuantErr: 13.15621 batch_time=0.40702 
Train Epoch: 28 [461/1000 14752/32000 (46%)] Loss: 0.21534 (QuantReg: 13.31020) QuantErr: 13.31020 batch_time=0.34782 
Train Epoch: 28 [466/1000 14912/32000 (47%)] Loss: 0.23626 (QuantReg: 13.15355) QuantErr: 13.15355 batch_time=0.37235 
Train Epoch: 28 [471/1000 15072/32000 (47%)] Loss: 0.24170 (QuantReg: 11.81040) QuantErr: 11.81040 batch_time=0.34547 
Train Epoch: 28 [476/1000 15232/32000 (48%)] Loss: 0.13975 (QuantReg: 12.72611) QuantErr: 12.72611 batch_time=0.34453 
Train Epoch: 28 [481/1000 15392/32000 (48%)] Loss: 0.69386 (QuantReg: 12.15320) QuantErr: 12.15320 batch_time=0.34625 
Train Epoch: 28 [486/1000 15552/32000 (49%)] Loss: 0.29648 (QuantReg: 12.91780) QuantErr: 12.91780 batch_time=0.38864 
Train Epoch: 28 [491/1000 15712/32000 (49%)] Loss: 0.39850 (QuantReg: 12.26094) QuantErr: 12.26094 batch_time=0.37212 
Train Epoch: 28 [496/1000 15872/32000 (50%)] Loss: 0.40917 (QuantReg: 12.36519) QuantErr: 12.36519 batch_time=0.39050 
Train Epoch: 28 [501/1000 16032/32000 (50%)] Loss: 0.52086 (QuantReg: 12.66110) QuantErr: 12.66110 batch_time=0.42851 
Train Epoch: 28 [506/1000 16192/32000 (51%)] Loss: 0.41914 (QuantReg: 12.25451) QuantErr: 12.25451 batch_time=0.48015 
Train Epoch: 28 [511/1000 16352/32000 (51%)] Loss: 0.33926 (QuantReg: 12.99526) QuantErr: 12.99526 batch_time=0.36397 
Train Epoch: 28 [516/1000 16512/32000 (52%)] Loss: 0.41062 (QuantReg: 12.82172) QuantErr: 12.82172 batch_time=0.41409 
Train Epoch: 28 [521/1000 16672/32000 (52%)] Loss: 0.22068 (QuantReg: 12.11693) QuantErr: 12.11693 batch_time=0.39625 
Train Epoch: 28 [526/1000 16832/32000 (53%)] Loss: 0.16042 (QuantReg: 13.18063) QuantErr: 13.18063 batch_time=0.34832 
Train Epoch: 28 [531/1000 16992/32000 (53%)] Loss: 0.31703 (QuantReg: 12.46328) QuantErr: 12.46328 batch_time=0.40282 
Train Epoch: 28 [536/1000 17152/32000 (54%)] Loss: 0.37434 (QuantReg: 12.51971) QuantErr: 12.51971 batch_time=0.35384 
Train Epoch: 28 [541/1000 17312/32000 (54%)] Loss: 0.38721 (QuantReg: 12.12415) QuantErr: 12.12415 batch_time=0.37608 
Train Epoch: 28 [546/1000 17472/32000 (55%)] Loss: 0.16760 (QuantReg: 12.33731) QuantErr: 12.33731 batch_time=0.35131 
Train Epoch: 28 [551/1000 17632/32000 (55%)] Loss: 0.37026 (QuantReg: 12.78822) QuantErr: 12.78822 batch_time=0.43733 
Train Epoch: 28 [556/1000 17792/32000 (56%)] Loss: 0.70388 (QuantReg: 13.05158) QuantErr: 13.05158 batch_time=0.37230 
Train Epoch: 28 [561/1000 17952/32000 (56%)] Loss: 0.45989 (QuantReg: 13.01994) QuantErr: 13.01994 batch_time=0.35954 
Train Epoch: 28 [566/1000 18112/32000 (57%)] Loss: 0.25463 (QuantReg: 13.16289) QuantErr: 13.16289 batch_time=0.36783 
Train Epoch: 28 [571/1000 18272/32000 (57%)] Loss: 0.39280 (QuantReg: 12.97610) QuantErr: 12.97610 batch_time=0.41744 
Train Epoch: 28 [576/1000 18432/32000 (58%)] Loss: 0.33442 (QuantReg: 12.58930) QuantErr: 12.58930 batch_time=0.35357 
Train Epoch: 28 [581/1000 18592/32000 (58%)] Loss: 0.41913 (QuantReg: 12.55847) QuantErr: 12.55847 batch_time=0.63685 
Train Epoch: 28 [586/1000 18752/32000 (59%)] Loss: 0.33965 (QuantReg: 12.37893) QuantErr: 12.37893 batch_time=0.37379 
Train Epoch: 28 [591/1000 18912/32000 (59%)] Loss: 0.46842 (QuantReg: 11.85689) QuantErr: 11.85689 batch_time=0.35377 
Train Epoch: 28 [596/1000 19072/32000 (60%)] Loss: 0.23998 (QuantReg: 11.77354) QuantErr: 11.77354 batch_time=0.40357 
Train Epoch: 28 [601/1000 19232/32000 (60%)] Loss: 0.22967 (QuantReg: 12.50390) QuantErr: 12.50390 batch_time=0.45232 
Train Epoch: 28 [606/1000 19392/32000 (61%)] Loss: 0.28215 (QuantReg: 12.30560) QuantErr: 12.30560 batch_time=0.70955 
Train Epoch: 28 [611/1000 19552/32000 (61%)] Loss: 0.25059 (QuantReg: 12.90388) QuantErr: 12.90388 batch_time=0.36709 
Train Epoch: 28 [616/1000 19712/32000 (62%)] Loss: 0.19619 (QuantReg: 12.81364) QuantErr: 12.81364 batch_time=0.43701 
Train Epoch: 28 [621/1000 19872/32000 (62%)] Loss: 0.33395 (QuantReg: 13.36794) QuantErr: 13.36794 batch_time=0.36242 
Train Epoch: 28 [626/1000 20032/32000 (63%)] Loss: 0.06954 (QuantReg: 12.11848) QuantErr: 12.11848 batch_time=0.34969 
Train Epoch: 28 [631/1000 20192/32000 (63%)] Loss: 0.74368 (QuantReg: 13.01000) QuantErr: 13.01000 batch_time=0.34748 
Train Epoch: 28 [636/1000 20352/32000 (64%)] Loss: 0.13024 (QuantReg: 12.74176) QuantErr: 12.74176 batch_time=0.38969 
Train Epoch: 28 [641/1000 20512/32000 (64%)] Loss: 0.46363 (QuantReg: 12.19802) QuantErr: 12.19802 batch_time=0.38512 
Train Epoch: 28 [646/1000 20672/32000 (65%)] Loss: 0.77308 (QuantReg: 12.43277) QuantErr: 12.43277 batch_time=0.38532 
Train Epoch: 28 [651/1000 20832/32000 (65%)] Loss: 0.40156 (QuantReg: 12.53991) QuantErr: 12.53991 batch_time=0.39040 
Train Epoch: 28 [656/1000 20992/32000 (66%)] Loss: 0.06423 (QuantReg: 13.09170) QuantErr: 13.09170 batch_time=0.94037 
Train Epoch: 28 [661/1000 21152/32000 (66%)] Loss: 0.22015 (QuantReg: 13.03460) QuantErr: 13.03460 batch_time=0.39006 
Train Epoch: 28 [666/1000 21312/32000 (67%)] Loss: 0.63958 (QuantReg: 12.40485) QuantErr: 12.40485 batch_time=0.36088 
Train Epoch: 28 [671/1000 21472/32000 (67%)] Loss: 0.39849 (QuantReg: 12.89599) QuantErr: 12.89599 batch_time=0.88688 
Train Epoch: 28 [676/1000 21632/32000 (68%)] Loss: 0.07038 (QuantReg: 12.13032) QuantErr: 12.13032 batch_time=0.38257 
Train Epoch: 28 [681/1000 21792/32000 (68%)] Loss: 0.30645 (QuantReg: 12.85881) QuantErr: 12.85881 batch_time=0.43811 
Train Epoch: 28 [686/1000 21952/32000 (69%)] Loss: 0.22541 (QuantReg: 12.70683) QuantErr: 12.70683 batch_time=0.35486 
Train Epoch: 28 [691/1000 22112/32000 (69%)] Loss: 0.22594 (QuantReg: 12.29235) QuantErr: 12.29235 batch_time=0.35221 
Train Epoch: 28 [696/1000 22272/32000 (70%)] Loss: 0.31775 (QuantReg: 12.81513) QuantErr: 12.81513 batch_time=0.35438 
Train Epoch: 28 [701/1000 22432/32000 (70%)] Loss: 0.24538 (QuantReg: 12.71352) QuantErr: 12.71352 batch_time=0.37370 
Train Epoch: 28 [706/1000 22592/32000 (71%)] Loss: 0.46950 (QuantReg: 12.35877) QuantErr: 12.35877 batch_time=0.40017 
Train Epoch: 28 [711/1000 22752/32000 (71%)] Loss: 0.28548 (QuantReg: 12.93229) QuantErr: 12.93229 batch_time=0.38174 
Train Epoch: 28 [716/1000 22912/32000 (72%)] Loss: 0.25424 (QuantReg: 12.46929) QuantErr: 12.46929 batch_time=0.61242 
Train Epoch: 28 [721/1000 23072/32000 (72%)] Loss: 0.38197 (QuantReg: 12.50720) QuantErr: 12.50720 batch_time=0.35146 
Train Epoch: 28 [726/1000 23232/32000 (73%)] Loss: 0.69216 (QuantReg: 12.03173) QuantErr: 12.03173 batch_time=0.35545 
Train Epoch: 28 [731/1000 23392/32000 (73%)] Loss: 0.30466 (QuantReg: 12.90434) QuantErr: 12.90434 batch_time=0.50940 
Train Epoch: 28 [736/1000 23552/32000 (74%)] Loss: 0.23685 (QuantReg: 12.35297) QuantErr: 12.35297 batch_time=0.39311 
Train Epoch: 28 [741/1000 23712/32000 (74%)] Loss: 0.49565 (QuantReg: 11.92998) QuantErr: 11.92998 batch_time=0.41840 
Train Epoch: 28 [746/1000 23872/32000 (75%)] Loss: 0.29603 (QuantReg: 12.90522) QuantErr: 12.90522 batch_time=0.38992 
Train Epoch: 28 [751/1000 24032/32000 (75%)] Loss: 0.35998 (QuantReg: 11.96535) QuantErr: 11.96535 batch_time=0.38153 
Train Epoch: 28 [756/1000 24192/32000 (76%)] Loss: 0.25665 (QuantReg: 12.12898) QuantErr: 12.12898 batch_time=0.35321 
Train Epoch: 28 [761/1000 24352/32000 (76%)] Loss: 0.49063 (QuantReg: 12.74290) QuantErr: 12.74290 batch_time=0.36168 
Train Epoch: 28 [766/1000 24512/32000 (77%)] Loss: 0.31689 (QuantReg: 12.65474) QuantErr: 12.65474 batch_time=0.34924 
Train Epoch: 28 [771/1000 24672/32000 (77%)] Loss: 0.16363 (QuantReg: 12.12952) QuantErr: 12.12952 batch_time=0.40119 
Train Epoch: 28 [776/1000 24832/32000 (78%)] Loss: 0.17412 (QuantReg: 12.81832) QuantErr: 12.81832 batch_time=0.40487 
Train Epoch: 28 [781/1000 24992/32000 (78%)] Loss: 0.19190 (QuantReg: 13.18625) QuantErr: 13.18625 batch_time=0.35365 
Train Epoch: 28 [786/1000 25152/32000 (79%)] Loss: 0.12455 (QuantReg: 12.47603) QuantErr: 12.47603 batch_time=0.35465 
Train Epoch: 28 [791/1000 25312/32000 (79%)] Loss: 0.63447 (QuantReg: 12.72277) QuantErr: 12.72277 batch_time=0.39841 
Train Epoch: 28 [796/1000 25472/32000 (80%)] Loss: 0.30673 (QuantReg: 12.61918) QuantErr: 12.61918 batch_time=0.37355 
Train Epoch: 28 [801/1000 25632/32000 (80%)] Loss: 0.23302 (QuantReg: 11.85183) QuantErr: 11.85183 batch_time=0.38450 
Train Epoch: 28 [806/1000 25792/32000 (81%)] Loss: 0.21435 (QuantReg: 12.87836) QuantErr: 12.87836 batch_time=0.42359 
Train Epoch: 28 [811/1000 25952/32000 (81%)] Loss: 0.17531 (QuantReg: 13.20708) QuantErr: 13.20708 batch_time=0.45215 
Train Epoch: 28 [816/1000 26112/32000 (82%)] Loss: 0.18060 (QuantReg: 11.87104) QuantErr: 11.87104 batch_time=0.34678 
Train Epoch: 28 [821/1000 26272/32000 (82%)] Loss: 0.22282 (QuantReg: 12.55647) QuantErr: 12.55647 batch_time=0.35509 
Train Epoch: 28 [826/1000 26432/32000 (83%)] Loss: 0.30228 (QuantReg: 12.26311) QuantErr: 12.26311 batch_time=0.41176 
Train Epoch: 28 [831/1000 26592/32000 (83%)] Loss: 0.27686 (QuantReg: 13.05725) QuantErr: 13.05725 batch_time=0.47169 
Train Epoch: 28 [836/1000 26752/32000 (84%)] Loss: 0.45127 (QuantReg: 12.73578) QuantErr: 12.73578 batch_time=0.42507 
Train Epoch: 28 [841/1000 26912/32000 (84%)] Loss: 0.29506 (QuantReg: 13.17476) QuantErr: 13.17476 batch_time=0.39086 
Train Epoch: 28 [846/1000 27072/32000 (85%)] Loss: 0.40634 (QuantReg: 12.44698) QuantErr: 12.44698 batch_time=0.37755 
Train Epoch: 28 [851/1000 27232/32000 (85%)] Loss: 0.20931 (QuantReg: 12.14521) QuantErr: 12.14521 batch_time=0.42752 
Train Epoch: 28 [856/1000 27392/32000 (86%)] Loss: 0.12648 (QuantReg: 12.93763) QuantErr: 12.93763 batch_time=0.41423 
Train Epoch: 28 [861/1000 27552/32000 (86%)] Loss: 0.39432 (QuantReg: 12.24874) QuantErr: 12.24874 batch_time=0.35597 
Train Epoch: 28 [866/1000 27712/32000 (87%)] Loss: 0.36530 (QuantReg: 13.36818) QuantErr: 13.36818 batch_time=0.39079 
Train Epoch: 28 [871/1000 27872/32000 (87%)] Loss: 0.34310 (QuantReg: 12.44710) QuantErr: 12.44710 batch_time=0.36953 
Train Epoch: 28 [876/1000 28032/32000 (88%)] Loss: 0.24275 (QuantReg: 12.53912) QuantErr: 12.53912 batch_time=0.38763 
Train Epoch: 28 [881/1000 28192/32000 (88%)] Loss: 0.26259 (QuantReg: 12.04158) QuantErr: 12.04158 batch_time=0.42959 
Train Epoch: 28 [886/1000 28352/32000 (89%)] Loss: 0.25202 (QuantReg: 12.95484) QuantErr: 12.95484 batch_time=0.49935 
Train Epoch: 28 [891/1000 28512/32000 (89%)] Loss: 0.22609 (QuantReg: 12.48164) QuantErr: 12.48164 batch_time=0.39102 
Train Epoch: 28 [896/1000 28672/32000 (90%)] Loss: 0.18841 (QuantReg: 12.65289) QuantErr: 12.65289 batch_time=0.37547 
Train Epoch: 28 [901/1000 28832/32000 (90%)] Loss: 0.27009 (QuantReg: 12.38974) QuantErr: 12.38974 batch_time=0.64106 
Train Epoch: 28 [906/1000 28992/32000 (91%)] Loss: 0.17432 (QuantReg: 12.39983) QuantErr: 12.39983 batch_time=0.41919 
Train Epoch: 28 [911/1000 29152/32000 (91%)] Loss: 0.53941 (QuantReg: 12.38269) QuantErr: 12.38269 batch_time=0.38641 
Train Epoch: 28 [916/1000 29312/32000 (92%)] Loss: 0.64091 (QuantReg: 13.01047) QuantErr: 13.01047 batch_time=0.41792 
Train Epoch: 28 [921/1000 29472/32000 (92%)] Loss: 0.26069 (QuantReg: 13.16598) QuantErr: 13.16598 batch_time=0.34925 
Train Epoch: 28 [926/1000 29632/32000 (93%)] Loss: 0.23562 (QuantReg: 13.14023) QuantErr: 13.14023 batch_time=0.70701 
Train Epoch: 28 [931/1000 29792/32000 (93%)] Loss: 0.30968 (QuantReg: 13.07392) QuantErr: 13.07392 batch_time=0.36731 
Train Epoch: 28 [936/1000 29952/32000 (94%)] Loss: 0.18574 (QuantReg: 12.78340) QuantErr: 12.78340 batch_time=0.36630 
Train Epoch: 28 [941/1000 30112/32000 (94%)] Loss: 0.49911 (QuantReg: 12.55632) QuantErr: 12.55632 batch_time=0.38828 
Train Epoch: 28 [946/1000 30272/32000 (95%)] Loss: 0.32834 (QuantReg: 12.77943) QuantErr: 12.77943 batch_time=0.40182 
Train Epoch: 28 [951/1000 30432/32000 (95%)] Loss: 0.31278 (QuantReg: 13.21739) QuantErr: 13.21739 batch_time=0.41217 
Train Epoch: 28 [956/1000 30592/32000 (96%)] Loss: 0.30360 (QuantReg: 13.48681) QuantErr: 13.48681 batch_time=0.39382 
Train Epoch: 28 [961/1000 30752/32000 (96%)] Loss: 0.30875 (QuantReg: 12.91818) QuantErr: 12.91818 batch_time=0.43889 
Train Epoch: 28 [966/1000 30912/32000 (97%)] Loss: 0.28533 (QuantReg: 12.23636) QuantErr: 12.23636 batch_time=0.36827 
Train Epoch: 28 [971/1000 31072/32000 (97%)] Loss: 0.37569 (QuantReg: 12.13707) QuantErr: 12.13707 batch_time=0.37833 
Train Epoch: 28 [976/1000 31232/32000 (98%)] Loss: 0.19243 (QuantReg: 12.92984) QuantErr: 12.92984 batch_time=1.01483 
Train Epoch: 28 [981/1000 31392/32000 (98%)] Loss: 0.30967 (QuantReg: 12.49334) QuantErr: 12.49334 batch_time=0.37721 
Train Epoch: 28 [986/1000 31552/32000 (99%)] Loss: 0.15273 (QuantReg: 12.39761) QuantErr: 12.39761 batch_time=0.37696 
Train Epoch: 28 [991/1000 31712/32000 (99%)] Loss: 0.47534 (QuantReg: 12.72613) QuantErr: 12.72613 batch_time=0.71166 
Train Epoch: 28 [996/1000 31872/32000 (100%)] Loss: 0.14117 (QuantReg: 13.01003) QuantErr: 13.01003 batch_time=0.38709 
Train Epoch: 28 codebook_update_time=1.91893
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch28.pth ...
Done in 12.792s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch28.pth ...
Done in 17.057s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 0.35594467318803075
 quant_reg      : 12.573534029960632
 quant_err      : 12.573534029960632
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 28000
 MSRVTT_full_val/t2v_metrics/R1: 28.772635814889338
 MSRVTT_full_val/t2v_metrics/R5: 66.59959758551308
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.758551307847083
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.8053437130953
 MSRVTT_full_val/v2t_metrics/R1: 35.61368209255533
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 85.71428571428571
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.259557344064386
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.969601314387276
 MSRVTT_full_test/t2v_metrics/R1: 12.909698996655518
 MSRVTT_full_test/t2v_metrics/R5: 35.45150501672241
 MSRVTT_full_test/t2v_metrics/R10: 50.836120401337794
 MSRVTT_full_test/t2v_metrics/R50: 81.1371237458194
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.6886287625418
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.547915173501718
 MSRVTT_full_test/v2t_metrics/R1: 15.752508361204013
 MSRVTT_full_test/v2t_metrics/R5: 42.77591973244147
 MSRVTT_full_test/v2t_metrics/R10: 58.39464882943144
 MSRVTT_full_test/v2t_metrics/R50: 86.25418060200668
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.608193979933105
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.01266868514894
 mnt_best       : 28.547915173501718
 not_improved_count: 0
Train Epoch: 29 [1/1000 32/32000 (0%)] Loss: 0.32509 (QuantReg: 12.42451) QuantErr: 12.42451 batch_time=27.47559 
Train Epoch: 29 [6/1000 192/32000 (1%)] Loss: 0.24892 (QuantReg: 11.92833) QuantErr: 11.92833 batch_time=0.36104 
Train Epoch: 29 [11/1000 352/32000 (1%)] Loss: 0.18352 (QuantReg: 12.65748) QuantErr: 12.65748 batch_time=0.36966 
Train Epoch: 29 [16/1000 512/32000 (2%)] Loss: 0.52539 (QuantReg: 11.98931) QuantErr: 11.98931 batch_time=0.39725 
Train Epoch: 29 [21/1000 672/32000 (2%)] Loss: 0.23557 (QuantReg: 12.76198) QuantErr: 12.76198 batch_time=0.38228 
Train Epoch: 29 [26/1000 832/32000 (3%)] Loss: 0.23249 (QuantReg: 12.37840) QuantErr: 12.37840 batch_time=0.35583 
Train Epoch: 29 [31/1000 992/32000 (3%)] Loss: 0.65570 (QuantReg: 12.78868) QuantErr: 12.78868 batch_time=0.34916 
Train Epoch: 29 [36/1000 1152/32000 (4%)] Loss: 0.71712 (QuantReg: 12.85986) QuantErr: 12.85986 batch_time=0.35443 
Train Epoch: 29 [41/1000 1312/32000 (4%)] Loss: 0.49121 (QuantReg: 12.35493) QuantErr: 12.35493 batch_time=0.34903 
Train Epoch: 29 [46/1000 1472/32000 (5%)] Loss: 0.36441 (QuantReg: 12.84809) QuantErr: 12.84809 batch_time=0.39277 
Train Epoch: 29 [51/1000 1632/32000 (5%)] Loss: 0.90630 (QuantReg: 12.40106) QuantErr: 12.40106 batch_time=0.37311 
Train Epoch: 29 [56/1000 1792/32000 (6%)] Loss: 0.44375 (QuantReg: 12.35350) QuantErr: 12.35350 batch_time=0.40625 
Train Epoch: 29 [61/1000 1952/32000 (6%)] Loss: 0.13943 (QuantReg: 13.31722) QuantErr: 13.31722 batch_time=0.37279 
Train Epoch: 29 [66/1000 2112/32000 (7%)] Loss: 0.34052 (QuantReg: 12.34118) QuantErr: 12.34118 batch_time=0.53270 
Train Epoch: 29 [71/1000 2272/32000 (7%)] Loss: 0.44853 (QuantReg: 12.91829) QuantErr: 12.91829 batch_time=1.98135 
Train Epoch: 29 [76/1000 2432/32000 (8%)] Loss: 0.27502 (QuantReg: 13.00446) QuantErr: 13.00446 batch_time=0.43338 
Train Epoch: 29 [81/1000 2592/32000 (8%)] Loss: 0.40885 (QuantReg: 12.29687) QuantErr: 12.29687 batch_time=0.38469 
Train Epoch: 29 [86/1000 2752/32000 (9%)] Loss: 0.23744 (QuantReg: 12.57193) QuantErr: 12.57193 batch_time=0.36034 
Train Epoch: 29 [91/1000 2912/32000 (9%)] Loss: 0.17076 (QuantReg: 12.38835) QuantErr: 12.38835 batch_time=0.37476 
Train Epoch: 29 [96/1000 3072/32000 (10%)] Loss: 0.41783 (QuantReg: 12.29065) QuantErr: 12.29065 batch_time=0.36611 
Train Epoch: 29 [101/1000 3232/32000 (10%)] Loss: 0.24041 (QuantReg: 13.02415) QuantErr: 13.02415 batch_time=0.39688 
Train Epoch: 29 [106/1000 3392/32000 (11%)] Loss: 0.32726 (QuantReg: 12.93058) QuantErr: 12.93058 batch_time=0.35943 
Train Epoch: 29 [111/1000 3552/32000 (11%)] Loss: 0.30531 (QuantReg: 12.42925) QuantErr: 12.42925 batch_time=0.41853 
Train Epoch: 29 [116/1000 3712/32000 (12%)] Loss: 0.14119 (QuantReg: 12.50932) QuantErr: 12.50932 batch_time=0.41323 
Train Epoch: 29 [121/1000 3872/32000 (12%)] Loss: 0.22348 (QuantReg: 12.19085) QuantErr: 12.19085 batch_time=0.41055 
Train Epoch: 29 [126/1000 4032/32000 (13%)] Loss: 0.19075 (QuantReg: 12.19223) QuantErr: 12.19223 batch_time=0.42143 
Train Epoch: 29 [131/1000 4192/32000 (13%)] Loss: 0.34995 (QuantReg: 12.60242) QuantErr: 12.60242 batch_time=0.41379 
Train Epoch: 29 [136/1000 4352/32000 (14%)] Loss: 0.57051 (QuantReg: 12.70215) QuantErr: 12.70215 batch_time=0.47994 
Train Epoch: 29 [141/1000 4512/32000 (14%)] Loss: 0.53724 (QuantReg: 12.84126) QuantErr: 12.84126 batch_time=0.46570 
Train Epoch: 29 [146/1000 4672/32000 (15%)] Loss: 0.39409 (QuantReg: 12.26740) QuantErr: 12.26740 batch_time=0.35460 
Train Epoch: 29 [151/1000 4832/32000 (15%)] Loss: 0.37114 (QuantReg: 12.78095) QuantErr: 12.78095 batch_time=0.41012 
Train Epoch: 29 [156/1000 4992/32000 (16%)] Loss: 0.44744 (QuantReg: 12.74162) QuantErr: 12.74162 batch_time=0.41565 
Train Epoch: 29 [161/1000 5152/32000 (16%)] Loss: 0.11284 (QuantReg: 12.83501) QuantErr: 12.83501 batch_time=0.35160 
Train Epoch: 29 [166/1000 5312/32000 (17%)] Loss: 0.36453 (QuantReg: 12.90615) QuantErr: 12.90615 batch_time=0.35686 
Train Epoch: 29 [171/1000 5472/32000 (17%)] Loss: 0.29939 (QuantReg: 12.35684) QuantErr: 12.35684 batch_time=0.38111 
Train Epoch: 29 [176/1000 5632/32000 (18%)] Loss: 0.25899 (QuantReg: 12.83953) QuantErr: 12.83953 batch_time=0.36018 
Train Epoch: 29 [181/1000 5792/32000 (18%)] Loss: 0.31459 (QuantReg: 13.21929) QuantErr: 13.21929 batch_time=0.36316 
Train Epoch: 29 [186/1000 5952/32000 (19%)] Loss: 0.33088 (QuantReg: 12.24128) QuantErr: 12.24128 batch_time=0.34316 
Train Epoch: 29 [191/1000 6112/32000 (19%)] Loss: 0.20597 (QuantReg: 12.01144) QuantErr: 12.01144 batch_time=0.34511 
Train Epoch: 29 [196/1000 6272/32000 (20%)] Loss: 0.72818 (QuantReg: 12.05196) QuantErr: 12.05196 batch_time=0.58172 
Train Epoch: 29 [201/1000 6432/32000 (20%)] Loss: 0.40654 (QuantReg: 12.88100) QuantErr: 12.88100 batch_time=0.39548 
Train Epoch: 29 [206/1000 6592/32000 (21%)] Loss: 0.34243 (QuantReg: 12.98766) QuantErr: 12.98766 batch_time=0.39482 
Train Epoch: 29 [211/1000 6752/32000 (21%)] Loss: 0.14416 (QuantReg: 12.24292) QuantErr: 12.24292 batch_time=0.39458 
Train Epoch: 29 [216/1000 6912/32000 (22%)] Loss: 0.23245 (QuantReg: 13.06911) QuantErr: 13.06911 batch_time=0.37666 
Train Epoch: 29 [221/1000 7072/32000 (22%)] Loss: 0.25298 (QuantReg: 12.86423) QuantErr: 12.86423 batch_time=0.35455 
Train Epoch: 29 [226/1000 7232/32000 (23%)] Loss: 0.46638 (QuantReg: 12.55032) QuantErr: 12.55032 batch_time=0.35356 
Train Epoch: 29 [231/1000 7392/32000 (23%)] Loss: 0.24510 (QuantReg: 13.25012) QuantErr: 13.25012 batch_time=0.35226 
Train Epoch: 29 [236/1000 7552/32000 (24%)] Loss: 0.56296 (QuantReg: 12.84441) QuantErr: 12.84441 batch_time=0.35494 
Train Epoch: 29 [241/1000 7712/32000 (24%)] Loss: 0.49492 (QuantReg: 12.57198) QuantErr: 12.57198 batch_time=0.35503 
Train Epoch: 29 [246/1000 7872/32000 (25%)] Loss: 0.54890 (QuantReg: 11.78749) QuantErr: 11.78749 batch_time=0.35422 
Train Epoch: 29 [251/1000 8032/32000 (25%)] Loss: 0.16735 (QuantReg: 12.25655) QuantErr: 12.25655 batch_time=0.38365 
Train Epoch: 29 [256/1000 8192/32000 (26%)] Loss: 0.60663 (QuantReg: 12.24388) QuantErr: 12.24388 batch_time=0.37062 
Train Epoch: 29 [261/1000 8352/32000 (26%)] Loss: 0.47983 (QuantReg: 12.04478) QuantErr: 12.04478 batch_time=0.35114 
Train Epoch: 29 [266/1000 8512/32000 (27%)] Loss: 0.46679 (QuantReg: 12.24547) QuantErr: 12.24547 batch_time=0.38657 
Train Epoch: 29 [271/1000 8672/32000 (27%)] Loss: 0.55784 (QuantReg: 13.04883) QuantErr: 13.04883 batch_time=0.35773 
Train Epoch: 29 [276/1000 8832/32000 (28%)] Loss: 0.57861 (QuantReg: 12.67611) QuantErr: 12.67611 batch_time=0.36715 
Train Epoch: 29 [281/1000 8992/32000 (28%)] Loss: 0.21590 (QuantReg: 12.31026) QuantErr: 12.31026 batch_time=0.48268 
Train Epoch: 29 [286/1000 9152/32000 (29%)] Loss: 0.13876 (QuantReg: 12.33078) QuantErr: 12.33078 batch_time=0.35760 
Train Epoch: 29 [291/1000 9312/32000 (29%)] Loss: 0.30612 (QuantReg: 12.31794) QuantErr: 12.31794 batch_time=0.35723 
Train Epoch: 29 [296/1000 9472/32000 (30%)] Loss: 0.26043 (QuantReg: 12.29152) QuantErr: 12.29152 batch_time=0.34919 
Train Epoch: 29 [301/1000 9632/32000 (30%)] Loss: 0.53747 (QuantReg: 12.06535) QuantErr: 12.06535 batch_time=0.40329 
Train Epoch: 29 [306/1000 9792/32000 (31%)] Loss: 0.67318 (QuantReg: 12.50239) QuantErr: 12.50239 batch_time=0.44091 
Train Epoch: 29 [311/1000 9952/32000 (31%)] Loss: 0.37243 (QuantReg: 12.39269) QuantErr: 12.39269 batch_time=0.36542 
Train Epoch: 29 [316/1000 10112/32000 (32%)] Loss: 0.71996 (QuantReg: 11.94073) QuantErr: 11.94073 batch_time=0.35512 
Train Epoch: 29 [321/1000 10272/32000 (32%)] Loss: 0.56310 (QuantReg: 12.26769) QuantErr: 12.26769 batch_time=0.36676 
Train Epoch: 29 [326/1000 10432/32000 (33%)] Loss: 0.14931 (QuantReg: 12.96598) QuantErr: 12.96598 batch_time=0.35158 
Train Epoch: 29 [331/1000 10592/32000 (33%)] Loss: 0.30079 (QuantReg: 12.73825) QuantErr: 12.73825 batch_time=0.35073 
Train Epoch: 29 [336/1000 10752/32000 (34%)] Loss: 0.20376 (QuantReg: 13.16379) QuantErr: 13.16379 batch_time=0.34944 
Train Epoch: 29 [341/1000 10912/32000 (34%)] Loss: 0.28966 (QuantReg: 12.00514) QuantErr: 12.00514 batch_time=0.46864 
Train Epoch: 29 [346/1000 11072/32000 (35%)] Loss: 0.24744 (QuantReg: 12.75409) QuantErr: 12.75409 batch_time=0.36402 
Train Epoch: 29 [351/1000 11232/32000 (35%)] Loss: 0.41180 (QuantReg: 12.20793) QuantErr: 12.20793 batch_time=0.35630 
Train Epoch: 29 [356/1000 11392/32000 (36%)] Loss: 0.32623 (QuantReg: 12.42894) QuantErr: 12.42894 batch_time=0.41173 
Train Epoch: 29 [361/1000 11552/32000 (36%)] Loss: 0.13068 (QuantReg: 12.38898) QuantErr: 12.38898 batch_time=0.36562 
Train Epoch: 29 [366/1000 11712/32000 (37%)] Loss: 0.60022 (QuantReg: 11.69967) QuantErr: 11.69967 batch_time=0.39719 
Train Epoch: 29 [371/1000 11872/32000 (37%)] Loss: 0.20444 (QuantReg: 12.19494) QuantErr: 12.19494 batch_time=0.37297 
Train Epoch: 29 [376/1000 12032/32000 (38%)] Loss: 0.53486 (QuantReg: 12.79538) QuantErr: 12.79538 batch_time=0.39845 
Train Epoch: 29 [381/1000 12192/32000 (38%)] Loss: 0.34482 (QuantReg: 13.11896) QuantErr: 13.11896 batch_time=0.37236 
Train Epoch: 29 [386/1000 12352/32000 (39%)] Loss: 0.12998 (QuantReg: 12.70233) QuantErr: 12.70233 batch_time=0.45348 
Train Epoch: 29 [391/1000 12512/32000 (39%)] Loss: 0.13619 (QuantReg: 12.86943) QuantErr: 12.86943 batch_time=1.66687 
Train Epoch: 29 [396/1000 12672/32000 (40%)] Loss: 0.46103 (QuantReg: 12.33346) QuantErr: 12.33346 batch_time=0.43987 
Train Epoch: 29 [401/1000 12832/32000 (40%)] Loss: 0.29781 (QuantReg: 12.94789) QuantErr: 12.94789 batch_time=0.36487 
Train Epoch: 29 [406/1000 12992/32000 (41%)] Loss: 0.38436 (QuantReg: 12.72224) QuantErr: 12.72224 batch_time=0.36041 
Train Epoch: 29 [411/1000 13152/32000 (41%)] Loss: 0.26893 (QuantReg: 12.22987) QuantErr: 12.22987 batch_time=0.35766 
Train Epoch: 29 [416/1000 13312/32000 (42%)] Loss: 0.23265 (QuantReg: 13.04508) QuantErr: 13.04508 batch_time=0.36488 
Train Epoch: 29 [421/1000 13472/32000 (42%)] Loss: 0.28152 (QuantReg: 12.64811) QuantErr: 12.64811 batch_time=0.38532 
Train Epoch: 29 [426/1000 13632/32000 (43%)] Loss: 0.23507 (QuantReg: 12.24255) QuantErr: 12.24255 batch_time=0.37352 
Train Epoch: 29 [431/1000 13792/32000 (43%)] Loss: 0.31436 (QuantReg: 12.14476) QuantErr: 12.14476 batch_time=0.36824 
Train Epoch: 29 [436/1000 13952/32000 (44%)] Loss: 0.34501 (QuantReg: 12.65026) QuantErr: 12.65026 batch_time=0.43156 
Train Epoch: 29 [441/1000 14112/32000 (44%)] Loss: 0.13428 (QuantReg: 12.20807) QuantErr: 12.20807 batch_time=0.46652 
Train Epoch: 29 [446/1000 14272/32000 (45%)] Loss: 0.13577 (QuantReg: 12.72793) QuantErr: 12.72793 batch_time=0.37040 
Train Epoch: 29 [451/1000 14432/32000 (45%)] Loss: 0.41769 (QuantReg: 12.99674) QuantErr: 12.99674 batch_time=0.38994 
Train Epoch: 29 [456/1000 14592/32000 (46%)] Loss: 0.48279 (QuantReg: 12.52731) QuantErr: 12.52731 batch_time=0.46051 
Train Epoch: 29 [461/1000 14752/32000 (46%)] Loss: 0.65458 (QuantReg: 12.74240) QuantErr: 12.74240 batch_time=0.44380 
Train Epoch: 29 [466/1000 14912/32000 (47%)] Loss: 0.47927 (QuantReg: 12.25526) QuantErr: 12.25526 batch_time=0.45049 
Train Epoch: 29 [471/1000 15072/32000 (47%)] Loss: 0.36213 (QuantReg: 12.81610) QuantErr: 12.81610 batch_time=0.35407 
Train Epoch: 29 [476/1000 15232/32000 (48%)] Loss: 0.53646 (QuantReg: 12.43914) QuantErr: 12.43914 batch_time=0.37632 
Train Epoch: 29 [481/1000 15392/32000 (48%)] Loss: 0.22690 (QuantReg: 12.49406) QuantErr: 12.49406 batch_time=0.34799 
Train Epoch: 29 [486/1000 15552/32000 (49%)] Loss: 0.32686 (QuantReg: 12.96578) QuantErr: 12.96578 batch_time=0.35092 
Train Epoch: 29 [491/1000 15712/32000 (49%)] Loss: 0.14332 (QuantReg: 12.68868) QuantErr: 12.68868 batch_time=0.40372 
Train Epoch: 29 [496/1000 15872/32000 (50%)] Loss: 0.64061 (QuantReg: 12.40992) QuantErr: 12.40992 batch_time=0.36309 
Train Epoch: 29 [501/1000 16032/32000 (50%)] Loss: 0.30906 (QuantReg: 12.88515) QuantErr: 12.88515 batch_time=0.38218 
Train Epoch: 29 [506/1000 16192/32000 (51%)] Loss: 0.37616 (QuantReg: 12.03932) QuantErr: 12.03932 batch_time=0.37298 
Train Epoch: 29 [511/1000 16352/32000 (51%)] Loss: 0.12330 (QuantReg: 13.07339) QuantErr: 13.07339 batch_time=0.38058 
Train Epoch: 29 [516/1000 16512/32000 (52%)] Loss: 0.19576 (QuantReg: 12.30967) QuantErr: 12.30967 batch_time=0.57933 
Train Epoch: 29 [521/1000 16672/32000 (52%)] Loss: 0.42613 (QuantReg: 12.25485) QuantErr: 12.25485 batch_time=0.37857 
Train Epoch: 29 [526/1000 16832/32000 (53%)] Loss: 0.62064 (QuantReg: 13.10458) QuantErr: 13.10458 batch_time=0.40745 
Train Epoch: 29 [531/1000 16992/32000 (53%)] Loss: 1.36448 (QuantReg: 12.29258) QuantErr: 12.29258 batch_time=0.39065 
Train Epoch: 29 [536/1000 17152/32000 (54%)] Loss: 0.63085 (QuantReg: 13.03076) QuantErr: 13.03076 batch_time=0.36793 
Train Epoch: 29 [541/1000 17312/32000 (54%)] Loss: 0.50723 (QuantReg: 11.77582) QuantErr: 11.77582 batch_time=0.35511 
Train Epoch: 29 [546/1000 17472/32000 (55%)] Loss: 0.33626 (QuantReg: 12.38573) QuantErr: 12.38573 batch_time=0.36293 
Train Epoch: 29 [551/1000 17632/32000 (55%)] Loss: 0.43277 (QuantReg: 12.87025) QuantErr: 12.87025 batch_time=0.35578 
Train Epoch: 29 [556/1000 17792/32000 (56%)] Loss: 0.35142 (QuantReg: 12.87762) QuantErr: 12.87762 batch_time=0.38410 
Train Epoch: 29 [561/1000 17952/32000 (56%)] Loss: 0.49530 (QuantReg: 12.63085) QuantErr: 12.63085 batch_time=0.37844 
Train Epoch: 29 [566/1000 18112/32000 (57%)] Loss: 0.14569 (QuantReg: 12.17197) QuantErr: 12.17197 batch_time=0.37180 
Train Epoch: 29 [571/1000 18272/32000 (57%)] Loss: 0.40649 (QuantReg: 12.31158) QuantErr: 12.31158 batch_time=0.38100 
Train Epoch: 29 [576/1000 18432/32000 (58%)] Loss: 0.38182 (QuantReg: 12.42243) QuantErr: 12.42243 batch_time=0.36953 
Train Epoch: 29 [581/1000 18592/32000 (58%)] Loss: 0.64365 (QuantReg: 13.05117) QuantErr: 13.05117 batch_time=0.40720 
Train Epoch: 29 [586/1000 18752/32000 (59%)] Loss: 0.59948 (QuantReg: 12.71976) QuantErr: 12.71976 batch_time=0.36748 
Train Epoch: 29 [591/1000 18912/32000 (59%)] Loss: 0.33036 (QuantReg: 12.72681) QuantErr: 12.72681 batch_time=0.35313 
Train Epoch: 29 [596/1000 19072/32000 (60%)] Loss: 0.37635 (QuantReg: 13.20306) QuantErr: 13.20306 batch_time=0.37831 
Train Epoch: 29 [601/1000 19232/32000 (60%)] Loss: 0.22737 (QuantReg: 12.63777) QuantErr: 12.63777 batch_time=0.50128 
Train Epoch: 29 [606/1000 19392/32000 (61%)] Loss: 0.17645 (QuantReg: 12.93302) QuantErr: 12.93302 batch_time=0.35800 
Train Epoch: 29 [611/1000 19552/32000 (61%)] Loss: 0.21746 (QuantReg: 12.27516) QuantErr: 12.27516 batch_time=0.37049 
Train Epoch: 29 [616/1000 19712/32000 (62%)] Loss: 0.48763 (QuantReg: 12.79186) QuantErr: 12.79186 batch_time=0.42174 
Train Epoch: 29 [621/1000 19872/32000 (62%)] Loss: 0.48843 (QuantReg: 12.29749) QuantErr: 12.29749 batch_time=0.35690 
Train Epoch: 29 [626/1000 20032/32000 (63%)] Loss: 0.31251 (QuantReg: 12.76330) QuantErr: 12.76330 batch_time=0.41261 
Train Epoch: 29 [631/1000 20192/32000 (63%)] Loss: 0.33746 (QuantReg: 12.42107) QuantErr: 12.42107 batch_time=0.35544 
Train Epoch: 29 [636/1000 20352/32000 (64%)] Loss: 0.33663 (QuantReg: 12.18652) QuantErr: 12.18652 batch_time=0.35582 
Train Epoch: 29 [641/1000 20512/32000 (64%)] Loss: 0.44829 (QuantReg: 12.45708) QuantErr: 12.45708 batch_time=0.35761 
Train Epoch: 29 [646/1000 20672/32000 (65%)] Loss: 0.45006 (QuantReg: 12.50770) QuantErr: 12.50770 batch_time=0.39445 
Train Epoch: 29 [651/1000 20832/32000 (65%)] Loss: 0.63811 (QuantReg: 12.50439) QuantErr: 12.50439 batch_time=0.37021 
Train Epoch: 29 [656/1000 20992/32000 (66%)] Loss: 0.56045 (QuantReg: 12.43391) QuantErr: 12.43391 batch_time=0.36231 
Train Epoch: 29 [661/1000 21152/32000 (66%)] Loss: 0.37974 (QuantReg: 12.76565) QuantErr: 12.76565 batch_time=0.37443 
Train Epoch: 29 [666/1000 21312/32000 (67%)] Loss: 0.16502 (QuantReg: 12.51713) QuantErr: 12.51713 batch_time=0.37505 
Train Epoch: 29 [671/1000 21472/32000 (67%)] Loss: 0.20611 (QuantReg: 13.28242) QuantErr: 13.28242 batch_time=0.38425 
Train Epoch: 29 [676/1000 21632/32000 (68%)] Loss: 0.20528 (QuantReg: 13.35764) QuantErr: 13.35764 batch_time=0.36214 
Train Epoch: 29 [681/1000 21792/32000 (68%)] Loss: 0.67965 (QuantReg: 12.61866) QuantErr: 12.61866 batch_time=0.39563 
Train Epoch: 29 [686/1000 21952/32000 (69%)] Loss: 0.11382 (QuantReg: 13.25764) QuantErr: 13.25764 batch_time=0.36098 
Train Epoch: 29 [691/1000 22112/32000 (69%)] Loss: 0.60734 (QuantReg: 12.37693) QuantErr: 12.37693 batch_time=0.36940 
Train Epoch: 29 [696/1000 22272/32000 (70%)] Loss: 0.15870 (QuantReg: 12.14504) QuantErr: 12.14504 batch_time=0.36884 
Train Epoch: 29 [701/1000 22432/32000 (70%)] Loss: 0.24275 (QuantReg: 12.26373) QuantErr: 12.26373 batch_time=0.36573 
Train Epoch: 29 [706/1000 22592/32000 (71%)] Loss: 0.44099 (QuantReg: 12.47215) QuantErr: 12.47215 batch_time=0.46713 
Train Epoch: 29 [711/1000 22752/32000 (71%)] Loss: 0.17203 (QuantReg: 12.64836) QuantErr: 12.64836 batch_time=1.71139 
Train Epoch: 29 [716/1000 22912/32000 (72%)] Loss: 0.27056 (QuantReg: 11.80971) QuantErr: 11.80971 batch_time=0.41613 
Train Epoch: 29 [721/1000 23072/32000 (72%)] Loss: 0.72893 (QuantReg: 12.05870) QuantErr: 12.05870 batch_time=0.38100 
Train Epoch: 29 [726/1000 23232/32000 (73%)] Loss: 0.40668 (QuantReg: 12.22021) QuantErr: 12.22021 batch_time=0.38615 
Train Epoch: 29 [731/1000 23392/32000 (73%)] Loss: 0.24139 (QuantReg: 12.40034) QuantErr: 12.40034 batch_time=0.38402 
Train Epoch: 29 [736/1000 23552/32000 (74%)] Loss: 0.15425 (QuantReg: 12.85187) QuantErr: 12.85187 batch_time=0.43671 
Train Epoch: 29 [741/1000 23712/32000 (74%)] Loss: 0.33725 (QuantReg: 12.12789) QuantErr: 12.12789 batch_time=0.39005 
Train Epoch: 29 [746/1000 23872/32000 (75%)] Loss: 0.14840 (QuantReg: 12.66569) QuantErr: 12.66569 batch_time=0.47493 
Train Epoch: 29 [751/1000 24032/32000 (75%)] Loss: 0.41051 (QuantReg: 12.63288) QuantErr: 12.63288 batch_time=0.39552 
Train Epoch: 29 [756/1000 24192/32000 (76%)] Loss: 0.27252 (QuantReg: 12.52114) QuantErr: 12.52114 batch_time=0.43850 
Train Epoch: 29 [761/1000 24352/32000 (76%)] Loss: 0.40178 (QuantReg: 12.55556) QuantErr: 12.55556 batch_time=0.45522 
Train Epoch: 29 [766/1000 24512/32000 (77%)] Loss: 0.36787 (QuantReg: 13.14969) QuantErr: 13.14969 batch_time=0.35471 
Train Epoch: 29 [771/1000 24672/32000 (77%)] Loss: 0.63961 (QuantReg: 11.66109) QuantErr: 11.66109 batch_time=0.35051 
Train Epoch: 29 [776/1000 24832/32000 (78%)] Loss: 0.45643 (QuantReg: 12.56245) QuantErr: 12.56245 batch_time=0.46819 
Train Epoch: 29 [781/1000 24992/32000 (78%)] Loss: 0.39498 (QuantReg: 12.29031) QuantErr: 12.29031 batch_time=0.37265 
Train Epoch: 29 [786/1000 25152/32000 (79%)] Loss: 0.23270 (QuantReg: 12.55053) QuantErr: 12.55053 batch_time=0.37782 
Train Epoch: 29 [791/1000 25312/32000 (79%)] Loss: 0.45747 (QuantReg: 12.03176) QuantErr: 12.03176 batch_time=0.36408 
Train Epoch: 29 [796/1000 25472/32000 (80%)] Loss: 0.31339 (QuantReg: 12.42899) QuantErr: 12.42899 batch_time=0.35683 
Train Epoch: 29 [801/1000 25632/32000 (80%)] Loss: 0.17750 (QuantReg: 13.53370) QuantErr: 13.53370 batch_time=0.35717 
Train Epoch: 29 [806/1000 25792/32000 (81%)] Loss: 0.42222 (QuantReg: 12.38151) QuantErr: 12.38151 batch_time=0.40939 
Train Epoch: 29 [811/1000 25952/32000 (81%)] Loss: 0.26430 (QuantReg: 13.24214) QuantErr: 13.24214 batch_time=0.37303 
Train Epoch: 29 [816/1000 26112/32000 (82%)] Loss: 0.35306 (QuantReg: 12.77127) QuantErr: 12.77127 batch_time=0.36130 
Train Epoch: 29 [821/1000 26272/32000 (82%)] Loss: 0.22496 (QuantReg: 12.54644) QuantErr: 12.54644 batch_time=0.39848 
Train Epoch: 29 [826/1000 26432/32000 (83%)] Loss: 0.50091 (QuantReg: 12.88751) QuantErr: 12.88751 batch_time=0.35949 
Train Epoch: 29 [831/1000 26592/32000 (83%)] Loss: 0.57712 (QuantReg: 12.34714) QuantErr: 12.34714 batch_time=0.35512 
Train Epoch: 29 [836/1000 26752/32000 (84%)] Loss: 0.61469 (QuantReg: 12.15070) QuantErr: 12.15070 batch_time=0.57039 
Train Epoch: 29 [841/1000 26912/32000 (84%)] Loss: 0.64951 (QuantReg: 12.03117) QuantErr: 12.03117 batch_time=0.44023 
Train Epoch: 29 [846/1000 27072/32000 (85%)] Loss: 0.23704 (QuantReg: 12.99056) QuantErr: 12.99056 batch_time=0.45337 
Train Epoch: 29 [851/1000 27232/32000 (85%)] Loss: 0.41886 (QuantReg: 12.91795) QuantErr: 12.91795 batch_time=0.36120 
Train Epoch: 29 [856/1000 27392/32000 (86%)] Loss: 0.25223 (QuantReg: 12.65654) QuantErr: 12.65654 batch_time=0.35721 
Train Epoch: 29 [861/1000 27552/32000 (86%)] Loss: 0.31488 (QuantReg: 12.78310) QuantErr: 12.78310 batch_time=0.36035 
Train Epoch: 29 [866/1000 27712/32000 (87%)] Loss: 0.18628 (QuantReg: 12.59598) QuantErr: 12.59598 batch_time=0.35731 
Train Epoch: 29 [871/1000 27872/32000 (87%)] Loss: 0.44737 (QuantReg: 12.95274) QuantErr: 12.95274 batch_time=0.35136 
Train Epoch: 29 [876/1000 28032/32000 (88%)] Loss: 0.13294 (QuantReg: 13.01809) QuantErr: 13.01809 batch_time=0.36213 
Train Epoch: 29 [881/1000 28192/32000 (88%)] Loss: 0.59029 (QuantReg: 12.08040) QuantErr: 12.08040 batch_time=0.41550 
Train Epoch: 29 [886/1000 28352/32000 (89%)] Loss: 0.63595 (QuantReg: 12.23171) QuantErr: 12.23171 batch_time=0.40930 
Train Epoch: 29 [891/1000 28512/32000 (89%)] Loss: 0.31485 (QuantReg: 13.17662) QuantErr: 13.17662 batch_time=0.36353 
Train Epoch: 29 [896/1000 28672/32000 (90%)] Loss: 0.20497 (QuantReg: 13.10125) QuantErr: 13.10125 batch_time=0.36122 
Train Epoch: 29 [901/1000 28832/32000 (90%)] Loss: 0.34606 (QuantReg: 12.99218) QuantErr: 12.99218 batch_time=0.39825 
Train Epoch: 29 [906/1000 28992/32000 (91%)] Loss: 0.22104 (QuantReg: 13.03539) QuantErr: 13.03539 batch_time=0.42112 
Train Epoch: 29 [911/1000 29152/32000 (91%)] Loss: 0.46628 (QuantReg: 12.80514) QuantErr: 12.80514 batch_time=0.37321 
Train Epoch: 29 [916/1000 29312/32000 (92%)] Loss: 0.23988 (QuantReg: 13.43478) QuantErr: 13.43478 batch_time=0.37118 
Train Epoch: 29 [921/1000 29472/32000 (92%)] Loss: 0.60252 (QuantReg: 12.13826) QuantErr: 12.13826 batch_time=0.74729 
Train Epoch: 29 [926/1000 29632/32000 (93%)] Loss: 0.35587 (QuantReg: 12.26267) QuantErr: 12.26267 batch_time=0.35574 
Train Epoch: 29 [931/1000 29792/32000 (93%)] Loss: 0.42487 (QuantReg: 12.56568) QuantErr: 12.56568 batch_time=0.35491 
Train Epoch: 29 [936/1000 29952/32000 (94%)] Loss: 0.30941 (QuantReg: 12.56988) QuantErr: 12.56988 batch_time=0.38131 
Train Epoch: 29 [941/1000 30112/32000 (94%)] Loss: 0.49298 (QuantReg: 12.76789) QuantErr: 12.76789 batch_time=0.44682 
Train Epoch: 29 [946/1000 30272/32000 (95%)] Loss: 0.43443 (QuantReg: 12.84242) QuantErr: 12.84242 batch_time=0.42212 
Train Epoch: 29 [951/1000 30432/32000 (95%)] Loss: 0.52939 (QuantReg: 12.92496) QuantErr: 12.92496 batch_time=0.38580 
Train Epoch: 29 [956/1000 30592/32000 (96%)] Loss: 0.38986 (QuantReg: 12.55163) QuantErr: 12.55163 batch_time=0.38220 
Train Epoch: 29 [961/1000 30752/32000 (96%)] Loss: 0.18735 (QuantReg: 13.51103) QuantErr: 13.51103 batch_time=0.37835 
Train Epoch: 29 [966/1000 30912/32000 (97%)] Loss: 0.57663 (QuantReg: 12.79049) QuantErr: 12.79049 batch_time=0.39987 
Train Epoch: 29 [971/1000 31072/32000 (97%)] Loss: 0.40627 (QuantReg: 13.15250) QuantErr: 13.15250 batch_time=0.35920 
Train Epoch: 29 [976/1000 31232/32000 (98%)] Loss: 0.33137 (QuantReg: 12.09359) QuantErr: 12.09359 batch_time=0.39736 
Train Epoch: 29 [981/1000 31392/32000 (98%)] Loss: 0.36998 (QuantReg: 12.85313) QuantErr: 12.85313 batch_time=0.41620 
Train Epoch: 29 [986/1000 31552/32000 (99%)] Loss: 0.19969 (QuantReg: 12.85119) QuantErr: 12.85119 batch_time=0.41316 
Train Epoch: 29 [991/1000 31712/32000 (99%)] Loss: 0.14138 (QuantReg: 12.86378) QuantErr: 12.86378 batch_time=0.38028 
Train Epoch: 29 [996/1000 31872/32000 (100%)] Loss: 0.74293 (QuantReg: 12.46553) QuantErr: 12.46553 batch_time=0.36612 
Train Epoch: 29 codebook_update_time=1.91857
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch29.pth ...
Done in 4.549s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch29.pth ...
Done in 26.726s
removing stale ckpt [epoch 28] [took 0.02s]
 epoch          : 29
 loss           : 0.36188013507053257
 quant_reg      : 12.587209991455078
 quant_err      : 12.587209991455078
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 29000
 MSRVTT_full_val/t2v_metrics/R1: 28.772635814889338
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.776659959758551
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.49274324861797
 MSRVTT_full_val/v2t_metrics/R1: 35.61368209255533
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.131790744466801
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.52244822280657
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 36.220735785953174
 MSRVTT_full_test/t2v_metrics/R10: 50.735785953177256
 MSRVTT_full_test/t2v_metrics/R50: 81.73913043478261
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.421070234113714
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.028717447462
 MSRVTT_full_test/v2t_metrics/R1: 15.719063545150501
 MSRVTT_full_test/v2t_metrics/R5: 42.84280936454849
 MSRVTT_full_test/v2t_metrics/R10: 57.25752508361204
 MSRVTT_full_test/v2t_metrics/R50: 86.05351170568562
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.620066889632106
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.78410314516078
 mnt_best       : 29.028717447462
 not_improved_count: 0
Train Epoch: 30 [1/1000 32/32000 (0%)] Loss: 0.21948 (QuantReg: 12.84505) QuantErr: 12.84505 batch_time=30.10663 
Train Epoch: 30 [6/1000 192/32000 (1%)] Loss: 0.19414 (QuantReg: 12.09324) QuantErr: 12.09324 batch_time=0.36331 
Train Epoch: 30 [11/1000 352/32000 (1%)] Loss: 0.11212 (QuantReg: 12.82744) QuantErr: 12.82744 batch_time=0.35906 
Train Epoch: 30 [16/1000 512/32000 (2%)] Loss: 0.18520 (QuantReg: 12.66277) QuantErr: 12.66277 batch_time=0.34385 
Train Epoch: 30 [21/1000 672/32000 (2%)] Loss: 0.28294 (QuantReg: 13.27143) QuantErr: 13.27143 batch_time=0.34452 
Train Epoch: 30 [26/1000 832/32000 (3%)] Loss: 0.28008 (QuantReg: 12.79640) QuantErr: 12.79640 batch_time=0.34475 
Train Epoch: 30 [31/1000 992/32000 (3%)] Loss: 0.54699 (QuantReg: 12.01246) QuantErr: 12.01246 batch_time=0.40664 
Train Epoch: 30 [36/1000 1152/32000 (4%)] Loss: 0.22198 (QuantReg: 12.47213) QuantErr: 12.47213 batch_time=0.44095 
Train Epoch: 30 [41/1000 1312/32000 (4%)] Loss: 1.12517 (QuantReg: 12.15749) QuantErr: 12.15749 batch_time=0.38002 
Train Epoch: 30 [46/1000 1472/32000 (5%)] Loss: 0.42975 (QuantReg: 12.44171) QuantErr: 12.44171 batch_time=0.39921 
Train Epoch: 30 [51/1000 1632/32000 (5%)] Loss: 0.53097 (QuantReg: 12.39818) QuantErr: 12.39818 batch_time=0.40801 
Train Epoch: 30 [56/1000 1792/32000 (6%)] Loss: 0.14882 (QuantReg: 12.56063) QuantErr: 12.56063 batch_time=0.39894 
Train Epoch: 30 [61/1000 1952/32000 (6%)] Loss: 0.16908 (QuantReg: 12.82851) QuantErr: 12.82851 batch_time=0.37348 
Train Epoch: 30 [66/1000 2112/32000 (7%)] Loss: 0.31722 (QuantReg: 12.30087) QuantErr: 12.30087 batch_time=0.79703 
Train Epoch: 30 [71/1000 2272/32000 (7%)] Loss: 0.38350 (QuantReg: 12.12286) QuantErr: 12.12286 batch_time=0.39477 
Train Epoch: 30 [76/1000 2432/32000 (8%)] Loss: 0.57033 (QuantReg: 12.75794) QuantErr: 12.75794 batch_time=0.38369 
Train Epoch: 30 [81/1000 2592/32000 (8%)] Loss: 0.13984 (QuantReg: 12.61358) QuantErr: 12.61358 batch_time=0.39207 
Train Epoch: 30 [86/1000 2752/32000 (9%)] Loss: 0.16119 (QuantReg: 12.92117) QuantErr: 12.92117 batch_time=0.36600 
Train Epoch: 30 [91/1000 2912/32000 (9%)] Loss: 0.19276 (QuantReg: 12.93993) QuantErr: 12.93993 batch_time=0.36440 
Train Epoch: 30 [96/1000 3072/32000 (10%)] Loss: 0.18920 (QuantReg: 12.58583) QuantErr: 12.58583 batch_time=0.35959 
Train Epoch: 30 [101/1000 3232/32000 (10%)] Loss: 0.32165 (QuantReg: 11.36957) QuantErr: 11.36957 batch_time=0.35420 
Train Epoch: 30 [106/1000 3392/32000 (11%)] Loss: 0.29566 (QuantReg: 12.45145) QuantErr: 12.45145 batch_time=0.35429 
Train Epoch: 30 [111/1000 3552/32000 (11%)] Loss: 0.32911 (QuantReg: 12.50763) QuantErr: 12.50763 batch_time=0.34761 
Train Epoch: 30 [116/1000 3712/32000 (12%)] Loss: 0.26765 (QuantReg: 12.49884) QuantErr: 12.49884 batch_time=0.35396 
Train Epoch: 30 [121/1000 3872/32000 (12%)] Loss: 0.48854 (QuantReg: 11.97355) QuantErr: 11.97355 batch_time=0.40791 
Train Epoch: 30 [126/1000 4032/32000 (13%)] Loss: 0.40403 (QuantReg: 12.13487) QuantErr: 12.13487 batch_time=0.36990 
Train Epoch: 30 [131/1000 4192/32000 (13%)] Loss: 0.64368 (QuantReg: 12.31128) QuantErr: 12.31128 batch_time=0.34748 
Train Epoch: 30 [136/1000 4352/32000 (14%)] Loss: 0.62323 (QuantReg: 11.83242) QuantErr: 11.83242 batch_time=0.37484 
Train Epoch: 30 [141/1000 4512/32000 (14%)] Loss: 0.25636 (QuantReg: 12.78751) QuantErr: 12.78751 batch_time=0.35559 
Train Epoch: 30 [146/1000 4672/32000 (15%)] Loss: 0.54825 (QuantReg: 12.43445) QuantErr: 12.43445 batch_time=0.35752 
Train Epoch: 30 [151/1000 4832/32000 (15%)] Loss: 0.29961 (QuantReg: 12.67999) QuantErr: 12.67999 batch_time=0.36098 
Train Epoch: 30 [156/1000 4992/32000 (16%)] Loss: 0.44390 (QuantReg: 12.93285) QuantErr: 12.93285 batch_time=0.40029 
Train Epoch: 30 [161/1000 5152/32000 (16%)] Loss: 0.47457 (QuantReg: 11.43183) QuantErr: 11.43183 batch_time=0.45963 
Train Epoch: 30 [166/1000 5312/32000 (17%)] Loss: 0.20665 (QuantReg: 13.08522) QuantErr: 13.08522 batch_time=0.35560 
Train Epoch: 30 [171/1000 5472/32000 (17%)] Loss: 0.16168 (QuantReg: 12.72810) QuantErr: 12.72810 batch_time=0.37414 
Train Epoch: 30 [176/1000 5632/32000 (18%)] Loss: 0.57473 (QuantReg: 11.49127) QuantErr: 11.49127 batch_time=0.40028 
Train Epoch: 30 [181/1000 5792/32000 (18%)] Loss: 0.28468 (QuantReg: 12.52772) QuantErr: 12.52772 batch_time=0.36681 
Train Epoch: 30 [186/1000 5952/32000 (19%)] Loss: 0.30254 (QuantReg: 12.23246) QuantErr: 12.23246 batch_time=0.34948 
Train Epoch: 30 [191/1000 6112/32000 (19%)] Loss: 0.76698 (QuantReg: 12.09469) QuantErr: 12.09469 batch_time=0.42026 
Train Epoch: 30 [196/1000 6272/32000 (20%)] Loss: 0.48017 (QuantReg: 13.32899) QuantErr: 13.32899 batch_time=0.34249 
Train Epoch: 30 [201/1000 6432/32000 (20%)] Loss: 0.11930 (QuantReg: 13.07750) QuantErr: 13.07750 batch_time=0.34865 
Train Epoch: 30 [206/1000 6592/32000 (21%)] Loss: 0.35570 (QuantReg: 12.58275) QuantErr: 12.58275 batch_time=0.35740 
Train Epoch: 30 [211/1000 6752/32000 (21%)] Loss: 0.27224 (QuantReg: 12.83539) QuantErr: 12.83539 batch_time=0.36465 
Train Epoch: 30 [216/1000 6912/32000 (22%)] Loss: 0.72187 (QuantReg: 12.05301) QuantErr: 12.05301 batch_time=0.36602 
Train Epoch: 30 [221/1000 7072/32000 (22%)] Loss: 0.22733 (QuantReg: 12.91030) QuantErr: 12.91030 batch_time=0.36459 
Train Epoch: 30 [226/1000 7232/32000 (23%)] Loss: 0.24766 (QuantReg: 12.44739) QuantErr: 12.44739 batch_time=0.49753 
Train Epoch: 30 [231/1000 7392/32000 (23%)] Loss: 0.21422 (QuantReg: 13.03414) QuantErr: 13.03414 batch_time=0.36348 
Train Epoch: 30 [236/1000 7552/32000 (24%)] Loss: 0.37050 (QuantReg: 11.36517) QuantErr: 11.36517 batch_time=0.35115 
Train Epoch: 30 [241/1000 7712/32000 (24%)] Loss: 0.21019 (QuantReg: 12.80766) QuantErr: 12.80766 batch_time=0.37245 
Train Epoch: 30 [246/1000 7872/32000 (25%)] Loss: 0.28590 (QuantReg: 12.78872) QuantErr: 12.78872 batch_time=0.35974 
Train Epoch: 30 [251/1000 8032/32000 (25%)] Loss: 0.37985 (QuantReg: 13.11685) QuantErr: 13.11685 batch_time=0.39928 
Train Epoch: 30 [256/1000 8192/32000 (26%)] Loss: 0.25618 (QuantReg: 12.80331) QuantErr: 12.80331 batch_time=0.42236 
Train Epoch: 30 [261/1000 8352/32000 (26%)] Loss: 0.40288 (QuantReg: 12.22594) QuantErr: 12.22594 batch_time=1.58126 
Train Epoch: 30 [266/1000 8512/32000 (27%)] Loss: 0.31636 (QuantReg: 12.43975) QuantErr: 12.43975 batch_time=0.39466 
Train Epoch: 30 [271/1000 8672/32000 (27%)] Loss: 0.08765 (QuantReg: 12.52379) QuantErr: 12.52379 batch_time=0.35555 
Train Epoch: 30 [276/1000 8832/32000 (28%)] Loss: 0.27873 (QuantReg: 12.23406) QuantErr: 12.23406 batch_time=0.35198 
Train Epoch: 30 [281/1000 8992/32000 (28%)] Loss: 0.16506 (QuantReg: 12.74503) QuantErr: 12.74503 batch_time=0.35647 
Train Epoch: 30 [286/1000 9152/32000 (29%)] Loss: 0.18690 (QuantReg: 12.67385) QuantErr: 12.67385 batch_time=0.64270 
Train Epoch: 30 [291/1000 9312/32000 (29%)] Loss: 0.05805 (QuantReg: 12.92110) QuantErr: 12.92110 batch_time=0.37227 
Train Epoch: 30 [296/1000 9472/32000 (30%)] Loss: 0.51092 (QuantReg: 12.81962) QuantErr: 12.81962 batch_time=0.34664 
Train Epoch: 30 [301/1000 9632/32000 (30%)] Loss: 0.45670 (QuantReg: 12.77561) QuantErr: 12.77561 batch_time=0.34985 
Train Epoch: 30 [306/1000 9792/32000 (31%)] Loss: 0.39879 (QuantReg: 12.69113) QuantErr: 12.69113 batch_time=0.38763 
Train Epoch: 30 [311/1000 9952/32000 (31%)] Loss: 0.37368 (QuantReg: 13.12371) QuantErr: 13.12371 batch_time=0.34331 
Train Epoch: 30 [316/1000 10112/32000 (32%)] Loss: 0.32640 (QuantReg: 12.94850) QuantErr: 12.94850 batch_time=0.33735 
Train Epoch: 30 [321/1000 10272/32000 (32%)] Loss: 0.45596 (QuantReg: 12.40448) QuantErr: 12.40448 batch_time=0.33488 
Train Epoch: 30 [326/1000 10432/32000 (33%)] Loss: 0.30509 (QuantReg: 12.38200) QuantErr: 12.38200 batch_time=0.35837 
Train Epoch: 30 [331/1000 10592/32000 (33%)] Loss: 0.18306 (QuantReg: 12.67835) QuantErr: 12.67835 batch_time=0.33856 
Train Epoch: 30 [336/1000 10752/32000 (34%)] Loss: 0.22338 (QuantReg: 12.95758) QuantErr: 12.95758 batch_time=0.36633 
Train Epoch: 30 [341/1000 10912/32000 (34%)] Loss: 0.44178 (QuantReg: 12.61954) QuantErr: 12.61954 batch_time=0.37128 
Train Epoch: 30 [346/1000 11072/32000 (35%)] Loss: 0.19797 (QuantReg: 12.75415) QuantErr: 12.75415 batch_time=0.38261 
Train Epoch: 30 [351/1000 11232/32000 (35%)] Loss: 0.39573 (QuantReg: 12.70953) QuantErr: 12.70953 batch_time=0.39577 
Train Epoch: 30 [356/1000 11392/32000 (36%)] Loss: 0.64454 (QuantReg: 12.34391) QuantErr: 12.34391 batch_time=0.34318 
Train Epoch: 30 [361/1000 11552/32000 (36%)] Loss: 0.18727 (QuantReg: 12.61807) QuantErr: 12.61807 batch_time=0.34762 
Train Epoch: 30 [366/1000 11712/32000 (37%)] Loss: 0.61175 (QuantReg: 12.77865) QuantErr: 12.77865 batch_time=0.34709 
Train Epoch: 30 [371/1000 11872/32000 (37%)] Loss: 0.20591 (QuantReg: 12.28149) QuantErr: 12.28149 batch_time=0.35232 
Train Epoch: 30 [376/1000 12032/32000 (38%)] Loss: 0.25973 (QuantReg: 12.54380) QuantErr: 12.54380 batch_time=0.36639 
Train Epoch: 30 [381/1000 12192/32000 (38%)] Loss: 0.30076 (QuantReg: 12.25790) QuantErr: 12.25790 batch_time=0.35514 
Train Epoch: 30 [386/1000 12352/32000 (39%)] Loss: 0.37956 (QuantReg: 12.47091) QuantErr: 12.47091 batch_time=0.72146 
Train Epoch: 30 [391/1000 12512/32000 (39%)] Loss: 0.32588 (QuantReg: 12.14536) QuantErr: 12.14536 batch_time=0.35453 
Train Epoch: 30 [396/1000 12672/32000 (40%)] Loss: 0.35152 (QuantReg: 12.25661) QuantErr: 12.25661 batch_time=0.38691 
Train Epoch: 30 [401/1000 12832/32000 (40%)] Loss: 0.28226 (QuantReg: 12.59998) QuantErr: 12.59998 batch_time=0.35219 
Train Epoch: 30 [406/1000 12992/32000 (41%)] Loss: 0.66708 (QuantReg: 12.01719) QuantErr: 12.01719 batch_time=0.36385 
Train Epoch: 30 [411/1000 13152/32000 (41%)] Loss: 0.47910 (QuantReg: 11.71113) QuantErr: 11.71113 batch_time=0.35078 
Train Epoch: 30 [416/1000 13312/32000 (42%)] Loss: 0.44610 (QuantReg: 12.92792) QuantErr: 12.92792 batch_time=0.35035 
Train Epoch: 30 [421/1000 13472/32000 (42%)] Loss: 0.42005 (QuantReg: 12.31872) QuantErr: 12.31872 batch_time=0.35514 
Train Epoch: 30 [426/1000 13632/32000 (43%)] Loss: 0.49590 (QuantReg: 11.91027) QuantErr: 11.91027 batch_time=0.35283 
Train Epoch: 30 [431/1000 13792/32000 (43%)] Loss: 0.18871 (QuantReg: 12.69315) QuantErr: 12.69315 batch_time=0.37659 
Train Epoch: 30 [436/1000 13952/32000 (44%)] Loss: 0.24017 (QuantReg: 13.25015) QuantErr: 13.25015 batch_time=0.38203 
Train Epoch: 30 [441/1000 14112/32000 (44%)] Loss: 0.11361 (QuantReg: 12.61283) QuantErr: 12.61283 batch_time=0.36007 
Train Epoch: 30 [446/1000 14272/32000 (45%)] Loss: 0.27605 (QuantReg: 12.92207) QuantErr: 12.92207 batch_time=0.35697 
Train Epoch: 30 [451/1000 14432/32000 (45%)] Loss: 0.25929 (QuantReg: 11.86473) QuantErr: 11.86473 batch_time=0.46231 
Train Epoch: 30 [456/1000 14592/32000 (46%)] Loss: 0.43177 (QuantReg: 13.17624) QuantErr: 13.17624 batch_time=0.40301 
Train Epoch: 30 [461/1000 14752/32000 (46%)] Loss: 0.63666 (QuantReg: 12.10125) QuantErr: 12.10125 batch_time=0.42405 
Train Epoch: 30 [466/1000 14912/32000 (47%)] Loss: 0.32864 (QuantReg: 12.59494) QuantErr: 12.59494 batch_time=0.35967 
Train Epoch: 30 [471/1000 15072/32000 (47%)] Loss: 0.78057 (QuantReg: 12.59350) QuantErr: 12.59350 batch_time=0.38827 
Train Epoch: 30 [476/1000 15232/32000 (48%)] Loss: 0.11442 (QuantReg: 13.02139) QuantErr: 13.02139 batch_time=0.38895 
Train Epoch: 30 [481/1000 15392/32000 (48%)] Loss: 0.24452 (QuantReg: 12.82962) QuantErr: 12.82962 batch_time=0.39493 
Train Epoch: 30 [486/1000 15552/32000 (49%)] Loss: 0.16028 (QuantReg: 13.44639) QuantErr: 13.44639 batch_time=0.42559 
Train Epoch: 30 [491/1000 15712/32000 (49%)] Loss: 0.22469 (QuantReg: 12.15783) QuantErr: 12.15783 batch_time=0.36197 
Train Epoch: 30 [496/1000 15872/32000 (50%)] Loss: 0.18653 (QuantReg: 12.89082) QuantErr: 12.89082 batch_time=0.37784 
Train Epoch: 30 [501/1000 16032/32000 (50%)] Loss: 0.30695 (QuantReg: 12.75187) QuantErr: 12.75187 batch_time=0.35266 
Train Epoch: 30 [506/1000 16192/32000 (51%)] Loss: 0.15557 (QuantReg: 12.69655) QuantErr: 12.69655 batch_time=0.38089 
Train Epoch: 30 [511/1000 16352/32000 (51%)] Loss: 0.28297 (QuantReg: 12.40688) QuantErr: 12.40688 batch_time=0.43415 
Train Epoch: 30 [516/1000 16512/32000 (52%)] Loss: 0.29496 (QuantReg: 12.37708) QuantErr: 12.37708 batch_time=0.45519 
Train Epoch: 30 [521/1000 16672/32000 (52%)] Loss: 0.23742 (QuantReg: 12.91218) QuantErr: 12.91218 batch_time=0.37480 
Train Epoch: 30 [526/1000 16832/32000 (53%)] Loss: 0.34673 (QuantReg: 12.64630) QuantErr: 12.64630 batch_time=0.35409 
Train Epoch: 30 [531/1000 16992/32000 (53%)] Loss: 0.34432 (QuantReg: 12.43389) QuantErr: 12.43389 batch_time=0.35599 
Train Epoch: 30 [536/1000 17152/32000 (54%)] Loss: 0.20361 (QuantReg: 12.59291) QuantErr: 12.59291 batch_time=0.38050 
Train Epoch: 30 [541/1000 17312/32000 (54%)] Loss: 0.26510 (QuantReg: 12.95793) QuantErr: 12.95793 batch_time=0.38862 
Train Epoch: 30 [546/1000 17472/32000 (55%)] Loss: 0.21952 (QuantReg: 11.91918) QuantErr: 11.91918 batch_time=0.61506 
Train Epoch: 30 [551/1000 17632/32000 (55%)] Loss: 0.61845 (QuantReg: 12.31680) QuantErr: 12.31680 batch_time=0.36223 
Train Epoch: 30 [556/1000 17792/32000 (56%)] Loss: 0.15025 (QuantReg: 12.27837) QuantErr: 12.27837 batch_time=0.42531 
Train Epoch: 30 [561/1000 17952/32000 (56%)] Loss: 0.24138 (QuantReg: 12.26716) QuantErr: 12.26716 batch_time=0.43053 
Train Epoch: 30 [566/1000 18112/32000 (57%)] Loss: 0.19874 (QuantReg: 12.72331) QuantErr: 12.72331 batch_time=0.40597 
Train Epoch: 30 [571/1000 18272/32000 (57%)] Loss: 0.50395 (QuantReg: 12.96151) QuantErr: 12.96151 batch_time=0.42186 
Train Epoch: 30 [576/1000 18432/32000 (58%)] Loss: 0.26316 (QuantReg: 12.96862) QuantErr: 12.96862 batch_time=0.36664 
Train Epoch: 30 [581/1000 18592/32000 (58%)] Loss: 0.26189 (QuantReg: 12.65613) QuantErr: 12.65613 batch_time=1.77123 
Train Epoch: 30 [586/1000 18752/32000 (59%)] Loss: 0.17220 (QuantReg: 12.77461) QuantErr: 12.77461 batch_time=0.35252 
Train Epoch: 30 [591/1000 18912/32000 (59%)] Loss: 0.36431 (QuantReg: 13.54938) QuantErr: 13.54938 batch_time=0.36363 
Train Epoch: 30 [596/1000 19072/32000 (60%)] Loss: 0.51704 (QuantReg: 12.48660) QuantErr: 12.48660 batch_time=0.36990 
Train Epoch: 30 [601/1000 19232/32000 (60%)] Loss: 0.33550 (QuantReg: 12.54120) QuantErr: 12.54120 batch_time=0.34712 
Train Epoch: 30 [606/1000 19392/32000 (61%)] Loss: 0.35163 (QuantReg: 11.88662) QuantErr: 11.88662 batch_time=0.69017 
Train Epoch: 30 [611/1000 19552/32000 (61%)] Loss: 0.19448 (QuantReg: 12.41121) QuantErr: 12.41121 batch_time=0.36048 
Train Epoch: 30 [616/1000 19712/32000 (62%)] Loss: 0.38545 (QuantReg: 12.80902) QuantErr: 12.80902 batch_time=0.39583 
Train Epoch: 30 [621/1000 19872/32000 (62%)] Loss: 0.25765 (QuantReg: 12.50105) QuantErr: 12.50105 batch_time=0.47483 
Train Epoch: 30 [626/1000 20032/32000 (63%)] Loss: 0.29028 (QuantReg: 12.90475) QuantErr: 12.90475 batch_time=0.39712 
Train Epoch: 30 [631/1000 20192/32000 (63%)] Loss: 0.27778 (QuantReg: 13.45696) QuantErr: 13.45696 batch_time=0.39142 
Train Epoch: 30 [636/1000 20352/32000 (64%)] Loss: 0.39517 (QuantReg: 12.67301) QuantErr: 12.67301 batch_time=0.36590 
Train Epoch: 30 [641/1000 20512/32000 (64%)] Loss: 0.35931 (QuantReg: 12.77333) QuantErr: 12.77333 batch_time=0.35781 
Train Epoch: 30 [646/1000 20672/32000 (65%)] Loss: 0.42656 (QuantReg: 12.82728) QuantErr: 12.82728 batch_time=0.35107 
Train Epoch: 30 [651/1000 20832/32000 (65%)] Loss: 0.29736 (QuantReg: 12.64891) QuantErr: 12.64891 batch_time=0.35560 
Train Epoch: 30 [656/1000 20992/32000 (66%)] Loss: 0.36941 (QuantReg: 12.51926) QuantErr: 12.51926 batch_time=0.35384 
Train Epoch: 30 [661/1000 21152/32000 (66%)] Loss: 0.36750 (QuantReg: 13.08492) QuantErr: 13.08492 batch_time=0.35079 
Train Epoch: 30 [666/1000 21312/32000 (67%)] Loss: 0.51385 (QuantReg: 12.22392) QuantErr: 12.22392 batch_time=0.37231 
Train Epoch: 30 [671/1000 21472/32000 (67%)] Loss: 0.31162 (QuantReg: 12.61618) QuantErr: 12.61618 batch_time=0.36125 
Train Epoch: 30 [676/1000 21632/32000 (68%)] Loss: 0.38134 (QuantReg: 13.07747) QuantErr: 13.07747 batch_time=0.40393 
Train Epoch: 30 [681/1000 21792/32000 (68%)] Loss: 0.11264 (QuantReg: 12.76408) QuantErr: 12.76408 batch_time=0.42398 
Train Epoch: 30 [686/1000 21952/32000 (69%)] Loss: 0.60697 (QuantReg: 11.83194) QuantErr: 11.83194 batch_time=0.38118 
Train Epoch: 30 [691/1000 22112/32000 (69%)] Loss: 0.29113 (QuantReg: 13.21102) QuantErr: 13.21102 batch_time=0.43082 
Train Epoch: 30 [696/1000 22272/32000 (70%)] Loss: 0.28395 (QuantReg: 12.44951) QuantErr: 12.44951 batch_time=0.39283 
Train Epoch: 30 [701/1000 22432/32000 (70%)] Loss: 0.32766 (QuantReg: 13.14944) QuantErr: 13.14944 batch_time=0.46165 
Train Epoch: 30 [706/1000 22592/32000 (71%)] Loss: 0.29467 (QuantReg: 12.63507) QuantErr: 12.63507 batch_time=0.76089 
Train Epoch: 30 [711/1000 22752/32000 (71%)] Loss: 0.56433 (QuantReg: 12.58370) QuantErr: 12.58370 batch_time=0.46913 
Train Epoch: 30 [716/1000 22912/32000 (72%)] Loss: 0.30403 (QuantReg: 12.93956) QuantErr: 12.93956 batch_time=0.37346 
Train Epoch: 30 [721/1000 23072/32000 (72%)] Loss: 0.41805 (QuantReg: 12.34398) QuantErr: 12.34398 batch_time=0.35701 
Train Epoch: 30 [726/1000 23232/32000 (73%)] Loss: 0.22884 (QuantReg: 12.38536) QuantErr: 12.38536 batch_time=0.35536 
Train Epoch: 30 [731/1000 23392/32000 (73%)] Loss: 0.66448 (QuantReg: 12.66882) QuantErr: 12.66882 batch_time=0.36986 
Train Epoch: 30 [736/1000 23552/32000 (74%)] Loss: 0.37725 (QuantReg: 12.81246) QuantErr: 12.81246 batch_time=0.37215 
Train Epoch: 30 [741/1000 23712/32000 (74%)] Loss: 0.60554 (QuantReg: 12.93720) QuantErr: 12.93720 batch_time=0.35881 
Train Epoch: 30 [746/1000 23872/32000 (75%)] Loss: 0.25383 (QuantReg: 13.27967) QuantErr: 13.27967 batch_time=0.46384 
Train Epoch: 30 [751/1000 24032/32000 (75%)] Loss: 0.22270 (QuantReg: 12.36003) QuantErr: 12.36003 batch_time=0.42326 
Train Epoch: 30 [756/1000 24192/32000 (76%)] Loss: 0.53918 (QuantReg: 12.39077) QuantErr: 12.39077 batch_time=0.40762 
Train Epoch: 30 [761/1000 24352/32000 (76%)] Loss: 0.19522 (QuantReg: 13.03825) QuantErr: 13.03825 batch_time=0.38973 
Train Epoch: 30 [766/1000 24512/32000 (77%)] Loss: 0.10856 (QuantReg: 13.23127) QuantErr: 13.23127 batch_time=0.36104 
Train Epoch: 30 [771/1000 24672/32000 (77%)] Loss: 0.32582 (QuantReg: 11.95580) QuantErr: 11.95580 batch_time=0.34721 
Train Epoch: 30 [776/1000 24832/32000 (78%)] Loss: 0.51929 (QuantReg: 13.04040) QuantErr: 13.04040 batch_time=0.36932 
Train Epoch: 30 [781/1000 24992/32000 (78%)] Loss: 0.38422 (QuantReg: 12.57029) QuantErr: 12.57029 batch_time=0.35967 
Train Epoch: 30 [786/1000 25152/32000 (79%)] Loss: 0.18459 (QuantReg: 12.83862) QuantErr: 12.83862 batch_time=0.36596 
Train Epoch: 30 [791/1000 25312/32000 (79%)] Loss: 0.29814 (QuantReg: 13.27179) QuantErr: 13.27179 batch_time=0.35987 
Train Epoch: 30 [796/1000 25472/32000 (80%)] Loss: 0.35746 (QuantReg: 12.77415) QuantErr: 12.77415 batch_time=0.40043 
Train Epoch: 30 [801/1000 25632/32000 (80%)] Loss: 0.08736 (QuantReg: 13.05280) QuantErr: 13.05280 batch_time=0.35196 
Train Epoch: 30 [806/1000 25792/32000 (81%)] Loss: 0.71333 (QuantReg: 12.21904) QuantErr: 12.21904 batch_time=0.36364 
Train Epoch: 30 [811/1000 25952/32000 (81%)] Loss: 0.25255 (QuantReg: 12.89608) QuantErr: 12.89608 batch_time=0.36068 
Train Epoch: 30 [816/1000 26112/32000 (82%)] Loss: 0.53543 (QuantReg: 12.96322) QuantErr: 12.96322 batch_time=0.35112 
Train Epoch: 30 [821/1000 26272/32000 (82%)] Loss: 0.61296 (QuantReg: 12.15249) QuantErr: 12.15249 batch_time=0.37202 
Train Epoch: 30 [826/1000 26432/32000 (83%)] Loss: 0.25398 (QuantReg: 12.59195) QuantErr: 12.59195 batch_time=0.35660 
Train Epoch: 30 [831/1000 26592/32000 (83%)] Loss: 0.30568 (QuantReg: 12.34109) QuantErr: 12.34109 batch_time=0.41359 
Train Epoch: 30 [836/1000 26752/32000 (84%)] Loss: 0.09500 (QuantReg: 12.57224) QuantErr: 12.57224 batch_time=0.35205 
Train Epoch: 30 [841/1000 26912/32000 (84%)] Loss: 0.20627 (QuantReg: 13.28601) QuantErr: 13.28601 batch_time=0.42693 
Train Epoch: 30 [846/1000 27072/32000 (85%)] Loss: 0.31060 (QuantReg: 12.84766) QuantErr: 12.84766 batch_time=0.41873 
Train Epoch: 30 [851/1000 27232/32000 (85%)] Loss: 0.35453 (QuantReg: 13.03533) QuantErr: 13.03533 batch_time=0.35843 
Train Epoch: 30 [856/1000 27392/32000 (86%)] Loss: 0.36469 (QuantReg: 12.38876) QuantErr: 12.38876 batch_time=0.41304 
Train Epoch: 30 [861/1000 27552/32000 (86%)] Loss: 0.30842 (QuantReg: 13.04809) QuantErr: 13.04809 batch_time=0.35117 
Train Epoch: 30 [866/1000 27712/32000 (87%)] Loss: 0.40693 (QuantReg: 13.06798) QuantErr: 13.06798 batch_time=0.50961 
Train Epoch: 30 [871/1000 27872/32000 (87%)] Loss: 0.29990 (QuantReg: 12.54485) QuantErr: 12.54485 batch_time=0.36931 
Train Epoch: 30 [876/1000 28032/32000 (88%)] Loss: 0.31912 (QuantReg: 12.23237) QuantErr: 12.23237 batch_time=0.35008 
Train Epoch: 30 [881/1000 28192/32000 (88%)] Loss: 0.38791 (QuantReg: 12.81279) QuantErr: 12.81279 batch_time=0.34826 
Train Epoch: 30 [886/1000 28352/32000 (89%)] Loss: 0.51390 (QuantReg: 12.62052) QuantErr: 12.62052 batch_time=0.38713 
Train Epoch: 30 [891/1000 28512/32000 (89%)] Loss: 0.21385 (QuantReg: 12.24022) QuantErr: 12.24022 batch_time=0.34923 
Train Epoch: 30 [896/1000 28672/32000 (90%)] Loss: 0.14480 (QuantReg: 13.11907) QuantErr: 13.11907 batch_time=0.35398 
Train Epoch: 30 [901/1000 28832/32000 (90%)] Loss: 0.44678 (QuantReg: 12.55999) QuantErr: 12.55999 batch_time=1.63317 
Train Epoch: 30 [906/1000 28992/32000 (91%)] Loss: 0.59742 (QuantReg: 12.72927) QuantErr: 12.72927 batch_time=0.35821 
Train Epoch: 30 [911/1000 29152/32000 (91%)] Loss: 0.41682 (QuantReg: 12.49331) QuantErr: 12.49331 batch_time=0.37211 
Train Epoch: 30 [916/1000 29312/32000 (92%)] Loss: 0.29070 (QuantReg: 13.00022) QuantErr: 13.00022 batch_time=0.40335 
Train Epoch: 30 [921/1000 29472/32000 (92%)] Loss: 0.35226 (QuantReg: 12.53197) QuantErr: 12.53197 batch_time=0.37527 
Train Epoch: 30 [926/1000 29632/32000 (93%)] Loss: 0.12961 (QuantReg: 12.97143) QuantErr: 12.97143 batch_time=0.65011 
Train Epoch: 30 [931/1000 29792/32000 (93%)] Loss: 0.43997 (QuantReg: 12.43951) QuantErr: 12.43951 batch_time=0.35991 
Train Epoch: 30 [936/1000 29952/32000 (94%)] Loss: 0.31786 (QuantReg: 13.42652) QuantErr: 13.42652 batch_time=0.35666 
Train Epoch: 30 [941/1000 30112/32000 (94%)] Loss: 0.31622 (QuantReg: 12.58332) QuantErr: 12.58332 batch_time=0.35031 
Train Epoch: 30 [946/1000 30272/32000 (95%)] Loss: 0.36081 (QuantReg: 12.13404) QuantErr: 12.13404 batch_time=0.36492 
Train Epoch: 30 [951/1000 30432/32000 (95%)] Loss: 0.31495 (QuantReg: 12.94514) QuantErr: 12.94514 batch_time=0.38534 
Train Epoch: 30 [956/1000 30592/32000 (96%)] Loss: 0.23139 (QuantReg: 12.73690) QuantErr: 12.73690 batch_time=0.39207 
Train Epoch: 30 [961/1000 30752/32000 (96%)] Loss: 0.24048 (QuantReg: 12.68761) QuantErr: 12.68761 batch_time=0.46371 
Train Epoch: 30 [966/1000 30912/32000 (97%)] Loss: 0.19172 (QuantReg: 12.55555) QuantErr: 12.55555 batch_time=0.44001 
Train Epoch: 30 [971/1000 31072/32000 (97%)] Loss: 0.21221 (QuantReg: 12.73050) QuantErr: 12.73050 batch_time=0.36473 
Train Epoch: 30 [976/1000 31232/32000 (98%)] Loss: 0.35431 (QuantReg: 12.50888) QuantErr: 12.50888 batch_time=0.38306 
Train Epoch: 30 [981/1000 31392/32000 (98%)] Loss: 0.60838 (QuantReg: 12.02771) QuantErr: 12.02771 batch_time=0.36775 
Train Epoch: 30 [986/1000 31552/32000 (99%)] Loss: 0.26143 (QuantReg: 12.98934) QuantErr: 12.98934 batch_time=0.46803 
Train Epoch: 30 [991/1000 31712/32000 (99%)] Loss: 0.39291 (QuantReg: 13.14558) QuantErr: 13.14558 batch_time=0.44349 
Train Epoch: 30 [996/1000 31872/32000 (100%)] Loss: 0.24368 (QuantReg: 12.82703) QuantErr: 12.82703 batch_time=0.41923 
Train Epoch: 30 codebook_update_time=1.86031
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch30.pth ...
Done in 6.978s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 0.34036397324874995
 quant_reg      : 12.636351329803468
 quant_err      : 12.636351329803468
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 30000
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.5674044265593565
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.66562956231348
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.229376257545272
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.066007580169334
 MSRVTT_full_test/t2v_metrics/R1: 12.608695652173912
 MSRVTT_full_test/t2v_metrics/R5: 37.324414715719065
 MSRVTT_full_test/t2v_metrics/R10: 50.36789297658863
 MSRVTT_full_test/t2v_metrics/R50: 82.37458193979933
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.854180602006686
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.725812223829443
 MSRVTT_full_test/v2t_metrics/R1: 15.418060200668897
 MSRVTT_full_test/v2t_metrics/R5: 42.77591973244147
 MSRVTT_full_test/v2t_metrics/R10: 57.558528428093645
 MSRVTT_full_test/v2t_metrics/R50: 86.22073578595318
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.04080267558528
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.60827780482984
 mnt_best       : 29.028717447462
 not_improved_count: 1
Train Epoch: 31 [1/1000 32/32000 (0%)] Loss: 0.14900 (QuantReg: 12.86346) QuantErr: 12.86346 batch_time=31.78928 
Train Epoch: 31 [6/1000 192/32000 (1%)] Loss: 0.53593 (QuantReg: 12.07011) QuantErr: 12.07011 batch_time=0.35854 
Train Epoch: 31 [11/1000 352/32000 (1%)] Loss: 0.62397 (QuantReg: 12.00519) QuantErr: 12.00519 batch_time=0.43495 
Train Epoch: 31 [16/1000 512/32000 (2%)] Loss: 0.22451 (QuantReg: 12.45620) QuantErr: 12.45620 batch_time=0.93587 
Train Epoch: 31 [21/1000 672/32000 (2%)] Loss: 0.28527 (QuantReg: 12.30346) QuantErr: 12.30346 batch_time=0.35859 
Train Epoch: 31 [26/1000 832/32000 (3%)] Loss: 0.70711 (QuantReg: 11.68979) QuantErr: 11.68979 batch_time=0.35452 
Train Epoch: 31 [31/1000 992/32000 (3%)] Loss: 0.72284 (QuantReg: 12.61402) QuantErr: 12.61402 batch_time=0.35462 
Train Epoch: 31 [36/1000 1152/32000 (4%)] Loss: 0.17106 (QuantReg: 12.50145) QuantErr: 12.50145 batch_time=0.35835 
Train Epoch: 31 [41/1000 1312/32000 (4%)] Loss: 0.08945 (QuantReg: 12.20380) QuantErr: 12.20380 batch_time=0.35670 
Train Epoch: 31 [46/1000 1472/32000 (5%)] Loss: 0.24433 (QuantReg: 12.92155) QuantErr: 12.92155 batch_time=0.35223 
Train Epoch: 31 [51/1000 1632/32000 (5%)] Loss: 0.32613 (QuantReg: 12.20541) QuantErr: 12.20541 batch_time=0.34181 
Train Epoch: 31 [56/1000 1792/32000 (6%)] Loss: 0.29137 (QuantReg: 11.71749) QuantErr: 11.71749 batch_time=0.35574 
Train Epoch: 31 [61/1000 1952/32000 (6%)] Loss: 0.40154 (QuantReg: 12.48773) QuantErr: 12.48773 batch_time=0.38601 
Train Epoch: 31 [66/1000 2112/32000 (7%)] Loss: 0.15810 (QuantReg: 12.50262) QuantErr: 12.50262 batch_time=0.77955 
Train Epoch: 31 [71/1000 2272/32000 (7%)] Loss: 0.30120 (QuantReg: 13.28204) QuantErr: 13.28204 batch_time=0.41016 
Train Epoch: 31 [76/1000 2432/32000 (8%)] Loss: 0.43108 (QuantReg: 12.46449) QuantErr: 12.46449 batch_time=0.38708 
Train Epoch: 31 [81/1000 2592/32000 (8%)] Loss: 0.11118 (QuantReg: 12.65851) QuantErr: 12.65851 batch_time=1.00767 
Train Epoch: 31 [86/1000 2752/32000 (9%)] Loss: 0.27027 (QuantReg: 12.92985) QuantErr: 12.92985 batch_time=0.37689 
Train Epoch: 31 [91/1000 2912/32000 (9%)] Loss: 0.27741 (QuantReg: 12.65347) QuantErr: 12.65347 batch_time=0.36661 
Train Epoch: 31 [96/1000 3072/32000 (10%)] Loss: 0.31848 (QuantReg: 12.81282) QuantErr: 12.81282 batch_time=0.36696 
Train Epoch: 31 [101/1000 3232/32000 (10%)] Loss: 0.45195 (QuantReg: 12.52060) QuantErr: 12.52060 batch_time=0.35830 
Train Epoch: 31 [106/1000 3392/32000 (11%)] Loss: 0.14764 (QuantReg: 12.22013) QuantErr: 12.22013 batch_time=0.35288 
Train Epoch: 31 [111/1000 3552/32000 (11%)] Loss: 0.45250 (QuantReg: 12.76368) QuantErr: 12.76368 batch_time=0.37022 
Train Epoch: 31 [116/1000 3712/32000 (12%)] Loss: 0.25844 (QuantReg: 12.57233) QuantErr: 12.57233 batch_time=0.35227 
Train Epoch: 31 [121/1000 3872/32000 (12%)] Loss: 0.28682 (QuantReg: 12.06822) QuantErr: 12.06822 batch_time=0.35420 
Train Epoch: 31 [126/1000 4032/32000 (13%)] Loss: 0.20002 (QuantReg: 13.35118) QuantErr: 13.35118 batch_time=0.35641 
Train Epoch: 31 [131/1000 4192/32000 (13%)] Loss: 0.07009 (QuantReg: 12.94589) QuantErr: 12.94589 batch_time=0.35738 
Train Epoch: 31 [136/1000 4352/32000 (14%)] Loss: 0.62429 (QuantReg: 12.74394) QuantErr: 12.74394 batch_time=0.35333 
Train Epoch: 31 [141/1000 4512/32000 (14%)] Loss: 0.09406 (QuantReg: 13.22553) QuantErr: 13.22553 batch_time=0.41669 
Train Epoch: 31 [146/1000 4672/32000 (15%)] Loss: 0.11147 (QuantReg: 13.09887) QuantErr: 13.09887 batch_time=0.59142 
Train Epoch: 31 [151/1000 4832/32000 (15%)] Loss: 0.38870 (QuantReg: 12.57382) QuantErr: 12.57382 batch_time=0.35438 
Train Epoch: 31 [156/1000 4992/32000 (16%)] Loss: 0.44185 (QuantReg: 12.21925) QuantErr: 12.21925 batch_time=0.46168 
Train Epoch: 31 [161/1000 5152/32000 (16%)] Loss: 0.19177 (QuantReg: 13.01874) QuantErr: 13.01874 batch_time=0.36257 
Train Epoch: 31 [166/1000 5312/32000 (17%)] Loss: 0.12001 (QuantReg: 12.10796) QuantErr: 12.10796 batch_time=0.37051 
Train Epoch: 31 [171/1000 5472/32000 (17%)] Loss: 0.56868 (QuantReg: 12.57944) QuantErr: 12.57944 batch_time=0.38239 
Train Epoch: 31 [176/1000 5632/32000 (18%)] Loss: 0.28412 (QuantReg: 12.48857) QuantErr: 12.48857 batch_time=0.36203 
Train Epoch: 31 [181/1000 5792/32000 (18%)] Loss: 0.45932 (QuantReg: 12.37311) QuantErr: 12.37311 batch_time=0.38181 
Train Epoch: 31 [186/1000 5952/32000 (19%)] Loss: 0.22033 (QuantReg: 12.92974) QuantErr: 12.92974 batch_time=0.34642 
Train Epoch: 31 [191/1000 6112/32000 (19%)] Loss: 0.29345 (QuantReg: 12.25244) QuantErr: 12.25244 batch_time=0.41527 
Train Epoch: 31 [196/1000 6272/32000 (20%)] Loss: 0.27246 (QuantReg: 13.00713) QuantErr: 13.00713 batch_time=0.39840 
Train Epoch: 31 [201/1000 6432/32000 (20%)] Loss: 0.43472 (QuantReg: 12.81716) QuantErr: 12.81716 batch_time=0.36790 
Train Epoch: 31 [206/1000 6592/32000 (21%)] Loss: 0.14604 (QuantReg: 12.32533) QuantErr: 12.32533 batch_time=0.34981 
Train Epoch: 31 [211/1000 6752/32000 (21%)] Loss: 0.35339 (QuantReg: 12.65137) QuantErr: 12.65137 batch_time=0.34715 
Train Epoch: 31 [216/1000 6912/32000 (22%)] Loss: 0.54388 (QuantReg: 13.15364) QuantErr: 13.15364 batch_time=0.35300 
Train Epoch: 31 [221/1000 7072/32000 (22%)] Loss: 0.70670 (QuantReg: 11.69122) QuantErr: 11.69122 batch_time=0.35305 
Train Epoch: 31 [226/1000 7232/32000 (23%)] Loss: 0.64259 (QuantReg: 12.44757) QuantErr: 12.44757 batch_time=0.35746 
Train Epoch: 31 [231/1000 7392/32000 (23%)] Loss: 0.40207 (QuantReg: 12.09017) QuantErr: 12.09017 batch_time=0.35310 
Train Epoch: 31 [236/1000 7552/32000 (24%)] Loss: 0.35259 (QuantReg: 12.30239) QuantErr: 12.30239 batch_time=0.35517 
Train Epoch: 31 [241/1000 7712/32000 (24%)] Loss: 0.35062 (QuantReg: 12.25706) QuantErr: 12.25706 batch_time=0.35653 
Train Epoch: 31 [246/1000 7872/32000 (25%)] Loss: 0.37239 (QuantReg: 13.23839) QuantErr: 13.23839 batch_time=0.35157 
Train Epoch: 31 [251/1000 8032/32000 (25%)] Loss: 0.29337 (QuantReg: 11.81105) QuantErr: 11.81105 batch_time=0.35003 
Train Epoch: 31 [256/1000 8192/32000 (26%)] Loss: 0.99820 (QuantReg: 12.13517) QuantErr: 12.13517 batch_time=0.44276 
Train Epoch: 31 [261/1000 8352/32000 (26%)] Loss: 0.13887 (QuantReg: 12.71440) QuantErr: 12.71440 batch_time=0.41632 
Train Epoch: 31 [266/1000 8512/32000 (27%)] Loss: 0.61311 (QuantReg: 12.37921) QuantErr: 12.37921 batch_time=0.40211 
Train Epoch: 31 [271/1000 8672/32000 (27%)] Loss: 0.51766 (QuantReg: 12.87707) QuantErr: 12.87707 batch_time=0.36929 
Train Epoch: 31 [276/1000 8832/32000 (28%)] Loss: 0.36274 (QuantReg: 12.21245) QuantErr: 12.21245 batch_time=0.35116 
Train Epoch: 31 [281/1000 8992/32000 (28%)] Loss: 0.29231 (QuantReg: 12.92537) QuantErr: 12.92537 batch_time=0.35129 
Train Epoch: 31 [286/1000 9152/32000 (29%)] Loss: 0.16222 (QuantReg: 12.57878) QuantErr: 12.57878 batch_time=0.35725 
Train Epoch: 31 [291/1000 9312/32000 (29%)] Loss: 0.24268 (QuantReg: 12.52321) QuantErr: 12.52321 batch_time=0.35689 
Train Epoch: 31 [296/1000 9472/32000 (30%)] Loss: 0.25854 (QuantReg: 12.49409) QuantErr: 12.49409 batch_time=0.34815 
Train Epoch: 31 [301/1000 9632/32000 (30%)] Loss: 0.19695 (QuantReg: 12.79054) QuantErr: 12.79054 batch_time=0.34347 
Train Epoch: 31 [306/1000 9792/32000 (31%)] Loss: 0.41870 (QuantReg: 12.11986) QuantErr: 12.11986 batch_time=0.35038 
Train Epoch: 31 [311/1000 9952/32000 (31%)] Loss: 0.17642 (QuantReg: 13.03656) QuantErr: 13.03656 batch_time=0.37905 
Train Epoch: 31 [316/1000 10112/32000 (32%)] Loss: 0.53256 (QuantReg: 12.34077) QuantErr: 12.34077 batch_time=0.36946 
Train Epoch: 31 [321/1000 10272/32000 (32%)] Loss: 0.49625 (QuantReg: 13.30388) QuantErr: 13.30388 batch_time=0.35334 
Train Epoch: 31 [326/1000 10432/32000 (33%)] Loss: 0.46327 (QuantReg: 13.05459) QuantErr: 13.05459 batch_time=0.38846 
Train Epoch: 31 [331/1000 10592/32000 (33%)] Loss: 0.49186 (QuantReg: 12.15501) QuantErr: 12.15501 batch_time=0.35677 
Train Epoch: 31 [336/1000 10752/32000 (34%)] Loss: 0.21275 (QuantReg: 13.24743) QuantErr: 13.24743 batch_time=0.80227 
Train Epoch: 31 [341/1000 10912/32000 (34%)] Loss: 0.36001 (QuantReg: 12.70137) QuantErr: 12.70137 batch_time=0.35656 
Train Epoch: 31 [346/1000 11072/32000 (35%)] Loss: 0.31769 (QuantReg: 12.47378) QuantErr: 12.47378 batch_time=0.34769 
Train Epoch: 31 [351/1000 11232/32000 (35%)] Loss: 0.24649 (QuantReg: 13.09512) QuantErr: 13.09512 batch_time=0.34324 
Train Epoch: 31 [356/1000 11392/32000 (36%)] Loss: 0.29153 (QuantReg: 12.48345) QuantErr: 12.48345 batch_time=0.34614 
Train Epoch: 31 [361/1000 11552/32000 (36%)] Loss: 0.39938 (QuantReg: 13.18057) QuantErr: 13.18057 batch_time=0.34650 
Train Epoch: 31 [366/1000 11712/32000 (37%)] Loss: 0.66145 (QuantReg: 11.54323) QuantErr: 11.54323 batch_time=0.38894 
Train Epoch: 31 [371/1000 11872/32000 (37%)] Loss: 0.25880 (QuantReg: 13.40270) QuantErr: 13.40270 batch_time=0.36449 
Train Epoch: 31 [376/1000 12032/32000 (38%)] Loss: 0.13567 (QuantReg: 12.55994) QuantErr: 12.55994 batch_time=0.37502 
Train Epoch: 31 [381/1000 12192/32000 (38%)] Loss: 0.82442 (QuantReg: 12.29018) QuantErr: 12.29018 batch_time=0.38474 
Train Epoch: 31 [386/1000 12352/32000 (39%)] Loss: 0.31311 (QuantReg: 12.41424) QuantErr: 12.41424 batch_time=0.72862 
Train Epoch: 31 [391/1000 12512/32000 (39%)] Loss: 0.42480 (QuantReg: 12.75795) QuantErr: 12.75795 batch_time=0.35347 
Train Epoch: 31 [396/1000 12672/32000 (40%)] Loss: 0.91976 (QuantReg: 12.47983) QuantErr: 12.47983 batch_time=0.35033 
Train Epoch: 31 [401/1000 12832/32000 (40%)] Loss: 0.16933 (QuantReg: 13.03973) QuantErr: 13.03973 batch_time=0.96970 
Train Epoch: 31 [406/1000 12992/32000 (41%)] Loss: 0.37914 (QuantReg: 12.97759) QuantErr: 12.97759 batch_time=0.35878 
Train Epoch: 31 [411/1000 13152/32000 (41%)] Loss: 0.23109 (QuantReg: 12.66312) QuantErr: 12.66312 batch_time=0.35610 
Train Epoch: 31 [416/1000 13312/32000 (42%)] Loss: 0.16534 (QuantReg: 12.83761) QuantErr: 12.83761 batch_time=0.35673 
Train Epoch: 31 [421/1000 13472/32000 (42%)] Loss: 0.50493 (QuantReg: 12.64024) QuantErr: 12.64024 batch_time=0.35410 
Train Epoch: 31 [426/1000 13632/32000 (43%)] Loss: 0.27686 (QuantReg: 13.27342) QuantErr: 13.27342 batch_time=0.35520 
Train Epoch: 31 [431/1000 13792/32000 (43%)] Loss: 0.28389 (QuantReg: 12.14128) QuantErr: 12.14128 batch_time=0.35372 
Train Epoch: 31 [436/1000 13952/32000 (44%)] Loss: 0.29123 (QuantReg: 12.83350) QuantErr: 12.83350 batch_time=0.35758 
Train Epoch: 31 [441/1000 14112/32000 (44%)] Loss: 0.51955 (QuantReg: 12.73432) QuantErr: 12.73432 batch_time=0.35960 
Train Epoch: 31 [446/1000 14272/32000 (45%)] Loss: 0.18435 (QuantReg: 12.65233) QuantErr: 12.65233 batch_time=0.36836 
Train Epoch: 31 [451/1000 14432/32000 (45%)] Loss: 0.23739 (QuantReg: 12.76281) QuantErr: 12.76281 batch_time=0.35535 
Train Epoch: 31 [456/1000 14592/32000 (46%)] Loss: 0.14655 (QuantReg: 12.81710) QuantErr: 12.81710 batch_time=0.38304 
Train Epoch: 31 [461/1000 14752/32000 (46%)] Loss: 0.41703 (QuantReg: 12.72289) QuantErr: 12.72289 batch_time=0.35248 
Train Epoch: 31 [466/1000 14912/32000 (47%)] Loss: 0.49193 (QuantReg: 12.51751) QuantErr: 12.51751 batch_time=0.58492 
Train Epoch: 31 [471/1000 15072/32000 (47%)] Loss: 0.25575 (QuantReg: 12.55186) QuantErr: 12.55186 batch_time=0.35180 
Train Epoch: 31 [476/1000 15232/32000 (48%)] Loss: 0.22073 (QuantReg: 12.99867) QuantErr: 12.99867 batch_time=0.44279 
Train Epoch: 31 [481/1000 15392/32000 (48%)] Loss: 0.25395 (QuantReg: 12.47024) QuantErr: 12.47024 batch_time=0.35847 
Train Epoch: 31 [486/1000 15552/32000 (49%)] Loss: 0.26432 (QuantReg: 12.93773) QuantErr: 12.93773 batch_time=0.35453 
Train Epoch: 31 [491/1000 15712/32000 (49%)] Loss: 0.35793 (QuantReg: 12.62513) QuantErr: 12.62513 batch_time=0.35297 
Train Epoch: 31 [496/1000 15872/32000 (50%)] Loss: 0.32357 (QuantReg: 13.20030) QuantErr: 13.20030 batch_time=0.34951 
Train Epoch: 31 [501/1000 16032/32000 (50%)] Loss: 0.26444 (QuantReg: 12.38174) QuantErr: 12.38174 batch_time=0.37499 
Train Epoch: 31 [506/1000 16192/32000 (51%)] Loss: 0.11230 (QuantReg: 12.58851) QuantErr: 12.58851 batch_time=0.34464 
Train Epoch: 31 [511/1000 16352/32000 (51%)] Loss: 0.26713 (QuantReg: 12.59140) QuantErr: 12.59140 batch_time=0.37517 
Train Epoch: 31 [516/1000 16512/32000 (52%)] Loss: 0.31875 (QuantReg: 12.27102) QuantErr: 12.27102 batch_time=0.40209 
Train Epoch: 31 [521/1000 16672/32000 (52%)] Loss: 0.34722 (QuantReg: 12.09795) QuantErr: 12.09795 batch_time=0.34198 
Train Epoch: 31 [526/1000 16832/32000 (53%)] Loss: 0.32574 (QuantReg: 13.06081) QuantErr: 13.06081 batch_time=0.36339 
Train Epoch: 31 [531/1000 16992/32000 (53%)] Loss: 0.22609 (QuantReg: 12.84758) QuantErr: 12.84758 batch_time=0.35602 
Train Epoch: 31 [536/1000 17152/32000 (54%)] Loss: 0.24372 (QuantReg: 12.45720) QuantErr: 12.45720 batch_time=0.43130 
Train Epoch: 31 [541/1000 17312/32000 (54%)] Loss: 0.18062 (QuantReg: 13.06664) QuantErr: 13.06664 batch_time=0.39252 
Train Epoch: 31 [546/1000 17472/32000 (55%)] Loss: 0.20553 (QuantReg: 12.47358) QuantErr: 12.47358 batch_time=0.36788 
Train Epoch: 31 [551/1000 17632/32000 (55%)] Loss: 0.69449 (QuantReg: 12.78148) QuantErr: 12.78148 batch_time=0.36000 
Train Epoch: 31 [556/1000 17792/32000 (56%)] Loss: 0.47473 (QuantReg: 12.82122) QuantErr: 12.82122 batch_time=0.36543 
Train Epoch: 31 [561/1000 17952/32000 (56%)] Loss: 0.48439 (QuantReg: 12.03598) QuantErr: 12.03598 batch_time=0.35024 
Train Epoch: 31 [566/1000 18112/32000 (57%)] Loss: 0.49265 (QuantReg: 13.07221) QuantErr: 13.07221 batch_time=0.35178 
Train Epoch: 31 [571/1000 18272/32000 (57%)] Loss: 0.24231 (QuantReg: 12.51452) QuantErr: 12.51452 batch_time=0.38057 
Train Epoch: 31 [576/1000 18432/32000 (58%)] Loss: 0.53539 (QuantReg: 12.94881) QuantErr: 12.94881 batch_time=0.36271 
Train Epoch: 31 [581/1000 18592/32000 (58%)] Loss: 0.34404 (QuantReg: 12.47058) QuantErr: 12.47058 batch_time=0.35742 
Train Epoch: 31 [586/1000 18752/32000 (59%)] Loss: 0.43426 (QuantReg: 12.44253) QuantErr: 12.44253 batch_time=0.36607 
Train Epoch: 31 [591/1000 18912/32000 (59%)] Loss: 0.18641 (QuantReg: 12.38874) QuantErr: 12.38874 batch_time=0.35635 
Train Epoch: 31 [596/1000 19072/32000 (60%)] Loss: 0.58094 (QuantReg: 12.87300) QuantErr: 12.87300 batch_time=0.36756 
Train Epoch: 31 [601/1000 19232/32000 (60%)] Loss: 0.40551 (QuantReg: 12.90061) QuantErr: 12.90061 batch_time=0.39726 
Train Epoch: 31 [606/1000 19392/32000 (61%)] Loss: 0.24330 (QuantReg: 12.40597) QuantErr: 12.40597 batch_time=0.35703 
Train Epoch: 31 [611/1000 19552/32000 (61%)] Loss: 0.68526 (QuantReg: 12.23394) QuantErr: 12.23394 batch_time=0.40999 
Train Epoch: 31 [616/1000 19712/32000 (62%)] Loss: 0.44382 (QuantReg: 13.10202) QuantErr: 13.10202 batch_time=0.41142 
Train Epoch: 31 [621/1000 19872/32000 (62%)] Loss: 0.38574 (QuantReg: 12.47502) QuantErr: 12.47502 batch_time=0.40617 
Train Epoch: 31 [626/1000 20032/32000 (63%)] Loss: 0.49180 (QuantReg: 12.11530) QuantErr: 12.11530 batch_time=0.36477 
Train Epoch: 31 [631/1000 20192/32000 (63%)] Loss: 0.33909 (QuantReg: 11.99465) QuantErr: 11.99465 batch_time=0.37920 
Train Epoch: 31 [636/1000 20352/32000 (64%)] Loss: 0.22815 (QuantReg: 12.98689) QuantErr: 12.98689 batch_time=0.35348 
Train Epoch: 31 [641/1000 20512/32000 (64%)] Loss: 0.32249 (QuantReg: 12.55596) QuantErr: 12.55596 batch_time=0.37322 
Train Epoch: 31 [646/1000 20672/32000 (65%)] Loss: 0.20601 (QuantReg: 12.58317) QuantErr: 12.58317 batch_time=0.35732 
Train Epoch: 31 [651/1000 20832/32000 (65%)] Loss: 0.43197 (QuantReg: 11.94940) QuantErr: 11.94940 batch_time=0.35342 
Train Epoch: 31 [656/1000 20992/32000 (66%)] Loss: 0.22638 (QuantReg: 12.24889) QuantErr: 12.24889 batch_time=0.79795 
Train Epoch: 31 [661/1000 21152/32000 (66%)] Loss: 0.16102 (QuantReg: 12.44439) QuantErr: 12.44439 batch_time=0.35014 
Train Epoch: 31 [666/1000 21312/32000 (67%)] Loss: 0.26260 (QuantReg: 12.61064) QuantErr: 12.61064 batch_time=0.38124 
Train Epoch: 31 [671/1000 21472/32000 (67%)] Loss: 0.37675 (QuantReg: 13.06506) QuantErr: 13.06506 batch_time=0.38816 
Train Epoch: 31 [676/1000 21632/32000 (68%)] Loss: 0.29116 (QuantReg: 12.92919) QuantErr: 12.92919 batch_time=0.37681 
Train Epoch: 31 [681/1000 21792/32000 (68%)] Loss: 0.41642 (QuantReg: 12.52711) QuantErr: 12.52711 batch_time=0.42475 
Train Epoch: 31 [686/1000 21952/32000 (69%)] Loss: 0.11490 (QuantReg: 12.87022) QuantErr: 12.87022 batch_time=0.39611 
Train Epoch: 31 [691/1000 22112/32000 (69%)] Loss: 0.38760 (QuantReg: 13.02955) QuantErr: 13.02955 batch_time=0.36463 
Train Epoch: 31 [696/1000 22272/32000 (70%)] Loss: 0.42428 (QuantReg: 11.85863) QuantErr: 11.85863 batch_time=0.36559 
Train Epoch: 31 [701/1000 22432/32000 (70%)] Loss: 0.63542 (QuantReg: 12.51894) QuantErr: 12.51894 batch_time=0.38806 
Train Epoch: 31 [706/1000 22592/32000 (71%)] Loss: 0.42332 (QuantReg: 12.59574) QuantErr: 12.59574 batch_time=0.74258 
Train Epoch: 31 [711/1000 22752/32000 (71%)] Loss: 0.07256 (QuantReg: 12.83090) QuantErr: 12.83090 batch_time=0.36113 
Train Epoch: 31 [716/1000 22912/32000 (72%)] Loss: 0.40095 (QuantReg: 12.75781) QuantErr: 12.75781 batch_time=0.36308 
Train Epoch: 31 [721/1000 23072/32000 (72%)] Loss: 0.57084 (QuantReg: 13.08655) QuantErr: 13.08655 batch_time=1.03267 
Train Epoch: 31 [726/1000 23232/32000 (73%)] Loss: 0.49772 (QuantReg: 12.97569) QuantErr: 12.97569 batch_time=0.36870 
Train Epoch: 31 [731/1000 23392/32000 (73%)] Loss: 0.80139 (QuantReg: 12.60899) QuantErr: 12.60899 batch_time=0.35428 
Train Epoch: 31 [736/1000 23552/32000 (74%)] Loss: 0.26417 (QuantReg: 12.95255) QuantErr: 12.95255 batch_time=0.38329 
Train Epoch: 31 [741/1000 23712/32000 (74%)] Loss: 0.66253 (QuantReg: 12.97285) QuantErr: 12.97285 batch_time=0.40286 
Train Epoch: 31 [746/1000 23872/32000 (75%)] Loss: 0.27427 (QuantReg: 12.85374) QuantErr: 12.85374 batch_time=0.40183 
Train Epoch: 31 [751/1000 24032/32000 (75%)] Loss: 0.20975 (QuantReg: 12.62688) QuantErr: 12.62688 batch_time=0.42386 
Train Epoch: 31 [756/1000 24192/32000 (76%)] Loss: 0.16914 (QuantReg: 12.25936) QuantErr: 12.25936 batch_time=0.39850 
Train Epoch: 31 [761/1000 24352/32000 (76%)] Loss: 0.18842 (QuantReg: 13.04598) QuantErr: 13.04598 batch_time=0.35682 
Train Epoch: 31 [766/1000 24512/32000 (77%)] Loss: 0.41325 (QuantReg: 12.32328) QuantErr: 12.32328 batch_time=0.35397 
Train Epoch: 31 [771/1000 24672/32000 (77%)] Loss: 0.21064 (QuantReg: 12.41254) QuantErr: 12.41254 batch_time=0.36976 
Train Epoch: 31 [776/1000 24832/32000 (78%)] Loss: 0.69176 (QuantReg: 12.62025) QuantErr: 12.62025 batch_time=0.36556 
Train Epoch: 31 [781/1000 24992/32000 (78%)] Loss: 0.39496 (QuantReg: 12.72368) QuantErr: 12.72368 batch_time=0.38322 
Train Epoch: 31 [786/1000 25152/32000 (79%)] Loss: 0.45329 (QuantReg: 13.05010) QuantErr: 13.05010 batch_time=0.59155 
Train Epoch: 31 [791/1000 25312/32000 (79%)] Loss: 0.30201 (QuantReg: 12.01471) QuantErr: 12.01471 batch_time=0.36269 
Train Epoch: 31 [796/1000 25472/32000 (80%)] Loss: 0.45942 (QuantReg: 12.28943) QuantErr: 12.28943 batch_time=0.43761 
Train Epoch: 31 [801/1000 25632/32000 (80%)] Loss: 0.20492 (QuantReg: 12.92958) QuantErr: 12.92958 batch_time=0.36013 
Train Epoch: 31 [806/1000 25792/32000 (81%)] Loss: 0.25824 (QuantReg: 12.88680) QuantErr: 12.88680 batch_time=0.34489 
Train Epoch: 31 [811/1000 25952/32000 (81%)] Loss: 0.11041 (QuantReg: 12.46221) QuantErr: 12.46221 batch_time=0.38251 
Train Epoch: 31 [816/1000 26112/32000 (82%)] Loss: 0.21904 (QuantReg: 12.78158) QuantErr: 12.78158 batch_time=0.36688 
Train Epoch: 31 [821/1000 26272/32000 (82%)] Loss: 0.24576 (QuantReg: 12.78453) QuantErr: 12.78453 batch_time=0.40423 
Train Epoch: 31 [826/1000 26432/32000 (83%)] Loss: 0.22587 (QuantReg: 12.63873) QuantErr: 12.63873 batch_time=0.39924 
Train Epoch: 31 [831/1000 26592/32000 (83%)] Loss: 0.16037 (QuantReg: 12.66651) QuantErr: 12.66651 batch_time=0.40465 
Train Epoch: 31 [836/1000 26752/32000 (84%)] Loss: 0.56238 (QuantReg: 12.64084) QuantErr: 12.64084 batch_time=0.41539 
Train Epoch: 31 [841/1000 26912/32000 (84%)] Loss: 0.22538 (QuantReg: 12.81850) QuantErr: 12.81850 batch_time=0.36392 
Train Epoch: 31 [846/1000 27072/32000 (85%)] Loss: 0.56433 (QuantReg: 12.51532) QuantErr: 12.51532 batch_time=0.37383 
Train Epoch: 31 [851/1000 27232/32000 (85%)] Loss: 0.28115 (QuantReg: 12.85626) QuantErr: 12.85626 batch_time=0.37765 
Train Epoch: 31 [856/1000 27392/32000 (86%)] Loss: 0.19368 (QuantReg: 12.59400) QuantErr: 12.59400 batch_time=0.37497 
Train Epoch: 31 [861/1000 27552/32000 (86%)] Loss: 0.25764 (QuantReg: 13.05484) QuantErr: 13.05484 batch_time=0.36508 
Train Epoch: 31 [866/1000 27712/32000 (87%)] Loss: 0.43693 (QuantReg: 12.18119) QuantErr: 12.18119 batch_time=0.36486 
Train Epoch: 31 [871/1000 27872/32000 (87%)] Loss: 0.52187 (QuantReg: 12.25252) QuantErr: 12.25252 batch_time=0.37551 
Train Epoch: 31 [876/1000 28032/32000 (88%)] Loss: 0.48698 (QuantReg: 12.44831) QuantErr: 12.44831 batch_time=0.35362 
Train Epoch: 31 [881/1000 28192/32000 (88%)] Loss: 0.53610 (QuantReg: 13.16166) QuantErr: 13.16166 batch_time=0.35651 
Train Epoch: 31 [886/1000 28352/32000 (89%)] Loss: 0.53100 (QuantReg: 12.17293) QuantErr: 12.17293 batch_time=0.37997 
Train Epoch: 31 [891/1000 28512/32000 (89%)] Loss: 0.58995 (QuantReg: 12.30480) QuantErr: 12.30480 batch_time=0.39722 
Train Epoch: 31 [896/1000 28672/32000 (90%)] Loss: 0.29311 (QuantReg: 12.56551) QuantErr: 12.56551 batch_time=0.37382 
Train Epoch: 31 [901/1000 28832/32000 (90%)] Loss: 0.20722 (QuantReg: 12.92075) QuantErr: 12.92075 batch_time=0.35680 
Train Epoch: 31 [906/1000 28992/32000 (91%)] Loss: 0.17226 (QuantReg: 13.14681) QuantErr: 13.14681 batch_time=0.37373 
Train Epoch: 31 [911/1000 29152/32000 (91%)] Loss: 0.36699 (QuantReg: 13.11917) QuantErr: 13.11917 batch_time=0.37161 
Train Epoch: 31 [916/1000 29312/32000 (92%)] Loss: 0.54538 (QuantReg: 12.55237) QuantErr: 12.55237 batch_time=0.36442 
Train Epoch: 31 [921/1000 29472/32000 (92%)] Loss: 0.25355 (QuantReg: 13.55605) QuantErr: 13.55605 batch_time=0.36445 
Train Epoch: 31 [926/1000 29632/32000 (93%)] Loss: 0.17583 (QuantReg: 12.80143) QuantErr: 12.80143 batch_time=0.38768 
Train Epoch: 31 [931/1000 29792/32000 (93%)] Loss: 0.48099 (QuantReg: 13.07140) QuantErr: 13.07140 batch_time=0.39700 
Train Epoch: 31 [936/1000 29952/32000 (94%)] Loss: 0.14963 (QuantReg: 12.29261) QuantErr: 12.29261 batch_time=0.35290 
Train Epoch: 31 [941/1000 30112/32000 (94%)] Loss: 0.39345 (QuantReg: 12.27392) QuantErr: 12.27392 batch_time=0.37329 
Train Epoch: 31 [946/1000 30272/32000 (95%)] Loss: 0.30561 (QuantReg: 12.40140) QuantErr: 12.40140 batch_time=0.34614 
Train Epoch: 31 [951/1000 30432/32000 (95%)] Loss: 0.26485 (QuantReg: 12.87218) QuantErr: 12.87218 batch_time=0.37985 
Train Epoch: 31 [956/1000 30592/32000 (96%)] Loss: 0.32646 (QuantReg: 11.84883) QuantErr: 11.84883 batch_time=0.35523 
Train Epoch: 31 [961/1000 30752/32000 (96%)] Loss: 0.17810 (QuantReg: 12.86123) QuantErr: 12.86123 batch_time=0.34394 
Train Epoch: 31 [966/1000 30912/32000 (97%)] Loss: 0.91125 (QuantReg: 12.21502) QuantErr: 12.21502 batch_time=0.35128 
Train Epoch: 31 [971/1000 31072/32000 (97%)] Loss: 0.63094 (QuantReg: 12.46602) QuantErr: 12.46602 batch_time=0.36769 
Train Epoch: 31 [976/1000 31232/32000 (98%)] Loss: 0.28893 (QuantReg: 13.22974) QuantErr: 13.22974 batch_time=0.84469 
Train Epoch: 31 [981/1000 31392/32000 (98%)] Loss: 0.14316 (QuantReg: 12.72750) QuantErr: 12.72750 batch_time=0.35759 
Train Epoch: 31 [986/1000 31552/32000 (99%)] Loss: 0.24927 (QuantReg: 12.59802) QuantErr: 12.59802 batch_time=0.35543 
Train Epoch: 31 [991/1000 31712/32000 (99%)] Loss: 0.25262 (QuantReg: 12.55273) QuantErr: 12.55273 batch_time=0.35161 
Train Epoch: 31 [996/1000 31872/32000 (100%)] Loss: 0.20486 (QuantReg: 12.18623) QuantErr: 12.18623 batch_time=0.35443 
Train Epoch: 31 codebook_update_time=1.99204
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch31.pth ...
Done in 4.341s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 0.34618785217776893
 quant_reg      : 12.618787684440612
 quant_err      : 12.618787684440612
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 31000
 MSRVTT_full_val/t2v_metrics/R1: 31.187122736418512
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.983903420523139
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.40083538732233
 MSRVTT_full_val/v2t_metrics/R1: 35.61368209255533
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.169014084507042
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.62474624262967
 MSRVTT_full_test/t2v_metrics/R1: 12.575250836120402
 MSRVTT_full_test/t2v_metrics/R5: 36.68896321070234
 MSRVTT_full_test/t2v_metrics/R10: 50.5685618729097
 MSRVTT_full_test/t2v_metrics/R50: 81.00334448160535
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.16036789297659
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.57442936458665
 MSRVTT_full_test/v2t_metrics/R1: 15.31772575250836
 MSRVTT_full_test/v2t_metrics/R5: 43.04347826086956
 MSRVTT_full_test/v2t_metrics/R10: 57.424749163879596
 MSRVTT_full_test/v2t_metrics/R50: 86.35451505016722
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.25351170568562
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.57893504363799
 mnt_best       : 29.028717447462
 not_improved_count: 2
Train Epoch: 32 [1/1000 32/32000 (0%)] Loss: 0.23334 (QuantReg: 13.23939) QuantErr: 13.23939 batch_time=27.65276 
Train Epoch: 32 [6/1000 192/32000 (1%)] Loss: 0.19746 (QuantReg: 12.65385) QuantErr: 12.65385 batch_time=0.38041 
Train Epoch: 32 [11/1000 352/32000 (1%)] Loss: 0.14174 (QuantReg: 12.33848) QuantErr: 12.33848 batch_time=0.35361 
Train Epoch: 32 [16/1000 512/32000 (2%)] Loss: 0.08274 (QuantReg: 12.33557) QuantErr: 12.33557 batch_time=2.07219 
Train Epoch: 32 [21/1000 672/32000 (2%)] Loss: 0.18772 (QuantReg: 12.80076) QuantErr: 12.80076 batch_time=0.34375 
Train Epoch: 32 [26/1000 832/32000 (3%)] Loss: 0.15368 (QuantReg: 12.42607) QuantErr: 12.42607 batch_time=0.35299 
Train Epoch: 32 [31/1000 992/32000 (3%)] Loss: 0.31598 (QuantReg: 12.66050) QuantErr: 12.66050 batch_time=0.34727 
Train Epoch: 32 [36/1000 1152/32000 (4%)] Loss: 0.22717 (QuantReg: 12.27592) QuantErr: 12.27592 batch_time=0.36113 
Train Epoch: 32 [41/1000 1312/32000 (4%)] Loss: 0.29603 (QuantReg: 11.94007) QuantErr: 11.94007 batch_time=0.37092 
Train Epoch: 32 [46/1000 1472/32000 (5%)] Loss: 0.43950 (QuantReg: 12.75076) QuantErr: 12.75076 batch_time=0.34732 
Train Epoch: 32 [51/1000 1632/32000 (5%)] Loss: 0.18399 (QuantReg: 12.88928) QuantErr: 12.88928 batch_time=0.35711 
Train Epoch: 32 [56/1000 1792/32000 (6%)] Loss: 0.37517 (QuantReg: 11.76627) QuantErr: 11.76627 batch_time=0.35690 
Train Epoch: 32 [61/1000 1952/32000 (6%)] Loss: 0.33565 (QuantReg: 12.92311) QuantErr: 12.92311 batch_time=0.36352 
Train Epoch: 32 [66/1000 2112/32000 (7%)] Loss: 0.19292 (QuantReg: 12.75179) QuantErr: 12.75179 batch_time=0.36235 
Train Epoch: 32 [71/1000 2272/32000 (7%)] Loss: 0.18494 (QuantReg: 12.11992) QuantErr: 12.11992 batch_time=0.39210 
Train Epoch: 32 [76/1000 2432/32000 (8%)] Loss: 0.59119 (QuantReg: 13.11579) QuantErr: 13.11579 batch_time=0.39489 
Train Epoch: 32 [81/1000 2592/32000 (8%)] Loss: 0.08953 (QuantReg: 13.21060) QuantErr: 13.21060 batch_time=0.37392 
Train Epoch: 32 [86/1000 2752/32000 (9%)] Loss: 0.30562 (QuantReg: 12.08497) QuantErr: 12.08497 batch_time=0.40574 
Train Epoch: 32 [91/1000 2912/32000 (9%)] Loss: 0.25147 (QuantReg: 13.02767) QuantErr: 13.02767 batch_time=0.37140 
Train Epoch: 32 [96/1000 3072/32000 (10%)] Loss: 0.18612 (QuantReg: 12.78036) QuantErr: 12.78036 batch_time=0.37901 
Train Epoch: 32 [101/1000 3232/32000 (10%)] Loss: 0.45626 (QuantReg: 12.82425) QuantErr: 12.82425 batch_time=0.36147 
Train Epoch: 32 [106/1000 3392/32000 (11%)] Loss: 0.09154 (QuantReg: 13.09238) QuantErr: 13.09238 batch_time=0.38609 
Train Epoch: 32 [111/1000 3552/32000 (11%)] Loss: 0.60813 (QuantReg: 12.63213) QuantErr: 12.63213 batch_time=0.38880 
Train Epoch: 32 [116/1000 3712/32000 (12%)] Loss: 0.39341 (QuantReg: 12.13001) QuantErr: 12.13001 batch_time=0.36474 
Train Epoch: 32 [121/1000 3872/32000 (12%)] Loss: 0.33751 (QuantReg: 12.49001) QuantErr: 12.49001 batch_time=0.49147 
Train Epoch: 32 [126/1000 4032/32000 (13%)] Loss: 0.11061 (QuantReg: 13.33496) QuantErr: 13.33496 batch_time=0.36681 
Train Epoch: 32 [131/1000 4192/32000 (13%)] Loss: 0.15262 (QuantReg: 12.67457) QuantErr: 12.67457 batch_time=0.70596 
Train Epoch: 32 [136/1000 4352/32000 (14%)] Loss: 0.34408 (QuantReg: 12.56452) QuantErr: 12.56452 batch_time=0.41159 
Train Epoch: 32 [141/1000 4512/32000 (14%)] Loss: 0.14912 (QuantReg: 12.54033) QuantErr: 12.54033 batch_time=0.41894 
Train Epoch: 32 [146/1000 4672/32000 (15%)] Loss: 0.23677 (QuantReg: 12.89432) QuantErr: 12.89432 batch_time=0.37133 
Train Epoch: 32 [151/1000 4832/32000 (15%)] Loss: 0.52103 (QuantReg: 12.02613) QuantErr: 12.02613 batch_time=0.40323 
Train Epoch: 32 [156/1000 4992/32000 (16%)] Loss: 0.18869 (QuantReg: 13.53489) QuantErr: 13.53489 batch_time=0.39196 
Train Epoch: 32 [161/1000 5152/32000 (16%)] Loss: 0.29613 (QuantReg: 12.75758) QuantErr: 12.75758 batch_time=0.36479 
Train Epoch: 32 [166/1000 5312/32000 (17%)] Loss: 0.41767 (QuantReg: 13.17541) QuantErr: 13.17541 batch_time=0.37468 
Train Epoch: 32 [171/1000 5472/32000 (17%)] Loss: 0.44527 (QuantReg: 12.42585) QuantErr: 12.42585 batch_time=0.63487 
Train Epoch: 32 [176/1000 5632/32000 (18%)] Loss: 0.24419 (QuantReg: 12.50536) QuantErr: 12.50536 batch_time=0.37833 
Train Epoch: 32 [181/1000 5792/32000 (18%)] Loss: 0.09072 (QuantReg: 13.29745) QuantErr: 13.29745 batch_time=0.35755 
Train Epoch: 32 [186/1000 5952/32000 (19%)] Loss: 0.24362 (QuantReg: 12.92916) QuantErr: 12.92916 batch_time=0.39775 
Train Epoch: 32 [191/1000 6112/32000 (19%)] Loss: 0.30615 (QuantReg: 12.57762) QuantErr: 12.57762 batch_time=0.37058 
Train Epoch: 32 [196/1000 6272/32000 (20%)] Loss: 0.20411 (QuantReg: 12.36106) QuantErr: 12.36106 batch_time=0.37646 
Train Epoch: 32 [201/1000 6432/32000 (20%)] Loss: 0.11262 (QuantReg: 12.75858) QuantErr: 12.75858 batch_time=0.35636 
Train Epoch: 32 [206/1000 6592/32000 (21%)] Loss: 0.38872 (QuantReg: 12.80190) QuantErr: 12.80190 batch_time=0.39477 
Train Epoch: 32 [211/1000 6752/32000 (21%)] Loss: 0.48405 (QuantReg: 12.07467) QuantErr: 12.07467 batch_time=0.35326 
Train Epoch: 32 [216/1000 6912/32000 (22%)] Loss: 0.36596 (QuantReg: 12.50310) QuantErr: 12.50310 batch_time=0.35260 
Train Epoch: 32 [221/1000 7072/32000 (22%)] Loss: 0.22650 (QuantReg: 12.35369) QuantErr: 12.35369 batch_time=0.42770 
Train Epoch: 32 [226/1000 7232/32000 (23%)] Loss: 0.18152 (QuantReg: 13.33851) QuantErr: 13.33851 batch_time=0.36165 
Train Epoch: 32 [231/1000 7392/32000 (23%)] Loss: 0.12981 (QuantReg: 12.96296) QuantErr: 12.96296 batch_time=0.35394 
Train Epoch: 32 [236/1000 7552/32000 (24%)] Loss: 0.73986 (QuantReg: 12.04420) QuantErr: 12.04420 batch_time=0.39966 
Train Epoch: 32 [241/1000 7712/32000 (24%)] Loss: 0.13135 (QuantReg: 13.23703) QuantErr: 13.23703 batch_time=0.38771 
Train Epoch: 32 [246/1000 7872/32000 (25%)] Loss: 0.29939 (QuantReg: 12.59123) QuantErr: 12.59123 batch_time=0.37638 
Train Epoch: 32 [251/1000 8032/32000 (25%)] Loss: 0.29776 (QuantReg: 12.26285) QuantErr: 12.26285 batch_time=0.36646 
Train Epoch: 32 [256/1000 8192/32000 (26%)] Loss: 0.41167 (QuantReg: 12.50156) QuantErr: 12.50156 batch_time=0.35030 
Train Epoch: 32 [261/1000 8352/32000 (26%)] Loss: 0.27113 (QuantReg: 12.34601) QuantErr: 12.34601 batch_time=0.36501 
Train Epoch: 32 [266/1000 8512/32000 (27%)] Loss: 0.16146 (QuantReg: 12.61469) QuantErr: 12.61469 batch_time=0.35534 
Train Epoch: 32 [271/1000 8672/32000 (27%)] Loss: 0.20198 (QuantReg: 12.69769) QuantErr: 12.69769 batch_time=0.34500 
Train Epoch: 32 [276/1000 8832/32000 (28%)] Loss: 0.61802 (QuantReg: 11.93336) QuantErr: 11.93336 batch_time=0.35649 
Train Epoch: 32 [281/1000 8992/32000 (28%)] Loss: 0.41387 (QuantReg: 11.60334) QuantErr: 11.60334 batch_time=0.34349 
Train Epoch: 32 [286/1000 9152/32000 (29%)] Loss: 0.35472 (QuantReg: 12.71233) QuantErr: 12.71233 batch_time=0.34533 
Train Epoch: 32 [291/1000 9312/32000 (29%)] Loss: 0.30596 (QuantReg: 12.66719) QuantErr: 12.66719 batch_time=0.38854 
Train Epoch: 32 [296/1000 9472/32000 (30%)] Loss: 0.14228 (QuantReg: 12.52694) QuantErr: 12.52694 batch_time=0.38779 
Train Epoch: 32 [301/1000 9632/32000 (30%)] Loss: 0.27599 (QuantReg: 13.01624) QuantErr: 13.01624 batch_time=0.35620 
Train Epoch: 32 [306/1000 9792/32000 (31%)] Loss: 0.21064 (QuantReg: 12.95241) QuantErr: 12.95241 batch_time=0.38501 
Train Epoch: 32 [311/1000 9952/32000 (31%)] Loss: 0.18576 (QuantReg: 12.88586) QuantErr: 12.88586 batch_time=0.36093 
Train Epoch: 32 [316/1000 10112/32000 (32%)] Loss: 0.15911 (QuantReg: 12.84468) QuantErr: 12.84468 batch_time=0.35434 
Train Epoch: 32 [321/1000 10272/32000 (32%)] Loss: 0.57515 (QuantReg: 12.26155) QuantErr: 12.26155 batch_time=0.35008 
Train Epoch: 32 [326/1000 10432/32000 (33%)] Loss: 0.34061 (QuantReg: 12.01275) QuantErr: 12.01275 batch_time=0.36374 
Train Epoch: 32 [331/1000 10592/32000 (33%)] Loss: 0.29588 (QuantReg: 13.39942) QuantErr: 13.39942 batch_time=0.35354 
Train Epoch: 32 [336/1000 10752/32000 (34%)] Loss: 0.29584 (QuantReg: 12.95397) QuantErr: 12.95397 batch_time=1.57216 
Train Epoch: 32 [341/1000 10912/32000 (34%)] Loss: 0.23924 (QuantReg: 13.12472) QuantErr: 13.12472 batch_time=0.36843 
Train Epoch: 32 [346/1000 11072/32000 (35%)] Loss: 0.22968 (QuantReg: 12.44868) QuantErr: 12.44868 batch_time=0.38210 
Train Epoch: 32 [351/1000 11232/32000 (35%)] Loss: 0.51023 (QuantReg: 12.81029) QuantErr: 12.81029 batch_time=0.39449 
Train Epoch: 32 [356/1000 11392/32000 (36%)] Loss: 0.16345 (QuantReg: 13.16171) QuantErr: 13.16171 batch_time=0.39668 
Train Epoch: 32 [361/1000 11552/32000 (36%)] Loss: 0.34792 (QuantReg: 12.58282) QuantErr: 12.58282 batch_time=0.41049 
Train Epoch: 32 [366/1000 11712/32000 (37%)] Loss: 0.22838 (QuantReg: 12.74493) QuantErr: 12.74493 batch_time=0.41696 
Train Epoch: 32 [371/1000 11872/32000 (37%)] Loss: 0.28991 (QuantReg: 12.61634) QuantErr: 12.61634 batch_time=0.36481 
Train Epoch: 32 [376/1000 12032/32000 (38%)] Loss: 0.16533 (QuantReg: 12.82507) QuantErr: 12.82507 batch_time=0.36282 
Train Epoch: 32 [381/1000 12192/32000 (38%)] Loss: 0.27790 (QuantReg: 13.24492) QuantErr: 13.24492 batch_time=0.35872 
Train Epoch: 32 [386/1000 12352/32000 (39%)] Loss: 0.56150 (QuantReg: 12.91810) QuantErr: 12.91810 batch_time=0.42337 
Train Epoch: 32 [391/1000 12512/32000 (39%)] Loss: 0.42009 (QuantReg: 13.02308) QuantErr: 13.02308 batch_time=0.37049 
Train Epoch: 32 [396/1000 12672/32000 (40%)] Loss: 0.35889 (QuantReg: 13.30437) QuantErr: 13.30437 batch_time=0.35763 
Train Epoch: 32 [401/1000 12832/32000 (40%)] Loss: 0.36401 (QuantReg: 12.74189) QuantErr: 12.74189 batch_time=0.36478 
Train Epoch: 32 [406/1000 12992/32000 (41%)] Loss: 0.27285 (QuantReg: 12.44180) QuantErr: 12.44180 batch_time=0.36689 
Train Epoch: 32 [411/1000 13152/32000 (41%)] Loss: 0.34425 (QuantReg: 12.86026) QuantErr: 12.86026 batch_time=0.36025 
Train Epoch: 32 [416/1000 13312/32000 (42%)] Loss: 0.59063 (QuantReg: 12.50643) QuantErr: 12.50643 batch_time=0.41694 
Train Epoch: 32 [421/1000 13472/32000 (42%)] Loss: 0.40634 (QuantReg: 12.58673) QuantErr: 12.58673 batch_time=0.42845 
Train Epoch: 32 [426/1000 13632/32000 (43%)] Loss: 0.31184 (QuantReg: 12.76104) QuantErr: 12.76104 batch_time=0.37064 
Train Epoch: 32 [431/1000 13792/32000 (43%)] Loss: 0.39255 (QuantReg: 12.96753) QuantErr: 12.96753 batch_time=0.34971 
Train Epoch: 32 [436/1000 13952/32000 (44%)] Loss: 0.27651 (QuantReg: 12.74452) QuantErr: 12.74452 batch_time=0.38527 
Train Epoch: 32 [441/1000 14112/32000 (44%)] Loss: 0.15058 (QuantReg: 13.40797) QuantErr: 13.40797 batch_time=0.45444 
Train Epoch: 32 [446/1000 14272/32000 (45%)] Loss: 0.12907 (QuantReg: 12.99929) QuantErr: 12.99929 batch_time=0.39363 
Train Epoch: 32 [451/1000 14432/32000 (45%)] Loss: 0.25351 (QuantReg: 13.01198) QuantErr: 13.01198 batch_time=0.78725 
Train Epoch: 32 [456/1000 14592/32000 (46%)] Loss: 0.29473 (QuantReg: 12.57410) QuantErr: 12.57410 batch_time=0.35730 
Train Epoch: 32 [461/1000 14752/32000 (46%)] Loss: 0.11999 (QuantReg: 13.07768) QuantErr: 13.07768 batch_time=0.36328 
Train Epoch: 32 [466/1000 14912/32000 (47%)] Loss: 0.18658 (QuantReg: 13.18939) QuantErr: 13.18939 batch_time=0.38560 
Train Epoch: 32 [471/1000 15072/32000 (47%)] Loss: 0.15155 (QuantReg: 12.83969) QuantErr: 12.83969 batch_time=0.42642 
Train Epoch: 32 [476/1000 15232/32000 (48%)] Loss: 0.34947 (QuantReg: 12.97473) QuantErr: 12.97473 batch_time=0.37084 
Train Epoch: 32 [481/1000 15392/32000 (48%)] Loss: 0.28942 (QuantReg: 12.96383) QuantErr: 12.96383 batch_time=0.38596 
Train Epoch: 32 [486/1000 15552/32000 (49%)] Loss: 0.13249 (QuantReg: 12.75519) QuantErr: 12.75519 batch_time=0.41009 
Train Epoch: 32 [491/1000 15712/32000 (49%)] Loss: 0.56117 (QuantReg: 12.72119) QuantErr: 12.72119 batch_time=0.57794 
Train Epoch: 32 [496/1000 15872/32000 (50%)] Loss: 0.09160 (QuantReg: 12.87776) QuantErr: 12.87776 batch_time=0.39837 
Train Epoch: 32 [501/1000 16032/32000 (50%)] Loss: 0.19327 (QuantReg: 13.30067) QuantErr: 13.30067 batch_time=0.37120 
Train Epoch: 32 [506/1000 16192/32000 (51%)] Loss: 0.13853 (QuantReg: 12.90000) QuantErr: 12.90000 batch_time=0.41929 
Train Epoch: 32 [511/1000 16352/32000 (51%)] Loss: 0.44712 (QuantReg: 12.07608) QuantErr: 12.07608 batch_time=0.41215 
Train Epoch: 32 [516/1000 16512/32000 (52%)] Loss: 0.11421 (QuantReg: 13.09012) QuantErr: 13.09012 batch_time=0.36002 
Train Epoch: 32 [521/1000 16672/32000 (52%)] Loss: 0.46742 (QuantReg: 11.84762) QuantErr: 11.84762 batch_time=0.35305 
Train Epoch: 32 [526/1000 16832/32000 (53%)] Loss: 0.26340 (QuantReg: 12.58016) QuantErr: 12.58016 batch_time=0.40478 
Train Epoch: 32 [531/1000 16992/32000 (53%)] Loss: 0.15439 (QuantReg: 12.49747) QuantErr: 12.49747 batch_time=0.40247 
Train Epoch: 32 [536/1000 17152/32000 (54%)] Loss: 0.34910 (QuantReg: 12.59170) QuantErr: 12.59170 batch_time=0.36078 
Train Epoch: 32 [541/1000 17312/32000 (54%)] Loss: 0.26251 (QuantReg: 13.07040) QuantErr: 13.07040 batch_time=0.35933 
Train Epoch: 32 [546/1000 17472/32000 (55%)] Loss: 0.73540 (QuantReg: 11.78534) QuantErr: 11.78534 batch_time=0.34522 
Train Epoch: 32 [551/1000 17632/32000 (55%)] Loss: 0.48696 (QuantReg: 12.56155) QuantErr: 12.56155 batch_time=0.35358 
Train Epoch: 32 [556/1000 17792/32000 (56%)] Loss: 0.40897 (QuantReg: 12.79017) QuantErr: 12.79017 batch_time=0.34262 
Train Epoch: 32 [561/1000 17952/32000 (56%)] Loss: 0.41418 (QuantReg: 12.80196) QuantErr: 12.80196 batch_time=0.34006 
Train Epoch: 32 [566/1000 18112/32000 (57%)] Loss: 0.42851 (QuantReg: 12.92947) QuantErr: 12.92947 batch_time=0.34266 
Train Epoch: 32 [571/1000 18272/32000 (57%)] Loss: 0.25998 (QuantReg: 11.58386) QuantErr: 11.58386 batch_time=0.34344 
Train Epoch: 32 [576/1000 18432/32000 (58%)] Loss: 0.33276 (QuantReg: 12.41234) QuantErr: 12.41234 batch_time=0.34335 
Train Epoch: 32 [581/1000 18592/32000 (58%)] Loss: 0.19945 (QuantReg: 12.60481) QuantErr: 12.60481 batch_time=0.37533 
Train Epoch: 32 [586/1000 18752/32000 (59%)] Loss: 0.16992 (QuantReg: 13.21921) QuantErr: 13.21921 batch_time=0.36194 
Train Epoch: 32 [591/1000 18912/32000 (59%)] Loss: 0.22446 (QuantReg: 13.20932) QuantErr: 13.20932 batch_time=0.35596 
Train Epoch: 32 [596/1000 19072/32000 (60%)] Loss: 0.33786 (QuantReg: 12.45305) QuantErr: 12.45305 batch_time=0.35829 
Train Epoch: 32 [601/1000 19232/32000 (60%)] Loss: 0.71450 (QuantReg: 12.73456) QuantErr: 12.73456 batch_time=0.36315 
Train Epoch: 32 [606/1000 19392/32000 (61%)] Loss: 0.11385 (QuantReg: 13.99254) QuantErr: 13.99254 batch_time=0.34931 
Train Epoch: 32 [611/1000 19552/32000 (61%)] Loss: 0.36819 (QuantReg: 12.49804) QuantErr: 12.49804 batch_time=0.36674 
Train Epoch: 32 [616/1000 19712/32000 (62%)] Loss: 0.44658 (QuantReg: 12.42316) QuantErr: 12.42316 batch_time=0.34986 
Train Epoch: 32 [621/1000 19872/32000 (62%)] Loss: 0.46165 (QuantReg: 12.83560) QuantErr: 12.83560 batch_time=0.35432 
Train Epoch: 32 [626/1000 20032/32000 (63%)] Loss: 0.27012 (QuantReg: 11.66765) QuantErr: 11.66765 batch_time=0.34580 
Train Epoch: 32 [631/1000 20192/32000 (63%)] Loss: 0.10094 (QuantReg: 13.56769) QuantErr: 13.56769 batch_time=0.35585 
Train Epoch: 32 [636/1000 20352/32000 (64%)] Loss: 0.38984 (QuantReg: 12.68201) QuantErr: 12.68201 batch_time=0.37105 
Train Epoch: 32 [641/1000 20512/32000 (64%)] Loss: 0.36331 (QuantReg: 12.47756) QuantErr: 12.47756 batch_time=0.35738 
Train Epoch: 32 [646/1000 20672/32000 (65%)] Loss: 0.28429 (QuantReg: 12.63388) QuantErr: 12.63388 batch_time=0.35000 
Train Epoch: 32 [651/1000 20832/32000 (65%)] Loss: 0.44016 (QuantReg: 12.48793) QuantErr: 12.48793 batch_time=0.35470 
Train Epoch: 32 [656/1000 20992/32000 (66%)] Loss: 0.38400 (QuantReg: 13.05010) QuantErr: 13.05010 batch_time=1.52029 
Train Epoch: 32 [661/1000 21152/32000 (66%)] Loss: 0.41662 (QuantReg: 12.98833) QuantErr: 12.98833 batch_time=0.37109 
Train Epoch: 32 [666/1000 21312/32000 (67%)] Loss: 0.46798 (QuantReg: 12.50911) QuantErr: 12.50911 batch_time=0.37679 
Train Epoch: 32 [671/1000 21472/32000 (67%)] Loss: 0.58758 (QuantReg: 12.78589) QuantErr: 12.78589 batch_time=0.40310 
Train Epoch: 32 [676/1000 21632/32000 (68%)] Loss: 0.22729 (QuantReg: 12.77188) QuantErr: 12.77188 batch_time=0.36591 
Train Epoch: 32 [681/1000 21792/32000 (68%)] Loss: 0.45506 (QuantReg: 12.09897) QuantErr: 12.09897 batch_time=0.37853 
Train Epoch: 32 [686/1000 21952/32000 (69%)] Loss: 0.05606 (QuantReg: 13.10398) QuantErr: 13.10398 batch_time=0.37422 
Train Epoch: 32 [691/1000 22112/32000 (69%)] Loss: 0.29257 (QuantReg: 12.08694) QuantErr: 12.08694 batch_time=0.41627 
Train Epoch: 32 [696/1000 22272/32000 (70%)] Loss: 0.36838 (QuantReg: 12.97983) QuantErr: 12.97983 batch_time=0.41296 
Train Epoch: 32 [701/1000 22432/32000 (70%)] Loss: 0.23174 (QuantReg: 12.35305) QuantErr: 12.35305 batch_time=0.36442 
Train Epoch: 32 [706/1000 22592/32000 (71%)] Loss: 0.30204 (QuantReg: 12.85990) QuantErr: 12.85990 batch_time=0.35632 
Train Epoch: 32 [711/1000 22752/32000 (71%)] Loss: 0.30089 (QuantReg: 12.88134) QuantErr: 12.88134 batch_time=0.34749 
Train Epoch: 32 [716/1000 22912/32000 (72%)] Loss: 0.40454 (QuantReg: 12.28397) QuantErr: 12.28397 batch_time=0.34402 
Train Epoch: 32 [721/1000 23072/32000 (72%)] Loss: 0.23082 (QuantReg: 12.76514) QuantErr: 12.76514 batch_time=0.34340 
Train Epoch: 32 [726/1000 23232/32000 (73%)] Loss: 0.72650 (QuantReg: 13.18496) QuantErr: 13.18496 batch_time=0.34227 
Train Epoch: 32 [731/1000 23392/32000 (73%)] Loss: 0.33727 (QuantReg: 12.66161) QuantErr: 12.66161 batch_time=0.34711 
Train Epoch: 32 [736/1000 23552/32000 (74%)] Loss: 0.19252 (QuantReg: 13.18138) QuantErr: 13.18138 batch_time=0.40871 
Train Epoch: 32 [741/1000 23712/32000 (74%)] Loss: 0.17484 (QuantReg: 12.76050) QuantErr: 12.76050 batch_time=0.39888 
Train Epoch: 32 [746/1000 23872/32000 (75%)] Loss: 0.23033 (QuantReg: 12.91729) QuantErr: 12.91729 batch_time=0.37232 
Train Epoch: 32 [751/1000 24032/32000 (75%)] Loss: 0.17805 (QuantReg: 13.01833) QuantErr: 13.01833 batch_time=0.35060 
Train Epoch: 32 [756/1000 24192/32000 (76%)] Loss: 0.27134 (QuantReg: 12.45657) QuantErr: 12.45657 batch_time=0.35097 
Train Epoch: 32 [761/1000 24352/32000 (76%)] Loss: 0.22002 (QuantReg: 13.35898) QuantErr: 13.35898 batch_time=0.44310 
Train Epoch: 32 [766/1000 24512/32000 (77%)] Loss: 0.16341 (QuantReg: 13.08882) QuantErr: 13.08882 batch_time=0.35732 
Train Epoch: 32 [771/1000 24672/32000 (77%)] Loss: 0.17627 (QuantReg: 12.01938) QuantErr: 12.01938 batch_time=0.74682 
Train Epoch: 32 [776/1000 24832/32000 (78%)] Loss: 0.26753 (QuantReg: 13.23502) QuantErr: 13.23502 batch_time=0.35195 
Train Epoch: 32 [781/1000 24992/32000 (78%)] Loss: 0.41074 (QuantReg: 12.22638) QuantErr: 12.22638 batch_time=0.35055 
Train Epoch: 32 [786/1000 25152/32000 (79%)] Loss: 0.20763 (QuantReg: 12.49664) QuantErr: 12.49664 batch_time=0.41989 
Train Epoch: 32 [791/1000 25312/32000 (79%)] Loss: 0.12283 (QuantReg: 12.62461) QuantErr: 12.62461 batch_time=0.35429 
Train Epoch: 32 [796/1000 25472/32000 (80%)] Loss: 0.28690 (QuantReg: 12.65352) QuantErr: 12.65352 batch_time=0.36605 
Train Epoch: 32 [801/1000 25632/32000 (80%)] Loss: 0.30653 (QuantReg: 12.55109) QuantErr: 12.55109 batch_time=0.35282 
Train Epoch: 32 [806/1000 25792/32000 (81%)] Loss: 0.18938 (QuantReg: 13.23881) QuantErr: 13.23881 batch_time=0.36880 
Train Epoch: 32 [811/1000 25952/32000 (81%)] Loss: 0.65677 (QuantReg: 12.75972) QuantErr: 12.75972 batch_time=0.56295 
Train Epoch: 32 [816/1000 26112/32000 (82%)] Loss: 0.38709 (QuantReg: 12.39424) QuantErr: 12.39424 batch_time=0.36294 
Train Epoch: 32 [821/1000 26272/32000 (82%)] Loss: 0.25278 (QuantReg: 12.98712) QuantErr: 12.98712 batch_time=0.38088 
Train Epoch: 32 [826/1000 26432/32000 (83%)] Loss: 0.32639 (QuantReg: 13.19677) QuantErr: 13.19677 batch_time=0.40208 
Train Epoch: 32 [831/1000 26592/32000 (83%)] Loss: 0.19280 (QuantReg: 12.69411) QuantErr: 12.69411 batch_time=0.46235 
Train Epoch: 32 [836/1000 26752/32000 (84%)] Loss: 0.27454 (QuantReg: 12.72498) QuantErr: 12.72498 batch_time=0.36423 
Train Epoch: 32 [841/1000 26912/32000 (84%)] Loss: 0.21815 (QuantReg: 13.28783) QuantErr: 13.28783 batch_time=0.35470 
Train Epoch: 32 [846/1000 27072/32000 (85%)] Loss: 0.31076 (QuantReg: 12.09719) QuantErr: 12.09719 batch_time=0.40284 
Train Epoch: 32 [851/1000 27232/32000 (85%)] Loss: 0.64527 (QuantReg: 13.14223) QuantErr: 13.14223 batch_time=0.36352 
Train Epoch: 32 [856/1000 27392/32000 (86%)] Loss: 0.51043 (QuantReg: 12.27898) QuantErr: 12.27898 batch_time=0.34591 
Train Epoch: 32 [861/1000 27552/32000 (86%)] Loss: 0.21486 (QuantReg: 12.93930) QuantErr: 12.93930 batch_time=0.34948 
Train Epoch: 32 [866/1000 27712/32000 (87%)] Loss: 0.30777 (QuantReg: 13.10174) QuantErr: 13.10174 batch_time=0.35476 
Train Epoch: 32 [871/1000 27872/32000 (87%)] Loss: 0.43336 (QuantReg: 12.93120) QuantErr: 12.93120 batch_time=0.36949 
Train Epoch: 32 [876/1000 28032/32000 (88%)] Loss: 0.33738 (QuantReg: 13.24897) QuantErr: 13.24897 batch_time=0.40143 
Train Epoch: 32 [881/1000 28192/32000 (88%)] Loss: 0.39521 (QuantReg: 12.91570) QuantErr: 12.91570 batch_time=0.43333 
Train Epoch: 32 [886/1000 28352/32000 (89%)] Loss: 0.34316 (QuantReg: 12.52293) QuantErr: 12.52293 batch_time=0.38963 
Train Epoch: 32 [891/1000 28512/32000 (89%)] Loss: 0.40584 (QuantReg: 13.12750) QuantErr: 13.12750 batch_time=0.45228 
Train Epoch: 32 [896/1000 28672/32000 (90%)] Loss: 0.11670 (QuantReg: 12.99412) QuantErr: 12.99412 batch_time=0.37301 
Train Epoch: 32 [901/1000 28832/32000 (90%)] Loss: 0.17341 (QuantReg: 12.70504) QuantErr: 12.70504 batch_time=0.40949 
Train Epoch: 32 [906/1000 28992/32000 (91%)] Loss: 0.51042 (QuantReg: 12.27994) QuantErr: 12.27994 batch_time=0.44372 
Train Epoch: 32 [911/1000 29152/32000 (91%)] Loss: 0.28561 (QuantReg: 12.27339) QuantErr: 12.27339 batch_time=0.36115 
Train Epoch: 32 [916/1000 29312/32000 (92%)] Loss: 0.26664 (QuantReg: 12.75716) QuantErr: 12.75716 batch_time=0.35936 
Train Epoch: 32 [921/1000 29472/32000 (92%)] Loss: 0.35076 (QuantReg: 12.82894) QuantErr: 12.82894 batch_time=0.37019 
Train Epoch: 32 [926/1000 29632/32000 (93%)] Loss: 0.39548 (QuantReg: 12.25479) QuantErr: 12.25479 batch_time=0.41335 
Train Epoch: 32 [931/1000 29792/32000 (93%)] Loss: 0.39200 (QuantReg: 12.79773) QuantErr: 12.79773 batch_time=0.41217 
Train Epoch: 32 [936/1000 29952/32000 (94%)] Loss: 0.24413 (QuantReg: 13.28988) QuantErr: 13.28988 batch_time=0.37081 
Train Epoch: 32 [941/1000 30112/32000 (94%)] Loss: 0.40418 (QuantReg: 12.74199) QuantErr: 12.74199 batch_time=0.35915 
Train Epoch: 32 [946/1000 30272/32000 (95%)] Loss: 0.49854 (QuantReg: 12.49942) QuantErr: 12.49942 batch_time=0.36199 
Train Epoch: 32 [951/1000 30432/32000 (95%)] Loss: 0.23027 (QuantReg: 13.00118) QuantErr: 13.00118 batch_time=0.35837 
Train Epoch: 32 [956/1000 30592/32000 (96%)] Loss: 0.46180 (QuantReg: 12.91474) QuantErr: 12.91474 batch_time=0.37868 
Train Epoch: 32 [961/1000 30752/32000 (96%)] Loss: 0.41819 (QuantReg: 13.01970) QuantErr: 13.01970 batch_time=0.41816 
Train Epoch: 32 [966/1000 30912/32000 (97%)] Loss: 0.25737 (QuantReg: 12.93579) QuantErr: 12.93579 batch_time=0.38133 
Train Epoch: 32 [971/1000 31072/32000 (97%)] Loss: 0.41185 (QuantReg: 13.18910) QuantErr: 13.18910 batch_time=0.37057 
Train Epoch: 32 [976/1000 31232/32000 (98%)] Loss: 0.26622 (QuantReg: 13.64897) QuantErr: 13.64897 batch_time=1.59573 
Train Epoch: 32 [981/1000 31392/32000 (98%)] Loss: 0.14526 (QuantReg: 13.41081) QuantErr: 13.41081 batch_time=0.35841 
Train Epoch: 32 [986/1000 31552/32000 (99%)] Loss: 0.20305 (QuantReg: 13.06901) QuantErr: 13.06901 batch_time=0.37792 
Train Epoch: 32 [991/1000 31712/32000 (99%)] Loss: 0.40605 (QuantReg: 13.34404) QuantErr: 13.34404 batch_time=0.35400 
Train Epoch: 32 [996/1000 31872/32000 (100%)] Loss: 0.25364 (QuantReg: 13.15517) QuantErr: 13.15517 batch_time=0.35806 
Train Epoch: 32 codebook_update_time=1.73536
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch32.pth ...
Done in 15.805s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 0.32747896682843564
 quant_reg      : 12.691582968711852
 quant_err      : 12.691582968711852
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 32000
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 65.99597585513078
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.251509054325956
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.124187730114585
 MSRVTT_full_val/v2t_metrics/R1: 35.814889336016094
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.710261569416499
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.440406046197616
 MSRVTT_full_test/t2v_metrics/R1: 12.341137123745819
 MSRVTT_full_test/t2v_metrics/R5: 35.752508361204015
 MSRVTT_full_test/t2v_metrics/R10: 49.89966555183946
 MSRVTT_full_test/t2v_metrics/R50: 81.07023411371237
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.51371237458194
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.027634359509356
 MSRVTT_full_test/v2t_metrics/R1: 15.518394648829432
 MSRVTT_full_test/v2t_metrics/R5: 42.74247491638796
 MSRVTT_full_test/v2t_metrics/R10: 56.58862876254181
 MSRVTT_full_test/v2t_metrics/R50: 85.91973244147157
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.138127090301005
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.48203731190629
 mnt_best       : 29.028717447462
 not_improved_count: 3
Train Epoch: 33 [1/1000 32/32000 (0%)] Loss: 0.34899 (QuantReg: 12.66051) QuantErr: 12.66051 batch_time=28.66061 
Train Epoch: 33 [6/1000 192/32000 (1%)] Loss: 0.43998 (QuantReg: 12.73728) QuantErr: 12.73728 batch_time=0.37238 
Train Epoch: 33 [11/1000 352/32000 (1%)] Loss: 0.13990 (QuantReg: 12.48946) QuantErr: 12.48946 batch_time=0.34242 
Train Epoch: 33 [16/1000 512/32000 (2%)] Loss: 0.38132 (QuantReg: 13.11894) QuantErr: 13.11894 batch_time=0.96640 
Train Epoch: 33 [21/1000 672/32000 (2%)] Loss: 0.44204 (QuantReg: 13.27662) QuantErr: 13.27662 batch_time=0.44046 
Train Epoch: 33 [26/1000 832/32000 (3%)] Loss: 0.18566 (QuantReg: 12.19337) QuantErr: 12.19337 batch_time=0.42350 
Train Epoch: 33 [31/1000 992/32000 (3%)] Loss: 0.47866 (QuantReg: 12.94549) QuantErr: 12.94549 batch_time=0.36294 
Train Epoch: 33 [36/1000 1152/32000 (4%)] Loss: 0.15541 (QuantReg: 12.57377) QuantErr: 12.57377 batch_time=0.41345 
Train Epoch: 33 [41/1000 1312/32000 (4%)] Loss: 0.17163 (QuantReg: 13.60439) QuantErr: 13.60439 batch_time=0.46159 
Train Epoch: 33 [46/1000 1472/32000 (5%)] Loss: 0.26826 (QuantReg: 12.89725) QuantErr: 12.89725 batch_time=0.40649 
Train Epoch: 33 [51/1000 1632/32000 (5%)] Loss: 0.38250 (QuantReg: 12.80132) QuantErr: 12.80132 batch_time=0.42404 
Train Epoch: 33 [56/1000 1792/32000 (6%)] Loss: 0.21830 (QuantReg: 13.17617) QuantErr: 13.17617 batch_time=0.41177 
Train Epoch: 33 [61/1000 1952/32000 (6%)] Loss: 0.11447 (QuantReg: 12.54340) QuantErr: 12.54340 batch_time=0.38088 
Train Epoch: 33 [66/1000 2112/32000 (7%)] Loss: 0.53483 (QuantReg: 12.43336) QuantErr: 12.43336 batch_time=0.34549 
Train Epoch: 33 [71/1000 2272/32000 (7%)] Loss: 0.86425 (QuantReg: 12.76154) QuantErr: 12.76154 batch_time=0.36968 
Train Epoch: 33 [76/1000 2432/32000 (8%)] Loss: 0.16306 (QuantReg: 12.59550) QuantErr: 12.59550 batch_time=0.38589 
Train Epoch: 33 [81/1000 2592/32000 (8%)] Loss: 0.30396 (QuantReg: 11.87719) QuantErr: 11.87719 batch_time=0.34352 
Train Epoch: 33 [86/1000 2752/32000 (9%)] Loss: 0.36351 (QuantReg: 12.51232) QuantErr: 12.51232 batch_time=0.35548 
Train Epoch: 33 [91/1000 2912/32000 (9%)] Loss: 0.57483 (QuantReg: 12.75362) QuantErr: 12.75362 batch_time=0.40755 
Train Epoch: 33 [96/1000 3072/32000 (10%)] Loss: 0.25037 (QuantReg: 12.60459) QuantErr: 12.60459 batch_time=0.42282 
Train Epoch: 33 [101/1000 3232/32000 (10%)] Loss: 0.30135 (QuantReg: 12.15961) QuantErr: 12.15961 batch_time=0.37486 
Train Epoch: 33 [106/1000 3392/32000 (11%)] Loss: 0.14509 (QuantReg: 12.49990) QuantErr: 12.49990 batch_time=0.48525 
Train Epoch: 33 [111/1000 3552/32000 (11%)] Loss: 0.21830 (QuantReg: 12.24163) QuantErr: 12.24163 batch_time=0.36138 
Train Epoch: 33 [116/1000 3712/32000 (12%)] Loss: 0.21068 (QuantReg: 12.65047) QuantErr: 12.65047 batch_time=0.39804 
Train Epoch: 33 [121/1000 3872/32000 (12%)] Loss: 0.28801 (QuantReg: 12.85821) QuantErr: 12.85821 batch_time=0.37437 
Train Epoch: 33 [126/1000 4032/32000 (13%)] Loss: 0.40796 (QuantReg: 12.71390) QuantErr: 12.71390 batch_time=0.40086 
Train Epoch: 33 [131/1000 4192/32000 (13%)] Loss: 0.21230 (QuantReg: 13.21116) QuantErr: 13.21116 batch_time=0.41700 
Train Epoch: 33 [136/1000 4352/32000 (14%)] Loss: 0.39697 (QuantReg: 12.01829) QuantErr: 12.01829 batch_time=0.40757 
Train Epoch: 33 [141/1000 4512/32000 (14%)] Loss: 0.08039 (QuantReg: 12.81088) QuantErr: 12.81088 batch_time=0.35864 
Train Epoch: 33 [146/1000 4672/32000 (15%)] Loss: 0.21717 (QuantReg: 12.89075) QuantErr: 12.89075 batch_time=0.40584 
Train Epoch: 33 [151/1000 4832/32000 (15%)] Loss: 0.21120 (QuantReg: 13.32702) QuantErr: 13.32702 batch_time=0.36583 
Train Epoch: 33 [156/1000 4992/32000 (16%)] Loss: 0.30305 (QuantReg: 12.99570) QuantErr: 12.99570 batch_time=0.71850 
Train Epoch: 33 [161/1000 5152/32000 (16%)] Loss: 0.27951 (QuantReg: 12.83329) QuantErr: 12.83329 batch_time=0.35114 
Train Epoch: 33 [166/1000 5312/32000 (17%)] Loss: 0.29750 (QuantReg: 12.56950) QuantErr: 12.56950 batch_time=0.34956 
Train Epoch: 33 [171/1000 5472/32000 (17%)] Loss: 0.35621 (QuantReg: 13.00227) QuantErr: 13.00227 batch_time=0.34829 
Train Epoch: 33 [176/1000 5632/32000 (18%)] Loss: 0.20569 (QuantReg: 12.69695) QuantErr: 12.69695 batch_time=0.36913 
Train Epoch: 33 [181/1000 5792/32000 (18%)] Loss: 0.29882 (QuantReg: 12.58739) QuantErr: 12.58739 batch_time=0.36096 
Train Epoch: 33 [186/1000 5952/32000 (19%)] Loss: 0.38354 (QuantReg: 12.59794) QuantErr: 12.59794 batch_time=0.34753 
Train Epoch: 33 [191/1000 6112/32000 (19%)] Loss: 0.24910 (QuantReg: 12.17244) QuantErr: 12.17244 batch_time=0.36356 
Train Epoch: 33 [196/1000 6272/32000 (20%)] Loss: 0.43229 (QuantReg: 11.80994) QuantErr: 11.80994 batch_time=0.34305 
Train Epoch: 33 [201/1000 6432/32000 (20%)] Loss: 0.25935 (QuantReg: 12.49002) QuantErr: 12.49002 batch_time=0.34876 
Train Epoch: 33 [206/1000 6592/32000 (21%)] Loss: 0.09222 (QuantReg: 12.44800) QuantErr: 12.44800 batch_time=0.34529 
Train Epoch: 33 [211/1000 6752/32000 (21%)] Loss: 0.26555 (QuantReg: 12.70643) QuantErr: 12.70643 batch_time=0.35594 
Train Epoch: 33 [216/1000 6912/32000 (22%)] Loss: 0.42624 (QuantReg: 12.41615) QuantErr: 12.41615 batch_time=0.45619 
Train Epoch: 33 [221/1000 7072/32000 (22%)] Loss: 0.09994 (QuantReg: 13.26826) QuantErr: 13.26826 batch_time=0.42719 
Train Epoch: 33 [226/1000 7232/32000 (23%)] Loss: 0.26419 (QuantReg: 12.09778) QuantErr: 12.09778 batch_time=0.35959 
Train Epoch: 33 [231/1000 7392/32000 (23%)] Loss: 0.06257 (QuantReg: 13.04432) QuantErr: 13.04432 batch_time=0.40380 
Train Epoch: 33 [236/1000 7552/32000 (24%)] Loss: 0.44625 (QuantReg: 12.23929) QuantErr: 12.23929 batch_time=0.34930 
Train Epoch: 33 [241/1000 7712/32000 (24%)] Loss: 0.17876 (QuantReg: 12.40542) QuantErr: 12.40542 batch_time=0.36137 
Train Epoch: 33 [246/1000 7872/32000 (25%)] Loss: 0.26887 (QuantReg: 12.91896) QuantErr: 12.91896 batch_time=0.36723 
Train Epoch: 33 [251/1000 8032/32000 (25%)] Loss: 0.84223 (QuantReg: 13.41045) QuantErr: 13.41045 batch_time=0.36970 
Train Epoch: 33 [256/1000 8192/32000 (26%)] Loss: 0.24379 (QuantReg: 12.36283) QuantErr: 12.36283 batch_time=0.38706 
Train Epoch: 33 [261/1000 8352/32000 (26%)] Loss: 0.12861 (QuantReg: 12.77375) QuantErr: 12.77375 batch_time=0.37002 
Train Epoch: 33 [266/1000 8512/32000 (27%)] Loss: 0.28191 (QuantReg: 12.56460) QuantErr: 12.56460 batch_time=0.37743 
Train Epoch: 33 [271/1000 8672/32000 (27%)] Loss: 0.16385 (QuantReg: 12.87065) QuantErr: 12.87065 batch_time=0.35994 
Train Epoch: 33 [276/1000 8832/32000 (28%)] Loss: 0.11952 (QuantReg: 12.39787) QuantErr: 12.39787 batch_time=1.17052 
Train Epoch: 33 [281/1000 8992/32000 (28%)] Loss: 0.26518 (QuantReg: 12.87919) QuantErr: 12.87919 batch_time=0.36262 
Train Epoch: 33 [286/1000 9152/32000 (29%)] Loss: 0.32525 (QuantReg: 12.83260) QuantErr: 12.83260 batch_time=0.42524 
Train Epoch: 33 [291/1000 9312/32000 (29%)] Loss: 0.14012 (QuantReg: 13.22623) QuantErr: 13.22623 batch_time=0.40840 
Train Epoch: 33 [296/1000 9472/32000 (30%)] Loss: 0.26306 (QuantReg: 12.73999) QuantErr: 12.73999 batch_time=0.39257 
Train Epoch: 33 [301/1000 9632/32000 (30%)] Loss: 0.38474 (QuantReg: 12.16323) QuantErr: 12.16323 batch_time=0.34343 
Train Epoch: 33 [306/1000 9792/32000 (31%)] Loss: 0.34653 (QuantReg: 12.76759) QuantErr: 12.76759 batch_time=0.37504 
Train Epoch: 33 [311/1000 9952/32000 (31%)] Loss: 0.54602 (QuantReg: 12.33254) QuantErr: 12.33254 batch_time=0.46236 
Train Epoch: 33 [316/1000 10112/32000 (32%)] Loss: 0.37815 (QuantReg: 13.13464) QuantErr: 13.13464 batch_time=0.46323 
Train Epoch: 33 [321/1000 10272/32000 (32%)] Loss: 0.19565 (QuantReg: 12.86329) QuantErr: 12.86329 batch_time=0.59130 
Train Epoch: 33 [326/1000 10432/32000 (33%)] Loss: 0.43944 (QuantReg: 12.73265) QuantErr: 12.73265 batch_time=0.35563 
Train Epoch: 33 [331/1000 10592/32000 (33%)] Loss: 0.38972 (QuantReg: 13.10661) QuantErr: 13.10661 batch_time=0.36191 
Train Epoch: 33 [336/1000 10752/32000 (34%)] Loss: 0.14819 (QuantReg: 12.72791) QuantErr: 12.72791 batch_time=0.86581 
Train Epoch: 33 [341/1000 10912/32000 (34%)] Loss: 0.37940 (QuantReg: 13.03748) QuantErr: 13.03748 batch_time=0.39935 
Train Epoch: 33 [346/1000 11072/32000 (35%)] Loss: 0.41702 (QuantReg: 13.22570) QuantErr: 13.22570 batch_time=0.34989 
Train Epoch: 33 [351/1000 11232/32000 (35%)] Loss: 0.18118 (QuantReg: 12.85624) QuantErr: 12.85624 batch_time=0.35166 
Train Epoch: 33 [356/1000 11392/32000 (36%)] Loss: 0.30610 (QuantReg: 12.83657) QuantErr: 12.83657 batch_time=0.36976 
Train Epoch: 33 [361/1000 11552/32000 (36%)] Loss: 0.28758 (QuantReg: 12.62329) QuantErr: 12.62329 batch_time=0.38710 
Train Epoch: 33 [366/1000 11712/32000 (37%)] Loss: 0.14185 (QuantReg: 13.00139) QuantErr: 13.00139 batch_time=0.38355 
Train Epoch: 33 [371/1000 11872/32000 (37%)] Loss: 0.10687 (QuantReg: 12.99401) QuantErr: 12.99401 batch_time=0.36487 
Train Epoch: 33 [376/1000 12032/32000 (38%)] Loss: 0.80371 (QuantReg: 12.88424) QuantErr: 12.88424 batch_time=0.43087 
Train Epoch: 33 [381/1000 12192/32000 (38%)] Loss: 0.34700 (QuantReg: 12.59365) QuantErr: 12.59365 batch_time=0.35497 
Train Epoch: 33 [386/1000 12352/32000 (39%)] Loss: 0.22451 (QuantReg: 12.90452) QuantErr: 12.90452 batch_time=0.34983 
Train Epoch: 33 [391/1000 12512/32000 (39%)] Loss: 0.11117 (QuantReg: 13.05681) QuantErr: 13.05681 batch_time=0.35809 
Train Epoch: 33 [396/1000 12672/32000 (40%)] Loss: 0.25416 (QuantReg: 12.89456) QuantErr: 12.89456 batch_time=0.36713 
Train Epoch: 33 [401/1000 12832/32000 (40%)] Loss: 0.15576 (QuantReg: 12.77067) QuantErr: 12.77067 batch_time=0.43265 
Train Epoch: 33 [406/1000 12992/32000 (41%)] Loss: 0.21317 (QuantReg: 12.92395) QuantErr: 12.92395 batch_time=0.34918 
Train Epoch: 33 [411/1000 13152/32000 (41%)] Loss: 0.24618 (QuantReg: 12.13268) QuantErr: 12.13268 batch_time=0.39934 
Train Epoch: 33 [416/1000 13312/32000 (42%)] Loss: 0.40561 (QuantReg: 12.53193) QuantErr: 12.53193 batch_time=0.35734 
Train Epoch: 33 [421/1000 13472/32000 (42%)] Loss: 0.25616 (QuantReg: 13.02512) QuantErr: 13.02512 batch_time=0.35632 
Train Epoch: 33 [426/1000 13632/32000 (43%)] Loss: 0.33142 (QuantReg: 12.74027) QuantErr: 12.74027 batch_time=0.35724 
Train Epoch: 33 [431/1000 13792/32000 (43%)] Loss: 0.17874 (QuantReg: 13.14589) QuantErr: 13.14589 batch_time=0.33598 
Train Epoch: 33 [436/1000 13952/32000 (44%)] Loss: 0.24192 (QuantReg: 13.03490) QuantErr: 13.03490 batch_time=0.38841 
Train Epoch: 33 [441/1000 14112/32000 (44%)] Loss: 0.36982 (QuantReg: 12.39718) QuantErr: 12.39718 batch_time=0.36176 
Train Epoch: 33 [446/1000 14272/32000 (45%)] Loss: 0.26301 (QuantReg: 13.38074) QuantErr: 13.38074 batch_time=0.40152 
Train Epoch: 33 [451/1000 14432/32000 (45%)] Loss: 0.43742 (QuantReg: 13.01448) QuantErr: 13.01448 batch_time=0.43801 
Train Epoch: 33 [456/1000 14592/32000 (46%)] Loss: 0.22818 (QuantReg: 12.68603) QuantErr: 12.68603 batch_time=0.36894 
Train Epoch: 33 [461/1000 14752/32000 (46%)] Loss: 0.40619 (QuantReg: 12.84608) QuantErr: 12.84608 batch_time=0.38241 
Train Epoch: 33 [466/1000 14912/32000 (47%)] Loss: 0.31971 (QuantReg: 13.20675) QuantErr: 13.20675 batch_time=0.35024 
Train Epoch: 33 [471/1000 15072/32000 (47%)] Loss: 0.37116 (QuantReg: 12.24200) QuantErr: 12.24200 batch_time=0.41670 
Train Epoch: 33 [476/1000 15232/32000 (48%)] Loss: 0.23891 (QuantReg: 12.49907) QuantErr: 12.49907 batch_time=0.69434 
Train Epoch: 33 [481/1000 15392/32000 (48%)] Loss: 0.11527 (QuantReg: 12.68656) QuantErr: 12.68656 batch_time=0.37679 
Train Epoch: 33 [486/1000 15552/32000 (49%)] Loss: 0.30987 (QuantReg: 12.59786) QuantErr: 12.59786 batch_time=0.36099 
Train Epoch: 33 [491/1000 15712/32000 (49%)] Loss: 0.21625 (QuantReg: 12.65003) QuantErr: 12.65003 batch_time=0.39288 
Train Epoch: 33 [496/1000 15872/32000 (50%)] Loss: 0.16991 (QuantReg: 13.02855) QuantErr: 13.02855 batch_time=0.40927 
Train Epoch: 33 [501/1000 16032/32000 (50%)] Loss: 0.21518 (QuantReg: 12.19289) QuantErr: 12.19289 batch_time=0.41755 
Train Epoch: 33 [506/1000 16192/32000 (51%)] Loss: 0.34735 (QuantReg: 13.15883) QuantErr: 13.15883 batch_time=0.37100 
Train Epoch: 33 [511/1000 16352/32000 (51%)] Loss: 0.32728 (QuantReg: 12.43183) QuantErr: 12.43183 batch_time=0.35016 
Train Epoch: 33 [516/1000 16512/32000 (52%)] Loss: 0.25604 (QuantReg: 11.73659) QuantErr: 11.73659 batch_time=0.34759 
Train Epoch: 33 [521/1000 16672/32000 (52%)] Loss: 0.18585 (QuantReg: 13.25274) QuantErr: 13.25274 batch_time=0.35074 
Train Epoch: 33 [526/1000 16832/32000 (53%)] Loss: 0.06805 (QuantReg: 13.06180) QuantErr: 13.06180 batch_time=0.36028 
Train Epoch: 33 [531/1000 16992/32000 (53%)] Loss: 0.40088 (QuantReg: 12.33679) QuantErr: 12.33679 batch_time=0.36109 
Train Epoch: 33 [536/1000 17152/32000 (54%)] Loss: 0.40967 (QuantReg: 12.77117) QuantErr: 12.77117 batch_time=0.41616 
Train Epoch: 33 [541/1000 17312/32000 (54%)] Loss: 0.29285 (QuantReg: 12.58545) QuantErr: 12.58545 batch_time=0.33904 
Train Epoch: 33 [546/1000 17472/32000 (55%)] Loss: 0.13636 (QuantReg: 13.10695) QuantErr: 13.10695 batch_time=0.34955 
Train Epoch: 33 [551/1000 17632/32000 (55%)] Loss: 0.44003 (QuantReg: 13.27002) QuantErr: 13.27002 batch_time=0.35075 
Train Epoch: 33 [556/1000 17792/32000 (56%)] Loss: 0.53885 (QuantReg: 12.34174) QuantErr: 12.34174 batch_time=0.35851 
Train Epoch: 33 [561/1000 17952/32000 (56%)] Loss: 0.44987 (QuantReg: 13.00616) QuantErr: 13.00616 batch_time=0.35130 
Train Epoch: 33 [566/1000 18112/32000 (57%)] Loss: 0.17784 (QuantReg: 13.05226) QuantErr: 13.05226 batch_time=0.36841 
Train Epoch: 33 [571/1000 18272/32000 (57%)] Loss: 0.30573 (QuantReg: 12.63564) QuantErr: 12.63564 batch_time=0.39626 
Train Epoch: 33 [576/1000 18432/32000 (58%)] Loss: 0.75346 (QuantReg: 12.60505) QuantErr: 12.60505 batch_time=0.36487 
Train Epoch: 33 [581/1000 18592/32000 (58%)] Loss: 0.12480 (QuantReg: 12.67483) QuantErr: 12.67483 batch_time=0.36730 
Train Epoch: 33 [586/1000 18752/32000 (59%)] Loss: 0.18020 (QuantReg: 12.73584) QuantErr: 12.73584 batch_time=0.34314 
Train Epoch: 33 [591/1000 18912/32000 (59%)] Loss: 0.44872 (QuantReg: 12.78173) QuantErr: 12.78173 batch_time=0.44589 
Train Epoch: 33 [596/1000 19072/32000 (60%)] Loss: 0.23778 (QuantReg: 12.88459) QuantErr: 12.88459 batch_time=1.36828 
Train Epoch: 33 [601/1000 19232/32000 (60%)] Loss: 0.30040 (QuantReg: 12.53107) QuantErr: 12.53107 batch_time=0.37443 
Train Epoch: 33 [606/1000 19392/32000 (61%)] Loss: 0.23303 (QuantReg: 13.04283) QuantErr: 13.04283 batch_time=0.37033 
Train Epoch: 33 [611/1000 19552/32000 (61%)] Loss: 0.35340 (QuantReg: 12.67602) QuantErr: 12.67602 batch_time=0.36807 
Train Epoch: 33 [616/1000 19712/32000 (62%)] Loss: 0.16505 (QuantReg: 12.92789) QuantErr: 12.92789 batch_time=0.37306 
Train Epoch: 33 [621/1000 19872/32000 (62%)] Loss: 0.20004 (QuantReg: 12.83024) QuantErr: 12.83024 batch_time=0.34962 
Train Epoch: 33 [626/1000 20032/32000 (63%)] Loss: 0.26010 (QuantReg: 12.94485) QuantErr: 12.94485 batch_time=0.36792 
Train Epoch: 33 [631/1000 20192/32000 (63%)] Loss: 0.53197 (QuantReg: 12.11401) QuantErr: 12.11401 batch_time=0.34374 
Train Epoch: 33 [636/1000 20352/32000 (64%)] Loss: 0.26359 (QuantReg: 12.10950) QuantErr: 12.10950 batch_time=0.44699 
Train Epoch: 33 [641/1000 20512/32000 (64%)] Loss: 0.18431 (QuantReg: 12.49965) QuantErr: 12.49965 batch_time=0.47232 
Train Epoch: 33 [646/1000 20672/32000 (65%)] Loss: 0.22924 (QuantReg: 12.96851) QuantErr: 12.96851 batch_time=0.35392 
Train Epoch: 33 [651/1000 20832/32000 (65%)] Loss: 0.16582 (QuantReg: 12.37140) QuantErr: 12.37140 batch_time=0.34911 
Train Epoch: 33 [656/1000 20992/32000 (66%)] Loss: 0.26506 (QuantReg: 13.00816) QuantErr: 13.00816 batch_time=0.95012 
Train Epoch: 33 [661/1000 21152/32000 (66%)] Loss: 0.21859 (QuantReg: 13.17338) QuantErr: 13.17338 batch_time=0.38980 
Train Epoch: 33 [666/1000 21312/32000 (67%)] Loss: 0.57026 (QuantReg: 12.59803) QuantErr: 12.59803 batch_time=0.35837 
Train Epoch: 33 [671/1000 21472/32000 (67%)] Loss: 0.60049 (QuantReg: 12.83818) QuantErr: 12.83818 batch_time=0.35018 
Train Epoch: 33 [676/1000 21632/32000 (68%)] Loss: 0.16813 (QuantReg: 12.90816) QuantErr: 12.90816 batch_time=0.35881 
Train Epoch: 33 [681/1000 21792/32000 (68%)] Loss: 0.26948 (QuantReg: 12.80029) QuantErr: 12.80029 batch_time=0.35492 
Train Epoch: 33 [686/1000 21952/32000 (69%)] Loss: 0.83275 (QuantReg: 12.44136) QuantErr: 12.44136 batch_time=0.35021 
Train Epoch: 33 [691/1000 22112/32000 (69%)] Loss: 0.25379 (QuantReg: 13.00102) QuantErr: 13.00102 batch_time=0.34579 
Train Epoch: 33 [696/1000 22272/32000 (70%)] Loss: 0.17739 (QuantReg: 12.35081) QuantErr: 12.35081 batch_time=0.36109 
Train Epoch: 33 [701/1000 22432/32000 (70%)] Loss: 0.62309 (QuantReg: 12.65290) QuantErr: 12.65290 batch_time=0.35219 
Train Epoch: 33 [706/1000 22592/32000 (71%)] Loss: 0.39658 (QuantReg: 12.28045) QuantErr: 12.28045 batch_time=0.36953 
Train Epoch: 33 [711/1000 22752/32000 (71%)] Loss: 0.07887 (QuantReg: 12.75788) QuantErr: 12.75788 batch_time=0.35380 
Train Epoch: 33 [716/1000 22912/32000 (72%)] Loss: 0.16486 (QuantReg: 12.99201) QuantErr: 12.99201 batch_time=0.40167 
Train Epoch: 33 [721/1000 23072/32000 (72%)] Loss: 0.16028 (QuantReg: 12.84334) QuantErr: 12.84334 batch_time=0.35197 
Train Epoch: 33 [726/1000 23232/32000 (73%)] Loss: 0.34746 (QuantReg: 12.99664) QuantErr: 12.99664 batch_time=0.35210 
Train Epoch: 33 [731/1000 23392/32000 (73%)] Loss: 0.15519 (QuantReg: 12.98316) QuantErr: 12.98316 batch_time=0.34310 
Train Epoch: 33 [736/1000 23552/32000 (74%)] Loss: 0.49037 (QuantReg: 12.20052) QuantErr: 12.20052 batch_time=0.35300 
Train Epoch: 33 [741/1000 23712/32000 (74%)] Loss: 0.42888 (QuantReg: 13.03620) QuantErr: 13.03620 batch_time=0.34736 
Train Epoch: 33 [746/1000 23872/32000 (75%)] Loss: 0.21447 (QuantReg: 13.37300) QuantErr: 13.37300 batch_time=0.37828 
Train Epoch: 33 [751/1000 24032/32000 (75%)] Loss: 0.20957 (QuantReg: 12.84478) QuantErr: 12.84478 batch_time=0.40937 
Train Epoch: 33 [756/1000 24192/32000 (76%)] Loss: 0.38600 (QuantReg: 12.59082) QuantErr: 12.59082 batch_time=0.43870 
Train Epoch: 33 [761/1000 24352/32000 (76%)] Loss: 0.24552 (QuantReg: 12.39438) QuantErr: 12.39438 batch_time=0.39061 
Train Epoch: 33 [766/1000 24512/32000 (77%)] Loss: 0.28354 (QuantReg: 12.89011) QuantErr: 12.89011 batch_time=0.37766 
Train Epoch: 33 [771/1000 24672/32000 (77%)] Loss: 0.30830 (QuantReg: 12.72350) QuantErr: 12.72350 batch_time=0.34949 
Train Epoch: 33 [776/1000 24832/32000 (78%)] Loss: 0.28001 (QuantReg: 12.66796) QuantErr: 12.66796 batch_time=0.36270 
Train Epoch: 33 [781/1000 24992/32000 (78%)] Loss: 0.16715 (QuantReg: 12.63735) QuantErr: 12.63735 batch_time=0.34757 
Train Epoch: 33 [786/1000 25152/32000 (79%)] Loss: 0.45626 (QuantReg: 12.82356) QuantErr: 12.82356 batch_time=0.35501 
Train Epoch: 33 [791/1000 25312/32000 (79%)] Loss: 0.39843 (QuantReg: 13.02551) QuantErr: 13.02551 batch_time=0.41001 
Train Epoch: 33 [796/1000 25472/32000 (80%)] Loss: 0.20784 (QuantReg: 12.69494) QuantErr: 12.69494 batch_time=0.64178 
Train Epoch: 33 [801/1000 25632/32000 (80%)] Loss: 0.28174 (QuantReg: 13.15985) QuantErr: 13.15985 batch_time=0.35719 
Train Epoch: 33 [806/1000 25792/32000 (81%)] Loss: 0.13583 (QuantReg: 12.85908) QuantErr: 12.85908 batch_time=0.34888 
Train Epoch: 33 [811/1000 25952/32000 (81%)] Loss: 0.35511 (QuantReg: 12.82930) QuantErr: 12.82930 batch_time=0.35443 
Train Epoch: 33 [816/1000 26112/32000 (82%)] Loss: 0.15744 (QuantReg: 12.92629) QuantErr: 12.92629 batch_time=0.35002 
Train Epoch: 33 [821/1000 26272/32000 (82%)] Loss: 0.25276 (QuantReg: 12.48173) QuantErr: 12.48173 batch_time=0.34586 
Train Epoch: 33 [826/1000 26432/32000 (83%)] Loss: 0.25947 (QuantReg: 12.76678) QuantErr: 12.76678 batch_time=0.34697 
Train Epoch: 33 [831/1000 26592/32000 (83%)] Loss: 0.32344 (QuantReg: 12.69026) QuantErr: 12.69026 batch_time=0.35307 
Train Epoch: 33 [836/1000 26752/32000 (84%)] Loss: 0.14622 (QuantReg: 13.02811) QuantErr: 13.02811 batch_time=0.36097 
Train Epoch: 33 [841/1000 26912/32000 (84%)] Loss: 0.51042 (QuantReg: 12.65727) QuantErr: 12.65727 batch_time=0.34441 
Train Epoch: 33 [846/1000 27072/32000 (85%)] Loss: 0.13728 (QuantReg: 12.85954) QuantErr: 12.85954 batch_time=0.36115 
Train Epoch: 33 [851/1000 27232/32000 (85%)] Loss: 0.28994 (QuantReg: 12.46075) QuantErr: 12.46075 batch_time=0.35026 
Train Epoch: 33 [856/1000 27392/32000 (86%)] Loss: 0.18406 (QuantReg: 12.80924) QuantErr: 12.80924 batch_time=0.35239 
Train Epoch: 33 [861/1000 27552/32000 (86%)] Loss: 0.13687 (QuantReg: 12.32213) QuantErr: 12.32213 batch_time=0.34869 
Train Epoch: 33 [866/1000 27712/32000 (87%)] Loss: 0.34140 (QuantReg: 13.22016) QuantErr: 13.22016 batch_time=0.38117 
Train Epoch: 33 [871/1000 27872/32000 (87%)] Loss: 0.22633 (QuantReg: 13.34517) QuantErr: 13.34517 batch_time=0.36221 
Train Epoch: 33 [876/1000 28032/32000 (88%)] Loss: 0.31057 (QuantReg: 12.45577) QuantErr: 12.45577 batch_time=0.36584 
Train Epoch: 33 [881/1000 28192/32000 (88%)] Loss: 0.54510 (QuantReg: 12.28129) QuantErr: 12.28129 batch_time=0.34170 
Train Epoch: 33 [886/1000 28352/32000 (89%)] Loss: 0.41183 (QuantReg: 12.57859) QuantErr: 12.57859 batch_time=0.34062 
Train Epoch: 33 [891/1000 28512/32000 (89%)] Loss: 0.33135 (QuantReg: 12.62022) QuantErr: 12.62022 batch_time=0.34169 
Train Epoch: 33 [896/1000 28672/32000 (90%)] Loss: 0.59055 (QuantReg: 12.92604) QuantErr: 12.92604 batch_time=0.34164 
Train Epoch: 33 [901/1000 28832/32000 (90%)] Loss: 0.09925 (QuantReg: 12.81212) QuantErr: 12.81212 batch_time=0.33694 
Train Epoch: 33 [906/1000 28992/32000 (91%)] Loss: 0.30398 (QuantReg: 12.37125) QuantErr: 12.37125 batch_time=0.35870 
Train Epoch: 33 [911/1000 29152/32000 (91%)] Loss: 0.33102 (QuantReg: 13.12124) QuantErr: 13.12124 batch_time=0.37900 
Train Epoch: 33 [916/1000 29312/32000 (92%)] Loss: 0.25971 (QuantReg: 12.48097) QuantErr: 12.48097 batch_time=1.41732 
Train Epoch: 33 [921/1000 29472/32000 (92%)] Loss: 0.19202 (QuantReg: 12.95235) QuantErr: 12.95235 batch_time=0.41722 
Train Epoch: 33 [926/1000 29632/32000 (93%)] Loss: 0.44799 (QuantReg: 13.23382) QuantErr: 13.23382 batch_time=0.38163 
Train Epoch: 33 [931/1000 29792/32000 (93%)] Loss: 0.30845 (QuantReg: 12.20626) QuantErr: 12.20626 batch_time=0.34722 
Train Epoch: 33 [936/1000 29952/32000 (94%)] Loss: 0.21585 (QuantReg: 12.03687) QuantErr: 12.03687 batch_time=0.35664 
Train Epoch: 33 [941/1000 30112/32000 (94%)] Loss: 0.47130 (QuantReg: 12.58938) QuantErr: 12.58938 batch_time=0.34386 
Train Epoch: 33 [946/1000 30272/32000 (95%)] Loss: 0.18140 (QuantReg: 12.90969) QuantErr: 12.90969 batch_time=0.34875 
Train Epoch: 33 [951/1000 30432/32000 (95%)] Loss: 0.44333 (QuantReg: 12.44197) QuantErr: 12.44197 batch_time=0.34085 
Train Epoch: 33 [956/1000 30592/32000 (96%)] Loss: 0.25087 (QuantReg: 12.71006) QuantErr: 12.71006 batch_time=0.44185 
Train Epoch: 33 [961/1000 30752/32000 (96%)] Loss: 0.24874 (QuantReg: 13.76799) QuantErr: 13.76799 batch_time=0.49542 
Train Epoch: 33 [966/1000 30912/32000 (97%)] Loss: 0.40078 (QuantReg: 12.82145) QuantErr: 12.82145 batch_time=0.36214 
Train Epoch: 33 [971/1000 31072/32000 (97%)] Loss: 0.25315 (QuantReg: 12.39525) QuantErr: 12.39525 batch_time=0.35796 
Train Epoch: 33 [976/1000 31232/32000 (98%)] Loss: 0.41689 (QuantReg: 12.06934) QuantErr: 12.06934 batch_time=0.92853 
Train Epoch: 33 [981/1000 31392/32000 (98%)] Loss: 0.19086 (QuantReg: 13.04913) QuantErr: 13.04913 batch_time=0.38019 
Train Epoch: 33 [986/1000 31552/32000 (99%)] Loss: 0.52400 (QuantReg: 12.53372) QuantErr: 12.53372 batch_time=0.37447 
Train Epoch: 33 [991/1000 31712/32000 (99%)] Loss: 0.25832 (QuantReg: 12.32332) QuantErr: 12.32332 batch_time=0.35562 
Train Epoch: 33 [996/1000 31872/32000 (100%)] Loss: 0.35690 (QuantReg: 12.93668) QuantErr: 12.93668 batch_time=0.35280 
Train Epoch: 33 codebook_update_time=1.77050
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch33.pth ...
Done in 22.540s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch33.pth ...
Done in 27.115s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 0.32459169141948224
 quant_reg      : 12.708448442459106
 quant_err      : 12.708448442459106
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 33000
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.702213279678069
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.564201862311485
 MSRVTT_full_val/v2t_metrics/R1: 36.01609657947686
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 85.31187122736418
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.346076458752515
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.59524311850871
 MSRVTT_full_test/t2v_metrics/R1: 12.976588628762542
 MSRVTT_full_test/t2v_metrics/R5: 37.02341137123746
 MSRVTT_full_test/t2v_metrics/R10: 50.96989966555184
 MSRVTT_full_test/t2v_metrics/R50: 81.20401337792642
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.20167224080267
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.03912878905051
 MSRVTT_full_test/v2t_metrics/R1: 15.986622073578594
 MSRVTT_full_test/v2t_metrics/R5: 42.408026755852845
 MSRVTT_full_test/v2t_metrics/R10: 57.391304347826086
 MSRVTT_full_test/v2t_metrics/R50: 86.45484949832776
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.1257525083612
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.885738594677534
 mnt_best       : 29.03912878905051
 not_improved_count: 0
Train Epoch: 34 [1/1000 32/32000 (0%)] Loss: 0.40984 (QuantReg: 13.19215) QuantErr: 13.19215 batch_time=30.80812 
Train Epoch: 34 [6/1000 192/32000 (1%)] Loss: 0.22442 (QuantReg: 12.82205) QuantErr: 12.82205 batch_time=0.48567 
Train Epoch: 34 [11/1000 352/32000 (1%)] Loss: 0.49484 (QuantReg: 12.64666) QuantErr: 12.64666 batch_time=0.33942 
Train Epoch: 34 [16/1000 512/32000 (2%)] Loss: 0.38770 (QuantReg: 12.55578) QuantErr: 12.55578 batch_time=0.36912 
Train Epoch: 34 [21/1000 672/32000 (2%)] Loss: 0.55397 (QuantReg: 12.65423) QuantErr: 12.65423 batch_time=0.54265 
Train Epoch: 34 [26/1000 832/32000 (3%)] Loss: 0.23233 (QuantReg: 13.13603) QuantErr: 13.13603 batch_time=0.34483 
Train Epoch: 34 [31/1000 992/32000 (3%)] Loss: 0.20328 (QuantReg: 12.76854) QuantErr: 12.76854 batch_time=0.35183 
Train Epoch: 34 [36/1000 1152/32000 (4%)] Loss: 0.19819 (QuantReg: 12.60037) QuantErr: 12.60037 batch_time=0.34557 
Train Epoch: 34 [41/1000 1312/32000 (4%)] Loss: 0.35359 (QuantReg: 13.28477) QuantErr: 13.28477 batch_time=0.35185 
Train Epoch: 34 [46/1000 1472/32000 (5%)] Loss: 0.18735 (QuantReg: 12.51329) QuantErr: 12.51329 batch_time=0.35001 
Train Epoch: 34 [51/1000 1632/32000 (5%)] Loss: 0.20308 (QuantReg: 12.42789) QuantErr: 12.42789 batch_time=0.34613 
Train Epoch: 34 [56/1000 1792/32000 (6%)] Loss: 0.10409 (QuantReg: 12.65395) QuantErr: 12.65395 batch_time=0.35116 
Train Epoch: 34 [61/1000 1952/32000 (6%)] Loss: 0.45573 (QuantReg: 13.16205) QuantErr: 13.16205 batch_time=0.34438 
Train Epoch: 34 [66/1000 2112/32000 (7%)] Loss: 0.22864 (QuantReg: 12.04489) QuantErr: 12.04489 batch_time=0.39561 
Train Epoch: 34 [71/1000 2272/32000 (7%)] Loss: 0.34468 (QuantReg: 12.79823) QuantErr: 12.79823 batch_time=0.35051 
Train Epoch: 34 [76/1000 2432/32000 (8%)] Loss: 0.31213 (QuantReg: 13.33615) QuantErr: 13.33615 batch_time=0.37965 
Train Epoch: 34 [81/1000 2592/32000 (8%)] Loss: 0.18070 (QuantReg: 12.66328) QuantErr: 12.66328 batch_time=0.61501 
Train Epoch: 34 [86/1000 2752/32000 (9%)] Loss: 0.40178 (QuantReg: 12.12221) QuantErr: 12.12221 batch_time=0.36599 
Train Epoch: 34 [91/1000 2912/32000 (9%)] Loss: 1.05250 (QuantReg: 12.93278) QuantErr: 12.93278 batch_time=0.52486 
Train Epoch: 34 [96/1000 3072/32000 (10%)] Loss: 0.65750 (QuantReg: 13.12977) QuantErr: 13.12977 batch_time=0.34729 
Train Epoch: 34 [101/1000 3232/32000 (10%)] Loss: 0.34026 (QuantReg: 12.25870) QuantErr: 12.25870 batch_time=0.39950 
Train Epoch: 34 [106/1000 3392/32000 (11%)] Loss: 0.48160 (QuantReg: 12.07556) QuantErr: 12.07556 batch_time=0.66841 
Train Epoch: 34 [111/1000 3552/32000 (11%)] Loss: 0.83981 (QuantReg: 10.85342) QuantErr: 10.85342 batch_time=0.37445 
Train Epoch: 34 [116/1000 3712/32000 (12%)] Loss: 0.39320 (QuantReg: 12.78474) QuantErr: 12.78474 batch_time=0.35420 
Train Epoch: 34 [121/1000 3872/32000 (12%)] Loss: 0.15607 (QuantReg: 12.98588) QuantErr: 12.98588 batch_time=0.34180 
Train Epoch: 34 [126/1000 4032/32000 (13%)] Loss: 0.05785 (QuantReg: 13.39227) QuantErr: 13.39227 batch_time=0.34298 
Train Epoch: 34 [131/1000 4192/32000 (13%)] Loss: 0.12544 (QuantReg: 13.02044) QuantErr: 13.02044 batch_time=0.46042 
Train Epoch: 34 [136/1000 4352/32000 (14%)] Loss: 0.47753 (QuantReg: 12.40484) QuantErr: 12.40484 batch_time=0.35610 
Train Epoch: 34 [141/1000 4512/32000 (14%)] Loss: 0.41441 (QuantReg: 12.96750) QuantErr: 12.96750 batch_time=0.34358 
Train Epoch: 34 [146/1000 4672/32000 (15%)] Loss: 0.15348 (QuantReg: 13.00070) QuantErr: 13.00070 batch_time=0.45102 
Train Epoch: 34 [151/1000 4832/32000 (15%)] Loss: 0.25321 (QuantReg: 12.88435) QuantErr: 12.88435 batch_time=0.36406 
Train Epoch: 34 [156/1000 4992/32000 (16%)] Loss: 0.28870 (QuantReg: 12.85041) QuantErr: 12.85041 batch_time=0.33873 
Train Epoch: 34 [161/1000 5152/32000 (16%)] Loss: 0.36642 (QuantReg: 12.87448) QuantErr: 12.87448 batch_time=0.33935 
Train Epoch: 34 [166/1000 5312/32000 (17%)] Loss: 0.18577 (QuantReg: 12.96699) QuantErr: 12.96699 batch_time=0.33918 
Train Epoch: 34 [171/1000 5472/32000 (17%)] Loss: 0.27412 (QuantReg: 13.09368) QuantErr: 13.09368 batch_time=0.36868 
Train Epoch: 34 [176/1000 5632/32000 (18%)] Loss: 0.26963 (QuantReg: 13.38857) QuantErr: 13.38857 batch_time=0.41242 
Train Epoch: 34 [181/1000 5792/32000 (18%)] Loss: 0.40695 (QuantReg: 12.28518) QuantErr: 12.28518 batch_time=0.37615 
Train Epoch: 34 [186/1000 5952/32000 (19%)] Loss: 0.31657 (QuantReg: 12.59089) QuantErr: 12.59089 batch_time=0.36938 
Train Epoch: 34 [191/1000 6112/32000 (19%)] Loss: 0.19799 (QuantReg: 12.95493) QuantErr: 12.95493 batch_time=0.34558 
Train Epoch: 34 [196/1000 6272/32000 (20%)] Loss: 0.21191 (QuantReg: 12.65587) QuantErr: 12.65587 batch_time=0.44054 
Train Epoch: 34 [201/1000 6432/32000 (20%)] Loss: 0.40830 (QuantReg: 12.54463) QuantErr: 12.54463 batch_time=0.34726 
Train Epoch: 34 [206/1000 6592/32000 (21%)] Loss: 0.35496 (QuantReg: 12.56971) QuantErr: 12.56971 batch_time=0.40314 
Train Epoch: 34 [211/1000 6752/32000 (21%)] Loss: 0.23779 (QuantReg: 13.35169) QuantErr: 13.35169 batch_time=0.61781 
Train Epoch: 34 [216/1000 6912/32000 (22%)] Loss: 0.26061 (QuantReg: 12.64796) QuantErr: 12.64796 batch_time=0.65452 
Train Epoch: 34 [221/1000 7072/32000 (22%)] Loss: 0.09344 (QuantReg: 12.66108) QuantErr: 12.66108 batch_time=0.36467 
Train Epoch: 34 [226/1000 7232/32000 (23%)] Loss: 0.71623 (QuantReg: 12.94459) QuantErr: 12.94459 batch_time=0.36583 
Train Epoch: 34 [231/1000 7392/32000 (23%)] Loss: 0.42274 (QuantReg: 12.31148) QuantErr: 12.31148 batch_time=0.35792 
Train Epoch: 34 [236/1000 7552/32000 (24%)] Loss: 0.12667 (QuantReg: 12.99070) QuantErr: 12.99070 batch_time=0.34837 
Train Epoch: 34 [241/1000 7712/32000 (24%)] Loss: 0.32929 (QuantReg: 13.15775) QuantErr: 13.15775 batch_time=0.34543 
Train Epoch: 34 [246/1000 7872/32000 (25%)] Loss: 0.11161 (QuantReg: 12.92718) QuantErr: 12.92718 batch_time=0.36168 
Train Epoch: 34 [251/1000 8032/32000 (25%)] Loss: 0.28445 (QuantReg: 12.35734) QuantErr: 12.35734 batch_time=0.36180 
Train Epoch: 34 [256/1000 8192/32000 (26%)] Loss: 0.51872 (QuantReg: 13.39583) QuantErr: 13.39583 batch_time=0.37076 
Train Epoch: 34 [261/1000 8352/32000 (26%)] Loss: 0.19320 (QuantReg: 12.82369) QuantErr: 12.82369 batch_time=0.36898 
Train Epoch: 34 [266/1000 8512/32000 (27%)] Loss: 0.35330 (QuantReg: 13.09297) QuantErr: 13.09297 batch_time=0.35830 
Train Epoch: 34 [271/1000 8672/32000 (27%)] Loss: 0.21765 (QuantReg: 13.27654) QuantErr: 13.27654 batch_time=0.36898 
Train Epoch: 34 [276/1000 8832/32000 (28%)] Loss: 0.37950 (QuantReg: 12.65432) QuantErr: 12.65432 batch_time=0.35452 
Train Epoch: 34 [281/1000 8992/32000 (28%)] Loss: 0.23368 (QuantReg: 12.79188) QuantErr: 12.79188 batch_time=0.36105 
Train Epoch: 34 [286/1000 9152/32000 (29%)] Loss: 1.00800 (QuantReg: 11.59596) QuantErr: 11.59596 batch_time=0.35290 
Train Epoch: 34 [291/1000 9312/32000 (29%)] Loss: 0.30987 (QuantReg: 13.56276) QuantErr: 13.56276 batch_time=0.34635 
Train Epoch: 34 [296/1000 9472/32000 (30%)] Loss: 0.06109 (QuantReg: 13.49173) QuantErr: 13.49173 batch_time=0.34782 
Train Epoch: 34 [301/1000 9632/32000 (30%)] Loss: 0.48039 (QuantReg: 12.77833) QuantErr: 12.77833 batch_time=0.34761 
Train Epoch: 34 [306/1000 9792/32000 (31%)] Loss: 0.09122 (QuantReg: 12.47681) QuantErr: 12.47681 batch_time=0.40202 
Train Epoch: 34 [311/1000 9952/32000 (31%)] Loss: 0.52144 (QuantReg: 12.39541) QuantErr: 12.39541 batch_time=0.34695 
Train Epoch: 34 [316/1000 10112/32000 (32%)] Loss: 0.13698 (QuantReg: 12.54340) QuantErr: 12.54340 batch_time=0.33841 
Train Epoch: 34 [321/1000 10272/32000 (32%)] Loss: 0.27674 (QuantReg: 12.46338) QuantErr: 12.46338 batch_time=0.34257 
Train Epoch: 34 [326/1000 10432/32000 (33%)] Loss: 0.05077 (QuantReg: 12.81624) QuantErr: 12.81624 batch_time=0.49157 
Train Epoch: 34 [331/1000 10592/32000 (33%)] Loss: 0.60068 (QuantReg: 12.56020) QuantErr: 12.56020 batch_time=0.35075 
Train Epoch: 34 [336/1000 10752/32000 (34%)] Loss: 0.48740 (QuantReg: 12.87027) QuantErr: 12.87027 batch_time=0.37926 
Train Epoch: 34 [341/1000 10912/32000 (34%)] Loss: 0.25007 (QuantReg: 13.32242) QuantErr: 13.32242 batch_time=0.46737 
Train Epoch: 34 [346/1000 11072/32000 (35%)] Loss: 0.42018 (QuantReg: 12.87017) QuantErr: 12.87017 batch_time=0.37499 
Train Epoch: 34 [351/1000 11232/32000 (35%)] Loss: 0.53824 (QuantReg: 12.67424) QuantErr: 12.67424 batch_time=0.34712 
Train Epoch: 34 [356/1000 11392/32000 (36%)] Loss: 0.35137 (QuantReg: 12.84444) QuantErr: 12.84444 batch_time=0.35978 
Train Epoch: 34 [361/1000 11552/32000 (36%)] Loss: 0.62931 (QuantReg: 12.14214) QuantErr: 12.14214 batch_time=0.36001 
Train Epoch: 34 [366/1000 11712/32000 (37%)] Loss: 0.21761 (QuantReg: 12.72259) QuantErr: 12.72259 batch_time=0.36064 
Train Epoch: 34 [371/1000 11872/32000 (37%)] Loss: 0.93307 (QuantReg: 12.56613) QuantErr: 12.56613 batch_time=0.43435 
Train Epoch: 34 [376/1000 12032/32000 (38%)] Loss: 0.30283 (QuantReg: 12.82724) QuantErr: 12.82724 batch_time=0.41151 
Train Epoch: 34 [381/1000 12192/32000 (38%)] Loss: 0.37883 (QuantReg: 11.32650) QuantErr: 11.32650 batch_time=0.37401 
Train Epoch: 34 [386/1000 12352/32000 (39%)] Loss: 0.47758 (QuantReg: 13.13971) QuantErr: 13.13971 batch_time=0.41753 
Train Epoch: 34 [391/1000 12512/32000 (39%)] Loss: 0.33087 (QuantReg: 12.97442) QuantErr: 12.97442 batch_time=0.34745 
Train Epoch: 34 [396/1000 12672/32000 (40%)] Loss: 0.07385 (QuantReg: 12.63107) QuantErr: 12.63107 batch_time=0.34866 
Train Epoch: 34 [401/1000 12832/32000 (40%)] Loss: 0.36569 (QuantReg: 12.46779) QuantErr: 12.46779 batch_time=0.56152 
Train Epoch: 34 [406/1000 12992/32000 (41%)] Loss: 0.30502 (QuantReg: 12.11771) QuantErr: 12.11771 batch_time=0.37221 
Train Epoch: 34 [411/1000 13152/32000 (41%)] Loss: 0.62623 (QuantReg: 12.80251) QuantErr: 12.80251 batch_time=0.61600 
Train Epoch: 34 [416/1000 13312/32000 (42%)] Loss: 0.31451 (QuantReg: 12.33173) QuantErr: 12.33173 batch_time=0.38190 
Train Epoch: 34 [421/1000 13472/32000 (42%)] Loss: 0.41574 (QuantReg: 12.91396) QuantErr: 12.91396 batch_time=0.35234 
Train Epoch: 34 [426/1000 13632/32000 (43%)] Loss: 0.57762 (QuantReg: 12.94593) QuantErr: 12.94593 batch_time=0.72203 
Train Epoch: 34 [431/1000 13792/32000 (43%)] Loss: 0.56435 (QuantReg: 12.72260) QuantErr: 12.72260 batch_time=0.35471 
Train Epoch: 34 [436/1000 13952/32000 (44%)] Loss: 0.32730 (QuantReg: 12.26151) QuantErr: 12.26151 batch_time=0.37782 
Train Epoch: 34 [441/1000 14112/32000 (44%)] Loss: 0.09242 (QuantReg: 12.85894) QuantErr: 12.85894 batch_time=0.38420 
Train Epoch: 34 [446/1000 14272/32000 (45%)] Loss: 0.73589 (QuantReg: 12.97515) QuantErr: 12.97515 batch_time=0.36587 
Train Epoch: 34 [451/1000 14432/32000 (45%)] Loss: 0.57731 (QuantReg: 12.39421) QuantErr: 12.39421 batch_time=0.46892 
Train Epoch: 34 [456/1000 14592/32000 (46%)] Loss: 0.26867 (QuantReg: 13.58711) QuantErr: 13.58711 batch_time=0.36071 
Train Epoch: 34 [461/1000 14752/32000 (46%)] Loss: 0.36771 (QuantReg: 12.22363) QuantErr: 12.22363 batch_time=0.34447 
Train Epoch: 34 [466/1000 14912/32000 (47%)] Loss: 0.22763 (QuantReg: 13.00136) QuantErr: 13.00136 batch_time=0.46491 
Train Epoch: 34 [471/1000 15072/32000 (47%)] Loss: 0.11481 (QuantReg: 12.67472) QuantErr: 12.67472 batch_time=0.38043 
Train Epoch: 34 [476/1000 15232/32000 (48%)] Loss: 0.28865 (QuantReg: 13.33937) QuantErr: 13.33937 batch_time=0.42531 
Train Epoch: 34 [481/1000 15392/32000 (48%)] Loss: 0.59359 (QuantReg: 12.55048) QuantErr: 12.55048 batch_time=0.37012 
Train Epoch: 34 [486/1000 15552/32000 (49%)] Loss: 0.46219 (QuantReg: 12.28969) QuantErr: 12.28969 batch_time=0.37655 
Train Epoch: 34 [491/1000 15712/32000 (49%)] Loss: 0.16442 (QuantReg: 12.99270) QuantErr: 12.99270 batch_time=0.35300 
Train Epoch: 34 [496/1000 15872/32000 (50%)] Loss: 0.12835 (QuantReg: 12.88566) QuantErr: 12.88566 batch_time=0.34939 
Train Epoch: 34 [501/1000 16032/32000 (50%)] Loss: 0.31416 (QuantReg: 12.74824) QuantErr: 12.74824 batch_time=0.39604 
Train Epoch: 34 [506/1000 16192/32000 (51%)] Loss: 0.30541 (QuantReg: 12.67302) QuantErr: 12.67302 batch_time=0.49009 
Train Epoch: 34 [511/1000 16352/32000 (51%)] Loss: 0.55770 (QuantReg: 12.54208) QuantErr: 12.54208 batch_time=0.36496 
Train Epoch: 34 [516/1000 16512/32000 (52%)] Loss: 0.27355 (QuantReg: 12.59684) QuantErr: 12.59684 batch_time=0.47421 
Train Epoch: 34 [521/1000 16672/32000 (52%)] Loss: 0.53968 (QuantReg: 12.94282) QuantErr: 12.94282 batch_time=0.40800 
Train Epoch: 34 [526/1000 16832/32000 (53%)] Loss: 0.27926 (QuantReg: 12.81590) QuantErr: 12.81590 batch_time=0.42007 
Train Epoch: 34 [531/1000 16992/32000 (53%)] Loss: 0.23954 (QuantReg: 12.70353) QuantErr: 12.70353 batch_time=0.55352 
Train Epoch: 34 [536/1000 17152/32000 (54%)] Loss: 0.58028 (QuantReg: 12.53818) QuantErr: 12.53818 batch_time=0.70958 
Train Epoch: 34 [541/1000 17312/32000 (54%)] Loss: 0.33061 (QuantReg: 12.98216) QuantErr: 12.98216 batch_time=0.42859 
Train Epoch: 34 [546/1000 17472/32000 (55%)] Loss: 0.12730 (QuantReg: 12.33850) QuantErr: 12.33850 batch_time=0.42488 
Train Epoch: 34 [551/1000 17632/32000 (55%)] Loss: 0.39933 (QuantReg: 13.05725) QuantErr: 13.05725 batch_time=0.34631 
Train Epoch: 34 [556/1000 17792/32000 (56%)] Loss: 0.14891 (QuantReg: 12.99364) QuantErr: 12.99364 batch_time=0.34747 
Train Epoch: 34 [561/1000 17952/32000 (56%)] Loss: 0.21172 (QuantReg: 13.05287) QuantErr: 13.05287 batch_time=0.36954 
Train Epoch: 34 [566/1000 18112/32000 (57%)] Loss: 0.22078 (QuantReg: 12.46411) QuantErr: 12.46411 batch_time=0.44143 
Train Epoch: 34 [571/1000 18272/32000 (57%)] Loss: 0.33950 (QuantReg: 13.07369) QuantErr: 13.07369 batch_time=0.41714 
Train Epoch: 34 [576/1000 18432/32000 (58%)] Loss: 0.17899 (QuantReg: 13.18596) QuantErr: 13.18596 batch_time=0.41075 
Train Epoch: 34 [581/1000 18592/32000 (58%)] Loss: 0.21583 (QuantReg: 12.28817) QuantErr: 12.28817 batch_time=0.39831 
Train Epoch: 34 [586/1000 18752/32000 (59%)] Loss: 0.13720 (QuantReg: 12.69387) QuantErr: 12.69387 batch_time=0.41607 
Train Epoch: 34 [591/1000 18912/32000 (59%)] Loss: 0.16670 (QuantReg: 12.97152) QuantErr: 12.97152 batch_time=0.35879 
Train Epoch: 34 [596/1000 19072/32000 (60%)] Loss: 0.28543 (QuantReg: 12.52492) QuantErr: 12.52492 batch_time=0.36949 
Train Epoch: 34 [601/1000 19232/32000 (60%)] Loss: 0.36982 (QuantReg: 12.82584) QuantErr: 12.82584 batch_time=0.35544 
Train Epoch: 34 [606/1000 19392/32000 (61%)] Loss: 0.26832 (QuantReg: 12.77053) QuantErr: 12.77053 batch_time=0.39871 
Train Epoch: 34 [611/1000 19552/32000 (61%)] Loss: 0.62123 (QuantReg: 12.02617) QuantErr: 12.02617 batch_time=0.37771 
Train Epoch: 34 [616/1000 19712/32000 (62%)] Loss: 0.29102 (QuantReg: 12.83202) QuantErr: 12.83202 batch_time=0.45390 
Train Epoch: 34 [621/1000 19872/32000 (62%)] Loss: 0.39102 (QuantReg: 12.77069) QuantErr: 12.77069 batch_time=0.35689 
Train Epoch: 34 [626/1000 20032/32000 (63%)] Loss: 0.47488 (QuantReg: 12.98737) QuantErr: 12.98737 batch_time=0.46081 
Train Epoch: 34 [631/1000 20192/32000 (63%)] Loss: 0.30698 (QuantReg: 12.74045) QuantErr: 12.74045 batch_time=0.44262 
Train Epoch: 34 [636/1000 20352/32000 (64%)] Loss: 0.35690 (QuantReg: 12.33861) QuantErr: 12.33861 batch_time=0.37341 
Train Epoch: 34 [641/1000 20512/32000 (64%)] Loss: 0.20224 (QuantReg: 12.63361) QuantErr: 12.63361 batch_time=0.37273 
Train Epoch: 34 [646/1000 20672/32000 (65%)] Loss: 0.39244 (QuantReg: 13.04573) QuantErr: 13.04573 batch_time=0.51436 
Train Epoch: 34 [651/1000 20832/32000 (65%)] Loss: 0.29710 (QuantReg: 12.58716) QuantErr: 12.58716 batch_time=0.40232 
Train Epoch: 34 [656/1000 20992/32000 (66%)] Loss: 0.11869 (QuantReg: 13.12278) QuantErr: 13.12278 batch_time=0.38067 
Train Epoch: 34 [661/1000 21152/32000 (66%)] Loss: 0.18277 (QuantReg: 12.61505) QuantErr: 12.61505 batch_time=0.46818 
Train Epoch: 34 [666/1000 21312/32000 (67%)] Loss: 0.24807 (QuantReg: 13.05424) QuantErr: 13.05424 batch_time=0.35038 
Train Epoch: 34 [671/1000 21472/32000 (67%)] Loss: 0.24445 (QuantReg: 12.99303) QuantErr: 12.99303 batch_time=0.37280 
Train Epoch: 34 [676/1000 21632/32000 (68%)] Loss: 0.30973 (QuantReg: 12.30529) QuantErr: 12.30529 batch_time=0.37650 
Train Epoch: 34 [681/1000 21792/32000 (68%)] Loss: 0.25967 (QuantReg: 12.82022) QuantErr: 12.82022 batch_time=0.35867 
Train Epoch: 34 [686/1000 21952/32000 (69%)] Loss: 0.15486 (QuantReg: 13.17016) QuantErr: 13.17016 batch_time=0.36958 
Train Epoch: 34 [691/1000 22112/32000 (69%)] Loss: 0.15156 (QuantReg: 12.67067) QuantErr: 12.67067 batch_time=0.40779 
Train Epoch: 34 [696/1000 22272/32000 (70%)] Loss: 0.21396 (QuantReg: 12.34255) QuantErr: 12.34255 batch_time=0.36058 
Train Epoch: 34 [701/1000 22432/32000 (70%)] Loss: 0.27337 (QuantReg: 12.44943) QuantErr: 12.44943 batch_time=0.37331 
Train Epoch: 34 [706/1000 22592/32000 (71%)] Loss: 0.21436 (QuantReg: 13.05512) QuantErr: 13.05512 batch_time=0.41245 
Train Epoch: 34 [711/1000 22752/32000 (71%)] Loss: 0.34541 (QuantReg: 13.32014) QuantErr: 13.32014 batch_time=0.41200 
Train Epoch: 34 [716/1000 22912/32000 (72%)] Loss: 0.73427 (QuantReg: 12.36924) QuantErr: 12.36924 batch_time=0.40659 
Train Epoch: 34 [721/1000 23072/32000 (72%)] Loss: 0.26556 (QuantReg: 12.58182) QuantErr: 12.58182 batch_time=0.56102 
Train Epoch: 34 [726/1000 23232/32000 (73%)] Loss: 0.20272 (QuantReg: 13.24759) QuantErr: 13.24759 batch_time=0.37470 
Train Epoch: 34 [731/1000 23392/32000 (73%)] Loss: 0.31822 (QuantReg: 12.92404) QuantErr: 12.92404 batch_time=0.58420 
Train Epoch: 34 [736/1000 23552/32000 (74%)] Loss: 0.48988 (QuantReg: 13.08724) QuantErr: 13.08724 batch_time=0.37227 
Train Epoch: 34 [741/1000 23712/32000 (74%)] Loss: 0.46929 (QuantReg: 12.41941) QuantErr: 12.41941 batch_time=0.34027 
Train Epoch: 34 [746/1000 23872/32000 (75%)] Loss: 0.37555 (QuantReg: 12.34822) QuantErr: 12.34822 batch_time=0.63480 
Train Epoch: 34 [751/1000 24032/32000 (75%)] Loss: 0.04251 (QuantReg: 12.73375) QuantErr: 12.73375 batch_time=0.34251 
Train Epoch: 34 [756/1000 24192/32000 (76%)] Loss: 0.48513 (QuantReg: 12.51672) QuantErr: 12.51672 batch_time=0.37914 
Train Epoch: 34 [761/1000 24352/32000 (76%)] Loss: 0.23341 (QuantReg: 12.71939) QuantErr: 12.71939 batch_time=0.44617 
Train Epoch: 34 [766/1000 24512/32000 (77%)] Loss: 0.53936 (QuantReg: 12.29474) QuantErr: 12.29474 batch_time=0.38909 
Train Epoch: 34 [771/1000 24672/32000 (77%)] Loss: 0.19022 (QuantReg: 12.87276) QuantErr: 12.87276 batch_time=0.48151 
Train Epoch: 34 [776/1000 24832/32000 (78%)] Loss: 0.41793 (QuantReg: 12.53497) QuantErr: 12.53497 batch_time=0.40092 
Train Epoch: 34 [781/1000 24992/32000 (78%)] Loss: 0.68983 (QuantReg: 12.61343) QuantErr: 12.61343 batch_time=0.35872 
Train Epoch: 34 [786/1000 25152/32000 (79%)] Loss: 0.22429 (QuantReg: 12.49679) QuantErr: 12.49679 batch_time=0.47039 
Train Epoch: 34 [791/1000 25312/32000 (79%)] Loss: 0.30800 (QuantReg: 12.53833) QuantErr: 12.53833 batch_time=0.39991 
Train Epoch: 34 [796/1000 25472/32000 (80%)] Loss: 0.27623 (QuantReg: 12.59737) QuantErr: 12.59737 batch_time=0.36572 
Train Epoch: 34 [801/1000 25632/32000 (80%)] Loss: 0.38494 (QuantReg: 12.80054) QuantErr: 12.80054 batch_time=0.35794 
Train Epoch: 34 [806/1000 25792/32000 (81%)] Loss: 0.18044 (QuantReg: 13.16389) QuantErr: 13.16389 batch_time=0.34900 
Train Epoch: 34 [811/1000 25952/32000 (81%)] Loss: 0.47386 (QuantReg: 12.74665) QuantErr: 12.74665 batch_time=0.34868 
Train Epoch: 34 [816/1000 26112/32000 (82%)] Loss: 0.53882 (QuantReg: 12.51910) QuantErr: 12.51910 batch_time=0.35289 
Train Epoch: 34 [821/1000 26272/32000 (82%)] Loss: 0.24372 (QuantReg: 13.01392) QuantErr: 13.01392 batch_time=0.36519 
Train Epoch: 34 [826/1000 26432/32000 (83%)] Loss: 0.55942 (QuantReg: 12.55162) QuantErr: 12.55162 batch_time=0.39843 
Train Epoch: 34 [831/1000 26592/32000 (83%)] Loss: 0.38257 (QuantReg: 12.88625) QuantErr: 12.88625 batch_time=0.37239 
Train Epoch: 34 [836/1000 26752/32000 (84%)] Loss: 0.32276 (QuantReg: 12.62364) QuantErr: 12.62364 batch_time=0.46969 
Train Epoch: 34 [841/1000 26912/32000 (84%)] Loss: 0.55187 (QuantReg: 12.61492) QuantErr: 12.61492 batch_time=0.35949 
Train Epoch: 34 [846/1000 27072/32000 (85%)] Loss: 0.42214 (QuantReg: 12.71196) QuantErr: 12.71196 batch_time=0.40765 
Train Epoch: 34 [851/1000 27232/32000 (85%)] Loss: 0.63962 (QuantReg: 12.49483) QuantErr: 12.49483 batch_time=0.54426 
Train Epoch: 34 [856/1000 27392/32000 (86%)] Loss: 0.21268 (QuantReg: 12.85342) QuantErr: 12.85342 batch_time=0.65506 
Train Epoch: 34 [861/1000 27552/32000 (86%)] Loss: 0.13231 (QuantReg: 12.80295) QuantErr: 12.80295 batch_time=0.39293 
Train Epoch: 34 [866/1000 27712/32000 (87%)] Loss: 0.10003 (QuantReg: 12.21315) QuantErr: 12.21315 batch_time=0.37009 
Train Epoch: 34 [871/1000 27872/32000 (87%)] Loss: 0.25004 (QuantReg: 13.22690) QuantErr: 13.22690 batch_time=0.35067 
Train Epoch: 34 [876/1000 28032/32000 (88%)] Loss: 0.34934 (QuantReg: 12.77155) QuantErr: 12.77155 batch_time=0.36377 
Train Epoch: 34 [881/1000 28192/32000 (88%)] Loss: 0.16646 (QuantReg: 12.42490) QuantErr: 12.42490 batch_time=0.35523 
Train Epoch: 34 [886/1000 28352/32000 (89%)] Loss: 0.31647 (QuantReg: 12.09110) QuantErr: 12.09110 batch_time=0.34252 
Train Epoch: 34 [891/1000 28512/32000 (89%)] Loss: 0.23618 (QuantReg: 12.67421) QuantErr: 12.67421 batch_time=0.38687 
Train Epoch: 34 [896/1000 28672/32000 (90%)] Loss: 0.43122 (QuantReg: 12.70119) QuantErr: 12.70119 batch_time=0.36125 
Train Epoch: 34 [901/1000 28832/32000 (90%)] Loss: 0.23858 (QuantReg: 12.81769) QuantErr: 12.81769 batch_time=0.34222 
Train Epoch: 34 [906/1000 28992/32000 (91%)] Loss: 0.33454 (QuantReg: 12.63627) QuantErr: 12.63627 batch_time=0.36710 
Train Epoch: 34 [911/1000 29152/32000 (91%)] Loss: 0.20739 (QuantReg: 12.01410) QuantErr: 12.01410 batch_time=0.34409 
Train Epoch: 34 [916/1000 29312/32000 (92%)] Loss: 0.34040 (QuantReg: 13.04395) QuantErr: 13.04395 batch_time=0.42328 
Train Epoch: 34 [921/1000 29472/32000 (92%)] Loss: 0.19024 (QuantReg: 13.21160) QuantErr: 13.21160 batch_time=0.48784 
Train Epoch: 34 [926/1000 29632/32000 (93%)] Loss: 0.23135 (QuantReg: 12.37990) QuantErr: 12.37990 batch_time=0.38316 
Train Epoch: 34 [931/1000 29792/32000 (93%)] Loss: 1.07053 (QuantReg: 11.99358) QuantErr: 11.99358 batch_time=0.43093 
Train Epoch: 34 [936/1000 29952/32000 (94%)] Loss: 0.03629 (QuantReg: 12.75182) QuantErr: 12.75182 batch_time=0.41756 
Train Epoch: 34 [941/1000 30112/32000 (94%)] Loss: 0.10280 (QuantReg: 13.12060) QuantErr: 13.12060 batch_time=0.42314 
Train Epoch: 34 [946/1000 30272/32000 (95%)] Loss: 0.37686 (QuantReg: 13.32605) QuantErr: 13.32605 batch_time=0.46300 
Train Epoch: 34 [951/1000 30432/32000 (95%)] Loss: 0.17102 (QuantReg: 13.29192) QuantErr: 13.29192 batch_time=0.36507 
Train Epoch: 34 [956/1000 30592/32000 (96%)] Loss: 0.34661 (QuantReg: 13.18666) QuantErr: 13.18666 batch_time=0.41661 
Train Epoch: 34 [961/1000 30752/32000 (96%)] Loss: 0.47966 (QuantReg: 12.93513) QuantErr: 12.93513 batch_time=0.38640 
Train Epoch: 34 [966/1000 30912/32000 (97%)] Loss: 0.82232 (QuantReg: 12.21443) QuantErr: 12.21443 batch_time=0.61037 
Train Epoch: 34 [971/1000 31072/32000 (97%)] Loss: 0.35575 (QuantReg: 12.67970) QuantErr: 12.67970 batch_time=0.35693 
Train Epoch: 34 [976/1000 31232/32000 (98%)] Loss: 0.53901 (QuantReg: 13.16546) QuantErr: 13.16546 batch_time=0.39864 
Train Epoch: 34 [981/1000 31392/32000 (98%)] Loss: 0.56793 (QuantReg: 11.91349) QuantErr: 11.91349 batch_time=0.46289 
Train Epoch: 34 [986/1000 31552/32000 (99%)] Loss: 0.35018 (QuantReg: 12.66510) QuantErr: 12.66510 batch_time=0.37679 
Train Epoch: 34 [991/1000 31712/32000 (99%)] Loss: 0.25063 (QuantReg: 12.76319) QuantErr: 12.76319 batch_time=0.38792 
Train Epoch: 34 [996/1000 31872/32000 (100%)] Loss: 0.89018 (QuantReg: 12.66349) QuantErr: 12.66349 batch_time=0.36406 
Train Epoch: 34 codebook_update_time=1.87060
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch34.pth ...
Done in 12.326s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 0.329243385784328
 quant_reg      : 12.708719120025634
 quant_err      : 12.708719120025634
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 34000
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.611670020120724
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.821150750475326
 MSRVTT_full_val/v2t_metrics/R1: 39.436619718309856
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.983903420523139
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.706263644142496
 MSRVTT_full_test/t2v_metrics/R1: 12.775919732441471
 MSRVTT_full_test/t2v_metrics/R5: 37.19063545150502
 MSRVTT_full_test/t2v_metrics/R10: 51.20401337792642
 MSRVTT_full_test/t2v_metrics/R50: 81.50501672240803
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.62207357859532
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.976321968242765
 MSRVTT_full_test/v2t_metrics/R1: 16.8561872909699
 MSRVTT_full_test/v2t_metrics/R5: 43.01003344481605
 MSRVTT_full_test/v2t_metrics/R10: 58.12709030100334
 MSRVTT_full_test/v2t_metrics/R50: 87.02341137123746
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.72809364548495
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.799198184328844
 mnt_best       : 29.03912878905051
 not_improved_count: 1
Train Epoch: 35 [1/1000 32/32000 (0%)] Loss: 0.24393 (QuantReg: 12.52636) QuantErr: 12.52636 batch_time=27.52051 
Train Epoch: 35 [6/1000 192/32000 (1%)] Loss: 0.20526 (QuantReg: 12.82404) QuantErr: 12.82404 batch_time=0.34263 
Train Epoch: 35 [11/1000 352/32000 (1%)] Loss: 0.22903 (QuantReg: 12.60203) QuantErr: 12.60203 batch_time=0.37022 
Train Epoch: 35 [16/1000 512/32000 (2%)] Loss: 0.32475 (QuantReg: 12.26831) QuantErr: 12.26831 batch_time=1.93807 
Train Epoch: 35 [21/1000 672/32000 (2%)] Loss: 0.18927 (QuantReg: 12.60504) QuantErr: 12.60504 batch_time=0.39047 
Train Epoch: 35 [26/1000 832/32000 (3%)] Loss: 0.38427 (QuantReg: 12.10504) QuantErr: 12.10504 batch_time=0.36804 
Train Epoch: 35 [31/1000 992/32000 (3%)] Loss: 0.17060 (QuantReg: 12.77648) QuantErr: 12.77648 batch_time=0.40006 
Train Epoch: 35 [36/1000 1152/32000 (4%)] Loss: 0.12908 (QuantReg: 13.15627) QuantErr: 13.15627 batch_time=0.38101 
Train Epoch: 35 [41/1000 1312/32000 (4%)] Loss: 0.51563 (QuantReg: 12.75123) QuantErr: 12.75123 batch_time=0.36902 
Train Epoch: 35 [46/1000 1472/32000 (5%)] Loss: 1.19677 (QuantReg: 12.74199) QuantErr: 12.74199 batch_time=0.33850 
Train Epoch: 35 [51/1000 1632/32000 (5%)] Loss: 0.26356 (QuantReg: 12.74921) QuantErr: 12.74921 batch_time=0.33869 
Train Epoch: 35 [56/1000 1792/32000 (6%)] Loss: 0.38510 (QuantReg: 12.23816) QuantErr: 12.23816 batch_time=0.34029 
Train Epoch: 35 [61/1000 1952/32000 (6%)] Loss: 0.54865 (QuantReg: 13.11025) QuantErr: 13.11025 batch_time=0.33989 
Train Epoch: 35 [66/1000 2112/32000 (7%)] Loss: 0.12629 (QuantReg: 13.69922) QuantErr: 13.69922 batch_time=0.50816 
Train Epoch: 35 [71/1000 2272/32000 (7%)] Loss: 0.58972 (QuantReg: 12.55280) QuantErr: 12.55280 batch_time=0.35986 
Train Epoch: 35 [76/1000 2432/32000 (8%)] Loss: 0.28216 (QuantReg: 13.00689) QuantErr: 13.00689 batch_time=0.35985 
Train Epoch: 35 [81/1000 2592/32000 (8%)] Loss: 0.53147 (QuantReg: 12.89346) QuantErr: 12.89346 batch_time=0.34085 
Train Epoch: 35 [86/1000 2752/32000 (9%)] Loss: 0.32680 (QuantReg: 12.02751) QuantErr: 12.02751 batch_time=0.34466 
Train Epoch: 35 [91/1000 2912/32000 (9%)] Loss: 0.16241 (QuantReg: 13.12609) QuantErr: 13.12609 batch_time=0.35001 
Train Epoch: 35 [96/1000 3072/32000 (10%)] Loss: 0.24972 (QuantReg: 12.82030) QuantErr: 12.82030 batch_time=0.43413 
Train Epoch: 35 [101/1000 3232/32000 (10%)] Loss: 0.44470 (QuantReg: 12.65339) QuantErr: 12.65339 batch_time=0.33580 
Train Epoch: 35 [106/1000 3392/32000 (11%)] Loss: 0.26697 (QuantReg: 12.67850) QuantErr: 12.67850 batch_time=0.42783 
Train Epoch: 35 [111/1000 3552/32000 (11%)] Loss: 0.19051 (QuantReg: 13.67549) QuantErr: 13.67549 batch_time=0.37027 
Train Epoch: 35 [116/1000 3712/32000 (12%)] Loss: 0.38943 (QuantReg: 12.91018) QuantErr: 12.91018 batch_time=0.34519 
Train Epoch: 35 [121/1000 3872/32000 (12%)] Loss: 0.19036 (QuantReg: 12.50876) QuantErr: 12.50876 batch_time=0.38114 
Train Epoch: 35 [126/1000 4032/32000 (13%)] Loss: 0.24970 (QuantReg: 13.23825) QuantErr: 13.23825 batch_time=0.38072 
Train Epoch: 35 [131/1000 4192/32000 (13%)] Loss: 0.40573 (QuantReg: 12.92797) QuantErr: 12.92797 batch_time=0.35325 
Train Epoch: 35 [136/1000 4352/32000 (14%)] Loss: 0.61426 (QuantReg: 11.76345) QuantErr: 11.76345 batch_time=0.35083 
Train Epoch: 35 [141/1000 4512/32000 (14%)] Loss: 0.45005 (QuantReg: 13.43337) QuantErr: 13.43337 batch_time=0.34756 
Train Epoch: 35 [146/1000 4672/32000 (15%)] Loss: 0.36559 (QuantReg: 12.87269) QuantErr: 12.87269 batch_time=0.36256 
Train Epoch: 35 [151/1000 4832/32000 (15%)] Loss: 0.34418 (QuantReg: 12.63635) QuantErr: 12.63635 batch_time=0.36092 
Train Epoch: 35 [156/1000 4992/32000 (16%)] Loss: 0.46276 (QuantReg: 12.94026) QuantErr: 12.94026 batch_time=0.34848 
Train Epoch: 35 [161/1000 5152/32000 (16%)] Loss: 0.34679 (QuantReg: 12.80519) QuantErr: 12.80519 batch_time=0.34602 
Train Epoch: 35 [166/1000 5312/32000 (17%)] Loss: 0.13628 (QuantReg: 13.14012) QuantErr: 13.14012 batch_time=0.35461 
Train Epoch: 35 [171/1000 5472/32000 (17%)] Loss: 0.28848 (QuantReg: 12.82835) QuantErr: 12.82835 batch_time=0.37892 
Train Epoch: 35 [176/1000 5632/32000 (18%)] Loss: 0.40592 (QuantReg: 12.64631) QuantErr: 12.64631 batch_time=0.36455 
Train Epoch: 35 [181/1000 5792/32000 (18%)] Loss: 0.29017 (QuantReg: 12.87831) QuantErr: 12.87831 batch_time=0.36476 
Train Epoch: 35 [186/1000 5952/32000 (19%)] Loss: 0.25427 (QuantReg: 12.93790) QuantErr: 12.93790 batch_time=0.36661 
Train Epoch: 35 [191/1000 6112/32000 (19%)] Loss: 0.79545 (QuantReg: 11.90629) QuantErr: 11.90629 batch_time=0.35111 
Train Epoch: 35 [196/1000 6272/32000 (20%)] Loss: 0.16704 (QuantReg: 12.59566) QuantErr: 12.59566 batch_time=0.34875 
Train Epoch: 35 [201/1000 6432/32000 (20%)] Loss: 0.36307 (QuantReg: 12.67393) QuantErr: 12.67393 batch_time=0.35248 
Train Epoch: 35 [206/1000 6592/32000 (21%)] Loss: 0.43061 (QuantReg: 12.80447) QuantErr: 12.80447 batch_time=0.57464 
Train Epoch: 35 [211/1000 6752/32000 (21%)] Loss: 0.55212 (QuantReg: 12.02701) QuantErr: 12.02701 batch_time=0.49337 
Train Epoch: 35 [216/1000 6912/32000 (22%)] Loss: 0.07808 (QuantReg: 12.80731) QuantErr: 12.80731 batch_time=0.34280 
Train Epoch: 35 [221/1000 7072/32000 (22%)] Loss: 0.54616 (QuantReg: 12.38105) QuantErr: 12.38105 batch_time=0.37524 
Train Epoch: 35 [226/1000 7232/32000 (23%)] Loss: 0.13539 (QuantReg: 12.95363) QuantErr: 12.95363 batch_time=0.51184 
Train Epoch: 35 [231/1000 7392/32000 (23%)] Loss: 0.52143 (QuantReg: 12.48044) QuantErr: 12.48044 batch_time=0.34301 
Train Epoch: 35 [236/1000 7552/32000 (24%)] Loss: 0.38387 (QuantReg: 12.11134) QuantErr: 12.11134 batch_time=0.42691 
Train Epoch: 35 [241/1000 7712/32000 (24%)] Loss: 0.11299 (QuantReg: 12.17160) QuantErr: 12.17160 batch_time=0.44288 
Train Epoch: 35 [246/1000 7872/32000 (25%)] Loss: 0.14887 (QuantReg: 12.18460) QuantErr: 12.18460 batch_time=0.50973 
Train Epoch: 35 [251/1000 8032/32000 (25%)] Loss: 0.50003 (QuantReg: 12.51563) QuantErr: 12.51563 batch_time=0.37386 
Train Epoch: 35 [256/1000 8192/32000 (26%)] Loss: 0.42373 (QuantReg: 12.96257) QuantErr: 12.96257 batch_time=0.37564 
Train Epoch: 35 [261/1000 8352/32000 (26%)] Loss: 0.18207 (QuantReg: 12.26567) QuantErr: 12.26567 batch_time=0.42067 
Train Epoch: 35 [266/1000 8512/32000 (27%)] Loss: 0.20512 (QuantReg: 13.39932) QuantErr: 13.39932 batch_time=0.37454 
Train Epoch: 35 [271/1000 8672/32000 (27%)] Loss: 0.10753 (QuantReg: 12.88278) QuantErr: 12.88278 batch_time=0.35230 
Train Epoch: 35 [276/1000 8832/32000 (28%)] Loss: 0.26820 (QuantReg: 12.20317) QuantErr: 12.20317 batch_time=0.34781 
Train Epoch: 35 [281/1000 8992/32000 (28%)] Loss: 1.14039 (QuantReg: 12.64151) QuantErr: 12.64151 batch_time=0.38284 
Train Epoch: 35 [286/1000 9152/32000 (29%)] Loss: 0.29200 (QuantReg: 12.46777) QuantErr: 12.46777 batch_time=0.37042 
Train Epoch: 35 [291/1000 9312/32000 (29%)] Loss: 0.40048 (QuantReg: 12.20221) QuantErr: 12.20221 batch_time=0.40732 
Train Epoch: 35 [296/1000 9472/32000 (30%)] Loss: 0.23357 (QuantReg: 12.60482) QuantErr: 12.60482 batch_time=0.36526 
Train Epoch: 35 [301/1000 9632/32000 (30%)] Loss: 0.36754 (QuantReg: 13.53422) QuantErr: 13.53422 batch_time=0.39680 
Train Epoch: 35 [306/1000 9792/32000 (31%)] Loss: 0.29859 (QuantReg: 13.19616) QuantErr: 13.19616 batch_time=0.34649 
Train Epoch: 35 [311/1000 9952/32000 (31%)] Loss: 0.52430 (QuantReg: 12.52549) QuantErr: 12.52549 batch_time=0.37593 
Train Epoch: 35 [316/1000 10112/32000 (32%)] Loss: 0.16118 (QuantReg: 13.35691) QuantErr: 13.35691 batch_time=0.38949 
Train Epoch: 35 [321/1000 10272/32000 (32%)] Loss: 0.36132 (QuantReg: 12.72677) QuantErr: 12.72677 batch_time=0.42022 
Train Epoch: 35 [326/1000 10432/32000 (33%)] Loss: 0.50035 (QuantReg: 12.26909) QuantErr: 12.26909 batch_time=0.43791 
Train Epoch: 35 [331/1000 10592/32000 (33%)] Loss: 0.21582 (QuantReg: 12.78293) QuantErr: 12.78293 batch_time=0.35407 
Train Epoch: 35 [336/1000 10752/32000 (34%)] Loss: 0.46377 (QuantReg: 12.39687) QuantErr: 12.39687 batch_time=1.34971 
Train Epoch: 35 [341/1000 10912/32000 (34%)] Loss: 0.32435 (QuantReg: 12.76374) QuantErr: 12.76374 batch_time=0.34438 
Train Epoch: 35 [346/1000 11072/32000 (35%)] Loss: 0.27477 (QuantReg: 12.38635) QuantErr: 12.38635 batch_time=0.34034 
Train Epoch: 35 [351/1000 11232/32000 (35%)] Loss: 0.44976 (QuantReg: 12.84103) QuantErr: 12.84103 batch_time=0.33679 
Train Epoch: 35 [356/1000 11392/32000 (36%)] Loss: 0.44010 (QuantReg: 12.27453) QuantErr: 12.27453 batch_time=0.35724 
Train Epoch: 35 [361/1000 11552/32000 (36%)] Loss: 0.24646 (QuantReg: 12.89527) QuantErr: 12.89527 batch_time=0.35521 
Train Epoch: 35 [366/1000 11712/32000 (37%)] Loss: 0.22675 (QuantReg: 12.40159) QuantErr: 12.40159 batch_time=0.36310 
Train Epoch: 35 [371/1000 11872/32000 (37%)] Loss: 0.55395 (QuantReg: 12.28320) QuantErr: 12.28320 batch_time=0.39596 
Train Epoch: 35 [376/1000 12032/32000 (38%)] Loss: 0.28140 (QuantReg: 12.74152) QuantErr: 12.74152 batch_time=0.38291 
Train Epoch: 35 [381/1000 12192/32000 (38%)] Loss: 0.35639 (QuantReg: 12.50948) QuantErr: 12.50948 batch_time=0.37691 
Train Epoch: 35 [386/1000 12352/32000 (39%)] Loss: 0.47974 (QuantReg: 12.74386) QuantErr: 12.74386 batch_time=0.50704 
Train Epoch: 35 [391/1000 12512/32000 (39%)] Loss: 0.22929 (QuantReg: 12.38722) QuantErr: 12.38722 batch_time=0.37823 
Train Epoch: 35 [396/1000 12672/32000 (40%)] Loss: 0.23196 (QuantReg: 12.65448) QuantErr: 12.65448 batch_time=0.34986 
Train Epoch: 35 [401/1000 12832/32000 (40%)] Loss: 0.14411 (QuantReg: 12.62663) QuantErr: 12.62663 batch_time=0.35853 
Train Epoch: 35 [406/1000 12992/32000 (41%)] Loss: 0.16805 (QuantReg: 13.19899) QuantErr: 13.19899 batch_time=0.34681 
Train Epoch: 35 [411/1000 13152/32000 (41%)] Loss: 0.39597 (QuantReg: 12.37023) QuantErr: 12.37023 batch_time=0.36250 
Train Epoch: 35 [416/1000 13312/32000 (42%)] Loss: 0.27920 (QuantReg: 12.84795) QuantErr: 12.84795 batch_time=0.35958 
Train Epoch: 35 [421/1000 13472/32000 (42%)] Loss: 0.10270 (QuantReg: 12.46249) QuantErr: 12.46249 batch_time=0.48730 
Train Epoch: 35 [426/1000 13632/32000 (43%)] Loss: 0.11170 (QuantReg: 12.96984) QuantErr: 12.96984 batch_time=0.49169 
Train Epoch: 35 [431/1000 13792/32000 (43%)] Loss: 0.21917 (QuantReg: 12.49082) QuantErr: 12.49082 batch_time=0.36847 
Train Epoch: 35 [436/1000 13952/32000 (44%)] Loss: 0.26323 (QuantReg: 12.39159) QuantErr: 12.39159 batch_time=0.42264 
Train Epoch: 35 [441/1000 14112/32000 (44%)] Loss: 0.20052 (QuantReg: 13.00981) QuantErr: 13.00981 batch_time=0.43570 
Train Epoch: 35 [446/1000 14272/32000 (45%)] Loss: 0.10991 (QuantReg: 12.59491) QuantErr: 12.59491 batch_time=0.38079 
Train Epoch: 35 [451/1000 14432/32000 (45%)] Loss: 0.36421 (QuantReg: 12.68959) QuantErr: 12.68959 batch_time=0.35333 
Train Epoch: 35 [456/1000 14592/32000 (46%)] Loss: 0.32611 (QuantReg: 13.19877) QuantErr: 13.19877 batch_time=0.35848 
Train Epoch: 35 [461/1000 14752/32000 (46%)] Loss: 0.17667 (QuantReg: 12.88258) QuantErr: 12.88258 batch_time=0.41250 
Train Epoch: 35 [466/1000 14912/32000 (47%)] Loss: 0.27736 (QuantReg: 12.40908) QuantErr: 12.40908 batch_time=0.36297 
Train Epoch: 35 [471/1000 15072/32000 (47%)] Loss: 0.13287 (QuantReg: 12.91898) QuantErr: 12.91898 batch_time=0.37467 
Train Epoch: 35 [476/1000 15232/32000 (48%)] Loss: 0.53648 (QuantReg: 12.04518) QuantErr: 12.04518 batch_time=0.35095 
Train Epoch: 35 [481/1000 15392/32000 (48%)] Loss: 0.29549 (QuantReg: 12.83712) QuantErr: 12.83712 batch_time=0.36283 
Train Epoch: 35 [486/1000 15552/32000 (49%)] Loss: 0.32265 (QuantReg: 12.52573) QuantErr: 12.52573 batch_time=0.34843 
Train Epoch: 35 [491/1000 15712/32000 (49%)] Loss: 0.18779 (QuantReg: 12.72835) QuantErr: 12.72835 batch_time=0.34185 
Train Epoch: 35 [496/1000 15872/32000 (50%)] Loss: 0.22923 (QuantReg: 12.86045) QuantErr: 12.86045 batch_time=0.37111 
Train Epoch: 35 [501/1000 16032/32000 (50%)] Loss: 0.29535 (QuantReg: 12.48964) QuantErr: 12.48964 batch_time=0.40759 
Train Epoch: 35 [506/1000 16192/32000 (51%)] Loss: 0.63165 (QuantReg: 12.66690) QuantErr: 12.66690 batch_time=0.38173 
Train Epoch: 35 [511/1000 16352/32000 (51%)] Loss: 0.80247 (QuantReg: 12.41263) QuantErr: 12.41263 batch_time=0.38836 
Train Epoch: 35 [516/1000 16512/32000 (52%)] Loss: 0.11811 (QuantReg: 12.94761) QuantErr: 12.94761 batch_time=0.39598 
Train Epoch: 35 [521/1000 16672/32000 (52%)] Loss: 0.47060 (QuantReg: 12.66702) QuantErr: 12.66702 batch_time=0.41263 
Train Epoch: 35 [526/1000 16832/32000 (53%)] Loss: 0.30705 (QuantReg: 12.41590) QuantErr: 12.41590 batch_time=0.63102 
Train Epoch: 35 [531/1000 16992/32000 (53%)] Loss: 0.23091 (QuantReg: 12.94839) QuantErr: 12.94839 batch_time=0.52622 
Train Epoch: 35 [536/1000 17152/32000 (54%)] Loss: 0.13882 (QuantReg: 13.09902) QuantErr: 13.09902 batch_time=0.34621 
Train Epoch: 35 [541/1000 17312/32000 (54%)] Loss: 0.45431 (QuantReg: 13.10774) QuantErr: 13.10774 batch_time=0.38422 
Train Epoch: 35 [546/1000 17472/32000 (55%)] Loss: 0.08241 (QuantReg: 12.53824) QuantErr: 12.53824 batch_time=0.53166 
Train Epoch: 35 [551/1000 17632/32000 (55%)] Loss: 0.32095 (QuantReg: 12.54941) QuantErr: 12.54941 batch_time=0.35588 
Train Epoch: 35 [556/1000 17792/32000 (56%)] Loss: 0.18739 (QuantReg: 12.86801) QuantErr: 12.86801 batch_time=0.37333 
Train Epoch: 35 [561/1000 17952/32000 (56%)] Loss: 0.29152 (QuantReg: 12.83587) QuantErr: 12.83587 batch_time=0.40405 
Train Epoch: 35 [566/1000 18112/32000 (57%)] Loss: 0.75117 (QuantReg: 12.54693) QuantErr: 12.54693 batch_time=0.36813 
Train Epoch: 35 [571/1000 18272/32000 (57%)] Loss: 0.11742 (QuantReg: 13.12788) QuantErr: 13.12788 batch_time=0.37164 
Train Epoch: 35 [576/1000 18432/32000 (58%)] Loss: 0.35862 (QuantReg: 13.14349) QuantErr: 13.14349 batch_time=0.35034 
Train Epoch: 35 [581/1000 18592/32000 (58%)] Loss: 0.44440 (QuantReg: 13.08961) QuantErr: 13.08961 batch_time=0.34920 
Train Epoch: 35 [586/1000 18752/32000 (59%)] Loss: 0.35093 (QuantReg: 12.91160) QuantErr: 12.91160 batch_time=0.40527 
Train Epoch: 35 [591/1000 18912/32000 (59%)] Loss: 0.44813 (QuantReg: 13.12822) QuantErr: 13.12822 batch_time=0.40276 
Train Epoch: 35 [596/1000 19072/32000 (60%)] Loss: 0.29607 (QuantReg: 12.58799) QuantErr: 12.58799 batch_time=0.38742 
Train Epoch: 35 [601/1000 19232/32000 (60%)] Loss: 0.15062 (QuantReg: 12.86026) QuantErr: 12.86026 batch_time=0.39544 
Train Epoch: 35 [606/1000 19392/32000 (61%)] Loss: 0.21356 (QuantReg: 12.40612) QuantErr: 12.40612 batch_time=0.38229 
Train Epoch: 35 [611/1000 19552/32000 (61%)] Loss: 0.37301 (QuantReg: 12.89990) QuantErr: 12.89990 batch_time=0.45576 
Train Epoch: 35 [616/1000 19712/32000 (62%)] Loss: 0.42444 (QuantReg: 12.74492) QuantErr: 12.74492 batch_time=0.38869 
Train Epoch: 35 [621/1000 19872/32000 (62%)] Loss: 0.16877 (QuantReg: 13.16153) QuantErr: 13.16153 batch_time=0.40352 
Train Epoch: 35 [626/1000 20032/32000 (63%)] Loss: 0.37996 (QuantReg: 12.56261) QuantErr: 12.56261 batch_time=0.37841 
Train Epoch: 35 [631/1000 20192/32000 (63%)] Loss: 0.26004 (QuantReg: 13.16635) QuantErr: 13.16635 batch_time=0.37539 
Train Epoch: 35 [636/1000 20352/32000 (64%)] Loss: 0.52026 (QuantReg: 12.81550) QuantErr: 12.81550 batch_time=0.35282 
Train Epoch: 35 [641/1000 20512/32000 (64%)] Loss: 0.17497 (QuantReg: 13.45128) QuantErr: 13.45128 batch_time=0.38583 
Train Epoch: 35 [646/1000 20672/32000 (65%)] Loss: 0.45351 (QuantReg: 12.46048) QuantErr: 12.46048 batch_time=0.35425 
Train Epoch: 35 [651/1000 20832/32000 (65%)] Loss: 0.24444 (QuantReg: 12.82932) QuantErr: 12.82932 batch_time=0.35210 
Train Epoch: 35 [656/1000 20992/32000 (66%)] Loss: 0.29740 (QuantReg: 12.68816) QuantErr: 12.68816 batch_time=1.42548 
Train Epoch: 35 [661/1000 21152/32000 (66%)] Loss: 0.33873 (QuantReg: 13.41911) QuantErr: 13.41911 batch_time=0.40116 
Train Epoch: 35 [666/1000 21312/32000 (67%)] Loss: 0.23349 (QuantReg: 12.45852) QuantErr: 12.45852 batch_time=0.37178 
Train Epoch: 35 [671/1000 21472/32000 (67%)] Loss: 0.17352 (QuantReg: 13.02140) QuantErr: 13.02140 batch_time=0.42265 
Train Epoch: 35 [676/1000 21632/32000 (68%)] Loss: 0.43692 (QuantReg: 12.16095) QuantErr: 12.16095 batch_time=0.37971 
Train Epoch: 35 [681/1000 21792/32000 (68%)] Loss: 0.25255 (QuantReg: 12.93358) QuantErr: 12.93358 batch_time=0.35087 
Train Epoch: 35 [686/1000 21952/32000 (69%)] Loss: 0.43513 (QuantReg: 13.01618) QuantErr: 13.01618 batch_time=0.37077 
Train Epoch: 35 [691/1000 22112/32000 (69%)] Loss: 0.44139 (QuantReg: 12.71301) QuantErr: 12.71301 batch_time=0.41441 
Train Epoch: 35 [696/1000 22272/32000 (70%)] Loss: 0.19606 (QuantReg: 12.76396) QuantErr: 12.76396 batch_time=0.37354 
Train Epoch: 35 [701/1000 22432/32000 (70%)] Loss: 0.61428 (QuantReg: 12.79852) QuantErr: 12.79852 batch_time=0.35060 
Train Epoch: 35 [706/1000 22592/32000 (71%)] Loss: 0.12130 (QuantReg: 13.19699) QuantErr: 13.19699 batch_time=0.52989 
Train Epoch: 35 [711/1000 22752/32000 (71%)] Loss: 0.18821 (QuantReg: 13.31723) QuantErr: 13.31723 batch_time=0.35243 
Train Epoch: 35 [716/1000 22912/32000 (72%)] Loss: 0.17594 (QuantReg: 12.63798) QuantErr: 12.63798 batch_time=0.37731 
Train Epoch: 35 [721/1000 23072/32000 (72%)] Loss: 0.26919 (QuantReg: 12.68705) QuantErr: 12.68705 batch_time=0.39342 
Train Epoch: 35 [726/1000 23232/32000 (73%)] Loss: 0.14865 (QuantReg: 12.75957) QuantErr: 12.75957 batch_time=0.34787 
Train Epoch: 35 [731/1000 23392/32000 (73%)] Loss: 0.42825 (QuantReg: 12.33812) QuantErr: 12.33812 batch_time=0.36643 
Train Epoch: 35 [736/1000 23552/32000 (74%)] Loss: 0.53742 (QuantReg: 12.65964) QuantErr: 12.65964 batch_time=0.39606 
Train Epoch: 35 [741/1000 23712/32000 (74%)] Loss: 0.51178 (QuantReg: 13.36904) QuantErr: 13.36904 batch_time=0.38424 
Train Epoch: 35 [746/1000 23872/32000 (75%)] Loss: 0.68774 (QuantReg: 12.27049) QuantErr: 12.27049 batch_time=0.50520 
Train Epoch: 35 [751/1000 24032/32000 (75%)] Loss: 0.07696 (QuantReg: 12.87011) QuantErr: 12.87011 batch_time=0.42837 
Train Epoch: 35 [756/1000 24192/32000 (76%)] Loss: 0.28195 (QuantReg: 12.55573) QuantErr: 12.55573 batch_time=0.37208 
Train Epoch: 35 [761/1000 24352/32000 (76%)] Loss: 0.81667 (QuantReg: 12.35283) QuantErr: 12.35283 batch_time=0.38318 
Train Epoch: 35 [766/1000 24512/32000 (77%)] Loss: 0.40014 (QuantReg: 13.13054) QuantErr: 13.13054 batch_time=0.39791 
Train Epoch: 35 [771/1000 24672/32000 (77%)] Loss: 0.44607 (QuantReg: 12.49967) QuantErr: 12.49967 batch_time=0.34852 
Train Epoch: 35 [776/1000 24832/32000 (78%)] Loss: 0.13975 (QuantReg: 12.69689) QuantErr: 12.69689 batch_time=0.35374 
Train Epoch: 35 [781/1000 24992/32000 (78%)] Loss: 0.30948 (QuantReg: 12.60425) QuantErr: 12.60425 batch_time=0.35431 
Train Epoch: 35 [786/1000 25152/32000 (79%)] Loss: 0.18948 (QuantReg: 12.61384) QuantErr: 12.61384 batch_time=0.34902 
Train Epoch: 35 [791/1000 25312/32000 (79%)] Loss: 0.34483 (QuantReg: 12.45329) QuantErr: 12.45329 batch_time=0.35221 
Train Epoch: 35 [796/1000 25472/32000 (80%)] Loss: 0.42651 (QuantReg: 12.72985) QuantErr: 12.72985 batch_time=0.36218 
Train Epoch: 35 [801/1000 25632/32000 (80%)] Loss: 0.10830 (QuantReg: 12.53643) QuantErr: 12.53643 batch_time=0.36710 
Train Epoch: 35 [806/1000 25792/32000 (81%)] Loss: 0.65369 (QuantReg: 12.21409) QuantErr: 12.21409 batch_time=0.39015 
Train Epoch: 35 [811/1000 25952/32000 (81%)] Loss: 0.31951 (QuantReg: 13.00989) QuantErr: 13.00989 batch_time=0.41206 
Train Epoch: 35 [816/1000 26112/32000 (82%)] Loss: 0.54224 (QuantReg: 12.66320) QuantErr: 12.66320 batch_time=0.41115 
Train Epoch: 35 [821/1000 26272/32000 (82%)] Loss: 0.35644 (QuantReg: 13.33202) QuantErr: 13.33202 batch_time=0.43152 
Train Epoch: 35 [826/1000 26432/32000 (83%)] Loss: 0.21942 (QuantReg: 12.50268) QuantErr: 12.50268 batch_time=0.35726 
Train Epoch: 35 [831/1000 26592/32000 (83%)] Loss: 0.15565 (QuantReg: 12.79271) QuantErr: 12.79271 batch_time=0.35373 
Train Epoch: 35 [836/1000 26752/32000 (84%)] Loss: 0.50168 (QuantReg: 13.05046) QuantErr: 13.05046 batch_time=0.34860 
Train Epoch: 35 [841/1000 26912/32000 (84%)] Loss: 0.32893 (QuantReg: 12.49122) QuantErr: 12.49122 batch_time=0.35496 
Train Epoch: 35 [846/1000 27072/32000 (85%)] Loss: 0.33755 (QuantReg: 13.06599) QuantErr: 13.06599 batch_time=0.60887 
Train Epoch: 35 [851/1000 27232/32000 (85%)] Loss: 0.28210 (QuantReg: 12.50886) QuantErr: 12.50886 batch_time=0.49478 
Train Epoch: 35 [856/1000 27392/32000 (86%)] Loss: 0.41308 (QuantReg: 12.61479) QuantErr: 12.61479 batch_time=0.34955 
Train Epoch: 35 [861/1000 27552/32000 (86%)] Loss: 0.31411 (QuantReg: 13.13502) QuantErr: 13.13502 batch_time=0.37225 
Train Epoch: 35 [866/1000 27712/32000 (87%)] Loss: 0.94961 (QuantReg: 12.87448) QuantErr: 12.87448 batch_time=0.51512 
Train Epoch: 35 [871/1000 27872/32000 (87%)] Loss: 0.39226 (QuantReg: 12.94757) QuantErr: 12.94757 batch_time=0.40260 
Train Epoch: 35 [876/1000 28032/32000 (88%)] Loss: 0.53032 (QuantReg: 12.27389) QuantErr: 12.27389 batch_time=0.31334 
Train Epoch: 35 [881/1000 28192/32000 (88%)] Loss: 0.30700 (QuantReg: 13.01184) QuantErr: 13.01184 batch_time=0.46038 
Train Epoch: 35 [886/1000 28352/32000 (89%)] Loss: 0.13235 (QuantReg: 13.06777) QuantErr: 13.06777 batch_time=0.39106 
Train Epoch: 35 [891/1000 28512/32000 (89%)] Loss: 0.40752 (QuantReg: 12.20195) QuantErr: 12.20195 batch_time=0.39826 
Train Epoch: 35 [896/1000 28672/32000 (90%)] Loss: 0.50184 (QuantReg: 12.03437) QuantErr: 12.03437 batch_time=0.37469 
Train Epoch: 35 [901/1000 28832/32000 (90%)] Loss: 0.47679 (QuantReg: 12.66590) QuantErr: 12.66590 batch_time=0.38445 
Train Epoch: 35 [906/1000 28992/32000 (91%)] Loss: 0.32966 (QuantReg: 12.66388) QuantErr: 12.66388 batch_time=0.42510 
Train Epoch: 35 [911/1000 29152/32000 (91%)] Loss: 0.54402 (QuantReg: 12.76743) QuantErr: 12.76743 batch_time=0.35227 
Train Epoch: 35 [916/1000 29312/32000 (92%)] Loss: 0.14819 (QuantReg: 12.63967) QuantErr: 12.63967 batch_time=0.35077 
Train Epoch: 35 [921/1000 29472/32000 (92%)] Loss: 0.21570 (QuantReg: 13.01353) QuantErr: 13.01353 batch_time=0.35590 
Train Epoch: 35 [926/1000 29632/32000 (93%)] Loss: 0.34084 (QuantReg: 13.13589) QuantErr: 13.13589 batch_time=0.35092 
Train Epoch: 35 [931/1000 29792/32000 (93%)] Loss: 0.25349 (QuantReg: 13.10816) QuantErr: 13.10816 batch_time=0.42074 
Train Epoch: 35 [936/1000 29952/32000 (94%)] Loss: 0.22403 (QuantReg: 12.88294) QuantErr: 12.88294 batch_time=0.36756 
Train Epoch: 35 [941/1000 30112/32000 (94%)] Loss: 0.35920 (QuantReg: 12.84174) QuantErr: 12.84174 batch_time=0.37267 
Train Epoch: 35 [946/1000 30272/32000 (95%)] Loss: 0.61919 (QuantReg: 12.94970) QuantErr: 12.94970 batch_time=0.35607 
Train Epoch: 35 [951/1000 30432/32000 (95%)] Loss: 0.34456 (QuantReg: 12.54023) QuantErr: 12.54023 batch_time=0.40125 
Train Epoch: 35 [956/1000 30592/32000 (96%)] Loss: 0.11776 (QuantReg: 12.50876) QuantErr: 12.50876 batch_time=0.36531 
Train Epoch: 35 [961/1000 30752/32000 (96%)] Loss: 0.16371 (QuantReg: 13.22462) QuantErr: 13.22462 batch_time=0.38525 
Train Epoch: 35 [966/1000 30912/32000 (97%)] Loss: 0.58331 (QuantReg: 13.10569) QuantErr: 13.10569 batch_time=0.35386 
Train Epoch: 35 [971/1000 31072/32000 (97%)] Loss: 0.16211 (QuantReg: 12.89407) QuantErr: 12.89407 batch_time=0.35035 
Train Epoch: 35 [976/1000 31232/32000 (98%)] Loss: 0.22544 (QuantReg: 12.80816) QuantErr: 12.80816 batch_time=1.37727 
Train Epoch: 35 [981/1000 31392/32000 (98%)] Loss: 0.23066 (QuantReg: 12.78584) QuantErr: 12.78584 batch_time=0.36286 
Train Epoch: 35 [986/1000 31552/32000 (99%)] Loss: 0.69926 (QuantReg: 12.64907) QuantErr: 12.64907 batch_time=0.34937 
Train Epoch: 35 [991/1000 31712/32000 (99%)] Loss: 0.13902 (QuantReg: 12.63180) QuantErr: 12.63180 batch_time=0.35931 
Train Epoch: 35 [996/1000 31872/32000 (100%)] Loss: 0.17238 (QuantReg: 13.18932) QuantErr: 13.18932 batch_time=0.36646 
Train Epoch: 35 codebook_update_time=1.78146
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch35.pth ...
Done in 9.044s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch35.pth ...
Done in 13.682s
removing stale ckpt [epoch 34] [took 0.01s]
 epoch          : 35
 loss           : 0.3222104199193418
 quant_reg      : 12.714691102027894
 quant_err      : 12.714691102027894
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 35000
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 70.82494969818913
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.12877263581489
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.13386173781678
 MSRVTT_full_val/v2t_metrics/R1: 37.223340040241446
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.231388329979879
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.6167530865019
 MSRVTT_full_test/t2v_metrics/R1: 13.277591973244148
 MSRVTT_full_test/t2v_metrics/R5: 36.95652173913044
 MSRVTT_full_test/t2v_metrics/R10: 50.836120401337794
 MSRVTT_full_test/t2v_metrics/R50: 80.80267558528428
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.49364548494983
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.218703131434403
 MSRVTT_full_test/v2t_metrics/R1: 16.254180602006688
 MSRVTT_full_test/v2t_metrics/R5: 43.87959866220736
 MSRVTT_full_test/v2t_metrics/R10: 57.69230769230769
 MSRVTT_full_test/v2t_metrics/R50: 86.42140468227424
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.726755852842814
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.52353138139942
 mnt_best       : 29.218703131434403
 not_improved_count: 0
Train Epoch: 36 [1/1000 32/32000 (0%)] Loss: 0.44166 (QuantReg: 12.65637) QuantErr: 12.65637 batch_time=26.51037 
Train Epoch: 36 [6/1000 192/32000 (1%)] Loss: 0.25194 (QuantReg: 13.07753) QuantErr: 13.07753 batch_time=0.43072 
Train Epoch: 36 [11/1000 352/32000 (1%)] Loss: 0.19758 (QuantReg: 12.70187) QuantErr: 12.70187 batch_time=0.34113 
Train Epoch: 36 [16/1000 512/32000 (2%)] Loss: 0.39901 (QuantReg: 12.54026) QuantErr: 12.54026 batch_time=1.29503 
Train Epoch: 36 [21/1000 672/32000 (2%)] Loss: 0.12448 (QuantReg: 12.60097) QuantErr: 12.60097 batch_time=0.34717 
Train Epoch: 36 [26/1000 832/32000 (3%)] Loss: 0.59309 (QuantReg: 12.74359) QuantErr: 12.74359 batch_time=0.36049 
Train Epoch: 36 [31/1000 992/32000 (3%)] Loss: 0.24580 (QuantReg: 12.38487) QuantErr: 12.38487 batch_time=0.42293 
Train Epoch: 36 [36/1000 1152/32000 (4%)] Loss: 0.35413 (QuantReg: 12.58311) QuantErr: 12.58311 batch_time=0.42687 
Train Epoch: 36 [41/1000 1312/32000 (4%)] Loss: 0.52534 (QuantReg: 12.61409) QuantErr: 12.61409 batch_time=0.43404 
Train Epoch: 36 [46/1000 1472/32000 (5%)] Loss: 0.45889 (QuantReg: 12.48620) QuantErr: 12.48620 batch_time=0.36418 
Train Epoch: 36 [51/1000 1632/32000 (5%)] Loss: 0.19985 (QuantReg: 12.68414) QuantErr: 12.68414 batch_time=0.36097 
Train Epoch: 36 [56/1000 1792/32000 (6%)] Loss: 0.36223 (QuantReg: 12.61329) QuantErr: 12.61329 batch_time=0.35119 
Train Epoch: 36 [61/1000 1952/32000 (6%)] Loss: 0.38565 (QuantReg: 12.48363) QuantErr: 12.48363 batch_time=0.38553 
Train Epoch: 36 [66/1000 2112/32000 (7%)] Loss: 0.23817 (QuantReg: 12.97934) QuantErr: 12.97934 batch_time=0.43906 
Train Epoch: 36 [71/1000 2272/32000 (7%)] Loss: 0.76524 (QuantReg: 11.96040) QuantErr: 11.96040 batch_time=0.37121 
Train Epoch: 36 [76/1000 2432/32000 (8%)] Loss: 0.28902 (QuantReg: 12.63278) QuantErr: 12.63278 batch_time=0.39315 
Train Epoch: 36 [81/1000 2592/32000 (8%)] Loss: 0.28111 (QuantReg: 12.76668) QuantErr: 12.76668 batch_time=0.37586 
Train Epoch: 36 [86/1000 2752/32000 (9%)] Loss: 0.44476 (QuantReg: 13.33766) QuantErr: 13.33766 batch_time=0.35140 
Train Epoch: 36 [91/1000 2912/32000 (9%)] Loss: 0.37060 (QuantReg: 11.94844) QuantErr: 11.94844 batch_time=0.34415 
Train Epoch: 36 [96/1000 3072/32000 (10%)] Loss: 0.44106 (QuantReg: 12.48933) QuantErr: 12.48933 batch_time=0.36625 
Train Epoch: 36 [101/1000 3232/32000 (10%)] Loss: 0.16106 (QuantReg: 13.06290) QuantErr: 13.06290 batch_time=0.34163 
Train Epoch: 36 [106/1000 3392/32000 (11%)] Loss: 0.84124 (QuantReg: 12.44907) QuantErr: 12.44907 batch_time=0.39756 
Train Epoch: 36 [111/1000 3552/32000 (11%)] Loss: 0.13146 (QuantReg: 12.98098) QuantErr: 12.98098 batch_time=0.34271 
Train Epoch: 36 [116/1000 3712/32000 (12%)] Loss: 0.15131 (QuantReg: 12.58650) QuantErr: 12.58650 batch_time=0.34343 
Train Epoch: 36 [121/1000 3872/32000 (12%)] Loss: 0.31629 (QuantReg: 12.83195) QuantErr: 12.83195 batch_time=0.36404 
Train Epoch: 36 [126/1000 4032/32000 (13%)] Loss: 0.30659 (QuantReg: 12.93157) QuantErr: 12.93157 batch_time=0.35018 
Train Epoch: 36 [131/1000 4192/32000 (13%)] Loss: 0.72732 (QuantReg: 12.76982) QuantErr: 12.76982 batch_time=0.46835 
Train Epoch: 36 [136/1000 4352/32000 (14%)] Loss: 0.12708 (QuantReg: 12.62370) QuantErr: 12.62370 batch_time=0.36132 
Train Epoch: 36 [141/1000 4512/32000 (14%)] Loss: 0.11770 (QuantReg: 12.93307) QuantErr: 12.93307 batch_time=0.59213 
Train Epoch: 36 [146/1000 4672/32000 (15%)] Loss: 0.14058 (QuantReg: 12.54825) QuantErr: 12.54825 batch_time=0.42055 
Train Epoch: 36 [151/1000 4832/32000 (15%)] Loss: 0.32613 (QuantReg: 12.42443) QuantErr: 12.42443 batch_time=0.39409 
Train Epoch: 36 [156/1000 4992/32000 (16%)] Loss: 0.42606 (QuantReg: 12.69458) QuantErr: 12.69458 batch_time=0.38341 
Train Epoch: 36 [161/1000 5152/32000 (16%)] Loss: 0.18320 (QuantReg: 12.90924) QuantErr: 12.90924 batch_time=0.37374 
Train Epoch: 36 [166/1000 5312/32000 (17%)] Loss: 0.30406 (QuantReg: 12.98671) QuantErr: 12.98671 batch_time=0.52125 
Train Epoch: 36 [171/1000 5472/32000 (17%)] Loss: 0.33480 (QuantReg: 12.68267) QuantErr: 12.68267 batch_time=0.39825 
Train Epoch: 36 [176/1000 5632/32000 (18%)] Loss: 0.39434 (QuantReg: 12.71067) QuantErr: 12.71067 batch_time=0.36652 
Train Epoch: 36 [181/1000 5792/32000 (18%)] Loss: 0.23096 (QuantReg: 12.58850) QuantErr: 12.58850 batch_time=0.40113 
Train Epoch: 36 [186/1000 5952/32000 (19%)] Loss: 0.56194 (QuantReg: 12.67003) QuantErr: 12.67003 batch_time=0.35489 
Train Epoch: 36 [191/1000 6112/32000 (19%)] Loss: 1.24114 (QuantReg: 12.20076) QuantErr: 12.20076 batch_time=0.33797 
Train Epoch: 36 [196/1000 6272/32000 (20%)] Loss: 0.26029 (QuantReg: 12.11147) QuantErr: 12.11147 batch_time=0.33968 
Train Epoch: 36 [201/1000 6432/32000 (20%)] Loss: 0.31621 (QuantReg: 12.51357) QuantErr: 12.51357 batch_time=0.34510 
Train Epoch: 36 [206/1000 6592/32000 (21%)] Loss: 0.42598 (QuantReg: 12.30427) QuantErr: 12.30427 batch_time=0.38202 
Train Epoch: 36 [211/1000 6752/32000 (21%)] Loss: 0.28814 (QuantReg: 12.89938) QuantErr: 12.89938 batch_time=0.39879 
Train Epoch: 36 [216/1000 6912/32000 (22%)] Loss: 0.39543 (QuantReg: 12.98254) QuantErr: 12.98254 batch_time=0.36789 
Train Epoch: 36 [221/1000 7072/32000 (22%)] Loss: 0.12936 (QuantReg: 12.67614) QuantErr: 12.67614 batch_time=0.34507 
Train Epoch: 36 [226/1000 7232/32000 (23%)] Loss: 0.23445 (QuantReg: 13.34896) QuantErr: 13.34896 batch_time=0.36729 
Train Epoch: 36 [231/1000 7392/32000 (23%)] Loss: 0.30514 (QuantReg: 13.39460) QuantErr: 13.39460 batch_time=0.68357 
Train Epoch: 36 [236/1000 7552/32000 (24%)] Loss: 0.32274 (QuantReg: 12.44008) QuantErr: 12.44008 batch_time=0.35573 
Train Epoch: 36 [241/1000 7712/32000 (24%)] Loss: 0.49314 (QuantReg: 12.29610) QuantErr: 12.29610 batch_time=0.33461 
Train Epoch: 36 [246/1000 7872/32000 (25%)] Loss: 0.50503 (QuantReg: 13.07051) QuantErr: 13.07051 batch_time=0.34115 
Train Epoch: 36 [251/1000 8032/32000 (25%)] Loss: 0.22204 (QuantReg: 12.36831) QuantErr: 12.36831 batch_time=0.34571 
Train Epoch: 36 [256/1000 8192/32000 (26%)] Loss: 0.33000 (QuantReg: 11.75647) QuantErr: 11.75647 batch_time=0.34414 
Train Epoch: 36 [261/1000 8352/32000 (26%)] Loss: 0.16166 (QuantReg: 12.34501) QuantErr: 12.34501 batch_time=0.35014 
Train Epoch: 36 [266/1000 8512/32000 (27%)] Loss: 0.07302 (QuantReg: 12.62819) QuantErr: 12.62819 batch_time=0.34743 
Train Epoch: 36 [271/1000 8672/32000 (27%)] Loss: 0.06192 (QuantReg: 12.48277) QuantErr: 12.48277 batch_time=0.39736 
Train Epoch: 36 [276/1000 8832/32000 (28%)] Loss: 0.27826 (QuantReg: 13.38793) QuantErr: 13.38793 batch_time=0.37807 
Train Epoch: 36 [281/1000 8992/32000 (28%)] Loss: 0.14845 (QuantReg: 12.61986) QuantErr: 12.61986 batch_time=0.37208 
Train Epoch: 36 [286/1000 9152/32000 (29%)] Loss: 0.33875 (QuantReg: 13.01752) QuantErr: 13.01752 batch_time=0.34939 
Train Epoch: 36 [291/1000 9312/32000 (29%)] Loss: 0.36817 (QuantReg: 12.14129) QuantErr: 12.14129 batch_time=0.37586 
Train Epoch: 36 [296/1000 9472/32000 (30%)] Loss: 0.41675 (QuantReg: 12.10193) QuantErr: 12.10193 batch_time=0.77274 
Train Epoch: 36 [301/1000 9632/32000 (30%)] Loss: 0.39034 (QuantReg: 12.69905) QuantErr: 12.69905 batch_time=0.37802 
Train Epoch: 36 [306/1000 9792/32000 (31%)] Loss: 0.30937 (QuantReg: 13.04067) QuantErr: 13.04067 batch_time=0.39815 
Train Epoch: 36 [311/1000 9952/32000 (31%)] Loss: 0.31987 (QuantReg: 12.43548) QuantErr: 12.43548 batch_time=0.39554 
Train Epoch: 36 [316/1000 10112/32000 (32%)] Loss: 0.65344 (QuantReg: 12.49118) QuantErr: 12.49118 batch_time=0.35760 
Train Epoch: 36 [321/1000 10272/32000 (32%)] Loss: 0.11760 (QuantReg: 12.87427) QuantErr: 12.87427 batch_time=0.42124 
Train Epoch: 36 [326/1000 10432/32000 (33%)] Loss: 0.31954 (QuantReg: 13.04008) QuantErr: 13.04008 batch_time=0.51653 
Train Epoch: 36 [331/1000 10592/32000 (33%)] Loss: 0.35172 (QuantReg: 12.52629) QuantErr: 12.52629 batch_time=0.38928 
Train Epoch: 36 [336/1000 10752/32000 (34%)] Loss: 0.11414 (QuantReg: 12.69728) QuantErr: 12.69728 batch_time=1.28071 
Train Epoch: 36 [341/1000 10912/32000 (34%)] Loss: 0.55317 (QuantReg: 12.97441) QuantErr: 12.97441 batch_time=0.40529 
Train Epoch: 36 [346/1000 11072/32000 (35%)] Loss: 0.33029 (QuantReg: 12.51844) QuantErr: 12.51844 batch_time=0.36759 
Train Epoch: 36 [351/1000 11232/32000 (35%)] Loss: 0.21172 (QuantReg: 12.89204) QuantErr: 12.89204 batch_time=0.35960 
Train Epoch: 36 [356/1000 11392/32000 (36%)] Loss: 0.34512 (QuantReg: 12.16202) QuantErr: 12.16202 batch_time=0.35584 
Train Epoch: 36 [361/1000 11552/32000 (36%)] Loss: 0.46058 (QuantReg: 12.74667) QuantErr: 12.74667 batch_time=0.35440 
Train Epoch: 36 [366/1000 11712/32000 (37%)] Loss: 0.27904 (QuantReg: 12.14180) QuantErr: 12.14180 batch_time=0.36994 
Train Epoch: 36 [371/1000 11872/32000 (37%)] Loss: 0.21413 (QuantReg: 12.93670) QuantErr: 12.93670 batch_time=0.36863 
Train Epoch: 36 [376/1000 12032/32000 (38%)] Loss: 0.21515 (QuantReg: 13.26993) QuantErr: 13.26993 batch_time=0.35459 
Train Epoch: 36 [381/1000 12192/32000 (38%)] Loss: 0.50525 (QuantReg: 12.62088) QuantErr: 12.62088 batch_time=0.34533 
Train Epoch: 36 [386/1000 12352/32000 (39%)] Loss: 0.08953 (QuantReg: 12.96492) QuantErr: 12.96492 batch_time=0.34428 
Train Epoch: 36 [391/1000 12512/32000 (39%)] Loss: 0.12593 (QuantReg: 12.37083) QuantErr: 12.37083 batch_time=0.34340 
Train Epoch: 36 [396/1000 12672/32000 (40%)] Loss: 0.27368 (QuantReg: 12.42403) QuantErr: 12.42403 batch_time=0.34395 
Train Epoch: 36 [401/1000 12832/32000 (40%)] Loss: 0.46451 (QuantReg: 12.96333) QuantErr: 12.96333 batch_time=0.37136 
Train Epoch: 36 [406/1000 12992/32000 (41%)] Loss: 0.21293 (QuantReg: 12.87994) QuantErr: 12.87994 batch_time=0.35539 
Train Epoch: 36 [411/1000 13152/32000 (41%)] Loss: 0.20201 (QuantReg: 12.38285) QuantErr: 12.38285 batch_time=0.34432 
Train Epoch: 36 [416/1000 13312/32000 (42%)] Loss: 0.39008 (QuantReg: 13.31151) QuantErr: 13.31151 batch_time=0.37124 
Train Epoch: 36 [421/1000 13472/32000 (42%)] Loss: 0.30078 (QuantReg: 13.15520) QuantErr: 13.15520 batch_time=0.36291 
Train Epoch: 36 [426/1000 13632/32000 (43%)] Loss: 0.41828 (QuantReg: 12.74757) QuantErr: 12.74757 batch_time=0.37780 
Train Epoch: 36 [431/1000 13792/32000 (43%)] Loss: 0.33590 (QuantReg: 12.73393) QuantErr: 12.73393 batch_time=0.36224 
Train Epoch: 36 [436/1000 13952/32000 (44%)] Loss: 0.67241 (QuantReg: 12.45281) QuantErr: 12.45281 batch_time=0.35410 
Train Epoch: 36 [441/1000 14112/32000 (44%)] Loss: 0.44177 (QuantReg: 12.59413) QuantErr: 12.59413 batch_time=0.37224 
Train Epoch: 36 [446/1000 14272/32000 (45%)] Loss: 0.39804 (QuantReg: 12.69560) QuantErr: 12.69560 batch_time=0.38515 
Train Epoch: 36 [451/1000 14432/32000 (45%)] Loss: 0.28713 (QuantReg: 12.63770) QuantErr: 12.63770 batch_time=0.42343 
Train Epoch: 36 [456/1000 14592/32000 (46%)] Loss: 0.27229 (QuantReg: 12.27913) QuantErr: 12.27913 batch_time=0.36338 
Train Epoch: 36 [461/1000 14752/32000 (46%)] Loss: 0.22807 (QuantReg: 12.81729) QuantErr: 12.81729 batch_time=0.53735 
Train Epoch: 36 [466/1000 14912/32000 (47%)] Loss: 0.57050 (QuantReg: 12.92827) QuantErr: 12.92827 batch_time=0.41225 
Train Epoch: 36 [471/1000 15072/32000 (47%)] Loss: 0.18732 (QuantReg: 12.39660) QuantErr: 12.39660 batch_time=0.36165 
Train Epoch: 36 [476/1000 15232/32000 (48%)] Loss: 0.46571 (QuantReg: 12.49008) QuantErr: 12.49008 batch_time=0.34955 
Train Epoch: 36 [481/1000 15392/32000 (48%)] Loss: 0.24997 (QuantReg: 12.73450) QuantErr: 12.73450 batch_time=0.34591 
Train Epoch: 36 [486/1000 15552/32000 (49%)] Loss: 0.35319 (QuantReg: 12.32737) QuantErr: 12.32737 batch_time=0.43779 
Train Epoch: 36 [491/1000 15712/32000 (49%)] Loss: 0.34320 (QuantReg: 12.87609) QuantErr: 12.87609 batch_time=0.36267 
Train Epoch: 36 [496/1000 15872/32000 (50%)] Loss: 0.27659 (QuantReg: 13.23420) QuantErr: 13.23420 batch_time=0.35995 
Train Epoch: 36 [501/1000 16032/32000 (50%)] Loss: 0.20729 (QuantReg: 12.79718) QuantErr: 12.79718 batch_time=0.34866 
Train Epoch: 36 [506/1000 16192/32000 (51%)] Loss: 0.37243 (QuantReg: 12.63210) QuantErr: 12.63210 batch_time=0.34563 
Train Epoch: 36 [511/1000 16352/32000 (51%)] Loss: 0.51867 (QuantReg: 12.46706) QuantErr: 12.46706 batch_time=0.34323 
Train Epoch: 36 [516/1000 16512/32000 (52%)] Loss: 0.33553 (QuantReg: 12.66508) QuantErr: 12.66508 batch_time=0.34773 
Train Epoch: 36 [521/1000 16672/32000 (52%)] Loss: 0.44764 (QuantReg: 11.95781) QuantErr: 11.95781 batch_time=0.38486 
Train Epoch: 36 [526/1000 16832/32000 (53%)] Loss: 0.07178 (QuantReg: 12.95706) QuantErr: 12.95706 batch_time=0.34673 
Train Epoch: 36 [531/1000 16992/32000 (53%)] Loss: 0.28004 (QuantReg: 12.54410) QuantErr: 12.54410 batch_time=0.34085 
Train Epoch: 36 [536/1000 17152/32000 (54%)] Loss: 0.21221 (QuantReg: 12.56519) QuantErr: 12.56519 batch_time=0.40011 
Train Epoch: 36 [541/1000 17312/32000 (54%)] Loss: 0.21619 (QuantReg: 12.81791) QuantErr: 12.81791 batch_time=0.37003 
Train Epoch: 36 [546/1000 17472/32000 (55%)] Loss: 0.24689 (QuantReg: 13.35386) QuantErr: 13.35386 batch_time=0.34125 
Train Epoch: 36 [551/1000 17632/32000 (55%)] Loss: 0.31603 (QuantReg: 12.84472) QuantErr: 12.84472 batch_time=0.63933 
Train Epoch: 36 [556/1000 17792/32000 (56%)] Loss: 0.34561 (QuantReg: 12.54105) QuantErr: 12.54105 batch_time=0.38853 
Train Epoch: 36 [561/1000 17952/32000 (56%)] Loss: 0.27227 (QuantReg: 12.93325) QuantErr: 12.93325 batch_time=0.36809 
Train Epoch: 36 [566/1000 18112/32000 (57%)] Loss: 0.46029 (QuantReg: 12.41701) QuantErr: 12.41701 batch_time=0.34941 
Train Epoch: 36 [571/1000 18272/32000 (57%)] Loss: 0.53756 (QuantReg: 13.07677) QuantErr: 13.07677 batch_time=0.36986 
Train Epoch: 36 [576/1000 18432/32000 (58%)] Loss: 0.12401 (QuantReg: 13.02045) QuantErr: 13.02045 batch_time=0.37177 
Train Epoch: 36 [581/1000 18592/32000 (58%)] Loss: 0.14764 (QuantReg: 12.81192) QuantErr: 12.81192 batch_time=0.37220 
Train Epoch: 36 [586/1000 18752/32000 (59%)] Loss: 0.15777 (QuantReg: 13.22194) QuantErr: 13.22194 batch_time=0.38813 
Train Epoch: 36 [591/1000 18912/32000 (59%)] Loss: 0.10763 (QuantReg: 12.65026) QuantErr: 12.65026 batch_time=0.36204 
Train Epoch: 36 [596/1000 19072/32000 (60%)] Loss: 0.14473 (QuantReg: 12.49145) QuantErr: 12.49145 batch_time=0.37301 
Train Epoch: 36 [601/1000 19232/32000 (60%)] Loss: 0.48805 (QuantReg: 12.88957) QuantErr: 12.88957 batch_time=0.35558 
Train Epoch: 36 [606/1000 19392/32000 (61%)] Loss: 0.39616 (QuantReg: 12.35213) QuantErr: 12.35213 batch_time=0.35086 
Train Epoch: 36 [611/1000 19552/32000 (61%)] Loss: 0.23298 (QuantReg: 12.67513) QuantErr: 12.67513 batch_time=0.34637 
Train Epoch: 36 [616/1000 19712/32000 (62%)] Loss: 0.44674 (QuantReg: 12.41734) QuantErr: 12.41734 batch_time=0.80702 
Train Epoch: 36 [621/1000 19872/32000 (62%)] Loss: 0.55425 (QuantReg: 13.41201) QuantErr: 13.41201 batch_time=0.35201 
Train Epoch: 36 [626/1000 20032/32000 (63%)] Loss: 0.21279 (QuantReg: 13.15669) QuantErr: 13.15669 batch_time=0.35143 
Train Epoch: 36 [631/1000 20192/32000 (63%)] Loss: 0.28929 (QuantReg: 12.77116) QuantErr: 12.77116 batch_time=0.35286 
Train Epoch: 36 [636/1000 20352/32000 (64%)] Loss: 0.12608 (QuantReg: 13.10421) QuantErr: 13.10421 batch_time=0.36374 
Train Epoch: 36 [641/1000 20512/32000 (64%)] Loss: 0.36268 (QuantReg: 12.61621) QuantErr: 12.61621 batch_time=0.45609 
Train Epoch: 36 [646/1000 20672/32000 (65%)] Loss: 0.19264 (QuantReg: 12.45084) QuantErr: 12.45084 batch_time=0.45236 
Train Epoch: 36 [651/1000 20832/32000 (65%)] Loss: 0.11560 (QuantReg: 13.10373) QuantErr: 13.10373 batch_time=0.40527 
Train Epoch: 36 [656/1000 20992/32000 (66%)] Loss: 0.24315 (QuantReg: 12.96058) QuantErr: 12.96058 batch_time=1.14582 
Train Epoch: 36 [661/1000 21152/32000 (66%)] Loss: 0.51225 (QuantReg: 12.95188) QuantErr: 12.95188 batch_time=0.36822 
Train Epoch: 36 [666/1000 21312/32000 (67%)] Loss: 0.41198 (QuantReg: 13.24900) QuantErr: 13.24900 batch_time=0.40272 
Train Epoch: 36 [671/1000 21472/32000 (67%)] Loss: 0.13984 (QuantReg: 12.75304) QuantErr: 12.75304 batch_time=0.40825 
Train Epoch: 36 [676/1000 21632/32000 (68%)] Loss: 0.66649 (QuantReg: 13.17842) QuantErr: 13.17842 batch_time=0.36606 
Train Epoch: 36 [681/1000 21792/32000 (68%)] Loss: 0.29722 (QuantReg: 12.65374) QuantErr: 12.65374 batch_time=0.35134 
Train Epoch: 36 [686/1000 21952/32000 (69%)] Loss: 0.21747 (QuantReg: 13.23146) QuantErr: 13.23146 batch_time=0.33997 
Train Epoch: 36 [691/1000 22112/32000 (69%)] Loss: 0.21731 (QuantReg: 13.21504) QuantErr: 13.21504 batch_time=0.34666 
Train Epoch: 36 [696/1000 22272/32000 (70%)] Loss: 0.30978 (QuantReg: 13.07316) QuantErr: 13.07316 batch_time=0.35844 
Train Epoch: 36 [701/1000 22432/32000 (70%)] Loss: 0.09896 (QuantReg: 13.00289) QuantErr: 13.00289 batch_time=0.35834 
Train Epoch: 36 [706/1000 22592/32000 (71%)] Loss: 0.23057 (QuantReg: 12.78294) QuantErr: 12.78294 batch_time=0.36180 
Train Epoch: 36 [711/1000 22752/32000 (71%)] Loss: 0.17952 (QuantReg: 12.40486) QuantErr: 12.40486 batch_time=0.34737 
Train Epoch: 36 [716/1000 22912/32000 (72%)] Loss: 0.73608 (QuantReg: 12.79902) QuantErr: 12.79902 batch_time=0.34585 
Train Epoch: 36 [721/1000 23072/32000 (72%)] Loss: 0.11213 (QuantReg: 12.91441) QuantErr: 12.91441 batch_time=0.34883 
Train Epoch: 36 [726/1000 23232/32000 (73%)] Loss: 0.37013 (QuantReg: 11.91515) QuantErr: 11.91515 batch_time=0.35692 
Train Epoch: 36 [731/1000 23392/32000 (73%)] Loss: 0.32375 (QuantReg: 12.66809) QuantErr: 12.66809 batch_time=0.36891 
Train Epoch: 36 [736/1000 23552/32000 (74%)] Loss: 0.15867 (QuantReg: 12.95781) QuantErr: 12.95781 batch_time=0.38413 
Train Epoch: 36 [741/1000 23712/32000 (74%)] Loss: 0.17709 (QuantReg: 12.89862) QuantErr: 12.89862 batch_time=0.34622 
Train Epoch: 36 [746/1000 23872/32000 (75%)] Loss: 0.38968 (QuantReg: 12.69885) QuantErr: 12.69885 batch_time=0.34330 
Train Epoch: 36 [751/1000 24032/32000 (75%)] Loss: 0.35493 (QuantReg: 12.17796) QuantErr: 12.17796 batch_time=0.36377 
Train Epoch: 36 [756/1000 24192/32000 (76%)] Loss: 0.63443 (QuantReg: 12.69502) QuantErr: 12.69502 batch_time=0.37247 
Train Epoch: 36 [761/1000 24352/32000 (76%)] Loss: 0.19584 (QuantReg: 12.96140) QuantErr: 12.96140 batch_time=0.36970 
Train Epoch: 36 [766/1000 24512/32000 (77%)] Loss: 0.60046 (QuantReg: 12.89942) QuantErr: 12.89942 batch_time=0.34580 
Train Epoch: 36 [771/1000 24672/32000 (77%)] Loss: 0.40931 (QuantReg: 13.00927) QuantErr: 13.00927 batch_time=0.40770 
Train Epoch: 36 [776/1000 24832/32000 (78%)] Loss: 0.32890 (QuantReg: 12.78030) QuantErr: 12.78030 batch_time=0.38655 
Train Epoch: 36 [781/1000 24992/32000 (78%)] Loss: 0.26967 (QuantReg: 12.80385) QuantErr: 12.80385 batch_time=0.59837 
Train Epoch: 36 [786/1000 25152/32000 (79%)] Loss: 0.28630 (QuantReg: 12.74323) QuantErr: 12.74323 batch_time=0.44444 
Train Epoch: 36 [791/1000 25312/32000 (79%)] Loss: 0.14516 (QuantReg: 13.32203) QuantErr: 13.32203 batch_time=0.36065 
Train Epoch: 36 [796/1000 25472/32000 (80%)] Loss: 0.61448 (QuantReg: 12.59388) QuantErr: 12.59388 batch_time=0.36623 
Train Epoch: 36 [801/1000 25632/32000 (80%)] Loss: 0.26141 (QuantReg: 12.67414) QuantErr: 12.67414 batch_time=0.38627 
Train Epoch: 36 [806/1000 25792/32000 (81%)] Loss: 0.33904 (QuantReg: 12.66215) QuantErr: 12.66215 batch_time=0.53507 
Train Epoch: 36 [811/1000 25952/32000 (81%)] Loss: 0.26424 (QuantReg: 11.90683) QuantErr: 11.90683 batch_time=0.37789 
Train Epoch: 36 [816/1000 26112/32000 (82%)] Loss: 0.56758 (QuantReg: 12.52867) QuantErr: 12.52867 batch_time=0.36510 
Train Epoch: 36 [821/1000 26272/32000 (82%)] Loss: 0.25671 (QuantReg: 12.65752) QuantErr: 12.65752 batch_time=0.39810 
Train Epoch: 36 [826/1000 26432/32000 (83%)] Loss: 0.57942 (QuantReg: 12.41511) QuantErr: 12.41511 batch_time=0.37813 
Train Epoch: 36 [831/1000 26592/32000 (83%)] Loss: 0.21291 (QuantReg: 12.78688) QuantErr: 12.78688 batch_time=0.35590 
Train Epoch: 36 [836/1000 26752/32000 (84%)] Loss: 0.25127 (QuantReg: 13.32479) QuantErr: 13.32479 batch_time=0.34548 
Train Epoch: 36 [841/1000 26912/32000 (84%)] Loss: 0.44049 (QuantReg: 12.76416) QuantErr: 12.76416 batch_time=0.34273 
Train Epoch: 36 [846/1000 27072/32000 (85%)] Loss: 0.40256 (QuantReg: 13.68108) QuantErr: 13.68108 batch_time=0.41234 
Train Epoch: 36 [851/1000 27232/32000 (85%)] Loss: 0.25437 (QuantReg: 12.69842) QuantErr: 12.69842 batch_time=0.37204 
Train Epoch: 36 [856/1000 27392/32000 (86%)] Loss: 0.76748 (QuantReg: 12.27472) QuantErr: 12.27472 batch_time=0.50051 
Train Epoch: 36 [861/1000 27552/32000 (86%)] Loss: 0.14645 (QuantReg: 13.62834) QuantErr: 13.62834 batch_time=0.38955 
Train Epoch: 36 [866/1000 27712/32000 (87%)] Loss: 0.31585 (QuantReg: 13.27982) QuantErr: 13.27982 batch_time=0.45779 
Train Epoch: 36 [871/1000 27872/32000 (87%)] Loss: 0.28079 (QuantReg: 13.19488) QuantErr: 13.19488 batch_time=0.69183 
Train Epoch: 36 [876/1000 28032/32000 (88%)] Loss: 0.46882 (QuantReg: 13.18552) QuantErr: 13.18552 batch_time=0.39732 
Train Epoch: 36 [881/1000 28192/32000 (88%)] Loss: 0.60580 (QuantReg: 12.32932) QuantErr: 12.32932 batch_time=0.38645 
Train Epoch: 36 [886/1000 28352/32000 (89%)] Loss: 0.30304 (QuantReg: 12.31527) QuantErr: 12.31527 batch_time=0.35796 
Train Epoch: 36 [891/1000 28512/32000 (89%)] Loss: 0.67611 (QuantReg: 12.18868) QuantErr: 12.18868 batch_time=0.40955 
Train Epoch: 36 [896/1000 28672/32000 (90%)] Loss: 0.19566 (QuantReg: 12.52938) QuantErr: 12.52938 batch_time=0.41293 
Train Epoch: 36 [901/1000 28832/32000 (90%)] Loss: 0.20268 (QuantReg: 13.37212) QuantErr: 13.37212 batch_time=0.35733 
Train Epoch: 36 [906/1000 28992/32000 (91%)] Loss: 0.36043 (QuantReg: 12.63753) QuantErr: 12.63753 batch_time=0.35940 
Train Epoch: 36 [911/1000 29152/32000 (91%)] Loss: 0.16912 (QuantReg: 13.33099) QuantErr: 13.33099 batch_time=0.37409 
Train Epoch: 36 [916/1000 29312/32000 (92%)] Loss: 0.38348 (QuantReg: 12.94481) QuantErr: 12.94481 batch_time=0.37121 
Train Epoch: 36 [921/1000 29472/32000 (92%)] Loss: 0.21144 (QuantReg: 12.89878) QuantErr: 12.89878 batch_time=0.35965 
Train Epoch: 36 [926/1000 29632/32000 (93%)] Loss: 0.37360 (QuantReg: 12.36045) QuantErr: 12.36045 batch_time=0.42429 
Train Epoch: 36 [931/1000 29792/32000 (93%)] Loss: 0.22242 (QuantReg: 12.44276) QuantErr: 12.44276 batch_time=0.37107 
Train Epoch: 36 [936/1000 29952/32000 (94%)] Loss: 0.19322 (QuantReg: 12.90519) QuantErr: 12.90519 batch_time=0.81743 
Train Epoch: 36 [941/1000 30112/32000 (94%)] Loss: 0.49891 (QuantReg: 12.94476) QuantErr: 12.94476 batch_time=0.35778 
Train Epoch: 36 [946/1000 30272/32000 (95%)] Loss: 0.43332 (QuantReg: 12.77446) QuantErr: 12.77446 batch_time=0.35345 
Train Epoch: 36 [951/1000 30432/32000 (95%)] Loss: 0.23157 (QuantReg: 12.95021) QuantErr: 12.95021 batch_time=0.34930 
Train Epoch: 36 [956/1000 30592/32000 (96%)] Loss: 0.50187 (QuantReg: 13.35060) QuantErr: 13.35060 batch_time=0.35552 
Train Epoch: 36 [961/1000 30752/32000 (96%)] Loss: 0.30266 (QuantReg: 12.46474) QuantErr: 12.46474 batch_time=0.41781 
Train Epoch: 36 [966/1000 30912/32000 (97%)] Loss: 0.14957 (QuantReg: 12.74561) QuantErr: 12.74561 batch_time=0.42890 
Train Epoch: 36 [971/1000 31072/32000 (97%)] Loss: 0.15496 (QuantReg: 12.60516) QuantErr: 12.60516 batch_time=0.35074 
Train Epoch: 36 [976/1000 31232/32000 (98%)] Loss: 0.25841 (QuantReg: 12.57084) QuantErr: 12.57084 batch_time=1.13754 
Train Epoch: 36 [981/1000 31392/32000 (98%)] Loss: 0.11370 (QuantReg: 13.11916) QuantErr: 13.11916 batch_time=0.34010 
Train Epoch: 36 [986/1000 31552/32000 (99%)] Loss: 0.20510 (QuantReg: 12.43311) QuantErr: 12.43311 batch_time=0.34736 
Train Epoch: 36 [991/1000 31712/32000 (99%)] Loss: 0.16586 (QuantReg: 12.92509) QuantErr: 12.92509 batch_time=0.44991 
Train Epoch: 36 [996/1000 31872/32000 (100%)] Loss: 0.20411 (QuantReg: 13.06028) QuantErr: 13.06028 batch_time=0.49160 
Train Epoch: 36 codebook_update_time=1.83274
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch36.pth ...
Done in 4.892s
removing stale ckpt [epoch 35] [took 8.45s]
 epoch          : 36
 loss           : 0.32218755678460004
 quant_reg      : 12.735802847862244
 quant_err      : 12.735802847862244
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 36000
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.177062374245473
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.482276651157036
 MSRVTT_full_val/v2t_metrics/R1: 35.61368209255533
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.698189134808853
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.563560397797175
 MSRVTT_full_test/t2v_metrics/R1: 12.408026755852843
 MSRVTT_full_test/t2v_metrics/R5: 35.38461538461539
 MSRVTT_full_test/t2v_metrics/R10: 48.929765886287626
 MSRVTT_full_test/t2v_metrics/R50: 79.86622073578596
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.99966555183946
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.799060123520874
 MSRVTT_full_test/v2t_metrics/R1: 15.752508361204013
 MSRVTT_full_test/v2t_metrics/R5: 40.76923076923077
 MSRVTT_full_test/v2t_metrics/R10: 56.68896321070234
 MSRVTT_full_test/v2t_metrics/R50: 86.25418060200668
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.7876254180602
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.14313481807386
 mnt_best       : 29.218703131434403
 not_improved_count: 1
Train Epoch: 37 [1/1000 32/32000 (0%)] Loss: 0.17208 (QuantReg: 12.72064) QuantErr: 12.72064 batch_time=28.68903 
Train Epoch: 37 [6/1000 192/32000 (1%)] Loss: 0.41562 (QuantReg: 12.74785) QuantErr: 12.74785 batch_time=0.36952 
Train Epoch: 37 [11/1000 352/32000 (1%)] Loss: 0.20608 (QuantReg: 12.47162) QuantErr: 12.47162 batch_time=0.34587 
Train Epoch: 37 [16/1000 512/32000 (2%)] Loss: 0.09904 (QuantReg: 13.03973) QuantErr: 13.03973 batch_time=0.33870 
Train Epoch: 37 [21/1000 672/32000 (2%)] Loss: 0.45094 (QuantReg: 12.59937) QuantErr: 12.59937 batch_time=0.34180 
Train Epoch: 37 [26/1000 832/32000 (3%)] Loss: 0.32846 (QuantReg: 12.59346) QuantErr: 12.59346 batch_time=0.35543 
Train Epoch: 37 [31/1000 992/32000 (3%)] Loss: 0.19335 (QuantReg: 12.86314) QuantErr: 12.86314 batch_time=0.37769 
Train Epoch: 37 [36/1000 1152/32000 (4%)] Loss: 0.29257 (QuantReg: 13.34902) QuantErr: 13.34902 batch_time=0.44595 
Train Epoch: 37 [41/1000 1312/32000 (4%)] Loss: 0.16742 (QuantReg: 12.09617) QuantErr: 12.09617 batch_time=0.43921 
Train Epoch: 37 [46/1000 1472/32000 (5%)] Loss: 0.16569 (QuantReg: 12.68248) QuantErr: 12.68248 batch_time=0.37861 
Train Epoch: 37 [51/1000 1632/32000 (5%)] Loss: 0.28023 (QuantReg: 13.14012) QuantErr: 13.14012 batch_time=0.38084 
Train Epoch: 37 [56/1000 1792/32000 (6%)] Loss: 0.31752 (QuantReg: 12.47704) QuantErr: 12.47704 batch_time=0.34925 
Train Epoch: 37 [61/1000 1952/32000 (6%)] Loss: 0.18793 (QuantReg: 12.35215) QuantErr: 12.35215 batch_time=0.34944 
Train Epoch: 37 [66/1000 2112/32000 (7%)] Loss: 0.45165 (QuantReg: 12.13472) QuantErr: 12.13472 batch_time=0.40691 
Train Epoch: 37 [71/1000 2272/32000 (7%)] Loss: 0.30871 (QuantReg: 12.72095) QuantErr: 12.72095 batch_time=0.34585 
Train Epoch: 37 [76/1000 2432/32000 (8%)] Loss: 0.38015 (QuantReg: 12.39224) QuantErr: 12.39224 batch_time=0.35194 
Train Epoch: 37 [81/1000 2592/32000 (8%)] Loss: 0.78817 (QuantReg: 12.23859) QuantErr: 12.23859 batch_time=0.35748 
Train Epoch: 37 [86/1000 2752/32000 (9%)] Loss: 0.37456 (QuantReg: 12.71636) QuantErr: 12.71636 batch_time=0.37811 
Train Epoch: 37 [91/1000 2912/32000 (9%)] Loss: 0.36551 (QuantReg: 12.52982) QuantErr: 12.52982 batch_time=0.40658 
Train Epoch: 37 [96/1000 3072/32000 (10%)] Loss: 0.23333 (QuantReg: 12.64673) QuantErr: 12.64673 batch_time=0.38533 
Train Epoch: 37 [101/1000 3232/32000 (10%)] Loss: 0.39409 (QuantReg: 11.88311) QuantErr: 11.88311 batch_time=0.35993 
Train Epoch: 37 [106/1000 3392/32000 (11%)] Loss: 0.36245 (QuantReg: 13.59476) QuantErr: 13.59476 batch_time=0.38021 
Train Epoch: 37 [111/1000 3552/32000 (11%)] Loss: 0.39446 (QuantReg: 13.17693) QuantErr: 13.17693 batch_time=0.35189 
Train Epoch: 37 [116/1000 3712/32000 (12%)] Loss: 0.25428 (QuantReg: 13.07612) QuantErr: 13.07612 batch_time=0.34542 
Train Epoch: 37 [121/1000 3872/32000 (12%)] Loss: 0.29086 (QuantReg: 12.24841) QuantErr: 12.24841 batch_time=0.36930 
Train Epoch: 37 [126/1000 4032/32000 (13%)] Loss: 0.49345 (QuantReg: 12.36462) QuantErr: 12.36462 batch_time=0.35858 
Train Epoch: 37 [131/1000 4192/32000 (13%)] Loss: 0.27579 (QuantReg: 12.07028) QuantErr: 12.07028 batch_time=1.16106 
Train Epoch: 37 [136/1000 4352/32000 (14%)] Loss: 0.66114 (QuantReg: 12.23483) QuantErr: 12.23483 batch_time=0.34393 
Train Epoch: 37 [141/1000 4512/32000 (14%)] Loss: 0.23571 (QuantReg: 12.71214) QuantErr: 12.71214 batch_time=0.34696 
Train Epoch: 37 [146/1000 4672/32000 (15%)] Loss: 0.36816 (QuantReg: 13.15307) QuantErr: 13.15307 batch_time=0.38014 
Train Epoch: 37 [151/1000 4832/32000 (15%)] Loss: 0.45786 (QuantReg: 12.17031) QuantErr: 12.17031 batch_time=0.36921 
Train Epoch: 37 [156/1000 4992/32000 (16%)] Loss: 0.60766 (QuantReg: 12.67680) QuantErr: 12.67680 batch_time=0.34904 
Train Epoch: 37 [161/1000 5152/32000 (16%)] Loss: 0.39345 (QuantReg: 12.76849) QuantErr: 12.76849 batch_time=1.20766 
Train Epoch: 37 [166/1000 5312/32000 (17%)] Loss: 0.33808 (QuantReg: 12.96900) QuantErr: 12.96900 batch_time=0.45671 
Train Epoch: 37 [171/1000 5472/32000 (17%)] Loss: 0.11845 (QuantReg: 12.62519) QuantErr: 12.62519 batch_time=0.36922 
Train Epoch: 37 [176/1000 5632/32000 (18%)] Loss: 0.44446 (QuantReg: 13.00144) QuantErr: 13.00144 batch_time=0.36962 
Train Epoch: 37 [181/1000 5792/32000 (18%)] Loss: 0.33619 (QuantReg: 13.31452) QuantErr: 13.31452 batch_time=0.37807 
Train Epoch: 37 [186/1000 5952/32000 (19%)] Loss: 0.22487 (QuantReg: 13.10091) QuantErr: 13.10091 batch_time=0.39094 
Train Epoch: 37 [191/1000 6112/32000 (19%)] Loss: 0.29042 (QuantReg: 12.85386) QuantErr: 12.85386 batch_time=0.35284 
Train Epoch: 37 [196/1000 6272/32000 (20%)] Loss: 0.48656 (QuantReg: 13.14010) QuantErr: 13.14010 batch_time=0.35129 
Train Epoch: 37 [201/1000 6432/32000 (20%)] Loss: 0.32519 (QuantReg: 12.47804) QuantErr: 12.47804 batch_time=0.34944 
Train Epoch: 37 [206/1000 6592/32000 (21%)] Loss: 0.43671 (QuantReg: 12.05100) QuantErr: 12.05100 batch_time=0.35825 
Train Epoch: 37 [211/1000 6752/32000 (21%)] Loss: 0.21144 (QuantReg: 12.29711) QuantErr: 12.29711 batch_time=0.37140 
Train Epoch: 37 [216/1000 6912/32000 (22%)] Loss: 0.34153 (QuantReg: 12.31244) QuantErr: 12.31244 batch_time=0.36788 
Train Epoch: 37 [221/1000 7072/32000 (22%)] Loss: 0.30401 (QuantReg: 12.17081) QuantErr: 12.17081 batch_time=0.39559 
Train Epoch: 37 [226/1000 7232/32000 (23%)] Loss: 0.29831 (QuantReg: 12.86795) QuantErr: 12.86795 batch_time=0.36887 
Train Epoch: 37 [231/1000 7392/32000 (23%)] Loss: 0.30478 (QuantReg: 12.39132) QuantErr: 12.39132 batch_time=0.35409 
Train Epoch: 37 [236/1000 7552/32000 (24%)] Loss: 0.38008 (QuantReg: 12.66624) QuantErr: 12.66624 batch_time=0.52740 
Train Epoch: 37 [241/1000 7712/32000 (24%)] Loss: 0.23217 (QuantReg: 13.45500) QuantErr: 13.45500 batch_time=0.35163 
Train Epoch: 37 [246/1000 7872/32000 (25%)] Loss: 0.10105 (QuantReg: 12.82673) QuantErr: 12.82673 batch_time=0.35664 
Train Epoch: 37 [251/1000 8032/32000 (25%)] Loss: 0.17596 (QuantReg: 12.09541) QuantErr: 12.09541 batch_time=0.34736 
Train Epoch: 37 [256/1000 8192/32000 (26%)] Loss: 0.21525 (QuantReg: 12.12871) QuantErr: 12.12871 batch_time=0.34400 
Train Epoch: 37 [261/1000 8352/32000 (26%)] Loss: 0.23344 (QuantReg: 12.92105) QuantErr: 12.92105 batch_time=0.34363 
Train Epoch: 37 [266/1000 8512/32000 (27%)] Loss: 0.41925 (QuantReg: 12.48297) QuantErr: 12.48297 batch_time=0.36620 
Train Epoch: 37 [271/1000 8672/32000 (27%)] Loss: 0.47877 (QuantReg: 12.95708) QuantErr: 12.95708 batch_time=0.38029 
Train Epoch: 37 [276/1000 8832/32000 (28%)] Loss: 0.23836 (QuantReg: 12.50407) QuantErr: 12.50407 batch_time=0.38144 
Train Epoch: 37 [281/1000 8992/32000 (28%)] Loss: 0.16346 (QuantReg: 12.27306) QuantErr: 12.27306 batch_time=0.39993 
Train Epoch: 37 [286/1000 9152/32000 (29%)] Loss: 0.48453 (QuantReg: 12.41856) QuantErr: 12.41856 batch_time=0.35661 
Train Epoch: 37 [291/1000 9312/32000 (29%)] Loss: 0.14587 (QuantReg: 13.40009) QuantErr: 13.40009 batch_time=0.36241 
Train Epoch: 37 [296/1000 9472/32000 (30%)] Loss: 0.16680 (QuantReg: 12.39442) QuantErr: 12.39442 batch_time=0.37654 
Train Epoch: 37 [301/1000 9632/32000 (30%)] Loss: 0.20745 (QuantReg: 13.31256) QuantErr: 13.31256 batch_time=0.36386 
Train Epoch: 37 [306/1000 9792/32000 (31%)] Loss: 0.22093 (QuantReg: 12.89680) QuantErr: 12.89680 batch_time=0.34761 
Train Epoch: 37 [311/1000 9952/32000 (31%)] Loss: 0.32160 (QuantReg: 13.04285) QuantErr: 13.04285 batch_time=0.35097 
Train Epoch: 37 [316/1000 10112/32000 (32%)] Loss: 0.72262 (QuantReg: 12.94049) QuantErr: 12.94049 batch_time=0.38412 
Train Epoch: 37 [321/1000 10272/32000 (32%)] Loss: 0.38176 (QuantReg: 12.64336) QuantErr: 12.64336 batch_time=0.46936 
Train Epoch: 37 [326/1000 10432/32000 (33%)] Loss: 0.62823 (QuantReg: 11.86805) QuantErr: 11.86805 batch_time=0.36165 
Train Epoch: 37 [331/1000 10592/32000 (33%)] Loss: 0.17469 (QuantReg: 12.25146) QuantErr: 12.25146 batch_time=0.38473 
Train Epoch: 37 [336/1000 10752/32000 (34%)] Loss: 0.35700 (QuantReg: 12.80910) QuantErr: 12.80910 batch_time=0.37924 
Train Epoch: 37 [341/1000 10912/32000 (34%)] Loss: 0.24097 (QuantReg: 12.65780) QuantErr: 12.65780 batch_time=0.39984 
Train Epoch: 37 [346/1000 11072/32000 (35%)] Loss: 0.43161 (QuantReg: 12.25678) QuantErr: 12.25678 batch_time=0.41537 
Train Epoch: 37 [351/1000 11232/32000 (35%)] Loss: 0.29705 (QuantReg: 12.93524) QuantErr: 12.93524 batch_time=0.34781 
Train Epoch: 37 [356/1000 11392/32000 (36%)] Loss: 0.11016 (QuantReg: 12.83315) QuantErr: 12.83315 batch_time=0.35846 
Train Epoch: 37 [361/1000 11552/32000 (36%)] Loss: 0.32945 (QuantReg: 12.73374) QuantErr: 12.73374 batch_time=0.38878 
Train Epoch: 37 [366/1000 11712/32000 (37%)] Loss: 0.61335 (QuantReg: 12.57041) QuantErr: 12.57041 batch_time=0.36055 
Train Epoch: 37 [371/1000 11872/32000 (37%)] Loss: 0.31501 (QuantReg: 12.63634) QuantErr: 12.63634 batch_time=0.35872 
Train Epoch: 37 [376/1000 12032/32000 (38%)] Loss: 0.43525 (QuantReg: 12.49425) QuantErr: 12.49425 batch_time=0.37857 
Train Epoch: 37 [381/1000 12192/32000 (38%)] Loss: 0.18896 (QuantReg: 13.09765) QuantErr: 13.09765 batch_time=0.36364 
Train Epoch: 37 [386/1000 12352/32000 (39%)] Loss: 0.45172 (QuantReg: 12.35633) QuantErr: 12.35633 batch_time=0.41717 
Train Epoch: 37 [391/1000 12512/32000 (39%)] Loss: 0.19934 (QuantReg: 12.46127) QuantErr: 12.46127 batch_time=0.35086 
Train Epoch: 37 [396/1000 12672/32000 (40%)] Loss: 0.16739 (QuantReg: 13.30765) QuantErr: 13.30765 batch_time=0.33563 
Train Epoch: 37 [401/1000 12832/32000 (40%)] Loss: 0.59783 (QuantReg: 13.07631) QuantErr: 13.07631 batch_time=0.35970 
Train Epoch: 37 [406/1000 12992/32000 (41%)] Loss: 0.32109 (QuantReg: 12.74241) QuantErr: 12.74241 batch_time=0.36729 
Train Epoch: 37 [411/1000 13152/32000 (41%)] Loss: 0.22953 (QuantReg: 12.80542) QuantErr: 12.80542 batch_time=0.39816 
Train Epoch: 37 [416/1000 13312/32000 (42%)] Loss: 0.38825 (QuantReg: 13.22223) QuantErr: 13.22223 batch_time=0.36732 
Train Epoch: 37 [421/1000 13472/32000 (42%)] Loss: 0.33627 (QuantReg: 13.12065) QuantErr: 13.12065 batch_time=0.38109 
Train Epoch: 37 [426/1000 13632/32000 (43%)] Loss: 0.26803 (QuantReg: 12.57608) QuantErr: 12.57608 batch_time=0.36655 
Train Epoch: 37 [431/1000 13792/32000 (43%)] Loss: 0.37092 (QuantReg: 13.02660) QuantErr: 13.02660 batch_time=0.34988 
Train Epoch: 37 [436/1000 13952/32000 (44%)] Loss: 0.49661 (QuantReg: 12.86120) QuantErr: 12.86120 batch_time=0.39470 
Train Epoch: 37 [441/1000 14112/32000 (44%)] Loss: 0.15435 (QuantReg: 12.56780) QuantErr: 12.56780 batch_time=0.34987 
Train Epoch: 37 [446/1000 14272/32000 (45%)] Loss: 0.07496 (QuantReg: 12.29167) QuantErr: 12.29167 batch_time=0.35493 
Train Epoch: 37 [451/1000 14432/32000 (45%)] Loss: 0.40589 (QuantReg: 13.22965) QuantErr: 13.22965 batch_time=0.94094 
Train Epoch: 37 [456/1000 14592/32000 (46%)] Loss: 0.43814 (QuantReg: 12.35756) QuantErr: 12.35756 batch_time=0.35618 
Train Epoch: 37 [461/1000 14752/32000 (46%)] Loss: 0.32860 (QuantReg: 12.81053) QuantErr: 12.81053 batch_time=0.36801 
Train Epoch: 37 [466/1000 14912/32000 (47%)] Loss: 0.57452 (QuantReg: 12.74506) QuantErr: 12.74506 batch_time=0.36215 
Train Epoch: 37 [471/1000 15072/32000 (47%)] Loss: 0.16840 (QuantReg: 12.44949) QuantErr: 12.44949 batch_time=0.34828 
Train Epoch: 37 [476/1000 15232/32000 (48%)] Loss: 0.17757 (QuantReg: 13.25846) QuantErr: 13.25846 batch_time=0.38266 
Train Epoch: 37 [481/1000 15392/32000 (48%)] Loss: 0.30665 (QuantReg: 12.69702) QuantErr: 12.69702 batch_time=1.23176 
Train Epoch: 37 [486/1000 15552/32000 (49%)] Loss: 0.17765 (QuantReg: 12.65599) QuantErr: 12.65599 batch_time=0.46370 
Train Epoch: 37 [491/1000 15712/32000 (49%)] Loss: 0.52067 (QuantReg: 12.76699) QuantErr: 12.76699 batch_time=0.35868 
Train Epoch: 37 [496/1000 15872/32000 (50%)] Loss: 0.36579 (QuantReg: 12.57049) QuantErr: 12.57049 batch_time=0.35746 
Train Epoch: 37 [501/1000 16032/32000 (50%)] Loss: 0.83978 (QuantReg: 12.13731) QuantErr: 12.13731 batch_time=0.36943 
Train Epoch: 37 [506/1000 16192/32000 (51%)] Loss: 0.38446 (QuantReg: 12.58018) QuantErr: 12.58018 batch_time=0.35211 
Train Epoch: 37 [511/1000 16352/32000 (51%)] Loss: 0.47504 (QuantReg: 12.62147) QuantErr: 12.62147 batch_time=0.38956 
Train Epoch: 37 [516/1000 16512/32000 (52%)] Loss: 0.78553 (QuantReg: 12.77037) QuantErr: 12.77037 batch_time=0.34708 
Train Epoch: 37 [521/1000 16672/32000 (52%)] Loss: 0.32490 (QuantReg: 12.64348) QuantErr: 12.64348 batch_time=0.34909 
Train Epoch: 37 [526/1000 16832/32000 (53%)] Loss: 0.23660 (QuantReg: 12.66233) QuantErr: 12.66233 batch_time=0.35170 
Train Epoch: 37 [531/1000 16992/32000 (53%)] Loss: 0.17576 (QuantReg: 12.79700) QuantErr: 12.79700 batch_time=0.37378 
Train Epoch: 37 [536/1000 17152/32000 (54%)] Loss: 0.16145 (QuantReg: 12.57754) QuantErr: 12.57754 batch_time=0.36276 
Train Epoch: 37 [541/1000 17312/32000 (54%)] Loss: 0.47467 (QuantReg: 12.62379) QuantErr: 12.62379 batch_time=0.37687 
Train Epoch: 37 [546/1000 17472/32000 (55%)] Loss: 0.53023 (QuantReg: 12.37657) QuantErr: 12.37657 batch_time=0.35127 
Train Epoch: 37 [551/1000 17632/32000 (55%)] Loss: 0.15991 (QuantReg: 12.56676) QuantErr: 12.56676 batch_time=0.35143 
Train Epoch: 37 [556/1000 17792/32000 (56%)] Loss: 0.30763 (QuantReg: 12.51583) QuantErr: 12.51583 batch_time=0.57157 
Train Epoch: 37 [561/1000 17952/32000 (56%)] Loss: 0.11872 (QuantReg: 13.24265) QuantErr: 13.24265 batch_time=0.34605 
Train Epoch: 37 [566/1000 18112/32000 (57%)] Loss: 0.69746 (QuantReg: 12.84235) QuantErr: 12.84235 batch_time=0.35709 
Train Epoch: 37 [571/1000 18272/32000 (57%)] Loss: 0.18466 (QuantReg: 13.23563) QuantErr: 13.23563 batch_time=0.36144 
Train Epoch: 37 [576/1000 18432/32000 (58%)] Loss: 0.19611 (QuantReg: 12.36795) QuantErr: 12.36795 batch_time=0.35962 
Train Epoch: 37 [581/1000 18592/32000 (58%)] Loss: 0.35636 (QuantReg: 13.43606) QuantErr: 13.43606 batch_time=0.37120 
Train Epoch: 37 [586/1000 18752/32000 (59%)] Loss: 0.18948 (QuantReg: 12.40865) QuantErr: 12.40865 batch_time=0.37970 
Train Epoch: 37 [591/1000 18912/32000 (59%)] Loss: 0.35651 (QuantReg: 12.31692) QuantErr: 12.31692 batch_time=0.34661 
Train Epoch: 37 [596/1000 19072/32000 (60%)] Loss: 0.29129 (QuantReg: 13.00484) QuantErr: 13.00484 batch_time=0.43926 
Train Epoch: 37 [601/1000 19232/32000 (60%)] Loss: 0.78731 (QuantReg: 12.85990) QuantErr: 12.85990 batch_time=0.35270 
Train Epoch: 37 [606/1000 19392/32000 (61%)] Loss: 0.33758 (QuantReg: 12.81101) QuantErr: 12.81101 batch_time=0.34720 
Train Epoch: 37 [611/1000 19552/32000 (61%)] Loss: 0.27677 (QuantReg: 12.95576) QuantErr: 12.95576 batch_time=0.36341 
Train Epoch: 37 [616/1000 19712/32000 (62%)] Loss: 0.30917 (QuantReg: 12.26738) QuantErr: 12.26738 batch_time=0.34752 
Train Epoch: 37 [621/1000 19872/32000 (62%)] Loss: 0.46092 (QuantReg: 12.71757) QuantErr: 12.71757 batch_time=0.37092 
Train Epoch: 37 [626/1000 20032/32000 (63%)] Loss: 0.26946 (QuantReg: 13.37175) QuantErr: 13.37175 batch_time=0.37866 
Train Epoch: 37 [631/1000 20192/32000 (63%)] Loss: 0.46750 (QuantReg: 12.27551) QuantErr: 12.27551 batch_time=0.40845 
Train Epoch: 37 [636/1000 20352/32000 (64%)] Loss: 0.39148 (QuantReg: 12.31319) QuantErr: 12.31319 batch_time=0.39346 
Train Epoch: 37 [641/1000 20512/32000 (64%)] Loss: 0.27288 (QuantReg: 12.44363) QuantErr: 12.44363 batch_time=0.48209 
Train Epoch: 37 [646/1000 20672/32000 (65%)] Loss: 0.17795 (QuantReg: 12.75077) QuantErr: 12.75077 batch_time=0.34227 
Train Epoch: 37 [651/1000 20832/32000 (65%)] Loss: 0.25817 (QuantReg: 12.24163) QuantErr: 12.24163 batch_time=0.35001 
Train Epoch: 37 [656/1000 20992/32000 (66%)] Loss: 0.31042 (QuantReg: 13.12436) QuantErr: 13.12436 batch_time=0.36793 
Train Epoch: 37 [661/1000 21152/32000 (66%)] Loss: 0.13214 (QuantReg: 13.54631) QuantErr: 13.54631 batch_time=0.35380 
Train Epoch: 37 [666/1000 21312/32000 (67%)] Loss: 0.64030 (QuantReg: 11.91663) QuantErr: 11.91663 batch_time=0.36796 
Train Epoch: 37 [671/1000 21472/32000 (67%)] Loss: 0.30740 (QuantReg: 12.83179) QuantErr: 12.83179 batch_time=0.35026 
Train Epoch: 37 [676/1000 21632/32000 (68%)] Loss: 0.73954 (QuantReg: 12.81504) QuantErr: 12.81504 batch_time=0.35330 
Train Epoch: 37 [681/1000 21792/32000 (68%)] Loss: 0.13118 (QuantReg: 13.01201) QuantErr: 13.01201 batch_time=0.36946 
Train Epoch: 37 [686/1000 21952/32000 (69%)] Loss: 0.53063 (QuantReg: 12.84332) QuantErr: 12.84332 batch_time=0.45614 
Train Epoch: 37 [691/1000 22112/32000 (69%)] Loss: 0.13301 (QuantReg: 13.12371) QuantErr: 13.12371 batch_time=0.36152 
Train Epoch: 37 [696/1000 22272/32000 (70%)] Loss: 0.37495 (QuantReg: 12.74964) QuantErr: 12.74964 batch_time=0.34060 
Train Epoch: 37 [701/1000 22432/32000 (70%)] Loss: 0.50748 (QuantReg: 13.08063) QuantErr: 13.08063 batch_time=0.34170 
Train Epoch: 37 [706/1000 22592/32000 (71%)] Loss: 0.13388 (QuantReg: 12.46058) QuantErr: 12.46058 batch_time=0.40082 
Train Epoch: 37 [711/1000 22752/32000 (71%)] Loss: 0.59925 (QuantReg: 13.37272) QuantErr: 13.37272 batch_time=0.38074 
Train Epoch: 37 [716/1000 22912/32000 (72%)] Loss: 0.38277 (QuantReg: 12.75854) QuantErr: 12.75854 batch_time=0.34998 
Train Epoch: 37 [721/1000 23072/32000 (72%)] Loss: 0.62724 (QuantReg: 12.59137) QuantErr: 12.59137 batch_time=0.47410 
Train Epoch: 37 [726/1000 23232/32000 (73%)] Loss: 0.61011 (QuantReg: 13.25414) QuantErr: 13.25414 batch_time=0.44392 
Train Epoch: 37 [731/1000 23392/32000 (73%)] Loss: 0.26638 (QuantReg: 12.96485) QuantErr: 12.96485 batch_time=0.35819 
Train Epoch: 37 [736/1000 23552/32000 (74%)] Loss: 0.18018 (QuantReg: 13.05395) QuantErr: 13.05395 batch_time=0.36537 
Train Epoch: 37 [741/1000 23712/32000 (74%)] Loss: 0.35682 (QuantReg: 12.53957) QuantErr: 12.53957 batch_time=0.34770 
Train Epoch: 37 [746/1000 23872/32000 (75%)] Loss: 0.24607 (QuantReg: 12.85988) QuantErr: 12.85988 batch_time=0.34279 
Train Epoch: 37 [751/1000 24032/32000 (75%)] Loss: 0.18156 (QuantReg: 13.06612) QuantErr: 13.06612 batch_time=0.39041 
Train Epoch: 37 [756/1000 24192/32000 (76%)] Loss: 0.19903 (QuantReg: 13.37519) QuantErr: 13.37519 batch_time=0.34838 
Train Epoch: 37 [761/1000 24352/32000 (76%)] Loss: 0.53386 (QuantReg: 12.18825) QuantErr: 12.18825 batch_time=0.35233 
Train Epoch: 37 [766/1000 24512/32000 (77%)] Loss: 0.14377 (QuantReg: 12.62242) QuantErr: 12.62242 batch_time=0.36358 
Train Epoch: 37 [771/1000 24672/32000 (77%)] Loss: 0.40373 (QuantReg: 12.18583) QuantErr: 12.18583 batch_time=0.92602 
Train Epoch: 37 [776/1000 24832/32000 (78%)] Loss: 0.38871 (QuantReg: 12.47528) QuantErr: 12.47528 batch_time=0.35167 
Train Epoch: 37 [781/1000 24992/32000 (78%)] Loss: 0.45858 (QuantReg: 12.97485) QuantErr: 12.97485 batch_time=0.37375 
Train Epoch: 37 [786/1000 25152/32000 (79%)] Loss: 0.15192 (QuantReg: 12.96913) QuantErr: 12.96913 batch_time=0.39275 
Train Epoch: 37 [791/1000 25312/32000 (79%)] Loss: 0.25765 (QuantReg: 12.62768) QuantErr: 12.62768 batch_time=0.38049 
Train Epoch: 37 [796/1000 25472/32000 (80%)] Loss: 0.29289 (QuantReg: 13.00244) QuantErr: 13.00244 batch_time=0.34574 
Train Epoch: 37 [801/1000 25632/32000 (80%)] Loss: 0.47940 (QuantReg: 13.55310) QuantErr: 13.55310 batch_time=1.18554 
Train Epoch: 37 [806/1000 25792/32000 (81%)] Loss: 0.18749 (QuantReg: 12.50858) QuantErr: 12.50858 batch_time=0.43623 
Train Epoch: 37 [811/1000 25952/32000 (81%)] Loss: 0.28388 (QuantReg: 12.78256) QuantErr: 12.78256 batch_time=0.34982 
Train Epoch: 37 [816/1000 26112/32000 (82%)] Loss: 0.25195 (QuantReg: 13.20991) QuantErr: 13.20991 batch_time=0.36246 
Train Epoch: 37 [821/1000 26272/32000 (82%)] Loss: 0.16577 (QuantReg: 12.65186) QuantErr: 12.65186 batch_time=0.40090 
Train Epoch: 37 [826/1000 26432/32000 (83%)] Loss: 0.35406 (QuantReg: 12.93023) QuantErr: 12.93023 batch_time=0.35184 
Train Epoch: 37 [831/1000 26592/32000 (83%)] Loss: 0.41619 (QuantReg: 13.42592) QuantErr: 13.42592 batch_time=0.35111 
Train Epoch: 37 [836/1000 26752/32000 (84%)] Loss: 0.21226 (QuantReg: 13.15998) QuantErr: 13.15998 batch_time=0.35270 
Train Epoch: 37 [841/1000 26912/32000 (84%)] Loss: 0.08406 (QuantReg: 13.06578) QuantErr: 13.06578 batch_time=0.34476 
Train Epoch: 37 [846/1000 27072/32000 (85%)] Loss: 0.15051 (QuantReg: 12.91769) QuantErr: 12.91769 batch_time=0.35954 
Train Epoch: 37 [851/1000 27232/32000 (85%)] Loss: 0.44719 (QuantReg: 12.21369) QuantErr: 12.21369 batch_time=0.39780 
Train Epoch: 37 [856/1000 27392/32000 (86%)] Loss: 0.26268 (QuantReg: 13.04525) QuantErr: 13.04525 batch_time=0.36784 
Train Epoch: 37 [861/1000 27552/32000 (86%)] Loss: 0.09255 (QuantReg: 12.87180) QuantErr: 12.87180 batch_time=0.34888 
Train Epoch: 37 [866/1000 27712/32000 (87%)] Loss: 0.22178 (QuantReg: 12.37103) QuantErr: 12.37103 batch_time=0.43372 
Train Epoch: 37 [871/1000 27872/32000 (87%)] Loss: 0.31661 (QuantReg: 12.70414) QuantErr: 12.70414 batch_time=0.35579 
Train Epoch: 37 [876/1000 28032/32000 (88%)] Loss: 0.37260 (QuantReg: 12.53586) QuantErr: 12.53586 batch_time=0.60783 
Train Epoch: 37 [881/1000 28192/32000 (88%)] Loss: 0.10627 (QuantReg: 12.89441) QuantErr: 12.89441 batch_time=0.39103 
Train Epoch: 37 [886/1000 28352/32000 (89%)] Loss: 0.20403 (QuantReg: 12.23545) QuantErr: 12.23545 batch_time=0.37255 
Train Epoch: 37 [891/1000 28512/32000 (89%)] Loss: 0.47638 (QuantReg: 12.82516) QuantErr: 12.82516 batch_time=0.35567 
Train Epoch: 37 [896/1000 28672/32000 (90%)] Loss: 0.35436 (QuantReg: 12.62981) QuantErr: 12.62981 batch_time=0.35028 
Train Epoch: 37 [901/1000 28832/32000 (90%)] Loss: 0.37651 (QuantReg: 12.26793) QuantErr: 12.26793 batch_time=0.34920 
Train Epoch: 37 [906/1000 28992/32000 (91%)] Loss: 0.46317 (QuantReg: 13.06461) QuantErr: 13.06461 batch_time=0.35699 
Train Epoch: 37 [911/1000 29152/32000 (91%)] Loss: 0.13384 (QuantReg: 12.78560) QuantErr: 12.78560 batch_time=0.34828 
Train Epoch: 37 [916/1000 29312/32000 (92%)] Loss: 0.56516 (QuantReg: 13.27469) QuantErr: 13.27469 batch_time=0.42555 
Train Epoch: 37 [921/1000 29472/32000 (92%)] Loss: 0.58015 (QuantReg: 13.33854) QuantErr: 13.33854 batch_time=0.46028 
Train Epoch: 37 [926/1000 29632/32000 (93%)] Loss: 0.21817 (QuantReg: 12.62513) QuantErr: 12.62513 batch_time=0.37248 
Train Epoch: 37 [931/1000 29792/32000 (93%)] Loss: 0.31102 (QuantReg: 13.31429) QuantErr: 13.31429 batch_time=0.36477 
Train Epoch: 37 [936/1000 29952/32000 (94%)] Loss: 0.32133 (QuantReg: 13.12939) QuantErr: 13.12939 batch_time=0.35462 
Train Epoch: 37 [941/1000 30112/32000 (94%)] Loss: 0.20800 (QuantReg: 13.10933) QuantErr: 13.10933 batch_time=0.37162 
Train Epoch: 37 [946/1000 30272/32000 (95%)] Loss: 0.20136 (QuantReg: 13.08620) QuantErr: 13.08620 batch_time=0.38378 
Train Epoch: 37 [951/1000 30432/32000 (95%)] Loss: 0.08701 (QuantReg: 12.74144) QuantErr: 12.74144 batch_time=0.43678 
Train Epoch: 37 [956/1000 30592/32000 (96%)] Loss: 0.38373 (QuantReg: 13.08551) QuantErr: 13.08551 batch_time=0.35528 
Train Epoch: 37 [961/1000 30752/32000 (96%)] Loss: 0.23143 (QuantReg: 12.96180) QuantErr: 12.96180 batch_time=0.50553 
Train Epoch: 37 [966/1000 30912/32000 (97%)] Loss: 0.26905 (QuantReg: 12.95650) QuantErr: 12.95650 batch_time=0.35306 
Train Epoch: 37 [971/1000 31072/32000 (97%)] Loss: 0.14354 (QuantReg: 13.30105) QuantErr: 13.30105 batch_time=0.44709 
Train Epoch: 37 [976/1000 31232/32000 (98%)] Loss: 0.15318 (QuantReg: 13.33783) QuantErr: 13.33783 batch_time=0.35037 
Train Epoch: 37 [981/1000 31392/32000 (98%)] Loss: 0.41564 (QuantReg: 13.01163) QuantErr: 13.01163 batch_time=0.39504 
Train Epoch: 37 [986/1000 31552/32000 (99%)] Loss: 0.23178 (QuantReg: 12.92544) QuantErr: 12.92544 batch_time=0.36392 
Train Epoch: 37 [991/1000 31712/32000 (99%)] Loss: 0.39456 (QuantReg: 12.89170) QuantErr: 12.89170 batch_time=0.42797 
Train Epoch: 37 [996/1000 31872/32000 (100%)] Loss: 0.08443 (QuantReg: 12.87909) QuantErr: 12.87909 batch_time=0.34674 
Train Epoch: 37 codebook_update_time=1.98717
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch37.pth ...
Done in 4.863s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 0.31448370384052393
 quant_reg      : 12.76583188533783
 quant_err      : 12.76583188533783
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 37000
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 67.00201207243461
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.267605633802816
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.627546522210736
 MSRVTT_full_val/v2t_metrics/R1: 35.2112676056338
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.3199195171026155
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.30451676767399
 MSRVTT_full_test/t2v_metrics/R1: 12.441471571906355
 MSRVTT_full_test/t2v_metrics/R5: 36.020066889632105
 MSRVTT_full_test/t2v_metrics/R10: 49.66555183946488
 MSRVTT_full_test/t2v_metrics/R50: 80.20066889632108
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.32775919732441
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.129186810689994
 MSRVTT_full_test/v2t_metrics/R1: 15.819397993311037
 MSRVTT_full_test/v2t_metrics/R5: 42.441471571906355
 MSRVTT_full_test/v2t_metrics/R10: 57.357859531772576
 MSRVTT_full_test/v2t_metrics/R50: 86.2876254180602
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.20301003344482
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.76948525258607
 mnt_best       : 29.218703131434403
 not_improved_count: 2
Train Epoch: 38 [1/1000 32/32000 (0%)] Loss: 0.19195 (QuantReg: 12.43572) QuantErr: 12.43572 batch_time=26.67824 
Train Epoch: 38 [6/1000 192/32000 (1%)] Loss: 0.32532 (QuantReg: 12.72381) QuantErr: 12.72381 batch_time=0.36827 
Train Epoch: 38 [11/1000 352/32000 (1%)] Loss: 0.51729 (QuantReg: 11.77960) QuantErr: 11.77960 batch_time=0.40658 
Train Epoch: 38 [16/1000 512/32000 (2%)] Loss: 0.32760 (QuantReg: 12.84441) QuantErr: 12.84441 batch_time=0.40222 
Train Epoch: 38 [21/1000 672/32000 (2%)] Loss: 0.22165 (QuantReg: 12.33216) QuantErr: 12.33216 batch_time=0.38030 
Train Epoch: 38 [26/1000 832/32000 (3%)] Loss: 0.29010 (QuantReg: 12.82690) QuantErr: 12.82690 batch_time=0.39636 
Train Epoch: 38 [31/1000 992/32000 (3%)] Loss: 0.39293 (QuantReg: 12.64574) QuantErr: 12.64574 batch_time=0.37647 
Train Epoch: 38 [36/1000 1152/32000 (4%)] Loss: 0.39171 (QuantReg: 12.26725) QuantErr: 12.26725 batch_time=0.41450 
Train Epoch: 38 [41/1000 1312/32000 (4%)] Loss: 0.20986 (QuantReg: 12.81792) QuantErr: 12.81792 batch_time=0.40155 
Train Epoch: 38 [46/1000 1472/32000 (5%)] Loss: 0.19481 (QuantReg: 12.66513) QuantErr: 12.66513 batch_time=0.38344 
Train Epoch: 38 [51/1000 1632/32000 (5%)] Loss: 0.36411 (QuantReg: 12.55732) QuantErr: 12.55732 batch_time=0.42003 
Train Epoch: 38 [56/1000 1792/32000 (6%)] Loss: 0.20794 (QuantReg: 12.66047) QuantErr: 12.66047 batch_time=0.43611 
Train Epoch: 38 [61/1000 1952/32000 (6%)] Loss: 0.48911 (QuantReg: 12.17233) QuantErr: 12.17233 batch_time=0.37170 
Train Epoch: 38 [66/1000 2112/32000 (7%)] Loss: 0.17539 (QuantReg: 13.02040) QuantErr: 13.02040 batch_time=0.54979 
Train Epoch: 38 [71/1000 2272/32000 (7%)] Loss: 0.29087 (QuantReg: 12.91006) QuantErr: 12.91006 batch_time=0.45498 
Train Epoch: 38 [76/1000 2432/32000 (8%)] Loss: 0.09889 (QuantReg: 12.84896) QuantErr: 12.84896 batch_time=0.40311 
Train Epoch: 38 [81/1000 2592/32000 (8%)] Loss: 0.39348 (QuantReg: 13.01043) QuantErr: 13.01043 batch_time=0.59012 
Train Epoch: 38 [86/1000 2752/32000 (9%)] Loss: 0.16509 (QuantReg: 12.49700) QuantErr: 12.49700 batch_time=0.39959 
Train Epoch: 38 [91/1000 2912/32000 (9%)] Loss: 0.23339 (QuantReg: 13.23767) QuantErr: 13.23767 batch_time=0.45497 
Train Epoch: 38 [96/1000 3072/32000 (10%)] Loss: 0.33789 (QuantReg: 13.00371) QuantErr: 13.00371 batch_time=0.36632 
Train Epoch: 38 [101/1000 3232/32000 (10%)] Loss: 0.14967 (QuantReg: 13.15520) QuantErr: 13.15520 batch_time=0.50410 
Train Epoch: 38 [106/1000 3392/32000 (11%)] Loss: 0.31164 (QuantReg: 12.32864) QuantErr: 12.32864 batch_time=0.38665 
Train Epoch: 38 [111/1000 3552/32000 (11%)] Loss: 0.34739 (QuantReg: 12.50990) QuantErr: 12.50990 batch_time=0.38831 
Train Epoch: 38 [116/1000 3712/32000 (12%)] Loss: 0.45655 (QuantReg: 12.74153) QuantErr: 12.74153 batch_time=0.37516 
Train Epoch: 38 [121/1000 3872/32000 (12%)] Loss: 0.33336 (QuantReg: 13.15058) QuantErr: 13.15058 batch_time=0.42811 
Train Epoch: 38 [126/1000 4032/32000 (13%)] Loss: 0.32788 (QuantReg: 12.99070) QuantErr: 12.99070 batch_time=0.46814 
Train Epoch: 38 [131/1000 4192/32000 (13%)] Loss: 0.24781 (QuantReg: 13.05803) QuantErr: 13.05803 batch_time=0.39178 
Train Epoch: 38 [136/1000 4352/32000 (14%)] Loss: 0.25832 (QuantReg: 12.90004) QuantErr: 12.90004 batch_time=0.40634 
Train Epoch: 38 [141/1000 4512/32000 (14%)] Loss: 0.19436 (QuantReg: 12.19087) QuantErr: 12.19087 batch_time=0.43225 
Train Epoch: 38 [146/1000 4672/32000 (15%)] Loss: 0.43901 (QuantReg: 11.45248) QuantErr: 11.45248 batch_time=0.36523 
Train Epoch: 38 [151/1000 4832/32000 (15%)] Loss: 0.20436 (QuantReg: 12.76739) QuantErr: 12.76739 batch_time=0.38605 
Train Epoch: 38 [156/1000 4992/32000 (16%)] Loss: 0.50411 (QuantReg: 12.54494) QuantErr: 12.54494 batch_time=0.40034 
Train Epoch: 38 [161/1000 5152/32000 (16%)] Loss: 0.34785 (QuantReg: 12.88470) QuantErr: 12.88470 batch_time=0.36882 
Train Epoch: 38 [166/1000 5312/32000 (17%)] Loss: 0.25184 (QuantReg: 13.19969) QuantErr: 13.19969 batch_time=0.38435 
Train Epoch: 38 [171/1000 5472/32000 (17%)] Loss: 0.22563 (QuantReg: 13.21648) QuantErr: 13.21648 batch_time=0.37378 
Train Epoch: 38 [176/1000 5632/32000 (18%)] Loss: 0.22667 (QuantReg: 13.18787) QuantErr: 13.18787 batch_time=0.40734 
Train Epoch: 38 [181/1000 5792/32000 (18%)] Loss: 0.12106 (QuantReg: 12.69178) QuantErr: 12.69178 batch_time=0.35068 
Train Epoch: 38 [186/1000 5952/32000 (19%)] Loss: 0.15973 (QuantReg: 12.97370) QuantErr: 12.97370 batch_time=0.35986 
Train Epoch: 38 [191/1000 6112/32000 (19%)] Loss: 0.19437 (QuantReg: 12.76378) QuantErr: 12.76378 batch_time=0.40857 
Train Epoch: 38 [196/1000 6272/32000 (20%)] Loss: 0.66560 (QuantReg: 11.73105) QuantErr: 11.73105 batch_time=0.45217 
Train Epoch: 38 [201/1000 6432/32000 (20%)] Loss: 0.59420 (QuantReg: 12.29329) QuantErr: 12.29329 batch_time=0.45216 
Train Epoch: 38 [206/1000 6592/32000 (21%)] Loss: 0.27007 (QuantReg: 13.19929) QuantErr: 13.19929 batch_time=0.41925 
Train Epoch: 38 [211/1000 6752/32000 (21%)] Loss: 0.44194 (QuantReg: 12.35999) QuantErr: 12.35999 batch_time=0.38136 
Train Epoch: 38 [216/1000 6912/32000 (22%)] Loss: 0.39069 (QuantReg: 11.68881) QuantErr: 11.68881 batch_time=0.42232 
Train Epoch: 38 [221/1000 7072/32000 (22%)] Loss: 0.17566 (QuantReg: 13.28618) QuantErr: 13.28618 batch_time=0.34367 
Train Epoch: 38 [226/1000 7232/32000 (23%)] Loss: 0.16628 (QuantReg: 12.58475) QuantErr: 12.58475 batch_time=0.39362 
Train Epoch: 38 [231/1000 7392/32000 (23%)] Loss: 0.21634 (QuantReg: 13.28687) QuantErr: 13.28687 batch_time=0.34582 
Train Epoch: 38 [236/1000 7552/32000 (24%)] Loss: 0.20702 (QuantReg: 12.75689) QuantErr: 12.75689 batch_time=0.34675 
Train Epoch: 38 [241/1000 7712/32000 (24%)] Loss: 0.27637 (QuantReg: 11.96621) QuantErr: 11.96621 batch_time=0.34068 
Train Epoch: 38 [246/1000 7872/32000 (25%)] Loss: 0.42296 (QuantReg: 12.50742) QuantErr: 12.50742 batch_time=0.36715 
Train Epoch: 38 [251/1000 8032/32000 (25%)] Loss: 0.36959 (QuantReg: 13.21975) QuantErr: 13.21975 batch_time=0.37152 
Train Epoch: 38 [256/1000 8192/32000 (26%)] Loss: 0.20199 (QuantReg: 12.75547) QuantErr: 12.75547 batch_time=0.36280 
Train Epoch: 38 [261/1000 8352/32000 (26%)] Loss: 0.26374 (QuantReg: 13.04940) QuantErr: 13.04940 batch_time=0.51200 
Train Epoch: 38 [266/1000 8512/32000 (27%)] Loss: 0.34528 (QuantReg: 12.31296) QuantErr: 12.31296 batch_time=0.37300 
Train Epoch: 38 [271/1000 8672/32000 (27%)] Loss: 0.39400 (QuantReg: 12.29377) QuantErr: 12.29377 batch_time=0.37628 
Train Epoch: 38 [276/1000 8832/32000 (28%)] Loss: 0.33957 (QuantReg: 12.60333) QuantErr: 12.60333 batch_time=0.38410 
Train Epoch: 38 [281/1000 8992/32000 (28%)] Loss: 0.47491 (QuantReg: 12.57293) QuantErr: 12.57293 batch_time=0.39365 
Train Epoch: 38 [286/1000 9152/32000 (29%)] Loss: 0.32435 (QuantReg: 12.73071) QuantErr: 12.73071 batch_time=0.37036 
Train Epoch: 38 [291/1000 9312/32000 (29%)] Loss: 0.27720 (QuantReg: 12.97174) QuantErr: 12.97174 batch_time=0.39794 
Train Epoch: 38 [296/1000 9472/32000 (30%)] Loss: 0.33192 (QuantReg: 12.37947) QuantErr: 12.37947 batch_time=0.38954 
Train Epoch: 38 [301/1000 9632/32000 (30%)] Loss: 0.42433 (QuantReg: 12.74710) QuantErr: 12.74710 batch_time=0.36222 
Train Epoch: 38 [306/1000 9792/32000 (31%)] Loss: 0.62118 (QuantReg: 12.76188) QuantErr: 12.76188 batch_time=0.36971 
Train Epoch: 38 [311/1000 9952/32000 (31%)] Loss: 0.28554 (QuantReg: 12.74688) QuantErr: 12.74688 batch_time=0.35908 
Train Epoch: 38 [316/1000 10112/32000 (32%)] Loss: 0.40076 (QuantReg: 12.41415) QuantErr: 12.41415 batch_time=0.36065 
Train Epoch: 38 [321/1000 10272/32000 (32%)] Loss: 0.50415 (QuantReg: 12.64337) QuantErr: 12.64337 batch_time=0.41119 
Train Epoch: 38 [326/1000 10432/32000 (33%)] Loss: 0.17788 (QuantReg: 13.32938) QuantErr: 13.32938 batch_time=0.38093 
Train Epoch: 38 [331/1000 10592/32000 (33%)] Loss: 0.29902 (QuantReg: 11.99862) QuantErr: 11.99862 batch_time=0.34476 
Train Epoch: 38 [336/1000 10752/32000 (34%)] Loss: 0.33479 (QuantReg: 12.86272) QuantErr: 12.86272 batch_time=0.34489 
Train Epoch: 38 [341/1000 10912/32000 (34%)] Loss: 0.18486 (QuantReg: 12.93091) QuantErr: 12.93091 batch_time=0.34327 
Train Epoch: 38 [346/1000 11072/32000 (35%)] Loss: 0.27064 (QuantReg: 12.81916) QuantErr: 12.81916 batch_time=0.34167 
Train Epoch: 38 [351/1000 11232/32000 (35%)] Loss: 0.07494 (QuantReg: 13.00987) QuantErr: 13.00987 batch_time=0.34445 
Train Epoch: 38 [356/1000 11392/32000 (36%)] Loss: 0.30392 (QuantReg: 13.02013) QuantErr: 13.02013 batch_time=0.33432 
Train Epoch: 38 [361/1000 11552/32000 (36%)] Loss: 0.54000 (QuantReg: 11.63101) QuantErr: 11.63101 batch_time=0.38564 
Train Epoch: 38 [366/1000 11712/32000 (37%)] Loss: 0.18362 (QuantReg: 12.80437) QuantErr: 12.80437 batch_time=0.34267 
Train Epoch: 38 [371/1000 11872/32000 (37%)] Loss: 0.20455 (QuantReg: 12.56064) QuantErr: 12.56064 batch_time=0.34221 
Train Epoch: 38 [376/1000 12032/32000 (38%)] Loss: 0.53491 (QuantReg: 12.33619) QuantErr: 12.33619 batch_time=0.37462 
Train Epoch: 38 [381/1000 12192/32000 (38%)] Loss: 0.35665 (QuantReg: 13.33380) QuantErr: 13.33380 batch_time=0.34149 
Train Epoch: 38 [386/1000 12352/32000 (39%)] Loss: 0.13784 (QuantReg: 12.98692) QuantErr: 12.98692 batch_time=2.25905 
Train Epoch: 38 [391/1000 12512/32000 (39%)] Loss: 0.30130 (QuantReg: 13.09978) QuantErr: 13.09978 batch_time=0.40035 
Train Epoch: 38 [396/1000 12672/32000 (40%)] Loss: 0.48778 (QuantReg: 12.73075) QuantErr: 12.73075 batch_time=0.44676 
Train Epoch: 38 [401/1000 12832/32000 (40%)] Loss: 0.46199 (QuantReg: 12.90544) QuantErr: 12.90544 batch_time=0.45451 
Train Epoch: 38 [406/1000 12992/32000 (41%)] Loss: 0.13518 (QuantReg: 12.99958) QuantErr: 12.99958 batch_time=0.40402 
Train Epoch: 38 [411/1000 13152/32000 (41%)] Loss: 0.28828 (QuantReg: 12.25653) QuantErr: 12.25653 batch_time=0.45897 
Train Epoch: 38 [416/1000 13312/32000 (42%)] Loss: 0.11285 (QuantReg: 13.30400) QuantErr: 13.30400 batch_time=0.42205 
Train Epoch: 38 [421/1000 13472/32000 (42%)] Loss: 0.37873 (QuantReg: 12.14328) QuantErr: 12.14328 batch_time=0.38193 
Train Epoch: 38 [426/1000 13632/32000 (43%)] Loss: 0.51320 (QuantReg: 12.50380) QuantErr: 12.50380 batch_time=0.43659 
Train Epoch: 38 [431/1000 13792/32000 (43%)] Loss: 0.12637 (QuantReg: 12.75613) QuantErr: 12.75613 batch_time=0.39921 
Train Epoch: 38 [436/1000 13952/32000 (44%)] Loss: 0.42218 (QuantReg: 12.32372) QuantErr: 12.32372 batch_time=0.43252 
Train Epoch: 38 [441/1000 14112/32000 (44%)] Loss: 0.64301 (QuantReg: 12.33402) QuantErr: 12.33402 batch_time=0.39977 
Train Epoch: 38 [446/1000 14272/32000 (45%)] Loss: 0.20540 (QuantReg: 12.85641) QuantErr: 12.85641 batch_time=0.39963 
Train Epoch: 38 [451/1000 14432/32000 (45%)] Loss: 0.27407 (QuantReg: 12.67541) QuantErr: 12.67541 batch_time=0.43672 
Train Epoch: 38 [456/1000 14592/32000 (46%)] Loss: 0.19282 (QuantReg: 12.30121) QuantErr: 12.30121 batch_time=0.35806 
Train Epoch: 38 [461/1000 14752/32000 (46%)] Loss: 0.35589 (QuantReg: 12.79569) QuantErr: 12.79569 batch_time=0.41267 
Train Epoch: 38 [466/1000 14912/32000 (47%)] Loss: 0.44333 (QuantReg: 12.92835) QuantErr: 12.92835 batch_time=0.39971 
Train Epoch: 38 [471/1000 15072/32000 (47%)] Loss: 0.18644 (QuantReg: 12.85880) QuantErr: 12.85880 batch_time=0.41494 
Train Epoch: 38 [476/1000 15232/32000 (48%)] Loss: 0.17496 (QuantReg: 13.60142) QuantErr: 13.60142 batch_time=0.38883 
Train Epoch: 38 [481/1000 15392/32000 (48%)] Loss: 0.45094 (QuantReg: 12.46960) QuantErr: 12.46960 batch_time=0.37310 
Train Epoch: 38 [486/1000 15552/32000 (49%)] Loss: 0.15657 (QuantReg: 12.71807) QuantErr: 12.71807 batch_time=0.37064 
Train Epoch: 38 [491/1000 15712/32000 (49%)] Loss: 0.45299 (QuantReg: 13.24824) QuantErr: 13.24824 batch_time=0.39576 
Train Epoch: 38 [496/1000 15872/32000 (50%)] Loss: 0.33775 (QuantReg: 12.82068) QuantErr: 12.82068 batch_time=0.41232 
Train Epoch: 38 [501/1000 16032/32000 (50%)] Loss: 0.26315 (QuantReg: 13.12796) QuantErr: 13.12796 batch_time=0.43873 
Train Epoch: 38 [506/1000 16192/32000 (51%)] Loss: 0.24051 (QuantReg: 12.81347) QuantErr: 12.81347 batch_time=0.37248 
Train Epoch: 38 [511/1000 16352/32000 (51%)] Loss: 0.10472 (QuantReg: 13.34817) QuantErr: 13.34817 batch_time=0.34857 
Train Epoch: 38 [516/1000 16512/32000 (52%)] Loss: 0.40155 (QuantReg: 12.75913) QuantErr: 12.75913 batch_time=0.44038 
Train Epoch: 38 [521/1000 16672/32000 (52%)] Loss: 0.25631 (QuantReg: 12.83797) QuantErr: 12.83797 batch_time=0.42507 
Train Epoch: 38 [526/1000 16832/32000 (53%)] Loss: 0.26481 (QuantReg: 12.50966) QuantErr: 12.50966 batch_time=0.39039 
Train Epoch: 38 [531/1000 16992/32000 (53%)] Loss: 0.27784 (QuantReg: 13.46107) QuantErr: 13.46107 batch_time=0.40297 
Train Epoch: 38 [536/1000 17152/32000 (54%)] Loss: 0.34046 (QuantReg: 12.48394) QuantErr: 12.48394 batch_time=0.39004 
Train Epoch: 38 [541/1000 17312/32000 (54%)] Loss: 0.45077 (QuantReg: 12.75354) QuantErr: 12.75354 batch_time=0.36131 
Train Epoch: 38 [546/1000 17472/32000 (55%)] Loss: 0.20100 (QuantReg: 12.91393) QuantErr: 12.91393 batch_time=0.39054 
Train Epoch: 38 [551/1000 17632/32000 (55%)] Loss: 0.43869 (QuantReg: 12.57363) QuantErr: 12.57363 batch_time=0.42637 
Train Epoch: 38 [556/1000 17792/32000 (56%)] Loss: 0.54545 (QuantReg: 13.00419) QuantErr: 13.00419 batch_time=0.40258 
Train Epoch: 38 [561/1000 17952/32000 (56%)] Loss: 0.55485 (QuantReg: 12.60022) QuantErr: 12.60022 batch_time=0.42540 
Train Epoch: 38 [566/1000 18112/32000 (57%)] Loss: 0.19774 (QuantReg: 12.94505) QuantErr: 12.94505 batch_time=0.38944 
Train Epoch: 38 [571/1000 18272/32000 (57%)] Loss: 0.28437 (QuantReg: 12.64581) QuantErr: 12.64581 batch_time=0.34233 
Train Epoch: 38 [576/1000 18432/32000 (58%)] Loss: 0.21795 (QuantReg: 12.45867) QuantErr: 12.45867 batch_time=0.34731 
Train Epoch: 38 [581/1000 18592/32000 (58%)] Loss: 0.20233 (QuantReg: 12.91951) QuantErr: 12.91951 batch_time=0.33409 
Train Epoch: 38 [586/1000 18752/32000 (59%)] Loss: 0.43313 (QuantReg: 12.58544) QuantErr: 12.58544 batch_time=0.33774 
Train Epoch: 38 [591/1000 18912/32000 (59%)] Loss: 0.49043 (QuantReg: 12.98055) QuantErr: 12.98055 batch_time=0.33935 
Train Epoch: 38 [596/1000 19072/32000 (60%)] Loss: 0.22950 (QuantReg: 12.91017) QuantErr: 12.91017 batch_time=0.38101 
Train Epoch: 38 [601/1000 19232/32000 (60%)] Loss: 0.21429 (QuantReg: 13.05962) QuantErr: 13.05962 batch_time=0.35815 
Train Epoch: 38 [606/1000 19392/32000 (61%)] Loss: 0.26296 (QuantReg: 12.72519) QuantErr: 12.72519 batch_time=0.34776 
Train Epoch: 38 [611/1000 19552/32000 (61%)] Loss: 0.43141 (QuantReg: 12.75126) QuantErr: 12.75126 batch_time=0.35057 
Train Epoch: 38 [616/1000 19712/32000 (62%)] Loss: 0.23695 (QuantReg: 12.79313) QuantErr: 12.79313 batch_time=0.40136 
Train Epoch: 38 [621/1000 19872/32000 (62%)] Loss: 0.23462 (QuantReg: 12.93185) QuantErr: 12.93185 batch_time=0.39498 
Train Epoch: 38 [626/1000 20032/32000 (63%)] Loss: 0.25764 (QuantReg: 12.80028) QuantErr: 12.80028 batch_time=0.40251 
Train Epoch: 38 [631/1000 20192/32000 (63%)] Loss: 0.37737 (QuantReg: 12.77948) QuantErr: 12.77948 batch_time=0.35281 
Train Epoch: 38 [636/1000 20352/32000 (64%)] Loss: 0.26586 (QuantReg: 13.26450) QuantErr: 13.26450 batch_time=0.35420 
Train Epoch: 38 [641/1000 20512/32000 (64%)] Loss: 0.62808 (QuantReg: 12.23143) QuantErr: 12.23143 batch_time=0.35426 
Train Epoch: 38 [646/1000 20672/32000 (65%)] Loss: 0.17453 (QuantReg: 13.05700) QuantErr: 13.05700 batch_time=0.40061 
Train Epoch: 38 [651/1000 20832/32000 (65%)] Loss: 0.33503 (QuantReg: 12.61435) QuantErr: 12.61435 batch_time=0.34930 
Train Epoch: 38 [656/1000 20992/32000 (66%)] Loss: 0.35424 (QuantReg: 12.96860) QuantErr: 12.96860 batch_time=0.35026 
Train Epoch: 38 [661/1000 21152/32000 (66%)] Loss: 0.49963 (QuantReg: 12.35794) QuantErr: 12.35794 batch_time=0.35488 
Train Epoch: 38 [666/1000 21312/32000 (67%)] Loss: 0.27397 (QuantReg: 12.03728) QuantErr: 12.03728 batch_time=0.38398 
Train Epoch: 38 [671/1000 21472/32000 (67%)] Loss: 0.25409 (QuantReg: 12.75217) QuantErr: 12.75217 batch_time=0.37965 
Train Epoch: 38 [676/1000 21632/32000 (68%)] Loss: 0.16018 (QuantReg: 12.56719) QuantErr: 12.56719 batch_time=0.41045 
Train Epoch: 38 [681/1000 21792/32000 (68%)] Loss: 0.19245 (QuantReg: 12.94975) QuantErr: 12.94975 batch_time=0.36778 
Train Epoch: 38 [686/1000 21952/32000 (69%)] Loss: 0.86774 (QuantReg: 12.02610) QuantErr: 12.02610 batch_time=0.38333 
Train Epoch: 38 [691/1000 22112/32000 (69%)] Loss: 0.38650 (QuantReg: 13.15464) QuantErr: 13.15464 batch_time=0.42216 
Train Epoch: 38 [696/1000 22272/32000 (70%)] Loss: 0.39941 (QuantReg: 12.94470) QuantErr: 12.94470 batch_time=0.40227 
Train Epoch: 38 [701/1000 22432/32000 (70%)] Loss: 0.19374 (QuantReg: 12.54767) QuantErr: 12.54767 batch_time=0.42103 
Train Epoch: 38 [706/1000 22592/32000 (71%)] Loss: 0.08480 (QuantReg: 13.21169) QuantErr: 13.21169 batch_time=2.59952 
Train Epoch: 38 [711/1000 22752/32000 (71%)] Loss: 0.20163 (QuantReg: 12.95467) QuantErr: 12.95467 batch_time=0.37735 
Train Epoch: 38 [716/1000 22912/32000 (72%)] Loss: 0.31234 (QuantReg: 12.89317) QuantErr: 12.89317 batch_time=0.38288 
Train Epoch: 38 [721/1000 23072/32000 (72%)] Loss: 0.16109 (QuantReg: 13.20011) QuantErr: 13.20011 batch_time=0.42895 
Train Epoch: 38 [726/1000 23232/32000 (73%)] Loss: 0.39706 (QuantReg: 12.99407) QuantErr: 12.99407 batch_time=0.43949 
Train Epoch: 38 [731/1000 23392/32000 (73%)] Loss: 0.23172 (QuantReg: 12.29109) QuantErr: 12.29109 batch_time=0.39854 
Train Epoch: 38 [736/1000 23552/32000 (74%)] Loss: 0.15107 (QuantReg: 13.11446) QuantErr: 13.11446 batch_time=0.43756 
Train Epoch: 38 [741/1000 23712/32000 (74%)] Loss: 0.13946 (QuantReg: 13.41377) QuantErr: 13.41377 batch_time=0.44275 
Train Epoch: 38 [746/1000 23872/32000 (75%)] Loss: 0.13153 (QuantReg: 12.06568) QuantErr: 12.06568 batch_time=0.38019 
Train Epoch: 38 [751/1000 24032/32000 (75%)] Loss: 0.20593 (QuantReg: 12.85332) QuantErr: 12.85332 batch_time=0.39614 
Train Epoch: 38 [756/1000 24192/32000 (76%)] Loss: 0.30642 (QuantReg: 12.92401) QuantErr: 12.92401 batch_time=0.41282 
Train Epoch: 38 [761/1000 24352/32000 (76%)] Loss: 0.58560 (QuantReg: 12.88373) QuantErr: 12.88373 batch_time=0.40721 
Train Epoch: 38 [766/1000 24512/32000 (77%)] Loss: 0.26980 (QuantReg: 12.98619) QuantErr: 12.98619 batch_time=0.38195 
Train Epoch: 38 [771/1000 24672/32000 (77%)] Loss: 0.52990 (QuantReg: 12.15572) QuantErr: 12.15572 batch_time=0.42719 
Train Epoch: 38 [776/1000 24832/32000 (78%)] Loss: 0.19791 (QuantReg: 12.51608) QuantErr: 12.51608 batch_time=0.38141 
Train Epoch: 38 [781/1000 24992/32000 (78%)] Loss: 0.33189 (QuantReg: 12.71391) QuantErr: 12.71391 batch_time=0.37541 
Train Epoch: 38 [786/1000 25152/32000 (79%)] Loss: 0.14536 (QuantReg: 13.06068) QuantErr: 13.06068 batch_time=0.39916 
Train Epoch: 38 [791/1000 25312/32000 (79%)] Loss: 0.19954 (QuantReg: 13.30549) QuantErr: 13.30549 batch_time=0.39539 
Train Epoch: 38 [796/1000 25472/32000 (80%)] Loss: 0.21076 (QuantReg: 13.03230) QuantErr: 13.03230 batch_time=0.35443 
Train Epoch: 38 [801/1000 25632/32000 (80%)] Loss: 0.25010 (QuantReg: 13.48824) QuantErr: 13.48824 batch_time=0.38339 
Train Epoch: 38 [806/1000 25792/32000 (81%)] Loss: 0.34745 (QuantReg: 12.68805) QuantErr: 12.68805 batch_time=0.42150 
Train Epoch: 38 [811/1000 25952/32000 (81%)] Loss: 0.24672 (QuantReg: 12.49087) QuantErr: 12.49087 batch_time=0.40753 
Train Epoch: 38 [816/1000 26112/32000 (82%)] Loss: 0.33666 (QuantReg: 12.57529) QuantErr: 12.57529 batch_time=0.41350 
Train Epoch: 38 [821/1000 26272/32000 (82%)] Loss: 0.15440 (QuantReg: 13.69980) QuantErr: 13.69980 batch_time=0.36960 
Train Epoch: 38 [826/1000 26432/32000 (83%)] Loss: 0.33070 (QuantReg: 12.45356) QuantErr: 12.45356 batch_time=0.40595 
Train Epoch: 38 [831/1000 26592/32000 (83%)] Loss: 0.40197 (QuantReg: 12.92098) QuantErr: 12.92098 batch_time=0.40286 
Train Epoch: 38 [836/1000 26752/32000 (84%)] Loss: 0.27730 (QuantReg: 12.67254) QuantErr: 12.67254 batch_time=0.43912 
Train Epoch: 38 [841/1000 26912/32000 (84%)] Loss: 0.17458 (QuantReg: 13.19240) QuantErr: 13.19240 batch_time=0.41806 
Train Epoch: 38 [846/1000 27072/32000 (85%)] Loss: 0.19279 (QuantReg: 13.12118) QuantErr: 13.12118 batch_time=0.37425 
Train Epoch: 38 [851/1000 27232/32000 (85%)] Loss: 0.31785 (QuantReg: 12.47115) QuantErr: 12.47115 batch_time=0.35227 
Train Epoch: 38 [856/1000 27392/32000 (86%)] Loss: 0.22680 (QuantReg: 12.59269) QuantErr: 12.59269 batch_time=0.40672 
Train Epoch: 38 [861/1000 27552/32000 (86%)] Loss: 0.35945 (QuantReg: 13.40011) QuantErr: 13.40011 batch_time=0.41919 
Train Epoch: 38 [866/1000 27712/32000 (87%)] Loss: 0.43944 (QuantReg: 12.03972) QuantErr: 12.03972 batch_time=0.37993 
Train Epoch: 38 [871/1000 27872/32000 (87%)] Loss: 0.20345 (QuantReg: 12.77343) QuantErr: 12.77343 batch_time=0.39791 
Train Epoch: 38 [876/1000 28032/32000 (88%)] Loss: 0.06373 (QuantReg: 12.60341) QuantErr: 12.60341 batch_time=0.49686 
Train Epoch: 38 [881/1000 28192/32000 (88%)] Loss: 0.31838 (QuantReg: 12.65034) QuantErr: 12.65034 batch_time=0.38519 
Train Epoch: 38 [886/1000 28352/32000 (89%)] Loss: 0.18979 (QuantReg: 13.05268) QuantErr: 13.05268 batch_time=0.38081 
Train Epoch: 38 [891/1000 28512/32000 (89%)] Loss: 0.06585 (QuantReg: 12.78567) QuantErr: 12.78567 batch_time=0.36578 
Train Epoch: 38 [896/1000 28672/32000 (90%)] Loss: 0.08089 (QuantReg: 12.81710) QuantErr: 12.81710 batch_time=0.36386 
Train Epoch: 38 [901/1000 28832/32000 (90%)] Loss: 0.22533 (QuantReg: 12.46246) QuantErr: 12.46246 batch_time=0.44393 
Train Epoch: 38 [906/1000 28992/32000 (91%)] Loss: 0.31918 (QuantReg: 12.45269) QuantErr: 12.45269 batch_time=0.41338 
Train Epoch: 38 [911/1000 29152/32000 (91%)] Loss: 0.23149 (QuantReg: 12.92520) QuantErr: 12.92520 batch_time=0.44125 
Train Epoch: 38 [916/1000 29312/32000 (92%)] Loss: 0.24372 (QuantReg: 12.91116) QuantErr: 12.91116 batch_time=0.40128 
Train Epoch: 38 [921/1000 29472/32000 (92%)] Loss: 0.32609 (QuantReg: 12.51499) QuantErr: 12.51499 batch_time=0.46596 
Train Epoch: 38 [926/1000 29632/32000 (93%)] Loss: 0.26331 (QuantReg: 12.61260) QuantErr: 12.61260 batch_time=0.39163 
Train Epoch: 38 [931/1000 29792/32000 (93%)] Loss: 0.43868 (QuantReg: 13.06070) QuantErr: 13.06070 batch_time=0.40915 
Train Epoch: 38 [936/1000 29952/32000 (94%)] Loss: 0.10063 (QuantReg: 12.35629) QuantErr: 12.35629 batch_time=0.41649 
Train Epoch: 38 [941/1000 30112/32000 (94%)] Loss: 0.37777 (QuantReg: 12.21719) QuantErr: 12.21719 batch_time=0.39740 
Train Epoch: 38 [946/1000 30272/32000 (95%)] Loss: 0.15098 (QuantReg: 12.80246) QuantErr: 12.80246 batch_time=0.41778 
Train Epoch: 38 [951/1000 30432/32000 (95%)] Loss: 0.22459 (QuantReg: 12.64050) QuantErr: 12.64050 batch_time=0.40265 
Train Epoch: 38 [956/1000 30592/32000 (96%)] Loss: 0.24906 (QuantReg: 13.09926) QuantErr: 13.09926 batch_time=0.37100 
Train Epoch: 38 [961/1000 30752/32000 (96%)] Loss: 0.15893 (QuantReg: 12.60523) QuantErr: 12.60523 batch_time=0.40742 
Train Epoch: 38 [966/1000 30912/32000 (97%)] Loss: 0.23678 (QuantReg: 12.54512) QuantErr: 12.54512 batch_time=0.47955 
Train Epoch: 38 [971/1000 31072/32000 (97%)] Loss: 0.47108 (QuantReg: 13.02501) QuantErr: 13.02501 batch_time=0.45964 
Train Epoch: 38 [976/1000 31232/32000 (98%)] Loss: 0.28309 (QuantReg: 12.56274) QuantErr: 12.56274 batch_time=0.37192 
Train Epoch: 38 [981/1000 31392/32000 (98%)] Loss: 0.28052 (QuantReg: 12.79794) QuantErr: 12.79794 batch_time=0.44290 
Train Epoch: 38 [986/1000 31552/32000 (99%)] Loss: 0.32554 (QuantReg: 13.14198) QuantErr: 13.14198 batch_time=0.36749 
Train Epoch: 38 [991/1000 31712/32000 (99%)] Loss: 0.41758 (QuantReg: 13.33195) QuantErr: 13.33195 batch_time=0.37551 
Train Epoch: 38 [996/1000 31872/32000 (100%)] Loss: 0.12530 (QuantReg: 13.14290) QuantErr: 13.14290 batch_time=0.38565 
Train Epoch: 38 codebook_update_time=2.04583
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch38.pth ...
Done in 7.649s
removing stale ckpt [epoch 37] [took 0.39s]
 epoch          : 38
 loss           : 0.3040632820129395
 quant_reg      : 12.780232704162598
 quant_err      : 12.780232704162598
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 38000
 MSRVTT_full_val/t2v_metrics/R1: 31.58953722334004
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.913480885311872
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.312607185485746
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 85.31187122736418
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.372233400402415
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.546045619047256
 MSRVTT_full_test/t2v_metrics/R1: 12.709030100334449
 MSRVTT_full_test/t2v_metrics/R5: 35.852842809364546
 MSRVTT_full_test/t2v_metrics/R10: 49.4314381270903
 MSRVTT_full_test/t2v_metrics/R50: 80.06688963210702
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.95083612040134
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.240979161731595
 MSRVTT_full_test/v2t_metrics/R1: 15.68561872909699
 MSRVTT_full_test/v2t_metrics/R5: 41.83946488294314
 MSRVTT_full_test/v2t_metrics/R10: 57.725752508361204
 MSRVTT_full_test/v2t_metrics/R50: 85.78595317725753
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.678428093645486
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.58554960298465
 mnt_best       : 29.218703131434403
 not_improved_count: 3
Train Epoch: 39 [1/1000 32/32000 (0%)] Loss: 0.31693 (QuantReg: 12.86198) QuantErr: 12.86198 batch_time=28.22208 
Train Epoch: 39 [6/1000 192/32000 (1%)] Loss: 0.23595 (QuantReg: 12.57563) QuantErr: 12.57563 batch_time=1.13699 
Train Epoch: 39 [11/1000 352/32000 (1%)] Loss: 0.37826 (QuantReg: 12.61327) QuantErr: 12.61327 batch_time=0.37758 
Train Epoch: 39 [16/1000 512/32000 (2%)] Loss: 0.37183 (QuantReg: 12.77763) QuantErr: 12.77763 batch_time=0.34205 
Train Epoch: 39 [21/1000 672/32000 (2%)] Loss: 0.33898 (QuantReg: 13.22305) QuantErr: 13.22305 batch_time=0.41838 
Train Epoch: 39 [26/1000 832/32000 (3%)] Loss: 0.20394 (QuantReg: 12.61978) QuantErr: 12.61978 batch_time=0.43663 
Train Epoch: 39 [31/1000 992/32000 (3%)] Loss: 0.13408 (QuantReg: 12.53571) QuantErr: 12.53571 batch_time=0.45981 
Train Epoch: 39 [36/1000 1152/32000 (4%)] Loss: 0.25748 (QuantReg: 12.23085) QuantErr: 12.23085 batch_time=0.43009 
Train Epoch: 39 [41/1000 1312/32000 (4%)] Loss: 0.18130 (QuantReg: 12.57322) QuantErr: 12.57322 batch_time=0.40361 
Train Epoch: 39 [46/1000 1472/32000 (5%)] Loss: 0.30979 (QuantReg: 12.77218) QuantErr: 12.77218 batch_time=0.41381 
Train Epoch: 39 [51/1000 1632/32000 (5%)] Loss: 0.31944 (QuantReg: 12.86727) QuantErr: 12.86727 batch_time=0.36517 
Train Epoch: 39 [56/1000 1792/32000 (6%)] Loss: 0.31843 (QuantReg: 12.54783) QuantErr: 12.54783 batch_time=0.47155 
Train Epoch: 39 [61/1000 1952/32000 (6%)] Loss: 0.24516 (QuantReg: 13.07705) QuantErr: 13.07705 batch_time=0.37623 
Train Epoch: 39 [66/1000 2112/32000 (7%)] Loss: 0.31835 (QuantReg: 13.01144) QuantErr: 13.01144 batch_time=0.54551 
Train Epoch: 39 [71/1000 2272/32000 (7%)] Loss: 0.40243 (QuantReg: 12.83027) QuantErr: 12.83027 batch_time=0.34575 
Train Epoch: 39 [76/1000 2432/32000 (8%)] Loss: 0.63224 (QuantReg: 12.38153) QuantErr: 12.38153 batch_time=0.35793 
Train Epoch: 39 [81/1000 2592/32000 (8%)] Loss: 0.27002 (QuantReg: 13.12333) QuantErr: 13.12333 batch_time=0.71828 
Train Epoch: 39 [86/1000 2752/32000 (9%)] Loss: 0.31549 (QuantReg: 12.99354) QuantErr: 12.99354 batch_time=0.45641 
Train Epoch: 39 [91/1000 2912/32000 (9%)] Loss: 0.21331 (QuantReg: 12.69412) QuantErr: 12.69412 batch_time=0.36399 
Train Epoch: 39 [96/1000 3072/32000 (10%)] Loss: 0.24035 (QuantReg: 12.36479) QuantErr: 12.36479 batch_time=0.41477 
Train Epoch: 39 [101/1000 3232/32000 (10%)] Loss: 0.30353 (QuantReg: 12.72950) QuantErr: 12.72950 batch_time=0.46414 
Train Epoch: 39 [106/1000 3392/32000 (11%)] Loss: 0.25438 (QuantReg: 12.97550) QuantErr: 12.97550 batch_time=0.37348 
Train Epoch: 39 [111/1000 3552/32000 (11%)] Loss: 0.26462 (QuantReg: 12.79887) QuantErr: 12.79887 batch_time=0.45301 
Train Epoch: 39 [116/1000 3712/32000 (12%)] Loss: 0.26181 (QuantReg: 12.81570) QuantErr: 12.81570 batch_time=0.48945 
Train Epoch: 39 [121/1000 3872/32000 (12%)] Loss: 0.60606 (QuantReg: 12.40107) QuantErr: 12.40107 batch_time=0.37748 
Train Epoch: 39 [126/1000 4032/32000 (13%)] Loss: 0.28549 (QuantReg: 13.62076) QuantErr: 13.62076 batch_time=0.46284 
Train Epoch: 39 [131/1000 4192/32000 (13%)] Loss: 0.10484 (QuantReg: 13.38464) QuantErr: 13.38464 batch_time=0.38316 
Train Epoch: 39 [136/1000 4352/32000 (14%)] Loss: 0.42413 (QuantReg: 12.94924) QuantErr: 12.94924 batch_time=0.40061 
Train Epoch: 39 [141/1000 4512/32000 (14%)] Loss: 0.24044 (QuantReg: 12.89637) QuantErr: 12.89637 batch_time=0.33912 
Train Epoch: 39 [146/1000 4672/32000 (15%)] Loss: 0.39437 (QuantReg: 12.27936) QuantErr: 12.27936 batch_time=0.48254 
Train Epoch: 39 [151/1000 4832/32000 (15%)] Loss: 0.40879 (QuantReg: 13.05357) QuantErr: 13.05357 batch_time=0.39358 
Train Epoch: 39 [156/1000 4992/32000 (16%)] Loss: 0.22362 (QuantReg: 13.08366) QuantErr: 13.08366 batch_time=0.39810 
Train Epoch: 39 [161/1000 5152/32000 (16%)] Loss: 0.35002 (QuantReg: 12.96643) QuantErr: 12.96643 batch_time=0.40874 
Train Epoch: 39 [166/1000 5312/32000 (17%)] Loss: 0.52612 (QuantReg: 12.57966) QuantErr: 12.57966 batch_time=0.42228 
Train Epoch: 39 [171/1000 5472/32000 (17%)] Loss: 0.24373 (QuantReg: 12.63517) QuantErr: 12.63517 batch_time=0.36913 
Train Epoch: 39 [176/1000 5632/32000 (18%)] Loss: 0.13403 (QuantReg: 12.77068) QuantErr: 12.77068 batch_time=0.41321 
Train Epoch: 39 [181/1000 5792/32000 (18%)] Loss: 0.09306 (QuantReg: 13.02469) QuantErr: 13.02469 batch_time=0.39342 
Train Epoch: 39 [186/1000 5952/32000 (19%)] Loss: 0.11388 (QuantReg: 13.12287) QuantErr: 13.12287 batch_time=0.41019 
Train Epoch: 39 [191/1000 6112/32000 (19%)] Loss: 0.60421 (QuantReg: 12.65005) QuantErr: 12.65005 batch_time=0.39414 
Train Epoch: 39 [196/1000 6272/32000 (20%)] Loss: 0.20606 (QuantReg: 13.19277) QuantErr: 13.19277 batch_time=0.39746 
Train Epoch: 39 [201/1000 6432/32000 (20%)] Loss: 0.46246 (QuantReg: 12.55919) QuantErr: 12.55919 batch_time=0.34271 
Train Epoch: 39 [206/1000 6592/32000 (21%)] Loss: 0.34333 (QuantReg: 12.89213) QuantErr: 12.89213 batch_time=0.46587 
Train Epoch: 39 [211/1000 6752/32000 (21%)] Loss: 0.07799 (QuantReg: 12.94428) QuantErr: 12.94428 batch_time=0.63672 
Train Epoch: 39 [216/1000 6912/32000 (22%)] Loss: 0.18801 (QuantReg: 13.11936) QuantErr: 13.11936 batch_time=0.42905 
Train Epoch: 39 [221/1000 7072/32000 (22%)] Loss: 0.14422 (QuantReg: 12.67469) QuantErr: 12.67469 batch_time=0.38215 
Train Epoch: 39 [226/1000 7232/32000 (23%)] Loss: 0.20027 (QuantReg: 12.47996) QuantErr: 12.47996 batch_time=0.48340 
Train Epoch: 39 [231/1000 7392/32000 (23%)] Loss: 0.43893 (QuantReg: 12.44288) QuantErr: 12.44288 batch_time=0.38401 
Train Epoch: 39 [236/1000 7552/32000 (24%)] Loss: 0.46695 (QuantReg: 13.09400) QuantErr: 13.09400 batch_time=0.39211 
Train Epoch: 39 [241/1000 7712/32000 (24%)] Loss: 0.61770 (QuantReg: 12.71238) QuantErr: 12.71238 batch_time=0.38659 
Train Epoch: 39 [246/1000 7872/32000 (25%)] Loss: 0.32993 (QuantReg: 12.93473) QuantErr: 12.93473 batch_time=0.40878 
Train Epoch: 39 [251/1000 8032/32000 (25%)] Loss: 0.52592 (QuantReg: 12.27467) QuantErr: 12.27467 batch_time=0.36165 
Train Epoch: 39 [256/1000 8192/32000 (26%)] Loss: 0.17419 (QuantReg: 12.82729) QuantErr: 12.82729 batch_time=0.43606 
Train Epoch: 39 [261/1000 8352/32000 (26%)] Loss: 0.23117 (QuantReg: 12.53784) QuantErr: 12.53784 batch_time=0.38518 
Train Epoch: 39 [266/1000 8512/32000 (27%)] Loss: 0.51437 (QuantReg: 12.05681) QuantErr: 12.05681 batch_time=0.42732 
Train Epoch: 39 [271/1000 8672/32000 (27%)] Loss: 0.20625 (QuantReg: 12.52334) QuantErr: 12.52334 batch_time=0.37529 
Train Epoch: 39 [276/1000 8832/32000 (28%)] Loss: 0.27007 (QuantReg: 13.07859) QuantErr: 13.07859 batch_time=0.38825 
Train Epoch: 39 [281/1000 8992/32000 (28%)] Loss: 0.58844 (QuantReg: 12.99823) QuantErr: 12.99823 batch_time=0.34594 
Train Epoch: 39 [286/1000 9152/32000 (29%)] Loss: 0.19603 (QuantReg: 12.97760) QuantErr: 12.97760 batch_time=0.51409 
Train Epoch: 39 [291/1000 9312/32000 (29%)] Loss: 0.40160 (QuantReg: 12.68803) QuantErr: 12.68803 batch_time=0.48772 
Train Epoch: 39 [296/1000 9472/32000 (30%)] Loss: 0.37235 (QuantReg: 12.99555) QuantErr: 12.99555 batch_time=0.37223 
Train Epoch: 39 [301/1000 9632/32000 (30%)] Loss: 0.24626 (QuantReg: 12.75796) QuantErr: 12.75796 batch_time=0.41807 
Train Epoch: 39 [306/1000 9792/32000 (31%)] Loss: 0.16091 (QuantReg: 12.61774) QuantErr: 12.61774 batch_time=0.65040 
Train Epoch: 39 [311/1000 9952/32000 (31%)] Loss: 0.39784 (QuantReg: 12.90023) QuantErr: 12.90023 batch_time=0.39089 
Train Epoch: 39 [316/1000 10112/32000 (32%)] Loss: 0.21741 (QuantReg: 12.85421) QuantErr: 12.85421 batch_time=0.41819 
Train Epoch: 39 [321/1000 10272/32000 (32%)] Loss: 0.24868 (QuantReg: 13.37730) QuantErr: 13.37730 batch_time=0.38028 
Train Epoch: 39 [326/1000 10432/32000 (33%)] Loss: 0.20613 (QuantReg: 12.52032) QuantErr: 12.52032 batch_time=0.87270 
Train Epoch: 39 [331/1000 10592/32000 (33%)] Loss: 0.39278 (QuantReg: 12.61344) QuantErr: 12.61344 batch_time=0.34715 
Train Epoch: 39 [336/1000 10752/32000 (34%)] Loss: 0.44519 (QuantReg: 12.25166) QuantErr: 12.25166 batch_time=0.72178 
Train Epoch: 39 [341/1000 10912/32000 (34%)] Loss: 0.37311 (QuantReg: 12.87505) QuantErr: 12.87505 batch_time=0.36421 
Train Epoch: 39 [346/1000 11072/32000 (35%)] Loss: 0.16495 (QuantReg: 13.26898) QuantErr: 13.26898 batch_time=0.35940 
Train Epoch: 39 [351/1000 11232/32000 (35%)] Loss: 0.26785 (QuantReg: 12.89720) QuantErr: 12.89720 batch_time=0.36643 
Train Epoch: 39 [356/1000 11392/32000 (36%)] Loss: 0.40121 (QuantReg: 12.00460) QuantErr: 12.00460 batch_time=0.38168 
Train Epoch: 39 [361/1000 11552/32000 (36%)] Loss: 0.31248 (QuantReg: 13.14202) QuantErr: 13.14202 batch_time=0.36059 
Train Epoch: 39 [366/1000 11712/32000 (37%)] Loss: 0.15727 (QuantReg: 13.01583) QuantErr: 13.01583 batch_time=0.42797 
Train Epoch: 39 [371/1000 11872/32000 (37%)] Loss: 0.33785 (QuantReg: 12.26353) QuantErr: 12.26353 batch_time=0.41814 
Train Epoch: 39 [376/1000 12032/32000 (38%)] Loss: 0.15473 (QuantReg: 12.70871) QuantErr: 12.70871 batch_time=0.41774 
Train Epoch: 39 [381/1000 12192/32000 (38%)] Loss: 0.27914 (QuantReg: 13.15246) QuantErr: 13.15246 batch_time=0.39656 
Train Epoch: 39 [386/1000 12352/32000 (39%)] Loss: 0.33132 (QuantReg: 12.93539) QuantErr: 12.93539 batch_time=0.60180 
Train Epoch: 39 [391/1000 12512/32000 (39%)] Loss: 0.37181 (QuantReg: 12.52566) QuantErr: 12.52566 batch_time=0.37433 
Train Epoch: 39 [396/1000 12672/32000 (40%)] Loss: 0.19245 (QuantReg: 12.97126) QuantErr: 12.97126 batch_time=0.39166 
Train Epoch: 39 [401/1000 12832/32000 (40%)] Loss: 0.36606 (QuantReg: 12.79875) QuantErr: 12.79875 batch_time=0.76009 
Train Epoch: 39 [406/1000 12992/32000 (41%)] Loss: 0.37260 (QuantReg: 12.70202) QuantErr: 12.70202 batch_time=0.39114 
Train Epoch: 39 [411/1000 13152/32000 (41%)] Loss: 0.24613 (QuantReg: 13.29806) QuantErr: 13.29806 batch_time=0.36212 
Train Epoch: 39 [416/1000 13312/32000 (42%)] Loss: 0.25782 (QuantReg: 12.72122) QuantErr: 12.72122 batch_time=0.35527 
Train Epoch: 39 [421/1000 13472/32000 (42%)] Loss: 0.27945 (QuantReg: 12.51472) QuantErr: 12.51472 batch_time=0.36519 
Train Epoch: 39 [426/1000 13632/32000 (43%)] Loss: 0.33803 (QuantReg: 13.11236) QuantErr: 13.11236 batch_time=0.37041 
Train Epoch: 39 [431/1000 13792/32000 (43%)] Loss: 0.16920 (QuantReg: 13.63674) QuantErr: 13.63674 batch_time=0.34208 
Train Epoch: 39 [436/1000 13952/32000 (44%)] Loss: 0.20843 (QuantReg: 12.51734) QuantErr: 12.51734 batch_time=0.46189 
Train Epoch: 39 [441/1000 14112/32000 (44%)] Loss: 0.24051 (QuantReg: 12.86854) QuantErr: 12.86854 batch_time=0.39589 
Train Epoch: 39 [446/1000 14272/32000 (45%)] Loss: 0.17698 (QuantReg: 12.33259) QuantErr: 12.33259 batch_time=0.43309 
Train Epoch: 39 [451/1000 14432/32000 (45%)] Loss: 0.27773 (QuantReg: 13.12340) QuantErr: 13.12340 batch_time=0.42736 
Train Epoch: 39 [456/1000 14592/32000 (46%)] Loss: 0.26252 (QuantReg: 13.15607) QuantErr: 13.15607 batch_time=0.43334 
Train Epoch: 39 [461/1000 14752/32000 (46%)] Loss: 0.15757 (QuantReg: 12.44618) QuantErr: 12.44618 batch_time=0.34804 
Train Epoch: 39 [466/1000 14912/32000 (47%)] Loss: 0.45937 (QuantReg: 11.64841) QuantErr: 11.64841 batch_time=0.46585 
Train Epoch: 39 [471/1000 15072/32000 (47%)] Loss: 0.39141 (QuantReg: 12.23129) QuantErr: 12.23129 batch_time=0.34186 
Train Epoch: 39 [476/1000 15232/32000 (48%)] Loss: 0.40462 (QuantReg: 12.75298) QuantErr: 12.75298 batch_time=0.34651 
Train Epoch: 39 [481/1000 15392/32000 (48%)] Loss: 0.43102 (QuantReg: 12.42109) QuantErr: 12.42109 batch_time=0.34340 
Train Epoch: 39 [486/1000 15552/32000 (49%)] Loss: 0.34350 (QuantReg: 12.85729) QuantErr: 12.85729 batch_time=0.34214 
Train Epoch: 39 [491/1000 15712/32000 (49%)] Loss: 0.17142 (QuantReg: 12.46379) QuantErr: 12.46379 batch_time=0.34346 
Train Epoch: 39 [496/1000 15872/32000 (50%)] Loss: 0.45950 (QuantReg: 12.72826) QuantErr: 12.72826 batch_time=0.34449 
Train Epoch: 39 [501/1000 16032/32000 (50%)] Loss: 0.15560 (QuantReg: 13.27518) QuantErr: 13.27518 batch_time=0.34643 
Train Epoch: 39 [506/1000 16192/32000 (51%)] Loss: 0.15419 (QuantReg: 12.82580) QuantErr: 12.82580 batch_time=0.34928 
Train Epoch: 39 [511/1000 16352/32000 (51%)] Loss: 0.35557 (QuantReg: 13.07470) QuantErr: 13.07470 batch_time=0.44264 
Train Epoch: 39 [516/1000 16512/32000 (52%)] Loss: 0.45549 (QuantReg: 12.63501) QuantErr: 12.63501 batch_time=0.45264 
Train Epoch: 39 [521/1000 16672/32000 (52%)] Loss: 0.51856 (QuantReg: 12.35644) QuantErr: 12.35644 batch_time=0.35357 
Train Epoch: 39 [526/1000 16832/32000 (53%)] Loss: 0.40932 (QuantReg: 13.02378) QuantErr: 13.02378 batch_time=0.34441 
Train Epoch: 39 [531/1000 16992/32000 (53%)] Loss: 0.23862 (QuantReg: 12.56174) QuantErr: 12.56174 batch_time=0.55879 
Train Epoch: 39 [536/1000 17152/32000 (54%)] Loss: 0.34609 (QuantReg: 12.50835) QuantErr: 12.50835 batch_time=0.39543 
Train Epoch: 39 [541/1000 17312/32000 (54%)] Loss: 0.40564 (QuantReg: 13.22578) QuantErr: 13.22578 batch_time=0.37597 
Train Epoch: 39 [546/1000 17472/32000 (55%)] Loss: 0.25594 (QuantReg: 12.86510) QuantErr: 12.86510 batch_time=0.36748 
Train Epoch: 39 [551/1000 17632/32000 (55%)] Loss: 0.29563 (QuantReg: 12.45247) QuantErr: 12.45247 batch_time=0.40957 
Train Epoch: 39 [556/1000 17792/32000 (56%)] Loss: 0.28419 (QuantReg: 12.28550) QuantErr: 12.28550 batch_time=0.41829 
Train Epoch: 39 [561/1000 17952/32000 (56%)] Loss: 0.21221 (QuantReg: 13.32224) QuantErr: 13.32224 batch_time=0.41094 
Train Epoch: 39 [566/1000 18112/32000 (57%)] Loss: 0.27514 (QuantReg: 12.56157) QuantErr: 12.56157 batch_time=0.38765 
Train Epoch: 39 [571/1000 18272/32000 (57%)] Loss: 0.27248 (QuantReg: 12.84310) QuantErr: 12.84310 batch_time=0.40478 
Train Epoch: 39 [576/1000 18432/32000 (58%)] Loss: 0.45955 (QuantReg: 12.22249) QuantErr: 12.22249 batch_time=0.39835 
Train Epoch: 39 [581/1000 18592/32000 (58%)] Loss: 0.12380 (QuantReg: 12.90650) QuantErr: 12.90650 batch_time=0.37776 
Train Epoch: 39 [586/1000 18752/32000 (59%)] Loss: 0.12904 (QuantReg: 13.10626) QuantErr: 13.10626 batch_time=0.39329 
Train Epoch: 39 [591/1000 18912/32000 (59%)] Loss: 0.28283 (QuantReg: 13.60584) QuantErr: 13.60584 batch_time=0.35200 
Train Epoch: 39 [596/1000 19072/32000 (60%)] Loss: 0.25488 (QuantReg: 12.39637) QuantErr: 12.39637 batch_time=0.35915 
Train Epoch: 39 [601/1000 19232/32000 (60%)] Loss: 0.11377 (QuantReg: 12.80460) QuantErr: 12.80460 batch_time=0.41752 
Train Epoch: 39 [606/1000 19392/32000 (61%)] Loss: 0.40663 (QuantReg: 12.35323) QuantErr: 12.35323 batch_time=0.51807 
Train Epoch: 39 [611/1000 19552/32000 (61%)] Loss: 0.10801 (QuantReg: 12.97047) QuantErr: 12.97047 batch_time=0.45658 
Train Epoch: 39 [616/1000 19712/32000 (62%)] Loss: 0.42833 (QuantReg: 12.84930) QuantErr: 12.84930 batch_time=0.37018 
Train Epoch: 39 [621/1000 19872/32000 (62%)] Loss: 0.22300 (QuantReg: 12.79836) QuantErr: 12.79836 batch_time=0.36583 
Train Epoch: 39 [626/1000 20032/32000 (63%)] Loss: 0.43784 (QuantReg: 12.93067) QuantErr: 12.93067 batch_time=0.58178 
Train Epoch: 39 [631/1000 20192/32000 (63%)] Loss: 0.49194 (QuantReg: 12.99470) QuantErr: 12.99470 batch_time=0.37324 
Train Epoch: 39 [636/1000 20352/32000 (64%)] Loss: 0.30532 (QuantReg: 12.40837) QuantErr: 12.40837 batch_time=0.41252 
Train Epoch: 39 [641/1000 20512/32000 (64%)] Loss: 0.27584 (QuantReg: 12.80812) QuantErr: 12.80812 batch_time=0.38449 
Train Epoch: 39 [646/1000 20672/32000 (65%)] Loss: 0.27772 (QuantReg: 12.29379) QuantErr: 12.29379 batch_time=0.91111 
Train Epoch: 39 [651/1000 20832/32000 (65%)] Loss: 0.28543 (QuantReg: 12.99040) QuantErr: 12.99040 batch_time=0.42333 
Train Epoch: 39 [656/1000 20992/32000 (66%)] Loss: 0.15352 (QuantReg: 13.14544) QuantErr: 13.14544 batch_time=0.40113 
Train Epoch: 39 [661/1000 21152/32000 (66%)] Loss: 0.21464 (QuantReg: 12.77911) QuantErr: 12.77911 batch_time=0.34806 
Train Epoch: 39 [666/1000 21312/32000 (67%)] Loss: 0.07668 (QuantReg: 12.71626) QuantErr: 12.71626 batch_time=0.35778 
Train Epoch: 39 [671/1000 21472/32000 (67%)] Loss: 0.13986 (QuantReg: 13.18597) QuantErr: 13.18597 batch_time=0.34833 
Train Epoch: 39 [676/1000 21632/32000 (68%)] Loss: 0.08415 (QuantReg: 13.33672) QuantErr: 13.33672 batch_time=0.35037 
Train Epoch: 39 [681/1000 21792/32000 (68%)] Loss: 0.22157 (QuantReg: 12.89418) QuantErr: 12.89418 batch_time=0.39838 
Train Epoch: 39 [686/1000 21952/32000 (69%)] Loss: 0.30475 (QuantReg: 11.98558) QuantErr: 11.98558 batch_time=0.35252 
Train Epoch: 39 [691/1000 22112/32000 (69%)] Loss: 0.42527 (QuantReg: 12.42930) QuantErr: 12.42930 batch_time=0.34707 
Train Epoch: 39 [696/1000 22272/32000 (70%)] Loss: 0.37057 (QuantReg: 12.92235) QuantErr: 12.92235 batch_time=0.34622 
Train Epoch: 39 [701/1000 22432/32000 (70%)] Loss: 0.17378 (QuantReg: 12.77386) QuantErr: 12.77386 batch_time=0.39056 
Train Epoch: 39 [706/1000 22592/32000 (71%)] Loss: 0.47453 (QuantReg: 12.41739) QuantErr: 12.41739 batch_time=0.62916 
Train Epoch: 39 [711/1000 22752/32000 (71%)] Loss: 0.77386 (QuantReg: 12.63772) QuantErr: 12.63772 batch_time=0.35835 
Train Epoch: 39 [716/1000 22912/32000 (72%)] Loss: 0.59679 (QuantReg: 11.89488) QuantErr: 11.89488 batch_time=0.37264 
Train Epoch: 39 [721/1000 23072/32000 (72%)] Loss: 0.92831 (QuantReg: 12.50939) QuantErr: 12.50939 batch_time=0.78509 
Train Epoch: 39 [726/1000 23232/32000 (73%)] Loss: 0.32190 (QuantReg: 12.77559) QuantErr: 12.77559 batch_time=0.42144 
Train Epoch: 39 [731/1000 23392/32000 (73%)] Loss: 0.38113 (QuantReg: 12.92782) QuantErr: 12.92782 batch_time=0.37510 
Train Epoch: 39 [736/1000 23552/32000 (74%)] Loss: 0.44558 (QuantReg: 12.71354) QuantErr: 12.71354 batch_time=0.40776 
Train Epoch: 39 [741/1000 23712/32000 (74%)] Loss: 0.32458 (QuantReg: 11.91285) QuantErr: 11.91285 batch_time=0.44836 
Train Epoch: 39 [746/1000 23872/32000 (75%)] Loss: 0.08511 (QuantReg: 12.55919) QuantErr: 12.55919 batch_time=0.47754 
Train Epoch: 39 [751/1000 24032/32000 (75%)] Loss: 0.58393 (QuantReg: 12.08010) QuantErr: 12.08010 batch_time=0.44061 
Train Epoch: 39 [756/1000 24192/32000 (76%)] Loss: 0.19868 (QuantReg: 12.71941) QuantErr: 12.71941 batch_time=0.42311 
Train Epoch: 39 [761/1000 24352/32000 (76%)] Loss: 0.44183 (QuantReg: 12.62961) QuantErr: 12.62961 batch_time=0.35058 
Train Epoch: 39 [766/1000 24512/32000 (77%)] Loss: 0.15500 (QuantReg: 13.32425) QuantErr: 13.32425 batch_time=0.44955 
Train Epoch: 39 [771/1000 24672/32000 (77%)] Loss: 0.48593 (QuantReg: 12.90863) QuantErr: 12.90863 batch_time=0.39079 
Train Epoch: 39 [776/1000 24832/32000 (78%)] Loss: 0.36862 (QuantReg: 12.32946) QuantErr: 12.32946 batch_time=0.43539 
Train Epoch: 39 [781/1000 24992/32000 (78%)] Loss: 0.34710 (QuantReg: 12.90300) QuantErr: 12.90300 batch_time=0.41829 
Train Epoch: 39 [786/1000 25152/32000 (79%)] Loss: 0.58526 (QuantReg: 13.04729) QuantErr: 13.04729 batch_time=0.54940 
Train Epoch: 39 [791/1000 25312/32000 (79%)] Loss: 0.30180 (QuantReg: 13.11052) QuantErr: 13.11052 batch_time=0.37752 
Train Epoch: 39 [796/1000 25472/32000 (80%)] Loss: 0.16767 (QuantReg: 13.47721) QuantErr: 13.47721 batch_time=0.46804 
Train Epoch: 39 [801/1000 25632/32000 (80%)] Loss: 0.14598 (QuantReg: 13.07563) QuantErr: 13.07563 batch_time=0.34987 
Train Epoch: 39 [806/1000 25792/32000 (81%)] Loss: 0.15352 (QuantReg: 13.47338) QuantErr: 13.47338 batch_time=0.35863 
Train Epoch: 39 [811/1000 25952/32000 (81%)] Loss: 0.79806 (QuantReg: 12.80725) QuantErr: 12.80725 batch_time=0.37021 
Train Epoch: 39 [816/1000 26112/32000 (82%)] Loss: 0.14824 (QuantReg: 12.85558) QuantErr: 12.85558 batch_time=0.35283 
Train Epoch: 39 [821/1000 26272/32000 (82%)] Loss: 0.16733 (QuantReg: 13.21275) QuantErr: 13.21275 batch_time=0.35500 
Train Epoch: 39 [826/1000 26432/32000 (83%)] Loss: 0.20258 (QuantReg: 12.81283) QuantErr: 12.81283 batch_time=0.40855 
Train Epoch: 39 [831/1000 26592/32000 (83%)] Loss: 0.18352 (QuantReg: 13.04457) QuantErr: 13.04457 batch_time=0.38730 
Train Epoch: 39 [836/1000 26752/32000 (84%)] Loss: 0.19545 (QuantReg: 13.32128) QuantErr: 13.32128 batch_time=0.37072 
Train Epoch: 39 [841/1000 26912/32000 (84%)] Loss: 0.40283 (QuantReg: 12.61208) QuantErr: 12.61208 batch_time=0.35036 
Train Epoch: 39 [846/1000 27072/32000 (85%)] Loss: 0.30017 (QuantReg: 12.70938) QuantErr: 12.70938 batch_time=0.34914 
Train Epoch: 39 [851/1000 27232/32000 (85%)] Loss: 0.23048 (QuantReg: 12.94108) QuantErr: 12.94108 batch_time=0.58960 
Train Epoch: 39 [856/1000 27392/32000 (86%)] Loss: 0.11610 (QuantReg: 13.06129) QuantErr: 13.06129 batch_time=0.33935 
Train Epoch: 39 [861/1000 27552/32000 (86%)] Loss: 0.08531 (QuantReg: 12.93660) QuantErr: 12.93660 batch_time=0.35502 
Train Epoch: 39 [866/1000 27712/32000 (87%)] Loss: 0.20106 (QuantReg: 13.61805) QuantErr: 13.61805 batch_time=0.38179 
Train Epoch: 39 [871/1000 27872/32000 (87%)] Loss: 0.34106 (QuantReg: 12.74744) QuantErr: 12.74744 batch_time=0.33976 
Train Epoch: 39 [876/1000 28032/32000 (88%)] Loss: 0.56272 (QuantReg: 12.56986) QuantErr: 12.56986 batch_time=0.34606 
Train Epoch: 39 [881/1000 28192/32000 (88%)] Loss: 0.32796 (QuantReg: 13.05341) QuantErr: 13.05341 batch_time=0.37359 
Train Epoch: 39 [886/1000 28352/32000 (89%)] Loss: 0.51561 (QuantReg: 12.49258) QuantErr: 12.49258 batch_time=0.34976 
Train Epoch: 39 [891/1000 28512/32000 (89%)] Loss: 0.50247 (QuantReg: 12.92907) QuantErr: 12.92907 batch_time=0.37993 
Train Epoch: 39 [896/1000 28672/32000 (90%)] Loss: 0.25131 (QuantReg: 12.98138) QuantErr: 12.98138 batch_time=0.35188 
Train Epoch: 39 [901/1000 28832/32000 (90%)] Loss: 0.28544 (QuantReg: 12.63250) QuantErr: 12.63250 batch_time=0.40285 
Train Epoch: 39 [906/1000 28992/32000 (91%)] Loss: 0.41723 (QuantReg: 13.20996) QuantErr: 13.20996 batch_time=0.41142 
Train Epoch: 39 [911/1000 29152/32000 (91%)] Loss: 0.11880 (QuantReg: 13.03169) QuantErr: 13.03169 batch_time=0.41348 
Train Epoch: 39 [916/1000 29312/32000 (92%)] Loss: 0.16590 (QuantReg: 13.75657) QuantErr: 13.75657 batch_time=0.36162 
Train Epoch: 39 [921/1000 29472/32000 (92%)] Loss: 0.14432 (QuantReg: 13.00662) QuantErr: 13.00662 batch_time=0.39281 
Train Epoch: 39 [926/1000 29632/32000 (93%)] Loss: 0.55757 (QuantReg: 12.92704) QuantErr: 12.92704 batch_time=0.57426 
Train Epoch: 39 [931/1000 29792/32000 (93%)] Loss: 0.36675 (QuantReg: 12.60908) QuantErr: 12.60908 batch_time=0.59375 
Train Epoch: 39 [936/1000 29952/32000 (94%)] Loss: 0.06826 (QuantReg: 13.01862) QuantErr: 13.01862 batch_time=0.39890 
Train Epoch: 39 [941/1000 30112/32000 (94%)] Loss: 0.31062 (QuantReg: 13.18317) QuantErr: 13.18317 batch_time=0.36031 
Train Epoch: 39 [946/1000 30272/32000 (95%)] Loss: 0.18180 (QuantReg: 12.75860) QuantErr: 12.75860 batch_time=0.55049 
Train Epoch: 39 [951/1000 30432/32000 (95%)] Loss: 0.19956 (QuantReg: 12.68423) QuantErr: 12.68423 batch_time=0.34417 
Train Epoch: 39 [956/1000 30592/32000 (96%)] Loss: 0.44250 (QuantReg: 13.05179) QuantErr: 13.05179 batch_time=0.35955 
Train Epoch: 39 [961/1000 30752/32000 (96%)] Loss: 0.45833 (QuantReg: 13.32670) QuantErr: 13.32670 batch_time=0.35923 
Train Epoch: 39 [966/1000 30912/32000 (97%)] Loss: 0.22028 (QuantReg: 13.12286) QuantErr: 13.12286 batch_time=0.90810 
Train Epoch: 39 [971/1000 31072/32000 (97%)] Loss: 0.36881 (QuantReg: 13.27117) QuantErr: 13.27117 batch_time=0.38297 
Train Epoch: 39 [976/1000 31232/32000 (98%)] Loss: 0.39339 (QuantReg: 12.99168) QuantErr: 12.99168 batch_time=0.37429 
Train Epoch: 39 [981/1000 31392/32000 (98%)] Loss: 0.35079 (QuantReg: 12.98636) QuantErr: 12.98636 batch_time=0.38064 
Train Epoch: 39 [986/1000 31552/32000 (99%)] Loss: 0.38621 (QuantReg: 12.38639) QuantErr: 12.38639 batch_time=0.35581 
Train Epoch: 39 [991/1000 31712/32000 (99%)] Loss: 0.49651 (QuantReg: 13.10695) QuantErr: 13.10695 batch_time=0.35149 
Train Epoch: 39 [996/1000 31872/32000 (100%)] Loss: 0.35472 (QuantReg: 12.69292) QuantErr: 12.69292 batch_time=0.35954 
Train Epoch: 39 codebook_update_time=1.82601
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch39.pth ...
Done in 22.311s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch39.pth ...
Done in 26.926s
removing stale ckpt [epoch 38] [took 0.03s]
 epoch          : 39
 loss           : 0.30335684574395416
 quant_reg      : 12.806183095932006
 quant_err      : 12.806183095932006
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 39000
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.138832997987928
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.19887570675686
 MSRVTT_full_val/v2t_metrics/R1: 38.6317907444668
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.370221327967807
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.53266221018923
 MSRVTT_full_test/t2v_metrics/R1: 13.210702341137123
 MSRVTT_full_test/t2v_metrics/R5: 37.591973244147155
 MSRVTT_full_test/t2v_metrics/R10: 50.60200668896321
 MSRVTT_full_test/t2v_metrics/R50: 80.73578595317726
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.827090301003345
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.290689157230588
 MSRVTT_full_test/v2t_metrics/R1: 16.387959866220736
 MSRVTT_full_test/v2t_metrics/R5: 43.47826086956522
 MSRVTT_full_test/v2t_metrics/R10: 58.36120401337793
 MSRVTT_full_test/v2t_metrics/R50: 86.62207357859532
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.1804347826087
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.644989407441514
 mnt_best       : 29.290689157230588
 not_improved_count: 0
Train Epoch: 40 [1/1000 32/32000 (0%)] Loss: 0.35594 (QuantReg: 12.98323) QuantErr: 12.98323 batch_time=35.29783 
Train Epoch: 40 [6/1000 192/32000 (1%)] Loss: 0.58291 (QuantReg: 12.93489) QuantErr: 12.93489 batch_time=0.34758 
Train Epoch: 40 [11/1000 352/32000 (1%)] Loss: 0.29507 (QuantReg: 13.17662) QuantErr: 13.17662 batch_time=0.35316 
Train Epoch: 40 [16/1000 512/32000 (2%)] Loss: 0.13658 (QuantReg: 12.99452) QuantErr: 12.99452 batch_time=0.35226 
Train Epoch: 40 [21/1000 672/32000 (2%)] Loss: 0.13592 (QuantReg: 12.91649) QuantErr: 12.91649 batch_time=0.35485 
Train Epoch: 40 [26/1000 832/32000 (3%)] Loss: 0.40426 (QuantReg: 12.73477) QuantErr: 12.73477 batch_time=0.36620 
Train Epoch: 40 [31/1000 992/32000 (3%)] Loss: 0.46346 (QuantReg: 12.81248) QuantErr: 12.81248 batch_time=0.35651 
Train Epoch: 40 [36/1000 1152/32000 (4%)] Loss: 0.31111 (QuantReg: 12.87181) QuantErr: 12.87181 batch_time=0.35869 
Train Epoch: 40 [41/1000 1312/32000 (4%)] Loss: 0.06371 (QuantReg: 12.77618) QuantErr: 12.77618 batch_time=0.35094 
Train Epoch: 40 [46/1000 1472/32000 (5%)] Loss: 0.28352 (QuantReg: 12.88371) QuantErr: 12.88371 batch_time=0.35006 
Train Epoch: 40 [51/1000 1632/32000 (5%)] Loss: 0.36275 (QuantReg: 12.77172) QuantErr: 12.77172 batch_time=0.38814 
Train Epoch: 40 [56/1000 1792/32000 (6%)] Loss: 0.35024 (QuantReg: 12.82424) QuantErr: 12.82424 batch_time=0.35502 
Train Epoch: 40 [61/1000 1952/32000 (6%)] Loss: 0.30650 (QuantReg: 12.98075) QuantErr: 12.98075 batch_time=0.39150 
Train Epoch: 40 [66/1000 2112/32000 (7%)] Loss: 0.15975 (QuantReg: 12.64850) QuantErr: 12.64850 batch_time=0.67476 
Train Epoch: 40 [71/1000 2272/32000 (7%)] Loss: 0.47564 (QuantReg: 12.61683) QuantErr: 12.61683 batch_time=0.35533 
Train Epoch: 40 [76/1000 2432/32000 (8%)] Loss: 0.62470 (QuantReg: 12.19712) QuantErr: 12.19712 batch_time=0.41297 
Train Epoch: 40 [81/1000 2592/32000 (8%)] Loss: 0.18237 (QuantReg: 12.74932) QuantErr: 12.74932 batch_time=0.34508 
Train Epoch: 40 [86/1000 2752/32000 (9%)] Loss: 0.32106 (QuantReg: 13.42790) QuantErr: 13.42790 batch_time=0.34652 
Train Epoch: 40 [91/1000 2912/32000 (9%)] Loss: 0.42957 (QuantReg: 13.23517) QuantErr: 13.23517 batch_time=0.34985 
Train Epoch: 40 [96/1000 3072/32000 (10%)] Loss: 0.20899 (QuantReg: 12.97843) QuantErr: 12.97843 batch_time=0.34792 
Train Epoch: 40 [101/1000 3232/32000 (10%)] Loss: 0.39187 (QuantReg: 12.92722) QuantErr: 12.92722 batch_time=0.34481 
Train Epoch: 40 [106/1000 3392/32000 (11%)] Loss: 0.29965 (QuantReg: 12.79562) QuantErr: 12.79562 batch_time=0.36153 
Train Epoch: 40 [111/1000 3552/32000 (11%)] Loss: 0.20195 (QuantReg: 12.13518) QuantErr: 12.13518 batch_time=0.34798 
Train Epoch: 40 [116/1000 3712/32000 (12%)] Loss: 0.24364 (QuantReg: 12.65158) QuantErr: 12.65158 batch_time=0.36125 
Train Epoch: 40 [121/1000 3872/32000 (12%)] Loss: 0.47888 (QuantReg: 12.78808) QuantErr: 12.78808 batch_time=0.34438 
Train Epoch: 40 [126/1000 4032/32000 (13%)] Loss: 0.51101 (QuantReg: 12.99453) QuantErr: 12.99453 batch_time=0.35599 
Train Epoch: 40 [131/1000 4192/32000 (13%)] Loss: 0.29180 (QuantReg: 12.61205) QuantErr: 12.61205 batch_time=0.35789 
Train Epoch: 40 [136/1000 4352/32000 (14%)] Loss: 0.54928 (QuantReg: 12.25485) QuantErr: 12.25485 batch_time=0.35439 
Train Epoch: 40 [141/1000 4512/32000 (14%)] Loss: 0.29061 (QuantReg: 13.34205) QuantErr: 13.34205 batch_time=0.35493 
Train Epoch: 40 [146/1000 4672/32000 (15%)] Loss: 0.39014 (QuantReg: 12.84836) QuantErr: 12.84836 batch_time=0.34411 
Train Epoch: 40 [151/1000 4832/32000 (15%)] Loss: 0.20148 (QuantReg: 13.04683) QuantErr: 13.04683 batch_time=0.35827 
Train Epoch: 40 [156/1000 4992/32000 (16%)] Loss: 0.43231 (QuantReg: 12.81611) QuantErr: 12.81611 batch_time=0.45776 
Train Epoch: 40 [161/1000 5152/32000 (16%)] Loss: 0.42294 (QuantReg: 11.53001) QuantErr: 11.53001 batch_time=0.34600 
Train Epoch: 40 [166/1000 5312/32000 (17%)] Loss: 0.16931 (QuantReg: 13.06824) QuantErr: 13.06824 batch_time=0.39689 
Train Epoch: 40 [171/1000 5472/32000 (17%)] Loss: 0.59639 (QuantReg: 12.43539) QuantErr: 12.43539 batch_time=0.34863 
Train Epoch: 40 [176/1000 5632/32000 (18%)] Loss: 0.22537 (QuantReg: 12.97090) QuantErr: 12.97090 batch_time=0.34504 
Train Epoch: 40 [181/1000 5792/32000 (18%)] Loss: 0.25054 (QuantReg: 12.65352) QuantErr: 12.65352 batch_time=0.36615 
Train Epoch: 40 [186/1000 5952/32000 (19%)] Loss: 0.31416 (QuantReg: 12.99551) QuantErr: 12.99551 batch_time=0.43120 
Train Epoch: 40 [191/1000 6112/32000 (19%)] Loss: 0.13469 (QuantReg: 13.19563) QuantErr: 13.19563 batch_time=0.34377 
Train Epoch: 40 [196/1000 6272/32000 (20%)] Loss: 0.40412 (QuantReg: 13.06217) QuantErr: 13.06217 batch_time=0.37290 
Train Epoch: 40 [201/1000 6432/32000 (20%)] Loss: 0.17200 (QuantReg: 12.78602) QuantErr: 12.78602 batch_time=0.34649 
Train Epoch: 40 [206/1000 6592/32000 (21%)] Loss: 0.48933 (QuantReg: 12.19813) QuantErr: 12.19813 batch_time=0.34724 
Train Epoch: 40 [211/1000 6752/32000 (21%)] Loss: 0.16865 (QuantReg: 12.54784) QuantErr: 12.54784 batch_time=0.58494 
Train Epoch: 40 [216/1000 6912/32000 (22%)] Loss: 0.69456 (QuantReg: 12.74381) QuantErr: 12.74381 batch_time=0.35980 
Train Epoch: 40 [221/1000 7072/32000 (22%)] Loss: 0.19471 (QuantReg: 13.00377) QuantErr: 13.00377 batch_time=0.41074 
Train Epoch: 40 [226/1000 7232/32000 (23%)] Loss: 0.19180 (QuantReg: 13.04909) QuantErr: 13.04909 batch_time=0.87979 
Train Epoch: 40 [231/1000 7392/32000 (23%)] Loss: 0.30730 (QuantReg: 12.64563) QuantErr: 12.64563 batch_time=0.35319 
Train Epoch: 40 [236/1000 7552/32000 (24%)] Loss: 0.76943 (QuantReg: 11.67118) QuantErr: 11.67118 batch_time=0.37531 
Train Epoch: 40 [241/1000 7712/32000 (24%)] Loss: 0.07427 (QuantReg: 12.76817) QuantErr: 12.76817 batch_time=0.35053 
Train Epoch: 40 [246/1000 7872/32000 (25%)] Loss: 0.18291 (QuantReg: 12.83862) QuantErr: 12.83862 batch_time=0.35126 
Train Epoch: 40 [251/1000 8032/32000 (25%)] Loss: 0.39957 (QuantReg: 13.05791) QuantErr: 13.05791 batch_time=0.37555 
Train Epoch: 40 [256/1000 8192/32000 (26%)] Loss: 0.32641 (QuantReg: 12.87829) QuantErr: 12.87829 batch_time=0.34037 
Train Epoch: 40 [261/1000 8352/32000 (26%)] Loss: 0.11374 (QuantReg: 13.32489) QuantErr: 13.32489 batch_time=0.75292 
Train Epoch: 40 [266/1000 8512/32000 (27%)] Loss: 0.37959 (QuantReg: 12.69371) QuantErr: 12.69371 batch_time=0.34047 
Train Epoch: 40 [271/1000 8672/32000 (27%)] Loss: 0.35423 (QuantReg: 12.91505) QuantErr: 12.91505 batch_time=0.34275 
Train Epoch: 40 [276/1000 8832/32000 (28%)] Loss: 0.17345 (QuantReg: 12.80801) QuantErr: 12.80801 batch_time=0.34666 
Train Epoch: 40 [281/1000 8992/32000 (28%)] Loss: 0.13173 (QuantReg: 13.26375) QuantErr: 13.26375 batch_time=0.36773 
Train Epoch: 40 [286/1000 9152/32000 (29%)] Loss: 0.11850 (QuantReg: 12.98122) QuantErr: 12.98122 batch_time=0.38383 
Train Epoch: 40 [291/1000 9312/32000 (29%)] Loss: 0.23174 (QuantReg: 12.54554) QuantErr: 12.54554 batch_time=0.36498 
Train Epoch: 40 [296/1000 9472/32000 (30%)] Loss: 0.44304 (QuantReg: 13.23273) QuantErr: 13.23273 batch_time=0.35194 
Train Epoch: 40 [301/1000 9632/32000 (30%)] Loss: 0.17120 (QuantReg: 12.25912) QuantErr: 12.25912 batch_time=0.34475 
Train Epoch: 40 [306/1000 9792/32000 (31%)] Loss: 0.21099 (QuantReg: 13.00483) QuantErr: 13.00483 batch_time=0.34614 
Train Epoch: 40 [311/1000 9952/32000 (31%)] Loss: 0.25298 (QuantReg: 12.93963) QuantErr: 12.93963 batch_time=0.35359 
Train Epoch: 40 [316/1000 10112/32000 (32%)] Loss: 0.32201 (QuantReg: 12.85051) QuantErr: 12.85051 batch_time=0.35813 
Train Epoch: 40 [321/1000 10272/32000 (32%)] Loss: 0.56348 (QuantReg: 13.44097) QuantErr: 13.44097 batch_time=0.61042 
Train Epoch: 40 [326/1000 10432/32000 (33%)] Loss: 0.26289 (QuantReg: 12.97085) QuantErr: 12.97085 batch_time=0.36712 
Train Epoch: 40 [331/1000 10592/32000 (33%)] Loss: 0.27969 (QuantReg: 12.81199) QuantErr: 12.81199 batch_time=0.34210 
Train Epoch: 40 [336/1000 10752/32000 (34%)] Loss: 0.18060 (QuantReg: 12.39940) QuantErr: 12.39940 batch_time=0.35559 
Train Epoch: 40 [341/1000 10912/32000 (34%)] Loss: 0.64112 (QuantReg: 12.52818) QuantErr: 12.52818 batch_time=0.36974 
Train Epoch: 40 [346/1000 11072/32000 (35%)] Loss: 0.46593 (QuantReg: 12.49304) QuantErr: 12.49304 batch_time=0.37448 
Train Epoch: 40 [351/1000 11232/32000 (35%)] Loss: 0.25581 (QuantReg: 12.83440) QuantErr: 12.83440 batch_time=0.34653 
Train Epoch: 40 [356/1000 11392/32000 (36%)] Loss: 0.31582 (QuantReg: 12.53725) QuantErr: 12.53725 batch_time=0.36908 
Train Epoch: 40 [361/1000 11552/32000 (36%)] Loss: 0.41819 (QuantReg: 12.79681) QuantErr: 12.79681 batch_time=0.34789 
Train Epoch: 40 [366/1000 11712/32000 (37%)] Loss: 0.23966 (QuantReg: 12.46329) QuantErr: 12.46329 batch_time=0.34607 
Train Epoch: 40 [371/1000 11872/32000 (37%)] Loss: 0.13392 (QuantReg: 13.23795) QuantErr: 13.23795 batch_time=0.34470 
Train Epoch: 40 [376/1000 12032/32000 (38%)] Loss: 0.11211 (QuantReg: 12.68268) QuantErr: 12.68268 batch_time=0.34555 
Train Epoch: 40 [381/1000 12192/32000 (38%)] Loss: 0.13825 (QuantReg: 13.04005) QuantErr: 13.04005 batch_time=0.36599 
Train Epoch: 40 [386/1000 12352/32000 (39%)] Loss: 0.18565 (QuantReg: 13.39478) QuantErr: 13.39478 batch_time=0.68972 
Train Epoch: 40 [391/1000 12512/32000 (39%)] Loss: 0.27236 (QuantReg: 13.01029) QuantErr: 13.01029 batch_time=0.34403 
Train Epoch: 40 [396/1000 12672/32000 (40%)] Loss: 0.20707 (QuantReg: 12.92885) QuantErr: 12.92885 batch_time=0.36654 
Train Epoch: 40 [401/1000 12832/32000 (40%)] Loss: 0.28493 (QuantReg: 12.70195) QuantErr: 12.70195 batch_time=0.34416 
Train Epoch: 40 [406/1000 12992/32000 (41%)] Loss: 0.16602 (QuantReg: 13.40109) QuantErr: 13.40109 batch_time=0.35188 
Train Epoch: 40 [411/1000 13152/32000 (41%)] Loss: 0.40138 (QuantReg: 12.65757) QuantErr: 12.65757 batch_time=0.36674 
Train Epoch: 40 [416/1000 13312/32000 (42%)] Loss: 0.19181 (QuantReg: 13.15940) QuantErr: 13.15940 batch_time=0.42332 
Train Epoch: 40 [421/1000 13472/32000 (42%)] Loss: 0.26384 (QuantReg: 13.12943) QuantErr: 13.12943 batch_time=0.34036 
Train Epoch: 40 [426/1000 13632/32000 (43%)] Loss: 0.46429 (QuantReg: 12.31973) QuantErr: 12.31973 batch_time=0.34026 
Train Epoch: 40 [431/1000 13792/32000 (43%)] Loss: 0.35692 (QuantReg: 12.36026) QuantErr: 12.36026 batch_time=0.33758 
Train Epoch: 40 [436/1000 13952/32000 (44%)] Loss: 0.51303 (QuantReg: 12.51850) QuantErr: 12.51850 batch_time=0.33866 
Train Epoch: 40 [441/1000 14112/32000 (44%)] Loss: 0.18555 (QuantReg: 12.72808) QuantErr: 12.72808 batch_time=0.35436 
Train Epoch: 40 [446/1000 14272/32000 (45%)] Loss: 0.23238 (QuantReg: 12.70155) QuantErr: 12.70155 batch_time=0.36424 
Train Epoch: 40 [451/1000 14432/32000 (45%)] Loss: 0.20631 (QuantReg: 12.95036) QuantErr: 12.95036 batch_time=0.34177 
Train Epoch: 40 [456/1000 14592/32000 (46%)] Loss: 0.06573 (QuantReg: 13.71573) QuantErr: 13.71573 batch_time=0.38259 
Train Epoch: 40 [461/1000 14752/32000 (46%)] Loss: 0.23630 (QuantReg: 12.37249) QuantErr: 12.37249 batch_time=0.34193 
Train Epoch: 40 [466/1000 14912/32000 (47%)] Loss: 0.21337 (QuantReg: 13.07779) QuantErr: 13.07779 batch_time=0.34214 
Train Epoch: 40 [471/1000 15072/32000 (47%)] Loss: 0.30998 (QuantReg: 12.68824) QuantErr: 12.68824 batch_time=0.35143 
Train Epoch: 40 [476/1000 15232/32000 (48%)] Loss: 0.29541 (QuantReg: 12.19771) QuantErr: 12.19771 batch_time=0.40556 
Train Epoch: 40 [481/1000 15392/32000 (48%)] Loss: 0.16007 (QuantReg: 13.00111) QuantErr: 13.00111 batch_time=0.35125 
Train Epoch: 40 [486/1000 15552/32000 (49%)] Loss: 0.33006 (QuantReg: 12.42603) QuantErr: 12.42603 batch_time=0.34868 
Train Epoch: 40 [491/1000 15712/32000 (49%)] Loss: 0.36532 (QuantReg: 13.12814) QuantErr: 13.12814 batch_time=0.34746 
Train Epoch: 40 [496/1000 15872/32000 (50%)] Loss: 0.13409 (QuantReg: 12.87484) QuantErr: 12.87484 batch_time=0.35085 
Train Epoch: 40 [501/1000 16032/32000 (50%)] Loss: 0.17365 (QuantReg: 12.97938) QuantErr: 12.97938 batch_time=0.34489 
Train Epoch: 40 [506/1000 16192/32000 (51%)] Loss: 0.24204 (QuantReg: 12.69630) QuantErr: 12.69630 batch_time=0.42213 
Train Epoch: 40 [511/1000 16352/32000 (51%)] Loss: 0.20744 (QuantReg: 12.78473) QuantErr: 12.78473 batch_time=0.50152 
Train Epoch: 40 [516/1000 16512/32000 (52%)] Loss: 0.21843 (QuantReg: 12.50003) QuantErr: 12.50003 batch_time=0.35625 
Train Epoch: 40 [521/1000 16672/32000 (52%)] Loss: 0.41539 (QuantReg: 12.76677) QuantErr: 12.76677 batch_time=0.34925 
Train Epoch: 40 [526/1000 16832/32000 (53%)] Loss: 0.25459 (QuantReg: 12.85267) QuantErr: 12.85267 batch_time=0.36774 
Train Epoch: 40 [531/1000 16992/32000 (53%)] Loss: 0.25749 (QuantReg: 12.97920) QuantErr: 12.97920 batch_time=0.58356 
Train Epoch: 40 [536/1000 17152/32000 (54%)] Loss: 0.30946 (QuantReg: 12.99533) QuantErr: 12.99533 batch_time=0.34513 
Train Epoch: 40 [541/1000 17312/32000 (54%)] Loss: 0.24493 (QuantReg: 13.25488) QuantErr: 13.25488 batch_time=0.34647 
Train Epoch: 40 [546/1000 17472/32000 (55%)] Loss: 0.22550 (QuantReg: 13.44454) QuantErr: 13.44454 batch_time=0.88338 
Train Epoch: 40 [551/1000 17632/32000 (55%)] Loss: 0.28111 (QuantReg: 12.50917) QuantErr: 12.50917 batch_time=0.34910 
Train Epoch: 40 [556/1000 17792/32000 (56%)] Loss: 0.21574 (QuantReg: 12.62294) QuantErr: 12.62294 batch_time=0.36366 
Train Epoch: 40 [561/1000 17952/32000 (56%)] Loss: 0.22320 (QuantReg: 12.92660) QuantErr: 12.92660 batch_time=0.34355 
Train Epoch: 40 [566/1000 18112/32000 (57%)] Loss: 0.35829 (QuantReg: 12.86774) QuantErr: 12.86774 batch_time=0.34700 
Train Epoch: 40 [571/1000 18272/32000 (57%)] Loss: 0.51233 (QuantReg: 12.48924) QuantErr: 12.48924 batch_time=0.34296 
Train Epoch: 40 [576/1000 18432/32000 (58%)] Loss: 0.21137 (QuantReg: 13.15458) QuantErr: 13.15458 batch_time=0.33800 
Train Epoch: 40 [581/1000 18592/32000 (58%)] Loss: 0.17952 (QuantReg: 13.07551) QuantErr: 13.07551 batch_time=0.70304 
Train Epoch: 40 [586/1000 18752/32000 (59%)] Loss: 0.36606 (QuantReg: 13.17695) QuantErr: 13.17695 batch_time=0.34152 
Train Epoch: 40 [591/1000 18912/32000 (59%)] Loss: 0.29341 (QuantReg: 12.76064) QuantErr: 12.76064 batch_time=0.33702 
Train Epoch: 40 [596/1000 19072/32000 (60%)] Loss: 0.25013 (QuantReg: 13.25177) QuantErr: 13.25177 batch_time=0.33878 
Train Epoch: 40 [601/1000 19232/32000 (60%)] Loss: 0.10820 (QuantReg: 12.94694) QuantErr: 12.94694 batch_time=0.36617 
Train Epoch: 40 [606/1000 19392/32000 (61%)] Loss: 0.58772 (QuantReg: 12.88698) QuantErr: 12.88698 batch_time=0.38306 
Train Epoch: 40 [611/1000 19552/32000 (61%)] Loss: 0.60983 (QuantReg: 12.63857) QuantErr: 12.63857 batch_time=0.34526 
Train Epoch: 40 [616/1000 19712/32000 (62%)] Loss: 0.48213 (QuantReg: 12.43720) QuantErr: 12.43720 batch_time=0.34603 
Train Epoch: 40 [621/1000 19872/32000 (62%)] Loss: 0.21512 (QuantReg: 12.65056) QuantErr: 12.65056 batch_time=0.37291 
Train Epoch: 40 [626/1000 20032/32000 (63%)] Loss: 0.37043 (QuantReg: 12.47645) QuantErr: 12.47645 batch_time=0.35848 
Train Epoch: 40 [631/1000 20192/32000 (63%)] Loss: 0.35474 (QuantReg: 13.22415) QuantErr: 13.22415 batch_time=0.34534 
Train Epoch: 40 [636/1000 20352/32000 (64%)] Loss: 0.24512 (QuantReg: 13.17269) QuantErr: 13.17269 batch_time=0.34538 
Train Epoch: 40 [641/1000 20512/32000 (64%)] Loss: 0.39978 (QuantReg: 12.56179) QuantErr: 12.56179 batch_time=0.60752 
Train Epoch: 40 [646/1000 20672/32000 (65%)] Loss: 0.39163 (QuantReg: 12.63169) QuantErr: 12.63169 batch_time=0.34558 
Train Epoch: 40 [651/1000 20832/32000 (65%)] Loss: 0.46850 (QuantReg: 13.21923) QuantErr: 13.21923 batch_time=0.34638 
Train Epoch: 40 [656/1000 20992/32000 (66%)] Loss: 0.45268 (QuantReg: 12.63593) QuantErr: 12.63593 batch_time=0.34858 
Train Epoch: 40 [661/1000 21152/32000 (66%)] Loss: 0.69733 (QuantReg: 12.69572) QuantErr: 12.69572 batch_time=0.40114 
Train Epoch: 40 [666/1000 21312/32000 (67%)] Loss: 0.26168 (QuantReg: 12.77216) QuantErr: 12.77216 batch_time=0.37255 
Train Epoch: 40 [671/1000 21472/32000 (67%)] Loss: 0.19993 (QuantReg: 12.88695) QuantErr: 12.88695 batch_time=0.37214 
Train Epoch: 40 [676/1000 21632/32000 (68%)] Loss: 0.27105 (QuantReg: 12.09314) QuantErr: 12.09314 batch_time=0.38471 
Train Epoch: 40 [681/1000 21792/32000 (68%)] Loss: 0.29757 (QuantReg: 13.52446) QuantErr: 13.52446 batch_time=0.37379 
Train Epoch: 40 [686/1000 21952/32000 (69%)] Loss: 0.22185 (QuantReg: 12.79612) QuantErr: 12.79612 batch_time=0.35180 
Train Epoch: 40 [691/1000 22112/32000 (69%)] Loss: 0.29357 (QuantReg: 12.91152) QuantErr: 12.91152 batch_time=0.34911 
Train Epoch: 40 [696/1000 22272/32000 (70%)] Loss: 0.38781 (QuantReg: 12.61367) QuantErr: 12.61367 batch_time=0.35979 
Train Epoch: 40 [701/1000 22432/32000 (70%)] Loss: 0.23674 (QuantReg: 13.08512) QuantErr: 13.08512 batch_time=0.35500 
Train Epoch: 40 [706/1000 22592/32000 (71%)] Loss: 0.14391 (QuantReg: 13.21914) QuantErr: 13.21914 batch_time=0.69017 
Train Epoch: 40 [711/1000 22752/32000 (71%)] Loss: 0.13736 (QuantReg: 12.56365) QuantErr: 12.56365 batch_time=0.36763 
Train Epoch: 40 [716/1000 22912/32000 (72%)] Loss: 0.35539 (QuantReg: 12.45857) QuantErr: 12.45857 batch_time=0.34194 
Train Epoch: 40 [721/1000 23072/32000 (72%)] Loss: 0.39593 (QuantReg: 12.74245) QuantErr: 12.74245 batch_time=0.34730 
Train Epoch: 40 [726/1000 23232/32000 (73%)] Loss: 0.22947 (QuantReg: 12.61417) QuantErr: 12.61417 batch_time=0.35157 
Train Epoch: 40 [731/1000 23392/32000 (73%)] Loss: 0.34042 (QuantReg: 12.60434) QuantErr: 12.60434 batch_time=0.41903 
Train Epoch: 40 [736/1000 23552/32000 (74%)] Loss: 0.17378 (QuantReg: 13.67457) QuantErr: 13.67457 batch_time=0.35218 
Train Epoch: 40 [741/1000 23712/32000 (74%)] Loss: 0.29923 (QuantReg: 13.00124) QuantErr: 13.00124 batch_time=0.34828 
Train Epoch: 40 [746/1000 23872/32000 (75%)] Loss: 0.42362 (QuantReg: 13.26602) QuantErr: 13.26602 batch_time=0.35109 
Train Epoch: 40 [751/1000 24032/32000 (75%)] Loss: 0.27671 (QuantReg: 12.90687) QuantErr: 12.90687 batch_time=0.36378 
Train Epoch: 40 [756/1000 24192/32000 (76%)] Loss: 0.54413 (QuantReg: 12.96227) QuantErr: 12.96227 batch_time=0.41228 
Train Epoch: 40 [761/1000 24352/32000 (76%)] Loss: 0.23400 (QuantReg: 12.73772) QuantErr: 12.73772 batch_time=0.37321 
Train Epoch: 40 [766/1000 24512/32000 (77%)] Loss: 0.33125 (QuantReg: 13.14264) QuantErr: 13.14264 batch_time=0.39000 
Train Epoch: 40 [771/1000 24672/32000 (77%)] Loss: 0.18640 (QuantReg: 13.14211) QuantErr: 13.14211 batch_time=0.35619 
Train Epoch: 40 [776/1000 24832/32000 (78%)] Loss: 0.43511 (QuantReg: 13.35781) QuantErr: 13.35781 batch_time=0.36818 
Train Epoch: 40 [781/1000 24992/32000 (78%)] Loss: 0.25071 (QuantReg: 12.86469) QuantErr: 12.86469 batch_time=0.37241 
Train Epoch: 40 [786/1000 25152/32000 (79%)] Loss: 0.23937 (QuantReg: 12.69539) QuantErr: 12.69539 batch_time=0.37289 
Train Epoch: 40 [791/1000 25312/32000 (79%)] Loss: 0.57306 (QuantReg: 12.51256) QuantErr: 12.51256 batch_time=0.34854 
Train Epoch: 40 [796/1000 25472/32000 (80%)] Loss: 0.44272 (QuantReg: 12.65883) QuantErr: 12.65883 batch_time=0.40458 
Train Epoch: 40 [801/1000 25632/32000 (80%)] Loss: 0.64287 (QuantReg: 12.83745) QuantErr: 12.83745 batch_time=0.36515 
Train Epoch: 40 [806/1000 25792/32000 (81%)] Loss: 0.19692 (QuantReg: 12.50369) QuantErr: 12.50369 batch_time=0.36445 
Train Epoch: 40 [811/1000 25952/32000 (81%)] Loss: 0.60684 (QuantReg: 13.11595) QuantErr: 13.11595 batch_time=0.38426 
Train Epoch: 40 [816/1000 26112/32000 (82%)] Loss: 0.26725 (QuantReg: 12.79868) QuantErr: 12.79868 batch_time=0.41283 
Train Epoch: 40 [821/1000 26272/32000 (82%)] Loss: 0.79353 (QuantReg: 13.27664) QuantErr: 13.27664 batch_time=0.35177 
Train Epoch: 40 [826/1000 26432/32000 (83%)] Loss: 0.14429 (QuantReg: 12.85462) QuantErr: 12.85462 batch_time=0.42846 
Train Epoch: 40 [831/1000 26592/32000 (83%)] Loss: 0.34316 (QuantReg: 12.69957) QuantErr: 12.69957 batch_time=0.35915 
Train Epoch: 40 [836/1000 26752/32000 (84%)] Loss: 0.21520 (QuantReg: 12.63054) QuantErr: 12.63054 batch_time=0.47726 
Train Epoch: 40 [841/1000 26912/32000 (84%)] Loss: 0.32185 (QuantReg: 12.20018) QuantErr: 12.20018 batch_time=0.34970 
Train Epoch: 40 [846/1000 27072/32000 (85%)] Loss: 0.26427 (QuantReg: 13.10586) QuantErr: 13.10586 batch_time=0.34708 
Train Epoch: 40 [851/1000 27232/32000 (85%)] Loss: 0.42431 (QuantReg: 13.38818) QuantErr: 13.38818 batch_time=0.62188 
Train Epoch: 40 [856/1000 27392/32000 (86%)] Loss: 0.28257 (QuantReg: 12.66214) QuantErr: 12.66214 batch_time=0.34907 
Train Epoch: 40 [861/1000 27552/32000 (86%)] Loss: 0.22259 (QuantReg: 13.71227) QuantErr: 13.71227 batch_time=0.37383 
Train Epoch: 40 [866/1000 27712/32000 (87%)] Loss: 0.35305 (QuantReg: 13.06326) QuantErr: 13.06326 batch_time=0.91592 
Train Epoch: 40 [871/1000 27872/32000 (87%)] Loss: 0.25371 (QuantReg: 12.96124) QuantErr: 12.96124 batch_time=0.35679 
Train Epoch: 40 [876/1000 28032/32000 (88%)] Loss: 0.20119 (QuantReg: 12.40655) QuantErr: 12.40655 batch_time=0.40586 
Train Epoch: 40 [881/1000 28192/32000 (88%)] Loss: 0.38996 (QuantReg: 13.25731) QuantErr: 13.25731 batch_time=0.41398 
Train Epoch: 40 [886/1000 28352/32000 (89%)] Loss: 0.28692 (QuantReg: 13.16070) QuantErr: 13.16070 batch_time=0.33962 
Train Epoch: 40 [891/1000 28512/32000 (89%)] Loss: 0.25126 (QuantReg: 13.11124) QuantErr: 13.11124 batch_time=0.34232 
Train Epoch: 40 [896/1000 28672/32000 (90%)] Loss: 0.36100 (QuantReg: 12.89570) QuantErr: 12.89570 batch_time=0.34415 
Train Epoch: 40 [901/1000 28832/32000 (90%)] Loss: 0.08662 (QuantReg: 12.77302) QuantErr: 12.77302 batch_time=0.91126 
Train Epoch: 40 [906/1000 28992/32000 (91%)] Loss: 0.27327 (QuantReg: 12.28396) QuantErr: 12.28396 batch_time=0.35516 
Train Epoch: 40 [911/1000 29152/32000 (91%)] Loss: 0.13702 (QuantReg: 13.32926) QuantErr: 13.32926 batch_time=0.41493 
Train Epoch: 40 [916/1000 29312/32000 (92%)] Loss: 0.29847 (QuantReg: 12.90943) QuantErr: 12.90943 batch_time=0.34611 
Train Epoch: 40 [921/1000 29472/32000 (92%)] Loss: 0.64097 (QuantReg: 12.73577) QuantErr: 12.73577 batch_time=0.36060 
Train Epoch: 40 [926/1000 29632/32000 (93%)] Loss: 0.37048 (QuantReg: 12.40098) QuantErr: 12.40098 batch_time=0.49325 
Train Epoch: 40 [931/1000 29792/32000 (93%)] Loss: 0.46318 (QuantReg: 13.04769) QuantErr: 13.04769 batch_time=0.40317 
Train Epoch: 40 [936/1000 29952/32000 (94%)] Loss: 0.53405 (QuantReg: 12.68808) QuantErr: 12.68808 batch_time=0.34240 
Train Epoch: 40 [941/1000 30112/32000 (94%)] Loss: 0.20340 (QuantReg: 13.08702) QuantErr: 13.08702 batch_time=0.42053 
Train Epoch: 40 [946/1000 30272/32000 (95%)] Loss: 0.56259 (QuantReg: 12.11971) QuantErr: 12.11971 batch_time=0.36453 
Train Epoch: 40 [951/1000 30432/32000 (95%)] Loss: 0.33775 (QuantReg: 12.59187) QuantErr: 12.59187 batch_time=0.36238 
Train Epoch: 40 [956/1000 30592/32000 (96%)] Loss: 0.60781 (QuantReg: 12.46110) QuantErr: 12.46110 batch_time=0.35223 
Train Epoch: 40 [961/1000 30752/32000 (96%)] Loss: 0.37599 (QuantReg: 12.73486) QuantErr: 12.73486 batch_time=0.63175 
Train Epoch: 40 [966/1000 30912/32000 (97%)] Loss: 0.23556 (QuantReg: 13.35330) QuantErr: 13.35330 batch_time=0.37710 
Train Epoch: 40 [971/1000 31072/32000 (97%)] Loss: 0.23636 (QuantReg: 13.19024) QuantErr: 13.19024 batch_time=0.35006 
Train Epoch: 40 [976/1000 31232/32000 (98%)] Loss: 0.20101 (QuantReg: 13.03176) QuantErr: 13.03176 batch_time=0.34764 
Train Epoch: 40 [981/1000 31392/32000 (98%)] Loss: 0.20339 (QuantReg: 12.53675) QuantErr: 12.53675 batch_time=0.40993 
Train Epoch: 40 [986/1000 31552/32000 (99%)] Loss: 0.43076 (QuantReg: 12.74302) QuantErr: 12.74302 batch_time=0.35306 
Train Epoch: 40 [991/1000 31712/32000 (99%)] Loss: 0.18446 (QuantReg: 13.54428) QuantErr: 13.54428 batch_time=0.38948 
Train Epoch: 40 [996/1000 31872/32000 (100%)] Loss: 0.17670 (QuantReg: 13.45425) QuantErr: 13.45425 batch_time=0.41167 
Train Epoch: 40 codebook_update_time=1.81188
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch40.pth ...
Done in 4.073s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 0.30786264027282595
 quant_reg      : 12.847582283973694
 quant_err      : 12.847582283973694
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 40000
 MSRVTT_full_val/t2v_metrics/R1: 30.58350100603622
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.116700201207244
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.96562436484211
 MSRVTT_full_val/v2t_metrics/R1: 35.412474849094565
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.3561368209255535
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.00416654345572
 MSRVTT_full_test/t2v_metrics/R1: 12.809364548494983
 MSRVTT_full_test/t2v_metrics/R5: 37.759197324414714
 MSRVTT_full_test/t2v_metrics/R10: 51.070234113712374
 MSRVTT_full_test/t2v_metrics/R50: 80.70234113712375
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.124080267558526
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.123220339225938
 MSRVTT_full_test/v2t_metrics/R1: 16.421404682274247
 MSRVTT_full_test/v2t_metrics/R5: 43.74581939799331
 MSRVTT_full_test/v2t_metrics/R10: 58.39464882943144
 MSRVTT_full_test/v2t_metrics/R50: 87.32441471571906
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.929765886287626
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.746145732050216
 mnt_best       : 29.290689157230588
 not_improved_count: 1
Train Epoch: 41 [1/1000 32/32000 (0%)] Loss: 0.42663 (QuantReg: 12.35187) QuantErr: 12.35187 batch_time=27.37109 
Train Epoch: 41 [6/1000 192/32000 (1%)] Loss: 0.22597 (QuantReg: 13.19021) QuantErr: 13.19021 batch_time=0.36560 
Train Epoch: 41 [11/1000 352/32000 (1%)] Loss: 0.53509 (QuantReg: 12.41432) QuantErr: 12.41432 batch_time=0.34963 
Train Epoch: 41 [16/1000 512/32000 (2%)] Loss: 0.39365 (QuantReg: 12.27865) QuantErr: 12.27865 batch_time=0.35095 
Train Epoch: 41 [21/1000 672/32000 (2%)] Loss: 0.25910 (QuantReg: 12.28179) QuantErr: 12.28179 batch_time=0.35129 
Train Epoch: 41 [26/1000 832/32000 (3%)] Loss: 0.25362 (QuantReg: 13.23822) QuantErr: 13.23822 batch_time=0.37177 
Train Epoch: 41 [31/1000 992/32000 (3%)] Loss: 0.46444 (QuantReg: 13.46392) QuantErr: 13.46392 batch_time=0.34852 
Train Epoch: 41 [36/1000 1152/32000 (4%)] Loss: 0.36018 (QuantReg: 13.55064) QuantErr: 13.55064 batch_time=0.34604 
Train Epoch: 41 [41/1000 1312/32000 (4%)] Loss: 0.09387 (QuantReg: 12.44419) QuantErr: 12.44419 batch_time=0.35452 
Train Epoch: 41 [46/1000 1472/32000 (5%)] Loss: 0.22415 (QuantReg: 12.80750) QuantErr: 12.80750 batch_time=0.36565 
Train Epoch: 41 [51/1000 1632/32000 (5%)] Loss: 0.51400 (QuantReg: 13.01110) QuantErr: 13.01110 batch_time=0.38538 
Train Epoch: 41 [56/1000 1792/32000 (6%)] Loss: 0.20107 (QuantReg: 12.85569) QuantErr: 12.85569 batch_time=0.34356 
Train Epoch: 41 [61/1000 1952/32000 (6%)] Loss: 0.24574 (QuantReg: 12.34695) QuantErr: 12.34695 batch_time=0.34093 
Train Epoch: 41 [66/1000 2112/32000 (7%)] Loss: 0.29488 (QuantReg: 12.55024) QuantErr: 12.55024 batch_time=0.38311 
Train Epoch: 41 [71/1000 2272/32000 (7%)] Loss: 0.19030 (QuantReg: 12.97618) QuantErr: 12.97618 batch_time=0.38231 
Train Epoch: 41 [76/1000 2432/32000 (8%)] Loss: 0.13505 (QuantReg: 13.22709) QuantErr: 13.22709 batch_time=0.44858 
Train Epoch: 41 [81/1000 2592/32000 (8%)] Loss: 0.07841 (QuantReg: 12.93620) QuantErr: 12.93620 batch_time=0.37087 
Train Epoch: 41 [86/1000 2752/32000 (9%)] Loss: 0.91655 (QuantReg: 12.32524) QuantErr: 12.32524 batch_time=0.37211 
Train Epoch: 41 [91/1000 2912/32000 (9%)] Loss: 0.64825 (QuantReg: 12.01671) QuantErr: 12.01671 batch_time=0.36820 
Train Epoch: 41 [96/1000 3072/32000 (10%)] Loss: 0.50007 (QuantReg: 12.82553) QuantErr: 12.82553 batch_time=0.38893 
Train Epoch: 41 [101/1000 3232/32000 (10%)] Loss: 0.09987 (QuantReg: 12.56336) QuantErr: 12.56336 batch_time=0.35387 
Train Epoch: 41 [106/1000 3392/32000 (11%)] Loss: 0.12066 (QuantReg: 12.80342) QuantErr: 12.80342 batch_time=0.34848 
Train Epoch: 41 [111/1000 3552/32000 (11%)] Loss: 0.30020 (QuantReg: 12.27640) QuantErr: 12.27640 batch_time=0.35202 
Train Epoch: 41 [116/1000 3712/32000 (12%)] Loss: 0.35195 (QuantReg: 12.84297) QuantErr: 12.84297 batch_time=0.34898 
Train Epoch: 41 [121/1000 3872/32000 (12%)] Loss: 0.12598 (QuantReg: 13.35217) QuantErr: 13.35217 batch_time=0.34743 
Train Epoch: 41 [126/1000 4032/32000 (13%)] Loss: 0.14863 (QuantReg: 13.28845) QuantErr: 13.28845 batch_time=0.34911 
Train Epoch: 41 [131/1000 4192/32000 (13%)] Loss: 0.39100 (QuantReg: 12.47495) QuantErr: 12.47495 batch_time=1.35394 
Train Epoch: 41 [136/1000 4352/32000 (14%)] Loss: 0.29280 (QuantReg: 12.77140) QuantErr: 12.77140 batch_time=0.73433 
Train Epoch: 41 [141/1000 4512/32000 (14%)] Loss: 0.30310 (QuantReg: 13.13144) QuantErr: 13.13144 batch_time=0.37636 
Train Epoch: 41 [146/1000 4672/32000 (15%)] Loss: 0.33768 (QuantReg: 12.44348) QuantErr: 12.44348 batch_time=0.37837 
Train Epoch: 41 [151/1000 4832/32000 (15%)] Loss: 0.24622 (QuantReg: 12.72077) QuantErr: 12.72077 batch_time=0.36725 
Train Epoch: 41 [156/1000 4992/32000 (16%)] Loss: 0.70958 (QuantReg: 12.89999) QuantErr: 12.89999 batch_time=0.71616 
Train Epoch: 41 [161/1000 5152/32000 (16%)] Loss: 0.30213 (QuantReg: 12.81570) QuantErr: 12.81570 batch_time=0.39427 
Train Epoch: 41 [166/1000 5312/32000 (17%)] Loss: 0.09841 (QuantReg: 13.20256) QuantErr: 13.20256 batch_time=0.37161 
Train Epoch: 41 [171/1000 5472/32000 (17%)] Loss: 0.33633 (QuantReg: 13.12336) QuantErr: 13.12336 batch_time=0.35727 
Train Epoch: 41 [176/1000 5632/32000 (18%)] Loss: 0.15060 (QuantReg: 13.10544) QuantErr: 13.10544 batch_time=0.36751 
Train Epoch: 41 [181/1000 5792/32000 (18%)] Loss: 0.23035 (QuantReg: 13.34418) QuantErr: 13.34418 batch_time=0.35361 
Train Epoch: 41 [186/1000 5952/32000 (19%)] Loss: 0.34906 (QuantReg: 12.96563) QuantErr: 12.96563 batch_time=0.35492 
Train Epoch: 41 [191/1000 6112/32000 (19%)] Loss: 0.33140 (QuantReg: 12.83832) QuantErr: 12.83832 batch_time=0.35439 
Train Epoch: 41 [196/1000 6272/32000 (20%)] Loss: 0.40363 (QuantReg: 12.49623) QuantErr: 12.49623 batch_time=0.35893 
Train Epoch: 41 [201/1000 6432/32000 (20%)] Loss: 0.34225 (QuantReg: 12.49939) QuantErr: 12.49939 batch_time=0.44249 
Train Epoch: 41 [206/1000 6592/32000 (21%)] Loss: 0.15251 (QuantReg: 12.94421) QuantErr: 12.94421 batch_time=0.43526 
Train Epoch: 41 [211/1000 6752/32000 (21%)] Loss: 0.47307 (QuantReg: 13.01779) QuantErr: 13.01779 batch_time=0.34946 
Train Epoch: 41 [216/1000 6912/32000 (22%)] Loss: 0.25306 (QuantReg: 13.08678) QuantErr: 13.08678 batch_time=0.45709 
Train Epoch: 41 [221/1000 7072/32000 (22%)] Loss: 0.28370 (QuantReg: 12.53583) QuantErr: 12.53583 batch_time=0.36729 
Train Epoch: 41 [226/1000 7232/32000 (23%)] Loss: 0.17247 (QuantReg: 13.16429) QuantErr: 13.16429 batch_time=0.39772 
Train Epoch: 41 [231/1000 7392/32000 (23%)] Loss: 0.36367 (QuantReg: 13.04111) QuantErr: 13.04111 batch_time=0.35770 
Train Epoch: 41 [236/1000 7552/32000 (24%)] Loss: 0.19023 (QuantReg: 12.43343) QuantErr: 12.43343 batch_time=0.36628 
Train Epoch: 41 [241/1000 7712/32000 (24%)] Loss: 0.40817 (QuantReg: 12.47314) QuantErr: 12.47314 batch_time=0.35779 
Train Epoch: 41 [246/1000 7872/32000 (25%)] Loss: 0.15910 (QuantReg: 13.36888) QuantErr: 13.36888 batch_time=0.35633 
Train Epoch: 41 [251/1000 8032/32000 (25%)] Loss: 0.21104 (QuantReg: 13.22029) QuantErr: 13.22029 batch_time=0.46363 
Train Epoch: 41 [256/1000 8192/32000 (26%)] Loss: 0.22875 (QuantReg: 12.84532) QuantErr: 12.84532 batch_time=0.35877 
Train Epoch: 41 [261/1000 8352/32000 (26%)] Loss: 0.28532 (QuantReg: 12.49278) QuantErr: 12.49278 batch_time=0.35485 
Train Epoch: 41 [266/1000 8512/32000 (27%)] Loss: 0.35998 (QuantReg: 13.21900) QuantErr: 13.21900 batch_time=0.35366 
Train Epoch: 41 [271/1000 8672/32000 (27%)] Loss: 0.44461 (QuantReg: 12.68640) QuantErr: 12.68640 batch_time=0.39823 
Train Epoch: 41 [276/1000 8832/32000 (28%)] Loss: 0.43509 (QuantReg: 12.38980) QuantErr: 12.38980 batch_time=0.37515 
Train Epoch: 41 [281/1000 8992/32000 (28%)] Loss: 0.34293 (QuantReg: 13.46737) QuantErr: 13.46737 batch_time=0.35216 
Train Epoch: 41 [286/1000 9152/32000 (29%)] Loss: 0.24795 (QuantReg: 12.20912) QuantErr: 12.20912 batch_time=0.39991 
Train Epoch: 41 [291/1000 9312/32000 (29%)] Loss: 0.23990 (QuantReg: 13.21884) QuantErr: 13.21884 batch_time=0.44701 
Train Epoch: 41 [296/1000 9472/32000 (30%)] Loss: 0.13485 (QuantReg: 12.83892) QuantErr: 12.83892 batch_time=0.37462 
Train Epoch: 41 [301/1000 9632/32000 (30%)] Loss: 0.05541 (QuantReg: 13.31310) QuantErr: 13.31310 batch_time=0.34584 
Train Epoch: 41 [306/1000 9792/32000 (31%)] Loss: 0.15142 (QuantReg: 13.11390) QuantErr: 13.11390 batch_time=0.36779 
Train Epoch: 41 [311/1000 9952/32000 (31%)] Loss: 0.23974 (QuantReg: 13.02866) QuantErr: 13.02866 batch_time=0.35516 
Train Epoch: 41 [316/1000 10112/32000 (32%)] Loss: 0.36557 (QuantReg: 12.48170) QuantErr: 12.48170 batch_time=0.36000 
Train Epoch: 41 [321/1000 10272/32000 (32%)] Loss: 0.33609 (QuantReg: 12.39304) QuantErr: 12.39304 batch_time=0.36228 
Train Epoch: 41 [326/1000 10432/32000 (33%)] Loss: 0.13823 (QuantReg: 13.06414) QuantErr: 13.06414 batch_time=0.37092 
Train Epoch: 41 [331/1000 10592/32000 (33%)] Loss: 0.67557 (QuantReg: 12.71357) QuantErr: 12.71357 batch_time=0.35042 
Train Epoch: 41 [336/1000 10752/32000 (34%)] Loss: 0.43721 (QuantReg: 12.50409) QuantErr: 12.50409 batch_time=0.36731 
Train Epoch: 41 [341/1000 10912/32000 (34%)] Loss: 0.45020 (QuantReg: 12.55792) QuantErr: 12.55792 batch_time=0.36385 
Train Epoch: 41 [346/1000 11072/32000 (35%)] Loss: 0.52623 (QuantReg: 12.42595) QuantErr: 12.42595 batch_time=0.35518 
Train Epoch: 41 [351/1000 11232/32000 (35%)] Loss: 0.32524 (QuantReg: 12.72277) QuantErr: 12.72277 batch_time=0.34678 
Train Epoch: 41 [356/1000 11392/32000 (36%)] Loss: 0.53342 (QuantReg: 12.54242) QuantErr: 12.54242 batch_time=0.36188 
Train Epoch: 41 [361/1000 11552/32000 (36%)] Loss: 0.20437 (QuantReg: 12.83948) QuantErr: 12.83948 batch_time=0.34385 
Train Epoch: 41 [366/1000 11712/32000 (37%)] Loss: 0.44161 (QuantReg: 12.94577) QuantErr: 12.94577 batch_time=0.37678 
Train Epoch: 41 [371/1000 11872/32000 (37%)] Loss: 0.19571 (QuantReg: 13.36670) QuantErr: 13.36670 batch_time=0.36502 
Train Epoch: 41 [376/1000 12032/32000 (38%)] Loss: 0.22347 (QuantReg: 12.72388) QuantErr: 12.72388 batch_time=0.36272 
Train Epoch: 41 [381/1000 12192/32000 (38%)] Loss: 0.60647 (QuantReg: 12.65756) QuantErr: 12.65756 batch_time=0.37811 
Train Epoch: 41 [386/1000 12352/32000 (39%)] Loss: 0.37271 (QuantReg: 12.75545) QuantErr: 12.75545 batch_time=0.37600 
Train Epoch: 41 [391/1000 12512/32000 (39%)] Loss: 0.22184 (QuantReg: 13.26904) QuantErr: 13.26904 batch_time=0.35474 
Train Epoch: 41 [396/1000 12672/32000 (40%)] Loss: 0.12118 (QuantReg: 13.11726) QuantErr: 13.11726 batch_time=0.44282 
Train Epoch: 41 [401/1000 12832/32000 (40%)] Loss: 0.21993 (QuantReg: 12.77096) QuantErr: 12.77096 batch_time=0.35907 
Train Epoch: 41 [406/1000 12992/32000 (41%)] Loss: 0.17413 (QuantReg: 12.98396) QuantErr: 12.98396 batch_time=0.37408 
Train Epoch: 41 [411/1000 13152/32000 (41%)] Loss: 0.22763 (QuantReg: 13.48482) QuantErr: 13.48482 batch_time=0.36103 
Train Epoch: 41 [416/1000 13312/32000 (42%)] Loss: 0.38405 (QuantReg: 12.77525) QuantErr: 12.77525 batch_time=0.38472 
Train Epoch: 41 [421/1000 13472/32000 (42%)] Loss: 0.40234 (QuantReg: 12.25951) QuantErr: 12.25951 batch_time=0.41115 
Train Epoch: 41 [426/1000 13632/32000 (43%)] Loss: 0.65323 (QuantReg: 12.39218) QuantErr: 12.39218 batch_time=0.39672 
Train Epoch: 41 [431/1000 13792/32000 (43%)] Loss: 0.50074 (QuantReg: 13.03617) QuantErr: 13.03617 batch_time=0.35858 
Train Epoch: 41 [436/1000 13952/32000 (44%)] Loss: 0.06665 (QuantReg: 13.19905) QuantErr: 13.19905 batch_time=0.39064 
Train Epoch: 41 [441/1000 14112/32000 (44%)] Loss: 0.22486 (QuantReg: 13.04779) QuantErr: 13.04779 batch_time=0.35977 
Train Epoch: 41 [446/1000 14272/32000 (45%)] Loss: 0.22716 (QuantReg: 12.79211) QuantErr: 12.79211 batch_time=0.35612 
Train Epoch: 41 [451/1000 14432/32000 (45%)] Loss: 0.20441 (QuantReg: 12.52116) QuantErr: 12.52116 batch_time=1.26436 
Train Epoch: 41 [456/1000 14592/32000 (46%)] Loss: 0.31274 (QuantReg: 12.93265) QuantErr: 12.93265 batch_time=0.75377 
Train Epoch: 41 [461/1000 14752/32000 (46%)] Loss: 0.42328 (QuantReg: 13.41455) QuantErr: 13.41455 batch_time=0.35370 
Train Epoch: 41 [466/1000 14912/32000 (47%)] Loss: 0.35716 (QuantReg: 13.14875) QuantErr: 13.14875 batch_time=0.35225 
Train Epoch: 41 [471/1000 15072/32000 (47%)] Loss: 0.35957 (QuantReg: 12.96078) QuantErr: 12.96078 batch_time=0.39494 
Train Epoch: 41 [476/1000 15232/32000 (48%)] Loss: 0.23678 (QuantReg: 12.90597) QuantErr: 12.90597 batch_time=0.75324 
Train Epoch: 41 [481/1000 15392/32000 (48%)] Loss: 0.39192 (QuantReg: 12.92135) QuantErr: 12.92135 batch_time=0.37621 
Train Epoch: 41 [486/1000 15552/32000 (49%)] Loss: 0.15580 (QuantReg: 12.82757) QuantErr: 12.82757 batch_time=0.34919 
Train Epoch: 41 [491/1000 15712/32000 (49%)] Loss: 0.33975 (QuantReg: 12.95269) QuantErr: 12.95269 batch_time=0.34911 
Train Epoch: 41 [496/1000 15872/32000 (50%)] Loss: 0.15250 (QuantReg: 12.63398) QuantErr: 12.63398 batch_time=0.41223 
Train Epoch: 41 [501/1000 16032/32000 (50%)] Loss: 0.24718 (QuantReg: 13.18790) QuantErr: 13.18790 batch_time=0.34628 
Train Epoch: 41 [506/1000 16192/32000 (51%)] Loss: 0.15134 (QuantReg: 13.31437) QuantErr: 13.31437 batch_time=0.35788 
Train Epoch: 41 [511/1000 16352/32000 (51%)] Loss: 0.24216 (QuantReg: 13.00623) QuantErr: 13.00623 batch_time=0.34521 
Train Epoch: 41 [516/1000 16512/32000 (52%)] Loss: 0.32351 (QuantReg: 12.98580) QuantErr: 12.98580 batch_time=0.38339 
Train Epoch: 41 [521/1000 16672/32000 (52%)] Loss: 0.16878 (QuantReg: 13.36818) QuantErr: 13.36818 batch_time=0.35918 
Train Epoch: 41 [526/1000 16832/32000 (53%)] Loss: 0.19670 (QuantReg: 13.25403) QuantErr: 13.25403 batch_time=0.42409 
Train Epoch: 41 [531/1000 16992/32000 (53%)] Loss: 0.17070 (QuantReg: 13.23427) QuantErr: 13.23427 batch_time=0.38053 
Train Epoch: 41 [536/1000 17152/32000 (54%)] Loss: 0.13040 (QuantReg: 12.87487) QuantErr: 12.87487 batch_time=0.38309 
Train Epoch: 41 [541/1000 17312/32000 (54%)] Loss: 0.26733 (QuantReg: 13.23886) QuantErr: 13.23886 batch_time=0.36667 
Train Epoch: 41 [546/1000 17472/32000 (55%)] Loss: 0.57818 (QuantReg: 12.35865) QuantErr: 12.35865 batch_time=0.39650 
Train Epoch: 41 [551/1000 17632/32000 (55%)] Loss: 0.26417 (QuantReg: 13.20518) QuantErr: 13.20518 batch_time=0.39885 
Train Epoch: 41 [556/1000 17792/32000 (56%)] Loss: 0.26442 (QuantReg: 12.76088) QuantErr: 12.76088 batch_time=0.36016 
Train Epoch: 41 [561/1000 17952/32000 (56%)] Loss: 0.26616 (QuantReg: 13.44866) QuantErr: 13.44866 batch_time=0.42760 
Train Epoch: 41 [566/1000 18112/32000 (57%)] Loss: 0.30653 (QuantReg: 12.58415) QuantErr: 12.58415 batch_time=0.39997 
Train Epoch: 41 [571/1000 18272/32000 (57%)] Loss: 0.27080 (QuantReg: 12.84046) QuantErr: 12.84046 batch_time=0.44129 
Train Epoch: 41 [576/1000 18432/32000 (58%)] Loss: 0.29762 (QuantReg: 13.00538) QuantErr: 13.00538 batch_time=0.36861 
Train Epoch: 41 [581/1000 18592/32000 (58%)] Loss: 0.52526 (QuantReg: 12.78623) QuantErr: 12.78623 batch_time=0.35475 
Train Epoch: 41 [586/1000 18752/32000 (59%)] Loss: 0.09071 (QuantReg: 13.38949) QuantErr: 13.38949 batch_time=0.37554 
Train Epoch: 41 [591/1000 18912/32000 (59%)] Loss: 0.29535 (QuantReg: 12.71325) QuantErr: 12.71325 batch_time=0.38000 
Train Epoch: 41 [596/1000 19072/32000 (60%)] Loss: 0.50474 (QuantReg: 13.14821) QuantErr: 13.14821 batch_time=0.34954 
Train Epoch: 41 [601/1000 19232/32000 (60%)] Loss: 0.16034 (QuantReg: 12.81326) QuantErr: 12.81326 batch_time=0.35111 
Train Epoch: 41 [606/1000 19392/32000 (61%)] Loss: 0.44004 (QuantReg: 12.72496) QuantErr: 12.72496 batch_time=0.34552 
Train Epoch: 41 [611/1000 19552/32000 (61%)] Loss: 0.52745 (QuantReg: 12.18876) QuantErr: 12.18876 batch_time=0.35412 
Train Epoch: 41 [616/1000 19712/32000 (62%)] Loss: 0.19314 (QuantReg: 13.29502) QuantErr: 13.29502 batch_time=0.35611 
Train Epoch: 41 [621/1000 19872/32000 (62%)] Loss: 0.41507 (QuantReg: 12.55052) QuantErr: 12.55052 batch_time=0.35449 
Train Epoch: 41 [626/1000 20032/32000 (63%)] Loss: 0.10794 (QuantReg: 12.48650) QuantErr: 12.48650 batch_time=0.35176 
Train Epoch: 41 [631/1000 20192/32000 (63%)] Loss: 0.17899 (QuantReg: 13.48515) QuantErr: 13.48515 batch_time=0.35173 
Train Epoch: 41 [636/1000 20352/32000 (64%)] Loss: 0.36025 (QuantReg: 12.47149) QuantErr: 12.47149 batch_time=0.34974 
Train Epoch: 41 [641/1000 20512/32000 (64%)] Loss: 0.33351 (QuantReg: 12.61679) QuantErr: 12.61679 batch_time=0.35667 
Train Epoch: 41 [646/1000 20672/32000 (65%)] Loss: 0.27593 (QuantReg: 12.73579) QuantErr: 12.73579 batch_time=0.34664 
Train Epoch: 41 [651/1000 20832/32000 (65%)] Loss: 0.38404 (QuantReg: 13.54754) QuantErr: 13.54754 batch_time=0.34727 
Train Epoch: 41 [656/1000 20992/32000 (66%)] Loss: 0.72052 (QuantReg: 12.53361) QuantErr: 12.53361 batch_time=0.34576 
Train Epoch: 41 [661/1000 21152/32000 (66%)] Loss: 0.25434 (QuantReg: 12.93019) QuantErr: 12.93019 batch_time=0.34590 
Train Epoch: 41 [666/1000 21312/32000 (67%)] Loss: 0.48686 (QuantReg: 12.97201) QuantErr: 12.97201 batch_time=0.38037 
Train Epoch: 41 [671/1000 21472/32000 (67%)] Loss: 0.12491 (QuantReg: 13.50091) QuantErr: 13.50091 batch_time=0.41973 
Train Epoch: 41 [676/1000 21632/32000 (68%)] Loss: 0.37377 (QuantReg: 12.67579) QuantErr: 12.67579 batch_time=0.41593 
Train Epoch: 41 [681/1000 21792/32000 (68%)] Loss: 0.36320 (QuantReg: 12.25002) QuantErr: 12.25002 batch_time=0.41492 
Train Epoch: 41 [686/1000 21952/32000 (69%)] Loss: 0.33703 (QuantReg: 12.73611) QuantErr: 12.73611 batch_time=0.36116 
Train Epoch: 41 [691/1000 22112/32000 (69%)] Loss: 0.30494 (QuantReg: 13.17310) QuantErr: 13.17310 batch_time=0.36719 
Train Epoch: 41 [696/1000 22272/32000 (70%)] Loss: 0.20523 (QuantReg: 13.44466) QuantErr: 13.44466 batch_time=0.36793 
Train Epoch: 41 [701/1000 22432/32000 (70%)] Loss: 0.25797 (QuantReg: 12.59286) QuantErr: 12.59286 batch_time=0.34701 
Train Epoch: 41 [706/1000 22592/32000 (71%)] Loss: 0.31012 (QuantReg: 12.77980) QuantErr: 12.77980 batch_time=0.35180 
Train Epoch: 41 [711/1000 22752/32000 (71%)] Loss: 0.29096 (QuantReg: 12.96648) QuantErr: 12.96648 batch_time=0.35238 
Train Epoch: 41 [716/1000 22912/32000 (72%)] Loss: 0.14489 (QuantReg: 13.20049) QuantErr: 13.20049 batch_time=0.46205 
Train Epoch: 41 [721/1000 23072/32000 (72%)] Loss: 0.12062 (QuantReg: 13.02474) QuantErr: 13.02474 batch_time=0.35682 
Train Epoch: 41 [726/1000 23232/32000 (73%)] Loss: 0.21202 (QuantReg: 13.15415) QuantErr: 13.15415 batch_time=0.37171 
Train Epoch: 41 [731/1000 23392/32000 (73%)] Loss: 0.23381 (QuantReg: 12.66449) QuantErr: 12.66449 batch_time=0.40234 
Train Epoch: 41 [736/1000 23552/32000 (74%)] Loss: 0.47404 (QuantReg: 12.68677) QuantErr: 12.68677 batch_time=0.35719 
Train Epoch: 41 [741/1000 23712/32000 (74%)] Loss: 0.45604 (QuantReg: 12.66892) QuantErr: 12.66892 batch_time=0.35034 
Train Epoch: 41 [746/1000 23872/32000 (75%)] Loss: 0.27259 (QuantReg: 12.64889) QuantErr: 12.64889 batch_time=0.36898 
Train Epoch: 41 [751/1000 24032/32000 (75%)] Loss: 0.32904 (QuantReg: 12.58100) QuantErr: 12.58100 batch_time=0.35980 
Train Epoch: 41 [756/1000 24192/32000 (76%)] Loss: 0.38392 (QuantReg: 12.73191) QuantErr: 12.73191 batch_time=0.35611 
Train Epoch: 41 [761/1000 24352/32000 (76%)] Loss: 0.27519 (QuantReg: 12.71220) QuantErr: 12.71220 batch_time=0.36748 
Train Epoch: 41 [766/1000 24512/32000 (77%)] Loss: 0.23670 (QuantReg: 13.47112) QuantErr: 13.47112 batch_time=0.36158 
Train Epoch: 41 [771/1000 24672/32000 (77%)] Loss: 0.29744 (QuantReg: 13.45428) QuantErr: 13.45428 batch_time=1.33015 
Train Epoch: 41 [776/1000 24832/32000 (78%)] Loss: 0.37916 (QuantReg: 12.85248) QuantErr: 12.85248 batch_time=0.78136 
Train Epoch: 41 [781/1000 24992/32000 (78%)] Loss: 0.29885 (QuantReg: 13.30949) QuantErr: 13.30949 batch_time=0.35120 
Train Epoch: 41 [786/1000 25152/32000 (79%)] Loss: 0.15180 (QuantReg: 13.00957) QuantErr: 13.00957 batch_time=0.37166 
Train Epoch: 41 [791/1000 25312/32000 (79%)] Loss: 0.27343 (QuantReg: 12.51291) QuantErr: 12.51291 batch_time=0.35272 
Train Epoch: 41 [796/1000 25472/32000 (80%)] Loss: 0.14199 (QuantReg: 13.24657) QuantErr: 13.24657 batch_time=0.66243 
Train Epoch: 41 [801/1000 25632/32000 (80%)] Loss: 0.38394 (QuantReg: 12.24522) QuantErr: 12.24522 batch_time=0.37070 
Train Epoch: 41 [806/1000 25792/32000 (81%)] Loss: 0.30496 (QuantReg: 12.57217) QuantErr: 12.57217 batch_time=0.34655 
Train Epoch: 41 [811/1000 25952/32000 (81%)] Loss: 0.34205 (QuantReg: 13.08198) QuantErr: 13.08198 batch_time=0.34577 
Train Epoch: 41 [816/1000 26112/32000 (82%)] Loss: 0.16003 (QuantReg: 13.43949) QuantErr: 13.43949 batch_time=0.36412 
Train Epoch: 41 [821/1000 26272/32000 (82%)] Loss: 0.59851 (QuantReg: 13.19627) QuantErr: 13.19627 batch_time=0.36029 
Train Epoch: 41 [826/1000 26432/32000 (83%)] Loss: 0.26422 (QuantReg: 13.11482) QuantErr: 13.11482 batch_time=0.35521 
Train Epoch: 41 [831/1000 26592/32000 (83%)] Loss: 0.34709 (QuantReg: 13.26278) QuantErr: 13.26278 batch_time=0.40291 
Train Epoch: 41 [836/1000 26752/32000 (84%)] Loss: 0.12479 (QuantReg: 13.10898) QuantErr: 13.10898 batch_time=0.38585 
Train Epoch: 41 [841/1000 26912/32000 (84%)] Loss: 0.20668 (QuantReg: 13.36945) QuantErr: 13.36945 batch_time=0.36646 
Train Epoch: 41 [846/1000 27072/32000 (85%)] Loss: 0.28724 (QuantReg: 13.05589) QuantErr: 13.05589 batch_time=0.41599 
Train Epoch: 41 [851/1000 27232/32000 (85%)] Loss: 0.35328 (QuantReg: 12.77975) QuantErr: 12.77975 batch_time=0.34714 
Train Epoch: 41 [856/1000 27392/32000 (86%)] Loss: 0.23847 (QuantReg: 13.03412) QuantErr: 13.03412 batch_time=0.35211 
Train Epoch: 41 [861/1000 27552/32000 (86%)] Loss: 0.11113 (QuantReg: 12.90208) QuantErr: 12.90208 batch_time=0.35157 
Train Epoch: 41 [866/1000 27712/32000 (87%)] Loss: 0.08981 (QuantReg: 13.60924) QuantErr: 13.60924 batch_time=0.35390 
Train Epoch: 41 [871/1000 27872/32000 (87%)] Loss: 0.20968 (QuantReg: 12.05507) QuantErr: 12.05507 batch_time=0.36003 
Train Epoch: 41 [876/1000 28032/32000 (88%)] Loss: 0.36510 (QuantReg: 13.00984) QuantErr: 13.00984 batch_time=0.38002 
Train Epoch: 41 [881/1000 28192/32000 (88%)] Loss: 0.57842 (QuantReg: 12.68455) QuantErr: 12.68455 batch_time=0.39522 
Train Epoch: 41 [886/1000 28352/32000 (89%)] Loss: 0.32285 (QuantReg: 12.98007) QuantErr: 12.98007 batch_time=0.39741 
Train Epoch: 41 [891/1000 28512/32000 (89%)] Loss: 0.13043 (QuantReg: 12.95688) QuantErr: 12.95688 batch_time=0.45227 
Train Epoch: 41 [896/1000 28672/32000 (90%)] Loss: 0.23745 (QuantReg: 12.72501) QuantErr: 12.72501 batch_time=0.38425 
Train Epoch: 41 [901/1000 28832/32000 (90%)] Loss: 0.29072 (QuantReg: 13.27350) QuantErr: 13.27350 batch_time=0.38971 
Train Epoch: 41 [906/1000 28992/32000 (91%)] Loss: 0.21229 (QuantReg: 12.64013) QuantErr: 12.64013 batch_time=0.37694 
Train Epoch: 41 [911/1000 29152/32000 (91%)] Loss: 0.27423 (QuantReg: 12.85879) QuantErr: 12.85879 batch_time=0.40153 
Train Epoch: 41 [916/1000 29312/32000 (92%)] Loss: 0.21344 (QuantReg: 12.65769) QuantErr: 12.65769 batch_time=0.39286 
Train Epoch: 41 [921/1000 29472/32000 (92%)] Loss: 0.33152 (QuantReg: 12.83831) QuantErr: 12.83831 batch_time=0.36742 
Train Epoch: 41 [926/1000 29632/32000 (93%)] Loss: 0.18903 (QuantReg: 13.02298) QuantErr: 13.02298 batch_time=0.36960 
Train Epoch: 41 [931/1000 29792/32000 (93%)] Loss: 0.27886 (QuantReg: 12.96026) QuantErr: 12.96026 batch_time=0.36802 
Train Epoch: 41 [936/1000 29952/32000 (94%)] Loss: 0.12871 (QuantReg: 13.19755) QuantErr: 13.19755 batch_time=0.35718 
Train Epoch: 41 [941/1000 30112/32000 (94%)] Loss: 0.29529 (QuantReg: 12.73090) QuantErr: 12.73090 batch_time=0.40010 
Train Epoch: 41 [946/1000 30272/32000 (95%)] Loss: 0.11806 (QuantReg: 13.41877) QuantErr: 13.41877 batch_time=0.40638 
Train Epoch: 41 [951/1000 30432/32000 (95%)] Loss: 0.70605 (QuantReg: 13.17963) QuantErr: 13.17963 batch_time=0.36601 
Train Epoch: 41 [956/1000 30592/32000 (96%)] Loss: 0.24491 (QuantReg: 12.95041) QuantErr: 12.95041 batch_time=0.35434 
Train Epoch: 41 [961/1000 30752/32000 (96%)] Loss: 0.23367 (QuantReg: 13.13306) QuantErr: 13.13306 batch_time=0.38089 
Train Epoch: 41 [966/1000 30912/32000 (97%)] Loss: 0.30344 (QuantReg: 12.65463) QuantErr: 12.65463 batch_time=0.45639 
Train Epoch: 41 [971/1000 31072/32000 (97%)] Loss: 0.29635 (QuantReg: 12.92534) QuantErr: 12.92534 batch_time=0.46465 
Train Epoch: 41 [976/1000 31232/32000 (98%)] Loss: 0.19920 (QuantReg: 12.74856) QuantErr: 12.74856 batch_time=0.40414 
Train Epoch: 41 [981/1000 31392/32000 (98%)] Loss: 0.32668 (QuantReg: 12.45302) QuantErr: 12.45302 batch_time=0.41472 
Train Epoch: 41 [986/1000 31552/32000 (99%)] Loss: 0.21927 (QuantReg: 12.99799) QuantErr: 12.99799 batch_time=0.37375 
Train Epoch: 41 [991/1000 31712/32000 (99%)] Loss: 0.16539 (QuantReg: 12.64979) QuantErr: 12.64979 batch_time=0.37397 
Train Epoch: 41 [996/1000 31872/32000 (100%)] Loss: 0.31447 (QuantReg: 12.81505) QuantErr: 12.81505 batch_time=0.36590 
Train Epoch: 41 codebook_update_time=1.80586
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch41.pth ...
Done in 4.039s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 0.2921210800670087
 quant_reg      : 12.872821823120118
 quant_err      : 12.872821823120118
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 41000
 MSRVTT_full_val/t2v_metrics/R1: 31.99195171026157
 MSRVTT_full_val/t2v_metrics/R5: 70.22132796780684
 MSRVTT_full_val/t2v_metrics/R10: 83.09859154929578
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.909456740442656
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.152400852121666
 MSRVTT_full_val/v2t_metrics/R1: 36.61971830985915
 MSRVTT_full_val/v2t_metrics/R5: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.257545271629779
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.7069338824335
 MSRVTT_full_test/t2v_metrics/R1: 12.876254180602007
 MSRVTT_full_test/t2v_metrics/R5: 37.290969899665555
 MSRVTT_full_test/t2v_metrics/R10: 51.17056856187291
 MSRVTT_full_test/t2v_metrics/R50: 80.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.77090301003344
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.07174859047322
 MSRVTT_full_test/v2t_metrics/R1: 16.8561872909699
 MSRVTT_full_test/v2t_metrics/R5: 43.44481605351171
 MSRVTT_full_test/v2t_metrics/R10: 58.26086956521739
 MSRVTT_full_test/v2t_metrics/R50: 86.42140468227424
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.77040133779264
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.94283126618101
 mnt_best       : 29.290689157230588
 not_improved_count: 2
Train Epoch: 42 [1/1000 32/32000 (0%)] Loss: 0.36047 (QuantReg: 12.79938) QuantErr: 12.79938 batch_time=27.62731 
Train Epoch: 42 [6/1000 192/32000 (1%)] Loss: 0.76577 (QuantReg: 12.64256) QuantErr: 12.64256 batch_time=0.44367 
Train Epoch: 42 [11/1000 352/32000 (1%)] Loss: 0.23331 (QuantReg: 12.94646) QuantErr: 12.94646 batch_time=0.39621 
Train Epoch: 42 [16/1000 512/32000 (2%)] Loss: 0.40626 (QuantReg: 12.68989) QuantErr: 12.68989 batch_time=0.36449 
Train Epoch: 42 [21/1000 672/32000 (2%)] Loss: 0.32469 (QuantReg: 13.23951) QuantErr: 13.23951 batch_time=0.38895 
Train Epoch: 42 [26/1000 832/32000 (3%)] Loss: 0.29445 (QuantReg: 12.62824) QuantErr: 12.62824 batch_time=0.41475 
Train Epoch: 42 [31/1000 992/32000 (3%)] Loss: 0.10773 (QuantReg: 13.09171) QuantErr: 13.09171 batch_time=0.38430 
Train Epoch: 42 [36/1000 1152/32000 (4%)] Loss: 0.20605 (QuantReg: 12.85262) QuantErr: 12.85262 batch_time=0.35593 
Train Epoch: 42 [41/1000 1312/32000 (4%)] Loss: 0.16265 (QuantReg: 12.93825) QuantErr: 12.93825 batch_time=0.37178 
Train Epoch: 42 [46/1000 1472/32000 (5%)] Loss: 0.28626 (QuantReg: 12.63477) QuantErr: 12.63477 batch_time=0.42218 
Train Epoch: 42 [51/1000 1632/32000 (5%)] Loss: 0.32949 (QuantReg: 13.07158) QuantErr: 13.07158 batch_time=0.35992 
Train Epoch: 42 [56/1000 1792/32000 (6%)] Loss: 0.50463 (QuantReg: 12.24371) QuantErr: 12.24371 batch_time=0.40464 
Train Epoch: 42 [61/1000 1952/32000 (6%)] Loss: 0.27462 (QuantReg: 12.29422) QuantErr: 12.29422 batch_time=0.41194 
Train Epoch: 42 [66/1000 2112/32000 (7%)] Loss: 0.18911 (QuantReg: 13.36865) QuantErr: 13.36865 batch_time=0.36153 
Train Epoch: 42 [71/1000 2272/32000 (7%)] Loss: 0.06684 (QuantReg: 13.18359) QuantErr: 13.18359 batch_time=0.35426 
Train Epoch: 42 [76/1000 2432/32000 (8%)] Loss: 0.43914 (QuantReg: 12.78313) QuantErr: 12.78313 batch_time=0.35549 
Train Epoch: 42 [81/1000 2592/32000 (8%)] Loss: 0.25191 (QuantReg: 12.90955) QuantErr: 12.90955 batch_time=0.64390 
Train Epoch: 42 [86/1000 2752/32000 (9%)] Loss: 0.61391 (QuantReg: 12.21703) QuantErr: 12.21703 batch_time=0.36698 
Train Epoch: 42 [91/1000 2912/32000 (9%)] Loss: 0.07335 (QuantReg: 12.68268) QuantErr: 12.68268 batch_time=0.39212 
Train Epoch: 42 [96/1000 3072/32000 (10%)] Loss: 0.65963 (QuantReg: 12.46280) QuantErr: 12.46280 batch_time=0.38024 
Train Epoch: 42 [101/1000 3232/32000 (10%)] Loss: 0.17445 (QuantReg: 13.11683) QuantErr: 13.11683 batch_time=0.55976 
Train Epoch: 42 [106/1000 3392/32000 (11%)] Loss: 0.05773 (QuantReg: 13.26533) QuantErr: 13.26533 batch_time=0.39972 
Train Epoch: 42 [111/1000 3552/32000 (11%)] Loss: 0.24223 (QuantReg: 12.68330) QuantErr: 12.68330 batch_time=0.39321 
Train Epoch: 42 [116/1000 3712/32000 (12%)] Loss: 0.54560 (QuantReg: 12.66689) QuantErr: 12.66689 batch_time=0.45350 
Train Epoch: 42 [121/1000 3872/32000 (12%)] Loss: 0.43266 (QuantReg: 12.73786) QuantErr: 12.73786 batch_time=0.39584 
Train Epoch: 42 [126/1000 4032/32000 (13%)] Loss: 0.54928 (QuantReg: 12.34484) QuantErr: 12.34484 batch_time=0.35865 
Train Epoch: 42 [131/1000 4192/32000 (13%)] Loss: 0.16267 (QuantReg: 12.36146) QuantErr: 12.36146 batch_time=0.38550 
Train Epoch: 42 [136/1000 4352/32000 (14%)] Loss: 0.40026 (QuantReg: 12.78234) QuantErr: 12.78234 batch_time=0.38081 
Train Epoch: 42 [141/1000 4512/32000 (14%)] Loss: 0.45449 (QuantReg: 12.63414) QuantErr: 12.63414 batch_time=0.41408 
Train Epoch: 42 [146/1000 4672/32000 (15%)] Loss: 0.25320 (QuantReg: 12.65652) QuantErr: 12.65652 batch_time=0.36126 
Train Epoch: 42 [151/1000 4832/32000 (15%)] Loss: 0.07506 (QuantReg: 13.13071) QuantErr: 13.13071 batch_time=0.92005 
Train Epoch: 42 [156/1000 4992/32000 (16%)] Loss: 0.41565 (QuantReg: 13.21514) QuantErr: 13.21514 batch_time=0.37121 
Train Epoch: 42 [161/1000 5152/32000 (16%)] Loss: 0.49157 (QuantReg: 12.33645) QuantErr: 12.33645 batch_time=0.36576 
Train Epoch: 42 [166/1000 5312/32000 (17%)] Loss: 0.40318 (QuantReg: 12.40381) QuantErr: 12.40381 batch_time=0.37925 
Train Epoch: 42 [171/1000 5472/32000 (17%)] Loss: 0.23213 (QuantReg: 13.30249) QuantErr: 13.30249 batch_time=0.35097 
Train Epoch: 42 [176/1000 5632/32000 (18%)] Loss: 0.16262 (QuantReg: 12.28847) QuantErr: 12.28847 batch_time=0.35113 
Train Epoch: 42 [181/1000 5792/32000 (18%)] Loss: 0.12890 (QuantReg: 13.37847) QuantErr: 13.37847 batch_time=0.35410 
Train Epoch: 42 [186/1000 5952/32000 (19%)] Loss: 0.21071 (QuantReg: 13.25080) QuantErr: 13.25080 batch_time=0.35873 
Train Epoch: 42 [191/1000 6112/32000 (19%)] Loss: 0.33788 (QuantReg: 12.92662) QuantErr: 12.92662 batch_time=0.35772 
Train Epoch: 42 [196/1000 6272/32000 (20%)] Loss: 0.30724 (QuantReg: 13.18576) QuantErr: 13.18576 batch_time=0.35241 
Train Epoch: 42 [201/1000 6432/32000 (20%)] Loss: 0.19023 (QuantReg: 13.02794) QuantErr: 13.02794 batch_time=0.34895 
Train Epoch: 42 [206/1000 6592/32000 (21%)] Loss: 0.31315 (QuantReg: 13.03629) QuantErr: 13.03629 batch_time=0.37460 
Train Epoch: 42 [211/1000 6752/32000 (21%)] Loss: 0.41428 (QuantReg: 12.38751) QuantErr: 12.38751 batch_time=1.12902 
Train Epoch: 42 [216/1000 6912/32000 (22%)] Loss: 0.46014 (QuantReg: 12.41803) QuantErr: 12.41803 batch_time=0.41394 
Train Epoch: 42 [221/1000 7072/32000 (22%)] Loss: 0.40618 (QuantReg: 12.53471) QuantErr: 12.53471 batch_time=0.39140 
Train Epoch: 42 [226/1000 7232/32000 (23%)] Loss: 0.26038 (QuantReg: 12.29363) QuantErr: 12.29363 batch_time=0.35917 
Train Epoch: 42 [231/1000 7392/32000 (23%)] Loss: 0.31222 (QuantReg: 13.18726) QuantErr: 13.18726 batch_time=0.37153 
Train Epoch: 42 [236/1000 7552/32000 (24%)] Loss: 0.20774 (QuantReg: 13.29569) QuantErr: 13.29569 batch_time=0.40597 
Train Epoch: 42 [241/1000 7712/32000 (24%)] Loss: 0.25368 (QuantReg: 13.23157) QuantErr: 13.23157 batch_time=0.49766 
Train Epoch: 42 [246/1000 7872/32000 (25%)] Loss: 0.47735 (QuantReg: 12.60482) QuantErr: 12.60482 batch_time=0.44012 
Train Epoch: 42 [251/1000 8032/32000 (25%)] Loss: 0.10365 (QuantReg: 12.61612) QuantErr: 12.61612 batch_time=0.37189 
Train Epoch: 42 [256/1000 8192/32000 (26%)] Loss: 0.22234 (QuantReg: 12.64240) QuantErr: 12.64240 batch_time=0.41449 
Train Epoch: 42 [261/1000 8352/32000 (26%)] Loss: 0.38192 (QuantReg: 12.69250) QuantErr: 12.69250 batch_time=0.66498 
Train Epoch: 42 [266/1000 8512/32000 (27%)] Loss: 0.30445 (QuantReg: 13.41229) QuantErr: 13.41229 batch_time=0.36510 
Train Epoch: 42 [271/1000 8672/32000 (27%)] Loss: 0.44824 (QuantReg: 12.83498) QuantErr: 12.83498 batch_time=0.35958 
Train Epoch: 42 [276/1000 8832/32000 (28%)] Loss: 0.23586 (QuantReg: 13.02209) QuantErr: 13.02209 batch_time=0.36665 
Train Epoch: 42 [281/1000 8992/32000 (28%)] Loss: 0.14364 (QuantReg: 13.51297) QuantErr: 13.51297 batch_time=0.36127 
Train Epoch: 42 [286/1000 9152/32000 (29%)] Loss: 0.36054 (QuantReg: 12.93958) QuantErr: 12.93958 batch_time=0.46914 
Train Epoch: 42 [291/1000 9312/32000 (29%)] Loss: 0.15518 (QuantReg: 12.89109) QuantErr: 12.89109 batch_time=0.42022 
Train Epoch: 42 [296/1000 9472/32000 (30%)] Loss: 0.11569 (QuantReg: 13.33564) QuantErr: 13.33564 batch_time=0.39226 
Train Epoch: 42 [301/1000 9632/32000 (30%)] Loss: 0.40599 (QuantReg: 13.27727) QuantErr: 13.27727 batch_time=0.35413 
Train Epoch: 42 [306/1000 9792/32000 (31%)] Loss: 0.34461 (QuantReg: 13.05663) QuantErr: 13.05663 batch_time=0.36960 
Train Epoch: 42 [311/1000 9952/32000 (31%)] Loss: 0.43561 (QuantReg: 12.29016) QuantErr: 12.29016 batch_time=0.35038 
Train Epoch: 42 [316/1000 10112/32000 (32%)] Loss: 0.24175 (QuantReg: 13.30281) QuantErr: 13.30281 batch_time=0.36174 
Train Epoch: 42 [321/1000 10272/32000 (32%)] Loss: 0.34298 (QuantReg: 12.50158) QuantErr: 12.50158 batch_time=0.38978 
Train Epoch: 42 [326/1000 10432/32000 (33%)] Loss: 0.27078 (QuantReg: 12.47897) QuantErr: 12.47897 batch_time=0.35340 
Train Epoch: 42 [331/1000 10592/32000 (33%)] Loss: 0.16332 (QuantReg: 12.88178) QuantErr: 12.88178 batch_time=0.35622 
Train Epoch: 42 [336/1000 10752/32000 (34%)] Loss: 0.38737 (QuantReg: 12.07444) QuantErr: 12.07444 batch_time=0.41780 
Train Epoch: 42 [341/1000 10912/32000 (34%)] Loss: 0.30347 (QuantReg: 12.49272) QuantErr: 12.49272 batch_time=0.38179 
Train Epoch: 42 [346/1000 11072/32000 (35%)] Loss: 0.23472 (QuantReg: 13.46537) QuantErr: 13.46537 batch_time=0.35929 
Train Epoch: 42 [351/1000 11232/32000 (35%)] Loss: 0.25590 (QuantReg: 12.64959) QuantErr: 12.64959 batch_time=0.36060 
Train Epoch: 42 [356/1000 11392/32000 (36%)] Loss: 0.30259 (QuantReg: 12.21928) QuantErr: 12.21928 batch_time=0.37110 
Train Epoch: 42 [361/1000 11552/32000 (36%)] Loss: 0.17985 (QuantReg: 12.78942) QuantErr: 12.78942 batch_time=0.41901 
Train Epoch: 42 [366/1000 11712/32000 (37%)] Loss: 0.28732 (QuantReg: 12.04374) QuantErr: 12.04374 batch_time=0.43477 
Train Epoch: 42 [371/1000 11872/32000 (37%)] Loss: 0.10698 (QuantReg: 12.93266) QuantErr: 12.93266 batch_time=0.35966 
Train Epoch: 42 [376/1000 12032/32000 (38%)] Loss: 0.36149 (QuantReg: 13.19493) QuantErr: 13.19493 batch_time=0.37689 
Train Epoch: 42 [381/1000 12192/32000 (38%)] Loss: 0.10948 (QuantReg: 13.37379) QuantErr: 13.37379 batch_time=0.40484 
Train Epoch: 42 [386/1000 12352/32000 (39%)] Loss: 0.39649 (QuantReg: 12.31020) QuantErr: 12.31020 batch_time=0.36457 
Train Epoch: 42 [391/1000 12512/32000 (39%)] Loss: 0.41046 (QuantReg: 12.70352) QuantErr: 12.70352 batch_time=0.35355 
Train Epoch: 42 [396/1000 12672/32000 (40%)] Loss: 0.19182 (QuantReg: 12.96971) QuantErr: 12.96971 batch_time=0.35065 
Train Epoch: 42 [401/1000 12832/32000 (40%)] Loss: 0.30626 (QuantReg: 12.51948) QuantErr: 12.51948 batch_time=0.62479 
Train Epoch: 42 [406/1000 12992/32000 (41%)] Loss: 0.18430 (QuantReg: 13.35178) QuantErr: 13.35178 batch_time=0.36530 
Train Epoch: 42 [411/1000 13152/32000 (41%)] Loss: 0.31646 (QuantReg: 12.53034) QuantErr: 12.53034 batch_time=0.37603 
Train Epoch: 42 [416/1000 13312/32000 (42%)] Loss: 0.36210 (QuantReg: 12.68041) QuantErr: 12.68041 batch_time=0.40899 
Train Epoch: 42 [421/1000 13472/32000 (42%)] Loss: 0.16279 (QuantReg: 13.24202) QuantErr: 13.24202 batch_time=0.53916 
Train Epoch: 42 [426/1000 13632/32000 (43%)] Loss: 0.46201 (QuantReg: 13.07612) QuantErr: 13.07612 batch_time=0.45472 
Train Epoch: 42 [431/1000 13792/32000 (43%)] Loss: 0.51040 (QuantReg: 12.59301) QuantErr: 12.59301 batch_time=0.37045 
Train Epoch: 42 [436/1000 13952/32000 (44%)] Loss: 0.21614 (QuantReg: 12.78796) QuantErr: 12.78796 batch_time=0.53565 
Train Epoch: 42 [441/1000 14112/32000 (44%)] Loss: 0.43236 (QuantReg: 13.45407) QuantErr: 13.45407 batch_time=0.37278 
Train Epoch: 42 [446/1000 14272/32000 (45%)] Loss: 0.23404 (QuantReg: 12.94334) QuantErr: 12.94334 batch_time=0.37569 
Train Epoch: 42 [451/1000 14432/32000 (45%)] Loss: 0.15902 (QuantReg: 12.88352) QuantErr: 12.88352 batch_time=0.35243 
Train Epoch: 42 [456/1000 14592/32000 (46%)] Loss: 0.14968 (QuantReg: 13.23121) QuantErr: 13.23121 batch_time=0.37460 
Train Epoch: 42 [461/1000 14752/32000 (46%)] Loss: 0.28872 (QuantReg: 12.75539) QuantErr: 12.75539 batch_time=0.35300 
Train Epoch: 42 [466/1000 14912/32000 (47%)] Loss: 0.44566 (QuantReg: 12.64807) QuantErr: 12.64807 batch_time=0.36278 
Train Epoch: 42 [471/1000 15072/32000 (47%)] Loss: 0.32403 (QuantReg: 12.81532) QuantErr: 12.81532 batch_time=0.82248 
Train Epoch: 42 [476/1000 15232/32000 (48%)] Loss: 0.31034 (QuantReg: 13.03558) QuantErr: 13.03558 batch_time=0.35381 
Train Epoch: 42 [481/1000 15392/32000 (48%)] Loss: 0.28630 (QuantReg: 12.40420) QuantErr: 12.40420 batch_time=0.34722 
Train Epoch: 42 [486/1000 15552/32000 (49%)] Loss: 0.52483 (QuantReg: 12.85260) QuantErr: 12.85260 batch_time=0.37411 
Train Epoch: 42 [491/1000 15712/32000 (49%)] Loss: 0.35545 (QuantReg: 12.92286) QuantErr: 12.92286 batch_time=0.41050 
Train Epoch: 42 [496/1000 15872/32000 (50%)] Loss: 0.52844 (QuantReg: 12.78718) QuantErr: 12.78718 batch_time=0.36594 
Train Epoch: 42 [501/1000 16032/32000 (50%)] Loss: 0.48016 (QuantReg: 12.81546) QuantErr: 12.81546 batch_time=0.37960 
Train Epoch: 42 [506/1000 16192/32000 (51%)] Loss: 0.18456 (QuantReg: 12.59707) QuantErr: 12.59707 batch_time=0.37095 
Train Epoch: 42 [511/1000 16352/32000 (51%)] Loss: 0.39304 (QuantReg: 12.38618) QuantErr: 12.38618 batch_time=0.35843 
Train Epoch: 42 [516/1000 16512/32000 (52%)] Loss: 0.09059 (QuantReg: 13.03642) QuantErr: 13.03642 batch_time=0.35242 
Train Epoch: 42 [521/1000 16672/32000 (52%)] Loss: 0.44802 (QuantReg: 13.32062) QuantErr: 13.32062 batch_time=0.37386 
Train Epoch: 42 [526/1000 16832/32000 (53%)] Loss: 0.33370 (QuantReg: 12.55335) QuantErr: 12.55335 batch_time=0.35797 
Train Epoch: 42 [531/1000 16992/32000 (53%)] Loss: 0.06073 (QuantReg: 12.76693) QuantErr: 12.76693 batch_time=1.04174 
Train Epoch: 42 [536/1000 17152/32000 (54%)] Loss: 0.19865 (QuantReg: 12.54470) QuantErr: 12.54470 batch_time=0.47138 
Train Epoch: 42 [541/1000 17312/32000 (54%)] Loss: 0.26788 (QuantReg: 13.02684) QuantErr: 13.02684 batch_time=0.38226 
Train Epoch: 42 [546/1000 17472/32000 (55%)] Loss: 0.19854 (QuantReg: 12.81887) QuantErr: 12.81887 batch_time=0.37546 
Train Epoch: 42 [551/1000 17632/32000 (55%)] Loss: 0.26299 (QuantReg: 12.63107) QuantErr: 12.63107 batch_time=0.43703 
Train Epoch: 42 [556/1000 17792/32000 (56%)] Loss: 0.16070 (QuantReg: 12.86733) QuantErr: 12.86733 batch_time=0.36278 
Train Epoch: 42 [561/1000 17952/32000 (56%)] Loss: 0.23868 (QuantReg: 12.29176) QuantErr: 12.29176 batch_time=0.39815 
Train Epoch: 42 [566/1000 18112/32000 (57%)] Loss: 0.36086 (QuantReg: 12.36080) QuantErr: 12.36080 batch_time=0.35518 
Train Epoch: 42 [571/1000 18272/32000 (57%)] Loss: 0.14832 (QuantReg: 12.79333) QuantErr: 12.79333 batch_time=0.35638 
Train Epoch: 42 [576/1000 18432/32000 (58%)] Loss: 0.35255 (QuantReg: 12.74475) QuantErr: 12.74475 batch_time=0.41581 
Train Epoch: 42 [581/1000 18592/32000 (58%)] Loss: 0.23591 (QuantReg: 12.68343) QuantErr: 12.68343 batch_time=0.58068 
Train Epoch: 42 [586/1000 18752/32000 (59%)] Loss: 0.43141 (QuantReg: 12.99726) QuantErr: 12.99726 batch_time=0.36333 
Train Epoch: 42 [591/1000 18912/32000 (59%)] Loss: 0.42821 (QuantReg: 13.27031) QuantErr: 13.27031 batch_time=0.35697 
Train Epoch: 42 [596/1000 19072/32000 (60%)] Loss: 0.14847 (QuantReg: 12.84919) QuantErr: 12.84919 batch_time=0.37452 
Train Epoch: 42 [601/1000 19232/32000 (60%)] Loss: 0.24421 (QuantReg: 13.00000) QuantErr: 13.00000 batch_time=0.35190 
Train Epoch: 42 [606/1000 19392/32000 (61%)] Loss: 0.32933 (QuantReg: 12.53860) QuantErr: 12.53860 batch_time=0.35429 
Train Epoch: 42 [611/1000 19552/32000 (61%)] Loss: 0.24726 (QuantReg: 12.58995) QuantErr: 12.58995 batch_time=0.35607 
Train Epoch: 42 [616/1000 19712/32000 (62%)] Loss: 0.20417 (QuantReg: 12.95336) QuantErr: 12.95336 batch_time=0.35283 
Train Epoch: 42 [621/1000 19872/32000 (62%)] Loss: 0.30300 (QuantReg: 12.71059) QuantErr: 12.71059 batch_time=0.41618 
Train Epoch: 42 [626/1000 20032/32000 (63%)] Loss: 0.11467 (QuantReg: 13.07641) QuantErr: 13.07641 batch_time=0.35835 
Train Epoch: 42 [631/1000 20192/32000 (63%)] Loss: 0.17573 (QuantReg: 12.26856) QuantErr: 12.26856 batch_time=0.37682 
Train Epoch: 42 [636/1000 20352/32000 (64%)] Loss: 0.25986 (QuantReg: 13.09518) QuantErr: 13.09518 batch_time=0.35445 
Train Epoch: 42 [641/1000 20512/32000 (64%)] Loss: 0.43915 (QuantReg: 13.19460) QuantErr: 13.19460 batch_time=0.40616 
Train Epoch: 42 [646/1000 20672/32000 (65%)] Loss: 0.37061 (QuantReg: 12.27980) QuantErr: 12.27980 batch_time=0.36929 
Train Epoch: 42 [651/1000 20832/32000 (65%)] Loss: 0.28055 (QuantReg: 12.92810) QuantErr: 12.92810 batch_time=0.37564 
Train Epoch: 42 [656/1000 20992/32000 (66%)] Loss: 0.44439 (QuantReg: 12.67860) QuantErr: 12.67860 batch_time=0.35562 
Train Epoch: 42 [661/1000 21152/32000 (66%)] Loss: 0.29810 (QuantReg: 13.01918) QuantErr: 13.01918 batch_time=0.34924 
Train Epoch: 42 [666/1000 21312/32000 (67%)] Loss: 0.12404 (QuantReg: 12.67280) QuantErr: 12.67280 batch_time=0.64750 
Train Epoch: 42 [671/1000 21472/32000 (67%)] Loss: 0.31216 (QuantReg: 12.99983) QuantErr: 12.99983 batch_time=0.35456 
Train Epoch: 42 [676/1000 21632/32000 (68%)] Loss: 0.28324 (QuantReg: 12.54329) QuantErr: 12.54329 batch_time=0.35493 
Train Epoch: 42 [681/1000 21792/32000 (68%)] Loss: 0.24231 (QuantReg: 12.80953) QuantErr: 12.80953 batch_time=0.37502 
Train Epoch: 42 [686/1000 21952/32000 (69%)] Loss: 0.09058 (QuantReg: 13.04197) QuantErr: 13.04197 batch_time=0.35217 
Train Epoch: 42 [691/1000 22112/32000 (69%)] Loss: 0.24635 (QuantReg: 13.48399) QuantErr: 13.48399 batch_time=0.34536 
Train Epoch: 42 [696/1000 22272/32000 (70%)] Loss: 0.30778 (QuantReg: 13.19369) QuantErr: 13.19369 batch_time=0.34603 
Train Epoch: 42 [701/1000 22432/32000 (70%)] Loss: 0.24268 (QuantReg: 12.87629) QuantErr: 12.87629 batch_time=0.34725 
Train Epoch: 42 [706/1000 22592/32000 (71%)] Loss: 0.33496 (QuantReg: 12.83707) QuantErr: 12.83707 batch_time=0.37731 
Train Epoch: 42 [711/1000 22752/32000 (71%)] Loss: 0.38742 (QuantReg: 12.64429) QuantErr: 12.64429 batch_time=0.38099 
Train Epoch: 42 [716/1000 22912/32000 (72%)] Loss: 0.48626 (QuantReg: 12.84891) QuantErr: 12.84891 batch_time=0.36366 
Train Epoch: 42 [721/1000 23072/32000 (72%)] Loss: 0.29305 (QuantReg: 13.35347) QuantErr: 13.35347 batch_time=0.61873 
Train Epoch: 42 [726/1000 23232/32000 (73%)] Loss: 0.28102 (QuantReg: 13.00763) QuantErr: 13.00763 batch_time=0.38696 
Train Epoch: 42 [731/1000 23392/32000 (73%)] Loss: 0.19708 (QuantReg: 13.12354) QuantErr: 13.12354 batch_time=0.39789 
Train Epoch: 42 [736/1000 23552/32000 (74%)] Loss: 0.10969 (QuantReg: 13.51100) QuantErr: 13.51100 batch_time=0.35036 
Train Epoch: 42 [741/1000 23712/32000 (74%)] Loss: 0.25572 (QuantReg: 13.21036) QuantErr: 13.21036 batch_time=0.48884 
Train Epoch: 42 [746/1000 23872/32000 (75%)] Loss: 0.20493 (QuantReg: 13.03657) QuantErr: 13.03657 batch_time=0.35498 
Train Epoch: 42 [751/1000 24032/32000 (75%)] Loss: 0.42978 (QuantReg: 13.14684) QuantErr: 13.14684 batch_time=0.35070 
Train Epoch: 42 [756/1000 24192/32000 (76%)] Loss: 0.16478 (QuantReg: 12.67804) QuantErr: 12.67804 batch_time=0.37776 
Train Epoch: 42 [761/1000 24352/32000 (76%)] Loss: 0.28208 (QuantReg: 12.95972) QuantErr: 12.95972 batch_time=0.36182 
Train Epoch: 42 [766/1000 24512/32000 (77%)] Loss: 0.34887 (QuantReg: 13.66920) QuantErr: 13.66920 batch_time=0.37828 
Train Epoch: 42 [771/1000 24672/32000 (77%)] Loss: 0.15110 (QuantReg: 12.55886) QuantErr: 12.55886 batch_time=0.35866 
Train Epoch: 42 [776/1000 24832/32000 (78%)] Loss: 0.31165 (QuantReg: 13.04251) QuantErr: 13.04251 batch_time=0.36652 
Train Epoch: 42 [781/1000 24992/32000 (78%)] Loss: 0.39166 (QuantReg: 13.18247) QuantErr: 13.18247 batch_time=0.39914 
Train Epoch: 42 [786/1000 25152/32000 (79%)] Loss: 0.31256 (QuantReg: 12.19232) QuantErr: 12.19232 batch_time=0.36187 
Train Epoch: 42 [791/1000 25312/32000 (79%)] Loss: 0.10813 (QuantReg: 13.17600) QuantErr: 13.17600 batch_time=0.83430 
Train Epoch: 42 [796/1000 25472/32000 (80%)] Loss: 0.55227 (QuantReg: 12.87385) QuantErr: 12.87385 batch_time=0.35778 
Train Epoch: 42 [801/1000 25632/32000 (80%)] Loss: 0.28482 (QuantReg: 13.37892) QuantErr: 13.37892 batch_time=0.35727 
Train Epoch: 42 [806/1000 25792/32000 (81%)] Loss: 0.27291 (QuantReg: 12.98942) QuantErr: 12.98942 batch_time=0.36450 
Train Epoch: 42 [811/1000 25952/32000 (81%)] Loss: 0.17442 (QuantReg: 13.84925) QuantErr: 13.84925 batch_time=0.36693 
Train Epoch: 42 [816/1000 26112/32000 (82%)] Loss: 0.21690 (QuantReg: 12.61328) QuantErr: 12.61328 batch_time=0.34918 
Train Epoch: 42 [821/1000 26272/32000 (82%)] Loss: 0.12733 (QuantReg: 12.96932) QuantErr: 12.96932 batch_time=0.36723 
Train Epoch: 42 [826/1000 26432/32000 (83%)] Loss: 0.31534 (QuantReg: 12.93408) QuantErr: 12.93408 batch_time=0.35252 
Train Epoch: 42 [831/1000 26592/32000 (83%)] Loss: 0.39247 (QuantReg: 13.10965) QuantErr: 13.10965 batch_time=0.34911 
Train Epoch: 42 [836/1000 26752/32000 (84%)] Loss: 0.28901 (QuantReg: 12.90611) QuantErr: 12.90611 batch_time=0.35054 
Train Epoch: 42 [841/1000 26912/32000 (84%)] Loss: 0.36560 (QuantReg: 12.84724) QuantErr: 12.84724 batch_time=0.34970 
Train Epoch: 42 [846/1000 27072/32000 (85%)] Loss: 0.29244 (QuantReg: 12.81322) QuantErr: 12.81322 batch_time=0.34656 
Train Epoch: 42 [851/1000 27232/32000 (85%)] Loss: 0.63001 (QuantReg: 12.52383) QuantErr: 12.52383 batch_time=1.02801 
Train Epoch: 42 [856/1000 27392/32000 (86%)] Loss: 0.21906 (QuantReg: 12.83068) QuantErr: 12.83068 batch_time=0.37227 
Train Epoch: 42 [861/1000 27552/32000 (86%)] Loss: 0.12031 (QuantReg: 12.61934) QuantErr: 12.61934 batch_time=0.36016 
Train Epoch: 42 [866/1000 27712/32000 (87%)] Loss: 0.45238 (QuantReg: 12.62794) QuantErr: 12.62794 batch_time=0.36550 
Train Epoch: 42 [871/1000 27872/32000 (87%)] Loss: 0.07901 (QuantReg: 13.51412) QuantErr: 13.51412 batch_time=0.37516 
Train Epoch: 42 [876/1000 28032/32000 (88%)] Loss: 0.53041 (QuantReg: 12.60632) QuantErr: 12.60632 batch_time=0.36517 
Train Epoch: 42 [881/1000 28192/32000 (88%)] Loss: 0.33258 (QuantReg: 12.82513) QuantErr: 12.82513 batch_time=0.37158 
Train Epoch: 42 [886/1000 28352/32000 (89%)] Loss: 0.22555 (QuantReg: 12.86557) QuantErr: 12.86557 batch_time=0.39900 
Train Epoch: 42 [891/1000 28512/32000 (89%)] Loss: 0.19067 (QuantReg: 12.66967) QuantErr: 12.66967 batch_time=0.36093 
Train Epoch: 42 [896/1000 28672/32000 (90%)] Loss: 0.32083 (QuantReg: 12.66629) QuantErr: 12.66629 batch_time=0.42090 
Train Epoch: 42 [901/1000 28832/32000 (90%)] Loss: 0.31463 (QuantReg: 12.94416) QuantErr: 12.94416 batch_time=0.63469 
Train Epoch: 42 [906/1000 28992/32000 (91%)] Loss: 0.28854 (QuantReg: 13.01029) QuantErr: 13.01029 batch_time=0.35310 
Train Epoch: 42 [911/1000 29152/32000 (91%)] Loss: 0.32413 (QuantReg: 13.87537) QuantErr: 13.87537 batch_time=0.35456 
Train Epoch: 42 [916/1000 29312/32000 (92%)] Loss: 0.13651 (QuantReg: 12.40796) QuantErr: 12.40796 batch_time=0.36123 
Train Epoch: 42 [921/1000 29472/32000 (92%)] Loss: 0.61556 (QuantReg: 13.43081) QuantErr: 13.43081 batch_time=0.36156 
Train Epoch: 42 [926/1000 29632/32000 (93%)] Loss: 0.33739 (QuantReg: 13.38783) QuantErr: 13.38783 batch_time=0.40276 
Train Epoch: 42 [931/1000 29792/32000 (93%)] Loss: 0.65235 (QuantReg: 13.01117) QuantErr: 13.01117 batch_time=0.37868 
Train Epoch: 42 [936/1000 29952/32000 (94%)] Loss: 0.16424 (QuantReg: 12.61192) QuantErr: 12.61192 batch_time=0.35539 
Train Epoch: 42 [941/1000 30112/32000 (94%)] Loss: 0.28855 (QuantReg: 12.41262) QuantErr: 12.41262 batch_time=0.36182 
Train Epoch: 42 [946/1000 30272/32000 (95%)] Loss: 0.24485 (QuantReg: 12.81585) QuantErr: 12.81585 batch_time=0.36288 
Train Epoch: 42 [951/1000 30432/32000 (95%)] Loss: 0.33703 (QuantReg: 12.85516) QuantErr: 12.85516 batch_time=0.36214 
Train Epoch: 42 [956/1000 30592/32000 (96%)] Loss: 0.44132 (QuantReg: 13.21182) QuantErr: 13.21182 batch_time=0.35823 
Train Epoch: 42 [961/1000 30752/32000 (96%)] Loss: 0.20785 (QuantReg: 12.85685) QuantErr: 12.85685 batch_time=0.39264 
Train Epoch: 42 [966/1000 30912/32000 (97%)] Loss: 0.19036 (QuantReg: 12.71870) QuantErr: 12.71870 batch_time=0.36263 
Train Epoch: 42 [971/1000 31072/32000 (97%)] Loss: 0.33332 (QuantReg: 12.99393) QuantErr: 12.99393 batch_time=0.35804 
Train Epoch: 42 [976/1000 31232/32000 (98%)] Loss: 0.25599 (QuantReg: 12.95705) QuantErr: 12.95705 batch_time=0.35696 
Train Epoch: 42 [981/1000 31392/32000 (98%)] Loss: 0.48843 (QuantReg: 13.04072) QuantErr: 13.04072 batch_time=0.36772 
Train Epoch: 42 [986/1000 31552/32000 (99%)] Loss: 0.06679 (QuantReg: 13.39940) QuantErr: 13.39940 batch_time=0.36499 
Train Epoch: 42 [991/1000 31712/32000 (99%)] Loss: 0.23236 (QuantReg: 13.15658) QuantErr: 13.15658 batch_time=0.36585 
Train Epoch: 42 [996/1000 31872/32000 (100%)] Loss: 0.22190 (QuantReg: 12.94536) QuantErr: 12.94536 batch_time=0.35913 
Train Epoch: 42 codebook_update_time=1.98930
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch42.pth ...
Done in 23.605s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch42.pth ...
Done in 28.356s
removing stale ckpt [epoch 41] [took 0.01s]
 epoch          : 42
 loss           : 0.2980646904781461
 quant_reg      : 12.88486743927002
 quant_err      : 12.88486743927002
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 42000
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 83.09859154929578
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.382293762575452
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.51740999312192
 MSRVTT_full_val/v2t_metrics/R1: 36.01609657947686
 MSRVTT_full_val/v2t_metrics/R5: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.301810865191147
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.15005242054955
 MSRVTT_full_test/t2v_metrics/R1: 13.444816053511706
 MSRVTT_full_test/t2v_metrics/R5: 37.424749163879596
 MSRVTT_full_test/t2v_metrics/R10: 50.802675585284284
 MSRVTT_full_test/t2v_metrics/R50: 80.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.606020066889634
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.457786902921846
 MSRVTT_full_test/v2t_metrics/R1: 16.120401337792643
 MSRVTT_full_test/v2t_metrics/R5: 43.17725752508361
 MSRVTT_full_test/v2t_metrics/R10: 58.16053511705686
 MSRVTT_full_test/v2t_metrics/R50: 86.68896321070234
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.53160535117057
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.33626872279087
 mnt_best       : 29.457786902921846
 not_improved_count: 0
Train Epoch: 43 [1/1000 32/32000 (0%)] Loss: 0.33695 (QuantReg: 12.72955) QuantErr: 12.72955 batch_time=26.73728 
Train Epoch: 43 [6/1000 192/32000 (1%)] Loss: 0.27363 (QuantReg: 13.25568) QuantErr: 13.25568 batch_time=0.37856 
Train Epoch: 43 [11/1000 352/32000 (1%)] Loss: 0.15123 (QuantReg: 12.62240) QuantErr: 12.62240 batch_time=0.37140 
Train Epoch: 43 [16/1000 512/32000 (2%)] Loss: 0.55384 (QuantReg: 12.99484) QuantErr: 12.99484 batch_time=0.69435 
Train Epoch: 43 [21/1000 672/32000 (2%)] Loss: 0.57275 (QuantReg: 12.64687) QuantErr: 12.64687 batch_time=0.43994 
Train Epoch: 43 [26/1000 832/32000 (3%)] Loss: 0.26522 (QuantReg: 12.82029) QuantErr: 12.82029 batch_time=0.35064 
Train Epoch: 43 [31/1000 992/32000 (3%)] Loss: 0.42577 (QuantReg: 12.62736) QuantErr: 12.62736 batch_time=0.36695 
Train Epoch: 43 [36/1000 1152/32000 (4%)] Loss: 0.27181 (QuantReg: 12.55639) QuantErr: 12.55639 batch_time=0.39448 
Train Epoch: 43 [41/1000 1312/32000 (4%)] Loss: 0.37009 (QuantReg: 13.44981) QuantErr: 13.44981 batch_time=0.42835 
Train Epoch: 43 [46/1000 1472/32000 (5%)] Loss: 0.51105 (QuantReg: 12.81010) QuantErr: 12.81010 batch_time=0.38319 
Train Epoch: 43 [51/1000 1632/32000 (5%)] Loss: 0.19473 (QuantReg: 12.87724) QuantErr: 12.87724 batch_time=0.44838 
Train Epoch: 43 [56/1000 1792/32000 (6%)] Loss: 0.23008 (QuantReg: 13.29805) QuantErr: 13.29805 batch_time=0.34711 
Train Epoch: 43 [61/1000 1952/32000 (6%)] Loss: 0.27012 (QuantReg: 12.18398) QuantErr: 12.18398 batch_time=0.38261 
Train Epoch: 43 [66/1000 2112/32000 (7%)] Loss: 0.29949 (QuantReg: 13.04729) QuantErr: 13.04729 batch_time=0.59530 
Train Epoch: 43 [71/1000 2272/32000 (7%)] Loss: 0.17182 (QuantReg: 12.57820) QuantErr: 12.57820 batch_time=0.54824 
Train Epoch: 43 [76/1000 2432/32000 (8%)] Loss: 0.74032 (QuantReg: 13.02416) QuantErr: 13.02416 batch_time=1.07933 
Train Epoch: 43 [81/1000 2592/32000 (8%)] Loss: 0.45804 (QuantReg: 12.65730) QuantErr: 12.65730 batch_time=0.37628 
Train Epoch: 43 [86/1000 2752/32000 (9%)] Loss: 0.36542 (QuantReg: 13.52717) QuantErr: 13.52717 batch_time=0.37904 
Train Epoch: 43 [91/1000 2912/32000 (9%)] Loss: 0.32251 (QuantReg: 13.19455) QuantErr: 13.19455 batch_time=0.38415 
Train Epoch: 43 [96/1000 3072/32000 (10%)] Loss: 0.09180 (QuantReg: 13.16299) QuantErr: 13.16299 batch_time=0.37357 
Train Epoch: 43 [101/1000 3232/32000 (10%)] Loss: 0.41127 (QuantReg: 12.73451) QuantErr: 12.73451 batch_time=0.40479 
Train Epoch: 43 [106/1000 3392/32000 (11%)] Loss: 0.15900 (QuantReg: 12.74152) QuantErr: 12.74152 batch_time=0.40238 
Train Epoch: 43 [111/1000 3552/32000 (11%)] Loss: 0.55960 (QuantReg: 12.96410) QuantErr: 12.96410 batch_time=0.38171 
Train Epoch: 43 [116/1000 3712/32000 (12%)] Loss: 0.26317 (QuantReg: 12.52086) QuantErr: 12.52086 batch_time=0.41867 
Train Epoch: 43 [121/1000 3872/32000 (12%)] Loss: 0.28699 (QuantReg: 13.21657) QuantErr: 13.21657 batch_time=0.35758 
Train Epoch: 43 [126/1000 4032/32000 (13%)] Loss: 0.18451 (QuantReg: 13.15929) QuantErr: 13.15929 batch_time=0.54667 
Train Epoch: 43 [131/1000 4192/32000 (13%)] Loss: 0.10369 (QuantReg: 13.08229) QuantErr: 13.08229 batch_time=0.37709 
Train Epoch: 43 [136/1000 4352/32000 (14%)] Loss: 0.12221 (QuantReg: 12.92577) QuantErr: 12.92577 batch_time=0.40747 
Train Epoch: 43 [141/1000 4512/32000 (14%)] Loss: 0.20911 (QuantReg: 13.56535) QuantErr: 13.56535 batch_time=0.44686 
Train Epoch: 43 [146/1000 4672/32000 (15%)] Loss: 0.38115 (QuantReg: 13.14991) QuantErr: 13.14991 batch_time=1.00018 
Train Epoch: 43 [151/1000 4832/32000 (15%)] Loss: 0.34319 (QuantReg: 13.12729) QuantErr: 13.12729 batch_time=0.38470 
Train Epoch: 43 [156/1000 4992/32000 (16%)] Loss: 0.17543 (QuantReg: 12.63337) QuantErr: 12.63337 batch_time=0.38034 
Train Epoch: 43 [161/1000 5152/32000 (16%)] Loss: 0.49952 (QuantReg: 13.01434) QuantErr: 13.01434 batch_time=0.36065 
Train Epoch: 43 [166/1000 5312/32000 (17%)] Loss: 0.19797 (QuantReg: 12.79280) QuantErr: 12.79280 batch_time=0.37129 
Train Epoch: 43 [171/1000 5472/32000 (17%)] Loss: 0.14892 (QuantReg: 12.89122) QuantErr: 12.89122 batch_time=0.35910 
Train Epoch: 43 [176/1000 5632/32000 (18%)] Loss: 0.11257 (QuantReg: 12.78117) QuantErr: 12.78117 batch_time=0.40326 
Train Epoch: 43 [181/1000 5792/32000 (18%)] Loss: 0.16744 (QuantReg: 13.01672) QuantErr: 13.01672 batch_time=0.47803 
Train Epoch: 43 [186/1000 5952/32000 (19%)] Loss: 0.10494 (QuantReg: 13.03075) QuantErr: 13.03075 batch_time=0.42580 
Train Epoch: 43 [191/1000 6112/32000 (19%)] Loss: 0.18690 (QuantReg: 13.27748) QuantErr: 13.27748 batch_time=0.40132 
Train Epoch: 43 [196/1000 6272/32000 (20%)] Loss: 0.28601 (QuantReg: 12.98884) QuantErr: 12.98884 batch_time=0.46610 
Train Epoch: 43 [201/1000 6432/32000 (20%)] Loss: 0.13925 (QuantReg: 12.58293) QuantErr: 12.58293 batch_time=0.42934 
Train Epoch: 43 [206/1000 6592/32000 (21%)] Loss: 0.48359 (QuantReg: 12.53471) QuantErr: 12.53471 batch_time=0.36166 
Train Epoch: 43 [211/1000 6752/32000 (21%)] Loss: 0.56845 (QuantReg: 12.50395) QuantErr: 12.50395 batch_time=0.39172 
Train Epoch: 43 [216/1000 6912/32000 (22%)] Loss: 0.20533 (QuantReg: 13.31070) QuantErr: 13.31070 batch_time=0.37285 
Train Epoch: 43 [221/1000 7072/32000 (22%)] Loss: 0.18131 (QuantReg: 13.26032) QuantErr: 13.26032 batch_time=0.37358 
Train Epoch: 43 [226/1000 7232/32000 (23%)] Loss: 0.19456 (QuantReg: 13.32237) QuantErr: 13.32237 batch_time=0.42449 
Train Epoch: 43 [231/1000 7392/32000 (23%)] Loss: 0.47628 (QuantReg: 12.71757) QuantErr: 12.71757 batch_time=0.39192 
Train Epoch: 43 [236/1000 7552/32000 (24%)] Loss: 0.26578 (QuantReg: 13.43614) QuantErr: 13.43614 batch_time=0.47996 
Train Epoch: 43 [241/1000 7712/32000 (24%)] Loss: 0.48953 (QuantReg: 12.87887) QuantErr: 12.87887 batch_time=0.41266 
Train Epoch: 43 [246/1000 7872/32000 (25%)] Loss: 0.12948 (QuantReg: 13.12438) QuantErr: 13.12438 batch_time=0.38545 
Train Epoch: 43 [251/1000 8032/32000 (25%)] Loss: 0.31435 (QuantReg: 12.80554) QuantErr: 12.80554 batch_time=0.35646 
Train Epoch: 43 [256/1000 8192/32000 (26%)] Loss: 0.57202 (QuantReg: 12.58842) QuantErr: 12.58842 batch_time=0.35602 
Train Epoch: 43 [261/1000 8352/32000 (26%)] Loss: 0.24303 (QuantReg: 13.41693) QuantErr: 13.41693 batch_time=0.38283 
Train Epoch: 43 [266/1000 8512/32000 (27%)] Loss: 0.34762 (QuantReg: 12.67311) QuantErr: 12.67311 batch_time=0.46622 
Train Epoch: 43 [271/1000 8672/32000 (27%)] Loss: 0.17446 (QuantReg: 12.93174) QuantErr: 12.93174 batch_time=0.36126 
Train Epoch: 43 [276/1000 8832/32000 (28%)] Loss: 0.23420 (QuantReg: 13.23805) QuantErr: 13.23805 batch_time=0.49272 
Train Epoch: 43 [281/1000 8992/32000 (28%)] Loss: 0.32616 (QuantReg: 12.61614) QuantErr: 12.61614 batch_time=0.40279 
Train Epoch: 43 [286/1000 9152/32000 (29%)] Loss: 0.17237 (QuantReg: 13.04559) QuantErr: 13.04559 batch_time=0.37166 
Train Epoch: 43 [291/1000 9312/32000 (29%)] Loss: 0.18788 (QuantReg: 13.26359) QuantErr: 13.26359 batch_time=0.41795 
Train Epoch: 43 [296/1000 9472/32000 (30%)] Loss: 0.36657 (QuantReg: 13.35517) QuantErr: 13.35517 batch_time=0.39628 
Train Epoch: 43 [301/1000 9632/32000 (30%)] Loss: 0.32961 (QuantReg: 13.42910) QuantErr: 13.42910 batch_time=0.40615 
Train Epoch: 43 [306/1000 9792/32000 (31%)] Loss: 0.50831 (QuantReg: 12.01587) QuantErr: 12.01587 batch_time=0.41948 
Train Epoch: 43 [311/1000 9952/32000 (31%)] Loss: 0.27522 (QuantReg: 13.08537) QuantErr: 13.08537 batch_time=0.40909 
Train Epoch: 43 [316/1000 10112/32000 (32%)] Loss: 0.32336 (QuantReg: 12.91340) QuantErr: 12.91340 batch_time=0.41027 
Train Epoch: 43 [321/1000 10272/32000 (32%)] Loss: 0.26752 (QuantReg: 13.03049) QuantErr: 13.03049 batch_time=0.37150 
Train Epoch: 43 [326/1000 10432/32000 (33%)] Loss: 0.55431 (QuantReg: 12.53344) QuantErr: 12.53344 batch_time=0.42756 
Train Epoch: 43 [331/1000 10592/32000 (33%)] Loss: 0.25940 (QuantReg: 13.40938) QuantErr: 13.40938 batch_time=0.36750 
Train Epoch: 43 [336/1000 10752/32000 (34%)] Loss: 0.50195 (QuantReg: 12.38002) QuantErr: 12.38002 batch_time=0.76270 
Train Epoch: 43 [341/1000 10912/32000 (34%)] Loss: 0.16456 (QuantReg: 13.04865) QuantErr: 13.04865 batch_time=0.42050 
Train Epoch: 43 [346/1000 11072/32000 (35%)] Loss: 0.72498 (QuantReg: 12.85359) QuantErr: 12.85359 batch_time=0.40040 
Train Epoch: 43 [351/1000 11232/32000 (35%)] Loss: 0.25335 (QuantReg: 12.94917) QuantErr: 12.94917 batch_time=0.37391 
Train Epoch: 43 [356/1000 11392/32000 (36%)] Loss: 0.20439 (QuantReg: 13.19821) QuantErr: 13.19821 batch_time=0.35706 
Train Epoch: 43 [361/1000 11552/32000 (36%)] Loss: 0.17093 (QuantReg: 13.17058) QuantErr: 13.17058 batch_time=0.38456 
Train Epoch: 43 [366/1000 11712/32000 (37%)] Loss: 0.18109 (QuantReg: 13.07146) QuantErr: 13.07146 batch_time=0.39775 
Train Epoch: 43 [371/1000 11872/32000 (37%)] Loss: 0.44875 (QuantReg: 12.92069) QuantErr: 12.92069 batch_time=0.40903 
Train Epoch: 43 [376/1000 12032/32000 (38%)] Loss: 0.43340 (QuantReg: 12.74619) QuantErr: 12.74619 batch_time=0.37239 
Train Epoch: 43 [381/1000 12192/32000 (38%)] Loss: 0.22339 (QuantReg: 13.25642) QuantErr: 13.25642 batch_time=0.46225 
Train Epoch: 43 [386/1000 12352/32000 (39%)] Loss: 0.20130 (QuantReg: 13.52556) QuantErr: 13.52556 batch_time=0.51771 
Train Epoch: 43 [391/1000 12512/32000 (39%)] Loss: 0.55500 (QuantReg: 12.53377) QuantErr: 12.53377 batch_time=0.52752 
Train Epoch: 43 [396/1000 12672/32000 (40%)] Loss: 0.21534 (QuantReg: 13.35610) QuantErr: 13.35610 batch_time=1.02278 
Train Epoch: 43 [401/1000 12832/32000 (40%)] Loss: 0.20343 (QuantReg: 12.55202) QuantErr: 12.55202 batch_time=0.40518 
Train Epoch: 43 [406/1000 12992/32000 (41%)] Loss: 0.18218 (QuantReg: 12.72448) QuantErr: 12.72448 batch_time=0.35559 
Train Epoch: 43 [411/1000 13152/32000 (41%)] Loss: 0.21665 (QuantReg: 12.82911) QuantErr: 12.82911 batch_time=0.37601 
Train Epoch: 43 [416/1000 13312/32000 (42%)] Loss: 0.34138 (QuantReg: 12.84189) QuantErr: 12.84189 batch_time=0.37454 
Train Epoch: 43 [421/1000 13472/32000 (42%)] Loss: 0.18059 (QuantReg: 12.95520) QuantErr: 12.95520 batch_time=0.47159 
Train Epoch: 43 [426/1000 13632/32000 (43%)] Loss: 0.48200 (QuantReg: 13.55556) QuantErr: 13.55556 batch_time=0.37169 
Train Epoch: 43 [431/1000 13792/32000 (43%)] Loss: 0.35055 (QuantReg: 12.70662) QuantErr: 12.70662 batch_time=0.37135 
Train Epoch: 43 [436/1000 13952/32000 (44%)] Loss: 0.50926 (QuantReg: 12.56934) QuantErr: 12.56934 batch_time=0.43625 
Train Epoch: 43 [441/1000 14112/32000 (44%)] Loss: 0.64376 (QuantReg: 12.71817) QuantErr: 12.71817 batch_time=0.38598 
Train Epoch: 43 [446/1000 14272/32000 (45%)] Loss: 0.39839 (QuantReg: 12.70416) QuantErr: 12.70416 batch_time=0.44802 
Train Epoch: 43 [451/1000 14432/32000 (45%)] Loss: 0.05452 (QuantReg: 12.69011) QuantErr: 12.69011 batch_time=0.38876 
Train Epoch: 43 [456/1000 14592/32000 (46%)] Loss: 0.08056 (QuantReg: 13.57532) QuantErr: 13.57532 batch_time=0.37142 
Train Epoch: 43 [461/1000 14752/32000 (46%)] Loss: 0.09376 (QuantReg: 12.61442) QuantErr: 12.61442 batch_time=0.39909 
Train Epoch: 43 [466/1000 14912/32000 (47%)] Loss: 0.39340 (QuantReg: 12.72661) QuantErr: 12.72661 batch_time=0.97348 
Train Epoch: 43 [471/1000 15072/32000 (47%)] Loss: 0.50228 (QuantReg: 12.98578) QuantErr: 12.98578 batch_time=0.36066 
Train Epoch: 43 [476/1000 15232/32000 (48%)] Loss: 0.17728 (QuantReg: 12.85524) QuantErr: 12.85524 batch_time=0.39105 
Train Epoch: 43 [481/1000 15392/32000 (48%)] Loss: 0.22298 (QuantReg: 12.78384) QuantErr: 12.78384 batch_time=0.36246 
Train Epoch: 43 [486/1000 15552/32000 (49%)] Loss: 0.16538 (QuantReg: 13.24671) QuantErr: 13.24671 batch_time=0.39888 
Train Epoch: 43 [491/1000 15712/32000 (49%)] Loss: 0.14305 (QuantReg: 12.61606) QuantErr: 12.61606 batch_time=0.42993 
Train Epoch: 43 [496/1000 15872/32000 (50%)] Loss: 0.36092 (QuantReg: 12.64024) QuantErr: 12.64024 batch_time=0.36098 
Train Epoch: 43 [501/1000 16032/32000 (50%)] Loss: 0.52009 (QuantReg: 13.28720) QuantErr: 13.28720 batch_time=0.36942 
Train Epoch: 43 [506/1000 16192/32000 (51%)] Loss: 0.12636 (QuantReg: 13.31054) QuantErr: 13.31054 batch_time=0.35587 
Train Epoch: 43 [511/1000 16352/32000 (51%)] Loss: 0.16669 (QuantReg: 12.54168) QuantErr: 12.54168 batch_time=0.38909 
Train Epoch: 43 [516/1000 16512/32000 (52%)] Loss: 0.45041 (QuantReg: 12.67775) QuantErr: 12.67775 batch_time=0.40616 
Train Epoch: 43 [521/1000 16672/32000 (52%)] Loss: 0.12528 (QuantReg: 12.35780) QuantErr: 12.35780 batch_time=0.36576 
Train Epoch: 43 [526/1000 16832/32000 (53%)] Loss: 0.32133 (QuantReg: 12.95299) QuantErr: 12.95299 batch_time=0.35815 
Train Epoch: 43 [531/1000 16992/32000 (53%)] Loss: 0.13941 (QuantReg: 12.98832) QuantErr: 12.98832 batch_time=0.35695 
Train Epoch: 43 [536/1000 17152/32000 (54%)] Loss: 0.12654 (QuantReg: 13.24486) QuantErr: 13.24486 batch_time=0.40643 
Train Epoch: 43 [541/1000 17312/32000 (54%)] Loss: 0.20637 (QuantReg: 12.21960) QuantErr: 12.21960 batch_time=0.38448 
Train Epoch: 43 [546/1000 17472/32000 (55%)] Loss: 0.46633 (QuantReg: 13.18659) QuantErr: 13.18659 batch_time=0.36709 
Train Epoch: 43 [551/1000 17632/32000 (55%)] Loss: 0.23243 (QuantReg: 13.18393) QuantErr: 13.18393 batch_time=0.39170 
Train Epoch: 43 [556/1000 17792/32000 (56%)] Loss: 0.27948 (QuantReg: 12.87222) QuantErr: 12.87222 batch_time=0.45820 
Train Epoch: 43 [561/1000 17952/32000 (56%)] Loss: 0.15099 (QuantReg: 13.78508) QuantErr: 13.78508 batch_time=0.46605 
Train Epoch: 43 [566/1000 18112/32000 (57%)] Loss: 0.41406 (QuantReg: 12.58694) QuantErr: 12.58694 batch_time=0.36822 
Train Epoch: 43 [571/1000 18272/32000 (57%)] Loss: 0.27916 (QuantReg: 13.12952) QuantErr: 13.12952 batch_time=0.44576 
Train Epoch: 43 [576/1000 18432/32000 (58%)] Loss: 0.38163 (QuantReg: 13.11003) QuantErr: 13.11003 batch_time=0.46767 
Train Epoch: 43 [581/1000 18592/32000 (58%)] Loss: 0.26507 (QuantReg: 12.65191) QuantErr: 12.65191 batch_time=0.44445 
Train Epoch: 43 [586/1000 18752/32000 (59%)] Loss: 0.18373 (QuantReg: 13.02270) QuantErr: 13.02270 batch_time=0.43889 
Train Epoch: 43 [591/1000 18912/32000 (59%)] Loss: 0.29183 (QuantReg: 13.03762) QuantErr: 13.03762 batch_time=0.35366 
Train Epoch: 43 [596/1000 19072/32000 (60%)] Loss: 0.40452 (QuantReg: 13.43914) QuantErr: 13.43914 batch_time=0.51287 
Train Epoch: 43 [601/1000 19232/32000 (60%)] Loss: 0.06751 (QuantReg: 12.85326) QuantErr: 12.85326 batch_time=0.39373 
Train Epoch: 43 [606/1000 19392/32000 (61%)] Loss: 0.30453 (QuantReg: 12.81657) QuantErr: 12.81657 batch_time=0.36280 
Train Epoch: 43 [611/1000 19552/32000 (61%)] Loss: 0.19446 (QuantReg: 12.40063) QuantErr: 12.40063 batch_time=0.42623 
Train Epoch: 43 [616/1000 19712/32000 (62%)] Loss: 0.27106 (QuantReg: 13.22655) QuantErr: 13.22655 batch_time=0.45749 
Train Epoch: 43 [621/1000 19872/32000 (62%)] Loss: 0.49011 (QuantReg: 12.64496) QuantErr: 12.64496 batch_time=0.40488 
Train Epoch: 43 [626/1000 20032/32000 (63%)] Loss: 0.28105 (QuantReg: 13.56125) QuantErr: 13.56125 batch_time=0.38989 
Train Epoch: 43 [631/1000 20192/32000 (63%)] Loss: 0.58973 (QuantReg: 13.14886) QuantErr: 13.14886 batch_time=0.40425 
Train Epoch: 43 [636/1000 20352/32000 (64%)] Loss: 0.49257 (QuantReg: 13.34032) QuantErr: 13.34032 batch_time=0.36956 
Train Epoch: 43 [641/1000 20512/32000 (64%)] Loss: 0.38532 (QuantReg: 13.10386) QuantErr: 13.10386 batch_time=0.36838 
Train Epoch: 43 [646/1000 20672/32000 (65%)] Loss: 0.35993 (QuantReg: 13.27337) QuantErr: 13.27337 batch_time=0.39428 
Train Epoch: 43 [651/1000 20832/32000 (65%)] Loss: 0.51127 (QuantReg: 13.38357) QuantErr: 13.38357 batch_time=0.36697 
Train Epoch: 43 [656/1000 20992/32000 (66%)] Loss: 0.34845 (QuantReg: 13.17122) QuantErr: 13.17122 batch_time=0.70053 
Train Epoch: 43 [661/1000 21152/32000 (66%)] Loss: 0.11001 (QuantReg: 13.09698) QuantErr: 13.09698 batch_time=0.38689 
Train Epoch: 43 [666/1000 21312/32000 (67%)] Loss: 0.31078 (QuantReg: 12.83624) QuantErr: 12.83624 batch_time=0.35933 
Train Epoch: 43 [671/1000 21472/32000 (67%)] Loss: 0.25787 (QuantReg: 12.55152) QuantErr: 12.55152 batch_time=0.39640 
Train Epoch: 43 [676/1000 21632/32000 (68%)] Loss: 0.14260 (QuantReg: 12.68366) QuantErr: 12.68366 batch_time=0.38337 
Train Epoch: 43 [681/1000 21792/32000 (68%)] Loss: 0.43005 (QuantReg: 12.90389) QuantErr: 12.90389 batch_time=0.40975 
Train Epoch: 43 [686/1000 21952/32000 (69%)] Loss: 0.15050 (QuantReg: 12.67637) QuantErr: 12.67637 batch_time=0.38350 
Train Epoch: 43 [691/1000 22112/32000 (69%)] Loss: 0.67776 (QuantReg: 12.89103) QuantErr: 12.89103 batch_time=0.39329 
Train Epoch: 43 [696/1000 22272/32000 (70%)] Loss: 0.19014 (QuantReg: 12.88077) QuantErr: 12.88077 batch_time=0.39753 
Train Epoch: 43 [701/1000 22432/32000 (70%)] Loss: 0.34501 (QuantReg: 12.67495) QuantErr: 12.67495 batch_time=0.41726 
Train Epoch: 43 [706/1000 22592/32000 (71%)] Loss: 0.14573 (QuantReg: 12.74000) QuantErr: 12.74000 batch_time=0.58024 
Train Epoch: 43 [711/1000 22752/32000 (71%)] Loss: 0.19307 (QuantReg: 13.05942) QuantErr: 13.05942 batch_time=0.55183 
Train Epoch: 43 [716/1000 22912/32000 (72%)] Loss: 0.21904 (QuantReg: 12.95528) QuantErr: 12.95528 batch_time=1.11318 
Train Epoch: 43 [721/1000 23072/32000 (72%)] Loss: 0.59559 (QuantReg: 12.28876) QuantErr: 12.28876 batch_time=0.36786 
Train Epoch: 43 [726/1000 23232/32000 (73%)] Loss: 0.12060 (QuantReg: 12.95116) QuantErr: 12.95116 batch_time=0.39758 
Train Epoch: 43 [731/1000 23392/32000 (73%)] Loss: 0.34490 (QuantReg: 12.98140) QuantErr: 12.98140 batch_time=0.35414 
Train Epoch: 43 [736/1000 23552/32000 (74%)] Loss: 0.30941 (QuantReg: 13.10529) QuantErr: 13.10529 batch_time=0.36714 
Train Epoch: 43 [741/1000 23712/32000 (74%)] Loss: 0.18525 (QuantReg: 12.86934) QuantErr: 12.86934 batch_time=0.35574 
Train Epoch: 43 [746/1000 23872/32000 (75%)] Loss: 0.22268 (QuantReg: 12.11382) QuantErr: 12.11382 batch_time=0.43551 
Train Epoch: 43 [751/1000 24032/32000 (75%)] Loss: 0.53464 (QuantReg: 12.62019) QuantErr: 12.62019 batch_time=0.43581 
Train Epoch: 43 [756/1000 24192/32000 (76%)] Loss: 0.23273 (QuantReg: 13.04037) QuantErr: 13.04037 batch_time=0.46852 
Train Epoch: 43 [761/1000 24352/32000 (76%)] Loss: 0.13843 (QuantReg: 13.16983) QuantErr: 13.16983 batch_time=0.41119 
Train Epoch: 43 [766/1000 24512/32000 (77%)] Loss: 0.09187 (QuantReg: 13.09920) QuantErr: 13.09920 batch_time=0.43299 
Train Epoch: 43 [771/1000 24672/32000 (77%)] Loss: 0.23813 (QuantReg: 12.91359) QuantErr: 12.91359 batch_time=0.40419 
Train Epoch: 43 [776/1000 24832/32000 (78%)] Loss: 0.34291 (QuantReg: 12.92167) QuantErr: 12.92167 batch_time=0.35451 
Train Epoch: 43 [781/1000 24992/32000 (78%)] Loss: 0.17374 (QuantReg: 12.93933) QuantErr: 12.93933 batch_time=0.35290 
Train Epoch: 43 [786/1000 25152/32000 (79%)] Loss: 0.16235 (QuantReg: 13.06455) QuantErr: 13.06455 batch_time=0.82578 
Train Epoch: 43 [791/1000 25312/32000 (79%)] Loss: 0.29992 (QuantReg: 12.89173) QuantErr: 12.89173 batch_time=0.38413 
Train Epoch: 43 [796/1000 25472/32000 (80%)] Loss: 0.21600 (QuantReg: 13.01445) QuantErr: 13.01445 batch_time=0.34968 
Train Epoch: 43 [801/1000 25632/32000 (80%)] Loss: 0.41186 (QuantReg: 12.89407) QuantErr: 12.89407 batch_time=0.38523 
Train Epoch: 43 [806/1000 25792/32000 (81%)] Loss: 0.27044 (QuantReg: 13.23702) QuantErr: 13.23702 batch_time=0.37659 
Train Epoch: 43 [811/1000 25952/32000 (81%)] Loss: 0.49190 (QuantReg: 12.49020) QuantErr: 12.49020 batch_time=0.38127 
Train Epoch: 43 [816/1000 26112/32000 (82%)] Loss: 0.49245 (QuantReg: 12.68051) QuantErr: 12.68051 batch_time=0.42638 
Train Epoch: 43 [821/1000 26272/32000 (82%)] Loss: 0.05054 (QuantReg: 13.13161) QuantErr: 13.13161 batch_time=0.37523 
Train Epoch: 43 [826/1000 26432/32000 (83%)] Loss: 0.30499 (QuantReg: 13.33008) QuantErr: 13.33008 batch_time=0.38088 
Train Epoch: 43 [831/1000 26592/32000 (83%)] Loss: 0.11977 (QuantReg: 12.81632) QuantErr: 12.81632 batch_time=0.35981 
Train Epoch: 43 [836/1000 26752/32000 (84%)] Loss: 0.17216 (QuantReg: 13.32693) QuantErr: 13.32693 batch_time=0.41473 
Train Epoch: 43 [841/1000 26912/32000 (84%)] Loss: 0.23091 (QuantReg: 13.06806) QuantErr: 13.06806 batch_time=0.35500 
Train Epoch: 43 [846/1000 27072/32000 (85%)] Loss: 0.17098 (QuantReg: 12.64428) QuantErr: 12.64428 batch_time=0.35095 
Train Epoch: 43 [851/1000 27232/32000 (85%)] Loss: 0.14754 (QuantReg: 13.09910) QuantErr: 13.09910 batch_time=0.35530 
Train Epoch: 43 [856/1000 27392/32000 (86%)] Loss: 0.33013 (QuantReg: 12.55033) QuantErr: 12.55033 batch_time=0.40008 
Train Epoch: 43 [861/1000 27552/32000 (86%)] Loss: 0.41280 (QuantReg: 12.48454) QuantErr: 12.48454 batch_time=0.38635 
Train Epoch: 43 [866/1000 27712/32000 (87%)] Loss: 0.34776 (QuantReg: 12.66873) QuantErr: 12.66873 batch_time=0.39011 
Train Epoch: 43 [871/1000 27872/32000 (87%)] Loss: 0.20586 (QuantReg: 13.20038) QuantErr: 13.20038 batch_time=0.46111 
Train Epoch: 43 [876/1000 28032/32000 (88%)] Loss: 0.37646 (QuantReg: 12.88857) QuantErr: 12.88857 batch_time=0.35321 
Train Epoch: 43 [881/1000 28192/32000 (88%)] Loss: 0.35198 (QuantReg: 12.97929) QuantErr: 12.97929 batch_time=0.35906 
Train Epoch: 43 [886/1000 28352/32000 (89%)] Loss: 0.73405 (QuantReg: 12.74123) QuantErr: 12.74123 batch_time=0.37020 
Train Epoch: 43 [891/1000 28512/32000 (89%)] Loss: 0.22580 (QuantReg: 13.52123) QuantErr: 13.52123 batch_time=0.35047 
Train Epoch: 43 [896/1000 28672/32000 (90%)] Loss: 0.21233 (QuantReg: 12.77234) QuantErr: 12.77234 batch_time=0.36914 
Train Epoch: 43 [901/1000 28832/32000 (90%)] Loss: 0.23216 (QuantReg: 12.33558) QuantErr: 12.33558 batch_time=0.36188 
Train Epoch: 43 [906/1000 28992/32000 (91%)] Loss: 0.39508 (QuantReg: 13.31927) QuantErr: 13.31927 batch_time=0.35871 
Train Epoch: 43 [911/1000 29152/32000 (91%)] Loss: 0.39715 (QuantReg: 12.89961) QuantErr: 12.89961 batch_time=0.35562 
Train Epoch: 43 [916/1000 29312/32000 (92%)] Loss: 0.19608 (QuantReg: 12.93825) QuantErr: 12.93825 batch_time=0.45727 
Train Epoch: 43 [921/1000 29472/32000 (92%)] Loss: 0.41061 (QuantReg: 13.32132) QuantErr: 13.32132 batch_time=0.35934 
Train Epoch: 43 [926/1000 29632/32000 (93%)] Loss: 0.35589 (QuantReg: 12.74985) QuantErr: 12.74985 batch_time=0.38886 
Train Epoch: 43 [931/1000 29792/32000 (93%)] Loss: 0.35630 (QuantReg: 12.87574) QuantErr: 12.87574 batch_time=0.35233 
Train Epoch: 43 [936/1000 29952/32000 (94%)] Loss: 0.23662 (QuantReg: 12.80992) QuantErr: 12.80992 batch_time=0.34532 
Train Epoch: 43 [941/1000 30112/32000 (94%)] Loss: 0.37281 (QuantReg: 13.38681) QuantErr: 13.38681 batch_time=0.34554 
Train Epoch: 43 [946/1000 30272/32000 (95%)] Loss: 0.41339 (QuantReg: 12.39140) QuantErr: 12.39140 batch_time=0.35121 
Train Epoch: 43 [951/1000 30432/32000 (95%)] Loss: 0.29330 (QuantReg: 13.11768) QuantErr: 13.11768 batch_time=0.37708 
Train Epoch: 43 [956/1000 30592/32000 (96%)] Loss: 0.51665 (QuantReg: 13.13905) QuantErr: 13.13905 batch_time=0.36161 
Train Epoch: 43 [961/1000 30752/32000 (96%)] Loss: 0.45028 (QuantReg: 12.85936) QuantErr: 12.85936 batch_time=0.42103 
Train Epoch: 43 [966/1000 30912/32000 (97%)] Loss: 0.22218 (QuantReg: 13.35336) QuantErr: 13.35336 batch_time=0.46191 
Train Epoch: 43 [971/1000 31072/32000 (97%)] Loss: 0.49390 (QuantReg: 12.84592) QuantErr: 12.84592 batch_time=0.40677 
Train Epoch: 43 [976/1000 31232/32000 (98%)] Loss: 0.14557 (QuantReg: 13.12161) QuantErr: 13.12161 batch_time=0.85729 
Train Epoch: 43 [981/1000 31392/32000 (98%)] Loss: 0.44207 (QuantReg: 13.07546) QuantErr: 13.07546 batch_time=0.41506 
Train Epoch: 43 [986/1000 31552/32000 (99%)] Loss: 0.48761 (QuantReg: 12.66156) QuantErr: 12.66156 batch_time=0.39815 
Train Epoch: 43 [991/1000 31712/32000 (99%)] Loss: 0.20522 (QuantReg: 13.35145) QuantErr: 13.35145 batch_time=0.38435 
Train Epoch: 43 [996/1000 31872/32000 (100%)] Loss: 0.31932 (QuantReg: 13.00507) QuantErr: 13.00507 batch_time=0.44048 
Train Epoch: 43 codebook_update_time=1.82981
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch43.pth ...
Done in 4.202s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 0.29347905942052604
 quant_reg      : 12.926022333145141
 quant_err      : 12.926022333145141
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 43000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.56338028169014
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.150845397966094
 MSRVTT_full_val/v2t_metrics/R1: 34.80885311871227
 MSRVTT_full_val/v2t_metrics/R5: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.126760563380282
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.56048612555232
 MSRVTT_full_test/t2v_metrics/R1: 12.94314381270903
 MSRVTT_full_test/t2v_metrics/R5: 36.68896321070234
 MSRVTT_full_test/t2v_metrics/R10: 50.33444816053512
 MSRVTT_full_test/t2v_metrics/R50: 79.93311036789298
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.85484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.80581557466423
 MSRVTT_full_test/v2t_metrics/R1: 16.65551839464883
 MSRVTT_full_test/v2t_metrics/R5: 43.31103678929766
 MSRVTT_full_test/v2t_metrics/R10: 58.09364548494983
 MSRVTT_full_test/v2t_metrics/R50: 86.42140468227424
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.64448160535117
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.73455891200815
 mnt_best       : 29.457786902921846
 not_improved_count: 1
Train Epoch: 44 [1/1000 32/32000 (0%)] Loss: 0.11509 (QuantReg: 13.39894) QuantErr: 13.39894 batch_time=29.51115 
Train Epoch: 44 [6/1000 192/32000 (1%)] Loss: 0.35102 (QuantReg: 12.74134) QuantErr: 12.74134 batch_time=0.42270 
Train Epoch: 44 [11/1000 352/32000 (1%)] Loss: 0.45111 (QuantReg: 12.55895) QuantErr: 12.55895 batch_time=0.43529 
Train Epoch: 44 [16/1000 512/32000 (2%)] Loss: 0.51171 (QuantReg: 12.63423) QuantErr: 12.63423 batch_time=0.36042 
Train Epoch: 44 [21/1000 672/32000 (2%)] Loss: 0.44626 (QuantReg: 13.04062) QuantErr: 13.04062 batch_time=0.37817 
Train Epoch: 44 [26/1000 832/32000 (3%)] Loss: 0.24349 (QuantReg: 13.03617) QuantErr: 13.03617 batch_time=0.37503 
Train Epoch: 44 [31/1000 992/32000 (3%)] Loss: 0.09596 (QuantReg: 13.12022) QuantErr: 13.12022 batch_time=0.36394 
Train Epoch: 44 [36/1000 1152/32000 (4%)] Loss: 0.26455 (QuantReg: 13.24453) QuantErr: 13.24453 batch_time=0.36757 
Train Epoch: 44 [41/1000 1312/32000 (4%)] Loss: 0.36070 (QuantReg: 12.81893) QuantErr: 12.81893 batch_time=0.35436 
Train Epoch: 44 [46/1000 1472/32000 (5%)] Loss: 0.33030 (QuantReg: 12.94108) QuantErr: 12.94108 batch_time=0.37342 
Train Epoch: 44 [51/1000 1632/32000 (5%)] Loss: 0.24726 (QuantReg: 12.21555) QuantErr: 12.21555 batch_time=0.42213 
Train Epoch: 44 [56/1000 1792/32000 (6%)] Loss: 0.33042 (QuantReg: 12.85942) QuantErr: 12.85942 batch_time=0.35498 
Train Epoch: 44 [61/1000 1952/32000 (6%)] Loss: 0.20917 (QuantReg: 12.37064) QuantErr: 12.37064 batch_time=0.40312 
Train Epoch: 44 [66/1000 2112/32000 (7%)] Loss: 0.29823 (QuantReg: 12.65496) QuantErr: 12.65496 batch_time=0.60199 
Train Epoch: 44 [71/1000 2272/32000 (7%)] Loss: 0.44721 (QuantReg: 13.10041) QuantErr: 13.10041 batch_time=0.39100 
Train Epoch: 44 [76/1000 2432/32000 (8%)] Loss: 0.25228 (QuantReg: 13.30698) QuantErr: 13.30698 batch_time=0.43668 
Train Epoch: 44 [81/1000 2592/32000 (8%)] Loss: 0.61842 (QuantReg: 13.07676) QuantErr: 13.07676 batch_time=0.41299 
Train Epoch: 44 [86/1000 2752/32000 (9%)] Loss: 0.31208 (QuantReg: 12.66324) QuantErr: 12.66324 batch_time=0.40557 
Train Epoch: 44 [91/1000 2912/32000 (9%)] Loss: 0.50557 (QuantReg: 12.50090) QuantErr: 12.50090 batch_time=0.37607 
Train Epoch: 44 [96/1000 3072/32000 (10%)] Loss: 0.17383 (QuantReg: 13.16752) QuantErr: 13.16752 batch_time=0.43899 
Train Epoch: 44 [101/1000 3232/32000 (10%)] Loss: 0.13567 (QuantReg: 12.84677) QuantErr: 12.84677 batch_time=0.35229 
Train Epoch: 44 [106/1000 3392/32000 (11%)] Loss: 0.16494 (QuantReg: 12.77646) QuantErr: 12.77646 batch_time=0.37939 
Train Epoch: 44 [111/1000 3552/32000 (11%)] Loss: 0.17135 (QuantReg: 12.67864) QuantErr: 12.67864 batch_time=0.42262 
Train Epoch: 44 [116/1000 3712/32000 (12%)] Loss: 0.19198 (QuantReg: 12.58286) QuantErr: 12.58286 batch_time=0.47334 
Train Epoch: 44 [121/1000 3872/32000 (12%)] Loss: 0.56177 (QuantReg: 12.81832) QuantErr: 12.81832 batch_time=0.43993 
Train Epoch: 44 [126/1000 4032/32000 (13%)] Loss: 0.04419 (QuantReg: 12.67213) QuantErr: 12.67213 batch_time=0.46985 
Train Epoch: 44 [131/1000 4192/32000 (13%)] Loss: 0.35205 (QuantReg: 12.52097) QuantErr: 12.52097 batch_time=0.37067 
Train Epoch: 44 [136/1000 4352/32000 (14%)] Loss: 0.45203 (QuantReg: 12.71710) QuantErr: 12.71710 batch_time=0.35556 
Train Epoch: 44 [141/1000 4512/32000 (14%)] Loss: 0.11251 (QuantReg: 13.45707) QuantErr: 13.45707 batch_time=0.41867 
Train Epoch: 44 [146/1000 4672/32000 (15%)] Loss: 0.06548 (QuantReg: 13.06653) QuantErr: 13.06653 batch_time=1.98538 
Train Epoch: 44 [151/1000 4832/32000 (15%)] Loss: 0.29713 (QuantReg: 12.76642) QuantErr: 12.76642 batch_time=0.42972 
Train Epoch: 44 [156/1000 4992/32000 (16%)] Loss: 0.42878 (QuantReg: 12.83742) QuantErr: 12.83742 batch_time=0.35713 
Train Epoch: 44 [161/1000 5152/32000 (16%)] Loss: 0.41031 (QuantReg: 12.78016) QuantErr: 12.78016 batch_time=0.36220 
Train Epoch: 44 [166/1000 5312/32000 (17%)] Loss: 0.53823 (QuantReg: 12.71341) QuantErr: 12.71341 batch_time=0.40497 
Train Epoch: 44 [171/1000 5472/32000 (17%)] Loss: 0.32062 (QuantReg: 12.37564) QuantErr: 12.37564 batch_time=0.40379 
Train Epoch: 44 [176/1000 5632/32000 (18%)] Loss: 0.18774 (QuantReg: 12.96910) QuantErr: 12.96910 batch_time=0.35814 
Train Epoch: 44 [181/1000 5792/32000 (18%)] Loss: 0.31690 (QuantReg: 12.50071) QuantErr: 12.50071 batch_time=0.37246 
Train Epoch: 44 [186/1000 5952/32000 (19%)] Loss: 0.06992 (QuantReg: 13.05991) QuantErr: 13.05991 batch_time=0.38435 
Train Epoch: 44 [191/1000 6112/32000 (19%)] Loss: 0.25695 (QuantReg: 12.87578) QuantErr: 12.87578 batch_time=0.41134 
Train Epoch: 44 [196/1000 6272/32000 (20%)] Loss: 0.11513 (QuantReg: 12.83790) QuantErr: 12.83790 batch_time=0.44800 
Train Epoch: 44 [201/1000 6432/32000 (20%)] Loss: 0.37667 (QuantReg: 13.47809) QuantErr: 13.47809 batch_time=0.48568 
Train Epoch: 44 [206/1000 6592/32000 (21%)] Loss: 0.41484 (QuantReg: 12.70093) QuantErr: 12.70093 batch_time=0.38182 
Train Epoch: 44 [211/1000 6752/32000 (21%)] Loss: 0.37921 (QuantReg: 12.42575) QuantErr: 12.42575 batch_time=0.40407 
Train Epoch: 44 [216/1000 6912/32000 (22%)] Loss: 0.68312 (QuantReg: 12.67214) QuantErr: 12.67214 batch_time=0.35875 
Train Epoch: 44 [221/1000 7072/32000 (22%)] Loss: 0.26238 (QuantReg: 12.87855) QuantErr: 12.87855 batch_time=0.46512 
Train Epoch: 44 [226/1000 7232/32000 (23%)] Loss: 0.23510 (QuantReg: 13.10009) QuantErr: 13.10009 batch_time=0.38598 
Train Epoch: 44 [231/1000 7392/32000 (23%)] Loss: 0.31760 (QuantReg: 12.83418) QuantErr: 12.83418 batch_time=0.35100 
Train Epoch: 44 [236/1000 7552/32000 (24%)] Loss: 0.11474 (QuantReg: 12.11893) QuantErr: 12.11893 batch_time=0.36106 
Train Epoch: 44 [241/1000 7712/32000 (24%)] Loss: 0.27279 (QuantReg: 13.22694) QuantErr: 13.22694 batch_time=0.39178 
Train Epoch: 44 [246/1000 7872/32000 (25%)] Loss: 0.13133 (QuantReg: 12.93116) QuantErr: 12.93116 batch_time=0.41005 
Train Epoch: 44 [251/1000 8032/32000 (25%)] Loss: 0.26456 (QuantReg: 12.31144) QuantErr: 12.31144 batch_time=0.46445 
Train Epoch: 44 [256/1000 8192/32000 (26%)] Loss: 0.10349 (QuantReg: 12.71449) QuantErr: 12.71449 batch_time=0.44902 
Train Epoch: 44 [261/1000 8352/32000 (26%)] Loss: 0.34933 (QuantReg: 12.80806) QuantErr: 12.80806 batch_time=0.36822 
Train Epoch: 44 [266/1000 8512/32000 (27%)] Loss: 0.15747 (QuantReg: 12.89436) QuantErr: 12.89436 batch_time=0.45867 
Train Epoch: 44 [271/1000 8672/32000 (27%)] Loss: 0.37238 (QuantReg: 13.48047) QuantErr: 13.48047 batch_time=0.40046 
Train Epoch: 44 [276/1000 8832/32000 (28%)] Loss: 0.34655 (QuantReg: 12.68488) QuantErr: 12.68488 batch_time=0.36457 
Train Epoch: 44 [281/1000 8992/32000 (28%)] Loss: 0.31305 (QuantReg: 12.98089) QuantErr: 12.98089 batch_time=0.35901 
Train Epoch: 44 [286/1000 9152/32000 (29%)] Loss: 0.17905 (QuantReg: 13.04064) QuantErr: 13.04064 batch_time=0.35022 
Train Epoch: 44 [291/1000 9312/32000 (29%)] Loss: 0.24684 (QuantReg: 13.56405) QuantErr: 13.56405 batch_time=0.35698 
Train Epoch: 44 [296/1000 9472/32000 (30%)] Loss: 0.25294 (QuantReg: 12.90930) QuantErr: 12.90930 batch_time=0.38077 
Train Epoch: 44 [301/1000 9632/32000 (30%)] Loss: 0.29856 (QuantReg: 12.89061) QuantErr: 12.89061 batch_time=0.39732 
Train Epoch: 44 [306/1000 9792/32000 (31%)] Loss: 0.41495 (QuantReg: 12.66749) QuantErr: 12.66749 batch_time=0.38273 
Train Epoch: 44 [311/1000 9952/32000 (31%)] Loss: 0.16090 (QuantReg: 12.48514) QuantErr: 12.48514 batch_time=0.36611 
Train Epoch: 44 [316/1000 10112/32000 (32%)] Loss: 0.24570 (QuantReg: 13.03647) QuantErr: 13.03647 batch_time=0.41742 
Train Epoch: 44 [321/1000 10272/32000 (32%)] Loss: 0.40954 (QuantReg: 12.95349) QuantErr: 12.95349 batch_time=0.43383 
Train Epoch: 44 [326/1000 10432/32000 (33%)] Loss: 0.15886 (QuantReg: 13.27505) QuantErr: 13.27505 batch_time=0.36862 
Train Epoch: 44 [331/1000 10592/32000 (33%)] Loss: 0.56408 (QuantReg: 12.59157) QuantErr: 12.59157 batch_time=0.41033 
Train Epoch: 44 [336/1000 10752/32000 (34%)] Loss: 0.28185 (QuantReg: 12.67010) QuantErr: 12.67010 batch_time=0.38974 
Train Epoch: 44 [341/1000 10912/32000 (34%)] Loss: 0.17586 (QuantReg: 13.00004) QuantErr: 13.00004 batch_time=0.35078 
Train Epoch: 44 [346/1000 11072/32000 (35%)] Loss: 0.24192 (QuantReg: 12.80337) QuantErr: 12.80337 batch_time=0.34937 
Train Epoch: 44 [351/1000 11232/32000 (35%)] Loss: 0.05611 (QuantReg: 12.94553) QuantErr: 12.94553 batch_time=0.39106 
Train Epoch: 44 [356/1000 11392/32000 (36%)] Loss: 0.32831 (QuantReg: 13.24824) QuantErr: 13.24824 batch_time=0.37207 
Train Epoch: 44 [361/1000 11552/32000 (36%)] Loss: 0.33164 (QuantReg: 12.42543) QuantErr: 12.42543 batch_time=0.35966 
Train Epoch: 44 [366/1000 11712/32000 (37%)] Loss: 0.24736 (QuantReg: 12.69410) QuantErr: 12.69410 batch_time=0.37301 
Train Epoch: 44 [371/1000 11872/32000 (37%)] Loss: 0.36549 (QuantReg: 13.09176) QuantErr: 13.09176 batch_time=0.41332 
Train Epoch: 44 [376/1000 12032/32000 (38%)] Loss: 0.66198 (QuantReg: 12.91688) QuantErr: 12.91688 batch_time=0.40081 
Train Epoch: 44 [381/1000 12192/32000 (38%)] Loss: 0.12367 (QuantReg: 12.93752) QuantErr: 12.93752 batch_time=0.35395 
Train Epoch: 44 [386/1000 12352/32000 (39%)] Loss: 0.21379 (QuantReg: 12.68748) QuantErr: 12.68748 batch_time=0.60386 
Train Epoch: 44 [391/1000 12512/32000 (39%)] Loss: 0.62722 (QuantReg: 12.37236) QuantErr: 12.37236 batch_time=0.47330 
Train Epoch: 44 [396/1000 12672/32000 (40%)] Loss: 0.58753 (QuantReg: 12.72329) QuantErr: 12.72329 batch_time=0.37290 
Train Epoch: 44 [401/1000 12832/32000 (40%)] Loss: 0.21057 (QuantReg: 12.75894) QuantErr: 12.75894 batch_time=0.35940 
Train Epoch: 44 [406/1000 12992/32000 (41%)] Loss: 0.17176 (QuantReg: 13.11623) QuantErr: 13.11623 batch_time=0.36866 
Train Epoch: 44 [411/1000 13152/32000 (41%)] Loss: 0.19140 (QuantReg: 13.08325) QuantErr: 13.08325 batch_time=0.36869 
Train Epoch: 44 [416/1000 13312/32000 (42%)] Loss: 0.24995 (QuantReg: 12.84001) QuantErr: 12.84001 batch_time=0.35381 
Train Epoch: 44 [421/1000 13472/32000 (42%)] Loss: 0.22978 (QuantReg: 13.32539) QuantErr: 13.32539 batch_time=0.35744 
Train Epoch: 44 [426/1000 13632/32000 (43%)] Loss: 0.32295 (QuantReg: 13.15144) QuantErr: 13.15144 batch_time=0.38147 
Train Epoch: 44 [431/1000 13792/32000 (43%)] Loss: 0.29852 (QuantReg: 13.09379) QuantErr: 13.09379 batch_time=0.43004 
Train Epoch: 44 [436/1000 13952/32000 (44%)] Loss: 0.04413 (QuantReg: 12.98916) QuantErr: 12.98916 batch_time=0.47142 
Train Epoch: 44 [441/1000 14112/32000 (44%)] Loss: 0.39012 (QuantReg: 12.97019) QuantErr: 12.97019 batch_time=0.38589 
Train Epoch: 44 [446/1000 14272/32000 (45%)] Loss: 0.16661 (QuantReg: 12.83380) QuantErr: 12.83380 batch_time=0.41421 
Train Epoch: 44 [451/1000 14432/32000 (45%)] Loss: 0.23323 (QuantReg: 13.00754) QuantErr: 13.00754 batch_time=0.42222 
Train Epoch: 44 [456/1000 14592/32000 (46%)] Loss: 0.25981 (QuantReg: 12.77862) QuantErr: 12.77862 batch_time=0.38273 
Train Epoch: 44 [461/1000 14752/32000 (46%)] Loss: 0.39532 (QuantReg: 13.00985) QuantErr: 13.00985 batch_time=0.36079 
Train Epoch: 44 [466/1000 14912/32000 (47%)] Loss: 0.25312 (QuantReg: 12.81675) QuantErr: 12.81675 batch_time=2.12834 
Train Epoch: 44 [471/1000 15072/32000 (47%)] Loss: 0.25884 (QuantReg: 13.31113) QuantErr: 13.31113 batch_time=0.36197 
Train Epoch: 44 [476/1000 15232/32000 (48%)] Loss: 0.30818 (QuantReg: 12.91907) QuantErr: 12.91907 batch_time=0.41772 
Train Epoch: 44 [481/1000 15392/32000 (48%)] Loss: 0.24868 (QuantReg: 12.95918) QuantErr: 12.95918 batch_time=0.41966 
Train Epoch: 44 [486/1000 15552/32000 (49%)] Loss: 0.13332 (QuantReg: 12.93624) QuantErr: 12.93624 batch_time=0.35656 
Train Epoch: 44 [491/1000 15712/32000 (49%)] Loss: 0.36220 (QuantReg: 13.36876) QuantErr: 13.36876 batch_time=0.37345 
Train Epoch: 44 [496/1000 15872/32000 (50%)] Loss: 0.11416 (QuantReg: 12.74950) QuantErr: 12.74950 batch_time=0.35508 
Train Epoch: 44 [501/1000 16032/32000 (50%)] Loss: 0.23670 (QuantReg: 13.08842) QuantErr: 13.08842 batch_time=0.36700 
Train Epoch: 44 [506/1000 16192/32000 (51%)] Loss: 0.13397 (QuantReg: 12.68031) QuantErr: 12.68031 batch_time=0.36416 
Train Epoch: 44 [511/1000 16352/32000 (51%)] Loss: 0.09450 (QuantReg: 12.83697) QuantErr: 12.83697 batch_time=0.36220 
Train Epoch: 44 [516/1000 16512/32000 (52%)] Loss: 0.27306 (QuantReg: 13.09104) QuantErr: 13.09104 batch_time=0.34806 
Train Epoch: 44 [521/1000 16672/32000 (52%)] Loss: 0.18793 (QuantReg: 12.97590) QuantErr: 12.97590 batch_time=0.35060 
Train Epoch: 44 [526/1000 16832/32000 (53%)] Loss: 0.15303 (QuantReg: 12.99718) QuantErr: 12.99718 batch_time=0.36138 
Train Epoch: 44 [531/1000 16992/32000 (53%)] Loss: 0.20655 (QuantReg: 12.90388) QuantErr: 12.90388 batch_time=0.35060 
Train Epoch: 44 [536/1000 17152/32000 (54%)] Loss: 0.15703 (QuantReg: 13.27398) QuantErr: 13.27398 batch_time=0.36631 
Train Epoch: 44 [541/1000 17312/32000 (54%)] Loss: 0.28275 (QuantReg: 12.46815) QuantErr: 12.46815 batch_time=0.35996 
Train Epoch: 44 [546/1000 17472/32000 (55%)] Loss: 0.29399 (QuantReg: 12.77324) QuantErr: 12.77324 batch_time=0.41100 
Train Epoch: 44 [551/1000 17632/32000 (55%)] Loss: 0.24111 (QuantReg: 13.12769) QuantErr: 13.12769 batch_time=0.46172 
Train Epoch: 44 [556/1000 17792/32000 (56%)] Loss: 0.24171 (QuantReg: 12.62285) QuantErr: 12.62285 batch_time=0.37054 
Train Epoch: 44 [561/1000 17952/32000 (56%)] Loss: 0.41924 (QuantReg: 13.30371) QuantErr: 13.30371 batch_time=0.38883 
Train Epoch: 44 [566/1000 18112/32000 (57%)] Loss: 0.25334 (QuantReg: 12.53769) QuantErr: 12.53769 batch_time=0.41564 
Train Epoch: 44 [571/1000 18272/32000 (57%)] Loss: 0.22479 (QuantReg: 12.44632) QuantErr: 12.44632 batch_time=0.37857 
Train Epoch: 44 [576/1000 18432/32000 (58%)] Loss: 0.25342 (QuantReg: 12.63701) QuantErr: 12.63701 batch_time=0.41398 
Train Epoch: 44 [581/1000 18592/32000 (58%)] Loss: 0.34457 (QuantReg: 12.32356) QuantErr: 12.32356 batch_time=0.35788 
Train Epoch: 44 [586/1000 18752/32000 (59%)] Loss: 0.13495 (QuantReg: 12.68543) QuantErr: 12.68543 batch_time=0.37512 
Train Epoch: 44 [591/1000 18912/32000 (59%)] Loss: 0.36595 (QuantReg: 12.96294) QuantErr: 12.96294 batch_time=0.41434 
Train Epoch: 44 [596/1000 19072/32000 (60%)] Loss: 0.36203 (QuantReg: 13.03151) QuantErr: 13.03151 batch_time=0.36167 
Train Epoch: 44 [601/1000 19232/32000 (60%)] Loss: 0.20259 (QuantReg: 12.71399) QuantErr: 12.71399 batch_time=0.41010 
Train Epoch: 44 [606/1000 19392/32000 (61%)] Loss: 0.10147 (QuantReg: 12.85167) QuantErr: 12.85167 batch_time=0.40607 
Train Epoch: 44 [611/1000 19552/32000 (61%)] Loss: 0.44346 (QuantReg: 11.95354) QuantErr: 11.95354 batch_time=0.36251 
Train Epoch: 44 [616/1000 19712/32000 (62%)] Loss: 0.41559 (QuantReg: 13.06627) QuantErr: 13.06627 batch_time=0.36512 
Train Epoch: 44 [621/1000 19872/32000 (62%)] Loss: 0.33196 (QuantReg: 13.08103) QuantErr: 13.08103 batch_time=0.37826 
Train Epoch: 44 [626/1000 20032/32000 (63%)] Loss: 0.29745 (QuantReg: 12.72959) QuantErr: 12.72959 batch_time=0.35321 
Train Epoch: 44 [631/1000 20192/32000 (63%)] Loss: 0.55422 (QuantReg: 12.86741) QuantErr: 12.86741 batch_time=0.40064 
Train Epoch: 44 [636/1000 20352/32000 (64%)] Loss: 0.25089 (QuantReg: 13.03239) QuantErr: 13.03239 batch_time=0.41474 
Train Epoch: 44 [641/1000 20512/32000 (64%)] Loss: 0.36554 (QuantReg: 12.65566) QuantErr: 12.65566 batch_time=0.42974 
Train Epoch: 44 [646/1000 20672/32000 (65%)] Loss: 0.59788 (QuantReg: 12.66925) QuantErr: 12.66925 batch_time=0.36650 
Train Epoch: 44 [651/1000 20832/32000 (65%)] Loss: 0.24205 (QuantReg: 12.38932) QuantErr: 12.38932 batch_time=0.37428 
Train Epoch: 44 [656/1000 20992/32000 (66%)] Loss: 0.16158 (QuantReg: 12.60714) QuantErr: 12.60714 batch_time=0.40814 
Train Epoch: 44 [661/1000 21152/32000 (66%)] Loss: 0.20345 (QuantReg: 12.98473) QuantErr: 12.98473 batch_time=0.35486 
Train Epoch: 44 [666/1000 21312/32000 (67%)] Loss: 0.31542 (QuantReg: 12.86679) QuantErr: 12.86679 batch_time=0.35712 
Train Epoch: 44 [671/1000 21472/32000 (67%)] Loss: 0.28820 (QuantReg: 12.82160) QuantErr: 12.82160 batch_time=0.35179 
Train Epoch: 44 [676/1000 21632/32000 (68%)] Loss: 0.16677 (QuantReg: 12.59502) QuantErr: 12.59502 batch_time=0.35184 
Train Epoch: 44 [681/1000 21792/32000 (68%)] Loss: 0.27028 (QuantReg: 13.41346) QuantErr: 13.41346 batch_time=0.36330 
Train Epoch: 44 [686/1000 21952/32000 (69%)] Loss: 0.17655 (QuantReg: 12.90788) QuantErr: 12.90788 batch_time=0.37026 
Train Epoch: 44 [691/1000 22112/32000 (69%)] Loss: 0.12232 (QuantReg: 12.90351) QuantErr: 12.90351 batch_time=0.39267 
Train Epoch: 44 [696/1000 22272/32000 (70%)] Loss: 0.49907 (QuantReg: 12.02684) QuantErr: 12.02684 batch_time=0.41804 
Train Epoch: 44 [701/1000 22432/32000 (70%)] Loss: 0.11004 (QuantReg: 12.78054) QuantErr: 12.78054 batch_time=0.37819 
Train Epoch: 44 [706/1000 22592/32000 (71%)] Loss: 0.47786 (QuantReg: 12.39804) QuantErr: 12.39804 batch_time=0.65876 
Train Epoch: 44 [711/1000 22752/32000 (71%)] Loss: 0.21378 (QuantReg: 12.49868) QuantErr: 12.49868 batch_time=0.41986 
Train Epoch: 44 [716/1000 22912/32000 (72%)] Loss: 0.29646 (QuantReg: 13.41320) QuantErr: 13.41320 batch_time=0.37483 
Train Epoch: 44 [721/1000 23072/32000 (72%)] Loss: 0.42198 (QuantReg: 12.72820) QuantErr: 12.72820 batch_time=0.39427 
Train Epoch: 44 [726/1000 23232/32000 (73%)] Loss: 0.34202 (QuantReg: 13.12180) QuantErr: 13.12180 batch_time=0.37599 
Train Epoch: 44 [731/1000 23392/32000 (73%)] Loss: 0.32784 (QuantReg: 12.72470) QuantErr: 12.72470 batch_time=0.36044 
Train Epoch: 44 [736/1000 23552/32000 (74%)] Loss: 0.26323 (QuantReg: 12.98800) QuantErr: 12.98800 batch_time=0.39496 
Train Epoch: 44 [741/1000 23712/32000 (74%)] Loss: 0.45005 (QuantReg: 13.07073) QuantErr: 13.07073 batch_time=0.37973 
Train Epoch: 44 [746/1000 23872/32000 (75%)] Loss: 0.19541 (QuantReg: 13.33562) QuantErr: 13.33562 batch_time=0.43552 
Train Epoch: 44 [751/1000 24032/32000 (75%)] Loss: 0.62822 (QuantReg: 12.25265) QuantErr: 12.25265 batch_time=0.36197 
Train Epoch: 44 [756/1000 24192/32000 (76%)] Loss: 0.47315 (QuantReg: 12.79679) QuantErr: 12.79679 batch_time=0.45543 
Train Epoch: 44 [761/1000 24352/32000 (76%)] Loss: 0.27072 (QuantReg: 13.67865) QuantErr: 13.67865 batch_time=0.35000 
Train Epoch: 44 [766/1000 24512/32000 (77%)] Loss: 0.64675 (QuantReg: 12.69113) QuantErr: 12.69113 batch_time=0.42797 
Train Epoch: 44 [771/1000 24672/32000 (77%)] Loss: 0.60089 (QuantReg: 13.04965) QuantErr: 13.04965 batch_time=0.46158 
Train Epoch: 44 [776/1000 24832/32000 (78%)] Loss: 0.18866 (QuantReg: 13.00542) QuantErr: 13.00542 batch_time=0.38187 
Train Epoch: 44 [781/1000 24992/32000 (78%)] Loss: 0.28082 (QuantReg: 12.74821) QuantErr: 12.74821 batch_time=0.41734 
Train Epoch: 44 [786/1000 25152/32000 (79%)] Loss: 0.63834 (QuantReg: 12.95915) QuantErr: 12.95915 batch_time=2.10333 
Train Epoch: 44 [791/1000 25312/32000 (79%)] Loss: 0.35179 (QuantReg: 11.70035) QuantErr: 11.70035 batch_time=0.45302 
Train Epoch: 44 [796/1000 25472/32000 (80%)] Loss: 0.68556 (QuantReg: 12.91176) QuantErr: 12.91176 batch_time=0.39051 
Train Epoch: 44 [801/1000 25632/32000 (80%)] Loss: 0.22231 (QuantReg: 12.98786) QuantErr: 12.98786 batch_time=0.44305 
Train Epoch: 44 [806/1000 25792/32000 (81%)] Loss: 0.26979 (QuantReg: 12.58351) QuantErr: 12.58351 batch_time=0.35713 
Train Epoch: 44 [811/1000 25952/32000 (81%)] Loss: 0.40723 (QuantReg: 12.69324) QuantErr: 12.69324 batch_time=0.41179 
Train Epoch: 44 [816/1000 26112/32000 (82%)] Loss: 0.39331 (QuantReg: 13.05919) QuantErr: 13.05919 batch_time=0.37483 
Train Epoch: 44 [821/1000 26272/32000 (82%)] Loss: 0.22054 (QuantReg: 13.00200) QuantErr: 13.00200 batch_time=0.37325 
Train Epoch: 44 [826/1000 26432/32000 (83%)] Loss: 0.20727 (QuantReg: 12.84573) QuantErr: 12.84573 batch_time=0.40096 
Train Epoch: 44 [831/1000 26592/32000 (83%)] Loss: 0.35498 (QuantReg: 12.72885) QuantErr: 12.72885 batch_time=0.36144 
Train Epoch: 44 [836/1000 26752/32000 (84%)] Loss: 0.21597 (QuantReg: 13.64331) QuantErr: 13.64331 batch_time=0.38821 
Train Epoch: 44 [841/1000 26912/32000 (84%)] Loss: 0.32616 (QuantReg: 13.33055) QuantErr: 13.33055 batch_time=0.38438 
Train Epoch: 44 [846/1000 27072/32000 (85%)] Loss: 0.27845 (QuantReg: 13.08657) QuantErr: 13.08657 batch_time=0.40852 
Train Epoch: 44 [851/1000 27232/32000 (85%)] Loss: 0.26843 (QuantReg: 12.96980) QuantErr: 12.96980 batch_time=0.41217 
Train Epoch: 44 [856/1000 27392/32000 (86%)] Loss: 0.31603 (QuantReg: 13.41278) QuantErr: 13.41278 batch_time=0.35420 
Train Epoch: 44 [861/1000 27552/32000 (86%)] Loss: 0.28285 (QuantReg: 12.88120) QuantErr: 12.88120 batch_time=0.35707 
Train Epoch: 44 [866/1000 27712/32000 (87%)] Loss: 0.17442 (QuantReg: 13.47944) QuantErr: 13.47944 batch_time=0.35353 
Train Epoch: 44 [871/1000 27872/32000 (87%)] Loss: 0.15454 (QuantReg: 13.13207) QuantErr: 13.13207 batch_time=0.35536 
Train Epoch: 44 [876/1000 28032/32000 (88%)] Loss: 0.24118 (QuantReg: 13.41823) QuantErr: 13.41823 batch_time=0.35697 
Train Epoch: 44 [881/1000 28192/32000 (88%)] Loss: 0.27478 (QuantReg: 12.94118) QuantErr: 12.94118 batch_time=0.36150 
Train Epoch: 44 [886/1000 28352/32000 (89%)] Loss: 0.19264 (QuantReg: 12.83112) QuantErr: 12.83112 batch_time=0.37826 
Train Epoch: 44 [891/1000 28512/32000 (89%)] Loss: 0.47293 (QuantReg: 13.23445) QuantErr: 13.23445 batch_time=0.35932 
Train Epoch: 44 [896/1000 28672/32000 (90%)] Loss: 0.13206 (QuantReg: 13.47356) QuantErr: 13.47356 batch_time=0.42080 
Train Epoch: 44 [901/1000 28832/32000 (90%)] Loss: 0.19047 (QuantReg: 12.80407) QuantErr: 12.80407 batch_time=0.38273 
Train Epoch: 44 [906/1000 28992/32000 (91%)] Loss: 0.24295 (QuantReg: 13.30892) QuantErr: 13.30892 batch_time=0.36106 
Train Epoch: 44 [911/1000 29152/32000 (91%)] Loss: 0.23431 (QuantReg: 13.03110) QuantErr: 13.03110 batch_time=0.42023 
Train Epoch: 44 [916/1000 29312/32000 (92%)] Loss: 0.13801 (QuantReg: 13.32476) QuantErr: 13.32476 batch_time=0.40083 
Train Epoch: 44 [921/1000 29472/32000 (92%)] Loss: 0.17520 (QuantReg: 13.05168) QuantErr: 13.05168 batch_time=0.46431 
Train Epoch: 44 [926/1000 29632/32000 (93%)] Loss: 0.27072 (QuantReg: 13.17043) QuantErr: 13.17043 batch_time=0.34932 
Train Epoch: 44 [931/1000 29792/32000 (93%)] Loss: 0.36959 (QuantReg: 13.02533) QuantErr: 13.02533 batch_time=0.36525 
Train Epoch: 44 [936/1000 29952/32000 (94%)] Loss: 0.36734 (QuantReg: 12.28825) QuantErr: 12.28825 batch_time=0.35879 
Train Epoch: 44 [941/1000 30112/32000 (94%)] Loss: 0.23640 (QuantReg: 12.87403) QuantErr: 12.87403 batch_time=0.35754 
Train Epoch: 44 [946/1000 30272/32000 (95%)] Loss: 0.10200 (QuantReg: 13.43160) QuantErr: 13.43160 batch_time=0.35972 
Train Epoch: 44 [951/1000 30432/32000 (95%)] Loss: 0.29326 (QuantReg: 13.13618) QuantErr: 13.13618 batch_time=0.34924 
Train Epoch: 44 [956/1000 30592/32000 (96%)] Loss: 0.44426 (QuantReg: 13.27454) QuantErr: 13.27454 batch_time=0.35435 
Train Epoch: 44 [961/1000 30752/32000 (96%)] Loss: 0.38136 (QuantReg: 12.00584) QuantErr: 12.00584 batch_time=0.45807 
Train Epoch: 44 [966/1000 30912/32000 (97%)] Loss: 0.25062 (QuantReg: 13.27371) QuantErr: 13.27371 batch_time=0.42034 
Train Epoch: 44 [971/1000 31072/32000 (97%)] Loss: 0.47409 (QuantReg: 12.60720) QuantErr: 12.60720 batch_time=0.37379 
Train Epoch: 44 [976/1000 31232/32000 (98%)] Loss: 0.42141 (QuantReg: 13.27151) QuantErr: 13.27151 batch_time=0.36876 
Train Epoch: 44 [981/1000 31392/32000 (98%)] Loss: 0.17973 (QuantReg: 12.86784) QuantErr: 12.86784 batch_time=0.36609 
Train Epoch: 44 [986/1000 31552/32000 (99%)] Loss: 0.14681 (QuantReg: 12.85927) QuantErr: 12.85927 batch_time=0.40545 
Train Epoch: 44 [991/1000 31712/32000 (99%)] Loss: 0.14339 (QuantReg: 13.21625) QuantErr: 13.21625 batch_time=0.36273 
Train Epoch: 44 [996/1000 31872/32000 (100%)] Loss: 0.06843 (QuantReg: 12.90916) QuantErr: 12.90916 batch_time=0.38391 
Train Epoch: 44 codebook_update_time=1.75860
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch44.pth ...
Done in 4.311s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 0.29836134980246426
 quant_reg      : 12.906641412734986
 quant_err      : 12.906641412734986
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 44000
 MSRVTT_full_val/t2v_metrics/R1: 29.77867203219316
 MSRVTT_full_val/t2v_metrics/R5: 70.82494969818913
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.51106639839034
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.64426566449805
 MSRVTT_full_val/v2t_metrics/R1: 37.02213279678068
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.078470824949698
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.83269925007434
 MSRVTT_full_test/t2v_metrics/R1: 13.177257525083611
 MSRVTT_full_test/t2v_metrics/R5: 37.65886287625418
 MSRVTT_full_test/t2v_metrics/R10: 51.103678929765884
 MSRVTT_full_test/t2v_metrics/R50: 80.63545150501672
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.20334448160535
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.37975256558975
 MSRVTT_full_test/v2t_metrics/R1: 16.555183946488295
 MSRVTT_full_test/v2t_metrics/R5: 43.67892976588629
 MSRVTT_full_test/v2t_metrics/R10: 58.62876254180602
 MSRVTT_full_test/v2t_metrics/R50: 87.05685618729098
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.092976588628762
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.868953149430965
 mnt_best       : 29.457786902921846
 not_improved_count: 2
Train Epoch: 45 [1/1000 32/32000 (0%)] Loss: 0.15541 (QuantReg: 12.93312) QuantErr: 12.93312 batch_time=27.29683 
Train Epoch: 45 [6/1000 192/32000 (1%)] Loss: 0.52688 (QuantReg: 12.57151) QuantErr: 12.57151 batch_time=0.41834 
Train Epoch: 45 [11/1000 352/32000 (1%)] Loss: 0.38867 (QuantReg: 12.67493) QuantErr: 12.67493 batch_time=0.43673 
Train Epoch: 45 [16/1000 512/32000 (2%)] Loss: 0.26360 (QuantReg: 12.53927) QuantErr: 12.53927 batch_time=0.40269 
Train Epoch: 45 [21/1000 672/32000 (2%)] Loss: 0.16914 (QuantReg: 12.85140) QuantErr: 12.85140 batch_time=0.69186 
Train Epoch: 45 [26/1000 832/32000 (3%)] Loss: 0.17252 (QuantReg: 13.46706) QuantErr: 13.46706 batch_time=0.34631 
Train Epoch: 45 [31/1000 992/32000 (3%)] Loss: 0.20184 (QuantReg: 12.55729) QuantErr: 12.55729 batch_time=0.78934 
Train Epoch: 45 [36/1000 1152/32000 (4%)] Loss: 0.25622 (QuantReg: 12.84964) QuantErr: 12.84964 batch_time=0.34603 
Train Epoch: 45 [41/1000 1312/32000 (4%)] Loss: 0.20124 (QuantReg: 12.89293) QuantErr: 12.89293 batch_time=0.35672 
Train Epoch: 45 [46/1000 1472/32000 (5%)] Loss: 0.24500 (QuantReg: 13.36219) QuantErr: 13.36219 batch_time=0.34857 
Train Epoch: 45 [51/1000 1632/32000 (5%)] Loss: 0.74493 (QuantReg: 12.99255) QuantErr: 12.99255 batch_time=0.36977 
Train Epoch: 45 [56/1000 1792/32000 (6%)] Loss: 0.12460 (QuantReg: 12.53755) QuantErr: 12.53755 batch_time=0.42449 
Train Epoch: 45 [61/1000 1952/32000 (6%)] Loss: 0.15591 (QuantReg: 12.88144) QuantErr: 12.88144 batch_time=0.34679 
Train Epoch: 45 [66/1000 2112/32000 (7%)] Loss: 0.35071 (QuantReg: 13.39190) QuantErr: 13.39190 batch_time=0.59602 
Train Epoch: 45 [71/1000 2272/32000 (7%)] Loss: 0.12248 (QuantReg: 12.94416) QuantErr: 12.94416 batch_time=0.35053 
Train Epoch: 45 [76/1000 2432/32000 (8%)] Loss: 0.15642 (QuantReg: 12.72718) QuantErr: 12.72718 batch_time=0.37407 
Train Epoch: 45 [81/1000 2592/32000 (8%)] Loss: 0.86788 (QuantReg: 12.44655) QuantErr: 12.44655 batch_time=0.40348 
Train Epoch: 45 [86/1000 2752/32000 (9%)] Loss: 0.08309 (QuantReg: 12.58825) QuantErr: 12.58825 batch_time=0.42961 
Train Epoch: 45 [91/1000 2912/32000 (9%)] Loss: 0.24282 (QuantReg: 13.20502) QuantErr: 13.20502 batch_time=0.44087 
Train Epoch: 45 [96/1000 3072/32000 (10%)] Loss: 0.62230 (QuantReg: 12.42991) QuantErr: 12.42991 batch_time=0.37663 
Train Epoch: 45 [101/1000 3232/32000 (10%)] Loss: 0.29693 (QuantReg: 13.09459) QuantErr: 13.09459 batch_time=0.42345 
Train Epoch: 45 [106/1000 3392/32000 (11%)] Loss: 0.21785 (QuantReg: 12.74881) QuantErr: 12.74881 batch_time=0.37544 
Train Epoch: 45 [111/1000 3552/32000 (11%)] Loss: 0.36545 (QuantReg: 13.15796) QuantErr: 13.15796 batch_time=0.35989 
Train Epoch: 45 [116/1000 3712/32000 (12%)] Loss: 0.37675 (QuantReg: 12.73559) QuantErr: 12.73559 batch_time=0.39291 
Train Epoch: 45 [121/1000 3872/32000 (12%)] Loss: 0.08351 (QuantReg: 12.76633) QuantErr: 12.76633 batch_time=0.39298 
Train Epoch: 45 [126/1000 4032/32000 (13%)] Loss: 0.06393 (QuantReg: 13.07087) QuantErr: 13.07087 batch_time=0.45285 
Train Epoch: 45 [131/1000 4192/32000 (13%)] Loss: 0.23645 (QuantReg: 13.26648) QuantErr: 13.26648 batch_time=0.52825 
Train Epoch: 45 [136/1000 4352/32000 (14%)] Loss: 0.28419 (QuantReg: 12.87685) QuantErr: 12.87685 batch_time=0.48969 
Train Epoch: 45 [141/1000 4512/32000 (14%)] Loss: 0.39528 (QuantReg: 12.55440) QuantErr: 12.55440 batch_time=0.47187 
Train Epoch: 45 [146/1000 4672/32000 (15%)] Loss: 0.10582 (QuantReg: 13.12580) QuantErr: 13.12580 batch_time=0.36729 
Train Epoch: 45 [151/1000 4832/32000 (15%)] Loss: 0.77999 (QuantReg: 12.03040) QuantErr: 12.03040 batch_time=0.43872 
Train Epoch: 45 [156/1000 4992/32000 (16%)] Loss: 0.23367 (QuantReg: 12.79116) QuantErr: 12.79116 batch_time=0.35997 
Train Epoch: 45 [161/1000 5152/32000 (16%)] Loss: 0.23615 (QuantReg: 12.59990) QuantErr: 12.59990 batch_time=0.38473 
Train Epoch: 45 [166/1000 5312/32000 (17%)] Loss: 0.59528 (QuantReg: 12.61764) QuantErr: 12.61764 batch_time=0.44381 
Train Epoch: 45 [171/1000 5472/32000 (17%)] Loss: 0.11516 (QuantReg: 12.95161) QuantErr: 12.95161 batch_time=0.43177 
Train Epoch: 45 [176/1000 5632/32000 (18%)] Loss: 0.53819 (QuantReg: 12.27305) QuantErr: 12.27305 batch_time=0.40007 
Train Epoch: 45 [181/1000 5792/32000 (18%)] Loss: 0.36827 (QuantReg: 13.08725) QuantErr: 13.08725 batch_time=0.37743 
Train Epoch: 45 [186/1000 5952/32000 (19%)] Loss: 0.09371 (QuantReg: 12.92323) QuantErr: 12.92323 batch_time=0.40271 
Train Epoch: 45 [191/1000 6112/32000 (19%)] Loss: 0.10171 (QuantReg: 12.65755) QuantErr: 12.65755 batch_time=0.39740 
Train Epoch: 45 [196/1000 6272/32000 (20%)] Loss: 0.52954 (QuantReg: 12.94243) QuantErr: 12.94243 batch_time=0.46384 
Train Epoch: 45 [201/1000 6432/32000 (20%)] Loss: 0.47391 (QuantReg: 13.31019) QuantErr: 13.31019 batch_time=1.19286 
Train Epoch: 45 [206/1000 6592/32000 (21%)] Loss: 0.13886 (QuantReg: 13.34497) QuantErr: 13.34497 batch_time=0.38538 
Train Epoch: 45 [211/1000 6752/32000 (21%)] Loss: 0.20052 (QuantReg: 12.41644) QuantErr: 12.41644 batch_time=0.42391 
Train Epoch: 45 [216/1000 6912/32000 (22%)] Loss: 0.29830 (QuantReg: 12.46527) QuantErr: 12.46527 batch_time=0.40005 
Train Epoch: 45 [221/1000 7072/32000 (22%)] Loss: 0.35381 (QuantReg: 12.29380) QuantErr: 12.29380 batch_time=0.45177 
Train Epoch: 45 [226/1000 7232/32000 (23%)] Loss: 0.29359 (QuantReg: 13.07290) QuantErr: 13.07290 batch_time=0.60285 
Train Epoch: 45 [231/1000 7392/32000 (23%)] Loss: 0.14028 (QuantReg: 12.72884) QuantErr: 12.72884 batch_time=0.42712 
Train Epoch: 45 [236/1000 7552/32000 (24%)] Loss: 0.16018 (QuantReg: 13.34689) QuantErr: 13.34689 batch_time=0.36545 
Train Epoch: 45 [241/1000 7712/32000 (24%)] Loss: 0.11958 (QuantReg: 12.86880) QuantErr: 12.86880 batch_time=0.40046 
Train Epoch: 45 [246/1000 7872/32000 (25%)] Loss: 0.39157 (QuantReg: 12.95778) QuantErr: 12.95778 batch_time=0.40021 
Train Epoch: 45 [251/1000 8032/32000 (25%)] Loss: 0.40387 (QuantReg: 13.21715) QuantErr: 13.21715 batch_time=0.37783 
Train Epoch: 45 [256/1000 8192/32000 (26%)] Loss: 0.29635 (QuantReg: 13.19209) QuantErr: 13.19209 batch_time=0.34914 
Train Epoch: 45 [261/1000 8352/32000 (26%)] Loss: 0.19370 (QuantReg: 13.18142) QuantErr: 13.18142 batch_time=0.34361 
Train Epoch: 45 [266/1000 8512/32000 (27%)] Loss: 0.37379 (QuantReg: 12.56525) QuantErr: 12.56525 batch_time=0.36688 
Train Epoch: 45 [271/1000 8672/32000 (27%)] Loss: 0.12190 (QuantReg: 13.46246) QuantErr: 13.46246 batch_time=0.35199 
Train Epoch: 45 [276/1000 8832/32000 (28%)] Loss: 0.23156 (QuantReg: 13.49629) QuantErr: 13.49629 batch_time=0.38236 
Train Epoch: 45 [281/1000 8992/32000 (28%)] Loss: 0.09988 (QuantReg: 12.99031) QuantErr: 12.99031 batch_time=0.36280 
Train Epoch: 45 [286/1000 9152/32000 (29%)] Loss: 0.11233 (QuantReg: 12.92405) QuantErr: 12.92405 batch_time=0.37035 
Train Epoch: 45 [291/1000 9312/32000 (29%)] Loss: 0.29784 (QuantReg: 13.42324) QuantErr: 13.42324 batch_time=0.34425 
Train Epoch: 45 [296/1000 9472/32000 (30%)] Loss: 0.18730 (QuantReg: 12.73733) QuantErr: 12.73733 batch_time=0.42053 
Train Epoch: 45 [301/1000 9632/32000 (30%)] Loss: 0.39879 (QuantReg: 13.16855) QuantErr: 13.16855 batch_time=0.41250 
Train Epoch: 45 [306/1000 9792/32000 (31%)] Loss: 0.50681 (QuantReg: 12.98639) QuantErr: 12.98639 batch_time=0.40638 
Train Epoch: 45 [311/1000 9952/32000 (31%)] Loss: 0.12638 (QuantReg: 13.36618) QuantErr: 13.36618 batch_time=0.42400 
Train Epoch: 45 [316/1000 10112/32000 (32%)] Loss: 0.10833 (QuantReg: 12.84081) QuantErr: 12.84081 batch_time=0.37261 
Train Epoch: 45 [321/1000 10272/32000 (32%)] Loss: 0.19282 (QuantReg: 13.33696) QuantErr: 13.33696 batch_time=0.44872 
Train Epoch: 45 [326/1000 10432/32000 (33%)] Loss: 0.30999 (QuantReg: 13.21625) QuantErr: 13.21625 batch_time=0.34949 
Train Epoch: 45 [331/1000 10592/32000 (33%)] Loss: 0.29268 (QuantReg: 11.93395) QuantErr: 11.93395 batch_time=0.39475 
Train Epoch: 45 [336/1000 10752/32000 (34%)] Loss: 0.36967 (QuantReg: 12.50733) QuantErr: 12.50733 batch_time=0.40873 
Train Epoch: 45 [341/1000 10912/32000 (34%)] Loss: 0.14513 (QuantReg: 13.45139) QuantErr: 13.45139 batch_time=0.75511 
Train Epoch: 45 [346/1000 11072/32000 (35%)] Loss: 0.18194 (QuantReg: 13.71100) QuantErr: 13.71100 batch_time=0.35818 
Train Epoch: 45 [351/1000 11232/32000 (35%)] Loss: 0.42146 (QuantReg: 13.34868) QuantErr: 13.34868 batch_time=0.73691 
Train Epoch: 45 [356/1000 11392/32000 (36%)] Loss: 0.20715 (QuantReg: 13.34626) QuantErr: 13.34626 batch_time=0.34472 
Train Epoch: 45 [361/1000 11552/32000 (36%)] Loss: 0.22519 (QuantReg: 13.26833) QuantErr: 13.26833 batch_time=0.34433 
Train Epoch: 45 [366/1000 11712/32000 (37%)] Loss: 0.17736 (QuantReg: 12.72542) QuantErr: 12.72542 batch_time=0.34709 
Train Epoch: 45 [371/1000 11872/32000 (37%)] Loss: 0.29264 (QuantReg: 13.16451) QuantErr: 13.16451 batch_time=0.37049 
Train Epoch: 45 [376/1000 12032/32000 (38%)] Loss: 0.19911 (QuantReg: 13.01525) QuantErr: 13.01525 batch_time=0.34979 
Train Epoch: 45 [381/1000 12192/32000 (38%)] Loss: 0.38357 (QuantReg: 12.80639) QuantErr: 12.80639 batch_time=0.34718 
Train Epoch: 45 [386/1000 12352/32000 (39%)] Loss: 0.19437 (QuantReg: 13.34153) QuantErr: 13.34153 batch_time=0.52860 
Train Epoch: 45 [391/1000 12512/32000 (39%)] Loss: 0.19568 (QuantReg: 12.63264) QuantErr: 12.63264 batch_time=0.34655 
Train Epoch: 45 [396/1000 12672/32000 (40%)] Loss: 0.25898 (QuantReg: 12.99693) QuantErr: 12.99693 batch_time=0.35307 
Train Epoch: 45 [401/1000 12832/32000 (40%)] Loss: 0.14257 (QuantReg: 13.13589) QuantErr: 13.13589 batch_time=0.36598 
Train Epoch: 45 [406/1000 12992/32000 (41%)] Loss: 0.67006 (QuantReg: 13.10841) QuantErr: 13.10841 batch_time=0.38546 
Train Epoch: 45 [411/1000 13152/32000 (41%)] Loss: 0.22250 (QuantReg: 13.42867) QuantErr: 13.42867 batch_time=0.34137 
Train Epoch: 45 [416/1000 13312/32000 (42%)] Loss: 0.11956 (QuantReg: 13.36986) QuantErr: 13.36986 batch_time=0.35171 
Train Epoch: 45 [421/1000 13472/32000 (42%)] Loss: 0.43920 (QuantReg: 13.09308) QuantErr: 13.09308 batch_time=0.42145 
Train Epoch: 45 [426/1000 13632/32000 (43%)] Loss: 0.39676 (QuantReg: 12.28875) QuantErr: 12.28875 batch_time=0.35580 
Train Epoch: 45 [431/1000 13792/32000 (43%)] Loss: 0.16438 (QuantReg: 12.42025) QuantErr: 12.42025 batch_time=0.49305 
Train Epoch: 45 [436/1000 13952/32000 (44%)] Loss: 0.22134 (QuantReg: 13.07506) QuantErr: 13.07506 batch_time=0.46171 
Train Epoch: 45 [441/1000 14112/32000 (44%)] Loss: 0.46877 (QuantReg: 12.81754) QuantErr: 12.81754 batch_time=0.45589 
Train Epoch: 45 [446/1000 14272/32000 (45%)] Loss: 0.69599 (QuantReg: 13.04479) QuantErr: 13.04479 batch_time=0.35759 
Train Epoch: 45 [451/1000 14432/32000 (45%)] Loss: 0.16169 (QuantReg: 12.65570) QuantErr: 12.65570 batch_time=0.49396 
Train Epoch: 45 [456/1000 14592/32000 (46%)] Loss: 0.30128 (QuantReg: 13.22773) QuantErr: 13.22773 batch_time=0.36326 
Train Epoch: 45 [461/1000 14752/32000 (46%)] Loss: 0.08062 (QuantReg: 12.88017) QuantErr: 12.88017 batch_time=0.43349 
Train Epoch: 45 [466/1000 14912/32000 (47%)] Loss: 0.38198 (QuantReg: 12.80268) QuantErr: 12.80268 batch_time=0.36799 
Train Epoch: 45 [471/1000 15072/32000 (47%)] Loss: 0.18221 (QuantReg: 13.16574) QuantErr: 13.16574 batch_time=0.51321 
Train Epoch: 45 [476/1000 15232/32000 (48%)] Loss: 0.18499 (QuantReg: 13.29480) QuantErr: 13.29480 batch_time=0.35913 
Train Epoch: 45 [481/1000 15392/32000 (48%)] Loss: 0.30124 (QuantReg: 12.71957) QuantErr: 12.71957 batch_time=0.44094 
Train Epoch: 45 [486/1000 15552/32000 (49%)] Loss: 0.22391 (QuantReg: 12.79253) QuantErr: 12.79253 batch_time=0.44809 
Train Epoch: 45 [491/1000 15712/32000 (49%)] Loss: 0.13434 (QuantReg: 12.95510) QuantErr: 12.95510 batch_time=0.42089 
Train Epoch: 45 [496/1000 15872/32000 (50%)] Loss: 0.06805 (QuantReg: 12.97651) QuantErr: 12.97651 batch_time=0.41126 
Train Epoch: 45 [501/1000 16032/32000 (50%)] Loss: 0.21516 (QuantReg: 12.75486) QuantErr: 12.75486 batch_time=0.40908 
Train Epoch: 45 [506/1000 16192/32000 (51%)] Loss: 0.45423 (QuantReg: 12.59738) QuantErr: 12.59738 batch_time=0.40133 
Train Epoch: 45 [511/1000 16352/32000 (51%)] Loss: 0.19233 (QuantReg: 13.58896) QuantErr: 13.58896 batch_time=0.37307 
Train Epoch: 45 [516/1000 16512/32000 (52%)] Loss: 0.30348 (QuantReg: 12.66977) QuantErr: 12.66977 batch_time=0.37568 
Train Epoch: 45 [521/1000 16672/32000 (52%)] Loss: 0.20437 (QuantReg: 12.95805) QuantErr: 12.95805 batch_time=1.10247 
Train Epoch: 45 [526/1000 16832/32000 (53%)] Loss: 0.25141 (QuantReg: 13.43162) QuantErr: 13.43162 batch_time=0.34547 
Train Epoch: 45 [531/1000 16992/32000 (53%)] Loss: 0.76557 (QuantReg: 13.53876) QuantErr: 13.53876 batch_time=0.34524 
Train Epoch: 45 [536/1000 17152/32000 (54%)] Loss: 0.09699 (QuantReg: 13.15693) QuantErr: 13.15693 batch_time=0.40429 
Train Epoch: 45 [541/1000 17312/32000 (54%)] Loss: 0.27980 (QuantReg: 12.82500) QuantErr: 12.82500 batch_time=0.38088 
Train Epoch: 45 [546/1000 17472/32000 (55%)] Loss: 0.32224 (QuantReg: 12.88874) QuantErr: 12.88874 batch_time=0.52447 
Train Epoch: 45 [551/1000 17632/32000 (55%)] Loss: 0.66347 (QuantReg: 12.72413) QuantErr: 12.72413 batch_time=0.38856 
Train Epoch: 45 [556/1000 17792/32000 (56%)] Loss: 0.70658 (QuantReg: 13.01614) QuantErr: 13.01614 batch_time=0.39126 
Train Epoch: 45 [561/1000 17952/32000 (56%)] Loss: 0.37155 (QuantReg: 12.52875) QuantErr: 12.52875 batch_time=0.34968 
Train Epoch: 45 [566/1000 18112/32000 (57%)] Loss: 0.06566 (QuantReg: 12.96308) QuantErr: 12.96308 batch_time=0.49976 
Train Epoch: 45 [571/1000 18272/32000 (57%)] Loss: 0.07508 (QuantReg: 13.03591) QuantErr: 13.03591 batch_time=0.41674 
Train Epoch: 45 [576/1000 18432/32000 (58%)] Loss: 0.17873 (QuantReg: 13.11147) QuantErr: 13.11147 batch_time=0.41544 
Train Epoch: 45 [581/1000 18592/32000 (58%)] Loss: 0.08571 (QuantReg: 13.12581) QuantErr: 13.12581 batch_time=0.39336 
Train Epoch: 45 [586/1000 18752/32000 (59%)] Loss: 0.28244 (QuantReg: 12.61235) QuantErr: 12.61235 batch_time=0.34909 
Train Epoch: 45 [591/1000 18912/32000 (59%)] Loss: 0.13765 (QuantReg: 13.80122) QuantErr: 13.80122 batch_time=0.36791 
Train Epoch: 45 [596/1000 19072/32000 (60%)] Loss: 0.12470 (QuantReg: 13.11213) QuantErr: 13.11213 batch_time=0.38803 
Train Epoch: 45 [601/1000 19232/32000 (60%)] Loss: 0.24893 (QuantReg: 13.24203) QuantErr: 13.24203 batch_time=0.39319 
Train Epoch: 45 [606/1000 19392/32000 (61%)] Loss: 0.23211 (QuantReg: 13.11527) QuantErr: 13.11527 batch_time=0.38545 
Train Epoch: 45 [611/1000 19552/32000 (61%)] Loss: 0.28557 (QuantReg: 12.66735) QuantErr: 12.66735 batch_time=0.36610 
Train Epoch: 45 [616/1000 19712/32000 (62%)] Loss: 0.27686 (QuantReg: 13.06207) QuantErr: 13.06207 batch_time=0.38313 
Train Epoch: 45 [621/1000 19872/32000 (62%)] Loss: 0.13276 (QuantReg: 12.89816) QuantErr: 12.89816 batch_time=0.42397 
Train Epoch: 45 [626/1000 20032/32000 (63%)] Loss: 0.18161 (QuantReg: 12.88600) QuantErr: 12.88600 batch_time=0.38807 
Train Epoch: 45 [631/1000 20192/32000 (63%)] Loss: 0.23550 (QuantReg: 12.99692) QuantErr: 12.99692 batch_time=0.39487 
Train Epoch: 45 [636/1000 20352/32000 (64%)] Loss: 0.19064 (QuantReg: 12.71145) QuantErr: 12.71145 batch_time=0.40389 
Train Epoch: 45 [641/1000 20512/32000 (64%)] Loss: 0.24936 (QuantReg: 12.73265) QuantErr: 12.73265 batch_time=0.36323 
Train Epoch: 45 [646/1000 20672/32000 (65%)] Loss: 0.47444 (QuantReg: 13.39366) QuantErr: 13.39366 batch_time=0.36461 
Train Epoch: 45 [651/1000 20832/32000 (65%)] Loss: 0.45466 (QuantReg: 12.36278) QuantErr: 12.36278 batch_time=0.36793 
Train Epoch: 45 [656/1000 20992/32000 (66%)] Loss: 0.13235 (QuantReg: 13.46756) QuantErr: 13.46756 batch_time=0.37170 
Train Epoch: 45 [661/1000 21152/32000 (66%)] Loss: 0.39531 (QuantReg: 13.03674) QuantErr: 13.03674 batch_time=0.68019 
Train Epoch: 45 [666/1000 21312/32000 (67%)] Loss: 0.24389 (QuantReg: 13.10493) QuantErr: 13.10493 batch_time=0.43344 
Train Epoch: 45 [671/1000 21472/32000 (67%)] Loss: 0.58277 (QuantReg: 11.96270) QuantErr: 11.96270 batch_time=0.76236 
Train Epoch: 45 [676/1000 21632/32000 (68%)] Loss: 0.27717 (QuantReg: 12.87078) QuantErr: 12.87078 batch_time=0.39511 
Train Epoch: 45 [681/1000 21792/32000 (68%)] Loss: 0.55560 (QuantReg: 13.14438) QuantErr: 13.14438 batch_time=0.36443 
Train Epoch: 45 [686/1000 21952/32000 (69%)] Loss: 0.09065 (QuantReg: 13.03504) QuantErr: 13.03504 batch_time=0.41503 
Train Epoch: 45 [691/1000 22112/32000 (69%)] Loss: 0.37737 (QuantReg: 12.74642) QuantErr: 12.74642 batch_time=0.38817 
Train Epoch: 45 [696/1000 22272/32000 (70%)] Loss: 0.11628 (QuantReg: 13.21877) QuantErr: 13.21877 batch_time=0.36885 
Train Epoch: 45 [701/1000 22432/32000 (70%)] Loss: 0.43092 (QuantReg: 12.99978) QuantErr: 12.99978 batch_time=0.46210 
Train Epoch: 45 [706/1000 22592/32000 (71%)] Loss: 0.13858 (QuantReg: 12.84607) QuantErr: 12.84607 batch_time=0.67942 
Train Epoch: 45 [711/1000 22752/32000 (71%)] Loss: 0.21547 (QuantReg: 12.90823) QuantErr: 12.90823 batch_time=0.39269 
Train Epoch: 45 [716/1000 22912/32000 (72%)] Loss: 0.20842 (QuantReg: 12.82983) QuantErr: 12.82983 batch_time=0.36135 
Train Epoch: 45 [721/1000 23072/32000 (72%)] Loss: 0.64996 (QuantReg: 12.42342) QuantErr: 12.42342 batch_time=0.35067 
Train Epoch: 45 [726/1000 23232/32000 (73%)] Loss: 0.62483 (QuantReg: 12.99259) QuantErr: 12.99259 batch_time=0.36083 
Train Epoch: 45 [731/1000 23392/32000 (73%)] Loss: 0.29402 (QuantReg: 13.81045) QuantErr: 13.81045 batch_time=0.38060 
Train Epoch: 45 [736/1000 23552/32000 (74%)] Loss: 0.24531 (QuantReg: 13.02115) QuantErr: 13.02115 batch_time=0.41059 
Train Epoch: 45 [741/1000 23712/32000 (74%)] Loss: 0.18534 (QuantReg: 13.04771) QuantErr: 13.04771 batch_time=0.37387 
Train Epoch: 45 [746/1000 23872/32000 (75%)] Loss: 0.24557 (QuantReg: 12.60071) QuantErr: 12.60071 batch_time=0.39276 
Train Epoch: 45 [751/1000 24032/32000 (75%)] Loss: 0.42183 (QuantReg: 13.46073) QuantErr: 13.46073 batch_time=0.41042 
Train Epoch: 45 [756/1000 24192/32000 (76%)] Loss: 0.14075 (QuantReg: 12.46229) QuantErr: 12.46229 batch_time=0.42246 
Train Epoch: 45 [761/1000 24352/32000 (76%)] Loss: 0.09946 (QuantReg: 12.24371) QuantErr: 12.24371 batch_time=0.38987 
Train Epoch: 45 [766/1000 24512/32000 (77%)] Loss: 0.32324 (QuantReg: 13.19632) QuantErr: 13.19632 batch_time=0.39803 
Train Epoch: 45 [771/1000 24672/32000 (77%)] Loss: 0.24680 (QuantReg: 13.01876) QuantErr: 13.01876 batch_time=0.52385 
Train Epoch: 45 [776/1000 24832/32000 (78%)] Loss: 0.32509 (QuantReg: 13.23573) QuantErr: 13.23573 batch_time=0.43118 
Train Epoch: 45 [781/1000 24992/32000 (78%)] Loss: 0.38122 (QuantReg: 13.09570) QuantErr: 13.09570 batch_time=0.38442 
Train Epoch: 45 [786/1000 25152/32000 (79%)] Loss: 0.30791 (QuantReg: 12.72577) QuantErr: 12.72577 batch_time=0.46232 
Train Epoch: 45 [791/1000 25312/32000 (79%)] Loss: 0.10141 (QuantReg: 12.92226) QuantErr: 12.92226 batch_time=0.53142 
Train Epoch: 45 [796/1000 25472/32000 (80%)] Loss: 0.34508 (QuantReg: 12.89198) QuantErr: 12.89198 batch_time=0.39088 
Train Epoch: 45 [801/1000 25632/32000 (80%)] Loss: 0.12656 (QuantReg: 12.83895) QuantErr: 12.83895 batch_time=0.43391 
Train Epoch: 45 [806/1000 25792/32000 (81%)] Loss: 0.12802 (QuantReg: 13.05176) QuantErr: 13.05176 batch_time=0.37243 
Train Epoch: 45 [811/1000 25952/32000 (81%)] Loss: 0.39540 (QuantReg: 12.46249) QuantErr: 12.46249 batch_time=0.38121 
Train Epoch: 45 [816/1000 26112/32000 (82%)] Loss: 0.33304 (QuantReg: 12.97707) QuantErr: 12.97707 batch_time=0.36737 
Train Epoch: 45 [821/1000 26272/32000 (82%)] Loss: 0.13437 (QuantReg: 13.27825) QuantErr: 13.27825 batch_time=0.34708 
Train Epoch: 45 [826/1000 26432/32000 (83%)] Loss: 0.13300 (QuantReg: 13.30949) QuantErr: 13.30949 batch_time=0.35080 
Train Epoch: 45 [831/1000 26592/32000 (83%)] Loss: 0.16874 (QuantReg: 13.20372) QuantErr: 13.20372 batch_time=0.34243 
Train Epoch: 45 [836/1000 26752/32000 (84%)] Loss: 0.32978 (QuantReg: 13.06265) QuantErr: 13.06265 batch_time=0.40357 
Train Epoch: 45 [841/1000 26912/32000 (84%)] Loss: 0.15003 (QuantReg: 13.38231) QuantErr: 13.38231 batch_time=1.23356 
Train Epoch: 45 [846/1000 27072/32000 (85%)] Loss: 0.22442 (QuantReg: 13.09547) QuantErr: 13.09547 batch_time=0.40466 
Train Epoch: 45 [851/1000 27232/32000 (85%)] Loss: 0.30402 (QuantReg: 13.07876) QuantErr: 13.07876 batch_time=0.40165 
Train Epoch: 45 [856/1000 27392/32000 (86%)] Loss: 0.22876 (QuantReg: 13.57088) QuantErr: 13.57088 batch_time=0.46428 
Train Epoch: 45 [861/1000 27552/32000 (86%)] Loss: 0.23062 (QuantReg: 12.95754) QuantErr: 12.95754 batch_time=0.46553 
Train Epoch: 45 [866/1000 27712/32000 (87%)] Loss: 0.33380 (QuantReg: 13.20364) QuantErr: 13.20364 batch_time=0.53285 
Train Epoch: 45 [871/1000 27872/32000 (87%)] Loss: 0.34342 (QuantReg: 12.99597) QuantErr: 12.99597 batch_time=0.37186 
Train Epoch: 45 [876/1000 28032/32000 (88%)] Loss: 0.26898 (QuantReg: 12.91808) QuantErr: 12.91808 batch_time=0.37567 
Train Epoch: 45 [881/1000 28192/32000 (88%)] Loss: 0.38351 (QuantReg: 12.93335) QuantErr: 12.93335 batch_time=0.44311 
Train Epoch: 45 [886/1000 28352/32000 (89%)] Loss: 0.38021 (QuantReg: 12.92862) QuantErr: 12.92862 batch_time=0.39306 
Train Epoch: 45 [891/1000 28512/32000 (89%)] Loss: 0.45938 (QuantReg: 12.99360) QuantErr: 12.99360 batch_time=0.34930 
Train Epoch: 45 [896/1000 28672/32000 (90%)] Loss: 0.14317 (QuantReg: 13.55189) QuantErr: 13.55189 batch_time=0.35570 
Train Epoch: 45 [901/1000 28832/32000 (90%)] Loss: 0.30341 (QuantReg: 13.52769) QuantErr: 13.52769 batch_time=0.35100 
Train Epoch: 45 [906/1000 28992/32000 (91%)] Loss: 0.26286 (QuantReg: 12.25621) QuantErr: 12.25621 batch_time=0.36655 
Train Epoch: 45 [911/1000 29152/32000 (91%)] Loss: 0.28160 (QuantReg: 13.42885) QuantErr: 13.42885 batch_time=0.42444 
Train Epoch: 45 [916/1000 29312/32000 (92%)] Loss: 0.09539 (QuantReg: 13.46015) QuantErr: 13.46015 batch_time=0.47679 
Train Epoch: 45 [921/1000 29472/32000 (92%)] Loss: 0.16446 (QuantReg: 13.26879) QuantErr: 13.26879 batch_time=0.42269 
Train Epoch: 45 [926/1000 29632/32000 (93%)] Loss: 0.15831 (QuantReg: 12.76642) QuantErr: 12.76642 batch_time=0.43219 
Train Epoch: 45 [931/1000 29792/32000 (93%)] Loss: 0.32251 (QuantReg: 13.49364) QuantErr: 13.49364 batch_time=0.36734 
Train Epoch: 45 [936/1000 29952/32000 (94%)] Loss: 0.11734 (QuantReg: 13.32292) QuantErr: 13.32292 batch_time=0.36243 
Train Epoch: 45 [941/1000 30112/32000 (94%)] Loss: 0.13217 (QuantReg: 13.28883) QuantErr: 13.28883 batch_time=0.39653 
Train Epoch: 45 [946/1000 30272/32000 (95%)] Loss: 0.53467 (QuantReg: 13.67737) QuantErr: 13.67737 batch_time=0.53607 
Train Epoch: 45 [951/1000 30432/32000 (95%)] Loss: 0.19743 (QuantReg: 12.55470) QuantErr: 12.55470 batch_time=0.38844 
Train Epoch: 45 [956/1000 30592/32000 (96%)] Loss: 0.29881 (QuantReg: 12.50922) QuantErr: 12.50922 batch_time=0.44832 
Train Epoch: 45 [961/1000 30752/32000 (96%)] Loss: 0.50759 (QuantReg: 12.95686) QuantErr: 12.95686 batch_time=0.35208 
Train Epoch: 45 [966/1000 30912/32000 (97%)] Loss: 0.43740 (QuantReg: 13.20621) QuantErr: 13.20621 batch_time=0.35223 
Train Epoch: 45 [971/1000 31072/32000 (97%)] Loss: 0.43901 (QuantReg: 12.68666) QuantErr: 12.68666 batch_time=0.45436 
Train Epoch: 45 [976/1000 31232/32000 (98%)] Loss: 0.26152 (QuantReg: 13.20059) QuantErr: 13.20059 batch_time=0.38074 
Train Epoch: 45 [981/1000 31392/32000 (98%)] Loss: 0.34694 (QuantReg: 12.92612) QuantErr: 12.92612 batch_time=0.74174 
Train Epoch: 45 [986/1000 31552/32000 (99%)] Loss: 0.23379 (QuantReg: 13.07537) QuantErr: 13.07537 batch_time=0.40971 
Train Epoch: 45 [991/1000 31712/32000 (99%)] Loss: 0.20842 (QuantReg: 12.70500) QuantErr: 12.70500 batch_time=0.77021 
Train Epoch: 45 [996/1000 31872/32000 (100%)] Loss: 0.28521 (QuantReg: 12.53606) QuantErr: 12.53606 batch_time=0.34813 
Train Epoch: 45 codebook_update_time=1.71391
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch45.pth ...
Done in 10.679s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch45.pth ...
Done in 15.037s
removing stale ckpt [epoch 44] [took 0.02s]
 epoch          : 45
 loss           : 0.2810747769922018
 quant_reg      : 12.954710424423217
 quant_err      : 12.954710424423217
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 45000
 MSRVTT_full_val/t2v_metrics/R1: 31.99195171026157
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.120724346076459
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.39009032411943
 MSRVTT_full_val/v2t_metrics/R1: 38.028169014084504
 MSRVTT_full_val/v2t_metrics/R5: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.321931589537224
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.40263016931673
 MSRVTT_full_test/t2v_metrics/R1: 13.511705685618729
 MSRVTT_full_test/t2v_metrics/R5: 37.357859531772576
 MSRVTT_full_test/t2v_metrics/R10: 50.668896321070235
 MSRVTT_full_test/t2v_metrics/R50: 80.43478260869566
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.24314381270903
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.46306125612203
 MSRVTT_full_test/v2t_metrics/R1: 16.254180602006688
 MSRVTT_full_test/v2t_metrics/R5: 43.21070234113712
 MSRVTT_full_test/v2t_metrics/R10: 58.39464882943144
 MSRVTT_full_test/v2t_metrics/R50: 86.98996655518394
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.722742474916387
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.48602609118458
 mnt_best       : 29.46306125612203
 not_improved_count: 0
Train Epoch: 46 [1/1000 32/32000 (0%)] Loss: 0.45081 (QuantReg: 12.50504) QuantErr: 12.50504 batch_time=27.71083 
Train Epoch: 46 [6/1000 192/32000 (1%)] Loss: 0.32330 (QuantReg: 12.29640) QuantErr: 12.29640 batch_time=0.37077 
Train Epoch: 46 [11/1000 352/32000 (1%)] Loss: 0.35077 (QuantReg: 12.56503) QuantErr: 12.56503 batch_time=0.41108 
Train Epoch: 46 [16/1000 512/32000 (2%)] Loss: 0.39145 (QuantReg: 13.24434) QuantErr: 13.24434 batch_time=0.34295 
Train Epoch: 46 [21/1000 672/32000 (2%)] Loss: 0.14843 (QuantReg: 13.14575) QuantErr: 13.14575 batch_time=0.34048 
Train Epoch: 46 [26/1000 832/32000 (3%)] Loss: 0.13378 (QuantReg: 13.03765) QuantErr: 13.03765 batch_time=0.38062 
Train Epoch: 46 [31/1000 992/32000 (3%)] Loss: 0.08468 (QuantReg: 12.80574) QuantErr: 12.80574 batch_time=0.35532 
Train Epoch: 46 [36/1000 1152/32000 (4%)] Loss: 0.36009 (QuantReg: 12.64494) QuantErr: 12.64494 batch_time=0.37386 
Train Epoch: 46 [41/1000 1312/32000 (4%)] Loss: 0.37900 (QuantReg: 12.69372) QuantErr: 12.69372 batch_time=0.38061 
Train Epoch: 46 [46/1000 1472/32000 (5%)] Loss: 0.21387 (QuantReg: 13.57292) QuantErr: 13.57292 batch_time=0.34642 
Train Epoch: 46 [51/1000 1632/32000 (5%)] Loss: 0.24888 (QuantReg: 12.67460) QuantErr: 12.67460 batch_time=0.37587 
Train Epoch: 46 [56/1000 1792/32000 (6%)] Loss: 0.06880 (QuantReg: 13.32997) QuantErr: 13.32997 batch_time=0.34890 
Train Epoch: 46 [61/1000 1952/32000 (6%)] Loss: 0.29146 (QuantReg: 12.89867) QuantErr: 12.89867 batch_time=0.35357 
Train Epoch: 46 [66/1000 2112/32000 (7%)] Loss: 0.27235 (QuantReg: 13.31062) QuantErr: 13.31062 batch_time=0.53691 
Train Epoch: 46 [71/1000 2272/32000 (7%)] Loss: 0.43928 (QuantReg: 13.37593) QuantErr: 13.37593 batch_time=1.50198 
Train Epoch: 46 [76/1000 2432/32000 (8%)] Loss: 0.51337 (QuantReg: 12.91697) QuantErr: 12.91697 batch_time=0.38242 
Train Epoch: 46 [81/1000 2592/32000 (8%)] Loss: 0.09983 (QuantReg: 13.19397) QuantErr: 13.19397 batch_time=0.34510 
Train Epoch: 46 [86/1000 2752/32000 (9%)] Loss: 0.16568 (QuantReg: 12.77985) QuantErr: 12.77985 batch_time=0.34631 
Train Epoch: 46 [91/1000 2912/32000 (9%)] Loss: 0.18045 (QuantReg: 12.63674) QuantErr: 12.63674 batch_time=0.37113 
Train Epoch: 46 [96/1000 3072/32000 (10%)] Loss: 0.05995 (QuantReg: 12.84025) QuantErr: 12.84025 batch_time=0.39109 
Train Epoch: 46 [101/1000 3232/32000 (10%)] Loss: 0.14921 (QuantReg: 12.95579) QuantErr: 12.95579 batch_time=0.34243 
Train Epoch: 46 [106/1000 3392/32000 (11%)] Loss: 0.47124 (QuantReg: 12.51797) QuantErr: 12.51797 batch_time=0.34305 
Train Epoch: 46 [111/1000 3552/32000 (11%)] Loss: 0.05691 (QuantReg: 12.85054) QuantErr: 12.85054 batch_time=0.34437 
Train Epoch: 46 [116/1000 3712/32000 (12%)] Loss: 0.32219 (QuantReg: 13.41992) QuantErr: 13.41992 batch_time=0.34458 
Train Epoch: 46 [121/1000 3872/32000 (12%)] Loss: 0.22815 (QuantReg: 13.04437) QuantErr: 13.04437 batch_time=0.60197 
Train Epoch: 46 [126/1000 4032/32000 (13%)] Loss: 0.42996 (QuantReg: 13.12202) QuantErr: 13.12202 batch_time=0.34246 
Train Epoch: 46 [131/1000 4192/32000 (13%)] Loss: 0.16392 (QuantReg: 13.36483) QuantErr: 13.36483 batch_time=0.39038 
Train Epoch: 46 [136/1000 4352/32000 (14%)] Loss: 0.31429 (QuantReg: 13.20625) QuantErr: 13.20625 batch_time=0.34722 
Train Epoch: 46 [141/1000 4512/32000 (14%)] Loss: 0.50896 (QuantReg: 13.02049) QuantErr: 13.02049 batch_time=0.34050 
Train Epoch: 46 [146/1000 4672/32000 (15%)] Loss: 0.37270 (QuantReg: 13.46425) QuantErr: 13.46425 batch_time=0.34207 
Train Epoch: 46 [151/1000 4832/32000 (15%)] Loss: 0.23398 (QuantReg: 13.17012) QuantErr: 13.17012 batch_time=0.35643 
Train Epoch: 46 [156/1000 4992/32000 (16%)] Loss: 0.23473 (QuantReg: 13.03330) QuantErr: 13.03330 batch_time=0.35737 
Train Epoch: 46 [161/1000 5152/32000 (16%)] Loss: 0.60549 (QuantReg: 12.17866) QuantErr: 12.17866 batch_time=0.36268 
Train Epoch: 46 [166/1000 5312/32000 (17%)] Loss: 0.28728 (QuantReg: 12.54387) QuantErr: 12.54387 batch_time=0.37648 
Train Epoch: 46 [171/1000 5472/32000 (17%)] Loss: 0.29066 (QuantReg: 13.28315) QuantErr: 13.28315 batch_time=0.35473 
Train Epoch: 46 [176/1000 5632/32000 (18%)] Loss: 0.23546 (QuantReg: 12.79320) QuantErr: 12.79320 batch_time=0.35182 
Train Epoch: 46 [181/1000 5792/32000 (18%)] Loss: 0.26553 (QuantReg: 13.02976) QuantErr: 13.02976 batch_time=0.34243 
Train Epoch: 46 [186/1000 5952/32000 (19%)] Loss: 0.46800 (QuantReg: 12.61583) QuantErr: 12.61583 batch_time=0.34830 
Train Epoch: 46 [191/1000 6112/32000 (19%)] Loss: 0.40838 (QuantReg: 12.83520) QuantErr: 12.83520 batch_time=0.37126 
Train Epoch: 46 [196/1000 6272/32000 (20%)] Loss: 0.34847 (QuantReg: 12.90994) QuantErr: 12.90994 batch_time=0.36471 
Train Epoch: 46 [201/1000 6432/32000 (20%)] Loss: 0.50796 (QuantReg: 13.06925) QuantErr: 13.06925 batch_time=0.40624 
Train Epoch: 46 [206/1000 6592/32000 (21%)] Loss: 0.35117 (QuantReg: 12.55489) QuantErr: 12.55489 batch_time=0.35924 
Train Epoch: 46 [211/1000 6752/32000 (21%)] Loss: 0.32874 (QuantReg: 12.80574) QuantErr: 12.80574 batch_time=0.73121 
Train Epoch: 46 [216/1000 6912/32000 (22%)] Loss: 0.06916 (QuantReg: 12.91022) QuantErr: 12.91022 batch_time=0.40637 
Train Epoch: 46 [221/1000 7072/32000 (22%)] Loss: 0.30829 (QuantReg: 13.49173) QuantErr: 13.49173 batch_time=0.38175 
Train Epoch: 46 [226/1000 7232/32000 (23%)] Loss: 0.50216 (QuantReg: 12.63744) QuantErr: 12.63744 batch_time=0.36806 
Train Epoch: 46 [231/1000 7392/32000 (23%)] Loss: 0.22623 (QuantReg: 12.95187) QuantErr: 12.95187 batch_time=0.34754 
Train Epoch: 46 [236/1000 7552/32000 (24%)] Loss: 0.26583 (QuantReg: 13.36851) QuantErr: 13.36851 batch_time=0.42240 
Train Epoch: 46 [241/1000 7712/32000 (24%)] Loss: 0.59758 (QuantReg: 12.74141) QuantErr: 12.74141 batch_time=0.34807 
Train Epoch: 46 [246/1000 7872/32000 (25%)] Loss: 0.12191 (QuantReg: 13.31530) QuantErr: 13.31530 batch_time=0.35307 
Train Epoch: 46 [251/1000 8032/32000 (25%)] Loss: 0.52753 (QuantReg: 12.52665) QuantErr: 12.52665 batch_time=0.40305 
Train Epoch: 46 [256/1000 8192/32000 (26%)] Loss: 0.44997 (QuantReg: 12.84864) QuantErr: 12.84864 batch_time=0.36472 
Train Epoch: 46 [261/1000 8352/32000 (26%)] Loss: 0.08678 (QuantReg: 12.85782) QuantErr: 12.85782 batch_time=0.35365 
Train Epoch: 46 [266/1000 8512/32000 (27%)] Loss: 0.30428 (QuantReg: 12.85251) QuantErr: 12.85251 batch_time=0.34815 
Train Epoch: 46 [271/1000 8672/32000 (27%)] Loss: 0.16011 (QuantReg: 13.09520) QuantErr: 13.09520 batch_time=0.34701 
Train Epoch: 46 [276/1000 8832/32000 (28%)] Loss: 0.30848 (QuantReg: 13.09066) QuantErr: 13.09066 batch_time=0.34401 
Train Epoch: 46 [281/1000 8992/32000 (28%)] Loss: 0.43222 (QuantReg: 12.98827) QuantErr: 12.98827 batch_time=0.41686 
Train Epoch: 46 [286/1000 9152/32000 (29%)] Loss: 0.53140 (QuantReg: 12.83568) QuantErr: 12.83568 batch_time=0.55675 
Train Epoch: 46 [291/1000 9312/32000 (29%)] Loss: 0.23455 (QuantReg: 13.42348) QuantErr: 13.42348 batch_time=0.35299 
Train Epoch: 46 [296/1000 9472/32000 (30%)] Loss: 0.12682 (QuantReg: 13.20041) QuantErr: 13.20041 batch_time=0.34691 
Train Epoch: 46 [301/1000 9632/32000 (30%)] Loss: 0.83019 (QuantReg: 12.46784) QuantErr: 12.46784 batch_time=0.37268 
Train Epoch: 46 [306/1000 9792/32000 (31%)] Loss: 0.28339 (QuantReg: 12.97066) QuantErr: 12.97066 batch_time=0.35374 
Train Epoch: 46 [311/1000 9952/32000 (31%)] Loss: 0.13511 (QuantReg: 13.32977) QuantErr: 13.32977 batch_time=0.34795 
Train Epoch: 46 [316/1000 10112/32000 (32%)] Loss: 0.43238 (QuantReg: 12.66417) QuantErr: 12.66417 batch_time=0.37500 
Train Epoch: 46 [321/1000 10272/32000 (32%)] Loss: 0.35748 (QuantReg: 12.99988) QuantErr: 12.99988 batch_time=0.38295 
Train Epoch: 46 [326/1000 10432/32000 (33%)] Loss: 0.51885 (QuantReg: 13.13554) QuantErr: 13.13554 batch_time=0.37950 
Train Epoch: 46 [331/1000 10592/32000 (33%)] Loss: 0.42138 (QuantReg: 13.14330) QuantErr: 13.14330 batch_time=0.35112 
Train Epoch: 46 [336/1000 10752/32000 (34%)] Loss: 0.22084 (QuantReg: 13.15167) QuantErr: 13.15167 batch_time=0.34632 
Train Epoch: 46 [341/1000 10912/32000 (34%)] Loss: 0.35055 (QuantReg: 13.19100) QuantErr: 13.19100 batch_time=0.37410 
Train Epoch: 46 [346/1000 11072/32000 (35%)] Loss: 0.33206 (QuantReg: 12.66559) QuantErr: 12.66559 batch_time=0.36464 
Train Epoch: 46 [351/1000 11232/32000 (35%)] Loss: 0.67678 (QuantReg: 12.39950) QuantErr: 12.39950 batch_time=0.34559 
Train Epoch: 46 [356/1000 11392/32000 (36%)] Loss: 0.22752 (QuantReg: 13.12202) QuantErr: 13.12202 batch_time=0.42709 
Train Epoch: 46 [361/1000 11552/32000 (36%)] Loss: 0.18410 (QuantReg: 13.38998) QuantErr: 13.38998 batch_time=0.37170 
Train Epoch: 46 [366/1000 11712/32000 (37%)] Loss: 0.24374 (QuantReg: 13.14550) QuantErr: 13.14550 batch_time=0.36481 
Train Epoch: 46 [371/1000 11872/32000 (37%)] Loss: 0.36167 (QuantReg: 12.83764) QuantErr: 12.83764 batch_time=0.41907 
Train Epoch: 46 [376/1000 12032/32000 (38%)] Loss: 0.20473 (QuantReg: 13.18247) QuantErr: 13.18247 batch_time=0.37172 
Train Epoch: 46 [381/1000 12192/32000 (38%)] Loss: 0.17107 (QuantReg: 12.36626) QuantErr: 12.36626 batch_time=0.36177 
Train Epoch: 46 [386/1000 12352/32000 (39%)] Loss: 0.31298 (QuantReg: 12.96785) QuantErr: 12.96785 batch_time=0.52544 
Train Epoch: 46 [391/1000 12512/32000 (39%)] Loss: 0.24626 (QuantReg: 12.95765) QuantErr: 12.95765 batch_time=1.47431 
Train Epoch: 46 [396/1000 12672/32000 (40%)] Loss: 0.21010 (QuantReg: 13.02464) QuantErr: 13.02464 batch_time=0.34509 
Train Epoch: 46 [401/1000 12832/32000 (40%)] Loss: 0.46077 (QuantReg: 11.65007) QuantErr: 11.65007 batch_time=0.36574 
Train Epoch: 46 [406/1000 12992/32000 (41%)] Loss: 0.32360 (QuantReg: 12.96022) QuantErr: 12.96022 batch_time=0.41217 
Train Epoch: 46 [411/1000 13152/32000 (41%)] Loss: 0.24094 (QuantReg: 12.86220) QuantErr: 12.86220 batch_time=0.34693 
Train Epoch: 46 [416/1000 13312/32000 (42%)] Loss: 0.17900 (QuantReg: 13.06365) QuantErr: 13.06365 batch_time=0.39338 
Train Epoch: 46 [421/1000 13472/32000 (42%)] Loss: 0.19522 (QuantReg: 12.76031) QuantErr: 12.76031 batch_time=0.39189 
Train Epoch: 46 [426/1000 13632/32000 (43%)] Loss: 0.15744 (QuantReg: 13.00518) QuantErr: 13.00518 batch_time=0.50703 
Train Epoch: 46 [431/1000 13792/32000 (43%)] Loss: 0.32427 (QuantReg: 13.26105) QuantErr: 13.26105 batch_time=0.39036 
Train Epoch: 46 [436/1000 13952/32000 (44%)] Loss: 0.43144 (QuantReg: 13.08708) QuantErr: 13.08708 batch_time=0.35764 
Train Epoch: 46 [441/1000 14112/32000 (44%)] Loss: 0.28480 (QuantReg: 12.43488) QuantErr: 12.43488 batch_time=0.34265 
Train Epoch: 46 [446/1000 14272/32000 (45%)] Loss: 0.21768 (QuantReg: 13.00789) QuantErr: 13.00789 batch_time=0.35182 
Train Epoch: 46 [451/1000 14432/32000 (45%)] Loss: 0.26743 (QuantReg: 12.62392) QuantErr: 12.62392 batch_time=0.39880 
Train Epoch: 46 [456/1000 14592/32000 (46%)] Loss: 0.25899 (QuantReg: 12.26892) QuantErr: 12.26892 batch_time=0.36887 
Train Epoch: 46 [461/1000 14752/32000 (46%)] Loss: 0.28057 (QuantReg: 13.07405) QuantErr: 13.07405 batch_time=0.34794 
Train Epoch: 46 [466/1000 14912/32000 (47%)] Loss: 0.35739 (QuantReg: 13.18945) QuantErr: 13.18945 batch_time=0.38986 
Train Epoch: 46 [471/1000 15072/32000 (47%)] Loss: 0.31600 (QuantReg: 13.20734) QuantErr: 13.20734 batch_time=0.42314 
Train Epoch: 46 [476/1000 15232/32000 (48%)] Loss: 0.25209 (QuantReg: 12.92255) QuantErr: 12.92255 batch_time=0.35664 
Train Epoch: 46 [481/1000 15392/32000 (48%)] Loss: 0.22576 (QuantReg: 12.86409) QuantErr: 12.86409 batch_time=0.42743 
Train Epoch: 46 [486/1000 15552/32000 (49%)] Loss: 0.32038 (QuantReg: 12.64342) QuantErr: 12.64342 batch_time=0.39236 
Train Epoch: 46 [491/1000 15712/32000 (49%)] Loss: 0.34026 (QuantReg: 12.85329) QuantErr: 12.85329 batch_time=0.38665 
Train Epoch: 46 [496/1000 15872/32000 (50%)] Loss: 0.37790 (QuantReg: 12.93839) QuantErr: 12.93839 batch_time=0.38644 
Train Epoch: 46 [501/1000 16032/32000 (50%)] Loss: 0.18153 (QuantReg: 12.68347) QuantErr: 12.68347 batch_time=0.35899 
Train Epoch: 46 [506/1000 16192/32000 (51%)] Loss: 0.24556 (QuantReg: 13.13362) QuantErr: 13.13362 batch_time=0.37625 
Train Epoch: 46 [511/1000 16352/32000 (51%)] Loss: 0.36127 (QuantReg: 13.00793) QuantErr: 13.00793 batch_time=0.37886 
Train Epoch: 46 [516/1000 16512/32000 (52%)] Loss: 0.39609 (QuantReg: 13.47410) QuantErr: 13.47410 batch_time=0.34499 
Train Epoch: 46 [521/1000 16672/32000 (52%)] Loss: 0.44803 (QuantReg: 12.24624) QuantErr: 12.24624 batch_time=0.34696 
Train Epoch: 46 [526/1000 16832/32000 (53%)] Loss: 0.12553 (QuantReg: 12.92991) QuantErr: 12.92991 batch_time=0.36191 
Train Epoch: 46 [531/1000 16992/32000 (53%)] Loss: 0.35973 (QuantReg: 13.21675) QuantErr: 13.21675 batch_time=0.58572 
Train Epoch: 46 [536/1000 17152/32000 (54%)] Loss: 0.21460 (QuantReg: 13.08817) QuantErr: 13.08817 batch_time=0.36188 
Train Epoch: 46 [541/1000 17312/32000 (54%)] Loss: 0.20004 (QuantReg: 13.13286) QuantErr: 13.13286 batch_time=0.35173 
Train Epoch: 46 [546/1000 17472/32000 (55%)] Loss: 0.39024 (QuantReg: 12.72654) QuantErr: 12.72654 batch_time=0.35633 
Train Epoch: 46 [551/1000 17632/32000 (55%)] Loss: 0.15100 (QuantReg: 12.93534) QuantErr: 12.93534 batch_time=0.34860 
Train Epoch: 46 [556/1000 17792/32000 (56%)] Loss: 0.35798 (QuantReg: 12.95390) QuantErr: 12.95390 batch_time=0.42233 
Train Epoch: 46 [561/1000 17952/32000 (56%)] Loss: 0.24653 (QuantReg: 12.84651) QuantErr: 12.84651 batch_time=0.37705 
Train Epoch: 46 [566/1000 18112/32000 (57%)] Loss: 0.35203 (QuantReg: 12.86099) QuantErr: 12.86099 batch_time=0.41020 
Train Epoch: 46 [571/1000 18272/32000 (57%)] Loss: 0.11341 (QuantReg: 13.34697) QuantErr: 13.34697 batch_time=0.39279 
Train Epoch: 46 [576/1000 18432/32000 (58%)] Loss: 0.23846 (QuantReg: 13.07616) QuantErr: 13.07616 batch_time=0.35655 
Train Epoch: 46 [581/1000 18592/32000 (58%)] Loss: 0.73189 (QuantReg: 12.68845) QuantErr: 12.68845 batch_time=0.38589 
Train Epoch: 46 [586/1000 18752/32000 (59%)] Loss: 0.15483 (QuantReg: 12.83150) QuantErr: 12.83150 batch_time=0.42029 
Train Epoch: 46 [591/1000 18912/32000 (59%)] Loss: 0.26354 (QuantReg: 13.22794) QuantErr: 13.22794 batch_time=0.41675 
Train Epoch: 46 [596/1000 19072/32000 (60%)] Loss: 0.51689 (QuantReg: 13.19344) QuantErr: 13.19344 batch_time=0.35689 
Train Epoch: 46 [601/1000 19232/32000 (60%)] Loss: 0.18605 (QuantReg: 13.66399) QuantErr: 13.66399 batch_time=0.35438 
Train Epoch: 46 [606/1000 19392/32000 (61%)] Loss: 0.20389 (QuantReg: 12.81844) QuantErr: 12.81844 batch_time=0.51100 
Train Epoch: 46 [611/1000 19552/32000 (61%)] Loss: 0.35318 (QuantReg: 13.08460) QuantErr: 13.08460 batch_time=0.37414 
Train Epoch: 46 [616/1000 19712/32000 (62%)] Loss: 0.34105 (QuantReg: 12.87266) QuantErr: 12.87266 batch_time=0.34832 
Train Epoch: 46 [621/1000 19872/32000 (62%)] Loss: 0.38368 (QuantReg: 13.02988) QuantErr: 13.02988 batch_time=0.41900 
Train Epoch: 46 [626/1000 20032/32000 (63%)] Loss: 0.14318 (QuantReg: 13.49766) QuantErr: 13.49766 batch_time=0.34846 
Train Epoch: 46 [631/1000 20192/32000 (63%)] Loss: 0.40441 (QuantReg: 13.08908) QuantErr: 13.08908 batch_time=0.36746 
Train Epoch: 46 [636/1000 20352/32000 (64%)] Loss: 0.27074 (QuantReg: 12.62412) QuantErr: 12.62412 batch_time=0.34543 
Train Epoch: 46 [641/1000 20512/32000 (64%)] Loss: 0.17902 (QuantReg: 13.21857) QuantErr: 13.21857 batch_time=0.44560 
Train Epoch: 46 [646/1000 20672/32000 (65%)] Loss: 0.26185 (QuantReg: 12.80212) QuantErr: 12.80212 batch_time=0.38312 
Train Epoch: 46 [651/1000 20832/32000 (65%)] Loss: 0.32605 (QuantReg: 13.37269) QuantErr: 13.37269 batch_time=0.45076 
Train Epoch: 46 [656/1000 20992/32000 (66%)] Loss: 0.16300 (QuantReg: 13.18848) QuantErr: 13.18848 batch_time=0.36428 
Train Epoch: 46 [661/1000 21152/32000 (66%)] Loss: 0.17661 (QuantReg: 13.56233) QuantErr: 13.56233 batch_time=0.38812 
Train Epoch: 46 [666/1000 21312/32000 (67%)] Loss: 0.30793 (QuantReg: 13.03403) QuantErr: 13.03403 batch_time=0.43309 
Train Epoch: 46 [671/1000 21472/32000 (67%)] Loss: 0.18885 (QuantReg: 13.12946) QuantErr: 13.12946 batch_time=0.35717 
Train Epoch: 46 [676/1000 21632/32000 (68%)] Loss: 0.13477 (QuantReg: 13.45552) QuantErr: 13.45552 batch_time=0.39207 
Train Epoch: 46 [681/1000 21792/32000 (68%)] Loss: 0.28516 (QuantReg: 13.09215) QuantErr: 13.09215 batch_time=0.36210 
Train Epoch: 46 [686/1000 21952/32000 (69%)] Loss: 0.12833 (QuantReg: 12.59301) QuantErr: 12.59301 batch_time=0.37901 
Train Epoch: 46 [691/1000 22112/32000 (69%)] Loss: 0.23015 (QuantReg: 12.92623) QuantErr: 12.92623 batch_time=0.45455 
Train Epoch: 46 [696/1000 22272/32000 (70%)] Loss: 0.15733 (QuantReg: 13.03981) QuantErr: 13.03981 batch_time=0.39552 
Train Epoch: 46 [701/1000 22432/32000 (70%)] Loss: 0.12678 (QuantReg: 13.12303) QuantErr: 13.12303 batch_time=0.41015 
Train Epoch: 46 [706/1000 22592/32000 (71%)] Loss: 0.37602 (QuantReg: 13.11809) QuantErr: 13.11809 batch_time=0.53848 
Train Epoch: 46 [711/1000 22752/32000 (71%)] Loss: 0.12109 (QuantReg: 12.64251) QuantErr: 12.64251 batch_time=1.53381 
Train Epoch: 46 [716/1000 22912/32000 (72%)] Loss: 0.66583 (QuantReg: 12.24831) QuantErr: 12.24831 batch_time=0.36592 
Train Epoch: 46 [721/1000 23072/32000 (72%)] Loss: 0.28431 (QuantReg: 12.98748) QuantErr: 12.98748 batch_time=0.34889 
Train Epoch: 46 [726/1000 23232/32000 (73%)] Loss: 0.22737 (QuantReg: 12.66355) QuantErr: 12.66355 batch_time=0.35512 
Train Epoch: 46 [731/1000 23392/32000 (73%)] Loss: 0.10562 (QuantReg: 13.17480) QuantErr: 13.17480 batch_time=0.36636 
Train Epoch: 46 [736/1000 23552/32000 (74%)] Loss: 0.25886 (QuantReg: 12.91038) QuantErr: 12.91038 batch_time=0.35207 
Train Epoch: 46 [741/1000 23712/32000 (74%)] Loss: 0.29963 (QuantReg: 12.66928) QuantErr: 12.66928 batch_time=0.39829 
Train Epoch: 46 [746/1000 23872/32000 (75%)] Loss: 0.21695 (QuantReg: 13.47705) QuantErr: 13.47705 batch_time=0.34498 
Train Epoch: 46 [751/1000 24032/32000 (75%)] Loss: 0.66310 (QuantReg: 12.65013) QuantErr: 12.65013 batch_time=0.34793 
Train Epoch: 46 [756/1000 24192/32000 (76%)] Loss: 0.14554 (QuantReg: 12.70891) QuantErr: 12.70891 batch_time=0.35124 
Train Epoch: 46 [761/1000 24352/32000 (76%)] Loss: 0.25507 (QuantReg: 12.87735) QuantErr: 12.87735 batch_time=0.34556 
Train Epoch: 46 [766/1000 24512/32000 (77%)] Loss: 0.19842 (QuantReg: 13.06641) QuantErr: 13.06641 batch_time=0.38486 
Train Epoch: 46 [771/1000 24672/32000 (77%)] Loss: 0.12737 (QuantReg: 12.60393) QuantErr: 12.60393 batch_time=0.36846 
Train Epoch: 46 [776/1000 24832/32000 (78%)] Loss: 0.17185 (QuantReg: 13.21714) QuantErr: 13.21714 batch_time=0.35311 
Train Epoch: 46 [781/1000 24992/32000 (78%)] Loss: 0.30672 (QuantReg: 13.01576) QuantErr: 13.01576 batch_time=0.41828 
Train Epoch: 46 [786/1000 25152/32000 (79%)] Loss: 0.37803 (QuantReg: 12.77883) QuantErr: 12.77883 batch_time=0.34799 
Train Epoch: 46 [791/1000 25312/32000 (79%)] Loss: 0.41640 (QuantReg: 13.06865) QuantErr: 13.06865 batch_time=0.39461 
Train Epoch: 46 [796/1000 25472/32000 (80%)] Loss: 0.55544 (QuantReg: 12.54593) QuantErr: 12.54593 batch_time=0.35268 
Train Epoch: 46 [801/1000 25632/32000 (80%)] Loss: 0.24190 (QuantReg: 13.01439) QuantErr: 13.01439 batch_time=0.35002 
Train Epoch: 46 [806/1000 25792/32000 (81%)] Loss: 0.11497 (QuantReg: 13.31231) QuantErr: 13.31231 batch_time=0.39160 
Train Epoch: 46 [811/1000 25952/32000 (81%)] Loss: 0.27141 (QuantReg: 12.96069) QuantErr: 12.96069 batch_time=0.39580 
Train Epoch: 46 [816/1000 26112/32000 (82%)] Loss: 0.12589 (QuantReg: 13.45048) QuantErr: 13.45048 batch_time=0.37020 
Train Epoch: 46 [821/1000 26272/32000 (82%)] Loss: 0.21402 (QuantReg: 13.26505) QuantErr: 13.26505 batch_time=0.35417 
Train Epoch: 46 [826/1000 26432/32000 (83%)] Loss: 0.51771 (QuantReg: 12.98707) QuantErr: 12.98707 batch_time=0.34671 
Train Epoch: 46 [831/1000 26592/32000 (83%)] Loss: 0.62896 (QuantReg: 12.73115) QuantErr: 12.73115 batch_time=0.51806 
Train Epoch: 46 [836/1000 26752/32000 (84%)] Loss: 0.22946 (QuantReg: 13.75746) QuantErr: 13.75746 batch_time=0.42333 
Train Epoch: 46 [841/1000 26912/32000 (84%)] Loss: 0.23612 (QuantReg: 13.38625) QuantErr: 13.38625 batch_time=0.34622 
Train Epoch: 46 [846/1000 27072/32000 (85%)] Loss: 0.24762 (QuantReg: 13.05721) QuantErr: 13.05721 batch_time=0.35027 
Train Epoch: 46 [851/1000 27232/32000 (85%)] Loss: 0.18054 (QuantReg: 13.70704) QuantErr: 13.70704 batch_time=0.59126 
Train Epoch: 46 [856/1000 27392/32000 (86%)] Loss: 0.21853 (QuantReg: 13.23824) QuantErr: 13.23824 batch_time=0.38472 
Train Epoch: 46 [861/1000 27552/32000 (86%)] Loss: 0.21225 (QuantReg: 12.85155) QuantErr: 12.85155 batch_time=0.34311 
Train Epoch: 46 [866/1000 27712/32000 (87%)] Loss: 0.45217 (QuantReg: 13.09161) QuantErr: 13.09161 batch_time=0.37299 
Train Epoch: 46 [871/1000 27872/32000 (87%)] Loss: 0.21998 (QuantReg: 12.92366) QuantErr: 12.92366 batch_time=0.36233 
Train Epoch: 46 [876/1000 28032/32000 (88%)] Loss: 0.27048 (QuantReg: 13.13474) QuantErr: 13.13474 batch_time=0.48346 
Train Epoch: 46 [881/1000 28192/32000 (88%)] Loss: 0.35357 (QuantReg: 12.96088) QuantErr: 12.96088 batch_time=0.43504 
Train Epoch: 46 [886/1000 28352/32000 (89%)] Loss: 0.36365 (QuantReg: 13.00399) QuantErr: 13.00399 batch_time=0.38370 
Train Epoch: 46 [891/1000 28512/32000 (89%)] Loss: 0.30967 (QuantReg: 12.16579) QuantErr: 12.16579 batch_time=0.39372 
Train Epoch: 46 [896/1000 28672/32000 (90%)] Loss: 0.23728 (QuantReg: 13.04630) QuantErr: 13.04630 batch_time=0.38933 
Train Epoch: 46 [901/1000 28832/32000 (90%)] Loss: 0.30917 (QuantReg: 12.40582) QuantErr: 12.40582 batch_time=0.35995 
Train Epoch: 46 [906/1000 28992/32000 (91%)] Loss: 0.42927 (QuantReg: 12.81097) QuantErr: 12.81097 batch_time=0.36163 
Train Epoch: 46 [911/1000 29152/32000 (91%)] Loss: 0.31076 (QuantReg: 12.98936) QuantErr: 12.98936 batch_time=0.34420 
Train Epoch: 46 [916/1000 29312/32000 (92%)] Loss: 0.26036 (QuantReg: 13.10483) QuantErr: 13.10483 batch_time=0.34654 
Train Epoch: 46 [921/1000 29472/32000 (92%)] Loss: 0.12617 (QuantReg: 12.81801) QuantErr: 12.81801 batch_time=0.34864 
Train Epoch: 46 [926/1000 29632/32000 (93%)] Loss: 0.27240 (QuantReg: 12.80701) QuantErr: 12.80701 batch_time=0.64499 
Train Epoch: 46 [931/1000 29792/32000 (93%)] Loss: 0.34554 (QuantReg: 13.62613) QuantErr: 13.62613 batch_time=0.39442 
Train Epoch: 46 [936/1000 29952/32000 (94%)] Loss: 0.21459 (QuantReg: 12.60426) QuantErr: 12.60426 batch_time=0.34551 
Train Epoch: 46 [941/1000 30112/32000 (94%)] Loss: 0.30600 (QuantReg: 12.96711) QuantErr: 12.96711 batch_time=0.36555 
Train Epoch: 46 [946/1000 30272/32000 (95%)] Loss: 0.28970 (QuantReg: 12.73769) QuantErr: 12.73769 batch_time=0.34617 
Train Epoch: 46 [951/1000 30432/32000 (95%)] Loss: 0.10302 (QuantReg: 12.73009) QuantErr: 12.73009 batch_time=0.40323 
Train Epoch: 46 [956/1000 30592/32000 (96%)] Loss: 0.55030 (QuantReg: 13.04155) QuantErr: 13.04155 batch_time=0.41112 
Train Epoch: 46 [961/1000 30752/32000 (96%)] Loss: 0.38720 (QuantReg: 12.33141) QuantErr: 12.33141 batch_time=0.45994 
Train Epoch: 46 [966/1000 30912/32000 (97%)] Loss: 0.08138 (QuantReg: 13.15897) QuantErr: 13.15897 batch_time=0.46084 
Train Epoch: 46 [971/1000 31072/32000 (97%)] Loss: 0.21690 (QuantReg: 13.21182) QuantErr: 13.21182 batch_time=0.35062 
Train Epoch: 46 [976/1000 31232/32000 (98%)] Loss: 0.73834 (QuantReg: 12.43603) QuantErr: 12.43603 batch_time=0.40906 
Train Epoch: 46 [981/1000 31392/32000 (98%)] Loss: 0.39049 (QuantReg: 12.95921) QuantErr: 12.95921 batch_time=0.35288 
Train Epoch: 46 [986/1000 31552/32000 (99%)] Loss: 0.42303 (QuantReg: 12.74587) QuantErr: 12.74587 batch_time=0.36075 
Train Epoch: 46 [991/1000 31712/32000 (99%)] Loss: 0.20690 (QuantReg: 13.12587) QuantErr: 13.12587 batch_time=0.38038 
Train Epoch: 46 [996/1000 31872/32000 (100%)] Loss: 0.24584 (QuantReg: 13.35444) QuantErr: 13.35444 batch_time=0.34969 
Train Epoch: 46 codebook_update_time=1.86885
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch46.pth ...
Done in 10.162s
removing stale ckpt [epoch 45] [took 0.04s]
 epoch          : 46
 loss           : 0.2942610055524856
 quant_reg      : 12.966785924911498
 quant_err      : 12.966785924911498
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 46000
 MSRVTT_full_val/t2v_metrics/R1: 31.58953722334004
 MSRVTT_full_val/t2v_metrics/R5: 72.03219315895372
 MSRVTT_full_val/t2v_metrics/R10: 82.49496981891348
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.971830985915493
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.25750985705573
 MSRVTT_full_val/v2t_metrics/R1: 37.625754527162975
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.921529175050302
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.31857485546265
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 37.15719063545151
 MSRVTT_full_test/t2v_metrics/R10: 50.668896321070235
 MSRVTT_full_test/t2v_metrics/R50: 80.8695652173913
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.719063545150505
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.263890716059972
 MSRVTT_full_test/v2t_metrics/R1: 16.622073578595316
 MSRVTT_full_test/v2t_metrics/R5: 43.17725752508361
 MSRVTT_full_test/v2t_metrics/R10: 58.46153846153846
 MSRVTT_full_test/v2t_metrics/R50: 86.52173913043478
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.679933110367894
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.74856156436894
 mnt_best       : 29.46306125612203
 not_improved_count: 1
Train Epoch: 47 [1/1000 32/32000 (0%)] Loss: 0.37152 (QuantReg: 13.34705) QuantErr: 13.34705 batch_time=27.68713 
Train Epoch: 47 [6/1000 192/32000 (1%)] Loss: 0.33779 (QuantReg: 12.48490) QuantErr: 12.48490 batch_time=0.34520 
Train Epoch: 47 [11/1000 352/32000 (1%)] Loss: 0.09109 (QuantReg: 13.17529) QuantErr: 13.17529 batch_time=0.35186 
Train Epoch: 47 [16/1000 512/32000 (2%)] Loss: 0.23602 (QuantReg: 12.60050) QuantErr: 12.60050 batch_time=0.41420 
Train Epoch: 47 [21/1000 672/32000 (2%)] Loss: 0.07096 (QuantReg: 13.80002) QuantErr: 13.80002 batch_time=0.35322 
Train Epoch: 47 [26/1000 832/32000 (3%)] Loss: 0.21993 (QuantReg: 13.54425) QuantErr: 13.54425 batch_time=0.35163 
Train Epoch: 47 [31/1000 992/32000 (3%)] Loss: 0.13616 (QuantReg: 13.20150) QuantErr: 13.20150 batch_time=0.35854 
Train Epoch: 47 [36/1000 1152/32000 (4%)] Loss: 0.38439 (QuantReg: 13.07109) QuantErr: 13.07109 batch_time=0.34852 
Train Epoch: 47 [41/1000 1312/32000 (4%)] Loss: 0.23292 (QuantReg: 13.07876) QuantErr: 13.07876 batch_time=0.36801 
Train Epoch: 47 [46/1000 1472/32000 (5%)] Loss: 0.14610 (QuantReg: 13.12047) QuantErr: 13.12047 batch_time=0.35071 
Train Epoch: 47 [51/1000 1632/32000 (5%)] Loss: 0.46148 (QuantReg: 12.30175) QuantErr: 12.30175 batch_time=0.34901 
Train Epoch: 47 [56/1000 1792/32000 (6%)] Loss: 0.20849 (QuantReg: 13.35852) QuantErr: 13.35852 batch_time=0.49365 
Train Epoch: 47 [61/1000 1952/32000 (6%)] Loss: 0.24808 (QuantReg: 12.96341) QuantErr: 12.96341 batch_time=0.41187 
Train Epoch: 47 [66/1000 2112/32000 (7%)] Loss: 0.34606 (QuantReg: 12.60776) QuantErr: 12.60776 batch_time=0.35053 
Train Epoch: 47 [71/1000 2272/32000 (7%)] Loss: 0.38370 (QuantReg: 13.02673) QuantErr: 13.02673 batch_time=0.35399 
Train Epoch: 47 [76/1000 2432/32000 (8%)] Loss: 0.17063 (QuantReg: 12.80335) QuantErr: 12.80335 batch_time=0.35521 
Train Epoch: 47 [81/1000 2592/32000 (8%)] Loss: 0.13465 (QuantReg: 12.53365) QuantErr: 12.53365 batch_time=0.44755 
Train Epoch: 47 [86/1000 2752/32000 (9%)] Loss: 0.13587 (QuantReg: 12.70263) QuantErr: 12.70263 batch_time=0.34408 
Train Epoch: 47 [91/1000 2912/32000 (9%)] Loss: 0.34561 (QuantReg: 12.56779) QuantErr: 12.56779 batch_time=0.37559 
Train Epoch: 47 [96/1000 3072/32000 (10%)] Loss: 0.35788 (QuantReg: 12.46320) QuantErr: 12.46320 batch_time=0.35767 
Train Epoch: 47 [101/1000 3232/32000 (10%)] Loss: 0.46316 (QuantReg: 12.80682) QuantErr: 12.80682 batch_time=0.35218 
Train Epoch: 47 [106/1000 3392/32000 (11%)] Loss: 0.34166 (QuantReg: 12.91934) QuantErr: 12.91934 batch_time=0.35139 
Train Epoch: 47 [111/1000 3552/32000 (11%)] Loss: 0.20260 (QuantReg: 12.97536) QuantErr: 12.97536 batch_time=0.37040 
Train Epoch: 47 [116/1000 3712/32000 (12%)] Loss: 0.18045 (QuantReg: 12.74716) QuantErr: 12.74716 batch_time=0.44439 
Train Epoch: 47 [121/1000 3872/32000 (12%)] Loss: 0.41013 (QuantReg: 12.99340) QuantErr: 12.99340 batch_time=0.42932 
Train Epoch: 47 [126/1000 4032/32000 (13%)] Loss: 0.12798 (QuantReg: 13.02055) QuantErr: 13.02055 batch_time=0.35001 
Train Epoch: 47 [131/1000 4192/32000 (13%)] Loss: 0.35190 (QuantReg: 12.86703) QuantErr: 12.86703 batch_time=0.41303 
Train Epoch: 47 [136/1000 4352/32000 (14%)] Loss: 0.29491 (QuantReg: 12.99314) QuantErr: 12.99314 batch_time=0.38986 
Train Epoch: 47 [141/1000 4512/32000 (14%)] Loss: 0.20906 (QuantReg: 12.72431) QuantErr: 12.72431 batch_time=0.38578 
Train Epoch: 47 [146/1000 4672/32000 (15%)] Loss: 0.34282 (QuantReg: 12.99281) QuantErr: 12.99281 batch_time=0.35622 
Train Epoch: 47 [151/1000 4832/32000 (15%)] Loss: 0.28369 (QuantReg: 13.72009) QuantErr: 13.72009 batch_time=0.42215 
Train Epoch: 47 [156/1000 4992/32000 (16%)] Loss: 0.14482 (QuantReg: 13.52388) QuantErr: 13.52388 batch_time=0.35078 
Train Epoch: 47 [161/1000 5152/32000 (16%)] Loss: 0.28636 (QuantReg: 13.52687) QuantErr: 13.52687 batch_time=0.60722 
Train Epoch: 47 [166/1000 5312/32000 (17%)] Loss: 0.48577 (QuantReg: 12.54819) QuantErr: 12.54819 batch_time=0.34720 
Train Epoch: 47 [171/1000 5472/32000 (17%)] Loss: 0.11393 (QuantReg: 12.57628) QuantErr: 12.57628 batch_time=0.35357 
Train Epoch: 47 [176/1000 5632/32000 (18%)] Loss: 0.28260 (QuantReg: 12.85167) QuantErr: 12.85167 batch_time=0.35214 
Train Epoch: 47 [181/1000 5792/32000 (18%)] Loss: 0.36894 (QuantReg: 12.81571) QuantErr: 12.81571 batch_time=0.35801 
Train Epoch: 47 [186/1000 5952/32000 (19%)] Loss: 0.29083 (QuantReg: 12.73617) QuantErr: 12.73617 batch_time=0.36721 
Train Epoch: 47 [191/1000 6112/32000 (19%)] Loss: 0.44017 (QuantReg: 13.14953) QuantErr: 13.14953 batch_time=0.37597 
Train Epoch: 47 [196/1000 6272/32000 (20%)] Loss: 0.57465 (QuantReg: 12.58145) QuantErr: 12.58145 batch_time=0.35891 
Train Epoch: 47 [201/1000 6432/32000 (20%)] Loss: 0.22342 (QuantReg: 13.20969) QuantErr: 13.20969 batch_time=0.35477 
Train Epoch: 47 [206/1000 6592/32000 (21%)] Loss: 0.43107 (QuantReg: 13.13928) QuantErr: 13.13928 batch_time=0.36058 
Train Epoch: 47 [211/1000 6752/32000 (21%)] Loss: 0.32163 (QuantReg: 12.52767) QuantErr: 12.52767 batch_time=0.54399 
Train Epoch: 47 [216/1000 6912/32000 (22%)] Loss: 0.44064 (QuantReg: 13.18382) QuantErr: 13.18382 batch_time=1.30402 
Train Epoch: 47 [221/1000 7072/32000 (22%)] Loss: 0.25546 (QuantReg: 12.39213) QuantErr: 12.39213 batch_time=0.35313 
Train Epoch: 47 [226/1000 7232/32000 (23%)] Loss: 0.56264 (QuantReg: 13.12215) QuantErr: 13.12215 batch_time=0.35599 
Train Epoch: 47 [231/1000 7392/32000 (23%)] Loss: 0.36125 (QuantReg: 12.53509) QuantErr: 12.53509 batch_time=0.35535 
Train Epoch: 47 [236/1000 7552/32000 (24%)] Loss: 0.16065 (QuantReg: 13.82712) QuantErr: 13.82712 batch_time=0.36012 
Train Epoch: 47 [241/1000 7712/32000 (24%)] Loss: 0.29421 (QuantReg: 12.85677) QuantErr: 12.85677 batch_time=0.36465 
Train Epoch: 47 [246/1000 7872/32000 (25%)] Loss: 0.50225 (QuantReg: 12.66998) QuantErr: 12.66998 batch_time=0.38586 
Train Epoch: 47 [251/1000 8032/32000 (25%)] Loss: 0.32450 (QuantReg: 12.69043) QuantErr: 12.69043 batch_time=0.41938 
Train Epoch: 47 [256/1000 8192/32000 (26%)] Loss: 0.61833 (QuantReg: 12.82285) QuantErr: 12.82285 batch_time=0.44811 
Train Epoch: 47 [261/1000 8352/32000 (26%)] Loss: 0.28647 (QuantReg: 13.35514) QuantErr: 13.35514 batch_time=0.38912 
Train Epoch: 47 [266/1000 8512/32000 (27%)] Loss: 0.14411 (QuantReg: 13.46683) QuantErr: 13.46683 batch_time=0.38402 
Train Epoch: 47 [271/1000 8672/32000 (27%)] Loss: 0.24323 (QuantReg: 13.03370) QuantErr: 13.03370 batch_time=0.40331 
Train Epoch: 47 [276/1000 8832/32000 (28%)] Loss: 0.07763 (QuantReg: 13.38101) QuantErr: 13.38101 batch_time=0.41652 
Train Epoch: 47 [281/1000 8992/32000 (28%)] Loss: 0.14058 (QuantReg: 12.98219) QuantErr: 12.98219 batch_time=0.35695 
Train Epoch: 47 [286/1000 9152/32000 (29%)] Loss: 0.32196 (QuantReg: 13.13812) QuantErr: 13.13812 batch_time=0.37424 
Train Epoch: 47 [291/1000 9312/32000 (29%)] Loss: 0.27435 (QuantReg: 12.94538) QuantErr: 12.94538 batch_time=0.34951 
Train Epoch: 47 [296/1000 9472/32000 (30%)] Loss: 0.22180 (QuantReg: 12.65602) QuantErr: 12.65602 batch_time=0.34740 
Train Epoch: 47 [301/1000 9632/32000 (30%)] Loss: 0.67592 (QuantReg: 12.49330) QuantErr: 12.49330 batch_time=0.43509 
Train Epoch: 47 [306/1000 9792/32000 (31%)] Loss: 0.37547 (QuantReg: 12.84267) QuantErr: 12.84267 batch_time=0.43383 
Train Epoch: 47 [311/1000 9952/32000 (31%)] Loss: 0.28612 (QuantReg: 12.63556) QuantErr: 12.63556 batch_time=0.35548 
Train Epoch: 47 [316/1000 10112/32000 (32%)] Loss: 0.19793 (QuantReg: 13.39384) QuantErr: 13.39384 batch_time=0.39081 
Train Epoch: 47 [321/1000 10272/32000 (32%)] Loss: 0.41567 (QuantReg: 13.00225) QuantErr: 13.00225 batch_time=0.71945 
Train Epoch: 47 [326/1000 10432/32000 (33%)] Loss: 0.29642 (QuantReg: 13.03779) QuantErr: 13.03779 batch_time=0.38315 
Train Epoch: 47 [331/1000 10592/32000 (33%)] Loss: 0.23607 (QuantReg: 12.96888) QuantErr: 12.96888 batch_time=0.39419 
Train Epoch: 47 [336/1000 10752/32000 (34%)] Loss: 0.11567 (QuantReg: 13.08120) QuantErr: 13.08120 batch_time=0.42780 
Train Epoch: 47 [341/1000 10912/32000 (34%)] Loss: 0.32476 (QuantReg: 13.50549) QuantErr: 13.50549 batch_time=0.35852 
Train Epoch: 47 [346/1000 11072/32000 (35%)] Loss: 0.31307 (QuantReg: 12.90641) QuantErr: 12.90641 batch_time=0.38418 
Train Epoch: 47 [351/1000 11232/32000 (35%)] Loss: 0.34605 (QuantReg: 13.45336) QuantErr: 13.45336 batch_time=0.35246 
Train Epoch: 47 [356/1000 11392/32000 (36%)] Loss: 0.08708 (QuantReg: 13.23303) QuantErr: 13.23303 batch_time=0.35105 
Train Epoch: 47 [361/1000 11552/32000 (36%)] Loss: 0.14401 (QuantReg: 12.95948) QuantErr: 12.95948 batch_time=0.41315 
Train Epoch: 47 [366/1000 11712/32000 (37%)] Loss: 0.15036 (QuantReg: 13.24130) QuantErr: 13.24130 batch_time=0.35442 
Train Epoch: 47 [371/1000 11872/32000 (37%)] Loss: 0.25780 (QuantReg: 12.89734) QuantErr: 12.89734 batch_time=0.35760 
Train Epoch: 47 [376/1000 12032/32000 (38%)] Loss: 0.47602 (QuantReg: 13.53758) QuantErr: 13.53758 batch_time=0.38442 
Train Epoch: 47 [381/1000 12192/32000 (38%)] Loss: 0.33970 (QuantReg: 12.53168) QuantErr: 12.53168 batch_time=0.35798 
Train Epoch: 47 [386/1000 12352/32000 (39%)] Loss: 0.21016 (QuantReg: 13.03911) QuantErr: 13.03911 batch_time=0.35421 
Train Epoch: 47 [391/1000 12512/32000 (39%)] Loss: 0.30772 (QuantReg: 13.20257) QuantErr: 13.20257 batch_time=0.44982 
Train Epoch: 47 [396/1000 12672/32000 (40%)] Loss: 0.24946 (QuantReg: 12.94160) QuantErr: 12.94160 batch_time=0.45714 
Train Epoch: 47 [401/1000 12832/32000 (40%)] Loss: 0.43865 (QuantReg: 12.59374) QuantErr: 12.59374 batch_time=0.44694 
Train Epoch: 47 [406/1000 12992/32000 (41%)] Loss: 0.04669 (QuantReg: 12.12382) QuantErr: 12.12382 batch_time=0.35531 
Train Epoch: 47 [411/1000 13152/32000 (41%)] Loss: 0.29229 (QuantReg: 13.06712) QuantErr: 13.06712 batch_time=0.36231 
Train Epoch: 47 [416/1000 13312/32000 (42%)] Loss: 0.14809 (QuantReg: 13.28045) QuantErr: 13.28045 batch_time=0.36477 
Train Epoch: 47 [421/1000 13472/32000 (42%)] Loss: 0.40654 (QuantReg: 12.90463) QuantErr: 12.90463 batch_time=0.38600 
Train Epoch: 47 [426/1000 13632/32000 (43%)] Loss: 0.20584 (QuantReg: 13.17782) QuantErr: 13.17782 batch_time=0.37880 
Train Epoch: 47 [431/1000 13792/32000 (43%)] Loss: 0.31489 (QuantReg: 12.82102) QuantErr: 12.82102 batch_time=0.36538 
Train Epoch: 47 [436/1000 13952/32000 (44%)] Loss: 0.29604 (QuantReg: 13.51140) QuantErr: 13.51140 batch_time=0.36092 
Train Epoch: 47 [441/1000 14112/32000 (44%)] Loss: 0.12914 (QuantReg: 12.46310) QuantErr: 12.46310 batch_time=0.38189 
Train Epoch: 47 [446/1000 14272/32000 (45%)] Loss: 0.50893 (QuantReg: 12.45062) QuantErr: 12.45062 batch_time=0.39581 
Train Epoch: 47 [451/1000 14432/32000 (45%)] Loss: 0.29846 (QuantReg: 13.43144) QuantErr: 13.43144 batch_time=0.43685 
Train Epoch: 47 [456/1000 14592/32000 (46%)] Loss: 0.54381 (QuantReg: 12.13547) QuantErr: 12.13547 batch_time=0.39710 
Train Epoch: 47 [461/1000 14752/32000 (46%)] Loss: 0.35334 (QuantReg: 12.49184) QuantErr: 12.49184 batch_time=0.43399 
Train Epoch: 47 [466/1000 14912/32000 (47%)] Loss: 0.15767 (QuantReg: 12.87717) QuantErr: 12.87717 batch_time=0.37604 
Train Epoch: 47 [471/1000 15072/32000 (47%)] Loss: 0.61112 (QuantReg: 12.97896) QuantErr: 12.97896 batch_time=0.41472 
Train Epoch: 47 [476/1000 15232/32000 (48%)] Loss: 0.29404 (QuantReg: 13.19423) QuantErr: 13.19423 batch_time=0.35388 
Train Epoch: 47 [481/1000 15392/32000 (48%)] Loss: 0.15478 (QuantReg: 13.16023) QuantErr: 13.16023 batch_time=0.59094 
Train Epoch: 47 [486/1000 15552/32000 (49%)] Loss: 0.54680 (QuantReg: 12.96180) QuantErr: 12.96180 batch_time=0.37566 
Train Epoch: 47 [491/1000 15712/32000 (49%)] Loss: 0.09702 (QuantReg: 13.08981) QuantErr: 13.08981 batch_time=0.38001 
Train Epoch: 47 [496/1000 15872/32000 (50%)] Loss: 0.33768 (QuantReg: 12.63401) QuantErr: 12.63401 batch_time=0.35628 
Train Epoch: 47 [501/1000 16032/32000 (50%)] Loss: 0.35707 (QuantReg: 13.31879) QuantErr: 13.31879 batch_time=0.35230 
Train Epoch: 47 [506/1000 16192/32000 (51%)] Loss: 0.26460 (QuantReg: 13.36061) QuantErr: 13.36061 batch_time=0.37460 
Train Epoch: 47 [511/1000 16352/32000 (51%)] Loss: 0.11007 (QuantReg: 13.40999) QuantErr: 13.40999 batch_time=0.34743 
Train Epoch: 47 [516/1000 16512/32000 (52%)] Loss: 0.24924 (QuantReg: 12.88982) QuantErr: 12.88982 batch_time=0.35187 
Train Epoch: 47 [521/1000 16672/32000 (52%)] Loss: 0.20674 (QuantReg: 13.18827) QuantErr: 13.18827 batch_time=0.38592 
Train Epoch: 47 [526/1000 16832/32000 (53%)] Loss: 0.55511 (QuantReg: 13.10170) QuantErr: 13.10170 batch_time=0.37457 
Train Epoch: 47 [531/1000 16992/32000 (53%)] Loss: 0.27219 (QuantReg: 12.98280) QuantErr: 12.98280 batch_time=0.55050 
Train Epoch: 47 [536/1000 17152/32000 (54%)] Loss: 0.32758 (QuantReg: 12.68781) QuantErr: 12.68781 batch_time=1.33145 
Train Epoch: 47 [541/1000 17312/32000 (54%)] Loss: 0.28855 (QuantReg: 13.37028) QuantErr: 13.37028 batch_time=0.35611 
Train Epoch: 47 [546/1000 17472/32000 (55%)] Loss: 0.36603 (QuantReg: 12.94713) QuantErr: 12.94713 batch_time=0.36614 
Train Epoch: 47 [551/1000 17632/32000 (55%)] Loss: 0.55277 (QuantReg: 12.51680) QuantErr: 12.51680 batch_time=0.35794 
Train Epoch: 47 [556/1000 17792/32000 (56%)] Loss: 0.22387 (QuantReg: 12.72449) QuantErr: 12.72449 batch_time=0.37516 
Train Epoch: 47 [561/1000 17952/32000 (56%)] Loss: 0.32108 (QuantReg: 12.66575) QuantErr: 12.66575 batch_time=0.35414 
Train Epoch: 47 [566/1000 18112/32000 (57%)] Loss: 0.28494 (QuantReg: 12.68190) QuantErr: 12.68190 batch_time=0.35313 
Train Epoch: 47 [571/1000 18272/32000 (57%)] Loss: 0.22627 (QuantReg: 13.01406) QuantErr: 13.01406 batch_time=0.38679 
Train Epoch: 47 [576/1000 18432/32000 (58%)] Loss: 0.57429 (QuantReg: 12.76096) QuantErr: 12.76096 batch_time=0.35237 
Train Epoch: 47 [581/1000 18592/32000 (58%)] Loss: 0.16722 (QuantReg: 13.30697) QuantErr: 13.30697 batch_time=0.35527 
Train Epoch: 47 [586/1000 18752/32000 (59%)] Loss: 0.37956 (QuantReg: 12.62443) QuantErr: 12.62443 batch_time=0.35478 
Train Epoch: 47 [591/1000 18912/32000 (59%)] Loss: 0.12517 (QuantReg: 12.99097) QuantErr: 12.99097 batch_time=0.34893 
Train Epoch: 47 [596/1000 19072/32000 (60%)] Loss: 0.27280 (QuantReg: 12.46119) QuantErr: 12.46119 batch_time=0.39327 
Train Epoch: 47 [601/1000 19232/32000 (60%)] Loss: 0.39669 (QuantReg: 13.18792) QuantErr: 13.18792 batch_time=0.39485 
Train Epoch: 47 [606/1000 19392/32000 (61%)] Loss: 0.20873 (QuantReg: 12.81798) QuantErr: 12.81798 batch_time=0.35535 
Train Epoch: 47 [611/1000 19552/32000 (61%)] Loss: 0.72037 (QuantReg: 12.34541) QuantErr: 12.34541 batch_time=0.36830 
Train Epoch: 47 [616/1000 19712/32000 (62%)] Loss: 0.14587 (QuantReg: 12.69361) QuantErr: 12.69361 batch_time=0.37309 
Train Epoch: 47 [621/1000 19872/32000 (62%)] Loss: 0.20394 (QuantReg: 13.65244) QuantErr: 13.65244 batch_time=0.44450 
Train Epoch: 47 [626/1000 20032/32000 (63%)] Loss: 0.37989 (QuantReg: 12.96129) QuantErr: 12.96129 batch_time=0.36293 
Train Epoch: 47 [631/1000 20192/32000 (63%)] Loss: 0.46127 (QuantReg: 13.27841) QuantErr: 13.27841 batch_time=0.43954 
Train Epoch: 47 [636/1000 20352/32000 (64%)] Loss: 0.42530 (QuantReg: 13.45027) QuantErr: 13.45027 batch_time=0.35809 
Train Epoch: 47 [641/1000 20512/32000 (64%)] Loss: 0.55246 (QuantReg: 12.67993) QuantErr: 12.67993 batch_time=0.71008 
Train Epoch: 47 [646/1000 20672/32000 (65%)] Loss: 0.18830 (QuantReg: 12.85810) QuantErr: 12.85810 batch_time=0.35287 
Train Epoch: 47 [651/1000 20832/32000 (65%)] Loss: 0.36314 (QuantReg: 12.92608) QuantErr: 12.92608 batch_time=0.35440 
Train Epoch: 47 [656/1000 20992/32000 (66%)] Loss: 0.09718 (QuantReg: 12.21740) QuantErr: 12.21740 batch_time=0.42593 
Train Epoch: 47 [661/1000 21152/32000 (66%)] Loss: 0.17031 (QuantReg: 13.02696) QuantErr: 13.02696 batch_time=0.36386 
Train Epoch: 47 [666/1000 21312/32000 (67%)] Loss: 0.23041 (QuantReg: 13.46176) QuantErr: 13.46176 batch_time=0.45056 
Train Epoch: 47 [671/1000 21472/32000 (67%)] Loss: 0.17399 (QuantReg: 13.08910) QuantErr: 13.08910 batch_time=0.37032 
Train Epoch: 47 [676/1000 21632/32000 (68%)] Loss: 0.08782 (QuantReg: 13.57410) QuantErr: 13.57410 batch_time=0.35407 
Train Epoch: 47 [681/1000 21792/32000 (68%)] Loss: 0.22239 (QuantReg: 12.96600) QuantErr: 12.96600 batch_time=0.36641 
Train Epoch: 47 [686/1000 21952/32000 (69%)] Loss: 0.31705 (QuantReg: 13.23361) QuantErr: 13.23361 batch_time=0.35823 
Train Epoch: 47 [691/1000 22112/32000 (69%)] Loss: 0.28900 (QuantReg: 12.63191) QuantErr: 12.63191 batch_time=0.38985 
Train Epoch: 47 [696/1000 22272/32000 (70%)] Loss: 0.39691 (QuantReg: 13.05127) QuantErr: 13.05127 batch_time=0.38989 
Train Epoch: 47 [701/1000 22432/32000 (70%)] Loss: 0.30995 (QuantReg: 12.97001) QuantErr: 12.97001 batch_time=0.39113 
Train Epoch: 47 [706/1000 22592/32000 (71%)] Loss: 0.39627 (QuantReg: 12.69536) QuantErr: 12.69536 batch_time=0.41902 
Train Epoch: 47 [711/1000 22752/32000 (71%)] Loss: 0.28358 (QuantReg: 12.94086) QuantErr: 12.94086 batch_time=0.35599 
Train Epoch: 47 [716/1000 22912/32000 (72%)] Loss: 0.12430 (QuantReg: 13.14954) QuantErr: 13.14954 batch_time=0.37032 
Train Epoch: 47 [721/1000 23072/32000 (72%)] Loss: 0.34269 (QuantReg: 13.25295) QuantErr: 13.25295 batch_time=0.50407 
Train Epoch: 47 [726/1000 23232/32000 (73%)] Loss: 0.36693 (QuantReg: 13.19506) QuantErr: 13.19506 batch_time=0.36364 
Train Epoch: 47 [731/1000 23392/32000 (73%)] Loss: 0.25777 (QuantReg: 12.91591) QuantErr: 12.91591 batch_time=0.34760 
Train Epoch: 47 [736/1000 23552/32000 (74%)] Loss: 0.33083 (QuantReg: 12.97288) QuantErr: 12.97288 batch_time=0.35142 
Train Epoch: 47 [741/1000 23712/32000 (74%)] Loss: 0.31492 (QuantReg: 12.60121) QuantErr: 12.60121 batch_time=0.38083 
Train Epoch: 47 [746/1000 23872/32000 (75%)] Loss: 0.38091 (QuantReg: 13.24763) QuantErr: 13.24763 batch_time=0.38687 
Train Epoch: 47 [751/1000 24032/32000 (75%)] Loss: 0.30464 (QuantReg: 13.46165) QuantErr: 13.46165 batch_time=0.36142 
Train Epoch: 47 [756/1000 24192/32000 (76%)] Loss: 0.23193 (QuantReg: 13.20667) QuantErr: 13.20667 batch_time=0.34911 
Train Epoch: 47 [761/1000 24352/32000 (76%)] Loss: 0.30823 (QuantReg: 12.99610) QuantErr: 12.99610 batch_time=0.37136 
Train Epoch: 47 [766/1000 24512/32000 (77%)] Loss: 0.12848 (QuantReg: 13.38680) QuantErr: 13.38680 batch_time=0.35678 
Train Epoch: 47 [771/1000 24672/32000 (77%)] Loss: 0.29406 (QuantReg: 12.70681) QuantErr: 12.70681 batch_time=0.42469 
Train Epoch: 47 [776/1000 24832/32000 (78%)] Loss: 0.18132 (QuantReg: 13.11951) QuantErr: 13.11951 batch_time=0.35375 
Train Epoch: 47 [781/1000 24992/32000 (78%)] Loss: 0.16144 (QuantReg: 13.33059) QuantErr: 13.33059 batch_time=0.36275 
Train Epoch: 47 [786/1000 25152/32000 (79%)] Loss: 0.41814 (QuantReg: 12.91768) QuantErr: 12.91768 batch_time=0.35030 
Train Epoch: 47 [791/1000 25312/32000 (79%)] Loss: 0.34254 (QuantReg: 13.29378) QuantErr: 13.29378 batch_time=0.35361 
Train Epoch: 47 [796/1000 25472/32000 (80%)] Loss: 0.12130 (QuantReg: 12.92684) QuantErr: 12.92684 batch_time=0.35370 
Train Epoch: 47 [801/1000 25632/32000 (80%)] Loss: 0.17922 (QuantReg: 12.52347) QuantErr: 12.52347 batch_time=0.61040 
Train Epoch: 47 [806/1000 25792/32000 (81%)] Loss: 0.22487 (QuantReg: 12.84155) QuantErr: 12.84155 batch_time=0.35681 
Train Epoch: 47 [811/1000 25952/32000 (81%)] Loss: 0.49053 (QuantReg: 12.57971) QuantErr: 12.57971 batch_time=0.34858 
Train Epoch: 47 [816/1000 26112/32000 (82%)] Loss: 0.18813 (QuantReg: 12.72420) QuantErr: 12.72420 batch_time=0.35278 
Train Epoch: 47 [821/1000 26272/32000 (82%)] Loss: 0.06450 (QuantReg: 13.13230) QuantErr: 13.13230 batch_time=0.37943 
Train Epoch: 47 [826/1000 26432/32000 (83%)] Loss: 0.26812 (QuantReg: 12.49016) QuantErr: 12.49016 batch_time=0.35078 
Train Epoch: 47 [831/1000 26592/32000 (83%)] Loss: 0.26325 (QuantReg: 13.36497) QuantErr: 13.36497 batch_time=0.36629 
Train Epoch: 47 [836/1000 26752/32000 (84%)] Loss: 0.41009 (QuantReg: 13.05533) QuantErr: 13.05533 batch_time=0.37200 
Train Epoch: 47 [841/1000 26912/32000 (84%)] Loss: 0.27976 (QuantReg: 13.28581) QuantErr: 13.28581 batch_time=0.35597 
Train Epoch: 47 [846/1000 27072/32000 (85%)] Loss: 0.30873 (QuantReg: 12.86156) QuantErr: 12.86156 batch_time=0.35512 
Train Epoch: 47 [851/1000 27232/32000 (85%)] Loss: 0.16337 (QuantReg: 13.31655) QuantErr: 13.31655 batch_time=0.56327 
Train Epoch: 47 [856/1000 27392/32000 (86%)] Loss: 0.43852 (QuantReg: 13.12650) QuantErr: 13.12650 batch_time=1.36842 
Train Epoch: 47 [861/1000 27552/32000 (86%)] Loss: 0.42538 (QuantReg: 13.11231) QuantErr: 13.11231 batch_time=0.37233 
Train Epoch: 47 [866/1000 27712/32000 (87%)] Loss: 0.17921 (QuantReg: 13.79196) QuantErr: 13.79196 batch_time=0.35355 
Train Epoch: 47 [871/1000 27872/32000 (87%)] Loss: 0.14707 (QuantReg: 12.70251) QuantErr: 12.70251 batch_time=0.41561 
Train Epoch: 47 [876/1000 28032/32000 (88%)] Loss: 0.16448 (QuantReg: 12.97195) QuantErr: 12.97195 batch_time=0.40287 
Train Epoch: 47 [881/1000 28192/32000 (88%)] Loss: 0.34855 (QuantReg: 12.55285) QuantErr: 12.55285 batch_time=0.36905 
Train Epoch: 47 [886/1000 28352/32000 (89%)] Loss: 0.06238 (QuantReg: 13.18200) QuantErr: 13.18200 batch_time=0.35245 
Train Epoch: 47 [891/1000 28512/32000 (89%)] Loss: 0.53623 (QuantReg: 12.49901) QuantErr: 12.49901 batch_time=0.37566 
Train Epoch: 47 [896/1000 28672/32000 (90%)] Loss: 0.49889 (QuantReg: 12.45874) QuantErr: 12.45874 batch_time=0.39753 
Train Epoch: 47 [901/1000 28832/32000 (90%)] Loss: 0.42391 (QuantReg: 12.94804) QuantErr: 12.94804 batch_time=0.35707 
Train Epoch: 47 [906/1000 28992/32000 (91%)] Loss: 0.30274 (QuantReg: 13.43009) QuantErr: 13.43009 batch_time=0.35429 
Train Epoch: 47 [911/1000 29152/32000 (91%)] Loss: 0.19128 (QuantReg: 13.03235) QuantErr: 13.03235 batch_time=0.37263 
Train Epoch: 47 [916/1000 29312/32000 (92%)] Loss: 0.27607 (QuantReg: 12.34559) QuantErr: 12.34559 batch_time=0.36421 
Train Epoch: 47 [921/1000 29472/32000 (92%)] Loss: 0.45302 (QuantReg: 12.54023) QuantErr: 12.54023 batch_time=0.38570 
Train Epoch: 47 [926/1000 29632/32000 (93%)] Loss: 0.16200 (QuantReg: 12.46126) QuantErr: 12.46126 batch_time=0.36817 
Train Epoch: 47 [931/1000 29792/32000 (93%)] Loss: 0.34643 (QuantReg: 12.90055) QuantErr: 12.90055 batch_time=0.39903 
Train Epoch: 47 [936/1000 29952/32000 (94%)] Loss: 0.09872 (QuantReg: 13.44946) QuantErr: 13.44946 batch_time=0.41263 
Train Epoch: 47 [941/1000 30112/32000 (94%)] Loss: 0.56155 (QuantReg: 12.47180) QuantErr: 12.47180 batch_time=0.41744 
Train Epoch: 47 [946/1000 30272/32000 (95%)] Loss: 0.33594 (QuantReg: 12.89887) QuantErr: 12.89887 batch_time=0.35934 
Train Epoch: 47 [951/1000 30432/32000 (95%)] Loss: 0.11661 (QuantReg: 12.82533) QuantErr: 12.82533 batch_time=0.35899 
Train Epoch: 47 [956/1000 30592/32000 (96%)] Loss: 0.33960 (QuantReg: 13.40312) QuantErr: 13.40312 batch_time=0.40975 
Train Epoch: 47 [961/1000 30752/32000 (96%)] Loss: 0.44110 (QuantReg: 12.62677) QuantErr: 12.62677 batch_time=0.68843 
Train Epoch: 47 [966/1000 30912/32000 (97%)] Loss: 0.24649 (QuantReg: 12.89814) QuantErr: 12.89814 batch_time=0.37844 
Train Epoch: 47 [971/1000 31072/32000 (97%)] Loss: 0.19644 (QuantReg: 13.63382) QuantErr: 13.63382 batch_time=0.35942 
Train Epoch: 47 [976/1000 31232/32000 (98%)] Loss: 0.21071 (QuantReg: 12.70074) QuantErr: 12.70074 batch_time=0.42666 
Train Epoch: 47 [981/1000 31392/32000 (98%)] Loss: 0.08182 (QuantReg: 13.48286) QuantErr: 13.48286 batch_time=0.37814 
Train Epoch: 47 [986/1000 31552/32000 (99%)] Loss: 0.18531 (QuantReg: 13.50774) QuantErr: 13.50774 batch_time=0.35439 
Train Epoch: 47 [991/1000 31712/32000 (99%)] Loss: 0.22410 (QuantReg: 13.12764) QuantErr: 13.12764 batch_time=0.38044 
Train Epoch: 47 [996/1000 31872/32000 (100%)] Loss: 0.14879 (QuantReg: 13.23138) QuantErr: 13.23138 batch_time=0.35863 
Train Epoch: 47 codebook_update_time=1.95999
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch47.pth ...
Done in 19.489s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch47.pth ...
Done in 23.636s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 47
 loss           : 0.2899298016950488
 quant_reg      : 12.977276534080506
 quant_err      : 12.977276534080506
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 47000
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.100603621730382
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.19059947345089
 MSRVTT_full_val/v2t_metrics/R1: 36.01609657947686
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.0241448692152915
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.30644109315369
 MSRVTT_full_test/t2v_metrics/R1: 13.678929765886288
 MSRVTT_full_test/t2v_metrics/R5: 37.65886287625418
 MSRVTT_full_test/t2v_metrics/R10: 51.17056856187291
 MSRVTT_full_test/t2v_metrics/R50: 80.33444816053512
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.79464882943144
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.760931582380124
 MSRVTT_full_test/v2t_metrics/R1: 16.220735785953178
 MSRVTT_full_test/v2t_metrics/R5: 44.046822742474916
 MSRVTT_full_test/v2t_metrics/R10: 59.364548494983275
 MSRVTT_full_test/v2t_metrics/R50: 86.35451505016722
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.62742474916388
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.87418780530095
 mnt_best       : 29.760931582380124
 not_improved_count: 0
Train Epoch: 48 [1/1000 32/32000 (0%)] Loss: 0.63415 (QuantReg: 12.86612) QuantErr: 12.86612 batch_time=30.20486 
Train Epoch: 48 [6/1000 192/32000 (1%)] Loss: 0.18168 (QuantReg: 13.00443) QuantErr: 13.00443 batch_time=0.35403 
Train Epoch: 48 [11/1000 352/32000 (1%)] Loss: 0.21317 (QuantReg: 12.90564) QuantErr: 12.90564 batch_time=0.42631 
Train Epoch: 48 [16/1000 512/32000 (2%)] Loss: 0.16412 (QuantReg: 12.79733) QuantErr: 12.79733 batch_time=0.46722 
Train Epoch: 48 [21/1000 672/32000 (2%)] Loss: 0.36944 (QuantReg: 12.84537) QuantErr: 12.84537 batch_time=0.46842 
Train Epoch: 48 [26/1000 832/32000 (3%)] Loss: 0.28310 (QuantReg: 12.94695) QuantErr: 12.94695 batch_time=0.43590 
Train Epoch: 48 [31/1000 992/32000 (3%)] Loss: 0.40584 (QuantReg: 12.94438) QuantErr: 12.94438 batch_time=0.40115 
Train Epoch: 48 [36/1000 1152/32000 (4%)] Loss: 0.20964 (QuantReg: 12.83272) QuantErr: 12.83272 batch_time=0.37358 
Train Epoch: 48 [41/1000 1312/32000 (4%)] Loss: 0.07333 (QuantReg: 13.94172) QuantErr: 13.94172 batch_time=0.41259 
Train Epoch: 48 [46/1000 1472/32000 (5%)] Loss: 0.09643 (QuantReg: 13.52626) QuantErr: 13.52626 batch_time=0.39166 
Train Epoch: 48 [51/1000 1632/32000 (5%)] Loss: 0.39218 (QuantReg: 12.54448) QuantErr: 12.54448 batch_time=0.55544 
Train Epoch: 48 [56/1000 1792/32000 (6%)] Loss: 0.24932 (QuantReg: 12.81669) QuantErr: 12.81669 batch_time=0.36656 
Train Epoch: 48 [61/1000 1952/32000 (6%)] Loss: 0.21710 (QuantReg: 13.22500) QuantErr: 13.22500 batch_time=0.35339 
Train Epoch: 48 [66/1000 2112/32000 (7%)] Loss: 0.41852 (QuantReg: 12.95109) QuantErr: 12.95109 batch_time=1.84748 
Train Epoch: 48 [71/1000 2272/32000 (7%)] Loss: 0.33543 (QuantReg: 12.82710) QuantErr: 12.82710 batch_time=0.38147 
Train Epoch: 48 [76/1000 2432/32000 (8%)] Loss: 0.23012 (QuantReg: 12.89115) QuantErr: 12.89115 batch_time=0.39022 
Train Epoch: 48 [81/1000 2592/32000 (8%)] Loss: 0.16327 (QuantReg: 12.87440) QuantErr: 12.87440 batch_time=0.45116 
Train Epoch: 48 [86/1000 2752/32000 (9%)] Loss: 0.30575 (QuantReg: 13.07617) QuantErr: 13.07617 batch_time=0.39856 
Train Epoch: 48 [91/1000 2912/32000 (9%)] Loss: 0.25001 (QuantReg: 12.80948) QuantErr: 12.80948 batch_time=0.39249 
Train Epoch: 48 [96/1000 3072/32000 (10%)] Loss: 0.32278 (QuantReg: 12.79269) QuantErr: 12.79269 batch_time=0.40062 
Train Epoch: 48 [101/1000 3232/32000 (10%)] Loss: 0.11001 (QuantReg: 13.22078) QuantErr: 13.22078 batch_time=0.38949 
Train Epoch: 48 [106/1000 3392/32000 (11%)] Loss: 0.31547 (QuantReg: 13.06329) QuantErr: 13.06329 batch_time=0.40074 
Train Epoch: 48 [111/1000 3552/32000 (11%)] Loss: 0.33412 (QuantReg: 12.69719) QuantErr: 12.69719 batch_time=0.45960 
Train Epoch: 48 [116/1000 3712/32000 (12%)] Loss: 0.23701 (QuantReg: 12.83009) QuantErr: 12.83009 batch_time=0.38748 
Train Epoch: 48 [121/1000 3872/32000 (12%)] Loss: 0.43767 (QuantReg: 12.86079) QuantErr: 12.86079 batch_time=0.50250 
Train Epoch: 48 [126/1000 4032/32000 (13%)] Loss: 0.24966 (QuantReg: 12.60388) QuantErr: 12.60388 batch_time=0.43554 
Train Epoch: 48 [131/1000 4192/32000 (13%)] Loss: 0.08291 (QuantReg: 12.91466) QuantErr: 12.91466 batch_time=0.40659 
Train Epoch: 48 [136/1000 4352/32000 (14%)] Loss: 0.26454 (QuantReg: 13.30841) QuantErr: 13.30841 batch_time=0.47410 
Train Epoch: 48 [141/1000 4512/32000 (14%)] Loss: 0.69904 (QuantReg: 12.84006) QuantErr: 12.84006 batch_time=0.42285 
Train Epoch: 48 [146/1000 4672/32000 (15%)] Loss: 0.06785 (QuantReg: 13.13182) QuantErr: 13.13182 batch_time=0.43500 
Train Epoch: 48 [151/1000 4832/32000 (15%)] Loss: 0.37562 (QuantReg: 12.78916) QuantErr: 12.78916 batch_time=0.39892 
Train Epoch: 48 [156/1000 4992/32000 (16%)] Loss: 0.45249 (QuantReg: 13.51996) QuantErr: 13.51996 batch_time=0.42333 
Train Epoch: 48 [161/1000 5152/32000 (16%)] Loss: 0.21748 (QuantReg: 13.02581) QuantErr: 13.02581 batch_time=0.39136 
Train Epoch: 48 [166/1000 5312/32000 (17%)] Loss: 0.32091 (QuantReg: 12.61556) QuantErr: 12.61556 batch_time=0.42068 
Train Epoch: 48 [171/1000 5472/32000 (17%)] Loss: 0.15883 (QuantReg: 12.87004) QuantErr: 12.87004 batch_time=0.38750 
Train Epoch: 48 [176/1000 5632/32000 (18%)] Loss: 0.21043 (QuantReg: 12.95746) QuantErr: 12.95746 batch_time=0.39287 
Train Epoch: 48 [181/1000 5792/32000 (18%)] Loss: 0.15601 (QuantReg: 12.80430) QuantErr: 12.80430 batch_time=0.37797 
Train Epoch: 48 [186/1000 5952/32000 (19%)] Loss: 0.21856 (QuantReg: 13.25764) QuantErr: 13.25764 batch_time=0.36606 
Train Epoch: 48 [191/1000 6112/32000 (19%)] Loss: 0.31069 (QuantReg: 12.58002) QuantErr: 12.58002 batch_time=0.38122 
Train Epoch: 48 [196/1000 6272/32000 (20%)] Loss: 0.21510 (QuantReg: 12.87143) QuantErr: 12.87143 batch_time=0.39610 
Train Epoch: 48 [201/1000 6432/32000 (20%)] Loss: 0.03990 (QuantReg: 13.20310) QuantErr: 13.20310 batch_time=0.38105 
Train Epoch: 48 [206/1000 6592/32000 (21%)] Loss: 0.14993 (QuantReg: 13.08269) QuantErr: 13.08269 batch_time=0.36253 
Train Epoch: 48 [211/1000 6752/32000 (21%)] Loss: 0.17702 (QuantReg: 13.06690) QuantErr: 13.06690 batch_time=0.39812 
Train Epoch: 48 [216/1000 6912/32000 (22%)] Loss: 0.34976 (QuantReg: 12.95078) QuantErr: 12.95078 batch_time=0.37415 
Train Epoch: 48 [221/1000 7072/32000 (22%)] Loss: 0.13547 (QuantReg: 13.37358) QuantErr: 13.37358 batch_time=0.44848 
Train Epoch: 48 [226/1000 7232/32000 (23%)] Loss: 0.46384 (QuantReg: 12.77062) QuantErr: 12.77062 batch_time=0.39687 
Train Epoch: 48 [231/1000 7392/32000 (23%)] Loss: 0.32096 (QuantReg: 13.31998) QuantErr: 13.31998 batch_time=0.44514 
Train Epoch: 48 [236/1000 7552/32000 (24%)] Loss: 0.51112 (QuantReg: 12.92917) QuantErr: 12.92917 batch_time=0.45339 
Train Epoch: 48 [241/1000 7712/32000 (24%)] Loss: 0.19173 (QuantReg: 12.82731) QuantErr: 12.82731 batch_time=0.40056 
Train Epoch: 48 [246/1000 7872/32000 (25%)] Loss: 0.21398 (QuantReg: 12.26904) QuantErr: 12.26904 batch_time=0.37897 
Train Epoch: 48 [251/1000 8032/32000 (25%)] Loss: 0.30937 (QuantReg: 12.54412) QuantErr: 12.54412 batch_time=0.41515 
Train Epoch: 48 [256/1000 8192/32000 (26%)] Loss: 0.30003 (QuantReg: 12.79757) QuantErr: 12.79757 batch_time=0.36079 
Train Epoch: 48 [261/1000 8352/32000 (26%)] Loss: 0.39255 (QuantReg: 12.55383) QuantErr: 12.55383 batch_time=0.41692 
Train Epoch: 48 [266/1000 8512/32000 (27%)] Loss: 0.30385 (QuantReg: 13.66635) QuantErr: 13.66635 batch_time=0.45968 
Train Epoch: 48 [271/1000 8672/32000 (27%)] Loss: 0.35304 (QuantReg: 12.36321) QuantErr: 12.36321 batch_time=0.39457 
Train Epoch: 48 [276/1000 8832/32000 (28%)] Loss: 0.22611 (QuantReg: 12.89467) QuantErr: 12.89467 batch_time=0.44263 
Train Epoch: 48 [281/1000 8992/32000 (28%)] Loss: 0.17554 (QuantReg: 13.40751) QuantErr: 13.40751 batch_time=0.37448 
Train Epoch: 48 [286/1000 9152/32000 (29%)] Loss: 0.75449 (QuantReg: 13.16678) QuantErr: 13.16678 batch_time=0.41766 
Train Epoch: 48 [291/1000 9312/32000 (29%)] Loss: 0.17148 (QuantReg: 13.22122) QuantErr: 13.22122 batch_time=0.35646 
Train Epoch: 48 [296/1000 9472/32000 (30%)] Loss: 0.28612 (QuantReg: 12.96886) QuantErr: 12.96886 batch_time=0.36807 
Train Epoch: 48 [301/1000 9632/32000 (30%)] Loss: 0.48460 (QuantReg: 13.11243) QuantErr: 13.11243 batch_time=0.38293 
Train Epoch: 48 [306/1000 9792/32000 (31%)] Loss: 0.27268 (QuantReg: 13.15736) QuantErr: 13.15736 batch_time=0.44105 
Train Epoch: 48 [311/1000 9952/32000 (31%)] Loss: 0.31483 (QuantReg: 12.21078) QuantErr: 12.21078 batch_time=0.37914 
Train Epoch: 48 [316/1000 10112/32000 (32%)] Loss: 0.30514 (QuantReg: 13.16802) QuantErr: 13.16802 batch_time=0.36086 
Train Epoch: 48 [321/1000 10272/32000 (32%)] Loss: 0.16513 (QuantReg: 13.08059) QuantErr: 13.08059 batch_time=0.54059 
Train Epoch: 48 [326/1000 10432/32000 (33%)] Loss: 0.18257 (QuantReg: 12.94931) QuantErr: 12.94931 batch_time=0.36610 
Train Epoch: 48 [331/1000 10592/32000 (33%)] Loss: 0.29263 (QuantReg: 12.57045) QuantErr: 12.57045 batch_time=0.40019 
Train Epoch: 48 [336/1000 10752/32000 (34%)] Loss: 0.33013 (QuantReg: 13.15490) QuantErr: 13.15490 batch_time=0.41462 
Train Epoch: 48 [341/1000 10912/32000 (34%)] Loss: 0.26544 (QuantReg: 13.08480) QuantErr: 13.08480 batch_time=0.35712 
Train Epoch: 48 [346/1000 11072/32000 (35%)] Loss: 0.24569 (QuantReg: 12.51040) QuantErr: 12.51040 batch_time=0.35340 
Train Epoch: 48 [351/1000 11232/32000 (35%)] Loss: 0.36076 (QuantReg: 13.53363) QuantErr: 13.53363 batch_time=0.35829 
Train Epoch: 48 [356/1000 11392/32000 (36%)] Loss: 0.18461 (QuantReg: 13.02996) QuantErr: 13.02996 batch_time=0.34957 
Train Epoch: 48 [361/1000 11552/32000 (36%)] Loss: 0.13888 (QuantReg: 13.36436) QuantErr: 13.36436 batch_time=0.40357 
Train Epoch: 48 [366/1000 11712/32000 (37%)] Loss: 0.37968 (QuantReg: 13.20034) QuantErr: 13.20034 batch_time=0.41962 
Train Epoch: 48 [371/1000 11872/32000 (37%)] Loss: 0.24691 (QuantReg: 13.75413) QuantErr: 13.75413 batch_time=0.72762 
Train Epoch: 48 [376/1000 12032/32000 (38%)] Loss: 0.21617 (QuantReg: 13.24225) QuantErr: 13.24225 batch_time=0.36448 
Train Epoch: 48 [381/1000 12192/32000 (38%)] Loss: 0.27162 (QuantReg: 12.49063) QuantErr: 12.49063 batch_time=0.36226 
Train Epoch: 48 [386/1000 12352/32000 (39%)] Loss: 0.13312 (QuantReg: 13.13783) QuantErr: 13.13783 batch_time=1.85122 
Train Epoch: 48 [391/1000 12512/32000 (39%)] Loss: 0.16018 (QuantReg: 13.28661) QuantErr: 13.28661 batch_time=0.34365 
Train Epoch: 48 [396/1000 12672/32000 (40%)] Loss: 0.38144 (QuantReg: 12.47706) QuantErr: 12.47706 batch_time=0.34690 
Train Epoch: 48 [401/1000 12832/32000 (40%)] Loss: 0.41725 (QuantReg: 12.21189) QuantErr: 12.21189 batch_time=0.37169 
Train Epoch: 48 [406/1000 12992/32000 (41%)] Loss: 0.52341 (QuantReg: 12.87968) QuantErr: 12.87968 batch_time=0.36650 
Train Epoch: 48 [411/1000 13152/32000 (41%)] Loss: 0.59264 (QuantReg: 12.70671) QuantErr: 12.70671 batch_time=0.36036 
Train Epoch: 48 [416/1000 13312/32000 (42%)] Loss: 0.35277 (QuantReg: 12.99089) QuantErr: 12.99089 batch_time=0.34540 
Train Epoch: 48 [421/1000 13472/32000 (42%)] Loss: 0.09762 (QuantReg: 13.10159) QuantErr: 13.10159 batch_time=0.37249 
Train Epoch: 48 [426/1000 13632/32000 (43%)] Loss: 0.28883 (QuantReg: 12.80374) QuantErr: 12.80374 batch_time=0.36357 
Train Epoch: 48 [431/1000 13792/32000 (43%)] Loss: 0.42917 (QuantReg: 12.57033) QuantErr: 12.57033 batch_time=0.40736 
Train Epoch: 48 [436/1000 13952/32000 (44%)] Loss: 0.17502 (QuantReg: 12.59295) QuantErr: 12.59295 batch_time=0.38348 
Train Epoch: 48 [441/1000 14112/32000 (44%)] Loss: 0.16329 (QuantReg: 13.30786) QuantErr: 13.30786 batch_time=0.35835 
Train Epoch: 48 [446/1000 14272/32000 (45%)] Loss: 0.26673 (QuantReg: 13.38460) QuantErr: 13.38460 batch_time=0.35797 
Train Epoch: 48 [451/1000 14432/32000 (45%)] Loss: 0.19709 (QuantReg: 13.02753) QuantErr: 13.02753 batch_time=0.35325 
Train Epoch: 48 [456/1000 14592/32000 (46%)] Loss: 0.38782 (QuantReg: 13.23685) QuantErr: 13.23685 batch_time=0.35986 
Train Epoch: 48 [461/1000 14752/32000 (46%)] Loss: 0.39154 (QuantReg: 12.78616) QuantErr: 12.78616 batch_time=0.43981 
Train Epoch: 48 [466/1000 14912/32000 (47%)] Loss: 0.26410 (QuantReg: 12.31425) QuantErr: 12.31425 batch_time=0.39098 
Train Epoch: 48 [471/1000 15072/32000 (47%)] Loss: 0.28521 (QuantReg: 13.11651) QuantErr: 13.11651 batch_time=0.35666 
Train Epoch: 48 [476/1000 15232/32000 (48%)] Loss: 0.37239 (QuantReg: 13.02998) QuantErr: 13.02998 batch_time=0.36013 
Train Epoch: 48 [481/1000 15392/32000 (48%)] Loss: 0.23953 (QuantReg: 13.22751) QuantErr: 13.22751 batch_time=0.40502 
Train Epoch: 48 [486/1000 15552/32000 (49%)] Loss: 0.31954 (QuantReg: 13.09459) QuantErr: 13.09459 batch_time=0.35620 
Train Epoch: 48 [491/1000 15712/32000 (49%)] Loss: 0.19368 (QuantReg: 13.02459) QuantErr: 13.02459 batch_time=0.39041 
Train Epoch: 48 [496/1000 15872/32000 (50%)] Loss: 0.22896 (QuantReg: 13.00132) QuantErr: 13.00132 batch_time=0.39671 
Train Epoch: 48 [501/1000 16032/32000 (50%)] Loss: 0.17437 (QuantReg: 13.07230) QuantErr: 13.07230 batch_time=0.42182 
Train Epoch: 48 [506/1000 16192/32000 (51%)] Loss: 0.25679 (QuantReg: 12.89196) QuantErr: 12.89196 batch_time=0.41825 
Train Epoch: 48 [511/1000 16352/32000 (51%)] Loss: 0.28730 (QuantReg: 12.99047) QuantErr: 12.99047 batch_time=0.37391 
Train Epoch: 48 [516/1000 16512/32000 (52%)] Loss: 0.14253 (QuantReg: 12.84965) QuantErr: 12.84965 batch_time=0.35760 
Train Epoch: 48 [521/1000 16672/32000 (52%)] Loss: 0.23060 (QuantReg: 12.98082) QuantErr: 12.98082 batch_time=0.41696 
Train Epoch: 48 [526/1000 16832/32000 (53%)] Loss: 0.46235 (QuantReg: 13.31680) QuantErr: 13.31680 batch_time=0.35727 
Train Epoch: 48 [531/1000 16992/32000 (53%)] Loss: 0.14228 (QuantReg: 13.19888) QuantErr: 13.19888 batch_time=0.44064 
Train Epoch: 48 [536/1000 17152/32000 (54%)] Loss: 0.15550 (QuantReg: 12.90263) QuantErr: 12.90263 batch_time=0.39122 
Train Epoch: 48 [541/1000 17312/32000 (54%)] Loss: 0.21446 (QuantReg: 13.26127) QuantErr: 13.26127 batch_time=0.44150 
Train Epoch: 48 [546/1000 17472/32000 (55%)] Loss: 0.21934 (QuantReg: 13.33232) QuantErr: 13.33232 batch_time=0.35582 
Train Epoch: 48 [551/1000 17632/32000 (55%)] Loss: 0.47403 (QuantReg: 13.11440) QuantErr: 13.11440 batch_time=0.35846 
Train Epoch: 48 [556/1000 17792/32000 (56%)] Loss: 0.40301 (QuantReg: 13.59088) QuantErr: 13.59088 batch_time=0.35632 
Train Epoch: 48 [561/1000 17952/32000 (56%)] Loss: 0.28845 (QuantReg: 13.28063) QuantErr: 13.28063 batch_time=0.35589 
Train Epoch: 48 [566/1000 18112/32000 (57%)] Loss: 0.23258 (QuantReg: 13.03962) QuantErr: 13.03962 batch_time=0.41674 
Train Epoch: 48 [571/1000 18272/32000 (57%)] Loss: 0.44393 (QuantReg: 12.97043) QuantErr: 12.97043 batch_time=0.38775 
Train Epoch: 48 [576/1000 18432/32000 (58%)] Loss: 0.06297 (QuantReg: 13.27563) QuantErr: 13.27563 batch_time=0.35600 
Train Epoch: 48 [581/1000 18592/32000 (58%)] Loss: 0.28724 (QuantReg: 13.18940) QuantErr: 13.18940 batch_time=0.35874 
Train Epoch: 48 [586/1000 18752/32000 (59%)] Loss: 0.33819 (QuantReg: 12.98220) QuantErr: 12.98220 batch_time=0.38965 
Train Epoch: 48 [591/1000 18912/32000 (59%)] Loss: 0.16555 (QuantReg: 13.36796) QuantErr: 13.36796 batch_time=0.36098 
Train Epoch: 48 [596/1000 19072/32000 (60%)] Loss: 0.25414 (QuantReg: 13.23075) QuantErr: 13.23075 batch_time=0.38528 
Train Epoch: 48 [601/1000 19232/32000 (60%)] Loss: 0.51561 (QuantReg: 13.18822) QuantErr: 13.18822 batch_time=0.35717 
Train Epoch: 48 [606/1000 19392/32000 (61%)] Loss: 0.21210 (QuantReg: 13.34089) QuantErr: 13.34089 batch_time=0.38415 
Train Epoch: 48 [611/1000 19552/32000 (61%)] Loss: 0.18922 (QuantReg: 12.93445) QuantErr: 12.93445 batch_time=0.35402 
Train Epoch: 48 [616/1000 19712/32000 (62%)] Loss: 0.24157 (QuantReg: 12.99728) QuantErr: 12.99728 batch_time=0.35816 
Train Epoch: 48 [621/1000 19872/32000 (62%)] Loss: 0.07372 (QuantReg: 13.41167) QuantErr: 13.41167 batch_time=0.37617 
Train Epoch: 48 [626/1000 20032/32000 (63%)] Loss: 0.27109 (QuantReg: 13.10417) QuantErr: 13.10417 batch_time=0.35760 
Train Epoch: 48 [631/1000 20192/32000 (63%)] Loss: 0.32074 (QuantReg: 12.37826) QuantErr: 12.37826 batch_time=0.36982 
Train Epoch: 48 [636/1000 20352/32000 (64%)] Loss: 0.12647 (QuantReg: 12.86367) QuantErr: 12.86367 batch_time=0.36842 
Train Epoch: 48 [641/1000 20512/32000 (64%)] Loss: 0.10222 (QuantReg: 12.96673) QuantErr: 12.96673 batch_time=0.59236 
Train Epoch: 48 [646/1000 20672/32000 (65%)] Loss: 0.39206 (QuantReg: 12.91242) QuantErr: 12.91242 batch_time=0.35379 
Train Epoch: 48 [651/1000 20832/32000 (65%)] Loss: 0.24659 (QuantReg: 13.47878) QuantErr: 13.47878 batch_time=0.35089 
Train Epoch: 48 [656/1000 20992/32000 (66%)] Loss: 0.12738 (QuantReg: 13.50376) QuantErr: 13.50376 batch_time=0.35112 
Train Epoch: 48 [661/1000 21152/32000 (66%)] Loss: 0.37440 (QuantReg: 13.26680) QuantErr: 13.26680 batch_time=0.35440 
Train Epoch: 48 [666/1000 21312/32000 (67%)] Loss: 0.32478 (QuantReg: 13.18989) QuantErr: 13.18989 batch_time=0.37012 
Train Epoch: 48 [671/1000 21472/32000 (67%)] Loss: 0.16280 (QuantReg: 13.16286) QuantErr: 13.16286 batch_time=0.35399 
Train Epoch: 48 [676/1000 21632/32000 (68%)] Loss: 0.40279 (QuantReg: 13.01792) QuantErr: 13.01792 batch_time=0.35041 
Train Epoch: 48 [681/1000 21792/32000 (68%)] Loss: 0.27210 (QuantReg: 13.08104) QuantErr: 13.08104 batch_time=0.37465 
Train Epoch: 48 [686/1000 21952/32000 (69%)] Loss: 0.24734 (QuantReg: 12.58443) QuantErr: 12.58443 batch_time=0.37613 
Train Epoch: 48 [691/1000 22112/32000 (69%)] Loss: 0.26239 (QuantReg: 13.14925) QuantErr: 13.14925 batch_time=0.67382 
Train Epoch: 48 [696/1000 22272/32000 (70%)] Loss: 0.15666 (QuantReg: 13.30491) QuantErr: 13.30491 batch_time=0.49134 
Train Epoch: 48 [701/1000 22432/32000 (70%)] Loss: 0.36265 (QuantReg: 13.05550) QuantErr: 13.05550 batch_time=0.48984 
Train Epoch: 48 [706/1000 22592/32000 (71%)] Loss: 0.33822 (QuantReg: 13.16858) QuantErr: 13.16858 batch_time=1.75673 
Train Epoch: 48 [711/1000 22752/32000 (71%)] Loss: 0.09551 (QuantReg: 12.86475) QuantErr: 12.86475 batch_time=0.45162 
Train Epoch: 48 [716/1000 22912/32000 (72%)] Loss: 0.32865 (QuantReg: 13.40784) QuantErr: 13.40784 batch_time=0.36699 
Train Epoch: 48 [721/1000 23072/32000 (72%)] Loss: 0.28241 (QuantReg: 13.42533) QuantErr: 13.42533 batch_time=0.35043 
Train Epoch: 48 [726/1000 23232/32000 (73%)] Loss: 0.11625 (QuantReg: 13.06710) QuantErr: 13.06710 batch_time=0.38373 
Train Epoch: 48 [731/1000 23392/32000 (73%)] Loss: 0.29507 (QuantReg: 12.82126) QuantErr: 12.82126 batch_time=0.35318 
Train Epoch: 48 [736/1000 23552/32000 (74%)] Loss: 0.06458 (QuantReg: 13.33846) QuantErr: 13.33846 batch_time=0.45614 
Train Epoch: 48 [741/1000 23712/32000 (74%)] Loss: 0.37056 (QuantReg: 13.14337) QuantErr: 13.14337 batch_time=0.40852 
Train Epoch: 48 [746/1000 23872/32000 (75%)] Loss: 0.42149 (QuantReg: 12.93712) QuantErr: 12.93712 batch_time=0.38629 
Train Epoch: 48 [751/1000 24032/32000 (75%)] Loss: 0.18789 (QuantReg: 12.97148) QuantErr: 12.97148 batch_time=0.35481 
Train Epoch: 48 [756/1000 24192/32000 (76%)] Loss: 0.41092 (QuantReg: 13.01904) QuantErr: 13.01904 batch_time=0.35545 
Train Epoch: 48 [761/1000 24352/32000 (76%)] Loss: 0.18066 (QuantReg: 13.12572) QuantErr: 13.12572 batch_time=0.38556 
Train Epoch: 48 [766/1000 24512/32000 (77%)] Loss: 0.20990 (QuantReg: 13.25022) QuantErr: 13.25022 batch_time=0.37194 
Train Epoch: 48 [771/1000 24672/32000 (77%)] Loss: 0.20503 (QuantReg: 12.74611) QuantErr: 12.74611 batch_time=0.35667 
Train Epoch: 48 [776/1000 24832/32000 (78%)] Loss: 0.24771 (QuantReg: 12.82558) QuantErr: 12.82558 batch_time=0.35501 
Train Epoch: 48 [781/1000 24992/32000 (78%)] Loss: 0.34336 (QuantReg: 13.02887) QuantErr: 13.02887 batch_time=0.37722 
Train Epoch: 48 [786/1000 25152/32000 (79%)] Loss: 0.13903 (QuantReg: 13.14489) QuantErr: 13.14489 batch_time=0.45939 
Train Epoch: 48 [791/1000 25312/32000 (79%)] Loss: 0.19625 (QuantReg: 12.62626) QuantErr: 12.62626 batch_time=0.38247 
Train Epoch: 48 [796/1000 25472/32000 (80%)] Loss: 0.43155 (QuantReg: 12.68620) QuantErr: 12.68620 batch_time=0.38311 
Train Epoch: 48 [801/1000 25632/32000 (80%)] Loss: 0.23877 (QuantReg: 12.92086) QuantErr: 12.92086 batch_time=0.35644 
Train Epoch: 48 [806/1000 25792/32000 (81%)] Loss: 0.23619 (QuantReg: 12.99239) QuantErr: 12.99239 batch_time=0.36790 
Train Epoch: 48 [811/1000 25952/32000 (81%)] Loss: 0.25559 (QuantReg: 12.60986) QuantErr: 12.60986 batch_time=0.39610 
Train Epoch: 48 [816/1000 26112/32000 (82%)] Loss: 0.22711 (QuantReg: 13.48521) QuantErr: 13.48521 batch_time=0.37904 
Train Epoch: 48 [821/1000 26272/32000 (82%)] Loss: 0.41075 (QuantReg: 13.54327) QuantErr: 13.54327 batch_time=0.36560 
Train Epoch: 48 [826/1000 26432/32000 (83%)] Loss: 0.16062 (QuantReg: 13.41365) QuantErr: 13.41365 batch_time=0.36336 
Train Epoch: 48 [831/1000 26592/32000 (83%)] Loss: 0.40522 (QuantReg: 12.77314) QuantErr: 12.77314 batch_time=0.36941 
Train Epoch: 48 [836/1000 26752/32000 (84%)] Loss: 0.22591 (QuantReg: 13.15750) QuantErr: 13.15750 batch_time=0.40886 
Train Epoch: 48 [841/1000 26912/32000 (84%)] Loss: 0.11963 (QuantReg: 13.36290) QuantErr: 13.36290 batch_time=0.47989 
Train Epoch: 48 [846/1000 27072/32000 (85%)] Loss: 0.32853 (QuantReg: 12.50303) QuantErr: 12.50303 batch_time=0.43110 
Train Epoch: 48 [851/1000 27232/32000 (85%)] Loss: 0.38941 (QuantReg: 13.03615) QuantErr: 13.03615 batch_time=0.34618 
Train Epoch: 48 [856/1000 27392/32000 (86%)] Loss: 0.25771 (QuantReg: 12.89402) QuantErr: 12.89402 batch_time=0.38598 
Train Epoch: 48 [861/1000 27552/32000 (86%)] Loss: 0.31309 (QuantReg: 13.02188) QuantErr: 13.02188 batch_time=0.39422 
Train Epoch: 48 [866/1000 27712/32000 (87%)] Loss: 0.49007 (QuantReg: 12.34615) QuantErr: 12.34615 batch_time=0.35046 
Train Epoch: 48 [871/1000 27872/32000 (87%)] Loss: 0.41227 (QuantReg: 13.55359) QuantErr: 13.55359 batch_time=0.35324 
Train Epoch: 48 [876/1000 28032/32000 (88%)] Loss: 0.47535 (QuantReg: 13.12893) QuantErr: 13.12893 batch_time=0.35513 
Train Epoch: 48 [881/1000 28192/32000 (88%)] Loss: 0.43247 (QuantReg: 12.86356) QuantErr: 12.86356 batch_time=0.42788 
Train Epoch: 48 [886/1000 28352/32000 (89%)] Loss: 0.20708 (QuantReg: 13.07236) QuantErr: 13.07236 batch_time=0.36019 
Train Epoch: 48 [891/1000 28512/32000 (89%)] Loss: 0.23466 (QuantReg: 12.53664) QuantErr: 12.53664 batch_time=0.36670 
Train Epoch: 48 [896/1000 28672/32000 (90%)] Loss: 0.09135 (QuantReg: 13.14623) QuantErr: 13.14623 batch_time=0.36611 
Train Epoch: 48 [901/1000 28832/32000 (90%)] Loss: 0.11355 (QuantReg: 12.99722) QuantErr: 12.99722 batch_time=0.36490 
Train Epoch: 48 [906/1000 28992/32000 (91%)] Loss: 0.48511 (QuantReg: 13.09806) QuantErr: 13.09806 batch_time=0.36777 
Train Epoch: 48 [911/1000 29152/32000 (91%)] Loss: 0.08418 (QuantReg: 12.74594) QuantErr: 12.74594 batch_time=0.37026 
Train Epoch: 48 [916/1000 29312/32000 (92%)] Loss: 0.10441 (QuantReg: 13.35046) QuantErr: 13.35046 batch_time=0.36334 
Train Epoch: 48 [921/1000 29472/32000 (92%)] Loss: 0.22997 (QuantReg: 13.25808) QuantErr: 13.25808 batch_time=0.35866 
Train Epoch: 48 [926/1000 29632/32000 (93%)] Loss: 0.11810 (QuantReg: 12.95472) QuantErr: 12.95472 batch_time=0.35465 
Train Epoch: 48 [931/1000 29792/32000 (93%)] Loss: 0.23246 (QuantReg: 13.31020) QuantErr: 13.31020 batch_time=0.35643 
Train Epoch: 48 [936/1000 29952/32000 (94%)] Loss: 0.17893 (QuantReg: 12.93148) QuantErr: 12.93148 batch_time=0.35940 
Train Epoch: 48 [941/1000 30112/32000 (94%)] Loss: 0.21497 (QuantReg: 13.30942) QuantErr: 13.30942 batch_time=0.36136 
Train Epoch: 48 [946/1000 30272/32000 (95%)] Loss: 0.33407 (QuantReg: 12.72309) QuantErr: 12.72309 batch_time=0.40920 
Train Epoch: 48 [951/1000 30432/32000 (95%)] Loss: 0.14255 (QuantReg: 13.31638) QuantErr: 13.31638 batch_time=0.37240 
Train Epoch: 48 [956/1000 30592/32000 (96%)] Loss: 0.19409 (QuantReg: 13.13974) QuantErr: 13.13974 batch_time=0.41052 
Train Epoch: 48 [961/1000 30752/32000 (96%)] Loss: 0.30864 (QuantReg: 12.74286) QuantErr: 12.74286 batch_time=0.59929 
Train Epoch: 48 [966/1000 30912/32000 (97%)] Loss: 0.59722 (QuantReg: 12.19446) QuantErr: 12.19446 batch_time=0.35397 
Train Epoch: 48 [971/1000 31072/32000 (97%)] Loss: 0.23934 (QuantReg: 12.42150) QuantErr: 12.42150 batch_time=0.36645 
Train Epoch: 48 [976/1000 31232/32000 (98%)] Loss: 0.37694 (QuantReg: 12.51050) QuantErr: 12.51050 batch_time=0.39655 
Train Epoch: 48 [981/1000 31392/32000 (98%)] Loss: 0.50174 (QuantReg: 13.33245) QuantErr: 13.33245 batch_time=0.36205 
Train Epoch: 48 [986/1000 31552/32000 (99%)] Loss: 0.23649 (QuantReg: 13.19681) QuantErr: 13.19681 batch_time=0.38242 
Train Epoch: 48 [991/1000 31712/32000 (99%)] Loss: 0.41241 (QuantReg: 12.88378) QuantErr: 12.88378 batch_time=0.37493 
Train Epoch: 48 [996/1000 31872/32000 (100%)] Loss: 0.26647 (QuantReg: 13.12158) QuantErr: 13.12158 batch_time=0.37342 
Train Epoch: 48 codebook_update_time=1.82314
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch48.pth ...
Done in 4.551s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch48.pth ...
Done in 28.315s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 0.27877258823812007
 quant_reg      : 12.99435702419281
 quant_err      : 12.99435702419281
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 48000
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 71.62977867203219
 MSRVTT_full_val/t2v_metrics/R10: 84.10462776659959
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.122736418511067
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.6418706920611
 MSRVTT_full_val/v2t_metrics/R1: 37.223340040241446
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 86.31790744466801
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.098591549295775
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.574831398348266
 MSRVTT_full_test/t2v_metrics/R1: 13.812709030100335
 MSRVTT_full_test/t2v_metrics/R5: 37.95986622073578
 MSRVTT_full_test/t2v_metrics/R10: 51.77257525083612
 MSRVTT_full_test/t2v_metrics/R50: 80.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.97290969899665
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.053918303578318
 MSRVTT_full_test/v2t_metrics/R1: 17.25752508361204
 MSRVTT_full_test/v2t_metrics/R5: 43.91304347826087
 MSRVTT_full_test/v2t_metrics/R10: 58.96321070234114
 MSRVTT_full_test/v2t_metrics/R50: 86.95652173913044
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.01939799331104
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.48551057440857
 mnt_best       : 30.053918303578318
 not_improved_count: 0
Train Epoch: 49 [1/1000 32/32000 (0%)] Loss: 0.32325 (QuantReg: 13.09691) QuantErr: 13.09691 batch_time=32.38499 
Train Epoch: 49 [6/1000 192/32000 (1%)] Loss: 0.29326 (QuantReg: 13.08418) QuantErr: 13.08418 batch_time=0.35251 
Train Epoch: 49 [11/1000 352/32000 (1%)] Loss: 0.31313 (QuantReg: 12.50294) QuantErr: 12.50294 batch_time=0.35814 
Train Epoch: 49 [16/1000 512/32000 (2%)] Loss: 0.40129 (QuantReg: 12.55905) QuantErr: 12.55905 batch_time=0.38185 
Train Epoch: 49 [21/1000 672/32000 (2%)] Loss: 0.07072 (QuantReg: 13.02709) QuantErr: 13.02709 batch_time=0.38785 
Train Epoch: 49 [26/1000 832/32000 (3%)] Loss: 0.20073 (QuantReg: 13.04139) QuantErr: 13.04139 batch_time=0.38024 
Train Epoch: 49 [31/1000 992/32000 (3%)] Loss: 0.24089 (QuantReg: 13.02268) QuantErr: 13.02268 batch_time=0.34973 
Train Epoch: 49 [36/1000 1152/32000 (4%)] Loss: 0.10053 (QuantReg: 13.07755) QuantErr: 13.07755 batch_time=0.34632 
Train Epoch: 49 [41/1000 1312/32000 (4%)] Loss: 0.18961 (QuantReg: 12.96016) QuantErr: 12.96016 batch_time=0.39956 
Train Epoch: 49 [46/1000 1472/32000 (5%)] Loss: 0.15498 (QuantReg: 13.14826) QuantErr: 13.14826 batch_time=0.35639 
Train Epoch: 49 [51/1000 1632/32000 (5%)] Loss: 0.41320 (QuantReg: 12.67699) QuantErr: 12.67699 batch_time=0.37170 
Train Epoch: 49 [56/1000 1792/32000 (6%)] Loss: 0.21375 (QuantReg: 13.04513) QuantErr: 13.04513 batch_time=0.34978 
Train Epoch: 49 [61/1000 1952/32000 (6%)] Loss: 0.20818 (QuantReg: 13.01927) QuantErr: 13.01927 batch_time=0.42632 
Train Epoch: 49 [66/1000 2112/32000 (7%)] Loss: 0.37005 (QuantReg: 13.34724) QuantErr: 13.34724 batch_time=0.34556 
Train Epoch: 49 [71/1000 2272/32000 (7%)] Loss: 0.16524 (QuantReg: 12.90896) QuantErr: 12.90896 batch_time=0.34569 
Train Epoch: 49 [76/1000 2432/32000 (8%)] Loss: 0.09935 (QuantReg: 13.00855) QuantErr: 13.00855 batch_time=0.34964 
Train Epoch: 49 [81/1000 2592/32000 (8%)] Loss: 0.29610 (QuantReg: 12.61839) QuantErr: 12.61839 batch_time=0.78423 
Train Epoch: 49 [86/1000 2752/32000 (9%)] Loss: 0.46902 (QuantReg: 12.70892) QuantErr: 12.70892 batch_time=1.15508 
Train Epoch: 49 [91/1000 2912/32000 (9%)] Loss: 0.17102 (QuantReg: 13.07152) QuantErr: 13.07152 batch_time=0.34264 
Train Epoch: 49 [96/1000 3072/32000 (10%)] Loss: 0.25423 (QuantReg: 12.72019) QuantErr: 12.72019 batch_time=0.44551 
Train Epoch: 49 [101/1000 3232/32000 (10%)] Loss: 0.05210 (QuantReg: 12.99554) QuantErr: 12.99554 batch_time=0.62632 
Train Epoch: 49 [106/1000 3392/32000 (11%)] Loss: 0.21726 (QuantReg: 13.07059) QuantErr: 13.07059 batch_time=0.36501 
Train Epoch: 49 [111/1000 3552/32000 (11%)] Loss: 0.11458 (QuantReg: 13.33451) QuantErr: 13.33451 batch_time=0.37231 
Train Epoch: 49 [116/1000 3712/32000 (12%)] Loss: 0.56702 (QuantReg: 12.67658) QuantErr: 12.67658 batch_time=0.34431 
Train Epoch: 49 [121/1000 3872/32000 (12%)] Loss: 0.19547 (QuantReg: 12.99776) QuantErr: 12.99776 batch_time=0.36509 
Train Epoch: 49 [126/1000 4032/32000 (13%)] Loss: 0.08079 (QuantReg: 12.90038) QuantErr: 12.90038 batch_time=0.37025 
Train Epoch: 49 [131/1000 4192/32000 (13%)] Loss: 0.39746 (QuantReg: 13.40921) QuantErr: 13.40921 batch_time=0.34510 
Train Epoch: 49 [136/1000 4352/32000 (14%)] Loss: 0.26873 (QuantReg: 13.29563) QuantErr: 13.29563 batch_time=0.35435 
Train Epoch: 49 [141/1000 4512/32000 (14%)] Loss: 0.31025 (QuantReg: 12.49469) QuantErr: 12.49469 batch_time=0.37439 
Train Epoch: 49 [146/1000 4672/32000 (15%)] Loss: 0.19413 (QuantReg: 13.31238) QuantErr: 13.31238 batch_time=0.37214 
Train Epoch: 49 [151/1000 4832/32000 (15%)] Loss: 0.07566 (QuantReg: 13.04275) QuantErr: 13.04275 batch_time=0.35665 
Train Epoch: 49 [156/1000 4992/32000 (16%)] Loss: 0.12285 (QuantReg: 13.17049) QuantErr: 13.17049 batch_time=0.36409 
Train Epoch: 49 [161/1000 5152/32000 (16%)] Loss: 0.15053 (QuantReg: 12.74040) QuantErr: 12.74040 batch_time=0.35856 
Train Epoch: 49 [166/1000 5312/32000 (17%)] Loss: 0.54316 (QuantReg: 12.25071) QuantErr: 12.25071 batch_time=0.42288 
Train Epoch: 49 [171/1000 5472/32000 (17%)] Loss: 0.34710 (QuantReg: 12.84784) QuantErr: 12.84784 batch_time=0.41298 
Train Epoch: 49 [176/1000 5632/32000 (18%)] Loss: 0.22495 (QuantReg: 12.74655) QuantErr: 12.74655 batch_time=0.35241 
Train Epoch: 49 [181/1000 5792/32000 (18%)] Loss: 0.41377 (QuantReg: 12.42709) QuantErr: 12.42709 batch_time=0.47298 
Train Epoch: 49 [186/1000 5952/32000 (19%)] Loss: 0.37061 (QuantReg: 13.40616) QuantErr: 13.40616 batch_time=0.36438 
Train Epoch: 49 [191/1000 6112/32000 (19%)] Loss: 0.23018 (QuantReg: 12.89900) QuantErr: 12.89900 batch_time=0.37095 
Train Epoch: 49 [196/1000 6272/32000 (20%)] Loss: 0.37013 (QuantReg: 13.40238) QuantErr: 13.40238 batch_time=0.38078 
Train Epoch: 49 [201/1000 6432/32000 (20%)] Loss: 0.41472 (QuantReg: 12.63648) QuantErr: 12.63648 batch_time=0.38726 
Train Epoch: 49 [206/1000 6592/32000 (21%)] Loss: 0.20045 (QuantReg: 13.07431) QuantErr: 13.07431 batch_time=0.35317 
Train Epoch: 49 [211/1000 6752/32000 (21%)] Loss: 0.48647 (QuantReg: 13.06381) QuantErr: 13.06381 batch_time=0.36571 
Train Epoch: 49 [216/1000 6912/32000 (22%)] Loss: 0.19589 (QuantReg: 12.56860) QuantErr: 12.56860 batch_time=0.35129 
Train Epoch: 49 [221/1000 7072/32000 (22%)] Loss: 0.24817 (QuantReg: 13.34439) QuantErr: 13.34439 batch_time=0.34811 
Train Epoch: 49 [226/1000 7232/32000 (23%)] Loss: 0.13564 (QuantReg: 12.80301) QuantErr: 12.80301 batch_time=0.35864 
Train Epoch: 49 [231/1000 7392/32000 (23%)] Loss: 0.25598 (QuantReg: 13.48650) QuantErr: 13.48650 batch_time=0.34594 
Train Epoch: 49 [236/1000 7552/32000 (24%)] Loss: 0.27940 (QuantReg: 12.58416) QuantErr: 12.58416 batch_time=0.41698 
Train Epoch: 49 [241/1000 7712/32000 (24%)] Loss: 0.09431 (QuantReg: 12.69488) QuantErr: 12.69488 batch_time=0.38758 
Train Epoch: 49 [246/1000 7872/32000 (25%)] Loss: 0.13537 (QuantReg: 13.04650) QuantErr: 13.04650 batch_time=0.37353 
Train Epoch: 49 [251/1000 8032/32000 (25%)] Loss: 0.51693 (QuantReg: 13.21528) QuantErr: 13.21528 batch_time=0.38520 
Train Epoch: 49 [256/1000 8192/32000 (26%)] Loss: 0.18794 (QuantReg: 12.97719) QuantErr: 12.97719 batch_time=0.36177 
Train Epoch: 49 [261/1000 8352/32000 (26%)] Loss: 0.37677 (QuantReg: 12.78306) QuantErr: 12.78306 batch_time=0.35837 
Train Epoch: 49 [266/1000 8512/32000 (27%)] Loss: 0.27325 (QuantReg: 13.44077) QuantErr: 13.44077 batch_time=0.34883 
Train Epoch: 49 [271/1000 8672/32000 (27%)] Loss: 0.49115 (QuantReg: 12.40500) QuantErr: 12.40500 batch_time=0.35170 
Train Epoch: 49 [276/1000 8832/32000 (28%)] Loss: 0.14111 (QuantReg: 13.36125) QuantErr: 13.36125 batch_time=0.34367 
Train Epoch: 49 [281/1000 8992/32000 (28%)] Loss: 0.32715 (QuantReg: 13.16235) QuantErr: 13.16235 batch_time=0.34820 
Train Epoch: 49 [286/1000 9152/32000 (29%)] Loss: 0.35860 (QuantReg: 12.69209) QuantErr: 12.69209 batch_time=0.35337 
Train Epoch: 49 [291/1000 9312/32000 (29%)] Loss: 0.34878 (QuantReg: 13.32684) QuantErr: 13.32684 batch_time=0.35850 
Train Epoch: 49 [296/1000 9472/32000 (30%)] Loss: 0.30175 (QuantReg: 13.36516) QuantErr: 13.36516 batch_time=0.38906 
Train Epoch: 49 [301/1000 9632/32000 (30%)] Loss: 0.18894 (QuantReg: 13.12060) QuantErr: 13.12060 batch_time=0.36987 
Train Epoch: 49 [306/1000 9792/32000 (31%)] Loss: 0.14012 (QuantReg: 13.46064) QuantErr: 13.46064 batch_time=0.34751 
Train Epoch: 49 [311/1000 9952/32000 (31%)] Loss: 0.61780 (QuantReg: 12.98766) QuantErr: 12.98766 batch_time=0.35751 
Train Epoch: 49 [316/1000 10112/32000 (32%)] Loss: 0.31391 (QuantReg: 12.79703) QuantErr: 12.79703 batch_time=0.34753 
Train Epoch: 49 [321/1000 10272/32000 (32%)] Loss: 0.22251 (QuantReg: 12.71858) QuantErr: 12.71858 batch_time=0.83334 
Train Epoch: 49 [326/1000 10432/32000 (33%)] Loss: 0.21067 (QuantReg: 13.08524) QuantErr: 13.08524 batch_time=0.38169 
Train Epoch: 49 [331/1000 10592/32000 (33%)] Loss: 0.40753 (QuantReg: 12.69283) QuantErr: 12.69283 batch_time=0.40193 
Train Epoch: 49 [336/1000 10752/32000 (34%)] Loss: 0.37652 (QuantReg: 13.17475) QuantErr: 13.17475 batch_time=0.39302 
Train Epoch: 49 [341/1000 10912/32000 (34%)] Loss: 0.26109 (QuantReg: 13.33654) QuantErr: 13.33654 batch_time=0.34696 
Train Epoch: 49 [346/1000 11072/32000 (35%)] Loss: 0.19401 (QuantReg: 12.64321) QuantErr: 12.64321 batch_time=0.34746 
Train Epoch: 49 [351/1000 11232/32000 (35%)] Loss: 0.43260 (QuantReg: 12.45079) QuantErr: 12.45079 batch_time=0.34909 
Train Epoch: 49 [356/1000 11392/32000 (36%)] Loss: 0.12767 (QuantReg: 12.79579) QuantErr: 12.79579 batch_time=0.34566 
Train Epoch: 49 [361/1000 11552/32000 (36%)] Loss: 0.21743 (QuantReg: 13.12990) QuantErr: 13.12990 batch_time=0.34968 
Train Epoch: 49 [366/1000 11712/32000 (37%)] Loss: 0.19429 (QuantReg: 13.21090) QuantErr: 13.21090 batch_time=0.34930 
Train Epoch: 49 [371/1000 11872/32000 (37%)] Loss: 0.34812 (QuantReg: 12.97812) QuantErr: 12.97812 batch_time=0.34936 
Train Epoch: 49 [376/1000 12032/32000 (38%)] Loss: 0.16660 (QuantReg: 12.83658) QuantErr: 12.83658 batch_time=0.34721 
Train Epoch: 49 [381/1000 12192/32000 (38%)] Loss: 0.17172 (QuantReg: 13.03068) QuantErr: 13.03068 batch_time=0.41218 
Train Epoch: 49 [386/1000 12352/32000 (39%)] Loss: 0.11879 (QuantReg: 12.84439) QuantErr: 12.84439 batch_time=0.37549 
Train Epoch: 49 [391/1000 12512/32000 (39%)] Loss: 0.47950 (QuantReg: 12.95951) QuantErr: 12.95951 batch_time=0.37173 
Train Epoch: 49 [396/1000 12672/32000 (40%)] Loss: 0.30898 (QuantReg: 12.92231) QuantErr: 12.92231 batch_time=0.37158 
Train Epoch: 49 [401/1000 12832/32000 (40%)] Loss: 0.27101 (QuantReg: 13.15143) QuantErr: 13.15143 batch_time=0.73526 
Train Epoch: 49 [406/1000 12992/32000 (41%)] Loss: 0.21748 (QuantReg: 12.57332) QuantErr: 12.57332 batch_time=1.02928 
Train Epoch: 49 [411/1000 13152/32000 (41%)] Loss: 0.27485 (QuantReg: 12.98029) QuantErr: 12.98029 batch_time=0.37111 
Train Epoch: 49 [416/1000 13312/32000 (42%)] Loss: 0.10654 (QuantReg: 13.08684) QuantErr: 13.08684 batch_time=0.34999 
Train Epoch: 49 [421/1000 13472/32000 (42%)] Loss: 0.13712 (QuantReg: 13.25542) QuantErr: 13.25542 batch_time=0.55068 
Train Epoch: 49 [426/1000 13632/32000 (43%)] Loss: 0.26969 (QuantReg: 12.81554) QuantErr: 12.81554 batch_time=0.34605 
Train Epoch: 49 [431/1000 13792/32000 (43%)] Loss: 0.28738 (QuantReg: 13.23977) QuantErr: 13.23977 batch_time=0.58455 
Train Epoch: 49 [436/1000 13952/32000 (44%)] Loss: 0.45383 (QuantReg: 13.02429) QuantErr: 13.02429 batch_time=0.35108 
Train Epoch: 49 [441/1000 14112/32000 (44%)] Loss: 0.28054 (QuantReg: 13.02584) QuantErr: 13.02584 batch_time=0.35283 
Train Epoch: 49 [446/1000 14272/32000 (45%)] Loss: 0.37403 (QuantReg: 12.82296) QuantErr: 12.82296 batch_time=0.35931 
Train Epoch: 49 [451/1000 14432/32000 (45%)] Loss: 0.18594 (QuantReg: 13.18835) QuantErr: 13.18835 batch_time=0.39202 
Train Epoch: 49 [456/1000 14592/32000 (46%)] Loss: 0.25452 (QuantReg: 13.62196) QuantErr: 13.62196 batch_time=0.41605 
Train Epoch: 49 [461/1000 14752/32000 (46%)] Loss: 0.46116 (QuantReg: 12.73589) QuantErr: 12.73589 batch_time=0.35003 
Train Epoch: 49 [466/1000 14912/32000 (47%)] Loss: 0.23026 (QuantReg: 12.99625) QuantErr: 12.99625 batch_time=0.37812 
Train Epoch: 49 [471/1000 15072/32000 (47%)] Loss: 0.14783 (QuantReg: 13.12514) QuantErr: 13.12514 batch_time=0.34615 
Train Epoch: 49 [476/1000 15232/32000 (48%)] Loss: 0.21976 (QuantReg: 13.18925) QuantErr: 13.18925 batch_time=0.35765 
Train Epoch: 49 [481/1000 15392/32000 (48%)] Loss: 0.19836 (QuantReg: 13.46421) QuantErr: 13.46421 batch_time=0.36360 
Train Epoch: 49 [486/1000 15552/32000 (49%)] Loss: 0.29163 (QuantReg: 12.94493) QuantErr: 12.94493 batch_time=0.35676 
Train Epoch: 49 [491/1000 15712/32000 (49%)] Loss: 0.18156 (QuantReg: 12.38585) QuantErr: 12.38585 batch_time=0.37783 
Train Epoch: 49 [496/1000 15872/32000 (50%)] Loss: 0.29224 (QuantReg: 12.81960) QuantErr: 12.81960 batch_time=0.37166 
Train Epoch: 49 [501/1000 16032/32000 (50%)] Loss: 0.36894 (QuantReg: 12.69992) QuantErr: 12.69992 batch_time=0.47951 
Train Epoch: 49 [506/1000 16192/32000 (51%)] Loss: 0.22720 (QuantReg: 12.27169) QuantErr: 12.27169 batch_time=0.34978 
Train Epoch: 49 [511/1000 16352/32000 (51%)] Loss: 0.45431 (QuantReg: 12.82156) QuantErr: 12.82156 batch_time=0.35085 
Train Epoch: 49 [516/1000 16512/32000 (52%)] Loss: 0.13282 (QuantReg: 13.40144) QuantErr: 13.40144 batch_time=0.37088 
Train Epoch: 49 [521/1000 16672/32000 (52%)] Loss: 0.20418 (QuantReg: 13.28767) QuantErr: 13.28767 batch_time=0.37223 
Train Epoch: 49 [526/1000 16832/32000 (53%)] Loss: 0.30060 (QuantReg: 13.60717) QuantErr: 13.60717 batch_time=0.35124 
Train Epoch: 49 [531/1000 16992/32000 (53%)] Loss: 0.27492 (QuantReg: 12.90596) QuantErr: 12.90596 batch_time=0.34900 
Train Epoch: 49 [536/1000 17152/32000 (54%)] Loss: 0.21247 (QuantReg: 12.83506) QuantErr: 12.83506 batch_time=0.37366 
Train Epoch: 49 [541/1000 17312/32000 (54%)] Loss: 0.18016 (QuantReg: 13.63656) QuantErr: 13.63656 batch_time=0.36120 
Train Epoch: 49 [546/1000 17472/32000 (55%)] Loss: 0.42274 (QuantReg: 12.77377) QuantErr: 12.77377 batch_time=0.40868 
Train Epoch: 49 [551/1000 17632/32000 (55%)] Loss: 0.31188 (QuantReg: 12.94146) QuantErr: 12.94146 batch_time=0.39499 
Train Epoch: 49 [556/1000 17792/32000 (56%)] Loss: 0.12902 (QuantReg: 13.16724) QuantErr: 13.16724 batch_time=0.35967 
Train Epoch: 49 [561/1000 17952/32000 (56%)] Loss: 0.55993 (QuantReg: 12.77758) QuantErr: 12.77758 batch_time=0.38985 
Train Epoch: 49 [566/1000 18112/32000 (57%)] Loss: 0.21264 (QuantReg: 12.96677) QuantErr: 12.96677 batch_time=0.35316 
Train Epoch: 49 [571/1000 18272/32000 (57%)] Loss: 0.22326 (QuantReg: 12.97323) QuantErr: 12.97323 batch_time=0.34865 
Train Epoch: 49 [576/1000 18432/32000 (58%)] Loss: 0.40379 (QuantReg: 12.22867) QuantErr: 12.22867 batch_time=0.34741 
Train Epoch: 49 [581/1000 18592/32000 (58%)] Loss: 0.34531 (QuantReg: 13.30905) QuantErr: 13.30905 batch_time=0.34675 
Train Epoch: 49 [586/1000 18752/32000 (59%)] Loss: 0.22041 (QuantReg: 12.84890) QuantErr: 12.84890 batch_time=0.41360 
Train Epoch: 49 [591/1000 18912/32000 (59%)] Loss: 0.29814 (QuantReg: 12.65340) QuantErr: 12.65340 batch_time=0.34918 
Train Epoch: 49 [596/1000 19072/32000 (60%)] Loss: 0.06762 (QuantReg: 12.80696) QuantErr: 12.80696 batch_time=0.38292 
Train Epoch: 49 [601/1000 19232/32000 (60%)] Loss: 0.19512 (QuantReg: 13.43184) QuantErr: 13.43184 batch_time=0.37226 
Train Epoch: 49 [606/1000 19392/32000 (61%)] Loss: 0.22723 (QuantReg: 13.19456) QuantErr: 13.19456 batch_time=0.34890 
Train Epoch: 49 [611/1000 19552/32000 (61%)] Loss: 0.45559 (QuantReg: 12.35993) QuantErr: 12.35993 batch_time=0.38720 
Train Epoch: 49 [616/1000 19712/32000 (62%)] Loss: 0.31811 (QuantReg: 13.07018) QuantErr: 13.07018 batch_time=0.38938 
Train Epoch: 49 [621/1000 19872/32000 (62%)] Loss: 0.29301 (QuantReg: 12.99414) QuantErr: 12.99414 batch_time=0.34374 
Train Epoch: 49 [626/1000 20032/32000 (63%)] Loss: 0.27971 (QuantReg: 13.17801) QuantErr: 13.17801 batch_time=0.37022 
Train Epoch: 49 [631/1000 20192/32000 (63%)] Loss: 0.18374 (QuantReg: 13.23907) QuantErr: 13.23907 batch_time=0.36067 
Train Epoch: 49 [636/1000 20352/32000 (64%)] Loss: 0.14801 (QuantReg: 13.23753) QuantErr: 13.23753 batch_time=0.37027 
Train Epoch: 49 [641/1000 20512/32000 (64%)] Loss: 0.20819 (QuantReg: 12.97873) QuantErr: 12.97873 batch_time=0.83298 
Train Epoch: 49 [646/1000 20672/32000 (65%)] Loss: 0.54011 (QuantReg: 12.74840) QuantErr: 12.74840 batch_time=0.38724 
Train Epoch: 49 [651/1000 20832/32000 (65%)] Loss: 0.23215 (QuantReg: 13.12299) QuantErr: 13.12299 batch_time=0.35738 
Train Epoch: 49 [656/1000 20992/32000 (66%)] Loss: 0.16420 (QuantReg: 12.74119) QuantErr: 12.74119 batch_time=0.34922 
Train Epoch: 49 [661/1000 21152/32000 (66%)] Loss: 0.16837 (QuantReg: 12.96563) QuantErr: 12.96563 batch_time=0.35837 
Train Epoch: 49 [666/1000 21312/32000 (67%)] Loss: 0.21678 (QuantReg: 13.09705) QuantErr: 13.09705 batch_time=0.37169 
Train Epoch: 49 [671/1000 21472/32000 (67%)] Loss: 0.15543 (QuantReg: 12.80949) QuantErr: 12.80949 batch_time=0.36251 
Train Epoch: 49 [676/1000 21632/32000 (68%)] Loss: 0.12373 (QuantReg: 13.67145) QuantErr: 13.67145 batch_time=0.35483 
Train Epoch: 49 [681/1000 21792/32000 (68%)] Loss: 0.20944 (QuantReg: 13.14343) QuantErr: 13.14343 batch_time=0.36246 
Train Epoch: 49 [686/1000 21952/32000 (69%)] Loss: 0.17569 (QuantReg: 13.39170) QuantErr: 13.39170 batch_time=0.35194 
Train Epoch: 49 [691/1000 22112/32000 (69%)] Loss: 0.46683 (QuantReg: 12.56329) QuantErr: 12.56329 batch_time=0.35252 
Train Epoch: 49 [696/1000 22272/32000 (70%)] Loss: 0.22267 (QuantReg: 13.48096) QuantErr: 13.48096 batch_time=0.35362 
Train Epoch: 49 [701/1000 22432/32000 (70%)] Loss: 0.42238 (QuantReg: 13.26135) QuantErr: 13.26135 batch_time=0.41742 
Train Epoch: 49 [706/1000 22592/32000 (71%)] Loss: 0.23373 (QuantReg: 13.34921) QuantErr: 13.34921 batch_time=0.34762 
Train Epoch: 49 [711/1000 22752/32000 (71%)] Loss: 0.52924 (QuantReg: 12.95017) QuantErr: 12.95017 batch_time=0.45730 
Train Epoch: 49 [716/1000 22912/32000 (72%)] Loss: 0.38242 (QuantReg: 12.98091) QuantErr: 12.98091 batch_time=0.40333 
Train Epoch: 49 [721/1000 23072/32000 (72%)] Loss: 0.16154 (QuantReg: 12.79866) QuantErr: 12.79866 batch_time=0.80830 
Train Epoch: 49 [726/1000 23232/32000 (73%)] Loss: 0.37936 (QuantReg: 13.12313) QuantErr: 13.12313 batch_time=0.97060 
Train Epoch: 49 [731/1000 23392/32000 (73%)] Loss: 0.28597 (QuantReg: 13.15287) QuantErr: 13.15287 batch_time=0.34799 
Train Epoch: 49 [736/1000 23552/32000 (74%)] Loss: 0.42167 (QuantReg: 13.28037) QuantErr: 13.28037 batch_time=0.35309 
Train Epoch: 49 [741/1000 23712/32000 (74%)] Loss: 0.09703 (QuantReg: 13.20332) QuantErr: 13.20332 batch_time=0.57526 
Train Epoch: 49 [746/1000 23872/32000 (75%)] Loss: 0.38702 (QuantReg: 12.76079) QuantErr: 12.76079 batch_time=0.34878 
Train Epoch: 49 [751/1000 24032/32000 (75%)] Loss: 0.16321 (QuantReg: 12.88645) QuantErr: 12.88645 batch_time=0.37593 
Train Epoch: 49 [756/1000 24192/32000 (76%)] Loss: 0.26403 (QuantReg: 13.00819) QuantErr: 13.00819 batch_time=0.39686 
Train Epoch: 49 [761/1000 24352/32000 (76%)] Loss: 0.40737 (QuantReg: 13.16807) QuantErr: 13.16807 batch_time=0.35179 
Train Epoch: 49 [766/1000 24512/32000 (77%)] Loss: 0.41784 (QuantReg: 13.29804) QuantErr: 13.29804 batch_time=0.35354 
Train Epoch: 49 [771/1000 24672/32000 (77%)] Loss: 0.23736 (QuantReg: 12.93432) QuantErr: 12.93432 batch_time=0.35204 
Train Epoch: 49 [776/1000 24832/32000 (78%)] Loss: 0.16118 (QuantReg: 13.38570) QuantErr: 13.38570 batch_time=0.34794 
Train Epoch: 49 [781/1000 24992/32000 (78%)] Loss: 0.15317 (QuantReg: 13.11521) QuantErr: 13.11521 batch_time=0.39455 
Train Epoch: 49 [786/1000 25152/32000 (79%)] Loss: 0.27352 (QuantReg: 13.10077) QuantErr: 13.10077 batch_time=0.47747 
Train Epoch: 49 [791/1000 25312/32000 (79%)] Loss: 0.40551 (QuantReg: 12.68532) QuantErr: 12.68532 batch_time=0.39668 
Train Epoch: 49 [796/1000 25472/32000 (80%)] Loss: 0.08365 (QuantReg: 13.17119) QuantErr: 13.17119 batch_time=0.44853 
Train Epoch: 49 [801/1000 25632/32000 (80%)] Loss: 0.14474 (QuantReg: 13.01987) QuantErr: 13.01987 batch_time=0.35736 
Train Epoch: 49 [806/1000 25792/32000 (81%)] Loss: 0.36024 (QuantReg: 12.45115) QuantErr: 12.45115 batch_time=0.38910 
Train Epoch: 49 [811/1000 25952/32000 (81%)] Loss: 0.27525 (QuantReg: 13.07273) QuantErr: 13.07273 batch_time=0.35541 
Train Epoch: 49 [816/1000 26112/32000 (82%)] Loss: 0.38339 (QuantReg: 13.12654) QuantErr: 13.12654 batch_time=0.35102 
Train Epoch: 49 [821/1000 26272/32000 (82%)] Loss: 0.18983 (QuantReg: 12.38286) QuantErr: 12.38286 batch_time=0.47025 
Train Epoch: 49 [826/1000 26432/32000 (83%)] Loss: 0.09934 (QuantReg: 12.91447) QuantErr: 12.91447 batch_time=0.35137 
Train Epoch: 49 [831/1000 26592/32000 (83%)] Loss: 0.27507 (QuantReg: 13.18705) QuantErr: 13.18705 batch_time=0.36365 
Train Epoch: 49 [836/1000 26752/32000 (84%)] Loss: 0.24633 (QuantReg: 13.63348) QuantErr: 13.63348 batch_time=0.35232 
Train Epoch: 49 [841/1000 26912/32000 (84%)] Loss: 0.19619 (QuantReg: 12.86945) QuantErr: 12.86945 batch_time=0.35118 
Train Epoch: 49 [846/1000 27072/32000 (85%)] Loss: 0.13853 (QuantReg: 13.21800) QuantErr: 13.21800 batch_time=0.41187 
Train Epoch: 49 [851/1000 27232/32000 (85%)] Loss: 0.23578 (QuantReg: 13.06306) QuantErr: 13.06306 batch_time=0.34444 
Train Epoch: 49 [856/1000 27392/32000 (86%)] Loss: 0.29400 (QuantReg: 13.07239) QuantErr: 13.07239 batch_time=0.34441 
Train Epoch: 49 [861/1000 27552/32000 (86%)] Loss: 0.09832 (QuantReg: 13.11804) QuantErr: 13.11804 batch_time=0.38558 
Train Epoch: 49 [866/1000 27712/32000 (87%)] Loss: 0.35126 (QuantReg: 13.71746) QuantErr: 13.71746 batch_time=0.36431 
Train Epoch: 49 [871/1000 27872/32000 (87%)] Loss: 0.42024 (QuantReg: 13.16284) QuantErr: 13.16284 batch_time=0.37313 
Train Epoch: 49 [876/1000 28032/32000 (88%)] Loss: 0.21032 (QuantReg: 12.67747) QuantErr: 12.67747 batch_time=0.34895 
Train Epoch: 49 [881/1000 28192/32000 (88%)] Loss: 0.34359 (QuantReg: 12.97162) QuantErr: 12.97162 batch_time=0.35242 
Train Epoch: 49 [886/1000 28352/32000 (89%)] Loss: 0.07359 (QuantReg: 13.21550) QuantErr: 13.21550 batch_time=0.35461 
Train Epoch: 49 [891/1000 28512/32000 (89%)] Loss: 0.32428 (QuantReg: 13.09503) QuantErr: 13.09503 batch_time=0.39084 
Train Epoch: 49 [896/1000 28672/32000 (90%)] Loss: 0.15982 (QuantReg: 13.37469) QuantErr: 13.37469 batch_time=0.35186 
Train Epoch: 49 [901/1000 28832/32000 (90%)] Loss: 0.56582 (QuantReg: 13.23413) QuantErr: 13.23413 batch_time=0.36673 
Train Epoch: 49 [906/1000 28992/32000 (91%)] Loss: 0.12389 (QuantReg: 12.63739) QuantErr: 12.63739 batch_time=0.35006 
Train Epoch: 49 [911/1000 29152/32000 (91%)] Loss: 0.11778 (QuantReg: 13.20194) QuantErr: 13.20194 batch_time=0.35061 
Train Epoch: 49 [916/1000 29312/32000 (92%)] Loss: 0.08643 (QuantReg: 13.23201) QuantErr: 13.23201 batch_time=0.35620 
Train Epoch: 49 [921/1000 29472/32000 (92%)] Loss: 0.20711 (QuantReg: 12.74187) QuantErr: 12.74187 batch_time=0.34914 
Train Epoch: 49 [926/1000 29632/32000 (93%)] Loss: 0.36442 (QuantReg: 13.08479) QuantErr: 13.08479 batch_time=0.35678 
Train Epoch: 49 [931/1000 29792/32000 (93%)] Loss: 0.55651 (QuantReg: 12.53225) QuantErr: 12.53225 batch_time=0.41531 
Train Epoch: 49 [936/1000 29952/32000 (94%)] Loss: 0.15803 (QuantReg: 13.50347) QuantErr: 13.50347 batch_time=0.38241 
Train Epoch: 49 [941/1000 30112/32000 (94%)] Loss: 0.42300 (QuantReg: 12.95957) QuantErr: 12.95957 batch_time=0.45764 
Train Epoch: 49 [946/1000 30272/32000 (95%)] Loss: 0.32534 (QuantReg: 12.67908) QuantErr: 12.67908 batch_time=0.40059 
Train Epoch: 49 [951/1000 30432/32000 (95%)] Loss: 0.09304 (QuantReg: 12.81284) QuantErr: 12.81284 batch_time=0.36195 
Train Epoch: 49 [956/1000 30592/32000 (96%)] Loss: 0.34179 (QuantReg: 13.04091) QuantErr: 13.04091 batch_time=0.34887 
Train Epoch: 49 [961/1000 30752/32000 (96%)] Loss: 0.09905 (QuantReg: 13.04394) QuantErr: 13.04394 batch_time=0.90616 
Train Epoch: 49 [966/1000 30912/32000 (97%)] Loss: 0.17790 (QuantReg: 13.54218) QuantErr: 13.54218 batch_time=0.39218 
Train Epoch: 49 [971/1000 31072/32000 (97%)] Loss: 0.45731 (QuantReg: 13.14766) QuantErr: 13.14766 batch_time=0.36748 
Train Epoch: 49 [976/1000 31232/32000 (98%)] Loss: 0.19156 (QuantReg: 12.42612) QuantErr: 12.42612 batch_time=0.35008 
Train Epoch: 49 [981/1000 31392/32000 (98%)] Loss: 0.83619 (QuantReg: 12.88396) QuantErr: 12.88396 batch_time=0.37120 
Train Epoch: 49 [986/1000 31552/32000 (99%)] Loss: 0.34304 (QuantReg: 12.88226) QuantErr: 12.88226 batch_time=0.34885 
Train Epoch: 49 [991/1000 31712/32000 (99%)] Loss: 0.31368 (QuantReg: 12.85154) QuantErr: 12.85154 batch_time=0.35014 
Train Epoch: 49 [996/1000 31872/32000 (100%)] Loss: 0.26863 (QuantReg: 12.98462) QuantErr: 12.98462 batch_time=0.34458 
Train Epoch: 49 codebook_update_time=1.86950
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch49.pth ...
Done in 4.338s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 0.2767521959245205
 quant_reg      : 13.0001331949234
 quant_err      : 13.0001331949234
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 49000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 71.22736418511066
 MSRVTT_full_val/t2v_metrics/R10: 83.90342052313883
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.39235412474849
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.24421221364456
 MSRVTT_full_val/v2t_metrics/R1: 37.625754527162975
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.3480885311871225
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.529145290432496
 MSRVTT_full_test/t2v_metrics/R1: 13.010033444816054
 MSRVTT_full_test/t2v_metrics/R5: 37.85953177257525
 MSRVTT_full_test/t2v_metrics/R10: 51.37123745819398
 MSRVTT_full_test/t2v_metrics/R50: 80.33444816053512
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.63879598662207
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.35787112154139
 MSRVTT_full_test/v2t_metrics/R1: 16.321070234113712
 MSRVTT_full_test/v2t_metrics/R5: 43.94648829431438
 MSRVTT_full_test/v2t_metrics/R10: 58.16053511705686
 MSRVTT_full_test/v2t_metrics/R50: 86.62207357859532
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.52140468227425
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.68170193183751
 mnt_best       : 30.053918303578318
 not_improved_count: 1
Train Epoch: 50 [1/1000 32/32000 (0%)] Loss: 0.24696 (QuantReg: 12.66965) QuantErr: 12.66965 batch_time=27.90906 
Train Epoch: 50 [6/1000 192/32000 (1%)] Loss: 0.19955 (QuantReg: 12.84833) QuantErr: 12.84833 batch_time=0.35877 
Train Epoch: 50 [11/1000 352/32000 (1%)] Loss: 0.21553 (QuantReg: 13.26425) QuantErr: 13.26425 batch_time=0.38790 
Train Epoch: 50 [16/1000 512/32000 (2%)] Loss: 0.47124 (QuantReg: 12.55226) QuantErr: 12.55226 batch_time=0.63821 
Train Epoch: 50 [21/1000 672/32000 (2%)] Loss: 0.29984 (QuantReg: 13.10915) QuantErr: 13.10915 batch_time=1.09237 
Train Epoch: 50 [26/1000 832/32000 (3%)] Loss: 0.26662 (QuantReg: 12.82797) QuantErr: 12.82797 batch_time=0.34412 
Train Epoch: 50 [31/1000 992/32000 (3%)] Loss: 0.25979 (QuantReg: 12.68618) QuantErr: 12.68618 batch_time=0.39782 
Train Epoch: 50 [36/1000 1152/32000 (4%)] Loss: 0.30937 (QuantReg: 13.29536) QuantErr: 13.29536 batch_time=0.41627 
Train Epoch: 50 [41/1000 1312/32000 (4%)] Loss: 0.10121 (QuantReg: 13.21283) QuantErr: 13.21283 batch_time=0.41647 
Train Epoch: 50 [46/1000 1472/32000 (5%)] Loss: 0.18269 (QuantReg: 12.63953) QuantErr: 12.63953 batch_time=0.36266 
Train Epoch: 50 [51/1000 1632/32000 (5%)] Loss: 0.24826 (QuantReg: 12.91073) QuantErr: 12.91073 batch_time=0.40339 
Train Epoch: 50 [56/1000 1792/32000 (6%)] Loss: 0.09870 (QuantReg: 13.00418) QuantErr: 13.00418 batch_time=0.37779 
Train Epoch: 50 [61/1000 1952/32000 (6%)] Loss: 0.22525 (QuantReg: 13.05514) QuantErr: 13.05514 batch_time=0.47040 
Train Epoch: 50 [66/1000 2112/32000 (7%)] Loss: 0.51108 (QuantReg: 13.34278) QuantErr: 13.34278 batch_time=0.38743 
Train Epoch: 50 [71/1000 2272/32000 (7%)] Loss: 0.15989 (QuantReg: 12.76632) QuantErr: 12.76632 batch_time=0.34743 
Train Epoch: 50 [76/1000 2432/32000 (8%)] Loss: 0.25414 (QuantReg: 13.06584) QuantErr: 13.06584 batch_time=0.34983 
Train Epoch: 50 [81/1000 2592/32000 (8%)] Loss: 0.33308 (QuantReg: 12.96472) QuantErr: 12.96472 batch_time=0.49913 
Train Epoch: 50 [86/1000 2752/32000 (9%)] Loss: 0.44367 (QuantReg: 12.62436) QuantErr: 12.62436 batch_time=0.94637 
Train Epoch: 50 [91/1000 2912/32000 (9%)] Loss: 0.21578 (QuantReg: 12.82540) QuantErr: 12.82540 batch_time=0.38690 
Train Epoch: 50 [96/1000 3072/32000 (10%)] Loss: 0.34466 (QuantReg: 13.10967) QuantErr: 13.10967 batch_time=0.42037 
Train Epoch: 50 [101/1000 3232/32000 (10%)] Loss: 0.42057 (QuantReg: 13.06193) QuantErr: 13.06193 batch_time=0.41063 
Train Epoch: 50 [106/1000 3392/32000 (11%)] Loss: 0.17709 (QuantReg: 13.48523) QuantErr: 13.48523 batch_time=0.35852 
Train Epoch: 50 [111/1000 3552/32000 (11%)] Loss: 0.21689 (QuantReg: 13.07829) QuantErr: 13.07829 batch_time=0.38445 
Train Epoch: 50 [116/1000 3712/32000 (12%)] Loss: 0.29671 (QuantReg: 12.62508) QuantErr: 12.62508 batch_time=0.38897 
Train Epoch: 50 [121/1000 3872/32000 (12%)] Loss: 0.15267 (QuantReg: 13.13465) QuantErr: 13.13465 batch_time=0.37801 
Train Epoch: 50 [126/1000 4032/32000 (13%)] Loss: 0.49144 (QuantReg: 12.79166) QuantErr: 12.79166 batch_time=0.35856 
Train Epoch: 50 [131/1000 4192/32000 (13%)] Loss: 0.42411 (QuantReg: 13.07127) QuantErr: 13.07127 batch_time=0.38806 
Train Epoch: 50 [136/1000 4352/32000 (14%)] Loss: 0.10629 (QuantReg: 13.23466) QuantErr: 13.23466 batch_time=0.38235 
Train Epoch: 50 [141/1000 4512/32000 (14%)] Loss: 0.21456 (QuantReg: 12.94409) QuantErr: 12.94409 batch_time=0.40017 
Train Epoch: 50 [146/1000 4672/32000 (15%)] Loss: 0.18604 (QuantReg: 13.29567) QuantErr: 13.29567 batch_time=0.37091 
Train Epoch: 50 [151/1000 4832/32000 (15%)] Loss: 0.12420 (QuantReg: 13.39218) QuantErr: 13.39218 batch_time=0.40694 
Train Epoch: 50 [156/1000 4992/32000 (16%)] Loss: 0.32065 (QuantReg: 13.26232) QuantErr: 13.26232 batch_time=0.41234 
Train Epoch: 50 [161/1000 5152/32000 (16%)] Loss: 0.25934 (QuantReg: 13.15518) QuantErr: 13.15518 batch_time=0.35055 
Train Epoch: 50 [166/1000 5312/32000 (17%)] Loss: 0.40305 (QuantReg: 12.62657) QuantErr: 12.62657 batch_time=0.35765 
Train Epoch: 50 [171/1000 5472/32000 (17%)] Loss: 0.21287 (QuantReg: 13.27298) QuantErr: 13.27298 batch_time=0.37063 
Train Epoch: 50 [176/1000 5632/32000 (18%)] Loss: 0.42749 (QuantReg: 12.85728) QuantErr: 12.85728 batch_time=0.36382 
Train Epoch: 50 [181/1000 5792/32000 (18%)] Loss: 0.17314 (QuantReg: 12.81108) QuantErr: 12.81108 batch_time=0.39842 
Train Epoch: 50 [186/1000 5952/32000 (19%)] Loss: 0.13574 (QuantReg: 13.49807) QuantErr: 13.49807 batch_time=0.35633 
Train Epoch: 50 [191/1000 6112/32000 (19%)] Loss: 0.26632 (QuantReg: 12.72039) QuantErr: 12.72039 batch_time=0.36564 
Train Epoch: 50 [196/1000 6272/32000 (20%)] Loss: 0.36569 (QuantReg: 12.88318) QuantErr: 12.88318 batch_time=0.40052 
Train Epoch: 50 [201/1000 6432/32000 (20%)] Loss: 0.14373 (QuantReg: 13.42217) QuantErr: 13.42217 batch_time=0.39209 
Train Epoch: 50 [206/1000 6592/32000 (21%)] Loss: 0.08165 (QuantReg: 12.99790) QuantErr: 12.99790 batch_time=0.42692 
Train Epoch: 50 [211/1000 6752/32000 (21%)] Loss: 0.40811 (QuantReg: 13.08854) QuantErr: 13.08854 batch_time=0.57222 
Train Epoch: 50 [216/1000 6912/32000 (22%)] Loss: 0.11677 (QuantReg: 13.54542) QuantErr: 13.54542 batch_time=0.36864 
Train Epoch: 50 [221/1000 7072/32000 (22%)] Loss: 0.16871 (QuantReg: 13.29634) QuantErr: 13.29634 batch_time=0.39645 
Train Epoch: 50 [226/1000 7232/32000 (23%)] Loss: 0.26454 (QuantReg: 12.95041) QuantErr: 12.95041 batch_time=0.40329 
Train Epoch: 50 [231/1000 7392/32000 (23%)] Loss: 0.35644 (QuantReg: 12.46630) QuantErr: 12.46630 batch_time=0.40327 
Train Epoch: 50 [236/1000 7552/32000 (24%)] Loss: 0.15332 (QuantReg: 13.21659) QuantErr: 13.21659 batch_time=0.39793 
Train Epoch: 50 [241/1000 7712/32000 (24%)] Loss: 0.17736 (QuantReg: 13.07615) QuantErr: 13.07615 batch_time=0.37148 
Train Epoch: 50 [246/1000 7872/32000 (25%)] Loss: 0.30782 (QuantReg: 12.99874) QuantErr: 12.99874 batch_time=0.37423 
Train Epoch: 50 [251/1000 8032/32000 (25%)] Loss: 0.31739 (QuantReg: 12.44324) QuantErr: 12.44324 batch_time=0.40118 
Train Epoch: 50 [256/1000 8192/32000 (26%)] Loss: 0.55280 (QuantReg: 12.96741) QuantErr: 12.96741 batch_time=0.40238 
Train Epoch: 50 [261/1000 8352/32000 (26%)] Loss: 0.17738 (QuantReg: 12.83110) QuantErr: 12.83110 batch_time=0.35257 
Train Epoch: 50 [266/1000 8512/32000 (27%)] Loss: 0.08308 (QuantReg: 12.87903) QuantErr: 12.87903 batch_time=0.38104 
Train Epoch: 50 [271/1000 8672/32000 (27%)] Loss: 0.12234 (QuantReg: 12.51741) QuantErr: 12.51741 batch_time=0.41468 
Train Epoch: 50 [276/1000 8832/32000 (28%)] Loss: 0.11921 (QuantReg: 13.25374) QuantErr: 13.25374 batch_time=0.37884 
Train Epoch: 50 [281/1000 8992/32000 (28%)] Loss: 0.13975 (QuantReg: 12.92799) QuantErr: 12.92799 batch_time=0.35750 
Train Epoch: 50 [286/1000 9152/32000 (29%)] Loss: 0.40513 (QuantReg: 13.06599) QuantErr: 13.06599 batch_time=0.37069 
Train Epoch: 50 [291/1000 9312/32000 (29%)] Loss: 0.56798 (QuantReg: 13.06689) QuantErr: 13.06689 batch_time=0.39080 
Train Epoch: 50 [296/1000 9472/32000 (30%)] Loss: 0.25820 (QuantReg: 12.84690) QuantErr: 12.84690 batch_time=0.40665 
Train Epoch: 50 [301/1000 9632/32000 (30%)] Loss: 0.44884 (QuantReg: 13.24681) QuantErr: 13.24681 batch_time=0.34781 
Train Epoch: 50 [306/1000 9792/32000 (31%)] Loss: 0.23442 (QuantReg: 12.63282) QuantErr: 12.63282 batch_time=0.35105 
Train Epoch: 50 [311/1000 9952/32000 (31%)] Loss: 0.16258 (QuantReg: 12.81776) QuantErr: 12.81776 batch_time=0.36997 
Train Epoch: 50 [316/1000 10112/32000 (32%)] Loss: 0.16549 (QuantReg: 12.86210) QuantErr: 12.86210 batch_time=0.42132 
Train Epoch: 50 [321/1000 10272/32000 (32%)] Loss: 0.14410 (QuantReg: 13.61191) QuantErr: 13.61191 batch_time=0.61396 
Train Epoch: 50 [326/1000 10432/32000 (33%)] Loss: 0.24288 (QuantReg: 13.05646) QuantErr: 13.05646 batch_time=0.42449 
Train Epoch: 50 [331/1000 10592/32000 (33%)] Loss: 0.54060 (QuantReg: 12.78498) QuantErr: 12.78498 batch_time=0.39126 
Train Epoch: 50 [336/1000 10752/32000 (34%)] Loss: 0.24920 (QuantReg: 13.28153) QuantErr: 13.28153 batch_time=0.66816 
Train Epoch: 50 [341/1000 10912/32000 (34%)] Loss: 0.11745 (QuantReg: 13.04180) QuantErr: 13.04180 batch_time=0.83599 
Train Epoch: 50 [346/1000 11072/32000 (35%)] Loss: 0.15472 (QuantReg: 12.95256) QuantErr: 12.95256 batch_time=0.39147 
Train Epoch: 50 [351/1000 11232/32000 (35%)] Loss: 0.13144 (QuantReg: 13.06992) QuantErr: 13.06992 batch_time=0.34915 
Train Epoch: 50 [356/1000 11392/32000 (36%)] Loss: 0.41339 (QuantReg: 12.98063) QuantErr: 12.98063 batch_time=0.35583 
Train Epoch: 50 [361/1000 11552/32000 (36%)] Loss: 0.20481 (QuantReg: 12.69375) QuantErr: 12.69375 batch_time=0.34686 
Train Epoch: 50 [366/1000 11712/32000 (37%)] Loss: 0.11961 (QuantReg: 13.46637) QuantErr: 13.46637 batch_time=0.49856 
Train Epoch: 50 [371/1000 11872/32000 (37%)] Loss: 0.17420 (QuantReg: 13.08231) QuantErr: 13.08231 batch_time=0.35856 
Train Epoch: 50 [376/1000 12032/32000 (38%)] Loss: 0.40506 (QuantReg: 12.44239) QuantErr: 12.44239 batch_time=0.39003 
Train Epoch: 50 [381/1000 12192/32000 (38%)] Loss: 0.14443 (QuantReg: 12.55945) QuantErr: 12.55945 batch_time=0.42801 
Train Epoch: 50 [386/1000 12352/32000 (39%)] Loss: 0.10211 (QuantReg: 13.30624) QuantErr: 13.30624 batch_time=0.44261 
Train Epoch: 50 [391/1000 12512/32000 (39%)] Loss: 0.21605 (QuantReg: 13.29226) QuantErr: 13.29226 batch_time=0.36240 
Train Epoch: 50 [396/1000 12672/32000 (40%)] Loss: 0.16315 (QuantReg: 12.82877) QuantErr: 12.82877 batch_time=0.36666 
Train Epoch: 50 [401/1000 12832/32000 (40%)] Loss: 0.40198 (QuantReg: 13.11866) QuantErr: 13.11866 batch_time=0.53064 
Train Epoch: 50 [406/1000 12992/32000 (41%)] Loss: 0.24921 (QuantReg: 13.20384) QuantErr: 13.20384 batch_time=0.93010 
Train Epoch: 50 [411/1000 13152/32000 (41%)] Loss: 0.53379 (QuantReg: 12.75520) QuantErr: 12.75520 batch_time=0.34980 
Train Epoch: 50 [416/1000 13312/32000 (42%)] Loss: 0.28198 (QuantReg: 13.55822) QuantErr: 13.55822 batch_time=0.35373 
Train Epoch: 50 [421/1000 13472/32000 (42%)] Loss: 0.20610 (QuantReg: 13.04667) QuantErr: 13.04667 batch_time=0.37966 
Train Epoch: 50 [426/1000 13632/32000 (43%)] Loss: 0.20460 (QuantReg: 12.95324) QuantErr: 12.95324 batch_time=0.35858 
Train Epoch: 50 [431/1000 13792/32000 (43%)] Loss: 0.28844 (QuantReg: 13.08623) QuantErr: 13.08623 batch_time=0.35772 
Train Epoch: 50 [436/1000 13952/32000 (44%)] Loss: 0.10336 (QuantReg: 13.26406) QuantErr: 13.26406 batch_time=0.36374 
Train Epoch: 50 [441/1000 14112/32000 (44%)] Loss: 0.27666 (QuantReg: 12.58125) QuantErr: 12.58125 batch_time=0.37869 
Train Epoch: 50 [446/1000 14272/32000 (45%)] Loss: 0.18624 (QuantReg: 13.18570) QuantErr: 13.18570 batch_time=0.48810 
Train Epoch: 50 [451/1000 14432/32000 (45%)] Loss: 0.37250 (QuantReg: 12.80060) QuantErr: 12.80060 batch_time=0.36002 
Train Epoch: 50 [456/1000 14592/32000 (46%)] Loss: 0.07575 (QuantReg: 12.69828) QuantErr: 12.69828 batch_time=0.42183 
Train Epoch: 50 [461/1000 14752/32000 (46%)] Loss: 0.38433 (QuantReg: 13.03895) QuantErr: 13.03895 batch_time=0.39276 
Train Epoch: 50 [466/1000 14912/32000 (47%)] Loss: 0.35444 (QuantReg: 13.02311) QuantErr: 13.02311 batch_time=0.36696 
Train Epoch: 50 [471/1000 15072/32000 (47%)] Loss: 0.31551 (QuantReg: 12.81216) QuantErr: 12.81216 batch_time=0.37131 
Train Epoch: 50 [476/1000 15232/32000 (48%)] Loss: 0.13732 (QuantReg: 13.12854) QuantErr: 13.12854 batch_time=0.35903 
Train Epoch: 50 [481/1000 15392/32000 (48%)] Loss: 0.25681 (QuantReg: 12.73295) QuantErr: 12.73295 batch_time=0.35217 
Train Epoch: 50 [486/1000 15552/32000 (49%)] Loss: 0.22371 (QuantReg: 13.61048) QuantErr: 13.61048 batch_time=0.37781 
Train Epoch: 50 [491/1000 15712/32000 (49%)] Loss: 0.13173 (QuantReg: 13.22219) QuantErr: 13.22219 batch_time=0.35198 
Train Epoch: 50 [496/1000 15872/32000 (50%)] Loss: 0.58674 (QuantReg: 12.98887) QuantErr: 12.98887 batch_time=0.36836 
Train Epoch: 50 [501/1000 16032/32000 (50%)] Loss: 0.17744 (QuantReg: 13.25951) QuantErr: 13.25951 batch_time=0.39670 
Train Epoch: 50 [506/1000 16192/32000 (51%)] Loss: 0.52707 (QuantReg: 13.08557) QuantErr: 13.08557 batch_time=0.41077 
Train Epoch: 50 [511/1000 16352/32000 (51%)] Loss: 0.36774 (QuantReg: 12.92085) QuantErr: 12.92085 batch_time=0.36383 
Train Epoch: 50 [516/1000 16512/32000 (52%)] Loss: 0.21132 (QuantReg: 12.59568) QuantErr: 12.59568 batch_time=0.43511 
Train Epoch: 50 [521/1000 16672/32000 (52%)] Loss: 0.34062 (QuantReg: 12.64310) QuantErr: 12.64310 batch_time=0.36644 
Train Epoch: 50 [526/1000 16832/32000 (53%)] Loss: 0.15329 (QuantReg: 12.72458) QuantErr: 12.72458 batch_time=0.36212 
Train Epoch: 50 [531/1000 16992/32000 (53%)] Loss: 0.27411 (QuantReg: 13.00259) QuantErr: 13.00259 batch_time=0.56842 
Train Epoch: 50 [536/1000 17152/32000 (54%)] Loss: 0.17987 (QuantReg: 13.16957) QuantErr: 13.16957 batch_time=0.46183 
Train Epoch: 50 [541/1000 17312/32000 (54%)] Loss: 0.12796 (QuantReg: 13.46061) QuantErr: 13.46061 batch_time=0.35977 
Train Epoch: 50 [546/1000 17472/32000 (55%)] Loss: 0.14843 (QuantReg: 12.99308) QuantErr: 12.99308 batch_time=0.35037 
Train Epoch: 50 [551/1000 17632/32000 (55%)] Loss: 0.24746 (QuantReg: 12.84853) QuantErr: 12.84853 batch_time=0.35915 
Train Epoch: 50 [556/1000 17792/32000 (56%)] Loss: 0.07337 (QuantReg: 12.87179) QuantErr: 12.87179 batch_time=0.35871 
Train Epoch: 50 [561/1000 17952/32000 (56%)] Loss: 0.12752 (QuantReg: 13.82781) QuantErr: 13.82781 batch_time=0.35135 
Train Epoch: 50 [566/1000 18112/32000 (57%)] Loss: 0.24091 (QuantReg: 13.39308) QuantErr: 13.39308 batch_time=0.36460 
Train Epoch: 50 [571/1000 18272/32000 (57%)] Loss: 0.26330 (QuantReg: 13.27790) QuantErr: 13.27790 batch_time=0.35881 
Train Epoch: 50 [576/1000 18432/32000 (58%)] Loss: 0.11596 (QuantReg: 12.68560) QuantErr: 12.68560 batch_time=0.46019 
Train Epoch: 50 [581/1000 18592/32000 (58%)] Loss: 0.46712 (QuantReg: 13.18658) QuantErr: 13.18658 batch_time=0.42385 
Train Epoch: 50 [586/1000 18752/32000 (59%)] Loss: 0.34650 (QuantReg: 12.32667) QuantErr: 12.32667 batch_time=0.43445 
Train Epoch: 50 [591/1000 18912/32000 (59%)] Loss: 0.29168 (QuantReg: 13.02168) QuantErr: 13.02168 batch_time=0.35850 
Train Epoch: 50 [596/1000 19072/32000 (60%)] Loss: 0.21373 (QuantReg: 13.35241) QuantErr: 13.35241 batch_time=0.36347 
Train Epoch: 50 [601/1000 19232/32000 (60%)] Loss: 0.25866 (QuantReg: 13.20987) QuantErr: 13.20987 batch_time=0.40708 
Train Epoch: 50 [606/1000 19392/32000 (61%)] Loss: 0.36700 (QuantReg: 13.05166) QuantErr: 13.05166 batch_time=0.37042 
Train Epoch: 50 [611/1000 19552/32000 (61%)] Loss: 0.22678 (QuantReg: 12.92958) QuantErr: 12.92958 batch_time=0.39509 
Train Epoch: 50 [616/1000 19712/32000 (62%)] Loss: 0.11659 (QuantReg: 12.71081) QuantErr: 12.71081 batch_time=0.44370 
Train Epoch: 50 [621/1000 19872/32000 (62%)] Loss: 0.35766 (QuantReg: 12.61281) QuantErr: 12.61281 batch_time=0.42255 
Train Epoch: 50 [626/1000 20032/32000 (63%)] Loss: 0.74076 (QuantReg: 13.43377) QuantErr: 13.43377 batch_time=0.43005 
Train Epoch: 50 [631/1000 20192/32000 (63%)] Loss: 0.24872 (QuantReg: 13.02833) QuantErr: 13.02833 batch_time=0.37214 
Train Epoch: 50 [636/1000 20352/32000 (64%)] Loss: 0.52995 (QuantReg: 13.12715) QuantErr: 13.12715 batch_time=0.35584 
Train Epoch: 50 [641/1000 20512/32000 (64%)] Loss: 0.47013 (QuantReg: 13.22240) QuantErr: 13.22240 batch_time=0.58808 
Train Epoch: 50 [646/1000 20672/32000 (65%)] Loss: 0.10798 (QuantReg: 13.38676) QuantErr: 13.38676 batch_time=0.39122 
Train Epoch: 50 [651/1000 20832/32000 (65%)] Loss: 0.29341 (QuantReg: 13.24576) QuantErr: 13.24576 batch_time=0.38574 
Train Epoch: 50 [656/1000 20992/32000 (66%)] Loss: 0.22870 (QuantReg: 12.63513) QuantErr: 12.63513 batch_time=0.75030 
Train Epoch: 50 [661/1000 21152/32000 (66%)] Loss: 0.31030 (QuantReg: 12.81198) QuantErr: 12.81198 batch_time=0.84685 
Train Epoch: 50 [666/1000 21312/32000 (67%)] Loss: 0.42935 (QuantReg: 12.87146) QuantErr: 12.87146 batch_time=0.36227 
Train Epoch: 50 [671/1000 21472/32000 (67%)] Loss: 0.13760 (QuantReg: 13.45522) QuantErr: 13.45522 batch_time=0.40991 
Train Epoch: 50 [676/1000 21632/32000 (68%)] Loss: 0.25061 (QuantReg: 13.07810) QuantErr: 13.07810 batch_time=0.40152 
Train Epoch: 50 [681/1000 21792/32000 (68%)] Loss: 0.33798 (QuantReg: 13.45552) QuantErr: 13.45552 batch_time=0.43468 
Train Epoch: 50 [686/1000 21952/32000 (69%)] Loss: 0.52245 (QuantReg: 13.29127) QuantErr: 13.29127 batch_time=0.35141 
Train Epoch: 50 [691/1000 22112/32000 (69%)] Loss: 0.29748 (QuantReg: 13.37907) QuantErr: 13.37907 batch_time=0.42583 
Train Epoch: 50 [696/1000 22272/32000 (70%)] Loss: 0.18529 (QuantReg: 12.79565) QuantErr: 12.79565 batch_time=0.39833 
Train Epoch: 50 [701/1000 22432/32000 (70%)] Loss: 0.18677 (QuantReg: 13.08738) QuantErr: 13.08738 batch_time=0.53247 
Train Epoch: 50 [706/1000 22592/32000 (71%)] Loss: 0.10414 (QuantReg: 13.12954) QuantErr: 13.12954 batch_time=0.36395 
Train Epoch: 50 [711/1000 22752/32000 (71%)] Loss: 0.16672 (QuantReg: 13.84214) QuantErr: 13.84214 batch_time=0.36058 
Train Epoch: 50 [716/1000 22912/32000 (72%)] Loss: 0.26665 (QuantReg: 12.78619) QuantErr: 12.78619 batch_time=0.35664 
Train Epoch: 50 [721/1000 23072/32000 (72%)] Loss: 0.22393 (QuantReg: 13.46239) QuantErr: 13.46239 batch_time=0.59109 
Train Epoch: 50 [726/1000 23232/32000 (73%)] Loss: 0.25567 (QuantReg: 12.89424) QuantErr: 12.89424 batch_time=0.97723 
Train Epoch: 50 [731/1000 23392/32000 (73%)] Loss: 0.33687 (QuantReg: 12.93371) QuantErr: 12.93371 batch_time=0.37773 
Train Epoch: 50 [736/1000 23552/32000 (74%)] Loss: 0.26949 (QuantReg: 12.92379) QuantErr: 12.92379 batch_time=0.38731 
Train Epoch: 50 [741/1000 23712/32000 (74%)] Loss: 0.28178 (QuantReg: 13.05571) QuantErr: 13.05571 batch_time=0.37646 
Train Epoch: 50 [746/1000 23872/32000 (75%)] Loss: 0.23276 (QuantReg: 13.00548) QuantErr: 13.00548 batch_time=0.36606 
Train Epoch: 50 [751/1000 24032/32000 (75%)] Loss: 0.32284 (QuantReg: 12.49344) QuantErr: 12.49344 batch_time=0.40590 
Train Epoch: 50 [756/1000 24192/32000 (76%)] Loss: 0.29862 (QuantReg: 12.76970) QuantErr: 12.76970 batch_time=0.35446 
Train Epoch: 50 [761/1000 24352/32000 (76%)] Loss: 0.26148 (QuantReg: 13.26876) QuantErr: 13.26876 batch_time=0.37776 
Train Epoch: 50 [766/1000 24512/32000 (77%)] Loss: 0.61777 (QuantReg: 12.75230) QuantErr: 12.75230 batch_time=0.38259 
Train Epoch: 50 [771/1000 24672/32000 (77%)] Loss: 0.31965 (QuantReg: 13.19746) QuantErr: 13.19746 batch_time=0.38757 
Train Epoch: 50 [776/1000 24832/32000 (78%)] Loss: 0.24829 (QuantReg: 12.89128) QuantErr: 12.89128 batch_time=0.42316 
Train Epoch: 50 [781/1000 24992/32000 (78%)] Loss: 0.16108 (QuantReg: 13.26179) QuantErr: 13.26179 batch_time=0.40271 
Train Epoch: 50 [786/1000 25152/32000 (79%)] Loss: 0.14526 (QuantReg: 13.34891) QuantErr: 13.34891 batch_time=0.36804 
Train Epoch: 50 [791/1000 25312/32000 (79%)] Loss: 0.06494 (QuantReg: 13.13617) QuantErr: 13.13617 batch_time=0.34778 
Train Epoch: 50 [796/1000 25472/32000 (80%)] Loss: 0.71451 (QuantReg: 13.44618) QuantErr: 13.44618 batch_time=0.46695 
Train Epoch: 50 [801/1000 25632/32000 (80%)] Loss: 0.47969 (QuantReg: 13.24504) QuantErr: 13.24504 batch_time=0.45338 
Train Epoch: 50 [806/1000 25792/32000 (81%)] Loss: 0.22484 (QuantReg: 13.33358) QuantErr: 13.33358 batch_time=0.37886 
Train Epoch: 50 [811/1000 25952/32000 (81%)] Loss: 0.22085 (QuantReg: 13.44513) QuantErr: 13.44513 batch_time=0.41800 
Train Epoch: 50 [816/1000 26112/32000 (82%)] Loss: 0.22345 (QuantReg: 12.84599) QuantErr: 12.84599 batch_time=0.36106 
Train Epoch: 50 [821/1000 26272/32000 (82%)] Loss: 0.38238 (QuantReg: 13.18854) QuantErr: 13.18854 batch_time=0.40279 
Train Epoch: 50 [826/1000 26432/32000 (83%)] Loss: 0.46478 (QuantReg: 13.21233) QuantErr: 13.21233 batch_time=0.36868 
Train Epoch: 50 [831/1000 26592/32000 (83%)] Loss: 0.17533 (QuantReg: 12.98477) QuantErr: 12.98477 batch_time=0.37436 
Train Epoch: 50 [836/1000 26752/32000 (84%)] Loss: 0.12351 (QuantReg: 12.67008) QuantErr: 12.67008 batch_time=0.44264 
Train Epoch: 50 [841/1000 26912/32000 (84%)] Loss: 0.16719 (QuantReg: 13.32987) QuantErr: 13.32987 batch_time=0.42588 
Train Epoch: 50 [846/1000 27072/32000 (85%)] Loss: 0.21782 (QuantReg: 12.36091) QuantErr: 12.36091 batch_time=0.36085 
Train Epoch: 50 [851/1000 27232/32000 (85%)] Loss: 0.06321 (QuantReg: 13.72534) QuantErr: 13.72534 batch_time=0.60231 
Train Epoch: 50 [856/1000 27392/32000 (86%)] Loss: 0.14663 (QuantReg: 13.17279) QuantErr: 13.17279 batch_time=0.39483 
Train Epoch: 50 [861/1000 27552/32000 (86%)] Loss: 0.10716 (QuantReg: 13.25800) QuantErr: 13.25800 batch_time=0.40801 
Train Epoch: 50 [866/1000 27712/32000 (87%)] Loss: 0.21673 (QuantReg: 12.77851) QuantErr: 12.77851 batch_time=0.39235 
Train Epoch: 50 [871/1000 27872/32000 (87%)] Loss: 0.11170 (QuantReg: 13.53550) QuantErr: 13.53550 batch_time=0.43911 
Train Epoch: 50 [876/1000 28032/32000 (88%)] Loss: 0.08255 (QuantReg: 12.74030) QuantErr: 12.74030 batch_time=0.35392 
Train Epoch: 50 [881/1000 28192/32000 (88%)] Loss: 0.23591 (QuantReg: 13.14256) QuantErr: 13.14256 batch_time=0.35769 
Train Epoch: 50 [886/1000 28352/32000 (89%)] Loss: 0.45937 (QuantReg: 13.03303) QuantErr: 13.03303 batch_time=0.37010 
Train Epoch: 50 [891/1000 28512/32000 (89%)] Loss: 0.28720 (QuantReg: 13.26194) QuantErr: 13.26194 batch_time=0.44284 
Train Epoch: 50 [896/1000 28672/32000 (90%)] Loss: 0.07414 (QuantReg: 13.32164) QuantErr: 13.32164 batch_time=0.36477 
Train Epoch: 50 [901/1000 28832/32000 (90%)] Loss: 0.16115 (QuantReg: 13.49108) QuantErr: 13.49108 batch_time=0.39276 
Train Epoch: 50 [906/1000 28992/32000 (91%)] Loss: 0.15193 (QuantReg: 13.49897) QuantErr: 13.49897 batch_time=0.46686 
Train Epoch: 50 [911/1000 29152/32000 (91%)] Loss: 0.13814 (QuantReg: 12.78042) QuantErr: 12.78042 batch_time=0.40472 
Train Epoch: 50 [916/1000 29312/32000 (92%)] Loss: 0.32398 (QuantReg: 13.20252) QuantErr: 13.20252 batch_time=0.47393 
Train Epoch: 50 [921/1000 29472/32000 (92%)] Loss: 0.14749 (QuantReg: 13.16593) QuantErr: 13.16593 batch_time=0.40779 
Train Epoch: 50 [926/1000 29632/32000 (93%)] Loss: 0.17503 (QuantReg: 12.92134) QuantErr: 12.92134 batch_time=0.38355 
Train Epoch: 50 [931/1000 29792/32000 (93%)] Loss: 0.23703 (QuantReg: 13.13385) QuantErr: 13.13385 batch_time=0.40557 
Train Epoch: 50 [936/1000 29952/32000 (94%)] Loss: 0.18890 (QuantReg: 13.18025) QuantErr: 13.18025 batch_time=0.35481 
Train Epoch: 50 [941/1000 30112/32000 (94%)] Loss: 0.35086 (QuantReg: 12.69522) QuantErr: 12.69522 batch_time=0.37477 
Train Epoch: 50 [946/1000 30272/32000 (95%)] Loss: 0.27332 (QuantReg: 13.20795) QuantErr: 13.20795 batch_time=0.38176 
Train Epoch: 50 [951/1000 30432/32000 (95%)] Loss: 0.12568 (QuantReg: 13.71354) QuantErr: 13.71354 batch_time=0.37346 
Train Epoch: 50 [956/1000 30592/32000 (96%)] Loss: 0.26703 (QuantReg: 13.51446) QuantErr: 13.51446 batch_time=0.37160 
Train Epoch: 50 [961/1000 30752/32000 (96%)] Loss: 0.26999 (QuantReg: 12.81750) QuantErr: 12.81750 batch_time=0.56884 
Train Epoch: 50 [966/1000 30912/32000 (97%)] Loss: 0.19375 (QuantReg: 13.68319) QuantErr: 13.68319 batch_time=0.35908 
Train Epoch: 50 [971/1000 31072/32000 (97%)] Loss: 0.23841 (QuantReg: 12.91272) QuantErr: 12.91272 batch_time=0.37952 
Train Epoch: 50 [976/1000 31232/32000 (98%)] Loss: 0.39519 (QuantReg: 13.12597) QuantErr: 13.12597 batch_time=0.63187 
Train Epoch: 50 [981/1000 31392/32000 (98%)] Loss: 0.11625 (QuantReg: 12.90196) QuantErr: 12.90196 batch_time=0.86555 
Train Epoch: 50 [986/1000 31552/32000 (99%)] Loss: 0.27478 (QuantReg: 13.59065) QuantErr: 13.59065 batch_time=0.43874 
Train Epoch: 50 [991/1000 31712/32000 (99%)] Loss: 0.18414 (QuantReg: 12.68867) QuantErr: 12.68867 batch_time=0.36286 
Train Epoch: 50 [996/1000 31872/32000 (100%)] Loss: 0.34793 (QuantReg: 13.32828) QuantErr: 13.32828 batch_time=0.47271 
Train Epoch: 50 codebook_update_time=1.86523
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch50.pth ...
Done in 4.511s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/checkpoint-epoch50.pth ...
Done in 8.920s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 0.2755491539761424
 quant_reg      : 13.044769620895385
 quant_err      : 13.044769620895385
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 50000
 MSRVTT_full_val/t2v_metrics/R1: 31.187122736418512
 MSRVTT_full_val/t2v_metrics/R5: 71.42857142857143
 MSRVTT_full_val/t2v_metrics/R10: 82.69617706237425
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.44466800804829
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.899821280575246
 MSRVTT_full_val/v2t_metrics/R1: 38.028169014084504
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.199195171026157
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.19437073258421
 MSRVTT_full_test/t2v_metrics/R1: 13.74581939799331
 MSRVTT_full_test/t2v_metrics/R5: 38.39464882943144
 MSRVTT_full_test/t2v_metrics/R10: 52.374581939799334
 MSRVTT_full_test/t2v_metrics/R50: 80.80267558528428
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.51036789297659
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.235742233623053
 MSRVTT_full_test/v2t_metrics/R1: 16.387959866220736
 MSRVTT_full_test/v2t_metrics/R5: 44.5819397993311
 MSRVTT_full_test/v2t_metrics/R10: 58.862876254180605
 MSRVTT_full_test/v2t_metrics/R50: 86.2876254180602
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.54080267558528
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.03551002757198
 mnt_best       : 30.235742233623053
 not_improved_count: 0
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/trained_model.pth ...
Ckpt loaded at epoch 50.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 13.74581939799331
 t2v_metrics/R5/final_eval: 38.39464882943144
 t2v_metrics/R10/final_eval: 52.374581939799334
 t2v_metrics/R50/final_eval: 80.80267558528428
 t2v_metrics/MedR/final_eval: 10.0
 t2v_metrics/MeanR/final_eval: 45.51036789297659
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 30.235742233623053
 v2t_metrics/R1/final_eval: 16.387959866220736
 v2t_metrics/R5/final_eval: 44.5819397993311
 v2t_metrics/R10/final_eval: 58.862876254180605
 v2t_metrics/R50/final_eval: 86.2876254180602
 v2t_metrics/MedR/final_eval: 7.0
 v2t_metrics/MeanR/final_eval: 32.54080267558528
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 35.03551002757198
Best epoch for the monitored metric: 50
Script took 07h45m47s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs32/trained_model.pth
