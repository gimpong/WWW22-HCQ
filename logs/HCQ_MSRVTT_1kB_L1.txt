Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1
Preparing the dataloaders ...
Loading dataset MSRVTT_miech_trainval in ram ...
Finish loading dataset MSRVTT_miech_trainval in ram, taking 773.848790884018 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 114.63792705535889 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 82.19015836715698 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch0.pth ...
Done in 1.677s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch0.pth ...
Done in 3.415s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_miech_test/t2v_metrics/R1: 0.1
 MSRVTT_miech_test/t2v_metrics/R5: 0.5
 MSRVTT_miech_test/t2v_metrics/R10: 0.6
 MSRVTT_miech_test/t2v_metrics/R50: 5.0
 MSRVTT_miech_test/t2v_metrics/MedR: 502.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 500.393
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.31072325059538586
 MSRVTT_miech_test/v2t_metrics/R1: 0.0
 MSRVTT_miech_test/v2t_metrics/R5: 0.5
 MSRVTT_miech_test/v2t_metrics/R10: 0.8
 MSRVTT_miech_test/v2t_metrics/R50: 4.5
 MSRVTT_miech_test/v2t_metrics/MedR: 515.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 506.1835
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 mnt_best       : 0.31072325059538586
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 39.47011 (QuantReg: 22.51172) QuantErr: 22.51172 batch_time=33.75569 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 38.14620 (QuantReg: 22.37913) QuantErr: 22.37913 batch_time=2.45325 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 34.59476 (QuantReg: 22.44696) QuantErr: 22.44696 batch_time=0.39944 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 29.42259 (QuantReg: 22.44535) QuantErr: 22.44535 batch_time=0.75516 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 26.42833 (QuantReg: 22.54477) QuantErr: 22.54477 batch_time=0.40218 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 24.30130 (QuantReg: 22.43163) QuantErr: 22.43163 batch_time=0.49966 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 24.22937 (QuantReg: 22.62312) QuantErr: 22.62312 batch_time=0.39624 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 22.77871 (QuantReg: 22.60013) QuantErr: 22.60013 batch_time=0.41617 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 23.24564 (QuantReg: 22.50975) QuantErr: 22.50975 batch_time=0.40516 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 21.39157 (QuantReg: 22.53990) QuantErr: 22.53990 batch_time=0.39726 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 21.54585 (QuantReg: 22.55175) QuantErr: 22.55175 batch_time=0.42267 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 21.27766 (QuantReg: 22.54229) QuantErr: 22.54229 batch_time=0.40827 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 20.01805 (QuantReg: 22.60019) QuantErr: 22.60019 batch_time=0.54228 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 19.33574 (QuantReg: 22.60562) QuantErr: 22.60562 batch_time=0.39694 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 19.23982 (QuantReg: 22.56432) QuantErr: 22.56432 batch_time=0.42223 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 18.73969 (QuantReg: 22.66190) QuantErr: 22.66190 batch_time=0.41926 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 19.65483 (QuantReg: 22.56136) QuantErr: 22.56136 batch_time=0.45943 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 18.72408 (QuantReg: 22.58389) QuantErr: 22.58389 batch_time=0.41212 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 19.90007 (QuantReg: 22.62226) QuantErr: 22.62226 batch_time=1.58255 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 21.31228 (QuantReg: 22.54951) QuantErr: 22.54951 batch_time=0.39818 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 19.83918 (QuantReg: 22.60647) QuantErr: 22.60647 batch_time=0.41766 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 18.42447 (QuantReg: 22.68834) QuantErr: 22.68834 batch_time=0.39881 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 15.64518 (QuantReg: 22.58954) QuantErr: 22.58954 batch_time=0.40306 
Train Epoch: 1 codebook_update_time=0.44923
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch1.pth ...
Done in 4.563s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch1.pth ...
Done in 9.035s
 epoch          : 1
 loss           : 23.004264335632325
 quant_reg      : 22.558331146240235
 quant_err      : 22.558331146240235
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_miech_test/t2v_metrics/R1: 9.4
 MSRVTT_miech_test/t2v_metrics/R5: 29.9
 MSRVTT_miech_test/t2v_metrics/R10: 44.5
 MSRVTT_miech_test/t2v_metrics/R50: 78.6
 MSRVTT_miech_test/t2v_metrics/MedR: 13.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 46.087
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.212380678836055
 MSRVTT_miech_test/v2t_metrics/R1: 10.0
 MSRVTT_miech_test/v2t_metrics/R5: 32.5
 MSRVTT_miech_test/v2t_metrics/R10: 45.3
 MSRVTT_miech_test/v2t_metrics/R50: 78.3
 MSRVTT_miech_test/v2t_metrics/MedR: 13.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 47.47
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.509090060254348
 mnt_best       : 23.212380678836055
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 17.43936 (QuantReg: 11.54594) QuantErr: 11.54594 batch_time=30.62970 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 16.43305 (QuantReg: 11.35877) QuantErr: 11.35877 batch_time=0.40364 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 16.30775 (QuantReg: 12.06793) QuantErr: 12.06793 batch_time=0.39760 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 17.64536 (QuantReg: 11.87438) QuantErr: 11.87438 batch_time=0.40064 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 16.72039 (QuantReg: 11.90272) QuantErr: 11.90272 batch_time=1.03396 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 15.50074 (QuantReg: 12.96538) QuantErr: 12.96538 batch_time=0.54217 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 17.78900 (QuantReg: 12.53465) QuantErr: 12.53465 batch_time=0.40040 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 16.14030 (QuantReg: 12.85550) QuantErr: 12.85550 batch_time=0.40716 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 14.51978 (QuantReg: 12.84403) QuantErr: 12.84403 batch_time=0.39572 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 13.50896 (QuantReg: 13.40492) QuantErr: 13.40492 batch_time=0.39626 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 16.10179 (QuantReg: 13.28533) QuantErr: 13.28533 batch_time=0.52644 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 17.06365 (QuantReg: 13.02889) QuantErr: 13.02889 batch_time=0.43013 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 15.71891 (QuantReg: 13.53376) QuantErr: 13.53376 batch_time=0.40672 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 15.60490 (QuantReg: 13.59201) QuantErr: 13.59201 batch_time=0.40328 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 14.47570 (QuantReg: 13.62023) QuantErr: 13.62023 batch_time=0.98496 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 14.13923 (QuantReg: 14.02548) QuantErr: 14.02548 batch_time=0.40706 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 13.28438 (QuantReg: 14.53993) QuantErr: 14.53993 batch_time=0.75688 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 14.10795 (QuantReg: 14.12801) QuantErr: 14.12801 batch_time=0.43504 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 14.33472 (QuantReg: 14.56124) QuantErr: 14.56124 batch_time=0.40865 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 13.06679 (QuantReg: 14.18870) QuantErr: 14.18870 batch_time=0.41185 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 13.48801 (QuantReg: 14.06668) QuantErr: 14.06668 batch_time=0.45397 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 14.61469 (QuantReg: 14.73817) QuantErr: 14.73817 batch_time=0.41880 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 14.10312 (QuantReg: 14.34653) QuantErr: 14.34653 batch_time=0.40240 
Train Epoch: 2 codebook_update_time=0.41810
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch2.pth ...
Done in 4.204s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch2.pth ...
Done in 8.384s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.04s]
 epoch          : 2
 loss           : 15.42320152282715
 quant_reg      : 13.34117865371704
 quant_err      : 13.34117865371704
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_miech_test/t2v_metrics/R1: 11.4
 MSRVTT_miech_test/t2v_metrics/R5: 37.9
 MSRVTT_miech_test/t2v_metrics/R10: 50.2
 MSRVTT_miech_test/t2v_metrics/R50: 83.2
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 40.157
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.88790729908038
 MSRVTT_miech_test/v2t_metrics/R1: 11.9
 MSRVTT_miech_test/v2t_metrics/R5: 37.3
 MSRVTT_miech_test/v2t_metrics/R10: 49.5
 MSRVTT_miech_test/v2t_metrics/R50: 82.5
 MSRVTT_miech_test/v2t_metrics/MedR: 11.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 39.3855
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.00831598229496
 mnt_best       : 27.88790729908038
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 14.19038 (QuantReg: 12.20504) QuantErr: 12.20504 batch_time=33.33547 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 13.89458 (QuantReg: 11.98402) QuantErr: 11.98402 batch_time=0.42421 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 13.31095 (QuantReg: 11.77733) QuantErr: 11.77733 batch_time=0.41113 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 13.86524 (QuantReg: 12.00462) QuantErr: 12.00462 batch_time=0.43417 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 13.65553 (QuantReg: 12.11991) QuantErr: 12.11991 batch_time=0.39956 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 12.86022 (QuantReg: 12.21860) QuantErr: 12.21860 batch_time=0.42752 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 14.13010 (QuantReg: 12.31317) QuantErr: 12.31317 batch_time=0.39527 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 13.50948 (QuantReg: 12.55603) QuantErr: 12.55603 batch_time=0.40895 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 12.92792 (QuantReg: 12.73589) QuantErr: 12.73589 batch_time=0.40783 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 13.68627 (QuantReg: 12.38800) QuantErr: 12.38800 batch_time=0.46064 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 13.03564 (QuantReg: 12.78097) QuantErr: 12.78097 batch_time=0.43825 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 14.47116 (QuantReg: 12.52165) QuantErr: 12.52165 batch_time=0.42575 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 14.17427 (QuantReg: 13.00101) QuantErr: 13.00101 batch_time=4.01962 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 12.69377 (QuantReg: 12.82129) QuantErr: 12.82129 batch_time=0.40521 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 13.53201 (QuantReg: 12.59543) QuantErr: 12.59543 batch_time=0.44115 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 13.00321 (QuantReg: 13.12404) QuantErr: 13.12404 batch_time=0.40509 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 13.24077 (QuantReg: 12.91362) QuantErr: 12.91362 batch_time=0.79096 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 11.79090 (QuantReg: 12.74204) QuantErr: 12.74204 batch_time=0.74746 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 13.59607 (QuantReg: 12.99763) QuantErr: 12.99763 batch_time=0.40308 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 11.82134 (QuantReg: 13.23424) QuantErr: 13.23424 batch_time=0.43902 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 13.31285 (QuantReg: 13.47512) QuantErr: 13.47512 batch_time=0.42236 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 13.10858 (QuantReg: 13.13122) QuantErr: 13.13122 batch_time=0.39590 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 11.46240 (QuantReg: 13.45502) QuantErr: 13.45502 batch_time=0.40849 
Train Epoch: 3 codebook_update_time=0.49717
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch3.pth ...
Done in 4.122s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch3.pth ...
Done in 8.302s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 13.254443386077881
 quant_reg      : 12.573423419952393
 quant_err      : 12.573423419952393
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_miech_test/t2v_metrics/R1: 14.0
 MSRVTT_miech_test/t2v_metrics/R5: 39.2
 MSRVTT_miech_test/t2v_metrics/R10: 53.8
 MSRVTT_miech_test/t2v_metrics/R50: 84.5
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.86
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.9076125538077
 MSRVTT_miech_test/v2t_metrics/R1: 14.2
 MSRVTT_miech_test/v2t_metrics/R5: 38.2
 MSRVTT_miech_test/v2t_metrics/R10: 53.4
 MSRVTT_miech_test/v2t_metrics/R50: 84.6
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 37.218
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.7112614169186
 mnt_best       : 30.9076125538077
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 12.24158 (QuantReg: 12.06451) QuantErr: 12.06451 batch_time=28.02142 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 12.11939 (QuantReg: 11.87605) QuantErr: 11.87605 batch_time=0.39851 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 12.99228 (QuantReg: 12.05025) QuantErr: 12.05025 batch_time=1.62917 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 11.41338 (QuantReg: 12.25241) QuantErr: 12.25241 batch_time=0.41044 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 13.25156 (QuantReg: 12.03387) QuantErr: 12.03387 batch_time=0.40462 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 11.48609 (QuantReg: 12.30199) QuantErr: 12.30199 batch_time=0.43774 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 11.78933 (QuantReg: 12.44425) QuantErr: 12.44425 batch_time=0.40516 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 11.42651 (QuantReg: 12.18880) QuantErr: 12.18880 batch_time=0.42958 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 13.68217 (QuantReg: 12.09868) QuantErr: 12.09868 batch_time=0.40778 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 11.01597 (QuantReg: 12.31607) QuantErr: 12.31607 batch_time=0.38822 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 13.63887 (QuantReg: 12.66977) QuantErr: 12.66977 batch_time=0.43736 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 12.96862 (QuantReg: 12.44632) QuantErr: 12.44632 batch_time=0.41690 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 10.93685 (QuantReg: 12.31167) QuantErr: 12.31167 batch_time=0.40162 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 11.13231 (QuantReg: 12.69315) QuantErr: 12.69315 batch_time=0.39165 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 11.16014 (QuantReg: 12.62325) QuantErr: 12.62325 batch_time=0.40241 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 11.02400 (QuantReg: 12.90488) QuantErr: 12.90488 batch_time=0.43105 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 11.46787 (QuantReg: 12.95362) QuantErr: 12.95362 batch_time=0.43219 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 11.73361 (QuantReg: 12.77979) QuantErr: 12.77979 batch_time=0.39963 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 11.29597 (QuantReg: 12.96758) QuantErr: 12.96758 batch_time=0.41225 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 11.74684 (QuantReg: 12.74053) QuantErr: 12.74053 batch_time=0.42025 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 11.85578 (QuantReg: 12.58318) QuantErr: 12.58318 batch_time=0.46168 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 11.12870 (QuantReg: 12.95496) QuantErr: 12.95496 batch_time=0.39746 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 10.39583 (QuantReg: 13.29091) QuantErr: 13.29091 batch_time=0.45543 
Train Epoch: 4 codebook_update_time=0.46026
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch4.pth ...
Done in 4.417s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch4.pth ...
Done in 8.662s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 11.711074295043945
 quant_reg      : 12.44312604522705
 quant_err      : 12.44312604522705
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_miech_test/t2v_metrics/R1: 14.9
 MSRVTT_miech_test/t2v_metrics/R5: 41.9
 MSRVTT_miech_test/t2v_metrics/R10: 58.1
 MSRVTT_miech_test/t2v_metrics/R50: 86.5
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.29
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.102348601009346
 MSRVTT_miech_test/v2t_metrics/R1: 17.3
 MSRVTT_miech_test/v2t_metrics/R5: 42.5
 MSRVTT_miech_test/v2t_metrics/R10: 56.4
 MSRVTT_miech_test/v2t_metrics/R50: 86.5
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 34.2755
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.61290462764593
 mnt_best       : 33.102348601009346
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 11.31428 (QuantReg: 12.22632) QuantErr: 12.22632 batch_time=33.65436 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 11.30921 (QuantReg: 11.99150) QuantErr: 11.99150 batch_time=2.47494 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 11.47607 (QuantReg: 11.90784) QuantErr: 11.90784 batch_time=0.42878 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 9.96153 (QuantReg: 12.21704) QuantErr: 12.21704 batch_time=0.41027 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 11.76542 (QuantReg: 12.45435) QuantErr: 12.45435 batch_time=0.49899 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 8.50068 (QuantReg: 12.44417) QuantErr: 12.44417 batch_time=0.41130 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 11.32301 (QuantReg: 12.55168) QuantErr: 12.55168 batch_time=0.41268 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 11.34299 (QuantReg: 12.08590) QuantErr: 12.08590 batch_time=0.40442 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 12.94715 (QuantReg: 12.44090) QuantErr: 12.44090 batch_time=1.49855 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 9.43069 (QuantReg: 12.22727) QuantErr: 12.22727 batch_time=0.42119 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 10.88756 (QuantReg: 12.69641) QuantErr: 12.69641 batch_time=0.40259 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 9.96939 (QuantReg: 12.58472) QuantErr: 12.58472 batch_time=0.40651 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 8.92341 (QuantReg: 12.43947) QuantErr: 12.43947 batch_time=0.42962 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 11.28197 (QuantReg: 12.55110) QuantErr: 12.55110 batch_time=2.72656 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 11.74527 (QuantReg: 12.73380) QuantErr: 12.73380 batch_time=0.42500 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 9.38312 (QuantReg: 12.88463) QuantErr: 12.88463 batch_time=0.41169 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 8.84635 (QuantReg: 12.65850) QuantErr: 12.65850 batch_time=0.38964 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 10.42243 (QuantReg: 12.66226) QuantErr: 12.66226 batch_time=0.40487 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 9.70435 (QuantReg: 12.35521) QuantErr: 12.35521 batch_time=0.39453 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 9.48479 (QuantReg: 12.92469) QuantErr: 12.92469 batch_time=0.40654 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 10.01056 (QuantReg: 12.72803) QuantErr: 12.72803 batch_time=0.49091 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 8.07802 (QuantReg: 13.20098) QuantErr: 13.20098 batch_time=0.39853 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 10.78590 (QuantReg: 12.57439) QuantErr: 12.57439 batch_time=0.41838 
Train Epoch: 5 codebook_update_time=0.42538
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch5.pth ...
Done in 4.293s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch5.pth ...
Done in 8.407s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 10.607116243362427
 quant_reg      : 12.531304187774658
 quant_err      : 12.531304187774658
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_miech_test/t2v_metrics/R1: 17.2
 MSRVTT_miech_test/t2v_metrics/R5: 43.9
 MSRVTT_miech_test/t2v_metrics/R10: 58.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.64
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.34947306634721
 MSRVTT_miech_test/v2t_metrics/R1: 16.2
 MSRVTT_miech_test/v2t_metrics/R5: 44.0
 MSRVTT_miech_test/v2t_metrics/R10: 58.3
 MSRVTT_miech_test/v2t_metrics/R50: 87.5
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 33.0145
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.63741039227711
 mnt_best       : 35.34947306634721
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 10.59931 (QuantReg: 12.23463) QuantErr: 12.23463 batch_time=35.33791 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 8.81248 (QuantReg: 12.13199) QuantErr: 12.13199 batch_time=0.46157 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 11.39352 (QuantReg: 12.05853) QuantErr: 12.05853 batch_time=0.50318 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 9.84938 (QuantReg: 12.43899) QuantErr: 12.43899 batch_time=0.40720 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 9.98526 (QuantReg: 12.54375) QuantErr: 12.54375 batch_time=0.40278 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 8.05497 (QuantReg: 12.25947) QuantErr: 12.25947 batch_time=0.67809 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 10.21521 (QuantReg: 12.50941) QuantErr: 12.50941 batch_time=0.43362 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 9.66104 (QuantReg: 12.68368) QuantErr: 12.68368 batch_time=0.42791 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 7.98029 (QuantReg: 12.66123) QuantErr: 12.66123 batch_time=0.43657 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 9.08545 (QuantReg: 12.43545) QuantErr: 12.43545 batch_time=0.38932 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 11.23204 (QuantReg: 12.74666) QuantErr: 12.74666 batch_time=0.41783 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 11.40745 (QuantReg: 12.90985) QuantErr: 12.90985 batch_time=0.43450 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 8.76280 (QuantReg: 13.00489) QuantErr: 13.00489 batch_time=0.42954 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 8.93499 (QuantReg: 12.61261) QuantErr: 12.61261 batch_time=0.40729 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 10.11624 (QuantReg: 12.67547) QuantErr: 12.67547 batch_time=0.42780 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 8.66091 (QuantReg: 12.60831) QuantErr: 12.60831 batch_time=0.38816 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 10.16540 (QuantReg: 12.23903) QuantErr: 12.23903 batch_time=0.41187 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 9.05478 (QuantReg: 12.57277) QuantErr: 12.57277 batch_time=0.42552 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 8.25678 (QuantReg: 12.98023) QuantErr: 12.98023 batch_time=0.40891 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 10.55573 (QuantReg: 12.80965) QuantErr: 12.80965 batch_time=0.43346 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 8.45090 (QuantReg: 12.76354) QuantErr: 12.76354 batch_time=0.41143 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 8.26454 (QuantReg: 12.75662) QuantErr: 12.75662 batch_time=0.40572 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 9.49467 (QuantReg: 12.73362) QuantErr: 12.73362 batch_time=0.85014 
Train Epoch: 6 codebook_update_time=0.43068
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch6.pth ...
Done in 4.264s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch6.pth ...
Done in 8.354s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 9.623465221405029
 quant_reg      : 12.569846393585205
 quant_err      : 12.569846393585205
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_miech_test/t2v_metrics/R1: 17.6
 MSRVTT_miech_test/t2v_metrics/R5: 45.5
 MSRVTT_miech_test/t2v_metrics/R10: 59.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.7675
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.15141983229556
 MSRVTT_miech_test/v2t_metrics/R1: 16.7
 MSRVTT_miech_test/v2t_metrics/R5: 45.4
 MSRVTT_miech_test/v2t_metrics/R10: 59.7
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 30.6475
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.63818284660821
 mnt_best       : 36.15141983229556
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 9.83223 (QuantReg: 12.24847) QuantErr: 12.24847 batch_time=33.52329 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 9.99234 (QuantReg: 12.59956) QuantErr: 12.59956 batch_time=0.70546 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 8.45759 (QuantReg: 12.57084) QuantErr: 12.57084 batch_time=0.40831 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 8.75420 (QuantReg: 12.58071) QuantErr: 12.58071 batch_time=0.40399 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 9.33173 (QuantReg: 12.51890) QuantErr: 12.51890 batch_time=0.40307 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 8.59698 (QuantReg: 12.57460) QuantErr: 12.57460 batch_time=0.41331 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 10.82995 (QuantReg: 12.47791) QuantErr: 12.47791 batch_time=0.99852 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 8.20480 (QuantReg: 12.61105) QuantErr: 12.61105 batch_time=0.78007 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 9.97898 (QuantReg: 12.44987) QuantErr: 12.44987 batch_time=0.45077 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 7.87685 (QuantReg: 12.55578) QuantErr: 12.55578 batch_time=0.43478 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 7.89972 (QuantReg: 12.54563) QuantErr: 12.54563 batch_time=0.43596 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 10.01037 (QuantReg: 12.62530) QuantErr: 12.62530 batch_time=0.39852 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 10.66777 (QuantReg: 12.92181) QuantErr: 12.92181 batch_time=0.40923 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 7.72540 (QuantReg: 12.63610) QuantErr: 12.63610 batch_time=0.40170 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 10.28205 (QuantReg: 12.85514) QuantErr: 12.85514 batch_time=0.45522 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 7.70463 (QuantReg: 12.80066) QuantErr: 12.80066 batch_time=0.42655 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 9.54371 (QuantReg: 12.73184) QuantErr: 12.73184 batch_time=0.69486 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 8.19999 (QuantReg: 12.79913) QuantErr: 12.79913 batch_time=0.40853 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 9.93723 (QuantReg: 12.62382) QuantErr: 12.62382 batch_time=0.40824 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 10.96578 (QuantReg: 12.53464) QuantErr: 12.53464 batch_time=0.60116 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 9.12285 (QuantReg: 12.89525) QuantErr: 12.89525 batch_time=0.41689 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 7.94098 (QuantReg: 12.66081) QuantErr: 12.66081 batch_time=0.39972 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 8.80719 (QuantReg: 12.62621) QuantErr: 12.62621 batch_time=0.40710 
Train Epoch: 7 codebook_update_time=0.91262
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch7.pth ...
Done in 4.234s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 8.956707876205444
 quant_reg      : 12.660375679016113
 quant_err      : 12.660375679016113
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_miech_test/t2v_metrics/R1: 16.3
 MSRVTT_miech_test/t2v_metrics/R5: 45.8
 MSRVTT_miech_test/t2v_metrics/R10: 60.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.048
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.55356800666467
 MSRVTT_miech_test/v2t_metrics/R1: 16.6
 MSRVTT_miech_test/v2t_metrics/R5: 44.0
 MSRVTT_miech_test/v2t_metrics/R10: 57.7
 MSRVTT_miech_test/v2t_metrics/R50: 87.3
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.319
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.79996917247456
 mnt_best       : 36.15141983229556
 not_improved_count: 1
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 6.65203 (QuantReg: 12.46207) QuantErr: 12.46207 batch_time=28.12031 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 9.81330 (QuantReg: 12.20310) QuantErr: 12.20310 batch_time=0.41679 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 10.12443 (QuantReg: 12.55367) QuantErr: 12.55367 batch_time=0.41540 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 9.18053 (QuantReg: 12.40817) QuantErr: 12.40817 batch_time=0.40388 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 6.70315 (QuantReg: 12.31123) QuantErr: 12.31123 batch_time=0.41786 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 7.93377 (QuantReg: 12.27259) QuantErr: 12.27259 batch_time=0.39521 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 8.00126 (QuantReg: 12.86382) QuantErr: 12.86382 batch_time=0.83393 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 6.71762 (QuantReg: 12.74016) QuantErr: 12.74016 batch_time=0.51903 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 10.68524 (QuantReg: 12.78587) QuantErr: 12.78587 batch_time=0.41855 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 7.53831 (QuantReg: 13.17018) QuantErr: 13.17018 batch_time=0.41026 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 6.95960 (QuantReg: 12.98180) QuantErr: 12.98180 batch_time=0.40590 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 9.16403 (QuantReg: 12.69377) QuantErr: 12.69377 batch_time=0.48114 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 7.24525 (QuantReg: 12.62866) QuantErr: 12.62866 batch_time=0.40809 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 8.76202 (QuantReg: 12.85789) QuantErr: 12.85789 batch_time=0.41639 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 7.98667 (QuantReg: 12.89361) QuantErr: 12.89361 batch_time=0.75396 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 8.70905 (QuantReg: 12.65417) QuantErr: 12.65417 batch_time=0.41457 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 8.78420 (QuantReg: 12.78840) QuantErr: 12.78840 batch_time=0.41090 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 8.89784 (QuantReg: 12.54161) QuantErr: 12.54161 batch_time=0.40563 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 8.17531 (QuantReg: 12.65753) QuantErr: 12.65753 batch_time=0.39730 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 7.53056 (QuantReg: 13.06651) QuantErr: 13.06651 batch_time=0.38769 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 8.42067 (QuantReg: 12.56428) QuantErr: 12.56428 batch_time=0.38251 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 7.33879 (QuantReg: 12.76834) QuantErr: 12.76834 batch_time=0.42769 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 8.43994 (QuantReg: 12.85346) QuantErr: 12.85346 batch_time=0.43601 
Train Epoch: 8 codebook_update_time=0.45313
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch8.pth ...
Done in 4.255s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch8.pth ...
Done in 8.424s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 8.422050859451295
 quant_reg      : 12.713641845703124
 quant_err      : 12.713641845703124
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_miech_test/t2v_metrics/R1: 18.5
 MSRVTT_miech_test/t2v_metrics/R5: 45.5
 MSRVTT_miech_test/t2v_metrics/R10: 60.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.225
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.10712199470364
 MSRVTT_miech_test/v2t_metrics/R1: 17.4
 MSRVTT_miech_test/v2t_metrics/R5: 44.9
 MSRVTT_miech_test/v2t_metrics/R10: 59.9
 MSRVTT_miech_test/v2t_metrics/R50: 87.3
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 30.2915
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.03635062865264
 mnt_best       : 37.10712199470364
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 8.56584 (QuantReg: 12.48657) QuantErr: 12.48657 batch_time=38.46723 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 9.30808 (QuantReg: 12.53826) QuantErr: 12.53826 batch_time=0.40223 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 7.39184 (QuantReg: 12.51006) QuantErr: 12.51006 batch_time=0.41824 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 7.19528 (QuantReg: 12.45648) QuantErr: 12.45648 batch_time=0.41869 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 9.24959 (QuantReg: 12.48414) QuantErr: 12.48414 batch_time=0.40002 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 8.08729 (QuantReg: 12.59617) QuantErr: 12.59617 batch_time=0.39750 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 7.20712 (QuantReg: 12.52551) QuantErr: 12.52551 batch_time=0.41238 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 8.66221 (QuantReg: 12.37391) QuantErr: 12.37391 batch_time=0.41642 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 7.12511 (QuantReg: 12.70565) QuantErr: 12.70565 batch_time=0.41190 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 8.45540 (QuantReg: 12.59986) QuantErr: 12.59986 batch_time=0.40235 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 8.19538 (QuantReg: 12.56106) QuantErr: 12.56106 batch_time=0.41796 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 8.23368 (QuantReg: 12.99952) QuantErr: 12.99952 batch_time=0.44500 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 7.26841 (QuantReg: 13.02078) QuantErr: 13.02078 batch_time=0.39759 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 8.05673 (QuantReg: 12.84521) QuantErr: 12.84521 batch_time=0.40992 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 8.96795 (QuantReg: 12.74822) QuantErr: 12.74822 batch_time=0.40429 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 8.63573 (QuantReg: 12.81245) QuantErr: 12.81245 batch_time=0.39419 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 8.53051 (QuantReg: 12.67827) QuantErr: 12.67827 batch_time=0.39760 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 8.82734 (QuantReg: 12.81610) QuantErr: 12.81610 batch_time=0.40215 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 8.11588 (QuantReg: 12.66601) QuantErr: 12.66601 batch_time=2.23313 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 7.61860 (QuantReg: 12.91309) QuantErr: 12.91309 batch_time=0.39401 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 6.25941 (QuantReg: 12.79525) QuantErr: 12.79525 batch_time=0.40640 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 8.40029 (QuantReg: 12.81400) QuantErr: 12.81400 batch_time=0.42754 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 8.16442 (QuantReg: 13.00103) QuantErr: 13.00103 batch_time=0.40893 
Train Epoch: 9 codebook_update_time=0.55804
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch9.pth ...
Done in 10.272s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch9.pth ...
Done in 14.642s
removing stale ckpt [epoch 8] [took 0.01s]
 epoch          : 9
 loss           : 8.124150358200072
 quant_reg      : 12.717600269317627
 quant_err      : 12.717600269317627
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_miech_test/t2v_metrics/R1: 18.3
 MSRVTT_miech_test/t2v_metrics/R5: 47.3
 MSRVTT_miech_test/t2v_metrics/R10: 61.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.185
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.51578357805454
 MSRVTT_miech_test/v2t_metrics/R1: 17.6
 MSRVTT_miech_test/v2t_metrics/R5: 47.8
 MSRVTT_miech_test/v2t_metrics/R10: 61.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.9405
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.282677329868164
 mnt_best       : 37.51578357805454
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 9.77574 (QuantReg: 12.59635) QuantErr: 12.59635 batch_time=29.31958 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 7.05274 (QuantReg: 12.72404) QuantErr: 12.72404 batch_time=1.09064 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 8.81480 (QuantReg: 12.89752) QuantErr: 12.89752 batch_time=0.43278 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 7.53244 (QuantReg: 12.69039) QuantErr: 12.69039 batch_time=0.40120 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 7.83185 (QuantReg: 12.43798) QuantErr: 12.43798 batch_time=0.43124 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 8.32508 (QuantReg: 12.10097) QuantErr: 12.10097 batch_time=0.39249 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 6.99112 (QuantReg: 12.71524) QuantErr: 12.71524 batch_time=0.41188 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 6.55364 (QuantReg: 12.86478) QuantErr: 12.86478 batch_time=0.40948 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 7.96481 (QuantReg: 12.89153) QuantErr: 12.89153 batch_time=0.41279 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 9.24498 (QuantReg: 12.61623) QuantErr: 12.61623 batch_time=0.43308 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 8.04574 (QuantReg: 13.02652) QuantErr: 13.02652 batch_time=0.45071 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 7.07183 (QuantReg: 12.92027) QuantErr: 12.92027 batch_time=0.39429 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 7.45740 (QuantReg: 13.16500) QuantErr: 13.16500 batch_time=0.38863 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 7.41579 (QuantReg: 13.01050) QuantErr: 13.01050 batch_time=0.39714 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 6.37210 (QuantReg: 12.89501) QuantErr: 12.89501 batch_time=0.45551 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 8.73458 (QuantReg: 13.04216) QuantErr: 13.04216 batch_time=0.41050 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 6.70556 (QuantReg: 13.08480) QuantErr: 13.08480 batch_time=0.39811 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 7.50230 (QuantReg: 12.69728) QuantErr: 12.69728 batch_time=0.38897 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 6.94935 (QuantReg: 12.89904) QuantErr: 12.89904 batch_time=0.41180 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 7.92981 (QuantReg: 12.72688) QuantErr: 12.72688 batch_time=0.42661 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 6.55096 (QuantReg: 12.83976) QuantErr: 12.83976 batch_time=0.41069 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 7.07967 (QuantReg: 12.68853) QuantErr: 12.68853 batch_time=0.45431 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 8.55502 (QuantReg: 12.69946) QuantErr: 12.69946 batch_time=0.39042 
Train Epoch: 10 codebook_update_time=0.41223
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch10.pth ...
Done in 4.279s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch10.pth ...
Done in 8.346s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 7.658029893875122
 quant_reg      : 12.785059501647948
 quant_err      : 12.785059501647948
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_miech_test/t2v_metrics/R1: 19.1
 MSRVTT_miech_test/t2v_metrics/R5: 48.2
 MSRVTT_miech_test/t2v_metrics/R10: 61.7
 MSRVTT_miech_test/t2v_metrics/R50: 88.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.44
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.440455320834644
 MSRVTT_miech_test/v2t_metrics/R1: 18.9
 MSRVTT_miech_test/v2t_metrics/R5: 48.6
 MSRVTT_miech_test/v2t_metrics/R10: 62.9
 MSRVTT_miech_test/v2t_metrics/R50: 87.4
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.8955
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.658907166033856
 mnt_best       : 38.440455320834644
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 6.23221 (QuantReg: 12.61442) QuantErr: 12.61442 batch_time=32.81059 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 7.58251 (QuantReg: 12.66460) QuantErr: 12.66460 batch_time=0.39939 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 6.90701 (QuantReg: 12.56349) QuantErr: 12.56349 batch_time=0.39072 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 6.90905 (QuantReg: 12.56117) QuantErr: 12.56117 batch_time=0.39600 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 9.14611 (QuantReg: 12.80264) QuantErr: 12.80264 batch_time=0.39179 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 6.14836 (QuantReg: 12.72223) QuantErr: 12.72223 batch_time=0.42241 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 6.39867 (QuantReg: 12.68338) QuantErr: 12.68338 batch_time=0.40587 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 7.11485 (QuantReg: 12.63764) QuantErr: 12.63764 batch_time=0.39774 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 9.35700 (QuantReg: 12.60250) QuantErr: 12.60250 batch_time=0.41131 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 5.69620 (QuantReg: 12.94583) QuantErr: 12.94583 batch_time=0.40267 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 7.77412 (QuantReg: 12.83961) QuantErr: 12.83961 batch_time=0.39344 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 7.35857 (QuantReg: 12.88034) QuantErr: 12.88034 batch_time=0.44703 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 7.72105 (QuantReg: 13.05387) QuantErr: 13.05387 batch_time=0.41018 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 7.79140 (QuantReg: 12.73355) QuantErr: 12.73355 batch_time=0.39514 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 9.57001 (QuantReg: 12.32803) QuantErr: 12.32803 batch_time=0.39152 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 6.64657 (QuantReg: 12.87786) QuantErr: 12.87786 batch_time=0.44024 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 7.15321 (QuantReg: 12.88130) QuantErr: 12.88130 batch_time=0.40701 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 7.33599 (QuantReg: 13.03074) QuantErr: 13.03074 batch_time=0.52297 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 7.85314 (QuantReg: 12.78380) QuantErr: 12.78380 batch_time=0.39053 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 7.12506 (QuantReg: 12.83935) QuantErr: 12.83935 batch_time=1.91643 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 7.47674 (QuantReg: 12.82886) QuantErr: 12.82886 batch_time=0.40039 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 7.45290 (QuantReg: 13.10509) QuantErr: 13.10509 batch_time=0.43127 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 6.65638 (QuantReg: 12.80432) QuantErr: 12.80432 batch_time=0.39039 
Train Epoch: 11 codebook_update_time=0.45468
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch11.pth ...
Done in 10.285s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 7.24351321220398
 quant_reg      : 12.79260122680664
 quant_err      : 12.79260122680664
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_miech_test/t2v_metrics/R1: 19.1
 MSRVTT_miech_test/t2v_metrics/R5: 46.8
 MSRVTT_miech_test/t2v_metrics/R10: 61.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.611999999999995
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.002823428254445
 MSRVTT_miech_test/v2t_metrics/R1: 18.2
 MSRVTT_miech_test/v2t_metrics/R5: 49.8
 MSRVTT_miech_test/v2t_metrics/R10: 62.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.4
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.8855
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.302825043226505
 mnt_best       : 38.440455320834644
 not_improved_count: 1
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 7.75213 (QuantReg: 12.61502) QuantErr: 12.61502 batch_time=30.60708 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 8.20796 (QuantReg: 12.68279) QuantErr: 12.68279 batch_time=0.42423 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 5.84435 (QuantReg: 12.82727) QuantErr: 12.82727 batch_time=0.44454 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 6.18951 (QuantReg: 12.71229) QuantErr: 12.71229 batch_time=0.40743 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 8.80280 (QuantReg: 12.53972) QuantErr: 12.53972 batch_time=0.40154 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 5.94572 (QuantReg: 12.55745) QuantErr: 12.55745 batch_time=0.40429 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 5.91257 (QuantReg: 12.58607) QuantErr: 12.58607 batch_time=0.41559 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 5.88237 (QuantReg: 12.69136) QuantErr: 12.69136 batch_time=0.42107 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 7.34632 (QuantReg: 12.68067) QuantErr: 12.68067 batch_time=0.64523 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 7.54191 (QuantReg: 12.36799) QuantErr: 12.36799 batch_time=0.41005 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 7.11271 (QuantReg: 12.99376) QuantErr: 12.99376 batch_time=0.41359 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 7.16062 (QuantReg: 12.79232) QuantErr: 12.79232 batch_time=0.43434 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 7.16783 (QuantReg: 12.53685) QuantErr: 12.53685 batch_time=0.75416 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 6.24167 (QuantReg: 12.86598) QuantErr: 12.86598 batch_time=1.33247 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 6.92331 (QuantReg: 12.70955) QuantErr: 12.70955 batch_time=0.40606 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 7.04610 (QuantReg: 12.66991) QuantErr: 12.66991 batch_time=0.42504 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 6.74936 (QuantReg: 12.82487) QuantErr: 12.82487 batch_time=0.39874 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 5.42318 (QuantReg: 12.77000) QuantErr: 12.77000 batch_time=0.40295 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 7.94761 (QuantReg: 12.62410) QuantErr: 12.62410 batch_time=0.39217 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 6.65994 (QuantReg: 13.23767) QuantErr: 13.23767 batch_time=0.39735 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 6.32958 (QuantReg: 12.92194) QuantErr: 12.92194 batch_time=0.43300 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 6.87943 (QuantReg: 12.69862) QuantErr: 12.69862 batch_time=0.40065 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 6.70328 (QuantReg: 13.28727) QuantErr: 13.28727 batch_time=0.40312 
Train Epoch: 12 codebook_update_time=0.41613
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch12.pth ...
Done in 4.606s
removing stale ckpt [epoch 11] [took 0.09s]
 epoch          : 12
 loss           : 6.955071601867676
 quant_reg      : 12.803211044311523
 quant_err      : 12.803211044311523
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_miech_test/t2v_metrics/R1: 17.4
 MSRVTT_miech_test/t2v_metrics/R5: 46.9
 MSRVTT_miech_test/t2v_metrics/R10: 62.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.8
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.119
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.98604781959713
 MSRVTT_miech_test/v2t_metrics/R1: 18.8
 MSRVTT_miech_test/v2t_metrics/R5: 48.3
 MSRVTT_miech_test/v2t_metrics/R10: 62.5
 MSRVTT_miech_test/v2t_metrics/R50: 87.6
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.006
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.42922850636274
 mnt_best       : 38.440455320834644
 not_improved_count: 2
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 8.00680 (QuantReg: 12.80807) QuantErr: 12.80807 batch_time=29.63714 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 5.57565 (QuantReg: 12.72810) QuantErr: 12.72810 batch_time=0.42994 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 6.25076 (QuantReg: 12.74004) QuantErr: 12.74004 batch_time=0.39934 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 5.66475 (QuantReg: 12.55607) QuantErr: 12.55607 batch_time=0.40650 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 6.74009 (QuantReg: 12.65884) QuantErr: 12.65884 batch_time=0.39109 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 6.30482 (QuantReg: 12.21008) QuantErr: 12.21008 batch_time=0.39635 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 7.31389 (QuantReg: 12.91507) QuantErr: 12.91507 batch_time=0.46677 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 7.65376 (QuantReg: 12.69604) QuantErr: 12.69604 batch_time=0.41878 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 6.15424 (QuantReg: 12.80378) QuantErr: 12.80378 batch_time=0.41608 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 6.82071 (QuantReg: 12.55470) QuantErr: 12.55470 batch_time=0.39755 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 6.96746 (QuantReg: 12.70672) QuantErr: 12.70672 batch_time=0.41262 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 5.06358 (QuantReg: 13.05586) QuantErr: 13.05586 batch_time=0.41813 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 7.00041 (QuantReg: 12.94532) QuantErr: 12.94532 batch_time=0.40258 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 5.96446 (QuantReg: 12.82892) QuantErr: 12.82892 batch_time=1.34051 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 6.71627 (QuantReg: 12.66548) QuantErr: 12.66548 batch_time=0.40702 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 6.84561 (QuantReg: 12.49758) QuantErr: 12.49758 batch_time=0.63679 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 6.67455 (QuantReg: 13.05005) QuantErr: 13.05005 batch_time=0.41469 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 8.62417 (QuantReg: 13.05444) QuantErr: 13.05444 batch_time=0.39564 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 5.98583 (QuantReg: 13.07187) QuantErr: 13.07187 batch_time=0.40672 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 6.78169 (QuantReg: 12.66926) QuantErr: 12.66926 batch_time=0.39221 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 8.03541 (QuantReg: 12.98759) QuantErr: 12.98759 batch_time=0.40551 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 5.90882 (QuantReg: 13.04812) QuantErr: 13.04812 batch_time=0.50978 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 5.04740 (QuantReg: 13.17775) QuantErr: 13.17775 batch_time=0.38767 
Train Epoch: 13 codebook_update_time=0.39790
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch13.pth ...
Done in 6.009s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch13.pth ...
Done in 11.933s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 6.671078981399536
 quant_reg      : 12.813359668731689
 quant_err      : 12.813359668731689
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_miech_test/t2v_metrics/R1: 18.8
 MSRVTT_miech_test/t2v_metrics/R5: 47.9
 MSRVTT_miech_test/t2v_metrics/R10: 63.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.504
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.48566757229646
 MSRVTT_miech_test/v2t_metrics/R1: 19.0
 MSRVTT_miech_test/v2t_metrics/R5: 48.8
 MSRVTT_miech_test/v2t_metrics/R10: 63.2
 MSRVTT_miech_test/v2t_metrics/R50: 87.7
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.6155
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.84157516106784
 mnt_best       : 38.48566757229646
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 5.41910 (QuantReg: 12.67362) QuantErr: 12.67362 batch_time=29.65757 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 7.13767 (QuantReg: 12.54029) QuantErr: 12.54029 batch_time=0.43383 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 6.84805 (QuantReg: 12.80293) QuantErr: 12.80293 batch_time=0.42103 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 6.74500 (QuantReg: 12.61579) QuantErr: 12.61579 batch_time=0.40263 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 5.72762 (QuantReg: 12.73575) QuantErr: 12.73575 batch_time=0.38626 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 7.36359 (QuantReg: 12.96107) QuantErr: 12.96107 batch_time=0.39522 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 5.76429 (QuantReg: 13.03094) QuantErr: 13.03094 batch_time=0.44351 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 6.42421 (QuantReg: 12.66327) QuantErr: 12.66327 batch_time=0.44949 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 5.32382 (QuantReg: 12.97871) QuantErr: 12.97871 batch_time=0.42270 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 7.20532 (QuantReg: 13.15831) QuantErr: 13.15831 batch_time=0.43766 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 7.31882 (QuantReg: 12.64476) QuantErr: 12.64476 batch_time=0.42362 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 5.98668 (QuantReg: 12.69309) QuantErr: 12.69309 batch_time=0.41047 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 6.63371 (QuantReg: 12.77687) QuantErr: 12.77687 batch_time=0.42699 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 6.44503 (QuantReg: 12.99499) QuantErr: 12.99499 batch_time=2.65594 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 7.53452 (QuantReg: 12.92243) QuantErr: 12.92243 batch_time=0.39758 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 7.25048 (QuantReg: 12.83589) QuantErr: 12.83589 batch_time=0.64730 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 6.21372 (QuantReg: 12.94087) QuantErr: 12.94087 batch_time=0.38872 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 6.41736 (QuantReg: 13.09699) QuantErr: 13.09699 batch_time=0.44119 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 7.11315 (QuantReg: 12.76127) QuantErr: 12.76127 batch_time=0.40662 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 7.58450 (QuantReg: 12.72734) QuantErr: 12.72734 batch_time=0.40177 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 5.29212 (QuantReg: 12.79992) QuantErr: 12.79992 batch_time=0.38673 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 6.23398 (QuantReg: 13.12774) QuantErr: 13.12774 batch_time=0.39227 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 6.42232 (QuantReg: 13.00933) QuantErr: 13.00933 batch_time=0.39544 
Train Epoch: 14 codebook_update_time=0.41635
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch14.pth ...
Done in 5.400s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch14.pth ...
Done in 12.225s
removing stale ckpt [epoch 13] [took 0.03s]
 epoch          : 14
 loss           : 6.566139265060425
 quant_reg      : 12.852768199920654
 quant_err      : 12.852768199920654
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.2
 MSRVTT_miech_test/t2v_metrics/R10: 62.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.544
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.40306262535618
 MSRVTT_miech_test/v2t_metrics/R1: 19.0
 MSRVTT_miech_test/v2t_metrics/R5: 47.2
 MSRVTT_miech_test/v2t_metrics/R10: 61.2
 MSRVTT_miech_test/v2t_metrics/R50: 89.1
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.049
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.00280681021812
 mnt_best       : 39.40306262535618
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 7.26442 (QuantReg: 12.83354) QuantErr: 12.83354 batch_time=32.48766 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 5.56310 (QuantReg: 12.72239) QuantErr: 12.72239 batch_time=0.42200 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 4.99273 (QuantReg: 12.90024) QuantErr: 12.90024 batch_time=0.40383 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 6.98096 (QuantReg: 12.83415) QuantErr: 12.83415 batch_time=0.40525 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 6.16877 (QuantReg: 12.97118) QuantErr: 12.97118 batch_time=1.36293 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 5.20367 (QuantReg: 13.01758) QuantErr: 13.01758 batch_time=0.40008 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 5.00353 (QuantReg: 12.97217) QuantErr: 12.97217 batch_time=0.40124 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 7.01937 (QuantReg: 13.19083) QuantErr: 13.19083 batch_time=0.45082 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 7.76471 (QuantReg: 13.05806) QuantErr: 13.05806 batch_time=0.43499 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 7.43489 (QuantReg: 12.63867) QuantErr: 12.63867 batch_time=0.43037 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 6.43687 (QuantReg: 12.78239) QuantErr: 12.78239 batch_time=1.11554 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 6.56765 (QuantReg: 12.67868) QuantErr: 12.67868 batch_time=0.40326 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 4.91045 (QuantReg: 12.74588) QuantErr: 12.74588 batch_time=0.52260 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 6.99497 (QuantReg: 12.97610) QuantErr: 12.97610 batch_time=0.65661 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 6.46512 (QuantReg: 13.10224) QuantErr: 13.10224 batch_time=0.41632 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 5.81718 (QuantReg: 12.58477) QuantErr: 12.58477 batch_time=0.97406 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 6.18705 (QuantReg: 12.74498) QuantErr: 12.74498 batch_time=0.42091 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 5.40671 (QuantReg: 12.94444) QuantErr: 12.94444 batch_time=0.40312 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 6.29244 (QuantReg: 13.01442) QuantErr: 13.01442 batch_time=0.78304 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 4.40582 (QuantReg: 12.91537) QuantErr: 12.91537 batch_time=0.45780 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 6.07645 (QuantReg: 13.33785) QuantErr: 13.33785 batch_time=0.40464 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 6.64074 (QuantReg: 12.96900) QuantErr: 12.96900 batch_time=0.40889 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 4.94245 (QuantReg: 13.29122) QuantErr: 13.29122 batch_time=0.40759 
Train Epoch: 15 codebook_update_time=0.71749
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch15.pth ...
Done in 5.972s
removing stale ckpt [epoch 14] [took 0.17s]
 epoch          : 15
 loss           : 6.290655345916748
 quant_reg      : 12.87828086090088
 quant_err      : 12.87828086090088
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_miech_test/t2v_metrics/R1: 18.4
 MSRVTT_miech_test/t2v_metrics/R5: 47.1
 MSRVTT_miech_test/t2v_metrics/R10: 61.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.221
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.65359792356258
 MSRVTT_miech_test/v2t_metrics/R1: 18.1
 MSRVTT_miech_test/v2t_metrics/R5: 48.6
 MSRVTT_miech_test/v2t_metrics/R10: 63.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.098
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.14591773013611
 mnt_best       : 39.40306262535618
 not_improved_count: 1
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 6.33853 (QuantReg: 12.70792) QuantErr: 12.70792 batch_time=31.87988 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 5.65800 (QuantReg: 13.02724) QuantErr: 13.02724 batch_time=0.47382 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 6.88049 (QuantReg: 13.23194) QuantErr: 13.23194 batch_time=0.40267 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 5.98066 (QuantReg: 12.69251) QuantErr: 12.69251 batch_time=0.40961 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 5.43647 (QuantReg: 12.83436) QuantErr: 12.83436 batch_time=0.39488 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 6.08065 (QuantReg: 12.73471) QuantErr: 12.73471 batch_time=0.40821 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 6.34881 (QuantReg: 12.63976) QuantErr: 12.63976 batch_time=0.49925 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 6.47927 (QuantReg: 12.81815) QuantErr: 12.81815 batch_time=2.33310 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 6.14685 (QuantReg: 12.75630) QuantErr: 12.75630 batch_time=0.56125 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 6.30007 (QuantReg: 12.79685) QuantErr: 12.79685 batch_time=0.42571 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 7.33561 (QuantReg: 12.96419) QuantErr: 12.96419 batch_time=0.40702 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 5.31677 (QuantReg: 12.81240) QuantErr: 12.81240 batch_time=0.42244 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 5.64969 (QuantReg: 12.92088) QuantErr: 12.92088 batch_time=0.40372 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 6.79121 (QuantReg: 13.01323) QuantErr: 13.01323 batch_time=0.39178 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 6.24947 (QuantReg: 12.89592) QuantErr: 12.89592 batch_time=0.43565 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 7.11370 (QuantReg: 12.70207) QuantErr: 12.70207 batch_time=0.40888 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 5.97202 (QuantReg: 13.40416) QuantErr: 13.40416 batch_time=0.40699 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 5.92865 (QuantReg: 12.67877) QuantErr: 12.67877 batch_time=0.39190 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 5.64436 (QuantReg: 13.19504) QuantErr: 13.19504 batch_time=0.83662 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 7.89751 (QuantReg: 12.79161) QuantErr: 12.79161 batch_time=0.42641 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 5.24595 (QuantReg: 13.26579) QuantErr: 13.26579 batch_time=0.39905 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 7.56623 (QuantReg: 12.78615) QuantErr: 12.78615 batch_time=0.46260 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 7.04414 (QuantReg: 13.00375) QuantErr: 13.00375 batch_time=0.41870 
Train Epoch: 16 codebook_update_time=0.42614
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch16.pth ...
Done in 6.355s
removing stale ckpt [epoch 15] [took 0.21s]
 epoch          : 16
 loss           : 6.066251697540284
 quant_reg      : 12.886809631347656
 quant_err      : 12.886809631347656
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_miech_test/t2v_metrics/R1: 18.7
 MSRVTT_miech_test/t2v_metrics/R5: 48.0
 MSRVTT_miech_test/t2v_metrics/R10: 62.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.318
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.26095546752782
 MSRVTT_miech_test/v2t_metrics/R1: 19.7
 MSRVTT_miech_test/v2t_metrics/R5: 49.7
 MSRVTT_miech_test/v2t_metrics/R10: 64.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.264
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.7605650489785
 mnt_best       : 39.40306262535618
 not_improved_count: 2
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 6.41848 (QuantReg: 12.70818) QuantErr: 12.70818 batch_time=29.49727 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 4.71250 (QuantReg: 12.34892) QuantErr: 12.34892 batch_time=0.41902 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 5.98146 (QuantReg: 12.81002) QuantErr: 12.81002 batch_time=1.36175 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 5.41272 (QuantReg: 12.84713) QuantErr: 12.84713 batch_time=0.41938 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 6.72270 (QuantReg: 12.97453) QuantErr: 12.97453 batch_time=0.40778 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 5.88318 (QuantReg: 12.63791) QuantErr: 12.63791 batch_time=0.41159 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 6.16361 (QuantReg: 12.71667) QuantErr: 12.71667 batch_time=0.39841 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 6.20574 (QuantReg: 12.80159) QuantErr: 12.80159 batch_time=0.40027 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 5.39356 (QuantReg: 12.89148) QuantErr: 12.89148 batch_time=0.38926 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 6.94352 (QuantReg: 13.11692) QuantErr: 13.11692 batch_time=0.40930 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 5.83023 (QuantReg: 13.15109) QuantErr: 13.15109 batch_time=0.64665 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 7.26527 (QuantReg: 12.91320) QuantErr: 12.91320 batch_time=0.40650 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 6.20982 (QuantReg: 12.65449) QuantErr: 12.65449 batch_time=0.40503 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 6.41471 (QuantReg: 13.17655) QuantErr: 13.17655 batch_time=3.25359 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 5.29851 (QuantReg: 12.83221) QuantErr: 12.83221 batch_time=0.40402 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 4.79710 (QuantReg: 13.01221) QuantErr: 13.01221 batch_time=0.40836 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 7.99269 (QuantReg: 12.87910) QuantErr: 12.87910 batch_time=0.42090 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 5.81677 (QuantReg: 12.89763) QuantErr: 12.89763 batch_time=0.39773 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 5.19057 (QuantReg: 12.91610) QuantErr: 12.91610 batch_time=0.43355 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 5.85785 (QuantReg: 12.87201) QuantErr: 12.87201 batch_time=0.40351 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 5.13454 (QuantReg: 13.17515) QuantErr: 13.17515 batch_time=0.39497 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 5.76191 (QuantReg: 13.08790) QuantErr: 13.08790 batch_time=0.40346 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 5.58505 (QuantReg: 12.92857) QuantErr: 12.92857 batch_time=0.40955 
Train Epoch: 17 codebook_update_time=0.42518
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch17.pth ...
Done in 4.887s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 5.982693190574646
 quant_reg      : 12.919715057373047
 quant_err      : 12.919715057373047
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_miech_test/t2v_metrics/R1: 19.0
 MSRVTT_miech_test/t2v_metrics/R5: 48.7
 MSRVTT_miech_test/t2v_metrics/R10: 61.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.406
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.5262743009434
 MSRVTT_miech_test/v2t_metrics/R1: 18.1
 MSRVTT_miech_test/v2t_metrics/R5: 48.8
 MSRVTT_miech_test/v2t_metrics/R10: 62.5
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.798
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.07671482911124
 mnt_best       : 39.40306262535618
 not_improved_count: 3
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 5.08833 (QuantReg: 12.76469) QuantErr: 12.76469 batch_time=28.54726 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 7.39691 (QuantReg: 12.77684) QuantErr: 12.77684 batch_time=0.61032 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 5.08876 (QuantReg: 12.97323) QuantErr: 12.97323 batch_time=0.43953 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 6.71364 (QuantReg: 12.84135) QuantErr: 12.84135 batch_time=0.39174 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 5.44767 (QuantReg: 12.62852) QuantErr: 12.62852 batch_time=0.40091 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 5.16510 (QuantReg: 12.98937) QuantErr: 12.98937 batch_time=0.39299 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 4.60040 (QuantReg: 12.86418) QuantErr: 12.86418 batch_time=0.65962 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 5.04828 (QuantReg: 13.12074) QuantErr: 13.12074 batch_time=0.38955 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 5.12724 (QuantReg: 12.87836) QuantErr: 12.87836 batch_time=0.38896 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 4.42504 (QuantReg: 12.99546) QuantErr: 12.99546 batch_time=0.42833 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 4.74619 (QuantReg: 12.99942) QuantErr: 12.99942 batch_time=0.51962 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 5.15679 (QuantReg: 12.70933) QuantErr: 12.70933 batch_time=0.39434 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 6.41009 (QuantReg: 12.89111) QuantErr: 12.89111 batch_time=1.06730 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 5.79261 (QuantReg: 13.09463) QuantErr: 13.09463 batch_time=0.43344 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 5.29962 (QuantReg: 12.84764) QuantErr: 12.84764 batch_time=0.43905 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 6.60105 (QuantReg: 13.01006) QuantErr: 13.01006 batch_time=0.38883 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 5.86927 (QuantReg: 13.06829) QuantErr: 13.06829 batch_time=0.42604 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 4.72113 (QuantReg: 13.06340) QuantErr: 13.06340 batch_time=0.39801 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 6.78396 (QuantReg: 12.96646) QuantErr: 12.96646 batch_time=0.61112 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 5.94886 (QuantReg: 12.83607) QuantErr: 12.83607 batch_time=1.82138 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 5.61599 (QuantReg: 12.54996) QuantErr: 12.54996 batch_time=0.39917 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 6.37433 (QuantReg: 13.06063) QuantErr: 13.06063 batch_time=1.35946 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 5.55333 (QuantReg: 13.14573) QuantErr: 13.14573 batch_time=0.40863 
Train Epoch: 18 codebook_update_time=0.41727
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch18.pth ...
Done in 5.320s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch18.pth ...
Done in 10.805s
removing stale ckpt [epoch 17] [took 0.03s]
 epoch          : 18
 loss           : 5.6984017162323
 quant_reg      : 12.956782176971435
 quant_err      : 12.956782176971435
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 48.5
 MSRVTT_miech_test/t2v_metrics/R10: 62.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.441
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.69467535133183
 MSRVTT_miech_test/v2t_metrics/R1: 17.6
 MSRVTT_miech_test/v2t_metrics/R5: 48.6
 MSRVTT_miech_test/v2t_metrics/R10: 64.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.895
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.14736498745409
 mnt_best       : 39.69467535133183
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 5.71018 (QuantReg: 13.04189) QuantErr: 13.04189 batch_time=31.84001 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 6.15522 (QuantReg: 12.68980) QuantErr: 12.68980 batch_time=0.40641 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 4.84386 (QuantReg: 12.76982) QuantErr: 12.76982 batch_time=0.41954 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 4.92876 (QuantReg: 12.89660) QuantErr: 12.89660 batch_time=0.40764 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 5.97753 (QuantReg: 13.02699) QuantErr: 13.02699 batch_time=0.40396 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 4.99155 (QuantReg: 12.85651) QuantErr: 12.85651 batch_time=0.39580 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 5.59758 (QuantReg: 12.57250) QuantErr: 12.57250 batch_time=0.41831 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 4.57738 (QuantReg: 13.16577) QuantErr: 13.16577 batch_time=0.41309 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 5.65703 (QuantReg: 12.86194) QuantErr: 12.86194 batch_time=0.42306 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 5.64090 (QuantReg: 12.97902) QuantErr: 12.97902 batch_time=0.41092 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 4.59775 (QuantReg: 13.08072) QuantErr: 13.08072 batch_time=0.45826 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 5.87112 (QuantReg: 13.29820) QuantErr: 13.29820 batch_time=0.41345 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 4.57489 (QuantReg: 12.97093) QuantErr: 12.97093 batch_time=0.42171 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 6.24869 (QuantReg: 13.00240) QuantErr: 13.00240 batch_time=0.40892 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 5.47125 (QuantReg: 12.90109) QuantErr: 12.90109 batch_time=0.41945 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 5.96234 (QuantReg: 12.97747) QuantErr: 12.97747 batch_time=0.42349 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 5.53093 (QuantReg: 13.05242) QuantErr: 13.05242 batch_time=0.42661 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 6.37512 (QuantReg: 13.24596) QuantErr: 13.24596 batch_time=0.55126 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 5.41521 (QuantReg: 13.11623) QuantErr: 13.11623 batch_time=0.51051 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 5.98955 (QuantReg: 13.17638) QuantErr: 13.17638 batch_time=0.39130 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 5.82096 (QuantReg: 13.22832) QuantErr: 13.22832 batch_time=0.59223 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 3.82603 (QuantReg: 13.21289) QuantErr: 13.21289 batch_time=0.41802 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 6.34380 (QuantReg: 12.75702) QuantErr: 12.75702 batch_time=0.40883 
Train Epoch: 19 codebook_update_time=0.48118
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch19.pth ...
Done in 5.025s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 5.612300939559937
 quant_reg      : 12.973538921356202
 quant_err      : 12.973538921356202
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_miech_test/t2v_metrics/R1: 19.4
 MSRVTT_miech_test/t2v_metrics/R5: 47.6
 MSRVTT_miech_test/t2v_metrics/R10: 62.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.295
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.665859806125354
 MSRVTT_miech_test/v2t_metrics/R1: 18.6
 MSRVTT_miech_test/v2t_metrics/R5: 50.1
 MSRVTT_miech_test/v2t_metrics/R10: 63.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.4625
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.865453520338555
 mnt_best       : 39.69467535133183
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 6.10153 (QuantReg: 12.97269) QuantErr: 12.97269 batch_time=26.19334 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 4.84735 (QuantReg: 12.83481) QuantErr: 12.83481 batch_time=0.39340 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 6.25455 (QuantReg: 12.96876) QuantErr: 12.96876 batch_time=0.40454 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 5.25319 (QuantReg: 12.72319) QuantErr: 12.72319 batch_time=1.52385 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 6.22570 (QuantReg: 13.15492) QuantErr: 13.15492 batch_time=0.53028 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 5.02964 (QuantReg: 12.99464) QuantErr: 12.99464 batch_time=0.41680 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 5.79148 (QuantReg: 12.77738) QuantErr: 12.77738 batch_time=0.42291 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 5.23761 (QuantReg: 12.98088) QuantErr: 12.98088 batch_time=0.47192 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 5.88570 (QuantReg: 12.93855) QuantErr: 12.93855 batch_time=0.39449 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 5.16640 (QuantReg: 12.99427) QuantErr: 12.99427 batch_time=0.45414 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 6.78376 (QuantReg: 12.75667) QuantErr: 12.75667 batch_time=0.40026 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 5.52179 (QuantReg: 13.16889) QuantErr: 13.16889 batch_time=0.44797 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 4.86273 (QuantReg: 12.64594) QuantErr: 12.64594 batch_time=0.40420 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 5.67115 (QuantReg: 12.74623) QuantErr: 12.74623 batch_time=0.63135 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 5.64109 (QuantReg: 13.08333) QuantErr: 13.08333 batch_time=0.39733 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 6.83686 (QuantReg: 13.15940) QuantErr: 13.15940 batch_time=0.41268 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 5.20462 (QuantReg: 12.97002) QuantErr: 12.97002 batch_time=0.40165 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 5.29700 (QuantReg: 13.20962) QuantErr: 13.20962 batch_time=0.41866 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 5.22070 (QuantReg: 13.13232) QuantErr: 13.13232 batch_time=0.71634 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 4.76277 (QuantReg: 12.45275) QuantErr: 12.45275 batch_time=1.22728 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 5.16460 (QuantReg: 13.14593) QuantErr: 13.14593 batch_time=0.41296 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 5.45533 (QuantReg: 12.84956) QuantErr: 12.84956 batch_time=0.39110 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 4.40003 (QuantReg: 13.04646) QuantErr: 13.04646 batch_time=0.40808 
Train Epoch: 20 codebook_update_time=0.46537
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch20.pth ...
Done in 4.489s
removing stale ckpt [epoch 19] [took 0.17s]
 epoch          : 20
 loss           : 5.511977603912354
 quant_reg      : 12.946163703918456
 quant_err      : 12.946163703918456
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_miech_test/t2v_metrics/R1: 20.0
 MSRVTT_miech_test/t2v_metrics/R5: 49.0
 MSRVTT_miech_test/t2v_metrics/R10: 62.4
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.82
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.39764129935735
 MSRVTT_miech_test/v2t_metrics/R1: 19.9
 MSRVTT_miech_test/v2t_metrics/R5: 49.9
 MSRVTT_miech_test/v2t_metrics/R10: 64.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.773
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.98954810251718
 mnt_best       : 39.69467535133183
 not_improved_count: 2
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 4.64937 (QuantReg: 13.05703) QuantErr: 13.05703 batch_time=26.11109 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 5.15818 (QuantReg: 13.10061) QuantErr: 13.10061 batch_time=0.40397 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 6.00999 (QuantReg: 12.97197) QuantErr: 12.97197 batch_time=3.51378 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 6.09013 (QuantReg: 12.91571) QuantErr: 12.91571 batch_time=0.43825 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 4.02082 (QuantReg: 13.18008) QuantErr: 13.18008 batch_time=0.42761 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 6.90196 (QuantReg: 12.81127) QuantErr: 12.81127 batch_time=0.40888 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 6.01757 (QuantReg: 13.17271) QuantErr: 13.17271 batch_time=0.39004 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 5.31848 (QuantReg: 12.89894) QuantErr: 12.89894 batch_time=0.73041 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 5.18118 (QuantReg: 13.21310) QuantErr: 13.21310 batch_time=0.43713 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 6.14689 (QuantReg: 12.64361) QuantErr: 12.64361 batch_time=0.39842 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 5.62285 (QuantReg: 12.96326) QuantErr: 12.96326 batch_time=0.40527 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 5.98302 (QuantReg: 13.04550) QuantErr: 13.04550 batch_time=0.41305 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 5.55045 (QuantReg: 12.65685) QuantErr: 12.65685 batch_time=0.45911 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 5.05084 (QuantReg: 13.16004) QuantErr: 13.16004 batch_time=1.78427 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 5.35703 (QuantReg: 12.75064) QuantErr: 12.75064 batch_time=0.40858 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 4.89243 (QuantReg: 13.36801) QuantErr: 13.36801 batch_time=0.73835 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 5.66525 (QuantReg: 12.97900) QuantErr: 12.97900 batch_time=0.40740 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 5.46226 (QuantReg: 12.90234) QuantErr: 12.90234 batch_time=0.40444 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 5.41021 (QuantReg: 12.74278) QuantErr: 12.74278 batch_time=0.40198 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 5.33522 (QuantReg: 12.85826) QuantErr: 12.85826 batch_time=1.00422 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 5.15015 (QuantReg: 13.25961) QuantErr: 13.25961 batch_time=0.39528 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 5.37904 (QuantReg: 13.30476) QuantErr: 13.30476 batch_time=0.44094 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 4.93193 (QuantReg: 13.20541) QuantErr: 13.20541 batch_time=0.53347 
Train Epoch: 21 codebook_update_time=0.45083
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch21.pth ...
Done in 4.975s
removing stale ckpt [epoch 20] [took 0.06s]
 epoch          : 21
 loss           : 5.463531361579895
 quant_reg      : 12.984489143371581
 quant_err      : 12.984489143371581
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_miech_test/t2v_metrics/R1: 20.5
 MSRVTT_miech_test/t2v_metrics/R5: 49.0
 MSRVTT_miech_test/t2v_metrics/R10: 62.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.943
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.63819564035375
 MSRVTT_miech_test/v2t_metrics/R1: 18.7
 MSRVTT_miech_test/v2t_metrics/R5: 51.7
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.881
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.919584692795716
 mnt_best       : 39.69467535133183
 not_improved_count: 3
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 5.39917 (QuantReg: 13.03321) QuantErr: 13.03321 batch_time=35.12253 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 4.00923 (QuantReg: 13.05163) QuantErr: 13.05163 batch_time=0.42747 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 5.79708 (QuantReg: 12.98668) QuantErr: 12.98668 batch_time=0.41098 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 4.57378 (QuantReg: 12.90928) QuantErr: 12.90928 batch_time=0.41602 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 6.18109 (QuantReg: 12.58460) QuantErr: 12.58460 batch_time=0.53360 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 5.57296 (QuantReg: 12.82664) QuantErr: 12.82664 batch_time=0.74367 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 4.76555 (QuantReg: 12.96983) QuantErr: 12.96983 batch_time=0.45569 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 5.74951 (QuantReg: 13.17472) QuantErr: 13.17472 batch_time=0.41041 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 5.23325 (QuantReg: 12.85533) QuantErr: 12.85533 batch_time=0.46246 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 4.99929 (QuantReg: 13.13901) QuantErr: 13.13901 batch_time=0.50994 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 5.92424 (QuantReg: 12.91001) QuantErr: 12.91001 batch_time=0.43786 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 5.57877 (QuantReg: 12.61344) QuantErr: 12.61344 batch_time=0.42832 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 4.96939 (QuantReg: 13.13263) QuantErr: 13.13263 batch_time=0.41657 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 6.01002 (QuantReg: 13.02431) QuantErr: 13.02431 batch_time=0.40321 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 4.57799 (QuantReg: 12.86812) QuantErr: 12.86812 batch_time=0.45133 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 4.65911 (QuantReg: 13.14938) QuantErr: 13.14938 batch_time=0.40028 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 5.56871 (QuantReg: 13.13096) QuantErr: 13.13096 batch_time=0.40807 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 5.61568 (QuantReg: 13.15415) QuantErr: 13.15415 batch_time=0.53542 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 5.68206 (QuantReg: 12.99807) QuantErr: 12.99807 batch_time=0.46405 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 5.77422 (QuantReg: 12.79296) QuantErr: 12.79296 batch_time=0.45106 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 4.49970 (QuantReg: 13.31076) QuantErr: 13.31076 batch_time=0.42756 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 5.50314 (QuantReg: 12.78446) QuantErr: 12.78446 batch_time=0.41048 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 6.52283 (QuantReg: 12.78852) QuantErr: 12.78852 batch_time=0.40522 
Train Epoch: 22 codebook_update_time=0.50436
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch22.pth ...
Done in 5.160s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch22.pth ...
Done in 10.344s
removing stale ckpt [epoch 21] [took 0.01s]
 epoch          : 22
 loss           : 5.247749302864075
 quant_reg      : 12.997889423370362
 quant_err      : 12.997889423370362
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 48.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.117
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.03021883147327
 MSRVTT_miech_test/v2t_metrics/R1: 18.6
 MSRVTT_miech_test/v2t_metrics/R5: 50.1
 MSRVTT_miech_test/v2t_metrics/R10: 64.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.9725
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.151239177269325
 mnt_best       : 40.03021883147327
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 4.10406 (QuantReg: 13.01345) QuantErr: 13.01345 batch_time=34.32298 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 4.22976 (QuantReg: 13.15070) QuantErr: 13.15070 batch_time=0.38966 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 4.88024 (QuantReg: 13.20142) QuantErr: 13.20142 batch_time=0.39929 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 4.48233 (QuantReg: 13.29200) QuantErr: 13.29200 batch_time=0.39831 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 5.54546 (QuantReg: 12.91674) QuantErr: 12.91674 batch_time=0.39610 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 6.19067 (QuantReg: 12.96729) QuantErr: 12.96729 batch_time=0.39273 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 5.59805 (QuantReg: 12.85328) QuantErr: 12.85328 batch_time=0.40655 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 5.47073 (QuantReg: 12.68627) QuantErr: 12.68627 batch_time=0.41587 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 4.33821 (QuantReg: 12.99487) QuantErr: 12.99487 batch_time=0.40464 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 5.08303 (QuantReg: 12.70003) QuantErr: 12.70003 batch_time=1.70533 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 4.89670 (QuantReg: 13.41296) QuantErr: 13.41296 batch_time=0.39674 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 5.06781 (QuantReg: 12.68139) QuantErr: 12.68139 batch_time=0.39891 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 5.51766 (QuantReg: 12.93613) QuantErr: 12.93613 batch_time=0.39982 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 5.87154 (QuantReg: 13.27688) QuantErr: 13.27688 batch_time=0.40483 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 5.03623 (QuantReg: 13.25331) QuantErr: 13.25331 batch_time=0.43132 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 4.40865 (QuantReg: 12.93093) QuantErr: 12.93093 batch_time=0.39869 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 6.04993 (QuantReg: 12.78000) QuantErr: 12.78000 batch_time=0.40753 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 4.63803 (QuantReg: 12.76828) QuantErr: 12.76828 batch_time=0.63377 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 4.57643 (QuantReg: 13.20372) QuantErr: 13.20372 batch_time=0.40133 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 3.67134 (QuantReg: 13.10705) QuantErr: 13.10705 batch_time=0.42295 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 4.49363 (QuantReg: 12.61373) QuantErr: 12.61373 batch_time=0.39452 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 5.35095 (QuantReg: 13.19278) QuantErr: 13.19278 batch_time=0.39746 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 5.37771 (QuantReg: 12.89152) QuantErr: 12.89152 batch_time=0.40462 
Train Epoch: 23 codebook_update_time=0.42951
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch23.pth ...
Done in 5.574s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch23.pth ...
Done in 11.236s
removing stale ckpt [epoch 22] [took 1.16s]
 epoch          : 23
 loss           : 5.121314811706543
 quant_reg      : 12.998294124603271
 quant_err      : 12.998294124603271
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.788
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.49934053694275
 MSRVTT_miech_test/v2t_metrics/R1: 19.7
 MSRVTT_miech_test/v2t_metrics/R5: 50.1
 MSRVTT_miech_test/v2t_metrics/R10: 66.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.25
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.332
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.3980254238667
 mnt_best       : 40.49934053694275
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 3.74298 (QuantReg: 12.69793) QuantErr: 12.69793 batch_time=36.48965 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 4.66154 (QuantReg: 13.14445) QuantErr: 13.14445 batch_time=0.38977 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 5.45809 (QuantReg: 12.91905) QuantErr: 12.91905 batch_time=1.73256 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 5.53745 (QuantReg: 12.76844) QuantErr: 12.76844 batch_time=0.40308 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 5.08907 (QuantReg: 12.82118) QuantErr: 12.82118 batch_time=0.40359 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 4.80213 (QuantReg: 12.85355) QuantErr: 12.85355 batch_time=0.42995 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 3.81052 (QuantReg: 12.99037) QuantErr: 12.99037 batch_time=0.40266 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 5.97129 (QuantReg: 12.81871) QuantErr: 12.81871 batch_time=0.52659 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 5.38054 (QuantReg: 12.78588) QuantErr: 12.78588 batch_time=0.39410 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 4.86531 (QuantReg: 12.89939) QuantErr: 12.89939 batch_time=0.41293 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 5.31477 (QuantReg: 13.13654) QuantErr: 13.13654 batch_time=0.40351 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 5.04604 (QuantReg: 13.03713) QuantErr: 13.03713 batch_time=0.40543 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 5.25004 (QuantReg: 13.01251) QuantErr: 13.01251 batch_time=0.41514 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 6.04598 (QuantReg: 12.89940) QuantErr: 12.89940 batch_time=0.40208 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 5.02444 (QuantReg: 13.03294) QuantErr: 13.03294 batch_time=0.40113 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 5.69204 (QuantReg: 13.07850) QuantErr: 13.07850 batch_time=0.42762 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 5.42603 (QuantReg: 13.16616) QuantErr: 13.16616 batch_time=0.40146 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 4.60109 (QuantReg: 12.95873) QuantErr: 12.95873 batch_time=0.44118 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 5.40830 (QuantReg: 13.01743) QuantErr: 13.01743 batch_time=0.39640 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 5.56855 (QuantReg: 13.00928) QuantErr: 13.00928 batch_time=0.51372 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 6.56684 (QuantReg: 12.49408) QuantErr: 12.49408 batch_time=0.40751 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 4.69477 (QuantReg: 13.13916) QuantErr: 13.13916 batch_time=0.41055 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 5.99793 (QuantReg: 12.66095) QuantErr: 12.66095 batch_time=0.40070 
Train Epoch: 24 codebook_update_time=0.42556
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch24.pth ...
Done in 5.998s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch24.pth ...
Done in 11.163s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 5.029794919013977
 quant_reg      : 12.991007289886475
 quant_err      : 12.991007289886475
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_miech_test/t2v_metrics/R1: 21.9
 MSRVTT_miech_test/t2v_metrics/R5: 50.6
 MSRVTT_miech_test/t2v_metrics/R10: 63.6
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.556
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.30639075475744
 MSRVTT_miech_test/v2t_metrics/R1: 19.9
 MSRVTT_miech_test/v2t_metrics/R5: 51.4
 MSRVTT_miech_test/v2t_metrics/R10: 65.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.178
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.53209588055734
 mnt_best       : 41.30639075475744
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 6.25418 (QuantReg: 12.74759) QuantErr: 12.74759 batch_time=27.27749 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 6.73908 (QuantReg: 12.84918) QuantErr: 12.84918 batch_time=0.39846 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 4.20866 (QuantReg: 13.17556) QuantErr: 13.17556 batch_time=0.40709 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 5.12840 (QuantReg: 12.85916) QuantErr: 12.85916 batch_time=0.40121 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 4.29748 (QuantReg: 13.06547) QuantErr: 13.06547 batch_time=0.49394 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 7.49687 (QuantReg: 12.84998) QuantErr: 12.84998 batch_time=0.41570 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 5.93626 (QuantReg: 12.67516) QuantErr: 12.67516 batch_time=1.51293 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 6.82407 (QuantReg: 13.22964) QuantErr: 13.22964 batch_time=0.40058 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 5.14143 (QuantReg: 12.80065) QuantErr: 12.80065 batch_time=1.20085 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 4.40262 (QuantReg: 12.99167) QuantErr: 12.99167 batch_time=0.40414 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 6.08381 (QuantReg: 13.04801) QuantErr: 13.04801 batch_time=0.39892 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 3.87444 (QuantReg: 12.99073) QuantErr: 12.99073 batch_time=0.39371 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 3.81455 (QuantReg: 12.95220) QuantErr: 12.95220 batch_time=0.40299 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 4.44906 (QuantReg: 13.13931) QuantErr: 13.13931 batch_time=1.06640 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 4.88790 (QuantReg: 13.25888) QuantErr: 13.25888 batch_time=0.45776 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 5.85505 (QuantReg: 13.00093) QuantErr: 13.00093 batch_time=0.41518 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 5.27636 (QuantReg: 12.96930) QuantErr: 12.96930 batch_time=0.41215 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 4.23924 (QuantReg: 13.24286) QuantErr: 13.24286 batch_time=0.40486 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 6.02828 (QuantReg: 12.95648) QuantErr: 12.95648 batch_time=0.62038 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 4.27272 (QuantReg: 13.00496) QuantErr: 13.00496 batch_time=0.39616 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 4.01433 (QuantReg: 13.30679) QuantErr: 13.30679 batch_time=0.41210 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 3.99216 (QuantReg: 13.29354) QuantErr: 13.29354 batch_time=0.39575 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 5.23281 (QuantReg: 13.24894) QuantErr: 13.24894 batch_time=0.40945 
Train Epoch: 25 codebook_update_time=0.40453
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch25.pth ...
Done in 4.746s
removing stale ckpt [epoch 24] [took 0.02s]
 epoch          : 25
 loss           : 5.088001272201538
 quant_reg      : 12.97470240020752
 quant_err      : 12.97470240020752
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 48.2
 MSRVTT_miech_test/t2v_metrics/R10: 63.9
 MSRVTT_miech_test/t2v_metrics/R50: 88.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.534
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.013242282231914
 MSRVTT_miech_test/v2t_metrics/R1: 20.0
 MSRVTT_miech_test/v2t_metrics/R5: 51.1
 MSRVTT_miech_test/v2t_metrics/R10: 65.9
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.012
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.686041411355234
 mnt_best       : 41.30639075475744
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 5.50833 (QuantReg: 12.69250) QuantErr: 12.69250 batch_time=28.84022 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 3.77935 (QuantReg: 13.16454) QuantErr: 13.16454 batch_time=0.41536 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 5.57719 (QuantReg: 12.86798) QuantErr: 12.86798 batch_time=0.39696 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 5.42100 (QuantReg: 13.12138) QuantErr: 13.12138 batch_time=0.38635 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 5.39951 (QuantReg: 12.92165) QuantErr: 12.92165 batch_time=0.40094 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 5.83905 (QuantReg: 12.73631) QuantErr: 12.73631 batch_time=0.44118 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 4.64494 (QuantReg: 12.86496) QuantErr: 12.86496 batch_time=1.55818 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 3.91125 (QuantReg: 13.15638) QuantErr: 13.15638 batch_time=0.38775 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 4.45999 (QuantReg: 12.84773) QuantErr: 12.84773 batch_time=0.40467 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 4.90337 (QuantReg: 12.97911) QuantErr: 12.97911 batch_time=0.39760 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 4.14506 (QuantReg: 13.19002) QuantErr: 13.19002 batch_time=0.40424 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 4.87601 (QuantReg: 13.12208) QuantErr: 13.12208 batch_time=0.54507 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 5.15308 (QuantReg: 13.28819) QuantErr: 13.28819 batch_time=0.41687 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 4.07749 (QuantReg: 13.05531) QuantErr: 13.05531 batch_time=0.41461 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 4.31956 (QuantReg: 12.97446) QuantErr: 12.97446 batch_time=0.40580 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 3.99555 (QuantReg: 13.12519) QuantErr: 13.12519 batch_time=0.39752 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 5.21646 (QuantReg: 12.98792) QuantErr: 12.98792 batch_time=0.42998 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 5.61760 (QuantReg: 13.00661) QuantErr: 13.00661 batch_time=0.39066 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 5.27232 (QuantReg: 13.01873) QuantErr: 13.01873 batch_time=0.39514 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 4.64069 (QuantReg: 13.23606) QuantErr: 13.23606 batch_time=0.40812 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 4.78378 (QuantReg: 12.76215) QuantErr: 12.76215 batch_time=0.42063 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 4.62728 (QuantReg: 13.32012) QuantErr: 13.32012 batch_time=0.41583 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 6.08829 (QuantReg: 12.89622) QuantErr: 12.89622 batch_time=0.41292 
Train Epoch: 26 codebook_update_time=0.44284
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch26.pth ...
Done in 4.960s
removing stale ckpt [epoch 25] [took 0.31s]
 epoch          : 26
 loss           : 4.991916305541992
 quant_reg      : 13.026632457733154
 quant_err      : 13.026632457733154
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_miech_test/t2v_metrics/R1: 20.3
 MSRVTT_miech_test/t2v_metrics/R5: 49.7
 MSRVTT_miech_test/t2v_metrics/R10: 64.6
 MSRVTT_miech_test/t2v_metrics/R50: 89.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.725
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.24342929918031
 MSRVTT_miech_test/v2t_metrics/R1: 19.9
 MSRVTT_miech_test/v2t_metrics/R5: 50.7
 MSRVTT_miech_test/v2t_metrics/R10: 64.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.6765
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.13959828289225
 mnt_best       : 41.30639075475744
 not_improved_count: 2
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 5.27559 (QuantReg: 13.01135) QuantErr: 13.01135 batch_time=29.98223 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 4.72148 (QuantReg: 13.02662) QuantErr: 13.02662 batch_time=0.62131 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 4.88377 (QuantReg: 13.11805) QuantErr: 13.11805 batch_time=0.48408 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 4.53939 (QuantReg: 13.12859) QuantErr: 13.12859 batch_time=0.39847 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 5.39288 (QuantReg: 12.89500) QuantErr: 12.89500 batch_time=0.39981 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 5.56186 (QuantReg: 12.87185) QuantErr: 12.87185 batch_time=0.40449 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 5.91347 (QuantReg: 13.06452) QuantErr: 13.06452 batch_time=0.41777 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 3.95878 (QuantReg: 13.32435) QuantErr: 13.32435 batch_time=0.40190 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 5.39284 (QuantReg: 13.23939) QuantErr: 13.23939 batch_time=1.01826 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 5.01119 (QuantReg: 13.03959) QuantErr: 13.03959 batch_time=0.40322 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 4.95031 (QuantReg: 12.89629) QuantErr: 12.89629 batch_time=0.43048 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 5.84041 (QuantReg: 12.94254) QuantErr: 12.94254 batch_time=0.39683 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 3.94974 (QuantReg: 13.24453) QuantErr: 13.24453 batch_time=0.91077 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 5.81011 (QuantReg: 13.11032) QuantErr: 13.11032 batch_time=0.73945 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 4.67811 (QuantReg: 13.16691) QuantErr: 13.16691 batch_time=0.64080 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 5.37421 (QuantReg: 13.16628) QuantErr: 13.16628 batch_time=0.41334 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 4.35408 (QuantReg: 13.17283) QuantErr: 13.17283 batch_time=0.40817 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 5.35155 (QuantReg: 13.11915) QuantErr: 13.11915 batch_time=0.84483 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 3.97128 (QuantReg: 13.14247) QuantErr: 13.14247 batch_time=0.77340 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 5.29775 (QuantReg: 12.91600) QuantErr: 12.91600 batch_time=0.53244 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 4.86046 (QuantReg: 13.12586) QuantErr: 13.12586 batch_time=0.52583 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 4.29622 (QuantReg: 13.04274) QuantErr: 13.04274 batch_time=0.39630 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 4.42849 (QuantReg: 13.10195) QuantErr: 13.10195 batch_time=0.39206 
Train Epoch: 27 codebook_update_time=0.43323
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch27.pth ...
Done in 5.901s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 4.88087661075592
 quant_reg      : 13.053385814666749
 quant_err      : 13.053385814666749
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 50.4
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.217
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.61115145804965
 MSRVTT_miech_test/v2t_metrics/R1: 19.1
 MSRVTT_miech_test/v2t_metrics/R5: 50.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.547
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.78743806140998
 mnt_best       : 41.30639075475744
 not_improved_count: 3
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 3.99547 (QuantReg: 12.98924) QuantErr: 12.98924 batch_time=29.94270 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 4.51496 (QuantReg: 12.82126) QuantErr: 12.82126 batch_time=0.57138 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 4.66550 (QuantReg: 13.15612) QuantErr: 13.15612 batch_time=3.13695 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 4.20898 (QuantReg: 13.05314) QuantErr: 13.05314 batch_time=0.40579 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 6.12211 (QuantReg: 12.74191) QuantErr: 12.74191 batch_time=0.42892 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 3.74847 (QuantReg: 13.20076) QuantErr: 13.20076 batch_time=0.41250 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 4.43910 (QuantReg: 12.96270) QuantErr: 12.96270 batch_time=0.61338 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 4.04324 (QuantReg: 13.16396) QuantErr: 13.16396 batch_time=0.41057 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 5.53298 (QuantReg: 12.98131) QuantErr: 12.98131 batch_time=0.40409 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 5.23392 (QuantReg: 12.96133) QuantErr: 12.96133 batch_time=1.22921 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 6.61122 (QuantReg: 12.81100) QuantErr: 12.81100 batch_time=0.44174 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 4.11709 (QuantReg: 13.04770) QuantErr: 13.04770 batch_time=0.40161 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 4.44419 (QuantReg: 13.20450) QuantErr: 13.20450 batch_time=0.40404 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 4.56188 (QuantReg: 13.06313) QuantErr: 13.06313 batch_time=0.64657 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 5.06571 (QuantReg: 13.14442) QuantErr: 13.14442 batch_time=0.73922 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 4.96419 (QuantReg: 13.24766) QuantErr: 13.24766 batch_time=0.40439 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 4.65677 (QuantReg: 12.95273) QuantErr: 12.95273 batch_time=0.41230 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 4.29030 (QuantReg: 13.18710) QuantErr: 13.18710 batch_time=0.41682 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 5.64144 (QuantReg: 12.97132) QuantErr: 12.97132 batch_time=0.42525 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 5.33510 (QuantReg: 12.86940) QuantErr: 12.86940 batch_time=0.45196 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 5.29363 (QuantReg: 12.94177) QuantErr: 12.94177 batch_time=0.57582 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 5.17915 (QuantReg: 12.96561) QuantErr: 12.96561 batch_time=0.41693 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 4.76104 (QuantReg: 13.08813) QuantErr: 13.08813 batch_time=0.43153 
Train Epoch: 28 codebook_update_time=0.40714
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch28.pth ...
Done in 4.539s
removing stale ckpt [epoch 27] [took 0.23s]
 epoch          : 28
 loss           : 4.824672904014587
 quant_reg      : 13.046984123229981
 quant_err      : 13.046984123229981
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_miech_test/t2v_metrics/R1: 21.9
 MSRVTT_miech_test/t2v_metrics/R5: 49.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.487
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.23992481209343
 MSRVTT_miech_test/v2t_metrics/R1: 20.8
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 65.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.1965
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.08072455880857
 mnt_best       : 41.30639075475744
 not_improved_count: 4
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 5.07169 (QuantReg: 13.49929) QuantErr: 13.49929 batch_time=26.83770 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 5.44868 (QuantReg: 13.01754) QuantErr: 13.01754 batch_time=0.40564 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 4.21190 (QuantReg: 13.13403) QuantErr: 13.13403 batch_time=0.45776 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 3.78367 (QuantReg: 13.23156) QuantErr: 13.23156 batch_time=0.39228 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 5.41453 (QuantReg: 12.93833) QuantErr: 12.93833 batch_time=0.39047 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 3.79707 (QuantReg: 12.99488) QuantErr: 12.99488 batch_time=0.39036 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 4.82181 (QuantReg: 12.90258) QuantErr: 12.90258 batch_time=4.40308 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 3.66353 (QuantReg: 13.02072) QuantErr: 13.02072 batch_time=0.42395 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 4.76123 (QuantReg: 13.01043) QuantErr: 13.01043 batch_time=0.52800 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 5.64464 (QuantReg: 13.03180) QuantErr: 13.03180 batch_time=0.38639 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 4.81659 (QuantReg: 13.05750) QuantErr: 13.05750 batch_time=0.56236 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 4.46991 (QuantReg: 13.20893) QuantErr: 13.20893 batch_time=0.42248 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 5.47825 (QuantReg: 13.11567) QuantErr: 13.11567 batch_time=2.10664 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 4.98091 (QuantReg: 12.95004) QuantErr: 12.95004 batch_time=0.40729 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 3.91031 (QuantReg: 12.92332) QuantErr: 12.92332 batch_time=0.39425 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 4.49046 (QuantReg: 13.23018) QuantErr: 13.23018 batch_time=0.42699 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 4.68016 (QuantReg: 13.10212) QuantErr: 13.10212 batch_time=0.42551 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 6.38339 (QuantReg: 12.75045) QuantErr: 12.75045 batch_time=0.38842 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 4.26568 (QuantReg: 13.26418) QuantErr: 13.26418 batch_time=0.69333 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 5.51401 (QuantReg: 13.03457) QuantErr: 13.03457 batch_time=0.39347 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 4.32751 (QuantReg: 13.04346) QuantErr: 13.04346 batch_time=0.39910 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 4.42344 (QuantReg: 12.93672) QuantErr: 12.93672 batch_time=0.39272 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 4.12982 (QuantReg: 13.04735) QuantErr: 13.04735 batch_time=0.40438 
Train Epoch: 29 codebook_update_time=0.41605
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch29.pth ...
Done in 5.097s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch29.pth ...
Done in 9.279s
removing stale ckpt [epoch 28] [took 0.04s]
 epoch          : 29
 loss           : 4.784171940803528
 quant_reg      : 13.09215459060669
 quant_err      : 13.09215459060669
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_miech_test/t2v_metrics/R1: 22.4
 MSRVTT_miech_test/t2v_metrics/R5: 49.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 88.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.578
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.376177103753164
 MSRVTT_miech_test/v2t_metrics/R1: 20.9
 MSRVTT_miech_test/v2t_metrics/R5: 51.8
 MSRVTT_miech_test/v2t_metrics/R10: 65.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.2625
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.30655837627666
 mnt_best       : 41.376177103753164
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 4.60673 (QuantReg: 12.86697) QuantErr: 12.86697 batch_time=33.59394 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 4.25192 (QuantReg: 12.74825) QuantErr: 12.74825 batch_time=0.74831 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 5.11260 (QuantReg: 12.95393) QuantErr: 12.95393 batch_time=0.41297 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 4.90377 (QuantReg: 13.22145) QuantErr: 13.22145 batch_time=0.39908 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 5.16571 (QuantReg: 12.84048) QuantErr: 12.84048 batch_time=0.40793 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 4.87325 (QuantReg: 13.11600) QuantErr: 13.11600 batch_time=0.41691 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 4.33081 (QuantReg: 13.11343) QuantErr: 13.11343 batch_time=0.92251 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 5.88834 (QuantReg: 13.00235) QuantErr: 13.00235 batch_time=0.41628 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 5.86989 (QuantReg: 13.20271) QuantErr: 13.20271 batch_time=0.52479 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 3.56218 (QuantReg: 13.27554) QuantErr: 13.27554 batch_time=0.39925 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 4.71084 (QuantReg: 13.10473) QuantErr: 13.10473 batch_time=0.43602 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 4.14878 (QuantReg: 13.31470) QuantErr: 13.31470 batch_time=0.41068 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 5.11533 (QuantReg: 12.95732) QuantErr: 12.95732 batch_time=0.41205 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 5.46505 (QuantReg: 12.73454) QuantErr: 12.73454 batch_time=1.04987 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 4.96702 (QuantReg: 13.14627) QuantErr: 13.14627 batch_time=1.25777 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 5.37501 (QuantReg: 13.38842) QuantErr: 13.38842 batch_time=0.40597 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 4.02450 (QuantReg: 13.33498) QuantErr: 13.33498 batch_time=0.40715 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 5.00617 (QuantReg: 13.15992) QuantErr: 13.15992 batch_time=0.40683 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 5.61990 (QuantReg: 13.33976) QuantErr: 13.33976 batch_time=0.40890 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 5.56662 (QuantReg: 12.96745) QuantErr: 12.96745 batch_time=0.61727 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 5.16175 (QuantReg: 13.13142) QuantErr: 13.13142 batch_time=0.45822 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 4.80989 (QuantReg: 12.97751) QuantErr: 12.97751 batch_time=0.42560 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 5.08572 (QuantReg: 13.13585) QuantErr: 13.13585 batch_time=0.65189 
Train Epoch: 30 codebook_update_time=0.40339
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch30.pth ...
Done in 8.771s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch30.pth ...
Done in 14.002s
removing stale ckpt [epoch 29] [took 0.04s]
 epoch          : 30
 loss           : 4.732168598175049
 quant_reg      : 13.123262023925781
 quant_err      : 13.123262023925781
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_miech_test/t2v_metrics/R1: 21.9
 MSRVTT_miech_test/t2v_metrics/R5: 52.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.438
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.771090256288474
 MSRVTT_miech_test/v2t_metrics/R1: 20.8
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.9865
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.59895830724887
 mnt_best       : 41.771090256288474
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 5.33233 (QuantReg: 12.90329) QuantErr: 12.90329 batch_time=30.14212 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 5.33406 (QuantReg: 13.06937) QuantErr: 13.06937 batch_time=4.06380 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 4.77120 (QuantReg: 12.71229) QuantErr: 12.71229 batch_time=0.41047 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 5.60495 (QuantReg: 13.17050) QuantErr: 13.17050 batch_time=0.42516 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 4.42393 (QuantReg: 13.33010) QuantErr: 13.33010 batch_time=0.41441 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 5.18111 (QuantReg: 13.19162) QuantErr: 13.19162 batch_time=0.39151 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 3.87194 (QuantReg: 13.09882) QuantErr: 13.09882 batch_time=0.40451 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 5.22013 (QuantReg: 12.83729) QuantErr: 12.83729 batch_time=0.39911 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 6.37658 (QuantReg: 12.92958) QuantErr: 12.92958 batch_time=1.31174 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 4.10853 (QuantReg: 13.04625) QuantErr: 13.04625 batch_time=0.39377 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 3.95844 (QuantReg: 13.36570) QuantErr: 13.36570 batch_time=0.44083 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 4.04340 (QuantReg: 13.16670) QuantErr: 13.16670 batch_time=0.41742 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 3.58100 (QuantReg: 13.34545) QuantErr: 13.34545 batch_time=0.41197 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 4.25944 (QuantReg: 13.22160) QuantErr: 13.22160 batch_time=0.39492 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 4.11252 (QuantReg: 13.55620) QuantErr: 13.55620 batch_time=0.39103 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 5.58844 (QuantReg: 13.07668) QuantErr: 13.07668 batch_time=0.41284 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 4.80236 (QuantReg: 13.17138) QuantErr: 13.17138 batch_time=0.40026 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 5.15846 (QuantReg: 12.73258) QuantErr: 12.73258 batch_time=0.39017 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 3.63945 (QuantReg: 13.23113) QuantErr: 13.23113 batch_time=0.39160 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 4.84037 (QuantReg: 13.11109) QuantErr: 13.11109 batch_time=0.72519 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 4.26486 (QuantReg: 13.20283) QuantErr: 13.20283 batch_time=0.46246 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 4.26011 (QuantReg: 13.11730) QuantErr: 13.11730 batch_time=0.42081 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 4.58382 (QuantReg: 13.44809) QuantErr: 13.44809 batch_time=0.41330 
Train Epoch: 31 codebook_update_time=0.40454
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch31.pth ...
Done in 4.842s
removing stale ckpt [epoch 30] [took 0.09s]
 epoch          : 31
 loss           : 4.659252181053161
 quant_reg      : 13.13880881881714
 quant_err      : 13.13880881881714
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_miech_test/t2v_metrics/R1: 21.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.917
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.15965156261432
 MSRVTT_miech_test/v2t_metrics/R1: 21.1
 MSRVTT_miech_test/v2t_metrics/R5: 52.6
 MSRVTT_miech_test/v2t_metrics/R10: 65.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.765
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.671448652939354
 mnt_best       : 41.771090256288474
 not_improved_count: 1
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 5.46129 (QuantReg: 13.32318) QuantErr: 13.32318 batch_time=39.00353 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 4.19135 (QuantReg: 12.79654) QuantErr: 12.79654 batch_time=0.38827 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 4.82889 (QuantReg: 13.20259) QuantErr: 13.20259 batch_time=2.60436 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 4.34383 (QuantReg: 13.19136) QuantErr: 13.19136 batch_time=0.38265 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 4.92374 (QuantReg: 13.22381) QuantErr: 13.22381 batch_time=0.38781 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 5.65723 (QuantReg: 12.96448) QuantErr: 12.96448 batch_time=0.39660 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 4.17074 (QuantReg: 12.96507) QuantErr: 12.96507 batch_time=0.39392 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 5.26024 (QuantReg: 13.33433) QuantErr: 13.33433 batch_time=0.39152 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 4.78824 (QuantReg: 13.35471) QuantErr: 13.35471 batch_time=0.39886 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 5.24404 (QuantReg: 13.05271) QuantErr: 13.05271 batch_time=0.44345 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 4.56554 (QuantReg: 13.31797) QuantErr: 13.31797 batch_time=0.42448 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 5.67488 (QuantReg: 13.01404) QuantErr: 13.01404 batch_time=0.41188 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 3.44096 (QuantReg: 13.22146) QuantErr: 13.22146 batch_time=0.38588 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 4.07238 (QuantReg: 13.31668) QuantErr: 13.31668 batch_time=0.54383 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 3.91862 (QuantReg: 13.09488) QuantErr: 13.09488 batch_time=0.39485 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 5.20260 (QuantReg: 12.92166) QuantErr: 12.92166 batch_time=0.46360 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 3.49805 (QuantReg: 13.16606) QuantErr: 13.16606 batch_time=0.39390 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 5.07021 (QuantReg: 12.76676) QuantErr: 12.76676 batch_time=0.39409 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 4.83416 (QuantReg: 12.89080) QuantErr: 12.89080 batch_time=0.44422 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 4.49559 (QuantReg: 13.15605) QuantErr: 13.15605 batch_time=0.42869 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 5.30408 (QuantReg: 12.94281) QuantErr: 12.94281 batch_time=0.39883 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 3.54247 (QuantReg: 13.09425) QuantErr: 13.09425 batch_time=0.52083 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 5.16150 (QuantReg: 13.12449) QuantErr: 13.12449 batch_time=0.40940 
Train Epoch: 32 codebook_update_time=0.43231
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch32.pth ...
Done in 4.087s
removing stale ckpt [epoch 31] [took 0.06s]
 epoch          : 32
 loss           : 4.658029825210571
 quant_reg      : 13.131216464996339
 quant_err      : 13.131216464996339
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_miech_test/t2v_metrics/R1: 21.6
 MSRVTT_miech_test/t2v_metrics/R5: 50.9
 MSRVTT_miech_test/t2v_metrics/R10: 65.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.06
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.60424173956753
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 53.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.7
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.624
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.60809522562856
 mnt_best       : 41.771090256288474
 not_improved_count: 2
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 5.28986 (QuantReg: 13.17535) QuantErr: 13.17535 batch_time=32.14824 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 4.95687 (QuantReg: 13.03713) QuantErr: 13.03713 batch_time=0.38870 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 5.06661 (QuantReg: 13.30667) QuantErr: 13.30667 batch_time=0.40059 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 5.33537 (QuantReg: 13.19981) QuantErr: 13.19981 batch_time=0.40362 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 4.77748 (QuantReg: 13.34577) QuantErr: 13.34577 batch_time=0.46251 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 4.20246 (QuantReg: 13.10618) QuantErr: 13.10618 batch_time=0.41121 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 5.01815 (QuantReg: 13.19634) QuantErr: 13.19634 batch_time=0.42619 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 3.92913 (QuantReg: 13.14857) QuantErr: 13.14857 batch_time=2.12243 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 4.36001 (QuantReg: 13.11099) QuantErr: 13.11099 batch_time=0.40109 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 5.38382 (QuantReg: 13.20885) QuantErr: 13.20885 batch_time=0.43179 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 5.01418 (QuantReg: 12.99103) QuantErr: 12.99103 batch_time=0.38794 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 4.21983 (QuantReg: 12.97087) QuantErr: 12.97087 batch_time=0.40598 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 5.04348 (QuantReg: 13.05022) QuantErr: 13.05022 batch_time=3.21249 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 4.20335 (QuantReg: 13.01679) QuantErr: 13.01679 batch_time=0.39355 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 4.33094 (QuantReg: 13.15058) QuantErr: 13.15058 batch_time=0.40146 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 4.89024 (QuantReg: 13.29430) QuantErr: 13.29430 batch_time=0.40951 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 4.69554 (QuantReg: 13.29059) QuantErr: 13.29059 batch_time=0.40806 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 4.56931 (QuantReg: 13.30386) QuantErr: 13.30386 batch_time=0.39994 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 3.47479 (QuantReg: 13.30521) QuantErr: 13.30521 batch_time=0.46565 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 5.02499 (QuantReg: 13.59501) QuantErr: 13.59501 batch_time=0.38928 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 5.02859 (QuantReg: 12.81119) QuantErr: 12.81119 batch_time=1.18445 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 3.70822 (QuantReg: 13.12541) QuantErr: 13.12541 batch_time=0.40342 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 4.43391 (QuantReg: 13.29103) QuantErr: 13.29103 batch_time=0.42260 
Train Epoch: 33 codebook_update_time=0.42933
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch33.pth ...
Done in 5.153s
removing stale ckpt [epoch 32] [took 0.02s]
 epoch          : 33
 loss           : 4.6731466913223265
 quant_reg      : 13.146804080963134
 quant_err      : 13.146804080963134
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_miech_test/t2v_metrics/R1: 21.5
 MSRVTT_miech_test/t2v_metrics/R5: 50.5
 MSRVTT_miech_test/t2v_metrics/R10: 65.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.825
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.32514615561614
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 50.6
 MSRVTT_miech_test/v2t_metrics/R10: 64.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.6025
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.40116243428473
 mnt_best       : 41.771090256288474
 not_improved_count: 3
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 4.78889 (QuantReg: 12.80922) QuantErr: 12.80922 batch_time=30.25116 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 3.80393 (QuantReg: 12.99328) QuantErr: 12.99328 batch_time=0.42011 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 4.92224 (QuantReg: 13.33919) QuantErr: 13.33919 batch_time=0.39996 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 3.81943 (QuantReg: 13.07270) QuantErr: 13.07270 batch_time=0.40433 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 4.84294 (QuantReg: 13.04355) QuantErr: 13.04355 batch_time=1.40526 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 4.94099 (QuantReg: 13.06663) QuantErr: 13.06663 batch_time=0.39246 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 4.94355 (QuantReg: 13.08459) QuantErr: 13.08459 batch_time=0.43476 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 5.52054 (QuantReg: 13.12943) QuantErr: 13.12943 batch_time=0.41333 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 3.97038 (QuantReg: 13.05071) QuantErr: 13.05071 batch_time=0.40452 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 3.90882 (QuantReg: 13.03099) QuantErr: 13.03099 batch_time=0.41077 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 5.67669 (QuantReg: 13.10185) QuantErr: 13.10185 batch_time=0.41174 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 3.75867 (QuantReg: 13.21531) QuantErr: 13.21531 batch_time=0.44667 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 3.86041 (QuantReg: 13.43499) QuantErr: 13.43499 batch_time=2.81725 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 4.28828 (QuantReg: 13.27083) QuantErr: 13.27083 batch_time=0.40409 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 4.09075 (QuantReg: 13.17757) QuantErr: 13.17757 batch_time=0.39648 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 4.35909 (QuantReg: 13.07816) QuantErr: 13.07816 batch_time=0.84430 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 5.41257 (QuantReg: 13.06060) QuantErr: 13.06060 batch_time=0.41162 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 3.94547 (QuantReg: 13.19688) QuantErr: 13.19688 batch_time=0.39954 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 3.63504 (QuantReg: 13.39101) QuantErr: 13.39101 batch_time=0.41364 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 5.55317 (QuantReg: 13.17256) QuantErr: 13.17256 batch_time=0.39548 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 4.62885 (QuantReg: 13.24886) QuantErr: 13.24886 batch_time=0.38789 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 4.84452 (QuantReg: 13.23385) QuantErr: 13.23385 batch_time=0.43924 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 4.49667 (QuantReg: 13.29085) QuantErr: 13.29085 batch_time=0.39157 
Train Epoch: 34 codebook_update_time=0.42672
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch34.pth ...
Done in 4.714s
removing stale ckpt [epoch 33] [took 0.01s]
 epoch          : 34
 loss           : 4.6197893314361576
 quant_reg      : 13.129954956054688
 quant_err      : 13.129954956054688
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 51.0
 MSRVTT_miech_test/t2v_metrics/R10: 65.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.138
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.04503281188095
 MSRVTT_miech_test/v2t_metrics/R1: 21.6
 MSRVTT_miech_test/v2t_metrics/R5: 52.8
 MSRVTT_miech_test/v2t_metrics/R10: 65.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.5965
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.137021877936654
 mnt_best       : 41.771090256288474
 not_improved_count: 4
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 5.45066 (QuantReg: 13.09549) QuantErr: 13.09549 batch_time=29.87415 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 6.04539 (QuantReg: 13.10525) QuantErr: 13.10525 batch_time=0.54138 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 5.58201 (QuantReg: 13.37123) QuantErr: 13.37123 batch_time=0.39561 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 3.60661 (QuantReg: 13.26955) QuantErr: 13.26955 batch_time=0.40827 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 3.48693 (QuantReg: 12.96806) QuantErr: 12.96806 batch_time=0.67611 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 3.89852 (QuantReg: 12.91504) QuantErr: 12.91504 batch_time=0.41812 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 4.70998 (QuantReg: 13.27240) QuantErr: 13.27240 batch_time=0.39635 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 5.13134 (QuantReg: 13.14961) QuantErr: 13.14961 batch_time=0.64059 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 4.52285 (QuantReg: 13.14159) QuantErr: 13.14159 batch_time=0.40323 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 4.97900 (QuantReg: 13.30307) QuantErr: 13.30307 batch_time=0.41674 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 4.92188 (QuantReg: 13.18558) QuantErr: 13.18558 batch_time=0.40180 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 4.34710 (QuantReg: 13.44388) QuantErr: 13.44388 batch_time=0.55148 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 5.73592 (QuantReg: 13.17359) QuantErr: 13.17359 batch_time=0.40396 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 4.85224 (QuantReg: 13.09599) QuantErr: 13.09599 batch_time=0.58052 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 5.15258 (QuantReg: 13.17021) QuantErr: 13.17021 batch_time=0.41298 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 5.16969 (QuantReg: 13.09531) QuantErr: 13.09531 batch_time=0.41897 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 3.95869 (QuantReg: 13.20762) QuantErr: 13.20762 batch_time=0.41787 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 3.94537 (QuantReg: 13.17231) QuantErr: 13.17231 batch_time=0.40165 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 5.39294 (QuantReg: 13.05485) QuantErr: 13.05485 batch_time=0.40097 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 5.16541 (QuantReg: 13.17300) QuantErr: 13.17300 batch_time=0.42855 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 3.74522 (QuantReg: 13.14378) QuantErr: 13.14378 batch_time=0.43871 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 3.91880 (QuantReg: 13.36530) QuantErr: 13.36530 batch_time=0.39904 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 5.54208 (QuantReg: 13.17633) QuantErr: 13.17633 batch_time=0.39867 
Train Epoch: 35 codebook_update_time=0.40889
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch35.pth ...
Done in 6.042s
removing stale ckpt [epoch 34] [took 0.06s]
 epoch          : 35
 loss           : 4.575024792671203
 quant_reg      : 13.146301216125488
 quant_err      : 13.146301216125488
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_miech_test/t2v_metrics/R1: 21.8
 MSRVTT_miech_test/t2v_metrics/R5: 51.2
 MSRVTT_miech_test/t2v_metrics/R10: 65.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.212
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.70741471510455
 MSRVTT_miech_test/v2t_metrics/R1: 21.2
 MSRVTT_miech_test/v2t_metrics/R5: 52.0
 MSRVTT_miech_test/v2t_metrics/R10: 66.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.008
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.87336003082116
 mnt_best       : 41.771090256288474
 not_improved_count: 5
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 4.10296 (QuantReg: 13.12425) QuantErr: 13.12425 batch_time=30.86633 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 4.87091 (QuantReg: 13.14822) QuantErr: 13.14822 batch_time=0.39498 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 4.80654 (QuantReg: 13.11385) QuantErr: 13.11385 batch_time=0.39732 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 3.95837 (QuantReg: 13.19626) QuantErr: 13.19626 batch_time=0.97568 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 4.10245 (QuantReg: 13.41137) QuantErr: 13.41137 batch_time=0.39334 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 5.45156 (QuantReg: 13.12727) QuantErr: 13.12727 batch_time=0.40512 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 4.57197 (QuantReg: 13.08590) QuantErr: 13.08590 batch_time=0.94381 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 4.00917 (QuantReg: 13.16987) QuantErr: 13.16987 batch_time=0.40401 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 5.51260 (QuantReg: 13.19503) QuantErr: 13.19503 batch_time=0.41971 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 3.91822 (QuantReg: 13.30400) QuantErr: 13.30400 batch_time=0.41778 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 3.82072 (QuantReg: 13.16205) QuantErr: 13.16205 batch_time=0.39300 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 3.41872 (QuantReg: 13.25068) QuantErr: 13.25068 batch_time=0.39760 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 4.15687 (QuantReg: 13.05269) QuantErr: 13.05269 batch_time=0.43117 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 4.70253 (QuantReg: 13.04546) QuantErr: 13.04546 batch_time=0.40704 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 4.02777 (QuantReg: 13.24917) QuantErr: 13.24917 batch_time=0.40217 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 5.19954 (QuantReg: 13.19275) QuantErr: 13.19275 batch_time=0.42927 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 4.57734 (QuantReg: 12.94135) QuantErr: 12.94135 batch_time=0.39714 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 3.80127 (QuantReg: 13.13293) QuantErr: 13.13293 batch_time=0.40487 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 3.90074 (QuantReg: 13.33765) QuantErr: 13.33765 batch_time=0.41076 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 4.93486 (QuantReg: 13.37818) QuantErr: 13.37818 batch_time=0.39743 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 3.89104 (QuantReg: 13.21608) QuantErr: 13.21608 batch_time=0.41087 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 4.61793 (QuantReg: 12.97395) QuantErr: 12.97395 batch_time=0.44446 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 4.33738 (QuantReg: 13.37817) QuantErr: 13.37817 batch_time=0.39784 
Train Epoch: 36 codebook_update_time=0.44603
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch36.pth ...
Done in 5.052s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch36.pth ...
Done in 9.948s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 4.402156320571899
 quant_reg      : 13.196857265472412
 quant_err      : 13.196857265472412
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_miech_test/t2v_metrics/R1: 22.6
 MSRVTT_miech_test/t2v_metrics/R5: 51.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.595
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.0263326931196
 MSRVTT_miech_test/v2t_metrics/R1: 20.9
 MSRVTT_miech_test/v2t_metrics/R5: 53.9
 MSRVTT_miech_test/v2t_metrics/R10: 65.4
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.44
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.921575876625326
 mnt_best       : 42.0263326931196
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 4.21181 (QuantReg: 13.16252) QuantErr: 13.16252 batch_time=28.26399 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 3.98395 (QuantReg: 13.30409) QuantErr: 13.30409 batch_time=0.42884 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 4.67058 (QuantReg: 12.95425) QuantErr: 12.95425 batch_time=0.40889 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 4.95729 (QuantReg: 13.00175) QuantErr: 13.00175 batch_time=0.42261 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 5.40373 (QuantReg: 13.43734) QuantErr: 13.43734 batch_time=0.43274 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 4.11339 (QuantReg: 13.17247) QuantErr: 13.17247 batch_time=0.40110 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 4.73527 (QuantReg: 12.70580) QuantErr: 12.70580 batch_time=2.03797 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 3.97990 (QuantReg: 13.12921) QuantErr: 13.12921 batch_time=0.40533 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 4.84285 (QuantReg: 13.20024) QuantErr: 13.20024 batch_time=0.39786 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 4.37880 (QuantReg: 13.18596) QuantErr: 13.18596 batch_time=0.39783 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 4.43991 (QuantReg: 13.13443) QuantErr: 13.13443 batch_time=0.40036 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 3.65342 (QuantReg: 13.37766) QuantErr: 13.37766 batch_time=0.41133 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 4.69601 (QuantReg: 12.97402) QuantErr: 12.97402 batch_time=0.40902 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 4.43413 (QuantReg: 13.02140) QuantErr: 13.02140 batch_time=0.40626 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 5.59189 (QuantReg: 13.19563) QuantErr: 13.19563 batch_time=0.41739 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 3.38021 (QuantReg: 13.43636) QuantErr: 13.43636 batch_time=0.40001 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 4.68946 (QuantReg: 13.07049) QuantErr: 13.07049 batch_time=0.41609 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 3.19473 (QuantReg: 13.23587) QuantErr: 13.23587 batch_time=0.42070 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 3.08704 (QuantReg: 13.09603) QuantErr: 13.09603 batch_time=0.41068 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 4.79852 (QuantReg: 13.01285) QuantErr: 13.01285 batch_time=0.39361 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 4.57574 (QuantReg: 13.41996) QuantErr: 13.41996 batch_time=0.40505 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 4.39374 (QuantReg: 13.25992) QuantErr: 13.25992 batch_time=0.41201 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 4.63346 (QuantReg: 13.40165) QuantErr: 13.40165 batch_time=0.40658 
Train Epoch: 37 codebook_update_time=0.43231
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch37.pth ...
Done in 4.180s
removing stale ckpt [epoch 36] [took 0.01s]
 epoch          : 37
 loss           : 4.5116219882965085
 quant_reg      : 13.172663246154785
 quant_err      : 13.172663246154785
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 51.2
 MSRVTT_miech_test/t2v_metrics/R10: 65.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.632
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.10174847473994
 MSRVTT_miech_test/v2t_metrics/R1: 21.4
 MSRVTT_miech_test/v2t_metrics/R5: 52.7
 MSRVTT_miech_test/v2t_metrics/R10: 65.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.2595
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.98002981067614
 mnt_best       : 42.0263326931196
 not_improved_count: 1
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 5.28408 (QuantReg: 12.98247) QuantErr: 12.98247 batch_time=25.55987 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 4.05321 (QuantReg: 13.25018) QuantErr: 13.25018 batch_time=0.41205 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 4.66785 (QuantReg: 13.22390) QuantErr: 13.22390 batch_time=3.22282 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 4.60056 (QuantReg: 13.13910) QuantErr: 13.13910 batch_time=0.38982 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 4.43570 (QuantReg: 13.32632) QuantErr: 13.32632 batch_time=0.39784 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 5.56304 (QuantReg: 13.40645) QuantErr: 13.40645 batch_time=0.39818 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 4.48051 (QuantReg: 13.15158) QuantErr: 13.15158 batch_time=0.45952 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 3.78863 (QuantReg: 13.27157) QuantErr: 13.27157 batch_time=0.40251 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 4.12647 (QuantReg: 13.43897) QuantErr: 13.43897 batch_time=0.41396 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 4.52715 (QuantReg: 13.09339) QuantErr: 13.09339 batch_time=0.41220 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 3.94158 (QuantReg: 13.11153) QuantErr: 13.11153 batch_time=0.43146 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 6.27878 (QuantReg: 13.25535) QuantErr: 13.25535 batch_time=0.41029 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 4.03521 (QuantReg: 13.30600) QuantErr: 13.30600 batch_time=0.40931 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 5.14208 (QuantReg: 13.03926) QuantErr: 13.03926 batch_time=0.41010 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 3.76643 (QuantReg: 13.15057) QuantErr: 13.15057 batch_time=0.40690 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 5.72600 (QuantReg: 13.41670) QuantErr: 13.41670 batch_time=0.48222 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 3.36336 (QuantReg: 13.31382) QuantErr: 13.31382 batch_time=0.40094 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 4.87047 (QuantReg: 13.29020) QuantErr: 13.29020 batch_time=0.39019 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 3.99931 (QuantReg: 13.41088) QuantErr: 13.41088 batch_time=0.43275 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 3.92974 (QuantReg: 13.31456) QuantErr: 13.31456 batch_time=0.45629 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 3.79939 (QuantReg: 13.52305) QuantErr: 13.52305 batch_time=0.40242 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 4.34897 (QuantReg: 13.10104) QuantErr: 13.10104 batch_time=0.38448 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 3.86587 (QuantReg: 13.51495) QuantErr: 13.51495 batch_time=0.52417 
Train Epoch: 38 codebook_update_time=0.44438
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch38.pth ...
Done in 4.342s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 38
 loss           : 4.474744290351867
 quant_reg      : 13.203362106323242
 quant_err      : 13.203362106323242
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_miech_test/t2v_metrics/R1: 20.5
 MSRVTT_miech_test/t2v_metrics/R5: 50.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.9
 MSRVTT_miech_test/t2v_metrics/R50: 88.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.299
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.653378672393636
 MSRVTT_miech_test/v2t_metrics/R1: 20.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.8
 MSRVTT_miech_test/v2t_metrics/R10: 65.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.059
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.67683040233963
 mnt_best       : 42.0263326931196
 not_improved_count: 2
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 5.86813 (QuantReg: 13.23542) QuantErr: 13.23542 batch_time=26.99132 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 4.65747 (QuantReg: 13.36813) QuantErr: 13.36813 batch_time=1.50907 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 5.02817 (QuantReg: 13.34464) QuantErr: 13.34464 batch_time=0.40447 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 3.99539 (QuantReg: 13.33419) QuantErr: 13.33419 batch_time=0.40404 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 4.07051 (QuantReg: 13.34244) QuantErr: 13.34244 batch_time=0.40195 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 3.78831 (QuantReg: 13.00044) QuantErr: 13.00044 batch_time=0.41116 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 3.92747 (QuantReg: 13.17848) QuantErr: 13.17848 batch_time=0.75177 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 4.12616 (QuantReg: 13.19071) QuantErr: 13.19071 batch_time=0.41464 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 5.02869 (QuantReg: 13.13943) QuantErr: 13.13943 batch_time=0.40172 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 4.74932 (QuantReg: 13.38842) QuantErr: 13.38842 batch_time=0.41746 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 4.27085 (QuantReg: 13.36601) QuantErr: 13.36601 batch_time=0.41553 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 4.55895 (QuantReg: 13.22742) QuantErr: 13.22742 batch_time=0.41393 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 4.44706 (QuantReg: 13.14970) QuantErr: 13.14970 batch_time=0.39326 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 5.41827 (QuantReg: 12.96478) QuantErr: 12.96478 batch_time=0.40004 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 5.14873 (QuantReg: 13.20922) QuantErr: 13.20922 batch_time=0.39317 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 3.67312 (QuantReg: 13.14094) QuantErr: 13.14094 batch_time=0.42801 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 4.69779 (QuantReg: 13.24410) QuantErr: 13.24410 batch_time=0.40454 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 3.50022 (QuantReg: 13.55679) QuantErr: 13.55679 batch_time=0.41743 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 4.77224 (QuantReg: 13.20162) QuantErr: 13.20162 batch_time=0.40781 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 4.89568 (QuantReg: 13.27754) QuantErr: 13.27754 batch_time=0.42897 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 3.80324 (QuantReg: 13.23530) QuantErr: 13.23530 batch_time=0.40089 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 4.34522 (QuantReg: 12.95129) QuantErr: 12.95129 batch_time=0.41330 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 4.71777 (QuantReg: 13.40366) QuantErr: 13.40366 batch_time=0.43434 
Train Epoch: 39 codebook_update_time=0.43310
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch39.pth ...
Done in 4.452s
removing stale ckpt [epoch 38] [took 0.01s]
 epoch          : 39
 loss           : 4.4688799133300785
 quant_reg      : 13.245292137145997
 quant_err      : 13.245292137145997
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_miech_test/t2v_metrics/R1: 21.7
 MSRVTT_miech_test/t2v_metrics/R5: 52.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.977
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.64354414853109
 MSRVTT_miech_test/v2t_metrics/R1: 20.8
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.9295
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.56262669040095
 mnt_best       : 42.0263326931196
 not_improved_count: 3
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 5.14236 (QuantReg: 13.18321) QuantErr: 13.18321 batch_time=30.68292 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 4.92158 (QuantReg: 13.06198) QuantErr: 13.06198 batch_time=0.40926 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 3.92756 (QuantReg: 13.08046) QuantErr: 13.08046 batch_time=0.55712 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 4.50491 (QuantReg: 13.21716) QuantErr: 13.21716 batch_time=0.40405 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 3.79044 (QuantReg: 13.28819) QuantErr: 13.28819 batch_time=0.39478 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 5.19447 (QuantReg: 13.32069) QuantErr: 13.32069 batch_time=0.39409 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 4.47403 (QuantReg: 13.20275) QuantErr: 13.20275 batch_time=0.42664 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 4.50444 (QuantReg: 13.29354) QuantErr: 13.29354 batch_time=0.76266 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 3.95146 (QuantReg: 13.10591) QuantErr: 13.10591 batch_time=0.43011 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 4.02399 (QuantReg: 13.18126) QuantErr: 13.18126 batch_time=0.40589 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 5.47762 (QuantReg: 13.06684) QuantErr: 13.06684 batch_time=0.39640 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 3.83105 (QuantReg: 13.30603) QuantErr: 13.30603 batch_time=0.40534 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 5.00057 (QuantReg: 13.09771) QuantErr: 13.09771 batch_time=0.41110 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 4.43972 (QuantReg: 13.43091) QuantErr: 13.43091 batch_time=0.52485 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 3.83828 (QuantReg: 13.15459) QuantErr: 13.15459 batch_time=0.39882 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 3.90586 (QuantReg: 13.56762) QuantErr: 13.56762 batch_time=1.41788 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 4.90764 (QuantReg: 13.12274) QuantErr: 13.12274 batch_time=0.42211 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 4.68316 (QuantReg: 13.16119) QuantErr: 13.16119 batch_time=0.42368 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 4.35198 (QuantReg: 13.29968) QuantErr: 13.29968 batch_time=0.70839 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 4.50034 (QuantReg: 13.13360) QuantErr: 13.13360 batch_time=0.54248 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 4.73585 (QuantReg: 13.11601) QuantErr: 13.11601 batch_time=0.40790 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 3.99538 (QuantReg: 13.30267) QuantErr: 13.30267 batch_time=0.41741 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 4.09193 (QuantReg: 13.14906) QuantErr: 13.14906 batch_time=0.40681 
Train Epoch: 40 codebook_update_time=0.43101
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch40.pth ...
Done in 3.966s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 4.516195680618286
 quant_reg      : 13.23884732055664
 quant_err      : 13.23884732055664
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_miech_test/t2v_metrics/R1: 21.5
 MSRVTT_miech_test/t2v_metrics/R5: 50.7
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.769
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.166328098169664
 MSRVTT_miech_test/v2t_metrics/R1: 21.2
 MSRVTT_miech_test/v2t_metrics/R5: 51.1
 MSRVTT_miech_test/v2t_metrics/R10: 65.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.7345
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.37882648533829
 mnt_best       : 42.0263326931196
 not_improved_count: 4
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 4.83781 (QuantReg: 13.38316) QuantErr: 13.38316 batch_time=33.05064 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 4.61680 (QuantReg: 13.19593) QuantErr: 13.19593 batch_time=2.01697 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 5.34731 (QuantReg: 13.06842) QuantErr: 13.06842 batch_time=0.39900 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 4.66628 (QuantReg: 13.18397) QuantErr: 13.18397 batch_time=0.40159 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 4.59734 (QuantReg: 13.07361) QuantErr: 13.07361 batch_time=0.42349 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 4.25541 (QuantReg: 13.03830) QuantErr: 13.03830 batch_time=0.40362 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 4.84423 (QuantReg: 13.11247) QuantErr: 13.11247 batch_time=0.39852 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 4.86638 (QuantReg: 12.91515) QuantErr: 12.91515 batch_time=0.43385 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 5.21361 (QuantReg: 13.14609) QuantErr: 13.14609 batch_time=0.41438 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 3.12712 (QuantReg: 13.47506) QuantErr: 13.47506 batch_time=0.42943 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 3.48632 (QuantReg: 13.21815) QuantErr: 13.21815 batch_time=0.40455 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 4.88054 (QuantReg: 13.21754) QuantErr: 13.21754 batch_time=0.41309 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 5.31372 (QuantReg: 13.13374) QuantErr: 13.13374 batch_time=0.40321 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 4.95505 (QuantReg: 13.21550) QuantErr: 13.21550 batch_time=0.69235 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 4.44396 (QuantReg: 13.33117) QuantErr: 13.33117 batch_time=0.39407 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 4.19428 (QuantReg: 13.23077) QuantErr: 13.23077 batch_time=0.43000 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 4.07444 (QuantReg: 13.08805) QuantErr: 13.08805 batch_time=0.40735 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 4.99389 (QuantReg: 13.15341) QuantErr: 13.15341 batch_time=0.40310 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 5.48851 (QuantReg: 13.06709) QuantErr: 13.06709 batch_time=0.40048 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 4.40501 (QuantReg: 13.30505) QuantErr: 13.30505 batch_time=0.39464 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 4.10487 (QuantReg: 12.94526) QuantErr: 12.94526 batch_time=0.40714 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 5.72124 (QuantReg: 13.49424) QuantErr: 13.49424 batch_time=0.42900 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 4.00109 (QuantReg: 13.32199) QuantErr: 13.32199 batch_time=0.40231 
Train Epoch: 41 codebook_update_time=0.39549
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch41.pth ...
Done in 8.325s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 4.441155366897583
 quant_reg      : 13.272099090576171
 quant_err      : 13.272099090576171
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_miech_test/t2v_metrics/R1: 21.2
 MSRVTT_miech_test/t2v_metrics/R5: 51.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.078
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.05461688035542
 MSRVTT_miech_test/v2t_metrics/R1: 22.2
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 66.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.8385
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.49639018936629
 mnt_best       : 42.0263326931196
 not_improved_count: 5
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 4.58058 (QuantReg: 13.11755) QuantErr: 13.11755 batch_time=28.41054 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 3.10497 (QuantReg: 13.30910) QuantErr: 13.30910 batch_time=0.40473 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 4.20473 (QuantReg: 13.16284) QuantErr: 13.16284 batch_time=0.38873 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 4.10969 (QuantReg: 13.49985) QuantErr: 13.49985 batch_time=0.38699 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 4.13196 (QuantReg: 13.41390) QuantErr: 13.41390 batch_time=0.41545 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 4.41186 (QuantReg: 13.45247) QuantErr: 13.45247 batch_time=0.39875 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 4.09049 (QuantReg: 13.16582) QuantErr: 13.16582 batch_time=0.39845 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 4.08675 (QuantReg: 13.47730) QuantErr: 13.47730 batch_time=0.46231 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 4.48081 (QuantReg: 13.39177) QuantErr: 13.39177 batch_time=0.40104 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 4.34934 (QuantReg: 13.21826) QuantErr: 13.21826 batch_time=0.44127 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 3.90250 (QuantReg: 13.40520) QuantErr: 13.40520 batch_time=0.40216 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 4.47067 (QuantReg: 13.49676) QuantErr: 13.49676 batch_time=0.39143 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 4.27417 (QuantReg: 13.32427) QuantErr: 13.32427 batch_time=0.39440 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 4.84542 (QuantReg: 12.99213) QuantErr: 12.99213 batch_time=0.39154 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 4.81892 (QuantReg: 13.31342) QuantErr: 13.31342 batch_time=0.40920 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 5.50266 (QuantReg: 13.25996) QuantErr: 13.25996 batch_time=0.44059 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 5.08156 (QuantReg: 13.27854) QuantErr: 13.27854 batch_time=0.40659 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 4.76121 (QuantReg: 13.27146) QuantErr: 13.27146 batch_time=0.40690 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 5.68049 (QuantReg: 13.09758) QuantErr: 13.09758 batch_time=1.69152 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 4.37619 (QuantReg: 13.30141) QuantErr: 13.30141 batch_time=5.29965 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 4.87808 (QuantReg: 13.51443) QuantErr: 13.51443 batch_time=0.38856 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 4.26805 (QuantReg: 13.35324) QuantErr: 13.35324 batch_time=0.39828 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 3.31862 (QuantReg: 13.29459) QuantErr: 13.29459 batch_time=0.50714 
Train Epoch: 42 codebook_update_time=0.40107
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch42.pth ...
Done in 4.125s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 4.357129783630371
 quant_reg      : 13.270221370697021
 quant_err      : 13.270221370697021
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_miech_test/t2v_metrics/R1: 21.4
 MSRVTT_miech_test/t2v_metrics/R5: 50.7
 MSRVTT_miech_test/t2v_metrics/R10: 65.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.46
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.39995099063022
 MSRVTT_miech_test/v2t_metrics/R1: 22.0
 MSRVTT_miech_test/v2t_metrics/R5: 53.0
 MSRVTT_miech_test/v2t_metrics/R10: 66.3
 MSRVTT_miech_test/v2t_metrics/R50: 87.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.422
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.59945336423039
 mnt_best       : 42.0263326931196
 not_improved_count: 6
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 5.36002 (QuantReg: 13.18301) QuantErr: 13.18301 batch_time=27.76869 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 2.96614 (QuantReg: 13.45969) QuantErr: 13.45969 batch_time=0.70776 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 3.79592 (QuantReg: 13.30604) QuantErr: 13.30604 batch_time=0.38742 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 5.34470 (QuantReg: 13.54416) QuantErr: 13.54416 batch_time=0.97294 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 5.03499 (QuantReg: 13.26906) QuantErr: 13.26906 batch_time=0.39919 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 3.32767 (QuantReg: 13.25374) QuantErr: 13.25374 batch_time=0.40788 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 5.00586 (QuantReg: 13.21540) QuantErr: 13.21540 batch_time=0.39496 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 4.32450 (QuantReg: 13.11316) QuantErr: 13.11316 batch_time=0.38742 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 3.45221 (QuantReg: 13.34988) QuantErr: 13.34988 batch_time=0.39896 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 4.96435 (QuantReg: 13.26775) QuantErr: 13.26775 batch_time=0.40489 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 4.31602 (QuantReg: 13.43727) QuantErr: 13.43727 batch_time=0.39684 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 3.95969 (QuantReg: 13.39828) QuantErr: 13.39828 batch_time=0.40274 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 4.52031 (QuantReg: 13.29574) QuantErr: 13.29574 batch_time=0.39961 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 4.99705 (QuantReg: 13.25325) QuantErr: 13.25325 batch_time=1.14167 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 3.71949 (QuantReg: 13.20356) QuantErr: 13.20356 batch_time=0.40241 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 4.54016 (QuantReg: 13.00557) QuantErr: 13.00557 batch_time=0.41214 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 4.70724 (QuantReg: 13.45306) QuantErr: 13.45306 batch_time=0.38804 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 3.40754 (QuantReg: 13.32441) QuantErr: 13.32441 batch_time=0.41143 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 4.62608 (QuantReg: 13.18437) QuantErr: 13.18437 batch_time=0.39331 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 3.85379 (QuantReg: 13.38561) QuantErr: 13.38561 batch_time=0.38633 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 3.21604 (QuantReg: 13.42716) QuantErr: 13.42716 batch_time=0.40435 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 4.11158 (QuantReg: 12.95331) QuantErr: 12.95331 batch_time=0.39884 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 3.77567 (QuantReg: 13.26129) QuantErr: 13.26129 batch_time=0.38770 
Train Epoch: 43 codebook_update_time=0.42875
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch43.pth ...
Done in 21.504s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 4.420310832977295
 quant_reg      : 13.28742837524414
 quant_err      : 13.28742837524414
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_miech_test/t2v_metrics/R1: 22.0
 MSRVTT_miech_test/t2v_metrics/R5: 50.6
 MSRVTT_miech_test/t2v_metrics/R10: 64.6
 MSRVTT_miech_test/t2v_metrics/R50: 86.7
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.712
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.58485950501459
 MSRVTT_miech_test/v2t_metrics/R1: 22.0
 MSRVTT_miech_test/v2t_metrics/R5: 51.7
 MSRVTT_miech_test/v2t_metrics/R10: 66.7
 MSRVTT_miech_test/v2t_metrics/R50: 87.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.389
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.333062322167486
 mnt_best       : 42.0263326931196
 not_improved_count: 7
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 4.23858 (QuantReg: 13.38550) QuantErr: 13.38550 batch_time=33.36348 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 3.84549 (QuantReg: 13.14741) QuantErr: 13.14741 batch_time=0.41811 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 4.23356 (QuantReg: 13.24980) QuantErr: 13.24980 batch_time=0.40577 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 3.61065 (QuantReg: 13.16667) QuantErr: 13.16667 batch_time=0.52432 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 4.38667 (QuantReg: 13.18940) QuantErr: 13.18940 batch_time=0.40886 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 3.57028 (QuantReg: 13.31688) QuantErr: 13.31688 batch_time=0.40562 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 4.00379 (QuantReg: 13.22995) QuantErr: 13.22995 batch_time=0.44816 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 3.89515 (QuantReg: 13.35640) QuantErr: 13.35640 batch_time=0.41767 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 3.77282 (QuantReg: 13.34840) QuantErr: 13.34840 batch_time=0.41127 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 6.06049 (QuantReg: 13.28891) QuantErr: 13.28891 batch_time=0.41242 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 4.56503 (QuantReg: 13.18148) QuantErr: 13.18148 batch_time=1.48619 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 4.08269 (QuantReg: 13.21058) QuantErr: 13.21058 batch_time=1.20454 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 3.90355 (QuantReg: 13.39429) QuantErr: 13.39429 batch_time=0.40313 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 4.17981 (QuantReg: 13.38519) QuantErr: 13.38519 batch_time=0.40712 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 3.52914 (QuantReg: 13.48948) QuantErr: 13.48948 batch_time=0.41645 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 4.37616 (QuantReg: 13.25305) QuantErr: 13.25305 batch_time=0.43151 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 3.65939 (QuantReg: 13.29035) QuantErr: 13.29035 batch_time=0.95693 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 5.57463 (QuantReg: 13.08792) QuantErr: 13.08792 batch_time=0.40017 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 4.41068 (QuantReg: 13.16076) QuantErr: 13.16076 batch_time=0.40638 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 4.16157 (QuantReg: 13.29754) QuantErr: 13.29754 batch_time=0.43228 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 3.86367 (QuantReg: 13.19041) QuantErr: 13.19041 batch_time=0.39118 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 4.70963 (QuantReg: 13.32673) QuantErr: 13.32673 batch_time=0.40363 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 4.24744 (QuantReg: 13.39495) QuantErr: 13.39495 batch_time=0.39585 
Train Epoch: 44 codebook_update_time=0.45486
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch44.pth ...
Done in 4.617s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch44.pth ...
Done in 9.888s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 4.306729200363159
 quant_reg      : 13.305154708862304
 quant_err      : 13.305154708862304
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_miech_test/t2v_metrics/R1: 22.4
 MSRVTT_miech_test/t2v_metrics/R5: 51.7
 MSRVTT_miech_test/t2v_metrics/R10: 64.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.787
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.02736840547397
 MSRVTT_miech_test/v2t_metrics/R1: 21.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.4875
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.315188281889945
 mnt_best       : 42.02736840547397
 not_improved_count: 0
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 4.25037 (QuantReg: 13.36901) QuantErr: 13.36901 batch_time=32.11530 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 4.96388 (QuantReg: 13.20618) QuantErr: 13.20618 batch_time=0.43739 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 5.39169 (QuantReg: 13.34880) QuantErr: 13.34880 batch_time=0.39435 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 5.47571 (QuantReg: 13.32995) QuantErr: 13.32995 batch_time=0.39866 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 3.87572 (QuantReg: 13.37837) QuantErr: 13.37837 batch_time=0.43545 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 2.79416 (QuantReg: 13.16455) QuantErr: 13.16455 batch_time=0.39972 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 4.65960 (QuantReg: 13.19552) QuantErr: 13.19552 batch_time=0.43033 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 4.80423 (QuantReg: 13.33254) QuantErr: 13.33254 batch_time=0.40218 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 4.44696 (QuantReg: 13.18748) QuantErr: 13.18748 batch_time=0.41367 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 4.47025 (QuantReg: 13.17913) QuantErr: 13.17913 batch_time=0.40364 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 5.71059 (QuantReg: 13.02561) QuantErr: 13.02561 batch_time=0.39389 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 6.45426 (QuantReg: 13.46510) QuantErr: 13.46510 batch_time=0.41222 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 3.68543 (QuantReg: 13.19979) QuantErr: 13.19979 batch_time=0.39859 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 4.94788 (QuantReg: 13.39572) QuantErr: 13.39572 batch_time=0.43386 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 5.93927 (QuantReg: 13.09315) QuantErr: 13.09315 batch_time=0.38722 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 4.00089 (QuantReg: 13.38224) QuantErr: 13.38224 batch_time=0.43133 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 3.89988 (QuantReg: 13.26636) QuantErr: 13.26636 batch_time=0.42068 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 4.07583 (QuantReg: 13.54472) QuantErr: 13.54472 batch_time=0.46480 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 5.19058 (QuantReg: 13.28023) QuantErr: 13.28023 batch_time=0.88824 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 4.14867 (QuantReg: 13.34452) QuantErr: 13.34452 batch_time=0.44536 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 4.94286 (QuantReg: 13.42412) QuantErr: 13.42412 batch_time=0.43498 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 3.38835 (QuantReg: 13.23469) QuantErr: 13.23469 batch_time=0.40983 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 4.61679 (QuantReg: 13.42360) QuantErr: 13.42360 batch_time=0.52188 
Train Epoch: 45 codebook_update_time=0.42345
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch45.pth ...
Done in 4.867s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 4.408290259361267
 quant_reg      : 13.29127006149292
 quant_err      : 13.29127006149292
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 51.2
 MSRVTT_miech_test/t2v_metrics/R10: 63.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.953
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.78410248256598
 MSRVTT_miech_test/v2t_metrics/R1: 21.7
 MSRVTT_miech_test/v2t_metrics/R5: 52.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.2
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.77
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.16926927195621
 mnt_best       : 42.02736840547397
 not_improved_count: 1
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 5.42892 (QuantReg: 13.25055) QuantErr: 13.25055 batch_time=27.14821 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 3.94469 (QuantReg: 13.29168) QuantErr: 13.29168 batch_time=0.41981 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 3.64975 (QuantReg: 13.42999) QuantErr: 13.42999 batch_time=0.40288 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 5.09511 (QuantReg: 13.44988) QuantErr: 13.44988 batch_time=0.42348 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 4.26503 (QuantReg: 13.34101) QuantErr: 13.34101 batch_time=0.90974 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 4.81485 (QuantReg: 13.63833) QuantErr: 13.63833 batch_time=0.41833 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 3.65687 (QuantReg: 13.35855) QuantErr: 13.35855 batch_time=0.39128 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 4.52360 (QuantReg: 13.08718) QuantErr: 13.08718 batch_time=0.39870 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 3.52292 (QuantReg: 13.55087) QuantErr: 13.55087 batch_time=0.39704 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 4.36429 (QuantReg: 13.26816) QuantErr: 13.26816 batch_time=0.42288 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 4.48625 (QuantReg: 13.17559) QuantErr: 13.17559 batch_time=0.44990 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 4.20835 (QuantReg: 13.32139) QuantErr: 13.32139 batch_time=0.39233 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 4.45893 (QuantReg: 13.37609) QuantErr: 13.37609 batch_time=0.40554 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 5.19364 (QuantReg: 13.35923) QuantErr: 13.35923 batch_time=0.77319 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 3.96639 (QuantReg: 13.23256) QuantErr: 13.23256 batch_time=1.52474 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 4.45456 (QuantReg: 13.19538) QuantErr: 13.19538 batch_time=0.40812 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 4.11385 (QuantReg: 13.17825) QuantErr: 13.17825 batch_time=0.40284 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 4.55399 (QuantReg: 13.37755) QuantErr: 13.37755 batch_time=1.05913 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 3.85876 (QuantReg: 13.48959) QuantErr: 13.48959 batch_time=0.66460 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 3.73546 (QuantReg: 13.20321) QuantErr: 13.20321 batch_time=0.45647 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 4.36692 (QuantReg: 13.42973) QuantErr: 13.42973 batch_time=0.45641 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 3.36007 (QuantReg: 13.56798) QuantErr: 13.56798 batch_time=0.40302 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 4.28805 (QuantReg: 13.19436) QuantErr: 13.19436 batch_time=0.65998 
Train Epoch: 46 codebook_update_time=0.42664
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch46.pth ...
Done in 4.021s
removing stale ckpt [epoch 45] [took 0.03s]
 epoch          : 46
 loss           : 4.340537762641906
 quant_reg      : 13.316118194580078
 quant_err      : 13.316118194580078
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_miech_test/t2v_metrics/R1: 21.2
 MSRVTT_miech_test/t2v_metrics/R5: 50.9
 MSRVTT_miech_test/t2v_metrics/R10: 65.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.638
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.3036984651696
 MSRVTT_miech_test/v2t_metrics/R1: 21.2
 MSRVTT_miech_test/v2t_metrics/R5: 52.7
 MSRVTT_miech_test/v2t_metrics/R10: 66.7
 MSRVTT_miech_test/v2t_metrics/R50: 87.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.656
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.08145718351163
 mnt_best       : 42.02736840547397
 not_improved_count: 2
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 4.58605 (QuantReg: 13.21749) QuantErr: 13.21749 batch_time=34.99833 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 4.04915 (QuantReg: 13.40698) QuantErr: 13.40698 batch_time=0.40037 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 3.80740 (QuantReg: 13.42332) QuantErr: 13.42332 batch_time=0.40389 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 3.89929 (QuantReg: 13.15963) QuantErr: 13.15963 batch_time=0.45216 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 3.43294 (QuantReg: 13.37831) QuantErr: 13.37831 batch_time=0.40344 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 3.92129 (QuantReg: 13.10062) QuantErr: 13.10062 batch_time=0.42858 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 4.02819 (QuantReg: 13.25169) QuantErr: 13.25169 batch_time=0.40587 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 3.48361 (QuantReg: 13.49217) QuantErr: 13.49217 batch_time=0.41732 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 5.20716 (QuantReg: 13.31204) QuantErr: 13.31204 batch_time=0.41851 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 4.67836 (QuantReg: 13.49915) QuantErr: 13.49915 batch_time=0.39199 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 4.24895 (QuantReg: 13.30794) QuantErr: 13.30794 batch_time=0.46028 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 3.52888 (QuantReg: 13.41916) QuantErr: 13.41916 batch_time=0.40065 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 5.70210 (QuantReg: 13.35141) QuantErr: 13.35141 batch_time=0.39592 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 3.66638 (QuantReg: 13.30449) QuantErr: 13.30449 batch_time=0.41717 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 4.38143 (QuantReg: 13.33871) QuantErr: 13.33871 batch_time=0.40552 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 3.93179 (QuantReg: 13.40363) QuantErr: 13.40363 batch_time=0.39985 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 5.01459 (QuantReg: 13.44971) QuantErr: 13.44971 batch_time=0.40454 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 4.67036 (QuantReg: 13.34355) QuantErr: 13.34355 batch_time=0.40976 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 4.33021 (QuantReg: 13.31225) QuantErr: 13.31225 batch_time=0.39831 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 4.37633 (QuantReg: 13.25028) QuantErr: 13.25028 batch_time=0.43865 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 5.28687 (QuantReg: 13.31561) QuantErr: 13.31561 batch_time=0.40102 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 4.73669 (QuantReg: 13.12241) QuantErr: 13.12241 batch_time=0.44060 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 4.59965 (QuantReg: 13.29746) QuantErr: 13.29746 batch_time=0.42133 
Train Epoch: 47 codebook_update_time=0.75108
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch47.pth ...
Done in 4.320s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 4.386008839607239
 quant_reg      : 13.331253776550293
 quant_err      : 13.331253776550293
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_miech_test/t2v_metrics/R1: 22.0
 MSRVTT_miech_test/t2v_metrics/R5: 50.8
 MSRVTT_miech_test/t2v_metrics/R10: 65.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.666
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.78943743858665
 MSRVTT_miech_test/v2t_metrics/R1: 21.2
 MSRVTT_miech_test/v2t_metrics/R5: 53.5
 MSRVTT_miech_test/v2t_metrics/R10: 66.2
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.399
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.18737895895771
 mnt_best       : 42.02736840547397
 not_improved_count: 3
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 3.78003 (QuantReg: 13.28930) QuantErr: 13.28930 batch_time=34.19344 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 3.56708 (QuantReg: 13.40938) QuantErr: 13.40938 batch_time=0.43498 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 4.13350 (QuantReg: 13.22629) QuantErr: 13.22629 batch_time=0.41093 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 4.44879 (QuantReg: 13.37215) QuantErr: 13.37215 batch_time=0.41108 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 3.84210 (QuantReg: 13.48420) QuantErr: 13.48420 batch_time=0.39775 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 4.27921 (QuantReg: 13.35241) QuantErr: 13.35241 batch_time=0.39786 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 4.34283 (QuantReg: 13.32801) QuantErr: 13.32801 batch_time=0.39567 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 5.54314 (QuantReg: 13.33613) QuantErr: 13.33613 batch_time=0.39729 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 3.67518 (QuantReg: 13.40501) QuantErr: 13.40501 batch_time=0.39372 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 3.83656 (QuantReg: 13.51920) QuantErr: 13.51920 batch_time=0.52614 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 4.48726 (QuantReg: 13.53013) QuantErr: 13.53013 batch_time=0.41986 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 4.05469 (QuantReg: 13.42600) QuantErr: 13.42600 batch_time=0.39730 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 4.14558 (QuantReg: 13.27921) QuantErr: 13.27921 batch_time=0.41269 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 4.65531 (QuantReg: 13.25770) QuantErr: 13.25770 batch_time=0.39852 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 4.06628 (QuantReg: 13.32524) QuantErr: 13.32524 batch_time=0.39185 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 4.58648 (QuantReg: 13.37000) QuantErr: 13.37000 batch_time=0.43766 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 4.38565 (QuantReg: 13.35120) QuantErr: 13.35120 batch_time=0.40968 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 5.29536 (QuantReg: 13.53761) QuantErr: 13.53761 batch_time=0.44828 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 4.47496 (QuantReg: 13.38769) QuantErr: 13.38769 batch_time=0.39577 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 4.13275 (QuantReg: 13.13597) QuantErr: 13.13597 batch_time=0.42469 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 4.11957 (QuantReg: 13.46530) QuantErr: 13.46530 batch_time=0.41191 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 3.34202 (QuantReg: 13.62269) QuantErr: 13.62269 batch_time=0.54794 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 4.48251 (QuantReg: 13.41847) QuantErr: 13.41847 batch_time=0.41335 
Train Epoch: 48 codebook_update_time=0.56849
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch48.pth ...
Done in 4.004s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 4.350050281524658
 quant_reg      : 13.357628036499024
 quant_err      : 13.357628036499024
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_miech_test/t2v_metrics/R1: 20.5
 MSRVTT_miech_test/t2v_metrics/R5: 52.2
 MSRVTT_miech_test/t2v_metrics/R10: 63.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.905
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.89231906423901
 MSRVTT_miech_test/v2t_metrics/R1: 22.7
 MSRVTT_miech_test/v2t_metrics/R5: 53.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.454
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.12229400930313
 mnt_best       : 42.02736840547397
 not_improved_count: 4
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 3.84827 (QuantReg: 13.31011) QuantErr: 13.31011 batch_time=31.94785 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 4.42362 (QuantReg: 13.15103) QuantErr: 13.15103 batch_time=0.42250 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 3.96545 (QuantReg: 13.48806) QuantErr: 13.48806 batch_time=0.40087 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 5.60835 (QuantReg: 13.37074) QuantErr: 13.37074 batch_time=0.41340 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 3.52953 (QuantReg: 13.50663) QuantErr: 13.50663 batch_time=0.39338 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 4.64991 (QuantReg: 13.51385) QuantErr: 13.51385 batch_time=0.40079 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 4.85164 (QuantReg: 13.29249) QuantErr: 13.29249 batch_time=1.89707 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 3.86227 (QuantReg: 13.17745) QuantErr: 13.17745 batch_time=1.11767 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 4.80593 (QuantReg: 13.54760) QuantErr: 13.54760 batch_time=0.39932 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 4.18936 (QuantReg: 13.31328) QuantErr: 13.31328 batch_time=0.39703 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 3.23401 (QuantReg: 13.61795) QuantErr: 13.61795 batch_time=0.40011 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 4.34620 (QuantReg: 13.59614) QuantErr: 13.59614 batch_time=0.40373 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 3.30603 (QuantReg: 13.40054) QuantErr: 13.40054 batch_time=0.41462 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 5.04423 (QuantReg: 13.32079) QuantErr: 13.32079 batch_time=0.39781 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 5.10000 (QuantReg: 13.33541) QuantErr: 13.33541 batch_time=0.52948 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 3.65702 (QuantReg: 13.35809) QuantErr: 13.35809 batch_time=0.40511 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 3.58265 (QuantReg: 13.36646) QuantErr: 13.36646 batch_time=0.39855 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 3.81982 (QuantReg: 13.33456) QuantErr: 13.33456 batch_time=0.40248 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 4.69129 (QuantReg: 13.34067) QuantErr: 13.34067 batch_time=0.41012 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 4.35698 (QuantReg: 13.27908) QuantErr: 13.27908 batch_time=1.37101 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 5.27650 (QuantReg: 13.34087) QuantErr: 13.34087 batch_time=0.39817 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 4.17547 (QuantReg: 13.38993) QuantErr: 13.38993 batch_time=0.39635 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 5.13414 (QuantReg: 13.49912) QuantErr: 13.49912 batch_time=0.41846 
Train Epoch: 49 codebook_update_time=0.46046
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch49.pth ...
Done in 4.844s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 4.348154181480408
 quant_reg      : 13.362741870880127
 quant_err      : 13.362741870880127
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_miech_test/t2v_metrics/R1: 21.1
 MSRVTT_miech_test/t2v_metrics/R5: 51.2
 MSRVTT_miech_test/t2v_metrics/R10: 65.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.223
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.29841055271672
 MSRVTT_miech_test/v2t_metrics/R1: 21.9
 MSRVTT_miech_test/v2t_metrics/R5: 52.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.8
 MSRVTT_miech_test/v2t_metrics/R50: 87.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.4405
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.29377370926413
 mnt_best       : 42.02736840547397
 not_improved_count: 5
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 4.02659 (QuantReg: 13.36816) QuantErr: 13.36816 batch_time=27.64640 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 4.84611 (QuantReg: 13.34803) QuantErr: 13.34803 batch_time=0.40008 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 3.81993 (QuantReg: 13.52241) QuantErr: 13.52241 batch_time=0.40112 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 4.25460 (QuantReg: 13.20460) QuantErr: 13.20460 batch_time=0.41124 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 4.61216 (QuantReg: 12.98044) QuantErr: 12.98044 batch_time=0.42616 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 3.87965 (QuantReg: 13.33115) QuantErr: 13.33115 batch_time=0.46877 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 4.18182 (QuantReg: 13.29274) QuantErr: 13.29274 batch_time=0.44078 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 3.61364 (QuantReg: 13.14442) QuantErr: 13.14442 batch_time=0.40809 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 3.79792 (QuantReg: 13.25065) QuantErr: 13.25065 batch_time=0.42284 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 4.05595 (QuantReg: 13.44287) QuantErr: 13.44287 batch_time=0.41101 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 4.54331 (QuantReg: 13.34262) QuantErr: 13.34262 batch_time=0.40458 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 4.02317 (QuantReg: 13.29498) QuantErr: 13.29498 batch_time=0.42932 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 3.37641 (QuantReg: 13.61375) QuantErr: 13.61375 batch_time=0.44121 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 3.85329 (QuantReg: 13.33971) QuantErr: 13.33971 batch_time=1.97894 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 3.45777 (QuantReg: 13.48669) QuantErr: 13.48669 batch_time=0.42431 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 4.43859 (QuantReg: 13.35007) QuantErr: 13.35007 batch_time=0.46244 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 4.63397 (QuantReg: 13.44073) QuantErr: 13.44073 batch_time=0.41990 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 3.49061 (QuantReg: 13.51635) QuantErr: 13.51635 batch_time=0.55661 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 4.29614 (QuantReg: 13.17590) QuantErr: 13.17590 batch_time=0.41250 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 4.05353 (QuantReg: 13.22470) QuantErr: 13.22470 batch_time=0.53050 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 4.53407 (QuantReg: 13.53568) QuantErr: 13.53568 batch_time=0.39160 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 3.40310 (QuantReg: 13.36889) QuantErr: 13.36889 batch_time=0.43775 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 3.61057 (QuantReg: 13.28632) QuantErr: 13.28632 batch_time=0.39979 
Train Epoch: 50 codebook_update_time=0.50488
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/checkpoint-epoch50.pth ...
Done in 4.406s
removing stale ckpt [epoch 49] [took 0.01s]
 epoch          : 50
 loss           : 4.2945021562576295
 quant_reg      : 13.353102905273438
 quant_err      : 13.353102905273438
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 52.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.925
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.21142089980656
 MSRVTT_miech_test/v2t_metrics/R1: 22.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.8
 MSRVTT_miech_test/v2t_metrics/R10: 67.0
 MSRVTT_miech_test/v2t_metrics/R50: 87.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.055
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.61571785855781
 mnt_best       : 42.02736840547397
 not_improved_count: 6
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/trained_model.pth ...
Ckpt loaded at epoch 44.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/MSRVTT-test-qt-sims.npy
MSRVTT_miech_test:
 t2v_metrics/R1/final_eval: 22.4
 t2v_metrics/R5/final_eval: 51.7
 t2v_metrics/R10/final_eval: 64.1
 t2v_metrics/R50/final_eval: 87.5
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 30.787
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 42.02736840547397
 v2t_metrics/R1/final_eval: 21.9
 v2t_metrics/R5/final_eval: 52.5
 v2t_metrics/R10/final_eval: 65.9
 v2t_metrics/R50/final_eval: 88.1
 v2t_metrics/MedR/final_eval: 5.0
 v2t_metrics/MeanR/final_eval: 27.4875
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 42.315188281889945
Best epoch for the monitored metric: 44
Script took 03h08m07s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_L1/trained_model.pth
