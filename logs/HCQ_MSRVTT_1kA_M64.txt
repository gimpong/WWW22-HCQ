Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 974.5532853603363 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 88.33325600624084 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 79.28633856773376 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch0.pth ...
Done in 1.750s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch0.pth ...
Done in 3.712s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 1.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 5.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 493.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 498.597
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.45788569702133275
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 0.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 476.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 493.279
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 mnt_best       : 0.45788569702133275
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.82445 (QuantReg: 21.64898) QuantErr: 21.64898 batch_time=27.88361 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.73499 (QuantReg: 21.73981) QuantErr: 21.73981 batch_time=0.61733 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.58577 (QuantReg: 21.85950) QuantErr: 21.85950 batch_time=0.60086 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.40880 (QuantReg: 21.83416) QuantErr: 21.83416 batch_time=0.64955 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.51826 (QuantReg: 21.87535) QuantErr: 21.87535 batch_time=0.60721 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 5.82863 (QuantReg: 21.88825) QuantErr: 21.88825 batch_time=0.60250 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.91430 (QuantReg: 21.90160) QuantErr: 21.90160 batch_time=0.61504 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.01418 (QuantReg: 21.88745) QuantErr: 21.88745 batch_time=0.61651 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.47606 (QuantReg: 21.84380) QuantErr: 21.84380 batch_time=0.63656 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.37981 (QuantReg: 21.85745) QuantErr: 21.85745 batch_time=0.60504 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 4.67008 (QuantReg: 21.90475) QuantErr: 21.90475 batch_time=0.67150 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 4.72617 (QuantReg: 21.89772) QuantErr: 21.89772 batch_time=0.68888 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.26558 (QuantReg: 21.77127) QuantErr: 21.77127 batch_time=0.61498 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.43846 (QuantReg: 21.80652) QuantErr: 21.80652 batch_time=2.00345 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.79476 (QuantReg: 21.84111) QuantErr: 21.84111 batch_time=1.05293 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.14413 (QuantReg: 21.80865) QuantErr: 21.80865 batch_time=0.60352 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.85463 (QuantReg: 21.82779) QuantErr: 21.82779 batch_time=0.58263 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.47437 (QuantReg: 21.80555) QuantErr: 21.80555 batch_time=0.60993 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.14839 (QuantReg: 21.80949) QuantErr: 21.80949 batch_time=0.60028 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.41726 (QuantReg: 21.84346) QuantErr: 21.84346 batch_time=1.09855 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 3.64855 (QuantReg: 21.86996) QuantErr: 21.86996 batch_time=1.07590 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.25660 (QuantReg: 21.88182) QuantErr: 21.88182 batch_time=0.58747 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.74928 (QuantReg: 21.83294) QuantErr: 21.83294 batch_time=0.58191 
Train Epoch: 1 codebook_update_time=3.42150
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch1.pth ...
Done in 4.112s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch1.pth ...
Done in 8.400s
 epoch          : 1
 loss           : 5.408132533073426
 quant_reg      : 21.83753554534912
 quant_err      : 21.83753554534912
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 33.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 46.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 79.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 39.372
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.53679000668778
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 35.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 49.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 82.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 37.758
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.080500490027376
 mnt_best       : 26.53679000668778
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.19389 (QuantReg: 14.04108) QuantErr: 14.04108 batch_time=31.91215 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 3.96487 (QuantReg: 13.89687) QuantErr: 13.89687 batch_time=0.61720 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.06553 (QuantReg: 14.39344) QuantErr: 14.39344 batch_time=2.36723 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.84967 (QuantReg: 14.39817) QuantErr: 14.39817 batch_time=0.60935 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.85131 (QuantReg: 14.96866) QuantErr: 14.96866 batch_time=0.61330 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 3.92857 (QuantReg: 14.70997) QuantErr: 14.70997 batch_time=0.60533 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 3.76895 (QuantReg: 14.74725) QuantErr: 14.74725 batch_time=0.60392 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.85045 (QuantReg: 15.09814) QuantErr: 15.09814 batch_time=1.42679 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 3.77418 (QuantReg: 15.44170) QuantErr: 15.44170 batch_time=0.60873 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.33232 (QuantReg: 15.14600) QuantErr: 15.14600 batch_time=0.60062 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.75710 (QuantReg: 15.22931) QuantErr: 15.22931 batch_time=0.60379 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.20170 (QuantReg: 15.52842) QuantErr: 15.52842 batch_time=0.61904 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.60356 (QuantReg: 15.61037) QuantErr: 15.61037 batch_time=0.60705 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.13505 (QuantReg: 15.96534) QuantErr: 15.96534 batch_time=0.62081 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 4.02937 (QuantReg: 15.89168) QuantErr: 15.89168 batch_time=0.66997 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.48138 (QuantReg: 16.20295) QuantErr: 16.20295 batch_time=0.71248 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.84094 (QuantReg: 16.13042) QuantErr: 16.13042 batch_time=0.64703 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.69646 (QuantReg: 16.41395) QuantErr: 16.41395 batch_time=0.60030 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.35945 (QuantReg: 16.57430) QuantErr: 16.57430 batch_time=0.60913 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.34319 (QuantReg: 16.63765) QuantErr: 16.63765 batch_time=3.15782 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.45003 (QuantReg: 16.45615) QuantErr: 16.45615 batch_time=0.59465 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.62920 (QuantReg: 16.36795) QuantErr: 16.36795 batch_time=0.59960 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.74751 (QuantReg: 16.56334) QuantErr: 16.56334 batch_time=0.60453 
Train Epoch: 2 codebook_update_time=3.31298
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch2.pth ...
Done in 4.337s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch2.pth ...
Done in 8.579s
removing stale ckpt [epoch 1] [took 0.02s]
removing stale ckpt [epoch 0] [took 0.03s]
 epoch          : 2
 loss           : 3.7249118251800537
 quant_reg      : 15.51775721359253
 quant_err      : 15.51775721359253
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.696
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.1612048052762
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.022
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.352413018640625
 mnt_best       : 33.1612048052762
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.34821 (QuantReg: 14.11727) QuantErr: 14.11727 batch_time=32.23399 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.25659 (QuantReg: 14.46440) QuantErr: 14.46440 batch_time=0.64250 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.32901 (QuantReg: 14.30644) QuantErr: 14.30644 batch_time=0.59185 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 2.93846 (QuantReg: 14.40044) QuantErr: 14.40044 batch_time=0.61586 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 2.94546 (QuantReg: 14.58461) QuantErr: 14.58461 batch_time=0.62127 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 2.45045 (QuantReg: 14.61174) QuantErr: 14.61174 batch_time=0.66134 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.72779 (QuantReg: 14.70342) QuantErr: 14.70342 batch_time=0.58679 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.52914 (QuantReg: 14.59975) QuantErr: 14.59975 batch_time=0.62761 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.56808 (QuantReg: 14.44946) QuantErr: 14.44946 batch_time=0.62487 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 2.72489 (QuantReg: 14.69634) QuantErr: 14.69634 batch_time=0.59812 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.42709 (QuantReg: 14.66296) QuantErr: 14.66296 batch_time=0.60761 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.15588 (QuantReg: 14.57549) QuantErr: 14.57549 batch_time=0.68879 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 2.84157 (QuantReg: 14.66420) QuantErr: 14.66420 batch_time=0.60537 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.37999 (QuantReg: 14.67638) QuantErr: 14.67638 batch_time=0.60502 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.55886 (QuantReg: 14.76317) QuantErr: 14.76317 batch_time=0.61651 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.83218 (QuantReg: 14.95629) QuantErr: 14.95629 batch_time=0.62161 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.32042 (QuantReg: 15.18442) QuantErr: 15.18442 batch_time=0.60218 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 2.92460 (QuantReg: 15.01709) QuantErr: 15.01709 batch_time=0.71012 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.00820 (QuantReg: 14.89201) QuantErr: 14.89201 batch_time=8.59089 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.10827 (QuantReg: 15.16862) QuantErr: 15.16862 batch_time=0.60800 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.03981 (QuantReg: 15.01888) QuantErr: 15.01888 batch_time=0.65042 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.09037 (QuantReg: 15.08283) QuantErr: 15.08283 batch_time=0.61286 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.15079 (QuantReg: 15.05362) QuantErr: 15.05362 batch_time=0.62349 
Train Epoch: 3 codebook_update_time=3.34344
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch3.pth ...
Done in 4.712s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch3.pth ...
Done in 8.915s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 3.159526993751526
 quant_reg      : 14.71673893737793
 quant_err      : 14.71673893737793
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.252
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.61411038840476
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.562
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.79523749522489
 mnt_best       : 36.61411038840476
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 2.99149 (QuantReg: 14.07736) QuantErr: 14.07736 batch_time=34.35682 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.75303 (QuantReg: 14.29006) QuantErr: 14.29006 batch_time=0.59801 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.87283 (QuantReg: 14.43808) QuantErr: 14.43808 batch_time=0.98779 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.75047 (QuantReg: 14.45324) QuantErr: 14.45324 batch_time=0.62975 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.66824 (QuantReg: 14.59450) QuantErr: 14.59450 batch_time=0.61297 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.00280 (QuantReg: 14.48631) QuantErr: 14.48631 batch_time=0.59284 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.62099 (QuantReg: 14.36110) QuantErr: 14.36110 batch_time=0.61900 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.81902 (QuantReg: 14.39472) QuantErr: 14.39472 batch_time=0.60366 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 3.15880 (QuantReg: 14.37053) QuantErr: 14.37053 batch_time=0.69360 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.46644 (QuantReg: 14.55950) QuantErr: 14.55950 batch_time=0.60284 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 2.81542 (QuantReg: 14.91240) QuantErr: 14.91240 batch_time=0.60890 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.51509 (QuantReg: 14.89544) QuantErr: 14.89544 batch_time=0.60316 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.02347 (QuantReg: 14.82021) QuantErr: 14.82021 batch_time=0.64801 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.60700 (QuantReg: 14.92116) QuantErr: 14.92116 batch_time=5.48378 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.68745 (QuantReg: 14.77010) QuantErr: 14.77010 batch_time=0.60950 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.85848 (QuantReg: 14.75225) QuantErr: 14.75225 batch_time=0.61029 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.82673 (QuantReg: 14.71163) QuantErr: 14.71163 batch_time=0.59615 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.84038 (QuantReg: 14.86796) QuantErr: 14.86796 batch_time=0.61015 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.50392 (QuantReg: 14.94823) QuantErr: 14.94823 batch_time=0.66877 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.48984 (QuantReg: 14.87749) QuantErr: 14.87749 batch_time=0.64961 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.33660 (QuantReg: 15.20101) QuantErr: 15.20101 batch_time=0.62836 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.23203 (QuantReg: 15.36684) QuantErr: 15.36684 batch_time=0.60681 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.81107 (QuantReg: 14.96209) QuantErr: 14.96209 batch_time=0.60551 
Train Epoch: 4 codebook_update_time=3.68161
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch4.pth ...
Done in 4.091s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch4.pth ...
Done in 8.101s
removing stale ckpt [epoch 3] [took 0.03s]
 epoch          : 4
 loss           : 2.8616314640045166
 quant_reg      : 14.635052577972413
 quant_err      : 14.635052577972413
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.383
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.80598012942461
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.797
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.83468485946031
 mnt_best       : 37.80598012942461
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.88474 (QuantReg: 14.08419) QuantErr: 14.08419 batch_time=34.30315 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.01903 (QuantReg: 14.33878) QuantErr: 14.33878 batch_time=0.58973 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.21732 (QuantReg: 14.28676) QuantErr: 14.28676 batch_time=0.59488 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.55094 (QuantReg: 14.56453) QuantErr: 14.56453 batch_time=0.65530 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.72130 (QuantReg: 14.56371) QuantErr: 14.56371 batch_time=0.60725 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.33858 (QuantReg: 14.54438) QuantErr: 14.54438 batch_time=0.57522 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.67237 (QuantReg: 14.45178) QuantErr: 14.45178 batch_time=0.61523 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 3.06175 (QuantReg: 14.12617) QuantErr: 14.12617 batch_time=0.62498 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.45760 (QuantReg: 14.66991) QuantErr: 14.66991 batch_time=0.61879 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.49127 (QuantReg: 14.30973) QuantErr: 14.30973 batch_time=0.63723 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.60855 (QuantReg: 14.57025) QuantErr: 14.57025 batch_time=0.68941 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.62112 (QuantReg: 14.58165) QuantErr: 14.58165 batch_time=0.62750 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.53438 (QuantReg: 14.78951) QuantErr: 14.78951 batch_time=0.62096 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.15517 (QuantReg: 14.46430) QuantErr: 14.46430 batch_time=0.63355 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.98412 (QuantReg: 14.56281) QuantErr: 14.56281 batch_time=0.60699 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.25666 (QuantReg: 14.94477) QuantErr: 14.94477 batch_time=0.59206 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.74472 (QuantReg: 14.69531) QuantErr: 14.69531 batch_time=0.61242 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.68304 (QuantReg: 14.69547) QuantErr: 14.69547 batch_time=0.61739 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.54066 (QuantReg: 14.94404) QuantErr: 14.94404 batch_time=0.60681 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.55795 (QuantReg: 14.80426) QuantErr: 14.80426 batch_time=0.67440 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.87859 (QuantReg: 14.83046) QuantErr: 14.83046 batch_time=0.63586 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.41901 (QuantReg: 14.87829) QuantErr: 14.87829 batch_time=0.60407 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.80605 (QuantReg: 15.04694) QuantErr: 15.04694 batch_time=0.62644 
Train Epoch: 5 codebook_update_time=3.29440
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch5.pth ...
Done in 4.137s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch5.pth ...
Done in 8.471s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 2.581015509605408
 quant_reg      : 14.650204216003418
 quant_err      : 14.650204216003418
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.751
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.45410031454433
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.921
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.634500472230215
 mnt_best       : 40.45410031454433
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.65549 (QuantReg: 14.29245) QuantErr: 14.29245 batch_time=40.14424 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.63537 (QuantReg: 14.03003) QuantErr: 14.03003 batch_time=0.60568 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.48193 (QuantReg: 14.27854) QuantErr: 14.27854 batch_time=0.61926 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.35485 (QuantReg: 14.32023) QuantErr: 14.32023 batch_time=0.60485 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.29260 (QuantReg: 14.23530) QuantErr: 14.23530 batch_time=0.59541 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.25818 (QuantReg: 14.44039) QuantErr: 14.44039 batch_time=0.61780 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.72352 (QuantReg: 14.55580) QuantErr: 14.55580 batch_time=0.61244 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.36694 (QuantReg: 14.66571) QuantErr: 14.66571 batch_time=0.61034 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.36830 (QuantReg: 14.60436) QuantErr: 14.60436 batch_time=0.61048 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.16169 (QuantReg: 14.63546) QuantErr: 14.63546 batch_time=0.62239 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.42133 (QuantReg: 14.81202) QuantErr: 14.81202 batch_time=0.64312 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.30812 (QuantReg: 14.55057) QuantErr: 14.55057 batch_time=0.61383 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.24613 (QuantReg: 14.72735) QuantErr: 14.72735 batch_time=0.67627 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.21875 (QuantReg: 14.45447) QuantErr: 14.45447 batch_time=0.60885 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.65644 (QuantReg: 14.85128) QuantErr: 14.85128 batch_time=0.63774 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.39836 (QuantReg: 14.59793) QuantErr: 14.59793 batch_time=0.62101 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.15442 (QuantReg: 14.90708) QuantErr: 14.90708 batch_time=0.62957 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.50631 (QuantReg: 14.85711) QuantErr: 14.85711 batch_time=0.66508 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.59490 (QuantReg: 14.89635) QuantErr: 14.89635 batch_time=0.89635 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.43130 (QuantReg: 14.75171) QuantErr: 14.75171 batch_time=0.61913 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.18652 (QuantReg: 14.91192) QuantErr: 14.91192 batch_time=0.61054 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.13890 (QuantReg: 14.65321) QuantErr: 14.65321 batch_time=0.60285 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.00428 (QuantReg: 14.76037) QuantErr: 14.76037 batch_time=0.59508 
Train Epoch: 6 codebook_update_time=3.26370
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch6.pth ...
Done in 4.170s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch6.pth ...
Done in 8.378s
removing stale ckpt [epoch 5] [took 0.02s]
 epoch          : 6
 loss           : 2.3865116906166075
 quant_reg      : 14.644343116760254
 quant_err      : 14.644343116760254
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.046
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.51271662853379
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.7205
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.749589344210406
 mnt_best       : 40.51271662853379
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.43230 (QuantReg: 14.20357) QuantErr: 14.20357 batch_time=40.49150 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.39051 (QuantReg: 14.37747) QuantErr: 14.37747 batch_time=0.66809 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.23465 (QuantReg: 14.16215) QuantErr: 14.16215 batch_time=0.60349 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 1.94319 (QuantReg: 14.53615) QuantErr: 14.53615 batch_time=0.61939 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.01053 (QuantReg: 14.49739) QuantErr: 14.49739 batch_time=0.61090 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.07819 (QuantReg: 14.82673) QuantErr: 14.82673 batch_time=0.64455 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.32132 (QuantReg: 14.73764) QuantErr: 14.73764 batch_time=2.39759 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.20694 (QuantReg: 14.57400) QuantErr: 14.57400 batch_time=0.69473 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.22824 (QuantReg: 14.76048) QuantErr: 14.76048 batch_time=0.61220 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 1.87346 (QuantReg: 14.65612) QuantErr: 14.65612 batch_time=0.95732 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.63877 (QuantReg: 14.55897) QuantErr: 14.55897 batch_time=0.60285 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.20095 (QuantReg: 14.80412) QuantErr: 14.80412 batch_time=0.60448 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.08564 (QuantReg: 14.76882) QuantErr: 14.76882 batch_time=0.59970 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.29902 (QuantReg: 14.68952) QuantErr: 14.68952 batch_time=0.59688 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 1.70739 (QuantReg: 14.61236) QuantErr: 14.61236 batch_time=1.20885 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.27093 (QuantReg: 14.61468) QuantErr: 14.61468 batch_time=0.60210 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 1.78012 (QuantReg: 14.99100) QuantErr: 14.99100 batch_time=0.59712 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.23894 (QuantReg: 14.66355) QuantErr: 14.66355 batch_time=0.62065 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.64540 (QuantReg: 14.87119) QuantErr: 14.87119 batch_time=0.62002 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.45612 (QuantReg: 14.87081) QuantErr: 14.87081 batch_time=0.60765 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.01993 (QuantReg: 14.90782) QuantErr: 14.90782 batch_time=0.63023 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.15949 (QuantReg: 15.03802) QuantErr: 15.03802 batch_time=0.60400 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.24867 (QuantReg: 14.96056) QuantErr: 14.96056 batch_time=0.60173 
Train Epoch: 7 codebook_update_time=3.29634
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch7.pth ...
Done in 4.335s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch7.pth ...
Done in 8.588s
removing stale ckpt [epoch 6] [took 0.02s]
 epoch          : 7
 loss           : 2.2140056791305542
 quant_reg      : 14.68624785232544
 quant_err      : 14.68624785232544
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.214
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.64030584679487
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.2375
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.50501440258069
 mnt_best       : 42.64030584679487
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.36149 (QuantReg: 14.52645) QuantErr: 14.52645 batch_time=34.24505 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.43216 (QuantReg: 14.38848) QuantErr: 14.38848 batch_time=0.61245 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.71553 (QuantReg: 14.58437) QuantErr: 14.58437 batch_time=0.60498 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.13791 (QuantReg: 14.42494) QuantErr: 14.42494 batch_time=0.61771 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.23177 (QuantReg: 14.69539) QuantErr: 14.69539 batch_time=0.60641 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 1.94472 (QuantReg: 14.59832) QuantErr: 14.59832 batch_time=0.60686 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.18636 (QuantReg: 14.83589) QuantErr: 14.83589 batch_time=1.75934 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.33293 (QuantReg: 14.86763) QuantErr: 14.86763 batch_time=0.59623 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.28258 (QuantReg: 14.73390) QuantErr: 14.73390 batch_time=0.60680 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.58266 (QuantReg: 14.70570) QuantErr: 14.70570 batch_time=0.60782 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.36678 (QuantReg: 14.77991) QuantErr: 14.77991 batch_time=0.60838 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.11312 (QuantReg: 14.68789) QuantErr: 14.68789 batch_time=0.62280 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.27714 (QuantReg: 14.83455) QuantErr: 14.83455 batch_time=2.51003 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.28491 (QuantReg: 14.99976) QuantErr: 14.99976 batch_time=0.62398 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.07015 (QuantReg: 14.85258) QuantErr: 14.85258 batch_time=0.57955 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 1.85894 (QuantReg: 14.50820) QuantErr: 14.50820 batch_time=0.59748 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 1.93781 (QuantReg: 14.70941) QuantErr: 14.70941 batch_time=0.59308 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.65645 (QuantReg: 14.67501) QuantErr: 14.67501 batch_time=0.60211 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.27057 (QuantReg: 14.76346) QuantErr: 14.76346 batch_time=0.60011 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.26737 (QuantReg: 14.53228) QuantErr: 14.53228 batch_time=0.84600 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.21692 (QuantReg: 14.78335) QuantErr: 14.78335 batch_time=0.90389 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 1.66035 (QuantReg: 14.84488) QuantErr: 14.84488 batch_time=0.62972 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.40088 (QuantReg: 14.93856) QuantErr: 14.93856 batch_time=0.61321 
Train Epoch: 8 codebook_update_time=3.32071
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch8.pth ...
Done in 4.469s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 2.123444999217987
 quant_reg      : 14.715266193389892
 quant_err      : 14.715266193389892
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.939
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.78871592420212
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.291
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.19974440435195
 mnt_best       : 42.64030584679487
 not_improved_count: 1
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 1.80781 (QuantReg: 14.78163) QuantErr: 14.78163 batch_time=38.47194 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.23823 (QuantReg: 14.67068) QuantErr: 14.67068 batch_time=0.59234 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 1.78353 (QuantReg: 14.55507) QuantErr: 14.55507 batch_time=0.61119 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.05356 (QuantReg: 14.62508) QuantErr: 14.62508 batch_time=0.65959 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 1.95416 (QuantReg: 14.82016) QuantErr: 14.82016 batch_time=0.66349 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 1.67899 (QuantReg: 14.92032) QuantErr: 14.92032 batch_time=0.60483 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.81855 (QuantReg: 14.96400) QuantErr: 14.96400 batch_time=1.16184 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.97578 (QuantReg: 14.86876) QuantErr: 14.86876 batch_time=0.65365 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.12617 (QuantReg: 14.54727) QuantErr: 14.54727 batch_time=0.65080 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.82401 (QuantReg: 14.87644) QuantErr: 14.87644 batch_time=0.60343 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 1.98263 (QuantReg: 14.78202) QuantErr: 14.78202 batch_time=0.59563 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.60305 (QuantReg: 14.84366) QuantErr: 14.84366 batch_time=0.60269 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 2.05855 (QuantReg: 14.75452) QuantErr: 14.75452 batch_time=5.12591 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 1.90671 (QuantReg: 14.84293) QuantErr: 14.84293 batch_time=0.66256 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.10054 (QuantReg: 14.64787) QuantErr: 14.64787 batch_time=0.61171 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.73361 (QuantReg: 15.20177) QuantErr: 15.20177 batch_time=0.61776 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 2.07922 (QuantReg: 15.08860) QuantErr: 15.08860 batch_time=0.61814 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.46509 (QuantReg: 14.87655) QuantErr: 14.87655 batch_time=0.61368 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 1.97687 (QuantReg: 14.91355) QuantErr: 14.91355 batch_time=0.59880 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.95347 (QuantReg: 14.89790) QuantErr: 14.89790 batch_time=0.67711 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.73550 (QuantReg: 15.16414) QuantErr: 15.16414 batch_time=0.77128 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.76595 (QuantReg: 14.80116) QuantErr: 14.80116 batch_time=0.64777 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.85367 (QuantReg: 14.71801) QuantErr: 14.71801 batch_time=0.60731 
Train Epoch: 9 codebook_update_time=3.57070
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch9.pth ...
Done in 7.807s
removing stale ckpt [epoch 8] [took 0.03s]
 epoch          : 9
 loss           : 1.981418164730072
 quant_reg      : 14.779094074249267
 quant_err      : 14.779094074249267
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.885
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.31469960644929
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.128
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.504303445300046
 mnt_best       : 42.64030584679487
 not_improved_count: 2
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.81556 (QuantReg: 14.72425) QuantErr: 14.72425 batch_time=34.97089 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 1.96933 (QuantReg: 14.53595) QuantErr: 14.53595 batch_time=0.61949 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.19353 (QuantReg: 14.75422) QuantErr: 14.75422 batch_time=0.60799 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.07512 (QuantReg: 14.37493) QuantErr: 14.37493 batch_time=0.59692 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 1.69404 (QuantReg: 14.57351) QuantErr: 14.57351 batch_time=0.61716 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 1.88063 (QuantReg: 14.86949) QuantErr: 14.86949 batch_time=0.66423 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.28909 (QuantReg: 14.51576) QuantErr: 14.51576 batch_time=0.62239 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 1.96601 (QuantReg: 14.75716) QuantErr: 14.75716 batch_time=0.59553 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 1.89865 (QuantReg: 14.62230) QuantErr: 14.62230 batch_time=0.75308 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 1.89272 (QuantReg: 14.65977) QuantErr: 14.65977 batch_time=0.59232 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.69603 (QuantReg: 14.72613) QuantErr: 14.72613 batch_time=0.88196 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.07594 (QuantReg: 15.00581) QuantErr: 15.00581 batch_time=0.60362 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 1.92860 (QuantReg: 14.63013) QuantErr: 14.63013 batch_time=0.59428 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.57416 (QuantReg: 15.15729) QuantErr: 15.15729 batch_time=0.58818 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.86133 (QuantReg: 14.61514) QuantErr: 14.61514 batch_time=0.63125 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.08301 (QuantReg: 14.97668) QuantErr: 14.97668 batch_time=1.84051 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 2.03484 (QuantReg: 14.85327) QuantErr: 14.85327 batch_time=0.63286 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 1.83675 (QuantReg: 15.02417) QuantErr: 15.02417 batch_time=0.61381 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.51636 (QuantReg: 14.91625) QuantErr: 14.91625 batch_time=0.63138 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.49632 (QuantReg: 15.16117) QuantErr: 15.16117 batch_time=0.63534 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.93895 (QuantReg: 14.90326) QuantErr: 14.90326 batch_time=0.60918 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 2.13740 (QuantReg: 14.83822) QuantErr: 14.83822 batch_time=0.64289 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 1.98690 (QuantReg: 15.06882) QuantErr: 15.06882 batch_time=0.62097 
Train Epoch: 10 codebook_update_time=3.31286
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch10.pth ...
Done in 6.590s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch10.pth ...
Done in 12.082s
removing stale ckpt [epoch 9] [took 0.01s]
 epoch          : 10
 loss           : 1.8789598083496093
 quant_reg      : 14.812705432891846
 quant_err      : 14.812705432891846
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.115
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.855188363777046
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.303
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.57499872342879
 mnt_best       : 42.855188363777046
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 1.81319 (QuantReg: 14.64631) QuantErr: 14.64631 batch_time=33.21017 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.09804 (QuantReg: 14.54606) QuantErr: 14.54606 batch_time=0.92365 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 2.09411 (QuantReg: 14.68424) QuantErr: 14.68424 batch_time=1.76438 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 1.98845 (QuantReg: 14.89883) QuantErr: 14.89883 batch_time=0.59506 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.04620 (QuantReg: 14.61086) QuantErr: 14.61086 batch_time=0.65404 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 2.35821 (QuantReg: 15.20214) QuantErr: 15.20214 batch_time=0.61355 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 1.49052 (QuantReg: 14.86658) QuantErr: 14.86658 batch_time=2.14756 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 1.92851 (QuantReg: 14.53019) QuantErr: 14.53019 batch_time=0.58947 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.80769 (QuantReg: 14.74792) QuantErr: 14.74792 batch_time=0.60967 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.67163 (QuantReg: 14.80378) QuantErr: 14.80378 batch_time=0.61042 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.55061 (QuantReg: 14.89712) QuantErr: 14.89712 batch_time=0.64147 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.57586 (QuantReg: 14.78083) QuantErr: 14.78083 batch_time=0.65299 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 1.93371 (QuantReg: 14.71402) QuantErr: 14.71402 batch_time=0.61659 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.69173 (QuantReg: 14.79917) QuantErr: 14.79917 batch_time=0.60536 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.44961 (QuantReg: 14.84106) QuantErr: 14.84106 batch_time=0.99403 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.21433 (QuantReg: 14.55106) QuantErr: 14.55106 batch_time=0.59782 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.71526 (QuantReg: 14.82519) QuantErr: 14.82519 batch_time=0.61847 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.72015 (QuantReg: 15.04974) QuantErr: 15.04974 batch_time=0.65607 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.82609 (QuantReg: 14.81660) QuantErr: 14.81660 batch_time=0.60059 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.74302 (QuantReg: 15.00398) QuantErr: 15.00398 batch_time=0.60150 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.68716 (QuantReg: 14.76096) QuantErr: 14.76096 batch_time=0.60324 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.81739 (QuantReg: 14.90516) QuantErr: 14.90516 batch_time=0.67907 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.73177 (QuantReg: 15.05188) QuantErr: 15.05188 batch_time=0.64400 
Train Epoch: 11 codebook_update_time=3.36671
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch11.pth ...
Done in 6.798s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch11.pth ...
Done in 15.463s
removing stale ckpt [epoch 10] [took 0.41s]
 epoch          : 11
 loss           : 1.7937710738182069
 quant_reg      : 14.825726219177247
 quant_err      : 14.825726219177247
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.908
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.13288459980294
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.109
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.904925195871705
 mnt_best       : 44.13288459980294
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.55544 (QuantReg: 14.62621) QuantErr: 14.62621 batch_time=36.60927 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.67741 (QuantReg: 14.78655) QuantErr: 14.78655 batch_time=0.68473 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.83994 (QuantReg: 14.79354) QuantErr: 14.79354 batch_time=0.63724 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 2.03610 (QuantReg: 14.91940) QuantErr: 14.91940 batch_time=0.61198 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.69203 (QuantReg: 14.74714) QuantErr: 14.74714 batch_time=0.61466 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.73210 (QuantReg: 14.83875) QuantErr: 14.83875 batch_time=2.22701 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.93045 (QuantReg: 15.06925) QuantErr: 15.06925 batch_time=0.65359 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.89288 (QuantReg: 14.73239) QuantErr: 14.73239 batch_time=0.61823 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.69572 (QuantReg: 14.87798) QuantErr: 14.87798 batch_time=0.60307 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.71959 (QuantReg: 14.85508) QuantErr: 14.85508 batch_time=0.68118 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.54439 (QuantReg: 14.86788) QuantErr: 14.86788 batch_time=0.72749 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.52803 (QuantReg: 14.95100) QuantErr: 14.95100 batch_time=0.60366 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.57730 (QuantReg: 14.71227) QuantErr: 14.71227 batch_time=0.61238 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.72277 (QuantReg: 14.73905) QuantErr: 14.73905 batch_time=1.62803 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.92381 (QuantReg: 15.17354) QuantErr: 15.17354 batch_time=0.98790 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.64909 (QuantReg: 14.99394) QuantErr: 14.99394 batch_time=0.59369 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.93943 (QuantReg: 15.01794) QuantErr: 15.01794 batch_time=0.60041 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.48104 (QuantReg: 15.02192) QuantErr: 15.02192 batch_time=0.61315 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.84878 (QuantReg: 14.88380) QuantErr: 14.88380 batch_time=0.62053 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.50868 (QuantReg: 15.05641) QuantErr: 15.05641 batch_time=0.61733 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.34715 (QuantReg: 15.16534) QuantErr: 15.16534 batch_time=0.66892 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.79115 (QuantReg: 15.16504) QuantErr: 15.16504 batch_time=0.61679 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.62323 (QuantReg: 14.93808) QuantErr: 14.93808 batch_time=0.61576 
Train Epoch: 12 codebook_update_time=3.36654
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch12.pth ...
Done in 5.413s
removing stale ckpt [epoch 11] [took 0.22s]
 epoch          : 12
 loss           : 1.7255308842658996
 quant_reg      : 14.866978885650635
 quant_err      : 14.866978885650635
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.418
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.34873784997596
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1195
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.52140702981216
 mnt_best       : 44.13288459980294
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.76173 (QuantReg: 14.50530) QuantErr: 14.50530 batch_time=38.74399 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.36109 (QuantReg: 15.07061) QuantErr: 15.07061 batch_time=0.61393 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.73149 (QuantReg: 14.71612) QuantErr: 14.71612 batch_time=0.62576 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.35924 (QuantReg: 15.00793) QuantErr: 15.00793 batch_time=0.59904 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.73484 (QuantReg: 15.03187) QuantErr: 15.03187 batch_time=0.59745 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.91834 (QuantReg: 14.65396) QuantErr: 14.65396 batch_time=0.62219 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.65842 (QuantReg: 15.03797) QuantErr: 15.03797 batch_time=0.60151 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.73040 (QuantReg: 15.00919) QuantErr: 15.00919 batch_time=0.59929 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.67670 (QuantReg: 15.06229) QuantErr: 15.06229 batch_time=0.61131 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.49981 (QuantReg: 14.93061) QuantErr: 14.93061 batch_time=0.60454 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.56921 (QuantReg: 15.04136) QuantErr: 15.04136 batch_time=0.62175 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.53307 (QuantReg: 15.19539) QuantErr: 15.19539 batch_time=0.60372 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.66922 (QuantReg: 14.92934) QuantErr: 14.92934 batch_time=0.66230 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.69310 (QuantReg: 15.02953) QuantErr: 15.02953 batch_time=0.60332 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.46975 (QuantReg: 15.01277) QuantErr: 15.01277 batch_time=0.61144 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.91430 (QuantReg: 14.92122) QuantErr: 14.92122 batch_time=0.59771 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.62471 (QuantReg: 15.13332) QuantErr: 15.13332 batch_time=0.60780 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.89878 (QuantReg: 14.94307) QuantErr: 14.94307 batch_time=0.60063 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.43787 (QuantReg: 15.05833) QuantErr: 15.05833 batch_time=0.60540 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.78911 (QuantReg: 14.80357) QuantErr: 14.80357 batch_time=0.58900 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.27846 (QuantReg: 15.05841) QuantErr: 15.05841 batch_time=0.61144 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.59560 (QuantReg: 14.94751) QuantErr: 14.94751 batch_time=0.63663 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.86626 (QuantReg: 14.93256) QuantErr: 14.93256 batch_time=0.61709 
Train Epoch: 13 codebook_update_time=3.69503
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch13.pth ...
Done in 5.622s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch13.pth ...
Done in 11.374s
removing stale ckpt [epoch 12] [took 0.92s]
 epoch          : 13
 loss           : 1.6671384949684143
 quant_reg      : 14.916769687652588
 quant_err      : 14.916769687652588
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.387
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.62831625662184
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.5115
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.64082601036819
 mnt_best       : 44.62831625662184
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.58940 (QuantReg: 14.86577) QuantErr: 14.86577 batch_time=41.70780 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.47993 (QuantReg: 14.67618) QuantErr: 14.67618 batch_time=0.64507 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.58852 (QuantReg: 14.83022) QuantErr: 14.83022 batch_time=0.60062 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.51426 (QuantReg: 14.96500) QuantErr: 14.96500 batch_time=0.58841 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.47090 (QuantReg: 14.86492) QuantErr: 14.86492 batch_time=0.59309 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.95562 (QuantReg: 14.57959) QuantErr: 14.57959 batch_time=0.59632 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.95093 (QuantReg: 14.90255) QuantErr: 14.90255 batch_time=0.58106 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.49978 (QuantReg: 14.75384) QuantErr: 14.75384 batch_time=0.60964 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.47659 (QuantReg: 14.54350) QuantErr: 14.54350 batch_time=0.59238 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.31027 (QuantReg: 14.95935) QuantErr: 14.95935 batch_time=0.63369 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.98109 (QuantReg: 14.75143) QuantErr: 14.75143 batch_time=0.68369 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.42434 (QuantReg: 14.89341) QuantErr: 14.89341 batch_time=0.59181 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.48631 (QuantReg: 14.92842) QuantErr: 14.92842 batch_time=0.66826 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.76829 (QuantReg: 14.82491) QuantErr: 14.82491 batch_time=0.69758 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.50591 (QuantReg: 14.99356) QuantErr: 14.99356 batch_time=0.71238 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.82228 (QuantReg: 14.89112) QuantErr: 14.89112 batch_time=0.60830 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.59797 (QuantReg: 15.01182) QuantErr: 15.01182 batch_time=0.59651 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.73854 (QuantReg: 14.90222) QuantErr: 14.90222 batch_time=0.73253 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.58649 (QuantReg: 15.16385) QuantErr: 15.16385 batch_time=0.64783 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.65845 (QuantReg: 14.88251) QuantErr: 14.88251 batch_time=0.62945 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.68918 (QuantReg: 14.78080) QuantErr: 14.78080 batch_time=0.66671 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.43771 (QuantReg: 15.35351) QuantErr: 15.35351 batch_time=0.88239 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.24989 (QuantReg: 15.16531) QuantErr: 15.16531 batch_time=0.94350 
Train Epoch: 14 codebook_update_time=3.26992
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch14.pth ...
Done in 5.941s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch14.pth ...
Done in 11.299s
removing stale ckpt [epoch 13] [took 0.22s]
 epoch          : 14
 loss           : 1.5994117650985717
 quant_reg      : 14.886657775878906
 quant_err      : 14.886657775878906
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.182
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.925958240546684
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.295
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.939397194387105
 mnt_best       : 44.925958240546684
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.43423 (QuantReg: 14.76756) QuantErr: 14.76756 batch_time=40.56995 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.09867 (QuantReg: 14.89635) QuantErr: 14.89635 batch_time=0.63186 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.56343 (QuantReg: 14.88346) QuantErr: 14.88346 batch_time=0.62855 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.36052 (QuantReg: 14.65124) QuantErr: 14.65124 batch_time=2.00957 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.78785 (QuantReg: 14.88951) QuantErr: 14.88951 batch_time=0.62962 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.64767 (QuantReg: 14.92753) QuantErr: 14.92753 batch_time=0.60125 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.78391 (QuantReg: 15.06192) QuantErr: 15.06192 batch_time=3.84613 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.29914 (QuantReg: 14.82573) QuantErr: 14.82573 batch_time=0.61415 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.90588 (QuantReg: 14.94208) QuantErr: 14.94208 batch_time=0.61753 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.36015 (QuantReg: 14.94222) QuantErr: 14.94222 batch_time=0.64387 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.79191 (QuantReg: 14.93970) QuantErr: 14.93970 batch_time=0.60575 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.25204 (QuantReg: 15.08831) QuantErr: 15.08831 batch_time=0.62805 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.58174 (QuantReg: 15.08735) QuantErr: 15.08735 batch_time=0.63557 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.47214 (QuantReg: 14.96355) QuantErr: 14.96355 batch_time=0.62485 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.56162 (QuantReg: 14.96526) QuantErr: 14.96526 batch_time=0.72610 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.40285 (QuantReg: 14.89412) QuantErr: 14.89412 batch_time=0.65631 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.38284 (QuantReg: 14.97071) QuantErr: 14.97071 batch_time=0.65616 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.57367 (QuantReg: 14.94211) QuantErr: 14.94211 batch_time=0.61505 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.89767 (QuantReg: 14.87427) QuantErr: 14.87427 batch_time=0.64840 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.32148 (QuantReg: 15.10362) QuantErr: 15.10362 batch_time=0.82199 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.28209 (QuantReg: 14.99782) QuantErr: 14.99782 batch_time=0.64933 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.67338 (QuantReg: 15.10816) QuantErr: 15.10816 batch_time=0.65640 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.47116 (QuantReg: 14.97627) QuantErr: 14.97627 batch_time=0.62685 
Train Epoch: 15 codebook_update_time=3.47591
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch15.pth ...
Done in 4.783s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch15.pth ...
Done in 9.736s
removing stale ckpt [epoch 14] [took 0.02s]
 epoch          : 15
 loss           : 1.528383713722229
 quant_reg      : 14.923548221588135
 quant_err      : 14.923548221588135
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.008
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.89815907040152
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.991
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.351785968829596
 mnt_best       : 45.89815907040152
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.67544 (QuantReg: 14.75023) QuantErr: 14.75023 batch_time=35.15494 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.56576 (QuantReg: 14.65257) QuantErr: 14.65257 batch_time=2.63380 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.48553 (QuantReg: 14.87454) QuantErr: 14.87454 batch_time=0.65028 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 2.03680 (QuantReg: 14.51218) QuantErr: 14.51218 batch_time=0.60841 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.57476 (QuantReg: 15.00349) QuantErr: 15.00349 batch_time=0.61697 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.62868 (QuantReg: 14.95755) QuantErr: 14.95755 batch_time=1.05757 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.24919 (QuantReg: 15.12326) QuantErr: 15.12326 batch_time=0.70051 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.49348 (QuantReg: 14.79630) QuantErr: 14.79630 batch_time=0.59609 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.46759 (QuantReg: 14.88569) QuantErr: 14.88569 batch_time=0.60722 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.40801 (QuantReg: 15.00046) QuantErr: 15.00046 batch_time=0.62661 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.33399 (QuantReg: 15.09231) QuantErr: 15.09231 batch_time=0.68024 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.43472 (QuantReg: 15.03469) QuantErr: 15.03469 batch_time=0.61043 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.46943 (QuantReg: 14.92658) QuantErr: 14.92658 batch_time=0.64230 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.78652 (QuantReg: 14.92955) QuantErr: 14.92955 batch_time=0.60774 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.79606 (QuantReg: 15.10196) QuantErr: 15.10196 batch_time=0.67030 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.67519 (QuantReg: 15.14654) QuantErr: 15.14654 batch_time=0.59600 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.24728 (QuantReg: 15.29938) QuantErr: 15.29938 batch_time=0.60971 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.70178 (QuantReg: 15.00850) QuantErr: 15.00850 batch_time=0.60484 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.48326 (QuantReg: 15.19775) QuantErr: 15.19775 batch_time=0.61718 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.30005 (QuantReg: 15.32317) QuantErr: 15.32317 batch_time=0.87271 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.56826 (QuantReg: 14.93237) QuantErr: 14.93237 batch_time=0.63654 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.74822 (QuantReg: 14.91516) QuantErr: 14.91516 batch_time=0.65652 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.49283 (QuantReg: 14.89188) QuantErr: 14.89188 batch_time=0.70760 
Train Epoch: 16 codebook_update_time=3.64849
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch16.pth ...
Done in 6.917s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch16.pth ...
Done in 12.293s
removing stale ckpt [epoch 15] [took 0.61s]
 epoch          : 16
 loss           : 1.517564145565033
 quant_reg      : 14.956533226013184
 quant_err      : 14.956533226013184
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.823
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.072784899161675
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.612
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.718532323456415
 mnt_best       : 46.072784899161675
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.26240 (QuantReg: 15.01076) QuantErr: 15.01076 batch_time=38.20995 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.58175 (QuantReg: 14.74286) QuantErr: 14.74286 batch_time=0.61359 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.33616 (QuantReg: 14.74590) QuantErr: 14.74590 batch_time=0.72779 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.96860 (QuantReg: 15.03395) QuantErr: 15.03395 batch_time=0.65243 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.49592 (QuantReg: 14.69210) QuantErr: 14.69210 batch_time=0.61555 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.44568 (QuantReg: 14.95867) QuantErr: 14.95867 batch_time=0.64403 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.73567 (QuantReg: 14.93917) QuantErr: 14.93917 batch_time=5.56494 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.20875 (QuantReg: 14.90778) QuantErr: 14.90778 batch_time=0.62779 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.41481 (QuantReg: 14.78251) QuantErr: 14.78251 batch_time=0.67490 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.54901 (QuantReg: 14.88266) QuantErr: 14.88266 batch_time=0.65516 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.56143 (QuantReg: 15.01962) QuantErr: 15.01962 batch_time=0.61440 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.49722 (QuantReg: 14.87582) QuantErr: 14.87582 batch_time=0.62026 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.64691 (QuantReg: 14.86518) QuantErr: 14.86518 batch_time=0.60844 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.44334 (QuantReg: 15.12176) QuantErr: 15.12176 batch_time=0.62197 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.82742 (QuantReg: 14.69598) QuantErr: 14.69598 batch_time=0.65020 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.41719 (QuantReg: 14.85143) QuantErr: 14.85143 batch_time=0.64533 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.56533 (QuantReg: 15.11885) QuantErr: 15.11885 batch_time=0.82108 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.28714 (QuantReg: 15.09997) QuantErr: 15.09997 batch_time=0.61968 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.47244 (QuantReg: 14.70850) QuantErr: 14.70850 batch_time=1.18664 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.36058 (QuantReg: 15.04751) QuantErr: 15.04751 batch_time=0.62333 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.40709 (QuantReg: 14.71476) QuantErr: 14.71476 batch_time=0.65208 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.46624 (QuantReg: 15.18106) QuantErr: 15.18106 batch_time=0.58703 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.24706 (QuantReg: 14.89689) QuantErr: 14.89689 batch_time=0.62758 
Train Epoch: 17 codebook_update_time=3.77710
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch17.pth ...
Done in 4.819s
removing stale ckpt [epoch 16] [took 0.15s]
 epoch          : 17
 loss           : 1.4592305035591127
 quant_reg      : 14.93496936416626
 quant_err      : 14.93496936416626
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.388
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.69050584278528
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.217
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.59584286320711
 mnt_best       : 46.072784899161675
 not_improved_count: 1
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.51595 (QuantReg: 14.73872) QuantErr: 14.73872 batch_time=35.41813 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.39849 (QuantReg: 14.84584) QuantErr: 14.84584 batch_time=0.64262 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.23512 (QuantReg: 14.86761) QuantErr: 14.86761 batch_time=0.65756 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.21318 (QuantReg: 14.95577) QuantErr: 14.95577 batch_time=0.60150 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.40431 (QuantReg: 14.73107) QuantErr: 14.73107 batch_time=0.60170 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.26040 (QuantReg: 15.10220) QuantErr: 15.10220 batch_time=0.63349 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.05216 (QuantReg: 15.22773) QuantErr: 15.22773 batch_time=0.68668 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.18787 (QuantReg: 15.03806) QuantErr: 15.03806 batch_time=0.61327 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.66602 (QuantReg: 15.06734) QuantErr: 15.06734 batch_time=0.64860 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.37147 (QuantReg: 14.84215) QuantErr: 14.84215 batch_time=0.63531 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.75211 (QuantReg: 14.90539) QuantErr: 14.90539 batch_time=0.61842 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.57868 (QuantReg: 14.93986) QuantErr: 14.93986 batch_time=0.71353 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.52817 (QuantReg: 14.95520) QuantErr: 14.95520 batch_time=0.71479 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.69454 (QuantReg: 14.75505) QuantErr: 14.75505 batch_time=0.59515 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.55624 (QuantReg: 14.82053) QuantErr: 14.82053 batch_time=0.66864 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.49256 (QuantReg: 15.23168) QuantErr: 15.23168 batch_time=0.60138 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.29587 (QuantReg: 14.95549) QuantErr: 14.95549 batch_time=0.62453 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.20835 (QuantReg: 15.08308) QuantErr: 15.08308 batch_time=0.66211 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.32279 (QuantReg: 15.15848) QuantErr: 15.15848 batch_time=2.74320 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.08193 (QuantReg: 15.20523) QuantErr: 15.20523 batch_time=0.60798 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.78651 (QuantReg: 14.91039) QuantErr: 14.91039 batch_time=0.60659 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.25615 (QuantReg: 15.01982) QuantErr: 15.01982 batch_time=0.61777 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.43191 (QuantReg: 15.08445) QuantErr: 15.08445 batch_time=0.60406 
Train Epoch: 18 codebook_update_time=3.69019
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch18.pth ...
Done in 4.698s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch18.pth ...
Done in 9.339s
removing stale ckpt [epoch 17] [took 0.02s]
 epoch          : 18
 loss           : 1.399221589565277
 quant_reg      : 14.98605540084839
 quant_err      : 14.98605540084839
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.57
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.11979518878253
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1385
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.88887887696562
 mnt_best       : 46.11979518878253
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.16126 (QuantReg: 14.98719) QuantErr: 14.98719 batch_time=35.02848 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.29037 (QuantReg: 14.96809) QuantErr: 14.96809 batch_time=0.59612 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.54693 (QuantReg: 14.66541) QuantErr: 14.66541 batch_time=0.59542 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.61541 (QuantReg: 14.78312) QuantErr: 14.78312 batch_time=0.61427 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.30158 (QuantReg: 14.89591) QuantErr: 14.89591 batch_time=0.60476 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 0.98105 (QuantReg: 15.01017) QuantErr: 15.01017 batch_time=0.59942 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.03383 (QuantReg: 15.04159) QuantErr: 15.04159 batch_time=0.62430 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.21866 (QuantReg: 14.92532) QuantErr: 14.92532 batch_time=0.65540 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.17863 (QuantReg: 15.10601) QuantErr: 15.10601 batch_time=0.59782 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.59910 (QuantReg: 14.78387) QuantErr: 14.78387 batch_time=0.64596 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.38254 (QuantReg: 14.79678) QuantErr: 14.79678 batch_time=0.63034 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.12855 (QuantReg: 15.16109) QuantErr: 15.16109 batch_time=0.60955 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.41905 (QuantReg: 15.21872) QuantErr: 15.21872 batch_time=0.88983 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.48164 (QuantReg: 14.96736) QuantErr: 14.96736 batch_time=0.63071 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.68958 (QuantReg: 14.88919) QuantErr: 14.88919 batch_time=0.66730 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.00345 (QuantReg: 14.97363) QuantErr: 14.97363 batch_time=1.74434 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.27518 (QuantReg: 14.92496) QuantErr: 14.92496 batch_time=0.77968 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.42129 (QuantReg: 15.06335) QuantErr: 15.06335 batch_time=1.05835 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.41507 (QuantReg: 14.87075) QuantErr: 14.87075 batch_time=0.60399 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.36769 (QuantReg: 15.00472) QuantErr: 15.00472 batch_time=0.98677 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.43731 (QuantReg: 15.06370) QuantErr: 15.06370 batch_time=0.64440 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.79252 (QuantReg: 15.06413) QuantErr: 15.06413 batch_time=0.59777 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.44869 (QuantReg: 15.25034) QuantErr: 15.25034 batch_time=0.60238 
Train Epoch: 19 codebook_update_time=3.58008
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch19.pth ...
Done in 4.807s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch19.pth ...
Done in 9.791s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 1.3725321772098542
 quant_reg      : 15.000696701049804
 quant_err      : 15.000696701049804
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.96
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.169819684707534
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.893
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.96823083198714
 mnt_best       : 46.169819684707534
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 0.98257 (QuantReg: 15.03309) QuantErr: 15.03309 batch_time=41.57288 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.27848 (QuantReg: 14.91377) QuantErr: 14.91377 batch_time=0.60441 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.21936 (QuantReg: 14.94742) QuantErr: 14.94742 batch_time=0.62102 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.09006 (QuantReg: 14.75463) QuantErr: 14.75463 batch_time=0.66099 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.39785 (QuantReg: 14.78255) QuantErr: 14.78255 batch_time=0.60586 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.20479 (QuantReg: 15.06114) QuantErr: 15.06114 batch_time=0.65424 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.05101 (QuantReg: 15.13376) QuantErr: 15.13376 batch_time=0.62327 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.41426 (QuantReg: 15.01003) QuantErr: 15.01003 batch_time=0.62130 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.33585 (QuantReg: 15.04630) QuantErr: 15.04630 batch_time=0.61232 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.02333 (QuantReg: 15.08373) QuantErr: 15.08373 batch_time=0.64403 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.41035 (QuantReg: 14.88660) QuantErr: 14.88660 batch_time=0.64603 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.46999 (QuantReg: 15.12850) QuantErr: 15.12850 batch_time=0.63748 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.26399 (QuantReg: 14.87349) QuantErr: 14.87349 batch_time=0.67451 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.26271 (QuantReg: 15.10796) QuantErr: 15.10796 batch_time=0.71360 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.31858 (QuantReg: 14.99425) QuantErr: 14.99425 batch_time=0.61816 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.48809 (QuantReg: 15.14188) QuantErr: 15.14188 batch_time=0.63792 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.37132 (QuantReg: 15.02486) QuantErr: 15.02486 batch_time=0.60823 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.25498 (QuantReg: 15.01741) QuantErr: 15.01741 batch_time=0.61956 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.36189 (QuantReg: 15.11747) QuantErr: 15.11747 batch_time=0.71265 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.10165 (QuantReg: 15.00176) QuantErr: 15.00176 batch_time=1.88429 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.40076 (QuantReg: 15.09778) QuantErr: 15.09778 batch_time=0.59402 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.38442 (QuantReg: 15.14173) QuantErr: 15.14173 batch_time=0.61779 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.41961 (QuantReg: 15.12785) QuantErr: 15.12785 batch_time=0.65945 
Train Epoch: 20 codebook_update_time=3.56526
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch20.pth ...
Done in 5.168s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch20.pth ...
Done in 10.508s
removing stale ckpt [epoch 19] [took 0.11s]
 epoch          : 20
 loss           : 1.3456821377277375
 quant_reg      : 15.015622844696045
 quant_err      : 15.015622844696045
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.81
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.28277172814775
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 59.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.96
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.729077047201564
 mnt_best       : 46.28277172814775
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.47052 (QuantReg: 15.03274) QuantErr: 15.03274 batch_time=35.32074 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.25481 (QuantReg: 15.13144) QuantErr: 15.13144 batch_time=0.63658 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.44904 (QuantReg: 15.07750) QuantErr: 15.07750 batch_time=0.63100 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.55567 (QuantReg: 14.86635) QuantErr: 14.86635 batch_time=0.59752 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.17465 (QuantReg: 14.67796) QuantErr: 14.67796 batch_time=0.60235 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.19084 (QuantReg: 15.00868) QuantErr: 15.00868 batch_time=0.66187 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.84642 (QuantReg: 14.81086) QuantErr: 14.81086 batch_time=3.39767 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.32563 (QuantReg: 14.90868) QuantErr: 14.90868 batch_time=0.60554 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.17779 (QuantReg: 15.04521) QuantErr: 15.04521 batch_time=1.46375 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.23865 (QuantReg: 14.87929) QuantErr: 14.87929 batch_time=0.60637 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.13124 (QuantReg: 15.17544) QuantErr: 15.17544 batch_time=0.59778 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.13108 (QuantReg: 14.92599) QuantErr: 14.92599 batch_time=0.65669 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.25255 (QuantReg: 15.08689) QuantErr: 15.08689 batch_time=0.61943 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.12653 (QuantReg: 15.00619) QuantErr: 15.00619 batch_time=0.66470 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.46463 (QuantReg: 14.84801) QuantErr: 14.84801 batch_time=0.61403 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.26175 (QuantReg: 15.24433) QuantErr: 15.24433 batch_time=0.59326 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.34653 (QuantReg: 14.84616) QuantErr: 14.84616 batch_time=0.63441 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.31813 (QuantReg: 14.97117) QuantErr: 14.97117 batch_time=0.71921 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.39189 (QuantReg: 15.11679) QuantErr: 15.11679 batch_time=0.60516 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.53649 (QuantReg: 14.76044) QuantErr: 14.76044 batch_time=1.56939 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.36135 (QuantReg: 15.23283) QuantErr: 15.23283 batch_time=0.62901 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.29665 (QuantReg: 15.27288) QuantErr: 15.27288 batch_time=0.61037 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.38735 (QuantReg: 15.11354) QuantErr: 15.11354 batch_time=0.61036 
Train Epoch: 21 codebook_update_time=3.55288
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch21.pth ...
Done in 4.882s
removing stale ckpt [epoch 20] [took 0.05s]
 epoch          : 21
 loss           : 1.3224262566566467
 quant_reg      : 15.02225701904297
 quant_err      : 15.02225701904297
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.87
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.00098548613356
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.411
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.022529413092876
 mnt_best       : 46.28277172814775
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.47294 (QuantReg: 14.95655) QuantErr: 14.95655 batch_time=39.81678 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.10406 (QuantReg: 15.13822) QuantErr: 15.13822 batch_time=0.59686 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.34930 (QuantReg: 15.13946) QuantErr: 15.13946 batch_time=0.63986 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.47212 (QuantReg: 14.85791) QuantErr: 14.85791 batch_time=0.67827 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.76041 (QuantReg: 15.06233) QuantErr: 15.06233 batch_time=0.68759 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.38971 (QuantReg: 14.86113) QuantErr: 14.86113 batch_time=0.60975 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.61504 (QuantReg: 15.11488) QuantErr: 15.11488 batch_time=0.63336 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.26583 (QuantReg: 15.04357) QuantErr: 15.04357 batch_time=0.60896 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.38372 (QuantReg: 15.08006) QuantErr: 15.08006 batch_time=0.64842 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.43469 (QuantReg: 14.79196) QuantErr: 14.79196 batch_time=0.61397 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.27110 (QuantReg: 15.25951) QuantErr: 15.25951 batch_time=0.65365 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.24803 (QuantReg: 14.87282) QuantErr: 14.87282 batch_time=0.63857 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.05688 (QuantReg: 15.04915) QuantErr: 15.04915 batch_time=0.70554 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.39724 (QuantReg: 14.84579) QuantErr: 14.84579 batch_time=1.13612 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.12080 (QuantReg: 14.93467) QuantErr: 14.93467 batch_time=0.60160 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.67693 (QuantReg: 15.09484) QuantErr: 15.09484 batch_time=0.69008 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.06543 (QuantReg: 15.13647) QuantErr: 15.13647 batch_time=0.64664 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.05733 (QuantReg: 14.93434) QuantErr: 14.93434 batch_time=0.61991 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.07956 (QuantReg: 15.05053) QuantErr: 15.05053 batch_time=0.60666 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.12815 (QuantReg: 15.20091) QuantErr: 15.20091 batch_time=0.67941 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.66944 (QuantReg: 15.15630) QuantErr: 15.15630 batch_time=1.29243 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 0.99624 (QuantReg: 15.26205) QuantErr: 15.26205 batch_time=0.61520 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.29011 (QuantReg: 15.27832) QuantErr: 15.27832 batch_time=0.67383 
Train Epoch: 22 codebook_update_time=3.59934
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch22.pth ...
Done in 5.956s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch22.pth ...
Done in 11.985s
removing stale ckpt [epoch 21] [took 0.14s]
 epoch          : 22
 loss           : 1.2996747558116912
 quant_reg      : 15.047645790100098
 quant_err      : 15.047645790100098
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.286
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.69430086642299
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.76
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.816912449945065
 mnt_best       : 46.69430086642299
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.21358 (QuantReg: 15.04235) QuantErr: 15.04235 batch_time=35.19523 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.11274 (QuantReg: 14.95364) QuantErr: 14.95364 batch_time=0.62670 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.57118 (QuantReg: 15.08182) QuantErr: 15.08182 batch_time=0.61453 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.47889 (QuantReg: 14.89267) QuantErr: 14.89267 batch_time=0.59716 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.24186 (QuantReg: 14.96014) QuantErr: 14.96014 batch_time=0.65166 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.37831 (QuantReg: 14.97187) QuantErr: 14.97187 batch_time=0.66428 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.16069 (QuantReg: 14.90185) QuantErr: 14.90185 batch_time=0.67541 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.39495 (QuantReg: 14.86680) QuantErr: 14.86680 batch_time=0.68649 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.26119 (QuantReg: 15.14505) QuantErr: 15.14505 batch_time=0.62275 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.63693 (QuantReg: 14.98782) QuantErr: 14.98782 batch_time=0.63164 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.05224 (QuantReg: 14.86639) QuantErr: 14.86639 batch_time=0.62942 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.20360 (QuantReg: 14.74797) QuantErr: 14.74797 batch_time=0.64158 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.34748 (QuantReg: 15.16588) QuantErr: 15.16588 batch_time=0.65527 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.12896 (QuantReg: 15.16516) QuantErr: 15.16516 batch_time=0.60175 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.43633 (QuantReg: 15.02678) QuantErr: 15.02678 batch_time=0.62606 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.21218 (QuantReg: 15.03771) QuantErr: 15.03771 batch_time=0.59819 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.35682 (QuantReg: 15.11758) QuantErr: 15.11758 batch_time=0.65374 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 0.92857 (QuantReg: 14.98846) QuantErr: 14.98846 batch_time=0.64574 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.26284 (QuantReg: 15.00939) QuantErr: 15.00939 batch_time=0.63711 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.46687 (QuantReg: 15.02884) QuantErr: 15.02884 batch_time=0.65110 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.35791 (QuantReg: 15.03934) QuantErr: 15.03934 batch_time=0.61882 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.03377 (QuantReg: 15.18990) QuantErr: 15.18990 batch_time=1.73992 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.16308 (QuantReg: 14.99869) QuantErr: 14.99869 batch_time=0.66728 
Train Epoch: 23 codebook_update_time=3.56748
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch23.pth ...
Done in 4.256s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 1.2588583323955536
 quant_reg      : 15.045610424041747
 quant_err      : 15.045610424041747
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.376
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.359542866021144
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.1705
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.21502590902605
 mnt_best       : 46.69430086642299
 not_improved_count: 1
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.31291 (QuantReg: 14.96826) QuantErr: 14.96826 batch_time=38.88138 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.01155 (QuantReg: 14.96170) QuantErr: 14.96170 batch_time=0.60262 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.17477 (QuantReg: 14.66780) QuantErr: 14.66780 batch_time=0.64936 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.32358 (QuantReg: 14.94495) QuantErr: 14.94495 batch_time=0.74315 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.50896 (QuantReg: 14.89433) QuantErr: 14.89433 batch_time=0.64178 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.22837 (QuantReg: 15.07908) QuantErr: 15.07908 batch_time=0.61490 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.25057 (QuantReg: 14.80388) QuantErr: 14.80388 batch_time=0.69931 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.38919 (QuantReg: 15.01659) QuantErr: 15.01659 batch_time=0.62795 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.22597 (QuantReg: 15.05254) QuantErr: 15.05254 batch_time=0.60098 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.15934 (QuantReg: 14.94922) QuantErr: 14.94922 batch_time=0.67746 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.43086 (QuantReg: 15.11220) QuantErr: 15.11220 batch_time=0.60435 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.30281 (QuantReg: 15.11947) QuantErr: 15.11947 batch_time=0.61177 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.01855 (QuantReg: 15.11236) QuantErr: 15.11236 batch_time=0.60240 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.14715 (QuantReg: 14.93103) QuantErr: 14.93103 batch_time=0.59695 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.29513 (QuantReg: 15.10555) QuantErr: 15.10555 batch_time=0.59749 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.54427 (QuantReg: 15.03971) QuantErr: 15.03971 batch_time=0.60078 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.95689 (QuantReg: 15.27312) QuantErr: 15.27312 batch_time=0.61041 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.34767 (QuantReg: 15.23273) QuantErr: 15.23273 batch_time=0.69452 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.28968 (QuantReg: 14.97852) QuantErr: 14.97852 batch_time=0.65793 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 0.96543 (QuantReg: 15.14219) QuantErr: 15.14219 batch_time=0.68836 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.18487 (QuantReg: 15.31578) QuantErr: 15.31578 batch_time=0.62843 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.08474 (QuantReg: 15.12678) QuantErr: 15.12678 batch_time=0.60710 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.03483 (QuantReg: 15.01673) QuantErr: 15.01673 batch_time=0.65593 
Train Epoch: 24 codebook_update_time=3.80848
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch24.pth ...
Done in 5.232s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 1.2308929824829102
 quant_reg      : 15.07756992340088
 quant_err      : 15.07756992340088
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.452
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.28181127771638
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.253
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.66343966347897
 mnt_best       : 46.69430086642299
 not_improved_count: 2
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.18686 (QuantReg: 15.07934) QuantErr: 15.07934 batch_time=36.83194 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.02910 (QuantReg: 15.05293) QuantErr: 15.05293 batch_time=0.64197 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.15469 (QuantReg: 15.20084) QuantErr: 15.20084 batch_time=0.61784 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.08812 (QuantReg: 15.03996) QuantErr: 15.03996 batch_time=0.65803 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.07391 (QuantReg: 15.24395) QuantErr: 15.24395 batch_time=0.59840 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 0.90191 (QuantReg: 15.16614) QuantErr: 15.16614 batch_time=0.65229 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.46335 (QuantReg: 15.18850) QuantErr: 15.18850 batch_time=5.33624 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.35111 (QuantReg: 14.99014) QuantErr: 14.99014 batch_time=0.63952 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.35215 (QuantReg: 14.94731) QuantErr: 14.94731 batch_time=0.61003 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.22561 (QuantReg: 15.12023) QuantErr: 15.12023 batch_time=1.30316 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.43585 (QuantReg: 15.09593) QuantErr: 15.09593 batch_time=0.61569 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.59768 (QuantReg: 15.01731) QuantErr: 15.01731 batch_time=0.60782 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 0.97890 (QuantReg: 15.00821) QuantErr: 15.00821 batch_time=0.60471 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.03448 (QuantReg: 15.19457) QuantErr: 15.19457 batch_time=0.61418 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.07980 (QuantReg: 15.08837) QuantErr: 15.08837 batch_time=0.72325 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.61127 (QuantReg: 14.88417) QuantErr: 14.88417 batch_time=0.62803 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.10807 (QuantReg: 15.28981) QuantErr: 15.28981 batch_time=0.59957 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.05655 (QuantReg: 15.08076) QuantErr: 15.08076 batch_time=1.03662 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.93050 (QuantReg: 15.23307) QuantErr: 15.23307 batch_time=0.59685 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.18630 (QuantReg: 15.06533) QuantErr: 15.06533 batch_time=0.59872 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.49615 (QuantReg: 15.11233) QuantErr: 15.11233 batch_time=1.01234 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 0.87307 (QuantReg: 15.30494) QuantErr: 15.30494 batch_time=0.64375 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.25449 (QuantReg: 15.22620) QuantErr: 15.22620 batch_time=1.32655 
Train Epoch: 25 codebook_update_time=3.40912
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch25.pth ...
Done in 9.824s
removing stale ckpt [epoch 24] [took 0.09s]
 epoch          : 25
 loss           : 1.2012341413497925
 quant_reg      : 15.101126121520997
 quant_err      : 15.101126121520997
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.184
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.48722692295065
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.119
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.16597258286232
 mnt_best       : 46.69430086642299
 not_improved_count: 3
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.25984 (QuantReg: 14.97501) QuantErr: 14.97501 batch_time=35.60485 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.20917 (QuantReg: 14.98351) QuantErr: 14.98351 batch_time=0.62049 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.36898 (QuantReg: 15.12881) QuantErr: 15.12881 batch_time=0.67993 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.35691 (QuantReg: 15.09933) QuantErr: 15.09933 batch_time=0.60805 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.24691 (QuantReg: 15.04510) QuantErr: 15.04510 batch_time=0.62398 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.07527 (QuantReg: 15.28486) QuantErr: 15.28486 batch_time=0.58339 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 0.91917 (QuantReg: 15.06911) QuantErr: 15.06911 batch_time=0.61453 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.26806 (QuantReg: 15.14864) QuantErr: 15.14864 batch_time=0.73851 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.25262 (QuantReg: 14.94984) QuantErr: 14.94984 batch_time=0.63251 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 0.91783 (QuantReg: 15.15353) QuantErr: 15.15353 batch_time=0.64080 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.01537 (QuantReg: 15.11598) QuantErr: 15.11598 batch_time=0.62924 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.29954 (QuantReg: 15.14187) QuantErr: 15.14187 batch_time=0.67413 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.27485 (QuantReg: 15.14245) QuantErr: 15.14245 batch_time=6.56846 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.31194 (QuantReg: 14.73953) QuantErr: 14.73953 batch_time=0.62395 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.43371 (QuantReg: 15.25412) QuantErr: 15.25412 batch_time=0.66998 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.14917 (QuantReg: 15.14909) QuantErr: 15.14909 batch_time=0.64213 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.15248 (QuantReg: 15.21601) QuantErr: 15.21601 batch_time=0.70414 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.33063 (QuantReg: 15.05857) QuantErr: 15.05857 batch_time=0.59766 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.15494 (QuantReg: 14.86171) QuantErr: 14.86171 batch_time=0.60979 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.25775 (QuantReg: 15.18493) QuantErr: 15.18493 batch_time=0.61661 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.10905 (QuantReg: 15.31172) QuantErr: 15.31172 batch_time=1.69125 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.28965 (QuantReg: 15.30161) QuantErr: 15.30161 batch_time=0.61516 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.13278 (QuantReg: 15.33569) QuantErr: 15.33569 batch_time=0.62075 
Train Epoch: 26 codebook_update_time=3.64292
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch26.pth ...
Done in 4.984s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch26.pth ...
Done in 27.510s
removing stale ckpt [epoch 25] [took 0.01s]
 epoch          : 26
 loss           : 1.2094738137722016
 quant_reg      : 15.071308460235596
 quant_err      : 15.071308460235596
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.032
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.960995858274444
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.91
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.442320088400464
 mnt_best       : 46.960995858274444
 not_improved_count: 0
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.19880 (QuantReg: 15.07073) QuantErr: 15.07073 batch_time=34.09495 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.18796 (QuantReg: 14.96014) QuantErr: 14.96014 batch_time=0.60406 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.24014 (QuantReg: 14.99773) QuantErr: 14.99773 batch_time=1.17568 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.24405 (QuantReg: 15.10547) QuantErr: 15.10547 batch_time=0.59459 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.11383 (QuantReg: 14.88804) QuantErr: 14.88804 batch_time=0.61649 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.14826 (QuantReg: 15.06265) QuantErr: 15.06265 batch_time=0.75788 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.08363 (QuantReg: 15.17595) QuantErr: 15.17595 batch_time=0.62988 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.26696 (QuantReg: 15.06553) QuantErr: 15.06553 batch_time=0.66063 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.33818 (QuantReg: 15.08595) QuantErr: 15.08595 batch_time=0.64445 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.17594 (QuantReg: 15.39466) QuantErr: 15.39466 batch_time=0.62645 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.16865 (QuantReg: 15.16284) QuantErr: 15.16284 batch_time=0.70585 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.14848 (QuantReg: 14.81477) QuantErr: 14.81477 batch_time=0.69198 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.01426 (QuantReg: 15.19501) QuantErr: 15.19501 batch_time=0.72355 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.22357 (QuantReg: 15.08421) QuantErr: 15.08421 batch_time=0.65458 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.16327 (QuantReg: 15.30209) QuantErr: 15.30209 batch_time=0.60817 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.39383 (QuantReg: 15.00859) QuantErr: 15.00859 batch_time=0.61013 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.30976 (QuantReg: 15.12938) QuantErr: 15.12938 batch_time=0.66800 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 0.93365 (QuantReg: 15.28341) QuantErr: 15.28341 batch_time=0.62354 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.21952 (QuantReg: 14.81156) QuantErr: 14.81156 batch_time=0.64642 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.42661 (QuantReg: 15.32916) QuantErr: 15.32916 batch_time=0.65760 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 0.97561 (QuantReg: 15.04897) QuantErr: 15.04897 batch_time=0.60798 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.37753 (QuantReg: 14.94673) QuantErr: 14.94673 batch_time=0.64297 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 0.98475 (QuantReg: 15.20753) QuantErr: 15.20753 batch_time=0.63519 
Train Epoch: 27 codebook_update_time=3.62847
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch27.pth ...
Done in 4.697s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch27.pth ...
Done in 8.838s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 1.1825743625164031
 quant_reg      : 15.10523253250122
 quant_err      : 15.10523253250122
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.646
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.98765255849094
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.996
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.82724309920411
 mnt_best       : 46.98765255849094
 not_improved_count: 0
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.01690 (QuantReg: 14.89385) QuantErr: 14.89385 batch_time=43.51545 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.28184 (QuantReg: 15.16877) QuantErr: 15.16877 batch_time=0.62792 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.83473 (QuantReg: 15.14579) QuantErr: 15.14579 batch_time=0.63912 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 0.95532 (QuantReg: 15.12432) QuantErr: 15.12432 batch_time=0.61270 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 0.90422 (QuantReg: 15.28264) QuantErr: 15.28264 batch_time=1.43461 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.08075 (QuantReg: 15.08237) QuantErr: 15.08237 batch_time=0.62148 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.40928 (QuantReg: 14.99574) QuantErr: 14.99574 batch_time=0.65880 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.13673 (QuantReg: 15.10900) QuantErr: 15.10900 batch_time=0.65639 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.74448 (QuantReg: 14.98004) QuantErr: 14.98004 batch_time=0.63331 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.33817 (QuantReg: 15.28226) QuantErr: 15.28226 batch_time=0.62580 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.25620 (QuantReg: 15.26404) QuantErr: 15.26404 batch_time=0.64742 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 0.94401 (QuantReg: 15.10234) QuantErr: 15.10234 batch_time=0.88222 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.42776 (QuantReg: 15.13406) QuantErr: 15.13406 batch_time=0.61657 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.13030 (QuantReg: 14.98595) QuantErr: 14.98595 batch_time=0.60754 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.26976 (QuantReg: 15.22874) QuantErr: 15.22874 batch_time=0.63270 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.16618 (QuantReg: 15.27697) QuantErr: 15.27697 batch_time=0.64144 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.18590 (QuantReg: 15.16749) QuantErr: 15.16749 batch_time=0.59272 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 0.99376 (QuantReg: 15.36188) QuantErr: 15.36188 batch_time=0.70554 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.18005 (QuantReg: 14.92808) QuantErr: 14.92808 batch_time=0.59003 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 0.92545 (QuantReg: 15.27953) QuantErr: 15.27953 batch_time=0.59148 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 0.93412 (QuantReg: 15.27179) QuantErr: 15.27179 batch_time=0.61707 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.07920 (QuantReg: 15.33266) QuantErr: 15.33266 batch_time=0.61659 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.25658 (QuantReg: 15.26309) QuantErr: 15.26309 batch_time=0.62590 
Train Epoch: 28 codebook_update_time=3.33779
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch28.pth ...
Done in 4.964s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 1.153277983188629
 quant_reg      : 15.120746337890624
 quant_err      : 15.120746337890624
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.052
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.10501370427628
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.048
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.80093123405726
 mnt_best       : 46.98765255849094
 not_improved_count: 1
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.57816 (QuantReg: 14.98487) QuantErr: 14.98487 batch_time=44.88331 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.27386 (QuantReg: 15.06129) QuantErr: 15.06129 batch_time=0.62966 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.11046 (QuantReg: 15.23586) QuantErr: 15.23586 batch_time=0.60828 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.09695 (QuantReg: 14.91686) QuantErr: 14.91686 batch_time=0.66562 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.42645 (QuantReg: 14.96702) QuantErr: 14.96702 batch_time=0.67396 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.09670 (QuantReg: 15.12074) QuantErr: 15.12074 batch_time=0.61615 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.04292 (QuantReg: 15.09250) QuantErr: 15.09250 batch_time=0.61393 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.01849 (QuantReg: 15.24612) QuantErr: 15.24612 batch_time=0.60941 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.16436 (QuantReg: 15.17471) QuantErr: 15.17471 batch_time=0.60031 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.23650 (QuantReg: 15.30105) QuantErr: 15.30105 batch_time=0.64026 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.63621 (QuantReg: 15.08776) QuantErr: 15.08776 batch_time=0.60343 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.06291 (QuantReg: 15.05805) QuantErr: 15.05805 batch_time=0.77689 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.49979 (QuantReg: 15.06876) QuantErr: 15.06876 batch_time=0.60201 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.06969 (QuantReg: 15.13103) QuantErr: 15.13103 batch_time=0.63414 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 0.93109 (QuantReg: 15.37410) QuantErr: 15.37410 batch_time=0.64209 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.24578 (QuantReg: 15.08039) QuantErr: 15.08039 batch_time=0.60941 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.09400 (QuantReg: 15.19824) QuantErr: 15.19824 batch_time=0.64900 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.16569 (QuantReg: 15.19989) QuantErr: 15.19989 batch_time=0.70521 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.31299 (QuantReg: 14.97122) QuantErr: 14.97122 batch_time=0.62499 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.11383 (QuantReg: 15.16706) QuantErr: 15.16706 batch_time=0.61711 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.08798 (QuantReg: 14.99504) QuantErr: 14.99504 batch_time=0.59126 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.67665 (QuantReg: 15.36828) QuantErr: 15.36828 batch_time=0.93913 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.31112 (QuantReg: 15.08017) QuantErr: 15.08017 batch_time=0.62044 
Train Epoch: 29 codebook_update_time=3.43585
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch29.pth ...
Done in 5.123s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 1.1345487740039826
 quant_reg      : 15.119425998687744
 quant_err      : 15.119425998687744
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.786
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.64645235626799
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.332
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.18774399300763
 mnt_best       : 46.98765255849094
 not_improved_count: 2
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.02576 (QuantReg: 15.18360) QuantErr: 15.18360 batch_time=40.35409 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.15550 (QuantReg: 14.80537) QuantErr: 14.80537 batch_time=2.51460 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 0.99863 (QuantReg: 14.86373) QuantErr: 14.86373 batch_time=0.61603 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 0.93496 (QuantReg: 15.09393) QuantErr: 15.09393 batch_time=0.63431 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.13412 (QuantReg: 15.09270) QuantErr: 15.09270 batch_time=0.62723 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.12503 (QuantReg: 15.12121) QuantErr: 15.12121 batch_time=0.61082 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.38409 (QuantReg: 15.20227) QuantErr: 15.20227 batch_time=0.61125 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.02105 (QuantReg: 15.24615) QuantErr: 15.24615 batch_time=0.64848 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.16991 (QuantReg: 14.97785) QuantErr: 14.97785 batch_time=0.66055 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.17214 (QuantReg: 15.28626) QuantErr: 15.28626 batch_time=0.60443 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.07927 (QuantReg: 15.20698) QuantErr: 15.20698 batch_time=0.94764 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 0.94568 (QuantReg: 15.24305) QuantErr: 15.24305 batch_time=0.60897 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 0.90261 (QuantReg: 15.36396) QuantErr: 15.36396 batch_time=0.64099 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.32054 (QuantReg: 15.23069) QuantErr: 15.23069 batch_time=0.62887 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.46328 (QuantReg: 15.12332) QuantErr: 15.12332 batch_time=1.03908 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.02969 (QuantReg: 15.22315) QuantErr: 15.22315 batch_time=0.62014 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.28980 (QuantReg: 14.79980) QuantErr: 14.79980 batch_time=0.64318 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.27489 (QuantReg: 14.88826) QuantErr: 14.88826 batch_time=1.01223 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 0.92937 (QuantReg: 15.17849) QuantErr: 15.17849 batch_time=0.66404 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.51240 (QuantReg: 15.29133) QuantErr: 15.29133 batch_time=0.61348 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.00989 (QuantReg: 15.23619) QuantErr: 15.23619 batch_time=0.62506 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.07319 (QuantReg: 15.19662) QuantErr: 15.19662 batch_time=0.61850 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 0.98753 (QuantReg: 15.33899) QuantErr: 15.33899 batch_time=0.64933 
Train Epoch: 30 codebook_update_time=3.51219
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch30.pth ...
Done in 4.820s
removing stale ckpt [epoch 29] [took 0.01s]
 epoch          : 30
 loss           : 1.1356066348552705
 quant_reg      : 15.126950290679932
 quant_err      : 15.126950290679932
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.956
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.30221367817913
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9885
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.32635308241678
 mnt_best       : 46.98765255849094
 not_improved_count: 3
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.28822 (QuantReg: 15.06747) QuantErr: 15.06747 batch_time=39.42333 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.08435 (QuantReg: 14.96442) QuantErr: 14.96442 batch_time=0.68627 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.01366 (QuantReg: 14.73876) QuantErr: 14.73876 batch_time=0.61464 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.32532 (QuantReg: 14.92044) QuantErr: 14.92044 batch_time=0.61780 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.06236 (QuantReg: 15.24540) QuantErr: 15.24540 batch_time=0.62779 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.28835 (QuantReg: 14.95905) QuantErr: 14.95905 batch_time=0.62201 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.04824 (QuantReg: 15.24943) QuantErr: 15.24943 batch_time=0.62542 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 0.93094 (QuantReg: 15.19646) QuantErr: 15.19646 batch_time=0.66628 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.10262 (QuantReg: 14.89167) QuantErr: 14.89167 batch_time=0.65788 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.16107 (QuantReg: 15.30997) QuantErr: 15.30997 batch_time=1.57186 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.13859 (QuantReg: 15.31495) QuantErr: 15.31495 batch_time=0.61453 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 0.94821 (QuantReg: 15.07756) QuantErr: 15.07756 batch_time=0.64159 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 0.95110 (QuantReg: 15.19576) QuantErr: 15.19576 batch_time=0.64258 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.26786 (QuantReg: 14.88852) QuantErr: 14.88852 batch_time=0.64770 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.00600 (QuantReg: 15.19781) QuantErr: 15.19781 batch_time=0.64595 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.04351 (QuantReg: 15.15717) QuantErr: 15.15717 batch_time=0.63836 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 0.97142 (QuantReg: 15.22420) QuantErr: 15.22420 batch_time=0.58753 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.16639 (QuantReg: 15.07318) QuantErr: 15.07318 batch_time=0.62150 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 0.98965 (QuantReg: 15.21625) QuantErr: 15.21625 batch_time=0.65114 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.12888 (QuantReg: 14.99167) QuantErr: 14.99167 batch_time=1.59067 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.01184 (QuantReg: 15.04878) QuantErr: 15.04878 batch_time=0.61892 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.16496 (QuantReg: 15.24648) QuantErr: 15.24648 batch_time=0.62406 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.28220 (QuantReg: 14.78673) QuantErr: 14.78673 batch_time=0.62341 
Train Epoch: 31 codebook_update_time=3.56048
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch31.pth ...
Done in 4.524s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.1197836751937866
 quant_reg      : 15.156952262878418
 quant_err      : 15.156952262878418
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.558
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.72246640510317
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.9585
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.53615179141239
 mnt_best       : 46.98765255849094
 not_improved_count: 4
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.15934 (QuantReg: 14.91856) QuantErr: 14.91856 batch_time=36.41585 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.22851 (QuantReg: 15.11162) QuantErr: 15.11162 batch_time=0.60870 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.35450 (QuantReg: 15.28642) QuantErr: 15.28642 batch_time=1.48818 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.06963 (QuantReg: 14.85910) QuantErr: 14.85910 batch_time=0.66827 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.89998 (QuantReg: 15.16341) QuantErr: 15.16341 batch_time=0.59298 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 0.88776 (QuantReg: 15.13330) QuantErr: 15.13330 batch_time=0.61805 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.11428 (QuantReg: 15.13169) QuantErr: 15.13169 batch_time=0.61362 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.28541 (QuantReg: 15.33205) QuantErr: 15.33205 batch_time=0.61014 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 0.96708 (QuantReg: 15.32829) QuantErr: 15.32829 batch_time=0.68271 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.45803 (QuantReg: 14.94202) QuantErr: 14.94202 batch_time=0.62915 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.36667 (QuantReg: 14.94566) QuantErr: 14.94566 batch_time=0.59154 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.24673 (QuantReg: 15.05440) QuantErr: 15.05440 batch_time=0.76990 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.25277 (QuantReg: 15.01897) QuantErr: 15.01897 batch_time=0.97427 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.05762 (QuantReg: 15.24165) QuantErr: 15.24165 batch_time=4.64269 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.31651 (QuantReg: 14.97457) QuantErr: 14.97457 batch_time=0.96782 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.23586 (QuantReg: 15.07640) QuantErr: 15.07640 batch_time=0.64500 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.17226 (QuantReg: 15.00758) QuantErr: 15.00758 batch_time=0.61241 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.81948 (QuantReg: 15.35812) QuantErr: 15.35812 batch_time=0.65338 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.32568 (QuantReg: 14.98169) QuantErr: 14.98169 batch_time=0.62967 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.00307 (QuantReg: 15.24225) QuantErr: 15.24225 batch_time=0.67646 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.08405 (QuantReg: 15.09627) QuantErr: 15.09627 batch_time=0.59967 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 0.96646 (QuantReg: 15.32882) QuantErr: 15.32882 batch_time=0.64816 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.31449 (QuantReg: 15.18251) QuantErr: 15.18251 batch_time=0.63671 
Train Epoch: 32 codebook_update_time=3.29839
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch32.pth ...
Done in 4.510s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 1.11401070189476
 quant_reg      : 15.153491695404053
 quant_err      : 15.153491695404053
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.835
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.26274247386485
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.91
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.9721470704431
 mnt_best       : 46.98765255849094
 not_improved_count: 5
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.15621 (QuantReg: 15.06341) QuantErr: 15.06341 batch_time=33.29556 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.09718 (QuantReg: 15.26090) QuantErr: 15.26090 batch_time=0.88087 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.23030 (QuantReg: 14.99747) QuantErr: 14.99747 batch_time=0.75653 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.20958 (QuantReg: 15.13887) QuantErr: 15.13887 batch_time=0.61312 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.41217 (QuantReg: 14.81597) QuantErr: 14.81597 batch_time=0.61776 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.14082 (QuantReg: 15.22134) QuantErr: 15.22134 batch_time=0.62382 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.88640 (QuantReg: 15.14246) QuantErr: 15.14246 batch_time=1.79174 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 0.97513 (QuantReg: 15.11974) QuantErr: 15.11974 batch_time=0.61493 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.22475 (QuantReg: 14.92354) QuantErr: 14.92354 batch_time=0.63937 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.05291 (QuantReg: 15.24269) QuantErr: 15.24269 batch_time=0.62033 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.22231 (QuantReg: 14.95898) QuantErr: 14.95898 batch_time=0.61104 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.00245 (QuantReg: 15.17613) QuantErr: 15.17613 batch_time=0.63124 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.15637 (QuantReg: 15.12253) QuantErr: 15.12253 batch_time=0.65929 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 0.94322 (QuantReg: 15.18423) QuantErr: 15.18423 batch_time=0.61207 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.08618 (QuantReg: 15.29522) QuantErr: 15.29522 batch_time=0.60600 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.90735 (QuantReg: 15.23267) QuantErr: 15.23267 batch_time=0.67097 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.84294 (QuantReg: 15.22843) QuantErr: 15.22843 batch_time=0.61091 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.63448 (QuantReg: 15.27614) QuantErr: 15.27614 batch_time=0.61106 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.28748 (QuantReg: 15.03614) QuantErr: 15.03614 batch_time=5.87383 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.04481 (QuantReg: 15.06394) QuantErr: 15.06394 batch_time=0.61683 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.96149 (QuantReg: 15.16302) QuantErr: 15.16302 batch_time=0.63680 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.04769 (QuantReg: 15.12563) QuantErr: 15.12563 batch_time=0.65595 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.13729 (QuantReg: 15.18575) QuantErr: 15.18575 batch_time=0.64508 
Train Epoch: 33 codebook_update_time=3.54455
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch33.pth ...
Done in 23.538s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.0935585672855377
 quant_reg      : 15.1831353225708
 quant_err      : 15.1831353225708
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.283
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.84996004031662
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.904
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.7460299945041
 mnt_best       : 46.98765255849094
 not_improved_count: 6
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.07009 (QuantReg: 15.30035) QuantErr: 15.30035 batch_time=33.39935 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.00750 (QuantReg: 15.19064) QuantErr: 15.19064 batch_time=0.71595 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.20205 (QuantReg: 15.24628) QuantErr: 15.24628 batch_time=1.29417 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 0.77940 (QuantReg: 15.19247) QuantErr: 15.19247 batch_time=0.63925 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 0.79477 (QuantReg: 15.00188) QuantErr: 15.00188 batch_time=0.62808 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.21639 (QuantReg: 15.21804) QuantErr: 15.21804 batch_time=0.68756 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.90823 (QuantReg: 15.21756) QuantErr: 15.21756 batch_time=0.62838 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.17803 (QuantReg: 15.15433) QuantErr: 15.15433 batch_time=0.66717 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.26766 (QuantReg: 15.18474) QuantErr: 15.18474 batch_time=0.63606 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.26404 (QuantReg: 15.33292) QuantErr: 15.33292 batch_time=0.61968 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.09668 (QuantReg: 15.16484) QuantErr: 15.16484 batch_time=0.81424 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 0.95038 (QuantReg: 15.09521) QuantErr: 15.09521 batch_time=0.62281 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.01916 (QuantReg: 15.41797) QuantErr: 15.41797 batch_time=0.61626 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.09557 (QuantReg: 15.13099) QuantErr: 15.13099 batch_time=0.59242 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.19337 (QuantReg: 15.07814) QuantErr: 15.07814 batch_time=0.62231 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.02401 (QuantReg: 15.07236) QuantErr: 15.07236 batch_time=0.62537 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.22954 (QuantReg: 15.19775) QuantErr: 15.19775 batch_time=0.60485 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.04025 (QuantReg: 15.31933) QuantErr: 15.31933 batch_time=0.68280 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.16104 (QuantReg: 15.18641) QuantErr: 15.18641 batch_time=0.63096 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.08913 (QuantReg: 15.18982) QuantErr: 15.18982 batch_time=0.59423 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.05870 (QuantReg: 15.08549) QuantErr: 15.08549 batch_time=0.61842 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 0.97318 (QuantReg: 15.26557) QuantErr: 15.26557 batch_time=0.92491 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.22034 (QuantReg: 15.22358) QuantErr: 15.22358 batch_time=0.71450 
Train Epoch: 34 codebook_update_time=3.44333
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch34.pth ...
Done in 5.437s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch34.pth ...
Done in 10.242s
removing stale ckpt [epoch 33] [took 0.04s]
 epoch          : 34
 loss           : 1.0733221123218537
 quant_reg      : 15.187298900604247
 quant_err      : 15.187298900604247
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.19
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.10366360042054
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3025
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.10122635598396
 mnt_best       : 47.10366360042054
 not_improved_count: 0
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 0.89277 (QuantReg: 15.26062) QuantErr: 15.26062 batch_time=45.62393 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.29437 (QuantReg: 15.27765) QuantErr: 15.27765 batch_time=0.60274 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.24561 (QuantReg: 15.23370) QuantErr: 15.23370 batch_time=0.62195 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.15504 (QuantReg: 15.23987) QuantErr: 15.23987 batch_time=0.70546 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.14493 (QuantReg: 15.23172) QuantErr: 15.23172 batch_time=0.62650 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 0.96958 (QuantReg: 15.24670) QuantErr: 15.24670 batch_time=0.71953 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.15489 (QuantReg: 15.26025) QuantErr: 15.26025 batch_time=0.63169 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.12775 (QuantReg: 15.17398) QuantErr: 15.17398 batch_time=1.41771 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.04046 (QuantReg: 15.10296) QuantErr: 15.10296 batch_time=0.61207 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.34670 (QuantReg: 15.29947) QuantErr: 15.29947 batch_time=0.59612 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.91665 (QuantReg: 15.13529) QuantErr: 15.13529 batch_time=0.66557 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.09861 (QuantReg: 15.18411) QuantErr: 15.18411 batch_time=0.76636 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.06577 (QuantReg: 15.26539) QuantErr: 15.26539 batch_time=0.61956 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.01717 (QuantReg: 15.31840) QuantErr: 15.31840 batch_time=0.67607 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.35127 (QuantReg: 15.21315) QuantErr: 15.21315 batch_time=0.65496 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.94843 (QuantReg: 15.23121) QuantErr: 15.23121 batch_time=0.85904 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 0.98260 (QuantReg: 15.16996) QuantErr: 15.16996 batch_time=0.61378 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.18061 (QuantReg: 14.83104) QuantErr: 14.83104 batch_time=0.61080 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.24638 (QuantReg: 15.26697) QuantErr: 15.26697 batch_time=0.67654 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.08078 (QuantReg: 15.40697) QuantErr: 15.40697 batch_time=0.63104 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.83087 (QuantReg: 15.28359) QuantErr: 15.28359 batch_time=0.61226 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.00560 (QuantReg: 15.28388) QuantErr: 15.28388 batch_time=0.64741 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.00255 (QuantReg: 15.11561) QuantErr: 15.11561 batch_time=0.66712 
Train Epoch: 35 codebook_update_time=3.54798
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch35.pth ...
Done in 5.586s
removing stale ckpt [epoch 34] [took 0.01s]
 epoch          : 35
 loss           : 1.055705539226532
 quant_reg      : 15.197201179504395
 quant_err      : 15.197201179504395
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.131
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.83978691589404
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.156
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.330198523903974
 mnt_best       : 47.10366360042054
 not_improved_count: 1
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.08048 (QuantReg: 15.12232) QuantErr: 15.12232 batch_time=35.69807 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.23929 (QuantReg: 15.23220) QuantErr: 15.23220 batch_time=0.60465 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.77175 (QuantReg: 15.18512) QuantErr: 15.18512 batch_time=1.45435 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.32485 (QuantReg: 15.10346) QuantErr: 15.10346 batch_time=0.60049 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.13300 (QuantReg: 14.98983) QuantErr: 14.98983 batch_time=0.61904 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.73747 (QuantReg: 15.03476) QuantErr: 15.03476 batch_time=0.61989 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.12678 (QuantReg: 14.95181) QuantErr: 14.95181 batch_time=0.64567 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 0.98477 (QuantReg: 15.11940) QuantErr: 15.11940 batch_time=1.09025 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.13988 (QuantReg: 15.20268) QuantErr: 15.20268 batch_time=0.57099 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.00165 (QuantReg: 15.04106) QuantErr: 15.04106 batch_time=0.69906 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.12265 (QuantReg: 15.07060) QuantErr: 15.07060 batch_time=0.61504 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.26576 (QuantReg: 15.07964) QuantErr: 15.07964 batch_time=0.64903 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 0.92674 (QuantReg: 15.16301) QuantErr: 15.16301 batch_time=3.23239 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.09537 (QuantReg: 15.23216) QuantErr: 15.23216 batch_time=0.60805 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.33899 (QuantReg: 15.14900) QuantErr: 15.14900 batch_time=0.61152 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.91158 (QuantReg: 15.20684) QuantErr: 15.20684 batch_time=0.60824 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.14780 (QuantReg: 15.21865) QuantErr: 15.21865 batch_time=1.01732 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.07996 (QuantReg: 15.05303) QuantErr: 15.05303 batch_time=0.62651 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.91183 (QuantReg: 15.14045) QuantErr: 15.14045 batch_time=0.63546 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.98547 (QuantReg: 15.28445) QuantErr: 15.28445 batch_time=0.60547 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.87267 (QuantReg: 15.35742) QuantErr: 15.35742 batch_time=0.60575 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.93626 (QuantReg: 15.19107) QuantErr: 15.19107 batch_time=0.61337 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.75218 (QuantReg: 15.17017) QuantErr: 15.17017 batch_time=0.61861 
Train Epoch: 36 codebook_update_time=3.30615
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch36.pth ...
Done in 4.423s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 1.0608822510242462
 quant_reg      : 15.201403213500976
 quant_err      : 15.201403213500976
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.329
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.556743000677855
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.815
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.13116353958424
 mnt_best       : 47.10366360042054
 not_improved_count: 2
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.19884 (QuantReg: 15.15383) QuantErr: 15.15383 batch_time=43.51505 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 0.94855 (QuantReg: 15.29621) QuantErr: 15.29621 batch_time=0.61368 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.81695 (QuantReg: 15.23939) QuantErr: 15.23939 batch_time=0.59877 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.09563 (QuantReg: 15.09867) QuantErr: 15.09867 batch_time=0.60839 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 0.86969 (QuantReg: 15.35244) QuantErr: 15.35244 batch_time=0.63118 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 0.90616 (QuantReg: 15.07556) QuantErr: 15.07556 batch_time=0.62565 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.08535 (QuantReg: 14.97198) QuantErr: 14.97198 batch_time=3.73749 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.16051 (QuantReg: 15.39178) QuantErr: 15.39178 batch_time=0.66300 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.03516 (QuantReg: 15.18009) QuantErr: 15.18009 batch_time=0.68322 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.85173 (QuantReg: 15.28876) QuantErr: 15.28876 batch_time=0.59250 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.07200 (QuantReg: 15.16385) QuantErr: 15.16385 batch_time=0.65933 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.80364 (QuantReg: 15.16299) QuantErr: 15.16299 batch_time=0.63058 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.02327 (QuantReg: 15.21449) QuantErr: 15.21449 batch_time=0.59916 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.09763 (QuantReg: 15.26539) QuantErr: 15.26539 batch_time=0.60743 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.78508 (QuantReg: 15.40209) QuantErr: 15.40209 batch_time=0.59962 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.90825 (QuantReg: 15.24432) QuantErr: 15.24432 batch_time=0.71551 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.79413 (QuantReg: 15.22817) QuantErr: 15.22817 batch_time=0.68691 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.66934 (QuantReg: 15.42346) QuantErr: 15.42346 batch_time=0.61651 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.06642 (QuantReg: 15.02122) QuantErr: 15.02122 batch_time=0.65249 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.09319 (QuantReg: 15.34947) QuantErr: 15.34947 batch_time=0.66702 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.19247 (QuantReg: 15.11467) QuantErr: 15.11467 batch_time=0.77083 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.16851 (QuantReg: 15.31755) QuantErr: 15.31755 batch_time=0.64550 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.07267 (QuantReg: 15.57405) QuantErr: 15.57405 batch_time=0.60330 
Train Epoch: 37 codebook_update_time=3.18336
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch37.pth ...
Done in 4.415s
removing stale ckpt [epoch 36] [took 0.01s]
 epoch          : 37
 loss           : 1.0352043037414551
 quant_reg      : 15.207500354766847
 quant_err      : 15.207500354766847
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.689
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.77087822256276
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.618
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.31442123964741
 mnt_best       : 47.10366360042054
 not_improved_count: 3
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.70178 (QuantReg: 15.47721) QuantErr: 15.47721 batch_time=36.87564 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.75936 (QuantReg: 15.34348) QuantErr: 15.34348 batch_time=0.66168 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.95016 (QuantReg: 15.07832) QuantErr: 15.07832 batch_time=0.69742 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 0.95026 (QuantReg: 15.07513) QuantErr: 15.07513 batch_time=0.67287 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.11550 (QuantReg: 15.22375) QuantErr: 15.22375 batch_time=0.65599 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.86194 (QuantReg: 15.47140) QuantErr: 15.47140 batch_time=0.62754 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 0.84551 (QuantReg: 15.37572) QuantErr: 15.37572 batch_time=2.58836 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.14243 (QuantReg: 15.01743) QuantErr: 15.01743 batch_time=0.62978 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.19587 (QuantReg: 15.34865) QuantErr: 15.34865 batch_time=0.60215 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.05197 (QuantReg: 15.48900) QuantErr: 15.48900 batch_time=0.60483 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.00596 (QuantReg: 15.43030) QuantErr: 15.43030 batch_time=0.60894 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.14696 (QuantReg: 15.25603) QuantErr: 15.25603 batch_time=0.66442 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.12154 (QuantReg: 15.23237) QuantErr: 15.23237 batch_time=0.62601 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.01193 (QuantReg: 15.38299) QuantErr: 15.38299 batch_time=0.61316 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.22384 (QuantReg: 14.95082) QuantErr: 14.95082 batch_time=1.33499 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.88218 (QuantReg: 15.47985) QuantErr: 15.47985 batch_time=0.63869 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.95182 (QuantReg: 15.19883) QuantErr: 15.19883 batch_time=0.64488 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.70937 (QuantReg: 15.36738) QuantErr: 15.36738 batch_time=0.69665 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.06565 (QuantReg: 15.36076) QuantErr: 15.36076 batch_time=0.64210 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 0.93546 (QuantReg: 15.28585) QuantErr: 15.28585 batch_time=3.55702 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 0.89821 (QuantReg: 15.37610) QuantErr: 15.37610 batch_time=0.59560 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.15937 (QuantReg: 14.98977) QuantErr: 14.98977 batch_time=0.67259 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.17451 (QuantReg: 15.28284) QuantErr: 15.28284 batch_time=0.61113 
Train Epoch: 38 codebook_update_time=3.36284
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch38.pth ...
Done in 4.606s
removing stale ckpt [epoch 37] [took 0.02s]
 epoch          : 38
 loss           : 1.02113197016716
 quant_reg      : 15.21218312072754
 quant_err      : 15.21218312072754
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.409
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.91551564819867
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.454
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.18023776489238
 mnt_best       : 47.10366360042054
 not_improved_count: 4
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.84737 (QuantReg: 15.07903) QuantErr: 15.07903 batch_time=45.14979 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 0.89764 (QuantReg: 15.53900) QuantErr: 15.53900 batch_time=0.61100 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.41171 (QuantReg: 15.08035) QuantErr: 15.08035 batch_time=0.62666 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 0.95551 (QuantReg: 15.03947) QuantErr: 15.03947 batch_time=0.68409 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.39948 (QuantReg: 15.13724) QuantErr: 15.13724 batch_time=0.60500 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 0.90116 (QuantReg: 15.08578) QuantErr: 15.08578 batch_time=0.62756 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.31863 (QuantReg: 14.93102) QuantErr: 14.93102 batch_time=0.62645 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.14682 (QuantReg: 15.08471) QuantErr: 15.08471 batch_time=0.61820 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.11144 (QuantReg: 15.42391) QuantErr: 15.42391 batch_time=0.60687 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.10784 (QuantReg: 15.02888) QuantErr: 15.02888 batch_time=0.62140 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.27515 (QuantReg: 15.33896) QuantErr: 15.33896 batch_time=0.58667 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.24754 (QuantReg: 15.21225) QuantErr: 15.21225 batch_time=0.60906 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.39461 (QuantReg: 15.01028) QuantErr: 15.01028 batch_time=0.71041 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.16727 (QuantReg: 15.22716) QuantErr: 15.22716 batch_time=0.60919 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.12823 (QuantReg: 15.37595) QuantErr: 15.37595 batch_time=0.60285 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.18325 (QuantReg: 15.23911) QuantErr: 15.23911 batch_time=0.66692 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.19954 (QuantReg: 15.13587) QuantErr: 15.13587 batch_time=0.61750 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.92169 (QuantReg: 15.28057) QuantErr: 15.28057 batch_time=0.61944 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.80075 (QuantReg: 15.29757) QuantErr: 15.29757 batch_time=0.61210 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.23930 (QuantReg: 15.08626) QuantErr: 15.08626 batch_time=0.61496 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.09285 (QuantReg: 15.19048) QuantErr: 15.19048 batch_time=0.62742 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.16723 (QuantReg: 15.16400) QuantErr: 15.16400 batch_time=0.61135 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.99404 (QuantReg: 15.22777) QuantErr: 15.22777 batch_time=0.61173 
Train Epoch: 39 codebook_update_time=3.50166
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch39.pth ...
Done in 4.472s
removing stale ckpt [epoch 38] [took 0.01s]
 epoch          : 39
 loss           : 1.049275689125061
 quant_reg      : 15.232467224121093
 quant_err      : 15.232467224121093
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.677
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.93323854649706
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.496
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.03385443758313
 mnt_best       : 47.10366360042054
 not_improved_count: 5
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.42615 (QuantReg: 14.94504) QuantErr: 14.94504 batch_time=47.42788 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 0.80414 (QuantReg: 15.15983) QuantErr: 15.15983 batch_time=0.72140 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 0.99045 (QuantReg: 15.22957) QuantErr: 15.22957 batch_time=0.59130 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.85375 (QuantReg: 15.38026) QuantErr: 15.38026 batch_time=0.62896 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.12524 (QuantReg: 15.16501) QuantErr: 15.16501 batch_time=0.60880 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.14968 (QuantReg: 15.12713) QuantErr: 15.12713 batch_time=0.60687 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.03485 (QuantReg: 15.19121) QuantErr: 15.19121 batch_time=0.61224 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.18269 (QuantReg: 15.02183) QuantErr: 15.02183 batch_time=0.62876 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.10206 (QuantReg: 15.28377) QuantErr: 15.28377 batch_time=0.65691 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.78362 (QuantReg: 15.45383) QuantErr: 15.45383 batch_time=0.62931 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.32466 (QuantReg: 15.01268) QuantErr: 15.01268 batch_time=1.33483 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.04149 (QuantReg: 15.25013) QuantErr: 15.25013 batch_time=0.61293 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.08940 (QuantReg: 15.14583) QuantErr: 15.14583 batch_time=0.61475 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.29670 (QuantReg: 15.00594) QuantErr: 15.00594 batch_time=0.61630 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 0.76005 (QuantReg: 15.29265) QuantErr: 15.29265 batch_time=0.68768 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 0.94645 (QuantReg: 15.33108) QuantErr: 15.33108 batch_time=0.60150 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.31309 (QuantReg: 14.90628) QuantErr: 14.90628 batch_time=0.62516 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.02303 (QuantReg: 15.19612) QuantErr: 15.19612 batch_time=0.64591 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.03837 (QuantReg: 15.25836) QuantErr: 15.25836 batch_time=0.60496 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.20337 (QuantReg: 15.15263) QuantErr: 15.15263 batch_time=0.65336 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.25247 (QuantReg: 15.22751) QuantErr: 15.22751 batch_time=0.69550 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.93613 (QuantReg: 15.35612) QuantErr: 15.35612 batch_time=0.58648 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.79307 (QuantReg: 15.32293) QuantErr: 15.32293 batch_time=0.61536 
Train Epoch: 40 codebook_update_time=3.41704
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch40.pth ...
Done in 4.579s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch40.pth ...
Done in 9.228s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 1.038558744430542
 quant_reg      : 15.22848804473877
 quant_err      : 15.22848804473877
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.925
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.43858892979734
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.819
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.66192919701622
 mnt_best       : 47.43858892979734
 not_improved_count: 0
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.99744 (QuantReg: 15.31840) QuantErr: 15.31840 batch_time=38.04725 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.08086 (QuantReg: 15.18003) QuantErr: 15.18003 batch_time=0.60780 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.04136 (QuantReg: 14.98082) QuantErr: 14.98082 batch_time=1.06843 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.16053 (QuantReg: 15.16669) QuantErr: 15.16669 batch_time=0.58932 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.05502 (QuantReg: 15.42951) QuantErr: 15.42951 batch_time=0.61551 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.84211 (QuantReg: 15.34779) QuantErr: 15.34779 batch_time=0.64340 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.90318 (QuantReg: 15.29569) QuantErr: 15.29569 batch_time=0.63582 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.85662 (QuantReg: 14.99294) QuantErr: 14.99294 batch_time=0.63972 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.09260 (QuantReg: 15.37594) QuantErr: 15.37594 batch_time=0.60922 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.03006 (QuantReg: 15.30068) QuantErr: 15.30068 batch_time=0.59025 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 0.96837 (QuantReg: 15.38655) QuantErr: 15.38655 batch_time=0.68138 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 0.99707 (QuantReg: 15.09318) QuantErr: 15.09318 batch_time=0.67167 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.11503 (QuantReg: 15.19355) QuantErr: 15.19355 batch_time=0.62049 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.18438 (QuantReg: 15.21133) QuantErr: 15.21133 batch_time=3.78814 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.01572 (QuantReg: 15.39338) QuantErr: 15.39338 batch_time=0.61625 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 0.93665 (QuantReg: 15.28446) QuantErr: 15.28446 batch_time=0.61610 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.05732 (QuantReg: 15.41449) QuantErr: 15.41449 batch_time=0.61386 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.99162 (QuantReg: 15.25134) QuantErr: 15.25134 batch_time=0.64279 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.43793 (QuantReg: 15.09668) QuantErr: 15.09668 batch_time=0.60672 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.14098 (QuantReg: 15.19594) QuantErr: 15.19594 batch_time=0.70982 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 0.92981 (QuantReg: 15.35855) QuantErr: 15.35855 batch_time=0.63006 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.12242 (QuantReg: 15.10646) QuantErr: 15.10646 batch_time=0.63064 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.07198 (QuantReg: 15.10299) QuantErr: 15.10299 batch_time=0.61567 
Train Epoch: 41 codebook_update_time=3.83113
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch41.pth ...
Done in 4.551s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.033760890007019
 quant_reg      : 15.243068752288819
 quant_err      : 15.243068752288819
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.426
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.20605112499654
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9375
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.60717678902894
 mnt_best       : 47.43858892979734
 not_improved_count: 1
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 0.90902 (QuantReg: 15.39340) QuantErr: 15.39340 batch_time=41.71599 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.93697 (QuantReg: 15.47132) QuantErr: 15.47132 batch_time=0.74813 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.17362 (QuantReg: 15.29192) QuantErr: 15.29192 batch_time=0.61562 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.19239 (QuantReg: 15.05312) QuantErr: 15.05312 batch_time=0.63197 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.21696 (QuantReg: 15.02971) QuantErr: 15.02971 batch_time=0.88184 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 0.88375 (QuantReg: 15.33541) QuantErr: 15.33541 batch_time=0.58465 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.06993 (QuantReg: 15.20718) QuantErr: 15.20718 batch_time=0.61085 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.12569 (QuantReg: 15.35303) QuantErr: 15.35303 batch_time=0.61019 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.82525 (QuantReg: 15.15708) QuantErr: 15.15708 batch_time=0.59139 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.01721 (QuantReg: 15.19606) QuantErr: 15.19606 batch_time=0.58799 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 0.92387 (QuantReg: 15.05857) QuantErr: 15.05857 batch_time=0.62759 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.20073 (QuantReg: 14.96271) QuantErr: 14.96271 batch_time=0.64147 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 0.92966 (QuantReg: 15.21074) QuantErr: 15.21074 batch_time=1.32204 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.84057 (QuantReg: 15.35441) QuantErr: 15.35441 batch_time=1.58520 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.05533 (QuantReg: 15.26181) QuantErr: 15.26181 batch_time=0.64839 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.18232 (QuantReg: 15.35353) QuantErr: 15.35353 batch_time=0.69052 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.94324 (QuantReg: 15.22326) QuantErr: 15.22326 batch_time=0.61680 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.78889 (QuantReg: 15.27033) QuantErr: 15.27033 batch_time=0.62143 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.82836 (QuantReg: 15.42757) QuantErr: 15.42757 batch_time=0.88360 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.00564 (QuantReg: 15.03362) QuantErr: 15.03362 batch_time=2.49414 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.77230 (QuantReg: 15.21520) QuantErr: 15.21520 batch_time=0.60623 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.91534 (QuantReg: 15.13424) QuantErr: 15.13424 batch_time=0.74333 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.16159 (QuantReg: 15.35826) QuantErr: 15.35826 batch_time=0.62736 
Train Epoch: 42 codebook_update_time=3.83828
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch42.pth ...
Done in 5.622s
removing stale ckpt [epoch 41] [took 0.03s]
 epoch          : 42
 loss           : 1.0108956625461578
 quant_reg      : 15.239672706604004
 quant_err      : 15.239672706604004
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.474
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.57323273812262
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.126
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.26428447483303
 mnt_best       : 47.43858892979734
 not_improved_count: 2
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.88635 (QuantReg: 15.36241) QuantErr: 15.36241 batch_time=35.01820 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.84715 (QuantReg: 15.15922) QuantErr: 15.15922 batch_time=5.86139 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 0.99342 (QuantReg: 15.36088) QuantErr: 15.36088 batch_time=0.60337 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.01716 (QuantReg: 15.27305) QuantErr: 15.27305 batch_time=0.60152 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.09180 (QuantReg: 15.26667) QuantErr: 15.26667 batch_time=0.69218 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 0.79076 (QuantReg: 15.37654) QuantErr: 15.37654 batch_time=0.58814 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.27951 (QuantReg: 15.24266) QuantErr: 15.24266 batch_time=0.59543 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 0.97668 (QuantReg: 15.26244) QuantErr: 15.26244 batch_time=0.60049 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.87877 (QuantReg: 15.21552) QuantErr: 15.21552 batch_time=0.60302 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 0.99500 (QuantReg: 15.33740) QuantErr: 15.33740 batch_time=0.59898 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.03017 (QuantReg: 15.32764) QuantErr: 15.32764 batch_time=0.60230 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.91569 (QuantReg: 15.29187) QuantErr: 15.29187 batch_time=0.64096 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 0.85202 (QuantReg: 15.32744) QuantErr: 15.32744 batch_time=0.62990 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.93772 (QuantReg: 14.92500) QuantErr: 14.92500 batch_time=0.59824 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.09663 (QuantReg: 15.48997) QuantErr: 15.48997 batch_time=0.63346 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 0.89665 (QuantReg: 15.22969) QuantErr: 15.22969 batch_time=0.62258 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.75789 (QuantReg: 15.43757) QuantErr: 15.43757 batch_time=0.61434 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.90414 (QuantReg: 15.22834) QuantErr: 15.22834 batch_time=0.58204 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.20237 (QuantReg: 15.23179) QuantErr: 15.23179 batch_time=0.60342 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.26781 (QuantReg: 15.39282) QuantErr: 15.39282 batch_time=0.62487 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.04112 (QuantReg: 15.50473) QuantErr: 15.50473 batch_time=0.63453 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.83168 (QuantReg: 15.26545) QuantErr: 15.26545 batch_time=0.61114 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.08738 (QuantReg: 15.11514) QuantErr: 15.11514 batch_time=0.60926 
Train Epoch: 43 codebook_update_time=3.24193
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch43.pth ...
Done in 4.660s
removing stale ckpt [epoch 42] [took 0.03s]
 epoch          : 43
 loss           : 1.0102345385551452
 quant_reg      : 15.246435550689696
 quant_err      : 15.246435550689696
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.274
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.529737482000186
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.988
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.053603311432475
 mnt_best       : 47.43858892979734
 not_improved_count: 3
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.97569 (QuantReg: 15.25473) QuantErr: 15.25473 batch_time=35.07670 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.04481 (QuantReg: 15.35651) QuantErr: 15.35651 batch_time=0.74081 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 0.97967 (QuantReg: 15.22073) QuantErr: 15.22073 batch_time=0.60500 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.88045 (QuantReg: 15.18679) QuantErr: 15.18679 batch_time=0.59467 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.19062 (QuantReg: 15.13712) QuantErr: 15.13712 batch_time=0.58069 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.22289 (QuantReg: 14.92461) QuantErr: 14.92461 batch_time=0.58309 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.02680 (QuantReg: 15.21039) QuantErr: 15.21039 batch_time=0.72128 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.11634 (QuantReg: 15.21440) QuantErr: 15.21440 batch_time=0.82753 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.23693 (QuantReg: 15.16338) QuantErr: 15.16338 batch_time=0.59447 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.03125 (QuantReg: 15.06475) QuantErr: 15.06475 batch_time=0.59386 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.00175 (QuantReg: 15.39322) QuantErr: 15.39322 batch_time=0.60654 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.03840 (QuantReg: 15.20105) QuantErr: 15.20105 batch_time=0.60335 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.21215 (QuantReg: 15.31396) QuantErr: 15.31396 batch_time=0.61378 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.09780 (QuantReg: 15.19347) QuantErr: 15.19347 batch_time=1.31685 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.08834 (QuantReg: 15.37417) QuantErr: 15.37417 batch_time=0.67285 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.11904 (QuantReg: 15.22550) QuantErr: 15.22550 batch_time=0.60877 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.01083 (QuantReg: 15.21602) QuantErr: 15.21602 batch_time=0.60216 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.97492 (QuantReg: 15.38839) QuantErr: 15.38839 batch_time=0.61277 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.03329 (QuantReg: 15.20507) QuantErr: 15.20507 batch_time=2.02413 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.01390 (QuantReg: 15.38526) QuantErr: 15.38526 batch_time=1.08191 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.06327 (QuantReg: 15.18659) QuantErr: 15.18659 batch_time=0.59567 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.28496 (QuantReg: 15.26890) QuantErr: 15.26890 batch_time=0.70430 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.12362 (QuantReg: 15.16832) QuantErr: 15.16832 batch_time=0.69741 
Train Epoch: 44 codebook_update_time=3.28105
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch44.pth ...
Done in 4.497s
removing stale ckpt [epoch 43] [took 0.04s]
 epoch          : 44
 loss           : 1.0038741538524627
 quant_reg      : 15.264653324127197
 quant_err      : 15.264653324127197
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.117
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.464278728530054
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 72.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.699
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.91683515840773
 mnt_best       : 47.43858892979734
 not_improved_count: 4
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.14018 (QuantReg: 15.40688) QuantErr: 15.40688 batch_time=33.16155 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.92491 (QuantReg: 15.06133) QuantErr: 15.06133 batch_time=0.58995 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.74795 (QuantReg: 15.49651) QuantErr: 15.49651 batch_time=0.59843 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.20708 (QuantReg: 15.11882) QuantErr: 15.11882 batch_time=1.01634 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.01884 (QuantReg: 15.18826) QuantErr: 15.18826 batch_time=0.61097 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.03392 (QuantReg: 15.31467) QuantErr: 15.31467 batch_time=0.59173 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.66085 (QuantReg: 15.46248) QuantErr: 15.46248 batch_time=0.57575 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 0.95350 (QuantReg: 15.39600) QuantErr: 15.39600 batch_time=0.64991 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.01345 (QuantReg: 15.25639) QuantErr: 15.25639 batch_time=0.98322 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.85453 (QuantReg: 15.50760) QuantErr: 15.50760 batch_time=0.62123 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.90446 (QuantReg: 15.31981) QuantErr: 15.31981 batch_time=0.64325 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 0.91056 (QuantReg: 15.39980) QuantErr: 15.39980 batch_time=0.60693 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.74021 (QuantReg: 15.25413) QuantErr: 15.25413 batch_time=0.60385 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.06891 (QuantReg: 15.18467) QuantErr: 15.18467 batch_time=0.67902 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.08532 (QuantReg: 15.24575) QuantErr: 15.24575 batch_time=0.60259 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.82574 (QuantReg: 15.45645) QuantErr: 15.45645 batch_time=0.60700 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.17103 (QuantReg: 15.09320) QuantErr: 15.09320 batch_time=0.61784 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.05190 (QuantReg: 15.52747) QuantErr: 15.52747 batch_time=0.83123 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.82092 (QuantReg: 15.35066) QuantErr: 15.35066 batch_time=0.65202 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.87863 (QuantReg: 15.34390) QuantErr: 15.34390 batch_time=0.60359 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.10792 (QuantReg: 15.09626) QuantErr: 15.09626 batch_time=0.60092 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.76307 (QuantReg: 15.47993) QuantErr: 15.47993 batch_time=0.60076 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.09921 (QuantReg: 15.28603) QuantErr: 15.28603 batch_time=0.64200 
Train Epoch: 45 codebook_update_time=3.36093
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch45.pth ...
Done in 4.133s
removing stale ckpt [epoch 44] [took 0.01s]
 epoch          : 45
 loss           : 0.9957747790813446
 quant_reg      : 15.279939208984375
 quant_err      : 15.279939208984375
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.459
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.0760801907467
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7975
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.34076763918057
 mnt_best       : 47.43858892979734
 not_improved_count: 5
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.97660 (QuantReg: 15.37561) QuantErr: 15.37561 batch_time=38.09192 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.29784 (QuantReg: 15.08098) QuantErr: 15.08098 batch_time=0.62115 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.09533 (QuantReg: 15.44589) QuantErr: 15.44589 batch_time=0.60595 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.93788 (QuantReg: 15.29829) QuantErr: 15.29829 batch_time=0.60632 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.01011 (QuantReg: 15.14349) QuantErr: 15.14349 batch_time=0.59077 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 0.93003 (QuantReg: 15.24387) QuantErr: 15.24387 batch_time=0.59205 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.90207 (QuantReg: 15.27814) QuantErr: 15.27814 batch_time=0.60068 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 0.83367 (QuantReg: 15.03740) QuantErr: 15.03740 batch_time=0.60415 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.70348 (QuantReg: 15.17680) QuantErr: 15.17680 batch_time=0.62480 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.75811 (QuantReg: 15.57622) QuantErr: 15.57622 batch_time=0.61737 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.22676 (QuantReg: 15.22994) QuantErr: 15.22994 batch_time=0.60319 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.03941 (QuantReg: 15.19117) QuantErr: 15.19117 batch_time=0.60193 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.09487 (QuantReg: 14.98155) QuantErr: 14.98155 batch_time=0.64393 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.31677 (QuantReg: 15.18983) QuantErr: 15.18983 batch_time=2.08661 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.27218 (QuantReg: 15.23754) QuantErr: 15.23754 batch_time=0.60599 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.16597 (QuantReg: 15.20524) QuantErr: 15.20524 batch_time=0.61444 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 0.94855 (QuantReg: 15.12828) QuantErr: 15.12828 batch_time=0.61670 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 0.98329 (QuantReg: 15.35743) QuantErr: 15.35743 batch_time=0.61320 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.94489 (QuantReg: 15.42660) QuantErr: 15.42660 batch_time=0.60481 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.95546 (QuantReg: 15.44857) QuantErr: 15.44857 batch_time=0.62229 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.91629 (QuantReg: 15.26687) QuantErr: 15.26687 batch_time=0.60767 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 0.72863 (QuantReg: 15.46296) QuantErr: 15.46296 batch_time=0.59192 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.05504 (QuantReg: 15.42326) QuantErr: 15.42326 batch_time=0.59926 
Train Epoch: 46 codebook_update_time=3.34237
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch46.pth ...
Done in 5.722s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 0.9932348158359527
 quant_reg      : 15.282243629455566
 quant_err      : 15.282243629455566
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.443
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.90483778289846
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 59.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.11
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.235165421732674
 mnt_best       : 47.43858892979734
 not_improved_count: 6
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.25962 (QuantReg: 14.99829) QuantErr: 14.99829 batch_time=35.78966 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 0.92392 (QuantReg: 15.08646) QuantErr: 15.08646 batch_time=0.59287 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.11863 (QuantReg: 15.34504) QuantErr: 15.34504 batch_time=0.59317 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.18557 (QuantReg: 15.21570) QuantErr: 15.21570 batch_time=0.60133 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.01401 (QuantReg: 15.45609) QuantErr: 15.45609 batch_time=0.60749 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.82646 (QuantReg: 15.42562) QuantErr: 15.42562 batch_time=0.64364 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 0.87967 (QuantReg: 15.39660) QuantErr: 15.39660 batch_time=1.72503 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.05896 (QuantReg: 15.27946) QuantErr: 15.27946 batch_time=0.59932 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.15797 (QuantReg: 15.25759) QuantErr: 15.25759 batch_time=0.63810 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.76522 (QuantReg: 15.43720) QuantErr: 15.43720 batch_time=0.58844 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.94530 (QuantReg: 15.39522) QuantErr: 15.39522 batch_time=0.90354 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.87900 (QuantReg: 15.18419) QuantErr: 15.18419 batch_time=0.60030 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.00541 (QuantReg: 15.46156) QuantErr: 15.46156 batch_time=0.59277 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.67130 (QuantReg: 15.22836) QuantErr: 15.22836 batch_time=0.58928 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.11028 (QuantReg: 15.38028) QuantErr: 15.38028 batch_time=0.92918 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.82029 (QuantReg: 15.42184) QuantErr: 15.42184 batch_time=0.59918 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.23833 (QuantReg: 15.36509) QuantErr: 15.36509 batch_time=0.58628 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.15892 (QuantReg: 15.16586) QuantErr: 15.16586 batch_time=0.60372 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 0.85096 (QuantReg: 15.22969) QuantErr: 15.22969 batch_time=0.64769 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.94959 (QuantReg: 15.15673) QuantErr: 15.15673 batch_time=1.85449 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.70874 (QuantReg: 15.48255) QuantErr: 15.48255 batch_time=0.61152 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.03451 (QuantReg: 15.32071) QuantErr: 15.32071 batch_time=0.60662 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 0.97672 (QuantReg: 15.24670) QuantErr: 15.24670 batch_time=0.63133 
Train Epoch: 47 codebook_update_time=3.32634
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch47.pth ...
Done in 4.365s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 47
 loss           : 0.9933491547107697
 quant_reg      : 15.29224630355835
 quant_err      : 15.29224630355835
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.218
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.072609663824856
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.576
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.479613042508305
 mnt_best       : 47.43858892979734
 not_improved_count: 7
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.08632 (QuantReg: 15.05319) QuantErr: 15.05319 batch_time=39.37165 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.10871 (QuantReg: 15.43490) QuantErr: 15.43490 batch_time=0.60275 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.07687 (QuantReg: 15.29002) QuantErr: 15.29002 batch_time=0.59644 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 0.95308 (QuantReg: 15.18889) QuantErr: 15.18889 batch_time=0.58877 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.03532 (QuantReg: 15.19576) QuantErr: 15.19576 batch_time=0.61642 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 0.95930 (QuantReg: 15.47190) QuantErr: 15.47190 batch_time=0.60009 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 0.92136 (QuantReg: 15.29668) QuantErr: 15.29668 batch_time=0.60466 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.09410 (QuantReg: 15.25874) QuantErr: 15.25874 batch_time=0.73057 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.86726 (QuantReg: 15.49699) QuantErr: 15.49699 batch_time=0.63053 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 0.94893 (QuantReg: 15.36256) QuantErr: 15.36256 batch_time=0.59151 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.00091 (QuantReg: 15.32584) QuantErr: 15.32584 batch_time=0.59669 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 0.91391 (QuantReg: 15.01600) QuantErr: 15.01600 batch_time=0.62255 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.17720 (QuantReg: 15.29799) QuantErr: 15.29799 batch_time=0.62586 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.33039 (QuantReg: 15.22724) QuantErr: 15.22724 batch_time=1.60420 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.10050 (QuantReg: 15.19020) QuantErr: 15.19020 batch_time=0.61695 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.16123 (QuantReg: 15.15522) QuantErr: 15.15522 batch_time=0.60436 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.76841 (QuantReg: 15.39019) QuantErr: 15.39019 batch_time=0.87757 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 0.79230 (QuantReg: 15.50830) QuantErr: 15.50830 batch_time=0.66500 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 0.99754 (QuantReg: 15.29588) QuantErr: 15.29588 batch_time=0.60109 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 0.78249 (QuantReg: 15.42646) QuantErr: 15.42646 batch_time=0.61631 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.11887 (QuantReg: 15.33147) QuantErr: 15.33147 batch_time=0.59816 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.08075 (QuantReg: 15.19276) QuantErr: 15.19276 batch_time=0.61237 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 0.98091 (QuantReg: 15.26389) QuantErr: 15.26389 batch_time=0.70723 
Train Epoch: 48 codebook_update_time=3.54896
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch48.pth ...
Done in 18.155s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 0.9867729184627533
 quant_reg      : 15.289780616760254
 quant_err      : 15.289780616760254
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.933
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.1282069222211
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.853
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.19436812580059
 mnt_best       : 47.43858892979734
 not_improved_count: 8
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.02653 (QuantReg: 15.23605) QuantErr: 15.23605 batch_time=37.53260 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.01371 (QuantReg: 15.38088) QuantErr: 15.38088 batch_time=0.59862 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 0.99725 (QuantReg: 15.34574) QuantErr: 15.34574 batch_time=0.60355 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.15436 (QuantReg: 15.37023) QuantErr: 15.37023 batch_time=0.60483 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.18366 (QuantReg: 15.19505) QuantErr: 15.19505 batch_time=0.62894 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.05366 (QuantReg: 15.32589) QuantErr: 15.32589 batch_time=0.60629 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 0.90287 (QuantReg: 15.28205) QuantErr: 15.28205 batch_time=0.61467 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.75201 (QuantReg: 15.38326) QuantErr: 15.38326 batch_time=0.67772 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.80227 (QuantReg: 15.14517) QuantErr: 15.14517 batch_time=0.62398 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.96856 (QuantReg: 15.30286) QuantErr: 15.30286 batch_time=0.61705 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.00467 (QuantReg: 15.49225) QuantErr: 15.49225 batch_time=0.71231 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.81057 (QuantReg: 15.24951) QuantErr: 15.24951 batch_time=0.73303 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.09822 (QuantReg: 15.10523) QuantErr: 15.10523 batch_time=0.60326 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.12318 (QuantReg: 15.24881) QuantErr: 15.24881 batch_time=2.29649 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 0.99598 (QuantReg: 15.22964) QuantErr: 15.22964 batch_time=0.58235 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.80856 (QuantReg: 15.24301) QuantErr: 15.24301 batch_time=0.58750 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.82603 (QuantReg: 15.30065) QuantErr: 15.30065 batch_time=0.63615 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 0.99975 (QuantReg: 15.54821) QuantErr: 15.54821 batch_time=0.60021 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.06355 (QuantReg: 15.26212) QuantErr: 15.26212 batch_time=0.58986 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.09636 (QuantReg: 15.20958) QuantErr: 15.20958 batch_time=0.60194 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 0.82745 (QuantReg: 15.42169) QuantErr: 15.42169 batch_time=0.59234 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.65625 (QuantReg: 15.28232) QuantErr: 15.28232 batch_time=0.67987 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 0.99773 (QuantReg: 15.23606) QuantErr: 15.23606 batch_time=0.60050 
Train Epoch: 49 codebook_update_time=3.37454
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch49.pth ...
Done in 4.358s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 0.9897908875942231
 quant_reg      : 15.298312084197999
 quant_err      : 15.298312084197999
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.251
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.696032628098735
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.963
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.75607152129943
 mnt_best       : 47.43858892979734
 not_improved_count: 9
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 0.99565 (QuantReg: 15.40428) QuantErr: 15.40428 batch_time=41.79790 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.55546 (QuantReg: 15.31391) QuantErr: 15.31391 batch_time=0.59526 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 0.86546 (QuantReg: 15.40525) QuantErr: 15.40525 batch_time=0.63198 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 0.84582 (QuantReg: 15.38946) QuantErr: 15.38946 batch_time=0.60195 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.10746 (QuantReg: 15.14206) QuantErr: 15.14206 batch_time=0.61002 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.93002 (QuantReg: 15.26427) QuantErr: 15.26427 batch_time=0.59809 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.15872 (QuantReg: 15.24794) QuantErr: 15.24794 batch_time=0.61461 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.83400 (QuantReg: 15.24148) QuantErr: 15.24148 batch_time=0.62434 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.88433 (QuantReg: 15.22575) QuantErr: 15.22575 batch_time=0.62823 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 0.95899 (QuantReg: 15.34106) QuantErr: 15.34106 batch_time=0.66965 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.69943 (QuantReg: 15.60469) QuantErr: 15.60469 batch_time=0.61159 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.93415 (QuantReg: 15.22940) QuantErr: 15.22940 batch_time=0.58519 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 0.93903 (QuantReg: 15.32165) QuantErr: 15.32165 batch_time=0.61948 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.17193 (QuantReg: 15.14799) QuantErr: 15.14799 batch_time=0.88255 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.02124 (QuantReg: 15.24099) QuantErr: 15.24099 batch_time=0.64326 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.75008 (QuantReg: 15.28737) QuantErr: 15.28737 batch_time=0.61972 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.07114 (QuantReg: 15.47865) QuantErr: 15.47865 batch_time=0.69975 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.09391 (QuantReg: 15.33772) QuantErr: 15.33772 batch_time=0.60558 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.99621 (QuantReg: 15.21658) QuantErr: 15.21658 batch_time=0.66276 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.86990 (QuantReg: 15.42771) QuantErr: 15.42771 batch_time=0.62327 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 0.96226 (QuantReg: 15.27669) QuantErr: 15.27669 batch_time=0.63052 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.09701 (QuantReg: 15.26725) QuantErr: 15.26725 batch_time=0.63134 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 0.95161 (QuantReg: 15.21831) QuantErr: 15.21831 batch_time=0.65274 
Train Epoch: 50 codebook_update_time=3.51557
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/checkpoint-epoch50.pth ...
Done in 5.717s
removing stale ckpt [epoch 49] [took 0.01s]
 epoch          : 50
 loss           : 0.969790549993515
 quant_reg      : 15.32737682723999
 quant_err      : 15.32737682723999
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.181
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.70024408867525
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.936
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.925437621466884
 mnt_best       : 47.43858892979734
 not_improved_count: 10
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/trained_model.pth ...
Ckpt loaded at epoch 40.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 27.2
 t2v_metrics/R5/final_eval: 56.8
 t2v_metrics/R10/final_eval: 69.1
 t2v_metrics/R50/final_eval: 89.3
 t2v_metrics/MedR/final_eval: 4.0
 t2v_metrics/MeanR/final_eval: 26.925
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 47.43858892979734
 v2t_metrics/R1/final_eval: 26.1
 v2t_metrics/R5/final_eval: 58.1
 v2t_metrics/R10/final_eval: 71.4
 v2t_metrics/R50/final_eval: 90.7
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 23.819
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 47.66192919701622
Best epoch for the monitored metric: 40
Script took 04h11m59s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_M64/trained_model.pth
