Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 1024.392793416977 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 104.15164375305176 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 71.10946297645569 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch0.pth ...
Done in 1.677s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch0.pth ...
Done in 3.328s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 485.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 496.577
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 0.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 506.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 507.202
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 39.45394 (QuantReg: 22.51269) QuantErr: 22.51269 batch_time=31.41659 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 36.49441 (QuantReg: 22.50773) QuantErr: 22.50773 batch_time=0.42483 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 30.79572 (QuantReg: 22.64917) QuantErr: 22.64917 batch_time=0.41022 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 29.01644 (QuantReg: 22.54791) QuantErr: 22.54791 batch_time=0.44195 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 24.82624 (QuantReg: 22.48267) QuantErr: 22.48267 batch_time=0.39822 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 26.19078 (QuantReg: 22.46219) QuantErr: 22.46219 batch_time=0.41986 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 24.55196 (QuantReg: 22.47930) QuantErr: 22.47930 batch_time=0.39628 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 22.54803 (QuantReg: 22.49416) QuantErr: 22.49416 batch_time=0.43194 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 21.62878 (QuantReg: 22.58009) QuantErr: 22.58009 batch_time=0.43321 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 23.82302 (QuantReg: 22.51277) QuantErr: 22.51277 batch_time=0.42593 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 21.70013 (QuantReg: 22.49101) QuantErr: 22.49101 batch_time=0.41315 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 20.62058 (QuantReg: 22.43006) QuantErr: 22.43006 batch_time=0.40290 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 21.56419 (QuantReg: 22.49230) QuantErr: 22.49230 batch_time=4.83164 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 19.55249 (QuantReg: 22.54457) QuantErr: 22.54457 batch_time=0.41651 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 21.37553 (QuantReg: 22.56658) QuantErr: 22.56658 batch_time=0.40518 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 18.97645 (QuantReg: 22.53736) QuantErr: 22.53736 batch_time=0.43005 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 18.25607 (QuantReg: 22.57673) QuantErr: 22.57673 batch_time=0.46301 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 18.10199 (QuantReg: 22.61641) QuantErr: 22.61641 batch_time=0.40033 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 18.85452 (QuantReg: 22.61238) QuantErr: 22.61238 batch_time=0.42312 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 18.39544 (QuantReg: 22.57126) QuantErr: 22.57126 batch_time=0.43133 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 18.05830 (QuantReg: 22.59906) QuantErr: 22.59906 batch_time=0.42742 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 17.96398 (QuantReg: 22.47879) QuantErr: 22.47879 batch_time=0.40004 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 16.01126 (QuantReg: 22.57892) QuantErr: 22.57892 batch_time=0.40462 
Train Epoch: 1 codebook_update_time=0.46167
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch1.pth ...
Done in 4.091s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch1.pth ...
Done in 8.320s
 epoch          : 1
 loss           : 22.615418056488036
 quant_reg      : 22.542302421569826
 quant_err      : 22.542302421569826
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 28.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 42.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 77.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 46.543
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.36942674710313
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 32.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 45.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 42.799
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.147594488367016
 mnt_best       : 21.36942674710313
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 18.47575 (QuantReg: 11.44290) QuantErr: 11.44290 batch_time=33.66799 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 17.35076 (QuantReg: 11.70998) QuantErr: 11.70998 batch_time=0.44718 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 17.22701 (QuantReg: 12.03772) QuantErr: 12.03772 batch_time=0.98730 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 17.87004 (QuantReg: 12.31085) QuantErr: 12.31085 batch_time=0.41317 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 17.53695 (QuantReg: 12.57373) QuantErr: 12.57373 batch_time=0.39914 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 17.28370 (QuantReg: 12.86325) QuantErr: 12.86325 batch_time=0.40332 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 15.50547 (QuantReg: 12.75644) QuantErr: 12.75644 batch_time=0.38761 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 13.91186 (QuantReg: 12.90589) QuantErr: 12.90589 batch_time=0.41044 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 15.96114 (QuantReg: 13.13000) QuantErr: 13.13000 batch_time=0.41346 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 16.34826 (QuantReg: 13.10998) QuantErr: 13.10998 batch_time=0.39830 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 14.56995 (QuantReg: 12.99726) QuantErr: 12.99726 batch_time=0.42634 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 16.57770 (QuantReg: 13.09644) QuantErr: 13.09644 batch_time=0.40072 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 14.74500 (QuantReg: 13.57713) QuantErr: 13.57713 batch_time=0.39380 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 14.19975 (QuantReg: 13.24320) QuantErr: 13.24320 batch_time=0.45867 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 12.06368 (QuantReg: 14.06582) QuantErr: 14.06582 batch_time=0.38854 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 14.32172 (QuantReg: 14.31341) QuantErr: 14.31341 batch_time=0.40919 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 17.10909 (QuantReg: 13.86869) QuantErr: 13.86869 batch_time=0.41090 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 14.97063 (QuantReg: 14.25928) QuantErr: 14.25928 batch_time=0.41960 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 15.12661 (QuantReg: 14.43660) QuantErr: 14.43660 batch_time=0.39874 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 13.62776 (QuantReg: 14.75650) QuantErr: 14.75650 batch_time=3.70794 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 14.62663 (QuantReg: 15.12531) QuantErr: 15.12531 batch_time=0.39333 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 15.86301 (QuantReg: 14.61534) QuantErr: 14.61534 batch_time=0.50566 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 14.80993 (QuantReg: 14.73192) QuantErr: 14.73192 batch_time=0.43067 
Train Epoch: 2 codebook_update_time=0.43856
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch2.pth ...
Done in 22.256s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch2.pth ...
Done in 26.434s
removing stale ckpt [epoch 1] [took 0.06s]
removing stale ckpt [epoch 0] [took 0.05s]
 epoch          : 2
 loss           : 15.524708808898925
 quant_reg      : 13.384960544586182
 quant_err      : 13.384960544586182
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 38.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.887
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.719086689477596
 MSRVTT_jsfusion_test/v2t_metrics/R1: 13.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 38.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 52.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 83.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.6685
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.37398513095533
 mnt_best       : 29.719086689477596
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 14.45470 (QuantReg: 11.81915) QuantErr: 11.81915 batch_time=33.32590 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 13.32621 (QuantReg: 11.58701) QuantErr: 11.58701 batch_time=0.40086 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 12.59443 (QuantReg: 11.82981) QuantErr: 11.82981 batch_time=0.41610 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 14.26333 (QuantReg: 12.25041) QuantErr: 12.25041 batch_time=0.40667 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 15.00718 (QuantReg: 11.98020) QuantErr: 11.98020 batch_time=0.41634 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 14.03249 (QuantReg: 12.11674) QuantErr: 12.11674 batch_time=0.41917 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 14.01297 (QuantReg: 12.33520) QuantErr: 12.33520 batch_time=1.23775 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 12.61502 (QuantReg: 12.25264) QuantErr: 12.25264 batch_time=0.39916 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 13.24674 (QuantReg: 12.43026) QuantErr: 12.43026 batch_time=0.40661 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 12.76362 (QuantReg: 12.36433) QuantErr: 12.36433 batch_time=0.40443 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 11.58342 (QuantReg: 12.22636) QuantErr: 12.22636 batch_time=0.40600 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 12.70614 (QuantReg: 12.42211) QuantErr: 12.42211 batch_time=0.44994 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 11.87342 (QuantReg: 12.59114) QuantErr: 12.59114 batch_time=0.40076 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 10.38799 (QuantReg: 12.32340) QuantErr: 12.32340 batch_time=0.40579 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 14.20592 (QuantReg: 12.86506) QuantErr: 12.86506 batch_time=0.41173 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 15.11959 (QuantReg: 13.08372) QuantErr: 13.08372 batch_time=0.40668 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 12.41747 (QuantReg: 12.69033) QuantErr: 12.69033 batch_time=0.40913 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 15.17138 (QuantReg: 12.89820) QuantErr: 12.89820 batch_time=0.41665 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 13.06739 (QuantReg: 12.79208) QuantErr: 12.79208 batch_time=0.44337 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 16.05970 (QuantReg: 13.19490) QuantErr: 13.19490 batch_time=0.42437 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 13.75319 (QuantReg: 13.08610) QuantErr: 13.08610 batch_time=0.45112 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 12.01023 (QuantReg: 12.86265) QuantErr: 12.86265 batch_time=0.40226 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 10.70509 (QuantReg: 13.46948) QuantErr: 13.46948 batch_time=0.44040 
Train Epoch: 3 codebook_update_time=0.41404
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch3.pth ...
Done in 4.160s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch3.pth ...
Done in 8.337s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 13.31875171661377
 quant_reg      : 12.579372814178466
 quant_err      : 12.579372814178466
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 40.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 84.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.71
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.05982298895358
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.8185
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.09152416743456
 mnt_best       : 32.05982298895358
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 12.90930 (QuantReg: 11.91773) QuantErr: 11.91773 batch_time=36.35095 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 12.38922 (QuantReg: 11.99472) QuantErr: 11.99472 batch_time=0.39240 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 12.07365 (QuantReg: 12.10583) QuantErr: 12.10583 batch_time=0.39861 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 13.44138 (QuantReg: 12.09771) QuantErr: 12.09771 batch_time=0.40785 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 12.45353 (QuantReg: 12.10542) QuantErr: 12.10542 batch_time=0.43156 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 11.02855 (QuantReg: 12.13025) QuantErr: 12.13025 batch_time=0.40950 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 13.22312 (QuantReg: 12.48814) QuantErr: 12.48814 batch_time=2.17728 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 12.45129 (QuantReg: 12.10522) QuantErr: 12.10522 batch_time=0.39067 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 12.40111 (QuantReg: 12.26557) QuantErr: 12.26557 batch_time=2.47764 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 11.95238 (QuantReg: 12.74493) QuantErr: 12.74493 batch_time=0.39966 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 12.26863 (QuantReg: 12.37903) QuantErr: 12.37903 batch_time=0.40096 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 10.29243 (QuantReg: 12.60866) QuantErr: 12.60866 batch_time=0.40614 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 12.50010 (QuantReg: 12.59956) QuantErr: 12.59956 batch_time=0.41946 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 11.32923 (QuantReg: 12.66918) QuantErr: 12.66918 batch_time=0.41276 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 11.89421 (QuantReg: 12.69717) QuantErr: 12.69717 batch_time=0.42164 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 11.40501 (QuantReg: 12.60872) QuantErr: 12.60872 batch_time=0.41135 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 11.86506 (QuantReg: 12.42365) QuantErr: 12.42365 batch_time=0.38766 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 11.36607 (QuantReg: 12.61403) QuantErr: 12.61403 batch_time=0.42620 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 11.22111 (QuantReg: 12.73185) QuantErr: 12.73185 batch_time=0.39899 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 14.54331 (QuantReg: 12.75561) QuantErr: 12.75561 batch_time=0.39982 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 11.34165 (QuantReg: 12.74473) QuantErr: 12.74473 batch_time=0.41013 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 12.42226 (QuantReg: 12.60509) QuantErr: 12.60509 batch_time=0.39732 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 12.50275 (QuantReg: 12.74243) QuantErr: 12.74243 batch_time=0.42307 
Train Epoch: 4 codebook_update_time=0.48283
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch4.pth ...
Done in 4.470s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch4.pth ...
Done in 8.561s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 11.919737743377686
 quant_reg      : 12.441425079345704
 quant_err      : 12.441425079345704
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.159
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.48043979786535
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.634
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.983529665555565
 mnt_best       : 34.48043979786535
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 10.69831 (QuantReg: 11.82249) QuantErr: 11.82249 batch_time=35.96649 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 11.85341 (QuantReg: 12.26083) QuantErr: 12.26083 batch_time=0.40485 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 10.81388 (QuantReg: 12.12850) QuantErr: 12.12850 batch_time=0.42623 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 11.83293 (QuantReg: 11.77716) QuantErr: 11.77716 batch_time=0.47963 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 10.51465 (QuantReg: 12.35942) QuantErr: 12.35942 batch_time=0.41548 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 11.13771 (QuantReg: 12.48795) QuantErr: 12.48795 batch_time=0.39682 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 12.27779 (QuantReg: 12.42749) QuantErr: 12.42749 batch_time=0.79199 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 9.76733 (QuantReg: 12.00997) QuantErr: 12.00997 batch_time=0.44769 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 10.13609 (QuantReg: 12.43469) QuantErr: 12.43469 batch_time=0.40113 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 11.79768 (QuantReg: 12.74056) QuantErr: 12.74056 batch_time=0.43907 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 9.62719 (QuantReg: 12.42020) QuantErr: 12.42020 batch_time=0.39939 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 10.07652 (QuantReg: 12.44715) QuantErr: 12.44715 batch_time=1.21441 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 12.23217 (QuantReg: 12.54564) QuantErr: 12.54564 batch_time=0.43943 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 10.79771 (QuantReg: 12.32438) QuantErr: 12.32438 batch_time=0.39758 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 9.37713 (QuantReg: 12.48902) QuantErr: 12.48902 batch_time=0.39706 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 12.32448 (QuantReg: 12.59644) QuantErr: 12.59644 batch_time=0.41198 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 9.84704 (QuantReg: 12.45466) QuantErr: 12.45466 batch_time=0.40993 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 12.06724 (QuantReg: 12.88469) QuantErr: 12.88469 batch_time=0.41788 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 10.31718 (QuantReg: 12.86050) QuantErr: 12.86050 batch_time=0.39467 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 13.12694 (QuantReg: 12.79087) QuantErr: 12.79087 batch_time=0.40256 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 10.36283 (QuantReg: 12.64777) QuantErr: 12.64777 batch_time=0.39758 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 11.43996 (QuantReg: 12.68091) QuantErr: 12.68091 batch_time=0.39905 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 9.90166 (QuantReg: 12.82920) QuantErr: 12.82920 batch_time=0.40779 
Train Epoch: 5 codebook_update_time=0.40910
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch5.pth ...
Done in 7.287s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch5.pth ...
Done in 11.467s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 10.86259358215332
 quant_reg      : 12.500230693817139
 quant_err      : 12.500230693817139
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.843
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.50122326010323
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.324
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.708377143635964
 mnt_best       : 35.50122326010323
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 8.72225 (QuantReg: 12.51181) QuantErr: 12.51181 batch_time=32.97877 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 9.21207 (QuantReg: 12.48427) QuantErr: 12.48427 batch_time=0.42427 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 10.81304 (QuantReg: 12.31782) QuantErr: 12.31782 batch_time=1.47524 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 10.57195 (QuantReg: 12.58916) QuantErr: 12.58916 batch_time=0.42676 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 10.40256 (QuantReg: 12.45267) QuantErr: 12.45267 batch_time=0.46233 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 8.48481 (QuantReg: 12.75066) QuantErr: 12.75066 batch_time=0.43467 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 11.14439 (QuantReg: 12.54838) QuantErr: 12.54838 batch_time=1.38858 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 11.63404 (QuantReg: 12.26581) QuantErr: 12.26581 batch_time=0.40560 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 9.31251 (QuantReg: 12.41977) QuantErr: 12.41977 batch_time=0.39912 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 9.75538 (QuantReg: 12.79404) QuantErr: 12.79404 batch_time=0.40297 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 10.96668 (QuantReg: 12.66500) QuantErr: 12.66500 batch_time=0.39695 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 10.52263 (QuantReg: 12.72606) QuantErr: 12.72606 batch_time=0.41312 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 8.49262 (QuantReg: 12.55937) QuantErr: 12.55937 batch_time=0.40867 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 9.41067 (QuantReg: 12.71465) QuantErr: 12.71465 batch_time=0.38718 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 9.20572 (QuantReg: 12.90623) QuantErr: 12.90623 batch_time=0.39820 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 9.41025 (QuantReg: 12.59591) QuantErr: 12.59591 batch_time=0.40610 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 10.61233 (QuantReg: 12.42328) QuantErr: 12.42328 batch_time=0.39704 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 10.10862 (QuantReg: 12.77298) QuantErr: 12.77298 batch_time=0.40720 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 10.10660 (QuantReg: 12.69085) QuantErr: 12.69085 batch_time=0.89570 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 8.55681 (QuantReg: 12.74833) QuantErr: 12.74833 batch_time=0.62617 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 10.47851 (QuantReg: 12.95223) QuantErr: 12.95223 batch_time=0.39872 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 7.87555 (QuantReg: 12.70770) QuantErr: 12.70770 batch_time=0.40789 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 10.03855 (QuantReg: 12.79200) QuantErr: 12.79200 batch_time=0.43509 
Train Epoch: 6 codebook_update_time=0.41077
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch6.pth ...
Done in 3.995s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch6.pth ...
Done in 8.001s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 9.975176193237305
 quant_reg      : 12.583457447052002
 quant_err      : 12.583457447052002
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.825
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.81025822012168
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.3775
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.001394224006745
 mnt_best       : 37.81025822012168
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 10.60649 (QuantReg: 12.23388) QuantErr: 12.23388 batch_time=32.68623 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 10.89719 (QuantReg: 12.35557) QuantErr: 12.35557 batch_time=0.41835 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 9.69593 (QuantReg: 12.65350) QuantErr: 12.65350 batch_time=0.66928 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 9.69336 (QuantReg: 12.36890) QuantErr: 12.36890 batch_time=0.43093 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 8.74679 (QuantReg: 12.44633) QuantErr: 12.44633 batch_time=0.61724 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 10.78136 (QuantReg: 12.29810) QuantErr: 12.29810 batch_time=0.41786 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 9.87528 (QuantReg: 12.61423) QuantErr: 12.61423 batch_time=0.39843 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 11.17823 (QuantReg: 12.60805) QuantErr: 12.60805 batch_time=0.42009 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 9.20951 (QuantReg: 12.62326) QuantErr: 12.62326 batch_time=1.88804 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 8.74079 (QuantReg: 12.45423) QuantErr: 12.45423 batch_time=0.41939 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 9.60928 (QuantReg: 12.42056) QuantErr: 12.42056 batch_time=0.43956 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 7.96801 (QuantReg: 12.55946) QuantErr: 12.55946 batch_time=0.39658 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 8.01719 (QuantReg: 12.85612) QuantErr: 12.85612 batch_time=2.96292 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 8.69294 (QuantReg: 12.60858) QuantErr: 12.60858 batch_time=0.41194 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 9.49041 (QuantReg: 12.56865) QuantErr: 12.56865 batch_time=0.40873 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 8.31732 (QuantReg: 12.75338) QuantErr: 12.75338 batch_time=0.39623 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 9.78683 (QuantReg: 12.84741) QuantErr: 12.84741 batch_time=0.41532 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 9.75938 (QuantReg: 12.78577) QuantErr: 12.78577 batch_time=0.40176 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 9.67973 (QuantReg: 12.80883) QuantErr: 12.80883 batch_time=0.41277 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 10.13135 (QuantReg: 13.23354) QuantErr: 13.23354 batch_time=0.42707 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 9.53996 (QuantReg: 12.39929) QuantErr: 12.39929 batch_time=0.43924 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 10.01301 (QuantReg: 12.46303) QuantErr: 12.46303 batch_time=0.43766 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 9.98065 (QuantReg: 12.48269) QuantErr: 12.48269 batch_time=0.41589 
Train Epoch: 7 codebook_update_time=0.41805
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch7.pth ...
Done in 4.062s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch7.pth ...
Done in 8.106s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 9.485170423507691
 quant_reg      : 12.611811603546142
 quant_err      : 12.611811603546142
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.211
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.0993613880188
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.9345
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.18259935053855
 mnt_best       : 38.0993613880188
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 9.52489 (QuantReg: 12.61207) QuantErr: 12.61207 batch_time=33.55729 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 8.60824 (QuantReg: 12.42291) QuantErr: 12.42291 batch_time=0.38903 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 9.49709 (QuantReg: 12.75626) QuantErr: 12.75626 batch_time=0.44118 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 8.55107 (QuantReg: 12.50251) QuantErr: 12.50251 batch_time=0.42038 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 8.04855 (QuantReg: 12.63429) QuantErr: 12.63429 batch_time=0.41305 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 9.90868 (QuantReg: 12.52962) QuantErr: 12.52962 batch_time=0.39178 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 7.62863 (QuantReg: 12.81013) QuantErr: 12.81013 batch_time=4.39079 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 9.86226 (QuantReg: 12.64535) QuantErr: 12.64535 batch_time=0.41502 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 9.89731 (QuantReg: 12.52555) QuantErr: 12.52555 batch_time=0.40075 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 8.76327 (QuantReg: 12.57957) QuantErr: 12.57957 batch_time=0.40170 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 8.81894 (QuantReg: 12.88789) QuantErr: 12.88789 batch_time=0.51429 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 7.43205 (QuantReg: 12.87558) QuantErr: 12.87558 batch_time=0.42934 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 8.25625 (QuantReg: 12.60913) QuantErr: 12.60913 batch_time=2.21049 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 8.20896 (QuantReg: 12.64822) QuantErr: 12.64822 batch_time=0.41794 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 9.02013 (QuantReg: 12.85848) QuantErr: 12.85848 batch_time=1.03082 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 8.87451 (QuantReg: 12.38881) QuantErr: 12.38881 batch_time=0.40401 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 9.03592 (QuantReg: 12.22385) QuantErr: 12.22385 batch_time=0.41685 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 7.83178 (QuantReg: 12.79834) QuantErr: 12.79834 batch_time=0.43092 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 9.13358 (QuantReg: 12.51347) QuantErr: 12.51347 batch_time=0.39272 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 8.75480 (QuantReg: 12.76244) QuantErr: 12.76244 batch_time=0.41231 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 8.59431 (QuantReg: 12.99070) QuantErr: 12.99070 batch_time=0.42657 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 8.08138 (QuantReg: 12.80396) QuantErr: 12.80396 batch_time=0.41451 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 8.67510 (QuantReg: 13.00875) QuantErr: 13.00875 batch_time=0.41374 
Train Epoch: 8 codebook_update_time=0.48075
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch8.pth ...
Done in 6.628s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch8.pth ...
Done in 10.848s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 8.884602375030518
 quant_reg      : 12.667705047607422
 quant_err      : 12.667705047607422
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.369
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.51445884089931
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.295
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.7711728342804
 mnt_best       : 38.51445884089931
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 10.83327 (QuantReg: 12.44192) QuantErr: 12.44192 batch_time=31.44483 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 7.78376 (QuantReg: 12.59783) QuantErr: 12.59783 batch_time=0.40360 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 7.47478 (QuantReg: 12.31277) QuantErr: 12.31277 batch_time=0.39575 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 7.22692 (QuantReg: 12.76992) QuantErr: 12.76992 batch_time=0.58177 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 6.70930 (QuantReg: 12.70900) QuantErr: 12.70900 batch_time=0.40420 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 9.61696 (QuantReg: 12.67978) QuantErr: 12.67978 batch_time=0.40283 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 9.48224 (QuantReg: 12.79177) QuantErr: 12.79177 batch_time=0.40931 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 10.05605 (QuantReg: 12.88045) QuantErr: 12.88045 batch_time=0.39976 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 7.22661 (QuantReg: 12.40174) QuantErr: 12.40174 batch_time=0.40716 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 7.15819 (QuantReg: 12.51694) QuantErr: 12.51694 batch_time=0.39165 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 7.67983 (QuantReg: 12.78156) QuantErr: 12.78156 batch_time=0.42628 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 8.28570 (QuantReg: 12.64998) QuantErr: 12.64998 batch_time=0.40936 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 8.34768 (QuantReg: 12.88755) QuantErr: 12.88755 batch_time=0.51043 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 7.90854 (QuantReg: 12.76347) QuantErr: 12.76347 batch_time=0.39349 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 8.80789 (QuantReg: 12.85791) QuantErr: 12.85791 batch_time=0.40367 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 9.19300 (QuantReg: 12.96416) QuantErr: 12.96416 batch_time=0.40734 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 9.96194 (QuantReg: 12.80100) QuantErr: 12.80100 batch_time=0.42739 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 9.25969 (QuantReg: 12.94212) QuantErr: 12.94212 batch_time=0.80264 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 7.91879 (QuantReg: 12.88391) QuantErr: 12.88391 batch_time=0.42168 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 7.86782 (QuantReg: 12.74798) QuantErr: 12.74798 batch_time=0.39622 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 6.87076 (QuantReg: 12.84495) QuantErr: 12.84495 batch_time=0.39562 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 8.15410 (QuantReg: 12.81449) QuantErr: 12.81449 batch_time=0.40576 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 8.46560 (QuantReg: 12.69545) QuantErr: 12.69545 batch_time=0.41379 
Train Epoch: 9 codebook_update_time=0.41206
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch9.pth ...
Done in 4.286s
removing stale ckpt [epoch 8] [took 0.01s]
 epoch          : 9
 loss           : 8.48283512687683
 quant_reg      : 12.697519046783448
 quant_err      : 12.697519046783448
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.395
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.20155599776477
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.739
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.37701425825739
 mnt_best       : 38.51445884089931
 not_improved_count: 1
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 8.76037 (QuantReg: 12.18103) QuantErr: 12.18103 batch_time=34.31338 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 7.98707 (QuantReg: 12.50125) QuantErr: 12.50125 batch_time=3.73432 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 7.09051 (QuantReg: 12.68064) QuantErr: 12.68064 batch_time=0.40259 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 7.86764 (QuantReg: 12.44822) QuantErr: 12.44822 batch_time=0.51620 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 7.47641 (QuantReg: 12.95454) QuantErr: 12.95454 batch_time=0.41823 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 8.53437 (QuantReg: 12.46325) QuantErr: 12.46325 batch_time=0.42032 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 8.11817 (QuantReg: 12.65813) QuantErr: 12.65813 batch_time=0.40303 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 7.64055 (QuantReg: 12.59554) QuantErr: 12.59554 batch_time=0.40749 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 9.07076 (QuantReg: 12.70741) QuantErr: 12.70741 batch_time=0.40439 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 8.84169 (QuantReg: 12.55760) QuantErr: 12.55760 batch_time=0.40038 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 6.76395 (QuantReg: 12.55511) QuantErr: 12.55511 batch_time=0.39461 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 6.99980 (QuantReg: 12.79447) QuantErr: 12.79447 batch_time=0.41844 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 10.14534 (QuantReg: 12.76794) QuantErr: 12.76794 batch_time=0.40160 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 8.27483 (QuantReg: 12.81191) QuantErr: 12.81191 batch_time=0.48613 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 7.13125 (QuantReg: 12.70729) QuantErr: 12.70729 batch_time=0.42977 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 8.70642 (QuantReg: 12.97421) QuantErr: 12.97421 batch_time=0.41529 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 7.28192 (QuantReg: 12.61546) QuantErr: 12.61546 batch_time=0.43677 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 7.37152 (QuantReg: 13.21454) QuantErr: 13.21454 batch_time=0.40423 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 7.31972 (QuantReg: 12.74782) QuantErr: 12.74782 batch_time=0.52289 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 6.49162 (QuantReg: 12.87168) QuantErr: 12.87168 batch_time=1.16294 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 7.19156 (QuantReg: 12.67502) QuantErr: 12.67502 batch_time=0.40377 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 7.66430 (QuantReg: 12.98000) QuantErr: 12.98000 batch_time=0.39521 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 9.20044 (QuantReg: 12.77950) QuantErr: 12.77950 batch_time=0.43978 
Train Epoch: 10 codebook_update_time=0.40059
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch10.pth ...
Done in 5.081s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch10.pth ...
Done in 9.268s
removing stale ckpt [epoch 9] [took 0.26s]
 epoch          : 10
 loss           : 8.044992963790893
 quant_reg      : 12.748514339447022
 quant_err      : 12.748514339447022
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.885
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.37598233880782
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.66
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.76264181321692
 mnt_best       : 39.37598233880782
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 7.35103 (QuantReg: 12.80166) QuantErr: 12.80166 batch_time=33.56380 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 6.47959 (QuantReg: 12.53065) QuantErr: 12.53065 batch_time=0.53640 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 8.44981 (QuantReg: 13.23362) QuantErr: 13.23362 batch_time=0.40111 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 9.75651 (QuantReg: 12.89889) QuantErr: 12.89889 batch_time=0.43381 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 9.86534 (QuantReg: 12.66787) QuantErr: 12.66787 batch_time=0.40593 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 8.88970 (QuantReg: 12.71701) QuantErr: 12.71701 batch_time=0.39763 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 7.86581 (QuantReg: 13.09060) QuantErr: 13.09060 batch_time=0.42463 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 7.83046 (QuantReg: 12.84917) QuantErr: 12.84917 batch_time=0.41193 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 8.35333 (QuantReg: 12.96878) QuantErr: 12.96878 batch_time=0.40528 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 9.64545 (QuantReg: 12.67223) QuantErr: 12.67223 batch_time=0.45793 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 8.88815 (QuantReg: 13.33784) QuantErr: 13.33784 batch_time=0.40306 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 8.05561 (QuantReg: 12.34808) QuantErr: 12.34808 batch_time=0.39562 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 8.30161 (QuantReg: 12.59169) QuantErr: 12.59169 batch_time=0.40268 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 4.80141 (QuantReg: 13.03533) QuantErr: 13.03533 batch_time=1.04102 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 8.97216 (QuantReg: 12.45088) QuantErr: 12.45088 batch_time=0.40306 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 6.88998 (QuantReg: 12.40293) QuantErr: 12.40293 batch_time=0.43969 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 7.20674 (QuantReg: 12.56869) QuantErr: 12.56869 batch_time=0.40402 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 6.97741 (QuantReg: 12.89061) QuantErr: 12.89061 batch_time=0.48396 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 7.46397 (QuantReg: 12.72601) QuantErr: 12.72601 batch_time=0.40028 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 7.40719 (QuantReg: 12.82140) QuantErr: 12.82140 batch_time=0.39802 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 8.33196 (QuantReg: 12.70249) QuantErr: 12.70249 batch_time=0.41804 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 8.22967 (QuantReg: 12.66888) QuantErr: 12.66888 batch_time=0.40195 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 8.05300 (QuantReg: 12.90371) QuantErr: 12.90371 batch_time=0.42650 
Train Epoch: 11 codebook_update_time=0.40394
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch11.pth ...
Done in 5.185s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch11.pth ...
Done in 10.326s
removing stale ckpt [epoch 10] [took 0.06s]
 epoch          : 11
 loss           : 7.780303745269776
 quant_reg      : 12.800252136230469
 quant_err      : 12.800252136230469
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.72
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.18873061833376
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.094
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.434514911906284
 mnt_best       : 40.18873061833376
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 8.06305 (QuantReg: 12.65782) QuantErr: 12.65782 batch_time=30.62298 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 8.63284 (QuantReg: 12.83118) QuantErr: 12.83118 batch_time=0.41075 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 7.98177 (QuantReg: 12.70335) QuantErr: 12.70335 batch_time=0.46438 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 8.02357 (QuantReg: 12.69905) QuantErr: 12.69905 batch_time=0.40901 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 6.17825 (QuantReg: 12.74398) QuantErr: 12.74398 batch_time=0.43136 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 8.35949 (QuantReg: 12.59422) QuantErr: 12.59422 batch_time=0.40777 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 6.53178 (QuantReg: 12.90483) QuantErr: 12.90483 batch_time=0.55667 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 7.97120 (QuantReg: 13.32086) QuantErr: 13.32086 batch_time=0.40583 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 7.32813 (QuantReg: 13.04076) QuantErr: 13.04076 batch_time=0.40344 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 7.22633 (QuantReg: 12.79791) QuantErr: 12.79791 batch_time=0.40736 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 6.81148 (QuantReg: 12.73635) QuantErr: 12.73635 batch_time=0.40893 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 7.29881 (QuantReg: 13.12912) QuantErr: 13.12912 batch_time=0.39608 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 5.60920 (QuantReg: 12.97483) QuantErr: 12.97483 batch_time=0.41453 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 7.20103 (QuantReg: 13.18120) QuantErr: 13.18120 batch_time=0.39364 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 8.29144 (QuantReg: 12.76483) QuantErr: 12.76483 batch_time=0.41485 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 7.00132 (QuantReg: 12.58759) QuantErr: 12.58759 batch_time=0.39337 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 5.72040 (QuantReg: 13.05137) QuantErr: 13.05137 batch_time=0.43688 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 6.59421 (QuantReg: 12.94749) QuantErr: 12.94749 batch_time=0.40764 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 6.32073 (QuantReg: 12.90312) QuantErr: 12.90312 batch_time=0.43273 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 5.91629 (QuantReg: 13.05021) QuantErr: 13.05021 batch_time=0.40836 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 7.57219 (QuantReg: 12.52747) QuantErr: 12.52747 batch_time=0.41629 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 6.73163 (QuantReg: 12.88161) QuantErr: 12.88161 batch_time=0.40153 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 7.73983 (QuantReg: 13.02828) QuantErr: 13.02828 batch_time=0.42902 
Train Epoch: 12 codebook_update_time=0.48066
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch12.pth ...
Done in 6.036s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch12.pth ...
Done in 11.053s
removing stale ckpt [epoch 11] [took 0.02s]
 epoch          : 12
 loss           : 7.411656030654907
 quant_reg      : 12.81410870361328
 quant_err      : 12.81410870361328
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.564
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.267393945584274
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.0835
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.1007128767574
 mnt_best       : 40.267393945584274
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 7.40923 (QuantReg: 12.97528) QuantErr: 12.97528 batch_time=34.26619 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 8.10367 (QuantReg: 12.71417) QuantErr: 12.71417 batch_time=0.45881 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 7.96632 (QuantReg: 12.91928) QuantErr: 12.91928 batch_time=0.41751 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 8.39677 (QuantReg: 12.59961) QuantErr: 12.59961 batch_time=0.42806 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 7.05208 (QuantReg: 13.13901) QuantErr: 13.13901 batch_time=0.75312 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 5.52174 (QuantReg: 12.44495) QuantErr: 12.44495 batch_time=0.40073 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 6.16804 (QuantReg: 12.75804) QuantErr: 12.75804 batch_time=0.41097 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 6.08708 (QuantReg: 12.79925) QuantErr: 12.79925 batch_time=0.43686 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 5.28711 (QuantReg: 13.12669) QuantErr: 13.12669 batch_time=0.39257 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 6.93757 (QuantReg: 12.97984) QuantErr: 12.97984 batch_time=0.41669 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 6.72709 (QuantReg: 12.97668) QuantErr: 12.97668 batch_time=0.40990 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 7.03457 (QuantReg: 12.83501) QuantErr: 12.83501 batch_time=0.41261 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 7.26807 (QuantReg: 12.79970) QuantErr: 12.79970 batch_time=2.55231 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 7.63209 (QuantReg: 13.05536) QuantErr: 13.05536 batch_time=0.55403 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 7.15594 (QuantReg: 12.68851) QuantErr: 12.68851 batch_time=0.41231 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 5.79995 (QuantReg: 12.73102) QuantErr: 12.73102 batch_time=0.40611 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 6.46719 (QuantReg: 13.05532) QuantErr: 13.05532 batch_time=0.41732 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 6.16924 (QuantReg: 13.27516) QuantErr: 13.27516 batch_time=0.39676 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 7.54944 (QuantReg: 12.94684) QuantErr: 12.94684 batch_time=0.64287 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 8.40273 (QuantReg: 12.68018) QuantErr: 12.68018 batch_time=0.41428 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 6.57141 (QuantReg: 12.99979) QuantErr: 12.99979 batch_time=0.42905 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 5.74057 (QuantReg: 12.90015) QuantErr: 12.90015 batch_time=0.40790 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 8.20078 (QuantReg: 12.97029) QuantErr: 12.97029 batch_time=0.41400 
Train Epoch: 13 codebook_update_time=0.40106
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch13.pth ...
Done in 5.409s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch13.pth ...
Done in 11.192s
removing stale ckpt [epoch 12] [took 0.05s]
 epoch          : 13
 loss           : 7.02504034614563
 quant_reg      : 12.871180019378663
 quant_err      : 12.871180019378663
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.054
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.7904581684871
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.705
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.59825617171393
 mnt_best       : 40.7904581684871
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 7.15736 (QuantReg: 12.74826) QuantErr: 12.74826 batch_time=32.53367 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 6.12219 (QuantReg: 12.99340) QuantErr: 12.99340 batch_time=0.40494 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 6.32835 (QuantReg: 12.85383) QuantErr: 12.85383 batch_time=0.43317 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 6.09497 (QuantReg: 12.92932) QuantErr: 12.92932 batch_time=0.42376 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 7.12305 (QuantReg: 12.67710) QuantErr: 12.67710 batch_time=0.43171 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 6.56391 (QuantReg: 13.19607) QuantErr: 13.19607 batch_time=0.40260 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 7.37077 (QuantReg: 12.73570) QuantErr: 12.73570 batch_time=3.41072 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 7.99631 (QuantReg: 12.79237) QuantErr: 12.79237 batch_time=0.41183 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 7.43769 (QuantReg: 12.68228) QuantErr: 12.68228 batch_time=0.40460 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 6.06979 (QuantReg: 12.91980) QuantErr: 12.91980 batch_time=0.40127 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 6.13618 (QuantReg: 13.10490) QuantErr: 13.10490 batch_time=0.40790 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 6.73133 (QuantReg: 12.94673) QuantErr: 12.94673 batch_time=0.41929 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 5.08849 (QuantReg: 13.12467) QuantErr: 13.12467 batch_time=0.43971 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 6.49199 (QuantReg: 12.90169) QuantErr: 12.90169 batch_time=1.22372 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 6.54067 (QuantReg: 12.91561) QuantErr: 12.91561 batch_time=0.40780 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 6.71911 (QuantReg: 12.77050) QuantErr: 12.77050 batch_time=0.40660 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 6.40124 (QuantReg: 12.96953) QuantErr: 12.96953 batch_time=0.43364 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 6.42562 (QuantReg: 13.05136) QuantErr: 13.05136 batch_time=0.42363 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 6.86131 (QuantReg: 12.68874) QuantErr: 12.68874 batch_time=0.40932 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 8.71986 (QuantReg: 12.90602) QuantErr: 12.90602 batch_time=2.20149 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 8.45679 (QuantReg: 12.82066) QuantErr: 12.82066 batch_time=0.41370 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 7.47372 (QuantReg: 12.89963) QuantErr: 12.89963 batch_time=0.39470 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 6.98023 (QuantReg: 13.15868) QuantErr: 13.15868 batch_time=0.41177 
Train Epoch: 14 codebook_update_time=0.40223
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch14.pth ...
Done in 6.123s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch14.pth ...
Done in 11.695s
removing stale ckpt [epoch 13] [took 0.04s]
 epoch          : 14
 loss           : 6.870436309814453
 quant_reg      : 12.860804496765137
 quant_err      : 12.860804496765137
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.312
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.07362370073946
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6525
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.45053961444699
 mnt_best       : 42.07362370073946
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 5.59312 (QuantReg: 12.66464) QuantErr: 12.66464 batch_time=33.85774 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 7.01797 (QuantReg: 12.83729) QuantErr: 12.83729 batch_time=7.97576 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 7.04308 (QuantReg: 13.02156) QuantErr: 13.02156 batch_time=0.39775 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 8.59320 (QuantReg: 12.74196) QuantErr: 12.74196 batch_time=0.39074 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 7.08409 (QuantReg: 12.80041) QuantErr: 12.80041 batch_time=0.39875 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 7.07528 (QuantReg: 12.50665) QuantErr: 12.50665 batch_time=0.40022 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 7.29365 (QuantReg: 12.77706) QuantErr: 12.77706 batch_time=0.41501 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 6.17498 (QuantReg: 12.31651) QuantErr: 12.31651 batch_time=0.40523 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 7.59708 (QuantReg: 12.79210) QuantErr: 12.79210 batch_time=0.79963 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 5.80577 (QuantReg: 12.59701) QuantErr: 12.59701 batch_time=0.39588 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 7.78487 (QuantReg: 12.95828) QuantErr: 12.95828 batch_time=0.40603 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 6.99581 (QuantReg: 13.03583) QuantErr: 13.03583 batch_time=0.44529 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 7.23697 (QuantReg: 13.22307) QuantErr: 13.22307 batch_time=0.40423 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 7.41190 (QuantReg: 13.14647) QuantErr: 13.14647 batch_time=0.39660 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 6.30276 (QuantReg: 12.97085) QuantErr: 12.97085 batch_time=0.46448 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 6.72693 (QuantReg: 13.17130) QuantErr: 13.17130 batch_time=0.39923 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 7.46149 (QuantReg: 13.03708) QuantErr: 13.03708 batch_time=0.41758 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 5.56473 (QuantReg: 13.00567) QuantErr: 13.00567 batch_time=0.39744 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 6.58166 (QuantReg: 12.41300) QuantErr: 12.41300 batch_time=0.41187 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 6.26628 (QuantReg: 12.63051) QuantErr: 12.63051 batch_time=0.85165 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 6.32864 (QuantReg: 12.99443) QuantErr: 12.99443 batch_time=0.40957 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 8.52096 (QuantReg: 12.99270) QuantErr: 12.99270 batch_time=0.41949 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 6.64109 (QuantReg: 13.01869) QuantErr: 13.01869 batch_time=0.39979 
Train Epoch: 15 codebook_update_time=0.41450
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch15.pth ...
Done in 5.253s
removing stale ckpt [epoch 14] [took 0.04s]
 epoch          : 15
 loss           : 6.690486951828003
 quant_reg      : 12.881893226623536
 quant_err      : 12.881893226623536
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.227
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.92230079101122
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.1175
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.5977300906414
 mnt_best       : 42.07362370073946
 not_improved_count: 1
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 6.60174 (QuantReg: 12.55173) QuantErr: 12.55173 batch_time=34.76253 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 6.56935 (QuantReg: 13.10868) QuantErr: 13.10868 batch_time=0.41806 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 6.94822 (QuantReg: 12.63093) QuantErr: 12.63093 batch_time=0.42929 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 5.27943 (QuantReg: 13.18504) QuantErr: 13.18504 batch_time=0.41185 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 6.25664 (QuantReg: 13.18044) QuantErr: 13.18044 batch_time=0.42997 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 6.48193 (QuantReg: 12.63157) QuantErr: 12.63157 batch_time=0.42540 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 6.51690 (QuantReg: 12.70459) QuantErr: 12.70459 batch_time=0.42965 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 5.75000 (QuantReg: 13.09262) QuantErr: 13.09262 batch_time=0.41827 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 6.48270 (QuantReg: 13.00586) QuantErr: 13.00586 batch_time=0.40817 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 8.10575 (QuantReg: 12.60565) QuantErr: 12.60565 batch_time=0.39657 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 5.62029 (QuantReg: 12.93401) QuantErr: 12.93401 batch_time=0.41663 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 6.63064 (QuantReg: 12.86917) QuantErr: 12.86917 batch_time=0.42236 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 6.05167 (QuantReg: 13.00530) QuantErr: 13.00530 batch_time=0.40977 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 6.45085 (QuantReg: 13.24948) QuantErr: 13.24948 batch_time=0.41793 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 6.21340 (QuantReg: 12.87216) QuantErr: 12.87216 batch_time=0.39907 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 4.99667 (QuantReg: 12.92121) QuantErr: 12.92121 batch_time=0.40550 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 7.05327 (QuantReg: 12.98247) QuantErr: 12.98247 batch_time=0.40674 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 7.72905 (QuantReg: 12.90691) QuantErr: 12.90691 batch_time=0.42047 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 5.95080 (QuantReg: 12.95888) QuantErr: 12.95888 batch_time=0.41061 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 5.43159 (QuantReg: 13.07290) QuantErr: 13.07290 batch_time=1.16241 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 6.27003 (QuantReg: 13.09420) QuantErr: 13.09420 batch_time=0.38395 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 5.93762 (QuantReg: 12.71349) QuantErr: 12.71349 batch_time=0.45235 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 5.40598 (QuantReg: 12.93149) QuantErr: 12.93149 batch_time=0.41507 
Train Epoch: 16 codebook_update_time=0.40686
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch16.pth ...
Done in 7.074s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 6.5144998149871824
 quant_reg      : 12.878151222229004
 quant_err      : 12.878151222229004
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.654
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.77708808990035
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.28903828041837
 mnt_best       : 42.07362370073946
 not_improved_count: 2
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 6.39951 (QuantReg: 12.76968) QuantErr: 12.76968 batch_time=34.25113 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 5.95605 (QuantReg: 12.75065) QuantErr: 12.75065 batch_time=0.39729 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 6.14109 (QuantReg: 13.05623) QuantErr: 13.05623 batch_time=0.39348 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 5.83272 (QuantReg: 12.96070) QuantErr: 12.96070 batch_time=0.38858 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 7.82986 (QuantReg: 12.57800) QuantErr: 12.57800 batch_time=0.41831 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 5.19259 (QuantReg: 12.91206) QuantErr: 12.91206 batch_time=0.41585 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 6.24828 (QuantReg: 12.72052) QuantErr: 12.72052 batch_time=0.39003 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 5.90593 (QuantReg: 13.08248) QuantErr: 13.08248 batch_time=0.39732 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 6.30931 (QuantReg: 12.89391) QuantErr: 12.89391 batch_time=0.39745 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 7.10293 (QuantReg: 12.88765) QuantErr: 12.88765 batch_time=0.39472 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 7.02775 (QuantReg: 12.85903) QuantErr: 12.85903 batch_time=1.90900 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 5.83074 (QuantReg: 12.98786) QuantErr: 12.98786 batch_time=0.40505 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 5.94087 (QuantReg: 12.78343) QuantErr: 12.78343 batch_time=0.42111 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 5.38061 (QuantReg: 13.11072) QuantErr: 13.11072 batch_time=0.39323 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 5.33661 (QuantReg: 12.93051) QuantErr: 12.93051 batch_time=0.41266 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 6.56348 (QuantReg: 12.53257) QuantErr: 12.53257 batch_time=0.41833 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 5.65201 (QuantReg: 13.19822) QuantErr: 13.19822 batch_time=0.40519 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 6.27662 (QuantReg: 12.90548) QuantErr: 12.90548 batch_time=0.40557 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 6.47814 (QuantReg: 12.85484) QuantErr: 12.85484 batch_time=0.39629 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 6.91469 (QuantReg: 12.76907) QuantErr: 12.76907 batch_time=0.40682 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 4.90914 (QuantReg: 12.90149) QuantErr: 12.90149 batch_time=0.40486 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 6.17769 (QuantReg: 13.31218) QuantErr: 13.31218 batch_time=0.54423 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 6.44450 (QuantReg: 13.04609) QuantErr: 13.04609 batch_time=0.40844 
Train Epoch: 17 codebook_update_time=0.57710
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch17.pth ...
Done in 6.621s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch17.pth ...
Done in 11.712s
removing stale ckpt [epoch 16] [took 0.03s]
 epoch          : 17
 loss           : 6.3001297740936275
 quant_reg      : 12.911270156860352
 quant_err      : 12.911270156860352
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.27
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.274494625443516
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.086766478466345
 mnt_best       : 42.274494625443516
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 5.77107 (QuantReg: 12.87864) QuantErr: 12.87864 batch_time=32.48143 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 6.75183 (QuantReg: 12.61533) QuantErr: 12.61533 batch_time=0.42384 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 6.03102 (QuantReg: 12.62816) QuantErr: 12.62816 batch_time=0.42293 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 5.78947 (QuantReg: 12.84928) QuantErr: 12.84928 batch_time=0.40076 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 7.53168 (QuantReg: 12.92741) QuantErr: 12.92741 batch_time=0.39731 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 7.63192 (QuantReg: 12.68035) QuantErr: 12.68035 batch_time=0.40186 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 5.17412 (QuantReg: 13.02421) QuantErr: 13.02421 batch_time=0.99748 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 7.65543 (QuantReg: 12.86955) QuantErr: 12.86955 batch_time=0.40868 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 6.10378 (QuantReg: 12.84483) QuantErr: 12.84483 batch_time=0.42639 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 5.96399 (QuantReg: 13.26537) QuantErr: 13.26537 batch_time=0.40244 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 6.80713 (QuantReg: 13.10692) QuantErr: 13.10692 batch_time=0.39054 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 6.23826 (QuantReg: 12.64892) QuantErr: 12.64892 batch_time=0.40282 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 6.45600 (QuantReg: 12.95918) QuantErr: 12.95918 batch_time=0.42081 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 9.03003 (QuantReg: 12.36740) QuantErr: 12.36740 batch_time=0.42827 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 6.59581 (QuantReg: 13.24347) QuantErr: 13.24347 batch_time=0.77913 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 6.97717 (QuantReg: 12.67367) QuantErr: 12.67367 batch_time=0.39852 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 5.90432 (QuantReg: 13.32655) QuantErr: 13.32655 batch_time=0.39714 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 7.50654 (QuantReg: 12.90810) QuantErr: 12.90810 batch_time=0.40052 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 6.43731 (QuantReg: 12.94792) QuantErr: 12.94792 batch_time=0.40647 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 6.57505 (QuantReg: 12.95585) QuantErr: 12.95585 batch_time=0.43860 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 6.16504 (QuantReg: 12.98960) QuantErr: 12.98960 batch_time=0.39519 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 5.01016 (QuantReg: 13.33979) QuantErr: 13.33979 batch_time=0.44751 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 6.32543 (QuantReg: 13.17681) QuantErr: 13.17681 batch_time=0.40593 
Train Epoch: 18 codebook_update_time=0.42148
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch18.pth ...
Done in 7.513s
removing stale ckpt [epoch 17] [took 0.37s]
 epoch          : 18
 loss           : 6.180512182235717
 quant_reg      : 12.930732425689698
 quant_err      : 12.930732425689698
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.898
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.26138633158416
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.0185
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.19044129616376
 mnt_best       : 42.274494625443516
 not_improved_count: 1
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 5.79125 (QuantReg: 12.79747) QuantErr: 12.79747 batch_time=33.42524 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 5.92369 (QuantReg: 12.68570) QuantErr: 12.68570 batch_time=0.40199 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 5.14818 (QuantReg: 13.18478) QuantErr: 13.18478 batch_time=0.40590 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 5.43680 (QuantReg: 13.34067) QuantErr: 13.34067 batch_time=0.39651 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 6.33167 (QuantReg: 12.61000) QuantErr: 12.61000 batch_time=1.32473 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 5.22292 (QuantReg: 12.85057) QuantErr: 12.85057 batch_time=0.40036 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 5.83505 (QuantReg: 12.79377) QuantErr: 12.79377 batch_time=0.39763 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 5.58791 (QuantReg: 12.79811) QuantErr: 12.79811 batch_time=0.41667 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 4.76161 (QuantReg: 12.74010) QuantErr: 12.74010 batch_time=0.40423 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 5.97305 (QuantReg: 13.02106) QuantErr: 13.02106 batch_time=0.41003 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 5.46878 (QuantReg: 12.97730) QuantErr: 12.97730 batch_time=0.39564 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 5.77292 (QuantReg: 12.97124) QuantErr: 12.97124 batch_time=0.42473 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 6.25012 (QuantReg: 12.65805) QuantErr: 12.65805 batch_time=0.39089 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 5.85807 (QuantReg: 13.05743) QuantErr: 13.05743 batch_time=0.51462 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 6.09333 (QuantReg: 12.50037) QuantErr: 12.50037 batch_time=0.40112 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 6.93490 (QuantReg: 12.65989) QuantErr: 12.65989 batch_time=0.65088 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 5.38312 (QuantReg: 13.15311) QuantErr: 13.15311 batch_time=0.39628 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 7.06050 (QuantReg: 13.07081) QuantErr: 13.07081 batch_time=0.40519 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 6.51377 (QuantReg: 13.11536) QuantErr: 13.11536 batch_time=0.75199 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 6.69664 (QuantReg: 12.78263) QuantErr: 12.78263 batch_time=0.40108 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 5.38132 (QuantReg: 12.76072) QuantErr: 12.76072 batch_time=0.42479 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 5.11080 (QuantReg: 12.90540) QuantErr: 12.90540 batch_time=0.39538 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 7.16317 (QuantReg: 13.00432) QuantErr: 13.00432 batch_time=0.40881 
Train Epoch: 19 codebook_update_time=0.39971
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch19.pth ...
Done in 5.377s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch19.pth ...
Done in 10.833s
removing stale ckpt [epoch 18] [took 0.05s]
 epoch          : 19
 loss           : 6.006155607223511
 quant_reg      : 12.932824947357178
 quant_err      : 12.932824947357178
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.103
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.81602560270977
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3245
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.259710476505575
 mnt_best       : 42.81602560270977
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 5.81512 (QuantReg: 13.16239) QuantErr: 13.16239 batch_time=40.62723 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 5.32128 (QuantReg: 13.15558) QuantErr: 13.15558 batch_time=0.39020 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 6.07668 (QuantReg: 12.68142) QuantErr: 12.68142 batch_time=0.39293 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 6.80906 (QuantReg: 12.88168) QuantErr: 12.88168 batch_time=0.41942 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 5.94039 (QuantReg: 13.26342) QuantErr: 13.26342 batch_time=0.39077 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 5.58344 (QuantReg: 12.93081) QuantErr: 12.93081 batch_time=0.40327 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 5.79695 (QuantReg: 13.04221) QuantErr: 13.04221 batch_time=0.40931 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 6.16526 (QuantReg: 12.64528) QuantErr: 12.64528 batch_time=0.40525 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 5.52218 (QuantReg: 12.99936) QuantErr: 12.99936 batch_time=0.40572 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 4.49859 (QuantReg: 13.16773) QuantErr: 13.16773 batch_time=0.41521 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 5.81832 (QuantReg: 12.42619) QuantErr: 12.42619 batch_time=0.40885 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 6.02175 (QuantReg: 13.09463) QuantErr: 13.09463 batch_time=0.43744 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 6.11664 (QuantReg: 13.07021) QuantErr: 13.07021 batch_time=0.40977 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 6.02998 (QuantReg: 12.99034) QuantErr: 12.99034 batch_time=0.43125 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 5.75700 (QuantReg: 13.24587) QuantErr: 13.24587 batch_time=0.40474 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 5.88157 (QuantReg: 13.13889) QuantErr: 13.13889 batch_time=0.40586 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 5.11280 (QuantReg: 13.30479) QuantErr: 13.30479 batch_time=0.42515 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 5.30906 (QuantReg: 12.99300) QuantErr: 12.99300 batch_time=0.44576 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 5.97690 (QuantReg: 13.31451) QuantErr: 13.31451 batch_time=0.42461 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 4.16503 (QuantReg: 13.36814) QuantErr: 13.36814 batch_time=0.44066 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 5.49756 (QuantReg: 12.58886) QuantErr: 12.58886 batch_time=0.43806 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 6.09105 (QuantReg: 13.20441) QuantErr: 13.20441 batch_time=0.40603 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 6.51240 (QuantReg: 13.26882) QuantErr: 13.26882 batch_time=0.40471 
Train Epoch: 20 codebook_update_time=0.40084
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch20.pth ...
Done in 5.010s
removing stale ckpt [epoch 19] [took 0.16s]
 epoch          : 20
 loss           : 5.8030338983535765
 quant_reg      : 13.024984031677246
 quant_err      : 13.024984031677246
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.399
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.67551349925012
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.865
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.0546199722397
 mnt_best       : 42.81602560270977
 not_improved_count: 1
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 5.37076 (QuantReg: 12.82508) QuantErr: 12.82508 batch_time=31.10786 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 6.75653 (QuantReg: 12.78872) QuantErr: 12.78872 batch_time=0.50664 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 5.09295 (QuantReg: 13.11251) QuantErr: 13.11251 batch_time=0.41133 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 5.34755 (QuantReg: 13.04426) QuantErr: 13.04426 batch_time=1.31876 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 6.92203 (QuantReg: 12.96308) QuantErr: 12.96308 batch_time=0.39365 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 6.18312 (QuantReg: 12.76104) QuantErr: 12.76104 batch_time=0.39521 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 7.56111 (QuantReg: 12.58952) QuantErr: 12.58952 batch_time=0.43054 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 5.77625 (QuantReg: 13.04691) QuantErr: 13.04691 batch_time=0.63574 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 5.64130 (QuantReg: 12.94687) QuantErr: 12.94687 batch_time=0.45239 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 6.41936 (QuantReg: 13.10015) QuantErr: 13.10015 batch_time=0.38519 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 4.96750 (QuantReg: 13.07680) QuantErr: 13.07680 batch_time=0.39287 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 4.89145 (QuantReg: 12.97395) QuantErr: 12.97395 batch_time=0.38812 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 5.52055 (QuantReg: 12.94613) QuantErr: 12.94613 batch_time=1.12651 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 5.81511 (QuantReg: 12.95347) QuantErr: 12.95347 batch_time=1.20095 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 5.10929 (QuantReg: 13.02149) QuantErr: 13.02149 batch_time=0.41428 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 6.49246 (QuantReg: 13.04524) QuantErr: 13.04524 batch_time=0.39619 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 4.56977 (QuantReg: 13.12626) QuantErr: 13.12626 batch_time=0.41537 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 4.52680 (QuantReg: 12.92436) QuantErr: 12.92436 batch_time=0.41268 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 7.39312 (QuantReg: 13.16876) QuantErr: 13.16876 batch_time=0.47448 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 4.20971 (QuantReg: 13.06866) QuantErr: 13.06866 batch_time=1.14686 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 4.06611 (QuantReg: 13.16698) QuantErr: 13.16698 batch_time=0.43343 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 4.79687 (QuantReg: 13.09310) QuantErr: 13.09310 batch_time=0.43806 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 6.96120 (QuantReg: 12.95165) QuantErr: 12.95165 batch_time=0.46402 
Train Epoch: 21 codebook_update_time=0.41481
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch21.pth ...
Done in 4.805s
removing stale ckpt [epoch 20] [took 0.18s]
 epoch          : 21
 loss           : 5.66192188167572
 quant_reg      : 13.024341827392577
 quant_err      : 13.024341827392577
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.823
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.079017910811935
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6695
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.12957561476359
 mnt_best       : 42.81602560270977
 not_improved_count: 2
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 5.86615 (QuantReg: 13.14936) QuantErr: 13.14936 batch_time=30.55954 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 7.06685 (QuantReg: 13.15864) QuantErr: 13.15864 batch_time=0.40847 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 4.60752 (QuantReg: 12.88122) QuantErr: 12.88122 batch_time=0.41390 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 6.04803 (QuantReg: 12.79880) QuantErr: 12.79880 batch_time=0.41070 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 5.73088 (QuantReg: 13.14653) QuantErr: 13.14653 batch_time=0.39825 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 4.09517 (QuantReg: 13.34959) QuantErr: 13.34959 batch_time=0.39666 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 4.47929 (QuantReg: 13.11069) QuantErr: 13.11069 batch_time=0.43141 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 6.27925 (QuantReg: 12.88094) QuantErr: 12.88094 batch_time=1.04151 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 6.28077 (QuantReg: 13.01073) QuantErr: 13.01073 batch_time=0.39651 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 4.89961 (QuantReg: 12.90742) QuantErr: 12.90742 batch_time=0.41227 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 6.68364 (QuantReg: 12.62945) QuantErr: 12.62945 batch_time=0.41089 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 5.62333 (QuantReg: 13.17078) QuantErr: 13.17078 batch_time=0.39296 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 5.59004 (QuantReg: 12.39059) QuantErr: 12.39059 batch_time=1.09142 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 6.30917 (QuantReg: 12.94486) QuantErr: 12.94486 batch_time=2.76416 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 6.77861 (QuantReg: 12.93846) QuantErr: 12.93846 batch_time=0.42043 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 5.67253 (QuantReg: 13.15432) QuantErr: 13.15432 batch_time=0.63640 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 6.49796 (QuantReg: 12.90418) QuantErr: 12.90418 batch_time=0.38912 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 4.13932 (QuantReg: 13.15206) QuantErr: 13.15206 batch_time=0.39755 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 5.00056 (QuantReg: 13.21357) QuantErr: 13.21357 batch_time=0.40012 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 5.80508 (QuantReg: 13.25779) QuantErr: 13.25779 batch_time=0.40103 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 5.45921 (QuantReg: 13.03575) QuantErr: 13.03575 batch_time=0.40893 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 5.80257 (QuantReg: 13.15446) QuantErr: 13.15446 batch_time=0.45881 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 4.82495 (QuantReg: 13.23341) QuantErr: 13.23341 batch_time=0.41825 
Train Epoch: 22 codebook_update_time=0.43548
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch22.pth ...
Done in 5.886s
removing stale ckpt [epoch 21] [took 0.01s]
 epoch          : 22
 loss           : 5.620980299949646
 quant_reg      : 13.02365210723877
 quant_err      : 13.02365210723877
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.871
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.692597626844844
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.934
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.13654861749809
 mnt_best       : 42.81602560270977
 not_improved_count: 3
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 6.52013 (QuantReg: 12.99806) QuantErr: 12.99806 batch_time=31.74851 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 5.41489 (QuantReg: 12.99777) QuantErr: 12.99777 batch_time=0.40322 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 4.72225 (QuantReg: 12.97515) QuantErr: 12.97515 batch_time=0.44540 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 5.97198 (QuantReg: 13.13265) QuantErr: 13.13265 batch_time=0.41373 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 5.34688 (QuantReg: 12.93893) QuantErr: 12.93893 batch_time=0.43801 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 6.95686 (QuantReg: 12.68608) QuantErr: 12.68608 batch_time=0.40193 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 5.35542 (QuantReg: 12.95401) QuantErr: 12.95401 batch_time=0.40533 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 5.23936 (QuantReg: 12.83007) QuantErr: 12.83007 batch_time=0.41723 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 5.74641 (QuantReg: 12.67441) QuantErr: 12.67441 batch_time=0.41265 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 4.84502 (QuantReg: 13.03630) QuantErr: 13.03630 batch_time=0.40469 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 4.87603 (QuantReg: 12.81529) QuantErr: 12.81529 batch_time=0.43441 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 5.74412 (QuantReg: 12.91751) QuantErr: 12.91751 batch_time=0.40651 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 5.93368 (QuantReg: 13.18946) QuantErr: 13.18946 batch_time=0.43942 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 5.59920 (QuantReg: 13.29766) QuantErr: 13.29766 batch_time=1.45361 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 7.26934 (QuantReg: 13.02633) QuantErr: 13.02633 batch_time=0.39963 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 5.71232 (QuantReg: 12.94125) QuantErr: 12.94125 batch_time=0.43238 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 6.01616 (QuantReg: 12.99071) QuantErr: 12.99071 batch_time=0.40022 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 5.11805 (QuantReg: 12.98252) QuantErr: 12.98252 batch_time=0.40606 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 5.45397 (QuantReg: 12.80311) QuantErr: 12.80311 batch_time=0.91156 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 4.62075 (QuantReg: 13.12968) QuantErr: 13.12968 batch_time=0.40622 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 5.60193 (QuantReg: 12.91608) QuantErr: 12.91608 batch_time=0.38929 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 5.53014 (QuantReg: 12.96384) QuantErr: 12.96384 batch_time=0.38902 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 6.03359 (QuantReg: 13.06950) QuantErr: 13.06950 batch_time=0.41666 
Train Epoch: 23 codebook_update_time=0.46614
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch23.pth ...
Done in 4.555s
removing stale ckpt [epoch 22] [took 0.05s]
 epoch          : 23
 loss           : 5.557046604156494
 quant_reg      : 13.008295265197754
 quant_err      : 13.008295265197754
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.273
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.65136797566777
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.915
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.63514424346613
 mnt_best       : 42.81602560270977
 not_improved_count: 4
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 6.49266 (QuantReg: 12.85980) QuantErr: 12.85980 batch_time=31.04654 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 4.13085 (QuantReg: 13.01518) QuantErr: 13.01518 batch_time=0.41271 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 5.20710 (QuantReg: 12.79464) QuantErr: 12.79464 batch_time=0.42928 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 6.42834 (QuantReg: 13.14507) QuantErr: 13.14507 batch_time=0.43516 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 5.53444 (QuantReg: 12.73284) QuantErr: 12.73284 batch_time=0.41358 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 5.44047 (QuantReg: 12.91665) QuantErr: 12.91665 batch_time=0.41567 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 6.29292 (QuantReg: 13.16233) QuantErr: 13.16233 batch_time=2.38757 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 5.52674 (QuantReg: 13.20236) QuantErr: 13.20236 batch_time=4.65226 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 5.44215 (QuantReg: 13.06659) QuantErr: 13.06659 batch_time=0.41106 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 4.40681 (QuantReg: 13.07255) QuantErr: 13.07255 batch_time=0.38769 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 5.59649 (QuantReg: 13.02975) QuantErr: 13.02975 batch_time=0.39065 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 5.50920 (QuantReg: 12.93861) QuantErr: 12.93861 batch_time=0.41506 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 7.08116 (QuantReg: 13.07681) QuantErr: 13.07681 batch_time=0.47577 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 4.47631 (QuantReg: 13.07105) QuantErr: 13.07105 batch_time=0.40577 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 4.47849 (QuantReg: 13.58472) QuantErr: 13.58472 batch_time=0.40797 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 4.81807 (QuantReg: 13.23683) QuantErr: 13.23683 batch_time=0.77663 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 4.40276 (QuantReg: 13.01969) QuantErr: 13.01969 batch_time=0.38870 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 6.80276 (QuantReg: 13.25285) QuantErr: 13.25285 batch_time=0.42025 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 5.99033 (QuantReg: 13.30496) QuantErr: 13.30496 batch_time=0.39157 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 4.73468 (QuantReg: 13.30429) QuantErr: 13.30429 batch_time=0.40961 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 6.48965 (QuantReg: 12.94846) QuantErr: 12.94846 batch_time=0.40429 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 4.86183 (QuantReg: 13.16857) QuantErr: 13.16857 batch_time=0.41446 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 5.97278 (QuantReg: 13.22261) QuantErr: 13.22261 batch_time=0.40607 
Train Epoch: 24 codebook_update_time=0.41992
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch24.pth ...
Done in 6.713s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch24.pth ...
Done in 13.352s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 5.508880393981934
 quant_reg      : 13.08737728881836
 quant_err      : 13.08737728881836
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.618
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.09659230562548
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.201
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.39212270405429
 mnt_best       : 43.09659230562548
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 5.49909 (QuantReg: 13.09004) QuantErr: 13.09004 batch_time=34.13285 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 4.73679 (QuantReg: 12.76338) QuantErr: 12.76338 batch_time=0.39346 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 5.67090 (QuantReg: 12.93863) QuantErr: 12.93863 batch_time=0.43574 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 5.42334 (QuantReg: 13.04851) QuantErr: 13.04851 batch_time=0.42901 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 6.18101 (QuantReg: 12.94513) QuantErr: 12.94513 batch_time=0.39335 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 6.24451 (QuantReg: 12.92600) QuantErr: 12.92600 batch_time=0.39659 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 5.36956 (QuantReg: 12.70995) QuantErr: 12.70995 batch_time=3.19429 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 4.68659 (QuantReg: 13.19312) QuantErr: 13.19312 batch_time=0.44626 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 4.57946 (QuantReg: 12.91030) QuantErr: 12.91030 batch_time=0.39078 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 6.36504 (QuantReg: 12.82097) QuantErr: 12.82097 batch_time=0.39136 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 5.42742 (QuantReg: 13.36079) QuantErr: 13.36079 batch_time=0.41937 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 5.11086 (QuantReg: 13.42151) QuantErr: 13.42151 batch_time=0.40568 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 5.28288 (QuantReg: 12.88482) QuantErr: 12.88482 batch_time=0.39814 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 4.39813 (QuantReg: 13.00070) QuantErr: 13.00070 batch_time=0.39537 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 6.34290 (QuantReg: 13.20588) QuantErr: 13.20588 batch_time=0.40539 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 5.33351 (QuantReg: 13.05326) QuantErr: 13.05326 batch_time=0.44298 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 5.09442 (QuantReg: 13.06146) QuantErr: 13.06146 batch_time=0.71259 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 6.24655 (QuantReg: 12.97054) QuantErr: 12.97054 batch_time=0.38841 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 5.37895 (QuantReg: 12.99000) QuantErr: 12.99000 batch_time=0.42902 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 5.33418 (QuantReg: 13.04967) QuantErr: 13.04967 batch_time=0.46178 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 5.97454 (QuantReg: 12.89323) QuantErr: 12.89323 batch_time=0.49590 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 4.74167 (QuantReg: 13.01426) QuantErr: 13.01426 batch_time=0.41448 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 3.93402 (QuantReg: 13.07854) QuantErr: 13.07854 batch_time=0.40791 
Train Epoch: 25 codebook_update_time=0.42567
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch25.pth ...
Done in 8.428s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch25.pth ...
Done in 12.674s
removing stale ckpt [epoch 24] [took 0.07s]
 epoch          : 25
 loss           : 5.419487441062928
 quant_reg      : 13.077530941009522
 quant_err      : 13.077530941009522
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.371
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.2493263730604
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0255
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.580022691451894
 mnt_best       : 43.2493263730604
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 4.93533 (QuantReg: 13.24057) QuantErr: 13.24057 batch_time=34.21015 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 7.09269 (QuantReg: 13.07929) QuantErr: 13.07929 batch_time=0.43018 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 5.44185 (QuantReg: 12.99337) QuantErr: 12.99337 batch_time=0.40077 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 5.53699 (QuantReg: 13.50367) QuantErr: 13.50367 batch_time=0.40056 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 4.41665 (QuantReg: 13.12923) QuantErr: 13.12923 batch_time=0.39933 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 4.67492 (QuantReg: 12.71949) QuantErr: 12.71949 batch_time=0.39877 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 5.37667 (QuantReg: 13.31536) QuantErr: 13.31536 batch_time=0.42411 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 5.21641 (QuantReg: 13.29668) QuantErr: 13.29668 batch_time=0.42291 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 5.42585 (QuantReg: 12.85138) QuantErr: 12.85138 batch_time=0.42392 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 4.55644 (QuantReg: 13.04839) QuantErr: 13.04839 batch_time=0.44191 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 4.53019 (QuantReg: 13.02050) QuantErr: 13.02050 batch_time=0.43503 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 5.70003 (QuantReg: 13.37334) QuantErr: 13.37334 batch_time=0.39034 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 4.85281 (QuantReg: 13.20030) QuantErr: 13.20030 batch_time=0.39131 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 3.64197 (QuantReg: 13.30782) QuantErr: 13.30782 batch_time=0.42907 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 4.93252 (QuantReg: 13.31018) QuantErr: 13.31018 batch_time=1.03099 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 4.20195 (QuantReg: 13.32950) QuantErr: 13.32950 batch_time=0.45936 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 5.10148 (QuantReg: 13.34931) QuantErr: 13.34931 batch_time=0.41371 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 4.52066 (QuantReg: 13.16922) QuantErr: 13.16922 batch_time=0.39426 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 5.63140 (QuantReg: 13.07584) QuantErr: 13.07584 batch_time=0.39548 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 4.74284 (QuantReg: 13.23985) QuantErr: 13.23985 batch_time=0.40843 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 4.61134 (QuantReg: 12.97422) QuantErr: 12.97422 batch_time=0.40727 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 5.71630 (QuantReg: 13.17976) QuantErr: 13.17976 batch_time=0.41002 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 4.48528 (QuantReg: 13.29310) QuantErr: 13.29310 batch_time=0.39663 
Train Epoch: 26 codebook_update_time=0.44565
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch26.pth ...
Done in 5.830s
removing stale ckpt [epoch 25] [took 0.02s]
 epoch          : 26
 loss           : 5.271403380393982
 quant_reg      : 13.096636478424072
 quant_err      : 13.096636478424072
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.43
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.05245806151493
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.44
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.63814963981845
 mnt_best       : 43.2493263730604
 not_improved_count: 1
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 4.32357 (QuantReg: 12.89957) QuantErr: 12.89957 batch_time=31.47615 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 6.63478 (QuantReg: 12.72553) QuantErr: 12.72553 batch_time=0.58742 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 6.08278 (QuantReg: 12.77797) QuantErr: 12.77797 batch_time=0.39326 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 5.11426 (QuantReg: 12.95327) QuantErr: 12.95327 batch_time=0.39949 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 4.72420 (QuantReg: 12.89556) QuantErr: 12.89556 batch_time=0.41484 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 5.00711 (QuantReg: 12.99715) QuantErr: 12.99715 batch_time=0.44739 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 4.50617 (QuantReg: 13.14656) QuantErr: 13.14656 batch_time=0.41761 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 4.80080 (QuantReg: 12.96685) QuantErr: 12.96685 batch_time=0.47660 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 5.77070 (QuantReg: 13.02689) QuantErr: 13.02689 batch_time=0.41832 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 4.34831 (QuantReg: 13.45563) QuantErr: 13.45563 batch_time=0.40258 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 4.97520 (QuantReg: 13.16828) QuantErr: 13.16828 batch_time=0.39613 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 6.00916 (QuantReg: 13.18853) QuantErr: 13.18853 batch_time=0.41567 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 4.46124 (QuantReg: 13.27399) QuantErr: 13.27399 batch_time=2.79559 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 4.57125 (QuantReg: 13.25538) QuantErr: 13.25538 batch_time=0.42846 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 5.91667 (QuantReg: 12.96102) QuantErr: 12.96102 batch_time=0.40260 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 4.98817 (QuantReg: 12.93729) QuantErr: 12.93729 batch_time=0.40286 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 5.09096 (QuantReg: 13.37655) QuantErr: 13.37655 batch_time=0.39051 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 5.43859 (QuantReg: 13.16572) QuantErr: 13.16572 batch_time=0.44528 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 5.91152 (QuantReg: 12.97110) QuantErr: 12.97110 batch_time=0.44055 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 5.25397 (QuantReg: 12.89463) QuantErr: 12.89463 batch_time=0.40712 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 5.16812 (QuantReg: 13.40485) QuantErr: 13.40485 batch_time=0.40066 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 5.37143 (QuantReg: 13.15094) QuantErr: 13.15094 batch_time=0.40488 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 6.31591 (QuantReg: 12.79831) QuantErr: 12.79831 batch_time=0.40301 
Train Epoch: 27 codebook_update_time=0.41462
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch27.pth ...
Done in 4.172s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch27.pth ...
Done in 9.515s
removing stale ckpt [epoch 26] [took 0.02s]
 epoch          : 27
 loss           : 5.249609484672546
 quant_reg      : 13.102290576934815
 quant_err      : 13.102290576934815
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.916
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.14947014562907
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6645
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.08366176103869
 mnt_best       : 44.14947014562907
 not_improved_count: 0
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 4.51770 (QuantReg: 13.13472) QuantErr: 13.13472 batch_time=34.69580 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 5.64432 (QuantReg: 12.96560) QuantErr: 12.96560 batch_time=0.41797 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 4.16535 (QuantReg: 12.95015) QuantErr: 12.95015 batch_time=0.41934 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 4.75789 (QuantReg: 12.80572) QuantErr: 12.80572 batch_time=0.39763 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 4.87140 (QuantReg: 13.17702) QuantErr: 13.17702 batch_time=0.39224 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 4.76316 (QuantReg: 13.21155) QuantErr: 13.21155 batch_time=0.39361 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 3.46687 (QuantReg: 13.27260) QuantErr: 13.27260 batch_time=0.40677 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 5.99821 (QuantReg: 12.86052) QuantErr: 12.86052 batch_time=0.41689 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 5.74338 (QuantReg: 12.61500) QuantErr: 12.61500 batch_time=0.39952 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 5.92469 (QuantReg: 13.00126) QuantErr: 13.00126 batch_time=0.38945 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 6.37478 (QuantReg: 13.16872) QuantErr: 13.16872 batch_time=0.39241 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 5.40349 (QuantReg: 13.12810) QuantErr: 13.12810 batch_time=0.41512 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 5.26833 (QuantReg: 13.27361) QuantErr: 13.27361 batch_time=0.41208 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 5.93721 (QuantReg: 13.07523) QuantErr: 13.07523 batch_time=2.01704 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 5.01414 (QuantReg: 13.26461) QuantErr: 13.26461 batch_time=0.42629 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 4.60605 (QuantReg: 12.95360) QuantErr: 12.95360 batch_time=0.42064 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 4.92629 (QuantReg: 13.15273) QuantErr: 13.15273 batch_time=0.40933 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 5.85126 (QuantReg: 13.02037) QuantErr: 13.02037 batch_time=0.40683 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 3.93914 (QuantReg: 13.20687) QuantErr: 13.20687 batch_time=0.55032 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 5.42903 (QuantReg: 13.07138) QuantErr: 13.07138 batch_time=1.23897 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 4.98914 (QuantReg: 12.90265) QuantErr: 12.90265 batch_time=0.42471 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 6.48349 (QuantReg: 13.12723) QuantErr: 13.12723 batch_time=0.53163 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 5.46444 (QuantReg: 12.96111) QuantErr: 12.96111 batch_time=0.39925 
Train Epoch: 28 codebook_update_time=0.45918
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch28.pth ...
Done in 5.120s
removing stale ckpt [epoch 27] [took 0.28s]
 epoch          : 28
 loss           : 5.2067077417373655
 quant_reg      : 13.0871142578125
 quant_err      : 13.0871142578125
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.351
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.70360290555946
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.337
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.76774157900171
 mnt_best       : 44.14947014562907
 not_improved_count: 1
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 4.92224 (QuantReg: 12.92264) QuantErr: 12.92264 batch_time=34.96401 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 4.02348 (QuantReg: 13.32318) QuantErr: 13.32318 batch_time=0.42542 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 4.28114 (QuantReg: 12.93655) QuantErr: 12.93655 batch_time=0.40566 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 5.06587 (QuantReg: 13.10113) QuantErr: 13.10113 batch_time=0.42117 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 4.92237 (QuantReg: 13.16234) QuantErr: 13.16234 batch_time=0.41764 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 5.10052 (QuantReg: 13.03302) QuantErr: 13.03302 batch_time=0.43490 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 4.88742 (QuantReg: 13.45893) QuantErr: 13.45893 batch_time=0.39917 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 6.36010 (QuantReg: 12.90485) QuantErr: 12.90485 batch_time=0.42279 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 5.65505 (QuantReg: 13.30603) QuantErr: 13.30603 batch_time=0.40372 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 5.05549 (QuantReg: 13.13483) QuantErr: 13.13483 batch_time=0.48400 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 5.03269 (QuantReg: 13.19283) QuantErr: 13.19283 batch_time=0.42038 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 5.29424 (QuantReg: 13.25937) QuantErr: 13.25937 batch_time=0.44485 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 5.68812 (QuantReg: 13.21566) QuantErr: 13.21566 batch_time=0.42438 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 4.57286 (QuantReg: 12.96794) QuantErr: 12.96794 batch_time=0.41850 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 4.58068 (QuantReg: 12.82992) QuantErr: 12.82992 batch_time=0.42231 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 4.29494 (QuantReg: 13.22702) QuantErr: 13.22702 batch_time=0.42721 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 5.33630 (QuantReg: 12.89082) QuantErr: 12.89082 batch_time=0.42786 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 5.21887 (QuantReg: 13.30337) QuantErr: 13.30337 batch_time=0.40932 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 4.63383 (QuantReg: 12.80608) QuantErr: 12.80608 batch_time=0.40627 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 5.41112 (QuantReg: 12.96504) QuantErr: 12.96504 batch_time=0.41824 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 4.42213 (QuantReg: 13.11410) QuantErr: 13.11410 batch_time=0.42734 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 4.67501 (QuantReg: 13.22080) QuantErr: 13.22080 batch_time=0.45518 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 4.09738 (QuantReg: 13.12464) QuantErr: 13.12464 batch_time=0.43098 
Train Epoch: 29 codebook_update_time=0.40835
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch29.pth ...
Done in 4.796s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 5.17964409160614
 quant_reg      : 13.119868869781493
 quant_err      : 13.119868869781493
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.507
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.70732264920297
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.985
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.504851553678236
 mnt_best       : 44.14947014562907
 not_improved_count: 2
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 5.74823 (QuantReg: 13.15803) QuantErr: 13.15803 batch_time=34.81205 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 4.88365 (QuantReg: 13.02773) QuantErr: 13.02773 batch_time=0.40137 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 4.96066 (QuantReg: 13.18722) QuantErr: 13.18722 batch_time=0.46105 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 5.20546 (QuantReg: 12.91266) QuantErr: 12.91266 batch_time=0.40637 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 5.82829 (QuantReg: 12.97439) QuantErr: 12.97439 batch_time=0.40470 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 3.76115 (QuantReg: 13.09184) QuantErr: 13.09184 batch_time=0.40094 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 5.59133 (QuantReg: 12.98178) QuantErr: 12.98178 batch_time=4.17230 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 4.69947 (QuantReg: 13.26455) QuantErr: 13.26455 batch_time=0.43010 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 5.72262 (QuantReg: 13.05224) QuantErr: 13.05224 batch_time=0.40450 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 4.49747 (QuantReg: 13.08084) QuantErr: 13.08084 batch_time=0.38953 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 5.49618 (QuantReg: 12.85232) QuantErr: 12.85232 batch_time=0.42660 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 4.21688 (QuantReg: 13.40645) QuantErr: 13.40645 batch_time=0.42117 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 4.02916 (QuantReg: 13.58327) QuantErr: 13.58327 batch_time=0.40579 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 4.16502 (QuantReg: 13.23859) QuantErr: 13.23859 batch_time=0.44805 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 5.99736 (QuantReg: 12.89198) QuantErr: 12.89198 batch_time=0.42284 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 5.90129 (QuantReg: 12.72528) QuantErr: 12.72528 batch_time=0.39316 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 5.94157 (QuantReg: 12.98110) QuantErr: 12.98110 batch_time=0.40412 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 4.13294 (QuantReg: 13.08175) QuantErr: 13.08175 batch_time=0.44729 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 5.31341 (QuantReg: 13.19156) QuantErr: 13.19156 batch_time=0.39005 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 3.93433 (QuantReg: 13.05951) QuantErr: 13.05951 batch_time=0.40513 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 3.78389 (QuantReg: 13.29577) QuantErr: 13.29577 batch_time=0.43080 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 5.05011 (QuantReg: 12.92350) QuantErr: 12.92350 batch_time=0.41344 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 5.72891 (QuantReg: 12.93847) QuantErr: 12.93847 batch_time=0.42588 
Train Epoch: 30 codebook_update_time=0.43064
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch30.pth ...
Done in 4.817s
removing stale ckpt [epoch 29] [took 0.02s]
 epoch          : 30
 loss           : 5.037697642326355
 quant_reg      : 13.135856315612793
 quant_err      : 13.135856315612793
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.9485
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.171094417852
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.921
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.71703628207513
 mnt_best       : 44.14947014562907
 not_improved_count: 3
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 5.00309 (QuantReg: 13.01714) QuantErr: 13.01714 batch_time=34.66556 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 4.46176 (QuantReg: 13.19296) QuantErr: 13.19296 batch_time=0.41677 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 4.96557 (QuantReg: 12.76587) QuantErr: 12.76587 batch_time=0.41581 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 4.81646 (QuantReg: 13.13132) QuantErr: 13.13132 batch_time=0.41686 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 4.84403 (QuantReg: 13.02020) QuantErr: 13.02020 batch_time=0.41024 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 5.11311 (QuantReg: 13.30694) QuantErr: 13.30694 batch_time=0.41574 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 4.63563 (QuantReg: 13.04115) QuantErr: 13.04115 batch_time=0.77726 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 5.97345 (QuantReg: 13.06796) QuantErr: 13.06796 batch_time=0.40459 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 5.29508 (QuantReg: 13.22090) QuantErr: 13.22090 batch_time=0.43394 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 4.11556 (QuantReg: 13.48512) QuantErr: 13.48512 batch_time=0.41903 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 3.73542 (QuantReg: 13.03132) QuantErr: 13.03132 batch_time=0.42094 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 5.09787 (QuantReg: 13.14666) QuantErr: 13.14666 batch_time=0.41909 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 5.04109 (QuantReg: 13.22809) QuantErr: 13.22809 batch_time=0.42779 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 4.64518 (QuantReg: 13.34082) QuantErr: 13.34082 batch_time=0.40098 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 5.86604 (QuantReg: 13.14188) QuantErr: 13.14188 batch_time=0.42560 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 4.76433 (QuantReg: 13.23712) QuantErr: 13.23712 batch_time=0.45162 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 4.21015 (QuantReg: 13.27216) QuantErr: 13.27216 batch_time=0.46651 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 4.95719 (QuantReg: 13.28784) QuantErr: 13.28784 batch_time=0.43472 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 5.74316 (QuantReg: 13.02099) QuantErr: 13.02099 batch_time=0.46488 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 5.04328 (QuantReg: 13.30216) QuantErr: 13.30216 batch_time=0.42811 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 4.41241 (QuantReg: 13.40912) QuantErr: 13.40912 batch_time=0.42490 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 5.05306 (QuantReg: 13.20206) QuantErr: 13.20206 batch_time=0.40104 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 3.73120 (QuantReg: 13.32750) QuantErr: 13.32750 batch_time=0.39968 
Train Epoch: 31 codebook_update_time=0.40123
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch31.pth ...
Done in 4.410s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 31
 loss           : 4.9953666610717775
 quant_reg      : 13.15200030517578
 quant_err      : 13.15200030517578
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.5555
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.74492357970072
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.652
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.04397429797793
 mnt_best       : 44.14947014562907
 not_improved_count: 4
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 5.54038 (QuantReg: 12.90267) QuantErr: 12.90267 batch_time=33.31313 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 4.59202 (QuantReg: 13.11499) QuantErr: 13.11499 batch_time=2.05445 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 4.77596 (QuantReg: 13.18218) QuantErr: 13.18218 batch_time=0.78522 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 5.41829 (QuantReg: 13.20896) QuantErr: 13.20896 batch_time=0.40994 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 4.48472 (QuantReg: 13.19110) QuantErr: 13.19110 batch_time=0.40928 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 5.09797 (QuantReg: 13.35529) QuantErr: 13.35529 batch_time=0.40463 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 5.17465 (QuantReg: 13.27617) QuantErr: 13.27617 batch_time=1.78941 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 5.15887 (QuantReg: 13.35135) QuantErr: 13.35135 batch_time=0.40391 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 4.98755 (QuantReg: 13.15219) QuantErr: 13.15219 batch_time=0.41054 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 3.91785 (QuantReg: 13.15577) QuantErr: 13.15577 batch_time=0.48978 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 4.68978 (QuantReg: 13.25658) QuantErr: 13.25658 batch_time=0.42122 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 4.99292 (QuantReg: 13.10128) QuantErr: 13.10128 batch_time=0.42261 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 4.13672 (QuantReg: 13.19637) QuantErr: 13.19637 batch_time=0.44514 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 3.85083 (QuantReg: 13.48441) QuantErr: 13.48441 batch_time=0.40740 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 5.11708 (QuantReg: 13.12104) QuantErr: 13.12104 batch_time=0.39786 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 4.77256 (QuantReg: 13.21412) QuantErr: 13.21412 batch_time=0.41981 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 3.42288 (QuantReg: 13.52806) QuantErr: 13.52806 batch_time=0.39581 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 5.34228 (QuantReg: 12.99766) QuantErr: 12.99766 batch_time=0.40233 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 5.24795 (QuantReg: 13.28183) QuantErr: 13.28183 batch_time=0.42499 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 4.16370 (QuantReg: 13.28460) QuantErr: 13.28460 batch_time=0.44485 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 5.97495 (QuantReg: 13.24915) QuantErr: 13.24915 batch_time=0.39384 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 5.14799 (QuantReg: 12.78829) QuantErr: 12.78829 batch_time=0.42995 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 5.25407 (QuantReg: 13.19228) QuantErr: 13.19228 batch_time=0.44498 
Train Epoch: 32 codebook_update_time=0.47408
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch32.pth ...
Done in 11.776s
removing stale ckpt [epoch 31] [took 0.20s]
 epoch          : 32
 loss           : 4.940237928390503
 quant_reg      : 13.189231922149657
 quant_err      : 13.189231922149657
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.731
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.09992441408057
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.4335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.21211855602201
 mnt_best       : 44.14947014562907
 not_improved_count: 5
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 4.13836 (QuantReg: 13.45127) QuantErr: 13.45127 batch_time=33.26849 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 6.11222 (QuantReg: 12.95197) QuantErr: 12.95197 batch_time=0.41988 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 4.81370 (QuantReg: 12.94181) QuantErr: 12.94181 batch_time=0.40559 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 4.27495 (QuantReg: 13.23599) QuantErr: 13.23599 batch_time=0.39983 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 4.36856 (QuantReg: 13.25368) QuantErr: 13.25368 batch_time=0.41131 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 4.04739 (QuantReg: 13.22669) QuantErr: 13.22669 batch_time=0.39077 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 4.75717 (QuantReg: 13.02253) QuantErr: 13.02253 batch_time=0.87356 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 5.55456 (QuantReg: 13.16498) QuantErr: 13.16498 batch_time=0.42728 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 5.03724 (QuantReg: 13.42301) QuantErr: 13.42301 batch_time=0.40756 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 4.85428 (QuantReg: 13.05295) QuantErr: 13.05295 batch_time=0.40896 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 6.33531 (QuantReg: 13.26798) QuantErr: 13.26798 batch_time=0.42695 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 5.95355 (QuantReg: 13.38081) QuantErr: 13.38081 batch_time=0.41611 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 5.25454 (QuantReg: 12.94911) QuantErr: 12.94911 batch_time=0.40900 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 4.03718 (QuantReg: 13.35755) QuantErr: 13.35755 batch_time=0.93753 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 4.74806 (QuantReg: 12.97110) QuantErr: 12.97110 batch_time=0.42724 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 4.57428 (QuantReg: 13.04897) QuantErr: 13.04897 batch_time=0.39362 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 3.45728 (QuantReg: 13.29530) QuantErr: 13.29530 batch_time=0.40303 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 6.35208 (QuantReg: 13.11330) QuantErr: 13.11330 batch_time=0.39047 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 6.08663 (QuantReg: 13.17945) QuantErr: 13.17945 batch_time=0.42158 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 6.10645 (QuantReg: 13.24909) QuantErr: 13.24909 batch_time=0.39677 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 5.85705 (QuantReg: 12.82329) QuantErr: 12.82329 batch_time=0.42271 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 5.56405 (QuantReg: 13.27151) QuantErr: 13.27151 batch_time=0.42938 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 4.54349 (QuantReg: 13.62598) QuantErr: 13.62598 batch_time=0.39825 
Train Epoch: 33 codebook_update_time=0.48827
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch33.pth ...
Done in 5.511s
removing stale ckpt [epoch 32] [took 0.02s]
 epoch          : 33
 loss           : 5.020655254364014
 quant_reg      : 13.21790051651001
 quant_err      : 13.21790051651001
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.697
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.97785214553028
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.921
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.7256547219209
 mnt_best       : 44.14947014562907
 not_improved_count: 6
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 4.06264 (QuantReg: 13.27530) QuantErr: 13.27530 batch_time=34.86318 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 4.98552 (QuantReg: 12.95616) QuantErr: 12.95616 batch_time=0.39709 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 5.94311 (QuantReg: 13.02126) QuantErr: 13.02126 batch_time=0.39945 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 4.03302 (QuantReg: 13.12563) QuantErr: 13.12563 batch_time=0.41421 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 5.21287 (QuantReg: 13.31434) QuantErr: 13.31434 batch_time=0.50736 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 5.18297 (QuantReg: 13.40618) QuantErr: 13.40618 batch_time=0.51198 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 5.43350 (QuantReg: 13.57065) QuantErr: 13.57065 batch_time=0.41026 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 6.18543 (QuantReg: 13.18674) QuantErr: 13.18674 batch_time=0.41444 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 4.27167 (QuantReg: 13.33648) QuantErr: 13.33648 batch_time=0.41866 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 4.56746 (QuantReg: 13.12240) QuantErr: 13.12240 batch_time=0.40123 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 6.07404 (QuantReg: 12.94634) QuantErr: 12.94634 batch_time=0.41996 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 4.49956 (QuantReg: 12.99482) QuantErr: 12.99482 batch_time=0.41370 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 5.56957 (QuantReg: 13.50305) QuantErr: 13.50305 batch_time=0.39393 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 3.76091 (QuantReg: 13.29305) QuantErr: 13.29305 batch_time=0.40330 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 4.41512 (QuantReg: 13.01495) QuantErr: 13.01495 batch_time=0.72071 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 4.88401 (QuantReg: 13.12478) QuantErr: 13.12478 batch_time=0.40505 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 5.45083 (QuantReg: 13.25307) QuantErr: 13.25307 batch_time=0.41891 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 4.85738 (QuantReg: 13.11766) QuantErr: 13.11766 batch_time=0.43418 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 5.14184 (QuantReg: 13.22347) QuantErr: 13.22347 batch_time=0.41633 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 4.70853 (QuantReg: 13.50878) QuantErr: 13.50878 batch_time=0.40627 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 4.17445 (QuantReg: 13.27596) QuantErr: 13.27596 batch_time=0.42099 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 4.90676 (QuantReg: 13.32188) QuantErr: 13.32188 batch_time=0.42810 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 4.73151 (QuantReg: 13.17580) QuantErr: 13.17580 batch_time=0.39522 
Train Epoch: 34 codebook_update_time=0.48225
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch34.pth ...
Done in 20.922s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch34.pth ...
Done in 25.603s
removing stale ckpt [epoch 33] [took 0.02s]
 epoch          : 34
 loss           : 4.86253066444397
 quant_reg      : 13.198345558166505
 quant_err      : 13.198345558166505
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.661
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.80756641705813
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.384
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.74059104330393
 mnt_best       : 44.80756641705813
 not_improved_count: 0
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 5.94531 (QuantReg: 13.16523) QuantErr: 13.16523 batch_time=36.04351 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 5.22031 (QuantReg: 13.37352) QuantErr: 13.37352 batch_time=0.40241 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 5.76168 (QuantReg: 13.39394) QuantErr: 13.39394 batch_time=0.41875 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 5.26923 (QuantReg: 13.26432) QuantErr: 13.26432 batch_time=0.40283 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 5.02422 (QuantReg: 13.03250) QuantErr: 13.03250 batch_time=0.42262 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 4.81024 (QuantReg: 13.26074) QuantErr: 13.26074 batch_time=0.45711 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 4.52688 (QuantReg: 13.20142) QuantErr: 13.20142 batch_time=0.42783 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 4.51381 (QuantReg: 13.12274) QuantErr: 13.12274 batch_time=0.42461 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 5.67364 (QuantReg: 13.23471) QuantErr: 13.23471 batch_time=0.41641 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 5.52924 (QuantReg: 13.20662) QuantErr: 13.20662 batch_time=0.70078 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 4.31825 (QuantReg: 13.66279) QuantErr: 13.66279 batch_time=0.43415 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 6.01481 (QuantReg: 13.18359) QuantErr: 13.18359 batch_time=0.44799 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 3.86247 (QuantReg: 13.22619) QuantErr: 13.22619 batch_time=1.40224 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 5.49676 (QuantReg: 13.18767) QuantErr: 13.18767 batch_time=4.45971 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 5.60773 (QuantReg: 13.17739) QuantErr: 13.17739 batch_time=0.45965 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 5.22572 (QuantReg: 13.20721) QuantErr: 13.20721 batch_time=0.46980 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 5.46007 (QuantReg: 13.15635) QuantErr: 13.15635 batch_time=0.42425 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 5.36015 (QuantReg: 13.07239) QuantErr: 13.07239 batch_time=0.41854 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 5.98342 (QuantReg: 13.30165) QuantErr: 13.30165 batch_time=0.41283 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 5.46449 (QuantReg: 13.16792) QuantErr: 13.16792 batch_time=0.44205 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 4.56402 (QuantReg: 13.22050) QuantErr: 13.22050 batch_time=0.42945 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 4.67848 (QuantReg: 13.07944) QuantErr: 13.07944 batch_time=0.43004 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 3.52154 (QuantReg: 13.19864) QuantErr: 13.19864 batch_time=0.40737 
Train Epoch: 35 codebook_update_time=0.43120
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch35.pth ...
Done in 5.496s
removing stale ckpt [epoch 34] [took 0.07s]
 epoch          : 35
 loss           : 4.996356344223022
 quant_reg      : 13.213927295684815
 quant_err      : 13.213927295684815
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.388
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.553792625934676
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.302
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.651955044650094
 mnt_best       : 44.80756641705813
 not_improved_count: 1
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 4.66673 (QuantReg: 13.44553) QuantErr: 13.44553 batch_time=33.99833 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 4.60874 (QuantReg: 13.32457) QuantErr: 13.32457 batch_time=4.06145 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 4.66138 (QuantReg: 13.31972) QuantErr: 13.31972 batch_time=0.41420 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 5.66010 (QuantReg: 12.99873) QuantErr: 12.99873 batch_time=0.39381 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 4.92583 (QuantReg: 13.38727) QuantErr: 13.38727 batch_time=0.68037 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 3.92899 (QuantReg: 13.08819) QuantErr: 13.08819 batch_time=0.42278 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 4.05466 (QuantReg: 13.47800) QuantErr: 13.47800 batch_time=0.45239 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 4.86644 (QuantReg: 13.06248) QuantErr: 13.06248 batch_time=0.38977 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 5.56270 (QuantReg: 13.03774) QuantErr: 13.03774 batch_time=0.46021 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 4.62281 (QuantReg: 13.38528) QuantErr: 13.38528 batch_time=0.39520 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 5.41415 (QuantReg: 12.98090) QuantErr: 12.98090 batch_time=0.42694 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 4.87860 (QuantReg: 13.55897) QuantErr: 13.55897 batch_time=0.40349 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 5.04567 (QuantReg: 13.12203) QuantErr: 13.12203 batch_time=0.40551 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 4.35643 (QuantReg: 13.21754) QuantErr: 13.21754 batch_time=0.42626 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 5.61739 (QuantReg: 12.83620) QuantErr: 12.83620 batch_time=0.40023 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 7.13068 (QuantReg: 13.17373) QuantErr: 13.17373 batch_time=0.41434 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 4.36759 (QuantReg: 13.45652) QuantErr: 13.45652 batch_time=0.40857 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 5.85555 (QuantReg: 12.84867) QuantErr: 12.84867 batch_time=0.48173 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 4.83207 (QuantReg: 13.46603) QuantErr: 13.46603 batch_time=1.39593 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 4.13431 (QuantReg: 13.30200) QuantErr: 13.30200 batch_time=0.43325 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 5.18053 (QuantReg: 13.38316) QuantErr: 13.38316 batch_time=0.39307 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 3.82401 (QuantReg: 13.43505) QuantErr: 13.43505 batch_time=0.44240 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 4.71122 (QuantReg: 13.38296) QuantErr: 13.38296 batch_time=0.39937 
Train Epoch: 36 codebook_update_time=0.47221
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch36.pth ...
Done in 5.443s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 4.8757181739807125
 quant_reg      : 13.2160701713562
 quant_err      : 13.2160701713562
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.504
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.31648702589935
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.052
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.472312027428465
 mnt_best       : 44.80756641705813
 not_improved_count: 2
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 3.67779 (QuantReg: 13.22379) QuantErr: 13.22379 batch_time=41.02101 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 5.04646 (QuantReg: 13.26922) QuantErr: 13.26922 batch_time=0.41583 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 4.70851 (QuantReg: 13.21462) QuantErr: 13.21462 batch_time=0.40085 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 4.73920 (QuantReg: 13.03435) QuantErr: 13.03435 batch_time=0.38945 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 4.70070 (QuantReg: 13.47231) QuantErr: 13.47231 batch_time=0.46068 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 5.36672 (QuantReg: 13.42486) QuantErr: 13.42486 batch_time=0.41244 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 5.57652 (QuantReg: 13.44942) QuantErr: 13.44942 batch_time=0.40803 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 3.57868 (QuantReg: 13.36088) QuantErr: 13.36088 batch_time=0.39877 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 4.99913 (QuantReg: 13.32081) QuantErr: 13.32081 batch_time=0.39560 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 4.52855 (QuantReg: 13.44463) QuantErr: 13.44463 batch_time=1.33856 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 4.46353 (QuantReg: 13.43610) QuantErr: 13.43610 batch_time=0.39697 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 4.73808 (QuantReg: 13.38723) QuantErr: 13.38723 batch_time=0.41914 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 3.58574 (QuantReg: 13.27510) QuantErr: 13.27510 batch_time=4.14281 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 4.73360 (QuantReg: 13.02582) QuantErr: 13.02582 batch_time=0.41199 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 5.14094 (QuantReg: 13.01752) QuantErr: 13.01752 batch_time=0.39742 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 4.48240 (QuantReg: 13.49625) QuantErr: 13.49625 batch_time=0.39528 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 5.02630 (QuantReg: 13.18203) QuantErr: 13.18203 batch_time=0.43881 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 5.02561 (QuantReg: 13.15095) QuantErr: 13.15095 batch_time=0.41683 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 4.93655 (QuantReg: 13.06712) QuantErr: 13.06712 batch_time=0.51987 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 3.93059 (QuantReg: 13.27836) QuantErr: 13.27836 batch_time=0.48793 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 4.48812 (QuantReg: 13.33772) QuantErr: 13.33772 batch_time=0.40513 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 4.95870 (QuantReg: 13.29643) QuantErr: 13.29643 batch_time=0.39651 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 4.62669 (QuantReg: 13.40726) QuantErr: 13.40726 batch_time=0.44275 
Train Epoch: 37 codebook_update_time=0.41005
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch37.pth ...
Done in 4.122s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch37.pth ...
Done in 8.428s
removing stale ckpt [epoch 36] [took 0.02s]
 epoch          : 37
 loss           : 4.876740255355835
 quant_reg      : 13.25746688079834
 quant_err      : 13.25746688079834
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.028
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.86332191471688
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.297
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.80689997889538
 mnt_best       : 44.86332191471688
 not_improved_count: 0
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 4.81361 (QuantReg: 13.19877) QuantErr: 13.19877 batch_time=41.07757 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 4.48138 (QuantReg: 13.47632) QuantErr: 13.47632 batch_time=0.40580 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 5.88077 (QuantReg: 12.63813) QuantErr: 12.63813 batch_time=0.44874 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 3.98517 (QuantReg: 13.25610) QuantErr: 13.25610 batch_time=0.41010 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 4.52683 (QuantReg: 13.23393) QuantErr: 13.23393 batch_time=0.43079 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 4.18007 (QuantReg: 13.42054) QuantErr: 13.42054 batch_time=0.43529 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 4.94283 (QuantReg: 13.06198) QuantErr: 13.06198 batch_time=0.43173 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 6.08200 (QuantReg: 13.02178) QuantErr: 13.02178 batch_time=0.40043 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 5.46791 (QuantReg: 13.43425) QuantErr: 13.43425 batch_time=0.40845 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 4.91015 (QuantReg: 13.48373) QuantErr: 13.48373 batch_time=0.39690 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 4.22806 (QuantReg: 13.11919) QuantErr: 13.11919 batch_time=0.40476 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 4.96173 (QuantReg: 13.51853) QuantErr: 13.51853 batch_time=0.40613 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 5.10182 (QuantReg: 13.33898) QuantErr: 13.33898 batch_time=0.40280 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 5.84135 (QuantReg: 13.37200) QuantErr: 13.37200 batch_time=0.41264 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 4.82286 (QuantReg: 13.38294) QuantErr: 13.38294 batch_time=0.39231 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 5.55779 (QuantReg: 13.25849) QuantErr: 13.25849 batch_time=0.40030 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 4.14563 (QuantReg: 13.28904) QuantErr: 13.28904 batch_time=0.45606 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 4.49062 (QuantReg: 13.59490) QuantErr: 13.59490 batch_time=0.39540 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 4.27208 (QuantReg: 13.48127) QuantErr: 13.48127 batch_time=0.45185 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 4.33456 (QuantReg: 13.22157) QuantErr: 13.22157 batch_time=0.40094 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 4.36524 (QuantReg: 13.31664) QuantErr: 13.31664 batch_time=0.41895 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 4.57615 (QuantReg: 13.29521) QuantErr: 13.29521 batch_time=0.39311 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 5.77985 (QuantReg: 12.92839) QuantErr: 12.92839 batch_time=0.40875 
Train Epoch: 38 codebook_update_time=0.45419
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch38.pth ...
Done in 4.338s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 4.8350729007720945
 quant_reg      : 13.263196884155274
 quant_err      : 13.263196884155274
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.237
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.75403391376091
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.3095
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.570644346115365
 mnt_best       : 44.86332191471688
 not_improved_count: 1
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 5.45721 (QuantReg: 13.16029) QuantErr: 13.16029 batch_time=42.08623 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 6.17793 (QuantReg: 13.23637) QuantErr: 13.23637 batch_time=0.49213 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 6.12209 (QuantReg: 13.05271) QuantErr: 13.05271 batch_time=0.40923 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 4.78504 (QuantReg: 13.15335) QuantErr: 13.15335 batch_time=0.42844 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 4.38058 (QuantReg: 13.24580) QuantErr: 13.24580 batch_time=0.40314 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 5.38367 (QuantReg: 13.45000) QuantErr: 13.45000 batch_time=0.41437 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 4.71006 (QuantReg: 13.38422) QuantErr: 13.38422 batch_time=0.43853 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 4.55092 (QuantReg: 13.14080) QuantErr: 13.14080 batch_time=0.41764 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 3.97889 (QuantReg: 13.31368) QuantErr: 13.31368 batch_time=0.41503 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 5.70460 (QuantReg: 13.33532) QuantErr: 13.33532 batch_time=0.47371 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 3.87538 (QuantReg: 13.39721) QuantErr: 13.39721 batch_time=0.44408 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 4.14822 (QuantReg: 13.11063) QuantErr: 13.11063 batch_time=0.39632 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 5.92887 (QuantReg: 13.20866) QuantErr: 13.20866 batch_time=0.42242 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 4.98453 (QuantReg: 13.10671) QuantErr: 13.10671 batch_time=0.40201 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 6.26655 (QuantReg: 13.28174) QuantErr: 13.28174 batch_time=0.42663 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 5.42726 (QuantReg: 13.38895) QuantErr: 13.38895 batch_time=0.45924 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 4.93631 (QuantReg: 13.37454) QuantErr: 13.37454 batch_time=0.45486 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 6.12749 (QuantReg: 13.43522) QuantErr: 13.43522 batch_time=0.40167 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 5.69409 (QuantReg: 13.10412) QuantErr: 13.10412 batch_time=0.40736 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 5.36867 (QuantReg: 13.24749) QuantErr: 13.24749 batch_time=3.00609 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 5.35688 (QuantReg: 13.09467) QuantErr: 13.09467 batch_time=0.44938 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 4.45259 (QuantReg: 13.23158) QuantErr: 13.23158 batch_time=0.40153 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 4.94339 (QuantReg: 12.96294) QuantErr: 12.96294 batch_time=0.40893 
Train Epoch: 39 codebook_update_time=0.53501
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch39.pth ...
Done in 4.004s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 4.790407002449036
 quant_reg      : 13.238432331085205
 quant_err      : 13.238432331085205
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.103
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.0921309893675
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.054
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.991490078038204
 mnt_best       : 44.86332191471688
 not_improved_count: 2
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 5.15430 (QuantReg: 13.43335) QuantErr: 13.43335 batch_time=35.99611 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 5.29611 (QuantReg: 13.00878) QuantErr: 13.00878 batch_time=0.39400 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 5.61736 (QuantReg: 13.11197) QuantErr: 13.11197 batch_time=0.43216 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 3.93694 (QuantReg: 12.90271) QuantErr: 12.90271 batch_time=0.43991 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 5.50534 (QuantReg: 13.14497) QuantErr: 13.14497 batch_time=0.82848 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 4.88090 (QuantReg: 13.28296) QuantErr: 13.28296 batch_time=0.46044 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 5.60046 (QuantReg: 13.38927) QuantErr: 13.38927 batch_time=5.11605 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 5.01442 (QuantReg: 13.34931) QuantErr: 13.34931 batch_time=0.41627 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 3.81277 (QuantReg: 13.37296) QuantErr: 13.37296 batch_time=0.45729 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 4.50690 (QuantReg: 13.22778) QuantErr: 13.22778 batch_time=0.40796 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 4.04970 (QuantReg: 13.65019) QuantErr: 13.65019 batch_time=0.39273 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 4.65495 (QuantReg: 13.22420) QuantErr: 13.22420 batch_time=0.40726 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 4.00649 (QuantReg: 13.36848) QuantErr: 13.36848 batch_time=0.41541 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 3.64561 (QuantReg: 13.32862) QuantErr: 13.32862 batch_time=0.39784 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 4.15950 (QuantReg: 13.03687) QuantErr: 13.03687 batch_time=0.41359 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 4.37788 (QuantReg: 13.09952) QuantErr: 13.09952 batch_time=0.41999 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 4.52278 (QuantReg: 13.29501) QuantErr: 13.29501 batch_time=0.40378 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 5.44057 (QuantReg: 13.43269) QuantErr: 13.43269 batch_time=1.33299 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 5.46449 (QuantReg: 12.95884) QuantErr: 12.95884 batch_time=0.39371 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 5.39625 (QuantReg: 13.53093) QuantErr: 13.53093 batch_time=0.41135 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 4.71729 (QuantReg: 13.17007) QuantErr: 13.17007 batch_time=0.40702 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 4.96054 (QuantReg: 13.38821) QuantErr: 13.38821 batch_time=0.40720 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 4.39518 (QuantReg: 13.17401) QuantErr: 13.17401 batch_time=0.39614 
Train Epoch: 40 codebook_update_time=0.44313
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch40.pth ...
Done in 4.159s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch40.pth ...
Done in 8.207s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 4.781594913482666
 quant_reg      : 13.256576251983642
 quant_err      : 13.256576251983642
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.209
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.04314265772763
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.348
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.955754938024796
 mnt_best       : 45.04314265772763
 not_improved_count: 0
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 4.90924 (QuantReg: 13.21264) QuantErr: 13.21264 batch_time=36.34344 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 4.11594 (QuantReg: 13.33419) QuantErr: 13.33419 batch_time=0.42795 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 5.47837 (QuantReg: 13.02080) QuantErr: 13.02080 batch_time=0.39297 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 4.27631 (QuantReg: 13.43252) QuantErr: 13.43252 batch_time=0.39760 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 3.94906 (QuantReg: 13.51259) QuantErr: 13.51259 batch_time=0.44872 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 4.42680 (QuantReg: 13.30359) QuantErr: 13.30359 batch_time=0.42660 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 6.94847 (QuantReg: 13.10548) QuantErr: 13.10548 batch_time=0.39593 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 5.13505 (QuantReg: 13.39721) QuantErr: 13.39721 batch_time=0.43901 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 4.87807 (QuantReg: 13.33072) QuantErr: 13.33072 batch_time=0.40292 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 4.98135 (QuantReg: 13.08399) QuantErr: 13.08399 batch_time=0.39100 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 5.27674 (QuantReg: 13.23112) QuantErr: 13.23112 batch_time=0.40839 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 4.68655 (QuantReg: 13.28912) QuantErr: 13.28912 batch_time=0.38914 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 4.82263 (QuantReg: 13.31339) QuantErr: 13.31339 batch_time=0.42342 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 5.26141 (QuantReg: 13.09374) QuantErr: 13.09374 batch_time=0.41212 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 4.90553 (QuantReg: 12.94624) QuantErr: 12.94624 batch_time=0.50938 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 4.16742 (QuantReg: 12.99838) QuantErr: 12.99838 batch_time=0.40694 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 4.83226 (QuantReg: 13.36449) QuantErr: 13.36449 batch_time=0.39904 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 4.73060 (QuantReg: 13.26612) QuantErr: 13.26612 batch_time=0.39210 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 6.00303 (QuantReg: 13.17970) QuantErr: 13.17970 batch_time=0.38913 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 5.40190 (QuantReg: 13.16930) QuantErr: 13.16930 batch_time=0.45953 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 4.76644 (QuantReg: 13.06534) QuantErr: 13.06534 batch_time=1.71458 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 3.69527 (QuantReg: 13.41504) QuantErr: 13.41504 batch_time=0.40518 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 4.75891 (QuantReg: 13.18223) QuantErr: 13.18223 batch_time=0.39913 
Train Epoch: 41 codebook_update_time=0.42793
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch41.pth ...
Done in 4.934s
removing stale ckpt [epoch 40] [took 0.03s]
 epoch          : 41
 loss           : 4.761074228286743
 quant_reg      : 13.271419570922852
 quant_err      : 13.271419570922852
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.692
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.94628850867044
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.738
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.38451977933437
 mnt_best       : 45.04314265772763
 not_improved_count: 1
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 4.40265 (QuantReg: 13.23265) QuantErr: 13.23265 batch_time=42.64385 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 6.10258 (QuantReg: 13.12747) QuantErr: 13.12747 batch_time=0.42133 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 4.59720 (QuantReg: 12.98393) QuantErr: 12.98393 batch_time=0.40062 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 4.69444 (QuantReg: 13.10661) QuantErr: 13.10661 batch_time=0.43311 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 4.67010 (QuantReg: 13.06635) QuantErr: 13.06635 batch_time=0.42255 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 5.15539 (QuantReg: 13.54997) QuantErr: 13.54997 batch_time=0.43681 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 3.78164 (QuantReg: 13.60278) QuantErr: 13.60278 batch_time=0.40492 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 4.63726 (QuantReg: 13.20558) QuantErr: 13.20558 batch_time=0.44264 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 5.20930 (QuantReg: 12.98874) QuantErr: 12.98874 batch_time=0.40505 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 4.50900 (QuantReg: 13.37200) QuantErr: 13.37200 batch_time=0.41129 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 4.42480 (QuantReg: 13.40036) QuantErr: 13.40036 batch_time=0.41051 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 4.38131 (QuantReg: 13.38484) QuantErr: 13.38484 batch_time=0.83365 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 5.16045 (QuantReg: 13.14538) QuantErr: 13.14538 batch_time=0.76675 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 5.63476 (QuantReg: 13.08872) QuantErr: 13.08872 batch_time=0.43408 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 4.46888 (QuantReg: 13.44316) QuantErr: 13.44316 batch_time=0.41313 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 5.04198 (QuantReg: 13.43315) QuantErr: 13.43315 batch_time=0.40190 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 4.72033 (QuantReg: 13.13908) QuantErr: 13.13908 batch_time=0.40351 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 4.88592 (QuantReg: 13.72419) QuantErr: 13.72419 batch_time=0.42024 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 4.70230 (QuantReg: 13.59395) QuantErr: 13.59395 batch_time=0.40343 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 4.79130 (QuantReg: 13.34091) QuantErr: 13.34091 batch_time=0.42586 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 4.48963 (QuantReg: 13.25808) QuantErr: 13.25808 batch_time=0.40779 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 4.82490 (QuantReg: 13.18290) QuantErr: 13.18290 batch_time=0.41012 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 4.58112 (QuantReg: 13.45911) QuantErr: 13.45911 batch_time=0.42292 
Train Epoch: 42 codebook_update_time=0.49469
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch42.pth ...
Done in 4.566s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 4.704475847244263
 quant_reg      : 13.334041873931884
 quant_err      : 13.334041873931884
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.593
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.994630470428866
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.154
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.31502505849472
 mnt_best       : 45.04314265772763
 not_improved_count: 2
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 4.60736 (QuantReg: 13.30735) QuantErr: 13.30735 batch_time=32.79966 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 5.94326 (QuantReg: 13.02437) QuantErr: 13.02437 batch_time=0.41728 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 3.80942 (QuantReg: 13.20109) QuantErr: 13.20109 batch_time=0.39926 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 5.08809 (QuantReg: 13.35300) QuantErr: 13.35300 batch_time=0.40588 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 3.52969 (QuantReg: 13.45169) QuantErr: 13.45169 batch_time=0.40402 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 3.03665 (QuantReg: 13.42662) QuantErr: 13.42662 batch_time=0.39788 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 4.64136 (QuantReg: 13.66246) QuantErr: 13.66246 batch_time=0.41042 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 5.30906 (QuantReg: 13.25668) QuantErr: 13.25668 batch_time=0.43893 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 5.04646 (QuantReg: 13.28364) QuantErr: 13.28364 batch_time=1.13570 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 4.32790 (QuantReg: 13.46527) QuantErr: 13.46527 batch_time=2.03804 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 4.59632 (QuantReg: 13.20964) QuantErr: 13.20964 batch_time=0.46711 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 4.51726 (QuantReg: 13.58185) QuantErr: 13.58185 batch_time=0.46103 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 4.08056 (QuantReg: 13.51256) QuantErr: 13.51256 batch_time=0.54710 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 4.20471 (QuantReg: 13.42329) QuantErr: 13.42329 batch_time=0.39899 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 5.66868 (QuantReg: 13.54402) QuantErr: 13.54402 batch_time=0.38468 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 3.97971 (QuantReg: 13.21529) QuantErr: 13.21529 batch_time=0.41101 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 4.91223 (QuantReg: 13.37921) QuantErr: 13.37921 batch_time=0.44907 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 4.60553 (QuantReg: 13.26257) QuantErr: 13.26257 batch_time=0.41455 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 5.44438 (QuantReg: 13.42841) QuantErr: 13.42841 batch_time=0.94426 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 4.42818 (QuantReg: 13.20194) QuantErr: 13.20194 batch_time=0.42271 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 4.81181 (QuantReg: 13.45130) QuantErr: 13.45130 batch_time=0.41371 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 5.04554 (QuantReg: 13.27148) QuantErr: 13.27148 batch_time=0.45232 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 3.67944 (QuantReg: 13.27702) QuantErr: 13.27702 batch_time=0.42690 
Train Epoch: 43 codebook_update_time=0.41970
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch43.pth ...
Done in 4.201s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 4.674278240203858
 quant_reg      : 13.32140958404541
 quant_err      : 13.32140958404541
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.689
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.62904210732643
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.7995
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.05427262473032
 mnt_best       : 45.04314265772763
 not_improved_count: 3
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 4.52629 (QuantReg: 13.21172) QuantErr: 13.21172 batch_time=34.96887 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 5.03704 (QuantReg: 13.18901) QuantErr: 13.18901 batch_time=0.46761 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 4.63358 (QuantReg: 13.22255) QuantErr: 13.22255 batch_time=0.42367 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 5.58989 (QuantReg: 13.27695) QuantErr: 13.27695 batch_time=0.43750 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 4.80965 (QuantReg: 13.09227) QuantErr: 13.09227 batch_time=0.41007 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 3.46239 (QuantReg: 13.36323) QuantErr: 13.36323 batch_time=0.38346 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 4.71574 (QuantReg: 13.49268) QuantErr: 13.49268 batch_time=0.42603 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 4.94833 (QuantReg: 13.18380) QuantErr: 13.18380 batch_time=0.40375 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 5.01418 (QuantReg: 13.40545) QuantErr: 13.40545 batch_time=0.48169 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 4.74707 (QuantReg: 13.15656) QuantErr: 13.15656 batch_time=0.42548 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 4.15146 (QuantReg: 13.35445) QuantErr: 13.35445 batch_time=0.46894 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 4.37968 (QuantReg: 13.15146) QuantErr: 13.15146 batch_time=0.70262 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 3.81017 (QuantReg: 13.23237) QuantErr: 13.23237 batch_time=0.43053 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 3.85925 (QuantReg: 13.37103) QuantErr: 13.37103 batch_time=0.41132 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 4.24627 (QuantReg: 13.51815) QuantErr: 13.51815 batch_time=0.41798 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 5.99758 (QuantReg: 13.32512) QuantErr: 13.32512 batch_time=0.39299 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 4.55248 (QuantReg: 13.67380) QuantErr: 13.67380 batch_time=0.43786 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 4.99680 (QuantReg: 13.11578) QuantErr: 13.11578 batch_time=0.45563 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 4.57455 (QuantReg: 13.16702) QuantErr: 13.16702 batch_time=0.43445 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 3.57190 (QuantReg: 13.36371) QuantErr: 13.36371 batch_time=0.43377 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 5.77823 (QuantReg: 13.43835) QuantErr: 13.43835 batch_time=0.42807 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 4.19784 (QuantReg: 13.54611) QuantErr: 13.54611 batch_time=0.38751 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 3.85965 (QuantReg: 13.36760) QuantErr: 13.36760 batch_time=0.39564 
Train Epoch: 44 codebook_update_time=0.43478
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch44.pth ...
Done in 4.409s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 4.687002190589904
 quant_reg      : 13.310508514404297
 quant_err      : 13.310508514404297
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.719
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.61413750104075
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.1505
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.216273149607545
 mnt_best       : 45.04314265772763
 not_improved_count: 4
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 4.31322 (QuantReg: 13.16600) QuantErr: 13.16600 batch_time=36.78820 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 3.99979 (QuantReg: 13.35270) QuantErr: 13.35270 batch_time=0.43184 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 4.77055 (QuantReg: 13.16419) QuantErr: 13.16419 batch_time=0.40679 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 4.38429 (QuantReg: 13.17457) QuantErr: 13.17457 batch_time=0.40556 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 4.59245 (QuantReg: 13.26457) QuantErr: 13.26457 batch_time=0.41742 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 4.20408 (QuantReg: 13.32636) QuantErr: 13.32636 batch_time=0.41886 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 5.21832 (QuantReg: 13.03681) QuantErr: 13.03681 batch_time=0.97900 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 4.14083 (QuantReg: 13.34422) QuantErr: 13.34422 batch_time=0.39761 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 3.95483 (QuantReg: 13.39525) QuantErr: 13.39525 batch_time=0.40622 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 4.65516 (QuantReg: 13.10871) QuantErr: 13.10871 batch_time=0.39559 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 4.19772 (QuantReg: 13.42459) QuantErr: 13.42459 batch_time=0.39254 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 4.09227 (QuantReg: 13.33387) QuantErr: 13.33387 batch_time=0.40707 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 3.98167 (QuantReg: 13.13411) QuantErr: 13.13411 batch_time=0.57007 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 4.02115 (QuantReg: 13.38212) QuantErr: 13.38212 batch_time=0.42642 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 4.90366 (QuantReg: 12.97852) QuantErr: 12.97852 batch_time=0.64263 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 4.22288 (QuantReg: 13.45855) QuantErr: 13.45855 batch_time=0.40823 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 4.09304 (QuantReg: 13.07304) QuantErr: 13.07304 batch_time=0.44111 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 4.01466 (QuantReg: 13.17859) QuantErr: 13.17859 batch_time=0.39681 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 5.46654 (QuantReg: 13.27386) QuantErr: 13.27386 batch_time=0.42779 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 5.11463 (QuantReg: 13.19841) QuantErr: 13.19841 batch_time=0.40142 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 7.18338 (QuantReg: 12.73080) QuantErr: 12.73080 batch_time=0.39412 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 4.63813 (QuantReg: 13.77673) QuantErr: 13.77673 batch_time=0.39675 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 4.98766 (QuantReg: 13.45420) QuantErr: 13.45420 batch_time=0.44157 
Train Epoch: 45 codebook_update_time=0.41533
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch45.pth ...
Done in 4.689s
removing stale ckpt [epoch 44] [took 0.01s]
 epoch          : 45
 loss           : 4.701739233016967
 quant_reg      : 13.315608333587646
 quant_err      : 13.315608333587646
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.879
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.03008754792899
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.118
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.31406957385149
 mnt_best       : 45.04314265772763
 not_improved_count: 5
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 4.90976 (QuantReg: 13.38860) QuantErr: 13.38860 batch_time=35.77545 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 5.38613 (QuantReg: 13.02375) QuantErr: 13.02375 batch_time=0.40717 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 5.85198 (QuantReg: 13.14742) QuantErr: 13.14742 batch_time=0.42377 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 5.25468 (QuantReg: 13.43272) QuantErr: 13.43272 batch_time=0.45887 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 3.72511 (QuantReg: 13.33087) QuantErr: 13.33087 batch_time=0.48452 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 4.97327 (QuantReg: 13.03413) QuantErr: 13.03413 batch_time=0.43381 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 4.77333 (QuantReg: 13.31344) QuantErr: 13.31344 batch_time=1.02497 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 4.47509 (QuantReg: 13.28258) QuantErr: 13.28258 batch_time=0.39530 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 4.84664 (QuantReg: 13.61678) QuantErr: 13.61678 batch_time=0.39750 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 4.73910 (QuantReg: 13.40947) QuantErr: 13.40947 batch_time=0.48211 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 4.93472 (QuantReg: 13.13832) QuantErr: 13.13832 batch_time=0.41917 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 6.31817 (QuantReg: 13.03584) QuantErr: 13.03584 batch_time=0.39417 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 4.90070 (QuantReg: 13.48350) QuantErr: 13.48350 batch_time=0.45752 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 5.33493 (QuantReg: 13.37986) QuantErr: 13.37986 batch_time=0.44716 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 3.93252 (QuantReg: 13.36037) QuantErr: 13.36037 batch_time=0.42547 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 3.58107 (QuantReg: 13.66521) QuantErr: 13.66521 batch_time=0.39210 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 4.37786 (QuantReg: 13.17903) QuantErr: 13.17903 batch_time=0.44850 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 3.46850 (QuantReg: 13.67261) QuantErr: 13.67261 batch_time=0.40782 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 4.77242 (QuantReg: 13.65412) QuantErr: 13.65412 batch_time=0.46541 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 3.21428 (QuantReg: 13.39152) QuantErr: 13.39152 batch_time=0.46474 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 4.75682 (QuantReg: 13.47156) QuantErr: 13.47156 batch_time=1.93456 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 4.38715 (QuantReg: 13.61948) QuantErr: 13.61948 batch_time=0.41818 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 5.09940 (QuantReg: 13.42538) QuantErr: 13.42538 batch_time=0.42314 
Train Epoch: 46 codebook_update_time=0.41847
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch46.pth ...
Done in 4.505s
removing stale ckpt [epoch 45] [took 0.06s]
 epoch          : 46
 loss           : 4.655829998970032
 quant_reg      : 13.352469837188721
 quant_err      : 13.352469837188721
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.282
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.86260689520296
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.565
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.314665660741916
 mnt_best       : 45.04314265772763
 not_improved_count: 6
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 5.07406 (QuantReg: 13.32926) QuantErr: 13.32926 batch_time=33.16267 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 3.55429 (QuantReg: 13.44604) QuantErr: 13.44604 batch_time=0.42498 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 5.51065 (QuantReg: 13.49045) QuantErr: 13.49045 batch_time=0.41188 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 3.40553 (QuantReg: 13.55011) QuantErr: 13.55011 batch_time=0.44541 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 4.73749 (QuantReg: 13.24482) QuantErr: 13.24482 batch_time=0.40173 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 5.59760 (QuantReg: 13.16755) QuantErr: 13.16755 batch_time=0.41753 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 5.17328 (QuantReg: 13.45088) QuantErr: 13.45088 batch_time=0.40496 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 4.88888 (QuantReg: 13.71699) QuantErr: 13.71699 batch_time=0.43606 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 3.49137 (QuantReg: 13.39001) QuantErr: 13.39001 batch_time=0.39412 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 4.38223 (QuantReg: 13.14448) QuantErr: 13.14448 batch_time=0.41136 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 5.51452 (QuantReg: 13.27881) QuantErr: 13.27881 batch_time=0.40722 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 5.24269 (QuantReg: 13.53929) QuantErr: 13.53929 batch_time=0.41445 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 4.47492 (QuantReg: 13.24432) QuantErr: 13.24432 batch_time=0.51343 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 5.36679 (QuantReg: 13.35697) QuantErr: 13.35697 batch_time=0.42565 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 4.27885 (QuantReg: 13.28419) QuantErr: 13.28419 batch_time=0.39611 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 4.74997 (QuantReg: 13.32380) QuantErr: 13.32380 batch_time=0.40278 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 4.74400 (QuantReg: 13.44953) QuantErr: 13.44953 batch_time=0.42475 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 4.31232 (QuantReg: 13.66098) QuantErr: 13.66098 batch_time=0.41978 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 4.49014 (QuantReg: 13.64313) QuantErr: 13.64313 batch_time=0.40132 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 3.88577 (QuantReg: 13.65469) QuantErr: 13.65469 batch_time=0.40103 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 4.03853 (QuantReg: 13.24394) QuantErr: 13.24394 batch_time=0.45338 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 5.08717 (QuantReg: 13.15448) QuantErr: 13.15448 batch_time=0.38429 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 4.75621 (QuantReg: 13.21001) QuantErr: 13.21001 batch_time=0.41097 
Train Epoch: 47 codebook_update_time=0.49585
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch47.pth ...
Done in 4.892s
removing stale ckpt [epoch 46] [took 0.02s]
 epoch          : 47
 loss           : 4.693372521400452
 quant_reg      : 13.382305763244629
 quant_err      : 13.382305763244629
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.132
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.702167464929154
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.3945
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.0219547190304
 mnt_best       : 45.04314265772763
 not_improved_count: 7
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 5.12896 (QuantReg: 13.13183) QuantErr: 13.13183 batch_time=37.93696 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 3.53599 (QuantReg: 13.38636) QuantErr: 13.38636 batch_time=0.41234 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 4.16124 (QuantReg: 13.29204) QuantErr: 13.29204 batch_time=0.38282 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 4.83397 (QuantReg: 13.29039) QuantErr: 13.29039 batch_time=0.42653 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 3.21998 (QuantReg: 13.34089) QuantErr: 13.34089 batch_time=0.42698 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 4.93409 (QuantReg: 13.23011) QuantErr: 13.23011 batch_time=0.44990 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 4.46717 (QuantReg: 13.12065) QuantErr: 13.12065 batch_time=0.39828 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 4.24150 (QuantReg: 13.43337) QuantErr: 13.43337 batch_time=0.47480 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 4.39643 (QuantReg: 13.39908) QuantErr: 13.39908 batch_time=0.39843 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 4.53654 (QuantReg: 13.47051) QuantErr: 13.47051 batch_time=0.41800 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 3.41731 (QuantReg: 13.47373) QuantErr: 13.47373 batch_time=0.40073 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 4.94263 (QuantReg: 13.77757) QuantErr: 13.77757 batch_time=0.42156 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 3.31914 (QuantReg: 13.28103) QuantErr: 13.28103 batch_time=0.41891 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 4.28217 (QuantReg: 13.28906) QuantErr: 13.28906 batch_time=0.40070 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 4.74705 (QuantReg: 13.26707) QuantErr: 13.26707 batch_time=0.40446 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 4.96887 (QuantReg: 13.36403) QuantErr: 13.36403 batch_time=0.41974 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 5.67871 (QuantReg: 13.40265) QuantErr: 13.40265 batch_time=0.39450 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 4.26371 (QuantReg: 13.53778) QuantErr: 13.53778 batch_time=0.40525 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 5.63241 (QuantReg: 13.20570) QuantErr: 13.20570 batch_time=0.42685 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 4.50455 (QuantReg: 13.70602) QuantErr: 13.70602 batch_time=0.42957 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 4.41207 (QuantReg: 13.25216) QuantErr: 13.25216 batch_time=0.40405 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 4.23782 (QuantReg: 13.27665) QuantErr: 13.27665 batch_time=0.40547 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 5.44648 (QuantReg: 13.24355) QuantErr: 13.24355 batch_time=0.44936 
Train Epoch: 48 codebook_update_time=0.42161
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch48.pth ...
Done in 5.147s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 4.711267214775085
 quant_reg      : 13.38420524597168
 quant_err      : 13.38420524597168
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.927
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.310004925019506
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.8545
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.179427326934004
 mnt_best       : 45.04314265772763
 not_improved_count: 8
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 4.84848 (QuantReg: 13.20188) QuantErr: 13.20188 batch_time=34.77240 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 5.42472 (QuantReg: 13.62020) QuantErr: 13.62020 batch_time=0.48345 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 4.05372 (QuantReg: 13.24028) QuantErr: 13.24028 batch_time=0.40883 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 5.60815 (QuantReg: 13.04447) QuantErr: 13.04447 batch_time=0.43566 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 3.78318 (QuantReg: 13.10553) QuantErr: 13.10553 batch_time=0.47800 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 3.60889 (QuantReg: 13.48603) QuantErr: 13.48603 batch_time=0.47526 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 5.62880 (QuantReg: 13.24120) QuantErr: 13.24120 batch_time=0.44612 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 5.68024 (QuantReg: 13.41058) QuantErr: 13.41058 batch_time=0.40742 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 5.45453 (QuantReg: 13.26177) QuantErr: 13.26177 batch_time=0.44965 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 4.25763 (QuantReg: 13.48753) QuantErr: 13.48753 batch_time=0.40135 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 5.52282 (QuantReg: 13.41644) QuantErr: 13.41644 batch_time=0.39552 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 4.06894 (QuantReg: 13.45051) QuantErr: 13.45051 batch_time=0.42932 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 4.98387 (QuantReg: 13.23510) QuantErr: 13.23510 batch_time=1.73297 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 4.57907 (QuantReg: 13.26405) QuantErr: 13.26405 batch_time=0.41097 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 4.40821 (QuantReg: 13.48321) QuantErr: 13.48321 batch_time=0.40020 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 5.34191 (QuantReg: 13.24948) QuantErr: 13.24948 batch_time=0.40642 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 5.03427 (QuantReg: 13.48532) QuantErr: 13.48532 batch_time=0.39631 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 5.13063 (QuantReg: 13.54232) QuantErr: 13.54232 batch_time=0.53433 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 4.39510 (QuantReg: 13.38655) QuantErr: 13.38655 batch_time=0.63718 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 4.01831 (QuantReg: 13.13800) QuantErr: 13.13800 batch_time=0.59269 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 4.17039 (QuantReg: 13.50975) QuantErr: 13.50975 batch_time=0.41757 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 5.73988 (QuantReg: 13.61057) QuantErr: 13.61057 batch_time=0.40524 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 4.05072 (QuantReg: 13.49601) QuantErr: 13.49601 batch_time=0.39702 
Train Epoch: 49 codebook_update_time=0.44241
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch49.pth ...
Done in 4.203s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 4.749456329345703
 quant_reg      : 13.38806209564209
 quant_err      : 13.38806209564209
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.809
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.57575112758033
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.873
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.73571309266347
 mnt_best       : 45.04314265772763
 not_improved_count: 9
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 5.55986 (QuantReg: 13.52506) QuantErr: 13.52506 batch_time=33.27130 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 4.22898 (QuantReg: 13.18853) QuantErr: 13.18853 batch_time=0.41198 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 5.59806 (QuantReg: 13.14452) QuantErr: 13.14452 batch_time=0.41013 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 3.96868 (QuantReg: 13.28264) QuantErr: 13.28264 batch_time=0.46200 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 4.46941 (QuantReg: 13.25220) QuantErr: 13.25220 batch_time=0.42676 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 4.65922 (QuantReg: 13.60449) QuantErr: 13.60449 batch_time=0.41679 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 4.76185 (QuantReg: 13.40203) QuantErr: 13.40203 batch_time=0.80622 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 4.70196 (QuantReg: 13.48842) QuantErr: 13.48842 batch_time=0.42523 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 4.89315 (QuantReg: 13.45030) QuantErr: 13.45030 batch_time=0.40390 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 4.75513 (QuantReg: 13.77135) QuantErr: 13.77135 batch_time=0.40143 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 5.50089 (QuantReg: 13.26112) QuantErr: 13.26112 batch_time=0.41908 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 3.97943 (QuantReg: 13.19987) QuantErr: 13.19987 batch_time=0.40220 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 4.94038 (QuantReg: 13.65172) QuantErr: 13.65172 batch_time=4.37227 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 5.66998 (QuantReg: 13.03298) QuantErr: 13.03298 batch_time=0.39896 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 5.01995 (QuantReg: 13.38951) QuantErr: 13.38951 batch_time=0.43338 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 5.51793 (QuantReg: 13.24556) QuantErr: 13.24556 batch_time=0.58098 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 6.00483 (QuantReg: 13.34256) QuantErr: 13.34256 batch_time=0.41499 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 4.04152 (QuantReg: 13.47811) QuantErr: 13.47811 batch_time=0.42540 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 4.68981 (QuantReg: 13.17027) QuantErr: 13.17027 batch_time=0.40109 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 4.81521 (QuantReg: 13.46968) QuantErr: 13.46968 batch_time=0.39201 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 3.96014 (QuantReg: 13.40018) QuantErr: 13.40018 batch_time=0.40931 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 3.50425 (QuantReg: 13.66450) QuantErr: 13.66450 batch_time=0.41287 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 4.35652 (QuantReg: 13.38112) QuantErr: 13.38112 batch_time=0.40194 
Train Epoch: 50 codebook_update_time=0.42451
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/checkpoint-epoch50.pth ...
Done in 5.840s
removing stale ckpt [epoch 49] [took 0.03s]
 epoch          : 50
 loss           : 4.725370783805847
 quant_reg      : 13.385328418731689
 quant_err      : 13.385328418731689
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.853
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.00769252555982
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.9485
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.72509805413304
 mnt_best       : 45.04314265772763
 not_improved_count: 10
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/trained_model.pth ...
Ckpt loaded at epoch 40.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 25.1
 t2v_metrics/R5/final_eval: 54.1
 t2v_metrics/R10/final_eval: 67.3
 t2v_metrics/R50/final_eval: 89.1
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 28.209
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 45.04314265772763
 v2t_metrics/R1/final_eval: 22.7
 v2t_metrics/R5/final_eval: 55.1
 v2t_metrics/R10/final_eval: 67.9
 v2t_metrics/R50/final_eval: 89.9
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 25.3475
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 43.955754938024796
Best epoch for the monitored metric: 40
Script took 03h21m24s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_L1/trained_model.pth
