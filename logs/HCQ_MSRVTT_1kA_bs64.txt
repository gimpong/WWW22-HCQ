Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 1274.2785212993622 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 73.84164261817932 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 48.81112051010132 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch0.pth ...
Done in 1.477s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch0.pth ...
Done in 2.943s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 486.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 496.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 6.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 509.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.5355
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.5192494101851104
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/500 64/32000 (0%)] Loss: 8.42179 (QuantReg: 22.48055) QuantErr: 22.48055 batch_time=17.35523 
Train Epoch: 1 [9/500 576/32000 (2%)] Loss: 8.07024 (QuantReg: 22.58955) QuantErr: 22.58955 batch_time=0.39848 
Train Epoch: 1 [17/500 1088/32000 (3%)] Loss: 7.08605 (QuantReg: 22.54650) QuantErr: 22.54650 batch_time=0.40290 
Train Epoch: 1 [25/500 1600/32000 (5%)] Loss: 6.10758 (QuantReg: 22.59287) QuantErr: 22.59287 batch_time=0.39126 
Train Epoch: 1 [33/500 2112/32000 (7%)] Loss: 6.06135 (QuantReg: 22.61736) QuantErr: 22.61736 batch_time=0.39824 
Train Epoch: 1 [41/500 2624/32000 (8%)] Loss: 5.71115 (QuantReg: 22.59416) QuantErr: 22.59416 batch_time=0.38560 
Train Epoch: 1 [49/500 3136/32000 (10%)] Loss: 4.87021 (QuantReg: 22.58594) QuantErr: 22.58594 batch_time=0.41387 
Train Epoch: 1 [57/500 3648/32000 (11%)] Loss: 5.34070 (QuantReg: 22.60461) QuantErr: 22.60461 batch_time=0.40046 
Train Epoch: 1 [65/500 4160/32000 (13%)] Loss: 4.90885 (QuantReg: 22.61914) QuantErr: 22.61914 batch_time=0.46010 
Train Epoch: 1 [73/500 4672/32000 (15%)] Loss: 4.90732 (QuantReg: 22.62774) QuantErr: 22.62774 batch_time=0.43538 
Train Epoch: 1 [81/500 5184/32000 (16%)] Loss: 4.50384 (QuantReg: 22.64861) QuantErr: 22.64861 batch_time=0.43536 
Train Epoch: 1 [89/500 5696/32000 (18%)] Loss: 4.65365 (QuantReg: 22.66018) QuantErr: 22.66018 batch_time=0.38996 
Train Epoch: 1 [97/500 6208/32000 (19%)] Loss: 4.83792 (QuantReg: 22.62110) QuantErr: 22.62110 batch_time=0.38874 
Train Epoch: 1 [105/500 6720/32000 (21%)] Loss: 4.73095 (QuantReg: 22.66097) QuantErr: 22.66097 batch_time=0.44417 
Train Epoch: 1 [113/500 7232/32000 (23%)] Loss: 4.24784 (QuantReg: 22.59879) QuantErr: 22.59879 batch_time=0.39493 
Train Epoch: 1 [121/500 7744/32000 (24%)] Loss: 4.60036 (QuantReg: 22.64107) QuantErr: 22.64107 batch_time=0.40610 
Train Epoch: 1 [129/500 8256/32000 (26%)] Loss: 3.78088 (QuantReg: 22.66199) QuantErr: 22.66199 batch_time=0.40453 
Train Epoch: 1 [137/500 8768/32000 (27%)] Loss: 4.35878 (QuantReg: 22.61040) QuantErr: 22.61040 batch_time=0.43583 
Train Epoch: 1 [145/500 9280/32000 (29%)] Loss: 3.27047 (QuantReg: 22.64496) QuantErr: 22.64496 batch_time=0.38996 
Train Epoch: 1 [153/500 9792/32000 (31%)] Loss: 3.92429 (QuantReg: 22.66969) QuantErr: 22.66969 batch_time=0.38104 
Train Epoch: 1 [161/500 10304/32000 (32%)] Loss: 3.87782 (QuantReg: 22.66512) QuantErr: 22.66512 batch_time=0.38540 
Train Epoch: 1 [169/500 10816/32000 (34%)] Loss: 3.47285 (QuantReg: 22.65261) QuantErr: 22.65261 batch_time=0.38708 
Train Epoch: 1 [177/500 11328/32000 (35%)] Loss: 3.92579 (QuantReg: 22.64712) QuantErr: 22.64712 batch_time=0.47100 
Train Epoch: 1 [185/500 11840/32000 (37%)] Loss: 3.26597 (QuantReg: 22.61395) QuantErr: 22.61395 batch_time=0.39641 
Train Epoch: 1 [193/500 12352/32000 (39%)] Loss: 3.95681 (QuantReg: 22.66005) QuantErr: 22.66005 batch_time=0.39853 
Train Epoch: 1 [201/500 12864/32000 (40%)] Loss: 3.98504 (QuantReg: 22.65438) QuantErr: 22.65438 batch_time=0.47840 
Train Epoch: 1 [209/500 13376/32000 (42%)] Loss: 4.30273 (QuantReg: 22.66579) QuantErr: 22.66579 batch_time=0.41473 
Train Epoch: 1 [217/500 13888/32000 (43%)] Loss: 3.88799 (QuantReg: 22.64647) QuantErr: 22.64647 batch_time=0.44175 
Train Epoch: 1 [225/500 14400/32000 (45%)] Loss: 3.63270 (QuantReg: 22.62845) QuantErr: 22.62845 batch_time=0.39661 
Train Epoch: 1 [233/500 14912/32000 (47%)] Loss: 3.46709 (QuantReg: 22.68782) QuantErr: 22.68782 batch_time=0.41262 
Train Epoch: 1 [241/500 15424/32000 (48%)] Loss: 3.39004 (QuantReg: 22.66500) QuantErr: 22.66500 batch_time=0.40127 
Train Epoch: 1 [249/500 15936/32000 (50%)] Loss: 3.98725 (QuantReg: 22.65261) QuantErr: 22.65261 batch_time=0.39512 
Train Epoch: 1 [257/500 16448/32000 (51%)] Loss: 3.60587 (QuantReg: 22.64394) QuantErr: 22.64394 batch_time=0.39538 
Train Epoch: 1 [265/500 16960/32000 (53%)] Loss: 4.18740 (QuantReg: 22.62760) QuantErr: 22.62760 batch_time=0.42709 
Train Epoch: 1 [273/500 17472/32000 (55%)] Loss: 3.73767 (QuantReg: 22.67062) QuantErr: 22.67062 batch_time=0.43085 
Train Epoch: 1 [281/500 17984/32000 (56%)] Loss: 3.30122 (QuantReg: 22.69070) QuantErr: 22.69070 batch_time=0.38970 
Train Epoch: 1 [289/500 18496/32000 (58%)] Loss: 3.65412 (QuantReg: 22.69288) QuantErr: 22.69288 batch_time=0.39365 
Train Epoch: 1 [297/500 19008/32000 (59%)] Loss: 3.83355 (QuantReg: 22.70606) QuantErr: 22.70606 batch_time=0.38270 
Train Epoch: 1 [305/500 19520/32000 (61%)] Loss: 3.85061 (QuantReg: 22.68577) QuantErr: 22.68577 batch_time=0.38995 
Train Epoch: 1 [313/500 20032/32000 (63%)] Loss: 3.33344 (QuantReg: 22.68880) QuantErr: 22.68880 batch_time=0.47572 
Train Epoch: 1 [321/500 20544/32000 (64%)] Loss: 3.78285 (QuantReg: 22.75968) QuantErr: 22.75968 batch_time=0.39571 
Train Epoch: 1 [329/500 21056/32000 (66%)] Loss: 3.27215 (QuantReg: 22.71988) QuantErr: 22.71988 batch_time=0.42765 
Train Epoch: 1 [337/500 21568/32000 (67%)] Loss: 3.46358 (QuantReg: 22.69718) QuantErr: 22.69718 batch_time=0.39322 
Train Epoch: 1 [345/500 22080/32000 (69%)] Loss: 3.32685 (QuantReg: 22.70747) QuantErr: 22.70747 batch_time=0.41136 
Train Epoch: 1 [353/500 22592/32000 (71%)] Loss: 3.20432 (QuantReg: 22.66489) QuantErr: 22.66489 batch_time=0.40600 
Train Epoch: 1 [361/500 23104/32000 (72%)] Loss: 2.55573 (QuantReg: 22.72517) QuantErr: 22.72517 batch_time=0.41406 
Train Epoch: 1 [369/500 23616/32000 (74%)] Loss: 3.13936 (QuantReg: 22.65989) QuantErr: 22.65989 batch_time=0.38943 
Train Epoch: 1 [377/500 24128/32000 (75%)] Loss: 4.06648 (QuantReg: 22.65463) QuantErr: 22.65463 batch_time=0.39219 
Train Epoch: 1 [385/500 24640/32000 (77%)] Loss: 4.11589 (QuantReg: 22.69662) QuantErr: 22.69662 batch_time=0.38961 
Train Epoch: 1 [393/500 25152/32000 (79%)] Loss: 3.52591 (QuantReg: 22.73016) QuantErr: 22.73016 batch_time=0.39039 
Train Epoch: 1 [401/500 25664/32000 (80%)] Loss: 2.77390 (QuantReg: 22.70708) QuantErr: 22.70708 batch_time=0.39126 
Train Epoch: 1 [409/500 26176/32000 (82%)] Loss: 3.55209 (QuantReg: 22.70922) QuantErr: 22.70922 batch_time=0.38350 
Train Epoch: 1 [417/500 26688/32000 (83%)] Loss: 3.07362 (QuantReg: 22.71288) QuantErr: 22.71288 batch_time=0.39478 
Train Epoch: 1 [425/500 27200/32000 (85%)] Loss: 3.29908 (QuantReg: 22.67189) QuantErr: 22.67189 batch_time=0.40070 
Train Epoch: 1 [433/500 27712/32000 (87%)] Loss: 2.75428 (QuantReg: 22.67542) QuantErr: 22.67542 batch_time=0.40802 
Train Epoch: 1 [441/500 28224/32000 (88%)] Loss: 3.16129 (QuantReg: 22.72270) QuantErr: 22.72270 batch_time=0.40225 
Train Epoch: 1 [449/500 28736/32000 (90%)] Loss: 2.50772 (QuantReg: 22.71757) QuantErr: 22.71757 batch_time=0.39223 
Train Epoch: 1 [457/500 29248/32000 (91%)] Loss: 2.77431 (QuantReg: 22.67332) QuantErr: 22.67332 batch_time=0.38887 
Train Epoch: 1 [465/500 29760/32000 (93%)] Loss: 2.97457 (QuantReg: 22.67760) QuantErr: 22.67760 batch_time=0.39077 
Train Epoch: 1 [473/500 30272/32000 (95%)] Loss: 2.62806 (QuantReg: 22.64584) QuantErr: 22.64584 batch_time=0.38785 
Train Epoch: 1 [481/500 30784/32000 (96%)] Loss: 3.26924 (QuantReg: 22.69742) QuantErr: 22.69742 batch_time=0.39302 
Train Epoch: 1 [489/500 31296/32000 (98%)] Loss: 2.72277 (QuantReg: 22.71226) QuantErr: 22.71226 batch_time=0.40016 
Train Epoch: 1 [497/500 31808/32000 (99%)] Loss: 2.98632 (QuantReg: 22.65650) QuantErr: 22.65650 batch_time=0.48003 
Train Epoch: 1 codebook_update_time=1.86126
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch1.pth ...
Done in 5.164s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch1.pth ...
Done in 9.733s
 epoch          : 1
 loss           : 3.9536350874900816
 quant_reg      : 22.660221336364746
 quant_err      : 22.660221336364746
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 33.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 46.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 79.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 41.498
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.67396617781575
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 35.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 47.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 39.491
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.1930129112048
 mnt_best       : 25.67396617781575
 not_improved_count: 0
Train Epoch: 2 [1/500 64/32000 (0%)] Loss: 2.62006 (QuantReg: 11.22508) QuantErr: 11.22508 batch_time=18.06759 
Train Epoch: 2 [9/500 576/32000 (2%)] Loss: 2.59872 (QuantReg: 11.13827) QuantErr: 11.13827 batch_time=0.39103 
Train Epoch: 2 [17/500 1088/32000 (3%)] Loss: 2.30567 (QuantReg: 11.42111) QuantErr: 11.42111 batch_time=0.38219 
Train Epoch: 2 [25/500 1600/32000 (5%)] Loss: 3.90870 (QuantReg: 11.59308) QuantErr: 11.59308 batch_time=0.38355 
Train Epoch: 2 [33/500 2112/32000 (7%)] Loss: 2.56186 (QuantReg: 11.86573) QuantErr: 11.86573 batch_time=0.38926 
Train Epoch: 2 [41/500 2624/32000 (8%)] Loss: 3.27057 (QuantReg: 11.29539) QuantErr: 11.29539 batch_time=0.39693 
Train Epoch: 2 [49/500 3136/32000 (10%)] Loss: 3.03469 (QuantReg: 11.90690) QuantErr: 11.90690 batch_time=0.39778 
Train Epoch: 2 [57/500 3648/32000 (11%)] Loss: 3.05091 (QuantReg: 12.26237) QuantErr: 12.26237 batch_time=0.40057 
Train Epoch: 2 [65/500 4160/32000 (13%)] Loss: 3.28774 (QuantReg: 12.35887) QuantErr: 12.35887 batch_time=1.55989 
Train Epoch: 2 [73/500 4672/32000 (15%)] Loss: 2.65737 (QuantReg: 12.36531) QuantErr: 12.36531 batch_time=0.39643 
Train Epoch: 2 [81/500 5184/32000 (16%)] Loss: 2.03313 (QuantReg: 11.96666) QuantErr: 11.96666 batch_time=0.39405 
Train Epoch: 2 [89/500 5696/32000 (18%)] Loss: 2.85253 (QuantReg: 12.42680) QuantErr: 12.42680 batch_time=0.40021 
Train Epoch: 2 [97/500 6208/32000 (19%)] Loss: 3.61672 (QuantReg: 12.56135) QuantErr: 12.56135 batch_time=0.40230 
Train Epoch: 2 [105/500 6720/32000 (21%)] Loss: 2.68787 (QuantReg: 12.12899) QuantErr: 12.12899 batch_time=0.45061 
Train Epoch: 2 [113/500 7232/32000 (23%)] Loss: 2.39090 (QuantReg: 12.50906) QuantErr: 12.50906 batch_time=0.37588 
Train Epoch: 2 [121/500 7744/32000 (24%)] Loss: 2.62116 (QuantReg: 12.84318) QuantErr: 12.84318 batch_time=0.38495 
Train Epoch: 2 [129/500 8256/32000 (26%)] Loss: 2.63476 (QuantReg: 12.66758) QuantErr: 12.66758 batch_time=1.66029 
Train Epoch: 2 [137/500 8768/32000 (27%)] Loss: 2.67035 (QuantReg: 12.51559) QuantErr: 12.51559 batch_time=0.37810 
Train Epoch: 2 [145/500 9280/32000 (29%)] Loss: 2.30875 (QuantReg: 12.34239) QuantErr: 12.34239 batch_time=0.39307 
Train Epoch: 2 [153/500 9792/32000 (31%)] Loss: 2.90315 (QuantReg: 12.88103) QuantErr: 12.88103 batch_time=0.39579 
Train Epoch: 2 [161/500 10304/32000 (32%)] Loss: 2.34022 (QuantReg: 12.78667) QuantErr: 12.78667 batch_time=0.40168 
Train Epoch: 2 [169/500 10816/32000 (34%)] Loss: 2.01825 (QuantReg: 12.78219) QuantErr: 12.78219 batch_time=0.40620 
Train Epoch: 2 [177/500 11328/32000 (35%)] Loss: 2.16241 (QuantReg: 13.12553) QuantErr: 13.12553 batch_time=0.39852 
Train Epoch: 2 [185/500 11840/32000 (37%)] Loss: 3.06039 (QuantReg: 12.70366) QuantErr: 12.70366 batch_time=0.39286 
Train Epoch: 2 [193/500 12352/32000 (39%)] Loss: 2.32288 (QuantReg: 12.42189) QuantErr: 12.42189 batch_time=1.77457 
Train Epoch: 2 [201/500 12864/32000 (40%)] Loss: 3.11832 (QuantReg: 12.59051) QuantErr: 12.59051 batch_time=0.44406 
Train Epoch: 2 [209/500 13376/32000 (42%)] Loss: 2.98633 (QuantReg: 12.90093) QuantErr: 12.90093 batch_time=0.41088 
Train Epoch: 2 [217/500 13888/32000 (43%)] Loss: 2.69851 (QuantReg: 12.79753) QuantErr: 12.79753 batch_time=0.39185 
Train Epoch: 2 [225/500 14400/32000 (45%)] Loss: 3.67118 (QuantReg: 13.10180) QuantErr: 13.10180 batch_time=0.39434 
Train Epoch: 2 [233/500 14912/32000 (47%)] Loss: 2.85293 (QuantReg: 12.79118) QuantErr: 12.79118 batch_time=0.39657 
Train Epoch: 2 [241/500 15424/32000 (48%)] Loss: 2.30044 (QuantReg: 12.77420) QuantErr: 12.77420 batch_time=0.42304 
Train Epoch: 2 [249/500 15936/32000 (50%)] Loss: 2.99484 (QuantReg: 12.93721) QuantErr: 12.93721 batch_time=0.39523 
Train Epoch: 2 [257/500 16448/32000 (51%)] Loss: 2.51131 (QuantReg: 13.11358) QuantErr: 13.11358 batch_time=1.57547 
Train Epoch: 2 [265/500 16960/32000 (53%)] Loss: 2.30855 (QuantReg: 13.02362) QuantErr: 13.02362 batch_time=0.39858 
Train Epoch: 2 [273/500 17472/32000 (55%)] Loss: 2.88098 (QuantReg: 13.17628) QuantErr: 13.17628 batch_time=0.40179 
Train Epoch: 2 [281/500 17984/32000 (56%)] Loss: 2.66678 (QuantReg: 13.67676) QuantErr: 13.67676 batch_time=0.39681 
Train Epoch: 2 [289/500 18496/32000 (58%)] Loss: 2.14355 (QuantReg: 13.52485) QuantErr: 13.52485 batch_time=0.40145 
Train Epoch: 2 [297/500 19008/32000 (59%)] Loss: 2.73268 (QuantReg: 13.33243) QuantErr: 13.33243 batch_time=0.45286 
Train Epoch: 2 [305/500 19520/32000 (61%)] Loss: 3.37707 (QuantReg: 13.19781) QuantErr: 13.19781 batch_time=0.40463 
Train Epoch: 2 [313/500 20032/32000 (63%)] Loss: 2.95430 (QuantReg: 13.27989) QuantErr: 13.27989 batch_time=0.39609 
Train Epoch: 2 [321/500 20544/32000 (64%)] Loss: 3.12812 (QuantReg: 13.50870) QuantErr: 13.50870 batch_time=1.54456 
Train Epoch: 2 [329/500 21056/32000 (66%)] Loss: 1.99385 (QuantReg: 13.45107) QuantErr: 13.45107 batch_time=0.42275 
Train Epoch: 2 [337/500 21568/32000 (67%)] Loss: 2.57126 (QuantReg: 13.62480) QuantErr: 13.62480 batch_time=0.39648 
Train Epoch: 2 [345/500 22080/32000 (69%)] Loss: 3.02131 (QuantReg: 14.00862) QuantErr: 14.00862 batch_time=0.44398 
Train Epoch: 2 [353/500 22592/32000 (71%)] Loss: 2.23672 (QuantReg: 13.47744) QuantErr: 13.47744 batch_time=0.40163 
Train Epoch: 2 [361/500 23104/32000 (72%)] Loss: 2.25001 (QuantReg: 14.08245) QuantErr: 14.08245 batch_time=0.40568 
Train Epoch: 2 [369/500 23616/32000 (74%)] Loss: 2.01165 (QuantReg: 13.92245) QuantErr: 13.92245 batch_time=0.40579 
Train Epoch: 2 [377/500 24128/32000 (75%)] Loss: 2.99366 (QuantReg: 13.58927) QuantErr: 13.58927 batch_time=0.40826 
Train Epoch: 2 [385/500 24640/32000 (77%)] Loss: 2.64802 (QuantReg: 13.78279) QuantErr: 13.78279 batch_time=1.57718 
Train Epoch: 2 [393/500 25152/32000 (79%)] Loss: 2.19498 (QuantReg: 13.83376) QuantErr: 13.83376 batch_time=0.43771 
Train Epoch: 2 [401/500 25664/32000 (80%)] Loss: 2.56817 (QuantReg: 13.83684) QuantErr: 13.83684 batch_time=0.41372 
Train Epoch: 2 [409/500 26176/32000 (82%)] Loss: 2.43078 (QuantReg: 13.51015) QuantErr: 13.51015 batch_time=0.40523 
Train Epoch: 2 [417/500 26688/32000 (83%)] Loss: 2.41594 (QuantReg: 13.55619) QuantErr: 13.55619 batch_time=0.41230 
Train Epoch: 2 [425/500 27200/32000 (85%)] Loss: 2.39532 (QuantReg: 13.74899) QuantErr: 13.74899 batch_time=0.39662 
Train Epoch: 2 [433/500 27712/32000 (87%)] Loss: 2.23112 (QuantReg: 13.88592) QuantErr: 13.88592 batch_time=0.38973 
Train Epoch: 2 [441/500 28224/32000 (88%)] Loss: 2.53970 (QuantReg: 13.92415) QuantErr: 13.92415 batch_time=0.39600 
Train Epoch: 2 [449/500 28736/32000 (90%)] Loss: 2.38390 (QuantReg: 14.21874) QuantErr: 14.21874 batch_time=1.82011 
Train Epoch: 2 [457/500 29248/32000 (91%)] Loss: 1.78954 (QuantReg: 14.30077) QuantErr: 14.30077 batch_time=0.39540 
Train Epoch: 2 [465/500 29760/32000 (93%)] Loss: 2.48937 (QuantReg: 14.47411) QuantErr: 14.47411 batch_time=0.39023 
Train Epoch: 2 [473/500 30272/32000 (95%)] Loss: 2.86483 (QuantReg: 13.79661) QuantErr: 13.79661 batch_time=0.40259 
Train Epoch: 2 [481/500 30784/32000 (96%)] Loss: 2.14529 (QuantReg: 14.56754) QuantErr: 14.56754 batch_time=0.41599 
Train Epoch: 2 [489/500 31296/32000 (98%)] Loss: 2.77052 (QuantReg: 14.07403) QuantErr: 14.07403 batch_time=0.40093 
Train Epoch: 2 [497/500 31808/32000 (99%)] Loss: 2.30852 (QuantReg: 14.81379) QuantErr: 14.81379 batch_time=0.39565 
Train Epoch: 2 codebook_update_time=1.72339
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch2.pth ...
Done in 3.889s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch2.pth ...
Done in 7.716s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.03s]
 epoch          : 2
 loss           : 2.6417448403835295
 quant_reg      : 13.049937316894532
 quant_err      : 13.049937316894532
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 39.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 84.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 33.843
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.677772180283238
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.636
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.03602453372839
 mnt_best       : 30.677772180283238
 not_improved_count: 0
Train Epoch: 3 [1/500 64/32000 (0%)] Loss: 2.26150 (QuantReg: 12.07461) QuantErr: 12.07461 batch_time=16.06029 
Train Epoch: 3 [9/500 576/32000 (2%)] Loss: 2.65554 (QuantReg: 11.09809) QuantErr: 11.09809 batch_time=0.38707 
Train Epoch: 3 [17/500 1088/32000 (3%)] Loss: 2.63913 (QuantReg: 11.19456) QuantErr: 11.19456 batch_time=0.39386 
Train Epoch: 3 [25/500 1600/32000 (5%)] Loss: 2.17775 (QuantReg: 11.29367) QuantErr: 11.29367 batch_time=0.38637 
Train Epoch: 3 [33/500 2112/32000 (7%)] Loss: 2.93336 (QuantReg: 11.18336) QuantErr: 11.18336 batch_time=0.41953 
Train Epoch: 3 [41/500 2624/32000 (8%)] Loss: 2.63240 (QuantReg: 11.54626) QuantErr: 11.54626 batch_time=0.39270 
Train Epoch: 3 [49/500 3136/32000 (10%)] Loss: 2.56952 (QuantReg: 11.43377) QuantErr: 11.43377 batch_time=0.39229 
Train Epoch: 3 [57/500 3648/32000 (11%)] Loss: 2.47020 (QuantReg: 11.44704) QuantErr: 11.44704 batch_time=0.40134 
Train Epoch: 3 [65/500 4160/32000 (13%)] Loss: 2.96780 (QuantReg: 11.89394) QuantErr: 11.89394 batch_time=0.39490 
Train Epoch: 3 [73/500 4672/32000 (15%)] Loss: 2.18685 (QuantReg: 11.45894) QuantErr: 11.45894 batch_time=0.39741 
Train Epoch: 3 [81/500 5184/32000 (16%)] Loss: 2.64047 (QuantReg: 11.64688) QuantErr: 11.64688 batch_time=0.40119 
Train Epoch: 3 [89/500 5696/32000 (18%)] Loss: 2.18978 (QuantReg: 12.06723) QuantErr: 12.06723 batch_time=0.39402 
Train Epoch: 3 [97/500 6208/32000 (19%)] Loss: 2.29623 (QuantReg: 11.67583) QuantErr: 11.67583 batch_time=0.38777 
Train Epoch: 3 [105/500 6720/32000 (21%)] Loss: 2.48309 (QuantReg: 12.28813) QuantErr: 12.28813 batch_time=0.38311 
Train Epoch: 3 [113/500 7232/32000 (23%)] Loss: 1.89286 (QuantReg: 11.92930) QuantErr: 11.92930 batch_time=0.41406 
Train Epoch: 3 [121/500 7744/32000 (24%)] Loss: 2.27024 (QuantReg: 11.66505) QuantErr: 11.66505 batch_time=0.38816 
Train Epoch: 3 [129/500 8256/32000 (26%)] Loss: 2.14224 (QuantReg: 11.98564) QuantErr: 11.98564 batch_time=0.39619 
Train Epoch: 3 [137/500 8768/32000 (27%)] Loss: 2.18910 (QuantReg: 11.80920) QuantErr: 11.80920 batch_time=0.39919 
Train Epoch: 3 [145/500 9280/32000 (29%)] Loss: 2.78102 (QuantReg: 11.94994) QuantErr: 11.94994 batch_time=0.40003 
Train Epoch: 3 [153/500 9792/32000 (31%)] Loss: 2.04750 (QuantReg: 12.11440) QuantErr: 12.11440 batch_time=0.40199 
Train Epoch: 3 [161/500 10304/32000 (32%)] Loss: 2.23332 (QuantReg: 12.06767) QuantErr: 12.06767 batch_time=0.39648 
Train Epoch: 3 [169/500 10816/32000 (34%)] Loss: 2.23798 (QuantReg: 12.16653) QuantErr: 12.16653 batch_time=0.39084 
Train Epoch: 3 [177/500 11328/32000 (35%)] Loss: 1.91046 (QuantReg: 12.14290) QuantErr: 12.14290 batch_time=0.40418 
Train Epoch: 3 [185/500 11840/32000 (37%)] Loss: 2.46068 (QuantReg: 12.12275) QuantErr: 12.12275 batch_time=0.38547 
Train Epoch: 3 [193/500 12352/32000 (39%)] Loss: 2.19139 (QuantReg: 12.85945) QuantErr: 12.85945 batch_time=0.38965 
Train Epoch: 3 [201/500 12864/32000 (40%)] Loss: 2.67873 (QuantReg: 12.10293) QuantErr: 12.10293 batch_time=0.38739 
Train Epoch: 3 [209/500 13376/32000 (42%)] Loss: 1.91280 (QuantReg: 12.68606) QuantErr: 12.68606 batch_time=0.39681 
Train Epoch: 3 [217/500 13888/32000 (43%)] Loss: 2.47704 (QuantReg: 12.53888) QuantErr: 12.53888 batch_time=0.39162 
Train Epoch: 3 [225/500 14400/32000 (45%)] Loss: 2.22522 (QuantReg: 12.03703) QuantErr: 12.03703 batch_time=0.38743 
Train Epoch: 3 [233/500 14912/32000 (47%)] Loss: 1.93388 (QuantReg: 12.49670) QuantErr: 12.49670 batch_time=0.38776 
Train Epoch: 3 [241/500 15424/32000 (48%)] Loss: 2.53157 (QuantReg: 12.48556) QuantErr: 12.48556 batch_time=0.38344 
Train Epoch: 3 [249/500 15936/32000 (50%)] Loss: 1.94907 (QuantReg: 12.45824) QuantErr: 12.45824 batch_time=0.38768 
Train Epoch: 3 [257/500 16448/32000 (51%)] Loss: 2.33750 (QuantReg: 12.39463) QuantErr: 12.39463 batch_time=0.37682 
Train Epoch: 3 [265/500 16960/32000 (53%)] Loss: 2.46366 (QuantReg: 12.62819) QuantErr: 12.62819 batch_time=0.41602 
Train Epoch: 3 [273/500 17472/32000 (55%)] Loss: 2.50957 (QuantReg: 12.25123) QuantErr: 12.25123 batch_time=0.39458 
Train Epoch: 3 [281/500 17984/32000 (56%)] Loss: 2.25424 (QuantReg: 11.99255) QuantErr: 11.99255 batch_time=0.39301 
Train Epoch: 3 [289/500 18496/32000 (58%)] Loss: 1.86128 (QuantReg: 12.63934) QuantErr: 12.63934 batch_time=0.39182 
Train Epoch: 3 [297/500 19008/32000 (59%)] Loss: 2.32604 (QuantReg: 12.77562) QuantErr: 12.77562 batch_time=0.42636 
Train Epoch: 3 [305/500 19520/32000 (61%)] Loss: 2.21253 (QuantReg: 12.29757) QuantErr: 12.29757 batch_time=0.39287 
Train Epoch: 3 [313/500 20032/32000 (63%)] Loss: 1.97456 (QuantReg: 12.35938) QuantErr: 12.35938 batch_time=0.39223 
Train Epoch: 3 [321/500 20544/32000 (64%)] Loss: 2.00990 (QuantReg: 12.60898) QuantErr: 12.60898 batch_time=0.39224 
Train Epoch: 3 [329/500 21056/32000 (66%)] Loss: 2.03271 (QuantReg: 12.98077) QuantErr: 12.98077 batch_time=0.38751 
Train Epoch: 3 [337/500 21568/32000 (67%)] Loss: 2.33176 (QuantReg: 12.61633) QuantErr: 12.61633 batch_time=0.38893 
Train Epoch: 3 [345/500 22080/32000 (69%)] Loss: 2.31252 (QuantReg: 13.10382) QuantErr: 13.10382 batch_time=0.40046 
Train Epoch: 3 [353/500 22592/32000 (71%)] Loss: 1.98488 (QuantReg: 12.52270) QuantErr: 12.52270 batch_time=0.39886 
Train Epoch: 3 [361/500 23104/32000 (72%)] Loss: 2.16462 (QuantReg: 12.74782) QuantErr: 12.74782 batch_time=0.46145 
Train Epoch: 3 [369/500 23616/32000 (74%)] Loss: 2.70604 (QuantReg: 12.10294) QuantErr: 12.10294 batch_time=0.38783 
Train Epoch: 3 [377/500 24128/32000 (75%)] Loss: 2.23372 (QuantReg: 12.45160) QuantErr: 12.45160 batch_time=0.39825 
Train Epoch: 3 [385/500 24640/32000 (77%)] Loss: 1.85210 (QuantReg: 12.60809) QuantErr: 12.60809 batch_time=0.40209 
Train Epoch: 3 [393/500 25152/32000 (79%)] Loss: 2.17962 (QuantReg: 13.38482) QuantErr: 13.38482 batch_time=0.38811 
Train Epoch: 3 [401/500 25664/32000 (80%)] Loss: 2.02209 (QuantReg: 12.79121) QuantErr: 12.79121 batch_time=0.38756 
Train Epoch: 3 [409/500 26176/32000 (82%)] Loss: 1.82478 (QuantReg: 13.14603) QuantErr: 13.14603 batch_time=0.38887 
Train Epoch: 3 [417/500 26688/32000 (83%)] Loss: 2.15508 (QuantReg: 12.86783) QuantErr: 12.86783 batch_time=0.44051 
Train Epoch: 3 [425/500 27200/32000 (85%)] Loss: 2.18833 (QuantReg: 13.08014) QuantErr: 13.08014 batch_time=0.39262 
Train Epoch: 3 [433/500 27712/32000 (87%)] Loss: 2.80134 (QuantReg: 12.37905) QuantErr: 12.37905 batch_time=0.39449 
Train Epoch: 3 [441/500 28224/32000 (88%)] Loss: 2.38591 (QuantReg: 12.65982) QuantErr: 12.65982 batch_time=0.43099 
Train Epoch: 3 [449/500 28736/32000 (90%)] Loss: 1.85486 (QuantReg: 12.88773) QuantErr: 12.88773 batch_time=0.40004 
Train Epoch: 3 [457/500 29248/32000 (91%)] Loss: 1.87030 (QuantReg: 13.22868) QuantErr: 13.22868 batch_time=0.40655 
Train Epoch: 3 [465/500 29760/32000 (93%)] Loss: 2.06836 (QuantReg: 13.11696) QuantErr: 13.11696 batch_time=0.39698 
Train Epoch: 3 [473/500 30272/32000 (95%)] Loss: 1.82063 (QuantReg: 12.76066) QuantErr: 12.76066 batch_time=0.38670 
Train Epoch: 3 [481/500 30784/32000 (96%)] Loss: 1.60773 (QuantReg: 12.78868) QuantErr: 12.78868 batch_time=0.53095 
Train Epoch: 3 [489/500 31296/32000 (98%)] Loss: 3.03546 (QuantReg: 13.08733) QuantErr: 13.08733 batch_time=0.39424 
Train Epoch: 3 [497/500 31808/32000 (99%)] Loss: 1.98842 (QuantReg: 12.86212) QuantErr: 12.86212 batch_time=0.38116 
Train Epoch: 3 codebook_update_time=1.79340
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch3.pth ...
Done in 3.936s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch3.pth ...
Done in 7.646s
removing stale ckpt [epoch 2] [took 0.04s]
 epoch          : 3
 loss           : 2.218185573339462
 quant_reg      : 12.347946405410767
 quant_err      : 12.347946405410767
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.469
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.336879844876535
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.5125
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.17044001421866
 mnt_best       : 33.336879844876535
 not_improved_count: 0
Train Epoch: 4 [1/500 64/32000 (0%)] Loss: 2.65958 (QuantReg: 11.66044) QuantErr: 11.66044 batch_time=17.15469 
Train Epoch: 4 [9/500 576/32000 (2%)] Loss: 1.27732 (QuantReg: 11.60704) QuantErr: 11.60704 batch_time=0.42286 
Train Epoch: 4 [17/500 1088/32000 (3%)] Loss: 1.94137 (QuantReg: 11.72709) QuantErr: 11.72709 batch_time=0.38883 
Train Epoch: 4 [25/500 1600/32000 (5%)] Loss: 2.26076 (QuantReg: 11.80330) QuantErr: 11.80330 batch_time=0.42081 
Train Epoch: 4 [33/500 2112/32000 (7%)] Loss: 2.28611 (QuantReg: 11.65627) QuantErr: 11.65627 batch_time=0.38897 
Train Epoch: 4 [41/500 2624/32000 (8%)] Loss: 2.18525 (QuantReg: 12.12088) QuantErr: 12.12088 batch_time=0.41717 
Train Epoch: 4 [49/500 3136/32000 (10%)] Loss: 1.97816 (QuantReg: 11.70557) QuantErr: 11.70557 batch_time=0.39011 
Train Epoch: 4 [57/500 3648/32000 (11%)] Loss: 2.46010 (QuantReg: 11.90413) QuantErr: 11.90413 batch_time=0.45708 
Train Epoch: 4 [65/500 4160/32000 (13%)] Loss: 1.69951 (QuantReg: 12.15346) QuantErr: 12.15346 batch_time=0.39222 
Train Epoch: 4 [73/500 4672/32000 (15%)] Loss: 1.26014 (QuantReg: 12.56578) QuantErr: 12.56578 batch_time=0.39166 
Train Epoch: 4 [81/500 5184/32000 (16%)] Loss: 1.94529 (QuantReg: 12.27109) QuantErr: 12.27109 batch_time=0.43972 
Train Epoch: 4 [89/500 5696/32000 (18%)] Loss: 1.99649 (QuantReg: 12.28611) QuantErr: 12.28611 batch_time=0.41639 
Train Epoch: 4 [97/500 6208/32000 (19%)] Loss: 1.86212 (QuantReg: 12.07768) QuantErr: 12.07768 batch_time=0.39699 
Train Epoch: 4 [105/500 6720/32000 (21%)] Loss: 1.40626 (QuantReg: 11.83904) QuantErr: 11.83904 batch_time=0.39454 
Train Epoch: 4 [113/500 7232/32000 (23%)] Loss: 2.18242 (QuantReg: 12.12382) QuantErr: 12.12382 batch_time=0.39799 
Train Epoch: 4 [121/500 7744/32000 (24%)] Loss: 2.38294 (QuantReg: 12.46361) QuantErr: 12.46361 batch_time=0.39808 
Train Epoch: 4 [129/500 8256/32000 (26%)] Loss: 2.07724 (QuantReg: 12.18068) QuantErr: 12.18068 batch_time=0.39609 
Train Epoch: 4 [137/500 8768/32000 (27%)] Loss: 1.73774 (QuantReg: 12.27234) QuantErr: 12.27234 batch_time=0.39152 
Train Epoch: 4 [145/500 9280/32000 (29%)] Loss: 2.20963 (QuantReg: 12.45326) QuantErr: 12.45326 batch_time=0.39131 
Train Epoch: 4 [153/500 9792/32000 (31%)] Loss: 2.04822 (QuantReg: 11.67189) QuantErr: 11.67189 batch_time=0.38791 
Train Epoch: 4 [161/500 10304/32000 (32%)] Loss: 2.08082 (QuantReg: 11.67893) QuantErr: 11.67893 batch_time=0.39178 
Train Epoch: 4 [169/500 10816/32000 (34%)] Loss: 2.15586 (QuantReg: 12.13877) QuantErr: 12.13877 batch_time=0.40900 
Train Epoch: 4 [177/500 11328/32000 (35%)] Loss: 2.21005 (QuantReg: 11.92683) QuantErr: 11.92683 batch_time=0.39697 
Train Epoch: 4 [185/500 11840/32000 (37%)] Loss: 2.99855 (QuantReg: 11.90897) QuantErr: 11.90897 batch_time=0.38763 
Train Epoch: 4 [193/500 12352/32000 (39%)] Loss: 2.20298 (QuantReg: 12.05097) QuantErr: 12.05097 batch_time=0.40964 
Train Epoch: 4 [201/500 12864/32000 (40%)] Loss: 2.31996 (QuantReg: 12.07165) QuantErr: 12.07165 batch_time=0.38951 
Train Epoch: 4 [209/500 13376/32000 (42%)] Loss: 2.34675 (QuantReg: 11.92373) QuantErr: 11.92373 batch_time=0.39299 
Train Epoch: 4 [217/500 13888/32000 (43%)] Loss: 1.50377 (QuantReg: 11.84177) QuantErr: 11.84177 batch_time=0.39573 
Train Epoch: 4 [225/500 14400/32000 (45%)] Loss: 2.26900 (QuantReg: 12.08553) QuantErr: 12.08553 batch_time=0.38783 
Train Epoch: 4 [233/500 14912/32000 (47%)] Loss: 1.83625 (QuantReg: 11.75072) QuantErr: 11.75072 batch_time=0.38815 
Train Epoch: 4 [241/500 15424/32000 (48%)] Loss: 2.15387 (QuantReg: 12.13605) QuantErr: 12.13605 batch_time=0.41074 
Train Epoch: 4 [249/500 15936/32000 (50%)] Loss: 2.24192 (QuantReg: 12.41631) QuantErr: 12.41631 batch_time=0.40655 
Train Epoch: 4 [257/500 16448/32000 (51%)] Loss: 1.76788 (QuantReg: 12.20451) QuantErr: 12.20451 batch_time=0.42076 
Train Epoch: 4 [265/500 16960/32000 (53%)] Loss: 1.87224 (QuantReg: 11.97675) QuantErr: 11.97675 batch_time=0.39341 
Train Epoch: 4 [273/500 17472/32000 (55%)] Loss: 1.93500 (QuantReg: 12.43371) QuantErr: 12.43371 batch_time=0.38172 
Train Epoch: 4 [281/500 17984/32000 (56%)] Loss: 1.68349 (QuantReg: 12.41338) QuantErr: 12.41338 batch_time=0.38094 
Train Epoch: 4 [289/500 18496/32000 (58%)] Loss: 1.67667 (QuantReg: 12.30222) QuantErr: 12.30222 batch_time=0.38691 
Train Epoch: 4 [297/500 19008/32000 (59%)] Loss: 1.82507 (QuantReg: 12.28812) QuantErr: 12.28812 batch_time=0.39087 
Train Epoch: 4 [305/500 19520/32000 (61%)] Loss: 2.59729 (QuantReg: 12.11448) QuantErr: 12.11448 batch_time=0.41520 
Train Epoch: 4 [313/500 20032/32000 (63%)] Loss: 1.54347 (QuantReg: 12.31537) QuantErr: 12.31537 batch_time=0.43743 
Train Epoch: 4 [321/500 20544/32000 (64%)] Loss: 1.71076 (QuantReg: 12.11332) QuantErr: 12.11332 batch_time=0.39475 
Train Epoch: 4 [329/500 21056/32000 (66%)] Loss: 1.41449 (QuantReg: 12.57907) QuantErr: 12.57907 batch_time=0.38947 
Train Epoch: 4 [337/500 21568/32000 (67%)] Loss: 2.22226 (QuantReg: 12.58026) QuantErr: 12.58026 batch_time=0.40268 
Train Epoch: 4 [345/500 22080/32000 (69%)] Loss: 1.61972 (QuantReg: 12.87900) QuantErr: 12.87900 batch_time=0.40123 
Train Epoch: 4 [353/500 22592/32000 (71%)] Loss: 1.92744 (QuantReg: 12.28973) QuantErr: 12.28973 batch_time=0.39495 
Train Epoch: 4 [361/500 23104/32000 (72%)] Loss: 1.89362 (QuantReg: 11.97363) QuantErr: 11.97363 batch_time=0.39469 
Train Epoch: 4 [369/500 23616/32000 (74%)] Loss: 1.80776 (QuantReg: 12.63929) QuantErr: 12.63929 batch_time=0.40677 
Train Epoch: 4 [377/500 24128/32000 (75%)] Loss: 1.98841 (QuantReg: 12.62455) QuantErr: 12.62455 batch_time=0.40115 
Train Epoch: 4 [385/500 24640/32000 (77%)] Loss: 2.18255 (QuantReg: 12.13752) QuantErr: 12.13752 batch_time=0.39469 
Train Epoch: 4 [393/500 25152/32000 (79%)] Loss: 2.06225 (QuantReg: 12.68102) QuantErr: 12.68102 batch_time=0.38649 
Train Epoch: 4 [401/500 25664/32000 (80%)] Loss: 2.24087 (QuantReg: 12.28492) QuantErr: 12.28492 batch_time=0.38634 
Train Epoch: 4 [409/500 26176/32000 (82%)] Loss: 1.66890 (QuantReg: 12.30773) QuantErr: 12.30773 batch_time=0.39236 
Train Epoch: 4 [417/500 26688/32000 (83%)] Loss: 1.67920 (QuantReg: 12.77246) QuantErr: 12.77246 batch_time=0.39706 
Train Epoch: 4 [425/500 27200/32000 (85%)] Loss: 1.85364 (QuantReg: 12.73693) QuantErr: 12.73693 batch_time=0.38876 
Train Epoch: 4 [433/500 27712/32000 (87%)] Loss: 2.09155 (QuantReg: 12.68241) QuantErr: 12.68241 batch_time=0.71234 
Train Epoch: 4 [441/500 28224/32000 (88%)] Loss: 2.44958 (QuantReg: 12.66527) QuantErr: 12.66527 batch_time=0.38763 
Train Epoch: 4 [449/500 28736/32000 (90%)] Loss: 1.64286 (QuantReg: 12.69690) QuantErr: 12.69690 batch_time=0.40984 
Train Epoch: 4 [457/500 29248/32000 (91%)] Loss: 1.91294 (QuantReg: 12.36266) QuantErr: 12.36266 batch_time=0.39466 
Train Epoch: 4 [465/500 29760/32000 (93%)] Loss: 2.34686 (QuantReg: 12.85605) QuantErr: 12.85605 batch_time=0.39897 
Train Epoch: 4 [473/500 30272/32000 (95%)] Loss: 1.58185 (QuantReg: 12.92751) QuantErr: 12.92751 batch_time=0.39618 
Train Epoch: 4 [481/500 30784/32000 (96%)] Loss: 2.09248 (QuantReg: 12.86954) QuantErr: 12.86954 batch_time=0.41703 
Train Epoch: 4 [489/500 31296/32000 (98%)] Loss: 1.42793 (QuantReg: 12.64288) QuantErr: 12.64288 batch_time=0.39496 
Train Epoch: 4 [497/500 31808/32000 (99%)] Loss: 1.71238 (QuantReg: 12.75778) QuantErr: 12.75778 batch_time=0.39838 
Train Epoch: 4 codebook_update_time=1.77082
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch4.pth ...
Done in 20.369s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch4.pth ...
Done in 24.049s
removing stale ckpt [epoch 3] [took 0.02s]
 epoch          : 4
 loss           : 1.9638446147441864
 quant_reg      : 12.280205457687378
 quant_err      : 12.280205457687378
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.283
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.12588025655842
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.803
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.262127711713795
 mnt_best       : 34.12588025655842
 not_improved_count: 0
Train Epoch: 5 [1/500 64/32000 (0%)] Loss: 2.09283 (QuantReg: 11.43460) QuantErr: 11.43460 batch_time=17.49794 
Train Epoch: 5 [9/500 576/32000 (2%)] Loss: 2.68232 (QuantReg: 11.55963) QuantErr: 11.55963 batch_time=0.38511 
Train Epoch: 5 [17/500 1088/32000 (3%)] Loss: 2.16102 (QuantReg: 11.41272) QuantErr: 11.41272 batch_time=0.40568 
Train Epoch: 5 [25/500 1600/32000 (5%)] Loss: 1.46024 (QuantReg: 11.67547) QuantErr: 11.67547 batch_time=0.38334 
Train Epoch: 5 [33/500 2112/32000 (7%)] Loss: 2.02078 (QuantReg: 11.81323) QuantErr: 11.81323 batch_time=0.38503 
Train Epoch: 5 [41/500 2624/32000 (8%)] Loss: 2.45792 (QuantReg: 12.27644) QuantErr: 12.27644 batch_time=0.57072 
Train Epoch: 5 [49/500 3136/32000 (10%)] Loss: 1.92939 (QuantReg: 12.12812) QuantErr: 12.12812 batch_time=0.40416 
Train Epoch: 5 [57/500 3648/32000 (11%)] Loss: 1.99413 (QuantReg: 11.89506) QuantErr: 11.89506 batch_time=0.38875 
Train Epoch: 5 [65/500 4160/32000 (13%)] Loss: 2.24660 (QuantReg: 11.89293) QuantErr: 11.89293 batch_time=0.39394 
Train Epoch: 5 [73/500 4672/32000 (15%)] Loss: 1.90551 (QuantReg: 12.18754) QuantErr: 12.18754 batch_time=0.39695 
Train Epoch: 5 [81/500 5184/32000 (16%)] Loss: 2.02547 (QuantReg: 11.75890) QuantErr: 11.75890 batch_time=0.39441 
Train Epoch: 5 [89/500 5696/32000 (18%)] Loss: 2.19014 (QuantReg: 11.54982) QuantErr: 11.54982 batch_time=0.43509 
Train Epoch: 5 [97/500 6208/32000 (19%)] Loss: 2.07452 (QuantReg: 11.80665) QuantErr: 11.80665 batch_time=0.43439 
Train Epoch: 5 [105/500 6720/32000 (21%)] Loss: 2.21090 (QuantReg: 12.01538) QuantErr: 12.01538 batch_time=0.50993 
Train Epoch: 5 [113/500 7232/32000 (23%)] Loss: 1.50722 (QuantReg: 11.97296) QuantErr: 11.97296 batch_time=0.41283 
Train Epoch: 5 [121/500 7744/32000 (24%)] Loss: 1.63929 (QuantReg: 12.11858) QuantErr: 12.11858 batch_time=0.42001 
Train Epoch: 5 [129/500 8256/32000 (26%)] Loss: 1.99086 (QuantReg: 12.23107) QuantErr: 12.23107 batch_time=0.45953 
Train Epoch: 5 [137/500 8768/32000 (27%)] Loss: 1.76127 (QuantReg: 12.06500) QuantErr: 12.06500 batch_time=0.39824 
Train Epoch: 5 [145/500 9280/32000 (29%)] Loss: 1.75368 (QuantReg: 12.11875) QuantErr: 12.11875 batch_time=0.41102 
Train Epoch: 5 [153/500 9792/32000 (31%)] Loss: 1.61636 (QuantReg: 12.47781) QuantErr: 12.47781 batch_time=0.38600 
Train Epoch: 5 [161/500 10304/32000 (32%)] Loss: 1.71456 (QuantReg: 12.43005) QuantErr: 12.43005 batch_time=0.43217 
Train Epoch: 5 [169/500 10816/32000 (34%)] Loss: 1.80098 (QuantReg: 12.12861) QuantErr: 12.12861 batch_time=0.49853 
Train Epoch: 5 [177/500 11328/32000 (35%)] Loss: 1.55229 (QuantReg: 12.56070) QuantErr: 12.56070 batch_time=0.39884 
Train Epoch: 5 [185/500 11840/32000 (37%)] Loss: 2.06403 (QuantReg: 12.44549) QuantErr: 12.44549 batch_time=0.38603 
Train Epoch: 5 [193/500 12352/32000 (39%)] Loss: 1.65255 (QuantReg: 12.15595) QuantErr: 12.15595 batch_time=0.39310 
Train Epoch: 5 [201/500 12864/32000 (40%)] Loss: 2.05796 (QuantReg: 12.13556) QuantErr: 12.13556 batch_time=0.39499 
Train Epoch: 5 [209/500 13376/32000 (42%)] Loss: 1.75415 (QuantReg: 12.35286) QuantErr: 12.35286 batch_time=0.39049 
Train Epoch: 5 [217/500 13888/32000 (43%)] Loss: 1.60993 (QuantReg: 12.28843) QuantErr: 12.28843 batch_time=0.39273 
Train Epoch: 5 [225/500 14400/32000 (45%)] Loss: 1.80466 (QuantReg: 12.43720) QuantErr: 12.43720 batch_time=0.45033 
Train Epoch: 5 [233/500 14912/32000 (47%)] Loss: 1.74580 (QuantReg: 12.53188) QuantErr: 12.53188 batch_time=0.49024 
Train Epoch: 5 [241/500 15424/32000 (48%)] Loss: 1.74060 (QuantReg: 12.30914) QuantErr: 12.30914 batch_time=0.37847 
Train Epoch: 5 [249/500 15936/32000 (50%)] Loss: 1.77846 (QuantReg: 12.86011) QuantErr: 12.86011 batch_time=0.39018 
Train Epoch: 5 [257/500 16448/32000 (51%)] Loss: 2.14054 (QuantReg: 12.53497) QuantErr: 12.53497 batch_time=0.39200 
Train Epoch: 5 [265/500 16960/32000 (53%)] Loss: 2.09205 (QuantReg: 12.75517) QuantErr: 12.75517 batch_time=0.38794 
Train Epoch: 5 [273/500 17472/32000 (55%)] Loss: 1.14447 (QuantReg: 12.22155) QuantErr: 12.22155 batch_time=0.39059 
Train Epoch: 5 [281/500 17984/32000 (56%)] Loss: 2.24775 (QuantReg: 12.28502) QuantErr: 12.28502 batch_time=0.38036 
Train Epoch: 5 [289/500 18496/32000 (58%)] Loss: 2.47481 (QuantReg: 12.59245) QuantErr: 12.59245 batch_time=0.51804 
Train Epoch: 5 [297/500 19008/32000 (59%)] Loss: 1.23164 (QuantReg: 12.90435) QuantErr: 12.90435 batch_time=0.50087 
Train Epoch: 5 [305/500 19520/32000 (61%)] Loss: 1.31532 (QuantReg: 12.64684) QuantErr: 12.64684 batch_time=0.39493 
Train Epoch: 5 [313/500 20032/32000 (63%)] Loss: 1.72958 (QuantReg: 12.07564) QuantErr: 12.07564 batch_time=0.39628 
Train Epoch: 5 [321/500 20544/32000 (64%)] Loss: 1.56038 (QuantReg: 12.60845) QuantErr: 12.60845 batch_time=0.39795 
Train Epoch: 5 [329/500 21056/32000 (66%)] Loss: 2.09696 (QuantReg: 12.53109) QuantErr: 12.53109 batch_time=0.38453 
Train Epoch: 5 [337/500 21568/32000 (67%)] Loss: 2.06931 (QuantReg: 12.32182) QuantErr: 12.32182 batch_time=0.39029 
Train Epoch: 5 [345/500 22080/32000 (69%)] Loss: 2.14520 (QuantReg: 12.59765) QuantErr: 12.59765 batch_time=0.39910 
Train Epoch: 5 [353/500 22592/32000 (71%)] Loss: 1.80188 (QuantReg: 12.23917) QuantErr: 12.23917 batch_time=0.39855 
Train Epoch: 5 [361/500 23104/32000 (72%)] Loss: 1.70227 (QuantReg: 12.27056) QuantErr: 12.27056 batch_time=0.51502 
Train Epoch: 5 [369/500 23616/32000 (74%)] Loss: 2.13886 (QuantReg: 12.47216) QuantErr: 12.47216 batch_time=0.40481 
Train Epoch: 5 [377/500 24128/32000 (75%)] Loss: 1.75067 (QuantReg: 12.56833) QuantErr: 12.56833 batch_time=0.40080 
Train Epoch: 5 [385/500 24640/32000 (77%)] Loss: 2.15460 (QuantReg: 12.04207) QuantErr: 12.04207 batch_time=0.39257 
Train Epoch: 5 [393/500 25152/32000 (79%)] Loss: 1.60546 (QuantReg: 12.73046) QuantErr: 12.73046 batch_time=0.38631 
Train Epoch: 5 [401/500 25664/32000 (80%)] Loss: 1.16978 (QuantReg: 12.73383) QuantErr: 12.73383 batch_time=0.39045 
Train Epoch: 5 [409/500 26176/32000 (82%)] Loss: 1.49889 (QuantReg: 12.75822) QuantErr: 12.75822 batch_time=0.39450 
Train Epoch: 5 [417/500 26688/32000 (83%)] Loss: 1.76299 (QuantReg: 12.58125) QuantErr: 12.58125 batch_time=0.38425 
Train Epoch: 5 [425/500 27200/32000 (85%)] Loss: 1.62904 (QuantReg: 12.37911) QuantErr: 12.37911 batch_time=0.50784 
Train Epoch: 5 [433/500 27712/32000 (87%)] Loss: 1.97494 (QuantReg: 12.44461) QuantErr: 12.44461 batch_time=0.39417 
Train Epoch: 5 [441/500 28224/32000 (88%)] Loss: 2.20145 (QuantReg: 12.53308) QuantErr: 12.53308 batch_time=0.41324 
Train Epoch: 5 [449/500 28736/32000 (90%)] Loss: 1.52158 (QuantReg: 12.83965) QuantErr: 12.83965 batch_time=0.39691 
Train Epoch: 5 [457/500 29248/32000 (91%)] Loss: 1.60203 (QuantReg: 12.65594) QuantErr: 12.65594 batch_time=0.40077 
Train Epoch: 5 [465/500 29760/32000 (93%)] Loss: 1.90956 (QuantReg: 12.78954) QuantErr: 12.78954 batch_time=0.40687 
Train Epoch: 5 [473/500 30272/32000 (95%)] Loss: 1.45293 (QuantReg: 12.51598) QuantErr: 12.51598 batch_time=0.41063 
Train Epoch: 5 [481/500 30784/32000 (96%)] Loss: 2.08172 (QuantReg: 12.37862) QuantErr: 12.37862 batch_time=0.42877 
Train Epoch: 5 [489/500 31296/32000 (98%)] Loss: 1.39011 (QuantReg: 12.97742) QuantErr: 12.97742 batch_time=0.53310 
Train Epoch: 5 [497/500 31808/32000 (99%)] Loss: 1.67952 (QuantReg: 12.64383) QuantErr: 12.64383 batch_time=0.49744 
Train Epoch: 5 codebook_update_time=1.66293
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch5.pth ...
Done in 3.749s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch5.pth ...
Done in 7.487s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 1.7595801063776015
 quant_reg      : 12.30203327178955
 quant_err      : 12.30203327178955
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.088
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.842418224108826
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.246
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.5100571543746
 mnt_best       : 35.842418224108826
 not_improved_count: 0
Train Epoch: 6 [1/500 64/32000 (0%)] Loss: 1.90391 (QuantReg: 11.94095) QuantErr: 11.94095 batch_time=17.67860 
Train Epoch: 6 [9/500 576/32000 (2%)] Loss: 1.54514 (QuantReg: 12.14671) QuantErr: 12.14671 batch_time=0.39911 
Train Epoch: 6 [17/500 1088/32000 (3%)] Loss: 2.28117 (QuantReg: 12.29377) QuantErr: 12.29377 batch_time=0.37879 
Train Epoch: 6 [25/500 1600/32000 (5%)] Loss: 1.75065 (QuantReg: 11.65415) QuantErr: 11.65415 batch_time=0.69997 
Train Epoch: 6 [33/500 2112/32000 (7%)] Loss: 1.62443 (QuantReg: 11.62109) QuantErr: 11.62109 batch_time=0.42547 
Train Epoch: 6 [41/500 2624/32000 (8%)] Loss: 1.17833 (QuantReg: 11.63527) QuantErr: 11.63527 batch_time=0.40393 
Train Epoch: 6 [49/500 3136/32000 (10%)] Loss: 1.81712 (QuantReg: 11.58916) QuantErr: 11.58916 batch_time=0.38385 
Train Epoch: 6 [57/500 3648/32000 (11%)] Loss: 2.00544 (QuantReg: 12.13044) QuantErr: 12.13044 batch_time=0.44280 
Train Epoch: 6 [65/500 4160/32000 (13%)] Loss: 1.85696 (QuantReg: 12.32132) QuantErr: 12.32132 batch_time=0.86413 
Train Epoch: 6 [73/500 4672/32000 (15%)] Loss: 1.99894 (QuantReg: 12.26821) QuantErr: 12.26821 batch_time=0.37906 
Train Epoch: 6 [81/500 5184/32000 (16%)] Loss: 1.44814 (QuantReg: 12.09482) QuantErr: 12.09482 batch_time=0.38856 
Train Epoch: 6 [89/500 5696/32000 (18%)] Loss: 1.67972 (QuantReg: 11.79106) QuantErr: 11.79106 batch_time=0.70708 
Train Epoch: 6 [97/500 6208/32000 (19%)] Loss: 1.89028 (QuantReg: 11.59347) QuantErr: 11.59347 batch_time=0.38498 
Train Epoch: 6 [105/500 6720/32000 (21%)] Loss: 2.13066 (QuantReg: 12.38327) QuantErr: 12.38327 batch_time=0.40023 
Train Epoch: 6 [113/500 7232/32000 (23%)] Loss: 1.80187 (QuantReg: 11.93601) QuantErr: 11.93601 batch_time=0.38611 
Train Epoch: 6 [121/500 7744/32000 (24%)] Loss: 1.81788 (QuantReg: 12.27907) QuantErr: 12.27907 batch_time=0.44101 
Train Epoch: 6 [129/500 8256/32000 (26%)] Loss: 1.80339 (QuantReg: 12.37981) QuantErr: 12.37981 batch_time=0.87503 
Train Epoch: 6 [137/500 8768/32000 (27%)] Loss: 1.60496 (QuantReg: 12.43741) QuantErr: 12.43741 batch_time=0.39542 
Train Epoch: 6 [145/500 9280/32000 (29%)] Loss: 2.27130 (QuantReg: 12.72842) QuantErr: 12.72842 batch_time=0.39034 
Train Epoch: 6 [153/500 9792/32000 (31%)] Loss: 1.69220 (QuantReg: 12.52103) QuantErr: 12.52103 batch_time=0.70543 
Train Epoch: 6 [161/500 10304/32000 (32%)] Loss: 1.32175 (QuantReg: 12.38202) QuantErr: 12.38202 batch_time=0.38037 
Train Epoch: 6 [169/500 10816/32000 (34%)] Loss: 1.35649 (QuantReg: 12.93257) QuantErr: 12.93257 batch_time=0.39102 
Train Epoch: 6 [177/500 11328/32000 (35%)] Loss: 1.64072 (QuantReg: 12.86839) QuantErr: 12.86839 batch_time=0.39667 
Train Epoch: 6 [185/500 11840/32000 (37%)] Loss: 1.67441 (QuantReg: 12.92309) QuantErr: 12.92309 batch_time=0.43706 
Train Epoch: 6 [193/500 12352/32000 (39%)] Loss: 1.17780 (QuantReg: 12.32174) QuantErr: 12.32174 batch_time=0.86419 
Train Epoch: 6 [201/500 12864/32000 (40%)] Loss: 1.67322 (QuantReg: 12.51669) QuantErr: 12.51669 batch_time=0.38132 
Train Epoch: 6 [209/500 13376/32000 (42%)] Loss: 1.99239 (QuantReg: 12.88783) QuantErr: 12.88783 batch_time=0.38156 
Train Epoch: 6 [217/500 13888/32000 (43%)] Loss: 2.29074 (QuantReg: 11.81640) QuantErr: 11.81640 batch_time=0.77527 
Train Epoch: 6 [225/500 14400/32000 (45%)] Loss: 1.82043 (QuantReg: 12.31451) QuantErr: 12.31451 batch_time=0.38955 
Train Epoch: 6 [233/500 14912/32000 (47%)] Loss: 1.77100 (QuantReg: 12.41087) QuantErr: 12.41087 batch_time=0.39116 
Train Epoch: 6 [241/500 15424/32000 (48%)] Loss: 1.18018 (QuantReg: 12.32046) QuantErr: 12.32046 batch_time=0.39447 
Train Epoch: 6 [249/500 15936/32000 (50%)] Loss: 1.76579 (QuantReg: 12.42726) QuantErr: 12.42726 batch_time=0.46044 
Train Epoch: 6 [257/500 16448/32000 (51%)] Loss: 1.12335 (QuantReg: 12.57835) QuantErr: 12.57835 batch_time=0.93679 
Train Epoch: 6 [265/500 16960/32000 (53%)] Loss: 1.26397 (QuantReg: 12.10742) QuantErr: 12.10742 batch_time=0.39214 
Train Epoch: 6 [273/500 17472/32000 (55%)] Loss: 1.77880 (QuantReg: 12.13589) QuantErr: 12.13589 batch_time=0.39568 
Train Epoch: 6 [281/500 17984/32000 (56%)] Loss: 1.43823 (QuantReg: 12.78405) QuantErr: 12.78405 batch_time=0.75380 
Train Epoch: 6 [289/500 18496/32000 (58%)] Loss: 1.14571 (QuantReg: 12.34823) QuantErr: 12.34823 batch_time=0.38483 
Train Epoch: 6 [297/500 19008/32000 (59%)] Loss: 1.32704 (QuantReg: 12.11411) QuantErr: 12.11411 batch_time=0.38594 
Train Epoch: 6 [305/500 19520/32000 (61%)] Loss: 1.87099 (QuantReg: 12.73763) QuantErr: 12.73763 batch_time=0.38555 
Train Epoch: 6 [313/500 20032/32000 (63%)] Loss: 1.72255 (QuantReg: 12.33585) QuantErr: 12.33585 batch_time=0.88339 
Train Epoch: 6 [321/500 20544/32000 (64%)] Loss: 1.47350 (QuantReg: 12.38504) QuantErr: 12.38504 batch_time=0.89562 
Train Epoch: 6 [329/500 21056/32000 (66%)] Loss: 1.66410 (QuantReg: 12.42916) QuantErr: 12.42916 batch_time=0.37493 
Train Epoch: 6 [337/500 21568/32000 (67%)] Loss: 1.27679 (QuantReg: 12.33350) QuantErr: 12.33350 batch_time=0.39481 
Train Epoch: 6 [345/500 22080/32000 (69%)] Loss: 1.78962 (QuantReg: 12.58657) QuantErr: 12.58657 batch_time=0.72186 
Train Epoch: 6 [353/500 22592/32000 (71%)] Loss: 1.58077 (QuantReg: 12.46031) QuantErr: 12.46031 batch_time=0.39747 
Train Epoch: 6 [361/500 23104/32000 (72%)] Loss: 1.81734 (QuantReg: 12.57031) QuantErr: 12.57031 batch_time=0.38409 
Train Epoch: 6 [369/500 23616/32000 (74%)] Loss: 1.38330 (QuantReg: 12.31428) QuantErr: 12.31428 batch_time=0.39617 
Train Epoch: 6 [377/500 24128/32000 (75%)] Loss: 1.96060 (QuantReg: 12.41982) QuantErr: 12.41982 batch_time=0.46000 
Train Epoch: 6 [385/500 24640/32000 (77%)] Loss: 1.19654 (QuantReg: 12.61383) QuantErr: 12.61383 batch_time=0.94877 
Train Epoch: 6 [393/500 25152/32000 (79%)] Loss: 2.02921 (QuantReg: 12.45117) QuantErr: 12.45117 batch_time=0.41092 
Train Epoch: 6 [401/500 25664/32000 (80%)] Loss: 1.19058 (QuantReg: 13.03049) QuantErr: 13.03049 batch_time=0.38433 
Train Epoch: 6 [409/500 26176/32000 (82%)] Loss: 1.77809 (QuantReg: 12.34816) QuantErr: 12.34816 batch_time=0.75282 
Train Epoch: 6 [417/500 26688/32000 (83%)] Loss: 1.15095 (QuantReg: 13.06307) QuantErr: 13.06307 batch_time=0.38221 
Train Epoch: 6 [425/500 27200/32000 (85%)] Loss: 1.97394 (QuantReg: 12.57477) QuantErr: 12.57477 batch_time=0.39182 
Train Epoch: 6 [433/500 27712/32000 (87%)] Loss: 1.36473 (QuantReg: 12.62806) QuantErr: 12.62806 batch_time=0.38378 
Train Epoch: 6 [441/500 28224/32000 (88%)] Loss: 1.78527 (QuantReg: 12.58648) QuantErr: 12.58648 batch_time=0.44719 
Train Epoch: 6 [449/500 28736/32000 (90%)] Loss: 1.23412 (QuantReg: 12.84067) QuantErr: 12.84067 batch_time=0.94461 
Train Epoch: 6 [457/500 29248/32000 (91%)] Loss: 1.41695 (QuantReg: 12.43817) QuantErr: 12.43817 batch_time=0.39125 
Train Epoch: 6 [465/500 29760/32000 (93%)] Loss: 1.30175 (QuantReg: 12.47916) QuantErr: 12.47916 batch_time=0.37778 
Train Epoch: 6 [473/500 30272/32000 (95%)] Loss: 1.82651 (QuantReg: 12.54855) QuantErr: 12.54855 batch_time=0.73849 
Train Epoch: 6 [481/500 30784/32000 (96%)] Loss: 1.51890 (QuantReg: 12.79037) QuantErr: 12.79037 batch_time=0.38215 
Train Epoch: 6 [489/500 31296/32000 (98%)] Loss: 1.74287 (QuantReg: 12.57113) QuantErr: 12.57113 batch_time=0.41457 
Train Epoch: 6 [497/500 31808/32000 (99%)] Loss: 1.48715 (QuantReg: 12.68404) QuantErr: 12.68404 batch_time=0.38468 
Train Epoch: 6 codebook_update_time=2.04159
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch6.pth ...
Done in 3.853s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch6.pth ...
Done in 7.842s
removing stale ckpt [epoch 5] [took 0.03s]
 epoch          : 6
 loss           : 1.6083833993673324
 quant_reg      : 12.38238554573059
 quant_err      : 12.38238554573059
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.325
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.08405052500629
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.878
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.85469904379261
 mnt_best       : 36.08405052500629
 not_improved_count: 0
Train Epoch: 7 [1/500 64/32000 (0%)] Loss: 1.57391 (QuantReg: 11.52560) QuantErr: 11.52560 batch_time=17.44629 
Train Epoch: 7 [9/500 576/32000 (2%)] Loss: 1.43025 (QuantReg: 11.93150) QuantErr: 11.93150 batch_time=0.45227 
Train Epoch: 7 [17/500 1088/32000 (3%)] Loss: 1.99759 (QuantReg: 12.15316) QuantErr: 12.15316 batch_time=1.15627 
Train Epoch: 7 [25/500 1600/32000 (5%)] Loss: 1.99372 (QuantReg: 11.77746) QuantErr: 11.77746 batch_time=0.39759 
Train Epoch: 7 [33/500 2112/32000 (7%)] Loss: 1.35430 (QuantReg: 12.20814) QuantErr: 12.20814 batch_time=0.39843 
Train Epoch: 7 [41/500 2624/32000 (8%)] Loss: 1.40931 (QuantReg: 11.83734) QuantErr: 11.83734 batch_time=0.39612 
Train Epoch: 7 [49/500 3136/32000 (10%)] Loss: 2.00513 (QuantReg: 12.05783) QuantErr: 12.05783 batch_time=0.42866 
Train Epoch: 7 [57/500 3648/32000 (11%)] Loss: 1.84390 (QuantReg: 11.90660) QuantErr: 11.90660 batch_time=0.38970 
Train Epoch: 7 [65/500 4160/32000 (13%)] Loss: 1.25251 (QuantReg: 12.28854) QuantErr: 12.28854 batch_time=0.38784 
Train Epoch: 7 [73/500 4672/32000 (15%)] Loss: 1.45810 (QuantReg: 12.24385) QuantErr: 12.24385 batch_time=0.38605 
Train Epoch: 7 [81/500 5184/32000 (16%)] Loss: 0.99568 (QuantReg: 12.21873) QuantErr: 12.21873 batch_time=1.13204 
Train Epoch: 7 [89/500 5696/32000 (18%)] Loss: 1.29518 (QuantReg: 11.67810) QuantErr: 11.67810 batch_time=0.38432 
Train Epoch: 7 [97/500 6208/32000 (19%)] Loss: 1.66920 (QuantReg: 12.52048) QuantErr: 12.52048 batch_time=0.38090 
Train Epoch: 7 [105/500 6720/32000 (21%)] Loss: 1.40191 (QuantReg: 12.27122) QuantErr: 12.27122 batch_time=0.38068 
Train Epoch: 7 [113/500 7232/32000 (23%)] Loss: 1.18725 (QuantReg: 12.41704) QuantErr: 12.41704 batch_time=0.38719 
Train Epoch: 7 [121/500 7744/32000 (24%)] Loss: 1.70972 (QuantReg: 12.45685) QuantErr: 12.45685 batch_time=0.39606 
Train Epoch: 7 [129/500 8256/32000 (26%)] Loss: 1.90720 (QuantReg: 12.13695) QuantErr: 12.13695 batch_time=0.40376 
Train Epoch: 7 [137/500 8768/32000 (27%)] Loss: 1.29969 (QuantReg: 12.82502) QuantErr: 12.82502 batch_time=0.46553 
Train Epoch: 7 [145/500 9280/32000 (29%)] Loss: 1.64236 (QuantReg: 12.16683) QuantErr: 12.16683 batch_time=1.12541 
Train Epoch: 7 [153/500 9792/32000 (31%)] Loss: 1.33119 (QuantReg: 12.49818) QuantErr: 12.49818 batch_time=0.38684 
Train Epoch: 7 [161/500 10304/32000 (32%)] Loss: 1.24276 (QuantReg: 12.74734) QuantErr: 12.74734 batch_time=0.38557 
Train Epoch: 7 [169/500 10816/32000 (34%)] Loss: 1.60522 (QuantReg: 12.73194) QuantErr: 12.73194 batch_time=0.41547 
Train Epoch: 7 [177/500 11328/32000 (35%)] Loss: 1.62509 (QuantReg: 12.11903) QuantErr: 12.11903 batch_time=0.38980 
Train Epoch: 7 [185/500 11840/32000 (37%)] Loss: 1.58711 (QuantReg: 12.72521) QuantErr: 12.72521 batch_time=0.39998 
Train Epoch: 7 [193/500 12352/32000 (39%)] Loss: 2.23692 (QuantReg: 12.30229) QuantErr: 12.30229 batch_time=0.44385 
Train Epoch: 7 [201/500 12864/32000 (40%)] Loss: 1.81909 (QuantReg: 12.32690) QuantErr: 12.32690 batch_time=0.44195 
Train Epoch: 7 [209/500 13376/32000 (42%)] Loss: 1.35153 (QuantReg: 12.06672) QuantErr: 12.06672 batch_time=1.13970 
Train Epoch: 7 [217/500 13888/32000 (43%)] Loss: 1.98435 (QuantReg: 11.80646) QuantErr: 11.80646 batch_time=0.39410 
Train Epoch: 7 [225/500 14400/32000 (45%)] Loss: 1.94963 (QuantReg: 12.47742) QuantErr: 12.47742 batch_time=0.39280 
Train Epoch: 7 [233/500 14912/32000 (47%)] Loss: 1.50983 (QuantReg: 12.37857) QuantErr: 12.37857 batch_time=0.39627 
Train Epoch: 7 [241/500 15424/32000 (48%)] Loss: 1.24962 (QuantReg: 12.80173) QuantErr: 12.80173 batch_time=0.41134 
Train Epoch: 7 [249/500 15936/32000 (50%)] Loss: 2.12747 (QuantReg: 12.24427) QuantErr: 12.24427 batch_time=0.39630 
Train Epoch: 7 [257/500 16448/32000 (51%)] Loss: 1.44181 (QuantReg: 12.12385) QuantErr: 12.12385 batch_time=0.38614 
Train Epoch: 7 [265/500 16960/32000 (53%)] Loss: 1.22868 (QuantReg: 12.33404) QuantErr: 12.33404 batch_time=0.38678 
Train Epoch: 7 [273/500 17472/32000 (55%)] Loss: 1.89606 (QuantReg: 12.52978) QuantErr: 12.52978 batch_time=1.23267 
Train Epoch: 7 [281/500 17984/32000 (56%)] Loss: 1.33831 (QuantReg: 12.35811) QuantErr: 12.35811 batch_time=0.39084 
Train Epoch: 7 [289/500 18496/32000 (58%)] Loss: 1.88343 (QuantReg: 12.50326) QuantErr: 12.50326 batch_time=0.38892 
Train Epoch: 7 [297/500 19008/32000 (59%)] Loss: 2.26450 (QuantReg: 12.29451) QuantErr: 12.29451 batch_time=0.39043 
Train Epoch: 7 [305/500 19520/32000 (61%)] Loss: 1.47651 (QuantReg: 12.73297) QuantErr: 12.73297 batch_time=0.40075 
Train Epoch: 7 [313/500 20032/32000 (63%)] Loss: 1.30282 (QuantReg: 12.28851) QuantErr: 12.28851 batch_time=0.39438 
Train Epoch: 7 [321/500 20544/32000 (64%)] Loss: 1.47924 (QuantReg: 12.79596) QuantErr: 12.79596 batch_time=0.37681 
Train Epoch: 7 [329/500 21056/32000 (66%)] Loss: 1.43071 (QuantReg: 12.36051) QuantErr: 12.36051 batch_time=0.40144 
Train Epoch: 7 [337/500 21568/32000 (67%)] Loss: 2.01688 (QuantReg: 12.58380) QuantErr: 12.58380 batch_time=1.10797 
Train Epoch: 7 [345/500 22080/32000 (69%)] Loss: 1.25702 (QuantReg: 12.93409) QuantErr: 12.93409 batch_time=0.39054 
Train Epoch: 7 [353/500 22592/32000 (71%)] Loss: 1.18994 (QuantReg: 12.90978) QuantErr: 12.90978 batch_time=0.38855 
Train Epoch: 7 [361/500 23104/32000 (72%)] Loss: 1.62455 (QuantReg: 12.70672) QuantErr: 12.70672 batch_time=0.38119 
Train Epoch: 7 [369/500 23616/32000 (74%)] Loss: 1.34308 (QuantReg: 13.21257) QuantErr: 13.21257 batch_time=0.39265 
Train Epoch: 7 [377/500 24128/32000 (75%)] Loss: 1.27109 (QuantReg: 12.45664) QuantErr: 12.45664 batch_time=0.38238 
Train Epoch: 7 [385/500 24640/32000 (77%)] Loss: 1.23691 (QuantReg: 12.14960) QuantErr: 12.14960 batch_time=0.38101 
Train Epoch: 7 [393/500 25152/32000 (79%)] Loss: 1.34844 (QuantReg: 12.75487) QuantErr: 12.75487 batch_time=0.39746 
Train Epoch: 7 [401/500 25664/32000 (80%)] Loss: 1.64176 (QuantReg: 12.77072) QuantErr: 12.77072 batch_time=1.12809 
Train Epoch: 7 [409/500 26176/32000 (82%)] Loss: 1.24157 (QuantReg: 12.85606) QuantErr: 12.85606 batch_time=0.38706 
Train Epoch: 7 [417/500 26688/32000 (83%)] Loss: 1.24490 (QuantReg: 12.93826) QuantErr: 12.93826 batch_time=0.38701 
Train Epoch: 7 [425/500 27200/32000 (85%)] Loss: 1.16822 (QuantReg: 12.66522) QuantErr: 12.66522 batch_time=0.41242 
Train Epoch: 7 [433/500 27712/32000 (87%)] Loss: 1.35567 (QuantReg: 12.96339) QuantErr: 12.96339 batch_time=0.39076 
Train Epoch: 7 [441/500 28224/32000 (88%)] Loss: 1.95702 (QuantReg: 12.88913) QuantErr: 12.88913 batch_time=0.38910 
Train Epoch: 7 [449/500 28736/32000 (90%)] Loss: 1.27279 (QuantReg: 12.72001) QuantErr: 12.72001 batch_time=0.39044 
Train Epoch: 7 [457/500 29248/32000 (91%)] Loss: 1.67259 (QuantReg: 13.03327) QuantErr: 13.03327 batch_time=0.39031 
Train Epoch: 7 [465/500 29760/32000 (93%)] Loss: 1.58671 (QuantReg: 12.31660) QuantErr: 12.31660 batch_time=1.12122 
Train Epoch: 7 [473/500 30272/32000 (95%)] Loss: 1.56941 (QuantReg: 12.66557) QuantErr: 12.66557 batch_time=0.39770 
Train Epoch: 7 [481/500 30784/32000 (96%)] Loss: 1.87366 (QuantReg: 13.09348) QuantErr: 13.09348 batch_time=0.38953 
Train Epoch: 7 [489/500 31296/32000 (98%)] Loss: 1.35074 (QuantReg: 12.50569) QuantErr: 12.50569 batch_time=0.39339 
Train Epoch: 7 [497/500 31808/32000 (99%)] Loss: 1.57302 (QuantReg: 13.04582) QuantErr: 13.04582 batch_time=0.38349 
Train Epoch: 7 codebook_update_time=1.69709
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch7.pth ...
Done in 6.589s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch7.pth ...
Done in 11.610s
removing stale ckpt [epoch 6] [took 0.02s]
 epoch          : 7
 loss           : 1.5051208713054658
 quant_reg      : 12.501774110794067
 quant_err      : 12.501774110794067
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.118
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.41788253272113
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.9985
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.275386339985786
 mnt_best       : 37.41788253272113
 not_improved_count: 0
Train Epoch: 8 [1/500 64/32000 (0%)] Loss: 1.66472 (QuantReg: 12.46550) QuantErr: 12.46550 batch_time=17.24138 
Train Epoch: 8 [9/500 576/32000 (2%)] Loss: 1.55434 (QuantReg: 12.00653) QuantErr: 12.00653 batch_time=0.39094 
Train Epoch: 8 [17/500 1088/32000 (3%)] Loss: 2.24864 (QuantReg: 11.77843) QuantErr: 11.77843 batch_time=0.39938 
Train Epoch: 8 [25/500 1600/32000 (5%)] Loss: 1.50939 (QuantReg: 12.28538) QuantErr: 12.28538 batch_time=0.57396 
Train Epoch: 8 [33/500 2112/32000 (7%)] Loss: 1.37420 (QuantReg: 12.33344) QuantErr: 12.33344 batch_time=0.39137 
Train Epoch: 8 [41/500 2624/32000 (8%)] Loss: 1.06412 (QuantReg: 12.36967) QuantErr: 12.36967 batch_time=0.39687 
Train Epoch: 8 [49/500 3136/32000 (10%)] Loss: 1.55419 (QuantReg: 12.67851) QuantErr: 12.67851 batch_time=0.39337 
Train Epoch: 8 [57/500 3648/32000 (11%)] Loss: 1.67789 (QuantReg: 12.90914) QuantErr: 12.90914 batch_time=0.40541 
Train Epoch: 8 [65/500 4160/32000 (13%)] Loss: 1.78504 (QuantReg: 12.56886) QuantErr: 12.56886 batch_time=0.45308 
Train Epoch: 8 [73/500 4672/32000 (15%)] Loss: 1.48328 (QuantReg: 12.92658) QuantErr: 12.92658 batch_time=0.39137 
Train Epoch: 8 [81/500 5184/32000 (16%)] Loss: 1.63748 (QuantReg: 12.45586) QuantErr: 12.45586 batch_time=0.39260 
Train Epoch: 8 [89/500 5696/32000 (18%)] Loss: 1.95157 (QuantReg: 12.64638) QuantErr: 12.64638 batch_time=0.56963 
Train Epoch: 8 [97/500 6208/32000 (19%)] Loss: 1.95589 (QuantReg: 12.80142) QuantErr: 12.80142 batch_time=0.39096 
Train Epoch: 8 [105/500 6720/32000 (21%)] Loss: 1.54546 (QuantReg: 11.96908) QuantErr: 11.96908 batch_time=0.39107 
Train Epoch: 8 [113/500 7232/32000 (23%)] Loss: 1.27474 (QuantReg: 12.33202) QuantErr: 12.33202 batch_time=0.39344 
Train Epoch: 8 [121/500 7744/32000 (24%)] Loss: 1.29679 (QuantReg: 12.87939) QuantErr: 12.87939 batch_time=0.38956 
Train Epoch: 8 [129/500 8256/32000 (26%)] Loss: 1.49165 (QuantReg: 12.70084) QuantErr: 12.70084 batch_time=0.43780 
Train Epoch: 8 [137/500 8768/32000 (27%)] Loss: 1.75431 (QuantReg: 12.62730) QuantErr: 12.62730 batch_time=0.39927 
Train Epoch: 8 [145/500 9280/32000 (29%)] Loss: 1.15790 (QuantReg: 12.20667) QuantErr: 12.20667 batch_time=0.43369 
Train Epoch: 8 [153/500 9792/32000 (31%)] Loss: 1.33655 (QuantReg: 11.97945) QuantErr: 11.97945 batch_time=0.57213 
Train Epoch: 8 [161/500 10304/32000 (32%)] Loss: 1.32361 (QuantReg: 12.40961) QuantErr: 12.40961 batch_time=0.40633 
Train Epoch: 8 [169/500 10816/32000 (34%)] Loss: 1.39732 (QuantReg: 12.55658) QuantErr: 12.55658 batch_time=0.39418 
Train Epoch: 8 [177/500 11328/32000 (35%)] Loss: 1.63709 (QuantReg: 12.19050) QuantErr: 12.19050 batch_time=0.38955 
Train Epoch: 8 [185/500 11840/32000 (37%)] Loss: 1.19245 (QuantReg: 12.60962) QuantErr: 12.60962 batch_time=0.39087 
Train Epoch: 8 [193/500 12352/32000 (39%)] Loss: 1.97267 (QuantReg: 12.03733) QuantErr: 12.03733 batch_time=0.46227 
Train Epoch: 8 [201/500 12864/32000 (40%)] Loss: 1.30008 (QuantReg: 12.54200) QuantErr: 12.54200 batch_time=0.39500 
Train Epoch: 8 [209/500 13376/32000 (42%)] Loss: 1.47875 (QuantReg: 12.30043) QuantErr: 12.30043 batch_time=0.39442 
Train Epoch: 8 [217/500 13888/32000 (43%)] Loss: 1.19206 (QuantReg: 12.89801) QuantErr: 12.89801 batch_time=0.59145 
Train Epoch: 8 [225/500 14400/32000 (45%)] Loss: 1.06042 (QuantReg: 12.53726) QuantErr: 12.53726 batch_time=0.40501 
Train Epoch: 8 [233/500 14912/32000 (47%)] Loss: 1.30831 (QuantReg: 12.37671) QuantErr: 12.37671 batch_time=0.41221 
Train Epoch: 8 [241/500 15424/32000 (48%)] Loss: 1.62073 (QuantReg: 12.80197) QuantErr: 12.80197 batch_time=0.39576 
Train Epoch: 8 [249/500 15936/32000 (50%)] Loss: 1.33171 (QuantReg: 12.68009) QuantErr: 12.68009 batch_time=0.39248 
Train Epoch: 8 [257/500 16448/32000 (51%)] Loss: 1.16250 (QuantReg: 13.12788) QuantErr: 13.12788 batch_time=0.45855 
Train Epoch: 8 [265/500 16960/32000 (53%)] Loss: 1.05366 (QuantReg: 12.83234) QuantErr: 12.83234 batch_time=0.38885 
Train Epoch: 8 [273/500 17472/32000 (55%)] Loss: 1.28529 (QuantReg: 12.39958) QuantErr: 12.39958 batch_time=0.39304 
Train Epoch: 8 [281/500 17984/32000 (56%)] Loss: 1.52237 (QuantReg: 12.76219) QuantErr: 12.76219 batch_time=0.56533 
Train Epoch: 8 [289/500 18496/32000 (58%)] Loss: 1.65598 (QuantReg: 12.91351) QuantErr: 12.91351 batch_time=0.38563 
Train Epoch: 8 [297/500 19008/32000 (59%)] Loss: 1.13697 (QuantReg: 12.49892) QuantErr: 12.49892 batch_time=0.39549 
Train Epoch: 8 [305/500 19520/32000 (61%)] Loss: 2.01352 (QuantReg: 12.30511) QuantErr: 12.30511 batch_time=0.40619 
Train Epoch: 8 [313/500 20032/32000 (63%)] Loss: 1.06736 (QuantReg: 12.34055) QuantErr: 12.34055 batch_time=0.39657 
Train Epoch: 8 [321/500 20544/32000 (64%)] Loss: 1.41705 (QuantReg: 12.74534) QuantErr: 12.74534 batch_time=0.44400 
Train Epoch: 8 [329/500 21056/32000 (66%)] Loss: 1.06555 (QuantReg: 12.89157) QuantErr: 12.89157 batch_time=0.38462 
Train Epoch: 8 [337/500 21568/32000 (67%)] Loss: 1.58392 (QuantReg: 12.77572) QuantErr: 12.77572 batch_time=0.39098 
Train Epoch: 8 [345/500 22080/32000 (69%)] Loss: 1.68710 (QuantReg: 12.73551) QuantErr: 12.73551 batch_time=0.57364 
Train Epoch: 8 [353/500 22592/32000 (71%)] Loss: 1.20625 (QuantReg: 12.59612) QuantErr: 12.59612 batch_time=0.42037 
Train Epoch: 8 [361/500 23104/32000 (72%)] Loss: 1.32991 (QuantReg: 12.70931) QuantErr: 12.70931 batch_time=0.38988 
Train Epoch: 8 [369/500 23616/32000 (74%)] Loss: 1.36337 (QuantReg: 12.59079) QuantErr: 12.59079 batch_time=0.38829 
Train Epoch: 8 [377/500 24128/32000 (75%)] Loss: 1.31439 (QuantReg: 12.88050) QuantErr: 12.88050 batch_time=0.46039 
Train Epoch: 8 [385/500 24640/32000 (77%)] Loss: 1.43895 (QuantReg: 12.55658) QuantErr: 12.55658 batch_time=0.44990 
Train Epoch: 8 [393/500 25152/32000 (79%)] Loss: 1.15145 (QuantReg: 12.85669) QuantErr: 12.85669 batch_time=0.38840 
Train Epoch: 8 [401/500 25664/32000 (80%)] Loss: 1.42291 (QuantReg: 12.25670) QuantErr: 12.25670 batch_time=0.39777 
Train Epoch: 8 [409/500 26176/32000 (82%)] Loss: 1.30850 (QuantReg: 12.14458) QuantErr: 12.14458 batch_time=0.54680 
Train Epoch: 8 [417/500 26688/32000 (83%)] Loss: 1.42594 (QuantReg: 12.79269) QuantErr: 12.79269 batch_time=0.40183 
Train Epoch: 8 [425/500 27200/32000 (85%)] Loss: 1.29991 (QuantReg: 12.67039) QuantErr: 12.67039 batch_time=0.39117 
Train Epoch: 8 [433/500 27712/32000 (87%)] Loss: 1.19524 (QuantReg: 12.78636) QuantErr: 12.78636 batch_time=0.39895 
Train Epoch: 8 [441/500 28224/32000 (88%)] Loss: 1.18566 (QuantReg: 13.10266) QuantErr: 13.10266 batch_time=0.39176 
Train Epoch: 8 [449/500 28736/32000 (90%)] Loss: 1.18862 (QuantReg: 13.35276) QuantErr: 13.35276 batch_time=0.70921 
Train Epoch: 8 [457/500 29248/32000 (91%)] Loss: 0.99798 (QuantReg: 13.21336) QuantErr: 13.21336 batch_time=0.39483 
Train Epoch: 8 [465/500 29760/32000 (93%)] Loss: 1.80158 (QuantReg: 12.81538) QuantErr: 12.81538 batch_time=0.42385 
Train Epoch: 8 [473/500 30272/32000 (95%)] Loss: 1.76842 (QuantReg: 12.94466) QuantErr: 12.94466 batch_time=0.56201 
Train Epoch: 8 [481/500 30784/32000 (96%)] Loss: 1.00761 (QuantReg: 12.92771) QuantErr: 12.92771 batch_time=0.39751 
Train Epoch: 8 [489/500 31296/32000 (98%)] Loss: 1.29564 (QuantReg: 12.49514) QuantErr: 12.49514 batch_time=0.38777 
Train Epoch: 8 [497/500 31808/32000 (99%)] Loss: 1.68951 (QuantReg: 12.01618) QuantErr: 12.01618 batch_time=0.41336 
Train Epoch: 8 codebook_update_time=1.64099
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch8.pth ...
Done in 5.561s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch8.pth ...
Done in 10.667s
removing stale ckpt [epoch 7] [took 0.02s]
 epoch          : 8
 loss           : 1.3876902730464935
 quant_reg      : 12.58097562789917
 quant_err      : 12.58097562789917
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.676
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.27895846263565
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.074
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.781195053623875
 mnt_best       : 38.27895846263565
 not_improved_count: 0
Train Epoch: 9 [1/500 64/32000 (0%)] Loss: 1.11694 (QuantReg: 12.40683) QuantErr: 12.40683 batch_time=18.23960 
Train Epoch: 9 [9/500 576/32000 (2%)] Loss: 1.62707 (QuantReg: 12.51502) QuantErr: 12.51502 batch_time=0.38698 
Train Epoch: 9 [17/500 1088/32000 (3%)] Loss: 1.00417 (QuantReg: 12.34313) QuantErr: 12.34313 batch_time=0.39466 
Train Epoch: 9 [25/500 1600/32000 (5%)] Loss: 1.38781 (QuantReg: 12.64220) QuantErr: 12.64220 batch_time=0.79446 
Train Epoch: 9 [33/500 2112/32000 (7%)] Loss: 1.23564 (QuantReg: 12.57654) QuantErr: 12.57654 batch_time=0.39706 
Train Epoch: 9 [41/500 2624/32000 (8%)] Loss: 1.09597 (QuantReg: 12.82699) QuantErr: 12.82699 batch_time=0.39303 
Train Epoch: 9 [49/500 3136/32000 (10%)] Loss: 1.70103 (QuantReg: 12.39120) QuantErr: 12.39120 batch_time=0.39768 
Train Epoch: 9 [57/500 3648/32000 (11%)] Loss: 1.58566 (QuantReg: 12.40341) QuantErr: 12.40341 batch_time=0.39165 
Train Epoch: 9 [65/500 4160/32000 (13%)] Loss: 1.50208 (QuantReg: 12.91872) QuantErr: 12.91872 batch_time=0.99329 
Train Epoch: 9 [73/500 4672/32000 (15%)] Loss: 1.50727 (QuantReg: 12.01018) QuantErr: 12.01018 batch_time=0.40146 
Train Epoch: 9 [81/500 5184/32000 (16%)] Loss: 1.75929 (QuantReg: 12.17904) QuantErr: 12.17904 batch_time=0.39694 
Train Epoch: 9 [89/500 5696/32000 (18%)] Loss: 1.36100 (QuantReg: 12.95789) QuantErr: 12.95789 batch_time=0.72689 
Train Epoch: 9 [97/500 6208/32000 (19%)] Loss: 1.38224 (QuantReg: 12.68473) QuantErr: 12.68473 batch_time=0.38527 
Train Epoch: 9 [105/500 6720/32000 (21%)] Loss: 1.47543 (QuantReg: 12.35239) QuantErr: 12.35239 batch_time=0.38706 
Train Epoch: 9 [113/500 7232/32000 (23%)] Loss: 1.18567 (QuantReg: 12.35077) QuantErr: 12.35077 batch_time=0.39293 
Train Epoch: 9 [121/500 7744/32000 (24%)] Loss: 1.37984 (QuantReg: 12.91609) QuantErr: 12.91609 batch_time=0.38830 
Train Epoch: 9 [129/500 8256/32000 (26%)] Loss: 1.53018 (QuantReg: 12.80286) QuantErr: 12.80286 batch_time=1.00821 
Train Epoch: 9 [137/500 8768/32000 (27%)] Loss: 1.44993 (QuantReg: 12.52950) QuantErr: 12.52950 batch_time=0.40130 
Train Epoch: 9 [145/500 9280/32000 (29%)] Loss: 1.09349 (QuantReg: 13.10928) QuantErr: 13.10928 batch_time=0.39497 
Train Epoch: 9 [153/500 9792/32000 (31%)] Loss: 1.49269 (QuantReg: 11.85662) QuantErr: 11.85662 batch_time=0.67762 
Train Epoch: 9 [161/500 10304/32000 (32%)] Loss: 1.77109 (QuantReg: 12.52746) QuantErr: 12.52746 batch_time=0.67162 
Train Epoch: 9 [169/500 10816/32000 (34%)] Loss: 1.28452 (QuantReg: 12.39639) QuantErr: 12.39639 batch_time=0.38467 
Train Epoch: 9 [177/500 11328/32000 (35%)] Loss: 1.48312 (QuantReg: 12.18731) QuantErr: 12.18731 batch_time=0.38842 
Train Epoch: 9 [185/500 11840/32000 (37%)] Loss: 1.30183 (QuantReg: 12.90518) QuantErr: 12.90518 batch_time=0.38969 
Train Epoch: 9 [193/500 12352/32000 (39%)] Loss: 1.30526 (QuantReg: 12.45727) QuantErr: 12.45727 batch_time=1.02096 
Train Epoch: 9 [201/500 12864/32000 (40%)] Loss: 1.19960 (QuantReg: 12.47402) QuantErr: 12.47402 batch_time=0.42626 
Train Epoch: 9 [209/500 13376/32000 (42%)] Loss: 1.17053 (QuantReg: 12.71996) QuantErr: 12.71996 batch_time=0.39674 
Train Epoch: 9 [217/500 13888/32000 (43%)] Loss: 1.06693 (QuantReg: 12.83737) QuantErr: 12.83737 batch_time=0.69510 
Train Epoch: 9 [225/500 14400/32000 (45%)] Loss: 1.35915 (QuantReg: 12.45746) QuantErr: 12.45746 batch_time=0.40056 
Train Epoch: 9 [233/500 14912/32000 (47%)] Loss: 0.78822 (QuantReg: 12.98041) QuantErr: 12.98041 batch_time=0.39742 
Train Epoch: 9 [241/500 15424/32000 (48%)] Loss: 1.62938 (QuantReg: 12.57870) QuantErr: 12.57870 batch_time=0.39614 
Train Epoch: 9 [249/500 15936/32000 (50%)] Loss: 1.44815 (QuantReg: 12.37022) QuantErr: 12.37022 batch_time=0.41142 
Train Epoch: 9 [257/500 16448/32000 (51%)] Loss: 1.54155 (QuantReg: 12.77389) QuantErr: 12.77389 batch_time=1.00527 
Train Epoch: 9 [265/500 16960/32000 (53%)] Loss: 1.30919 (QuantReg: 12.92681) QuantErr: 12.92681 batch_time=0.39508 
Train Epoch: 9 [273/500 17472/32000 (55%)] Loss: 1.01891 (QuantReg: 12.58328) QuantErr: 12.58328 batch_time=0.39504 
Train Epoch: 9 [281/500 17984/32000 (56%)] Loss: 1.34103 (QuantReg: 12.60287) QuantErr: 12.60287 batch_time=0.74784 
Train Epoch: 9 [289/500 18496/32000 (58%)] Loss: 1.25061 (QuantReg: 12.92915) QuantErr: 12.92915 batch_time=0.38598 
Train Epoch: 9 [297/500 19008/32000 (59%)] Loss: 1.71873 (QuantReg: 13.10741) QuantErr: 13.10741 batch_time=0.39272 
Train Epoch: 9 [305/500 19520/32000 (61%)] Loss: 1.02261 (QuantReg: 12.90493) QuantErr: 12.90493 batch_time=0.38865 
Train Epoch: 9 [313/500 20032/32000 (63%)] Loss: 1.40102 (QuantReg: 12.43208) QuantErr: 12.43208 batch_time=0.40859 
Train Epoch: 9 [321/500 20544/32000 (64%)] Loss: 1.28241 (QuantReg: 12.95629) QuantErr: 12.95629 batch_time=1.04286 
Train Epoch: 9 [329/500 21056/32000 (66%)] Loss: 1.26697 (QuantReg: 12.74267) QuantErr: 12.74267 batch_time=0.39054 
Train Epoch: 9 [337/500 21568/32000 (67%)] Loss: 1.44497 (QuantReg: 13.31601) QuantErr: 13.31601 batch_time=0.40115 
Train Epoch: 9 [345/500 22080/32000 (69%)] Loss: 1.86199 (QuantReg: 12.78634) QuantErr: 12.78634 batch_time=0.68722 
Train Epoch: 9 [353/500 22592/32000 (71%)] Loss: 1.18317 (QuantReg: 12.83574) QuantErr: 12.83574 batch_time=0.39429 
Train Epoch: 9 [361/500 23104/32000 (72%)] Loss: 1.16804 (QuantReg: 12.89106) QuantErr: 12.89106 batch_time=0.39007 
Train Epoch: 9 [369/500 23616/32000 (74%)] Loss: 1.18641 (QuantReg: 13.19099) QuantErr: 13.19099 batch_time=0.41005 
Train Epoch: 9 [377/500 24128/32000 (75%)] Loss: 1.44932 (QuantReg: 12.91891) QuantErr: 12.91891 batch_time=0.39573 
Train Epoch: 9 [385/500 24640/32000 (77%)] Loss: 0.99103 (QuantReg: 12.62557) QuantErr: 12.62557 batch_time=1.02554 
Train Epoch: 9 [393/500 25152/32000 (79%)] Loss: 1.57176 (QuantReg: 12.81067) QuantErr: 12.81067 batch_time=0.41923 
Train Epoch: 9 [401/500 25664/32000 (80%)] Loss: 1.36223 (QuantReg: 12.96061) QuantErr: 12.96061 batch_time=0.39733 
Train Epoch: 9 [409/500 26176/32000 (82%)] Loss: 1.28075 (QuantReg: 12.33234) QuantErr: 12.33234 batch_time=0.67257 
Train Epoch: 9 [417/500 26688/32000 (83%)] Loss: 1.88261 (QuantReg: 12.70833) QuantErr: 12.70833 batch_time=0.39388 
Train Epoch: 9 [425/500 27200/32000 (85%)] Loss: 1.54923 (QuantReg: 12.59919) QuantErr: 12.59919 batch_time=0.39147 
Train Epoch: 9 [433/500 27712/32000 (87%)] Loss: 1.54421 (QuantReg: 12.78975) QuantErr: 12.78975 batch_time=0.38985 
Train Epoch: 9 [441/500 28224/32000 (88%)] Loss: 1.55012 (QuantReg: 12.93843) QuantErr: 12.93843 batch_time=0.40536 
Train Epoch: 9 [449/500 28736/32000 (90%)] Loss: 1.43947 (QuantReg: 12.49295) QuantErr: 12.49295 batch_time=1.03718 
Train Epoch: 9 [457/500 29248/32000 (91%)] Loss: 1.41308 (QuantReg: 13.00617) QuantErr: 13.00617 batch_time=0.39826 
Train Epoch: 9 [465/500 29760/32000 (93%)] Loss: 1.24028 (QuantReg: 13.02754) QuantErr: 13.02754 batch_time=0.40599 
Train Epoch: 9 [473/500 30272/32000 (95%)] Loss: 1.09062 (QuantReg: 12.65441) QuantErr: 12.65441 batch_time=0.67498 
Train Epoch: 9 [481/500 30784/32000 (96%)] Loss: 1.22523 (QuantReg: 12.70884) QuantErr: 12.70884 batch_time=0.40482 
Train Epoch: 9 [489/500 31296/32000 (98%)] Loss: 1.26969 (QuantReg: 12.46730) QuantErr: 12.46730 batch_time=0.40507 
Train Epoch: 9 [497/500 31808/32000 (99%)] Loss: 1.83685 (QuantReg: 12.39955) QuantErr: 12.39955 batch_time=0.39112 
Train Epoch: 9 codebook_update_time=1.84910
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch9.pth ...
Done in 6.688s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch9.pth ...
Done in 12.481s
removing stale ckpt [epoch 8] [took 0.03s]
 epoch          : 9
 loss           : 1.326055295586586
 quant_reg      : 12.619954467773438
 quant_err      : 12.619954467773438
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.815
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.387260303590324
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.137
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.43717103823166
 mnt_best       : 40.387260303590324
 not_improved_count: 0
Train Epoch: 10 [1/500 64/32000 (0%)] Loss: 1.06526 (QuantReg: 12.35770) QuantErr: 12.35770 batch_time=18.17801 
Train Epoch: 10 [9/500 576/32000 (2%)] Loss: 0.96323 (QuantReg: 12.58889) QuantErr: 12.58889 batch_time=0.39246 
Train Epoch: 10 [17/500 1088/32000 (3%)] Loss: 0.90981 (QuantReg: 12.49405) QuantErr: 12.49405 batch_time=0.39361 
Train Epoch: 10 [25/500 1600/32000 (5%)] Loss: 0.74548 (QuantReg: 12.50273) QuantErr: 12.50273 batch_time=0.40569 
Train Epoch: 10 [33/500 2112/32000 (7%)] Loss: 1.29475 (QuantReg: 12.97423) QuantErr: 12.97423 batch_time=0.39506 
Train Epoch: 10 [41/500 2624/32000 (8%)] Loss: 1.14344 (QuantReg: 12.87450) QuantErr: 12.87450 batch_time=0.37959 
Train Epoch: 10 [49/500 3136/32000 (10%)] Loss: 1.20606 (QuantReg: 12.30503) QuantErr: 12.30503 batch_time=0.46957 
Train Epoch: 10 [57/500 3648/32000 (11%)] Loss: 1.45237 (QuantReg: 12.47041) QuantErr: 12.47041 batch_time=0.39135 
Train Epoch: 10 [65/500 4160/32000 (13%)] Loss: 1.06861 (QuantReg: 12.62032) QuantErr: 12.62032 batch_time=0.39412 
Train Epoch: 10 [73/500 4672/32000 (15%)] Loss: 1.35695 (QuantReg: 12.51781) QuantErr: 12.51781 batch_time=0.38349 
Train Epoch: 10 [81/500 5184/32000 (16%)] Loss: 1.05913 (QuantReg: 12.88052) QuantErr: 12.88052 batch_time=0.46098 
Train Epoch: 10 [89/500 5696/32000 (18%)] Loss: 1.21753 (QuantReg: 12.35158) QuantErr: 12.35158 batch_time=0.38442 
Train Epoch: 10 [97/500 6208/32000 (19%)] Loss: 1.27124 (QuantReg: 12.70398) QuantErr: 12.70398 batch_time=0.39487 
Train Epoch: 10 [105/500 6720/32000 (21%)] Loss: 0.78821 (QuantReg: 12.71186) QuantErr: 12.71186 batch_time=0.38430 
Train Epoch: 10 [113/500 7232/32000 (23%)] Loss: 1.55907 (QuantReg: 12.69761) QuantErr: 12.69761 batch_time=0.39554 
Train Epoch: 10 [121/500 7744/32000 (24%)] Loss: 0.72051 (QuantReg: 12.60051) QuantErr: 12.60051 batch_time=0.41210 
Train Epoch: 10 [129/500 8256/32000 (26%)] Loss: 1.53074 (QuantReg: 12.43745) QuantErr: 12.43745 batch_time=0.48065 
Train Epoch: 10 [137/500 8768/32000 (27%)] Loss: 0.76005 (QuantReg: 13.07347) QuantErr: 13.07347 batch_time=0.40921 
Train Epoch: 10 [145/500 9280/32000 (29%)] Loss: 1.02089 (QuantReg: 12.93517) QuantErr: 12.93517 batch_time=0.39117 
Train Epoch: 10 [153/500 9792/32000 (31%)] Loss: 1.37709 (QuantReg: 12.72596) QuantErr: 12.72596 batch_time=0.38798 
Train Epoch: 10 [161/500 10304/32000 (32%)] Loss: 1.29473 (QuantReg: 12.58808) QuantErr: 12.58808 batch_time=0.39302 
Train Epoch: 10 [169/500 10816/32000 (34%)] Loss: 1.25438 (QuantReg: 12.61736) QuantErr: 12.61736 batch_time=0.39050 
Train Epoch: 10 [177/500 11328/32000 (35%)] Loss: 1.12527 (QuantReg: 12.54941) QuantErr: 12.54941 batch_time=0.38849 
Train Epoch: 10 [185/500 11840/32000 (37%)] Loss: 1.25038 (QuantReg: 12.79461) QuantErr: 12.79461 batch_time=0.38449 
Train Epoch: 10 [193/500 12352/32000 (39%)] Loss: 1.43940 (QuantReg: 12.99457) QuantErr: 12.99457 batch_time=0.38915 
Train Epoch: 10 [201/500 12864/32000 (40%)] Loss: 1.59323 (QuantReg: 12.26372) QuantErr: 12.26372 batch_time=0.38246 
Train Epoch: 10 [209/500 13376/32000 (42%)] Loss: 1.42047 (QuantReg: 12.73018) QuantErr: 12.73018 batch_time=0.38517 
Train Epoch: 10 [217/500 13888/32000 (43%)] Loss: 1.05901 (QuantReg: 13.10758) QuantErr: 13.10758 batch_time=0.40435 
Train Epoch: 10 [225/500 14400/32000 (45%)] Loss: 0.99287 (QuantReg: 13.37206) QuantErr: 13.37206 batch_time=0.38406 
Train Epoch: 10 [233/500 14912/32000 (47%)] Loss: 0.95222 (QuantReg: 12.79100) QuantErr: 12.79100 batch_time=0.39081 
Train Epoch: 10 [241/500 15424/32000 (48%)] Loss: 1.11959 (QuantReg: 12.48613) QuantErr: 12.48613 batch_time=0.41709 
Train Epoch: 10 [249/500 15936/32000 (50%)] Loss: 1.36829 (QuantReg: 12.49568) QuantErr: 12.49568 batch_time=0.39304 
Train Epoch: 10 [257/500 16448/32000 (51%)] Loss: 1.53861 (QuantReg: 12.87021) QuantErr: 12.87021 batch_time=0.39560 
Train Epoch: 10 [265/500 16960/32000 (53%)] Loss: 1.06264 (QuantReg: 12.65668) QuantErr: 12.65668 batch_time=0.38312 
Train Epoch: 10 [273/500 17472/32000 (55%)] Loss: 1.59705 (QuantReg: 13.23549) QuantErr: 13.23549 batch_time=0.39193 
Train Epoch: 10 [281/500 17984/32000 (56%)] Loss: 1.57638 (QuantReg: 12.95210) QuantErr: 12.95210 batch_time=0.41027 
Train Epoch: 10 [289/500 18496/32000 (58%)] Loss: 1.06698 (QuantReg: 12.45169) QuantErr: 12.45169 batch_time=0.39137 
Train Epoch: 10 [297/500 19008/32000 (59%)] Loss: 1.37505 (QuantReg: 12.65191) QuantErr: 12.65191 batch_time=0.39583 
Train Epoch: 10 [305/500 19520/32000 (61%)] Loss: 1.17172 (QuantReg: 13.37060) QuantErr: 13.37060 batch_time=0.38678 
Train Epoch: 10 [313/500 20032/32000 (63%)] Loss: 1.04678 (QuantReg: 12.60240) QuantErr: 12.60240 batch_time=0.38921 
Train Epoch: 10 [321/500 20544/32000 (64%)] Loss: 1.29043 (QuantReg: 12.93709) QuantErr: 12.93709 batch_time=0.39230 
Train Epoch: 10 [329/500 21056/32000 (66%)] Loss: 1.03904 (QuantReg: 12.85841) QuantErr: 12.85841 batch_time=0.38769 
Train Epoch: 10 [337/500 21568/32000 (67%)] Loss: 1.31832 (QuantReg: 13.01828) QuantErr: 13.01828 batch_time=0.38789 
Train Epoch: 10 [345/500 22080/32000 (69%)] Loss: 0.84017 (QuantReg: 13.03595) QuantErr: 13.03595 batch_time=0.39341 
Train Epoch: 10 [353/500 22592/32000 (71%)] Loss: 1.35613 (QuantReg: 12.91237) QuantErr: 12.91237 batch_time=0.39203 
Train Epoch: 10 [361/500 23104/32000 (72%)] Loss: 1.13669 (QuantReg: 12.81594) QuantErr: 12.81594 batch_time=0.38807 
Train Epoch: 10 [369/500 23616/32000 (74%)] Loss: 1.24750 (QuantReg: 13.36549) QuantErr: 13.36549 batch_time=0.39083 
Train Epoch: 10 [377/500 24128/32000 (75%)] Loss: 1.02538 (QuantReg: 12.90402) QuantErr: 12.90402 batch_time=0.38955 
Train Epoch: 10 [385/500 24640/32000 (77%)] Loss: 0.88245 (QuantReg: 13.26641) QuantErr: 13.26641 batch_time=0.39135 
Train Epoch: 10 [393/500 25152/32000 (79%)] Loss: 1.10172 (QuantReg: 13.09942) QuantErr: 13.09942 batch_time=0.39655 
Train Epoch: 10 [401/500 25664/32000 (80%)] Loss: 1.36370 (QuantReg: 12.81647) QuantErr: 12.81647 batch_time=0.39952 
Train Epoch: 10 [409/500 26176/32000 (82%)] Loss: 1.13329 (QuantReg: 12.83367) QuantErr: 12.83367 batch_time=0.38276 
Train Epoch: 10 [417/500 26688/32000 (83%)] Loss: 1.01273 (QuantReg: 13.22180) QuantErr: 13.22180 batch_time=0.41403 
Train Epoch: 10 [425/500 27200/32000 (85%)] Loss: 1.03457 (QuantReg: 13.17237) QuantErr: 13.17237 batch_time=0.38823 
Train Epoch: 10 [433/500 27712/32000 (87%)] Loss: 0.86887 (QuantReg: 13.36805) QuantErr: 13.36805 batch_time=0.38785 
Train Epoch: 10 [441/500 28224/32000 (88%)] Loss: 0.91638 (QuantReg: 12.68407) QuantErr: 12.68407 batch_time=0.45573 
Train Epoch: 10 [449/500 28736/32000 (90%)] Loss: 1.61205 (QuantReg: 12.50339) QuantErr: 12.50339 batch_time=0.38634 
Train Epoch: 10 [457/500 29248/32000 (91%)] Loss: 1.62569 (QuantReg: 12.71425) QuantErr: 12.71425 batch_time=0.38376 
Train Epoch: 10 [465/500 29760/32000 (93%)] Loss: 1.06988 (QuantReg: 12.76612) QuantErr: 12.76612 batch_time=0.39675 
Train Epoch: 10 [473/500 30272/32000 (95%)] Loss: 1.46154 (QuantReg: 13.18792) QuantErr: 13.18792 batch_time=0.38257 
Train Epoch: 10 [481/500 30784/32000 (96%)] Loss: 1.21195 (QuantReg: 12.79129) QuantErr: 12.79129 batch_time=0.58512 
Train Epoch: 10 [489/500 31296/32000 (98%)] Loss: 1.16040 (QuantReg: 13.01865) QuantErr: 13.01865 batch_time=0.40267 
Train Epoch: 10 [497/500 31808/32000 (99%)] Loss: 1.17887 (QuantReg: 13.37302) QuantErr: 13.37302 batch_time=0.39863 
Train Epoch: 10 codebook_update_time=1.76188
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch10.pth ...
Done in 5.442s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch10.pth ...
Done in 12.586s
removing stale ckpt [epoch 9] [took 0.10s]
 epoch          : 10
 loss           : 1.2380561178922653
 quant_reg      : 12.785605012893678
 quant_err      : 12.785605012893678
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.25
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.65048602303446
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.686
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.21747732562143
 mnt_best       : 40.65048602303446
 not_improved_count: 0
Train Epoch: 11 [1/500 64/32000 (0%)] Loss: 1.18687 (QuantReg: 12.76305) QuantErr: 12.76305 batch_time=22.74253 
Train Epoch: 11 [9/500 576/32000 (2%)] Loss: 1.13792 (QuantReg: 12.91145) QuantErr: 12.91145 batch_time=0.41918 
Train Epoch: 11 [17/500 1088/32000 (3%)] Loss: 1.10997 (QuantReg: 12.38864) QuantErr: 12.38864 batch_time=0.38717 
Train Epoch: 11 [25/500 1600/32000 (5%)] Loss: 1.08754 (QuantReg: 12.34055) QuantErr: 12.34055 batch_time=0.75683 
Train Epoch: 11 [33/500 2112/32000 (7%)] Loss: 1.09268 (QuantReg: 12.51842) QuantErr: 12.51842 batch_time=0.45387 
Train Epoch: 11 [41/500 2624/32000 (8%)] Loss: 0.69345 (QuantReg: 12.44044) QuantErr: 12.44044 batch_time=0.39976 
Train Epoch: 11 [49/500 3136/32000 (10%)] Loss: 1.40313 (QuantReg: 12.64209) QuantErr: 12.64209 batch_time=0.40761 
Train Epoch: 11 [57/500 3648/32000 (11%)] Loss: 1.21274 (QuantReg: 12.51860) QuantErr: 12.51860 batch_time=0.40080 
Train Epoch: 11 [65/500 4160/32000 (13%)] Loss: 1.37001 (QuantReg: 12.38971) QuantErr: 12.38971 batch_time=0.50761 
Train Epoch: 11 [73/500 4672/32000 (15%)] Loss: 1.42194 (QuantReg: 12.75328) QuantErr: 12.75328 batch_time=0.39996 
Train Epoch: 11 [81/500 5184/32000 (16%)] Loss: 1.28158 (QuantReg: 12.29140) QuantErr: 12.29140 batch_time=0.39939 
Train Epoch: 11 [89/500 5696/32000 (18%)] Loss: 1.38909 (QuantReg: 12.62450) QuantErr: 12.62450 batch_time=0.39886 
Train Epoch: 11 [97/500 6208/32000 (19%)] Loss: 1.01093 (QuantReg: 12.85216) QuantErr: 12.85216 batch_time=0.39987 
Train Epoch: 11 [105/500 6720/32000 (21%)] Loss: 1.37810 (QuantReg: 12.81371) QuantErr: 12.81371 batch_time=0.40236 
Train Epoch: 11 [113/500 7232/32000 (23%)] Loss: 1.67984 (QuantReg: 12.61533) QuantErr: 12.61533 batch_time=0.39879 
Train Epoch: 11 [121/500 7744/32000 (24%)] Loss: 1.46386 (QuantReg: 12.75508) QuantErr: 12.75508 batch_time=0.45218 
Train Epoch: 11 [129/500 8256/32000 (26%)] Loss: 1.23128 (QuantReg: 12.55862) QuantErr: 12.55862 batch_time=0.51234 
Train Epoch: 11 [137/500 8768/32000 (27%)] Loss: 1.08721 (QuantReg: 12.56723) QuantErr: 12.56723 batch_time=0.44590 
Train Epoch: 11 [145/500 9280/32000 (29%)] Loss: 1.21631 (QuantReg: 12.92429) QuantErr: 12.92429 batch_time=0.38680 
Train Epoch: 11 [153/500 9792/32000 (31%)] Loss: 1.59345 (QuantReg: 12.56082) QuantErr: 12.56082 batch_time=0.38849 
Train Epoch: 11 [161/500 10304/32000 (32%)] Loss: 0.93211 (QuantReg: 12.93705) QuantErr: 12.93705 batch_time=0.38509 
Train Epoch: 11 [169/500 10816/32000 (34%)] Loss: 1.21626 (QuantReg: 12.82586) QuantErr: 12.82586 batch_time=0.46556 
Train Epoch: 11 [177/500 11328/32000 (35%)] Loss: 1.06557 (QuantReg: 12.81720) QuantErr: 12.81720 batch_time=0.38858 
Train Epoch: 11 [185/500 11840/32000 (37%)] Loss: 1.33771 (QuantReg: 13.04710) QuantErr: 13.04710 batch_time=0.38688 
Train Epoch: 11 [193/500 12352/32000 (39%)] Loss: 0.91181 (QuantReg: 12.57541) QuantErr: 12.57541 batch_time=0.50164 
Train Epoch: 11 [201/500 12864/32000 (40%)] Loss: 1.78957 (QuantReg: 12.88727) QuantErr: 12.88727 batch_time=0.39706 
Train Epoch: 11 [209/500 13376/32000 (42%)] Loss: 0.87449 (QuantReg: 12.74671) QuantErr: 12.74671 batch_time=0.38749 
Train Epoch: 11 [217/500 13888/32000 (43%)] Loss: 0.90685 (QuantReg: 12.27593) QuantErr: 12.27593 batch_time=0.38796 
Train Epoch: 11 [225/500 14400/32000 (45%)] Loss: 0.83693 (QuantReg: 12.42501) QuantErr: 12.42501 batch_time=0.42276 
Train Epoch: 11 [233/500 14912/32000 (47%)] Loss: 1.15874 (QuantReg: 12.73951) QuantErr: 12.73951 batch_time=0.39756 
Train Epoch: 11 [241/500 15424/32000 (48%)] Loss: 0.94681 (QuantReg: 13.04705) QuantErr: 13.04705 batch_time=0.39466 
Train Epoch: 11 [249/500 15936/32000 (50%)] Loss: 1.26856 (QuantReg: 13.08866) QuantErr: 13.08866 batch_time=0.38794 
Train Epoch: 11 [257/500 16448/32000 (51%)] Loss: 1.09535 (QuantReg: 12.95442) QuantErr: 12.95442 batch_time=0.38511 
Train Epoch: 11 [265/500 16960/32000 (53%)] Loss: 1.52557 (QuantReg: 12.47016) QuantErr: 12.47016 batch_time=0.45455 
Train Epoch: 11 [273/500 17472/32000 (55%)] Loss: 1.14662 (QuantReg: 12.66918) QuantErr: 12.66918 batch_time=0.39428 
Train Epoch: 11 [281/500 17984/32000 (56%)] Loss: 1.41052 (QuantReg: 12.66264) QuantErr: 12.66264 batch_time=0.40619 
Train Epoch: 11 [289/500 18496/32000 (58%)] Loss: 1.50514 (QuantReg: 12.55703) QuantErr: 12.55703 batch_time=0.40195 
Train Epoch: 11 [297/500 19008/32000 (59%)] Loss: 1.10419 (QuantReg: 12.57442) QuantErr: 12.57442 batch_time=0.40011 
Train Epoch: 11 [305/500 19520/32000 (61%)] Loss: 1.13942 (QuantReg: 13.00551) QuantErr: 13.00551 batch_time=0.39768 
Train Epoch: 11 [313/500 20032/32000 (63%)] Loss: 0.82037 (QuantReg: 12.91786) QuantErr: 12.91786 batch_time=0.40003 
Train Epoch: 11 [321/500 20544/32000 (64%)] Loss: 1.33849 (QuantReg: 12.57077) QuantErr: 12.57077 batch_time=0.39558 
Train Epoch: 11 [329/500 21056/32000 (66%)] Loss: 0.90507 (QuantReg: 12.81976) QuantErr: 12.81976 batch_time=0.38870 
Train Epoch: 11 [337/500 21568/32000 (67%)] Loss: 1.80234 (QuantReg: 12.54964) QuantErr: 12.54964 batch_time=0.38686 
Train Epoch: 11 [345/500 22080/32000 (69%)] Loss: 1.05201 (QuantReg: 12.75527) QuantErr: 12.75527 batch_time=0.37652 
Train Epoch: 11 [353/500 22592/32000 (71%)] Loss: 1.04371 (QuantReg: 12.95948) QuantErr: 12.95948 batch_time=0.38519 
Train Epoch: 11 [361/500 23104/32000 (72%)] Loss: 1.33589 (QuantReg: 12.45922) QuantErr: 12.45922 batch_time=0.40549 
Train Epoch: 11 [369/500 23616/32000 (74%)] Loss: 1.07985 (QuantReg: 12.38361) QuantErr: 12.38361 batch_time=0.38729 
Train Epoch: 11 [377/500 24128/32000 (75%)] Loss: 0.92237 (QuantReg: 12.39698) QuantErr: 12.39698 batch_time=0.39004 
Train Epoch: 11 [385/500 24640/32000 (77%)] Loss: 0.60180 (QuantReg: 13.09874) QuantErr: 13.09874 batch_time=0.39458 
Train Epoch: 11 [393/500 25152/32000 (79%)] Loss: 1.15830 (QuantReg: 12.78368) QuantErr: 12.78368 batch_time=0.39787 
Train Epoch: 11 [401/500 25664/32000 (80%)] Loss: 0.98188 (QuantReg: 12.70040) QuantErr: 12.70040 batch_time=0.38812 
Train Epoch: 11 [409/500 26176/32000 (82%)] Loss: 0.92709 (QuantReg: 13.10632) QuantErr: 13.10632 batch_time=0.38678 
Train Epoch: 11 [417/500 26688/32000 (83%)] Loss: 1.02162 (QuantReg: 12.14959) QuantErr: 12.14959 batch_time=0.38603 
Train Epoch: 11 [425/500 27200/32000 (85%)] Loss: 1.17314 (QuantReg: 13.51550) QuantErr: 13.51550 batch_time=0.38624 
Train Epoch: 11 [433/500 27712/32000 (87%)] Loss: 1.24958 (QuantReg: 13.35081) QuantErr: 13.35081 batch_time=0.45023 
Train Epoch: 11 [441/500 28224/32000 (88%)] Loss: 1.27008 (QuantReg: 12.54632) QuantErr: 12.54632 batch_time=0.39313 
Train Epoch: 11 [449/500 28736/32000 (90%)] Loss: 1.26448 (QuantReg: 12.72563) QuantErr: 12.72563 batch_time=0.39027 
Train Epoch: 11 [457/500 29248/32000 (91%)] Loss: 0.86939 (QuantReg: 13.36110) QuantErr: 13.36110 batch_time=0.37754 
Train Epoch: 11 [465/500 29760/32000 (93%)] Loss: 1.18840 (QuantReg: 12.68564) QuantErr: 12.68564 batch_time=0.38191 
Train Epoch: 11 [473/500 30272/32000 (95%)] Loss: 1.51185 (QuantReg: 12.49050) QuantErr: 12.49050 batch_time=0.37979 
Train Epoch: 11 [481/500 30784/32000 (96%)] Loss: 0.81408 (QuantReg: 12.90505) QuantErr: 12.90505 batch_time=0.37936 
Train Epoch: 11 [489/500 31296/32000 (98%)] Loss: 0.66114 (QuantReg: 13.16429) QuantErr: 13.16429 batch_time=0.38468 
Train Epoch: 11 [497/500 31808/32000 (99%)] Loss: 1.35145 (QuantReg: 12.60358) QuantErr: 12.60358 batch_time=0.40110 
Train Epoch: 11 codebook_update_time=2.50623
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch11.pth ...
Done in 4.570s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch11.pth ...
Done in 9.483s
removing stale ckpt [epoch 10] [took 0.05s]
 epoch          : 11
 loss           : 1.1801822335720062
 quant_reg      : 12.744411569595337
 quant_err      : 12.744411569595337
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.492
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.79656112884437
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.5415
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.07244537913076
 mnt_best       : 40.79656112884437
 not_improved_count: 0
Train Epoch: 12 [1/500 64/32000 (0%)] Loss: 0.90073 (QuantReg: 12.77153) QuantErr: 12.77153 batch_time=19.97333 
Train Epoch: 12 [9/500 576/32000 (2%)] Loss: 1.43258 (QuantReg: 12.80886) QuantErr: 12.80886 batch_time=0.39065 
Train Epoch: 12 [17/500 1088/32000 (3%)] Loss: 1.73084 (QuantReg: 12.20714) QuantErr: 12.20714 batch_time=0.38684 
Train Epoch: 12 [25/500 1600/32000 (5%)] Loss: 0.71910 (QuantReg: 12.83404) QuantErr: 12.83404 batch_time=0.39353 
Train Epoch: 12 [33/500 2112/32000 (7%)] Loss: 1.57522 (QuantReg: 12.22924) QuantErr: 12.22924 batch_time=0.38381 
Train Epoch: 12 [41/500 2624/32000 (8%)] Loss: 1.24281 (QuantReg: 12.80867) QuantErr: 12.80867 batch_time=0.38862 
Train Epoch: 12 [49/500 3136/32000 (10%)] Loss: 1.13328 (QuantReg: 13.21210) QuantErr: 13.21210 batch_time=0.38274 
Train Epoch: 12 [57/500 3648/32000 (11%)] Loss: 1.02614 (QuantReg: 12.29577) QuantErr: 12.29577 batch_time=0.38998 
Train Epoch: 12 [65/500 4160/32000 (13%)] Loss: 0.45658 (QuantReg: 13.04722) QuantErr: 13.04722 batch_time=1.06961 
Train Epoch: 12 [73/500 4672/32000 (15%)] Loss: 0.87903 (QuantReg: 12.42404) QuantErr: 12.42404 batch_time=0.38427 
Train Epoch: 12 [81/500 5184/32000 (16%)] Loss: 0.62764 (QuantReg: 12.86132) QuantErr: 12.86132 batch_time=0.42226 
Train Epoch: 12 [89/500 5696/32000 (18%)] Loss: 1.11815 (QuantReg: 12.76692) QuantErr: 12.76692 batch_time=0.38864 
Train Epoch: 12 [97/500 6208/32000 (19%)] Loss: 0.92364 (QuantReg: 12.61726) QuantErr: 12.61726 batch_time=0.38758 
Train Epoch: 12 [105/500 6720/32000 (21%)] Loss: 0.96542 (QuantReg: 12.82606) QuantErr: 12.82606 batch_time=0.44476 
Train Epoch: 12 [113/500 7232/32000 (23%)] Loss: 1.20849 (QuantReg: 12.66041) QuantErr: 12.66041 batch_time=0.38139 
Train Epoch: 12 [121/500 7744/32000 (24%)] Loss: 1.15229 (QuantReg: 12.92118) QuantErr: 12.92118 batch_time=0.38796 
Train Epoch: 12 [129/500 8256/32000 (26%)] Loss: 0.69935 (QuantReg: 13.45544) QuantErr: 13.45544 batch_time=0.89493 
Train Epoch: 12 [137/500 8768/32000 (27%)] Loss: 1.96573 (QuantReg: 12.95517) QuantErr: 12.95517 batch_time=0.40107 
Train Epoch: 12 [145/500 9280/32000 (29%)] Loss: 1.15817 (QuantReg: 12.78405) QuantErr: 12.78405 batch_time=0.39146 
Train Epoch: 12 [153/500 9792/32000 (31%)] Loss: 1.56563 (QuantReg: 13.05936) QuantErr: 13.05936 batch_time=0.38970 
Train Epoch: 12 [161/500 10304/32000 (32%)] Loss: 1.30633 (QuantReg: 12.79137) QuantErr: 12.79137 batch_time=0.40025 
Train Epoch: 12 [169/500 10816/32000 (34%)] Loss: 1.34550 (QuantReg: 12.39790) QuantErr: 12.39790 batch_time=0.38780 
Train Epoch: 12 [177/500 11328/32000 (35%)] Loss: 1.11307 (QuantReg: 12.61337) QuantErr: 12.61337 batch_time=0.40342 
Train Epoch: 12 [185/500 11840/32000 (37%)] Loss: 1.41370 (QuantReg: 12.92481) QuantErr: 12.92481 batch_time=0.39171 
Train Epoch: 12 [193/500 12352/32000 (39%)] Loss: 1.27056 (QuantReg: 12.99577) QuantErr: 12.99577 batch_time=0.86489 
Train Epoch: 12 [201/500 12864/32000 (40%)] Loss: 0.89606 (QuantReg: 12.67497) QuantErr: 12.67497 batch_time=0.39471 
Train Epoch: 12 [209/500 13376/32000 (42%)] Loss: 1.08284 (QuantReg: 12.38643) QuantErr: 12.38643 batch_time=0.39294 
Train Epoch: 12 [217/500 13888/32000 (43%)] Loss: 0.88680 (QuantReg: 13.34492) QuantErr: 13.34492 batch_time=0.39062 
Train Epoch: 12 [225/500 14400/32000 (45%)] Loss: 1.09330 (QuantReg: 12.85234) QuantErr: 12.85234 batch_time=0.38792 
Train Epoch: 12 [233/500 14912/32000 (47%)] Loss: 0.81910 (QuantReg: 12.90555) QuantErr: 12.90555 batch_time=0.38513 
Train Epoch: 12 [241/500 15424/32000 (48%)] Loss: 1.00702 (QuantReg: 13.02084) QuantErr: 13.02084 batch_time=0.39066 
Train Epoch: 12 [249/500 15936/32000 (50%)] Loss: 1.20123 (QuantReg: 13.40060) QuantErr: 13.40060 batch_time=0.43365 
Train Epoch: 12 [257/500 16448/32000 (51%)] Loss: 1.04500 (QuantReg: 12.31378) QuantErr: 12.31378 batch_time=0.86817 
Train Epoch: 12 [265/500 16960/32000 (53%)] Loss: 1.06759 (QuantReg: 12.72120) QuantErr: 12.72120 batch_time=0.39324 
Train Epoch: 12 [273/500 17472/32000 (55%)] Loss: 1.07348 (QuantReg: 12.95824) QuantErr: 12.95824 batch_time=0.39764 
Train Epoch: 12 [281/500 17984/32000 (56%)] Loss: 1.39972 (QuantReg: 12.76912) QuantErr: 12.76912 batch_time=0.43004 
Train Epoch: 12 [289/500 18496/32000 (58%)] Loss: 0.98176 (QuantReg: 13.21659) QuantErr: 13.21659 batch_time=0.40119 
Train Epoch: 12 [297/500 19008/32000 (59%)] Loss: 0.90483 (QuantReg: 12.97680) QuantErr: 12.97680 batch_time=0.40531 
Train Epoch: 12 [305/500 19520/32000 (61%)] Loss: 0.94878 (QuantReg: 12.84123) QuantErr: 12.84123 batch_time=0.42648 
Train Epoch: 12 [313/500 20032/32000 (63%)] Loss: 0.77113 (QuantReg: 12.82257) QuantErr: 12.82257 batch_time=0.46500 
Train Epoch: 12 [321/500 20544/32000 (64%)] Loss: 1.11509 (QuantReg: 12.57314) QuantErr: 12.57314 batch_time=0.90701 
Train Epoch: 12 [329/500 21056/32000 (66%)] Loss: 1.25423 (QuantReg: 13.36357) QuantErr: 13.36357 batch_time=0.39580 
Train Epoch: 12 [337/500 21568/32000 (67%)] Loss: 1.01716 (QuantReg: 13.07031) QuantErr: 13.07031 batch_time=0.45845 
Train Epoch: 12 [345/500 22080/32000 (69%)] Loss: 1.14867 (QuantReg: 12.66241) QuantErr: 12.66241 batch_time=0.40326 
Train Epoch: 12 [353/500 22592/32000 (71%)] Loss: 0.94366 (QuantReg: 12.71472) QuantErr: 12.71472 batch_time=0.38859 
Train Epoch: 12 [361/500 23104/32000 (72%)] Loss: 1.03695 (QuantReg: 13.05936) QuantErr: 13.05936 batch_time=0.38579 
Train Epoch: 12 [369/500 23616/32000 (74%)] Loss: 1.03511 (QuantReg: 12.70642) QuantErr: 12.70642 batch_time=0.39584 
Train Epoch: 12 [377/500 24128/32000 (75%)] Loss: 1.08862 (QuantReg: 12.82640) QuantErr: 12.82640 batch_time=0.38538 
Train Epoch: 12 [385/500 24640/32000 (77%)] Loss: 1.33111 (QuantReg: 13.35350) QuantErr: 13.35350 batch_time=0.97063 
Train Epoch: 12 [393/500 25152/32000 (79%)] Loss: 1.22906 (QuantReg: 12.88375) QuantErr: 12.88375 batch_time=0.38020 
Train Epoch: 12 [401/500 25664/32000 (80%)] Loss: 1.17451 (QuantReg: 13.14879) QuantErr: 13.14879 batch_time=0.42740 
Train Epoch: 12 [409/500 26176/32000 (82%)] Loss: 0.99730 (QuantReg: 12.62931) QuantErr: 12.62931 batch_time=0.38802 
Train Epoch: 12 [417/500 26688/32000 (83%)] Loss: 1.16526 (QuantReg: 13.17672) QuantErr: 13.17672 batch_time=0.38699 
Train Epoch: 12 [425/500 27200/32000 (85%)] Loss: 0.93696 (QuantReg: 12.75721) QuantErr: 12.75721 batch_time=0.38695 
Train Epoch: 12 [433/500 27712/32000 (87%)] Loss: 1.73441 (QuantReg: 12.76453) QuantErr: 12.76453 batch_time=0.44871 
Train Epoch: 12 [441/500 28224/32000 (88%)] Loss: 1.19667 (QuantReg: 13.13643) QuantErr: 13.13643 batch_time=0.41256 
Train Epoch: 12 [449/500 28736/32000 (90%)] Loss: 1.29840 (QuantReg: 13.00485) QuantErr: 13.00485 batch_time=0.93798 
Train Epoch: 12 [457/500 29248/32000 (91%)] Loss: 0.91974 (QuantReg: 12.96549) QuantErr: 12.96549 batch_time=0.39387 
Train Epoch: 12 [465/500 29760/32000 (93%)] Loss: 1.48625 (QuantReg: 11.97390) QuantErr: 11.97390 batch_time=0.38983 
Train Epoch: 12 [473/500 30272/32000 (95%)] Loss: 1.53695 (QuantReg: 13.04356) QuantErr: 13.04356 batch_time=0.38806 
Train Epoch: 12 [481/500 30784/32000 (96%)] Loss: 1.35049 (QuantReg: 12.57740) QuantErr: 12.57740 batch_time=0.38206 
Train Epoch: 12 [489/500 31296/32000 (98%)] Loss: 1.37996 (QuantReg: 12.87049) QuantErr: 12.87049 batch_time=0.38162 
Train Epoch: 12 [497/500 31808/32000 (99%)] Loss: 0.70854 (QuantReg: 12.98219) QuantErr: 12.98219 batch_time=0.38777 
Train Epoch: 12 codebook_update_time=2.04846
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch12.pth ...
Done in 6.761s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch12.pth ...
Done in 12.027s
removing stale ckpt [epoch 11] [took 0.10s]
 epoch          : 12
 loss           : 1.12843425488472
 quant_reg      : 12.811139310836792
 quant_err      : 12.811139310836792
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.372
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.88144414854273
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.798
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.9627081097753
 mnt_best       : 40.88144414854273
 not_improved_count: 0
Train Epoch: 13 [1/500 64/32000 (0%)] Loss: 1.41566 (QuantReg: 12.42727) QuantErr: 12.42727 batch_time=18.57628 
Train Epoch: 13 [9/500 576/32000 (2%)] Loss: 1.03714 (QuantReg: 12.44283) QuantErr: 12.44283 batch_time=0.38909 
Train Epoch: 13 [17/500 1088/32000 (3%)] Loss: 1.40081 (QuantReg: 12.52307) QuantErr: 12.52307 batch_time=0.39184 
Train Epoch: 13 [25/500 1600/32000 (5%)] Loss: 0.98622 (QuantReg: 12.26611) QuantErr: 12.26611 batch_time=0.38949 
Train Epoch: 13 [33/500 2112/32000 (7%)] Loss: 1.36656 (QuantReg: 12.77720) QuantErr: 12.77720 batch_time=0.38876 
Train Epoch: 13 [41/500 2624/32000 (8%)] Loss: 1.06460 (QuantReg: 13.04904) QuantErr: 13.04904 batch_time=0.39162 
Train Epoch: 13 [49/500 3136/32000 (10%)] Loss: 1.46831 (QuantReg: 12.75666) QuantErr: 12.75666 batch_time=0.38906 
Train Epoch: 13 [57/500 3648/32000 (11%)] Loss: 0.89374 (QuantReg: 12.79374) QuantErr: 12.79374 batch_time=0.39063 
Train Epoch: 13 [65/500 4160/32000 (13%)] Loss: 1.08820 (QuantReg: 12.00498) QuantErr: 12.00498 batch_time=0.39554 
Train Epoch: 13 [73/500 4672/32000 (15%)] Loss: 1.10491 (QuantReg: 12.46591) QuantErr: 12.46591 batch_time=0.41012 
Train Epoch: 13 [81/500 5184/32000 (16%)] Loss: 0.69102 (QuantReg: 13.06068) QuantErr: 13.06068 batch_time=0.38712 
Train Epoch: 13 [89/500 5696/32000 (18%)] Loss: 1.02560 (QuantReg: 13.33689) QuantErr: 13.33689 batch_time=0.38951 
Train Epoch: 13 [97/500 6208/32000 (19%)] Loss: 0.74906 (QuantReg: 12.84150) QuantErr: 12.84150 batch_time=0.39629 
Train Epoch: 13 [105/500 6720/32000 (21%)] Loss: 1.26650 (QuantReg: 12.89005) QuantErr: 12.89005 batch_time=0.39340 
Train Epoch: 13 [113/500 7232/32000 (23%)] Loss: 1.01008 (QuantReg: 13.29344) QuantErr: 13.29344 batch_time=0.38843 
Train Epoch: 13 [121/500 7744/32000 (24%)] Loss: 0.97749 (QuantReg: 12.72030) QuantErr: 12.72030 batch_time=0.39277 
Train Epoch: 13 [129/500 8256/32000 (26%)] Loss: 1.12266 (QuantReg: 12.71231) QuantErr: 12.71231 batch_time=0.39255 
Train Epoch: 13 [137/500 8768/32000 (27%)] Loss: 0.98374 (QuantReg: 13.34277) QuantErr: 13.34277 batch_time=0.40311 
Train Epoch: 13 [145/500 9280/32000 (29%)] Loss: 1.23936 (QuantReg: 12.66660) QuantErr: 12.66660 batch_time=0.38791 
Train Epoch: 13 [153/500 9792/32000 (31%)] Loss: 1.19477 (QuantReg: 12.58897) QuantErr: 12.58897 batch_time=0.38916 
Train Epoch: 13 [161/500 10304/32000 (32%)] Loss: 0.99579 (QuantReg: 12.66524) QuantErr: 12.66524 batch_time=0.39857 
Train Epoch: 13 [169/500 10816/32000 (34%)] Loss: 1.27014 (QuantReg: 13.11041) QuantErr: 13.11041 batch_time=0.38728 
Train Epoch: 13 [177/500 11328/32000 (35%)] Loss: 1.56068 (QuantReg: 12.85349) QuantErr: 12.85349 batch_time=0.39258 
Train Epoch: 13 [185/500 11840/32000 (37%)] Loss: 0.69714 (QuantReg: 12.85103) QuantErr: 12.85103 batch_time=0.38973 
Train Epoch: 13 [193/500 12352/32000 (39%)] Loss: 0.88172 (QuantReg: 13.12653) QuantErr: 13.12653 batch_time=0.37909 
Train Epoch: 13 [201/500 12864/32000 (40%)] Loss: 1.23617 (QuantReg: 12.58666) QuantErr: 12.58666 batch_time=0.39629 
Train Epoch: 13 [209/500 13376/32000 (42%)] Loss: 0.98388 (QuantReg: 13.27667) QuantErr: 13.27667 batch_time=0.38702 
Train Epoch: 13 [217/500 13888/32000 (43%)] Loss: 1.14773 (QuantReg: 12.83811) QuantErr: 12.83811 batch_time=0.38675 
Train Epoch: 13 [225/500 14400/32000 (45%)] Loss: 1.09040 (QuantReg: 13.12597) QuantErr: 13.12597 batch_time=0.39553 
Train Epoch: 13 [233/500 14912/32000 (47%)] Loss: 0.93957 (QuantReg: 12.91325) QuantErr: 12.91325 batch_time=0.38917 
Train Epoch: 13 [241/500 15424/32000 (48%)] Loss: 1.25898 (QuantReg: 12.71617) QuantErr: 12.71617 batch_time=0.40411 
Train Epoch: 13 [249/500 15936/32000 (50%)] Loss: 1.05090 (QuantReg: 12.68209) QuantErr: 12.68209 batch_time=0.40304 
Train Epoch: 13 [257/500 16448/32000 (51%)] Loss: 1.13591 (QuantReg: 13.20560) QuantErr: 13.20560 batch_time=0.40393 
Train Epoch: 13 [265/500 16960/32000 (53%)] Loss: 1.21798 (QuantReg: 12.99683) QuantErr: 12.99683 batch_time=0.39119 
Train Epoch: 13 [273/500 17472/32000 (55%)] Loss: 1.11185 (QuantReg: 13.14113) QuantErr: 13.14113 batch_time=0.39034 
Train Epoch: 13 [281/500 17984/32000 (56%)] Loss: 1.02656 (QuantReg: 12.97211) QuantErr: 12.97211 batch_time=0.39886 
Train Epoch: 13 [289/500 18496/32000 (58%)] Loss: 1.06902 (QuantReg: 12.70462) QuantErr: 12.70462 batch_time=0.40113 
Train Epoch: 13 [297/500 19008/32000 (59%)] Loss: 1.01203 (QuantReg: 12.95032) QuantErr: 12.95032 batch_time=0.39734 
Train Epoch: 13 [305/500 19520/32000 (61%)] Loss: 0.82455 (QuantReg: 13.26169) QuantErr: 13.26169 batch_time=0.45616 
Train Epoch: 13 [313/500 20032/32000 (63%)] Loss: 0.79101 (QuantReg: 13.33994) QuantErr: 13.33994 batch_time=0.40198 
Train Epoch: 13 [321/500 20544/32000 (64%)] Loss: 0.90756 (QuantReg: 12.83829) QuantErr: 12.83829 batch_time=0.41215 
Train Epoch: 13 [329/500 21056/32000 (66%)] Loss: 0.97956 (QuantReg: 12.85158) QuantErr: 12.85158 batch_time=0.40122 
Train Epoch: 13 [337/500 21568/32000 (67%)] Loss: 1.10276 (QuantReg: 12.92970) QuantErr: 12.92970 batch_time=0.41240 
Train Epoch: 13 [345/500 22080/32000 (69%)] Loss: 0.87933 (QuantReg: 12.86184) QuantErr: 12.86184 batch_time=0.39947 
Train Epoch: 13 [353/500 22592/32000 (71%)] Loss: 0.84327 (QuantReg: 13.02422) QuantErr: 13.02422 batch_time=0.40637 
Train Epoch: 13 [361/500 23104/32000 (72%)] Loss: 0.95313 (QuantReg: 12.75206) QuantErr: 12.75206 batch_time=0.38503 
Train Epoch: 13 [369/500 23616/32000 (74%)] Loss: 1.21523 (QuantReg: 12.90354) QuantErr: 12.90354 batch_time=0.38631 
Train Epoch: 13 [377/500 24128/32000 (75%)] Loss: 0.81167 (QuantReg: 13.28898) QuantErr: 13.28898 batch_time=0.39194 
Train Epoch: 13 [385/500 24640/32000 (77%)] Loss: 1.26625 (QuantReg: 12.96680) QuantErr: 12.96680 batch_time=0.39685 
Train Epoch: 13 [393/500 25152/32000 (79%)] Loss: 1.37772 (QuantReg: 12.83916) QuantErr: 12.83916 batch_time=0.38548 
Train Epoch: 13 [401/500 25664/32000 (80%)] Loss: 0.85873 (QuantReg: 13.04124) QuantErr: 13.04124 batch_time=0.44474 
Train Epoch: 13 [409/500 26176/32000 (82%)] Loss: 1.13418 (QuantReg: 12.90547) QuantErr: 12.90547 batch_time=0.38719 
Train Epoch: 13 [417/500 26688/32000 (83%)] Loss: 1.09785 (QuantReg: 13.06390) QuantErr: 13.06390 batch_time=0.39636 
Train Epoch: 13 [425/500 27200/32000 (85%)] Loss: 0.69296 (QuantReg: 13.29615) QuantErr: 13.29615 batch_time=0.40249 
Train Epoch: 13 [433/500 27712/32000 (87%)] Loss: 0.66067 (QuantReg: 13.14576) QuantErr: 13.14576 batch_time=0.90076 
Train Epoch: 13 [441/500 28224/32000 (88%)] Loss: 1.29857 (QuantReg: 12.41692) QuantErr: 12.41692 batch_time=0.44282 
Train Epoch: 13 [449/500 28736/32000 (90%)] Loss: 1.06932 (QuantReg: 12.99650) QuantErr: 12.99650 batch_time=0.40441 
Train Epoch: 13 [457/500 29248/32000 (91%)] Loss: 1.16611 (QuantReg: 13.18243) QuantErr: 13.18243 batch_time=0.39563 
Train Epoch: 13 [465/500 29760/32000 (93%)] Loss: 1.19400 (QuantReg: 13.01366) QuantErr: 13.01366 batch_time=0.38458 
Train Epoch: 13 [473/500 30272/32000 (95%)] Loss: 1.24309 (QuantReg: 13.19201) QuantErr: 13.19201 batch_time=0.40314 
Train Epoch: 13 [481/500 30784/32000 (96%)] Loss: 0.93496 (QuantReg: 13.07612) QuantErr: 13.07612 batch_time=0.40701 
Train Epoch: 13 [489/500 31296/32000 (98%)] Loss: 1.03509 (QuantReg: 13.36767) QuantErr: 13.36767 batch_time=0.39222 
Train Epoch: 13 [497/500 31808/32000 (99%)] Loss: 0.72593 (QuantReg: 12.99139) QuantErr: 12.99139 batch_time=0.38975 
Train Epoch: 13 codebook_update_time=1.68557
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch13.pth ...
Done in 6.294s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch13.pth ...
Done in 11.559s
removing stale ckpt [epoch 12] [took 0.35s]
 epoch          : 13
 loss           : 1.0626949184536933
 quant_reg      : 12.896626390457154
 quant_err      : 12.896626390457154
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.776
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.56070971315042
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.131
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.03734214402838
 mnt_best       : 41.56070971315042
 not_improved_count: 0
Train Epoch: 14 [1/500 64/32000 (0%)] Loss: 0.68736 (QuantReg: 12.84481) QuantErr: 12.84481 batch_time=19.30616 
Train Epoch: 14 [9/500 576/32000 (2%)] Loss: 1.23817 (QuantReg: 12.82197) QuantErr: 12.82197 batch_time=0.38849 
Train Epoch: 14 [17/500 1088/32000 (3%)] Loss: 0.97308 (QuantReg: 12.75551) QuantErr: 12.75551 batch_time=0.38404 
Train Epoch: 14 [25/500 1600/32000 (5%)] Loss: 1.10138 (QuantReg: 13.30764) QuantErr: 13.30764 batch_time=0.43844 
Train Epoch: 14 [33/500 2112/32000 (7%)] Loss: 1.66227 (QuantReg: 13.08138) QuantErr: 13.08138 batch_time=0.39766 
Train Epoch: 14 [41/500 2624/32000 (8%)] Loss: 1.09613 (QuantReg: 12.53916) QuantErr: 12.53916 batch_time=0.40065 
Train Epoch: 14 [49/500 3136/32000 (10%)] Loss: 0.82188 (QuantReg: 12.65287) QuantErr: 12.65287 batch_time=0.53288 
Train Epoch: 14 [57/500 3648/32000 (11%)] Loss: 0.66407 (QuantReg: 12.37156) QuantErr: 12.37156 batch_time=0.39530 
Train Epoch: 14 [65/500 4160/32000 (13%)] Loss: 0.85046 (QuantReg: 12.94370) QuantErr: 12.94370 batch_time=0.38463 
Train Epoch: 14 [73/500 4672/32000 (15%)] Loss: 1.03197 (QuantReg: 12.27057) QuantErr: 12.27057 batch_time=0.41852 
Train Epoch: 14 [81/500 5184/32000 (16%)] Loss: 0.84728 (QuantReg: 12.71762) QuantErr: 12.71762 batch_time=0.38323 
Train Epoch: 14 [89/500 5696/32000 (18%)] Loss: 0.98792 (QuantReg: 12.85538) QuantErr: 12.85538 batch_time=0.38993 
Train Epoch: 14 [97/500 6208/32000 (19%)] Loss: 0.87420 (QuantReg: 12.26320) QuantErr: 12.26320 batch_time=0.39463 
Train Epoch: 14 [105/500 6720/32000 (21%)] Loss: 0.87900 (QuantReg: 12.94607) QuantErr: 12.94607 batch_time=0.45638 
Train Epoch: 14 [113/500 7232/32000 (23%)] Loss: 0.93561 (QuantReg: 12.76933) QuantErr: 12.76933 batch_time=0.55234 
Train Epoch: 14 [121/500 7744/32000 (24%)] Loss: 0.65878 (QuantReg: 12.40592) QuantErr: 12.40592 batch_time=0.38917 
Train Epoch: 14 [129/500 8256/32000 (26%)] Loss: 1.08221 (QuantReg: 12.33177) QuantErr: 12.33177 batch_time=0.41761 
Train Epoch: 14 [137/500 8768/32000 (27%)] Loss: 0.56438 (QuantReg: 13.26080) QuantErr: 13.26080 batch_time=0.39410 
Train Epoch: 14 [145/500 9280/32000 (29%)] Loss: 1.14557 (QuantReg: 12.44625) QuantErr: 12.44625 batch_time=0.38829 
Train Epoch: 14 [153/500 9792/32000 (31%)] Loss: 1.05373 (QuantReg: 13.03015) QuantErr: 13.03015 batch_time=0.94808 
Train Epoch: 14 [161/500 10304/32000 (32%)] Loss: 1.06986 (QuantReg: 13.25511) QuantErr: 13.25511 batch_time=0.39052 
Train Epoch: 14 [169/500 10816/32000 (34%)] Loss: 0.88552 (QuantReg: 12.55674) QuantErr: 12.55674 batch_time=0.40902 
Train Epoch: 14 [177/500 11328/32000 (35%)] Loss: 0.92341 (QuantReg: 12.13211) QuantErr: 12.13211 batch_time=0.53092 
Train Epoch: 14 [185/500 11840/32000 (37%)] Loss: 1.04381 (QuantReg: 13.10000) QuantErr: 13.10000 batch_time=0.40067 
Train Epoch: 14 [193/500 12352/32000 (39%)] Loss: 1.31220 (QuantReg: 13.07881) QuantErr: 13.07881 batch_time=0.44834 
Train Epoch: 14 [201/500 12864/32000 (40%)] Loss: 0.87926 (QuantReg: 13.13707) QuantErr: 13.13707 batch_time=0.40554 
Train Epoch: 14 [209/500 13376/32000 (42%)] Loss: 0.87590 (QuantReg: 12.63693) QuantErr: 12.63693 batch_time=0.40410 
Train Epoch: 14 [217/500 13888/32000 (43%)] Loss: 0.71155 (QuantReg: 13.23044) QuantErr: 13.23044 batch_time=0.43327 
Train Epoch: 14 [225/500 14400/32000 (45%)] Loss: 1.55245 (QuantReg: 12.82584) QuantErr: 12.82584 batch_time=0.40452 
Train Epoch: 14 [233/500 14912/32000 (47%)] Loss: 0.69937 (QuantReg: 13.19548) QuantErr: 13.19548 batch_time=0.40064 
Train Epoch: 14 [241/500 15424/32000 (48%)] Loss: 0.70480 (QuantReg: 13.30609) QuantErr: 13.30609 batch_time=0.53391 
Train Epoch: 14 [249/500 15936/32000 (50%)] Loss: 1.06548 (QuantReg: 13.33988) QuantErr: 13.33988 batch_time=0.43038 
Train Epoch: 14 [257/500 16448/32000 (51%)] Loss: 0.83336 (QuantReg: 13.07434) QuantErr: 13.07434 batch_time=0.44058 
Train Epoch: 14 [265/500 16960/32000 (53%)] Loss: 1.04807 (QuantReg: 13.21870) QuantErr: 13.21870 batch_time=0.39652 
Train Epoch: 14 [273/500 17472/32000 (55%)] Loss: 0.68071 (QuantReg: 13.46329) QuantErr: 13.46329 batch_time=0.40474 
Train Epoch: 14 [281/500 17984/32000 (56%)] Loss: 1.22912 (QuantReg: 12.80372) QuantErr: 12.80372 batch_time=0.40642 
Train Epoch: 14 [289/500 18496/32000 (58%)] Loss: 1.13191 (QuantReg: 12.75949) QuantErr: 12.75949 batch_time=0.39726 
Train Epoch: 14 [297/500 19008/32000 (59%)] Loss: 1.29583 (QuantReg: 13.05863) QuantErr: 13.05863 batch_time=0.42641 
Train Epoch: 14 [305/500 19520/32000 (61%)] Loss: 1.52884 (QuantReg: 12.52695) QuantErr: 12.52695 batch_time=0.57072 
Train Epoch: 14 [313/500 20032/32000 (63%)] Loss: 1.27588 (QuantReg: 12.94684) QuantErr: 12.94684 batch_time=0.38972 
Train Epoch: 14 [321/500 20544/32000 (64%)] Loss: 0.82952 (QuantReg: 12.73508) QuantErr: 12.73508 batch_time=0.39820 
Train Epoch: 14 [329/500 21056/32000 (66%)] Loss: 0.89916 (QuantReg: 12.84943) QuantErr: 12.84943 batch_time=0.46343 
Train Epoch: 14 [337/500 21568/32000 (67%)] Loss: 0.89338 (QuantReg: 13.06007) QuantErr: 13.06007 batch_time=0.39429 
Train Epoch: 14 [345/500 22080/32000 (69%)] Loss: 0.85412 (QuantReg: 12.89760) QuantErr: 12.89760 batch_time=0.41635 
Train Epoch: 14 [353/500 22592/32000 (71%)] Loss: 1.52823 (QuantReg: 13.01693) QuantErr: 13.01693 batch_time=0.39544 
Train Epoch: 14 [361/500 23104/32000 (72%)] Loss: 1.01112 (QuantReg: 12.87317) QuantErr: 12.87317 batch_time=0.39133 
Train Epoch: 14 [369/500 23616/32000 (74%)] Loss: 0.92057 (QuantReg: 13.14659) QuantErr: 13.14659 batch_time=0.51474 
Train Epoch: 14 [377/500 24128/32000 (75%)] Loss: 1.49933 (QuantReg: 12.65477) QuantErr: 12.65477 batch_time=0.38713 
Train Epoch: 14 [385/500 24640/32000 (77%)] Loss: 0.88106 (QuantReg: 13.04144) QuantErr: 13.04144 batch_time=0.38350 
Train Epoch: 14 [393/500 25152/32000 (79%)] Loss: 0.85007 (QuantReg: 12.89313) QuantErr: 12.89313 batch_time=0.38355 
Train Epoch: 14 [401/500 25664/32000 (80%)] Loss: 0.75574 (QuantReg: 12.85624) QuantErr: 12.85624 batch_time=0.39882 
Train Epoch: 14 [409/500 26176/32000 (82%)] Loss: 0.52315 (QuantReg: 13.12875) QuantErr: 13.12875 batch_time=0.39071 
Train Epoch: 14 [417/500 26688/32000 (83%)] Loss: 0.72928 (QuantReg: 12.85184) QuantErr: 12.85184 batch_time=0.39189 
Train Epoch: 14 [425/500 27200/32000 (85%)] Loss: 1.16823 (QuantReg: 12.80310) QuantErr: 12.80310 batch_time=0.39772 
Train Epoch: 14 [433/500 27712/32000 (87%)] Loss: 0.78786 (QuantReg: 13.04401) QuantErr: 13.04401 batch_time=0.54632 
Train Epoch: 14 [441/500 28224/32000 (88%)] Loss: 1.13659 (QuantReg: 13.16058) QuantErr: 13.16058 batch_time=0.38744 
Train Epoch: 14 [449/500 28736/32000 (90%)] Loss: 1.14371 (QuantReg: 12.63507) QuantErr: 12.63507 batch_time=0.40441 
Train Epoch: 14 [457/500 29248/32000 (91%)] Loss: 1.10862 (QuantReg: 13.11095) QuantErr: 13.11095 batch_time=0.39224 
Train Epoch: 14 [465/500 29760/32000 (93%)] Loss: 1.21822 (QuantReg: 13.37037) QuantErr: 13.37037 batch_time=0.38674 
Train Epoch: 14 [473/500 30272/32000 (95%)] Loss: 1.33649 (QuantReg: 12.98519) QuantErr: 12.98519 batch_time=0.45887 
Train Epoch: 14 [481/500 30784/32000 (96%)] Loss: 1.29780 (QuantReg: 13.19482) QuantErr: 13.19482 batch_time=0.41862 
Train Epoch: 14 [489/500 31296/32000 (98%)] Loss: 0.75756 (QuantReg: 12.71639) QuantErr: 12.71639 batch_time=0.39008 
Train Epoch: 14 [497/500 31808/32000 (99%)] Loss: 0.90483 (QuantReg: 12.92018) QuantErr: 12.92018 batch_time=0.50748 
Train Epoch: 14 codebook_update_time=2.04340
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch14.pth ...
Done in 6.770s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch14.pth ...
Done in 11.566s
removing stale ckpt [epoch 13] [took 0.03s]
 epoch          : 14
 loss           : 1.0397906123399734
 quant_reg      : 12.950303359985352
 quant_err      : 12.950303359985352
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.531
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.49268616934643
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.8775
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.36728798084133
 mnt_best       : 42.49268616934643
 not_improved_count: 0
Train Epoch: 15 [1/500 64/32000 (0%)] Loss: 1.05749 (QuantReg: 12.93161) QuantErr: 12.93161 batch_time=20.54625 
Train Epoch: 15 [9/500 576/32000 (2%)] Loss: 1.53190 (QuantReg: 13.09593) QuantErr: 13.09593 batch_time=0.38774 
Train Epoch: 15 [17/500 1088/32000 (3%)] Loss: 1.44095 (QuantReg: 12.65304) QuantErr: 12.65304 batch_time=0.42932 
Train Epoch: 15 [25/500 1600/32000 (5%)] Loss: 0.72098 (QuantReg: 12.90444) QuantErr: 12.90444 batch_time=0.39038 
Train Epoch: 15 [33/500 2112/32000 (7%)] Loss: 1.13929 (QuantReg: 12.92576) QuantErr: 12.92576 batch_time=0.41184 
Train Epoch: 15 [41/500 2624/32000 (8%)] Loss: 0.96163 (QuantReg: 13.36589) QuantErr: 13.36589 batch_time=0.40060 
Train Epoch: 15 [49/500 3136/32000 (10%)] Loss: 0.87840 (QuantReg: 13.16962) QuantErr: 13.16962 batch_time=0.58296 
Train Epoch: 15 [57/500 3648/32000 (11%)] Loss: 1.20720 (QuantReg: 12.45032) QuantErr: 12.45032 batch_time=0.39212 
Train Epoch: 15 [65/500 4160/32000 (13%)] Loss: 0.95322 (QuantReg: 12.60510) QuantErr: 12.60510 batch_time=0.38267 
Train Epoch: 15 [73/500 4672/32000 (15%)] Loss: 1.18855 (QuantReg: 12.65199) QuantErr: 12.65199 batch_time=0.41671 
Train Epoch: 15 [81/500 5184/32000 (16%)] Loss: 0.75778 (QuantReg: 12.87656) QuantErr: 12.87656 batch_time=0.41111 
Train Epoch: 15 [89/500 5696/32000 (18%)] Loss: 0.95906 (QuantReg: 12.85662) QuantErr: 12.85662 batch_time=0.40046 
Train Epoch: 15 [97/500 6208/32000 (19%)] Loss: 1.53772 (QuantReg: 12.85017) QuantErr: 12.85017 batch_time=0.40399 
Train Epoch: 15 [105/500 6720/32000 (21%)] Loss: 1.15783 (QuantReg: 12.66537) QuantErr: 12.66537 batch_time=0.40900 
Train Epoch: 15 [113/500 7232/32000 (23%)] Loss: 0.91896 (QuantReg: 12.56261) QuantErr: 12.56261 batch_time=0.56968 
Train Epoch: 15 [121/500 7744/32000 (24%)] Loss: 1.21235 (QuantReg: 13.14155) QuantErr: 13.14155 batch_time=0.41605 
Train Epoch: 15 [129/500 8256/32000 (26%)] Loss: 0.56342 (QuantReg: 12.65956) QuantErr: 12.65956 batch_time=0.39720 
Train Epoch: 15 [137/500 8768/32000 (27%)] Loss: 1.19469 (QuantReg: 13.73551) QuantErr: 13.73551 batch_time=0.38632 
Train Epoch: 15 [145/500 9280/32000 (29%)] Loss: 1.18871 (QuantReg: 12.89405) QuantErr: 12.89405 batch_time=0.38731 
Train Epoch: 15 [153/500 9792/32000 (31%)] Loss: 0.78223 (QuantReg: 12.76230) QuantErr: 12.76230 batch_time=0.38715 
Train Epoch: 15 [161/500 10304/32000 (32%)] Loss: 0.93619 (QuantReg: 13.17698) QuantErr: 13.17698 batch_time=0.40248 
Train Epoch: 15 [169/500 10816/32000 (34%)] Loss: 0.68552 (QuantReg: 13.14393) QuantErr: 13.14393 batch_time=0.46944 
Train Epoch: 15 [177/500 11328/32000 (35%)] Loss: 0.99882 (QuantReg: 13.07753) QuantErr: 13.07753 batch_time=0.60779 
Train Epoch: 15 [185/500 11840/32000 (37%)] Loss: 1.02506 (QuantReg: 12.81134) QuantErr: 12.81134 batch_time=0.40316 
Train Epoch: 15 [193/500 12352/32000 (39%)] Loss: 0.55626 (QuantReg: 13.16627) QuantErr: 13.16627 batch_time=0.40748 
Train Epoch: 15 [201/500 12864/32000 (40%)] Loss: 1.16192 (QuantReg: 13.20216) QuantErr: 13.20216 batch_time=0.38997 
Train Epoch: 15 [209/500 13376/32000 (42%)] Loss: 0.60018 (QuantReg: 13.07682) QuantErr: 13.07682 batch_time=0.38861 
Train Epoch: 15 [217/500 13888/32000 (43%)] Loss: 0.70214 (QuantReg: 13.01488) QuantErr: 13.01488 batch_time=0.40086 
Train Epoch: 15 [225/500 14400/32000 (45%)] Loss: 1.26493 (QuantReg: 12.46904) QuantErr: 12.46904 batch_time=0.39038 
Train Epoch: 15 [233/500 14912/32000 (47%)] Loss: 0.88753 (QuantReg: 13.37904) QuantErr: 13.37904 batch_time=0.39516 
Train Epoch: 15 [241/500 15424/32000 (48%)] Loss: 0.94002 (QuantReg: 12.91570) QuantErr: 12.91570 batch_time=0.57452 
Train Epoch: 15 [249/500 15936/32000 (50%)] Loss: 1.07013 (QuantReg: 13.13585) QuantErr: 13.13585 batch_time=0.40218 
Train Epoch: 15 [257/500 16448/32000 (51%)] Loss: 0.90009 (QuantReg: 13.44383) QuantErr: 13.44383 batch_time=0.39667 
Train Epoch: 15 [265/500 16960/32000 (53%)] Loss: 1.25333 (QuantReg: 12.64196) QuantErr: 12.64196 batch_time=0.40217 
Train Epoch: 15 [273/500 17472/32000 (55%)] Loss: 0.93602 (QuantReg: 12.80607) QuantErr: 12.80607 batch_time=0.40453 
Train Epoch: 15 [281/500 17984/32000 (56%)] Loss: 1.11091 (QuantReg: 12.99409) QuantErr: 12.99409 batch_time=0.39768 
Train Epoch: 15 [289/500 18496/32000 (58%)] Loss: 1.01929 (QuantReg: 13.15666) QuantErr: 13.15666 batch_time=0.39836 
Train Epoch: 15 [297/500 19008/32000 (59%)] Loss: 0.85489 (QuantReg: 13.22733) QuantErr: 13.22733 batch_time=0.42559 
Train Epoch: 15 [305/500 19520/32000 (61%)] Loss: 1.29954 (QuantReg: 12.73009) QuantErr: 12.73009 batch_time=0.56028 
Train Epoch: 15 [313/500 20032/32000 (63%)] Loss: 0.95164 (QuantReg: 13.94598) QuantErr: 13.94598 batch_time=0.38935 
Train Epoch: 15 [321/500 20544/32000 (64%)] Loss: 0.90035 (QuantReg: 12.88814) QuantErr: 12.88814 batch_time=0.39505 
Train Epoch: 15 [329/500 21056/32000 (66%)] Loss: 1.15137 (QuantReg: 13.20420) QuantErr: 13.20420 batch_time=0.39613 
Train Epoch: 15 [337/500 21568/32000 (67%)] Loss: 0.69752 (QuantReg: 13.60292) QuantErr: 13.60292 batch_time=0.41229 
Train Epoch: 15 [345/500 22080/32000 (69%)] Loss: 1.08496 (QuantReg: 12.97218) QuantErr: 12.97218 batch_time=0.40289 
Train Epoch: 15 [353/500 22592/32000 (71%)] Loss: 0.99414 (QuantReg: 12.79582) QuantErr: 12.79582 batch_time=0.39628 
Train Epoch: 15 [361/500 23104/32000 (72%)] Loss: 0.61783 (QuantReg: 13.20556) QuantErr: 13.20556 batch_time=0.38975 
Train Epoch: 15 [369/500 23616/32000 (74%)] Loss: 0.82647 (QuantReg: 12.94346) QuantErr: 12.94346 batch_time=0.58801 
Train Epoch: 15 [377/500 24128/32000 (75%)] Loss: 1.10365 (QuantReg: 12.34817) QuantErr: 12.34817 batch_time=0.44831 
Train Epoch: 15 [385/500 24640/32000 (77%)] Loss: 0.78180 (QuantReg: 12.78996) QuantErr: 12.78996 batch_time=0.38977 
Train Epoch: 15 [393/500 25152/32000 (79%)] Loss: 1.38512 (QuantReg: 12.56638) QuantErr: 12.56638 batch_time=0.39213 
Train Epoch: 15 [401/500 25664/32000 (80%)] Loss: 1.31014 (QuantReg: 12.98077) QuantErr: 12.98077 batch_time=0.41080 
Train Epoch: 15 [409/500 26176/32000 (82%)] Loss: 0.67952 (QuantReg: 13.14472) QuantErr: 13.14472 batch_time=0.39115 
Train Epoch: 15 [417/500 26688/32000 (83%)] Loss: 1.05832 (QuantReg: 12.67521) QuantErr: 12.67521 batch_time=0.42751 
Train Epoch: 15 [425/500 27200/32000 (85%)] Loss: 1.16278 (QuantReg: 13.11390) QuantErr: 13.11390 batch_time=0.44408 
Train Epoch: 15 [433/500 27712/32000 (87%)] Loss: 1.04257 (QuantReg: 13.32825) QuantErr: 13.32825 batch_time=0.56435 
Train Epoch: 15 [441/500 28224/32000 (88%)] Loss: 1.00630 (QuantReg: 12.83976) QuantErr: 12.83976 batch_time=0.45136 
Train Epoch: 15 [449/500 28736/32000 (90%)] Loss: 0.70467 (QuantReg: 12.86818) QuantErr: 12.86818 batch_time=0.41459 
Train Epoch: 15 [457/500 29248/32000 (91%)] Loss: 1.01836 (QuantReg: 12.82392) QuantErr: 12.82392 batch_time=0.42176 
Train Epoch: 15 [465/500 29760/32000 (93%)] Loss: 1.07649 (QuantReg: 12.79010) QuantErr: 12.79010 batch_time=0.40708 
Train Epoch: 15 [473/500 30272/32000 (95%)] Loss: 1.32432 (QuantReg: 12.85852) QuantErr: 12.85852 batch_time=0.39824 
Train Epoch: 15 [481/500 30784/32000 (96%)] Loss: 0.58652 (QuantReg: 12.96158) QuantErr: 12.96158 batch_time=0.40951 
Train Epoch: 15 [489/500 31296/32000 (98%)] Loss: 1.02232 (QuantReg: 13.18983) QuantErr: 13.18983 batch_time=0.40213 
Train Epoch: 15 [497/500 31808/32000 (99%)] Loss: 0.85944 (QuantReg: 13.25418) QuantErr: 13.25418 batch_time=0.55624 
Train Epoch: 15 codebook_update_time=1.66840
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch15.pth ...
Done in 6.516s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 0.997815253674984
 quant_reg      : 12.965175256729125
 quant_err      : 12.965175256729125
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.452
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.22482610390464
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3925
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.64865639402134
 mnt_best       : 42.49268616934643
 not_improved_count: 1
Train Epoch: 16 [1/500 64/32000 (0%)] Loss: 0.90088 (QuantReg: 12.86382) QuantErr: 12.86382 batch_time=22.80692 
Train Epoch: 16 [9/500 576/32000 (2%)] Loss: 1.15866 (QuantReg: 12.64550) QuantErr: 12.64550 batch_time=0.40128 
Train Epoch: 16 [17/500 1088/32000 (3%)] Loss: 0.85071 (QuantReg: 13.08890) QuantErr: 13.08890 batch_time=0.39602 
Train Epoch: 16 [25/500 1600/32000 (5%)] Loss: 0.81016 (QuantReg: 13.20847) QuantErr: 13.20847 batch_time=0.38243 
Train Epoch: 16 [33/500 2112/32000 (7%)] Loss: 0.74242 (QuantReg: 13.13359) QuantErr: 13.13359 batch_time=0.37714 
Train Epoch: 16 [41/500 2624/32000 (8%)] Loss: 1.40646 (QuantReg: 12.76736) QuantErr: 12.76736 batch_time=0.40106 
Train Epoch: 16 [49/500 3136/32000 (10%)] Loss: 0.75529 (QuantReg: 12.54734) QuantErr: 12.54734 batch_time=0.45520 
Train Epoch: 16 [57/500 3648/32000 (11%)] Loss: 0.95848 (QuantReg: 12.64817) QuantErr: 12.64817 batch_time=0.38562 
Train Epoch: 16 [65/500 4160/32000 (13%)] Loss: 0.58827 (QuantReg: 12.87225) QuantErr: 12.87225 batch_time=1.79307 
Train Epoch: 16 [73/500 4672/32000 (15%)] Loss: 1.14119 (QuantReg: 12.66224) QuantErr: 12.66224 batch_time=0.40870 
Train Epoch: 16 [81/500 5184/32000 (16%)] Loss: 0.61772 (QuantReg: 13.06564) QuantErr: 13.06564 batch_time=0.65287 
Train Epoch: 16 [89/500 5696/32000 (18%)] Loss: 0.88961 (QuantReg: 12.80258) QuantErr: 12.80258 batch_time=0.41453 
Train Epoch: 16 [97/500 6208/32000 (19%)] Loss: 0.92783 (QuantReg: 12.89871) QuantErr: 12.89871 batch_time=0.38164 
Train Epoch: 16 [105/500 6720/32000 (21%)] Loss: 1.14801 (QuantReg: 13.07184) QuantErr: 13.07184 batch_time=0.38720 
Train Epoch: 16 [113/500 7232/32000 (23%)] Loss: 1.47132 (QuantReg: 12.67714) QuantErr: 12.67714 batch_time=0.41795 
Train Epoch: 16 [121/500 7744/32000 (24%)] Loss: 1.08812 (QuantReg: 13.27251) QuantErr: 13.27251 batch_time=0.38603 
Train Epoch: 16 [129/500 8256/32000 (26%)] Loss: 1.03270 (QuantReg: 13.06495) QuantErr: 13.06495 batch_time=1.78671 
Train Epoch: 16 [137/500 8768/32000 (27%)] Loss: 1.25143 (QuantReg: 12.95358) QuantErr: 12.95358 batch_time=0.38612 
Train Epoch: 16 [145/500 9280/32000 (29%)] Loss: 0.98770 (QuantReg: 13.01812) QuantErr: 13.01812 batch_time=0.40988 
Train Epoch: 16 [153/500 9792/32000 (31%)] Loss: 1.06444 (QuantReg: 12.60353) QuantErr: 12.60353 batch_time=0.38075 
Train Epoch: 16 [161/500 10304/32000 (32%)] Loss: 1.14753 (QuantReg: 13.11214) QuantErr: 13.11214 batch_time=0.40818 
Train Epoch: 16 [169/500 10816/32000 (34%)] Loss: 0.61063 (QuantReg: 13.08566) QuantErr: 13.08566 batch_time=0.45009 
Train Epoch: 16 [177/500 11328/32000 (35%)] Loss: 1.03066 (QuantReg: 12.76717) QuantErr: 12.76717 batch_time=0.37976 
Train Epoch: 16 [185/500 11840/32000 (37%)] Loss: 1.16011 (QuantReg: 12.85596) QuantErr: 12.85596 batch_time=0.38175 
Train Epoch: 16 [193/500 12352/32000 (39%)] Loss: 0.97507 (QuantReg: 13.45162) QuantErr: 13.45162 batch_time=1.73205 
Train Epoch: 16 [201/500 12864/32000 (40%)] Loss: 1.12043 (QuantReg: 12.76464) QuantErr: 12.76464 batch_time=0.39064 
Train Epoch: 16 [209/500 13376/32000 (42%)] Loss: 0.94629 (QuantReg: 12.94461) QuantErr: 12.94461 batch_time=0.39752 
Train Epoch: 16 [217/500 13888/32000 (43%)] Loss: 1.43087 (QuantReg: 13.30768) QuantErr: 13.30768 batch_time=0.52559 
Train Epoch: 16 [225/500 14400/32000 (45%)] Loss: 0.87389 (QuantReg: 13.13765) QuantErr: 13.13765 batch_time=0.39302 
Train Epoch: 16 [233/500 14912/32000 (47%)] Loss: 0.57542 (QuantReg: 13.31496) QuantErr: 13.31496 batch_time=0.38596 
Train Epoch: 16 [241/500 15424/32000 (48%)] Loss: 0.82009 (QuantReg: 12.85362) QuantErr: 12.85362 batch_time=0.39722 
Train Epoch: 16 [249/500 15936/32000 (50%)] Loss: 0.75410 (QuantReg: 12.89937) QuantErr: 12.89937 batch_time=0.38668 
Train Epoch: 16 [257/500 16448/32000 (51%)] Loss: 0.80417 (QuantReg: 13.21384) QuantErr: 13.21384 batch_time=1.78774 
Train Epoch: 16 [265/500 16960/32000 (53%)] Loss: 1.32839 (QuantReg: 13.15132) QuantErr: 13.15132 batch_time=0.64874 
Train Epoch: 16 [273/500 17472/32000 (55%)] Loss: 0.70862 (QuantReg: 13.20114) QuantErr: 13.20114 batch_time=0.40237 
Train Epoch: 16 [281/500 17984/32000 (56%)] Loss: 0.82095 (QuantReg: 12.77641) QuantErr: 12.77641 batch_time=0.45707 
Train Epoch: 16 [289/500 18496/32000 (58%)] Loss: 0.75034 (QuantReg: 12.78674) QuantErr: 12.78674 batch_time=0.38289 
Train Epoch: 16 [297/500 19008/32000 (59%)] Loss: 1.06059 (QuantReg: 13.42411) QuantErr: 13.42411 batch_time=0.43801 
Train Epoch: 16 [305/500 19520/32000 (61%)] Loss: 1.41750 (QuantReg: 12.36117) QuantErr: 12.36117 batch_time=0.40545 
Train Epoch: 16 [313/500 20032/32000 (63%)] Loss: 0.93299 (QuantReg: 12.92408) QuantErr: 12.92408 batch_time=0.41231 
Train Epoch: 16 [321/500 20544/32000 (64%)] Loss: 0.97069 (QuantReg: 12.93828) QuantErr: 12.93828 batch_time=1.75544 
Train Epoch: 16 [329/500 21056/32000 (66%)] Loss: 0.80404 (QuantReg: 13.20405) QuantErr: 13.20405 batch_time=0.40024 
Train Epoch: 16 [337/500 21568/32000 (67%)] Loss: 0.91292 (QuantReg: 12.61716) QuantErr: 12.61716 batch_time=0.44593 
Train Epoch: 16 [345/500 22080/32000 (69%)] Loss: 0.91596 (QuantReg: 13.36712) QuantErr: 13.36712 batch_time=0.39937 
Train Epoch: 16 [353/500 22592/32000 (71%)] Loss: 1.10733 (QuantReg: 13.46489) QuantErr: 13.46489 batch_time=0.40277 
Train Epoch: 16 [361/500 23104/32000 (72%)] Loss: 0.58684 (QuantReg: 13.49555) QuantErr: 13.49555 batch_time=0.40552 
Train Epoch: 16 [369/500 23616/32000 (74%)] Loss: 1.15807 (QuantReg: 13.24751) QuantErr: 13.24751 batch_time=0.38778 
Train Epoch: 16 [377/500 24128/32000 (75%)] Loss: 1.08876 (QuantReg: 13.23590) QuantErr: 13.23590 batch_time=0.40589 
Train Epoch: 16 [385/500 24640/32000 (77%)] Loss: 1.10612 (QuantReg: 13.20037) QuantErr: 13.20037 batch_time=1.75920 
Train Epoch: 16 [393/500 25152/32000 (79%)] Loss: 0.79619 (QuantReg: 13.35864) QuantErr: 13.35864 batch_time=0.44941 
Train Epoch: 16 [401/500 25664/32000 (80%)] Loss: 0.69119 (QuantReg: 13.50764) QuantErr: 13.50764 batch_time=0.45938 
Train Epoch: 16 [409/500 26176/32000 (82%)] Loss: 1.05718 (QuantReg: 13.08185) QuantErr: 13.08185 batch_time=0.39257 
Train Epoch: 16 [417/500 26688/32000 (83%)] Loss: 0.97217 (QuantReg: 13.05024) QuantErr: 13.05024 batch_time=0.38265 
Train Epoch: 16 [425/500 27200/32000 (85%)] Loss: 1.16141 (QuantReg: 13.12480) QuantErr: 13.12480 batch_time=0.40343 
Train Epoch: 16 [433/500 27712/32000 (87%)] Loss: 1.39476 (QuantReg: 13.26619) QuantErr: 13.26619 batch_time=0.40635 
Train Epoch: 16 [441/500 28224/32000 (88%)] Loss: 0.90029 (QuantReg: 13.12047) QuantErr: 13.12047 batch_time=0.39365 
Train Epoch: 16 [449/500 28736/32000 (90%)] Loss: 1.36449 (QuantReg: 13.52673) QuantErr: 13.52673 batch_time=2.02450 
Train Epoch: 16 [457/500 29248/32000 (91%)] Loss: 0.63226 (QuantReg: 13.08657) QuantErr: 13.08657 batch_time=0.40673 
Train Epoch: 16 [465/500 29760/32000 (93%)] Loss: 0.66974 (QuantReg: 12.95016) QuantErr: 12.95016 batch_time=0.39652 
Train Epoch: 16 [473/500 30272/32000 (95%)] Loss: 1.21869 (QuantReg: 12.95069) QuantErr: 12.95069 batch_time=0.38583 
Train Epoch: 16 [481/500 30784/32000 (96%)] Loss: 0.67329 (QuantReg: 13.15478) QuantErr: 13.15478 batch_time=0.39882 
Train Epoch: 16 [489/500 31296/32000 (98%)] Loss: 1.33645 (QuantReg: 12.94095) QuantErr: 12.94095 batch_time=0.40011 
Train Epoch: 16 [497/500 31808/32000 (99%)] Loss: 0.98641 (QuantReg: 13.14950) QuantErr: 13.14950 batch_time=0.40023 
Train Epoch: 16 codebook_update_time=1.80773
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch16.pth ...
Done in 4.780s
removing stale ckpt [epoch 15] [took 0.08s]
 epoch          : 16
 loss           : 0.9708126128315926
 quant_reg      : 13.00534514427185
 quant_err      : 13.00534514427185
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.742
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.16030067015376
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.476
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.90181144778343
 mnt_best       : 42.49268616934643
 not_improved_count: 2
Train Epoch: 17 [1/500 64/32000 (0%)] Loss: 0.67710 (QuantReg: 13.41166) QuantErr: 13.41166 batch_time=25.95196 
Train Epoch: 17 [9/500 576/32000 (2%)] Loss: 1.11244 (QuantReg: 11.98628) QuantErr: 11.98628 batch_time=0.37970 
Train Epoch: 17 [17/500 1088/32000 (3%)] Loss: 0.87949 (QuantReg: 12.65136) QuantErr: 12.65136 batch_time=0.37992 
Train Epoch: 17 [25/500 1600/32000 (5%)] Loss: 0.73309 (QuantReg: 12.64164) QuantErr: 12.64164 batch_time=0.38320 
Train Epoch: 17 [33/500 2112/32000 (7%)] Loss: 1.27905 (QuantReg: 13.08990) QuantErr: 13.08990 batch_time=0.39829 
Train Epoch: 17 [41/500 2624/32000 (8%)] Loss: 0.76880 (QuantReg: 12.81402) QuantErr: 12.81402 batch_time=0.39345 
Train Epoch: 17 [49/500 3136/32000 (10%)] Loss: 0.92271 (QuantReg: 12.77721) QuantErr: 12.77721 batch_time=0.38212 
Train Epoch: 17 [57/500 3648/32000 (11%)] Loss: 1.22352 (QuantReg: 12.91384) QuantErr: 12.91384 batch_time=0.42063 
Train Epoch: 17 [65/500 4160/32000 (13%)] Loss: 0.93812 (QuantReg: 13.01360) QuantErr: 13.01360 batch_time=1.15462 
Train Epoch: 17 [73/500 4672/32000 (15%)] Loss: 0.98897 (QuantReg: 12.71039) QuantErr: 12.71039 batch_time=0.40539 
Train Epoch: 17 [81/500 5184/32000 (16%)] Loss: 0.79658 (QuantReg: 13.36845) QuantErr: 13.36845 batch_time=0.40954 
Train Epoch: 17 [89/500 5696/32000 (18%)] Loss: 1.01571 (QuantReg: 12.67139) QuantErr: 12.67139 batch_time=0.87122 
Train Epoch: 17 [97/500 6208/32000 (19%)] Loss: 1.24181 (QuantReg: 12.79545) QuantErr: 12.79545 batch_time=0.39385 
Train Epoch: 17 [105/500 6720/32000 (21%)] Loss: 0.78411 (QuantReg: 12.57289) QuantErr: 12.57289 batch_time=0.38795 
Train Epoch: 17 [113/500 7232/32000 (23%)] Loss: 0.86722 (QuantReg: 12.75309) QuantErr: 12.75309 batch_time=0.46127 
Train Epoch: 17 [121/500 7744/32000 (24%)] Loss: 0.95374 (QuantReg: 12.65777) QuantErr: 12.65777 batch_time=0.40660 
Train Epoch: 17 [129/500 8256/32000 (26%)] Loss: 0.75112 (QuantReg: 13.24324) QuantErr: 13.24324 batch_time=1.16521 
Train Epoch: 17 [137/500 8768/32000 (27%)] Loss: 0.97092 (QuantReg: 12.77891) QuantErr: 12.77891 batch_time=0.38793 
Train Epoch: 17 [145/500 9280/32000 (29%)] Loss: 0.88786 (QuantReg: 13.44379) QuantErr: 13.44379 batch_time=0.39003 
Train Epoch: 17 [153/500 9792/32000 (31%)] Loss: 0.62354 (QuantReg: 12.89916) QuantErr: 12.89916 batch_time=0.39725 
Train Epoch: 17 [161/500 10304/32000 (32%)] Loss: 0.89712 (QuantReg: 13.24710) QuantErr: 13.24710 batch_time=0.39466 
Train Epoch: 17 [169/500 10816/32000 (34%)] Loss: 1.02876 (QuantReg: 12.84252) QuantErr: 12.84252 batch_time=0.39073 
Train Epoch: 17 [177/500 11328/32000 (35%)] Loss: 0.92784 (QuantReg: 12.93995) QuantErr: 12.93995 batch_time=0.45120 
Train Epoch: 17 [185/500 11840/32000 (37%)] Loss: 0.70771 (QuantReg: 13.20646) QuantErr: 13.20646 batch_time=0.46491 
Train Epoch: 17 [193/500 12352/32000 (39%)] Loss: 1.08122 (QuantReg: 12.98566) QuantErr: 12.98566 batch_time=1.17594 
Train Epoch: 17 [201/500 12864/32000 (40%)] Loss: 0.90889 (QuantReg: 13.03559) QuantErr: 13.03559 batch_time=0.40247 
Train Epoch: 17 [209/500 13376/32000 (42%)] Loss: 0.80083 (QuantReg: 13.08128) QuantErr: 13.08128 batch_time=0.39360 
Train Epoch: 17 [217/500 13888/32000 (43%)] Loss: 1.05413 (QuantReg: 12.69679) QuantErr: 12.69679 batch_time=0.38866 
Train Epoch: 17 [225/500 14400/32000 (45%)] Loss: 0.92841 (QuantReg: 13.48026) QuantErr: 13.48026 batch_time=0.38436 
Train Epoch: 17 [233/500 14912/32000 (47%)] Loss: 0.65035 (QuantReg: 13.44432) QuantErr: 13.44432 batch_time=0.38561 
Train Epoch: 17 [241/500 15424/32000 (48%)] Loss: 0.94701 (QuantReg: 12.21035) QuantErr: 12.21035 batch_time=0.38455 
Train Epoch: 17 [249/500 15936/32000 (50%)] Loss: 0.66302 (QuantReg: 13.10751) QuantErr: 13.10751 batch_time=0.41105 
Train Epoch: 17 [257/500 16448/32000 (51%)] Loss: 0.97758 (QuantReg: 13.35322) QuantErr: 13.35322 batch_time=1.14688 
Train Epoch: 17 [265/500 16960/32000 (53%)] Loss: 0.84147 (QuantReg: 13.00096) QuantErr: 13.00096 batch_time=0.41010 
Train Epoch: 17 [273/500 17472/32000 (55%)] Loss: 1.38157 (QuantReg: 12.75566) QuantErr: 12.75566 batch_time=0.39553 
Train Epoch: 17 [281/500 17984/32000 (56%)] Loss: 0.90178 (QuantReg: 12.97974) QuantErr: 12.97974 batch_time=0.37926 
Train Epoch: 17 [289/500 18496/32000 (58%)] Loss: 0.88286 (QuantReg: 13.01771) QuantErr: 13.01771 batch_time=0.39826 
Train Epoch: 17 [297/500 19008/32000 (59%)] Loss: 1.01091 (QuantReg: 12.71302) QuantErr: 12.71302 batch_time=0.39922 
Train Epoch: 17 [305/500 19520/32000 (61%)] Loss: 0.88870 (QuantReg: 12.90360) QuantErr: 12.90360 batch_time=0.43031 
Train Epoch: 17 [313/500 20032/32000 (63%)] Loss: 1.25590 (QuantReg: 12.57323) QuantErr: 12.57323 batch_time=0.38974 
Train Epoch: 17 [321/500 20544/32000 (64%)] Loss: 0.94717 (QuantReg: 12.98479) QuantErr: 12.98479 batch_time=1.12938 
Train Epoch: 17 [329/500 21056/32000 (66%)] Loss: 1.46847 (QuantReg: 13.51268) QuantErr: 13.51268 batch_time=0.39750 
Train Epoch: 17 [337/500 21568/32000 (67%)] Loss: 1.34075 (QuantReg: 12.62314) QuantErr: 12.62314 batch_time=0.39327 
Train Epoch: 17 [345/500 22080/32000 (69%)] Loss: 1.11507 (QuantReg: 13.03889) QuantErr: 13.03889 batch_time=0.40536 
Train Epoch: 17 [353/500 22592/32000 (71%)] Loss: 0.58989 (QuantReg: 13.10110) QuantErr: 13.10110 batch_time=0.40136 
Train Epoch: 17 [361/500 23104/32000 (72%)] Loss: 1.19118 (QuantReg: 13.47975) QuantErr: 13.47975 batch_time=0.41486 
Train Epoch: 17 [369/500 23616/32000 (74%)] Loss: 0.95658 (QuantReg: 13.19016) QuantErr: 13.19016 batch_time=0.39133 
Train Epoch: 17 [377/500 24128/32000 (75%)] Loss: 0.99299 (QuantReg: 12.63757) QuantErr: 12.63757 batch_time=0.40365 
Train Epoch: 17 [385/500 24640/32000 (77%)] Loss: 0.57513 (QuantReg: 13.34759) QuantErr: 13.34759 batch_time=1.28655 
Train Epoch: 17 [393/500 25152/32000 (79%)] Loss: 1.02016 (QuantReg: 12.82964) QuantErr: 12.82964 batch_time=0.47077 
Train Epoch: 17 [401/500 25664/32000 (80%)] Loss: 1.30348 (QuantReg: 13.20403) QuantErr: 13.20403 batch_time=0.40342 
Train Epoch: 17 [409/500 26176/32000 (82%)] Loss: 1.00362 (QuantReg: 13.07667) QuantErr: 13.07667 batch_time=0.40613 
Train Epoch: 17 [417/500 26688/32000 (83%)] Loss: 1.32817 (QuantReg: 13.09476) QuantErr: 13.09476 batch_time=0.39177 
Train Epoch: 17 [425/500 27200/32000 (85%)] Loss: 0.88813 (QuantReg: 13.13234) QuantErr: 13.13234 batch_time=0.38232 
Train Epoch: 17 [433/500 27712/32000 (87%)] Loss: 0.63207 (QuantReg: 12.98973) QuantErr: 12.98973 batch_time=0.45387 
Train Epoch: 17 [441/500 28224/32000 (88%)] Loss: 1.03256 (QuantReg: 12.92827) QuantErr: 12.92827 batch_time=0.38985 
Train Epoch: 17 [449/500 28736/32000 (90%)] Loss: 0.56712 (QuantReg: 13.11157) QuantErr: 13.11157 batch_time=1.14014 
Train Epoch: 17 [457/500 29248/32000 (91%)] Loss: 0.78848 (QuantReg: 12.89477) QuantErr: 12.89477 batch_time=0.39875 
Train Epoch: 17 [465/500 29760/32000 (93%)] Loss: 1.48018 (QuantReg: 13.32967) QuantErr: 13.32967 batch_time=0.39953 
Train Epoch: 17 [473/500 30272/32000 (95%)] Loss: 0.78561 (QuantReg: 13.19437) QuantErr: 13.19437 batch_time=0.39133 
Train Epoch: 17 [481/500 30784/32000 (96%)] Loss: 1.01191 (QuantReg: 12.28817) QuantErr: 12.28817 batch_time=0.39279 
Train Epoch: 17 [489/500 31296/32000 (98%)] Loss: 1.18396 (QuantReg: 12.72913) QuantErr: 12.72913 batch_time=0.40082 
Train Epoch: 17 [497/500 31808/32000 (99%)] Loss: 0.72776 (QuantReg: 13.39297) QuantErr: 13.39297 batch_time=0.39325 
Train Epoch: 17 codebook_update_time=1.67559
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch17.pth ...
Done in 6.045s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch17.pth ...
Done in 10.544s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 0.9279259259104728
 quant_reg      : 13.032160493850707
 quant_err      : 13.032160493850707
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.237
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.16226772172626
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3235
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.75864057075636
 mnt_best       : 43.16226772172626
 not_improved_count: 0
Train Epoch: 18 [1/500 64/32000 (0%)] Loss: 1.22551 (QuantReg: 13.24141) QuantErr: 13.24141 batch_time=20.41284 
Train Epoch: 18 [9/500 576/32000 (2%)] Loss: 0.74437 (QuantReg: 12.56668) QuantErr: 12.56668 batch_time=0.39576 
Train Epoch: 18 [17/500 1088/32000 (3%)] Loss: 1.01561 (QuantReg: 12.91255) QuantErr: 12.91255 batch_time=0.39579 
Train Epoch: 18 [25/500 1600/32000 (5%)] Loss: 0.95065 (QuantReg: 13.00548) QuantErr: 13.00548 batch_time=0.41154 
Train Epoch: 18 [33/500 2112/32000 (7%)] Loss: 1.17146 (QuantReg: 12.79681) QuantErr: 12.79681 batch_time=0.73158 
Train Epoch: 18 [41/500 2624/32000 (8%)] Loss: 0.71318 (QuantReg: 13.12694) QuantErr: 13.12694 batch_time=0.39209 
Train Epoch: 18 [49/500 3136/32000 (10%)] Loss: 1.39252 (QuantReg: 12.37387) QuantErr: 12.37387 batch_time=0.37546 
Train Epoch: 18 [57/500 3648/32000 (11%)] Loss: 1.44795 (QuantReg: 12.50506) QuantErr: 12.50506 batch_time=0.46052 
Train Epoch: 18 [65/500 4160/32000 (13%)] Loss: 0.92935 (QuantReg: 12.86729) QuantErr: 12.86729 batch_time=1.10656 
Train Epoch: 18 [73/500 4672/32000 (15%)] Loss: 0.67494 (QuantReg: 13.32047) QuantErr: 13.32047 batch_time=0.38912 
Train Epoch: 18 [81/500 5184/32000 (16%)] Loss: 1.25088 (QuantReg: 13.24280) QuantErr: 13.24280 batch_time=0.40505 
Train Epoch: 18 [89/500 5696/32000 (18%)] Loss: 0.98977 (QuantReg: 12.84475) QuantErr: 12.84475 batch_time=0.39062 
Train Epoch: 18 [97/500 6208/32000 (19%)] Loss: 1.03002 (QuantReg: 13.01528) QuantErr: 13.01528 batch_time=0.80824 
Train Epoch: 18 [105/500 6720/32000 (21%)] Loss: 1.09242 (QuantReg: 12.58715) QuantErr: 12.58715 batch_time=0.37918 
Train Epoch: 18 [113/500 7232/32000 (23%)] Loss: 0.59772 (QuantReg: 13.29203) QuantErr: 13.29203 batch_time=0.38414 
Train Epoch: 18 [121/500 7744/32000 (24%)] Loss: 1.37255 (QuantReg: 12.34300) QuantErr: 12.34300 batch_time=0.44808 
Train Epoch: 18 [129/500 8256/32000 (26%)] Loss: 0.72969 (QuantReg: 12.84148) QuantErr: 12.84148 batch_time=1.13998 
Train Epoch: 18 [137/500 8768/32000 (27%)] Loss: 1.42747 (QuantReg: 12.88780) QuantErr: 12.88780 batch_time=0.40194 
Train Epoch: 18 [145/500 9280/32000 (29%)] Loss: 0.77009 (QuantReg: 13.34458) QuantErr: 13.34458 batch_time=0.39868 
Train Epoch: 18 [153/500 9792/32000 (31%)] Loss: 1.05543 (QuantReg: 13.03133) QuantErr: 13.03133 batch_time=0.41722 
Train Epoch: 18 [161/500 10304/32000 (32%)] Loss: 0.88504 (QuantReg: 12.94800) QuantErr: 12.94800 batch_time=0.75301 
Train Epoch: 18 [169/500 10816/32000 (34%)] Loss: 1.16207 (QuantReg: 12.63023) QuantErr: 12.63023 batch_time=0.40403 
Train Epoch: 18 [177/500 11328/32000 (35%)] Loss: 1.37764 (QuantReg: 13.17099) QuantErr: 13.17099 batch_time=0.38334 
Train Epoch: 18 [185/500 11840/32000 (37%)] Loss: 0.74267 (QuantReg: 12.60434) QuantErr: 12.60434 batch_time=0.47909 
Train Epoch: 18 [193/500 12352/32000 (39%)] Loss: 0.65055 (QuantReg: 13.10106) QuantErr: 13.10106 batch_time=1.23575 
Train Epoch: 18 [201/500 12864/32000 (40%)] Loss: 0.95914 (QuantReg: 12.99641) QuantErr: 12.99641 batch_time=0.40159 
Train Epoch: 18 [209/500 13376/32000 (42%)] Loss: 0.94890 (QuantReg: 12.72898) QuantErr: 12.72898 batch_time=0.40302 
Train Epoch: 18 [217/500 13888/32000 (43%)] Loss: 0.81454 (QuantReg: 12.16809) QuantErr: 12.16809 batch_time=0.39735 
Train Epoch: 18 [225/500 14400/32000 (45%)] Loss: 0.52880 (QuantReg: 12.90931) QuantErr: 12.90931 batch_time=0.78464 
Train Epoch: 18 [233/500 14912/32000 (47%)] Loss: 1.01641 (QuantReg: 13.34649) QuantErr: 13.34649 batch_time=0.39877 
Train Epoch: 18 [241/500 15424/32000 (48%)] Loss: 1.07133 (QuantReg: 13.05358) QuantErr: 13.05358 batch_time=0.39199 
Train Epoch: 18 [249/500 15936/32000 (50%)] Loss: 0.61654 (QuantReg: 12.94888) QuantErr: 12.94888 batch_time=0.48233 
Train Epoch: 18 [257/500 16448/32000 (51%)] Loss: 0.95861 (QuantReg: 12.56480) QuantErr: 12.56480 batch_time=1.08134 
Train Epoch: 18 [265/500 16960/32000 (53%)] Loss: 0.75380 (QuantReg: 12.87238) QuantErr: 12.87238 batch_time=0.39172 
Train Epoch: 18 [273/500 17472/32000 (55%)] Loss: 1.00177 (QuantReg: 12.74020) QuantErr: 12.74020 batch_time=0.40154 
Train Epoch: 18 [281/500 17984/32000 (56%)] Loss: 1.34351 (QuantReg: 13.41066) QuantErr: 13.41066 batch_time=0.44955 
Train Epoch: 18 [289/500 18496/32000 (58%)] Loss: 0.68271 (QuantReg: 12.97108) QuantErr: 12.97108 batch_time=0.78251 
Train Epoch: 18 [297/500 19008/32000 (59%)] Loss: 0.81614 (QuantReg: 12.92479) QuantErr: 12.92479 batch_time=0.39630 
Train Epoch: 18 [305/500 19520/32000 (61%)] Loss: 0.85886 (QuantReg: 13.19039) QuantErr: 13.19039 batch_time=0.43888 
Train Epoch: 18 [313/500 20032/32000 (63%)] Loss: 0.80362 (QuantReg: 13.06922) QuantErr: 13.06922 batch_time=0.44765 
Train Epoch: 18 [321/500 20544/32000 (64%)] Loss: 0.81018 (QuantReg: 13.14762) QuantErr: 13.14762 batch_time=1.15421 
Train Epoch: 18 [329/500 21056/32000 (66%)] Loss: 1.32141 (QuantReg: 12.62272) QuantErr: 12.62272 batch_time=0.39797 
Train Epoch: 18 [337/500 21568/32000 (67%)] Loss: 1.17314 (QuantReg: 12.48039) QuantErr: 12.48039 batch_time=0.40279 
Train Epoch: 18 [345/500 22080/32000 (69%)] Loss: 0.75918 (QuantReg: 13.21360) QuantErr: 13.21360 batch_time=0.40164 
Train Epoch: 18 [353/500 22592/32000 (71%)] Loss: 0.65418 (QuantReg: 13.37270) QuantErr: 13.37270 batch_time=0.73220 
Train Epoch: 18 [361/500 23104/32000 (72%)] Loss: 0.66064 (QuantReg: 13.17938) QuantErr: 13.17938 batch_time=0.38909 
Train Epoch: 18 [369/500 23616/32000 (74%)] Loss: 0.59798 (QuantReg: 13.17692) QuantErr: 13.17692 batch_time=0.38656 
Train Epoch: 18 [377/500 24128/32000 (75%)] Loss: 1.14295 (QuantReg: 12.77712) QuantErr: 12.77712 batch_time=0.46251 
Train Epoch: 18 [385/500 24640/32000 (77%)] Loss: 1.02407 (QuantReg: 12.69598) QuantErr: 12.69598 batch_time=1.06446 
Train Epoch: 18 [393/500 25152/32000 (79%)] Loss: 0.93913 (QuantReg: 13.38844) QuantErr: 13.38844 batch_time=0.38776 
Train Epoch: 18 [401/500 25664/32000 (80%)] Loss: 1.02843 (QuantReg: 12.99928) QuantErr: 12.99928 batch_time=0.41747 
Train Epoch: 18 [409/500 26176/32000 (82%)] Loss: 0.77187 (QuantReg: 13.28419) QuantErr: 13.28419 batch_time=0.39572 
Train Epoch: 18 [417/500 26688/32000 (83%)] Loss: 0.83083 (QuantReg: 12.76227) QuantErr: 12.76227 batch_time=0.73254 
Train Epoch: 18 [425/500 27200/32000 (85%)] Loss: 1.04063 (QuantReg: 13.55407) QuantErr: 13.55407 batch_time=0.39177 
Train Epoch: 18 [433/500 27712/32000 (87%)] Loss: 0.84468 (QuantReg: 12.95881) QuantErr: 12.95881 batch_time=0.40624 
Train Epoch: 18 [441/500 28224/32000 (88%)] Loss: 1.07760 (QuantReg: 12.88394) QuantErr: 12.88394 batch_time=0.45285 
Train Epoch: 18 [449/500 28736/32000 (90%)] Loss: 0.87484 (QuantReg: 13.06456) QuantErr: 13.06456 batch_time=1.08021 
Train Epoch: 18 [457/500 29248/32000 (91%)] Loss: 0.82526 (QuantReg: 13.51498) QuantErr: 13.51498 batch_time=0.45525 
Train Epoch: 18 [465/500 29760/32000 (93%)] Loss: 0.71253 (QuantReg: 13.20964) QuantErr: 13.20964 batch_time=0.39961 
Train Epoch: 18 [473/500 30272/32000 (95%)] Loss: 0.99597 (QuantReg: 13.11003) QuantErr: 13.11003 batch_time=0.44285 
Train Epoch: 18 [481/500 30784/32000 (96%)] Loss: 0.47005 (QuantReg: 13.16194) QuantErr: 13.16194 batch_time=0.76929 
Train Epoch: 18 [489/500 31296/32000 (98%)] Loss: 1.14325 (QuantReg: 13.17926) QuantErr: 13.17926 batch_time=0.38592 
Train Epoch: 18 [497/500 31808/32000 (99%)] Loss: 0.50682 (QuantReg: 13.16222) QuantErr: 13.16222 batch_time=0.38706 
Train Epoch: 18 codebook_update_time=1.91032
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch18.pth ...
Done in 4.698s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 0.8967206628322602
 quant_reg      : 13.041938186645508
 quant_err      : 13.041938186645508
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.371
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.60253902740133
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.779
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.81184392279539
 mnt_best       : 43.16226772172626
 not_improved_count: 1
Train Epoch: 19 [1/500 64/32000 (0%)] Loss: 0.97001 (QuantReg: 13.13632) QuantErr: 13.13632 batch_time=21.07165 
Train Epoch: 19 [9/500 576/32000 (2%)] Loss: 0.55086 (QuantReg: 12.94849) QuantErr: 12.94849 batch_time=0.39291 
Train Epoch: 19 [17/500 1088/32000 (3%)] Loss: 1.00146 (QuantReg: 12.77696) QuantErr: 12.77696 batch_time=0.39004 
Train Epoch: 19 [25/500 1600/32000 (5%)] Loss: 0.95578 (QuantReg: 12.43651) QuantErr: 12.43651 batch_time=0.41332 
Train Epoch: 19 [33/500 2112/32000 (7%)] Loss: 0.91923 (QuantReg: 12.94516) QuantErr: 12.94516 batch_time=0.81792 
Train Epoch: 19 [41/500 2624/32000 (8%)] Loss: 0.99140 (QuantReg: 13.13406) QuantErr: 13.13406 batch_time=0.80839 
Train Epoch: 19 [49/500 3136/32000 (10%)] Loss: 0.82949 (QuantReg: 13.35647) QuantErr: 13.35647 batch_time=0.39414 
Train Epoch: 19 [57/500 3648/32000 (11%)] Loss: 0.73058 (QuantReg: 13.11335) QuantErr: 13.11335 batch_time=0.38384 
Train Epoch: 19 [65/500 4160/32000 (13%)] Loss: 0.78151 (QuantReg: 12.77245) QuantErr: 12.77245 batch_time=0.83707 
Train Epoch: 19 [73/500 4672/32000 (15%)] Loss: 0.94730 (QuantReg: 12.95547) QuantErr: 12.95547 batch_time=0.38435 
Train Epoch: 19 [81/500 5184/32000 (16%)] Loss: 0.88280 (QuantReg: 13.23854) QuantErr: 13.23854 batch_time=0.38774 
Train Epoch: 19 [89/500 5696/32000 (18%)] Loss: 1.18294 (QuantReg: 13.05478) QuantErr: 13.05478 batch_time=0.38531 
Train Epoch: 19 [97/500 6208/32000 (19%)] Loss: 1.01623 (QuantReg: 12.29690) QuantErr: 12.29690 batch_time=0.44435 
Train Epoch: 19 [105/500 6720/32000 (21%)] Loss: 1.13625 (QuantReg: 13.35891) QuantErr: 13.35891 batch_time=0.92571 
Train Epoch: 19 [113/500 7232/32000 (23%)] Loss: 0.47326 (QuantReg: 12.99961) QuantErr: 12.99961 batch_time=0.38939 
Train Epoch: 19 [121/500 7744/32000 (24%)] Loss: 0.82238 (QuantReg: 13.07909) QuantErr: 13.07909 batch_time=0.38590 
Train Epoch: 19 [129/500 8256/32000 (26%)] Loss: 1.15807 (QuantReg: 12.96884) QuantErr: 12.96884 batch_time=0.86558 
Train Epoch: 19 [137/500 8768/32000 (27%)] Loss: 0.62715 (QuantReg: 13.44336) QuantErr: 13.44336 batch_time=0.43428 
Train Epoch: 19 [145/500 9280/32000 (29%)] Loss: 0.87223 (QuantReg: 13.28894) QuantErr: 13.28894 batch_time=0.38709 
Train Epoch: 19 [153/500 9792/32000 (31%)] Loss: 1.07616 (QuantReg: 12.69570) QuantErr: 12.69570 batch_time=0.39891 
Train Epoch: 19 [161/500 10304/32000 (32%)] Loss: 0.82382 (QuantReg: 13.11775) QuantErr: 13.11775 batch_time=0.41146 
Train Epoch: 19 [169/500 10816/32000 (34%)] Loss: 0.89289 (QuantReg: 12.72486) QuantErr: 12.72486 batch_time=0.75790 
Train Epoch: 19 [177/500 11328/32000 (35%)] Loss: 0.60428 (QuantReg: 12.90934) QuantErr: 12.90934 batch_time=0.40086 
Train Epoch: 19 [185/500 11840/32000 (37%)] Loss: 0.92416 (QuantReg: 13.18228) QuantErr: 13.18228 batch_time=0.40165 
Train Epoch: 19 [193/500 12352/32000 (39%)] Loss: 0.97366 (QuantReg: 13.04882) QuantErr: 13.04882 batch_time=0.83381 
Train Epoch: 19 [201/500 12864/32000 (40%)] Loss: 1.36452 (QuantReg: 12.43894) QuantErr: 12.43894 batch_time=0.40169 
Train Epoch: 19 [209/500 13376/32000 (42%)] Loss: 1.16017 (QuantReg: 11.89556) QuantErr: 11.89556 batch_time=0.40211 
Train Epoch: 19 [217/500 13888/32000 (43%)] Loss: 0.71303 (QuantReg: 12.94387) QuantErr: 12.94387 batch_time=0.40214 
Train Epoch: 19 [225/500 14400/32000 (45%)] Loss: 0.81002 (QuantReg: 12.74234) QuantErr: 12.74234 batch_time=0.42586 
Train Epoch: 19 [233/500 14912/32000 (47%)] Loss: 0.74586 (QuantReg: 13.26818) QuantErr: 13.26818 batch_time=0.77452 
Train Epoch: 19 [241/500 15424/32000 (48%)] Loss: 0.78129 (QuantReg: 12.44029) QuantErr: 12.44029 batch_time=0.39106 
Train Epoch: 19 [249/500 15936/32000 (50%)] Loss: 0.90084 (QuantReg: 13.49854) QuantErr: 13.49854 batch_time=0.39272 
Train Epoch: 19 [257/500 16448/32000 (51%)] Loss: 0.79509 (QuantReg: 12.63782) QuantErr: 12.63782 batch_time=0.88186 
Train Epoch: 19 [265/500 16960/32000 (53%)] Loss: 0.69655 (QuantReg: 13.34679) QuantErr: 13.34679 batch_time=0.39664 
Train Epoch: 19 [273/500 17472/32000 (55%)] Loss: 0.78075 (QuantReg: 13.56580) QuantErr: 13.56580 batch_time=0.47821 
Train Epoch: 19 [281/500 17984/32000 (56%)] Loss: 1.61451 (QuantReg: 12.57428) QuantErr: 12.57428 batch_time=0.38894 
Train Epoch: 19 [289/500 18496/32000 (58%)] Loss: 0.97062 (QuantReg: 13.47980) QuantErr: 13.47980 batch_time=0.44717 
Train Epoch: 19 [297/500 19008/32000 (59%)] Loss: 0.69716 (QuantReg: 12.91542) QuantErr: 12.91542 batch_time=0.83707 
Train Epoch: 19 [305/500 19520/32000 (61%)] Loss: 1.11475 (QuantReg: 13.44401) QuantErr: 13.44401 batch_time=0.40421 
Train Epoch: 19 [313/500 20032/32000 (63%)] Loss: 1.06795 (QuantReg: 13.11616) QuantErr: 13.11616 batch_time=0.39554 
Train Epoch: 19 [321/500 20544/32000 (64%)] Loss: 0.70817 (QuantReg: 13.41084) QuantErr: 13.41084 batch_time=0.83810 
Train Epoch: 19 [329/500 21056/32000 (66%)] Loss: 0.93857 (QuantReg: 12.47831) QuantErr: 12.47831 batch_time=0.41218 
Train Epoch: 19 [337/500 21568/32000 (67%)] Loss: 0.59586 (QuantReg: 12.89037) QuantErr: 12.89037 batch_time=0.39055 
Train Epoch: 19 [345/500 22080/32000 (69%)] Loss: 0.68003 (QuantReg: 13.16032) QuantErr: 13.16032 batch_time=0.39241 
Train Epoch: 19 [353/500 22592/32000 (71%)] Loss: 0.84689 (QuantReg: 13.41086) QuantErr: 13.41086 batch_time=0.41157 
Train Epoch: 19 [361/500 23104/32000 (72%)] Loss: 0.93904 (QuantReg: 13.21231) QuantErr: 13.21231 batch_time=0.74247 
Train Epoch: 19 [369/500 23616/32000 (74%)] Loss: 1.47382 (QuantReg: 12.85447) QuantErr: 12.85447 batch_time=0.43107 
Train Epoch: 19 [377/500 24128/32000 (75%)] Loss: 0.88149 (QuantReg: 13.00121) QuantErr: 13.00121 batch_time=0.43280 
Train Epoch: 19 [385/500 24640/32000 (77%)] Loss: 0.66231 (QuantReg: 13.17600) QuantErr: 13.17600 batch_time=0.87988 
Train Epoch: 19 [393/500 25152/32000 (79%)] Loss: 1.45230 (QuantReg: 13.05701) QuantErr: 13.05701 batch_time=0.39972 
Train Epoch: 19 [401/500 25664/32000 (80%)] Loss: 1.48279 (QuantReg: 13.66017) QuantErr: 13.66017 batch_time=0.40138 
Train Epoch: 19 [409/500 26176/32000 (82%)] Loss: 1.09333 (QuantReg: 12.94231) QuantErr: 12.94231 batch_time=0.41999 
Train Epoch: 19 [417/500 26688/32000 (83%)] Loss: 0.77600 (QuantReg: 13.36582) QuantErr: 13.36582 batch_time=0.40069 
Train Epoch: 19 [425/500 27200/32000 (85%)] Loss: 0.71201 (QuantReg: 12.77708) QuantErr: 12.77708 batch_time=0.74393 
Train Epoch: 19 [433/500 27712/32000 (87%)] Loss: 0.62389 (QuantReg: 13.37130) QuantErr: 13.37130 batch_time=0.39093 
Train Epoch: 19 [441/500 28224/32000 (88%)] Loss: 0.93471 (QuantReg: 12.76672) QuantErr: 12.76672 batch_time=0.39516 
Train Epoch: 19 [449/500 28736/32000 (90%)] Loss: 0.70413 (QuantReg: 12.92380) QuantErr: 12.92380 batch_time=0.80119 
Train Epoch: 19 [457/500 29248/32000 (91%)] Loss: 1.31463 (QuantReg: 12.84007) QuantErr: 12.84007 batch_time=0.39090 
Train Epoch: 19 [465/500 29760/32000 (93%)] Loss: 1.24113 (QuantReg: 13.14871) QuantErr: 13.14871 batch_time=0.39857 
Train Epoch: 19 [473/500 30272/32000 (95%)] Loss: 0.48018 (QuantReg: 12.84295) QuantErr: 12.84295 batch_time=0.39375 
Train Epoch: 19 [481/500 30784/32000 (96%)] Loss: 1.27482 (QuantReg: 13.38479) QuantErr: 13.38479 batch_time=0.43339 
Train Epoch: 19 [489/500 31296/32000 (98%)] Loss: 0.53676 (QuantReg: 13.18485) QuantErr: 13.18485 batch_time=0.74841 
Train Epoch: 19 [497/500 31808/32000 (99%)] Loss: 0.91367 (QuantReg: 13.48314) QuantErr: 13.48314 batch_time=0.39193 
Train Epoch: 19 codebook_update_time=1.75461
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch19.pth ...
Done in 4.801s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch19.pth ...
Done in 9.401s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 0.8841903242468834
 quant_reg      : 13.064585220336914
 quant_err      : 13.064585220336914
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.479
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.5762309772989
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.227
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.50115723119429
 mnt_best       : 43.5762309772989
 not_improved_count: 0
Train Epoch: 20 [1/500 64/32000 (0%)] Loss: 0.98483 (QuantReg: 13.33609) QuantErr: 13.33609 batch_time=25.10270 
Train Epoch: 20 [9/500 576/32000 (2%)] Loss: 0.84700 (QuantReg: 12.71240) QuantErr: 12.71240 batch_time=0.41906 
Train Epoch: 20 [17/500 1088/32000 (3%)] Loss: 0.79902 (QuantReg: 12.76337) QuantErr: 12.76337 batch_time=0.39505 
Train Epoch: 20 [25/500 1600/32000 (5%)] Loss: 0.40175 (QuantReg: 13.19050) QuantErr: 13.19050 batch_time=0.39474 
Train Epoch: 20 [33/500 2112/32000 (7%)] Loss: 0.88651 (QuantReg: 13.05920) QuantErr: 13.05920 batch_time=0.38766 
Train Epoch: 20 [41/500 2624/32000 (8%)] Loss: 0.59198 (QuantReg: 12.87143) QuantErr: 12.87143 batch_time=0.39318 
Train Epoch: 20 [49/500 3136/32000 (10%)] Loss: 0.89587 (QuantReg: 12.55036) QuantErr: 12.55036 batch_time=0.38327 
Train Epoch: 20 [57/500 3648/32000 (11%)] Loss: 1.10619 (QuantReg: 12.91830) QuantErr: 12.91830 batch_time=0.38812 
Train Epoch: 20 [65/500 4160/32000 (13%)] Loss: 0.69919 (QuantReg: 12.97797) QuantErr: 12.97797 batch_time=0.38627 
Train Epoch: 20 [73/500 4672/32000 (15%)] Loss: 0.85622 (QuantReg: 13.21862) QuantErr: 13.21862 batch_time=0.39555 
Train Epoch: 20 [81/500 5184/32000 (16%)] Loss: 0.72692 (QuantReg: 12.45358) QuantErr: 12.45358 batch_time=0.39877 
Train Epoch: 20 [89/500 5696/32000 (18%)] Loss: 0.82272 (QuantReg: 12.83823) QuantErr: 12.83823 batch_time=0.39248 
Train Epoch: 20 [97/500 6208/32000 (19%)] Loss: 1.17269 (QuantReg: 12.35319) QuantErr: 12.35319 batch_time=0.38592 
Train Epoch: 20 [105/500 6720/32000 (21%)] Loss: 1.15582 (QuantReg: 13.30098) QuantErr: 13.30098 batch_time=0.40282 
Train Epoch: 20 [113/500 7232/32000 (23%)] Loss: 0.72676 (QuantReg: 12.89595) QuantErr: 12.89595 batch_time=0.39440 
Train Epoch: 20 [121/500 7744/32000 (24%)] Loss: 1.26133 (QuantReg: 12.53755) QuantErr: 12.53755 batch_time=0.39084 
Train Epoch: 20 [129/500 8256/32000 (26%)] Loss: 0.70497 (QuantReg: 13.24000) QuantErr: 13.24000 batch_time=0.43088 
Train Epoch: 20 [137/500 8768/32000 (27%)] Loss: 0.86630 (QuantReg: 12.89674) QuantErr: 12.89674 batch_time=0.40365 
Train Epoch: 20 [145/500 9280/32000 (29%)] Loss: 0.69259 (QuantReg: 13.18851) QuantErr: 13.18851 batch_time=0.39139 
Train Epoch: 20 [153/500 9792/32000 (31%)] Loss: 0.95013 (QuantReg: 12.88608) QuantErr: 12.88608 batch_time=0.40807 
Train Epoch: 20 [161/500 10304/32000 (32%)] Loss: 1.05593 (QuantReg: 12.92577) QuantErr: 12.92577 batch_time=0.39868 
Train Epoch: 20 [169/500 10816/32000 (34%)] Loss: 0.59896 (QuantReg: 13.66663) QuantErr: 13.66663 batch_time=0.40099 
Train Epoch: 20 [177/500 11328/32000 (35%)] Loss: 0.99175 (QuantReg: 13.20074) QuantErr: 13.20074 batch_time=0.39107 
Train Epoch: 20 [185/500 11840/32000 (37%)] Loss: 0.63144 (QuantReg: 13.25380) QuantErr: 13.25380 batch_time=0.39076 
Train Epoch: 20 [193/500 12352/32000 (39%)] Loss: 1.02383 (QuantReg: 13.04536) QuantErr: 13.04536 batch_time=0.39108 
Train Epoch: 20 [201/500 12864/32000 (40%)] Loss: 0.69527 (QuantReg: 13.42521) QuantErr: 13.42521 batch_time=0.39128 
Train Epoch: 20 [209/500 13376/32000 (42%)] Loss: 0.68574 (QuantReg: 13.28833) QuantErr: 13.28833 batch_time=0.39061 
Train Epoch: 20 [217/500 13888/32000 (43%)] Loss: 1.03522 (QuantReg: 13.06814) QuantErr: 13.06814 batch_time=0.39311 
Train Epoch: 20 [225/500 14400/32000 (45%)] Loss: 0.83722 (QuantReg: 13.19654) QuantErr: 13.19654 batch_time=0.39459 
Train Epoch: 20 [233/500 14912/32000 (47%)] Loss: 0.80163 (QuantReg: 12.86285) QuantErr: 12.86285 batch_time=0.40342 
Train Epoch: 20 [241/500 15424/32000 (48%)] Loss: 0.81813 (QuantReg: 12.87326) QuantErr: 12.87326 batch_time=0.39551 
Train Epoch: 20 [249/500 15936/32000 (50%)] Loss: 1.34423 (QuantReg: 12.81806) QuantErr: 12.81806 batch_time=0.39255 
Train Epoch: 20 [257/500 16448/32000 (51%)] Loss: 1.24913 (QuantReg: 13.11257) QuantErr: 13.11257 batch_time=0.39244 
Train Epoch: 20 [265/500 16960/32000 (53%)] Loss: 1.11312 (QuantReg: 12.59504) QuantErr: 12.59504 batch_time=0.40550 
Train Epoch: 20 [273/500 17472/32000 (55%)] Loss: 0.89685 (QuantReg: 12.86772) QuantErr: 12.86772 batch_time=0.38907 
Train Epoch: 20 [281/500 17984/32000 (56%)] Loss: 0.80491 (QuantReg: 12.61529) QuantErr: 12.61529 batch_time=0.38865 
Train Epoch: 20 [289/500 18496/32000 (58%)] Loss: 1.04741 (QuantReg: 13.47359) QuantErr: 13.47359 batch_time=0.39644 
Train Epoch: 20 [297/500 19008/32000 (59%)] Loss: 0.71950 (QuantReg: 13.02257) QuantErr: 13.02257 batch_time=0.39438 
Train Epoch: 20 [305/500 19520/32000 (61%)] Loss: 0.76356 (QuantReg: 13.12358) QuantErr: 13.12358 batch_time=0.39305 
Train Epoch: 20 [313/500 20032/32000 (63%)] Loss: 0.79014 (QuantReg: 13.34506) QuantErr: 13.34506 batch_time=0.39106 
Train Epoch: 20 [321/500 20544/32000 (64%)] Loss: 0.68040 (QuantReg: 13.10049) QuantErr: 13.10049 batch_time=0.39033 
Train Epoch: 20 [329/500 21056/32000 (66%)] Loss: 0.67986 (QuantReg: 13.25163) QuantErr: 13.25163 batch_time=0.39455 
Train Epoch: 20 [337/500 21568/32000 (67%)] Loss: 0.94695 (QuantReg: 12.63698) QuantErr: 12.63698 batch_time=0.38750 
Train Epoch: 20 [345/500 22080/32000 (69%)] Loss: 0.74290 (QuantReg: 13.40372) QuantErr: 13.40372 batch_time=0.38489 
Train Epoch: 20 [353/500 22592/32000 (71%)] Loss: 0.52495 (QuantReg: 12.85370) QuantErr: 12.85370 batch_time=0.39613 
Train Epoch: 20 [361/500 23104/32000 (72%)] Loss: 1.33517 (QuantReg: 12.51759) QuantErr: 12.51759 batch_time=0.39721 
Train Epoch: 20 [369/500 23616/32000 (74%)] Loss: 0.61724 (QuantReg: 13.72075) QuantErr: 13.72075 batch_time=0.38699 
Train Epoch: 20 [377/500 24128/32000 (75%)] Loss: 1.25296 (QuantReg: 13.30281) QuantErr: 13.30281 batch_time=0.41693 
Train Epoch: 20 [385/500 24640/32000 (77%)] Loss: 1.09195 (QuantReg: 13.36438) QuantErr: 13.36438 batch_time=0.39292 
Train Epoch: 20 [393/500 25152/32000 (79%)] Loss: 0.90020 (QuantReg: 13.30356) QuantErr: 13.30356 batch_time=0.39601 
Train Epoch: 20 [401/500 25664/32000 (80%)] Loss: 1.26145 (QuantReg: 12.90841) QuantErr: 12.90841 batch_time=0.38976 
Train Epoch: 20 [409/500 26176/32000 (82%)] Loss: 0.81817 (QuantReg: 12.86645) QuantErr: 12.86645 batch_time=0.40521 
Train Epoch: 20 [417/500 26688/32000 (83%)] Loss: 0.83616 (QuantReg: 12.87825) QuantErr: 12.87825 batch_time=0.39890 
Train Epoch: 20 [425/500 27200/32000 (85%)] Loss: 0.71049 (QuantReg: 13.09398) QuantErr: 13.09398 batch_time=0.39091 
Train Epoch: 20 [433/500 27712/32000 (87%)] Loss: 0.73866 (QuantReg: 13.08279) QuantErr: 13.08279 batch_time=0.38847 
Train Epoch: 20 [441/500 28224/32000 (88%)] Loss: 0.99731 (QuantReg: 13.40082) QuantErr: 13.40082 batch_time=0.41913 
Train Epoch: 20 [449/500 28736/32000 (90%)] Loss: 0.39165 (QuantReg: 12.67121) QuantErr: 12.67121 batch_time=0.45306 
Train Epoch: 20 [457/500 29248/32000 (91%)] Loss: 0.95195 (QuantReg: 13.30055) QuantErr: 13.30055 batch_time=0.39184 
Train Epoch: 20 [465/500 29760/32000 (93%)] Loss: 0.66347 (QuantReg: 12.85449) QuantErr: 12.85449 batch_time=0.40085 
Train Epoch: 20 [473/500 30272/32000 (95%)] Loss: 0.81667 (QuantReg: 12.73443) QuantErr: 12.73443 batch_time=0.38914 
Train Epoch: 20 [481/500 30784/32000 (96%)] Loss: 0.55672 (QuantReg: 13.22199) QuantErr: 13.22199 batch_time=0.40240 
Train Epoch: 20 [489/500 31296/32000 (98%)] Loss: 1.15380 (QuantReg: 12.96819) QuantErr: 12.96819 batch_time=0.39378 
Train Epoch: 20 [497/500 31808/32000 (99%)] Loss: 0.97435 (QuantReg: 13.05890) QuantErr: 13.05890 batch_time=0.38383 
Train Epoch: 20 codebook_update_time=2.06676
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch20.pth ...
Done in 5.465s
removing stale ckpt [epoch 19] [took 0.01s]
 epoch          : 20
 loss           : 0.8556011122465134
 quant_reg      : 13.064509559631349
 quant_err      : 13.064509559631349
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.684
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.37445970601534
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.8515
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.654226499840185
 mnt_best       : 43.5762309772989
 not_improved_count: 1
Train Epoch: 21 [1/500 64/32000 (0%)] Loss: 1.24144 (QuantReg: 13.00930) QuantErr: 13.00930 batch_time=17.99147 
Train Epoch: 21 [9/500 576/32000 (2%)] Loss: 1.21917 (QuantReg: 13.13547) QuantErr: 13.13547 batch_time=0.51724 
Train Epoch: 21 [17/500 1088/32000 (3%)] Loss: 0.56013 (QuantReg: 13.55960) QuantErr: 13.55960 batch_time=1.49116 
Train Epoch: 21 [25/500 1600/32000 (5%)] Loss: 0.92187 (QuantReg: 13.14895) QuantErr: 13.14895 batch_time=0.40311 
Train Epoch: 21 [33/500 2112/32000 (7%)] Loss: 0.68038 (QuantReg: 13.04161) QuantErr: 13.04161 batch_time=0.39271 
Train Epoch: 21 [41/500 2624/32000 (8%)] Loss: 1.39556 (QuantReg: 13.00573) QuantErr: 13.00573 batch_time=0.39693 
Train Epoch: 21 [49/500 3136/32000 (10%)] Loss: 0.59266 (QuantReg: 13.33965) QuantErr: 13.33965 batch_time=0.39239 
Train Epoch: 21 [57/500 3648/32000 (11%)] Loss: 0.87029 (QuantReg: 13.17783) QuantErr: 13.17783 batch_time=0.39219 
Train Epoch: 21 [65/500 4160/32000 (13%)] Loss: 0.91767 (QuantReg: 13.04050) QuantErr: 13.04050 batch_time=0.45229 
Train Epoch: 21 [73/500 4672/32000 (15%)] Loss: 1.18634 (QuantReg: 13.31840) QuantErr: 13.31840 batch_time=0.50549 
Train Epoch: 21 [81/500 5184/32000 (16%)] Loss: 1.04105 (QuantReg: 13.05754) QuantErr: 13.05754 batch_time=1.13347 
Train Epoch: 21 [89/500 5696/32000 (18%)] Loss: 1.04616 (QuantReg: 12.62805) QuantErr: 12.62805 batch_time=0.38904 
Train Epoch: 21 [97/500 6208/32000 (19%)] Loss: 0.78723 (QuantReg: 13.35202) QuantErr: 13.35202 batch_time=0.39364 
Train Epoch: 21 [105/500 6720/32000 (21%)] Loss: 0.59669 (QuantReg: 12.84204) QuantErr: 12.84204 batch_time=0.39248 
Train Epoch: 21 [113/500 7232/32000 (23%)] Loss: 1.04261 (QuantReg: 13.03035) QuantErr: 13.03035 batch_time=0.38851 
Train Epoch: 21 [121/500 7744/32000 (24%)] Loss: 0.85549 (QuantReg: 13.32810) QuantErr: 13.32810 batch_time=0.39444 
Train Epoch: 21 [129/500 8256/32000 (26%)] Loss: 1.03346 (QuantReg: 13.12940) QuantErr: 13.12940 batch_time=0.45137 
Train Epoch: 21 [137/500 8768/32000 (27%)] Loss: 1.02082 (QuantReg: 13.34010) QuantErr: 13.34010 batch_time=0.51779 
Train Epoch: 21 [145/500 9280/32000 (29%)] Loss: 0.70829 (QuantReg: 13.26488) QuantErr: 13.26488 batch_time=1.09011 
Train Epoch: 21 [153/500 9792/32000 (31%)] Loss: 0.95228 (QuantReg: 13.01422) QuantErr: 13.01422 batch_time=0.43509 
Train Epoch: 21 [161/500 10304/32000 (32%)] Loss: 0.71629 (QuantReg: 13.20798) QuantErr: 13.20798 batch_time=0.39166 
Train Epoch: 21 [169/500 10816/32000 (34%)] Loss: 1.01140 (QuantReg: 12.86625) QuantErr: 12.86625 batch_time=0.39907 
Train Epoch: 21 [177/500 11328/32000 (35%)] Loss: 0.50701 (QuantReg: 13.29503) QuantErr: 13.29503 batch_time=0.39453 
Train Epoch: 21 [185/500 11840/32000 (37%)] Loss: 0.73399 (QuantReg: 13.38493) QuantErr: 13.38493 batch_time=0.39055 
Train Epoch: 21 [193/500 12352/32000 (39%)] Loss: 1.01628 (QuantReg: 13.40076) QuantErr: 13.40076 batch_time=0.48986 
Train Epoch: 21 [201/500 12864/32000 (40%)] Loss: 0.89526 (QuantReg: 12.63904) QuantErr: 12.63904 batch_time=0.56155 
Train Epoch: 21 [209/500 13376/32000 (42%)] Loss: 0.52282 (QuantReg: 13.03957) QuantErr: 13.03957 batch_time=1.16906 
Train Epoch: 21 [217/500 13888/32000 (43%)] Loss: 0.84556 (QuantReg: 13.46281) QuantErr: 13.46281 batch_time=0.39033 
Train Epoch: 21 [225/500 14400/32000 (45%)] Loss: 0.63629 (QuantReg: 13.32800) QuantErr: 13.32800 batch_time=0.39872 
Train Epoch: 21 [233/500 14912/32000 (47%)] Loss: 0.78675 (QuantReg: 13.13356) QuantErr: 13.13356 batch_time=0.40435 
Train Epoch: 21 [241/500 15424/32000 (48%)] Loss: 0.66354 (QuantReg: 13.01056) QuantErr: 13.01056 batch_time=0.39874 
Train Epoch: 21 [249/500 15936/32000 (50%)] Loss: 1.04400 (QuantReg: 13.35096) QuantErr: 13.35096 batch_time=0.39250 
Train Epoch: 21 [257/500 16448/32000 (51%)] Loss: 0.56715 (QuantReg: 13.17762) QuantErr: 13.17762 batch_time=0.47253 
Train Epoch: 21 [265/500 16960/32000 (53%)] Loss: 1.04762 (QuantReg: 12.93272) QuantErr: 12.93272 batch_time=0.50783 
Train Epoch: 21 [273/500 17472/32000 (55%)] Loss: 0.92576 (QuantReg: 12.93293) QuantErr: 12.93293 batch_time=1.11930 
Train Epoch: 21 [281/500 17984/32000 (56%)] Loss: 0.65767 (QuantReg: 13.34830) QuantErr: 13.34830 batch_time=0.44241 
Train Epoch: 21 [289/500 18496/32000 (58%)] Loss: 0.73639 (QuantReg: 13.07839) QuantErr: 13.07839 batch_time=0.39528 
Train Epoch: 21 [297/500 19008/32000 (59%)] Loss: 0.73290 (QuantReg: 13.23449) QuantErr: 13.23449 batch_time=0.39516 
Train Epoch: 21 [305/500 19520/32000 (61%)] Loss: 1.15353 (QuantReg: 12.65050) QuantErr: 12.65050 batch_time=0.38976 
Train Epoch: 21 [313/500 20032/32000 (63%)] Loss: 0.60446 (QuantReg: 12.89656) QuantErr: 12.89656 batch_time=0.44654 
Train Epoch: 21 [321/500 20544/32000 (64%)] Loss: 0.90165 (QuantReg: 13.20024) QuantErr: 13.20024 batch_time=0.45455 
Train Epoch: 21 [329/500 21056/32000 (66%)] Loss: 0.76007 (QuantReg: 13.43418) QuantErr: 13.43418 batch_time=0.51733 
Train Epoch: 21 [337/500 21568/32000 (67%)] Loss: 0.61764 (QuantReg: 12.78218) QuantErr: 12.78218 batch_time=1.14867 
Train Epoch: 21 [345/500 22080/32000 (69%)] Loss: 0.76436 (QuantReg: 12.71526) QuantErr: 12.71526 batch_time=0.39000 
Train Epoch: 21 [353/500 22592/32000 (71%)] Loss: 1.13500 (QuantReg: 13.10679) QuantErr: 13.10679 batch_time=0.38464 
Train Epoch: 21 [361/500 23104/32000 (72%)] Loss: 0.94339 (QuantReg: 13.37497) QuantErr: 13.37497 batch_time=0.38101 
Train Epoch: 21 [369/500 23616/32000 (74%)] Loss: 0.69734 (QuantReg: 13.52935) QuantErr: 13.52935 batch_time=0.38304 
Train Epoch: 21 [377/500 24128/32000 (75%)] Loss: 0.98500 (QuantReg: 13.22388) QuantErr: 13.22388 batch_time=0.38536 
Train Epoch: 21 [385/500 24640/32000 (77%)] Loss: 0.88401 (QuantReg: 13.37447) QuantErr: 13.37447 batch_time=0.49264 
Train Epoch: 21 [393/500 25152/32000 (79%)] Loss: 0.49688 (QuantReg: 12.64259) QuantErr: 12.64259 batch_time=0.55515 
Train Epoch: 21 [401/500 25664/32000 (80%)] Loss: 0.94065 (QuantReg: 13.55602) QuantErr: 13.55602 batch_time=1.21823 
Train Epoch: 21 [409/500 26176/32000 (82%)] Loss: 0.60254 (QuantReg: 12.57362) QuantErr: 12.57362 batch_time=0.39713 
Train Epoch: 21 [417/500 26688/32000 (83%)] Loss: 0.93548 (QuantReg: 13.09439) QuantErr: 13.09439 batch_time=0.39508 
Train Epoch: 21 [425/500 27200/32000 (85%)] Loss: 0.95791 (QuantReg: 13.28138) QuantErr: 13.28138 batch_time=0.39610 
Train Epoch: 21 [433/500 27712/32000 (87%)] Loss: 0.82192 (QuantReg: 13.11201) QuantErr: 13.11201 batch_time=0.45911 
Train Epoch: 21 [441/500 28224/32000 (88%)] Loss: 0.78101 (QuantReg: 13.46534) QuantErr: 13.46534 batch_time=0.39350 
Train Epoch: 21 [449/500 28736/32000 (90%)] Loss: 0.47426 (QuantReg: 13.25399) QuantErr: 13.25399 batch_time=0.46056 
Train Epoch: 21 [457/500 29248/32000 (91%)] Loss: 0.76760 (QuantReg: 13.58011) QuantErr: 13.58011 batch_time=0.56162 
Train Epoch: 21 [465/500 29760/32000 (93%)] Loss: 0.74537 (QuantReg: 13.52758) QuantErr: 13.52758 batch_time=1.29786 
Train Epoch: 21 [473/500 30272/32000 (95%)] Loss: 0.68466 (QuantReg: 13.59774) QuantErr: 13.59774 batch_time=0.38972 
Train Epoch: 21 [481/500 30784/32000 (96%)] Loss: 0.55671 (QuantReg: 13.60990) QuantErr: 13.60990 batch_time=0.38945 
Train Epoch: 21 [489/500 31296/32000 (98%)] Loss: 0.72301 (QuantReg: 12.77799) QuantErr: 12.77799 batch_time=0.41451 
Train Epoch: 21 [497/500 31808/32000 (99%)] Loss: 0.92355 (QuantReg: 13.04329) QuantErr: 13.04329 batch_time=0.38274 
Train Epoch: 21 codebook_update_time=1.69182
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch21.pth ...
Done in 5.321s
removing stale ckpt [epoch 20] [took 0.02s]
 epoch          : 21
 loss           : 0.8176415678262711
 quant_reg      : 13.157094179153443
 quant_err      : 13.157094179153443
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.857
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.376132756726214
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3445
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.219496868687976
 mnt_best       : 43.5762309772989
 not_improved_count: 2
Train Epoch: 22 [1/500 64/32000 (0%)] Loss: 0.55048 (QuantReg: 13.25079) QuantErr: 13.25079 batch_time=18.52921 
Train Epoch: 22 [9/500 576/32000 (2%)] Loss: 0.66917 (QuantReg: 13.58952) QuantErr: 13.58952 batch_time=0.50756 
Train Epoch: 22 [17/500 1088/32000 (3%)] Loss: 0.96477 (QuantReg: 12.55972) QuantErr: 12.55972 batch_time=0.38434 
Train Epoch: 22 [25/500 1600/32000 (5%)] Loss: 1.19422 (QuantReg: 12.87260) QuantErr: 12.87260 batch_time=0.39701 
Train Epoch: 22 [33/500 2112/32000 (7%)] Loss: 0.66514 (QuantReg: 13.28886) QuantErr: 13.28886 batch_time=0.38678 
Train Epoch: 22 [41/500 2624/32000 (8%)] Loss: 0.99388 (QuantReg: 12.90965) QuantErr: 12.90965 batch_time=0.44323 
Train Epoch: 22 [49/500 3136/32000 (10%)] Loss: 0.58629 (QuantReg: 13.00295) QuantErr: 13.00295 batch_time=0.40228 
Train Epoch: 22 [57/500 3648/32000 (11%)] Loss: 1.17859 (QuantReg: 13.01120) QuantErr: 13.01120 batch_time=0.40597 
Train Epoch: 22 [65/500 4160/32000 (13%)] Loss: 1.17776 (QuantReg: 12.81052) QuantErr: 12.81052 batch_time=0.38328 
Train Epoch: 22 [73/500 4672/32000 (15%)] Loss: 0.95631 (QuantReg: 13.40692) QuantErr: 13.40692 batch_time=0.52915 
Train Epoch: 22 [81/500 5184/32000 (16%)] Loss: 0.56543 (QuantReg: 12.97719) QuantErr: 12.97719 batch_time=0.39040 
Train Epoch: 22 [89/500 5696/32000 (18%)] Loss: 0.61751 (QuantReg: 13.38327) QuantErr: 13.38327 batch_time=0.39104 
Train Epoch: 22 [97/500 6208/32000 (19%)] Loss: 0.84369 (QuantReg: 13.31894) QuantErr: 13.31894 batch_time=0.39621 
Train Epoch: 22 [105/500 6720/32000 (21%)] Loss: 0.77864 (QuantReg: 13.27489) QuantErr: 13.27489 batch_time=0.40996 
Train Epoch: 22 [113/500 7232/32000 (23%)] Loss: 0.63429 (QuantReg: 13.10803) QuantErr: 13.10803 batch_time=0.59176 
Train Epoch: 22 [121/500 7744/32000 (24%)] Loss: 0.69544 (QuantReg: 13.36919) QuantErr: 13.36919 batch_time=0.38710 
Train Epoch: 22 [129/500 8256/32000 (26%)] Loss: 1.30382 (QuantReg: 12.74506) QuantErr: 12.74506 batch_time=0.40630 
Train Epoch: 22 [137/500 8768/32000 (27%)] Loss: 0.79815 (QuantReg: 13.12635) QuantErr: 13.12635 batch_time=0.50848 
Train Epoch: 22 [145/500 9280/32000 (29%)] Loss: 0.88233 (QuantReg: 13.35197) QuantErr: 13.35197 batch_time=0.38064 
Train Epoch: 22 [153/500 9792/32000 (31%)] Loss: 0.84253 (QuantReg: 12.93915) QuantErr: 12.93915 batch_time=0.37853 
Train Epoch: 22 [161/500 10304/32000 (32%)] Loss: 0.87461 (QuantReg: 13.53228) QuantErr: 13.53228 batch_time=0.38546 
Train Epoch: 22 [169/500 10816/32000 (34%)] Loss: 0.65025 (QuantReg: 12.93783) QuantErr: 12.93783 batch_time=0.38487 
Train Epoch: 22 [177/500 11328/32000 (35%)] Loss: 1.14982 (QuantReg: 12.75993) QuantErr: 12.75993 batch_time=0.43425 
Train Epoch: 22 [185/500 11840/32000 (37%)] Loss: 0.73347 (QuantReg: 13.08835) QuantErr: 13.08835 batch_time=0.40638 
Train Epoch: 22 [193/500 12352/32000 (39%)] Loss: 0.44897 (QuantReg: 13.26549) QuantErr: 13.26549 batch_time=0.38019 
Train Epoch: 22 [201/500 12864/32000 (40%)] Loss: 0.61471 (QuantReg: 13.76479) QuantErr: 13.76479 batch_time=0.54143 
Train Epoch: 22 [209/500 13376/32000 (42%)] Loss: 0.93392 (QuantReg: 13.21787) QuantErr: 13.21787 batch_time=0.43648 
Train Epoch: 22 [217/500 13888/32000 (43%)] Loss: 0.85410 (QuantReg: 13.14059) QuantErr: 13.14059 batch_time=0.39003 
Train Epoch: 22 [225/500 14400/32000 (45%)] Loss: 0.80251 (QuantReg: 12.97494) QuantErr: 12.97494 batch_time=0.38888 
Train Epoch: 22 [233/500 14912/32000 (47%)] Loss: 0.76425 (QuantReg: 13.53577) QuantErr: 13.53577 batch_time=0.40405 
Train Epoch: 22 [241/500 15424/32000 (48%)] Loss: 0.61900 (QuantReg: 13.12670) QuantErr: 13.12670 batch_time=0.38425 
Train Epoch: 22 [249/500 15936/32000 (50%)] Loss: 0.82262 (QuantReg: 13.24547) QuantErr: 13.24547 batch_time=0.38212 
Train Epoch: 22 [257/500 16448/32000 (51%)] Loss: 0.84930 (QuantReg: 13.26170) QuantErr: 13.26170 batch_time=0.38715 
Train Epoch: 22 [265/500 16960/32000 (53%)] Loss: 0.92565 (QuantReg: 13.07016) QuantErr: 13.07016 batch_time=0.51399 
Train Epoch: 22 [273/500 17472/32000 (55%)] Loss: 0.88720 (QuantReg: 13.59654) QuantErr: 13.59654 batch_time=0.41405 
Train Epoch: 22 [281/500 17984/32000 (56%)] Loss: 0.53494 (QuantReg: 12.79229) QuantErr: 12.79229 batch_time=0.44368 
Train Epoch: 22 [289/500 18496/32000 (58%)] Loss: 0.79767 (QuantReg: 12.82496) QuantErr: 12.82496 batch_time=0.42704 
Train Epoch: 22 [297/500 19008/32000 (59%)] Loss: 0.55203 (QuantReg: 13.20189) QuantErr: 13.20189 batch_time=0.39260 
Train Epoch: 22 [305/500 19520/32000 (61%)] Loss: 0.67594 (QuantReg: 13.55813) QuantErr: 13.55813 batch_time=0.38663 
Train Epoch: 22 [313/500 20032/32000 (63%)] Loss: 1.09154 (QuantReg: 12.99541) QuantErr: 12.99541 batch_time=0.41335 
Train Epoch: 22 [321/500 20544/32000 (64%)] Loss: 0.83701 (QuantReg: 13.13076) QuantErr: 13.13076 batch_time=0.39176 
Train Epoch: 22 [329/500 21056/32000 (66%)] Loss: 1.14671 (QuantReg: 12.99988) QuantErr: 12.99988 batch_time=0.41739 
Train Epoch: 22 [337/500 21568/32000 (67%)] Loss: 0.81665 (QuantReg: 13.11460) QuantErr: 13.11460 batch_time=0.39024 
Train Epoch: 22 [345/500 22080/32000 (69%)] Loss: 0.92315 (QuantReg: 13.01051) QuantErr: 13.01051 batch_time=0.40002 
Train Epoch: 22 [353/500 22592/32000 (71%)] Loss: 0.41173 (QuantReg: 13.05556) QuantErr: 13.05556 batch_time=0.46072 
Train Epoch: 22 [361/500 23104/32000 (72%)] Loss: 0.85184 (QuantReg: 12.94100) QuantErr: 12.94100 batch_time=0.41587 
Train Epoch: 22 [369/500 23616/32000 (74%)] Loss: 0.96574 (QuantReg: 13.33773) QuantErr: 13.33773 batch_time=0.38794 
Train Epoch: 22 [377/500 24128/32000 (75%)] Loss: 0.78131 (QuantReg: 13.24417) QuantErr: 13.24417 batch_time=0.41928 
Train Epoch: 22 [385/500 24640/32000 (77%)] Loss: 0.70141 (QuantReg: 13.88613) QuantErr: 13.88613 batch_time=0.39686 
Train Epoch: 22 [393/500 25152/32000 (79%)] Loss: 0.47041 (QuantReg: 13.18313) QuantErr: 13.18313 batch_time=0.39416 
Train Epoch: 22 [401/500 25664/32000 (80%)] Loss: 0.76391 (QuantReg: 13.07349) QuantErr: 13.07349 batch_time=0.39453 
Train Epoch: 22 [409/500 26176/32000 (82%)] Loss: 0.81357 (QuantReg: 12.99852) QuantErr: 12.99852 batch_time=0.40765 
Train Epoch: 22 [417/500 26688/32000 (83%)] Loss: 0.73898 (QuantReg: 13.10102) QuantErr: 13.10102 batch_time=0.69402 
Train Epoch: 22 [425/500 27200/32000 (85%)] Loss: 1.01238 (QuantReg: 13.55597) QuantErr: 13.55597 batch_time=0.38569 
Train Epoch: 22 [433/500 27712/32000 (87%)] Loss: 0.92484 (QuantReg: 13.00747) QuantErr: 13.00747 batch_time=0.38978 
Train Epoch: 22 [441/500 28224/32000 (88%)] Loss: 0.56099 (QuantReg: 13.14034) QuantErr: 13.14034 batch_time=0.40547 
Train Epoch: 22 [449/500 28736/32000 (90%)] Loss: 0.61629 (QuantReg: 13.23730) QuantErr: 13.23730 batch_time=0.38803 
Train Epoch: 22 [457/500 29248/32000 (91%)] Loss: 0.46560 (QuantReg: 13.41029) QuantErr: 13.41029 batch_time=0.46914 
Train Epoch: 22 [465/500 29760/32000 (93%)] Loss: 0.95181 (QuantReg: 13.03485) QuantErr: 13.03485 batch_time=0.41088 
Train Epoch: 22 [473/500 30272/32000 (95%)] Loss: 0.71687 (QuantReg: 13.46788) QuantErr: 13.46788 batch_time=0.39119 
Train Epoch: 22 [481/500 30784/32000 (96%)] Loss: 0.65651 (QuantReg: 13.32482) QuantErr: 13.32482 batch_time=0.38524 
Train Epoch: 22 [489/500 31296/32000 (98%)] Loss: 0.58319 (QuantReg: 13.00483) QuantErr: 13.00483 batch_time=0.46035 
Train Epoch: 22 [497/500 31808/32000 (99%)] Loss: 0.85077 (QuantReg: 13.29286) QuantErr: 13.29286 batch_time=0.38890 
Train Epoch: 22 codebook_update_time=2.08295
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch22.pth ...
Done in 9.736s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch22.pth ...
Done in 14.378s
removing stale ckpt [epoch 21] [took 0.02s]
 epoch          : 22
 loss           : 0.8048496972918511
 quant_reg      : 13.18302468109131
 quant_err      : 13.18302468109131
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.657
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.61231380722525
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.202
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.88247735808409
 mnt_best       : 43.61231380722525
 not_improved_count: 0
Train Epoch: 23 [1/500 64/32000 (0%)] Loss: 0.49386 (QuantReg: 13.53209) QuantErr: 13.53209 batch_time=20.02273 
Train Epoch: 23 [9/500 576/32000 (2%)] Loss: 0.89619 (QuantReg: 13.17918) QuantErr: 13.17918 batch_time=0.41167 
Train Epoch: 23 [17/500 1088/32000 (3%)] Loss: 0.66116 (QuantReg: 12.68697) QuantErr: 12.68697 batch_time=0.39013 
Train Epoch: 23 [25/500 1600/32000 (5%)] Loss: 0.75942 (QuantReg: 13.07685) QuantErr: 13.07685 batch_time=0.40547 
Train Epoch: 23 [33/500 2112/32000 (7%)] Loss: 0.59636 (QuantReg: 13.05304) QuantErr: 13.05304 batch_time=0.51882 
Train Epoch: 23 [41/500 2624/32000 (8%)] Loss: 1.02295 (QuantReg: 12.84593) QuantErr: 12.84593 batch_time=0.38209 
Train Epoch: 23 [49/500 3136/32000 (10%)] Loss: 0.82640 (QuantReg: 13.20829) QuantErr: 13.20829 batch_time=0.40772 
Train Epoch: 23 [57/500 3648/32000 (11%)] Loss: 0.86593 (QuantReg: 12.85346) QuantErr: 12.85346 batch_time=0.39231 
Train Epoch: 23 [65/500 4160/32000 (13%)] Loss: 0.86344 (QuantReg: 13.10265) QuantErr: 13.10265 batch_time=0.66014 
Train Epoch: 23 [73/500 4672/32000 (15%)] Loss: 0.61066 (QuantReg: 13.34541) QuantErr: 13.34541 batch_time=0.38733 
Train Epoch: 23 [81/500 5184/32000 (16%)] Loss: 0.88815 (QuantReg: 13.21021) QuantErr: 13.21021 batch_time=0.39393 
Train Epoch: 23 [89/500 5696/32000 (18%)] Loss: 1.20357 (QuantReg: 12.80986) QuantErr: 12.80986 batch_time=0.38838 
Train Epoch: 23 [97/500 6208/32000 (19%)] Loss: 0.90734 (QuantReg: 13.41983) QuantErr: 13.41983 batch_time=0.53089 
Train Epoch: 23 [105/500 6720/32000 (21%)] Loss: 0.85244 (QuantReg: 13.32254) QuantErr: 13.32254 batch_time=0.39277 
Train Epoch: 23 [113/500 7232/32000 (23%)] Loss: 0.86509 (QuantReg: 13.02770) QuantErr: 13.02770 batch_time=0.47607 
Train Epoch: 23 [121/500 7744/32000 (24%)] Loss: 0.89179 (QuantReg: 13.71157) QuantErr: 13.71157 batch_time=0.40203 
Train Epoch: 23 [129/500 8256/32000 (26%)] Loss: 0.99877 (QuantReg: 13.26837) QuantErr: 13.26837 batch_time=0.66842 
Train Epoch: 23 [137/500 8768/32000 (27%)] Loss: 0.58258 (QuantReg: 13.55404) QuantErr: 13.55404 batch_time=0.37832 
Train Epoch: 23 [145/500 9280/32000 (29%)] Loss: 0.88995 (QuantReg: 13.60915) QuantErr: 13.60915 batch_time=0.38749 
Train Epoch: 23 [153/500 9792/32000 (31%)] Loss: 0.83795 (QuantReg: 12.82028) QuantErr: 12.82028 batch_time=0.39276 
Train Epoch: 23 [161/500 10304/32000 (32%)] Loss: 0.75650 (QuantReg: 13.51767) QuantErr: 13.51767 batch_time=0.51456 
Train Epoch: 23 [169/500 10816/32000 (34%)] Loss: 0.65018 (QuantReg: 13.25977) QuantErr: 13.25977 batch_time=0.39177 
Train Epoch: 23 [177/500 11328/32000 (35%)] Loss: 0.84106 (QuantReg: 13.03860) QuantErr: 13.03860 batch_time=0.39791 
Train Epoch: 23 [185/500 11840/32000 (37%)] Loss: 0.91633 (QuantReg: 13.19719) QuantErr: 13.19719 batch_time=0.39038 
Train Epoch: 23 [193/500 12352/32000 (39%)] Loss: 0.62048 (QuantReg: 13.40438) QuantErr: 13.40438 batch_time=0.71808 
Train Epoch: 23 [201/500 12864/32000 (40%)] Loss: 0.51778 (QuantReg: 13.74835) QuantErr: 13.74835 batch_time=0.46386 
Train Epoch: 23 [209/500 13376/32000 (42%)] Loss: 1.19797 (QuantReg: 13.26195) QuantErr: 13.26195 batch_time=0.39022 
Train Epoch: 23 [217/500 13888/32000 (43%)] Loss: 0.53885 (QuantReg: 13.24587) QuantErr: 13.24587 batch_time=0.38338 
Train Epoch: 23 [225/500 14400/32000 (45%)] Loss: 0.89098 (QuantReg: 13.13319) QuantErr: 13.13319 batch_time=0.41286 
Train Epoch: 23 [233/500 14912/32000 (47%)] Loss: 0.61054 (QuantReg: 12.94073) QuantErr: 12.94073 batch_time=0.39406 
Train Epoch: 23 [241/500 15424/32000 (48%)] Loss: 0.94677 (QuantReg: 13.01155) QuantErr: 13.01155 batch_time=0.43241 
Train Epoch: 23 [249/500 15936/32000 (50%)] Loss: 0.66657 (QuantReg: 13.17714) QuantErr: 13.17714 batch_time=0.38382 
Train Epoch: 23 [257/500 16448/32000 (51%)] Loss: 0.55427 (QuantReg: 13.76822) QuantErr: 13.76822 batch_time=0.37912 
Train Epoch: 23 [265/500 16960/32000 (53%)] Loss: 0.92334 (QuantReg: 13.26471) QuantErr: 13.26471 batch_time=0.42226 
Train Epoch: 23 [273/500 17472/32000 (55%)] Loss: 0.83736 (QuantReg: 13.16284) QuantErr: 13.16284 batch_time=0.38175 
Train Epoch: 23 [281/500 17984/32000 (56%)] Loss: 0.84120 (QuantReg: 13.34978) QuantErr: 13.34978 batch_time=0.42936 
Train Epoch: 23 [289/500 18496/32000 (58%)] Loss: 0.79687 (QuantReg: 13.20188) QuantErr: 13.20188 batch_time=0.40033 
Train Epoch: 23 [297/500 19008/32000 (59%)] Loss: 0.57262 (QuantReg: 13.04724) QuantErr: 13.04724 batch_time=0.41510 
Train Epoch: 23 [305/500 19520/32000 (61%)] Loss: 1.06004 (QuantReg: 13.16887) QuantErr: 13.16887 batch_time=0.40241 
Train Epoch: 23 [313/500 20032/32000 (63%)] Loss: 0.59986 (QuantReg: 13.57025) QuantErr: 13.57025 batch_time=0.40048 
Train Epoch: 23 [321/500 20544/32000 (64%)] Loss: 0.80478 (QuantReg: 13.78137) QuantErr: 13.78137 batch_time=0.38571 
Train Epoch: 23 [329/500 21056/32000 (66%)] Loss: 0.89689 (QuantReg: 13.31640) QuantErr: 13.31640 batch_time=0.44922 
Train Epoch: 23 [337/500 21568/32000 (67%)] Loss: 0.82188 (QuantReg: 13.01808) QuantErr: 13.01808 batch_time=0.38453 
Train Epoch: 23 [345/500 22080/32000 (69%)] Loss: 0.99147 (QuantReg: 12.90706) QuantErr: 12.90706 batch_time=0.39358 
Train Epoch: 23 [353/500 22592/32000 (71%)] Loss: 0.88196 (QuantReg: 12.73029) QuantErr: 12.73029 batch_time=0.52157 
Train Epoch: 23 [361/500 23104/32000 (72%)] Loss: 1.29988 (QuantReg: 12.87792) QuantErr: 12.87792 batch_time=0.40597 
Train Epoch: 23 [369/500 23616/32000 (74%)] Loss: 0.46918 (QuantReg: 13.49884) QuantErr: 13.49884 batch_time=0.40104 
Train Epoch: 23 [377/500 24128/32000 (75%)] Loss: 0.93871 (QuantReg: 13.59085) QuantErr: 13.59085 batch_time=0.38772 
Train Epoch: 23 [385/500 24640/32000 (77%)] Loss: 0.97810 (QuantReg: 13.11746) QuantErr: 13.11746 batch_time=0.40928 
Train Epoch: 23 [393/500 25152/32000 (79%)] Loss: 0.76731 (QuantReg: 13.01761) QuantErr: 13.01761 batch_time=0.38866 
Train Epoch: 23 [401/500 25664/32000 (80%)] Loss: 0.96977 (QuantReg: 13.48431) QuantErr: 13.48431 batch_time=0.43819 
Train Epoch: 23 [409/500 26176/32000 (82%)] Loss: 0.92380 (QuantReg: 13.51135) QuantErr: 13.51135 batch_time=0.41120 
Train Epoch: 23 [417/500 26688/32000 (83%)] Loss: 0.58300 (QuantReg: 13.21927) QuantErr: 13.21927 batch_time=0.39786 
Train Epoch: 23 [425/500 27200/32000 (85%)] Loss: 0.56961 (QuantReg: 13.40405) QuantErr: 13.40405 batch_time=0.38983 
Train Epoch: 23 [433/500 27712/32000 (87%)] Loss: 0.73988 (QuantReg: 13.50274) QuantErr: 13.50274 batch_time=0.40034 
Train Epoch: 23 [441/500 28224/32000 (88%)] Loss: 0.70988 (QuantReg: 13.13734) QuantErr: 13.13734 batch_time=0.42759 
Train Epoch: 23 [449/500 28736/32000 (90%)] Loss: 0.86365 (QuantReg: 12.75640) QuantErr: 12.75640 batch_time=0.39271 
Train Epoch: 23 [457/500 29248/32000 (91%)] Loss: 1.12894 (QuantReg: 13.25970) QuantErr: 13.25970 batch_time=0.41869 
Train Epoch: 23 [465/500 29760/32000 (93%)] Loss: 1.05580 (QuantReg: 12.93383) QuantErr: 12.93383 batch_time=0.39629 
Train Epoch: 23 [473/500 30272/32000 (95%)] Loss: 0.63730 (QuantReg: 13.35503) QuantErr: 13.35503 batch_time=0.40329 
Train Epoch: 23 [481/500 30784/32000 (96%)] Loss: 0.58269 (QuantReg: 12.92801) QuantErr: 12.92801 batch_time=0.39338 
Train Epoch: 23 [489/500 31296/32000 (98%)] Loss: 0.82766 (QuantReg: 13.23983) QuantErr: 13.23983 batch_time=0.40480 
Train Epoch: 23 [497/500 31808/32000 (99%)] Loss: 1.01596 (QuantReg: 12.96358) QuantErr: 12.96358 batch_time=0.39531 
Train Epoch: 23 codebook_update_time=1.80520
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch23.pth ...
Done in 16.257s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch23.pth ...
Done in 39.398s
removing stale ckpt [epoch 22] [took 0.03s]
 epoch          : 23
 loss           : 0.8173434430956841
 quant_reg      : 13.203048263549805
 quant_err      : 13.203048263549805
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.987
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.29620534565342
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.5555
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.04201771373398
 mnt_best       : 44.29620534565342
 not_improved_count: 0
Train Epoch: 24 [1/500 64/32000 (0%)] Loss: 0.77120 (QuantReg: 13.19720) QuantErr: 13.19720 batch_time=21.75758 
Train Epoch: 24 [9/500 576/32000 (2%)] Loss: 1.12137 (QuantReg: 12.88259) QuantErr: 12.88259 batch_time=0.40402 
Train Epoch: 24 [17/500 1088/32000 (3%)] Loss: 1.13061 (QuantReg: 12.81678) QuantErr: 12.81678 batch_time=0.39375 
Train Epoch: 24 [25/500 1600/32000 (5%)] Loss: 0.44416 (QuantReg: 13.52774) QuantErr: 13.52774 batch_time=0.39866 
Train Epoch: 24 [33/500 2112/32000 (7%)] Loss: 0.47158 (QuantReg: 13.32837) QuantErr: 13.32837 batch_time=0.41433 
Train Epoch: 24 [41/500 2624/32000 (8%)] Loss: 0.84141 (QuantReg: 13.23503) QuantErr: 13.23503 batch_time=0.41402 
Train Epoch: 24 [49/500 3136/32000 (10%)] Loss: 1.01787 (QuantReg: 12.86830) QuantErr: 12.86830 batch_time=0.40616 
Train Epoch: 24 [57/500 3648/32000 (11%)] Loss: 0.93556 (QuantReg: 13.04121) QuantErr: 13.04121 batch_time=0.40430 
Train Epoch: 24 [65/500 4160/32000 (13%)] Loss: 0.67954 (QuantReg: 13.23717) QuantErr: 13.23717 batch_time=0.39941 
Train Epoch: 24 [73/500 4672/32000 (15%)] Loss: 0.75204 (QuantReg: 13.06305) QuantErr: 13.06305 batch_time=0.39593 
Train Epoch: 24 [81/500 5184/32000 (16%)] Loss: 0.90693 (QuantReg: 12.96510) QuantErr: 12.96510 batch_time=0.40036 
Train Epoch: 24 [89/500 5696/32000 (18%)] Loss: 1.02914 (QuantReg: 12.75610) QuantErr: 12.75610 batch_time=0.39802 
Train Epoch: 24 [97/500 6208/32000 (19%)] Loss: 1.01222 (QuantReg: 13.41799) QuantErr: 13.41799 batch_time=0.40793 
Train Epoch: 24 [105/500 6720/32000 (21%)] Loss: 0.56364 (QuantReg: 13.35754) QuantErr: 13.35754 batch_time=0.39634 
Train Epoch: 24 [113/500 7232/32000 (23%)] Loss: 0.88132 (QuantReg: 13.55255) QuantErr: 13.55255 batch_time=0.39115 
Train Epoch: 24 [121/500 7744/32000 (24%)] Loss: 0.97993 (QuantReg: 13.19299) QuantErr: 13.19299 batch_time=0.42048 
Train Epoch: 24 [129/500 8256/32000 (26%)] Loss: 0.54982 (QuantReg: 13.35915) QuantErr: 13.35915 batch_time=0.39715 
Train Epoch: 24 [137/500 8768/32000 (27%)] Loss: 1.03938 (QuantReg: 12.91566) QuantErr: 12.91566 batch_time=0.39998 
Train Epoch: 24 [145/500 9280/32000 (29%)] Loss: 0.63119 (QuantReg: 13.37592) QuantErr: 13.37592 batch_time=0.40080 
Train Epoch: 24 [153/500 9792/32000 (31%)] Loss: 0.62366 (QuantReg: 13.07915) QuantErr: 13.07915 batch_time=0.43506 
Train Epoch: 24 [161/500 10304/32000 (32%)] Loss: 1.03255 (QuantReg: 13.23027) QuantErr: 13.23027 batch_time=0.39990 
Train Epoch: 24 [169/500 10816/32000 (34%)] Loss: 0.78857 (QuantReg: 13.10070) QuantErr: 13.10070 batch_time=0.40598 
Train Epoch: 24 [177/500 11328/32000 (35%)] Loss: 0.74219 (QuantReg: 13.34429) QuantErr: 13.34429 batch_time=0.39454 
Train Epoch: 24 [185/500 11840/32000 (37%)] Loss: 0.64189 (QuantReg: 13.61861) QuantErr: 13.61861 batch_time=0.43934 
Train Epoch: 24 [193/500 12352/32000 (39%)] Loss: 0.61332 (QuantReg: 13.22215) QuantErr: 13.22215 batch_time=0.41595 
Train Epoch: 24 [201/500 12864/32000 (40%)] Loss: 0.75940 (QuantReg: 13.31840) QuantErr: 13.31840 batch_time=0.39956 
Train Epoch: 24 [209/500 13376/32000 (42%)] Loss: 1.03758 (QuantReg: 13.44248) QuantErr: 13.44248 batch_time=0.39569 
Train Epoch: 24 [217/500 13888/32000 (43%)] Loss: 0.58143 (QuantReg: 13.14643) QuantErr: 13.14643 batch_time=0.39432 
Train Epoch: 24 [225/500 14400/32000 (45%)] Loss: 1.03373 (QuantReg: 13.03650) QuantErr: 13.03650 batch_time=0.67096 
Train Epoch: 24 [233/500 14912/32000 (47%)] Loss: 0.53503 (QuantReg: 13.44022) QuantErr: 13.44022 batch_time=0.43363 
Train Epoch: 24 [241/500 15424/32000 (48%)] Loss: 0.81336 (QuantReg: 13.20562) QuantErr: 13.20562 batch_time=0.42541 
Train Epoch: 24 [249/500 15936/32000 (50%)] Loss: 0.51446 (QuantReg: 13.58986) QuantErr: 13.58986 batch_time=0.40038 
Train Epoch: 24 [257/500 16448/32000 (51%)] Loss: 0.49044 (QuantReg: 13.13807) QuantErr: 13.13807 batch_time=0.42219 
Train Epoch: 24 [265/500 16960/32000 (53%)] Loss: 0.82431 (QuantReg: 13.09614) QuantErr: 13.09614 batch_time=0.39386 
Train Epoch: 24 [273/500 17472/32000 (55%)] Loss: 0.69624 (QuantReg: 13.45448) QuantErr: 13.45448 batch_time=0.40694 
Train Epoch: 24 [281/500 17984/32000 (56%)] Loss: 0.58338 (QuantReg: 13.42599) QuantErr: 13.42599 batch_time=0.39764 
Train Epoch: 24 [289/500 18496/32000 (58%)] Loss: 0.64026 (QuantReg: 13.29155) QuantErr: 13.29155 batch_time=0.39503 
Train Epoch: 24 [297/500 19008/32000 (59%)] Loss: 0.96250 (QuantReg: 13.17070) QuantErr: 13.17070 batch_time=0.41986 
Train Epoch: 24 [305/500 19520/32000 (61%)] Loss: 0.72222 (QuantReg: 12.37825) QuantErr: 12.37825 batch_time=0.43808 
Train Epoch: 24 [313/500 20032/32000 (63%)] Loss: 0.55433 (QuantReg: 13.26819) QuantErr: 13.26819 batch_time=0.40168 
Train Epoch: 24 [321/500 20544/32000 (64%)] Loss: 1.14616 (QuantReg: 12.60063) QuantErr: 12.60063 batch_time=0.43315 
Train Epoch: 24 [329/500 21056/32000 (66%)] Loss: 0.61928 (QuantReg: 13.28153) QuantErr: 13.28153 batch_time=0.40016 
Train Epoch: 24 [337/500 21568/32000 (67%)] Loss: 0.70292 (QuantReg: 12.97821) QuantErr: 12.97821 batch_time=0.40296 
Train Epoch: 24 [345/500 22080/32000 (69%)] Loss: 0.93910 (QuantReg: 13.56154) QuantErr: 13.56154 batch_time=0.39274 
Train Epoch: 24 [353/500 22592/32000 (71%)] Loss: 0.63599 (QuantReg: 13.35686) QuantErr: 13.35686 batch_time=0.43435 
Train Epoch: 24 [361/500 23104/32000 (72%)] Loss: 0.41894 (QuantReg: 13.71474) QuantErr: 13.71474 batch_time=0.46868 
Train Epoch: 24 [369/500 23616/32000 (74%)] Loss: 0.97678 (QuantReg: 13.16250) QuantErr: 13.16250 batch_time=0.40203 
Train Epoch: 24 [377/500 24128/32000 (75%)] Loss: 1.12072 (QuantReg: 13.90942) QuantErr: 13.90942 batch_time=0.38788 
Train Epoch: 24 [385/500 24640/32000 (77%)] Loss: 0.69736 (QuantReg: 13.33705) QuantErr: 13.33705 batch_time=0.40068 
Train Epoch: 24 [393/500 25152/32000 (79%)] Loss: 0.52384 (QuantReg: 13.26447) QuantErr: 13.26447 batch_time=0.40502 
Train Epoch: 24 [401/500 25664/32000 (80%)] Loss: 1.26718 (QuantReg: 13.16146) QuantErr: 13.16146 batch_time=0.39551 
Train Epoch: 24 [409/500 26176/32000 (82%)] Loss: 0.87935 (QuantReg: 13.79259) QuantErr: 13.79259 batch_time=0.39752 
Train Epoch: 24 [417/500 26688/32000 (83%)] Loss: 0.62275 (QuantReg: 13.73422) QuantErr: 13.73422 batch_time=0.39947 
Train Epoch: 24 [425/500 27200/32000 (85%)] Loss: 1.07117 (QuantReg: 13.30935) QuantErr: 13.30935 batch_time=0.39252 
Train Epoch: 24 [433/500 27712/32000 (87%)] Loss: 0.53965 (QuantReg: 13.00358) QuantErr: 13.00358 batch_time=0.44079 
Train Epoch: 24 [441/500 28224/32000 (88%)] Loss: 1.00728 (QuantReg: 13.52911) QuantErr: 13.52911 batch_time=0.41125 
Train Epoch: 24 [449/500 28736/32000 (90%)] Loss: 1.43401 (QuantReg: 12.97585) QuantErr: 12.97585 batch_time=0.38728 
Train Epoch: 24 [457/500 29248/32000 (91%)] Loss: 0.55084 (QuantReg: 13.82074) QuantErr: 13.82074 batch_time=0.39875 
Train Epoch: 24 [465/500 29760/32000 (93%)] Loss: 1.05648 (QuantReg: 13.06641) QuantErr: 13.06641 batch_time=0.40195 
Train Epoch: 24 [473/500 30272/32000 (95%)] Loss: 0.64925 (QuantReg: 13.19115) QuantErr: 13.19115 batch_time=0.39482 
Train Epoch: 24 [481/500 30784/32000 (96%)] Loss: 0.56772 (QuantReg: 13.41802) QuantErr: 13.41802 batch_time=0.39140 
Train Epoch: 24 [489/500 31296/32000 (98%)] Loss: 0.51257 (QuantReg: 13.63390) QuantErr: 13.63390 batch_time=0.39507 
Train Epoch: 24 [497/500 31808/32000 (99%)] Loss: 0.70408 (QuantReg: 13.30762) QuantErr: 13.30762 batch_time=0.41212 
Train Epoch: 24 codebook_update_time=1.82430
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch24.pth ...
Done in 4.610s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch24.pth ...
Done in 10.055s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 0.7622597524523735
 quant_reg      : 13.261261867523194
 quant_err      : 13.261261867523194
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.46
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.481525807906294
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.206
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.736834344683906
 mnt_best       : 44.481525807906294
 not_improved_count: 0
Train Epoch: 25 [1/500 64/32000 (0%)] Loss: 0.89967 (QuantReg: 13.03373) QuantErr: 13.03373 batch_time=22.39194 
Train Epoch: 25 [9/500 576/32000 (2%)] Loss: 0.70386 (QuantReg: 13.38309) QuantErr: 13.38309 batch_time=0.40611 
Train Epoch: 25 [17/500 1088/32000 (3%)] Loss: 0.49072 (QuantReg: 13.41778) QuantErr: 13.41778 batch_time=0.40515 
Train Epoch: 25 [25/500 1600/32000 (5%)] Loss: 0.79329 (QuantReg: 13.09901) QuantErr: 13.09901 batch_time=0.39374 
Train Epoch: 25 [33/500 2112/32000 (7%)] Loss: 0.61584 (QuantReg: 12.78957) QuantErr: 12.78957 batch_time=0.43015 
Train Epoch: 25 [41/500 2624/32000 (8%)] Loss: 0.70201 (QuantReg: 13.37044) QuantErr: 13.37044 batch_time=0.39525 
Train Epoch: 25 [49/500 3136/32000 (10%)] Loss: 0.85219 (QuantReg: 12.68320) QuantErr: 12.68320 batch_time=0.40471 
Train Epoch: 25 [57/500 3648/32000 (11%)] Loss: 0.43456 (QuantReg: 13.14258) QuantErr: 13.14258 batch_time=0.39821 
Train Epoch: 25 [65/500 4160/32000 (13%)] Loss: 0.75123 (QuantReg: 12.60359) QuantErr: 12.60359 batch_time=0.66098 
Train Epoch: 25 [73/500 4672/32000 (15%)] Loss: 1.08752 (QuantReg: 13.21572) QuantErr: 13.21572 batch_time=0.39348 
Train Epoch: 25 [81/500 5184/32000 (16%)] Loss: 0.88826 (QuantReg: 13.23356) QuantErr: 13.23356 batch_time=0.40748 
Train Epoch: 25 [89/500 5696/32000 (18%)] Loss: 0.68088 (QuantReg: 13.39182) QuantErr: 13.39182 batch_time=0.40568 
Train Epoch: 25 [97/500 6208/32000 (19%)] Loss: 0.80144 (QuantReg: 13.28965) QuantErr: 13.28965 batch_time=0.54488 
Train Epoch: 25 [105/500 6720/32000 (21%)] Loss: 1.05585 (QuantReg: 13.43697) QuantErr: 13.43697 batch_time=0.40715 
Train Epoch: 25 [113/500 7232/32000 (23%)] Loss: 0.50021 (QuantReg: 13.26445) QuantErr: 13.26445 batch_time=0.40071 
Train Epoch: 25 [121/500 7744/32000 (24%)] Loss: 0.78811 (QuantReg: 13.35340) QuantErr: 13.35340 batch_time=0.40384 
Train Epoch: 25 [129/500 8256/32000 (26%)] Loss: 0.78412 (QuantReg: 13.41196) QuantErr: 13.41196 batch_time=0.65521 
Train Epoch: 25 [137/500 8768/32000 (27%)] Loss: 0.84101 (QuantReg: 13.27067) QuantErr: 13.27067 batch_time=0.40353 
Train Epoch: 25 [145/500 9280/32000 (29%)] Loss: 0.65585 (QuantReg: 12.88747) QuantErr: 12.88747 batch_time=0.40622 
Train Epoch: 25 [153/500 9792/32000 (31%)] Loss: 0.98983 (QuantReg: 12.56732) QuantErr: 12.56732 batch_time=0.59900 
Train Epoch: 25 [161/500 10304/32000 (32%)] Loss: 0.65415 (QuantReg: 13.11416) QuantErr: 13.11416 batch_time=0.39980 
Train Epoch: 25 [169/500 10816/32000 (34%)] Loss: 0.41406 (QuantReg: 12.73317) QuantErr: 12.73317 batch_time=0.39102 
Train Epoch: 25 [177/500 11328/32000 (35%)] Loss: 0.85707 (QuantReg: 13.10341) QuantErr: 13.10341 batch_time=0.40588 
Train Epoch: 25 [185/500 11840/32000 (37%)] Loss: 0.32280 (QuantReg: 13.19604) QuantErr: 13.19604 batch_time=0.40589 
Train Epoch: 25 [193/500 12352/32000 (39%)] Loss: 0.61164 (QuantReg: 13.40346) QuantErr: 13.40346 batch_time=0.63565 
Train Epoch: 25 [201/500 12864/32000 (40%)] Loss: 0.41890 (QuantReg: 13.40651) QuantErr: 13.40651 batch_time=0.40208 
Train Epoch: 25 [209/500 13376/32000 (42%)] Loss: 0.87842 (QuantReg: 12.91173) QuantErr: 12.91173 batch_time=0.41824 
Train Epoch: 25 [217/500 13888/32000 (43%)] Loss: 0.98941 (QuantReg: 12.90799) QuantErr: 12.90799 batch_time=0.40661 
Train Epoch: 25 [225/500 14400/32000 (45%)] Loss: 0.92299 (QuantReg: 13.62332) QuantErr: 13.62332 batch_time=0.42515 
Train Epoch: 25 [233/500 14912/32000 (47%)] Loss: 0.76671 (QuantReg: 13.42556) QuantErr: 13.42556 batch_time=0.41471 
Train Epoch: 25 [241/500 15424/32000 (48%)] Loss: 0.73741 (QuantReg: 14.02251) QuantErr: 14.02251 batch_time=0.40412 
Train Epoch: 25 [249/500 15936/32000 (50%)] Loss: 0.50808 (QuantReg: 13.27983) QuantErr: 13.27983 batch_time=0.38399 
Train Epoch: 25 [257/500 16448/32000 (51%)] Loss: 0.67505 (QuantReg: 13.66862) QuantErr: 13.66862 batch_time=0.41450 
Train Epoch: 25 [265/500 16960/32000 (53%)] Loss: 0.76446 (QuantReg: 12.88879) QuantErr: 12.88879 batch_time=0.40482 
Train Epoch: 25 [273/500 17472/32000 (55%)] Loss: 1.08303 (QuantReg: 13.00650) QuantErr: 13.00650 batch_time=0.41230 
Train Epoch: 25 [281/500 17984/32000 (56%)] Loss: 0.63135 (QuantReg: 13.71073) QuantErr: 13.71073 batch_time=0.41636 
Train Epoch: 25 [289/500 18496/32000 (58%)] Loss: 0.55483 (QuantReg: 12.99265) QuantErr: 12.99265 batch_time=0.40049 
Train Epoch: 25 [297/500 19008/32000 (59%)] Loss: 0.86884 (QuantReg: 12.77705) QuantErr: 12.77705 batch_time=0.42929 
Train Epoch: 25 [305/500 19520/32000 (61%)] Loss: 0.67508 (QuantReg: 13.02061) QuantErr: 13.02061 batch_time=0.40769 
Train Epoch: 25 [313/500 20032/32000 (63%)] Loss: 0.42713 (QuantReg: 13.03431) QuantErr: 13.03431 batch_time=0.39853 
Train Epoch: 25 [321/500 20544/32000 (64%)] Loss: 0.86976 (QuantReg: 13.74892) QuantErr: 13.74892 batch_time=0.41918 
Train Epoch: 25 [329/500 21056/32000 (66%)] Loss: 0.77026 (QuantReg: 12.97953) QuantErr: 12.97953 batch_time=0.49674 
Train Epoch: 25 [337/500 21568/32000 (67%)] Loss: 0.74232 (QuantReg: 12.80205) QuantErr: 12.80205 batch_time=0.40506 
Train Epoch: 25 [345/500 22080/32000 (69%)] Loss: 0.87015 (QuantReg: 13.67264) QuantErr: 13.67264 batch_time=0.40544 
Train Epoch: 25 [353/500 22592/32000 (71%)] Loss: 0.87996 (QuantReg: 13.52957) QuantErr: 13.52957 batch_time=0.38978 
Train Epoch: 25 [361/500 23104/32000 (72%)] Loss: 0.73474 (QuantReg: 12.96068) QuantErr: 12.96068 batch_time=0.39529 
Train Epoch: 25 [369/500 23616/32000 (74%)] Loss: 0.66603 (QuantReg: 13.40245) QuantErr: 13.40245 batch_time=0.38849 
Train Epoch: 25 [377/500 24128/32000 (75%)] Loss: 0.76301 (QuantReg: 13.12819) QuantErr: 13.12819 batch_time=0.40421 
Train Epoch: 25 [385/500 24640/32000 (77%)] Loss: 1.24471 (QuantReg: 13.27043) QuantErr: 13.27043 batch_time=0.40315 
Train Epoch: 25 [393/500 25152/32000 (79%)] Loss: 0.83436 (QuantReg: 13.04946) QuantErr: 13.04946 batch_time=0.39272 
Train Epoch: 25 [401/500 25664/32000 (80%)] Loss: 0.75812 (QuantReg: 12.89937) QuantErr: 12.89937 batch_time=0.39920 
Train Epoch: 25 [409/500 26176/32000 (82%)] Loss: 0.49003 (QuantReg: 13.32264) QuantErr: 13.32264 batch_time=0.38805 
Train Epoch: 25 [417/500 26688/32000 (83%)] Loss: 0.44335 (QuantReg: 13.88792) QuantErr: 13.88792 batch_time=0.38259 
Train Epoch: 25 [425/500 27200/32000 (85%)] Loss: 1.02297 (QuantReg: 13.21514) QuantErr: 13.21514 batch_time=0.42477 
Train Epoch: 25 [433/500 27712/32000 (87%)] Loss: 0.71439 (QuantReg: 13.25803) QuantErr: 13.25803 batch_time=0.38628 
Train Epoch: 25 [441/500 28224/32000 (88%)] Loss: 0.93673 (QuantReg: 13.93933) QuantErr: 13.93933 batch_time=0.38594 
Train Epoch: 25 [449/500 28736/32000 (90%)] Loss: 0.76308 (QuantReg: 13.36748) QuantErr: 13.36748 batch_time=0.45743 
Train Epoch: 25 [457/500 29248/32000 (91%)] Loss: 0.70656 (QuantReg: 13.30828) QuantErr: 13.30828 batch_time=0.38613 
Train Epoch: 25 [465/500 29760/32000 (93%)] Loss: 0.57894 (QuantReg: 12.94872) QuantErr: 12.94872 batch_time=0.40258 
Train Epoch: 25 [473/500 30272/32000 (95%)] Loss: 0.66967 (QuantReg: 13.07294) QuantErr: 13.07294 batch_time=0.40757 
Train Epoch: 25 [481/500 30784/32000 (96%)] Loss: 0.53895 (QuantReg: 13.23949) QuantErr: 13.23949 batch_time=0.41831 
Train Epoch: 25 [489/500 31296/32000 (98%)] Loss: 0.72191 (QuantReg: 13.45881) QuantErr: 13.45881 batch_time=0.39912 
Train Epoch: 25 [497/500 31808/32000 (99%)] Loss: 1.17693 (QuantReg: 13.71459) QuantErr: 13.71459 batch_time=0.48614 
Train Epoch: 25 codebook_update_time=1.75157
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch25.pth ...
Done in 3.841s
removing stale ckpt [epoch 24] [took 0.01s]
 epoch          : 25
 loss           : 0.748383938074112
 quant_reg      : 13.254135107040405
 quant_err      : 13.254135107040405
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.649
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.7022946673162
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.742
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.23505224811814
 mnt_best       : 44.481525807906294
 not_improved_count: 1
Train Epoch: 26 [1/500 64/32000 (0%)] Loss: 0.56116 (QuantReg: 13.04970) QuantErr: 13.04970 batch_time=21.99535 
Train Epoch: 26 [9/500 576/32000 (2%)] Loss: 0.94032 (QuantReg: 13.29234) QuantErr: 13.29234 batch_time=0.39507 
Train Epoch: 26 [17/500 1088/32000 (3%)] Loss: 0.90303 (QuantReg: 13.34470) QuantErr: 13.34470 batch_time=0.38592 
Train Epoch: 26 [25/500 1600/32000 (5%)] Loss: 0.82136 (QuantReg: 13.25020) QuantErr: 13.25020 batch_time=0.38226 
Train Epoch: 26 [33/500 2112/32000 (7%)] Loss: 0.51221 (QuantReg: 13.04258) QuantErr: 13.04258 batch_time=0.38878 
Train Epoch: 26 [41/500 2624/32000 (8%)] Loss: 0.88623 (QuantReg: 13.00729) QuantErr: 13.00729 batch_time=0.41807 
Train Epoch: 26 [49/500 3136/32000 (10%)] Loss: 0.87203 (QuantReg: 13.40426) QuantErr: 13.40426 batch_time=0.40233 
Train Epoch: 26 [57/500 3648/32000 (11%)] Loss: 0.88301 (QuantReg: 13.15524) QuantErr: 13.15524 batch_time=0.40167 
Train Epoch: 26 [65/500 4160/32000 (13%)] Loss: 0.83913 (QuantReg: 13.22170) QuantErr: 13.22170 batch_time=0.93767 
Train Epoch: 26 [73/500 4672/32000 (15%)] Loss: 0.75458 (QuantReg: 13.50685) QuantErr: 13.50685 batch_time=0.40517 
Train Epoch: 26 [81/500 5184/32000 (16%)] Loss: 0.81603 (QuantReg: 12.89997) QuantErr: 12.89997 batch_time=0.38923 
Train Epoch: 26 [89/500 5696/32000 (18%)] Loss: 0.59776 (QuantReg: 13.02578) QuantErr: 13.02578 batch_time=0.87245 
Train Epoch: 26 [97/500 6208/32000 (19%)] Loss: 0.67607 (QuantReg: 13.28063) QuantErr: 13.28063 batch_time=0.39611 
Train Epoch: 26 [105/500 6720/32000 (21%)] Loss: 0.57307 (QuantReg: 13.57721) QuantErr: 13.57721 batch_time=0.40175 
Train Epoch: 26 [113/500 7232/32000 (23%)] Loss: 0.93840 (QuantReg: 12.93220) QuantErr: 12.93220 batch_time=0.44102 
Train Epoch: 26 [121/500 7744/32000 (24%)] Loss: 0.80367 (QuantReg: 13.56398) QuantErr: 13.56398 batch_time=0.39201 
Train Epoch: 26 [129/500 8256/32000 (26%)] Loss: 0.62724 (QuantReg: 13.13741) QuantErr: 13.13741 batch_time=0.90104 
Train Epoch: 26 [137/500 8768/32000 (27%)] Loss: 0.94440 (QuantReg: 13.59212) QuantErr: 13.59212 batch_time=0.40002 
Train Epoch: 26 [145/500 9280/32000 (29%)] Loss: 0.74322 (QuantReg: 13.25900) QuantErr: 13.25900 batch_time=0.40737 
Train Epoch: 26 [153/500 9792/32000 (31%)] Loss: 0.70762 (QuantReg: 12.98986) QuantErr: 12.98986 batch_time=0.40328 
Train Epoch: 26 [161/500 10304/32000 (32%)] Loss: 0.55749 (QuantReg: 12.93232) QuantErr: 12.93232 batch_time=0.46648 
Train Epoch: 26 [169/500 10816/32000 (34%)] Loss: 0.63637 (QuantReg: 13.32088) QuantErr: 13.32088 batch_time=0.41153 
Train Epoch: 26 [177/500 11328/32000 (35%)] Loss: 0.72458 (QuantReg: 13.25949) QuantErr: 13.25949 batch_time=0.40305 
Train Epoch: 26 [185/500 11840/32000 (37%)] Loss: 0.53123 (QuantReg: 13.28237) QuantErr: 13.28237 batch_time=4.03726 
Train Epoch: 26 [193/500 12352/32000 (39%)] Loss: 1.16105 (QuantReg: 13.20142) QuantErr: 13.20142 batch_time=0.69062 
Train Epoch: 26 [201/500 12864/32000 (40%)] Loss: 0.65002 (QuantReg: 13.09800) QuantErr: 13.09800 batch_time=0.40004 
Train Epoch: 26 [209/500 13376/32000 (42%)] Loss: 0.66302 (QuantReg: 13.21670) QuantErr: 13.21670 batch_time=0.42746 
Train Epoch: 26 [217/500 13888/32000 (43%)] Loss: 0.76937 (QuantReg: 13.43734) QuantErr: 13.43734 batch_time=0.38874 
Train Epoch: 26 [225/500 14400/32000 (45%)] Loss: 0.75037 (QuantReg: 13.34919) QuantErr: 13.34919 batch_time=0.41921 
Train Epoch: 26 [233/500 14912/32000 (47%)] Loss: 0.74617 (QuantReg: 13.15916) QuantErr: 13.15916 batch_time=0.39908 
Train Epoch: 26 [241/500 15424/32000 (48%)] Loss: 0.83809 (QuantReg: 12.92803) QuantErr: 12.92803 batch_time=0.39819 
Train Epoch: 26 [249/500 15936/32000 (50%)] Loss: 0.61818 (QuantReg: 13.61745) QuantErr: 13.61745 batch_time=3.29727 
Train Epoch: 26 [257/500 16448/32000 (51%)] Loss: 1.32108 (QuantReg: 13.50660) QuantErr: 13.50660 batch_time=0.39334 
Train Epoch: 26 [265/500 16960/32000 (53%)] Loss: 0.51256 (QuantReg: 13.45201) QuantErr: 13.45201 batch_time=0.38851 
Train Epoch: 26 [273/500 17472/32000 (55%)] Loss: 1.02096 (QuantReg: 13.59865) QuantErr: 13.59865 batch_time=0.40009 
Train Epoch: 26 [281/500 17984/32000 (56%)] Loss: 1.04935 (QuantReg: 12.89807) QuantErr: 12.89807 batch_time=0.39692 
Train Epoch: 26 [289/500 18496/32000 (58%)] Loss: 0.96380 (QuantReg: 13.35068) QuantErr: 13.35068 batch_time=0.40612 
Train Epoch: 26 [297/500 19008/32000 (59%)] Loss: 0.46942 (QuantReg: 13.84659) QuantErr: 13.84659 batch_time=0.41752 
Train Epoch: 26 [305/500 19520/32000 (61%)] Loss: 1.02750 (QuantReg: 13.21938) QuantErr: 13.21938 batch_time=0.40890 
Train Epoch: 26 [313/500 20032/32000 (63%)] Loss: 0.64029 (QuantReg: 13.27823) QuantErr: 13.27823 batch_time=3.54648 
Train Epoch: 26 [321/500 20544/32000 (64%)] Loss: 0.82995 (QuantReg: 13.29465) QuantErr: 13.29465 batch_time=0.40312 
Train Epoch: 26 [329/500 21056/32000 (66%)] Loss: 0.46607 (QuantReg: 13.57561) QuantErr: 13.57561 batch_time=0.40351 
Train Epoch: 26 [337/500 21568/32000 (67%)] Loss: 0.63998 (QuantReg: 13.73845) QuantErr: 13.73845 batch_time=0.40281 
Train Epoch: 26 [345/500 22080/32000 (69%)] Loss: 0.31029 (QuantReg: 13.80432) QuantErr: 13.80432 batch_time=0.40583 
Train Epoch: 26 [353/500 22592/32000 (71%)] Loss: 0.97464 (QuantReg: 13.68719) QuantErr: 13.68719 batch_time=0.41003 
Train Epoch: 26 [361/500 23104/32000 (72%)] Loss: 0.92196 (QuantReg: 13.18800) QuantErr: 13.18800 batch_time=0.39384 
Train Epoch: 26 [369/500 23616/32000 (74%)] Loss: 0.55196 (QuantReg: 13.33074) QuantErr: 13.33074 batch_time=0.43926 
Train Epoch: 26 [377/500 24128/32000 (75%)] Loss: 0.89112 (QuantReg: 13.62242) QuantErr: 13.62242 batch_time=3.39835 
Train Epoch: 26 [385/500 24640/32000 (77%)] Loss: 1.32182 (QuantReg: 12.92945) QuantErr: 12.92945 batch_time=0.39613 
Train Epoch: 26 [393/500 25152/32000 (79%)] Loss: 0.74743 (QuantReg: 12.94000) QuantErr: 12.94000 batch_time=0.42492 
Train Epoch: 26 [401/500 25664/32000 (80%)] Loss: 0.68217 (QuantReg: 13.57243) QuantErr: 13.57243 batch_time=0.39506 
Train Epoch: 26 [409/500 26176/32000 (82%)] Loss: 0.75493 (QuantReg: 13.71059) QuantErr: 13.71059 batch_time=0.38835 
Train Epoch: 26 [417/500 26688/32000 (83%)] Loss: 0.53335 (QuantReg: 13.21283) QuantErr: 13.21283 batch_time=0.39005 
Train Epoch: 26 [425/500 27200/32000 (85%)] Loss: 0.98441 (QuantReg: 13.09550) QuantErr: 13.09550 batch_time=0.40880 
Train Epoch: 26 [433/500 27712/32000 (87%)] Loss: 0.72579 (QuantReg: 13.42068) QuantErr: 13.42068 batch_time=0.39504 
Train Epoch: 26 [441/500 28224/32000 (88%)] Loss: 0.85186 (QuantReg: 13.46746) QuantErr: 13.46746 batch_time=3.31966 
Train Epoch: 26 [449/500 28736/32000 (90%)] Loss: 0.92664 (QuantReg: 12.84793) QuantErr: 12.84793 batch_time=0.39017 
Train Epoch: 26 [457/500 29248/32000 (91%)] Loss: 1.11733 (QuantReg: 13.19954) QuantErr: 13.19954 batch_time=0.39599 
Train Epoch: 26 [465/500 29760/32000 (93%)] Loss: 0.81715 (QuantReg: 13.11047) QuantErr: 13.11047 batch_time=0.39268 
Train Epoch: 26 [473/500 30272/32000 (95%)] Loss: 0.60913 (QuantReg: 13.34557) QuantErr: 13.34557 batch_time=0.38896 
Train Epoch: 26 [481/500 30784/32000 (96%)] Loss: 0.89712 (QuantReg: 13.11667) QuantErr: 13.11667 batch_time=0.39029 
Train Epoch: 26 [489/500 31296/32000 (98%)] Loss: 0.85611 (QuantReg: 12.61578) QuantErr: 12.61578 batch_time=0.40064 
Train Epoch: 26 [497/500 31808/32000 (99%)] Loss: 0.95930 (QuantReg: 13.30411) QuantErr: 13.30411 batch_time=0.39923 
Train Epoch: 26 codebook_update_time=1.86088
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch26.pth ...
Done in 4.128s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 0.7530242204070091
 quant_reg      : 13.272906806945802
 quant_err      : 13.272906806945802
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 13000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.062
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.86260516263658
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.597
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.05652617971762
 mnt_best       : 44.481525807906294
 not_improved_count: 2
Train Epoch: 27 [1/500 64/32000 (0%)] Loss: 0.69343 (QuantReg: 13.31599) QuantErr: 13.31599 batch_time=25.29942 
Train Epoch: 27 [9/500 576/32000 (2%)] Loss: 0.51771 (QuantReg: 13.48738) QuantErr: 13.48738 batch_time=0.64233 
Train Epoch: 27 [17/500 1088/32000 (3%)] Loss: 0.79609 (QuantReg: 13.17766) QuantErr: 13.17766 batch_time=0.39946 
Train Epoch: 27 [25/500 1600/32000 (5%)] Loss: 0.61371 (QuantReg: 13.35889) QuantErr: 13.35889 batch_time=1.10275 
Train Epoch: 27 [33/500 2112/32000 (7%)] Loss: 0.62546 (QuantReg: 13.09519) QuantErr: 13.09519 batch_time=0.56690 
Train Epoch: 27 [41/500 2624/32000 (8%)] Loss: 0.67226 (QuantReg: 13.12593) QuantErr: 13.12593 batch_time=0.41990 
Train Epoch: 27 [49/500 3136/32000 (10%)] Loss: 0.72155 (QuantReg: 13.30592) QuantErr: 13.30592 batch_time=0.39900 
Train Epoch: 27 [57/500 3648/32000 (11%)] Loss: 0.46711 (QuantReg: 13.34940) QuantErr: 13.34940 batch_time=0.40481 
Train Epoch: 27 [65/500 4160/32000 (13%)] Loss: 0.62663 (QuantReg: 13.48883) QuantErr: 13.48883 batch_time=0.38557 
Train Epoch: 27 [73/500 4672/32000 (15%)] Loss: 0.51719 (QuantReg: 13.65078) QuantErr: 13.65078 batch_time=0.38652 
Train Epoch: 27 [81/500 5184/32000 (16%)] Loss: 0.60620 (QuantReg: 13.44996) QuantErr: 13.44996 batch_time=0.38575 
Train Epoch: 27 [89/500 5696/32000 (18%)] Loss: 0.68836 (QuantReg: 13.70906) QuantErr: 13.70906 batch_time=0.98188 
Train Epoch: 27 [97/500 6208/32000 (19%)] Loss: 0.67832 (QuantReg: 13.54009) QuantErr: 13.54009 batch_time=0.41214 
Train Epoch: 27 [105/500 6720/32000 (21%)] Loss: 0.33246 (QuantReg: 13.90676) QuantErr: 13.90676 batch_time=0.40633 
Train Epoch: 27 [113/500 7232/32000 (23%)] Loss: 0.81328 (QuantReg: 13.86674) QuantErr: 13.86674 batch_time=0.40516 
Train Epoch: 27 [121/500 7744/32000 (24%)] Loss: 0.58794 (QuantReg: 13.24428) QuantErr: 13.24428 batch_time=0.43021 
Train Epoch: 27 [129/500 8256/32000 (26%)] Loss: 0.92786 (QuantReg: 13.55873) QuantErr: 13.55873 batch_time=0.40575 
Train Epoch: 27 [137/500 8768/32000 (27%)] Loss: 0.67682 (QuantReg: 13.38466) QuantErr: 13.38466 batch_time=0.39281 
Train Epoch: 27 [145/500 9280/32000 (29%)] Loss: 0.46350 (QuantReg: 13.67425) QuantErr: 13.67425 batch_time=0.38743 
Train Epoch: 27 [153/500 9792/32000 (31%)] Loss: 0.50366 (QuantReg: 13.17006) QuantErr: 13.17006 batch_time=1.03225 
Train Epoch: 27 [161/500 10304/32000 (32%)] Loss: 0.61453 (QuantReg: 12.82673) QuantErr: 12.82673 batch_time=0.39385 
Train Epoch: 27 [169/500 10816/32000 (34%)] Loss: 0.46127 (QuantReg: 13.39238) QuantErr: 13.39238 batch_time=0.39844 
Train Epoch: 27 [177/500 11328/32000 (35%)] Loss: 0.81427 (QuantReg: 13.13656) QuantErr: 13.13656 batch_time=0.39361 
Train Epoch: 27 [185/500 11840/32000 (37%)] Loss: 0.63435 (QuantReg: 13.52010) QuantErr: 13.52010 batch_time=0.39121 
Train Epoch: 27 [193/500 12352/32000 (39%)] Loss: 0.57753 (QuantReg: 13.26713) QuantErr: 13.26713 batch_time=0.39370 
Train Epoch: 27 [201/500 12864/32000 (40%)] Loss: 0.63514 (QuantReg: 13.26285) QuantErr: 13.26285 batch_time=0.38528 
Train Epoch: 27 [209/500 13376/32000 (42%)] Loss: 0.62478 (QuantReg: 13.15691) QuantErr: 13.15691 batch_time=0.38450 
Train Epoch: 27 [217/500 13888/32000 (43%)] Loss: 0.60867 (QuantReg: 13.63537) QuantErr: 13.63537 batch_time=0.96675 
Train Epoch: 27 [225/500 14400/32000 (45%)] Loss: 0.48564 (QuantReg: 13.79211) QuantErr: 13.79211 batch_time=0.39595 
Train Epoch: 27 [233/500 14912/32000 (47%)] Loss: 1.07812 (QuantReg: 13.23487) QuantErr: 13.23487 batch_time=0.40346 
Train Epoch: 27 [241/500 15424/32000 (48%)] Loss: 0.32138 (QuantReg: 13.34282) QuantErr: 13.34282 batch_time=0.46446 
Train Epoch: 27 [249/500 15936/32000 (50%)] Loss: 0.46565 (QuantReg: 13.50933) QuantErr: 13.50933 batch_time=0.39054 
Train Epoch: 27 [257/500 16448/32000 (51%)] Loss: 0.51486 (QuantReg: 13.29577) QuantErr: 13.29577 batch_time=0.41207 
Train Epoch: 27 [265/500 16960/32000 (53%)] Loss: 0.61868 (QuantReg: 13.22172) QuantErr: 13.22172 batch_time=0.40220 
Train Epoch: 27 [273/500 17472/32000 (55%)] Loss: 0.55555 (QuantReg: 13.25732) QuantErr: 13.25732 batch_time=0.42694 
Train Epoch: 27 [281/500 17984/32000 (56%)] Loss: 0.49547 (QuantReg: 13.31666) QuantErr: 13.31666 batch_time=0.97638 
Train Epoch: 27 [289/500 18496/32000 (58%)] Loss: 0.75816 (QuantReg: 13.14021) QuantErr: 13.14021 batch_time=0.38884 
Train Epoch: 27 [297/500 19008/32000 (59%)] Loss: 0.66706 (QuantReg: 13.76849) QuantErr: 13.76849 batch_time=0.39729 
Train Epoch: 27 [305/500 19520/32000 (61%)] Loss: 0.78206 (QuantReg: 13.47426) QuantErr: 13.47426 batch_time=0.39709 
Train Epoch: 27 [313/500 20032/32000 (63%)] Loss: 0.77253 (QuantReg: 13.15646) QuantErr: 13.15646 batch_time=0.39598 
Train Epoch: 27 [321/500 20544/32000 (64%)] Loss: 0.77995 (QuantReg: 13.59773) QuantErr: 13.59773 batch_time=0.39691 
Train Epoch: 27 [329/500 21056/32000 (66%)] Loss: 0.53277 (QuantReg: 13.39063) QuantErr: 13.39063 batch_time=0.39504 
Train Epoch: 27 [337/500 21568/32000 (67%)] Loss: 0.61561 (QuantReg: 12.92858) QuantErr: 12.92858 batch_time=0.44196 
Train Epoch: 27 [345/500 22080/32000 (69%)] Loss: 0.74302 (QuantReg: 12.99856) QuantErr: 12.99856 batch_time=0.99549 
Train Epoch: 27 [353/500 22592/32000 (71%)] Loss: 0.60143 (QuantReg: 13.48345) QuantErr: 13.48345 batch_time=0.39245 
Train Epoch: 27 [361/500 23104/32000 (72%)] Loss: 0.51803 (QuantReg: 13.33685) QuantErr: 13.33685 batch_time=0.46835 
Train Epoch: 27 [369/500 23616/32000 (74%)] Loss: 1.25560 (QuantReg: 13.06927) QuantErr: 13.06927 batch_time=0.44212 
Train Epoch: 27 [377/500 24128/32000 (75%)] Loss: 0.52359 (QuantReg: 13.50073) QuantErr: 13.50073 batch_time=0.40820 
Train Epoch: 27 [385/500 24640/32000 (77%)] Loss: 0.41115 (QuantReg: 13.44014) QuantErr: 13.44014 batch_time=0.42232 
Train Epoch: 27 [393/500 25152/32000 (79%)] Loss: 0.76704 (QuantReg: 13.20073) QuantErr: 13.20073 batch_time=0.48643 
Train Epoch: 27 [401/500 25664/32000 (80%)] Loss: 0.62673 (QuantReg: 13.39349) QuantErr: 13.39349 batch_time=0.41178 
Train Epoch: 27 [409/500 26176/32000 (82%)] Loss: 0.76503 (QuantReg: 12.80718) QuantErr: 12.80718 batch_time=0.99590 
Train Epoch: 27 [417/500 26688/32000 (83%)] Loss: 0.62260 (QuantReg: 13.70374) QuantErr: 13.70374 batch_time=0.38721 
Train Epoch: 27 [425/500 27200/32000 (85%)] Loss: 0.77910 (QuantReg: 13.11200) QuantErr: 13.11200 batch_time=0.42248 
Train Epoch: 27 [433/500 27712/32000 (87%)] Loss: 0.63131 (QuantReg: 13.29096) QuantErr: 13.29096 batch_time=0.83608 
Train Epoch: 27 [441/500 28224/32000 (88%)] Loss: 0.84160 (QuantReg: 13.11794) QuantErr: 13.11794 batch_time=0.39729 
Train Epoch: 27 [449/500 28736/32000 (90%)] Loss: 1.20049 (QuantReg: 13.56888) QuantErr: 13.56888 batch_time=0.39484 
Train Epoch: 27 [457/500 29248/32000 (91%)] Loss: 0.76965 (QuantReg: 13.23614) QuantErr: 13.23614 batch_time=0.38965 
Train Epoch: 27 [465/500 29760/32000 (93%)] Loss: 0.62583 (QuantReg: 13.20588) QuantErr: 13.20588 batch_time=0.38571 
Train Epoch: 27 [473/500 30272/32000 (95%)] Loss: 0.45423 (QuantReg: 13.49156) QuantErr: 13.49156 batch_time=1.05415 
Train Epoch: 27 [481/500 30784/32000 (96%)] Loss: 0.53380 (QuantReg: 13.30694) QuantErr: 13.30694 batch_time=0.38493 
Train Epoch: 27 [489/500 31296/32000 (98%)] Loss: 1.08618 (QuantReg: 13.17660) QuantErr: 13.17660 batch_time=0.46755 
Train Epoch: 27 [497/500 31808/32000 (99%)] Loss: 0.44868 (QuantReg: 13.22096) QuantErr: 13.22096 batch_time=0.44454 
Train Epoch: 27 codebook_update_time=1.72017
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch27.pth ...
Done in 4.904s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 0.7150077788233757
 quant_reg      : 13.322550050735474
 quant_err      : 13.322550050735474
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 13500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.959
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.695298382130225
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.6755
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.407103265233516
 mnt_best       : 44.481525807906294
 not_improved_count: 3
Train Epoch: 28 [1/500 64/32000 (0%)] Loss: 0.56078 (QuantReg: 12.88618) QuantErr: 12.88618 batch_time=27.53600 
Train Epoch: 28 [9/500 576/32000 (2%)] Loss: 0.87558 (QuantReg: 13.49442) QuantErr: 13.49442 batch_time=0.67836 
Train Epoch: 28 [17/500 1088/32000 (3%)] Loss: 0.83816 (QuantReg: 13.07492) QuantErr: 13.07492 batch_time=0.41532 
Train Epoch: 28 [25/500 1600/32000 (5%)] Loss: 0.93680 (QuantReg: 13.32898) QuantErr: 13.32898 batch_time=0.40617 
Train Epoch: 28 [33/500 2112/32000 (7%)] Loss: 0.57745 (QuantReg: 13.47223) QuantErr: 13.47223 batch_time=0.40109 
Train Epoch: 28 [41/500 2624/32000 (8%)] Loss: 0.71086 (QuantReg: 13.36996) QuantErr: 13.36996 batch_time=0.40130 
Train Epoch: 28 [49/500 3136/32000 (10%)] Loss: 0.93329 (QuantReg: 13.38105) QuantErr: 13.38105 batch_time=0.40857 
Train Epoch: 28 [57/500 3648/32000 (11%)] Loss: 0.51083 (QuantReg: 13.11484) QuantErr: 13.11484 batch_time=0.39905 
Train Epoch: 28 [65/500 4160/32000 (13%)] Loss: 0.61446 (QuantReg: 13.62513) QuantErr: 13.62513 batch_time=0.54706 
Train Epoch: 28 [73/500 4672/32000 (15%)] Loss: 1.01082 (QuantReg: 13.14314) QuantErr: 13.14314 batch_time=0.40544 
Train Epoch: 28 [81/500 5184/32000 (16%)] Loss: 1.13074 (QuantReg: 13.24838) QuantErr: 13.24838 batch_time=0.40180 
Train Epoch: 28 [89/500 5696/32000 (18%)] Loss: 0.50925 (QuantReg: 13.54966) QuantErr: 13.54966 batch_time=0.43223 
Train Epoch: 28 [97/500 6208/32000 (19%)] Loss: 0.98455 (QuantReg: 12.99743) QuantErr: 12.99743 batch_time=0.44183 
Train Epoch: 28 [105/500 6720/32000 (21%)] Loss: 0.77559 (QuantReg: 13.30212) QuantErr: 13.30212 batch_time=0.40996 
Train Epoch: 28 [113/500 7232/32000 (23%)] Loss: 0.55886 (QuantReg: 12.99150) QuantErr: 12.99150 batch_time=0.44244 
Train Epoch: 28 [121/500 7744/32000 (24%)] Loss: 0.80882 (QuantReg: 13.36312) QuantErr: 13.36312 batch_time=0.40845 
Train Epoch: 28 [129/500 8256/32000 (26%)] Loss: 0.86554 (QuantReg: 13.50443) QuantErr: 13.50443 batch_time=0.60651 
Train Epoch: 28 [137/500 8768/32000 (27%)] Loss: 0.58833 (QuantReg: 13.41523) QuantErr: 13.41523 batch_time=0.40580 
Train Epoch: 28 [145/500 9280/32000 (29%)] Loss: 0.67615 (QuantReg: 13.44418) QuantErr: 13.44418 batch_time=0.41407 
Train Epoch: 28 [153/500 9792/32000 (31%)] Loss: 0.44824 (QuantReg: 13.12985) QuantErr: 13.12985 batch_time=0.39480 
Train Epoch: 28 [161/500 10304/32000 (32%)] Loss: 0.48224 (QuantReg: 13.45460) QuantErr: 13.45460 batch_time=0.38044 
Train Epoch: 28 [169/500 10816/32000 (34%)] Loss: 0.63306 (QuantReg: 13.40825) QuantErr: 13.40825 batch_time=0.40986 
Train Epoch: 28 [177/500 11328/32000 (35%)] Loss: 0.70675 (QuantReg: 13.21228) QuantErr: 13.21228 batch_time=0.41234 
Train Epoch: 28 [185/500 11840/32000 (37%)] Loss: 0.60309 (QuantReg: 13.41717) QuantErr: 13.41717 batch_time=0.44551 
Train Epoch: 28 [193/500 12352/32000 (39%)] Loss: 0.66031 (QuantReg: 12.69430) QuantErr: 12.69430 batch_time=0.60377 
Train Epoch: 28 [201/500 12864/32000 (40%)] Loss: 0.48607 (QuantReg: 13.47126) QuantErr: 13.47126 batch_time=0.40944 
Train Epoch: 28 [209/500 13376/32000 (42%)] Loss: 0.49991 (QuantReg: 13.29883) QuantErr: 13.29883 batch_time=0.47521 
Train Epoch: 28 [217/500 13888/32000 (43%)] Loss: 0.62736 (QuantReg: 13.25527) QuantErr: 13.25527 batch_time=0.41087 
Train Epoch: 28 [225/500 14400/32000 (45%)] Loss: 0.83601 (QuantReg: 13.10396) QuantErr: 13.10396 batch_time=0.47645 
Train Epoch: 28 [233/500 14912/32000 (47%)] Loss: 1.21433 (QuantReg: 12.75992) QuantErr: 12.75992 batch_time=0.42038 
Train Epoch: 28 [241/500 15424/32000 (48%)] Loss: 0.68138 (QuantReg: 13.22739) QuantErr: 13.22739 batch_time=0.40508 
Train Epoch: 28 [249/500 15936/32000 (50%)] Loss: 0.91955 (QuantReg: 13.55835) QuantErr: 13.55835 batch_time=0.41117 
Train Epoch: 28 [257/500 16448/32000 (51%)] Loss: 0.65840 (QuantReg: 13.67567) QuantErr: 13.67567 batch_time=0.61578 
Train Epoch: 28 [265/500 16960/32000 (53%)] Loss: 0.64151 (QuantReg: 13.14789) QuantErr: 13.14789 batch_time=0.46360 
Train Epoch: 28 [273/500 17472/32000 (55%)] Loss: 0.73644 (QuantReg: 13.09548) QuantErr: 13.09548 batch_time=0.40673 
Train Epoch: 28 [281/500 17984/32000 (56%)] Loss: 0.61091 (QuantReg: 13.11177) QuantErr: 13.11177 batch_time=0.40250 
Train Epoch: 28 [289/500 18496/32000 (58%)] Loss: 0.68441 (QuantReg: 13.72404) QuantErr: 13.72404 batch_time=0.42120 
Train Epoch: 28 [297/500 19008/32000 (59%)] Loss: 0.59304 (QuantReg: 12.57380) QuantErr: 12.57380 batch_time=0.41370 
Train Epoch: 28 [305/500 19520/32000 (61%)] Loss: 0.51381 (QuantReg: 13.89400) QuantErr: 13.89400 batch_time=0.42314 
Train Epoch: 28 [313/500 20032/32000 (63%)] Loss: 0.68759 (QuantReg: 13.34362) QuantErr: 13.34362 batch_time=0.40521 
Train Epoch: 28 [321/500 20544/32000 (64%)] Loss: 0.70029 (QuantReg: 13.68626) QuantErr: 13.68626 batch_time=0.56384 
Train Epoch: 28 [329/500 21056/32000 (66%)] Loss: 0.77672 (QuantReg: 13.10056) QuantErr: 13.10056 batch_time=0.39718 
Train Epoch: 28 [337/500 21568/32000 (67%)] Loss: 0.76113 (QuantReg: 12.94195) QuantErr: 12.94195 batch_time=0.40152 
Train Epoch: 28 [345/500 22080/32000 (69%)] Loss: 0.41340 (QuantReg: 13.24488) QuantErr: 13.24488 batch_time=0.41663 
Train Epoch: 28 [353/500 22592/32000 (71%)] Loss: 0.93718 (QuantReg: 13.30355) QuantErr: 13.30355 batch_time=0.40784 
Train Epoch: 28 [361/500 23104/32000 (72%)] Loss: 0.96363 (QuantReg: 12.95786) QuantErr: 12.95786 batch_time=0.40473 
Train Epoch: 28 [369/500 23616/32000 (74%)] Loss: 0.72677 (QuantReg: 13.21319) QuantErr: 13.21319 batch_time=0.40885 
Train Epoch: 28 [377/500 24128/32000 (75%)] Loss: 0.59226 (QuantReg: 13.28349) QuantErr: 13.28349 batch_time=0.40297 
Train Epoch: 28 [385/500 24640/32000 (77%)] Loss: 1.06032 (QuantReg: 13.06040) QuantErr: 13.06040 batch_time=0.57333 
Train Epoch: 28 [393/500 25152/32000 (79%)] Loss: 0.49644 (QuantReg: 13.25063) QuantErr: 13.25063 batch_time=0.40029 
Train Epoch: 28 [401/500 25664/32000 (80%)] Loss: 0.90807 (QuantReg: 13.43856) QuantErr: 13.43856 batch_time=0.42461 
Train Epoch: 28 [409/500 26176/32000 (82%)] Loss: 0.52325 (QuantReg: 12.45716) QuantErr: 12.45716 batch_time=0.39641 
Train Epoch: 28 [417/500 26688/32000 (83%)] Loss: 0.64348 (QuantReg: 13.41537) QuantErr: 13.41537 batch_time=0.41438 
Train Epoch: 28 [425/500 27200/32000 (85%)] Loss: 0.56226 (QuantReg: 13.65068) QuantErr: 13.65068 batch_time=0.44407 
Train Epoch: 28 [433/500 27712/32000 (87%)] Loss: 0.61821 (QuantReg: 13.11331) QuantErr: 13.11331 batch_time=0.39970 
Train Epoch: 28 [441/500 28224/32000 (88%)] Loss: 0.57477 (QuantReg: 13.63443) QuantErr: 13.63443 batch_time=0.39545 
Train Epoch: 28 [449/500 28736/32000 (90%)] Loss: 0.59103 (QuantReg: 13.27360) QuantErr: 13.27360 batch_time=0.55670 
Train Epoch: 28 [457/500 29248/32000 (91%)] Loss: 0.66076 (QuantReg: 13.47701) QuantErr: 13.47701 batch_time=0.47400 
Train Epoch: 28 [465/500 29760/32000 (93%)] Loss: 0.81959 (QuantReg: 13.21513) QuantErr: 13.21513 batch_time=0.39095 
Train Epoch: 28 [473/500 30272/32000 (95%)] Loss: 0.64426 (QuantReg: 13.65490) QuantErr: 13.65490 batch_time=0.40097 
Train Epoch: 28 [481/500 30784/32000 (96%)] Loss: 0.70637 (QuantReg: 13.47314) QuantErr: 13.47314 batch_time=0.39854 
Train Epoch: 28 [489/500 31296/32000 (98%)] Loss: 0.32451 (QuantReg: 13.39227) QuantErr: 13.39227 batch_time=0.39948 
Train Epoch: 28 [497/500 31808/32000 (99%)] Loss: 0.49069 (QuantReg: 13.51555) QuantErr: 13.51555 batch_time=0.38260 
Train Epoch: 28 codebook_update_time=1.91661
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch28.pth ...
Done in 4.274s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 0.7164729872345924
 quant_reg      : 13.299949026107788
 quant_err      : 13.299949026107788
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 14000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.252
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.44273743906847
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.437
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.23318952704111
 mnt_best       : 44.481525807906294
 not_improved_count: 4
Train Epoch: 29 [1/500 64/32000 (0%)] Loss: 1.07289 (QuantReg: 13.34700) QuantErr: 13.34700 batch_time=24.15771 
Train Epoch: 29 [9/500 576/32000 (2%)] Loss: 1.08157 (QuantReg: 13.20298) QuantErr: 13.20298 batch_time=0.40402 
Train Epoch: 29 [17/500 1088/32000 (3%)] Loss: 0.77089 (QuantReg: 13.27373) QuantErr: 13.27373 batch_time=0.45108 
Train Epoch: 29 [25/500 1600/32000 (5%)] Loss: 0.55944 (QuantReg: 13.70294) QuantErr: 13.70294 batch_time=1.28984 
Train Epoch: 29 [33/500 2112/32000 (7%)] Loss: 0.82638 (QuantReg: 12.94068) QuantErr: 12.94068 batch_time=0.41211 
Train Epoch: 29 [41/500 2624/32000 (8%)] Loss: 0.96119 (QuantReg: 13.30792) QuantErr: 13.30792 batch_time=0.39348 
Train Epoch: 29 [49/500 3136/32000 (10%)] Loss: 0.56839 (QuantReg: 13.12322) QuantErr: 13.12322 batch_time=0.74069 
Train Epoch: 29 [57/500 3648/32000 (11%)] Loss: 0.82820 (QuantReg: 13.54248) QuantErr: 13.54248 batch_time=0.40684 
Train Epoch: 29 [65/500 4160/32000 (13%)] Loss: 1.09567 (QuantReg: 13.33232) QuantErr: 13.33232 batch_time=0.46219 
Train Epoch: 29 [73/500 4672/32000 (15%)] Loss: 0.77963 (QuantReg: 13.16571) QuantErr: 13.16571 batch_time=0.40109 
Train Epoch: 29 [81/500 5184/32000 (16%)] Loss: 0.87507 (QuantReg: 13.56754) QuantErr: 13.56754 batch_time=0.46170 
Train Epoch: 29 [89/500 5696/32000 (18%)] Loss: 0.59927 (QuantReg: 13.41015) QuantErr: 13.41015 batch_time=1.16491 
Train Epoch: 29 [97/500 6208/32000 (19%)] Loss: 0.96026 (QuantReg: 12.89598) QuantErr: 12.89598 batch_time=0.38946 
Train Epoch: 29 [105/500 6720/32000 (21%)] Loss: 0.96345 (QuantReg: 13.13019) QuantErr: 13.13019 batch_time=0.40296 
Train Epoch: 29 [113/500 7232/32000 (23%)] Loss: 0.80630 (QuantReg: 13.23579) QuantErr: 13.23579 batch_time=0.65803 
Train Epoch: 29 [121/500 7744/32000 (24%)] Loss: 0.34596 (QuantReg: 13.42491) QuantErr: 13.42491 batch_time=0.43089 
Train Epoch: 29 [129/500 8256/32000 (26%)] Loss: 0.52036 (QuantReg: 13.17695) QuantErr: 13.17695 batch_time=0.47977 
Train Epoch: 29 [137/500 8768/32000 (27%)] Loss: 0.56122 (QuantReg: 13.63675) QuantErr: 13.63675 batch_time=0.43689 
Train Epoch: 29 [145/500 9280/32000 (29%)] Loss: 0.66496 (QuantReg: 13.36551) QuantErr: 13.36551 batch_time=0.45173 
Train Epoch: 29 [153/500 9792/32000 (31%)] Loss: 0.71456 (QuantReg: 13.33178) QuantErr: 13.33178 batch_time=1.26854 
Train Epoch: 29 [161/500 10304/32000 (32%)] Loss: 1.04687 (QuantReg: 13.14649) QuantErr: 13.14649 batch_time=0.38712 
Train Epoch: 29 [169/500 10816/32000 (34%)] Loss: 0.50329 (QuantReg: 13.59711) QuantErr: 13.59711 batch_time=0.38999 
Train Epoch: 29 [177/500 11328/32000 (35%)] Loss: 0.45352 (QuantReg: 13.55454) QuantErr: 13.55454 batch_time=0.65849 
Train Epoch: 29 [185/500 11840/32000 (37%)] Loss: 0.91224 (QuantReg: 13.52367) QuantErr: 13.52367 batch_time=0.38882 
Train Epoch: 29 [193/500 12352/32000 (39%)] Loss: 0.67884 (QuantReg: 13.19080) QuantErr: 13.19080 batch_time=0.45354 
Train Epoch: 29 [201/500 12864/32000 (40%)] Loss: 0.56353 (QuantReg: 13.40989) QuantErr: 13.40989 batch_time=0.40004 
Train Epoch: 29 [209/500 13376/32000 (42%)] Loss: 0.99950 (QuantReg: 13.38687) QuantErr: 13.38687 batch_time=0.49841 
Train Epoch: 29 [217/500 13888/32000 (43%)] Loss: 0.45784 (QuantReg: 13.47298) QuantErr: 13.47298 batch_time=1.14142 
Train Epoch: 29 [225/500 14400/32000 (45%)] Loss: 1.24130 (QuantReg: 13.45357) QuantErr: 13.45357 batch_time=0.41042 
Train Epoch: 29 [233/500 14912/32000 (47%)] Loss: 1.03506 (QuantReg: 13.32736) QuantErr: 13.32736 batch_time=0.40363 
Train Epoch: 29 [241/500 15424/32000 (48%)] Loss: 0.82667 (QuantReg: 13.50686) QuantErr: 13.50686 batch_time=0.73493 
Train Epoch: 29 [249/500 15936/32000 (50%)] Loss: 0.59430 (QuantReg: 13.53209) QuantErr: 13.53209 batch_time=0.42971 
Train Epoch: 29 [257/500 16448/32000 (51%)] Loss: 0.60591 (QuantReg: 12.95823) QuantErr: 12.95823 batch_time=0.48291 
Train Epoch: 29 [265/500 16960/32000 (53%)] Loss: 0.74642 (QuantReg: 13.52755) QuantErr: 13.52755 batch_time=0.39244 
Train Epoch: 29 [273/500 17472/32000 (55%)] Loss: 0.78550 (QuantReg: 13.30163) QuantErr: 13.30163 batch_time=0.43858 
Train Epoch: 29 [281/500 17984/32000 (56%)] Loss: 0.94391 (QuantReg: 13.56473) QuantErr: 13.56473 batch_time=1.23072 
Train Epoch: 29 [289/500 18496/32000 (58%)] Loss: 0.62136 (QuantReg: 13.40039) QuantErr: 13.40039 batch_time=0.39098 
Train Epoch: 29 [297/500 19008/32000 (59%)] Loss: 1.19683 (QuantReg: 13.17399) QuantErr: 13.17399 batch_time=0.39095 
Train Epoch: 29 [305/500 19520/32000 (61%)] Loss: 0.85517 (QuantReg: 13.29103) QuantErr: 13.29103 batch_time=0.71020 
Train Epoch: 29 [313/500 20032/32000 (63%)] Loss: 0.49444 (QuantReg: 13.42552) QuantErr: 13.42552 batch_time=0.39276 
Train Epoch: 29 [321/500 20544/32000 (64%)] Loss: 0.71683 (QuantReg: 13.42335) QuantErr: 13.42335 batch_time=0.46290 
Train Epoch: 29 [329/500 21056/32000 (66%)] Loss: 0.85234 (QuantReg: 13.27505) QuantErr: 13.27505 batch_time=0.43440 
Train Epoch: 29 [337/500 21568/32000 (67%)] Loss: 0.63156 (QuantReg: 13.10696) QuantErr: 13.10696 batch_time=0.49333 
Train Epoch: 29 [345/500 22080/32000 (69%)] Loss: 0.54562 (QuantReg: 13.22737) QuantErr: 13.22737 batch_time=1.12732 
Train Epoch: 29 [353/500 22592/32000 (71%)] Loss: 0.68492 (QuantReg: 13.39976) QuantErr: 13.39976 batch_time=0.41049 
Train Epoch: 29 [361/500 23104/32000 (72%)] Loss: 0.99494 (QuantReg: 13.71435) QuantErr: 13.71435 batch_time=0.39520 
Train Epoch: 29 [369/500 23616/32000 (74%)] Loss: 0.61096 (QuantReg: 13.12110) QuantErr: 13.12110 batch_time=0.68640 
Train Epoch: 29 [377/500 24128/32000 (75%)] Loss: 0.72285 (QuantReg: 13.58222) QuantErr: 13.58222 batch_time=0.41084 
Train Epoch: 29 [385/500 24640/32000 (77%)] Loss: 0.91006 (QuantReg: 13.42444) QuantErr: 13.42444 batch_time=0.49325 
Train Epoch: 29 [393/500 25152/32000 (79%)] Loss: 0.66416 (QuantReg: 13.65493) QuantErr: 13.65493 batch_time=0.40020 
Train Epoch: 29 [401/500 25664/32000 (80%)] Loss: 0.62815 (QuantReg: 13.36024) QuantErr: 13.36024 batch_time=0.44899 
Train Epoch: 29 [409/500 26176/32000 (82%)] Loss: 0.67208 (QuantReg: 13.54226) QuantErr: 13.54226 batch_time=1.27780 
Train Epoch: 29 [417/500 26688/32000 (83%)] Loss: 0.62500 (QuantReg: 13.24544) QuantErr: 13.24544 batch_time=0.40943 
Train Epoch: 29 [425/500 27200/32000 (85%)] Loss: 0.64345 (QuantReg: 13.72919) QuantErr: 13.72919 batch_time=0.39334 
Train Epoch: 29 [433/500 27712/32000 (87%)] Loss: 0.68413 (QuantReg: 13.58784) QuantErr: 13.58784 batch_time=0.72813 
Train Epoch: 29 [441/500 28224/32000 (88%)] Loss: 0.97436 (QuantReg: 13.26023) QuantErr: 13.26023 batch_time=0.43762 
Train Epoch: 29 [449/500 28736/32000 (90%)] Loss: 0.75436 (QuantReg: 13.26418) QuantErr: 13.26418 batch_time=0.44945 
Train Epoch: 29 [457/500 29248/32000 (91%)] Loss: 0.90049 (QuantReg: 13.02352) QuantErr: 13.02352 batch_time=0.39247 
Train Epoch: 29 [465/500 29760/32000 (93%)] Loss: 0.51863 (QuantReg: 13.42921) QuantErr: 13.42921 batch_time=0.64767 
Train Epoch: 29 [473/500 30272/32000 (95%)] Loss: 0.64569 (QuantReg: 12.89332) QuantErr: 12.89332 batch_time=1.20311 
Train Epoch: 29 [481/500 30784/32000 (96%)] Loss: 0.69057 (QuantReg: 12.99225) QuantErr: 12.99225 batch_time=0.39523 
Train Epoch: 29 [489/500 31296/32000 (98%)] Loss: 0.76982 (QuantReg: 13.57186) QuantErr: 13.57186 batch_time=0.39473 
Train Epoch: 29 [497/500 31808/32000 (99%)] Loss: 0.52022 (QuantReg: 13.18835) QuantErr: 13.18835 batch_time=0.74562 
Train Epoch: 29 codebook_update_time=1.72999
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch29.pth ...
Done in 4.164s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch29.pth ...
Done in 15.462s
removing stale ckpt [epoch 28] [took 0.02s]
 epoch          : 29
 loss           : 0.703389243543148
 quant_reg      : 13.337802143096924
 quant_err      : 13.337802143096924
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 14500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.076
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.614725643488114
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.258
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.016337113410295
 mnt_best       : 44.614725643488114
 not_improved_count: 0
Train Epoch: 30 [1/500 64/32000 (0%)] Loss: 0.90000 (QuantReg: 13.27356) QuantErr: 13.27356 batch_time=21.12595 
Train Epoch: 30 [9/500 576/32000 (2%)] Loss: 0.66683 (QuantReg: 13.57861) QuantErr: 13.57861 batch_time=0.37977 
Train Epoch: 30 [17/500 1088/32000 (3%)] Loss: 0.44837 (QuantReg: 13.19826) QuantErr: 13.19826 batch_time=0.39504 
Train Epoch: 30 [25/500 1600/32000 (5%)] Loss: 0.77917 (QuantReg: 13.14422) QuantErr: 13.14422 batch_time=0.38569 
Train Epoch: 30 [33/500 2112/32000 (7%)] Loss: 0.55605 (QuantReg: 13.39595) QuantErr: 13.39595 batch_time=0.39711 
Train Epoch: 30 [41/500 2624/32000 (8%)] Loss: 0.55933 (QuantReg: 13.38798) QuantErr: 13.38798 batch_time=0.43516 
Train Epoch: 30 [49/500 3136/32000 (10%)] Loss: 0.63274 (QuantReg: 13.41124) QuantErr: 13.41124 batch_time=0.49079 
Train Epoch: 30 [57/500 3648/32000 (11%)] Loss: 0.78402 (QuantReg: 13.09840) QuantErr: 13.09840 batch_time=0.39345 
Train Epoch: 30 [65/500 4160/32000 (13%)] Loss: 0.80319 (QuantReg: 13.24039) QuantErr: 13.24039 batch_time=0.39900 
Train Epoch: 30 [73/500 4672/32000 (15%)] Loss: 0.90399 (QuantReg: 13.50715) QuantErr: 13.50715 batch_time=0.42888 
Train Epoch: 30 [81/500 5184/32000 (16%)] Loss: 0.66286 (QuantReg: 13.55100) QuantErr: 13.55100 batch_time=0.39940 
Train Epoch: 30 [89/500 5696/32000 (18%)] Loss: 0.94291 (QuantReg: 13.38457) QuantErr: 13.38457 batch_time=0.40652 
Train Epoch: 30 [97/500 6208/32000 (19%)] Loss: 0.72127 (QuantReg: 12.86433) QuantErr: 12.86433 batch_time=0.43257 
Train Epoch: 30 [105/500 6720/32000 (21%)] Loss: 0.38083 (QuantReg: 13.34927) QuantErr: 13.34927 batch_time=0.40146 
Train Epoch: 30 [113/500 7232/32000 (23%)] Loss: 0.51305 (QuantReg: 13.49624) QuantErr: 13.49624 batch_time=0.62165 
Train Epoch: 30 [121/500 7744/32000 (24%)] Loss: 1.12834 (QuantReg: 13.45421) QuantErr: 13.45421 batch_time=0.39944 
Train Epoch: 30 [129/500 8256/32000 (26%)] Loss: 0.60263 (QuantReg: 13.36633) QuantErr: 13.36633 batch_time=0.44372 
Train Epoch: 30 [137/500 8768/32000 (27%)] Loss: 0.71405 (QuantReg: 13.06180) QuantErr: 13.06180 batch_time=0.49036 
Train Epoch: 30 [145/500 9280/32000 (29%)] Loss: 0.53130 (QuantReg: 13.35813) QuantErr: 13.35813 batch_time=0.42740 
Train Epoch: 30 [153/500 9792/32000 (31%)] Loss: 0.74869 (QuantReg: 13.07426) QuantErr: 13.07426 batch_time=0.45111 
Train Epoch: 30 [161/500 10304/32000 (32%)] Loss: 0.67659 (QuantReg: 13.28720) QuantErr: 13.28720 batch_time=0.44222 
Train Epoch: 30 [169/500 10816/32000 (34%)] Loss: 0.63195 (QuantReg: 13.45100) QuantErr: 13.45100 batch_time=0.43329 
Train Epoch: 30 [177/500 11328/32000 (35%)] Loss: 0.74671 (QuantReg: 13.19325) QuantErr: 13.19325 batch_time=0.63598 
Train Epoch: 30 [185/500 11840/32000 (37%)] Loss: 0.86210 (QuantReg: 13.59768) QuantErr: 13.59768 batch_time=0.40013 
Train Epoch: 30 [193/500 12352/32000 (39%)] Loss: 0.53452 (QuantReg: 13.39585) QuantErr: 13.39585 batch_time=0.45534 
Train Epoch: 30 [201/500 12864/32000 (40%)] Loss: 0.42219 (QuantReg: 13.26602) QuantErr: 13.26602 batch_time=0.39835 
Train Epoch: 30 [209/500 13376/32000 (42%)] Loss: 0.86467 (QuantReg: 13.11771) QuantErr: 13.11771 batch_time=0.39472 
Train Epoch: 30 [217/500 13888/32000 (43%)] Loss: 0.66811 (QuantReg: 13.08625) QuantErr: 13.08625 batch_time=0.76316 
Train Epoch: 30 [225/500 14400/32000 (45%)] Loss: 0.86251 (QuantReg: 13.27043) QuantErr: 13.27043 batch_time=0.51025 
Train Epoch: 30 [233/500 14912/32000 (47%)] Loss: 0.65558 (QuantReg: 13.16540) QuantErr: 13.16540 batch_time=0.39913 
Train Epoch: 30 [241/500 15424/32000 (48%)] Loss: 0.36582 (QuantReg: 13.81037) QuantErr: 13.81037 batch_time=0.66038 
Train Epoch: 30 [249/500 15936/32000 (50%)] Loss: 0.66444 (QuantReg: 13.38406) QuantErr: 13.38406 batch_time=0.42287 
Train Epoch: 30 [257/500 16448/32000 (51%)] Loss: 0.85176 (QuantReg: 13.02754) QuantErr: 13.02754 batch_time=0.40536 
Train Epoch: 30 [265/500 16960/32000 (53%)] Loss: 0.59901 (QuantReg: 13.48816) QuantErr: 13.48816 batch_time=0.40808 
Train Epoch: 30 [273/500 17472/32000 (55%)] Loss: 0.70548 (QuantReg: 13.27671) QuantErr: 13.27671 batch_time=0.40187 
Train Epoch: 30 [281/500 17984/32000 (56%)] Loss: 0.68278 (QuantReg: 13.18341) QuantErr: 13.18341 batch_time=0.51289 
Train Epoch: 30 [289/500 18496/32000 (58%)] Loss: 0.82079 (QuantReg: 12.90599) QuantErr: 12.90599 batch_time=0.40098 
Train Epoch: 30 [297/500 19008/32000 (59%)] Loss: 0.94802 (QuantReg: 13.45785) QuantErr: 13.45785 batch_time=0.41646 
Train Epoch: 30 [305/500 19520/32000 (61%)] Loss: 0.84037 (QuantReg: 13.27285) QuantErr: 13.27285 batch_time=0.62418 
Train Epoch: 30 [313/500 20032/32000 (63%)] Loss: 0.64348 (QuantReg: 13.43110) QuantErr: 13.43110 batch_time=0.45007 
Train Epoch: 30 [321/500 20544/32000 (64%)] Loss: 0.53282 (QuantReg: 13.44692) QuantErr: 13.44692 batch_time=0.47351 
Train Epoch: 30 [329/500 21056/32000 (66%)] Loss: 0.90996 (QuantReg: 13.58368) QuantErr: 13.58368 batch_time=0.39929 
Train Epoch: 30 [337/500 21568/32000 (67%)] Loss: 0.72377 (QuantReg: 13.24265) QuantErr: 13.24265 batch_time=0.40455 
Train Epoch: 30 [345/500 22080/32000 (69%)] Loss: 0.49318 (QuantReg: 13.23499) QuantErr: 13.23499 batch_time=0.43785 
Train Epoch: 30 [353/500 22592/32000 (71%)] Loss: 0.69692 (QuantReg: 12.53952) QuantErr: 12.53952 batch_time=0.43790 
Train Epoch: 30 [361/500 23104/32000 (72%)] Loss: 0.42333 (QuantReg: 13.40327) QuantErr: 13.40327 batch_time=0.41719 
Train Epoch: 30 [369/500 23616/32000 (74%)] Loss: 0.93608 (QuantReg: 13.60546) QuantErr: 13.60546 batch_time=0.65877 
Train Epoch: 30 [377/500 24128/32000 (75%)] Loss: 0.60683 (QuantReg: 13.17152) QuantErr: 13.17152 batch_time=0.41468 
Train Epoch: 30 [385/500 24640/32000 (77%)] Loss: 0.76624 (QuantReg: 13.07455) QuantErr: 13.07455 batch_time=0.41234 
Train Epoch: 30 [393/500 25152/32000 (79%)] Loss: 0.85437 (QuantReg: 13.29781) QuantErr: 13.29781 batch_time=0.44719 
Train Epoch: 30 [401/500 25664/32000 (80%)] Loss: 0.72895 (QuantReg: 13.68828) QuantErr: 13.68828 batch_time=0.40393 
Train Epoch: 30 [409/500 26176/32000 (82%)] Loss: 0.88768 (QuantReg: 13.68244) QuantErr: 13.68244 batch_time=0.39195 
Train Epoch: 30 [417/500 26688/32000 (83%)] Loss: 0.78328 (QuantReg: 13.35248) QuantErr: 13.35248 batch_time=0.39859 
Train Epoch: 30 [425/500 27200/32000 (85%)] Loss: 0.83580 (QuantReg: 13.37056) QuantErr: 13.37056 batch_time=0.45881 
Train Epoch: 30 [433/500 27712/32000 (87%)] Loss: 0.67819 (QuantReg: 13.40839) QuantErr: 13.40839 batch_time=0.65717 
Train Epoch: 30 [441/500 28224/32000 (88%)] Loss: 0.64358 (QuantReg: 13.60972) QuantErr: 13.60972 batch_time=0.45035 
Train Epoch: 30 [449/500 28736/32000 (90%)] Loss: 0.72835 (QuantReg: 13.59067) QuantErr: 13.59067 batch_time=0.40015 
Train Epoch: 30 [457/500 29248/32000 (91%)] Loss: 0.95004 (QuantReg: 13.52849) QuantErr: 13.52849 batch_time=0.39409 
Train Epoch: 30 [465/500 29760/32000 (93%)] Loss: 0.72190 (QuantReg: 12.81202) QuantErr: 12.81202 batch_time=0.40182 
Train Epoch: 30 [473/500 30272/32000 (95%)] Loss: 0.88111 (QuantReg: 13.60137) QuantErr: 13.60137 batch_time=0.39733 
Train Epoch: 30 [481/500 30784/32000 (96%)] Loss: 0.40788 (QuantReg: 13.51078) QuantErr: 13.51078 batch_time=0.40562 
Train Epoch: 30 [489/500 31296/32000 (98%)] Loss: 0.75498 (QuantReg: 12.93054) QuantErr: 12.93054 batch_time=0.39993 
Train Epoch: 30 [497/500 31808/32000 (99%)] Loss: 0.82824 (QuantReg: 13.62006) QuantErr: 13.62006 batch_time=0.67717 
Train Epoch: 30 codebook_update_time=1.76906
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch30.pth ...
Done in 4.180s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 0.69931925958395
 quant_reg      : 13.350414728164672
 quant_err      : 13.350414728164672
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 15000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.084
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.39322530078905
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.0785
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.223132753929676
 mnt_best       : 44.614725643488114
 not_improved_count: 1
Train Epoch: 31 [1/500 64/32000 (0%)] Loss: 0.62934 (QuantReg: 13.38825) QuantErr: 13.38825 batch_time=22.33932 
Train Epoch: 31 [9/500 576/32000 (2%)] Loss: 0.84450 (QuantReg: 13.34846) QuantErr: 13.34846 batch_time=0.43080 
Train Epoch: 31 [17/500 1088/32000 (3%)] Loss: 0.95128 (QuantReg: 12.89581) QuantErr: 12.89581 batch_time=0.38878 
Train Epoch: 31 [25/500 1600/32000 (5%)] Loss: 0.93791 (QuantReg: 13.24072) QuantErr: 13.24072 batch_time=0.38783 
Train Epoch: 31 [33/500 2112/32000 (7%)] Loss: 0.53123 (QuantReg: 12.94693) QuantErr: 12.94693 batch_time=0.52907 
Train Epoch: 31 [41/500 2624/32000 (8%)] Loss: 0.65203 (QuantReg: 13.12615) QuantErr: 13.12615 batch_time=0.39153 
Train Epoch: 31 [49/500 3136/32000 (10%)] Loss: 0.49604 (QuantReg: 13.46658) QuantErr: 13.46658 batch_time=0.39436 
Train Epoch: 31 [57/500 3648/32000 (11%)] Loss: 0.85581 (QuantReg: 13.74986) QuantErr: 13.74986 batch_time=0.40754 
Train Epoch: 31 [65/500 4160/32000 (13%)] Loss: 0.68614 (QuantReg: 13.04237) QuantErr: 13.04237 batch_time=0.58567 
Train Epoch: 31 [73/500 4672/32000 (15%)] Loss: 0.65663 (QuantReg: 13.45864) QuantErr: 13.45864 batch_time=0.39623 
Train Epoch: 31 [81/500 5184/32000 (16%)] Loss: 0.59744 (QuantReg: 13.69662) QuantErr: 13.69662 batch_time=0.41101 
Train Epoch: 31 [89/500 5696/32000 (18%)] Loss: 0.66056 (QuantReg: 13.70226) QuantErr: 13.70226 batch_time=0.43184 
Train Epoch: 31 [97/500 6208/32000 (19%)] Loss: 0.75213 (QuantReg: 12.98817) QuantErr: 12.98817 batch_time=0.39987 
Train Epoch: 31 [105/500 6720/32000 (21%)] Loss: 1.07902 (QuantReg: 13.11988) QuantErr: 13.11988 batch_time=0.39973 
Train Epoch: 31 [113/500 7232/32000 (23%)] Loss: 0.39272 (QuantReg: 13.74238) QuantErr: 13.74238 batch_time=0.39715 
Train Epoch: 31 [121/500 7744/32000 (24%)] Loss: 0.60996 (QuantReg: 13.51175) QuantErr: 13.51175 batch_time=0.40117 
Train Epoch: 31 [129/500 8256/32000 (26%)] Loss: 0.71672 (QuantReg: 13.84669) QuantErr: 13.84669 batch_time=0.57738 
Train Epoch: 31 [137/500 8768/32000 (27%)] Loss: 0.76830 (QuantReg: 13.78843) QuantErr: 13.78843 batch_time=0.39009 
Train Epoch: 31 [145/500 9280/32000 (29%)] Loss: 0.77159 (QuantReg: 13.39730) QuantErr: 13.39730 batch_time=0.41206 
Train Epoch: 31 [153/500 9792/32000 (31%)] Loss: 1.14266 (QuantReg: 13.11594) QuantErr: 13.11594 batch_time=0.39529 
Train Epoch: 31 [161/500 10304/32000 (32%)] Loss: 0.43888 (QuantReg: 13.71089) QuantErr: 13.71089 batch_time=0.45512 
Train Epoch: 31 [169/500 10816/32000 (34%)] Loss: 0.73387 (QuantReg: 13.63764) QuantErr: 13.63764 batch_time=0.39243 
Train Epoch: 31 [177/500 11328/32000 (35%)] Loss: 0.71182 (QuantReg: 13.08258) QuantErr: 13.08258 batch_time=0.43658 
Train Epoch: 31 [185/500 11840/32000 (37%)] Loss: 0.50860 (QuantReg: 13.63480) QuantErr: 13.63480 batch_time=0.39261 
Train Epoch: 31 [193/500 12352/32000 (39%)] Loss: 0.67633 (QuantReg: 13.73152) QuantErr: 13.73152 batch_time=0.63118 
Train Epoch: 31 [201/500 12864/32000 (40%)] Loss: 0.63912 (QuantReg: 12.63878) QuantErr: 12.63878 batch_time=0.39597 
Train Epoch: 31 [209/500 13376/32000 (42%)] Loss: 0.70005 (QuantReg: 13.74323) QuantErr: 13.74323 batch_time=0.49651 
Train Epoch: 31 [217/500 13888/32000 (43%)] Loss: 0.61327 (QuantReg: 13.28310) QuantErr: 13.28310 batch_time=0.40198 
Train Epoch: 31 [225/500 14400/32000 (45%)] Loss: 0.54250 (QuantReg: 13.48219) QuantErr: 13.48219 batch_time=0.39617 
Train Epoch: 31 [233/500 14912/32000 (47%)] Loss: 0.62160 (QuantReg: 13.55857) QuantErr: 13.55857 batch_time=0.40661 
Train Epoch: 31 [241/500 15424/32000 (48%)] Loss: 0.75683 (QuantReg: 13.08839) QuantErr: 13.08839 batch_time=0.41699 
Train Epoch: 31 [249/500 15936/32000 (50%)] Loss: 0.62508 (QuantReg: 13.27294) QuantErr: 13.27294 batch_time=0.38663 
Train Epoch: 31 [257/500 16448/32000 (51%)] Loss: 0.77892 (QuantReg: 13.35243) QuantErr: 13.35243 batch_time=0.64296 
Train Epoch: 31 [265/500 16960/32000 (53%)] Loss: 0.56952 (QuantReg: 13.34845) QuantErr: 13.34845 batch_time=0.38941 
Train Epoch: 31 [273/500 17472/32000 (55%)] Loss: 0.70880 (QuantReg: 13.67958) QuantErr: 13.67958 batch_time=0.45773 
Train Epoch: 31 [281/500 17984/32000 (56%)] Loss: 0.72423 (QuantReg: 13.01583) QuantErr: 13.01583 batch_time=0.39088 
Train Epoch: 31 [289/500 18496/32000 (58%)] Loss: 0.58125 (QuantReg: 13.79761) QuantErr: 13.79761 batch_time=0.39755 
Train Epoch: 31 [297/500 19008/32000 (59%)] Loss: 0.61893 (QuantReg: 13.75644) QuantErr: 13.75644 batch_time=0.60269 
Train Epoch: 31 [305/500 19520/32000 (61%)] Loss: 1.11601 (QuantReg: 13.65550) QuantErr: 13.65550 batch_time=0.44689 
Train Epoch: 31 [313/500 20032/32000 (63%)] Loss: 0.37593 (QuantReg: 13.35097) QuantErr: 13.35097 batch_time=0.39407 
Train Epoch: 31 [321/500 20544/32000 (64%)] Loss: 0.52754 (QuantReg: 13.20669) QuantErr: 13.20669 batch_time=0.59674 
Train Epoch: 31 [329/500 21056/32000 (66%)] Loss: 0.57223 (QuantReg: 13.32646) QuantErr: 13.32646 batch_time=0.44206 
Train Epoch: 31 [337/500 21568/32000 (67%)] Loss: 0.78926 (QuantReg: 13.25901) QuantErr: 13.25901 batch_time=0.40459 
Train Epoch: 31 [345/500 22080/32000 (69%)] Loss: 0.64008 (QuantReg: 13.82904) QuantErr: 13.82904 batch_time=0.39071 
Train Epoch: 31 [353/500 22592/32000 (71%)] Loss: 0.82060 (QuantReg: 13.34856) QuantErr: 13.34856 batch_time=0.39821 
Train Epoch: 31 [361/500 23104/32000 (72%)] Loss: 0.72440 (QuantReg: 13.35554) QuantErr: 13.35554 batch_time=0.40041 
Train Epoch: 31 [369/500 23616/32000 (74%)] Loss: 0.40336 (QuantReg: 13.68100) QuantErr: 13.68100 batch_time=0.39099 
Train Epoch: 31 [377/500 24128/32000 (75%)] Loss: 0.50869 (QuantReg: 13.44332) QuantErr: 13.44332 batch_time=0.40461 
Train Epoch: 31 [385/500 24640/32000 (77%)] Loss: 0.72257 (QuantReg: 13.14152) QuantErr: 13.14152 batch_time=0.57326 
Train Epoch: 31 [393/500 25152/32000 (79%)] Loss: 1.00054 (QuantReg: 13.44903) QuantErr: 13.44903 batch_time=0.39347 
Train Epoch: 31 [401/500 25664/32000 (80%)] Loss: 0.50143 (QuantReg: 13.63785) QuantErr: 13.63785 batch_time=0.40045 
Train Epoch: 31 [409/500 26176/32000 (82%)] Loss: 0.72027 (QuantReg: 13.34208) QuantErr: 13.34208 batch_time=0.38264 
Train Epoch: 31 [417/500 26688/32000 (83%)] Loss: 0.88076 (QuantReg: 13.22868) QuantErr: 13.22868 batch_time=0.47817 
Train Epoch: 31 [425/500 27200/32000 (85%)] Loss: 0.70719 (QuantReg: 13.64081) QuantErr: 13.64081 batch_time=0.44829 
Train Epoch: 31 [433/500 27712/32000 (87%)] Loss: 0.43373 (QuantReg: 13.57251) QuantErr: 13.57251 batch_time=0.40281 
Train Epoch: 31 [441/500 28224/32000 (88%)] Loss: 0.75616 (QuantReg: 13.57270) QuantErr: 13.57270 batch_time=0.38930 
Train Epoch: 31 [449/500 28736/32000 (90%)] Loss: 0.62793 (QuantReg: 13.10174) QuantErr: 13.10174 batch_time=0.58421 
Train Epoch: 31 [457/500 29248/32000 (91%)] Loss: 0.56929 (QuantReg: 13.55709) QuantErr: 13.55709 batch_time=0.40073 
Train Epoch: 31 [465/500 29760/32000 (93%)] Loss: 0.36264 (QuantReg: 13.27781) QuantErr: 13.27781 batch_time=0.40731 
Train Epoch: 31 [473/500 30272/32000 (95%)] Loss: 1.21253 (QuantReg: 12.58325) QuantErr: 12.58325 batch_time=0.40405 
Train Epoch: 31 [481/500 30784/32000 (96%)] Loss: 0.47931 (QuantReg: 13.34340) QuantErr: 13.34340 batch_time=0.39528 
Train Epoch: 31 [489/500 31296/32000 (98%)] Loss: 0.62731 (QuantReg: 13.23414) QuantErr: 13.23414 batch_time=0.40034 
Train Epoch: 31 [497/500 31808/32000 (99%)] Loss: 0.57945 (QuantReg: 13.27248) QuantErr: 13.27248 batch_time=0.39480 
Train Epoch: 31 codebook_update_time=1.80152
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch31.pth ...
Done in 4.215s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 0.6991245240569115
 quant_reg      : 13.421412872314454
 quant_err      : 13.421412872314454
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 15500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.139
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.41965893496578
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.066
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.530250945293055
 mnt_best       : 44.614725643488114
 not_improved_count: 2
Train Epoch: 32 [1/500 64/32000 (0%)] Loss: 0.91965 (QuantReg: 12.98795) QuantErr: 12.98795 batch_time=26.45736 
Train Epoch: 32 [9/500 576/32000 (2%)] Loss: 0.86713 (QuantReg: 13.18448) QuantErr: 13.18448 batch_time=0.39078 
Train Epoch: 32 [17/500 1088/32000 (3%)] Loss: 0.70215 (QuantReg: 13.08157) QuantErr: 13.08157 batch_time=0.48125 
Train Epoch: 32 [25/500 1600/32000 (5%)] Loss: 0.71909 (QuantReg: 13.59785) QuantErr: 13.59785 batch_time=0.40945 
Train Epoch: 32 [33/500 2112/32000 (7%)] Loss: 0.60561 (QuantReg: 13.37390) QuantErr: 13.37390 batch_time=0.40061 
Train Epoch: 32 [41/500 2624/32000 (8%)] Loss: 0.68214 (QuantReg: 13.26091) QuantErr: 13.26091 batch_time=0.40006 
Train Epoch: 32 [49/500 3136/32000 (10%)] Loss: 0.37114 (QuantReg: 13.16956) QuantErr: 13.16956 batch_time=0.38867 
Train Epoch: 32 [57/500 3648/32000 (11%)] Loss: 0.34524 (QuantReg: 13.40240) QuantErr: 13.40240 batch_time=0.41948 
Train Epoch: 32 [65/500 4160/32000 (13%)] Loss: 1.03108 (QuantReg: 13.37762) QuantErr: 13.37762 batch_time=2.15356 
Train Epoch: 32 [73/500 4672/32000 (15%)] Loss: 0.86996 (QuantReg: 13.19270) QuantErr: 13.19270 batch_time=0.39001 
Train Epoch: 32 [81/500 5184/32000 (16%)] Loss: 0.54299 (QuantReg: 13.23597) QuantErr: 13.23597 batch_time=0.39375 
Train Epoch: 32 [89/500 5696/32000 (18%)] Loss: 0.58990 (QuantReg: 13.36795) QuantErr: 13.36795 batch_time=0.39595 
Train Epoch: 32 [97/500 6208/32000 (19%)] Loss: 0.63722 (QuantReg: 13.47861) QuantErr: 13.47861 batch_time=0.39018 
Train Epoch: 32 [105/500 6720/32000 (21%)] Loss: 0.87133 (QuantReg: 13.00329) QuantErr: 13.00329 batch_time=0.39371 
Train Epoch: 32 [113/500 7232/32000 (23%)] Loss: 0.83354 (QuantReg: 13.38811) QuantErr: 13.38811 batch_time=0.38511 
Train Epoch: 32 [121/500 7744/32000 (24%)] Loss: 0.57002 (QuantReg: 13.64524) QuantErr: 13.64524 batch_time=0.45989 
Train Epoch: 32 [129/500 8256/32000 (26%)] Loss: 0.59384 (QuantReg: 13.54055) QuantErr: 13.54055 batch_time=2.59787 
Train Epoch: 32 [137/500 8768/32000 (27%)] Loss: 0.85948 (QuantReg: 13.50996) QuantErr: 13.50996 batch_time=0.44413 
Train Epoch: 32 [145/500 9280/32000 (29%)] Loss: 0.64755 (QuantReg: 13.13343) QuantErr: 13.13343 batch_time=0.39840 
Train Epoch: 32 [153/500 9792/32000 (31%)] Loss: 0.84933 (QuantReg: 13.77078) QuantErr: 13.77078 batch_time=0.43788 
Train Epoch: 32 [161/500 10304/32000 (32%)] Loss: 1.28556 (QuantReg: 13.29883) QuantErr: 13.29883 batch_time=0.40369 
Train Epoch: 32 [169/500 10816/32000 (34%)] Loss: 0.74092 (QuantReg: 13.73421) QuantErr: 13.73421 batch_time=0.40305 
Train Epoch: 32 [177/500 11328/32000 (35%)] Loss: 0.52819 (QuantReg: 13.51078) QuantErr: 13.51078 batch_time=0.39393 
Train Epoch: 32 [185/500 11840/32000 (37%)] Loss: 0.57330 (QuantReg: 13.39023) QuantErr: 13.39023 batch_time=0.40733 
Train Epoch: 32 [193/500 12352/32000 (39%)] Loss: 0.50962 (QuantReg: 13.65251) QuantErr: 13.65251 batch_time=2.18132 
Train Epoch: 32 [201/500 12864/32000 (40%)] Loss: 0.90539 (QuantReg: 13.76307) QuantErr: 13.76307 batch_time=0.40440 
Train Epoch: 32 [209/500 13376/32000 (42%)] Loss: 0.49446 (QuantReg: 13.22099) QuantErr: 13.22099 batch_time=0.42820 
Train Epoch: 32 [217/500 13888/32000 (43%)] Loss: 0.65755 (QuantReg: 13.14058) QuantErr: 13.14058 batch_time=0.43559 
Train Epoch: 32 [225/500 14400/32000 (45%)] Loss: 0.65803 (QuantReg: 13.52388) QuantErr: 13.52388 batch_time=0.39245 
Train Epoch: 32 [233/500 14912/32000 (47%)] Loss: 0.69366 (QuantReg: 13.95429) QuantErr: 13.95429 batch_time=0.39170 
Train Epoch: 32 [241/500 15424/32000 (48%)] Loss: 0.28627 (QuantReg: 13.24479) QuantErr: 13.24479 batch_time=0.39685 
Train Epoch: 32 [249/500 15936/32000 (50%)] Loss: 0.45240 (QuantReg: 13.75970) QuantErr: 13.75970 batch_time=0.40854 
Train Epoch: 32 [257/500 16448/32000 (51%)] Loss: 0.56397 (QuantReg: 13.23247) QuantErr: 13.23247 batch_time=2.36989 
Train Epoch: 32 [265/500 16960/32000 (53%)] Loss: 0.73975 (QuantReg: 13.14107) QuantErr: 13.14107 batch_time=0.40656 
Train Epoch: 32 [273/500 17472/32000 (55%)] Loss: 0.68433 (QuantReg: 13.82710) QuantErr: 13.82710 batch_time=0.39828 
Train Epoch: 32 [281/500 17984/32000 (56%)] Loss: 0.39786 (QuantReg: 13.38572) QuantErr: 13.38572 batch_time=0.41729 
Train Epoch: 32 [289/500 18496/32000 (58%)] Loss: 0.72559 (QuantReg: 13.32121) QuantErr: 13.32121 batch_time=0.45298 
Train Epoch: 32 [297/500 19008/32000 (59%)] Loss: 0.76427 (QuantReg: 13.82166) QuantErr: 13.82166 batch_time=0.39708 
Train Epoch: 32 [305/500 19520/32000 (61%)] Loss: 0.60615 (QuantReg: 13.63367) QuantErr: 13.63367 batch_time=0.39130 
Train Epoch: 32 [313/500 20032/32000 (63%)] Loss: 0.63460 (QuantReg: 13.11879) QuantErr: 13.11879 batch_time=0.44926 
Train Epoch: 32 [321/500 20544/32000 (64%)] Loss: 0.69740 (QuantReg: 13.14715) QuantErr: 13.14715 batch_time=2.03682 
Train Epoch: 32 [329/500 21056/32000 (66%)] Loss: 0.71942 (QuantReg: 12.92053) QuantErr: 12.92053 batch_time=0.40630 
Train Epoch: 32 [337/500 21568/32000 (67%)] Loss: 0.69054 (QuantReg: 13.07724) QuantErr: 13.07724 batch_time=0.45425 
Train Epoch: 32 [345/500 22080/32000 (69%)] Loss: 0.73712 (QuantReg: 13.60690) QuantErr: 13.60690 batch_time=0.45501 
Train Epoch: 32 [353/500 22592/32000 (71%)] Loss: 0.81580 (QuantReg: 13.43828) QuantErr: 13.43828 batch_time=0.39562 
Train Epoch: 32 [361/500 23104/32000 (72%)] Loss: 0.90272 (QuantReg: 13.57860) QuantErr: 13.57860 batch_time=0.39546 
Train Epoch: 32 [369/500 23616/32000 (74%)] Loss: 0.77808 (QuantReg: 13.41671) QuantErr: 13.41671 batch_time=0.44411 
Train Epoch: 32 [377/500 24128/32000 (75%)] Loss: 0.63259 (QuantReg: 13.67524) QuantErr: 13.67524 batch_time=0.39583 
Train Epoch: 32 [385/500 24640/32000 (77%)] Loss: 0.68882 (QuantReg: 13.73645) QuantErr: 13.73645 batch_time=3.03252 
Train Epoch: 32 [393/500 25152/32000 (79%)] Loss: 0.52225 (QuantReg: 13.65641) QuantErr: 13.65641 batch_time=0.46011 
Train Epoch: 32 [401/500 25664/32000 (80%)] Loss: 0.74317 (QuantReg: 13.95503) QuantErr: 13.95503 batch_time=0.39807 
Train Epoch: 32 [409/500 26176/32000 (82%)] Loss: 0.83549 (QuantReg: 13.86416) QuantErr: 13.86416 batch_time=0.42234 
Train Epoch: 32 [417/500 26688/32000 (83%)] Loss: 0.66559 (QuantReg: 13.42289) QuantErr: 13.42289 batch_time=0.39958 
Train Epoch: 32 [425/500 27200/32000 (85%)] Loss: 0.85627 (QuantReg: 13.40058) QuantErr: 13.40058 batch_time=0.39429 
Train Epoch: 32 [433/500 27712/32000 (87%)] Loss: 0.89797 (QuantReg: 13.34958) QuantErr: 13.34958 batch_time=0.39274 
Train Epoch: 32 [441/500 28224/32000 (88%)] Loss: 0.44671 (QuantReg: 13.47376) QuantErr: 13.47376 batch_time=0.44747 
Train Epoch: 32 [449/500 28736/32000 (90%)] Loss: 0.91850 (QuantReg: 13.39293) QuantErr: 13.39293 batch_time=2.54943 
Train Epoch: 32 [457/500 29248/32000 (91%)] Loss: 0.75497 (QuantReg: 13.73616) QuantErr: 13.73616 batch_time=0.39021 
Train Epoch: 32 [465/500 29760/32000 (93%)] Loss: 0.86018 (QuantReg: 13.14414) QuantErr: 13.14414 batch_time=0.41890 
Train Epoch: 32 [473/500 30272/32000 (95%)] Loss: 0.46261 (QuantReg: 13.44570) QuantErr: 13.44570 batch_time=0.41416 
Train Epoch: 32 [481/500 30784/32000 (96%)] Loss: 0.59370 (QuantReg: 13.73216) QuantErr: 13.73216 batch_time=0.44294 
Train Epoch: 32 [489/500 31296/32000 (98%)] Loss: 0.93241 (QuantReg: 13.20627) QuantErr: 13.20627 batch_time=0.40304 
Train Epoch: 32 [497/500 31808/32000 (99%)] Loss: 1.02996 (QuantReg: 13.00382) QuantErr: 13.00382 batch_time=0.40795 
Train Epoch: 32 codebook_update_time=1.67355
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch32.pth ...
Done in 3.868s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch32.pth ...
Done in 8.719s
removing stale ckpt [epoch 31] [took 0.10s]
 epoch          : 32
 loss           : 0.6845057519078255
 quant_reg      : 13.41840086555481
 quant_err      : 13.41840086555481
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 16000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.651
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.44075176827318
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.053
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.122301514416556
 mnt_best       : 45.44075176827318
 not_improved_count: 0
Train Epoch: 33 [1/500 64/32000 (0%)] Loss: 0.76632 (QuantReg: 13.32496) QuantErr: 13.32496 batch_time=22.03890 
Train Epoch: 33 [9/500 576/32000 (2%)] Loss: 0.86364 (QuantReg: 13.59241) QuantErr: 13.59241 batch_time=0.40504 
Train Epoch: 33 [17/500 1088/32000 (3%)] Loss: 0.79768 (QuantReg: 13.55687) QuantErr: 13.55687 batch_time=0.45212 
Train Epoch: 33 [25/500 1600/32000 (5%)] Loss: 0.64201 (QuantReg: 12.91244) QuantErr: 12.91244 batch_time=0.38702 
Train Epoch: 33 [33/500 2112/32000 (7%)] Loss: 0.61357 (QuantReg: 13.36485) QuantErr: 13.36485 batch_time=0.41012 
Train Epoch: 33 [41/500 2624/32000 (8%)] Loss: 0.69383 (QuantReg: 13.39871) QuantErr: 13.39871 batch_time=0.40091 
Train Epoch: 33 [49/500 3136/32000 (10%)] Loss: 0.41443 (QuantReg: 13.43620) QuantErr: 13.43620 batch_time=0.41463 
Train Epoch: 33 [57/500 3648/32000 (11%)] Loss: 0.56782 (QuantReg: 13.58529) QuantErr: 13.58529 batch_time=0.59801 
Train Epoch: 33 [65/500 4160/32000 (13%)] Loss: 0.65662 (QuantReg: 13.80991) QuantErr: 13.80991 batch_time=0.68200 
Train Epoch: 33 [73/500 4672/32000 (15%)] Loss: 0.79066 (QuantReg: 13.60437) QuantErr: 13.60437 batch_time=0.42929 
Train Epoch: 33 [81/500 5184/32000 (16%)] Loss: 0.61772 (QuantReg: 13.47523) QuantErr: 13.47523 batch_time=0.39685 
Train Epoch: 33 [89/500 5696/32000 (18%)] Loss: 0.71952 (QuantReg: 13.62414) QuantErr: 13.62414 batch_time=0.39642 
Train Epoch: 33 [97/500 6208/32000 (19%)] Loss: 0.51508 (QuantReg: 13.85295) QuantErr: 13.85295 batch_time=0.39329 
Train Epoch: 33 [105/500 6720/32000 (21%)] Loss: 0.80462 (QuantReg: 13.56499) QuantErr: 13.56499 batch_time=0.40176 
Train Epoch: 33 [113/500 7232/32000 (23%)] Loss: 0.73975 (QuantReg: 13.41095) QuantErr: 13.41095 batch_time=0.42038 
Train Epoch: 33 [121/500 7744/32000 (24%)] Loss: 0.52684 (QuantReg: 13.71245) QuantErr: 13.71245 batch_time=0.45736 
Train Epoch: 33 [129/500 8256/32000 (26%)] Loss: 0.53419 (QuantReg: 13.20831) QuantErr: 13.20831 batch_time=0.61326 
Train Epoch: 33 [137/500 8768/32000 (27%)] Loss: 0.69229 (QuantReg: 13.45464) QuantErr: 13.45464 batch_time=0.39666 
Train Epoch: 33 [145/500 9280/32000 (29%)] Loss: 0.48992 (QuantReg: 13.18693) QuantErr: 13.18693 batch_time=0.46648 
Train Epoch: 33 [153/500 9792/32000 (31%)] Loss: 0.92981 (QuantReg: 13.83290) QuantErr: 13.83290 batch_time=0.39490 
Train Epoch: 33 [161/500 10304/32000 (32%)] Loss: 0.51614 (QuantReg: 13.38597) QuantErr: 13.38597 batch_time=0.45030 
Train Epoch: 33 [169/500 10816/32000 (34%)] Loss: 0.61682 (QuantReg: 13.51958) QuantErr: 13.51958 batch_time=0.39449 
Train Epoch: 33 [177/500 11328/32000 (35%)] Loss: 0.73446 (QuantReg: 13.05078) QuantErr: 13.05078 batch_time=0.44734 
Train Epoch: 33 [185/500 11840/32000 (37%)] Loss: 0.76335 (QuantReg: 13.40592) QuantErr: 13.40592 batch_time=0.40146 
Train Epoch: 33 [193/500 12352/32000 (39%)] Loss: 0.39113 (QuantReg: 13.75738) QuantErr: 13.75738 batch_time=0.63331 
Train Epoch: 33 [201/500 12864/32000 (40%)] Loss: 0.84430 (QuantReg: 13.35784) QuantErr: 13.35784 batch_time=0.39187 
Train Epoch: 33 [209/500 13376/32000 (42%)] Loss: 0.70244 (QuantReg: 13.57610) QuantErr: 13.57610 batch_time=0.43340 
Train Epoch: 33 [217/500 13888/32000 (43%)] Loss: 0.67351 (QuantReg: 14.08111) QuantErr: 14.08111 batch_time=0.40495 
Train Epoch: 33 [225/500 14400/32000 (45%)] Loss: 0.71389 (QuantReg: 13.50363) QuantErr: 13.50363 batch_time=0.42677 
Train Epoch: 33 [233/500 14912/32000 (47%)] Loss: 0.62316 (QuantReg: 13.61019) QuantErr: 13.61019 batch_time=0.38947 
Train Epoch: 33 [241/500 15424/32000 (48%)] Loss: 0.90560 (QuantReg: 13.31880) QuantErr: 13.31880 batch_time=0.39285 
Train Epoch: 33 [249/500 15936/32000 (50%)] Loss: 0.45111 (QuantReg: 13.24528) QuantErr: 13.24528 batch_time=0.39961 
Train Epoch: 33 [257/500 16448/32000 (51%)] Loss: 0.68690 (QuantReg: 13.55995) QuantErr: 13.55995 batch_time=0.69587 
Train Epoch: 33 [265/500 16960/32000 (53%)] Loss: 0.69879 (QuantReg: 13.31113) QuantErr: 13.31113 batch_time=0.39481 
Train Epoch: 33 [273/500 17472/32000 (55%)] Loss: 0.80810 (QuantReg: 13.28352) QuantErr: 13.28352 batch_time=0.39642 
Train Epoch: 33 [281/500 17984/32000 (56%)] Loss: 0.44603 (QuantReg: 13.59360) QuantErr: 13.59360 batch_time=0.39357 
Train Epoch: 33 [289/500 18496/32000 (58%)] Loss: 0.42202 (QuantReg: 13.07873) QuantErr: 13.07873 batch_time=0.39494 
Train Epoch: 33 [297/500 19008/32000 (59%)] Loss: 0.55429 (QuantReg: 13.76513) QuantErr: 13.76513 batch_time=0.40015 
Train Epoch: 33 [305/500 19520/32000 (61%)] Loss: 1.15851 (QuantReg: 13.15308) QuantErr: 13.15308 batch_time=0.39215 
Train Epoch: 33 [313/500 20032/32000 (63%)] Loss: 0.47019 (QuantReg: 13.50614) QuantErr: 13.50614 batch_time=0.39777 
Train Epoch: 33 [321/500 20544/32000 (64%)] Loss: 0.39271 (QuantReg: 13.49361) QuantErr: 13.49361 batch_time=0.65923 
Train Epoch: 33 [329/500 21056/32000 (66%)] Loss: 0.79969 (QuantReg: 13.08477) QuantErr: 13.08477 batch_time=0.40207 
Train Epoch: 33 [337/500 21568/32000 (67%)] Loss: 0.80227 (QuantReg: 13.17172) QuantErr: 13.17172 batch_time=0.41325 
Train Epoch: 33 [345/500 22080/32000 (69%)] Loss: 0.82244 (QuantReg: 13.12667) QuantErr: 13.12667 batch_time=0.40180 
Train Epoch: 33 [353/500 22592/32000 (71%)] Loss: 0.54693 (QuantReg: 13.17125) QuantErr: 13.17125 batch_time=0.40299 
Train Epoch: 33 [361/500 23104/32000 (72%)] Loss: 0.68009 (QuantReg: 13.67071) QuantErr: 13.67071 batch_time=0.39774 
Train Epoch: 33 [369/500 23616/32000 (74%)] Loss: 0.61199 (QuantReg: 13.16412) QuantErr: 13.16412 batch_time=0.40146 
Train Epoch: 33 [377/500 24128/32000 (75%)] Loss: 0.89623 (QuantReg: 13.63853) QuantErr: 13.63853 batch_time=0.43895 
Train Epoch: 33 [385/500 24640/32000 (77%)] Loss: 0.31962 (QuantReg: 14.27157) QuantErr: 14.27157 batch_time=0.64550 
Train Epoch: 33 [393/500 25152/32000 (79%)] Loss: 0.71240 (QuantReg: 13.64974) QuantErr: 13.64974 batch_time=0.39338 
Train Epoch: 33 [401/500 25664/32000 (80%)] Loss: 0.50853 (QuantReg: 13.27224) QuantErr: 13.27224 batch_time=0.42843 
Train Epoch: 33 [409/500 26176/32000 (82%)] Loss: 0.80214 (QuantReg: 13.40651) QuantErr: 13.40651 batch_time=0.40981 
Train Epoch: 33 [417/500 26688/32000 (83%)] Loss: 0.68607 (QuantReg: 13.65627) QuantErr: 13.65627 batch_time=0.39998 
Train Epoch: 33 [425/500 27200/32000 (85%)] Loss: 0.55015 (QuantReg: 13.52586) QuantErr: 13.52586 batch_time=0.40076 
Train Epoch: 33 [433/500 27712/32000 (87%)] Loss: 0.88226 (QuantReg: 13.76086) QuantErr: 13.76086 batch_time=0.41914 
Train Epoch: 33 [441/500 28224/32000 (88%)] Loss: 0.56198 (QuantReg: 13.29890) QuantErr: 13.29890 batch_time=0.39614 
Train Epoch: 33 [449/500 28736/32000 (90%)] Loss: 0.38094 (QuantReg: 13.51288) QuantErr: 13.51288 batch_time=0.67197 
Train Epoch: 33 [457/500 29248/32000 (91%)] Loss: 0.46841 (QuantReg: 13.70232) QuantErr: 13.70232 batch_time=0.40307 
Train Epoch: 33 [465/500 29760/32000 (93%)] Loss: 0.81938 (QuantReg: 13.60428) QuantErr: 13.60428 batch_time=0.40601 
Train Epoch: 33 [473/500 30272/32000 (95%)] Loss: 0.81296 (QuantReg: 13.67702) QuantErr: 13.67702 batch_time=0.40204 
Train Epoch: 33 [481/500 30784/32000 (96%)] Loss: 0.78422 (QuantReg: 13.56723) QuantErr: 13.56723 batch_time=0.40724 
Train Epoch: 33 [489/500 31296/32000 (98%)] Loss: 0.66098 (QuantReg: 13.23369) QuantErr: 13.23369 batch_time=0.39954 
Train Epoch: 33 [497/500 31808/32000 (99%)] Loss: 0.64354 (QuantReg: 13.11969) QuantErr: 13.11969 batch_time=0.40995 
Train Epoch: 33 codebook_update_time=1.74990
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch33.pth ...
Done in 4.016s
removing stale ckpt [epoch 32] [took 0.01s]
 epoch          : 33
 loss           : 0.6656416220664978
 quant_reg      : 13.432469116210937
 quant_err      : 13.432469116210937
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 16500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.967
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.39626977427247
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.069
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.889133135002155
 mnt_best       : 45.44075176827318
 not_improved_count: 1
Train Epoch: 34 [1/500 64/32000 (0%)] Loss: 0.53124 (QuantReg: 13.39938) QuantErr: 13.39938 batch_time=22.45246 
Train Epoch: 34 [9/500 576/32000 (2%)] Loss: 0.45090 (QuantReg: 13.66512) QuantErr: 13.66512 batch_time=0.52469 
Train Epoch: 34 [17/500 1088/32000 (3%)] Loss: 0.56359 (QuantReg: 13.44100) QuantErr: 13.44100 batch_time=1.16123 
Train Epoch: 34 [25/500 1600/32000 (5%)] Loss: 0.90598 (QuantReg: 13.24926) QuantErr: 13.24926 batch_time=0.72344 
Train Epoch: 34 [33/500 2112/32000 (7%)] Loss: 0.70429 (QuantReg: 13.12387) QuantErr: 13.12387 batch_time=0.42370 
Train Epoch: 34 [41/500 2624/32000 (8%)] Loss: 0.45194 (QuantReg: 13.90493) QuantErr: 13.90493 batch_time=0.39423 
Train Epoch: 34 [49/500 3136/32000 (10%)] Loss: 0.73266 (QuantReg: 12.66519) QuantErr: 12.66519 batch_time=0.39991 
Train Epoch: 34 [57/500 3648/32000 (11%)] Loss: 0.67303 (QuantReg: 13.12244) QuantErr: 13.12244 batch_time=0.45530 
Train Epoch: 34 [65/500 4160/32000 (13%)] Loss: 0.60643 (QuantReg: 13.47825) QuantErr: 13.47825 batch_time=0.92805 
Train Epoch: 34 [73/500 4672/32000 (15%)] Loss: 0.46909 (QuantReg: 13.63993) QuantErr: 13.63993 batch_time=0.52668 
Train Epoch: 34 [81/500 5184/32000 (16%)] Loss: 0.45985 (QuantReg: 13.56014) QuantErr: 13.56014 batch_time=0.83669 
Train Epoch: 34 [89/500 5696/32000 (18%)] Loss: 0.56441 (QuantReg: 13.20854) QuantErr: 13.20854 batch_time=0.68080 
Train Epoch: 34 [97/500 6208/32000 (19%)] Loss: 0.64229 (QuantReg: 13.19533) QuantErr: 13.19533 batch_time=0.39113 
Train Epoch: 34 [105/500 6720/32000 (21%)] Loss: 0.45801 (QuantReg: 13.82607) QuantErr: 13.82607 batch_time=0.42660 
Train Epoch: 34 [113/500 7232/32000 (23%)] Loss: 0.52886 (QuantReg: 13.38761) QuantErr: 13.38761 batch_time=0.38617 
Train Epoch: 34 [121/500 7744/32000 (24%)] Loss: 0.71563 (QuantReg: 13.29948) QuantErr: 13.29948 batch_time=0.46418 
Train Epoch: 34 [129/500 8256/32000 (26%)] Loss: 0.61875 (QuantReg: 13.46001) QuantErr: 13.46001 batch_time=0.99924 
Train Epoch: 34 [137/500 8768/32000 (27%)] Loss: 0.72452 (QuantReg: 13.88813) QuantErr: 13.88813 batch_time=0.51773 
Train Epoch: 34 [145/500 9280/32000 (29%)] Loss: 0.53906 (QuantReg: 13.73748) QuantErr: 13.73748 batch_time=1.03245 
Train Epoch: 34 [153/500 9792/32000 (31%)] Loss: 0.80710 (QuantReg: 13.56419) QuantErr: 13.56419 batch_time=0.73354 
Train Epoch: 34 [161/500 10304/32000 (32%)] Loss: 0.72563 (QuantReg: 13.50359) QuantErr: 13.50359 batch_time=0.38685 
Train Epoch: 34 [169/500 10816/32000 (34%)] Loss: 1.15965 (QuantReg: 13.77549) QuantErr: 13.77549 batch_time=0.38297 
Train Epoch: 34 [177/500 11328/32000 (35%)] Loss: 0.58719 (QuantReg: 13.65351) QuantErr: 13.65351 batch_time=0.38681 
Train Epoch: 34 [185/500 11840/32000 (37%)] Loss: 0.50134 (QuantReg: 13.33976) QuantErr: 13.33976 batch_time=0.50230 
Train Epoch: 34 [193/500 12352/32000 (39%)] Loss: 0.63198 (QuantReg: 13.68411) QuantErr: 13.68411 batch_time=0.90058 
Train Epoch: 34 [201/500 12864/32000 (40%)] Loss: 0.53671 (QuantReg: 13.66025) QuantErr: 13.66025 batch_time=0.53197 
Train Epoch: 34 [209/500 13376/32000 (42%)] Loss: 0.81460 (QuantReg: 13.51843) QuantErr: 13.51843 batch_time=0.83981 
Train Epoch: 34 [217/500 13888/32000 (43%)] Loss: 0.50579 (QuantReg: 13.49348) QuantErr: 13.49348 batch_time=0.70611 
Train Epoch: 34 [225/500 14400/32000 (45%)] Loss: 0.65791 (QuantReg: 13.39806) QuantErr: 13.39806 batch_time=0.42594 
Train Epoch: 34 [233/500 14912/32000 (47%)] Loss: 0.54771 (QuantReg: 13.68732) QuantErr: 13.68732 batch_time=0.39903 
Train Epoch: 34 [241/500 15424/32000 (48%)] Loss: 0.54443 (QuantReg: 13.61593) QuantErr: 13.61593 batch_time=0.40422 
Train Epoch: 34 [249/500 15936/32000 (50%)] Loss: 0.62714 (QuantReg: 13.52103) QuantErr: 13.52103 batch_time=0.49735 
Train Epoch: 34 [257/500 16448/32000 (51%)] Loss: 0.91039 (QuantReg: 13.31017) QuantErr: 13.31017 batch_time=0.90373 
Train Epoch: 34 [265/500 16960/32000 (53%)] Loss: 0.60939 (QuantReg: 13.59452) QuantErr: 13.59452 batch_time=0.59268 
Train Epoch: 34 [273/500 17472/32000 (55%)] Loss: 0.68759 (QuantReg: 13.47763) QuantErr: 13.47763 batch_time=0.85252 
Train Epoch: 34 [281/500 17984/32000 (56%)] Loss: 0.50255 (QuantReg: 13.52312) QuantErr: 13.52312 batch_time=0.66844 
Train Epoch: 34 [289/500 18496/32000 (58%)] Loss: 0.65701 (QuantReg: 13.64070) QuantErr: 13.64070 batch_time=0.39936 
Train Epoch: 34 [297/500 19008/32000 (59%)] Loss: 0.63731 (QuantReg: 13.49215) QuantErr: 13.49215 batch_time=0.37816 
Train Epoch: 34 [305/500 19520/32000 (61%)] Loss: 0.77689 (QuantReg: 13.45036) QuantErr: 13.45036 batch_time=0.37410 
Train Epoch: 34 [313/500 20032/32000 (63%)] Loss: 0.63021 (QuantReg: 13.24323) QuantErr: 13.24323 batch_time=0.46926 
Train Epoch: 34 [321/500 20544/32000 (64%)] Loss: 0.74155 (QuantReg: 13.39475) QuantErr: 13.39475 batch_time=0.85657 
Train Epoch: 34 [329/500 21056/32000 (66%)] Loss: 0.68020 (QuantReg: 13.27797) QuantErr: 13.27797 batch_time=0.52964 
Train Epoch: 34 [337/500 21568/32000 (67%)] Loss: 0.72913 (QuantReg: 12.92314) QuantErr: 12.92314 batch_time=0.92360 
Train Epoch: 34 [345/500 22080/32000 (69%)] Loss: 0.54341 (QuantReg: 13.55009) QuantErr: 13.55009 batch_time=0.66387 
Train Epoch: 34 [353/500 22592/32000 (71%)] Loss: 0.74379 (QuantReg: 12.85922) QuantErr: 12.85922 batch_time=0.38329 
Train Epoch: 34 [361/500 23104/32000 (72%)] Loss: 0.51890 (QuantReg: 13.35451) QuantErr: 13.35451 batch_time=0.42367 
Train Epoch: 34 [369/500 23616/32000 (74%)] Loss: 0.94848 (QuantReg: 13.79797) QuantErr: 13.79797 batch_time=0.41216 
Train Epoch: 34 [377/500 24128/32000 (75%)] Loss: 1.08228 (QuantReg: 13.40605) QuantErr: 13.40605 batch_time=0.48378 
Train Epoch: 34 [385/500 24640/32000 (77%)] Loss: 0.72629 (QuantReg: 13.31750) QuantErr: 13.31750 batch_time=0.87108 
Train Epoch: 34 [393/500 25152/32000 (79%)] Loss: 0.76272 (QuantReg: 13.78233) QuantErr: 13.78233 batch_time=0.51976 
Train Epoch: 34 [401/500 25664/32000 (80%)] Loss: 0.77579 (QuantReg: 13.66190) QuantErr: 13.66190 batch_time=0.92212 
Train Epoch: 34 [409/500 26176/32000 (82%)] Loss: 0.53028 (QuantReg: 13.54794) QuantErr: 13.54794 batch_time=0.68206 
Train Epoch: 34 [417/500 26688/32000 (83%)] Loss: 0.77779 (QuantReg: 13.89540) QuantErr: 13.89540 batch_time=0.39754 
Train Epoch: 34 [425/500 27200/32000 (85%)] Loss: 0.57034 (QuantReg: 13.28222) QuantErr: 13.28222 batch_time=0.41781 
Train Epoch: 34 [433/500 27712/32000 (87%)] Loss: 0.60960 (QuantReg: 13.28339) QuantErr: 13.28339 batch_time=0.40057 
Train Epoch: 34 [441/500 28224/32000 (88%)] Loss: 0.63057 (QuantReg: 13.23445) QuantErr: 13.23445 batch_time=0.48580 
Train Epoch: 34 [449/500 28736/32000 (90%)] Loss: 0.76220 (QuantReg: 12.81895) QuantErr: 12.81895 batch_time=0.85524 
Train Epoch: 34 [457/500 29248/32000 (91%)] Loss: 0.88238 (QuantReg: 13.56436) QuantErr: 13.56436 batch_time=0.53818 
Train Epoch: 34 [465/500 29760/32000 (93%)] Loss: 0.77180 (QuantReg: 13.11358) QuantErr: 13.11358 batch_time=0.87701 
Train Epoch: 34 [473/500 30272/32000 (95%)] Loss: 0.69165 (QuantReg: 13.89075) QuantErr: 13.89075 batch_time=0.69310 
Train Epoch: 34 [481/500 30784/32000 (96%)] Loss: 0.35956 (QuantReg: 13.55148) QuantErr: 13.55148 batch_time=0.38744 
Train Epoch: 34 [489/500 31296/32000 (98%)] Loss: 0.85028 (QuantReg: 13.22185) QuantErr: 13.22185 batch_time=0.39098 
Train Epoch: 34 [497/500 31808/32000 (99%)] Loss: 0.44214 (QuantReg: 13.76375) QuantErr: 13.76375 batch_time=0.38982 
Train Epoch: 34 codebook_update_time=1.76005
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch34.pth ...
Done in 4.045s
removing stale ckpt [epoch 33] [took 0.02s]
 epoch          : 34
 loss           : 0.6624145791530609
 quant_reg      : 13.431073579788208
 quant_err      : 13.431073579788208
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 17000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.14
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.02574625440912
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.6995
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.04519804463037
 mnt_best       : 45.44075176827318
 not_improved_count: 2
Train Epoch: 35 [1/500 64/32000 (0%)] Loss: 0.70343 (QuantReg: 13.45226) QuantErr: 13.45226 batch_time=24.62835 
Train Epoch: 35 [9/500 576/32000 (2%)] Loss: 0.80401 (QuantReg: 13.56003) QuantErr: 13.56003 batch_time=0.40088 
Train Epoch: 35 [17/500 1088/32000 (3%)] Loss: 0.69227 (QuantReg: 13.45671) QuantErr: 13.45671 batch_time=0.39602 
Train Epoch: 35 [25/500 1600/32000 (5%)] Loss: 0.52917 (QuantReg: 13.50452) QuantErr: 13.50452 batch_time=0.39563 
Train Epoch: 35 [33/500 2112/32000 (7%)] Loss: 0.60128 (QuantReg: 13.28896) QuantErr: 13.28896 batch_time=0.41596 
Train Epoch: 35 [41/500 2624/32000 (8%)] Loss: 0.60322 (QuantReg: 13.14393) QuantErr: 13.14393 batch_time=0.39790 
Train Epoch: 35 [49/500 3136/32000 (10%)] Loss: 0.60521 (QuantReg: 13.07389) QuantErr: 13.07389 batch_time=0.47510 
Train Epoch: 35 [57/500 3648/32000 (11%)] Loss: 0.96374 (QuantReg: 13.44596) QuantErr: 13.44596 batch_time=0.58387 
Train Epoch: 35 [65/500 4160/32000 (13%)] Loss: 0.46599 (QuantReg: 13.59331) QuantErr: 13.59331 batch_time=0.46930 
Train Epoch: 35 [73/500 4672/32000 (15%)] Loss: 0.78192 (QuantReg: 13.64136) QuantErr: 13.64136 batch_time=0.42773 
Train Epoch: 35 [81/500 5184/32000 (16%)] Loss: 0.79048 (QuantReg: 13.64184) QuantErr: 13.64184 batch_time=0.44044 
Train Epoch: 35 [89/500 5696/32000 (18%)] Loss: 0.64550 (QuantReg: 13.46546) QuantErr: 13.46546 batch_time=0.41052 
Train Epoch: 35 [97/500 6208/32000 (19%)] Loss: 0.74678 (QuantReg: 13.04306) QuantErr: 13.04306 batch_time=0.40327 
Train Epoch: 35 [105/500 6720/32000 (21%)] Loss: 0.47554 (QuantReg: 13.71336) QuantErr: 13.71336 batch_time=0.45446 
Train Epoch: 35 [113/500 7232/32000 (23%)] Loss: 0.57303 (QuantReg: 13.03387) QuantErr: 13.03387 batch_time=0.44038 
Train Epoch: 35 [121/500 7744/32000 (24%)] Loss: 0.63591 (QuantReg: 13.33241) QuantErr: 13.33241 batch_time=0.40617 
Train Epoch: 35 [129/500 8256/32000 (26%)] Loss: 0.84159 (QuantReg: 13.58519) QuantErr: 13.58519 batch_time=0.61024 
Train Epoch: 35 [137/500 8768/32000 (27%)] Loss: 0.57279 (QuantReg: 13.26743) QuantErr: 13.26743 batch_time=0.45509 
Train Epoch: 35 [145/500 9280/32000 (29%)] Loss: 0.63161 (QuantReg: 13.87253) QuantErr: 13.87253 batch_time=0.39895 
Train Epoch: 35 [153/500 9792/32000 (31%)] Loss: 0.55980 (QuantReg: 13.67478) QuantErr: 13.67478 batch_time=0.39887 
Train Epoch: 35 [161/500 10304/32000 (32%)] Loss: 0.63631 (QuantReg: 13.52165) QuantErr: 13.52165 batch_time=0.40473 
Train Epoch: 35 [169/500 10816/32000 (34%)] Loss: 0.64602 (QuantReg: 13.93235) QuantErr: 13.93235 batch_time=0.45785 
Train Epoch: 35 [177/500 11328/32000 (35%)] Loss: 0.63184 (QuantReg: 13.45234) QuantErr: 13.45234 batch_time=0.44394 
Train Epoch: 35 [185/500 11840/32000 (37%)] Loss: 0.66853 (QuantReg: 13.65699) QuantErr: 13.65699 batch_time=0.40699 
Train Epoch: 35 [193/500 12352/32000 (39%)] Loss: 0.62609 (QuantReg: 13.70237) QuantErr: 13.70237 batch_time=0.43608 
Train Epoch: 35 [201/500 12864/32000 (40%)] Loss: 0.58831 (QuantReg: 13.38255) QuantErr: 13.38255 batch_time=0.38751 
Train Epoch: 35 [209/500 13376/32000 (42%)] Loss: 1.34589 (QuantReg: 13.03106) QuantErr: 13.03106 batch_time=0.40788 
Train Epoch: 35 [217/500 13888/32000 (43%)] Loss: 0.67119 (QuantReg: 13.11906) QuantErr: 13.11906 batch_time=0.44904 
Train Epoch: 35 [225/500 14400/32000 (45%)] Loss: 0.65701 (QuantReg: 13.72173) QuantErr: 13.72173 batch_time=0.40621 
Train Epoch: 35 [233/500 14912/32000 (47%)] Loss: 1.13671 (QuantReg: 13.31465) QuantErr: 13.31465 batch_time=0.39729 
Train Epoch: 35 [241/500 15424/32000 (48%)] Loss: 0.56865 (QuantReg: 13.65700) QuantErr: 13.65700 batch_time=0.49088 
Train Epoch: 35 [249/500 15936/32000 (50%)] Loss: 0.74356 (QuantReg: 13.49782) QuantErr: 13.49782 batch_time=0.39163 
Train Epoch: 35 [257/500 16448/32000 (51%)] Loss: 0.61903 (QuantReg: 13.82406) QuantErr: 13.82406 batch_time=0.44466 
Train Epoch: 35 [265/500 16960/32000 (53%)] Loss: 0.66766 (QuantReg: 13.67044) QuantErr: 13.67044 batch_time=0.39688 
Train Epoch: 35 [273/500 17472/32000 (55%)] Loss: 0.81754 (QuantReg: 13.30575) QuantErr: 13.30575 batch_time=0.40930 
Train Epoch: 35 [281/500 17984/32000 (56%)] Loss: 0.60256 (QuantReg: 13.79700) QuantErr: 13.79700 batch_time=0.42814 
Train Epoch: 35 [289/500 18496/32000 (58%)] Loss: 0.56917 (QuantReg: 13.20384) QuantErr: 13.20384 batch_time=0.46257 
Train Epoch: 35 [297/500 19008/32000 (59%)] Loss: 0.54968 (QuantReg: 13.66787) QuantErr: 13.66787 batch_time=0.42319 
Train Epoch: 35 [305/500 19520/32000 (61%)] Loss: 0.80884 (QuantReg: 13.38210) QuantErr: 13.38210 batch_time=0.45847 
Train Epoch: 35 [313/500 20032/32000 (63%)] Loss: 0.65516 (QuantReg: 13.31218) QuantErr: 13.31218 batch_time=0.38770 
Train Epoch: 35 [321/500 20544/32000 (64%)] Loss: 0.63846 (QuantReg: 13.31071) QuantErr: 13.31071 batch_time=0.75041 
Train Epoch: 35 [329/500 21056/32000 (66%)] Loss: 0.74933 (QuantReg: 13.57072) QuantErr: 13.57072 batch_time=0.41064 
Train Epoch: 35 [337/500 21568/32000 (67%)] Loss: 0.76863 (QuantReg: 13.50210) QuantErr: 13.50210 batch_time=0.38955 
Train Epoch: 35 [345/500 22080/32000 (69%)] Loss: 0.60602 (QuantReg: 13.71989) QuantErr: 13.71989 batch_time=0.42005 
Train Epoch: 35 [353/500 22592/32000 (71%)] Loss: 0.73442 (QuantReg: 13.35117) QuantErr: 13.35117 batch_time=0.39044 
Train Epoch: 35 [361/500 23104/32000 (72%)] Loss: 0.72596 (QuantReg: 13.66283) QuantErr: 13.66283 batch_time=0.44922 
Train Epoch: 35 [369/500 23616/32000 (74%)] Loss: 0.88283 (QuantReg: 13.32056) QuantErr: 13.32056 batch_time=0.45506 
Train Epoch: 35 [377/500 24128/32000 (75%)] Loss: 0.65634 (QuantReg: 13.74868) QuantErr: 13.74868 batch_time=0.43169 
Train Epoch: 35 [385/500 24640/32000 (77%)] Loss: 0.45853 (QuantReg: 13.50334) QuantErr: 13.50334 batch_time=0.48764 
Train Epoch: 35 [393/500 25152/32000 (79%)] Loss: 0.98207 (QuantReg: 13.49703) QuantErr: 13.49703 batch_time=0.40940 
Train Epoch: 35 [401/500 25664/32000 (80%)] Loss: 0.46626 (QuantReg: 13.53313) QuantErr: 13.53313 batch_time=0.40436 
Train Epoch: 35 [409/500 26176/32000 (82%)] Loss: 0.58497 (QuantReg: 13.88021) QuantErr: 13.88021 batch_time=0.40620 
Train Epoch: 35 [417/500 26688/32000 (83%)] Loss: 0.69738 (QuantReg: 13.44301) QuantErr: 13.44301 batch_time=0.40038 
Train Epoch: 35 [425/500 27200/32000 (85%)] Loss: 0.67095 (QuantReg: 13.55659) QuantErr: 13.55659 batch_time=0.45465 
Train Epoch: 35 [433/500 27712/32000 (87%)] Loss: 0.89388 (QuantReg: 13.14991) QuantErr: 13.14991 batch_time=0.45192 
Train Epoch: 35 [441/500 28224/32000 (88%)] Loss: 0.72184 (QuantReg: 13.46803) QuantErr: 13.46803 batch_time=0.39531 
Train Epoch: 35 [449/500 28736/32000 (90%)] Loss: 0.40044 (QuantReg: 13.88882) QuantErr: 13.88882 batch_time=0.45532 
Train Epoch: 35 [457/500 29248/32000 (91%)] Loss: 0.64963 (QuantReg: 13.60372) QuantErr: 13.60372 batch_time=0.40466 
Train Epoch: 35 [465/500 29760/32000 (93%)] Loss: 0.60547 (QuantReg: 13.32778) QuantErr: 13.32778 batch_time=0.46458 
Train Epoch: 35 [473/500 30272/32000 (95%)] Loss: 0.91737 (QuantReg: 13.37544) QuantErr: 13.37544 batch_time=0.39731 
Train Epoch: 35 [481/500 30784/32000 (96%)] Loss: 1.14082 (QuantReg: 12.96032) QuantErr: 12.96032 batch_time=0.42812 
Train Epoch: 35 [489/500 31296/32000 (98%)] Loss: 0.58606 (QuantReg: 13.70206) QuantErr: 13.70206 batch_time=0.46013 
Train Epoch: 35 [497/500 31808/32000 (99%)] Loss: 0.56851 (QuantReg: 13.64437) QuantErr: 13.64437 batch_time=0.45634 
Train Epoch: 35 codebook_update_time=1.81282
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch35.pth ...
Done in 5.867s
removing stale ckpt [epoch 34] [took 0.02s]
 epoch          : 35
 loss           : 0.6624677760004998
 quant_reg      : 13.498630109786987
 quant_err      : 13.498630109786987
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 17500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.492
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.198566959291725
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.4355
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.457648570190024
 mnt_best       : 45.44075176827318
 not_improved_count: 3
Train Epoch: 36 [1/500 64/32000 (0%)] Loss: 0.56699 (QuantReg: 13.47393) QuantErr: 13.47393 batch_time=22.17990 
Train Epoch: 36 [9/500 576/32000 (2%)] Loss: 0.77498 (QuantReg: 13.58463) QuantErr: 13.58463 batch_time=0.40312 
Train Epoch: 36 [17/500 1088/32000 (3%)] Loss: 0.81890 (QuantReg: 13.60935) QuantErr: 13.60935 batch_time=0.39368 
Train Epoch: 36 [25/500 1600/32000 (5%)] Loss: 0.71552 (QuantReg: 13.59064) QuantErr: 13.59064 batch_time=0.39383 
Train Epoch: 36 [33/500 2112/32000 (7%)] Loss: 0.81375 (QuantReg: 13.81592) QuantErr: 13.81592 batch_time=0.43095 
Train Epoch: 36 [41/500 2624/32000 (8%)] Loss: 0.66440 (QuantReg: 13.40706) QuantErr: 13.40706 batch_time=0.43678 
Train Epoch: 36 [49/500 3136/32000 (10%)] Loss: 0.80548 (QuantReg: 13.07671) QuantErr: 13.07671 batch_time=0.61380 
Train Epoch: 36 [57/500 3648/32000 (11%)] Loss: 0.47742 (QuantReg: 14.01645) QuantErr: 14.01645 batch_time=0.39112 
Train Epoch: 36 [65/500 4160/32000 (13%)] Loss: 0.73677 (QuantReg: 13.45900) QuantErr: 13.45900 batch_time=0.40570 
Train Epoch: 36 [73/500 4672/32000 (15%)] Loss: 0.59484 (QuantReg: 13.11813) QuantErr: 13.11813 batch_time=0.38886 
Train Epoch: 36 [81/500 5184/32000 (16%)] Loss: 0.46437 (QuantReg: 13.51429) QuantErr: 13.51429 batch_time=0.39206 
Train Epoch: 36 [89/500 5696/32000 (18%)] Loss: 0.86324 (QuantReg: 13.16978) QuantErr: 13.16978 batch_time=0.40290 
Train Epoch: 36 [97/500 6208/32000 (19%)] Loss: 0.84367 (QuantReg: 13.34531) QuantErr: 13.34531 batch_time=0.45347 
Train Epoch: 36 [105/500 6720/32000 (21%)] Loss: 0.63932 (QuantReg: 13.41306) QuantErr: 13.41306 batch_time=0.41922 
Train Epoch: 36 [113/500 7232/32000 (23%)] Loss: 0.91422 (QuantReg: 13.38724) QuantErr: 13.38724 batch_time=0.56129 
Train Epoch: 36 [121/500 7744/32000 (24%)] Loss: 0.43537 (QuantReg: 13.46912) QuantErr: 13.46912 batch_time=0.39893 
Train Epoch: 36 [129/500 8256/32000 (26%)] Loss: 0.63831 (QuantReg: 13.22852) QuantErr: 13.22852 batch_time=0.41148 
Train Epoch: 36 [137/500 8768/32000 (27%)] Loss: 0.61070 (QuantReg: 13.40976) QuantErr: 13.40976 batch_time=0.39493 
Train Epoch: 36 [145/500 9280/32000 (29%)] Loss: 0.52270 (QuantReg: 13.59490) QuantErr: 13.59490 batch_time=0.39545 
Train Epoch: 36 [153/500 9792/32000 (31%)] Loss: 0.69802 (QuantReg: 13.63967) QuantErr: 13.63967 batch_time=0.42310 
Train Epoch: 36 [161/500 10304/32000 (32%)] Loss: 0.65844 (QuantReg: 13.38765) QuantErr: 13.38765 batch_time=0.39731 
Train Epoch: 36 [169/500 10816/32000 (34%)] Loss: 0.81204 (QuantReg: 13.08282) QuantErr: 13.08282 batch_time=0.39456 
Train Epoch: 36 [177/500 11328/32000 (35%)] Loss: 0.91250 (QuantReg: 13.72949) QuantErr: 13.72949 batch_time=0.58161 
Train Epoch: 36 [185/500 11840/32000 (37%)] Loss: 0.62264 (QuantReg: 13.74016) QuantErr: 13.74016 batch_time=0.47038 
Train Epoch: 36 [193/500 12352/32000 (39%)] Loss: 0.63150 (QuantReg: 12.87654) QuantErr: 12.87654 batch_time=0.38605 
Train Epoch: 36 [201/500 12864/32000 (40%)] Loss: 0.62735 (QuantReg: 13.50412) QuantErr: 13.50412 batch_time=0.40983 
Train Epoch: 36 [209/500 13376/32000 (42%)] Loss: 0.73723 (QuantReg: 13.31974) QuantErr: 13.31974 batch_time=0.39803 
Train Epoch: 36 [217/500 13888/32000 (43%)] Loss: 0.73894 (QuantReg: 13.28460) QuantErr: 13.28460 batch_time=0.39039 
Train Epoch: 36 [225/500 14400/32000 (45%)] Loss: 0.76665 (QuantReg: 13.46223) QuantErr: 13.46223 batch_time=0.39553 
Train Epoch: 36 [233/500 14912/32000 (47%)] Loss: 1.24296 (QuantReg: 13.43927) QuantErr: 13.43927 batch_time=0.39427 
Train Epoch: 36 [241/500 15424/32000 (48%)] Loss: 0.78618 (QuantReg: 13.31898) QuantErr: 13.31898 batch_time=0.56783 
Train Epoch: 36 [249/500 15936/32000 (50%)] Loss: 0.45543 (QuantReg: 13.80477) QuantErr: 13.80477 batch_time=0.45501 
Train Epoch: 36 [257/500 16448/32000 (51%)] Loss: 0.70310 (QuantReg: 13.33637) QuantErr: 13.33637 batch_time=0.39727 
Train Epoch: 36 [265/500 16960/32000 (53%)] Loss: 0.40795 (QuantReg: 13.34572) QuantErr: 13.34572 batch_time=0.41961 
Train Epoch: 36 [273/500 17472/32000 (55%)] Loss: 0.51851 (QuantReg: 13.51170) QuantErr: 13.51170 batch_time=0.40577 
Train Epoch: 36 [281/500 17984/32000 (56%)] Loss: 1.22273 (QuantReg: 13.71044) QuantErr: 13.71044 batch_time=0.47206 
Train Epoch: 36 [289/500 18496/32000 (58%)] Loss: 0.63083 (QuantReg: 13.31793) QuantErr: 13.31793 batch_time=0.40113 
Train Epoch: 36 [297/500 19008/32000 (59%)] Loss: 0.77157 (QuantReg: 13.39646) QuantErr: 13.39646 batch_time=0.39422 
Train Epoch: 36 [305/500 19520/32000 (61%)] Loss: 0.63642 (QuantReg: 13.56764) QuantErr: 13.56764 batch_time=0.51838 
Train Epoch: 36 [313/500 20032/32000 (63%)] Loss: 0.35649 (QuantReg: 13.56432) QuantErr: 13.56432 batch_time=0.42234 
Train Epoch: 36 [321/500 20544/32000 (64%)] Loss: 0.76339 (QuantReg: 13.37096) QuantErr: 13.37096 batch_time=0.39816 
Train Epoch: 36 [329/500 21056/32000 (66%)] Loss: 0.68920 (QuantReg: 13.57171) QuantErr: 13.57171 batch_time=0.39151 
Train Epoch: 36 [337/500 21568/32000 (67%)] Loss: 0.56677 (QuantReg: 13.57978) QuantErr: 13.57978 batch_time=0.40903 
Train Epoch: 36 [345/500 22080/32000 (69%)] Loss: 0.60130 (QuantReg: 13.93848) QuantErr: 13.93848 batch_time=0.40033 
Train Epoch: 36 [353/500 22592/32000 (71%)] Loss: 0.54122 (QuantReg: 13.61511) QuantErr: 13.61511 batch_time=0.44587 
Train Epoch: 36 [361/500 23104/32000 (72%)] Loss: 0.85519 (QuantReg: 13.42098) QuantErr: 13.42098 batch_time=0.40808 
Train Epoch: 36 [369/500 23616/32000 (74%)] Loss: 0.79476 (QuantReg: 13.35822) QuantErr: 13.35822 batch_time=0.52088 
Train Epoch: 36 [377/500 24128/32000 (75%)] Loss: 0.57002 (QuantReg: 13.58809) QuantErr: 13.58809 batch_time=0.39666 
Train Epoch: 36 [385/500 24640/32000 (77%)] Loss: 0.71842 (QuantReg: 13.82802) QuantErr: 13.82802 batch_time=0.39534 
Train Epoch: 36 [393/500 25152/32000 (79%)] Loss: 0.59159 (QuantReg: 13.65347) QuantErr: 13.65347 batch_time=0.39803 
Train Epoch: 36 [401/500 25664/32000 (80%)] Loss: 0.84715 (QuantReg: 13.68818) QuantErr: 13.68818 batch_time=0.39686 
Train Epoch: 36 [409/500 26176/32000 (82%)] Loss: 0.65227 (QuantReg: 13.51143) QuantErr: 13.51143 batch_time=0.40907 
Train Epoch: 36 [417/500 26688/32000 (83%)] Loss: 0.49480 (QuantReg: 13.80729) QuantErr: 13.80729 batch_time=0.39522 
Train Epoch: 36 [425/500 27200/32000 (85%)] Loss: 0.92103 (QuantReg: 13.76772) QuantErr: 13.76772 batch_time=0.41634 
Train Epoch: 36 [433/500 27712/32000 (87%)] Loss: 1.02949 (QuantReg: 13.51201) QuantErr: 13.51201 batch_time=0.52152 
Train Epoch: 36 [441/500 28224/32000 (88%)] Loss: 0.37738 (QuantReg: 13.67510) QuantErr: 13.67510 batch_time=0.42243 
Train Epoch: 36 [449/500 28736/32000 (90%)] Loss: 0.56781 (QuantReg: 13.52842) QuantErr: 13.52842 batch_time=0.39839 
Train Epoch: 36 [457/500 29248/32000 (91%)] Loss: 0.72931 (QuantReg: 13.32836) QuantErr: 13.32836 batch_time=0.40685 
Train Epoch: 36 [465/500 29760/32000 (93%)] Loss: 0.67030 (QuantReg: 13.73206) QuantErr: 13.73206 batch_time=0.38961 
Train Epoch: 36 [473/500 30272/32000 (95%)] Loss: 0.71598 (QuantReg: 13.53993) QuantErr: 13.53993 batch_time=0.41827 
Train Epoch: 36 [481/500 30784/32000 (96%)] Loss: 0.51144 (QuantReg: 13.25550) QuantErr: 13.25550 batch_time=0.41040 
Train Epoch: 36 [489/500 31296/32000 (98%)] Loss: 0.65385 (QuantReg: 13.78982) QuantErr: 13.78982 batch_time=0.45179 
Train Epoch: 36 [497/500 31808/32000 (99%)] Loss: 0.49684 (QuantReg: 13.39147) QuantErr: 13.39147 batch_time=0.51598 
Train Epoch: 36 codebook_update_time=1.73174
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch36.pth ...
Done in 6.127s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch36.pth ...
Done in 11.044s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 0.6549505637288093
 quant_reg      : 13.502695711135864
 quant_err      : 13.502695711135864
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 18000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.672
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.3298567973894
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.365
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.132588479811965
 mnt_best       : 46.3298567973894
 not_improved_count: 0
Train Epoch: 37 [1/500 64/32000 (0%)] Loss: 0.78766 (QuantReg: 13.56776) QuantErr: 13.56776 batch_time=22.17439 
Train Epoch: 37 [9/500 576/32000 (2%)] Loss: 0.41050 (QuantReg: 13.66619) QuantErr: 13.66619 batch_time=2.08429 
Train Epoch: 37 [17/500 1088/32000 (3%)] Loss: 0.75951 (QuantReg: 13.32188) QuantErr: 13.32188 batch_time=0.38157 
Train Epoch: 37 [25/500 1600/32000 (5%)] Loss: 0.55133 (QuantReg: 14.06340) QuantErr: 14.06340 batch_time=1.48514 
Train Epoch: 37 [33/500 2112/32000 (7%)] Loss: 0.70662 (QuantReg: 13.39882) QuantErr: 13.39882 batch_time=0.40977 
Train Epoch: 37 [41/500 2624/32000 (8%)] Loss: 0.52521 (QuantReg: 13.53068) QuantErr: 13.53068 batch_time=0.43842 
Train Epoch: 37 [49/500 3136/32000 (10%)] Loss: 0.80091 (QuantReg: 14.05682) QuantErr: 14.05682 batch_time=0.38896 
Train Epoch: 37 [57/500 3648/32000 (11%)] Loss: 0.53532 (QuantReg: 13.73499) QuantErr: 13.73499 batch_time=0.41007 
Train Epoch: 37 [65/500 4160/32000 (13%)] Loss: 0.54622 (QuantReg: 13.61853) QuantErr: 13.61853 batch_time=0.50457 
Train Epoch: 37 [73/500 4672/32000 (15%)] Loss: 0.40922 (QuantReg: 13.49350) QuantErr: 13.49350 batch_time=1.57680 
Train Epoch: 37 [81/500 5184/32000 (16%)] Loss: 1.08014 (QuantReg: 12.98277) QuantErr: 12.98277 batch_time=0.39572 
Train Epoch: 37 [89/500 5696/32000 (18%)] Loss: 0.93611 (QuantReg: 13.35459) QuantErr: 13.35459 batch_time=1.44987 
Train Epoch: 37 [97/500 6208/32000 (19%)] Loss: 0.89416 (QuantReg: 13.17570) QuantErr: 13.17570 batch_time=0.38707 
Train Epoch: 37 [105/500 6720/32000 (21%)] Loss: 1.06078 (QuantReg: 13.59681) QuantErr: 13.59681 batch_time=0.39650 
Train Epoch: 37 [113/500 7232/32000 (23%)] Loss: 0.83879 (QuantReg: 13.48033) QuantErr: 13.48033 batch_time=0.39467 
Train Epoch: 37 [121/500 7744/32000 (24%)] Loss: 1.10502 (QuantReg: 13.54506) QuantErr: 13.54506 batch_time=0.38845 
Train Epoch: 37 [129/500 8256/32000 (26%)] Loss: 0.49312 (QuantReg: 13.49493) QuantErr: 13.49493 batch_time=0.52427 
Train Epoch: 37 [137/500 8768/32000 (27%)] Loss: 0.66725 (QuantReg: 13.93562) QuantErr: 13.93562 batch_time=1.60515 
Train Epoch: 37 [145/500 9280/32000 (29%)] Loss: 0.69131 (QuantReg: 13.69343) QuantErr: 13.69343 batch_time=0.40053 
Train Epoch: 37 [153/500 9792/32000 (31%)] Loss: 0.50842 (QuantReg: 13.77242) QuantErr: 13.77242 batch_time=1.52543 
Train Epoch: 37 [161/500 10304/32000 (32%)] Loss: 0.50553 (QuantReg: 13.44226) QuantErr: 13.44226 batch_time=0.39550 
Train Epoch: 37 [169/500 10816/32000 (34%)] Loss: 0.58305 (QuantReg: 13.97838) QuantErr: 13.97838 batch_time=0.40693 
Train Epoch: 37 [177/500 11328/32000 (35%)] Loss: 0.62024 (QuantReg: 13.63711) QuantErr: 13.63711 batch_time=0.46311 
Train Epoch: 37 [185/500 11840/32000 (37%)] Loss: 0.47606 (QuantReg: 13.97655) QuantErr: 13.97655 batch_time=0.41152 
Train Epoch: 37 [193/500 12352/32000 (39%)] Loss: 0.55316 (QuantReg: 13.57465) QuantErr: 13.57465 batch_time=0.53578 
Train Epoch: 37 [201/500 12864/32000 (40%)] Loss: 0.52817 (QuantReg: 13.88156) QuantErr: 13.88156 batch_time=1.62064 
Train Epoch: 37 [209/500 13376/32000 (42%)] Loss: 0.82006 (QuantReg: 13.47731) QuantErr: 13.47731 batch_time=0.39911 
Train Epoch: 37 [217/500 13888/32000 (43%)] Loss: 0.52751 (QuantReg: 13.66343) QuantErr: 13.66343 batch_time=1.58514 
Train Epoch: 37 [225/500 14400/32000 (45%)] Loss: 0.64785 (QuantReg: 13.69070) QuantErr: 13.69070 batch_time=0.39030 
Train Epoch: 37 [233/500 14912/32000 (47%)] Loss: 0.60263 (QuantReg: 13.25620) QuantErr: 13.25620 batch_time=0.43167 
Train Epoch: 37 [241/500 15424/32000 (48%)] Loss: 0.54763 (QuantReg: 13.75073) QuantErr: 13.75073 batch_time=0.42572 
Train Epoch: 37 [249/500 15936/32000 (50%)] Loss: 0.74375 (QuantReg: 13.54710) QuantErr: 13.54710 batch_time=0.41117 
Train Epoch: 37 [257/500 16448/32000 (51%)] Loss: 0.68586 (QuantReg: 13.23991) QuantErr: 13.23991 batch_time=0.52512 
Train Epoch: 37 [265/500 16960/32000 (53%)] Loss: 0.95356 (QuantReg: 13.61666) QuantErr: 13.61666 batch_time=1.60025 
Train Epoch: 37 [273/500 17472/32000 (55%)] Loss: 0.77146 (QuantReg: 13.53813) QuantErr: 13.53813 batch_time=0.39090 
Train Epoch: 37 [281/500 17984/32000 (56%)] Loss: 0.94079 (QuantReg: 13.11088) QuantErr: 13.11088 batch_time=1.49664 
Train Epoch: 37 [289/500 18496/32000 (58%)] Loss: 0.77187 (QuantReg: 13.74932) QuantErr: 13.74932 batch_time=0.39666 
Train Epoch: 37 [297/500 19008/32000 (59%)] Loss: 0.44497 (QuantReg: 13.44836) QuantErr: 13.44836 batch_time=0.50828 
Train Epoch: 37 [305/500 19520/32000 (61%)] Loss: 0.78537 (QuantReg: 13.69148) QuantErr: 13.69148 batch_time=0.46990 
Train Epoch: 37 [313/500 20032/32000 (63%)] Loss: 0.57823 (QuantReg: 13.43153) QuantErr: 13.43153 batch_time=0.40121 
Train Epoch: 37 [321/500 20544/32000 (64%)] Loss: 0.50748 (QuantReg: 13.34602) QuantErr: 13.34602 batch_time=0.52413 
Train Epoch: 37 [329/500 21056/32000 (66%)] Loss: 0.73692 (QuantReg: 13.60939) QuantErr: 13.60939 batch_time=1.63581 
Train Epoch: 37 [337/500 21568/32000 (67%)] Loss: 0.37915 (QuantReg: 13.72297) QuantErr: 13.72297 batch_time=0.39749 
Train Epoch: 37 [345/500 22080/32000 (69%)] Loss: 0.49681 (QuantReg: 12.96886) QuantErr: 12.96886 batch_time=1.51099 
Train Epoch: 37 [353/500 22592/32000 (71%)] Loss: 0.66453 (QuantReg: 13.58831) QuantErr: 13.58831 batch_time=0.40090 
Train Epoch: 37 [361/500 23104/32000 (72%)] Loss: 0.68552 (QuantReg: 13.87205) QuantErr: 13.87205 batch_time=0.40411 
Train Epoch: 37 [369/500 23616/32000 (74%)] Loss: 0.72649 (QuantReg: 13.60632) QuantErr: 13.60632 batch_time=0.40987 
Train Epoch: 37 [377/500 24128/32000 (75%)] Loss: 0.56037 (QuantReg: 13.64075) QuantErr: 13.64075 batch_time=0.40341 
Train Epoch: 37 [385/500 24640/32000 (77%)] Loss: 0.73497 (QuantReg: 13.59383) QuantErr: 13.59383 batch_time=0.51702 
Train Epoch: 37 [393/500 25152/32000 (79%)] Loss: 0.77707 (QuantReg: 13.65077) QuantErr: 13.65077 batch_time=1.64197 
Train Epoch: 37 [401/500 25664/32000 (80%)] Loss: 0.63554 (QuantReg: 13.66353) QuantErr: 13.66353 batch_time=0.40251 
Train Epoch: 37 [409/500 26176/32000 (82%)] Loss: 0.89960 (QuantReg: 13.58064) QuantErr: 13.58064 batch_time=1.46804 
Train Epoch: 37 [417/500 26688/32000 (83%)] Loss: 0.53810 (QuantReg: 13.38182) QuantErr: 13.38182 batch_time=0.42879 
Train Epoch: 37 [425/500 27200/32000 (85%)] Loss: 0.94067 (QuantReg: 13.62790) QuantErr: 13.62790 batch_time=0.40471 
Train Epoch: 37 [433/500 27712/32000 (87%)] Loss: 0.77425 (QuantReg: 13.47879) QuantErr: 13.47879 batch_time=0.40531 
Train Epoch: 37 [441/500 28224/32000 (88%)] Loss: 0.72446 (QuantReg: 13.58378) QuantErr: 13.58378 batch_time=0.40897 
Train Epoch: 37 [449/500 28736/32000 (90%)] Loss: 0.64446 (QuantReg: 13.03805) QuantErr: 13.03805 batch_time=0.54144 
Train Epoch: 37 [457/500 29248/32000 (91%)] Loss: 0.74485 (QuantReg: 13.51825) QuantErr: 13.51825 batch_time=1.58525 
Train Epoch: 37 [465/500 29760/32000 (93%)] Loss: 0.39307 (QuantReg: 13.31852) QuantErr: 13.31852 batch_time=0.39001 
Train Epoch: 37 [473/500 30272/32000 (95%)] Loss: 0.52912 (QuantReg: 13.59758) QuantErr: 13.59758 batch_time=1.70574 
Train Epoch: 37 [481/500 30784/32000 (96%)] Loss: 0.50139 (QuantReg: 13.49365) QuantErr: 13.49365 batch_time=0.38718 
Train Epoch: 37 [489/500 31296/32000 (98%)] Loss: 0.52409 (QuantReg: 13.71811) QuantErr: 13.71811 batch_time=0.48294 
Train Epoch: 37 [497/500 31808/32000 (99%)] Loss: 0.35099 (QuantReg: 13.79118) QuantErr: 13.79118 batch_time=0.41467 
Train Epoch: 37 codebook_update_time=1.83500
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch37.pth ...
Done in 4.282s
removing stale ckpt [epoch 36] [took 0.01s]
 epoch          : 37
 loss           : 0.6604535163640975
 quant_reg      : 13.541179420471192
 quant_err      : 13.541179420471192
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 18500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.645
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.603248035755634
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.759
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.866428525256865
 mnt_best       : 46.3298567973894
 not_improved_count: 1
Train Epoch: 38 [1/500 64/32000 (0%)] Loss: 0.49537 (QuantReg: 14.03479) QuantErr: 14.03479 batch_time=23.15672 
Train Epoch: 38 [9/500 576/32000 (2%)] Loss: 0.34237 (QuantReg: 13.82234) QuantErr: 13.82234 batch_time=0.44614 
Train Epoch: 38 [17/500 1088/32000 (3%)] Loss: 0.76542 (QuantReg: 13.36082) QuantErr: 13.36082 batch_time=0.38764 
Train Epoch: 38 [25/500 1600/32000 (5%)] Loss: 1.11417 (QuantReg: 13.95367) QuantErr: 13.95367 batch_time=1.70381 
Train Epoch: 38 [33/500 2112/32000 (7%)] Loss: 0.75242 (QuantReg: 13.38690) QuantErr: 13.38690 batch_time=0.48889 
Train Epoch: 38 [41/500 2624/32000 (8%)] Loss: 0.35070 (QuantReg: 13.47580) QuantErr: 13.47580 batch_time=0.38637 
Train Epoch: 38 [49/500 3136/32000 (10%)] Loss: 0.34216 (QuantReg: 13.03270) QuantErr: 13.03270 batch_time=0.39687 
Train Epoch: 38 [57/500 3648/32000 (11%)] Loss: 0.56199 (QuantReg: 13.11503) QuantErr: 13.11503 batch_time=0.42389 
Train Epoch: 38 [65/500 4160/32000 (13%)] Loss: 0.48112 (QuantReg: 13.73560) QuantErr: 13.73560 batch_time=0.56138 
Train Epoch: 38 [73/500 4672/32000 (15%)] Loss: 0.58055 (QuantReg: 13.07677) QuantErr: 13.07677 batch_time=0.45969 
Train Epoch: 38 [81/500 5184/32000 (16%)] Loss: 0.44498 (QuantReg: 13.55358) QuantErr: 13.55358 batch_time=0.39047 
Train Epoch: 38 [89/500 5696/32000 (18%)] Loss: 0.76278 (QuantReg: 13.69440) QuantErr: 13.69440 batch_time=1.38536 
Train Epoch: 38 [97/500 6208/32000 (19%)] Loss: 0.64811 (QuantReg: 13.73070) QuantErr: 13.73070 batch_time=0.44558 
Train Epoch: 38 [105/500 6720/32000 (21%)] Loss: 0.46070 (QuantReg: 13.75317) QuantErr: 13.75317 batch_time=0.39938 
Train Epoch: 38 [113/500 7232/32000 (23%)] Loss: 1.00121 (QuantReg: 13.36261) QuantErr: 13.36261 batch_time=0.40343 
Train Epoch: 38 [121/500 7744/32000 (24%)] Loss: 0.75291 (QuantReg: 13.21651) QuantErr: 13.21651 batch_time=0.40292 
Train Epoch: 38 [129/500 8256/32000 (26%)] Loss: 0.42141 (QuantReg: 13.41738) QuantErr: 13.41738 batch_time=0.58366 
Train Epoch: 38 [137/500 8768/32000 (27%)] Loss: 0.47997 (QuantReg: 13.98107) QuantErr: 13.98107 batch_time=0.47863 
Train Epoch: 38 [145/500 9280/32000 (29%)] Loss: 0.59478 (QuantReg: 13.47569) QuantErr: 13.47569 batch_time=0.42868 
Train Epoch: 38 [153/500 9792/32000 (31%)] Loss: 0.61387 (QuantReg: 13.86614) QuantErr: 13.86614 batch_time=1.34996 
Train Epoch: 38 [161/500 10304/32000 (32%)] Loss: 0.92114 (QuantReg: 13.75613) QuantErr: 13.75613 batch_time=0.44921 
Train Epoch: 38 [169/500 10816/32000 (34%)] Loss: 0.51372 (QuantReg: 13.76673) QuantErr: 13.76673 batch_time=0.39945 
Train Epoch: 38 [177/500 11328/32000 (35%)] Loss: 0.66408 (QuantReg: 13.71692) QuantErr: 13.71692 batch_time=0.39966 
Train Epoch: 38 [185/500 11840/32000 (37%)] Loss: 0.61107 (QuantReg: 13.38249) QuantErr: 13.38249 batch_time=0.39604 
Train Epoch: 38 [193/500 12352/32000 (39%)] Loss: 0.58641 (QuantReg: 13.14892) QuantErr: 13.14892 batch_time=0.60035 
Train Epoch: 38 [201/500 12864/32000 (40%)] Loss: 0.47223 (QuantReg: 13.79485) QuantErr: 13.79485 batch_time=0.46444 
Train Epoch: 38 [209/500 13376/32000 (42%)] Loss: 0.81038 (QuantReg: 13.54098) QuantErr: 13.54098 batch_time=0.40428 
Train Epoch: 38 [217/500 13888/32000 (43%)] Loss: 0.82299 (QuantReg: 13.51572) QuantErr: 13.51572 batch_time=1.41669 
Train Epoch: 38 [225/500 14400/32000 (45%)] Loss: 0.87016 (QuantReg: 13.80408) QuantErr: 13.80408 batch_time=0.46863 
Train Epoch: 38 [233/500 14912/32000 (47%)] Loss: 0.70670 (QuantReg: 13.23971) QuantErr: 13.23971 batch_time=0.46404 
Train Epoch: 38 [241/500 15424/32000 (48%)] Loss: 0.42890 (QuantReg: 13.53979) QuantErr: 13.53979 batch_time=0.44721 
Train Epoch: 38 [249/500 15936/32000 (50%)] Loss: 0.83870 (QuantReg: 13.74808) QuantErr: 13.74808 batch_time=0.39770 
Train Epoch: 38 [257/500 16448/32000 (51%)] Loss: 0.67618 (QuantReg: 13.44939) QuantErr: 13.44939 batch_time=0.57498 
Train Epoch: 38 [265/500 16960/32000 (53%)] Loss: 0.45570 (QuantReg: 13.84523) QuantErr: 13.84523 batch_time=0.44656 
Train Epoch: 38 [273/500 17472/32000 (55%)] Loss: 0.40871 (QuantReg: 13.82928) QuantErr: 13.82928 batch_time=0.38718 
Train Epoch: 38 [281/500 17984/32000 (56%)] Loss: 0.67056 (QuantReg: 13.64401) QuantErr: 13.64401 batch_time=1.44725 
Train Epoch: 38 [289/500 18496/32000 (58%)] Loss: 0.42880 (QuantReg: 13.60473) QuantErr: 13.60473 batch_time=0.47127 
Train Epoch: 38 [297/500 19008/32000 (59%)] Loss: 0.70393 (QuantReg: 13.70511) QuantErr: 13.70511 batch_time=0.39654 
Train Epoch: 38 [305/500 19520/32000 (61%)] Loss: 0.44583 (QuantReg: 13.43792) QuantErr: 13.43792 batch_time=0.39160 
Train Epoch: 38 [313/500 20032/32000 (63%)] Loss: 0.79706 (QuantReg: 13.38371) QuantErr: 13.38371 batch_time=0.39317 
Train Epoch: 38 [321/500 20544/32000 (64%)] Loss: 0.75339 (QuantReg: 13.11577) QuantErr: 13.11577 batch_time=0.58944 
Train Epoch: 38 [329/500 21056/32000 (66%)] Loss: 0.36074 (QuantReg: 13.68206) QuantErr: 13.68206 batch_time=0.46057 
Train Epoch: 38 [337/500 21568/32000 (67%)] Loss: 0.60905 (QuantReg: 13.24190) QuantErr: 13.24190 batch_time=0.42209 
Train Epoch: 38 [345/500 22080/32000 (69%)] Loss: 0.58070 (QuantReg: 14.20731) QuantErr: 14.20731 batch_time=1.35794 
Train Epoch: 38 [353/500 22592/32000 (71%)] Loss: 0.39748 (QuantReg: 13.27430) QuantErr: 13.27430 batch_time=0.46079 
Train Epoch: 38 [361/500 23104/32000 (72%)] Loss: 0.79532 (QuantReg: 13.51073) QuantErr: 13.51073 batch_time=0.40296 
Train Epoch: 38 [369/500 23616/32000 (74%)] Loss: 0.69570 (QuantReg: 13.09532) QuantErr: 13.09532 batch_time=0.40264 
Train Epoch: 38 [377/500 24128/32000 (75%)] Loss: 0.75426 (QuantReg: 13.46035) QuantErr: 13.46035 batch_time=0.46017 
Train Epoch: 38 [385/500 24640/32000 (77%)] Loss: 0.39514 (QuantReg: 13.31422) QuantErr: 13.31422 batch_time=0.40551 
Train Epoch: 38 [393/500 25152/32000 (79%)] Loss: 0.82511 (QuantReg: 12.80210) QuantErr: 12.80210 batch_time=0.39538 
Train Epoch: 38 [401/500 25664/32000 (80%)] Loss: 0.61530 (QuantReg: 13.61869) QuantErr: 13.61869 batch_time=0.40078 
Train Epoch: 38 [409/500 26176/32000 (82%)] Loss: 0.72309 (QuantReg: 14.03891) QuantErr: 14.03891 batch_time=1.40900 
Train Epoch: 38 [417/500 26688/32000 (83%)] Loss: 0.55668 (QuantReg: 13.70253) QuantErr: 13.70253 batch_time=0.48046 
Train Epoch: 38 [425/500 27200/32000 (85%)] Loss: 0.57447 (QuantReg: 13.70283) QuantErr: 13.70283 batch_time=0.45078 
Train Epoch: 38 [433/500 27712/32000 (87%)] Loss: 0.51069 (QuantReg: 13.50794) QuantErr: 13.50794 batch_time=0.41582 
Train Epoch: 38 [441/500 28224/32000 (88%)] Loss: 0.45679 (QuantReg: 13.84621) QuantErr: 13.84621 batch_time=0.39045 
Train Epoch: 38 [449/500 28736/32000 (90%)] Loss: 0.58788 (QuantReg: 13.95709) QuantErr: 13.95709 batch_time=0.40515 
Train Epoch: 38 [457/500 29248/32000 (91%)] Loss: 0.58139 (QuantReg: 13.65785) QuantErr: 13.65785 batch_time=0.40006 
Train Epoch: 38 [465/500 29760/32000 (93%)] Loss: 0.40731 (QuantReg: 13.74178) QuantErr: 13.74178 batch_time=0.40314 
Train Epoch: 38 [473/500 30272/32000 (95%)] Loss: 0.51901 (QuantReg: 13.84482) QuantErr: 13.84482 batch_time=1.41713 
Train Epoch: 38 [481/500 30784/32000 (96%)] Loss: 0.70688 (QuantReg: 13.48327) QuantErr: 13.48327 batch_time=0.44816 
Train Epoch: 38 [489/500 31296/32000 (98%)] Loss: 0.56296 (QuantReg: 13.87068) QuantErr: 13.87068 batch_time=0.40376 
Train Epoch: 38 [497/500 31808/32000 (99%)] Loss: 0.70336 (QuantReg: 13.29294) QuantErr: 13.29294 batch_time=0.41656 
Train Epoch: 38 codebook_update_time=1.76875
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch38.pth ...
Done in 4.557s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 38
 loss           : 0.6393292776942253
 quant_reg      : 13.529447532653808
 quant_err      : 13.529447532653808
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 19000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.75
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.18675767869314
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.572
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.318809288657434
 mnt_best       : 46.3298567973894
 not_improved_count: 2
Train Epoch: 39 [1/500 64/32000 (0%)] Loss: 0.46140 (QuantReg: 13.27603) QuantErr: 13.27603 batch_time=25.13517 
Train Epoch: 39 [9/500 576/32000 (2%)] Loss: 0.54470 (QuantReg: 13.14364) QuantErr: 13.14364 batch_time=0.39678 
Train Epoch: 39 [17/500 1088/32000 (3%)] Loss: 0.38486 (QuantReg: 13.70741) QuantErr: 13.70741 batch_time=0.39255 
Train Epoch: 39 [25/500 1600/32000 (5%)] Loss: 0.58921 (QuantReg: 13.73266) QuantErr: 13.73266 batch_time=0.73079 
Train Epoch: 39 [33/500 2112/32000 (7%)] Loss: 1.12393 (QuantReg: 13.56997) QuantErr: 13.56997 batch_time=0.41963 
Train Epoch: 39 [41/500 2624/32000 (8%)] Loss: 0.78117 (QuantReg: 13.33814) QuantErr: 13.33814 batch_time=0.46109 
Train Epoch: 39 [49/500 3136/32000 (10%)] Loss: 0.63542 (QuantReg: 13.69873) QuantErr: 13.69873 batch_time=0.82633 
Train Epoch: 39 [57/500 3648/32000 (11%)] Loss: 0.56093 (QuantReg: 13.66015) QuantErr: 13.66015 batch_time=0.40309 
Train Epoch: 39 [65/500 4160/32000 (13%)] Loss: 0.63104 (QuantReg: 13.72154) QuantErr: 13.72154 batch_time=0.56491 
Train Epoch: 39 [73/500 4672/32000 (15%)] Loss: 0.68790 (QuantReg: 13.66102) QuantErr: 13.66102 batch_time=0.41853 
Train Epoch: 39 [81/500 5184/32000 (16%)] Loss: 0.81227 (QuantReg: 13.20848) QuantErr: 13.20848 batch_time=0.40348 
Train Epoch: 39 [89/500 5696/32000 (18%)] Loss: 0.78076 (QuantReg: 13.49192) QuantErr: 13.49192 batch_time=0.72335 
Train Epoch: 39 [97/500 6208/32000 (19%)] Loss: 0.52540 (QuantReg: 13.46619) QuantErr: 13.46619 batch_time=0.40330 
Train Epoch: 39 [105/500 6720/32000 (21%)] Loss: 0.71587 (QuantReg: 13.61849) QuantErr: 13.61849 batch_time=0.47136 
Train Epoch: 39 [113/500 7232/32000 (23%)] Loss: 0.76227 (QuantReg: 13.56063) QuantErr: 13.56063 batch_time=0.78841 
Train Epoch: 39 [121/500 7744/32000 (24%)] Loss: 0.63557 (QuantReg: 12.94870) QuantErr: 12.94870 batch_time=0.39737 
Train Epoch: 39 [129/500 8256/32000 (26%)] Loss: 1.15030 (QuantReg: 13.10369) QuantErr: 13.10369 batch_time=0.59292 
Train Epoch: 39 [137/500 8768/32000 (27%)] Loss: 0.46084 (QuantReg: 13.53142) QuantErr: 13.53142 batch_time=0.39344 
Train Epoch: 39 [145/500 9280/32000 (29%)] Loss: 0.82088 (QuantReg: 13.75132) QuantErr: 13.75132 batch_time=0.39773 
Train Epoch: 39 [153/500 9792/32000 (31%)] Loss: 0.60015 (QuantReg: 13.62271) QuantErr: 13.62271 batch_time=0.72461 
Train Epoch: 39 [161/500 10304/32000 (32%)] Loss: 0.67900 (QuantReg: 13.51196) QuantErr: 13.51196 batch_time=0.38981 
Train Epoch: 39 [169/500 10816/32000 (34%)] Loss: 0.43081 (QuantReg: 13.70832) QuantErr: 13.70832 batch_time=0.45022 
Train Epoch: 39 [177/500 11328/32000 (35%)] Loss: 0.44104 (QuantReg: 13.57438) QuantErr: 13.57438 batch_time=0.76079 
Train Epoch: 39 [185/500 11840/32000 (37%)] Loss: 0.63093 (QuantReg: 13.59955) QuantErr: 13.59955 batch_time=0.43646 
Train Epoch: 39 [193/500 12352/32000 (39%)] Loss: 0.65335 (QuantReg: 13.74487) QuantErr: 13.74487 batch_time=0.67523 
Train Epoch: 39 [201/500 12864/32000 (40%)] Loss: 0.80188 (QuantReg: 12.55304) QuantErr: 12.55304 batch_time=0.40367 
Train Epoch: 39 [209/500 13376/32000 (42%)] Loss: 0.80262 (QuantReg: 13.27691) QuantErr: 13.27691 batch_time=0.38991 
Train Epoch: 39 [217/500 13888/32000 (43%)] Loss: 0.60621 (QuantReg: 13.34150) QuantErr: 13.34150 batch_time=0.67550 
Train Epoch: 39 [225/500 14400/32000 (45%)] Loss: 0.69534 (QuantReg: 13.07756) QuantErr: 13.07756 batch_time=0.41244 
Train Epoch: 39 [233/500 14912/32000 (47%)] Loss: 0.46098 (QuantReg: 13.65355) QuantErr: 13.65355 batch_time=0.45325 
Train Epoch: 39 [241/500 15424/32000 (48%)] Loss: 0.68544 (QuantReg: 14.26432) QuantErr: 14.26432 batch_time=1.06066 
Train Epoch: 39 [249/500 15936/32000 (50%)] Loss: 0.75713 (QuantReg: 13.59885) QuantErr: 13.59885 batch_time=0.44391 
Train Epoch: 39 [257/500 16448/32000 (51%)] Loss: 0.62255 (QuantReg: 13.54843) QuantErr: 13.54843 batch_time=0.61214 
Train Epoch: 39 [265/500 16960/32000 (53%)] Loss: 1.17304 (QuantReg: 13.02024) QuantErr: 13.02024 batch_time=0.43072 
Train Epoch: 39 [273/500 17472/32000 (55%)] Loss: 0.76967 (QuantReg: 13.23333) QuantErr: 13.23333 batch_time=0.39783 
Train Epoch: 39 [281/500 17984/32000 (56%)] Loss: 0.54615 (QuantReg: 13.83014) QuantErr: 13.83014 batch_time=0.77404 
Train Epoch: 39 [289/500 18496/32000 (58%)] Loss: 0.57525 (QuantReg: 13.69725) QuantErr: 13.69725 batch_time=0.40028 
Train Epoch: 39 [297/500 19008/32000 (59%)] Loss: 0.68048 (QuantReg: 13.31716) QuantErr: 13.31716 batch_time=0.45297 
Train Epoch: 39 [305/500 19520/32000 (61%)] Loss: 0.36828 (QuantReg: 13.56340) QuantErr: 13.56340 batch_time=0.77354 
Train Epoch: 39 [313/500 20032/32000 (63%)] Loss: 0.71422 (QuantReg: 13.85343) QuantErr: 13.85343 batch_time=0.41244 
Train Epoch: 39 [321/500 20544/32000 (64%)] Loss: 0.46465 (QuantReg: 13.69606) QuantErr: 13.69606 batch_time=0.64366 
Train Epoch: 39 [329/500 21056/32000 (66%)] Loss: 0.92838 (QuantReg: 13.33684) QuantErr: 13.33684 batch_time=0.41407 
Train Epoch: 39 [337/500 21568/32000 (67%)] Loss: 0.55122 (QuantReg: 13.73539) QuantErr: 13.73539 batch_time=0.42118 
Train Epoch: 39 [345/500 22080/32000 (69%)] Loss: 0.44501 (QuantReg: 13.56835) QuantErr: 13.56835 batch_time=0.79792 
Train Epoch: 39 [353/500 22592/32000 (71%)] Loss: 0.53559 (QuantReg: 13.56547) QuantErr: 13.56547 batch_time=0.39328 
Train Epoch: 39 [361/500 23104/32000 (72%)] Loss: 0.86564 (QuantReg: 13.45315) QuantErr: 13.45315 batch_time=0.44343 
Train Epoch: 39 [369/500 23616/32000 (74%)] Loss: 0.98442 (QuantReg: 13.20635) QuantErr: 13.20635 batch_time=0.78324 
Train Epoch: 39 [377/500 24128/32000 (75%)] Loss: 0.67204 (QuantReg: 13.26664) QuantErr: 13.26664 batch_time=0.40711 
Train Epoch: 39 [385/500 24640/32000 (77%)] Loss: 0.63172 (QuantReg: 13.73347) QuantErr: 13.73347 batch_time=1.04898 
Train Epoch: 39 [393/500 25152/32000 (79%)] Loss: 0.74827 (QuantReg: 13.51715) QuantErr: 13.51715 batch_time=0.40546 
Train Epoch: 39 [401/500 25664/32000 (80%)] Loss: 0.85812 (QuantReg: 13.68457) QuantErr: 13.68457 batch_time=0.43759 
Train Epoch: 39 [409/500 26176/32000 (82%)] Loss: 0.43937 (QuantReg: 14.06512) QuantErr: 14.06512 batch_time=0.72982 
Train Epoch: 39 [417/500 26688/32000 (83%)] Loss: 0.52970 (QuantReg: 13.97427) QuantErr: 13.97427 batch_time=0.46149 
Train Epoch: 39 [425/500 27200/32000 (85%)] Loss: 0.74360 (QuantReg: 13.85135) QuantErr: 13.85135 batch_time=0.49312 
Train Epoch: 39 [433/500 27712/32000 (87%)] Loss: 0.63718 (QuantReg: 13.73145) QuantErr: 13.73145 batch_time=0.81237 
Train Epoch: 39 [441/500 28224/32000 (88%)] Loss: 0.57775 (QuantReg: 13.83702) QuantErr: 13.83702 batch_time=0.40166 
Train Epoch: 39 [449/500 28736/32000 (90%)] Loss: 0.67033 (QuantReg: 13.88591) QuantErr: 13.88591 batch_time=0.54895 
Train Epoch: 39 [457/500 29248/32000 (91%)] Loss: 0.60978 (QuantReg: 13.61464) QuantErr: 13.61464 batch_time=0.40028 
Train Epoch: 39 [465/500 29760/32000 (93%)] Loss: 0.57257 (QuantReg: 13.70923) QuantErr: 13.70923 batch_time=0.39295 
Train Epoch: 39 [473/500 30272/32000 (95%)] Loss: 1.01780 (QuantReg: 13.93128) QuantErr: 13.93128 batch_time=0.68700 
Train Epoch: 39 [481/500 30784/32000 (96%)] Loss: 0.67453 (QuantReg: 13.76627) QuantErr: 13.76627 batch_time=0.39634 
Train Epoch: 39 [489/500 31296/32000 (98%)] Loss: 0.56010 (QuantReg: 13.78841) QuantErr: 13.78841 batch_time=0.45917 
Train Epoch: 39 [497/500 31808/32000 (99%)] Loss: 0.53236 (QuantReg: 13.67677) QuantErr: 13.67677 batch_time=0.71868 
Train Epoch: 39 codebook_update_time=2.01713
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch39.pth ...
Done in 4.935s
removing stale ckpt [epoch 38] [took 0.01s]
 epoch          : 39
 loss           : 0.643677232503891
 quant_reg      : 13.5622237739563
 quant_err      : 13.5622237739563
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 19500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.482
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.527894178588134
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3195
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.44810489876981
 mnt_best       : 46.3298567973894
 not_improved_count: 3
Train Epoch: 40 [1/500 64/32000 (0%)] Loss: 0.75391 (QuantReg: 13.36360) QuantErr: 13.36360 batch_time=23.21917 
Train Epoch: 40 [9/500 576/32000 (2%)] Loss: 0.54643 (QuantReg: 13.86055) QuantErr: 13.86055 batch_time=0.40570 
Train Epoch: 40 [17/500 1088/32000 (3%)] Loss: 0.48269 (QuantReg: 13.36031) QuantErr: 13.36031 batch_time=0.40672 
Train Epoch: 40 [25/500 1600/32000 (5%)] Loss: 0.54959 (QuantReg: 13.45904) QuantErr: 13.45904 batch_time=0.40116 
Train Epoch: 40 [33/500 2112/32000 (7%)] Loss: 0.72067 (QuantReg: 13.52958) QuantErr: 13.52958 batch_time=0.39739 
Train Epoch: 40 [41/500 2624/32000 (8%)] Loss: 0.67728 (QuantReg: 12.91192) QuantErr: 12.91192 batch_time=1.86823 
Train Epoch: 40 [49/500 3136/32000 (10%)] Loss: 0.98993 (QuantReg: 13.14011) QuantErr: 13.14011 batch_time=0.66152 
Train Epoch: 40 [57/500 3648/32000 (11%)] Loss: 0.46215 (QuantReg: 13.65560) QuantErr: 13.65560 batch_time=0.40893 
Train Epoch: 40 [65/500 4160/32000 (13%)] Loss: 0.48824 (QuantReg: 13.31355) QuantErr: 13.31355 batch_time=0.97573 
Train Epoch: 40 [73/500 4672/32000 (15%)] Loss: 0.36648 (QuantReg: 13.33440) QuantErr: 13.33440 batch_time=0.40091 
Train Epoch: 40 [81/500 5184/32000 (16%)] Loss: 0.49011 (QuantReg: 13.49687) QuantErr: 13.49687 batch_time=0.40855 
Train Epoch: 40 [89/500 5696/32000 (18%)] Loss: 0.72191 (QuantReg: 13.38100) QuantErr: 13.38100 batch_time=0.40471 
Train Epoch: 40 [97/500 6208/32000 (19%)] Loss: 0.55968 (QuantReg: 13.60203) QuantErr: 13.60203 batch_time=0.39948 
Train Epoch: 40 [105/500 6720/32000 (21%)] Loss: 0.58759 (QuantReg: 13.62368) QuantErr: 13.62368 batch_time=1.79254 
Train Epoch: 40 [113/500 7232/32000 (23%)] Loss: 0.73292 (QuantReg: 13.45131) QuantErr: 13.45131 batch_time=0.39385 
Train Epoch: 40 [121/500 7744/32000 (24%)] Loss: 0.74343 (QuantReg: 13.88143) QuantErr: 13.88143 batch_time=0.40451 
Train Epoch: 40 [129/500 8256/32000 (26%)] Loss: 0.64776 (QuantReg: 13.69209) QuantErr: 13.69209 batch_time=1.01153 
Train Epoch: 40 [137/500 8768/32000 (27%)] Loss: 0.79470 (QuantReg: 13.45657) QuantErr: 13.45657 batch_time=0.41882 
Train Epoch: 40 [145/500 9280/32000 (29%)] Loss: 0.60492 (QuantReg: 12.94104) QuantErr: 12.94104 batch_time=0.39284 
Train Epoch: 40 [153/500 9792/32000 (31%)] Loss: 0.75225 (QuantReg: 13.58688) QuantErr: 13.58688 batch_time=0.39775 
Train Epoch: 40 [161/500 10304/32000 (32%)] Loss: 0.82394 (QuantReg: 13.42719) QuantErr: 13.42719 batch_time=0.39445 
Train Epoch: 40 [169/500 10816/32000 (34%)] Loss: 0.52201 (QuantReg: 13.38637) QuantErr: 13.38637 batch_time=1.82659 
Train Epoch: 40 [177/500 11328/32000 (35%)] Loss: 0.93023 (QuantReg: 13.58554) QuantErr: 13.58554 batch_time=0.39684 
Train Epoch: 40 [185/500 11840/32000 (37%)] Loss: 0.89566 (QuantReg: 13.83958) QuantErr: 13.83958 batch_time=0.39726 
Train Epoch: 40 [193/500 12352/32000 (39%)] Loss: 0.66826 (QuantReg: 13.22929) QuantErr: 13.22929 batch_time=1.00516 
Train Epoch: 40 [201/500 12864/32000 (40%)] Loss: 0.77036 (QuantReg: 13.41922) QuantErr: 13.41922 batch_time=0.42351 
Train Epoch: 40 [209/500 13376/32000 (42%)] Loss: 0.86653 (QuantReg: 13.29785) QuantErr: 13.29785 batch_time=0.38805 
Train Epoch: 40 [217/500 13888/32000 (43%)] Loss: 0.84471 (QuantReg: 13.89456) QuantErr: 13.89456 batch_time=0.38979 
Train Epoch: 40 [225/500 14400/32000 (45%)] Loss: 0.67875 (QuantReg: 13.32080) QuantErr: 13.32080 batch_time=0.46594 
Train Epoch: 40 [233/500 14912/32000 (47%)] Loss: 1.00377 (QuantReg: 13.14943) QuantErr: 13.14943 batch_time=1.82755 
Train Epoch: 40 [241/500 15424/32000 (48%)] Loss: 0.87674 (QuantReg: 12.98360) QuantErr: 12.98360 batch_time=0.39744 
Train Epoch: 40 [249/500 15936/32000 (50%)] Loss: 0.50636 (QuantReg: 13.80864) QuantErr: 13.80864 batch_time=0.39829 
Train Epoch: 40 [257/500 16448/32000 (51%)] Loss: 0.66226 (QuantReg: 13.70942) QuantErr: 13.70942 batch_time=1.07667 
Train Epoch: 40 [265/500 16960/32000 (53%)] Loss: 0.49627 (QuantReg: 13.49248) QuantErr: 13.49248 batch_time=0.39008 
Train Epoch: 40 [273/500 17472/32000 (55%)] Loss: 0.90313 (QuantReg: 13.48129) QuantErr: 13.48129 batch_time=0.45906 
Train Epoch: 40 [281/500 17984/32000 (56%)] Loss: 0.39789 (QuantReg: 13.89775) QuantErr: 13.89775 batch_time=0.39793 
Train Epoch: 40 [289/500 18496/32000 (58%)] Loss: 0.72148 (QuantReg: 13.25788) QuantErr: 13.25788 batch_time=0.38991 
Train Epoch: 40 [297/500 19008/32000 (59%)] Loss: 0.53437 (QuantReg: 13.66309) QuantErr: 13.66309 batch_time=1.88170 
Train Epoch: 40 [305/500 19520/32000 (61%)] Loss: 0.43949 (QuantReg: 13.26391) QuantErr: 13.26391 batch_time=0.67631 
Train Epoch: 40 [313/500 20032/32000 (63%)] Loss: 0.43451 (QuantReg: 13.61105) QuantErr: 13.61105 batch_time=0.39603 
Train Epoch: 40 [321/500 20544/32000 (64%)] Loss: 0.55601 (QuantReg: 13.59272) QuantErr: 13.59272 batch_time=1.11637 
Train Epoch: 40 [329/500 21056/32000 (66%)] Loss: 0.53899 (QuantReg: 13.64183) QuantErr: 13.64183 batch_time=0.38951 
Train Epoch: 40 [337/500 21568/32000 (67%)] Loss: 0.84970 (QuantReg: 13.89080) QuantErr: 13.89080 batch_time=0.43088 
Train Epoch: 40 [345/500 22080/32000 (69%)] Loss: 0.64446 (QuantReg: 13.18120) QuantErr: 13.18120 batch_time=0.41187 
Train Epoch: 40 [353/500 22592/32000 (71%)] Loss: 0.43473 (QuantReg: 13.54513) QuantErr: 13.54513 batch_time=0.40103 
Train Epoch: 40 [361/500 23104/32000 (72%)] Loss: 0.37885 (QuantReg: 13.13467) QuantErr: 13.13467 batch_time=1.75936 
Train Epoch: 40 [369/500 23616/32000 (74%)] Loss: 0.55994 (QuantReg: 13.75936) QuantErr: 13.75936 batch_time=0.47468 
Train Epoch: 40 [377/500 24128/32000 (75%)] Loss: 0.51131 (QuantReg: 13.75051) QuantErr: 13.75051 batch_time=0.47417 
Train Epoch: 40 [385/500 24640/32000 (77%)] Loss: 0.63164 (QuantReg: 13.59019) QuantErr: 13.59019 batch_time=1.01160 
Train Epoch: 40 [393/500 25152/32000 (79%)] Loss: 0.32751 (QuantReg: 13.66223) QuantErr: 13.66223 batch_time=0.40195 
Train Epoch: 40 [401/500 25664/32000 (80%)] Loss: 0.47528 (QuantReg: 13.35953) QuantErr: 13.35953 batch_time=0.39547 
Train Epoch: 40 [409/500 26176/32000 (82%)] Loss: 0.75862 (QuantReg: 13.50398) QuantErr: 13.50398 batch_time=0.40931 
Train Epoch: 40 [417/500 26688/32000 (83%)] Loss: 0.76032 (QuantReg: 13.72225) QuantErr: 13.72225 batch_time=0.40251 
Train Epoch: 40 [425/500 27200/32000 (85%)] Loss: 0.71296 (QuantReg: 13.03307) QuantErr: 13.03307 batch_time=1.80168 
Train Epoch: 40 [433/500 27712/32000 (87%)] Loss: 0.72420 (QuantReg: 13.27229) QuantErr: 13.27229 batch_time=0.43322 
Train Epoch: 40 [441/500 28224/32000 (88%)] Loss: 0.77453 (QuantReg: 13.44932) QuantErr: 13.44932 batch_time=0.41322 
Train Epoch: 40 [449/500 28736/32000 (90%)] Loss: 0.60873 (QuantReg: 13.66368) QuantErr: 13.66368 batch_time=1.01803 
Train Epoch: 40 [457/500 29248/32000 (91%)] Loss: 0.42193 (QuantReg: 13.44237) QuantErr: 13.44237 batch_time=0.39251 
Train Epoch: 40 [465/500 29760/32000 (93%)] Loss: 0.71032 (QuantReg: 14.04807) QuantErr: 14.04807 batch_time=0.42188 
Train Epoch: 40 [473/500 30272/32000 (95%)] Loss: 0.83951 (QuantReg: 13.50469) QuantErr: 13.50469 batch_time=0.39006 
Train Epoch: 40 [481/500 30784/32000 (96%)] Loss: 0.79440 (QuantReg: 13.62511) QuantErr: 13.62511 batch_time=0.51896 
Train Epoch: 40 [489/500 31296/32000 (98%)] Loss: 0.40151 (QuantReg: 13.71019) QuantErr: 13.71019 batch_time=1.80564 
Train Epoch: 40 [497/500 31808/32000 (99%)] Loss: 0.69201 (QuantReg: 13.38468) QuantErr: 13.38468 batch_time=0.46397 
Train Epoch: 40 codebook_update_time=1.86855
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch40.pth ...
Done in 5.488s
removing stale ckpt [epoch 39] [took 0.08s]
 epoch          : 40
 loss           : 0.6476808144450188
 quant_reg      : 13.547266527175903
 quant_err      : 13.547266527175903
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 20000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.86
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.203205453097134
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.511
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.48049962778205
 mnt_best       : 46.3298567973894
 not_improved_count: 4
Train Epoch: 41 [1/500 64/32000 (0%)] Loss: 0.65686 (QuantReg: 13.61405) QuantErr: 13.61405 batch_time=18.76169 
Train Epoch: 41 [9/500 576/32000 (2%)] Loss: 0.82992 (QuantReg: 13.39082) QuantErr: 13.39082 batch_time=0.39799 
Train Epoch: 41 [17/500 1088/32000 (3%)] Loss: 0.67026 (QuantReg: 13.03726) QuantErr: 13.03726 batch_time=0.43198 
Train Epoch: 41 [25/500 1600/32000 (5%)] Loss: 0.94135 (QuantReg: 13.56374) QuantErr: 13.56374 batch_time=0.43209 
Train Epoch: 41 [33/500 2112/32000 (7%)] Loss: 0.57310 (QuantReg: 13.98957) QuantErr: 13.98957 batch_time=0.39171 
Train Epoch: 41 [41/500 2624/32000 (8%)] Loss: 0.72763 (QuantReg: 13.28425) QuantErr: 13.28425 batch_time=0.40960 
Train Epoch: 41 [49/500 3136/32000 (10%)] Loss: 0.68976 (QuantReg: 13.79218) QuantErr: 13.79218 batch_time=0.44523 
Train Epoch: 41 [57/500 3648/32000 (11%)] Loss: 0.65858 (QuantReg: 14.20673) QuantErr: 14.20673 batch_time=0.39608 
Train Epoch: 41 [65/500 4160/32000 (13%)] Loss: 0.44955 (QuantReg: 14.02415) QuantErr: 14.02415 batch_time=0.38795 
Train Epoch: 41 [73/500 4672/32000 (15%)] Loss: 0.49454 (QuantReg: 13.42732) QuantErr: 13.42732 batch_time=0.40182 
Train Epoch: 41 [81/500 5184/32000 (16%)] Loss: 0.36824 (QuantReg: 13.70485) QuantErr: 13.70485 batch_time=0.40439 
Train Epoch: 41 [89/500 5696/32000 (18%)] Loss: 0.86534 (QuantReg: 13.66509) QuantErr: 13.66509 batch_time=0.38869 
Train Epoch: 41 [97/500 6208/32000 (19%)] Loss: 0.65837 (QuantReg: 13.56332) QuantErr: 13.56332 batch_time=0.40518 
Train Epoch: 41 [105/500 6720/32000 (21%)] Loss: 0.49029 (QuantReg: 13.66812) QuantErr: 13.66812 batch_time=0.39840 
Train Epoch: 41 [113/500 7232/32000 (23%)] Loss: 0.53416 (QuantReg: 13.56571) QuantErr: 13.56571 batch_time=0.38997 
Train Epoch: 41 [121/500 7744/32000 (24%)] Loss: 0.74506 (QuantReg: 13.64990) QuantErr: 13.64990 batch_time=0.39182 
Train Epoch: 41 [129/500 8256/32000 (26%)] Loss: 0.68808 (QuantReg: 13.29537) QuantErr: 13.29537 batch_time=0.42786 
Train Epoch: 41 [137/500 8768/32000 (27%)] Loss: 0.44438 (QuantReg: 13.33897) QuantErr: 13.33897 batch_time=0.39004 
Train Epoch: 41 [145/500 9280/32000 (29%)] Loss: 0.55165 (QuantReg: 13.68185) QuantErr: 13.68185 batch_time=0.40477 
Train Epoch: 41 [153/500 9792/32000 (31%)] Loss: 0.64882 (QuantReg: 13.58074) QuantErr: 13.58074 batch_time=0.43358 
Train Epoch: 41 [161/500 10304/32000 (32%)] Loss: 0.65608 (QuantReg: 14.08094) QuantErr: 14.08094 batch_time=0.43856 
Train Epoch: 41 [169/500 10816/32000 (34%)] Loss: 0.54715 (QuantReg: 13.60369) QuantErr: 13.60369 batch_time=0.44068 
Train Epoch: 41 [177/500 11328/32000 (35%)] Loss: 0.62196 (QuantReg: 13.61845) QuantErr: 13.61845 batch_time=0.42088 
Train Epoch: 41 [185/500 11840/32000 (37%)] Loss: 0.82502 (QuantReg: 13.75497) QuantErr: 13.75497 batch_time=0.55055 
Train Epoch: 41 [193/500 12352/32000 (39%)] Loss: 0.36135 (QuantReg: 13.29959) QuantErr: 13.29959 batch_time=0.41532 
Train Epoch: 41 [201/500 12864/32000 (40%)] Loss: 0.62821 (QuantReg: 13.60452) QuantErr: 13.60452 batch_time=0.39876 
Train Epoch: 41 [209/500 13376/32000 (42%)] Loss: 0.68017 (QuantReg: 13.41302) QuantErr: 13.41302 batch_time=0.40813 
Train Epoch: 41 [217/500 13888/32000 (43%)] Loss: 0.73088 (QuantReg: 13.57488) QuantErr: 13.57488 batch_time=0.44325 
Train Epoch: 41 [225/500 14400/32000 (45%)] Loss: 0.58347 (QuantReg: 13.22672) QuantErr: 13.22672 batch_time=0.39928 
Train Epoch: 41 [233/500 14912/32000 (47%)] Loss: 0.86634 (QuantReg: 13.89270) QuantErr: 13.89270 batch_time=0.38705 
Train Epoch: 41 [241/500 15424/32000 (48%)] Loss: 0.71631 (QuantReg: 13.35526) QuantErr: 13.35526 batch_time=0.40065 
Train Epoch: 41 [249/500 15936/32000 (50%)] Loss: 0.35266 (QuantReg: 14.08862) QuantErr: 14.08862 batch_time=0.46696 
Train Epoch: 41 [257/500 16448/32000 (51%)] Loss: 0.68762 (QuantReg: 13.78961) QuantErr: 13.78961 batch_time=0.43133 
Train Epoch: 41 [265/500 16960/32000 (53%)] Loss: 0.98048 (QuantReg: 13.38034) QuantErr: 13.38034 batch_time=0.42366 
Train Epoch: 41 [273/500 17472/32000 (55%)] Loss: 0.73386 (QuantReg: 13.66530) QuantErr: 13.66530 batch_time=0.40310 
Train Epoch: 41 [281/500 17984/32000 (56%)] Loss: 0.58205 (QuantReg: 13.25599) QuantErr: 13.25599 batch_time=0.41107 
Train Epoch: 41 [289/500 18496/32000 (58%)] Loss: 0.66019 (QuantReg: 13.52574) QuantErr: 13.52574 batch_time=0.39846 
Train Epoch: 41 [297/500 19008/32000 (59%)] Loss: 0.39564 (QuantReg: 13.45058) QuantErr: 13.45058 batch_time=0.39955 
Train Epoch: 41 [305/500 19520/32000 (61%)] Loss: 0.61476 (QuantReg: 13.71291) QuantErr: 13.71291 batch_time=0.40497 
Train Epoch: 41 [313/500 20032/32000 (63%)] Loss: 0.53675 (QuantReg: 13.38778) QuantErr: 13.38778 batch_time=0.41321 
Train Epoch: 41 [321/500 20544/32000 (64%)] Loss: 0.44037 (QuantReg: 13.89355) QuantErr: 13.89355 batch_time=0.39348 
Train Epoch: 41 [329/500 21056/32000 (66%)] Loss: 0.66933 (QuantReg: 13.74388) QuantErr: 13.74388 batch_time=0.40563 
Train Epoch: 41 [337/500 21568/32000 (67%)] Loss: 0.48869 (QuantReg: 13.94048) QuantErr: 13.94048 batch_time=0.40433 
Train Epoch: 41 [345/500 22080/32000 (69%)] Loss: 0.55887 (QuantReg: 13.78790) QuantErr: 13.78790 batch_time=0.40859 
Train Epoch: 41 [353/500 22592/32000 (71%)] Loss: 0.66140 (QuantReg: 13.49610) QuantErr: 13.49610 batch_time=0.39326 
Train Epoch: 41 [361/500 23104/32000 (72%)] Loss: 0.71897 (QuantReg: 13.48220) QuantErr: 13.48220 batch_time=0.39351 
Train Epoch: 41 [369/500 23616/32000 (74%)] Loss: 0.88033 (QuantReg: 13.24776) QuantErr: 13.24776 batch_time=0.40020 
Train Epoch: 41 [377/500 24128/32000 (75%)] Loss: 0.66804 (QuantReg: 13.36279) QuantErr: 13.36279 batch_time=0.43148 
Train Epoch: 41 [385/500 24640/32000 (77%)] Loss: 0.68020 (QuantReg: 13.54260) QuantErr: 13.54260 batch_time=0.40383 
Train Epoch: 41 [393/500 25152/32000 (79%)] Loss: 0.59000 (QuantReg: 13.84576) QuantErr: 13.84576 batch_time=0.39755 
Train Epoch: 41 [401/500 25664/32000 (80%)] Loss: 0.46713 (QuantReg: 13.90280) QuantErr: 13.90280 batch_time=0.40508 
Train Epoch: 41 [409/500 26176/32000 (82%)] Loss: 0.80637 (QuantReg: 13.31571) QuantErr: 13.31571 batch_time=0.39640 
Train Epoch: 41 [417/500 26688/32000 (83%)] Loss: 0.73947 (QuantReg: 13.46906) QuantErr: 13.46906 batch_time=0.40258 
Train Epoch: 41 [425/500 27200/32000 (85%)] Loss: 0.86261 (QuantReg: 13.57170) QuantErr: 13.57170 batch_time=0.43822 
Train Epoch: 41 [433/500 27712/32000 (87%)] Loss: 0.56530 (QuantReg: 13.78147) QuantErr: 13.78147 batch_time=0.40060 
Train Epoch: 41 [441/500 28224/32000 (88%)] Loss: 0.75638 (QuantReg: 13.27537) QuantErr: 13.27537 batch_time=0.39402 
Train Epoch: 41 [449/500 28736/32000 (90%)] Loss: 0.65081 (QuantReg: 13.56178) QuantErr: 13.56178 batch_time=0.41913 
Train Epoch: 41 [457/500 29248/32000 (91%)] Loss: 0.58126 (QuantReg: 13.33928) QuantErr: 13.33928 batch_time=0.46312 
Train Epoch: 41 [465/500 29760/32000 (93%)] Loss: 0.48712 (QuantReg: 14.08548) QuantErr: 14.08548 batch_time=0.44924 
Train Epoch: 41 [473/500 30272/32000 (95%)] Loss: 0.53771 (QuantReg: 13.40335) QuantErr: 13.40335 batch_time=0.38783 
Train Epoch: 41 [481/500 30784/32000 (96%)] Loss: 0.42531 (QuantReg: 13.68599) QuantErr: 13.68599 batch_time=0.45800 
Train Epoch: 41 [489/500 31296/32000 (98%)] Loss: 0.51267 (QuantReg: 13.81817) QuantErr: 13.81817 batch_time=0.40192 
Train Epoch: 41 [497/500 31808/32000 (99%)] Loss: 0.59149 (QuantReg: 13.47468) QuantErr: 13.47468 batch_time=0.44988 
Train Epoch: 41 codebook_update_time=1.74218
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch41.pth ...
Done in 5.317s
removing stale ckpt [epoch 40] [took 0.02s]
 epoch          : 41
 loss           : 0.6392821261584759
 quant_reg      : 13.579623071670532
 quant_err      : 13.579623071670532
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 20500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.176
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.67901332619162
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3865
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.08923442539437
 mnt_best       : 46.3298567973894
 not_improved_count: 5
Train Epoch: 42 [1/500 64/32000 (0%)] Loss: 0.57718 (QuantReg: 13.63030) QuantErr: 13.63030 batch_time=18.65335 
Train Epoch: 42 [9/500 576/32000 (2%)] Loss: 0.69717 (QuantReg: 13.69624) QuantErr: 13.69624 batch_time=0.49547 
Train Epoch: 42 [17/500 1088/32000 (3%)] Loss: 0.45833 (QuantReg: 13.76277) QuantErr: 13.76277 batch_time=0.40447 
Train Epoch: 42 [25/500 1600/32000 (5%)] Loss: 0.49897 (QuantReg: 13.66872) QuantErr: 13.66872 batch_time=0.39179 
Train Epoch: 42 [33/500 2112/32000 (7%)] Loss: 0.52346 (QuantReg: 13.88215) QuantErr: 13.88215 batch_time=0.40000 
Train Epoch: 42 [41/500 2624/32000 (8%)] Loss: 0.50599 (QuantReg: 13.78798) QuantErr: 13.78798 batch_time=0.46736 
Train Epoch: 42 [49/500 3136/32000 (10%)] Loss: 0.69510 (QuantReg: 13.77780) QuantErr: 13.77780 batch_time=0.43754 
Train Epoch: 42 [57/500 3648/32000 (11%)] Loss: 0.73205 (QuantReg: 13.34182) QuantErr: 13.34182 batch_time=0.39971 
Train Epoch: 42 [65/500 4160/32000 (13%)] Loss: 0.50302 (QuantReg: 13.82730) QuantErr: 13.82730 batch_time=0.45440 
Train Epoch: 42 [73/500 4672/32000 (15%)] Loss: 0.60331 (QuantReg: 13.81085) QuantErr: 13.81085 batch_time=0.45388 
Train Epoch: 42 [81/500 5184/32000 (16%)] Loss: 0.71066 (QuantReg: 13.36378) QuantErr: 13.36378 batch_time=0.42020 
Train Epoch: 42 [89/500 5696/32000 (18%)] Loss: 1.01306 (QuantReg: 12.82224) QuantErr: 12.82224 batch_time=0.40028 
Train Epoch: 42 [97/500 6208/32000 (19%)] Loss: 0.58356 (QuantReg: 13.18954) QuantErr: 13.18954 batch_time=0.40213 
Train Epoch: 42 [105/500 6720/32000 (21%)] Loss: 0.51596 (QuantReg: 13.56539) QuantErr: 13.56539 batch_time=0.40702 
Train Epoch: 42 [113/500 7232/32000 (23%)] Loss: 0.94774 (QuantReg: 13.03349) QuantErr: 13.03349 batch_time=0.41601 
Train Epoch: 42 [121/500 7744/32000 (24%)] Loss: 0.58243 (QuantReg: 13.64190) QuantErr: 13.64190 batch_time=0.40046 
Train Epoch: 42 [129/500 8256/32000 (26%)] Loss: 0.55831 (QuantReg: 13.41221) QuantErr: 13.41221 batch_time=0.75812 
Train Epoch: 42 [137/500 8768/32000 (27%)] Loss: 0.82684 (QuantReg: 13.53769) QuantErr: 13.53769 batch_time=0.43878 
Train Epoch: 42 [145/500 9280/32000 (29%)] Loss: 0.24642 (QuantReg: 13.65574) QuantErr: 13.65574 batch_time=0.39111 
Train Epoch: 42 [153/500 9792/32000 (31%)] Loss: 0.69669 (QuantReg: 13.31615) QuantErr: 13.31615 batch_time=0.40601 
Train Epoch: 42 [161/500 10304/32000 (32%)] Loss: 0.48219 (QuantReg: 13.55028) QuantErr: 13.55028 batch_time=0.47445 
Train Epoch: 42 [169/500 10816/32000 (34%)] Loss: 0.45238 (QuantReg: 13.79079) QuantErr: 13.79079 batch_time=0.39706 
Train Epoch: 42 [177/500 11328/32000 (35%)] Loss: 0.45807 (QuantReg: 13.51327) QuantErr: 13.51327 batch_time=0.41071 
Train Epoch: 42 [185/500 11840/32000 (37%)] Loss: 0.68321 (QuantReg: 13.37891) QuantErr: 13.37891 batch_time=0.39646 
Train Epoch: 42 [193/500 12352/32000 (39%)] Loss: 0.62072 (QuantReg: 13.69957) QuantErr: 13.69957 batch_time=0.46348 
Train Epoch: 42 [201/500 12864/32000 (40%)] Loss: 0.60238 (QuantReg: 13.04513) QuantErr: 13.04513 batch_time=0.41761 
Train Epoch: 42 [209/500 13376/32000 (42%)] Loss: 0.41752 (QuantReg: 13.38754) QuantErr: 13.38754 batch_time=0.48625 
Train Epoch: 42 [217/500 13888/32000 (43%)] Loss: 0.66194 (QuantReg: 13.12108) QuantErr: 13.12108 batch_time=0.42336 
Train Epoch: 42 [225/500 14400/32000 (45%)] Loss: 0.45328 (QuantReg: 14.11911) QuantErr: 14.11911 batch_time=0.84246 
Train Epoch: 42 [233/500 14912/32000 (47%)] Loss: 0.41464 (QuantReg: 13.41196) QuantErr: 13.41196 batch_time=0.39983 
Train Epoch: 42 [241/500 15424/32000 (48%)] Loss: 0.70482 (QuantReg: 13.59760) QuantErr: 13.59760 batch_time=0.39249 
Train Epoch: 42 [249/500 15936/32000 (50%)] Loss: 0.69823 (QuantReg: 13.76383) QuantErr: 13.76383 batch_time=0.39595 
Train Epoch: 42 [257/500 16448/32000 (51%)] Loss: 0.77819 (QuantReg: 12.83063) QuantErr: 12.83063 batch_time=0.46187 
Train Epoch: 42 [265/500 16960/32000 (53%)] Loss: 0.57972 (QuantReg: 13.52766) QuantErr: 13.52766 batch_time=0.39264 
Train Epoch: 42 [273/500 17472/32000 (55%)] Loss: 0.50040 (QuantReg: 13.45858) QuantErr: 13.45858 batch_time=0.40619 
Train Epoch: 42 [281/500 17984/32000 (56%)] Loss: 0.37821 (QuantReg: 13.80060) QuantErr: 13.80060 batch_time=0.41894 
Train Epoch: 42 [289/500 18496/32000 (58%)] Loss: 0.48575 (QuantReg: 13.70505) QuantErr: 13.70505 batch_time=0.40937 
Train Epoch: 42 [297/500 19008/32000 (59%)] Loss: 0.42067 (QuantReg: 13.82801) QuantErr: 13.82801 batch_time=0.39458 
Train Epoch: 42 [305/500 19520/32000 (61%)] Loss: 0.62373 (QuantReg: 13.70829) QuantErr: 13.70829 batch_time=0.44344 
Train Epoch: 42 [313/500 20032/32000 (63%)] Loss: 0.66946 (QuantReg: 13.95893) QuantErr: 13.95893 batch_time=0.42650 
Train Epoch: 42 [321/500 20544/32000 (64%)] Loss: 0.47156 (QuantReg: 13.65981) QuantErr: 13.65981 batch_time=0.46401 
Train Epoch: 42 [329/500 21056/32000 (66%)] Loss: 0.52626 (QuantReg: 13.76922) QuantErr: 13.76922 batch_time=0.44377 
Train Epoch: 42 [337/500 21568/32000 (67%)] Loss: 0.67156 (QuantReg: 13.60250) QuantErr: 13.60250 batch_time=0.41038 
Train Epoch: 42 [345/500 22080/32000 (69%)] Loss: 1.23877 (QuantReg: 13.56582) QuantErr: 13.56582 batch_time=0.40251 
Train Epoch: 42 [353/500 22592/32000 (71%)] Loss: 0.55445 (QuantReg: 13.72496) QuantErr: 13.72496 batch_time=0.40949 
Train Epoch: 42 [361/500 23104/32000 (72%)] Loss: 0.41708 (QuantReg: 13.33735) QuantErr: 13.33735 batch_time=0.40448 
Train Epoch: 42 [369/500 23616/32000 (74%)] Loss: 0.64399 (QuantReg: 13.58650) QuantErr: 13.58650 batch_time=0.38794 
Train Epoch: 42 [377/500 24128/32000 (75%)] Loss: 0.21239 (QuantReg: 13.65716) QuantErr: 13.65716 batch_time=0.39178 
Train Epoch: 42 [385/500 24640/32000 (77%)] Loss: 0.46122 (QuantReg: 13.54930) QuantErr: 13.54930 batch_time=0.44821 
Train Epoch: 42 [393/500 25152/32000 (79%)] Loss: 0.35373 (QuantReg: 14.03254) QuantErr: 14.03254 batch_time=0.39236 
Train Epoch: 42 [401/500 25664/32000 (80%)] Loss: 0.52104 (QuantReg: 13.83966) QuantErr: 13.83966 batch_time=0.45144 
Train Epoch: 42 [409/500 26176/32000 (82%)] Loss: 0.38651 (QuantReg: 13.50525) QuantErr: 13.50525 batch_time=0.40999 
Train Epoch: 42 [417/500 26688/32000 (83%)] Loss: 0.55878 (QuantReg: 13.55165) QuantErr: 13.55165 batch_time=0.40831 
Train Epoch: 42 [425/500 27200/32000 (85%)] Loss: 0.78700 (QuantReg: 13.12086) QuantErr: 13.12086 batch_time=0.39597 
Train Epoch: 42 [433/500 27712/32000 (87%)] Loss: 0.60111 (QuantReg: 13.49129) QuantErr: 13.49129 batch_time=0.39741 
Train Epoch: 42 [441/500 28224/32000 (88%)] Loss: 0.53519 (QuantReg: 13.73154) QuantErr: 13.73154 batch_time=0.40970 
Train Epoch: 42 [449/500 28736/32000 (90%)] Loss: 0.31846 (QuantReg: 13.69615) QuantErr: 13.69615 batch_time=0.46640 
Train Epoch: 42 [457/500 29248/32000 (91%)] Loss: 0.61595 (QuantReg: 13.52150) QuantErr: 13.52150 batch_time=0.40040 
Train Epoch: 42 [465/500 29760/32000 (93%)] Loss: 0.53969 (QuantReg: 13.85064) QuantErr: 13.85064 batch_time=0.39960 
Train Epoch: 42 [473/500 30272/32000 (95%)] Loss: 0.72474 (QuantReg: 13.33125) QuantErr: 13.33125 batch_time=0.41651 
Train Epoch: 42 [481/500 30784/32000 (96%)] Loss: 0.75698 (QuantReg: 13.75752) QuantErr: 13.75752 batch_time=0.39991 
Train Epoch: 42 [489/500 31296/32000 (98%)] Loss: 0.39034 (QuantReg: 13.60215) QuantErr: 13.60215 batch_time=0.39840 
Train Epoch: 42 [497/500 31808/32000 (99%)] Loss: 0.48399 (QuantReg: 13.97940) QuantErr: 13.97940 batch_time=0.39040 
Train Epoch: 42 codebook_update_time=1.82955
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch42.pth ...
Done in 5.854s
removing stale ckpt [epoch 41] [took 0.04s]
 epoch          : 42
 loss           : 0.6316273933053017
 quant_reg      : 13.606213773727417
 quant_err      : 13.606213773727417
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 21000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.778
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.04990865392377
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.015
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.749724420959346
 mnt_best       : 46.3298567973894
 not_improved_count: 6
Train Epoch: 43 [1/500 64/32000 (0%)] Loss: 0.64238 (QuantReg: 13.66349) QuantErr: 13.66349 batch_time=18.19849 
Train Epoch: 43 [9/500 576/32000 (2%)] Loss: 0.66741 (QuantReg: 13.66827) QuantErr: 13.66827 batch_time=0.38898 
Train Epoch: 43 [17/500 1088/32000 (3%)] Loss: 0.92291 (QuantReg: 13.49860) QuantErr: 13.49860 batch_time=0.38740 
Train Epoch: 43 [25/500 1600/32000 (5%)] Loss: 0.68350 (QuantReg: 13.31942) QuantErr: 13.31942 batch_time=0.38448 
Train Epoch: 43 [33/500 2112/32000 (7%)] Loss: 0.58964 (QuantReg: 13.49560) QuantErr: 13.49560 batch_time=0.41511 
Train Epoch: 43 [41/500 2624/32000 (8%)] Loss: 0.49471 (QuantReg: 13.93078) QuantErr: 13.93078 batch_time=0.43347 
Train Epoch: 43 [49/500 3136/32000 (10%)] Loss: 0.52774 (QuantReg: 13.35731) QuantErr: 13.35731 batch_time=0.42923 
Train Epoch: 43 [57/500 3648/32000 (11%)] Loss: 0.89135 (QuantReg: 13.44034) QuantErr: 13.44034 batch_time=0.43821 
Train Epoch: 43 [65/500 4160/32000 (13%)] Loss: 0.48256 (QuantReg: 13.67822) QuantErr: 13.67822 batch_time=0.44895 
Train Epoch: 43 [73/500 4672/32000 (15%)] Loss: 0.63059 (QuantReg: 13.64334) QuantErr: 13.64334 batch_time=0.39791 
Train Epoch: 43 [81/500 5184/32000 (16%)] Loss: 0.25098 (QuantReg: 13.85714) QuantErr: 13.85714 batch_time=0.39336 
Train Epoch: 43 [89/500 5696/32000 (18%)] Loss: 0.51072 (QuantReg: 13.87614) QuantErr: 13.87614 batch_time=0.43005 
Train Epoch: 43 [97/500 6208/32000 (19%)] Loss: 0.62422 (QuantReg: 13.75572) QuantErr: 13.75572 batch_time=0.49674 
Train Epoch: 43 [105/500 6720/32000 (21%)] Loss: 0.65960 (QuantReg: 13.67607) QuantErr: 13.67607 batch_time=0.40227 
Train Epoch: 43 [113/500 7232/32000 (23%)] Loss: 0.42124 (QuantReg: 13.38923) QuantErr: 13.38923 batch_time=0.39868 
Train Epoch: 43 [121/500 7744/32000 (24%)] Loss: 0.41519 (QuantReg: 13.60038) QuantErr: 13.60038 batch_time=0.40339 
Train Epoch: 43 [129/500 8256/32000 (26%)] Loss: 0.65156 (QuantReg: 14.13669) QuantErr: 14.13669 batch_time=0.39594 
Train Epoch: 43 [137/500 8768/32000 (27%)] Loss: 0.66125 (QuantReg: 13.50582) QuantErr: 13.50582 batch_time=0.39848 
Train Epoch: 43 [145/500 9280/32000 (29%)] Loss: 0.65416 (QuantReg: 13.49054) QuantErr: 13.49054 batch_time=0.40135 
Train Epoch: 43 [153/500 9792/32000 (31%)] Loss: 0.59476 (QuantReg: 13.41690) QuantErr: 13.41690 batch_time=0.39556 
Train Epoch: 43 [161/500 10304/32000 (32%)] Loss: 0.66642 (QuantReg: 13.35801) QuantErr: 13.35801 batch_time=0.40897 
Train Epoch: 43 [169/500 10816/32000 (34%)] Loss: 0.63998 (QuantReg: 13.79676) QuantErr: 13.79676 batch_time=0.41334 
Train Epoch: 43 [177/500 11328/32000 (35%)] Loss: 0.70204 (QuantReg: 13.63930) QuantErr: 13.63930 batch_time=0.40223 
Train Epoch: 43 [185/500 11840/32000 (37%)] Loss: 0.70709 (QuantReg: 13.79187) QuantErr: 13.79187 batch_time=0.55886 
Train Epoch: 43 [193/500 12352/32000 (39%)] Loss: 0.70891 (QuantReg: 13.41403) QuantErr: 13.41403 batch_time=0.45229 
Train Epoch: 43 [201/500 12864/32000 (40%)] Loss: 0.83257 (QuantReg: 13.58768) QuantErr: 13.58768 batch_time=0.39417 
Train Epoch: 43 [209/500 13376/32000 (42%)] Loss: 0.55605 (QuantReg: 13.21039) QuantErr: 13.21039 batch_time=0.39859 
Train Epoch: 43 [217/500 13888/32000 (43%)] Loss: 0.58228 (QuantReg: 13.34745) QuantErr: 13.34745 batch_time=0.41893 
Train Epoch: 43 [225/500 14400/32000 (45%)] Loss: 0.44691 (QuantReg: 13.49424) QuantErr: 13.49424 batch_time=0.39187 
Train Epoch: 43 [233/500 14912/32000 (47%)] Loss: 0.37388 (QuantReg: 14.21833) QuantErr: 14.21833 batch_time=0.40920 
Train Epoch: 43 [241/500 15424/32000 (48%)] Loss: 0.50765 (QuantReg: 13.89013) QuantErr: 13.89013 batch_time=0.38937 
Train Epoch: 43 [249/500 15936/32000 (50%)] Loss: 0.68018 (QuantReg: 13.12243) QuantErr: 13.12243 batch_time=0.39449 
Train Epoch: 43 [257/500 16448/32000 (51%)] Loss: 0.76150 (QuantReg: 13.51221) QuantErr: 13.51221 batch_time=0.39095 
Train Epoch: 43 [265/500 16960/32000 (53%)] Loss: 0.55359 (QuantReg: 13.35457) QuantErr: 13.35457 batch_time=0.39578 
Train Epoch: 43 [273/500 17472/32000 (55%)] Loss: 0.67248 (QuantReg: 13.98056) QuantErr: 13.98056 batch_time=0.39776 
Train Epoch: 43 [281/500 17984/32000 (56%)] Loss: 0.98733 (QuantReg: 13.82157) QuantErr: 13.82157 batch_time=0.40090 
Train Epoch: 43 [289/500 18496/32000 (58%)] Loss: 0.78510 (QuantReg: 13.48902) QuantErr: 13.48902 batch_time=0.39962 
Train Epoch: 43 [297/500 19008/32000 (59%)] Loss: 0.58233 (QuantReg: 14.06230) QuantErr: 14.06230 batch_time=0.40826 
Train Epoch: 43 [305/500 19520/32000 (61%)] Loss: 0.50131 (QuantReg: 13.58790) QuantErr: 13.58790 batch_time=0.39972 
Train Epoch: 43 [313/500 20032/32000 (63%)] Loss: 0.46038 (QuantReg: 13.67717) QuantErr: 13.67717 batch_time=0.39778 
Train Epoch: 43 [321/500 20544/32000 (64%)] Loss: 0.62964 (QuantReg: 13.48304) QuantErr: 13.48304 batch_time=0.38748 
Train Epoch: 43 [329/500 21056/32000 (66%)] Loss: 0.57473 (QuantReg: 13.45923) QuantErr: 13.45923 batch_time=0.39316 
Train Epoch: 43 [337/500 21568/32000 (67%)] Loss: 0.68075 (QuantReg: 13.85411) QuantErr: 13.85411 batch_time=0.47264 
Train Epoch: 43 [345/500 22080/32000 (69%)] Loss: 0.59477 (QuantReg: 13.59510) QuantErr: 13.59510 batch_time=0.40194 
Train Epoch: 43 [353/500 22592/32000 (71%)] Loss: 0.90879 (QuantReg: 13.41279) QuantErr: 13.41279 batch_time=0.46516 
Train Epoch: 43 [361/500 23104/32000 (72%)] Loss: 0.74896 (QuantReg: 13.45990) QuantErr: 13.45990 batch_time=0.40387 
Train Epoch: 43 [369/500 23616/32000 (74%)] Loss: 0.55815 (QuantReg: 13.85057) QuantErr: 13.85057 batch_time=0.39646 
Train Epoch: 43 [377/500 24128/32000 (75%)] Loss: 0.33235 (QuantReg: 14.02462) QuantErr: 14.02462 batch_time=0.39030 
Train Epoch: 43 [385/500 24640/32000 (77%)] Loss: 0.56455 (QuantReg: 13.53717) QuantErr: 13.53717 batch_time=0.58376 
Train Epoch: 43 [393/500 25152/32000 (79%)] Loss: 0.79364 (QuantReg: 13.78308) QuantErr: 13.78308 batch_time=0.42008 
Train Epoch: 43 [401/500 25664/32000 (80%)] Loss: 0.69038 (QuantReg: 13.37134) QuantErr: 13.37134 batch_time=0.39707 
Train Epoch: 43 [409/500 26176/32000 (82%)] Loss: 0.65233 (QuantReg: 13.76937) QuantErr: 13.76937 batch_time=0.39784 
Train Epoch: 43 [417/500 26688/32000 (83%)] Loss: 0.55614 (QuantReg: 13.87394) QuantErr: 13.87394 batch_time=0.40142 
Train Epoch: 43 [425/500 27200/32000 (85%)] Loss: 0.61105 (QuantReg: 13.79115) QuantErr: 13.79115 batch_time=0.39568 
Train Epoch: 43 [433/500 27712/32000 (87%)] Loss: 0.54780 (QuantReg: 13.53166) QuantErr: 13.53166 batch_time=0.42603 
Train Epoch: 43 [441/500 28224/32000 (88%)] Loss: 0.57848 (QuantReg: 13.67214) QuantErr: 13.67214 batch_time=0.39488 
Train Epoch: 43 [449/500 28736/32000 (90%)] Loss: 0.48838 (QuantReg: 13.63361) QuantErr: 13.63361 batch_time=0.39502 
Train Epoch: 43 [457/500 29248/32000 (91%)] Loss: 0.82205 (QuantReg: 13.53489) QuantErr: 13.53489 batch_time=0.45071 
Train Epoch: 43 [465/500 29760/32000 (93%)] Loss: 0.95496 (QuantReg: 13.62089) QuantErr: 13.62089 batch_time=0.39674 
Train Epoch: 43 [473/500 30272/32000 (95%)] Loss: 0.53118 (QuantReg: 13.31332) QuantErr: 13.31332 batch_time=0.42008 
Train Epoch: 43 [481/500 30784/32000 (96%)] Loss: 0.79922 (QuantReg: 13.30246) QuantErr: 13.30246 batch_time=0.40011 
Train Epoch: 43 [489/500 31296/32000 (98%)] Loss: 0.60043 (QuantReg: 14.03170) QuantErr: 14.03170 batch_time=0.40708 
Train Epoch: 43 [497/500 31808/32000 (99%)] Loss: 0.61799 (QuantReg: 13.84354) QuantErr: 13.84354 batch_time=0.38764 
Train Epoch: 43 codebook_update_time=1.74858
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch43.pth ...
Done in 4.542s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 0.6294829027652741
 quant_reg      : 13.634374769210815
 quant_err      : 13.634374769210815
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 21500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.373
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.40764020409056
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3345
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.475343308378555
 mnt_best       : 46.3298567973894
 not_improved_count: 7
Train Epoch: 44 [1/500 64/32000 (0%)] Loss: 0.64156 (QuantReg: 13.40327) QuantErr: 13.40327 batch_time=25.21873 
Train Epoch: 44 [9/500 576/32000 (2%)] Loss: 0.77803 (QuantReg: 13.90746) QuantErr: 13.90746 batch_time=0.40598 
Train Epoch: 44 [17/500 1088/32000 (3%)] Loss: 0.80501 (QuantReg: 13.65753) QuantErr: 13.65753 batch_time=0.39323 
Train Epoch: 44 [25/500 1600/32000 (5%)] Loss: 0.86973 (QuantReg: 13.66752) QuantErr: 13.66752 batch_time=0.38751 
Train Epoch: 44 [33/500 2112/32000 (7%)] Loss: 0.42523 (QuantReg: 13.92301) QuantErr: 13.92301 batch_time=0.38861 
Train Epoch: 44 [41/500 2624/32000 (8%)] Loss: 0.36862 (QuantReg: 13.49749) QuantErr: 13.49749 batch_time=0.39970 
Train Epoch: 44 [49/500 3136/32000 (10%)] Loss: 0.40151 (QuantReg: 13.35760) QuantErr: 13.35760 batch_time=0.39720 
Train Epoch: 44 [57/500 3648/32000 (11%)] Loss: 0.75516 (QuantReg: 13.98635) QuantErr: 13.98635 batch_time=0.40588 
Train Epoch: 44 [65/500 4160/32000 (13%)] Loss: 0.64155 (QuantReg: 13.43896) QuantErr: 13.43896 batch_time=2.46938 
Train Epoch: 44 [73/500 4672/32000 (15%)] Loss: 0.79746 (QuantReg: 13.67691) QuantErr: 13.67691 batch_time=0.43878 
Train Epoch: 44 [81/500 5184/32000 (16%)] Loss: 0.55102 (QuantReg: 13.37595) QuantErr: 13.37595 batch_time=0.43552 
Train Epoch: 44 [89/500 5696/32000 (18%)] Loss: 0.36123 (QuantReg: 13.99043) QuantErr: 13.99043 batch_time=0.44748 
Train Epoch: 44 [97/500 6208/32000 (19%)] Loss: 0.70395 (QuantReg: 13.95287) QuantErr: 13.95287 batch_time=0.41028 
Train Epoch: 44 [105/500 6720/32000 (21%)] Loss: 0.59663 (QuantReg: 13.62705) QuantErr: 13.62705 batch_time=0.40112 
Train Epoch: 44 [113/500 7232/32000 (23%)] Loss: 0.67557 (QuantReg: 13.69879) QuantErr: 13.69879 batch_time=0.39355 
Train Epoch: 44 [121/500 7744/32000 (24%)] Loss: 0.51151 (QuantReg: 13.62957) QuantErr: 13.62957 batch_time=0.40413 
Train Epoch: 44 [129/500 8256/32000 (26%)] Loss: 0.62011 (QuantReg: 13.36554) QuantErr: 13.36554 batch_time=2.61744 
Train Epoch: 44 [137/500 8768/32000 (27%)] Loss: 0.51449 (QuantReg: 13.77584) QuantErr: 13.77584 batch_time=0.54424 
Train Epoch: 44 [145/500 9280/32000 (29%)] Loss: 0.44233 (QuantReg: 13.92879) QuantErr: 13.92879 batch_time=0.40849 
Train Epoch: 44 [153/500 9792/32000 (31%)] Loss: 0.61649 (QuantReg: 13.56687) QuantErr: 13.56687 batch_time=0.39617 
Train Epoch: 44 [161/500 10304/32000 (32%)] Loss: 0.56666 (QuantReg: 14.01542) QuantErr: 14.01542 batch_time=0.41283 
Train Epoch: 44 [169/500 10816/32000 (34%)] Loss: 0.48673 (QuantReg: 13.42524) QuantErr: 13.42524 batch_time=0.39081 
Train Epoch: 44 [177/500 11328/32000 (35%)] Loss: 0.45292 (QuantReg: 14.06180) QuantErr: 14.06180 batch_time=0.42111 
Train Epoch: 44 [185/500 11840/32000 (37%)] Loss: 0.72268 (QuantReg: 13.67042) QuantErr: 13.67042 batch_time=0.40028 
Train Epoch: 44 [193/500 12352/32000 (39%)] Loss: 0.46495 (QuantReg: 13.75361) QuantErr: 13.75361 batch_time=0.39613 
Train Epoch: 44 [201/500 12864/32000 (40%)] Loss: 0.83267 (QuantReg: 13.54862) QuantErr: 13.54862 batch_time=0.39671 
Train Epoch: 44 [209/500 13376/32000 (42%)] Loss: 0.72085 (QuantReg: 13.79388) QuantErr: 13.79388 batch_time=0.41204 
Train Epoch: 44 [217/500 13888/32000 (43%)] Loss: 0.57089 (QuantReg: 13.71913) QuantErr: 13.71913 batch_time=0.39038 
Train Epoch: 44 [225/500 14400/32000 (45%)] Loss: 0.55832 (QuantReg: 13.23672) QuantErr: 13.23672 batch_time=0.40002 
Train Epoch: 44 [233/500 14912/32000 (47%)] Loss: 0.63258 (QuantReg: 13.72491) QuantErr: 13.72491 batch_time=0.42592 
Train Epoch: 44 [241/500 15424/32000 (48%)] Loss: 0.53542 (QuantReg: 13.79620) QuantErr: 13.79620 batch_time=0.40790 
Train Epoch: 44 [249/500 15936/32000 (50%)] Loss: 0.76611 (QuantReg: 13.33161) QuantErr: 13.33161 batch_time=0.40543 
Train Epoch: 44 [257/500 16448/32000 (51%)] Loss: 0.47063 (QuantReg: 13.83259) QuantErr: 13.83259 batch_time=0.40205 
Train Epoch: 44 [265/500 16960/32000 (53%)] Loss: 0.57305 (QuantReg: 13.64017) QuantErr: 13.64017 batch_time=0.41756 
Train Epoch: 44 [273/500 17472/32000 (55%)] Loss: 0.93231 (QuantReg: 13.54883) QuantErr: 13.54883 batch_time=0.39048 
Train Epoch: 44 [281/500 17984/32000 (56%)] Loss: 0.81301 (QuantReg: 13.50697) QuantErr: 13.50697 batch_time=0.38941 
Train Epoch: 44 [289/500 18496/32000 (58%)] Loss: 0.59995 (QuantReg: 13.51044) QuantErr: 13.51044 batch_time=0.40084 
Train Epoch: 44 [297/500 19008/32000 (59%)] Loss: 0.64253 (QuantReg: 13.95543) QuantErr: 13.95543 batch_time=0.38903 
Train Epoch: 44 [305/500 19520/32000 (61%)] Loss: 0.68227 (QuantReg: 13.35961) QuantErr: 13.35961 batch_time=0.40454 
Train Epoch: 44 [313/500 20032/32000 (63%)] Loss: 0.41571 (QuantReg: 13.64584) QuantErr: 13.64584 batch_time=0.40248 
Train Epoch: 44 [321/500 20544/32000 (64%)] Loss: 0.58768 (QuantReg: 13.40666) QuantErr: 13.40666 batch_time=0.40736 
Train Epoch: 44 [329/500 21056/32000 (66%)] Loss: 0.65546 (QuantReg: 13.56799) QuantErr: 13.56799 batch_time=0.40496 
Train Epoch: 44 [337/500 21568/32000 (67%)] Loss: 0.49796 (QuantReg: 13.77199) QuantErr: 13.77199 batch_time=0.38908 
Train Epoch: 44 [345/500 22080/32000 (69%)] Loss: 0.58027 (QuantReg: 13.23582) QuantErr: 13.23582 batch_time=0.40736 
Train Epoch: 44 [353/500 22592/32000 (71%)] Loss: 0.60620 (QuantReg: 13.38726) QuantErr: 13.38726 batch_time=0.37958 
Train Epoch: 44 [361/500 23104/32000 (72%)] Loss: 0.50528 (QuantReg: 13.67244) QuantErr: 13.67244 batch_time=0.42854 
Train Epoch: 44 [369/500 23616/32000 (74%)] Loss: 0.96289 (QuantReg: 13.43992) QuantErr: 13.43992 batch_time=0.41759 
Train Epoch: 44 [377/500 24128/32000 (75%)] Loss: 0.70437 (QuantReg: 13.74705) QuantErr: 13.74705 batch_time=0.39776 
Train Epoch: 44 [385/500 24640/32000 (77%)] Loss: 0.85487 (QuantReg: 13.80814) QuantErr: 13.80814 batch_time=0.41141 
Train Epoch: 44 [393/500 25152/32000 (79%)] Loss: 0.70282 (QuantReg: 13.63684) QuantErr: 13.63684 batch_time=0.47683 
Train Epoch: 44 [401/500 25664/32000 (80%)] Loss: 0.51356 (QuantReg: 13.48098) QuantErr: 13.48098 batch_time=0.38339 
Train Epoch: 44 [409/500 26176/32000 (82%)] Loss: 0.52510 (QuantReg: 13.83879) QuantErr: 13.83879 batch_time=0.38593 
Train Epoch: 44 [417/500 26688/32000 (83%)] Loss: 0.62694 (QuantReg: 13.78609) QuantErr: 13.78609 batch_time=0.40113 
Train Epoch: 44 [425/500 27200/32000 (85%)] Loss: 0.71355 (QuantReg: 13.52391) QuantErr: 13.52391 batch_time=0.40200 
Train Epoch: 44 [433/500 27712/32000 (87%)] Loss: 0.46416 (QuantReg: 13.36755) QuantErr: 13.36755 batch_time=0.40631 
Train Epoch: 44 [441/500 28224/32000 (88%)] Loss: 0.93177 (QuantReg: 13.61320) QuantErr: 13.61320 batch_time=0.40211 
Train Epoch: 44 [449/500 28736/32000 (90%)] Loss: 0.42404 (QuantReg: 13.53419) QuantErr: 13.53419 batch_time=0.41467 
Train Epoch: 44 [457/500 29248/32000 (91%)] Loss: 0.44161 (QuantReg: 13.92855) QuantErr: 13.92855 batch_time=0.45230 
Train Epoch: 44 [465/500 29760/32000 (93%)] Loss: 0.74331 (QuantReg: 12.73751) QuantErr: 12.73751 batch_time=0.39134 
Train Epoch: 44 [473/500 30272/32000 (95%)] Loss: 0.56090 (QuantReg: 13.91411) QuantErr: 13.91411 batch_time=0.39233 
Train Epoch: 44 [481/500 30784/32000 (96%)] Loss: 0.90526 (QuantReg: 13.66934) QuantErr: 13.66934 batch_time=0.40993 
Train Epoch: 44 [489/500 31296/32000 (98%)] Loss: 0.50451 (QuantReg: 13.89610) QuantErr: 13.89610 batch_time=0.41265 
Train Epoch: 44 [497/500 31808/32000 (99%)] Loss: 0.72892 (QuantReg: 13.67260) QuantErr: 13.67260 batch_time=0.41958 
Train Epoch: 44 codebook_update_time=1.72234
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch44.pth ...
Done in 4.470s
removing stale ckpt [epoch 43] [took 0.07s]
 epoch          : 44
 loss           : 0.6214324070215225
 quant_reg      : 13.652122701644897
 quant_err      : 13.652122701644897
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 22000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.016
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.68621682921419
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.197
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.5619477285366
 mnt_best       : 46.3298567973894
 not_improved_count: 8
Train Epoch: 45 [1/500 64/32000 (0%)] Loss: 0.73443 (QuantReg: 13.54971) QuantErr: 13.54971 batch_time=20.92016 
Train Epoch: 45 [9/500 576/32000 (2%)] Loss: 0.38969 (QuantReg: 13.54652) QuantErr: 13.54652 batch_time=0.40653 
Train Epoch: 45 [17/500 1088/32000 (3%)] Loss: 0.76498 (QuantReg: 13.84864) QuantErr: 13.84864 batch_time=0.40738 
Train Epoch: 45 [25/500 1600/32000 (5%)] Loss: 0.75940 (QuantReg: 13.45268) QuantErr: 13.45268 batch_time=0.42628 
Train Epoch: 45 [33/500 2112/32000 (7%)] Loss: 0.54973 (QuantReg: 13.33893) QuantErr: 13.33893 batch_time=0.41239 
Train Epoch: 45 [41/500 2624/32000 (8%)] Loss: 0.55723 (QuantReg: 13.95517) QuantErr: 13.95517 batch_time=0.38475 
Train Epoch: 45 [49/500 3136/32000 (10%)] Loss: 0.70713 (QuantReg: 13.46365) QuantErr: 13.46365 batch_time=0.38902 
Train Epoch: 45 [57/500 3648/32000 (11%)] Loss: 0.60408 (QuantReg: 13.65817) QuantErr: 13.65817 batch_time=0.38969 
Train Epoch: 45 [65/500 4160/32000 (13%)] Loss: 0.43750 (QuantReg: 13.40442) QuantErr: 13.40442 batch_time=0.40218 
Train Epoch: 45 [73/500 4672/32000 (15%)] Loss: 0.58239 (QuantReg: 13.61856) QuantErr: 13.61856 batch_time=0.45586 
Train Epoch: 45 [81/500 5184/32000 (16%)] Loss: 0.45616 (QuantReg: 13.87635) QuantErr: 13.87635 batch_time=0.41598 
Train Epoch: 45 [89/500 5696/32000 (18%)] Loss: 0.97384 (QuantReg: 13.85170) QuantErr: 13.85170 batch_time=0.41816 
Train Epoch: 45 [97/500 6208/32000 (19%)] Loss: 0.47494 (QuantReg: 13.71744) QuantErr: 13.71744 batch_time=0.43237 
Train Epoch: 45 [105/500 6720/32000 (21%)] Loss: 0.23699 (QuantReg: 13.81905) QuantErr: 13.81905 batch_time=0.39998 
Train Epoch: 45 [113/500 7232/32000 (23%)] Loss: 0.61344 (QuantReg: 13.53759) QuantErr: 13.53759 batch_time=0.39959 
Train Epoch: 45 [121/500 7744/32000 (24%)] Loss: 0.87735 (QuantReg: 13.66917) QuantErr: 13.66917 batch_time=0.40056 
Train Epoch: 45 [129/500 8256/32000 (26%)] Loss: 0.68730 (QuantReg: 13.44505) QuantErr: 13.44505 batch_time=0.40131 
Train Epoch: 45 [137/500 8768/32000 (27%)] Loss: 0.49101 (QuantReg: 13.73649) QuantErr: 13.73649 batch_time=0.44364 
Train Epoch: 45 [145/500 9280/32000 (29%)] Loss: 0.43207 (QuantReg: 13.54717) QuantErr: 13.54717 batch_time=0.39407 
Train Epoch: 45 [153/500 9792/32000 (31%)] Loss: 0.68436 (QuantReg: 13.41861) QuantErr: 13.41861 batch_time=0.40047 
Train Epoch: 45 [161/500 10304/32000 (32%)] Loss: 0.64914 (QuantReg: 13.63995) QuantErr: 13.63995 batch_time=0.39652 
Train Epoch: 45 [169/500 10816/32000 (34%)] Loss: 0.74411 (QuantReg: 13.45442) QuantErr: 13.45442 batch_time=0.39898 
Train Epoch: 45 [177/500 11328/32000 (35%)] Loss: 0.77332 (QuantReg: 13.23620) QuantErr: 13.23620 batch_time=0.39697 
Train Epoch: 45 [185/500 11840/32000 (37%)] Loss: 0.68790 (QuantReg: 13.62376) QuantErr: 13.62376 batch_time=0.42562 
Train Epoch: 45 [193/500 12352/32000 (39%)] Loss: 0.39440 (QuantReg: 14.13075) QuantErr: 14.13075 batch_time=0.41582 
Train Epoch: 45 [201/500 12864/32000 (40%)] Loss: 0.69841 (QuantReg: 13.37537) QuantErr: 13.37537 batch_time=0.39672 
Train Epoch: 45 [209/500 13376/32000 (42%)] Loss: 0.67657 (QuantReg: 13.66690) QuantErr: 13.66690 batch_time=0.40256 
Train Epoch: 45 [217/500 13888/32000 (43%)] Loss: 0.74775 (QuantReg: 13.57985) QuantErr: 13.57985 batch_time=0.40499 
Train Epoch: 45 [225/500 14400/32000 (45%)] Loss: 0.41232 (QuantReg: 13.58717) QuantErr: 13.58717 batch_time=0.40370 
Train Epoch: 45 [233/500 14912/32000 (47%)] Loss: 0.93780 (QuantReg: 13.66817) QuantErr: 13.66817 batch_time=0.39457 
Train Epoch: 45 [241/500 15424/32000 (48%)] Loss: 0.52645 (QuantReg: 13.29565) QuantErr: 13.29565 batch_time=0.42115 
Train Epoch: 45 [249/500 15936/32000 (50%)] Loss: 0.84172 (QuantReg: 13.91404) QuantErr: 13.91404 batch_time=0.40086 
Train Epoch: 45 [257/500 16448/32000 (51%)] Loss: 0.68225 (QuantReg: 13.59484) QuantErr: 13.59484 batch_time=0.39591 
Train Epoch: 45 [265/500 16960/32000 (53%)] Loss: 0.51053 (QuantReg: 13.80718) QuantErr: 13.80718 batch_time=0.45211 
Train Epoch: 45 [273/500 17472/32000 (55%)] Loss: 0.43834 (QuantReg: 13.73332) QuantErr: 13.73332 batch_time=0.39479 
Train Epoch: 45 [281/500 17984/32000 (56%)] Loss: 0.67895 (QuantReg: 13.58630) QuantErr: 13.58630 batch_time=0.39882 
Train Epoch: 45 [289/500 18496/32000 (58%)] Loss: 0.54654 (QuantReg: 13.67066) QuantErr: 13.67066 batch_time=0.40296 
Train Epoch: 45 [297/500 19008/32000 (59%)] Loss: 0.64192 (QuantReg: 13.67375) QuantErr: 13.67375 batch_time=0.43552 
Train Epoch: 45 [305/500 19520/32000 (61%)] Loss: 0.71735 (QuantReg: 13.54598) QuantErr: 13.54598 batch_time=0.40641 
Train Epoch: 45 [313/500 20032/32000 (63%)] Loss: 0.60578 (QuantReg: 13.29932) QuantErr: 13.29932 batch_time=0.39795 
Train Epoch: 45 [321/500 20544/32000 (64%)] Loss: 0.96475 (QuantReg: 13.54439) QuantErr: 13.54439 batch_time=0.42032 
Train Epoch: 45 [329/500 21056/32000 (66%)] Loss: 0.67555 (QuantReg: 13.55576) QuantErr: 13.55576 batch_time=0.42453 
Train Epoch: 45 [337/500 21568/32000 (67%)] Loss: 0.92970 (QuantReg: 13.43620) QuantErr: 13.43620 batch_time=0.40034 
Train Epoch: 45 [345/500 22080/32000 (69%)] Loss: 0.73294 (QuantReg: 13.55180) QuantErr: 13.55180 batch_time=0.40337 
Train Epoch: 45 [353/500 22592/32000 (71%)] Loss: 0.49026 (QuantReg: 13.59468) QuantErr: 13.59468 batch_time=0.43132 
Train Epoch: 45 [361/500 23104/32000 (72%)] Loss: 0.58828 (QuantReg: 13.21886) QuantErr: 13.21886 batch_time=0.41013 
Train Epoch: 45 [369/500 23616/32000 (74%)] Loss: 0.76389 (QuantReg: 13.46679) QuantErr: 13.46679 batch_time=0.39655 
Train Epoch: 45 [377/500 24128/32000 (75%)] Loss: 0.70598 (QuantReg: 13.50535) QuantErr: 13.50535 batch_time=0.39115 
Train Epoch: 45 [385/500 24640/32000 (77%)] Loss: 0.58365 (QuantReg: 13.61786) QuantErr: 13.61786 batch_time=0.40029 
Train Epoch: 45 [393/500 25152/32000 (79%)] Loss: 0.60863 (QuantReg: 13.70332) QuantErr: 13.70332 batch_time=0.40004 
Train Epoch: 45 [401/500 25664/32000 (80%)] Loss: 0.94423 (QuantReg: 13.58451) QuantErr: 13.58451 batch_time=0.46955 
Train Epoch: 45 [409/500 26176/32000 (82%)] Loss: 0.56985 (QuantReg: 13.91084) QuantErr: 13.91084 batch_time=0.40744 
Train Epoch: 45 [417/500 26688/32000 (83%)] Loss: 0.70938 (QuantReg: 13.39672) QuantErr: 13.39672 batch_time=0.39747 
Train Epoch: 45 [425/500 27200/32000 (85%)] Loss: 0.63250 (QuantReg: 13.45868) QuantErr: 13.45868 batch_time=0.38614 
Train Epoch: 45 [433/500 27712/32000 (87%)] Loss: 0.58590 (QuantReg: 13.79687) QuantErr: 13.79687 batch_time=0.40576 
Train Epoch: 45 [441/500 28224/32000 (88%)] Loss: 0.93699 (QuantReg: 13.65163) QuantErr: 13.65163 batch_time=0.39992 
Train Epoch: 45 [449/500 28736/32000 (90%)] Loss: 0.59785 (QuantReg: 13.74654) QuantErr: 13.74654 batch_time=0.41725 
Train Epoch: 45 [457/500 29248/32000 (91%)] Loss: 0.45363 (QuantReg: 13.86349) QuantErr: 13.86349 batch_time=0.42904 
Train Epoch: 45 [465/500 29760/32000 (93%)] Loss: 0.57095 (QuantReg: 13.98549) QuantErr: 13.98549 batch_time=0.39141 
Train Epoch: 45 [473/500 30272/32000 (95%)] Loss: 0.65744 (QuantReg: 13.83085) QuantErr: 13.83085 batch_time=0.39174 
Train Epoch: 45 [481/500 30784/32000 (96%)] Loss: 0.45450 (QuantReg: 13.74838) QuantErr: 13.74838 batch_time=0.39969 
Train Epoch: 45 [489/500 31296/32000 (98%)] Loss: 0.58723 (QuantReg: 13.74180) QuantErr: 13.74180 batch_time=0.39871 
Train Epoch: 45 [497/500 31808/32000 (99%)] Loss: 0.74302 (QuantReg: 13.61235) QuantErr: 13.61235 batch_time=0.40996 
Train Epoch: 45 codebook_update_time=1.85159
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch45.pth ...
Done in 4.307s
removing stale ckpt [epoch 44] [took 0.02s]
 epoch          : 45
 loss           : 0.6224251775443554
 quant_reg      : 13.665837265014648
 quant_err      : 13.665837265014648
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 22500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.565
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.3106563822237
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.5055
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.059667691964776
 mnt_best       : 46.3298567973894
 not_improved_count: 9
Train Epoch: 46 [1/500 64/32000 (0%)] Loss: 0.52542 (QuantReg: 14.13211) QuantErr: 14.13211 batch_time=24.16375 
Train Epoch: 46 [9/500 576/32000 (2%)] Loss: 0.76647 (QuantReg: 13.76748) QuantErr: 13.76748 batch_time=0.43222 
Train Epoch: 46 [17/500 1088/32000 (3%)] Loss: 0.60238 (QuantReg: 13.70178) QuantErr: 13.70178 batch_time=0.39889 
Train Epoch: 46 [25/500 1600/32000 (5%)] Loss: 0.90461 (QuantReg: 13.26198) QuantErr: 13.26198 batch_time=0.39190 
Train Epoch: 46 [33/500 2112/32000 (7%)] Loss: 0.32323 (QuantReg: 14.11909) QuantErr: 14.11909 batch_time=0.39167 
Train Epoch: 46 [41/500 2624/32000 (8%)] Loss: 0.89656 (QuantReg: 13.94200) QuantErr: 13.94200 batch_time=0.39108 
Train Epoch: 46 [49/500 3136/32000 (10%)] Loss: 1.00752 (QuantReg: 13.56768) QuantErr: 13.56768 batch_time=0.39008 
Train Epoch: 46 [57/500 3648/32000 (11%)] Loss: 0.87609 (QuantReg: 13.50012) QuantErr: 13.50012 batch_time=0.45364 
Train Epoch: 46 [65/500 4160/32000 (13%)] Loss: 0.65266 (QuantReg: 13.72488) QuantErr: 13.72488 batch_time=1.26835 
Train Epoch: 46 [73/500 4672/32000 (15%)] Loss: 0.87940 (QuantReg: 13.41274) QuantErr: 13.41274 batch_time=0.41159 
Train Epoch: 46 [81/500 5184/32000 (16%)] Loss: 0.70804 (QuantReg: 13.75194) QuantErr: 13.75194 batch_time=0.38986 
Train Epoch: 46 [89/500 5696/32000 (18%)] Loss: 0.76017 (QuantReg: 13.41798) QuantErr: 13.41798 batch_time=0.40037 
Train Epoch: 46 [97/500 6208/32000 (19%)] Loss: 0.62224 (QuantReg: 13.37277) QuantErr: 13.37277 batch_time=0.38983 
Train Epoch: 46 [105/500 6720/32000 (21%)] Loss: 0.48265 (QuantReg: 13.55015) QuantErr: 13.55015 batch_time=0.39168 
Train Epoch: 46 [113/500 7232/32000 (23%)] Loss: 0.56760 (QuantReg: 13.97902) QuantErr: 13.97902 batch_time=0.39695 
Train Epoch: 46 [121/500 7744/32000 (24%)] Loss: 0.46266 (QuantReg: 13.23434) QuantErr: 13.23434 batch_time=0.85139 
Train Epoch: 46 [129/500 8256/32000 (26%)] Loss: 0.53588 (QuantReg: 13.75997) QuantErr: 13.75997 batch_time=1.25815 
Train Epoch: 46 [137/500 8768/32000 (27%)] Loss: 0.77989 (QuantReg: 14.02103) QuantErr: 14.02103 batch_time=0.44801 
Train Epoch: 46 [145/500 9280/32000 (29%)] Loss: 0.48435 (QuantReg: 13.82679) QuantErr: 13.82679 batch_time=0.38331 
Train Epoch: 46 [153/500 9792/32000 (31%)] Loss: 0.71152 (QuantReg: 13.66316) QuantErr: 13.66316 batch_time=0.44004 
Train Epoch: 46 [161/500 10304/32000 (32%)] Loss: 0.55379 (QuantReg: 13.41898) QuantErr: 13.41898 batch_time=0.40261 
Train Epoch: 46 [169/500 10816/32000 (34%)] Loss: 0.52538 (QuantReg: 13.41561) QuantErr: 13.41561 batch_time=0.39545 
Train Epoch: 46 [177/500 11328/32000 (35%)] Loss: 0.47140 (QuantReg: 13.59691) QuantErr: 13.59691 batch_time=0.38671 
Train Epoch: 46 [185/500 11840/32000 (37%)] Loss: 0.66080 (QuantReg: 13.80032) QuantErr: 13.80032 batch_time=0.86698 
Train Epoch: 46 [193/500 12352/32000 (39%)] Loss: 0.64369 (QuantReg: 13.95220) QuantErr: 13.95220 batch_time=1.27087 
Train Epoch: 46 [201/500 12864/32000 (40%)] Loss: 0.66745 (QuantReg: 13.50951) QuantErr: 13.50951 batch_time=0.49803 
Train Epoch: 46 [209/500 13376/32000 (42%)] Loss: 0.35185 (QuantReg: 13.76762) QuantErr: 13.76762 batch_time=0.44597 
Train Epoch: 46 [217/500 13888/32000 (43%)] Loss: 0.74018 (QuantReg: 13.56598) QuantErr: 13.56598 batch_time=0.41507 
Train Epoch: 46 [225/500 14400/32000 (45%)] Loss: 0.41886 (QuantReg: 13.80611) QuantErr: 13.80611 batch_time=0.39870 
Train Epoch: 46 [233/500 14912/32000 (47%)] Loss: 0.49246 (QuantReg: 13.91612) QuantErr: 13.91612 batch_time=0.39212 
Train Epoch: 46 [241/500 15424/32000 (48%)] Loss: 0.80381 (QuantReg: 13.74502) QuantErr: 13.74502 batch_time=0.40191 
Train Epoch: 46 [249/500 15936/32000 (50%)] Loss: 0.66671 (QuantReg: 13.93062) QuantErr: 13.93062 batch_time=0.85832 
Train Epoch: 46 [257/500 16448/32000 (51%)] Loss: 0.60706 (QuantReg: 13.99961) QuantErr: 13.99961 batch_time=1.25422 
Train Epoch: 46 [265/500 16960/32000 (53%)] Loss: 0.68048 (QuantReg: 13.57542) QuantErr: 13.57542 batch_time=0.44218 
Train Epoch: 46 [273/500 17472/32000 (55%)] Loss: 0.80665 (QuantReg: 13.69104) QuantErr: 13.69104 batch_time=0.40181 
Train Epoch: 46 [281/500 17984/32000 (56%)] Loss: 0.57394 (QuantReg: 13.76498) QuantErr: 13.76498 batch_time=0.41106 
Train Epoch: 46 [289/500 18496/32000 (58%)] Loss: 0.64883 (QuantReg: 13.33394) QuantErr: 13.33394 batch_time=0.39534 
Train Epoch: 46 [297/500 19008/32000 (59%)] Loss: 0.61186 (QuantReg: 13.78598) QuantErr: 13.78598 batch_time=0.40135 
Train Epoch: 46 [305/500 19520/32000 (61%)] Loss: 0.37623 (QuantReg: 14.01006) QuantErr: 14.01006 batch_time=0.38801 
Train Epoch: 46 [313/500 20032/32000 (63%)] Loss: 0.45734 (QuantReg: 13.72200) QuantErr: 13.72200 batch_time=0.93161 
Train Epoch: 46 [321/500 20544/32000 (64%)] Loss: 0.62222 (QuantReg: 13.68483) QuantErr: 13.68483 batch_time=1.29596 
Train Epoch: 46 [329/500 21056/32000 (66%)] Loss: 0.54946 (QuantReg: 13.75626) QuantErr: 13.75626 batch_time=0.39812 
Train Epoch: 46 [337/500 21568/32000 (67%)] Loss: 0.73532 (QuantReg: 13.91247) QuantErr: 13.91247 batch_time=0.44755 
Train Epoch: 46 [345/500 22080/32000 (69%)] Loss: 0.96800 (QuantReg: 13.40574) QuantErr: 13.40574 batch_time=0.40233 
Train Epoch: 46 [353/500 22592/32000 (71%)] Loss: 0.80673 (QuantReg: 13.42419) QuantErr: 13.42419 batch_time=0.38962 
Train Epoch: 46 [361/500 23104/32000 (72%)] Loss: 0.55199 (QuantReg: 13.99244) QuantErr: 13.99244 batch_time=0.45973 
Train Epoch: 46 [369/500 23616/32000 (74%)] Loss: 0.65411 (QuantReg: 13.98217) QuantErr: 13.98217 batch_time=0.39516 
Train Epoch: 46 [377/500 24128/32000 (75%)] Loss: 0.67130 (QuantReg: 13.84014) QuantErr: 13.84014 batch_time=0.65495 
Train Epoch: 46 [385/500 24640/32000 (77%)] Loss: 0.92850 (QuantReg: 13.82771) QuantErr: 13.82771 batch_time=1.20715 
Train Epoch: 46 [393/500 25152/32000 (79%)] Loss: 0.59883 (QuantReg: 13.55543) QuantErr: 13.55543 batch_time=0.39356 
Train Epoch: 46 [401/500 25664/32000 (80%)] Loss: 0.59748 (QuantReg: 13.69896) QuantErr: 13.69896 batch_time=0.40396 
Train Epoch: 46 [409/500 26176/32000 (82%)] Loss: 0.61693 (QuantReg: 13.93031) QuantErr: 13.93031 batch_time=0.39639 
Train Epoch: 46 [417/500 26688/32000 (83%)] Loss: 0.69151 (QuantReg: 13.66177) QuantErr: 13.66177 batch_time=0.38090 
Train Epoch: 46 [425/500 27200/32000 (85%)] Loss: 0.69494 (QuantReg: 13.70283) QuantErr: 13.70283 batch_time=0.40088 
Train Epoch: 46 [433/500 27712/32000 (87%)] Loss: 0.65407 (QuantReg: 13.87659) QuantErr: 13.87659 batch_time=0.37942 
Train Epoch: 46 [441/500 28224/32000 (88%)] Loss: 0.73165 (QuantReg: 13.61804) QuantErr: 13.61804 batch_time=0.66195 
Train Epoch: 46 [449/500 28736/32000 (90%)] Loss: 0.92979 (QuantReg: 13.72596) QuantErr: 13.72596 batch_time=1.24060 
Train Epoch: 46 [457/500 29248/32000 (91%)] Loss: 0.62194 (QuantReg: 14.17455) QuantErr: 14.17455 batch_time=0.38984 
Train Epoch: 46 [465/500 29760/32000 (93%)] Loss: 0.62387 (QuantReg: 13.81616) QuantErr: 13.81616 batch_time=0.39411 
Train Epoch: 46 [473/500 30272/32000 (95%)] Loss: 0.57242 (QuantReg: 13.75897) QuantErr: 13.75897 batch_time=0.39674 
Train Epoch: 46 [481/500 30784/32000 (96%)] Loss: 0.28501 (QuantReg: 13.67899) QuantErr: 13.67899 batch_time=0.40498 
Train Epoch: 46 [489/500 31296/32000 (98%)] Loss: 0.53549 (QuantReg: 13.72955) QuantErr: 13.72955 batch_time=0.40254 
Train Epoch: 46 [497/500 31808/32000 (99%)] Loss: 0.75217 (QuantReg: 13.63493) QuantErr: 13.63493 batch_time=0.40240 
Train Epoch: 46 codebook_update_time=1.78205
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch46.pth ...
Done in 4.902s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 0.6280266073346138
 quant_reg      : 13.726936157226563
 quant_err      : 13.726936157226563
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 23000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.829
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.63382890377923
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.95992298095053
 mnt_best       : 46.3298567973894
 not_improved_count: 10
Train Epoch: 47 [1/500 64/32000 (0%)] Loss: 0.61507 (QuantReg: 13.55327) QuantErr: 13.55327 batch_time=26.92291 
Train Epoch: 47 [9/500 576/32000 (2%)] Loss: 0.69134 (QuantReg: 13.40883) QuantErr: 13.40883 batch_time=0.39505 
Train Epoch: 47 [17/500 1088/32000 (3%)] Loss: 0.62884 (QuantReg: 13.79185) QuantErr: 13.79185 batch_time=0.39670 
Train Epoch: 47 [25/500 1600/32000 (5%)] Loss: 0.70353 (QuantReg: 13.27163) QuantErr: 13.27163 batch_time=0.39056 
Train Epoch: 47 [33/500 2112/32000 (7%)] Loss: 0.38865 (QuantReg: 13.92614) QuantErr: 13.92614 batch_time=0.40279 
Train Epoch: 47 [41/500 2624/32000 (8%)] Loss: 0.48788 (QuantReg: 13.83050) QuantErr: 13.83050 batch_time=0.43853 
Train Epoch: 47 [49/500 3136/32000 (10%)] Loss: 0.48180 (QuantReg: 13.72026) QuantErr: 13.72026 batch_time=0.38811 
Train Epoch: 47 [57/500 3648/32000 (11%)] Loss: 0.68922 (QuantReg: 13.95256) QuantErr: 13.95256 batch_time=0.44750 
Train Epoch: 47 [65/500 4160/32000 (13%)] Loss: 0.88874 (QuantReg: 13.86212) QuantErr: 13.86212 batch_time=1.64771 
Train Epoch: 47 [73/500 4672/32000 (15%)] Loss: 0.52796 (QuantReg: 13.48529) QuantErr: 13.48529 batch_time=0.40439 
Train Epoch: 47 [81/500 5184/32000 (16%)] Loss: 0.38505 (QuantReg: 14.04927) QuantErr: 14.04927 batch_time=0.43148 
Train Epoch: 47 [89/500 5696/32000 (18%)] Loss: 0.45012 (QuantReg: 13.94359) QuantErr: 13.94359 batch_time=0.40099 
Train Epoch: 47 [97/500 6208/32000 (19%)] Loss: 0.46953 (QuantReg: 13.74912) QuantErr: 13.74912 batch_time=0.72130 
Train Epoch: 47 [105/500 6720/32000 (21%)] Loss: 0.45226 (QuantReg: 13.63827) QuantErr: 13.63827 batch_time=0.48957 
Train Epoch: 47 [113/500 7232/32000 (23%)] Loss: 0.44150 (QuantReg: 13.61855) QuantErr: 13.61855 batch_time=0.38862 
Train Epoch: 47 [121/500 7744/32000 (24%)] Loss: 0.51137 (QuantReg: 13.96013) QuantErr: 13.96013 batch_time=0.39136 
Train Epoch: 47 [129/500 8256/32000 (26%)] Loss: 0.57139 (QuantReg: 14.10573) QuantErr: 14.10573 batch_time=1.79522 
Train Epoch: 47 [137/500 8768/32000 (27%)] Loss: 0.40384 (QuantReg: 14.19741) QuantErr: 14.19741 batch_time=0.39033 
Train Epoch: 47 [145/500 9280/32000 (29%)] Loss: 0.53040 (QuantReg: 14.06411) QuantErr: 14.06411 batch_time=0.40344 
Train Epoch: 47 [153/500 9792/32000 (31%)] Loss: 0.60607 (QuantReg: 13.52563) QuantErr: 13.52563 batch_time=0.39219 
Train Epoch: 47 [161/500 10304/32000 (32%)] Loss: 0.54491 (QuantReg: 13.40134) QuantErr: 13.40134 batch_time=0.39118 
Train Epoch: 47 [169/500 10816/32000 (34%)] Loss: 0.37766 (QuantReg: 13.37271) QuantErr: 13.37271 batch_time=0.39550 
Train Epoch: 47 [177/500 11328/32000 (35%)] Loss: 0.48949 (QuantReg: 13.84773) QuantErr: 13.84773 batch_time=0.39180 
Train Epoch: 47 [185/500 11840/32000 (37%)] Loss: 0.44865 (QuantReg: 14.28884) QuantErr: 14.28884 batch_time=0.38634 
Train Epoch: 47 [193/500 12352/32000 (39%)] Loss: 0.78164 (QuantReg: 13.40757) QuantErr: 13.40757 batch_time=1.69614 
Train Epoch: 47 [201/500 12864/32000 (40%)] Loss: 0.79368 (QuantReg: 14.13351) QuantErr: 14.13351 batch_time=0.40223 
Train Epoch: 47 [209/500 13376/32000 (42%)] Loss: 0.70862 (QuantReg: 13.40091) QuantErr: 13.40091 batch_time=0.41009 
Train Epoch: 47 [217/500 13888/32000 (43%)] Loss: 0.91810 (QuantReg: 13.61680) QuantErr: 13.61680 batch_time=0.40117 
Train Epoch: 47 [225/500 14400/32000 (45%)] Loss: 0.41720 (QuantReg: 14.08525) QuantErr: 14.08525 batch_time=0.41684 
Train Epoch: 47 [233/500 14912/32000 (47%)] Loss: 0.65295 (QuantReg: 13.77627) QuantErr: 13.77627 batch_time=0.39836 
Train Epoch: 47 [241/500 15424/32000 (48%)] Loss: 0.77356 (QuantReg: 13.95919) QuantErr: 13.95919 batch_time=0.40029 
Train Epoch: 47 [249/500 15936/32000 (50%)] Loss: 0.50577 (QuantReg: 14.19063) QuantErr: 14.19063 batch_time=0.39184 
Train Epoch: 47 [257/500 16448/32000 (51%)] Loss: 0.44720 (QuantReg: 13.81165) QuantErr: 13.81165 batch_time=1.67214 
Train Epoch: 47 [265/500 16960/32000 (53%)] Loss: 0.63727 (QuantReg: 13.65427) QuantErr: 13.65427 batch_time=0.40252 
Train Epoch: 47 [273/500 17472/32000 (55%)] Loss: 0.77197 (QuantReg: 12.94028) QuantErr: 12.94028 batch_time=0.43477 
Train Epoch: 47 [281/500 17984/32000 (56%)] Loss: 0.56347 (QuantReg: 13.30744) QuantErr: 13.30744 batch_time=0.39099 
Train Epoch: 47 [289/500 18496/32000 (58%)] Loss: 0.71485 (QuantReg: 13.61483) QuantErr: 13.61483 batch_time=0.40020 
Train Epoch: 47 [297/500 19008/32000 (59%)] Loss: 0.53951 (QuantReg: 13.69132) QuantErr: 13.69132 batch_time=0.42596 
Train Epoch: 47 [305/500 19520/32000 (61%)] Loss: 0.75395 (QuantReg: 13.54104) QuantErr: 13.54104 batch_time=0.43752 
Train Epoch: 47 [313/500 20032/32000 (63%)] Loss: 0.51890 (QuantReg: 13.63631) QuantErr: 13.63631 batch_time=0.39123 
Train Epoch: 47 [321/500 20544/32000 (64%)] Loss: 0.44805 (QuantReg: 13.97680) QuantErr: 13.97680 batch_time=1.71891 
Train Epoch: 47 [329/500 21056/32000 (66%)] Loss: 0.54645 (QuantReg: 13.98276) QuantErr: 13.98276 batch_time=0.39118 
Train Epoch: 47 [337/500 21568/32000 (67%)] Loss: 0.59699 (QuantReg: 13.79610) QuantErr: 13.79610 batch_time=0.41949 
Train Epoch: 47 [345/500 22080/32000 (69%)] Loss: 0.49463 (QuantReg: 14.06685) QuantErr: 14.06685 batch_time=0.39454 
Train Epoch: 47 [353/500 22592/32000 (71%)] Loss: 0.86072 (QuantReg: 14.11045) QuantErr: 14.11045 batch_time=0.40085 
Train Epoch: 47 [361/500 23104/32000 (72%)] Loss: 0.44003 (QuantReg: 13.71145) QuantErr: 13.71145 batch_time=0.41456 
Train Epoch: 47 [369/500 23616/32000 (74%)] Loss: 0.39826 (QuantReg: 13.87192) QuantErr: 13.87192 batch_time=0.39617 
Train Epoch: 47 [377/500 24128/32000 (75%)] Loss: 0.64997 (QuantReg: 13.70720) QuantErr: 13.70720 batch_time=0.39275 
Train Epoch: 47 [385/500 24640/32000 (77%)] Loss: 0.78339 (QuantReg: 13.82479) QuantErr: 13.82479 batch_time=1.65649 
Train Epoch: 47 [393/500 25152/32000 (79%)] Loss: 0.47228 (QuantReg: 13.66185) QuantErr: 13.66185 batch_time=0.44556 
Train Epoch: 47 [401/500 25664/32000 (80%)] Loss: 0.64905 (QuantReg: 13.84375) QuantErr: 13.84375 batch_time=0.39862 
Train Epoch: 47 [409/500 26176/32000 (82%)] Loss: 0.89282 (QuantReg: 13.54217) QuantErr: 13.54217 batch_time=0.42754 
Train Epoch: 47 [417/500 26688/32000 (83%)] Loss: 0.67446 (QuantReg: 13.91679) QuantErr: 13.91679 batch_time=0.39555 
Train Epoch: 47 [425/500 27200/32000 (85%)] Loss: 0.72647 (QuantReg: 13.76590) QuantErr: 13.76590 batch_time=0.42543 
Train Epoch: 47 [433/500 27712/32000 (87%)] Loss: 1.02577 (QuantReg: 13.61540) QuantErr: 13.61540 batch_time=0.40221 
Train Epoch: 47 [441/500 28224/32000 (88%)] Loss: 0.42968 (QuantReg: 13.69571) QuantErr: 13.69571 batch_time=0.39502 
Train Epoch: 47 [449/500 28736/32000 (90%)] Loss: 0.59642 (QuantReg: 13.79730) QuantErr: 13.79730 batch_time=1.73050 
Train Epoch: 47 [457/500 29248/32000 (91%)] Loss: 0.81768 (QuantReg: 13.89415) QuantErr: 13.89415 batch_time=0.41508 
Train Epoch: 47 [465/500 29760/32000 (93%)] Loss: 0.78213 (QuantReg: 13.55724) QuantErr: 13.55724 batch_time=0.40106 
Train Epoch: 47 [473/500 30272/32000 (95%)] Loss: 0.63618 (QuantReg: 13.47758) QuantErr: 13.47758 batch_time=0.39028 
Train Epoch: 47 [481/500 30784/32000 (96%)] Loss: 0.72104 (QuantReg: 13.48262) QuantErr: 13.48262 batch_time=0.39593 
Train Epoch: 47 [489/500 31296/32000 (98%)] Loss: 0.51331 (QuantReg: 14.20008) QuantErr: 14.20008 batch_time=0.40844 
Train Epoch: 47 [497/500 31808/32000 (99%)] Loss: 0.72991 (QuantReg: 13.74316) QuantErr: 13.74316 batch_time=0.40504 
Train Epoch: 47 codebook_update_time=1.89391
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch47.pth ...
Done in 5.361s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 0.6129234357476234
 quant_reg      : 13.730650302886962
 quant_err      : 13.730650302886962
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 23500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.662
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.69159222035879
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1545
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.39566996236671
 mnt_best       : 46.3298567973894
 not_improved_count: 11
Train Epoch: 48 [1/500 64/32000 (0%)] Loss: 0.61079 (QuantReg: 13.43251) QuantErr: 13.43251 batch_time=23.67644 
Train Epoch: 48 [9/500 576/32000 (2%)] Loss: 0.67386 (QuantReg: 13.64345) QuantErr: 13.64345 batch_time=0.40152 
Train Epoch: 48 [17/500 1088/32000 (3%)] Loss: 0.67519 (QuantReg: 13.47633) QuantErr: 13.47633 batch_time=0.39383 
Train Epoch: 48 [25/500 1600/32000 (5%)] Loss: 0.58896 (QuantReg: 13.70460) QuantErr: 13.70460 batch_time=0.51535 
Train Epoch: 48 [33/500 2112/32000 (7%)] Loss: 0.73070 (QuantReg: 13.40773) QuantErr: 13.40773 batch_time=0.40280 
Train Epoch: 48 [41/500 2624/32000 (8%)] Loss: 0.68190 (QuantReg: 13.54393) QuantErr: 13.54393 batch_time=0.39323 
Train Epoch: 48 [49/500 3136/32000 (10%)] Loss: 0.78697 (QuantReg: 13.52845) QuantErr: 13.52845 batch_time=0.38894 
Train Epoch: 48 [57/500 3648/32000 (11%)] Loss: 0.59237 (QuantReg: 13.68311) QuantErr: 13.68311 batch_time=0.39334 
Train Epoch: 48 [65/500 4160/32000 (13%)] Loss: 0.68755 (QuantReg: 13.90201) QuantErr: 13.90201 batch_time=1.13206 
Train Epoch: 48 [73/500 4672/32000 (15%)] Loss: 0.51156 (QuantReg: 13.66709) QuantErr: 13.66709 batch_time=0.39832 
Train Epoch: 48 [81/500 5184/32000 (16%)] Loss: 0.59638 (QuantReg: 13.73211) QuantErr: 13.73211 batch_time=0.38975 
Train Epoch: 48 [89/500 5696/32000 (18%)] Loss: 0.63498 (QuantReg: 13.61623) QuantErr: 13.61623 batch_time=0.65030 
Train Epoch: 48 [97/500 6208/32000 (19%)] Loss: 0.50855 (QuantReg: 13.62184) QuantErr: 13.62184 batch_time=0.38540 
Train Epoch: 48 [105/500 6720/32000 (21%)] Loss: 0.81011 (QuantReg: 14.23630) QuantErr: 14.23630 batch_time=0.43621 
Train Epoch: 48 [113/500 7232/32000 (23%)] Loss: 0.63213 (QuantReg: 13.23712) QuantErr: 13.23712 batch_time=0.40321 
Train Epoch: 48 [121/500 7744/32000 (24%)] Loss: 0.56774 (QuantReg: 13.79406) QuantErr: 13.79406 batch_time=0.43436 
Train Epoch: 48 [129/500 8256/32000 (26%)] Loss: 0.46197 (QuantReg: 13.53052) QuantErr: 13.53052 batch_time=1.17435 
Train Epoch: 48 [137/500 8768/32000 (27%)] Loss: 0.52168 (QuantReg: 13.63324) QuantErr: 13.63324 batch_time=0.39515 
Train Epoch: 48 [145/500 9280/32000 (29%)] Loss: 0.81620 (QuantReg: 13.64138) QuantErr: 13.64138 batch_time=0.39586 
Train Epoch: 48 [153/500 9792/32000 (31%)] Loss: 0.48225 (QuantReg: 13.81181) QuantErr: 13.81181 batch_time=0.61492 
Train Epoch: 48 [161/500 10304/32000 (32%)] Loss: 0.40952 (QuantReg: 13.73782) QuantErr: 13.73782 batch_time=0.39785 
Train Epoch: 48 [169/500 10816/32000 (34%)] Loss: 0.85696 (QuantReg: 13.87362) QuantErr: 13.87362 batch_time=0.43822 
Train Epoch: 48 [177/500 11328/32000 (35%)] Loss: 0.51911 (QuantReg: 13.78538) QuantErr: 13.78538 batch_time=0.38921 
Train Epoch: 48 [185/500 11840/32000 (37%)] Loss: 0.81274 (QuantReg: 14.18059) QuantErr: 14.18059 batch_time=0.45582 
Train Epoch: 48 [193/500 12352/32000 (39%)] Loss: 0.88569 (QuantReg: 13.39052) QuantErr: 13.39052 batch_time=1.20805 
Train Epoch: 48 [201/500 12864/32000 (40%)] Loss: 0.77084 (QuantReg: 13.56685) QuantErr: 13.56685 batch_time=0.42345 
Train Epoch: 48 [209/500 13376/32000 (42%)] Loss: 0.84314 (QuantReg: 13.27267) QuantErr: 13.27267 batch_time=0.39349 
Train Epoch: 48 [217/500 13888/32000 (43%)] Loss: 0.43585 (QuantReg: 14.02286) QuantErr: 14.02286 batch_time=0.39653 
Train Epoch: 48 [225/500 14400/32000 (45%)] Loss: 0.67970 (QuantReg: 13.83313) QuantErr: 13.83313 batch_time=0.42584 
Train Epoch: 48 [233/500 14912/32000 (47%)] Loss: 0.76543 (QuantReg: 13.49846) QuantErr: 13.49846 batch_time=0.39562 
Train Epoch: 48 [241/500 15424/32000 (48%)] Loss: 0.55788 (QuantReg: 14.28343) QuantErr: 14.28343 batch_time=0.41504 
Train Epoch: 48 [249/500 15936/32000 (50%)] Loss: 0.47199 (QuantReg: 13.62610) QuantErr: 13.62610 batch_time=0.40139 
Train Epoch: 48 [257/500 16448/32000 (51%)] Loss: 0.58512 (QuantReg: 13.90717) QuantErr: 13.90717 batch_time=1.01013 
Train Epoch: 48 [265/500 16960/32000 (53%)] Loss: 0.43341 (QuantReg: 13.59746) QuantErr: 13.59746 batch_time=0.40390 
Train Epoch: 48 [273/500 17472/32000 (55%)] Loss: 0.76793 (QuantReg: 13.66079) QuantErr: 13.66079 batch_time=0.40984 
Train Epoch: 48 [281/500 17984/32000 (56%)] Loss: 0.51987 (QuantReg: 13.94895) QuantErr: 13.94895 batch_time=0.41843 
Train Epoch: 48 [289/500 18496/32000 (58%)] Loss: 0.49463 (QuantReg: 14.20517) QuantErr: 14.20517 batch_time=0.39816 
Train Epoch: 48 [297/500 19008/32000 (59%)] Loss: 0.57604 (QuantReg: 13.83339) QuantErr: 13.83339 batch_time=0.39254 
Train Epoch: 48 [305/500 19520/32000 (61%)] Loss: 0.73077 (QuantReg: 13.30192) QuantErr: 13.30192 batch_time=0.44863 
Train Epoch: 48 [313/500 20032/32000 (63%)] Loss: 0.59766 (QuantReg: 13.70377) QuantErr: 13.70377 batch_time=0.47739 
Train Epoch: 48 [321/500 20544/32000 (64%)] Loss: 0.50677 (QuantReg: 14.06949) QuantErr: 14.06949 batch_time=1.05371 
Train Epoch: 48 [329/500 21056/32000 (66%)] Loss: 0.60135 (QuantReg: 13.77901) QuantErr: 13.77901 batch_time=0.39764 
Train Epoch: 48 [337/500 21568/32000 (67%)] Loss: 0.33716 (QuantReg: 13.75680) QuantErr: 13.75680 batch_time=0.40445 
Train Epoch: 48 [345/500 22080/32000 (69%)] Loss: 0.64080 (QuantReg: 13.68492) QuantErr: 13.68492 batch_time=0.41136 
Train Epoch: 48 [353/500 22592/32000 (71%)] Loss: 0.43531 (QuantReg: 13.56298) QuantErr: 13.56298 batch_time=0.39169 
Train Epoch: 48 [361/500 23104/32000 (72%)] Loss: 0.47243 (QuantReg: 13.47495) QuantErr: 13.47495 batch_time=0.41080 
Train Epoch: 48 [369/500 23616/32000 (74%)] Loss: 0.44021 (QuantReg: 13.57697) QuantErr: 13.57697 batch_time=0.39620 
Train Epoch: 48 [377/500 24128/32000 (75%)] Loss: 0.70122 (QuantReg: 13.91719) QuantErr: 13.91719 batch_time=0.39335 
Train Epoch: 48 [385/500 24640/32000 (77%)] Loss: 0.60538 (QuantReg: 13.62361) QuantErr: 13.62361 batch_time=1.18464 
Train Epoch: 48 [393/500 25152/32000 (79%)] Loss: 0.84971 (QuantReg: 13.63357) QuantErr: 13.63357 batch_time=0.39574 
Train Epoch: 48 [401/500 25664/32000 (80%)] Loss: 0.79309 (QuantReg: 13.56605) QuantErr: 13.56605 batch_time=0.39283 
Train Epoch: 48 [409/500 26176/32000 (82%)] Loss: 0.74304 (QuantReg: 13.96400) QuantErr: 13.96400 batch_time=0.39599 
Train Epoch: 48 [417/500 26688/32000 (83%)] Loss: 0.44085 (QuantReg: 13.76284) QuantErr: 13.76284 batch_time=0.37843 
Train Epoch: 48 [425/500 27200/32000 (85%)] Loss: 0.51943 (QuantReg: 13.99315) QuantErr: 13.99315 batch_time=0.38729 
Train Epoch: 48 [433/500 27712/32000 (87%)] Loss: 0.88149 (QuantReg: 13.26237) QuantErr: 13.26237 batch_time=0.39032 
Train Epoch: 48 [441/500 28224/32000 (88%)] Loss: 0.76920 (QuantReg: 13.56013) QuantErr: 13.56013 batch_time=0.38044 
Train Epoch: 48 [449/500 28736/32000 (90%)] Loss: 0.83238 (QuantReg: 13.84987) QuantErr: 13.84987 batch_time=1.15398 
Train Epoch: 48 [457/500 29248/32000 (91%)] Loss: 0.53252 (QuantReg: 14.02636) QuantErr: 14.02636 batch_time=0.39851 
Train Epoch: 48 [465/500 29760/32000 (93%)] Loss: 0.64702 (QuantReg: 13.82708) QuantErr: 13.82708 batch_time=0.40633 
Train Epoch: 48 [473/500 30272/32000 (95%)] Loss: 0.81280 (QuantReg: 14.03848) QuantErr: 14.03848 batch_time=0.43195 
Train Epoch: 48 [481/500 30784/32000 (96%)] Loss: 0.62077 (QuantReg: 13.80402) QuantErr: 13.80402 batch_time=0.39550 
Train Epoch: 48 [489/500 31296/32000 (98%)] Loss: 0.75798 (QuantReg: 14.17170) QuantErr: 14.17170 batch_time=0.39372 
Train Epoch: 48 [497/500 31808/32000 (99%)] Loss: 0.55808 (QuantReg: 13.83797) QuantErr: 13.83797 batch_time=0.41042 
Train Epoch: 48 codebook_update_time=1.83898
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch48.pth ...
Done in 5.613s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 0.6090240458548069
 quant_reg      : 13.735934141159058
 quant_err      : 13.735934141159058
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 24000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.767
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.93539370919101
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.467
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.62656051265446
 mnt_best       : 46.3298567973894
 not_improved_count: 12
Train Epoch: 49 [1/500 64/32000 (0%)] Loss: 0.50736 (QuantReg: 13.93551) QuantErr: 13.93551 batch_time=26.38676 
Train Epoch: 49 [9/500 576/32000 (2%)] Loss: 0.82604 (QuantReg: 14.20216) QuantErr: 14.20216 batch_time=0.39021 
Train Epoch: 49 [17/500 1088/32000 (3%)] Loss: 0.40524 (QuantReg: 13.49439) QuantErr: 13.49439 batch_time=0.41664 
Train Epoch: 49 [25/500 1600/32000 (5%)] Loss: 0.98602 (QuantReg: 13.85775) QuantErr: 13.85775 batch_time=0.83163 
Train Epoch: 49 [33/500 2112/32000 (7%)] Loss: 0.60186 (QuantReg: 13.91237) QuantErr: 13.91237 batch_time=0.39565 
Train Epoch: 49 [41/500 2624/32000 (8%)] Loss: 0.29889 (QuantReg: 13.91067) QuantErr: 13.91067 batch_time=0.40786 
Train Epoch: 49 [49/500 3136/32000 (10%)] Loss: 0.71917 (QuantReg: 14.03358) QuantErr: 14.03358 batch_time=0.38673 
Train Epoch: 49 [57/500 3648/32000 (11%)] Loss: 0.66308 (QuantReg: 14.00044) QuantErr: 14.00044 batch_time=0.39735 
Train Epoch: 49 [65/500 4160/32000 (13%)] Loss: 0.64282 (QuantReg: 13.50214) QuantErr: 13.50214 batch_time=0.79023 
Train Epoch: 49 [73/500 4672/32000 (15%)] Loss: 0.36221 (QuantReg: 13.77333) QuantErr: 13.77333 batch_time=0.39227 
Train Epoch: 49 [81/500 5184/32000 (16%)] Loss: 0.65572 (QuantReg: 14.04906) QuantErr: 14.04906 batch_time=0.39621 
Train Epoch: 49 [89/500 5696/32000 (18%)] Loss: 0.63058 (QuantReg: 13.63375) QuantErr: 13.63375 batch_time=0.79580 
Train Epoch: 49 [97/500 6208/32000 (19%)] Loss: 0.60866 (QuantReg: 13.42593) QuantErr: 13.42593 batch_time=0.39475 
Train Epoch: 49 [105/500 6720/32000 (21%)] Loss: 0.52849 (QuantReg: 13.84789) QuantErr: 13.84789 batch_time=0.39327 
Train Epoch: 49 [113/500 7232/32000 (23%)] Loss: 0.48288 (QuantReg: 13.53088) QuantErr: 13.53088 batch_time=0.40962 
Train Epoch: 49 [121/500 7744/32000 (24%)] Loss: 0.43656 (QuantReg: 14.04605) QuantErr: 14.04605 batch_time=0.41753 
Train Epoch: 49 [129/500 8256/32000 (26%)] Loss: 0.43597 (QuantReg: 13.72300) QuantErr: 13.72300 batch_time=0.81572 
Train Epoch: 49 [137/500 8768/32000 (27%)] Loss: 0.48012 (QuantReg: 14.10858) QuantErr: 14.10858 batch_time=0.40464 
Train Epoch: 49 [145/500 9280/32000 (29%)] Loss: 0.57515 (QuantReg: 14.00589) QuantErr: 14.00589 batch_time=0.38773 
Train Epoch: 49 [153/500 9792/32000 (31%)] Loss: 0.90752 (QuantReg: 13.56231) QuantErr: 13.56231 batch_time=0.78190 
Train Epoch: 49 [161/500 10304/32000 (32%)] Loss: 0.70993 (QuantReg: 13.92021) QuantErr: 13.92021 batch_time=0.39331 
Train Epoch: 49 [169/500 10816/32000 (34%)] Loss: 0.66097 (QuantReg: 13.67844) QuantErr: 13.67844 batch_time=0.39941 
Train Epoch: 49 [177/500 11328/32000 (35%)] Loss: 0.86258 (QuantReg: 13.60270) QuantErr: 13.60270 batch_time=0.37755 
Train Epoch: 49 [185/500 11840/32000 (37%)] Loss: 0.55366 (QuantReg: 13.71202) QuantErr: 13.71202 batch_time=0.37990 
Train Epoch: 49 [193/500 12352/32000 (39%)] Loss: 0.59368 (QuantReg: 13.62611) QuantErr: 13.62611 batch_time=0.77487 
Train Epoch: 49 [201/500 12864/32000 (40%)] Loss: 0.49063 (QuantReg: 13.61931) QuantErr: 13.61931 batch_time=0.42485 
Train Epoch: 49 [209/500 13376/32000 (42%)] Loss: 0.58448 (QuantReg: 13.61780) QuantErr: 13.61780 batch_time=0.39039 
Train Epoch: 49 [217/500 13888/32000 (43%)] Loss: 0.78929 (QuantReg: 13.77510) QuantErr: 13.77510 batch_time=0.80326 
Train Epoch: 49 [225/500 14400/32000 (45%)] Loss: 0.92145 (QuantReg: 13.21575) QuantErr: 13.21575 batch_time=0.41833 
Train Epoch: 49 [233/500 14912/32000 (47%)] Loss: 0.62848 (QuantReg: 14.32774) QuantErr: 14.32774 batch_time=0.39195 
Train Epoch: 49 [241/500 15424/32000 (48%)] Loss: 0.46445 (QuantReg: 13.56197) QuantErr: 13.56197 batch_time=0.42229 
Train Epoch: 49 [249/500 15936/32000 (50%)] Loss: 0.43662 (QuantReg: 14.11286) QuantErr: 14.11286 batch_time=0.39487 
Train Epoch: 49 [257/500 16448/32000 (51%)] Loss: 0.47216 (QuantReg: 13.81526) QuantErr: 13.81526 batch_time=0.82815 
Train Epoch: 49 [265/500 16960/32000 (53%)] Loss: 0.66885 (QuantReg: 13.91968) QuantErr: 13.91968 batch_time=0.39697 
Train Epoch: 49 [273/500 17472/32000 (55%)] Loss: 0.32648 (QuantReg: 13.98815) QuantErr: 13.98815 batch_time=0.43210 
Train Epoch: 49 [281/500 17984/32000 (56%)] Loss: 0.59010 (QuantReg: 13.67377) QuantErr: 13.67377 batch_time=0.80649 
Train Epoch: 49 [289/500 18496/32000 (58%)] Loss: 0.54914 (QuantReg: 14.18277) QuantErr: 14.18277 batch_time=0.38633 
Train Epoch: 49 [297/500 19008/32000 (59%)] Loss: 0.66374 (QuantReg: 13.93084) QuantErr: 13.93084 batch_time=0.42788 
Train Epoch: 49 [305/500 19520/32000 (61%)] Loss: 0.62301 (QuantReg: 14.05646) QuantErr: 14.05646 batch_time=0.39582 
Train Epoch: 49 [313/500 20032/32000 (63%)] Loss: 0.77587 (QuantReg: 13.56039) QuantErr: 13.56039 batch_time=0.38646 
Train Epoch: 49 [321/500 20544/32000 (64%)] Loss: 0.56793 (QuantReg: 13.50154) QuantErr: 13.50154 batch_time=0.79465 
Train Epoch: 49 [329/500 21056/32000 (66%)] Loss: 0.48935 (QuantReg: 14.14951) QuantErr: 14.14951 batch_time=0.39077 
Train Epoch: 49 [337/500 21568/32000 (67%)] Loss: 0.70620 (QuantReg: 13.50267) QuantErr: 13.50267 batch_time=0.42977 
Train Epoch: 49 [345/500 22080/32000 (69%)] Loss: 0.54358 (QuantReg: 13.55051) QuantErr: 13.55051 batch_time=0.79318 
Train Epoch: 49 [353/500 22592/32000 (71%)] Loss: 0.51402 (QuantReg: 13.79961) QuantErr: 13.79961 batch_time=0.38647 
Train Epoch: 49 [361/500 23104/32000 (72%)] Loss: 0.70322 (QuantReg: 13.90086) QuantErr: 13.90086 batch_time=0.46509 
Train Epoch: 49 [369/500 23616/32000 (74%)] Loss: 0.39708 (QuantReg: 13.47262) QuantErr: 13.47262 batch_time=0.39885 
Train Epoch: 49 [377/500 24128/32000 (75%)] Loss: 0.97404 (QuantReg: 14.03448) QuantErr: 14.03448 batch_time=0.40646 
Train Epoch: 49 [385/500 24640/32000 (77%)] Loss: 0.52155 (QuantReg: 13.71278) QuantErr: 13.71278 batch_time=0.84505 
Train Epoch: 49 [393/500 25152/32000 (79%)] Loss: 0.61028 (QuantReg: 13.89008) QuantErr: 13.89008 batch_time=0.42212 
Train Epoch: 49 [401/500 25664/32000 (80%)] Loss: 0.31611 (QuantReg: 14.26389) QuantErr: 14.26389 batch_time=0.39663 
Train Epoch: 49 [409/500 26176/32000 (82%)] Loss: 0.68480 (QuantReg: 13.77272) QuantErr: 13.77272 batch_time=0.78092 
Train Epoch: 49 [417/500 26688/32000 (83%)] Loss: 0.78524 (QuantReg: 13.90991) QuantErr: 13.90991 batch_time=0.38567 
Train Epoch: 49 [425/500 27200/32000 (85%)] Loss: 0.58020 (QuantReg: 13.61444) QuantErr: 13.61444 batch_time=0.40130 
Train Epoch: 49 [433/500 27712/32000 (87%)] Loss: 0.48707 (QuantReg: 13.76521) QuantErr: 13.76521 batch_time=0.39322 
Train Epoch: 49 [441/500 28224/32000 (88%)] Loss: 0.37019 (QuantReg: 14.07932) QuantErr: 14.07932 batch_time=0.38941 
Train Epoch: 49 [449/500 28736/32000 (90%)] Loss: 0.52637 (QuantReg: 13.76371) QuantErr: 13.76371 batch_time=0.82026 
Train Epoch: 49 [457/500 29248/32000 (91%)] Loss: 0.79006 (QuantReg: 13.61570) QuantErr: 13.61570 batch_time=0.41116 
Train Epoch: 49 [465/500 29760/32000 (93%)] Loss: 0.93327 (QuantReg: 14.06756) QuantErr: 14.06756 batch_time=0.39754 
Train Epoch: 49 [473/500 30272/32000 (95%)] Loss: 0.73628 (QuantReg: 13.64562) QuantErr: 13.64562 batch_time=0.81745 
Train Epoch: 49 [481/500 30784/32000 (96%)] Loss: 0.79100 (QuantReg: 13.59214) QuantErr: 13.59214 batch_time=0.38833 
Train Epoch: 49 [489/500 31296/32000 (98%)] Loss: 0.79037 (QuantReg: 13.18374) QuantErr: 13.18374 batch_time=0.40369 
Train Epoch: 49 [497/500 31808/32000 (99%)] Loss: 1.00493 (QuantReg: 13.77785) QuantErr: 13.77785 batch_time=0.40399 
Train Epoch: 49 codebook_update_time=1.70991
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch49.pth ...
Done in 3.766s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 0.6189832499325275
 quant_reg      : 13.755265592575073
 quant_err      : 13.755265592575073
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 24500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.208
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.04574081552304
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.657
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.21535023927464
 mnt_best       : 46.3298567973894
 not_improved_count: 13
Train Epoch: 50 [1/500 64/32000 (0%)] Loss: 0.49679 (QuantReg: 13.96411) QuantErr: 13.96411 batch_time=24.04377 
Train Epoch: 50 [9/500 576/32000 (2%)] Loss: 0.84717 (QuantReg: 13.56846) QuantErr: 13.56846 batch_time=0.38670 
Train Epoch: 50 [17/500 1088/32000 (3%)] Loss: 0.77682 (QuantReg: 14.26477) QuantErr: 14.26477 batch_time=0.41992 
Train Epoch: 50 [25/500 1600/32000 (5%)] Loss: 0.73766 (QuantReg: 13.55980) QuantErr: 13.55980 batch_time=0.40124 
Train Epoch: 50 [33/500 2112/32000 (7%)] Loss: 0.59187 (QuantReg: 13.89056) QuantErr: 13.89056 batch_time=0.39687 
Train Epoch: 50 [41/500 2624/32000 (8%)] Loss: 0.61882 (QuantReg: 13.56236) QuantErr: 13.56236 batch_time=0.39000 
Train Epoch: 50 [49/500 3136/32000 (10%)] Loss: 0.64543 (QuantReg: 13.59993) QuantErr: 13.59993 batch_time=0.39784 
Train Epoch: 50 [57/500 3648/32000 (11%)] Loss: 0.58578 (QuantReg: 13.64937) QuantErr: 13.64937 batch_time=0.40234 
Train Epoch: 50 [65/500 4160/32000 (13%)] Loss: 0.63324 (QuantReg: 13.81591) QuantErr: 13.81591 batch_time=0.48824 
Train Epoch: 50 [73/500 4672/32000 (15%)] Loss: 0.57344 (QuantReg: 14.22731) QuantErr: 14.22731 batch_time=0.38874 
Train Epoch: 50 [81/500 5184/32000 (16%)] Loss: 0.44499 (QuantReg: 13.42738) QuantErr: 13.42738 batch_time=0.39356 
Train Epoch: 50 [89/500 5696/32000 (18%)] Loss: 0.62223 (QuantReg: 13.70167) QuantErr: 13.70167 batch_time=0.39367 
Train Epoch: 50 [97/500 6208/32000 (19%)] Loss: 0.52637 (QuantReg: 13.65031) QuantErr: 13.65031 batch_time=0.38520 
Train Epoch: 50 [105/500 6720/32000 (21%)] Loss: 0.46461 (QuantReg: 14.01043) QuantErr: 14.01043 batch_time=0.41190 
Train Epoch: 50 [113/500 7232/32000 (23%)] Loss: 0.83354 (QuantReg: 13.53722) QuantErr: 13.53722 batch_time=0.39520 
Train Epoch: 50 [121/500 7744/32000 (24%)] Loss: 0.61207 (QuantReg: 14.03691) QuantErr: 14.03691 batch_time=0.38550 
Train Epoch: 50 [129/500 8256/32000 (26%)] Loss: 0.79118 (QuantReg: 13.51787) QuantErr: 13.51787 batch_time=0.50875 
Train Epoch: 50 [137/500 8768/32000 (27%)] Loss: 0.61847 (QuantReg: 14.05087) QuantErr: 14.05087 batch_time=0.38678 
Train Epoch: 50 [145/500 9280/32000 (29%)] Loss: 0.51349 (QuantReg: 13.68328) QuantErr: 13.68328 batch_time=0.44120 
Train Epoch: 50 [153/500 9792/32000 (31%)] Loss: 0.47263 (QuantReg: 13.68978) QuantErr: 13.68978 batch_time=0.38894 
Train Epoch: 50 [161/500 10304/32000 (32%)] Loss: 0.66794 (QuantReg: 13.45015) QuantErr: 13.45015 batch_time=0.38747 
Train Epoch: 50 [169/500 10816/32000 (34%)] Loss: 0.70115 (QuantReg: 13.94127) QuantErr: 13.94127 batch_time=0.45185 
Train Epoch: 50 [177/500 11328/32000 (35%)] Loss: 0.64331 (QuantReg: 13.76279) QuantErr: 13.76279 batch_time=0.41459 
Train Epoch: 50 [185/500 11840/32000 (37%)] Loss: 0.65425 (QuantReg: 13.80228) QuantErr: 13.80228 batch_time=0.37901 
Train Epoch: 50 [193/500 12352/32000 (39%)] Loss: 0.54722 (QuantReg: 13.72088) QuantErr: 13.72088 batch_time=0.51806 
Train Epoch: 50 [201/500 12864/32000 (40%)] Loss: 0.58199 (QuantReg: 13.60907) QuantErr: 13.60907 batch_time=0.39380 
Train Epoch: 50 [209/500 13376/32000 (42%)] Loss: 0.44052 (QuantReg: 13.65403) QuantErr: 13.65403 batch_time=0.39492 
Train Epoch: 50 [217/500 13888/32000 (43%)] Loss: 0.84478 (QuantReg: 13.76865) QuantErr: 13.76865 batch_time=0.40919 
Train Epoch: 50 [225/500 14400/32000 (45%)] Loss: 0.56825 (QuantReg: 13.59136) QuantErr: 13.59136 batch_time=0.39878 
Train Epoch: 50 [233/500 14912/32000 (47%)] Loss: 0.61675 (QuantReg: 13.97369) QuantErr: 13.97369 batch_time=0.42597 
Train Epoch: 50 [241/500 15424/32000 (48%)] Loss: 0.59396 (QuantReg: 13.61234) QuantErr: 13.61234 batch_time=0.40048 
Train Epoch: 50 [249/500 15936/32000 (50%)] Loss: 0.72630 (QuantReg: 13.73265) QuantErr: 13.73265 batch_time=0.38796 
Train Epoch: 50 [257/500 16448/32000 (51%)] Loss: 0.61230 (QuantReg: 14.09454) QuantErr: 14.09454 batch_time=0.49881 
Train Epoch: 50 [265/500 16960/32000 (53%)] Loss: 0.62672 (QuantReg: 14.03813) QuantErr: 14.03813 batch_time=0.41169 
Train Epoch: 50 [273/500 17472/32000 (55%)] Loss: 0.32393 (QuantReg: 13.54697) QuantErr: 13.54697 batch_time=0.40899 
Train Epoch: 50 [281/500 17984/32000 (56%)] Loss: 0.76620 (QuantReg: 13.71287) QuantErr: 13.71287 batch_time=0.41120 
Train Epoch: 50 [289/500 18496/32000 (58%)] Loss: 0.65069 (QuantReg: 13.75311) QuantErr: 13.75311 batch_time=0.39632 
Train Epoch: 50 [297/500 19008/32000 (59%)] Loss: 0.81311 (QuantReg: 13.92160) QuantErr: 13.92160 batch_time=0.39776 
Train Epoch: 50 [305/500 19520/32000 (61%)] Loss: 0.70524 (QuantReg: 14.01936) QuantErr: 14.01936 batch_time=0.41385 
Train Epoch: 50 [313/500 20032/32000 (63%)] Loss: 0.86503 (QuantReg: 13.70092) QuantErr: 13.70092 batch_time=0.38951 
Train Epoch: 50 [321/500 20544/32000 (64%)] Loss: 0.70248 (QuantReg: 14.09050) QuantErr: 14.09050 batch_time=0.49814 
Train Epoch: 50 [329/500 21056/32000 (66%)] Loss: 0.63201 (QuantReg: 13.90676) QuantErr: 13.90676 batch_time=0.39259 
Train Epoch: 50 [337/500 21568/32000 (67%)] Loss: 0.72134 (QuantReg: 14.02005) QuantErr: 14.02005 batch_time=0.39861 
Train Epoch: 50 [345/500 22080/32000 (69%)] Loss: 0.76785 (QuantReg: 13.85149) QuantErr: 13.85149 batch_time=0.43172 
Train Epoch: 50 [353/500 22592/32000 (71%)] Loss: 0.36291 (QuantReg: 14.03158) QuantErr: 14.03158 batch_time=0.43784 
Train Epoch: 50 [361/500 23104/32000 (72%)] Loss: 0.86817 (QuantReg: 13.81160) QuantErr: 13.81160 batch_time=0.38948 
Train Epoch: 50 [369/500 23616/32000 (74%)] Loss: 0.59310 (QuantReg: 13.81726) QuantErr: 13.81726 batch_time=0.39731 
Train Epoch: 50 [377/500 24128/32000 (75%)] Loss: 0.57495 (QuantReg: 13.51994) QuantErr: 13.51994 batch_time=0.40576 
Train Epoch: 50 [385/500 24640/32000 (77%)] Loss: 0.35652 (QuantReg: 13.95271) QuantErr: 13.95271 batch_time=0.49837 
Train Epoch: 50 [393/500 25152/32000 (79%)] Loss: 0.60265 (QuantReg: 13.82167) QuantErr: 13.82167 batch_time=0.38846 
Train Epoch: 50 [401/500 25664/32000 (80%)] Loss: 0.52915 (QuantReg: 13.30497) QuantErr: 13.30497 batch_time=0.39913 
Train Epoch: 50 [409/500 26176/32000 (82%)] Loss: 0.45874 (QuantReg: 13.75671) QuantErr: 13.75671 batch_time=0.38970 
Train Epoch: 50 [417/500 26688/32000 (83%)] Loss: 0.61578 (QuantReg: 13.88475) QuantErr: 13.88475 batch_time=0.38245 
Train Epoch: 50 [425/500 27200/32000 (85%)] Loss: 0.77679 (QuantReg: 13.55827) QuantErr: 13.55827 batch_time=0.38040 
Train Epoch: 50 [433/500 27712/32000 (87%)] Loss: 0.52859 (QuantReg: 13.93790) QuantErr: 13.93790 batch_time=0.38424 
Train Epoch: 50 [441/500 28224/32000 (88%)] Loss: 0.71194 (QuantReg: 13.40145) QuantErr: 13.40145 batch_time=0.38642 
Train Epoch: 50 [449/500 28736/32000 (90%)] Loss: 0.66546 (QuantReg: 13.83578) QuantErr: 13.83578 batch_time=0.51039 
Train Epoch: 50 [457/500 29248/32000 (91%)] Loss: 0.76614 (QuantReg: 13.33605) QuantErr: 13.33605 batch_time=0.39156 
Train Epoch: 50 [465/500 29760/32000 (93%)] Loss: 0.50891 (QuantReg: 13.84502) QuantErr: 13.84502 batch_time=0.40067 
Train Epoch: 50 [473/500 30272/32000 (95%)] Loss: 0.51145 (QuantReg: 14.01106) QuantErr: 14.01106 batch_time=0.40099 
Train Epoch: 50 [481/500 30784/32000 (96%)] Loss: 0.50057 (QuantReg: 13.69219) QuantErr: 13.69219 batch_time=0.39462 
Train Epoch: 50 [489/500 31296/32000 (98%)] Loss: 0.52874 (QuantReg: 14.10997) QuantErr: 14.10997 batch_time=0.40078 
Train Epoch: 50 [497/500 31808/32000 (99%)] Loss: 0.59096 (QuantReg: 14.01181) QuantErr: 14.01181 batch_time=0.40285 
Train Epoch: 50 codebook_update_time=1.86036
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/checkpoint-epoch50.pth ...
Done in 4.284s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 0.6178930751681327
 quant_reg      : 13.77930329322815
 quant_err      : 13.77930329322815
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 25000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.162
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.445786575343504
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.497
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.380793906662475
 mnt_best       : 46.3298567973894
 not_improved_count: 14
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/trained_model.pth ...
Ckpt loaded at epoch 36.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 26.2
 t2v_metrics/R5/final_eval: 55.9
 t2v_metrics/R10/final_eval: 67.9
 t2v_metrics/R50/final_eval: 88.7
 t2v_metrics/MedR/final_eval: 4.0
 t2v_metrics/MeanR/final_eval: 26.672
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 46.3298567973894
 v2t_metrics/R1/final_eval: 25.5
 v2t_metrics/R5/final_eval: 55.8
 v2t_metrics/R10/final_eval: 69.0
 v2t_metrics/R50/final_eval: 89.9
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 23.3645
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 46.132588479811965
Best epoch for the monitored metric: 36
Script took 04h29m23s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_bs64/trained_model.pth
