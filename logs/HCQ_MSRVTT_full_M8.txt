Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 1004.8526167869568 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 56.97297525405884 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 339.1145224571228 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 179.8552656173706 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch0.pth ...
Done in 19.937s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch0.pth ...
Done in 21.192s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.0
 MSRVTT_full_val/t2v_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R10: 1.408450704225352
 MSRVTT_full_val/t2v_metrics/R50: 10.261569416498993
 MSRVTT_full_val/t2v_metrics/MedR: 256.0
 MSRVTT_full_val/t2v_metrics/MeanR: 255.784708249497
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_val/v2t_metrics/R1: 0.6036217303822937
 MSRVTT_full_val/v2t_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/v2t_metrics/R10: 1.8108651911468814
 MSRVTT_full_val/v2t_metrics/R50: 9.456740442655935
 MSRVTT_full_val/v2t_metrics/MedR: 261.0
 MSRVTT_full_val/v2t_metrics/MeanR: 253.62575452716297
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 1.0968534765586355
 MSRVTT_full_test/t2v_metrics/R1: 0.0
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.26755852842809363
 MSRVTT_full_test/t2v_metrics/R50: 1.806020066889632
 MSRVTT_full_test/t2v_metrics/MedR: 1515.5
 MSRVTT_full_test/t2v_metrics/MeanR: 1499.0869565217392
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/v2t_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/v2t_metrics/R5: 0.10033444816053512
 MSRVTT_full_test/v2t_metrics/R10: 0.23411371237458195
 MSRVTT_full_test/v2t_metrics/R50: 1.6387959866220736
 MSRVTT_full_test/v2t_metrics/MedR: 1508.0
 MSRVTT_full_test/v2t_metrics/MeanR: 1499.62508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.09227171158465285
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.84081 (QuantReg: 10.41589) QuantErr: 10.41589 batch_time=30.26962 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.71243 (QuantReg: 10.45846) QuantErr: 10.45846 batch_time=0.45181 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 6.99767 (QuantReg: 10.44643) QuantErr: 10.44643 batch_time=0.42832 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.79307 (QuantReg: 10.46301) QuantErr: 10.46301 batch_time=0.41866 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.34518 (QuantReg: 10.46748) QuantErr: 10.46748 batch_time=0.42034 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.09780 (QuantReg: 10.46829) QuantErr: 10.46829 batch_time=0.42643 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.99968 (QuantReg: 10.48001) QuantErr: 10.48001 batch_time=0.42222 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.69062 (QuantReg: 10.46861) QuantErr: 10.46861 batch_time=0.45212 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.14933 (QuantReg: 10.45922) QuantErr: 10.45922 batch_time=0.44792 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.43887 (QuantReg: 10.47672) QuantErr: 10.47672 batch_time=0.43232 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.01163 (QuantReg: 10.46512) QuantErr: 10.46512 batch_time=0.43095 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 4.71392 (QuantReg: 10.47134) QuantErr: 10.47134 batch_time=0.42182 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 4.81662 (QuantReg: 10.47748) QuantErr: 10.47748 batch_time=0.42208 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.52486 (QuantReg: 10.46664) QuantErr: 10.46664 batch_time=0.42344 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.71039 (QuantReg: 10.46739) QuantErr: 10.46739 batch_time=0.42388 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 5.02339 (QuantReg: 10.46439) QuantErr: 10.46439 batch_time=0.45115 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.66340 (QuantReg: 10.48095) QuantErr: 10.48095 batch_time=0.42557 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.33601 (QuantReg: 10.46812) QuantErr: 10.46812 batch_time=0.42937 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.37834 (QuantReg: 10.46519) QuantErr: 10.46519 batch_time=0.41272 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.15145 (QuantReg: 10.46621) QuantErr: 10.46621 batch_time=0.42345 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.51902 (QuantReg: 10.48887) QuantErr: 10.48887 batch_time=0.42474 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.14828 (QuantReg: 10.46546) QuantErr: 10.46546 batch_time=0.42464 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.89601 (QuantReg: 10.46412) QuantErr: 10.46412 batch_time=0.43747 
Train Epoch: 1 codebook_update_time=0.73458
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch1.pth ...
Done in 4.272s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch1.pth ...
Done in 8.372s
 epoch          : 1
 loss           : 5.270428429603577
 quant_reg      : 10.466014289855957
 quant_err      : 10.466014289855957
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 17.303822937625753
 MSRVTT_full_val/t2v_metrics/R5: 47.283702213279675
 MSRVTT_full_val/t2v_metrics/R10: 63.38028169014085
 MSRVTT_full_val/t2v_metrics/R50: 93.76257545271629
 MSRVTT_full_val/t2v_metrics/MedR: 6.0
 MSRVTT_full_val/t2v_metrics/MeanR: 15.285714285714286
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 37.29087441507791
 MSRVTT_full_val/v2t_metrics/R1: 16.096579476861166
 MSRVTT_full_val/v2t_metrics/R5: 49.29577464788732
 MSRVTT_full_val/v2t_metrics/R10: 65.3923541247485
 MSRVTT_full_val/v2t_metrics/R50: 93.56136820925553
 MSRVTT_full_val/v2t_metrics/MedR: 6.0
 MSRVTT_full_val/v2t_metrics/MeanR: 16.134808853118713
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 37.29839025716946
 MSRVTT_full_test/t2v_metrics/R1: 4.849498327759197
 MSRVTT_full_test/t2v_metrics/R5: 17.023411371237458
 MSRVTT_full_test/t2v_metrics/R10: 27.59197324414716
 MSRVTT_full_test/t2v_metrics/R50: 62.474916387959865
 MSRVTT_full_test/t2v_metrics/MedR: 29.0
 MSRVTT_full_test/t2v_metrics/MeanR: 84.84749163879599
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 13.157560916640067
 MSRVTT_full_test/v2t_metrics/R1: 4.7157190635451505
 MSRVTT_full_test/v2t_metrics/R5: 16.48829431438127
 MSRVTT_full_test/v2t_metrics/R10: 28.22742474916388
 MSRVTT_full_test/v2t_metrics/R50: 64.0133779264214
 MSRVTT_full_test/v2t_metrics/MedR: 27.0
 MSRVTT_full_test/v2t_metrics/MeanR: 83.18712374581939
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 12.995658921884079
 mnt_best       : 13.157560916640067
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 3.52078 (QuantReg: 3.93827) QuantErr: 3.93827 batch_time=32.72732 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 3.95683 (QuantReg: 4.04028) QuantErr: 4.04028 batch_time=0.42593 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 3.83529 (QuantReg: 4.00665) QuantErr: 4.00665 batch_time=0.74373 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.66206 (QuantReg: 4.10111) QuantErr: 4.10111 batch_time=0.43228 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.63178 (QuantReg: 4.20334) QuantErr: 4.20334 batch_time=0.45561 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 3.82888 (QuantReg: 4.10686) QuantErr: 4.10686 batch_time=0.44216 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 3.89177 (QuantReg: 4.35603) QuantErr: 4.35603 batch_time=0.67001 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.45547 (QuantReg: 4.41485) QuantErr: 4.41485 batch_time=0.45423 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 4.02515 (QuantReg: 4.45270) QuantErr: 4.45270 batch_time=0.42459 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 3.40868 (QuantReg: 4.41834) QuantErr: 4.41834 batch_time=0.44647 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.51202 (QuantReg: 4.36578) QuantErr: 4.36578 batch_time=0.45129 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.24299 (QuantReg: 4.60918) QuantErr: 4.60918 batch_time=0.43831 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.21917 (QuantReg: 4.51407) QuantErr: 4.51407 batch_time=0.41372 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 3.37244 (QuantReg: 4.63244) QuantErr: 4.63244 batch_time=2.28195 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.25186 (QuantReg: 4.61885) QuantErr: 4.61885 batch_time=0.42902 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.13764 (QuantReg: 4.84775) QuantErr: 4.84775 batch_time=0.45158 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.44746 (QuantReg: 4.76477) QuantErr: 4.76477 batch_time=0.80121 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.42396 (QuantReg: 4.83709) QuantErr: 4.83709 batch_time=0.42721 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.12067 (QuantReg: 4.71216) QuantErr: 4.71216 batch_time=0.42950 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.01903 (QuantReg: 4.90172) QuantErr: 4.90172 batch_time=0.44403 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 2.76121 (QuantReg: 4.94818) QuantErr: 4.94818 batch_time=0.45645 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.85588 (QuantReg: 4.85427) QuantErr: 4.85427 batch_time=0.43628 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.44366 (QuantReg: 5.11180) QuantErr: 5.11180 batch_time=0.42854 
Train Epoch: 2 codebook_update_time=0.54291
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch2.pth ...
Done in 5.325s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch2.pth ...
Done in 9.723s
removing stale ckpt [epoch 1] [took 0.22s]
removing stale ckpt [epoch 0] [took 0.29s]
 epoch          : 2
 loss           : 3.4985016498565673
 quant_reg      : 4.515330714225769
 quant_err      : 4.515330714225769
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 20.72434607645875
 MSRVTT_full_val/t2v_metrics/R5: 54.929577464788736
 MSRVTT_full_val/t2v_metrics/R10: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R50: 94.96981891348088
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.916498993963783
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.036470797313896
 MSRVTT_full_val/v2t_metrics/R1: 18.91348088531187
 MSRVTT_full_val/v2t_metrics/R5: 55.53319919517103
 MSRVTT_full_val/v2t_metrics/R10: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.753521126760564
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 42.72329224035926
 MSRVTT_full_test/t2v_metrics/R1: 6.053511705685619
 MSRVTT_full_test/t2v_metrics/R5: 21.40468227424749
 MSRVTT_full_test/t2v_metrics/R10: 33.34448160535117
 MSRVTT_full_test/t2v_metrics/R50: 68.82943143812709
 MSRVTT_full_test/t2v_metrics/MedR: 22.0
 MSRVTT_full_test/t2v_metrics/MeanR: 70.35685618729097
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 16.28721067705829
 MSRVTT_full_test/v2t_metrics/R1: 5.8193979933110365
 MSRVTT_full_test/v2t_metrics/R5: 20.468227424749163
 MSRVTT_full_test/v2t_metrics/R10: 33.47826086956522
 MSRVTT_full_test/v2t_metrics/R50: 71.27090301003345
 MSRVTT_full_test/v2t_metrics/MedR: 20.0
 MSRVTT_full_test/v2t_metrics/MeanR: 65.511872909699
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 15.857707186327293
 mnt_best       : 16.28721067705829
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 2.94739 (QuantReg: 4.09143) QuantErr: 4.09143 batch_time=34.85014 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.17153 (QuantReg: 4.13820) QuantErr: 4.13820 batch_time=0.42738 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.50718 (QuantReg: 4.36065) QuantErr: 4.36065 batch_time=0.40974 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 2.60968 (QuantReg: 3.97129) QuantErr: 3.97129 batch_time=0.46267 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.20563 (QuantReg: 4.16827) QuantErr: 4.16827 batch_time=0.44945 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 2.67406 (QuantReg: 4.25700) QuantErr: 4.25700 batch_time=0.41353 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 2.83700 (QuantReg: 4.22274) QuantErr: 4.22274 batch_time=0.43137 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.05542 (QuantReg: 4.20841) QuantErr: 4.20841 batch_time=0.46214 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.04124 (QuantReg: 4.23575) QuantErr: 4.23575 batch_time=0.43388 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 2.78280 (QuantReg: 4.20082) QuantErr: 4.20082 batch_time=0.47002 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 2.90516 (QuantReg: 4.19403) QuantErr: 4.19403 batch_time=0.55859 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 2.52754 (QuantReg: 4.31204) QuantErr: 4.31204 batch_time=0.45214 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.06662 (QuantReg: 4.39019) QuantErr: 4.39019 batch_time=0.41146 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 2.83204 (QuantReg: 4.39914) QuantErr: 4.39914 batch_time=0.43362 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.51613 (QuantReg: 4.26842) QuantErr: 4.26842 batch_time=0.42624 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.23234 (QuantReg: 4.62626) QuantErr: 4.62626 batch_time=0.40899 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 2.51420 (QuantReg: 4.39721) QuantErr: 4.39721 batch_time=0.40944 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.13171 (QuantReg: 4.34732) QuantErr: 4.34732 batch_time=0.42236 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 2.60163 (QuantReg: 4.37116) QuantErr: 4.37116 batch_time=0.44496 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 2.81140 (QuantReg: 4.51979) QuantErr: 4.51979 batch_time=4.08347 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 2.60059 (QuantReg: 4.57905) QuantErr: 4.57905 batch_time=0.42023 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 2.31581 (QuantReg: 4.62025) QuantErr: 4.62025 batch_time=0.44721 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 2.65322 (QuantReg: 4.56353) QuantErr: 4.56353 batch_time=0.40499 
Train Epoch: 3 codebook_update_time=0.50314
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch3.pth ...
Done in 4.728s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch3.pth ...
Done in 10.207s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 2.892693028450012
 quant_reg      : 4.347379230499268
 quant_err      : 4.347379230499268
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 22.736418511066397
 MSRVTT_full_val/t2v_metrics/R5: 57.34406438631791
 MSRVTT_full_val/t2v_metrics/R10: 75.0503018108652
 MSRVTT_full_val/t2v_metrics/R50: 95.17102615694165
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.795774647887324
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.080903931599295
 MSRVTT_full_val/v2t_metrics/R1: 18.309859154929576
 MSRVTT_full_val/v2t_metrics/R5: 59.15492957746479
 MSRVTT_full_val/v2t_metrics/R10: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 11.715291750503019
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 43.511472968262126
 MSRVTT_full_test/t2v_metrics/R1: 6.789297658862877
 MSRVTT_full_test/t2v_metrics/R5: 23.645484949832777
 MSRVTT_full_test/t2v_metrics/R10: 35.585284280936456
 MSRVTT_full_test/t2v_metrics/R50: 70.63545150501672
 MSRVTT_full_test/t2v_metrics/MedR: 19.0
 MSRVTT_full_test/t2v_metrics/MeanR: 65.35735785953177
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 17.876445597247404
 MSRVTT_full_test/v2t_metrics/R1: 6.086956521739131
 MSRVTT_full_test/v2t_metrics/R5: 21.906354515050168
 MSRVTT_full_test/v2t_metrics/R10: 35.25083612040134
 MSRVTT_full_test/v2t_metrics/R50: 72.90969899665552
 MSRVTT_full_test/v2t_metrics/MedR: 19.0
 MSRVTT_full_test/v2t_metrics/MeanR: 64.60117056856188
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 16.751225228082927
 mnt_best       : 17.876445597247404
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 3.16083 (QuantReg: 4.02932) QuantErr: 4.02932 batch_time=34.65030 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.67307 (QuantReg: 4.13101) QuantErr: 4.13101 batch_time=0.44349 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.18899 (QuantReg: 4.15714) QuantErr: 4.15714 batch_time=0.41635 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.39756 (QuantReg: 4.16638) QuantErr: 4.16638 batch_time=0.65485 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.67487 (QuantReg: 4.13498) QuantErr: 4.13498 batch_time=0.41512 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 2.93732 (QuantReg: 4.18202) QuantErr: 4.18202 batch_time=0.42610 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.94726 (QuantReg: 4.23725) QuantErr: 4.23725 batch_time=0.41590 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.72135 (QuantReg: 4.32918) QuantErr: 4.32918 batch_time=0.43283 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 2.53292 (QuantReg: 4.24617) QuantErr: 4.24617 batch_time=0.43106 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.49094 (QuantReg: 4.27735) QuantErr: 4.27735 batch_time=0.42509 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 2.67064 (QuantReg: 4.34588) QuantErr: 4.34588 batch_time=0.45610 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.58907 (QuantReg: 4.31901) QuantErr: 4.31901 batch_time=0.42429 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 2.50170 (QuantReg: 4.32216) QuantErr: 4.32216 batch_time=0.73536 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.67077 (QuantReg: 4.42407) QuantErr: 4.42407 batch_time=0.43519 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.87373 (QuantReg: 4.46057) QuantErr: 4.46057 batch_time=0.42132 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.87278 (QuantReg: 4.59231) QuantErr: 4.59231 batch_time=0.43127 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.91806 (QuantReg: 4.37362) QuantErr: 4.37362 batch_time=0.43420 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.72254 (QuantReg: 4.60853) QuantErr: 4.60853 batch_time=0.43304 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.69811 (QuantReg: 4.41803) QuantErr: 4.41803 batch_time=0.42997 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.34851 (QuantReg: 4.44038) QuantErr: 4.44038 batch_time=0.41887 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.32926 (QuantReg: 4.61207) QuantErr: 4.61207 batch_time=0.43193 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.61973 (QuantReg: 4.34520) QuantErr: 4.34520 batch_time=0.43186 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.44622 (QuantReg: 4.40191) QuantErr: 4.40191 batch_time=0.44051 
Train Epoch: 4 codebook_update_time=0.57790
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch4.pth ...
Done in 21.510s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch4.pth ...
Done in 28.161s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 2.5917731709480285
 quant_reg      : 4.346382976531983
 quant_err      : 4.346382976531983
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 20.925553319919516
 MSRVTT_full_val/t2v_metrics/R5: 57.947686116700204
 MSRVTT_full_val/t2v_metrics/R10: 71.62977867203219
 MSRVTT_full_val/t2v_metrics/R50: 95.17102615694165
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 12.00503018108652
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 44.286247851069085
 MSRVTT_full_val/v2t_metrics/R1: 21.52917505030181
 MSRVTT_full_val/v2t_metrics/R5: 61.16700201207244
 MSRVTT_full_val/v2t_metrics/R10: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.962776659959758
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 46.06858295066429
 MSRVTT_full_test/t2v_metrics/R1: 6.956521739130435
 MSRVTT_full_test/t2v_metrics/R5: 23.645484949832777
 MSRVTT_full_test/t2v_metrics/R10: 35.719063545150505
 MSRVTT_full_test/t2v_metrics/R50: 70.5685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 20.0
 MSRVTT_full_test/t2v_metrics/MeanR: 66.19046822742474
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.04458141886266
 MSRVTT_full_test/v2t_metrics/R1: 6.2207357859531776
 MSRVTT_full_test/v2t_metrics/R5: 21.471571906354516
 MSRVTT_full_test/v2t_metrics/R10: 34.71571906354515
 MSRVTT_full_test/v2t_metrics/R50: 72.77591973244147
 MSRVTT_full_test/v2t_metrics/MedR: 18.0
 MSRVTT_full_test/v2t_metrics/MeanR: 62.02190635451505
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 16.675438138790874
 mnt_best       : 18.04458141886266
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.53514 (QuantReg: 4.27822) QuantErr: 4.27822 batch_time=39.93617 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 2.69207 (QuantReg: 4.31029) QuantErr: 4.31029 batch_time=0.70336 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.74408 (QuantReg: 4.26858) QuantErr: 4.26858 batch_time=0.43106 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.11636 (QuantReg: 4.34776) QuantErr: 4.34776 batch_time=0.43436 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.27421 (QuantReg: 4.17192) QuantErr: 4.17192 batch_time=0.42521 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.36420 (QuantReg: 4.62518) QuantErr: 4.62518 batch_time=0.42516 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.35207 (QuantReg: 4.32865) QuantErr: 4.32865 batch_time=0.43391 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 2.59393 (QuantReg: 4.30951) QuantErr: 4.30951 batch_time=0.41930 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.17772 (QuantReg: 4.36406) QuantErr: 4.36406 batch_time=0.42355 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.54503 (QuantReg: 4.36160) QuantErr: 4.36160 batch_time=0.44502 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.25763 (QuantReg: 4.47508) QuantErr: 4.47508 batch_time=0.44143 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.27717 (QuantReg: 4.48382) QuantErr: 4.48382 batch_time=0.43937 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.48132 (QuantReg: 4.47388) QuantErr: 4.47388 batch_time=0.41970 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 1.69804 (QuantReg: 4.51852) QuantErr: 4.51852 batch_time=0.43307 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.32230 (QuantReg: 4.56326) QuantErr: 4.56326 batch_time=0.42816 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.24022 (QuantReg: 4.51563) QuantErr: 4.51563 batch_time=0.43289 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.15326 (QuantReg: 4.72029) QuantErr: 4.72029 batch_time=0.47716 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.53389 (QuantReg: 4.40645) QuantErr: 4.40645 batch_time=0.42720 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.09856 (QuantReg: 4.53424) QuantErr: 4.53424 batch_time=0.42365 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.34201 (QuantReg: 4.45525) QuantErr: 4.45525 batch_time=0.43120 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.28937 (QuantReg: 4.53039) QuantErr: 4.53039 batch_time=0.42291 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 1.88278 (QuantReg: 4.53195) QuantErr: 4.53195 batch_time=0.42348 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.22783 (QuantReg: 4.50159) QuantErr: 4.50159 batch_time=0.42108 
Train Epoch: 5 codebook_update_time=0.53359
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch5.pth ...
Done in 5.693s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch5.pth ...
Done in 29.720s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 2.3050312314033508
 quant_reg      : 4.421734962463379
 quant_err      : 4.421734962463379
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 22.93762575452716
 MSRVTT_full_val/t2v_metrics/R5: 59.356136820925556
 MSRVTT_full_val/t2v_metrics/R10: 74.84909456740442
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.211267605633802
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.70896172826622
 MSRVTT_full_val/v2t_metrics/R1: 24.547283702213278
 MSRVTT_full_val/v2t_metrics/R5: 59.95975855130785
 MSRVTT_full_val/v2t_metrics/R10: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 10.60261569416499
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.0668946367564
 MSRVTT_full_test/t2v_metrics/R1: 7.357859531772576
 MSRVTT_full_test/t2v_metrics/R5: 24.381270903010034
 MSRVTT_full_test/t2v_metrics/R10: 37.65886287625418
 MSRVTT_full_test/t2v_metrics/R50: 74.14715719063545
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.852508361204016
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.904201808945366
 MSRVTT_full_test/v2t_metrics/R1: 6.0200668896321075
 MSRVTT_full_test/v2t_metrics/R5: 24.74916387959866
 MSRVTT_full_test/v2t_metrics/R10: 37.82608695652174
 MSRVTT_full_test/v2t_metrics/R50: 74.84949832775919
 MSRVTT_full_test/v2t_metrics/MedR: 16.75
 MSRVTT_full_test/v2t_metrics/MeanR: 56.61304347826087
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.7958097806596
 mnt_best       : 18.904201808945366
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.39547 (QuantReg: 4.29808) QuantErr: 4.29808 batch_time=38.87155 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.42669 (QuantReg: 4.14888) QuantErr: 4.14888 batch_time=0.43505 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 1.85029 (QuantReg: 4.33362) QuantErr: 4.33362 batch_time=0.43189 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.33250 (QuantReg: 4.28001) QuantErr: 4.28001 batch_time=0.42762 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 1.72540 (QuantReg: 4.32427) QuantErr: 4.32427 batch_time=0.42820 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 1.92809 (QuantReg: 4.51351) QuantErr: 4.51351 batch_time=0.42585 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.06503 (QuantReg: 4.58483) QuantErr: 4.58483 batch_time=0.43127 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 1.70690 (QuantReg: 4.38789) QuantErr: 4.38789 batch_time=0.43288 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.33771 (QuantReg: 4.43167) QuantErr: 4.43167 batch_time=0.42807 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.07846 (QuantReg: 4.49299) QuantErr: 4.49299 batch_time=1.67270 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.12480 (QuantReg: 4.26729) QuantErr: 4.26729 batch_time=0.44585 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.05311 (QuantReg: 4.54866) QuantErr: 4.54866 batch_time=0.45117 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.06686 (QuantReg: 4.36463) QuantErr: 4.36463 batch_time=0.43359 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.26846 (QuantReg: 4.31606) QuantErr: 4.31606 batch_time=0.42860 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 1.79355 (QuantReg: 4.49351) QuantErr: 4.49351 batch_time=0.42420 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 1.93793 (QuantReg: 4.43716) QuantErr: 4.43716 batch_time=0.44256 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.26415 (QuantReg: 4.58303) QuantErr: 4.58303 batch_time=0.47506 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 1.95191 (QuantReg: 4.68754) QuantErr: 4.68754 batch_time=0.44003 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.15066 (QuantReg: 4.50271) QuantErr: 4.50271 batch_time=1.09511 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 1.84194 (QuantReg: 4.47708) QuantErr: 4.47708 batch_time=0.45632 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 1.87499 (QuantReg: 4.54457) QuantErr: 4.54457 batch_time=0.42612 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.05191 (QuantReg: 4.46857) QuantErr: 4.46857 batch_time=0.41699 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.06120 (QuantReg: 4.45317) QuantErr: 4.45317 batch_time=0.42849 
Train Epoch: 6 codebook_update_time=0.57438
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch6.pth ...
Done in 5.210s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch6.pth ...
Done in 10.073s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 2.125503788948059
 quant_reg      : 4.4372782859802244
 quant_err      : 4.4372782859802244
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 22.93762575452716
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.250503018108652
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.02686909062078
 MSRVTT_full_val/v2t_metrics/R1: 24.547283702213278
 MSRVTT_full_val/v2t_metrics/R5: 63.17907444668008
 MSRVTT_full_val/v2t_metrics/R10: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.667002012072434
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.21466786022391
 MSRVTT_full_test/t2v_metrics/R1: 7.391304347826087
 MSRVTT_full_test/t2v_metrics/R5: 25.351170568561873
 MSRVTT_full_test/t2v_metrics/R10: 38.06020066889632
 MSRVTT_full_test/t2v_metrics/R50: 74.51505016722408
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.9190635451505
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.248492645772654
 MSRVTT_full_test/v2t_metrics/R1: 7.357859531772576
 MSRVTT_full_test/v2t_metrics/R5: 25.551839464882942
 MSRVTT_full_test/v2t_metrics/R10: 39.46488294314381
 MSRVTT_full_test/v2t_metrics/R50: 75.61872909698997
 MSRVTT_full_test/v2t_metrics/MedR: 16.0
 MSRVTT_full_test/v2t_metrics/MeanR: 54.79648829431438
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.50420085044309
 mnt_best       : 19.248492645772654
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.17233 (QuantReg: 4.10346) QuantErr: 4.10346 batch_time=33.42652 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 1.79661 (QuantReg: 4.55505) QuantErr: 4.55505 batch_time=1.92510 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.22958 (QuantReg: 4.50466) QuantErr: 4.50466 batch_time=0.41921 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.07548 (QuantReg: 4.52632) QuantErr: 4.52632 batch_time=0.42329 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 1.88965 (QuantReg: 4.38088) QuantErr: 4.38088 batch_time=0.42715 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.14173 (QuantReg: 4.44665) QuantErr: 4.44665 batch_time=0.43168 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.02541 (QuantReg: 4.55933) QuantErr: 4.55933 batch_time=0.41821 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.23837 (QuantReg: 4.47670) QuantErr: 4.47670 batch_time=0.46972 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.19010 (QuantReg: 4.44720) QuantErr: 4.44720 batch_time=0.44344 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 1.93146 (QuantReg: 4.46424) QuantErr: 4.46424 batch_time=0.42023 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.31573 (QuantReg: 4.46790) QuantErr: 4.46790 batch_time=0.41945 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 1.56812 (QuantReg: 4.63931) QuantErr: 4.63931 batch_time=0.42299 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 1.71868 (QuantReg: 4.43426) QuantErr: 4.43426 batch_time=0.67244 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.12837 (QuantReg: 4.45764) QuantErr: 4.45764 batch_time=0.42431 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.03811 (QuantReg: 4.36793) QuantErr: 4.36793 batch_time=0.44246 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 1.72196 (QuantReg: 4.53449) QuantErr: 4.53449 batch_time=1.63834 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 1.71164 (QuantReg: 4.62303) QuantErr: 4.62303 batch_time=0.44498 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.02882 (QuantReg: 4.45273) QuantErr: 4.45273 batch_time=0.65580 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.50222 (QuantReg: 4.58648) QuantErr: 4.58648 batch_time=0.42223 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 1.70796 (QuantReg: 4.60664) QuantErr: 4.60664 batch_time=0.42829 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.36422 (QuantReg: 4.53178) QuantErr: 4.53178 batch_time=0.44723 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 1.91236 (QuantReg: 4.47089) QuantErr: 4.47089 batch_time=0.45056 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.11397 (QuantReg: 4.40502) QuantErr: 4.40502 batch_time=0.42573 
Train Epoch: 7 codebook_update_time=0.56153
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch7.pth ...
Done in 17.564s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch7.pth ...
Done in 22.254s
removing stale ckpt [epoch 6] [took 0.12s]
 epoch          : 7
 loss           : 1.978088342666626
 quant_reg      : 4.5097449626922606
 quant_err      : 4.5097449626922606
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 23.541247484909455
 MSRVTT_full_val/t2v_metrics/R5: 61.971830985915496
 MSRVTT_full_val/t2v_metrics/R10: 74.24547283702213
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.00503018108652
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.66847512204428
 MSRVTT_full_val/v2t_metrics/R1: 23.34004024144869
 MSRVTT_full_val/v2t_metrics/R5: 64.1851106639839
 MSRVTT_full_val/v2t_metrics/R10: 78.67203219315896
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.987927565392354
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.02889302233402
 MSRVTT_full_test/t2v_metrics/R1: 8.160535117056856
 MSRVTT_full_test/t2v_metrics/R5: 25.7190635451505
 MSRVTT_full_test/t2v_metrics/R10: 39.79933110367893
 MSRVTT_full_test/t2v_metrics/R50: 75.01672240802675
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.81739130434783
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.290053282971616
 MSRVTT_full_test/v2t_metrics/R1: 6.688963210702341
 MSRVTT_full_test/v2t_metrics/R5: 24.08026755852843
 MSRVTT_full_test/v2t_metrics/R10: 39.130434782608695
 MSRVTT_full_test/v2t_metrics/R50: 75.78595317725753
 MSRVTT_full_test/v2t_metrics/MedR: 16.0
 MSRVTT_full_test/v2t_metrics/MeanR: 55.261872909698994
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 18.471901168928206
 mnt_best       : 20.290053282971616
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 1.89664 (QuantReg: 4.51290) QuantErr: 4.51290 batch_time=36.20837 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.08899 (QuantReg: 4.59568) QuantErr: 4.59568 batch_time=0.43007 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.48786 (QuantReg: 4.38858) QuantErr: 4.38858 batch_time=0.54216 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 1.91060 (QuantReg: 4.60894) QuantErr: 4.60894 batch_time=1.09430 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.00945 (QuantReg: 4.55414) QuantErr: 4.55414 batch_time=0.44419 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 1.99420 (QuantReg: 4.46572) QuantErr: 4.46572 batch_time=0.42722 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 1.74218 (QuantReg: 4.68740) QuantErr: 4.68740 batch_time=0.42949 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 1.70271 (QuantReg: 4.68025) QuantErr: 4.68025 batch_time=0.43095 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.00441 (QuantReg: 4.65621) QuantErr: 4.65621 batch_time=0.69215 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 1.85901 (QuantReg: 4.52866) QuantErr: 4.52866 batch_time=0.42667 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 1.80417 (QuantReg: 4.66159) QuantErr: 4.66159 batch_time=0.43032 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.54056 (QuantReg: 4.64286) QuantErr: 4.64286 batch_time=0.42654 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 1.71723 (QuantReg: 4.54636) QuantErr: 4.54636 batch_time=0.42763 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 1.72759 (QuantReg: 4.55843) QuantErr: 4.55843 batch_time=0.42505 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.25147 (QuantReg: 4.71331) QuantErr: 4.71331 batch_time=0.41758 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 1.59733 (QuantReg: 4.55499) QuantErr: 4.55499 batch_time=0.43732 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.16834 (QuantReg: 4.60882) QuantErr: 4.60882 batch_time=0.42940 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.07349 (QuantReg: 4.70307) QuantErr: 4.70307 batch_time=0.42647 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 1.51136 (QuantReg: 4.62101) QuantErr: 4.62101 batch_time=2.34368 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 1.35392 (QuantReg: 4.54133) QuantErr: 4.54133 batch_time=2.78146 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 1.50494 (QuantReg: 4.78743) QuantErr: 4.78743 batch_time=0.42092 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 1.13975 (QuantReg: 4.56681) QuantErr: 4.56681 batch_time=0.43017 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 1.48999 (QuantReg: 4.56993) QuantErr: 4.56993 batch_time=0.42015 
Train Epoch: 8 codebook_update_time=0.57357
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch8.pth ...
Done in 17.479s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 1.8729741110801696
 quant_reg      : 4.562961771011352
 quant_err      : 4.562961771011352
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 21.93158953722334
 MSRVTT_full_val/t2v_metrics/R5: 58.75251509054326
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.770623742454728
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.61143712384109
 MSRVTT_full_val/v2t_metrics/R1: 22.334004024144868
 MSRVTT_full_val/v2t_metrics/R5: 64.1851106639839
 MSRVTT_full_val/v2t_metrics/R10: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.427565392354126
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 47.940506654320934
 MSRVTT_full_test/t2v_metrics/R1: 7.357859531772576
 MSRVTT_full_test/t2v_metrics/R5: 26.48829431438127
 MSRVTT_full_test/t2v_metrics/R10: 39.130434782608695
 MSRVTT_full_test/t2v_metrics/R50: 73.61204013377926
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.55484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.683699202941675
 MSRVTT_full_test/v2t_metrics/R1: 7.6923076923076925
 MSRVTT_full_test/v2t_metrics/R5: 25.25083612040134
 MSRVTT_full_test/v2t_metrics/R10: 39.86622073578595
 MSRVTT_full_test/v2t_metrics/R50: 75.88628762541806
 MSRVTT_full_test/v2t_metrics/MedR: 16.75
 MSRVTT_full_test/v2t_metrics/MeanR: 53.921070234113714
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.783926627546627
 mnt_best       : 20.290053282971616
 not_improved_count: 1
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 2.07318 (QuantReg: 4.36005) QuantErr: 4.36005 batch_time=39.59177 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 1.76998 (QuantReg: 4.42774) QuantErr: 4.42774 batch_time=4.87202 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.11975 (QuantReg: 4.47249) QuantErr: 4.47249 batch_time=0.42119 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.05393 (QuantReg: 4.54136) QuantErr: 4.54136 batch_time=0.40991 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.13765 (QuantReg: 4.47506) QuantErr: 4.47506 batch_time=0.42284 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 1.99930 (QuantReg: 4.52262) QuantErr: 4.52262 batch_time=0.41417 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.69628 (QuantReg: 4.49555) QuantErr: 4.49555 batch_time=0.42858 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.49738 (QuantReg: 4.57737) QuantErr: 4.57737 batch_time=0.44205 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.06858 (QuantReg: 4.46594) QuantErr: 4.46594 batch_time=0.44109 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.74895 (QuantReg: 4.54593) QuantErr: 4.54593 batch_time=0.41636 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 1.77884 (QuantReg: 4.52026) QuantErr: 4.52026 batch_time=0.43154 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.70436 (QuantReg: 4.65514) QuantErr: 4.65514 batch_time=0.41350 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 1.88260 (QuantReg: 4.64097) QuantErr: 4.64097 batch_time=0.43437 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 1.88585 (QuantReg: 4.69296) QuantErr: 4.69296 batch_time=0.43106 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 1.92736 (QuantReg: 4.68255) QuantErr: 4.68255 batch_time=0.41484 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.86835 (QuantReg: 4.55526) QuantErr: 4.55526 batch_time=0.41138 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 1.36911 (QuantReg: 4.64624) QuantErr: 4.64624 batch_time=0.42582 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.45137 (QuantReg: 4.64978) QuantErr: 4.64978 batch_time=0.41836 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 1.58699 (QuantReg: 4.74312) QuantErr: 4.74312 batch_time=0.44177 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.57578 (QuantReg: 4.52509) QuantErr: 4.52509 batch_time=0.43170 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.62383 (QuantReg: 4.60854) QuantErr: 4.60854 batch_time=0.41333 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.72133 (QuantReg: 4.64977) QuantErr: 4.64977 batch_time=0.42060 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.14306 (QuantReg: 4.68705) QuantErr: 4.68705 batch_time=0.55618 
Train Epoch: 9 codebook_update_time=0.58044
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch9.pth ...
Done in 21.309s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch9.pth ...
Done in 25.497s
removing stale ckpt [epoch 8] [took 0.04s]
 epoch          : 9
 loss           : 1.7515954074859619
 quant_reg      : 4.595602165222168
 quant_err      : 4.595602165222168
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 21.730382293762574
 MSRVTT_full_val/t2v_metrics/R5: 64.38631790744466
 MSRVTT_full_val/t2v_metrics/R10: 76.45875251509054
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.01609657947686
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.47111014043745
 MSRVTT_full_val/v2t_metrics/R1: 22.132796780684103
 MSRVTT_full_val/v2t_metrics/R5: 64.58752515090544
 MSRVTT_full_val/v2t_metrics/R10: 79.67806841046277
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.5
 MSRVTT_full_val/v2t_metrics/MeanR: 9.009054325955734
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 48.47389440232432
 MSRVTT_full_test/t2v_metrics/R1: 8.02675585284281
 MSRVTT_full_test/t2v_metrics/R5: 26.354515050167223
 MSRVTT_full_test/t2v_metrics/R10: 40.0
 MSRVTT_full_test/t2v_metrics/R50: 76.12040133779264
 MSRVTT_full_test/t2v_metrics/MedR: 15.25
 MSRVTT_full_test/t2v_metrics/MeanR: 53.93344481605351
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.377537043347424
 MSRVTT_full_test/v2t_metrics/R1: 7.759197324414716
 MSRVTT_full_test/v2t_metrics/R5: 25.7190635451505
 MSRVTT_full_test/v2t_metrics/R10: 41.03678929765886
 MSRVTT_full_test/v2t_metrics/R50: 77.4247491638796
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.681939799331104
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.156499285339436
 mnt_best       : 20.377537043347424
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.41778 (QuantReg: 4.43661) QuantErr: 4.43661 batch_time=35.44395 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 1.69989 (QuantReg: 4.60428) QuantErr: 4.60428 batch_time=6.05553 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 1.48688 (QuantReg: 4.47477) QuantErr: 4.47477 batch_time=0.42257 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 1.34995 (QuantReg: 4.45177) QuantErr: 4.45177 batch_time=0.72203 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 1.52827 (QuantReg: 4.78727) QuantErr: 4.78727 batch_time=0.43615 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 2.25427 (QuantReg: 4.61826) QuantErr: 4.61826 batch_time=0.41563 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 1.45523 (QuantReg: 4.66929) QuantErr: 4.66929 batch_time=0.44599 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 1.66029 (QuantReg: 4.47375) QuantErr: 4.47375 batch_time=0.42277 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 1.68005 (QuantReg: 4.55560) QuantErr: 4.55560 batch_time=0.42922 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.16070 (QuantReg: 4.52607) QuantErr: 4.52607 batch_time=0.45857 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.44752 (QuantReg: 4.62768) QuantErr: 4.62768 batch_time=0.45511 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 1.89620 (QuantReg: 4.68508) QuantErr: 4.68508 batch_time=0.46092 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 2.01484 (QuantReg: 4.61637) QuantErr: 4.61637 batch_time=0.45606 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 2.16862 (QuantReg: 4.72335) QuantErr: 4.72335 batch_time=0.46116 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.42158 (QuantReg: 4.75520) QuantErr: 4.75520 batch_time=0.42603 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 1.31579 (QuantReg: 4.70460) QuantErr: 4.70460 batch_time=0.48464 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 2.56165 (QuantReg: 4.64905) QuantErr: 4.64905 batch_time=0.41836 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 1.48313 (QuantReg: 4.85808) QuantErr: 4.85808 batch_time=0.42659 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.33285 (QuantReg: 4.83961) QuantErr: 4.83961 batch_time=0.42841 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.57405 (QuantReg: 4.61803) QuantErr: 4.61803 batch_time=0.44824 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.48850 (QuantReg: 4.50327) QuantErr: 4.50327 batch_time=0.42502 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 2.14372 (QuantReg: 4.66594) QuantErr: 4.66594 batch_time=0.42735 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 1.89670 (QuantReg: 4.61227) QuantErr: 4.61227 batch_time=0.41435 
Train Epoch: 10 codebook_update_time=0.56120
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch10.pth ...
Done in 22.116s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch10.pth ...
Done in 26.235s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 1.6593117852211
 quant_reg      : 4.623949541091919
 quant_err      : 4.623949541091919
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 22.334004024144868
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 76.05633802816901
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.335010060362173
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.11461858335751
 MSRVTT_full_val/v2t_metrics/R1: 24.949698189134807
 MSRVTT_full_val/v2t_metrics/R5: 64.38631790744466
 MSRVTT_full_val/v2t_metrics/R10: 78.87323943661971
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.935613682092555
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.22610745271086
 MSRVTT_full_test/t2v_metrics/R1: 8.528428093645484
 MSRVTT_full_test/t2v_metrics/R5: 26.956521739130434
 MSRVTT_full_test/t2v_metrics/R10: 40.50167224080268
 MSRVTT_full_test/t2v_metrics/R50: 76.38795986622074
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.65953177257525
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.03787805763255
 MSRVTT_full_test/v2t_metrics/R1: 7.591973244147157
 MSRVTT_full_test/v2t_metrics/R5: 27.05685618729097
 MSRVTT_full_test/v2t_metrics/R10: 41.80602006688963
 MSRVTT_full_test/v2t_metrics/R50: 78.39464882943143
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.199665551839466
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.478129054048978
 mnt_best       : 21.03787805763255
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 1.54209 (QuantReg: 4.54045) QuantErr: 4.54045 batch_time=38.96645 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 1.39036 (QuantReg: 4.65613) QuantErr: 4.65613 batch_time=0.41319 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 1.59550 (QuantReg: 4.46751) QuantErr: 4.46751 batch_time=0.44964 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 1.62113 (QuantReg: 4.66014) QuantErr: 4.66014 batch_time=0.43415 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 1.74527 (QuantReg: 4.76167) QuantErr: 4.76167 batch_time=0.44624 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 1.40027 (QuantReg: 4.69238) QuantErr: 4.69238 batch_time=0.42398 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 1.81414 (QuantReg: 4.54769) QuantErr: 4.54769 batch_time=0.41547 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 1.48873 (QuantReg: 4.73436) QuantErr: 4.73436 batch_time=0.41331 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.55517 (QuantReg: 4.59923) QuantErr: 4.59923 batch_time=0.42696 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.84705 (QuantReg: 4.58068) QuantErr: 4.58068 batch_time=0.43414 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.83910 (QuantReg: 4.50190) QuantErr: 4.50190 batch_time=0.52681 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.61622 (QuantReg: 4.78217) QuantErr: 4.78217 batch_time=0.41849 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 2.06455 (QuantReg: 4.57497) QuantErr: 4.57497 batch_time=0.44432 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.73535 (QuantReg: 4.59454) QuantErr: 4.59454 batch_time=0.42764 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.56495 (QuantReg: 4.53373) QuantErr: 4.53373 batch_time=0.41570 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 1.61131 (QuantReg: 4.55915) QuantErr: 4.55915 batch_time=0.41136 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.64337 (QuantReg: 4.52414) QuantErr: 4.52414 batch_time=0.42570 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.23762 (QuantReg: 4.65530) QuantErr: 4.65530 batch_time=0.41230 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.34209 (QuantReg: 4.90532) QuantErr: 4.90532 batch_time=0.42297 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.65350 (QuantReg: 4.76608) QuantErr: 4.76608 batch_time=0.42081 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.62592 (QuantReg: 4.89540) QuantErr: 4.89540 batch_time=0.41239 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.39696 (QuantReg: 4.75912) QuantErr: 4.75912 batch_time=0.44025 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.25488 (QuantReg: 4.88729) QuantErr: 4.88729 batch_time=0.41175 
Train Epoch: 11 codebook_update_time=0.50107
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch11.pth ...
Done in 4.207s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 1.5729141850471497
 quant_reg      : 4.685614976882935
 quant_err      : 4.685614976882935
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 20.72434607645875
 MSRVTT_full_val/t2v_metrics/R5: 60.160965794768615
 MSRVTT_full_val/t2v_metrics/R10: 73.44064386317908
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.887323943661972
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.072402066196
 MSRVTT_full_val/v2t_metrics/R1: 25.150905432595575
 MSRVTT_full_val/v2t_metrics/R5: 63.78269617706238
 MSRVTT_full_val/v2t_metrics/R10: 78.87323943661971
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.5
 MSRVTT_full_val/v2t_metrics/MeanR: 9.364185110663984
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 50.20289077578949
 MSRVTT_full_test/t2v_metrics/R1: 7.892976588628763
 MSRVTT_full_test/t2v_metrics/R5: 26.421404682274247
 MSRVTT_full_test/t2v_metrics/R10: 40.936454849498325
 MSRVTT_full_test/t2v_metrics/R50: 75.21739130434783
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.68411371237458
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.437870783190284
 MSRVTT_full_test/v2t_metrics/R1: 8.160535117056856
 MSRVTT_full_test/v2t_metrics/R5: 27.32441471571906
 MSRVTT_full_test/v2t_metrics/R10: 41.93979933110368
 MSRVTT_full_test/v2t_metrics/R50: 77.92642140468227
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.010200668896324
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.068419224313285
 mnt_best       : 21.03787805763255
 not_improved_count: 1
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.57689 (QuantReg: 4.65690) QuantErr: 4.65690 batch_time=30.23377 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.85177 (QuantReg: 4.70244) QuantErr: 4.70244 batch_time=0.42616 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.31850 (QuantReg: 4.59776) QuantErr: 4.59776 batch_time=0.41662 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 1.36775 (QuantReg: 4.65589) QuantErr: 4.65589 batch_time=0.42627 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.26314 (QuantReg: 4.77128) QuantErr: 4.77128 batch_time=0.43173 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.50160 (QuantReg: 4.67869) QuantErr: 4.67869 batch_time=0.42859 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.35156 (QuantReg: 4.70850) QuantErr: 4.70850 batch_time=2.80268 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.49224 (QuantReg: 4.69494) QuantErr: 4.69494 batch_time=0.41839 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.39602 (QuantReg: 4.63925) QuantErr: 4.63925 batch_time=0.42381 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.73938 (QuantReg: 4.66509) QuantErr: 4.66509 batch_time=0.42660 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.19623 (QuantReg: 4.65452) QuantErr: 4.65452 batch_time=0.41055 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.64639 (QuantReg: 4.68376) QuantErr: 4.68376 batch_time=0.43168 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.27164 (QuantReg: 4.71574) QuantErr: 4.71574 batch_time=0.60177 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.28831 (QuantReg: 4.90265) QuantErr: 4.90265 batch_time=0.42248 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.70450 (QuantReg: 4.62681) QuantErr: 4.62681 batch_time=0.45219 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.13532 (QuantReg: 4.68711) QuantErr: 4.68711 batch_time=0.42603 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.22184 (QuantReg: 4.68222) QuantErr: 4.68222 batch_time=0.44857 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.88708 (QuantReg: 4.63521) QuantErr: 4.63521 batch_time=0.46545 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.55851 (QuantReg: 4.65395) QuantErr: 4.65395 batch_time=0.42683 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.84773 (QuantReg: 4.69694) QuantErr: 4.69694 batch_time=0.43352 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.52058 (QuantReg: 4.53726) QuantErr: 4.53726 batch_time=0.41443 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.48414 (QuantReg: 4.81615) QuantErr: 4.81615 batch_time=0.41821 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.59277 (QuantReg: 4.87356) QuantErr: 4.87356 batch_time=0.42257 
Train Epoch: 12 codebook_update_time=0.98758
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch12.pth ...
Done in 11.036s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch12.pth ...
Done in 26.293s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 1.5090293874740601
 quant_reg      : 4.705820320129394
 quant_err      : 4.705820320129394
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 22.535211267605632
 MSRVTT_full_val/t2v_metrics/R5: 63.17907444668008
 MSRVTT_full_val/t2v_metrics/R10: 77.06237424547284
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.554325955734406
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.873196479885166
 MSRVTT_full_val/v2t_metrics/R1: 26.156941649899398
 MSRVTT_full_val/v2t_metrics/R5: 63.38028169014085
 MSRVTT_full_val/v2t_metrics/R10: 80.0804828973843
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.861167002012072
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.013987410903795
 MSRVTT_full_test/t2v_metrics/R1: 8.361204013377927
 MSRVTT_full_test/t2v_metrics/R5: 27.4247491638796
 MSRVTT_full_test/t2v_metrics/R10: 41.60535117056856
 MSRVTT_full_test/t2v_metrics/R50: 76.32107023411372
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.27993311036789
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.209001629912564
 MSRVTT_full_test/v2t_metrics/R1: 8.327759197324415
 MSRVTT_full_test/v2t_metrics/R5: 28.06020066889632
 MSRVTT_full_test/v2t_metrics/R10: 42.34113712374582
 MSRVTT_full_test/v2t_metrics/R50: 79.23076923076923
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 49.531939799331106
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.468110213433842
 mnt_best       : 21.209001629912564
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.33861 (QuantReg: 4.72204) QuantErr: 4.72204 batch_time=34.15397 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.95706 (QuantReg: 4.46299) QuantErr: 4.46299 batch_time=0.41537 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.53248 (QuantReg: 4.82273) QuantErr: 4.82273 batch_time=0.44058 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.30730 (QuantReg: 4.75126) QuantErr: 4.75126 batch_time=0.41826 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.38348 (QuantReg: 4.72735) QuantErr: 4.72735 batch_time=0.52305 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.50576 (QuantReg: 4.78953) QuantErr: 4.78953 batch_time=0.43100 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.52510 (QuantReg: 4.85525) QuantErr: 4.85525 batch_time=0.44758 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.79588 (QuantReg: 4.88090) QuantErr: 4.88090 batch_time=0.44541 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.20604 (QuantReg: 4.56955) QuantErr: 4.56955 batch_time=0.43282 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.66363 (QuantReg: 4.72205) QuantErr: 4.72205 batch_time=0.42192 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.56335 (QuantReg: 4.69218) QuantErr: 4.69218 batch_time=0.41443 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.05805 (QuantReg: 4.81342) QuantErr: 4.81342 batch_time=0.46148 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.38781 (QuantReg: 4.74650) QuantErr: 4.74650 batch_time=0.44591 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.40175 (QuantReg: 4.82381) QuantErr: 4.82381 batch_time=0.44030 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.75465 (QuantReg: 4.70269) QuantErr: 4.70269 batch_time=0.42265 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.33740 (QuantReg: 4.69323) QuantErr: 4.69323 batch_time=0.41720 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.12676 (QuantReg: 4.83160) QuantErr: 4.83160 batch_time=0.43553 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.85673 (QuantReg: 4.73050) QuantErr: 4.73050 batch_time=0.41560 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.28993 (QuantReg: 4.87648) QuantErr: 4.87648 batch_time=1.81706 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.83251 (QuantReg: 4.80953) QuantErr: 4.80953 batch_time=0.42989 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.75709 (QuantReg: 4.78065) QuantErr: 4.78065 batch_time=0.42101 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.32798 (QuantReg: 4.75856) QuantErr: 4.75856 batch_time=0.44298 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.40640 (QuantReg: 4.76084) QuantErr: 4.76084 batch_time=0.46618 
Train Epoch: 13 codebook_update_time=0.50892
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch13.pth ...
Done in 5.009s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch13.pth ...
Done in 10.042s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 1.4499056379795074
 quant_reg      : 4.751164018630981
 quant_err      : 4.751164018630981
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 61.3682092555332
 MSRVTT_full_val/t2v_metrics/R10: 76.65995975855131
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.11066398390342
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.697331083857655
 MSRVTT_full_val/v2t_metrics/R1: 25.553319919517104
 MSRVTT_full_val/v2t_metrics/R5: 66.19718309859155
 MSRVTT_full_val/v2t_metrics/R10: 79.07444668008048
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.508048289738431
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.14160273871056
 MSRVTT_full_test/t2v_metrics/R1: 8.79598662207358
 MSRVTT_full_test/t2v_metrics/R5: 28.896321070234112
 MSRVTT_full_test/t2v_metrics/R10: 42.30769230769231
 MSRVTT_full_test/t2v_metrics/R50: 76.78929765886288
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.76270903010033
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.072362353175464
 MSRVTT_full_test/v2t_metrics/R1: 9.665551839464882
 MSRVTT_full_test/v2t_metrics/R5: 30.367892976588628
 MSRVTT_full_test/v2t_metrics/R10: 44.11371237458194
 MSRVTT_full_test/v2t_metrics/R50: 79.76588628762542
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.287290969899665
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.482174296708106
 mnt_best       : 22.072362353175464
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.25306 (QuantReg: 4.77162) QuantErr: 4.77162 batch_time=35.33690 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.88866 (QuantReg: 4.83390) QuantErr: 4.83390 batch_time=0.44659 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.40495 (QuantReg: 4.82274) QuantErr: 4.82274 batch_time=0.44553 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.31861 (QuantReg: 4.69500) QuantErr: 4.69500 batch_time=0.43257 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.75339 (QuantReg: 4.74421) QuantErr: 4.74421 batch_time=0.41735 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.42319 (QuantReg: 4.71272) QuantErr: 4.71272 batch_time=0.42438 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.67210 (QuantReg: 4.75281) QuantErr: 4.75281 batch_time=0.43331 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.71373 (QuantReg: 4.54754) QuantErr: 4.54754 batch_time=0.41371 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.02810 (QuantReg: 4.65184) QuantErr: 4.65184 batch_time=0.42527 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.33121 (QuantReg: 4.67113) QuantErr: 4.67113 batch_time=0.42119 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.30085 (QuantReg: 4.80512) QuantErr: 4.80512 batch_time=0.41841 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.66487 (QuantReg: 4.60024) QuantErr: 4.60024 batch_time=0.42378 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.24190 (QuantReg: 4.87222) QuantErr: 4.87222 batch_time=0.42011 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.10592 (QuantReg: 4.80685) QuantErr: 4.80685 batch_time=0.43710 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.40992 (QuantReg: 4.75979) QuantErr: 4.75979 batch_time=0.42649 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.17768 (QuantReg: 4.82652) QuantErr: 4.82652 batch_time=0.44556 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.16660 (QuantReg: 4.72308) QuantErr: 4.72308 batch_time=0.44641 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.68361 (QuantReg: 4.92965) QuantErr: 4.92965 batch_time=0.43904 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.37341 (QuantReg: 4.68530) QuantErr: 4.68530 batch_time=0.43742 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.66739 (QuantReg: 4.71521) QuantErr: 4.71521 batch_time=0.43541 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.45826 (QuantReg: 4.87800) QuantErr: 4.87800 batch_time=0.43011 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.35563 (QuantReg: 4.88830) QuantErr: 4.88830 batch_time=0.44379 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.38270 (QuantReg: 4.78941) QuantErr: 4.78941 batch_time=0.45184 
Train Epoch: 14 codebook_update_time=0.54081
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch14.pth ...
Done in 4.167s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 1.4185642523765565
 quant_reg      : 4.771180925369262
 quant_err      : 4.771180925369262
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 22.334004024144868
 MSRVTT_full_val/t2v_metrics/R5: 60.96579476861167
 MSRVTT_full_val/t2v_metrics/R10: 74.84909456740442
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.661971830985916
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.71035059454305
 MSRVTT_full_val/v2t_metrics/R1: 25.150905432595575
 MSRVTT_full_val/v2t_metrics/R5: 65.99597585513078
 MSRVTT_full_val/v2t_metrics/R10: 80.0804828973843
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.943661971830986
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.03474167983742
 MSRVTT_full_test/t2v_metrics/R1: 8.160535117056856
 MSRVTT_full_test/t2v_metrics/R5: 26.153846153846153
 MSRVTT_full_test/t2v_metrics/R10: 39.59866220735786
 MSRVTT_full_test/t2v_metrics/R50: 74.21404682274247
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 59.34314381270903
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.369400108099253
 MSRVTT_full_test/v2t_metrics/R1: 8.66220735785953
 MSRVTT_full_test/v2t_metrics/R5: 29.19732441471572
 MSRVTT_full_test/v2t_metrics/R10: 41.40468227424749
 MSRVTT_full_test/v2t_metrics/R50: 77.79264214046823
 MSRVTT_full_test/v2t_metrics/MedR: 14.0
 MSRVTT_full_test/v2t_metrics/MeanR: 53.20602006688963
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.877970337105452
 mnt_best       : 22.072362353175464
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.80347 (QuantReg: 4.68100) QuantErr: 4.68100 batch_time=34.16301 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.29822 (QuantReg: 4.72988) QuantErr: 4.72988 batch_time=0.41775 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.34904 (QuantReg: 4.79083) QuantErr: 4.79083 batch_time=0.42900 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.52886 (QuantReg: 4.68915) QuantErr: 4.68915 batch_time=0.42968 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.44442 (QuantReg: 4.84974) QuantErr: 4.84974 batch_time=0.42995 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.61477 (QuantReg: 4.62453) QuantErr: 4.62453 batch_time=0.43619 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.70775 (QuantReg: 4.71090) QuantErr: 4.71090 batch_time=3.25781 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.20061 (QuantReg: 4.76414) QuantErr: 4.76414 batch_time=0.41386 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.70909 (QuantReg: 4.76490) QuantErr: 4.76490 batch_time=0.42678 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.29874 (QuantReg: 4.77634) QuantErr: 4.77634 batch_time=0.41033 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.60071 (QuantReg: 4.79806) QuantErr: 4.79806 batch_time=0.41898 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.18505 (QuantReg: 4.68481) QuantErr: 4.68481 batch_time=0.50150 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.35124 (QuantReg: 4.71836) QuantErr: 4.71836 batch_time=0.44072 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.58124 (QuantReg: 4.85070) QuantErr: 4.85070 batch_time=0.42549 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.45457 (QuantReg: 4.69711) QuantErr: 4.69711 batch_time=1.24138 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.40853 (QuantReg: 4.90222) QuantErr: 4.90222 batch_time=0.43134 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.59960 (QuantReg: 4.93072) QuantErr: 4.93072 batch_time=0.41310 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.30155 (QuantReg: 4.85794) QuantErr: 4.85794 batch_time=0.41471 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.29003 (QuantReg: 4.86960) QuantErr: 4.86960 batch_time=0.41843 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.53022 (QuantReg: 4.66548) QuantErr: 4.66548 batch_time=0.43300 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.65041 (QuantReg: 4.81942) QuantErr: 4.81942 batch_time=0.45808 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.50260 (QuantReg: 4.84182) QuantErr: 4.84182 batch_time=0.41370 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.50344 (QuantReg: 4.70833) QuantErr: 4.70833 batch_time=0.41911 
Train Epoch: 15 codebook_update_time=0.55587
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch15.pth ...
Done in 3.950s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 1.3700817942619323
 quant_reg      : 4.797497495651245
 quant_err      : 4.797497495651245
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 23.138832997987926
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.010060362173038
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.33005101215014
 MSRVTT_full_val/v2t_metrics/R1: 27.766599597585515
 MSRVTT_full_val/v2t_metrics/R5: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R10: 82.69617706237425
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.933601609657948
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.167242594937186
 MSRVTT_full_test/t2v_metrics/R1: 8.729096989966555
 MSRVTT_full_test/t2v_metrics/R5: 28.494983277591974
 MSRVTT_full_test/t2v_metrics/R10: 42.74247491638796
 MSRVTT_full_test/t2v_metrics/R50: 77.6923076923077
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.119565217391305
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.988678544789753
 MSRVTT_full_test/v2t_metrics/R1: 9.698996655518394
 MSRVTT_full_test/v2t_metrics/R5: 30.702341137123746
 MSRVTT_full_test/v2t_metrics/R10: 44.381270903010034
 MSRVTT_full_test/v2t_metrics/R50: 80.40133779264214
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 47.34264214046823
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.642823802179688
 mnt_best       : 22.072362353175464
 not_improved_count: 2
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.25520 (QuantReg: 4.58083) QuantErr: 4.58083 batch_time=36.60814 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.30026 (QuantReg: 4.89805) QuantErr: 4.89805 batch_time=0.42848 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.56648 (QuantReg: 4.78538) QuantErr: 4.78538 batch_time=0.42523 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 1.24870 (QuantReg: 4.87947) QuantErr: 4.87947 batch_time=0.42536 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.22470 (QuantReg: 4.77307) QuantErr: 4.77307 batch_time=0.42686 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.41917 (QuantReg: 4.67785) QuantErr: 4.67785 batch_time=0.41818 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.45339 (QuantReg: 4.93869) QuantErr: 4.93869 batch_time=0.41982 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.27408 (QuantReg: 4.80962) QuantErr: 4.80962 batch_time=1.67895 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.23801 (QuantReg: 4.97179) QuantErr: 4.97179 batch_time=0.42568 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.21914 (QuantReg: 4.86217) QuantErr: 4.86217 batch_time=0.42614 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.47115 (QuantReg: 5.06079) QuantErr: 5.06079 batch_time=0.41622 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.40333 (QuantReg: 4.88999) QuantErr: 4.88999 batch_time=0.42989 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.45466 (QuantReg: 4.86757) QuantErr: 4.86757 batch_time=0.43228 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.17544 (QuantReg: 4.88857) QuantErr: 4.88857 batch_time=1.40988 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.36816 (QuantReg: 4.91622) QuantErr: 4.91622 batch_time=0.79535 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.28670 (QuantReg: 4.87584) QuantErr: 4.87584 batch_time=0.76633 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.46183 (QuantReg: 4.70189) QuantErr: 4.70189 batch_time=0.41463 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.03489 (QuantReg: 4.87087) QuantErr: 4.87087 batch_time=0.42749 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.40254 (QuantReg: 4.95304) QuantErr: 4.95304 batch_time=0.41885 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.31566 (QuantReg: 4.91651) QuantErr: 4.91651 batch_time=0.42753 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.07123 (QuantReg: 4.89222) QuantErr: 4.89222 batch_time=0.42709 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.31255 (QuantReg: 4.75606) QuantErr: 4.75606 batch_time=0.55574 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.28848 (QuantReg: 4.99867) QuantErr: 4.99867 batch_time=0.42501 
Train Epoch: 16 codebook_update_time=0.51367
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch16.pth ...
Done in 15.443s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 1.348165701150894
 quant_reg      : 4.838809661865234
 quant_err      : 4.838809661865234
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 62.97786720321932
 MSRVTT_full_val/t2v_metrics/R10: 77.06237424547284
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.360160965794769
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.47265412484579
 MSRVTT_full_val/v2t_metrics/R1: 25.955734406438633
 MSRVTT_full_val/v2t_metrics/R5: 67.80684104627767
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.856136820925553
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 52.473117784761925
 MSRVTT_full_test/t2v_metrics/R1: 8.896321070234114
 MSRVTT_full_test/t2v_metrics/R5: 28.160535117056856
 MSRVTT_full_test/t2v_metrics/R10: 42.77591973244147
 MSRVTT_full_test/t2v_metrics/R50: 76.98996655518394
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 51.215886287625416
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.047037250410547
 MSRVTT_full_test/v2t_metrics/R1: 8.695652173913043
 MSRVTT_full_test/v2t_metrics/R5: 30.96989966555184
 MSRVTT_full_test/v2t_metrics/R10: 45.752508361204015
 MSRVTT_full_test/v2t_metrics/R50: 80.3010033444816
 MSRVTT_full_test/v2t_metrics/MedR: 12.25
 MSRVTT_full_test/v2t_metrics/MeanR: 46.155685618729095
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.096825277724157
 mnt_best       : 22.072362353175464
 not_improved_count: 3
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.26348 (QuantReg: 4.74886) QuantErr: 4.74886 batch_time=31.38114 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.48179 (QuantReg: 4.82509) QuantErr: 4.82509 batch_time=0.42506 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.15173 (QuantReg: 4.79248) QuantErr: 4.79248 batch_time=0.41595 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.14513 (QuantReg: 4.71041) QuantErr: 4.71041 batch_time=0.43687 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.51115 (QuantReg: 4.77392) QuantErr: 4.77392 batch_time=0.44327 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.18180 (QuantReg: 4.71044) QuantErr: 4.71044 batch_time=0.41543 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.03644 (QuantReg: 5.01107) QuantErr: 5.01107 batch_time=0.42203 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.43586 (QuantReg: 4.81981) QuantErr: 4.81981 batch_time=0.58888 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.19645 (QuantReg: 4.97843) QuantErr: 4.97843 batch_time=0.42876 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.36028 (QuantReg: 4.93543) QuantErr: 4.93543 batch_time=0.42444 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.29226 (QuantReg: 4.92821) QuantErr: 4.92821 batch_time=0.41175 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.33979 (QuantReg: 4.76456) QuantErr: 4.76456 batch_time=0.42473 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.14422 (QuantReg: 4.79906) QuantErr: 4.79906 batch_time=0.44954 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.73090 (QuantReg: 4.81008) QuantErr: 4.81008 batch_time=0.40771 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.22955 (QuantReg: 5.04378) QuantErr: 5.04378 batch_time=0.41261 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.10802 (QuantReg: 4.73894) QuantErr: 4.73894 batch_time=0.41174 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.18384 (QuantReg: 4.80766) QuantErr: 4.80766 batch_time=0.42842 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.18996 (QuantReg: 4.92016) QuantErr: 4.92016 batch_time=0.41024 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.55453 (QuantReg: 5.03458) QuantErr: 5.03458 batch_time=0.41754 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.31283 (QuantReg: 4.97144) QuantErr: 4.97144 batch_time=0.52757 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.11221 (QuantReg: 4.86725) QuantErr: 4.86725 batch_time=0.42271 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.38796 (QuantReg: 5.09500) QuantErr: 5.09500 batch_time=0.44229 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.29689 (QuantReg: 4.86304) QuantErr: 4.86304 batch_time=0.42027 
Train Epoch: 17 codebook_update_time=0.52268
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch17.pth ...
Done in 4.181s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch17.pth ...
Done in 8.088s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 1.2989713683128357
 quant_reg      : 4.87603844833374
 quant_err      : 4.87603844833374
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 23.138832997987926
 MSRVTT_full_val/t2v_metrics/R5: 63.38028169014085
 MSRVTT_full_val/t2v_metrics/R10: 77.46478873239437
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.142857142857142
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.432102099816134
 MSRVTT_full_val/v2t_metrics/R1: 27.16297786720322
 MSRVTT_full_val/v2t_metrics/R5: 68.2092555331992
 MSRVTT_full_val/v2t_metrics/R10: 82.49496981891348
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.448692152917506
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.46661863399408
 MSRVTT_full_test/t2v_metrics/R1: 8.963210702341136
 MSRVTT_full_test/t2v_metrics/R5: 28.62876254180602
 MSRVTT_full_test/t2v_metrics/R10: 42.84280936454849
 MSRVTT_full_test/t2v_metrics/R50: 76.72240802675586
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.872742474916386
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.235558442531747
 MSRVTT_full_test/v2t_metrics/R1: 9.464882943143813
 MSRVTT_full_test/v2t_metrics/R5: 30.234113712374583
 MSRVTT_full_test/v2t_metrics/R10: 45.11705685618729
 MSRVTT_full_test/v2t_metrics/R50: 79.86622073578596
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.7747491638796
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.459445907753718
 mnt_best       : 22.235558442531747
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.44707 (QuantReg: 4.88590) QuantErr: 4.88590 batch_time=39.62522 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.31855 (QuantReg: 4.95090) QuantErr: 4.95090 batch_time=0.41041 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.26762 (QuantReg: 4.83483) QuantErr: 4.83483 batch_time=0.41034 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.26123 (QuantReg: 4.80514) QuantErr: 4.80514 batch_time=0.44328 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.34198 (QuantReg: 4.86933) QuantErr: 4.86933 batch_time=0.40906 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.33077 (QuantReg: 4.90910) QuantErr: 4.90910 batch_time=0.41101 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.67801 (QuantReg: 4.82897) QuantErr: 4.82897 batch_time=0.44370 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.40781 (QuantReg: 4.91821) QuantErr: 4.91821 batch_time=0.42464 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.18234 (QuantReg: 4.82961) QuantErr: 4.82961 batch_time=0.41833 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.23268 (QuantReg: 4.84725) QuantErr: 4.84725 batch_time=0.41584 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.14044 (QuantReg: 4.87767) QuantErr: 4.87767 batch_time=0.41043 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.64646 (QuantReg: 4.84130) QuantErr: 4.84130 batch_time=0.42169 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.75603 (QuantReg: 5.00364) QuantErr: 5.00364 batch_time=0.43196 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.08840 (QuantReg: 4.84975) QuantErr: 4.84975 batch_time=0.44735 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.37127 (QuantReg: 4.94388) QuantErr: 4.94388 batch_time=0.44988 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.56745 (QuantReg: 4.98296) QuantErr: 4.98296 batch_time=0.41443 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.17328 (QuantReg: 4.92791) QuantErr: 4.92791 batch_time=0.42667 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.09965 (QuantReg: 4.91465) QuantErr: 4.91465 batch_time=0.43481 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.25768 (QuantReg: 4.88314) QuantErr: 4.88314 batch_time=0.41026 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.58614 (QuantReg: 4.94604) QuantErr: 4.94604 batch_time=0.43475 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.27198 (QuantReg: 4.92453) QuantErr: 4.92453 batch_time=0.41008 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 0.90647 (QuantReg: 4.91219) QuantErr: 4.91219 batch_time=0.40913 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.11924 (QuantReg: 4.99852) QuantErr: 4.99852 batch_time=0.41524 
Train Epoch: 18 codebook_update_time=0.53932
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch18.pth ...
Done in 3.944s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 1.272072976589203
 quant_reg      : 4.888646059036255
 quant_err      : 4.888646059036255
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 24.346076458752513
 MSRVTT_full_val/t2v_metrics/R5: 63.78269617706238
 MSRVTT_full_val/t2v_metrics/R10: 76.65995975855131
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.830985915492958
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.19264193226719
 MSRVTT_full_val/v2t_metrics/R1: 27.364185110663986
 MSRVTT_full_val/v2t_metrics/R5: 69.81891348088531
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.61871227364185
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.92868037985824
 MSRVTT_full_test/t2v_metrics/R1: 8.66220735785953
 MSRVTT_full_test/t2v_metrics/R5: 27.859531772575252
 MSRVTT_full_test/t2v_metrics/R10: 42.14046822742475
 MSRVTT_full_test/t2v_metrics/R50: 77.02341137123746
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.93478260869565
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.665426783373416
 MSRVTT_full_test/v2t_metrics/R1: 8.82943143812709
 MSRVTT_full_test/v2t_metrics/R5: 29.431438127090303
 MSRVTT_full_test/v2t_metrics/R10: 44.180602006688964
 MSRVTT_full_test/v2t_metrics/R50: 79.93311036789298
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 47.52876254180602
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.559282558749786
 mnt_best       : 22.235558442531747
 not_improved_count: 1
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.16897 (QuantReg: 4.91367) QuantErr: 4.91367 batch_time=42.87662 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.27417 (QuantReg: 4.94130) QuantErr: 4.94130 batch_time=0.44255 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.45253 (QuantReg: 4.80861) QuantErr: 4.80861 batch_time=0.41638 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.32291 (QuantReg: 4.96099) QuantErr: 4.96099 batch_time=0.42759 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.19914 (QuantReg: 4.95820) QuantErr: 4.95820 batch_time=0.41336 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.35845 (QuantReg: 4.99893) QuantErr: 4.99893 batch_time=0.42913 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.21815 (QuantReg: 4.87834) QuantErr: 4.87834 batch_time=0.43906 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.60370 (QuantReg: 4.96588) QuantErr: 4.96588 batch_time=0.41097 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.33130 (QuantReg: 4.78423) QuantErr: 4.78423 batch_time=0.42750 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.17291 (QuantReg: 4.91549) QuantErr: 4.91549 batch_time=0.45722 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.07517 (QuantReg: 4.97259) QuantErr: 4.97259 batch_time=0.42941 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.25903 (QuantReg: 4.94817) QuantErr: 4.94817 batch_time=0.40744 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.36568 (QuantReg: 4.95551) QuantErr: 4.95551 batch_time=0.43011 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 0.88260 (QuantReg: 4.80919) QuantErr: 4.80919 batch_time=0.41069 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.38594 (QuantReg: 4.97686) QuantErr: 4.97686 batch_time=0.41833 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 0.88088 (QuantReg: 4.82330) QuantErr: 4.82330 batch_time=0.50737 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.35615 (QuantReg: 4.95568) QuantErr: 4.95568 batch_time=0.42576 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.46224 (QuantReg: 4.97397) QuantErr: 4.97397 batch_time=0.42561 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.26533 (QuantReg: 4.94309) QuantErr: 4.94309 batch_time=0.41600 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 0.87872 (QuantReg: 4.98357) QuantErr: 4.98357 batch_time=0.42066 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 0.89288 (QuantReg: 4.98038) QuantErr: 4.98038 batch_time=0.42682 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.04687 (QuantReg: 4.97246) QuantErr: 4.97246 batch_time=0.40933 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.14196 (QuantReg: 4.89582) QuantErr: 4.89582 batch_time=0.44540 
Train Epoch: 19 codebook_update_time=0.57232
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch19.pth ...
Done in 4.497s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch19.pth ...
Done in 8.808s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 1.2420757122039794
 quant_reg      : 4.915091606140137
 quant_err      : 4.915091606140137
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_full_val/t2v_metrics/R1: 22.535211267605632
 MSRVTT_full_val/t2v_metrics/R5: 61.3682092555332
 MSRVTT_full_val/t2v_metrics/R10: 76.45875251509054
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.71327967806841
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.287254269881906
 MSRVTT_full_val/v2t_metrics/R1: 25.955734406438633
 MSRVTT_full_val/v2t_metrics/R5: 67.20321931589537
 MSRVTT_full_val/v2t_metrics/R10: 78.67203219315896
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.961770623742455
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.57999029674603
 MSRVTT_full_test/t2v_metrics/R1: 9.03010033444816
 MSRVTT_full_test/t2v_metrics/R5: 29.297658862876254
 MSRVTT_full_test/t2v_metrics/R10: 43.01003344481605
 MSRVTT_full_test/t2v_metrics/R50: 75.7190635451505
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.15752508361204
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.492190749856913
 MSRVTT_full_test/v2t_metrics/R1: 9.063545150501673
 MSRVTT_full_test/v2t_metrics/R5: 31.036789297658864
 MSRVTT_full_test/v2t_metrics/R10: 45.51839464882943
 MSRVTT_full_test/v2t_metrics/R50: 80.16722408026756
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 47.01304347826087
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.394868537414407
 mnt_best       : 22.492190749856913
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.36594 (QuantReg: 4.85387) QuantErr: 4.85387 batch_time=39.85669 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.36399 (QuantReg: 4.82587) QuantErr: 4.82587 batch_time=0.66158 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.24579 (QuantReg: 4.85862) QuantErr: 4.85862 batch_time=0.45269 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.23570 (QuantReg: 5.03096) QuantErr: 5.03096 batch_time=0.43422 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.32752 (QuantReg: 5.02483) QuantErr: 5.02483 batch_time=0.45010 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.22198 (QuantReg: 4.81124) QuantErr: 4.81124 batch_time=0.42180 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.15652 (QuantReg: 5.00835) QuantErr: 5.00835 batch_time=0.42172 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.01312 (QuantReg: 4.87210) QuantErr: 4.87210 batch_time=0.76752 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.58071 (QuantReg: 4.81341) QuantErr: 4.81341 batch_time=0.43826 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.15739 (QuantReg: 5.04541) QuantErr: 5.04541 batch_time=0.45696 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.09490 (QuantReg: 5.08076) QuantErr: 5.08076 batch_time=0.43244 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.01483 (QuantReg: 4.92335) QuantErr: 4.92335 batch_time=0.43430 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.28655 (QuantReg: 4.91932) QuantErr: 4.91932 batch_time=0.45027 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.39415 (QuantReg: 4.87019) QuantErr: 4.87019 batch_time=2.53266 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.37863 (QuantReg: 4.83765) QuantErr: 4.83765 batch_time=0.43134 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.53938 (QuantReg: 4.97974) QuantErr: 4.97974 batch_time=0.41577 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.24287 (QuantReg: 5.14960) QuantErr: 5.14960 batch_time=0.56115 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.11013 (QuantReg: 5.08008) QuantErr: 5.08008 batch_time=0.42777 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.04149 (QuantReg: 4.87632) QuantErr: 4.87632 batch_time=0.42910 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.57278 (QuantReg: 4.83396) QuantErr: 4.83396 batch_time=0.44083 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.76908 (QuantReg: 4.83082) QuantErr: 4.83082 batch_time=0.42578 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.18083 (QuantReg: 4.96371) QuantErr: 4.96371 batch_time=0.41700 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 0.90559 (QuantReg: 5.15477) QuantErr: 5.15477 batch_time=0.45158 
Train Epoch: 20 codebook_update_time=0.53146
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch20.pth ...
Done in 4.569s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch20.pth ...
Done in 8.291s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 1.2373964104652404
 quant_reg      : 4.933424934387207
 quant_err      : 4.933424934387207
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 78.26961770623743
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.578470824949699
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.08502277473392
 MSRVTT_full_val/v2t_metrics/R1: 30.985915492957748
 MSRVTT_full_val/v2t_metrics/R5: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R10: 82.69617706237425
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.673038229376258
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.18459737744875
 MSRVTT_full_test/t2v_metrics/R1: 9.063545150501673
 MSRVTT_full_test/t2v_metrics/R5: 29.899665551839465
 MSRVTT_full_test/t2v_metrics/R10: 44.448160535117054
 MSRVTT_full_test/t2v_metrics/R50: 76.92307692307692
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.10953177257525
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.923067955914327
 MSRVTT_full_test/v2t_metrics/R1: 9.264214046822742
 MSRVTT_full_test/v2t_metrics/R5: 31.204013377926422
 MSRVTT_full_test/v2t_metrics/R10: 46.187290969899664
 MSRVTT_full_test/v2t_metrics/R50: 80.5351170568562
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.27859531772575
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.723595409013022
 mnt_best       : 22.923067955914327
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.11856 (QuantReg: 4.90433) QuantErr: 4.90433 batch_time=38.13363 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.22302 (QuantReg: 4.96881) QuantErr: 4.96881 batch_time=0.42598 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.21015 (QuantReg: 4.87757) QuantErr: 4.87757 batch_time=0.41811 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.05637 (QuantReg: 5.04989) QuantErr: 5.04989 batch_time=0.45548 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 0.96803 (QuantReg: 4.90521) QuantErr: 4.90521 batch_time=0.41388 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.03032 (QuantReg: 5.14242) QuantErr: 5.14242 batch_time=0.45647 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.23572 (QuantReg: 4.89834) QuantErr: 4.89834 batch_time=0.43954 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.39651 (QuantReg: 4.87084) QuantErr: 4.87084 batch_time=0.44888 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.35563 (QuantReg: 4.99116) QuantErr: 4.99116 batch_time=0.41742 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.27761 (QuantReg: 4.90671) QuantErr: 4.90671 batch_time=0.44302 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.15951 (QuantReg: 4.85543) QuantErr: 4.85543 batch_time=0.43490 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.20822 (QuantReg: 5.01064) QuantErr: 5.01064 batch_time=0.42341 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 0.98643 (QuantReg: 4.81266) QuantErr: 4.81266 batch_time=0.42164 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.29629 (QuantReg: 5.05991) QuantErr: 5.05991 batch_time=0.53799 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.22729 (QuantReg: 4.89958) QuantErr: 4.89958 batch_time=1.00709 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.06221 (QuantReg: 5.09800) QuantErr: 5.09800 batch_time=0.46276 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.43916 (QuantReg: 5.12037) QuantErr: 5.12037 batch_time=0.41874 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.18557 (QuantReg: 4.87444) QuantErr: 4.87444 batch_time=0.42210 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.21386 (QuantReg: 4.99953) QuantErr: 4.99953 batch_time=0.44153 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.41859 (QuantReg: 4.91868) QuantErr: 4.91868 batch_time=0.41488 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.16363 (QuantReg: 5.08335) QuantErr: 5.08335 batch_time=0.44510 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.12672 (QuantReg: 5.13340) QuantErr: 5.13340 batch_time=0.67756 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.02096 (QuantReg: 4.90374) QuantErr: 4.90374 batch_time=0.41436 
Train Epoch: 21 codebook_update_time=0.56006
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch21.pth ...
Done in 16.768s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 1.2061629033088683
 quant_reg      : 4.963726530075073
 quant_err      : 4.963726530075073
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 75.65392354124748
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.432595573440643
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.827080396948006
 MSRVTT_full_val/v2t_metrics/R1: 27.766599597585515
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 79.67806841046277
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.54728370221328
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.29191678287294
 MSRVTT_full_test/t2v_metrics/R1: 8.394648829431437
 MSRVTT_full_test/t2v_metrics/R5: 28.662207357859533
 MSRVTT_full_test/t2v_metrics/R10: 42.90969899665552
 MSRVTT_full_test/t2v_metrics/R50: 75.61872909698997
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.08578595317726
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.77488541255461
 MSRVTT_full_test/v2t_metrics/R1: 8.862876254180602
 MSRVTT_full_test/v2t_metrics/R5: 31.204013377926422
 MSRVTT_full_test/v2t_metrics/R10: 45.05016722408027
 MSRVTT_full_test/v2t_metrics/R50: 79.1304347826087
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 49.91137123745819
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.182513221580667
 mnt_best       : 22.923067955914327
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.39913 (QuantReg: 4.87008) QuantErr: 4.87008 batch_time=33.83529 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.27788 (QuantReg: 5.04690) QuantErr: 5.04690 batch_time=0.40426 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.11431 (QuantReg: 4.99185) QuantErr: 4.99185 batch_time=0.43070 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.16101 (QuantReg: 4.76860) QuantErr: 4.76860 batch_time=0.45533 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.08070 (QuantReg: 4.98464) QuantErr: 4.98464 batch_time=0.44106 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.13411 (QuantReg: 4.93390) QuantErr: 4.93390 batch_time=0.43787 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.23684 (QuantReg: 4.84075) QuantErr: 4.84075 batch_time=0.42681 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.22188 (QuantReg: 4.83398) QuantErr: 4.83398 batch_time=0.41277 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.43059 (QuantReg: 4.77818) QuantErr: 4.77818 batch_time=0.46072 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.27114 (QuantReg: 5.00100) QuantErr: 5.00100 batch_time=0.41855 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.50950 (QuantReg: 4.90913) QuantErr: 4.90913 batch_time=0.41073 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.08651 (QuantReg: 4.97872) QuantErr: 4.97872 batch_time=0.42742 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.24231 (QuantReg: 4.96766) QuantErr: 4.96766 batch_time=1.10681 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.34137 (QuantReg: 4.98401) QuantErr: 4.98401 batch_time=2.32476 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.23670 (QuantReg: 5.03084) QuantErr: 5.03084 batch_time=0.42999 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.33903 (QuantReg: 4.92559) QuantErr: 4.92559 batch_time=0.42595 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.35483 (QuantReg: 4.96324) QuantErr: 4.96324 batch_time=0.43483 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.24126 (QuantReg: 5.02209) QuantErr: 5.02209 batch_time=0.41368 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.21415 (QuantReg: 4.85805) QuantErr: 4.85805 batch_time=0.42361 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.19178 (QuantReg: 4.97306) QuantErr: 4.97306 batch_time=1.18629 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.25083 (QuantReg: 5.00470) QuantErr: 5.00470 batch_time=0.42310 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.12896 (QuantReg: 4.93339) QuantErr: 4.93339 batch_time=0.42417 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 0.93271 (QuantReg: 5.04762) QuantErr: 5.04762 batch_time=0.41243 
Train Epoch: 22 codebook_update_time=0.52717
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch22.pth ...
Done in 4.176s
removing stale ckpt [epoch 21] [took 0.04s]
 epoch          : 22
 loss           : 1.1820851237773895
 quant_reg      : 4.974523651123047
 quant_err      : 4.974523651123047
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 62.57545271629779
 MSRVTT_full_val/t2v_metrics/R10: 77.06237424547284
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.217303822937625
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.100201660105974
 MSRVTT_full_val/v2t_metrics/R1: 27.766599597585515
 MSRVTT_full_val/v2t_metrics/R5: 68.61167002012073
 MSRVTT_full_val/v2t_metrics/R10: 80.28169014084507
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.302816901408452
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.47848123063417
 MSRVTT_full_test/t2v_metrics/R1: 8.729096989966555
 MSRVTT_full_test/t2v_metrics/R5: 29.39799331103679
 MSRVTT_full_test/t2v_metrics/R10: 42.508361204013376
 MSRVTT_full_test/t2v_metrics/R50: 76.12040133779264
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.846989966555185
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.17790179170378
 MSRVTT_full_test/v2t_metrics/R1: 9.59866220735786
 MSRVTT_full_test/v2t_metrics/R5: 30.96989966555184
 MSRVTT_full_test/v2t_metrics/R10: 45.986622073578594
 MSRVTT_full_test/v2t_metrics/R50: 80.2675585284281
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.94531772575251
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.910794422196883
 mnt_best       : 22.923067955914327
 not_improved_count: 2
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.27787 (QuantReg: 4.82974) QuantErr: 4.82974 batch_time=37.89902 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.31145 (QuantReg: 5.03835) QuantErr: 5.03835 batch_time=0.43794 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 0.89555 (QuantReg: 5.01297) QuantErr: 5.01297 batch_time=0.45068 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.28668 (QuantReg: 4.96278) QuantErr: 4.96278 batch_time=0.41464 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.21749 (QuantReg: 5.04591) QuantErr: 5.04591 batch_time=0.46445 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.21710 (QuantReg: 5.00532) QuantErr: 5.00532 batch_time=0.45303 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.08615 (QuantReg: 5.05216) QuantErr: 5.05216 batch_time=0.42847 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.27727 (QuantReg: 5.00207) QuantErr: 5.00207 batch_time=0.43056 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.31306 (QuantReg: 4.83546) QuantErr: 4.83546 batch_time=0.45080 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 0.99442 (QuantReg: 4.96028) QuantErr: 4.96028 batch_time=0.42990 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.40210 (QuantReg: 4.97751) QuantErr: 4.97751 batch_time=0.43332 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.20741 (QuantReg: 4.89492) QuantErr: 4.89492 batch_time=0.42942 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.12499 (QuantReg: 5.02442) QuantErr: 5.02442 batch_time=0.44933 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.36766 (QuantReg: 5.05017) QuantErr: 5.05017 batch_time=0.42579 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.41469 (QuantReg: 5.00317) QuantErr: 5.00317 batch_time=0.44538 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.29993 (QuantReg: 4.86681) QuantErr: 4.86681 batch_time=0.42822 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 0.90277 (QuantReg: 5.10750) QuantErr: 5.10750 batch_time=0.45878 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.33565 (QuantReg: 4.98489) QuantErr: 4.98489 batch_time=0.42512 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 0.94511 (QuantReg: 5.16767) QuantErr: 5.16767 batch_time=0.44169 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.01195 (QuantReg: 5.05044) QuantErr: 5.05044 batch_time=2.81284 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 0.93859 (QuantReg: 5.09303) QuantErr: 5.09303 batch_time=0.42143 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.09400 (QuantReg: 5.04285) QuantErr: 5.04285 batch_time=0.42305 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.31232 (QuantReg: 4.79887) QuantErr: 4.79887 batch_time=0.43727 
Train Epoch: 23 codebook_update_time=0.70109
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch23.pth ...
Done in 3.974s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch23.pth ...
Done in 8.110s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 1.2082858798503875
 quant_reg      : 4.987887084960938
 quant_err      : 4.987887084960938
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_full_val/t2v_metrics/R1: 24.748490945674043
 MSRVTT_full_val/t2v_metrics/R5: 63.17907444668008
 MSRVTT_full_val/t2v_metrics/R10: 76.86116700201207
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.254527162977867
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.34876843550356
 MSRVTT_full_val/v2t_metrics/R1: 29.37625754527163
 MSRVTT_full_val/v2t_metrics/R5: 69.01408450704226
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.562374245472837
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.00632843040342
 MSRVTT_full_test/t2v_metrics/R1: 9.698996655518394
 MSRVTT_full_test/t2v_metrics/R5: 29.632107023411372
 MSRVTT_full_test/t2v_metrics/R10: 43.74581939799331
 MSRVTT_full_test/t2v_metrics/R50: 76.75585284280936
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.63913043478261
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.252802323292123
 MSRVTT_full_test/v2t_metrics/R1: 9.364548494983278
 MSRVTT_full_test/v2t_metrics/R5: 32.10702341137124
 MSRVTT_full_test/v2t_metrics/R10: 47.625418060200666
 MSRVTT_full_test/v2t_metrics/R50: 81.63879598662207
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.40501672240803
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.283347955901583
 mnt_best       : 23.252802323292123
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.42856 (QuantReg: 4.94632) QuantErr: 4.94632 batch_time=42.61331 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.08132 (QuantReg: 5.01668) QuantErr: 5.01668 batch_time=0.42473 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.00731 (QuantReg: 5.03629) QuantErr: 5.03629 batch_time=0.42740 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.33705 (QuantReg: 5.06006) QuantErr: 5.06006 batch_time=0.44505 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.42392 (QuantReg: 4.88272) QuantErr: 4.88272 batch_time=0.42922 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 0.82955 (QuantReg: 5.04974) QuantErr: 5.04974 batch_time=0.41734 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 0.81979 (QuantReg: 5.10766) QuantErr: 5.10766 batch_time=0.42768 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.16430 (QuantReg: 4.90731) QuantErr: 4.90731 batch_time=0.43582 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.07250 (QuantReg: 5.02362) QuantErr: 5.02362 batch_time=0.42453 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.19014 (QuantReg: 4.99019) QuantErr: 4.99019 batch_time=0.42926 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.28361 (QuantReg: 4.93747) QuantErr: 4.93747 batch_time=0.42646 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.28887 (QuantReg: 4.93978) QuantErr: 4.93978 batch_time=0.42881 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.04145 (QuantReg: 5.06412) QuantErr: 5.06412 batch_time=0.43419 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.55635 (QuantReg: 5.19528) QuantErr: 5.19528 batch_time=0.42202 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.21175 (QuantReg: 4.85541) QuantErr: 4.85541 batch_time=0.44648 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 0.98322 (QuantReg: 5.14147) QuantErr: 5.14147 batch_time=0.44757 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.10375 (QuantReg: 5.17366) QuantErr: 5.17366 batch_time=0.41380 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 0.94914 (QuantReg: 5.06072) QuantErr: 5.06072 batch_time=0.42349 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.18138 (QuantReg: 5.00669) QuantErr: 5.00669 batch_time=0.41356 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 0.93793 (QuantReg: 5.15080) QuantErr: 5.15080 batch_time=0.43214 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.40694 (QuantReg: 4.93509) QuantErr: 4.93509 batch_time=0.43054 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.44812 (QuantReg: 5.00269) QuantErr: 5.00269 batch_time=0.45413 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.22584 (QuantReg: 5.00809) QuantErr: 5.00809 batch_time=0.42354 
Train Epoch: 24 codebook_update_time=0.51206
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch24.pth ...
Done in 4.450s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 1.1609345302581786
 quant_reg      : 5.031575492858886
 quant_err      : 5.031575492858886
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 23.541247484909455
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.083501006036217
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.433522078370295
 MSRVTT_full_val/v2t_metrics/R1: 27.96780684104628
 MSRVTT_full_val/v2t_metrics/R5: 67.40442655935614
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.976861167002012
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.55686592595964
 MSRVTT_full_test/t2v_metrics/R1: 9.163879598662207
 MSRVTT_full_test/t2v_metrics/R5: 29.598662207357858
 MSRVTT_full_test/t2v_metrics/R10: 43.37792642140468
 MSRVTT_full_test/t2v_metrics/R50: 76.15384615384616
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.46571906354515
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.74434397888775
 MSRVTT_full_test/v2t_metrics/R1: 10.066889632107024
 MSRVTT_full_test/v2t_metrics/R5: 31.438127090301002
 MSRVTT_full_test/v2t_metrics/R10: 46.8561872909699
 MSRVTT_full_test/v2t_metrics/R50: 80.8361204013378
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 47.5185618729097
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.568179312204204
 mnt_best       : 23.252802323292123
 not_improved_count: 1
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.41709 (QuantReg: 4.99601) QuantErr: 4.99601 batch_time=33.63229 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.10467 (QuantReg: 5.06294) QuantErr: 5.06294 batch_time=0.44054 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.02228 (QuantReg: 5.15098) QuantErr: 5.15098 batch_time=0.42585 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.38851 (QuantReg: 4.88006) QuantErr: 4.88006 batch_time=0.42366 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.06342 (QuantReg: 4.99835) QuantErr: 4.99835 batch_time=0.42470 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.15012 (QuantReg: 5.03360) QuantErr: 5.03360 batch_time=0.41169 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.26294 (QuantReg: 4.90719) QuantErr: 4.90719 batch_time=0.41369 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.22408 (QuantReg: 5.07797) QuantErr: 5.07797 batch_time=0.42570 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 0.95974 (QuantReg: 5.13807) QuantErr: 5.13807 batch_time=0.43273 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.24837 (QuantReg: 4.92857) QuantErr: 4.92857 batch_time=0.41706 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.33338 (QuantReg: 4.97776) QuantErr: 4.97776 batch_time=0.41889 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 0.95334 (QuantReg: 5.02095) QuantErr: 5.02095 batch_time=0.41665 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.12237 (QuantReg: 5.03674) QuantErr: 5.03674 batch_time=0.41347 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.16949 (QuantReg: 5.05072) QuantErr: 5.05072 batch_time=0.54542 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.25853 (QuantReg: 5.00575) QuantErr: 5.00575 batch_time=0.42908 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.33754 (QuantReg: 4.96010) QuantErr: 4.96010 batch_time=0.43188 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.08811 (QuantReg: 5.12764) QuantErr: 5.12764 batch_time=0.77807 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.11228 (QuantReg: 5.16756) QuantErr: 5.16756 batch_time=0.41792 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 1.06119 (QuantReg: 5.04311) QuantErr: 5.04311 batch_time=0.51242 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.19771 (QuantReg: 5.03853) QuantErr: 5.03853 batch_time=0.41675 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.26651 (QuantReg: 5.01822) QuantErr: 5.01822 batch_time=0.41494 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.14121 (QuantReg: 5.04944) QuantErr: 5.04944 batch_time=0.43090 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.18653 (QuantReg: 4.97087) QuantErr: 4.97087 batch_time=0.42833 
Train Epoch: 25 codebook_update_time=0.52636
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch25.pth ...
Done in 4.209s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.174878607273102
 quant_reg      : 5.034076076507568
 quant_err      : 5.034076076507568
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 63.58148893360161
 MSRVTT_full_val/t2v_metrics/R10: 77.8672032193159
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.870221327967807
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.722430883658575
 MSRVTT_full_val/v2t_metrics/R1: 28.772635814889338
 MSRVTT_full_val/v2t_metrics/R5: 68.00804828973843
 MSRVTT_full_val/v2t_metrics/R10: 83.5010060362173
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.803822937625753
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.66934737033376
 MSRVTT_full_test/t2v_metrics/R1: 9.765886287625419
 MSRVTT_full_test/t2v_metrics/R5: 29.665551839464882
 MSRVTT_full_test/t2v_metrics/R10: 42.77591973244147
 MSRVTT_full_test/t2v_metrics/R50: 76.5886287625418
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 54.84130434782609
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.141303433231347
 MSRVTT_full_test/v2t_metrics/R1: 10.40133779264214
 MSRVTT_full_test/v2t_metrics/R5: 32.0066889632107
 MSRVTT_full_test/v2t_metrics/R10: 47.591973244147155
 MSRVTT_full_test/v2t_metrics/R50: 80.46822742474916
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.89297658862876
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.116235930569232
 mnt_best       : 23.252802323292123
 not_improved_count: 2
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.26936 (QuantReg: 4.95128) QuantErr: 4.95128 batch_time=32.45190 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.27626 (QuantReg: 4.85991) QuantErr: 4.85991 batch_time=0.75711 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 0.83675 (QuantReg: 5.02829) QuantErr: 5.02829 batch_time=0.41156 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.03864 (QuantReg: 4.97114) QuantErr: 4.97114 batch_time=0.42771 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.06480 (QuantReg: 5.01127) QuantErr: 5.01127 batch_time=0.42845 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.25539 (QuantReg: 5.04851) QuantErr: 5.04851 batch_time=0.42428 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.07946 (QuantReg: 5.18399) QuantErr: 5.18399 batch_time=0.42871 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.29237 (QuantReg: 5.12643) QuantErr: 5.12643 batch_time=0.42835 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.18221 (QuantReg: 5.01415) QuantErr: 5.01415 batch_time=0.41406 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.01675 (QuantReg: 4.95012) QuantErr: 4.95012 batch_time=0.64015 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.99368 (QuantReg: 5.08763) QuantErr: 5.08763 batch_time=0.42522 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 0.98642 (QuantReg: 5.04848) QuantErr: 5.04848 batch_time=0.42138 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 0.98105 (QuantReg: 4.90700) QuantErr: 4.90700 batch_time=0.43139 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.11958 (QuantReg: 5.00432) QuantErr: 5.00432 batch_time=0.43898 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.31597 (QuantReg: 4.94951) QuantErr: 4.94951 batch_time=0.40711 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.18053 (QuantReg: 5.12218) QuantErr: 5.12218 batch_time=0.44934 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.12544 (QuantReg: 4.96388) QuantErr: 4.96388 batch_time=0.42763 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 0.99905 (QuantReg: 5.08230) QuantErr: 5.08230 batch_time=0.66483 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.11503 (QuantReg: 5.13003) QuantErr: 5.13003 batch_time=0.43238 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 0.99345 (QuantReg: 5.13638) QuantErr: 5.13638 batch_time=0.42698 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.84771 (QuantReg: 5.02850) QuantErr: 5.02850 batch_time=0.41586 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.09105 (QuantReg: 5.06050) QuantErr: 5.06050 batch_time=0.42626 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 0.98954 (QuantReg: 5.07954) QuantErr: 5.07954 batch_time=0.41513 
Train Epoch: 26 codebook_update_time=0.61648
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch26.pth ...
Done in 4.039s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 1.1741549365520478
 quant_reg      : 5.055571073532104
 quant_err      : 5.055571073532104
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_full_val/t2v_metrics/R1: 25.955734406438633
 MSRVTT_full_val/t2v_metrics/R5: 64.38631790744466
 MSRVTT_full_val/t2v_metrics/R10: 78.26961770623743
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.441649899396378
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.76215387556832
 MSRVTT_full_val/v2t_metrics/R1: 28.772635814889338
 MSRVTT_full_val/v2t_metrics/R5: 69.01408450704226
 MSRVTT_full_val/v2t_metrics/R10: 81.08651911468813
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.070422535211268
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.4028951990029
 MSRVTT_full_test/t2v_metrics/R1: 9.130434782608695
 MSRVTT_full_test/t2v_metrics/R5: 29.531772575250837
 MSRVTT_full_test/t2v_metrics/R10: 43.41137123745819
 MSRVTT_full_test/t2v_metrics/R50: 75.95317725752508
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.06321070234114
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.70534782974184
 MSRVTT_full_test/v2t_metrics/R1: 9.899665551839465
 MSRVTT_full_test/v2t_metrics/R5: 32.642140468227424
 MSRVTT_full_test/v2t_metrics/R10: 47.92642140468227
 MSRVTT_full_test/v2t_metrics/R50: 80.90301003344482
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.43260869565217
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.926313414538768
 mnt_best       : 23.252802323292123
 not_improved_count: 3
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 0.93328 (QuantReg: 5.15066) QuantErr: 5.15066 batch_time=34.78220 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.42348 (QuantReg: 5.11727) QuantErr: 5.11727 batch_time=0.41912 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.16737 (QuantReg: 5.13658) QuantErr: 5.13658 batch_time=0.63216 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.16222 (QuantReg: 5.08545) QuantErr: 5.08545 batch_time=0.41601 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.11104 (QuantReg: 5.00016) QuantErr: 5.00016 batch_time=0.41441 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 0.90908 (QuantReg: 5.17953) QuantErr: 5.17953 batch_time=0.42192 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.04240 (QuantReg: 5.06686) QuantErr: 5.06686 batch_time=0.42486 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.01195 (QuantReg: 4.99986) QuantErr: 4.99986 batch_time=0.42247 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.07440 (QuantReg: 5.11481) QuantErr: 5.11481 batch_time=0.41071 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.19678 (QuantReg: 5.00786) QuantErr: 5.00786 batch_time=0.41776 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.02368 (QuantReg: 5.13184) QuantErr: 5.13184 batch_time=0.41001 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.10957 (QuantReg: 5.04703) QuantErr: 5.04703 batch_time=0.41141 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.25450 (QuantReg: 5.09844) QuantErr: 5.09844 batch_time=0.42610 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 0.99925 (QuantReg: 5.01601) QuantErr: 5.01601 batch_time=0.44758 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.04088 (QuantReg: 5.17874) QuantErr: 5.17874 batch_time=0.42273 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.20589 (QuantReg: 5.09174) QuantErr: 5.09174 batch_time=0.41823 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.35101 (QuantReg: 5.04236) QuantErr: 5.04236 batch_time=0.44254 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.04272 (QuantReg: 5.01344) QuantErr: 5.01344 batch_time=0.42735 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.36369 (QuantReg: 5.05655) QuantErr: 5.05655 batch_time=0.43631 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 0.99201 (QuantReg: 5.28262) QuantErr: 5.28262 batch_time=0.44017 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.02894 (QuantReg: 5.06455) QuantErr: 5.06455 batch_time=0.42456 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.11744 (QuantReg: 5.07038) QuantErr: 5.07038 batch_time=0.41904 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.12324 (QuantReg: 5.09503) QuantErr: 5.09503 batch_time=0.45020 
Train Epoch: 27 codebook_update_time=0.56021
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch27.pth ...
Done in 4.074s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch27.pth ...
Done in 8.062s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 1.1410563914775849
 quant_reg      : 5.060446147918701
 quant_err      : 5.060446147918701
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_full_val/t2v_metrics/R1: 25.150905432595575
 MSRVTT_full_val/t2v_metrics/R5: 63.17907444668008
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.741448692152918
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.128984349028315
 MSRVTT_full_val/v2t_metrics/R1: 29.979879275653925
 MSRVTT_full_val/v2t_metrics/R5: 69.61770623742454
 MSRVTT_full_val/v2t_metrics/R10: 84.10462776659959
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.601609657947686
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.991636483210044
 MSRVTT_full_test/t2v_metrics/R1: 10.033444816053512
 MSRVTT_full_test/t2v_metrics/R5: 30.836120401337794
 MSRVTT_full_test/t2v_metrics/R10: 44.88294314381271
 MSRVTT_full_test/t2v_metrics/R50: 77.25752508361204
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.503846153846155
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.036083766723277
 MSRVTT_full_test/v2t_metrics/R1: 10.334448160535118
 MSRVTT_full_test/v2t_metrics/R5: 33.44481605351171
 MSRVTT_full_test/v2t_metrics/R10: 47.89297658862876
 MSRVTT_full_test/v2t_metrics/R50: 81.53846153846153
 MSRVTT_full_test/v2t_metrics/MedR: 11.5
 MSRVTT_full_test/v2t_metrics/MeanR: 43.45752508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.48566542912662
 mnt_best       : 24.036083766723277
 not_improved_count: 0
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 0.94934 (QuantReg: 5.00097) QuantErr: 5.00097 batch_time=33.71984 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.35654 (QuantReg: 5.04533) QuantErr: 5.04533 batch_time=0.42089 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.14990 (QuantReg: 4.95167) QuantErr: 4.95167 batch_time=0.41265 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.16374 (QuantReg: 5.19553) QuantErr: 5.19553 batch_time=0.42590 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.44204 (QuantReg: 5.03970) QuantErr: 5.03970 batch_time=0.42662 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.09630 (QuantReg: 5.20041) QuantErr: 5.20041 batch_time=0.46093 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.47541 (QuantReg: 5.08264) QuantErr: 5.08264 batch_time=0.95996 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 0.95744 (QuantReg: 5.20797) QuantErr: 5.20797 batch_time=0.42052 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.24189 (QuantReg: 5.09271) QuantErr: 5.09271 batch_time=0.41810 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.34300 (QuantReg: 5.11576) QuantErr: 5.11576 batch_time=1.85786 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.16751 (QuantReg: 5.08322) QuantErr: 5.08322 batch_time=0.43632 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.15363 (QuantReg: 5.12029) QuantErr: 5.12029 batch_time=0.42451 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.23313 (QuantReg: 5.18697) QuantErr: 5.18697 batch_time=0.90551 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.36045 (QuantReg: 4.94624) QuantErr: 4.94624 batch_time=0.52344 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.30253 (QuantReg: 5.02656) QuantErr: 5.02656 batch_time=0.45140 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 0.89318 (QuantReg: 5.03724) QuantErr: 5.03724 batch_time=0.44601 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.42028 (QuantReg: 5.11217) QuantErr: 5.11217 batch_time=0.42245 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.14556 (QuantReg: 4.98527) QuantErr: 4.98527 batch_time=0.43116 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 0.93429 (QuantReg: 5.08092) QuantErr: 5.08092 batch_time=0.43214 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.21905 (QuantReg: 5.18156) QuantErr: 5.18156 batch_time=1.60491 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.12044 (QuantReg: 5.05782) QuantErr: 5.05782 batch_time=0.43448 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.47251 (QuantReg: 4.99843) QuantErr: 4.99843 batch_time=0.42551 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.04244 (QuantReg: 5.12806) QuantErr: 5.12806 batch_time=0.42580 
Train Epoch: 28 codebook_update_time=0.51568
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch28.pth ...
Done in 4.045s
removing stale ckpt [epoch 27] [took 0.63s]
 epoch          : 28
 loss           : 1.1491264917850494
 quant_reg      : 5.0916473903656
 quant_err      : 5.0916473903656
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_full_val/t2v_metrics/R1: 25.150905432595575
 MSRVTT_full_val/t2v_metrics/R5: 63.98390342052314
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.414486921529175
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.34094874902095
 MSRVTT_full_val/v2t_metrics/R1: 28.772635814889338
 MSRVTT_full_val/v2t_metrics/R5: 70.02012072434607
 MSRVTT_full_val/v2t_metrics/R10: 82.69617706237425
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.711267605633803
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.02532871973448
 MSRVTT_full_test/t2v_metrics/R1: 9.297658862876254
 MSRVTT_full_test/t2v_metrics/R5: 30.468227424749163
 MSRVTT_full_test/t2v_metrics/R10: 43.24414715719063
 MSRVTT_full_test/t2v_metrics/R50: 76.42140468227424
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.50033444816054
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.052394559943064
 MSRVTT_full_test/v2t_metrics/R1: 9.698996655518394
 MSRVTT_full_test/v2t_metrics/R5: 33.37792642140468
 MSRVTT_full_test/v2t_metrics/R10: 47.82608695652174
 MSRVTT_full_test/v2t_metrics/R50: 81.07023411371237
 MSRVTT_full_test/v2t_metrics/MedR: 11.5
 MSRVTT_full_test/v2t_metrics/MeanR: 45.29866220735786
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.923957606888276
 mnt_best       : 24.036083766723277
 not_improved_count: 1
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.18310 (QuantReg: 5.08312) QuantErr: 5.08312 batch_time=35.30718 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.27815 (QuantReg: 5.12822) QuantErr: 5.12822 batch_time=0.44631 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.32034 (QuantReg: 5.00291) QuantErr: 5.00291 batch_time=0.42468 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.16585 (QuantReg: 5.03514) QuantErr: 5.03514 batch_time=0.42434 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.13547 (QuantReg: 5.15055) QuantErr: 5.15055 batch_time=0.40994 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.19617 (QuantReg: 5.13278) QuantErr: 5.13278 batch_time=0.44263 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.14351 (QuantReg: 5.17754) QuantErr: 5.17754 batch_time=0.42810 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.26638 (QuantReg: 5.08956) QuantErr: 5.08956 batch_time=0.41071 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.00292 (QuantReg: 5.13887) QuantErr: 5.13887 batch_time=0.45301 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 0.95693 (QuantReg: 5.08682) QuantErr: 5.08682 batch_time=0.42656 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.35327 (QuantReg: 5.01636) QuantErr: 5.01636 batch_time=0.43174 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 0.94640 (QuantReg: 5.25818) QuantErr: 5.25818 batch_time=0.44252 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.37397 (QuantReg: 5.06461) QuantErr: 5.06461 batch_time=0.42508 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.18463 (QuantReg: 5.10911) QuantErr: 5.10911 batch_time=0.41082 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.15294 (QuantReg: 4.99689) QuantErr: 4.99689 batch_time=0.40911 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.11913 (QuantReg: 5.13627) QuantErr: 5.13627 batch_time=0.42991 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.26802 (QuantReg: 4.98157) QuantErr: 4.98157 batch_time=0.44870 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.04937 (QuantReg: 5.01716) QuantErr: 5.01716 batch_time=0.43337 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.29594 (QuantReg: 5.10344) QuantErr: 5.10344 batch_time=0.42991 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 0.93505 (QuantReg: 5.21781) QuantErr: 5.21781 batch_time=0.42591 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.05303 (QuantReg: 4.96840) QuantErr: 4.96840 batch_time=0.41180 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.12216 (QuantReg: 5.06593) QuantErr: 5.06593 batch_time=0.43656 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 0.94091 (QuantReg: 5.10488) QuantErr: 5.10488 batch_time=0.42560 
Train Epoch: 29 codebook_update_time=0.55351
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch29.pth ...
Done in 4.001s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 1.1501309356689453
 quant_reg      : 5.095055564880371
 quant_err      : 5.095055564880371
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_full_val/t2v_metrics/R1: 24.346076458752513
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 77.66599597585513
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.386317907444669
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.71666751318693
 MSRVTT_full_val/v2t_metrics/R1: 28.571428571428573
 MSRVTT_full_val/v2t_metrics/R5: 67.20321931589537
 MSRVTT_full_val/v2t_metrics/R10: 81.89134808853119
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.610663983903422
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.97425850540113
 MSRVTT_full_test/t2v_metrics/R1: 9.531772575250836
 MSRVTT_full_test/t2v_metrics/R5: 29.765886287625417
 MSRVTT_full_test/t2v_metrics/R10: 43.812709030100336
 MSRVTT_full_test/t2v_metrics/R50: 75.7190635451505
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.30468227424749
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.164923257526585
 MSRVTT_full_test/v2t_metrics/R1: 9.765886287625419
 MSRVTT_full_test/v2t_metrics/R5: 32.77591973244147
 MSRVTT_full_test/v2t_metrics/R10: 48.16053511705686
 MSRVTT_full_test/v2t_metrics/R50: 80.73578595317726
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.820234113712374
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.88776809906852
 mnt_best       : 24.036083766723277
 not_improved_count: 2
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.08302 (QuantReg: 5.07490) QuantErr: 5.07490 batch_time=38.85048 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.23964 (QuantReg: 5.13849) QuantErr: 5.13849 batch_time=0.40866 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.15842 (QuantReg: 5.08649) QuantErr: 5.08649 batch_time=0.42703 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.28655 (QuantReg: 5.15943) QuantErr: 5.15943 batch_time=0.41750 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.13168 (QuantReg: 5.04336) QuantErr: 5.04336 batch_time=0.46017 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.15829 (QuantReg: 5.24693) QuantErr: 5.24693 batch_time=0.42589 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.15988 (QuantReg: 5.08214) QuantErr: 5.08214 batch_time=0.40813 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.99473 (QuantReg: 5.19223) QuantErr: 5.19223 batch_time=0.41441 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.36336 (QuantReg: 5.04138) QuantErr: 5.04138 batch_time=0.42663 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.08246 (QuantReg: 5.27931) QuantErr: 5.27931 batch_time=0.42477 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.04820 (QuantReg: 5.21762) QuantErr: 5.21762 batch_time=0.42202 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.02706 (QuantReg: 5.15516) QuantErr: 5.15516 batch_time=0.41738 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.17369 (QuantReg: 5.13200) QuantErr: 5.13200 batch_time=0.43964 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.22796 (QuantReg: 5.04029) QuantErr: 5.04029 batch_time=0.43388 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.15670 (QuantReg: 5.12461) QuantErr: 5.12461 batch_time=0.43227 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.08681 (QuantReg: 5.18405) QuantErr: 5.18405 batch_time=0.43618 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.06641 (QuantReg: 5.09630) QuantErr: 5.09630 batch_time=0.43945 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 0.87273 (QuantReg: 5.19736) QuantErr: 5.19736 batch_time=0.41972 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.56888 (QuantReg: 5.12842) QuantErr: 5.12842 batch_time=0.42071 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.07362 (QuantReg: 5.11303) QuantErr: 5.11303 batch_time=1.20024 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.05544 (QuantReg: 5.16401) QuantErr: 5.16401 batch_time=0.42820 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.39265 (QuantReg: 5.17959) QuantErr: 5.17959 batch_time=0.42714 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.41613 (QuantReg: 5.16316) QuantErr: 5.16316 batch_time=0.40592 
Train Epoch: 30 codebook_update_time=0.79487
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch30.pth ...
Done in 10.715s
removing stale ckpt [epoch 29] [took 0.02s]
 epoch          : 30
 loss           : 1.119423502445221
 quant_reg      : 5.1267935657501225
 quant_err      : 5.1267935657501225
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_full_val/t2v_metrics/R1: 24.547283702213278
 MSRVTT_full_val/t2v_metrics/R5: 64.58752515090544
 MSRVTT_full_val/t2v_metrics/R10: 77.66599597585513
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.809859154929578
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.750143051168024
 MSRVTT_full_val/v2t_metrics/R1: 28.973843058350102
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 81.28772635814889
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.169014084507042
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.68034701269596
 MSRVTT_full_test/t2v_metrics/R1: 9.698996655518394
 MSRVTT_full_test/t2v_metrics/R5: 29.765886287625417
 MSRVTT_full_test/t2v_metrics/R10: 43.979933110367895
 MSRVTT_full_test/t2v_metrics/R50: 75.41806020066889
 MSRVTT_full_test/t2v_metrics/MedR: 13.5
 MSRVTT_full_test/t2v_metrics/MeanR: 58.14682274247492
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.32921170061759
 MSRVTT_full_test/v2t_metrics/R1: 10.568561872909699
 MSRVTT_full_test/v2t_metrics/R5: 32.84280936454849
 MSRVTT_full_test/v2t_metrics/R10: 48.66220735785953
 MSRVTT_full_test/v2t_metrics/R50: 81.03678929765886
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.15752508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.657598189249672
 mnt_best       : 24.036083766723277
 not_improved_count: 3
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.32499 (QuantReg: 5.10016) QuantErr: 5.10016 batch_time=33.92114 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.19609 (QuantReg: 5.14700) QuantErr: 5.14700 batch_time=0.44483 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.46953 (QuantReg: 5.04431) QuantErr: 5.04431 batch_time=1.41884 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.03080 (QuantReg: 5.03084) QuantErr: 5.03084 batch_time=0.44167 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.24849 (QuantReg: 5.05038) QuantErr: 5.05038 batch_time=0.40898 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.46665 (QuantReg: 4.84601) QuantErr: 4.84601 batch_time=0.45487 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.19119 (QuantReg: 5.14306) QuantErr: 5.14306 batch_time=2.01050 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.23912 (QuantReg: 5.16321) QuantErr: 5.16321 batch_time=0.42269 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.23852 (QuantReg: 5.12280) QuantErr: 5.12280 batch_time=0.42192 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.19189 (QuantReg: 5.05454) QuantErr: 5.05454 batch_time=0.42387 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.01385 (QuantReg: 5.19046) QuantErr: 5.19046 batch_time=0.42382 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.03995 (QuantReg: 5.06080) QuantErr: 5.06080 batch_time=0.43194 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.15972 (QuantReg: 5.19397) QuantErr: 5.19397 batch_time=0.46792 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.42571 (QuantReg: 5.23973) QuantErr: 5.23973 batch_time=0.41451 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.23487 (QuantReg: 5.09541) QuantErr: 5.09541 batch_time=0.42299 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.07289 (QuantReg: 5.02802) QuantErr: 5.02802 batch_time=0.43744 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.42802 (QuantReg: 4.96259) QuantErr: 4.96259 batch_time=0.42084 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.11599 (QuantReg: 5.23895) QuantErr: 5.23895 batch_time=0.42269 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 0.99473 (QuantReg: 5.13118) QuantErr: 5.13118 batch_time=0.43774 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.34541 (QuantReg: 5.10076) QuantErr: 5.10076 batch_time=0.42984 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 0.95596 (QuantReg: 5.30875) QuantErr: 5.30875 batch_time=0.43300 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.11651 (QuantReg: 5.11316) QuantErr: 5.11316 batch_time=0.41241 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.30277 (QuantReg: 5.12697) QuantErr: 5.12697 batch_time=0.43533 
Train Epoch: 31 codebook_update_time=0.51309
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch31.pth ...
Done in 12.487s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch31.pth ...
Done in 16.379s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.1557997493743897
 quant_reg      : 5.135527606964112
 quant_err      : 5.135527606964112
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_full_val/t2v_metrics/R1: 27.96780684104628
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 78.87323943661971
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.975855130784709
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.03024816527727
 MSRVTT_full_val/v2t_metrics/R1: 29.979879275653925
 MSRVTT_full_val/v2t_metrics/R5: 69.41649899396378
 MSRVTT_full_val/v2t_metrics/R10: 82.897384305835
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.96579476861167
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.66870745808007
 MSRVTT_full_test/t2v_metrics/R1: 9.966555183946488
 MSRVTT_full_test/t2v_metrics/R5: 31.304347826086957
 MSRVTT_full_test/t2v_metrics/R10: 45.31772575250836
 MSRVTT_full_test/t2v_metrics/R50: 77.25752508361204
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.50484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.180908536616506
 MSRVTT_full_test/v2t_metrics/R1: 10.535117056856187
 MSRVTT_full_test/v2t_metrics/R5: 34.381270903010034
 MSRVTT_full_test/v2t_metrics/R10: 48.99665551839465
 MSRVTT_full_test/v2t_metrics/R50: 81.43812709030101
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.08729096989966
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.084103175545355
 mnt_best       : 24.180908536616506
 not_improved_count: 0
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 0.87178 (QuantReg: 5.19128) QuantErr: 5.19128 batch_time=47.81895 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.14300 (QuantReg: 5.16000) QuantErr: 5.16000 batch_time=0.43694 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.11455 (QuantReg: 5.13260) QuantErr: 5.13260 batch_time=0.43331 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.07021 (QuantReg: 5.23241) QuantErr: 5.23241 batch_time=0.43224 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.83554 (QuantReg: 5.18868) QuantErr: 5.18868 batch_time=0.41751 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.14647 (QuantReg: 5.10503) QuantErr: 5.10503 batch_time=0.43047 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 0.84898 (QuantReg: 5.19643) QuantErr: 5.19643 batch_time=0.42341 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.10554 (QuantReg: 5.10728) QuantErr: 5.10728 batch_time=0.47290 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.28543 (QuantReg: 5.13360) QuantErr: 5.13360 batch_time=0.46529 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.09802 (QuantReg: 5.06773) QuantErr: 5.06773 batch_time=0.43642 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.11968 (QuantReg: 5.36976) QuantErr: 5.36976 batch_time=0.42407 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 0.92547 (QuantReg: 4.98983) QuantErr: 4.98983 batch_time=0.44668 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.18537 (QuantReg: 5.12814) QuantErr: 5.12814 batch_time=0.41616 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.14091 (QuantReg: 5.10329) QuantErr: 5.10329 batch_time=0.44776 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 0.91830 (QuantReg: 5.13153) QuantErr: 5.13153 batch_time=0.44915 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.16078 (QuantReg: 5.20568) QuantErr: 5.20568 batch_time=0.43909 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.22725 (QuantReg: 5.26473) QuantErr: 5.26473 batch_time=0.41769 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.26771 (QuantReg: 5.22698) QuantErr: 5.22698 batch_time=0.44602 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.04701 (QuantReg: 5.30617) QuantErr: 5.30617 batch_time=0.43080 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.31661 (QuantReg: 5.24001) QuantErr: 5.24001 batch_time=0.45788 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.11332 (QuantReg: 5.25881) QuantErr: 5.25881 batch_time=0.43374 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.14282 (QuantReg: 5.10309) QuantErr: 5.10309 batch_time=0.44668 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 0.89972 (QuantReg: 5.20525) QuantErr: 5.20525 batch_time=0.42278 
Train Epoch: 32 codebook_update_time=0.54187
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch32.pth ...
Done in 4.763s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch32.pth ...
Done in 10.454s
removing stale ckpt [epoch 31] [took 0.01s]
 epoch          : 32
 loss           : 1.1224276521205903
 quant_reg      : 5.161303127288819
 quant_err      : 5.161303127288819
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_full_val/t2v_metrics/R1: 27.766599597585515
 MSRVTT_full_val/t2v_metrics/R5: 66.59959758551308
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.305835010060362
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.772986213146005
 MSRVTT_full_val/v2t_metrics/R1: 31.187122736418512
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 83.5010060362173
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.481891348088531
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.03016528178655
 MSRVTT_full_test/t2v_metrics/R1: 9.966555183946488
 MSRVTT_full_test/t2v_metrics/R5: 32.17391304347826
 MSRVTT_full_test/t2v_metrics/R10: 45.585284280936456
 MSRVTT_full_test/t2v_metrics/R50: 77.49163879598662
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.14565217391304
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.450695041186677
 MSRVTT_full_test/v2t_metrics/R1: 10.535117056856187
 MSRVTT_full_test/v2t_metrics/R5: 34.71571906354515
 MSRVTT_full_test/v2t_metrics/R10: 49.163879598662206
 MSRVTT_full_test/v2t_metrics/R50: 81.73913043478261
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 41.63428093645485
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.19814605607315
 mnt_best       : 24.450695041186677
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.14634 (QuantReg: 5.30904) QuantErr: 5.30904 batch_time=33.85323 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 0.98257 (QuantReg: 5.12271) QuantErr: 5.12271 batch_time=0.44838 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.24529 (QuantReg: 5.25099) QuantErr: 5.25099 batch_time=0.41723 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 0.95415 (QuantReg: 4.94423) QuantErr: 4.94423 batch_time=0.47871 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.07986 (QuantReg: 5.23768) QuantErr: 5.23768 batch_time=0.46928 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.17124 (QuantReg: 5.19579) QuantErr: 5.19579 batch_time=0.42872 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 1.37628 (QuantReg: 5.19315) QuantErr: 5.19315 batch_time=0.77008 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.05295 (QuantReg: 5.03378) QuantErr: 5.03378 batch_time=0.43146 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.21416 (QuantReg: 5.02361) QuantErr: 5.02361 batch_time=0.44190 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.16533 (QuantReg: 5.16912) QuantErr: 5.16912 batch_time=0.42838 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.25536 (QuantReg: 5.12460) QuantErr: 5.12460 batch_time=0.42709 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.04703 (QuantReg: 5.15084) QuantErr: 5.15084 batch_time=0.45451 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.45045 (QuantReg: 5.09849) QuantErr: 5.09849 batch_time=0.46144 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.20648 (QuantReg: 5.19569) QuantErr: 5.19569 batch_time=0.43945 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.04828 (QuantReg: 5.06987) QuantErr: 5.06987 batch_time=0.43940 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.09259 (QuantReg: 5.28481) QuantErr: 5.28481 batch_time=0.41698 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.96466 (QuantReg: 5.18693) QuantErr: 5.18693 batch_time=0.44294 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.29012 (QuantReg: 5.21648) QuantErr: 5.21648 batch_time=0.42479 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.15305 (QuantReg: 5.13860) QuantErr: 5.13860 batch_time=0.44599 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.17579 (QuantReg: 5.27007) QuantErr: 5.27007 batch_time=1.79048 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 1.46462 (QuantReg: 5.12815) QuantErr: 5.12815 batch_time=0.45163 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.05323 (QuantReg: 5.15252) QuantErr: 5.15252 batch_time=0.45425 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.10368 (QuantReg: 5.18834) QuantErr: 5.18834 batch_time=0.45420 
Train Epoch: 33 codebook_update_time=0.51729
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch33.pth ...
Done in 4.145s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.129959019422531
 quant_reg      : 5.168188674926758
 quant_err      : 5.168188674926758
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_full_val/t2v_metrics/R1: 27.56539235412475
 MSRVTT_full_val/t2v_metrics/R5: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.422535211267606
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.2714445540549
 MSRVTT_full_val/v2t_metrics/R1: 32.394366197183096
 MSRVTT_full_val/v2t_metrics/R5: 70.82494969818913
 MSRVTT_full_val/v2t_metrics/R10: 82.69617706237425
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.720321931589537
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.46195509251775
 MSRVTT_full_test/t2v_metrics/R1: 9.397993311036789
 MSRVTT_full_test/t2v_metrics/R5: 31.53846153846154
 MSRVTT_full_test/t2v_metrics/R10: 45.38461538461539
 MSRVTT_full_test/t2v_metrics/R50: 77.3913043478261
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.82926421404682
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.78271501313778
 MSRVTT_full_test/v2t_metrics/R1: 10.76923076923077
 MSRVTT_full_test/v2t_metrics/R5: 34.51505016722408
 MSRVTT_full_test/v2t_metrics/R10: 49.93311036789298
 MSRVTT_full_test/v2t_metrics/R50: 82.0066889632107
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.20434782608696
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.476501823491912
 mnt_best       : 24.450695041186677
 not_improved_count: 1
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.10240 (QuantReg: 5.27692) QuantErr: 5.27692 batch_time=46.70014 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.12225 (QuantReg: 5.32214) QuantErr: 5.32214 batch_time=0.42986 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.07595 (QuantReg: 5.22281) QuantErr: 5.22281 batch_time=0.48350 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.12277 (QuantReg: 5.17017) QuantErr: 5.17017 batch_time=0.45323 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.24586 (QuantReg: 5.19350) QuantErr: 5.19350 batch_time=0.42021 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.18740 (QuantReg: 5.13798) QuantErr: 5.13798 batch_time=0.44543 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.15928 (QuantReg: 5.22692) QuantErr: 5.22692 batch_time=0.43639 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.54798 (QuantReg: 5.09556) QuantErr: 5.09556 batch_time=0.43128 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.26164 (QuantReg: 5.12923) QuantErr: 5.12923 batch_time=0.48589 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.51623 (QuantReg: 5.13828) QuantErr: 5.13828 batch_time=0.45817 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.25261 (QuantReg: 5.05565) QuantErr: 5.05565 batch_time=0.42581 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.12394 (QuantReg: 5.16289) QuantErr: 5.16289 batch_time=0.43013 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.25803 (QuantReg: 5.22619) QuantErr: 5.22619 batch_time=0.47314 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.19868 (QuantReg: 5.10882) QuantErr: 5.10882 batch_time=0.42537 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.07443 (QuantReg: 5.35321) QuantErr: 5.35321 batch_time=0.42557 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.30788 (QuantReg: 5.02400) QuantErr: 5.02400 batch_time=0.41906 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 0.99650 (QuantReg: 5.18079) QuantErr: 5.18079 batch_time=0.42310 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.38986 (QuantReg: 5.13001) QuantErr: 5.13001 batch_time=0.43821 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 0.93731 (QuantReg: 5.16033) QuantErr: 5.16033 batch_time=0.43793 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.24495 (QuantReg: 5.11645) QuantErr: 5.11645 batch_time=0.44038 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.03323 (QuantReg: 5.25573) QuantErr: 5.25573 batch_time=0.42584 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 0.94925 (QuantReg: 5.25346) QuantErr: 5.25346 batch_time=0.42500 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.34451 (QuantReg: 5.29678) QuantErr: 5.29678 batch_time=0.71549 
Train Epoch: 34 codebook_update_time=0.84024
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch34.pth ...
Done in 3.924s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 1.1594993789196015
 quant_reg      : 5.176977657318115
 quant_err      : 5.176977657318115
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 64.1851106639839
 MSRVTT_full_val/t2v_metrics/R10: 77.8672032193159
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.442655935613683
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.49102072955697
 MSRVTT_full_val/v2t_metrics/R1: 32.796780684104625
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.620724346076459
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.71406568745976
 MSRVTT_full_test/t2v_metrics/R1: 10.133779264214047
 MSRVTT_full_test/t2v_metrics/R5: 30.0
 MSRVTT_full_test/t2v_metrics/R10: 43.91304347826087
 MSRVTT_full_test/t2v_metrics/R50: 75.91973244147157
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.704515050167224
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.72258861227243
 MSRVTT_full_test/v2t_metrics/R1: 10.468227424749164
 MSRVTT_full_test/v2t_metrics/R5: 33.51170568561873
 MSRVTT_full_test/v2t_metrics/R10: 49.56521739130435
 MSRVTT_full_test/v2t_metrics/R50: 80.8361204013378
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.417391304347824
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.906906989486625
 mnt_best       : 24.450695041186677
 not_improved_count: 2
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.08559 (QuantReg: 5.14255) QuantErr: 5.14255 batch_time=48.79943 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.23855 (QuantReg: 5.19965) QuantErr: 5.19965 batch_time=0.44418 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.27496 (QuantReg: 5.10390) QuantErr: 5.10390 batch_time=0.44397 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.36671 (QuantReg: 5.14054) QuantErr: 5.14054 batch_time=0.64493 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.18614 (QuantReg: 5.13220) QuantErr: 5.13220 batch_time=0.43128 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.08365 (QuantReg: 5.20604) QuantErr: 5.20604 batch_time=0.42801 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.03395 (QuantReg: 5.29036) QuantErr: 5.29036 batch_time=0.44760 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.46061 (QuantReg: 5.27469) QuantErr: 5.27469 batch_time=0.42730 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.14063 (QuantReg: 5.12195) QuantErr: 5.12195 batch_time=0.45103 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.31538 (QuantReg: 5.21860) QuantErr: 5.21860 batch_time=0.42375 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.19945 (QuantReg: 5.15314) QuantErr: 5.15314 batch_time=0.78085 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.16417 (QuantReg: 5.18555) QuantErr: 5.18555 batch_time=0.42584 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.42882 (QuantReg: 5.09841) QuantErr: 5.09841 batch_time=0.90201 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.00165 (QuantReg: 5.25893) QuantErr: 5.25893 batch_time=0.42758 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.01072 (QuantReg: 5.15208) QuantErr: 5.15208 batch_time=0.41336 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 1.25821 (QuantReg: 5.29015) QuantErr: 5.29015 batch_time=0.47706 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.05866 (QuantReg: 5.43955) QuantErr: 5.43955 batch_time=0.42847 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 0.98315 (QuantReg: 5.08351) QuantErr: 5.08351 batch_time=0.44688 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.08106 (QuantReg: 5.32294) QuantErr: 5.32294 batch_time=0.43694 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.06855 (QuantReg: 5.23655) QuantErr: 5.23655 batch_time=0.43859 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.10835 (QuantReg: 5.23483) QuantErr: 5.23483 batch_time=0.84326 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.05036 (QuantReg: 5.29768) QuantErr: 5.29768 batch_time=0.42593 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.01022 (QuantReg: 5.25122) QuantErr: 5.25122 batch_time=0.43135 
Train Epoch: 35 codebook_update_time=0.58175
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch35.pth ...
Done in 6.795s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 1.13227099442482
 quant_reg      : 5.199854335784912
 quant_err      : 5.199854335784912
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_full_val/t2v_metrics/R1: 26.961770623742456
 MSRVTT_full_val/t2v_metrics/R5: 65.59356136820925
 MSRVTT_full_val/t2v_metrics/R10: 78.87323943661971
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.917505030181086
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.861662320302905
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 69.81891348088531
 MSRVTT_full_val/v2t_metrics/R10: 82.49496981891348
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.921529175050302
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.54439841339204
 MSRVTT_full_test/t2v_metrics/R1: 9.799331103678929
 MSRVTT_full_test/t2v_metrics/R5: 31.438127090301002
 MSRVTT_full_test/t2v_metrics/R10: 45.551839464882946
 MSRVTT_full_test/t2v_metrics/R50: 76.65551839464882
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.751505016722405
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.12050181557858
 MSRVTT_full_test/v2t_metrics/R1: 10.702341137123746
 MSRVTT_full_test/v2t_metrics/R5: 34.31438127090301
 MSRVTT_full_test/v2t_metrics/R10: 48.99665551839465
 MSRVTT_full_test/v2t_metrics/R50: 81.97324414715719
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.231270903010035
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.20437462534121
 mnt_best       : 24.450695041186677
 not_improved_count: 3
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 0.98695 (QuantReg: 5.17612) QuantErr: 5.17612 batch_time=36.72623 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.26059 (QuantReg: 5.22223) QuantErr: 5.22223 batch_time=0.42222 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.89257 (QuantReg: 5.08290) QuantErr: 5.08290 batch_time=0.54851 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.04485 (QuantReg: 5.16228) QuantErr: 5.16228 batch_time=0.42392 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.19281 (QuantReg: 5.17649) QuantErr: 5.17649 batch_time=0.45036 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.82698 (QuantReg: 5.09507) QuantErr: 5.09507 batch_time=0.45724 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.06012 (QuantReg: 5.24547) QuantErr: 5.24547 batch_time=0.42991 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.30134 (QuantReg: 5.23967) QuantErr: 5.23967 batch_time=0.42857 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.25549 (QuantReg: 5.09888) QuantErr: 5.09888 batch_time=0.42604 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.20497 (QuantReg: 5.19224) QuantErr: 5.19224 batch_time=0.42244 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.42375 (QuantReg: 5.16276) QuantErr: 5.16276 batch_time=0.43950 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.29497 (QuantReg: 5.15535) QuantErr: 5.15535 batch_time=0.43379 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.10050 (QuantReg: 5.08887) QuantErr: 5.08887 batch_time=0.41522 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.26078 (QuantReg: 5.34495) QuantErr: 5.34495 batch_time=2.02506 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.94548 (QuantReg: 5.22875) QuantErr: 5.22875 batch_time=0.43257 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 1.31371 (QuantReg: 5.22682) QuantErr: 5.22682 batch_time=0.42305 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.36413 (QuantReg: 5.20816) QuantErr: 5.20816 batch_time=0.42991 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.97814 (QuantReg: 5.25001) QuantErr: 5.25001 batch_time=0.57367 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.02361 (QuantReg: 5.15846) QuantErr: 5.15846 batch_time=0.42906 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.15230 (QuantReg: 5.17025) QuantErr: 5.17025 batch_time=0.43739 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 1.39000 (QuantReg: 5.05426) QuantErr: 5.05426 batch_time=0.43518 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.19414 (QuantReg: 5.21353) QuantErr: 5.21353 batch_time=0.41437 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 1.00787 (QuantReg: 5.09503) QuantErr: 5.09503 batch_time=0.43285 
Train Epoch: 36 codebook_update_time=0.51319
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch36.pth ...
Done in 5.743s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 1.1431689140796661
 quant_reg      : 5.218870216369629
 quant_err      : 5.218870216369629
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_full_val/t2v_metrics/R1: 26.358148893360163
 MSRVTT_full_val/t2v_metrics/R5: 64.78873239436619
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.326961770623743
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.216699252088915
 MSRVTT_full_val/v2t_metrics/R1: 32.59557344064386
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.838028169014085
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.66572660595648
 MSRVTT_full_test/t2v_metrics/R1: 9.832775919732441
 MSRVTT_full_test/t2v_metrics/R5: 32.408026755852845
 MSRVTT_full_test/t2v_metrics/R10: 45.719063545150505
 MSRVTT_full_test/t2v_metrics/R50: 76.5551839464883
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.413879598662206
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.42354415850968
 MSRVTT_full_test/v2t_metrics/R1: 10.735785953177258
 MSRVTT_full_test/v2t_metrics/R5: 34.247491638795985
 MSRVTT_full_test/v2t_metrics/R10: 50.20066889632107
 MSRVTT_full_test/v2t_metrics/R50: 81.83946488294315
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 41.97408026755853
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.427578535519785
 mnt_best       : 24.450695041186677
 not_improved_count: 4
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.19985 (QuantReg: 5.18681) QuantErr: 5.18681 batch_time=40.96621 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.05555 (QuantReg: 5.19757) QuantErr: 5.19757 batch_time=0.42143 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 1.22586 (QuantReg: 5.13836) QuantErr: 5.13836 batch_time=0.48161 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 0.94989 (QuantReg: 5.21950) QuantErr: 5.21950 batch_time=0.44655 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.19485 (QuantReg: 5.23838) QuantErr: 5.23838 batch_time=0.43346 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.44466 (QuantReg: 5.14578) QuantErr: 5.14578 batch_time=0.42548 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.39515 (QuantReg: 5.20932) QuantErr: 5.20932 batch_time=0.49738 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.05056 (QuantReg: 5.19546) QuantErr: 5.19546 batch_time=1.38590 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.17791 (QuantReg: 5.27702) QuantErr: 5.27702 batch_time=0.43407 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.01923 (QuantReg: 5.14124) QuantErr: 5.14124 batch_time=0.42379 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.07333 (QuantReg: 5.21838) QuantErr: 5.21838 batch_time=1.00301 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.02252 (QuantReg: 5.26662) QuantErr: 5.26662 batch_time=0.42666 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.20766 (QuantReg: 5.18131) QuantErr: 5.18131 batch_time=0.43147 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.37842 (QuantReg: 5.23127) QuantErr: 5.23127 batch_time=0.41695 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 1.13937 (QuantReg: 5.18275) QuantErr: 5.18275 batch_time=0.42493 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 1.20537 (QuantReg: 5.23569) QuantErr: 5.23569 batch_time=0.41506 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.19368 (QuantReg: 5.22359) QuantErr: 5.22359 batch_time=0.42540 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 1.26662 (QuantReg: 5.12303) QuantErr: 5.12303 batch_time=0.42718 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.14678 (QuantReg: 5.33064) QuantErr: 5.33064 batch_time=0.43980 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.34714 (QuantReg: 5.22493) QuantErr: 5.22493 batch_time=0.41563 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.17643 (QuantReg: 5.40375) QuantErr: 5.40375 batch_time=0.48973 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.42150 (QuantReg: 5.08222) QuantErr: 5.08222 batch_time=0.48281 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.00004 (QuantReg: 5.25995) QuantErr: 5.25995 batch_time=0.43883 
Train Epoch: 37 codebook_update_time=0.52215
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch37.pth ...
Done in 11.934s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch37.pth ...
Done in 16.474s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 1.1554218792915345
 quant_reg      : 5.212415159225464
 quant_err      : 5.212415159225464
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R10: 80.28169014084507
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.95774647887324
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.17620282303167
 MSRVTT_full_val/v2t_metrics/R1: 30.18108651911469
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 82.897384305835
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.203219315895371
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.114548784491774
 MSRVTT_full_test/t2v_metrics/R1: 11.003344481605351
 MSRVTT_full_test/t2v_metrics/R5: 32.17391304347826
 MSRVTT_full_test/t2v_metrics/R10: 44.64882943143812
 MSRVTT_full_test/t2v_metrics/R50: 76.88963210702342
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.21789297658863
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.096484511485926
 MSRVTT_full_test/v2t_metrics/R1: 10.668896321070234
 MSRVTT_full_test/v2t_metrics/R5: 35.618729096989966
 MSRVTT_full_test/v2t_metrics/R10: 50.36789297658863
 MSRVTT_full_test/v2t_metrics/R50: 81.83946488294315
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.87658862876254
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.749596328356656
 mnt_best       : 25.096484511485926
 not_improved_count: 0
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 1.22324 (QuantReg: 5.19605) QuantErr: 5.19605 batch_time=38.50596 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 1.20810 (QuantReg: 5.24028) QuantErr: 5.24028 batch_time=0.42833 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.88116 (QuantReg: 5.23697) QuantErr: 5.23697 batch_time=0.41583 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.18312 (QuantReg: 5.22426) QuantErr: 5.22426 batch_time=0.42106 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.23789 (QuantReg: 5.20705) QuantErr: 5.20705 batch_time=0.42220 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 1.33189 (QuantReg: 5.27033) QuantErr: 5.27033 batch_time=0.42585 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.10060 (QuantReg: 5.13913) QuantErr: 5.13913 batch_time=4.91778 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.94167 (QuantReg: 5.31382) QuantErr: 5.31382 batch_time=0.41916 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 0.96862 (QuantReg: 5.23223) QuantErr: 5.23223 batch_time=0.42868 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.02999 (QuantReg: 5.35263) QuantErr: 5.35263 batch_time=0.41780 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.21129 (QuantReg: 5.19940) QuantErr: 5.19940 batch_time=0.65309 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.29394 (QuantReg: 5.23087) QuantErr: 5.23087 batch_time=0.44772 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.10058 (QuantReg: 5.31044) QuantErr: 5.31044 batch_time=0.43478 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.18279 (QuantReg: 5.18757) QuantErr: 5.18757 batch_time=0.43717 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 0.91916 (QuantReg: 5.32161) QuantErr: 5.32161 batch_time=0.41359 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 1.25044 (QuantReg: 5.17964) QuantErr: 5.17964 batch_time=0.45097 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.17001 (QuantReg: 5.25089) QuantErr: 5.25089 batch_time=0.41515 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.10682 (QuantReg: 5.23151) QuantErr: 5.23151 batch_time=0.41137 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.01706 (QuantReg: 5.18816) QuantErr: 5.18816 batch_time=0.41146 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.09783 (QuantReg: 5.19620) QuantErr: 5.19620 batch_time=0.41353 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.20252 (QuantReg: 5.30203) QuantErr: 5.30203 batch_time=0.44325 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.12783 (QuantReg: 5.17185) QuantErr: 5.17185 batch_time=0.43611 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.03530 (QuantReg: 5.26733) QuantErr: 5.26733 batch_time=0.42252 
Train Epoch: 38 codebook_update_time=0.49746
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch38.pth ...
Done in 9.643s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.1509998774528503
 quant_reg      : 5.227952537536621
 quant_err      : 5.227952537536621
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_full_val/t2v_metrics/R1: 27.766599597585515
 MSRVTT_full_val/t2v_metrics/R5: 66.19718309859155
 MSRVTT_full_val/t2v_metrics/R10: 78.26961770623743
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.890342052313883
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.3984539649025
 MSRVTT_full_val/v2t_metrics/R1: 32.796780684104625
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.324949698189135
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.78413705469402
 MSRVTT_full_test/t2v_metrics/R1: 10.200668896321071
 MSRVTT_full_test/t2v_metrics/R5: 32.274247491638796
 MSRVTT_full_test/t2v_metrics/R10: 45.852842809364546
 MSRVTT_full_test/t2v_metrics/R50: 76.15384615384616
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.50953177257525
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.71441571169956
 MSRVTT_full_test/v2t_metrics/R1: 10.568561872909699
 MSRVTT_full_test/v2t_metrics/R5: 35.38461538461539
 MSRVTT_full_test/v2t_metrics/R10: 49.93311036789298
 MSRVTT_full_test/v2t_metrics/R50: 81.47157190635451
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 41.958193979933114
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.530147488687426
 mnt_best       : 25.096484511485926
 not_improved_count: 1
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 1.27604 (QuantReg: 5.26219) QuantErr: 5.26219 batch_time=37.12183 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.33524 (QuantReg: 5.18276) QuantErr: 5.18276 batch_time=0.44595 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 0.97487 (QuantReg: 5.19909) QuantErr: 5.19909 batch_time=0.42664 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.43257 (QuantReg: 5.26002) QuantErr: 5.26002 batch_time=0.41239 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.01651 (QuantReg: 5.20577) QuantErr: 5.20577 batch_time=0.45231 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.12614 (QuantReg: 5.26212) QuantErr: 5.26212 batch_time=0.43330 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.17921 (QuantReg: 5.14519) QuantErr: 5.14519 batch_time=0.77032 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 0.97752 (QuantReg: 5.30230) QuantErr: 5.30230 batch_time=0.42929 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 0.87471 (QuantReg: 5.17756) QuantErr: 5.17756 batch_time=0.41783 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 0.99042 (QuantReg: 5.29230) QuantErr: 5.29230 batch_time=0.44035 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.96858 (QuantReg: 5.13690) QuantErr: 5.13690 batch_time=0.43894 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.97038 (QuantReg: 5.39114) QuantErr: 5.39114 batch_time=0.42491 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.24578 (QuantReg: 5.24766) QuantErr: 5.24766 batch_time=0.44303 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.25991 (QuantReg: 5.16232) QuantErr: 5.16232 batch_time=0.43235 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 0.96988 (QuantReg: 5.15181) QuantErr: 5.15181 batch_time=0.43745 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 0.84827 (QuantReg: 5.26020) QuantErr: 5.26020 batch_time=0.44121 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.08559 (QuantReg: 5.32993) QuantErr: 5.32993 batch_time=0.42205 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.09480 (QuantReg: 5.23658) QuantErr: 5.23658 batch_time=0.43126 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 1.14237 (QuantReg: 5.30720) QuantErr: 5.30720 batch_time=0.42740 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 0.94915 (QuantReg: 5.41855) QuantErr: 5.41855 batch_time=0.42483 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.18617 (QuantReg: 5.33379) QuantErr: 5.33379 batch_time=0.41528 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 0.97774 (QuantReg: 5.43952) QuantErr: 5.43952 batch_time=0.95918 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.97141 (QuantReg: 5.20939) QuantErr: 5.20939 batch_time=0.43447 
Train Epoch: 39 codebook_update_time=0.53768
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch39.pth ...
Done in 3.882s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch39.pth ...
Done in 26.614s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 1.1348761451244354
 quant_reg      : 5.258211277008057
 quant_err      : 5.258211277008057
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_full_val/t2v_metrics/R1: 29.175050301810867
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 77.66599597585513
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.651911468812877
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.807574573830166
 MSRVTT_full_val/v2t_metrics/R1: 34.00402414486921
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 83.09859154929578
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.23440643863179
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.60350850545372
 MSRVTT_full_test/t2v_metrics/R1: 10.836120401337793
 MSRVTT_full_test/t2v_metrics/R5: 32.408026755852845
 MSRVTT_full_test/t2v_metrics/R10: 45.68561872909699
 MSRVTT_full_test/t2v_metrics/R50: 76.48829431438126
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 59.098829431438126
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.22136809612007
 MSRVTT_full_test/v2t_metrics/R1: 10.735785953177258
 MSRVTT_full_test/v2t_metrics/R5: 34.71571906354515
 MSRVTT_full_test/v2t_metrics/R10: 49.331103678929765
 MSRVTT_full_test/v2t_metrics/R50: 81.67224080267559
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.54732441471572
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.39329511062562
 mnt_best       : 25.22136809612007
 not_improved_count: 0
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.22751 (QuantReg: 5.28633) QuantErr: 5.28633 batch_time=37.67177 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.07337 (QuantReg: 5.29911) QuantErr: 5.29911 batch_time=0.46865 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.18339 (QuantReg: 5.24136) QuantErr: 5.24136 batch_time=0.43629 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.09239 (QuantReg: 5.18993) QuantErr: 5.18993 batch_time=0.46799 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.37217 (QuantReg: 5.17710) QuantErr: 5.17710 batch_time=0.42437 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.37081 (QuantReg: 5.30306) QuantErr: 5.30306 batch_time=0.43435 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.23561 (QuantReg: 5.28942) QuantErr: 5.28942 batch_time=0.41282 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.07858 (QuantReg: 5.34456) QuantErr: 5.34456 batch_time=0.41951 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.48932 (QuantReg: 5.18950) QuantErr: 5.18950 batch_time=0.42955 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.95720 (QuantReg: 5.23561) QuantErr: 5.23561 batch_time=0.43260 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.10282 (QuantReg: 5.21888) QuantErr: 5.21888 batch_time=0.43391 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.00975 (QuantReg: 5.25466) QuantErr: 5.25466 batch_time=0.43087 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.19943 (QuantReg: 5.29239) QuantErr: 5.29239 batch_time=0.43513 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 0.98125 (QuantReg: 5.26342) QuantErr: 5.26342 batch_time=0.42758 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.16727 (QuantReg: 5.21651) QuantErr: 5.21651 batch_time=0.44741 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.28805 (QuantReg: 5.29976) QuantErr: 5.29976 batch_time=0.44432 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.17405 (QuantReg: 5.33241) QuantErr: 5.33241 batch_time=0.41655 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.39097 (QuantReg: 5.28896) QuantErr: 5.28896 batch_time=0.67226 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.27080 (QuantReg: 5.33744) QuantErr: 5.33744 batch_time=0.44123 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.08600 (QuantReg: 5.26700) QuantErr: 5.26700 batch_time=0.43129 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.13819 (QuantReg: 5.32784) QuantErr: 5.32784 batch_time=0.44460 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 1.35967 (QuantReg: 5.24769) QuantErr: 5.24769 batch_time=0.43470 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 1.05585 (QuantReg: 5.13856) QuantErr: 5.13856 batch_time=0.42607 
Train Epoch: 40 codebook_update_time=0.55660
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch40.pth ...
Done in 4.176s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch40.pth ...
Done in 8.443s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 1.1604798781871795
 quant_reg      : 5.266540161132813
 quant_err      : 5.266540161132813
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 65.99597585513078
 MSRVTT_full_val/t2v_metrics/R10: 78.26961770623743
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.219315895372233
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.84625398963629
 MSRVTT_full_val/v2t_metrics/R1: 33.601609657947684
 MSRVTT_full_val/v2t_metrics/R5: 71.0261569416499
 MSRVTT_full_val/v2t_metrics/R10: 83.09859154929578
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.428571428571429
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.316397468782085
 MSRVTT_full_test/t2v_metrics/R1: 10.869565217391305
 MSRVTT_full_test/t2v_metrics/R5: 32.441471571906355
 MSRVTT_full_test/t2v_metrics/R10: 46.32107023411371
 MSRVTT_full_test/t2v_metrics/R50: 76.88963210702342
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.09665551839465
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.372529603264717
 MSRVTT_full_test/v2t_metrics/R1: 11.705685618729097
 MSRVTT_full_test/v2t_metrics/R5: 35.28428093645485
 MSRVTT_full_test/v2t_metrics/R10: 51.070234113712374
 MSRVTT_full_test/v2t_metrics/R50: 81.80602006688963
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.86806020066889
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.63007043463645
 mnt_best       : 25.372529603264717
 not_improved_count: 0
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.22364 (QuantReg: 5.18534) QuantErr: 5.18534 batch_time=36.23227 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.20915 (QuantReg: 5.20822) QuantErr: 5.20822 batch_time=0.42155 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.09276 (QuantReg: 5.26881) QuantErr: 5.26881 batch_time=0.72155 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.25258 (QuantReg: 5.30980) QuantErr: 5.30980 batch_time=0.42168 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 0.77039 (QuantReg: 5.28164) QuantErr: 5.28164 batch_time=0.42746 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 1.33720 (QuantReg: 5.14866) QuantErr: 5.14866 batch_time=0.48132 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 1.46222 (QuantReg: 5.14729) QuantErr: 5.14729 batch_time=0.42689 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.20595 (QuantReg: 5.30352) QuantErr: 5.30352 batch_time=0.43255 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.19605 (QuantReg: 5.36189) QuantErr: 5.36189 batch_time=0.43634 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 0.97963 (QuantReg: 5.40630) QuantErr: 5.40630 batch_time=0.43904 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.31245 (QuantReg: 5.26511) QuantErr: 5.26511 batch_time=0.45819 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.16451 (QuantReg: 5.32338) QuantErr: 5.32338 batch_time=0.44782 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 0.94419 (QuantReg: 5.26279) QuantErr: 5.26279 batch_time=0.42557 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 0.96571 (QuantReg: 5.27170) QuantErr: 5.27170 batch_time=0.42467 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.18276 (QuantReg: 5.37449) QuantErr: 5.37449 batch_time=0.43579 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.20057 (QuantReg: 5.35364) QuantErr: 5.35364 batch_time=0.42346 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.23683 (QuantReg: 5.32837) QuantErr: 5.32837 batch_time=0.43910 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 1.34825 (QuantReg: 5.24064) QuantErr: 5.24064 batch_time=0.45577 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.14637 (QuantReg: 5.24520) QuantErr: 5.24520 batch_time=0.42491 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.00501 (QuantReg: 5.37195) QuantErr: 5.37195 batch_time=1.47981 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.25969 (QuantReg: 5.36896) QuantErr: 5.36896 batch_time=0.42379 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.16943 (QuantReg: 5.33843) QuantErr: 5.33843 batch_time=0.42606 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.24839 (QuantReg: 5.27955) QuantErr: 5.27955 batch_time=0.43959 
Train Epoch: 41 codebook_update_time=0.54676
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch41.pth ...
Done in 10.295s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.180207937002182
 quant_reg      : 5.299209018707275
 quant_err      : 5.299209018707275
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 63.78269617706238
 MSRVTT_full_val/t2v_metrics/R10: 77.8672032193159
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.607645875251508
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.159065498119176
 MSRVTT_full_val/v2t_metrics/R1: 34.00402414486921
 MSRVTT_full_val/v2t_metrics/R5: 71.62977867203219
 MSRVTT_full_val/v2t_metrics/R10: 81.48893360160966
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.13682092555332
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.33208767310224
 MSRVTT_full_test/t2v_metrics/R1: 10.76923076923077
 MSRVTT_full_test/t2v_metrics/R5: 31.73913043478261
 MSRVTT_full_test/t2v_metrics/R10: 45.45150501672241
 MSRVTT_full_test/t2v_metrics/R50: 76.68896321070234
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.70200668896321
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.95222772296406
 MSRVTT_full_test/v2t_metrics/R1: 11.471571906354516
 MSRVTT_full_test/v2t_metrics/R5: 35.08361204013378
 MSRVTT_full_test/v2t_metrics/R10: 50.60200668896321
 MSRVTT_full_test/v2t_metrics/R50: 81.40468227424749
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.6623745819398
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.308530048805107
 mnt_best       : 25.372529603264717
 not_improved_count: 1
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.12921 (QuantReg: 5.21167) QuantErr: 5.21167 batch_time=39.02871 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.22085 (QuantReg: 5.26324) QuantErr: 5.26324 batch_time=0.41219 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.17452 (QuantReg: 5.28049) QuantErr: 5.28049 batch_time=0.41369 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.08472 (QuantReg: 5.30396) QuantErr: 5.30396 batch_time=0.42809 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.35392 (QuantReg: 5.33742) QuantErr: 5.33742 batch_time=0.41455 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.25968 (QuantReg: 5.28447) QuantErr: 5.28447 batch_time=0.40985 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.06601 (QuantReg: 5.30277) QuantErr: 5.30277 batch_time=0.44610 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.24018 (QuantReg: 5.17759) QuantErr: 5.17759 batch_time=0.41288 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 1.21107 (QuantReg: 5.29133) QuantErr: 5.29133 batch_time=0.43012 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.02595 (QuantReg: 5.38102) QuantErr: 5.38102 batch_time=0.55792 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.38765 (QuantReg: 5.31988) QuantErr: 5.31988 batch_time=0.43350 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.38476 (QuantReg: 5.44386) QuantErr: 5.44386 batch_time=0.45629 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.11588 (QuantReg: 5.31980) QuantErr: 5.31980 batch_time=0.42963 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 1.18870 (QuantReg: 5.26253) QuantErr: 5.26253 batch_time=0.41587 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.36516 (QuantReg: 5.27794) QuantErr: 5.27794 batch_time=0.46195 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.08753 (QuantReg: 5.28114) QuantErr: 5.28114 batch_time=0.46597 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 1.42277 (QuantReg: 5.38108) QuantErr: 5.38108 batch_time=0.41485 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 1.09147 (QuantReg: 5.29752) QuantErr: 5.29752 batch_time=0.42881 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 1.23086 (QuantReg: 5.38398) QuantErr: 5.38398 batch_time=0.42341 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.24652 (QuantReg: 5.32237) QuantErr: 5.32237 batch_time=0.42773 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.03798 (QuantReg: 5.36174) QuantErr: 5.36174 batch_time=0.46012 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 1.28365 (QuantReg: 5.34363) QuantErr: 5.34363 batch_time=0.46184 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 0.97483 (QuantReg: 5.31403) QuantErr: 5.31403 batch_time=0.42537 
Train Epoch: 42 codebook_update_time=0.57057
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch42.pth ...
Done in 3.783s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch42.pth ...
Done in 8.030s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.179509643793106
 quant_reg      : 5.304118293762207
 quant_err      : 5.304118293762207
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_full_val/t2v_metrics/R1: 28.772635814889338
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.488933601609657
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.366145396355854
 MSRVTT_full_val/v2t_metrics/R1: 32.99798792756539
 MSRVTT_full_val/v2t_metrics/R5: 71.42857142857143
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 95.97585513078471
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.794768611670019
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.121184782329536
 MSRVTT_full_test/t2v_metrics/R1: 11.705685618729097
 MSRVTT_full_test/t2v_metrics/R5: 33.61204013377927
 MSRVTT_full_test/t2v_metrics/R10: 46.08695652173913
 MSRVTT_full_test/t2v_metrics/R50: 76.65551839464882
 MSRVTT_full_test/t2v_metrics/MedR: 12.5
 MSRVTT_full_test/t2v_metrics/MeanR: 56.58411371237458
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.271805461379106
 MSRVTT_full_test/v2t_metrics/R1: 11.404682274247492
 MSRVTT_full_test/v2t_metrics/R5: 35.48494983277592
 MSRVTT_full_test/v2t_metrics/R10: 50.668896321070235
 MSRVTT_full_test/v2t_metrics/R50: 81.87290969899665
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.195484949832775
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.37093354725761
 mnt_best       : 26.271805461379106
 not_improved_count: 0
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 1.29288 (QuantReg: 5.28661) QuantErr: 5.28661 batch_time=36.96339 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.27008 (QuantReg: 5.35337) QuantErr: 5.35337 batch_time=0.42715 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.11045 (QuantReg: 5.26652) QuantErr: 5.26652 batch_time=0.40975 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.05674 (QuantReg: 5.36073) QuantErr: 5.36073 batch_time=0.43746 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.16039 (QuantReg: 5.35142) QuantErr: 5.35142 batch_time=0.43988 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.28683 (QuantReg: 5.39851) QuantErr: 5.39851 batch_time=0.44801 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.05888 (QuantReg: 5.27365) QuantErr: 5.27365 batch_time=0.43559 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.16213 (QuantReg: 5.29061) QuantErr: 5.29061 batch_time=0.44216 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.20080 (QuantReg: 5.32146) QuantErr: 5.32146 batch_time=0.42574 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.16115 (QuantReg: 5.25282) QuantErr: 5.25282 batch_time=0.46528 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.34455 (QuantReg: 5.33884) QuantErr: 5.33884 batch_time=0.43283 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 1.57035 (QuantReg: 5.28046) QuantErr: 5.28046 batch_time=0.42924 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.20135 (QuantReg: 5.43840) QuantErr: 5.43840 batch_time=0.43770 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 1.01488 (QuantReg: 5.31570) QuantErr: 5.31570 batch_time=0.43125 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.34952 (QuantReg: 5.32670) QuantErr: 5.32670 batch_time=0.43217 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.24776 (QuantReg: 5.32033) QuantErr: 5.32033 batch_time=0.44994 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.09751 (QuantReg: 5.24210) QuantErr: 5.24210 batch_time=0.45888 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.16872 (QuantReg: 5.35331) QuantErr: 5.35331 batch_time=0.42930 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 0.87365 (QuantReg: 5.39596) QuantErr: 5.39596 batch_time=0.45226 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.26659 (QuantReg: 5.39250) QuantErr: 5.39250 batch_time=0.43016 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.30036 (QuantReg: 5.38172) QuantErr: 5.38172 batch_time=0.95605 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 1.07598 (QuantReg: 5.32830) QuantErr: 5.32830 batch_time=0.48311 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.30486 (QuantReg: 5.35287) QuantErr: 5.35287 batch_time=0.47021 
Train Epoch: 43 codebook_update_time=0.55465
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch43.pth ...
Done in 5.901s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 1.178133399963379
 quant_reg      : 5.311366540908813
 quant_err      : 5.311366540908813
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 63.98390342052314
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.864185110663984
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.466259597282864
 MSRVTT_full_val/v2t_metrics/R1: 34.40643863179074
 MSRVTT_full_val/v2t_metrics/R5: 70.82494969818913
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.339034205231389
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.77012975895089
 MSRVTT_full_test/t2v_metrics/R1: 10.836120401337793
 MSRVTT_full_test/t2v_metrics/R5: 32.240802675585286
 MSRVTT_full_test/t2v_metrics/R10: 45.819397993311036
 MSRVTT_full_test/t2v_metrics/R50: 75.75250836120401
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 59.353678929765884
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.202464718181727
 MSRVTT_full_test/v2t_metrics/R1: 12.173913043478262
 MSRVTT_full_test/v2t_metrics/R5: 35.752508361204015
 MSRVTT_full_test/v2t_metrics/R10: 50.802675585284284
 MSRVTT_full_test/v2t_metrics/R50: 81.57190635451505
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.59314381270903
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.067760748428796
 mnt_best       : 26.271805461379106
 not_improved_count: 1
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.91155 (QuantReg: 5.40506) QuantErr: 5.40506 batch_time=42.96637 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 0.95632 (QuantReg: 5.28796) QuantErr: 5.28796 batch_time=0.44089 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.06840 (QuantReg: 5.32388) QuantErr: 5.32388 batch_time=0.46028 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.20421 (QuantReg: 5.33080) QuantErr: 5.33080 batch_time=0.43551 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.48020 (QuantReg: 5.28232) QuantErr: 5.28232 batch_time=0.42193 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 0.95671 (QuantReg: 5.15661) QuantErr: 5.15661 batch_time=0.42262 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.15106 (QuantReg: 5.37473) QuantErr: 5.37473 batch_time=0.42413 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.57185 (QuantReg: 5.35750) QuantErr: 5.35750 batch_time=0.42491 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.13657 (QuantReg: 5.35054) QuantErr: 5.35054 batch_time=0.71036 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.14886 (QuantReg: 5.30808) QuantErr: 5.30808 batch_time=0.43889 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.32302 (QuantReg: 5.49974) QuantErr: 5.49974 batch_time=0.42491 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.35869 (QuantReg: 5.33595) QuantErr: 5.33595 batch_time=0.41723 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.11628 (QuantReg: 5.33627) QuantErr: 5.33627 batch_time=0.42695 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.19416 (QuantReg: 5.25506) QuantErr: 5.25506 batch_time=0.44174 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.29255 (QuantReg: 5.36543) QuantErr: 5.36543 batch_time=0.42657 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.08060 (QuantReg: 5.42379) QuantErr: 5.42379 batch_time=0.45479 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.18001 (QuantReg: 5.20304) QuantErr: 5.20304 batch_time=0.43323 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.12610 (QuantReg: 5.18300) QuantErr: 5.18300 batch_time=0.41981 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.22393 (QuantReg: 5.27806) QuantErr: 5.27806 batch_time=0.42861 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.22764 (QuantReg: 5.35534) QuantErr: 5.35534 batch_time=0.42310 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.13639 (QuantReg: 5.29836) QuantErr: 5.29836 batch_time=0.42586 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.91819 (QuantReg: 5.26031) QuantErr: 5.26031 batch_time=0.45462 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.14591 (QuantReg: 5.36975) QuantErr: 5.36975 batch_time=0.41484 
Train Epoch: 44 codebook_update_time=0.52160
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch44.pth ...
Done in 4.286s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.18691930270195
 quant_reg      : 5.316592882156372
 quant_err      : 5.316592882156372
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 78.06841046277665
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.466800804828974
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.490590995435326
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 71.62977867203219
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 96.37826961770624
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.242454728370221
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.009207677951686
 MSRVTT_full_test/t2v_metrics/R1: 11.37123745819398
 MSRVTT_full_test/t2v_metrics/R5: 33.779264214046826
 MSRVTT_full_test/t2v_metrics/R10: 46.2876254180602
 MSRVTT_full_test/t2v_metrics/R50: 76.82274247491638
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 57.848327759197325
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.100025921204043
 MSRVTT_full_test/v2t_metrics/R1: 11.97324414715719
 MSRVTT_full_test/v2t_metrics/R5: 36.220735785953174
 MSRVTT_full_test/v2t_metrics/R10: 50.40133779264214
 MSRVTT_full_test/v2t_metrics/R50: 81.87290969899665
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.22675585284281
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.959992905071072
 mnt_best       : 26.271805461379106
 not_improved_count: 2
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.16185 (QuantReg: 5.21793) QuantErr: 5.21793 batch_time=44.58541 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.02851 (QuantReg: 5.35937) QuantErr: 5.35937 batch_time=0.41401 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 1.25085 (QuantReg: 5.31210) QuantErr: 5.31210 batch_time=0.41486 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 0.96961 (QuantReg: 5.36241) QuantErr: 5.36241 batch_time=0.44536 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.17384 (QuantReg: 5.29740) QuantErr: 5.29740 batch_time=0.41315 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 0.89310 (QuantReg: 5.33160) QuantErr: 5.33160 batch_time=0.41874 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 1.29649 (QuantReg: 5.26698) QuantErr: 5.26698 batch_time=0.41737 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.56171 (QuantReg: 5.31257) QuantErr: 5.31257 batch_time=0.41288 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.17524 (QuantReg: 5.30959) QuantErr: 5.30959 batch_time=0.42458 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 1.01765 (QuantReg: 5.24054) QuantErr: 5.24054 batch_time=0.42819 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 1.42606 (QuantReg: 5.37635) QuantErr: 5.37635 batch_time=0.44779 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.20198 (QuantReg: 5.34446) QuantErr: 5.34446 batch_time=0.41402 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.15883 (QuantReg: 5.37733) QuantErr: 5.37733 batch_time=0.41263 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.22451 (QuantReg: 5.35030) QuantErr: 5.35030 batch_time=0.41028 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.24714 (QuantReg: 5.40963) QuantErr: 5.40963 batch_time=0.45105 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 1.03056 (QuantReg: 5.32010) QuantErr: 5.32010 batch_time=0.41821 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.03795 (QuantReg: 5.32721) QuantErr: 5.32721 batch_time=0.45112 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.18234 (QuantReg: 5.39304) QuantErr: 5.39304 batch_time=0.43667 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.91590 (QuantReg: 5.41164) QuantErr: 5.41164 batch_time=0.42443 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 1.22925 (QuantReg: 5.29288) QuantErr: 5.29288 batch_time=0.42435 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.23033 (QuantReg: 5.33438) QuantErr: 5.33438 batch_time=0.43649 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.90418 (QuantReg: 5.36070) QuantErr: 5.36070 batch_time=0.42574 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.21787 (QuantReg: 5.27875) QuantErr: 5.27875 batch_time=0.45705 
Train Epoch: 45 codebook_update_time=0.56004
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch45.pth ...
Done in 4.193s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 1.1661154322624208
 quant_reg      : 5.341550634384156
 quant_err      : 5.341550634384156
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_full_val/t2v_metrics/R1: 30.784708249496983
 MSRVTT_full_val/t2v_metrics/R5: 66.59959758551308
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.41851106639839
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.43467971320139
 MSRVTT_full_val/v2t_metrics/R1: 34.00402414486921
 MSRVTT_full_val/v2t_metrics/R5: 71.83098591549296
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.210261569416499
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.57824473949547
 MSRVTT_full_test/t2v_metrics/R1: 11.404682274247492
 MSRVTT_full_test/t2v_metrics/R5: 33.17725752508361
 MSRVTT_full_test/t2v_metrics/R10: 46.98996655518395
 MSRVTT_full_test/t2v_metrics/R50: 76.72240802675586
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 59.77341137123746
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.10014600520361
 MSRVTT_full_test/v2t_metrics/R1: 12.408026755852843
 MSRVTT_full_test/v2t_metrics/R5: 36.48829431438127
 MSRVTT_full_test/v2t_metrics/R10: 51.23745819397993
 MSRVTT_full_test/v2t_metrics/R50: 82.04013377926421
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.09916387959866
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.519897051663822
 mnt_best       : 26.271805461379106
 not_improved_count: 3
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 1.16046 (QuantReg: 5.24197) QuantErr: 5.24197 batch_time=34.88413 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.09220 (QuantReg: 5.40741) QuantErr: 5.40741 batch_time=0.42962 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.96847 (QuantReg: 5.30468) QuantErr: 5.30468 batch_time=0.41463 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.01410 (QuantReg: 5.33964) QuantErr: 5.33964 batch_time=0.43439 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.31532 (QuantReg: 5.34890) QuantErr: 5.34890 batch_time=0.45055 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.00810 (QuantReg: 5.31398) QuantErr: 5.31398 batch_time=0.43607 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.32871 (QuantReg: 5.40572) QuantErr: 5.40572 batch_time=1.24279 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.28640 (QuantReg: 5.38519) QuantErr: 5.38519 batch_time=0.42756 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 1.28586 (QuantReg: 5.32659) QuantErr: 5.32659 batch_time=0.43069 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 1.22341 (QuantReg: 5.29193) QuantErr: 5.29193 batch_time=0.42457 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 0.94476 (QuantReg: 5.22680) QuantErr: 5.22680 batch_time=0.42605 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.20906 (QuantReg: 5.35143) QuantErr: 5.35143 batch_time=0.41318 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.43832 (QuantReg: 5.34545) QuantErr: 5.34545 batch_time=0.42740 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.16894 (QuantReg: 5.27973) QuantErr: 5.27973 batch_time=1.71056 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.09982 (QuantReg: 5.37279) QuantErr: 5.37279 batch_time=0.70283 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.04066 (QuantReg: 5.42912) QuantErr: 5.42912 batch_time=0.41866 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.24826 (QuantReg: 5.39215) QuantErr: 5.39215 batch_time=0.42461 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.15794 (QuantReg: 5.36193) QuantErr: 5.36193 batch_time=0.43665 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 1.07850 (QuantReg: 5.37643) QuantErr: 5.37643 batch_time=0.41611 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.98137 (QuantReg: 5.50742) QuantErr: 5.50742 batch_time=0.42377 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.94236 (QuantReg: 5.28875) QuantErr: 5.28875 batch_time=0.42986 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.07327 (QuantReg: 5.35008) QuantErr: 5.35008 batch_time=0.42907 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.97108 (QuantReg: 5.40175) QuantErr: 5.40175 batch_time=0.43199 
Train Epoch: 46 codebook_update_time=0.52843
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch46.pth ...
Done in 4.247s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 1.1768798644542695
 quant_reg      : 5.344155754089355
 quant_err      : 5.344155754089355
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_full_val/t2v_metrics/R1: 31.187122736418512
 MSRVTT_full_val/t2v_metrics/R5: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R10: 78.06841046277665
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.442655935613683
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.47568908015777
 MSRVTT_full_val/v2t_metrics/R1: 35.412474849094565
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 82.49496981891348
 MSRVTT_full_val/v2t_metrics/R50: 96.579476861167
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.103621730382294
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.25752932646668
 MSRVTT_full_test/t2v_metrics/R1: 11.17056856187291
 MSRVTT_full_test/t2v_metrics/R5: 33.17725752508361
 MSRVTT_full_test/t2v_metrics/R10: 45.618729096989966
 MSRVTT_full_test/t2v_metrics/R50: 76.22073578595318
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 61.45033444816053
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.665692189578376
 MSRVTT_full_test/v2t_metrics/R1: 12.709030100334449
 MSRVTT_full_test/v2t_metrics/R5: 37.525083612040135
 MSRVTT_full_test/v2t_metrics/R10: 51.77257525083612
 MSRVTT_full_test/v2t_metrics/R50: 82.10702341137124
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.37073578595318
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.119100029026338
 mnt_best       : 26.271805461379106
 not_improved_count: 4
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.16232 (QuantReg: 5.42595) QuantErr: 5.42595 batch_time=41.10103 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.29303 (QuantReg: 5.32606) QuantErr: 5.32606 batch_time=0.42733 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.12049 (QuantReg: 5.27771) QuantErr: 5.27771 batch_time=0.43619 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.14570 (QuantReg: 5.34086) QuantErr: 5.34086 batch_time=0.55885 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.31266 (QuantReg: 5.39981) QuantErr: 5.39981 batch_time=0.46136 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 1.09473 (QuantReg: 5.27383) QuantErr: 5.27383 batch_time=0.65101 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.55935 (QuantReg: 5.33683) QuantErr: 5.33683 batch_time=0.41139 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.09602 (QuantReg: 5.26816) QuantErr: 5.26816 batch_time=0.44620 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.05918 (QuantReg: 5.38832) QuantErr: 5.38832 batch_time=0.42840 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 1.02414 (QuantReg: 5.36300) QuantErr: 5.36300 batch_time=0.72945 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 1.48168 (QuantReg: 5.27319) QuantErr: 5.27319 batch_time=0.41714 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 1.02220 (QuantReg: 5.39261) QuantErr: 5.39261 batch_time=0.43598 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.28658 (QuantReg: 5.48647) QuantErr: 5.48647 batch_time=0.42158 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.17735 (QuantReg: 5.33398) QuantErr: 5.33398 batch_time=0.42284 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.31927 (QuantReg: 5.31589) QuantErr: 5.31589 batch_time=0.46612 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.18549 (QuantReg: 5.41673) QuantErr: 5.41673 batch_time=0.42444 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.47261 (QuantReg: 5.29187) QuantErr: 5.29187 batch_time=0.41268 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.02073 (QuantReg: 5.42112) QuantErr: 5.42112 batch_time=0.42917 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.14151 (QuantReg: 5.37836) QuantErr: 5.37836 batch_time=0.45746 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.26518 (QuantReg: 5.37513) QuantErr: 5.37513 batch_time=0.57036 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 1.36377 (QuantReg: 5.40409) QuantErr: 5.40409 batch_time=0.44474 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.09055 (QuantReg: 5.34863) QuantErr: 5.34863 batch_time=0.48164 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.15510 (QuantReg: 5.34862) QuantErr: 5.34862 batch_time=0.43038 
Train Epoch: 47 codebook_update_time=0.50051
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch47.pth ...
Done in 18.804s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 1.206494840145111
 quant_reg      : 5.358087999343872
 quant_err      : 5.358087999343872
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 67.00201207243461
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.51609657947686
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.66719602753678
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 71.62977867203219
 MSRVTT_full_val/v2t_metrics/R10: 81.69014084507042
 MSRVTT_full_val/v2t_metrics/R50: 96.17706237424547
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.501006036217305
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.62015811778735
 MSRVTT_full_test/t2v_metrics/R1: 11.103678929765886
 MSRVTT_full_test/t2v_metrics/R5: 33.74581939799331
 MSRVTT_full_test/t2v_metrics/R10: 46.52173913043478
 MSRVTT_full_test/t2v_metrics/R50: 76.35451505016722
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 60.85033444816054
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.928711668424665
 MSRVTT_full_test/v2t_metrics/R1: 11.73913043478261
 MSRVTT_full_test/v2t_metrics/R5: 37.05685618729097
 MSRVTT_full_test/v2t_metrics/R10: 52.0066889632107
 MSRVTT_full_test/v2t_metrics/R50: 82.64214046822742
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.33545150501672
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.282723976990642
 mnt_best       : 26.271805461379106
 not_improved_count: 5
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.31922 (QuantReg: 5.27428) QuantErr: 5.27428 batch_time=36.35066 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.31480 (QuantReg: 5.39349) QuantErr: 5.39349 batch_time=0.47491 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.02333 (QuantReg: 5.37687) QuantErr: 5.37687 batch_time=1.42282 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.13421 (QuantReg: 5.40327) QuantErr: 5.40327 batch_time=0.44353 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.12986 (QuantReg: 5.28549) QuantErr: 5.28549 batch_time=0.42798 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.12954 (QuantReg: 5.41519) QuantErr: 5.41519 batch_time=0.44971 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.29392 (QuantReg: 5.40267) QuantErr: 5.40267 batch_time=0.43833 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.11281 (QuantReg: 5.34724) QuantErr: 5.34724 batch_time=0.43280 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.12318 (QuantReg: 5.39854) QuantErr: 5.39854 batch_time=0.42300 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.04979 (QuantReg: 5.32340) QuantErr: 5.32340 batch_time=0.43103 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.05581 (QuantReg: 5.36699) QuantErr: 5.36699 batch_time=0.42881 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.27555 (QuantReg: 5.33746) QuantErr: 5.33746 batch_time=0.43256 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.16701 (QuantReg: 5.31667) QuantErr: 5.31667 batch_time=2.25823 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.22856 (QuantReg: 5.43017) QuantErr: 5.43017 batch_time=0.45197 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.13152 (QuantReg: 5.48723) QuantErr: 5.48723 batch_time=0.43718 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.36938 (QuantReg: 5.28925) QuantErr: 5.28925 batch_time=0.42798 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 1.01824 (QuantReg: 5.46291) QuantErr: 5.46291 batch_time=0.46342 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.26983 (QuantReg: 5.35308) QuantErr: 5.35308 batch_time=0.44933 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.46029 (QuantReg: 5.38996) QuantErr: 5.38996 batch_time=0.44019 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.27979 (QuantReg: 5.41599) QuantErr: 5.41599 batch_time=0.44066 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.18837 (QuantReg: 5.41092) QuantErr: 5.41092 batch_time=0.43946 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.47395 (QuantReg: 5.43932) QuantErr: 5.43932 batch_time=0.43551 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.38606 (QuantReg: 5.29337) QuantErr: 5.29337 batch_time=0.68227 
Train Epoch: 48 codebook_update_time=0.61014
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch48.pth ...
Done in 4.301s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 1.2104524836540222
 quant_reg      : 5.374192739486694
 quant_err      : 5.374192739486694
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 65.99597585513078
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.706237424547284
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.65298456689547
 MSRVTT_full_val/v2t_metrics/R1: 35.2112676056338
 MSRVTT_full_val/v2t_metrics/R5: 72.23340040241449
 MSRVTT_full_val/v2t_metrics/R10: 82.897384305835
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.331991951710261
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.5187108080082
 MSRVTT_full_test/t2v_metrics/R1: 11.33779264214047
 MSRVTT_full_test/t2v_metrics/R5: 33.34448160535117
 MSRVTT_full_test/t2v_metrics/R10: 46.45484949832776
 MSRVTT_full_test/t2v_metrics/R50: 76.8561872909699
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 60.71655518394649
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.99328562909205
 MSRVTT_full_test/v2t_metrics/R1: 12.441471571906355
 MSRVTT_full_test/v2t_metrics/R5: 37.95986622073578
 MSRVTT_full_test/v2t_metrics/R10: 52.274247491638796
 MSRVTT_full_test/v2t_metrics/R50: 82.34113712374582
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.14916387959866
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.117990822656207
 mnt_best       : 26.271805461379106
 not_improved_count: 6
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 0.94645 (QuantReg: 5.27742) QuantErr: 5.27742 batch_time=43.71160 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.09359 (QuantReg: 5.40083) QuantErr: 5.40083 batch_time=0.44368 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.25191 (QuantReg: 5.34313) QuantErr: 5.34313 batch_time=0.43523 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.26470 (QuantReg: 5.46361) QuantErr: 5.46361 batch_time=0.44570 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.02179 (QuantReg: 5.40590) QuantErr: 5.40590 batch_time=0.43125 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.37385 (QuantReg: 5.43134) QuantErr: 5.43134 batch_time=0.42522 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.31866 (QuantReg: 5.45863) QuantErr: 5.45863 batch_time=0.42468 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 1.07555 (QuantReg: 5.29261) QuantErr: 5.29261 batch_time=0.41602 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 1.22761 (QuantReg: 5.33572) QuantErr: 5.33572 batch_time=0.41857 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.10525 (QuantReg: 5.37353) QuantErr: 5.37353 batch_time=0.41673 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.21646 (QuantReg: 5.37166) QuantErr: 5.37166 batch_time=0.42747 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.35460 (QuantReg: 5.30553) QuantErr: 5.30553 batch_time=0.42952 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.44738 (QuantReg: 5.30701) QuantErr: 5.30701 batch_time=1.70776 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.16485 (QuantReg: 5.43236) QuantErr: 5.43236 batch_time=0.40870 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.18135 (QuantReg: 5.43233) QuantErr: 5.43233 batch_time=0.41908 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 1.16464 (QuantReg: 5.40511) QuantErr: 5.40511 batch_time=0.42665 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 1.03440 (QuantReg: 5.33790) QuantErr: 5.33790 batch_time=0.43049 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.30631 (QuantReg: 5.35806) QuantErr: 5.35806 batch_time=0.41590 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.18387 (QuantReg: 5.44859) QuantErr: 5.44859 batch_time=0.40879 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.35300 (QuantReg: 5.36716) QuantErr: 5.36716 batch_time=0.44341 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.21160 (QuantReg: 5.43489) QuantErr: 5.43489 batch_time=0.42111 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.85632 (QuantReg: 5.40963) QuantErr: 5.40963 batch_time=0.43418 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.17486 (QuantReg: 5.37407) QuantErr: 5.37407 batch_time=0.40866 
Train Epoch: 49 codebook_update_time=0.53878
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch49.pth ...
Done in 4.628s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 1.2103668715953826
 quant_reg      : 5.378863889694214
 quant_err      : 5.378863889694214
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 77.8672032193159
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.545271629778671
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.499696309647334
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 71.0261569416499
 MSRVTT_full_val/v2t_metrics/R10: 82.49496981891348
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.638832997987928
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.29073872428337
 MSRVTT_full_test/t2v_metrics/R1: 11.003344481605351
 MSRVTT_full_test/t2v_metrics/R5: 33.41137123745819
 MSRVTT_full_test/t2v_metrics/R10: 46.32107023411371
 MSRVTT_full_test/t2v_metrics/R50: 75.61872909698997
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 63.06772575250836
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.727595454871672
 MSRVTT_full_test/v2t_metrics/R1: 12.842809364548495
 MSRVTT_full_test/v2t_metrics/R5: 36.65551839464883
 MSRVTT_full_test/v2t_metrics/R10: 50.836120401337794
 MSRVTT_full_test/v2t_metrics/R50: 82.10702341137124
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.0010033444816
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.81756405433258
 mnt_best       : 26.271805461379106
 not_improved_count: 7
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.13797 (QuantReg: 5.39532) QuantErr: 5.39532 batch_time=34.74834 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.06381 (QuantReg: 5.34813) QuantErr: 5.34813 batch_time=0.43822 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.16297 (QuantReg: 5.42723) QuantErr: 5.42723 batch_time=0.44211 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.12239 (QuantReg: 5.41868) QuantErr: 5.41868 batch_time=0.43502 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.42668 (QuantReg: 5.30113) QuantErr: 5.30113 batch_time=0.45217 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 1.07260 (QuantReg: 5.42121) QuantErr: 5.42121 batch_time=0.43563 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.20493 (QuantReg: 5.42016) QuantErr: 5.42016 batch_time=0.43050 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 1.33573 (QuantReg: 5.38179) QuantErr: 5.38179 batch_time=0.51934 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 1.20977 (QuantReg: 5.38757) QuantErr: 5.38757 batch_time=0.42723 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.14228 (QuantReg: 5.34440) QuantErr: 5.34440 batch_time=0.43740 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.20130 (QuantReg: 5.35475) QuantErr: 5.35475 batch_time=0.43004 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 1.21849 (QuantReg: 5.49617) QuantErr: 5.49617 batch_time=0.42414 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.24019 (QuantReg: 5.39952) QuantErr: 5.39952 batch_time=0.42598 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.15217 (QuantReg: 5.27578) QuantErr: 5.27578 batch_time=0.44859 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.49242 (QuantReg: 5.38496) QuantErr: 5.38496 batch_time=0.43470 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 1.03407 (QuantReg: 5.49131) QuantErr: 5.49131 batch_time=0.43998 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.38331 (QuantReg: 5.41145) QuantErr: 5.41145 batch_time=0.44521 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.47342 (QuantReg: 5.43943) QuantErr: 5.43943 batch_time=0.42622 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.91845 (QuantReg: 5.42536) QuantErr: 5.42536 batch_time=1.56475 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 1.21315 (QuantReg: 5.46355) QuantErr: 5.46355 batch_time=0.40628 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.14655 (QuantReg: 5.36637) QuantErr: 5.36637 batch_time=0.42764 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.24909 (QuantReg: 5.39736) QuantErr: 5.39736 batch_time=0.42639 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.32868 (QuantReg: 5.38527) QuantErr: 5.38527 batch_time=0.41426 
Train Epoch: 50 codebook_update_time=0.50580
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch50.pth ...
Done in 4.042s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/checkpoint-epoch50.pth ...
Done in 7.906s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 1.2108783102035523
 quant_reg      : 5.394394493103027
 quant_err      : 5.394394493103027
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 95.57344064386318
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.498993963782697
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.4482766846844
 MSRVTT_full_val/v2t_metrics/R1: 34.80885311871227
 MSRVTT_full_val/v2t_metrics/R5: 71.83098591549296
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.49195171026157
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.37170139769807
 MSRVTT_full_test/t2v_metrics/R1: 11.605351170568563
 MSRVTT_full_test/t2v_metrics/R5: 33.44481605351171
 MSRVTT_full_test/t2v_metrics/R10: 46.8561872909699
 MSRVTT_full_test/t2v_metrics/R50: 75.81939799331104
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 62.06471571906354
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.29771503713386
 MSRVTT_full_test/v2t_metrics/R1: 11.906354515050166
 MSRVTT_full_test/v2t_metrics/R5: 36.98996655518395
 MSRVTT_full_test/v2t_metrics/R10: 51.77257525083612
 MSRVTT_full_test/v2t_metrics/R50: 82.3076923076923
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.63160535117057
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.356600982636213
 mnt_best       : 26.29771503713386
 not_improved_count: 0
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/trained_model.pth ...
Ckpt loaded at epoch 50.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 11.605351170568563
 t2v_metrics/R5/final_eval: 33.44481605351171
 t2v_metrics/R10/final_eval: 46.8561872909699
 t2v_metrics/R50/final_eval: 75.81939799331104
 t2v_metrics/MedR/final_eval: 12.0
 t2v_metrics/MeanR/final_eval: 62.06505016722408
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 26.29771503713386
 v2t_metrics/R1/final_eval: 11.939799331103679
 v2t_metrics/R5/final_eval: 36.98996655518395
 v2t_metrics/R10/final_eval: 51.77257525083612
 v2t_metrics/R50/final_eval: 82.3076923076923
 v2t_metrics/MedR/final_eval: 10.0
 v2t_metrics/MeanR/final_eval: 44.631270903010034
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 28.38312728527201
Best epoch for the monitored metric: 50
Script took 04h21m10s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_M8/trained_model.pth
