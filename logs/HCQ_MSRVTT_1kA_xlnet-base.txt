Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 436.2964913845062 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 44.73980689048767 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 24.704132080078125 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch0.pth ...
Done in 1.539s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch0.pth ...
Done in 3.059s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 505.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 498.932
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.2884499140614817
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 0.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 502.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 498.875
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3556893304490063
 mnt_best       : 0.2884499140614817
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.84054 (QuantReg: 22.29313) QuantErr: 22.29313 batch_time=24.29934 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 9.70549 (QuantReg: 22.34831) QuantErr: 22.34831 batch_time=3.44769 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 9.46065 (QuantReg: 22.68459) QuantErr: 22.68459 batch_time=0.57552 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 8.30529 (QuantReg: 22.68397) QuantErr: 22.68397 batch_time=0.83857 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 7.31539 (QuantReg: 22.68751) QuantErr: 22.68751 batch_time=0.57026 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.45569 (QuantReg: 22.75226) QuantErr: 22.75226 batch_time=0.80848 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 6.32975 (QuantReg: 22.74510) QuantErr: 22.74510 batch_time=0.60332 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 6.18967 (QuantReg: 22.78173) QuantErr: 22.78173 batch_time=0.60385 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.67447 (QuantReg: 22.67250) QuantErr: 22.67250 batch_time=0.56278 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.52493 (QuantReg: 22.66192) QuantErr: 22.66192 batch_time=1.34023 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.08152 (QuantReg: 22.72320) QuantErr: 22.72320 batch_time=0.57515 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 5.24552 (QuantReg: 22.65338) QuantErr: 22.65338 batch_time=0.57449 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 4.93284 (QuantReg: 22.72827) QuantErr: 22.72827 batch_time=0.61503 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 5.20846 (QuantReg: 22.67856) QuantErr: 22.67856 batch_time=0.55655 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 5.05965 (QuantReg: 22.75234) QuantErr: 22.75234 batch_time=0.58941 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.89297 (QuantReg: 22.69906) QuantErr: 22.69906 batch_time=0.56487 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.96006 (QuantReg: 22.71171) QuantErr: 22.71171 batch_time=0.58964 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.59777 (QuantReg: 22.72224) QuantErr: 22.72224 batch_time=0.57588 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.90249 (QuantReg: 22.69827) QuantErr: 22.69827 batch_time=0.57139 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.31339 (QuantReg: 22.69985) QuantErr: 22.69985 batch_time=0.58755 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.46399 (QuantReg: 22.73879) QuantErr: 22.73879 batch_time=0.86747 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.53642 (QuantReg: 22.70972) QuantErr: 22.70972 batch_time=0.57005 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.85661 (QuantReg: 22.69503) QuantErr: 22.69503 batch_time=0.56870 
Train Epoch: 1 codebook_update_time=1.99167
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch1.pth ...
Done in 4.217s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch1.pth ...
Done in 8.368s
 epoch          : 1
 loss           : 5.90193466758728
 quant_reg      : 22.67569789123535
 quant_err      : 22.67569789123535
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 10.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 31.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 46.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 78.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 43.313
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.88531738703393
 MSRVTT_jsfusion_test/v2t_metrics/R1: 10.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 34.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 47.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 78.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 42.479
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.05724271578273
 mnt_best       : 24.88531738703393
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.37589 (QuantReg: 11.50677) QuantErr: 11.50677 batch_time=26.98476 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 3.96637 (QuantReg: 11.28447) QuantErr: 11.28447 batch_time=0.57492 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.02971 (QuantReg: 12.16400) QuantErr: 12.16400 batch_time=0.58334 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.98573 (QuantReg: 12.10721) QuantErr: 12.10721 batch_time=0.58772 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 4.06700 (QuantReg: 12.19834) QuantErr: 12.19834 batch_time=0.62069 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 4.04999 (QuantReg: 11.75603) QuantErr: 11.75603 batch_time=0.58117 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.32400 (QuantReg: 12.56432) QuantErr: 12.56432 batch_time=0.59058 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.75331 (QuantReg: 12.64065) QuantErr: 12.64065 batch_time=0.57105 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 4.06689 (QuantReg: 12.80527) QuantErr: 12.80527 batch_time=0.56899 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 3.74627 (QuantReg: 12.67505) QuantErr: 12.67505 batch_time=0.62510 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.70690 (QuantReg: 12.89439) QuantErr: 12.89439 batch_time=0.57098 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 4.12750 (QuantReg: 13.56123) QuantErr: 13.56123 batch_time=0.60788 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.45504 (QuantReg: 13.19329) QuantErr: 13.19329 batch_time=0.66120 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 3.47490 (QuantReg: 13.04741) QuantErr: 13.04741 batch_time=0.57791 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.60430 (QuantReg: 13.77944) QuantErr: 13.77944 batch_time=0.56972 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.38320 (QuantReg: 14.05640) QuantErr: 14.05640 batch_time=0.57158 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.59627 (QuantReg: 14.77867) QuantErr: 14.77867 batch_time=0.57673 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.81339 (QuantReg: 13.75703) QuantErr: 13.75703 batch_time=0.59395 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 4.32929 (QuantReg: 14.39455) QuantErr: 14.39455 batch_time=0.57107 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.08175 (QuantReg: 14.77148) QuantErr: 14.77148 batch_time=4.74426 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.61981 (QuantReg: 14.03590) QuantErr: 14.03590 batch_time=0.57343 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.41266 (QuantReg: 14.76414) QuantErr: 14.76414 batch_time=0.56734 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.97129 (QuantReg: 15.04668) QuantErr: 15.04668 batch_time=0.57204 
Train Epoch: 2 codebook_update_time=1.63567
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch2.pth ...
Done in 4.070s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch2.pth ...
Done in 8.388s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 3.807250259399414
 quant_reg      : 13.250363544464111
 quant_err      : 13.250363544464111
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 39.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 33.342
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.302926842705066
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 53.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.55
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.97246981164826
 mnt_best       : 31.302926842705066
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 4.06451 (QuantReg: 11.40883) QuantErr: 11.40883 batch_time=29.78369 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.61699 (QuantReg: 11.31238) QuantErr: 11.31238 batch_time=0.59373 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.40254 (QuantReg: 11.37488) QuantErr: 11.37488 batch_time=0.67215 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 3.78288 (QuantReg: 11.77617) QuantErr: 11.77617 batch_time=0.64821 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.42063 (QuantReg: 12.12808) QuantErr: 12.12808 batch_time=0.56857 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 3.85512 (QuantReg: 11.61159) QuantErr: 11.61159 batch_time=0.57415 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.39296 (QuantReg: 11.80841) QuantErr: 11.80841 batch_time=1.72491 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.06152 (QuantReg: 11.97360) QuantErr: 11.97360 batch_time=0.63614 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.27318 (QuantReg: 12.55697) QuantErr: 12.55697 batch_time=0.58901 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 3.53747 (QuantReg: 12.12883) QuantErr: 12.12883 batch_time=0.58999 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 2.87562 (QuantReg: 12.77136) QuantErr: 12.77136 batch_time=0.56998 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.00095 (QuantReg: 12.50315) QuantErr: 12.50315 batch_time=0.59453 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.15885 (QuantReg: 12.16077) QuantErr: 12.16077 batch_time=0.59134 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.28026 (QuantReg: 12.55401) QuantErr: 12.55401 batch_time=0.75386 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 2.85919 (QuantReg: 13.17169) QuantErr: 13.17169 batch_time=0.58035 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 3.39488 (QuantReg: 12.58823) QuantErr: 12.58823 batch_time=0.59392 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 2.98163 (QuantReg: 13.17865) QuantErr: 13.17865 batch_time=0.57598 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.28495 (QuantReg: 12.91614) QuantErr: 12.91614 batch_time=0.59750 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.50617 (QuantReg: 12.99412) QuantErr: 12.99412 batch_time=0.60459 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.62685 (QuantReg: 12.86925) QuantErr: 12.86925 batch_time=0.93257 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.27586 (QuantReg: 13.15309) QuantErr: 13.15309 batch_time=0.57328 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.32855 (QuantReg: 13.13085) QuantErr: 13.13085 batch_time=0.56082 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 2.85898 (QuantReg: 13.13367) QuantErr: 13.13367 batch_time=0.58171 
Train Epoch: 3 codebook_update_time=1.66513
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch3.pth ...
Done in 4.049s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch3.pth ...
Done in 8.199s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 3.26495304107666
 quant_reg      : 12.386537803649903
 quant_err      : 12.386537803649903
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 84.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.634
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.86942340122338
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.8305
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.27744155563768
 mnt_best       : 32.86942340122338
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 3.32005 (QuantReg: 11.81098) QuantErr: 11.81098 batch_time=29.72559 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 3.09972 (QuantReg: 12.15645) QuantErr: 12.15645 batch_time=0.57137 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.73058 (QuantReg: 11.86332) QuantErr: 11.86332 batch_time=0.55523 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.97440 (QuantReg: 12.18102) QuantErr: 12.18102 batch_time=0.57521 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 3.04128 (QuantReg: 12.40923) QuantErr: 12.40923 batch_time=0.58487 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 2.98098 (QuantReg: 11.61537) QuantErr: 11.61537 batch_time=0.57320 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.82425 (QuantReg: 12.01124) QuantErr: 12.01124 batch_time=0.63085 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.93330 (QuantReg: 12.33336) QuantErr: 12.33336 batch_time=0.58853 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 2.89688 (QuantReg: 12.07626) QuantErr: 12.07626 batch_time=0.58442 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 3.15210 (QuantReg: 12.28839) QuantErr: 12.28839 batch_time=0.56666 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 3.30838 (QuantReg: 12.04938) QuantErr: 12.04938 batch_time=0.58474 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 3.17885 (QuantReg: 12.47266) QuantErr: 12.47266 batch_time=0.56377 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.30652 (QuantReg: 12.22653) QuantErr: 12.22653 batch_time=0.57701 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 3.20148 (QuantReg: 12.70078) QuantErr: 12.70078 batch_time=0.78401 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.69487 (QuantReg: 12.80402) QuantErr: 12.80402 batch_time=0.59847 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.78739 (QuantReg: 12.81676) QuantErr: 12.81676 batch_time=0.57249 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 3.02102 (QuantReg: 12.78078) QuantErr: 12.78078 batch_time=0.56205 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.15850 (QuantReg: 12.89877) QuantErr: 12.89877 batch_time=0.54919 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.35127 (QuantReg: 13.06323) QuantErr: 13.06323 batch_time=0.58163 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.43033 (QuantReg: 12.54230) QuantErr: 12.54230 batch_time=0.58508 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.79877 (QuantReg: 12.85304) QuantErr: 12.85304 batch_time=0.57656 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.91148 (QuantReg: 12.50231) QuantErr: 12.50231 batch_time=0.58421 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.82110 (QuantReg: 12.69834) QuantErr: 12.69834 batch_time=0.62339 
Train Epoch: 4 codebook_update_time=1.79759
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch4.pth ...
Done in 4.113s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch4.pth ...
Done in 8.318s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 2.841179857254028
 quant_reg      : 12.401679286956787
 quant_err      : 12.401679286956787
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.188
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.78090730554604
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.90878040575703
 mnt_best       : 34.78090730554604
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.81426 (QuantReg: 11.82159) QuantErr: 11.82159 batch_time=28.84169 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 2.57024 (QuantReg: 12.14781) QuantErr: 12.14781 batch_time=0.58852 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.87176 (QuantReg: 11.81578) QuantErr: 11.81578 batch_time=0.58058 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.53592 (QuantReg: 11.82706) QuantErr: 11.82706 batch_time=0.56640 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.82722 (QuantReg: 11.79838) QuantErr: 11.79838 batch_time=0.56986 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.68183 (QuantReg: 12.29662) QuantErr: 12.29662 batch_time=0.58011 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.87605 (QuantReg: 12.11109) QuantErr: 12.11109 batch_time=0.57332 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 2.63637 (QuantReg: 12.27989) QuantErr: 12.27989 batch_time=0.57772 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 3.06344 (QuantReg: 12.03049) QuantErr: 12.03049 batch_time=1.21919 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.41739 (QuantReg: 12.22333) QuantErr: 12.22333 batch_time=0.56385 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.55519 (QuantReg: 12.08986) QuantErr: 12.08986 batch_time=0.60527 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 3.16405 (QuantReg: 12.55936) QuantErr: 12.55936 batch_time=0.57888 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.54614 (QuantReg: 12.43358) QuantErr: 12.43358 batch_time=0.58106 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 3.03184 (QuantReg: 12.68514) QuantErr: 12.68514 batch_time=1.37826 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.57235 (QuantReg: 12.17510) QuantErr: 12.17510 batch_time=0.56827 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.43501 (QuantReg: 12.55849) QuantErr: 12.55849 batch_time=0.57343 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.46401 (QuantReg: 12.76454) QuantErr: 12.76454 batch_time=0.60903 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.35875 (QuantReg: 12.68642) QuantErr: 12.68642 batch_time=0.56390 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.44364 (QuantReg: 12.55652) QuantErr: 12.55652 batch_time=0.79061 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.68301 (QuantReg: 12.63165) QuantErr: 12.63165 batch_time=4.76853 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.77011 (QuantReg: 12.57499) QuantErr: 12.57499 batch_time=0.56907 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.08244 (QuantReg: 12.60575) QuantErr: 12.60575 batch_time=0.57184 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.44587 (QuantReg: 12.54423) QuantErr: 12.54423 batch_time=1.28988 
Train Epoch: 5 codebook_update_time=1.61687
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch5.pth ...
Done in 4.127s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch5.pth ...
Done in 15.676s
removing stale ckpt [epoch 4] [took 0.02s]
 epoch          : 5
 loss           : 2.5538583035469054
 quant_reg      : 12.386424171447754
 quant_err      : 12.386424171447754
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.632
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.03079955549883
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.3495
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.96521640252832
 mnt_best       : 35.03079955549883
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.06718 (QuantReg: 12.05209) QuantErr: 12.05209 batch_time=29.48187 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.60240 (QuantReg: 11.79144) QuantErr: 11.79144 batch_time=0.56740 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.39761 (QuantReg: 12.04591) QuantErr: 12.04591 batch_time=0.61844 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.44757 (QuantReg: 12.53799) QuantErr: 12.53799 batch_time=1.14810 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.22292 (QuantReg: 12.19514) QuantErr: 12.19514 batch_time=0.56889 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.72469 (QuantReg: 12.28425) QuantErr: 12.28425 batch_time=0.62171 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.43155 (QuantReg: 12.32638) QuantErr: 12.32638 batch_time=0.59768 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.36219 (QuantReg: 12.29386) QuantErr: 12.29386 batch_time=0.56473 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.45589 (QuantReg: 12.50930) QuantErr: 12.50930 batch_time=1.02540 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.34382 (QuantReg: 12.58570) QuantErr: 12.58570 batch_time=0.58703 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.53843 (QuantReg: 12.45951) QuantErr: 12.45951 batch_time=0.57122 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.38925 (QuantReg: 12.37466) QuantErr: 12.37466 batch_time=0.59959 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.35088 (QuantReg: 12.60876) QuantErr: 12.60876 batch_time=0.57374 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.30098 (QuantReg: 12.80968) QuantErr: 12.80968 batch_time=1.04682 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.65479 (QuantReg: 12.68843) QuantErr: 12.68843 batch_time=0.60290 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.32803 (QuantReg: 12.31082) QuantErr: 12.31082 batch_time=0.57939 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.99422 (QuantReg: 12.69497) QuantErr: 12.69497 batch_time=0.58358 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.57307 (QuantReg: 12.35843) QuantErr: 12.35843 batch_time=0.57316 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.53196 (QuantReg: 12.48500) QuantErr: 12.48500 batch_time=0.57100 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.59714 (QuantReg: 12.87071) QuantErr: 12.87071 batch_time=0.76024 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 1.79055 (QuantReg: 12.65143) QuantErr: 12.65143 batch_time=0.62555 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.21350 (QuantReg: 12.68088) QuantErr: 12.68088 batch_time=0.56829 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.16487 (QuantReg: 13.16908) QuantErr: 13.16908 batch_time=0.56884 
Train Epoch: 6 codebook_update_time=1.61843
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch6.pth ...
Done in 14.243s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch6.pth ...
Done in 18.321s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 2.36727965593338
 quant_reg      : 12.516217182159425
 quant_err      : 12.516217182159425
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.536
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.68744655005674
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.558
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.26237627615433
 mnt_best       : 36.68744655005674
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.40747 (QuantReg: 12.29937) QuantErr: 12.29937 batch_time=31.00992 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 1.75980 (QuantReg: 12.14509) QuantErr: 12.14509 batch_time=0.59198 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.19466 (QuantReg: 12.72346) QuantErr: 12.72346 batch_time=0.60871 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.39028 (QuantReg: 12.42155) QuantErr: 12.42155 batch_time=0.56529 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 1.83221 (QuantReg: 12.33153) QuantErr: 12.33153 batch_time=0.57114 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.15598 (QuantReg: 12.11944) QuantErr: 12.11944 batch_time=0.56592 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.01997 (QuantReg: 12.76737) QuantErr: 12.76737 batch_time=0.56084 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.30283 (QuantReg: 12.57315) QuantErr: 12.57315 batch_time=0.55246 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 1.96081 (QuantReg: 12.83190) QuantErr: 12.83190 batch_time=0.57546 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.12341 (QuantReg: 12.88510) QuantErr: 12.88510 batch_time=0.58302 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.52723 (QuantReg: 12.35839) QuantErr: 12.35839 batch_time=0.57153 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.23038 (QuantReg: 12.47987) QuantErr: 12.47987 batch_time=0.56766 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.11721 (QuantReg: 12.42330) QuantErr: 12.42330 batch_time=0.57711 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 1.84521 (QuantReg: 12.57975) QuantErr: 12.57975 batch_time=4.00287 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.27738 (QuantReg: 12.73722) QuantErr: 12.73722 batch_time=0.60012 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.38262 (QuantReg: 12.79133) QuantErr: 12.79133 batch_time=0.57084 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 2.05476 (QuantReg: 12.48773) QuantErr: 12.48773 batch_time=0.57434 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.29440 (QuantReg: 12.87815) QuantErr: 12.87815 batch_time=0.57447 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 2.32886 (QuantReg: 12.47609) QuantErr: 12.47609 batch_time=0.59030 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.23106 (QuantReg: 12.88881) QuantErr: 12.88881 batch_time=0.55744 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.20677 (QuantReg: 12.52693) QuantErr: 12.52693 batch_time=0.55784 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 1.71861 (QuantReg: 13.02498) QuantErr: 13.02498 batch_time=0.56595 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.23589 (QuantReg: 12.94949) QuantErr: 12.94949 batch_time=0.57607 
Train Epoch: 7 codebook_update_time=1.67736
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch7.pth ...
Done in 3.932s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch7.pth ...
Done in 25.877s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 2.2196040849685668
 quant_reg      : 12.59848087310791
 quant_err      : 12.59848087310791
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.454
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.20825365545569
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.512
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.50271077781514
 mnt_best       : 38.20825365545569
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 1.86397 (QuantReg: 12.69801) QuantErr: 12.69801 batch_time=30.16717 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.03642 (QuantReg: 12.26781) QuantErr: 12.26781 batch_time=0.56414 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.31823 (QuantReg: 12.66993) QuantErr: 12.66993 batch_time=1.39129 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 1.74363 (QuantReg: 12.72566) QuantErr: 12.72566 batch_time=0.58982 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.48204 (QuantReg: 12.75567) QuantErr: 12.75567 batch_time=0.58201 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.22091 (QuantReg: 12.54618) QuantErr: 12.54618 batch_time=0.56688 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 1.89564 (QuantReg: 12.55092) QuantErr: 12.55092 batch_time=0.58044 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.06263 (QuantReg: 12.61471) QuantErr: 12.61471 batch_time=0.57745 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 1.65186 (QuantReg: 12.39071) QuantErr: 12.39071 batch_time=0.63678 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.14240 (QuantReg: 12.39266) QuantErr: 12.39266 batch_time=0.58946 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.12397 (QuantReg: 12.65746) QuantErr: 12.65746 batch_time=0.59057 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.08396 (QuantReg: 12.70522) QuantErr: 12.70522 batch_time=0.69921 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.01957 (QuantReg: 12.98712) QuantErr: 12.98712 batch_time=0.59200 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 1.88248 (QuantReg: 12.95564) QuantErr: 12.95564 batch_time=0.57177 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 1.99035 (QuantReg: 12.54844) QuantErr: 12.54844 batch_time=0.59006 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 2.12869 (QuantReg: 12.77981) QuantErr: 12.77981 batch_time=0.63318 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.37645 (QuantReg: 13.04674) QuantErr: 13.04674 batch_time=0.59596 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.25227 (QuantReg: 12.65421) QuantErr: 12.65421 batch_time=0.58175 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.16460 (QuantReg: 13.00652) QuantErr: 13.00652 batch_time=0.59622 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 1.73891 (QuantReg: 12.88972) QuantErr: 12.88972 batch_time=0.58534 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.04587 (QuantReg: 12.53616) QuantErr: 12.53616 batch_time=0.58682 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 2.16949 (QuantReg: 13.07267) QuantErr: 13.07267 batch_time=0.67307 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 1.98094 (QuantReg: 12.86692) QuantErr: 12.86692 batch_time=0.57881 
Train Epoch: 8 codebook_update_time=1.99203
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch8.pth ...
Done in 4.065s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch8.pth ...
Done in 8.298s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 2.0858988447189333
 quant_reg      : 12.677543521881104
 quant_err      : 12.677543521881104
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.285
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.545667964744965
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.8065
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.82183247764618
 mnt_best       : 38.545667964744965
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 1.90331 (QuantReg: 12.62944) QuantErr: 12.62944 batch_time=35.31733 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 1.55412 (QuantReg: 12.64129) QuantErr: 12.64129 batch_time=0.57694 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.17761 (QuantReg: 12.97397) QuantErr: 12.97397 batch_time=0.56594 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 1.75724 (QuantReg: 12.69793) QuantErr: 12.69793 batch_time=0.56627 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 1.95249 (QuantReg: 12.78695) QuantErr: 12.78695 batch_time=0.61521 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 1.79159 (QuantReg: 13.06465) QuantErr: 13.06465 batch_time=0.60504 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 2.16848 (QuantReg: 12.38758) QuantErr: 12.38758 batch_time=0.61297 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.79632 (QuantReg: 12.70611) QuantErr: 12.70611 batch_time=0.57723 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.32302 (QuantReg: 12.80146) QuantErr: 12.80146 batch_time=0.57295 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.85431 (QuantReg: 12.88535) QuantErr: 12.88535 batch_time=0.57791 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 1.61770 (QuantReg: 12.93382) QuantErr: 12.93382 batch_time=0.57449 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.90395 (QuantReg: 12.63796) QuantErr: 12.63796 batch_time=0.58893 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 1.67361 (QuantReg: 12.76215) QuantErr: 12.76215 batch_time=0.63184 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.10571 (QuantReg: 13.00035) QuantErr: 13.00035 batch_time=0.57552 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.03145 (QuantReg: 12.85370) QuantErr: 12.85370 batch_time=0.57877 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.65821 (QuantReg: 12.88234) QuantErr: 12.88234 batch_time=0.56746 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 2.16395 (QuantReg: 12.93811) QuantErr: 12.93811 batch_time=0.56552 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.61912 (QuantReg: 12.95903) QuantErr: 12.95903 batch_time=0.57408 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 1.84594 (QuantReg: 12.99314) QuantErr: 12.99314 batch_time=0.57188 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.88658 (QuantReg: 12.93682) QuantErr: 12.93682 batch_time=0.57065 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.87549 (QuantReg: 13.14265) QuantErr: 13.14265 batch_time=0.59775 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.98781 (QuantReg: 12.61800) QuantErr: 12.61800 batch_time=0.56229 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.82578 (QuantReg: 12.64248) QuantErr: 12.64248 batch_time=0.57726 
Train Epoch: 9 codebook_update_time=1.71496
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch9.pth ...
Done in 4.196s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch9.pth ...
Done in 8.492s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 1.9557132234573364
 quant_reg      : 12.788700916290283
 quant_err      : 12.788700916290283
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.028
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.68270542845022
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.7915
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.75548778765763
 mnt_best       : 38.68270542845022
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.94233 (QuantReg: 12.48250) QuantErr: 12.48250 batch_time=38.35687 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 1.93365 (QuantReg: 12.45852) QuantErr: 12.45852 batch_time=0.56415 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.20859 (QuantReg: 12.69436) QuantErr: 12.69436 batch_time=0.55848 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.38358 (QuantReg: 12.73885) QuantErr: 12.73885 batch_time=0.57273 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 2.07704 (QuantReg: 12.69167) QuantErr: 12.69167 batch_time=0.56483 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 2.00889 (QuantReg: 12.86250) QuantErr: 12.86250 batch_time=0.60404 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 1.53740 (QuantReg: 13.08534) QuantErr: 13.08534 batch_time=0.58107 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 1.90563 (QuantReg: 12.71487) QuantErr: 12.71487 batch_time=0.56978 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 2.01394 (QuantReg: 12.58046) QuantErr: 12.58046 batch_time=0.58014 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.02351 (QuantReg: 12.63752) QuantErr: 12.63752 batch_time=0.56562 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.51254 (QuantReg: 12.98125) QuantErr: 12.98125 batch_time=0.56591 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.43361 (QuantReg: 12.57894) QuantErr: 12.57894 batch_time=0.57969 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 1.93867 (QuantReg: 12.98140) QuantErr: 12.98140 batch_time=0.57060 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.93661 (QuantReg: 12.96955) QuantErr: 12.96955 batch_time=0.56877 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.82954 (QuantReg: 13.06826) QuantErr: 13.06826 batch_time=0.56211 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 1.77994 (QuantReg: 12.97289) QuantErr: 12.97289 batch_time=0.56949 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 2.03031 (QuantReg: 12.78348) QuantErr: 12.78348 batch_time=0.62510 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 1.97924 (QuantReg: 12.69005) QuantErr: 12.69005 batch_time=0.57792 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.90581 (QuantReg: 12.97026) QuantErr: 12.97026 batch_time=0.56795 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 2.10263 (QuantReg: 12.96808) QuantErr: 12.96808 batch_time=0.58240 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.76344 (QuantReg: 13.14065) QuantErr: 13.14065 batch_time=0.58212 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 1.91994 (QuantReg: 12.91623) QuantErr: 12.91623 batch_time=0.90111 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 2.00495 (QuantReg: 13.06770) QuantErr: 13.06770 batch_time=0.59427 
Train Epoch: 10 codebook_update_time=1.72336
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch10.pth ...
Done in 4.676s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch10.pth ...
Done in 8.969s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 1.8637367043495179
 quant_reg      : 12.861246109008789
 quant_err      : 12.861246109008789
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.962
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.791632711612586
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.7895
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.26849154408536
 mnt_best       : 40.791632711612586
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 2.17437 (QuantReg: 12.69290) QuantErr: 12.69290 batch_time=31.31350 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 1.64016 (QuantReg: 12.63221) QuantErr: 12.63221 batch_time=0.56969 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 2.02947 (QuantReg: 12.50705) QuantErr: 12.50705 batch_time=0.57601 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 2.18074 (QuantReg: 12.85656) QuantErr: 12.85656 batch_time=0.58349 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 1.79030 (QuantReg: 13.08774) QuantErr: 13.08774 batch_time=0.56405 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 1.76344 (QuantReg: 12.89193) QuantErr: 12.89193 batch_time=0.56579 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 1.56451 (QuantReg: 12.87279) QuantErr: 12.87279 batch_time=0.57557 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 1.59947 (QuantReg: 12.88845) QuantErr: 12.88845 batch_time=0.58468 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 2.09793 (QuantReg: 12.77839) QuantErr: 12.77839 batch_time=0.57614 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.99823 (QuantReg: 12.58604) QuantErr: 12.58604 batch_time=0.59795 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.81197 (QuantReg: 12.97309) QuantErr: 12.97309 batch_time=0.57499 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.60528 (QuantReg: 13.03268) QuantErr: 13.03268 batch_time=0.58689 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 1.82493 (QuantReg: 12.92730) QuantErr: 12.92730 batch_time=0.57426 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.94464 (QuantReg: 12.87152) QuantErr: 12.87152 batch_time=4.21834 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.57612 (QuantReg: 12.78520) QuantErr: 12.78520 batch_time=0.61219 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 1.49648 (QuantReg: 12.97308) QuantErr: 12.97308 batch_time=0.58123 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 2.19158 (QuantReg: 12.76918) QuantErr: 12.76918 batch_time=0.58466 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.73439 (QuantReg: 13.10242) QuantErr: 13.10242 batch_time=0.60966 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.65945 (QuantReg: 12.81471) QuantErr: 12.81471 batch_time=0.58636 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.62967 (QuantReg: 13.20603) QuantErr: 13.20603 batch_time=0.57464 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.40261 (QuantReg: 13.12998) QuantErr: 13.12998 batch_time=0.58869 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.66692 (QuantReg: 12.79520) QuantErr: 12.79520 batch_time=0.59347 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.59895 (QuantReg: 13.25199) QuantErr: 13.25199 batch_time=0.57117 
Train Epoch: 11 codebook_update_time=1.68063
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch11.pth ...
Done in 4.250s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 1.780605905532837
 quant_reg      : 12.857238842010497
 quant_err      : 12.857238842010497
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.521
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.55789210977297
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.873
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.82917234353608
 mnt_best       : 40.791632711612586
 not_improved_count: 1
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 2.05235 (QuantReg: 12.78682) QuantErr: 12.78682 batch_time=32.10757 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.68432 (QuantReg: 13.00819) QuantErr: 13.00819 batch_time=0.59680 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.68892 (QuantReg: 12.77473) QuantErr: 12.77473 batch_time=0.58467 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 1.70731 (QuantReg: 12.84222) QuantErr: 12.84222 batch_time=0.57215 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.99869 (QuantReg: 12.47147) QuantErr: 12.47147 batch_time=0.58211 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.68444 (QuantReg: 12.81025) QuantErr: 12.81025 batch_time=0.60761 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.88167 (QuantReg: 12.78011) QuantErr: 12.78011 batch_time=0.58222 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.17660 (QuantReg: 12.75966) QuantErr: 12.75966 batch_time=0.64872 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.77653 (QuantReg: 12.65855) QuantErr: 12.65855 batch_time=0.57717 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.90268 (QuantReg: 13.10902) QuantErr: 13.10902 batch_time=0.59584 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 2.03222 (QuantReg: 13.01243) QuantErr: 13.01243 batch_time=0.57759 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.74615 (QuantReg: 13.00452) QuantErr: 13.00452 batch_time=0.60442 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.74692 (QuantReg: 12.94864) QuantErr: 12.94864 batch_time=0.59934 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.53880 (QuantReg: 12.91275) QuantErr: 12.91275 batch_time=2.07298 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.69865 (QuantReg: 12.74485) QuantErr: 12.74485 batch_time=0.58037 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.61918 (QuantReg: 12.86431) QuantErr: 12.86431 batch_time=0.57797 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.64393 (QuantReg: 12.97138) QuantErr: 12.97138 batch_time=0.56881 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.77411 (QuantReg: 12.72336) QuantErr: 12.72336 batch_time=0.56594 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.53881 (QuantReg: 13.20688) QuantErr: 13.20688 batch_time=1.04212 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.65755 (QuantReg: 13.09354) QuantErr: 13.09354 batch_time=0.56085 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.72912 (QuantReg: 13.11173) QuantErr: 13.11173 batch_time=0.56513 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.49818 (QuantReg: 12.80083) QuantErr: 12.80083 batch_time=0.59594 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.59962 (QuantReg: 13.37977) QuantErr: 13.37977 batch_time=0.84224 
Train Epoch: 12 codebook_update_time=1.67371
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch12.pth ...
Done in 6.155s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 1.7073502130508422
 quant_reg      : 12.913925254821777
 quant_err      : 12.913925254821777
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.143
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.66524812155974
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.856
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.84515430592475
 mnt_best       : 40.791632711612586
 not_improved_count: 2
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.95550 (QuantReg: 12.97274) QuantErr: 12.97274 batch_time=31.64040 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.74716 (QuantReg: 13.25841) QuantErr: 13.25841 batch_time=0.58184 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.53616 (QuantReg: 12.81459) QuantErr: 12.81459 batch_time=0.59321 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.52243 (QuantReg: 12.67933) QuantErr: 12.67933 batch_time=0.61679 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.53917 (QuantReg: 12.86610) QuantErr: 12.86610 batch_time=1.27728 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.41324 (QuantReg: 12.79351) QuantErr: 12.79351 batch_time=0.57188 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.82453 (QuantReg: 13.00223) QuantErr: 13.00223 batch_time=0.60142 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.92974 (QuantReg: 12.88510) QuantErr: 12.88510 batch_time=0.57010 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.82071 (QuantReg: 13.20412) QuantErr: 13.20412 batch_time=0.56991 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.63968 (QuantReg: 13.06020) QuantErr: 13.06020 batch_time=0.60076 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 2.14745 (QuantReg: 12.93518) QuantErr: 12.93518 batch_time=0.57767 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.46397 (QuantReg: 12.87394) QuantErr: 12.87394 batch_time=0.57160 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.50733 (QuantReg: 13.02563) QuantErr: 13.02563 batch_time=0.58270 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.78755 (QuantReg: 12.91764) QuantErr: 12.91764 batch_time=2.90574 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.84050 (QuantReg: 13.08976) QuantErr: 13.08976 batch_time=0.57624 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.36787 (QuantReg: 13.06731) QuantErr: 13.06731 batch_time=0.59994 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.65020 (QuantReg: 13.10515) QuantErr: 13.10515 batch_time=1.67628 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.50413 (QuantReg: 13.49333) QuantErr: 13.49333 batch_time=0.59469 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.66695 (QuantReg: 12.86433) QuantErr: 12.86433 batch_time=0.56982 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.51337 (QuantReg: 13.30475) QuantErr: 13.30475 batch_time=0.60745 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.40566 (QuantReg: 12.87484) QuantErr: 12.87484 batch_time=0.74094 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.85927 (QuantReg: 13.02400) QuantErr: 13.02400 batch_time=0.97061 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.50660 (QuantReg: 12.51802) QuantErr: 12.51802 batch_time=0.62981 
Train Epoch: 13 codebook_update_time=1.74807
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch13.pth ...
Done in 4.194s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch13.pth ...
Done in 8.651s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 1.6323177161216735
 quant_reg      : 12.967290351867677
 quant_err      : 12.967290351867677
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.087
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.14132663488636
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.132
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.81527390342091
 mnt_best       : 42.14132663488636
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.11167 (QuantReg: 12.97313) QuantErr: 12.97313 batch_time=28.64071 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.45350 (QuantReg: 12.69119) QuantErr: 12.69119 batch_time=0.58867 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.50546 (QuantReg: 13.01478) QuantErr: 13.01478 batch_time=0.60352 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.75754 (QuantReg: 12.85407) QuantErr: 12.85407 batch_time=0.66376 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.71170 (QuantReg: 13.10893) QuantErr: 13.10893 batch_time=0.58258 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.56905 (QuantReg: 13.03118) QuantErr: 13.03118 batch_time=0.59569 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.77076 (QuantReg: 12.96795) QuantErr: 12.96795 batch_time=1.57794 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.60024 (QuantReg: 12.74356) QuantErr: 12.74356 batch_time=0.59522 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.76517 (QuantReg: 13.01070) QuantErr: 13.01070 batch_time=0.56794 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.34313 (QuantReg: 12.94465) QuantErr: 12.94465 batch_time=0.56629 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.36155 (QuantReg: 12.88978) QuantErr: 12.88978 batch_time=0.57585 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.20823 (QuantReg: 12.94159) QuantErr: 12.94159 batch_time=0.64398 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.73299 (QuantReg: 13.17188) QuantErr: 13.17188 batch_time=0.56859 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.65728 (QuantReg: 12.87136) QuantErr: 12.87136 batch_time=0.58386 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.40226 (QuantReg: 13.44109) QuantErr: 13.44109 batch_time=0.59386 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.40239 (QuantReg: 13.12902) QuantErr: 13.12902 batch_time=0.64239 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.82035 (QuantReg: 12.94117) QuantErr: 12.94117 batch_time=0.60006 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.31840 (QuantReg: 13.06343) QuantErr: 13.06343 batch_time=0.57653 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.40313 (QuantReg: 13.41002) QuantErr: 13.41002 batch_time=0.61088 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.44281 (QuantReg: 13.42015) QuantErr: 13.42015 batch_time=4.12635 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.72433 (QuantReg: 13.08991) QuantErr: 13.08991 batch_time=0.59472 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.54105 (QuantReg: 13.28291) QuantErr: 13.28291 batch_time=0.57354 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.62386 (QuantReg: 13.07798) QuantErr: 13.07798 batch_time=0.59535 
Train Epoch: 14 codebook_update_time=1.92336
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch14.pth ...
Done in 15.589s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch14.pth ...
Done in 21.652s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 1.5592034363746643
 quant_reg      : 13.059032485961914
 quant_err      : 13.059032485961914
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.395
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.27721389014404
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.319
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.05283715788236
 mnt_best       : 42.27721389014404
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.62763 (QuantReg: 13.03843) QuantErr: 13.03843 batch_time=32.29840 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.43186 (QuantReg: 12.92871) QuantErr: 12.92871 batch_time=0.59166 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.22806 (QuantReg: 13.09031) QuantErr: 13.09031 batch_time=0.57348 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.62930 (QuantReg: 12.48484) QuantErr: 12.48484 batch_time=0.64941 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.60554 (QuantReg: 13.29290) QuantErr: 13.29290 batch_time=0.62279 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.38456 (QuantReg: 12.99359) QuantErr: 12.99359 batch_time=0.60657 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.77904 (QuantReg: 12.85214) QuantErr: 12.85214 batch_time=2.56144 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.39964 (QuantReg: 13.19729) QuantErr: 13.19729 batch_time=0.59521 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.45168 (QuantReg: 12.84430) QuantErr: 12.84430 batch_time=0.58038 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.81180 (QuantReg: 13.12374) QuantErr: 13.12374 batch_time=0.56144 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.37802 (QuantReg: 13.05637) QuantErr: 13.05637 batch_time=0.60882 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.45529 (QuantReg: 12.97094) QuantErr: 12.97094 batch_time=0.61206 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.90738 (QuantReg: 13.21046) QuantErr: 13.21046 batch_time=0.59096 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.28083 (QuantReg: 13.21243) QuantErr: 13.21243 batch_time=0.60245 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.55399 (QuantReg: 13.06424) QuantErr: 13.06424 batch_time=0.58251 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.52256 (QuantReg: 13.21403) QuantErr: 13.21403 batch_time=0.60129 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.17063 (QuantReg: 13.05941) QuantErr: 13.05941 batch_time=0.58080 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.50106 (QuantReg: 13.32743) QuantErr: 13.32743 batch_time=0.58906 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.25830 (QuantReg: 13.08810) QuantErr: 13.08810 batch_time=0.58014 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.46400 (QuantReg: 13.37356) QuantErr: 13.37356 batch_time=0.56536 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.53893 (QuantReg: 12.84109) QuantErr: 12.84109 batch_time=0.57149 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.43414 (QuantReg: 13.22621) QuantErr: 13.22621 batch_time=0.60883 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.39145 (QuantReg: 12.75670) QuantErr: 12.75670 batch_time=0.56824 
Train Epoch: 15 codebook_update_time=1.69835
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch15.pth ...
Done in 4.401s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 1.5183355321884155
 quant_reg      : 13.091108039855957
 quant_err      : 13.091108039855957
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.274
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.19453850375259
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.57
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.66311456296782
 mnt_best       : 42.27721389014404
 not_improved_count: 1
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.50529 (QuantReg: 12.90795) QuantErr: 12.90795 batch_time=31.35272 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.52515 (QuantReg: 13.03904) QuantErr: 13.03904 batch_time=0.56784 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.47835 (QuantReg: 13.20076) QuantErr: 13.20076 batch_time=0.56151 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 1.70305 (QuantReg: 12.86343) QuantErr: 12.86343 batch_time=0.59101 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.64153 (QuantReg: 12.97612) QuantErr: 12.97612 batch_time=0.56734 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.51842 (QuantReg: 12.65867) QuantErr: 12.65867 batch_time=0.56312 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.54594 (QuantReg: 13.02434) QuantErr: 13.02434 batch_time=2.37774 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.53369 (QuantReg: 13.22090) QuantErr: 13.22090 batch_time=0.59386 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.24751 (QuantReg: 13.14933) QuantErr: 13.14933 batch_time=0.58415 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.60722 (QuantReg: 13.19777) QuantErr: 13.19777 batch_time=0.59083 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.40576 (QuantReg: 13.18890) QuantErr: 13.18890 batch_time=0.59387 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.12232 (QuantReg: 12.80913) QuantErr: 12.80913 batch_time=0.59936 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.64598 (QuantReg: 13.09051) QuantErr: 13.09051 batch_time=0.57694 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.42409 (QuantReg: 13.40677) QuantErr: 13.40677 batch_time=1.79770 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.52823 (QuantReg: 12.90476) QuantErr: 12.90476 batch_time=0.60828 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.33876 (QuantReg: 13.10507) QuantErr: 13.10507 batch_time=0.60062 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.57759 (QuantReg: 13.25206) QuantErr: 13.25206 batch_time=0.58067 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.31911 (QuantReg: 12.91094) QuantErr: 12.91094 batch_time=0.57229 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.49583 (QuantReg: 13.01416) QuantErr: 13.01416 batch_time=0.56343 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.16803 (QuantReg: 13.28886) QuantErr: 13.28886 batch_time=0.60914 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.47509 (QuantReg: 13.13223) QuantErr: 13.13223 batch_time=1.00607 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.33808 (QuantReg: 12.98450) QuantErr: 12.98450 batch_time=0.66134 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.52064 (QuantReg: 12.97207) QuantErr: 12.97207 batch_time=0.58529 
Train Epoch: 16 codebook_update_time=1.86885
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch16.pth ...
Done in 4.238s
removing stale ckpt [epoch 15] [took 0.74s]
 epoch          : 16
 loss           : 1.4700185554027558
 quant_reg      : 13.129893363952636
 quant_err      : 13.129893363952636
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.919
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.83310755086614
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.007
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.95586800817274
 mnt_best       : 42.27721389014404
 not_improved_count: 2
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.64289 (QuantReg: 12.70227) QuantErr: 12.70227 batch_time=33.38394 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.99549 (QuantReg: 13.03594) QuantErr: 13.03594 batch_time=0.56493 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.35246 (QuantReg: 13.05905) QuantErr: 13.05905 batch_time=0.58209 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.38679 (QuantReg: 12.93351) QuantErr: 12.93351 batch_time=0.59621 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.39312 (QuantReg: 12.83695) QuantErr: 12.83695 batch_time=0.63806 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.53994 (QuantReg: 12.97500) QuantErr: 12.97500 batch_time=0.57001 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.58599 (QuantReg: 12.94350) QuantErr: 12.94350 batch_time=2.26299 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.45660 (QuantReg: 13.23982) QuantErr: 13.23982 batch_time=0.69238 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.02051 (QuantReg: 13.38305) QuantErr: 13.38305 batch_time=0.58237 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.36869 (QuantReg: 13.17441) QuantErr: 13.17441 batch_time=0.58257 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.35516 (QuantReg: 13.25196) QuantErr: 13.25196 batch_time=0.57411 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.12791 (QuantReg: 13.27070) QuantErr: 13.27070 batch_time=0.56584 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.21696 (QuantReg: 13.16163) QuantErr: 13.16163 batch_time=0.78988 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.28217 (QuantReg: 13.22477) QuantErr: 13.22477 batch_time=0.57523 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.23049 (QuantReg: 13.30663) QuantErr: 13.30663 batch_time=0.60236 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.06197 (QuantReg: 13.35555) QuantErr: 13.35555 batch_time=0.56572 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.29765 (QuantReg: 13.40685) QuantErr: 13.40685 batch_time=0.58589 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.40504 (QuantReg: 13.43830) QuantErr: 13.43830 batch_time=0.59649 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.54235 (QuantReg: 12.82153) QuantErr: 12.82153 batch_time=0.58419 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.56793 (QuantReg: 13.19310) QuantErr: 13.19310 batch_time=0.57753 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.15542 (QuantReg: 13.17585) QuantErr: 13.17585 batch_time=0.56814 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.18479 (QuantReg: 13.34953) QuantErr: 13.34953 batch_time=0.63336 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.67354 (QuantReg: 13.02205) QuantErr: 13.02205 batch_time=1.05929 
Train Epoch: 17 codebook_update_time=1.65090
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch17.pth ...
Done in 4.523s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch17.pth ...
Done in 8.839s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 1.4011719882488252
 quant_reg      : 13.146054271697999
 quant_err      : 13.146054271697999
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.562
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.77088158292808
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 21.712
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.90540127448707
 mnt_best       : 42.77088158292808
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.39806 (QuantReg: 13.14544) QuantErr: 13.14544 batch_time=30.68097 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.75037 (QuantReg: 12.92440) QuantErr: 12.92440 batch_time=0.62921 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.28660 (QuantReg: 13.13307) QuantErr: 13.13307 batch_time=0.56812 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.45544 (QuantReg: 12.85415) QuantErr: 12.85415 batch_time=0.59890 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.40818 (QuantReg: 13.16295) QuantErr: 13.16295 batch_time=0.58521 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.30922 (QuantReg: 12.93665) QuantErr: 12.93665 batch_time=0.61448 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.42541 (QuantReg: 13.13976) QuantErr: 13.13976 batch_time=0.61910 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.26388 (QuantReg: 13.30151) QuantErr: 13.30151 batch_time=0.57720 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.83370 (QuantReg: 13.26805) QuantErr: 13.26805 batch_time=0.60270 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.28734 (QuantReg: 13.47109) QuantErr: 13.47109 batch_time=0.62660 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.51852 (QuantReg: 13.41301) QuantErr: 13.41301 batch_time=0.61718 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.60018 (QuantReg: 13.06580) QuantErr: 13.06580 batch_time=1.05027 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.43573 (QuantReg: 12.84233) QuantErr: 12.84233 batch_time=0.59533 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.70590 (QuantReg: 12.89532) QuantErr: 12.89532 batch_time=0.59018 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 0.99580 (QuantReg: 13.59170) QuantErr: 13.59170 batch_time=0.59273 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.46686 (QuantReg: 13.07787) QuantErr: 13.07787 batch_time=0.57291 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.25793 (QuantReg: 13.34836) QuantErr: 13.34836 batch_time=0.57443 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.57661 (QuantReg: 12.88616) QuantErr: 12.88616 batch_time=0.64718 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.15755 (QuantReg: 13.19320) QuantErr: 13.19320 batch_time=3.12798 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.72839 (QuantReg: 13.29006) QuantErr: 13.29006 batch_time=1.47599 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.42752 (QuantReg: 13.10995) QuantErr: 13.10995 batch_time=0.57479 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.08481 (QuantReg: 13.53167) QuantErr: 13.53167 batch_time=0.59797 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.38691 (QuantReg: 13.28858) QuantErr: 13.28858 batch_time=0.59176 
Train Epoch: 18 codebook_update_time=1.81047
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch18.pth ...
Done in 15.065s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 1.3946205644607543
 quant_reg      : 13.165578521728516
 quant_err      : 13.165578521728516
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.944
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.71633216626605
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.1605
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.13266844763601
 mnt_best       : 42.77088158292808
 not_improved_count: 1
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.06063 (QuantReg: 13.49313) QuantErr: 13.49313 batch_time=40.99250 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.07692 (QuantReg: 13.37159) QuantErr: 13.37159 batch_time=0.59366 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.28007 (QuantReg: 13.35286) QuantErr: 13.35286 batch_time=0.57192 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.54703 (QuantReg: 13.03281) QuantErr: 13.03281 batch_time=0.56432 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.40734 (QuantReg: 13.14770) QuantErr: 13.14770 batch_time=0.61765 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.70982 (QuantReg: 13.35975) QuantErr: 13.35975 batch_time=0.60570 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.42498 (QuantReg: 13.32604) QuantErr: 13.32604 batch_time=0.56563 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.36396 (QuantReg: 13.60655) QuantErr: 13.60655 batch_time=0.57746 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 0.91755 (QuantReg: 13.56693) QuantErr: 13.56693 batch_time=0.59399 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.41837 (QuantReg: 13.06335) QuantErr: 13.06335 batch_time=0.61453 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.31618 (QuantReg: 13.21359) QuantErr: 13.21359 batch_time=0.57891 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.26222 (QuantReg: 13.18805) QuantErr: 13.18805 batch_time=0.56767 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.66403 (QuantReg: 13.29283) QuantErr: 13.29283 batch_time=0.55972 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.97942 (QuantReg: 13.39779) QuantErr: 13.39779 batch_time=1.29264 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.35152 (QuantReg: 13.42324) QuantErr: 13.42324 batch_time=0.62132 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.52132 (QuantReg: 12.99799) QuantErr: 12.99799 batch_time=0.57448 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.45791 (QuantReg: 13.89033) QuantErr: 13.89033 batch_time=0.56740 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.14609 (QuantReg: 13.52912) QuantErr: 13.52912 batch_time=0.64886 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.15161 (QuantReg: 13.47418) QuantErr: 13.47418 batch_time=0.59678 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.53409 (QuantReg: 13.28497) QuantErr: 13.28497 batch_time=1.99427 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.34159 (QuantReg: 13.27214) QuantErr: 13.27214 batch_time=0.66402 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.18335 (QuantReg: 13.53432) QuantErr: 13.53432 batch_time=0.66545 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.25854 (QuantReg: 13.28499) QuantErr: 13.28499 batch_time=0.62844 
Train Epoch: 19 codebook_update_time=1.75260
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch19.pth ...
Done in 14.919s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch19.pth ...
Done in 19.018s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 1.342387036561966
 quant_reg      : 13.251977294921875
 quant_err      : 13.251977294921875
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.808
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.232155914206366
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.092
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.323963887040904
 mnt_best       : 43.232155914206366
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.36920 (QuantReg: 13.31081) QuantErr: 13.31081 batch_time=29.47644 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.15088 (QuantReg: 13.18344) QuantErr: 13.18344 batch_time=0.59038 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.38369 (QuantReg: 13.25439) QuantErr: 13.25439 batch_time=0.65158 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.07651 (QuantReg: 13.07168) QuantErr: 13.07168 batch_time=0.57013 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.51606 (QuantReg: 13.10172) QuantErr: 13.10172 batch_time=0.57929 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.41958 (QuantReg: 13.13696) QuantErr: 13.13696 batch_time=0.57448 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.58630 (QuantReg: 13.19511) QuantErr: 13.19511 batch_time=1.41163 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.31856 (QuantReg: 13.25556) QuantErr: 13.25556 batch_time=0.58281 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.44735 (QuantReg: 13.30449) QuantErr: 13.30449 batch_time=0.88926 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.58560 (QuantReg: 13.10294) QuantErr: 13.10294 batch_time=0.63468 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.17672 (QuantReg: 13.30837) QuantErr: 13.30837 batch_time=0.61416 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.34489 (QuantReg: 13.32060) QuantErr: 13.32060 batch_time=0.57463 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.70574 (QuantReg: 13.26399) QuantErr: 13.26399 batch_time=0.56485 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.34945 (QuantReg: 12.99495) QuantErr: 12.99495 batch_time=4.67145 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.00587 (QuantReg: 13.72672) QuantErr: 13.72672 batch_time=0.86381 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.76317 (QuantReg: 13.13702) QuantErr: 13.13702 batch_time=0.62199 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.00237 (QuantReg: 13.47715) QuantErr: 13.47715 batch_time=0.59946 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.24207 (QuantReg: 13.12245) QuantErr: 13.12245 batch_time=0.62595 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.28518 (QuantReg: 13.23877) QuantErr: 13.23877 batch_time=0.61908 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.30949 (QuantReg: 13.16110) QuantErr: 13.16110 batch_time=0.56707 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.29486 (QuantReg: 13.23756) QuantErr: 13.23756 batch_time=0.60251 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.27329 (QuantReg: 13.22492) QuantErr: 13.22492 batch_time=0.58589 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.63738 (QuantReg: 13.52297) QuantErr: 13.52297 batch_time=0.60411 
Train Epoch: 20 codebook_update_time=1.89175
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch20.pth ...
Done in 4.522s
removing stale ckpt [epoch 19] [took 0.01s]
 epoch          : 20
 loss           : 1.3077094929218291
 quant_reg      : 13.27087300491333
 quant_err      : 13.27087300491333
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.687
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.96420529352657
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.851
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.93640399278568
 mnt_best       : 43.232155914206366
 not_improved_count: 1
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.30534 (QuantReg: 13.12230) QuantErr: 13.12230 batch_time=31.82570 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.37552 (QuantReg: 13.05787) QuantErr: 13.05787 batch_time=0.56529 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.21413 (QuantReg: 13.33715) QuantErr: 13.33715 batch_time=0.59142 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.15780 (QuantReg: 13.21841) QuantErr: 13.21841 batch_time=0.57153 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.38069 (QuantReg: 13.06190) QuantErr: 13.06190 batch_time=0.57381 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.35885 (QuantReg: 13.37763) QuantErr: 13.37763 batch_time=0.60332 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.39436 (QuantReg: 13.05747) QuantErr: 13.05747 batch_time=0.58273 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.16090 (QuantReg: 13.41262) QuantErr: 13.41262 batch_time=0.56704 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.25486 (QuantReg: 13.28987) QuantErr: 13.28987 batch_time=0.59892 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.28292 (QuantReg: 13.48347) QuantErr: 13.48347 batch_time=0.59380 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.45835 (QuantReg: 13.17327) QuantErr: 13.17327 batch_time=0.57922 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.12290 (QuantReg: 13.30957) QuantErr: 13.30957 batch_time=0.58076 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.39754 (QuantReg: 13.35227) QuantErr: 13.35227 batch_time=1.60984 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.08097 (QuantReg: 13.40086) QuantErr: 13.40086 batch_time=0.58533 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.34245 (QuantReg: 13.19663) QuantErr: 13.19663 batch_time=0.57069 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.32064 (QuantReg: 13.63553) QuantErr: 13.63553 batch_time=0.61359 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.41886 (QuantReg: 13.13919) QuantErr: 13.13919 batch_time=0.57277 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.27968 (QuantReg: 13.15705) QuantErr: 13.15705 batch_time=0.58079 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.15250 (QuantReg: 13.73977) QuantErr: 13.73977 batch_time=4.74391 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.33119 (QuantReg: 13.44098) QuantErr: 13.44098 batch_time=0.61988 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.06626 (QuantReg: 13.44343) QuantErr: 13.44343 batch_time=0.57937 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.49649 (QuantReg: 13.04219) QuantErr: 13.04219 batch_time=0.60332 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.13600 (QuantReg: 13.48901) QuantErr: 13.48901 batch_time=0.58184 
Train Epoch: 21 codebook_update_time=1.84357
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch21.pth ...
Done in 4.565s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch21.pth ...
Done in 9.137s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 1.2984885880947112
 quant_reg      : 13.324143947601318
 quant_err      : 13.324143947601318
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.517
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.92322786668596
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.278
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.48409300802352
 mnt_best       : 43.92322786668596
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.64240 (QuantReg: 13.06376) QuantErr: 13.06376 batch_time=38.24819 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.40998 (QuantReg: 13.29640) QuantErr: 13.29640 batch_time=0.57912 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.20274 (QuantReg: 13.55872) QuantErr: 13.55872 batch_time=0.61927 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.08066 (QuantReg: 13.22752) QuantErr: 13.22752 batch_time=0.56348 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.15053 (QuantReg: 13.34934) QuantErr: 13.34934 batch_time=0.68358 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.27534 (QuantReg: 13.46745) QuantErr: 13.46745 batch_time=0.58848 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.11645 (QuantReg: 13.65037) QuantErr: 13.65037 batch_time=0.57338 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.15630 (QuantReg: 13.21773) QuantErr: 13.21773 batch_time=0.59242 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.21365 (QuantReg: 13.39863) QuantErr: 13.39863 batch_time=0.57985 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.29334 (QuantReg: 13.32553) QuantErr: 13.32553 batch_time=0.61501 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.14549 (QuantReg: 13.42623) QuantErr: 13.42623 batch_time=0.58729 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.31075 (QuantReg: 13.00549) QuantErr: 13.00549 batch_time=0.58335 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.09246 (QuantReg: 13.68354) QuantErr: 13.68354 batch_time=0.71537 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.02687 (QuantReg: 13.41375) QuantErr: 13.41375 batch_time=3.60400 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.42633 (QuantReg: 13.29747) QuantErr: 13.29747 batch_time=0.59742 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.36813 (QuantReg: 13.52753) QuantErr: 13.52753 batch_time=0.58827 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.25899 (QuantReg: 13.49455) QuantErr: 13.49455 batch_time=0.62156 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.01740 (QuantReg: 13.21503) QuantErr: 13.21503 batch_time=0.73902 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 0.94954 (QuantReg: 13.67747) QuantErr: 13.67747 batch_time=0.60891 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.33076 (QuantReg: 13.16758) QuantErr: 13.16758 batch_time=0.61573 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.39866 (QuantReg: 13.16539) QuantErr: 13.16539 batch_time=0.60043 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.07639 (QuantReg: 13.37691) QuantErr: 13.37691 batch_time=0.62338 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.22911 (QuantReg: 13.15482) QuantErr: 13.15482 batch_time=0.57771 
Train Epoch: 22 codebook_update_time=1.70923
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch22.pth ...
Done in 4.300s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch22.pth ...
Done in 8.590s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 1.2686774230003357
 quant_reg      : 13.297274250030517
 quant_err      : 13.297274250030517
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.977
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.1876493409297
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.66
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.740311667292204
 mnt_best       : 44.1876493409297
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.27635 (QuantReg: 13.29945) QuantErr: 13.29945 batch_time=35.75539 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 0.91461 (QuantReg: 13.67772) QuantErr: 13.67772 batch_time=0.55481 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.08611 (QuantReg: 13.13533) QuantErr: 13.13533 batch_time=0.55187 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 0.96903 (QuantReg: 13.18529) QuantErr: 13.18529 batch_time=0.63053 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.35731 (QuantReg: 13.37852) QuantErr: 13.37852 batch_time=0.56394 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.41947 (QuantReg: 13.08162) QuantErr: 13.08162 batch_time=0.56988 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.16549 (QuantReg: 13.45490) QuantErr: 13.45490 batch_time=0.57601 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.47933 (QuantReg: 13.63762) QuantErr: 13.63762 batch_time=0.57423 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.08629 (QuantReg: 13.40615) QuantErr: 13.40615 batch_time=0.57183 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.32532 (QuantReg: 13.50322) QuantErr: 13.50322 batch_time=0.57758 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.33509 (QuantReg: 13.17832) QuantErr: 13.17832 batch_time=0.58132 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.06692 (QuantReg: 13.50244) QuantErr: 13.50244 batch_time=0.57705 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 0.97759 (QuantReg: 13.37080) QuantErr: 13.37080 batch_time=1.81382 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.10818 (QuantReg: 13.44893) QuantErr: 13.44893 batch_time=2.52843 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.12219 (QuantReg: 13.63116) QuantErr: 13.63116 batch_time=0.60448 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.23544 (QuantReg: 13.65606) QuantErr: 13.65606 batch_time=0.60859 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.07175 (QuantReg: 13.43964) QuantErr: 13.43964 batch_time=0.58809 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.21136 (QuantReg: 13.31197) QuantErr: 13.31197 batch_time=0.59795 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.57634 (QuantReg: 13.30627) QuantErr: 13.30627 batch_time=0.91642 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.12677 (QuantReg: 13.26054) QuantErr: 13.26054 batch_time=0.56917 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.38779 (QuantReg: 13.58159) QuantErr: 13.58159 batch_time=0.56623 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.33274 (QuantReg: 13.50689) QuantErr: 13.50689 batch_time=0.58718 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.25745 (QuantReg: 13.39285) QuantErr: 13.39285 batch_time=0.69498 
Train Epoch: 23 codebook_update_time=2.38756
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch23.pth ...
Done in 4.245s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 1.239170485496521
 quant_reg      : 13.35586627960205
 quant_err      : 13.35586627960205
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.959
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.817085346802635
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.9985
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.57510038356075
 mnt_best       : 44.1876493409297
 not_improved_count: 1
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 0.89696 (QuantReg: 13.35341) QuantErr: 13.35341 batch_time=31.45927 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.23852 (QuantReg: 13.04045) QuantErr: 13.04045 batch_time=0.85801 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.22438 (QuantReg: 13.31252) QuantErr: 13.31252 batch_time=0.56309 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.09839 (QuantReg: 13.39015) QuantErr: 13.39015 batch_time=0.60513 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.38230 (QuantReg: 13.20617) QuantErr: 13.20617 batch_time=0.57248 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.50984 (QuantReg: 13.41654) QuantErr: 13.41654 batch_time=0.60662 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.10375 (QuantReg: 13.20662) QuantErr: 13.20662 batch_time=0.57556 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.33719 (QuantReg: 13.16457) QuantErr: 13.16457 batch_time=0.56577 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.10860 (QuantReg: 13.15429) QuantErr: 13.15429 batch_time=0.78184 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.39370 (QuantReg: 13.09952) QuantErr: 13.09952 batch_time=0.60044 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.38998 (QuantReg: 13.33570) QuantErr: 13.33570 batch_time=0.57429 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.21725 (QuantReg: 13.56199) QuantErr: 13.56199 batch_time=0.57912 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.25508 (QuantReg: 13.66258) QuantErr: 13.66258 batch_time=4.37760 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.05831 (QuantReg: 13.24456) QuantErr: 13.24456 batch_time=0.56903 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.64435 (QuantReg: 12.91220) QuantErr: 12.91220 batch_time=0.57772 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.45659 (QuantReg: 13.07958) QuantErr: 13.07958 batch_time=0.58053 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.26652 (QuantReg: 13.41036) QuantErr: 13.41036 batch_time=0.56674 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.17176 (QuantReg: 13.44371) QuantErr: 13.44371 batch_time=0.57296 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.51573 (QuantReg: 13.19629) QuantErr: 13.19629 batch_time=0.58408 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.33890 (QuantReg: 13.37419) QuantErr: 13.37419 batch_time=0.63813 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.54883 (QuantReg: 13.33148) QuantErr: 13.33148 batch_time=0.57230 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.11292 (QuantReg: 13.49377) QuantErr: 13.49377 batch_time=0.56378 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.33104 (QuantReg: 13.77026) QuantErr: 13.77026 batch_time=0.58147 
Train Epoch: 24 codebook_update_time=1.89606
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch24.pth ...
Done in 4.293s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 1.2499106035232543
 quant_reg      : 13.337598392486573
 quant_err      : 13.337598392486573
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.523
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.207191875342566
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.8405
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.975171081367066
 mnt_best       : 44.1876493409297
 not_improved_count: 2
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.36834 (QuantReg: 13.21654) QuantErr: 13.21654 batch_time=33.22635 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.52552 (QuantReg: 13.17010) QuantErr: 13.17010 batch_time=0.56651 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.00762 (QuantReg: 13.45818) QuantErr: 13.45818 batch_time=0.57132 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.21388 (QuantReg: 13.37396) QuantErr: 13.37396 batch_time=0.60895 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.15838 (QuantReg: 13.22512) QuantErr: 13.22512 batch_time=0.59992 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.45699 (QuantReg: 13.40475) QuantErr: 13.40475 batch_time=0.60051 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 0.94255 (QuantReg: 13.53855) QuantErr: 13.53855 batch_time=0.84077 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.00980 (QuantReg: 13.25163) QuantErr: 13.25163 batch_time=0.59464 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.07343 (QuantReg: 13.20846) QuantErr: 13.20846 batch_time=0.60142 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.36319 (QuantReg: 13.31133) QuantErr: 13.31133 batch_time=0.91966 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.21797 (QuantReg: 13.36962) QuantErr: 13.36962 batch_time=0.61665 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.21363 (QuantReg: 12.98839) QuantErr: 12.98839 batch_time=0.63597 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.38753 (QuantReg: 13.51316) QuantErr: 13.51316 batch_time=2.33304 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.01530 (QuantReg: 13.25757) QuantErr: 13.25757 batch_time=0.56723 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.07923 (QuantReg: 13.50499) QuantErr: 13.50499 batch_time=0.59887 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.03126 (QuantReg: 13.26463) QuantErr: 13.26463 batch_time=0.58634 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.20292 (QuantReg: 13.01967) QuantErr: 13.01967 batch_time=0.59947 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.03795 (QuantReg: 13.45673) QuantErr: 13.45673 batch_time=0.57289 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.97523 (QuantReg: 13.66198) QuantErr: 13.66198 batch_time=0.56695 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.35271 (QuantReg: 13.18235) QuantErr: 13.18235 batch_time=0.57062 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.11518 (QuantReg: 13.11902) QuantErr: 13.11902 batch_time=1.49972 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.11146 (QuantReg: 13.25728) QuantErr: 13.25728 batch_time=0.57643 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.30098 (QuantReg: 13.52176) QuantErr: 13.52176 batch_time=0.60133 
Train Epoch: 25 codebook_update_time=1.82979
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch25.pth ...
Done in 4.376s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.213968983888626
 quant_reg      : 13.37145191192627
 quant_err      : 13.37145191192627
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.603
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.5841257475979
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.7835
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.412231838100006
 mnt_best       : 44.1876493409297
 not_improved_count: 3
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.15033 (QuantReg: 13.35162) QuantErr: 13.35162 batch_time=35.17634 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.16196 (QuantReg: 13.44696) QuantErr: 13.44696 batch_time=0.63536 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.27844 (QuantReg: 13.16179) QuantErr: 13.16179 batch_time=0.58922 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.47913 (QuantReg: 13.04731) QuantErr: 13.04731 batch_time=0.59716 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.22819 (QuantReg: 13.70147) QuantErr: 13.70147 batch_time=0.62252 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.06003 (QuantReg: 13.42130) QuantErr: 13.42130 batch_time=0.92009 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.11826 (QuantReg: 13.35063) QuantErr: 13.35063 batch_time=0.61766 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.36748 (QuantReg: 13.25341) QuantErr: 13.25341 batch_time=0.61604 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.09437 (QuantReg: 13.34623) QuantErr: 13.34623 batch_time=0.57352 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.41844 (QuantReg: 13.37429) QuantErr: 13.37429 batch_time=0.58789 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.10690 (QuantReg: 13.26264) QuantErr: 13.26264 batch_time=0.57489 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.53513 (QuantReg: 13.20660) QuantErr: 13.20660 batch_time=0.59545 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.17491 (QuantReg: 13.52760) QuantErr: 13.52760 batch_time=0.59382 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.17043 (QuantReg: 13.42113) QuantErr: 13.42113 batch_time=0.57074 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.12371 (QuantReg: 13.79459) QuantErr: 13.79459 batch_time=0.56880 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.02692 (QuantReg: 13.69380) QuantErr: 13.69380 batch_time=0.59590 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 0.99347 (QuantReg: 13.52293) QuantErr: 13.52293 batch_time=0.60119 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.22756 (QuantReg: 13.59334) QuantErr: 13.59334 batch_time=0.84221 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.08352 (QuantReg: 13.30688) QuantErr: 13.30688 batch_time=2.95711 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.20726 (QuantReg: 13.41626) QuantErr: 13.41626 batch_time=0.59486 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.03877 (QuantReg: 13.59175) QuantErr: 13.59175 batch_time=0.59651 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.14345 (QuantReg: 13.48562) QuantErr: 13.48562 batch_time=0.62782 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.50506 (QuantReg: 13.03176) QuantErr: 13.03176 batch_time=0.65233 
Train Epoch: 26 codebook_update_time=1.90317
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch26.pth ...
Done in 4.510s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch26.pth ...
Done in 8.744s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 1.2009229323863984
 quant_reg      : 13.409145866394043
 quant_err      : 13.409145866394043
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.815
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.688695681897265
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.976
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.48466921292655
 mnt_best       : 44.688695681897265
 not_improved_count: 0
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 0.93771 (QuantReg: 13.26253) QuantErr: 13.26253 batch_time=33.26196 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.01162 (QuantReg: 13.28401) QuantErr: 13.28401 batch_time=0.56327 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.34392 (QuantReg: 13.49596) QuantErr: 13.49596 batch_time=0.62320 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.14139 (QuantReg: 13.11880) QuantErr: 13.11880 batch_time=0.59234 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.44420 (QuantReg: 13.62436) QuantErr: 13.62436 batch_time=0.91587 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.11861 (QuantReg: 13.36762) QuantErr: 13.36762 batch_time=0.58427 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.18092 (QuantReg: 13.40453) QuantErr: 13.40453 batch_time=0.59993 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.42597 (QuantReg: 13.33488) QuantErr: 13.33488 batch_time=0.58740 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.21313 (QuantReg: 13.58543) QuantErr: 13.58543 batch_time=0.62083 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.33003 (QuantReg: 13.29088) QuantErr: 13.29088 batch_time=0.56447 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.19989 (QuantReg: 13.73056) QuantErr: 13.73056 batch_time=0.58661 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.45626 (QuantReg: 13.28417) QuantErr: 13.28417 batch_time=0.57720 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.33983 (QuantReg: 12.99245) QuantErr: 12.99245 batch_time=0.58524 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 0.98208 (QuantReg: 13.31030) QuantErr: 13.31030 batch_time=0.58810 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.26746 (QuantReg: 13.43965) QuantErr: 13.43965 batch_time=0.57183 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.23857 (QuantReg: 13.42847) QuantErr: 13.42847 batch_time=0.61782 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.12485 (QuantReg: 13.81267) QuantErr: 13.81267 batch_time=0.61513 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.17365 (QuantReg: 13.15622) QuantErr: 13.15622 batch_time=0.63918 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.09910 (QuantReg: 13.41999) QuantErr: 13.41999 batch_time=0.56777 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.02250 (QuantReg: 13.61209) QuantErr: 13.61209 batch_time=0.61983 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.05421 (QuantReg: 13.47524) QuantErr: 13.47524 batch_time=0.58312 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.16936 (QuantReg: 13.58467) QuantErr: 13.58467 batch_time=0.58545 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 0.95382 (QuantReg: 13.49768) QuantErr: 13.49768 batch_time=0.60135 
Train Epoch: 27 codebook_update_time=1.74494
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch27.pth ...
Done in 20.369s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 1.1682313027381896
 quant_reg      : 13.432865737915039
 quant_err      : 13.432865737915039
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.359
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.23877796438463
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.845
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.98495096882283
 mnt_best       : 44.688695681897265
 not_improved_count: 1
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.36630 (QuantReg: 13.38341) QuantErr: 13.38341 batch_time=32.81293 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.19874 (QuantReg: 13.51595) QuantErr: 13.51595 batch_time=0.58551 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.88783 (QuantReg: 13.22233) QuantErr: 13.22233 batch_time=0.58717 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.02463 (QuantReg: 13.23083) QuantErr: 13.23083 batch_time=0.60372 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.38396 (QuantReg: 13.55373) QuantErr: 13.55373 batch_time=0.66925 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.20014 (QuantReg: 13.22188) QuantErr: 13.22188 batch_time=0.58345 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.28187 (QuantReg: 13.53208) QuantErr: 13.53208 batch_time=0.59914 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 0.98657 (QuantReg: 13.38280) QuantErr: 13.38280 batch_time=0.60440 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.16001 (QuantReg: 13.48354) QuantErr: 13.48354 batch_time=0.58265 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.13776 (QuantReg: 13.60008) QuantErr: 13.60008 batch_time=0.58097 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.33882 (QuantReg: 13.29752) QuantErr: 13.29752 batch_time=0.58597 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.08878 (QuantReg: 13.82595) QuantErr: 13.82595 batch_time=0.61085 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 0.93675 (QuantReg: 13.52023) QuantErr: 13.52023 batch_time=0.56596 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.15478 (QuantReg: 13.38544) QuantErr: 13.38544 batch_time=0.58493 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.01216 (QuantReg: 13.19114) QuantErr: 13.19114 batch_time=0.56948 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.31872 (QuantReg: 13.69302) QuantErr: 13.69302 batch_time=0.57368 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.14363 (QuantReg: 13.47513) QuantErr: 13.47513 batch_time=0.65064 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.40020 (QuantReg: 13.52550) QuantErr: 13.52550 batch_time=0.60970 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.00080 (QuantReg: 13.72203) QuantErr: 13.72203 batch_time=0.57630 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 0.95315 (QuantReg: 13.99067) QuantErr: 13.99067 batch_time=0.61543 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.28864 (QuantReg: 13.50677) QuantErr: 13.50677 batch_time=0.59507 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.23829 (QuantReg: 13.47570) QuantErr: 13.47570 batch_time=0.59788 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.13627 (QuantReg: 13.25289) QuantErr: 13.25289 batch_time=0.61221 
Train Epoch: 28 codebook_update_time=1.76979
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch28.pth ...
Done in 9.379s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch28.pth ...
Done in 23.630s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 1.1542824113368988
 quant_reg      : 13.465543926239013
 quant_err      : 13.465543926239013
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.657
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.102728823682
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.9925
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.782234740240575
 mnt_best       : 46.102728823682
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.05687 (QuantReg: 13.43730) QuantErr: 13.43730 batch_time=34.07865 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.05416 (QuantReg: 13.40123) QuantErr: 13.40123 batch_time=0.58823 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.01956 (QuantReg: 13.69214) QuantErr: 13.69214 batch_time=0.56281 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.32487 (QuantReg: 13.14074) QuantErr: 13.14074 batch_time=0.60865 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.07406 (QuantReg: 13.19925) QuantErr: 13.19925 batch_time=0.56944 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 0.88088 (QuantReg: 13.23042) QuantErr: 13.23042 batch_time=0.56903 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.41294 (QuantReg: 13.60784) QuantErr: 13.60784 batch_time=0.57311 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 0.81805 (QuantReg: 13.36801) QuantErr: 13.36801 batch_time=0.60902 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 0.95255 (QuantReg: 13.37803) QuantErr: 13.37803 batch_time=0.58980 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.42043 (QuantReg: 13.18241) QuantErr: 13.18241 batch_time=0.57938 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.31217 (QuantReg: 13.47645) QuantErr: 13.47645 batch_time=0.57553 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.32264 (QuantReg: 13.64793) QuantErr: 13.64793 batch_time=0.60646 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 0.94669 (QuantReg: 13.27867) QuantErr: 13.27867 batch_time=0.59719 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 0.99092 (QuantReg: 13.80781) QuantErr: 13.80781 batch_time=0.57271 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 0.84703 (QuantReg: 13.48831) QuantErr: 13.48831 batch_time=0.56973 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.27376 (QuantReg: 13.55092) QuantErr: 13.55092 batch_time=0.58318 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 0.97138 (QuantReg: 13.70812) QuantErr: 13.70812 batch_time=0.59495 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.34007 (QuantReg: 13.36919) QuantErr: 13.36919 batch_time=0.57501 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 0.87120 (QuantReg: 13.38122) QuantErr: 13.38122 batch_time=0.58432 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.05479 (QuantReg: 13.46781) QuantErr: 13.46781 batch_time=0.56699 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.09552 (QuantReg: 13.43526) QuantErr: 13.43526 batch_time=0.58600 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.36119 (QuantReg: 13.32390) QuantErr: 13.32390 batch_time=0.57187 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.02151 (QuantReg: 13.37240) QuantErr: 13.37240 batch_time=0.60075 
Train Epoch: 29 codebook_update_time=1.72335
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch29.pth ...
Done in 19.396s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 1.1166573669910431
 quant_reg      : 13.486825115203857
 quant_err      : 13.486825115203857
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.535
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.4518588926449
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.974
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.81867020382898
 mnt_best       : 46.102728823682
 not_improved_count: 1
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 0.97913 (QuantReg: 13.13322) QuantErr: 13.13322 batch_time=36.60221 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.01035 (QuantReg: 13.45554) QuantErr: 13.45554 batch_time=0.56647 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 0.88313 (QuantReg: 13.74003) QuantErr: 13.74003 batch_time=0.56197 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.15436 (QuantReg: 13.47217) QuantErr: 13.47217 batch_time=0.58102 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.10036 (QuantReg: 13.20907) QuantErr: 13.20907 batch_time=0.56223 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.32721 (QuantReg: 13.67199) QuantErr: 13.67199 batch_time=0.56423 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.20690 (QuantReg: 13.36785) QuantErr: 13.36785 batch_time=0.59035 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.91629 (QuantReg: 13.46763) QuantErr: 13.46763 batch_time=0.56213 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.14740 (QuantReg: 13.62999) QuantErr: 13.62999 batch_time=0.84652 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.10862 (QuantReg: 13.86131) QuantErr: 13.86131 batch_time=0.57759 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.14337 (QuantReg: 13.50315) QuantErr: 13.50315 batch_time=0.59721 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.16671 (QuantReg: 13.83079) QuantErr: 13.83079 batch_time=0.61854 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.24702 (QuantReg: 13.33914) QuantErr: 13.33914 batch_time=0.60100 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.01503 (QuantReg: 13.36166) QuantErr: 13.36166 batch_time=0.64346 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.04780 (QuantReg: 13.58761) QuantErr: 13.58761 batch_time=0.59377 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.23504 (QuantReg: 13.65218) QuantErr: 13.65218 batch_time=0.57569 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.27262 (QuantReg: 13.47908) QuantErr: 13.47908 batch_time=0.59479 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.17078 (QuantReg: 13.53470) QuantErr: 13.53470 batch_time=0.57542 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.25697 (QuantReg: 13.58487) QuantErr: 13.58487 batch_time=0.57416 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.10633 (QuantReg: 13.58157) QuantErr: 13.58157 batch_time=0.62470 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.04665 (QuantReg: 13.59559) QuantErr: 13.59559 batch_time=0.57735 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.01112 (QuantReg: 13.89863) QuantErr: 13.89863 batch_time=0.71317 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.01578 (QuantReg: 13.75508) QuantErr: 13.75508 batch_time=0.60957 
Train Epoch: 30 codebook_update_time=1.75200
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch30.pth ...
Done in 12.636s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 1.1251580638885499
 quant_reg      : 13.524124927520752
 quant_err      : 13.524124927520752
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.205
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.9318985978744
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3515
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.48817103822564
 mnt_best       : 46.102728823682
 not_improved_count: 2
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.16249 (QuantReg: 13.27133) QuantErr: 13.27133 batch_time=35.76271 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.23305 (QuantReg: 13.42077) QuantErr: 13.42077 batch_time=4.06908 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.17211 (QuantReg: 13.44990) QuantErr: 13.44990 batch_time=0.57552 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.01442 (QuantReg: 13.43342) QuantErr: 13.43342 batch_time=0.60790 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.23660 (QuantReg: 13.11290) QuantErr: 13.11290 batch_time=0.60421 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.43856 (QuantReg: 13.32983) QuantErr: 13.32983 batch_time=0.58551 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.31085 (QuantReg: 12.99699) QuantErr: 12.99699 batch_time=0.74894 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.13407 (QuantReg: 13.48635) QuantErr: 13.48635 batch_time=0.56506 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 0.81381 (QuantReg: 13.51962) QuantErr: 13.51962 batch_time=0.56947 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.25538 (QuantReg: 13.51567) QuantErr: 13.51567 batch_time=0.60577 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.19390 (QuantReg: 13.47733) QuantErr: 13.47733 batch_time=0.59245 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.01507 (QuantReg: 13.28538) QuantErr: 13.28538 batch_time=0.59671 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.17744 (QuantReg: 13.38328) QuantErr: 13.38328 batch_time=0.58451 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.12981 (QuantReg: 13.51034) QuantErr: 13.51034 batch_time=0.80732 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.21642 (QuantReg: 13.65447) QuantErr: 13.65447 batch_time=0.61070 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.34124 (QuantReg: 13.44598) QuantErr: 13.44598 batch_time=0.59414 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.03120 (QuantReg: 13.47812) QuantErr: 13.47812 batch_time=0.59579 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 0.88553 (QuantReg: 13.65541) QuantErr: 13.65541 batch_time=0.58943 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.03857 (QuantReg: 13.61860) QuantErr: 13.61860 batch_time=0.67927 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.09181 (QuantReg: 13.59628) QuantErr: 13.59628 batch_time=0.59272 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.01467 (QuantReg: 13.79631) QuantErr: 13.79631 batch_time=0.73118 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.11799 (QuantReg: 13.59108) QuantErr: 13.59108 batch_time=0.63078 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.14733 (QuantReg: 13.30626) QuantErr: 13.30626 batch_time=0.58381 
Train Epoch: 31 codebook_update_time=1.79821
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch31.pth ...
Done in 4.373s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.0993885548114777
 quant_reg      : 13.512188915252686
 quant_err      : 13.512188915252686
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.708
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.494279359678906
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.0375
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.65745214893079
 mnt_best       : 46.102728823682
 not_improved_count: 3
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 0.82251 (QuantReg: 13.78928) QuantErr: 13.78928 batch_time=34.90621 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.13851 (QuantReg: 13.29866) QuantErr: 13.29866 batch_time=0.57800 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 0.98718 (QuantReg: 13.53321) QuantErr: 13.53321 batch_time=0.59762 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 0.97532 (QuantReg: 13.55642) QuantErr: 13.55642 batch_time=0.57003 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 1.23993 (QuantReg: 13.58292) QuantErr: 13.58292 batch_time=0.59819 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.15607 (QuantReg: 13.48758) QuantErr: 13.48758 batch_time=0.57414 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.18138 (QuantReg: 13.40221) QuantErr: 13.40221 batch_time=0.56760 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.00553 (QuantReg: 13.53190) QuantErr: 13.53190 batch_time=0.56792 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.02492 (QuantReg: 13.52289) QuantErr: 13.52289 batch_time=0.56872 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.04952 (QuantReg: 13.34609) QuantErr: 13.34609 batch_time=0.93304 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 0.89775 (QuantReg: 13.50717) QuantErr: 13.50717 batch_time=0.58443 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 0.80218 (QuantReg: 13.82190) QuantErr: 13.82190 batch_time=0.59152 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.09813 (QuantReg: 13.59415) QuantErr: 13.59415 batch_time=0.58280 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 0.91755 (QuantReg: 13.88039) QuantErr: 13.88039 batch_time=0.60339 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.12681 (QuantReg: 13.47674) QuantErr: 13.47674 batch_time=0.60806 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 0.94329 (QuantReg: 13.94152) QuantErr: 13.94152 batch_time=0.59713 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.00963 (QuantReg: 13.53241) QuantErr: 13.53241 batch_time=0.67825 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.00332 (QuantReg: 13.65663) QuantErr: 13.65663 batch_time=0.58375 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.16872 (QuantReg: 13.69106) QuantErr: 13.69106 batch_time=0.58527 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.11107 (QuantReg: 13.60966) QuantErr: 13.60966 batch_time=0.66757 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 0.95117 (QuantReg: 13.81701) QuantErr: 13.81701 batch_time=0.60004 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.24061 (QuantReg: 13.72025) QuantErr: 13.72025 batch_time=0.61130 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.15481 (QuantReg: 13.82746) QuantErr: 13.82746 batch_time=0.59402 
Train Epoch: 32 codebook_update_time=1.74164
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch32.pth ...
Done in 10.952s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 1.1057351796627044
 quant_reg      : 13.532840217590332
 quant_err      : 13.532840217590332
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.067
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.58591824342066
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.0785
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.995216051480355
 mnt_best       : 46.102728823682
 not_improved_count: 4
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.42816 (QuantReg: 13.63406) QuantErr: 13.63406 batch_time=33.10208 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.12856 (QuantReg: 13.70479) QuantErr: 13.70479 batch_time=0.59342 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.07975 (QuantReg: 13.57587) QuantErr: 13.57587 batch_time=2.03052 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.29411 (QuantReg: 13.23289) QuantErr: 13.23289 batch_time=0.59185 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.05578 (QuantReg: 13.74461) QuantErr: 13.74461 batch_time=0.59195 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.13877 (QuantReg: 13.40908) QuantErr: 13.40908 batch_time=0.73829 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 1.08535 (QuantReg: 13.56966) QuantErr: 13.56966 batch_time=0.71448 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.15309 (QuantReg: 13.49667) QuantErr: 13.49667 batch_time=1.32347 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.18255 (QuantReg: 13.40525) QuantErr: 13.40525 batch_time=0.60685 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.06351 (QuantReg: 13.60808) QuantErr: 13.60808 batch_time=0.62387 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.20569 (QuantReg: 13.50948) QuantErr: 13.50948 batch_time=0.59297 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.32434 (QuantReg: 13.52896) QuantErr: 13.52896 batch_time=0.59603 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.22029 (QuantReg: 13.16036) QuantErr: 13.16036 batch_time=0.58350 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.25893 (QuantReg: 13.66339) QuantErr: 13.66339 batch_time=0.85793 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 0.93264 (QuantReg: 13.81960) QuantErr: 13.81960 batch_time=0.59090 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.92859 (QuantReg: 13.75719) QuantErr: 13.75719 batch_time=0.58874 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.94052 (QuantReg: 13.76458) QuantErr: 13.76458 batch_time=0.63921 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.00807 (QuantReg: 13.43237) QuantErr: 13.43237 batch_time=0.62171 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 0.97750 (QuantReg: 13.47357) QuantErr: 13.47357 batch_time=0.62839 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.05165 (QuantReg: 13.35397) QuantErr: 13.35397 batch_time=0.60015 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 1.08865 (QuantReg: 13.52832) QuantErr: 13.52832 batch_time=0.62558 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.06056 (QuantReg: 13.44444) QuantErr: 13.44444 batch_time=0.58886 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.07768 (QuantReg: 13.63818) QuantErr: 13.63818 batch_time=0.57614 
Train Epoch: 33 codebook_update_time=2.01634
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch33.pth ...
Done in 4.270s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.0687658224105836
 quant_reg      : 13.55228299331665
 quant_err      : 13.55228299331665
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.865
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.10954054369752
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.919
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.717904323942655
 mnt_best       : 46.102728823682
 not_improved_count: 5
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.11316 (QuantReg: 13.51067) QuantErr: 13.51067 batch_time=32.70998 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 0.93318 (QuantReg: 13.58192) QuantErr: 13.58192 batch_time=0.62447 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 0.83214 (QuantReg: 13.56112) QuantErr: 13.56112 batch_time=0.57917 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 0.98308 (QuantReg: 13.51246) QuantErr: 13.51246 batch_time=0.57647 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.02297 (QuantReg: 13.45415) QuantErr: 13.45415 batch_time=0.58569 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 0.87125 (QuantReg: 13.61980) QuantErr: 13.61980 batch_time=0.56509 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.40676 (QuantReg: 13.43801) QuantErr: 13.43801 batch_time=1.37372 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.23957 (QuantReg: 13.39634) QuantErr: 13.39634 batch_time=0.57132 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 0.81792 (QuantReg: 13.62476) QuantErr: 13.62476 batch_time=0.61849 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 0.92974 (QuantReg: 13.74964) QuantErr: 13.74964 batch_time=0.57723 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.33157 (QuantReg: 13.56825) QuantErr: 13.56825 batch_time=0.60879 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 0.99309 (QuantReg: 13.68365) QuantErr: 13.68365 batch_time=0.59821 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.04695 (QuantReg: 13.32103) QuantErr: 13.32103 batch_time=0.59590 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 0.88485 (QuantReg: 13.85555) QuantErr: 13.85555 batch_time=0.61346 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.29380 (QuantReg: 13.69361) QuantErr: 13.69361 batch_time=0.57950 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 0.96405 (QuantReg: 13.64111) QuantErr: 13.64111 batch_time=0.62461 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.13767 (QuantReg: 13.61910) QuantErr: 13.61910 batch_time=0.57309 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 0.96965 (QuantReg: 13.72427) QuantErr: 13.72427 batch_time=0.60848 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.16333 (QuantReg: 13.71462) QuantErr: 13.71462 batch_time=1.33176 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 0.95021 (QuantReg: 13.55058) QuantErr: 13.55058 batch_time=0.62882 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.20342 (QuantReg: 13.70582) QuantErr: 13.70582 batch_time=0.61293 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.17542 (QuantReg: 13.49005) QuantErr: 13.49005 batch_time=0.59907 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 0.72491 (QuantReg: 13.87525) QuantErr: 13.87525 batch_time=0.63087 
Train Epoch: 34 codebook_update_time=1.94926
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch34.pth ...
Done in 4.353s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 1.057789455652237
 quant_reg      : 13.608151691436767
 quant_err      : 13.608151691436767
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.936
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.47529585151807
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.5305
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.596353795034304
 mnt_best       : 46.102728823682
 not_improved_count: 6
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.07159 (QuantReg: 13.48529) QuantErr: 13.48529 batch_time=39.66782 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.13275 (QuantReg: 13.25654) QuantErr: 13.25654 batch_time=1.74535 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.29113 (QuantReg: 13.26357) QuantErr: 13.26357 batch_time=0.64938 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.12054 (QuantReg: 13.61094) QuantErr: 13.61094 batch_time=0.57881 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.49608 (QuantReg: 13.41417) QuantErr: 13.41417 batch_time=0.59404 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.14132 (QuantReg: 13.59740) QuantErr: 13.59740 batch_time=0.60820 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 0.95703 (QuantReg: 13.73522) QuantErr: 13.73522 batch_time=0.57710 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.13933 (QuantReg: 13.49309) QuantErr: 13.49309 batch_time=0.60754 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 0.81316 (QuantReg: 13.42374) QuantErr: 13.42374 batch_time=0.63982 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.34031 (QuantReg: 13.52109) QuantErr: 13.52109 batch_time=0.57117 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.79097 (QuantReg: 13.55239) QuantErr: 13.55239 batch_time=0.61787 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.18217 (QuantReg: 13.67830) QuantErr: 13.67830 batch_time=0.59104 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.00330 (QuantReg: 13.48745) QuantErr: 13.48745 batch_time=0.61829 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.07235 (QuantReg: 13.41041) QuantErr: 13.41041 batch_time=0.63572 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.01437 (QuantReg: 13.47725) QuantErr: 13.47725 batch_time=0.62188 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.96705 (QuantReg: 13.71518) QuantErr: 13.71518 batch_time=0.56389 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.24519 (QuantReg: 13.55481) QuantErr: 13.55481 batch_time=0.61759 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.03820 (QuantReg: 13.75105) QuantErr: 13.75105 batch_time=0.61101 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.45569 (QuantReg: 13.28502) QuantErr: 13.28502 batch_time=0.54846 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 0.98554 (QuantReg: 13.96243) QuantErr: 13.96243 batch_time=0.58469 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.30925 (QuantReg: 13.50346) QuantErr: 13.50346 batch_time=0.57643 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.00016 (QuantReg: 13.31306) QuantErr: 13.31306 batch_time=0.57490 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.99879 (QuantReg: 13.67220) QuantErr: 13.67220 batch_time=0.60123 
Train Epoch: 35 codebook_update_time=1.73268
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch35.pth ...
Done in 4.244s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 1.0846376750469209
 quant_reg      : 13.585664543151855
 quant_err      : 13.585664543151855
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.166
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.310445963173166
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6295
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.4882690846117
 mnt_best       : 46.102728823682
 not_improved_count: 7
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.38082 (QuantReg: 13.22346) QuantErr: 13.22346 batch_time=35.13652 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.01064 (QuantReg: 13.80060) QuantErr: 13.80060 batch_time=0.59659 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 1.10890 (QuantReg: 13.54987) QuantErr: 13.54987 batch_time=0.57429 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.01095 (QuantReg: 13.40094) QuantErr: 13.40094 batch_time=0.56893 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.01932 (QuantReg: 13.77676) QuantErr: 13.77676 batch_time=1.65155 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.99596 (QuantReg: 13.55418) QuantErr: 13.55418 batch_time=0.60599 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 0.86857 (QuantReg: 13.80209) QuantErr: 13.80209 batch_time=0.91717 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.01530 (QuantReg: 13.84118) QuantErr: 13.84118 batch_time=1.26087 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 0.94453 (QuantReg: 13.47680) QuantErr: 13.47680 batch_time=0.57467 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.19064 (QuantReg: 13.52062) QuantErr: 13.52062 batch_time=0.58992 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 0.90064 (QuantReg: 13.79176) QuantErr: 13.79176 batch_time=0.56756 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.14670 (QuantReg: 13.06242) QuantErr: 13.06242 batch_time=0.59288 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.43704 (QuantReg: 13.61135) QuantErr: 13.61135 batch_time=0.58200 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.11856 (QuantReg: 13.73489) QuantErr: 13.73489 batch_time=4.39360 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.29235 (QuantReg: 13.65903) QuantErr: 13.65903 batch_time=0.57158 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 1.10563 (QuantReg: 13.53314) QuantErr: 13.53314 batch_time=0.59160 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.33968 (QuantReg: 13.49500) QuantErr: 13.49500 batch_time=0.57726 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.99871 (QuantReg: 13.35550) QuantErr: 13.35550 batch_time=0.58324 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.82566 (QuantReg: 13.89149) QuantErr: 13.89149 batch_time=0.58847 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.98595 (QuantReg: 13.64999) QuantErr: 13.64999 batch_time=0.58824 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.84825 (QuantReg: 13.84026) QuantErr: 13.84026 batch_time=0.57886 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.04958 (QuantReg: 13.39919) QuantErr: 13.39919 batch_time=0.58254 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.74344 (QuantReg: 13.78029) QuantErr: 13.78029 batch_time=0.59739 
Train Epoch: 36 codebook_update_time=1.85149
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch36.pth ...
Done in 4.400s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 1.0492392103672028
 quant_reg      : 13.598923042297363
 quant_err      : 13.598923042297363
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.842
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.593929054816805
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.538
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.27843537964372
 mnt_best       : 46.102728823682
 not_improved_count: 8
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.26679 (QuantReg: 13.45397) QuantErr: 13.45397 batch_time=33.37106 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.05120 (QuantReg: 13.39554) QuantErr: 13.39554 batch_time=0.59559 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.94301 (QuantReg: 13.45288) QuantErr: 13.45288 batch_time=0.61719 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.23826 (QuantReg: 13.55532) QuantErr: 13.55532 batch_time=0.57043 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 0.92168 (QuantReg: 13.67278) QuantErr: 13.67278 batch_time=0.60077 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 0.92175 (QuantReg: 13.67347) QuantErr: 13.67347 batch_time=0.60863 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 0.85070 (QuantReg: 13.43828) QuantErr: 13.43828 batch_time=3.15140 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.12713 (QuantReg: 13.57272) QuantErr: 13.57272 batch_time=0.58683 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 0.88040 (QuantReg: 13.69812) QuantErr: 13.69812 batch_time=0.62267 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.91833 (QuantReg: 13.58777) QuantErr: 13.58777 batch_time=0.57385 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.19926 (QuantReg: 13.81479) QuantErr: 13.81479 batch_time=0.57930 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.01343 (QuantReg: 13.72144) QuantErr: 13.72144 batch_time=0.58253 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 0.94193 (QuantReg: 13.87106) QuantErr: 13.87106 batch_time=0.60147 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.06004 (QuantReg: 13.77199) QuantErr: 13.77199 batch_time=0.62137 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.88219 (QuantReg: 13.84358) QuantErr: 13.84358 batch_time=0.57099 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.88967 (QuantReg: 13.67908) QuantErr: 13.67908 batch_time=0.58060 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.94765 (QuantReg: 13.76214) QuantErr: 13.76214 batch_time=0.61972 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 1.05973 (QuantReg: 13.35200) QuantErr: 13.35200 batch_time=0.62062 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.09952 (QuantReg: 13.80507) QuantErr: 13.80507 batch_time=0.60579 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 0.93032 (QuantReg: 13.60511) QuantErr: 13.60511 batch_time=0.57390 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.05965 (QuantReg: 13.84229) QuantErr: 13.84229 batch_time=0.60240 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 0.96421 (QuantReg: 13.62638) QuantErr: 13.62638 batch_time=0.56860 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.30335 (QuantReg: 13.77850) QuantErr: 13.77850 batch_time=0.60204 
Train Epoch: 37 codebook_update_time=1.84736
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch37.pth ...
Done in 12.112s
removing stale ckpt [epoch 36] [took 0.09s]
 epoch          : 37
 loss           : 1.0558741722106935
 quant_reg      : 13.629123992919922
 quant_err      : 13.629123992919922
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.172
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.79071594073627
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.073
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.429137854327834
 mnt_best       : 46.102728823682
 not_improved_count: 9
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.96432 (QuantReg: 13.61623) QuantErr: 13.61623 batch_time=32.43816 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.86347 (QuantReg: 13.54875) QuantErr: 13.54875 batch_time=0.59183 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.87573 (QuantReg: 13.92459) QuantErr: 13.92459 batch_time=0.60550 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.41930 (QuantReg: 13.31021) QuantErr: 13.31021 batch_time=0.56805 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.09593 (QuantReg: 13.42759) QuantErr: 13.42759 batch_time=0.63028 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 1.06635 (QuantReg: 13.35191) QuantErr: 13.35191 batch_time=0.57827 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.11190 (QuantReg: 13.93711) QuantErr: 13.93711 batch_time=1.54881 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.79722 (QuantReg: 13.48226) QuantErr: 13.48226 batch_time=0.61169 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 0.93278 (QuantReg: 13.73910) QuantErr: 13.73910 batch_time=0.56299 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.89301 (QuantReg: 13.63709) QuantErr: 13.63709 batch_time=0.58724 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.86840 (QuantReg: 13.76316) QuantErr: 13.76316 batch_time=0.58454 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 0.80430 (QuantReg: 13.69943) QuantErr: 13.69943 batch_time=0.64263 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 0.92276 (QuantReg: 13.81078) QuantErr: 13.81078 batch_time=1.07735 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.20722 (QuantReg: 13.60970) QuantErr: 13.60970 batch_time=0.57647 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 0.98204 (QuantReg: 13.71042) QuantErr: 13.71042 batch_time=0.57812 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.80316 (QuantReg: 13.95920) QuantErr: 13.95920 batch_time=0.61252 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.20894 (QuantReg: 13.54517) QuantErr: 13.54517 batch_time=0.59285 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.03724 (QuantReg: 13.65558) QuantErr: 13.65558 batch_time=0.59861 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 0.89175 (QuantReg: 13.61074) QuantErr: 13.61074 batch_time=2.29950 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.07878 (QuantReg: 13.89747) QuantErr: 13.89747 batch_time=0.56983 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.41548 (QuantReg: 13.33108) QuantErr: 13.33108 batch_time=0.58706 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.11136 (QuantReg: 13.52650) QuantErr: 13.52650 batch_time=0.63574 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.05295 (QuantReg: 13.63340) QuantErr: 13.63340 batch_time=0.61817 
Train Epoch: 38 codebook_update_time=1.89798
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch38.pth ...
Done in 4.332s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.0550884416103363
 quant_reg      : 13.657414920806884
 quant_err      : 13.657414920806884
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.466
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.015221188321966
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.877
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.535059696453885
 mnt_best       : 46.102728823682
 not_improved_count: 10
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.88809 (QuantReg: 13.52552) QuantErr: 13.52552 batch_time=35.28727 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.05072 (QuantReg: 13.57281) QuantErr: 13.57281 batch_time=0.57551 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.02247 (QuantReg: 13.84162) QuantErr: 13.84162 batch_time=0.59373 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.22262 (QuantReg: 13.57598) QuantErr: 13.57598 batch_time=0.58301 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 0.97398 (QuantReg: 13.76105) QuantErr: 13.76105 batch_time=0.63624 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.14011 (QuantReg: 13.62377) QuantErr: 13.62377 batch_time=0.61093 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 0.94329 (QuantReg: 13.70134) QuantErr: 13.70134 batch_time=0.59608 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.09179 (QuantReg: 13.98619) QuantErr: 13.98619 batch_time=0.58662 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.14104 (QuantReg: 13.65405) QuantErr: 13.65405 batch_time=0.57225 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.01346 (QuantReg: 14.00328) QuantErr: 14.00328 batch_time=0.67751 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.99056 (QuantReg: 13.63072) QuantErr: 13.63072 batch_time=0.57648 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.06060 (QuantReg: 13.61605) QuantErr: 13.61605 batch_time=0.60453 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.00070 (QuantReg: 13.77213) QuantErr: 13.77213 batch_time=0.57438 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.39228 (QuantReg: 13.50135) QuantErr: 13.50135 batch_time=0.57075 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.30628 (QuantReg: 13.66060) QuantErr: 13.66060 batch_time=0.58563 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.23856 (QuantReg: 13.52774) QuantErr: 13.52774 batch_time=0.59549 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.69121 (QuantReg: 13.30799) QuantErr: 13.30799 batch_time=0.58407 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.97891 (QuantReg: 13.48516) QuantErr: 13.48516 batch_time=0.60525 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.91020 (QuantReg: 13.54816) QuantErr: 13.54816 batch_time=0.59188 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.23538 (QuantReg: 13.55301) QuantErr: 13.55301 batch_time=0.57192 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 0.72349 (QuantReg: 13.52177) QuantErr: 13.52177 batch_time=0.59309 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.10192 (QuantReg: 13.56653) QuantErr: 13.56653 batch_time=0.56950 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.86602 (QuantReg: 13.85124) QuantErr: 13.85124 batch_time=0.58534 
Train Epoch: 39 codebook_update_time=2.13063
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch39.pth ...
Done in 5.187s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 1.050066410779953
 quant_reg      : 13.634704010009767
 quant_err      : 13.634704010009767
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.021
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.99093709293275
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.155
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.54474807522394
 mnt_best       : 46.102728823682
 not_improved_count: 11
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.01428 (QuantReg: 13.53984) QuantErr: 13.53984 batch_time=32.13320 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.06158 (QuantReg: 13.71736) QuantErr: 13.71736 batch_time=0.58723 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 0.89853 (QuantReg: 13.59413) QuantErr: 13.59413 batch_time=0.56136 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.86586 (QuantReg: 13.42669) QuantErr: 13.42669 batch_time=0.56950 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 0.79745 (QuantReg: 13.81906) QuantErr: 13.81906 batch_time=0.80950 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.23219 (QuantReg: 13.68844) QuantErr: 13.68844 batch_time=0.60142 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 0.97187 (QuantReg: 13.05091) QuantErr: 13.05091 batch_time=0.58234 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.21517 (QuantReg: 13.64345) QuantErr: 13.64345 batch_time=0.81729 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 0.89205 (QuantReg: 13.60885) QuantErr: 13.60885 batch_time=0.58382 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 1.04520 (QuantReg: 13.45943) QuantErr: 13.45943 batch_time=0.57289 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 0.91160 (QuantReg: 13.85503) QuantErr: 13.85503 batch_time=0.58638 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.04648 (QuantReg: 13.54840) QuantErr: 13.54840 batch_time=0.58264 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 0.80814 (QuantReg: 14.01537) QuantErr: 14.01537 batch_time=0.58599 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 0.95596 (QuantReg: 13.74969) QuantErr: 13.74969 batch_time=0.58363 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.19575 (QuantReg: 13.58031) QuantErr: 13.58031 batch_time=0.56830 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.01099 (QuantReg: 13.82097) QuantErr: 13.82097 batch_time=0.57581 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.00589 (QuantReg: 13.46000) QuantErr: 13.46000 batch_time=0.57741 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 0.96452 (QuantReg: 13.53722) QuantErr: 13.53722 batch_time=0.57689 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 0.89014 (QuantReg: 13.79281) QuantErr: 13.79281 batch_time=0.57229 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.22110 (QuantReg: 13.48094) QuantErr: 13.48094 batch_time=0.58190 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.16488 (QuantReg: 13.79233) QuantErr: 13.79233 batch_time=0.59562 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.90702 (QuantReg: 13.48925) QuantErr: 13.48925 batch_time=0.56793 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 1.36084 (QuantReg: 13.39236) QuantErr: 13.39236 batch_time=0.58791 
Train Epoch: 40 codebook_update_time=1.80634
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch40.pth ...
Done in 4.420s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 1.0388233180046083
 quant_reg      : 13.65099059677124
 quant_err      : 13.65099059677124
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.205
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.501541951527926
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.568
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.2294184928265
 mnt_best       : 46.102728823682
 not_improved_count: 12
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.78482 (QuantReg: 13.46069) QuantErr: 13.46069 batch_time=36.05899 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 0.85915 (QuantReg: 13.66825) QuantErr: 13.66825 batch_time=1.80293 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.13659 (QuantReg: 13.29016) QuantErr: 13.29016 batch_time=0.62534 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 0.94678 (QuantReg: 13.83617) QuantErr: 13.83617 batch_time=0.57706 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 0.87039 (QuantReg: 13.69620) QuantErr: 13.69620 batch_time=0.58590 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.93049 (QuantReg: 14.09425) QuantErr: 14.09425 batch_time=0.59140 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.89769 (QuantReg: 13.74152) QuantErr: 13.74152 batch_time=1.26282 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.12023 (QuantReg: 13.43867) QuantErr: 13.43867 batch_time=0.58906 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 0.81808 (QuantReg: 13.59239) QuantErr: 13.59239 batch_time=0.59399 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.14750 (QuantReg: 13.61963) QuantErr: 13.61963 batch_time=0.56643 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 0.88551 (QuantReg: 13.67546) QuantErr: 13.67546 batch_time=0.57977 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.03402 (QuantReg: 13.87442) QuantErr: 13.87442 batch_time=0.57871 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.21048 (QuantReg: 13.62486) QuantErr: 13.62486 batch_time=0.92006 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.02780 (QuantReg: 13.85827) QuantErr: 13.85827 batch_time=2.29780 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.10896 (QuantReg: 13.52380) QuantErr: 13.52380 batch_time=0.58085 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.06457 (QuantReg: 13.62581) QuantErr: 13.62581 batch_time=0.58549 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 0.73728 (QuantReg: 13.50382) QuantErr: 13.50382 batch_time=0.57125 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.94569 (QuantReg: 13.67865) QuantErr: 13.67865 batch_time=0.58463 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.15558 (QuantReg: 13.81978) QuantErr: 13.81978 batch_time=0.58808 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 0.91919 (QuantReg: 14.03199) QuantErr: 14.03199 batch_time=0.61398 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.03105 (QuantReg: 13.92253) QuantErr: 13.92253 batch_time=0.60160 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.26498 (QuantReg: 13.81364) QuantErr: 13.81364 batch_time=0.58996 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 0.97214 (QuantReg: 13.58865) QuantErr: 13.58865 batch_time=0.57302 
Train Epoch: 41 codebook_update_time=1.93230
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch41.pth ...
Done in 4.146s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch41.pth ...
Done in 8.110s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.0563860466480255
 quant_reg      : 13.683513366699218
 quant_err      : 13.683513366699218
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.582
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.22082230754971
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.432
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.00857055177519
 mnt_best       : 46.22082230754971
 not_improved_count: 0
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.08024 (QuantReg: 13.71714) QuantErr: 13.71714 batch_time=39.58810 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.99069 (QuantReg: 13.61416) QuantErr: 13.61416 batch_time=0.55845 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.13667 (QuantReg: 13.77973) QuantErr: 13.77973 batch_time=0.58395 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 0.98614 (QuantReg: 13.76923) QuantErr: 13.76923 batch_time=0.59030 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.04913 (QuantReg: 13.86906) QuantErr: 13.86906 batch_time=0.58368 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.33636 (QuantReg: 13.81203) QuantErr: 13.81203 batch_time=0.59090 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.02303 (QuantReg: 13.69229) QuantErr: 13.69229 batch_time=0.56201 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.33704 (QuantReg: 13.57056) QuantErr: 13.57056 batch_time=0.56800 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.97355 (QuantReg: 13.63801) QuantErr: 13.63801 batch_time=0.93374 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.13846 (QuantReg: 13.46251) QuantErr: 13.46251 batch_time=0.92775 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 0.93207 (QuantReg: 13.74232) QuantErr: 13.74232 batch_time=0.62250 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.21915 (QuantReg: 13.69686) QuantErr: 13.69686 batch_time=0.57608 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.00420 (QuantReg: 13.54051) QuantErr: 13.54051 batch_time=0.58504 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.95929 (QuantReg: 13.65909) QuantErr: 13.65909 batch_time=0.57164 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.24070 (QuantReg: 13.49283) QuantErr: 13.49283 batch_time=2.18098 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.17695 (QuantReg: 13.94703) QuantErr: 13.94703 batch_time=0.57146 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 1.49449 (QuantReg: 13.54953) QuantErr: 13.54953 batch_time=0.56223 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.98634 (QuantReg: 13.73061) QuantErr: 13.73061 batch_time=0.61629 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.88948 (QuantReg: 13.86460) QuantErr: 13.86460 batch_time=0.58314 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 0.69996 (QuantReg: 13.72005) QuantErr: 13.72005 batch_time=0.59389 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.30972 (QuantReg: 13.73101) QuantErr: 13.73101 batch_time=0.64983 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.94420 (QuantReg: 13.74965) QuantErr: 13.74965 batch_time=0.61763 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 0.92218 (QuantReg: 13.69169) QuantErr: 13.69169 batch_time=0.59664 
Train Epoch: 42 codebook_update_time=1.86526
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch42.pth ...
Done in 19.776s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.0425818734169006
 quant_reg      : 13.700948600769044
 quant_err      : 13.700948600769044
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.056
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.77759689465362
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.0835
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.75014811166818
 mnt_best       : 46.22082230754971
 not_improved_count: 1
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.91695 (QuantReg: 13.84833) QuantErr: 13.84833 batch_time=32.51892 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.02960 (QuantReg: 13.68355) QuantErr: 13.68355 batch_time=0.55542 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.20322 (QuantReg: 13.50212) QuantErr: 13.50212 batch_time=0.55420 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.12337 (QuantReg: 13.72235) QuantErr: 13.72235 batch_time=0.58950 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.02532 (QuantReg: 13.68048) QuantErr: 13.68048 batch_time=0.64307 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.00893 (QuantReg: 13.43189) QuantErr: 13.43189 batch_time=0.56597 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 0.74350 (QuantReg: 14.01105) QuantErr: 14.01105 batch_time=0.57937 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 0.83498 (QuantReg: 13.81945) QuantErr: 13.81945 batch_time=0.58960 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.12866 (QuantReg: 13.66916) QuantErr: 13.66916 batch_time=0.60202 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 0.82848 (QuantReg: 13.77106) QuantErr: 13.77106 batch_time=0.57976 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.05191 (QuantReg: 13.69137) QuantErr: 13.69137 batch_time=0.56546 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.85245 (QuantReg: 13.62257) QuantErr: 13.62257 batch_time=0.62047 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.05081 (QuantReg: 13.82777) QuantErr: 13.82777 batch_time=0.59733 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.77919 (QuantReg: 13.51058) QuantErr: 13.51058 batch_time=0.58265 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.18599 (QuantReg: 13.77989) QuantErr: 13.77989 batch_time=0.58712 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.07657 (QuantReg: 13.76181) QuantErr: 13.76181 batch_time=0.56671 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.38824 (QuantReg: 13.71819) QuantErr: 13.71819 batch_time=0.57571 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.98877 (QuantReg: 13.80873) QuantErr: 13.80873 batch_time=0.59489 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.28985 (QuantReg: 13.68578) QuantErr: 13.68578 batch_time=0.86684 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.03500 (QuantReg: 13.65059) QuantErr: 13.65059 batch_time=0.61258 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.40033 (QuantReg: 13.44077) QuantErr: 13.44077 batch_time=0.58652 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.94365 (QuantReg: 13.50456) QuantErr: 13.50456 batch_time=0.61432 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 0.81371 (QuantReg: 13.84819) QuantErr: 13.84819 batch_time=0.59712 
Train Epoch: 43 codebook_update_time=1.89404
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch43.pth ...
Done in 4.347s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 1.0177777996063233
 quant_reg      : 13.71001235961914
 quant_err      : 13.71001235961914
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.954
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.95436337148557
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.144
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.76607776289415
 mnt_best       : 46.22082230754971
 not_improved_count: 2
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 1.07653 (QuantReg: 13.85810) QuantErr: 13.85810 batch_time=30.01735 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.15351 (QuantReg: 13.67162) QuantErr: 13.67162 batch_time=0.71603 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.07696 (QuantReg: 13.91307) QuantErr: 13.91307 batch_time=0.57888 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.23673 (QuantReg: 13.74254) QuantErr: 13.74254 batch_time=0.57324 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.07051 (QuantReg: 13.69946) QuantErr: 13.69946 batch_time=0.57686 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.09273 (QuantReg: 13.83282) QuantErr: 13.83282 batch_time=0.58541 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 0.96369 (QuantReg: 13.67725) QuantErr: 13.67725 batch_time=1.64715 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.02509 (QuantReg: 13.48960) QuantErr: 13.48960 batch_time=0.56243 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.17210 (QuantReg: 13.89126) QuantErr: 13.89126 batch_time=0.57849 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 0.81828 (QuantReg: 13.83935) QuantErr: 13.83935 batch_time=0.58726 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.06404 (QuantReg: 13.70612) QuantErr: 13.70612 batch_time=0.58465 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.08171 (QuantReg: 13.87687) QuantErr: 13.87687 batch_time=0.57153 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 0.87721 (QuantReg: 13.91926) QuantErr: 13.91926 batch_time=0.58169 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 0.81537 (QuantReg: 13.80230) QuantErr: 13.80230 batch_time=0.60619 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 0.71353 (QuantReg: 13.94296) QuantErr: 13.94296 batch_time=0.56642 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 0.93445 (QuantReg: 13.58764) QuantErr: 13.58764 batch_time=0.63540 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 0.78768 (QuantReg: 13.66800) QuantErr: 13.66800 batch_time=0.60873 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.20282 (QuantReg: 13.72576) QuantErr: 13.72576 batch_time=0.57375 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.26099 (QuantReg: 13.32313) QuantErr: 13.32313 batch_time=1.08108 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 0.98987 (QuantReg: 13.81716) QuantErr: 13.81716 batch_time=0.59209 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 0.95531 (QuantReg: 13.96064) QuantErr: 13.96064 batch_time=0.60388 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.24282 (QuantReg: 13.50693) QuantErr: 13.50693 batch_time=0.57460 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 0.73380 (QuantReg: 13.89401) QuantErr: 13.89401 batch_time=0.55915 
Train Epoch: 44 codebook_update_time=1.69795
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch44.pth ...
Done in 17.228s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.0237818162441255
 quant_reg      : 13.71419898223877
 quant_err      : 13.71419898223877
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.594
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.97059242001209
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6425
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.83260004283513
 mnt_best       : 46.22082230754971
 not_improved_count: 3
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.02479 (QuantReg: 13.66231) QuantErr: 13.66231 batch_time=30.65185 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.24765 (QuantReg: 13.74455) QuantErr: 13.74455 batch_time=0.62581 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.99447 (QuantReg: 13.51479) QuantErr: 13.51479 batch_time=0.59454 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 0.94632 (QuantReg: 13.91779) QuantErr: 13.91779 batch_time=0.57910 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.17433 (QuantReg: 13.43253) QuantErr: 13.43253 batch_time=0.60555 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 0.95922 (QuantReg: 13.60475) QuantErr: 13.60475 batch_time=0.65439 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 1.17230 (QuantReg: 13.68755) QuantErr: 13.68755 batch_time=0.57843 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.06569 (QuantReg: 13.62384) QuantErr: 13.62384 batch_time=0.58092 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.00610 (QuantReg: 13.86501) QuantErr: 13.86501 batch_time=0.58421 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.96228 (QuantReg: 13.72230) QuantErr: 13.72230 batch_time=0.64382 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 1.04483 (QuantReg: 13.76674) QuantErr: 13.76674 batch_time=0.60477 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 0.90471 (QuantReg: 13.87915) QuantErr: 13.87915 batch_time=0.58974 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.35321 (QuantReg: 13.68258) QuantErr: 13.68258 batch_time=0.62832 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.02899 (QuantReg: 13.83575) QuantErr: 13.83575 batch_time=2.52090 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.25661 (QuantReg: 14.16934) QuantErr: 14.16934 batch_time=0.56432 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 1.18400 (QuantReg: 13.59719) QuantErr: 13.59719 batch_time=0.61794 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.13221 (QuantReg: 13.55978) QuantErr: 13.55978 batch_time=0.61941 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 0.98587 (QuantReg: 13.66771) QuantErr: 13.66771 batch_time=0.74247 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 1.19963 (QuantReg: 13.72330) QuantErr: 13.72330 batch_time=0.59773 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.96822 (QuantReg: 13.66369) QuantErr: 13.66369 batch_time=0.61179 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.08557 (QuantReg: 13.62256) QuantErr: 13.62256 batch_time=0.60874 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 1.01064 (QuantReg: 13.69724) QuantErr: 13.69724 batch_time=0.59313 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.25051 (QuantReg: 13.53566) QuantErr: 13.53566 batch_time=0.59460 
Train Epoch: 45 codebook_update_time=2.00050
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch45.pth ...
Done in 4.297s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 1.0284485664367675
 quant_reg      : 13.744293788909912
 quant_err      : 13.744293788909912
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.224
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.9604483591707
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.312
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.33183719840634
 mnt_best       : 46.22082230754971
 not_improved_count: 4
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.79745 (QuantReg: 13.68518) QuantErr: 13.68518 batch_time=33.61623 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 0.93654 (QuantReg: 13.73215) QuantErr: 13.73215 batch_time=0.61868 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.87757 (QuantReg: 13.74419) QuantErr: 13.74419 batch_time=0.57230 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.87386 (QuantReg: 13.65128) QuantErr: 13.65128 batch_time=0.57071 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.01826 (QuantReg: 13.90315) QuantErr: 13.90315 batch_time=0.64542 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.11573 (QuantReg: 13.52667) QuantErr: 13.52667 batch_time=0.58320 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.21335 (QuantReg: 13.58014) QuantErr: 13.58014 batch_time=0.56784 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.26222 (QuantReg: 13.63714) QuantErr: 13.63714 batch_time=0.56291 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 1.16593 (QuantReg: 13.66147) QuantErr: 13.66147 batch_time=1.20648 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.83364 (QuantReg: 14.03196) QuantErr: 14.03196 batch_time=0.57391 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.11891 (QuantReg: 13.72096) QuantErr: 13.72096 batch_time=0.61407 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.27456 (QuantReg: 13.66469) QuantErr: 13.66469 batch_time=0.57456 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.11726 (QuantReg: 13.76211) QuantErr: 13.76211 batch_time=1.24683 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 0.94899 (QuantReg: 13.59671) QuantErr: 13.59671 batch_time=0.58407 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 0.93986 (QuantReg: 13.74819) QuantErr: 13.74819 batch_time=0.61622 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.08027 (QuantReg: 13.82516) QuantErr: 13.82516 batch_time=0.57154 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.21604 (QuantReg: 13.52195) QuantErr: 13.52195 batch_time=1.81504 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 0.81866 (QuantReg: 13.90889) QuantErr: 13.90889 batch_time=0.57030 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.87427 (QuantReg: 14.11572) QuantErr: 14.11572 batch_time=0.73240 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 1.13648 (QuantReg: 13.94799) QuantErr: 13.94799 batch_time=0.59831 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.01269 (QuantReg: 13.67547) QuantErr: 13.67547 batch_time=0.63541 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.02944 (QuantReg: 13.82846) QuantErr: 13.82846 batch_time=0.59727 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.88804 (QuantReg: 13.89892) QuantErr: 13.89892 batch_time=0.58133 
Train Epoch: 46 codebook_update_time=1.86424
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch46.pth ...
Done in 4.432s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 1.0278205876350404
 quant_reg      : 13.770738082885742
 quant_err      : 13.770738082885742
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.706
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.6899540121691
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.291
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.17042015007571
 mnt_best       : 46.22082230754971
 not_improved_count: 5
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.15898 (QuantReg: 13.73483) QuantErr: 13.73483 batch_time=33.62285 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.00163 (QuantReg: 13.58206) QuantErr: 13.58206 batch_time=0.59037 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.20730 (QuantReg: 13.73887) QuantErr: 13.73887 batch_time=0.60766 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.05495 (QuantReg: 13.54881) QuantErr: 13.54881 batch_time=0.57935 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.00246 (QuantReg: 13.81087) QuantErr: 13.81087 batch_time=0.58866 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 1.19848 (QuantReg: 13.58194) QuantErr: 13.58194 batch_time=0.57200 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.17799 (QuantReg: 13.77408) QuantErr: 13.77408 batch_time=2.51918 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.05690 (QuantReg: 13.60633) QuantErr: 13.60633 batch_time=1.05601 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.16387 (QuantReg: 13.69837) QuantErr: 13.69837 batch_time=0.63213 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 1.10576 (QuantReg: 13.72197) QuantErr: 13.72197 batch_time=0.58363 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.97463 (QuantReg: 13.45815) QuantErr: 13.45815 batch_time=0.71068 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.80340 (QuantReg: 13.99249) QuantErr: 13.99249 batch_time=0.59345 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 0.95854 (QuantReg: 13.79424) QuantErr: 13.79424 batch_time=0.58791 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.16369 (QuantReg: 13.66330) QuantErr: 13.66330 batch_time=2.47467 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 0.78794 (QuantReg: 13.92553) QuantErr: 13.92553 batch_time=0.60544 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.23721 (QuantReg: 13.43035) QuantErr: 13.43035 batch_time=0.62253 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 0.92723 (QuantReg: 13.60238) QuantErr: 13.60238 batch_time=1.20572 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 0.95648 (QuantReg: 13.94302) QuantErr: 13.94302 batch_time=0.61842 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.18501 (QuantReg: 13.64668) QuantErr: 13.64668 batch_time=0.77755 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.98426 (QuantReg: 13.94799) QuantErr: 13.94799 batch_time=0.58380 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 1.25361 (QuantReg: 13.88941) QuantErr: 13.88941 batch_time=0.60197 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.14156 (QuantReg: 13.62324) QuantErr: 13.62324 batch_time=0.60571 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.02674 (QuantReg: 13.87404) QuantErr: 13.87404 batch_time=0.60407 
Train Epoch: 47 codebook_update_time=1.81836
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch47.pth ...
Done in 4.202s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch47.pth ...
Done in 8.394s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 1.0311750020980834
 quant_reg      : 13.738879035949706
 quant_err      : 13.738879035949706
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.35
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.35581840287489
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.591
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.50150137943189
 mnt_best       : 46.35581840287489
 not_improved_count: 0
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 0.77670 (QuantReg: 13.81449) QuantErr: 13.81449 batch_time=34.73025 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.18972 (QuantReg: 13.70952) QuantErr: 13.70952 batch_time=0.58668 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.12944 (QuantReg: 13.65659) QuantErr: 13.65659 batch_time=0.56693 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 0.90884 (QuantReg: 13.75742) QuantErr: 13.75742 batch_time=0.57606 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 0.97565 (QuantReg: 13.99749) QuantErr: 13.99749 batch_time=0.56937 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.22370 (QuantReg: 13.63769) QuantErr: 13.63769 batch_time=0.56168 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.06271 (QuantReg: 13.75138) QuantErr: 13.75138 batch_time=0.60513 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.04579 (QuantReg: 13.95357) QuantErr: 13.95357 batch_time=0.58105 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.00928 (QuantReg: 13.92985) QuantErr: 13.92985 batch_time=0.62448 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 0.96725 (QuantReg: 13.88968) QuantErr: 13.88968 batch_time=0.57457 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 0.72579 (QuantReg: 13.81748) QuantErr: 13.81748 batch_time=0.58898 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.12643 (QuantReg: 13.75425) QuantErr: 13.75425 batch_time=0.58269 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 0.88883 (QuantReg: 13.63046) QuantErr: 13.63046 batch_time=0.56773 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 0.88957 (QuantReg: 13.74272) QuantErr: 13.74272 batch_time=0.60927 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 0.85930 (QuantReg: 13.56820) QuantErr: 13.56820 batch_time=0.56732 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 0.83595 (QuantReg: 14.06916) QuantErr: 14.06916 batch_time=0.55574 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.72770 (QuantReg: 13.70930) QuantErr: 13.70930 batch_time=0.58425 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.33741 (QuantReg: 13.56491) QuantErr: 13.56491 batch_time=0.58307 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 0.89439 (QuantReg: 13.66773) QuantErr: 13.66773 batch_time=0.59577 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.13916 (QuantReg: 13.93675) QuantErr: 13.93675 batch_time=0.60080 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.07705 (QuantReg: 13.68127) QuantErr: 13.68127 batch_time=0.61927 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 0.85146 (QuantReg: 13.78554) QuantErr: 13.78554 batch_time=0.58863 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.02656 (QuantReg: 13.65884) QuantErr: 13.65884 batch_time=0.59095 
Train Epoch: 48 codebook_update_time=1.76291
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch48.pth ...
Done in 4.134s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 1.019856730222702
 quant_reg      : 13.772532760620118
 quant_err      : 13.772532760620118
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.815
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.09827571374385
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.091
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.25039623418456
 mnt_best       : 46.35581840287489
 not_improved_count: 1
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.05337 (QuantReg: 13.66232) QuantErr: 13.66232 batch_time=33.29247 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.27455 (QuantReg: 13.71513) QuantErr: 13.71513 batch_time=0.55659 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.08247 (QuantReg: 13.79777) QuantErr: 13.79777 batch_time=0.56330 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.28168 (QuantReg: 13.55804) QuantErr: 13.55804 batch_time=0.62478 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.11776 (QuantReg: 13.85164) QuantErr: 13.85164 batch_time=0.56755 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.07255 (QuantReg: 13.85315) QuantErr: 13.85315 batch_time=0.57158 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 0.90176 (QuantReg: 13.74206) QuantErr: 13.74206 batch_time=0.58145 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 1.09426 (QuantReg: 13.94013) QuantErr: 13.94013 batch_time=0.56609 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.83948 (QuantReg: 13.61076) QuantErr: 13.61076 batch_time=0.58599 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.95647 (QuantReg: 13.90470) QuantErr: 13.90470 batch_time=0.59063 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.22644 (QuantReg: 13.86688) QuantErr: 13.86688 batch_time=0.72213 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.00303 (QuantReg: 13.76527) QuantErr: 13.76527 batch_time=0.56448 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 0.86138 (QuantReg: 13.66177) QuantErr: 13.66177 batch_time=0.57474 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 0.94681 (QuantReg: 13.84250) QuantErr: 13.84250 batch_time=0.58988 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.10684 (QuantReg: 13.91818) QuantErr: 13.91818 batch_time=0.57316 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.86459 (QuantReg: 13.83369) QuantErr: 13.83369 batch_time=0.58935 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 1.31419 (QuantReg: 13.66520) QuantErr: 13.66520 batch_time=0.63039 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.12684 (QuantReg: 13.63857) QuantErr: 13.63857 batch_time=0.58423 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 0.96234 (QuantReg: 13.67672) QuantErr: 13.67672 batch_time=0.56959 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 0.90876 (QuantReg: 13.86038) QuantErr: 13.86038 batch_time=0.57482 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.27910 (QuantReg: 13.51512) QuantErr: 13.51512 batch_time=0.57851 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 1.08813 (QuantReg: 13.99284) QuantErr: 13.99284 batch_time=0.68959 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 0.99767 (QuantReg: 13.81113) QuantErr: 13.81113 batch_time=0.57879 
Train Epoch: 49 codebook_update_time=2.20934
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch49.pth ...
Done in 14.070s
removing stale ckpt [epoch 48] [took 0.11s]
 epoch          : 49
 loss           : 1.027138398885727
 quant_reg      : 13.817896564483643
 quant_err      : 13.817896564483643
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.274
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.7972001746312
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.171
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.95758025592887
 mnt_best       : 46.35581840287489
 not_improved_count: 2
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.11562 (QuantReg: 13.94445) QuantErr: 13.94445 batch_time=33.43569 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.09408 (QuantReg: 13.79098) QuantErr: 13.79098 batch_time=0.65774 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.06398 (QuantReg: 13.99947) QuantErr: 13.99947 batch_time=0.57654 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.04686 (QuantReg: 13.62856) QuantErr: 13.62856 batch_time=0.59194 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 0.97855 (QuantReg: 13.86096) QuantErr: 13.86096 batch_time=0.57176 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.99100 (QuantReg: 13.91676) QuantErr: 13.91676 batch_time=0.58313 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 0.84972 (QuantReg: 13.84055) QuantErr: 13.84055 batch_time=0.57398 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.92441 (QuantReg: 14.01761) QuantErr: 14.01761 batch_time=0.58950 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.86330 (QuantReg: 13.97717) QuantErr: 13.97717 batch_time=0.59097 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.05140 (QuantReg: 13.98613) QuantErr: 13.98613 batch_time=0.94272 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.08796 (QuantReg: 13.63029) QuantErr: 13.63029 batch_time=0.60553 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.99830 (QuantReg: 13.81283) QuantErr: 13.81283 batch_time=0.59178 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.19221 (QuantReg: 13.94736) QuantErr: 13.94736 batch_time=0.67813 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.11147 (QuantReg: 13.57400) QuantErr: 13.57400 batch_time=0.59458 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.04316 (QuantReg: 13.64281) QuantErr: 13.64281 batch_time=0.58773 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.77421 (QuantReg: 13.74436) QuantErr: 13.74436 batch_time=0.57722 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 0.97749 (QuantReg: 13.88047) QuantErr: 13.88047 batch_time=0.58228 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.22372 (QuantReg: 13.82903) QuantErr: 13.82903 batch_time=0.58477 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.64234 (QuantReg: 13.86291) QuantErr: 13.86291 batch_time=0.59842 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.89567 (QuantReg: 13.93548) QuantErr: 13.93548 batch_time=0.59967 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.00532 (QuantReg: 13.95981) QuantErr: 13.95981 batch_time=0.57852 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 0.91679 (QuantReg: 13.67949) QuantErr: 13.67949 batch_time=0.60226 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 0.97118 (QuantReg: 13.88966) QuantErr: 13.88966 batch_time=0.58125 
Train Epoch: 50 codebook_update_time=2.00129
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/checkpoint-epoch50.pth ...
Done in 4.552s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 1.0091633706092835
 quant_reg      : 13.810935604095459
 quant_err      : 13.810935604095459
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.116
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.147660347617595
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.7605
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.90056539644481
 mnt_best       : 46.35581840287489
 not_improved_count: 3
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/trained_model.pth ...
Ckpt loaded at epoch 47.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 25.8
 t2v_metrics/R5/final_eval: 56.2
 t2v_metrics/R10/final_eval: 68.7
 t2v_metrics/R50/final_eval: 87.5
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 28.35
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 46.35581840287489
 v2t_metrics/R1/final_eval: 24.6
 v2t_metrics/R5/final_eval: 55.5
 v2t_metrics/R10/final_eval: 69.0
 v2t_metrics/R50/final_eval: 88.4
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 25.5915
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 45.50150137943189
Best epoch for the monitored metric: 47
Script took 03h45m09s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-base/trained_model.pth
