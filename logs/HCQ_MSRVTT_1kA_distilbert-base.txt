Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base
Preparing the dataloaders ...
Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base
Preparing the dataloaders ...
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch0.pth ...
Done in 1.159s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch0.pth ...
Done in 2.250s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 503.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 500.523
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.4
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 503.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.8145
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3914867641168864
 mnt_best       : 0.4
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.84274 (QuantReg: 22.65345) QuantErr: 22.65345 batch_time=116.43528 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.52011 (QuantReg: 22.64871) QuantErr: 22.64871 batch_time=0.43033 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.33398 (QuantReg: 22.58366) QuantErr: 22.58366 batch_time=0.46316 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.62988 (QuantReg: 22.63880) QuantErr: 22.63880 batch_time=0.45454 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.44528 (QuantReg: 22.60021) QuantErr: 22.60021 batch_time=0.45580 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 5.88894 (QuantReg: 22.62334) QuantErr: 22.62334 batch_time=0.43440 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.57971 (QuantReg: 22.64596) QuantErr: 22.64596 batch_time=0.44151 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.23061 (QuantReg: 22.64252) QuantErr: 22.64252 batch_time=0.43693 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.47395 (QuantReg: 22.60229) QuantErr: 22.60229 batch_time=0.43030 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.28618 (QuantReg: 22.61806) QuantErr: 22.61806 batch_time=0.43212 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.20642 (QuantReg: 22.59529) QuantErr: 22.59529 batch_time=0.46599 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 5.05348 (QuantReg: 22.60873) QuantErr: 22.60873 batch_time=0.43426 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 4.83758 (QuantReg: 22.63026) QuantErr: 22.63026 batch_time=0.43834 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.88061 (QuantReg: 22.64003) QuantErr: 22.64003 batch_time=0.45195 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.58719 (QuantReg: 22.63640) QuantErr: 22.63640 batch_time=0.43646 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.62138 (QuantReg: 22.66127) QuantErr: 22.66127 batch_time=0.43840 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.33596 (QuantReg: 22.64863) QuantErr: 22.64863 batch_time=0.43476 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.66375 (QuantReg: 22.63329) QuantErr: 22.63329 batch_time=0.44470 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.19037 (QuantReg: 22.63953) QuantErr: 22.63953 batch_time=0.43569 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.21411 (QuantReg: 22.62505) QuantErr: 22.62505 batch_time=0.43600 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.37590 (QuantReg: 22.63910) QuantErr: 22.63910 batch_time=0.46197 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.92797 (QuantReg: 22.61586) QuantErr: 22.61586 batch_time=0.44208 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 4.19440 (QuantReg: 22.62114) QuantErr: 22.62114 batch_time=0.44209 
Train Epoch: 1 codebook_update_time=2.49242
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch1.pth ...
Done in 2.628s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch1.pth ...
Done in 5.171s
 epoch          : 1
 loss           : 5.272009886741638
 quant_reg      : 22.630845268249512
 quant_err      : 22.630845268249512
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 10.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 32.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 47.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 79.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 39.919
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.045110021149007
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 34.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 46.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 41.402
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.263244835268058
 mnt_best       : 25.045110021149007
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.20613 (QuantReg: 11.74175) QuantErr: 11.74175 batch_time=193.35993 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 3.86301 (QuantReg: 12.57694) QuantErr: 12.57694 batch_time=8.02593 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 3.87780 (QuantReg: 12.83769) QuantErr: 12.83769 batch_time=0.44412 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 4.39610 (QuantReg: 12.62352) QuantErr: 12.62352 batch_time=0.43545 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 4.11725 (QuantReg: 12.77454) QuantErr: 12.77454 batch_time=0.43801 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 4.05888 (QuantReg: 13.09196) QuantErr: 13.09196 batch_time=0.45359 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.22102 (QuantReg: 13.02900) QuantErr: 13.02900 batch_time=0.44615 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.81813 (QuantReg: 13.32957) QuantErr: 13.32957 batch_time=0.45163 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 3.79895 (QuantReg: 13.90870) QuantErr: 13.90870 batch_time=0.44044 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 3.65588 (QuantReg: 13.33296) QuantErr: 13.33296 batch_time=0.45557 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.79873 (QuantReg: 14.06632) QuantErr: 14.06632 batch_time=0.44923 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.78056 (QuantReg: 13.84675) QuantErr: 13.84675 batch_time=0.45647 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.43409 (QuantReg: 13.43102) QuantErr: 13.43102 batch_time=0.50513 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 3.76907 (QuantReg: 14.18176) QuantErr: 14.18176 batch_time=0.46554 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.40441 (QuantReg: 14.07955) QuantErr: 14.07955 batch_time=0.45941 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.40190 (QuantReg: 14.03122) QuantErr: 14.03122 batch_time=0.43449 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 4.29587 (QuantReg: 14.14546) QuantErr: 14.14546 batch_time=0.46890 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.78202 (QuantReg: 14.11786) QuantErr: 14.11786 batch_time=0.45905 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.35911 (QuantReg: 14.48715) QuantErr: 14.48715 batch_time=0.45938 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.11534 (QuantReg: 14.55858) QuantErr: 14.55858 batch_time=0.44019 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.59615 (QuantReg: 14.79869) QuantErr: 14.79869 batch_time=0.45074 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.11589 (QuantReg: 14.51616) QuantErr: 14.51616 batch_time=0.44781 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.56883 (QuantReg: 14.61742) QuantErr: 14.61742 batch_time=0.46488 
Train Epoch: 2 codebook_update_time=2.36787
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch2.pth ...
Done in 19.367s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch2.pth ...
Done in 21.937s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 3.6801603622436523
 quant_reg      : 13.666540561676026
 quant_err      : 13.666540561676026
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 39.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.739000000000004
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.155063515442198
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 39.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.995000000000005
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.26052297671636
 mnt_best       : 31.155063515442198
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.13098 (QuantReg: 12.34675) QuantErr: 12.34675 batch_time=83.59249 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.58753 (QuantReg: 12.09549) QuantErr: 12.09549 batch_time=0.44640 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.18441 (QuantReg: 12.54706) QuantErr: 12.54706 batch_time=0.43323 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 3.59964 (QuantReg: 12.27366) QuantErr: 12.27366 batch_time=4.59940 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.03840 (QuantReg: 12.50166) QuantErr: 12.50166 batch_time=0.44856 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 3.10390 (QuantReg: 12.25545) QuantErr: 12.25545 batch_time=0.43703 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.14015 (QuantReg: 12.58584) QuantErr: 12.58584 batch_time=0.44242 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.38635 (QuantReg: 12.87940) QuantErr: 12.87940 batch_time=8.03988 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.37787 (QuantReg: 12.51465) QuantErr: 12.51465 batch_time=0.47775 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 3.23847 (QuantReg: 12.82987) QuantErr: 12.82987 batch_time=0.43842 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.14045 (QuantReg: 12.66386) QuantErr: 12.66386 batch_time=0.44939 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 2.56838 (QuantReg: 12.83408) QuantErr: 12.83408 batch_time=0.45234 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.09166 (QuantReg: 13.10688) QuantErr: 13.10688 batch_time=0.43758 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 2.85956 (QuantReg: 12.83318) QuantErr: 12.83318 batch_time=8.75820 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.32294 (QuantReg: 13.05155) QuantErr: 13.05155 batch_time=0.44035 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.76602 (QuantReg: 13.07401) QuantErr: 13.07401 batch_time=0.43738 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 2.97188 (QuantReg: 13.13722) QuantErr: 13.13722 batch_time=0.44184 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.22633 (QuantReg: 12.95700) QuantErr: 12.95700 batch_time=0.43115 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 2.62446 (QuantReg: 13.29213) QuantErr: 13.29213 batch_time=0.42894 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.09954 (QuantReg: 13.36422) QuantErr: 13.36422 batch_time=7.32262 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.42462 (QuantReg: 12.90467) QuantErr: 12.90467 batch_time=0.42789 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.14373 (QuantReg: 13.18171) QuantErr: 13.18171 batch_time=0.44876 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 2.68063 (QuantReg: 13.74211) QuantErr: 13.74211 batch_time=0.47962 
Train Epoch: 3 codebook_update_time=2.65372
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch3.pth ...
Done in 3.773s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch3.pth ...
Done in 7.760s
removing stale ckpt [epoch 2] [took 0.09s]
 epoch          : 3
 loss           : 3.1390218381881714
 quant_reg      : 12.82812770462036
 quant_err      : 12.82812770462036
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.253
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.476264466958156
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.2095
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.33415320205652
 mnt_best       : 33.476264466958156
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 2.97754 (QuantReg: 12.10056) QuantErr: 12.10056 batch_time=113.53811 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 3.18093 (QuantReg: 12.49911) QuantErr: 12.49911 batch_time=0.45863 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.81157 (QuantReg: 12.31806) QuantErr: 12.31806 batch_time=6.44276 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.75012 (QuantReg: 12.43679) QuantErr: 12.43679 batch_time=0.44220 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.94561 (QuantReg: 12.51761) QuantErr: 12.51761 batch_time=0.43905 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 2.70571 (QuantReg: 12.67824) QuantErr: 12.67824 batch_time=0.44731 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.76976 (QuantReg: 12.33684) QuantErr: 12.33684 batch_time=5.09741 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.59797 (QuantReg: 12.82819) QuantErr: 12.82819 batch_time=0.45206 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 2.77075 (QuantReg: 12.50467) QuantErr: 12.50467 batch_time=0.55016 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 3.04260 (QuantReg: 12.73257) QuantErr: 12.73257 batch_time=0.45147 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 2.50710 (QuantReg: 12.74005) QuantErr: 12.74005 batch_time=2.07660 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.86738 (QuantReg: 12.58849) QuantErr: 12.58849 batch_time=0.44464 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 2.96274 (QuantReg: 12.88575) QuantErr: 12.88575 batch_time=0.43483 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.88365 (QuantReg: 13.10336) QuantErr: 13.10336 batch_time=0.53931 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.80869 (QuantReg: 12.72515) QuantErr: 12.72515 batch_time=0.55320 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.74920 (QuantReg: 12.91890) QuantErr: 12.91890 batch_time=0.44993 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.82033 (QuantReg: 13.12398) QuantErr: 13.12398 batch_time=0.45064 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.68312 (QuantReg: 13.05349) QuantErr: 13.05349 batch_time=8.97208 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.70572 (QuantReg: 13.26083) QuantErr: 13.26083 batch_time=2.07188 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.48810 (QuantReg: 12.89363) QuantErr: 12.89363 batch_time=0.45561 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.37460 (QuantReg: 13.11571) QuantErr: 13.11571 batch_time=7.88054 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.45785 (QuantReg: 13.04725) QuantErr: 13.04725 batch_time=1.82008 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.97003 (QuantReg: 13.33053) QuantErr: 13.33053 batch_time=0.43415 
Train Epoch: 4 codebook_update_time=1.91237
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch4.pth ...
Done in 3.637s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch4.pth ...
Done in 7.313s
removing stale ckpt [epoch 3] [took 0.06s]
 epoch          : 4
 loss           : 2.8303982601165774
 quant_reg      : 12.740248588562011
 quant_err      : 12.740248588562011
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.176
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.38089102873392
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.493
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.0018826175963
 mnt_best       : 36.38089102873392
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.83931 (QuantReg: 12.13851) QuantErr: 12.13851 batch_time=96.70955 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.00095 (QuantReg: 12.72315) QuantErr: 12.72315 batch_time=0.44041 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 1.98225 (QuantReg: 12.72283) QuantErr: 12.72283 batch_time=0.43718 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.79491 (QuantReg: 12.45291) QuantErr: 12.45291 batch_time=0.43931 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 3.05472 (QuantReg: 12.38039) QuantErr: 12.38039 batch_time=0.45127 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.61253 (QuantReg: 12.44307) QuantErr: 12.44307 batch_time=0.43761 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.71014 (QuantReg: 12.57768) QuantErr: 12.57768 batch_time=0.45151 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 3.16469 (QuantReg: 12.39293) QuantErr: 12.39293 batch_time=0.45701 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.52687 (QuantReg: 12.46829) QuantErr: 12.46829 batch_time=6.43233 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.71897 (QuantReg: 12.58669) QuantErr: 12.58669 batch_time=0.43187 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.29799 (QuantReg: 12.84130) QuantErr: 12.84130 batch_time=0.43973 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 3.09553 (QuantReg: 12.81386) QuantErr: 12.81386 batch_time=0.42286 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.58797 (QuantReg: 12.96181) QuantErr: 12.96181 batch_time=0.44195 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.37474 (QuantReg: 12.76598) QuantErr: 12.76598 batch_time=0.46014 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.91996 (QuantReg: 12.91977) QuantErr: 12.91977 batch_time=0.44949 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.84801 (QuantReg: 13.01010) QuantErr: 13.01010 batch_time=0.45030 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.44928 (QuantReg: 12.87792) QuantErr: 12.87792 batch_time=0.46763 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.29127 (QuantReg: 12.74856) QuantErr: 12.74856 batch_time=0.45178 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.70013 (QuantReg: 13.17450) QuantErr: 13.17450 batch_time=0.46139 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.42619 (QuantReg: 13.12312) QuantErr: 13.12312 batch_time=0.44799 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.54038 (QuantReg: 12.77630) QuantErr: 12.77630 batch_time=13.66722 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 3.26697 (QuantReg: 13.36591) QuantErr: 13.36591 batch_time=0.45815 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.22347 (QuantReg: 13.00611) QuantErr: 13.00611 batch_time=0.45208 
Train Epoch: 5 codebook_update_time=1.75510
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch5.pth ...
Done in 3.217s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch5.pth ...
Done in 6.950s
removing stale ckpt [epoch 4] [took 0.14s]
 epoch          : 5
 loss           : 2.596017980098724
 quant_reg      : 12.784067665100098
 quant_err      : 12.784067665100098
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.848
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.967048535246825
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.839
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.29652352556085
 mnt_best       : 37.967048535246825
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.43736 (QuantReg: 12.85634) QuantErr: 12.85634 batch_time=79.65230 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.28919 (QuantReg: 12.33379) QuantErr: 12.33379 batch_time=0.43383 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.51375 (QuantReg: 12.53324) QuantErr: 12.53324 batch_time=0.43684 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.88905 (QuantReg: 12.27685) QuantErr: 12.27685 batch_time=0.43869 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.67955 (QuantReg: 12.36001) QuantErr: 12.36001 batch_time=0.44345 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.69236 (QuantReg: 12.95203) QuantErr: 12.95203 batch_time=0.43720 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.77895 (QuantReg: 12.46198) QuantErr: 12.46198 batch_time=0.44118 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.94819 (QuantReg: 12.85487) QuantErr: 12.85487 batch_time=0.76357 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.51253 (QuantReg: 12.84071) QuantErr: 12.84071 batch_time=0.47514 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.27522 (QuantReg: 12.99007) QuantErr: 12.99007 batch_time=5.11623 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.50007 (QuantReg: 12.68301) QuantErr: 12.68301 batch_time=0.45657 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.42251 (QuantReg: 12.90317) QuantErr: 12.90317 batch_time=0.44829 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.03107 (QuantReg: 12.82031) QuantErr: 12.82031 batch_time=0.45362 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.30742 (QuantReg: 12.68256) QuantErr: 12.68256 batch_time=0.45897 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.36494 (QuantReg: 12.81033) QuantErr: 12.81033 batch_time=0.44316 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.60850 (QuantReg: 13.29075) QuantErr: 13.29075 batch_time=0.48903 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.51511 (QuantReg: 13.08109) QuantErr: 13.08109 batch_time=0.48568 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.53719 (QuantReg: 12.90720) QuantErr: 12.90720 batch_time=0.44709 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.55517 (QuantReg: 12.99070) QuantErr: 12.99070 batch_time=0.42680 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.68555 (QuantReg: 12.95966) QuantErr: 12.95966 batch_time=0.64546 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.38343 (QuantReg: 12.66758) QuantErr: 12.66758 batch_time=0.45303 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.56143 (QuantReg: 13.24298) QuantErr: 13.24298 batch_time=0.43542 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.23884 (QuantReg: 13.20177) QuantErr: 13.20177 batch_time=0.42688 
Train Epoch: 6 codebook_update_time=1.79833
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch6.pth ...
Done in 3.479s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch6.pth ...
Done in 6.561s
removing stale ckpt [epoch 5] [took 0.05s]
 epoch          : 6
 loss           : 2.4027933650016786
 quant_reg      : 12.886209732055663
 quant_err      : 12.886209732055663
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.988
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.29728681182554
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.4395
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.38584412028717
 mnt_best       : 38.29728681182554
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.16592 (QuantReg: 12.62819) QuantErr: 12.62819 batch_time=84.18184 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.05416 (QuantReg: 12.90144) QuantErr: 12.90144 batch_time=0.43387 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.25560 (QuantReg: 12.56347) QuantErr: 12.56347 batch_time=0.43040 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 1.94165 (QuantReg: 12.98841) QuantErr: 12.98841 batch_time=0.44273 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.48563 (QuantReg: 12.70301) QuantErr: 12.70301 batch_time=0.58714 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.37824 (QuantReg: 12.81924) QuantErr: 12.81924 batch_time=0.44848 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.36601 (QuantReg: 13.03596) QuantErr: 13.03596 batch_time=0.57990 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.21962 (QuantReg: 12.38657) QuantErr: 12.38657 batch_time=0.44142 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.25225 (QuantReg: 12.81373) QuantErr: 12.81373 batch_time=0.43485 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 1.84233 (QuantReg: 12.98865) QuantErr: 12.98865 batch_time=0.44355 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.20616 (QuantReg: 12.41255) QuantErr: 12.41255 batch_time=0.45771 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.26617 (QuantReg: 13.06769) QuantErr: 13.06769 batch_time=0.44259 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 1.95081 (QuantReg: 12.94253) QuantErr: 12.94253 batch_time=0.44964 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.44622 (QuantReg: 13.07264) QuantErr: 13.07264 batch_time=8.52896 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.02099 (QuantReg: 13.03953) QuantErr: 13.03953 batch_time=0.44036 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.44134 (QuantReg: 13.25335) QuantErr: 13.25335 batch_time=0.43570 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 2.13932 (QuantReg: 13.22448) QuantErr: 13.22448 batch_time=0.46242 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.22754 (QuantReg: 12.91456) QuantErr: 12.91456 batch_time=0.43656 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.99630 (QuantReg: 13.03073) QuantErr: 13.03073 batch_time=0.45058 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 1.97812 (QuantReg: 13.19166) QuantErr: 13.19166 batch_time=0.43987 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.20598 (QuantReg: 13.01411) QuantErr: 13.01411 batch_time=0.45060 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.02312 (QuantReg: 13.30625) QuantErr: 13.30625 batch_time=0.45556 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 1.99614 (QuantReg: 13.26652) QuantErr: 13.26652 batch_time=0.44827 
Train Epoch: 7 codebook_update_time=1.67517
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch7.pth ...
Done in 3.565s
removing stale ckpt [epoch 6] [took 0.07s]
 epoch          : 7
 loss           : 2.23469886302948
 quant_reg      : 12.928523677825927
 quant_err      : 12.928523677825927
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.981
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.7830481177112
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.574
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.53293924957601
 mnt_best       : 38.29728681182554
 not_improved_count: 1
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 1.97322 (QuantReg: 12.54423) QuantErr: 12.54423 batch_time=89.59256 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.12365 (QuantReg: 12.99260) QuantErr: 12.99260 batch_time=0.43913 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.20775 (QuantReg: 12.79500) QuantErr: 12.79500 batch_time=0.43907 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.46614 (QuantReg: 12.57037) QuantErr: 12.57037 batch_time=0.46191 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.35225 (QuantReg: 12.82824) QuantErr: 12.82824 batch_time=0.43725 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 1.97875 (QuantReg: 12.84196) QuantErr: 12.84196 batch_time=0.44469 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 1.99943 (QuantReg: 12.70513) QuantErr: 12.70513 batch_time=0.45368 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.24386 (QuantReg: 13.09268) QuantErr: 13.09268 batch_time=0.43352 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.05259 (QuantReg: 12.86337) QuantErr: 12.86337 batch_time=4.87491 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.11502 (QuantReg: 12.78467) QuantErr: 12.78467 batch_time=0.47188 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.08211 (QuantReg: 13.38374) QuantErr: 13.38374 batch_time=0.45916 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.12366 (QuantReg: 12.92587) QuantErr: 12.92587 batch_time=0.44605 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.33814 (QuantReg: 12.89537) QuantErr: 12.89537 batch_time=2.47133 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 1.93174 (QuantReg: 12.62057) QuantErr: 12.62057 batch_time=0.43900 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 1.82272 (QuantReg: 13.13223) QuantErr: 13.13223 batch_time=12.83480 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 2.83834 (QuantReg: 12.72254) QuantErr: 12.72254 batch_time=0.44061 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 1.90228 (QuantReg: 12.89152) QuantErr: 12.89152 batch_time=0.42839 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.09149 (QuantReg: 12.99404) QuantErr: 12.99404 batch_time=0.43001 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 1.95687 (QuantReg: 13.33707) QuantErr: 13.33707 batch_time=10.35071 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.07232 (QuantReg: 13.55067) QuantErr: 13.55067 batch_time=0.47648 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 1.74323 (QuantReg: 13.00340) QuantErr: 13.00340 batch_time=0.43661 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 2.10625 (QuantReg: 13.41444) QuantErr: 13.41444 batch_time=0.43895 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.12032 (QuantReg: 13.25613) QuantErr: 13.25613 batch_time=0.62335 
Train Epoch: 8 codebook_update_time=2.39138
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch8.pth ...
Done in 3.520s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch8.pth ...
Done in 7.540s
removing stale ckpt [epoch 7] [took 0.06s]
 epoch          : 8
 loss           : 2.107108958721161
 quant_reg      : 13.001321914672852
 quant_err      : 13.001321914672852
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.143
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.8509721235103
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.6525
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.220712204785784
 mnt_best       : 39.8509721235103
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 2.23154 (QuantReg: 12.60541) QuantErr: 12.60541 batch_time=86.78218 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 1.79352 (QuantReg: 12.86784) QuantErr: 12.86784 batch_time=0.45545 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.09251 (QuantReg: 12.84211) QuantErr: 12.84211 batch_time=0.47247 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 1.97290 (QuantReg: 13.12009) QuantErr: 13.12009 batch_time=0.44056 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.43343 (QuantReg: 13.01447) QuantErr: 13.01447 batch_time=0.47752 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 2.44902 (QuantReg: 13.05407) QuantErr: 13.05407 batch_time=0.47600 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 2.28192 (QuantReg: 13.17143) QuantErr: 13.17143 batch_time=0.58508 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.86442 (QuantReg: 12.78981) QuantErr: 12.78981 batch_time=0.43680 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.23612 (QuantReg: 13.30087) QuantErr: 13.30087 batch_time=0.44343 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.82393 (QuantReg: 13.12640) QuantErr: 13.12640 batch_time=0.44493 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 2.04196 (QuantReg: 13.34064) QuantErr: 13.34064 batch_time=0.44393 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 2.20685 (QuantReg: 12.88793) QuantErr: 12.88793 batch_time=0.44159 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 1.96776 (QuantReg: 13.18337) QuantErr: 13.18337 batch_time=3.51249 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.02457 (QuantReg: 13.08485) QuantErr: 13.08485 batch_time=1.41570 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 1.84212 (QuantReg: 13.31659) QuantErr: 13.31659 batch_time=0.44058 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 2.15487 (QuantReg: 13.20045) QuantErr: 13.20045 batch_time=0.43238 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 1.91726 (QuantReg: 13.07567) QuantErr: 13.07567 batch_time=0.47768 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.80391 (QuantReg: 13.21221) QuantErr: 13.21221 batch_time=0.47988 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 2.06918 (QuantReg: 12.88578) QuantErr: 12.88578 batch_time=0.44564 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.91613 (QuantReg: 13.21629) QuantErr: 13.21629 batch_time=1.35598 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 2.33626 (QuantReg: 13.29532) QuantErr: 13.29532 batch_time=0.43328 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 2.05479 (QuantReg: 13.17641) QuantErr: 13.17641 batch_time=0.42778 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 2.16629 (QuantReg: 13.39356) QuantErr: 13.39356 batch_time=0.45649 
Train Epoch: 9 codebook_update_time=1.94977
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch9.pth ...
Done in 4.100s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch9.pth ...
Done in 8.425s
removing stale ckpt [epoch 8] [took 0.15s]
 epoch          : 9
 loss           : 2.0368702211380003
 quant_reg      : 13.081559982299805
 quant_err      : 13.081559982299805
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.198
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.0922350704876
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.55
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.03415810811138
 mnt_best       : 40.0922350704876
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.96111 (QuantReg: 13.05071) QuantErr: 13.05071 batch_time=98.59954 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 2.00365 (QuantReg: 12.66052) QuantErr: 12.66052 batch_time=0.44136 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.27448 (QuantReg: 12.88852) QuantErr: 12.88852 batch_time=0.44857 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.10704 (QuantReg: 12.74637) QuantErr: 12.74637 batch_time=0.44960 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 2.50097 (QuantReg: 13.17722) QuantErr: 13.17722 batch_time=0.44090 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 1.86244 (QuantReg: 12.82664) QuantErr: 12.82664 batch_time=0.57130 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.03277 (QuantReg: 13.39884) QuantErr: 13.39884 batch_time=3.58557 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 2.00407 (QuantReg: 13.17100) QuantErr: 13.17100 batch_time=0.96693 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 2.41414 (QuantReg: 12.74925) QuantErr: 12.74925 batch_time=0.47621 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.05882 (QuantReg: 13.11037) QuantErr: 13.11037 batch_time=0.43975 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.75194 (QuantReg: 13.20733) QuantErr: 13.20733 batch_time=2.30468 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 1.90814 (QuantReg: 13.36723) QuantErr: 13.36723 batch_time=0.48645 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 1.73570 (QuantReg: 13.01211) QuantErr: 13.01211 batch_time=0.45201 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.97774 (QuantReg: 13.48272) QuantErr: 13.48272 batch_time=0.44437 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 2.28453 (QuantReg: 13.29398) QuantErr: 13.29398 batch_time=0.43046 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.07353 (QuantReg: 13.08390) QuantErr: 13.08390 batch_time=3.42834 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 1.71121 (QuantReg: 13.48364) QuantErr: 13.48364 batch_time=0.44078 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 2.26533 (QuantReg: 13.12336) QuantErr: 13.12336 batch_time=0.44312 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.75695 (QuantReg: 13.11042) QuantErr: 13.11042 batch_time=0.79264 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.81529 (QuantReg: 12.96039) QuantErr: 12.96039 batch_time=0.50421 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.95439 (QuantReg: 13.23109) QuantErr: 13.23109 batch_time=0.44845 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 1.93829 (QuantReg: 12.96974) QuantErr: 12.96974 batch_time=0.44845 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 2.11132 (QuantReg: 13.20676) QuantErr: 13.20676 batch_time=0.44638 
Train Epoch: 10 codebook_update_time=1.78586
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch10.pth ...
Done in 4.528s
removing stale ckpt [epoch 9] [took 0.06s]
 epoch          : 10
 loss           : 1.9260354146957397
 quant_reg      : 13.156722236633302
 quant_err      : 13.156722236633302
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.159
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.85882554837191
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.583
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.228154497205445
 mnt_best       : 40.0922350704876
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 2.02648 (QuantReg: 12.95067) QuantErr: 12.95067 batch_time=110.42600 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 1.93262 (QuantReg: 12.76720) QuantErr: 12.76720 batch_time=0.44458 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 1.94748 (QuantReg: 12.98788) QuantErr: 12.98788 batch_time=0.44090 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 2.52100 (QuantReg: 12.47749) QuantErr: 12.47749 batch_time=0.44289 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 1.86134 (QuantReg: 13.16830) QuantErr: 13.16830 batch_time=1.14464 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 1.76273 (QuantReg: 13.13801) QuantErr: 13.13801 batch_time=0.43470 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 2.33270 (QuantReg: 12.78330) QuantErr: 12.78330 batch_time=0.44152 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 2.32681 (QuantReg: 12.98940) QuantErr: 12.98940 batch_time=1.69335 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.74372 (QuantReg: 13.05216) QuantErr: 13.05216 batch_time=0.43634 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.93533 (QuantReg: 12.66710) QuantErr: 12.66710 batch_time=0.43324 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.53724 (QuantReg: 13.24086) QuantErr: 13.24086 batch_time=0.43813 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 2.04590 (QuantReg: 12.85056) QuantErr: 12.85056 batch_time=0.43138 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 1.96091 (QuantReg: 13.35076) QuantErr: 13.35076 batch_time=0.43407 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.62908 (QuantReg: 12.90143) QuantErr: 12.90143 batch_time=0.55549 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.66441 (QuantReg: 13.42794) QuantErr: 13.42794 batch_time=16.33332 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.13077 (QuantReg: 13.18686) QuantErr: 13.18686 batch_time=4.75166 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.44657 (QuantReg: 13.49065) QuantErr: 13.49065 batch_time=0.44511 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.91303 (QuantReg: 13.41787) QuantErr: 13.41787 batch_time=0.44160 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.59059 (QuantReg: 13.61304) QuantErr: 13.61304 batch_time=0.48049 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.38567 (QuantReg: 13.03335) QuantErr: 13.03335 batch_time=0.44461 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.62858 (QuantReg: 13.45970) QuantErr: 13.45970 batch_time=0.44170 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 2.29007 (QuantReg: 12.96759) QuantErr: 12.96759 batch_time=0.44667 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.62741 (QuantReg: 13.18515) QuantErr: 13.18515 batch_time=0.46997 
Train Epoch: 11 codebook_update_time=2.16484
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch11.pth ...
Done in 3.542s
removing stale ckpt [epoch 10] [took 1.22s]
 epoch          : 11
 loss           : 1.8745411729812622
 quant_reg      : 13.170095489501954
 quant_err      : 13.170095489501954
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.832
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.01783891814232
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.884
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.66409621120723
 mnt_best       : 40.0922350704876
 not_improved_count: 2
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.89502 (QuantReg: 13.28428) QuantErr: 13.28428 batch_time=113.11971 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 2.47558 (QuantReg: 12.89919) QuantErr: 12.89919 batch_time=0.44255 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 2.09122 (QuantReg: 13.28958) QuantErr: 13.28958 batch_time=0.47268 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 1.74207 (QuantReg: 13.37717) QuantErr: 13.37717 batch_time=0.44242 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.94121 (QuantReg: 12.68680) QuantErr: 12.68680 batch_time=0.44091 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.67895 (QuantReg: 13.19343) QuantErr: 13.19343 batch_time=0.43650 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.92704 (QuantReg: 13.12314) QuantErr: 13.12314 batch_time=0.57059 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.56727 (QuantReg: 13.31869) QuantErr: 13.31869 batch_time=0.46477 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.72422 (QuantReg: 13.15746) QuantErr: 13.15746 batch_time=0.44070 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.54431 (QuantReg: 13.25712) QuantErr: 13.25712 batch_time=0.43797 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.24462 (QuantReg: 13.12922) QuantErr: 13.12922 batch_time=2.90870 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.44675 (QuantReg: 13.21403) QuantErr: 13.21403 batch_time=0.45529 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.59735 (QuantReg: 13.51161) QuantErr: 13.51161 batch_time=3.19048 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 2.11030 (QuantReg: 13.22905) QuantErr: 13.22905 batch_time=0.44938 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.61503 (QuantReg: 13.42745) QuantErr: 13.42745 batch_time=0.43959 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.42622 (QuantReg: 13.04123) QuantErr: 13.04123 batch_time=0.44763 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.45997 (QuantReg: 13.19520) QuantErr: 13.19520 batch_time=1.59492 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.66669 (QuantReg: 13.34484) QuantErr: 13.34484 batch_time=0.45246 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.83374 (QuantReg: 13.32657) QuantErr: 13.32657 batch_time=0.43635 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.75166 (QuantReg: 13.49826) QuantErr: 13.49826 batch_time=0.42358 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.50953 (QuantReg: 13.69943) QuantErr: 13.69943 batch_time=0.44626 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.67541 (QuantReg: 13.77893) QuantErr: 13.77893 batch_time=0.44528 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.70391 (QuantReg: 12.95524) QuantErr: 12.95524 batch_time=0.44932 
Train Epoch: 12 codebook_update_time=2.23399
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch12.pth ...
Done in 3.488s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch12.pth ...
Done in 7.928s
removing stale ckpt [epoch 11] [took 0.08s]
 epoch          : 12
 loss           : 1.7521686344146727
 quant_reg      : 13.276629028320313
 quant_err      : 13.276629028320313
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.96
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.19312418640444
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.8245
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.33360525724163
 mnt_best       : 41.19312418640444
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.56211 (QuantReg: 13.43182) QuantErr: 13.43182 batch_time=110.80927 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.69798 (QuantReg: 13.11252) QuantErr: 13.11252 batch_time=0.43862 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 2.28497 (QuantReg: 12.97978) QuantErr: 12.97978 batch_time=0.44330 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.48225 (QuantReg: 13.26224) QuantErr: 13.26224 batch_time=1.40603 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.35522 (QuantReg: 13.45817) QuantErr: 13.45817 batch_time=0.44930 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 2.04500 (QuantReg: 12.92591) QuantErr: 12.92591 batch_time=0.47609 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.32356 (QuantReg: 13.03110) QuantErr: 13.03110 batch_time=0.43632 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.76514 (QuantReg: 13.35009) QuantErr: 13.35009 batch_time=8.33870 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.42194 (QuantReg: 13.34566) QuantErr: 13.34566 batch_time=0.44339 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.72091 (QuantReg: 13.55046) QuantErr: 13.55046 batch_time=0.44353 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.63311 (QuantReg: 13.30894) QuantErr: 13.30894 batch_time=0.47401 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.94092 (QuantReg: 13.40281) QuantErr: 13.40281 batch_time=0.43969 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.70263 (QuantReg: 13.20706) QuantErr: 13.20706 batch_time=10.83132 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.57885 (QuantReg: 13.43777) QuantErr: 13.43777 batch_time=0.44795 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.73887 (QuantReg: 13.36778) QuantErr: 13.36778 batch_time=0.42561 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.70637 (QuantReg: 13.02458) QuantErr: 13.02458 batch_time=0.43438 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.69436 (QuantReg: 13.28937) QuantErr: 13.28937 batch_time=0.46249 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.88674 (QuantReg: 13.39034) QuantErr: 13.39034 batch_time=0.47685 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.61235 (QuantReg: 13.34719) QuantErr: 13.34719 batch_time=2.03759 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.32458 (QuantReg: 13.48829) QuantErr: 13.48829 batch_time=0.43812 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 2.06276 (QuantReg: 13.46377) QuantErr: 13.46377 batch_time=0.56877 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.31449 (QuantReg: 13.53864) QuantErr: 13.53864 batch_time=0.44034 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.97021 (QuantReg: 13.11347) QuantErr: 13.11347 batch_time=0.42850 
Train Epoch: 13 codebook_update_time=1.62905
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch13.pth ...
Done in 3.634s
removing stale ckpt [epoch 12] [took 0.50s]
 epoch          : 13
 loss           : 1.6790368185043334
 quant_reg      : 13.317774440765382
 quant_err      : 13.317774440765382
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.644
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.52022888238353
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.24769921663741
 mnt_best       : 41.19312418640444
 not_improved_count: 1
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 2.12958 (QuantReg: 13.07537) QuantErr: 13.07537 batch_time=119.15509 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.70788 (QuantReg: 13.10187) QuantErr: 13.10187 batch_time=0.48479 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.35267 (QuantReg: 13.39375) QuantErr: 13.39375 batch_time=0.43706 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.41171 (QuantReg: 13.26925) QuantErr: 13.26925 batch_time=0.43436 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.30839 (QuantReg: 13.42309) QuantErr: 13.42309 batch_time=0.43930 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 2.11342 (QuantReg: 13.52961) QuantErr: 13.52961 batch_time=0.44520 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.53726 (QuantReg: 13.68709) QuantErr: 13.68709 batch_time=0.44017 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.68896 (QuantReg: 13.23769) QuantErr: 13.23769 batch_time=0.43002 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.91501 (QuantReg: 13.05706) QuantErr: 13.05706 batch_time=0.45478 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.60983 (QuantReg: 13.12934) QuantErr: 13.12934 batch_time=2.03053 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.68697 (QuantReg: 13.51930) QuantErr: 13.51930 batch_time=0.44341 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.87158 (QuantReg: 13.42497) QuantErr: 13.42497 batch_time=0.43062 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.52364 (QuantReg: 13.28316) QuantErr: 13.28316 batch_time=0.43780 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.63913 (QuantReg: 13.55263) QuantErr: 13.55263 batch_time=0.44411 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 2.01876 (QuantReg: 13.30379) QuantErr: 13.30379 batch_time=0.46687 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.52221 (QuantReg: 13.38348) QuantErr: 13.38348 batch_time=0.44431 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.73523 (QuantReg: 13.08975) QuantErr: 13.08975 batch_time=0.44769 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.52616 (QuantReg: 13.61855) QuantErr: 13.61855 batch_time=0.43375 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.43834 (QuantReg: 13.34445) QuantErr: 13.34445 batch_time=0.44356 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.68554 (QuantReg: 13.82454) QuantErr: 13.82454 batch_time=18.10450 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.78616 (QuantReg: 13.79523) QuantErr: 13.79523 batch_time=3.24713 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.63985 (QuantReg: 13.64888) QuantErr: 13.64888 batch_time=2.92203 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.89512 (QuantReg: 13.28416) QuantErr: 13.28416 batch_time=0.42698 
Train Epoch: 14 codebook_update_time=1.80387
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch14.pth ...
Done in 5.028s
removing stale ckpt [epoch 13] [took 0.10s]
 epoch          : 14
 loss           : 1.6350224380493164
 quant_reg      : 13.353197372436524
 quant_err      : 13.353197372436524
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.275
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.069148827570324
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.067
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.49647233768151
 mnt_best       : 41.19312418640444
 not_improved_count: 2
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.44404 (QuantReg: 13.25435) QuantErr: 13.25435 batch_time=140.87451 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.86023 (QuantReg: 13.04604) QuantErr: 13.04604 batch_time=0.43442 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.45953 (QuantReg: 13.58148) QuantErr: 13.58148 batch_time=0.44112 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.79754 (QuantReg: 12.98147) QuantErr: 12.98147 batch_time=0.43747 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.61217 (QuantReg: 13.16255) QuantErr: 13.16255 batch_time=0.46027 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.88623 (QuantReg: 13.57858) QuantErr: 13.57858 batch_time=0.43205 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.46066 (QuantReg: 13.39994) QuantErr: 13.39994 batch_time=0.46159 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 2.72201 (QuantReg: 13.29823) QuantErr: 13.29823 batch_time=0.43932 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.54184 (QuantReg: 13.62122) QuantErr: 13.62122 batch_time=0.43400 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.26423 (QuantReg: 13.67408) QuantErr: 13.67408 batch_time=0.43930 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.66288 (QuantReg: 13.34964) QuantErr: 13.34964 batch_time=0.46235 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.67857 (QuantReg: 13.37129) QuantErr: 13.37129 batch_time=0.43614 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.75138 (QuantReg: 13.38098) QuantErr: 13.38098 batch_time=0.56091 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.45733 (QuantReg: 13.39536) QuantErr: 13.39536 batch_time=2.29414 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.64360 (QuantReg: 13.32799) QuantErr: 13.32799 batch_time=4.74305 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.53816 (QuantReg: 13.06297) QuantErr: 13.06297 batch_time=0.53936 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.44743 (QuantReg: 13.62273) QuantErr: 13.62273 batch_time=0.44451 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.81941 (QuantReg: 13.68212) QuantErr: 13.68212 batch_time=0.55511 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.41115 (QuantReg: 13.45443) QuantErr: 13.45443 batch_time=0.44158 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.91476 (QuantReg: 13.32302) QuantErr: 13.32302 batch_time=0.43872 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.41102 (QuantReg: 13.93954) QuantErr: 13.93954 batch_time=0.88842 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.74241 (QuantReg: 13.62019) QuantErr: 13.62019 batch_time=0.44020 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 2.08287 (QuantReg: 13.46072) QuantErr: 13.46072 batch_time=0.46155 
Train Epoch: 15 codebook_update_time=2.17190
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch15.pth ...
Done in 3.459s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch15.pth ...
Done in 7.340s
removing stale ckpt [epoch 14] [took 0.08s]
 epoch          : 15
 loss           : 1.597935359954834
 quant_reg      : 13.39501524734497
 quant_err      : 13.39501524734497
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.341
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.5152119198467
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6275
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.60809156735046
 mnt_best       : 41.5152119198467
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.48301 (QuantReg: 13.30711) QuantErr: 13.30711 batch_time=103.11811 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.74695 (QuantReg: 13.14978) QuantErr: 13.14978 batch_time=0.46648 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.69030 (QuantReg: 13.45794) QuantErr: 13.45794 batch_time=12.92483 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 1.56154 (QuantReg: 13.44042) QuantErr: 13.44042 batch_time=0.43224 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.45425 (QuantReg: 13.44639) QuantErr: 13.44639 batch_time=0.45655 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.61571 (QuantReg: 13.55044) QuantErr: 13.55044 batch_time=0.43425 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.27591 (QuantReg: 13.56374) QuantErr: 13.56374 batch_time=0.43420 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.54671 (QuantReg: 13.68697) QuantErr: 13.68697 batch_time=0.42942 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.48423 (QuantReg: 13.51573) QuantErr: 13.51573 batch_time=0.44228 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.22341 (QuantReg: 13.52452) QuantErr: 13.52452 batch_time=0.42706 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.54884 (QuantReg: 13.85678) QuantErr: 13.85678 batch_time=2.33119 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.54156 (QuantReg: 13.36380) QuantErr: 13.36380 batch_time=0.43875 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.21507 (QuantReg: 13.39190) QuantErr: 13.39190 batch_time=0.43923 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.48385 (QuantReg: 13.74293) QuantErr: 13.74293 batch_time=11.17979 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.23407 (QuantReg: 13.55258) QuantErr: 13.55258 batch_time=0.44295 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.44422 (QuantReg: 13.80017) QuantErr: 13.80017 batch_time=0.43923 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.37468 (QuantReg: 13.28562) QuantErr: 13.28562 batch_time=0.44882 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.85835 (QuantReg: 13.31091) QuantErr: 13.31091 batch_time=0.44809 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.87489 (QuantReg: 13.65524) QuantErr: 13.65524 batch_time=0.45228 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.38535 (QuantReg: 13.67370) QuantErr: 13.67370 batch_time=0.43722 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.50098 (QuantReg: 13.49450) QuantErr: 13.49450 batch_time=0.43866 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.42197 (QuantReg: 13.73848) QuantErr: 13.73848 batch_time=0.48754 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.72403 (QuantReg: 13.43318) QuantErr: 13.43318 batch_time=0.44558 
Train Epoch: 16 codebook_update_time=1.74334
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch16.pth ...
Done in 4.339s
removing stale ckpt [epoch 15] [took 0.68s]
 epoch          : 16
 loss           : 1.5295302834510802
 quant_reg      : 13.462829563140868
 quant_err      : 13.462829563140868
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.758413508610914
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.392
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.92628907874235
 mnt_best       : 41.5152119198467
 not_improved_count: 1
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.81187 (QuantReg: 13.36652) QuantErr: 13.36652 batch_time=117.82736 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.34412 (QuantReg: 13.43064) QuantErr: 13.43064 batch_time=0.55354 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.49105 (QuantReg: 13.22178) QuantErr: 13.22178 batch_time=0.45217 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.63348 (QuantReg: 13.12214) QuantErr: 13.12214 batch_time=0.44810 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.78366 (QuantReg: 13.42763) QuantErr: 13.42763 batch_time=0.48927 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.29208 (QuantReg: 13.40472) QuantErr: 13.40472 batch_time=0.98558 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.77961 (QuantReg: 13.11513) QuantErr: 13.11513 batch_time=5.24663 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.49394 (QuantReg: 13.50937) QuantErr: 13.50937 batch_time=5.16540 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.73202 (QuantReg: 13.76847) QuantErr: 13.76847 batch_time=0.44010 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.43495 (QuantReg: 13.56549) QuantErr: 13.56549 batch_time=0.44678 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.79744 (QuantReg: 13.51089) QuantErr: 13.51089 batch_time=1.08067 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.28372 (QuantReg: 13.58085) QuantErr: 13.58085 batch_time=0.44765 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.63640 (QuantReg: 13.30398) QuantErr: 13.30398 batch_time=0.43513 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.57910 (QuantReg: 13.52230) QuantErr: 13.52230 batch_time=0.43852 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.46250 (QuantReg: 13.58669) QuantErr: 13.58669 batch_time=0.43477 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.58412 (QuantReg: 13.66227) QuantErr: 13.66227 batch_time=0.43756 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.31817 (QuantReg: 13.50098) QuantErr: 13.50098 batch_time=0.45109 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.46104 (QuantReg: 13.50351) QuantErr: 13.50351 batch_time=0.47535 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.45068 (QuantReg: 13.03153) QuantErr: 13.03153 batch_time=0.43716 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.90699 (QuantReg: 13.28501) QuantErr: 13.28501 batch_time=0.47155 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.31602 (QuantReg: 13.47063) QuantErr: 13.47063 batch_time=0.47026 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.56673 (QuantReg: 13.52872) QuantErr: 13.52872 batch_time=0.43603 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.46045 (QuantReg: 12.88967) QuantErr: 12.88967 batch_time=0.47658 
Train Epoch: 17 codebook_update_time=2.36828
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch17.pth ...
Done in 3.617s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch17.pth ...
Done in 8.000s
removing stale ckpt [epoch 16] [took 0.11s]
 epoch          : 17
 loss           : 1.5189161944389342
 quant_reg      : 13.507221950531006
 quant_err      : 13.507221950531006
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.9665
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.85735850931893
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.362
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.36072368543717
 mnt_best       : 41.85735850931893
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.23169 (QuantReg: 13.51557) QuantErr: 13.51557 batch_time=110.12832 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.55758 (QuantReg: 13.36204) QuantErr: 13.36204 batch_time=0.43775 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.77225 (QuantReg: 13.34982) QuantErr: 13.34982 batch_time=0.44939 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.50778 (QuantReg: 13.81217) QuantErr: 13.81217 batch_time=0.43355 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.36569 (QuantReg: 13.83469) QuantErr: 13.83469 batch_time=10.86379 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.34638 (QuantReg: 13.72297) QuantErr: 13.72297 batch_time=2.33527 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.47795 (QuantReg: 13.25615) QuantErr: 13.25615 batch_time=1.47385 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.16673 (QuantReg: 13.61593) QuantErr: 13.61593 batch_time=0.43393 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 0.99477 (QuantReg: 13.62276) QuantErr: 13.62276 batch_time=0.43479 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.50375 (QuantReg: 13.65992) QuantErr: 13.65992 batch_time=0.43171 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.54205 (QuantReg: 13.59214) QuantErr: 13.59214 batch_time=6.48855 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.60647 (QuantReg: 13.31359) QuantErr: 13.31359 batch_time=0.43301 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.30024 (QuantReg: 13.60429) QuantErr: 13.60429 batch_time=11.49131 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.88819 (QuantReg: 13.09666) QuantErr: 13.09666 batch_time=1.38277 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.13175 (QuantReg: 13.58156) QuantErr: 13.58156 batch_time=0.43284 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.50173 (QuantReg: 13.10859) QuantErr: 13.10859 batch_time=0.43681 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.78296 (QuantReg: 13.54596) QuantErr: 13.54596 batch_time=0.45595 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.66916 (QuantReg: 13.42741) QuantErr: 13.42741 batch_time=0.43296 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.60457 (QuantReg: 13.77151) QuantErr: 13.77151 batch_time=0.44148 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.44346 (QuantReg: 13.88443) QuantErr: 13.88443 batch_time=0.42983 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.46015 (QuantReg: 13.63837) QuantErr: 13.63837 batch_time=7.62703 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.42937 (QuantReg: 13.64794) QuantErr: 13.64794 batch_time=0.44339 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.22505 (QuantReg: 13.10571) QuantErr: 13.10571 batch_time=0.43131 
Train Epoch: 18 codebook_update_time=1.97879
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch18.pth ...
Done in 6.618s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch18.pth ...
Done in 10.337s
removing stale ckpt [epoch 17] [took 0.05s]
 epoch          : 18
 loss           : 1.4820967769622804
 quant_reg      : 13.528574920654297
 quant_err      : 13.528574920654297
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.252
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.063961124174654
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3885
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.575814480316325
 mnt_best       : 42.063961124174654
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.40087 (QuantReg: 13.81943) QuantErr: 13.81943 batch_time=104.43620 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.49818 (QuantReg: 13.31737) QuantErr: 13.31737 batch_time=0.43232 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.53572 (QuantReg: 13.15177) QuantErr: 13.15177 batch_time=0.42529 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.55907 (QuantReg: 13.28891) QuantErr: 13.28891 batch_time=0.43908 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.28968 (QuantReg: 13.21866) QuantErr: 13.21866 batch_time=0.43134 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.28371 (QuantReg: 13.41754) QuantErr: 13.41754 batch_time=1.27584 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.39547 (QuantReg: 13.47971) QuantErr: 13.47971 batch_time=1.37820 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.60106 (QuantReg: 13.49088) QuantErr: 13.49088 batch_time=0.43002 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.77194 (QuantReg: 13.86724) QuantErr: 13.86724 batch_time=0.43482 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.68067 (QuantReg: 13.37562) QuantErr: 13.37562 batch_time=0.44161 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.36962 (QuantReg: 13.63918) QuantErr: 13.63918 batch_time=0.44200 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.46880 (QuantReg: 13.60437) QuantErr: 13.60437 batch_time=0.47222 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.47663 (QuantReg: 13.49110) QuantErr: 13.49110 batch_time=0.43850 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.61868 (QuantReg: 13.64266) QuantErr: 13.64266 batch_time=0.43164 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.41527 (QuantReg: 13.66497) QuantErr: 13.66497 batch_time=0.43645 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.68356 (QuantReg: 13.60625) QuantErr: 13.60625 batch_time=0.46805 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.42408 (QuantReg: 13.75777) QuantErr: 13.75777 batch_time=0.43668 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.26540 (QuantReg: 13.35986) QuantErr: 13.35986 batch_time=0.43297 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.34799 (QuantReg: 13.71770) QuantErr: 13.71770 batch_time=0.43395 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.63028 (QuantReg: 13.08338) QuantErr: 13.08338 batch_time=0.47826 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.12514 (QuantReg: 13.78447) QuantErr: 13.78447 batch_time=0.44921 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.39463 (QuantReg: 13.52647) QuantErr: 13.52647 batch_time=0.44051 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.48069 (QuantReg: 13.74735) QuantErr: 13.74735 batch_time=0.46271 
Train Epoch: 19 codebook_update_time=2.27223
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch19.pth ...
Done in 3.655s
removing stale ckpt [epoch 18] [took 0.09s]
 epoch          : 19
 loss           : 1.4607271556854249
 quant_reg      : 13.50440510559082
 quant_err      : 13.50440510559082
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.106
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.05530997212323
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.8025
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.491795417368834
 mnt_best       : 42.063961124174654
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.31247 (QuantReg: 13.47331) QuantErr: 13.47331 batch_time=147.67910 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.41478 (QuantReg: 13.14741) QuantErr: 13.14741 batch_time=0.44469 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.48448 (QuantReg: 13.37097) QuantErr: 13.37097 batch_time=0.43300 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.04056 (QuantReg: 13.71799) QuantErr: 13.71799 batch_time=0.46797 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.37529 (QuantReg: 13.22463) QuantErr: 13.22463 batch_time=0.43781 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.54102 (QuantReg: 13.36837) QuantErr: 13.36837 batch_time=0.44154 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.53720 (QuantReg: 13.63339) QuantErr: 13.63339 batch_time=0.46663 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.28811 (QuantReg: 13.35151) QuantErr: 13.35151 batch_time=0.43657 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.07137 (QuantReg: 13.40651) QuantErr: 13.40651 batch_time=0.43837 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.23958 (QuantReg: 13.54242) QuantErr: 13.54242 batch_time=0.43931 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.57592 (QuantReg: 13.15357) QuantErr: 13.15357 batch_time=0.44451 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.19931 (QuantReg: 13.63078) QuantErr: 13.63078 batch_time=2.29567 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.14288 (QuantReg: 13.78052) QuantErr: 13.78052 batch_time=0.44046 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.52514 (QuantReg: 13.47794) QuantErr: 13.47794 batch_time=0.43728 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.26298 (QuantReg: 13.51894) QuantErr: 13.51894 batch_time=0.43512 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.29267 (QuantReg: 13.56141) QuantErr: 13.56141 batch_time=0.49557 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.54832 (QuantReg: 13.62254) QuantErr: 13.62254 batch_time=0.50039 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.84920 (QuantReg: 13.82788) QuantErr: 13.82788 batch_time=0.45229 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.41454 (QuantReg: 13.70759) QuantErr: 13.70759 batch_time=0.47274 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.50405 (QuantReg: 13.41098) QuantErr: 13.41098 batch_time=0.44204 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.19998 (QuantReg: 13.86517) QuantErr: 13.86517 batch_time=0.47442 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.24114 (QuantReg: 13.90866) QuantErr: 13.90866 batch_time=0.43534 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.17134 (QuantReg: 13.86671) QuantErr: 13.86671 batch_time=0.43438 
Train Epoch: 20 codebook_update_time=2.34224
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch20.pth ...
Done in 3.699s
removing stale ckpt [epoch 19] [took 0.16s]
 epoch          : 20
 loss           : 1.4194062678813935
 quant_reg      : 13.539730754852295
 quant_err      : 13.539730754852295
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.012
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.71649538040648
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.866
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.209993290803574
 mnt_best       : 42.063961124174654
 not_improved_count: 2
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.54312 (QuantReg: 13.48195) QuantErr: 13.48195 batch_time=101.22201 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.51929 (QuantReg: 13.35863) QuantErr: 13.35863 batch_time=0.48499 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.43112 (QuantReg: 13.70463) QuantErr: 13.70463 batch_time=0.44623 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.37503 (QuantReg: 13.41631) QuantErr: 13.41631 batch_time=0.43620 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.21878 (QuantReg: 13.30517) QuantErr: 13.30517 batch_time=2.67311 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.72797 (QuantReg: 13.58058) QuantErr: 13.58058 batch_time=0.43207 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.69465 (QuantReg: 13.28443) QuantErr: 13.28443 batch_time=0.44792 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.15668 (QuantReg: 13.84781) QuantErr: 13.84781 batch_time=0.45761 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.33636 (QuantReg: 13.63373) QuantErr: 13.63373 batch_time=0.45365 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.21672 (QuantReg: 13.55851) QuantErr: 13.55851 batch_time=0.43682 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.09988 (QuantReg: 13.63494) QuantErr: 13.63494 batch_time=0.44072 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.39558 (QuantReg: 14.02925) QuantErr: 14.02925 batch_time=0.44357 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.33971 (QuantReg: 13.29124) QuantErr: 13.29124 batch_time=0.44875 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.44105 (QuantReg: 13.76239) QuantErr: 13.76239 batch_time=0.48522 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.29798 (QuantReg: 13.68482) QuantErr: 13.68482 batch_time=0.44838 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.32867 (QuantReg: 13.18013) QuantErr: 13.18013 batch_time=0.44964 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.26529 (QuantReg: 13.31258) QuantErr: 13.31258 batch_time=0.48572 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.46112 (QuantReg: 13.94371) QuantErr: 13.94371 batch_time=0.44597 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.52571 (QuantReg: 13.83407) QuantErr: 13.83407 batch_time=0.54929 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.41282 (QuantReg: 13.70261) QuantErr: 13.70261 batch_time=0.47322 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.39554 (QuantReg: 13.90068) QuantErr: 13.90068 batch_time=0.77244 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.08915 (QuantReg: 13.73942) QuantErr: 13.73942 batch_time=0.43823 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.36375 (QuantReg: 13.94238) QuantErr: 13.94238 batch_time=0.45623 
Train Epoch: 21 codebook_update_time=1.94448
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch21.pth ...
Done in 3.439s
removing stale ckpt [epoch 20] [took 0.08s]
 epoch          : 21
 loss           : 1.3811928744316102
 quant_reg      : 13.57482060623169
 quant_err      : 13.57482060623169
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.023
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.673633764741915
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.5745
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.81554629290827
 mnt_best       : 42.063961124174654
 not_improved_count: 3
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.33814 (QuantReg: 13.50565) QuantErr: 13.50565 batch_time=99.88888 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.44289 (QuantReg: 13.44124) QuantErr: 13.44124 batch_time=0.50100 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.24662 (QuantReg: 13.62831) QuantErr: 13.62831 batch_time=0.44411 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.37405 (QuantReg: 13.83981) QuantErr: 13.83981 batch_time=0.43087 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.39998 (QuantReg: 13.63922) QuantErr: 13.63922 batch_time=1.88554 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.20257 (QuantReg: 13.99956) QuantErr: 13.99956 batch_time=0.46082 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.48033 (QuantReg: 13.44478) QuantErr: 13.44478 batch_time=1.00395 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.36703 (QuantReg: 13.55639) QuantErr: 13.55639 batch_time=0.44377 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.52500 (QuantReg: 13.45105) QuantErr: 13.45105 batch_time=0.44335 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.47405 (QuantReg: 13.57964) QuantErr: 13.57964 batch_time=0.44675 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.11564 (QuantReg: 13.46531) QuantErr: 13.46531 batch_time=0.43569 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.31804 (QuantReg: 13.88992) QuantErr: 13.88992 batch_time=0.44551 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.44710 (QuantReg: 13.41935) QuantErr: 13.41935 batch_time=0.44642 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.43340 (QuantReg: 13.76451) QuantErr: 13.76451 batch_time=0.43557 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.36396 (QuantReg: 13.59799) QuantErr: 13.59799 batch_time=0.44121 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.30483 (QuantReg: 13.65931) QuantErr: 13.65931 batch_time=8.81244 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.49241 (QuantReg: 13.45025) QuantErr: 13.45025 batch_time=0.43256 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.33749 (QuantReg: 13.72799) QuantErr: 13.72799 batch_time=0.43747 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.22709 (QuantReg: 13.74468) QuantErr: 13.74468 batch_time=2.20681 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.11278 (QuantReg: 13.85230) QuantErr: 13.85230 batch_time=0.43771 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.26068 (QuantReg: 13.69870) QuantErr: 13.69870 batch_time=0.43935 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.40109 (QuantReg: 13.55962) QuantErr: 13.55962 batch_time=12.27722 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.41187 (QuantReg: 13.53817) QuantErr: 13.53817 batch_time=0.45226 
Train Epoch: 22 codebook_update_time=1.67639
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch22.pth ...
Done in 3.523s
removing stale ckpt [epoch 21] [took 0.09s]
 epoch          : 22
 loss           : 1.386640349149704
 quant_reg      : 13.602411754608154
 quant_err      : 13.602411754608154
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.087
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.92980906521757
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.382
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.207886077470796
 mnt_best       : 42.063961124174654
 not_improved_count: 4
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.30031 (QuantReg: 13.77309) QuantErr: 13.77309 batch_time=105.18221 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.41255 (QuantReg: 13.41846) QuantErr: 13.41846 batch_time=0.44911 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.32133 (QuantReg: 13.51054) QuantErr: 13.51054 batch_time=0.45054 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.50263 (QuantReg: 13.95856) QuantErr: 13.95856 batch_time=0.42701 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.30745 (QuantReg: 13.82610) QuantErr: 13.82610 batch_time=0.43396 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.37776 (QuantReg: 13.36134) QuantErr: 13.36134 batch_time=0.43922 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.01920 (QuantReg: 13.81434) QuantErr: 13.81434 batch_time=0.43777 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.41386 (QuantReg: 13.63856) QuantErr: 13.63856 batch_time=0.43755 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.32202 (QuantReg: 13.49647) QuantErr: 13.49647 batch_time=0.44313 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.65479 (QuantReg: 13.37107) QuantErr: 13.37107 batch_time=0.45382 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.57442 (QuantReg: 13.76471) QuantErr: 13.76471 batch_time=0.44157 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.26392 (QuantReg: 13.91951) QuantErr: 13.91951 batch_time=0.43406 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.14171 (QuantReg: 13.35648) QuantErr: 13.35648 batch_time=0.44696 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.86439 (QuantReg: 13.71497) QuantErr: 13.71497 batch_time=0.43819 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.35060 (QuantReg: 13.59303) QuantErr: 13.59303 batch_time=0.43883 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.15225 (QuantReg: 13.73578) QuantErr: 13.73578 batch_time=0.47712 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.27013 (QuantReg: 13.76474) QuantErr: 13.76474 batch_time=0.44267 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.12708 (QuantReg: 13.50500) QuantErr: 13.50500 batch_time=0.43101 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.37386 (QuantReg: 13.52990) QuantErr: 13.52990 batch_time=0.43235 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.16037 (QuantReg: 13.65754) QuantErr: 13.65754 batch_time=0.44635 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.35482 (QuantReg: 13.81037) QuantErr: 13.81037 batch_time=0.43954 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.25916 (QuantReg: 13.78917) QuantErr: 13.78917 batch_time=11.55945 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.24391 (QuantReg: 13.87343) QuantErr: 13.87343 batch_time=0.43092 
Train Epoch: 23 codebook_update_time=1.72929
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch23.pth ...
Done in 3.832s
removing stale ckpt [epoch 22] [took 0.08s]
 epoch          : 23
 loss           : 1.3460437042713165
 quant_reg      : 13.652431842803955
 quant_err      : 13.652431842803955
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.557
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.40907562395026
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.358
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.41015918815754
 mnt_best       : 42.063961124174654
 not_improved_count: 5
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.26837 (QuantReg: 13.58768) QuantErr: 13.58768 batch_time=140.43331 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.13852 (QuantReg: 13.46172) QuantErr: 13.46172 batch_time=0.43649 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.30409 (QuantReg: 13.97386) QuantErr: 13.97386 batch_time=0.43358 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.56068 (QuantReg: 13.69961) QuantErr: 13.69961 batch_time=0.43146 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.39440 (QuantReg: 13.59112) QuantErr: 13.59112 batch_time=0.44906 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.19504 (QuantReg: 13.81440) QuantErr: 13.81440 batch_time=1.52394 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.06486 (QuantReg: 13.69895) QuantErr: 13.69895 batch_time=0.47345 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.78400 (QuantReg: 13.53567) QuantErr: 13.53567 batch_time=0.43227 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.25847 (QuantReg: 13.83472) QuantErr: 13.83472 batch_time=3.26786 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.44364 (QuantReg: 13.59284) QuantErr: 13.59284 batch_time=4.84827 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.32030 (QuantReg: 13.44299) QuantErr: 13.44299 batch_time=0.43483 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.29741 (QuantReg: 13.60237) QuantErr: 13.60237 batch_time=0.42903 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.47142 (QuantReg: 13.76920) QuantErr: 13.76920 batch_time=5.19409 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.66830 (QuantReg: 14.22118) QuantErr: 14.22118 batch_time=0.47959 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.24591 (QuantReg: 13.63715) QuantErr: 13.63715 batch_time=0.43718 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 0.86702 (QuantReg: 14.08884) QuantErr: 14.08884 batch_time=5.07354 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.28724 (QuantReg: 13.63702) QuantErr: 13.63702 batch_time=0.45136 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.30697 (QuantReg: 13.77484) QuantErr: 13.77484 batch_time=0.58199 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.42951 (QuantReg: 13.40080) QuantErr: 13.40080 batch_time=0.46875 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.24685 (QuantReg: 13.71307) QuantErr: 13.71307 batch_time=0.42587 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.51121 (QuantReg: 13.65645) QuantErr: 13.65645 batch_time=7.52594 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.21463 (QuantReg: 13.88698) QuantErr: 13.88698 batch_time=0.42969 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.24631 (QuantReg: 13.67327) QuantErr: 13.67327 batch_time=0.42597 
Train Epoch: 24 codebook_update_time=2.11865
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch24.pth ...
Done in 5.848s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch24.pth ...
Done in 11.849s
removing stale ckpt [epoch 23] [took 0.19s]
 epoch          : 24
 loss           : 1.3009980900287628
 quant_reg      : 13.677252883911132
 quant_err      : 13.677252883911132
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.47
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.337601367911404
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4265
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.01630456352362
 mnt_best       : 43.337601367911404
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.13922 (QuantReg: 13.73903) QuantErr: 13.73903 batch_time=183.46029 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.00753 (QuantReg: 13.84814) QuantErr: 13.84814 batch_time=7.08949 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.54128 (QuantReg: 13.25415) QuantErr: 13.25415 batch_time=23.80117 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.25026 (QuantReg: 13.98674) QuantErr: 13.98674 batch_time=0.43985 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.39354 (QuantReg: 13.34686) QuantErr: 13.34686 batch_time=0.42778 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.25808 (QuantReg: 13.51495) QuantErr: 13.51495 batch_time=0.55495 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.73913 (QuantReg: 13.78112) QuantErr: 13.78112 batch_time=0.44373 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.36815 (QuantReg: 13.52194) QuantErr: 13.52194 batch_time=0.44265 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.29125 (QuantReg: 13.57762) QuantErr: 13.57762 batch_time=0.44236 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.15618 (QuantReg: 13.63246) QuantErr: 13.63246 batch_time=9.63235 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.13855 (QuantReg: 13.75439) QuantErr: 13.75439 batch_time=0.45689 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.09683 (QuantReg: 13.51635) QuantErr: 13.51635 batch_time=0.81561 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.30851 (QuantReg: 13.71299) QuantErr: 13.71299 batch_time=0.44587 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.36649 (QuantReg: 13.67581) QuantErr: 13.67581 batch_time=0.45910 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.50940 (QuantReg: 13.43589) QuantErr: 13.43589 batch_time=0.48388 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.56172 (QuantReg: 13.63277) QuantErr: 13.63277 batch_time=0.43961 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.52345 (QuantReg: 13.80571) QuantErr: 13.80571 batch_time=0.42716 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.20095 (QuantReg: 13.77412) QuantErr: 13.77412 batch_time=0.43620 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 1.68927 (QuantReg: 13.44139) QuantErr: 13.44139 batch_time=0.67281 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.47299 (QuantReg: 14.15979) QuantErr: 14.15979 batch_time=0.43200 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.30972 (QuantReg: 13.60723) QuantErr: 13.60723 batch_time=0.45147 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.46068 (QuantReg: 14.10486) QuantErr: 14.10486 batch_time=0.43757 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.19045 (QuantReg: 13.76139) QuantErr: 13.76139 batch_time=0.45265 
Train Epoch: 25 codebook_update_time=2.34446
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch25.pth ...
Done in 3.686s
removing stale ckpt [epoch 24] [took 0.07s]
 epoch          : 25
 loss           : 1.3072503147125245
 quant_reg      : 13.716784797668456
 quant_err      : 13.716784797668456
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.519
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.79148300553637
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.008
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.527322949868115
 mnt_best       : 43.337601367911404
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.13431 (QuantReg: 13.73253) QuantErr: 13.73253 batch_time=82.00782 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.33636 (QuantReg: 13.85740) QuantErr: 13.85740 batch_time=0.42783 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.01412 (QuantReg: 13.89023) QuantErr: 13.89023 batch_time=0.43019 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.24797 (QuantReg: 13.43233) QuantErr: 13.43233 batch_time=0.43663 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.11917 (QuantReg: 13.73303) QuantErr: 13.73303 batch_time=0.73880 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.25542 (QuantReg: 13.44095) QuantErr: 13.44095 batch_time=0.44760 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.47688 (QuantReg: 13.28886) QuantErr: 13.28886 batch_time=0.44765 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.73006 (QuantReg: 13.67945) QuantErr: 13.67945 batch_time=0.44843 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.32780 (QuantReg: 13.55846) QuantErr: 13.55846 batch_time=0.45991 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.19022 (QuantReg: 13.62805) QuantErr: 13.62805 batch_time=0.43241 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.27346 (QuantReg: 13.91404) QuantErr: 13.91404 batch_time=0.42832 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.11676 (QuantReg: 13.54411) QuantErr: 13.54411 batch_time=0.44330 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.14342 (QuantReg: 13.70060) QuantErr: 13.70060 batch_time=5.19205 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.45198 (QuantReg: 13.72767) QuantErr: 13.72767 batch_time=0.43008 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.19743 (QuantReg: 13.68373) QuantErr: 13.68373 batch_time=0.43390 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.16726 (QuantReg: 13.71744) QuantErr: 13.71744 batch_time=0.43963 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.04089 (QuantReg: 14.04425) QuantErr: 14.04425 batch_time=0.45533 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.40207 (QuantReg: 13.90762) QuantErr: 13.90762 batch_time=0.43986 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.55897 (QuantReg: 13.70100) QuantErr: 13.70100 batch_time=0.43856 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.16956 (QuantReg: 13.67269) QuantErr: 13.67269 batch_time=3.31435 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.33400 (QuantReg: 13.95496) QuantErr: 13.95496 batch_time=0.45739 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.28265 (QuantReg: 13.67202) QuantErr: 13.67202 batch_time=0.44704 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.28721 (QuantReg: 13.78117) QuantErr: 13.78117 batch_time=0.44730 
Train Epoch: 26 codebook_update_time=1.62453
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch26.pth ...
Done in 3.191s
removing stale ckpt [epoch 25] [took 0.19s]
 epoch          : 26
 loss           : 1.29728551697731
 quant_reg      : 13.7729722366333
 quant_err      : 13.7729722366333
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.245
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.03109630961773
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.983
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.64150720428491
 mnt_best       : 43.337601367911404
 not_improved_count: 2
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.39235 (QuantReg: 13.48789) QuantErr: 13.48789 batch_time=93.60478 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.31100 (QuantReg: 13.69089) QuantErr: 13.69089 batch_time=0.43618 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.14384 (QuantReg: 13.63153) QuantErr: 13.63153 batch_time=0.43701 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.15641 (QuantReg: 13.97386) QuantErr: 13.97386 batch_time=0.44438 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.50286 (QuantReg: 13.34534) QuantErr: 13.34534 batch_time=0.49765 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.08179 (QuantReg: 13.76564) QuantErr: 13.76564 batch_time=0.47057 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.38558 (QuantReg: 13.54492) QuantErr: 13.54492 batch_time=0.46064 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.21666 (QuantReg: 13.57533) QuantErr: 13.57533 batch_time=0.43657 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.20736 (QuantReg: 13.57646) QuantErr: 13.57646 batch_time=0.43418 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.40070 (QuantReg: 13.75902) QuantErr: 13.75902 batch_time=0.46534 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.13381 (QuantReg: 13.85561) QuantErr: 13.85561 batch_time=0.56623 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.39379 (QuantReg: 13.68063) QuantErr: 13.68063 batch_time=0.45656 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.31179 (QuantReg: 13.42276) QuantErr: 13.42276 batch_time=0.45151 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.27441 (QuantReg: 13.60407) QuantErr: 13.60407 batch_time=0.45321 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.28092 (QuantReg: 14.02138) QuantErr: 14.02138 batch_time=0.45488 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.40800 (QuantReg: 13.96081) QuantErr: 13.96081 batch_time=0.86362 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.54321 (QuantReg: 13.81833) QuantErr: 13.81833 batch_time=0.47232 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.27203 (QuantReg: 13.67067) QuantErr: 13.67067 batch_time=0.44744 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.10544 (QuantReg: 13.96656) QuantErr: 13.96656 batch_time=0.48734 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.35579 (QuantReg: 13.51096) QuantErr: 13.51096 batch_time=0.45425 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.40365 (QuantReg: 13.66432) QuantErr: 13.66432 batch_time=1.66497 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.11159 (QuantReg: 14.03814) QuantErr: 14.03814 batch_time=0.48330 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.21531 (QuantReg: 13.75849) QuantErr: 13.75849 batch_time=0.56086 
Train Epoch: 27 codebook_update_time=2.42737
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch27.pth ...
Done in 3.349s
removing stale ckpt [epoch 26] [took 0.09s]
 epoch          : 27
 loss           : 1.3042694647312165
 quant_reg      : 13.747240169525146
 quant_err      : 13.747240169525146
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.351
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.07505047328035
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3415
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.972205057783306
 mnt_best       : 43.337601367911404
 not_improved_count: 3
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.56460 (QuantReg: 13.32640) QuantErr: 13.32640 batch_time=107.12760 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.01294 (QuantReg: 13.98794) QuantErr: 13.98794 batch_time=0.45033 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.15357 (QuantReg: 14.01003) QuantErr: 14.01003 batch_time=0.43636 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.02647 (QuantReg: 13.82492) QuantErr: 13.82492 batch_time=0.43574 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.16486 (QuantReg: 13.68419) QuantErr: 13.68419 batch_time=0.46679 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.36064 (QuantReg: 13.78811) QuantErr: 13.78811 batch_time=0.44181 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.29246 (QuantReg: 13.87464) QuantErr: 13.87464 batch_time=3.53165 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.39932 (QuantReg: 13.72961) QuantErr: 13.72961 batch_time=2.90891 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.15007 (QuantReg: 14.09375) QuantErr: 14.09375 batch_time=0.43643 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.02588 (QuantReg: 13.84321) QuantErr: 13.84321 batch_time=0.43148 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.19365 (QuantReg: 13.72249) QuantErr: 13.72249 batch_time=0.43926 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.45882 (QuantReg: 13.55459) QuantErr: 13.55459 batch_time=0.43267 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.16931 (QuantReg: 13.84160) QuantErr: 13.84160 batch_time=0.43411 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.26192 (QuantReg: 13.67116) QuantErr: 13.67116 batch_time=0.92079 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.10924 (QuantReg: 13.87954) QuantErr: 13.87954 batch_time=0.44917 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.24553 (QuantReg: 13.80250) QuantErr: 13.80250 batch_time=0.44158 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.14078 (QuantReg: 13.36127) QuantErr: 13.36127 batch_time=0.47506 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.22540 (QuantReg: 13.86373) QuantErr: 13.86373 batch_time=0.56942 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.18500 (QuantReg: 13.61952) QuantErr: 13.61952 batch_time=0.43728 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.61939 (QuantReg: 13.77625) QuantErr: 13.77625 batch_time=0.45336 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.52823 (QuantReg: 13.74450) QuantErr: 13.74450 batch_time=0.44922 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.26640 (QuantReg: 14.00798) QuantErr: 14.00798 batch_time=0.44370 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.14132 (QuantReg: 13.63696) QuantErr: 13.63696 batch_time=0.44297 
Train Epoch: 28 codebook_update_time=1.76095
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch28.pth ...
Done in 3.404s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch28.pth ...
Done in 6.885s
removing stale ckpt [epoch 27] [took 0.07s]
 epoch          : 28
 loss           : 1.286570330142975
 quant_reg      : 13.776124897003173
 quant_err      : 13.776124897003173
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.93
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.50133434934495
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4125
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.17095956134443
 mnt_best       : 43.50133434934495
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.50272 (QuantReg: 13.73050) QuantErr: 13.73050 batch_time=103.44920 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.18992 (QuantReg: 13.73563) QuantErr: 13.73563 batch_time=0.47613 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.20099 (QuantReg: 13.71402) QuantErr: 13.71402 batch_time=0.43427 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.52594 (QuantReg: 13.78943) QuantErr: 13.78943 batch_time=0.48450 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.25722 (QuantReg: 13.64120) QuantErr: 13.64120 batch_time=0.48006 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.22388 (QuantReg: 13.77812) QuantErr: 13.77812 batch_time=1.14223 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.22717 (QuantReg: 13.61857) QuantErr: 13.61857 batch_time=0.44380 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.29983 (QuantReg: 13.39764) QuantErr: 13.39764 batch_time=3.83278 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.55329 (QuantReg: 13.61420) QuantErr: 13.61420 batch_time=0.43400 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 0.98143 (QuantReg: 13.73681) QuantErr: 13.73681 batch_time=5.12587 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.17004 (QuantReg: 13.64480) QuantErr: 13.64480 batch_time=0.45870 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 0.97562 (QuantReg: 13.66195) QuantErr: 13.66195 batch_time=0.44302 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.57369 (QuantReg: 13.98625) QuantErr: 13.98625 batch_time=1.77799 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.21520 (QuantReg: 13.79025) QuantErr: 13.79025 batch_time=0.65666 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.56465 (QuantReg: 13.63556) QuantErr: 13.63556 batch_time=0.47735 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.49474 (QuantReg: 13.90456) QuantErr: 13.90456 batch_time=0.43947 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.18944 (QuantReg: 13.78585) QuantErr: 13.78585 batch_time=0.46032 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.28202 (QuantReg: 13.72388) QuantErr: 13.72388 batch_time=0.44070 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.02784 (QuantReg: 13.73534) QuantErr: 13.73534 batch_time=0.48691 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.42958 (QuantReg: 13.40316) QuantErr: 13.40316 batch_time=0.44388 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.07032 (QuantReg: 13.60518) QuantErr: 13.60518 batch_time=0.44239 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.20335 (QuantReg: 13.89269) QuantErr: 13.89269 batch_time=0.43989 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.52453 (QuantReg: 13.86217) QuantErr: 13.86217 batch_time=0.45554 
Train Epoch: 29 codebook_update_time=2.50824
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch29.pth ...
Done in 3.900s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch29.pth ...
Done in 7.150s
removing stale ckpt [epoch 28] [took 0.09s]
 epoch          : 29
 loss           : 1.2686547501087189
 quant_reg      : 13.792307605743408
 quant_err      : 13.792307605743408
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.368
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.81436946431532
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.823
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.93418923330591
 mnt_best       : 43.81436946431532
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.48768 (QuantReg: 13.53613) QuantErr: 13.53613 batch_time=102.29228 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.31436 (QuantReg: 13.54907) QuantErr: 13.54907 batch_time=0.43813 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.01876 (QuantReg: 13.85011) QuantErr: 13.85011 batch_time=0.44963 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.22158 (QuantReg: 13.70349) QuantErr: 13.70349 batch_time=0.45524 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.11160 (QuantReg: 13.85704) QuantErr: 13.85704 batch_time=0.43601 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 0.93127 (QuantReg: 13.81091) QuantErr: 13.81091 batch_time=0.56062 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.23655 (QuantReg: 13.79969) QuantErr: 13.79969 batch_time=0.46453 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.35449 (QuantReg: 13.67171) QuantErr: 13.67171 batch_time=0.44039 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.56154 (QuantReg: 13.56700) QuantErr: 13.56700 batch_time=0.44141 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.23502 (QuantReg: 14.07545) QuantErr: 14.07545 batch_time=0.44116 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.04537 (QuantReg: 13.90997) QuantErr: 13.90997 batch_time=0.44376 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.01136 (QuantReg: 14.07345) QuantErr: 14.07345 batch_time=0.45267 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.35575 (QuantReg: 13.65134) QuantErr: 13.65134 batch_time=1.92034 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.05038 (QuantReg: 14.04070) QuantErr: 14.04070 batch_time=0.44521 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.20942 (QuantReg: 13.73557) QuantErr: 13.73557 batch_time=0.43282 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.01210 (QuantReg: 13.96826) QuantErr: 13.96826 batch_time=0.43655 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.36791 (QuantReg: 13.63832) QuantErr: 13.63832 batch_time=0.43421 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.33684 (QuantReg: 13.98457) QuantErr: 13.98457 batch_time=0.45085 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.38686 (QuantReg: 13.78632) QuantErr: 13.78632 batch_time=9.29507 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.05760 (QuantReg: 14.04025) QuantErr: 14.04025 batch_time=0.44633 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.25167 (QuantReg: 13.84258) QuantErr: 13.84258 batch_time=0.43510 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.25253 (QuantReg: 13.98141) QuantErr: 13.98141 batch_time=0.48237 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.10436 (QuantReg: 13.77802) QuantErr: 13.77802 batch_time=0.44894 
Train Epoch: 30 codebook_update_time=1.78646
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch30.pth ...
Done in 3.451s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch30.pth ...
Done in 7.056s
removing stale ckpt [epoch 29] [took 0.15s]
 epoch          : 30
 loss           : 1.2472395050525664
 quant_reg      : 13.840642192840576
 quant_err      : 13.840642192840576
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.052
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.85747443324568
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.345
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.320529867202765
 mnt_best       : 43.85747443324568
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.14421 (QuantReg: 14.08925) QuantErr: 14.08925 batch_time=88.95320 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.30569 (QuantReg: 13.64510) QuantErr: 13.64510 batch_time=0.43369 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.23054 (QuantReg: 13.91619) QuantErr: 13.91619 batch_time=0.43300 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.33314 (QuantReg: 13.90628) QuantErr: 13.90628 batch_time=0.44767 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.11050 (QuantReg: 13.57070) QuantErr: 13.57070 batch_time=0.44388 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.14142 (QuantReg: 13.68259) QuantErr: 13.68259 batch_time=0.45430 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.12402 (QuantReg: 14.01281) QuantErr: 14.01281 batch_time=0.53788 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.07682 (QuantReg: 13.91079) QuantErr: 13.91079 batch_time=0.43453 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.42335 (QuantReg: 13.86994) QuantErr: 13.86994 batch_time=0.43204 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.53031 (QuantReg: 13.45455) QuantErr: 13.45455 batch_time=0.43535 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.26719 (QuantReg: 13.57738) QuantErr: 13.57738 batch_time=0.43459 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.29040 (QuantReg: 13.82007) QuantErr: 13.82007 batch_time=0.43571 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.39997 (QuantReg: 13.87696) QuantErr: 13.87696 batch_time=0.43379 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.09519 (QuantReg: 13.96596) QuantErr: 13.96596 batch_time=0.44358 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.28860 (QuantReg: 13.72573) QuantErr: 13.72573 batch_time=0.44441 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.33376 (QuantReg: 14.17560) QuantErr: 14.17560 batch_time=0.44709 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.35052 (QuantReg: 13.86190) QuantErr: 13.86190 batch_time=0.45024 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.25114 (QuantReg: 13.57691) QuantErr: 13.57691 batch_time=0.45377 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.31591 (QuantReg: 13.70292) QuantErr: 13.70292 batch_time=0.46607 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.19658 (QuantReg: 13.96359) QuantErr: 13.96359 batch_time=0.47498 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.55832 (QuantReg: 13.62293) QuantErr: 13.62293 batch_time=0.43736 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.28686 (QuantReg: 13.60847) QuantErr: 13.60847 batch_time=0.46173 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.14376 (QuantReg: 13.93077) QuantErr: 13.93077 batch_time=2.24276 
Train Epoch: 31 codebook_update_time=1.79357
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch31.pth ...
Done in 3.579s
removing stale ckpt [epoch 30] [took 0.10s]
 epoch          : 31
 loss           : 1.2489574887752533
 quant_reg      : 13.83008316040039
 quant_err      : 13.83008316040039
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.541
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.243068331246334
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.0555
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.94470904723502
 mnt_best       : 43.85747443324568
 not_improved_count: 1
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.23876 (QuantReg: 13.94088) QuantErr: 13.94088 batch_time=88.81247 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.54450 (QuantReg: 13.68101) QuantErr: 13.68101 batch_time=1.08741 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.31982 (QuantReg: 13.98576) QuantErr: 13.98576 batch_time=0.43198 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.59907 (QuantReg: 13.67939) QuantErr: 13.67939 batch_time=0.47761 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 1.11294 (QuantReg: 13.70615) QuantErr: 13.70615 batch_time=0.43468 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.29174 (QuantReg: 13.72247) QuantErr: 13.72247 batch_time=0.43385 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.05246 (QuantReg: 13.72779) QuantErr: 13.72779 batch_time=0.42874 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.53704 (QuantReg: 13.46929) QuantErr: 13.46929 batch_time=1.56841 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.30254 (QuantReg: 13.51345) QuantErr: 13.51345 batch_time=0.44854 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.45007 (QuantReg: 13.98555) QuantErr: 13.98555 batch_time=0.47052 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 0.88783 (QuantReg: 13.76155) QuantErr: 13.76155 batch_time=0.48406 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.53280 (QuantReg: 13.90390) QuantErr: 13.90390 batch_time=0.52161 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 0.84378 (QuantReg: 14.10776) QuantErr: 14.10776 batch_time=1.67882 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.11528 (QuantReg: 13.73382) QuantErr: 13.73382 batch_time=0.44428 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.59418 (QuantReg: 13.68141) QuantErr: 13.68141 batch_time=2.85814 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.20194 (QuantReg: 14.18864) QuantErr: 14.18864 batch_time=0.44108 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.37248 (QuantReg: 13.89304) QuantErr: 13.89304 batch_time=0.43556 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.41633 (QuantReg: 13.64891) QuantErr: 13.64891 batch_time=0.45932 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 0.94810 (QuantReg: 14.10784) QuantErr: 14.10784 batch_time=0.55464 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.05244 (QuantReg: 13.94599) QuantErr: 13.94599 batch_time=0.44438 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.21924 (QuantReg: 13.80526) QuantErr: 13.80526 batch_time=0.45883 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.29365 (QuantReg: 13.84496) QuantErr: 13.84496 batch_time=0.43066 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.25438 (QuantReg: 13.63115) QuantErr: 13.63115 batch_time=0.43324 
Train Epoch: 32 codebook_update_time=1.78213
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch32.pth ...
Done in 3.860s
removing stale ckpt [epoch 31] [took 0.11s]
 epoch          : 32
 loss           : 1.243194552898407
 quant_reg      : 13.835679386138915
 quant_err      : 13.835679386138915
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.545
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.46070490245536
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.76
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.03779466122688
 mnt_best       : 43.85747443324568
 not_improved_count: 2
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.06699 (QuantReg: 13.87396) QuantErr: 13.87396 batch_time=130.01407 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.14380 (QuantReg: 13.76987) QuantErr: 13.76987 batch_time=2.78501 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.56292 (QuantReg: 14.00150) QuantErr: 14.00150 batch_time=0.58400 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.25419 (QuantReg: 13.95114) QuantErr: 13.95114 batch_time=0.44390 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.17181 (QuantReg: 13.96341) QuantErr: 13.96341 batch_time=0.44391 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.35066 (QuantReg: 13.61785) QuantErr: 13.61785 batch_time=0.44547 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 1.37355 (QuantReg: 13.98310) QuantErr: 13.98310 batch_time=0.43907 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.55457 (QuantReg: 13.59202) QuantErr: 13.59202 batch_time=0.44086 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 0.90555 (QuantReg: 13.81139) QuantErr: 13.81139 batch_time=0.46577 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.40709 (QuantReg: 13.66660) QuantErr: 13.66660 batch_time=0.43488 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.50195 (QuantReg: 13.46168) QuantErr: 13.46168 batch_time=0.43606 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.68204 (QuantReg: 13.57443) QuantErr: 13.57443 batch_time=0.48600 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.26277 (QuantReg: 13.70466) QuantErr: 13.70466 batch_time=0.45917 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.21403 (QuantReg: 14.05071) QuantErr: 14.05071 batch_time=1.92272 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.13313 (QuantReg: 13.98643) QuantErr: 13.98643 batch_time=0.46552 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.24149 (QuantReg: 13.82899) QuantErr: 13.82899 batch_time=0.42728 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 1.16864 (QuantReg: 13.66576) QuantErr: 13.66576 batch_time=0.44488 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.23985 (QuantReg: 13.76763) QuantErr: 13.76763 batch_time=0.45159 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.50556 (QuantReg: 13.72548) QuantErr: 13.72548 batch_time=0.47189 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 0.97298 (QuantReg: 14.32243) QuantErr: 14.32243 batch_time=0.45434 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 1.18158 (QuantReg: 13.81761) QuantErr: 13.81761 batch_time=0.44420 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.17398 (QuantReg: 13.95128) QuantErr: 13.95128 batch_time=0.44600 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.27116 (QuantReg: 13.98239) QuantErr: 13.98239 batch_time=0.44401 
Train Epoch: 33 codebook_update_time=2.32445
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch33.pth ...
Done in 3.519s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch33.pth ...
Done in 7.117s
removing stale ckpt [epoch 32] [took 0.07s]
 epoch          : 33
 loss           : 1.2260142076015472
 quant_reg      : 13.876882568359376
 quant_err      : 13.876882568359376
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.295
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.26005857286916
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.9735
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.85643133239823
 mnt_best       : 44.26005857286916
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.51088 (QuantReg: 13.89021) QuantErr: 13.89021 batch_time=89.99814 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.22839 (QuantReg: 13.79848) QuantErr: 13.79848 batch_time=0.44374 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.23722 (QuantReg: 13.91919) QuantErr: 13.91919 batch_time=0.44198 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.32442 (QuantReg: 14.02840) QuantErr: 14.02840 batch_time=0.43954 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.25757 (QuantReg: 13.98280) QuantErr: 13.98280 batch_time=1.97346 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.16569 (QuantReg: 14.00189) QuantErr: 14.00189 batch_time=0.42543 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.54254 (QuantReg: 13.78570) QuantErr: 13.78570 batch_time=0.45756 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.40531 (QuantReg: 14.09116) QuantErr: 14.09116 batch_time=0.45529 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.17584 (QuantReg: 13.53008) QuantErr: 13.53008 batch_time=4.03327 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.07989 (QuantReg: 14.02217) QuantErr: 14.02217 batch_time=0.43739 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.39024 (QuantReg: 13.74420) QuantErr: 13.74420 batch_time=0.43504 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.24428 (QuantReg: 13.74380) QuantErr: 13.74380 batch_time=0.44914 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.34566 (QuantReg: 13.72332) QuantErr: 13.72332 batch_time=0.45999 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.32718 (QuantReg: 13.85460) QuantErr: 13.85460 batch_time=0.45152 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 0.91315 (QuantReg: 14.19050) QuantErr: 14.19050 batch_time=0.45142 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.08701 (QuantReg: 14.29240) QuantErr: 14.29240 batch_time=0.44555 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.28162 (QuantReg: 13.84571) QuantErr: 13.84571 batch_time=0.45178 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.28650 (QuantReg: 14.03624) QuantErr: 14.03624 batch_time=0.43948 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.17985 (QuantReg: 13.84740) QuantErr: 13.84740 batch_time=0.47846 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.49324 (QuantReg: 13.69086) QuantErr: 13.69086 batch_time=0.50897 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.34266 (QuantReg: 13.73575) QuantErr: 13.73575 batch_time=0.49392 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.37754 (QuantReg: 13.96679) QuantErr: 13.96679 batch_time=0.46805 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.15475 (QuantReg: 13.66569) QuantErr: 13.66569 batch_time=0.47366 
Train Epoch: 34 codebook_update_time=1.87817
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch34.pth ...
Done in 3.634s
removing stale ckpt [epoch 33] [took 0.09s]
 epoch          : 34
 loss           : 1.2121198830604554
 quant_reg      : 13.890768589019775
 quant_err      : 13.890768589019775
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.346
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.92651646336397
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.921
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.22388183752022
 mnt_best       : 44.26005857286916
 not_improved_count: 1
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.07841 (QuantReg: 13.59319) QuantErr: 13.59319 batch_time=83.11020 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.35936 (QuantReg: 14.07377) QuantErr: 14.07377 batch_time=0.44235 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.29166 (QuantReg: 14.06708) QuantErr: 14.06708 batch_time=0.44849 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.17568 (QuantReg: 14.07705) QuantErr: 14.07705 batch_time=0.98240 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.05171 (QuantReg: 13.86164) QuantErr: 13.86164 batch_time=0.45502 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.23975 (QuantReg: 14.07677) QuantErr: 14.07677 batch_time=0.45913 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.21434 (QuantReg: 14.11186) QuantErr: 14.11186 batch_time=0.44742 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.05166 (QuantReg: 14.11798) QuantErr: 14.11798 batch_time=0.47346 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.15923 (QuantReg: 13.92489) QuantErr: 13.92489 batch_time=0.43611 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.22699 (QuantReg: 13.70932) QuantErr: 13.70932 batch_time=0.43829 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.22307 (QuantReg: 13.88542) QuantErr: 13.88542 batch_time=0.44962 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.41605 (QuantReg: 14.13810) QuantErr: 14.13810 batch_time=0.56890 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.26279 (QuantReg: 13.82185) QuantErr: 13.82185 batch_time=1.93284 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.15718 (QuantReg: 13.81323) QuantErr: 13.81323 batch_time=0.43426 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.27387 (QuantReg: 14.11067) QuantErr: 14.11067 batch_time=0.66875 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 1.37224 (QuantReg: 13.73584) QuantErr: 13.73584 batch_time=0.44977 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.19738 (QuantReg: 14.19196) QuantErr: 14.19196 batch_time=0.44331 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.04665 (QuantReg: 14.12661) QuantErr: 14.12661 batch_time=0.44758 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.20125 (QuantReg: 13.72408) QuantErr: 13.72408 batch_time=0.44262 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.12654 (QuantReg: 14.14012) QuantErr: 14.14012 batch_time=0.45196 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.32063 (QuantReg: 14.00345) QuantErr: 14.00345 batch_time=0.45616 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.26298 (QuantReg: 13.98715) QuantErr: 13.98715 batch_time=0.43645 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.49714 (QuantReg: 14.03713) QuantErr: 14.03713 batch_time=0.44660 
Train Epoch: 35 codebook_update_time=1.93951
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch35.pth ...
Done in 3.469s
removing stale ckpt [epoch 34] [took 0.07s]
 epoch          : 35
 loss           : 1.193627795934677
 quant_reg      : 13.88026554107666
 quant_err      : 13.88026554107666
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.029
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.46102573313123
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3575
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.812087857759714
 mnt_best       : 44.26005857286916
 not_improved_count: 2
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.01172 (QuantReg: 13.93270) QuantErr: 13.93270 batch_time=82.49640 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.12729 (QuantReg: 13.87696) QuantErr: 13.87696 batch_time=0.43933 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 1.12319 (QuantReg: 13.55912) QuantErr: 13.55912 batch_time=0.47753 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.12653 (QuantReg: 14.24636) QuantErr: 14.24636 batch_time=0.48484 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.26042 (QuantReg: 13.53648) QuantErr: 13.53648 batch_time=0.49911 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.96166 (QuantReg: 13.88082) QuantErr: 13.88082 batch_time=0.43976 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.20936 (QuantReg: 13.77071) QuantErr: 13.77071 batch_time=0.63583 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.07299 (QuantReg: 13.94747) QuantErr: 13.94747 batch_time=7.07532 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.11430 (QuantReg: 14.01282) QuantErr: 14.01282 batch_time=0.45751 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.52889 (QuantReg: 13.65869) QuantErr: 13.65869 batch_time=0.43821 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.32301 (QuantReg: 13.43527) QuantErr: 13.43527 batch_time=0.46363 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 0.92779 (QuantReg: 14.09262) QuantErr: 14.09262 batch_time=0.45240 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 0.96037 (QuantReg: 13.61583) QuantErr: 13.61583 batch_time=1.53196 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.11342 (QuantReg: 13.84651) QuantErr: 13.84651 batch_time=0.48001 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.11013 (QuantReg: 13.98301) QuantErr: 13.98301 batch_time=0.45428 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 1.23742 (QuantReg: 14.00979) QuantErr: 14.00979 batch_time=0.46544 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.41032 (QuantReg: 14.08117) QuantErr: 14.08117 batch_time=0.45046 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.26885 (QuantReg: 14.17602) QuantErr: 14.17602 batch_time=0.45093 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.39520 (QuantReg: 13.59461) QuantErr: 13.59461 batch_time=1.38028 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.26112 (QuantReg: 14.25770) QuantErr: 14.25770 batch_time=0.44145 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 1.09765 (QuantReg: 14.01881) QuantErr: 14.01881 batch_time=0.47412 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.08092 (QuantReg: 14.09920) QuantErr: 14.09920 batch_time=0.44220 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 1.45390 (QuantReg: 13.90093) QuantErr: 13.90093 batch_time=0.45413 
Train Epoch: 36 codebook_update_time=2.03985
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch36.pth ...
Done in 3.409s
removing stale ckpt [epoch 35] [took 0.09s]
 epoch          : 36
 loss           : 1.1951839351654052
 quant_reg      : 13.928724262237548
 quant_err      : 13.928724262237548
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.51
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.93252536745236
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.955
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.53846732829429
 mnt_best       : 44.26005857286916
 not_improved_count: 3
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.21132 (QuantReg: 13.87274) QuantErr: 13.87274 batch_time=87.02875 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.17902 (QuantReg: 13.65717) QuantErr: 13.65717 batch_time=0.46495 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 1.12167 (QuantReg: 14.01388) QuantErr: 14.01388 batch_time=0.45321 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.11624 (QuantReg: 13.66543) QuantErr: 13.66543 batch_time=0.42940 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.45823 (QuantReg: 13.93326) QuantErr: 13.93326 batch_time=0.45399 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.13502 (QuantReg: 13.95939) QuantErr: 13.95939 batch_time=0.51893 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.02041 (QuantReg: 13.84628) QuantErr: 13.84628 batch_time=0.43634 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.06521 (QuantReg: 14.15066) QuantErr: 14.15066 batch_time=0.44476 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.18799 (QuantReg: 13.86048) QuantErr: 13.86048 batch_time=0.48012 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.16106 (QuantReg: 13.87683) QuantErr: 13.87683 batch_time=0.44366 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 0.90122 (QuantReg: 14.24414) QuantErr: 14.24414 batch_time=0.45384 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.95932 (QuantReg: 13.79022) QuantErr: 13.79022 batch_time=0.44254 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.02173 (QuantReg: 13.97246) QuantErr: 13.97246 batch_time=0.49191 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.09484 (QuantReg: 14.05296) QuantErr: 14.05296 batch_time=0.46668 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.90349 (QuantReg: 14.07455) QuantErr: 14.07455 batch_time=0.48158 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 1.19249 (QuantReg: 13.90456) QuantErr: 13.90456 batch_time=0.45458 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.26576 (QuantReg: 13.89413) QuantErr: 13.89413 batch_time=0.49146 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.82132 (QuantReg: 14.39495) QuantErr: 14.39495 batch_time=0.55998 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.25273 (QuantReg: 13.65976) QuantErr: 13.65976 batch_time=0.48928 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.21386 (QuantReg: 13.83890) QuantErr: 13.83890 batch_time=0.76518 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.32940 (QuantReg: 14.12423) QuantErr: 14.12423 batch_time=0.45033 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.16662 (QuantReg: 13.85080) QuantErr: 13.85080 batch_time=0.53919 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 0.99851 (QuantReg: 14.28136) QuantErr: 14.28136 batch_time=0.43800 
Train Epoch: 37 codebook_update_time=1.77628
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch37.pth ...
Done in 3.360s
removing stale ckpt [epoch 36] [took 0.07s]
 epoch          : 37
 loss           : 1.2013342292308808
 quant_reg      : 13.928343280792236
 quant_err      : 13.928343280792236
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.27
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.64989640836738
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4735
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.23618047103783
 mnt_best       : 44.26005857286916
 not_improved_count: 4
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 1.25927 (QuantReg: 13.71040) QuantErr: 13.71040 batch_time=62.68992 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 1.26242 (QuantReg: 13.77761) QuantErr: 13.77761 batch_time=0.50301 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 1.51487 (QuantReg: 13.73146) QuantErr: 13.73146 batch_time=0.46936 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.20796 (QuantReg: 13.81214) QuantErr: 13.81214 batch_time=0.43142 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.40776 (QuantReg: 13.78242) QuantErr: 13.78242 batch_time=0.46794 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 1.24827 (QuantReg: 14.03479) QuantErr: 14.03479 batch_time=0.43950 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.08651 (QuantReg: 13.26660) QuantErr: 13.26660 batch_time=2.10201 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.16157 (QuantReg: 13.97753) QuantErr: 13.97753 batch_time=0.55613 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.42166 (QuantReg: 13.97629) QuantErr: 13.97629 batch_time=0.45970 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.02533 (QuantReg: 13.76143) QuantErr: 13.76143 batch_time=0.45668 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.89235 (QuantReg: 14.36629) QuantErr: 14.36629 batch_time=0.44595 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.22382 (QuantReg: 14.02615) QuantErr: 14.02615 batch_time=0.42295 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.35655 (QuantReg: 13.65341) QuantErr: 13.65341 batch_time=0.47866 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.02878 (QuantReg: 13.85214) QuantErr: 13.85214 batch_time=0.44257 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.16303 (QuantReg: 13.85896) QuantErr: 13.85896 batch_time=0.45496 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 1.16804 (QuantReg: 14.06601) QuantErr: 14.06601 batch_time=0.45395 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.95838 (QuantReg: 14.07504) QuantErr: 14.07504 batch_time=3.54284 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.40435 (QuantReg: 13.82315) QuantErr: 13.82315 batch_time=0.43769 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.16579 (QuantReg: 13.86981) QuantErr: 13.86981 batch_time=0.58386 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.31966 (QuantReg: 13.85038) QuantErr: 13.85038 batch_time=1.22290 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.19170 (QuantReg: 14.01604) QuantErr: 14.01604 batch_time=0.48442 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.00240 (QuantReg: 13.92510) QuantErr: 13.92510 batch_time=0.57595 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.28757 (QuantReg: 13.85907) QuantErr: 13.85907 batch_time=0.60037 
Train Epoch: 38 codebook_update_time=1.94411
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch38.pth ...
Done in 3.333s
removing stale ckpt [epoch 37] [took 0.07s]
 epoch          : 38
 loss           : 1.1859417653083801
 quant_reg      : 13.941394702911378
 quant_err      : 13.941394702911378
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.587
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.1290505367374
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.305
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.456971179449006
 mnt_best       : 44.26005857286916
 not_improved_count: 5
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.84461 (QuantReg: 13.96409) QuantErr: 13.96409 batch_time=60.08210 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.11630 (QuantReg: 13.70381) QuantErr: 13.70381 batch_time=38.12407 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.60388 (QuantReg: 13.93459) QuantErr: 13.93459 batch_time=0.45240 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.20712 (QuantReg: 13.81415) QuantErr: 13.81415 batch_time=18.54310 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.38917 (QuantReg: 14.18166) QuantErr: 14.18166 batch_time=0.45155 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.66313 (QuantReg: 13.20328) QuantErr: 13.20328 batch_time=0.44464 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.25254 (QuantReg: 13.89692) QuantErr: 13.89692 batch_time=0.43488 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.12495 (QuantReg: 13.83066) QuantErr: 13.83066 batch_time=0.42551 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 0.95036 (QuantReg: 14.27079) QuantErr: 14.27079 batch_time=0.44798 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.24328 (QuantReg: 14.01491) QuantErr: 14.01491 batch_time=0.43511 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.25333 (QuantReg: 13.84970) QuantErr: 13.84970 batch_time=0.47570 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.96492 (QuantReg: 14.27196) QuantErr: 14.27196 batch_time=0.42637 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.22192 (QuantReg: 13.91916) QuantErr: 13.91916 batch_time=0.44566 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 0.84770 (QuantReg: 13.73106) QuantErr: 13.73106 batch_time=0.43352 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.17392 (QuantReg: 14.13000) QuantErr: 14.13000 batch_time=0.46639 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.21731 (QuantReg: 13.90300) QuantErr: 13.90300 batch_time=0.48444 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.43548 (QuantReg: 14.13387) QuantErr: 14.13387 batch_time=0.44208 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.28475 (QuantReg: 13.59701) QuantErr: 13.59701 batch_time=0.42773 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 1.26472 (QuantReg: 14.08348) QuantErr: 14.08348 batch_time=0.45691 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.09872 (QuantReg: 13.93821) QuantErr: 13.93821 batch_time=0.50760 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.15496 (QuantReg: 13.92599) QuantErr: 13.92599 batch_time=0.43793 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.29270 (QuantReg: 13.55567) QuantErr: 13.55567 batch_time=0.45701 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 1.23456 (QuantReg: 14.03401) QuantErr: 14.03401 batch_time=0.44420 
Train Epoch: 39 codebook_update_time=1.69506
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch39.pth ...
Done in 3.123s
removing stale ckpt [epoch 38] [took 0.07s]
 epoch          : 39
 loss           : 1.201378011226654
 quant_reg      : 13.958426162719727
 quant_err      : 13.958426162719727
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.58
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.15220566245037
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.457
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.83735883835195
 mnt_best       : 44.26005857286916
 not_improved_count: 6
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.34550 (QuantReg: 13.90451) QuantErr: 13.90451 batch_time=85.74825 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.08855 (QuantReg: 13.70199) QuantErr: 13.70199 batch_time=14.78339 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.15329 (QuantReg: 14.13696) QuantErr: 14.13696 batch_time=0.43377 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.31964 (QuantReg: 13.58707) QuantErr: 13.58707 batch_time=0.43218 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.19769 (QuantReg: 13.68053) QuantErr: 13.68053 batch_time=0.42976 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.05133 (QuantReg: 14.03461) QuantErr: 14.03461 batch_time=0.43918 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.25701 (QuantReg: 14.13584) QuantErr: 14.13584 batch_time=1.60709 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.06664 (QuantReg: 13.92482) QuantErr: 13.92482 batch_time=0.43135 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.20974 (QuantReg: 14.15117) QuantErr: 14.15117 batch_time=1.19777 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 1.08856 (QuantReg: 13.99798) QuantErr: 13.99798 batch_time=0.50183 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.36249 (QuantReg: 13.98503) QuantErr: 13.98503 batch_time=0.44635 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.14755 (QuantReg: 13.76380) QuantErr: 13.76380 batch_time=0.45137 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.34232 (QuantReg: 14.09080) QuantErr: 14.09080 batch_time=0.74083 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.00940 (QuantReg: 14.00700) QuantErr: 14.00700 batch_time=0.43909 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.43268 (QuantReg: 13.92495) QuantErr: 13.92495 batch_time=0.45010 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.01946 (QuantReg: 14.11020) QuantErr: 14.11020 batch_time=7.98243 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.10782 (QuantReg: 13.95902) QuantErr: 13.95902 batch_time=0.42805 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.11803 (QuantReg: 13.97293) QuantErr: 13.97293 batch_time=0.43733 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 0.99351 (QuantReg: 14.12723) QuantErr: 14.12723 batch_time=0.43170 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 0.96075 (QuantReg: 14.17501) QuantErr: 14.17501 batch_time=1.59110 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.13884 (QuantReg: 14.01675) QuantErr: 14.01675 batch_time=0.48323 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.98826 (QuantReg: 13.85171) QuantErr: 13.85171 batch_time=0.43371 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 1.11252 (QuantReg: 13.94368) QuantErr: 13.94368 batch_time=0.57412 
Train Epoch: 40 codebook_update_time=2.72630
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch40.pth ...
Done in 3.449s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch40.pth ...
Done in 6.561s
removing stale ckpt [epoch 39] [took 0.05s]
 epoch          : 40
 loss           : 1.1638065712451935
 quant_reg      : 13.980159481048585
 quant_err      : 13.980159481048585
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.691
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.75750248211413
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3995
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.12168396878501
 mnt_best       : 44.75750248211413
 not_improved_count: 0
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.97722 (QuantReg: 14.22089) QuantErr: 14.22089 batch_time=70.63439 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.39791 (QuantReg: 14.08419) QuantErr: 14.08419 batch_time=0.47879 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.36722 (QuantReg: 13.78723) QuantErr: 13.78723 batch_time=0.44958 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 0.99020 (QuantReg: 14.13340) QuantErr: 14.13340 batch_time=0.44670 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.14229 (QuantReg: 14.05523) QuantErr: 14.05523 batch_time=0.45480 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 1.19665 (QuantReg: 13.82963) QuantErr: 13.82963 batch_time=0.42682 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 1.07747 (QuantReg: 13.90218) QuantErr: 13.90218 batch_time=0.44959 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.30332 (QuantReg: 13.90157) QuantErr: 13.90157 batch_time=6.87598 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.45129 (QuantReg: 14.15505) QuantErr: 14.15505 batch_time=0.46768 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.10470 (QuantReg: 13.76359) QuantErr: 13.76359 batch_time=0.45904 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.25998 (QuantReg: 13.75789) QuantErr: 13.75789 batch_time=0.45673 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.14364 (QuantReg: 13.89184) QuantErr: 13.89184 batch_time=0.44771 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.17716 (QuantReg: 13.93802) QuantErr: 13.93802 batch_time=0.45883 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.03738 (QuantReg: 13.96870) QuantErr: 13.96870 batch_time=0.48467 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.29340 (QuantReg: 13.95223) QuantErr: 13.95223 batch_time=0.49262 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 0.87524 (QuantReg: 14.07903) QuantErr: 14.07903 batch_time=0.45410 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.34515 (QuantReg: 13.70046) QuantErr: 13.70046 batch_time=0.44296 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 1.27516 (QuantReg: 14.02318) QuantErr: 14.02318 batch_time=0.44903 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.18758 (QuantReg: 14.25561) QuantErr: 14.25561 batch_time=0.65782 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.25640 (QuantReg: 13.82729) QuantErr: 13.82729 batch_time=2.26723 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.02287 (QuantReg: 14.03377) QuantErr: 14.03377 batch_time=0.45234 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.07432 (QuantReg: 13.95318) QuantErr: 13.95318 batch_time=0.43843 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.35308 (QuantReg: 14.07640) QuantErr: 14.07640 batch_time=0.42812 
Train Epoch: 41 codebook_update_time=2.64287
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch41.pth ...
Done in 2.934s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch41.pth ...
Done in 5.869s
removing stale ckpt [epoch 40] [took 0.07s]
 epoch          : 41
 loss           : 1.1888238582611084
 quant_reg      : 14.003443656921387
 quant_err      : 14.003443656921387
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.3
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.83150735213102
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.6125
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.758728066926864
 mnt_best       : 44.83150735213102
 not_improved_count: 0
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.24470 (QuantReg: 13.70334) QuantErr: 13.70334 batch_time=42.23603 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.02859 (QuantReg: 14.06514) QuantErr: 14.06514 batch_time=0.44922 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.09134 (QuantReg: 13.83938) QuantErr: 13.83938 batch_time=0.44175 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 0.98759 (QuantReg: 13.70113) QuantErr: 13.70113 batch_time=0.46847 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.12298 (QuantReg: 13.98292) QuantErr: 13.98292 batch_time=0.45522 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.31025 (QuantReg: 14.03751) QuantErr: 14.03751 batch_time=0.43197 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.08132 (QuantReg: 13.74997) QuantErr: 13.74997 batch_time=0.45335 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.05902 (QuantReg: 14.37269) QuantErr: 14.37269 batch_time=0.46280 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 1.03074 (QuantReg: 14.33651) QuantErr: 14.33651 batch_time=0.43683 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.00952 (QuantReg: 14.00627) QuantErr: 14.00627 batch_time=0.44142 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.01836 (QuantReg: 13.89210) QuantErr: 13.89210 batch_time=0.45802 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 0.96791 (QuantReg: 14.04914) QuantErr: 14.04914 batch_time=0.44842 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.10210 (QuantReg: 14.03283) QuantErr: 14.03283 batch_time=0.49618 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 1.42796 (QuantReg: 14.12614) QuantErr: 14.12614 batch_time=4.85170 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.37694 (QuantReg: 13.89539) QuantErr: 13.89539 batch_time=0.48372 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.03421 (QuantReg: 14.02556) QuantErr: 14.02556 batch_time=0.45223 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.90145 (QuantReg: 13.90371) QuantErr: 13.90371 batch_time=0.45381 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 1.50960 (QuantReg: 13.89241) QuantErr: 13.89241 batch_time=0.55744 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 1.51016 (QuantReg: 14.06353) QuantErr: 14.06353 batch_time=0.45204 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.18265 (QuantReg: 13.95383) QuantErr: 13.95383 batch_time=0.45911 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.17722 (QuantReg: 14.00950) QuantErr: 14.00950 batch_time=0.43862 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 1.31081 (QuantReg: 14.09283) QuantErr: 14.09283 batch_time=0.43556 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.01648 (QuantReg: 14.10047) QuantErr: 14.10047 batch_time=0.76482 
Train Epoch: 42 codebook_update_time=1.80986
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch42.pth ...
Done in 6.373s
removing stale ckpt [epoch 41] [took 0.03s]
 epoch          : 42
 loss           : 1.1842931444644929
 quant_reg      : 14.011709335327149
 quant_err      : 14.011709335327149
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.066
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.63626455213158
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.05
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.280441244394304
 mnt_best       : 44.83150735213102
 not_improved_count: 1
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 1.23670 (QuantReg: 13.85436) QuantErr: 13.85436 batch_time=62.12235 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.93334 (QuantReg: 14.13600) QuantErr: 14.13600 batch_time=0.86268 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.38352 (QuantReg: 13.84031) QuantErr: 13.84031 batch_time=0.45758 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.23297 (QuantReg: 14.09078) QuantErr: 14.09078 batch_time=0.48292 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.00747 (QuantReg: 13.75567) QuantErr: 13.75567 batch_time=0.46837 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.18760 (QuantReg: 14.38813) QuantErr: 14.38813 batch_time=0.45301 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 0.98735 (QuantReg: 13.77885) QuantErr: 13.77885 batch_time=0.70358 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.22220 (QuantReg: 13.95417) QuantErr: 13.95417 batch_time=1.18973 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.05969 (QuantReg: 14.02610) QuantErr: 14.02610 batch_time=0.43881 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.14967 (QuantReg: 13.97296) QuantErr: 13.97296 batch_time=0.45289 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 0.87359 (QuantReg: 14.10497) QuantErr: 14.10497 batch_time=0.44091 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 1.13607 (QuantReg: 14.14730) QuantErr: 14.14730 batch_time=0.44292 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.43349 (QuantReg: 14.47089) QuantErr: 14.47089 batch_time=0.46336 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 1.30845 (QuantReg: 13.96577) QuantErr: 13.96577 batch_time=1.17422 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.06629 (QuantReg: 14.00453) QuantErr: 14.00453 batch_time=0.49715 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.20999 (QuantReg: 13.96715) QuantErr: 13.96715 batch_time=0.45528 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.19767 (QuantReg: 14.18132) QuantErr: 14.18132 batch_time=0.44315 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.40444 (QuantReg: 14.00314) QuantErr: 14.00314 batch_time=0.46007 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.27411 (QuantReg: 13.83225) QuantErr: 13.83225 batch_time=0.44946 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.02967 (QuantReg: 14.08970) QuantErr: 14.08970 batch_time=1.79578 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.36835 (QuantReg: 14.00071) QuantErr: 14.00071 batch_time=0.45030 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 1.32180 (QuantReg: 14.14867) QuantErr: 14.14867 batch_time=0.43301 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.31014 (QuantReg: 14.27971) QuantErr: 14.27971 batch_time=0.47395 
Train Epoch: 43 codebook_update_time=1.80070
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch43.pth ...
Done in 3.042s
removing stale ckpt [epoch 42] [took 0.04s]
 epoch          : 43
 loss           : 1.1856976487636566
 quant_reg      : 14.037728435516357
 quant_err      : 14.037728435516357
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.395
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.12593466656714
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4595
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.62995876797205
 mnt_best       : 44.83150735213102
 not_improved_count: 2
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 1.00268 (QuantReg: 13.98670) QuantErr: 13.98670 batch_time=56.19776 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.23073 (QuantReg: 14.03286) QuantErr: 14.03286 batch_time=0.48444 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.21857 (QuantReg: 14.15051) QuantErr: 14.15051 batch_time=0.48187 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.16786 (QuantReg: 13.77403) QuantErr: 13.77403 batch_time=0.44580 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.11168 (QuantReg: 14.03808) QuantErr: 14.03808 batch_time=0.43555 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.27156 (QuantReg: 13.85748) QuantErr: 13.85748 batch_time=0.44980 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.04926 (QuantReg: 13.94500) QuantErr: 13.94500 batch_time=0.46746 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 0.95466 (QuantReg: 14.12608) QuantErr: 14.12608 batch_time=0.48391 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 0.97474 (QuantReg: 14.30261) QuantErr: 14.30261 batch_time=0.45773 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.32958 (QuantReg: 13.74520) QuantErr: 13.74520 batch_time=0.46813 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.20609 (QuantReg: 13.93338) QuantErr: 13.93338 batch_time=0.48793 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.19247 (QuantReg: 14.27020) QuantErr: 14.27020 batch_time=0.50599 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.27592 (QuantReg: 14.06804) QuantErr: 14.06804 batch_time=0.43854 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.17430 (QuantReg: 14.20412) QuantErr: 14.20412 batch_time=0.45992 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.00210 (QuantReg: 14.11565) QuantErr: 14.11565 batch_time=0.47698 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.01039 (QuantReg: 14.10450) QuantErr: 14.10450 batch_time=0.46100 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.35569 (QuantReg: 13.96273) QuantErr: 13.96273 batch_time=0.45141 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.18881 (QuantReg: 14.02654) QuantErr: 14.02654 batch_time=0.44351 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.35156 (QuantReg: 13.77700) QuantErr: 13.77700 batch_time=0.46727 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 0.98581 (QuantReg: 14.10500) QuantErr: 14.10500 batch_time=0.50131 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.31699 (QuantReg: 13.88743) QuantErr: 13.88743 batch_time=0.46732 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.96216 (QuantReg: 14.24193) QuantErr: 14.24193 batch_time=0.45906 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.13267 (QuantReg: 13.98444) QuantErr: 13.98444 batch_time=0.50166 
Train Epoch: 44 codebook_update_time=1.66950
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch44.pth ...
Done in 4.291s
removing stale ckpt [epoch 43] [took 0.04s]
 epoch          : 44
 loss           : 1.179815063238144
 quant_reg      : 14.03927314376831
 quant_err      : 14.03927314376831
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.831
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.38312401414811
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.285
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.72645936563234
 mnt_best       : 44.83150735213102
 not_improved_count: 3
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 0.86968 (QuantReg: 14.16838) QuantErr: 14.16838 batch_time=56.65341 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.26125 (QuantReg: 14.01673) QuantErr: 14.01673 batch_time=0.43607 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 1.37062 (QuantReg: 13.77246) QuantErr: 13.77246 batch_time=0.44855 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.36109 (QuantReg: 14.05320) QuantErr: 14.05320 batch_time=0.43955 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.16080 (QuantReg: 14.12484) QuantErr: 14.12484 batch_time=0.43584 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.09837 (QuantReg: 14.10940) QuantErr: 14.10940 batch_time=0.47868 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 1.15301 (QuantReg: 13.75890) QuantErr: 13.75890 batch_time=0.45955 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.24743 (QuantReg: 13.99395) QuantErr: 13.99395 batch_time=0.44561 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.02390 (QuantReg: 14.11547) QuantErr: 14.11547 batch_time=0.48576 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 1.27873 (QuantReg: 13.95578) QuantErr: 13.95578 batch_time=0.43554 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 1.56857 (QuantReg: 13.88074) QuantErr: 13.88074 batch_time=0.79711 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.37526 (QuantReg: 14.13793) QuantErr: 14.13793 batch_time=0.44680 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.25607 (QuantReg: 14.04833) QuantErr: 14.04833 batch_time=0.45092 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.17244 (QuantReg: 14.04588) QuantErr: 14.04588 batch_time=0.44940 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.22218 (QuantReg: 14.35507) QuantErr: 14.35507 batch_time=0.43599 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.89560 (QuantReg: 13.96731) QuantErr: 13.96731 batch_time=0.49700 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.18828 (QuantReg: 14.12262) QuantErr: 14.12262 batch_time=0.44746 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.14141 (QuantReg: 13.96293) QuantErr: 13.96293 batch_time=0.45021 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.98923 (QuantReg: 13.88883) QuantErr: 13.88883 batch_time=0.42566 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 1.06673 (QuantReg: 14.03417) QuantErr: 14.03417 batch_time=0.49863 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.29032 (QuantReg: 13.89308) QuantErr: 13.89308 batch_time=0.45354 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 1.37260 (QuantReg: 13.84438) QuantErr: 13.84438 batch_time=0.44312 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.26011 (QuantReg: 14.17121) QuantErr: 14.17121 batch_time=0.47290 
Train Epoch: 45 codebook_update_time=2.15851
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch45.pth ...
Done in 3.026s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch45.pth ...
Done in 6.492s
removing stale ckpt [epoch 44] [took 0.07s]
 epoch          : 45
 loss           : 1.163376531124115
 quant_reg      : 14.052092853546142
 quant_err      : 14.052092853546142
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.015
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.940721947899476
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.264
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.59976959613961
 mnt_best       : 44.940721947899476
 not_improved_count: 0
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 1.34765 (QuantReg: 14.21483) QuantErr: 14.21483 batch_time=58.60269 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 0.94757 (QuantReg: 13.93381) QuantErr: 13.93381 batch_time=0.48406 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.09277 (QuantReg: 14.08869) QuantErr: 14.08869 batch_time=0.44350 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.11972 (QuantReg: 14.09972) QuantErr: 14.09972 batch_time=0.45778 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.05693 (QuantReg: 14.30238) QuantErr: 14.30238 batch_time=0.43889 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.30331 (QuantReg: 14.01304) QuantErr: 14.01304 batch_time=0.43671 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.04003 (QuantReg: 14.41948) QuantErr: 14.41948 batch_time=2.74028 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.25643 (QuantReg: 14.11277) QuantErr: 14.11277 batch_time=0.46082 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 1.34223 (QuantReg: 14.21725) QuantErr: 14.21725 batch_time=0.46996 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.98953 (QuantReg: 14.10601) QuantErr: 14.10601 batch_time=0.43887 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.10587 (QuantReg: 13.87144) QuantErr: 13.87144 batch_time=0.44410 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.27076 (QuantReg: 13.90787) QuantErr: 13.90787 batch_time=0.44951 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.34533 (QuantReg: 13.97253) QuantErr: 13.97253 batch_time=0.46161 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.17206 (QuantReg: 13.97782) QuantErr: 13.97782 batch_time=0.43853 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.19752 (QuantReg: 14.20839) QuantErr: 14.20839 batch_time=0.42961 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.17593 (QuantReg: 14.20241) QuantErr: 14.20241 batch_time=0.44623 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.20237 (QuantReg: 14.27868) QuantErr: 14.27868 batch_time=0.45130 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 0.92220 (QuantReg: 14.34547) QuantErr: 14.34547 batch_time=0.45632 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 1.08570 (QuantReg: 14.10778) QuantErr: 14.10778 batch_time=0.43916 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 1.11046 (QuantReg: 14.31984) QuantErr: 14.31984 batch_time=0.45484 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.04879 (QuantReg: 14.03526) QuantErr: 14.03526 batch_time=7.11084 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.04940 (QuantReg: 14.25102) QuantErr: 14.25102 batch_time=0.43319 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.29819 (QuantReg: 14.07253) QuantErr: 14.07253 batch_time=0.47814 
Train Epoch: 46 codebook_update_time=1.85424
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch46.pth ...
Done in 2.762s
removing stale ckpt [epoch 45] [took 0.05s]
 epoch          : 46
 loss           : 1.1661111123561858
 quant_reg      : 14.081720989227295
 quant_err      : 14.081720989227295
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.525
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.476261883831505
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.13
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.072000507978814
 mnt_best       : 44.940721947899476
 not_improved_count: 1
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.18227 (QuantReg: 13.92437) QuantErr: 13.92437 batch_time=59.05434 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.37579 (QuantReg: 14.08145) QuantErr: 14.08145 batch_time=3.71907 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.16346 (QuantReg: 14.33151) QuantErr: 14.33151 batch_time=7.68170 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.43947 (QuantReg: 14.06201) QuantErr: 14.06201 batch_time=0.43106 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.37200 (QuantReg: 14.12374) QuantErr: 14.12374 batch_time=0.44977 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 1.21764 (QuantReg: 14.16022) QuantErr: 14.16022 batch_time=0.48389 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.43720 (QuantReg: 13.98240) QuantErr: 13.98240 batch_time=0.46382 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.21546 (QuantReg: 13.88170) QuantErr: 13.88170 batch_time=0.43549 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.30183 (QuantReg: 13.96610) QuantErr: 13.96610 batch_time=0.45543 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 1.01046 (QuantReg: 14.26997) QuantErr: 14.26997 batch_time=0.44762 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 1.03863 (QuantReg: 14.17758) QuantErr: 14.17758 batch_time=0.47259 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 1.11628 (QuantReg: 13.99810) QuantErr: 13.99810 batch_time=0.60169 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.09155 (QuantReg: 14.17747) QuantErr: 14.17747 batch_time=0.46712 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.06833 (QuantReg: 14.34423) QuantErr: 14.34423 batch_time=0.49981 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 0.93171 (QuantReg: 14.01454) QuantErr: 14.01454 batch_time=0.45940 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.08435 (QuantReg: 14.06612) QuantErr: 14.06612 batch_time=0.46042 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 0.95707 (QuantReg: 14.13564) QuantErr: 14.13564 batch_time=0.45099 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.12926 (QuantReg: 14.23638) QuantErr: 14.23638 batch_time=0.44226 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.46356 (QuantReg: 14.14324) QuantErr: 14.14324 batch_time=0.45087 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.19850 (QuantReg: 13.94878) QuantErr: 13.94878 batch_time=3.50911 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 1.30602 (QuantReg: 14.12350) QuantErr: 14.12350 batch_time=0.42981 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 0.89742 (QuantReg: 14.05032) QuantErr: 14.05032 batch_time=1.44924 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.32345 (QuantReg: 14.01966) QuantErr: 14.01966 batch_time=0.46956 
Train Epoch: 47 codebook_update_time=2.16507
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch47.pth ...
Done in 19.911s
removing stale ckpt [epoch 46] [took 0.03s]
 epoch          : 47
 loss           : 1.171003619670868
 quant_reg      : 14.096740978240966
 quant_err      : 14.096740978240966
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.115
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.286420057133384
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5075
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.019096670889105
 mnt_best       : 44.940721947899476
 not_improved_count: 2
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 0.99471 (QuantReg: 14.21192) QuantErr: 14.21192 batch_time=55.01439 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.05691 (QuantReg: 13.96055) QuantErr: 13.96055 batch_time=0.43940 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.05651 (QuantReg: 14.25297) QuantErr: 14.25297 batch_time=0.45358 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.22141 (QuantReg: 13.97661) QuantErr: 13.97661 batch_time=0.47175 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.16137 (QuantReg: 14.16922) QuantErr: 14.16922 batch_time=0.45644 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.26907 (QuantReg: 13.77556) QuantErr: 13.77556 batch_time=0.44573 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.13109 (QuantReg: 14.23607) QuantErr: 14.23607 batch_time=0.44478 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.01513 (QuantReg: 14.07833) QuantErr: 14.07833 batch_time=1.38866 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.99423 (QuantReg: 14.23782) QuantErr: 14.23782 batch_time=0.44499 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.06861 (QuantReg: 13.96877) QuantErr: 13.96877 batch_time=0.44418 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.26735 (QuantReg: 13.82941) QuantErr: 13.82941 batch_time=0.45884 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.31801 (QuantReg: 14.21596) QuantErr: 14.21596 batch_time=0.43859 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.27372 (QuantReg: 14.02551) QuantErr: 14.02551 batch_time=1.24095 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.05678 (QuantReg: 13.93202) QuantErr: 13.93202 batch_time=1.47949 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.17827 (QuantReg: 14.00994) QuantErr: 14.00994 batch_time=0.46579 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.29559 (QuantReg: 14.07517) QuantErr: 14.07517 batch_time=0.45792 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 1.31136 (QuantReg: 14.11915) QuantErr: 14.11915 batch_time=0.44281 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.07710 (QuantReg: 14.05469) QuantErr: 14.05469 batch_time=0.45572 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.22352 (QuantReg: 14.19885) QuantErr: 14.19885 batch_time=0.45298 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.10195 (QuantReg: 14.06542) QuantErr: 14.06542 batch_time=1.54196 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.21564 (QuantReg: 14.03062) QuantErr: 14.03062 batch_time=0.44292 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.05439 (QuantReg: 14.04314) QuantErr: 14.04314 batch_time=0.44236 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.39174 (QuantReg: 14.34653) QuantErr: 14.34653 batch_time=0.56404 
Train Epoch: 48 codebook_update_time=1.88166
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch48.pth ...
Done in 2.951s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch48.pth ...
Done in 5.945s
removing stale ckpt [epoch 47] [took 0.04s]
 epoch          : 48
 loss           : 1.1751637127399444
 quant_reg      : 14.071397163391113
 quant_err      : 14.071397163391113
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.996
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.2497331567549
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.214
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.77652778695243
 mnt_best       : 45.2497331567549
 not_improved_count: 0
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.13636 (QuantReg: 14.10218) QuantErr: 14.10218 batch_time=52.70606 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 0.99328 (QuantReg: 14.35887) QuantErr: 14.35887 batch_time=0.44229 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.10711 (QuantReg: 14.01530) QuantErr: 14.01530 batch_time=0.43373 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.42901 (QuantReg: 13.80963) QuantErr: 13.80963 batch_time=0.45912 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 0.82504 (QuantReg: 14.22673) QuantErr: 14.22673 batch_time=1.15937 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.05785 (QuantReg: 13.96203) QuantErr: 13.96203 batch_time=0.50056 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.11300 (QuantReg: 14.20381) QuantErr: 14.20381 batch_time=0.49164 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 1.17582 (QuantReg: 14.17874) QuantErr: 14.17874 batch_time=0.44696 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 1.11696 (QuantReg: 14.29494) QuantErr: 14.29494 batch_time=0.44387 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.10066 (QuantReg: 13.99224) QuantErr: 13.99224 batch_time=0.43842 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.18607 (QuantReg: 14.36060) QuantErr: 14.36060 batch_time=0.44080 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.28680 (QuantReg: 13.85902) QuantErr: 13.85902 batch_time=0.45133 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 0.88409 (QuantReg: 14.17402) QuantErr: 14.17402 batch_time=3.20228 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.23858 (QuantReg: 14.32220) QuantErr: 14.32220 batch_time=0.43581 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.24212 (QuantReg: 14.10116) QuantErr: 14.10116 batch_time=0.44303 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 1.11568 (QuantReg: 13.90880) QuantErr: 13.90880 batch_time=0.44395 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 1.25009 (QuantReg: 13.84188) QuantErr: 13.84188 batch_time=0.44624 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.06648 (QuantReg: 14.09665) QuantErr: 14.09665 batch_time=0.43624 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.04676 (QuantReg: 14.05853) QuantErr: 14.05853 batch_time=0.44236 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.06924 (QuantReg: 14.33851) QuantErr: 14.33851 batch_time=0.45451 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.12886 (QuantReg: 14.13704) QuantErr: 14.13704 batch_time=9.57568 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 1.14117 (QuantReg: 14.16945) QuantErr: 14.16945 batch_time=0.42830 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.15482 (QuantReg: 14.13014) QuantErr: 14.13014 batch_time=0.52293 
Train Epoch: 49 codebook_update_time=2.24484
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch49.pth ...
Done in 3.160s
removing stale ckpt [epoch 48] [took 0.03s]
 epoch          : 49
 loss           : 1.1799944617748261
 quant_reg      : 14.103685153961182
 quant_err      : 14.103685153961182
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.127
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.9370366651598
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.35713906436
 mnt_best       : 45.2497331567549
 not_improved_count: 1
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.23535 (QuantReg: 14.23970) QuantErr: 14.23970 batch_time=63.07951 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.17284 (QuantReg: 13.92853) QuantErr: 13.92853 batch_time=0.44345 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.35156 (QuantReg: 14.01880) QuantErr: 14.01880 batch_time=0.68708 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.10227 (QuantReg: 14.30725) QuantErr: 14.30725 batch_time=0.43764 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.08847 (QuantReg: 14.39354) QuantErr: 14.39354 batch_time=0.44505 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.98157 (QuantReg: 14.07737) QuantErr: 14.07737 batch_time=0.45004 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.08874 (QuantReg: 14.07704) QuantErr: 14.07704 batch_time=0.47435 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 1.06806 (QuantReg: 14.17896) QuantErr: 14.17896 batch_time=4.89143 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 1.28871 (QuantReg: 14.28627) QuantErr: 14.28627 batch_time=0.44500 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.22585 (QuantReg: 14.17253) QuantErr: 14.17253 batch_time=0.60950 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.05816 (QuantReg: 14.44844) QuantErr: 14.44844 batch_time=0.43258 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 1.14398 (QuantReg: 14.01296) QuantErr: 14.01296 batch_time=0.67372 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.26310 (QuantReg: 14.29214) QuantErr: 14.29214 batch_time=0.46373 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.40404 (QuantReg: 13.94974) QuantErr: 13.94974 batch_time=0.43699 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.45999 (QuantReg: 14.25447) QuantErr: 14.25447 batch_time=0.45519 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 1.10159 (QuantReg: 14.07010) QuantErr: 14.07010 batch_time=0.43616 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.20493 (QuantReg: 14.07921) QuantErr: 14.07921 batch_time=0.47826 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.17693 (QuantReg: 14.10702) QuantErr: 14.10702 batch_time=0.57276 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.08025 (QuantReg: 13.98759) QuantErr: 13.98759 batch_time=0.47706 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.94421 (QuantReg: 14.27342) QuantErr: 14.27342 batch_time=0.43104 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.16905 (QuantReg: 14.06956) QuantErr: 14.06956 batch_time=0.55549 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 0.94982 (QuantReg: 14.26086) QuantErr: 14.26086 batch_time=0.45482 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.25276 (QuantReg: 13.90020) QuantErr: 13.90020 batch_time=0.42688 
Train Epoch: 50 codebook_update_time=1.84345
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/checkpoint-epoch50.pth ...
Done in 3.418s
removing stale ckpt [epoch 49] [took 0.04s]
 epoch          : 50
 loss           : 1.1900885548591613
 quant_reg      : 14.137461860656739
 quant_err      : 14.137461860656739
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.486
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.73431594598773
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3025
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.37544467186225
 mnt_best       : 45.2497331567549
 not_improved_count: 2
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/trained_model.pth ...
Ckpt loaded at epoch 48.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 25.4
 t2v_metrics/R5/final_eval: 54.2
 t2v_metrics/R10/final_eval: 67.3
 t2v_metrics/R50/final_eval: 89.8
 t2v_metrics/MedR/final_eval: 4.0
 t2v_metrics/MeanR/final_eval: 26.996
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 45.2497331567549
 v2t_metrics/R1/final_eval: 26.3
 v2t_metrics/R5/final_eval: 56.4
 v2t_metrics/R10/final_eval: 69.0
 v2t_metrics/R50/final_eval: 90.1
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 24.215
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 46.77652778695243
Best epoch for the monitored metric: 48
Script took 07h13m36s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_distilbert-base/trained_model.pth
