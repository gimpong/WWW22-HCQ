Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64
Preparing the dataloaders ...
Loading dataset LSMDC_full_trainval in ram ...
Finish loading dataset LSMDC_full_trainval in ram, taking 3087.160908460617 s.
Loading dataset LSMDC_full_test in ram ...
Finish loading dataset LSMDC_full_test in ram, taking 19.45853304862976 s.
Loading dataset LSMDC_full_test in ram ...
Finish loading dataset LSMDC_full_test in ram, taking 10.756231546401978 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch0.pth ...
Done in 1.675s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch0.pth ...
Done in 3.257s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 LSMDC_full_test/t2v_metrics/R1: 0.0
 LSMDC_full_test/t2v_metrics/R5: 0.9
 LSMDC_full_test/t2v_metrics/R10: 1.6
 LSMDC_full_test/t2v_metrics/R50: 4.4
 LSMDC_full_test/t2v_metrics/MedR: 508.5
 LSMDC_full_test/t2v_metrics/MeanR: 502.992
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 LSMDC_full_test/v2t_metrics/R1: 0.0
 LSMDC_full_test/v2t_metrics/R5: 0.3
 LSMDC_full_test/v2t_metrics/R10: 0.9
 LSMDC_full_test/v2t_metrics/R50: 5.1
 LSMDC_full_test/v2t_metrics/MedR: 510.0
 LSMDC_full_test/v2t_metrics/MeanR: 501.125
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/500 64/32000 (0%)] Loss: 8.44165 (QuantReg: 22.50947) QuantErr: 22.50947 batch_time=12.98663 
Train Epoch: 1 [9/500 576/32000 (2%)] Loss: 8.20676 (QuantReg: 22.62667) QuantErr: 22.62667 batch_time=0.38895 
Train Epoch: 1 [17/500 1088/32000 (3%)] Loss: 7.62019 (QuantReg: 22.73830) QuantErr: 22.73830 batch_time=0.37754 
Train Epoch: 1 [25/500 1600/32000 (5%)] Loss: 7.39123 (QuantReg: 22.74451) QuantErr: 22.74451 batch_time=0.37845 
Train Epoch: 1 [33/500 2112/32000 (7%)] Loss: 7.25283 (QuantReg: 22.80846) QuantErr: 22.80846 batch_time=0.38515 
Train Epoch: 1 [41/500 2624/32000 (8%)] Loss: 7.09326 (QuantReg: 22.74810) QuantErr: 22.74810 batch_time=0.39784 
Train Epoch: 1 [49/500 3136/32000 (10%)] Loss: 6.89218 (QuantReg: 22.75388) QuantErr: 22.75388 batch_time=0.38274 
Train Epoch: 1 [57/500 3648/32000 (11%)] Loss: 6.44056 (QuantReg: 22.69258) QuantErr: 22.69258 batch_time=0.38798 
Train Epoch: 1 [65/500 4160/32000 (13%)] Loss: 6.12982 (QuantReg: 22.66244) QuantErr: 22.66244 batch_time=0.37172 
Train Epoch: 1 [73/500 4672/32000 (15%)] Loss: 6.31279 (QuantReg: 22.69883) QuantErr: 22.69883 batch_time=0.37914 
Train Epoch: 1 [81/500 5184/32000 (16%)] Loss: 6.20292 (QuantReg: 22.60716) QuantErr: 22.60716 batch_time=0.37456 
Train Epoch: 1 [89/500 5696/32000 (18%)] Loss: 6.27498 (QuantReg: 22.56045) QuantErr: 22.56045 batch_time=0.37592 
Train Epoch: 1 [97/500 6208/32000 (19%)] Loss: 5.71157 (QuantReg: 22.58169) QuantErr: 22.58169 batch_time=0.38910 
Train Epoch: 1 [105/500 6720/32000 (21%)] Loss: 5.79159 (QuantReg: 22.65405) QuantErr: 22.65405 batch_time=0.38287 
Train Epoch: 1 [113/500 7232/32000 (23%)] Loss: 6.15480 (QuantReg: 22.66993) QuantErr: 22.66993 batch_time=0.39308 
Train Epoch: 1 [121/500 7744/32000 (24%)] Loss: 5.95173 (QuantReg: 22.60763) QuantErr: 22.60763 batch_time=0.37966 
Train Epoch: 1 [129/500 8256/32000 (26%)] Loss: 6.21756 (QuantReg: 22.67778) QuantErr: 22.67778 batch_time=0.38670 
Train Epoch: 1 [137/500 8768/32000 (27%)] Loss: 5.81478 (QuantReg: 22.65037) QuantErr: 22.65037 batch_time=0.38367 
Train Epoch: 1 [145/500 9280/32000 (29%)] Loss: 5.86161 (QuantReg: 22.75913) QuantErr: 22.75913 batch_time=0.40225 
Train Epoch: 1 [153/500 9792/32000 (31%)] Loss: 5.61510 (QuantReg: 22.69739) QuantErr: 22.69739 batch_time=0.38794 
Train Epoch: 1 [161/500 10304/32000 (32%)] Loss: 6.06199 (QuantReg: 22.66879) QuantErr: 22.66879 batch_time=0.37993 
Train Epoch: 1 [169/500 10816/32000 (34%)] Loss: 5.61904 (QuantReg: 22.62724) QuantErr: 22.62724 batch_time=0.37938 
Train Epoch: 1 [177/500 11328/32000 (35%)] Loss: 5.69487 (QuantReg: 22.65900) QuantErr: 22.65900 batch_time=0.39234 
Train Epoch: 1 [185/500 11840/32000 (37%)] Loss: 4.96939 (QuantReg: 22.63683) QuantErr: 22.63683 batch_time=0.37292 
Train Epoch: 1 [193/500 12352/32000 (39%)] Loss: 6.35525 (QuantReg: 22.62387) QuantErr: 22.62387 batch_time=0.38962 
Train Epoch: 1 [201/500 12864/32000 (40%)] Loss: 5.55493 (QuantReg: 22.65476) QuantErr: 22.65476 batch_time=0.38385 
Train Epoch: 1 [209/500 13376/32000 (42%)] Loss: 5.12692 (QuantReg: 22.66371) QuantErr: 22.66371 batch_time=0.46066 
Train Epoch: 1 [217/500 13888/32000 (43%)] Loss: 5.19941 (QuantReg: 22.71828) QuantErr: 22.71828 batch_time=0.37493 
Train Epoch: 1 [225/500 14400/32000 (45%)] Loss: 5.50906 (QuantReg: 22.67798) QuantErr: 22.67798 batch_time=0.37720 
Train Epoch: 1 [233/500 14912/32000 (47%)] Loss: 5.44521 (QuantReg: 22.66254) QuantErr: 22.66254 batch_time=0.38787 
Train Epoch: 1 [241/500 15424/32000 (48%)] Loss: 5.76886 (QuantReg: 22.61583) QuantErr: 22.61583 batch_time=0.41573 
Train Epoch: 1 [249/500 15936/32000 (50%)] Loss: 5.42791 (QuantReg: 22.68328) QuantErr: 22.68328 batch_time=0.37598 
Train Epoch: 1 [257/500 16448/32000 (51%)] Loss: 4.86579 (QuantReg: 22.64003) QuantErr: 22.64003 batch_time=0.38785 
Train Epoch: 1 [265/500 16960/32000 (53%)] Loss: 5.92108 (QuantReg: 22.61544) QuantErr: 22.61544 batch_time=0.40049 
Train Epoch: 1 [273/500 17472/32000 (55%)] Loss: 5.22811 (QuantReg: 22.63377) QuantErr: 22.63377 batch_time=0.38187 
Train Epoch: 1 [281/500 17984/32000 (56%)] Loss: 4.63919 (QuantReg: 22.65635) QuantErr: 22.65635 batch_time=0.39779 
Train Epoch: 1 [289/500 18496/32000 (58%)] Loss: 5.36051 (QuantReg: 22.64388) QuantErr: 22.64388 batch_time=0.41842 
Train Epoch: 1 [297/500 19008/32000 (59%)] Loss: 4.91429 (QuantReg: 22.68454) QuantErr: 22.68454 batch_time=0.38593 
Train Epoch: 1 [305/500 19520/32000 (61%)] Loss: 4.89189 (QuantReg: 22.67703) QuantErr: 22.67703 batch_time=0.38176 
Train Epoch: 1 [313/500 20032/32000 (63%)] Loss: 5.14822 (QuantReg: 22.64847) QuantErr: 22.64847 batch_time=0.38324 
Train Epoch: 1 [321/500 20544/32000 (64%)] Loss: 6.01792 (QuantReg: 22.68771) QuantErr: 22.68771 batch_time=0.38321 
Train Epoch: 1 [329/500 21056/32000 (66%)] Loss: 6.03536 (QuantReg: 22.67432) QuantErr: 22.67432 batch_time=0.37767 
Train Epoch: 1 [337/500 21568/32000 (67%)] Loss: 4.76916 (QuantReg: 22.65973) QuantErr: 22.65973 batch_time=0.37777 
Train Epoch: 1 [345/500 22080/32000 (69%)] Loss: 5.20057 (QuantReg: 22.66705) QuantErr: 22.66705 batch_time=0.43030 
Train Epoch: 1 [353/500 22592/32000 (71%)] Loss: 5.14702 (QuantReg: 22.66449) QuantErr: 22.66449 batch_time=0.37683 
Train Epoch: 1 [361/500 23104/32000 (72%)] Loss: 5.22906 (QuantReg: 22.64000) QuantErr: 22.64000 batch_time=0.37619 
Train Epoch: 1 [369/500 23616/32000 (74%)] Loss: 5.04652 (QuantReg: 22.65682) QuantErr: 22.65682 batch_time=0.39081 
Train Epoch: 1 [377/500 24128/32000 (75%)] Loss: 5.19343 (QuantReg: 22.60259) QuantErr: 22.60259 batch_time=0.39055 
Train Epoch: 1 [385/500 24640/32000 (77%)] Loss: 4.91237 (QuantReg: 22.64886) QuantErr: 22.64886 batch_time=0.38657 
Train Epoch: 1 [393/500 25152/32000 (79%)] Loss: 5.28052 (QuantReg: 22.63194) QuantErr: 22.63194 batch_time=0.38517 
Train Epoch: 1 [401/500 25664/32000 (80%)] Loss: 6.04171 (QuantReg: 22.66848) QuantErr: 22.66848 batch_time=0.37881 
Train Epoch: 1 [409/500 26176/32000 (82%)] Loss: 5.58681 (QuantReg: 22.68281) QuantErr: 22.68281 batch_time=0.37921 
Train Epoch: 1 [417/500 26688/32000 (83%)] Loss: 5.23568 (QuantReg: 22.67274) QuantErr: 22.67274 batch_time=0.37591 
Train Epoch: 1 [425/500 27200/32000 (85%)] Loss: 4.58258 (QuantReg: 22.67097) QuantErr: 22.67097 batch_time=0.37469 
Train Epoch: 1 [433/500 27712/32000 (87%)] Loss: 4.63340 (QuantReg: 22.65975) QuantErr: 22.65975 batch_time=0.39446 
Train Epoch: 1 [441/500 28224/32000 (88%)] Loss: 4.65582 (QuantReg: 22.68214) QuantErr: 22.68214 batch_time=0.38880 
Train Epoch: 1 [449/500 28736/32000 (90%)] Loss: 5.08207 (QuantReg: 22.73081) QuantErr: 22.73081 batch_time=0.37746 
Train Epoch: 1 [457/500 29248/32000 (91%)] Loss: 4.27120 (QuantReg: 22.68086) QuantErr: 22.68086 batch_time=0.38244 
Train Epoch: 1 [465/500 29760/32000 (93%)] Loss: 4.52333 (QuantReg: 22.67488) QuantErr: 22.67488 batch_time=0.38314 
Train Epoch: 1 [473/500 30272/32000 (95%)] Loss: 4.83395 (QuantReg: 22.66306) QuantErr: 22.66306 batch_time=0.38156 
Train Epoch: 1 [481/500 30784/32000 (96%)] Loss: 4.95660 (QuantReg: 22.68820) QuantErr: 22.68820 batch_time=0.37674 
Train Epoch: 1 [489/500 31296/32000 (98%)] Loss: 4.74720 (QuantReg: 22.62788) QuantErr: 22.62788 batch_time=0.37950 
Train Epoch: 1 [497/500 31808/32000 (99%)] Loss: 4.39916 (QuantReg: 22.66929) QuantErr: 22.66929 batch_time=0.37834 
Train Epoch: 1 codebook_update_time=2.07439
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch1.pth ...
Done in 6.171s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch1.pth ...
Done in 10.888s
 epoch          : 1
 loss           : 5.592851211547852
 quant_reg      : 22.666592037200928
 quant_err      : 22.666592037200928
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 500
 LSMDC_full_test/t2v_metrics/R1: 8.6
 LSMDC_full_test/t2v_metrics/R5: 20.2
 LSMDC_full_test/t2v_metrics/R10: 27.4
 LSMDC_full_test/t2v_metrics/R50: 54.8
 LSMDC_full_test/t2v_metrics/MedR: 41.0
 LSMDC_full_test/t2v_metrics/MeanR: 99.5585
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 16.821580354874413
 LSMDC_full_test/v2t_metrics/R1: 5.7
 LSMDC_full_test/v2t_metrics/R5: 18.2
 LSMDC_full_test/v2t_metrics/R10: 28.0
 LSMDC_full_test/v2t_metrics/R50: 54.3
 LSMDC_full_test/v2t_metrics/MedR: 40.5
 LSMDC_full_test/v2t_metrics/MeanR: 102.006
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 14.268163971692331
 mnt_best       : 16.821580354874413
 not_improved_count: 0
Train Epoch: 2 [1/500 64/32000 (0%)] Loss: 4.24962 (QuantReg: 10.11530) QuantErr: 10.11530 batch_time=14.98356 
Train Epoch: 2 [9/500 576/32000 (2%)] Loss: 5.08653 (QuantReg: 10.50157) QuantErr: 10.50157 batch_time=0.36932 
Train Epoch: 2 [17/500 1088/32000 (3%)] Loss: 4.67615 (QuantReg: 9.66247) QuantErr: 9.66247 batch_time=0.37507 
Train Epoch: 2 [25/500 1600/32000 (5%)] Loss: 4.35106 (QuantReg: 10.02313) QuantErr: 10.02313 batch_time=0.37612 
Train Epoch: 2 [33/500 2112/32000 (7%)] Loss: 4.70480 (QuantReg: 10.72236) QuantErr: 10.72236 batch_time=0.39217 
Train Epoch: 2 [41/500 2624/32000 (8%)] Loss: 4.70261 (QuantReg: 10.09592) QuantErr: 10.09592 batch_time=0.38402 
Train Epoch: 2 [49/500 3136/32000 (10%)] Loss: 5.23123 (QuantReg: 10.81060) QuantErr: 10.81060 batch_time=0.39304 
Train Epoch: 2 [57/500 3648/32000 (11%)] Loss: 4.73212 (QuantReg: 10.85358) QuantErr: 10.85358 batch_time=0.37714 
Train Epoch: 2 [65/500 4160/32000 (13%)] Loss: 4.38981 (QuantReg: 11.24250) QuantErr: 11.24250 batch_time=1.20837 
Train Epoch: 2 [73/500 4672/32000 (15%)] Loss: 5.05870 (QuantReg: 10.62589) QuantErr: 10.62589 batch_time=0.38131 
Train Epoch: 2 [81/500 5184/32000 (16%)] Loss: 4.44232 (QuantReg: 10.65629) QuantErr: 10.65629 batch_time=0.37735 
Train Epoch: 2 [89/500 5696/32000 (18%)] Loss: 4.82091 (QuantReg: 10.37156) QuantErr: 10.37156 batch_time=0.38266 
Train Epoch: 2 [97/500 6208/32000 (19%)] Loss: 5.06347 (QuantReg: 10.66783) QuantErr: 10.66783 batch_time=0.38773 
Train Epoch: 2 [105/500 6720/32000 (21%)] Loss: 4.17132 (QuantReg: 10.95510) QuantErr: 10.95510 batch_time=0.38108 
Train Epoch: 2 [113/500 7232/32000 (23%)] Loss: 4.18221 (QuantReg: 11.49443) QuantErr: 11.49443 batch_time=0.38267 
Train Epoch: 2 [121/500 7744/32000 (24%)] Loss: 4.68749 (QuantReg: 10.98561) QuantErr: 10.98561 batch_time=0.38935 
Train Epoch: 2 [129/500 8256/32000 (26%)] Loss: 4.05427 (QuantReg: 11.33889) QuantErr: 11.33889 batch_time=1.28082 
Train Epoch: 2 [137/500 8768/32000 (27%)] Loss: 4.39064 (QuantReg: 11.49560) QuantErr: 11.49560 batch_time=0.38043 
Train Epoch: 2 [145/500 9280/32000 (29%)] Loss: 5.21038 (QuantReg: 10.49278) QuantErr: 10.49278 batch_time=0.38066 
Train Epoch: 2 [153/500 9792/32000 (31%)] Loss: 4.58053 (QuantReg: 11.12833) QuantErr: 11.12833 batch_time=0.38000 
Train Epoch: 2 [161/500 10304/32000 (32%)] Loss: 4.44577 (QuantReg: 11.34924) QuantErr: 11.34924 batch_time=0.37910 
Train Epoch: 2 [169/500 10816/32000 (34%)] Loss: 4.63486 (QuantReg: 11.71057) QuantErr: 11.71057 batch_time=0.38440 
Train Epoch: 2 [177/500 11328/32000 (35%)] Loss: 4.66093 (QuantReg: 11.13743) QuantErr: 11.13743 batch_time=0.39372 
Train Epoch: 2 [185/500 11840/32000 (37%)] Loss: 3.64391 (QuantReg: 11.14577) QuantErr: 11.14577 batch_time=0.38535 
Train Epoch: 2 [193/500 12352/32000 (39%)] Loss: 4.20637 (QuantReg: 12.11569) QuantErr: 12.11569 batch_time=1.20353 
Train Epoch: 2 [201/500 12864/32000 (40%)] Loss: 4.26577 (QuantReg: 12.27210) QuantErr: 12.27210 batch_time=0.38986 
Train Epoch: 2 [209/500 13376/32000 (42%)] Loss: 4.51901 (QuantReg: 11.35091) QuantErr: 11.35091 batch_time=0.39643 
Train Epoch: 2 [217/500 13888/32000 (43%)] Loss: 4.71321 (QuantReg: 10.93914) QuantErr: 10.93914 batch_time=0.38738 
Train Epoch: 2 [225/500 14400/32000 (45%)] Loss: 4.07307 (QuantReg: 12.04042) QuantErr: 12.04042 batch_time=0.37961 
Train Epoch: 2 [233/500 14912/32000 (47%)] Loss: 4.19794 (QuantReg: 12.58993) QuantErr: 12.58993 batch_time=0.37989 
Train Epoch: 2 [241/500 15424/32000 (48%)] Loss: 4.54098 (QuantReg: 11.73583) QuantErr: 11.73583 batch_time=0.38098 
Train Epoch: 2 [249/500 15936/32000 (50%)] Loss: 4.34749 (QuantReg: 11.39763) QuantErr: 11.39763 batch_time=0.37968 
Train Epoch: 2 [257/500 16448/32000 (51%)] Loss: 4.55518 (QuantReg: 11.89023) QuantErr: 11.89023 batch_time=1.27961 
Train Epoch: 2 [265/500 16960/32000 (53%)] Loss: 5.31020 (QuantReg: 11.44927) QuantErr: 11.44927 batch_time=0.38088 
Train Epoch: 2 [273/500 17472/32000 (55%)] Loss: 4.98652 (QuantReg: 11.65243) QuantErr: 11.65243 batch_time=0.38268 
Train Epoch: 2 [281/500 17984/32000 (56%)] Loss: 4.55538 (QuantReg: 12.48728) QuantErr: 12.48728 batch_time=0.37610 
Train Epoch: 2 [289/500 18496/32000 (58%)] Loss: 4.91902 (QuantReg: 12.14586) QuantErr: 12.14586 batch_time=0.37682 
Train Epoch: 2 [297/500 19008/32000 (59%)] Loss: 4.53967 (QuantReg: 12.48479) QuantErr: 12.48479 batch_time=0.37636 
Train Epoch: 2 [305/500 19520/32000 (61%)] Loss: 3.98232 (QuantReg: 12.55803) QuantErr: 12.55803 batch_time=0.39969 
Train Epoch: 2 [313/500 20032/32000 (63%)] Loss: 4.31949 (QuantReg: 12.98061) QuantErr: 12.98061 batch_time=0.38343 
Train Epoch: 2 [321/500 20544/32000 (64%)] Loss: 4.68465 (QuantReg: 12.55792) QuantErr: 12.55792 batch_time=1.22281 
Train Epoch: 2 [329/500 21056/32000 (66%)] Loss: 3.80038 (QuantReg: 12.08035) QuantErr: 12.08035 batch_time=0.38063 
Train Epoch: 2 [337/500 21568/32000 (67%)] Loss: 5.27611 (QuantReg: 12.60673) QuantErr: 12.60673 batch_time=0.38188 
Train Epoch: 2 [345/500 22080/32000 (69%)] Loss: 4.12488 (QuantReg: 12.81594) QuantErr: 12.81594 batch_time=0.40056 
Train Epoch: 2 [353/500 22592/32000 (71%)] Loss: 4.63106 (QuantReg: 11.80640) QuantErr: 11.80640 batch_time=0.39382 
Train Epoch: 2 [361/500 23104/32000 (72%)] Loss: 3.38981 (QuantReg: 12.60551) QuantErr: 12.60551 batch_time=0.38342 
Train Epoch: 2 [369/500 23616/32000 (74%)] Loss: 3.49176 (QuantReg: 13.76420) QuantErr: 13.76420 batch_time=0.38986 
Train Epoch: 2 [377/500 24128/32000 (75%)] Loss: 4.00369 (QuantReg: 12.62970) QuantErr: 12.62970 batch_time=0.38170 
Train Epoch: 2 [385/500 24640/32000 (77%)] Loss: 4.96927 (QuantReg: 11.90540) QuantErr: 11.90540 batch_time=1.29981 
Train Epoch: 2 [393/500 25152/32000 (79%)] Loss: 4.30029 (QuantReg: 12.25595) QuantErr: 12.25595 batch_time=0.40028 
Train Epoch: 2 [401/500 25664/32000 (80%)] Loss: 4.18832 (QuantReg: 13.10460) QuantErr: 13.10460 batch_time=0.39145 
Train Epoch: 2 [409/500 26176/32000 (82%)] Loss: 4.82712 (QuantReg: 12.28234) QuantErr: 12.28234 batch_time=0.39704 
Train Epoch: 2 [417/500 26688/32000 (83%)] Loss: 4.18581 (QuantReg: 12.56702) QuantErr: 12.56702 batch_time=0.37656 
Train Epoch: 2 [425/500 27200/32000 (85%)] Loss: 4.54452 (QuantReg: 12.71363) QuantErr: 12.71363 batch_time=0.37559 
Train Epoch: 2 [433/500 27712/32000 (87%)] Loss: 3.90601 (QuantReg: 12.89751) QuantErr: 12.89751 batch_time=0.38070 
Train Epoch: 2 [441/500 28224/32000 (88%)] Loss: 4.16263 (QuantReg: 12.87190) QuantErr: 12.87190 batch_time=0.38843 
Train Epoch: 2 [449/500 28736/32000 (90%)] Loss: 4.38992 (QuantReg: 12.92166) QuantErr: 12.92166 batch_time=1.24234 
Train Epoch: 2 [457/500 29248/32000 (91%)] Loss: 4.65068 (QuantReg: 13.13227) QuantErr: 13.13227 batch_time=0.39352 
Train Epoch: 2 [465/500 29760/32000 (93%)] Loss: 4.78968 (QuantReg: 13.32824) QuantErr: 13.32824 batch_time=0.37996 
Train Epoch: 2 [473/500 30272/32000 (95%)] Loss: 4.58803 (QuantReg: 12.80024) QuantErr: 12.80024 batch_time=0.39310 
Train Epoch: 2 [481/500 30784/32000 (96%)] Loss: 4.22847 (QuantReg: 13.01755) QuantErr: 13.01755 batch_time=0.38423 
Train Epoch: 2 [489/500 31296/32000 (98%)] Loss: 4.51865 (QuantReg: 12.54391) QuantErr: 12.54391 batch_time=0.38216 
Train Epoch: 2 [497/500 31808/32000 (99%)] Loss: 4.44473 (QuantReg: 12.86563) QuantErr: 12.86563 batch_time=0.39811 
Train Epoch: 2 codebook_update_time=1.94865
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch2.pth ...
Done in 5.222s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch2.pth ...
Done in 10.478s
removing stale ckpt [epoch 1] [took 0.88s]
removing stale ckpt [epoch 0] [took 0.08s]
 epoch          : 2
 loss           : 4.525460279941559
 quant_reg      : 11.824157411575317
 quant_err      : 11.824157411575317
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 1000
 LSMDC_full_test/t2v_metrics/R1: 9.7
 LSMDC_full_test/t2v_metrics/R5: 23.7
 LSMDC_full_test/t2v_metrics/R10: 32.1
 LSMDC_full_test/t2v_metrics/R50: 60.2
 LSMDC_full_test/t2v_metrics/MedR: 30.0
 LSMDC_full_test/t2v_metrics/MeanR: 86.303
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.468912991910006
 LSMDC_full_test/v2t_metrics/R1: 8.5
 LSMDC_full_test/v2t_metrics/R5: 19.5
 LSMDC_full_test/v2t_metrics/R10: 29.6
 LSMDC_full_test/v2t_metrics/R50: 59.9
 LSMDC_full_test/v2t_metrics/MedR: 33.0
 LSMDC_full_test/v2t_metrics/MeanR: 90.3605
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 16.99215324144236
 mnt_best       : 19.468912991910006
 not_improved_count: 0
Train Epoch: 3 [1/500 64/32000 (0%)] Loss: 4.76331 (QuantReg: 10.84481) QuantErr: 10.84481 batch_time=15.00036 
Train Epoch: 3 [9/500 576/32000 (2%)] Loss: 4.55661 (QuantReg: 10.43060) QuantErr: 10.43060 batch_time=0.37882 
Train Epoch: 3 [17/500 1088/32000 (3%)] Loss: 4.25542 (QuantReg: 10.62013) QuantErr: 10.62013 batch_time=0.38339 
Train Epoch: 3 [25/500 1600/32000 (5%)] Loss: 4.12024 (QuantReg: 11.08071) QuantErr: 11.08071 batch_time=0.38858 
Train Epoch: 3 [33/500 2112/32000 (7%)] Loss: 4.53782 (QuantReg: 11.13100) QuantErr: 11.13100 batch_time=0.81741 
Train Epoch: 3 [41/500 2624/32000 (8%)] Loss: 4.29076 (QuantReg: 11.36799) QuantErr: 11.36799 batch_time=0.37784 
Train Epoch: 3 [49/500 3136/32000 (10%)] Loss: 3.65881 (QuantReg: 11.57672) QuantErr: 11.57672 batch_time=0.37870 
Train Epoch: 3 [57/500 3648/32000 (11%)] Loss: 3.94655 (QuantReg: 10.78582) QuantErr: 10.78582 batch_time=0.37965 
Train Epoch: 3 [65/500 4160/32000 (13%)] Loss: 4.77055 (QuantReg: 10.87507) QuantErr: 10.87507 batch_time=0.92446 
Train Epoch: 3 [73/500 4672/32000 (15%)] Loss: 4.51565 (QuantReg: 10.71753) QuantErr: 10.71753 batch_time=0.37928 
Train Epoch: 3 [81/500 5184/32000 (16%)] Loss: 4.06887 (QuantReg: 10.86835) QuantErr: 10.86835 batch_time=0.37769 
Train Epoch: 3 [89/500 5696/32000 (18%)] Loss: 4.01265 (QuantReg: 11.79381) QuantErr: 11.79381 batch_time=0.37792 
Train Epoch: 3 [97/500 6208/32000 (19%)] Loss: 4.19791 (QuantReg: 11.20665) QuantErr: 11.20665 batch_time=0.80411 
Train Epoch: 3 [105/500 6720/32000 (21%)] Loss: 3.97131 (QuantReg: 11.24952) QuantErr: 11.24952 batch_time=0.37665 
Train Epoch: 3 [113/500 7232/32000 (23%)] Loss: 4.29188 (QuantReg: 11.35665) QuantErr: 11.35665 batch_time=0.43215 
Train Epoch: 3 [121/500 7744/32000 (24%)] Loss: 4.33432 (QuantReg: 11.44989) QuantErr: 11.44989 batch_time=0.38246 
Train Epoch: 3 [129/500 8256/32000 (26%)] Loss: 4.51193 (QuantReg: 11.66883) QuantErr: 11.66883 batch_time=0.89227 
Train Epoch: 3 [137/500 8768/32000 (27%)] Loss: 4.37595 (QuantReg: 11.35267) QuantErr: 11.35267 batch_time=0.38126 
Train Epoch: 3 [145/500 9280/32000 (29%)] Loss: 4.02994 (QuantReg: 11.04709) QuantErr: 11.04709 batch_time=0.37974 
Train Epoch: 3 [153/500 9792/32000 (31%)] Loss: 4.32352 (QuantReg: 11.66808) QuantErr: 11.66808 batch_time=0.38094 
Train Epoch: 3 [161/500 10304/32000 (32%)] Loss: 4.57415 (QuantReg: 11.36448) QuantErr: 11.36448 batch_time=0.86369 
Train Epoch: 3 [169/500 10816/32000 (34%)] Loss: 3.92985 (QuantReg: 11.31590) QuantErr: 11.31590 batch_time=0.37478 
Train Epoch: 3 [177/500 11328/32000 (35%)] Loss: 4.06759 (QuantReg: 11.09584) QuantErr: 11.09584 batch_time=0.38052 
Train Epoch: 3 [185/500 11840/32000 (37%)] Loss: 4.28532 (QuantReg: 12.26008) QuantErr: 12.26008 batch_time=0.38372 
Train Epoch: 3 [193/500 12352/32000 (39%)] Loss: 3.69170 (QuantReg: 11.58875) QuantErr: 11.58875 batch_time=0.94481 
Train Epoch: 3 [201/500 12864/32000 (40%)] Loss: 3.71766 (QuantReg: 12.00227) QuantErr: 12.00227 batch_time=0.38371 
Train Epoch: 3 [209/500 13376/32000 (42%)] Loss: 3.82073 (QuantReg: 11.24034) QuantErr: 11.24034 batch_time=0.38882 
Train Epoch: 3 [217/500 13888/32000 (43%)] Loss: 3.81531 (QuantReg: 11.38451) QuantErr: 11.38451 batch_time=0.37956 
Train Epoch: 3 [225/500 14400/32000 (45%)] Loss: 4.59989 (QuantReg: 11.59558) QuantErr: 11.59558 batch_time=0.76997 
Train Epoch: 3 [233/500 14912/32000 (47%)] Loss: 3.89245 (QuantReg: 12.20275) QuantErr: 12.20275 batch_time=0.37672 
Train Epoch: 3 [241/500 15424/32000 (48%)] Loss: 4.11579 (QuantReg: 12.02040) QuantErr: 12.02040 batch_time=0.38685 
Train Epoch: 3 [249/500 15936/32000 (50%)] Loss: 4.12433 (QuantReg: 12.08150) QuantErr: 12.08150 batch_time=0.38819 
Train Epoch: 3 [257/500 16448/32000 (51%)] Loss: 3.89193 (QuantReg: 10.98022) QuantErr: 10.98022 batch_time=0.94469 
Train Epoch: 3 [265/500 16960/32000 (53%)] Loss: 4.19241 (QuantReg: 11.82570) QuantErr: 11.82570 batch_time=0.38357 
Train Epoch: 3 [273/500 17472/32000 (55%)] Loss: 3.71106 (QuantReg: 12.61377) QuantErr: 12.61377 batch_time=0.38310 
Train Epoch: 3 [281/500 17984/32000 (56%)] Loss: 4.95383 (QuantReg: 12.37015) QuantErr: 12.37015 batch_time=0.38150 
Train Epoch: 3 [289/500 18496/32000 (58%)] Loss: 4.48555 (QuantReg: 11.66473) QuantErr: 11.66473 batch_time=0.79789 
Train Epoch: 3 [297/500 19008/32000 (59%)] Loss: 4.30654 (QuantReg: 11.85473) QuantErr: 11.85473 batch_time=0.38614 
Train Epoch: 3 [305/500 19520/32000 (61%)] Loss: 3.92985 (QuantReg: 11.84265) QuantErr: 11.84265 batch_time=0.41986 
Train Epoch: 3 [313/500 20032/32000 (63%)] Loss: 4.44309 (QuantReg: 12.21462) QuantErr: 12.21462 batch_time=0.38291 
Train Epoch: 3 [321/500 20544/32000 (64%)] Loss: 3.72809 (QuantReg: 12.33391) QuantErr: 12.33391 batch_time=0.94490 
Train Epoch: 3 [329/500 21056/32000 (66%)] Loss: 3.37390 (QuantReg: 12.37058) QuantErr: 12.37058 batch_time=0.38761 
Train Epoch: 3 [337/500 21568/32000 (67%)] Loss: 3.84584 (QuantReg: 12.44935) QuantErr: 12.44935 batch_time=0.38737 
Train Epoch: 3 [345/500 22080/32000 (69%)] Loss: 3.98461 (QuantReg: 13.01495) QuantErr: 13.01495 batch_time=0.37814 
Train Epoch: 3 [353/500 22592/32000 (71%)] Loss: 3.77755 (QuantReg: 12.37034) QuantErr: 12.37034 batch_time=0.84833 
Train Epoch: 3 [361/500 23104/32000 (72%)] Loss: 4.20811 (QuantReg: 12.45347) QuantErr: 12.45347 batch_time=0.37514 
Train Epoch: 3 [369/500 23616/32000 (74%)] Loss: 4.43493 (QuantReg: 12.51067) QuantErr: 12.51067 batch_time=0.37840 
Train Epoch: 3 [377/500 24128/32000 (75%)] Loss: 4.08354 (QuantReg: 12.41776) QuantErr: 12.41776 batch_time=0.37940 
Train Epoch: 3 [385/500 24640/32000 (77%)] Loss: 4.64243 (QuantReg: 12.12800) QuantErr: 12.12800 batch_time=0.92455 
Train Epoch: 3 [393/500 25152/32000 (79%)] Loss: 4.20040 (QuantReg: 12.28414) QuantErr: 12.28414 batch_time=0.38213 
Train Epoch: 3 [401/500 25664/32000 (80%)] Loss: 4.58011 (QuantReg: 12.77239) QuantErr: 12.77239 batch_time=0.38288 
Train Epoch: 3 [409/500 26176/32000 (82%)] Loss: 3.69375 (QuantReg: 12.61695) QuantErr: 12.61695 batch_time=0.39986 
Train Epoch: 3 [417/500 26688/32000 (83%)] Loss: 3.66984 (QuantReg: 12.62295) QuantErr: 12.62295 batch_time=0.83395 
Train Epoch: 3 [425/500 27200/32000 (85%)] Loss: 3.45884 (QuantReg: 12.36399) QuantErr: 12.36399 batch_time=0.37619 
Train Epoch: 3 [433/500 27712/32000 (87%)] Loss: 4.61076 (QuantReg: 11.67925) QuantErr: 11.67925 batch_time=0.38158 
Train Epoch: 3 [441/500 28224/32000 (88%)] Loss: 3.96464 (QuantReg: 12.33652) QuantErr: 12.33652 batch_time=0.38352 
Train Epoch: 3 [449/500 28736/32000 (90%)] Loss: 3.82699 (QuantReg: 11.99510) QuantErr: 11.99510 batch_time=0.91528 
Train Epoch: 3 [457/500 29248/32000 (91%)] Loss: 3.48640 (QuantReg: 12.36130) QuantErr: 12.36130 batch_time=0.43666 
Train Epoch: 3 [465/500 29760/32000 (93%)] Loss: 3.54291 (QuantReg: 12.75613) QuantErr: 12.75613 batch_time=0.45865 
Train Epoch: 3 [473/500 30272/32000 (95%)] Loss: 3.89192 (QuantReg: 12.58880) QuantErr: 12.58880 batch_time=0.38426 
Train Epoch: 3 [481/500 30784/32000 (96%)] Loss: 4.32595 (QuantReg: 12.78928) QuantErr: 12.78928 batch_time=0.87923 
Train Epoch: 3 [489/500 31296/32000 (98%)] Loss: 4.37049 (QuantReg: 12.74019) QuantErr: 12.74019 batch_time=0.41799 
Train Epoch: 3 [497/500 31808/32000 (99%)] Loss: 3.31732 (QuantReg: 12.91184) QuantErr: 12.91184 batch_time=0.37628 
Train Epoch: 3 codebook_update_time=1.82897
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch3.pth ...
Done in 4.484s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch3.pth ...
Done in 8.946s
removing stale ckpt [epoch 2] [took 0.04s]
 epoch          : 3
 loss           : 4.043731429100037
 quant_reg      : 11.827239669799805
 quant_err      : 11.827239669799805
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 1500
 LSMDC_full_test/t2v_metrics/R1: 9.4
 LSMDC_full_test/t2v_metrics/R5: 23.9
 LSMDC_full_test/t2v_metrics/R10: 34.5
 LSMDC_full_test/t2v_metrics/R50: 62.6
 LSMDC_full_test/t2v_metrics/MedR: 25.0
 LSMDC_full_test/t2v_metrics/MeanR: 82.264
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.790113419501935
 LSMDC_full_test/v2t_metrics/R1: 9.9
 LSMDC_full_test/v2t_metrics/R5: 24.0
 LSMDC_full_test/v2t_metrics/R10: 32.4
 LSMDC_full_test/v2t_metrics/R50: 61.4
 LSMDC_full_test/v2t_metrics/MedR: 28.0
 LSMDC_full_test/v2t_metrics/MeanR: 83.64
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 19.745303588757427
 mnt_best       : 19.790113419501935
 not_improved_count: 0
Train Epoch: 4 [1/500 64/32000 (0%)] Loss: 4.42670 (QuantReg: 11.35158) QuantErr: 11.35158 batch_time=15.91077 
Train Epoch: 4 [9/500 576/32000 (2%)] Loss: 3.98975 (QuantReg: 10.98745) QuantErr: 10.98745 batch_time=0.38720 
Train Epoch: 4 [17/500 1088/32000 (3%)] Loss: 3.30166 (QuantReg: 11.73887) QuantErr: 11.73887 batch_time=1.35963 
Train Epoch: 4 [25/500 1600/32000 (5%)] Loss: 3.74050 (QuantReg: 11.75190) QuantErr: 11.75190 batch_time=0.38678 
Train Epoch: 4 [33/500 2112/32000 (7%)] Loss: 4.11018 (QuantReg: 11.63611) QuantErr: 11.63611 batch_time=0.40945 
Train Epoch: 4 [41/500 2624/32000 (8%)] Loss: 3.68228 (QuantReg: 11.87329) QuantErr: 11.87329 batch_time=0.38604 
Train Epoch: 4 [49/500 3136/32000 (10%)] Loss: 3.49737 (QuantReg: 11.86950) QuantErr: 11.86950 batch_time=0.39755 
Train Epoch: 4 [57/500 3648/32000 (11%)] Loss: 4.00627 (QuantReg: 11.37110) QuantErr: 11.37110 batch_time=0.38629 
Train Epoch: 4 [65/500 4160/32000 (13%)] Loss: 3.92109 (QuantReg: 11.72545) QuantErr: 11.72545 batch_time=0.69236 
Train Epoch: 4 [73/500 4672/32000 (15%)] Loss: 3.96825 (QuantReg: 12.18218) QuantErr: 12.18218 batch_time=0.39217 
Train Epoch: 4 [81/500 5184/32000 (16%)] Loss: 4.12323 (QuantReg: 11.42956) QuantErr: 11.42956 batch_time=1.21918 
Train Epoch: 4 [89/500 5696/32000 (18%)] Loss: 2.89132 (QuantReg: 12.38123) QuantErr: 12.38123 batch_time=0.39062 
Train Epoch: 4 [97/500 6208/32000 (19%)] Loss: 3.37014 (QuantReg: 11.85396) QuantErr: 11.85396 batch_time=0.38923 
Train Epoch: 4 [105/500 6720/32000 (21%)] Loss: 4.09114 (QuantReg: 12.34728) QuantErr: 12.34728 batch_time=0.38563 
Train Epoch: 4 [113/500 7232/32000 (23%)] Loss: 4.25399 (QuantReg: 11.62749) QuantErr: 11.62749 batch_time=0.38568 
Train Epoch: 4 [121/500 7744/32000 (24%)] Loss: 3.07243 (QuantReg: 11.88073) QuantErr: 11.88073 batch_time=0.38315 
Train Epoch: 4 [129/500 8256/32000 (26%)] Loss: 3.43339 (QuantReg: 12.14082) QuantErr: 12.14082 batch_time=0.72359 
Train Epoch: 4 [137/500 8768/32000 (27%)] Loss: 4.05435 (QuantReg: 12.59754) QuantErr: 12.59754 batch_time=0.38365 
Train Epoch: 4 [145/500 9280/32000 (29%)] Loss: 4.15562 (QuantReg: 12.55243) QuantErr: 12.55243 batch_time=1.26300 
Train Epoch: 4 [153/500 9792/32000 (31%)] Loss: 3.14846 (QuantReg: 11.99469) QuantErr: 11.99469 batch_time=0.39488 
Train Epoch: 4 [161/500 10304/32000 (32%)] Loss: 4.34270 (QuantReg: 11.94421) QuantErr: 11.94421 batch_time=0.39062 
Train Epoch: 4 [169/500 10816/32000 (34%)] Loss: 3.07118 (QuantReg: 12.13226) QuantErr: 12.13226 batch_time=0.36986 
Train Epoch: 4 [177/500 11328/32000 (35%)] Loss: 4.02653 (QuantReg: 12.07144) QuantErr: 12.07144 batch_time=0.38208 
Train Epoch: 4 [185/500 11840/32000 (37%)] Loss: 3.66678 (QuantReg: 12.21273) QuantErr: 12.21273 batch_time=0.38706 
Train Epoch: 4 [193/500 12352/32000 (39%)] Loss: 4.03325 (QuantReg: 11.60494) QuantErr: 11.60494 batch_time=0.76796 
Train Epoch: 4 [201/500 12864/32000 (40%)] Loss: 3.17752 (QuantReg: 12.19733) QuantErr: 12.19733 batch_time=0.38065 
Train Epoch: 4 [209/500 13376/32000 (42%)] Loss: 3.11894 (QuantReg: 12.25633) QuantErr: 12.25633 batch_time=1.26638 
Train Epoch: 4 [217/500 13888/32000 (43%)] Loss: 3.32630 (QuantReg: 12.17844) QuantErr: 12.17844 batch_time=0.38004 
Train Epoch: 4 [225/500 14400/32000 (45%)] Loss: 3.90054 (QuantReg: 11.62250) QuantErr: 11.62250 batch_time=0.38721 
Train Epoch: 4 [233/500 14912/32000 (47%)] Loss: 4.16122 (QuantReg: 11.55359) QuantErr: 11.55359 batch_time=0.42136 
Train Epoch: 4 [241/500 15424/32000 (48%)] Loss: 3.75152 (QuantReg: 12.17040) QuantErr: 12.17040 batch_time=0.40918 
Train Epoch: 4 [249/500 15936/32000 (50%)] Loss: 4.05051 (QuantReg: 12.60802) QuantErr: 12.60802 batch_time=0.39431 
Train Epoch: 4 [257/500 16448/32000 (51%)] Loss: 3.46970 (QuantReg: 12.47812) QuantErr: 12.47812 batch_time=0.76813 
Train Epoch: 4 [265/500 16960/32000 (53%)] Loss: 4.01083 (QuantReg: 11.86429) QuantErr: 11.86429 batch_time=0.42665 
Train Epoch: 4 [273/500 17472/32000 (55%)] Loss: 4.13885 (QuantReg: 11.79171) QuantErr: 11.79171 batch_time=1.30943 
Train Epoch: 4 [281/500 17984/32000 (56%)] Loss: 3.75258 (QuantReg: 12.19795) QuantErr: 12.19795 batch_time=0.39480 
Train Epoch: 4 [289/500 18496/32000 (58%)] Loss: 3.58339 (QuantReg: 12.07571) QuantErr: 12.07571 batch_time=0.39100 
Train Epoch: 4 [297/500 19008/32000 (59%)] Loss: 3.43329 (QuantReg: 12.48194) QuantErr: 12.48194 batch_time=0.38991 
Train Epoch: 4 [305/500 19520/32000 (61%)] Loss: 3.79823 (QuantReg: 11.88168) QuantErr: 11.88168 batch_time=0.39421 
Train Epoch: 4 [313/500 20032/32000 (63%)] Loss: 3.44796 (QuantReg: 12.07048) QuantErr: 12.07048 batch_time=0.38895 
Train Epoch: 4 [321/500 20544/32000 (64%)] Loss: 3.92667 (QuantReg: 12.38629) QuantErr: 12.38629 batch_time=0.70205 
Train Epoch: 4 [329/500 21056/32000 (66%)] Loss: 3.60803 (QuantReg: 11.95309) QuantErr: 11.95309 batch_time=0.39247 
Train Epoch: 4 [337/500 21568/32000 (67%)] Loss: 3.14292 (QuantReg: 12.59399) QuantErr: 12.59399 batch_time=1.23502 
Train Epoch: 4 [345/500 22080/32000 (69%)] Loss: 4.59260 (QuantReg: 12.71124) QuantErr: 12.71124 batch_time=0.40284 
Train Epoch: 4 [353/500 22592/32000 (71%)] Loss: 3.80743 (QuantReg: 12.35491) QuantErr: 12.35491 batch_time=0.42963 
Train Epoch: 4 [361/500 23104/32000 (72%)] Loss: 3.33229 (QuantReg: 12.39201) QuantErr: 12.39201 batch_time=0.39560 
Train Epoch: 4 [369/500 23616/32000 (74%)] Loss: 2.85741 (QuantReg: 12.28502) QuantErr: 12.28502 batch_time=0.39129 
Train Epoch: 4 [377/500 24128/32000 (75%)] Loss: 3.90015 (QuantReg: 12.57298) QuantErr: 12.57298 batch_time=0.39885 
Train Epoch: 4 [385/500 24640/32000 (77%)] Loss: 3.79078 (QuantReg: 12.74963) QuantErr: 12.74963 batch_time=0.72115 
Train Epoch: 4 [393/500 25152/32000 (79%)] Loss: 4.02448 (QuantReg: 12.20944) QuantErr: 12.20944 batch_time=0.39082 
Train Epoch: 4 [401/500 25664/32000 (80%)] Loss: 4.04189 (QuantReg: 12.01514) QuantErr: 12.01514 batch_time=1.26643 
Train Epoch: 4 [409/500 26176/32000 (82%)] Loss: 3.92239 (QuantReg: 12.42531) QuantErr: 12.42531 batch_time=0.39273 
Train Epoch: 4 [417/500 26688/32000 (83%)] Loss: 3.41661 (QuantReg: 12.90389) QuantErr: 12.90389 batch_time=0.38395 
Train Epoch: 4 [425/500 27200/32000 (85%)] Loss: 3.56236 (QuantReg: 12.42748) QuantErr: 12.42748 batch_time=0.38225 
Train Epoch: 4 [433/500 27712/32000 (87%)] Loss: 4.37483 (QuantReg: 12.79075) QuantErr: 12.79075 batch_time=0.41484 
Train Epoch: 4 [441/500 28224/32000 (88%)] Loss: 2.82697 (QuantReg: 12.88411) QuantErr: 12.88411 batch_time=0.38058 
Train Epoch: 4 [449/500 28736/32000 (90%)] Loss: 3.64715 (QuantReg: 13.30899) QuantErr: 13.30899 batch_time=0.75506 
Train Epoch: 4 [457/500 29248/32000 (91%)] Loss: 3.26559 (QuantReg: 12.89045) QuantErr: 12.89045 batch_time=0.38812 
Train Epoch: 4 [465/500 29760/32000 (93%)] Loss: 3.67843 (QuantReg: 12.58873) QuantErr: 12.58873 batch_time=1.23369 
Train Epoch: 4 [473/500 30272/32000 (95%)] Loss: 3.60950 (QuantReg: 12.13761) QuantErr: 12.13761 batch_time=0.38702 
Train Epoch: 4 [481/500 30784/32000 (96%)] Loss: 4.03553 (QuantReg: 13.17125) QuantErr: 13.17125 batch_time=0.38640 
Train Epoch: 4 [489/500 31296/32000 (98%)] Loss: 3.61854 (QuantReg: 12.63482) QuantErr: 12.63482 batch_time=0.38806 
Train Epoch: 4 [497/500 31808/32000 (99%)] Loss: 3.59310 (QuantReg: 12.92695) QuantErr: 12.92695 batch_time=0.39335 
Train Epoch: 4 codebook_update_time=1.91453
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch4.pth ...
Done in 4.545s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch4.pth ...
Done in 8.710s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 3.7316337847709655
 quant_reg      : 12.20126362991333
 quant_err      : 12.20126362991333
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 2000
 LSMDC_full_test/t2v_metrics/R1: 10.6
 LSMDC_full_test/t2v_metrics/R5: 24.7
 LSMDC_full_test/t2v_metrics/R10: 34.0
 LSMDC_full_test/t2v_metrics/R50: 62.7
 LSMDC_full_test/t2v_metrics/MedR: 26.0
 LSMDC_full_test/t2v_metrics/MeanR: 82.307
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.724970061405358
 LSMDC_full_test/v2t_metrics/R1: 10.4
 LSMDC_full_test/v2t_metrics/R5: 23.9
 LSMDC_full_test/v2t_metrics/R10: 33.4
 LSMDC_full_test/v2t_metrics/R50: 60.7
 LSMDC_full_test/v2t_metrics/MedR: 29.0
 LSMDC_full_test/v2t_metrics/MeanR: 84.614
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.248486601321467
 mnt_best       : 20.724970061405358
 not_improved_count: 0
Train Epoch: 5 [1/500 64/32000 (0%)] Loss: 4.21953 (QuantReg: 11.85221) QuantErr: 11.85221 batch_time=15.55274 
Train Epoch: 5 [9/500 576/32000 (2%)] Loss: 4.01327 (QuantReg: 11.77257) QuantErr: 11.77257 batch_time=0.38412 
Train Epoch: 5 [17/500 1088/32000 (3%)] Loss: 3.96045 (QuantReg: 11.96830) QuantErr: 11.96830 batch_time=0.38728 
Train Epoch: 5 [25/500 1600/32000 (5%)] Loss: 4.15603 (QuantReg: 12.32624) QuantErr: 12.32624 batch_time=0.83115 
Train Epoch: 5 [33/500 2112/32000 (7%)] Loss: 3.74630 (QuantReg: 11.73419) QuantErr: 11.73419 batch_time=1.02876 
Train Epoch: 5 [41/500 2624/32000 (8%)] Loss: 3.84718 (QuantReg: 11.98152) QuantErr: 11.98152 batch_time=0.37521 
Train Epoch: 5 [49/500 3136/32000 (10%)] Loss: 3.88654 (QuantReg: 12.34345) QuantErr: 12.34345 batch_time=0.37482 
Train Epoch: 5 [57/500 3648/32000 (11%)] Loss: 3.01653 (QuantReg: 12.68789) QuantErr: 12.68789 batch_time=0.39072 
Train Epoch: 5 [65/500 4160/32000 (13%)] Loss: 4.07880 (QuantReg: 12.34367) QuantErr: 12.34367 batch_time=1.50178 
Train Epoch: 5 [73/500 4672/32000 (15%)] Loss: 3.13035 (QuantReg: 11.80372) QuantErr: 11.80372 batch_time=0.37168 
Train Epoch: 5 [81/500 5184/32000 (16%)] Loss: 3.56214 (QuantReg: 12.10635) QuantErr: 12.10635 batch_time=0.38755 
Train Epoch: 5 [89/500 5696/32000 (18%)] Loss: 3.49163 (QuantReg: 12.66161) QuantErr: 12.66161 batch_time=0.70625 
Train Epoch: 5 [97/500 6208/32000 (19%)] Loss: 3.08050 (QuantReg: 12.38884) QuantErr: 12.38884 batch_time=0.88017 
Train Epoch: 5 [105/500 6720/32000 (21%)] Loss: 3.82115 (QuantReg: 12.31498) QuantErr: 12.31498 batch_time=0.37756 
Train Epoch: 5 [113/500 7232/32000 (23%)] Loss: 3.13807 (QuantReg: 12.47031) QuantErr: 12.47031 batch_time=0.38366 
Train Epoch: 5 [121/500 7744/32000 (24%)] Loss: 3.37048 (QuantReg: 12.73552) QuantErr: 12.73552 batch_time=0.38271 
Train Epoch: 5 [129/500 8256/32000 (26%)] Loss: 3.82094 (QuantReg: 12.48088) QuantErr: 12.48088 batch_time=1.34907 
Train Epoch: 5 [137/500 8768/32000 (27%)] Loss: 3.20946 (QuantReg: 12.90825) QuantErr: 12.90825 batch_time=0.38240 
Train Epoch: 5 [145/500 9280/32000 (29%)] Loss: 4.34000 (QuantReg: 12.47435) QuantErr: 12.47435 batch_time=0.38327 
Train Epoch: 5 [153/500 9792/32000 (31%)] Loss: 3.12143 (QuantReg: 12.94817) QuantErr: 12.94817 batch_time=0.75238 
Train Epoch: 5 [161/500 10304/32000 (32%)] Loss: 3.96935 (QuantReg: 12.90747) QuantErr: 12.90747 batch_time=0.87861 
Train Epoch: 5 [169/500 10816/32000 (34%)] Loss: 3.27938 (QuantReg: 12.92171) QuantErr: 12.92171 batch_time=0.40304 
Train Epoch: 5 [177/500 11328/32000 (35%)] Loss: 3.28032 (QuantReg: 12.88813) QuantErr: 12.88813 batch_time=0.38352 
Train Epoch: 5 [185/500 11840/32000 (37%)] Loss: 2.95866 (QuantReg: 12.76583) QuantErr: 12.76583 batch_time=0.38535 
Train Epoch: 5 [193/500 12352/32000 (39%)] Loss: 3.58526 (QuantReg: 12.94275) QuantErr: 12.94275 batch_time=1.33491 
Train Epoch: 5 [201/500 12864/32000 (40%)] Loss: 3.42174 (QuantReg: 12.86320) QuantErr: 12.86320 batch_time=0.38995 
Train Epoch: 5 [209/500 13376/32000 (42%)] Loss: 3.40993 (QuantReg: 12.71424) QuantErr: 12.71424 batch_time=0.38247 
Train Epoch: 5 [217/500 13888/32000 (43%)] Loss: 3.77376 (QuantReg: 12.36622) QuantErr: 12.36622 batch_time=0.70949 
Train Epoch: 5 [225/500 14400/32000 (45%)] Loss: 3.74654 (QuantReg: 12.40386) QuantErr: 12.40386 batch_time=0.87903 
Train Epoch: 5 [233/500 14912/32000 (47%)] Loss: 2.50449 (QuantReg: 12.71869) QuantErr: 12.71869 batch_time=0.37915 
Train Epoch: 5 [241/500 15424/32000 (48%)] Loss: 2.93595 (QuantReg: 13.10610) QuantErr: 13.10610 batch_time=0.39253 
Train Epoch: 5 [249/500 15936/32000 (50%)] Loss: 3.41643 (QuantReg: 13.22056) QuantErr: 13.22056 batch_time=0.37652 
Train Epoch: 5 [257/500 16448/32000 (51%)] Loss: 3.23201 (QuantReg: 12.93155) QuantErr: 12.93155 batch_time=1.41796 
Train Epoch: 5 [265/500 16960/32000 (53%)] Loss: 3.07929 (QuantReg: 12.85868) QuantErr: 12.85868 batch_time=0.39566 
Train Epoch: 5 [273/500 17472/32000 (55%)] Loss: 2.91188 (QuantReg: 12.72498) QuantErr: 12.72498 batch_time=0.38065 
Train Epoch: 5 [281/500 17984/32000 (56%)] Loss: 3.75458 (QuantReg: 12.91343) QuantErr: 12.91343 batch_time=0.71376 
Train Epoch: 5 [289/500 18496/32000 (58%)] Loss: 2.70410 (QuantReg: 12.75221) QuantErr: 12.75221 batch_time=0.94635 
Train Epoch: 5 [297/500 19008/32000 (59%)] Loss: 4.09294 (QuantReg: 12.41385) QuantErr: 12.41385 batch_time=0.39502 
Train Epoch: 5 [305/500 19520/32000 (61%)] Loss: 3.18628 (QuantReg: 12.70226) QuantErr: 12.70226 batch_time=0.39897 
Train Epoch: 5 [313/500 20032/32000 (63%)] Loss: 3.54552 (QuantReg: 12.79628) QuantErr: 12.79628 batch_time=0.38858 
Train Epoch: 5 [321/500 20544/32000 (64%)] Loss: 3.84238 (QuantReg: 12.89525) QuantErr: 12.89525 batch_time=1.45743 
Train Epoch: 5 [329/500 21056/32000 (66%)] Loss: 2.73603 (QuantReg: 13.30146) QuantErr: 13.30146 batch_time=0.40691 
Train Epoch: 5 [337/500 21568/32000 (67%)] Loss: 2.75995 (QuantReg: 13.28706) QuantErr: 13.28706 batch_time=0.38890 
Train Epoch: 5 [345/500 22080/32000 (69%)] Loss: 3.38638 (QuantReg: 13.01707) QuantErr: 13.01707 batch_time=0.71555 
Train Epoch: 5 [353/500 22592/32000 (71%)] Loss: 3.01815 (QuantReg: 13.59143) QuantErr: 13.59143 batch_time=0.96858 
Train Epoch: 5 [361/500 23104/32000 (72%)] Loss: 3.93294 (QuantReg: 12.69240) QuantErr: 12.69240 batch_time=0.38943 
Train Epoch: 5 [369/500 23616/32000 (74%)] Loss: 3.59799 (QuantReg: 12.39871) QuantErr: 12.39871 batch_time=0.38455 
Train Epoch: 5 [377/500 24128/32000 (75%)] Loss: 3.31714 (QuantReg: 12.61644) QuantErr: 12.61644 batch_time=0.38703 
Train Epoch: 5 [385/500 24640/32000 (77%)] Loss: 2.92366 (QuantReg: 13.34182) QuantErr: 13.34182 batch_time=1.38510 
Train Epoch: 5 [393/500 25152/32000 (79%)] Loss: 2.89986 (QuantReg: 13.20089) QuantErr: 13.20089 batch_time=0.38970 
Train Epoch: 5 [401/500 25664/32000 (80%)] Loss: 3.21037 (QuantReg: 13.02955) QuantErr: 13.02955 batch_time=0.42895 
Train Epoch: 5 [409/500 26176/32000 (82%)] Loss: 3.56278 (QuantReg: 12.88978) QuantErr: 12.88978 batch_time=0.70899 
Train Epoch: 5 [417/500 26688/32000 (83%)] Loss: 3.43791 (QuantReg: 13.01459) QuantErr: 13.01459 batch_time=0.92223 
Train Epoch: 5 [425/500 27200/32000 (85%)] Loss: 2.96896 (QuantReg: 12.78158) QuantErr: 12.78158 batch_time=0.40147 
Train Epoch: 5 [433/500 27712/32000 (87%)] Loss: 3.21329 (QuantReg: 13.02196) QuantErr: 13.02196 batch_time=0.38741 
Train Epoch: 5 [441/500 28224/32000 (88%)] Loss: 3.05450 (QuantReg: 13.02059) QuantErr: 13.02059 batch_time=0.39143 
Train Epoch: 5 [449/500 28736/32000 (90%)] Loss: 3.16026 (QuantReg: 13.18804) QuantErr: 13.18804 batch_time=1.42489 
Train Epoch: 5 [457/500 29248/32000 (91%)] Loss: 2.78365 (QuantReg: 13.35330) QuantErr: 13.35330 batch_time=0.39273 
Train Epoch: 5 [465/500 29760/32000 (93%)] Loss: 3.23671 (QuantReg: 13.41648) QuantErr: 13.41648 batch_time=0.38509 
Train Epoch: 5 [473/500 30272/32000 (95%)] Loss: 3.22120 (QuantReg: 13.67349) QuantErr: 13.67349 batch_time=0.72355 
Train Epoch: 5 [481/500 30784/32000 (96%)] Loss: 2.89011 (QuantReg: 13.42393) QuantErr: 13.42393 batch_time=0.95383 
Train Epoch: 5 [489/500 31296/32000 (98%)] Loss: 2.94334 (QuantReg: 13.35820) QuantErr: 13.35820 batch_time=0.39053 
Train Epoch: 5 [497/500 31808/32000 (99%)] Loss: 3.28863 (QuantReg: 13.62353) QuantErr: 13.62353 batch_time=0.42402 
Train Epoch: 5 codebook_update_time=2.55018
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch5.pth ...
Done in 4.757s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch5.pth ...
Done in 9.299s
removing stale ckpt [epoch 4] [took 0.04s]
 epoch          : 5
 loss           : 3.435198320388794
 quant_reg      : 12.74658716392517
 quant_err      : 12.74658716392517
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 2500
 LSMDC_full_test/t2v_metrics/R1: 11.3
 LSMDC_full_test/t2v_metrics/R5: 24.1
 LSMDC_full_test/t2v_metrics/R10: 34.6
 LSMDC_full_test/t2v_metrics/R50: 60.4
 LSMDC_full_test/t2v_metrics/MedR: 25.0
 LSMDC_full_test/t2v_metrics/MeanR: 83.063
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.12145642743642
 LSMDC_full_test/v2t_metrics/R1: 11.0
 LSMDC_full_test/v2t_metrics/R5: 27.7
 LSMDC_full_test/v2t_metrics/R10: 35.4
 LSMDC_full_test/v2t_metrics/R50: 60.7
 LSMDC_full_test/v2t_metrics/MedR: 26.0
 LSMDC_full_test/v2t_metrics/MeanR: 80.013
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.094893136931297
 mnt_best       : 21.12145642743642
 not_improved_count: 0
Train Epoch: 6 [1/500 64/32000 (0%)] Loss: 3.51672 (QuantReg: 12.53528) QuantErr: 12.53528 batch_time=15.61471 
Train Epoch: 6 [9/500 576/32000 (2%)] Loss: 2.70021 (QuantReg: 13.10624) QuantErr: 13.10624 batch_time=0.41282 
Train Epoch: 6 [17/500 1088/32000 (3%)] Loss: 3.00064 (QuantReg: 12.86301) QuantErr: 12.86301 batch_time=0.38108 
Train Epoch: 6 [25/500 1600/32000 (5%)] Loss: 3.60225 (QuantReg: 12.53675) QuantErr: 12.53675 batch_time=0.38602 
Train Epoch: 6 [33/500 2112/32000 (7%)] Loss: 2.82489 (QuantReg: 12.71385) QuantErr: 12.71385 batch_time=0.38000 
Train Epoch: 6 [41/500 2624/32000 (8%)] Loss: 2.69836 (QuantReg: 12.51311) QuantErr: 12.51311 batch_time=0.37906 
Train Epoch: 6 [49/500 3136/32000 (10%)] Loss: 3.53812 (QuantReg: 13.11411) QuantErr: 13.11411 batch_time=0.42810 
Train Epoch: 6 [57/500 3648/32000 (11%)] Loss: 3.35826 (QuantReg: 12.84474) QuantErr: 12.84474 batch_time=0.38739 
Train Epoch: 6 [65/500 4160/32000 (13%)] Loss: 2.92493 (QuantReg: 12.81637) QuantErr: 12.81637 batch_time=0.37334 
Train Epoch: 6 [73/500 4672/32000 (15%)] Loss: 2.99796 (QuantReg: 13.38857) QuantErr: 13.38857 batch_time=0.38383 
Train Epoch: 6 [81/500 5184/32000 (16%)] Loss: 2.57541 (QuantReg: 13.00853) QuantErr: 13.00853 batch_time=0.38923 
Train Epoch: 6 [89/500 5696/32000 (18%)] Loss: 2.99921 (QuantReg: 12.88279) QuantErr: 12.88279 batch_time=0.39907 
Train Epoch: 6 [97/500 6208/32000 (19%)] Loss: 3.30634 (QuantReg: 12.83269) QuantErr: 12.83269 batch_time=0.38362 
Train Epoch: 6 [105/500 6720/32000 (21%)] Loss: 2.81232 (QuantReg: 12.53024) QuantErr: 12.53024 batch_time=0.38022 
Train Epoch: 6 [113/500 7232/32000 (23%)] Loss: 3.27802 (QuantReg: 12.56722) QuantErr: 12.56722 batch_time=0.38456 
Train Epoch: 6 [121/500 7744/32000 (24%)] Loss: 3.41723 (QuantReg: 12.92379) QuantErr: 12.92379 batch_time=0.39278 
Train Epoch: 6 [129/500 8256/32000 (26%)] Loss: 3.35317 (QuantReg: 13.02871) QuantErr: 13.02871 batch_time=0.39004 
Train Epoch: 6 [137/500 8768/32000 (27%)] Loss: 3.01613 (QuantReg: 13.14997) QuantErr: 13.14997 batch_time=0.38142 
Train Epoch: 6 [145/500 9280/32000 (29%)] Loss: 2.82128 (QuantReg: 13.27011) QuantErr: 13.27011 batch_time=0.39122 
Train Epoch: 6 [153/500 9792/32000 (31%)] Loss: 3.40039 (QuantReg: 13.06126) QuantErr: 13.06126 batch_time=0.38172 
Train Epoch: 6 [161/500 10304/32000 (32%)] Loss: 3.84052 (QuantReg: 12.69269) QuantErr: 12.69269 batch_time=0.37776 
Train Epoch: 6 [169/500 10816/32000 (34%)] Loss: 2.59624 (QuantReg: 13.18893) QuantErr: 13.18893 batch_time=0.37674 
Train Epoch: 6 [177/500 11328/32000 (35%)] Loss: 3.74249 (QuantReg: 12.96784) QuantErr: 12.96784 batch_time=0.38401 
Train Epoch: 6 [185/500 11840/32000 (37%)] Loss: 3.56325 (QuantReg: 13.14306) QuantErr: 13.14306 batch_time=0.40378 
Train Epoch: 6 [193/500 12352/32000 (39%)] Loss: 2.78948 (QuantReg: 12.72636) QuantErr: 12.72636 batch_time=0.38086 
Train Epoch: 6 [201/500 12864/32000 (40%)] Loss: 4.03478 (QuantReg: 13.11609) QuantErr: 13.11609 batch_time=0.38739 
Train Epoch: 6 [209/500 13376/32000 (42%)] Loss: 3.68812 (QuantReg: 12.93823) QuantErr: 12.93823 batch_time=0.38587 
Train Epoch: 6 [217/500 13888/32000 (43%)] Loss: 3.45113 (QuantReg: 13.10744) QuantErr: 13.10744 batch_time=0.38213 
Train Epoch: 6 [225/500 14400/32000 (45%)] Loss: 3.54581 (QuantReg: 13.27997) QuantErr: 13.27997 batch_time=0.37522 
Train Epoch: 6 [233/500 14912/32000 (47%)] Loss: 2.62426 (QuantReg: 13.58403) QuantErr: 13.58403 batch_time=0.39040 
Train Epoch: 6 [241/500 15424/32000 (48%)] Loss: 4.09546 (QuantReg: 13.11865) QuantErr: 13.11865 batch_time=0.37488 
Train Epoch: 6 [249/500 15936/32000 (50%)] Loss: 3.21721 (QuantReg: 12.97634) QuantErr: 12.97634 batch_time=0.38216 
Train Epoch: 6 [257/500 16448/32000 (51%)] Loss: 2.94743 (QuantReg: 12.78996) QuantErr: 12.78996 batch_time=0.37527 
Train Epoch: 6 [265/500 16960/32000 (53%)] Loss: 3.31763 (QuantReg: 13.20664) QuantErr: 13.20664 batch_time=0.38337 
Train Epoch: 6 [273/500 17472/32000 (55%)] Loss: 2.95698 (QuantReg: 13.25618) QuantErr: 13.25618 batch_time=0.38371 
Train Epoch: 6 [281/500 17984/32000 (56%)] Loss: 4.17402 (QuantReg: 13.16227) QuantErr: 13.16227 batch_time=0.38558 
Train Epoch: 6 [289/500 18496/32000 (58%)] Loss: 3.61771 (QuantReg: 13.10688) QuantErr: 13.10688 batch_time=0.38076 
Train Epoch: 6 [297/500 19008/32000 (59%)] Loss: 3.17073 (QuantReg: 13.26996) QuantErr: 13.26996 batch_time=0.37400 
Train Epoch: 6 [305/500 19520/32000 (61%)] Loss: 2.97525 (QuantReg: 13.12595) QuantErr: 13.12595 batch_time=0.37519 
Train Epoch: 6 [313/500 20032/32000 (63%)] Loss: 4.04379 (QuantReg: 13.11477) QuantErr: 13.11477 batch_time=0.38004 
Train Epoch: 6 [321/500 20544/32000 (64%)] Loss: 3.51671 (QuantReg: 13.10431) QuantErr: 13.10431 batch_time=0.40310 
Train Epoch: 6 [329/500 21056/32000 (66%)] Loss: 3.22576 (QuantReg: 13.05742) QuantErr: 13.05742 batch_time=0.38678 
Train Epoch: 6 [337/500 21568/32000 (67%)] Loss: 4.15896 (QuantReg: 13.12539) QuantErr: 13.12539 batch_time=0.38317 
Train Epoch: 6 [345/500 22080/32000 (69%)] Loss: 2.66544 (QuantReg: 13.19019) QuantErr: 13.19019 batch_time=0.38863 
Train Epoch: 6 [353/500 22592/32000 (71%)] Loss: 2.76420 (QuantReg: 13.66161) QuantErr: 13.66161 batch_time=0.40116 
Train Epoch: 6 [361/500 23104/32000 (72%)] Loss: 3.45871 (QuantReg: 13.37291) QuantErr: 13.37291 batch_time=0.40098 
Train Epoch: 6 [369/500 23616/32000 (74%)] Loss: 3.47469 (QuantReg: 13.21814) QuantErr: 13.21814 batch_time=0.38295 
Train Epoch: 6 [377/500 24128/32000 (75%)] Loss: 3.04518 (QuantReg: 13.33303) QuantErr: 13.33303 batch_time=0.38532 
Train Epoch: 6 [385/500 24640/32000 (77%)] Loss: 3.27970 (QuantReg: 13.55151) QuantErr: 13.55151 batch_time=0.39717 
Train Epoch: 6 [393/500 25152/32000 (79%)] Loss: 4.01110 (QuantReg: 13.35038) QuantErr: 13.35038 batch_time=0.38511 
Train Epoch: 6 [401/500 25664/32000 (80%)] Loss: 3.60136 (QuantReg: 13.33466) QuantErr: 13.33466 batch_time=0.42241 
Train Epoch: 6 [409/500 26176/32000 (82%)] Loss: 3.08925 (QuantReg: 13.47717) QuantErr: 13.47717 batch_time=0.40010 
Train Epoch: 6 [417/500 26688/32000 (83%)] Loss: 3.54621 (QuantReg: 13.04644) QuantErr: 13.04644 batch_time=0.39236 
Train Epoch: 6 [425/500 27200/32000 (85%)] Loss: 3.10623 (QuantReg: 13.02081) QuantErr: 13.02081 batch_time=0.38918 
Train Epoch: 6 [433/500 27712/32000 (87%)] Loss: 3.21680 (QuantReg: 13.27463) QuantErr: 13.27463 batch_time=0.38443 
Train Epoch: 6 [441/500 28224/32000 (88%)] Loss: 2.69248 (QuantReg: 13.78931) QuantErr: 13.78931 batch_time=0.38287 
Train Epoch: 6 [449/500 28736/32000 (90%)] Loss: 2.81894 (QuantReg: 13.64663) QuantErr: 13.64663 batch_time=0.40963 
Train Epoch: 6 [457/500 29248/32000 (91%)] Loss: 2.83394 (QuantReg: 13.11282) QuantErr: 13.11282 batch_time=0.38547 
Train Epoch: 6 [465/500 29760/32000 (93%)] Loss: 3.64542 (QuantReg: 13.03572) QuantErr: 13.03572 batch_time=0.38567 
Train Epoch: 6 [473/500 30272/32000 (95%)] Loss: 2.55022 (QuantReg: 13.58080) QuantErr: 13.58080 batch_time=0.38406 
Train Epoch: 6 [481/500 30784/32000 (96%)] Loss: 3.67098 (QuantReg: 13.32073) QuantErr: 13.32073 batch_time=0.39840 
Train Epoch: 6 [489/500 31296/32000 (98%)] Loss: 3.17202 (QuantReg: 13.27683) QuantErr: 13.27683 batch_time=0.42965 
Train Epoch: 6 [497/500 31808/32000 (99%)] Loss: 3.51603 (QuantReg: 13.74396) QuantErr: 13.74396 batch_time=0.38664 
Train Epoch: 6 codebook_update_time=1.86603
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch6.pth ...
Done in 4.168s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 3.248783121585846
 quant_reg      : 13.116776977539063
 quant_err      : 13.116776977539063
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 3000
 LSMDC_full_test/t2v_metrics/R1: 10.2
 LSMDC_full_test/t2v_metrics/R5: 26.1
 LSMDC_full_test/t2v_metrics/R10: 34.7
 LSMDC_full_test/t2v_metrics/R50: 64.2
 LSMDC_full_test/t2v_metrics/MedR: 24.5
 LSMDC_full_test/t2v_metrics/MeanR: 78.41
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.982475175249288
 LSMDC_full_test/v2t_metrics/R1: 9.8
 LSMDC_full_test/v2t_metrics/R5: 26.0
 LSMDC_full_test/v2t_metrics/R10: 34.8
 LSMDC_full_test/v2t_metrics/R50: 61.6
 LSMDC_full_test/v2t_metrics/MedR: 24.0
 LSMDC_full_test/v2t_metrics/MeanR: 79.256
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.697897053512925
 mnt_best       : 21.12145642743642
 not_improved_count: 1
Train Epoch: 7 [1/500 64/32000 (0%)] Loss: 3.31640 (QuantReg: 12.90884) QuantErr: 12.90884 batch_time=15.62816 
Train Epoch: 7 [9/500 576/32000 (2%)] Loss: 3.67018 (QuantReg: 12.33668) QuantErr: 12.33668 batch_time=0.38012 
Train Epoch: 7 [17/500 1088/32000 (3%)] Loss: 3.18607 (QuantReg: 12.77426) QuantErr: 12.77426 batch_time=0.37907 
Train Epoch: 7 [25/500 1600/32000 (5%)] Loss: 3.28717 (QuantReg: 12.98105) QuantErr: 12.98105 batch_time=0.39327 
Train Epoch: 7 [33/500 2112/32000 (7%)] Loss: 2.70637 (QuantReg: 13.08659) QuantErr: 13.08659 batch_time=0.37866 
Train Epoch: 7 [41/500 2624/32000 (8%)] Loss: 3.48754 (QuantReg: 12.83870) QuantErr: 12.83870 batch_time=0.37370 
Train Epoch: 7 [49/500 3136/32000 (10%)] Loss: 2.65193 (QuantReg: 13.17044) QuantErr: 13.17044 batch_time=0.38500 
Train Epoch: 7 [57/500 3648/32000 (11%)] Loss: 3.18265 (QuantReg: 13.19473) QuantErr: 13.19473 batch_time=0.38257 
Train Epoch: 7 [65/500 4160/32000 (13%)] Loss: 3.32502 (QuantReg: 12.83450) QuantErr: 12.83450 batch_time=0.97076 
Train Epoch: 7 [73/500 4672/32000 (15%)] Loss: 3.63899 (QuantReg: 13.11508) QuantErr: 13.11508 batch_time=0.42618 
Train Epoch: 7 [81/500 5184/32000 (16%)] Loss: 3.68740 (QuantReg: 13.01811) QuantErr: 13.01811 batch_time=0.39786 
Train Epoch: 7 [89/500 5696/32000 (18%)] Loss: 3.16459 (QuantReg: 13.38535) QuantErr: 13.38535 batch_time=0.40356 
Train Epoch: 7 [97/500 6208/32000 (19%)] Loss: 3.20690 (QuantReg: 13.40038) QuantErr: 13.40038 batch_time=0.38418 
Train Epoch: 7 [105/500 6720/32000 (21%)] Loss: 3.43163 (QuantReg: 13.29914) QuantErr: 13.29914 batch_time=0.37612 
Train Epoch: 7 [113/500 7232/32000 (23%)] Loss: 3.38364 (QuantReg: 13.39603) QuantErr: 13.39603 batch_time=0.37691 
Train Epoch: 7 [121/500 7744/32000 (24%)] Loss: 3.09449 (QuantReg: 13.15274) QuantErr: 13.15274 batch_time=0.38726 
Train Epoch: 7 [129/500 8256/32000 (26%)] Loss: 3.32004 (QuantReg: 13.32386) QuantErr: 13.32386 batch_time=1.03440 
Train Epoch: 7 [137/500 8768/32000 (27%)] Loss: 3.20308 (QuantReg: 13.40589) QuantErr: 13.40589 batch_time=0.37891 
Train Epoch: 7 [145/500 9280/32000 (29%)] Loss: 3.72461 (QuantReg: 13.30583) QuantErr: 13.30583 batch_time=0.38179 
Train Epoch: 7 [153/500 9792/32000 (31%)] Loss: 3.02431 (QuantReg: 12.93186) QuantErr: 12.93186 batch_time=0.40054 
Train Epoch: 7 [161/500 10304/32000 (32%)] Loss: 3.52886 (QuantReg: 13.29695) QuantErr: 13.29695 batch_time=0.37757 
Train Epoch: 7 [169/500 10816/32000 (34%)] Loss: 2.44840 (QuantReg: 13.27188) QuantErr: 13.27188 batch_time=0.39200 
Train Epoch: 7 [177/500 11328/32000 (35%)] Loss: 3.00679 (QuantReg: 12.83984) QuantErr: 12.83984 batch_time=0.39449 
Train Epoch: 7 [185/500 11840/32000 (37%)] Loss: 2.61617 (QuantReg: 13.38446) QuantErr: 13.38446 batch_time=0.38726 
Train Epoch: 7 [193/500 12352/32000 (39%)] Loss: 2.31183 (QuantReg: 13.65384) QuantErr: 13.65384 batch_time=0.96736 
Train Epoch: 7 [201/500 12864/32000 (40%)] Loss: 3.19607 (QuantReg: 13.68121) QuantErr: 13.68121 batch_time=0.38327 
Train Epoch: 7 [209/500 13376/32000 (42%)] Loss: 2.82104 (QuantReg: 13.67615) QuantErr: 13.67615 batch_time=0.38627 
Train Epoch: 7 [217/500 13888/32000 (43%)] Loss: 2.81966 (QuantReg: 13.65003) QuantErr: 13.65003 batch_time=0.37726 
Train Epoch: 7 [225/500 14400/32000 (45%)] Loss: 2.94533 (QuantReg: 13.47566) QuantErr: 13.47566 batch_time=0.38177 
Train Epoch: 7 [233/500 14912/32000 (47%)] Loss: 3.56600 (QuantReg: 13.57448) QuantErr: 13.57448 batch_time=0.38038 
Train Epoch: 7 [241/500 15424/32000 (48%)] Loss: 2.85960 (QuantReg: 13.30180) QuantErr: 13.30180 batch_time=0.40261 
Train Epoch: 7 [249/500 15936/32000 (50%)] Loss: 3.58375 (QuantReg: 13.19435) QuantErr: 13.19435 batch_time=0.37934 
Train Epoch: 7 [257/500 16448/32000 (51%)] Loss: 3.72683 (QuantReg: 13.41346) QuantErr: 13.41346 batch_time=0.94132 
Train Epoch: 7 [265/500 16960/32000 (53%)] Loss: 3.00748 (QuantReg: 13.27610) QuantErr: 13.27610 batch_time=0.38117 
Train Epoch: 7 [273/500 17472/32000 (55%)] Loss: 4.01470 (QuantReg: 13.67836) QuantErr: 13.67836 batch_time=0.40511 
Train Epoch: 7 [281/500 17984/32000 (56%)] Loss: 3.58967 (QuantReg: 13.82380) QuantErr: 13.82380 batch_time=0.44507 
Train Epoch: 7 [289/500 18496/32000 (58%)] Loss: 2.98746 (QuantReg: 13.54298) QuantErr: 13.54298 batch_time=0.39108 
Train Epoch: 7 [297/500 19008/32000 (59%)] Loss: 2.76668 (QuantReg: 13.60436) QuantErr: 13.60436 batch_time=0.38003 
Train Epoch: 7 [305/500 19520/32000 (61%)] Loss: 2.86019 (QuantReg: 13.37758) QuantErr: 13.37758 batch_time=0.38575 
Train Epoch: 7 [313/500 20032/32000 (63%)] Loss: 3.24092 (QuantReg: 13.69628) QuantErr: 13.69628 batch_time=0.38115 
Train Epoch: 7 [321/500 20544/32000 (64%)] Loss: 3.31007 (QuantReg: 13.25531) QuantErr: 13.25531 batch_time=0.94520 
Train Epoch: 7 [329/500 21056/32000 (66%)] Loss: 3.12126 (QuantReg: 13.20542) QuantErr: 13.20542 batch_time=0.38195 
Train Epoch: 7 [337/500 21568/32000 (67%)] Loss: 3.50077 (QuantReg: 13.41124) QuantErr: 13.41124 batch_time=0.40115 
Train Epoch: 7 [345/500 22080/32000 (69%)] Loss: 2.28501 (QuantReg: 13.90053) QuantErr: 13.90053 batch_time=0.40781 
Train Epoch: 7 [353/500 22592/32000 (71%)] Loss: 2.80392 (QuantReg: 13.26758) QuantErr: 13.26758 batch_time=0.39239 
Train Epoch: 7 [361/500 23104/32000 (72%)] Loss: 3.05589 (QuantReg: 13.49796) QuantErr: 13.49796 batch_time=0.40026 
Train Epoch: 7 [369/500 23616/32000 (74%)] Loss: 2.69026 (QuantReg: 13.93192) QuantErr: 13.93192 batch_time=0.39028 
Train Epoch: 7 [377/500 24128/32000 (75%)] Loss: 2.61802 (QuantReg: 13.65566) QuantErr: 13.65566 batch_time=0.37884 
Train Epoch: 7 [385/500 24640/32000 (77%)] Loss: 3.51497 (QuantReg: 13.72363) QuantErr: 13.72363 batch_time=0.98775 
Train Epoch: 7 [393/500 25152/32000 (79%)] Loss: 3.56416 (QuantReg: 13.82605) QuantErr: 13.82605 batch_time=0.37971 
Train Epoch: 7 [401/500 25664/32000 (80%)] Loss: 2.50489 (QuantReg: 13.49999) QuantErr: 13.49999 batch_time=0.39874 
Train Epoch: 7 [409/500 26176/32000 (82%)] Loss: 2.61438 (QuantReg: 13.98005) QuantErr: 13.98005 batch_time=0.38042 
Train Epoch: 7 [417/500 26688/32000 (83%)] Loss: 2.90185 (QuantReg: 13.63774) QuantErr: 13.63774 batch_time=0.40955 
Train Epoch: 7 [425/500 27200/32000 (85%)] Loss: 2.19884 (QuantReg: 13.70676) QuantErr: 13.70676 batch_time=0.40641 
Train Epoch: 7 [433/500 27712/32000 (87%)] Loss: 2.76366 (QuantReg: 14.40598) QuantErr: 14.40598 batch_time=0.38852 
Train Epoch: 7 [441/500 28224/32000 (88%)] Loss: 2.73998 (QuantReg: 13.89587) QuantErr: 13.89587 batch_time=0.38526 
Train Epoch: 7 [449/500 28736/32000 (90%)] Loss: 2.63888 (QuantReg: 14.35275) QuantErr: 14.35275 batch_time=0.92690 
Train Epoch: 7 [457/500 29248/32000 (91%)] Loss: 3.10287 (QuantReg: 13.77009) QuantErr: 13.77009 batch_time=0.38488 
Train Epoch: 7 [465/500 29760/32000 (93%)] Loss: 3.71068 (QuantReg: 13.83571) QuantErr: 13.83571 batch_time=0.39730 
Train Epoch: 7 [473/500 30272/32000 (95%)] Loss: 2.76975 (QuantReg: 13.64508) QuantErr: 13.64508 batch_time=0.38384 
Train Epoch: 7 [481/500 30784/32000 (96%)] Loss: 3.00534 (QuantReg: 13.55736) QuantErr: 13.55736 batch_time=0.39021 
Train Epoch: 7 [489/500 31296/32000 (98%)] Loss: 2.26220 (QuantReg: 13.67653) QuantErr: 13.67653 batch_time=0.37555 
Train Epoch: 7 [497/500 31808/32000 (99%)] Loss: 2.64968 (QuantReg: 14.21667) QuantErr: 14.21667 batch_time=0.38984 
Train Epoch: 7 codebook_update_time=2.38358
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch7.pth ...
Done in 5.664s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch7.pth ...
Done in 10.496s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 3.0379776887893675
 quant_reg      : 13.487635873794556
 quant_err      : 13.487635873794556
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 3500
 LSMDC_full_test/t2v_metrics/R1: 12.3
 LSMDC_full_test/t2v_metrics/R5: 28.9
 LSMDC_full_test/t2v_metrics/R10: 38.7
 LSMDC_full_test/t2v_metrics/R50: 66.2
 LSMDC_full_test/t2v_metrics/MedR: 21.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.652
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.960983480672578
 LSMDC_full_test/v2t_metrics/R1: 11.5
 LSMDC_full_test/v2t_metrics/R5: 27.8
 LSMDC_full_test/v2t_metrics/R10: 38.4
 LSMDC_full_test/v2t_metrics/R50: 65.9
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.121
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.068779622377598
 mnt_best       : 23.960983480672578
 not_improved_count: 0
Train Epoch: 8 [1/500 64/32000 (0%)] Loss: 3.09174 (QuantReg: 13.49106) QuantErr: 13.49106 batch_time=15.45138 
Train Epoch: 8 [9/500 576/32000 (2%)] Loss: 2.46932 (QuantReg: 13.70291) QuantErr: 13.70291 batch_time=0.43287 
Train Epoch: 8 [17/500 1088/32000 (3%)] Loss: 2.79468 (QuantReg: 13.46056) QuantErr: 13.46056 batch_time=0.40635 
Train Epoch: 8 [25/500 1600/32000 (5%)] Loss: 2.93855 (QuantReg: 13.39199) QuantErr: 13.39199 batch_time=1.51502 
Train Epoch: 8 [33/500 2112/32000 (7%)] Loss: 3.32606 (QuantReg: 13.02270) QuantErr: 13.02270 batch_time=0.38273 
Train Epoch: 8 [41/500 2624/32000 (8%)] Loss: 2.67773 (QuantReg: 13.59318) QuantErr: 13.59318 batch_time=0.40497 
Train Epoch: 8 [49/500 3136/32000 (10%)] Loss: 4.12753 (QuantReg: 13.33605) QuantErr: 13.33605 batch_time=0.38302 
Train Epoch: 8 [57/500 3648/32000 (11%)] Loss: 2.24892 (QuantReg: 13.75163) QuantErr: 13.75163 batch_time=0.38362 
Train Epoch: 8 [65/500 4160/32000 (13%)] Loss: 3.33257 (QuantReg: 13.48895) QuantErr: 13.48895 batch_time=0.41396 
Train Epoch: 8 [73/500 4672/32000 (15%)] Loss: 3.28061 (QuantReg: 13.50342) QuantErr: 13.50342 batch_time=0.47471 
Train Epoch: 8 [81/500 5184/32000 (16%)] Loss: 2.73608 (QuantReg: 13.68683) QuantErr: 13.68683 batch_time=0.41759 
Train Epoch: 8 [89/500 5696/32000 (18%)] Loss: 2.77480 (QuantReg: 13.58474) QuantErr: 13.58474 batch_time=1.11365 
Train Epoch: 8 [97/500 6208/32000 (19%)] Loss: 3.68909 (QuantReg: 13.61681) QuantErr: 13.61681 batch_time=0.37643 
Train Epoch: 8 [105/500 6720/32000 (21%)] Loss: 3.09614 (QuantReg: 13.43857) QuantErr: 13.43857 batch_time=0.40761 
Train Epoch: 8 [113/500 7232/32000 (23%)] Loss: 3.10420 (QuantReg: 13.81959) QuantErr: 13.81959 batch_time=0.38345 
Train Epoch: 8 [121/500 7744/32000 (24%)] Loss: 2.64318 (QuantReg: 13.99393) QuantErr: 13.99393 batch_time=0.37553 
Train Epoch: 8 [129/500 8256/32000 (26%)] Loss: 3.01817 (QuantReg: 12.73138) QuantErr: 12.73138 batch_time=0.38610 
Train Epoch: 8 [137/500 8768/32000 (27%)] Loss: 2.76285 (QuantReg: 13.56783) QuantErr: 13.56783 batch_time=0.43308 
Train Epoch: 8 [145/500 9280/32000 (29%)] Loss: 2.91625 (QuantReg: 13.37793) QuantErr: 13.37793 batch_time=0.37712 
Train Epoch: 8 [153/500 9792/32000 (31%)] Loss: 2.57776 (QuantReg: 13.62158) QuantErr: 13.62158 batch_time=1.10159 
Train Epoch: 8 [161/500 10304/32000 (32%)] Loss: 2.41822 (QuantReg: 13.94830) QuantErr: 13.94830 batch_time=0.38623 
Train Epoch: 8 [169/500 10816/32000 (34%)] Loss: 2.88480 (QuantReg: 13.70727) QuantErr: 13.70727 batch_time=0.38743 
Train Epoch: 8 [177/500 11328/32000 (35%)] Loss: 3.19177 (QuantReg: 14.12760) QuantErr: 14.12760 batch_time=0.37874 
Train Epoch: 8 [185/500 11840/32000 (37%)] Loss: 2.67935 (QuantReg: 13.41149) QuantErr: 13.41149 batch_time=0.37594 
Train Epoch: 8 [193/500 12352/32000 (39%)] Loss: 2.62742 (QuantReg: 13.58219) QuantErr: 13.58219 batch_time=0.37682 
Train Epoch: 8 [201/500 12864/32000 (40%)] Loss: 3.05682 (QuantReg: 13.35097) QuantErr: 13.35097 batch_time=0.44366 
Train Epoch: 8 [209/500 13376/32000 (42%)] Loss: 2.73734 (QuantReg: 13.99633) QuantErr: 13.99633 batch_time=0.38445 
Train Epoch: 8 [217/500 13888/32000 (43%)] Loss: 2.95793 (QuantReg: 13.91236) QuantErr: 13.91236 batch_time=1.09705 
Train Epoch: 8 [225/500 14400/32000 (45%)] Loss: 2.40118 (QuantReg: 13.69172) QuantErr: 13.69172 batch_time=0.38399 
Train Epoch: 8 [233/500 14912/32000 (47%)] Loss: 3.07044 (QuantReg: 14.24895) QuantErr: 14.24895 batch_time=0.43524 
Train Epoch: 8 [241/500 15424/32000 (48%)] Loss: 2.71556 (QuantReg: 13.40182) QuantErr: 13.40182 batch_time=0.39097 
Train Epoch: 8 [249/500 15936/32000 (50%)] Loss: 2.18004 (QuantReg: 14.20465) QuantErr: 14.20465 batch_time=0.37731 
Train Epoch: 8 [257/500 16448/32000 (51%)] Loss: 2.82408 (QuantReg: 13.81093) QuantErr: 13.81093 batch_time=0.39551 
Train Epoch: 8 [265/500 16960/32000 (53%)] Loss: 3.37614 (QuantReg: 13.72669) QuantErr: 13.72669 batch_time=0.43243 
Train Epoch: 8 [273/500 17472/32000 (55%)] Loss: 2.75947 (QuantReg: 13.73355) QuantErr: 13.73355 batch_time=0.38151 
Train Epoch: 8 [281/500 17984/32000 (56%)] Loss: 2.00563 (QuantReg: 13.91963) QuantErr: 13.91963 batch_time=1.10923 
Train Epoch: 8 [289/500 18496/32000 (58%)] Loss: 2.50669 (QuantReg: 13.62848) QuantErr: 13.62848 batch_time=0.38949 
Train Epoch: 8 [297/500 19008/32000 (59%)] Loss: 2.69206 (QuantReg: 14.20986) QuantErr: 14.20986 batch_time=0.37666 
Train Epoch: 8 [305/500 19520/32000 (61%)] Loss: 3.25618 (QuantReg: 13.89714) QuantErr: 13.89714 batch_time=0.39163 
Train Epoch: 8 [313/500 20032/32000 (63%)] Loss: 2.57715 (QuantReg: 13.92244) QuantErr: 13.92244 batch_time=0.37339 
Train Epoch: 8 [321/500 20544/32000 (64%)] Loss: 3.05090 (QuantReg: 14.15152) QuantErr: 14.15152 batch_time=0.38027 
Train Epoch: 8 [329/500 21056/32000 (66%)] Loss: 3.33789 (QuantReg: 13.91221) QuantErr: 13.91221 batch_time=0.42690 
Train Epoch: 8 [337/500 21568/32000 (67%)] Loss: 3.01815 (QuantReg: 13.36954) QuantErr: 13.36954 batch_time=0.38666 
Train Epoch: 8 [345/500 22080/32000 (69%)] Loss: 2.78939 (QuantReg: 13.84983) QuantErr: 13.84983 batch_time=1.17086 
Train Epoch: 8 [353/500 22592/32000 (71%)] Loss: 3.12940 (QuantReg: 13.89877) QuantErr: 13.89877 batch_time=0.37936 
Train Epoch: 8 [361/500 23104/32000 (72%)] Loss: 2.61292 (QuantReg: 13.88388) QuantErr: 13.88388 batch_time=0.37904 
Train Epoch: 8 [369/500 23616/32000 (74%)] Loss: 1.92766 (QuantReg: 14.34596) QuantErr: 14.34596 batch_time=0.38643 
Train Epoch: 8 [377/500 24128/32000 (75%)] Loss: 2.50353 (QuantReg: 14.08488) QuantErr: 14.08488 batch_time=0.38327 
Train Epoch: 8 [385/500 24640/32000 (77%)] Loss: 2.93116 (QuantReg: 14.01975) QuantErr: 14.01975 batch_time=0.38641 
Train Epoch: 8 [393/500 25152/32000 (79%)] Loss: 2.94870 (QuantReg: 13.55234) QuantErr: 13.55234 batch_time=0.43139 
Train Epoch: 8 [401/500 25664/32000 (80%)] Loss: 2.88448 (QuantReg: 13.79636) QuantErr: 13.79636 batch_time=0.38244 
Train Epoch: 8 [409/500 26176/32000 (82%)] Loss: 2.52428 (QuantReg: 14.07954) QuantErr: 14.07954 batch_time=1.11785 
Train Epoch: 8 [417/500 26688/32000 (83%)] Loss: 3.81278 (QuantReg: 13.75798) QuantErr: 13.75798 batch_time=0.39814 
Train Epoch: 8 [425/500 27200/32000 (85%)] Loss: 2.65709 (QuantReg: 13.87689) QuantErr: 13.87689 batch_time=0.38169 
Train Epoch: 8 [433/500 27712/32000 (87%)] Loss: 2.67663 (QuantReg: 13.80510) QuantErr: 13.80510 batch_time=0.38912 
Train Epoch: 8 [441/500 28224/32000 (88%)] Loss: 2.45831 (QuantReg: 13.98835) QuantErr: 13.98835 batch_time=0.38480 
Train Epoch: 8 [449/500 28736/32000 (90%)] Loss: 2.24219 (QuantReg: 14.31137) QuantErr: 14.31137 batch_time=0.37940 
Train Epoch: 8 [457/500 29248/32000 (91%)] Loss: 2.23421 (QuantReg: 13.62978) QuantErr: 13.62978 batch_time=0.43088 
Train Epoch: 8 [465/500 29760/32000 (93%)] Loss: 2.73149 (QuantReg: 14.08508) QuantErr: 14.08508 batch_time=0.39498 
Train Epoch: 8 [473/500 30272/32000 (95%)] Loss: 3.54035 (QuantReg: 13.81718) QuantErr: 13.81718 batch_time=1.13994 
Train Epoch: 8 [481/500 30784/32000 (96%)] Loss: 3.26095 (QuantReg: 13.77090) QuantErr: 13.77090 batch_time=0.38001 
Train Epoch: 8 [489/500 31296/32000 (98%)] Loss: 2.66714 (QuantReg: 13.72149) QuantErr: 13.72149 batch_time=0.37848 
Train Epoch: 8 [497/500 31808/32000 (99%)] Loss: 3.16029 (QuantReg: 13.95246) QuantErr: 13.95246 batch_time=0.38179 
Train Epoch: 8 codebook_update_time=2.12850
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch8.pth ...
Done in 4.613s
removing stale ckpt [epoch 7] [took 0.01s]
 epoch          : 8
 loss           : 2.8424546465873717
 quant_reg      : 13.785086799621583
 quant_err      : 13.785086799621583
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 4000
 LSMDC_full_test/t2v_metrics/R1: 11.5
 LSMDC_full_test/t2v_metrics/R5: 26.8
 LSMDC_full_test/t2v_metrics/R10: 36.6
 LSMDC_full_test/t2v_metrics/R50: 64.1
 LSMDC_full_test/t2v_metrics/MedR: 24.0
 LSMDC_full_test/t2v_metrics/MeanR: 78.408
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.427002936897175
 LSMDC_full_test/v2t_metrics/R1: 10.5
 LSMDC_full_test/v2t_metrics/R5: 26.6
 LSMDC_full_test/v2t_metrics/R10: 37.5
 LSMDC_full_test/v2t_metrics/R50: 63.8
 LSMDC_full_test/v2t_metrics/MedR: 24.0
 LSMDC_full_test/v2t_metrics/MeanR: 76.78
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.879332475203938
 mnt_best       : 23.960983480672578
 not_improved_count: 1
Train Epoch: 9 [1/500 64/32000 (0%)] Loss: 2.16180 (QuantReg: 13.21311) QuantErr: 13.21311 batch_time=14.60774 
Train Epoch: 9 [9/500 576/32000 (2%)] Loss: 2.67796 (QuantReg: 14.26332) QuantErr: 14.26332 batch_time=0.40693 
Train Epoch: 9 [17/500 1088/32000 (3%)] Loss: 3.03790 (QuantReg: 13.87503) QuantErr: 13.87503 batch_time=0.38829 
Train Epoch: 9 [25/500 1600/32000 (5%)] Loss: 2.86665 (QuantReg: 13.76069) QuantErr: 13.76069 batch_time=0.38443 
Train Epoch: 9 [33/500 2112/32000 (7%)] Loss: 2.89685 (QuantReg: 13.34725) QuantErr: 13.34725 batch_time=0.38406 
Train Epoch: 9 [41/500 2624/32000 (8%)] Loss: 3.76009 (QuantReg: 13.57202) QuantErr: 13.57202 batch_time=0.38589 
Train Epoch: 9 [49/500 3136/32000 (10%)] Loss: 2.24054 (QuantReg: 13.66702) QuantErr: 13.66702 batch_time=0.40712 
Train Epoch: 9 [57/500 3648/32000 (11%)] Loss: 2.83281 (QuantReg: 13.76102) QuantErr: 13.76102 batch_time=0.38665 
Train Epoch: 9 [65/500 4160/32000 (13%)] Loss: 2.58666 (QuantReg: 14.16966) QuantErr: 14.16966 batch_time=0.39718 
Train Epoch: 9 [73/500 4672/32000 (15%)] Loss: 2.74436 (QuantReg: 13.85744) QuantErr: 13.85744 batch_time=0.39407 
Train Epoch: 9 [81/500 5184/32000 (16%)] Loss: 2.65364 (QuantReg: 14.21052) QuantErr: 14.21052 batch_time=0.38924 
Train Epoch: 9 [89/500 5696/32000 (18%)] Loss: 2.74819 (QuantReg: 14.10513) QuantErr: 14.10513 batch_time=0.38657 
Train Epoch: 9 [97/500 6208/32000 (19%)] Loss: 3.05409 (QuantReg: 13.79586) QuantErr: 13.79586 batch_time=0.38264 
Train Epoch: 9 [105/500 6720/32000 (21%)] Loss: 2.27417 (QuantReg: 13.54474) QuantErr: 13.54474 batch_time=0.38547 
Train Epoch: 9 [113/500 7232/32000 (23%)] Loss: 2.28584 (QuantReg: 14.23472) QuantErr: 14.23472 batch_time=0.40844 
Train Epoch: 9 [121/500 7744/32000 (24%)] Loss: 3.13327 (QuantReg: 13.77689) QuantErr: 13.77689 batch_time=0.38804 
Train Epoch: 9 [129/500 8256/32000 (26%)] Loss: 2.33726 (QuantReg: 14.03382) QuantErr: 14.03382 batch_time=0.37788 
Train Epoch: 9 [137/500 8768/32000 (27%)] Loss: 2.37979 (QuantReg: 14.15919) QuantErr: 14.15919 batch_time=0.39777 
Train Epoch: 9 [145/500 9280/32000 (29%)] Loss: 2.62568 (QuantReg: 13.81833) QuantErr: 13.81833 batch_time=0.41131 
Train Epoch: 9 [153/500 9792/32000 (31%)] Loss: 3.36008 (QuantReg: 13.90845) QuantErr: 13.90845 batch_time=0.37677 
Train Epoch: 9 [161/500 10304/32000 (32%)] Loss: 3.49951 (QuantReg: 13.47911) QuantErr: 13.47911 batch_time=0.38024 
Train Epoch: 9 [169/500 10816/32000 (34%)] Loss: 2.85120 (QuantReg: 13.83454) QuantErr: 13.83454 batch_time=0.37985 
Train Epoch: 9 [177/500 11328/32000 (35%)] Loss: 3.10606 (QuantReg: 13.99297) QuantErr: 13.99297 batch_time=0.42467 
Train Epoch: 9 [185/500 11840/32000 (37%)] Loss: 3.00540 (QuantReg: 13.91797) QuantErr: 13.91797 batch_time=0.38067 
Train Epoch: 9 [193/500 12352/32000 (39%)] Loss: 2.24555 (QuantReg: 13.99707) QuantErr: 13.99707 batch_time=0.37885 
Train Epoch: 9 [201/500 12864/32000 (40%)] Loss: 3.23286 (QuantReg: 13.72627) QuantErr: 13.72627 batch_time=0.37784 
Train Epoch: 9 [209/500 13376/32000 (42%)] Loss: 2.77730 (QuantReg: 13.66352) QuantErr: 13.66352 batch_time=0.39920 
Train Epoch: 9 [217/500 13888/32000 (43%)] Loss: 2.39549 (QuantReg: 13.88235) QuantErr: 13.88235 batch_time=0.38333 
Train Epoch: 9 [225/500 14400/32000 (45%)] Loss: 2.92975 (QuantReg: 13.42243) QuantErr: 13.42243 batch_time=0.39160 
Train Epoch: 9 [233/500 14912/32000 (47%)] Loss: 2.33894 (QuantReg: 14.32089) QuantErr: 14.32089 batch_time=0.40441 
Train Epoch: 9 [241/500 15424/32000 (48%)] Loss: 3.28136 (QuantReg: 14.02069) QuantErr: 14.02069 batch_time=0.38225 
Train Epoch: 9 [249/500 15936/32000 (50%)] Loss: 2.78817 (QuantReg: 14.32213) QuantErr: 14.32213 batch_time=0.37869 
Train Epoch: 9 [257/500 16448/32000 (51%)] Loss: 3.11726 (QuantReg: 13.64544) QuantErr: 13.64544 batch_time=0.37586 
Train Epoch: 9 [265/500 16960/32000 (53%)] Loss: 2.26664 (QuantReg: 14.00756) QuantErr: 14.00756 batch_time=0.37758 
Train Epoch: 9 [273/500 17472/32000 (55%)] Loss: 2.95929 (QuantReg: 14.24246) QuantErr: 14.24246 batch_time=0.38044 
Train Epoch: 9 [281/500 17984/32000 (56%)] Loss: 2.30628 (QuantReg: 14.38288) QuantErr: 14.38288 batch_time=0.38607 
Train Epoch: 9 [289/500 18496/32000 (58%)] Loss: 3.31920 (QuantReg: 14.14948) QuantErr: 14.14948 batch_time=0.37934 
Train Epoch: 9 [297/500 19008/32000 (59%)] Loss: 3.26067 (QuantReg: 14.32073) QuantErr: 14.32073 batch_time=0.38309 
Train Epoch: 9 [305/500 19520/32000 (61%)] Loss: 2.65169 (QuantReg: 14.13503) QuantErr: 14.13503 batch_time=0.38660 
Train Epoch: 9 [313/500 20032/32000 (63%)] Loss: 2.08499 (QuantReg: 14.41950) QuantErr: 14.41950 batch_time=0.37812 
Train Epoch: 9 [321/500 20544/32000 (64%)] Loss: 2.27392 (QuantReg: 14.22166) QuantErr: 14.22166 batch_time=0.38427 
Train Epoch: 9 [329/500 21056/32000 (66%)] Loss: 2.71040 (QuantReg: 14.30867) QuantErr: 14.30867 batch_time=0.37864 
Train Epoch: 9 [337/500 21568/32000 (67%)] Loss: 2.89785 (QuantReg: 14.55605) QuantErr: 14.55605 batch_time=0.40834 
Train Epoch: 9 [345/500 22080/32000 (69%)] Loss: 2.75237 (QuantReg: 14.04986) QuantErr: 14.04986 batch_time=0.38119 
Train Epoch: 9 [353/500 22592/32000 (71%)] Loss: 2.62261 (QuantReg: 14.29869) QuantErr: 14.29869 batch_time=0.38769 
Train Epoch: 9 [361/500 23104/32000 (72%)] Loss: 2.70629 (QuantReg: 14.42170) QuantErr: 14.42170 batch_time=0.38651 
Train Epoch: 9 [369/500 23616/32000 (74%)] Loss: 2.54390 (QuantReg: 14.12489) QuantErr: 14.12489 batch_time=0.39128 
Train Epoch: 9 [377/500 24128/32000 (75%)] Loss: 2.46944 (QuantReg: 14.00363) QuantErr: 14.00363 batch_time=0.38202 
Train Epoch: 9 [385/500 24640/32000 (77%)] Loss: 2.95808 (QuantReg: 13.82809) QuantErr: 13.82809 batch_time=0.40009 
Train Epoch: 9 [393/500 25152/32000 (79%)] Loss: 2.92500 (QuantReg: 14.23882) QuantErr: 14.23882 batch_time=0.38580 
Train Epoch: 9 [401/500 25664/32000 (80%)] Loss: 2.46851 (QuantReg: 14.22877) QuantErr: 14.22877 batch_time=0.37524 
Train Epoch: 9 [409/500 26176/32000 (82%)] Loss: 3.80268 (QuantReg: 14.27938) QuantErr: 14.27938 batch_time=0.39704 
Train Epoch: 9 [417/500 26688/32000 (83%)] Loss: 2.95624 (QuantReg: 14.04036) QuantErr: 14.04036 batch_time=0.38194 
Train Epoch: 9 [425/500 27200/32000 (85%)] Loss: 2.62492 (QuantReg: 14.51853) QuantErr: 14.51853 batch_time=0.38462 
Train Epoch: 9 [433/500 27712/32000 (87%)] Loss: 2.48395 (QuantReg: 14.27806) QuantErr: 14.27806 batch_time=0.37745 
Train Epoch: 9 [441/500 28224/32000 (88%)] Loss: 2.98292 (QuantReg: 14.33814) QuantErr: 14.33814 batch_time=0.38337 
Train Epoch: 9 [449/500 28736/32000 (90%)] Loss: 2.53343 (QuantReg: 14.20075) QuantErr: 14.20075 batch_time=0.40854 
Train Epoch: 9 [457/500 29248/32000 (91%)] Loss: 2.66412 (QuantReg: 14.79918) QuantErr: 14.79918 batch_time=0.37461 
Train Epoch: 9 [465/500 29760/32000 (93%)] Loss: 2.97056 (QuantReg: 14.53909) QuantErr: 14.53909 batch_time=0.37988 
Train Epoch: 9 [473/500 30272/32000 (95%)] Loss: 1.94230 (QuantReg: 14.42697) QuantErr: 14.42697 batch_time=0.37649 
Train Epoch: 9 [481/500 30784/32000 (96%)] Loss: 1.70621 (QuantReg: 14.27897) QuantErr: 14.27897 batch_time=0.37956 
Train Epoch: 9 [489/500 31296/32000 (98%)] Loss: 2.60095 (QuantReg: 14.06555) QuantErr: 14.06555 batch_time=0.38055 
Train Epoch: 9 [497/500 31808/32000 (99%)] Loss: 2.38563 (QuantReg: 14.34243) QuantErr: 14.34243 batch_time=0.37956 
Train Epoch: 9 codebook_update_time=2.54183
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch9.pth ...
Done in 4.781s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch9.pth ...
Done in 10.038s
removing stale ckpt [epoch 8] [took 0.01s]
 epoch          : 9
 loss           : 2.696582305192947
 quant_reg      : 14.076461233139039
 quant_err      : 14.076461233139039
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 4500
 LSMDC_full_test/t2v_metrics/R1: 11.7
 LSMDC_full_test/t2v_metrics/R5: 30.7
 LSMDC_full_test/t2v_metrics/R10: 39.7
 LSMDC_full_test/t2v_metrics/R50: 65.3
 LSMDC_full_test/t2v_metrics/MedR: 20.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.66
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.249618727841852
 LSMDC_full_test/v2t_metrics/R1: 12.1
 LSMDC_full_test/v2t_metrics/R5: 29.3
 LSMDC_full_test/v2t_metrics/R10: 38.1
 LSMDC_full_test/v2t_metrics/R50: 65.2
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.219
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.815479067357657
 mnt_best       : 24.249618727841852
 not_improved_count: 0
Train Epoch: 10 [1/500 64/32000 (0%)] Loss: 2.38319 (QuantReg: 13.92312) QuantErr: 13.92312 batch_time=15.13561 
Train Epoch: 10 [9/500 576/32000 (2%)] Loss: 2.79813 (QuantReg: 14.14908) QuantErr: 14.14908 batch_time=0.39153 
Train Epoch: 10 [17/500 1088/32000 (3%)] Loss: 2.98844 (QuantReg: 13.45017) QuantErr: 13.45017 batch_time=0.59827 
Train Epoch: 10 [25/500 1600/32000 (5%)] Loss: 2.38334 (QuantReg: 14.27310) QuantErr: 14.27310 batch_time=0.37954 
Train Epoch: 10 [33/500 2112/32000 (7%)] Loss: 2.34738 (QuantReg: 13.82353) QuantErr: 13.82353 batch_time=0.39270 
Train Epoch: 10 [41/500 2624/32000 (8%)] Loss: 2.13576 (QuantReg: 14.23799) QuantErr: 14.23799 batch_time=0.37816 
Train Epoch: 10 [49/500 3136/32000 (10%)] Loss: 3.25611 (QuantReg: 14.31309) QuantErr: 14.31309 batch_time=0.38359 
Train Epoch: 10 [57/500 3648/32000 (11%)] Loss: 2.83975 (QuantReg: 14.26864) QuantErr: 14.26864 batch_time=0.38610 
Train Epoch: 10 [65/500 4160/32000 (13%)] Loss: 2.23126 (QuantReg: 14.07948) QuantErr: 14.07948 batch_time=0.37358 
Train Epoch: 10 [73/500 4672/32000 (15%)] Loss: 2.27832 (QuantReg: 14.01409) QuantErr: 14.01409 batch_time=0.40965 
Train Epoch: 10 [81/500 5184/32000 (16%)] Loss: 2.85899 (QuantReg: 13.80491) QuantErr: 13.80491 batch_time=0.38582 
Train Epoch: 10 [89/500 5696/32000 (18%)] Loss: 2.53433 (QuantReg: 14.01811) QuantErr: 14.01811 batch_time=0.38708 
Train Epoch: 10 [97/500 6208/32000 (19%)] Loss: 2.55857 (QuantReg: 14.50263) QuantErr: 14.50263 batch_time=0.38479 
Train Epoch: 10 [105/500 6720/32000 (21%)] Loss: 2.73407 (QuantReg: 14.42308) QuantErr: 14.42308 batch_time=0.38463 
Train Epoch: 10 [113/500 7232/32000 (23%)] Loss: 2.53014 (QuantReg: 14.29047) QuantErr: 14.29047 batch_time=0.43576 
Train Epoch: 10 [121/500 7744/32000 (24%)] Loss: 2.59702 (QuantReg: 14.45029) QuantErr: 14.45029 batch_time=0.38681 
Train Epoch: 10 [129/500 8256/32000 (26%)] Loss: 2.81641 (QuantReg: 14.24161) QuantErr: 14.24161 batch_time=0.39139 
Train Epoch: 10 [137/500 8768/32000 (27%)] Loss: 2.68821 (QuantReg: 14.73629) QuantErr: 14.73629 batch_time=0.40880 
Train Epoch: 10 [145/500 9280/32000 (29%)] Loss: 3.06159 (QuantReg: 14.03115) QuantErr: 14.03115 batch_time=0.39143 
Train Epoch: 10 [153/500 9792/32000 (31%)] Loss: 2.94844 (QuantReg: 14.20221) QuantErr: 14.20221 batch_time=0.38326 
Train Epoch: 10 [161/500 10304/32000 (32%)] Loss: 2.13811 (QuantReg: 14.30527) QuantErr: 14.30527 batch_time=0.37896 
Train Epoch: 10 [169/500 10816/32000 (34%)] Loss: 2.03655 (QuantReg: 14.23055) QuantErr: 14.23055 batch_time=0.38373 
Train Epoch: 10 [177/500 11328/32000 (35%)] Loss: 2.17357 (QuantReg: 14.62422) QuantErr: 14.62422 batch_time=0.38200 
Train Epoch: 10 [185/500 11840/32000 (37%)] Loss: 2.06270 (QuantReg: 14.39385) QuantErr: 14.39385 batch_time=0.37772 
Train Epoch: 10 [193/500 12352/32000 (39%)] Loss: 2.72920 (QuantReg: 14.08885) QuantErr: 14.08885 batch_time=0.40284 
Train Epoch: 10 [201/500 12864/32000 (40%)] Loss: 2.27846 (QuantReg: 14.37754) QuantErr: 14.37754 batch_time=0.37703 
Train Epoch: 10 [209/500 13376/32000 (42%)] Loss: 2.87866 (QuantReg: 13.97042) QuantErr: 13.97042 batch_time=0.40785 
Train Epoch: 10 [217/500 13888/32000 (43%)] Loss: 2.35295 (QuantReg: 14.28240) QuantErr: 14.28240 batch_time=0.39072 
Train Epoch: 10 [225/500 14400/32000 (45%)] Loss: 1.98309 (QuantReg: 14.31842) QuantErr: 14.31842 batch_time=0.40041 
Train Epoch: 10 [233/500 14912/32000 (47%)] Loss: 2.33032 (QuantReg: 14.42127) QuantErr: 14.42127 batch_time=0.38435 
Train Epoch: 10 [241/500 15424/32000 (48%)] Loss: 3.02687 (QuantReg: 14.26702) QuantErr: 14.26702 batch_time=0.38473 
Train Epoch: 10 [249/500 15936/32000 (50%)] Loss: 3.17773 (QuantReg: 14.31298) QuantErr: 14.31298 batch_time=0.38397 
Train Epoch: 10 [257/500 16448/32000 (51%)] Loss: 2.83665 (QuantReg: 14.31761) QuantErr: 14.31761 batch_time=0.38513 
Train Epoch: 10 [265/500 16960/32000 (53%)] Loss: 2.10587 (QuantReg: 14.17685) QuantErr: 14.17685 batch_time=0.38018 
Train Epoch: 10 [273/500 17472/32000 (55%)] Loss: 2.48623 (QuantReg: 14.84487) QuantErr: 14.84487 batch_time=0.38114 
Train Epoch: 10 [281/500 17984/32000 (56%)] Loss: 2.56571 (QuantReg: 14.55435) QuantErr: 14.55435 batch_time=0.37576 
Train Epoch: 10 [289/500 18496/32000 (58%)] Loss: 2.39491 (QuantReg: 14.58133) QuantErr: 14.58133 batch_time=0.38028 
Train Epoch: 10 [297/500 19008/32000 (59%)] Loss: 2.95493 (QuantReg: 14.32964) QuantErr: 14.32964 batch_time=0.38725 
Train Epoch: 10 [305/500 19520/32000 (61%)] Loss: 2.24656 (QuantReg: 14.95438) QuantErr: 14.95438 batch_time=0.38085 
Train Epoch: 10 [313/500 20032/32000 (63%)] Loss: 3.07893 (QuantReg: 14.14033) QuantErr: 14.14033 batch_time=0.44109 
Train Epoch: 10 [321/500 20544/32000 (64%)] Loss: 2.32113 (QuantReg: 14.25769) QuantErr: 14.25769 batch_time=0.38085 
Train Epoch: 10 [329/500 21056/32000 (66%)] Loss: 2.76774 (QuantReg: 14.24730) QuantErr: 14.24730 batch_time=0.37883 
Train Epoch: 10 [337/500 21568/32000 (67%)] Loss: 2.68177 (QuantReg: 14.43617) QuantErr: 14.43617 batch_time=0.37950 
Train Epoch: 10 [345/500 22080/32000 (69%)] Loss: 2.16532 (QuantReg: 14.38450) QuantErr: 14.38450 batch_time=0.39129 
Train Epoch: 10 [353/500 22592/32000 (71%)] Loss: 3.19268 (QuantReg: 14.01260) QuantErr: 14.01260 batch_time=0.38283 
Train Epoch: 10 [361/500 23104/32000 (72%)] Loss: 2.13745 (QuantReg: 14.70680) QuantErr: 14.70680 batch_time=0.38263 
Train Epoch: 10 [369/500 23616/32000 (74%)] Loss: 2.50849 (QuantReg: 14.27865) QuantErr: 14.27865 batch_time=0.40031 
Train Epoch: 10 [377/500 24128/32000 (75%)] Loss: 2.13502 (QuantReg: 14.37540) QuantErr: 14.37540 batch_time=0.37793 
Train Epoch: 10 [385/500 24640/32000 (77%)] Loss: 2.56554 (QuantReg: 14.86024) QuantErr: 14.86024 batch_time=0.39247 
Train Epoch: 10 [393/500 25152/32000 (79%)] Loss: 2.03860 (QuantReg: 14.57357) QuantErr: 14.57357 batch_time=0.38534 
Train Epoch: 10 [401/500 25664/32000 (80%)] Loss: 2.55573 (QuantReg: 14.67816) QuantErr: 14.67816 batch_time=0.38219 
Train Epoch: 10 [409/500 26176/32000 (82%)] Loss: 2.52572 (QuantReg: 14.45948) QuantErr: 14.45948 batch_time=0.40130 
Train Epoch: 10 [417/500 26688/32000 (83%)] Loss: 2.81157 (QuantReg: 14.37395) QuantErr: 14.37395 batch_time=0.38180 
Train Epoch: 10 [425/500 27200/32000 (85%)] Loss: 2.48386 (QuantReg: 14.51894) QuantErr: 14.51894 batch_time=0.38439 
Train Epoch: 10 [433/500 27712/32000 (87%)] Loss: 3.17644 (QuantReg: 14.16530) QuantErr: 14.16530 batch_time=0.38720 
Train Epoch: 10 [441/500 28224/32000 (88%)] Loss: 2.09010 (QuantReg: 14.73640) QuantErr: 14.73640 batch_time=0.38473 
Train Epoch: 10 [449/500 28736/32000 (90%)] Loss: 2.32719 (QuantReg: 14.19029) QuantErr: 14.19029 batch_time=0.38102 
Train Epoch: 10 [457/500 29248/32000 (91%)] Loss: 3.02782 (QuantReg: 14.27093) QuantErr: 14.27093 batch_time=0.37858 
Train Epoch: 10 [465/500 29760/32000 (93%)] Loss: 2.86996 (QuantReg: 14.24334) QuantErr: 14.24334 batch_time=0.37981 
Train Epoch: 10 [473/500 30272/32000 (95%)] Loss: 2.17745 (QuantReg: 14.73497) QuantErr: 14.73497 batch_time=0.37916 
Train Epoch: 10 [481/500 30784/32000 (96%)] Loss: 2.40915 (QuantReg: 14.36500) QuantErr: 14.36500 batch_time=0.38796 
Train Epoch: 10 [489/500 31296/32000 (98%)] Loss: 2.59229 (QuantReg: 14.25948) QuantErr: 14.25948 batch_time=0.37710 
Train Epoch: 10 [497/500 31808/32000 (99%)] Loss: 2.24719 (QuantReg: 14.67951) QuantErr: 14.67951 batch_time=0.38096 
Train Epoch: 10 codebook_update_time=1.87469
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch10.pth ...
Done in 23.352s
removing stale ckpt [epoch 9] [took 0.01s]
 epoch          : 10
 loss           : 2.5631166622638704
 quant_reg      : 14.317087539672851
 quant_err      : 14.317087539672851
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 5000
 LSMDC_full_test/t2v_metrics/R1: 11.7
 LSMDC_full_test/t2v_metrics/R5: 27.3
 LSMDC_full_test/t2v_metrics/R10: 37.6
 LSMDC_full_test/t2v_metrics/R50: 66.9
 LSMDC_full_test/t2v_metrics/MedR: 21.0
 LSMDC_full_test/t2v_metrics/MeanR: 74.258
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.90052565805186
 LSMDC_full_test/v2t_metrics/R1: 12.0
 LSMDC_full_test/v2t_metrics/R5: 29.0
 LSMDC_full_test/v2t_metrics/R10: 38.4
 LSMDC_full_test/v2t_metrics/R50: 65.7
 LSMDC_full_test/v2t_metrics/MedR: 23.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.414
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.730314250759612
 mnt_best       : 24.249618727841852
 not_improved_count: 1
Train Epoch: 11 [1/500 64/32000 (0%)] Loss: 2.00085 (QuantReg: 14.31869) QuantErr: 14.31869 batch_time=16.56211 
Train Epoch: 11 [9/500 576/32000 (2%)] Loss: 2.39855 (QuantReg: 14.39292) QuantErr: 14.39292 batch_time=0.51378 
Train Epoch: 11 [17/500 1088/32000 (3%)] Loss: 1.91242 (QuantReg: 14.36240) QuantErr: 14.36240 batch_time=0.38423 
Train Epoch: 11 [25/500 1600/32000 (5%)] Loss: 2.82101 (QuantReg: 14.43468) QuantErr: 14.43468 batch_time=0.40221 
Train Epoch: 11 [33/500 2112/32000 (7%)] Loss: 3.08224 (QuantReg: 14.42267) QuantErr: 14.42267 batch_time=1.16003 
Train Epoch: 11 [41/500 2624/32000 (8%)] Loss: 2.54217 (QuantReg: 14.20299) QuantErr: 14.20299 batch_time=0.39520 
Train Epoch: 11 [49/500 3136/32000 (10%)] Loss: 2.21568 (QuantReg: 14.33748) QuantErr: 14.33748 batch_time=0.39431 
Train Epoch: 11 [57/500 3648/32000 (11%)] Loss: 2.71626 (QuantReg: 14.19972) QuantErr: 14.19972 batch_time=0.38831 
Train Epoch: 11 [65/500 4160/32000 (13%)] Loss: 2.25229 (QuantReg: 13.89861) QuantErr: 13.89861 batch_time=0.44246 
Train Epoch: 11 [73/500 4672/32000 (15%)] Loss: 2.30758 (QuantReg: 14.52953) QuantErr: 14.52953 batch_time=0.48900 
Train Epoch: 11 [81/500 5184/32000 (16%)] Loss: 1.77774 (QuantReg: 14.58539) QuantErr: 14.58539 batch_time=0.39011 
Train Epoch: 11 [89/500 5696/32000 (18%)] Loss: 2.60024 (QuantReg: 14.32081) QuantErr: 14.32081 batch_time=0.37790 
Train Epoch: 11 [97/500 6208/32000 (19%)] Loss: 2.31438 (QuantReg: 14.01924) QuantErr: 14.01924 batch_time=1.02621 
Train Epoch: 11 [105/500 6720/32000 (21%)] Loss: 2.11595 (QuantReg: 14.13169) QuantErr: 14.13169 batch_time=0.38241 
Train Epoch: 11 [113/500 7232/32000 (23%)] Loss: 2.66489 (QuantReg: 14.27236) QuantErr: 14.27236 batch_time=0.39497 
Train Epoch: 11 [121/500 7744/32000 (24%)] Loss: 1.95530 (QuantReg: 14.37877) QuantErr: 14.37877 batch_time=0.37804 
Train Epoch: 11 [129/500 8256/32000 (26%)] Loss: 2.75168 (QuantReg: 14.20092) QuantErr: 14.20092 batch_time=0.44030 
Train Epoch: 11 [137/500 8768/32000 (27%)] Loss: 2.71222 (QuantReg: 14.47655) QuantErr: 14.47655 batch_time=0.49168 
Train Epoch: 11 [145/500 9280/32000 (29%)] Loss: 2.64570 (QuantReg: 14.25562) QuantErr: 14.25562 batch_time=0.39007 
Train Epoch: 11 [153/500 9792/32000 (31%)] Loss: 2.18654 (QuantReg: 14.69786) QuantErr: 14.69786 batch_time=0.42249 
Train Epoch: 11 [161/500 10304/32000 (32%)] Loss: 2.91254 (QuantReg: 14.76688) QuantErr: 14.76688 batch_time=1.06853 
Train Epoch: 11 [169/500 10816/32000 (34%)] Loss: 2.78200 (QuantReg: 14.55633) QuantErr: 14.55633 batch_time=0.37728 
Train Epoch: 11 [177/500 11328/32000 (35%)] Loss: 2.68638 (QuantReg: 14.29405) QuantErr: 14.29405 batch_time=0.38546 
Train Epoch: 11 [185/500 11840/32000 (37%)] Loss: 2.14377 (QuantReg: 14.62763) QuantErr: 14.62763 batch_time=0.39552 
Train Epoch: 11 [193/500 12352/32000 (39%)] Loss: 1.52304 (QuantReg: 14.43424) QuantErr: 14.43424 batch_time=0.42189 
Train Epoch: 11 [201/500 12864/32000 (40%)] Loss: 2.83545 (QuantReg: 14.12903) QuantErr: 14.12903 batch_time=0.47548 
Train Epoch: 11 [209/500 13376/32000 (42%)] Loss: 2.42080 (QuantReg: 14.55643) QuantErr: 14.55643 batch_time=0.38143 
Train Epoch: 11 [217/500 13888/32000 (43%)] Loss: 2.59689 (QuantReg: 14.43051) QuantErr: 14.43051 batch_time=0.37612 
Train Epoch: 11 [225/500 14400/32000 (45%)] Loss: 2.24800 (QuantReg: 14.43953) QuantErr: 14.43953 batch_time=0.98498 
Train Epoch: 11 [233/500 14912/32000 (47%)] Loss: 2.40111 (QuantReg: 14.10639) QuantErr: 14.10639 batch_time=0.41376 
Train Epoch: 11 [241/500 15424/32000 (48%)] Loss: 2.49013 (QuantReg: 14.83849) QuantErr: 14.83849 batch_time=0.42469 
Train Epoch: 11 [249/500 15936/32000 (50%)] Loss: 3.41763 (QuantReg: 14.60659) QuantErr: 14.60659 batch_time=0.37934 
Train Epoch: 11 [257/500 16448/32000 (51%)] Loss: 2.40254 (QuantReg: 14.58679) QuantErr: 14.58679 batch_time=0.43606 
Train Epoch: 11 [265/500 16960/32000 (53%)] Loss: 3.12754 (QuantReg: 14.43244) QuantErr: 14.43244 batch_time=0.48524 
Train Epoch: 11 [273/500 17472/32000 (55%)] Loss: 3.05364 (QuantReg: 14.39771) QuantErr: 14.39771 batch_time=0.38758 
Train Epoch: 11 [281/500 17984/32000 (56%)] Loss: 3.03519 (QuantReg: 14.56369) QuantErr: 14.56369 batch_time=0.39479 
Train Epoch: 11 [289/500 18496/32000 (58%)] Loss: 2.74814 (QuantReg: 14.59690) QuantErr: 14.59690 batch_time=1.02308 
Train Epoch: 11 [297/500 19008/32000 (59%)] Loss: 2.77383 (QuantReg: 14.24864) QuantErr: 14.24864 batch_time=0.38777 
Train Epoch: 11 [305/500 19520/32000 (61%)] Loss: 2.08204 (QuantReg: 14.80251) QuantErr: 14.80251 batch_time=0.37574 
Train Epoch: 11 [313/500 20032/32000 (63%)] Loss: 2.58728 (QuantReg: 14.85762) QuantErr: 14.85762 batch_time=0.38126 
Train Epoch: 11 [321/500 20544/32000 (64%)] Loss: 2.02066 (QuantReg: 14.83877) QuantErr: 14.83877 batch_time=0.42698 
Train Epoch: 11 [329/500 21056/32000 (66%)] Loss: 2.45450 (QuantReg: 14.34570) QuantErr: 14.34570 batch_time=0.47892 
Train Epoch: 11 [337/500 21568/32000 (67%)] Loss: 2.62219 (QuantReg: 14.53300) QuantErr: 14.53300 batch_time=0.38303 
Train Epoch: 11 [345/500 22080/32000 (69%)] Loss: 2.12480 (QuantReg: 15.06044) QuantErr: 15.06044 batch_time=0.38008 
Train Epoch: 11 [353/500 22592/32000 (71%)] Loss: 2.36411 (QuantReg: 14.67797) QuantErr: 14.67797 batch_time=0.99929 
Train Epoch: 11 [361/500 23104/32000 (72%)] Loss: 2.01315 (QuantReg: 14.83912) QuantErr: 14.83912 batch_time=0.41395 
Train Epoch: 11 [369/500 23616/32000 (74%)] Loss: 2.70891 (QuantReg: 14.51284) QuantErr: 14.51284 batch_time=0.43422 
Train Epoch: 11 [377/500 24128/32000 (75%)] Loss: 1.84595 (QuantReg: 15.02059) QuantErr: 15.02059 batch_time=0.38727 
Train Epoch: 11 [385/500 24640/32000 (77%)] Loss: 1.67780 (QuantReg: 14.53455) QuantErr: 14.53455 batch_time=0.42770 
Train Epoch: 11 [393/500 25152/32000 (79%)] Loss: 2.34987 (QuantReg: 14.36265) QuantErr: 14.36265 batch_time=0.49810 
Train Epoch: 11 [401/500 25664/32000 (80%)] Loss: 2.38532 (QuantReg: 14.93989) QuantErr: 14.93989 batch_time=0.39439 
Train Epoch: 11 [409/500 26176/32000 (82%)] Loss: 2.19481 (QuantReg: 14.70870) QuantErr: 14.70870 batch_time=0.39803 
Train Epoch: 11 [417/500 26688/32000 (83%)] Loss: 2.17731 (QuantReg: 14.92038) QuantErr: 14.92038 batch_time=1.00678 
Train Epoch: 11 [425/500 27200/32000 (85%)] Loss: 2.10043 (QuantReg: 14.19477) QuantErr: 14.19477 batch_time=0.39305 
Train Epoch: 11 [433/500 27712/32000 (87%)] Loss: 2.38732 (QuantReg: 14.93100) QuantErr: 14.93100 batch_time=0.38205 
Train Epoch: 11 [441/500 28224/32000 (88%)] Loss: 2.19705 (QuantReg: 14.19463) QuantErr: 14.19463 batch_time=0.38329 
Train Epoch: 11 [449/500 28736/32000 (90%)] Loss: 2.17816 (QuantReg: 14.77490) QuantErr: 14.77490 batch_time=0.44231 
Train Epoch: 11 [457/500 29248/32000 (91%)] Loss: 2.65782 (QuantReg: 14.67746) QuantErr: 14.67746 batch_time=0.53302 
Train Epoch: 11 [465/500 29760/32000 (93%)] Loss: 2.71706 (QuantReg: 14.67842) QuantErr: 14.67842 batch_time=0.42284 
Train Epoch: 11 [473/500 30272/32000 (95%)] Loss: 2.63054 (QuantReg: 14.85598) QuantErr: 14.85598 batch_time=0.37115 
Train Epoch: 11 [481/500 30784/32000 (96%)] Loss: 2.20249 (QuantReg: 14.51333) QuantErr: 14.51333 batch_time=0.99679 
Train Epoch: 11 [489/500 31296/32000 (98%)] Loss: 2.60194 (QuantReg: 14.53706) QuantErr: 14.53706 batch_time=0.37397 
Train Epoch: 11 [497/500 31808/32000 (99%)] Loss: 2.09438 (QuantReg: 14.71118) QuantErr: 14.71118 batch_time=0.37867 
Train Epoch: 11 codebook_update_time=2.28021
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch11.pth ...
Done in 5.692s
removing stale ckpt [epoch 10] [took 0.04s]
 epoch          : 11
 loss           : 2.4034109740257263
 quant_reg      : 14.540584278106689
 quant_err      : 14.540584278106689
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 5500
 LSMDC_full_test/t2v_metrics/R1: 11.3
 LSMDC_full_test/t2v_metrics/R5: 28.4
 LSMDC_full_test/t2v_metrics/R10: 38.9
 LSMDC_full_test/t2v_metrics/R50: 66.6
 LSMDC_full_test/t2v_metrics/MedR: 20.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.054
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.19790656893481
 LSMDC_full_test/v2t_metrics/R1: 11.7
 LSMDC_full_test/v2t_metrics/R5: 29.2
 LSMDC_full_test/v2t_metrics/R10: 38.0
 LSMDC_full_test/v2t_metrics/R50: 65.5
 LSMDC_full_test/v2t_metrics/MedR: 23.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.23
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.50268265738151
 mnt_best       : 24.249618727841852
 not_improved_count: 2
Train Epoch: 12 [1/500 64/32000 (0%)] Loss: 2.36491 (QuantReg: 14.08626) QuantErr: 14.08626 batch_time=16.79343 
Train Epoch: 12 [9/500 576/32000 (2%)] Loss: 2.54830 (QuantReg: 14.42247) QuantErr: 14.42247 batch_time=0.38315 
Train Epoch: 12 [17/500 1088/32000 (3%)] Loss: 2.76248 (QuantReg: 13.95357) QuantErr: 13.95357 batch_time=0.37942 
Train Epoch: 12 [25/500 1600/32000 (5%)] Loss: 2.58964 (QuantReg: 14.10095) QuantErr: 14.10095 batch_time=0.38113 
Train Epoch: 12 [33/500 2112/32000 (7%)] Loss: 2.70973 (QuantReg: 14.28123) QuantErr: 14.28123 batch_time=0.41775 
Train Epoch: 12 [41/500 2624/32000 (8%)] Loss: 2.24848 (QuantReg: 14.18183) QuantErr: 14.18183 batch_time=0.38460 
Train Epoch: 12 [49/500 3136/32000 (10%)] Loss: 2.13636 (QuantReg: 14.51274) QuantErr: 14.51274 batch_time=0.39361 
Train Epoch: 12 [57/500 3648/32000 (11%)] Loss: 2.21665 (QuantReg: 14.41626) QuantErr: 14.41626 batch_time=0.38986 
Train Epoch: 12 [65/500 4160/32000 (13%)] Loss: 2.80882 (QuantReg: 14.53613) QuantErr: 14.53613 batch_time=0.78398 
Train Epoch: 12 [73/500 4672/32000 (15%)] Loss: 2.36939 (QuantReg: 14.48679) QuantErr: 14.48679 batch_time=0.38727 
Train Epoch: 12 [81/500 5184/32000 (16%)] Loss: 1.79665 (QuantReg: 14.46930) QuantErr: 14.46930 batch_time=0.41009 
Train Epoch: 12 [89/500 5696/32000 (18%)] Loss: 2.67576 (QuantReg: 14.41105) QuantErr: 14.41105 batch_time=0.38804 
Train Epoch: 12 [97/500 6208/32000 (19%)] Loss: 2.40232 (QuantReg: 14.61021) QuantErr: 14.61021 batch_time=0.39427 
Train Epoch: 12 [105/500 6720/32000 (21%)] Loss: 2.70482 (QuantReg: 14.28931) QuantErr: 14.28931 batch_time=0.39656 
Train Epoch: 12 [113/500 7232/32000 (23%)] Loss: 1.99190 (QuantReg: 14.70639) QuantErr: 14.70639 batch_time=0.38894 
Train Epoch: 12 [121/500 7744/32000 (24%)] Loss: 2.15658 (QuantReg: 14.22079) QuantErr: 14.22079 batch_time=0.39963 
Train Epoch: 12 [129/500 8256/32000 (26%)] Loss: 2.30396 (QuantReg: 14.35822) QuantErr: 14.35822 batch_time=0.73451 
Train Epoch: 12 [137/500 8768/32000 (27%)] Loss: 2.50452 (QuantReg: 14.29158) QuantErr: 14.29158 batch_time=0.38397 
Train Epoch: 12 [145/500 9280/32000 (29%)] Loss: 2.63798 (QuantReg: 14.35732) QuantErr: 14.35732 batch_time=0.39915 
Train Epoch: 12 [153/500 9792/32000 (31%)] Loss: 2.46019 (QuantReg: 14.30517) QuantErr: 14.30517 batch_time=0.39658 
Train Epoch: 12 [161/500 10304/32000 (32%)] Loss: 1.70456 (QuantReg: 14.67196) QuantErr: 14.67196 batch_time=0.38729 
Train Epoch: 12 [169/500 10816/32000 (34%)] Loss: 2.51122 (QuantReg: 14.42314) QuantErr: 14.42314 batch_time=0.39605 
Train Epoch: 12 [177/500 11328/32000 (35%)] Loss: 2.43490 (QuantReg: 14.31633) QuantErr: 14.31633 batch_time=0.39305 
Train Epoch: 12 [185/500 11840/32000 (37%)] Loss: 2.39880 (QuantReg: 14.54176) QuantErr: 14.54176 batch_time=0.39226 
Train Epoch: 12 [193/500 12352/32000 (39%)] Loss: 2.31122 (QuantReg: 14.56024) QuantErr: 14.56024 batch_time=0.76124 
Train Epoch: 12 [201/500 12864/32000 (40%)] Loss: 2.25031 (QuantReg: 14.83165) QuantErr: 14.83165 batch_time=0.39267 
Train Epoch: 12 [209/500 13376/32000 (42%)] Loss: 2.22016 (QuantReg: 14.69517) QuantErr: 14.69517 batch_time=0.40900 
Train Epoch: 12 [217/500 13888/32000 (43%)] Loss: 2.65518 (QuantReg: 14.54850) QuantErr: 14.54850 batch_time=0.39106 
Train Epoch: 12 [225/500 14400/32000 (45%)] Loss: 2.49931 (QuantReg: 14.65189) QuantErr: 14.65189 batch_time=0.38775 
Train Epoch: 12 [233/500 14912/32000 (47%)] Loss: 2.49722 (QuantReg: 14.75223) QuantErr: 14.75223 batch_time=0.40121 
Train Epoch: 12 [241/500 15424/32000 (48%)] Loss: 2.59566 (QuantReg: 14.62925) QuantErr: 14.62925 batch_time=0.40494 
Train Epoch: 12 [249/500 15936/32000 (50%)] Loss: 2.01354 (QuantReg: 14.77736) QuantErr: 14.77736 batch_time=0.39384 
Train Epoch: 12 [257/500 16448/32000 (51%)] Loss: 1.50280 (QuantReg: 14.75715) QuantErr: 14.75715 batch_time=0.80528 
Train Epoch: 12 [265/500 16960/32000 (53%)] Loss: 3.00171 (QuantReg: 14.43616) QuantErr: 14.43616 batch_time=0.38297 
Train Epoch: 12 [273/500 17472/32000 (55%)] Loss: 2.13258 (QuantReg: 14.16166) QuantErr: 14.16166 batch_time=0.38046 
Train Epoch: 12 [281/500 17984/32000 (56%)] Loss: 2.75866 (QuantReg: 14.39010) QuantErr: 14.39010 batch_time=0.39582 
Train Epoch: 12 [289/500 18496/32000 (58%)] Loss: 2.07016 (QuantReg: 14.56389) QuantErr: 14.56389 batch_time=0.39530 
Train Epoch: 12 [297/500 19008/32000 (59%)] Loss: 2.32881 (QuantReg: 14.30266) QuantErr: 14.30266 batch_time=0.38756 
Train Epoch: 12 [305/500 19520/32000 (61%)] Loss: 2.91115 (QuantReg: 14.40507) QuantErr: 14.40507 batch_time=0.43402 
Train Epoch: 12 [313/500 20032/32000 (63%)] Loss: 1.93835 (QuantReg: 14.47477) QuantErr: 14.47477 batch_time=0.41698 
Train Epoch: 12 [321/500 20544/32000 (64%)] Loss: 2.08457 (QuantReg: 14.58827) QuantErr: 14.58827 batch_time=0.76317 
Train Epoch: 12 [329/500 21056/32000 (66%)] Loss: 2.46670 (QuantReg: 14.63509) QuantErr: 14.63509 batch_time=0.39390 
Train Epoch: 12 [337/500 21568/32000 (67%)] Loss: 2.26411 (QuantReg: 14.57397) QuantErr: 14.57397 batch_time=0.37555 
Train Epoch: 12 [345/500 22080/32000 (69%)] Loss: 1.87902 (QuantReg: 14.82068) QuantErr: 14.82068 batch_time=0.40930 
Train Epoch: 12 [353/500 22592/32000 (71%)] Loss: 1.29658 (QuantReg: 14.94654) QuantErr: 14.94654 batch_time=0.38782 
Train Epoch: 12 [361/500 23104/32000 (72%)] Loss: 3.06909 (QuantReg: 14.19485) QuantErr: 14.19485 batch_time=0.39441 
Train Epoch: 12 [369/500 23616/32000 (74%)] Loss: 2.06703 (QuantReg: 14.83034) QuantErr: 14.83034 batch_time=0.43094 
Train Epoch: 12 [377/500 24128/32000 (75%)] Loss: 2.30887 (QuantReg: 14.38400) QuantErr: 14.38400 batch_time=0.38993 
Train Epoch: 12 [385/500 24640/32000 (77%)] Loss: 2.38382 (QuantReg: 14.62979) QuantErr: 14.62979 batch_time=0.79098 
Train Epoch: 12 [393/500 25152/32000 (79%)] Loss: 2.47977 (QuantReg: 14.50513) QuantErr: 14.50513 batch_time=0.38837 
Train Epoch: 12 [401/500 25664/32000 (80%)] Loss: 2.05628 (QuantReg: 14.64085) QuantErr: 14.64085 batch_time=0.37724 
Train Epoch: 12 [409/500 26176/32000 (82%)] Loss: 2.23309 (QuantReg: 14.49016) QuantErr: 14.49016 batch_time=0.38771 
Train Epoch: 12 [417/500 26688/32000 (83%)] Loss: 2.22765 (QuantReg: 14.72473) QuantErr: 14.72473 batch_time=0.40638 
Train Epoch: 12 [425/500 27200/32000 (85%)] Loss: 1.99740 (QuantReg: 15.03377) QuantErr: 15.03377 batch_time=0.37921 
Train Epoch: 12 [433/500 27712/32000 (87%)] Loss: 2.02831 (QuantReg: 14.62353) QuantErr: 14.62353 batch_time=0.38185 
Train Epoch: 12 [441/500 28224/32000 (88%)] Loss: 2.21246 (QuantReg: 14.67835) QuantErr: 14.67835 batch_time=0.40676 
Train Epoch: 12 [449/500 28736/32000 (90%)] Loss: 2.51294 (QuantReg: 14.67832) QuantErr: 14.67832 batch_time=0.77993 
Train Epoch: 12 [457/500 29248/32000 (91%)] Loss: 1.77820 (QuantReg: 14.56333) QuantErr: 14.56333 batch_time=0.38916 
Train Epoch: 12 [465/500 29760/32000 (93%)] Loss: 1.83217 (QuantReg: 14.77625) QuantErr: 14.77625 batch_time=0.38482 
Train Epoch: 12 [473/500 30272/32000 (95%)] Loss: 2.39812 (QuantReg: 14.68052) QuantErr: 14.68052 batch_time=0.38817 
Train Epoch: 12 [481/500 30784/32000 (96%)] Loss: 2.43156 (QuantReg: 14.87083) QuantErr: 14.87083 batch_time=0.39787 
Train Epoch: 12 [489/500 31296/32000 (98%)] Loss: 2.17862 (QuantReg: 14.82890) QuantErr: 14.82890 batch_time=0.38907 
Train Epoch: 12 [497/500 31808/32000 (99%)] Loss: 2.30714 (QuantReg: 14.87310) QuantErr: 14.87310 batch_time=0.39239 
Train Epoch: 12 codebook_update_time=1.92254
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch12.pth ...
Done in 4.677s
removing stale ckpt [epoch 11] [took 0.04s]
 epoch          : 12
 loss           : 2.3066898217201235
 quant_reg      : 14.556703565597534
 quant_err      : 14.556703565597534
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 6000
 LSMDC_full_test/t2v_metrics/R1: 11.8
 LSMDC_full_test/t2v_metrics/R5: 29.3
 LSMDC_full_test/t2v_metrics/R10: 39.5
 LSMDC_full_test/t2v_metrics/R50: 67.5
 LSMDC_full_test/t2v_metrics/MedR: 19.5
 LSMDC_full_test/t2v_metrics/MeanR: 71.815
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.902807160805427
 LSMDC_full_test/v2t_metrics/R1: 11.9
 LSMDC_full_test/v2t_metrics/R5: 27.9
 LSMDC_full_test/v2t_metrics/R10: 38.2
 LSMDC_full_test/v2t_metrics/R50: 65.6
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.297
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.320517088724735
 mnt_best       : 24.249618727841852
 not_improved_count: 3
Train Epoch: 13 [1/500 64/32000 (0%)] Loss: 1.77361 (QuantReg: 14.67812) QuantErr: 14.67812 batch_time=16.13040 
Train Epoch: 13 [9/500 576/32000 (2%)] Loss: 1.95319 (QuantReg: 14.41616) QuantErr: 14.41616 batch_time=0.98816 
Train Epoch: 13 [17/500 1088/32000 (3%)] Loss: 2.56388 (QuantReg: 14.64410) QuantErr: 14.64410 batch_time=1.49352 
Train Epoch: 13 [25/500 1600/32000 (5%)] Loss: 2.08625 (QuantReg: 14.87036) QuantErr: 14.87036 batch_time=0.37912 
Train Epoch: 13 [33/500 2112/32000 (7%)] Loss: 2.18658 (QuantReg: 14.82499) QuantErr: 14.82499 batch_time=0.39148 
Train Epoch: 13 [41/500 2624/32000 (8%)] Loss: 2.23656 (QuantReg: 14.67547) QuantErr: 14.67547 batch_time=0.38324 
Train Epoch: 13 [49/500 3136/32000 (10%)] Loss: 2.17362 (QuantReg: 14.67221) QuantErr: 14.67221 batch_time=0.37896 
Train Epoch: 13 [57/500 3648/32000 (11%)] Loss: 2.23674 (QuantReg: 14.56796) QuantErr: 14.56796 batch_time=0.38673 
Train Epoch: 13 [65/500 4160/32000 (13%)] Loss: 2.83739 (QuantReg: 14.77178) QuantErr: 14.77178 batch_time=0.50210 
Train Epoch: 13 [73/500 4672/32000 (15%)] Loss: 1.44175 (QuantReg: 14.96197) QuantErr: 14.96197 batch_time=0.87174 
Train Epoch: 13 [81/500 5184/32000 (16%)] Loss: 2.72450 (QuantReg: 14.72573) QuantErr: 14.72573 batch_time=1.13601 
Train Epoch: 13 [89/500 5696/32000 (18%)] Loss: 2.36193 (QuantReg: 14.44437) QuantErr: 14.44437 batch_time=0.42220 
Train Epoch: 13 [97/500 6208/32000 (19%)] Loss: 1.87918 (QuantReg: 14.67001) QuantErr: 14.67001 batch_time=0.41762 
Train Epoch: 13 [105/500 6720/32000 (21%)] Loss: 2.21732 (QuantReg: 14.71955) QuantErr: 14.71955 batch_time=0.38750 
Train Epoch: 13 [113/500 7232/32000 (23%)] Loss: 1.90818 (QuantReg: 14.75183) QuantErr: 14.75183 batch_time=0.38545 
Train Epoch: 13 [121/500 7744/32000 (24%)] Loss: 2.88485 (QuantReg: 14.62644) QuantErr: 14.62644 batch_time=0.43679 
Train Epoch: 13 [129/500 8256/32000 (26%)] Loss: 2.27711 (QuantReg: 14.71624) QuantErr: 14.71624 batch_time=0.47490 
Train Epoch: 13 [137/500 8768/32000 (27%)] Loss: 1.69368 (QuantReg: 14.88990) QuantErr: 14.88990 batch_time=0.87891 
Train Epoch: 13 [145/500 9280/32000 (29%)] Loss: 2.58293 (QuantReg: 14.42345) QuantErr: 14.42345 batch_time=1.15704 
Train Epoch: 13 [153/500 9792/32000 (31%)] Loss: 2.23593 (QuantReg: 14.85140) QuantErr: 14.85140 batch_time=0.39512 
Train Epoch: 13 [161/500 10304/32000 (32%)] Loss: 2.60110 (QuantReg: 14.74394) QuantErr: 14.74394 batch_time=0.38787 
Train Epoch: 13 [169/500 10816/32000 (34%)] Loss: 1.75140 (QuantReg: 14.57882) QuantErr: 14.57882 batch_time=0.39402 
Train Epoch: 13 [177/500 11328/32000 (35%)] Loss: 2.21165 (QuantReg: 14.85857) QuantErr: 14.85857 batch_time=0.38671 
Train Epoch: 13 [185/500 11840/32000 (37%)] Loss: 2.40430 (QuantReg: 14.87527) QuantErr: 14.87527 batch_time=0.38208 
Train Epoch: 13 [193/500 12352/32000 (39%)] Loss: 1.63400 (QuantReg: 14.82186) QuantErr: 14.82186 batch_time=0.50042 
Train Epoch: 13 [201/500 12864/32000 (40%)] Loss: 2.85066 (QuantReg: 14.74823) QuantErr: 14.74823 batch_time=0.91353 
Train Epoch: 13 [209/500 13376/32000 (42%)] Loss: 2.41803 (QuantReg: 14.81657) QuantErr: 14.81657 batch_time=1.16144 
Train Epoch: 13 [217/500 13888/32000 (43%)] Loss: 2.47599 (QuantReg: 14.93271) QuantErr: 14.93271 batch_time=0.41125 
Train Epoch: 13 [225/500 14400/32000 (45%)] Loss: 3.03752 (QuantReg: 14.59210) QuantErr: 14.59210 batch_time=0.41566 
Train Epoch: 13 [233/500 14912/32000 (47%)] Loss: 2.34651 (QuantReg: 14.64078) QuantErr: 14.64078 batch_time=0.39658 
Train Epoch: 13 [241/500 15424/32000 (48%)] Loss: 2.11752 (QuantReg: 14.89894) QuantErr: 14.89894 batch_time=0.37902 
Train Epoch: 13 [249/500 15936/32000 (50%)] Loss: 1.73098 (QuantReg: 14.74116) QuantErr: 14.74116 batch_time=0.42225 
Train Epoch: 13 [257/500 16448/32000 (51%)] Loss: 2.15097 (QuantReg: 14.67322) QuantErr: 14.67322 batch_time=0.50446 
Train Epoch: 13 [265/500 16960/32000 (53%)] Loss: 1.99763 (QuantReg: 14.59981) QuantErr: 14.59981 batch_time=0.87711 
Train Epoch: 13 [273/500 17472/32000 (55%)] Loss: 2.35895 (QuantReg: 15.38641) QuantErr: 15.38641 batch_time=1.18013 
Train Epoch: 13 [281/500 17984/32000 (56%)] Loss: 2.06470 (QuantReg: 14.86470) QuantErr: 14.86470 batch_time=0.43336 
Train Epoch: 13 [289/500 18496/32000 (58%)] Loss: 1.93149 (QuantReg: 14.80733) QuantErr: 14.80733 batch_time=0.38284 
Train Epoch: 13 [297/500 19008/32000 (59%)] Loss: 1.76389 (QuantReg: 14.97459) QuantErr: 14.97459 batch_time=0.38649 
Train Epoch: 13 [305/500 19520/32000 (61%)] Loss: 2.28583 (QuantReg: 14.89452) QuantErr: 14.89452 batch_time=0.39314 
Train Epoch: 13 [313/500 20032/32000 (63%)] Loss: 2.00569 (QuantReg: 14.89640) QuantErr: 14.89640 batch_time=0.40445 
Train Epoch: 13 [321/500 20544/32000 (64%)] Loss: 2.33642 (QuantReg: 14.78445) QuantErr: 14.78445 batch_time=0.48716 
Train Epoch: 13 [329/500 21056/32000 (66%)] Loss: 1.86206 (QuantReg: 14.93164) QuantErr: 14.93164 batch_time=0.86419 
Train Epoch: 13 [337/500 21568/32000 (67%)] Loss: 2.12003 (QuantReg: 14.65929) QuantErr: 14.65929 batch_time=1.13050 
Train Epoch: 13 [345/500 22080/32000 (69%)] Loss: 2.31750 (QuantReg: 14.87775) QuantErr: 14.87775 batch_time=0.38256 
Train Epoch: 13 [353/500 22592/32000 (71%)] Loss: 2.36551 (QuantReg: 14.54003) QuantErr: 14.54003 batch_time=0.38352 
Train Epoch: 13 [361/500 23104/32000 (72%)] Loss: 2.24432 (QuantReg: 14.88593) QuantErr: 14.88593 batch_time=0.38127 
Train Epoch: 13 [369/500 23616/32000 (74%)] Loss: 1.73242 (QuantReg: 14.96978) QuantErr: 14.96978 batch_time=0.39009 
Train Epoch: 13 [377/500 24128/32000 (75%)] Loss: 2.62768 (QuantReg: 14.64697) QuantErr: 14.64697 batch_time=0.39632 
Train Epoch: 13 [385/500 24640/32000 (77%)] Loss: 1.78808 (QuantReg: 14.96361) QuantErr: 14.96361 batch_time=0.50467 
Train Epoch: 13 [393/500 25152/32000 (79%)] Loss: 1.74610 (QuantReg: 14.81405) QuantErr: 14.81405 batch_time=0.84846 
Train Epoch: 13 [401/500 25664/32000 (80%)] Loss: 2.50348 (QuantReg: 14.69467) QuantErr: 14.69467 batch_time=1.15468 
Train Epoch: 13 [409/500 26176/32000 (82%)] Loss: 1.97491 (QuantReg: 14.76518) QuantErr: 14.76518 batch_time=0.37901 
Train Epoch: 13 [417/500 26688/32000 (83%)] Loss: 1.90099 (QuantReg: 14.90958) QuantErr: 14.90958 batch_time=0.38308 
Train Epoch: 13 [425/500 27200/32000 (85%)] Loss: 2.44515 (QuantReg: 14.74838) QuantErr: 14.74838 batch_time=0.38297 
Train Epoch: 13 [433/500 27712/32000 (87%)] Loss: 1.66066 (QuantReg: 15.24809) QuantErr: 15.24809 batch_time=0.38880 
Train Epoch: 13 [441/500 28224/32000 (88%)] Loss: 2.05491 (QuantReg: 14.62394) QuantErr: 14.62394 batch_time=0.38047 
Train Epoch: 13 [449/500 28736/32000 (90%)] Loss: 2.55191 (QuantReg: 14.73524) QuantErr: 14.73524 batch_time=0.47202 
Train Epoch: 13 [457/500 29248/32000 (91%)] Loss: 2.19149 (QuantReg: 14.97298) QuantErr: 14.97298 batch_time=0.89299 
Train Epoch: 13 [465/500 29760/32000 (93%)] Loss: 2.14870 (QuantReg: 14.92013) QuantErr: 14.92013 batch_time=1.16050 
Train Epoch: 13 [473/500 30272/32000 (95%)] Loss: 1.94525 (QuantReg: 14.95274) QuantErr: 14.95274 batch_time=0.38128 
Train Epoch: 13 [481/500 30784/32000 (96%)] Loss: 2.66668 (QuantReg: 15.06698) QuantErr: 15.06698 batch_time=0.37701 
Train Epoch: 13 [489/500 31296/32000 (98%)] Loss: 2.02925 (QuantReg: 15.07888) QuantErr: 15.07888 batch_time=0.37718 
Train Epoch: 13 [497/500 31808/32000 (99%)] Loss: 1.92606 (QuantReg: 14.95905) QuantErr: 14.95905 batch_time=0.37122 
Train Epoch: 13 codebook_update_time=1.85376
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch13.pth ...
Done in 4.983s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch13.pth ...
Done in 9.828s
removing stale ckpt [epoch 12] [took 0.02s]
 epoch          : 13
 loss           : 2.1637600920200346
 quant_reg      : 14.820752084732055
 quant_err      : 14.820752084732055
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 6500
 LSMDC_full_test/t2v_metrics/R1: 12.6
 LSMDC_full_test/t2v_metrics/R5: 29.9
 LSMDC_full_test/t2v_metrics/R10: 39.6
 LSMDC_full_test/t2v_metrics/R50: 65.7
 LSMDC_full_test/t2v_metrics/MedR: 21.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.276
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.61759597721429
 LSMDC_full_test/v2t_metrics/R1: 11.7
 LSMDC_full_test/v2t_metrics/R5: 28.8
 LSMDC_full_test/v2t_metrics/R10: 39.8
 LSMDC_full_test/v2t_metrics/R50: 65.7
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.11
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.758579651856305
 mnt_best       : 24.61759597721429
 not_improved_count: 0
Train Epoch: 14 [1/500 64/32000 (0%)] Loss: 2.33084 (QuantReg: 15.07623) QuantErr: 15.07623 batch_time=17.18889 
Train Epoch: 14 [9/500 576/32000 (2%)] Loss: 1.95390 (QuantReg: 14.98884) QuantErr: 14.98884 batch_time=0.37625 
Train Epoch: 14 [17/500 1088/32000 (3%)] Loss: 2.13817 (QuantReg: 14.87448) QuantErr: 14.87448 batch_time=3.78886 
Train Epoch: 14 [25/500 1600/32000 (5%)] Loss: 1.85826 (QuantReg: 14.77176) QuantErr: 14.77176 batch_time=0.37615 
Train Epoch: 14 [33/500 2112/32000 (7%)] Loss: 1.75432 (QuantReg: 15.04258) QuantErr: 15.04258 batch_time=0.37416 
Train Epoch: 14 [41/500 2624/32000 (8%)] Loss: 1.84763 (QuantReg: 14.59209) QuantErr: 14.59209 batch_time=0.38605 
Train Epoch: 14 [49/500 3136/32000 (10%)] Loss: 2.42192 (QuantReg: 14.38523) QuantErr: 14.38523 batch_time=0.37418 
Train Epoch: 14 [57/500 3648/32000 (11%)] Loss: 1.96083 (QuantReg: 14.75130) QuantErr: 14.75130 batch_time=0.37780 
Train Epoch: 14 [65/500 4160/32000 (13%)] Loss: 2.39644 (QuantReg: 14.76337) QuantErr: 14.76337 batch_time=0.86602 
Train Epoch: 14 [73/500 4672/32000 (15%)] Loss: 1.49553 (QuantReg: 14.95988) QuantErr: 14.95988 batch_time=0.38293 
Train Epoch: 14 [81/500 5184/32000 (16%)] Loss: 1.98671 (QuantReg: 14.80528) QuantErr: 14.80528 batch_time=2.81210 
Train Epoch: 14 [89/500 5696/32000 (18%)] Loss: 1.57900 (QuantReg: 14.87258) QuantErr: 14.87258 batch_time=0.37768 
Train Epoch: 14 [97/500 6208/32000 (19%)] Loss: 2.40309 (QuantReg: 15.09140) QuantErr: 15.09140 batch_time=0.38674 
Train Epoch: 14 [105/500 6720/32000 (21%)] Loss: 1.57519 (QuantReg: 14.72693) QuantErr: 14.72693 batch_time=0.42237 
Train Epoch: 14 [113/500 7232/32000 (23%)] Loss: 1.68507 (QuantReg: 15.17285) QuantErr: 15.17285 batch_time=0.37596 
Train Epoch: 14 [121/500 7744/32000 (24%)] Loss: 2.01783 (QuantReg: 14.81830) QuantErr: 14.81830 batch_time=0.38156 
Train Epoch: 14 [129/500 8256/32000 (26%)] Loss: 1.74513 (QuantReg: 15.03320) QuantErr: 15.03320 batch_time=0.85244 
Train Epoch: 14 [137/500 8768/32000 (27%)] Loss: 1.78180 (QuantReg: 15.14880) QuantErr: 15.14880 batch_time=0.37952 
Train Epoch: 14 [145/500 9280/32000 (29%)] Loss: 1.78526 (QuantReg: 15.30976) QuantErr: 15.30976 batch_time=2.82075 
Train Epoch: 14 [153/500 9792/32000 (31%)] Loss: 2.20498 (QuantReg: 15.07307) QuantErr: 15.07307 batch_time=0.37109 
Train Epoch: 14 [161/500 10304/32000 (32%)] Loss: 2.04126 (QuantReg: 14.90178) QuantErr: 14.90178 batch_time=0.37103 
Train Epoch: 14 [169/500 10816/32000 (34%)] Loss: 2.38060 (QuantReg: 14.82069) QuantErr: 14.82069 batch_time=0.37707 
Train Epoch: 14 [177/500 11328/32000 (35%)] Loss: 2.05529 (QuantReg: 15.06149) QuantErr: 15.06149 batch_time=0.38716 
Train Epoch: 14 [185/500 11840/32000 (37%)] Loss: 2.58627 (QuantReg: 15.17443) QuantErr: 15.17443 batch_time=0.41798 
Train Epoch: 14 [193/500 12352/32000 (39%)] Loss: 2.61186 (QuantReg: 14.99569) QuantErr: 14.99569 batch_time=0.88402 
Train Epoch: 14 [201/500 12864/32000 (40%)] Loss: 2.73184 (QuantReg: 15.28290) QuantErr: 15.28290 batch_time=0.39384 
Train Epoch: 14 [209/500 13376/32000 (42%)] Loss: 1.88063 (QuantReg: 15.16170) QuantErr: 15.16170 batch_time=2.86077 
Train Epoch: 14 [217/500 13888/32000 (43%)] Loss: 2.21870 (QuantReg: 14.81370) QuantErr: 14.81370 batch_time=0.38628 
Train Epoch: 14 [225/500 14400/32000 (45%)] Loss: 2.19695 (QuantReg: 14.77023) QuantErr: 14.77023 batch_time=0.37491 
Train Epoch: 14 [233/500 14912/32000 (47%)] Loss: 1.69122 (QuantReg: 15.02805) QuantErr: 15.02805 batch_time=0.38387 
Train Epoch: 14 [241/500 15424/32000 (48%)] Loss: 2.08607 (QuantReg: 15.21667) QuantErr: 15.21667 batch_time=0.38489 
Train Epoch: 14 [249/500 15936/32000 (50%)] Loss: 1.86605 (QuantReg: 14.69021) QuantErr: 14.69021 batch_time=0.39988 
Train Epoch: 14 [257/500 16448/32000 (51%)] Loss: 2.88468 (QuantReg: 14.68022) QuantErr: 14.68022 batch_time=0.85348 
Train Epoch: 14 [265/500 16960/32000 (53%)] Loss: 2.17281 (QuantReg: 14.89898) QuantErr: 14.89898 batch_time=0.40170 
Train Epoch: 14 [273/500 17472/32000 (55%)] Loss: 1.92627 (QuantReg: 14.73534) QuantErr: 14.73534 batch_time=2.88389 
Train Epoch: 14 [281/500 17984/32000 (56%)] Loss: 2.11010 (QuantReg: 15.00739) QuantErr: 15.00739 batch_time=0.38804 
Train Epoch: 14 [289/500 18496/32000 (58%)] Loss: 1.90286 (QuantReg: 15.12520) QuantErr: 15.12520 batch_time=0.37983 
Train Epoch: 14 [297/500 19008/32000 (59%)] Loss: 2.27748 (QuantReg: 14.57980) QuantErr: 14.57980 batch_time=0.38093 
Train Epoch: 14 [305/500 19520/32000 (61%)] Loss: 1.76867 (QuantReg: 15.09607) QuantErr: 15.09607 batch_time=0.38120 
Train Epoch: 14 [313/500 20032/32000 (63%)] Loss: 1.89304 (QuantReg: 14.95863) QuantErr: 14.95863 batch_time=0.38720 
Train Epoch: 14 [321/500 20544/32000 (64%)] Loss: 2.05017 (QuantReg: 14.83591) QuantErr: 14.83591 batch_time=0.90306 
Train Epoch: 14 [329/500 21056/32000 (66%)] Loss: 2.47195 (QuantReg: 15.05418) QuantErr: 15.05418 batch_time=0.38814 
Train Epoch: 14 [337/500 21568/32000 (67%)] Loss: 2.08641 (QuantReg: 15.13618) QuantErr: 15.13618 batch_time=2.90082 
Train Epoch: 14 [345/500 22080/32000 (69%)] Loss: 1.91283 (QuantReg: 15.18588) QuantErr: 15.18588 batch_time=0.41702 
Train Epoch: 14 [353/500 22592/32000 (71%)] Loss: 2.26280 (QuantReg: 15.00023) QuantErr: 15.00023 batch_time=0.38393 
Train Epoch: 14 [361/500 23104/32000 (72%)] Loss: 1.89233 (QuantReg: 14.81342) QuantErr: 14.81342 batch_time=0.40276 
Train Epoch: 14 [369/500 23616/32000 (74%)] Loss: 1.94741 (QuantReg: 15.18851) QuantErr: 15.18851 batch_time=0.38875 
Train Epoch: 14 [377/500 24128/32000 (75%)] Loss: 1.92887 (QuantReg: 15.13680) QuantErr: 15.13680 batch_time=0.40213 
Train Epoch: 14 [385/500 24640/32000 (77%)] Loss: 2.40587 (QuantReg: 14.90576) QuantErr: 14.90576 batch_time=0.89859 
Train Epoch: 14 [393/500 25152/32000 (79%)] Loss: 1.54785 (QuantReg: 14.98004) QuantErr: 14.98004 batch_time=0.39024 
Train Epoch: 14 [401/500 25664/32000 (80%)] Loss: 2.66588 (QuantReg: 15.02181) QuantErr: 15.02181 batch_time=3.00253 
Train Epoch: 14 [409/500 26176/32000 (82%)] Loss: 2.14365 (QuantReg: 15.04273) QuantErr: 15.04273 batch_time=0.38477 
Train Epoch: 14 [417/500 26688/32000 (83%)] Loss: 1.78101 (QuantReg: 14.98237) QuantErr: 14.98237 batch_time=0.38600 
Train Epoch: 14 [425/500 27200/32000 (85%)] Loss: 2.05674 (QuantReg: 14.94989) QuantErr: 14.94989 batch_time=0.38706 
Train Epoch: 14 [433/500 27712/32000 (87%)] Loss: 2.02768 (QuantReg: 15.01065) QuantErr: 15.01065 batch_time=0.37972 
Train Epoch: 14 [441/500 28224/32000 (88%)] Loss: 1.51180 (QuantReg: 15.41944) QuantErr: 15.41944 batch_time=0.39642 
Train Epoch: 14 [449/500 28736/32000 (90%)] Loss: 1.95890 (QuantReg: 15.02406) QuantErr: 15.02406 batch_time=0.93878 
Train Epoch: 14 [457/500 29248/32000 (91%)] Loss: 1.82995 (QuantReg: 14.71709) QuantErr: 14.71709 batch_time=0.38506 
Train Epoch: 14 [465/500 29760/32000 (93%)] Loss: 2.39914 (QuantReg: 15.14413) QuantErr: 15.14413 batch_time=3.02047 
Train Epoch: 14 [473/500 30272/32000 (95%)] Loss: 2.10276 (QuantReg: 14.98188) QuantErr: 14.98188 batch_time=0.37968 
Train Epoch: 14 [481/500 30784/32000 (96%)] Loss: 1.84372 (QuantReg: 15.33214) QuantErr: 15.33214 batch_time=0.40777 
Train Epoch: 14 [489/500 31296/32000 (98%)] Loss: 1.87401 (QuantReg: 15.20519) QuantErr: 15.20519 batch_time=0.38223 
Train Epoch: 14 [497/500 31808/32000 (99%)] Loss: 2.01018 (QuantReg: 15.32306) QuantErr: 15.32306 batch_time=0.38460 
Train Epoch: 14 codebook_update_time=1.92517
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch14.pth ...
Done in 3.979s
removing stale ckpt [epoch 13] [took 0.07s]
 epoch          : 14
 loss           : 2.0897341594696046
 quant_reg      : 14.940148595809937
 quant_err      : 14.940148595809937
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 7000
 LSMDC_full_test/t2v_metrics/R1: 11.9
 LSMDC_full_test/t2v_metrics/R5: 28.1
 LSMDC_full_test/t2v_metrics/R10: 39.6
 LSMDC_full_test/t2v_metrics/R50: 67.7
 LSMDC_full_test/t2v_metrics/MedR: 16.5
 LSMDC_full_test/t2v_metrics/MeanR: 73.3585
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.658261204270257
 LSMDC_full_test/v2t_metrics/R1: 12.2
 LSMDC_full_test/v2t_metrics/R5: 30.1
 LSMDC_full_test/v2t_metrics/R10: 39.6
 LSMDC_full_test/v2t_metrics/R50: 65.8
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.852
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.408467006892156
 mnt_best       : 24.61759597721429
 not_improved_count: 1
Train Epoch: 15 [1/500 64/32000 (0%)] Loss: 1.73538 (QuantReg: 14.99268) QuantErr: 14.99268 batch_time=16.19148 
Train Epoch: 15 [9/500 576/32000 (2%)] Loss: 1.85772 (QuantReg: 15.20387) QuantErr: 15.20387 batch_time=0.37985 
Train Epoch: 15 [17/500 1088/32000 (3%)] Loss: 1.77127 (QuantReg: 14.90914) QuantErr: 14.90914 batch_time=0.41206 
Train Epoch: 15 [25/500 1600/32000 (5%)] Loss: 2.22819 (QuantReg: 14.74544) QuantErr: 14.74544 batch_time=0.38182 
Train Epoch: 15 [33/500 2112/32000 (7%)] Loss: 2.46396 (QuantReg: 15.02226) QuantErr: 15.02226 batch_time=0.38188 
Train Epoch: 15 [41/500 2624/32000 (8%)] Loss: 2.00383 (QuantReg: 15.21977) QuantErr: 15.21977 batch_time=0.43783 
Train Epoch: 15 [49/500 3136/32000 (10%)] Loss: 2.25162 (QuantReg: 14.75922) QuantErr: 14.75922 batch_time=0.37908 
Train Epoch: 15 [57/500 3648/32000 (11%)] Loss: 1.74083 (QuantReg: 14.95110) QuantErr: 14.95110 batch_time=0.38396 
Train Epoch: 15 [65/500 4160/32000 (13%)] Loss: 2.12710 (QuantReg: 14.73645) QuantErr: 14.73645 batch_time=0.44401 
Train Epoch: 15 [73/500 4672/32000 (15%)] Loss: 1.95343 (QuantReg: 14.98880) QuantErr: 14.98880 batch_time=0.37891 
Train Epoch: 15 [81/500 5184/32000 (16%)] Loss: 1.88183 (QuantReg: 15.23684) QuantErr: 15.23684 batch_time=0.38248 
Train Epoch: 15 [89/500 5696/32000 (18%)] Loss: 1.55786 (QuantReg: 15.18515) QuantErr: 15.18515 batch_time=0.37793 
Train Epoch: 15 [97/500 6208/32000 (19%)] Loss: 1.60319 (QuantReg: 15.08155) QuantErr: 15.08155 batch_time=0.37843 
Train Epoch: 15 [105/500 6720/32000 (21%)] Loss: 1.78044 (QuantReg: 14.85752) QuantErr: 14.85752 batch_time=0.43349 
Train Epoch: 15 [113/500 7232/32000 (23%)] Loss: 2.18759 (QuantReg: 14.97901) QuantErr: 14.97901 batch_time=0.42352 
Train Epoch: 15 [121/500 7744/32000 (24%)] Loss: 2.33567 (QuantReg: 14.97455) QuantErr: 14.97455 batch_time=0.39793 
Train Epoch: 15 [129/500 8256/32000 (26%)] Loss: 1.77029 (QuantReg: 15.27593) QuantErr: 15.27593 batch_time=0.44071 
Train Epoch: 15 [137/500 8768/32000 (27%)] Loss: 2.15180 (QuantReg: 15.12928) QuantErr: 15.12928 batch_time=0.37701 
Train Epoch: 15 [145/500 9280/32000 (29%)] Loss: 2.17042 (QuantReg: 14.88836) QuantErr: 14.88836 batch_time=0.40018 
Train Epoch: 15 [153/500 9792/32000 (31%)] Loss: 1.36926 (QuantReg: 15.14930) QuantErr: 15.14930 batch_time=0.39940 
Train Epoch: 15 [161/500 10304/32000 (32%)] Loss: 2.03049 (QuantReg: 15.11812) QuantErr: 15.11812 batch_time=0.38438 
Train Epoch: 15 [169/500 10816/32000 (34%)] Loss: 2.44802 (QuantReg: 14.72425) QuantErr: 14.72425 batch_time=0.43646 
Train Epoch: 15 [177/500 11328/32000 (35%)] Loss: 2.49394 (QuantReg: 15.13237) QuantErr: 15.13237 batch_time=0.38532 
Train Epoch: 15 [185/500 11840/32000 (37%)] Loss: 2.05398 (QuantReg: 14.82371) QuantErr: 14.82371 batch_time=0.38196 
Train Epoch: 15 [193/500 12352/32000 (39%)] Loss: 2.23553 (QuantReg: 14.94190) QuantErr: 14.94190 batch_time=0.43160 
Train Epoch: 15 [201/500 12864/32000 (40%)] Loss: 2.38804 (QuantReg: 14.85399) QuantErr: 14.85399 batch_time=0.40253 
Train Epoch: 15 [209/500 13376/32000 (42%)] Loss: 2.08020 (QuantReg: 15.20557) QuantErr: 15.20557 batch_time=0.39816 
Train Epoch: 15 [217/500 13888/32000 (43%)] Loss: 1.94292 (QuantReg: 15.07698) QuantErr: 15.07698 batch_time=0.39556 
Train Epoch: 15 [225/500 14400/32000 (45%)] Loss: 1.51426 (QuantReg: 15.18126) QuantErr: 15.18126 batch_time=0.38481 
Train Epoch: 15 [233/500 14912/32000 (47%)] Loss: 2.08223 (QuantReg: 15.18574) QuantErr: 15.18574 batch_time=0.43345 
Train Epoch: 15 [241/500 15424/32000 (48%)] Loss: 2.18028 (QuantReg: 15.10865) QuantErr: 15.10865 batch_time=0.38575 
Train Epoch: 15 [249/500 15936/32000 (50%)] Loss: 1.97390 (QuantReg: 15.28739) QuantErr: 15.28739 batch_time=0.38381 
Train Epoch: 15 [257/500 16448/32000 (51%)] Loss: 1.81592 (QuantReg: 15.50422) QuantErr: 15.50422 batch_time=0.50515 
Train Epoch: 15 [265/500 16960/32000 (53%)] Loss: 2.00979 (QuantReg: 15.07970) QuantErr: 15.07970 batch_time=0.42647 
Train Epoch: 15 [273/500 17472/32000 (55%)] Loss: 2.16019 (QuantReg: 14.92301) QuantErr: 14.92301 batch_time=0.42697 
Train Epoch: 15 [281/500 17984/32000 (56%)] Loss: 1.91472 (QuantReg: 15.24188) QuantErr: 15.24188 batch_time=0.39764 
Train Epoch: 15 [289/500 18496/32000 (58%)] Loss: 1.62645 (QuantReg: 15.32952) QuantErr: 15.32952 batch_time=0.41502 
Train Epoch: 15 [297/500 19008/32000 (59%)] Loss: 1.82231 (QuantReg: 15.54052) QuantErr: 15.54052 batch_time=0.44318 
Train Epoch: 15 [305/500 19520/32000 (61%)] Loss: 1.59731 (QuantReg: 15.07896) QuantErr: 15.07896 batch_time=0.40004 
Train Epoch: 15 [313/500 20032/32000 (63%)] Loss: 2.34650 (QuantReg: 15.11049) QuantErr: 15.11049 batch_time=0.41915 
Train Epoch: 15 [321/500 20544/32000 (64%)] Loss: 2.40019 (QuantReg: 15.27208) QuantErr: 15.27208 batch_time=0.45154 
Train Epoch: 15 [329/500 21056/32000 (66%)] Loss: 1.75424 (QuantReg: 15.22834) QuantErr: 15.22834 batch_time=0.38470 
Train Epoch: 15 [337/500 21568/32000 (67%)] Loss: 2.02364 (QuantReg: 14.78666) QuantErr: 14.78666 batch_time=0.39943 
Train Epoch: 15 [345/500 22080/32000 (69%)] Loss: 2.47658 (QuantReg: 15.25512) QuantErr: 15.25512 batch_time=0.40517 
Train Epoch: 15 [353/500 22592/32000 (71%)] Loss: 2.27821 (QuantReg: 14.85376) QuantErr: 14.85376 batch_time=0.43348 
Train Epoch: 15 [361/500 23104/32000 (72%)] Loss: 2.14639 (QuantReg: 15.29331) QuantErr: 15.29331 batch_time=0.45354 
Train Epoch: 15 [369/500 23616/32000 (74%)] Loss: 1.96771 (QuantReg: 15.23062) QuantErr: 15.23062 batch_time=0.38198 
Train Epoch: 15 [377/500 24128/32000 (75%)] Loss: 2.14666 (QuantReg: 14.98131) QuantErr: 14.98131 batch_time=0.38635 
Train Epoch: 15 [385/500 24640/32000 (77%)] Loss: 2.18967 (QuantReg: 15.13841) QuantErr: 15.13841 batch_time=0.45817 
Train Epoch: 15 [393/500 25152/32000 (79%)] Loss: 1.47999 (QuantReg: 15.30521) QuantErr: 15.30521 batch_time=0.38602 
Train Epoch: 15 [401/500 25664/32000 (80%)] Loss: 2.05037 (QuantReg: 14.91413) QuantErr: 14.91413 batch_time=0.39185 
Train Epoch: 15 [409/500 26176/32000 (82%)] Loss: 1.74735 (QuantReg: 15.17266) QuantErr: 15.17266 batch_time=0.38335 
Train Epoch: 15 [417/500 26688/32000 (83%)] Loss: 2.08870 (QuantReg: 15.28772) QuantErr: 15.28772 batch_time=0.41448 
Train Epoch: 15 [425/500 27200/32000 (85%)] Loss: 2.06245 (QuantReg: 15.38201) QuantErr: 15.38201 batch_time=0.44246 
Train Epoch: 15 [433/500 27712/32000 (87%)] Loss: 2.05998 (QuantReg: 14.99756) QuantErr: 14.99756 batch_time=0.38712 
Train Epoch: 15 [441/500 28224/32000 (88%)] Loss: 2.08975 (QuantReg: 15.34299) QuantErr: 15.34299 batch_time=0.38898 
Train Epoch: 15 [449/500 28736/32000 (90%)] Loss: 2.00116 (QuantReg: 14.81805) QuantErr: 14.81805 batch_time=0.43524 
Train Epoch: 15 [457/500 29248/32000 (91%)] Loss: 1.80842 (QuantReg: 15.35355) QuantErr: 15.35355 batch_time=0.38244 
Train Epoch: 15 [465/500 29760/32000 (93%)] Loss: 1.72501 (QuantReg: 15.00012) QuantErr: 15.00012 batch_time=0.39620 
Train Epoch: 15 [473/500 30272/32000 (95%)] Loss: 1.99491 (QuantReg: 15.28582) QuantErr: 15.28582 batch_time=0.38516 
Train Epoch: 15 [481/500 30784/32000 (96%)] Loss: 1.52510 (QuantReg: 15.38131) QuantErr: 15.38131 batch_time=0.38646 
Train Epoch: 15 [489/500 31296/32000 (98%)] Loss: 1.72957 (QuantReg: 14.95233) QuantErr: 14.95233 batch_time=0.43660 
Train Epoch: 15 [497/500 31808/32000 (99%)] Loss: 1.96948 (QuantReg: 15.12253) QuantErr: 15.12253 batch_time=0.38654 
Train Epoch: 15 codebook_update_time=1.85123
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch15.pth ...
Done in 4.006s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 1.9812651517391204
 quant_reg      : 15.079226228713988
 quant_err      : 15.079226228713988
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 7500
 LSMDC_full_test/t2v_metrics/R1: 11.9
 LSMDC_full_test/t2v_metrics/R5: 30.1
 LSMDC_full_test/t2v_metrics/R10: 40.0
 LSMDC_full_test/t2v_metrics/R50: 67.4
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.075
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.28796617774156
 LSMDC_full_test/v2t_metrics/R1: 12.2
 LSMDC_full_test/v2t_metrics/R5: 30.1
 LSMDC_full_test/v2t_metrics/R10: 40.4
 LSMDC_full_test/v2t_metrics/R50: 66.7
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 72.874
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.571739198730906
 mnt_best       : 24.61759597721429
 not_improved_count: 2
Train Epoch: 16 [1/500 64/32000 (0%)] Loss: 2.04075 (QuantReg: 15.03334) QuantErr: 15.03334 batch_time=17.91172 
Train Epoch: 16 [9/500 576/32000 (2%)] Loss: 2.20683 (QuantReg: 14.79714) QuantErr: 14.79714 batch_time=0.38842 
Train Epoch: 16 [17/500 1088/32000 (3%)] Loss: 1.24947 (QuantReg: 15.13935) QuantErr: 15.13935 batch_time=2.33486 
Train Epoch: 16 [25/500 1600/32000 (5%)] Loss: 2.32605 (QuantReg: 14.66090) QuantErr: 14.66090 batch_time=0.37863 
Train Epoch: 16 [33/500 2112/32000 (7%)] Loss: 1.79931 (QuantReg: 15.10805) QuantErr: 15.10805 batch_time=0.37859 
Train Epoch: 16 [41/500 2624/32000 (8%)] Loss: 1.96937 (QuantReg: 14.83011) QuantErr: 14.83011 batch_time=0.37970 
Train Epoch: 16 [49/500 3136/32000 (10%)] Loss: 1.59784 (QuantReg: 15.33237) QuantErr: 15.33237 batch_time=0.38204 
Train Epoch: 16 [57/500 3648/32000 (11%)] Loss: 1.88514 (QuantReg: 15.08084) QuantErr: 15.08084 batch_time=0.39269 
Train Epoch: 16 [65/500 4160/32000 (13%)] Loss: 2.14204 (QuantReg: 15.17027) QuantErr: 15.17027 batch_time=0.99524 
Train Epoch: 16 [73/500 4672/32000 (15%)] Loss: 1.61993 (QuantReg: 15.25125) QuantErr: 15.25125 batch_time=0.38529 
Train Epoch: 16 [81/500 5184/32000 (16%)] Loss: 1.92504 (QuantReg: 15.14679) QuantErr: 15.14679 batch_time=1.76280 
Train Epoch: 16 [89/500 5696/32000 (18%)] Loss: 2.05665 (QuantReg: 15.16444) QuantErr: 15.16444 batch_time=0.38304 
Train Epoch: 16 [97/500 6208/32000 (19%)] Loss: 2.54273 (QuantReg: 14.93659) QuantErr: 14.93659 batch_time=0.38496 
Train Epoch: 16 [105/500 6720/32000 (21%)] Loss: 2.42679 (QuantReg: 15.12268) QuantErr: 15.12268 batch_time=0.38532 
Train Epoch: 16 [113/500 7232/32000 (23%)] Loss: 1.67525 (QuantReg: 14.87712) QuantErr: 14.87712 batch_time=0.38117 
Train Epoch: 16 [121/500 7744/32000 (24%)] Loss: 1.27052 (QuantReg: 15.35980) QuantErr: 15.35980 batch_time=0.39244 
Train Epoch: 16 [129/500 8256/32000 (26%)] Loss: 1.98649 (QuantReg: 15.11617) QuantErr: 15.11617 batch_time=1.00718 
Train Epoch: 16 [137/500 8768/32000 (27%)] Loss: 2.07305 (QuantReg: 15.05380) QuantErr: 15.05380 batch_time=0.38805 
Train Epoch: 16 [145/500 9280/32000 (29%)] Loss: 1.43760 (QuantReg: 15.03877) QuantErr: 15.03877 batch_time=1.75700 
Train Epoch: 16 [153/500 9792/32000 (31%)] Loss: 1.73116 (QuantReg: 15.29118) QuantErr: 15.29118 batch_time=0.39361 
Train Epoch: 16 [161/500 10304/32000 (32%)] Loss: 2.45789 (QuantReg: 15.13275) QuantErr: 15.13275 batch_time=0.38302 
Train Epoch: 16 [169/500 10816/32000 (34%)] Loss: 1.74317 (QuantReg: 15.20139) QuantErr: 15.20139 batch_time=0.38846 
Train Epoch: 16 [177/500 11328/32000 (35%)] Loss: 1.53984 (QuantReg: 15.17805) QuantErr: 15.17805 batch_time=0.38621 
Train Epoch: 16 [185/500 11840/32000 (37%)] Loss: 2.02902 (QuantReg: 15.30115) QuantErr: 15.30115 batch_time=0.39133 
Train Epoch: 16 [193/500 12352/32000 (39%)] Loss: 2.08979 (QuantReg: 14.92238) QuantErr: 14.92238 batch_time=1.01324 
Train Epoch: 16 [201/500 12864/32000 (40%)] Loss: 2.00137 (QuantReg: 15.17888) QuantErr: 15.17888 batch_time=0.39902 
Train Epoch: 16 [209/500 13376/32000 (42%)] Loss: 1.11678 (QuantReg: 15.17295) QuantErr: 15.17295 batch_time=1.72044 
Train Epoch: 16 [217/500 13888/32000 (43%)] Loss: 1.56172 (QuantReg: 15.06287) QuantErr: 15.06287 batch_time=0.39922 
Train Epoch: 16 [225/500 14400/32000 (45%)] Loss: 1.59437 (QuantReg: 15.53139) QuantErr: 15.53139 batch_time=0.38178 
Train Epoch: 16 [233/500 14912/32000 (47%)] Loss: 2.69167 (QuantReg: 15.20595) QuantErr: 15.20595 batch_time=0.38482 
Train Epoch: 16 [241/500 15424/32000 (48%)] Loss: 2.02015 (QuantReg: 15.28146) QuantErr: 15.28146 batch_time=0.39003 
Train Epoch: 16 [249/500 15936/32000 (50%)] Loss: 1.94066 (QuantReg: 14.99609) QuantErr: 14.99609 batch_time=0.39000 
Train Epoch: 16 [257/500 16448/32000 (51%)] Loss: 2.31398 (QuantReg: 15.35995) QuantErr: 15.35995 batch_time=1.00019 
Train Epoch: 16 [265/500 16960/32000 (53%)] Loss: 1.82140 (QuantReg: 15.01637) QuantErr: 15.01637 batch_time=0.38257 
Train Epoch: 16 [273/500 17472/32000 (55%)] Loss: 1.61064 (QuantReg: 15.21501) QuantErr: 15.21501 batch_time=1.74664 
Train Epoch: 16 [281/500 17984/32000 (56%)] Loss: 1.63355 (QuantReg: 15.17822) QuantErr: 15.17822 batch_time=0.40295 
Train Epoch: 16 [289/500 18496/32000 (58%)] Loss: 2.05521 (QuantReg: 15.36396) QuantErr: 15.36396 batch_time=0.38079 
Train Epoch: 16 [297/500 19008/32000 (59%)] Loss: 1.92781 (QuantReg: 15.50986) QuantErr: 15.50986 batch_time=0.37936 
Train Epoch: 16 [305/500 19520/32000 (61%)] Loss: 1.67031 (QuantReg: 15.34430) QuantErr: 15.34430 batch_time=0.38228 
Train Epoch: 16 [313/500 20032/32000 (63%)] Loss: 1.57460 (QuantReg: 14.89916) QuantErr: 14.89916 batch_time=0.37979 
Train Epoch: 16 [321/500 20544/32000 (64%)] Loss: 2.61364 (QuantReg: 15.15098) QuantErr: 15.15098 batch_time=0.99639 
Train Epoch: 16 [329/500 21056/32000 (66%)] Loss: 1.90497 (QuantReg: 15.06457) QuantErr: 15.06457 batch_time=0.38381 
Train Epoch: 16 [337/500 21568/32000 (67%)] Loss: 2.00592 (QuantReg: 15.25583) QuantErr: 15.25583 batch_time=1.72759 
Train Epoch: 16 [345/500 22080/32000 (69%)] Loss: 1.88776 (QuantReg: 15.41754) QuantErr: 15.41754 batch_time=0.38457 
Train Epoch: 16 [353/500 22592/32000 (71%)] Loss: 1.89702 (QuantReg: 14.81281) QuantErr: 14.81281 batch_time=0.39012 
Train Epoch: 16 [361/500 23104/32000 (72%)] Loss: 2.52216 (QuantReg: 15.12623) QuantErr: 15.12623 batch_time=0.38857 
Train Epoch: 16 [369/500 23616/32000 (74%)] Loss: 1.80136 (QuantReg: 15.23647) QuantErr: 15.23647 batch_time=0.38165 
Train Epoch: 16 [377/500 24128/32000 (75%)] Loss: 1.54508 (QuantReg: 15.45143) QuantErr: 15.45143 batch_time=0.38892 
Train Epoch: 16 [385/500 24640/32000 (77%)] Loss: 1.82894 (QuantReg: 15.13613) QuantErr: 15.13613 batch_time=1.01143 
Train Epoch: 16 [393/500 25152/32000 (79%)] Loss: 1.55596 (QuantReg: 15.56507) QuantErr: 15.56507 batch_time=0.39968 
Train Epoch: 16 [401/500 25664/32000 (80%)] Loss: 1.65488 (QuantReg: 15.29520) QuantErr: 15.29520 batch_time=1.80582 
Train Epoch: 16 [409/500 26176/32000 (82%)] Loss: 2.24637 (QuantReg: 15.24526) QuantErr: 15.24526 batch_time=0.38865 
Train Epoch: 16 [417/500 26688/32000 (83%)] Loss: 1.97519 (QuantReg: 15.22964) QuantErr: 15.22964 batch_time=0.38563 
Train Epoch: 16 [425/500 27200/32000 (85%)] Loss: 1.52177 (QuantReg: 15.33916) QuantErr: 15.33916 batch_time=0.39638 
Train Epoch: 16 [433/500 27712/32000 (87%)] Loss: 1.86256 (QuantReg: 15.46908) QuantErr: 15.46908 batch_time=0.40345 
Train Epoch: 16 [441/500 28224/32000 (88%)] Loss: 1.58506 (QuantReg: 15.35090) QuantErr: 15.35090 batch_time=0.39712 
Train Epoch: 16 [449/500 28736/32000 (90%)] Loss: 1.90390 (QuantReg: 15.38992) QuantErr: 15.38992 batch_time=1.07264 
Train Epoch: 16 [457/500 29248/32000 (91%)] Loss: 2.19298 (QuantReg: 15.12242) QuantErr: 15.12242 batch_time=0.39639 
Train Epoch: 16 [465/500 29760/32000 (93%)] Loss: 2.12291 (QuantReg: 15.50697) QuantErr: 15.50697 batch_time=1.76181 
Train Epoch: 16 [473/500 30272/32000 (95%)] Loss: 1.58143 (QuantReg: 15.33592) QuantErr: 15.33592 batch_time=0.38850 
Train Epoch: 16 [481/500 30784/32000 (96%)] Loss: 1.75449 (QuantReg: 15.44156) QuantErr: 15.44156 batch_time=0.39356 
Train Epoch: 16 [489/500 31296/32000 (98%)] Loss: 1.61479 (QuantReg: 15.30108) QuantErr: 15.30108 batch_time=0.39059 
Train Epoch: 16 [497/500 31808/32000 (99%)] Loss: 1.70761 (QuantReg: 15.25808) QuantErr: 15.25808 batch_time=0.42272 
Train Epoch: 16 codebook_update_time=1.91246
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch16.pth ...
Done in 5.209s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 1.8957701168060304
 quant_reg      : 15.183026960372924
 quant_err      : 15.183026960372924
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 8000
 LSMDC_full_test/t2v_metrics/R1: 11.7
 LSMDC_full_test/t2v_metrics/R5: 29.7
 LSMDC_full_test/t2v_metrics/R10: 39.6
 LSMDC_full_test/t2v_metrics/R50: 67.7
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.036
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.963256274484657
 LSMDC_full_test/v2t_metrics/R1: 12.5
 LSMDC_full_test/v2t_metrics/R5: 29.2
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 65.7
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 72.951
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.46127437569816
 mnt_best       : 24.61759597721429
 not_improved_count: 3
Train Epoch: 17 [1/500 64/32000 (0%)] Loss: 1.80940 (QuantReg: 15.15751) QuantErr: 15.15751 batch_time=14.43908 
Train Epoch: 17 [9/500 576/32000 (2%)] Loss: 1.96173 (QuantReg: 14.94541) QuantErr: 14.94541 batch_time=0.37751 
Train Epoch: 17 [17/500 1088/32000 (3%)] Loss: 1.77655 (QuantReg: 14.85432) QuantErr: 14.85432 batch_time=0.60159 
Train Epoch: 17 [25/500 1600/32000 (5%)] Loss: 1.92201 (QuantReg: 15.21316) QuantErr: 15.21316 batch_time=0.40121 
Train Epoch: 17 [33/500 2112/32000 (7%)] Loss: 1.87557 (QuantReg: 15.12766) QuantErr: 15.12766 batch_time=0.39187 
Train Epoch: 17 [41/500 2624/32000 (8%)] Loss: 2.19534 (QuantReg: 15.14146) QuantErr: 15.14146 batch_time=0.38812 
Train Epoch: 17 [49/500 3136/32000 (10%)] Loss: 2.07134 (QuantReg: 14.92260) QuantErr: 14.92260 batch_time=0.38417 
Train Epoch: 17 [57/500 3648/32000 (11%)] Loss: 1.98464 (QuantReg: 14.91919) QuantErr: 14.91919 batch_time=0.43752 
Train Epoch: 17 [65/500 4160/32000 (13%)] Loss: 2.01409 (QuantReg: 15.24617) QuantErr: 15.24617 batch_time=0.53658 
Train Epoch: 17 [73/500 4672/32000 (15%)] Loss: 2.20244 (QuantReg: 14.98628) QuantErr: 14.98628 batch_time=0.42173 
Train Epoch: 17 [81/500 5184/32000 (16%)] Loss: 1.75851 (QuantReg: 15.37607) QuantErr: 15.37607 batch_time=0.59354 
Train Epoch: 17 [89/500 5696/32000 (18%)] Loss: 1.88165 (QuantReg: 14.81271) QuantErr: 14.81271 batch_time=0.40302 
Train Epoch: 17 [97/500 6208/32000 (19%)] Loss: 2.16802 (QuantReg: 15.33864) QuantErr: 15.33864 batch_time=0.38388 
Train Epoch: 17 [105/500 6720/32000 (21%)] Loss: 1.95994 (QuantReg: 14.99284) QuantErr: 14.99284 batch_time=0.39342 
Train Epoch: 17 [113/500 7232/32000 (23%)] Loss: 2.10134 (QuantReg: 15.07584) QuantErr: 15.07584 batch_time=0.38030 
Train Epoch: 17 [121/500 7744/32000 (24%)] Loss: 1.43578 (QuantReg: 14.96000) QuantErr: 14.96000 batch_time=0.43039 
Train Epoch: 17 [129/500 8256/32000 (26%)] Loss: 1.23323 (QuantReg: 15.45972) QuantErr: 15.45972 batch_time=0.53126 
Train Epoch: 17 [137/500 8768/32000 (27%)] Loss: 1.67694 (QuantReg: 15.28535) QuantErr: 15.28535 batch_time=0.38086 
Train Epoch: 17 [145/500 9280/32000 (29%)] Loss: 1.93928 (QuantReg: 15.22210) QuantErr: 15.22210 batch_time=0.59352 
Train Epoch: 17 [153/500 9792/32000 (31%)] Loss: 1.78013 (QuantReg: 15.16074) QuantErr: 15.16074 batch_time=0.37975 
Train Epoch: 17 [161/500 10304/32000 (32%)] Loss: 1.65447 (QuantReg: 15.28735) QuantErr: 15.28735 batch_time=0.38488 
Train Epoch: 17 [169/500 10816/32000 (34%)] Loss: 1.89674 (QuantReg: 15.34259) QuantErr: 15.34259 batch_time=0.38334 
Train Epoch: 17 [177/500 11328/32000 (35%)] Loss: 1.94318 (QuantReg: 15.34046) QuantErr: 15.34046 batch_time=0.37698 
Train Epoch: 17 [185/500 11840/32000 (37%)] Loss: 1.35464 (QuantReg: 15.28099) QuantErr: 15.28099 batch_time=0.43687 
Train Epoch: 17 [193/500 12352/32000 (39%)] Loss: 1.75785 (QuantReg: 15.40053) QuantErr: 15.40053 batch_time=0.54203 
Train Epoch: 17 [201/500 12864/32000 (40%)] Loss: 1.85677 (QuantReg: 15.20614) QuantErr: 15.20614 batch_time=0.37888 
Train Epoch: 17 [209/500 13376/32000 (42%)] Loss: 2.16523 (QuantReg: 15.14692) QuantErr: 15.14692 batch_time=0.60247 
Train Epoch: 17 [217/500 13888/32000 (43%)] Loss: 1.84407 (QuantReg: 15.15010) QuantErr: 15.15010 batch_time=0.38812 
Train Epoch: 17 [225/500 14400/32000 (45%)] Loss: 1.34133 (QuantReg: 15.46037) QuantErr: 15.46037 batch_time=0.38264 
Train Epoch: 17 [233/500 14912/32000 (47%)] Loss: 1.96918 (QuantReg: 15.01809) QuantErr: 15.01809 batch_time=0.39010 
Train Epoch: 17 [241/500 15424/32000 (48%)] Loss: 2.37959 (QuantReg: 15.32987) QuantErr: 15.32987 batch_time=0.38013 
Train Epoch: 17 [249/500 15936/32000 (50%)] Loss: 1.28130 (QuantReg: 15.50074) QuantErr: 15.50074 batch_time=0.42770 
Train Epoch: 17 [257/500 16448/32000 (51%)] Loss: 1.90094 (QuantReg: 15.48596) QuantErr: 15.48596 batch_time=0.53902 
Train Epoch: 17 [265/500 16960/32000 (53%)] Loss: 1.69548 (QuantReg: 15.18581) QuantErr: 15.18581 batch_time=0.37555 
Train Epoch: 17 [273/500 17472/32000 (55%)] Loss: 2.20350 (QuantReg: 14.95113) QuantErr: 14.95113 batch_time=0.60866 
Train Epoch: 17 [281/500 17984/32000 (56%)] Loss: 1.81633 (QuantReg: 15.43275) QuantErr: 15.43275 batch_time=0.42018 
Train Epoch: 17 [289/500 18496/32000 (58%)] Loss: 1.74310 (QuantReg: 15.38204) QuantErr: 15.38204 batch_time=0.38581 
Train Epoch: 17 [297/500 19008/32000 (59%)] Loss: 2.24250 (QuantReg: 14.99702) QuantErr: 14.99702 batch_time=0.38332 
Train Epoch: 17 [305/500 19520/32000 (61%)] Loss: 1.63228 (QuantReg: 15.04210) QuantErr: 15.04210 batch_time=0.38995 
Train Epoch: 17 [313/500 20032/32000 (63%)] Loss: 1.88922 (QuantReg: 15.35669) QuantErr: 15.35669 batch_time=0.43534 
Train Epoch: 17 [321/500 20544/32000 (64%)] Loss: 1.69566 (QuantReg: 14.91467) QuantErr: 14.91467 batch_time=0.53837 
Train Epoch: 17 [329/500 21056/32000 (66%)] Loss: 2.07163 (QuantReg: 15.17255) QuantErr: 15.17255 batch_time=0.38270 
Train Epoch: 17 [337/500 21568/32000 (67%)] Loss: 2.17785 (QuantReg: 15.49389) QuantErr: 15.49389 batch_time=0.59589 
Train Epoch: 17 [345/500 22080/32000 (69%)] Loss: 1.49512 (QuantReg: 15.33442) QuantErr: 15.33442 batch_time=0.38532 
Train Epoch: 17 [353/500 22592/32000 (71%)] Loss: 1.90287 (QuantReg: 15.13656) QuantErr: 15.13656 batch_time=0.38006 
Train Epoch: 17 [361/500 23104/32000 (72%)] Loss: 2.35967 (QuantReg: 15.36050) QuantErr: 15.36050 batch_time=0.38060 
Train Epoch: 17 [369/500 23616/32000 (74%)] Loss: 1.44127 (QuantReg: 15.35753) QuantErr: 15.35753 batch_time=0.38449 
Train Epoch: 17 [377/500 24128/32000 (75%)] Loss: 2.16209 (QuantReg: 15.45766) QuantErr: 15.45766 batch_time=0.43723 
Train Epoch: 17 [385/500 24640/32000 (77%)] Loss: 2.04370 (QuantReg: 15.32659) QuantErr: 15.32659 batch_time=0.52696 
Train Epoch: 17 [393/500 25152/32000 (79%)] Loss: 1.83777 (QuantReg: 15.14343) QuantErr: 15.14343 batch_time=0.37313 
Train Epoch: 17 [401/500 25664/32000 (80%)] Loss: 1.93689 (QuantReg: 15.39540) QuantErr: 15.39540 batch_time=0.56996 
Train Epoch: 17 [409/500 26176/32000 (82%)] Loss: 1.52535 (QuantReg: 15.47003) QuantErr: 15.47003 batch_time=0.41125 
Train Epoch: 17 [417/500 26688/32000 (83%)] Loss: 1.55987 (QuantReg: 15.36963) QuantErr: 15.36963 batch_time=0.38458 
Train Epoch: 17 [425/500 27200/32000 (85%)] Loss: 1.49870 (QuantReg: 15.54652) QuantErr: 15.54652 batch_time=0.38054 
Train Epoch: 17 [433/500 27712/32000 (87%)] Loss: 1.65484 (QuantReg: 15.20045) QuantErr: 15.20045 batch_time=0.38855 
Train Epoch: 17 [441/500 28224/32000 (88%)] Loss: 1.63280 (QuantReg: 15.36199) QuantErr: 15.36199 batch_time=0.42884 
Train Epoch: 17 [449/500 28736/32000 (90%)] Loss: 1.87293 (QuantReg: 15.39480) QuantErr: 15.39480 batch_time=0.52950 
Train Epoch: 17 [457/500 29248/32000 (91%)] Loss: 1.95301 (QuantReg: 15.31701) QuantErr: 15.31701 batch_time=0.41183 
Train Epoch: 17 [465/500 29760/32000 (93%)] Loss: 2.21444 (QuantReg: 15.13763) QuantErr: 15.13763 batch_time=0.63993 
Train Epoch: 17 [473/500 30272/32000 (95%)] Loss: 2.27575 (QuantReg: 15.31795) QuantErr: 15.31795 batch_time=0.42868 
Train Epoch: 17 [481/500 30784/32000 (96%)] Loss: 1.44440 (QuantReg: 15.51996) QuantErr: 15.51996 batch_time=0.38419 
Train Epoch: 17 [489/500 31296/32000 (98%)] Loss: 1.27760 (QuantReg: 15.36859) QuantErr: 15.36859 batch_time=0.38254 
Train Epoch: 17 [497/500 31808/32000 (99%)] Loss: 1.47440 (QuantReg: 15.47588) QuantErr: 15.47588 batch_time=0.39580 
Train Epoch: 17 codebook_update_time=2.08763
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch17.pth ...
Done in 20.243s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 1.8090103824138641
 quant_reg      : 15.249897638320922
 quant_err      : 15.249897638320922
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 8500
 LSMDC_full_test/t2v_metrics/R1: 11.8
 LSMDC_full_test/t2v_metrics/R5: 30.6
 LSMDC_full_test/t2v_metrics/R10: 39.9
 LSMDC_full_test/t2v_metrics/R50: 66.1
 LSMDC_full_test/t2v_metrics/MedR: 20.0
 LSMDC_full_test/t2v_metrics/MeanR: 74.552
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.332801306105104
 LSMDC_full_test/v2t_metrics/R1: 11.6
 LSMDC_full_test/v2t_metrics/R5: 29.4
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 66.2
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 75.029
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.91387183945665
 mnt_best       : 24.61759597721429
 not_improved_count: 4
Train Epoch: 18 [1/500 64/32000 (0%)] Loss: 2.00025 (QuantReg: 15.22635) QuantErr: 15.22635 batch_time=16.96221 
Train Epoch: 18 [9/500 576/32000 (2%)] Loss: 1.70313 (QuantReg: 15.35783) QuantErr: 15.35783 batch_time=0.37693 
Train Epoch: 18 [17/500 1088/32000 (3%)] Loss: 1.98401 (QuantReg: 15.27980) QuantErr: 15.27980 batch_time=0.92301 
Train Epoch: 18 [25/500 1600/32000 (5%)] Loss: 2.01374 (QuantReg: 15.13472) QuantErr: 15.13472 batch_time=0.39387 
Train Epoch: 18 [33/500 2112/32000 (7%)] Loss: 1.80383 (QuantReg: 14.93695) QuantErr: 14.93695 batch_time=0.38279 
Train Epoch: 18 [41/500 2624/32000 (8%)] Loss: 1.30321 (QuantReg: 15.41138) QuantErr: 15.41138 batch_time=0.38381 
Train Epoch: 18 [49/500 3136/32000 (10%)] Loss: 2.32608 (QuantReg: 15.03169) QuantErr: 15.03169 batch_time=0.41034 
Train Epoch: 18 [57/500 3648/32000 (11%)] Loss: 1.71087 (QuantReg: 15.34559) QuantErr: 15.34559 batch_time=0.38618 
Train Epoch: 18 [65/500 4160/32000 (13%)] Loss: 1.67593 (QuantReg: 14.97986) QuantErr: 14.97986 batch_time=1.08068 
Train Epoch: 18 [73/500 4672/32000 (15%)] Loss: 1.46599 (QuantReg: 15.30544) QuantErr: 15.30544 batch_time=0.39570 
Train Epoch: 18 [81/500 5184/32000 (16%)] Loss: 1.82889 (QuantReg: 15.16237) QuantErr: 15.16237 batch_time=0.78123 
Train Epoch: 18 [89/500 5696/32000 (18%)] Loss: 1.60276 (QuantReg: 15.54841) QuantErr: 15.54841 batch_time=0.38518 
Train Epoch: 18 [97/500 6208/32000 (19%)] Loss: 1.78296 (QuantReg: 15.33939) QuantErr: 15.33939 batch_time=0.40684 
Train Epoch: 18 [105/500 6720/32000 (21%)] Loss: 1.42456 (QuantReg: 15.42931) QuantErr: 15.42931 batch_time=0.38158 
Train Epoch: 18 [113/500 7232/32000 (23%)] Loss: 2.13680 (QuantReg: 15.07945) QuantErr: 15.07945 batch_time=0.38004 
Train Epoch: 18 [121/500 7744/32000 (24%)] Loss: 1.83703 (QuantReg: 15.33741) QuantErr: 15.33741 batch_time=0.37805 
Train Epoch: 18 [129/500 8256/32000 (26%)] Loss: 2.01623 (QuantReg: 15.13840) QuantErr: 15.13840 batch_time=1.10459 
Train Epoch: 18 [137/500 8768/32000 (27%)] Loss: 1.67170 (QuantReg: 14.93428) QuantErr: 14.93428 batch_time=0.38166 
Train Epoch: 18 [145/500 9280/32000 (29%)] Loss: 2.11732 (QuantReg: 15.34000) QuantErr: 15.34000 batch_time=0.78013 
Train Epoch: 18 [153/500 9792/32000 (31%)] Loss: 2.09432 (QuantReg: 15.35548) QuantErr: 15.35548 batch_time=0.37669 
Train Epoch: 18 [161/500 10304/32000 (32%)] Loss: 1.96305 (QuantReg: 15.17786) QuantErr: 15.17786 batch_time=0.37979 
Train Epoch: 18 [169/500 10816/32000 (34%)] Loss: 1.58683 (QuantReg: 15.13318) QuantErr: 15.13318 batch_time=0.40565 
Train Epoch: 18 [177/500 11328/32000 (35%)] Loss: 2.29310 (QuantReg: 15.27573) QuantErr: 15.27573 batch_time=0.39970 
Train Epoch: 18 [185/500 11840/32000 (37%)] Loss: 1.90782 (QuantReg: 15.37156) QuantErr: 15.37156 batch_time=0.39011 
Train Epoch: 18 [193/500 12352/32000 (39%)] Loss: 1.57620 (QuantReg: 15.42575) QuantErr: 15.42575 batch_time=1.09646 
Train Epoch: 18 [201/500 12864/32000 (40%)] Loss: 1.93715 (QuantReg: 15.31705) QuantErr: 15.31705 batch_time=0.38196 
Train Epoch: 18 [209/500 13376/32000 (42%)] Loss: 1.87030 (QuantReg: 15.13498) QuantErr: 15.13498 batch_time=0.83804 
Train Epoch: 18 [217/500 13888/32000 (43%)] Loss: 1.81436 (QuantReg: 14.99113) QuantErr: 14.99113 batch_time=0.38306 
Train Epoch: 18 [225/500 14400/32000 (45%)] Loss: 1.98068 (QuantReg: 15.41357) QuantErr: 15.41357 batch_time=0.40495 
Train Epoch: 18 [233/500 14912/32000 (47%)] Loss: 1.39173 (QuantReg: 15.21969) QuantErr: 15.21969 batch_time=0.41717 
Train Epoch: 18 [241/500 15424/32000 (48%)] Loss: 2.28130 (QuantReg: 14.97128) QuantErr: 14.97128 batch_time=0.38426 
Train Epoch: 18 [249/500 15936/32000 (50%)] Loss: 1.58170 (QuantReg: 15.36244) QuantErr: 15.36244 batch_time=0.38250 
Train Epoch: 18 [257/500 16448/32000 (51%)] Loss: 1.78580 (QuantReg: 15.12760) QuantErr: 15.12760 batch_time=1.07880 
Train Epoch: 18 [265/500 16960/32000 (53%)] Loss: 1.37065 (QuantReg: 15.33259) QuantErr: 15.33259 batch_time=0.38550 
Train Epoch: 18 [273/500 17472/32000 (55%)] Loss: 1.88698 (QuantReg: 15.48650) QuantErr: 15.48650 batch_time=0.79593 
Train Epoch: 18 [281/500 17984/32000 (56%)] Loss: 2.19123 (QuantReg: 15.51676) QuantErr: 15.51676 batch_time=0.41620 
Train Epoch: 18 [289/500 18496/32000 (58%)] Loss: 1.93731 (QuantReg: 15.24769) QuantErr: 15.24769 batch_time=0.38107 
Train Epoch: 18 [297/500 19008/32000 (59%)] Loss: 1.35153 (QuantReg: 15.37858) QuantErr: 15.37858 batch_time=0.38097 
Train Epoch: 18 [305/500 19520/32000 (61%)] Loss: 1.31449 (QuantReg: 15.44019) QuantErr: 15.44019 batch_time=0.37767 
Train Epoch: 18 [313/500 20032/32000 (63%)] Loss: 2.21436 (QuantReg: 15.16946) QuantErr: 15.16946 batch_time=0.39482 
Train Epoch: 18 [321/500 20544/32000 (64%)] Loss: 1.43514 (QuantReg: 15.21132) QuantErr: 15.21132 batch_time=1.07968 
Train Epoch: 18 [329/500 21056/32000 (66%)] Loss: 1.72394 (QuantReg: 15.23055) QuantErr: 15.23055 batch_time=0.38346 
Train Epoch: 18 [337/500 21568/32000 (67%)] Loss: 1.61125 (QuantReg: 15.47805) QuantErr: 15.47805 batch_time=0.76066 
Train Epoch: 18 [345/500 22080/32000 (69%)] Loss: 1.34314 (QuantReg: 15.14442) QuantErr: 15.14442 batch_time=0.38482 
Train Epoch: 18 [353/500 22592/32000 (71%)] Loss: 1.77100 (QuantReg: 15.48404) QuantErr: 15.48404 batch_time=0.38351 
Train Epoch: 18 [361/500 23104/32000 (72%)] Loss: 2.31128 (QuantReg: 15.60269) QuantErr: 15.60269 batch_time=0.40402 
Train Epoch: 18 [369/500 23616/32000 (74%)] Loss: 1.39771 (QuantReg: 15.23225) QuantErr: 15.23225 batch_time=0.37688 
Train Epoch: 18 [377/500 24128/32000 (75%)] Loss: 1.71491 (QuantReg: 15.49422) QuantErr: 15.49422 batch_time=0.38633 
Train Epoch: 18 [385/500 24640/32000 (77%)] Loss: 1.23074 (QuantReg: 15.34934) QuantErr: 15.34934 batch_time=1.03070 
Train Epoch: 18 [393/500 25152/32000 (79%)] Loss: 1.14842 (QuantReg: 15.75541) QuantErr: 15.75541 batch_time=0.39627 
Train Epoch: 18 [401/500 25664/32000 (80%)] Loss: 1.39298 (QuantReg: 15.34473) QuantErr: 15.34473 batch_time=0.81388 
Train Epoch: 18 [409/500 26176/32000 (82%)] Loss: 1.35309 (QuantReg: 15.53554) QuantErr: 15.53554 batch_time=0.40352 
Train Epoch: 18 [417/500 26688/32000 (83%)] Loss: 1.77330 (QuantReg: 15.47715) QuantErr: 15.47715 batch_time=0.38097 
Train Epoch: 18 [425/500 27200/32000 (85%)] Loss: 1.47390 (QuantReg: 15.58914) QuantErr: 15.58914 batch_time=0.37862 
Train Epoch: 18 [433/500 27712/32000 (87%)] Loss: 1.91427 (QuantReg: 15.28453) QuantErr: 15.28453 batch_time=0.39885 
Train Epoch: 18 [441/500 28224/32000 (88%)] Loss: 2.33865 (QuantReg: 15.42112) QuantErr: 15.42112 batch_time=0.37863 
Train Epoch: 18 [449/500 28736/32000 (90%)] Loss: 1.22618 (QuantReg: 15.45352) QuantErr: 15.45352 batch_time=1.09560 
Train Epoch: 18 [457/500 29248/32000 (91%)] Loss: 2.00104 (QuantReg: 15.34860) QuantErr: 15.34860 batch_time=0.38440 
Train Epoch: 18 [465/500 29760/32000 (93%)] Loss: 1.74340 (QuantReg: 15.24440) QuantErr: 15.24440 batch_time=0.77211 
Train Epoch: 18 [473/500 30272/32000 (95%)] Loss: 1.93824 (QuantReg: 15.17358) QuantErr: 15.17358 batch_time=0.40127 
Train Epoch: 18 [481/500 30784/32000 (96%)] Loss: 1.55185 (QuantReg: 15.38414) QuantErr: 15.38414 batch_time=0.39595 
Train Epoch: 18 [489/500 31296/32000 (98%)] Loss: 1.78503 (QuantReg: 15.04219) QuantErr: 15.04219 batch_time=0.38340 
Train Epoch: 18 [497/500 31808/32000 (99%)] Loss: 1.33771 (QuantReg: 15.47692) QuantErr: 15.47692 batch_time=0.39608 
Train Epoch: 18 codebook_update_time=2.23907
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch18.pth ...
Done in 5.100s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch18.pth ...
Done in 10.060s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 1.7312994692325592
 quant_reg      : 15.32430090713501
 quant_err      : 15.32430090713501
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 9000
 LSMDC_full_test/t2v_metrics/R1: 12.3
 LSMDC_full_test/t2v_metrics/R5: 31.2
 LSMDC_full_test/t2v_metrics/R10: 40.7
 LSMDC_full_test/t2v_metrics/R50: 66.8
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.192
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.996816661338077
 LSMDC_full_test/v2t_metrics/R1: 13.0
 LSMDC_full_test/v2t_metrics/R5: 29.0
 LSMDC_full_test/v2t_metrics/R10: 40.5
 LSMDC_full_test/v2t_metrics/R50: 67.0
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 72.456
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.80840202654003
 mnt_best       : 24.996816661338077
 not_improved_count: 0
Train Epoch: 19 [1/500 64/32000 (0%)] Loss: 1.74893 (QuantReg: 15.08624) QuantErr: 15.08624 batch_time=15.96926 
Train Epoch: 19 [9/500 576/32000 (2%)] Loss: 2.31738 (QuantReg: 15.22611) QuantErr: 15.22611 batch_time=0.38835 
Train Epoch: 19 [17/500 1088/32000 (3%)] Loss: 1.67585 (QuantReg: 15.61934) QuantErr: 15.61934 batch_time=1.39013 
Train Epoch: 19 [25/500 1600/32000 (5%)] Loss: 2.03796 (QuantReg: 15.71601) QuantErr: 15.71601 batch_time=0.38921 
Train Epoch: 19 [33/500 2112/32000 (7%)] Loss: 1.21871 (QuantReg: 15.20593) QuantErr: 15.20593 batch_time=0.40362 
Train Epoch: 19 [41/500 2624/32000 (8%)] Loss: 1.85929 (QuantReg: 15.28041) QuantErr: 15.28041 batch_time=0.38460 
Train Epoch: 19 [49/500 3136/32000 (10%)] Loss: 1.96123 (QuantReg: 15.11559) QuantErr: 15.11559 batch_time=0.39742 
Train Epoch: 19 [57/500 3648/32000 (11%)] Loss: 2.09055 (QuantReg: 15.17877) QuantErr: 15.17877 batch_time=0.38172 
Train Epoch: 19 [65/500 4160/32000 (13%)] Loss: 1.64956 (QuantReg: 14.98370) QuantErr: 14.98370 batch_time=0.66128 
Train Epoch: 19 [73/500 4672/32000 (15%)] Loss: 1.17689 (QuantReg: 15.29761) QuantErr: 15.29761 batch_time=0.38752 
Train Epoch: 19 [81/500 5184/32000 (16%)] Loss: 1.70616 (QuantReg: 15.24005) QuantErr: 15.24005 batch_time=1.19523 
Train Epoch: 19 [89/500 5696/32000 (18%)] Loss: 1.93991 (QuantReg: 15.45233) QuantErr: 15.45233 batch_time=0.38107 
Train Epoch: 19 [97/500 6208/32000 (19%)] Loss: 1.50865 (QuantReg: 15.67680) QuantErr: 15.67680 batch_time=0.39213 
Train Epoch: 19 [105/500 6720/32000 (21%)] Loss: 1.97738 (QuantReg: 15.27308) QuantErr: 15.27308 batch_time=0.38478 
Train Epoch: 19 [113/500 7232/32000 (23%)] Loss: 1.86647 (QuantReg: 15.43516) QuantErr: 15.43516 batch_time=0.40680 
Train Epoch: 19 [121/500 7744/32000 (24%)] Loss: 2.03382 (QuantReg: 15.42521) QuantErr: 15.42521 batch_time=0.37988 
Train Epoch: 19 [129/500 8256/32000 (26%)] Loss: 1.93424 (QuantReg: 15.10030) QuantErr: 15.10030 batch_time=0.63062 
Train Epoch: 19 [137/500 8768/32000 (27%)] Loss: 1.67032 (QuantReg: 15.49960) QuantErr: 15.49960 batch_time=0.39152 
Train Epoch: 19 [145/500 9280/32000 (29%)] Loss: 1.81920 (QuantReg: 15.45216) QuantErr: 15.45216 batch_time=1.20567 
Train Epoch: 19 [153/500 9792/32000 (31%)] Loss: 1.55061 (QuantReg: 15.43956) QuantErr: 15.43956 batch_time=0.38889 
Train Epoch: 19 [161/500 10304/32000 (32%)] Loss: 1.42698 (QuantReg: 15.40847) QuantErr: 15.40847 batch_time=0.40481 
Train Epoch: 19 [169/500 10816/32000 (34%)] Loss: 2.00892 (QuantReg: 15.00761) QuantErr: 15.00761 batch_time=0.39163 
Train Epoch: 19 [177/500 11328/32000 (35%)] Loss: 1.58584 (QuantReg: 15.44099) QuantErr: 15.44099 batch_time=0.38316 
Train Epoch: 19 [185/500 11840/32000 (37%)] Loss: 1.73871 (QuantReg: 15.41957) QuantErr: 15.41957 batch_time=0.37874 
Train Epoch: 19 [193/500 12352/32000 (39%)] Loss: 1.69015 (QuantReg: 15.52751) QuantErr: 15.52751 batch_time=0.64368 
Train Epoch: 19 [201/500 12864/32000 (40%)] Loss: 1.55008 (QuantReg: 15.68245) QuantErr: 15.68245 batch_time=0.37610 
Train Epoch: 19 [209/500 13376/32000 (42%)] Loss: 1.40147 (QuantReg: 15.26337) QuantErr: 15.26337 batch_time=1.19129 
Train Epoch: 19 [217/500 13888/32000 (43%)] Loss: 1.64326 (QuantReg: 15.29264) QuantErr: 15.29264 batch_time=0.38031 
Train Epoch: 19 [225/500 14400/32000 (45%)] Loss: 1.54133 (QuantReg: 15.61708) QuantErr: 15.61708 batch_time=0.40141 
Train Epoch: 19 [233/500 14912/32000 (47%)] Loss: 1.80821 (QuantReg: 15.19108) QuantErr: 15.19108 batch_time=0.37579 
Train Epoch: 19 [241/500 15424/32000 (48%)] Loss: 2.05905 (QuantReg: 15.19976) QuantErr: 15.19976 batch_time=0.37400 
Train Epoch: 19 [249/500 15936/32000 (50%)] Loss: 1.69411 (QuantReg: 15.41780) QuantErr: 15.41780 batch_time=0.39291 
Train Epoch: 19 [257/500 16448/32000 (51%)] Loss: 1.34550 (QuantReg: 15.31990) QuantErr: 15.31990 batch_time=0.72259 
Train Epoch: 19 [265/500 16960/32000 (53%)] Loss: 1.34812 (QuantReg: 15.53442) QuantErr: 15.53442 batch_time=0.42762 
Train Epoch: 19 [273/500 17472/32000 (55%)] Loss: 2.05737 (QuantReg: 15.13832) QuantErr: 15.13832 batch_time=1.24701 
Train Epoch: 19 [281/500 17984/32000 (56%)] Loss: 1.84148 (QuantReg: 15.43564) QuantErr: 15.43564 batch_time=0.38716 
Train Epoch: 19 [289/500 18496/32000 (58%)] Loss: 2.03926 (QuantReg: 15.31721) QuantErr: 15.31721 batch_time=0.38578 
Train Epoch: 19 [297/500 19008/32000 (59%)] Loss: 1.60599 (QuantReg: 15.29778) QuantErr: 15.29778 batch_time=0.39012 
Train Epoch: 19 [305/500 19520/32000 (61%)] Loss: 1.53193 (QuantReg: 15.31409) QuantErr: 15.31409 batch_time=0.40779 
Train Epoch: 19 [313/500 20032/32000 (63%)] Loss: 1.64434 (QuantReg: 15.51118) QuantErr: 15.51118 batch_time=0.39065 
Train Epoch: 19 [321/500 20544/32000 (64%)] Loss: 1.89935 (QuantReg: 15.12018) QuantErr: 15.12018 batch_time=0.64078 
Train Epoch: 19 [329/500 21056/32000 (66%)] Loss: 1.49365 (QuantReg: 15.45422) QuantErr: 15.45422 batch_time=0.38820 
Train Epoch: 19 [337/500 21568/32000 (67%)] Loss: 2.01661 (QuantReg: 15.34242) QuantErr: 15.34242 batch_time=1.20171 
Train Epoch: 19 [345/500 22080/32000 (69%)] Loss: 1.56162 (QuantReg: 15.29892) QuantErr: 15.29892 batch_time=0.37783 
Train Epoch: 19 [353/500 22592/32000 (71%)] Loss: 2.03885 (QuantReg: 15.59418) QuantErr: 15.59418 batch_time=0.38040 
Train Epoch: 19 [361/500 23104/32000 (72%)] Loss: 1.36504 (QuantReg: 15.53878) QuantErr: 15.53878 batch_time=0.38088 
Train Epoch: 19 [369/500 23616/32000 (74%)] Loss: 1.48694 (QuantReg: 15.45576) QuantErr: 15.45576 batch_time=0.37568 
Train Epoch: 19 [377/500 24128/32000 (75%)] Loss: 1.48316 (QuantReg: 15.25111) QuantErr: 15.25111 batch_time=0.37744 
Train Epoch: 19 [385/500 24640/32000 (77%)] Loss: 1.50843 (QuantReg: 15.42663) QuantErr: 15.42663 batch_time=0.65491 
Train Epoch: 19 [393/500 25152/32000 (79%)] Loss: 2.15982 (QuantReg: 15.13609) QuantErr: 15.13609 batch_time=0.38312 
Train Epoch: 19 [401/500 25664/32000 (80%)] Loss: 1.58643 (QuantReg: 15.61091) QuantErr: 15.61091 batch_time=1.18250 
Train Epoch: 19 [409/500 26176/32000 (82%)] Loss: 1.56384 (QuantReg: 15.45998) QuantErr: 15.45998 batch_time=0.38719 
Train Epoch: 19 [417/500 26688/32000 (83%)] Loss: 1.35923 (QuantReg: 15.81317) QuantErr: 15.81317 batch_time=0.37970 
Train Epoch: 19 [425/500 27200/32000 (85%)] Loss: 1.22707 (QuantReg: 15.36651) QuantErr: 15.36651 batch_time=0.39013 
Train Epoch: 19 [433/500 27712/32000 (87%)] Loss: 2.05324 (QuantReg: 15.36117) QuantErr: 15.36117 batch_time=0.38077 
Train Epoch: 19 [441/500 28224/32000 (88%)] Loss: 1.45438 (QuantReg: 15.18182) QuantErr: 15.18182 batch_time=0.37669 
Train Epoch: 19 [449/500 28736/32000 (90%)] Loss: 1.80486 (QuantReg: 15.48454) QuantErr: 15.48454 batch_time=0.67490 
Train Epoch: 19 [457/500 29248/32000 (91%)] Loss: 1.32048 (QuantReg: 15.56994) QuantErr: 15.56994 batch_time=0.39060 
Train Epoch: 19 [465/500 29760/32000 (93%)] Loss: 1.81861 (QuantReg: 15.45441) QuantErr: 15.45441 batch_time=1.22348 
Train Epoch: 19 [473/500 30272/32000 (95%)] Loss: 2.14818 (QuantReg: 15.41552) QuantErr: 15.41552 batch_time=0.40122 
Train Epoch: 19 [481/500 30784/32000 (96%)] Loss: 1.47756 (QuantReg: 15.72680) QuantErr: 15.72680 batch_time=0.37360 
Train Epoch: 19 [489/500 31296/32000 (98%)] Loss: 1.56312 (QuantReg: 15.60118) QuantErr: 15.60118 batch_time=0.37627 
Train Epoch: 19 [497/500 31808/32000 (99%)] Loss: 1.87390 (QuantReg: 15.58946) QuantErr: 15.58946 batch_time=0.38677 
Train Epoch: 19 codebook_update_time=1.76243
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch19.pth ...
Done in 5.689s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 1.654392564535141
 quant_reg      : 15.41142632484436
 quant_err      : 15.41142632484436
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 9500
 LSMDC_full_test/t2v_metrics/R1: 12.4
 LSMDC_full_test/t2v_metrics/R5: 30.6
 LSMDC_full_test/t2v_metrics/R10: 39.5
 LSMDC_full_test/t2v_metrics/R50: 68.4
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.363
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.655476622313138
 LSMDC_full_test/v2t_metrics/R1: 11.9
 LSMDC_full_test/v2t_metrics/R5: 30.1
 LSMDC_full_test/v2t_metrics/R10: 40.0
 LSMDC_full_test/v2t_metrics/R50: 66.0
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.394
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.28796617774156
 mnt_best       : 24.996816661338077
 not_improved_count: 1
Train Epoch: 20 [1/500 64/32000 (0%)] Loss: 1.52679 (QuantReg: 15.57121) QuantErr: 15.57121 batch_time=14.61058 
Train Epoch: 20 [9/500 576/32000 (2%)] Loss: 2.25010 (QuantReg: 15.43884) QuantErr: 15.43884 batch_time=0.39360 
Train Epoch: 20 [17/500 1088/32000 (3%)] Loss: 1.66915 (QuantReg: 15.31649) QuantErr: 15.31649 batch_time=1.77319 
Train Epoch: 20 [25/500 1600/32000 (5%)] Loss: 1.94431 (QuantReg: 15.52267) QuantErr: 15.52267 batch_time=0.38828 
Train Epoch: 20 [33/500 2112/32000 (7%)] Loss: 1.24238 (QuantReg: 15.78578) QuantErr: 15.78578 batch_time=0.41645 
Train Epoch: 20 [41/500 2624/32000 (8%)] Loss: 1.16340 (QuantReg: 15.49457) QuantErr: 15.49457 batch_time=0.38287 
Train Epoch: 20 [49/500 3136/32000 (10%)] Loss: 1.63552 (QuantReg: 15.41677) QuantErr: 15.41677 batch_time=0.39533 
Train Epoch: 20 [57/500 3648/32000 (11%)] Loss: 1.70262 (QuantReg: 15.28838) QuantErr: 15.28838 batch_time=0.40222 
Train Epoch: 20 [65/500 4160/32000 (13%)] Loss: 1.64583 (QuantReg: 15.42805) QuantErr: 15.42805 batch_time=0.38411 
Train Epoch: 20 [73/500 4672/32000 (15%)] Loss: 1.73023 (QuantReg: 15.35285) QuantErr: 15.35285 batch_time=0.38408 
Train Epoch: 20 [81/500 5184/32000 (16%)] Loss: 1.54797 (QuantReg: 15.56353) QuantErr: 15.56353 batch_time=1.38053 
Train Epoch: 20 [89/500 5696/32000 (18%)] Loss: 1.47440 (QuantReg: 15.61512) QuantErr: 15.61512 batch_time=0.39235 
Train Epoch: 20 [97/500 6208/32000 (19%)] Loss: 1.51898 (QuantReg: 15.45708) QuantErr: 15.45708 batch_time=0.39322 
Train Epoch: 20 [105/500 6720/32000 (21%)] Loss: 1.80337 (QuantReg: 15.32823) QuantErr: 15.32823 batch_time=0.38990 
Train Epoch: 20 [113/500 7232/32000 (23%)] Loss: 1.52806 (QuantReg: 15.29977) QuantErr: 15.29977 batch_time=0.39080 
Train Epoch: 20 [121/500 7744/32000 (24%)] Loss: 1.52538 (QuantReg: 15.38601) QuantErr: 15.38601 batch_time=0.39049 
Train Epoch: 20 [129/500 8256/32000 (26%)] Loss: 1.81379 (QuantReg: 15.16353) QuantErr: 15.16353 batch_time=0.39815 
Train Epoch: 20 [137/500 8768/32000 (27%)] Loss: 1.90665 (QuantReg: 15.34259) QuantErr: 15.34259 batch_time=0.38314 
Train Epoch: 20 [145/500 9280/32000 (29%)] Loss: 2.01952 (QuantReg: 15.11293) QuantErr: 15.11293 batch_time=1.37776 
Train Epoch: 20 [153/500 9792/32000 (31%)] Loss: 2.53903 (QuantReg: 15.23245) QuantErr: 15.23245 batch_time=0.38432 
Train Epoch: 20 [161/500 10304/32000 (32%)] Loss: 1.62626 (QuantReg: 15.34121) QuantErr: 15.34121 batch_time=0.38373 
Train Epoch: 20 [169/500 10816/32000 (34%)] Loss: 1.04076 (QuantReg: 15.44087) QuantErr: 15.44087 batch_time=0.39012 
Train Epoch: 20 [177/500 11328/32000 (35%)] Loss: 1.63854 (QuantReg: 15.12841) QuantErr: 15.12841 batch_time=0.37984 
Train Epoch: 20 [185/500 11840/32000 (37%)] Loss: 1.79225 (QuantReg: 15.40404) QuantErr: 15.40404 batch_time=0.38103 
Train Epoch: 20 [193/500 12352/32000 (39%)] Loss: 1.47717 (QuantReg: 15.39388) QuantErr: 15.39388 batch_time=0.38641 
Train Epoch: 20 [201/500 12864/32000 (40%)] Loss: 1.68981 (QuantReg: 15.59197) QuantErr: 15.59197 batch_time=0.39090 
Train Epoch: 20 [209/500 13376/32000 (42%)] Loss: 1.90260 (QuantReg: 15.36709) QuantErr: 15.36709 batch_time=1.33539 
Train Epoch: 20 [217/500 13888/32000 (43%)] Loss: 1.71333 (QuantReg: 15.24966) QuantErr: 15.24966 batch_time=0.38773 
Train Epoch: 20 [225/500 14400/32000 (45%)] Loss: 1.77285 (QuantReg: 15.52609) QuantErr: 15.52609 batch_time=0.38459 
Train Epoch: 20 [233/500 14912/32000 (47%)] Loss: 1.97525 (QuantReg: 15.51524) QuantErr: 15.51524 batch_time=0.42315 
Train Epoch: 20 [241/500 15424/32000 (48%)] Loss: 1.66017 (QuantReg: 15.23125) QuantErr: 15.23125 batch_time=0.38120 
Train Epoch: 20 [249/500 15936/32000 (50%)] Loss: 1.75774 (QuantReg: 15.54188) QuantErr: 15.54188 batch_time=0.38390 
Train Epoch: 20 [257/500 16448/32000 (51%)] Loss: 1.91614 (QuantReg: 15.56674) QuantErr: 15.56674 batch_time=0.38465 
Train Epoch: 20 [265/500 16960/32000 (53%)] Loss: 1.86800 (QuantReg: 15.42658) QuantErr: 15.42658 batch_time=0.38316 
Train Epoch: 20 [273/500 17472/32000 (55%)] Loss: 1.20059 (QuantReg: 15.32915) QuantErr: 15.32915 batch_time=1.32957 
Train Epoch: 20 [281/500 17984/32000 (56%)] Loss: 1.64811 (QuantReg: 15.44599) QuantErr: 15.44599 batch_time=0.38650 
Train Epoch: 20 [289/500 18496/32000 (58%)] Loss: 1.43423 (QuantReg: 15.40339) QuantErr: 15.40339 batch_time=0.38962 
Train Epoch: 20 [297/500 19008/32000 (59%)] Loss: 2.37872 (QuantReg: 15.05891) QuantErr: 15.05891 batch_time=0.37814 
Train Epoch: 20 [305/500 19520/32000 (61%)] Loss: 1.51127 (QuantReg: 15.55014) QuantErr: 15.55014 batch_time=0.38020 
Train Epoch: 20 [313/500 20032/32000 (63%)] Loss: 0.98928 (QuantReg: 15.55023) QuantErr: 15.55023 batch_time=0.37768 
Train Epoch: 20 [321/500 20544/32000 (64%)] Loss: 1.30425 (QuantReg: 15.46716) QuantErr: 15.46716 batch_time=0.38068 
Train Epoch: 20 [329/500 21056/32000 (66%)] Loss: 1.69161 (QuantReg: 15.66987) QuantErr: 15.66987 batch_time=0.39486 
Train Epoch: 20 [337/500 21568/32000 (67%)] Loss: 1.48759 (QuantReg: 15.39330) QuantErr: 15.39330 batch_time=1.30976 
Train Epoch: 20 [345/500 22080/32000 (69%)] Loss: 1.60660 (QuantReg: 15.57042) QuantErr: 15.57042 batch_time=0.38324 
Train Epoch: 20 [353/500 22592/32000 (71%)] Loss: 0.98483 (QuantReg: 15.41183) QuantErr: 15.41183 batch_time=0.39156 
Train Epoch: 20 [361/500 23104/32000 (72%)] Loss: 1.66576 (QuantReg: 15.40818) QuantErr: 15.40818 batch_time=0.38273 
Train Epoch: 20 [369/500 23616/32000 (74%)] Loss: 1.72529 (QuantReg: 15.35239) QuantErr: 15.35239 batch_time=0.37956 
Train Epoch: 20 [377/500 24128/32000 (75%)] Loss: 1.33534 (QuantReg: 15.46390) QuantErr: 15.46390 batch_time=0.38042 
Train Epoch: 20 [385/500 24640/32000 (77%)] Loss: 1.51791 (QuantReg: 15.47520) QuantErr: 15.47520 batch_time=0.39804 
Train Epoch: 20 [393/500 25152/32000 (79%)] Loss: 1.19504 (QuantReg: 15.93281) QuantErr: 15.93281 batch_time=0.38586 
Train Epoch: 20 [401/500 25664/32000 (80%)] Loss: 1.75919 (QuantReg: 15.36591) QuantErr: 15.36591 batch_time=1.30929 
Train Epoch: 20 [409/500 26176/32000 (82%)] Loss: 1.71267 (QuantReg: 15.38999) QuantErr: 15.38999 batch_time=0.38189 
Train Epoch: 20 [417/500 26688/32000 (83%)] Loss: 1.56917 (QuantReg: 15.38265) QuantErr: 15.38265 batch_time=0.38139 
Train Epoch: 20 [425/500 27200/32000 (85%)] Loss: 1.22146 (QuantReg: 15.61717) QuantErr: 15.61717 batch_time=0.38314 
Train Epoch: 20 [433/500 27712/32000 (87%)] Loss: 1.93483 (QuantReg: 15.38432) QuantErr: 15.38432 batch_time=0.37491 
Train Epoch: 20 [441/500 28224/32000 (88%)] Loss: 1.43238 (QuantReg: 15.75074) QuantErr: 15.75074 batch_time=0.37539 
Train Epoch: 20 [449/500 28736/32000 (90%)] Loss: 1.55098 (QuantReg: 15.48745) QuantErr: 15.48745 batch_time=0.39570 
Train Epoch: 20 [457/500 29248/32000 (91%)] Loss: 1.93689 (QuantReg: 15.64669) QuantErr: 15.64669 batch_time=0.37756 
Train Epoch: 20 [465/500 29760/32000 (93%)] Loss: 1.52561 (QuantReg: 15.74019) QuantErr: 15.74019 batch_time=1.32452 
Train Epoch: 20 [473/500 30272/32000 (95%)] Loss: 1.45974 (QuantReg: 15.53420) QuantErr: 15.53420 batch_time=0.37941 
Train Epoch: 20 [481/500 30784/32000 (96%)] Loss: 1.30148 (QuantReg: 15.40797) QuantErr: 15.40797 batch_time=0.38105 
Train Epoch: 20 [489/500 31296/32000 (98%)] Loss: 1.87714 (QuantReg: 15.43665) QuantErr: 15.43665 batch_time=0.38149 
Train Epoch: 20 [497/500 31808/32000 (99%)] Loss: 1.74448 (QuantReg: 15.43542) QuantErr: 15.43542 batch_time=0.37989 
Train Epoch: 20 codebook_update_time=2.34629
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch20.pth ...
Done in 4.122s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch20.pth ...
Done in 8.005s
removing stale ckpt [epoch 19] [took 0.01s]
 epoch          : 20
 loss           : 1.6048781113624573
 quant_reg      : 15.439783752441405
 quant_err      : 15.439783752441405
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 10000
 LSMDC_full_test/t2v_metrics/R1: 12.9
 LSMDC_full_test/t2v_metrics/R5: 31.0
 LSMDC_full_test/t2v_metrics/R10: 40.9
 LSMDC_full_test/t2v_metrics/R50: 67.7
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.384
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.383893523302568
 LSMDC_full_test/v2t_metrics/R1: 13.3
 LSMDC_full_test/v2t_metrics/R5: 30.4
 LSMDC_full_test/v2t_metrics/R10: 39.6
 LSMDC_full_test/v2t_metrics/R50: 66.7
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.524
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.20423209345432
 mnt_best       : 25.383893523302568
 not_improved_count: 0
Train Epoch: 21 [1/500 64/32000 (0%)] Loss: 1.30172 (QuantReg: 15.58827) QuantErr: 15.58827 batch_time=15.66764 
Train Epoch: 21 [9/500 576/32000 (2%)] Loss: 1.57392 (QuantReg: 15.31950) QuantErr: 15.31950 batch_time=0.37741 
Train Epoch: 21 [17/500 1088/32000 (3%)] Loss: 1.19825 (QuantReg: 15.40560) QuantErr: 15.40560 batch_time=0.37923 
Train Epoch: 21 [25/500 1600/32000 (5%)] Loss: 1.93231 (QuantReg: 15.52517) QuantErr: 15.52517 batch_time=0.40923 
Train Epoch: 21 [33/500 2112/32000 (7%)] Loss: 1.33699 (QuantReg: 15.49898) QuantErr: 15.49898 batch_time=0.45317 
Train Epoch: 21 [41/500 2624/32000 (8%)] Loss: 1.34752 (QuantReg: 15.62806) QuantErr: 15.62806 batch_time=0.41818 
Train Epoch: 21 [49/500 3136/32000 (10%)] Loss: 1.54302 (QuantReg: 15.60817) QuantErr: 15.60817 batch_time=0.87271 
Train Epoch: 21 [57/500 3648/32000 (11%)] Loss: 2.16018 (QuantReg: 15.36883) QuantErr: 15.36883 batch_time=0.37848 
Train Epoch: 21 [65/500 4160/32000 (13%)] Loss: 1.19668 (QuantReg: 15.38472) QuantErr: 15.38472 batch_time=0.82933 
Train Epoch: 21 [73/500 4672/32000 (15%)] Loss: 1.34383 (QuantReg: 15.34218) QuantErr: 15.34218 batch_time=0.38179 
Train Epoch: 21 [81/500 5184/32000 (16%)] Loss: 1.26738 (QuantReg: 15.71048) QuantErr: 15.71048 batch_time=0.41804 
Train Epoch: 21 [89/500 5696/32000 (18%)] Loss: 1.46924 (QuantReg: 15.53622) QuantErr: 15.53622 batch_time=0.40927 
Train Epoch: 21 [97/500 6208/32000 (19%)] Loss: 1.54355 (QuantReg: 15.49469) QuantErr: 15.49469 batch_time=0.43624 
Train Epoch: 21 [105/500 6720/32000 (21%)] Loss: 1.47001 (QuantReg: 15.33588) QuantErr: 15.33588 batch_time=0.37710 
Train Epoch: 21 [113/500 7232/32000 (23%)] Loss: 1.52543 (QuantReg: 15.26860) QuantErr: 15.26860 batch_time=0.39307 
Train Epoch: 21 [121/500 7744/32000 (24%)] Loss: 1.37020 (QuantReg: 15.43760) QuantErr: 15.43760 batch_time=0.37685 
Train Epoch: 21 [129/500 8256/32000 (26%)] Loss: 1.82717 (QuantReg: 15.74594) QuantErr: 15.74594 batch_time=0.82569 
Train Epoch: 21 [137/500 8768/32000 (27%)] Loss: 0.95615 (QuantReg: 15.54693) QuantErr: 15.54693 batch_time=0.39415 
Train Epoch: 21 [145/500 9280/32000 (29%)] Loss: 1.63471 (QuantReg: 15.46181) QuantErr: 15.46181 batch_time=0.39402 
Train Epoch: 21 [153/500 9792/32000 (31%)] Loss: 1.27906 (QuantReg: 15.48080) QuantErr: 15.48080 batch_time=0.38348 
Train Epoch: 21 [161/500 10304/32000 (32%)] Loss: 1.79696 (QuantReg: 15.31538) QuantErr: 15.31538 batch_time=0.47850 
Train Epoch: 21 [169/500 10816/32000 (34%)] Loss: 1.74843 (QuantReg: 15.22626) QuantErr: 15.22626 batch_time=0.43663 
Train Epoch: 21 [177/500 11328/32000 (35%)] Loss: 1.46976 (QuantReg: 15.56820) QuantErr: 15.56820 batch_time=0.38198 
Train Epoch: 21 [185/500 11840/32000 (37%)] Loss: 1.44108 (QuantReg: 15.58379) QuantErr: 15.58379 batch_time=0.38381 
Train Epoch: 21 [193/500 12352/32000 (39%)] Loss: 1.14836 (QuantReg: 15.65546) QuantErr: 15.65546 batch_time=0.80733 
Train Epoch: 21 [201/500 12864/32000 (40%)] Loss: 1.13882 (QuantReg: 15.59346) QuantErr: 15.59346 batch_time=0.42158 
Train Epoch: 21 [209/500 13376/32000 (42%)] Loss: 1.28830 (QuantReg: 15.29988) QuantErr: 15.29988 batch_time=0.37793 
Train Epoch: 21 [217/500 13888/32000 (43%)] Loss: 1.62445 (QuantReg: 15.47236) QuantErr: 15.47236 batch_time=0.38058 
Train Epoch: 21 [225/500 14400/32000 (45%)] Loss: 2.41154 (QuantReg: 15.40273) QuantErr: 15.40273 batch_time=0.44052 
Train Epoch: 21 [233/500 14912/32000 (47%)] Loss: 1.68483 (QuantReg: 15.66446) QuantErr: 15.66446 batch_time=0.39045 
Train Epoch: 21 [241/500 15424/32000 (48%)] Loss: 1.61918 (QuantReg: 15.53990) QuantErr: 15.53990 batch_time=0.40195 
Train Epoch: 21 [249/500 15936/32000 (50%)] Loss: 1.29770 (QuantReg: 15.41629) QuantErr: 15.41629 batch_time=0.39111 
Train Epoch: 21 [257/500 16448/32000 (51%)] Loss: 1.59584 (QuantReg: 15.34717) QuantErr: 15.34717 batch_time=0.77459 
Train Epoch: 21 [265/500 16960/32000 (53%)] Loss: 1.36569 (QuantReg: 15.50820) QuantErr: 15.50820 batch_time=0.38095 
Train Epoch: 21 [273/500 17472/32000 (55%)] Loss: 1.77193 (QuantReg: 15.36064) QuantErr: 15.36064 batch_time=0.40262 
Train Epoch: 21 [281/500 17984/32000 (56%)] Loss: 1.60399 (QuantReg: 15.54123) QuantErr: 15.54123 batch_time=0.38003 
Train Epoch: 21 [289/500 18496/32000 (58%)] Loss: 1.60779 (QuantReg: 15.45867) QuantErr: 15.45867 batch_time=0.43696 
Train Epoch: 21 [297/500 19008/32000 (59%)] Loss: 1.58564 (QuantReg: 15.33490) QuantErr: 15.33490 batch_time=0.38721 
Train Epoch: 21 [305/500 19520/32000 (61%)] Loss: 1.34004 (QuantReg: 15.30557) QuantErr: 15.30557 batch_time=0.42055 
Train Epoch: 21 [313/500 20032/32000 (63%)] Loss: 1.80021 (QuantReg: 15.40855) QuantErr: 15.40855 batch_time=0.37637 
Train Epoch: 21 [321/500 20544/32000 (64%)] Loss: 2.26093 (QuantReg: 15.57445) QuantErr: 15.57445 batch_time=0.81908 
Train Epoch: 21 [329/500 21056/32000 (66%)] Loss: 1.53107 (QuantReg: 15.52204) QuantErr: 15.52204 batch_time=0.37807 
Train Epoch: 21 [337/500 21568/32000 (67%)] Loss: 1.66152 (QuantReg: 15.44127) QuantErr: 15.44127 batch_time=0.38674 
Train Epoch: 21 [345/500 22080/32000 (69%)] Loss: 1.44367 (QuantReg: 15.58284) QuantErr: 15.58284 batch_time=0.38414 
Train Epoch: 21 [353/500 22592/32000 (71%)] Loss: 1.34188 (QuantReg: 15.75657) QuantErr: 15.75657 batch_time=0.43224 
Train Epoch: 21 [361/500 23104/32000 (72%)] Loss: 1.41069 (QuantReg: 15.69876) QuantErr: 15.69876 batch_time=0.38572 
Train Epoch: 21 [369/500 23616/32000 (74%)] Loss: 1.83099 (QuantReg: 15.45262) QuantErr: 15.45262 batch_time=0.41837 
Train Epoch: 21 [377/500 24128/32000 (75%)] Loss: 2.02203 (QuantReg: 15.30063) QuantErr: 15.30063 batch_time=0.37472 
Train Epoch: 21 [385/500 24640/32000 (77%)] Loss: 1.56632 (QuantReg: 15.35611) QuantErr: 15.35611 batch_time=0.77206 
Train Epoch: 21 [393/500 25152/32000 (79%)] Loss: 1.57438 (QuantReg: 15.67445) QuantErr: 15.67445 batch_time=0.37997 
Train Epoch: 21 [401/500 25664/32000 (80%)] Loss: 1.78268 (QuantReg: 15.36490) QuantErr: 15.36490 batch_time=0.40721 
Train Epoch: 21 [409/500 26176/32000 (82%)] Loss: 1.63638 (QuantReg: 15.72710) QuantErr: 15.72710 batch_time=0.38480 
Train Epoch: 21 [417/500 26688/32000 (83%)] Loss: 1.45367 (QuantReg: 15.73528) QuantErr: 15.73528 batch_time=0.50312 
Train Epoch: 21 [425/500 27200/32000 (85%)] Loss: 0.99849 (QuantReg: 15.77008) QuantErr: 15.77008 batch_time=0.37374 
Train Epoch: 21 [433/500 27712/32000 (87%)] Loss: 1.50473 (QuantReg: 15.54327) QuantErr: 15.54327 batch_time=0.37423 
Train Epoch: 21 [441/500 28224/32000 (88%)] Loss: 1.21050 (QuantReg: 15.69493) QuantErr: 15.69493 batch_time=0.38533 
Train Epoch: 21 [449/500 28736/32000 (90%)] Loss: 1.83276 (QuantReg: 15.49950) QuantErr: 15.49950 batch_time=0.79057 
Train Epoch: 21 [457/500 29248/32000 (91%)] Loss: 1.22617 (QuantReg: 15.29892) QuantErr: 15.29892 batch_time=0.40251 
Train Epoch: 21 [465/500 29760/32000 (93%)] Loss: 1.23958 (QuantReg: 15.43307) QuantErr: 15.43307 batch_time=0.37964 
Train Epoch: 21 [473/500 30272/32000 (95%)] Loss: 1.56640 (QuantReg: 15.75388) QuantErr: 15.75388 batch_time=0.41633 
Train Epoch: 21 [481/500 30784/32000 (96%)] Loss: 0.99409 (QuantReg: 15.46984) QuantErr: 15.46984 batch_time=0.45309 
Train Epoch: 21 [489/500 31296/32000 (98%)] Loss: 1.72215 (QuantReg: 15.30125) QuantErr: 15.30125 batch_time=0.37856 
Train Epoch: 21 [497/500 31808/32000 (99%)] Loss: 1.84142 (QuantReg: 15.46109) QuantErr: 15.46109 batch_time=0.38506 
Train Epoch: 21 codebook_update_time=2.37927
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch21.pth ...
Done in 5.047s
removing stale ckpt [epoch 20] [took 0.07s]
 epoch          : 21
 loss           : 1.5246262458562851
 quant_reg      : 15.493428829193116
 quant_err      : 15.493428829193116
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 10500
 LSMDC_full_test/t2v_metrics/R1: 12.4
 LSMDC_full_test/t2v_metrics/R5: 30.9
 LSMDC_full_test/t2v_metrics/R10: 41.2
 LSMDC_full_test/t2v_metrics/R50: 68.1
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.21
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.085675122204194
 LSMDC_full_test/v2t_metrics/R1: 13.1
 LSMDC_full_test/v2t_metrics/R5: 30.5
 LSMDC_full_test/v2t_metrics/R10: 40.0
 LSMDC_full_test/v2t_metrics/R50: 65.4
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.214
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.18896804427892
 mnt_best       : 25.383893523302568
 not_improved_count: 1
Train Epoch: 22 [1/500 64/32000 (0%)] Loss: 1.45377 (QuantReg: 15.25183) QuantErr: 15.25183 batch_time=16.47452 
Train Epoch: 22 [9/500 576/32000 (2%)] Loss: 1.59099 (QuantReg: 15.22106) QuantErr: 15.22106 batch_time=0.37376 
Train Epoch: 22 [17/500 1088/32000 (3%)] Loss: 1.41795 (QuantReg: 15.79773) QuantErr: 15.79773 batch_time=0.37490 
Train Epoch: 22 [25/500 1600/32000 (5%)] Loss: 1.17037 (QuantReg: 15.34631) QuantErr: 15.34631 batch_time=0.54530 
Train Epoch: 22 [33/500 2112/32000 (7%)] Loss: 1.46972 (QuantReg: 15.45689) QuantErr: 15.45689 batch_time=0.41113 
Train Epoch: 22 [41/500 2624/32000 (8%)] Loss: 1.21057 (QuantReg: 15.43957) QuantErr: 15.43957 batch_time=0.38084 
Train Epoch: 22 [49/500 3136/32000 (10%)] Loss: 1.59112 (QuantReg: 15.65992) QuantErr: 15.65992 batch_time=0.38045 
Train Epoch: 22 [57/500 3648/32000 (11%)] Loss: 1.56774 (QuantReg: 15.34509) QuantErr: 15.34509 batch_time=0.38008 
Train Epoch: 22 [65/500 4160/32000 (13%)] Loss: 1.48834 (QuantReg: 15.70337) QuantErr: 15.70337 batch_time=0.85878 
Train Epoch: 22 [73/500 4672/32000 (15%)] Loss: 1.68908 (QuantReg: 15.82022) QuantErr: 15.82022 batch_time=0.37577 
Train Epoch: 22 [81/500 5184/32000 (16%)] Loss: 1.33276 (QuantReg: 15.32402) QuantErr: 15.32402 batch_time=0.37464 
Train Epoch: 22 [89/500 5696/32000 (18%)] Loss: 1.31249 (QuantReg: 15.62029) QuantErr: 15.62029 batch_time=0.55963 
Train Epoch: 22 [97/500 6208/32000 (19%)] Loss: 1.98033 (QuantReg: 15.32331) QuantErr: 15.32331 batch_time=0.38383 
Train Epoch: 22 [105/500 6720/32000 (21%)] Loss: 1.28958 (QuantReg: 15.34051) QuantErr: 15.34051 batch_time=0.38767 
Train Epoch: 22 [113/500 7232/32000 (23%)] Loss: 1.83194 (QuantReg: 15.57362) QuantErr: 15.57362 batch_time=0.38856 
Train Epoch: 22 [121/500 7744/32000 (24%)] Loss: 1.71523 (QuantReg: 15.34805) QuantErr: 15.34805 batch_time=0.38607 
Train Epoch: 22 [129/500 8256/32000 (26%)] Loss: 1.65558 (QuantReg: 15.57761) QuantErr: 15.57761 batch_time=0.88639 
Train Epoch: 22 [137/500 8768/32000 (27%)] Loss: 1.23488 (QuantReg: 15.51112) QuantErr: 15.51112 batch_time=0.40611 
Train Epoch: 22 [145/500 9280/32000 (29%)] Loss: 1.63721 (QuantReg: 15.52447) QuantErr: 15.52447 batch_time=0.39182 
Train Epoch: 22 [153/500 9792/32000 (31%)] Loss: 1.63590 (QuantReg: 15.69461) QuantErr: 15.69461 batch_time=0.64662 
Train Epoch: 22 [161/500 10304/32000 (32%)] Loss: 1.39475 (QuantReg: 15.52867) QuantErr: 15.52867 batch_time=0.40295 
Train Epoch: 22 [169/500 10816/32000 (34%)] Loss: 1.43527 (QuantReg: 15.50678) QuantErr: 15.50678 batch_time=0.39997 
Train Epoch: 22 [177/500 11328/32000 (35%)] Loss: 1.30372 (QuantReg: 15.60656) QuantErr: 15.60656 batch_time=0.39059 
Train Epoch: 22 [185/500 11840/32000 (37%)] Loss: 1.85275 (QuantReg: 15.72260) QuantErr: 15.72260 batch_time=0.39167 
Train Epoch: 22 [193/500 12352/32000 (39%)] Loss: 1.09546 (QuantReg: 15.77176) QuantErr: 15.77176 batch_time=0.87696 
Train Epoch: 22 [201/500 12864/32000 (40%)] Loss: 1.09690 (QuantReg: 15.63703) QuantErr: 15.63703 batch_time=0.38185 
Train Epoch: 22 [209/500 13376/32000 (42%)] Loss: 1.11466 (QuantReg: 15.53890) QuantErr: 15.53890 batch_time=0.37986 
Train Epoch: 22 [217/500 13888/32000 (43%)] Loss: 1.69750 (QuantReg: 15.82390) QuantErr: 15.82390 batch_time=0.67287 
Train Epoch: 22 [225/500 14400/32000 (45%)] Loss: 1.22729 (QuantReg: 15.60077) QuantErr: 15.60077 batch_time=0.39037 
Train Epoch: 22 [233/500 14912/32000 (47%)] Loss: 1.89184 (QuantReg: 15.37764) QuantErr: 15.37764 batch_time=0.40358 
Train Epoch: 22 [241/500 15424/32000 (48%)] Loss: 1.35773 (QuantReg: 15.75924) QuantErr: 15.75924 batch_time=0.38942 
Train Epoch: 22 [249/500 15936/32000 (50%)] Loss: 1.35240 (QuantReg: 15.43858) QuantErr: 15.43858 batch_time=0.40663 
Train Epoch: 22 [257/500 16448/32000 (51%)] Loss: 1.39160 (QuantReg: 15.45985) QuantErr: 15.45985 batch_time=0.87947 
Train Epoch: 22 [265/500 16960/32000 (53%)] Loss: 1.60366 (QuantReg: 15.74309) QuantErr: 15.74309 batch_time=0.38760 
Train Epoch: 22 [273/500 17472/32000 (55%)] Loss: 1.45723 (QuantReg: 15.57543) QuantErr: 15.57543 batch_time=0.38595 
Train Epoch: 22 [281/500 17984/32000 (56%)] Loss: 1.77274 (QuantReg: 15.69850) QuantErr: 15.69850 batch_time=0.65971 
Train Epoch: 22 [289/500 18496/32000 (58%)] Loss: 1.37504 (QuantReg: 15.55063) QuantErr: 15.55063 batch_time=0.39108 
Train Epoch: 22 [297/500 19008/32000 (59%)] Loss: 1.20468 (QuantReg: 15.47378) QuantErr: 15.47378 batch_time=0.39415 
Train Epoch: 22 [305/500 19520/32000 (61%)] Loss: 1.55748 (QuantReg: 15.46483) QuantErr: 15.46483 batch_time=0.39054 
Train Epoch: 22 [313/500 20032/32000 (63%)] Loss: 1.51899 (QuantReg: 15.49750) QuantErr: 15.49750 batch_time=0.38899 
Train Epoch: 22 [321/500 20544/32000 (64%)] Loss: 1.37824 (QuantReg: 15.78898) QuantErr: 15.78898 batch_time=0.85110 
Train Epoch: 22 [329/500 21056/32000 (66%)] Loss: 1.65704 (QuantReg: 15.74628) QuantErr: 15.74628 batch_time=0.39226 
Train Epoch: 22 [337/500 21568/32000 (67%)] Loss: 1.08518 (QuantReg: 15.72775) QuantErr: 15.72775 batch_time=0.39197 
Train Epoch: 22 [345/500 22080/32000 (69%)] Loss: 1.16916 (QuantReg: 15.61181) QuantErr: 15.61181 batch_time=0.63400 
Train Epoch: 22 [353/500 22592/32000 (71%)] Loss: 1.61377 (QuantReg: 15.46455) QuantErr: 15.46455 batch_time=0.39528 
Train Epoch: 22 [361/500 23104/32000 (72%)] Loss: 1.52018 (QuantReg: 15.93884) QuantErr: 15.93884 batch_time=0.38637 
Train Epoch: 22 [369/500 23616/32000 (74%)] Loss: 1.76652 (QuantReg: 15.34777) QuantErr: 15.34777 batch_time=0.39714 
Train Epoch: 22 [377/500 24128/32000 (75%)] Loss: 1.60008 (QuantReg: 15.64327) QuantErr: 15.64327 batch_time=0.40609 
Train Epoch: 22 [385/500 24640/32000 (77%)] Loss: 1.38230 (QuantReg: 15.53810) QuantErr: 15.53810 batch_time=0.89651 
Train Epoch: 22 [393/500 25152/32000 (79%)] Loss: 1.60199 (QuantReg: 15.64140) QuantErr: 15.64140 batch_time=0.38703 
Train Epoch: 22 [401/500 25664/32000 (80%)] Loss: 1.32155 (QuantReg: 15.43936) QuantErr: 15.43936 batch_time=0.37980 
Train Epoch: 22 [409/500 26176/32000 (82%)] Loss: 1.82830 (QuantReg: 15.74210) QuantErr: 15.74210 batch_time=0.61586 
Train Epoch: 22 [417/500 26688/32000 (83%)] Loss: 1.24654 (QuantReg: 15.58516) QuantErr: 15.58516 batch_time=0.38451 
Train Epoch: 22 [425/500 27200/32000 (85%)] Loss: 1.28437 (QuantReg: 15.67409) QuantErr: 15.67409 batch_time=0.40016 
Train Epoch: 22 [433/500 27712/32000 (87%)] Loss: 1.79651 (QuantReg: 15.55002) QuantErr: 15.55002 batch_time=0.38556 
Train Epoch: 22 [441/500 28224/32000 (88%)] Loss: 1.54519 (QuantReg: 15.61558) QuantErr: 15.61558 batch_time=0.38454 
Train Epoch: 22 [449/500 28736/32000 (90%)] Loss: 1.32905 (QuantReg: 15.78541) QuantErr: 15.78541 batch_time=0.85518 
Train Epoch: 22 [457/500 29248/32000 (91%)] Loss: 1.77091 (QuantReg: 15.58261) QuantErr: 15.58261 batch_time=0.37319 
Train Epoch: 22 [465/500 29760/32000 (93%)] Loss: 1.29655 (QuantReg: 15.82459) QuantErr: 15.82459 batch_time=0.36978 
Train Epoch: 22 [473/500 30272/32000 (95%)] Loss: 1.78340 (QuantReg: 15.47205) QuantErr: 15.47205 batch_time=0.65149 
Train Epoch: 22 [481/500 30784/32000 (96%)] Loss: 1.46203 (QuantReg: 15.71130) QuantErr: 15.71130 batch_time=0.39235 
Train Epoch: 22 [489/500 31296/32000 (98%)] Loss: 1.73402 (QuantReg: 15.62694) QuantErr: 15.62694 batch_time=0.38423 
Train Epoch: 22 [497/500 31808/32000 (99%)] Loss: 1.55902 (QuantReg: 15.49251) QuantErr: 15.49251 batch_time=0.39059 
Train Epoch: 22 codebook_update_time=1.97756
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch22.pth ...
Done in 3.987s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch22.pth ...
Done in 7.703s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 1.4740448358058929
 quant_reg      : 15.57042123413086
 quant_err      : 15.57042123413086
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 11000
 LSMDC_full_test/t2v_metrics/R1: 13.4
 LSMDC_full_test/t2v_metrics/R5: 31.1
 LSMDC_full_test/t2v_metrics/R10: 40.8
 LSMDC_full_test/t2v_metrics/R50: 67.8
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.371
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.71432430329307
 LSMDC_full_test/v2t_metrics/R1: 12.4
 LSMDC_full_test/v2t_metrics/R5: 30.1
 LSMDC_full_test/v2t_metrics/R10: 40.5
 LSMDC_full_test/v2t_metrics/R50: 69.0
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.122
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.72565098445736
 mnt_best       : 25.71432430329307
 not_improved_count: 0
Train Epoch: 23 [1/500 64/32000 (0%)] Loss: 1.64700 (QuantReg: 15.61697) QuantErr: 15.61697 batch_time=15.78981 
Train Epoch: 23 [9/500 576/32000 (2%)] Loss: 1.11849 (QuantReg: 15.82913) QuantErr: 15.82913 batch_time=0.38132 
Train Epoch: 23 [17/500 1088/32000 (3%)] Loss: 1.48623 (QuantReg: 15.58570) QuantErr: 15.58570 batch_time=0.37530 
Train Epoch: 23 [25/500 1600/32000 (5%)] Loss: 1.59996 (QuantReg: 15.71906) QuantErr: 15.71906 batch_time=0.39098 
Train Epoch: 23 [33/500 2112/32000 (7%)] Loss: 1.35464 (QuantReg: 15.70458) QuantErr: 15.70458 batch_time=0.39213 
Train Epoch: 23 [41/500 2624/32000 (8%)] Loss: 1.29438 (QuantReg: 15.57672) QuantErr: 15.57672 batch_time=0.38927 
Train Epoch: 23 [49/500 3136/32000 (10%)] Loss: 1.83590 (QuantReg: 15.71581) QuantErr: 15.71581 batch_time=0.38541 
Train Epoch: 23 [57/500 3648/32000 (11%)] Loss: 1.25820 (QuantReg: 15.61962) QuantErr: 15.61962 batch_time=0.44172 
Train Epoch: 23 [65/500 4160/32000 (13%)] Loss: 1.83054 (QuantReg: 15.38908) QuantErr: 15.38908 batch_time=0.69361 
Train Epoch: 23 [73/500 4672/32000 (15%)] Loss: 1.81125 (QuantReg: 15.72819) QuantErr: 15.72819 batch_time=0.37323 
Train Epoch: 23 [81/500 5184/32000 (16%)] Loss: 1.67321 (QuantReg: 15.45992) QuantErr: 15.45992 batch_time=0.37238 
Train Epoch: 23 [89/500 5696/32000 (18%)] Loss: 1.21892 (QuantReg: 15.56471) QuantErr: 15.56471 batch_time=0.40047 
Train Epoch: 23 [97/500 6208/32000 (19%)] Loss: 1.27341 (QuantReg: 15.66574) QuantErr: 15.66574 batch_time=0.38147 
Train Epoch: 23 [105/500 6720/32000 (21%)] Loss: 1.26671 (QuantReg: 15.72291) QuantErr: 15.72291 batch_time=0.38722 
Train Epoch: 23 [113/500 7232/32000 (23%)] Loss: 1.41714 (QuantReg: 15.41722) QuantErr: 15.41722 batch_time=0.39228 
Train Epoch: 23 [121/500 7744/32000 (24%)] Loss: 1.63543 (QuantReg: 15.54429) QuantErr: 15.54429 batch_time=0.44846 
Train Epoch: 23 [129/500 8256/32000 (26%)] Loss: 1.23842 (QuantReg: 15.65186) QuantErr: 15.65186 batch_time=0.66681 
Train Epoch: 23 [137/500 8768/32000 (27%)] Loss: 1.54641 (QuantReg: 15.56336) QuantErr: 15.56336 batch_time=0.39686 
Train Epoch: 23 [145/500 9280/32000 (29%)] Loss: 1.38570 (QuantReg: 15.69005) QuantErr: 15.69005 batch_time=0.39188 
Train Epoch: 23 [153/500 9792/32000 (31%)] Loss: 0.93235 (QuantReg: 15.85696) QuantErr: 15.85696 batch_time=0.42934 
Train Epoch: 23 [161/500 10304/32000 (32%)] Loss: 1.52084 (QuantReg: 15.48782) QuantErr: 15.48782 batch_time=0.42540 
Train Epoch: 23 [169/500 10816/32000 (34%)] Loss: 1.33154 (QuantReg: 15.69743) QuantErr: 15.69743 batch_time=0.38680 
Train Epoch: 23 [177/500 11328/32000 (35%)] Loss: 1.10009 (QuantReg: 15.62478) QuantErr: 15.62478 batch_time=0.38767 
Train Epoch: 23 [185/500 11840/32000 (37%)] Loss: 1.12622 (QuantReg: 15.57592) QuantErr: 15.57592 batch_time=0.44514 
Train Epoch: 23 [193/500 12352/32000 (39%)] Loss: 1.41099 (QuantReg: 15.59450) QuantErr: 15.59450 batch_time=0.65724 
Train Epoch: 23 [201/500 12864/32000 (40%)] Loss: 1.46923 (QuantReg: 15.67519) QuantErr: 15.67519 batch_time=0.38281 
Train Epoch: 23 [209/500 13376/32000 (42%)] Loss: 1.09756 (QuantReg: 15.57309) QuantErr: 15.57309 batch_time=0.39128 
Train Epoch: 23 [217/500 13888/32000 (43%)] Loss: 1.47131 (QuantReg: 15.70235) QuantErr: 15.70235 batch_time=0.39104 
Train Epoch: 23 [225/500 14400/32000 (45%)] Loss: 1.92566 (QuantReg: 15.51501) QuantErr: 15.51501 batch_time=0.43232 
Train Epoch: 23 [233/500 14912/32000 (47%)] Loss: 1.43197 (QuantReg: 15.81285) QuantErr: 15.81285 batch_time=0.39326 
Train Epoch: 23 [241/500 15424/32000 (48%)] Loss: 1.34578 (QuantReg: 15.62974) QuantErr: 15.62974 batch_time=0.38630 
Train Epoch: 23 [249/500 15936/32000 (50%)] Loss: 1.72242 (QuantReg: 15.94192) QuantErr: 15.94192 batch_time=0.44520 
Train Epoch: 23 [257/500 16448/32000 (51%)] Loss: 1.13327 (QuantReg: 15.50100) QuantErr: 15.50100 batch_time=0.64986 
Train Epoch: 23 [265/500 16960/32000 (53%)] Loss: 1.28580 (QuantReg: 15.46312) QuantErr: 15.46312 batch_time=0.41157 
Train Epoch: 23 [273/500 17472/32000 (55%)] Loss: 1.56377 (QuantReg: 15.33016) QuantErr: 15.33016 batch_time=0.40787 
Train Epoch: 23 [281/500 17984/32000 (56%)] Loss: 1.49567 (QuantReg: 15.81072) QuantErr: 15.81072 batch_time=0.38939 
Train Epoch: 23 [289/500 18496/32000 (58%)] Loss: 1.47082 (QuantReg: 15.59158) QuantErr: 15.59158 batch_time=0.38780 
Train Epoch: 23 [297/500 19008/32000 (59%)] Loss: 1.57418 (QuantReg: 15.55074) QuantErr: 15.55074 batch_time=0.38725 
Train Epoch: 23 [305/500 19520/32000 (61%)] Loss: 1.55471 (QuantReg: 15.72514) QuantErr: 15.72514 batch_time=0.39529 
Train Epoch: 23 [313/500 20032/32000 (63%)] Loss: 1.19295 (QuantReg: 15.84276) QuantErr: 15.84276 batch_time=0.47326 
Train Epoch: 23 [321/500 20544/32000 (64%)] Loss: 1.82274 (QuantReg: 15.76637) QuantErr: 15.76637 batch_time=0.66789 
Train Epoch: 23 [329/500 21056/32000 (66%)] Loss: 1.32149 (QuantReg: 15.53345) QuantErr: 15.53345 batch_time=0.42086 
Train Epoch: 23 [337/500 21568/32000 (67%)] Loss: 1.22597 (QuantReg: 15.88303) QuantErr: 15.88303 batch_time=0.38759 
Train Epoch: 23 [345/500 22080/32000 (69%)] Loss: 1.24840 (QuantReg: 15.64476) QuantErr: 15.64476 batch_time=0.38947 
Train Epoch: 23 [353/500 22592/32000 (71%)] Loss: 1.26363 (QuantReg: 15.56333) QuantErr: 15.56333 batch_time=0.39387 
Train Epoch: 23 [361/500 23104/32000 (72%)] Loss: 1.56415 (QuantReg: 15.60922) QuantErr: 15.60922 batch_time=0.38473 
Train Epoch: 23 [369/500 23616/32000 (74%)] Loss: 1.60362 (QuantReg: 15.70070) QuantErr: 15.70070 batch_time=0.39139 
Train Epoch: 23 [377/500 24128/32000 (75%)] Loss: 1.60949 (QuantReg: 15.61495) QuantErr: 15.61495 batch_time=0.43885 
Train Epoch: 23 [385/500 24640/32000 (77%)] Loss: 1.27422 (QuantReg: 15.55872) QuantErr: 15.55872 batch_time=0.64790 
Train Epoch: 23 [393/500 25152/32000 (79%)] Loss: 1.17267 (QuantReg: 15.66600) QuantErr: 15.66600 batch_time=0.38614 
Train Epoch: 23 [401/500 25664/32000 (80%)] Loss: 1.63303 (QuantReg: 15.73382) QuantErr: 15.73382 batch_time=0.38381 
Train Epoch: 23 [409/500 26176/32000 (82%)] Loss: 1.33183 (QuantReg: 15.57265) QuantErr: 15.57265 batch_time=0.40814 
Train Epoch: 23 [417/500 26688/32000 (83%)] Loss: 0.99827 (QuantReg: 15.61176) QuantErr: 15.61176 batch_time=0.38967 
Train Epoch: 23 [425/500 27200/32000 (85%)] Loss: 1.13056 (QuantReg: 15.74521) QuantErr: 15.74521 batch_time=0.37388 
Train Epoch: 23 [433/500 27712/32000 (87%)] Loss: 1.39507 (QuantReg: 15.68249) QuantErr: 15.68249 batch_time=0.39214 
Train Epoch: 23 [441/500 28224/32000 (88%)] Loss: 1.31949 (QuantReg: 15.46313) QuantErr: 15.46313 batch_time=0.44514 
Train Epoch: 23 [449/500 28736/32000 (90%)] Loss: 1.36236 (QuantReg: 15.69124) QuantErr: 15.69124 batch_time=0.63945 
Train Epoch: 23 [457/500 29248/32000 (91%)] Loss: 1.19245 (QuantReg: 15.76893) QuantErr: 15.76893 batch_time=0.41061 
Train Epoch: 23 [465/500 29760/32000 (93%)] Loss: 1.41479 (QuantReg: 15.66072) QuantErr: 15.66072 batch_time=0.42061 
Train Epoch: 23 [473/500 30272/32000 (95%)] Loss: 1.69419 (QuantReg: 15.84274) QuantErr: 15.84274 batch_time=0.38555 
Train Epoch: 23 [481/500 30784/32000 (96%)] Loss: 1.11798 (QuantReg: 15.63879) QuantErr: 15.63879 batch_time=0.43618 
Train Epoch: 23 [489/500 31296/32000 (98%)] Loss: 1.32054 (QuantReg: 15.72995) QuantErr: 15.72995 batch_time=0.37712 
Train Epoch: 23 [497/500 31808/32000 (99%)] Loss: 1.71999 (QuantReg: 15.42591) QuantErr: 15.42591 batch_time=0.39899 
Train Epoch: 23 codebook_update_time=1.92510
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch23.pth ...
Done in 3.941s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 1.4115770852565765
 quant_reg      : 15.618226951599121
 quant_err      : 15.618226951599121
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 11500
 LSMDC_full_test/t2v_metrics/R1: 12.2
 LSMDC_full_test/t2v_metrics/R5: 30.7
 LSMDC_full_test/t2v_metrics/R10: 41.9
 LSMDC_full_test/t2v_metrics/R50: 68.3
 LSMDC_full_test/t2v_metrics/MedR: 17.5
 LSMDC_full_test/t2v_metrics/MeanR: 72.175
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.036334366968074
 LSMDC_full_test/v2t_metrics/R1: 12.6
 LSMDC_full_test/v2t_metrics/R5: 30.0
 LSMDC_full_test/v2t_metrics/R10: 39.9
 LSMDC_full_test/v2t_metrics/R50: 67.7
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.194
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.70708817644036
 mnt_best       : 25.71432430329307
 not_improved_count: 1
Train Epoch: 24 [1/500 64/32000 (0%)] Loss: 1.66722 (QuantReg: 15.74909) QuantErr: 15.74909 batch_time=15.83206 
Train Epoch: 24 [9/500 576/32000 (2%)] Loss: 1.33676 (QuantReg: 15.31305) QuantErr: 15.31305 batch_time=0.39378 
Train Epoch: 24 [17/500 1088/32000 (3%)] Loss: 1.89828 (QuantReg: 15.44606) QuantErr: 15.44606 batch_time=0.44538 
Train Epoch: 24 [25/500 1600/32000 (5%)] Loss: 1.22647 (QuantReg: 15.47079) QuantErr: 15.47079 batch_time=0.43896 
Train Epoch: 24 [33/500 2112/32000 (7%)] Loss: 1.97681 (QuantReg: 15.56702) QuantErr: 15.56702 batch_time=0.40223 
Train Epoch: 24 [41/500 2624/32000 (8%)] Loss: 1.24647 (QuantReg: 15.26656) QuantErr: 15.26656 batch_time=0.38927 
Train Epoch: 24 [49/500 3136/32000 (10%)] Loss: 1.14301 (QuantReg: 15.68958) QuantErr: 15.68958 batch_time=0.38364 
Train Epoch: 24 [57/500 3648/32000 (11%)] Loss: 1.61671 (QuantReg: 15.33594) QuantErr: 15.33594 batch_time=0.37619 
Train Epoch: 24 [65/500 4160/32000 (13%)] Loss: 1.41707 (QuantReg: 15.60165) QuantErr: 15.60165 batch_time=0.67001 
Train Epoch: 24 [73/500 4672/32000 (15%)] Loss: 1.30117 (QuantReg: 15.51639) QuantErr: 15.51639 batch_time=0.39501 
Train Epoch: 24 [81/500 5184/32000 (16%)] Loss: 1.24028 (QuantReg: 15.64683) QuantErr: 15.64683 batch_time=0.45099 
Train Epoch: 24 [89/500 5696/32000 (18%)] Loss: 1.52956 (QuantReg: 15.64045) QuantErr: 15.64045 batch_time=0.43082 
Train Epoch: 24 [97/500 6208/32000 (19%)] Loss: 1.39228 (QuantReg: 15.46991) QuantErr: 15.46991 batch_time=0.37855 
Train Epoch: 24 [105/500 6720/32000 (21%)] Loss: 1.23954 (QuantReg: 15.54886) QuantErr: 15.54886 batch_time=0.38287 
Train Epoch: 24 [113/500 7232/32000 (23%)] Loss: 1.99745 (QuantReg: 15.73419) QuantErr: 15.73419 batch_time=0.38005 
Train Epoch: 24 [121/500 7744/32000 (24%)] Loss: 1.59432 (QuantReg: 15.73456) QuantErr: 15.73456 batch_time=0.41604 
Train Epoch: 24 [129/500 8256/32000 (26%)] Loss: 1.76616 (QuantReg: 15.52738) QuantErr: 15.52738 batch_time=0.71679 
Train Epoch: 24 [137/500 8768/32000 (27%)] Loss: 1.36421 (QuantReg: 15.43484) QuantErr: 15.43484 batch_time=0.37539 
Train Epoch: 24 [145/500 9280/32000 (29%)] Loss: 1.09357 (QuantReg: 15.55513) QuantErr: 15.55513 batch_time=0.43251 
Train Epoch: 24 [153/500 9792/32000 (31%)] Loss: 1.44111 (QuantReg: 15.74856) QuantErr: 15.74856 batch_time=0.45024 
Train Epoch: 24 [161/500 10304/32000 (32%)] Loss: 1.64580 (QuantReg: 15.32600) QuantErr: 15.32600 batch_time=0.38032 
Train Epoch: 24 [169/500 10816/32000 (34%)] Loss: 1.68240 (QuantReg: 15.12247) QuantErr: 15.12247 batch_time=0.38603 
Train Epoch: 24 [177/500 11328/32000 (35%)] Loss: 1.25325 (QuantReg: 15.55753) QuantErr: 15.55753 batch_time=0.40500 
Train Epoch: 24 [185/500 11840/32000 (37%)] Loss: 0.95261 (QuantReg: 15.48552) QuantErr: 15.48552 batch_time=0.37475 
Train Epoch: 24 [193/500 12352/32000 (39%)] Loss: 1.43337 (QuantReg: 15.65838) QuantErr: 15.65838 batch_time=0.70107 
Train Epoch: 24 [201/500 12864/32000 (40%)] Loss: 1.48292 (QuantReg: 15.62231) QuantErr: 15.62231 batch_time=0.37838 
Train Epoch: 24 [209/500 13376/32000 (42%)] Loss: 1.26085 (QuantReg: 15.44412) QuantErr: 15.44412 batch_time=0.45460 
Train Epoch: 24 [217/500 13888/32000 (43%)] Loss: 1.47533 (QuantReg: 15.54015) QuantErr: 15.54015 batch_time=0.42987 
Train Epoch: 24 [225/500 14400/32000 (45%)] Loss: 1.22107 (QuantReg: 15.59769) QuantErr: 15.59769 batch_time=0.38318 
Train Epoch: 24 [233/500 14912/32000 (47%)] Loss: 1.45955 (QuantReg: 15.74176) QuantErr: 15.74176 batch_time=0.38144 
Train Epoch: 24 [241/500 15424/32000 (48%)] Loss: 1.69706 (QuantReg: 15.54028) QuantErr: 15.54028 batch_time=0.39754 
Train Epoch: 24 [249/500 15936/32000 (50%)] Loss: 1.34861 (QuantReg: 15.60254) QuantErr: 15.60254 batch_time=0.37371 
Train Epoch: 24 [257/500 16448/32000 (51%)] Loss: 1.44805 (QuantReg: 15.58415) QuantErr: 15.58415 batch_time=0.72794 
Train Epoch: 24 [265/500 16960/32000 (53%)] Loss: 1.36974 (QuantReg: 15.69520) QuantErr: 15.69520 batch_time=0.37865 
Train Epoch: 24 [273/500 17472/32000 (55%)] Loss: 1.58915 (QuantReg: 15.71776) QuantErr: 15.71776 batch_time=0.39528 
Train Epoch: 24 [281/500 17984/32000 (56%)] Loss: 1.21416 (QuantReg: 15.62337) QuantErr: 15.62337 batch_time=0.38407 
Train Epoch: 24 [289/500 18496/32000 (58%)] Loss: 1.47031 (QuantReg: 15.51260) QuantErr: 15.51260 batch_time=0.42295 
Train Epoch: 24 [297/500 19008/32000 (59%)] Loss: 1.55721 (QuantReg: 15.91415) QuantErr: 15.91415 batch_time=0.38915 
Train Epoch: 24 [305/500 19520/32000 (61%)] Loss: 1.11391 (QuantReg: 15.70711) QuantErr: 15.70711 batch_time=0.38404 
Train Epoch: 24 [313/500 20032/32000 (63%)] Loss: 1.64547 (QuantReg: 15.64494) QuantErr: 15.64494 batch_time=0.38982 
Train Epoch: 24 [321/500 20544/32000 (64%)] Loss: 1.31178 (QuantReg: 15.65993) QuantErr: 15.65993 batch_time=0.38156 
Train Epoch: 24 [329/500 21056/32000 (66%)] Loss: 1.50232 (QuantReg: 15.37647) QuantErr: 15.37647 batch_time=0.37517 
Train Epoch: 24 [337/500 21568/32000 (67%)] Loss: 1.64368 (QuantReg: 15.74228) QuantErr: 15.74228 batch_time=0.41078 
Train Epoch: 24 [345/500 22080/32000 (69%)] Loss: 1.79568 (QuantReg: 15.60564) QuantErr: 15.60564 batch_time=0.42636 
Train Epoch: 24 [353/500 22592/32000 (71%)] Loss: 1.63204 (QuantReg: 15.40424) QuantErr: 15.40424 batch_time=0.38849 
Train Epoch: 24 [361/500 23104/32000 (72%)] Loss: 1.11099 (QuantReg: 15.62510) QuantErr: 15.62510 batch_time=0.38437 
Train Epoch: 24 [369/500 23616/32000 (74%)] Loss: 1.54830 (QuantReg: 15.67714) QuantErr: 15.67714 batch_time=0.38339 
Train Epoch: 24 [377/500 24128/32000 (75%)] Loss: 1.19367 (QuantReg: 15.43246) QuantErr: 15.43246 batch_time=0.39386 
Train Epoch: 24 [385/500 24640/32000 (77%)] Loss: 1.13756 (QuantReg: 15.46163) QuantErr: 15.46163 batch_time=0.38456 
Train Epoch: 24 [393/500 25152/32000 (79%)] Loss: 1.08041 (QuantReg: 15.63218) QuantErr: 15.63218 batch_time=0.38900 
Train Epoch: 24 [401/500 25664/32000 (80%)] Loss: 1.25663 (QuantReg: 15.85956) QuantErr: 15.85956 batch_time=0.38630 
Train Epoch: 24 [409/500 26176/32000 (82%)] Loss: 1.31734 (QuantReg: 15.70299) QuantErr: 15.70299 batch_time=0.40649 
Train Epoch: 24 [417/500 26688/32000 (83%)] Loss: 1.23052 (QuantReg: 15.89270) QuantErr: 15.89270 batch_time=0.39088 
Train Epoch: 24 [425/500 27200/32000 (85%)] Loss: 1.19914 (QuantReg: 15.71052) QuantErr: 15.71052 batch_time=0.39215 
Train Epoch: 24 [433/500 27712/32000 (87%)] Loss: 1.42772 (QuantReg: 15.45317) QuantErr: 15.45317 batch_time=0.37738 
Train Epoch: 24 [441/500 28224/32000 (88%)] Loss: 1.60302 (QuantReg: 15.64126) QuantErr: 15.64126 batch_time=0.38030 
Train Epoch: 24 [449/500 28736/32000 (90%)] Loss: 1.46760 (QuantReg: 15.85462) QuantErr: 15.85462 batch_time=0.37875 
Train Epoch: 24 [457/500 29248/32000 (91%)] Loss: 1.35711 (QuantReg: 15.69085) QuantErr: 15.69085 batch_time=0.38148 
Train Epoch: 24 [465/500 29760/32000 (93%)] Loss: 1.18881 (QuantReg: 15.65681) QuantErr: 15.65681 batch_time=0.37957 
Train Epoch: 24 [473/500 30272/32000 (95%)] Loss: 1.26943 (QuantReg: 15.55549) QuantErr: 15.55549 batch_time=0.41033 
Train Epoch: 24 [481/500 30784/32000 (96%)] Loss: 1.44941 (QuantReg: 15.75843) QuantErr: 15.75843 batch_time=0.40771 
Train Epoch: 24 [489/500 31296/32000 (98%)] Loss: 1.51058 (QuantReg: 16.00331) QuantErr: 16.00331 batch_time=0.38383 
Train Epoch: 24 [497/500 31808/32000 (99%)] Loss: 1.48875 (QuantReg: 15.47717) QuantErr: 15.47717 batch_time=0.37277 
Train Epoch: 24 codebook_update_time=2.10571
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch24.pth ...
Done in 4.325s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 1.3879967175722123
 quant_reg      : 15.603504705429078
 quant_err      : 15.603504705429078
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 12000
 LSMDC_full_test/t2v_metrics/R1: 11.7
 LSMDC_full_test/t2v_metrics/R5: 31.4
 LSMDC_full_test/t2v_metrics/R10: 41.6
 LSMDC_full_test/t2v_metrics/R50: 66.7
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.83
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.816257117282333
 LSMDC_full_test/v2t_metrics/R1: 12.4
 LSMDC_full_test/v2t_metrics/R5: 30.9
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 67.2
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.2825
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.860403833922256
 mnt_best       : 25.71432430329307
 not_improved_count: 2
Train Epoch: 25 [1/500 64/32000 (0%)] Loss: 1.38340 (QuantReg: 15.42245) QuantErr: 15.42245 batch_time=17.82678 
Train Epoch: 25 [9/500 576/32000 (2%)] Loss: 1.48909 (QuantReg: 15.45494) QuantErr: 15.45494 batch_time=0.37429 
Train Epoch: 25 [17/500 1088/32000 (3%)] Loss: 1.28074 (QuantReg: 15.63942) QuantErr: 15.63942 batch_time=0.38516 
Train Epoch: 25 [25/500 1600/32000 (5%)] Loss: 1.53854 (QuantReg: 15.45297) QuantErr: 15.45297 batch_time=0.38164 
Train Epoch: 25 [33/500 2112/32000 (7%)] Loss: 1.32928 (QuantReg: 15.62507) QuantErr: 15.62507 batch_time=0.38452 
Train Epoch: 25 [41/500 2624/32000 (8%)] Loss: 1.73123 (QuantReg: 15.62811) QuantErr: 15.62811 batch_time=0.38062 
Train Epoch: 25 [49/500 3136/32000 (10%)] Loss: 1.49765 (QuantReg: 15.65844) QuantErr: 15.65844 batch_time=0.39101 
Train Epoch: 25 [57/500 3648/32000 (11%)] Loss: 1.31152 (QuantReg: 15.64780) QuantErr: 15.64780 batch_time=0.38483 
Train Epoch: 25 [65/500 4160/32000 (13%)] Loss: 1.48195 (QuantReg: 15.36257) QuantErr: 15.36257 batch_time=0.38237 
Train Epoch: 25 [73/500 4672/32000 (15%)] Loss: 1.33409 (QuantReg: 15.62900) QuantErr: 15.62900 batch_time=0.40749 
Train Epoch: 25 [81/500 5184/32000 (16%)] Loss: 1.32583 (QuantReg: 15.69283) QuantErr: 15.69283 batch_time=0.38164 
Train Epoch: 25 [89/500 5696/32000 (18%)] Loss: 1.33635 (QuantReg: 15.33658) QuantErr: 15.33658 batch_time=0.38225 
Train Epoch: 25 [97/500 6208/32000 (19%)] Loss: 1.73076 (QuantReg: 15.55974) QuantErr: 15.55974 batch_time=0.40031 
Train Epoch: 25 [105/500 6720/32000 (21%)] Loss: 1.39464 (QuantReg: 15.81553) QuantErr: 15.81553 batch_time=0.37645 
Train Epoch: 25 [113/500 7232/32000 (23%)] Loss: 1.52718 (QuantReg: 15.70366) QuantErr: 15.70366 batch_time=0.39008 
Train Epoch: 25 [121/500 7744/32000 (24%)] Loss: 1.13791 (QuantReg: 15.71224) QuantErr: 15.71224 batch_time=0.37753 
Train Epoch: 25 [129/500 8256/32000 (26%)] Loss: 1.45983 (QuantReg: 15.51094) QuantErr: 15.51094 batch_time=0.38197 
Train Epoch: 25 [137/500 8768/32000 (27%)] Loss: 1.33191 (QuantReg: 15.74194) QuantErr: 15.74194 batch_time=0.39731 
Train Epoch: 25 [145/500 9280/32000 (29%)] Loss: 1.16447 (QuantReg: 15.73862) QuantErr: 15.73862 batch_time=0.37949 
Train Epoch: 25 [153/500 9792/32000 (31%)] Loss: 1.45845 (QuantReg: 15.63321) QuantErr: 15.63321 batch_time=0.38058 
Train Epoch: 25 [161/500 10304/32000 (32%)] Loss: 1.47956 (QuantReg: 15.48326) QuantErr: 15.48326 batch_time=0.38706 
Train Epoch: 25 [169/500 10816/32000 (34%)] Loss: 1.43410 (QuantReg: 15.50806) QuantErr: 15.50806 batch_time=0.37746 
Train Epoch: 25 [177/500 11328/32000 (35%)] Loss: 1.08818 (QuantReg: 15.56827) QuantErr: 15.56827 batch_time=0.38898 
Train Epoch: 25 [185/500 11840/32000 (37%)] Loss: 1.67839 (QuantReg: 15.77271) QuantErr: 15.77271 batch_time=0.38353 
Train Epoch: 25 [193/500 12352/32000 (39%)] Loss: 1.34060 (QuantReg: 15.58791) QuantErr: 15.58791 batch_time=0.44182 
Train Epoch: 25 [201/500 12864/32000 (40%)] Loss: 1.42215 (QuantReg: 15.54880) QuantErr: 15.54880 batch_time=0.40438 
Train Epoch: 25 [209/500 13376/32000 (42%)] Loss: 1.61935 (QuantReg: 15.88671) QuantErr: 15.88671 batch_time=0.38569 
Train Epoch: 25 [217/500 13888/32000 (43%)] Loss: 1.05768 (QuantReg: 15.52176) QuantErr: 15.52176 batch_time=0.43906 
Train Epoch: 25 [225/500 14400/32000 (45%)] Loss: 1.07492 (QuantReg: 15.75418) QuantErr: 15.75418 batch_time=0.39052 
Train Epoch: 25 [233/500 14912/32000 (47%)] Loss: 1.63331 (QuantReg: 15.61844) QuantErr: 15.61844 batch_time=0.37538 
Train Epoch: 25 [241/500 15424/32000 (48%)] Loss: 1.15891 (QuantReg: 15.40384) QuantErr: 15.40384 batch_time=0.39660 
Train Epoch: 25 [249/500 15936/32000 (50%)] Loss: 1.15421 (QuantReg: 15.77314) QuantErr: 15.77314 batch_time=0.41963 
Train Epoch: 25 [257/500 16448/32000 (51%)] Loss: 1.29293 (QuantReg: 15.74003) QuantErr: 15.74003 batch_time=0.38955 
Train Epoch: 25 [265/500 16960/32000 (53%)] Loss: 1.54878 (QuantReg: 15.77936) QuantErr: 15.77936 batch_time=0.37564 
Train Epoch: 25 [273/500 17472/32000 (55%)] Loss: 1.49979 (QuantReg: 15.59566) QuantErr: 15.59566 batch_time=0.40479 
Train Epoch: 25 [281/500 17984/32000 (56%)] Loss: 1.14850 (QuantReg: 15.78367) QuantErr: 15.78367 batch_time=0.38044 
Train Epoch: 25 [289/500 18496/32000 (58%)] Loss: 1.19519 (QuantReg: 15.69982) QuantErr: 15.69982 batch_time=0.41440 
Train Epoch: 25 [297/500 19008/32000 (59%)] Loss: 1.70465 (QuantReg: 15.56500) QuantErr: 15.56500 batch_time=0.38014 
Train Epoch: 25 [305/500 19520/32000 (61%)] Loss: 1.57514 (QuantReg: 15.87254) QuantErr: 15.87254 batch_time=0.38646 
Train Epoch: 25 [313/500 20032/32000 (63%)] Loss: 1.40051 (QuantReg: 15.54878) QuantErr: 15.54878 batch_time=0.42580 
Train Epoch: 25 [321/500 20544/32000 (64%)] Loss: 1.23963 (QuantReg: 15.74477) QuantErr: 15.74477 batch_time=0.39090 
Train Epoch: 25 [329/500 21056/32000 (66%)] Loss: 1.43500 (QuantReg: 15.68991) QuantErr: 15.68991 batch_time=0.39986 
Train Epoch: 25 [337/500 21568/32000 (67%)] Loss: 1.43924 (QuantReg: 15.64624) QuantErr: 15.64624 batch_time=0.39675 
Train Epoch: 25 [345/500 22080/32000 (69%)] Loss: 1.15414 (QuantReg: 15.87357) QuantErr: 15.87357 batch_time=0.38938 
Train Epoch: 25 [353/500 22592/32000 (71%)] Loss: 1.17163 (QuantReg: 15.41173) QuantErr: 15.41173 batch_time=0.38907 
Train Epoch: 25 [361/500 23104/32000 (72%)] Loss: 1.15097 (QuantReg: 15.73796) QuantErr: 15.73796 batch_time=0.38467 
Train Epoch: 25 [369/500 23616/32000 (74%)] Loss: 1.37702 (QuantReg: 15.34379) QuantErr: 15.34379 batch_time=0.39154 
Train Epoch: 25 [377/500 24128/32000 (75%)] Loss: 1.33137 (QuantReg: 15.56084) QuantErr: 15.56084 batch_time=0.39647 
Train Epoch: 25 [385/500 24640/32000 (77%)] Loss: 1.23436 (QuantReg: 15.85966) QuantErr: 15.85966 batch_time=0.38068 
Train Epoch: 25 [393/500 25152/32000 (79%)] Loss: 1.15120 (QuantReg: 15.69594) QuantErr: 15.69594 batch_time=0.38499 
Train Epoch: 25 [401/500 25664/32000 (80%)] Loss: 0.92515 (QuantReg: 15.87288) QuantErr: 15.87288 batch_time=0.38685 
Train Epoch: 25 [409/500 26176/32000 (82%)] Loss: 1.37454 (QuantReg: 15.55536) QuantErr: 15.55536 batch_time=0.39659 
Train Epoch: 25 [417/500 26688/32000 (83%)] Loss: 1.24769 (QuantReg: 15.71443) QuantErr: 15.71443 batch_time=0.89332 
Train Epoch: 25 [425/500 27200/32000 (85%)] Loss: 0.90113 (QuantReg: 15.37323) QuantErr: 15.37323 batch_time=0.39011 
Train Epoch: 25 [433/500 27712/32000 (87%)] Loss: 1.66361 (QuantReg: 15.66083) QuantErr: 15.66083 batch_time=0.40229 
Train Epoch: 25 [441/500 28224/32000 (88%)] Loss: 1.21986 (QuantReg: 15.77603) QuantErr: 15.77603 batch_time=0.39028 
Train Epoch: 25 [449/500 28736/32000 (90%)] Loss: 1.43998 (QuantReg: 15.90714) QuantErr: 15.90714 batch_time=0.38807 
Train Epoch: 25 [457/500 29248/32000 (91%)] Loss: 1.13833 (QuantReg: 15.90445) QuantErr: 15.90445 batch_time=0.39011 
Train Epoch: 25 [465/500 29760/32000 (93%)] Loss: 1.55578 (QuantReg: 15.76158) QuantErr: 15.76158 batch_time=0.40361 
Train Epoch: 25 [473/500 30272/32000 (95%)] Loss: 1.49726 (QuantReg: 15.73388) QuantErr: 15.73388 batch_time=0.42411 
Train Epoch: 25 [481/500 30784/32000 (96%)] Loss: 1.27238 (QuantReg: 15.78602) QuantErr: 15.78602 batch_time=0.38750 
Train Epoch: 25 [489/500 31296/32000 (98%)] Loss: 1.62494 (QuantReg: 15.81776) QuantErr: 15.81776 batch_time=0.39250 
Train Epoch: 25 [497/500 31808/32000 (99%)] Loss: 1.34091 (QuantReg: 15.60930) QuantErr: 15.60930 batch_time=0.39284 
Train Epoch: 25 codebook_update_time=1.93688
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch25.pth ...
Done in 4.242s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.3326398301124573
 quant_reg      : 15.662975799560547
 quant_err      : 15.662975799560547
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 12500
 LSMDC_full_test/t2v_metrics/R1: 11.9
 LSMDC_full_test/t2v_metrics/R5: 31.0
 LSMDC_full_test/t2v_metrics/R10: 40.0
 LSMDC_full_test/t2v_metrics/R50: 68.1
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.931
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.52766554115562
 LSMDC_full_test/v2t_metrics/R1: 12.9
 LSMDC_full_test/v2t_metrics/R5: 30.7
 LSMDC_full_test/v2t_metrics/R10: 41.0
 LSMDC_full_test/v2t_metrics/R50: 66.8
 LSMDC_full_test/v2t_metrics/MedR: 19.5
 LSMDC_full_test/v2t_metrics/MeanR: 74.517
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.322348461570257
 mnt_best       : 25.71432430329307
 not_improved_count: 3
Train Epoch: 26 [1/500 64/32000 (0%)] Loss: 1.24663 (QuantReg: 15.64313) QuantErr: 15.64313 batch_time=20.08240 
Train Epoch: 26 [9/500 576/32000 (2%)] Loss: 1.50394 (QuantReg: 15.58698) QuantErr: 15.58698 batch_time=0.38140 
Train Epoch: 26 [17/500 1088/32000 (3%)] Loss: 1.31171 (QuantReg: 15.60679) QuantErr: 15.60679 batch_time=0.39395 
Train Epoch: 26 [25/500 1600/32000 (5%)] Loss: 1.25388 (QuantReg: 15.49541) QuantErr: 15.49541 batch_time=0.37783 
Train Epoch: 26 [33/500 2112/32000 (7%)] Loss: 1.46792 (QuantReg: 15.62620) QuantErr: 15.62620 batch_time=0.37586 
Train Epoch: 26 [41/500 2624/32000 (8%)] Loss: 1.12860 (QuantReg: 15.74551) QuantErr: 15.74551 batch_time=0.38291 
Train Epoch: 26 [49/500 3136/32000 (10%)] Loss: 1.19546 (QuantReg: 15.67442) QuantErr: 15.67442 batch_time=0.37405 
Train Epoch: 26 [57/500 3648/32000 (11%)] Loss: 1.29608 (QuantReg: 15.83750) QuantErr: 15.83750 batch_time=0.37321 
Train Epoch: 26 [65/500 4160/32000 (13%)] Loss: 1.22279 (QuantReg: 15.87489) QuantErr: 15.87489 batch_time=1.55551 
Train Epoch: 26 [73/500 4672/32000 (15%)] Loss: 1.29251 (QuantReg: 15.60627) QuantErr: 15.60627 batch_time=0.39433 
Train Epoch: 26 [81/500 5184/32000 (16%)] Loss: 1.21397 (QuantReg: 15.88077) QuantErr: 15.88077 batch_time=0.39866 
Train Epoch: 26 [89/500 5696/32000 (18%)] Loss: 1.19750 (QuantReg: 15.43958) QuantErr: 15.43958 batch_time=0.38618 
Train Epoch: 26 [97/500 6208/32000 (19%)] Loss: 1.61234 (QuantReg: 15.68661) QuantErr: 15.68661 batch_time=0.38087 
Train Epoch: 26 [105/500 6720/32000 (21%)] Loss: 1.05272 (QuantReg: 15.74872) QuantErr: 15.74872 batch_time=0.39020 
Train Epoch: 26 [113/500 7232/32000 (23%)] Loss: 1.18202 (QuantReg: 15.52569) QuantErr: 15.52569 batch_time=0.40055 
Train Epoch: 26 [121/500 7744/32000 (24%)] Loss: 1.22378 (QuantReg: 15.87540) QuantErr: 15.87540 batch_time=0.37833 
Train Epoch: 26 [129/500 8256/32000 (26%)] Loss: 1.02389 (QuantReg: 15.74935) QuantErr: 15.74935 batch_time=1.68391 
Train Epoch: 26 [137/500 8768/32000 (27%)] Loss: 1.32516 (QuantReg: 15.98368) QuantErr: 15.98368 batch_time=0.37972 
Train Epoch: 26 [145/500 9280/32000 (29%)] Loss: 1.20735 (QuantReg: 15.72714) QuantErr: 15.72714 batch_time=0.38038 
Train Epoch: 26 [153/500 9792/32000 (31%)] Loss: 1.18972 (QuantReg: 15.62909) QuantErr: 15.62909 batch_time=0.38989 
Train Epoch: 26 [161/500 10304/32000 (32%)] Loss: 1.29878 (QuantReg: 15.51012) QuantErr: 15.51012 batch_time=0.38419 
Train Epoch: 26 [169/500 10816/32000 (34%)] Loss: 1.08382 (QuantReg: 15.58502) QuantErr: 15.58502 batch_time=0.38266 
Train Epoch: 26 [177/500 11328/32000 (35%)] Loss: 1.38302 (QuantReg: 15.47234) QuantErr: 15.47234 batch_time=0.37716 
Train Epoch: 26 [185/500 11840/32000 (37%)] Loss: 1.52330 (QuantReg: 15.57425) QuantErr: 15.57425 batch_time=0.37804 
Train Epoch: 26 [193/500 12352/32000 (39%)] Loss: 1.06065 (QuantReg: 15.56353) QuantErr: 15.56353 batch_time=0.37789 
Train Epoch: 26 [201/500 12864/32000 (40%)] Loss: 1.42977 (QuantReg: 15.64103) QuantErr: 15.64103 batch_time=0.38342 
Train Epoch: 26 [209/500 13376/32000 (42%)] Loss: 1.20534 (QuantReg: 15.62374) QuantErr: 15.62374 batch_time=0.38256 
Train Epoch: 26 [217/500 13888/32000 (43%)] Loss: 0.85032 (QuantReg: 16.00180) QuantErr: 16.00180 batch_time=0.44240 
Train Epoch: 26 [225/500 14400/32000 (45%)] Loss: 1.55555 (QuantReg: 15.96021) QuantErr: 15.96021 batch_time=0.37737 
Train Epoch: 26 [233/500 14912/32000 (47%)] Loss: 1.34138 (QuantReg: 15.66565) QuantErr: 15.66565 batch_time=0.37943 
Train Epoch: 26 [241/500 15424/32000 (48%)] Loss: 1.66849 (QuantReg: 15.54130) QuantErr: 15.54130 batch_time=0.37468 
Train Epoch: 26 [249/500 15936/32000 (50%)] Loss: 1.13552 (QuantReg: 15.46237) QuantErr: 15.46237 batch_time=0.38289 
Train Epoch: 26 [257/500 16448/32000 (51%)] Loss: 0.96556 (QuantReg: 15.79704) QuantErr: 15.79704 batch_time=0.37613 
Train Epoch: 26 [265/500 16960/32000 (53%)] Loss: 1.39949 (QuantReg: 15.75406) QuantErr: 15.75406 batch_time=0.39764 
Train Epoch: 26 [273/500 17472/32000 (55%)] Loss: 1.29735 (QuantReg: 15.53307) QuantErr: 15.53307 batch_time=0.37942 
Train Epoch: 26 [281/500 17984/32000 (56%)] Loss: 1.16580 (QuantReg: 15.76558) QuantErr: 15.76558 batch_time=0.37821 
Train Epoch: 26 [289/500 18496/32000 (58%)] Loss: 1.34628 (QuantReg: 15.81001) QuantErr: 15.81001 batch_time=0.38190 
Train Epoch: 26 [297/500 19008/32000 (59%)] Loss: 1.13462 (QuantReg: 15.65170) QuantErr: 15.65170 batch_time=0.38591 
Train Epoch: 26 [305/500 19520/32000 (61%)] Loss: 1.47080 (QuantReg: 15.45889) QuantErr: 15.45889 batch_time=0.37534 
Train Epoch: 26 [313/500 20032/32000 (63%)] Loss: 1.28815 (QuantReg: 15.78937) QuantErr: 15.78937 batch_time=0.38490 
Train Epoch: 26 [321/500 20544/32000 (64%)] Loss: 1.14050 (QuantReg: 15.90249) QuantErr: 15.90249 batch_time=0.37417 
Train Epoch: 26 [329/500 21056/32000 (66%)] Loss: 1.14384 (QuantReg: 15.62575) QuantErr: 15.62575 batch_time=0.37679 
Train Epoch: 26 [337/500 21568/32000 (67%)] Loss: 0.98639 (QuantReg: 15.80075) QuantErr: 15.80075 batch_time=0.39373 
Train Epoch: 26 [345/500 22080/32000 (69%)] Loss: 1.12026 (QuantReg: 15.83202) QuantErr: 15.83202 batch_time=0.37593 
Train Epoch: 26 [353/500 22592/32000 (71%)] Loss: 1.00914 (QuantReg: 15.76328) QuantErr: 15.76328 batch_time=0.37879 
Train Epoch: 26 [361/500 23104/32000 (72%)] Loss: 1.59258 (QuantReg: 15.74384) QuantErr: 15.74384 batch_time=0.37591 
Train Epoch: 26 [369/500 23616/32000 (74%)] Loss: 1.21433 (QuantReg: 15.60649) QuantErr: 15.60649 batch_time=0.37562 
Train Epoch: 26 [377/500 24128/32000 (75%)] Loss: 1.44516 (QuantReg: 15.72643) QuantErr: 15.72643 batch_time=0.37626 
Train Epoch: 26 [385/500 24640/32000 (77%)] Loss: 1.26451 (QuantReg: 15.61325) QuantErr: 15.61325 batch_time=0.40454 
Train Epoch: 26 [393/500 25152/32000 (79%)] Loss: 1.11564 (QuantReg: 15.46961) QuantErr: 15.46961 batch_time=0.39483 
Train Epoch: 26 [401/500 25664/32000 (80%)] Loss: 1.13672 (QuantReg: 15.83154) QuantErr: 15.83154 batch_time=0.39087 
Train Epoch: 26 [409/500 26176/32000 (82%)] Loss: 1.38682 (QuantReg: 15.67023) QuantErr: 15.67023 batch_time=0.38785 
Train Epoch: 26 [417/500 26688/32000 (83%)] Loss: 1.11731 (QuantReg: 15.49761) QuantErr: 15.49761 batch_time=0.38029 
Train Epoch: 26 [425/500 27200/32000 (85%)] Loss: 1.19335 (QuantReg: 15.51922) QuantErr: 15.51922 batch_time=0.39409 
Train Epoch: 26 [433/500 27712/32000 (87%)] Loss: 1.15287 (QuantReg: 15.89942) QuantErr: 15.89942 batch_time=0.39242 
Train Epoch: 26 [441/500 28224/32000 (88%)] Loss: 0.87557 (QuantReg: 15.57738) QuantErr: 15.57738 batch_time=0.38450 
Train Epoch: 26 [449/500 28736/32000 (90%)] Loss: 1.57946 (QuantReg: 15.79151) QuantErr: 15.79151 batch_time=0.39269 
Train Epoch: 26 [457/500 29248/32000 (91%)] Loss: 1.32162 (QuantReg: 15.66612) QuantErr: 15.66612 batch_time=0.39035 
Train Epoch: 26 [465/500 29760/32000 (93%)] Loss: 1.20591 (QuantReg: 15.93551) QuantErr: 15.93551 batch_time=0.38466 
Train Epoch: 26 [473/500 30272/32000 (95%)] Loss: 1.23672 (QuantReg: 15.84014) QuantErr: 15.84014 batch_time=0.38393 
Train Epoch: 26 [481/500 30784/32000 (96%)] Loss: 1.17483 (QuantReg: 15.64837) QuantErr: 15.64837 batch_time=0.40764 
Train Epoch: 26 [489/500 31296/32000 (98%)] Loss: 1.14661 (QuantReg: 15.55116) QuantErr: 15.55116 batch_time=0.38275 
Train Epoch: 26 [497/500 31808/32000 (99%)] Loss: 1.48803 (QuantReg: 15.62711) QuantErr: 15.62711 batch_time=0.39614 
Train Epoch: 26 codebook_update_time=1.88267
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch26.pth ...
Done in 5.777s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch26.pth ...
Done in 10.754s
removing stale ckpt [epoch 25] [took 0.01s]
 epoch          : 26
 loss           : 1.2961494969129563
 quant_reg      : 15.664722076416016
 quant_err      : 15.664722076416016
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 13000
 LSMDC_full_test/t2v_metrics/R1: 13.1
 LSMDC_full_test/t2v_metrics/R5: 31.8
 LSMDC_full_test/t2v_metrics/R10: 41.6
 LSMDC_full_test/t2v_metrics/R50: 67.3
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.349
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.87799246587303
 LSMDC_full_test/v2t_metrics/R1: 12.5
 LSMDC_full_test/v2t_metrics/R5: 31.6
 LSMDC_full_test/v2t_metrics/R10: 40.7
 LSMDC_full_test/v2t_metrics/R50: 67.5
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.607
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.238517145862406
 mnt_best       : 25.87799246587303
 not_improved_count: 0
Train Epoch: 27 [1/500 64/32000 (0%)] Loss: 0.85756 (QuantReg: 15.80789) QuantErr: 15.80789 batch_time=17.86253 
Train Epoch: 27 [9/500 576/32000 (2%)] Loss: 1.68093 (QuantReg: 15.54900) QuantErr: 15.54900 batch_time=0.38177 
Train Epoch: 27 [17/500 1088/32000 (3%)] Loss: 1.26521 (QuantReg: 15.36488) QuantErr: 15.36488 batch_time=1.11316 
Train Epoch: 27 [25/500 1600/32000 (5%)] Loss: 1.59295 (QuantReg: 15.61425) QuantErr: 15.61425 batch_time=0.37425 
Train Epoch: 27 [33/500 2112/32000 (7%)] Loss: 0.93024 (QuantReg: 15.56756) QuantErr: 15.56756 batch_time=0.38239 
Train Epoch: 27 [41/500 2624/32000 (8%)] Loss: 0.83581 (QuantReg: 15.65172) QuantErr: 15.65172 batch_time=0.41394 
Train Epoch: 27 [49/500 3136/32000 (10%)] Loss: 1.03911 (QuantReg: 15.44663) QuantErr: 15.44663 batch_time=0.37928 
Train Epoch: 27 [57/500 3648/32000 (11%)] Loss: 1.18734 (QuantReg: 15.71897) QuantErr: 15.71897 batch_time=0.37527 
Train Epoch: 27 [65/500 4160/32000 (13%)] Loss: 1.26103 (QuantReg: 15.36983) QuantErr: 15.36983 batch_time=0.87727 
Train Epoch: 27 [73/500 4672/32000 (15%)] Loss: 1.18290 (QuantReg: 15.89579) QuantErr: 15.89579 batch_time=0.40130 
Train Epoch: 27 [81/500 5184/32000 (16%)] Loss: 0.97660 (QuantReg: 15.70907) QuantErr: 15.70907 batch_time=0.96203 
Train Epoch: 27 [89/500 5696/32000 (18%)] Loss: 1.41940 (QuantReg: 15.42986) QuantErr: 15.42986 batch_time=0.37752 
Train Epoch: 27 [97/500 6208/32000 (19%)] Loss: 1.42743 (QuantReg: 15.68278) QuantErr: 15.68278 batch_time=0.37715 
Train Epoch: 27 [105/500 6720/32000 (21%)] Loss: 1.16958 (QuantReg: 15.80776) QuantErr: 15.80776 batch_time=0.37712 
Train Epoch: 27 [113/500 7232/32000 (23%)] Loss: 1.52696 (QuantReg: 15.90849) QuantErr: 15.90849 batch_time=0.38181 
Train Epoch: 27 [121/500 7744/32000 (24%)] Loss: 1.16350 (QuantReg: 15.65148) QuantErr: 15.65148 batch_time=0.39296 
Train Epoch: 27 [129/500 8256/32000 (26%)] Loss: 1.48190 (QuantReg: 15.64086) QuantErr: 15.64086 batch_time=0.89933 
Train Epoch: 27 [137/500 8768/32000 (27%)] Loss: 1.36281 (QuantReg: 15.93833) QuantErr: 15.93833 batch_time=0.37793 
Train Epoch: 27 [145/500 9280/32000 (29%)] Loss: 1.36871 (QuantReg: 15.43147) QuantErr: 15.43147 batch_time=0.91858 
Train Epoch: 27 [153/500 9792/32000 (31%)] Loss: 1.49409 (QuantReg: 15.70927) QuantErr: 15.70927 batch_time=0.38356 
Train Epoch: 27 [161/500 10304/32000 (32%)] Loss: 1.03014 (QuantReg: 15.54656) QuantErr: 15.54656 batch_time=0.37671 
Train Epoch: 27 [169/500 10816/32000 (34%)] Loss: 1.17300 (QuantReg: 15.53682) QuantErr: 15.53682 batch_time=0.38857 
Train Epoch: 27 [177/500 11328/32000 (35%)] Loss: 1.00279 (QuantReg: 16.03147) QuantErr: 16.03147 batch_time=0.38080 
Train Epoch: 27 [185/500 11840/32000 (37%)] Loss: 1.50602 (QuantReg: 15.79025) QuantErr: 15.79025 batch_time=0.37852 
Train Epoch: 27 [193/500 12352/32000 (39%)] Loss: 1.23869 (QuantReg: 15.54856) QuantErr: 15.54856 batch_time=0.88192 
Train Epoch: 27 [201/500 12864/32000 (40%)] Loss: 1.60247 (QuantReg: 15.54454) QuantErr: 15.54454 batch_time=0.38561 
Train Epoch: 27 [209/500 13376/32000 (42%)] Loss: 1.37621 (QuantReg: 15.62184) QuantErr: 15.62184 batch_time=0.92150 
Train Epoch: 27 [217/500 13888/32000 (43%)] Loss: 1.13521 (QuantReg: 15.75149) QuantErr: 15.75149 batch_time=0.38684 
Train Epoch: 27 [225/500 14400/32000 (45%)] Loss: 1.39137 (QuantReg: 15.94647) QuantErr: 15.94647 batch_time=0.37679 
Train Epoch: 27 [233/500 14912/32000 (47%)] Loss: 1.09393 (QuantReg: 15.77790) QuantErr: 15.77790 batch_time=0.38034 
Train Epoch: 27 [241/500 15424/32000 (48%)] Loss: 1.19628 (QuantReg: 15.75853) QuantErr: 15.75853 batch_time=0.37789 
Train Epoch: 27 [249/500 15936/32000 (50%)] Loss: 1.28399 (QuantReg: 15.69965) QuantErr: 15.69965 batch_time=0.38383 
Train Epoch: 27 [257/500 16448/32000 (51%)] Loss: 1.11801 (QuantReg: 15.86419) QuantErr: 15.86419 batch_time=0.90946 
Train Epoch: 27 [265/500 16960/32000 (53%)] Loss: 1.26214 (QuantReg: 15.64232) QuantErr: 15.64232 batch_time=0.37893 
Train Epoch: 27 [273/500 17472/32000 (55%)] Loss: 0.93127 (QuantReg: 15.78808) QuantErr: 15.78808 batch_time=0.96309 
Train Epoch: 27 [281/500 17984/32000 (56%)] Loss: 1.29934 (QuantReg: 15.87673) QuantErr: 15.87673 batch_time=0.38673 
Train Epoch: 27 [289/500 18496/32000 (58%)] Loss: 1.20901 (QuantReg: 15.64706) QuantErr: 15.64706 batch_time=0.38233 
Train Epoch: 27 [297/500 19008/32000 (59%)] Loss: 1.54006 (QuantReg: 15.70577) QuantErr: 15.70577 batch_time=0.40394 
Train Epoch: 27 [305/500 19520/32000 (61%)] Loss: 1.14290 (QuantReg: 15.86704) QuantErr: 15.86704 batch_time=0.41839 
Train Epoch: 27 [313/500 20032/32000 (63%)] Loss: 1.19368 (QuantReg: 15.84321) QuantErr: 15.84321 batch_time=0.38039 
Train Epoch: 27 [321/500 20544/32000 (64%)] Loss: 1.04326 (QuantReg: 15.72189) QuantErr: 15.72189 batch_time=0.87909 
Train Epoch: 27 [329/500 21056/32000 (66%)] Loss: 1.04337 (QuantReg: 15.80310) QuantErr: 15.80310 batch_time=0.38114 
Train Epoch: 27 [337/500 21568/32000 (67%)] Loss: 1.32464 (QuantReg: 15.85805) QuantErr: 15.85805 batch_time=0.92934 
Train Epoch: 27 [345/500 22080/32000 (69%)] Loss: 1.52972 (QuantReg: 15.67666) QuantErr: 15.67666 batch_time=0.38635 
Train Epoch: 27 [353/500 22592/32000 (71%)] Loss: 1.38533 (QuantReg: 15.75263) QuantErr: 15.75263 batch_time=0.38886 
Train Epoch: 27 [361/500 23104/32000 (72%)] Loss: 0.94813 (QuantReg: 15.61234) QuantErr: 15.61234 batch_time=0.37649 
Train Epoch: 27 [369/500 23616/32000 (74%)] Loss: 0.99971 (QuantReg: 15.63157) QuantErr: 15.63157 batch_time=0.37646 
Train Epoch: 27 [377/500 24128/32000 (75%)] Loss: 1.36435 (QuantReg: 15.50677) QuantErr: 15.50677 batch_time=0.37793 
Train Epoch: 27 [385/500 24640/32000 (77%)] Loss: 1.00466 (QuantReg: 15.75745) QuantErr: 15.75745 batch_time=0.88207 
Train Epoch: 27 [393/500 25152/32000 (79%)] Loss: 1.10021 (QuantReg: 15.71929) QuantErr: 15.71929 batch_time=0.38305 
Train Epoch: 27 [401/500 25664/32000 (80%)] Loss: 1.16107 (QuantReg: 15.74967) QuantErr: 15.74967 batch_time=0.92062 
Train Epoch: 27 [409/500 26176/32000 (82%)] Loss: 1.11373 (QuantReg: 15.93976) QuantErr: 15.93976 batch_time=0.37932 
Train Epoch: 27 [417/500 26688/32000 (83%)] Loss: 1.10424 (QuantReg: 15.66639) QuantErr: 15.66639 batch_time=0.38477 
Train Epoch: 27 [425/500 27200/32000 (85%)] Loss: 1.01516 (QuantReg: 15.48170) QuantErr: 15.48170 batch_time=0.38576 
Train Epoch: 27 [433/500 27712/32000 (87%)] Loss: 1.23496 (QuantReg: 15.65334) QuantErr: 15.65334 batch_time=0.37963 
Train Epoch: 27 [441/500 28224/32000 (88%)] Loss: 1.52519 (QuantReg: 15.65437) QuantErr: 15.65437 batch_time=0.39015 
Train Epoch: 27 [449/500 28736/32000 (90%)] Loss: 1.11151 (QuantReg: 15.69237) QuantErr: 15.69237 batch_time=0.88025 
Train Epoch: 27 [457/500 29248/32000 (91%)] Loss: 1.24957 (QuantReg: 15.60583) QuantErr: 15.60583 batch_time=0.38741 
Train Epoch: 27 [465/500 29760/32000 (93%)] Loss: 1.04231 (QuantReg: 15.75457) QuantErr: 15.75457 batch_time=0.98598 
Train Epoch: 27 [473/500 30272/32000 (95%)] Loss: 1.55487 (QuantReg: 15.64748) QuantErr: 15.64748 batch_time=0.39116 
Train Epoch: 27 [481/500 30784/32000 (96%)] Loss: 1.46534 (QuantReg: 15.78630) QuantErr: 15.78630 batch_time=0.38348 
Train Epoch: 27 [489/500 31296/32000 (98%)] Loss: 1.32786 (QuantReg: 15.44986) QuantErr: 15.44986 batch_time=0.39922 
Train Epoch: 27 [497/500 31808/32000 (99%)] Loss: 1.21431 (QuantReg: 15.82810) QuantErr: 15.82810 batch_time=0.38156 
Train Epoch: 27 codebook_update_time=2.33702
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch27.pth ...
Done in 4.287s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 1.2585258269309998
 quant_reg      : 15.688455324172974
 quant_err      : 15.688455324172974
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 13500
 LSMDC_full_test/t2v_metrics/R1: 11.8
 LSMDC_full_test/t2v_metrics/R5: 30.5
 LSMDC_full_test/t2v_metrics/R10: 40.6
 LSMDC_full_test/t2v_metrics/R50: 67.3
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.053
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.4475847358321
 LSMDC_full_test/v2t_metrics/R1: 11.4
 LSMDC_full_test/v2t_metrics/R5: 30.1
 LSMDC_full_test/v2t_metrics/R10: 40.4
 LSMDC_full_test/v2t_metrics/R50: 66.3
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.31
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.02246507623121
 mnt_best       : 25.87799246587303
 not_improved_count: 1
Train Epoch: 28 [1/500 64/32000 (0%)] Loss: 0.90437 (QuantReg: 15.73857) QuantErr: 15.73857 batch_time=18.10160 
Train Epoch: 28 [9/500 576/32000 (2%)] Loss: 1.29220 (QuantReg: 15.39606) QuantErr: 15.39606 batch_time=0.42742 
Train Epoch: 28 [17/500 1088/32000 (3%)] Loss: 1.34679 (QuantReg: 15.69486) QuantErr: 15.69486 batch_time=0.39690 
Train Epoch: 28 [25/500 1600/32000 (5%)] Loss: 1.50496 (QuantReg: 15.81311) QuantErr: 15.81311 batch_time=0.37943 
Train Epoch: 28 [33/500 2112/32000 (7%)] Loss: 1.19074 (QuantReg: 15.78725) QuantErr: 15.78725 batch_time=0.37688 
Train Epoch: 28 [41/500 2624/32000 (8%)] Loss: 1.45903 (QuantReg: 15.87432) QuantErr: 15.87432 batch_time=0.38034 
Train Epoch: 28 [49/500 3136/32000 (10%)] Loss: 0.91820 (QuantReg: 15.79514) QuantErr: 15.79514 batch_time=0.39976 
Train Epoch: 28 [57/500 3648/32000 (11%)] Loss: 1.61469 (QuantReg: 15.89653) QuantErr: 15.89653 batch_time=0.38803 
Train Epoch: 28 [65/500 4160/32000 (13%)] Loss: 1.05487 (QuantReg: 15.69338) QuantErr: 15.69338 batch_time=0.37891 
Train Epoch: 28 [73/500 4672/32000 (15%)] Loss: 1.23564 (QuantReg: 15.57915) QuantErr: 15.57915 batch_time=0.38062 
Train Epoch: 28 [81/500 5184/32000 (16%)] Loss: 1.03526 (QuantReg: 15.85756) QuantErr: 15.85756 batch_time=0.37644 
Train Epoch: 28 [89/500 5696/32000 (18%)] Loss: 1.13931 (QuantReg: 15.90025) QuantErr: 15.90025 batch_time=0.37955 
Train Epoch: 28 [97/500 6208/32000 (19%)] Loss: 1.10394 (QuantReg: 15.68713) QuantErr: 15.68713 batch_time=0.38199 
Train Epoch: 28 [105/500 6720/32000 (21%)] Loss: 1.11130 (QuantReg: 15.63518) QuantErr: 15.63518 batch_time=0.37979 
Train Epoch: 28 [113/500 7232/32000 (23%)] Loss: 1.78168 (QuantReg: 15.77693) QuantErr: 15.77693 batch_time=0.38850 
Train Epoch: 28 [121/500 7744/32000 (24%)] Loss: 1.37818 (QuantReg: 15.45953) QuantErr: 15.45953 batch_time=0.38111 
Train Epoch: 28 [129/500 8256/32000 (26%)] Loss: 1.20714 (QuantReg: 15.87052) QuantErr: 15.87052 batch_time=0.38132 
Train Epoch: 28 [137/500 8768/32000 (27%)] Loss: 1.18725 (QuantReg: 15.64351) QuantErr: 15.64351 batch_time=0.38229 
Train Epoch: 28 [145/500 9280/32000 (29%)] Loss: 1.27512 (QuantReg: 15.46909) QuantErr: 15.46909 batch_time=0.39321 
Train Epoch: 28 [153/500 9792/32000 (31%)] Loss: 1.55655 (QuantReg: 15.54248) QuantErr: 15.54248 batch_time=0.37701 
Train Epoch: 28 [161/500 10304/32000 (32%)] Loss: 1.34853 (QuantReg: 15.82062) QuantErr: 15.82062 batch_time=0.37999 
Train Epoch: 28 [169/500 10816/32000 (34%)] Loss: 1.32387 (QuantReg: 15.50165) QuantErr: 15.50165 batch_time=0.38004 
Train Epoch: 28 [177/500 11328/32000 (35%)] Loss: 1.38693 (QuantReg: 15.68129) QuantErr: 15.68129 batch_time=0.37783 
Train Epoch: 28 [185/500 11840/32000 (37%)] Loss: 1.35680 (QuantReg: 15.79611) QuantErr: 15.79611 batch_time=0.39037 
Train Epoch: 28 [193/500 12352/32000 (39%)] Loss: 1.81620 (QuantReg: 15.68430) QuantErr: 15.68430 batch_time=0.39903 
Train Epoch: 28 [201/500 12864/32000 (40%)] Loss: 1.53543 (QuantReg: 15.67417) QuantErr: 15.67417 batch_time=0.38323 
Train Epoch: 28 [209/500 13376/32000 (42%)] Loss: 1.35598 (QuantReg: 15.77686) QuantErr: 15.77686 batch_time=0.38591 
Train Epoch: 28 [217/500 13888/32000 (43%)] Loss: 1.03326 (QuantReg: 15.83474) QuantErr: 15.83474 batch_time=0.38570 
Train Epoch: 28 [225/500 14400/32000 (45%)] Loss: 0.98288 (QuantReg: 15.69536) QuantErr: 15.69536 batch_time=0.38427 
Train Epoch: 28 [233/500 14912/32000 (47%)] Loss: 1.29553 (QuantReg: 15.77161) QuantErr: 15.77161 batch_time=0.38140 
Train Epoch: 28 [241/500 15424/32000 (48%)] Loss: 1.46110 (QuantReg: 15.64648) QuantErr: 15.64648 batch_time=0.38739 
Train Epoch: 28 [249/500 15936/32000 (50%)] Loss: 1.36079 (QuantReg: 15.76792) QuantErr: 15.76792 batch_time=0.38298 
Train Epoch: 28 [257/500 16448/32000 (51%)] Loss: 1.19042 (QuantReg: 15.88658) QuantErr: 15.88658 batch_time=0.37734 
Train Epoch: 28 [265/500 16960/32000 (53%)] Loss: 0.91991 (QuantReg: 15.50355) QuantErr: 15.50355 batch_time=0.38979 
Train Epoch: 28 [273/500 17472/32000 (55%)] Loss: 1.51111 (QuantReg: 15.74951) QuantErr: 15.74951 batch_time=0.38832 
Train Epoch: 28 [281/500 17984/32000 (56%)] Loss: 1.14637 (QuantReg: 15.85739) QuantErr: 15.85739 batch_time=0.37958 
Train Epoch: 28 [289/500 18496/32000 (58%)] Loss: 1.36324 (QuantReg: 15.95470) QuantErr: 15.95470 batch_time=0.39429 
Train Epoch: 28 [297/500 19008/32000 (59%)] Loss: 1.18109 (QuantReg: 15.71604) QuantErr: 15.71604 batch_time=0.38100 
Train Epoch: 28 [305/500 19520/32000 (61%)] Loss: 0.79632 (QuantReg: 15.90069) QuantErr: 15.90069 batch_time=0.43632 
Train Epoch: 28 [313/500 20032/32000 (63%)] Loss: 1.25496 (QuantReg: 15.79261) QuantErr: 15.79261 batch_time=0.37901 
Train Epoch: 28 [321/500 20544/32000 (64%)] Loss: 1.59212 (QuantReg: 15.75959) QuantErr: 15.75959 batch_time=0.37946 
Train Epoch: 28 [329/500 21056/32000 (66%)] Loss: 1.56850 (QuantReg: 15.55595) QuantErr: 15.55595 batch_time=0.39136 
Train Epoch: 28 [337/500 21568/32000 (67%)] Loss: 1.15221 (QuantReg: 15.70285) QuantErr: 15.70285 batch_time=0.37843 
Train Epoch: 28 [345/500 22080/32000 (69%)] Loss: 1.02931 (QuantReg: 15.69838) QuantErr: 15.69838 batch_time=0.38347 
Train Epoch: 28 [353/500 22592/32000 (71%)] Loss: 1.26290 (QuantReg: 15.69317) QuantErr: 15.69317 batch_time=0.38361 
Train Epoch: 28 [361/500 23104/32000 (72%)] Loss: 1.33444 (QuantReg: 15.78445) QuantErr: 15.78445 batch_time=0.38709 
Train Epoch: 28 [369/500 23616/32000 (74%)] Loss: 1.40182 (QuantReg: 15.74600) QuantErr: 15.74600 batch_time=0.38824 
Train Epoch: 28 [377/500 24128/32000 (75%)] Loss: 1.14961 (QuantReg: 15.72807) QuantErr: 15.72807 batch_time=0.39076 
Train Epoch: 28 [385/500 24640/32000 (77%)] Loss: 1.01566 (QuantReg: 15.90783) QuantErr: 15.90783 batch_time=0.38299 
Train Epoch: 28 [393/500 25152/32000 (79%)] Loss: 1.36234 (QuantReg: 15.58733) QuantErr: 15.58733 batch_time=0.42829 
Train Epoch: 28 [401/500 25664/32000 (80%)] Loss: 1.43112 (QuantReg: 15.55081) QuantErr: 15.55081 batch_time=0.38352 
Train Epoch: 28 [409/500 26176/32000 (82%)] Loss: 1.04934 (QuantReg: 15.90642) QuantErr: 15.90642 batch_time=0.38560 
Train Epoch: 28 [417/500 26688/32000 (83%)] Loss: 0.89598 (QuantReg: 15.72655) QuantErr: 15.72655 batch_time=0.38376 
Train Epoch: 28 [425/500 27200/32000 (85%)] Loss: 1.40785 (QuantReg: 15.84551) QuantErr: 15.84551 batch_time=0.38340 
Train Epoch: 28 [433/500 27712/32000 (87%)] Loss: 1.04516 (QuantReg: 15.69330) QuantErr: 15.69330 batch_time=0.38055 
Train Epoch: 28 [441/500 28224/32000 (88%)] Loss: 1.67505 (QuantReg: 15.82983) QuantErr: 15.82983 batch_time=0.38280 
Train Epoch: 28 [449/500 28736/32000 (90%)] Loss: 0.83653 (QuantReg: 15.84405) QuantErr: 15.84405 batch_time=0.37807 
Train Epoch: 28 [457/500 29248/32000 (91%)] Loss: 1.58116 (QuantReg: 15.72429) QuantErr: 15.72429 batch_time=0.40317 
Train Epoch: 28 [465/500 29760/32000 (93%)] Loss: 1.52217 (QuantReg: 15.65402) QuantErr: 15.65402 batch_time=0.38544 
Train Epoch: 28 [473/500 30272/32000 (95%)] Loss: 0.98181 (QuantReg: 15.99108) QuantErr: 15.99108 batch_time=0.38395 
Train Epoch: 28 [481/500 30784/32000 (96%)] Loss: 1.31785 (QuantReg: 15.89562) QuantErr: 15.89562 batch_time=0.38545 
Train Epoch: 28 [489/500 31296/32000 (98%)] Loss: 1.20514 (QuantReg: 15.88890) QuantErr: 15.88890 batch_time=0.38685 
Train Epoch: 28 [497/500 31808/32000 (99%)] Loss: 1.10045 (QuantReg: 15.48270) QuantErr: 15.48270 batch_time=0.38737 
Train Epoch: 28 codebook_update_time=2.00695
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch28.pth ...
Done in 5.867s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 1.2302761939764022
 quant_reg      : 15.71583164024353
 quant_err      : 15.71583164024353
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 14000
 LSMDC_full_test/t2v_metrics/R1: 12.3
 LSMDC_full_test/t2v_metrics/R5: 31.8
 LSMDC_full_test/t2v_metrics/R10: 41.2
 LSMDC_full_test/t2v_metrics/R50: 67.6
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 74.291
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.258631431355205
 LSMDC_full_test/v2t_metrics/R1: 12.0
 LSMDC_full_test/v2t_metrics/R5: 30.2
 LSMDC_full_test/v2t_metrics/R10: 40.4
 LSMDC_full_test/v2t_metrics/R50: 67.4
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 72.508
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.463758717453395
 mnt_best       : 25.87799246587303
 not_improved_count: 2
Train Epoch: 29 [1/500 64/32000 (0%)] Loss: 1.20144 (QuantReg: 15.74443) QuantErr: 15.74443 batch_time=19.85655 
Train Epoch: 29 [9/500 576/32000 (2%)] Loss: 1.10529 (QuantReg: 15.74477) QuantErr: 15.74477 batch_time=0.41206 
Train Epoch: 29 [17/500 1088/32000 (3%)] Loss: 1.12329 (QuantReg: 15.45292) QuantErr: 15.45292 batch_time=0.39986 
Train Epoch: 29 [25/500 1600/32000 (5%)] Loss: 1.50408 (QuantReg: 15.87060) QuantErr: 15.87060 batch_time=0.40625 
Train Epoch: 29 [33/500 2112/32000 (7%)] Loss: 1.44743 (QuantReg: 15.69114) QuantErr: 15.69114 batch_time=0.42963 
Train Epoch: 29 [41/500 2624/32000 (8%)] Loss: 1.36642 (QuantReg: 15.66996) QuantErr: 15.66996 batch_time=0.39414 
Train Epoch: 29 [49/500 3136/32000 (10%)] Loss: 1.05519 (QuantReg: 15.74786) QuantErr: 15.74786 batch_time=0.38320 
Train Epoch: 29 [57/500 3648/32000 (11%)] Loss: 1.10858 (QuantReg: 15.91296) QuantErr: 15.91296 batch_time=0.44494 
Train Epoch: 29 [65/500 4160/32000 (13%)] Loss: 1.25250 (QuantReg: 15.60377) QuantErr: 15.60377 batch_time=1.07945 
Train Epoch: 29 [73/500 4672/32000 (15%)] Loss: 1.24677 (QuantReg: 15.66991) QuantErr: 15.66991 batch_time=0.38649 
Train Epoch: 29 [81/500 5184/32000 (16%)] Loss: 1.14081 (QuantReg: 15.60214) QuantErr: 15.60214 batch_time=0.38945 
Train Epoch: 29 [89/500 5696/32000 (18%)] Loss: 1.30575 (QuantReg: 15.63031) QuantErr: 15.63031 batch_time=0.38640 
Train Epoch: 29 [97/500 6208/32000 (19%)] Loss: 0.87929 (QuantReg: 15.71932) QuantErr: 15.71932 batch_time=0.38612 
Train Epoch: 29 [105/500 6720/32000 (21%)] Loss: 0.95524 (QuantReg: 15.48078) QuantErr: 15.48078 batch_time=0.37705 
Train Epoch: 29 [113/500 7232/32000 (23%)] Loss: 1.23154 (QuantReg: 15.80397) QuantErr: 15.80397 batch_time=0.37552 
Train Epoch: 29 [121/500 7744/32000 (24%)] Loss: 1.19948 (QuantReg: 15.73095) QuantErr: 15.73095 batch_time=0.43363 
Train Epoch: 29 [129/500 8256/32000 (26%)] Loss: 1.20634 (QuantReg: 15.79041) QuantErr: 15.79041 batch_time=1.12920 
Train Epoch: 29 [137/500 8768/32000 (27%)] Loss: 1.22533 (QuantReg: 16.03901) QuantErr: 16.03901 batch_time=0.37764 
Train Epoch: 29 [145/500 9280/32000 (29%)] Loss: 1.73234 (QuantReg: 15.55683) QuantErr: 15.55683 batch_time=0.38291 
Train Epoch: 29 [153/500 9792/32000 (31%)] Loss: 1.10660 (QuantReg: 15.61667) QuantErr: 15.61667 batch_time=0.39115 
Train Epoch: 29 [161/500 10304/32000 (32%)] Loss: 0.90626 (QuantReg: 16.18263) QuantErr: 16.18263 batch_time=0.37624 
Train Epoch: 29 [169/500 10816/32000 (34%)] Loss: 1.35110 (QuantReg: 15.87943) QuantErr: 15.87943 batch_time=0.38277 
Train Epoch: 29 [177/500 11328/32000 (35%)] Loss: 0.81604 (QuantReg: 15.68080) QuantErr: 15.68080 batch_time=0.43418 
Train Epoch: 29 [185/500 11840/32000 (37%)] Loss: 0.91292 (QuantReg: 15.78830) QuantErr: 15.78830 batch_time=0.48998 
Train Epoch: 29 [193/500 12352/32000 (39%)] Loss: 0.93518 (QuantReg: 15.77581) QuantErr: 15.77581 batch_time=1.09591 
Train Epoch: 29 [201/500 12864/32000 (40%)] Loss: 1.37874 (QuantReg: 15.77652) QuantErr: 15.77652 batch_time=0.40307 
Train Epoch: 29 [209/500 13376/32000 (42%)] Loss: 1.51767 (QuantReg: 15.70483) QuantErr: 15.70483 batch_time=0.38539 
Train Epoch: 29 [217/500 13888/32000 (43%)] Loss: 1.18081 (QuantReg: 15.63308) QuantErr: 15.63308 batch_time=0.37384 
Train Epoch: 29 [225/500 14400/32000 (45%)] Loss: 1.07964 (QuantReg: 15.63140) QuantErr: 15.63140 batch_time=0.37101 
Train Epoch: 29 [233/500 14912/32000 (47%)] Loss: 1.50762 (QuantReg: 15.62135) QuantErr: 15.62135 batch_time=0.38645 
Train Epoch: 29 [241/500 15424/32000 (48%)] Loss: 1.07904 (QuantReg: 15.61859) QuantErr: 15.61859 batch_time=0.37259 
Train Epoch: 29 [249/500 15936/32000 (50%)] Loss: 1.13511 (QuantReg: 15.67112) QuantErr: 15.67112 batch_time=0.42261 
Train Epoch: 29 [257/500 16448/32000 (51%)] Loss: 1.20294 (QuantReg: 15.74356) QuantErr: 15.74356 batch_time=1.11524 
Train Epoch: 29 [265/500 16960/32000 (53%)] Loss: 1.35546 (QuantReg: 15.78313) QuantErr: 15.78313 batch_time=0.38608 
Train Epoch: 29 [273/500 17472/32000 (55%)] Loss: 1.19863 (QuantReg: 15.94704) QuantErr: 15.94704 batch_time=0.38380 
Train Epoch: 29 [281/500 17984/32000 (56%)] Loss: 1.35308 (QuantReg: 15.59597) QuantErr: 15.59597 batch_time=0.37517 
Train Epoch: 29 [289/500 18496/32000 (58%)] Loss: 1.40313 (QuantReg: 15.57562) QuantErr: 15.57562 batch_time=0.44606 
Train Epoch: 29 [297/500 19008/32000 (59%)] Loss: 1.27769 (QuantReg: 15.90907) QuantErr: 15.90907 batch_time=0.41971 
Train Epoch: 29 [305/500 19520/32000 (61%)] Loss: 1.05061 (QuantReg: 15.90486) QuantErr: 15.90486 batch_time=0.38035 
Train Epoch: 29 [313/500 20032/32000 (63%)] Loss: 1.16352 (QuantReg: 15.71804) QuantErr: 15.71804 batch_time=0.47615 
Train Epoch: 29 [321/500 20544/32000 (64%)] Loss: 1.04998 (QuantReg: 15.58928) QuantErr: 15.58928 batch_time=1.08705 
Train Epoch: 29 [329/500 21056/32000 (66%)] Loss: 0.77679 (QuantReg: 15.83787) QuantErr: 15.83787 batch_time=0.38679 
Train Epoch: 29 [337/500 21568/32000 (67%)] Loss: 1.27784 (QuantReg: 15.88369) QuantErr: 15.88369 batch_time=0.38373 
Train Epoch: 29 [345/500 22080/32000 (69%)] Loss: 1.12090 (QuantReg: 15.90782) QuantErr: 15.90782 batch_time=0.39074 
Train Epoch: 29 [353/500 22592/32000 (71%)] Loss: 1.82267 (QuantReg: 15.62524) QuantErr: 15.62524 batch_time=0.40106 
Train Epoch: 29 [361/500 23104/32000 (72%)] Loss: 1.38342 (QuantReg: 15.70670) QuantErr: 15.70670 batch_time=0.37933 
Train Epoch: 29 [369/500 23616/32000 (74%)] Loss: 1.30571 (QuantReg: 15.75256) QuantErr: 15.75256 batch_time=0.37854 
Train Epoch: 29 [377/500 24128/32000 (75%)] Loss: 1.14998 (QuantReg: 15.80331) QuantErr: 15.80331 batch_time=0.42682 
Train Epoch: 29 [385/500 24640/32000 (77%)] Loss: 1.78274 (QuantReg: 15.67383) QuantErr: 15.67383 batch_time=1.08807 
Train Epoch: 29 [393/500 25152/32000 (79%)] Loss: 1.59461 (QuantReg: 15.30406) QuantErr: 15.30406 batch_time=0.38343 
Train Epoch: 29 [401/500 25664/32000 (80%)] Loss: 1.23850 (QuantReg: 15.64242) QuantErr: 15.64242 batch_time=0.38158 
Train Epoch: 29 [409/500 26176/32000 (82%)] Loss: 1.16113 (QuantReg: 15.91205) QuantErr: 15.91205 batch_time=0.39168 
Train Epoch: 29 [417/500 26688/32000 (83%)] Loss: 0.96143 (QuantReg: 15.87649) QuantErr: 15.87649 batch_time=0.37550 
Train Epoch: 29 [425/500 27200/32000 (85%)] Loss: 1.31613 (QuantReg: 15.79386) QuantErr: 15.79386 batch_time=0.39795 
Train Epoch: 29 [433/500 27712/32000 (87%)] Loss: 1.29873 (QuantReg: 15.64444) QuantErr: 15.64444 batch_time=0.39153 
Train Epoch: 29 [441/500 28224/32000 (88%)] Loss: 1.03094 (QuantReg: 15.83129) QuantErr: 15.83129 batch_time=0.44616 
Train Epoch: 29 [449/500 28736/32000 (90%)] Loss: 0.82792 (QuantReg: 15.69843) QuantErr: 15.69843 batch_time=1.10751 
Train Epoch: 29 [457/500 29248/32000 (91%)] Loss: 1.16828 (QuantReg: 15.82594) QuantErr: 15.82594 batch_time=0.39852 
Train Epoch: 29 [465/500 29760/32000 (93%)] Loss: 0.89483 (QuantReg: 15.82580) QuantErr: 15.82580 batch_time=0.38479 
Train Epoch: 29 [473/500 30272/32000 (95%)] Loss: 1.07850 (QuantReg: 15.50285) QuantErr: 15.50285 batch_time=0.39152 
Train Epoch: 29 [481/500 30784/32000 (96%)] Loss: 1.37570 (QuantReg: 15.70885) QuantErr: 15.70885 batch_time=0.38910 
Train Epoch: 29 [489/500 31296/32000 (98%)] Loss: 1.39663 (QuantReg: 16.00730) QuantErr: 16.00730 batch_time=0.40426 
Train Epoch: 29 [497/500 31808/32000 (99%)] Loss: 1.04007 (QuantReg: 15.99368) QuantErr: 15.99368 batch_time=0.43668 
Train Epoch: 29 codebook_update_time=2.00957
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch29.pth ...
Done in 6.472s
removing stale ckpt [epoch 28] [took 0.04s]
 epoch          : 29
 loss           : 1.1887647689580918
 quant_reg      : 15.724075475692748
 quant_err      : 15.724075475692748
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 14500
 LSMDC_full_test/t2v_metrics/R1: 12.3
 LSMDC_full_test/t2v_metrics/R5: 31.3
 LSMDC_full_test/t2v_metrics/R10: 41.7
 LSMDC_full_test/t2v_metrics/R50: 66.7
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.396
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.226780863863368
 LSMDC_full_test/v2t_metrics/R1: 12.6
 LSMDC_full_test/v2t_metrics/R5: 30.1
 LSMDC_full_test/v2t_metrics/R10: 40.4
 LSMDC_full_test/v2t_metrics/R50: 66.3
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.121
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.83740021178183
 mnt_best       : 25.87799246587303
 not_improved_count: 3
Train Epoch: 30 [1/500 64/32000 (0%)] Loss: 1.19652 (QuantReg: 15.73097) QuantErr: 15.73097 batch_time=18.73154 
Train Epoch: 30 [9/500 576/32000 (2%)] Loss: 0.87810 (QuantReg: 15.73753) QuantErr: 15.73753 batch_time=0.39450 
Train Epoch: 30 [17/500 1088/32000 (3%)] Loss: 1.22577 (QuantReg: 15.79993) QuantErr: 15.79993 batch_time=0.37202 
Train Epoch: 30 [25/500 1600/32000 (5%)] Loss: 1.19683 (QuantReg: 15.59794) QuantErr: 15.59794 batch_time=0.39069 
Train Epoch: 30 [33/500 2112/32000 (7%)] Loss: 1.34416 (QuantReg: 15.53241) QuantErr: 15.53241 batch_time=0.37530 
Train Epoch: 30 [41/500 2624/32000 (8%)] Loss: 1.31636 (QuantReg: 15.81057) QuantErr: 15.81057 batch_time=0.41534 
Train Epoch: 30 [49/500 3136/32000 (10%)] Loss: 1.04682 (QuantReg: 15.65569) QuantErr: 15.65569 batch_time=0.38153 
Train Epoch: 30 [57/500 3648/32000 (11%)] Loss: 1.09252 (QuantReg: 15.52094) QuantErr: 15.52094 batch_time=0.43301 
Train Epoch: 30 [65/500 4160/32000 (13%)] Loss: 0.96941 (QuantReg: 15.78222) QuantErr: 15.78222 batch_time=0.53609 
Train Epoch: 30 [73/500 4672/32000 (15%)] Loss: 1.02094 (QuantReg: 15.56628) QuantErr: 15.56628 batch_time=0.38081 
Train Epoch: 30 [81/500 5184/32000 (16%)] Loss: 1.14611 (QuantReg: 15.50723) QuantErr: 15.50723 batch_time=0.38311 
Train Epoch: 30 [89/500 5696/32000 (18%)] Loss: 1.13492 (QuantReg: 15.96334) QuantErr: 15.96334 batch_time=0.37988 
Train Epoch: 30 [97/500 6208/32000 (19%)] Loss: 1.25697 (QuantReg: 15.69708) QuantErr: 15.69708 batch_time=0.40249 
Train Epoch: 30 [105/500 6720/32000 (21%)] Loss: 0.81863 (QuantReg: 15.79676) QuantErr: 15.79676 batch_time=0.37713 
Train Epoch: 30 [113/500 7232/32000 (23%)] Loss: 1.22923 (QuantReg: 15.67079) QuantErr: 15.67079 batch_time=0.38585 
Train Epoch: 30 [121/500 7744/32000 (24%)] Loss: 1.26869 (QuantReg: 15.95905) QuantErr: 15.95905 batch_time=0.45092 
Train Epoch: 30 [129/500 8256/32000 (26%)] Loss: 1.14405 (QuantReg: 15.76734) QuantErr: 15.76734 batch_time=0.53238 
Train Epoch: 30 [137/500 8768/32000 (27%)] Loss: 1.14789 (QuantReg: 15.88373) QuantErr: 15.88373 batch_time=0.42369 
Train Epoch: 30 [145/500 9280/32000 (29%)] Loss: 1.12008 (QuantReg: 15.84984) QuantErr: 15.84984 batch_time=0.38240 
Train Epoch: 30 [153/500 9792/32000 (31%)] Loss: 1.54859 (QuantReg: 15.77939) QuantErr: 15.77939 batch_time=0.37874 
Train Epoch: 30 [161/500 10304/32000 (32%)] Loss: 1.47047 (QuantReg: 15.80631) QuantErr: 15.80631 batch_time=0.37228 
Train Epoch: 30 [169/500 10816/32000 (34%)] Loss: 1.18595 (QuantReg: 15.79657) QuantErr: 15.79657 batch_time=0.38361 
Train Epoch: 30 [177/500 11328/32000 (35%)] Loss: 1.15442 (QuantReg: 15.52208) QuantErr: 15.52208 batch_time=0.38072 
Train Epoch: 30 [185/500 11840/32000 (37%)] Loss: 1.44567 (QuantReg: 15.74363) QuantErr: 15.74363 batch_time=0.43752 
Train Epoch: 30 [193/500 12352/32000 (39%)] Loss: 1.15662 (QuantReg: 15.65739) QuantErr: 15.65739 batch_time=0.53717 
Train Epoch: 30 [201/500 12864/32000 (40%)] Loss: 1.03939 (QuantReg: 15.88015) QuantErr: 15.88015 batch_time=0.38591 
Train Epoch: 30 [209/500 13376/32000 (42%)] Loss: 1.15832 (QuantReg: 15.71982) QuantErr: 15.71982 batch_time=0.39619 
Train Epoch: 30 [217/500 13888/32000 (43%)] Loss: 1.06791 (QuantReg: 15.65721) QuantErr: 15.65721 batch_time=0.38257 
Train Epoch: 30 [225/500 14400/32000 (45%)] Loss: 1.24556 (QuantReg: 15.74467) QuantErr: 15.74467 batch_time=0.37801 
Train Epoch: 30 [233/500 14912/32000 (47%)] Loss: 1.24254 (QuantReg: 15.93363) QuantErr: 15.93363 batch_time=0.37871 
Train Epoch: 30 [241/500 15424/32000 (48%)] Loss: 1.25380 (QuantReg: 15.79550) QuantErr: 15.79550 batch_time=0.37793 
Train Epoch: 30 [249/500 15936/32000 (50%)] Loss: 0.98887 (QuantReg: 15.88549) QuantErr: 15.88549 batch_time=0.43286 
Train Epoch: 30 [257/500 16448/32000 (51%)] Loss: 1.09106 (QuantReg: 15.78116) QuantErr: 15.78116 batch_time=0.52942 
Train Epoch: 30 [265/500 16960/32000 (53%)] Loss: 0.90780 (QuantReg: 15.76644) QuantErr: 15.76644 batch_time=0.37177 
Train Epoch: 30 [273/500 17472/32000 (55%)] Loss: 0.81605 (QuantReg: 15.83884) QuantErr: 15.83884 batch_time=0.37189 
Train Epoch: 30 [281/500 17984/32000 (56%)] Loss: 1.14700 (QuantReg: 15.98339) QuantErr: 15.98339 batch_time=0.36878 
Train Epoch: 30 [289/500 18496/32000 (58%)] Loss: 1.23160 (QuantReg: 15.71345) QuantErr: 15.71345 batch_time=0.37377 
Train Epoch: 30 [297/500 19008/32000 (59%)] Loss: 1.35137 (QuantReg: 15.77848) QuantErr: 15.77848 batch_time=0.37321 
Train Epoch: 30 [305/500 19520/32000 (61%)] Loss: 1.19286 (QuantReg: 15.60562) QuantErr: 15.60562 batch_time=0.36496 
Train Epoch: 30 [313/500 20032/32000 (63%)] Loss: 0.92145 (QuantReg: 15.84572) QuantErr: 15.84572 batch_time=0.42518 
Train Epoch: 30 [321/500 20544/32000 (64%)] Loss: 0.92992 (QuantReg: 15.64663) QuantErr: 15.64663 batch_time=0.52875 
Train Epoch: 30 [329/500 21056/32000 (66%)] Loss: 1.34921 (QuantReg: 15.59627) QuantErr: 15.59627 batch_time=0.39515 
Train Epoch: 30 [337/500 21568/32000 (67%)] Loss: 0.91887 (QuantReg: 15.79360) QuantErr: 15.79360 batch_time=0.37094 
Train Epoch: 30 [345/500 22080/32000 (69%)] Loss: 1.29443 (QuantReg: 15.92337) QuantErr: 15.92337 batch_time=0.38077 
Train Epoch: 30 [353/500 22592/32000 (71%)] Loss: 1.29746 (QuantReg: 15.79552) QuantErr: 15.79552 batch_time=0.37976 
Train Epoch: 30 [361/500 23104/32000 (72%)] Loss: 0.99825 (QuantReg: 15.85020) QuantErr: 15.85020 batch_time=0.40642 
Train Epoch: 30 [369/500 23616/32000 (74%)] Loss: 1.53224 (QuantReg: 15.88332) QuantErr: 15.88332 batch_time=0.41892 
Train Epoch: 30 [377/500 24128/32000 (75%)] Loss: 0.94042 (QuantReg: 15.82533) QuantErr: 15.82533 batch_time=0.43239 
Train Epoch: 30 [385/500 24640/32000 (77%)] Loss: 0.72534 (QuantReg: 15.99862) QuantErr: 15.99862 batch_time=0.54269 
Train Epoch: 30 [393/500 25152/32000 (79%)] Loss: 1.01601 (QuantReg: 15.75216) QuantErr: 15.75216 batch_time=0.37405 
Train Epoch: 30 [401/500 25664/32000 (80%)] Loss: 1.19751 (QuantReg: 15.89251) QuantErr: 15.89251 batch_time=0.37717 
Train Epoch: 30 [409/500 26176/32000 (82%)] Loss: 1.19875 (QuantReg: 15.64127) QuantErr: 15.64127 batch_time=0.37814 
Train Epoch: 30 [417/500 26688/32000 (83%)] Loss: 0.97082 (QuantReg: 15.75165) QuantErr: 15.75165 batch_time=0.41181 
Train Epoch: 30 [425/500 27200/32000 (85%)] Loss: 1.40165 (QuantReg: 15.59741) QuantErr: 15.59741 batch_time=0.41964 
Train Epoch: 30 [433/500 27712/32000 (87%)] Loss: 1.16120 (QuantReg: 15.80918) QuantErr: 15.80918 batch_time=0.37974 
Train Epoch: 30 [441/500 28224/32000 (88%)] Loss: 1.06369 (QuantReg: 15.94145) QuantErr: 15.94145 batch_time=0.42484 
Train Epoch: 30 [449/500 28736/32000 (90%)] Loss: 1.47304 (QuantReg: 15.42339) QuantErr: 15.42339 batch_time=0.58882 
Train Epoch: 30 [457/500 29248/32000 (91%)] Loss: 1.18731 (QuantReg: 15.79826) QuantErr: 15.79826 batch_time=0.37589 
Train Epoch: 30 [465/500 29760/32000 (93%)] Loss: 1.11329 (QuantReg: 15.74525) QuantErr: 15.74525 batch_time=0.37831 
Train Epoch: 30 [473/500 30272/32000 (95%)] Loss: 0.97105 (QuantReg: 15.57629) QuantErr: 15.57629 batch_time=0.36974 
Train Epoch: 30 [481/500 30784/32000 (96%)] Loss: 0.98655 (QuantReg: 15.69576) QuantErr: 15.69576 batch_time=0.38316 
Train Epoch: 30 [489/500 31296/32000 (98%)] Loss: 1.42177 (QuantReg: 15.91808) QuantErr: 15.91808 batch_time=0.37961 
Train Epoch: 30 [497/500 31808/32000 (99%)] Loss: 0.83649 (QuantReg: 15.55296) QuantErr: 15.55296 batch_time=0.37990 
Train Epoch: 30 codebook_update_time=1.76624
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch30.pth ...
Done in 4.216s
removing stale ckpt [epoch 29] [took 0.01s]
 epoch          : 30
 loss           : 1.166629998922348
 quant_reg      : 15.752254373550414
 quant_err      : 15.752254373550414
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 15000
 LSMDC_full_test/t2v_metrics/R1: 12.8
 LSMDC_full_test/t2v_metrics/R5: 30.2
 LSMDC_full_test/t2v_metrics/R10: 41.2
 LSMDC_full_test/t2v_metrics/R50: 67.3
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 76.897
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.159656620048324
 LSMDC_full_test/v2t_metrics/R1: 11.0
 LSMDC_full_test/v2t_metrics/R5: 29.1
 LSMDC_full_test/v2t_metrics/R10: 40.9
 LSMDC_full_test/v2t_metrics/R50: 66.5
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.334
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.568737932418003
 mnt_best       : 25.87799246587303
 not_improved_count: 4
Train Epoch: 31 [1/500 64/32000 (0%)] Loss: 1.12629 (QuantReg: 15.64239) QuantErr: 15.64239 batch_time=17.28390 
Train Epoch: 31 [9/500 576/32000 (2%)] Loss: 1.17764 (QuantReg: 15.77954) QuantErr: 15.77954 batch_time=0.39124 
Train Epoch: 31 [17/500 1088/32000 (3%)] Loss: 1.25783 (QuantReg: 15.65045) QuantErr: 15.65045 batch_time=0.38067 
Train Epoch: 31 [25/500 1600/32000 (5%)] Loss: 1.10661 (QuantReg: 15.69345) QuantErr: 15.69345 batch_time=0.49696 
Train Epoch: 31 [33/500 2112/32000 (7%)] Loss: 1.37916 (QuantReg: 15.85117) QuantErr: 15.85117 batch_time=0.38180 
Train Epoch: 31 [41/500 2624/32000 (8%)] Loss: 1.63214 (QuantReg: 15.69664) QuantErr: 15.69664 batch_time=0.38398 
Train Epoch: 31 [49/500 3136/32000 (10%)] Loss: 1.87631 (QuantReg: 15.69974) QuantErr: 15.69974 batch_time=0.40486 
Train Epoch: 31 [57/500 3648/32000 (11%)] Loss: 1.42418 (QuantReg: 15.59562) QuantErr: 15.59562 batch_time=0.57050 
Train Epoch: 31 [65/500 4160/32000 (13%)] Loss: 1.05483 (QuantReg: 15.49888) QuantErr: 15.49888 batch_time=0.38393 
Train Epoch: 31 [73/500 4672/32000 (15%)] Loss: 1.00155 (QuantReg: 15.75221) QuantErr: 15.75221 batch_time=0.38331 
Train Epoch: 31 [81/500 5184/32000 (16%)] Loss: 1.47124 (QuantReg: 15.46274) QuantErr: 15.46274 batch_time=0.38422 
Train Epoch: 31 [89/500 5696/32000 (18%)] Loss: 0.97270 (QuantReg: 15.66151) QuantErr: 15.66151 batch_time=0.47938 
Train Epoch: 31 [97/500 6208/32000 (19%)] Loss: 0.98838 (QuantReg: 15.74245) QuantErr: 15.74245 batch_time=0.38390 
Train Epoch: 31 [105/500 6720/32000 (21%)] Loss: 1.13260 (QuantReg: 15.65845) QuantErr: 15.65845 batch_time=0.38641 
Train Epoch: 31 [113/500 7232/32000 (23%)] Loss: 1.28228 (QuantReg: 15.82552) QuantErr: 15.82552 batch_time=0.39636 
Train Epoch: 31 [121/500 7744/32000 (24%)] Loss: 1.31283 (QuantReg: 15.82115) QuantErr: 15.82115 batch_time=0.61311 
Train Epoch: 31 [129/500 8256/32000 (26%)] Loss: 0.90946 (QuantReg: 15.62553) QuantErr: 15.62553 batch_time=0.39736 
Train Epoch: 31 [137/500 8768/32000 (27%)] Loss: 1.28548 (QuantReg: 15.91857) QuantErr: 15.91857 batch_time=0.38033 
Train Epoch: 31 [145/500 9280/32000 (29%)] Loss: 1.11686 (QuantReg: 15.68797) QuantErr: 15.68797 batch_time=0.38442 
Train Epoch: 31 [153/500 9792/32000 (31%)] Loss: 1.04332 (QuantReg: 15.76930) QuantErr: 15.76930 batch_time=0.53963 
Train Epoch: 31 [161/500 10304/32000 (32%)] Loss: 0.93487 (QuantReg: 15.81177) QuantErr: 15.81177 batch_time=0.38457 
Train Epoch: 31 [169/500 10816/32000 (34%)] Loss: 1.11243 (QuantReg: 15.65730) QuantErr: 15.65730 batch_time=0.38888 
Train Epoch: 31 [177/500 11328/32000 (35%)] Loss: 1.14460 (QuantReg: 15.68094) QuantErr: 15.68094 batch_time=0.38250 
Train Epoch: 31 [185/500 11840/32000 (37%)] Loss: 1.18919 (QuantReg: 15.63226) QuantErr: 15.63226 batch_time=0.53970 
Train Epoch: 31 [193/500 12352/32000 (39%)] Loss: 1.06929 (QuantReg: 15.72800) QuantErr: 15.72800 batch_time=0.39303 
Train Epoch: 31 [201/500 12864/32000 (40%)] Loss: 1.44635 (QuantReg: 15.61889) QuantErr: 15.61889 batch_time=0.38591 
Train Epoch: 31 [209/500 13376/32000 (42%)] Loss: 1.23274 (QuantReg: 15.71926) QuantErr: 15.71926 batch_time=0.38295 
Train Epoch: 31 [217/500 13888/32000 (43%)] Loss: 1.27121 (QuantReg: 15.83139) QuantErr: 15.83139 batch_time=0.51409 
Train Epoch: 31 [225/500 14400/32000 (45%)] Loss: 0.75861 (QuantReg: 15.60180) QuantErr: 15.60180 batch_time=0.38144 
Train Epoch: 31 [233/500 14912/32000 (47%)] Loss: 1.36782 (QuantReg: 16.05780) QuantErr: 16.05780 batch_time=0.37682 
Train Epoch: 31 [241/500 15424/32000 (48%)] Loss: 1.08162 (QuantReg: 15.63773) QuantErr: 15.63773 batch_time=0.38172 
Train Epoch: 31 [249/500 15936/32000 (50%)] Loss: 1.26684 (QuantReg: 15.56571) QuantErr: 15.56571 batch_time=0.52923 
Train Epoch: 31 [257/500 16448/32000 (51%)] Loss: 1.07554 (QuantReg: 15.68062) QuantErr: 15.68062 batch_time=0.38619 
Train Epoch: 31 [265/500 16960/32000 (53%)] Loss: 1.17698 (QuantReg: 15.73232) QuantErr: 15.73232 batch_time=0.38687 
Train Epoch: 31 [273/500 17472/32000 (55%)] Loss: 1.18963 (QuantReg: 15.65999) QuantErr: 15.65999 batch_time=0.42364 
Train Epoch: 31 [281/500 17984/32000 (56%)] Loss: 1.12253 (QuantReg: 16.12339) QuantErr: 16.12339 batch_time=0.49055 
Train Epoch: 31 [289/500 18496/32000 (58%)] Loss: 1.03609 (QuantReg: 15.73221) QuantErr: 15.73221 batch_time=0.42904 
Train Epoch: 31 [297/500 19008/32000 (59%)] Loss: 1.24782 (QuantReg: 15.94780) QuantErr: 15.94780 batch_time=0.38113 
Train Epoch: 31 [305/500 19520/32000 (61%)] Loss: 1.20251 (QuantReg: 15.75667) QuantErr: 15.75667 batch_time=0.38332 
Train Epoch: 31 [313/500 20032/32000 (63%)] Loss: 1.12584 (QuantReg: 15.76861) QuantErr: 15.76861 batch_time=0.53474 
Train Epoch: 31 [321/500 20544/32000 (64%)] Loss: 0.93210 (QuantReg: 16.04481) QuantErr: 16.04481 batch_time=0.38379 
Train Epoch: 31 [329/500 21056/32000 (66%)] Loss: 1.38072 (QuantReg: 16.00538) QuantErr: 16.00538 batch_time=0.38646 
Train Epoch: 31 [337/500 21568/32000 (67%)] Loss: 1.06416 (QuantReg: 15.61900) QuantErr: 15.61900 batch_time=0.38280 
Train Epoch: 31 [345/500 22080/32000 (69%)] Loss: 1.11771 (QuantReg: 15.94668) QuantErr: 15.94668 batch_time=0.49002 
Train Epoch: 31 [353/500 22592/32000 (71%)] Loss: 0.96315 (QuantReg: 16.08319) QuantErr: 16.08319 batch_time=0.41148 
Train Epoch: 31 [361/500 23104/32000 (72%)] Loss: 1.05789 (QuantReg: 15.75565) QuantErr: 15.75565 batch_time=0.37884 
Train Epoch: 31 [369/500 23616/32000 (74%)] Loss: 0.99983 (QuantReg: 15.93933) QuantErr: 15.93933 batch_time=0.38160 
Train Epoch: 31 [377/500 24128/32000 (75%)] Loss: 1.21324 (QuantReg: 15.74974) QuantErr: 15.74974 batch_time=0.54597 
Train Epoch: 31 [385/500 24640/32000 (77%)] Loss: 1.10877 (QuantReg: 15.77833) QuantErr: 15.77833 batch_time=0.38924 
Train Epoch: 31 [393/500 25152/32000 (79%)] Loss: 0.99761 (QuantReg: 15.79166) QuantErr: 15.79166 batch_time=0.39752 
Train Epoch: 31 [401/500 25664/32000 (80%)] Loss: 1.20149 (QuantReg: 15.73366) QuantErr: 15.73366 batch_time=0.37736 
Train Epoch: 31 [409/500 26176/32000 (82%)] Loss: 1.31397 (QuantReg: 15.88565) QuantErr: 15.88565 batch_time=0.48149 
Train Epoch: 31 [417/500 26688/32000 (83%)] Loss: 1.17382 (QuantReg: 16.10334) QuantErr: 16.10334 batch_time=0.42231 
Train Epoch: 31 [425/500 27200/32000 (85%)] Loss: 1.07486 (QuantReg: 15.95118) QuantErr: 15.95118 batch_time=0.39422 
Train Epoch: 31 [433/500 27712/32000 (87%)] Loss: 1.22178 (QuantReg: 15.83889) QuantErr: 15.83889 batch_time=0.42899 
Train Epoch: 31 [441/500 28224/32000 (88%)] Loss: 1.00963 (QuantReg: 15.94921) QuantErr: 15.94921 batch_time=0.56061 
Train Epoch: 31 [449/500 28736/32000 (90%)] Loss: 1.25558 (QuantReg: 15.71716) QuantErr: 15.71716 batch_time=0.38568 
Train Epoch: 31 [457/500 29248/32000 (91%)] Loss: 1.27644 (QuantReg: 15.68814) QuantErr: 15.68814 batch_time=0.42357 
Train Epoch: 31 [465/500 29760/32000 (93%)] Loss: 1.07324 (QuantReg: 15.56734) QuantErr: 15.56734 batch_time=0.38537 
Train Epoch: 31 [473/500 30272/32000 (95%)] Loss: 1.09185 (QuantReg: 15.70061) QuantErr: 15.70061 batch_time=0.50239 
Train Epoch: 31 [481/500 30784/32000 (96%)] Loss: 1.01632 (QuantReg: 15.77638) QuantErr: 15.77638 batch_time=0.38016 
Train Epoch: 31 [489/500 31296/32000 (98%)] Loss: 1.36636 (QuantReg: 15.90667) QuantErr: 15.90667 batch_time=0.38367 
Train Epoch: 31 [497/500 31808/32000 (99%)] Loss: 1.02392 (QuantReg: 15.63202) QuantErr: 15.63202 batch_time=0.38954 
Train Epoch: 31 codebook_update_time=1.99325
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch31.pth ...
Done in 4.698s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 31
 loss           : 1.1444560694694519
 quant_reg      : 15.762553007125854
 quant_err      : 15.762553007125854
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 15500
 LSMDC_full_test/t2v_metrics/R1: 12.4
 LSMDC_full_test/t2v_metrics/R5: 30.6
 LSMDC_full_test/t2v_metrics/R10: 42.2
 LSMDC_full_test/t2v_metrics/R50: 66.0
 LSMDC_full_test/t2v_metrics/MedR: 17.5
 LSMDC_full_test/t2v_metrics/MeanR: 75.767
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.204912118782975
 LSMDC_full_test/v2t_metrics/R1: 13.2
 LSMDC_full_test/v2t_metrics/R5: 31.1
 LSMDC_full_test/v2t_metrics/R10: 40.7
 LSMDC_full_test/v2t_metrics/R50: 66.7
 LSMDC_full_test/v2t_metrics/MedR: 19.5
 LSMDC_full_test/v2t_metrics/MeanR: 72.497
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.56483004129343
 mnt_best       : 25.87799246587303
 not_improved_count: 5
Train Epoch: 32 [1/500 64/32000 (0%)] Loss: 1.25144 (QuantReg: 15.80466) QuantErr: 15.80466 batch_time=17.75493 
Train Epoch: 32 [9/500 576/32000 (2%)] Loss: 1.12308 (QuantReg: 15.56558) QuantErr: 15.56558 batch_time=0.37230 
Train Epoch: 32 [17/500 1088/32000 (3%)] Loss: 1.12469 (QuantReg: 15.96705) QuantErr: 15.96705 batch_time=2.93739 
Train Epoch: 32 [25/500 1600/32000 (5%)] Loss: 1.15592 (QuantReg: 15.86328) QuantErr: 15.86328 batch_time=0.37201 
Train Epoch: 32 [33/500 2112/32000 (7%)] Loss: 1.29911 (QuantReg: 15.64559) QuantErr: 15.64559 batch_time=0.38123 
Train Epoch: 32 [41/500 2624/32000 (8%)] Loss: 1.00035 (QuantReg: 15.52849) QuantErr: 15.52849 batch_time=0.37448 
Train Epoch: 32 [49/500 3136/32000 (10%)] Loss: 1.35859 (QuantReg: 15.97820) QuantErr: 15.97820 batch_time=0.39278 
Train Epoch: 32 [57/500 3648/32000 (11%)] Loss: 0.86792 (QuantReg: 15.80376) QuantErr: 15.80376 batch_time=0.41185 
Train Epoch: 32 [65/500 4160/32000 (13%)] Loss: 1.36011 (QuantReg: 15.82126) QuantErr: 15.82126 batch_time=0.38249 
Train Epoch: 32 [73/500 4672/32000 (15%)] Loss: 0.95448 (QuantReg: 15.62590) QuantErr: 15.62590 batch_time=0.38616 
Train Epoch: 32 [81/500 5184/32000 (16%)] Loss: 1.17023 (QuantReg: 15.70961) QuantErr: 15.70961 batch_time=1.79066 
Train Epoch: 32 [89/500 5696/32000 (18%)] Loss: 1.37475 (QuantReg: 15.69212) QuantErr: 15.69212 batch_time=0.39170 
Train Epoch: 32 [97/500 6208/32000 (19%)] Loss: 1.07629 (QuantReg: 15.88820) QuantErr: 15.88820 batch_time=0.38294 
Train Epoch: 32 [105/500 6720/32000 (21%)] Loss: 0.85236 (QuantReg: 15.68988) QuantErr: 15.68988 batch_time=0.38254 
Train Epoch: 32 [113/500 7232/32000 (23%)] Loss: 1.01409 (QuantReg: 15.65743) QuantErr: 15.65743 batch_time=0.39034 
Train Epoch: 32 [121/500 7744/32000 (24%)] Loss: 0.85147 (QuantReg: 16.03897) QuantErr: 16.03897 batch_time=0.40183 
Train Epoch: 32 [129/500 8256/32000 (26%)] Loss: 1.02371 (QuantReg: 15.75653) QuantErr: 15.75653 batch_time=0.37992 
Train Epoch: 32 [137/500 8768/32000 (27%)] Loss: 0.99111 (QuantReg: 15.61774) QuantErr: 15.61774 batch_time=0.39250 
Train Epoch: 32 [145/500 9280/32000 (29%)] Loss: 0.98029 (QuantReg: 15.69687) QuantErr: 15.69687 batch_time=1.79929 
Train Epoch: 32 [153/500 9792/32000 (31%)] Loss: 1.03750 (QuantReg: 15.86062) QuantErr: 15.86062 batch_time=0.38864 
Train Epoch: 32 [161/500 10304/32000 (32%)] Loss: 1.20345 (QuantReg: 15.74404) QuantErr: 15.74404 batch_time=0.37938 
Train Epoch: 32 [169/500 10816/32000 (34%)] Loss: 1.11421 (QuantReg: 15.90224) QuantErr: 15.90224 batch_time=0.39519 
Train Epoch: 32 [177/500 11328/32000 (35%)] Loss: 1.37534 (QuantReg: 15.80012) QuantErr: 15.80012 batch_time=0.36977 
Train Epoch: 32 [185/500 11840/32000 (37%)] Loss: 1.17242 (QuantReg: 15.69768) QuantErr: 15.69768 batch_time=0.41529 
Train Epoch: 32 [193/500 12352/32000 (39%)] Loss: 1.08654 (QuantReg: 15.70597) QuantErr: 15.70597 batch_time=0.38300 
Train Epoch: 32 [201/500 12864/32000 (40%)] Loss: 1.41231 (QuantReg: 15.71916) QuantErr: 15.71916 batch_time=0.38329 
Train Epoch: 32 [209/500 13376/32000 (42%)] Loss: 1.01118 (QuantReg: 15.82417) QuantErr: 15.82417 batch_time=2.13793 
Train Epoch: 32 [217/500 13888/32000 (43%)] Loss: 0.96051 (QuantReg: 15.71122) QuantErr: 15.71122 batch_time=0.37666 
Train Epoch: 32 [225/500 14400/32000 (45%)] Loss: 1.44751 (QuantReg: 15.92730) QuantErr: 15.92730 batch_time=0.39352 
Train Epoch: 32 [233/500 14912/32000 (47%)] Loss: 0.83811 (QuantReg: 15.91838) QuantErr: 15.91838 batch_time=0.37773 
Train Epoch: 32 [241/500 15424/32000 (48%)] Loss: 1.09550 (QuantReg: 15.85999) QuantErr: 15.85999 batch_time=0.37413 
Train Epoch: 32 [249/500 15936/32000 (50%)] Loss: 1.13478 (QuantReg: 15.85885) QuantErr: 15.85885 batch_time=0.37773 
Train Epoch: 32 [257/500 16448/32000 (51%)] Loss: 1.23756 (QuantReg: 15.55808) QuantErr: 15.55808 batch_time=0.38907 
Train Epoch: 32 [265/500 16960/32000 (53%)] Loss: 1.22131 (QuantReg: 15.79418) QuantErr: 15.79418 batch_time=0.39442 
Train Epoch: 32 [273/500 17472/32000 (55%)] Loss: 1.27575 (QuantReg: 15.90794) QuantErr: 15.90794 batch_time=1.90571 
Train Epoch: 32 [281/500 17984/32000 (56%)] Loss: 0.89892 (QuantReg: 15.80589) QuantErr: 15.80589 batch_time=0.39500 
Train Epoch: 32 [289/500 18496/32000 (58%)] Loss: 0.93876 (QuantReg: 15.85284) QuantErr: 15.85284 batch_time=0.37437 
Train Epoch: 32 [297/500 19008/32000 (59%)] Loss: 1.21180 (QuantReg: 15.89789) QuantErr: 15.89789 batch_time=0.41441 
Train Epoch: 32 [305/500 19520/32000 (61%)] Loss: 1.25860 (QuantReg: 15.55280) QuantErr: 15.55280 batch_time=0.45001 
Train Epoch: 32 [313/500 20032/32000 (63%)] Loss: 1.52649 (QuantReg: 15.93747) QuantErr: 15.93747 batch_time=0.37176 
Train Epoch: 32 [321/500 20544/32000 (64%)] Loss: 1.41012 (QuantReg: 15.86243) QuantErr: 15.86243 batch_time=0.40340 
Train Epoch: 32 [329/500 21056/32000 (66%)] Loss: 1.02218 (QuantReg: 16.04314) QuantErr: 16.04314 batch_time=0.39415 
Train Epoch: 32 [337/500 21568/32000 (67%)] Loss: 1.00467 (QuantReg: 15.83707) QuantErr: 15.83707 batch_time=1.91000 
Train Epoch: 32 [345/500 22080/32000 (69%)] Loss: 0.94480 (QuantReg: 16.12857) QuantErr: 16.12857 batch_time=0.37095 
Train Epoch: 32 [353/500 22592/32000 (71%)] Loss: 0.89481 (QuantReg: 15.99751) QuantErr: 15.99751 batch_time=0.37617 
Train Epoch: 32 [361/500 23104/32000 (72%)] Loss: 1.00062 (QuantReg: 15.67578) QuantErr: 15.67578 batch_time=0.38106 
Train Epoch: 32 [369/500 23616/32000 (74%)] Loss: 1.03644 (QuantReg: 15.77667) QuantErr: 15.77667 batch_time=0.39496 
Train Epoch: 32 [377/500 24128/32000 (75%)] Loss: 1.10837 (QuantReg: 15.89742) QuantErr: 15.89742 batch_time=0.37704 
Train Epoch: 32 [385/500 24640/32000 (77%)] Loss: 1.26334 (QuantReg: 15.74167) QuantErr: 15.74167 batch_time=0.37972 
Train Epoch: 32 [393/500 25152/32000 (79%)] Loss: 1.26536 (QuantReg: 15.96445) QuantErr: 15.96445 batch_time=0.38809 
Train Epoch: 32 [401/500 25664/32000 (80%)] Loss: 1.12397 (QuantReg: 15.68296) QuantErr: 15.68296 batch_time=1.84809 
Train Epoch: 32 [409/500 26176/32000 (82%)] Loss: 0.80033 (QuantReg: 15.71068) QuantErr: 15.71068 batch_time=0.37237 
Train Epoch: 32 [417/500 26688/32000 (83%)] Loss: 0.87680 (QuantReg: 15.78675) QuantErr: 15.78675 batch_time=0.37014 
Train Epoch: 32 [425/500 27200/32000 (85%)] Loss: 1.35110 (QuantReg: 15.84248) QuantErr: 15.84248 batch_time=0.36944 
Train Epoch: 32 [433/500 27712/32000 (87%)] Loss: 1.18808 (QuantReg: 15.92708) QuantErr: 15.92708 batch_time=0.47034 
Train Epoch: 32 [441/500 28224/32000 (88%)] Loss: 1.44070 (QuantReg: 15.80283) QuantErr: 15.80283 batch_time=0.38414 
Train Epoch: 32 [449/500 28736/32000 (90%)] Loss: 1.01494 (QuantReg: 15.76903) QuantErr: 15.76903 batch_time=0.37157 
Train Epoch: 32 [457/500 29248/32000 (91%)] Loss: 1.35126 (QuantReg: 15.91320) QuantErr: 15.91320 batch_time=0.40077 
Train Epoch: 32 [465/500 29760/32000 (93%)] Loss: 1.13268 (QuantReg: 15.80183) QuantErr: 15.80183 batch_time=1.82814 
Train Epoch: 32 [473/500 30272/32000 (95%)] Loss: 1.04481 (QuantReg: 15.67057) QuantErr: 15.67057 batch_time=0.37844 
Train Epoch: 32 [481/500 30784/32000 (96%)] Loss: 1.04205 (QuantReg: 15.72990) QuantErr: 15.72990 batch_time=0.41179 
Train Epoch: 32 [489/500 31296/32000 (98%)] Loss: 1.09533 (QuantReg: 15.99892) QuantErr: 15.99892 batch_time=0.38336 
Train Epoch: 32 [497/500 31808/32000 (99%)] Loss: 1.16507 (QuantReg: 16.18777) QuantErr: 16.18777 batch_time=0.38618 
Train Epoch: 32 codebook_update_time=2.04697
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch32.pth ...
Done in 4.061s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch32.pth ...
Done in 8.988s
removing stale ckpt [epoch 31] [took 0.04s]
 epoch          : 32
 loss           : 1.1194559746980668
 quant_reg      : 15.793070749282837
 quant_err      : 15.793070749282837
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 16000
 LSMDC_full_test/t2v_metrics/R1: 13.4
 LSMDC_full_test/t2v_metrics/R5: 31.9
 LSMDC_full_test/t2v_metrics/R10: 41.0
 LSMDC_full_test/t2v_metrics/R50: 66.2
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.978
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.975252586423483
 LSMDC_full_test/v2t_metrics/R1: 13.4
 LSMDC_full_test/v2t_metrics/R5: 31.5
 LSMDC_full_test/v2t_metrics/R10: 40.0
 LSMDC_full_test/v2t_metrics/R50: 66.2
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.14
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.6541983255931
 mnt_best       : 25.975252586423483
 not_improved_count: 0
Train Epoch: 33 [1/500 64/32000 (0%)] Loss: 1.33000 (QuantReg: 15.80677) QuantErr: 15.80677 batch_time=17.68866 
Train Epoch: 33 [9/500 576/32000 (2%)] Loss: 1.11813 (QuantReg: 15.66925) QuantErr: 15.66925 batch_time=0.37552 
Train Epoch: 33 [17/500 1088/32000 (3%)] Loss: 1.07296 (QuantReg: 15.91247) QuantErr: 15.91247 batch_time=0.39315 
Train Epoch: 33 [25/500 1600/32000 (5%)] Loss: 1.23772 (QuantReg: 15.79450) QuantErr: 15.79450 batch_time=0.37651 
Train Epoch: 33 [33/500 2112/32000 (7%)] Loss: 1.33976 (QuantReg: 15.87427) QuantErr: 15.87427 batch_time=0.37579 
Train Epoch: 33 [41/500 2624/32000 (8%)] Loss: 1.22699 (QuantReg: 15.74762) QuantErr: 15.74762 batch_time=0.37811 
Train Epoch: 33 [49/500 3136/32000 (10%)] Loss: 0.90100 (QuantReg: 15.99942) QuantErr: 15.99942 batch_time=0.37721 
Train Epoch: 33 [57/500 3648/32000 (11%)] Loss: 1.37825 (QuantReg: 15.89386) QuantErr: 15.89386 batch_time=0.37867 
Train Epoch: 33 [65/500 4160/32000 (13%)] Loss: 1.10819 (QuantReg: 15.72582) QuantErr: 15.72582 batch_time=1.20062 
Train Epoch: 33 [73/500 4672/32000 (15%)] Loss: 1.13997 (QuantReg: 15.65785) QuantErr: 15.65785 batch_time=0.37614 
Train Epoch: 33 [81/500 5184/32000 (16%)] Loss: 0.92683 (QuantReg: 15.78343) QuantErr: 15.78343 batch_time=0.37078 
Train Epoch: 33 [89/500 5696/32000 (18%)] Loss: 1.50180 (QuantReg: 15.71380) QuantErr: 15.71380 batch_time=0.37479 
Train Epoch: 33 [97/500 6208/32000 (19%)] Loss: 1.12358 (QuantReg: 15.61036) QuantErr: 15.61036 batch_time=0.38015 
Train Epoch: 33 [105/500 6720/32000 (21%)] Loss: 1.27165 (QuantReg: 16.01945) QuantErr: 16.01945 batch_time=0.38411 
Train Epoch: 33 [113/500 7232/32000 (23%)] Loss: 1.43362 (QuantReg: 15.60249) QuantErr: 15.60249 batch_time=0.39535 
Train Epoch: 33 [121/500 7744/32000 (24%)] Loss: 1.09963 (QuantReg: 15.78874) QuantErr: 15.78874 batch_time=0.38537 
Train Epoch: 33 [129/500 8256/32000 (26%)] Loss: 1.19887 (QuantReg: 15.40211) QuantErr: 15.40211 batch_time=1.16826 
Train Epoch: 33 [137/500 8768/32000 (27%)] Loss: 1.27471 (QuantReg: 15.79085) QuantErr: 15.79085 batch_time=0.38024 
Train Epoch: 33 [145/500 9280/32000 (29%)] Loss: 1.15674 (QuantReg: 15.63149) QuantErr: 15.63149 batch_time=0.38234 
Train Epoch: 33 [153/500 9792/32000 (31%)] Loss: 0.90110 (QuantReg: 15.70417) QuantErr: 15.70417 batch_time=0.37247 
Train Epoch: 33 [161/500 10304/32000 (32%)] Loss: 0.91316 (QuantReg: 15.76498) QuantErr: 15.76498 batch_time=0.44203 
Train Epoch: 33 [169/500 10816/32000 (34%)] Loss: 1.23394 (QuantReg: 15.65966) QuantErr: 15.65966 batch_time=0.38381 
Train Epoch: 33 [177/500 11328/32000 (35%)] Loss: 0.98929 (QuantReg: 15.98341) QuantErr: 15.98341 batch_time=0.39981 
Train Epoch: 33 [185/500 11840/32000 (37%)] Loss: 0.98924 (QuantReg: 15.83851) QuantErr: 15.83851 batch_time=0.40121 
Train Epoch: 33 [193/500 12352/32000 (39%)] Loss: 0.97421 (QuantReg: 15.78223) QuantErr: 15.78223 batch_time=1.23677 
Train Epoch: 33 [201/500 12864/32000 (40%)] Loss: 0.98803 (QuantReg: 15.94938) QuantErr: 15.94938 batch_time=0.38432 
Train Epoch: 33 [209/500 13376/32000 (42%)] Loss: 1.19735 (QuantReg: 15.64506) QuantErr: 15.64506 batch_time=0.38468 
Train Epoch: 33 [217/500 13888/32000 (43%)] Loss: 0.94665 (QuantReg: 15.83591) QuantErr: 15.83591 batch_time=0.38965 
Train Epoch: 33 [225/500 14400/32000 (45%)] Loss: 0.95809 (QuantReg: 15.76478) QuantErr: 15.76478 batch_time=0.41423 
Train Epoch: 33 [233/500 14912/32000 (47%)] Loss: 0.94903 (QuantReg: 15.72714) QuantErr: 15.72714 batch_time=0.38284 
Train Epoch: 33 [241/500 15424/32000 (48%)] Loss: 0.91195 (QuantReg: 15.85288) QuantErr: 15.85288 batch_time=0.40064 
Train Epoch: 33 [249/500 15936/32000 (50%)] Loss: 1.29303 (QuantReg: 15.72876) QuantErr: 15.72876 batch_time=0.38285 
Train Epoch: 33 [257/500 16448/32000 (51%)] Loss: 0.97156 (QuantReg: 16.00823) QuantErr: 16.00823 batch_time=1.20100 
Train Epoch: 33 [265/500 16960/32000 (53%)] Loss: 0.97454 (QuantReg: 15.62395) QuantErr: 15.62395 batch_time=0.38484 
Train Epoch: 33 [273/500 17472/32000 (55%)] Loss: 1.20289 (QuantReg: 15.84550) QuantErr: 15.84550 batch_time=0.38189 
Train Epoch: 33 [281/500 17984/32000 (56%)] Loss: 0.82508 (QuantReg: 15.65434) QuantErr: 15.65434 batch_time=0.38596 
Train Epoch: 33 [289/500 18496/32000 (58%)] Loss: 1.11909 (QuantReg: 15.70032) QuantErr: 15.70032 batch_time=0.40793 
Train Epoch: 33 [297/500 19008/32000 (59%)] Loss: 1.34440 (QuantReg: 15.75892) QuantErr: 15.75892 batch_time=0.38337 
Train Epoch: 33 [305/500 19520/32000 (61%)] Loss: 1.05053 (QuantReg: 15.84831) QuantErr: 15.84831 batch_time=0.40745 
Train Epoch: 33 [313/500 20032/32000 (63%)] Loss: 1.10972 (QuantReg: 15.77431) QuantErr: 15.77431 batch_time=0.39399 
Train Epoch: 33 [321/500 20544/32000 (64%)] Loss: 0.72136 (QuantReg: 15.89077) QuantErr: 15.89077 batch_time=1.20306 
Train Epoch: 33 [329/500 21056/32000 (66%)] Loss: 1.06049 (QuantReg: 15.81920) QuantErr: 15.81920 batch_time=0.40517 
Train Epoch: 33 [337/500 21568/32000 (67%)] Loss: 1.07235 (QuantReg: 15.94041) QuantErr: 15.94041 batch_time=0.37972 
Train Epoch: 33 [345/500 22080/32000 (69%)] Loss: 0.96741 (QuantReg: 15.78452) QuantErr: 15.78452 batch_time=0.37593 
Train Epoch: 33 [353/500 22592/32000 (71%)] Loss: 0.98940 (QuantReg: 15.90344) QuantErr: 15.90344 batch_time=0.37527 
Train Epoch: 33 [361/500 23104/32000 (72%)] Loss: 1.28244 (QuantReg: 15.85223) QuantErr: 15.85223 batch_time=0.39957 
Train Epoch: 33 [369/500 23616/32000 (74%)] Loss: 1.14253 (QuantReg: 16.02162) QuantErr: 16.02162 batch_time=0.38831 
Train Epoch: 33 [377/500 24128/32000 (75%)] Loss: 1.11386 (QuantReg: 15.79752) QuantErr: 15.79752 batch_time=0.38528 
Train Epoch: 33 [385/500 24640/32000 (77%)] Loss: 1.56427 (QuantReg: 15.43204) QuantErr: 15.43204 batch_time=1.24799 
Train Epoch: 33 [393/500 25152/32000 (79%)] Loss: 1.24881 (QuantReg: 15.93975) QuantErr: 15.93975 batch_time=0.41911 
Train Epoch: 33 [401/500 25664/32000 (80%)] Loss: 0.89506 (QuantReg: 15.77387) QuantErr: 15.77387 batch_time=0.42254 
Train Epoch: 33 [409/500 26176/32000 (82%)] Loss: 0.98882 (QuantReg: 15.72215) QuantErr: 15.72215 batch_time=0.41314 
Train Epoch: 33 [417/500 26688/32000 (83%)] Loss: 1.14756 (QuantReg: 15.66416) QuantErr: 15.66416 batch_time=0.41732 
Train Epoch: 33 [425/500 27200/32000 (85%)] Loss: 1.47215 (QuantReg: 15.99614) QuantErr: 15.99614 batch_time=0.37701 
Train Epoch: 33 [433/500 27712/32000 (87%)] Loss: 0.90504 (QuantReg: 15.88496) QuantErr: 15.88496 batch_time=0.40211 
Train Epoch: 33 [441/500 28224/32000 (88%)] Loss: 0.96309 (QuantReg: 15.61655) QuantErr: 15.61655 batch_time=0.38868 
Train Epoch: 33 [449/500 28736/32000 (90%)] Loss: 1.07995 (QuantReg: 15.95353) QuantErr: 15.95353 batch_time=1.21529 
Train Epoch: 33 [457/500 29248/32000 (91%)] Loss: 1.13036 (QuantReg: 15.72182) QuantErr: 15.72182 batch_time=0.37763 
Train Epoch: 33 [465/500 29760/32000 (93%)] Loss: 1.38096 (QuantReg: 15.79000) QuantErr: 15.79000 batch_time=0.37526 
Train Epoch: 33 [473/500 30272/32000 (95%)] Loss: 1.21426 (QuantReg: 15.91937) QuantErr: 15.91937 batch_time=0.37890 
Train Epoch: 33 [481/500 30784/32000 (96%)] Loss: 1.41084 (QuantReg: 15.83889) QuantErr: 15.83889 batch_time=0.37094 
Train Epoch: 33 [489/500 31296/32000 (98%)] Loss: 1.01738 (QuantReg: 15.70627) QuantErr: 15.70627 batch_time=0.37263 
Train Epoch: 33 [497/500 31808/32000 (99%)] Loss: 1.52565 (QuantReg: 15.69422) QuantErr: 15.69422 batch_time=0.38400 
Train Epoch: 33 codebook_update_time=1.84352
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch33.pth ...
Done in 5.027s
removing stale ckpt [epoch 32] [took 0.14s]
 epoch          : 33
 loss           : 1.1065817369222641
 quant_reg      : 15.802096561431885
 quant_err      : 15.802096561431885
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 16500
 LSMDC_full_test/t2v_metrics/R1: 12.5
 LSMDC_full_test/t2v_metrics/R5: 31.5
 LSMDC_full_test/t2v_metrics/R10: 40.7
 LSMDC_full_test/t2v_metrics/R50: 66.7
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 76.406
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.21186610476683
 LSMDC_full_test/v2t_metrics/R1: 12.8
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 41.1
 LSMDC_full_test/v2t_metrics/R50: 66.6
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.845
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.46793971627653
 mnt_best       : 25.975252586423483
 not_improved_count: 1
Train Epoch: 34 [1/500 64/32000 (0%)] Loss: 0.87674 (QuantReg: 15.71409) QuantErr: 15.71409 batch_time=16.68191 
Train Epoch: 34 [9/500 576/32000 (2%)] Loss: 0.74371 (QuantReg: 15.96737) QuantErr: 15.96737 batch_time=0.38326 
Train Epoch: 34 [17/500 1088/32000 (3%)] Loss: 1.01501 (QuantReg: 15.76332) QuantErr: 15.76332 batch_time=0.37493 
Train Epoch: 34 [25/500 1600/32000 (5%)] Loss: 0.86905 (QuantReg: 15.88505) QuantErr: 15.88505 batch_time=0.93758 
Train Epoch: 34 [33/500 2112/32000 (7%)] Loss: 1.30903 (QuantReg: 15.95930) QuantErr: 15.95930 batch_time=0.37894 
Train Epoch: 34 [41/500 2624/32000 (8%)] Loss: 1.31031 (QuantReg: 15.81655) QuantErr: 15.81655 batch_time=0.38381 
Train Epoch: 34 [49/500 3136/32000 (10%)] Loss: 1.05567 (QuantReg: 16.00299) QuantErr: 16.00299 batch_time=0.40066 
Train Epoch: 34 [57/500 3648/32000 (11%)] Loss: 0.97803 (QuantReg: 15.82072) QuantErr: 15.82072 batch_time=0.38154 
Train Epoch: 34 [65/500 4160/32000 (13%)] Loss: 1.20352 (QuantReg: 15.24552) QuantErr: 15.24552 batch_time=0.51727 
Train Epoch: 34 [73/500 4672/32000 (15%)] Loss: 1.04843 (QuantReg: 15.97637) QuantErr: 15.97637 batch_time=0.38611 
Train Epoch: 34 [81/500 5184/32000 (16%)] Loss: 1.30809 (QuantReg: 15.85816) QuantErr: 15.85816 batch_time=0.43572 
Train Epoch: 34 [89/500 5696/32000 (18%)] Loss: 1.36820 (QuantReg: 15.92921) QuantErr: 15.92921 batch_time=0.79122 
Train Epoch: 34 [97/500 6208/32000 (19%)] Loss: 1.03941 (QuantReg: 15.71253) QuantErr: 15.71253 batch_time=0.37751 
Train Epoch: 34 [105/500 6720/32000 (21%)] Loss: 0.86178 (QuantReg: 15.71245) QuantErr: 15.71245 batch_time=0.44289 
Train Epoch: 34 [113/500 7232/32000 (23%)] Loss: 1.24382 (QuantReg: 15.80463) QuantErr: 15.80463 batch_time=0.40178 
Train Epoch: 34 [121/500 7744/32000 (24%)] Loss: 0.75775 (QuantReg: 16.09799) QuantErr: 16.09799 batch_time=0.38761 
Train Epoch: 34 [129/500 8256/32000 (26%)] Loss: 1.01842 (QuantReg: 16.02052) QuantErr: 16.02052 batch_time=0.51914 
Train Epoch: 34 [137/500 8768/32000 (27%)] Loss: 0.86002 (QuantReg: 15.79061) QuantErr: 15.79061 batch_time=0.38145 
Train Epoch: 34 [145/500 9280/32000 (29%)] Loss: 1.06902 (QuantReg: 15.85489) QuantErr: 15.85489 batch_time=0.38024 
Train Epoch: 34 [153/500 9792/32000 (31%)] Loss: 0.97373 (QuantReg: 15.65967) QuantErr: 15.65967 batch_time=0.82788 
Train Epoch: 34 [161/500 10304/32000 (32%)] Loss: 1.07606 (QuantReg: 15.77972) QuantErr: 15.77972 batch_time=0.38256 
Train Epoch: 34 [169/500 10816/32000 (34%)] Loss: 1.10547 (QuantReg: 15.75904) QuantErr: 15.75904 batch_time=0.37594 
Train Epoch: 34 [177/500 11328/32000 (35%)] Loss: 1.03720 (QuantReg: 15.80982) QuantErr: 15.80982 batch_time=0.40496 
Train Epoch: 34 [185/500 11840/32000 (37%)] Loss: 1.32504 (QuantReg: 16.09298) QuantErr: 16.09298 batch_time=0.42267 
Train Epoch: 34 [193/500 12352/32000 (39%)] Loss: 0.96210 (QuantReg: 15.72376) QuantErr: 15.72376 batch_time=0.48076 
Train Epoch: 34 [201/500 12864/32000 (40%)] Loss: 1.06140 (QuantReg: 15.79487) QuantErr: 15.79487 batch_time=0.37716 
Train Epoch: 34 [209/500 13376/32000 (42%)] Loss: 1.10159 (QuantReg: 15.73244) QuantErr: 15.73244 batch_time=0.38716 
Train Epoch: 34 [217/500 13888/32000 (43%)] Loss: 1.11046 (QuantReg: 15.83282) QuantErr: 15.83282 batch_time=0.81541 
Train Epoch: 34 [225/500 14400/32000 (45%)] Loss: 1.23956 (QuantReg: 15.77452) QuantErr: 15.77452 batch_time=0.38173 
Train Epoch: 34 [233/500 14912/32000 (47%)] Loss: 1.38309 (QuantReg: 15.54003) QuantErr: 15.54003 batch_time=0.40779 
Train Epoch: 34 [241/500 15424/32000 (48%)] Loss: 1.08113 (QuantReg: 15.45291) QuantErr: 15.45291 batch_time=0.38579 
Train Epoch: 34 [249/500 15936/32000 (50%)] Loss: 1.35858 (QuantReg: 15.62400) QuantErr: 15.62400 batch_time=0.38417 
Train Epoch: 34 [257/500 16448/32000 (51%)] Loss: 1.31122 (QuantReg: 15.56844) QuantErr: 15.56844 batch_time=0.49698 
Train Epoch: 34 [265/500 16960/32000 (53%)] Loss: 1.07883 (QuantReg: 15.77272) QuantErr: 15.77272 batch_time=0.39444 
Train Epoch: 34 [273/500 17472/32000 (55%)] Loss: 1.05706 (QuantReg: 15.78145) QuantErr: 15.78145 batch_time=0.38570 
Train Epoch: 34 [281/500 17984/32000 (56%)] Loss: 0.86040 (QuantReg: 15.91608) QuantErr: 15.91608 batch_time=0.86108 
Train Epoch: 34 [289/500 18496/32000 (58%)] Loss: 1.14556 (QuantReg: 15.62693) QuantErr: 15.62693 batch_time=0.38265 
Train Epoch: 34 [297/500 19008/32000 (59%)] Loss: 0.95999 (QuantReg: 15.68585) QuantErr: 15.68585 batch_time=0.38471 
Train Epoch: 34 [305/500 19520/32000 (61%)] Loss: 0.99036 (QuantReg: 16.00447) QuantErr: 16.00447 batch_time=0.38318 
Train Epoch: 34 [313/500 20032/32000 (63%)] Loss: 1.16963 (QuantReg: 15.69362) QuantErr: 15.69362 batch_time=0.39780 
Train Epoch: 34 [321/500 20544/32000 (64%)] Loss: 1.07083 (QuantReg: 15.89411) QuantErr: 15.89411 batch_time=0.48735 
Train Epoch: 34 [329/500 21056/32000 (66%)] Loss: 1.44844 (QuantReg: 15.87448) QuantErr: 15.87448 batch_time=0.38487 
Train Epoch: 34 [337/500 21568/32000 (67%)] Loss: 0.99240 (QuantReg: 15.57875) QuantErr: 15.57875 batch_time=0.39445 
Train Epoch: 34 [345/500 22080/32000 (69%)] Loss: 1.16040 (QuantReg: 15.96039) QuantErr: 15.96039 batch_time=0.82682 
Train Epoch: 34 [353/500 22592/32000 (71%)] Loss: 1.13232 (QuantReg: 15.85704) QuantErr: 15.85704 batch_time=0.38287 
Train Epoch: 34 [361/500 23104/32000 (72%)] Loss: 1.03606 (QuantReg: 15.98613) QuantErr: 15.98613 batch_time=0.38527 
Train Epoch: 34 [369/500 23616/32000 (74%)] Loss: 0.95996 (QuantReg: 15.93920) QuantErr: 15.93920 batch_time=0.39663 
Train Epoch: 34 [377/500 24128/32000 (75%)] Loss: 1.27558 (QuantReg: 16.02998) QuantErr: 16.02998 batch_time=0.40112 
Train Epoch: 34 [385/500 24640/32000 (77%)] Loss: 0.78826 (QuantReg: 15.74264) QuantErr: 15.74264 batch_time=0.48834 
Train Epoch: 34 [393/500 25152/32000 (79%)] Loss: 0.99076 (QuantReg: 15.99463) QuantErr: 15.99463 batch_time=0.38776 
Train Epoch: 34 [401/500 25664/32000 (80%)] Loss: 1.15269 (QuantReg: 15.93292) QuantErr: 15.93292 batch_time=0.39493 
Train Epoch: 34 [409/500 26176/32000 (82%)] Loss: 1.14294 (QuantReg: 15.83547) QuantErr: 15.83547 batch_time=0.81390 
Train Epoch: 34 [417/500 26688/32000 (83%)] Loss: 0.75579 (QuantReg: 15.92224) QuantErr: 15.92224 batch_time=0.39036 
Train Epoch: 34 [425/500 27200/32000 (85%)] Loss: 1.10450 (QuantReg: 15.60780) QuantErr: 15.60780 batch_time=0.39948 
Train Epoch: 34 [433/500 27712/32000 (87%)] Loss: 1.37229 (QuantReg: 15.53574) QuantErr: 15.53574 batch_time=0.40469 
Train Epoch: 34 [441/500 28224/32000 (88%)] Loss: 1.07690 (QuantReg: 15.94594) QuantErr: 15.94594 batch_time=0.39878 
Train Epoch: 34 [449/500 28736/32000 (90%)] Loss: 0.98165 (QuantReg: 15.99551) QuantErr: 15.99551 batch_time=0.51351 
Train Epoch: 34 [457/500 29248/32000 (91%)] Loss: 1.28099 (QuantReg: 15.75651) QuantErr: 15.75651 batch_time=0.38513 
Train Epoch: 34 [465/500 29760/32000 (93%)] Loss: 0.96665 (QuantReg: 15.69389) QuantErr: 15.69389 batch_time=0.39563 
Train Epoch: 34 [473/500 30272/32000 (95%)] Loss: 1.43496 (QuantReg: 15.85967) QuantErr: 15.85967 batch_time=0.84330 
Train Epoch: 34 [481/500 30784/32000 (96%)] Loss: 0.81299 (QuantReg: 15.74208) QuantErr: 15.74208 batch_time=0.41456 
Train Epoch: 34 [489/500 31296/32000 (98%)] Loss: 0.86170 (QuantReg: 15.90760) QuantErr: 15.90760 batch_time=0.38891 
Train Epoch: 34 [497/500 31808/32000 (99%)] Loss: 1.00955 (QuantReg: 15.73824) QuantErr: 15.73824 batch_time=0.39364 
Train Epoch: 34 codebook_update_time=2.40473
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch34.pth ...
Done in 4.405s
removing stale ckpt [epoch 33] [took 0.20s]
 epoch          : 34
 loss           : 1.0938702145814896
 quant_reg      : 15.814207803726196
 quant_err      : 15.814207803726196
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 17000
 LSMDC_full_test/t2v_metrics/R1: 13.2
 LSMDC_full_test/t2v_metrics/R5: 30.2
 LSMDC_full_test/t2v_metrics/R10: 42.2
 LSMDC_full_test/t2v_metrics/R50: 67.1
 LSMDC_full_test/t2v_metrics/MedR: 17.5
 LSMDC_full_test/t2v_metrics/MeanR: 76.252
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.623066774639298
 LSMDC_full_test/v2t_metrics/R1: 12.9
 LSMDC_full_test/v2t_metrics/R5: 31.3
 LSMDC_full_test/v2t_metrics/R10: 41.5
 LSMDC_full_test/v2t_metrics/R50: 67.9
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.35
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.589436050683265
 mnt_best       : 25.975252586423483
 not_improved_count: 2
Train Epoch: 35 [1/500 64/32000 (0%)] Loss: 1.23994 (QuantReg: 15.60092) QuantErr: 15.60092 batch_time=16.87697 
Train Epoch: 35 [9/500 576/32000 (2%)] Loss: 1.07675 (QuantReg: 15.78807) QuantErr: 15.78807 batch_time=0.38519 
Train Epoch: 35 [17/500 1088/32000 (3%)] Loss: 0.75570 (QuantReg: 15.93774) QuantErr: 15.93774 batch_time=0.47933 
Train Epoch: 35 [25/500 1600/32000 (5%)] Loss: 1.12756 (QuantReg: 15.93486) QuantErr: 15.93486 batch_time=0.38445 
Train Epoch: 35 [33/500 2112/32000 (7%)] Loss: 0.87042 (QuantReg: 15.60938) QuantErr: 15.60938 batch_time=0.38341 
Train Epoch: 35 [41/500 2624/32000 (8%)] Loss: 1.10137 (QuantReg: 15.90688) QuantErr: 15.90688 batch_time=0.38017 
Train Epoch: 35 [49/500 3136/32000 (10%)] Loss: 1.16591 (QuantReg: 15.70452) QuantErr: 15.70452 batch_time=0.40246 
Train Epoch: 35 [57/500 3648/32000 (11%)] Loss: 1.00188 (QuantReg: 15.64930) QuantErr: 15.64930 batch_time=0.40487 
Train Epoch: 35 [65/500 4160/32000 (13%)] Loss: 1.39122 (QuantReg: 15.63690) QuantErr: 15.63690 batch_time=0.81209 
Train Epoch: 35 [73/500 4672/32000 (15%)] Loss: 1.12394 (QuantReg: 15.90016) QuantErr: 15.90016 batch_time=0.37757 
Train Epoch: 35 [81/500 5184/32000 (16%)] Loss: 1.11904 (QuantReg: 15.72247) QuantErr: 15.72247 batch_time=0.43336 
Train Epoch: 35 [89/500 5696/32000 (18%)] Loss: 1.35964 (QuantReg: 15.81128) QuantErr: 15.81128 batch_time=0.37697 
Train Epoch: 35 [97/500 6208/32000 (19%)] Loss: 0.99216 (QuantReg: 15.89085) QuantErr: 15.89085 batch_time=0.38944 
Train Epoch: 35 [105/500 6720/32000 (21%)] Loss: 1.18276 (QuantReg: 16.06522) QuantErr: 16.06522 batch_time=0.41250 
Train Epoch: 35 [113/500 7232/32000 (23%)] Loss: 1.28495 (QuantReg: 15.91612) QuantErr: 15.91612 batch_time=0.40079 
Train Epoch: 35 [121/500 7744/32000 (24%)] Loss: 1.00603 (QuantReg: 15.75319) QuantErr: 15.75319 batch_time=0.40014 
Train Epoch: 35 [129/500 8256/32000 (26%)] Loss: 0.79505 (QuantReg: 15.61177) QuantErr: 15.61177 batch_time=0.80093 
Train Epoch: 35 [137/500 8768/32000 (27%)] Loss: 1.22622 (QuantReg: 15.74841) QuantErr: 15.74841 batch_time=0.37422 
Train Epoch: 35 [145/500 9280/32000 (29%)] Loss: 1.04911 (QuantReg: 15.77035) QuantErr: 15.77035 batch_time=0.43778 
Train Epoch: 35 [153/500 9792/32000 (31%)] Loss: 1.07702 (QuantReg: 15.99065) QuantErr: 15.99065 batch_time=0.38468 
Train Epoch: 35 [161/500 10304/32000 (32%)] Loss: 1.00358 (QuantReg: 15.71685) QuantErr: 15.71685 batch_time=0.37730 
Train Epoch: 35 [169/500 10816/32000 (34%)] Loss: 1.04671 (QuantReg: 15.90945) QuantErr: 15.90945 batch_time=0.38198 
Train Epoch: 35 [177/500 11328/32000 (35%)] Loss: 1.01774 (QuantReg: 15.81570) QuantErr: 15.81570 batch_time=0.37571 
Train Epoch: 35 [185/500 11840/32000 (37%)] Loss: 0.79226 (QuantReg: 15.64410) QuantErr: 15.64410 batch_time=0.40290 
Train Epoch: 35 [193/500 12352/32000 (39%)] Loss: 1.27838 (QuantReg: 16.07659) QuantErr: 16.07659 batch_time=0.81386 
Train Epoch: 35 [201/500 12864/32000 (40%)] Loss: 1.03085 (QuantReg: 15.74324) QuantErr: 15.74324 batch_time=0.38198 
Train Epoch: 35 [209/500 13376/32000 (42%)] Loss: 1.10357 (QuantReg: 16.01054) QuantErr: 16.01054 batch_time=0.43264 
Train Epoch: 35 [217/500 13888/32000 (43%)] Loss: 1.21584 (QuantReg: 15.65390) QuantErr: 15.65390 batch_time=0.38811 
Train Epoch: 35 [225/500 14400/32000 (45%)] Loss: 1.33866 (QuantReg: 15.95762) QuantErr: 15.95762 batch_time=0.37434 
Train Epoch: 35 [233/500 14912/32000 (47%)] Loss: 1.26594 (QuantReg: 15.65192) QuantErr: 15.65192 batch_time=0.37535 
Train Epoch: 35 [241/500 15424/32000 (48%)] Loss: 1.04534 (QuantReg: 15.91015) QuantErr: 15.91015 batch_time=0.37472 
Train Epoch: 35 [249/500 15936/32000 (50%)] Loss: 0.95709 (QuantReg: 15.77517) QuantErr: 15.77517 batch_time=0.37611 
Train Epoch: 35 [257/500 16448/32000 (51%)] Loss: 1.20791 (QuantReg: 15.85349) QuantErr: 15.85349 batch_time=0.88364 
Train Epoch: 35 [265/500 16960/32000 (53%)] Loss: 1.58646 (QuantReg: 15.52593) QuantErr: 15.52593 batch_time=0.37924 
Train Epoch: 35 [273/500 17472/32000 (55%)] Loss: 1.18670 (QuantReg: 15.75424) QuantErr: 15.75424 batch_time=0.43512 
Train Epoch: 35 [281/500 17984/32000 (56%)] Loss: 1.04722 (QuantReg: 15.94062) QuantErr: 15.94062 batch_time=0.40611 
Train Epoch: 35 [289/500 18496/32000 (58%)] Loss: 1.14374 (QuantReg: 15.64152) QuantErr: 15.64152 batch_time=0.39032 
Train Epoch: 35 [297/500 19008/32000 (59%)] Loss: 0.86649 (QuantReg: 15.90462) QuantErr: 15.90462 batch_time=0.37998 
Train Epoch: 35 [305/500 19520/32000 (61%)] Loss: 1.05321 (QuantReg: 15.86296) QuantErr: 15.86296 batch_time=0.37994 
Train Epoch: 35 [313/500 20032/32000 (63%)] Loss: 0.88869 (QuantReg: 16.00201) QuantErr: 16.00201 batch_time=0.38291 
Train Epoch: 35 [321/500 20544/32000 (64%)] Loss: 1.10030 (QuantReg: 15.71444) QuantErr: 15.71444 batch_time=0.85485 
Train Epoch: 35 [329/500 21056/32000 (66%)] Loss: 1.13445 (QuantReg: 15.78500) QuantErr: 15.78500 batch_time=0.39194 
Train Epoch: 35 [337/500 21568/32000 (67%)] Loss: 0.92960 (QuantReg: 15.71125) QuantErr: 15.71125 batch_time=0.43242 
Train Epoch: 35 [345/500 22080/32000 (69%)] Loss: 0.99009 (QuantReg: 15.74512) QuantErr: 15.74512 batch_time=0.38922 
Train Epoch: 35 [353/500 22592/32000 (71%)] Loss: 1.15225 (QuantReg: 15.61891) QuantErr: 15.61891 batch_time=0.41274 
Train Epoch: 35 [361/500 23104/32000 (72%)] Loss: 1.06813 (QuantReg: 15.74185) QuantErr: 15.74185 batch_time=0.39185 
Train Epoch: 35 [369/500 23616/32000 (74%)] Loss: 1.26378 (QuantReg: 15.88048) QuantErr: 15.88048 batch_time=0.39143 
Train Epoch: 35 [377/500 24128/32000 (75%)] Loss: 1.05694 (QuantReg: 15.87925) QuantErr: 15.87925 batch_time=0.39631 
Train Epoch: 35 [385/500 24640/32000 (77%)] Loss: 0.84081 (QuantReg: 15.81942) QuantErr: 15.81942 batch_time=0.78682 
Train Epoch: 35 [393/500 25152/32000 (79%)] Loss: 1.17663 (QuantReg: 15.91093) QuantErr: 15.91093 batch_time=0.39173 
Train Epoch: 35 [401/500 25664/32000 (80%)] Loss: 1.29208 (QuantReg: 15.74231) QuantErr: 15.74231 batch_time=0.45148 
Train Epoch: 35 [409/500 26176/32000 (82%)] Loss: 0.83294 (QuantReg: 15.79606) QuantErr: 15.79606 batch_time=0.39935 
Train Epoch: 35 [417/500 26688/32000 (83%)] Loss: 1.23008 (QuantReg: 15.83935) QuantErr: 15.83935 batch_time=0.39769 
Train Epoch: 35 [425/500 27200/32000 (85%)] Loss: 0.89035 (QuantReg: 15.63492) QuantErr: 15.63492 batch_time=0.40748 
Train Epoch: 35 [433/500 27712/32000 (87%)] Loss: 1.15762 (QuantReg: 15.57171) QuantErr: 15.57171 batch_time=0.39488 
Train Epoch: 35 [441/500 28224/32000 (88%)] Loss: 0.87614 (QuantReg: 16.04478) QuantErr: 16.04478 batch_time=0.39443 
Train Epoch: 35 [449/500 28736/32000 (90%)] Loss: 0.96274 (QuantReg: 15.62387) QuantErr: 15.62387 batch_time=0.78619 
Train Epoch: 35 [457/500 29248/32000 (91%)] Loss: 0.89560 (QuantReg: 15.93692) QuantErr: 15.93692 batch_time=0.38578 
Train Epoch: 35 [465/500 29760/32000 (93%)] Loss: 1.00851 (QuantReg: 15.81547) QuantErr: 15.81547 batch_time=0.48097 
Train Epoch: 35 [473/500 30272/32000 (95%)] Loss: 0.98519 (QuantReg: 15.71644) QuantErr: 15.71644 batch_time=0.41666 
Train Epoch: 35 [481/500 30784/32000 (96%)] Loss: 0.95755 (QuantReg: 15.94951) QuantErr: 15.94951 batch_time=0.43414 
Train Epoch: 35 [489/500 31296/32000 (98%)] Loss: 1.04856 (QuantReg: 15.97929) QuantErr: 15.97929 batch_time=0.39751 
Train Epoch: 35 [497/500 31808/32000 (99%)] Loss: 0.98743 (QuantReg: 15.78429) QuantErr: 15.78429 batch_time=0.38582 
Train Epoch: 35 codebook_update_time=2.18899
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch35.pth ...
Done in 6.104s
removing stale ckpt [epoch 34] [took 0.01s]
 epoch          : 35
 loss           : 1.0572584464550019
 quant_reg      : 15.792449861526489
 quant_err      : 15.792449861526489
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 17500
 LSMDC_full_test/t2v_metrics/R1: 12.9
 LSMDC_full_test/t2v_metrics/R5: 29.8
 LSMDC_full_test/t2v_metrics/R10: 41.3
 LSMDC_full_test/t2v_metrics/R50: 66.8
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 76.383
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.133444304019005
 LSMDC_full_test/v2t_metrics/R1: 12.7
 LSMDC_full_test/v2t_metrics/R5: 30.8
 LSMDC_full_test/v2t_metrics/R10: 40.8
 LSMDC_full_test/v2t_metrics/R50: 67.2
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 77.245
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.17705141844003
 mnt_best       : 25.975252586423483
 not_improved_count: 3
Train Epoch: 36 [1/500 64/32000 (0%)] Loss: 1.03211 (QuantReg: 15.84748) QuantErr: 15.84748 batch_time=15.41890 
Train Epoch: 36 [9/500 576/32000 (2%)] Loss: 1.10308 (QuantReg: 15.90780) QuantErr: 15.90780 batch_time=0.53604 
Train Epoch: 36 [17/500 1088/32000 (3%)] Loss: 0.95898 (QuantReg: 15.68944) QuantErr: 15.68944 batch_time=1.74995 
Train Epoch: 36 [25/500 1600/32000 (5%)] Loss: 0.91655 (QuantReg: 15.84375) QuantErr: 15.84375 batch_time=1.24256 
Train Epoch: 36 [33/500 2112/32000 (7%)] Loss: 1.11931 (QuantReg: 15.68300) QuantErr: 15.68300 batch_time=0.38157 
Train Epoch: 36 [41/500 2624/32000 (8%)] Loss: 1.21472 (QuantReg: 15.45745) QuantErr: 15.45745 batch_time=0.40678 
Train Epoch: 36 [49/500 3136/32000 (10%)] Loss: 0.95863 (QuantReg: 15.73744) QuantErr: 15.73744 batch_time=0.38125 
Train Epoch: 36 [57/500 3648/32000 (11%)] Loss: 1.38777 (QuantReg: 15.42990) QuantErr: 15.42990 batch_time=0.39424 
Train Epoch: 36 [65/500 4160/32000 (13%)] Loss: 1.18466 (QuantReg: 15.69853) QuantErr: 15.69853 batch_time=0.37979 
Train Epoch: 36 [73/500 4672/32000 (15%)] Loss: 1.38548 (QuantReg: 15.88613) QuantErr: 15.88613 batch_time=0.53598 
Train Epoch: 36 [81/500 5184/32000 (16%)] Loss: 0.96284 (QuantReg: 15.73142) QuantErr: 15.73142 batch_time=1.50993 
Train Epoch: 36 [89/500 5696/32000 (18%)] Loss: 0.99333 (QuantReg: 15.89428) QuantErr: 15.89428 batch_time=1.08913 
Train Epoch: 36 [97/500 6208/32000 (19%)] Loss: 1.26332 (QuantReg: 15.75359) QuantErr: 15.75359 batch_time=0.37946 
Train Epoch: 36 [105/500 6720/32000 (21%)] Loss: 0.91133 (QuantReg: 15.76607) QuantErr: 15.76607 batch_time=0.38633 
Train Epoch: 36 [113/500 7232/32000 (23%)] Loss: 0.91868 (QuantReg: 15.82216) QuantErr: 15.82216 batch_time=0.38177 
Train Epoch: 36 [121/500 7744/32000 (24%)] Loss: 1.15637 (QuantReg: 15.74421) QuantErr: 15.74421 batch_time=0.38393 
Train Epoch: 36 [129/500 8256/32000 (26%)] Loss: 0.83761 (QuantReg: 15.95161) QuantErr: 15.95161 batch_time=0.37636 
Train Epoch: 36 [137/500 8768/32000 (27%)] Loss: 1.31308 (QuantReg: 15.81371) QuantErr: 15.81371 batch_time=0.53789 
Train Epoch: 36 [145/500 9280/32000 (29%)] Loss: 0.85782 (QuantReg: 16.03775) QuantErr: 16.03775 batch_time=1.54339 
Train Epoch: 36 [153/500 9792/32000 (31%)] Loss: 1.02230 (QuantReg: 15.79049) QuantErr: 15.79049 batch_time=1.06730 
Train Epoch: 36 [161/500 10304/32000 (32%)] Loss: 0.88850 (QuantReg: 15.62275) QuantErr: 15.62275 batch_time=0.38008 
Train Epoch: 36 [169/500 10816/32000 (34%)] Loss: 1.19228 (QuantReg: 15.80334) QuantErr: 15.80334 batch_time=0.40818 
Train Epoch: 36 [177/500 11328/32000 (35%)] Loss: 1.12735 (QuantReg: 15.66748) QuantErr: 15.66748 batch_time=0.40229 
Train Epoch: 36 [185/500 11840/32000 (37%)] Loss: 1.06366 (QuantReg: 15.87875) QuantErr: 15.87875 batch_time=0.38323 
Train Epoch: 36 [193/500 12352/32000 (39%)] Loss: 0.86933 (QuantReg: 15.75457) QuantErr: 15.75457 batch_time=0.40650 
Train Epoch: 36 [201/500 12864/32000 (40%)] Loss: 0.93465 (QuantReg: 15.78760) QuantErr: 15.78760 batch_time=0.56859 
Train Epoch: 36 [209/500 13376/32000 (42%)] Loss: 0.90273 (QuantReg: 15.78645) QuantErr: 15.78645 batch_time=1.53069 
Train Epoch: 36 [217/500 13888/32000 (43%)] Loss: 1.08308 (QuantReg: 15.69248) QuantErr: 15.69248 batch_time=1.10477 
Train Epoch: 36 [225/500 14400/32000 (45%)] Loss: 1.19385 (QuantReg: 15.72261) QuantErr: 15.72261 batch_time=0.38579 
Train Epoch: 36 [233/500 14912/32000 (47%)] Loss: 0.99832 (QuantReg: 15.91357) QuantErr: 15.91357 batch_time=0.38152 
Train Epoch: 36 [241/500 15424/32000 (48%)] Loss: 1.10071 (QuantReg: 15.51289) QuantErr: 15.51289 batch_time=0.38445 
Train Epoch: 36 [249/500 15936/32000 (50%)] Loss: 1.28694 (QuantReg: 15.97680) QuantErr: 15.97680 batch_time=0.38556 
Train Epoch: 36 [257/500 16448/32000 (51%)] Loss: 1.03986 (QuantReg: 15.62216) QuantErr: 15.62216 batch_time=0.37814 
Train Epoch: 36 [265/500 16960/32000 (53%)] Loss: 0.98512 (QuantReg: 15.82726) QuantErr: 15.82726 batch_time=0.54163 
Train Epoch: 36 [273/500 17472/32000 (55%)] Loss: 0.87940 (QuantReg: 15.70169) QuantErr: 15.70169 batch_time=1.49231 
Train Epoch: 36 [281/500 17984/32000 (56%)] Loss: 0.77971 (QuantReg: 15.89715) QuantErr: 15.89715 batch_time=1.08074 
Train Epoch: 36 [289/500 18496/32000 (58%)] Loss: 0.96928 (QuantReg: 15.74889) QuantErr: 15.74889 batch_time=0.38568 
Train Epoch: 36 [297/500 19008/32000 (59%)] Loss: 1.18641 (QuantReg: 15.77265) QuantErr: 15.77265 batch_time=0.37971 
Train Epoch: 36 [305/500 19520/32000 (61%)] Loss: 1.38624 (QuantReg: 15.87190) QuantErr: 15.87190 batch_time=0.38290 
Train Epoch: 36 [313/500 20032/32000 (63%)] Loss: 1.17400 (QuantReg: 15.86699) QuantErr: 15.86699 batch_time=0.40657 
Train Epoch: 36 [321/500 20544/32000 (64%)] Loss: 0.83820 (QuantReg: 15.89916) QuantErr: 15.89916 batch_time=0.37589 
Train Epoch: 36 [329/500 21056/32000 (66%)] Loss: 0.83560 (QuantReg: 15.79035) QuantErr: 15.79035 batch_time=0.55685 
Train Epoch: 36 [337/500 21568/32000 (67%)] Loss: 0.98447 (QuantReg: 15.67113) QuantErr: 15.67113 batch_time=1.50850 
Train Epoch: 36 [345/500 22080/32000 (69%)] Loss: 0.86320 (QuantReg: 15.94893) QuantErr: 15.94893 batch_time=1.08316 
Train Epoch: 36 [353/500 22592/32000 (71%)] Loss: 1.24375 (QuantReg: 15.80886) QuantErr: 15.80886 batch_time=0.38869 
Train Epoch: 36 [361/500 23104/32000 (72%)] Loss: 1.32157 (QuantReg: 15.69536) QuantErr: 15.69536 batch_time=0.43155 
Train Epoch: 36 [369/500 23616/32000 (74%)] Loss: 1.25464 (QuantReg: 15.70177) QuantErr: 15.70177 batch_time=0.38926 
Train Epoch: 36 [377/500 24128/32000 (75%)] Loss: 1.16727 (QuantReg: 15.79108) QuantErr: 15.79108 batch_time=0.41236 
Train Epoch: 36 [385/500 24640/32000 (77%)] Loss: 0.83416 (QuantReg: 15.97989) QuantErr: 15.97989 batch_time=0.38179 
Train Epoch: 36 [393/500 25152/32000 (79%)] Loss: 1.84507 (QuantReg: 15.83390) QuantErr: 15.83390 batch_time=0.54786 
Train Epoch: 36 [401/500 25664/32000 (80%)] Loss: 0.90210 (QuantReg: 15.77289) QuantErr: 15.77289 batch_time=1.51549 
Train Epoch: 36 [409/500 26176/32000 (82%)] Loss: 0.98665 (QuantReg: 15.75801) QuantErr: 15.75801 batch_time=1.07745 
Train Epoch: 36 [417/500 26688/32000 (83%)] Loss: 0.89959 (QuantReg: 15.65956) QuantErr: 15.65956 batch_time=0.38740 
Train Epoch: 36 [425/500 27200/32000 (85%)] Loss: 1.42404 (QuantReg: 15.65449) QuantErr: 15.65449 batch_time=0.39054 
Train Epoch: 36 [433/500 27712/32000 (87%)] Loss: 1.11529 (QuantReg: 16.16376) QuantErr: 16.16376 batch_time=0.38525 
Train Epoch: 36 [441/500 28224/32000 (88%)] Loss: 0.78422 (QuantReg: 15.49602) QuantErr: 15.49602 batch_time=0.39213 
Train Epoch: 36 [449/500 28736/32000 (90%)] Loss: 0.96299 (QuantReg: 15.69483) QuantErr: 15.69483 batch_time=0.37863 
Train Epoch: 36 [457/500 29248/32000 (91%)] Loss: 0.90560 (QuantReg: 15.60809) QuantErr: 15.60809 batch_time=0.54301 
Train Epoch: 36 [465/500 29760/32000 (93%)] Loss: 1.20454 (QuantReg: 15.82805) QuantErr: 15.82805 batch_time=1.56595 
Train Epoch: 36 [473/500 30272/32000 (95%)] Loss: 1.18805 (QuantReg: 15.91254) QuantErr: 15.91254 batch_time=1.07222 
Train Epoch: 36 [481/500 30784/32000 (96%)] Loss: 1.07623 (QuantReg: 15.89482) QuantErr: 15.89482 batch_time=0.39239 
Train Epoch: 36 [489/500 31296/32000 (98%)] Loss: 0.79575 (QuantReg: 15.77142) QuantErr: 15.77142 batch_time=0.38870 
Train Epoch: 36 [497/500 31808/32000 (99%)] Loss: 1.10611 (QuantReg: 15.93290) QuantErr: 15.93290 batch_time=0.39926 
Train Epoch: 36 codebook_update_time=1.88485
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch36.pth ...
Done in 4.907s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 1.033481105208397
 quant_reg      : 15.806851531982423
 quant_err      : 15.806851531982423
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 18000
 LSMDC_full_test/t2v_metrics/R1: 12.4
 LSMDC_full_test/t2v_metrics/R5: 29.2
 LSMDC_full_test/t2v_metrics/R10: 40.8
 LSMDC_full_test/t2v_metrics/R50: 66.4
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 77.085
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.537005856430547
 LSMDC_full_test/v2t_metrics/R1: 13.5
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 66.1
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 76.505
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.712004162650114
 mnt_best       : 25.975252586423483
 not_improved_count: 4
Train Epoch: 37 [1/500 64/32000 (0%)] Loss: 1.31618 (QuantReg: 15.76712) QuantErr: 15.76712 batch_time=14.20770 
Train Epoch: 37 [9/500 576/32000 (2%)] Loss: 1.09535 (QuantReg: 15.54198) QuantErr: 15.54198 batch_time=0.43414 
Train Epoch: 37 [17/500 1088/32000 (3%)] Loss: 0.95031 (QuantReg: 16.05804) QuantErr: 16.05804 batch_time=2.93965 
Train Epoch: 37 [25/500 1600/32000 (5%)] Loss: 1.13434 (QuantReg: 15.77688) QuantErr: 15.77688 batch_time=0.40092 
Train Epoch: 37 [33/500 2112/32000 (7%)] Loss: 0.95152 (QuantReg: 15.55849) QuantErr: 15.55849 batch_time=0.37916 
Train Epoch: 37 [41/500 2624/32000 (8%)] Loss: 1.09874 (QuantReg: 15.64024) QuantErr: 15.64024 batch_time=0.39974 
Train Epoch: 37 [49/500 3136/32000 (10%)] Loss: 1.06021 (QuantReg: 15.92810) QuantErr: 15.92810 batch_time=0.37781 
Train Epoch: 37 [57/500 3648/32000 (11%)] Loss: 1.16006 (QuantReg: 15.61670) QuantErr: 15.61670 batch_time=0.37602 
Train Epoch: 37 [65/500 4160/32000 (13%)] Loss: 0.91041 (QuantReg: 15.78434) QuantErr: 15.78434 batch_time=0.38329 
Train Epoch: 37 [73/500 4672/32000 (15%)] Loss: 0.82329 (QuantReg: 15.87581) QuantErr: 15.87581 batch_time=0.44663 
Train Epoch: 37 [81/500 5184/32000 (16%)] Loss: 1.29709 (QuantReg: 15.76658) QuantErr: 15.76658 batch_time=2.14113 
Train Epoch: 37 [89/500 5696/32000 (18%)] Loss: 0.90875 (QuantReg: 16.11285) QuantErr: 16.11285 batch_time=0.38332 
Train Epoch: 37 [97/500 6208/32000 (19%)] Loss: 0.84416 (QuantReg: 16.03908) QuantErr: 16.03908 batch_time=0.39759 
Train Epoch: 37 [105/500 6720/32000 (21%)] Loss: 1.01348 (QuantReg: 15.88007) QuantErr: 15.88007 batch_time=0.39320 
Train Epoch: 37 [113/500 7232/32000 (23%)] Loss: 1.62138 (QuantReg: 15.72295) QuantErr: 15.72295 batch_time=0.39877 
Train Epoch: 37 [121/500 7744/32000 (24%)] Loss: 1.17496 (QuantReg: 15.84076) QuantErr: 15.84076 batch_time=0.37589 
Train Epoch: 37 [129/500 8256/32000 (26%)] Loss: 0.93855 (QuantReg: 15.97003) QuantErr: 15.97003 batch_time=0.38132 
Train Epoch: 37 [137/500 8768/32000 (27%)] Loss: 1.01332 (QuantReg: 15.72139) QuantErr: 15.72139 batch_time=0.45827 
Train Epoch: 37 [145/500 9280/32000 (29%)] Loss: 0.90849 (QuantReg: 15.84497) QuantErr: 15.84497 batch_time=2.13438 
Train Epoch: 37 [153/500 9792/32000 (31%)] Loss: 0.94653 (QuantReg: 15.83152) QuantErr: 15.83152 batch_time=0.38039 
Train Epoch: 37 [161/500 10304/32000 (32%)] Loss: 1.18994 (QuantReg: 15.81381) QuantErr: 15.81381 batch_time=0.37953 
Train Epoch: 37 [169/500 10816/32000 (34%)] Loss: 1.59039 (QuantReg: 16.05221) QuantErr: 16.05221 batch_time=0.38168 
Train Epoch: 37 [177/500 11328/32000 (35%)] Loss: 0.90720 (QuantReg: 15.87987) QuantErr: 15.87987 batch_time=0.42842 
Train Epoch: 37 [185/500 11840/32000 (37%)] Loss: 0.97817 (QuantReg: 15.73951) QuantErr: 15.73951 batch_time=0.38152 
Train Epoch: 37 [193/500 12352/32000 (39%)] Loss: 1.02982 (QuantReg: 15.77698) QuantErr: 15.77698 batch_time=0.38234 
Train Epoch: 37 [201/500 12864/32000 (40%)] Loss: 0.55999 (QuantReg: 16.05603) QuantErr: 16.05603 batch_time=0.43761 
Train Epoch: 37 [209/500 13376/32000 (42%)] Loss: 0.88060 (QuantReg: 15.70816) QuantErr: 15.70816 batch_time=2.16538 
Train Epoch: 37 [217/500 13888/32000 (43%)] Loss: 0.88812 (QuantReg: 15.90101) QuantErr: 15.90101 batch_time=0.38093 
Train Epoch: 37 [225/500 14400/32000 (45%)] Loss: 1.01573 (QuantReg: 15.85353) QuantErr: 15.85353 batch_time=0.38437 
Train Epoch: 37 [233/500 14912/32000 (47%)] Loss: 0.80746 (QuantReg: 15.71331) QuantErr: 15.71331 batch_time=0.38483 
Train Epoch: 37 [241/500 15424/32000 (48%)] Loss: 1.28870 (QuantReg: 15.52518) QuantErr: 15.52518 batch_time=0.37573 
Train Epoch: 37 [249/500 15936/32000 (50%)] Loss: 0.99215 (QuantReg: 15.94716) QuantErr: 15.94716 batch_time=0.38269 
Train Epoch: 37 [257/500 16448/32000 (51%)] Loss: 1.04058 (QuantReg: 15.65562) QuantErr: 15.65562 batch_time=0.39979 
Train Epoch: 37 [265/500 16960/32000 (53%)] Loss: 1.26590 (QuantReg: 16.00493) QuantErr: 16.00493 batch_time=0.43286 
Train Epoch: 37 [273/500 17472/32000 (55%)] Loss: 0.80958 (QuantReg: 15.83076) QuantErr: 15.83076 batch_time=2.22660 
Train Epoch: 37 [281/500 17984/32000 (56%)] Loss: 1.07723 (QuantReg: 15.88286) QuantErr: 15.88286 batch_time=0.38640 
Train Epoch: 37 [289/500 18496/32000 (58%)] Loss: 1.44492 (QuantReg: 15.76939) QuantErr: 15.76939 batch_time=0.38513 
Train Epoch: 37 [297/500 19008/32000 (59%)] Loss: 0.89823 (QuantReg: 15.81624) QuantErr: 15.81624 batch_time=0.39533 
Train Epoch: 37 [305/500 19520/32000 (61%)] Loss: 0.94590 (QuantReg: 15.66203) QuantErr: 15.66203 batch_time=0.39313 
Train Epoch: 37 [313/500 20032/32000 (63%)] Loss: 1.08565 (QuantReg: 16.12854) QuantErr: 16.12854 batch_time=0.43429 
Train Epoch: 37 [321/500 20544/32000 (64%)] Loss: 1.05195 (QuantReg: 15.92411) QuantErr: 15.92411 batch_time=0.38262 
Train Epoch: 37 [329/500 21056/32000 (66%)] Loss: 0.68831 (QuantReg: 15.85145) QuantErr: 15.85145 batch_time=0.44203 
Train Epoch: 37 [337/500 21568/32000 (67%)] Loss: 0.99958 (QuantReg: 15.63480) QuantErr: 15.63480 batch_time=2.12782 
Train Epoch: 37 [345/500 22080/32000 (69%)] Loss: 0.77152 (QuantReg: 15.78059) QuantErr: 15.78059 batch_time=0.38485 
Train Epoch: 37 [353/500 22592/32000 (71%)] Loss: 1.04550 (QuantReg: 15.67988) QuantErr: 15.67988 batch_time=0.38507 
Train Epoch: 37 [361/500 23104/32000 (72%)] Loss: 1.23404 (QuantReg: 15.78260) QuantErr: 15.78260 batch_time=0.41787 
Train Epoch: 37 [369/500 23616/32000 (74%)] Loss: 1.07553 (QuantReg: 15.96111) QuantErr: 15.96111 batch_time=0.38168 
Train Epoch: 37 [377/500 24128/32000 (75%)] Loss: 1.15177 (QuantReg: 15.69663) QuantErr: 15.69663 batch_time=0.36955 
Train Epoch: 37 [385/500 24640/32000 (77%)] Loss: 0.98162 (QuantReg: 15.53736) QuantErr: 15.53736 batch_time=0.37587 
Train Epoch: 37 [393/500 25152/32000 (79%)] Loss: 0.83412 (QuantReg: 15.89750) QuantErr: 15.89750 batch_time=0.43018 
Train Epoch: 37 [401/500 25664/32000 (80%)] Loss: 0.98622 (QuantReg: 15.78165) QuantErr: 15.78165 batch_time=2.13008 
Train Epoch: 37 [409/500 26176/32000 (82%)] Loss: 0.75200 (QuantReg: 15.90661) QuantErr: 15.90661 batch_time=0.39866 
Train Epoch: 37 [417/500 26688/32000 (83%)] Loss: 0.88916 (QuantReg: 15.96525) QuantErr: 15.96525 batch_time=0.38301 
Train Epoch: 37 [425/500 27200/32000 (85%)] Loss: 0.93223 (QuantReg: 15.97978) QuantErr: 15.97978 batch_time=0.39646 
Train Epoch: 37 [433/500 27712/32000 (87%)] Loss: 0.90621 (QuantReg: 15.76291) QuantErr: 15.76291 batch_time=0.38079 
Train Epoch: 37 [441/500 28224/32000 (88%)] Loss: 1.13983 (QuantReg: 15.95623) QuantErr: 15.95623 batch_time=0.38042 
Train Epoch: 37 [449/500 28736/32000 (90%)] Loss: 0.87887 (QuantReg: 15.78712) QuantErr: 15.78712 batch_time=0.38114 
Train Epoch: 37 [457/500 29248/32000 (91%)] Loss: 0.92730 (QuantReg: 15.84876) QuantErr: 15.84876 batch_time=0.44387 
Train Epoch: 37 [465/500 29760/32000 (93%)] Loss: 0.95412 (QuantReg: 15.76106) QuantErr: 15.76106 batch_time=2.24798 
Train Epoch: 37 [473/500 30272/32000 (95%)] Loss: 0.93113 (QuantReg: 15.77327) QuantErr: 15.77327 batch_time=0.38915 
Train Epoch: 37 [481/500 30784/32000 (96%)] Loss: 1.01973 (QuantReg: 15.89125) QuantErr: 15.89125 batch_time=0.38272 
Train Epoch: 37 [489/500 31296/32000 (98%)] Loss: 0.71248 (QuantReg: 16.10962) QuantErr: 16.10962 batch_time=0.39178 
Train Epoch: 37 [497/500 31808/32000 (99%)] Loss: 0.90894 (QuantReg: 15.75117) QuantErr: 15.75117 batch_time=0.38857 
Train Epoch: 37 codebook_update_time=2.46986
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch37.pth ...
Done in 4.229s
removing stale ckpt [epoch 36] [took 0.01s]
 epoch          : 37
 loss           : 1.021707857489586
 quant_reg      : 15.828971872329712
 quant_err      : 15.828971872329712
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 18500
 LSMDC_full_test/t2v_metrics/R1: 13.2
 LSMDC_full_test/t2v_metrics/R5: 30.1
 LSMDC_full_test/t2v_metrics/R10: 41.0
 LSMDC_full_test/t2v_metrics/R50: 67.2
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 77.745
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.34981306928126
 LSMDC_full_test/v2t_metrics/R1: 13.3
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 67.0
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 76.654
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.584399063876305
 mnt_best       : 25.975252586423483
 not_improved_count: 5
Train Epoch: 38 [1/500 64/32000 (0%)] Loss: 0.99582 (QuantReg: 15.82371) QuantErr: 15.82371 batch_time=15.12841 
Train Epoch: 38 [9/500 576/32000 (2%)] Loss: 1.10073 (QuantReg: 16.01365) QuantErr: 16.01365 batch_time=0.38400 
Train Epoch: 38 [17/500 1088/32000 (3%)] Loss: 0.84517 (QuantReg: 15.83517) QuantErr: 15.83517 batch_time=0.38290 
Train Epoch: 38 [25/500 1600/32000 (5%)] Loss: 1.34650 (QuantReg: 15.66419) QuantErr: 15.66419 batch_time=0.38374 
Train Epoch: 38 [33/500 2112/32000 (7%)] Loss: 1.04282 (QuantReg: 15.84213) QuantErr: 15.84213 batch_time=0.38773 
Train Epoch: 38 [41/500 2624/32000 (8%)] Loss: 0.96183 (QuantReg: 15.83210) QuantErr: 15.83210 batch_time=0.38226 
Train Epoch: 38 [49/500 3136/32000 (10%)] Loss: 1.03822 (QuantReg: 15.62415) QuantErr: 15.62415 batch_time=0.37970 
Train Epoch: 38 [57/500 3648/32000 (11%)] Loss: 1.02802 (QuantReg: 15.70693) QuantErr: 15.70693 batch_time=0.39264 
Train Epoch: 38 [65/500 4160/32000 (13%)] Loss: 0.97876 (QuantReg: 15.68269) QuantErr: 15.68269 batch_time=1.07307 
Train Epoch: 38 [73/500 4672/32000 (15%)] Loss: 0.89228 (QuantReg: 15.80463) QuantErr: 15.80463 batch_time=0.37769 
Train Epoch: 38 [81/500 5184/32000 (16%)] Loss: 0.98915 (QuantReg: 15.68322) QuantErr: 15.68322 batch_time=0.38378 
Train Epoch: 38 [89/500 5696/32000 (18%)] Loss: 1.21208 (QuantReg: 15.82830) QuantErr: 15.82830 batch_time=0.38875 
Train Epoch: 38 [97/500 6208/32000 (19%)] Loss: 0.75962 (QuantReg: 15.71946) QuantErr: 15.71946 batch_time=0.39794 
Train Epoch: 38 [105/500 6720/32000 (21%)] Loss: 1.27206 (QuantReg: 15.90148) QuantErr: 15.90148 batch_time=0.37693 
Train Epoch: 38 [113/500 7232/32000 (23%)] Loss: 0.84992 (QuantReg: 15.86180) QuantErr: 15.86180 batch_time=0.38380 
Train Epoch: 38 [121/500 7744/32000 (24%)] Loss: 1.13705 (QuantReg: 15.74877) QuantErr: 15.74877 batch_time=0.38140 
Train Epoch: 38 [129/500 8256/32000 (26%)] Loss: 1.24557 (QuantReg: 15.68491) QuantErr: 15.68491 batch_time=1.11791 
Train Epoch: 38 [137/500 8768/32000 (27%)] Loss: 0.74870 (QuantReg: 15.86224) QuantErr: 15.86224 batch_time=0.38411 
Train Epoch: 38 [145/500 9280/32000 (29%)] Loss: 1.05746 (QuantReg: 15.82016) QuantErr: 15.82016 batch_time=0.38090 
Train Epoch: 38 [153/500 9792/32000 (31%)] Loss: 1.10133 (QuantReg: 16.00251) QuantErr: 16.00251 batch_time=0.89502 
Train Epoch: 38 [161/500 10304/32000 (32%)] Loss: 0.82101 (QuantReg: 16.04821) QuantErr: 16.04821 batch_time=0.37883 
Train Epoch: 38 [169/500 10816/32000 (34%)] Loss: 0.90909 (QuantReg: 15.67825) QuantErr: 15.67825 batch_time=0.38338 
Train Epoch: 38 [177/500 11328/32000 (35%)] Loss: 0.87471 (QuantReg: 15.60519) QuantErr: 15.60519 batch_time=0.37988 
Train Epoch: 38 [185/500 11840/32000 (37%)] Loss: 0.96422 (QuantReg: 15.75311) QuantErr: 15.75311 batch_time=0.40683 
Train Epoch: 38 [193/500 12352/32000 (39%)] Loss: 0.92699 (QuantReg: 15.81420) QuantErr: 15.81420 batch_time=1.02553 
Train Epoch: 38 [201/500 12864/32000 (40%)] Loss: 1.13490 (QuantReg: 16.02388) QuantErr: 16.02388 batch_time=0.37620 
Train Epoch: 38 [209/500 13376/32000 (42%)] Loss: 1.05144 (QuantReg: 15.82278) QuantErr: 15.82278 batch_time=0.38141 
Train Epoch: 38 [217/500 13888/32000 (43%)] Loss: 1.16377 (QuantReg: 15.83737) QuantErr: 15.83737 batch_time=0.37963 
Train Epoch: 38 [225/500 14400/32000 (45%)] Loss: 1.04780 (QuantReg: 15.73992) QuantErr: 15.73992 batch_time=0.39358 
Train Epoch: 38 [233/500 14912/32000 (47%)] Loss: 0.99240 (QuantReg: 15.64025) QuantErr: 15.64025 batch_time=0.38873 
Train Epoch: 38 [241/500 15424/32000 (48%)] Loss: 0.84017 (QuantReg: 15.87606) QuantErr: 15.87606 batch_time=0.38509 
Train Epoch: 38 [249/500 15936/32000 (50%)] Loss: 0.83509 (QuantReg: 15.72966) QuantErr: 15.72966 batch_time=0.38280 
Train Epoch: 38 [257/500 16448/32000 (51%)] Loss: 0.93024 (QuantReg: 15.75265) QuantErr: 15.75265 batch_time=1.07513 
Train Epoch: 38 [265/500 16960/32000 (53%)] Loss: 1.20471 (QuantReg: 15.54545) QuantErr: 15.54545 batch_time=0.39311 
Train Epoch: 38 [273/500 17472/32000 (55%)] Loss: 1.06965 (QuantReg: 15.79758) QuantErr: 15.79758 batch_time=0.38314 
Train Epoch: 38 [281/500 17984/32000 (56%)] Loss: 1.04351 (QuantReg: 15.77329) QuantErr: 15.77329 batch_time=0.38462 
Train Epoch: 38 [289/500 18496/32000 (58%)] Loss: 0.93073 (QuantReg: 15.69623) QuantErr: 15.69623 batch_time=0.38828 
Train Epoch: 38 [297/500 19008/32000 (59%)] Loss: 1.14696 (QuantReg: 15.67943) QuantErr: 15.67943 batch_time=0.40571 
Train Epoch: 38 [305/500 19520/32000 (61%)] Loss: 0.79216 (QuantReg: 15.66195) QuantErr: 15.66195 batch_time=0.40629 
Train Epoch: 38 [313/500 20032/32000 (63%)] Loss: 1.02380 (QuantReg: 15.94815) QuantErr: 15.94815 batch_time=0.38516 
Train Epoch: 38 [321/500 20544/32000 (64%)] Loss: 0.86320 (QuantReg: 15.86782) QuantErr: 15.86782 batch_time=1.05414 
Train Epoch: 38 [329/500 21056/32000 (66%)] Loss: 0.90151 (QuantReg: 15.75943) QuantErr: 15.75943 batch_time=0.38402 
Train Epoch: 38 [337/500 21568/32000 (67%)] Loss: 0.99901 (QuantReg: 15.81901) QuantErr: 15.81901 batch_time=0.39706 
Train Epoch: 38 [345/500 22080/32000 (69%)] Loss: 1.28617 (QuantReg: 15.81501) QuantErr: 15.81501 batch_time=0.38167 
Train Epoch: 38 [353/500 22592/32000 (71%)] Loss: 0.85632 (QuantReg: 15.87049) QuantErr: 15.87049 batch_time=0.39364 
Train Epoch: 38 [361/500 23104/32000 (72%)] Loss: 0.95146 (QuantReg: 15.74900) QuantErr: 15.74900 batch_time=0.38859 
Train Epoch: 38 [369/500 23616/32000 (74%)] Loss: 1.12476 (QuantReg: 15.83658) QuantErr: 15.83658 batch_time=0.39526 
Train Epoch: 38 [377/500 24128/32000 (75%)] Loss: 0.90220 (QuantReg: 15.81757) QuantErr: 15.81757 batch_time=0.38100 
Train Epoch: 38 [385/500 24640/32000 (77%)] Loss: 1.02042 (QuantReg: 15.89759) QuantErr: 15.89759 batch_time=1.03831 
Train Epoch: 38 [393/500 25152/32000 (79%)] Loss: 1.09918 (QuantReg: 15.55630) QuantErr: 15.55630 batch_time=0.38648 
Train Epoch: 38 [401/500 25664/32000 (80%)] Loss: 1.18258 (QuantReg: 15.75049) QuantErr: 15.75049 batch_time=0.40983 
Train Epoch: 38 [409/500 26176/32000 (82%)] Loss: 0.96816 (QuantReg: 15.81980) QuantErr: 15.81980 batch_time=0.38916 
Train Epoch: 38 [417/500 26688/32000 (83%)] Loss: 1.14869 (QuantReg: 16.05342) QuantErr: 16.05342 batch_time=0.41267 
Train Epoch: 38 [425/500 27200/32000 (85%)] Loss: 0.84315 (QuantReg: 15.73301) QuantErr: 15.73301 batch_time=0.39287 
Train Epoch: 38 [433/500 27712/32000 (87%)] Loss: 0.95189 (QuantReg: 15.72030) QuantErr: 15.72030 batch_time=0.38756 
Train Epoch: 38 [441/500 28224/32000 (88%)] Loss: 0.79820 (QuantReg: 15.87828) QuantErr: 15.87828 batch_time=0.39488 
Train Epoch: 38 [449/500 28736/32000 (90%)] Loss: 1.14897 (QuantReg: 15.94253) QuantErr: 15.94253 batch_time=1.06284 
Train Epoch: 38 [457/500 29248/32000 (91%)] Loss: 0.95377 (QuantReg: 15.94552) QuantErr: 15.94552 batch_time=0.39022 
Train Epoch: 38 [465/500 29760/32000 (93%)] Loss: 0.83928 (QuantReg: 15.88266) QuantErr: 15.88266 batch_time=0.38097 
Train Epoch: 38 [473/500 30272/32000 (95%)] Loss: 0.66514 (QuantReg: 15.84995) QuantErr: 15.84995 batch_time=0.38215 
Train Epoch: 38 [481/500 30784/32000 (96%)] Loss: 1.15238 (QuantReg: 15.87450) QuantErr: 15.87450 batch_time=0.38368 
Train Epoch: 38 [489/500 31296/32000 (98%)] Loss: 0.99279 (QuantReg: 15.82232) QuantErr: 15.82232 batch_time=0.38416 
Train Epoch: 38 [497/500 31808/32000 (99%)] Loss: 0.90089 (QuantReg: 15.92145) QuantErr: 15.92145 batch_time=0.38550 
Train Epoch: 38 codebook_update_time=1.93825
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch38.pth ...
Done in 5.032s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.011545245885849
 quant_reg      : 15.81764554977417
 quant_err      : 15.81764554977417
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 19000
 LSMDC_full_test/t2v_metrics/R1: 12.6
 LSMDC_full_test/t2v_metrics/R5: 31.2
 LSMDC_full_test/t2v_metrics/R10: 40.4
 LSMDC_full_test/t2v_metrics/R50: 65.7
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 78.781
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.136347291431033
 LSMDC_full_test/v2t_metrics/R1: 13.1
 LSMDC_full_test/v2t_metrics/R5: 31.0
 LSMDC_full_test/v2t_metrics/R10: 40.2
 LSMDC_full_test/v2t_metrics/R50: 66.7
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 76.691
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.3680069221594
 mnt_best       : 25.975252586423483
 not_improved_count: 6
Train Epoch: 39 [1/500 64/32000 (0%)] Loss: 0.97986 (QuantReg: 16.17864) QuantErr: 16.17864 batch_time=16.38977 
Train Epoch: 39 [9/500 576/32000 (2%)] Loss: 1.09127 (QuantReg: 15.76720) QuantErr: 15.76720 batch_time=0.38597 
Train Epoch: 39 [17/500 1088/32000 (3%)] Loss: 0.86028 (QuantReg: 15.70252) QuantErr: 15.70252 batch_time=0.38955 
Train Epoch: 39 [25/500 1600/32000 (5%)] Loss: 1.26722 (QuantReg: 15.87492) QuantErr: 15.87492 batch_time=0.37949 
Train Epoch: 39 [33/500 2112/32000 (7%)] Loss: 0.90636 (QuantReg: 15.85005) QuantErr: 15.85005 batch_time=0.39110 
Train Epoch: 39 [41/500 2624/32000 (8%)] Loss: 0.98402 (QuantReg: 15.67917) QuantErr: 15.67917 batch_time=0.38840 
Train Epoch: 39 [49/500 3136/32000 (10%)] Loss: 0.71254 (QuantReg: 15.87605) QuantErr: 15.87605 batch_time=0.38115 
Train Epoch: 39 [57/500 3648/32000 (11%)] Loss: 1.17251 (QuantReg: 15.65364) QuantErr: 15.65364 batch_time=0.38187 
Train Epoch: 39 [65/500 4160/32000 (13%)] Loss: 0.82438 (QuantReg: 15.98422) QuantErr: 15.98422 batch_time=0.92263 
Train Epoch: 39 [73/500 4672/32000 (15%)] Loss: 1.01360 (QuantReg: 15.65457) QuantErr: 15.65457 batch_time=0.41669 
Train Epoch: 39 [81/500 5184/32000 (16%)] Loss: 1.08057 (QuantReg: 15.69243) QuantErr: 15.69243 batch_time=0.38166 
Train Epoch: 39 [89/500 5696/32000 (18%)] Loss: 0.98961 (QuantReg: 15.91269) QuantErr: 15.91269 batch_time=0.37612 
Train Epoch: 39 [97/500 6208/32000 (19%)] Loss: 0.92193 (QuantReg: 15.66810) QuantErr: 15.66810 batch_time=0.38441 
Train Epoch: 39 [105/500 6720/32000 (21%)] Loss: 1.18449 (QuantReg: 15.62182) QuantErr: 15.62182 batch_time=0.39606 
Train Epoch: 39 [113/500 7232/32000 (23%)] Loss: 0.67338 (QuantReg: 15.88986) QuantErr: 15.88986 batch_time=0.39201 
Train Epoch: 39 [121/500 7744/32000 (24%)] Loss: 0.88663 (QuantReg: 15.83587) QuantErr: 15.83587 batch_time=0.37418 
Train Epoch: 39 [129/500 8256/32000 (26%)] Loss: 1.01243 (QuantReg: 15.96775) QuantErr: 15.96775 batch_time=0.89274 
Train Epoch: 39 [137/500 8768/32000 (27%)] Loss: 1.06393 (QuantReg: 15.75053) QuantErr: 15.75053 batch_time=0.37590 
Train Epoch: 39 [145/500 9280/32000 (29%)] Loss: 0.61646 (QuantReg: 15.77027) QuantErr: 15.77027 batch_time=0.37134 
Train Epoch: 39 [153/500 9792/32000 (31%)] Loss: 0.86515 (QuantReg: 15.82987) QuantErr: 15.82987 batch_time=0.37461 
Train Epoch: 39 [161/500 10304/32000 (32%)] Loss: 0.97456 (QuantReg: 15.72111) QuantErr: 15.72111 batch_time=0.37391 
Train Epoch: 39 [169/500 10816/32000 (34%)] Loss: 0.92390 (QuantReg: 15.96584) QuantErr: 15.96584 batch_time=0.39249 
Train Epoch: 39 [177/500 11328/32000 (35%)] Loss: 1.43721 (QuantReg: 15.88525) QuantErr: 15.88525 batch_time=0.37058 
Train Epoch: 39 [185/500 11840/32000 (37%)] Loss: 0.87992 (QuantReg: 16.01099) QuantErr: 16.01099 batch_time=0.37622 
Train Epoch: 39 [193/500 12352/32000 (39%)] Loss: 1.00654 (QuantReg: 15.89268) QuantErr: 15.89268 batch_time=0.89326 
Train Epoch: 39 [201/500 12864/32000 (40%)] Loss: 0.86543 (QuantReg: 15.82825) QuantErr: 15.82825 batch_time=0.41726 
Train Epoch: 39 [209/500 13376/32000 (42%)] Loss: 0.74835 (QuantReg: 15.80582) QuantErr: 15.80582 batch_time=0.37995 
Train Epoch: 39 [217/500 13888/32000 (43%)] Loss: 1.02278 (QuantReg: 15.57838) QuantErr: 15.57838 batch_time=0.37989 
Train Epoch: 39 [225/500 14400/32000 (45%)] Loss: 0.97394 (QuantReg: 15.92896) QuantErr: 15.92896 batch_time=0.36866 
Train Epoch: 39 [233/500 14912/32000 (47%)] Loss: 0.94628 (QuantReg: 15.94271) QuantErr: 15.94271 batch_time=0.37283 
Train Epoch: 39 [241/500 15424/32000 (48%)] Loss: 0.94533 (QuantReg: 15.63272) QuantErr: 15.63272 batch_time=0.37078 
Train Epoch: 39 [249/500 15936/32000 (50%)] Loss: 1.37990 (QuantReg: 16.04732) QuantErr: 16.04732 batch_time=0.37409 
Train Epoch: 39 [257/500 16448/32000 (51%)] Loss: 1.32793 (QuantReg: 15.90616) QuantErr: 15.90616 batch_time=0.90091 
Train Epoch: 39 [265/500 16960/32000 (53%)] Loss: 0.94933 (QuantReg: 15.76220) QuantErr: 15.76220 batch_time=0.38023 
Train Epoch: 39 [273/500 17472/32000 (55%)] Loss: 1.13144 (QuantReg: 15.78738) QuantErr: 15.78738 batch_time=0.37053 
Train Epoch: 39 [281/500 17984/32000 (56%)] Loss: 0.75627 (QuantReg: 15.78352) QuantErr: 15.78352 batch_time=0.41175 
Train Epoch: 39 [289/500 18496/32000 (58%)] Loss: 0.63284 (QuantReg: 15.76612) QuantErr: 15.76612 batch_time=0.39171 
Train Epoch: 39 [297/500 19008/32000 (59%)] Loss: 1.03720 (QuantReg: 15.76964) QuantErr: 15.76964 batch_time=0.38443 
Train Epoch: 39 [305/500 19520/32000 (61%)] Loss: 0.97697 (QuantReg: 15.81956) QuantErr: 15.81956 batch_time=0.37475 
Train Epoch: 39 [313/500 20032/32000 (63%)] Loss: 0.98113 (QuantReg: 15.74044) QuantErr: 15.74044 batch_time=0.38871 
Train Epoch: 39 [321/500 20544/32000 (64%)] Loss: 0.90865 (QuantReg: 15.90459) QuantErr: 15.90459 batch_time=0.87130 
Train Epoch: 39 [329/500 21056/32000 (66%)] Loss: 1.01228 (QuantReg: 16.03080) QuantErr: 16.03080 batch_time=0.37012 
Train Epoch: 39 [337/500 21568/32000 (67%)] Loss: 1.12123 (QuantReg: 15.88141) QuantErr: 15.88141 batch_time=0.38050 
Train Epoch: 39 [345/500 22080/32000 (69%)] Loss: 0.83014 (QuantReg: 15.92112) QuantErr: 15.92112 batch_time=0.38178 
Train Epoch: 39 [353/500 22592/32000 (71%)] Loss: 1.22898 (QuantReg: 15.72659) QuantErr: 15.72659 batch_time=0.38962 
Train Epoch: 39 [361/500 23104/32000 (72%)] Loss: 1.19170 (QuantReg: 15.68640) QuantErr: 15.68640 batch_time=0.38170 
Train Epoch: 39 [369/500 23616/32000 (74%)] Loss: 0.88748 (QuantReg: 15.89322) QuantErr: 15.89322 batch_time=0.37142 
Train Epoch: 39 [377/500 24128/32000 (75%)] Loss: 0.91946 (QuantReg: 15.86876) QuantErr: 15.86876 batch_time=0.37306 
Train Epoch: 39 [385/500 24640/32000 (77%)] Loss: 0.84177 (QuantReg: 15.73888) QuantErr: 15.73888 batch_time=0.90341 
Train Epoch: 39 [393/500 25152/32000 (79%)] Loss: 0.69385 (QuantReg: 15.94923) QuantErr: 15.94923 batch_time=0.41661 
Train Epoch: 39 [401/500 25664/32000 (80%)] Loss: 1.18050 (QuantReg: 15.80793) QuantErr: 15.80793 batch_time=0.37882 
Train Epoch: 39 [409/500 26176/32000 (82%)] Loss: 0.80601 (QuantReg: 15.92625) QuantErr: 15.92625 batch_time=0.40230 
Train Epoch: 39 [417/500 26688/32000 (83%)] Loss: 1.18408 (QuantReg: 15.73973) QuantErr: 15.73973 batch_time=0.39573 
Train Epoch: 39 [425/500 27200/32000 (85%)] Loss: 1.00224 (QuantReg: 15.79736) QuantErr: 15.79736 batch_time=0.38600 
Train Epoch: 39 [433/500 27712/32000 (87%)] Loss: 1.13100 (QuantReg: 15.93096) QuantErr: 15.93096 batch_time=0.40888 
Train Epoch: 39 [441/500 28224/32000 (88%)] Loss: 0.94733 (QuantReg: 15.81044) QuantErr: 15.81044 batch_time=0.40987 
Train Epoch: 39 [449/500 28736/32000 (90%)] Loss: 0.97416 (QuantReg: 15.78032) QuantErr: 15.78032 batch_time=0.94727 
Train Epoch: 39 [457/500 29248/32000 (91%)] Loss: 1.04449 (QuantReg: 15.90874) QuantErr: 15.90874 batch_time=0.41366 
Train Epoch: 39 [465/500 29760/32000 (93%)] Loss: 1.01081 (QuantReg: 15.83042) QuantErr: 15.83042 batch_time=0.37794 
Train Epoch: 39 [473/500 30272/32000 (95%)] Loss: 0.75728 (QuantReg: 15.71318) QuantErr: 15.71318 batch_time=0.36966 
Train Epoch: 39 [481/500 30784/32000 (96%)] Loss: 0.99527 (QuantReg: 15.59943) QuantErr: 15.59943 batch_time=0.38174 
Train Epoch: 39 [489/500 31296/32000 (98%)] Loss: 0.72215 (QuantReg: 15.92230) QuantErr: 15.92230 batch_time=0.37867 
Train Epoch: 39 [497/500 31808/32000 (99%)] Loss: 0.73869 (QuantReg: 15.90050) QuantErr: 15.90050 batch_time=0.37916 
Train Epoch: 39 codebook_update_time=2.05159
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch39.pth ...
Done in 6.044s
removing stale ckpt [epoch 38] [took 0.01s]
 epoch          : 39
 loss           : 0.9939232453107834
 quant_reg      : 15.824601905822753
 quant_err      : 15.824601905822753
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 19500
 LSMDC_full_test/t2v_metrics/R1: 12.6
 LSMDC_full_test/t2v_metrics/R5: 31.0
 LSMDC_full_test/t2v_metrics/R10: 40.4
 LSMDC_full_test/t2v_metrics/R50: 67.0
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 77.85
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.082521971918354
 LSMDC_full_test/v2t_metrics/R1: 12.3
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 39.9
 LSMDC_full_test/v2t_metrics/R50: 66.6
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 76.35
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.884899151724873
 mnt_best       : 25.975252586423483
 not_improved_count: 7
Train Epoch: 40 [1/500 64/32000 (0%)] Loss: 0.94592 (QuantReg: 15.83188) QuantErr: 15.83188 batch_time=20.81101 
Train Epoch: 40 [9/500 576/32000 (2%)] Loss: 1.15399 (QuantReg: 15.86472) QuantErr: 15.86472 batch_time=0.38274 
Train Epoch: 40 [17/500 1088/32000 (3%)] Loss: 0.98582 (QuantReg: 15.98298) QuantErr: 15.98298 batch_time=0.38522 
Train Epoch: 40 [25/500 1600/32000 (5%)] Loss: 1.00239 (QuantReg: 15.72091) QuantErr: 15.72091 batch_time=0.37741 
Train Epoch: 40 [33/500 2112/32000 (7%)] Loss: 0.69700 (QuantReg: 15.78679) QuantErr: 15.78679 batch_time=0.39755 
Train Epoch: 40 [41/500 2624/32000 (8%)] Loss: 1.06465 (QuantReg: 15.68713) QuantErr: 15.68713 batch_time=0.38277 
Train Epoch: 40 [49/500 3136/32000 (10%)] Loss: 0.87151 (QuantReg: 15.75417) QuantErr: 15.75417 batch_time=0.37776 
Train Epoch: 40 [57/500 3648/32000 (11%)] Loss: 0.89003 (QuantReg: 15.64917) QuantErr: 15.64917 batch_time=0.38321 
Train Epoch: 40 [65/500 4160/32000 (13%)] Loss: 0.90870 (QuantReg: 15.79556) QuantErr: 15.79556 batch_time=2.97778 
Train Epoch: 40 [73/500 4672/32000 (15%)] Loss: 1.00671 (QuantReg: 15.76890) QuantErr: 15.76890 batch_time=0.39683 
Train Epoch: 40 [81/500 5184/32000 (16%)] Loss: 0.80096 (QuantReg: 15.88053) QuantErr: 15.88053 batch_time=0.38922 
Train Epoch: 40 [89/500 5696/32000 (18%)] Loss: 0.89329 (QuantReg: 15.75108) QuantErr: 15.75108 batch_time=0.38482 
Train Epoch: 40 [97/500 6208/32000 (19%)] Loss: 0.71024 (QuantReg: 15.71398) QuantErr: 15.71398 batch_time=0.39391 
Train Epoch: 40 [105/500 6720/32000 (21%)] Loss: 0.91698 (QuantReg: 15.72625) QuantErr: 15.72625 batch_time=0.38088 
Train Epoch: 40 [113/500 7232/32000 (23%)] Loss: 0.98825 (QuantReg: 15.65722) QuantErr: 15.65722 batch_time=0.39297 
Train Epoch: 40 [121/500 7744/32000 (24%)] Loss: 0.71877 (QuantReg: 15.95183) QuantErr: 15.95183 batch_time=0.38704 
Train Epoch: 40 [129/500 8256/32000 (26%)] Loss: 1.05173 (QuantReg: 15.90411) QuantErr: 15.90411 batch_time=3.39937 
Train Epoch: 40 [137/500 8768/32000 (27%)] Loss: 1.13290 (QuantReg: 15.84448) QuantErr: 15.84448 batch_time=0.38394 
Train Epoch: 40 [145/500 9280/32000 (29%)] Loss: 0.90403 (QuantReg: 15.78200) QuantErr: 15.78200 batch_time=0.39439 
Train Epoch: 40 [153/500 9792/32000 (31%)] Loss: 1.11678 (QuantReg: 15.79201) QuantErr: 15.79201 batch_time=0.41835 
Train Epoch: 40 [161/500 10304/32000 (32%)] Loss: 1.15390 (QuantReg: 15.72719) QuantErr: 15.72719 batch_time=0.38727 
Train Epoch: 40 [169/500 10816/32000 (34%)] Loss: 1.11915 (QuantReg: 15.78813) QuantErr: 15.78813 batch_time=0.39530 
Train Epoch: 40 [177/500 11328/32000 (35%)] Loss: 0.74086 (QuantReg: 15.55248) QuantErr: 15.55248 batch_time=0.38693 
Train Epoch: 40 [185/500 11840/32000 (37%)] Loss: 1.03555 (QuantReg: 15.62085) QuantErr: 15.62085 batch_time=0.40131 
Train Epoch: 40 [193/500 12352/32000 (39%)] Loss: 0.77324 (QuantReg: 15.85229) QuantErr: 15.85229 batch_time=3.37711 
Train Epoch: 40 [201/500 12864/32000 (40%)] Loss: 0.68990 (QuantReg: 15.73339) QuantErr: 15.73339 batch_time=0.39201 
Train Epoch: 40 [209/500 13376/32000 (42%)] Loss: 0.94269 (QuantReg: 15.60699) QuantErr: 15.60699 batch_time=0.38925 
Train Epoch: 40 [217/500 13888/32000 (43%)] Loss: 1.08465 (QuantReg: 15.95301) QuantErr: 15.95301 batch_time=0.38164 
Train Epoch: 40 [225/500 14400/32000 (45%)] Loss: 0.85086 (QuantReg: 15.95466) QuantErr: 15.95466 batch_time=0.39076 
Train Epoch: 40 [233/500 14912/32000 (47%)] Loss: 0.85327 (QuantReg: 15.82386) QuantErr: 15.82386 batch_time=0.39464 
Train Epoch: 40 [241/500 15424/32000 (48%)] Loss: 0.98661 (QuantReg: 15.89837) QuantErr: 15.89837 batch_time=0.40018 
Train Epoch: 40 [249/500 15936/32000 (50%)] Loss: 1.07752 (QuantReg: 15.91278) QuantErr: 15.91278 batch_time=0.39329 
Train Epoch: 40 [257/500 16448/32000 (51%)] Loss: 0.83328 (QuantReg: 15.86155) QuantErr: 15.86155 batch_time=3.42537 
Train Epoch: 40 [265/500 16960/32000 (53%)] Loss: 0.84190 (QuantReg: 15.54974) QuantErr: 15.54974 batch_time=0.38483 
Train Epoch: 40 [273/500 17472/32000 (55%)] Loss: 0.91882 (QuantReg: 15.72206) QuantErr: 15.72206 batch_time=0.38300 
Train Epoch: 40 [281/500 17984/32000 (56%)] Loss: 0.82151 (QuantReg: 15.77702) QuantErr: 15.77702 batch_time=0.38494 
Train Epoch: 40 [289/500 18496/32000 (58%)] Loss: 1.28956 (QuantReg: 16.01302) QuantErr: 16.01302 batch_time=0.38357 
Train Epoch: 40 [297/500 19008/32000 (59%)] Loss: 1.27958 (QuantReg: 15.63326) QuantErr: 15.63326 batch_time=0.38480 
Train Epoch: 40 [305/500 19520/32000 (61%)] Loss: 1.06678 (QuantReg: 16.05816) QuantErr: 16.05816 batch_time=0.38159 
Train Epoch: 40 [313/500 20032/32000 (63%)] Loss: 1.05677 (QuantReg: 15.94282) QuantErr: 15.94282 batch_time=0.38588 
Train Epoch: 40 [321/500 20544/32000 (64%)] Loss: 0.91476 (QuantReg: 15.87796) QuantErr: 15.87796 batch_time=3.36617 
Train Epoch: 40 [329/500 21056/32000 (66%)] Loss: 0.95080 (QuantReg: 15.86039) QuantErr: 15.86039 batch_time=0.38610 
Train Epoch: 40 [337/500 21568/32000 (67%)] Loss: 0.69657 (QuantReg: 15.75898) QuantErr: 15.75898 batch_time=0.38676 
Train Epoch: 40 [345/500 22080/32000 (69%)] Loss: 1.08528 (QuantReg: 15.88548) QuantErr: 15.88548 batch_time=0.38264 
Train Epoch: 40 [353/500 22592/32000 (71%)] Loss: 1.27656 (QuantReg: 15.74080) QuantErr: 15.74080 batch_time=0.40028 
Train Epoch: 40 [361/500 23104/32000 (72%)] Loss: 1.08228 (QuantReg: 16.06567) QuantErr: 16.06567 batch_time=0.38075 
Train Epoch: 40 [369/500 23616/32000 (74%)] Loss: 1.00565 (QuantReg: 15.53676) QuantErr: 15.53676 batch_time=0.38495 
Train Epoch: 40 [377/500 24128/32000 (75%)] Loss: 0.90310 (QuantReg: 15.76745) QuantErr: 15.76745 batch_time=0.39410 
Train Epoch: 40 [385/500 24640/32000 (77%)] Loss: 0.97860 (QuantReg: 15.69894) QuantErr: 15.69894 batch_time=3.36616 
Train Epoch: 40 [393/500 25152/32000 (79%)] Loss: 1.00064 (QuantReg: 15.98320) QuantErr: 15.98320 batch_time=0.39618 
Train Epoch: 40 [401/500 25664/32000 (80%)] Loss: 0.75234 (QuantReg: 16.00511) QuantErr: 16.00511 batch_time=0.38573 
Train Epoch: 40 [409/500 26176/32000 (82%)] Loss: 1.13520 (QuantReg: 15.98214) QuantErr: 15.98214 batch_time=0.38816 
Train Epoch: 40 [417/500 26688/32000 (83%)] Loss: 1.31676 (QuantReg: 15.83840) QuantErr: 15.83840 batch_time=0.38665 
Train Epoch: 40 [425/500 27200/32000 (85%)] Loss: 1.36460 (QuantReg: 15.91234) QuantErr: 15.91234 batch_time=0.38944 
Train Epoch: 40 [433/500 27712/32000 (87%)] Loss: 0.96740 (QuantReg: 15.91322) QuantErr: 15.91322 batch_time=0.38214 
Train Epoch: 40 [441/500 28224/32000 (88%)] Loss: 0.86422 (QuantReg: 15.92807) QuantErr: 15.92807 batch_time=0.38532 
Train Epoch: 40 [449/500 28736/32000 (90%)] Loss: 1.01488 (QuantReg: 16.02681) QuantErr: 16.02681 batch_time=3.34490 
Train Epoch: 40 [457/500 29248/32000 (91%)] Loss: 1.06549 (QuantReg: 15.91231) QuantErr: 15.91231 batch_time=0.39276 
Train Epoch: 40 [465/500 29760/32000 (93%)] Loss: 0.90890 (QuantReg: 15.76204) QuantErr: 15.76204 batch_time=0.43911 
Train Epoch: 40 [473/500 30272/32000 (95%)] Loss: 1.22360 (QuantReg: 15.73168) QuantErr: 15.73168 batch_time=0.38532 
Train Epoch: 40 [481/500 30784/32000 (96%)] Loss: 0.83407 (QuantReg: 15.82012) QuantErr: 15.82012 batch_time=0.38726 
Train Epoch: 40 [489/500 31296/32000 (98%)] Loss: 1.47749 (QuantReg: 15.80833) QuantErr: 15.80833 batch_time=0.38496 
Train Epoch: 40 [497/500 31808/32000 (99%)] Loss: 1.31230 (QuantReg: 15.95098) QuantErr: 15.95098 batch_time=0.38006 
Train Epoch: 40 codebook_update_time=1.88953
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch40.pth ...
Done in 6.106s
removing stale ckpt [epoch 39] [took 0.14s]
 epoch          : 40
 loss           : 0.9882621259689331
 quant_reg      : 15.826772735595704
 quant_err      : 15.826772735595704
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 20000
 LSMDC_full_test/t2v_metrics/R1: 12.4
 LSMDC_full_test/t2v_metrics/R5: 30.0
 LSMDC_full_test/t2v_metrics/R10: 40.9
 LSMDC_full_test/t2v_metrics/R50: 66.0
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 78.451
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.779283775169073
 LSMDC_full_test/v2t_metrics/R1: 13.4
 LSMDC_full_test/v2t_metrics/R5: 30.4
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 65.8
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 77.676
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.373142090183368
 mnt_best       : 25.975252586423483
 not_improved_count: 8
Train Epoch: 41 [1/500 64/32000 (0%)] Loss: 1.13382 (QuantReg: 16.01757) QuantErr: 16.01757 batch_time=16.27793 
Train Epoch: 41 [9/500 576/32000 (2%)] Loss: 0.84911 (QuantReg: 15.84151) QuantErr: 15.84151 batch_time=0.38018 
Train Epoch: 41 [17/500 1088/32000 (3%)] Loss: 0.95008 (QuantReg: 15.77621) QuantErr: 15.77621 batch_time=0.37856 
Train Epoch: 41 [25/500 1600/32000 (5%)] Loss: 0.88472 (QuantReg: 15.88132) QuantErr: 15.88132 batch_time=0.37954 
Train Epoch: 41 [33/500 2112/32000 (7%)] Loss: 0.90946 (QuantReg: 16.02399) QuantErr: 16.02399 batch_time=0.37902 
Train Epoch: 41 [41/500 2624/32000 (8%)] Loss: 0.78755 (QuantReg: 15.78336) QuantErr: 15.78336 batch_time=0.37220 
Train Epoch: 41 [49/500 3136/32000 (10%)] Loss: 0.81755 (QuantReg: 15.79545) QuantErr: 15.79545 batch_time=0.37366 
Train Epoch: 41 [57/500 3648/32000 (11%)] Loss: 1.17627 (QuantReg: 15.77802) QuantErr: 15.77802 batch_time=0.40248 
Train Epoch: 41 [65/500 4160/32000 (13%)] Loss: 0.94107 (QuantReg: 15.85880) QuantErr: 15.85880 batch_time=1.01358 
Train Epoch: 41 [73/500 4672/32000 (15%)] Loss: 1.05000 (QuantReg: 15.86529) QuantErr: 15.86529 batch_time=0.38351 
Train Epoch: 41 [81/500 5184/32000 (16%)] Loss: 1.24368 (QuantReg: 15.93891) QuantErr: 15.93891 batch_time=0.38375 
Train Epoch: 41 [89/500 5696/32000 (18%)] Loss: 0.85355 (QuantReg: 15.78841) QuantErr: 15.78841 batch_time=0.39905 
Train Epoch: 41 [97/500 6208/32000 (19%)] Loss: 1.00183 (QuantReg: 15.69915) QuantErr: 15.69915 batch_time=0.37870 
Train Epoch: 41 [105/500 6720/32000 (21%)] Loss: 0.99177 (QuantReg: 15.74801) QuantErr: 15.74801 batch_time=0.38591 
Train Epoch: 41 [113/500 7232/32000 (23%)] Loss: 0.91800 (QuantReg: 15.75227) QuantErr: 15.75227 batch_time=0.39025 
Train Epoch: 41 [121/500 7744/32000 (24%)] Loss: 1.25834 (QuantReg: 15.97013) QuantErr: 15.97013 batch_time=0.43640 
Train Epoch: 41 [129/500 8256/32000 (26%)] Loss: 1.05461 (QuantReg: 15.94525) QuantErr: 15.94525 batch_time=1.04359 
Train Epoch: 41 [137/500 8768/32000 (27%)] Loss: 1.02913 (QuantReg: 15.81963) QuantErr: 15.81963 batch_time=0.37521 
Train Epoch: 41 [145/500 9280/32000 (29%)] Loss: 1.38326 (QuantReg: 15.70838) QuantErr: 15.70838 batch_time=0.37571 
Train Epoch: 41 [153/500 9792/32000 (31%)] Loss: 1.16378 (QuantReg: 15.47359) QuantErr: 15.47359 batch_time=0.38639 
Train Epoch: 41 [161/500 10304/32000 (32%)] Loss: 0.82289 (QuantReg: 15.74521) QuantErr: 15.74521 batch_time=0.38806 
Train Epoch: 41 [169/500 10816/32000 (34%)] Loss: 1.02971 (QuantReg: 15.82764) QuantErr: 15.82764 batch_time=0.38603 
Train Epoch: 41 [177/500 11328/32000 (35%)] Loss: 0.74896 (QuantReg: 15.88574) QuantErr: 15.88574 batch_time=0.37522 
Train Epoch: 41 [185/500 11840/32000 (37%)] Loss: 0.83889 (QuantReg: 15.94630) QuantErr: 15.94630 batch_time=0.38028 
Train Epoch: 41 [193/500 12352/32000 (39%)] Loss: 0.92696 (QuantReg: 15.84165) QuantErr: 15.84165 batch_time=1.04611 
Train Epoch: 41 [201/500 12864/32000 (40%)] Loss: 0.67106 (QuantReg: 15.93659) QuantErr: 15.93659 batch_time=0.39981 
Train Epoch: 41 [209/500 13376/32000 (42%)] Loss: 0.97090 (QuantReg: 15.89330) QuantErr: 15.89330 batch_time=0.38451 
Train Epoch: 41 [217/500 13888/32000 (43%)] Loss: 0.96777 (QuantReg: 15.68217) QuantErr: 15.68217 batch_time=0.39369 
Train Epoch: 41 [225/500 14400/32000 (45%)] Loss: 0.84219 (QuantReg: 15.76260) QuantErr: 15.76260 batch_time=0.38455 
Train Epoch: 41 [233/500 14912/32000 (47%)] Loss: 0.98849 (QuantReg: 15.99079) QuantErr: 15.99079 batch_time=0.37989 
Train Epoch: 41 [241/500 15424/32000 (48%)] Loss: 1.30410 (QuantReg: 15.64451) QuantErr: 15.64451 batch_time=0.38317 
Train Epoch: 41 [249/500 15936/32000 (50%)] Loss: 1.08044 (QuantReg: 15.78660) QuantErr: 15.78660 batch_time=0.38260 
Train Epoch: 41 [257/500 16448/32000 (51%)] Loss: 0.76072 (QuantReg: 15.78771) QuantErr: 15.78771 batch_time=1.04266 
Train Epoch: 41 [265/500 16960/32000 (53%)] Loss: 0.91072 (QuantReg: 15.80408) QuantErr: 15.80408 batch_time=0.39313 
Train Epoch: 41 [273/500 17472/32000 (55%)] Loss: 0.88817 (QuantReg: 15.77476) QuantErr: 15.77476 batch_time=0.38083 
Train Epoch: 41 [281/500 17984/32000 (56%)] Loss: 0.76766 (QuantReg: 15.98645) QuantErr: 15.98645 batch_time=0.38790 
Train Epoch: 41 [289/500 18496/32000 (58%)] Loss: 1.18848 (QuantReg: 16.03758) QuantErr: 16.03758 batch_time=0.42943 
Train Epoch: 41 [297/500 19008/32000 (59%)] Loss: 0.72090 (QuantReg: 15.49708) QuantErr: 15.49708 batch_time=0.42288 
Train Epoch: 41 [305/500 19520/32000 (61%)] Loss: 1.18899 (QuantReg: 15.44654) QuantErr: 15.44654 batch_time=0.38130 
Train Epoch: 41 [313/500 20032/32000 (63%)] Loss: 1.39039 (QuantReg: 15.95470) QuantErr: 15.95470 batch_time=0.39232 
Train Epoch: 41 [321/500 20544/32000 (64%)] Loss: 1.05773 (QuantReg: 15.94644) QuantErr: 15.94644 batch_time=1.02784 
Train Epoch: 41 [329/500 21056/32000 (66%)] Loss: 0.77347 (QuantReg: 15.83231) QuantErr: 15.83231 batch_time=0.38336 
Train Epoch: 41 [337/500 21568/32000 (67%)] Loss: 1.00760 (QuantReg: 15.91476) QuantErr: 15.91476 batch_time=0.37736 
Train Epoch: 41 [345/500 22080/32000 (69%)] Loss: 1.24353 (QuantReg: 15.80760) QuantErr: 15.80760 batch_time=0.37973 
Train Epoch: 41 [353/500 22592/32000 (71%)] Loss: 1.02058 (QuantReg: 15.71143) QuantErr: 15.71143 batch_time=0.38562 
Train Epoch: 41 [361/500 23104/32000 (72%)] Loss: 1.11394 (QuantReg: 15.98083) QuantErr: 15.98083 batch_time=0.39039 
Train Epoch: 41 [369/500 23616/32000 (74%)] Loss: 0.97520 (QuantReg: 15.76078) QuantErr: 15.76078 batch_time=0.37752 
Train Epoch: 41 [377/500 24128/32000 (75%)] Loss: 1.09864 (QuantReg: 15.96731) QuantErr: 15.96731 batch_time=0.39096 
Train Epoch: 41 [385/500 24640/32000 (77%)] Loss: 0.90979 (QuantReg: 15.90379) QuantErr: 15.90379 batch_time=1.03127 
Train Epoch: 41 [393/500 25152/32000 (79%)] Loss: 1.00798 (QuantReg: 15.73476) QuantErr: 15.73476 batch_time=0.37626 
Train Epoch: 41 [401/500 25664/32000 (80%)] Loss: 0.80261 (QuantReg: 15.69599) QuantErr: 15.69599 batch_time=0.40392 
Train Epoch: 41 [409/500 26176/32000 (82%)] Loss: 0.90866 (QuantReg: 16.01456) QuantErr: 16.01456 batch_time=0.37949 
Train Epoch: 41 [417/500 26688/32000 (83%)] Loss: 0.84971 (QuantReg: 15.63094) QuantErr: 15.63094 batch_time=0.38790 
Train Epoch: 41 [425/500 27200/32000 (85%)] Loss: 1.07777 (QuantReg: 15.75673) QuantErr: 15.75673 batch_time=0.38239 
Train Epoch: 41 [433/500 27712/32000 (87%)] Loss: 0.98579 (QuantReg: 15.76982) QuantErr: 15.76982 batch_time=0.38338 
Train Epoch: 41 [441/500 28224/32000 (88%)] Loss: 1.05999 (QuantReg: 15.89379) QuantErr: 15.89379 batch_time=0.38895 
Train Epoch: 41 [449/500 28736/32000 (90%)] Loss: 0.81377 (QuantReg: 15.96646) QuantErr: 15.96646 batch_time=1.00816 
Train Epoch: 41 [457/500 29248/32000 (91%)] Loss: 0.94559 (QuantReg: 15.83609) QuantErr: 15.83609 batch_time=0.39610 
Train Epoch: 41 [465/500 29760/32000 (93%)] Loss: 1.21799 (QuantReg: 16.08676) QuantErr: 16.08676 batch_time=0.38084 
Train Epoch: 41 [473/500 30272/32000 (95%)] Loss: 0.81379 (QuantReg: 15.79165) QuantErr: 15.79165 batch_time=0.39140 
Train Epoch: 41 [481/500 30784/32000 (96%)] Loss: 1.07495 (QuantReg: 15.80078) QuantErr: 15.80078 batch_time=0.38742 
Train Epoch: 41 [489/500 31296/32000 (98%)] Loss: 0.77465 (QuantReg: 15.72111) QuantErr: 15.72111 batch_time=0.39200 
Train Epoch: 41 [497/500 31808/32000 (99%)] Loss: 0.92502 (QuantReg: 16.01994) QuantErr: 16.01994 batch_time=0.40200 
Train Epoch: 41 codebook_update_time=2.00623
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch41.pth ...
Done in 4.917s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 0.9856757526397705
 quant_reg      : 15.822029453277588
 quant_err      : 15.822029453277588
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 20500
 LSMDC_full_test/t2v_metrics/R1: 12.6
 LSMDC_full_test/t2v_metrics/R5: 31.1
 LSMDC_full_test/t2v_metrics/R10: 40.9
 LSMDC_full_test/t2v_metrics/R50: 66.0
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 79.26
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.212625948100957
 LSMDC_full_test/v2t_metrics/R1: 12.6
 LSMDC_full_test/v2t_metrics/R5: 31.0
 LSMDC_full_test/v2t_metrics/R10: 39.9
 LSMDC_full_test/v2t_metrics/R50: 65.1
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 80.57
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.978616381515945
 mnt_best       : 25.975252586423483
 not_improved_count: 9
Train Epoch: 42 [1/500 64/32000 (0%)] Loss: 1.11425 (QuantReg: 15.98825) QuantErr: 15.98825 batch_time=15.74010 
Train Epoch: 42 [9/500 576/32000 (2%)] Loss: 0.95174 (QuantReg: 15.81939) QuantErr: 15.81939 batch_time=1.13896 
Train Epoch: 42 [17/500 1088/32000 (3%)] Loss: 0.85144 (QuantReg: 15.96415) QuantErr: 15.96415 batch_time=0.58193 
Train Epoch: 42 [25/500 1600/32000 (5%)] Loss: 1.37011 (QuantReg: 15.84754) QuantErr: 15.84754 batch_time=0.41728 
Train Epoch: 42 [33/500 2112/32000 (7%)] Loss: 1.04658 (QuantReg: 15.86868) QuantErr: 15.86868 batch_time=0.41650 
Train Epoch: 42 [41/500 2624/32000 (8%)] Loss: 0.85791 (QuantReg: 15.84457) QuantErr: 15.84457 batch_time=0.37890 
Train Epoch: 42 [49/500 3136/32000 (10%)] Loss: 1.04575 (QuantReg: 15.76812) QuantErr: 15.76812 batch_time=0.37890 
Train Epoch: 42 [57/500 3648/32000 (11%)] Loss: 0.73065 (QuantReg: 16.02676) QuantErr: 16.02676 batch_time=0.38251 
Train Epoch: 42 [65/500 4160/32000 (13%)] Loss: 1.05384 (QuantReg: 15.73369) QuantErr: 15.73369 batch_time=0.67598 
Train Epoch: 42 [73/500 4672/32000 (15%)] Loss: 1.00972 (QuantReg: 15.74858) QuantErr: 15.74858 batch_time=1.04675 
Train Epoch: 42 [81/500 5184/32000 (16%)] Loss: 0.90582 (QuantReg: 15.87519) QuantErr: 15.87519 batch_time=0.55051 
Train Epoch: 42 [89/500 5696/32000 (18%)] Loss: 0.97133 (QuantReg: 15.77159) QuantErr: 15.77159 batch_time=0.37680 
Train Epoch: 42 [97/500 6208/32000 (19%)] Loss: 0.77179 (QuantReg: 15.90520) QuantErr: 15.90520 batch_time=0.40221 
Train Epoch: 42 [105/500 6720/32000 (21%)] Loss: 0.72892 (QuantReg: 15.96359) QuantErr: 15.96359 batch_time=0.38341 
Train Epoch: 42 [113/500 7232/32000 (23%)] Loss: 1.18114 (QuantReg: 15.89988) QuantErr: 15.89988 batch_time=0.37491 
Train Epoch: 42 [121/500 7744/32000 (24%)] Loss: 0.73461 (QuantReg: 15.73885) QuantErr: 15.73885 batch_time=0.37998 
Train Epoch: 42 [129/500 8256/32000 (26%)] Loss: 0.84986 (QuantReg: 15.82785) QuantErr: 15.82785 batch_time=0.65850 
Train Epoch: 42 [137/500 8768/32000 (27%)] Loss: 1.05501 (QuantReg: 15.74376) QuantErr: 15.74376 batch_time=1.01246 
Train Epoch: 42 [145/500 9280/32000 (29%)] Loss: 0.75312 (QuantReg: 16.05613) QuantErr: 16.05613 batch_time=0.55045 
Train Epoch: 42 [153/500 9792/32000 (31%)] Loss: 1.13754 (QuantReg: 15.89307) QuantErr: 15.89307 batch_time=0.38103 
Train Epoch: 42 [161/500 10304/32000 (32%)] Loss: 1.00091 (QuantReg: 15.86522) QuantErr: 15.86522 batch_time=0.38296 
Train Epoch: 42 [169/500 10816/32000 (34%)] Loss: 1.07277 (QuantReg: 15.88654) QuantErr: 15.88654 batch_time=0.38401 
Train Epoch: 42 [177/500 11328/32000 (35%)] Loss: 0.77303 (QuantReg: 15.90267) QuantErr: 15.90267 batch_time=0.38771 
Train Epoch: 42 [185/500 11840/32000 (37%)] Loss: 0.71331 (QuantReg: 15.88790) QuantErr: 15.88790 batch_time=0.38464 
Train Epoch: 42 [193/500 12352/32000 (39%)] Loss: 1.10451 (QuantReg: 15.94693) QuantErr: 15.94693 batch_time=0.67690 
Train Epoch: 42 [201/500 12864/32000 (40%)] Loss: 1.25155 (QuantReg: 15.73982) QuantErr: 15.73982 batch_time=1.05023 
Train Epoch: 42 [209/500 13376/32000 (42%)] Loss: 0.71904 (QuantReg: 15.83956) QuantErr: 15.83956 batch_time=0.59256 
Train Epoch: 42 [217/500 13888/32000 (43%)] Loss: 1.06701 (QuantReg: 15.54511) QuantErr: 15.54511 batch_time=0.38544 
Train Epoch: 42 [225/500 14400/32000 (45%)] Loss: 0.85358 (QuantReg: 15.80461) QuantErr: 15.80461 batch_time=0.38309 
Train Epoch: 42 [233/500 14912/32000 (47%)] Loss: 1.11858 (QuantReg: 16.03077) QuantErr: 16.03077 batch_time=0.39439 
Train Epoch: 42 [241/500 15424/32000 (48%)] Loss: 0.95405 (QuantReg: 15.84590) QuantErr: 15.84590 batch_time=0.38479 
Train Epoch: 42 [249/500 15936/32000 (50%)] Loss: 1.06052 (QuantReg: 15.86515) QuantErr: 15.86515 batch_time=0.38341 
Train Epoch: 42 [257/500 16448/32000 (51%)] Loss: 0.71732 (QuantReg: 16.00219) QuantErr: 16.00219 batch_time=0.65969 
Train Epoch: 42 [265/500 16960/32000 (53%)] Loss: 0.70843 (QuantReg: 15.89827) QuantErr: 15.89827 batch_time=1.05393 
Train Epoch: 42 [273/500 17472/32000 (55%)] Loss: 0.74074 (QuantReg: 15.75664) QuantErr: 15.75664 batch_time=0.53337 
Train Epoch: 42 [281/500 17984/32000 (56%)] Loss: 0.90432 (QuantReg: 15.87564) QuantErr: 15.87564 batch_time=0.37889 
Train Epoch: 42 [289/500 18496/32000 (58%)] Loss: 1.00090 (QuantReg: 15.76381) QuantErr: 15.76381 batch_time=0.39103 
Train Epoch: 42 [297/500 19008/32000 (59%)] Loss: 0.85117 (QuantReg: 15.83323) QuantErr: 15.83323 batch_time=0.38383 
Train Epoch: 42 [305/500 19520/32000 (61%)] Loss: 1.13395 (QuantReg: 15.69403) QuantErr: 15.69403 batch_time=0.35796 
Train Epoch: 42 [313/500 20032/32000 (63%)] Loss: 1.10524 (QuantReg: 15.98398) QuantErr: 15.98398 batch_time=0.38032 
Train Epoch: 42 [321/500 20544/32000 (64%)] Loss: 0.89402 (QuantReg: 15.97265) QuantErr: 15.97265 batch_time=0.62677 
Train Epoch: 42 [329/500 21056/32000 (66%)] Loss: 0.84939 (QuantReg: 16.07558) QuantErr: 16.07558 batch_time=0.98588 
Train Epoch: 42 [337/500 21568/32000 (67%)] Loss: 0.94062 (QuantReg: 15.76656) QuantErr: 15.76656 batch_time=0.55096 
Train Epoch: 42 [345/500 22080/32000 (69%)] Loss: 0.73432 (QuantReg: 15.88908) QuantErr: 15.88908 batch_time=0.39214 
Train Epoch: 42 [353/500 22592/32000 (71%)] Loss: 1.09860 (QuantReg: 15.67832) QuantErr: 15.67832 batch_time=0.38375 
Train Epoch: 42 [361/500 23104/32000 (72%)] Loss: 1.15795 (QuantReg: 15.83603) QuantErr: 15.83603 batch_time=0.38310 
Train Epoch: 42 [369/500 23616/32000 (74%)] Loss: 1.11909 (QuantReg: 15.71933) QuantErr: 15.71933 batch_time=0.37966 
Train Epoch: 42 [377/500 24128/32000 (75%)] Loss: 1.22424 (QuantReg: 15.77384) QuantErr: 15.77384 batch_time=0.38619 
Train Epoch: 42 [385/500 24640/32000 (77%)] Loss: 0.93849 (QuantReg: 15.76430) QuantErr: 15.76430 batch_time=0.66720 
Train Epoch: 42 [393/500 25152/32000 (79%)] Loss: 0.98325 (QuantReg: 15.88952) QuantErr: 15.88952 batch_time=0.98061 
Train Epoch: 42 [401/500 25664/32000 (80%)] Loss: 0.86770 (QuantReg: 15.81510) QuantErr: 15.81510 batch_time=0.54682 
Train Epoch: 42 [409/500 26176/32000 (82%)] Loss: 0.99069 (QuantReg: 15.84585) QuantErr: 15.84585 batch_time=0.37637 
Train Epoch: 42 [417/500 26688/32000 (83%)] Loss: 1.14740 (QuantReg: 15.51471) QuantErr: 15.51471 batch_time=0.37531 
Train Epoch: 42 [425/500 27200/32000 (85%)] Loss: 0.87082 (QuantReg: 15.58834) QuantErr: 15.58834 batch_time=0.38038 
Train Epoch: 42 [433/500 27712/32000 (87%)] Loss: 1.03286 (QuantReg: 15.85130) QuantErr: 15.85130 batch_time=0.39432 
Train Epoch: 42 [441/500 28224/32000 (88%)] Loss: 0.93362 (QuantReg: 15.80246) QuantErr: 15.80246 batch_time=0.38441 
Train Epoch: 42 [449/500 28736/32000 (90%)] Loss: 1.12562 (QuantReg: 15.89445) QuantErr: 15.89445 batch_time=0.66713 
Train Epoch: 42 [457/500 29248/32000 (91%)] Loss: 0.95988 (QuantReg: 15.89491) QuantErr: 15.89491 batch_time=1.04435 
Train Epoch: 42 [465/500 29760/32000 (93%)] Loss: 1.22582 (QuantReg: 15.60369) QuantErr: 15.60369 batch_time=0.54712 
Train Epoch: 42 [473/500 30272/32000 (95%)] Loss: 0.79294 (QuantReg: 15.96834) QuantErr: 15.96834 batch_time=0.37476 
Train Epoch: 42 [481/500 30784/32000 (96%)] Loss: 0.90963 (QuantReg: 15.80863) QuantErr: 15.80863 batch_time=0.38293 
Train Epoch: 42 [489/500 31296/32000 (98%)] Loss: 0.84786 (QuantReg: 15.99523) QuantErr: 15.99523 batch_time=0.40900 
Train Epoch: 42 [497/500 31808/32000 (99%)] Loss: 1.01806 (QuantReg: 15.88637) QuantErr: 15.88637 batch_time=0.38792 
Train Epoch: 42 codebook_update_time=1.94408
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch42.pth ...
Done in 22.535s
removing stale ckpt [epoch 41] [took 1.01s]
 epoch          : 42
 loss           : 0.9537717658281326
 quant_reg      : 15.846120519638061
 quant_err      : 15.846120519638061
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 21000
 LSMDC_full_test/t2v_metrics/R1: 13.0
 LSMDC_full_test/t2v_metrics/R5: 30.3
 LSMDC_full_test/t2v_metrics/R10: 42.2
 LSMDC_full_test/t2v_metrics/R50: 66.3
 LSMDC_full_test/t2v_metrics/MedR: 17.5
 LSMDC_full_test/t2v_metrics/MeanR: 79.739
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.521105172540622
 LSMDC_full_test/v2t_metrics/R1: 12.8
 LSMDC_full_test/v2t_metrics/R5: 31.5
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 67.1
 LSMDC_full_test/v2t_metrics/MedR: 20.5
 LSMDC_full_test/v2t_metrics/MeanR: 78.044
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.286475401502504
 mnt_best       : 25.975252586423483
 not_improved_count: 10
Train Epoch: 43 [1/500 64/32000 (0%)] Loss: 1.21145 (QuantReg: 15.74628) QuantErr: 15.74628 batch_time=16.22433 
Train Epoch: 43 [9/500 576/32000 (2%)] Loss: 1.04503 (QuantReg: 15.89795) QuantErr: 15.89795 batch_time=0.41511 
Train Epoch: 43 [17/500 1088/32000 (3%)] Loss: 0.93288 (QuantReg: 15.97675) QuantErr: 15.97675 batch_time=0.39066 
Train Epoch: 43 [25/500 1600/32000 (5%)] Loss: 1.30925 (QuantReg: 15.75087) QuantErr: 15.75087 batch_time=0.59426 
Train Epoch: 43 [33/500 2112/32000 (7%)] Loss: 0.73733 (QuantReg: 15.82607) QuantErr: 15.82607 batch_time=0.42417 
Train Epoch: 43 [41/500 2624/32000 (8%)] Loss: 1.03576 (QuantReg: 15.87875) QuantErr: 15.87875 batch_time=0.37791 
Train Epoch: 43 [49/500 3136/32000 (10%)] Loss: 1.07614 (QuantReg: 15.83877) QuantErr: 15.83877 batch_time=0.38018 
Train Epoch: 43 [57/500 3648/32000 (11%)] Loss: 1.05962 (QuantReg: 15.94812) QuantErr: 15.94812 batch_time=0.40983 
Train Epoch: 43 [65/500 4160/32000 (13%)] Loss: 0.76370 (QuantReg: 15.67475) QuantErr: 15.67475 batch_time=0.67166 
Train Epoch: 43 [73/500 4672/32000 (15%)] Loss: 1.23326 (QuantReg: 15.89594) QuantErr: 15.89594 batch_time=0.38062 
Train Epoch: 43 [81/500 5184/32000 (16%)] Loss: 1.03432 (QuantReg: 15.96077) QuantErr: 15.96077 batch_time=0.37843 
Train Epoch: 43 [89/500 5696/32000 (18%)] Loss: 0.90133 (QuantReg: 15.91497) QuantErr: 15.91497 batch_time=0.60398 
Train Epoch: 43 [97/500 6208/32000 (19%)] Loss: 0.85953 (QuantReg: 15.82561) QuantErr: 15.82561 batch_time=0.43210 
Train Epoch: 43 [105/500 6720/32000 (21%)] Loss: 0.81816 (QuantReg: 15.82413) QuantErr: 15.82413 batch_time=0.39132 
Train Epoch: 43 [113/500 7232/32000 (23%)] Loss: 0.76480 (QuantReg: 15.72930) QuantErr: 15.72930 batch_time=0.39108 
Train Epoch: 43 [121/500 7744/32000 (24%)] Loss: 1.01203 (QuantReg: 15.69556) QuantErr: 15.69556 batch_time=0.42643 
Train Epoch: 43 [129/500 8256/32000 (26%)] Loss: 0.85350 (QuantReg: 15.91175) QuantErr: 15.91175 batch_time=0.66710 
Train Epoch: 43 [137/500 8768/32000 (27%)] Loss: 1.11058 (QuantReg: 15.80699) QuantErr: 15.80699 batch_time=0.36890 
Train Epoch: 43 [145/500 9280/32000 (29%)] Loss: 1.04424 (QuantReg: 15.68506) QuantErr: 15.68506 batch_time=0.38033 
Train Epoch: 43 [153/500 9792/32000 (31%)] Loss: 0.88629 (QuantReg: 16.03578) QuantErr: 16.03578 batch_time=0.61321 
Train Epoch: 43 [161/500 10304/32000 (32%)] Loss: 0.88956 (QuantReg: 16.04813) QuantErr: 16.04813 batch_time=0.37563 
Train Epoch: 43 [169/500 10816/32000 (34%)] Loss: 0.87098 (QuantReg: 16.00212) QuantErr: 16.00212 batch_time=0.37958 
Train Epoch: 43 [177/500 11328/32000 (35%)] Loss: 1.08219 (QuantReg: 15.69952) QuantErr: 15.69952 batch_time=0.37783 
Train Epoch: 43 [185/500 11840/32000 (37%)] Loss: 0.96025 (QuantReg: 15.66853) QuantErr: 15.66853 batch_time=0.37570 
Train Epoch: 43 [193/500 12352/32000 (39%)] Loss: 0.91790 (QuantReg: 15.89250) QuantErr: 15.89250 batch_time=0.62970 
Train Epoch: 43 [201/500 12864/32000 (40%)] Loss: 1.08713 (QuantReg: 15.85768) QuantErr: 15.85768 batch_time=0.37228 
Train Epoch: 43 [209/500 13376/32000 (42%)] Loss: 0.73974 (QuantReg: 15.59930) QuantErr: 15.59930 batch_time=0.37276 
Train Epoch: 43 [217/500 13888/32000 (43%)] Loss: 0.94720 (QuantReg: 15.93676) QuantErr: 15.93676 batch_time=0.59852 
Train Epoch: 43 [225/500 14400/32000 (45%)] Loss: 1.03133 (QuantReg: 15.90812) QuantErr: 15.90812 batch_time=0.38911 
Train Epoch: 43 [233/500 14912/32000 (47%)] Loss: 1.14413 (QuantReg: 15.82452) QuantErr: 15.82452 batch_time=0.38629 
Train Epoch: 43 [241/500 15424/32000 (48%)] Loss: 0.94872 (QuantReg: 15.86911) QuantErr: 15.86911 batch_time=0.38167 
Train Epoch: 43 [249/500 15936/32000 (50%)] Loss: 0.91602 (QuantReg: 16.01668) QuantErr: 16.01668 batch_time=0.39847 
Train Epoch: 43 [257/500 16448/32000 (51%)] Loss: 0.83050 (QuantReg: 15.82996) QuantErr: 15.82996 batch_time=0.63644 
Train Epoch: 43 [265/500 16960/32000 (53%)] Loss: 0.94976 (QuantReg: 15.65074) QuantErr: 15.65074 batch_time=0.37720 
Train Epoch: 43 [273/500 17472/32000 (55%)] Loss: 1.07375 (QuantReg: 15.94217) QuantErr: 15.94217 batch_time=0.37558 
Train Epoch: 43 [281/500 17984/32000 (56%)] Loss: 1.25846 (QuantReg: 15.98697) QuantErr: 15.98697 batch_time=0.59447 
Train Epoch: 43 [289/500 18496/32000 (58%)] Loss: 1.13148 (QuantReg: 16.10644) QuantErr: 16.10644 batch_time=0.37854 
Train Epoch: 43 [297/500 19008/32000 (59%)] Loss: 0.75493 (QuantReg: 15.86458) QuantErr: 15.86458 batch_time=0.38397 
Train Epoch: 43 [305/500 19520/32000 (61%)] Loss: 0.96441 (QuantReg: 15.91272) QuantErr: 15.91272 batch_time=0.38074 
Train Epoch: 43 [313/500 20032/32000 (63%)] Loss: 0.69452 (QuantReg: 15.70921) QuantErr: 15.70921 batch_time=0.37781 
Train Epoch: 43 [321/500 20544/32000 (64%)] Loss: 1.14217 (QuantReg: 16.09657) QuantErr: 16.09657 batch_time=0.71947 
Train Epoch: 43 [329/500 21056/32000 (66%)] Loss: 0.79553 (QuantReg: 15.75873) QuantErr: 15.75873 batch_time=0.37484 
Train Epoch: 43 [337/500 21568/32000 (67%)] Loss: 0.88932 (QuantReg: 15.80652) QuantErr: 15.80652 batch_time=0.38460 
Train Epoch: 43 [345/500 22080/32000 (69%)] Loss: 0.99411 (QuantReg: 15.97464) QuantErr: 15.97464 batch_time=0.63117 
Train Epoch: 43 [353/500 22592/32000 (71%)] Loss: 0.85784 (QuantReg: 16.01230) QuantErr: 16.01230 batch_time=0.39994 
Train Epoch: 43 [361/500 23104/32000 (72%)] Loss: 1.03612 (QuantReg: 15.87342) QuantErr: 15.87342 batch_time=0.38911 
Train Epoch: 43 [369/500 23616/32000 (74%)] Loss: 0.95487 (QuantReg: 15.76179) QuantErr: 15.76179 batch_time=0.39322 
Train Epoch: 43 [377/500 24128/32000 (75%)] Loss: 0.84638 (QuantReg: 15.72381) QuantErr: 15.72381 batch_time=0.40883 
Train Epoch: 43 [385/500 24640/32000 (77%)] Loss: 0.81659 (QuantReg: 15.88042) QuantErr: 15.88042 batch_time=0.66225 
Train Epoch: 43 [393/500 25152/32000 (79%)] Loss: 0.90519 (QuantReg: 15.89930) QuantErr: 15.89930 batch_time=0.38540 
Train Epoch: 43 [401/500 25664/32000 (80%)] Loss: 1.39016 (QuantReg: 15.97423) QuantErr: 15.97423 batch_time=0.38344 
Train Epoch: 43 [409/500 26176/32000 (82%)] Loss: 0.82171 (QuantReg: 16.03532) QuantErr: 16.03532 batch_time=0.59613 
Train Epoch: 43 [417/500 26688/32000 (83%)] Loss: 0.88994 (QuantReg: 15.88835) QuantErr: 15.88835 batch_time=0.39625 
Train Epoch: 43 [425/500 27200/32000 (85%)] Loss: 1.02929 (QuantReg: 15.84189) QuantErr: 15.84189 batch_time=0.40291 
Train Epoch: 43 [433/500 27712/32000 (87%)] Loss: 0.91563 (QuantReg: 15.83966) QuantErr: 15.83966 batch_time=0.38033 
Train Epoch: 43 [441/500 28224/32000 (88%)] Loss: 0.80755 (QuantReg: 15.85637) QuantErr: 15.85637 batch_time=0.37635 
Train Epoch: 43 [449/500 28736/32000 (90%)] Loss: 0.96251 (QuantReg: 15.81014) QuantErr: 15.81014 batch_time=0.69620 
Train Epoch: 43 [457/500 29248/32000 (91%)] Loss: 1.36017 (QuantReg: 15.73572) QuantErr: 15.73572 batch_time=0.38080 
Train Epoch: 43 [465/500 29760/32000 (93%)] Loss: 0.97417 (QuantReg: 16.05857) QuantErr: 16.05857 batch_time=0.37400 
Train Epoch: 43 [473/500 30272/32000 (95%)] Loss: 0.92001 (QuantReg: 15.76354) QuantErr: 15.76354 batch_time=0.59758 
Train Epoch: 43 [481/500 30784/32000 (96%)] Loss: 0.87101 (QuantReg: 16.00873) QuantErr: 16.00873 batch_time=0.37259 
Train Epoch: 43 [489/500 31296/32000 (98%)] Loss: 0.71606 (QuantReg: 15.72219) QuantErr: 15.72219 batch_time=0.37486 
Train Epoch: 43 [497/500 31808/32000 (99%)] Loss: 1.07653 (QuantReg: 15.85272) QuantErr: 15.85272 batch_time=0.37431 
Train Epoch: 43 codebook_update_time=2.35693
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch43.pth ...
Done in 4.539s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 0.9674550693035125
 quant_reg      : 15.848237678527832
 quant_err      : 15.848237678527832
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 21500
 LSMDC_full_test/t2v_metrics/R1: 12.9
 LSMDC_full_test/t2v_metrics/R5: 32.0
 LSMDC_full_test/t2v_metrics/R10: 41.8
 LSMDC_full_test/t2v_metrics/R50: 66.8
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 80.472
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.840762437285907
 LSMDC_full_test/v2t_metrics/R1: 12.8
 LSMDC_full_test/v2t_metrics/R5: 31.2
 LSMDC_full_test/v2t_metrics/R10: 40.2
 LSMDC_full_test/v2t_metrics/R50: 66.7
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 78.204
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.226879859300087
 mnt_best       : 25.975252586423483
 not_improved_count: 11
Train Epoch: 44 [1/500 64/32000 (0%)] Loss: 0.97676 (QuantReg: 15.78320) QuantErr: 15.78320 batch_time=17.38986 
Train Epoch: 44 [9/500 576/32000 (2%)] Loss: 0.89336 (QuantReg: 15.92283) QuantErr: 15.92283 batch_time=0.39422 
Train Epoch: 44 [17/500 1088/32000 (3%)] Loss: 0.94575 (QuantReg: 15.76272) QuantErr: 15.76272 batch_time=0.37851 
Train Epoch: 44 [25/500 1600/32000 (5%)] Loss: 0.94544 (QuantReg: 15.76849) QuantErr: 15.76849 batch_time=0.37508 
Train Epoch: 44 [33/500 2112/32000 (7%)] Loss: 0.83514 (QuantReg: 15.70149) QuantErr: 15.70149 batch_time=0.38530 
Train Epoch: 44 [41/500 2624/32000 (8%)] Loss: 0.78736 (QuantReg: 15.80720) QuantErr: 15.80720 batch_time=0.37616 
Train Epoch: 44 [49/500 3136/32000 (10%)] Loss: 0.96065 (QuantReg: 15.78280) QuantErr: 15.78280 batch_time=0.38487 
Train Epoch: 44 [57/500 3648/32000 (11%)] Loss: 1.01588 (QuantReg: 15.79186) QuantErr: 15.79186 batch_time=0.39995 
Train Epoch: 44 [65/500 4160/32000 (13%)] Loss: 0.78599 (QuantReg: 15.83064) QuantErr: 15.83064 batch_time=0.71561 
Train Epoch: 44 [73/500 4672/32000 (15%)] Loss: 1.25984 (QuantReg: 15.66140) QuantErr: 15.66140 batch_time=0.37908 
Train Epoch: 44 [81/500 5184/32000 (16%)] Loss: 0.97606 (QuantReg: 15.94436) QuantErr: 15.94436 batch_time=0.37330 
Train Epoch: 44 [89/500 5696/32000 (18%)] Loss: 0.90248 (QuantReg: 15.88732) QuantErr: 15.88732 batch_time=0.39250 
Train Epoch: 44 [97/500 6208/32000 (19%)] Loss: 1.15820 (QuantReg: 15.64718) QuantErr: 15.64718 batch_time=0.37614 
Train Epoch: 44 [105/500 6720/32000 (21%)] Loss: 0.91030 (QuantReg: 15.88098) QuantErr: 15.88098 batch_time=0.37194 
Train Epoch: 44 [113/500 7232/32000 (23%)] Loss: 0.86688 (QuantReg: 15.86490) QuantErr: 15.86490 batch_time=0.39276 
Train Epoch: 44 [121/500 7744/32000 (24%)] Loss: 0.95353 (QuantReg: 15.85944) QuantErr: 15.85944 batch_time=0.38263 
Train Epoch: 44 [129/500 8256/32000 (26%)] Loss: 0.93052 (QuantReg: 15.85823) QuantErr: 15.85823 batch_time=0.71967 
Train Epoch: 44 [137/500 8768/32000 (27%)] Loss: 1.00439 (QuantReg: 16.06126) QuantErr: 16.06126 batch_time=0.37792 
Train Epoch: 44 [145/500 9280/32000 (29%)] Loss: 0.89430 (QuantReg: 15.71082) QuantErr: 15.71082 batch_time=0.37731 
Train Epoch: 44 [153/500 9792/32000 (31%)] Loss: 0.88576 (QuantReg: 15.74232) QuantErr: 15.74232 batch_time=0.38133 
Train Epoch: 44 [161/500 10304/32000 (32%)] Loss: 0.69190 (QuantReg: 15.93267) QuantErr: 15.93267 batch_time=0.37589 
Train Epoch: 44 [169/500 10816/32000 (34%)] Loss: 0.83978 (QuantReg: 15.94887) QuantErr: 15.94887 batch_time=0.38400 
Train Epoch: 44 [177/500 11328/32000 (35%)] Loss: 0.84904 (QuantReg: 15.88539) QuantErr: 15.88539 batch_time=0.38882 
Train Epoch: 44 [185/500 11840/32000 (37%)] Loss: 0.93395 (QuantReg: 15.81430) QuantErr: 15.81430 batch_time=0.38681 
Train Epoch: 44 [193/500 12352/32000 (39%)] Loss: 0.78507 (QuantReg: 15.72561) QuantErr: 15.72561 batch_time=0.69514 
Train Epoch: 44 [201/500 12864/32000 (40%)] Loss: 0.80946 (QuantReg: 15.75508) QuantErr: 15.75508 batch_time=0.38622 
Train Epoch: 44 [209/500 13376/32000 (42%)] Loss: 0.84069 (QuantReg: 15.99917) QuantErr: 15.99917 batch_time=0.37193 
Train Epoch: 44 [217/500 13888/32000 (43%)] Loss: 0.93883 (QuantReg: 16.02711) QuantErr: 16.02711 batch_time=0.36735 
Train Epoch: 44 [225/500 14400/32000 (45%)] Loss: 1.09270 (QuantReg: 15.66873) QuantErr: 15.66873 batch_time=0.36771 
Train Epoch: 44 [233/500 14912/32000 (47%)] Loss: 0.96729 (QuantReg: 15.77245) QuantErr: 15.77245 batch_time=0.38374 
Train Epoch: 44 [241/500 15424/32000 (48%)] Loss: 1.09774 (QuantReg: 15.97224) QuantErr: 15.97224 batch_time=0.39128 
Train Epoch: 44 [249/500 15936/32000 (50%)] Loss: 1.06489 (QuantReg: 15.69512) QuantErr: 15.69512 batch_time=0.40464 
Train Epoch: 44 [257/500 16448/32000 (51%)] Loss: 0.90073 (QuantReg: 15.97063) QuantErr: 15.97063 batch_time=0.71270 
Train Epoch: 44 [265/500 16960/32000 (53%)] Loss: 0.78163 (QuantReg: 15.97892) QuantErr: 15.97892 batch_time=0.37584 
Train Epoch: 44 [273/500 17472/32000 (55%)] Loss: 0.99792 (QuantReg: 15.91122) QuantErr: 15.91122 batch_time=0.39888 
Train Epoch: 44 [281/500 17984/32000 (56%)] Loss: 0.83616 (QuantReg: 15.99321) QuantErr: 15.99321 batch_time=0.37863 
Train Epoch: 44 [289/500 18496/32000 (58%)] Loss: 1.02183 (QuantReg: 15.89097) QuantErr: 15.89097 batch_time=0.38389 
Train Epoch: 44 [297/500 19008/32000 (59%)] Loss: 0.91788 (QuantReg: 15.93575) QuantErr: 15.93575 batch_time=0.40953 
Train Epoch: 44 [305/500 19520/32000 (61%)] Loss: 0.99533 (QuantReg: 16.07422) QuantErr: 16.07422 batch_time=0.37205 
Train Epoch: 44 [313/500 20032/32000 (63%)] Loss: 1.20785 (QuantReg: 16.10006) QuantErr: 16.10006 batch_time=0.40043 
Train Epoch: 44 [321/500 20544/32000 (64%)] Loss: 0.95761 (QuantReg: 15.79921) QuantErr: 15.79921 batch_time=0.73457 
Train Epoch: 44 [329/500 21056/32000 (66%)] Loss: 1.15755 (QuantReg: 16.04921) QuantErr: 16.04921 batch_time=0.38286 
Train Epoch: 44 [337/500 21568/32000 (67%)] Loss: 1.11184 (QuantReg: 15.58452) QuantErr: 15.58452 batch_time=0.40511 
Train Epoch: 44 [345/500 22080/32000 (69%)] Loss: 1.08977 (QuantReg: 15.91905) QuantErr: 15.91905 batch_time=0.38692 
Train Epoch: 44 [353/500 22592/32000 (71%)] Loss: 0.83219 (QuantReg: 15.89519) QuantErr: 15.89519 batch_time=0.43163 
Train Epoch: 44 [361/500 23104/32000 (72%)] Loss: 1.22344 (QuantReg: 15.84471) QuantErr: 15.84471 batch_time=0.39319 
Train Epoch: 44 [369/500 23616/32000 (74%)] Loss: 1.20196 (QuantReg: 15.95737) QuantErr: 15.95737 batch_time=0.38743 
Train Epoch: 44 [377/500 24128/32000 (75%)] Loss: 0.87973 (QuantReg: 15.81843) QuantErr: 15.81843 batch_time=0.38824 
Train Epoch: 44 [385/500 24640/32000 (77%)] Loss: 0.78161 (QuantReg: 15.83865) QuantErr: 15.83865 batch_time=0.72056 
Train Epoch: 44 [393/500 25152/32000 (79%)] Loss: 0.85083 (QuantReg: 15.97015) QuantErr: 15.97015 batch_time=0.38712 
Train Epoch: 44 [401/500 25664/32000 (80%)] Loss: 1.04643 (QuantReg: 15.90951) QuantErr: 15.90951 batch_time=0.41974 
Train Epoch: 44 [409/500 26176/32000 (82%)] Loss: 0.90164 (QuantReg: 15.57011) QuantErr: 15.57011 batch_time=0.37853 
Train Epoch: 44 [417/500 26688/32000 (83%)] Loss: 1.21681 (QuantReg: 15.81556) QuantErr: 15.81556 batch_time=0.37665 
Train Epoch: 44 [425/500 27200/32000 (85%)] Loss: 1.11694 (QuantReg: 15.90933) QuantErr: 15.90933 batch_time=0.40907 
Train Epoch: 44 [433/500 27712/32000 (87%)] Loss: 0.90145 (QuantReg: 15.84167) QuantErr: 15.84167 batch_time=0.39690 
Train Epoch: 44 [441/500 28224/32000 (88%)] Loss: 1.02697 (QuantReg: 15.73009) QuantErr: 15.73009 batch_time=0.38618 
Train Epoch: 44 [449/500 28736/32000 (90%)] Loss: 0.73681 (QuantReg: 15.81163) QuantErr: 15.81163 batch_time=0.71771 
Train Epoch: 44 [457/500 29248/32000 (91%)] Loss: 0.78945 (QuantReg: 15.79379) QuantErr: 15.79379 batch_time=0.37695 
Train Epoch: 44 [465/500 29760/32000 (93%)] Loss: 0.96349 (QuantReg: 15.84092) QuantErr: 15.84092 batch_time=0.39595 
Train Epoch: 44 [473/500 30272/32000 (95%)] Loss: 0.97351 (QuantReg: 15.64788) QuantErr: 15.64788 batch_time=0.41759 
Train Epoch: 44 [481/500 30784/32000 (96%)] Loss: 1.04613 (QuantReg: 15.87937) QuantErr: 15.87937 batch_time=0.38028 
Train Epoch: 44 [489/500 31296/32000 (98%)] Loss: 0.74552 (QuantReg: 15.87217) QuantErr: 15.87217 batch_time=0.39285 
Train Epoch: 44 [497/500 31808/32000 (99%)] Loss: 1.23226 (QuantReg: 15.62155) QuantErr: 15.62155 batch_time=0.39825 
Train Epoch: 44 codebook_update_time=1.92815
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch44.pth ...
Done in 3.985s
removing stale ckpt [epoch 43] [took 0.01s]
 epoch          : 44
 loss           : 0.9504558002948761
 quant_reg      : 15.837566972732544
 quant_err      : 15.837566972732544
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 22000
 LSMDC_full_test/t2v_metrics/R1: 13.0
 LSMDC_full_test/t2v_metrics/R5: 30.1
 LSMDC_full_test/t2v_metrics/R10: 39.6
 LSMDC_full_test/t2v_metrics/R50: 66.5
 LSMDC_full_test/t2v_metrics/MedR: 21.0
 LSMDC_full_test/t2v_metrics/MeanR: 80.887
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.93073091568759
 LSMDC_full_test/v2t_metrics/R1: 12.8
 LSMDC_full_test/v2t_metrics/R5: 30.6
 LSMDC_full_test/v2t_metrics/R10: 39.6
 LSMDC_full_test/v2t_metrics/R50: 66.2
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 78.849
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.938798564297148
 mnt_best       : 25.975252586423483
 not_improved_count: 12
Train Epoch: 45 [1/500 64/32000 (0%)] Loss: 1.09687 (QuantReg: 15.64360) QuantErr: 15.64360 batch_time=16.81046 
Train Epoch: 45 [9/500 576/32000 (2%)] Loss: 0.74788 (QuantReg: 15.97410) QuantErr: 15.97410 batch_time=0.38753 
Train Epoch: 45 [17/500 1088/32000 (3%)] Loss: 0.88471 (QuantReg: 15.82830) QuantErr: 15.82830 batch_time=0.37751 
Train Epoch: 45 [25/500 1600/32000 (5%)] Loss: 0.67246 (QuantReg: 15.87720) QuantErr: 15.87720 batch_time=0.37403 
Train Epoch: 45 [33/500 2112/32000 (7%)] Loss: 0.62332 (QuantReg: 15.65402) QuantErr: 15.65402 batch_time=0.41298 
Train Epoch: 45 [41/500 2624/32000 (8%)] Loss: 0.98188 (QuantReg: 15.77331) QuantErr: 15.77331 batch_time=0.41738 
Train Epoch: 45 [49/500 3136/32000 (10%)] Loss: 0.88881 (QuantReg: 15.96222) QuantErr: 15.96222 batch_time=0.44671 
Train Epoch: 45 [57/500 3648/32000 (11%)] Loss: 0.76791 (QuantReg: 15.92659) QuantErr: 15.92659 batch_time=0.38311 
Train Epoch: 45 [65/500 4160/32000 (13%)] Loss: 1.01788 (QuantReg: 15.75876) QuantErr: 15.75876 batch_time=0.96446 
Train Epoch: 45 [73/500 4672/32000 (15%)] Loss: 0.98674 (QuantReg: 15.91214) QuantErr: 15.91214 batch_time=0.38010 
Train Epoch: 45 [81/500 5184/32000 (16%)] Loss: 0.86386 (QuantReg: 15.81935) QuantErr: 15.81935 batch_time=0.37285 
Train Epoch: 45 [89/500 5696/32000 (18%)] Loss: 0.65127 (QuantReg: 15.83765) QuantErr: 15.83765 batch_time=0.37661 
Train Epoch: 45 [97/500 6208/32000 (19%)] Loss: 1.22541 (QuantReg: 15.93350) QuantErr: 15.93350 batch_time=0.37743 
Train Epoch: 45 [105/500 6720/32000 (21%)] Loss: 0.79215 (QuantReg: 15.79903) QuantErr: 15.79903 batch_time=0.37931 
Train Epoch: 45 [113/500 7232/32000 (23%)] Loss: 0.81836 (QuantReg: 15.99123) QuantErr: 15.99123 batch_time=0.38171 
Train Epoch: 45 [121/500 7744/32000 (24%)] Loss: 0.95633 (QuantReg: 15.98480) QuantErr: 15.98480 batch_time=0.39104 
Train Epoch: 45 [129/500 8256/32000 (26%)] Loss: 0.79453 (QuantReg: 15.87352) QuantErr: 15.87352 batch_time=5.67018 
Train Epoch: 45 [137/500 8768/32000 (27%)] Loss: 0.84485 (QuantReg: 15.98475) QuantErr: 15.98475 batch_time=0.37561 
Train Epoch: 45 [145/500 9280/32000 (29%)] Loss: 1.32594 (QuantReg: 16.02960) QuantErr: 16.02960 batch_time=0.38880 
Train Epoch: 45 [153/500 9792/32000 (31%)] Loss: 0.96204 (QuantReg: 15.85835) QuantErr: 15.85835 batch_time=0.37392 
Train Epoch: 45 [161/500 10304/32000 (32%)] Loss: 0.82391 (QuantReg: 15.75266) QuantErr: 15.75266 batch_time=0.38389 
Train Epoch: 45 [169/500 10816/32000 (34%)] Loss: 0.84412 (QuantReg: 16.01382) QuantErr: 16.01382 batch_time=0.37409 
Train Epoch: 45 [177/500 11328/32000 (35%)] Loss: 0.79496 (QuantReg: 15.90528) QuantErr: 15.90528 batch_time=0.37166 
Train Epoch: 45 [185/500 11840/32000 (37%)] Loss: 0.71121 (QuantReg: 15.78432) QuantErr: 15.78432 batch_time=0.39466 
Train Epoch: 45 [193/500 12352/32000 (39%)] Loss: 1.20806 (QuantReg: 15.82880) QuantErr: 15.82880 batch_time=3.28710 
Train Epoch: 45 [201/500 12864/32000 (40%)] Loss: 0.98878 (QuantReg: 15.79216) QuantErr: 15.79216 batch_time=0.38266 
Train Epoch: 45 [209/500 13376/32000 (42%)] Loss: 1.53018 (QuantReg: 15.83725) QuantErr: 15.83725 batch_time=0.38638 
Train Epoch: 45 [217/500 13888/32000 (43%)] Loss: 0.99948 (QuantReg: 16.11977) QuantErr: 16.11977 batch_time=0.37674 
Train Epoch: 45 [225/500 14400/32000 (45%)] Loss: 0.72519 (QuantReg: 16.24231) QuantErr: 16.24231 batch_time=0.39548 
Train Epoch: 45 [233/500 14912/32000 (47%)] Loss: 1.14752 (QuantReg: 15.92493) QuantErr: 15.92493 batch_time=0.40453 
Train Epoch: 45 [241/500 15424/32000 (48%)] Loss: 0.97211 (QuantReg: 15.83631) QuantErr: 15.83631 batch_time=0.38415 
Train Epoch: 45 [249/500 15936/32000 (50%)] Loss: 1.39232 (QuantReg: 15.94486) QuantErr: 15.94486 batch_time=0.38571 
Train Epoch: 45 [257/500 16448/32000 (51%)] Loss: 0.86551 (QuantReg: 15.66094) QuantErr: 15.66094 batch_time=3.84182 
Train Epoch: 45 [265/500 16960/32000 (53%)] Loss: 0.75376 (QuantReg: 15.96520) QuantErr: 15.96520 batch_time=0.38357 
Train Epoch: 45 [273/500 17472/32000 (55%)] Loss: 0.85810 (QuantReg: 15.97127) QuantErr: 15.97127 batch_time=0.38209 
Train Epoch: 45 [281/500 17984/32000 (56%)] Loss: 0.95728 (QuantReg: 15.88769) QuantErr: 15.88769 batch_time=0.37792 
Train Epoch: 45 [289/500 18496/32000 (58%)] Loss: 1.14340 (QuantReg: 15.86065) QuantErr: 15.86065 batch_time=0.38225 
Train Epoch: 45 [297/500 19008/32000 (59%)] Loss: 1.01139 (QuantReg: 15.68502) QuantErr: 15.68502 batch_time=0.39680 
Train Epoch: 45 [305/500 19520/32000 (61%)] Loss: 0.76917 (QuantReg: 16.08301) QuantErr: 16.08301 batch_time=0.38844 
Train Epoch: 45 [313/500 20032/32000 (63%)] Loss: 0.98320 (QuantReg: 15.85170) QuantErr: 15.85170 batch_time=0.37618 
Train Epoch: 45 [321/500 20544/32000 (64%)] Loss: 0.97102 (QuantReg: 15.75903) QuantErr: 15.75903 batch_time=3.91130 
Train Epoch: 45 [329/500 21056/32000 (66%)] Loss: 1.08502 (QuantReg: 15.77914) QuantErr: 15.77914 batch_time=0.37950 
Train Epoch: 45 [337/500 21568/32000 (67%)] Loss: 0.87990 (QuantReg: 15.95332) QuantErr: 15.95332 batch_time=0.39962 
Train Epoch: 45 [345/500 22080/32000 (69%)] Loss: 0.88761 (QuantReg: 15.81229) QuantErr: 15.81229 batch_time=0.38077 
Train Epoch: 45 [353/500 22592/32000 (71%)] Loss: 1.00853 (QuantReg: 15.92145) QuantErr: 15.92145 batch_time=0.42223 
Train Epoch: 45 [361/500 23104/32000 (72%)] Loss: 0.65206 (QuantReg: 15.84561) QuantErr: 15.84561 batch_time=0.39815 
Train Epoch: 45 [369/500 23616/32000 (74%)] Loss: 0.89910 (QuantReg: 15.66869) QuantErr: 15.66869 batch_time=0.38159 
Train Epoch: 45 [377/500 24128/32000 (75%)] Loss: 0.99982 (QuantReg: 15.82869) QuantErr: 15.82869 batch_time=0.37722 
Train Epoch: 45 [385/500 24640/32000 (77%)] Loss: 0.76792 (QuantReg: 15.85002) QuantErr: 15.85002 batch_time=3.87879 
Train Epoch: 45 [393/500 25152/32000 (79%)] Loss: 0.89474 (QuantReg: 15.52356) QuantErr: 15.52356 batch_time=0.39662 
Train Epoch: 45 [401/500 25664/32000 (80%)] Loss: 0.88863 (QuantReg: 15.96824) QuantErr: 15.96824 batch_time=0.39383 
Train Epoch: 45 [409/500 26176/32000 (82%)] Loss: 1.27774 (QuantReg: 16.05915) QuantErr: 16.05915 batch_time=0.38291 
Train Epoch: 45 [417/500 26688/32000 (83%)] Loss: 0.72346 (QuantReg: 15.71083) QuantErr: 15.71083 batch_time=0.39149 
Train Epoch: 45 [425/500 27200/32000 (85%)] Loss: 0.80195 (QuantReg: 15.98232) QuantErr: 15.98232 batch_time=0.41954 
Train Epoch: 45 [433/500 27712/32000 (87%)] Loss: 1.07544 (QuantReg: 15.89327) QuantErr: 15.89327 batch_time=0.39083 
Train Epoch: 45 [441/500 28224/32000 (88%)] Loss: 0.64349 (QuantReg: 16.03054) QuantErr: 16.03054 batch_time=0.43211 
Train Epoch: 45 [449/500 28736/32000 (90%)] Loss: 1.23502 (QuantReg: 15.87114) QuantErr: 15.87114 batch_time=3.87938 
Train Epoch: 45 [457/500 29248/32000 (91%)] Loss: 0.68329 (QuantReg: 15.74241) QuantErr: 15.74241 batch_time=0.43621 
Train Epoch: 45 [465/500 29760/32000 (93%)] Loss: 0.85557 (QuantReg: 15.82930) QuantErr: 15.82930 batch_time=0.38422 
Train Epoch: 45 [473/500 30272/32000 (95%)] Loss: 1.09503 (QuantReg: 15.93953) QuantErr: 15.93953 batch_time=0.38784 
Train Epoch: 45 [481/500 30784/32000 (96%)] Loss: 0.96298 (QuantReg: 15.69919) QuantErr: 15.69919 batch_time=0.40062 
Train Epoch: 45 [489/500 31296/32000 (98%)] Loss: 0.75121 (QuantReg: 15.68844) QuantErr: 15.68844 batch_time=0.38993 
Train Epoch: 45 [497/500 31808/32000 (99%)] Loss: 0.81572 (QuantReg: 15.99421) QuantErr: 15.99421 batch_time=0.38543 
Train Epoch: 45 codebook_update_time=2.15032
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch45.pth ...
Done in 4.147s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 0.9459196510314941
 quant_reg      : 15.836544713974
 quant_err      : 15.836544713974
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 22500
 LSMDC_full_test/t2v_metrics/R1: 12.2
 LSMDC_full_test/t2v_metrics/R5: 30.5
 LSMDC_full_test/t2v_metrics/R10: 40.1
 LSMDC_full_test/t2v_metrics/R50: 65.7
 LSMDC_full_test/t2v_metrics/MedR: 19.5
 LSMDC_full_test/t2v_metrics/MeanR: 81.119
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.61886428422728
 LSMDC_full_test/v2t_metrics/R1: 13.0
 LSMDC_full_test/v2t_metrics/R5: 31.3
 LSMDC_full_test/v2t_metrics/R10: 40.4
 LSMDC_full_test/v2t_metrics/R50: 65.2
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 80.4
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.426681615706983
 mnt_best       : 25.975252586423483
 not_improved_count: 13
Train Epoch: 46 [1/500 64/32000 (0%)] Loss: 0.84351 (QuantReg: 15.89162) QuantErr: 15.89162 batch_time=16.22951 
Train Epoch: 46 [9/500 576/32000 (2%)] Loss: 0.99725 (QuantReg: 15.69624) QuantErr: 15.69624 batch_time=0.37861 
Train Epoch: 46 [17/500 1088/32000 (3%)] Loss: 0.93298 (QuantReg: 16.02635) QuantErr: 16.02635 batch_time=0.38915 
Train Epoch: 46 [25/500 1600/32000 (5%)] Loss: 0.86431 (QuantReg: 15.83163) QuantErr: 15.83163 batch_time=0.44775 
Train Epoch: 46 [33/500 2112/32000 (7%)] Loss: 1.06288 (QuantReg: 15.92504) QuantErr: 15.92504 batch_time=0.38088 
Train Epoch: 46 [41/500 2624/32000 (8%)] Loss: 0.94909 (QuantReg: 15.75986) QuantErr: 15.75986 batch_time=0.38060 
Train Epoch: 46 [49/500 3136/32000 (10%)] Loss: 0.90578 (QuantReg: 15.78655) QuantErr: 15.78655 batch_time=0.38126 
Train Epoch: 46 [57/500 3648/32000 (11%)] Loss: 0.77724 (QuantReg: 16.05065) QuantErr: 16.05065 batch_time=0.38191 
Train Epoch: 46 [65/500 4160/32000 (13%)] Loss: 0.82410 (QuantReg: 15.86360) QuantErr: 15.86360 batch_time=0.53658 
Train Epoch: 46 [73/500 4672/32000 (15%)] Loss: 0.64574 (QuantReg: 15.65462) QuantErr: 15.65462 batch_time=0.38640 
Train Epoch: 46 [81/500 5184/32000 (16%)] Loss: 0.97227 (QuantReg: 15.73603) QuantErr: 15.73603 batch_time=0.40963 
Train Epoch: 46 [89/500 5696/32000 (18%)] Loss: 1.04443 (QuantReg: 15.78410) QuantErr: 15.78410 batch_time=0.47308 
Train Epoch: 46 [97/500 6208/32000 (19%)] Loss: 0.89689 (QuantReg: 15.78161) QuantErr: 15.78161 batch_time=0.37341 
Train Epoch: 46 [105/500 6720/32000 (21%)] Loss: 1.13244 (QuantReg: 15.87918) QuantErr: 15.87918 batch_time=0.37695 
Train Epoch: 46 [113/500 7232/32000 (23%)] Loss: 1.16985 (QuantReg: 15.72049) QuantErr: 15.72049 batch_time=0.37754 
Train Epoch: 46 [121/500 7744/32000 (24%)] Loss: 1.12830 (QuantReg: 15.67491) QuantErr: 15.67491 batch_time=0.37400 
Train Epoch: 46 [129/500 8256/32000 (26%)] Loss: 1.18905 (QuantReg: 15.94582) QuantErr: 15.94582 batch_time=0.53794 
Train Epoch: 46 [137/500 8768/32000 (27%)] Loss: 1.19754 (QuantReg: 15.72254) QuantErr: 15.72254 batch_time=0.38061 
Train Epoch: 46 [145/500 9280/32000 (29%)] Loss: 1.25362 (QuantReg: 15.99835) QuantErr: 15.99835 batch_time=0.39110 
Train Epoch: 46 [153/500 9792/32000 (31%)] Loss: 1.04560 (QuantReg: 15.82572) QuantErr: 15.82572 batch_time=0.43723 
Train Epoch: 46 [161/500 10304/32000 (32%)] Loss: 1.01494 (QuantReg: 15.74771) QuantErr: 15.74771 batch_time=0.37740 
Train Epoch: 46 [169/500 10816/32000 (34%)] Loss: 0.78289 (QuantReg: 15.63734) QuantErr: 15.63734 batch_time=0.39163 
Train Epoch: 46 [177/500 11328/32000 (35%)] Loss: 1.19170 (QuantReg: 15.71844) QuantErr: 15.71844 batch_time=0.38069 
Train Epoch: 46 [185/500 11840/32000 (37%)] Loss: 0.69001 (QuantReg: 15.93611) QuantErr: 15.93611 batch_time=0.37491 
Train Epoch: 46 [193/500 12352/32000 (39%)] Loss: 1.04083 (QuantReg: 16.09282) QuantErr: 16.09282 batch_time=0.54409 
Train Epoch: 46 [201/500 12864/32000 (40%)] Loss: 0.91461 (QuantReg: 15.88663) QuantErr: 15.88663 batch_time=0.38069 
Train Epoch: 46 [209/500 13376/32000 (42%)] Loss: 1.03977 (QuantReg: 15.90274) QuantErr: 15.90274 batch_time=0.37897 
Train Epoch: 46 [217/500 13888/32000 (43%)] Loss: 0.86050 (QuantReg: 15.90401) QuantErr: 15.90401 batch_time=0.43510 
Train Epoch: 46 [225/500 14400/32000 (45%)] Loss: 0.80175 (QuantReg: 15.71819) QuantErr: 15.71819 batch_time=0.38411 
Train Epoch: 46 [233/500 14912/32000 (47%)] Loss: 0.89174 (QuantReg: 15.80999) QuantErr: 15.80999 batch_time=0.37799 
Train Epoch: 46 [241/500 15424/32000 (48%)] Loss: 0.85619 (QuantReg: 15.95332) QuantErr: 15.95332 batch_time=0.37675 
Train Epoch: 46 [249/500 15936/32000 (50%)] Loss: 0.63582 (QuantReg: 15.90088) QuantErr: 15.90088 batch_time=0.38150 
Train Epoch: 46 [257/500 16448/32000 (51%)] Loss: 1.05643 (QuantReg: 15.90403) QuantErr: 15.90403 batch_time=0.52760 
Train Epoch: 46 [265/500 16960/32000 (53%)] Loss: 1.10177 (QuantReg: 16.11219) QuantErr: 16.11219 batch_time=0.37929 
Train Epoch: 46 [273/500 17472/32000 (55%)] Loss: 0.93328 (QuantReg: 15.71752) QuantErr: 15.71752 batch_time=0.39505 
Train Epoch: 46 [281/500 17984/32000 (56%)] Loss: 0.84907 (QuantReg: 15.91887) QuantErr: 15.91887 batch_time=0.43550 
Train Epoch: 46 [289/500 18496/32000 (58%)] Loss: 0.87238 (QuantReg: 15.92783) QuantErr: 15.92783 batch_time=0.38204 
Train Epoch: 46 [297/500 19008/32000 (59%)] Loss: 0.97152 (QuantReg: 15.95724) QuantErr: 15.95724 batch_time=0.38889 
Train Epoch: 46 [305/500 19520/32000 (61%)] Loss: 1.01109 (QuantReg: 16.04559) QuantErr: 16.04559 batch_time=0.38593 
Train Epoch: 46 [313/500 20032/32000 (63%)] Loss: 0.78400 (QuantReg: 16.02676) QuantErr: 16.02676 batch_time=0.38977 
Train Epoch: 46 [321/500 20544/32000 (64%)] Loss: 0.84909 (QuantReg: 15.47334) QuantErr: 15.47334 batch_time=0.53473 
Train Epoch: 46 [329/500 21056/32000 (66%)] Loss: 1.14080 (QuantReg: 15.78150) QuantErr: 15.78150 batch_time=0.38213 
Train Epoch: 46 [337/500 21568/32000 (67%)] Loss: 1.24926 (QuantReg: 15.99425) QuantErr: 15.99425 batch_time=0.37882 
Train Epoch: 46 [345/500 22080/32000 (69%)] Loss: 0.89459 (QuantReg: 16.12097) QuantErr: 16.12097 batch_time=0.43447 
Train Epoch: 46 [353/500 22592/32000 (71%)] Loss: 0.73578 (QuantReg: 16.15548) QuantErr: 16.15548 batch_time=0.37855 
Train Epoch: 46 [361/500 23104/32000 (72%)] Loss: 0.91526 (QuantReg: 15.78299) QuantErr: 15.78299 batch_time=0.37753 
Train Epoch: 46 [369/500 23616/32000 (74%)] Loss: 0.91608 (QuantReg: 16.00015) QuantErr: 16.00015 batch_time=0.37675 
Train Epoch: 46 [377/500 24128/32000 (75%)] Loss: 0.80194 (QuantReg: 15.73786) QuantErr: 15.73786 batch_time=0.37575 
Train Epoch: 46 [385/500 24640/32000 (77%)] Loss: 1.02909 (QuantReg: 15.88616) QuantErr: 15.88616 batch_time=0.52062 
Train Epoch: 46 [393/500 25152/32000 (79%)] Loss: 1.10196 (QuantReg: 16.04046) QuantErr: 16.04046 batch_time=0.38236 
Train Epoch: 46 [401/500 25664/32000 (80%)] Loss: 0.90590 (QuantReg: 15.96265) QuantErr: 15.96265 batch_time=0.38349 
Train Epoch: 46 [409/500 26176/32000 (82%)] Loss: 0.96231 (QuantReg: 15.90949) QuantErr: 15.90949 batch_time=0.43362 
Train Epoch: 46 [417/500 26688/32000 (83%)] Loss: 1.12230 (QuantReg: 15.80785) QuantErr: 15.80785 batch_time=0.39846 
Train Epoch: 46 [425/500 27200/32000 (85%)] Loss: 0.89835 (QuantReg: 15.65073) QuantErr: 15.65073 batch_time=0.38298 
Train Epoch: 46 [433/500 27712/32000 (87%)] Loss: 0.84315 (QuantReg: 15.88196) QuantErr: 15.88196 batch_time=0.38764 
Train Epoch: 46 [441/500 28224/32000 (88%)] Loss: 0.97917 (QuantReg: 15.58409) QuantErr: 15.58409 batch_time=0.38996 
Train Epoch: 46 [449/500 28736/32000 (90%)] Loss: 1.14982 (QuantReg: 15.85093) QuantErr: 15.85093 batch_time=0.59244 
Train Epoch: 46 [457/500 29248/32000 (91%)] Loss: 0.86220 (QuantReg: 15.64548) QuantErr: 15.64548 batch_time=0.39373 
Train Epoch: 46 [465/500 29760/32000 (93%)] Loss: 0.78439 (QuantReg: 16.00366) QuantErr: 16.00366 batch_time=0.39452 
Train Epoch: 46 [473/500 30272/32000 (95%)] Loss: 0.98479 (QuantReg: 15.56557) QuantErr: 15.56557 batch_time=0.43329 
Train Epoch: 46 [481/500 30784/32000 (96%)] Loss: 1.04629 (QuantReg: 15.64621) QuantErr: 15.64621 batch_time=0.38816 
Train Epoch: 46 [489/500 31296/32000 (98%)] Loss: 1.06246 (QuantReg: 15.88222) QuantErr: 15.88222 batch_time=0.39497 
Train Epoch: 46 [497/500 31808/32000 (99%)] Loss: 0.88186 (QuantReg: 15.89847) QuantErr: 15.89847 batch_time=0.38131 
Train Epoch: 46 codebook_update_time=2.08253
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch46.pth ...
Done in 5.929s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 0.9534571129083633
 quant_reg      : 15.853786149978637
 quant_err      : 15.853786149978637
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 23000
 LSMDC_full_test/t2v_metrics/R1: 12.9
 LSMDC_full_test/t2v_metrics/R5: 31.1
 LSMDC_full_test/t2v_metrics/R10: 41.0
 LSMDC_full_test/t2v_metrics/R50: 66.1
 LSMDC_full_test/t2v_metrics/MedR: 19.5
 LSMDC_full_test/t2v_metrics/MeanR: 80.542
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.431851871167694
 LSMDC_full_test/v2t_metrics/R1: 13.6
 LSMDC_full_test/v2t_metrics/R5: 30.3
 LSMDC_full_test/v2t_metrics/R10: 39.2
 LSMDC_full_test/v2t_metrics/R50: 66.2
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 78.945
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.278765896065643
 mnt_best       : 25.975252586423483
 not_improved_count: 14
Train Epoch: 47 [1/500 64/32000 (0%)] Loss: 1.00323 (QuantReg: 16.00407) QuantErr: 16.00407 batch_time=17.55026 
Train Epoch: 47 [9/500 576/32000 (2%)] Loss: 0.74850 (QuantReg: 15.64088) QuantErr: 15.64088 batch_time=0.43523 
Train Epoch: 47 [17/500 1088/32000 (3%)] Loss: 0.85362 (QuantReg: 15.66325) QuantErr: 15.66325 batch_time=0.70362 
Train Epoch: 47 [25/500 1600/32000 (5%)] Loss: 1.04668 (QuantReg: 16.01510) QuantErr: 16.01510 batch_time=0.40674 
Train Epoch: 47 [33/500 2112/32000 (7%)] Loss: 1.12556 (QuantReg: 15.77462) QuantErr: 15.77462 batch_time=0.39214 
Train Epoch: 47 [41/500 2624/32000 (8%)] Loss: 1.30042 (QuantReg: 15.98322) QuantErr: 15.98322 batch_time=0.41445 
Train Epoch: 47 [49/500 3136/32000 (10%)] Loss: 1.01218 (QuantReg: 16.10033) QuantErr: 16.10033 batch_time=0.39164 
Train Epoch: 47 [57/500 3648/32000 (11%)] Loss: 0.76673 (QuantReg: 16.01902) QuantErr: 16.01902 batch_time=0.40164 
Train Epoch: 47 [65/500 4160/32000 (13%)] Loss: 1.16406 (QuantReg: 15.69153) QuantErr: 15.69153 batch_time=0.39154 
Train Epoch: 47 [73/500 4672/32000 (15%)] Loss: 0.97132 (QuantReg: 15.91512) QuantErr: 15.91512 batch_time=0.40071 
Train Epoch: 47 [81/500 5184/32000 (16%)] Loss: 0.96661 (QuantReg: 15.81853) QuantErr: 15.81853 batch_time=0.60548 
Train Epoch: 47 [89/500 5696/32000 (18%)] Loss: 1.09216 (QuantReg: 15.89422) QuantErr: 15.89422 batch_time=0.39477 
Train Epoch: 47 [97/500 6208/32000 (19%)] Loss: 0.75707 (QuantReg: 16.00005) QuantErr: 16.00005 batch_time=0.39028 
Train Epoch: 47 [105/500 6720/32000 (21%)] Loss: 0.99894 (QuantReg: 15.83512) QuantErr: 15.83512 batch_time=0.39137 
Train Epoch: 47 [113/500 7232/32000 (23%)] Loss: 0.73947 (QuantReg: 15.78949) QuantErr: 15.78949 batch_time=0.39039 
Train Epoch: 47 [121/500 7744/32000 (24%)] Loss: 1.16070 (QuantReg: 15.70376) QuantErr: 15.70376 batch_time=0.38524 
Train Epoch: 47 [129/500 8256/32000 (26%)] Loss: 0.80663 (QuantReg: 16.02953) QuantErr: 16.02953 batch_time=0.40930 
Train Epoch: 47 [137/500 8768/32000 (27%)] Loss: 0.82718 (QuantReg: 15.98972) QuantErr: 15.98972 batch_time=0.39243 
Train Epoch: 47 [145/500 9280/32000 (29%)] Loss: 0.92517 (QuantReg: 15.57386) QuantErr: 15.57386 batch_time=0.61325 
Train Epoch: 47 [153/500 9792/32000 (31%)] Loss: 1.11720 (QuantReg: 15.66544) QuantErr: 15.66544 batch_time=0.38613 
Train Epoch: 47 [161/500 10304/32000 (32%)] Loss: 0.83220 (QuantReg: 15.64372) QuantErr: 15.64372 batch_time=0.37805 
Train Epoch: 47 [169/500 10816/32000 (34%)] Loss: 0.53089 (QuantReg: 15.88542) QuantErr: 15.88542 batch_time=0.38291 
Train Epoch: 47 [177/500 11328/32000 (35%)] Loss: 0.90051 (QuantReg: 15.83657) QuantErr: 15.83657 batch_time=0.39139 
Train Epoch: 47 [185/500 11840/32000 (37%)] Loss: 0.90121 (QuantReg: 16.07624) QuantErr: 16.07624 batch_time=0.40950 
Train Epoch: 47 [193/500 12352/32000 (39%)] Loss: 0.83011 (QuantReg: 15.70883) QuantErr: 15.70883 batch_time=0.39742 
Train Epoch: 47 [201/500 12864/32000 (40%)] Loss: 0.91744 (QuantReg: 16.07466) QuantErr: 16.07466 batch_time=0.39233 
Train Epoch: 47 [209/500 13376/32000 (42%)] Loss: 1.39619 (QuantReg: 15.67864) QuantErr: 15.67864 batch_time=0.60043 
Train Epoch: 47 [217/500 13888/32000 (43%)] Loss: 1.20060 (QuantReg: 15.73329) QuantErr: 15.73329 batch_time=0.39607 
Train Epoch: 47 [225/500 14400/32000 (45%)] Loss: 1.05684 (QuantReg: 15.87342) QuantErr: 15.87342 batch_time=0.38471 
Train Epoch: 47 [233/500 14912/32000 (47%)] Loss: 1.00738 (QuantReg: 15.90170) QuantErr: 15.90170 batch_time=0.40310 
Train Epoch: 47 [241/500 15424/32000 (48%)] Loss: 0.82023 (QuantReg: 16.01344) QuantErr: 16.01344 batch_time=0.38482 
Train Epoch: 47 [249/500 15936/32000 (50%)] Loss: 1.14822 (QuantReg: 15.79128) QuantErr: 15.79128 batch_time=0.38517 
Train Epoch: 47 [257/500 16448/32000 (51%)] Loss: 0.97278 (QuantReg: 15.88533) QuantErr: 15.88533 batch_time=0.38491 
Train Epoch: 47 [265/500 16960/32000 (53%)] Loss: 0.88712 (QuantReg: 15.69877) QuantErr: 15.69877 batch_time=0.38692 
Train Epoch: 47 [273/500 17472/32000 (55%)] Loss: 0.99437 (QuantReg: 15.71123) QuantErr: 15.71123 batch_time=0.59878 
Train Epoch: 47 [281/500 17984/32000 (56%)] Loss: 1.12724 (QuantReg: 15.80419) QuantErr: 15.80419 batch_time=0.38565 
Train Epoch: 47 [289/500 18496/32000 (58%)] Loss: 1.05757 (QuantReg: 15.95567) QuantErr: 15.95567 batch_time=0.38742 
Train Epoch: 47 [297/500 19008/32000 (59%)] Loss: 0.96906 (QuantReg: 15.68307) QuantErr: 15.68307 batch_time=0.39355 
Train Epoch: 47 [305/500 19520/32000 (61%)] Loss: 0.82103 (QuantReg: 15.83032) QuantErr: 15.83032 batch_time=0.37956 
Train Epoch: 47 [313/500 20032/32000 (63%)] Loss: 1.05029 (QuantReg: 16.08466) QuantErr: 16.08466 batch_time=0.38039 
Train Epoch: 47 [321/500 20544/32000 (64%)] Loss: 0.71541 (QuantReg: 15.85846) QuantErr: 15.85846 batch_time=0.38511 
Train Epoch: 47 [329/500 21056/32000 (66%)] Loss: 0.74595 (QuantReg: 15.96578) QuantErr: 15.96578 batch_time=0.39181 
Train Epoch: 47 [337/500 21568/32000 (67%)] Loss: 1.10684 (QuantReg: 15.78059) QuantErr: 15.78059 batch_time=0.60260 
Train Epoch: 47 [345/500 22080/32000 (69%)] Loss: 0.74202 (QuantReg: 15.83119) QuantErr: 15.83119 batch_time=0.38620 
Train Epoch: 47 [353/500 22592/32000 (71%)] Loss: 0.92854 (QuantReg: 15.80451) QuantErr: 15.80451 batch_time=0.39223 
Train Epoch: 47 [361/500 23104/32000 (72%)] Loss: 0.86312 (QuantReg: 15.98577) QuantErr: 15.98577 batch_time=0.39616 
Train Epoch: 47 [369/500 23616/32000 (74%)] Loss: 0.93328 (QuantReg: 15.82806) QuantErr: 15.82806 batch_time=0.39702 
Train Epoch: 47 [377/500 24128/32000 (75%)] Loss: 0.99512 (QuantReg: 16.04755) QuantErr: 16.04755 batch_time=0.37936 
Train Epoch: 47 [385/500 24640/32000 (77%)] Loss: 0.85115 (QuantReg: 15.87143) QuantErr: 15.87143 batch_time=0.38650 
Train Epoch: 47 [393/500 25152/32000 (79%)] Loss: 0.86868 (QuantReg: 16.05593) QuantErr: 16.05593 batch_time=0.38366 
Train Epoch: 47 [401/500 25664/32000 (80%)] Loss: 1.18438 (QuantReg: 15.76747) QuantErr: 15.76747 batch_time=0.58559 
Train Epoch: 47 [409/500 26176/32000 (82%)] Loss: 1.05337 (QuantReg: 16.11591) QuantErr: 16.11591 batch_time=0.39024 
Train Epoch: 47 [417/500 26688/32000 (83%)] Loss: 0.84819 (QuantReg: 15.76421) QuantErr: 15.76421 batch_time=0.38313 
Train Epoch: 47 [425/500 27200/32000 (85%)] Loss: 0.87756 (QuantReg: 15.77440) QuantErr: 15.77440 batch_time=0.40177 
Train Epoch: 47 [433/500 27712/32000 (87%)] Loss: 0.98806 (QuantReg: 15.91501) QuantErr: 15.91501 batch_time=0.38231 
Train Epoch: 47 [441/500 28224/32000 (88%)] Loss: 0.81358 (QuantReg: 16.06907) QuantErr: 16.06907 batch_time=0.38252 
Train Epoch: 47 [449/500 28736/32000 (90%)] Loss: 1.19143 (QuantReg: 15.74463) QuantErr: 15.74463 batch_time=0.38521 
Train Epoch: 47 [457/500 29248/32000 (91%)] Loss: 0.94609 (QuantReg: 15.92568) QuantErr: 15.92568 batch_time=0.40823 
Train Epoch: 47 [465/500 29760/32000 (93%)] Loss: 1.01585 (QuantReg: 15.84278) QuantErr: 15.84278 batch_time=0.60875 
Train Epoch: 47 [473/500 30272/32000 (95%)] Loss: 0.76181 (QuantReg: 15.97337) QuantErr: 15.97337 batch_time=0.41040 
Train Epoch: 47 [481/500 30784/32000 (96%)] Loss: 1.11883 (QuantReg: 15.79719) QuantErr: 15.79719 batch_time=0.40618 
Train Epoch: 47 [489/500 31296/32000 (98%)] Loss: 1.01523 (QuantReg: 15.64012) QuantErr: 15.64012 batch_time=0.38563 
Train Epoch: 47 [497/500 31808/32000 (99%)] Loss: 0.92650 (QuantReg: 15.86716) QuantErr: 15.86716 batch_time=0.38592 
Train Epoch: 47 codebook_update_time=1.97476
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch47.pth ...
Done in 4.391s
removing stale ckpt [epoch 46] [took 0.05s]
 epoch          : 47
 loss           : 0.9443666387796402
 quant_reg      : 15.85337139892578
 quant_err      : 15.85337139892578
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 23500
 LSMDC_full_test/t2v_metrics/R1: 13.6
 LSMDC_full_test/t2v_metrics/R5: 29.0
 LSMDC_full_test/t2v_metrics/R10: 40.6
 LSMDC_full_test/t2v_metrics/R50: 65.9
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 81.353
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.205054835489573
 LSMDC_full_test/v2t_metrics/R1: 12.8
 LSMDC_full_test/v2t_metrics/R5: 30.7
 LSMDC_full_test/v2t_metrics/R10: 40.2
 LSMDC_full_test/v2t_metrics/R50: 66.5
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 80.022
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.091394541026748
 mnt_best       : 25.975252586423483
 not_improved_count: 15
Train Epoch: 48 [1/500 64/32000 (0%)] Loss: 0.97929 (QuantReg: 15.87510) QuantErr: 15.87510 batch_time=17.77084 
Train Epoch: 48 [9/500 576/32000 (2%)] Loss: 1.09416 (QuantReg: 15.64386) QuantErr: 15.64386 batch_time=0.39136 
Train Epoch: 48 [17/500 1088/32000 (3%)] Loss: 0.96665 (QuantReg: 15.94453) QuantErr: 15.94453 batch_time=1.00267 
Train Epoch: 48 [25/500 1600/32000 (5%)] Loss: 0.98208 (QuantReg: 15.74486) QuantErr: 15.74486 batch_time=0.73949 
Train Epoch: 48 [33/500 2112/32000 (7%)] Loss: 1.01421 (QuantReg: 15.85846) QuantErr: 15.85846 batch_time=0.38495 
Train Epoch: 48 [41/500 2624/32000 (8%)] Loss: 1.04815 (QuantReg: 15.80206) QuantErr: 15.80206 batch_time=0.38560 
Train Epoch: 48 [49/500 3136/32000 (10%)] Loss: 1.12523 (QuantReg: 15.91090) QuantErr: 15.91090 batch_time=0.42869 
Train Epoch: 48 [57/500 3648/32000 (11%)] Loss: 1.12997 (QuantReg: 15.79943) QuantErr: 15.79943 batch_time=0.41740 
Train Epoch: 48 [65/500 4160/32000 (13%)] Loss: 0.88791 (QuantReg: 15.83126) QuantErr: 15.83126 batch_time=0.90638 
Train Epoch: 48 [73/500 4672/32000 (15%)] Loss: 0.76605 (QuantReg: 15.78643) QuantErr: 15.78643 batch_time=0.39213 
Train Epoch: 48 [81/500 5184/32000 (16%)] Loss: 0.94742 (QuantReg: 15.95642) QuantErr: 15.95642 batch_time=0.88092 
Train Epoch: 48 [89/500 5696/32000 (18%)] Loss: 0.83331 (QuantReg: 15.74582) QuantErr: 15.74582 batch_time=0.66385 
Train Epoch: 48 [97/500 6208/32000 (19%)] Loss: 0.76330 (QuantReg: 15.71769) QuantErr: 15.71769 batch_time=0.40900 
Train Epoch: 48 [105/500 6720/32000 (21%)] Loss: 0.79606 (QuantReg: 15.63700) QuantErr: 15.63700 batch_time=0.38930 
Train Epoch: 48 [113/500 7232/32000 (23%)] Loss: 1.01190 (QuantReg: 15.95114) QuantErr: 15.95114 batch_time=0.39069 
Train Epoch: 48 [121/500 7744/32000 (24%)] Loss: 0.75124 (QuantReg: 15.93888) QuantErr: 15.93888 batch_time=0.40108 
Train Epoch: 48 [129/500 8256/32000 (26%)] Loss: 1.09127 (QuantReg: 15.81926) QuantErr: 15.81926 batch_time=0.86782 
Train Epoch: 48 [137/500 8768/32000 (27%)] Loss: 0.96404 (QuantReg: 15.87686) QuantErr: 15.87686 batch_time=0.38908 
Train Epoch: 48 [145/500 9280/32000 (29%)] Loss: 0.71895 (QuantReg: 15.87772) QuantErr: 15.87772 batch_time=0.87591 
Train Epoch: 48 [153/500 9792/32000 (31%)] Loss: 0.88335 (QuantReg: 15.75896) QuantErr: 15.75896 batch_time=0.67106 
Train Epoch: 48 [161/500 10304/32000 (32%)] Loss: 0.80466 (QuantReg: 16.18402) QuantErr: 16.18402 batch_time=0.38406 
Train Epoch: 48 [169/500 10816/32000 (34%)] Loss: 0.87538 (QuantReg: 15.71065) QuantErr: 15.71065 batch_time=0.38897 
Train Epoch: 48 [177/500 11328/32000 (35%)] Loss: 0.86634 (QuantReg: 15.86618) QuantErr: 15.86618 batch_time=0.38357 
Train Epoch: 48 [185/500 11840/32000 (37%)] Loss: 0.83321 (QuantReg: 15.83391) QuantErr: 15.83391 batch_time=0.40178 
Train Epoch: 48 [193/500 12352/32000 (39%)] Loss: 1.00804 (QuantReg: 15.91267) QuantErr: 15.91267 batch_time=0.89383 
Train Epoch: 48 [201/500 12864/32000 (40%)] Loss: 0.81038 (QuantReg: 15.61171) QuantErr: 15.61171 batch_time=0.38956 
Train Epoch: 48 [209/500 13376/32000 (42%)] Loss: 0.85159 (QuantReg: 15.70736) QuantErr: 15.70736 batch_time=0.87594 
Train Epoch: 48 [217/500 13888/32000 (43%)] Loss: 0.75345 (QuantReg: 15.64121) QuantErr: 15.64121 batch_time=0.63545 
Train Epoch: 48 [225/500 14400/32000 (45%)] Loss: 0.91586 (QuantReg: 15.84457) QuantErr: 15.84457 batch_time=0.38439 
Train Epoch: 48 [233/500 14912/32000 (47%)] Loss: 1.02671 (QuantReg: 15.98996) QuantErr: 15.98996 batch_time=0.38257 
Train Epoch: 48 [241/500 15424/32000 (48%)] Loss: 0.90533 (QuantReg: 15.62296) QuantErr: 15.62296 batch_time=0.38029 
Train Epoch: 48 [249/500 15936/32000 (50%)] Loss: 0.93199 (QuantReg: 15.84398) QuantErr: 15.84398 batch_time=0.36784 
Train Epoch: 48 [257/500 16448/32000 (51%)] Loss: 0.90804 (QuantReg: 16.11120) QuantErr: 16.11120 batch_time=0.91222 
Train Epoch: 48 [265/500 16960/32000 (53%)] Loss: 1.21126 (QuantReg: 15.98717) QuantErr: 15.98717 batch_time=0.40021 
Train Epoch: 48 [273/500 17472/32000 (55%)] Loss: 1.05547 (QuantReg: 15.74924) QuantErr: 15.74924 batch_time=0.88299 
Train Epoch: 48 [281/500 17984/32000 (56%)] Loss: 0.88753 (QuantReg: 15.82931) QuantErr: 15.82931 batch_time=0.63599 
Train Epoch: 48 [289/500 18496/32000 (58%)] Loss: 0.93432 (QuantReg: 15.84642) QuantErr: 15.84642 batch_time=0.38525 
Train Epoch: 48 [297/500 19008/32000 (59%)] Loss: 0.86385 (QuantReg: 15.89244) QuantErr: 15.89244 batch_time=0.40556 
Train Epoch: 48 [305/500 19520/32000 (61%)] Loss: 0.72119 (QuantReg: 15.84752) QuantErr: 15.84752 batch_time=0.38513 
Train Epoch: 48 [313/500 20032/32000 (63%)] Loss: 0.80993 (QuantReg: 15.97630) QuantErr: 15.97630 batch_time=0.42202 
Train Epoch: 48 [321/500 20544/32000 (64%)] Loss: 0.74181 (QuantReg: 16.01341) QuantErr: 16.01341 batch_time=0.89416 
Train Epoch: 48 [329/500 21056/32000 (66%)] Loss: 0.92810 (QuantReg: 15.84807) QuantErr: 15.84807 batch_time=0.39138 
Train Epoch: 48 [337/500 21568/32000 (67%)] Loss: 0.80194 (QuantReg: 15.86031) QuantErr: 15.86031 batch_time=0.88021 
Train Epoch: 48 [345/500 22080/32000 (69%)] Loss: 0.98987 (QuantReg: 16.06392) QuantErr: 16.06392 batch_time=0.66511 
Train Epoch: 48 [353/500 22592/32000 (71%)] Loss: 0.97033 (QuantReg: 15.83933) QuantErr: 15.83933 batch_time=0.38460 
Train Epoch: 48 [361/500 23104/32000 (72%)] Loss: 0.89040 (QuantReg: 15.85389) QuantErr: 15.85389 batch_time=0.38702 
Train Epoch: 48 [369/500 23616/32000 (74%)] Loss: 0.62623 (QuantReg: 15.88377) QuantErr: 15.88377 batch_time=0.40919 
Train Epoch: 48 [377/500 24128/32000 (75%)] Loss: 0.94288 (QuantReg: 15.80342) QuantErr: 15.80342 batch_time=0.37886 
Train Epoch: 48 [385/500 24640/32000 (77%)] Loss: 0.91205 (QuantReg: 15.63312) QuantErr: 15.63312 batch_time=0.85079 
Train Epoch: 48 [393/500 25152/32000 (79%)] Loss: 0.85890 (QuantReg: 15.92200) QuantErr: 15.92200 batch_time=0.39321 
Train Epoch: 48 [401/500 25664/32000 (80%)] Loss: 1.14831 (QuantReg: 15.81658) QuantErr: 15.81658 batch_time=0.88309 
Train Epoch: 48 [409/500 26176/32000 (82%)] Loss: 0.95612 (QuantReg: 15.82780) QuantErr: 15.82780 batch_time=0.65931 
Train Epoch: 48 [417/500 26688/32000 (83%)] Loss: 0.96937 (QuantReg: 15.80226) QuantErr: 15.80226 batch_time=0.38610 
Train Epoch: 48 [425/500 27200/32000 (85%)] Loss: 0.77179 (QuantReg: 15.96005) QuantErr: 15.96005 batch_time=0.38413 
Train Epoch: 48 [433/500 27712/32000 (87%)] Loss: 0.82382 (QuantReg: 15.75942) QuantErr: 15.75942 batch_time=0.38876 
Train Epoch: 48 [441/500 28224/32000 (88%)] Loss: 0.95134 (QuantReg: 16.17255) QuantErr: 16.17255 batch_time=0.38389 
Train Epoch: 48 [449/500 28736/32000 (90%)] Loss: 1.12612 (QuantReg: 15.67951) QuantErr: 15.67951 batch_time=0.88831 
Train Epoch: 48 [457/500 29248/32000 (91%)] Loss: 1.13419 (QuantReg: 16.01560) QuantErr: 16.01560 batch_time=0.38355 
Train Epoch: 48 [465/500 29760/32000 (93%)] Loss: 0.90171 (QuantReg: 15.76337) QuantErr: 15.76337 batch_time=0.88037 
Train Epoch: 48 [473/500 30272/32000 (95%)] Loss: 0.79491 (QuantReg: 15.84602) QuantErr: 15.84602 batch_time=0.67834 
Train Epoch: 48 [481/500 30784/32000 (96%)] Loss: 1.20549 (QuantReg: 15.83234) QuantErr: 15.83234 batch_time=0.38359 
Train Epoch: 48 [489/500 31296/32000 (98%)] Loss: 0.88536 (QuantReg: 15.91952) QuantErr: 15.91952 batch_time=0.43082 
Train Epoch: 48 [497/500 31808/32000 (99%)] Loss: 1.05153 (QuantReg: 15.78541) QuantErr: 15.78541 batch_time=0.37861 
Train Epoch: 48 codebook_update_time=2.31636
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch48.pth ...
Done in 3.824s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 0.9279778873920441
 quant_reg      : 15.846727479934692
 quant_err      : 15.846727479934692
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 24000
 LSMDC_full_test/t2v_metrics/R1: 12.8
 LSMDC_full_test/t2v_metrics/R5: 30.5
 LSMDC_full_test/t2v_metrics/R10: 40.2
 LSMDC_full_test/t2v_metrics/R50: 65.7
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 81.898
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.03678850435027
 LSMDC_full_test/v2t_metrics/R1: 13.6
 LSMDC_full_test/v2t_metrics/R5: 32.0
 LSMDC_full_test/v2t_metrics/R10: 40.9
 LSMDC_full_test/v2t_metrics/R50: 65.2
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 80.629
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.10983124689271
 mnt_best       : 25.975252586423483
 not_improved_count: 16
Train Epoch: 49 [1/500 64/32000 (0%)] Loss: 0.96456 (QuantReg: 15.80325) QuantErr: 15.80325 batch_time=18.98905 
Train Epoch: 49 [9/500 576/32000 (2%)] Loss: 0.94172 (QuantReg: 15.74888) QuantErr: 15.74888 batch_time=0.38289 
Train Epoch: 49 [17/500 1088/32000 (3%)] Loss: 0.86988 (QuantReg: 15.91922) QuantErr: 15.91922 batch_time=0.39089 
Train Epoch: 49 [25/500 1600/32000 (5%)] Loss: 0.92428 (QuantReg: 15.95031) QuantErr: 15.95031 batch_time=0.40394 
Train Epoch: 49 [33/500 2112/32000 (7%)] Loss: 0.78316 (QuantReg: 16.03633) QuantErr: 16.03633 batch_time=0.39304 
Train Epoch: 49 [41/500 2624/32000 (8%)] Loss: 0.87073 (QuantReg: 15.95537) QuantErr: 15.95537 batch_time=0.37096 
Train Epoch: 49 [49/500 3136/32000 (10%)] Loss: 0.73372 (QuantReg: 15.79796) QuantErr: 15.79796 batch_time=0.37900 
Train Epoch: 49 [57/500 3648/32000 (11%)] Loss: 0.76934 (QuantReg: 16.08767) QuantErr: 16.08767 batch_time=0.50363 
Train Epoch: 49 [65/500 4160/32000 (13%)] Loss: 0.95030 (QuantReg: 15.78240) QuantErr: 15.78240 batch_time=0.44529 
Train Epoch: 49 [73/500 4672/32000 (15%)] Loss: 0.89800 (QuantReg: 15.85747) QuantErr: 15.85747 batch_time=0.39053 
Train Epoch: 49 [81/500 5184/32000 (16%)] Loss: 1.14214 (QuantReg: 15.80973) QuantErr: 15.80973 batch_time=0.40587 
Train Epoch: 49 [89/500 5696/32000 (18%)] Loss: 1.12520 (QuantReg: 15.84682) QuantErr: 15.84682 batch_time=0.39685 
Train Epoch: 49 [97/500 6208/32000 (19%)] Loss: 0.81338 (QuantReg: 15.74490) QuantErr: 15.74490 batch_time=0.40952 
Train Epoch: 49 [105/500 6720/32000 (21%)] Loss: 0.79707 (QuantReg: 15.80924) QuantErr: 15.80924 batch_time=0.40377 
Train Epoch: 49 [113/500 7232/32000 (23%)] Loss: 1.01304 (QuantReg: 15.88687) QuantErr: 15.88687 batch_time=0.38627 
Train Epoch: 49 [121/500 7744/32000 (24%)] Loss: 0.98808 (QuantReg: 15.65556) QuantErr: 15.65556 batch_time=0.51230 
Train Epoch: 49 [129/500 8256/32000 (26%)] Loss: 0.86464 (QuantReg: 15.92484) QuantErr: 15.92484 batch_time=0.44912 
Train Epoch: 49 [137/500 8768/32000 (27%)] Loss: 1.02183 (QuantReg: 15.89223) QuantErr: 15.89223 batch_time=0.39211 
Train Epoch: 49 [145/500 9280/32000 (29%)] Loss: 0.94007 (QuantReg: 15.62539) QuantErr: 15.62539 batch_time=0.38797 
Train Epoch: 49 [153/500 9792/32000 (31%)] Loss: 0.70350 (QuantReg: 15.87293) QuantErr: 15.87293 batch_time=0.39237 
Train Epoch: 49 [161/500 10304/32000 (32%)] Loss: 0.76761 (QuantReg: 15.78720) QuantErr: 15.78720 batch_time=0.38813 
Train Epoch: 49 [169/500 10816/32000 (34%)] Loss: 1.04147 (QuantReg: 15.81284) QuantErr: 15.81284 batch_time=0.39208 
Train Epoch: 49 [177/500 11328/32000 (35%)] Loss: 0.95533 (QuantReg: 15.75942) QuantErr: 15.75942 batch_time=0.38284 
Train Epoch: 49 [185/500 11840/32000 (37%)] Loss: 0.95465 (QuantReg: 15.76982) QuantErr: 15.76982 batch_time=0.50496 
Train Epoch: 49 [193/500 12352/32000 (39%)] Loss: 0.99535 (QuantReg: 15.68777) QuantErr: 15.68777 batch_time=0.44350 
Train Epoch: 49 [201/500 12864/32000 (40%)] Loss: 1.05499 (QuantReg: 15.94264) QuantErr: 15.94264 batch_time=0.39153 
Train Epoch: 49 [209/500 13376/32000 (42%)] Loss: 0.74878 (QuantReg: 15.75566) QuantErr: 15.75566 batch_time=0.41343 
Train Epoch: 49 [217/500 13888/32000 (43%)] Loss: 0.78656 (QuantReg: 15.80317) QuantErr: 15.80317 batch_time=0.38839 
Train Epoch: 49 [225/500 14400/32000 (45%)] Loss: 0.92011 (QuantReg: 15.97880) QuantErr: 15.97880 batch_time=0.38544 
Train Epoch: 49 [233/500 14912/32000 (47%)] Loss: 0.78158 (QuantReg: 15.85473) QuantErr: 15.85473 batch_time=0.38306 
Train Epoch: 49 [241/500 15424/32000 (48%)] Loss: 0.99354 (QuantReg: 16.03279) QuantErr: 16.03279 batch_time=0.38410 
Train Epoch: 49 [249/500 15936/32000 (50%)] Loss: 0.73566 (QuantReg: 15.63283) QuantErr: 15.63283 batch_time=0.51560 
Train Epoch: 49 [257/500 16448/32000 (51%)] Loss: 0.95964 (QuantReg: 15.94303) QuantErr: 15.94303 batch_time=0.44089 
Train Epoch: 49 [265/500 16960/32000 (53%)] Loss: 0.85474 (QuantReg: 15.85028) QuantErr: 15.85028 batch_time=0.38402 
Train Epoch: 49 [273/500 17472/32000 (55%)] Loss: 1.10574 (QuantReg: 15.78374) QuantErr: 15.78374 batch_time=0.38712 
Train Epoch: 49 [281/500 17984/32000 (56%)] Loss: 0.86042 (QuantReg: 15.84892) QuantErr: 15.84892 batch_time=0.38663 
Train Epoch: 49 [289/500 18496/32000 (58%)] Loss: 1.07058 (QuantReg: 15.92525) QuantErr: 15.92525 batch_time=0.38972 
Train Epoch: 49 [297/500 19008/32000 (59%)] Loss: 0.76895 (QuantReg: 15.77863) QuantErr: 15.77863 batch_time=0.38253 
Train Epoch: 49 [305/500 19520/32000 (61%)] Loss: 0.84028 (QuantReg: 15.82328) QuantErr: 15.82328 batch_time=0.39736 
Train Epoch: 49 [313/500 20032/32000 (63%)] Loss: 1.16315 (QuantReg: 15.83300) QuantErr: 15.83300 batch_time=0.50154 
Train Epoch: 49 [321/500 20544/32000 (64%)] Loss: 0.88278 (QuantReg: 16.02621) QuantErr: 16.02621 batch_time=0.44077 
Train Epoch: 49 [329/500 21056/32000 (66%)] Loss: 1.05461 (QuantReg: 15.96521) QuantErr: 15.96521 batch_time=0.41458 
Train Epoch: 49 [337/500 21568/32000 (67%)] Loss: 0.76970 (QuantReg: 15.99496) QuantErr: 15.99496 batch_time=0.37451 
Train Epoch: 49 [345/500 22080/32000 (69%)] Loss: 1.14468 (QuantReg: 15.84804) QuantErr: 15.84804 batch_time=0.39733 
Train Epoch: 49 [353/500 22592/32000 (71%)] Loss: 0.93377 (QuantReg: 15.65939) QuantErr: 15.65939 batch_time=0.39140 
Train Epoch: 49 [361/500 23104/32000 (72%)] Loss: 1.02789 (QuantReg: 15.95940) QuantErr: 15.95940 batch_time=0.38430 
Train Epoch: 49 [369/500 23616/32000 (74%)] Loss: 0.97500 (QuantReg: 15.77388) QuantErr: 15.77388 batch_time=0.38450 
Train Epoch: 49 [377/500 24128/32000 (75%)] Loss: 0.92555 (QuantReg: 15.77902) QuantErr: 15.77902 batch_time=0.47924 
Train Epoch: 49 [385/500 24640/32000 (77%)] Loss: 0.98672 (QuantReg: 15.90380) QuantErr: 15.90380 batch_time=0.43040 
Train Epoch: 49 [393/500 25152/32000 (79%)] Loss: 1.05997 (QuantReg: 15.57091) QuantErr: 15.57091 batch_time=0.37648 
Train Epoch: 49 [401/500 25664/32000 (80%)] Loss: 1.16853 (QuantReg: 16.01501) QuantErr: 16.01501 batch_time=0.37826 
Train Epoch: 49 [409/500 26176/32000 (82%)] Loss: 0.86385 (QuantReg: 15.69888) QuantErr: 15.69888 batch_time=0.40094 
Train Epoch: 49 [417/500 26688/32000 (83%)] Loss: 0.86058 (QuantReg: 15.88737) QuantErr: 15.88737 batch_time=0.38080 
Train Epoch: 49 [425/500 27200/32000 (85%)] Loss: 0.69005 (QuantReg: 15.82837) QuantErr: 15.82837 batch_time=0.38191 
Train Epoch: 49 [433/500 27712/32000 (87%)] Loss: 0.83280 (QuantReg: 16.03619) QuantErr: 16.03619 batch_time=0.37942 
Train Epoch: 49 [441/500 28224/32000 (88%)] Loss: 1.03528 (QuantReg: 15.73922) QuantErr: 15.73922 batch_time=0.49156 
Train Epoch: 49 [449/500 28736/32000 (90%)] Loss: 0.78753 (QuantReg: 15.75649) QuantErr: 15.75649 batch_time=0.45151 
Train Epoch: 49 [457/500 29248/32000 (91%)] Loss: 1.15476 (QuantReg: 15.68934) QuantErr: 15.68934 batch_time=0.37772 
Train Epoch: 49 [465/500 29760/32000 (93%)] Loss: 1.15599 (QuantReg: 15.73615) QuantErr: 15.73615 batch_time=0.37672 
Train Epoch: 49 [473/500 30272/32000 (95%)] Loss: 1.22839 (QuantReg: 15.92512) QuantErr: 15.92512 batch_time=0.39936 
Train Epoch: 49 [481/500 30784/32000 (96%)] Loss: 0.69184 (QuantReg: 15.86106) QuantErr: 15.86106 batch_time=0.38317 
Train Epoch: 49 [489/500 31296/32000 (98%)] Loss: 1.11464 (QuantReg: 15.96022) QuantErr: 15.96022 batch_time=0.38757 
Train Epoch: 49 [497/500 31808/32000 (99%)] Loss: 0.94180 (QuantReg: 15.93203) QuantErr: 15.93203 batch_time=0.39904 
Train Epoch: 49 codebook_update_time=2.04654
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch49.pth ...
Done in 4.011s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 0.9273116673231125
 quant_reg      : 15.849521850585937
 quant_err      : 15.849521850585937
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 24500
 LSMDC_full_test/t2v_metrics/R1: 12.7
 LSMDC_full_test/t2v_metrics/R5: 29.4
 LSMDC_full_test/t2v_metrics/R10: 41.5
 LSMDC_full_test/t2v_metrics/R50: 66.2
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 81.015
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.93061829193874
 LSMDC_full_test/v2t_metrics/R1: 12.2
 LSMDC_full_test/v2t_metrics/R5: 30.6
 LSMDC_full_test/v2t_metrics/R10: 39.8
 LSMDC_full_test/v2t_metrics/R50: 65.9
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 80.057
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.584126185926277
 mnt_best       : 25.975252586423483
 not_improved_count: 17
Train Epoch: 50 [1/500 64/32000 (0%)] Loss: 1.11654 (QuantReg: 15.81290) QuantErr: 15.81290 batch_time=16.00556 
Train Epoch: 50 [9/500 576/32000 (2%)] Loss: 0.93982 (QuantReg: 15.94890) QuantErr: 15.94890 batch_time=0.37731 
Train Epoch: 50 [17/500 1088/32000 (3%)] Loss: 0.77377 (QuantReg: 16.03772) QuantErr: 16.03772 batch_time=0.37287 
Train Epoch: 50 [25/500 1600/32000 (5%)] Loss: 0.87723 (QuantReg: 16.00542) QuantErr: 16.00542 batch_time=0.37316 
Train Epoch: 50 [33/500 2112/32000 (7%)] Loss: 0.90320 (QuantReg: 15.84661) QuantErr: 15.84661 batch_time=0.49179 
Train Epoch: 50 [41/500 2624/32000 (8%)] Loss: 1.04185 (QuantReg: 15.91792) QuantErr: 15.91792 batch_time=0.40181 
Train Epoch: 50 [49/500 3136/32000 (10%)] Loss: 1.28680 (QuantReg: 15.65528) QuantErr: 15.65528 batch_time=0.38425 
Train Epoch: 50 [57/500 3648/32000 (11%)] Loss: 0.87805 (QuantReg: 15.74390) QuantErr: 15.74390 batch_time=0.38431 
Train Epoch: 50 [65/500 4160/32000 (13%)] Loss: 0.94907 (QuantReg: 15.89731) QuantErr: 15.89731 batch_time=0.58224 
Train Epoch: 50 [73/500 4672/32000 (15%)] Loss: 1.15279 (QuantReg: 16.01605) QuantErr: 16.01605 batch_time=0.38336 
Train Epoch: 50 [81/500 5184/32000 (16%)] Loss: 1.18719 (QuantReg: 15.97540) QuantErr: 15.97540 batch_time=0.37970 
Train Epoch: 50 [89/500 5696/32000 (18%)] Loss: 0.74838 (QuantReg: 15.64854) QuantErr: 15.64854 batch_time=0.38267 
Train Epoch: 50 [97/500 6208/32000 (19%)] Loss: 1.05297 (QuantReg: 16.00098) QuantErr: 16.00098 batch_time=0.48890 
Train Epoch: 50 [105/500 6720/32000 (21%)] Loss: 1.06865 (QuantReg: 15.91231) QuantErr: 15.91231 batch_time=0.38467 
Train Epoch: 50 [113/500 7232/32000 (23%)] Loss: 0.84698 (QuantReg: 15.97638) QuantErr: 15.97638 batch_time=0.39742 
Train Epoch: 50 [121/500 7744/32000 (24%)] Loss: 0.84751 (QuantReg: 15.68632) QuantErr: 15.68632 batch_time=0.37615 
Train Epoch: 50 [129/500 8256/32000 (26%)] Loss: 0.91481 (QuantReg: 15.58247) QuantErr: 15.58247 batch_time=0.60110 
Train Epoch: 50 [137/500 8768/32000 (27%)] Loss: 0.93559 (QuantReg: 16.00473) QuantErr: 16.00473 batch_time=0.38665 
Train Epoch: 50 [145/500 9280/32000 (29%)] Loss: 1.19400 (QuantReg: 16.00326) QuantErr: 16.00326 batch_time=0.38515 
Train Epoch: 50 [153/500 9792/32000 (31%)] Loss: 0.82246 (QuantReg: 15.73818) QuantErr: 15.73818 batch_time=0.39186 
Train Epoch: 50 [161/500 10304/32000 (32%)] Loss: 0.67508 (QuantReg: 15.97113) QuantErr: 15.97113 batch_time=0.49667 
Train Epoch: 50 [169/500 10816/32000 (34%)] Loss: 0.93469 (QuantReg: 15.88887) QuantErr: 15.88887 batch_time=0.38269 
Train Epoch: 50 [177/500 11328/32000 (35%)] Loss: 0.97174 (QuantReg: 15.78864) QuantErr: 15.78864 batch_time=0.38453 
Train Epoch: 50 [185/500 11840/32000 (37%)] Loss: 0.99531 (QuantReg: 15.96460) QuantErr: 15.96460 batch_time=0.39287 
Train Epoch: 50 [193/500 12352/32000 (39%)] Loss: 0.76312 (QuantReg: 15.57641) QuantErr: 15.57641 batch_time=0.58571 
Train Epoch: 50 [201/500 12864/32000 (40%)] Loss: 0.62817 (QuantReg: 15.66038) QuantErr: 15.66038 batch_time=0.37633 
Train Epoch: 50 [209/500 13376/32000 (42%)] Loss: 0.81203 (QuantReg: 15.67483) QuantErr: 15.67483 batch_time=0.38459 
Train Epoch: 50 [217/500 13888/32000 (43%)] Loss: 0.82793 (QuantReg: 15.72118) QuantErr: 15.72118 batch_time=0.38063 
Train Epoch: 50 [225/500 14400/32000 (45%)] Loss: 1.02947 (QuantReg: 15.81834) QuantErr: 15.81834 batch_time=0.49001 
Train Epoch: 50 [233/500 14912/32000 (47%)] Loss: 0.90692 (QuantReg: 15.61003) QuantErr: 15.61003 batch_time=0.38929 
Train Epoch: 50 [241/500 15424/32000 (48%)] Loss: 0.88965 (QuantReg: 15.91892) QuantErr: 15.91892 batch_time=0.41280 
Train Epoch: 50 [249/500 15936/32000 (50%)] Loss: 0.88193 (QuantReg: 15.75894) QuantErr: 15.75894 batch_time=0.38248 
Train Epoch: 50 [257/500 16448/32000 (51%)] Loss: 0.91962 (QuantReg: 15.84551) QuantErr: 15.84551 batch_time=0.56418 
Train Epoch: 50 [265/500 16960/32000 (53%)] Loss: 0.85906 (QuantReg: 15.77909) QuantErr: 15.77909 batch_time=0.37829 
Train Epoch: 50 [273/500 17472/32000 (55%)] Loss: 1.14934 (QuantReg: 15.68270) QuantErr: 15.68270 batch_time=0.38130 
Train Epoch: 50 [281/500 17984/32000 (56%)] Loss: 0.98064 (QuantReg: 15.68836) QuantErr: 15.68836 batch_time=0.40291 
Train Epoch: 50 [289/500 18496/32000 (58%)] Loss: 0.81160 (QuantReg: 15.72016) QuantErr: 15.72016 batch_time=0.48623 
Train Epoch: 50 [297/500 19008/32000 (59%)] Loss: 1.17661 (QuantReg: 15.97382) QuantErr: 15.97382 batch_time=0.39308 
Train Epoch: 50 [305/500 19520/32000 (61%)] Loss: 0.78571 (QuantReg: 15.97453) QuantErr: 15.97453 batch_time=0.39421 
Train Epoch: 50 [313/500 20032/32000 (63%)] Loss: 0.90704 (QuantReg: 15.77568) QuantErr: 15.77568 batch_time=0.38380 
Train Epoch: 50 [321/500 20544/32000 (64%)] Loss: 0.92254 (QuantReg: 15.97543) QuantErr: 15.97543 batch_time=0.57901 
Train Epoch: 50 [329/500 21056/32000 (66%)] Loss: 0.98630 (QuantReg: 16.07057) QuantErr: 16.07057 batch_time=0.38265 
Train Epoch: 50 [337/500 21568/32000 (67%)] Loss: 0.75453 (QuantReg: 15.92014) QuantErr: 15.92014 batch_time=0.38625 
Train Epoch: 50 [345/500 22080/32000 (69%)] Loss: 1.02187 (QuantReg: 15.72246) QuantErr: 15.72246 batch_time=0.39140 
Train Epoch: 50 [353/500 22592/32000 (71%)] Loss: 0.70385 (QuantReg: 15.83246) QuantErr: 15.83246 batch_time=0.50023 
Train Epoch: 50 [361/500 23104/32000 (72%)] Loss: 0.94712 (QuantReg: 15.93497) QuantErr: 15.93497 batch_time=0.41348 
Train Epoch: 50 [369/500 23616/32000 (74%)] Loss: 0.84408 (QuantReg: 15.60544) QuantErr: 15.60544 batch_time=0.38491 
Train Epoch: 50 [377/500 24128/32000 (75%)] Loss: 0.96537 (QuantReg: 15.93611) QuantErr: 15.93611 batch_time=0.38489 
Train Epoch: 50 [385/500 24640/32000 (77%)] Loss: 0.95828 (QuantReg: 15.63194) QuantErr: 15.63194 batch_time=0.58151 
Train Epoch: 50 [393/500 25152/32000 (79%)] Loss: 0.87511 (QuantReg: 15.92973) QuantErr: 15.92973 batch_time=0.37451 
Train Epoch: 50 [401/500 25664/32000 (80%)] Loss: 0.78438 (QuantReg: 15.70803) QuantErr: 15.70803 batch_time=0.37629 
Train Epoch: 50 [409/500 26176/32000 (82%)] Loss: 1.21452 (QuantReg: 15.63615) QuantErr: 15.63615 batch_time=0.39394 
Train Epoch: 50 [417/500 26688/32000 (83%)] Loss: 0.99705 (QuantReg: 15.97979) QuantErr: 15.97979 batch_time=0.47922 
Train Epoch: 50 [425/500 27200/32000 (85%)] Loss: 1.15016 (QuantReg: 15.93848) QuantErr: 15.93848 batch_time=0.39143 
Train Epoch: 50 [433/500 27712/32000 (87%)] Loss: 0.76518 (QuantReg: 15.97869) QuantErr: 15.97869 batch_time=0.38636 
Train Epoch: 50 [441/500 28224/32000 (88%)] Loss: 0.86340 (QuantReg: 15.94158) QuantErr: 15.94158 batch_time=0.38302 
Train Epoch: 50 [449/500 28736/32000 (90%)] Loss: 1.05498 (QuantReg: 15.82580) QuantErr: 15.82580 batch_time=0.57558 
Train Epoch: 50 [457/500 29248/32000 (91%)] Loss: 1.07790 (QuantReg: 15.91522) QuantErr: 15.91522 batch_time=0.38281 
Train Epoch: 50 [465/500 29760/32000 (93%)] Loss: 0.92209 (QuantReg: 15.79380) QuantErr: 15.79380 batch_time=0.39580 
Train Epoch: 50 [473/500 30272/32000 (95%)] Loss: 0.71549 (QuantReg: 15.72239) QuantErr: 15.72239 batch_time=0.41047 
Train Epoch: 50 [481/500 30784/32000 (96%)] Loss: 0.85740 (QuantReg: 15.97506) QuantErr: 15.97506 batch_time=0.49234 
Train Epoch: 50 [489/500 31296/32000 (98%)] Loss: 1.03807 (QuantReg: 16.02287) QuantErr: 16.02287 batch_time=0.38255 
Train Epoch: 50 [497/500 31808/32000 (99%)] Loss: 0.74659 (QuantReg: 15.94676) QuantErr: 15.94676 batch_time=0.38599 
Train Epoch: 50 codebook_update_time=2.02410
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/checkpoint-epoch50.pth ...
Done in 5.235s
removing stale ckpt [epoch 49] [took 0.01s]
 epoch          : 50
 loss           : 0.9283898528814316
 quant_reg      : 15.836778703689575
 quant_err      : 15.836778703689575
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 25000
 LSMDC_full_test/t2v_metrics/R1: 13.0
 LSMDC_full_test/t2v_metrics/R5: 30.4
 LSMDC_full_test/t2v_metrics/R10: 40.8
 LSMDC_full_test/t2v_metrics/R50: 65.7
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 80.754
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.263433037939052
 LSMDC_full_test/v2t_metrics/R1: 13.2
 LSMDC_full_test/v2t_metrics/R5: 31.1
 LSMDC_full_test/v2t_metrics/R10: 39.7
 LSMDC_full_test/v2t_metrics/R50: 65.6
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 80.245
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.353715283962774
 mnt_best       : 25.975252586423483
 not_improved_count: 18
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/trained_model.pth ...
Ckpt loaded at epoch 32.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/LSMDC-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/LSMDC-test-qt-sims.npy
LSMDC_full_test:
 t2v_metrics/R1/final_eval: 13.4
 t2v_metrics/R5/final_eval: 31.9
 t2v_metrics/R10/final_eval: 41.0
 t2v_metrics/R50/final_eval: 66.2
 t2v_metrics/MedR/final_eval: 17.0
 t2v_metrics/MeanR/final_eval: 75.978
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 25.975252586423483
 v2t_metrics/R1/final_eval: 13.4
 v2t_metrics/R5/final_eval: 31.5
 v2t_metrics/R10/final_eval: 40.0
 v2t_metrics/R50/final_eval: 66.2
 v2t_metrics/MedR/final_eval: 20.0
 v2t_metrics/MeanR/final_eval: 73.14
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 25.6541983255931
Best epoch for the monitored metric: 32
Script took 04h36m45s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_bs64/trained_model.pth
