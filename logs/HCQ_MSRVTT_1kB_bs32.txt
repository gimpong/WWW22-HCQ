Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32
Preparing the dataloaders ...
Loading dataset MSRVTT_miech_trainval in ram ...
Finish loading dataset MSRVTT_miech_trainval in ram, taking 556.7804188728333 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 91.96793174743652 s.
Loading dataset MSRVTT_miech_test in ram ...
Finish loading dataset MSRVTT_miech_test in ram, taking 87.24203586578369 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch0.pth ...
Done in 2.988s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch0.pth ...
Done in 5.131s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_miech_test/t2v_metrics/R1: 0.1
 MSRVTT_miech_test/t2v_metrics/R5: 0.6
 MSRVTT_miech_test/t2v_metrics/R10: 1.0
 MSRVTT_miech_test/t2v_metrics/R50: 5.0
 MSRVTT_miech_test/t2v_metrics/MedR: 503.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 505.179
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.3914867641168864
 MSRVTT_miech_test/v2t_metrics/R1: 0.1
 MSRVTT_miech_test/v2t_metrics/R5: 0.4
 MSRVTT_miech_test/v2t_metrics/R10: 1.0
 MSRVTT_miech_test/v2t_metrics/R50: 5.4
 MSRVTT_miech_test/v2t_metrics/MedR: 511.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 499.893
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3419951893353394
 mnt_best       : 0.3914867641168864
 not_improved_count: 0
Train Epoch: 1 [1/1000 32/32000 (0%)] Loss: 6.99090 (QuantReg: 22.49022) QuantErr: 22.49022 batch_time=23.37270 
Train Epoch: 1 [6/1000 192/32000 (1%)] Loss: 6.88633 (QuantReg: 22.44062) QuantErr: 22.44062 batch_time=0.40311 
Train Epoch: 1 [11/1000 352/32000 (1%)] Loss: 6.72978 (QuantReg: 22.40120) QuantErr: 22.40120 batch_time=0.39943 
Train Epoch: 1 [16/1000 512/32000 (2%)] Loss: 6.22615 (QuantReg: 22.43046) QuantErr: 22.43046 batch_time=0.34332 
Train Epoch: 1 [21/1000 672/32000 (2%)] Loss: 5.65938 (QuantReg: 22.51378) QuantErr: 22.51378 batch_time=0.45145 
Train Epoch: 1 [26/1000 832/32000 (3%)] Loss: 5.23707 (QuantReg: 22.53913) QuantErr: 22.53913 batch_time=0.34164 
Train Epoch: 1 [31/1000 992/32000 (3%)] Loss: 5.07948 (QuantReg: 22.50108) QuantErr: 22.50108 batch_time=0.60894 
Train Epoch: 1 [36/1000 1152/32000 (4%)] Loss: 4.96517 (QuantReg: 22.45017) QuantErr: 22.45017 batch_time=0.38421 
Train Epoch: 1 [41/1000 1312/32000 (4%)] Loss: 4.55900 (QuantReg: 22.50584) QuantErr: 22.50584 batch_time=0.34675 
Train Epoch: 1 [46/1000 1472/32000 (5%)] Loss: 4.58592 (QuantReg: 22.56352) QuantErr: 22.56352 batch_time=0.35994 
Train Epoch: 1 [51/1000 1632/32000 (5%)] Loss: 4.71358 (QuantReg: 22.53362) QuantErr: 22.53362 batch_time=0.34708 
Train Epoch: 1 [56/1000 1792/32000 (6%)] Loss: 4.14441 (QuantReg: 22.55093) QuantErr: 22.55093 batch_time=0.39472 
Train Epoch: 1 [61/1000 1952/32000 (6%)] Loss: 5.00741 (QuantReg: 22.51422) QuantErr: 22.51422 batch_time=0.36660 
Train Epoch: 1 [66/1000 2112/32000 (7%)] Loss: 4.40644 (QuantReg: 22.55334) QuantErr: 22.55334 batch_time=0.44320 
Train Epoch: 1 [71/1000 2272/32000 (7%)] Loss: 5.33936 (QuantReg: 22.59237) QuantErr: 22.59237 batch_time=0.34131 
Train Epoch: 1 [76/1000 2432/32000 (8%)] Loss: 3.63522 (QuantReg: 22.58357) QuantErr: 22.58357 batch_time=0.51102 
Train Epoch: 1 [81/1000 2592/32000 (8%)] Loss: 4.78780 (QuantReg: 22.58301) QuantErr: 22.58301 batch_time=0.40556 
Train Epoch: 1 [86/1000 2752/32000 (9%)] Loss: 3.99554 (QuantReg: 22.59565) QuantErr: 22.59565 batch_time=0.47626 
Train Epoch: 1 [91/1000 2912/32000 (9%)] Loss: 3.69806 (QuantReg: 22.62911) QuantErr: 22.62911 batch_time=0.35223 
Train Epoch: 1 [96/1000 3072/32000 (10%)] Loss: 4.23009 (QuantReg: 22.62200) QuantErr: 22.62200 batch_time=0.38988 
Train Epoch: 1 [101/1000 3232/32000 (10%)] Loss: 3.59340 (QuantReg: 22.63558) QuantErr: 22.63558 batch_time=0.38746 
Train Epoch: 1 [106/1000 3392/32000 (11%)] Loss: 4.41500 (QuantReg: 22.62477) QuantErr: 22.62477 batch_time=0.59506 
Train Epoch: 1 [111/1000 3552/32000 (11%)] Loss: 3.78192 (QuantReg: 22.54679) QuantErr: 22.54679 batch_time=0.50825 
Train Epoch: 1 [116/1000 3712/32000 (12%)] Loss: 3.79782 (QuantReg: 22.63311) QuantErr: 22.63311 batch_time=0.53590 
Train Epoch: 1 [121/1000 3872/32000 (12%)] Loss: 2.68384 (QuantReg: 22.59258) QuantErr: 22.59258 batch_time=0.49489 
Train Epoch: 1 [126/1000 4032/32000 (13%)] Loss: 4.01706 (QuantReg: 22.62278) QuantErr: 22.62278 batch_time=0.42144 
Train Epoch: 1 [131/1000 4192/32000 (13%)] Loss: 3.73792 (QuantReg: 22.60829) QuantErr: 22.60829 batch_time=0.33605 
Train Epoch: 1 [136/1000 4352/32000 (14%)] Loss: 2.89081 (QuantReg: 22.53487) QuantErr: 22.53487 batch_time=0.33534 
Train Epoch: 1 [141/1000 4512/32000 (14%)] Loss: 3.64721 (QuantReg: 22.61582) QuantErr: 22.61582 batch_time=0.35516 
Train Epoch: 1 [146/1000 4672/32000 (15%)] Loss: 2.90917 (QuantReg: 22.64423) QuantErr: 22.64423 batch_time=0.41569 
Train Epoch: 1 [151/1000 4832/32000 (15%)] Loss: 3.22001 (QuantReg: 22.67886) QuantErr: 22.67886 batch_time=0.47118 
Train Epoch: 1 [156/1000 4992/32000 (16%)] Loss: 2.76204 (QuantReg: 22.64998) QuantErr: 22.64998 batch_time=0.66903 
Train Epoch: 1 [161/1000 5152/32000 (16%)] Loss: 3.54259 (QuantReg: 22.69182) QuantErr: 22.69182 batch_time=0.39892 
Train Epoch: 1 [166/1000 5312/32000 (17%)] Loss: 2.70860 (QuantReg: 22.59725) QuantErr: 22.59725 batch_time=0.58625 
Train Epoch: 1 [171/1000 5472/32000 (17%)] Loss: 3.14865 (QuantReg: 22.63408) QuantErr: 22.63408 batch_time=0.34806 
Train Epoch: 1 [176/1000 5632/32000 (18%)] Loss: 4.06421 (QuantReg: 22.61566) QuantErr: 22.61566 batch_time=0.43231 
Train Epoch: 1 [181/1000 5792/32000 (18%)] Loss: 3.40115 (QuantReg: 22.66020) QuantErr: 22.66020 batch_time=0.35858 
Train Epoch: 1 [186/1000 5952/32000 (19%)] Loss: 3.19860 (QuantReg: 22.67413) QuantErr: 22.67413 batch_time=0.39865 
Train Epoch: 1 [191/1000 6112/32000 (19%)] Loss: 2.79447 (QuantReg: 22.69779) QuantErr: 22.69779 batch_time=0.35161 
Train Epoch: 1 [196/1000 6272/32000 (20%)] Loss: 2.97435 (QuantReg: 22.63215) QuantErr: 22.63215 batch_time=0.36379 
Train Epoch: 1 [201/1000 6432/32000 (20%)] Loss: 3.53590 (QuantReg: 22.60885) QuantErr: 22.60885 batch_time=2.41212 
Train Epoch: 1 [206/1000 6592/32000 (21%)] Loss: 2.86119 (QuantReg: 22.69629) QuantErr: 22.69629 batch_time=0.45069 
Train Epoch: 1 [211/1000 6752/32000 (21%)] Loss: 2.82714 (QuantReg: 22.60294) QuantErr: 22.60294 batch_time=0.46604 
Train Epoch: 1 [216/1000 6912/32000 (22%)] Loss: 2.98526 (QuantReg: 22.64245) QuantErr: 22.64245 batch_time=0.39519 
Train Epoch: 1 [221/1000 7072/32000 (22%)] Loss: 2.40649 (QuantReg: 22.68387) QuantErr: 22.68387 batch_time=0.35780 
Train Epoch: 1 [226/1000 7232/32000 (23%)] Loss: 2.43543 (QuantReg: 22.62730) QuantErr: 22.62730 batch_time=0.41659 
Train Epoch: 1 [231/1000 7392/32000 (23%)] Loss: 3.71728 (QuantReg: 22.66748) QuantErr: 22.66748 batch_time=0.36759 
Train Epoch: 1 [236/1000 7552/32000 (24%)] Loss: 2.57564 (QuantReg: 22.66887) QuantErr: 22.66887 batch_time=0.44480 
Train Epoch: 1 [241/1000 7712/32000 (24%)] Loss: 4.37432 (QuantReg: 22.52580) QuantErr: 22.52580 batch_time=0.73244 
Train Epoch: 1 [246/1000 7872/32000 (25%)] Loss: 3.30598 (QuantReg: 22.56659) QuantErr: 22.56659 batch_time=0.49691 
Train Epoch: 1 [251/1000 8032/32000 (25%)] Loss: 3.39156 (QuantReg: 22.60255) QuantErr: 22.60255 batch_time=0.39682 
Train Epoch: 1 [256/1000 8192/32000 (26%)] Loss: 3.11702 (QuantReg: 22.64503) QuantErr: 22.64503 batch_time=0.43196 
Train Epoch: 1 [261/1000 8352/32000 (26%)] Loss: 3.38316 (QuantReg: 22.69603) QuantErr: 22.69603 batch_time=0.48314 
Train Epoch: 1 [266/1000 8512/32000 (27%)] Loss: 2.86402 (QuantReg: 22.64498) QuantErr: 22.64498 batch_time=0.39657 
Train Epoch: 1 [271/1000 8672/32000 (27%)] Loss: 2.61702 (QuantReg: 22.71903) QuantErr: 22.71903 batch_time=0.42105 
Train Epoch: 1 [276/1000 8832/32000 (28%)] Loss: 3.33124 (QuantReg: 22.66326) QuantErr: 22.66326 batch_time=0.39441 
Train Epoch: 1 [281/1000 8992/32000 (28%)] Loss: 2.87749 (QuantReg: 22.65055) QuantErr: 22.65055 batch_time=0.35169 
Train Epoch: 1 [286/1000 9152/32000 (29%)] Loss: 2.94661 (QuantReg: 22.67249) QuantErr: 22.67249 batch_time=0.78444 
Train Epoch: 1 [291/1000 9312/32000 (29%)] Loss: 2.98344 (QuantReg: 22.59875) QuantErr: 22.59875 batch_time=0.43115 
Train Epoch: 1 [296/1000 9472/32000 (30%)] Loss: 2.91558 (QuantReg: 22.63242) QuantErr: 22.63242 batch_time=0.35913 
Train Epoch: 1 [301/1000 9632/32000 (30%)] Loss: 2.62380 (QuantReg: 22.64308) QuantErr: 22.64308 batch_time=1.38748 
Train Epoch: 1 [306/1000 9792/32000 (31%)] Loss: 2.45876 (QuantReg: 22.70254) QuantErr: 22.70254 batch_time=0.40551 
Train Epoch: 1 [311/1000 9952/32000 (31%)] Loss: 2.84332 (QuantReg: 22.59833) QuantErr: 22.59833 batch_time=0.36632 
Train Epoch: 1 [316/1000 10112/32000 (32%)] Loss: 2.64267 (QuantReg: 22.60719) QuantErr: 22.60719 batch_time=0.45414 
Train Epoch: 1 [321/1000 10272/32000 (32%)] Loss: 2.71170 (QuantReg: 22.63874) QuantErr: 22.63874 batch_time=0.39433 
Train Epoch: 1 [326/1000 10432/32000 (33%)] Loss: 4.17808 (QuantReg: 22.63293) QuantErr: 22.63293 batch_time=0.81941 
Train Epoch: 1 [331/1000 10592/32000 (33%)] Loss: 2.95237 (QuantReg: 22.69505) QuantErr: 22.69505 batch_time=0.48424 
Train Epoch: 1 [336/1000 10752/32000 (34%)] Loss: 2.70342 (QuantReg: 22.64520) QuantErr: 22.64520 batch_time=0.36333 
Train Epoch: 1 [341/1000 10912/32000 (34%)] Loss: 2.95461 (QuantReg: 22.62765) QuantErr: 22.62765 batch_time=0.38850 
Train Epoch: 1 [346/1000 11072/32000 (35%)] Loss: 3.31804 (QuantReg: 22.64847) QuantErr: 22.64847 batch_time=0.38676 
Train Epoch: 1 [351/1000 11232/32000 (35%)] Loss: 3.65876 (QuantReg: 22.68787) QuantErr: 22.68787 batch_time=0.36397 
Train Epoch: 1 [356/1000 11392/32000 (36%)] Loss: 3.04080 (QuantReg: 22.70879) QuantErr: 22.70879 batch_time=0.39250 
Train Epoch: 1 [361/1000 11552/32000 (36%)] Loss: 2.03177 (QuantReg: 22.68752) QuantErr: 22.68752 batch_time=0.43042 
Train Epoch: 1 [366/1000 11712/32000 (37%)] Loss: 3.27901 (QuantReg: 22.62267) QuantErr: 22.62267 batch_time=0.60753 
Train Epoch: 1 [371/1000 11872/32000 (37%)] Loss: 2.49865 (QuantReg: 22.68835) QuantErr: 22.68835 batch_time=0.50000 
Train Epoch: 1 [376/1000 12032/32000 (38%)] Loss: 2.95566 (QuantReg: 22.67834) QuantErr: 22.67834 batch_time=0.37863 
Train Epoch: 1 [381/1000 12192/32000 (38%)] Loss: 2.60909 (QuantReg: 22.64960) QuantErr: 22.64960 batch_time=0.34545 
Train Epoch: 1 [386/1000 12352/32000 (39%)] Loss: 2.24419 (QuantReg: 22.66747) QuantErr: 22.66747 batch_time=0.34337 
Train Epoch: 1 [391/1000 12512/32000 (39%)] Loss: 2.45091 (QuantReg: 22.64842) QuantErr: 22.64842 batch_time=0.37607 
Train Epoch: 1 [396/1000 12672/32000 (40%)] Loss: 3.06765 (QuantReg: 22.65086) QuantErr: 22.65086 batch_time=0.34838 
Train Epoch: 1 [401/1000 12832/32000 (40%)] Loss: 2.04950 (QuantReg: 22.60556) QuantErr: 22.60556 batch_time=0.38082 
Train Epoch: 1 [406/1000 12992/32000 (41%)] Loss: 2.04392 (QuantReg: 22.65595) QuantErr: 22.65595 batch_time=0.34832 
Train Epoch: 1 [411/1000 13152/32000 (41%)] Loss: 3.21240 (QuantReg: 22.67812) QuantErr: 22.67812 batch_time=0.51540 
Train Epoch: 1 [416/1000 13312/32000 (42%)] Loss: 2.81064 (QuantReg: 22.59312) QuantErr: 22.59312 batch_time=0.34829 
Train Epoch: 1 [421/1000 13472/32000 (42%)] Loss: 3.11106 (QuantReg: 22.69111) QuantErr: 22.69111 batch_time=0.43535 
Train Epoch: 1 [426/1000 13632/32000 (43%)] Loss: 2.28873 (QuantReg: 22.67155) QuantErr: 22.67155 batch_time=0.54636 
Train Epoch: 1 [431/1000 13792/32000 (43%)] Loss: 3.33538 (QuantReg: 22.61697) QuantErr: 22.61697 batch_time=0.35957 
Train Epoch: 1 [436/1000 13952/32000 (44%)] Loss: 2.91674 (QuantReg: 22.68438) QuantErr: 22.68438 batch_time=0.38902 
Train Epoch: 1 [441/1000 14112/32000 (44%)] Loss: 2.13215 (QuantReg: 22.67285) QuantErr: 22.67285 batch_time=0.37655 
Train Epoch: 1 [446/1000 14272/32000 (45%)] Loss: 1.67141 (QuantReg: 22.65753) QuantErr: 22.65753 batch_time=0.48592 
Train Epoch: 1 [451/1000 14432/32000 (45%)] Loss: 3.21378 (QuantReg: 22.51696) QuantErr: 22.51696 batch_time=0.33888 
Train Epoch: 1 [456/1000 14592/32000 (46%)] Loss: 2.63686 (QuantReg: 22.70774) QuantErr: 22.70774 batch_time=0.56185 
Train Epoch: 1 [461/1000 14752/32000 (46%)] Loss: 2.42925 (QuantReg: 22.68162) QuantErr: 22.68162 batch_time=0.34014 
Train Epoch: 1 [466/1000 14912/32000 (47%)] Loss: 2.03337 (QuantReg: 22.66350) QuantErr: 22.66350 batch_time=0.41024 
Train Epoch: 1 [471/1000 15072/32000 (47%)] Loss: 2.91802 (QuantReg: 22.71536) QuantErr: 22.71536 batch_time=0.35339 
Train Epoch: 1 [476/1000 15232/32000 (48%)] Loss: 2.63319 (QuantReg: 22.72236) QuantErr: 22.72236 batch_time=0.42109 
Train Epoch: 1 [481/1000 15392/32000 (48%)] Loss: 2.15710 (QuantReg: 22.68558) QuantErr: 22.68558 batch_time=0.35238 
Train Epoch: 1 [486/1000 15552/32000 (49%)] Loss: 2.81525 (QuantReg: 22.62190) QuantErr: 22.62190 batch_time=0.37844 
Train Epoch: 1 [491/1000 15712/32000 (49%)] Loss: 2.79847 (QuantReg: 22.66546) QuantErr: 22.66546 batch_time=0.35873 
Train Epoch: 1 [496/1000 15872/32000 (50%)] Loss: 2.23197 (QuantReg: 22.68251) QuantErr: 22.68251 batch_time=0.56455 
Train Epoch: 1 [501/1000 16032/32000 (50%)] Loss: 2.30769 (QuantReg: 22.73708) QuantErr: 22.73708 batch_time=0.39121 
Train Epoch: 1 [506/1000 16192/32000 (51%)] Loss: 3.23454 (QuantReg: 22.68401) QuantErr: 22.68401 batch_time=0.47638 
Train Epoch: 1 [511/1000 16352/32000 (51%)] Loss: 2.55301 (QuantReg: 22.72538) QuantErr: 22.72538 batch_time=0.37554 
Train Epoch: 1 [516/1000 16512/32000 (52%)] Loss: 2.88176 (QuantReg: 22.64802) QuantErr: 22.64802 batch_time=0.39015 
Train Epoch: 1 [521/1000 16672/32000 (52%)] Loss: 2.31665 (QuantReg: 22.71239) QuantErr: 22.71239 batch_time=0.93177 
Train Epoch: 1 [526/1000 16832/32000 (53%)] Loss: 2.17091 (QuantReg: 22.69420) QuantErr: 22.69420 batch_time=0.36612 
Train Epoch: 1 [531/1000 16992/32000 (53%)] Loss: 2.62937 (QuantReg: 22.72186) QuantErr: 22.72186 batch_time=0.39932 
Train Epoch: 1 [536/1000 17152/32000 (54%)] Loss: 2.13533 (QuantReg: 22.67640) QuantErr: 22.67640 batch_time=0.34584 
Train Epoch: 1 [541/1000 17312/32000 (54%)] Loss: 2.23285 (QuantReg: 22.61824) QuantErr: 22.61824 batch_time=0.66233 
Train Epoch: 1 [546/1000 17472/32000 (55%)] Loss: 2.07809 (QuantReg: 22.69658) QuantErr: 22.69658 batch_time=0.35593 
Train Epoch: 1 [551/1000 17632/32000 (55%)] Loss: 2.36181 (QuantReg: 22.67796) QuantErr: 22.67796 batch_time=0.61402 
Train Epoch: 1 [556/1000 17792/32000 (56%)] Loss: 2.30996 (QuantReg: 22.65034) QuantErr: 22.65034 batch_time=0.35790 
Train Epoch: 1 [561/1000 17952/32000 (56%)] Loss: 2.88730 (QuantReg: 22.65756) QuantErr: 22.65756 batch_time=0.40780 
Train Epoch: 1 [566/1000 18112/32000 (57%)] Loss: 2.52790 (QuantReg: 22.70338) QuantErr: 22.70338 batch_time=0.40903 
Train Epoch: 1 [571/1000 18272/32000 (57%)] Loss: 2.82327 (QuantReg: 22.67578) QuantErr: 22.67578 batch_time=0.36686 
Train Epoch: 1 [576/1000 18432/32000 (58%)] Loss: 1.67695 (QuantReg: 22.68027) QuantErr: 22.68027 batch_time=0.34685 
Train Epoch: 1 [581/1000 18592/32000 (58%)] Loss: 1.84758 (QuantReg: 22.64514) QuantErr: 22.64514 batch_time=0.45131 
Train Epoch: 1 [586/1000 18752/32000 (59%)] Loss: 2.90375 (QuantReg: 22.67070) QuantErr: 22.67070 batch_time=0.36419 
Train Epoch: 1 [591/1000 18912/32000 (59%)] Loss: 2.01992 (QuantReg: 22.62322) QuantErr: 22.62322 batch_time=0.35270 
Train Epoch: 1 [596/1000 19072/32000 (60%)] Loss: 2.62021 (QuantReg: 22.64830) QuantErr: 22.64830 batch_time=0.45568 
Train Epoch: 1 [601/1000 19232/32000 (60%)] Loss: 2.46993 (QuantReg: 22.71599) QuantErr: 22.71599 batch_time=0.34602 
Train Epoch: 1 [606/1000 19392/32000 (61%)] Loss: 2.35361 (QuantReg: 22.68567) QuantErr: 22.68567 batch_time=0.38487 
Train Epoch: 1 [611/1000 19552/32000 (61%)] Loss: 3.69808 (QuantReg: 22.70356) QuantErr: 22.70356 batch_time=0.38865 
Train Epoch: 1 [616/1000 19712/32000 (62%)] Loss: 2.44580 (QuantReg: 22.72764) QuantErr: 22.72764 batch_time=0.45178 
Train Epoch: 1 [621/1000 19872/32000 (62%)] Loss: 2.11470 (QuantReg: 22.70971) QuantErr: 22.70971 batch_time=1.38787 
Train Epoch: 1 [626/1000 20032/32000 (63%)] Loss: 2.62484 (QuantReg: 22.67182) QuantErr: 22.67182 batch_time=0.75139 
Train Epoch: 1 [631/1000 20192/32000 (63%)] Loss: 2.38653 (QuantReg: 22.72619) QuantErr: 22.72619 batch_time=0.33964 
Train Epoch: 1 [636/1000 20352/32000 (64%)] Loss: 2.62861 (QuantReg: 22.67408) QuantErr: 22.67408 batch_time=0.61352 
Train Epoch: 1 [641/1000 20512/32000 (64%)] Loss: 1.77710 (QuantReg: 22.72501) QuantErr: 22.72501 batch_time=0.34559 
Train Epoch: 1 [646/1000 20672/32000 (65%)] Loss: 2.51906 (QuantReg: 22.68889) QuantErr: 22.68889 batch_time=0.35731 
Train Epoch: 1 [651/1000 20832/32000 (65%)] Loss: 2.43701 (QuantReg: 22.70383) QuantErr: 22.70383 batch_time=0.63797 
Train Epoch: 1 [656/1000 20992/32000 (66%)] Loss: 2.13435 (QuantReg: 22.70980) QuantErr: 22.70980 batch_time=0.42703 
Train Epoch: 1 [661/1000 21152/32000 (66%)] Loss: 2.82744 (QuantReg: 22.69421) QuantErr: 22.69421 batch_time=0.50067 
Train Epoch: 1 [666/1000 21312/32000 (67%)] Loss: 1.90958 (QuantReg: 22.65333) QuantErr: 22.65333 batch_time=0.39627 
Train Epoch: 1 [671/1000 21472/32000 (67%)] Loss: 2.43627 (QuantReg: 22.71176) QuantErr: 22.71176 batch_time=0.64967 
Train Epoch: 1 [676/1000 21632/32000 (68%)] Loss: 1.76671 (QuantReg: 22.76014) QuantErr: 22.76014 batch_time=0.34353 
Train Epoch: 1 [681/1000 21792/32000 (68%)] Loss: 1.99833 (QuantReg: 22.71263) QuantErr: 22.71263 batch_time=0.37992 
Train Epoch: 1 [686/1000 21952/32000 (69%)] Loss: 2.54165 (QuantReg: 22.74680) QuantErr: 22.74680 batch_time=0.56571 
Train Epoch: 1 [691/1000 22112/32000 (69%)] Loss: 2.42390 (QuantReg: 22.76415) QuantErr: 22.76415 batch_time=0.43163 
Train Epoch: 1 [696/1000 22272/32000 (70%)] Loss: 3.82071 (QuantReg: 22.60378) QuantErr: 22.60378 batch_time=0.46467 
Train Epoch: 1 [701/1000 22432/32000 (70%)] Loss: 2.10999 (QuantReg: 22.65248) QuantErr: 22.65248 batch_time=0.41411 
Train Epoch: 1 [706/1000 22592/32000 (71%)] Loss: 3.10593 (QuantReg: 22.68209) QuantErr: 22.68209 batch_time=0.35800 
Train Epoch: 1 [711/1000 22752/32000 (71%)] Loss: 2.85862 (QuantReg: 22.71902) QuantErr: 22.71902 batch_time=0.74521 
Train Epoch: 1 [716/1000 22912/32000 (72%)] Loss: 2.17435 (QuantReg: 22.66309) QuantErr: 22.66309 batch_time=0.33560 
Train Epoch: 1 [721/1000 23072/32000 (72%)] Loss: 2.28313 (QuantReg: 22.63297) QuantErr: 22.63297 batch_time=0.37482 
Train Epoch: 1 [726/1000 23232/32000 (73%)] Loss: 2.50866 (QuantReg: 22.68915) QuantErr: 22.68915 batch_time=0.36448 
Train Epoch: 1 [731/1000 23392/32000 (73%)] Loss: 2.67400 (QuantReg: 22.68186) QuantErr: 22.68186 batch_time=0.39069 
Train Epoch: 1 [736/1000 23552/32000 (74%)] Loss: 2.27248 (QuantReg: 22.70411) QuantErr: 22.70411 batch_time=0.41007 
Train Epoch: 1 [741/1000 23712/32000 (74%)] Loss: 2.58083 (QuantReg: 22.60853) QuantErr: 22.60853 batch_time=0.43551 
Train Epoch: 1 [746/1000 23872/32000 (75%)] Loss: 2.60734 (QuantReg: 22.67949) QuantErr: 22.67949 batch_time=0.41768 
Train Epoch: 1 [751/1000 24032/32000 (75%)] Loss: 3.29050 (QuantReg: 22.65863) QuantErr: 22.65863 batch_time=0.71823 
Train Epoch: 1 [756/1000 24192/32000 (76%)] Loss: 2.53555 (QuantReg: 22.66497) QuantErr: 22.66497 batch_time=0.51602 
Train Epoch: 1 [761/1000 24352/32000 (76%)] Loss: 2.30993 (QuantReg: 22.66998) QuantErr: 22.66998 batch_time=0.38078 
Train Epoch: 1 [766/1000 24512/32000 (77%)] Loss: 2.43053 (QuantReg: 22.72568) QuantErr: 22.72568 batch_time=0.36676 
Train Epoch: 1 [771/1000 24672/32000 (77%)] Loss: 2.41215 (QuantReg: 22.67431) QuantErr: 22.67431 batch_time=0.51964 
Train Epoch: 1 [776/1000 24832/32000 (78%)] Loss: 2.46361 (QuantReg: 22.66739) QuantErr: 22.66739 batch_time=0.36036 
Train Epoch: 1 [781/1000 24992/32000 (78%)] Loss: 2.10080 (QuantReg: 22.66680) QuantErr: 22.66680 batch_time=0.35667 
Train Epoch: 1 [786/1000 25152/32000 (79%)] Loss: 2.68986 (QuantReg: 22.78703) QuantErr: 22.78703 batch_time=0.34445 
Train Epoch: 1 [791/1000 25312/32000 (79%)] Loss: 1.91624 (QuantReg: 22.70791) QuantErr: 22.70791 batch_time=0.93473 
Train Epoch: 1 [796/1000 25472/32000 (80%)] Loss: 2.37668 (QuantReg: 22.63884) QuantErr: 22.63884 batch_time=0.67837 
Train Epoch: 1 [801/1000 25632/32000 (80%)] Loss: 2.20551 (QuantReg: 22.70625) QuantErr: 22.70625 batch_time=0.36496 
Train Epoch: 1 [806/1000 25792/32000 (81%)] Loss: 1.88331 (QuantReg: 22.74921) QuantErr: 22.74921 batch_time=0.34993 
Train Epoch: 1 [811/1000 25952/32000 (81%)] Loss: 2.31730 (QuantReg: 22.69663) QuantErr: 22.69663 batch_time=0.38801 
Train Epoch: 1 [816/1000 26112/32000 (82%)] Loss: 2.43923 (QuantReg: 22.67574) QuantErr: 22.67574 batch_time=0.37097 
Train Epoch: 1 [821/1000 26272/32000 (82%)] Loss: 2.12756 (QuantReg: 22.70572) QuantErr: 22.70572 batch_time=0.43075 
Train Epoch: 1 [826/1000 26432/32000 (83%)] Loss: 2.17944 (QuantReg: 22.74195) QuantErr: 22.74195 batch_time=0.38659 
Train Epoch: 1 [831/1000 26592/32000 (83%)] Loss: 2.79451 (QuantReg: 22.71222) QuantErr: 22.71222 batch_time=0.85896 
Train Epoch: 1 [836/1000 26752/32000 (84%)] Loss: 3.44886 (QuantReg: 22.75273) QuantErr: 22.75273 batch_time=0.35621 
Train Epoch: 1 [841/1000 26912/32000 (84%)] Loss: 2.22575 (QuantReg: 22.69370) QuantErr: 22.69370 batch_time=1.07209 
Train Epoch: 1 [846/1000 27072/32000 (85%)] Loss: 2.20802 (QuantReg: 22.70851) QuantErr: 22.70851 batch_time=0.36457 
Train Epoch: 1 [851/1000 27232/32000 (85%)] Loss: 1.72300 (QuantReg: 22.70343) QuantErr: 22.70343 batch_time=0.41399 
Train Epoch: 1 [856/1000 27392/32000 (86%)] Loss: 3.15142 (QuantReg: 22.69937) QuantErr: 22.69937 batch_time=0.43326 
Train Epoch: 1 [861/1000 27552/32000 (86%)] Loss: 1.99053 (QuantReg: 22.71255) QuantErr: 22.71255 batch_time=0.38691 
Train Epoch: 1 [866/1000 27712/32000 (87%)] Loss: 2.53408 (QuantReg: 22.65942) QuantErr: 22.65942 batch_time=0.34071 
Train Epoch: 1 [871/1000 27872/32000 (87%)] Loss: 1.72601 (QuantReg: 22.67649) QuantErr: 22.67649 batch_time=0.36933 
Train Epoch: 1 [876/1000 28032/32000 (88%)] Loss: 1.71476 (QuantReg: 22.72499) QuantErr: 22.72499 batch_time=0.43883 
Train Epoch: 1 [881/1000 28192/32000 (88%)] Loss: 1.99115 (QuantReg: 22.67554) QuantErr: 22.67554 batch_time=0.36803 
Train Epoch: 1 [886/1000 28352/32000 (89%)] Loss: 1.68101 (QuantReg: 22.62133) QuantErr: 22.62133 batch_time=0.43862 
Train Epoch: 1 [891/1000 28512/32000 (89%)] Loss: 2.65190 (QuantReg: 22.71035) QuantErr: 22.71035 batch_time=0.35801 
Train Epoch: 1 [896/1000 28672/32000 (90%)] Loss: 2.01141 (QuantReg: 22.69554) QuantErr: 22.69554 batch_time=0.36395 
Train Epoch: 1 [901/1000 28832/32000 (90%)] Loss: 1.76089 (QuantReg: 22.73411) QuantErr: 22.73411 batch_time=0.36522 
Train Epoch: 1 [906/1000 28992/32000 (91%)] Loss: 2.40309 (QuantReg: 22.68969) QuantErr: 22.68969 batch_time=0.38628 
Train Epoch: 1 [911/1000 29152/32000 (91%)] Loss: 3.21153 (QuantReg: 22.69441) QuantErr: 22.69441 batch_time=0.34485 
Train Epoch: 1 [916/1000 29312/32000 (92%)] Loss: 2.09662 (QuantReg: 22.70910) QuantErr: 22.70910 batch_time=0.86311 
Train Epoch: 1 [921/1000 29472/32000 (92%)] Loss: 1.97986 (QuantReg: 22.71400) QuantErr: 22.71400 batch_time=0.36618 
Train Epoch: 1 [926/1000 29632/32000 (93%)] Loss: 2.40962 (QuantReg: 22.69849) QuantErr: 22.69849 batch_time=0.39959 
Train Epoch: 1 [931/1000 29792/32000 (93%)] Loss: 1.95217 (QuantReg: 22.68738) QuantErr: 22.68738 batch_time=0.42299 
Train Epoch: 1 [936/1000 29952/32000 (94%)] Loss: 2.00676 (QuantReg: 22.62776) QuantErr: 22.62776 batch_time=0.41589 
Train Epoch: 1 [941/1000 30112/32000 (94%)] Loss: 1.96806 (QuantReg: 22.72598) QuantErr: 22.72598 batch_time=1.47947 
Train Epoch: 1 [946/1000 30272/32000 (95%)] Loss: 3.05017 (QuantReg: 22.70805) QuantErr: 22.70805 batch_time=0.39252 
Train Epoch: 1 [951/1000 30432/32000 (95%)] Loss: 2.97563 (QuantReg: 22.64503) QuantErr: 22.64503 batch_time=0.37654 
Train Epoch: 1 [956/1000 30592/32000 (96%)] Loss: 2.25262 (QuantReg: 22.66682) QuantErr: 22.66682 batch_time=1.09107 
Train Epoch: 1 [961/1000 30752/32000 (96%)] Loss: 1.52687 (QuantReg: 22.70984) QuantErr: 22.70984 batch_time=0.36525 
Train Epoch: 1 [966/1000 30912/32000 (97%)] Loss: 2.64189 (QuantReg: 22.67199) QuantErr: 22.67199 batch_time=0.38769 
Train Epoch: 1 [971/1000 31072/32000 (97%)] Loss: 1.59396 (QuantReg: 22.69535) QuantErr: 22.69535 batch_time=0.57912 
Train Epoch: 1 [976/1000 31232/32000 (98%)] Loss: 1.59364 (QuantReg: 22.69168) QuantErr: 22.69168 batch_time=0.35709 
Train Epoch: 1 [981/1000 31392/32000 (98%)] Loss: 1.43716 (QuantReg: 22.73942) QuantErr: 22.73942 batch_time=0.42213 
Train Epoch: 1 [986/1000 31552/32000 (99%)] Loss: 1.64837 (QuantReg: 22.68735) QuantErr: 22.68735 batch_time=0.40968 
Train Epoch: 1 [991/1000 31712/32000 (99%)] Loss: 1.27649 (QuantReg: 22.68407) QuantErr: 22.68407 batch_time=0.40376 
Train Epoch: 1 [996/1000 31872/32000 (100%)] Loss: 2.23151 (QuantReg: 22.66733) QuantErr: 22.66733 batch_time=1.31524 
Train Epoch: 1 codebook_update_time=2.07739
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch1.pth ...
Done in 13.576s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch1.pth ...
Done in 17.890s
 epoch          : 1
 loss           : 2.8736367619037626
 quant_reg      : 22.65506612968445
 quant_err      : 22.65506612968445
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 1000
 MSRVTT_miech_test/t2v_metrics/R1: 9.0
 MSRVTT_miech_test/t2v_metrics/R5: 30.7
 MSRVTT_miech_test/t2v_metrics/R10: 44.4
 MSRVTT_miech_test/t2v_metrics/R50: 79.0
 MSRVTT_miech_test/t2v_metrics/MedR: 13.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 44.678
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.06329133380938
 MSRVTT_miech_test/v2t_metrics/R1: 9.9
 MSRVTT_miech_test/v2t_metrics/R5: 32.1
 MSRVTT_miech_test/v2t_metrics/R10: 46.3
 MSRVTT_miech_test/v2t_metrics/R50: 77.1
 MSRVTT_miech_test/v2t_metrics/MedR: 12.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 46.559
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.50419309046159
 mnt_best       : 23.06329133380938
 not_improved_count: 0
Train Epoch: 2 [1/1000 32/32000 (0%)] Loss: 1.59650 (QuantReg: 11.04956) QuantErr: 11.04956 batch_time=28.85111 
Train Epoch: 2 [6/1000 192/32000 (1%)] Loss: 1.75958 (QuantReg: 11.15532) QuantErr: 11.15532 batch_time=0.47753 
Train Epoch: 2 [11/1000 352/32000 (1%)] Loss: 1.94723 (QuantReg: 11.34632) QuantErr: 11.34632 batch_time=0.35086 
Train Epoch: 2 [16/1000 512/32000 (2%)] Loss: 2.22362 (QuantReg: 10.66970) QuantErr: 10.66970 batch_time=0.39864 
Train Epoch: 2 [21/1000 672/32000 (2%)] Loss: 1.70675 (QuantReg: 10.92089) QuantErr: 10.92089 batch_time=0.39979 
Train Epoch: 2 [26/1000 832/32000 (3%)] Loss: 3.04621 (QuantReg: 11.09058) QuantErr: 11.09058 batch_time=0.33605 
Train Epoch: 2 [31/1000 992/32000 (3%)] Loss: 1.78139 (QuantReg: 11.83638) QuantErr: 11.83638 batch_time=0.39330 
Train Epoch: 2 [36/1000 1152/32000 (4%)] Loss: 2.46111 (QuantReg: 10.86958) QuantErr: 10.86958 batch_time=0.33692 
Train Epoch: 2 [41/1000 1312/32000 (4%)] Loss: 2.34452 (QuantReg: 11.45726) QuantErr: 11.45726 batch_time=0.47604 
Train Epoch: 2 [46/1000 1472/32000 (5%)] Loss: 1.96690 (QuantReg: 11.40751) QuantErr: 11.40751 batch_time=0.36633 
Train Epoch: 2 [51/1000 1632/32000 (5%)] Loss: 2.20636 (QuantReg: 11.42958) QuantErr: 11.42958 batch_time=0.47681 
Train Epoch: 2 [56/1000 1792/32000 (6%)] Loss: 2.73162 (QuantReg: 11.59749) QuantErr: 11.59749 batch_time=0.37267 
Train Epoch: 2 [61/1000 1952/32000 (6%)] Loss: 2.35399 (QuantReg: 11.65382) QuantErr: 11.65382 batch_time=0.40680 
Train Epoch: 2 [66/1000 2112/32000 (7%)] Loss: 2.21695 (QuantReg: 11.09314) QuantErr: 11.09314 batch_time=0.51561 
Train Epoch: 2 [71/1000 2272/32000 (7%)] Loss: 1.79948 (QuantReg: 11.52812) QuantErr: 11.52812 batch_time=0.44385 
Train Epoch: 2 [76/1000 2432/32000 (8%)] Loss: 1.60441 (QuantReg: 10.75056) QuantErr: 10.75056 batch_time=0.46163 
Train Epoch: 2 [81/1000 2592/32000 (8%)] Loss: 1.40110 (QuantReg: 11.30370) QuantErr: 11.30370 batch_time=1.64086 
Train Epoch: 2 [86/1000 2752/32000 (9%)] Loss: 2.11636 (QuantReg: 11.69599) QuantErr: 11.69599 batch_time=0.84290 
Train Epoch: 2 [91/1000 2912/32000 (9%)] Loss: 1.46743 (QuantReg: 11.19899) QuantErr: 11.19899 batch_time=0.42884 
Train Epoch: 2 [96/1000 3072/32000 (10%)] Loss: 1.81252 (QuantReg: 11.02521) QuantErr: 11.02521 batch_time=0.36712 
Train Epoch: 2 [101/1000 3232/32000 (10%)] Loss: 1.78327 (QuantReg: 12.05923) QuantErr: 12.05923 batch_time=0.39831 
Train Epoch: 2 [106/1000 3392/32000 (11%)] Loss: 1.82834 (QuantReg: 12.02657) QuantErr: 12.02657 batch_time=0.35712 
Train Epoch: 2 [111/1000 3552/32000 (11%)] Loss: 2.32217 (QuantReg: 11.53205) QuantErr: 11.53205 batch_time=0.32955 
Train Epoch: 2 [116/1000 3712/32000 (12%)] Loss: 2.23828 (QuantReg: 11.34474) QuantErr: 11.34474 batch_time=0.42377 
Train Epoch: 2 [121/1000 3872/32000 (12%)] Loss: 2.75632 (QuantReg: 11.62270) QuantErr: 11.62270 batch_time=0.34534 
Train Epoch: 2 [126/1000 4032/32000 (13%)] Loss: 2.24259 (QuantReg: 11.37372) QuantErr: 11.37372 batch_time=0.53703 
Train Epoch: 2 [131/1000 4192/32000 (13%)] Loss: 1.82327 (QuantReg: 11.18506) QuantErr: 11.18506 batch_time=0.40640 
Train Epoch: 2 [136/1000 4352/32000 (14%)] Loss: 2.43529 (QuantReg: 11.09440) QuantErr: 11.09440 batch_time=0.56994 
Train Epoch: 2 [141/1000 4512/32000 (14%)] Loss: 2.14627 (QuantReg: 10.91230) QuantErr: 10.91230 batch_time=0.43050 
Train Epoch: 2 [146/1000 4672/32000 (15%)] Loss: 2.77229 (QuantReg: 11.72022) QuantErr: 11.72022 batch_time=0.44007 
Train Epoch: 2 [151/1000 4832/32000 (15%)] Loss: 1.27375 (QuantReg: 11.62797) QuantErr: 11.62797 batch_time=0.43075 
Train Epoch: 2 [156/1000 4992/32000 (16%)] Loss: 2.04385 (QuantReg: 11.63503) QuantErr: 11.63503 batch_time=0.36671 
Train Epoch: 2 [161/1000 5152/32000 (16%)] Loss: 1.85718 (QuantReg: 11.29584) QuantErr: 11.29584 batch_time=0.57183 
Train Epoch: 2 [166/1000 5312/32000 (17%)] Loss: 1.70500 (QuantReg: 11.25061) QuantErr: 11.25061 batch_time=0.38919 
Train Epoch: 2 [171/1000 5472/32000 (17%)] Loss: 1.78180 (QuantReg: 11.44366) QuantErr: 11.44366 batch_time=0.34801 
Train Epoch: 2 [176/1000 5632/32000 (18%)] Loss: 1.82896 (QuantReg: 11.32336) QuantErr: 11.32336 batch_time=0.45939 
Train Epoch: 2 [181/1000 5792/32000 (18%)] Loss: 1.48957 (QuantReg: 11.32832) QuantErr: 11.32832 batch_time=0.44256 
Train Epoch: 2 [186/1000 5952/32000 (19%)] Loss: 2.03319 (QuantReg: 11.58747) QuantErr: 11.58747 batch_time=0.46660 
Train Epoch: 2 [191/1000 6112/32000 (19%)] Loss: 1.58180 (QuantReg: 12.01117) QuantErr: 12.01117 batch_time=0.39037 
Train Epoch: 2 [196/1000 6272/32000 (20%)] Loss: 2.19930 (QuantReg: 11.76487) QuantErr: 11.76487 batch_time=0.38699 
Train Epoch: 2 [201/1000 6432/32000 (20%)] Loss: 2.48412 (QuantReg: 10.96472) QuantErr: 10.96472 batch_time=0.97526 
Train Epoch: 2 [206/1000 6592/32000 (21%)] Loss: 2.57361 (QuantReg: 11.26295) QuantErr: 11.26295 batch_time=0.76963 
Train Epoch: 2 [211/1000 6752/32000 (21%)] Loss: 1.82088 (QuantReg: 11.30287) QuantErr: 11.30287 batch_time=0.40706 
Train Epoch: 2 [216/1000 6912/32000 (22%)] Loss: 2.31339 (QuantReg: 11.40342) QuantErr: 11.40342 batch_time=0.34523 
Train Epoch: 2 [221/1000 7072/32000 (22%)] Loss: 2.11197 (QuantReg: 11.53201) QuantErr: 11.53201 batch_time=0.45029 
Train Epoch: 2 [226/1000 7232/32000 (23%)] Loss: 2.03726 (QuantReg: 11.89434) QuantErr: 11.89434 batch_time=0.37696 
Train Epoch: 2 [231/1000 7392/32000 (23%)] Loss: 1.55689 (QuantReg: 11.93100) QuantErr: 11.93100 batch_time=0.35582 
Train Epoch: 2 [236/1000 7552/32000 (24%)] Loss: 1.42902 (QuantReg: 11.36795) QuantErr: 11.36795 batch_time=0.36619 
Train Epoch: 2 [241/1000 7712/32000 (24%)] Loss: 2.01412 (QuantReg: 11.45144) QuantErr: 11.45144 batch_time=0.35094 
Train Epoch: 2 [246/1000 7872/32000 (25%)] Loss: 2.14669 (QuantReg: 11.84644) QuantErr: 11.84644 batch_time=0.39091 
Train Epoch: 2 [251/1000 8032/32000 (25%)] Loss: 1.53273 (QuantReg: 12.10335) QuantErr: 12.10335 batch_time=0.47929 
Train Epoch: 2 [256/1000 8192/32000 (26%)] Loss: 1.89016 (QuantReg: 12.04279) QuantErr: 12.04279 batch_time=0.39012 
Train Epoch: 2 [261/1000 8352/32000 (26%)] Loss: 1.67522 (QuantReg: 11.39212) QuantErr: 11.39212 batch_time=0.44440 
Train Epoch: 2 [266/1000 8512/32000 (27%)] Loss: 2.49032 (QuantReg: 11.88628) QuantErr: 11.88628 batch_time=0.40306 
Train Epoch: 2 [271/1000 8672/32000 (27%)] Loss: 1.51149 (QuantReg: 12.02468) QuantErr: 12.02468 batch_time=0.44970 
Train Epoch: 2 [276/1000 8832/32000 (28%)] Loss: 1.88183 (QuantReg: 12.03005) QuantErr: 12.03005 batch_time=0.38797 
Train Epoch: 2 [281/1000 8992/32000 (28%)] Loss: 1.41693 (QuantReg: 11.79107) QuantErr: 11.79107 batch_time=0.38978 
Train Epoch: 2 [286/1000 9152/32000 (29%)] Loss: 3.32614 (QuantReg: 11.24847) QuantErr: 11.24847 batch_time=0.40491 
Train Epoch: 2 [291/1000 9312/32000 (29%)] Loss: 1.25557 (QuantReg: 12.28993) QuantErr: 12.28993 batch_time=0.47694 
Train Epoch: 2 [296/1000 9472/32000 (30%)] Loss: 2.95254 (QuantReg: 12.13972) QuantErr: 12.13972 batch_time=0.39760 
Train Epoch: 2 [301/1000 9632/32000 (30%)] Loss: 2.67548 (QuantReg: 11.61620) QuantErr: 11.61620 batch_time=0.59416 
Train Epoch: 2 [306/1000 9792/32000 (31%)] Loss: 1.51559 (QuantReg: 12.22987) QuantErr: 12.22987 batch_time=0.50648 
Train Epoch: 2 [311/1000 9952/32000 (31%)] Loss: 0.93479 (QuantReg: 11.72334) QuantErr: 11.72334 batch_time=0.43085 
Train Epoch: 2 [316/1000 10112/32000 (32%)] Loss: 2.04975 (QuantReg: 12.36626) QuantErr: 12.36626 batch_time=0.37365 
Train Epoch: 2 [321/1000 10272/32000 (32%)] Loss: 1.44557 (QuantReg: 12.15748) QuantErr: 12.15748 batch_time=0.36712 
Train Epoch: 2 [326/1000 10432/32000 (33%)] Loss: 1.95388 (QuantReg: 12.46191) QuantErr: 12.46191 batch_time=0.41924 
Train Epoch: 2 [331/1000 10592/32000 (33%)] Loss: 1.35579 (QuantReg: 12.27896) QuantErr: 12.27896 batch_time=0.55704 
Train Epoch: 2 [336/1000 10752/32000 (34%)] Loss: 2.54277 (QuantReg: 12.33962) QuantErr: 12.33962 batch_time=0.40698 
Train Epoch: 2 [341/1000 10912/32000 (34%)] Loss: 1.34807 (QuantReg: 12.40826) QuantErr: 12.40826 batch_time=0.40324 
Train Epoch: 2 [346/1000 11072/32000 (35%)] Loss: 2.91031 (QuantReg: 12.36873) QuantErr: 12.36873 batch_time=0.55101 
Train Epoch: 2 [351/1000 11232/32000 (35%)] Loss: 1.78586 (QuantReg: 12.85553) QuantErr: 12.85553 batch_time=0.41932 
Train Epoch: 2 [356/1000 11392/32000 (36%)] Loss: 1.65420 (QuantReg: 12.47159) QuantErr: 12.47159 batch_time=0.48275 
Train Epoch: 2 [361/1000 11552/32000 (36%)] Loss: 1.62327 (QuantReg: 12.90754) QuantErr: 12.90754 batch_time=0.40206 
Train Epoch: 2 [366/1000 11712/32000 (37%)] Loss: 2.05537 (QuantReg: 12.66328) QuantErr: 12.66328 batch_time=0.37878 
Train Epoch: 2 [371/1000 11872/32000 (37%)] Loss: 2.36505 (QuantReg: 12.12623) QuantErr: 12.12623 batch_time=0.36497 
Train Epoch: 2 [376/1000 12032/32000 (38%)] Loss: 2.21185 (QuantReg: 12.14961) QuantErr: 12.14961 batch_time=0.63072 
Train Epoch: 2 [381/1000 12192/32000 (38%)] Loss: 1.56768 (QuantReg: 12.61436) QuantErr: 12.61436 batch_time=0.63943 
Train Epoch: 2 [386/1000 12352/32000 (39%)] Loss: 1.90995 (QuantReg: 12.20288) QuantErr: 12.20288 batch_time=0.37905 
Train Epoch: 2 [391/1000 12512/32000 (39%)] Loss: 1.94354 (QuantReg: 11.93825) QuantErr: 11.93825 batch_time=0.35691 
Train Epoch: 2 [396/1000 12672/32000 (40%)] Loss: 1.91151 (QuantReg: 13.05478) QuantErr: 13.05478 batch_time=0.44869 
Train Epoch: 2 [401/1000 12832/32000 (40%)] Loss: 1.65225 (QuantReg: 12.70260) QuantErr: 12.70260 batch_time=1.01400 
Train Epoch: 2 [406/1000 12992/32000 (41%)] Loss: 1.47913 (QuantReg: 12.78201) QuantErr: 12.78201 batch_time=0.39862 
Train Epoch: 2 [411/1000 13152/32000 (41%)] Loss: 1.78377 (QuantReg: 12.71450) QuantErr: 12.71450 batch_time=0.34897 
Train Epoch: 2 [416/1000 13312/32000 (42%)] Loss: 1.98682 (QuantReg: 12.22050) QuantErr: 12.22050 batch_time=0.90944 
Train Epoch: 2 [421/1000 13472/32000 (42%)] Loss: 1.89043 (QuantReg: 12.96612) QuantErr: 12.96612 batch_time=0.34951 
Train Epoch: 2 [426/1000 13632/32000 (43%)] Loss: 2.14098 (QuantReg: 12.80999) QuantErr: 12.80999 batch_time=0.37263 
Train Epoch: 2 [431/1000 13792/32000 (43%)] Loss: 2.42629 (QuantReg: 12.47249) QuantErr: 12.47249 batch_time=0.34642 
Train Epoch: 2 [436/1000 13952/32000 (44%)] Loss: 1.65856 (QuantReg: 12.01659) QuantErr: 12.01659 batch_time=0.37793 
Train Epoch: 2 [441/1000 14112/32000 (44%)] Loss: 1.64226 (QuantReg: 12.83831) QuantErr: 12.83831 batch_time=0.34588 
Train Epoch: 2 [446/1000 14272/32000 (45%)] Loss: 2.19858 (QuantReg: 12.38336) QuantErr: 12.38336 batch_time=0.36213 
Train Epoch: 2 [451/1000 14432/32000 (45%)] Loss: 2.44729 (QuantReg: 12.16677) QuantErr: 12.16677 batch_time=0.32895 
Train Epoch: 2 [456/1000 14592/32000 (46%)] Loss: 2.05942 (QuantReg: 12.18595) QuantErr: 12.18595 batch_time=0.77812 
Train Epoch: 2 [461/1000 14752/32000 (46%)] Loss: 1.74978 (QuantReg: 11.71680) QuantErr: 11.71680 batch_time=0.47110 
Train Epoch: 2 [466/1000 14912/32000 (47%)] Loss: 1.77326 (QuantReg: 12.10964) QuantErr: 12.10964 batch_time=0.35003 
Train Epoch: 2 [471/1000 15072/32000 (47%)] Loss: 1.34792 (QuantReg: 12.31599) QuantErr: 12.31599 batch_time=0.39931 
Train Epoch: 2 [476/1000 15232/32000 (48%)] Loss: 1.83325 (QuantReg: 12.24381) QuantErr: 12.24381 batch_time=0.40881 
Train Epoch: 2 [481/1000 15392/32000 (48%)] Loss: 1.70431 (QuantReg: 12.16152) QuantErr: 12.16152 batch_time=0.41724 
Train Epoch: 2 [486/1000 15552/32000 (49%)] Loss: 1.34183 (QuantReg: 12.94968) QuantErr: 12.94968 batch_time=0.38878 
Train Epoch: 2 [491/1000 15712/32000 (49%)] Loss: 1.69953 (QuantReg: 12.58185) QuantErr: 12.58185 batch_time=0.34824 
Train Epoch: 2 [496/1000 15872/32000 (50%)] Loss: 1.16042 (QuantReg: 11.89123) QuantErr: 11.89123 batch_time=0.36369 
Train Epoch: 2 [501/1000 16032/32000 (50%)] Loss: 1.71100 (QuantReg: 11.87775) QuantErr: 11.87775 batch_time=0.62185 
Train Epoch: 2 [506/1000 16192/32000 (51%)] Loss: 2.19096 (QuantReg: 12.31124) QuantErr: 12.31124 batch_time=0.38974 
Train Epoch: 2 [511/1000 16352/32000 (51%)] Loss: 1.86027 (QuantReg: 12.32931) QuantErr: 12.32931 batch_time=0.34289 
Train Epoch: 2 [516/1000 16512/32000 (52%)] Loss: 2.19441 (QuantReg: 12.75998) QuantErr: 12.75998 batch_time=0.33777 
Train Epoch: 2 [521/1000 16672/32000 (52%)] Loss: 1.56779 (QuantReg: 12.77747) QuantErr: 12.77747 batch_time=0.35127 
Train Epoch: 2 [526/1000 16832/32000 (53%)] Loss: 1.60631 (QuantReg: 12.38487) QuantErr: 12.38487 batch_time=0.41797 
Train Epoch: 2 [531/1000 16992/32000 (53%)] Loss: 1.63002 (QuantReg: 12.49246) QuantErr: 12.49246 batch_time=0.40552 
Train Epoch: 2 [536/1000 17152/32000 (54%)] Loss: 1.44931 (QuantReg: 12.67584) QuantErr: 12.67584 batch_time=0.35570 
Train Epoch: 2 [541/1000 17312/32000 (54%)] Loss: 1.78311 (QuantReg: 12.11182) QuantErr: 12.11182 batch_time=0.61453 
Train Epoch: 2 [546/1000 17472/32000 (55%)] Loss: 1.81637 (QuantReg: 12.35622) QuantErr: 12.35622 batch_time=0.34766 
Train Epoch: 2 [551/1000 17632/32000 (55%)] Loss: 2.42789 (QuantReg: 12.62142) QuantErr: 12.62142 batch_time=0.46528 
Train Epoch: 2 [556/1000 17792/32000 (56%)] Loss: 1.77767 (QuantReg: 12.21712) QuantErr: 12.21712 batch_time=0.34751 
Train Epoch: 2 [561/1000 17952/32000 (56%)] Loss: 1.94970 (QuantReg: 12.23572) QuantErr: 12.23572 batch_time=0.34469 
Train Epoch: 2 [566/1000 18112/32000 (57%)] Loss: 1.93710 (QuantReg: 12.22053) QuantErr: 12.22053 batch_time=0.35706 
Train Epoch: 2 [571/1000 18272/32000 (57%)] Loss: 1.42406 (QuantReg: 12.23684) QuantErr: 12.23684 batch_time=0.40894 
Train Epoch: 2 [576/1000 18432/32000 (58%)] Loss: 2.46804 (QuantReg: 12.84453) QuantErr: 12.84453 batch_time=0.40198 
Train Epoch: 2 [581/1000 18592/32000 (58%)] Loss: 1.45086 (QuantReg: 13.12034) QuantErr: 13.12034 batch_time=0.37580 
Train Epoch: 2 [586/1000 18752/32000 (59%)] Loss: 1.68802 (QuantReg: 12.46167) QuantErr: 12.46167 batch_time=0.82093 
Train Epoch: 2 [591/1000 18912/32000 (59%)] Loss: 1.64137 (QuantReg: 12.88564) QuantErr: 12.88564 batch_time=0.43804 
Train Epoch: 2 [596/1000 19072/32000 (60%)] Loss: 1.33819 (QuantReg: 12.91085) QuantErr: 12.91085 batch_time=0.35541 
Train Epoch: 2 [601/1000 19232/32000 (60%)] Loss: 1.53887 (QuantReg: 13.42488) QuantErr: 13.42488 batch_time=0.38114 
Train Epoch: 2 [606/1000 19392/32000 (61%)] Loss: 1.13567 (QuantReg: 12.85031) QuantErr: 12.85031 batch_time=0.45534 
Train Epoch: 2 [611/1000 19552/32000 (61%)] Loss: 2.27631 (QuantReg: 12.75382) QuantErr: 12.75382 batch_time=0.62276 
Train Epoch: 2 [616/1000 19712/32000 (62%)] Loss: 2.13426 (QuantReg: 12.89777) QuantErr: 12.89777 batch_time=0.39074 
Train Epoch: 2 [621/1000 19872/32000 (62%)] Loss: 1.78925 (QuantReg: 13.07025) QuantErr: 13.07025 batch_time=0.35550 
Train Epoch: 2 [626/1000 20032/32000 (63%)] Loss: 2.11337 (QuantReg: 12.54755) QuantErr: 12.54755 batch_time=0.35018 
Train Epoch: 2 [631/1000 20192/32000 (63%)] Loss: 1.77765 (QuantReg: 13.17714) QuantErr: 13.17714 batch_time=1.74720 
Train Epoch: 2 [636/1000 20352/32000 (64%)] Loss: 1.75584 (QuantReg: 12.89378) QuantErr: 12.89378 batch_time=0.55845 
Train Epoch: 2 [641/1000 20512/32000 (64%)] Loss: 2.30986 (QuantReg: 13.02964) QuantErr: 13.02964 batch_time=0.36050 
Train Epoch: 2 [646/1000 20672/32000 (65%)] Loss: 1.80647 (QuantReg: 13.06067) QuantErr: 13.06067 batch_time=0.34102 
Train Epoch: 2 [651/1000 20832/32000 (65%)] Loss: 1.61499 (QuantReg: 13.09633) QuantErr: 13.09633 batch_time=0.34625 
Train Epoch: 2 [656/1000 20992/32000 (66%)] Loss: 1.76329 (QuantReg: 13.49212) QuantErr: 13.49212 batch_time=0.42680 
Train Epoch: 2 [661/1000 21152/32000 (66%)] Loss: 1.41252 (QuantReg: 12.91519) QuantErr: 12.91519 batch_time=0.41525 
Train Epoch: 2 [666/1000 21312/32000 (67%)] Loss: 1.18282 (QuantReg: 13.45753) QuantErr: 13.45753 batch_time=0.36271 
Train Epoch: 2 [671/1000 21472/32000 (67%)] Loss: 1.76064 (QuantReg: 12.77184) QuantErr: 12.77184 batch_time=0.80353 
Train Epoch: 2 [676/1000 21632/32000 (68%)] Loss: 1.74781 (QuantReg: 13.00180) QuantErr: 13.00180 batch_time=0.53070 
Train Epoch: 2 [681/1000 21792/32000 (68%)] Loss: 1.58192 (QuantReg: 12.39982) QuantErr: 12.39982 batch_time=0.36710 
Train Epoch: 2 [686/1000 21952/32000 (69%)] Loss: 1.25542 (QuantReg: 12.73102) QuantErr: 12.73102 batch_time=0.38918 
Train Epoch: 2 [691/1000 22112/32000 (69%)] Loss: 1.77504 (QuantReg: 13.24879) QuantErr: 13.24879 batch_time=0.34367 
Train Epoch: 2 [696/1000 22272/32000 (70%)] Loss: 1.26029 (QuantReg: 12.48056) QuantErr: 12.48056 batch_time=0.34066 
Train Epoch: 2 [701/1000 22432/32000 (70%)] Loss: 1.76841 (QuantReg: 12.32231) QuantErr: 12.32231 batch_time=0.34029 
Train Epoch: 2 [706/1000 22592/32000 (71%)] Loss: 1.76469 (QuantReg: 12.78743) QuantErr: 12.78743 batch_time=0.34436 
Train Epoch: 2 [711/1000 22752/32000 (71%)] Loss: 1.88980 (QuantReg: 12.79297) QuantErr: 12.79297 batch_time=0.36262 
Train Epoch: 2 [716/1000 22912/32000 (72%)] Loss: 1.50880 (QuantReg: 12.69408) QuantErr: 12.69408 batch_time=0.77593 
Train Epoch: 2 [721/1000 23072/32000 (72%)] Loss: 2.61186 (QuantReg: 12.71964) QuantErr: 12.71964 batch_time=1.09939 
Train Epoch: 2 [726/1000 23232/32000 (73%)] Loss: 1.78795 (QuantReg: 12.90847) QuantErr: 12.90847 batch_time=0.55719 
Train Epoch: 2 [731/1000 23392/32000 (73%)] Loss: 2.31384 (QuantReg: 12.91839) QuantErr: 12.91839 batch_time=0.39754 
Train Epoch: 2 [736/1000 23552/32000 (74%)] Loss: 1.42733 (QuantReg: 13.13735) QuantErr: 13.13735 batch_time=0.39135 
Train Epoch: 2 [741/1000 23712/32000 (74%)] Loss: 1.71318 (QuantReg: 12.87537) QuantErr: 12.87537 batch_time=0.37987 
Train Epoch: 2 [746/1000 23872/32000 (75%)] Loss: 1.63012 (QuantReg: 12.89242) QuantErr: 12.89242 batch_time=0.41868 
Train Epoch: 2 [751/1000 24032/32000 (75%)] Loss: 1.02975 (QuantReg: 13.05993) QuantErr: 13.05993 batch_time=0.39638 
Train Epoch: 2 [756/1000 24192/32000 (76%)] Loss: 1.65859 (QuantReg: 12.73340) QuantErr: 12.73340 batch_time=0.54514 
Train Epoch: 2 [761/1000 24352/32000 (76%)] Loss: 1.16065 (QuantReg: 13.22979) QuantErr: 13.22979 batch_time=0.38762 
Train Epoch: 2 [766/1000 24512/32000 (77%)] Loss: 1.42748 (QuantReg: 13.20444) QuantErr: 13.20444 batch_time=0.33446 
Train Epoch: 2 [771/1000 24672/32000 (77%)] Loss: 1.88831 (QuantReg: 13.62340) QuantErr: 13.62340 batch_time=0.39997 
Train Epoch: 2 [776/1000 24832/32000 (78%)] Loss: 0.99920 (QuantReg: 13.27092) QuantErr: 13.27092 batch_time=0.35447 
Train Epoch: 2 [781/1000 24992/32000 (78%)] Loss: 1.48693 (QuantReg: 12.52418) QuantErr: 12.52418 batch_time=0.45070 
Train Epoch: 2 [786/1000 25152/32000 (79%)] Loss: 1.64648 (QuantReg: 12.85906) QuantErr: 12.85906 batch_time=0.37518 
Train Epoch: 2 [791/1000 25312/32000 (79%)] Loss: 1.37459 (QuantReg: 12.81955) QuantErr: 12.81955 batch_time=0.67823 
Train Epoch: 2 [796/1000 25472/32000 (80%)] Loss: 1.53837 (QuantReg: 12.82946) QuantErr: 12.82946 batch_time=0.56074 
Train Epoch: 2 [801/1000 25632/32000 (80%)] Loss: 2.39050 (QuantReg: 12.87661) QuantErr: 12.87661 batch_time=0.36124 
Train Epoch: 2 [806/1000 25792/32000 (81%)] Loss: 2.15770 (QuantReg: 12.61876) QuantErr: 12.61876 batch_time=0.35259 
Train Epoch: 2 [811/1000 25952/32000 (81%)] Loss: 2.50077 (QuantReg: 12.27687) QuantErr: 12.27687 batch_time=0.48176 
Train Epoch: 2 [816/1000 26112/32000 (82%)] Loss: 1.55393 (QuantReg: 12.83751) QuantErr: 12.83751 batch_time=0.35874 
Train Epoch: 2 [821/1000 26272/32000 (82%)] Loss: 1.73256 (QuantReg: 12.85370) QuantErr: 12.85370 batch_time=0.41257 
Train Epoch: 2 [826/1000 26432/32000 (83%)] Loss: 1.40504 (QuantReg: 13.04789) QuantErr: 13.04789 batch_time=0.41431 
Train Epoch: 2 [831/1000 26592/32000 (83%)] Loss: 1.26196 (QuantReg: 12.92880) QuantErr: 12.92880 batch_time=0.35181 
Train Epoch: 2 [836/1000 26752/32000 (84%)] Loss: 1.84123 (QuantReg: 12.83598) QuantErr: 12.83598 batch_time=0.35474 
Train Epoch: 2 [841/1000 26912/32000 (84%)] Loss: 1.61587 (QuantReg: 12.97260) QuantErr: 12.97260 batch_time=0.67557 
Train Epoch: 2 [846/1000 27072/32000 (85%)] Loss: 3.13188 (QuantReg: 13.19060) QuantErr: 13.19060 batch_time=0.37031 
Train Epoch: 2 [851/1000 27232/32000 (85%)] Loss: 1.73955 (QuantReg: 12.90141) QuantErr: 12.90141 batch_time=0.43357 
Train Epoch: 2 [856/1000 27392/32000 (86%)] Loss: 1.61494 (QuantReg: 12.56622) QuantErr: 12.56622 batch_time=0.36739 
Train Epoch: 2 [861/1000 27552/32000 (86%)] Loss: 1.12334 (QuantReg: 12.66118) QuantErr: 12.66118 batch_time=0.40668 
Train Epoch: 2 [866/1000 27712/32000 (87%)] Loss: 1.74266 (QuantReg: 13.31044) QuantErr: 13.31044 batch_time=0.41605 
Train Epoch: 2 [871/1000 27872/32000 (87%)] Loss: 1.53556 (QuantReg: 13.09508) QuantErr: 13.09508 batch_time=0.35736 
Train Epoch: 2 [876/1000 28032/32000 (88%)] Loss: 2.46385 (QuantReg: 12.80562) QuantErr: 12.80562 batch_time=0.52122 
Train Epoch: 2 [881/1000 28192/32000 (88%)] Loss: 1.57527 (QuantReg: 12.44219) QuantErr: 12.44219 batch_time=0.33729 
Train Epoch: 2 [886/1000 28352/32000 (89%)] Loss: 1.20530 (QuantReg: 12.98349) QuantErr: 12.98349 batch_time=0.44355 
Train Epoch: 2 [891/1000 28512/32000 (89%)] Loss: 1.94938 (QuantReg: 12.75589) QuantErr: 12.75589 batch_time=0.34299 
Train Epoch: 2 [896/1000 28672/32000 (90%)] Loss: 2.12346 (QuantReg: 13.24201) QuantErr: 13.24201 batch_time=0.38243 
Train Epoch: 2 [901/1000 28832/32000 (90%)] Loss: 1.49532 (QuantReg: 12.74413) QuantErr: 12.74413 batch_time=0.35349 
Train Epoch: 2 [906/1000 28992/32000 (91%)] Loss: 2.19845 (QuantReg: 13.53002) QuantErr: 13.53002 batch_time=0.36614 
Train Epoch: 2 [911/1000 29152/32000 (91%)] Loss: 1.67928 (QuantReg: 12.88094) QuantErr: 12.88094 batch_time=0.42555 
Train Epoch: 2 [916/1000 29312/32000 (92%)] Loss: 2.36561 (QuantReg: 13.22649) QuantErr: 13.22649 batch_time=0.44617 
Train Epoch: 2 [921/1000 29472/32000 (92%)] Loss: 1.41269 (QuantReg: 12.84479) QuantErr: 12.84479 batch_time=0.34425 
Train Epoch: 2 [926/1000 29632/32000 (93%)] Loss: 1.40146 (QuantReg: 12.93218) QuantErr: 12.93218 batch_time=0.49886 
Train Epoch: 2 [931/1000 29792/32000 (93%)] Loss: 2.09637 (QuantReg: 13.42178) QuantErr: 13.42178 batch_time=0.52618 
Train Epoch: 2 [936/1000 29952/32000 (94%)] Loss: 1.22492 (QuantReg: 13.56861) QuantErr: 13.56861 batch_time=0.35036 
Train Epoch: 2 [941/1000 30112/32000 (94%)] Loss: 1.22163 (QuantReg: 13.50693) QuantErr: 13.50693 batch_time=0.38916 
Train Epoch: 2 [946/1000 30272/32000 (95%)] Loss: 1.23845 (QuantReg: 13.31748) QuantErr: 13.31748 batch_time=0.43845 
Train Epoch: 2 [951/1000 30432/32000 (95%)] Loss: 1.32919 (QuantReg: 12.72526) QuantErr: 12.72526 batch_time=0.44583 
Train Epoch: 2 [956/1000 30592/32000 (96%)] Loss: 1.16446 (QuantReg: 13.84345) QuantErr: 13.84345 batch_time=0.68129 
Train Epoch: 2 [961/1000 30752/32000 (96%)] Loss: 2.71821 (QuantReg: 13.43257) QuantErr: 13.43257 batch_time=0.43035 
Train Epoch: 2 [966/1000 30912/32000 (97%)] Loss: 1.95204 (QuantReg: 14.03515) QuantErr: 14.03515 batch_time=0.33160 
Train Epoch: 2 [971/1000 31072/32000 (97%)] Loss: 1.70256 (QuantReg: 13.15400) QuantErr: 13.15400 batch_time=0.76136 
Train Epoch: 2 [976/1000 31232/32000 (98%)] Loss: 1.89902 (QuantReg: 12.99551) QuantErr: 12.99551 batch_time=0.34862 
Train Epoch: 2 [981/1000 31392/32000 (98%)] Loss: 1.79890 (QuantReg: 13.76497) QuantErr: 13.76497 batch_time=0.62689 
Train Epoch: 2 [986/1000 31552/32000 (99%)] Loss: 1.42734 (QuantReg: 12.97457) QuantErr: 12.97457 batch_time=0.36132 
Train Epoch: 2 [991/1000 31712/32000 (99%)] Loss: 1.24893 (QuantReg: 13.75439) QuantErr: 13.75439 batch_time=0.36500 
Train Epoch: 2 [996/1000 31872/32000 (100%)] Loss: 2.79165 (QuantReg: 13.63124) QuantErr: 13.63124 batch_time=0.35233 
Train Epoch: 2 codebook_update_time=2.16402
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch2.pth ...
Done in 10.023s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch2.pth ...
Done in 14.713s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 1.8235984505414964
 quant_reg      : 12.39538169670105
 quant_err      : 12.39538169670105
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 2000
 MSRVTT_miech_test/t2v_metrics/R1: 11.7
 MSRVTT_miech_test/t2v_metrics/R5: 35.8
 MSRVTT_miech_test/t2v_metrics/R10: 50.7
 MSRVTT_miech_test/t2v_metrics/R50: 83.0
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 39.636
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.69229498931042
 MSRVTT_miech_test/v2t_metrics/R1: 12.9
 MSRVTT_miech_test/v2t_metrics/R5: 34.3
 MSRVTT_miech_test/v2t_metrics/R10: 48.8
 MSRVTT_miech_test/v2t_metrics/R50: 80.5
 MSRVTT_miech_test/v2t_metrics/MedR: 11.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 39.855
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.8463247784924
 mnt_best       : 27.69229498931042
 not_improved_count: 0
Train Epoch: 3 [1/1000 32/32000 (0%)] Loss: 1.74628 (QuantReg: 11.35652) QuantErr: 11.35652 batch_time=26.11013 
Train Epoch: 3 [6/1000 192/32000 (1%)] Loss: 1.41003 (QuantReg: 11.58926) QuantErr: 11.58926 batch_time=1.84025 
Train Epoch: 3 [11/1000 352/32000 (1%)] Loss: 1.94255 (QuantReg: 11.11521) QuantErr: 11.11521 batch_time=0.37956 
Train Epoch: 3 [16/1000 512/32000 (2%)] Loss: 2.13532 (QuantReg: 10.42042) QuantErr: 10.42042 batch_time=0.48056 
Train Epoch: 3 [21/1000 672/32000 (2%)] Loss: 0.97443 (QuantReg: 11.01310) QuantErr: 11.01310 batch_time=0.48921 
Train Epoch: 3 [26/1000 832/32000 (3%)] Loss: 1.57613 (QuantReg: 11.01573) QuantErr: 11.01573 batch_time=0.34469 
Train Epoch: 3 [31/1000 992/32000 (3%)] Loss: 1.97218 (QuantReg: 11.49749) QuantErr: 11.49749 batch_time=0.34072 
Train Epoch: 3 [36/1000 1152/32000 (4%)] Loss: 2.15112 (QuantReg: 11.47361) QuantErr: 11.47361 batch_time=0.36243 
Train Epoch: 3 [41/1000 1312/32000 (4%)] Loss: 1.86473 (QuantReg: 10.76780) QuantErr: 10.76780 batch_time=0.38443 
Train Epoch: 3 [46/1000 1472/32000 (5%)] Loss: 1.65205 (QuantReg: 10.60555) QuantErr: 10.60555 batch_time=0.37063 
Train Epoch: 3 [51/1000 1632/32000 (5%)] Loss: 1.53901 (QuantReg: 10.97670) QuantErr: 10.97670 batch_time=0.38382 
Train Epoch: 3 [56/1000 1792/32000 (6%)] Loss: 1.21043 (QuantReg: 10.69176) QuantErr: 10.69176 batch_time=0.36615 
Train Epoch: 3 [61/1000 1952/32000 (6%)] Loss: 1.71646 (QuantReg: 10.56109) QuantErr: 10.56109 batch_time=0.67166 
Train Epoch: 3 [66/1000 2112/32000 (7%)] Loss: 1.51092 (QuantReg: 11.35974) QuantErr: 11.35974 batch_time=0.34344 
Train Epoch: 3 [71/1000 2272/32000 (7%)] Loss: 0.67031 (QuantReg: 11.52501) QuantErr: 11.52501 batch_time=0.42950 
Train Epoch: 3 [76/1000 2432/32000 (8%)] Loss: 1.07431 (QuantReg: 11.31764) QuantErr: 11.31764 batch_time=0.37998 
Train Epoch: 3 [81/1000 2592/32000 (8%)] Loss: 1.45240 (QuantReg: 10.93442) QuantErr: 10.93442 batch_time=0.35513 
Train Epoch: 3 [86/1000 2752/32000 (9%)] Loss: 1.78999 (QuantReg: 10.76310) QuantErr: 10.76310 batch_time=0.44000 
Train Epoch: 3 [91/1000 2912/32000 (9%)] Loss: 1.33625 (QuantReg: 11.41784) QuantErr: 11.41784 batch_time=0.42630 
Train Epoch: 3 [96/1000 3072/32000 (10%)] Loss: 1.47827 (QuantReg: 11.16611) QuantErr: 11.16611 batch_time=0.60125 
Train Epoch: 3 [101/1000 3232/32000 (10%)] Loss: 1.78833 (QuantReg: 10.98830) QuantErr: 10.98830 batch_time=0.35446 
Train Epoch: 3 [106/1000 3392/32000 (11%)] Loss: 1.06955 (QuantReg: 11.06174) QuantErr: 11.06174 batch_time=0.85783 
Train Epoch: 3 [111/1000 3552/32000 (11%)] Loss: 1.28930 (QuantReg: 10.90011) QuantErr: 10.90011 batch_time=0.36348 
Train Epoch: 3 [116/1000 3712/32000 (12%)] Loss: 1.11612 (QuantReg: 10.73591) QuantErr: 10.73591 batch_time=0.33638 
Train Epoch: 3 [121/1000 3872/32000 (12%)] Loss: 2.53599 (QuantReg: 11.67014) QuantErr: 11.67014 batch_time=0.35358 
Train Epoch: 3 [126/1000 4032/32000 (13%)] Loss: 1.59776 (QuantReg: 10.96740) QuantErr: 10.96740 batch_time=0.43730 
Train Epoch: 3 [131/1000 4192/32000 (13%)] Loss: 0.94791 (QuantReg: 11.78239) QuantErr: 11.78239 batch_time=0.48776 
Train Epoch: 3 [136/1000 4352/32000 (14%)] Loss: 2.08479 (QuantReg: 11.01962) QuantErr: 11.01962 batch_time=0.33902 
Train Epoch: 3 [141/1000 4512/32000 (14%)] Loss: 1.66562 (QuantReg: 11.35504) QuantErr: 11.35504 batch_time=0.48114 
Train Epoch: 3 [146/1000 4672/32000 (15%)] Loss: 2.08648 (QuantReg: 11.45880) QuantErr: 11.45880 batch_time=0.63074 
Train Epoch: 3 [151/1000 4832/32000 (15%)] Loss: 1.51390 (QuantReg: 11.33978) QuantErr: 11.33978 batch_time=0.39234 
Train Epoch: 3 [156/1000 4992/32000 (16%)] Loss: 1.48326 (QuantReg: 11.51990) QuantErr: 11.51990 batch_time=0.53297 
Train Epoch: 3 [161/1000 5152/32000 (16%)] Loss: 1.99544 (QuantReg: 11.68184) QuantErr: 11.68184 batch_time=0.45116 
Train Epoch: 3 [166/1000 5312/32000 (17%)] Loss: 1.78788 (QuantReg: 11.69006) QuantErr: 11.69006 batch_time=0.36942 
Train Epoch: 3 [171/1000 5472/32000 (17%)] Loss: 2.02204 (QuantReg: 10.94852) QuantErr: 10.94852 batch_time=0.42175 
Train Epoch: 3 [176/1000 5632/32000 (18%)] Loss: 1.45649 (QuantReg: 11.12457) QuantErr: 11.12457 batch_time=0.46286 
Train Epoch: 3 [181/1000 5792/32000 (18%)] Loss: 1.23704 (QuantReg: 11.59862) QuantErr: 11.59862 batch_time=0.39484 
Train Epoch: 3 [186/1000 5952/32000 (19%)] Loss: 1.46093 (QuantReg: 11.76748) QuantErr: 11.76748 batch_time=0.41840 
Train Epoch: 3 [191/1000 6112/32000 (19%)] Loss: 1.94441 (QuantReg: 11.16973) QuantErr: 11.16973 batch_time=0.74693 
Train Epoch: 3 [196/1000 6272/32000 (20%)] Loss: 1.77253 (QuantReg: 11.49362) QuantErr: 11.49362 batch_time=0.42352 
Train Epoch: 3 [201/1000 6432/32000 (20%)] Loss: 1.43241 (QuantReg: 10.59363) QuantErr: 10.59363 batch_time=0.58786 
Train Epoch: 3 [206/1000 6592/32000 (21%)] Loss: 0.85006 (QuantReg: 11.17766) QuantErr: 11.17766 batch_time=1.01628 
Train Epoch: 3 [211/1000 6752/32000 (21%)] Loss: 1.14107 (QuantReg: 11.81985) QuantErr: 11.81985 batch_time=0.36199 
Train Epoch: 3 [216/1000 6912/32000 (22%)] Loss: 0.96432 (QuantReg: 11.20297) QuantErr: 11.20297 batch_time=0.42086 
Train Epoch: 3 [221/1000 7072/32000 (22%)] Loss: 1.75607 (QuantReg: 11.84964) QuantErr: 11.84964 batch_time=0.72726 
Train Epoch: 3 [226/1000 7232/32000 (23%)] Loss: 1.98669 (QuantReg: 12.04498) QuantErr: 12.04498 batch_time=0.55447 
Train Epoch: 3 [231/1000 7392/32000 (23%)] Loss: 1.63134 (QuantReg: 11.36558) QuantErr: 11.36558 batch_time=0.36051 
Train Epoch: 3 [236/1000 7552/32000 (24%)] Loss: 1.48288 (QuantReg: 11.78679) QuantErr: 11.78679 batch_time=0.75683 
Train Epoch: 3 [241/1000 7712/32000 (24%)] Loss: 1.48119 (QuantReg: 11.65835) QuantErr: 11.65835 batch_time=0.43588 
Train Epoch: 3 [246/1000 7872/32000 (25%)] Loss: 1.79125 (QuantReg: 11.38746) QuantErr: 11.38746 batch_time=0.36364 
Train Epoch: 3 [251/1000 8032/32000 (25%)] Loss: 1.77416 (QuantReg: 11.63385) QuantErr: 11.63385 batch_time=0.36314 
Train Epoch: 3 [256/1000 8192/32000 (26%)] Loss: 0.98911 (QuantReg: 11.05727) QuantErr: 11.05727 batch_time=0.40759 
Train Epoch: 3 [261/1000 8352/32000 (26%)] Loss: 1.23628 (QuantReg: 11.57265) QuantErr: 11.57265 batch_time=0.38152 
Train Epoch: 3 [266/1000 8512/32000 (27%)] Loss: 1.35841 (QuantReg: 10.69051) QuantErr: 10.69051 batch_time=0.36386 
Train Epoch: 3 [271/1000 8672/32000 (27%)] Loss: 1.88417 (QuantReg: 11.87969) QuantErr: 11.87969 batch_time=0.35574 
Train Epoch: 3 [276/1000 8832/32000 (28%)] Loss: 1.48348 (QuantReg: 11.04948) QuantErr: 11.04948 batch_time=0.44858 
Train Epoch: 3 [281/1000 8992/32000 (28%)] Loss: 2.19358 (QuantReg: 11.45505) QuantErr: 11.45505 batch_time=0.42427 
Train Epoch: 3 [286/1000 9152/32000 (29%)] Loss: 0.96205 (QuantReg: 11.77257) QuantErr: 11.77257 batch_time=0.36549 
Train Epoch: 3 [291/1000 9312/32000 (29%)] Loss: 1.43840 (QuantReg: 12.02667) QuantErr: 12.02667 batch_time=0.34558 
Train Epoch: 3 [296/1000 9472/32000 (30%)] Loss: 2.22830 (QuantReg: 11.56578) QuantErr: 11.56578 batch_time=0.39926 
Train Epoch: 3 [301/1000 9632/32000 (30%)] Loss: 1.22697 (QuantReg: 11.24480) QuantErr: 11.24480 batch_time=0.36414 
Train Epoch: 3 [306/1000 9792/32000 (31%)] Loss: 2.07347 (QuantReg: 11.32107) QuantErr: 11.32107 batch_time=0.47605 
Train Epoch: 3 [311/1000 9952/32000 (31%)] Loss: 2.24139 (QuantReg: 11.07566) QuantErr: 11.07566 batch_time=0.35409 
Train Epoch: 3 [316/1000 10112/32000 (32%)] Loss: 1.27449 (QuantReg: 11.44703) QuantErr: 11.44703 batch_time=1.56472 
Train Epoch: 3 [321/1000 10272/32000 (32%)] Loss: 1.44511 (QuantReg: 11.61863) QuantErr: 11.61863 batch_time=0.78256 
Train Epoch: 3 [326/1000 10432/32000 (33%)] Loss: 0.94205 (QuantReg: 11.96865) QuantErr: 11.96865 batch_time=0.52210 
Train Epoch: 3 [331/1000 10592/32000 (33%)] Loss: 1.50000 (QuantReg: 11.40196) QuantErr: 11.40196 batch_time=0.42830 
Train Epoch: 3 [336/1000 10752/32000 (34%)] Loss: 1.36993 (QuantReg: 11.42255) QuantErr: 11.42255 batch_time=0.37225 
Train Epoch: 3 [341/1000 10912/32000 (34%)] Loss: 1.64238 (QuantReg: 11.54680) QuantErr: 11.54680 batch_time=0.49309 
Train Epoch: 3 [346/1000 11072/32000 (35%)] Loss: 1.85793 (QuantReg: 10.95782) QuantErr: 10.95782 batch_time=0.42963 
Train Epoch: 3 [351/1000 11232/32000 (35%)] Loss: 1.71140 (QuantReg: 11.63886) QuantErr: 11.63886 batch_time=0.40337 
Train Epoch: 3 [356/1000 11392/32000 (36%)] Loss: 1.80159 (QuantReg: 11.46853) QuantErr: 11.46853 batch_time=0.43546 
Train Epoch: 3 [361/1000 11552/32000 (36%)] Loss: 1.83509 (QuantReg: 11.61872) QuantErr: 11.61872 batch_time=0.33757 
Train Epoch: 3 [366/1000 11712/32000 (37%)] Loss: 1.88196 (QuantReg: 11.34135) QuantErr: 11.34135 batch_time=0.50559 
Train Epoch: 3 [371/1000 11872/32000 (37%)] Loss: 1.53633 (QuantReg: 11.45841) QuantErr: 11.45841 batch_time=0.37840 
Train Epoch: 3 [376/1000 12032/32000 (38%)] Loss: 1.28674 (QuantReg: 11.48153) QuantErr: 11.48153 batch_time=0.53941 
Train Epoch: 3 [381/1000 12192/32000 (38%)] Loss: 1.37710 (QuantReg: 11.65997) QuantErr: 11.65997 batch_time=0.35397 
Train Epoch: 3 [386/1000 12352/32000 (39%)] Loss: 1.48827 (QuantReg: 11.50689) QuantErr: 11.50689 batch_time=0.42706 
Train Epoch: 3 [391/1000 12512/32000 (39%)] Loss: 1.34132 (QuantReg: 11.67930) QuantErr: 11.67930 batch_time=0.43045 
Train Epoch: 3 [396/1000 12672/32000 (40%)] Loss: 1.80207 (QuantReg: 11.59703) QuantErr: 11.59703 batch_time=0.42149 
Train Epoch: 3 [401/1000 12832/32000 (40%)] Loss: 1.39585 (QuantReg: 11.28072) QuantErr: 11.28072 batch_time=0.33753 
Train Epoch: 3 [406/1000 12992/32000 (41%)] Loss: 1.42466 (QuantReg: 11.72263) QuantErr: 11.72263 batch_time=0.73848 
Train Epoch: 3 [411/1000 13152/32000 (41%)] Loss: 1.04267 (QuantReg: 11.74057) QuantErr: 11.74057 batch_time=0.47070 
Train Epoch: 3 [416/1000 13312/32000 (42%)] Loss: 2.14514 (QuantReg: 11.28148) QuantErr: 11.28148 batch_time=0.34140 
Train Epoch: 3 [421/1000 13472/32000 (42%)] Loss: 1.37946 (QuantReg: 11.87078) QuantErr: 11.87078 batch_time=0.35010 
Train Epoch: 3 [426/1000 13632/32000 (43%)] Loss: 1.18185 (QuantReg: 12.34575) QuantErr: 12.34575 batch_time=0.39807 
Train Epoch: 3 [431/1000 13792/32000 (43%)] Loss: 1.20077 (QuantReg: 11.36020) QuantErr: 11.36020 batch_time=0.38372 
Train Epoch: 3 [436/1000 13952/32000 (44%)] Loss: 1.78560 (QuantReg: 11.83087) QuantErr: 11.83087 batch_time=0.38473 
Train Epoch: 3 [441/1000 14112/32000 (44%)] Loss: 0.60083 (QuantReg: 11.71072) QuantErr: 11.71072 batch_time=0.36701 
Train Epoch: 3 [446/1000 14272/32000 (45%)] Loss: 1.21399 (QuantReg: 11.66453) QuantErr: 11.66453 batch_time=0.47750 
Train Epoch: 3 [451/1000 14432/32000 (45%)] Loss: 2.18532 (QuantReg: 11.54166) QuantErr: 11.54166 batch_time=0.72656 
Train Epoch: 3 [456/1000 14592/32000 (46%)] Loss: 1.36165 (QuantReg: 11.50474) QuantErr: 11.50474 batch_time=0.42022 
Train Epoch: 3 [461/1000 14752/32000 (46%)] Loss: 1.29843 (QuantReg: 11.28153) QuantErr: 11.28153 batch_time=0.37895 
Train Epoch: 3 [466/1000 14912/32000 (47%)] Loss: 1.00833 (QuantReg: 11.96702) QuantErr: 11.96702 batch_time=0.35784 
Train Epoch: 3 [471/1000 15072/32000 (47%)] Loss: 2.81634 (QuantReg: 11.27346) QuantErr: 11.27346 batch_time=0.35092 
Train Epoch: 3 [476/1000 15232/32000 (48%)] Loss: 1.63921 (QuantReg: 11.65755) QuantErr: 11.65755 batch_time=0.40429 
Train Epoch: 3 [481/1000 15392/32000 (48%)] Loss: 1.88932 (QuantReg: 11.40328) QuantErr: 11.40328 batch_time=0.36020 
Train Epoch: 3 [486/1000 15552/32000 (49%)] Loss: 1.31277 (QuantReg: 11.43731) QuantErr: 11.43731 batch_time=0.40562 
Train Epoch: 3 [491/1000 15712/32000 (49%)] Loss: 1.20386 (QuantReg: 11.04663) QuantErr: 11.04663 batch_time=0.85092 
Train Epoch: 3 [496/1000 15872/32000 (50%)] Loss: 1.81892 (QuantReg: 11.78291) QuantErr: 11.78291 batch_time=0.35109 
Train Epoch: 3 [501/1000 16032/32000 (50%)] Loss: 1.42706 (QuantReg: 12.35044) QuantErr: 12.35044 batch_time=1.67682 
Train Epoch: 3 [506/1000 16192/32000 (51%)] Loss: 1.64785 (QuantReg: 12.25011) QuantErr: 12.25011 batch_time=0.43571 
Train Epoch: 3 [511/1000 16352/32000 (51%)] Loss: 1.46229 (QuantReg: 11.98450) QuantErr: 11.98450 batch_time=0.38886 
Train Epoch: 3 [516/1000 16512/32000 (52%)] Loss: 1.42507 (QuantReg: 11.39944) QuantErr: 11.39944 batch_time=0.35986 
Train Epoch: 3 [521/1000 16672/32000 (52%)] Loss: 0.82867 (QuantReg: 12.09708) QuantErr: 12.09708 batch_time=0.41215 
Train Epoch: 3 [526/1000 16832/32000 (53%)] Loss: 1.28038 (QuantReg: 11.46949) QuantErr: 11.46949 batch_time=1.37835 
Train Epoch: 3 [531/1000 16992/32000 (53%)] Loss: 1.72190 (QuantReg: 11.76110) QuantErr: 11.76110 batch_time=0.35058 
Train Epoch: 3 [536/1000 17152/32000 (54%)] Loss: 0.71940 (QuantReg: 11.62358) QuantErr: 11.62358 batch_time=0.67366 
Train Epoch: 3 [541/1000 17312/32000 (54%)] Loss: 1.36209 (QuantReg: 12.23535) QuantErr: 12.23535 batch_time=0.63076 
Train Epoch: 3 [546/1000 17472/32000 (55%)] Loss: 1.65101 (QuantReg: 11.60070) QuantErr: 11.60070 batch_time=0.44334 
Train Epoch: 3 [551/1000 17632/32000 (55%)] Loss: 1.90384 (QuantReg: 11.54884) QuantErr: 11.54884 batch_time=0.39823 
Train Epoch: 3 [556/1000 17792/32000 (56%)] Loss: 1.16954 (QuantReg: 12.99638) QuantErr: 12.99638 batch_time=0.42119 
Train Epoch: 3 [561/1000 17952/32000 (56%)] Loss: 1.82995 (QuantReg: 11.69664) QuantErr: 11.69664 batch_time=0.37320 
Train Epoch: 3 [566/1000 18112/32000 (57%)] Loss: 1.94385 (QuantReg: 12.07549) QuantErr: 12.07549 batch_time=0.38476 
Train Epoch: 3 [571/1000 18272/32000 (57%)] Loss: 1.78675 (QuantReg: 12.12157) QuantErr: 12.12157 batch_time=0.36115 
Train Epoch: 3 [576/1000 18432/32000 (58%)] Loss: 2.33782 (QuantReg: 12.04669) QuantErr: 12.04669 batch_time=0.37738 
Train Epoch: 3 [581/1000 18592/32000 (58%)] Loss: 1.24460 (QuantReg: 12.30830) QuantErr: 12.30830 batch_time=0.53405 
Train Epoch: 3 [586/1000 18752/32000 (59%)] Loss: 1.72761 (QuantReg: 12.41720) QuantErr: 12.41720 batch_time=0.36897 
Train Epoch: 3 [591/1000 18912/32000 (59%)] Loss: 2.09145 (QuantReg: 11.80935) QuantErr: 11.80935 batch_time=0.37644 
Train Epoch: 3 [596/1000 19072/32000 (60%)] Loss: 2.88348 (QuantReg: 12.23659) QuantErr: 12.23659 batch_time=0.40076 
Train Epoch: 3 [601/1000 19232/32000 (60%)] Loss: 1.48151 (QuantReg: 11.51098) QuantErr: 11.51098 batch_time=0.38033 
Train Epoch: 3 [606/1000 19392/32000 (61%)] Loss: 1.54488 (QuantReg: 11.63786) QuantErr: 11.63786 batch_time=0.40673 
Train Epoch: 3 [611/1000 19552/32000 (61%)] Loss: 1.11331 (QuantReg: 12.22874) QuantErr: 12.22874 batch_time=0.38516 
Train Epoch: 3 [616/1000 19712/32000 (62%)] Loss: 1.05863 (QuantReg: 11.53232) QuantErr: 11.53232 batch_time=0.34672 
Train Epoch: 3 [621/1000 19872/32000 (62%)] Loss: 1.46873 (QuantReg: 12.24482) QuantErr: 12.24482 batch_time=0.45267 
Train Epoch: 3 [626/1000 20032/32000 (63%)] Loss: 1.22140 (QuantReg: 12.14923) QuantErr: 12.14923 batch_time=0.50451 
Train Epoch: 3 [631/1000 20192/32000 (63%)] Loss: 1.43669 (QuantReg: 12.74138) QuantErr: 12.74138 batch_time=0.36232 
Train Epoch: 3 [636/1000 20352/32000 (64%)] Loss: 0.94116 (QuantReg: 11.98417) QuantErr: 11.98417 batch_time=0.57394 
Train Epoch: 3 [641/1000 20512/32000 (64%)] Loss: 1.72964 (QuantReg: 12.26218) QuantErr: 12.26218 batch_time=0.34738 
Train Epoch: 3 [646/1000 20672/32000 (65%)] Loss: 1.85120 (QuantReg: 12.09010) QuantErr: 12.09010 batch_time=0.46309 
Train Epoch: 3 [651/1000 20832/32000 (65%)] Loss: 1.26619 (QuantReg: 11.71565) QuantErr: 11.71565 batch_time=0.36359 
Train Epoch: 3 [656/1000 20992/32000 (66%)] Loss: 2.35611 (QuantReg: 11.76306) QuantErr: 11.76306 batch_time=0.40611 
Train Epoch: 3 [661/1000 21152/32000 (66%)] Loss: 1.75051 (QuantReg: 12.06734) QuantErr: 12.06734 batch_time=0.35480 
Train Epoch: 3 [666/1000 21312/32000 (67%)] Loss: 0.85444 (QuantReg: 12.39315) QuantErr: 12.39315 batch_time=0.65092 
Train Epoch: 3 [671/1000 21472/32000 (67%)] Loss: 1.68822 (QuantReg: 12.37997) QuantErr: 12.37997 batch_time=0.34868 
Train Epoch: 3 [676/1000 21632/32000 (68%)] Loss: 1.14402 (QuantReg: 11.90207) QuantErr: 11.90207 batch_time=0.34600 
Train Epoch: 3 [681/1000 21792/32000 (68%)] Loss: 1.45325 (QuantReg: 12.15363) QuantErr: 12.15363 batch_time=0.39968 
Train Epoch: 3 [686/1000 21952/32000 (69%)] Loss: 1.86194 (QuantReg: 11.80707) QuantErr: 11.80707 batch_time=0.36173 
Train Epoch: 3 [691/1000 22112/32000 (69%)] Loss: 1.12406 (QuantReg: 12.49334) QuantErr: 12.49334 batch_time=0.34189 
Train Epoch: 3 [696/1000 22272/32000 (70%)] Loss: 1.08157 (QuantReg: 11.95287) QuantErr: 11.95287 batch_time=0.44185 
Train Epoch: 3 [701/1000 22432/32000 (70%)] Loss: 1.52505 (QuantReg: 11.41694) QuantErr: 11.41694 batch_time=0.42904 
Train Epoch: 3 [706/1000 22592/32000 (71%)] Loss: 1.96155 (QuantReg: 11.93141) QuantErr: 11.93141 batch_time=0.35374 
Train Epoch: 3 [711/1000 22752/32000 (71%)] Loss: 1.27075 (QuantReg: 11.77600) QuantErr: 11.77600 batch_time=0.51440 
Train Epoch: 3 [716/1000 22912/32000 (72%)] Loss: 1.61465 (QuantReg: 12.46093) QuantErr: 12.46093 batch_time=0.52801 
Train Epoch: 3 [721/1000 23072/32000 (72%)] Loss: 2.83785 (QuantReg: 12.57174) QuantErr: 12.57174 batch_time=0.40124 
Train Epoch: 3 [726/1000 23232/32000 (73%)] Loss: 0.89751 (QuantReg: 11.99353) QuantErr: 11.99353 batch_time=0.41485 
Train Epoch: 3 [731/1000 23392/32000 (73%)] Loss: 2.16230 (QuantReg: 11.33478) QuantErr: 11.33478 batch_time=0.39487 
Train Epoch: 3 [736/1000 23552/32000 (74%)] Loss: 2.65437 (QuantReg: 11.41054) QuantErr: 11.41054 batch_time=0.41341 
Train Epoch: 3 [741/1000 23712/32000 (74%)] Loss: 1.46442 (QuantReg: 11.94650) QuantErr: 11.94650 batch_time=0.36607 
Train Epoch: 3 [746/1000 23872/32000 (75%)] Loss: 1.39291 (QuantReg: 11.50909) QuantErr: 11.50909 batch_time=0.48687 
Train Epoch: 3 [751/1000 24032/32000 (75%)] Loss: 1.69542 (QuantReg: 12.24757) QuantErr: 12.24757 batch_time=0.44206 
Train Epoch: 3 [756/1000 24192/32000 (76%)] Loss: 1.50228 (QuantReg: 11.96070) QuantErr: 11.96070 batch_time=0.55114 
Train Epoch: 3 [761/1000 24352/32000 (76%)] Loss: 0.88147 (QuantReg: 12.49246) QuantErr: 12.49246 batch_time=0.40811 
Train Epoch: 3 [766/1000 24512/32000 (77%)] Loss: 1.74584 (QuantReg: 11.56191) QuantErr: 11.56191 batch_time=0.50808 
Train Epoch: 3 [771/1000 24672/32000 (77%)] Loss: 1.31497 (QuantReg: 12.58382) QuantErr: 12.58382 batch_time=0.55916 
Train Epoch: 3 [776/1000 24832/32000 (78%)] Loss: 1.82764 (QuantReg: 12.05956) QuantErr: 12.05956 batch_time=0.38543 
Train Epoch: 3 [781/1000 24992/32000 (78%)] Loss: 1.28189 (QuantReg: 11.66733) QuantErr: 11.66733 batch_time=0.44117 
Train Epoch: 3 [786/1000 25152/32000 (79%)] Loss: 1.58097 (QuantReg: 11.77061) QuantErr: 11.77061 batch_time=0.47938 
Train Epoch: 3 [791/1000 25312/32000 (79%)] Loss: 1.17916 (QuantReg: 11.50243) QuantErr: 11.50243 batch_time=0.42434 
Train Epoch: 3 [796/1000 25472/32000 (80%)] Loss: 1.25694 (QuantReg: 12.10892) QuantErr: 12.10892 batch_time=0.34344 
Train Epoch: 3 [801/1000 25632/32000 (80%)] Loss: 1.74188 (QuantReg: 11.77542) QuantErr: 11.77542 batch_time=0.33817 
Train Epoch: 3 [806/1000 25792/32000 (81%)] Loss: 0.98603 (QuantReg: 11.74708) QuantErr: 11.74708 batch_time=0.43650 
Train Epoch: 3 [811/1000 25952/32000 (81%)] Loss: 1.78577 (QuantReg: 11.91121) QuantErr: 11.91121 batch_time=0.46087 
Train Epoch: 3 [816/1000 26112/32000 (82%)] Loss: 1.99637 (QuantReg: 11.76443) QuantErr: 11.76443 batch_time=0.37849 
Train Epoch: 3 [821/1000 26272/32000 (82%)] Loss: 1.13839 (QuantReg: 11.91021) QuantErr: 11.91021 batch_time=0.82464 
Train Epoch: 3 [826/1000 26432/32000 (83%)] Loss: 1.43085 (QuantReg: 12.37713) QuantErr: 12.37713 batch_time=0.55767 
Train Epoch: 3 [831/1000 26592/32000 (83%)] Loss: 0.87706 (QuantReg: 13.07067) QuantErr: 13.07067 batch_time=0.33657 
Train Epoch: 3 [836/1000 26752/32000 (84%)] Loss: 1.02935 (QuantReg: 12.76001) QuantErr: 12.76001 batch_time=0.63033 
Train Epoch: 3 [841/1000 26912/32000 (84%)] Loss: 1.90661 (QuantReg: 12.42460) QuantErr: 12.42460 batch_time=0.36189 
Train Epoch: 3 [846/1000 27072/32000 (85%)] Loss: 1.51143 (QuantReg: 12.30341) QuantErr: 12.30341 batch_time=1.19050 
Train Epoch: 3 [851/1000 27232/32000 (85%)] Loss: 1.34280 (QuantReg: 12.78876) QuantErr: 12.78876 batch_time=0.36551 
Train Epoch: 3 [856/1000 27392/32000 (86%)] Loss: 2.22433 (QuantReg: 12.42554) QuantErr: 12.42554 batch_time=0.44856 
Train Epoch: 3 [861/1000 27552/32000 (86%)] Loss: 1.93993 (QuantReg: 12.30620) QuantErr: 12.30620 batch_time=0.36010 
Train Epoch: 3 [866/1000 27712/32000 (87%)] Loss: 1.11947 (QuantReg: 12.19879) QuantErr: 12.19879 batch_time=0.64441 
Train Epoch: 3 [871/1000 27872/32000 (87%)] Loss: 1.68128 (QuantReg: 12.36355) QuantErr: 12.36355 batch_time=0.33903 
Train Epoch: 3 [876/1000 28032/32000 (88%)] Loss: 1.66921 (QuantReg: 12.72236) QuantErr: 12.72236 batch_time=0.41311 
Train Epoch: 3 [881/1000 28192/32000 (88%)] Loss: 0.92194 (QuantReg: 12.27109) QuantErr: 12.27109 batch_time=0.41664 
Train Epoch: 3 [886/1000 28352/32000 (89%)] Loss: 1.11887 (QuantReg: 12.63601) QuantErr: 12.63601 batch_time=0.36759 
Train Epoch: 3 [891/1000 28512/32000 (89%)] Loss: 1.35911 (QuantReg: 12.32966) QuantErr: 12.32966 batch_time=0.35139 
Train Epoch: 3 [896/1000 28672/32000 (90%)] Loss: 1.62100 (QuantReg: 13.04165) QuantErr: 13.04165 batch_time=0.46663 
Train Epoch: 3 [901/1000 28832/32000 (90%)] Loss: 1.93139 (QuantReg: 12.18145) QuantErr: 12.18145 batch_time=0.34809 
Train Epoch: 3 [906/1000 28992/32000 (91%)] Loss: 1.21177 (QuantReg: 11.76045) QuantErr: 11.76045 batch_time=0.38392 
Train Epoch: 3 [911/1000 29152/32000 (91%)] Loss: 1.26694 (QuantReg: 11.92397) QuantErr: 11.92397 batch_time=0.46459 
Train Epoch: 3 [916/1000 29312/32000 (92%)] Loss: 1.38593 (QuantReg: 12.87092) QuantErr: 12.87092 batch_time=0.38271 
Train Epoch: 3 [921/1000 29472/32000 (92%)] Loss: 1.27080 (QuantReg: 12.45714) QuantErr: 12.45714 batch_time=0.60893 
Train Epoch: 3 [926/1000 29632/32000 (93%)] Loss: 1.44889 (QuantReg: 11.81277) QuantErr: 11.81277 batch_time=0.35650 
Train Epoch: 3 [931/1000 29792/32000 (93%)] Loss: 1.06680 (QuantReg: 12.65804) QuantErr: 12.65804 batch_time=0.36447 
Train Epoch: 3 [936/1000 29952/32000 (94%)] Loss: 1.63695 (QuantReg: 11.68249) QuantErr: 11.68249 batch_time=0.42659 
Train Epoch: 3 [941/1000 30112/32000 (94%)] Loss: 1.31010 (QuantReg: 12.14286) QuantErr: 12.14286 batch_time=0.36904 
Train Epoch: 3 [946/1000 30272/32000 (95%)] Loss: 1.03045 (QuantReg: 12.13938) QuantErr: 12.13938 batch_time=0.40642 
Train Epoch: 3 [951/1000 30432/32000 (95%)] Loss: 1.49770 (QuantReg: 12.54763) QuantErr: 12.54763 batch_time=0.39548 
Train Epoch: 3 [956/1000 30592/32000 (96%)] Loss: 0.93869 (QuantReg: 12.61151) QuantErr: 12.61151 batch_time=0.35752 
Train Epoch: 3 [961/1000 30752/32000 (96%)] Loss: 1.52069 (QuantReg: 12.39548) QuantErr: 12.39548 batch_time=0.70618 
Train Epoch: 3 [966/1000 30912/32000 (97%)] Loss: 1.03141 (QuantReg: 12.15734) QuantErr: 12.15734 batch_time=0.38059 
Train Epoch: 3 [971/1000 31072/32000 (97%)] Loss: 1.88460 (QuantReg: 11.86648) QuantErr: 11.86648 batch_time=0.37650 
Train Epoch: 3 [976/1000 31232/32000 (98%)] Loss: 1.67092 (QuantReg: 12.48814) QuantErr: 12.48814 batch_time=0.77780 
Train Epoch: 3 [981/1000 31392/32000 (98%)] Loss: 2.18803 (QuantReg: 12.59044) QuantErr: 12.59044 batch_time=0.35926 
Train Epoch: 3 [986/1000 31552/32000 (99%)] Loss: 1.62614 (QuantReg: 12.12237) QuantErr: 12.12237 batch_time=0.47817 
Train Epoch: 3 [991/1000 31712/32000 (99%)] Loss: 1.12226 (QuantReg: 12.44682) QuantErr: 12.44682 batch_time=0.39029 
Train Epoch: 3 [996/1000 31872/32000 (100%)] Loss: 1.26793 (QuantReg: 12.77113) QuantErr: 12.77113 batch_time=0.37023 
Train Epoch: 3 codebook_update_time=2.25423
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch3.pth ...
Done in 4.803s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch3.pth ...
Done in 10.661s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 1.5312401720285416
 quant_reg      : 11.751139369010925
 quant_err      : 11.751139369010925
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 3000
 MSRVTT_miech_test/t2v_metrics/R1: 14.1
 MSRVTT_miech_test/t2v_metrics/R5: 37.9
 MSRVTT_miech_test/t2v_metrics/R10: 50.2
 MSRVTT_miech_test/t2v_metrics/R50: 84.5
 MSRVTT_miech_test/t2v_metrics/MedR: 10.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.213
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.9355572256361
 MSRVTT_miech_test/v2t_metrics/R1: 13.5
 MSRVTT_miech_test/v2t_metrics/R5: 39.6
 MSRVTT_miech_test/v2t_metrics/R10: 52.8
 MSRVTT_miech_test/v2t_metrics/R50: 82.9
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 35.614
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.447686009213722
 mnt_best       : 29.9355572256361
 not_improved_count: 0
Train Epoch: 4 [1/1000 32/32000 (0%)] Loss: 1.65318 (QuantReg: 11.17893) QuantErr: 11.17893 batch_time=26.59248 
Train Epoch: 4 [6/1000 192/32000 (1%)] Loss: 0.73878 (QuantReg: 11.23460) QuantErr: 11.23460 batch_time=0.53445 
Train Epoch: 4 [11/1000 352/32000 (1%)] Loss: 1.02412 (QuantReg: 11.79020) QuantErr: 11.79020 batch_time=0.36991 
Train Epoch: 4 [16/1000 512/32000 (2%)] Loss: 0.73223 (QuantReg: 11.48347) QuantErr: 11.48347 batch_time=1.18494 
Train Epoch: 4 [21/1000 672/32000 (2%)] Loss: 1.17472 (QuantReg: 11.90264) QuantErr: 11.90264 batch_time=0.34364 
Train Epoch: 4 [26/1000 832/32000 (3%)] Loss: 2.34117 (QuantReg: 11.75649) QuantErr: 11.75649 batch_time=0.66375 
Train Epoch: 4 [31/1000 992/32000 (3%)] Loss: 1.43080 (QuantReg: 12.19635) QuantErr: 12.19635 batch_time=0.40487 
Train Epoch: 4 [36/1000 1152/32000 (4%)] Loss: 1.70965 (QuantReg: 11.53288) QuantErr: 11.53288 batch_time=0.34746 
Train Epoch: 4 [41/1000 1312/32000 (4%)] Loss: 1.10469 (QuantReg: 11.06191) QuantErr: 11.06191 batch_time=0.33681 
Train Epoch: 4 [46/1000 1472/32000 (5%)] Loss: 2.34457 (QuantReg: 11.56159) QuantErr: 11.56159 batch_time=0.42457 
Train Epoch: 4 [51/1000 1632/32000 (5%)] Loss: 0.85695 (QuantReg: 11.03079) QuantErr: 11.03079 batch_time=0.47979 
Train Epoch: 4 [56/1000 1792/32000 (6%)] Loss: 1.29037 (QuantReg: 11.45011) QuantErr: 11.45011 batch_time=0.47978 
Train Epoch: 4 [61/1000 1952/32000 (6%)] Loss: 1.23480 (QuantReg: 10.68292) QuantErr: 10.68292 batch_time=0.39701 
Train Epoch: 4 [66/1000 2112/32000 (7%)] Loss: 1.24135 (QuantReg: 11.33821) QuantErr: 11.33821 batch_time=0.67780 
Train Epoch: 4 [71/1000 2272/32000 (7%)] Loss: 0.99740 (QuantReg: 10.84340) QuantErr: 10.84340 batch_time=0.37506 
Train Epoch: 4 [76/1000 2432/32000 (8%)] Loss: 1.84098 (QuantReg: 11.25938) QuantErr: 11.25938 batch_time=0.32443 
Train Epoch: 4 [81/1000 2592/32000 (8%)] Loss: 1.58198 (QuantReg: 11.33836) QuantErr: 11.33836 batch_time=0.34996 
Train Epoch: 4 [86/1000 2752/32000 (9%)] Loss: 1.54276 (QuantReg: 11.13452) QuantErr: 11.13452 batch_time=0.38941 
Train Epoch: 4 [91/1000 2912/32000 (9%)] Loss: 0.84390 (QuantReg: 11.61974) QuantErr: 11.61974 batch_time=0.38174 
Train Epoch: 4 [96/1000 3072/32000 (10%)] Loss: 1.76014 (QuantReg: 11.78525) QuantErr: 11.78525 batch_time=0.34219 
Train Epoch: 4 [101/1000 3232/32000 (10%)] Loss: 1.22105 (QuantReg: 11.38552) QuantErr: 11.38552 batch_time=0.36758 
Train Epoch: 4 [106/1000 3392/32000 (11%)] Loss: 1.44622 (QuantReg: 10.84422) QuantErr: 10.84422 batch_time=0.42249 
Train Epoch: 4 [111/1000 3552/32000 (11%)] Loss: 1.18786 (QuantReg: 11.18433) QuantErr: 11.18433 batch_time=0.49864 
Train Epoch: 4 [116/1000 3712/32000 (12%)] Loss: 1.30261 (QuantReg: 11.37851) QuantErr: 11.37851 batch_time=0.55528 
Train Epoch: 4 [121/1000 3872/32000 (12%)] Loss: 1.00885 (QuantReg: 11.31661) QuantErr: 11.31661 batch_time=0.38847 
Train Epoch: 4 [126/1000 4032/32000 (13%)] Loss: 1.34945 (QuantReg: 11.45847) QuantErr: 11.45847 batch_time=0.34716 
Train Epoch: 4 [131/1000 4192/32000 (13%)] Loss: 1.54666 (QuantReg: 11.04034) QuantErr: 11.04034 batch_time=0.38326 
Train Epoch: 4 [136/1000 4352/32000 (14%)] Loss: 1.84556 (QuantReg: 11.01299) QuantErr: 11.01299 batch_time=0.36198 
Train Epoch: 4 [141/1000 4512/32000 (14%)] Loss: 1.37267 (QuantReg: 11.54177) QuantErr: 11.54177 batch_time=0.39257 
Train Epoch: 4 [146/1000 4672/32000 (15%)] Loss: 2.12984 (QuantReg: 11.70219) QuantErr: 11.70219 batch_time=0.37623 
Train Epoch: 4 [151/1000 4832/32000 (15%)] Loss: 1.18184 (QuantReg: 11.15221) QuantErr: 11.15221 batch_time=0.33398 
Train Epoch: 4 [156/1000 4992/32000 (16%)] Loss: 0.93183 (QuantReg: 11.21714) QuantErr: 11.21714 batch_time=0.60570 
Train Epoch: 4 [161/1000 5152/32000 (16%)] Loss: 1.13925 (QuantReg: 11.25489) QuantErr: 11.25489 batch_time=0.37298 
Train Epoch: 4 [166/1000 5312/32000 (17%)] Loss: 1.64415 (QuantReg: 11.99129) QuantErr: 11.99129 batch_time=0.38049 
Train Epoch: 4 [171/1000 5472/32000 (17%)] Loss: 2.00810 (QuantReg: 10.90625) QuantErr: 10.90625 batch_time=0.33246 
Train Epoch: 4 [176/1000 5632/32000 (18%)] Loss: 1.33199 (QuantReg: 11.44292) QuantErr: 11.44292 batch_time=0.34298 
Train Epoch: 4 [181/1000 5792/32000 (18%)] Loss: 1.03768 (QuantReg: 10.72331) QuantErr: 10.72331 batch_time=0.38682 
Train Epoch: 4 [186/1000 5952/32000 (19%)] Loss: 1.30806 (QuantReg: 11.39051) QuantErr: 11.39051 batch_time=0.36217 
Train Epoch: 4 [191/1000 6112/32000 (19%)] Loss: 1.39132 (QuantReg: 10.83119) QuantErr: 10.83119 batch_time=0.36740 
Train Epoch: 4 [196/1000 6272/32000 (20%)] Loss: 1.07434 (QuantReg: 11.02241) QuantErr: 11.02241 batch_time=0.62397 
Train Epoch: 4 [201/1000 6432/32000 (20%)] Loss: 1.74777 (QuantReg: 11.18157) QuantErr: 11.18157 batch_time=0.64449 
Train Epoch: 4 [206/1000 6592/32000 (21%)] Loss: 1.64900 (QuantReg: 11.46941) QuantErr: 11.46941 batch_time=0.34720 
Train Epoch: 4 [211/1000 6752/32000 (21%)] Loss: 1.71253 (QuantReg: 11.38815) QuantErr: 11.38815 batch_time=0.50572 
Train Epoch: 4 [216/1000 6912/32000 (22%)] Loss: 1.24258 (QuantReg: 11.38055) QuantErr: 11.38055 batch_time=0.44469 
Train Epoch: 4 [221/1000 7072/32000 (22%)] Loss: 2.23457 (QuantReg: 11.98204) QuantErr: 11.98204 batch_time=0.37829 
Train Epoch: 4 [226/1000 7232/32000 (23%)] Loss: 1.40275 (QuantReg: 11.33568) QuantErr: 11.33568 batch_time=0.40426 
Train Epoch: 4 [231/1000 7392/32000 (23%)] Loss: 1.53392 (QuantReg: 11.39424) QuantErr: 11.39424 batch_time=0.34469 
Train Epoch: 4 [236/1000 7552/32000 (24%)] Loss: 1.29768 (QuantReg: 12.48632) QuantErr: 12.48632 batch_time=0.34458 
Train Epoch: 4 [241/1000 7712/32000 (24%)] Loss: 0.76529 (QuantReg: 11.23263) QuantErr: 11.23263 batch_time=0.62999 
Train Epoch: 4 [246/1000 7872/32000 (25%)] Loss: 1.13844 (QuantReg: 11.92913) QuantErr: 11.92913 batch_time=0.37211 
Train Epoch: 4 [251/1000 8032/32000 (25%)] Loss: 1.44217 (QuantReg: 11.40308) QuantErr: 11.40308 batch_time=0.35114 
Train Epoch: 4 [256/1000 8192/32000 (26%)] Loss: 1.31042 (QuantReg: 11.07076) QuantErr: 11.07076 batch_time=0.39083 
Train Epoch: 4 [261/1000 8352/32000 (26%)] Loss: 0.71254 (QuantReg: 11.56552) QuantErr: 11.56552 batch_time=0.37497 
Train Epoch: 4 [266/1000 8512/32000 (27%)] Loss: 0.86209 (QuantReg: 11.58619) QuantErr: 11.58619 batch_time=0.43628 
Train Epoch: 4 [271/1000 8672/32000 (27%)] Loss: 1.20489 (QuantReg: 11.04160) QuantErr: 11.04160 batch_time=0.45250 
Train Epoch: 4 [276/1000 8832/32000 (28%)] Loss: 1.29590 (QuantReg: 11.93261) QuantErr: 11.93261 batch_time=0.38055 
Train Epoch: 4 [281/1000 8992/32000 (28%)] Loss: 1.12944 (QuantReg: 11.12762) QuantErr: 11.12762 batch_time=0.33478 
Train Epoch: 4 [286/1000 9152/32000 (29%)] Loss: 1.29174 (QuantReg: 12.02545) QuantErr: 12.02545 batch_time=0.64888 
Train Epoch: 4 [291/1000 9312/32000 (29%)] Loss: 2.14870 (QuantReg: 11.02255) QuantErr: 11.02255 batch_time=0.34257 
Train Epoch: 4 [296/1000 9472/32000 (30%)] Loss: 1.51802 (QuantReg: 11.54478) QuantErr: 11.54478 batch_time=0.40735 
Train Epoch: 4 [301/1000 9632/32000 (30%)] Loss: 1.54117 (QuantReg: 11.69758) QuantErr: 11.69758 batch_time=1.68281 
Train Epoch: 4 [306/1000 9792/32000 (31%)] Loss: 1.47223 (QuantReg: 11.26167) QuantErr: 11.26167 batch_time=0.33140 
Train Epoch: 4 [311/1000 9952/32000 (31%)] Loss: 0.80517 (QuantReg: 11.21905) QuantErr: 11.21905 batch_time=0.33342 
Train Epoch: 4 [316/1000 10112/32000 (32%)] Loss: 1.54076 (QuantReg: 11.41996) QuantErr: 11.41996 batch_time=0.33016 
Train Epoch: 4 [321/1000 10272/32000 (32%)] Loss: 1.36991 (QuantReg: 11.27306) QuantErr: 11.27306 batch_time=1.05899 
Train Epoch: 4 [326/1000 10432/32000 (33%)] Loss: 0.80781 (QuantReg: 11.91679) QuantErr: 11.91679 batch_time=0.76056 
Train Epoch: 4 [331/1000 10592/32000 (33%)] Loss: 1.61985 (QuantReg: 10.78806) QuantErr: 10.78806 batch_time=0.37812 
Train Epoch: 4 [336/1000 10752/32000 (34%)] Loss: 0.99665 (QuantReg: 11.53772) QuantErr: 11.53772 batch_time=0.61582 
Train Epoch: 4 [341/1000 10912/32000 (34%)] Loss: 1.56806 (QuantReg: 11.32958) QuantErr: 11.32958 batch_time=0.42767 
Train Epoch: 4 [346/1000 11072/32000 (35%)] Loss: 1.02545 (QuantReg: 11.74056) QuantErr: 11.74056 batch_time=0.35766 
Train Epoch: 4 [351/1000 11232/32000 (35%)] Loss: 1.11927 (QuantReg: 11.21532) QuantErr: 11.21532 batch_time=0.37846 
Train Epoch: 4 [356/1000 11392/32000 (36%)] Loss: 1.65169 (QuantReg: 11.43853) QuantErr: 11.43853 batch_time=0.33825 
Train Epoch: 4 [361/1000 11552/32000 (36%)] Loss: 1.51500 (QuantReg: 11.50878) QuantErr: 11.50878 batch_time=0.40560 
Train Epoch: 4 [366/1000 11712/32000 (37%)] Loss: 0.86454 (QuantReg: 11.79998) QuantErr: 11.79998 batch_time=0.49302 
Train Epoch: 4 [371/1000 11872/32000 (37%)] Loss: 0.75763 (QuantReg: 11.36192) QuantErr: 11.36192 batch_time=0.35044 
Train Epoch: 4 [376/1000 12032/32000 (38%)] Loss: 1.43844 (QuantReg: 12.04270) QuantErr: 12.04270 batch_time=0.35964 
Train Epoch: 4 [381/1000 12192/32000 (38%)] Loss: 1.60243 (QuantReg: 12.14223) QuantErr: 12.14223 batch_time=0.48565 
Train Epoch: 4 [386/1000 12352/32000 (39%)] Loss: 1.15470 (QuantReg: 11.80158) QuantErr: 11.80158 batch_time=0.37626 
Train Epoch: 4 [391/1000 12512/32000 (39%)] Loss: 1.41860 (QuantReg: 12.06941) QuantErr: 12.06941 batch_time=0.42804 
Train Epoch: 4 [396/1000 12672/32000 (40%)] Loss: 1.52684 (QuantReg: 11.13936) QuantErr: 11.13936 batch_time=0.36610 
Train Epoch: 4 [401/1000 12832/32000 (40%)] Loss: 1.27676 (QuantReg: 11.75918) QuantErr: 11.75918 batch_time=0.43875 
Train Epoch: 4 [406/1000 12992/32000 (41%)] Loss: 0.83475 (QuantReg: 11.63015) QuantErr: 11.63015 batch_time=0.35429 
Train Epoch: 4 [411/1000 13152/32000 (41%)] Loss: 1.76967 (QuantReg: 11.50230) QuantErr: 11.50230 batch_time=0.37583 
Train Epoch: 4 [416/1000 13312/32000 (42%)] Loss: 0.84336 (QuantReg: 11.66714) QuantErr: 11.66714 batch_time=0.54936 
Train Epoch: 4 [421/1000 13472/32000 (42%)] Loss: 1.53853 (QuantReg: 12.12615) QuantErr: 12.12615 batch_time=0.40423 
Train Epoch: 4 [426/1000 13632/32000 (43%)] Loss: 1.38037 (QuantReg: 11.73606) QuantErr: 11.73606 batch_time=0.34032 
Train Epoch: 4 [431/1000 13792/32000 (43%)] Loss: 1.19565 (QuantReg: 12.39437) QuantErr: 12.39437 batch_time=0.40829 
Train Epoch: 4 [436/1000 13952/32000 (44%)] Loss: 1.05827 (QuantReg: 11.72606) QuantErr: 11.72606 batch_time=0.40392 
Train Epoch: 4 [441/1000 14112/32000 (44%)] Loss: 1.24255 (QuantReg: 11.75913) QuantErr: 11.75913 batch_time=0.78039 
Train Epoch: 4 [446/1000 14272/32000 (45%)] Loss: 1.42021 (QuantReg: 11.97616) QuantErr: 11.97616 batch_time=0.52066 
Train Epoch: 4 [451/1000 14432/32000 (45%)] Loss: 1.73447 (QuantReg: 11.61422) QuantErr: 11.61422 batch_time=0.33993 
Train Epoch: 4 [456/1000 14592/32000 (46%)] Loss: 1.45118 (QuantReg: 11.89359) QuantErr: 11.89359 batch_time=0.60416 
Train Epoch: 4 [461/1000 14752/32000 (46%)] Loss: 0.91377 (QuantReg: 11.53880) QuantErr: 11.53880 batch_time=0.36482 
Train Epoch: 4 [466/1000 14912/32000 (47%)] Loss: 1.61449 (QuantReg: 11.96225) QuantErr: 11.96225 batch_time=0.35210 
Train Epoch: 4 [471/1000 15072/32000 (47%)] Loss: 1.61973 (QuantReg: 11.67493) QuantErr: 11.67493 batch_time=0.35947 
Train Epoch: 4 [476/1000 15232/32000 (48%)] Loss: 1.12830 (QuantReg: 12.28200) QuantErr: 12.28200 batch_time=0.42747 
Train Epoch: 4 [481/1000 15392/32000 (48%)] Loss: 1.60457 (QuantReg: 11.64584) QuantErr: 11.64584 batch_time=0.42610 
Train Epoch: 4 [486/1000 15552/32000 (49%)] Loss: 1.01260 (QuantReg: 10.39744) QuantErr: 10.39744 batch_time=0.35922 
Train Epoch: 4 [491/1000 15712/32000 (49%)] Loss: 1.75785 (QuantReg: 11.45158) QuantErr: 11.45158 batch_time=0.65006 
Train Epoch: 4 [496/1000 15872/32000 (50%)] Loss: 1.23028 (QuantReg: 11.89788) QuantErr: 11.89788 batch_time=0.44435 
Train Epoch: 4 [501/1000 16032/32000 (50%)] Loss: 1.95833 (QuantReg: 11.73075) QuantErr: 11.73075 batch_time=0.34596 
Train Epoch: 4 [506/1000 16192/32000 (51%)] Loss: 1.12138 (QuantReg: 11.99133) QuantErr: 11.99133 batch_time=0.40083 
Train Epoch: 4 [511/1000 16352/32000 (51%)] Loss: 1.48773 (QuantReg: 11.52949) QuantErr: 11.52949 batch_time=0.43277 
Train Epoch: 4 [516/1000 16512/32000 (52%)] Loss: 1.23829 (QuantReg: 11.42136) QuantErr: 11.42136 batch_time=0.37114 
Train Epoch: 4 [521/1000 16672/32000 (52%)] Loss: 1.68286 (QuantReg: 11.92148) QuantErr: 11.92148 batch_time=0.37290 
Train Epoch: 4 [526/1000 16832/32000 (53%)] Loss: 1.81359 (QuantReg: 11.23769) QuantErr: 11.23769 batch_time=0.66201 
Train Epoch: 4 [531/1000 16992/32000 (53%)] Loss: 1.37662 (QuantReg: 12.00883) QuantErr: 12.00883 batch_time=0.42556 
Train Epoch: 4 [536/1000 17152/32000 (54%)] Loss: 1.83328 (QuantReg: 11.35361) QuantErr: 11.35361 batch_time=0.37314 
Train Epoch: 4 [541/1000 17312/32000 (54%)] Loss: 1.13649 (QuantReg: 11.61177) QuantErr: 11.61177 batch_time=0.81482 
Train Epoch: 4 [546/1000 17472/32000 (55%)] Loss: 1.93858 (QuantReg: 11.97554) QuantErr: 11.97554 batch_time=0.62272 
Train Epoch: 4 [551/1000 17632/32000 (55%)] Loss: 1.32180 (QuantReg: 11.86785) QuantErr: 11.86785 batch_time=0.37802 
Train Epoch: 4 [556/1000 17792/32000 (56%)] Loss: 0.70364 (QuantReg: 12.19277) QuantErr: 12.19277 batch_time=0.44039 
Train Epoch: 4 [561/1000 17952/32000 (56%)] Loss: 1.36946 (QuantReg: 11.22710) QuantErr: 11.22710 batch_time=0.39748 
Train Epoch: 4 [566/1000 18112/32000 (57%)] Loss: 0.91097 (QuantReg: 12.13641) QuantErr: 12.13641 batch_time=0.37643 
Train Epoch: 4 [571/1000 18272/32000 (57%)] Loss: 0.93005 (QuantReg: 11.98044) QuantErr: 11.98044 batch_time=0.40352 
Train Epoch: 4 [576/1000 18432/32000 (58%)] Loss: 1.34888 (QuantReg: 11.63768) QuantErr: 11.63768 batch_time=0.41990 
Train Epoch: 4 [581/1000 18592/32000 (58%)] Loss: 1.11538 (QuantReg: 11.47931) QuantErr: 11.47931 batch_time=0.41222 
Train Epoch: 4 [586/1000 18752/32000 (59%)] Loss: 1.13653 (QuantReg: 12.07412) QuantErr: 12.07412 batch_time=0.46599 
Train Epoch: 4 [591/1000 18912/32000 (59%)] Loss: 2.67658 (QuantReg: 11.65181) QuantErr: 11.65181 batch_time=0.37862 
Train Epoch: 4 [596/1000 19072/32000 (60%)] Loss: 1.65967 (QuantReg: 11.72929) QuantErr: 11.72929 batch_time=0.47226 
Train Epoch: 4 [601/1000 19232/32000 (60%)] Loss: 1.66525 (QuantReg: 12.31796) QuantErr: 12.31796 batch_time=0.34094 
Train Epoch: 4 [606/1000 19392/32000 (61%)] Loss: 0.67208 (QuantReg: 12.41112) QuantErr: 12.41112 batch_time=0.43770 
Train Epoch: 4 [611/1000 19552/32000 (61%)] Loss: 1.33273 (QuantReg: 11.96527) QuantErr: 11.96527 batch_time=0.39799 
Train Epoch: 4 [616/1000 19712/32000 (62%)] Loss: 1.52228 (QuantReg: 12.18421) QuantErr: 12.18421 batch_time=0.47235 
Train Epoch: 4 [621/1000 19872/32000 (62%)] Loss: 1.47654 (QuantReg: 11.84548) QuantErr: 11.84548 batch_time=1.60435 
Train Epoch: 4 [626/1000 20032/32000 (63%)] Loss: 1.18913 (QuantReg: 11.87557) QuantErr: 11.87557 batch_time=0.42113 
Train Epoch: 4 [631/1000 20192/32000 (63%)] Loss: 0.88460 (QuantReg: 11.71390) QuantErr: 11.71390 batch_time=0.59875 
Train Epoch: 4 [636/1000 20352/32000 (64%)] Loss: 1.10615 (QuantReg: 11.43173) QuantErr: 11.43173 batch_time=0.36112 
Train Epoch: 4 [641/1000 20512/32000 (64%)] Loss: 1.42792 (QuantReg: 12.06735) QuantErr: 12.06735 batch_time=0.63811 
Train Epoch: 4 [646/1000 20672/32000 (65%)] Loss: 0.76721 (QuantReg: 11.81996) QuantErr: 11.81996 batch_time=0.37607 
Train Epoch: 4 [651/1000 20832/32000 (65%)] Loss: 1.44411 (QuantReg: 11.96619) QuantErr: 11.96619 batch_time=0.38170 
Train Epoch: 4 [656/1000 20992/32000 (66%)] Loss: 1.98072 (QuantReg: 12.11228) QuantErr: 12.11228 batch_time=0.42824 
Train Epoch: 4 [661/1000 21152/32000 (66%)] Loss: 0.67618 (QuantReg: 11.31215) QuantErr: 11.31215 batch_time=0.38200 
Train Epoch: 4 [666/1000 21312/32000 (67%)] Loss: 1.18469 (QuantReg: 12.86355) QuantErr: 12.86355 batch_time=0.36558 
Train Epoch: 4 [671/1000 21472/32000 (67%)] Loss: 0.69331 (QuantReg: 11.91582) QuantErr: 11.91582 batch_time=0.84603 
Train Epoch: 4 [676/1000 21632/32000 (68%)] Loss: 0.99029 (QuantReg: 11.63902) QuantErr: 11.63902 batch_time=0.43196 
Train Epoch: 4 [681/1000 21792/32000 (68%)] Loss: 1.19151 (QuantReg: 11.88877) QuantErr: 11.88877 batch_time=0.34299 
Train Epoch: 4 [686/1000 21952/32000 (69%)] Loss: 1.26912 (QuantReg: 11.64048) QuantErr: 11.64048 batch_time=0.33358 
Train Epoch: 4 [691/1000 22112/32000 (69%)] Loss: 1.67654 (QuantReg: 11.97742) QuantErr: 11.97742 batch_time=0.45223 
Train Epoch: 4 [696/1000 22272/32000 (70%)] Loss: 1.91619 (QuantReg: 11.60610) QuantErr: 11.60610 batch_time=0.39691 
Train Epoch: 4 [701/1000 22432/32000 (70%)] Loss: 0.91287 (QuantReg: 12.01358) QuantErr: 12.01358 batch_time=0.37750 
Train Epoch: 4 [706/1000 22592/32000 (71%)] Loss: 1.24423 (QuantReg: 11.73944) QuantErr: 11.73944 batch_time=0.35130 
Train Epoch: 4 [711/1000 22752/32000 (71%)] Loss: 0.86643 (QuantReg: 11.73508) QuantErr: 11.73508 batch_time=0.62121 
Train Epoch: 4 [716/1000 22912/32000 (72%)] Loss: 1.20884 (QuantReg: 11.60910) QuantErr: 11.60910 batch_time=0.34096 
Train Epoch: 4 [721/1000 23072/32000 (72%)] Loss: 1.12514 (QuantReg: 12.63619) QuantErr: 12.63619 batch_time=0.34415 
Train Epoch: 4 [726/1000 23232/32000 (73%)] Loss: 2.17917 (QuantReg: 12.32166) QuantErr: 12.32166 batch_time=0.38792 
Train Epoch: 4 [731/1000 23392/32000 (73%)] Loss: 1.58372 (QuantReg: 11.64611) QuantErr: 11.64611 batch_time=0.35775 
Train Epoch: 4 [736/1000 23552/32000 (74%)] Loss: 1.11269 (QuantReg: 12.16174) QuantErr: 12.16174 batch_time=0.42804 
Train Epoch: 4 [741/1000 23712/32000 (74%)] Loss: 1.96242 (QuantReg: 11.98784) QuantErr: 11.98784 batch_time=0.35028 
Train Epoch: 4 [746/1000 23872/32000 (75%)] Loss: 0.70719 (QuantReg: 12.01798) QuantErr: 12.01798 batch_time=0.41056 
Train Epoch: 4 [751/1000 24032/32000 (75%)] Loss: 1.06276 (QuantReg: 11.91404) QuantErr: 11.91404 batch_time=0.35576 
Train Epoch: 4 [756/1000 24192/32000 (76%)] Loss: 1.22434 (QuantReg: 12.10358) QuantErr: 12.10358 batch_time=0.79807 
Train Epoch: 4 [761/1000 24352/32000 (76%)] Loss: 1.15729 (QuantReg: 12.57853) QuantErr: 12.57853 batch_time=0.79948 
Train Epoch: 4 [766/1000 24512/32000 (77%)] Loss: 0.82201 (QuantReg: 12.40867) QuantErr: 12.40867 batch_time=0.56805 
Train Epoch: 4 [771/1000 24672/32000 (77%)] Loss: 1.14399 (QuantReg: 12.25108) QuantErr: 12.25108 batch_time=0.43260 
Train Epoch: 4 [776/1000 24832/32000 (78%)] Loss: 1.70929 (QuantReg: 12.20758) QuantErr: 12.20758 batch_time=0.37578 
Train Epoch: 4 [781/1000 24992/32000 (78%)] Loss: 0.66593 (QuantReg: 12.46158) QuantErr: 12.46158 batch_time=0.36400 
Train Epoch: 4 [786/1000 25152/32000 (79%)] Loss: 0.76116 (QuantReg: 12.50816) QuantErr: 12.50816 batch_time=0.34966 
Train Epoch: 4 [791/1000 25312/32000 (79%)] Loss: 2.28563 (QuantReg: 12.40337) QuantErr: 12.40337 batch_time=0.61954 
Train Epoch: 4 [796/1000 25472/32000 (80%)] Loss: 0.89538 (QuantReg: 12.26143) QuantErr: 12.26143 batch_time=0.37456 
Train Epoch: 4 [801/1000 25632/32000 (80%)] Loss: 0.85246 (QuantReg: 12.15880) QuantErr: 12.15880 batch_time=0.72070 
Train Epoch: 4 [806/1000 25792/32000 (81%)] Loss: 1.51386 (QuantReg: 12.14890) QuantErr: 12.14890 batch_time=0.47647 
Train Epoch: 4 [811/1000 25952/32000 (81%)] Loss: 1.53360 (QuantReg: 11.85990) QuantErr: 11.85990 batch_time=0.51717 
Train Epoch: 4 [816/1000 26112/32000 (82%)] Loss: 1.45257 (QuantReg: 12.14595) QuantErr: 12.14595 batch_time=0.40520 
Train Epoch: 4 [821/1000 26272/32000 (82%)] Loss: 0.96169 (QuantReg: 11.35978) QuantErr: 11.35978 batch_time=0.37039 
Train Epoch: 4 [826/1000 26432/32000 (83%)] Loss: 1.46623 (QuantReg: 12.21727) QuantErr: 12.21727 batch_time=0.38373 
Train Epoch: 4 [831/1000 26592/32000 (83%)] Loss: 1.08352 (QuantReg: 11.54115) QuantErr: 11.54115 batch_time=0.37053 
Train Epoch: 4 [836/1000 26752/32000 (84%)] Loss: 1.16002 (QuantReg: 11.73069) QuantErr: 11.73069 batch_time=0.41287 
Train Epoch: 4 [841/1000 26912/32000 (84%)] Loss: 1.43475 (QuantReg: 11.66901) QuantErr: 11.66901 batch_time=0.67282 
Train Epoch: 4 [846/1000 27072/32000 (85%)] Loss: 1.24897 (QuantReg: 12.10434) QuantErr: 12.10434 batch_time=0.55469 
Train Epoch: 4 [851/1000 27232/32000 (85%)] Loss: 1.44249 (QuantReg: 11.91154) QuantErr: 11.91154 batch_time=0.36438 
Train Epoch: 4 [856/1000 27392/32000 (86%)] Loss: 1.50823 (QuantReg: 11.93254) QuantErr: 11.93254 batch_time=0.36110 
Train Epoch: 4 [861/1000 27552/32000 (86%)] Loss: 2.04770 (QuantReg: 12.43212) QuantErr: 12.43212 batch_time=0.37614 
Train Epoch: 4 [866/1000 27712/32000 (87%)] Loss: 0.77093 (QuantReg: 12.64306) QuantErr: 12.64306 batch_time=0.39081 
Train Epoch: 4 [871/1000 27872/32000 (87%)] Loss: 1.28269 (QuantReg: 13.22158) QuantErr: 13.22158 batch_time=0.35713 
Train Epoch: 4 [876/1000 28032/32000 (88%)] Loss: 0.72615 (QuantReg: 12.30780) QuantErr: 12.30780 batch_time=0.46935 
Train Epoch: 4 [881/1000 28192/32000 (88%)] Loss: 1.01171 (QuantReg: 12.80032) QuantErr: 12.80032 batch_time=0.40733 
Train Epoch: 4 [886/1000 28352/32000 (89%)] Loss: 1.20837 (QuantReg: 12.48124) QuantErr: 12.48124 batch_time=0.43684 
Train Epoch: 4 [891/1000 28512/32000 (89%)] Loss: 1.69450 (QuantReg: 11.78365) QuantErr: 11.78365 batch_time=0.35666 
Train Epoch: 4 [896/1000 28672/32000 (90%)] Loss: 0.91759 (QuantReg: 12.29906) QuantErr: 12.29906 batch_time=0.40263 
Train Epoch: 4 [901/1000 28832/32000 (90%)] Loss: 1.12551 (QuantReg: 12.22771) QuantErr: 12.22771 batch_time=0.35736 
Train Epoch: 4 [906/1000 28992/32000 (91%)] Loss: 0.69301 (QuantReg: 12.21552) QuantErr: 12.21552 batch_time=0.41823 
Train Epoch: 4 [911/1000 29152/32000 (91%)] Loss: 1.06213 (QuantReg: 12.05299) QuantErr: 12.05299 batch_time=0.39650 
Train Epoch: 4 [916/1000 29312/32000 (92%)] Loss: 1.50328 (QuantReg: 12.10387) QuantErr: 12.10387 batch_time=0.42802 
Train Epoch: 4 [921/1000 29472/32000 (92%)] Loss: 1.08410 (QuantReg: 11.98663) QuantErr: 11.98663 batch_time=0.48349 
Train Epoch: 4 [926/1000 29632/32000 (93%)] Loss: 1.50316 (QuantReg: 12.47517) QuantErr: 12.47517 batch_time=0.60158 
Train Epoch: 4 [931/1000 29792/32000 (93%)] Loss: 1.18443 (QuantReg: 12.17274) QuantErr: 12.17274 batch_time=0.51675 
Train Epoch: 4 [936/1000 29952/32000 (94%)] Loss: 1.78528 (QuantReg: 11.86261) QuantErr: 11.86261 batch_time=0.34990 
Train Epoch: 4 [941/1000 30112/32000 (94%)] Loss: 1.30517 (QuantReg: 12.34696) QuantErr: 12.34696 batch_time=1.28589 
Train Epoch: 4 [946/1000 30272/32000 (95%)] Loss: 0.58090 (QuantReg: 12.30437) QuantErr: 12.30437 batch_time=0.36059 
Train Epoch: 4 [951/1000 30432/32000 (95%)] Loss: 1.45455 (QuantReg: 12.25440) QuantErr: 12.25440 batch_time=0.36110 
Train Epoch: 4 [956/1000 30592/32000 (96%)] Loss: 1.07514 (QuantReg: 12.12768) QuantErr: 12.12768 batch_time=0.35465 
Train Epoch: 4 [961/1000 30752/32000 (96%)] Loss: 1.24152 (QuantReg: 12.21675) QuantErr: 12.21675 batch_time=0.68139 
Train Epoch: 4 [966/1000 30912/32000 (97%)] Loss: 1.72168 (QuantReg: 12.07365) QuantErr: 12.07365 batch_time=0.76444 
Train Epoch: 4 [971/1000 31072/32000 (97%)] Loss: 1.53030 (QuantReg: 12.41013) QuantErr: 12.41013 batch_time=0.73459 
Train Epoch: 4 [976/1000 31232/32000 (98%)] Loss: 0.77426 (QuantReg: 12.76360) QuantErr: 12.76360 batch_time=0.33786 
Train Epoch: 4 [981/1000 31392/32000 (98%)] Loss: 1.76958 (QuantReg: 12.35569) QuantErr: 12.35569 batch_time=0.54697 
Train Epoch: 4 [986/1000 31552/32000 (99%)] Loss: 0.93722 (QuantReg: 12.75125) QuantErr: 12.75125 batch_time=0.40880 
Train Epoch: 4 [991/1000 31712/32000 (99%)] Loss: 1.25802 (QuantReg: 12.12893) QuantErr: 12.12893 batch_time=0.44614 
Train Epoch: 4 [996/1000 31872/32000 (100%)] Loss: 0.80152 (QuantReg: 12.56394) QuantErr: 12.56394 batch_time=0.36200 
Train Epoch: 4 codebook_update_time=2.39571
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch4.pth ...
Done in 4.669s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch4.pth ...
Done in 9.407s
removing stale ckpt [epoch 3] [took 0.74s]
 epoch          : 4
 loss           : 1.3162344987392425
 quant_reg      : 11.734564792633057
 quant_err      : 11.734564792633057
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 4000
 MSRVTT_miech_test/t2v_metrics/R1: 12.8
 MSRVTT_miech_test/t2v_metrics/R5: 39.3
 MSRVTT_miech_test/t2v_metrics/R10: 53.6
 MSRVTT_miech_test/t2v_metrics/R50: 84.0
 MSRVTT_miech_test/t2v_metrics/MedR: 9.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 37.287
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.986269272084687
 MSRVTT_miech_test/v2t_metrics/R1: 13.1
 MSRVTT_miech_test/v2t_metrics/R5: 39.7
 MSRVTT_miech_test/v2t_metrics/R10: 52.8
 MSRVTT_miech_test/v2t_metrics/R50: 84.1
 MSRVTT_miech_test/v2t_metrics/MedR: 9.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 34.979
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.169300557885723
 mnt_best       : 29.986269272084687
 not_improved_count: 0
Train Epoch: 5 [1/1000 32/32000 (0%)] Loss: 1.64667 (QuantReg: 11.00535) QuantErr: 11.00535 batch_time=28.77737 
Train Epoch: 5 [6/1000 192/32000 (1%)] Loss: 1.35676 (QuantReg: 12.25067) QuantErr: 12.25067 batch_time=0.45116 
Train Epoch: 5 [11/1000 352/32000 (1%)] Loss: 0.81344 (QuantReg: 11.52728) QuantErr: 11.52728 batch_time=0.41735 
Train Epoch: 5 [16/1000 512/32000 (2%)] Loss: 1.00408 (QuantReg: 11.87248) QuantErr: 11.87248 batch_time=0.39829 
Train Epoch: 5 [21/1000 672/32000 (2%)] Loss: 1.11592 (QuantReg: 11.44914) QuantErr: 11.44914 batch_time=0.42126 
Train Epoch: 5 [26/1000 832/32000 (3%)] Loss: 1.21891 (QuantReg: 11.02276) QuantErr: 11.02276 batch_time=0.45308 
Train Epoch: 5 [31/1000 992/32000 (3%)] Loss: 0.90596 (QuantReg: 11.31913) QuantErr: 11.31913 batch_time=0.56788 
Train Epoch: 5 [36/1000 1152/32000 (4%)] Loss: 1.02852 (QuantReg: 10.96543) QuantErr: 10.96543 batch_time=0.35295 
Train Epoch: 5 [41/1000 1312/32000 (4%)] Loss: 1.03950 (QuantReg: 11.42809) QuantErr: 11.42809 batch_time=0.51176 
Train Epoch: 5 [46/1000 1472/32000 (5%)] Loss: 1.14068 (QuantReg: 12.07041) QuantErr: 12.07041 batch_time=0.33928 
Train Epoch: 5 [51/1000 1632/32000 (5%)] Loss: 1.46894 (QuantReg: 11.20701) QuantErr: 11.20701 batch_time=0.36117 
Train Epoch: 5 [56/1000 1792/32000 (6%)] Loss: 1.19692 (QuantReg: 10.80373) QuantErr: 10.80373 batch_time=0.42938 
Train Epoch: 5 [61/1000 1952/32000 (6%)] Loss: 1.86962 (QuantReg: 11.23977) QuantErr: 11.23977 batch_time=0.60128 
Train Epoch: 5 [66/1000 2112/32000 (7%)] Loss: 1.93854 (QuantReg: 11.58538) QuantErr: 11.58538 batch_time=0.47956 
Train Epoch: 5 [71/1000 2272/32000 (7%)] Loss: 2.22279 (QuantReg: 11.33004) QuantErr: 11.33004 batch_time=0.53143 
Train Epoch: 5 [76/1000 2432/32000 (8%)] Loss: 0.84276 (QuantReg: 10.89319) QuantErr: 10.89319 batch_time=0.34995 
Train Epoch: 5 [81/1000 2592/32000 (8%)] Loss: 1.65097 (QuantReg: 11.32676) QuantErr: 11.32676 batch_time=0.42322 
Train Epoch: 5 [86/1000 2752/32000 (9%)] Loss: 1.63730 (QuantReg: 11.82308) QuantErr: 11.82308 batch_time=0.41617 
Train Epoch: 5 [91/1000 2912/32000 (9%)] Loss: 1.29814 (QuantReg: 10.91387) QuantErr: 10.91387 batch_time=0.43779 
Train Epoch: 5 [96/1000 3072/32000 (10%)] Loss: 0.92071 (QuantReg: 11.51695) QuantErr: 11.51695 batch_time=0.38630 
Train Epoch: 5 [101/1000 3232/32000 (10%)] Loss: 1.33716 (QuantReg: 10.93738) QuantErr: 10.93738 batch_time=0.39645 
Train Epoch: 5 [106/1000 3392/32000 (11%)] Loss: 1.06558 (QuantReg: 11.35309) QuantErr: 11.35309 batch_time=0.39344 
Train Epoch: 5 [111/1000 3552/32000 (11%)] Loss: 0.94488 (QuantReg: 11.27324) QuantErr: 11.27324 batch_time=0.52708 
Train Epoch: 5 [116/1000 3712/32000 (12%)] Loss: 0.67620 (QuantReg: 10.96495) QuantErr: 10.96495 batch_time=0.43663 
Train Epoch: 5 [121/1000 3872/32000 (12%)] Loss: 0.58520 (QuantReg: 11.98368) QuantErr: 11.98368 batch_time=0.38809 
Train Epoch: 5 [126/1000 4032/32000 (13%)] Loss: 1.63253 (QuantReg: 11.14492) QuantErr: 11.14492 batch_time=0.41009 
Train Epoch: 5 [131/1000 4192/32000 (13%)] Loss: 1.28634 (QuantReg: 11.68869) QuantErr: 11.68869 batch_time=0.36180 
Train Epoch: 5 [136/1000 4352/32000 (14%)] Loss: 0.97389 (QuantReg: 11.27964) QuantErr: 11.27964 batch_time=0.39414 
Train Epoch: 5 [141/1000 4512/32000 (14%)] Loss: 0.91885 (QuantReg: 11.39699) QuantErr: 11.39699 batch_time=0.39059 
Train Epoch: 5 [146/1000 4672/32000 (15%)] Loss: 0.88734 (QuantReg: 11.75399) QuantErr: 11.75399 batch_time=0.49853 
Train Epoch: 5 [151/1000 4832/32000 (15%)] Loss: 0.73345 (QuantReg: 11.52081) QuantErr: 11.52081 batch_time=0.48932 
Train Epoch: 5 [156/1000 4992/32000 (16%)] Loss: 1.28509 (QuantReg: 11.77079) QuantErr: 11.77079 batch_time=0.34979 
Train Epoch: 5 [161/1000 5152/32000 (16%)] Loss: 1.53614 (QuantReg: 11.58026) QuantErr: 11.58026 batch_time=0.37100 
Train Epoch: 5 [166/1000 5312/32000 (17%)] Loss: 1.66441 (QuantReg: 12.26334) QuantErr: 12.26334 batch_time=0.52590 
Train Epoch: 5 [171/1000 5472/32000 (17%)] Loss: 1.30583 (QuantReg: 11.68514) QuantErr: 11.68514 batch_time=0.46843 
Train Epoch: 5 [176/1000 5632/32000 (18%)] Loss: 0.79749 (QuantReg: 11.96904) QuantErr: 11.96904 batch_time=0.36664 
Train Epoch: 5 [181/1000 5792/32000 (18%)] Loss: 1.67158 (QuantReg: 11.67461) QuantErr: 11.67461 batch_time=0.40776 
Train Epoch: 5 [186/1000 5952/32000 (19%)] Loss: 0.81549 (QuantReg: 11.21008) QuantErr: 11.21008 batch_time=0.36007 
Train Epoch: 5 [191/1000 6112/32000 (19%)] Loss: 1.41996 (QuantReg: 11.93090) QuantErr: 11.93090 batch_time=0.38810 
Train Epoch: 5 [196/1000 6272/32000 (20%)] Loss: 0.91758 (QuantReg: 11.94421) QuantErr: 11.94421 batch_time=0.39933 
Train Epoch: 5 [201/1000 6432/32000 (20%)] Loss: 0.79546 (QuantReg: 11.78459) QuantErr: 11.78459 batch_time=0.61863 
Train Epoch: 5 [206/1000 6592/32000 (21%)] Loss: 2.66233 (QuantReg: 11.76854) QuantErr: 11.76854 batch_time=0.34701 
Train Epoch: 5 [211/1000 6752/32000 (21%)] Loss: 1.62669 (QuantReg: 11.67804) QuantErr: 11.67804 batch_time=0.49602 
Train Epoch: 5 [216/1000 6912/32000 (22%)] Loss: 0.83647 (QuantReg: 10.73545) QuantErr: 10.73545 batch_time=0.37014 
Train Epoch: 5 [221/1000 7072/32000 (22%)] Loss: 1.17705 (QuantReg: 12.23797) QuantErr: 12.23797 batch_time=0.69283 
Train Epoch: 5 [226/1000 7232/32000 (23%)] Loss: 0.68768 (QuantReg: 11.85485) QuantErr: 11.85485 batch_time=0.43657 
Train Epoch: 5 [231/1000 7392/32000 (23%)] Loss: 1.59268 (QuantReg: 12.24508) QuantErr: 12.24508 batch_time=0.41409 
Train Epoch: 5 [236/1000 7552/32000 (24%)] Loss: 0.77880 (QuantReg: 11.73894) QuantErr: 11.73894 batch_time=0.34190 
Train Epoch: 5 [241/1000 7712/32000 (24%)] Loss: 1.00648 (QuantReg: 11.20596) QuantErr: 11.20596 batch_time=0.36372 
Train Epoch: 5 [246/1000 7872/32000 (25%)] Loss: 1.73685 (QuantReg: 11.87992) QuantErr: 11.87992 batch_time=0.66330 
Train Epoch: 5 [251/1000 8032/32000 (25%)] Loss: 1.78519 (QuantReg: 10.74860) QuantErr: 10.74860 batch_time=0.64148 
Train Epoch: 5 [256/1000 8192/32000 (26%)] Loss: 0.53256 (QuantReg: 11.97182) QuantErr: 11.97182 batch_time=0.36437 
Train Epoch: 5 [261/1000 8352/32000 (26%)] Loss: 1.11263 (QuantReg: 11.58327) QuantErr: 11.58327 batch_time=0.33607 
Train Epoch: 5 [266/1000 8512/32000 (27%)] Loss: 1.16581 (QuantReg: 11.59736) QuantErr: 11.59736 batch_time=0.45184 
Train Epoch: 5 [271/1000 8672/32000 (27%)] Loss: 1.07207 (QuantReg: 12.18837) QuantErr: 12.18837 batch_time=0.35182 
Train Epoch: 5 [276/1000 8832/32000 (28%)] Loss: 1.78196 (QuantReg: 11.93861) QuantErr: 11.93861 batch_time=0.40441 
Train Epoch: 5 [281/1000 8992/32000 (28%)] Loss: 1.36321 (QuantReg: 12.08040) QuantErr: 12.08040 batch_time=0.35475 
Train Epoch: 5 [286/1000 9152/32000 (29%)] Loss: 1.09664 (QuantReg: 11.81198) QuantErr: 11.81198 batch_time=0.36143 
Train Epoch: 5 [291/1000 9312/32000 (29%)] Loss: 0.92281 (QuantReg: 12.63368) QuantErr: 12.63368 batch_time=0.73702 
Train Epoch: 5 [296/1000 9472/32000 (30%)] Loss: 1.19264 (QuantReg: 11.81110) QuantErr: 11.81110 batch_time=0.38515 
Train Epoch: 5 [301/1000 9632/32000 (30%)] Loss: 2.39866 (QuantReg: 11.21648) QuantErr: 11.21648 batch_time=0.34951 
Train Epoch: 5 [306/1000 9792/32000 (31%)] Loss: 1.73879 (QuantReg: 11.74955) QuantErr: 11.74955 batch_time=0.36962 
Train Epoch: 5 [311/1000 9952/32000 (31%)] Loss: 1.20626 (QuantReg: 11.95947) QuantErr: 11.95947 batch_time=0.39475 
Train Epoch: 5 [316/1000 10112/32000 (32%)] Loss: 1.26156 (QuantReg: 11.28653) QuantErr: 11.28653 batch_time=0.35905 
Train Epoch: 5 [321/1000 10272/32000 (32%)] Loss: 0.52832 (QuantReg: 11.37002) QuantErr: 11.37002 batch_time=0.41139 
Train Epoch: 5 [326/1000 10432/32000 (33%)] Loss: 1.70587 (QuantReg: 12.13791) QuantErr: 12.13791 batch_time=0.38610 
Train Epoch: 5 [331/1000 10592/32000 (33%)] Loss: 0.79088 (QuantReg: 11.59648) QuantErr: 11.59648 batch_time=0.68106 
Train Epoch: 5 [336/1000 10752/32000 (34%)] Loss: 1.12326 (QuantReg: 11.37545) QuantErr: 11.37545 batch_time=0.34386 
Train Epoch: 5 [341/1000 10912/32000 (34%)] Loss: 1.33389 (QuantReg: 11.48223) QuantErr: 11.48223 batch_time=0.53842 
Train Epoch: 5 [346/1000 11072/32000 (35%)] Loss: 1.10684 (QuantReg: 11.64890) QuantErr: 11.64890 batch_time=0.39590 
Train Epoch: 5 [351/1000 11232/32000 (35%)] Loss: 2.30302 (QuantReg: 11.92385) QuantErr: 11.92385 batch_time=0.43084 
Train Epoch: 5 [356/1000 11392/32000 (36%)] Loss: 0.59868 (QuantReg: 11.91685) QuantErr: 11.91685 batch_time=0.47407 
Train Epoch: 5 [361/1000 11552/32000 (36%)] Loss: 0.57116 (QuantReg: 11.72860) QuantErr: 11.72860 batch_time=0.36924 
Train Epoch: 5 [366/1000 11712/32000 (37%)] Loss: 0.70484 (QuantReg: 12.05695) QuantErr: 12.05695 batch_time=0.75756 
Train Epoch: 5 [371/1000 11872/32000 (37%)] Loss: 1.48364 (QuantReg: 11.43145) QuantErr: 11.43145 batch_time=0.33102 
Train Epoch: 5 [376/1000 12032/32000 (38%)] Loss: 1.95587 (QuantReg: 12.03469) QuantErr: 12.03469 batch_time=0.54226 
Train Epoch: 5 [381/1000 12192/32000 (38%)] Loss: 0.70776 (QuantReg: 11.95855) QuantErr: 11.95855 batch_time=0.39735 
Train Epoch: 5 [386/1000 12352/32000 (39%)] Loss: 0.91961 (QuantReg: 11.92809) QuantErr: 11.92809 batch_time=0.38512 
Train Epoch: 5 [391/1000 12512/32000 (39%)] Loss: 1.51763 (QuantReg: 11.25095) QuantErr: 11.25095 batch_time=1.32305 
Train Epoch: 5 [396/1000 12672/32000 (40%)] Loss: 1.64850 (QuantReg: 11.68042) QuantErr: 11.68042 batch_time=0.42791 
Train Epoch: 5 [401/1000 12832/32000 (40%)] Loss: 1.22493 (QuantReg: 10.72059) QuantErr: 10.72059 batch_time=0.37880 
Train Epoch: 5 [406/1000 12992/32000 (41%)] Loss: 1.60843 (QuantReg: 11.82706) QuantErr: 11.82706 batch_time=0.46104 
Train Epoch: 5 [411/1000 13152/32000 (41%)] Loss: 1.19660 (QuantReg: 12.30892) QuantErr: 12.30892 batch_time=0.33715 
Train Epoch: 5 [416/1000 13312/32000 (42%)] Loss: 1.01175 (QuantReg: 11.58678) QuantErr: 11.58678 batch_time=0.80623 
Train Epoch: 5 [421/1000 13472/32000 (42%)] Loss: 1.15067 (QuantReg: 11.42368) QuantErr: 11.42368 batch_time=0.38195 
Train Epoch: 5 [426/1000 13632/32000 (43%)] Loss: 1.47869 (QuantReg: 12.22506) QuantErr: 12.22506 batch_time=0.34544 
Train Epoch: 5 [431/1000 13792/32000 (43%)] Loss: 0.71324 (QuantReg: 11.39760) QuantErr: 11.39760 batch_time=0.35640 
Train Epoch: 5 [436/1000 13952/32000 (44%)] Loss: 2.02396 (QuantReg: 11.31248) QuantErr: 11.31248 batch_time=0.35496 
Train Epoch: 5 [441/1000 14112/32000 (44%)] Loss: 1.05776 (QuantReg: 11.87777) QuantErr: 11.87777 batch_time=0.42059 
Train Epoch: 5 [446/1000 14272/32000 (45%)] Loss: 1.40677 (QuantReg: 12.04971) QuantErr: 12.04971 batch_time=0.42204 
Train Epoch: 5 [451/1000 14432/32000 (45%)] Loss: 0.99645 (QuantReg: 11.54298) QuantErr: 11.54298 batch_time=0.41173 
Train Epoch: 5 [456/1000 14592/32000 (46%)] Loss: 1.12839 (QuantReg: 12.08054) QuantErr: 12.08054 batch_time=0.38620 
Train Epoch: 5 [461/1000 14752/32000 (46%)] Loss: 1.36256 (QuantReg: 11.74142) QuantErr: 11.74142 batch_time=0.49507 
Train Epoch: 5 [466/1000 14912/32000 (47%)] Loss: 1.41918 (QuantReg: 11.67443) QuantErr: 11.67443 batch_time=0.33715 
Train Epoch: 5 [471/1000 15072/32000 (47%)] Loss: 1.25480 (QuantReg: 12.52495) QuantErr: 12.52495 batch_time=0.63735 
Train Epoch: 5 [476/1000 15232/32000 (48%)] Loss: 1.15793 (QuantReg: 11.90311) QuantErr: 11.90311 batch_time=0.36976 
Train Epoch: 5 [481/1000 15392/32000 (48%)] Loss: 1.18722 (QuantReg: 11.44229) QuantErr: 11.44229 batch_time=0.39883 
Train Epoch: 5 [486/1000 15552/32000 (49%)] Loss: 1.18034 (QuantReg: 12.20473) QuantErr: 12.20473 batch_time=0.42437 
Train Epoch: 5 [491/1000 15712/32000 (49%)] Loss: 1.50688 (QuantReg: 11.65358) QuantErr: 11.65358 batch_time=0.36051 
Train Epoch: 5 [496/1000 15872/32000 (50%)] Loss: 1.18043 (QuantReg: 11.99603) QuantErr: 11.99603 batch_time=0.52733 
Train Epoch: 5 [501/1000 16032/32000 (50%)] Loss: 0.52140 (QuantReg: 11.79371) QuantErr: 11.79371 batch_time=0.35276 
Train Epoch: 5 [506/1000 16192/32000 (51%)] Loss: 1.36823 (QuantReg: 12.19211) QuantErr: 12.19211 batch_time=0.69937 
Train Epoch: 5 [511/1000 16352/32000 (51%)] Loss: 1.23450 (QuantReg: 11.47814) QuantErr: 11.47814 batch_time=0.34739 
Train Epoch: 5 [516/1000 16512/32000 (52%)] Loss: 0.98848 (QuantReg: 12.13449) QuantErr: 12.13449 batch_time=0.37830 
Train Epoch: 5 [521/1000 16672/32000 (52%)] Loss: 1.45710 (QuantReg: 11.93162) QuantErr: 11.93162 batch_time=0.36581 
Train Epoch: 5 [526/1000 16832/32000 (53%)] Loss: 0.81656 (QuantReg: 11.91633) QuantErr: 11.91633 batch_time=0.36654 
Train Epoch: 5 [531/1000 16992/32000 (53%)] Loss: 1.43812 (QuantReg: 11.96415) QuantErr: 11.96415 batch_time=0.36625 
Train Epoch: 5 [536/1000 17152/32000 (54%)] Loss: 1.41476 (QuantReg: 11.53772) QuantErr: 11.53772 batch_time=0.37028 
Train Epoch: 5 [541/1000 17312/32000 (54%)] Loss: 0.98189 (QuantReg: 12.03722) QuantErr: 12.03722 batch_time=0.52619 
Train Epoch: 5 [546/1000 17472/32000 (55%)] Loss: 1.25710 (QuantReg: 12.00779) QuantErr: 12.00779 batch_time=0.34989 
Train Epoch: 5 [551/1000 17632/32000 (55%)] Loss: 0.63131 (QuantReg: 11.28352) QuantErr: 11.28352 batch_time=0.48787 
Train Epoch: 5 [556/1000 17792/32000 (56%)] Loss: 0.60693 (QuantReg: 11.77313) QuantErr: 11.77313 batch_time=0.35882 
Train Epoch: 5 [561/1000 17952/32000 (56%)] Loss: 1.07905 (QuantReg: 12.22711) QuantErr: 12.22711 batch_time=0.38960 
Train Epoch: 5 [566/1000 18112/32000 (57%)] Loss: 1.32469 (QuantReg: 11.14304) QuantErr: 11.14304 batch_time=0.38579 
Train Epoch: 5 [571/1000 18272/32000 (57%)] Loss: 1.25545 (QuantReg: 11.80879) QuantErr: 11.80879 batch_time=0.33869 
Train Epoch: 5 [576/1000 18432/32000 (58%)] Loss: 1.13083 (QuantReg: 11.74300) QuantErr: 11.74300 batch_time=0.43979 
Train Epoch: 5 [581/1000 18592/32000 (58%)] Loss: 0.94768 (QuantReg: 11.72096) QuantErr: 11.72096 batch_time=0.34960 
Train Epoch: 5 [586/1000 18752/32000 (59%)] Loss: 1.25673 (QuantReg: 12.01200) QuantErr: 12.01200 batch_time=0.57498 
Train Epoch: 5 [591/1000 18912/32000 (59%)] Loss: 0.88339 (QuantReg: 11.85704) QuantErr: 11.85704 batch_time=0.89951 
Train Epoch: 5 [596/1000 19072/32000 (60%)] Loss: 1.11433 (QuantReg: 11.21034) QuantErr: 11.21034 batch_time=0.45563 
Train Epoch: 5 [601/1000 19232/32000 (60%)] Loss: 1.51944 (QuantReg: 12.31987) QuantErr: 12.31987 batch_time=0.33436 
Train Epoch: 5 [606/1000 19392/32000 (61%)] Loss: 0.49703 (QuantReg: 11.79347) QuantErr: 11.79347 batch_time=0.41926 
Train Epoch: 5 [611/1000 19552/32000 (61%)] Loss: 0.61718 (QuantReg: 12.00264) QuantErr: 12.00264 batch_time=0.39186 
Train Epoch: 5 [616/1000 19712/32000 (62%)] Loss: 0.78521 (QuantReg: 11.87205) QuantErr: 11.87205 batch_time=0.43724 
Train Epoch: 5 [621/1000 19872/32000 (62%)] Loss: 0.87434 (QuantReg: 11.87449) QuantErr: 11.87449 batch_time=0.36362 
Train Epoch: 5 [626/1000 20032/32000 (63%)] Loss: 0.81375 (QuantReg: 11.64774) QuantErr: 11.64774 batch_time=0.44836 
Train Epoch: 5 [631/1000 20192/32000 (63%)] Loss: 0.98466 (QuantReg: 11.67951) QuantErr: 11.67951 batch_time=0.36788 
Train Epoch: 5 [636/1000 20352/32000 (64%)] Loss: 0.88199 (QuantReg: 11.75064) QuantErr: 11.75064 batch_time=0.41733 
Train Epoch: 5 [641/1000 20512/32000 (64%)] Loss: 1.20473 (QuantReg: 11.69611) QuantErr: 11.69611 batch_time=0.45456 
Train Epoch: 5 [646/1000 20672/32000 (65%)] Loss: 0.89316 (QuantReg: 12.23336) QuantErr: 12.23336 batch_time=0.34692 
Train Epoch: 5 [651/1000 20832/32000 (65%)] Loss: 0.71353 (QuantReg: 11.86558) QuantErr: 11.86558 batch_time=0.37909 
Train Epoch: 5 [656/1000 20992/32000 (66%)] Loss: 0.87219 (QuantReg: 12.07132) QuantErr: 12.07132 batch_time=0.35512 
Train Epoch: 5 [661/1000 21152/32000 (66%)] Loss: 0.44570 (QuantReg: 12.06044) QuantErr: 12.06044 batch_time=0.36361 
Train Epoch: 5 [666/1000 21312/32000 (67%)] Loss: 1.13791 (QuantReg: 12.28052) QuantErr: 12.28052 batch_time=0.38388 
Train Epoch: 5 [671/1000 21472/32000 (67%)] Loss: 0.78770 (QuantReg: 11.22844) QuantErr: 11.22844 batch_time=0.44837 
Train Epoch: 5 [676/1000 21632/32000 (68%)] Loss: 0.98657 (QuantReg: 12.36412) QuantErr: 12.36412 batch_time=0.43219 
Train Epoch: 5 [681/1000 21792/32000 (68%)] Loss: 0.61283 (QuantReg: 12.08555) QuantErr: 12.08555 batch_time=0.34797 
Train Epoch: 5 [686/1000 21952/32000 (69%)] Loss: 1.63991 (QuantReg: 11.96752) QuantErr: 11.96752 batch_time=0.38475 
Train Epoch: 5 [691/1000 22112/32000 (69%)] Loss: 0.45274 (QuantReg: 12.22754) QuantErr: 12.22754 batch_time=0.46387 
Train Epoch: 5 [696/1000 22272/32000 (70%)] Loss: 1.62267 (QuantReg: 12.65339) QuantErr: 12.65339 batch_time=0.39012 
Train Epoch: 5 [701/1000 22432/32000 (70%)] Loss: 1.64249 (QuantReg: 12.04132) QuantErr: 12.04132 batch_time=0.57707 
Train Epoch: 5 [706/1000 22592/32000 (71%)] Loss: 1.28989 (QuantReg: 12.30393) QuantErr: 12.30393 batch_time=0.35303 
Train Epoch: 5 [711/1000 22752/32000 (71%)] Loss: 0.50424 (QuantReg: 12.00991) QuantErr: 12.00991 batch_time=2.05996 
Train Epoch: 5 [716/1000 22912/32000 (72%)] Loss: 0.74474 (QuantReg: 11.94223) QuantErr: 11.94223 batch_time=0.35962 
Train Epoch: 5 [721/1000 23072/32000 (72%)] Loss: 0.95218 (QuantReg: 11.74780) QuantErr: 11.74780 batch_time=0.41821 
Train Epoch: 5 [726/1000 23232/32000 (73%)] Loss: 1.22874 (QuantReg: 12.46148) QuantErr: 12.46148 batch_time=0.34877 
Train Epoch: 5 [731/1000 23392/32000 (73%)] Loss: 1.48859 (QuantReg: 11.58719) QuantErr: 11.58719 batch_time=0.53221 
Train Epoch: 5 [736/1000 23552/32000 (74%)] Loss: 1.58127 (QuantReg: 11.27022) QuantErr: 11.27022 batch_time=0.36997 
Train Epoch: 5 [741/1000 23712/32000 (74%)] Loss: 1.52229 (QuantReg: 11.59142) QuantErr: 11.59142 batch_time=0.44579 
Train Epoch: 5 [746/1000 23872/32000 (75%)] Loss: 1.13376 (QuantReg: 12.33531) QuantErr: 12.33531 batch_time=0.42058 
Train Epoch: 5 [751/1000 24032/32000 (75%)] Loss: 1.04489 (QuantReg: 11.88516) QuantErr: 11.88516 batch_time=0.37946 
Train Epoch: 5 [756/1000 24192/32000 (76%)] Loss: 1.42633 (QuantReg: 11.69687) QuantErr: 11.69687 batch_time=0.44150 
Train Epoch: 5 [761/1000 24352/32000 (76%)] Loss: 0.92478 (QuantReg: 11.82066) QuantErr: 11.82066 batch_time=0.34246 
Train Epoch: 5 [766/1000 24512/32000 (77%)] Loss: 1.19919 (QuantReg: 12.22974) QuantErr: 12.22974 batch_time=0.43184 
Train Epoch: 5 [771/1000 24672/32000 (77%)] Loss: 1.00670 (QuantReg: 12.79660) QuantErr: 12.79660 batch_time=0.43583 
Train Epoch: 5 [776/1000 24832/32000 (78%)] Loss: 0.73625 (QuantReg: 12.29811) QuantErr: 12.29811 batch_time=0.36252 
Train Epoch: 5 [781/1000 24992/32000 (78%)] Loss: 1.28184 (QuantReg: 12.05170) QuantErr: 12.05170 batch_time=0.54277 
Train Epoch: 5 [786/1000 25152/32000 (79%)] Loss: 1.83207 (QuantReg: 12.34907) QuantErr: 12.34907 batch_time=0.59601 
Train Epoch: 5 [791/1000 25312/32000 (79%)] Loss: 0.93231 (QuantReg: 12.49102) QuantErr: 12.49102 batch_time=0.36276 
Train Epoch: 5 [796/1000 25472/32000 (80%)] Loss: 1.18423 (QuantReg: 12.27514) QuantErr: 12.27514 batch_time=0.35907 
Train Epoch: 5 [801/1000 25632/32000 (80%)] Loss: 0.73768 (QuantReg: 12.10720) QuantErr: 12.10720 batch_time=0.34722 
Train Epoch: 5 [806/1000 25792/32000 (81%)] Loss: 1.29818 (QuantReg: 12.64489) QuantErr: 12.64489 batch_time=0.35214 
Train Epoch: 5 [811/1000 25952/32000 (81%)] Loss: 0.76276 (QuantReg: 12.50037) QuantErr: 12.50037 batch_time=0.36681 
Train Epoch: 5 [816/1000 26112/32000 (82%)] Loss: 1.25754 (QuantReg: 11.99137) QuantErr: 11.99137 batch_time=0.62882 
Train Epoch: 5 [821/1000 26272/32000 (82%)] Loss: 1.20395 (QuantReg: 11.73607) QuantErr: 11.73607 batch_time=0.33504 
Train Epoch: 5 [826/1000 26432/32000 (83%)] Loss: 1.05612 (QuantReg: 11.65714) QuantErr: 11.65714 batch_time=0.63234 
Train Epoch: 5 [831/1000 26592/32000 (83%)] Loss: 1.52745 (QuantReg: 12.56016) QuantErr: 12.56016 batch_time=0.39011 
Train Epoch: 5 [836/1000 26752/32000 (84%)] Loss: 0.61107 (QuantReg: 11.86234) QuantErr: 11.86234 batch_time=0.35375 
Train Epoch: 5 [841/1000 26912/32000 (84%)] Loss: 0.79073 (QuantReg: 11.96631) QuantErr: 11.96631 batch_time=0.42066 
Train Epoch: 5 [846/1000 27072/32000 (85%)] Loss: 1.40260 (QuantReg: 12.13720) QuantErr: 12.13720 batch_time=0.39529 
Train Epoch: 5 [851/1000 27232/32000 (85%)] Loss: 0.67514 (QuantReg: 12.62129) QuantErr: 12.62129 batch_time=0.35224 
Train Epoch: 5 [856/1000 27392/32000 (86%)] Loss: 0.84747 (QuantReg: 11.93343) QuantErr: 11.93343 batch_time=0.57630 
Train Epoch: 5 [861/1000 27552/32000 (86%)] Loss: 1.01502 (QuantReg: 11.91863) QuantErr: 11.91863 batch_time=0.64482 
Train Epoch: 5 [866/1000 27712/32000 (87%)] Loss: 1.49387 (QuantReg: 12.09020) QuantErr: 12.09020 batch_time=0.44829 
Train Epoch: 5 [871/1000 27872/32000 (87%)] Loss: 1.11093 (QuantReg: 12.86916) QuantErr: 12.86916 batch_time=0.63065 
Train Epoch: 5 [876/1000 28032/32000 (88%)] Loss: 1.35755 (QuantReg: 12.38947) QuantErr: 12.38947 batch_time=0.38967 
Train Epoch: 5 [881/1000 28192/32000 (88%)] Loss: 1.09101 (QuantReg: 12.43491) QuantErr: 12.43491 batch_time=0.37874 
Train Epoch: 5 [886/1000 28352/32000 (89%)] Loss: 1.18329 (QuantReg: 12.23289) QuantErr: 12.23289 batch_time=0.33899 
Train Epoch: 5 [891/1000 28512/32000 (89%)] Loss: 1.27315 (QuantReg: 12.24540) QuantErr: 12.24540 batch_time=0.43923 
Train Epoch: 5 [896/1000 28672/32000 (90%)] Loss: 0.69009 (QuantReg: 12.70494) QuantErr: 12.70494 batch_time=0.37585 
Train Epoch: 5 [901/1000 28832/32000 (90%)] Loss: 1.34159 (QuantReg: 12.18129) QuantErr: 12.18129 batch_time=0.37683 
Train Epoch: 5 [906/1000 28992/32000 (91%)] Loss: 0.76257 (QuantReg: 12.48072) QuantErr: 12.48072 batch_time=0.34967 
Train Epoch: 5 [911/1000 29152/32000 (91%)] Loss: 1.61258 (QuantReg: 12.08920) QuantErr: 12.08920 batch_time=1.39429 
Train Epoch: 5 [916/1000 29312/32000 (92%)] Loss: 1.09075 (QuantReg: 11.80952) QuantErr: 11.80952 batch_time=0.45546 
Train Epoch: 5 [921/1000 29472/32000 (92%)] Loss: 1.69935 (QuantReg: 12.04782) QuantErr: 12.04782 batch_time=0.33420 
Train Epoch: 5 [926/1000 29632/32000 (93%)] Loss: 1.86869 (QuantReg: 11.76295) QuantErr: 11.76295 batch_time=0.35433 
Train Epoch: 5 [931/1000 29792/32000 (93%)] Loss: 1.80776 (QuantReg: 11.87408) QuantErr: 11.87408 batch_time=0.40928 
Train Epoch: 5 [936/1000 29952/32000 (94%)] Loss: 0.86694 (QuantReg: 12.09986) QuantErr: 12.09986 batch_time=0.42397 
Train Epoch: 5 [941/1000 30112/32000 (94%)] Loss: 0.92156 (QuantReg: 12.08257) QuantErr: 12.08257 batch_time=0.35917 
Train Epoch: 5 [946/1000 30272/32000 (95%)] Loss: 0.89548 (QuantReg: 11.76847) QuantErr: 11.76847 batch_time=0.51493 
Train Epoch: 5 [951/1000 30432/32000 (95%)] Loss: 1.28200 (QuantReg: 12.01992) QuantErr: 12.01992 batch_time=0.34413 
Train Epoch: 5 [956/1000 30592/32000 (96%)] Loss: 1.00755 (QuantReg: 12.60582) QuantErr: 12.60582 batch_time=0.56412 
Train Epoch: 5 [961/1000 30752/32000 (96%)] Loss: 1.15294 (QuantReg: 12.30326) QuantErr: 12.30326 batch_time=0.36069 
Train Epoch: 5 [966/1000 30912/32000 (97%)] Loss: 1.73090 (QuantReg: 11.91289) QuantErr: 11.91289 batch_time=0.46904 
Train Epoch: 5 [971/1000 31072/32000 (97%)] Loss: 1.54141 (QuantReg: 12.27961) QuantErr: 12.27961 batch_time=0.36632 
Train Epoch: 5 [976/1000 31232/32000 (98%)] Loss: 1.15747 (QuantReg: 11.72779) QuantErr: 11.72779 batch_time=0.35348 
Train Epoch: 5 [981/1000 31392/32000 (98%)] Loss: 1.23938 (QuantReg: 12.22555) QuantErr: 12.22555 batch_time=0.42865 
Train Epoch: 5 [986/1000 31552/32000 (99%)] Loss: 2.19879 (QuantReg: 12.11160) QuantErr: 12.11160 batch_time=0.36772 
Train Epoch: 5 [991/1000 31712/32000 (99%)] Loss: 1.22908 (QuantReg: 11.69117) QuantErr: 11.69117 batch_time=0.35560 
Train Epoch: 5 [996/1000 31872/32000 (100%)] Loss: 0.88025 (QuantReg: 12.06159) QuantErr: 12.06159 batch_time=0.58363 
Train Epoch: 5 codebook_update_time=1.85897
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch5.pth ...
Done in 6.347s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch5.pth ...
Done in 11.389s
removing stale ckpt [epoch 4] [took 0.04s]
 epoch          : 5
 loss           : 1.173022401869297
 quant_reg      : 11.811383090019227
 quant_err      : 11.811383090019227
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 5000
 MSRVTT_miech_test/t2v_metrics/R1: 15.0
 MSRVTT_miech_test/t2v_metrics/R5: 40.5
 MSRVTT_miech_test/t2v_metrics/R10: 54.8
 MSRVTT_miech_test/t2v_metrics/R50: 85.1
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.4485
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.169349587251276
 MSRVTT_miech_test/v2t_metrics/R1: 15.0
 MSRVTT_miech_test/v2t_metrics/R5: 42.9
 MSRVTT_miech_test/v2t_metrics/R10: 55.8
 MSRVTT_miech_test/v2t_metrics/R50: 85.1
 MSRVTT_miech_test/v2t_metrics/MedR: 8.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 31.37
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.99090658537594
 mnt_best       : 32.169349587251276
 not_improved_count: 0
Train Epoch: 6 [1/1000 32/32000 (0%)] Loss: 0.84363 (QuantReg: 12.18316) QuantErr: 12.18316 batch_time=27.97394 
Train Epoch: 6 [6/1000 192/32000 (1%)] Loss: 0.86538 (QuantReg: 10.92344) QuantErr: 10.92344 batch_time=0.54384 
Train Epoch: 6 [11/1000 352/32000 (1%)] Loss: 0.97701 (QuantReg: 12.07979) QuantErr: 12.07979 batch_time=0.36768 
Train Epoch: 6 [16/1000 512/32000 (2%)] Loss: 0.74339 (QuantReg: 11.61930) QuantErr: 11.61930 batch_time=1.82523 
Train Epoch: 6 [21/1000 672/32000 (2%)] Loss: 0.91293 (QuantReg: 11.83850) QuantErr: 11.83850 batch_time=0.73183 
Train Epoch: 6 [26/1000 832/32000 (3%)] Loss: 1.16399 (QuantReg: 11.47241) QuantErr: 11.47241 batch_time=0.47747 
Train Epoch: 6 [31/1000 992/32000 (3%)] Loss: 0.90857 (QuantReg: 11.56136) QuantErr: 11.56136 batch_time=0.51752 
Train Epoch: 6 [36/1000 1152/32000 (4%)] Loss: 1.54564 (QuantReg: 12.01551) QuantErr: 12.01551 batch_time=0.43684 
Train Epoch: 6 [41/1000 1312/32000 (4%)] Loss: 0.49176 (QuantReg: 11.94618) QuantErr: 11.94618 batch_time=0.76941 
Train Epoch: 6 [46/1000 1472/32000 (5%)] Loss: 0.56797 (QuantReg: 11.74455) QuantErr: 11.74455 batch_time=0.41599 
Train Epoch: 6 [51/1000 1632/32000 (5%)] Loss: 1.01609 (QuantReg: 12.25170) QuantErr: 12.25170 batch_time=0.34328 
Train Epoch: 6 [56/1000 1792/32000 (6%)] Loss: 0.66188 (QuantReg: 12.04618) QuantErr: 12.04618 batch_time=0.47936 
Train Epoch: 6 [61/1000 1952/32000 (6%)] Loss: 1.91289 (QuantReg: 12.33611) QuantErr: 12.33611 batch_time=0.34976 
Train Epoch: 6 [66/1000 2112/32000 (7%)] Loss: 1.15157 (QuantReg: 11.91538) QuantErr: 11.91538 batch_time=0.49416 
Train Epoch: 6 [71/1000 2272/32000 (7%)] Loss: 1.25791 (QuantReg: 11.28755) QuantErr: 11.28755 batch_time=0.34649 
Train Epoch: 6 [76/1000 2432/32000 (8%)] Loss: 1.64322 (QuantReg: 11.39618) QuantErr: 11.39618 batch_time=0.34462 
Train Epoch: 6 [81/1000 2592/32000 (8%)] Loss: 1.17587 (QuantReg: 11.66252) QuantErr: 11.66252 batch_time=0.33178 
Train Epoch: 6 [86/1000 2752/32000 (9%)] Loss: 0.95276 (QuantReg: 11.35594) QuantErr: 11.35594 batch_time=0.60820 
Train Epoch: 6 [91/1000 2912/32000 (9%)] Loss: 1.40320 (QuantReg: 11.77278) QuantErr: 11.77278 batch_time=0.39912 
Train Epoch: 6 [96/1000 3072/32000 (10%)] Loss: 0.90648 (QuantReg: 11.34593) QuantErr: 11.34593 batch_time=0.71132 
Train Epoch: 6 [101/1000 3232/32000 (10%)] Loss: 0.95359 (QuantReg: 11.72814) QuantErr: 11.72814 batch_time=0.34160 
Train Epoch: 6 [106/1000 3392/32000 (11%)] Loss: 1.09069 (QuantReg: 12.10325) QuantErr: 12.10325 batch_time=0.35709 
Train Epoch: 6 [111/1000 3552/32000 (11%)] Loss: 1.02125 (QuantReg: 11.17649) QuantErr: 11.17649 batch_time=0.45355 
Train Epoch: 6 [116/1000 3712/32000 (12%)] Loss: 0.72548 (QuantReg: 11.44200) QuantErr: 11.44200 batch_time=0.36711 
Train Epoch: 6 [121/1000 3872/32000 (12%)] Loss: 1.35234 (QuantReg: 11.30790) QuantErr: 11.30790 batch_time=0.60435 
Train Epoch: 6 [126/1000 4032/32000 (13%)] Loss: 0.91374 (QuantReg: 11.14868) QuantErr: 11.14868 batch_time=0.33590 
Train Epoch: 6 [131/1000 4192/32000 (13%)] Loss: 1.43612 (QuantReg: 10.94341) QuantErr: 10.94341 batch_time=0.65007 
Train Epoch: 6 [136/1000 4352/32000 (14%)] Loss: 1.32810 (QuantReg: 10.71954) QuantErr: 10.71954 batch_time=0.59940 
Train Epoch: 6 [141/1000 4512/32000 (14%)] Loss: 1.14544 (QuantReg: 12.00976) QuantErr: 12.00976 batch_time=0.56238 
Train Epoch: 6 [146/1000 4672/32000 (15%)] Loss: 0.97365 (QuantReg: 11.00992) QuantErr: 11.00992 batch_time=0.35544 
Train Epoch: 6 [151/1000 4832/32000 (15%)] Loss: 0.80063 (QuantReg: 11.63460) QuantErr: 11.63460 batch_time=0.33324 
Train Epoch: 6 [156/1000 4992/32000 (16%)] Loss: 1.11450 (QuantReg: 11.92736) QuantErr: 11.92736 batch_time=0.35070 
Train Epoch: 6 [161/1000 5152/32000 (16%)] Loss: 1.02373 (QuantReg: 11.25327) QuantErr: 11.25327 batch_time=0.33978 
Train Epoch: 6 [166/1000 5312/32000 (17%)] Loss: 0.96027 (QuantReg: 11.16618) QuantErr: 11.16618 batch_time=0.37860 
Train Epoch: 6 [171/1000 5472/32000 (17%)] Loss: 0.93606 (QuantReg: 12.14677) QuantErr: 12.14677 batch_time=0.34312 
Train Epoch: 6 [176/1000 5632/32000 (18%)] Loss: 1.19752 (QuantReg: 11.27283) QuantErr: 11.27283 batch_time=0.71238 
Train Epoch: 6 [181/1000 5792/32000 (18%)] Loss: 1.18776 (QuantReg: 12.19070) QuantErr: 12.19070 batch_time=0.39804 
Train Epoch: 6 [186/1000 5952/32000 (19%)] Loss: 1.22926 (QuantReg: 11.28633) QuantErr: 11.28633 batch_time=0.36472 
Train Epoch: 6 [191/1000 6112/32000 (19%)] Loss: 0.96376 (QuantReg: 11.49963) QuantErr: 11.49963 batch_time=0.33184 
Train Epoch: 6 [196/1000 6272/32000 (20%)] Loss: 0.81706 (QuantReg: 11.55067) QuantErr: 11.55067 batch_time=0.40942 
Train Epoch: 6 [201/1000 6432/32000 (20%)] Loss: 1.08764 (QuantReg: 11.62301) QuantErr: 11.62301 batch_time=0.38803 
Train Epoch: 6 [206/1000 6592/32000 (21%)] Loss: 0.88938 (QuantReg: 12.04578) QuantErr: 12.04578 batch_time=0.33181 
Train Epoch: 6 [211/1000 6752/32000 (21%)] Loss: 0.79220 (QuantReg: 11.46387) QuantErr: 11.46387 batch_time=0.37560 
Train Epoch: 6 [216/1000 6912/32000 (22%)] Loss: 1.47682 (QuantReg: 11.51510) QuantErr: 11.51510 batch_time=0.37165 
Train Epoch: 6 [221/1000 7072/32000 (22%)] Loss: 1.32176 (QuantReg: 12.18291) QuantErr: 12.18291 batch_time=0.36449 
Train Epoch: 6 [226/1000 7232/32000 (23%)] Loss: 1.10170 (QuantReg: 11.75807) QuantErr: 11.75807 batch_time=0.45608 
Train Epoch: 6 [231/1000 7392/32000 (23%)] Loss: 1.69181 (QuantReg: 11.47356) QuantErr: 11.47356 batch_time=0.34122 
Train Epoch: 6 [236/1000 7552/32000 (24%)] Loss: 1.61154 (QuantReg: 11.99929) QuantErr: 11.99929 batch_time=0.39084 
Train Epoch: 6 [241/1000 7712/32000 (24%)] Loss: 1.36717 (QuantReg: 11.67441) QuantErr: 11.67441 batch_time=0.33664 
Train Epoch: 6 [246/1000 7872/32000 (25%)] Loss: 1.50388 (QuantReg: 11.26804) QuantErr: 11.26804 batch_time=0.38013 
Train Epoch: 6 [251/1000 8032/32000 (25%)] Loss: 0.87414 (QuantReg: 11.22170) QuantErr: 11.22170 batch_time=0.35956 
Train Epoch: 6 [256/1000 8192/32000 (26%)] Loss: 0.88806 (QuantReg: 11.79355) QuantErr: 11.79355 batch_time=0.42763 
Train Epoch: 6 [261/1000 8352/32000 (26%)] Loss: 1.96474 (QuantReg: 11.30197) QuantErr: 11.30197 batch_time=0.39117 
Train Epoch: 6 [266/1000 8512/32000 (27%)] Loss: 0.95875 (QuantReg: 12.12388) QuantErr: 12.12388 batch_time=0.33091 
Train Epoch: 6 [271/1000 8672/32000 (27%)] Loss: 1.05084 (QuantReg: 12.18277) QuantErr: 12.18277 batch_time=0.59892 
Train Epoch: 6 [276/1000 8832/32000 (28%)] Loss: 0.99805 (QuantReg: 11.93423) QuantErr: 11.93423 batch_time=0.34390 
Train Epoch: 6 [281/1000 8992/32000 (28%)] Loss: 0.83497 (QuantReg: 11.80042) QuantErr: 11.80042 batch_time=0.36018 
Train Epoch: 6 [286/1000 9152/32000 (29%)] Loss: 1.42423 (QuantReg: 11.83631) QuantErr: 11.83631 batch_time=0.37709 
Train Epoch: 6 [291/1000 9312/32000 (29%)] Loss: 0.45124 (QuantReg: 11.76488) QuantErr: 11.76488 batch_time=0.42946 
Train Epoch: 6 [296/1000 9472/32000 (30%)] Loss: 0.91589 (QuantReg: 11.57273) QuantErr: 11.57273 batch_time=0.40244 
Train Epoch: 6 [301/1000 9632/32000 (30%)] Loss: 1.84649 (QuantReg: 11.63189) QuantErr: 11.63189 batch_time=0.40889 
Train Epoch: 6 [306/1000 9792/32000 (31%)] Loss: 0.74226 (QuantReg: 11.59883) QuantErr: 11.59883 batch_time=0.45002 
Train Epoch: 6 [311/1000 9952/32000 (31%)] Loss: 0.89630 (QuantReg: 12.58114) QuantErr: 12.58114 batch_time=0.52723 
Train Epoch: 6 [316/1000 10112/32000 (32%)] Loss: 0.83931 (QuantReg: 11.57544) QuantErr: 11.57544 batch_time=0.55066 
Train Epoch: 6 [321/1000 10272/32000 (32%)] Loss: 1.17229 (QuantReg: 12.12431) QuantErr: 12.12431 batch_time=0.41720 
Train Epoch: 6 [326/1000 10432/32000 (33%)] Loss: 0.68008 (QuantReg: 11.94189) QuantErr: 11.94189 batch_time=0.49213 
Train Epoch: 6 [331/1000 10592/32000 (33%)] Loss: 1.13801 (QuantReg: 12.29789) QuantErr: 12.29789 batch_time=0.36111 
Train Epoch: 6 [336/1000 10752/32000 (34%)] Loss: 1.38385 (QuantReg: 11.62582) QuantErr: 11.62582 batch_time=0.95436 
Train Epoch: 6 [341/1000 10912/32000 (34%)] Loss: 1.04314 (QuantReg: 11.47167) QuantErr: 11.47167 batch_time=1.12754 
Train Epoch: 6 [346/1000 11072/32000 (35%)] Loss: 1.95116 (QuantReg: 11.88704) QuantErr: 11.88704 batch_time=0.36748 
Train Epoch: 6 [351/1000 11232/32000 (35%)] Loss: 1.08640 (QuantReg: 11.40861) QuantErr: 11.40861 batch_time=0.54268 
Train Epoch: 6 [356/1000 11392/32000 (36%)] Loss: 1.36469 (QuantReg: 12.29484) QuantErr: 12.29484 batch_time=0.77706 
Train Epoch: 6 [361/1000 11552/32000 (36%)] Loss: 1.00530 (QuantReg: 11.10046) QuantErr: 11.10046 batch_time=0.36679 
Train Epoch: 6 [366/1000 11712/32000 (37%)] Loss: 1.02592 (QuantReg: 11.61928) QuantErr: 11.61928 batch_time=0.41133 
Train Epoch: 6 [371/1000 11872/32000 (37%)] Loss: 1.33734 (QuantReg: 10.78162) QuantErr: 10.78162 batch_time=0.38868 
Train Epoch: 6 [376/1000 12032/32000 (38%)] Loss: 0.94890 (QuantReg: 11.59075) QuantErr: 11.59075 batch_time=0.36291 
Train Epoch: 6 [381/1000 12192/32000 (38%)] Loss: 1.89083 (QuantReg: 11.65487) QuantErr: 11.65487 batch_time=0.41105 
Train Epoch: 6 [386/1000 12352/32000 (39%)] Loss: 0.91783 (QuantReg: 11.47031) QuantErr: 11.47031 batch_time=0.35870 
Train Epoch: 6 [391/1000 12512/32000 (39%)] Loss: 0.97466 (QuantReg: 11.79006) QuantErr: 11.79006 batch_time=0.34574 
Train Epoch: 6 [396/1000 12672/32000 (40%)] Loss: 1.53844 (QuantReg: 11.83364) QuantErr: 11.83364 batch_time=0.42645 
Train Epoch: 6 [401/1000 12832/32000 (40%)] Loss: 0.99494 (QuantReg: 12.14331) QuantErr: 12.14331 batch_time=0.37138 
Train Epoch: 6 [406/1000 12992/32000 (41%)] Loss: 1.56378 (QuantReg: 11.83570) QuantErr: 11.83570 batch_time=0.40347 
Train Epoch: 6 [411/1000 13152/32000 (41%)] Loss: 0.85735 (QuantReg: 11.12597) QuantErr: 11.12597 batch_time=0.33200 
Train Epoch: 6 [416/1000 13312/32000 (42%)] Loss: 0.91623 (QuantReg: 11.37637) QuantErr: 11.37637 batch_time=0.34865 
Train Epoch: 6 [421/1000 13472/32000 (42%)] Loss: 1.04973 (QuantReg: 12.14144) QuantErr: 12.14144 batch_time=1.12086 
Train Epoch: 6 [426/1000 13632/32000 (43%)] Loss: 0.72105 (QuantReg: 12.06900) QuantErr: 12.06900 batch_time=0.39090 
Train Epoch: 6 [431/1000 13792/32000 (43%)] Loss: 0.94084 (QuantReg: 11.26619) QuantErr: 11.26619 batch_time=1.00981 
Train Epoch: 6 [436/1000 13952/32000 (44%)] Loss: 1.11442 (QuantReg: 11.32519) QuantErr: 11.32519 batch_time=0.33369 
Train Epoch: 6 [441/1000 14112/32000 (44%)] Loss: 0.74037 (QuantReg: 11.92143) QuantErr: 11.92143 batch_time=0.80729 
Train Epoch: 6 [446/1000 14272/32000 (45%)] Loss: 1.05111 (QuantReg: 11.65499) QuantErr: 11.65499 batch_time=0.43936 
Train Epoch: 6 [451/1000 14432/32000 (45%)] Loss: 1.07273 (QuantReg: 12.56970) QuantErr: 12.56970 batch_time=0.63249 
Train Epoch: 6 [456/1000 14592/32000 (46%)] Loss: 1.12646 (QuantReg: 11.79176) QuantErr: 11.79176 batch_time=0.34529 
Train Epoch: 6 [461/1000 14752/32000 (46%)] Loss: 0.86461 (QuantReg: 11.75686) QuantErr: 11.75686 batch_time=0.43204 
Train Epoch: 6 [466/1000 14912/32000 (47%)] Loss: 1.15021 (QuantReg: 12.21092) QuantErr: 12.21092 batch_time=0.44098 
Train Epoch: 6 [471/1000 15072/32000 (47%)] Loss: 1.49007 (QuantReg: 11.98616) QuantErr: 11.98616 batch_time=0.38895 
Train Epoch: 6 [476/1000 15232/32000 (48%)] Loss: 1.39557 (QuantReg: 11.98496) QuantErr: 11.98496 batch_time=0.44348 
Train Epoch: 6 [481/1000 15392/32000 (48%)] Loss: 0.69866 (QuantReg: 12.09074) QuantErr: 12.09074 batch_time=0.45353 
Train Epoch: 6 [486/1000 15552/32000 (49%)] Loss: 1.94975 (QuantReg: 11.35846) QuantErr: 11.35846 batch_time=0.41769 
Train Epoch: 6 [491/1000 15712/32000 (49%)] Loss: 0.52564 (QuantReg: 12.14209) QuantErr: 12.14209 batch_time=0.35102 
Train Epoch: 6 [496/1000 15872/32000 (50%)] Loss: 0.82310 (QuantReg: 11.60706) QuantErr: 11.60706 batch_time=0.37221 
Train Epoch: 6 [501/1000 16032/32000 (50%)] Loss: 0.48393 (QuantReg: 12.35537) QuantErr: 12.35537 batch_time=0.35695 
Train Epoch: 6 [506/1000 16192/32000 (51%)] Loss: 0.78120 (QuantReg: 11.99733) QuantErr: 11.99733 batch_time=0.37666 
Train Epoch: 6 [511/1000 16352/32000 (51%)] Loss: 0.78738 (QuantReg: 12.15308) QuantErr: 12.15308 batch_time=0.37816 
Train Epoch: 6 [516/1000 16512/32000 (52%)] Loss: 0.82773 (QuantReg: 12.28228) QuantErr: 12.28228 batch_time=0.36279 
Train Epoch: 6 [521/1000 16672/32000 (52%)] Loss: 1.55901 (QuantReg: 12.17088) QuantErr: 12.17088 batch_time=0.37674 
Train Epoch: 6 [526/1000 16832/32000 (53%)] Loss: 0.65821 (QuantReg: 11.52319) QuantErr: 11.52319 batch_time=0.77110 
Train Epoch: 6 [531/1000 16992/32000 (53%)] Loss: 1.34360 (QuantReg: 11.98618) QuantErr: 11.98618 batch_time=0.41596 
Train Epoch: 6 [536/1000 17152/32000 (54%)] Loss: 0.96657 (QuantReg: 11.71134) QuantErr: 11.71134 batch_time=0.46560 
Train Epoch: 6 [541/1000 17312/32000 (54%)] Loss: 1.19503 (QuantReg: 11.77901) QuantErr: 11.77901 batch_time=0.39125 
Train Epoch: 6 [546/1000 17472/32000 (55%)] Loss: 1.04015 (QuantReg: 11.29067) QuantErr: 11.29067 batch_time=0.35471 
Train Epoch: 6 [551/1000 17632/32000 (55%)] Loss: 0.57415 (QuantReg: 12.24308) QuantErr: 12.24308 batch_time=0.49269 
Train Epoch: 6 [556/1000 17792/32000 (56%)] Loss: 0.99983 (QuantReg: 11.51644) QuantErr: 11.51644 batch_time=0.40742 
Train Epoch: 6 [561/1000 17952/32000 (56%)] Loss: 1.49286 (QuantReg: 11.84678) QuantErr: 11.84678 batch_time=0.39106 
Train Epoch: 6 [566/1000 18112/32000 (57%)] Loss: 1.10588 (QuantReg: 11.46718) QuantErr: 11.46718 batch_time=0.63853 
Train Epoch: 6 [571/1000 18272/32000 (57%)] Loss: 1.53372 (QuantReg: 11.93813) QuantErr: 11.93813 batch_time=0.46682 
Train Epoch: 6 [576/1000 18432/32000 (58%)] Loss: 0.73010 (QuantReg: 11.76406) QuantErr: 11.76406 batch_time=0.38882 
Train Epoch: 6 [581/1000 18592/32000 (58%)] Loss: 0.57152 (QuantReg: 11.98268) QuantErr: 11.98268 batch_time=1.15125 
Train Epoch: 6 [586/1000 18752/32000 (59%)] Loss: 1.77500 (QuantReg: 12.42893) QuantErr: 12.42893 batch_time=0.43027 
Train Epoch: 6 [591/1000 18912/32000 (59%)] Loss: 0.99751 (QuantReg: 11.57033) QuantErr: 11.57033 batch_time=0.36876 
Train Epoch: 6 [596/1000 19072/32000 (60%)] Loss: 1.75380 (QuantReg: 11.33501) QuantErr: 11.33501 batch_time=0.68145 
Train Epoch: 6 [601/1000 19232/32000 (60%)] Loss: 1.58031 (QuantReg: 12.02016) QuantErr: 12.02016 batch_time=0.60662 
Train Epoch: 6 [606/1000 19392/32000 (61%)] Loss: 1.53356 (QuantReg: 12.49813) QuantErr: 12.49813 batch_time=0.32633 
Train Epoch: 6 [611/1000 19552/32000 (61%)] Loss: 0.89501 (QuantReg: 11.08826) QuantErr: 11.08826 batch_time=0.58217 
Train Epoch: 6 [616/1000 19712/32000 (62%)] Loss: 1.07474 (QuantReg: 11.95842) QuantErr: 11.95842 batch_time=0.51223 
Train Epoch: 6 [621/1000 19872/32000 (62%)] Loss: 2.04627 (QuantReg: 11.69129) QuantErr: 11.69129 batch_time=0.39301 
Train Epoch: 6 [626/1000 20032/32000 (63%)] Loss: 0.81639 (QuantReg: 11.91870) QuantErr: 11.91870 batch_time=0.39097 
Train Epoch: 6 [631/1000 20192/32000 (63%)] Loss: 1.16106 (QuantReg: 12.35715) QuantErr: 12.35715 batch_time=0.48805 
Train Epoch: 6 [636/1000 20352/32000 (64%)] Loss: 1.51732 (QuantReg: 11.84477) QuantErr: 11.84477 batch_time=0.45592 
Train Epoch: 6 [641/1000 20512/32000 (64%)] Loss: 0.73855 (QuantReg: 11.72991) QuantErr: 11.72991 batch_time=0.43251 
Train Epoch: 6 [646/1000 20672/32000 (65%)] Loss: 1.40200 (QuantReg: 11.56433) QuantErr: 11.56433 batch_time=0.34368 
Train Epoch: 6 [651/1000 20832/32000 (65%)] Loss: 0.65958 (QuantReg: 12.70094) QuantErr: 12.70094 batch_time=0.79504 
Train Epoch: 6 [656/1000 20992/32000 (66%)] Loss: 1.04416 (QuantReg: 11.76577) QuantErr: 11.76577 batch_time=0.55000 
Train Epoch: 6 [661/1000 21152/32000 (66%)] Loss: 0.90736 (QuantReg: 11.63396) QuantErr: 11.63396 batch_time=0.42317 
Train Epoch: 6 [666/1000 21312/32000 (67%)] Loss: 1.13241 (QuantReg: 11.42007) QuantErr: 11.42007 batch_time=0.33363 
Train Epoch: 6 [671/1000 21472/32000 (67%)] Loss: 0.77467 (QuantReg: 11.67159) QuantErr: 11.67159 batch_time=0.42019 
Train Epoch: 6 [676/1000 21632/32000 (68%)] Loss: 0.38644 (QuantReg: 11.67796) QuantErr: 11.67796 batch_time=0.41181 
Train Epoch: 6 [681/1000 21792/32000 (68%)] Loss: 0.76502 (QuantReg: 12.31721) QuantErr: 12.31721 batch_time=0.41996 
Train Epoch: 6 [686/1000 21952/32000 (69%)] Loss: 1.55554 (QuantReg: 12.19777) QuantErr: 12.19777 batch_time=0.34501 
Train Epoch: 6 [691/1000 22112/32000 (69%)] Loss: 1.10304 (QuantReg: 12.18224) QuantErr: 12.18224 batch_time=0.86205 
Train Epoch: 6 [696/1000 22272/32000 (70%)] Loss: 0.83406 (QuantReg: 11.94048) QuantErr: 11.94048 batch_time=0.34633 
Train Epoch: 6 [701/1000 22432/32000 (70%)] Loss: 1.26725 (QuantReg: 11.69294) QuantErr: 11.69294 batch_time=0.79699 
Train Epoch: 6 [706/1000 22592/32000 (71%)] Loss: 0.99598 (QuantReg: 12.32781) QuantErr: 12.32781 batch_time=0.36395 
Train Epoch: 6 [711/1000 22752/32000 (71%)] Loss: 0.63077 (QuantReg: 12.63663) QuantErr: 12.63663 batch_time=0.34663 
Train Epoch: 6 [716/1000 22912/32000 (72%)] Loss: 1.10074 (QuantReg: 11.64182) QuantErr: 11.64182 batch_time=0.38110 
Train Epoch: 6 [721/1000 23072/32000 (72%)] Loss: 1.21040 (QuantReg: 11.93932) QuantErr: 11.93932 batch_time=0.44140 
Train Epoch: 6 [726/1000 23232/32000 (73%)] Loss: 0.76936 (QuantReg: 11.39754) QuantErr: 11.39754 batch_time=0.41517 
Train Epoch: 6 [731/1000 23392/32000 (73%)] Loss: 1.36504 (QuantReg: 11.61412) QuantErr: 11.61412 batch_time=0.70155 
Train Epoch: 6 [736/1000 23552/32000 (74%)] Loss: 1.22028 (QuantReg: 12.01522) QuantErr: 12.01522 batch_time=0.52416 
Train Epoch: 6 [741/1000 23712/32000 (74%)] Loss: 0.83023 (QuantReg: 12.28793) QuantErr: 12.28793 batch_time=0.75391 
Train Epoch: 6 [746/1000 23872/32000 (75%)] Loss: 1.07582 (QuantReg: 11.66648) QuantErr: 11.66648 batch_time=0.48885 
Train Epoch: 6 [751/1000 24032/32000 (75%)] Loss: 1.18545 (QuantReg: 11.88947) QuantErr: 11.88947 batch_time=1.01764 
Train Epoch: 6 [756/1000 24192/32000 (76%)] Loss: 0.82332 (QuantReg: 12.43693) QuantErr: 12.43693 batch_time=0.39847 
Train Epoch: 6 [761/1000 24352/32000 (76%)] Loss: 0.76707 (QuantReg: 12.31974) QuantErr: 12.31974 batch_time=0.42721 
Train Epoch: 6 [766/1000 24512/32000 (77%)] Loss: 0.69049 (QuantReg: 12.11276) QuantErr: 12.11276 batch_time=0.43537 
Train Epoch: 6 [771/1000 24672/32000 (77%)] Loss: 1.41269 (QuantReg: 12.89133) QuantErr: 12.89133 batch_time=0.40933 
Train Epoch: 6 [776/1000 24832/32000 (78%)] Loss: 1.02877 (QuantReg: 11.83625) QuantErr: 11.83625 batch_time=0.77838 
Train Epoch: 6 [781/1000 24992/32000 (78%)] Loss: 1.10380 (QuantReg: 12.49438) QuantErr: 12.49438 batch_time=0.41343 
Train Epoch: 6 [786/1000 25152/32000 (79%)] Loss: 1.49466 (QuantReg: 11.96405) QuantErr: 11.96405 batch_time=0.36897 
Train Epoch: 6 [791/1000 25312/32000 (79%)] Loss: 0.89395 (QuantReg: 11.68837) QuantErr: 11.68837 batch_time=0.38201 
Train Epoch: 6 [796/1000 25472/32000 (80%)] Loss: 0.77648 (QuantReg: 12.29126) QuantErr: 12.29126 batch_time=0.38073 
Train Epoch: 6 [801/1000 25632/32000 (80%)] Loss: 0.74163 (QuantReg: 11.74993) QuantErr: 11.74993 batch_time=0.38701 
Train Epoch: 6 [806/1000 25792/32000 (81%)] Loss: 0.89987 (QuantReg: 11.90065) QuantErr: 11.90065 batch_time=0.39423 
Train Epoch: 6 [811/1000 25952/32000 (81%)] Loss: 0.74026 (QuantReg: 12.60519) QuantErr: 12.60519 batch_time=0.37698 
Train Epoch: 6 [816/1000 26112/32000 (82%)] Loss: 1.15635 (QuantReg: 12.29949) QuantErr: 12.29949 batch_time=0.39838 
Train Epoch: 6 [821/1000 26272/32000 (82%)] Loss: 1.30155 (QuantReg: 12.61660) QuantErr: 12.61660 batch_time=0.59118 
Train Epoch: 6 [826/1000 26432/32000 (83%)] Loss: 0.67542 (QuantReg: 12.36370) QuantErr: 12.36370 batch_time=0.38770 
Train Epoch: 6 [831/1000 26592/32000 (83%)] Loss: 1.08151 (QuantReg: 11.94109) QuantErr: 11.94109 batch_time=0.34955 
Train Epoch: 6 [836/1000 26752/32000 (84%)] Loss: 2.10723 (QuantReg: 12.63537) QuantErr: 12.63537 batch_time=0.34530 
Train Epoch: 6 [841/1000 26912/32000 (84%)] Loss: 0.46362 (QuantReg: 12.36500) QuantErr: 12.36500 batch_time=0.37356 
Train Epoch: 6 [846/1000 27072/32000 (85%)] Loss: 1.44706 (QuantReg: 11.72606) QuantErr: 11.72606 batch_time=0.37741 
Train Epoch: 6 [851/1000 27232/32000 (85%)] Loss: 0.50523 (QuantReg: 11.99667) QuantErr: 11.99667 batch_time=0.36827 
Train Epoch: 6 [856/1000 27392/32000 (86%)] Loss: 1.75226 (QuantReg: 11.69445) QuantErr: 11.69445 batch_time=0.36029 
Train Epoch: 6 [861/1000 27552/32000 (86%)] Loss: 1.80745 (QuantReg: 12.01141) QuantErr: 12.01141 batch_time=0.46619 
Train Epoch: 6 [866/1000 27712/32000 (87%)] Loss: 1.57546 (QuantReg: 12.45314) QuantErr: 12.45314 batch_time=0.60971 
Train Epoch: 6 [871/1000 27872/32000 (87%)] Loss: 0.56042 (QuantReg: 12.27324) QuantErr: 12.27324 batch_time=0.37134 
Train Epoch: 6 [876/1000 28032/32000 (88%)] Loss: 0.54469 (QuantReg: 12.19989) QuantErr: 12.19989 batch_time=0.36857 
Train Epoch: 6 [881/1000 28192/32000 (88%)] Loss: 1.50173 (QuantReg: 11.90024) QuantErr: 11.90024 batch_time=0.41890 
Train Epoch: 6 [886/1000 28352/32000 (89%)] Loss: 1.86306 (QuantReg: 11.83583) QuantErr: 11.83583 batch_time=0.35539 
Train Epoch: 6 [891/1000 28512/32000 (89%)] Loss: 0.90119 (QuantReg: 12.59114) QuantErr: 12.59114 batch_time=0.42304 
Train Epoch: 6 [896/1000 28672/32000 (90%)] Loss: 0.62430 (QuantReg: 12.23399) QuantErr: 12.23399 batch_time=0.45474 
Train Epoch: 6 [901/1000 28832/32000 (90%)] Loss: 0.75260 (QuantReg: 11.84507) QuantErr: 11.84507 batch_time=1.30140 
Train Epoch: 6 [906/1000 28992/32000 (91%)] Loss: 1.37093 (QuantReg: 12.06977) QuantErr: 12.06977 batch_time=0.35492 
Train Epoch: 6 [911/1000 29152/32000 (91%)] Loss: 1.24827 (QuantReg: 13.00707) QuantErr: 13.00707 batch_time=0.67271 
Train Epoch: 6 [916/1000 29312/32000 (92%)] Loss: 0.82080 (QuantReg: 12.45973) QuantErr: 12.45973 batch_time=0.72533 
Train Epoch: 6 [921/1000 29472/32000 (92%)] Loss: 1.04021 (QuantReg: 12.29813) QuantErr: 12.29813 batch_time=0.33378 
Train Epoch: 6 [926/1000 29632/32000 (93%)] Loss: 0.87764 (QuantReg: 11.62189) QuantErr: 11.62189 batch_time=0.33859 
Train Epoch: 6 [931/1000 29792/32000 (93%)] Loss: 0.90122 (QuantReg: 11.84269) QuantErr: 11.84269 batch_time=0.41406 
Train Epoch: 6 [936/1000 29952/32000 (94%)] Loss: 1.20081 (QuantReg: 12.01180) QuantErr: 12.01180 batch_time=0.36957 
Train Epoch: 6 [941/1000 30112/32000 (94%)] Loss: 1.04912 (QuantReg: 11.92271) QuantErr: 11.92271 batch_time=0.67880 
Train Epoch: 6 [946/1000 30272/32000 (95%)] Loss: 0.50336 (QuantReg: 12.33647) QuantErr: 12.33647 batch_time=0.35175 
Train Epoch: 6 [951/1000 30432/32000 (95%)] Loss: 1.47629 (QuantReg: 11.71128) QuantErr: 11.71128 batch_time=0.34635 
Train Epoch: 6 [956/1000 30592/32000 (96%)] Loss: 0.86950 (QuantReg: 12.78084) QuantErr: 12.78084 batch_time=0.63039 
Train Epoch: 6 [961/1000 30752/32000 (96%)] Loss: 1.00036 (QuantReg: 11.92651) QuantErr: 11.92651 batch_time=0.41417 
Train Epoch: 6 [966/1000 30912/32000 (97%)] Loss: 0.67317 (QuantReg: 12.43071) QuantErr: 12.43071 batch_time=0.50223 
Train Epoch: 6 [971/1000 31072/32000 (97%)] Loss: 0.64522 (QuantReg: 11.96074) QuantErr: 11.96074 batch_time=0.35902 
Train Epoch: 6 [976/1000 31232/32000 (98%)] Loss: 1.16561 (QuantReg: 12.41195) QuantErr: 12.41195 batch_time=0.40110 
Train Epoch: 6 [981/1000 31392/32000 (98%)] Loss: 0.88130 (QuantReg: 12.04146) QuantErr: 12.04146 batch_time=0.43809 
Train Epoch: 6 [986/1000 31552/32000 (99%)] Loss: 0.76973 (QuantReg: 12.20408) QuantErr: 12.20408 batch_time=0.42696 
Train Epoch: 6 [991/1000 31712/32000 (99%)] Loss: 1.06242 (QuantReg: 11.73895) QuantErr: 11.73895 batch_time=0.33527 
Train Epoch: 6 [996/1000 31872/32000 (100%)] Loss: 0.80967 (QuantReg: 12.46991) QuantErr: 12.46991 batch_time=0.47702 
Train Epoch: 6 codebook_update_time=1.90887
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch6.pth ...
Done in 6.662s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch6.pth ...
Done in 14.492s
removing stale ckpt [epoch 5] [took 0.06s]
 epoch          : 6
 loss           : 1.0717571999132633
 quant_reg      : 11.841661568641662
 quant_err      : 11.841661568641662
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 6000
 MSRVTT_miech_test/t2v_metrics/R1: 15.5
 MSRVTT_miech_test/t2v_metrics/R5: 43.7
 MSRVTT_miech_test/t2v_metrics/R10: 56.8
 MSRVTT_miech_test/t2v_metrics/R50: 85.9
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 35.215
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.758812147958835
 MSRVTT_miech_test/v2t_metrics/R1: 15.5
 MSRVTT_miech_test/v2t_metrics/R5: 45.0
 MSRVTT_miech_test/v2t_metrics/R10: 58.6
 MSRVTT_miech_test/v2t_metrics/R50: 86.4
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.5445
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.44667249625683
 mnt_best       : 33.758812147958835
 not_improved_count: 0
Train Epoch: 7 [1/1000 32/32000 (0%)] Loss: 0.94478 (QuantReg: 11.60235) QuantErr: 11.60235 batch_time=28.94743 
Train Epoch: 7 [6/1000 192/32000 (1%)] Loss: 0.56173 (QuantReg: 11.60820) QuantErr: 11.60820 batch_time=0.58032 
Train Epoch: 7 [11/1000 352/32000 (1%)] Loss: 1.25698 (QuantReg: 10.82762) QuantErr: 10.82762 batch_time=0.39516 
Train Epoch: 7 [16/1000 512/32000 (2%)] Loss: 1.12590 (QuantReg: 11.88375) QuantErr: 11.88375 batch_time=1.77548 
Train Epoch: 7 [21/1000 672/32000 (2%)] Loss: 1.36672 (QuantReg: 10.83436) QuantErr: 10.83436 batch_time=0.41458 
Train Epoch: 7 [26/1000 832/32000 (3%)] Loss: 1.57164 (QuantReg: 11.66643) QuantErr: 11.66643 batch_time=0.46107 
Train Epoch: 7 [31/1000 992/32000 (3%)] Loss: 0.81085 (QuantReg: 12.45756) QuantErr: 12.45756 batch_time=0.44806 
Train Epoch: 7 [36/1000 1152/32000 (4%)] Loss: 1.32100 (QuantReg: 11.30042) QuantErr: 11.30042 batch_time=0.35235 
Train Epoch: 7 [41/1000 1312/32000 (4%)] Loss: 0.69044 (QuantReg: 11.79612) QuantErr: 11.79612 batch_time=0.72142 
Train Epoch: 7 [46/1000 1472/32000 (5%)] Loss: 0.71347 (QuantReg: 12.12155) QuantErr: 12.12155 batch_time=0.35257 
Train Epoch: 7 [51/1000 1632/32000 (5%)] Loss: 1.13749 (QuantReg: 11.44164) QuantErr: 11.44164 batch_time=0.50647 
Train Epoch: 7 [56/1000 1792/32000 (6%)] Loss: 0.68501 (QuantReg: 11.29216) QuantErr: 11.29216 batch_time=0.34098 
Train Epoch: 7 [61/1000 1952/32000 (6%)] Loss: 0.95876 (QuantReg: 11.55314) QuantErr: 11.55314 batch_time=0.51693 
Train Epoch: 7 [66/1000 2112/32000 (7%)] Loss: 0.81031 (QuantReg: 11.51649) QuantErr: 11.51649 batch_time=0.36620 
Train Epoch: 7 [71/1000 2272/32000 (7%)] Loss: 0.86236 (QuantReg: 11.37139) QuantErr: 11.37139 batch_time=0.39657 
Train Epoch: 7 [76/1000 2432/32000 (8%)] Loss: 1.45314 (QuantReg: 11.38021) QuantErr: 11.38021 batch_time=0.37955 
Train Epoch: 7 [81/1000 2592/32000 (8%)] Loss: 0.53232 (QuantReg: 11.98736) QuantErr: 11.98736 batch_time=0.56585 
Train Epoch: 7 [86/1000 2752/32000 (9%)] Loss: 0.81937 (QuantReg: 12.37543) QuantErr: 12.37543 batch_time=0.56789 
Train Epoch: 7 [91/1000 2912/32000 (9%)] Loss: 0.73826 (QuantReg: 12.39415) QuantErr: 12.39415 batch_time=0.40920 
Train Epoch: 7 [96/1000 3072/32000 (10%)] Loss: 0.81540 (QuantReg: 12.01182) QuantErr: 12.01182 batch_time=0.41629 
Train Epoch: 7 [101/1000 3232/32000 (10%)] Loss: 0.70634 (QuantReg: 11.79198) QuantErr: 11.79198 batch_time=0.35351 
Train Epoch: 7 [106/1000 3392/32000 (11%)] Loss: 1.59219 (QuantReg: 11.88540) QuantErr: 11.88540 batch_time=0.43886 
Train Epoch: 7 [111/1000 3552/32000 (11%)] Loss: 0.95512 (QuantReg: 11.39299) QuantErr: 11.39299 batch_time=0.37945 
Train Epoch: 7 [116/1000 3712/32000 (12%)] Loss: 0.90730 (QuantReg: 11.98023) QuantErr: 11.98023 batch_time=0.35422 
Train Epoch: 7 [121/1000 3872/32000 (12%)] Loss: 1.04551 (QuantReg: 12.13964) QuantErr: 12.13964 batch_time=0.35876 
Train Epoch: 7 [126/1000 4032/32000 (13%)] Loss: 1.06484 (QuantReg: 11.64643) QuantErr: 11.64643 batch_time=0.49283 
Train Epoch: 7 [131/1000 4192/32000 (13%)] Loss: 0.50859 (QuantReg: 11.29215) QuantErr: 11.29215 batch_time=0.34984 
Train Epoch: 7 [136/1000 4352/32000 (14%)] Loss: 1.08883 (QuantReg: 11.26335) QuantErr: 11.26335 batch_time=0.45835 
Train Epoch: 7 [141/1000 4512/32000 (14%)] Loss: 0.82172 (QuantReg: 11.76148) QuantErr: 11.76148 batch_time=0.41066 
Train Epoch: 7 [146/1000 4672/32000 (15%)] Loss: 0.87169 (QuantReg: 11.99940) QuantErr: 11.99940 batch_time=0.35517 
Train Epoch: 7 [151/1000 4832/32000 (15%)] Loss: 1.03077 (QuantReg: 11.60234) QuantErr: 11.60234 batch_time=0.40071 
Train Epoch: 7 [156/1000 4992/32000 (16%)] Loss: 1.65619 (QuantReg: 11.31569) QuantErr: 11.31569 batch_time=0.33701 
Train Epoch: 7 [161/1000 5152/32000 (16%)] Loss: 1.04127 (QuantReg: 11.73242) QuantErr: 11.73242 batch_time=0.34658 
Train Epoch: 7 [166/1000 5312/32000 (17%)] Loss: 0.90923 (QuantReg: 12.16298) QuantErr: 12.16298 batch_time=0.34475 
Train Epoch: 7 [171/1000 5472/32000 (17%)] Loss: 0.78446 (QuantReg: 11.96054) QuantErr: 11.96054 batch_time=0.75206 
Train Epoch: 7 [176/1000 5632/32000 (18%)] Loss: 1.88374 (QuantReg: 11.29717) QuantErr: 11.29717 batch_time=0.42759 
Train Epoch: 7 [181/1000 5792/32000 (18%)] Loss: 0.67192 (QuantReg: 11.50864) QuantErr: 11.50864 batch_time=0.35692 
Train Epoch: 7 [186/1000 5952/32000 (19%)] Loss: 1.26567 (QuantReg: 11.29273) QuantErr: 11.29273 batch_time=0.33564 
Train Epoch: 7 [191/1000 6112/32000 (19%)] Loss: 0.93117 (QuantReg: 11.58093) QuantErr: 11.58093 batch_time=0.36614 
Train Epoch: 7 [196/1000 6272/32000 (20%)] Loss: 0.83121 (QuantReg: 11.70450) QuantErr: 11.70450 batch_time=0.33312 
Train Epoch: 7 [201/1000 6432/32000 (20%)] Loss: 0.88806 (QuantReg: 11.66167) QuantErr: 11.66167 batch_time=0.39263 
Train Epoch: 7 [206/1000 6592/32000 (21%)] Loss: 0.98781 (QuantReg: 11.81912) QuantErr: 11.81912 batch_time=0.35689 
Train Epoch: 7 [211/1000 6752/32000 (21%)] Loss: 0.89433 (QuantReg: 11.97710) QuantErr: 11.97710 batch_time=0.65842 
Train Epoch: 7 [216/1000 6912/32000 (22%)] Loss: 0.55757 (QuantReg: 11.83370) QuantErr: 11.83370 batch_time=0.48324 
Train Epoch: 7 [221/1000 7072/32000 (22%)] Loss: 0.89460 (QuantReg: 11.73147) QuantErr: 11.73147 batch_time=0.39877 
Train Epoch: 7 [226/1000 7232/32000 (23%)] Loss: 1.14863 (QuantReg: 12.33313) QuantErr: 12.33313 batch_time=0.44709 
Train Epoch: 7 [231/1000 7392/32000 (23%)] Loss: 1.29206 (QuantReg: 11.62898) QuantErr: 11.62898 batch_time=0.44459 
Train Epoch: 7 [236/1000 7552/32000 (24%)] Loss: 0.93300 (QuantReg: 11.65208) QuantErr: 11.65208 batch_time=0.37968 
Train Epoch: 7 [241/1000 7712/32000 (24%)] Loss: 1.30283 (QuantReg: 11.73392) QuantErr: 11.73392 batch_time=0.47133 
Train Epoch: 7 [246/1000 7872/32000 (25%)] Loss: 1.12213 (QuantReg: 11.79141) QuantErr: 11.79141 batch_time=0.38618 
Train Epoch: 7 [251/1000 8032/32000 (25%)] Loss: 0.80756 (QuantReg: 11.93987) QuantErr: 11.93987 batch_time=0.34794 
Train Epoch: 7 [256/1000 8192/32000 (26%)] Loss: 1.08890 (QuantReg: 11.95160) QuantErr: 11.95160 batch_time=0.53876 
Train Epoch: 7 [261/1000 8352/32000 (26%)] Loss: 0.44454 (QuantReg: 12.35836) QuantErr: 12.35836 batch_time=0.38119 
Train Epoch: 7 [266/1000 8512/32000 (27%)] Loss: 0.80601 (QuantReg: 11.87092) QuantErr: 11.87092 batch_time=0.35540 
Train Epoch: 7 [271/1000 8672/32000 (27%)] Loss: 0.89256 (QuantReg: 11.43284) QuantErr: 11.43284 batch_time=0.47640 
Train Epoch: 7 [276/1000 8832/32000 (28%)] Loss: 0.41932 (QuantReg: 11.85210) QuantErr: 11.85210 batch_time=0.34826 
Train Epoch: 7 [281/1000 8992/32000 (28%)] Loss: 0.72056 (QuantReg: 12.07115) QuantErr: 12.07115 batch_time=0.41491 
Train Epoch: 7 [286/1000 9152/32000 (29%)] Loss: 2.19275 (QuantReg: 12.00641) QuantErr: 12.00641 batch_time=0.38994 
Train Epoch: 7 [291/1000 9312/32000 (29%)] Loss: 1.12450 (QuantReg: 11.73512) QuantErr: 11.73512 batch_time=0.41209 
Train Epoch: 7 [296/1000 9472/32000 (30%)] Loss: 0.85927 (QuantReg: 11.71687) QuantErr: 11.71687 batch_time=0.36444 
Train Epoch: 7 [301/1000 9632/32000 (30%)] Loss: 0.86774 (QuantReg: 12.32092) QuantErr: 12.32092 batch_time=0.45814 
Train Epoch: 7 [306/1000 9792/32000 (31%)] Loss: 1.21392 (QuantReg: 11.73956) QuantErr: 11.73956 batch_time=0.36568 
Train Epoch: 7 [311/1000 9952/32000 (31%)] Loss: 0.87373 (QuantReg: 12.42742) QuantErr: 12.42742 batch_time=0.38546 
Train Epoch: 7 [316/1000 10112/32000 (32%)] Loss: 0.50155 (QuantReg: 12.00755) QuantErr: 12.00755 batch_time=0.35991 
Train Epoch: 7 [321/1000 10272/32000 (32%)] Loss: 0.73725 (QuantReg: 11.54822) QuantErr: 11.54822 batch_time=0.37366 
Train Epoch: 7 [326/1000 10432/32000 (33%)] Loss: 1.14375 (QuantReg: 12.28806) QuantErr: 12.28806 batch_time=0.35418 
Train Epoch: 7 [331/1000 10592/32000 (33%)] Loss: 1.19054 (QuantReg: 12.24262) QuantErr: 12.24262 batch_time=0.36138 
Train Epoch: 7 [336/1000 10752/32000 (34%)] Loss: 0.89276 (QuantReg: 12.52443) QuantErr: 12.52443 batch_time=0.35000 
Train Epoch: 7 [341/1000 10912/32000 (34%)] Loss: 0.82471 (QuantReg: 11.91712) QuantErr: 11.91712 batch_time=0.37112 
Train Epoch: 7 [346/1000 11072/32000 (35%)] Loss: 1.12475 (QuantReg: 11.83348) QuantErr: 11.83348 batch_time=0.79215 
Train Epoch: 7 [351/1000 11232/32000 (35%)] Loss: 0.89816 (QuantReg: 12.34171) QuantErr: 12.34171 batch_time=0.53566 
Train Epoch: 7 [356/1000 11392/32000 (36%)] Loss: 0.88300 (QuantReg: 12.52925) QuantErr: 12.52925 batch_time=0.35964 
Train Epoch: 7 [361/1000 11552/32000 (36%)] Loss: 0.85349 (QuantReg: 12.28368) QuantErr: 12.28368 batch_time=0.50350 
Train Epoch: 7 [366/1000 11712/32000 (37%)] Loss: 0.91603 (QuantReg: 12.32866) QuantErr: 12.32866 batch_time=0.40567 
Train Epoch: 7 [371/1000 11872/32000 (37%)] Loss: 1.41726 (QuantReg: 11.89834) QuantErr: 11.89834 batch_time=0.36161 
Train Epoch: 7 [376/1000 12032/32000 (38%)] Loss: 0.60108 (QuantReg: 12.35063) QuantErr: 12.35063 batch_time=0.36407 
Train Epoch: 7 [381/1000 12192/32000 (38%)] Loss: 1.23556 (QuantReg: 11.88299) QuantErr: 11.88299 batch_time=0.35384 
Train Epoch: 7 [386/1000 12352/32000 (39%)] Loss: 0.72411 (QuantReg: 11.90871) QuantErr: 11.90871 batch_time=0.49254 
Train Epoch: 7 [391/1000 12512/32000 (39%)] Loss: 0.44156 (QuantReg: 11.55346) QuantErr: 11.55346 batch_time=0.52222 
Train Epoch: 7 [396/1000 12672/32000 (40%)] Loss: 1.13557 (QuantReg: 10.85609) QuantErr: 10.85609 batch_time=0.54337 
Train Epoch: 7 [401/1000 12832/32000 (40%)] Loss: 1.02953 (QuantReg: 12.02199) QuantErr: 12.02199 batch_time=0.35505 
Train Epoch: 7 [406/1000 12992/32000 (41%)] Loss: 0.89157 (QuantReg: 11.30787) QuantErr: 11.30787 batch_time=0.34344 
Train Epoch: 7 [411/1000 13152/32000 (41%)] Loss: 1.37284 (QuantReg: 12.01440) QuantErr: 12.01440 batch_time=0.39913 
Train Epoch: 7 [416/1000 13312/32000 (42%)] Loss: 0.90150 (QuantReg: 11.83384) QuantErr: 11.83384 batch_time=0.49614 
Train Epoch: 7 [421/1000 13472/32000 (42%)] Loss: 1.11690 (QuantReg: 11.81795) QuantErr: 11.81795 batch_time=0.39880 
Train Epoch: 7 [426/1000 13632/32000 (43%)] Loss: 1.10179 (QuantReg: 12.25618) QuantErr: 12.25618 batch_time=0.35923 
Train Epoch: 7 [431/1000 13792/32000 (43%)] Loss: 0.59959 (QuantReg: 12.51456) QuantErr: 12.51456 batch_time=0.40219 
Train Epoch: 7 [436/1000 13952/32000 (44%)] Loss: 0.69799 (QuantReg: 11.92959) QuantErr: 11.92959 batch_time=0.54682 
Train Epoch: 7 [441/1000 14112/32000 (44%)] Loss: 0.79199 (QuantReg: 12.02355) QuantErr: 12.02355 batch_time=0.49628 
Train Epoch: 7 [446/1000 14272/32000 (45%)] Loss: 0.90656 (QuantReg: 11.93681) QuantErr: 11.93681 batch_time=0.39564 
Train Epoch: 7 [451/1000 14432/32000 (45%)] Loss: 1.42522 (QuantReg: 11.78117) QuantErr: 11.78117 batch_time=0.39307 
Train Epoch: 7 [456/1000 14592/32000 (46%)] Loss: 0.64416 (QuantReg: 11.40140) QuantErr: 11.40140 batch_time=0.42198 
Train Epoch: 7 [461/1000 14752/32000 (46%)] Loss: 0.73181 (QuantReg: 12.24916) QuantErr: 12.24916 batch_time=0.51491 
Train Epoch: 7 [466/1000 14912/32000 (47%)] Loss: 1.16422 (QuantReg: 11.82497) QuantErr: 11.82497 batch_time=0.48389 
Train Epoch: 7 [471/1000 15072/32000 (47%)] Loss: 1.00161 (QuantReg: 11.84748) QuantErr: 11.84748 batch_time=0.39141 
Train Epoch: 7 [476/1000 15232/32000 (48%)] Loss: 0.94138 (QuantReg: 12.35863) QuantErr: 12.35863 batch_time=0.41265 
Train Epoch: 7 [481/1000 15392/32000 (48%)] Loss: 0.54644 (QuantReg: 12.37195) QuantErr: 12.37195 batch_time=0.76912 
Train Epoch: 7 [486/1000 15552/32000 (49%)] Loss: 1.01908 (QuantReg: 11.54469) QuantErr: 11.54469 batch_time=0.36917 
Train Epoch: 7 [491/1000 15712/32000 (49%)] Loss: 1.40468 (QuantReg: 11.89184) QuantErr: 11.89184 batch_time=0.36068 
Train Epoch: 7 [496/1000 15872/32000 (50%)] Loss: 1.65664 (QuantReg: 12.28794) QuantErr: 12.28794 batch_time=0.36487 
Train Epoch: 7 [501/1000 16032/32000 (50%)] Loss: 0.63818 (QuantReg: 11.50348) QuantErr: 11.50348 batch_time=0.36944 
Train Epoch: 7 [506/1000 16192/32000 (51%)] Loss: 0.92651 (QuantReg: 12.22029) QuantErr: 12.22029 batch_time=0.43158 
Train Epoch: 7 [511/1000 16352/32000 (51%)] Loss: 0.74765 (QuantReg: 11.47659) QuantErr: 11.47659 batch_time=0.38853 
Train Epoch: 7 [516/1000 16512/32000 (52%)] Loss: 0.92310 (QuantReg: 12.24624) QuantErr: 12.24624 batch_time=0.41834 
Train Epoch: 7 [521/1000 16672/32000 (52%)] Loss: 0.61070 (QuantReg: 11.95042) QuantErr: 11.95042 batch_time=0.42795 
Train Epoch: 7 [526/1000 16832/32000 (53%)] Loss: 1.14947 (QuantReg: 12.24106) QuantErr: 12.24106 batch_time=0.38939 
Train Epoch: 7 [531/1000 16992/32000 (53%)] Loss: 1.40382 (QuantReg: 11.55147) QuantErr: 11.55147 batch_time=0.45241 
Train Epoch: 7 [536/1000 17152/32000 (54%)] Loss: 2.06649 (QuantReg: 11.76496) QuantErr: 11.76496 batch_time=0.35592 
Train Epoch: 7 [541/1000 17312/32000 (54%)] Loss: 1.72830 (QuantReg: 11.93619) QuantErr: 11.93619 batch_time=0.36722 
Train Epoch: 7 [546/1000 17472/32000 (55%)] Loss: 0.67961 (QuantReg: 11.53194) QuantErr: 11.53194 batch_time=0.42912 
Train Epoch: 7 [551/1000 17632/32000 (55%)] Loss: 0.82643 (QuantReg: 12.22942) QuantErr: 12.22942 batch_time=0.35531 
Train Epoch: 7 [556/1000 17792/32000 (56%)] Loss: 0.98430 (QuantReg: 12.42500) QuantErr: 12.42500 batch_time=0.42865 
Train Epoch: 7 [561/1000 17952/32000 (56%)] Loss: 1.00617 (QuantReg: 12.29712) QuantErr: 12.29712 batch_time=2.89299 
Train Epoch: 7 [566/1000 18112/32000 (57%)] Loss: 0.40172 (QuantReg: 11.94266) QuantErr: 11.94266 batch_time=0.47517 
Train Epoch: 7 [571/1000 18272/32000 (57%)] Loss: 1.17757 (QuantReg: 11.97734) QuantErr: 11.97734 batch_time=0.39640 
Train Epoch: 7 [576/1000 18432/32000 (58%)] Loss: 0.74436 (QuantReg: 11.96173) QuantErr: 11.96173 batch_time=0.38558 
Train Epoch: 7 [581/1000 18592/32000 (58%)] Loss: 1.11393 (QuantReg: 11.94063) QuantErr: 11.94063 batch_time=0.39522 
Train Epoch: 7 [586/1000 18752/32000 (59%)] Loss: 0.66947 (QuantReg: 12.13692) QuantErr: 12.13692 batch_time=0.41026 
Train Epoch: 7 [591/1000 18912/32000 (59%)] Loss: 0.64596 (QuantReg: 11.85982) QuantErr: 11.85982 batch_time=0.38947 
Train Epoch: 7 [596/1000 19072/32000 (60%)] Loss: 0.69241 (QuantReg: 12.30659) QuantErr: 12.30659 batch_time=0.47059 
Train Epoch: 7 [601/1000 19232/32000 (60%)] Loss: 0.76707 (QuantReg: 12.31301) QuantErr: 12.31301 batch_time=0.56973 
Train Epoch: 7 [606/1000 19392/32000 (61%)] Loss: 0.68182 (QuantReg: 12.08921) QuantErr: 12.08921 batch_time=0.35419 
Train Epoch: 7 [611/1000 19552/32000 (61%)] Loss: 0.73893 (QuantReg: 12.10324) QuantErr: 12.10324 batch_time=0.72012 
Train Epoch: 7 [616/1000 19712/32000 (62%)] Loss: 0.75802 (QuantReg: 12.28212) QuantErr: 12.28212 batch_time=0.35161 
Train Epoch: 7 [621/1000 19872/32000 (62%)] Loss: 1.50575 (QuantReg: 12.52241) QuantErr: 12.52241 batch_time=0.55249 
Train Epoch: 7 [626/1000 20032/32000 (63%)] Loss: 1.13968 (QuantReg: 12.13879) QuantErr: 12.13879 batch_time=0.38772 
Train Epoch: 7 [631/1000 20192/32000 (63%)] Loss: 0.76706 (QuantReg: 12.17295) QuantErr: 12.17295 batch_time=0.42331 
Train Epoch: 7 [636/1000 20352/32000 (64%)] Loss: 0.69923 (QuantReg: 11.74075) QuantErr: 11.74075 batch_time=0.45636 
Train Epoch: 7 [641/1000 20512/32000 (64%)] Loss: 1.42874 (QuantReg: 12.28408) QuantErr: 12.28408 batch_time=0.35453 
Train Epoch: 7 [646/1000 20672/32000 (65%)] Loss: 1.36593 (QuantReg: 12.37208) QuantErr: 12.37208 batch_time=0.34106 
Train Epoch: 7 [651/1000 20832/32000 (65%)] Loss: 1.42584 (QuantReg: 11.99236) QuantErr: 11.99236 batch_time=0.71790 
Train Epoch: 7 [656/1000 20992/32000 (66%)] Loss: 0.73669 (QuantReg: 12.17462) QuantErr: 12.17462 batch_time=0.36756 
Train Epoch: 7 [661/1000 21152/32000 (66%)] Loss: 0.75795 (QuantReg: 12.74202) QuantErr: 12.74202 batch_time=0.41186 
Train Epoch: 7 [666/1000 21312/32000 (67%)] Loss: 1.25284 (QuantReg: 11.52851) QuantErr: 11.52851 batch_time=0.35253 
Train Epoch: 7 [671/1000 21472/32000 (67%)] Loss: 1.13254 (QuantReg: 12.48607) QuantErr: 12.48607 batch_time=0.36688 
Train Epoch: 7 [676/1000 21632/32000 (68%)] Loss: 1.38706 (QuantReg: 12.09740) QuantErr: 12.09740 batch_time=0.39394 
Train Epoch: 7 [681/1000 21792/32000 (68%)] Loss: 1.02546 (QuantReg: 12.58837) QuantErr: 12.58837 batch_time=0.35430 
Train Epoch: 7 [686/1000 21952/32000 (69%)] Loss: 0.93170 (QuantReg: 12.22994) QuantErr: 12.22994 batch_time=0.38667 
Train Epoch: 7 [691/1000 22112/32000 (69%)] Loss: 1.41616 (QuantReg: 11.68013) QuantErr: 11.68013 batch_time=0.36439 
Train Epoch: 7 [696/1000 22272/32000 (70%)] Loss: 1.12258 (QuantReg: 11.85864) QuantErr: 11.85864 batch_time=0.57651 
Train Epoch: 7 [701/1000 22432/32000 (70%)] Loss: 0.99901 (QuantReg: 12.25782) QuantErr: 12.25782 batch_time=0.44391 
Train Epoch: 7 [706/1000 22592/32000 (71%)] Loss: 0.65008 (QuantReg: 12.64026) QuantErr: 12.64026 batch_time=0.43221 
Train Epoch: 7 [711/1000 22752/32000 (71%)] Loss: 0.89022 (QuantReg: 12.21221) QuantErr: 12.21221 batch_time=0.35605 
Train Epoch: 7 [716/1000 22912/32000 (72%)] Loss: 0.56705 (QuantReg: 12.20008) QuantErr: 12.20008 batch_time=0.38103 
Train Epoch: 7 [721/1000 23072/32000 (72%)] Loss: 1.61839 (QuantReg: 12.04411) QuantErr: 12.04411 batch_time=0.38687 
Train Epoch: 7 [726/1000 23232/32000 (73%)] Loss: 0.97889 (QuantReg: 11.59655) QuantErr: 11.59655 batch_time=0.39869 
Train Epoch: 7 [731/1000 23392/32000 (73%)] Loss: 0.76288 (QuantReg: 11.95507) QuantErr: 11.95507 batch_time=0.52365 
Train Epoch: 7 [736/1000 23552/32000 (74%)] Loss: 0.48026 (QuantReg: 12.32942) QuantErr: 12.32942 batch_time=0.40196 
Train Epoch: 7 [741/1000 23712/32000 (74%)] Loss: 0.57820 (QuantReg: 12.41879) QuantErr: 12.41879 batch_time=0.51551 
Train Epoch: 7 [746/1000 23872/32000 (75%)] Loss: 1.00039 (QuantReg: 12.04449) QuantErr: 12.04449 batch_time=0.43099 
Train Epoch: 7 [751/1000 24032/32000 (75%)] Loss: 1.55694 (QuantReg: 11.40886) QuantErr: 11.40886 batch_time=0.37670 
Train Epoch: 7 [756/1000 24192/32000 (76%)] Loss: 1.20595 (QuantReg: 12.17365) QuantErr: 12.17365 batch_time=0.38939 
Train Epoch: 7 [761/1000 24352/32000 (76%)] Loss: 1.20500 (QuantReg: 12.57913) QuantErr: 12.57913 batch_time=0.37646 
Train Epoch: 7 [766/1000 24512/32000 (77%)] Loss: 0.93588 (QuantReg: 12.38243) QuantErr: 12.38243 batch_time=0.35737 
Train Epoch: 7 [771/1000 24672/32000 (77%)] Loss: 0.66065 (QuantReg: 12.31326) QuantErr: 12.31326 batch_time=0.40466 
Train Epoch: 7 [776/1000 24832/32000 (78%)] Loss: 1.09317 (QuantReg: 11.98308) QuantErr: 11.98308 batch_time=0.58045 
Train Epoch: 7 [781/1000 24992/32000 (78%)] Loss: 0.95062 (QuantReg: 12.40662) QuantErr: 12.40662 batch_time=0.35212 
Train Epoch: 7 [786/1000 25152/32000 (79%)] Loss: 0.73339 (QuantReg: 12.05167) QuantErr: 12.05167 batch_time=0.54064 
Train Epoch: 7 [791/1000 25312/32000 (79%)] Loss: 1.06385 (QuantReg: 12.40811) QuantErr: 12.40811 batch_time=0.47774 
Train Epoch: 7 [796/1000 25472/32000 (80%)] Loss: 0.90993 (QuantReg: 12.39651) QuantErr: 12.39651 batch_time=0.34582 
Train Epoch: 7 [801/1000 25632/32000 (80%)] Loss: 0.94501 (QuantReg: 11.77167) QuantErr: 11.77167 batch_time=0.42384 
Train Epoch: 7 [806/1000 25792/32000 (81%)] Loss: 0.67579 (QuantReg: 12.20575) QuantErr: 12.20575 batch_time=0.46254 
Train Epoch: 7 [811/1000 25952/32000 (81%)] Loss: 0.51630 (QuantReg: 12.22562) QuantErr: 12.22562 batch_time=0.41247 
Train Epoch: 7 [816/1000 26112/32000 (82%)] Loss: 1.16253 (QuantReg: 12.60198) QuantErr: 12.60198 batch_time=0.37930 
Train Epoch: 7 [821/1000 26272/32000 (82%)] Loss: 1.35035 (QuantReg: 12.16347) QuantErr: 12.16347 batch_time=0.40677 
Train Epoch: 7 [826/1000 26432/32000 (83%)] Loss: 0.96723 (QuantReg: 11.86394) QuantErr: 11.86394 batch_time=0.51335 
Train Epoch: 7 [831/1000 26592/32000 (83%)] Loss: 1.15439 (QuantReg: 11.86518) QuantErr: 11.86518 batch_time=0.37177 
Train Epoch: 7 [836/1000 26752/32000 (84%)] Loss: 0.85077 (QuantReg: 12.41879) QuantErr: 12.41879 batch_time=0.83251 
Train Epoch: 7 [841/1000 26912/32000 (84%)] Loss: 0.69005 (QuantReg: 12.29577) QuantErr: 12.29577 batch_time=0.38392 
Train Epoch: 7 [846/1000 27072/32000 (85%)] Loss: 1.33466 (QuantReg: 12.20232) QuantErr: 12.20232 batch_time=0.33305 
Train Epoch: 7 [851/1000 27232/32000 (85%)] Loss: 0.81892 (QuantReg: 12.05161) QuantErr: 12.05161 batch_time=0.37056 
Train Epoch: 7 [856/1000 27392/32000 (86%)] Loss: 0.52558 (QuantReg: 12.40203) QuantErr: 12.40203 batch_time=0.38500 
Train Epoch: 7 [861/1000 27552/32000 (86%)] Loss: 0.80085 (QuantReg: 12.70340) QuantErr: 12.70340 batch_time=0.41878 
Train Epoch: 7 [866/1000 27712/32000 (87%)] Loss: 1.19867 (QuantReg: 11.77786) QuantErr: 11.77786 batch_time=0.47786 
Train Epoch: 7 [871/1000 27872/32000 (87%)] Loss: 0.39130 (QuantReg: 12.57012) QuantErr: 12.57012 batch_time=0.40654 
Train Epoch: 7 [876/1000 28032/32000 (88%)] Loss: 0.87611 (QuantReg: 12.57526) QuantErr: 12.57526 batch_time=0.74004 
Train Epoch: 7 [881/1000 28192/32000 (88%)] Loss: 1.11781 (QuantReg: 12.46900) QuantErr: 12.46900 batch_time=1.82544 
Train Epoch: 7 [886/1000 28352/32000 (89%)] Loss: 0.83652 (QuantReg: 12.31403) QuantErr: 12.31403 batch_time=0.39454 
Train Epoch: 7 [891/1000 28512/32000 (89%)] Loss: 0.60997 (QuantReg: 11.95872) QuantErr: 11.95872 batch_time=0.36880 
Train Epoch: 7 [896/1000 28672/32000 (90%)] Loss: 0.78194 (QuantReg: 12.37601) QuantErr: 12.37601 batch_time=0.35625 
Train Epoch: 7 [901/1000 28832/32000 (90%)] Loss: 0.77895 (QuantReg: 12.10126) QuantErr: 12.10126 batch_time=0.43865 
Train Epoch: 7 [906/1000 28992/32000 (91%)] Loss: 1.11821 (QuantReg: 11.99196) QuantErr: 11.99196 batch_time=0.34973 
Train Epoch: 7 [911/1000 29152/32000 (91%)] Loss: 0.52557 (QuantReg: 12.40026) QuantErr: 12.40026 batch_time=0.38681 
Train Epoch: 7 [916/1000 29312/32000 (92%)] Loss: 0.60610 (QuantReg: 13.20870) QuantErr: 13.20870 batch_time=0.34550 
Train Epoch: 7 [921/1000 29472/32000 (92%)] Loss: 0.74449 (QuantReg: 12.13276) QuantErr: 12.13276 batch_time=0.73236 
Train Epoch: 7 [926/1000 29632/32000 (93%)] Loss: 1.05307 (QuantReg: 12.62609) QuantErr: 12.62609 batch_time=0.42068 
Train Epoch: 7 [931/1000 29792/32000 (93%)] Loss: 1.13389 (QuantReg: 12.11802) QuantErr: 12.11802 batch_time=0.48135 
Train Epoch: 7 [936/1000 29952/32000 (94%)] Loss: 1.50264 (QuantReg: 12.30631) QuantErr: 12.30631 batch_time=0.35017 
Train Epoch: 7 [941/1000 30112/32000 (94%)] Loss: 1.22597 (QuantReg: 11.81841) QuantErr: 11.81841 batch_time=0.36688 
Train Epoch: 7 [946/1000 30272/32000 (95%)] Loss: 0.46496 (QuantReg: 12.52408) QuantErr: 12.52408 batch_time=0.37546 
Train Epoch: 7 [951/1000 30432/32000 (95%)] Loss: 0.84147 (QuantReg: 12.30892) QuantErr: 12.30892 batch_time=0.39450 
Train Epoch: 7 [956/1000 30592/32000 (96%)] Loss: 0.60014 (QuantReg: 11.78546) QuantErr: 11.78546 batch_time=0.41497 
Train Epoch: 7 [961/1000 30752/32000 (96%)] Loss: 0.85435 (QuantReg: 12.30404) QuantErr: 12.30404 batch_time=0.33217 
Train Epoch: 7 [966/1000 30912/32000 (97%)] Loss: 0.68367 (QuantReg: 12.19924) QuantErr: 12.19924 batch_time=0.65091 
Train Epoch: 7 [971/1000 31072/32000 (97%)] Loss: 0.76503 (QuantReg: 12.25730) QuantErr: 12.25730 batch_time=0.40742 
Train Epoch: 7 [976/1000 31232/32000 (98%)] Loss: 1.11160 (QuantReg: 12.79629) QuantErr: 12.79629 batch_time=0.39116 
Train Epoch: 7 [981/1000 31392/32000 (98%)] Loss: 1.16101 (QuantReg: 12.14011) QuantErr: 12.14011 batch_time=0.36401 
Train Epoch: 7 [986/1000 31552/32000 (99%)] Loss: 0.72441 (QuantReg: 12.60324) QuantErr: 12.60324 batch_time=0.39206 
Train Epoch: 7 [991/1000 31712/32000 (99%)] Loss: 0.89606 (QuantReg: 12.72185) QuantErr: 12.72185 batch_time=0.34881 
Train Epoch: 7 [996/1000 31872/32000 (100%)] Loss: 2.08072 (QuantReg: 11.92685) QuantErr: 11.92685 batch_time=0.61161 
Train Epoch: 7 codebook_update_time=3.15372
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch7.pth ...
Done in 7.574s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch7.pth ...
Done in 12.741s
removing stale ckpt [epoch 6] [took 0.04s]
 epoch          : 7
 loss           : 0.9608756829202175
 quant_reg      : 12.005127848625182
 quant_err      : 12.005127848625182
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 7000
 MSRVTT_miech_test/t2v_metrics/R1: 16.0
 MSRVTT_miech_test/t2v_metrics/R5: 42.7
 MSRVTT_miech_test/t2v_metrics/R10: 56.5
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 8.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.297
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.79601040640916
 MSRVTT_miech_test/v2t_metrics/R1: 16.8
 MSRVTT_miech_test/v2t_metrics/R5: 43.0
 MSRVTT_miech_test/v2t_metrics/R10: 56.7
 MSRVTT_miech_test/v2t_metrics/R50: 86.6
 MSRVTT_miech_test/v2t_metrics/MedR: 7.25
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.838
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.47097748252355
 mnt_best       : 33.79601040640916
 not_improved_count: 0
Train Epoch: 8 [1/1000 32/32000 (0%)] Loss: 0.59433 (QuantReg: 12.34410) QuantErr: 12.34410 batch_time=29.99106 
Train Epoch: 8 [6/1000 192/32000 (1%)] Loss: 1.19477 (QuantReg: 11.82455) QuantErr: 11.82455 batch_time=0.51930 
Train Epoch: 8 [11/1000 352/32000 (1%)] Loss: 0.46807 (QuantReg: 11.76535) QuantErr: 11.76535 batch_time=0.34582 
Train Epoch: 8 [16/1000 512/32000 (2%)] Loss: 0.91088 (QuantReg: 11.95380) QuantErr: 11.95380 batch_time=0.41227 
Train Epoch: 8 [21/1000 672/32000 (2%)] Loss: 0.99299 (QuantReg: 11.94147) QuantErr: 11.94147 batch_time=0.39929 
Train Epoch: 8 [26/1000 832/32000 (3%)] Loss: 0.72602 (QuantReg: 11.90871) QuantErr: 11.90871 batch_time=0.35674 
Train Epoch: 8 [31/1000 992/32000 (3%)] Loss: 1.26470 (QuantReg: 10.96200) QuantErr: 10.96200 batch_time=0.34528 
Train Epoch: 8 [36/1000 1152/32000 (4%)] Loss: 0.89534 (QuantReg: 11.48818) QuantErr: 11.48818 batch_time=0.35729 
Train Epoch: 8 [41/1000 1312/32000 (4%)] Loss: 1.29194 (QuantReg: 11.92543) QuantErr: 11.92543 batch_time=0.60165 
Train Epoch: 8 [46/1000 1472/32000 (5%)] Loss: 0.72874 (QuantReg: 11.88144) QuantErr: 11.88144 batch_time=0.34338 
Train Epoch: 8 [51/1000 1632/32000 (5%)] Loss: 0.80870 (QuantReg: 12.20072) QuantErr: 12.20072 batch_time=0.69976 
Train Epoch: 8 [56/1000 1792/32000 (6%)] Loss: 0.74900 (QuantReg: 12.32150) QuantErr: 12.32150 batch_time=0.44714 
Train Epoch: 8 [61/1000 1952/32000 (6%)] Loss: 1.09074 (QuantReg: 11.21122) QuantErr: 11.21122 batch_time=0.43913 
Train Epoch: 8 [66/1000 2112/32000 (7%)] Loss: 0.59175 (QuantReg: 11.32026) QuantErr: 11.32026 batch_time=0.77710 
Train Epoch: 8 [71/1000 2272/32000 (7%)] Loss: 0.55607 (QuantReg: 11.80562) QuantErr: 11.80562 batch_time=0.43398 
Train Epoch: 8 [76/1000 2432/32000 (8%)] Loss: 1.25319 (QuantReg: 12.12234) QuantErr: 12.12234 batch_time=0.37326 
Train Epoch: 8 [81/1000 2592/32000 (8%)] Loss: 0.78821 (QuantReg: 11.77597) QuantErr: 11.77597 batch_time=0.35161 
Train Epoch: 8 [86/1000 2752/32000 (9%)] Loss: 1.77883 (QuantReg: 11.84482) QuantErr: 11.84482 batch_time=0.35853 
Train Epoch: 8 [91/1000 2912/32000 (9%)] Loss: 0.81859 (QuantReg: 11.91403) QuantErr: 11.91403 batch_time=0.82256 
Train Epoch: 8 [96/1000 3072/32000 (10%)] Loss: 1.34219 (QuantReg: 11.95314) QuantErr: 11.95314 batch_time=0.35820 
Train Epoch: 8 [101/1000 3232/32000 (10%)] Loss: 0.39723 (QuantReg: 12.13922) QuantErr: 12.13922 batch_time=0.34946 
Train Epoch: 8 [106/1000 3392/32000 (11%)] Loss: 0.63792 (QuantReg: 11.67642) QuantErr: 11.67642 batch_time=0.36020 
Train Epoch: 8 [111/1000 3552/32000 (11%)] Loss: 0.88676 (QuantReg: 12.35034) QuantErr: 12.35034 batch_time=0.34958 
Train Epoch: 8 [116/1000 3712/32000 (12%)] Loss: 0.31793 (QuantReg: 12.14375) QuantErr: 12.14375 batch_time=0.35098 
Train Epoch: 8 [121/1000 3872/32000 (12%)] Loss: 0.82655 (QuantReg: 12.53626) QuantErr: 12.53626 batch_time=0.41518 
Train Epoch: 8 [126/1000 4032/32000 (13%)] Loss: 1.42526 (QuantReg: 11.74784) QuantErr: 11.74784 batch_time=0.34112 
Train Epoch: 8 [131/1000 4192/32000 (13%)] Loss: 0.78141 (QuantReg: 12.07770) QuantErr: 12.07770 batch_time=0.35237 
Train Epoch: 8 [136/1000 4352/32000 (14%)] Loss: 0.49797 (QuantReg: 12.40164) QuantErr: 12.40164 batch_time=0.70608 
Train Epoch: 8 [141/1000 4512/32000 (14%)] Loss: 0.52097 (QuantReg: 12.34096) QuantErr: 12.34096 batch_time=0.41386 
Train Epoch: 8 [146/1000 4672/32000 (15%)] Loss: 0.88719 (QuantReg: 11.81539) QuantErr: 11.81539 batch_time=1.17854 
Train Epoch: 8 [151/1000 4832/32000 (15%)] Loss: 0.77892 (QuantReg: 11.98185) QuantErr: 11.98185 batch_time=0.36104 
Train Epoch: 8 [156/1000 4992/32000 (16%)] Loss: 0.88339 (QuantReg: 11.98306) QuantErr: 11.98306 batch_time=0.35752 
Train Epoch: 8 [161/1000 5152/32000 (16%)] Loss: 1.69436 (QuantReg: 11.73191) QuantErr: 11.73191 batch_time=0.41025 
Train Epoch: 8 [166/1000 5312/32000 (17%)] Loss: 0.76997 (QuantReg: 11.96502) QuantErr: 11.96502 batch_time=0.37412 
Train Epoch: 8 [171/1000 5472/32000 (17%)] Loss: 0.68541 (QuantReg: 11.51866) QuantErr: 11.51866 batch_time=0.58089 
Train Epoch: 8 [176/1000 5632/32000 (18%)] Loss: 0.80568 (QuantReg: 11.95184) QuantErr: 11.95184 batch_time=1.70915 
Train Epoch: 8 [181/1000 5792/32000 (18%)] Loss: 0.99078 (QuantReg: 11.86618) QuantErr: 11.86618 batch_time=0.63777 
Train Epoch: 8 [186/1000 5952/32000 (19%)] Loss: 0.88012 (QuantReg: 11.66274) QuantErr: 11.66274 batch_time=0.40184 
Train Epoch: 8 [191/1000 6112/32000 (19%)] Loss: 1.02934 (QuantReg: 12.25407) QuantErr: 12.25407 batch_time=0.50294 
Train Epoch: 8 [196/1000 6272/32000 (20%)] Loss: 0.83410 (QuantReg: 12.03370) QuantErr: 12.03370 batch_time=0.35480 
Train Epoch: 8 [201/1000 6432/32000 (20%)] Loss: 0.60409 (QuantReg: 11.28171) QuantErr: 11.28171 batch_time=0.36311 
Train Epoch: 8 [206/1000 6592/32000 (21%)] Loss: 0.75486 (QuantReg: 11.69075) QuantErr: 11.69075 batch_time=0.35852 
Train Epoch: 8 [211/1000 6752/32000 (21%)] Loss: 1.35954 (QuantReg: 11.84691) QuantErr: 11.84691 batch_time=0.36316 
Train Epoch: 8 [216/1000 6912/32000 (22%)] Loss: 0.81977 (QuantReg: 12.12396) QuantErr: 12.12396 batch_time=0.34228 
Train Epoch: 8 [221/1000 7072/32000 (22%)] Loss: 0.84103 (QuantReg: 11.21214) QuantErr: 11.21214 batch_time=0.82639 
Train Epoch: 8 [226/1000 7232/32000 (23%)] Loss: 0.50779 (QuantReg: 11.40697) QuantErr: 11.40697 batch_time=0.34809 
Train Epoch: 8 [231/1000 7392/32000 (23%)] Loss: 1.05982 (QuantReg: 12.00687) QuantErr: 12.00687 batch_time=0.50099 
Train Epoch: 8 [236/1000 7552/32000 (24%)] Loss: 1.02012 (QuantReg: 11.43104) QuantErr: 11.43104 batch_time=0.37499 
Train Epoch: 8 [241/1000 7712/32000 (24%)] Loss: 0.54057 (QuantReg: 12.37547) QuantErr: 12.37547 batch_time=0.38907 
Train Epoch: 8 [246/1000 7872/32000 (25%)] Loss: 0.83864 (QuantReg: 11.90458) QuantErr: 11.90458 batch_time=0.39222 
Train Epoch: 8 [251/1000 8032/32000 (25%)] Loss: 0.92134 (QuantReg: 11.85879) QuantErr: 11.85879 batch_time=0.38035 
Train Epoch: 8 [256/1000 8192/32000 (26%)] Loss: 1.47128 (QuantReg: 11.30294) QuantErr: 11.30294 batch_time=0.38594 
Train Epoch: 8 [261/1000 8352/32000 (26%)] Loss: 0.74827 (QuantReg: 11.69961) QuantErr: 11.69961 batch_time=0.35798 
Train Epoch: 8 [266/1000 8512/32000 (27%)] Loss: 0.56692 (QuantReg: 12.40650) QuantErr: 12.40650 batch_time=0.56824 
Train Epoch: 8 [271/1000 8672/32000 (27%)] Loss: 1.20585 (QuantReg: 11.35235) QuantErr: 11.35235 batch_time=0.49647 
Train Epoch: 8 [276/1000 8832/32000 (28%)] Loss: 0.97666 (QuantReg: 12.43596) QuantErr: 12.43596 batch_time=0.40326 
Train Epoch: 8 [281/1000 8992/32000 (28%)] Loss: 0.78082 (QuantReg: 11.87974) QuantErr: 11.87974 batch_time=0.34213 
Train Epoch: 8 [286/1000 9152/32000 (29%)] Loss: 1.33675 (QuantReg: 11.65683) QuantErr: 11.65683 batch_time=0.44412 
Train Epoch: 8 [291/1000 9312/32000 (29%)] Loss: 0.80942 (QuantReg: 11.78273) QuantErr: 11.78273 batch_time=0.37490 
Train Epoch: 8 [296/1000 9472/32000 (30%)] Loss: 1.48662 (QuantReg: 12.18147) QuantErr: 12.18147 batch_time=0.37566 
Train Epoch: 8 [301/1000 9632/32000 (30%)] Loss: 1.26811 (QuantReg: 11.81314) QuantErr: 11.81314 batch_time=1.52667 
Train Epoch: 8 [306/1000 9792/32000 (31%)] Loss: 0.53353 (QuantReg: 11.80239) QuantErr: 11.80239 batch_time=0.51533 
Train Epoch: 8 [311/1000 9952/32000 (31%)] Loss: 1.51017 (QuantReg: 11.77065) QuantErr: 11.77065 batch_time=0.42635 
Train Epoch: 8 [316/1000 10112/32000 (32%)] Loss: 1.04484 (QuantReg: 11.78493) QuantErr: 11.78493 batch_time=0.50744 
Train Epoch: 8 [321/1000 10272/32000 (32%)] Loss: 0.55410 (QuantReg: 11.42862) QuantErr: 11.42862 batch_time=0.42658 
Train Epoch: 8 [326/1000 10432/32000 (33%)] Loss: 0.62380 (QuantReg: 12.13435) QuantErr: 12.13435 batch_time=0.34650 
Train Epoch: 8 [331/1000 10592/32000 (33%)] Loss: 0.99130 (QuantReg: 12.05643) QuantErr: 12.05643 batch_time=0.41068 
Train Epoch: 8 [336/1000 10752/32000 (34%)] Loss: 1.31074 (QuantReg: 11.20873) QuantErr: 11.20873 batch_time=0.34619 
Train Epoch: 8 [341/1000 10912/32000 (34%)] Loss: 0.90537 (QuantReg: 12.17252) QuantErr: 12.17252 batch_time=0.42798 
Train Epoch: 8 [346/1000 11072/32000 (35%)] Loss: 1.00738 (QuantReg: 11.49576) QuantErr: 11.49576 batch_time=0.44728 
Train Epoch: 8 [351/1000 11232/32000 (35%)] Loss: 0.86070 (QuantReg: 12.17590) QuantErr: 12.17590 batch_time=0.39751 
Train Epoch: 8 [356/1000 11392/32000 (36%)] Loss: 1.04405 (QuantReg: 12.66790) QuantErr: 12.66790 batch_time=0.38783 
Train Epoch: 8 [361/1000 11552/32000 (36%)] Loss: 0.36832 (QuantReg: 12.17792) QuantErr: 12.17792 batch_time=0.35392 
Train Epoch: 8 [366/1000 11712/32000 (37%)] Loss: 1.03991 (QuantReg: 12.18559) QuantErr: 12.18559 batch_time=0.39181 
Train Epoch: 8 [371/1000 11872/32000 (37%)] Loss: 1.05696 (QuantReg: 11.60987) QuantErr: 11.60987 batch_time=0.36035 
Train Epoch: 8 [376/1000 12032/32000 (38%)] Loss: 0.39015 (QuantReg: 11.57531) QuantErr: 11.57531 batch_time=0.36431 
Train Epoch: 8 [381/1000 12192/32000 (38%)] Loss: 1.00159 (QuantReg: 11.58217) QuantErr: 11.58217 batch_time=0.43589 
Train Epoch: 8 [386/1000 12352/32000 (39%)] Loss: 2.15630 (QuantReg: 12.31334) QuantErr: 12.31334 batch_time=0.44005 
Train Epoch: 8 [391/1000 12512/32000 (39%)] Loss: 1.29555 (QuantReg: 11.81781) QuantErr: 11.81781 batch_time=0.51300 
Train Epoch: 8 [396/1000 12672/32000 (40%)] Loss: 0.77630 (QuantReg: 12.39572) QuantErr: 12.39572 batch_time=0.34443 
Train Epoch: 8 [401/1000 12832/32000 (40%)] Loss: 0.63035 (QuantReg: 12.43084) QuantErr: 12.43084 batch_time=0.85567 
Train Epoch: 8 [406/1000 12992/32000 (41%)] Loss: 1.08726 (QuantReg: 12.63401) QuantErr: 12.63401 batch_time=0.40398 
Train Epoch: 8 [411/1000 13152/32000 (41%)] Loss: 0.88297 (QuantReg: 11.82926) QuantErr: 11.82926 batch_time=0.36596 
Train Epoch: 8 [416/1000 13312/32000 (42%)] Loss: 0.94375 (QuantReg: 12.35683) QuantErr: 12.35683 batch_time=0.38181 
Train Epoch: 8 [421/1000 13472/32000 (42%)] Loss: 1.09706 (QuantReg: 12.19659) QuantErr: 12.19659 batch_time=0.61237 
Train Epoch: 8 [426/1000 13632/32000 (43%)] Loss: 0.59280 (QuantReg: 12.69788) QuantErr: 12.69788 batch_time=0.55383 
Train Epoch: 8 [431/1000 13792/32000 (43%)] Loss: 0.91788 (QuantReg: 11.39636) QuantErr: 11.39636 batch_time=0.36326 
Train Epoch: 8 [436/1000 13952/32000 (44%)] Loss: 0.88243 (QuantReg: 11.46032) QuantErr: 11.46032 batch_time=0.36058 
Train Epoch: 8 [441/1000 14112/32000 (44%)] Loss: 0.93235 (QuantReg: 12.19473) QuantErr: 12.19473 batch_time=0.65332 
Train Epoch: 8 [446/1000 14272/32000 (45%)] Loss: 1.08553 (QuantReg: 12.34984) QuantErr: 12.34984 batch_time=0.40313 
Train Epoch: 8 [451/1000 14432/32000 (45%)] Loss: 1.14922 (QuantReg: 11.71506) QuantErr: 11.71506 batch_time=0.40184 
Train Epoch: 8 [456/1000 14592/32000 (46%)] Loss: 1.48400 (QuantReg: 11.41925) QuantErr: 11.41925 batch_time=0.36631 
Train Epoch: 8 [461/1000 14752/32000 (46%)] Loss: 1.01517 (QuantReg: 12.23990) QuantErr: 12.23990 batch_time=0.41400 
Train Epoch: 8 [466/1000 14912/32000 (47%)] Loss: 0.87877 (QuantReg: 12.64305) QuantErr: 12.64305 batch_time=0.84561 
Train Epoch: 8 [471/1000 15072/32000 (47%)] Loss: 0.98526 (QuantReg: 11.74876) QuantErr: 11.74876 batch_time=0.38204 
Train Epoch: 8 [476/1000 15232/32000 (48%)] Loss: 0.78061 (QuantReg: 12.03859) QuantErr: 12.03859 batch_time=0.42218 
Train Epoch: 8 [481/1000 15392/32000 (48%)] Loss: 0.67804 (QuantReg: 12.33644) QuantErr: 12.33644 batch_time=0.34622 
Train Epoch: 8 [486/1000 15552/32000 (49%)] Loss: 0.63236 (QuantReg: 11.97672) QuantErr: 11.97672 batch_time=0.62753 
Train Epoch: 8 [491/1000 15712/32000 (49%)] Loss: 1.05280 (QuantReg: 12.44796) QuantErr: 12.44796 batch_time=0.51062 
Train Epoch: 8 [496/1000 15872/32000 (50%)] Loss: 1.42049 (QuantReg: 12.45901) QuantErr: 12.45901 batch_time=0.38345 
Train Epoch: 8 [501/1000 16032/32000 (50%)] Loss: 1.28170 (QuantReg: 11.90165) QuantErr: 11.90165 batch_time=0.34679 
Train Epoch: 8 [506/1000 16192/32000 (51%)] Loss: 1.17286 (QuantReg: 12.02280) QuantErr: 12.02280 batch_time=0.37618 
Train Epoch: 8 [511/1000 16352/32000 (51%)] Loss: 0.86730 (QuantReg: 12.59493) QuantErr: 12.59493 batch_time=0.37094 
Train Epoch: 8 [516/1000 16512/32000 (52%)] Loss: 0.83826 (QuantReg: 11.54558) QuantErr: 11.54558 batch_time=0.34908 
Train Epoch: 8 [521/1000 16672/32000 (52%)] Loss: 0.83087 (QuantReg: 11.41066) QuantErr: 11.41066 batch_time=0.36029 
Train Epoch: 8 [526/1000 16832/32000 (53%)] Loss: 0.23452 (QuantReg: 12.06273) QuantErr: 12.06273 batch_time=0.35604 
Train Epoch: 8 [531/1000 16992/32000 (53%)] Loss: 0.67848 (QuantReg: 11.60841) QuantErr: 11.60841 batch_time=0.45895 
Train Epoch: 8 [536/1000 17152/32000 (54%)] Loss: 0.91712 (QuantReg: 12.45226) QuantErr: 12.45226 batch_time=0.37991 
Train Epoch: 8 [541/1000 17312/32000 (54%)] Loss: 1.01549 (QuantReg: 12.12903) QuantErr: 12.12903 batch_time=0.59272 
Train Epoch: 8 [546/1000 17472/32000 (55%)] Loss: 0.81483 (QuantReg: 11.78348) QuantErr: 11.78348 batch_time=0.38266 
Train Epoch: 8 [551/1000 17632/32000 (55%)] Loss: 0.89616 (QuantReg: 12.27758) QuantErr: 12.27758 batch_time=0.42023 
Train Epoch: 8 [556/1000 17792/32000 (56%)] Loss: 0.83636 (QuantReg: 11.94442) QuantErr: 11.94442 batch_time=0.36186 
Train Epoch: 8 [561/1000 17952/32000 (56%)] Loss: 0.60380 (QuantReg: 12.41069) QuantErr: 12.41069 batch_time=0.38852 
Train Epoch: 8 [566/1000 18112/32000 (57%)] Loss: 1.06935 (QuantReg: 12.21723) QuantErr: 12.21723 batch_time=0.39564 
Train Epoch: 8 [571/1000 18272/32000 (57%)] Loss: 0.85229 (QuantReg: 12.01963) QuantErr: 12.01963 batch_time=0.65346 
Train Epoch: 8 [576/1000 18432/32000 (58%)] Loss: 1.35641 (QuantReg: 12.20929) QuantErr: 12.20929 batch_time=0.53276 
Train Epoch: 8 [581/1000 18592/32000 (58%)] Loss: 0.87070 (QuantReg: 11.99882) QuantErr: 11.99882 batch_time=0.36267 
Train Epoch: 8 [586/1000 18752/32000 (59%)] Loss: 1.31598 (QuantReg: 11.88153) QuantErr: 11.88153 batch_time=0.37143 
Train Epoch: 8 [591/1000 18912/32000 (59%)] Loss: 1.24381 (QuantReg: 12.52609) QuantErr: 12.52609 batch_time=0.40026 
Train Epoch: 8 [596/1000 19072/32000 (60%)] Loss: 0.92510 (QuantReg: 12.09483) QuantErr: 12.09483 batch_time=0.44093 
Train Epoch: 8 [601/1000 19232/32000 (60%)] Loss: 0.56947 (QuantReg: 12.69889) QuantErr: 12.69889 batch_time=0.41854 
Train Epoch: 8 [606/1000 19392/32000 (61%)] Loss: 0.49448 (QuantReg: 12.41359) QuantErr: 12.41359 batch_time=0.39302 
Train Epoch: 8 [611/1000 19552/32000 (61%)] Loss: 0.72958 (QuantReg: 12.48862) QuantErr: 12.48862 batch_time=0.78824 
Train Epoch: 8 [616/1000 19712/32000 (62%)] Loss: 0.72418 (QuantReg: 11.97460) QuantErr: 11.97460 batch_time=0.35796 
Train Epoch: 8 [621/1000 19872/32000 (62%)] Loss: 1.00309 (QuantReg: 12.39777) QuantErr: 12.39777 batch_time=0.40967 
Train Epoch: 8 [626/1000 20032/32000 (63%)] Loss: 0.60760 (QuantReg: 12.45725) QuantErr: 12.45725 batch_time=0.52038 
Train Epoch: 8 [631/1000 20192/32000 (63%)] Loss: 1.09930 (QuantReg: 11.89023) QuantErr: 11.89023 batch_time=0.43988 
Train Epoch: 8 [636/1000 20352/32000 (64%)] Loss: 0.39647 (QuantReg: 12.38756) QuantErr: 12.38756 batch_time=0.36196 
Train Epoch: 8 [641/1000 20512/32000 (64%)] Loss: 0.89178 (QuantReg: 12.25313) QuantErr: 12.25313 batch_time=0.49433 
Train Epoch: 8 [646/1000 20672/32000 (65%)] Loss: 1.19307 (QuantReg: 11.90074) QuantErr: 11.90074 batch_time=0.38069 
Train Epoch: 8 [651/1000 20832/32000 (65%)] Loss: 0.46995 (QuantReg: 12.64884) QuantErr: 12.64884 batch_time=0.73287 
Train Epoch: 8 [656/1000 20992/32000 (66%)] Loss: 1.11402 (QuantReg: 11.73036) QuantErr: 11.73036 batch_time=0.59757 
Train Epoch: 8 [661/1000 21152/32000 (66%)] Loss: 0.52640 (QuantReg: 12.01038) QuantErr: 12.01038 batch_time=0.64390 
Train Epoch: 8 [666/1000 21312/32000 (67%)] Loss: 1.04071 (QuantReg: 12.95774) QuantErr: 12.95774 batch_time=0.36160 
Train Epoch: 8 [671/1000 21472/32000 (67%)] Loss: 0.74460 (QuantReg: 11.63800) QuantErr: 11.63800 batch_time=0.44582 
Train Epoch: 8 [676/1000 21632/32000 (68%)] Loss: 0.68929 (QuantReg: 12.14667) QuantErr: 12.14667 batch_time=0.36807 
Train Epoch: 8 [681/1000 21792/32000 (68%)] Loss: 0.70802 (QuantReg: 12.32407) QuantErr: 12.32407 batch_time=0.45467 
Train Epoch: 8 [686/1000 21952/32000 (69%)] Loss: 0.96183 (QuantReg: 11.54806) QuantErr: 11.54806 batch_time=0.54875 
Train Epoch: 8 [691/1000 22112/32000 (69%)] Loss: 1.05761 (QuantReg: 12.08485) QuantErr: 12.08485 batch_time=0.35441 
Train Epoch: 8 [696/1000 22272/32000 (70%)] Loss: 0.52715 (QuantReg: 11.98736) QuantErr: 11.98736 batch_time=0.76699 
Train Epoch: 8 [701/1000 22432/32000 (70%)] Loss: 0.83853 (QuantReg: 12.11276) QuantErr: 12.11276 batch_time=0.59555 
Train Epoch: 8 [706/1000 22592/32000 (71%)] Loss: 0.81061 (QuantReg: 11.38556) QuantErr: 11.38556 batch_time=0.45220 
Train Epoch: 8 [711/1000 22752/32000 (71%)] Loss: 0.89482 (QuantReg: 12.35026) QuantErr: 12.35026 batch_time=2.00045 
Train Epoch: 8 [716/1000 22912/32000 (72%)] Loss: 0.77571 (QuantReg: 12.39374) QuantErr: 12.39374 batch_time=0.38041 
Train Epoch: 8 [721/1000 23072/32000 (72%)] Loss: 0.70845 (QuantReg: 12.13749) QuantErr: 12.13749 batch_time=0.43364 
Train Epoch: 8 [726/1000 23232/32000 (73%)] Loss: 0.58497 (QuantReg: 11.90270) QuantErr: 11.90270 batch_time=0.40050 
Train Epoch: 8 [731/1000 23392/32000 (73%)] Loss: 0.93166 (QuantReg: 12.48167) QuantErr: 12.48167 batch_time=0.35169 
Train Epoch: 8 [736/1000 23552/32000 (74%)] Loss: 0.79060 (QuantReg: 12.30136) QuantErr: 12.30136 batch_time=0.73289 
Train Epoch: 8 [741/1000 23712/32000 (74%)] Loss: 0.62788 (QuantReg: 12.19521) QuantErr: 12.19521 batch_time=0.36173 
Train Epoch: 8 [746/1000 23872/32000 (75%)] Loss: 0.96942 (QuantReg: 12.92828) QuantErr: 12.92828 batch_time=0.58188 
Train Epoch: 8 [751/1000 24032/32000 (75%)] Loss: 0.93059 (QuantReg: 12.91304) QuantErr: 12.91304 batch_time=0.37722 
Train Epoch: 8 [756/1000 24192/32000 (76%)] Loss: 1.41173 (QuantReg: 12.17455) QuantErr: 12.17455 batch_time=0.44227 
Train Epoch: 8 [761/1000 24352/32000 (76%)] Loss: 0.96741 (QuantReg: 11.90421) QuantErr: 11.90421 batch_time=0.34757 
Train Epoch: 8 [766/1000 24512/32000 (77%)] Loss: 0.91988 (QuantReg: 12.74293) QuantErr: 12.74293 batch_time=0.43785 
Train Epoch: 8 [771/1000 24672/32000 (77%)] Loss: 1.19806 (QuantReg: 12.03769) QuantErr: 12.03769 batch_time=0.35940 
Train Epoch: 8 [776/1000 24832/32000 (78%)] Loss: 1.00332 (QuantReg: 12.48039) QuantErr: 12.48039 batch_time=0.82225 
Train Epoch: 8 [781/1000 24992/32000 (78%)] Loss: 0.58008 (QuantReg: 12.38551) QuantErr: 12.38551 batch_time=0.45402 
Train Epoch: 8 [786/1000 25152/32000 (79%)] Loss: 0.67596 (QuantReg: 12.16481) QuantErr: 12.16481 batch_time=0.67131 
Train Epoch: 8 [791/1000 25312/32000 (79%)] Loss: 1.62012 (QuantReg: 11.58041) QuantErr: 11.58041 batch_time=0.34826 
Train Epoch: 8 [796/1000 25472/32000 (80%)] Loss: 0.97215 (QuantReg: 11.61120) QuantErr: 11.61120 batch_time=0.35403 
Train Epoch: 8 [801/1000 25632/32000 (80%)] Loss: 0.88453 (QuantReg: 12.34235) QuantErr: 12.34235 batch_time=0.35707 
Train Epoch: 8 [806/1000 25792/32000 (81%)] Loss: 0.90576 (QuantReg: 11.86408) QuantErr: 11.86408 batch_time=0.35463 
Train Epoch: 8 [811/1000 25952/32000 (81%)] Loss: 0.68526 (QuantReg: 11.86175) QuantErr: 11.86175 batch_time=0.38933 
Train Epoch: 8 [816/1000 26112/32000 (82%)] Loss: 1.10009 (QuantReg: 12.24876) QuantErr: 12.24876 batch_time=0.46420 
Train Epoch: 8 [821/1000 26272/32000 (82%)] Loss: 0.44144 (QuantReg: 12.55496) QuantErr: 12.55496 batch_time=0.35375 
Train Epoch: 8 [826/1000 26432/32000 (83%)] Loss: 0.84947 (QuantReg: 12.86630) QuantErr: 12.86630 batch_time=0.49579 
Train Epoch: 8 [831/1000 26592/32000 (83%)] Loss: 0.89594 (QuantReg: 12.07749) QuantErr: 12.07749 batch_time=0.35074 
Train Epoch: 8 [836/1000 26752/32000 (84%)] Loss: 0.71305 (QuantReg: 12.43661) QuantErr: 12.43661 batch_time=0.41558 
Train Epoch: 8 [841/1000 26912/32000 (84%)] Loss: 0.67364 (QuantReg: 11.76414) QuantErr: 11.76414 batch_time=0.39980 
Train Epoch: 8 [846/1000 27072/32000 (85%)] Loss: 1.10041 (QuantReg: 12.55195) QuantErr: 12.55195 batch_time=0.36907 
Train Epoch: 8 [851/1000 27232/32000 (85%)] Loss: 0.76972 (QuantReg: 11.97328) QuantErr: 11.97328 batch_time=0.46417 
Train Epoch: 8 [856/1000 27392/32000 (86%)] Loss: 0.89881 (QuantReg: 13.11966) QuantErr: 13.11966 batch_time=0.44919 
Train Epoch: 8 [861/1000 27552/32000 (86%)] Loss: 0.57061 (QuantReg: 12.36681) QuantErr: 12.36681 batch_time=0.52592 
Train Epoch: 8 [866/1000 27712/32000 (87%)] Loss: 1.14198 (QuantReg: 11.93179) QuantErr: 11.93179 batch_time=0.33761 
Train Epoch: 8 [871/1000 27872/32000 (87%)] Loss: 1.16404 (QuantReg: 12.08027) QuantErr: 12.08027 batch_time=0.73156 
Train Epoch: 8 [876/1000 28032/32000 (88%)] Loss: 0.91807 (QuantReg: 11.63285) QuantErr: 11.63285 batch_time=0.39841 
Train Epoch: 8 [881/1000 28192/32000 (88%)] Loss: 0.38284 (QuantReg: 12.25756) QuantErr: 12.25756 batch_time=0.38689 
Train Epoch: 8 [886/1000 28352/32000 (89%)] Loss: 1.31089 (QuantReg: 12.64266) QuantErr: 12.64266 batch_time=0.38016 
Train Epoch: 8 [891/1000 28512/32000 (89%)] Loss: 1.11302 (QuantReg: 12.50188) QuantErr: 12.50188 batch_time=0.40460 
Train Epoch: 8 [896/1000 28672/32000 (90%)] Loss: 1.72661 (QuantReg: 11.92386) QuantErr: 11.92386 batch_time=0.37273 
Train Epoch: 8 [901/1000 28832/32000 (90%)] Loss: 0.86444 (QuantReg: 12.04005) QuantErr: 12.04005 batch_time=0.34648 
Train Epoch: 8 [906/1000 28992/32000 (91%)] Loss: 1.01490 (QuantReg: 12.03077) QuantErr: 12.03077 batch_time=0.34334 
Train Epoch: 8 [911/1000 29152/32000 (91%)] Loss: 0.75301 (QuantReg: 12.41074) QuantErr: 12.41074 batch_time=0.35450 
Train Epoch: 8 [916/1000 29312/32000 (92%)] Loss: 0.58418 (QuantReg: 12.58425) QuantErr: 12.58425 batch_time=0.55129 
Train Epoch: 8 [921/1000 29472/32000 (92%)] Loss: 0.68753 (QuantReg: 12.35079) QuantErr: 12.35079 batch_time=0.33774 
Train Epoch: 8 [926/1000 29632/32000 (93%)] Loss: 0.48236 (QuantReg: 12.95076) QuantErr: 12.95076 batch_time=0.40119 
Train Epoch: 8 [931/1000 29792/32000 (93%)] Loss: 0.90804 (QuantReg: 13.08583) QuantErr: 13.08583 batch_time=0.34863 
Train Epoch: 8 [936/1000 29952/32000 (94%)] Loss: 0.87641 (QuantReg: 13.09998) QuantErr: 13.09998 batch_time=0.38027 
Train Epoch: 8 [941/1000 30112/32000 (94%)] Loss: 1.35913 (QuantReg: 12.54240) QuantErr: 12.54240 batch_time=0.36211 
Train Epoch: 8 [946/1000 30272/32000 (95%)] Loss: 0.53898 (QuantReg: 12.48788) QuantErr: 12.48788 batch_time=0.43856 
Train Epoch: 8 [951/1000 30432/32000 (95%)] Loss: 0.89009 (QuantReg: 12.38778) QuantErr: 12.38778 batch_time=0.37860 
Train Epoch: 8 [956/1000 30592/32000 (96%)] Loss: 0.95860 (QuantReg: 12.30967) QuantErr: 12.30967 batch_time=0.41105 
Train Epoch: 8 [961/1000 30752/32000 (96%)] Loss: 0.78907 (QuantReg: 11.95766) QuantErr: 11.95766 batch_time=0.49160 
Train Epoch: 8 [966/1000 30912/32000 (97%)] Loss: 0.72598 (QuantReg: 12.58839) QuantErr: 12.58839 batch_time=0.48224 
Train Epoch: 8 [971/1000 31072/32000 (97%)] Loss: 0.87506 (QuantReg: 12.22027) QuantErr: 12.22027 batch_time=0.34188 
Train Epoch: 8 [976/1000 31232/32000 (98%)] Loss: 1.36472 (QuantReg: 11.98292) QuantErr: 11.98292 batch_time=0.87414 
Train Epoch: 8 [981/1000 31392/32000 (98%)] Loss: 1.43875 (QuantReg: 12.62694) QuantErr: 12.62694 batch_time=0.44380 
Train Epoch: 8 [986/1000 31552/32000 (99%)] Loss: 0.78777 (QuantReg: 12.89360) QuantErr: 12.89360 batch_time=0.34740 
Train Epoch: 8 [991/1000 31712/32000 (99%)] Loss: 1.16012 (QuantReg: 12.46668) QuantErr: 12.46668 batch_time=0.41314 
Train Epoch: 8 [996/1000 31872/32000 (100%)] Loss: 1.59311 (QuantReg: 12.03019) QuantErr: 12.03019 batch_time=0.35214 
Train Epoch: 8 codebook_update_time=2.62391
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch8.pth ...
Done in 5.857s
removing stale ckpt [epoch 7] [took 0.03s]
 epoch          : 8
 loss           : 0.9067530628293753
 quant_reg      : 12.067807046890259
 quant_err      : 12.067807046890259
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 8000
 MSRVTT_miech_test/t2v_metrics/R1: 14.9
 MSRVTT_miech_test/t2v_metrics/R5: 42.6
 MSRVTT_miech_test/t2v_metrics/R10: 58.3
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 34.145
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.32382210857845
 MSRVTT_miech_test/v2t_metrics/R1: 15.5
 MSRVTT_miech_test/v2t_metrics/R5: 44.8
 MSRVTT_miech_test/v2t_metrics/R10: 58.6
 MSRVTT_miech_test/v2t_metrics/R50: 85.9
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.902
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.39556459850361
 mnt_best       : 33.79601040640916
 not_improved_count: 1
Train Epoch: 9 [1/1000 32/32000 (0%)] Loss: 1.07836 (QuantReg: 11.72966) QuantErr: 11.72966 batch_time=30.59959 
Train Epoch: 9 [6/1000 192/32000 (1%)] Loss: 1.31909 (QuantReg: 11.07589) QuantErr: 11.07589 batch_time=0.33854 
Train Epoch: 9 [11/1000 352/32000 (1%)] Loss: 1.35339 (QuantReg: 11.12214) QuantErr: 11.12214 batch_time=0.38163 
Train Epoch: 9 [16/1000 512/32000 (2%)] Loss: 0.60051 (QuantReg: 10.99454) QuantErr: 10.99454 batch_time=0.50162 
Train Epoch: 9 [21/1000 672/32000 (2%)] Loss: 0.63398 (QuantReg: 11.69745) QuantErr: 11.69745 batch_time=0.41489 
Train Epoch: 9 [26/1000 832/32000 (3%)] Loss: 0.83908 (QuantReg: 11.18201) QuantErr: 11.18201 batch_time=0.51866 
Train Epoch: 9 [31/1000 992/32000 (3%)] Loss: 0.73554 (QuantReg: 12.12321) QuantErr: 12.12321 batch_time=0.35945 
Train Epoch: 9 [36/1000 1152/32000 (4%)] Loss: 0.63953 (QuantReg: 12.07345) QuantErr: 12.07345 batch_time=0.42939 
Train Epoch: 9 [41/1000 1312/32000 (4%)] Loss: 1.32018 (QuantReg: 11.06315) QuantErr: 11.06315 batch_time=0.33325 
Train Epoch: 9 [46/1000 1472/32000 (5%)] Loss: 0.38417 (QuantReg: 11.41692) QuantErr: 11.41692 batch_time=0.43973 
Train Epoch: 9 [51/1000 1632/32000 (5%)] Loss: 0.73051 (QuantReg: 11.94344) QuantErr: 11.94344 batch_time=0.35620 
Train Epoch: 9 [56/1000 1792/32000 (6%)] Loss: 0.74944 (QuantReg: 12.68801) QuantErr: 12.68801 batch_time=0.34692 
Train Epoch: 9 [61/1000 1952/32000 (6%)] Loss: 0.73379 (QuantReg: 12.14611) QuantErr: 12.14611 batch_time=0.75648 
Train Epoch: 9 [66/1000 2112/32000 (7%)] Loss: 0.79092 (QuantReg: 11.51394) QuantErr: 11.51394 batch_time=0.48403 
Train Epoch: 9 [71/1000 2272/32000 (7%)] Loss: 0.72033 (QuantReg: 11.56685) QuantErr: 11.56685 batch_time=0.45712 
Train Epoch: 9 [76/1000 2432/32000 (8%)] Loss: 1.10199 (QuantReg: 11.69837) QuantErr: 11.69837 batch_time=0.36363 
Train Epoch: 9 [81/1000 2592/32000 (8%)] Loss: 0.62102 (QuantReg: 12.30904) QuantErr: 12.30904 batch_time=0.42651 
Train Epoch: 9 [86/1000 2752/32000 (9%)] Loss: 0.70273 (QuantReg: 11.86199) QuantErr: 11.86199 batch_time=0.37435 
Train Epoch: 9 [91/1000 2912/32000 (9%)] Loss: 0.83092 (QuantReg: 11.56768) QuantErr: 11.56768 batch_time=0.43037 
Train Epoch: 9 [96/1000 3072/32000 (10%)] Loss: 0.56507 (QuantReg: 11.84170) QuantErr: 11.84170 batch_time=0.43688 
Train Epoch: 9 [101/1000 3232/32000 (10%)] Loss: 1.01672 (QuantReg: 11.96750) QuantErr: 11.96750 batch_time=0.57389 
Train Epoch: 9 [106/1000 3392/32000 (11%)] Loss: 1.27452 (QuantReg: 11.62322) QuantErr: 11.62322 batch_time=0.46291 
Train Epoch: 9 [111/1000 3552/32000 (11%)] Loss: 1.07051 (QuantReg: 12.16716) QuantErr: 12.16716 batch_time=0.34989 
Train Epoch: 9 [116/1000 3712/32000 (12%)] Loss: 0.67125 (QuantReg: 12.16680) QuantErr: 12.16680 batch_time=0.35840 
Train Epoch: 9 [121/1000 3872/32000 (12%)] Loss: 0.71632 (QuantReg: 12.15246) QuantErr: 12.15246 batch_time=0.45211 
Train Epoch: 9 [126/1000 4032/32000 (13%)] Loss: 1.31432 (QuantReg: 11.89766) QuantErr: 11.89766 batch_time=0.47900 
Train Epoch: 9 [131/1000 4192/32000 (13%)] Loss: 0.98806 (QuantReg: 11.37109) QuantErr: 11.37109 batch_time=0.40831 
Train Epoch: 9 [136/1000 4352/32000 (14%)] Loss: 0.34690 (QuantReg: 11.52030) QuantErr: 11.52030 batch_time=0.36398 
Train Epoch: 9 [141/1000 4512/32000 (14%)] Loss: 0.53406 (QuantReg: 12.38329) QuantErr: 12.38329 batch_time=1.77064 
Train Epoch: 9 [146/1000 4672/32000 (15%)] Loss: 0.88780 (QuantReg: 11.62645) QuantErr: 11.62645 batch_time=0.88720 
Train Epoch: 9 [151/1000 4832/32000 (15%)] Loss: 0.98539 (QuantReg: 11.58536) QuantErr: 11.58536 batch_time=0.41914 
Train Epoch: 9 [156/1000 4992/32000 (16%)] Loss: 1.10794 (QuantReg: 11.78689) QuantErr: 11.78689 batch_time=0.38126 
Train Epoch: 9 [161/1000 5152/32000 (16%)] Loss: 0.83900 (QuantReg: 11.30627) QuantErr: 11.30627 batch_time=0.35368 
Train Epoch: 9 [166/1000 5312/32000 (17%)] Loss: 0.69148 (QuantReg: 12.09873) QuantErr: 12.09873 batch_time=0.41879 
Train Epoch: 9 [171/1000 5472/32000 (17%)] Loss: 0.75797 (QuantReg: 12.35205) QuantErr: 12.35205 batch_time=0.36926 
Train Epoch: 9 [176/1000 5632/32000 (18%)] Loss: 0.66846 (QuantReg: 11.80203) QuantErr: 11.80203 batch_time=0.44490 
Train Epoch: 9 [181/1000 5792/32000 (18%)] Loss: 0.63544 (QuantReg: 11.64960) QuantErr: 11.64960 batch_time=0.52961 
Train Epoch: 9 [186/1000 5952/32000 (19%)] Loss: 0.90345 (QuantReg: 11.85477) QuantErr: 11.85477 batch_time=0.33395 
Train Epoch: 9 [191/1000 6112/32000 (19%)] Loss: 1.08018 (QuantReg: 11.54497) QuantErr: 11.54497 batch_time=0.48265 
Train Epoch: 9 [196/1000 6272/32000 (20%)] Loss: 1.11166 (QuantReg: 11.86466) QuantErr: 11.86466 batch_time=0.40460 
Train Epoch: 9 [201/1000 6432/32000 (20%)] Loss: 0.78743 (QuantReg: 11.70150) QuantErr: 11.70150 batch_time=0.60860 
Train Epoch: 9 [206/1000 6592/32000 (21%)] Loss: 0.72808 (QuantReg: 11.82032) QuantErr: 11.82032 batch_time=0.42733 
Train Epoch: 9 [211/1000 6752/32000 (21%)] Loss: 0.49737 (QuantReg: 12.34290) QuantErr: 12.34290 batch_time=0.36708 
Train Epoch: 9 [216/1000 6912/32000 (22%)] Loss: 0.55389 (QuantReg: 11.87197) QuantErr: 11.87197 batch_time=0.36591 
Train Epoch: 9 [221/1000 7072/32000 (22%)] Loss: 1.32025 (QuantReg: 11.43510) QuantErr: 11.43510 batch_time=0.39032 
Train Epoch: 9 [226/1000 7232/32000 (23%)] Loss: 0.94674 (QuantReg: 12.12380) QuantErr: 12.12380 batch_time=0.79843 
Train Epoch: 9 [231/1000 7392/32000 (23%)] Loss: 0.81100 (QuantReg: 11.38714) QuantErr: 11.38714 batch_time=0.34085 
Train Epoch: 9 [236/1000 7552/32000 (24%)] Loss: 1.14525 (QuantReg: 12.40078) QuantErr: 12.40078 batch_time=0.44751 
Train Epoch: 9 [241/1000 7712/32000 (24%)] Loss: 1.13888 (QuantReg: 11.93717) QuantErr: 11.93717 batch_time=0.37597 
Train Epoch: 9 [246/1000 7872/32000 (25%)] Loss: 0.60830 (QuantReg: 11.82416) QuantErr: 11.82416 batch_time=0.34700 
Train Epoch: 9 [251/1000 8032/32000 (25%)] Loss: 0.63408 (QuantReg: 12.11548) QuantErr: 12.11548 batch_time=0.39163 
Train Epoch: 9 [256/1000 8192/32000 (26%)] Loss: 0.90609 (QuantReg: 11.48902) QuantErr: 11.48902 batch_time=0.37081 
Train Epoch: 9 [261/1000 8352/32000 (26%)] Loss: 0.87965 (QuantReg: 11.56157) QuantErr: 11.56157 batch_time=0.34503 
Train Epoch: 9 [266/1000 8512/32000 (27%)] Loss: 1.17212 (QuantReg: 12.62842) QuantErr: 12.62842 batch_time=0.40752 
Train Epoch: 9 [271/1000 8672/32000 (27%)] Loss: 0.29482 (QuantReg: 11.59249) QuantErr: 11.59249 batch_time=0.67294 
Train Epoch: 9 [276/1000 8832/32000 (28%)] Loss: 0.81361 (QuantReg: 12.39639) QuantErr: 12.39639 batch_time=0.37947 
Train Epoch: 9 [281/1000 8992/32000 (28%)] Loss: 0.66271 (QuantReg: 11.64011) QuantErr: 11.64011 batch_time=0.33448 
Train Epoch: 9 [286/1000 9152/32000 (29%)] Loss: 0.59686 (QuantReg: 12.06324) QuantErr: 12.06324 batch_time=0.36235 
Train Epoch: 9 [291/1000 9312/32000 (29%)] Loss: 0.54399 (QuantReg: 12.34139) QuantErr: 12.34139 batch_time=0.74074 
Train Epoch: 9 [296/1000 9472/32000 (30%)] Loss: 1.14567 (QuantReg: 12.59346) QuantErr: 12.59346 batch_time=0.35576 
Train Epoch: 9 [301/1000 9632/32000 (30%)] Loss: 0.96049 (QuantReg: 12.02173) QuantErr: 12.02173 batch_time=0.37189 
Train Epoch: 9 [306/1000 9792/32000 (31%)] Loss: 0.43236 (QuantReg: 11.94619) QuantErr: 11.94619 batch_time=0.41069 
Train Epoch: 9 [311/1000 9952/32000 (31%)] Loss: 1.22401 (QuantReg: 12.22325) QuantErr: 12.22325 batch_time=0.63496 
Train Epoch: 9 [316/1000 10112/32000 (32%)] Loss: 0.67426 (QuantReg: 11.85024) QuantErr: 11.85024 batch_time=0.37230 
Train Epoch: 9 [321/1000 10272/32000 (32%)] Loss: 0.89774 (QuantReg: 12.29595) QuantErr: 12.29595 batch_time=0.34915 
Train Epoch: 9 [326/1000 10432/32000 (33%)] Loss: 0.55864 (QuantReg: 12.69101) QuantErr: 12.69101 batch_time=0.58200 
Train Epoch: 9 [331/1000 10592/32000 (33%)] Loss: 1.06766 (QuantReg: 12.28823) QuantErr: 12.28823 batch_time=0.36654 
Train Epoch: 9 [336/1000 10752/32000 (34%)] Loss: 0.76589 (QuantReg: 12.76461) QuantErr: 12.76461 batch_time=0.84570 
Train Epoch: 9 [341/1000 10912/32000 (34%)] Loss: 1.14294 (QuantReg: 11.81929) QuantErr: 11.81929 batch_time=0.36960 
Train Epoch: 9 [346/1000 11072/32000 (35%)] Loss: 1.06638 (QuantReg: 12.17837) QuantErr: 12.17837 batch_time=0.42730 
Train Epoch: 9 [351/1000 11232/32000 (35%)] Loss: 0.68079 (QuantReg: 12.26057) QuantErr: 12.26057 batch_time=0.49673 
Train Epoch: 9 [356/1000 11392/32000 (36%)] Loss: 1.54449 (QuantReg: 12.44088) QuantErr: 12.44088 batch_time=0.34143 
Train Epoch: 9 [361/1000 11552/32000 (36%)] Loss: 0.47517 (QuantReg: 12.03129) QuantErr: 12.03129 batch_time=0.37201 
Train Epoch: 9 [366/1000 11712/32000 (37%)] Loss: 0.67149 (QuantReg: 11.86013) QuantErr: 11.86013 batch_time=0.34388 
Train Epoch: 9 [371/1000 11872/32000 (37%)] Loss: 0.67199 (QuantReg: 12.53217) QuantErr: 12.53217 batch_time=0.36362 
Train Epoch: 9 [376/1000 12032/32000 (38%)] Loss: 1.27848 (QuantReg: 11.66782) QuantErr: 11.66782 batch_time=0.35583 
Train Epoch: 9 [381/1000 12192/32000 (38%)] Loss: 0.82459 (QuantReg: 12.70184) QuantErr: 12.70184 batch_time=0.39440 
Train Epoch: 9 [386/1000 12352/32000 (39%)] Loss: 0.65945 (QuantReg: 12.03606) QuantErr: 12.03606 batch_time=0.45127 
Train Epoch: 9 [391/1000 12512/32000 (39%)] Loss: 0.72055 (QuantReg: 12.48348) QuantErr: 12.48348 batch_time=0.43162 
Train Epoch: 9 [396/1000 12672/32000 (40%)] Loss: 1.00127 (QuantReg: 12.01710) QuantErr: 12.01710 batch_time=0.43179 
Train Epoch: 9 [401/1000 12832/32000 (40%)] Loss: 1.14120 (QuantReg: 12.16159) QuantErr: 12.16159 batch_time=0.54264 
Train Epoch: 9 [406/1000 12992/32000 (41%)] Loss: 1.20007 (QuantReg: 11.96924) QuantErr: 11.96924 batch_time=0.44848 
Train Epoch: 9 [411/1000 13152/32000 (41%)] Loss: 0.56184 (QuantReg: 12.64482) QuantErr: 12.64482 batch_time=0.35342 
Train Epoch: 9 [416/1000 13312/32000 (42%)] Loss: 0.26396 (QuantReg: 11.74109) QuantErr: 11.74109 batch_time=0.61547 
Train Epoch: 9 [421/1000 13472/32000 (42%)] Loss: 0.60875 (QuantReg: 12.25524) QuantErr: 12.25524 batch_time=0.36361 
Train Epoch: 9 [426/1000 13632/32000 (43%)] Loss: 0.69259 (QuantReg: 11.85231) QuantErr: 11.85231 batch_time=0.37302 
Train Epoch: 9 [431/1000 13792/32000 (43%)] Loss: 1.10964 (QuantReg: 12.01088) QuantErr: 12.01088 batch_time=0.46873 
Train Epoch: 9 [436/1000 13952/32000 (44%)] Loss: 1.17841 (QuantReg: 12.37768) QuantErr: 12.37768 batch_time=0.42954 
Train Epoch: 9 [441/1000 14112/32000 (44%)] Loss: 1.07898 (QuantReg: 11.38371) QuantErr: 11.38371 batch_time=0.57392 
Train Epoch: 9 [446/1000 14272/32000 (45%)] Loss: 1.17922 (QuantReg: 11.92437) QuantErr: 11.92437 batch_time=1.81804 
Train Epoch: 9 [451/1000 14432/32000 (45%)] Loss: 0.33878 (QuantReg: 11.86391) QuantErr: 11.86391 batch_time=0.50454 
Train Epoch: 9 [456/1000 14592/32000 (46%)] Loss: 1.28322 (QuantReg: 11.80361) QuantErr: 11.80361 batch_time=0.34406 
Train Epoch: 9 [461/1000 14752/32000 (46%)] Loss: 1.00185 (QuantReg: 11.85657) QuantErr: 11.85657 batch_time=0.41288 
Train Epoch: 9 [466/1000 14912/32000 (47%)] Loss: 0.61137 (QuantReg: 12.36371) QuantErr: 12.36371 batch_time=0.43126 
Train Epoch: 9 [471/1000 15072/32000 (47%)] Loss: 1.07381 (QuantReg: 12.03475) QuantErr: 12.03475 batch_time=0.36336 
Train Epoch: 9 [476/1000 15232/32000 (48%)] Loss: 0.53571 (QuantReg: 11.83457) QuantErr: 11.83457 batch_time=0.33992 
Train Epoch: 9 [481/1000 15392/32000 (48%)] Loss: 0.76690 (QuantReg: 11.88652) QuantErr: 11.88652 batch_time=0.35350 
Train Epoch: 9 [486/1000 15552/32000 (49%)] Loss: 0.43378 (QuantReg: 12.69709) QuantErr: 12.69709 batch_time=0.47530 
Train Epoch: 9 [491/1000 15712/32000 (49%)] Loss: 0.67281 (QuantReg: 12.52589) QuantErr: 12.52589 batch_time=0.34919 
Train Epoch: 9 [496/1000 15872/32000 (50%)] Loss: 1.36540 (QuantReg: 12.51682) QuantErr: 12.51682 batch_time=0.71652 
Train Epoch: 9 [501/1000 16032/32000 (50%)] Loss: 1.18754 (QuantReg: 12.52555) QuantErr: 12.52555 batch_time=0.36530 
Train Epoch: 9 [506/1000 16192/32000 (51%)] Loss: 1.75362 (QuantReg: 11.67917) QuantErr: 11.67917 batch_time=0.34766 
Train Epoch: 9 [511/1000 16352/32000 (51%)] Loss: 1.53052 (QuantReg: 12.21327) QuantErr: 12.21327 batch_time=0.37961 
Train Epoch: 9 [516/1000 16512/32000 (52%)] Loss: 0.78690 (QuantReg: 12.23676) QuantErr: 12.23676 batch_time=0.39777 
Train Epoch: 9 [521/1000 16672/32000 (52%)] Loss: 1.04736 (QuantReg: 12.45565) QuantErr: 12.45565 batch_time=0.40025 
Train Epoch: 9 [526/1000 16832/32000 (53%)] Loss: 1.03450 (QuantReg: 11.67696) QuantErr: 11.67696 batch_time=0.35679 
Train Epoch: 9 [531/1000 16992/32000 (53%)] Loss: 0.68449 (QuantReg: 11.67006) QuantErr: 11.67006 batch_time=0.57096 
Train Epoch: 9 [536/1000 17152/32000 (54%)] Loss: 1.52188 (QuantReg: 12.10623) QuantErr: 12.10623 batch_time=0.35255 
Train Epoch: 9 [541/1000 17312/32000 (54%)] Loss: 0.83483 (QuantReg: 11.99610) QuantErr: 11.99610 batch_time=0.47337 
Train Epoch: 9 [546/1000 17472/32000 (55%)] Loss: 0.59901 (QuantReg: 12.07730) QuantErr: 12.07730 batch_time=0.35167 
Train Epoch: 9 [551/1000 17632/32000 (55%)] Loss: 1.21681 (QuantReg: 11.70095) QuantErr: 11.70095 batch_time=0.37389 
Train Epoch: 9 [556/1000 17792/32000 (56%)] Loss: 0.99899 (QuantReg: 12.01503) QuantErr: 12.01503 batch_time=0.35253 
Train Epoch: 9 [561/1000 17952/32000 (56%)] Loss: 0.91565 (QuantReg: 11.36077) QuantErr: 11.36077 batch_time=0.38795 
Train Epoch: 9 [566/1000 18112/32000 (57%)] Loss: 1.07633 (QuantReg: 11.70938) QuantErr: 11.70938 batch_time=0.35151 
Train Epoch: 9 [571/1000 18272/32000 (57%)] Loss: 1.01602 (QuantReg: 12.46310) QuantErr: 12.46310 batch_time=0.38600 
Train Epoch: 9 [576/1000 18432/32000 (58%)] Loss: 1.05579 (QuantReg: 12.75389) QuantErr: 12.75389 batch_time=0.41840 
Train Epoch: 9 [581/1000 18592/32000 (58%)] Loss: 1.10628 (QuantReg: 12.45381) QuantErr: 12.45381 batch_time=0.33943 
Train Epoch: 9 [586/1000 18752/32000 (59%)] Loss: 1.43771 (QuantReg: 12.70684) QuantErr: 12.70684 batch_time=0.48204 
Train Epoch: 9 [591/1000 18912/32000 (59%)] Loss: 0.91199 (QuantReg: 11.69345) QuantErr: 11.69345 batch_time=0.34066 
Train Epoch: 9 [596/1000 19072/32000 (60%)] Loss: 1.25664 (QuantReg: 12.74875) QuantErr: 12.74875 batch_time=0.37892 
Train Epoch: 9 [601/1000 19232/32000 (60%)] Loss: 0.66838 (QuantReg: 12.46629) QuantErr: 12.46629 batch_time=0.41844 
Train Epoch: 9 [606/1000 19392/32000 (61%)] Loss: 0.67737 (QuantReg: 12.77947) QuantErr: 12.77947 batch_time=0.37581 
Train Epoch: 9 [611/1000 19552/32000 (61%)] Loss: 1.09185 (QuantReg: 12.12207) QuantErr: 12.12207 batch_time=0.38726 
Train Epoch: 9 [616/1000 19712/32000 (62%)] Loss: 0.47104 (QuantReg: 11.87240) QuantErr: 11.87240 batch_time=0.36087 
Train Epoch: 9 [621/1000 19872/32000 (62%)] Loss: 0.71836 (QuantReg: 11.77397) QuantErr: 11.77397 batch_time=0.34371 
Train Epoch: 9 [626/1000 20032/32000 (63%)] Loss: 0.66563 (QuantReg: 12.43259) QuantErr: 12.43259 batch_time=0.52372 
Train Epoch: 9 [631/1000 20192/32000 (63%)] Loss: 1.21740 (QuantReg: 12.03046) QuantErr: 12.03046 batch_time=0.66884 
Train Epoch: 9 [636/1000 20352/32000 (64%)] Loss: 0.30862 (QuantReg: 12.54112) QuantErr: 12.54112 batch_time=0.37227 
Train Epoch: 9 [641/1000 20512/32000 (64%)] Loss: 0.97808 (QuantReg: 12.08737) QuantErr: 12.08737 batch_time=0.39952 
Train Epoch: 9 [646/1000 20672/32000 (65%)] Loss: 1.28643 (QuantReg: 11.85339) QuantErr: 11.85339 batch_time=0.35675 
Train Epoch: 9 [651/1000 20832/32000 (65%)] Loss: 0.62627 (QuantReg: 12.37430) QuantErr: 12.37430 batch_time=0.41813 
Train Epoch: 9 [656/1000 20992/32000 (66%)] Loss: 0.54762 (QuantReg: 12.03735) QuantErr: 12.03735 batch_time=1.14219 
Train Epoch: 9 [661/1000 21152/32000 (66%)] Loss: 1.00168 (QuantReg: 12.43468) QuantErr: 12.43468 batch_time=0.47188 
Train Epoch: 9 [666/1000 21312/32000 (67%)] Loss: 0.63532 (QuantReg: 12.71555) QuantErr: 12.71555 batch_time=0.55041 
Train Epoch: 9 [671/1000 21472/32000 (67%)] Loss: 0.48822 (QuantReg: 12.13686) QuantErr: 12.13686 batch_time=0.48246 
Train Epoch: 9 [676/1000 21632/32000 (68%)] Loss: 0.45751 (QuantReg: 11.74978) QuantErr: 11.74978 batch_time=0.36414 
Train Epoch: 9 [681/1000 21792/32000 (68%)] Loss: 0.85206 (QuantReg: 12.23516) QuantErr: 12.23516 batch_time=0.41326 
Train Epoch: 9 [686/1000 21952/32000 (69%)] Loss: 0.69860 (QuantReg: 12.23452) QuantErr: 12.23452 batch_time=0.60858 
Train Epoch: 9 [691/1000 22112/32000 (69%)] Loss: 0.71787 (QuantReg: 11.57881) QuantErr: 11.57881 batch_time=0.36169 
Train Epoch: 9 [696/1000 22272/32000 (70%)] Loss: 1.47891 (QuantReg: 12.70300) QuantErr: 12.70300 batch_time=0.35814 
Train Epoch: 9 [701/1000 22432/32000 (70%)] Loss: 1.44182 (QuantReg: 12.01134) QuantErr: 12.01134 batch_time=0.37465 
Train Epoch: 9 [706/1000 22592/32000 (71%)] Loss: 0.37829 (QuantReg: 12.21124) QuantErr: 12.21124 batch_time=0.38386 
Train Epoch: 9 [711/1000 22752/32000 (71%)] Loss: 0.72870 (QuantReg: 11.94799) QuantErr: 11.94799 batch_time=0.43702 
Train Epoch: 9 [716/1000 22912/32000 (72%)] Loss: 0.79235 (QuantReg: 11.96868) QuantErr: 11.96868 batch_time=0.75384 
Train Epoch: 9 [721/1000 23072/32000 (72%)] Loss: 0.84085 (QuantReg: 12.46086) QuantErr: 12.46086 batch_time=0.39017 
Train Epoch: 9 [726/1000 23232/32000 (73%)] Loss: 0.68062 (QuantReg: 12.11146) QuantErr: 12.11146 batch_time=0.41473 
Train Epoch: 9 [731/1000 23392/32000 (73%)] Loss: 1.04198 (QuantReg: 11.98923) QuantErr: 11.98923 batch_time=0.37972 
Train Epoch: 9 [736/1000 23552/32000 (74%)] Loss: 0.66415 (QuantReg: 12.24967) QuantErr: 12.24967 batch_time=0.39606 
Train Epoch: 9 [741/1000 23712/32000 (74%)] Loss: 0.81245 (QuantReg: 12.06631) QuantErr: 12.06631 batch_time=0.36498 
Train Epoch: 9 [746/1000 23872/32000 (75%)] Loss: 1.23164 (QuantReg: 12.19574) QuantErr: 12.19574 batch_time=0.38744 
Train Epoch: 9 [751/1000 24032/32000 (75%)] Loss: 0.59676 (QuantReg: 12.36258) QuantErr: 12.36258 batch_time=0.40111 
Train Epoch: 9 [756/1000 24192/32000 (76%)] Loss: 0.51943 (QuantReg: 12.05659) QuantErr: 12.05659 batch_time=0.41273 
Train Epoch: 9 [761/1000 24352/32000 (76%)] Loss: 1.00364 (QuantReg: 11.93241) QuantErr: 11.93241 batch_time=0.57977 
Train Epoch: 9 [766/1000 24512/32000 (77%)] Loss: 0.65846 (QuantReg: 12.00270) QuantErr: 12.00270 batch_time=0.70783 
Train Epoch: 9 [771/1000 24672/32000 (77%)] Loss: 0.59564 (QuantReg: 12.10422) QuantErr: 12.10422 batch_time=0.35802 
Train Epoch: 9 [776/1000 24832/32000 (78%)] Loss: 1.13524 (QuantReg: 11.83654) QuantErr: 11.83654 batch_time=0.34250 
Train Epoch: 9 [781/1000 24992/32000 (78%)] Loss: 0.69678 (QuantReg: 11.93556) QuantErr: 11.93556 batch_time=0.45260 
Train Epoch: 9 [786/1000 25152/32000 (79%)] Loss: 1.35280 (QuantReg: 12.32728) QuantErr: 12.32728 batch_time=0.54087 
Train Epoch: 9 [791/1000 25312/32000 (79%)] Loss: 0.81597 (QuantReg: 12.43415) QuantErr: 12.43415 batch_time=0.42845 
Train Epoch: 9 [796/1000 25472/32000 (80%)] Loss: 0.56767 (QuantReg: 12.44196) QuantErr: 12.44196 batch_time=0.62198 
Train Epoch: 9 [801/1000 25632/32000 (80%)] Loss: 0.74381 (QuantReg: 13.05842) QuantErr: 13.05842 batch_time=0.38532 
Train Epoch: 9 [806/1000 25792/32000 (81%)] Loss: 0.90077 (QuantReg: 12.46470) QuantErr: 12.46470 batch_time=0.52998 
Train Epoch: 9 [811/1000 25952/32000 (81%)] Loss: 1.08001 (QuantReg: 12.59311) QuantErr: 12.59311 batch_time=0.42697 
Train Epoch: 9 [816/1000 26112/32000 (82%)] Loss: 0.88481 (QuantReg: 12.25697) QuantErr: 12.25697 batch_time=0.35563 
Train Epoch: 9 [821/1000 26272/32000 (82%)] Loss: 0.65542 (QuantReg: 12.91654) QuantErr: 12.91654 batch_time=0.35373 
Train Epoch: 9 [826/1000 26432/32000 (83%)] Loss: 0.69715 (QuantReg: 12.47107) QuantErr: 12.47107 batch_time=0.42473 
Train Epoch: 9 [831/1000 26592/32000 (83%)] Loss: 0.47309 (QuantReg: 12.37055) QuantErr: 12.37055 batch_time=0.45409 
Train Epoch: 9 [836/1000 26752/32000 (84%)] Loss: 0.57812 (QuantReg: 12.39665) QuantErr: 12.39665 batch_time=0.50285 
Train Epoch: 9 [841/1000 26912/32000 (84%)] Loss: 0.39946 (QuantReg: 12.43096) QuantErr: 12.43096 batch_time=0.34352 
Train Epoch: 9 [846/1000 27072/32000 (85%)] Loss: 0.67531 (QuantReg: 11.87412) QuantErr: 11.87412 batch_time=0.89621 
Train Epoch: 9 [851/1000 27232/32000 (85%)] Loss: 1.06829 (QuantReg: 12.21294) QuantErr: 12.21294 batch_time=0.35647 
Train Epoch: 9 [856/1000 27392/32000 (86%)] Loss: 0.65084 (QuantReg: 12.00541) QuantErr: 12.00541 batch_time=0.36070 
Train Epoch: 9 [861/1000 27552/32000 (86%)] Loss: 0.56097 (QuantReg: 12.50517) QuantErr: 12.50517 batch_time=0.40684 
Train Epoch: 9 [866/1000 27712/32000 (87%)] Loss: 1.01382 (QuantReg: 12.62638) QuantErr: 12.62638 batch_time=0.35907 
Train Epoch: 9 [871/1000 27872/32000 (87%)] Loss: 0.96905 (QuantReg: 12.47555) QuantErr: 12.47555 batch_time=0.37731 
Train Epoch: 9 [876/1000 28032/32000 (88%)] Loss: 0.69731 (QuantReg: 12.35225) QuantErr: 12.35225 batch_time=0.35450 
Train Epoch: 9 [881/1000 28192/32000 (88%)] Loss: 0.66310 (QuantReg: 11.37782) QuantErr: 11.37782 batch_time=0.35592 
Train Epoch: 9 [886/1000 28352/32000 (89%)] Loss: 0.76049 (QuantReg: 12.67096) QuantErr: 12.67096 batch_time=1.09343 
Train Epoch: 9 [891/1000 28512/32000 (89%)] Loss: 0.49292 (QuantReg: 11.60569) QuantErr: 11.60569 batch_time=0.70868 
Train Epoch: 9 [896/1000 28672/32000 (90%)] Loss: 0.52292 (QuantReg: 12.21989) QuantErr: 12.21989 batch_time=0.35188 
Train Epoch: 9 [901/1000 28832/32000 (90%)] Loss: 1.15193 (QuantReg: 12.44275) QuantErr: 12.44275 batch_time=0.36376 
Train Epoch: 9 [906/1000 28992/32000 (91%)] Loss: 0.51844 (QuantReg: 11.83082) QuantErr: 11.83082 batch_time=0.53480 
Train Epoch: 9 [911/1000 29152/32000 (91%)] Loss: 0.73776 (QuantReg: 12.71712) QuantErr: 12.71712 batch_time=0.36970 
Train Epoch: 9 [916/1000 29312/32000 (92%)] Loss: 0.93802 (QuantReg: 11.98081) QuantErr: 11.98081 batch_time=0.35597 
Train Epoch: 9 [921/1000 29472/32000 (92%)] Loss: 0.81646 (QuantReg: 12.74812) QuantErr: 12.74812 batch_time=0.41029 
Train Epoch: 9 [926/1000 29632/32000 (93%)] Loss: 0.81161 (QuantReg: 12.52277) QuantErr: 12.52277 batch_time=0.38028 
Train Epoch: 9 [931/1000 29792/32000 (93%)] Loss: 0.91102 (QuantReg: 12.17182) QuantErr: 12.17182 batch_time=0.34749 
Train Epoch: 9 [936/1000 29952/32000 (94%)] Loss: 1.31554 (QuantReg: 12.61518) QuantErr: 12.61518 batch_time=0.58845 
Train Epoch: 9 [941/1000 30112/32000 (94%)] Loss: 0.75915 (QuantReg: 12.10943) QuantErr: 12.10943 batch_time=0.51137 
Train Epoch: 9 [946/1000 30272/32000 (95%)] Loss: 0.57085 (QuantReg: 12.05897) QuantErr: 12.05897 batch_time=0.35008 
Train Epoch: 9 [951/1000 30432/32000 (95%)] Loss: 0.60385 (QuantReg: 12.27609) QuantErr: 12.27609 batch_time=0.34655 
Train Epoch: 9 [956/1000 30592/32000 (96%)] Loss: 0.95830 (QuantReg: 12.84035) QuantErr: 12.84035 batch_time=0.36647 
Train Epoch: 9 [961/1000 30752/32000 (96%)] Loss: 0.31930 (QuantReg: 12.80813) QuantErr: 12.80813 batch_time=0.43372 
Train Epoch: 9 [966/1000 30912/32000 (97%)] Loss: 0.55409 (QuantReg: 12.22538) QuantErr: 12.22538 batch_time=0.35529 
Train Epoch: 9 [971/1000 31072/32000 (97%)] Loss: 0.49816 (QuantReg: 12.44373) QuantErr: 12.44373 batch_time=0.44145 
Train Epoch: 9 [976/1000 31232/32000 (98%)] Loss: 0.67764 (QuantReg: 12.26482) QuantErr: 12.26482 batch_time=0.95169 
Train Epoch: 9 [981/1000 31392/32000 (98%)] Loss: 1.41907 (QuantReg: 11.42773) QuantErr: 11.42773 batch_time=0.46788 
Train Epoch: 9 [986/1000 31552/32000 (99%)] Loss: 1.17344 (QuantReg: 12.27136) QuantErr: 12.27136 batch_time=0.75066 
Train Epoch: 9 [991/1000 31712/32000 (99%)] Loss: 1.52390 (QuantReg: 11.81936) QuantErr: 11.81936 batch_time=0.34953 
Train Epoch: 9 [996/1000 31872/32000 (100%)] Loss: 0.67270 (QuantReg: 12.19890) QuantErr: 12.19890 batch_time=0.42897 
Train Epoch: 9 codebook_update_time=2.32526
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch9.pth ...
Done in 7.227s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch9.pth ...
Done in 14.724s
removing stale ckpt [epoch 8] [took 0.27s]
 epoch          : 9
 loss           : 0.8380551458448171
 quant_reg      : 12.112817934989929
 quant_err      : 12.112817934989929
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 9000
 MSRVTT_miech_test/t2v_metrics/R1: 15.9
 MSRVTT_miech_test/t2v_metrics/R5: 43.7
 MSRVTT_miech_test/t2v_metrics/R10: 58.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.183
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.40266283244977
 MSRVTT_miech_test/v2t_metrics/R1: 16.5
 MSRVTT_miech_test/v2t_metrics/R5: 46.1
 MSRVTT_miech_test/v2t_metrics/R10: 59.3
 MSRVTT_miech_test/v2t_metrics/R50: 87.5
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.19
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.596982711493986
 mnt_best       : 34.40266283244977
 not_improved_count: 0
Train Epoch: 10 [1/1000 32/32000 (0%)] Loss: 1.09537 (QuantReg: 11.01885) QuantErr: 11.01885 batch_time=30.97359 
Train Epoch: 10 [6/1000 192/32000 (1%)] Loss: 0.72879 (QuantReg: 12.66285) QuantErr: 12.66285 batch_time=0.47505 
Train Epoch: 10 [11/1000 352/32000 (1%)] Loss: 0.58007 (QuantReg: 11.32273) QuantErr: 11.32273 batch_time=0.35981 
Train Epoch: 10 [16/1000 512/32000 (2%)] Loss: 0.41346 (QuantReg: 11.37270) QuantErr: 11.37270 batch_time=0.98192 
Train Epoch: 10 [21/1000 672/32000 (2%)] Loss: 0.53898 (QuantReg: 11.40377) QuantErr: 11.40377 batch_time=0.42082 
Train Epoch: 10 [26/1000 832/32000 (3%)] Loss: 0.79970 (QuantReg: 12.18315) QuantErr: 12.18315 batch_time=0.36092 
Train Epoch: 10 [31/1000 992/32000 (3%)] Loss: 1.06538 (QuantReg: 11.55950) QuantErr: 11.55950 batch_time=0.37383 
Train Epoch: 10 [36/1000 1152/32000 (4%)] Loss: 0.65089 (QuantReg: 11.43593) QuantErr: 11.43593 batch_time=0.46677 
Train Epoch: 10 [41/1000 1312/32000 (4%)] Loss: 0.47755 (QuantReg: 11.94447) QuantErr: 11.94447 batch_time=0.39970 
Train Epoch: 10 [46/1000 1472/32000 (5%)] Loss: 0.55791 (QuantReg: 11.96969) QuantErr: 11.96969 batch_time=0.37805 
Train Epoch: 10 [51/1000 1632/32000 (5%)] Loss: 0.93777 (QuantReg: 12.21031) QuantErr: 12.21031 batch_time=0.38667 
Train Epoch: 10 [56/1000 1792/32000 (6%)] Loss: 0.52982 (QuantReg: 12.50434) QuantErr: 12.50434 batch_time=0.39998 
Train Epoch: 10 [61/1000 1952/32000 (6%)] Loss: 0.51465 (QuantReg: 12.04365) QuantErr: 12.04365 batch_time=0.37073 
Train Epoch: 10 [66/1000 2112/32000 (7%)] Loss: 0.63633 (QuantReg: 12.06936) QuantErr: 12.06936 batch_time=0.37821 
Train Epoch: 10 [71/1000 2272/32000 (7%)] Loss: 0.44786 (QuantReg: 12.14144) QuantErr: 12.14144 batch_time=0.35091 
Train Epoch: 10 [76/1000 2432/32000 (8%)] Loss: 0.66850 (QuantReg: 11.58001) QuantErr: 11.58001 batch_time=0.73195 
Train Epoch: 10 [81/1000 2592/32000 (8%)] Loss: 0.38092 (QuantReg: 12.82225) QuantErr: 12.82225 batch_time=0.35141 
Train Epoch: 10 [86/1000 2752/32000 (9%)] Loss: 0.95999 (QuantReg: 11.47819) QuantErr: 11.47819 batch_time=0.42175 
Train Epoch: 10 [91/1000 2912/32000 (9%)] Loss: 0.90940 (QuantReg: 11.23025) QuantErr: 11.23025 batch_time=2.13618 
Train Epoch: 10 [96/1000 3072/32000 (10%)] Loss: 0.55772 (QuantReg: 11.53367) QuantErr: 11.53367 batch_time=0.39684 
Train Epoch: 10 [101/1000 3232/32000 (10%)] Loss: 0.61702 (QuantReg: 11.99239) QuantErr: 11.99239 batch_time=0.42744 
Train Epoch: 10 [106/1000 3392/32000 (11%)] Loss: 1.01974 (QuantReg: 12.06330) QuantErr: 12.06330 batch_time=0.34699 
Train Epoch: 10 [111/1000 3552/32000 (11%)] Loss: 0.25005 (QuantReg: 11.47761) QuantErr: 11.47761 batch_time=0.35890 
Train Epoch: 10 [116/1000 3712/32000 (12%)] Loss: 0.71369 (QuantReg: 11.87363) QuantErr: 11.87363 batch_time=0.50426 
Train Epoch: 10 [121/1000 3872/32000 (12%)] Loss: 0.45500 (QuantReg: 11.00367) QuantErr: 11.00367 batch_time=0.35910 
Train Epoch: 10 [126/1000 4032/32000 (13%)] Loss: 1.33984 (QuantReg: 11.61921) QuantErr: 11.61921 batch_time=0.35483 
Train Epoch: 10 [131/1000 4192/32000 (13%)] Loss: 0.63285 (QuantReg: 11.83821) QuantErr: 11.83821 batch_time=0.42822 
Train Epoch: 10 [136/1000 4352/32000 (14%)] Loss: 0.95222 (QuantReg: 11.57965) QuantErr: 11.57965 batch_time=0.34257 
Train Epoch: 10 [141/1000 4512/32000 (14%)] Loss: 0.46070 (QuantReg: 12.30687) QuantErr: 12.30687 batch_time=0.36390 
Train Epoch: 10 [146/1000 4672/32000 (15%)] Loss: 0.58554 (QuantReg: 12.42056) QuantErr: 12.42056 batch_time=0.43816 
Train Epoch: 10 [151/1000 4832/32000 (15%)] Loss: 0.43824 (QuantReg: 12.02563) QuantErr: 12.02563 batch_time=0.44106 
Train Epoch: 10 [156/1000 4992/32000 (16%)] Loss: 0.55451 (QuantReg: 11.91301) QuantErr: 11.91301 batch_time=0.34884 
Train Epoch: 10 [161/1000 5152/32000 (16%)] Loss: 1.22264 (QuantReg: 12.07797) QuantErr: 12.07797 batch_time=0.48810 
Train Epoch: 10 [166/1000 5312/32000 (17%)] Loss: 0.84134 (QuantReg: 11.65030) QuantErr: 11.65030 batch_time=0.40039 
Train Epoch: 10 [171/1000 5472/32000 (17%)] Loss: 0.84958 (QuantReg: 11.56089) QuantErr: 11.56089 batch_time=0.40194 
Train Epoch: 10 [176/1000 5632/32000 (18%)] Loss: 0.62141 (QuantReg: 11.86168) QuantErr: 11.86168 batch_time=0.34531 
Train Epoch: 10 [181/1000 5792/32000 (18%)] Loss: 1.63086 (QuantReg: 11.38881) QuantErr: 11.38881 batch_time=0.35457 
Train Epoch: 10 [186/1000 5952/32000 (19%)] Loss: 1.35204 (QuantReg: 11.92792) QuantErr: 11.92792 batch_time=0.44519 
Train Epoch: 10 [191/1000 6112/32000 (19%)] Loss: 0.83216 (QuantReg: 11.38053) QuantErr: 11.38053 batch_time=0.36959 
Train Epoch: 10 [196/1000 6272/32000 (20%)] Loss: 0.98420 (QuantReg: 11.78933) QuantErr: 11.78933 batch_time=0.43453 
Train Epoch: 10 [201/1000 6432/32000 (20%)] Loss: 1.19007 (QuantReg: 11.46880) QuantErr: 11.46880 batch_time=0.42622 
Train Epoch: 10 [206/1000 6592/32000 (21%)] Loss: 0.72623 (QuantReg: 11.75769) QuantErr: 11.75769 batch_time=0.70719 
Train Epoch: 10 [211/1000 6752/32000 (21%)] Loss: 0.47757 (QuantReg: 11.82528) QuantErr: 11.82528 batch_time=0.42442 
Train Epoch: 10 [216/1000 6912/32000 (22%)] Loss: 0.88583 (QuantReg: 11.36951) QuantErr: 11.36951 batch_time=0.35638 
Train Epoch: 10 [221/1000 7072/32000 (22%)] Loss: 0.93706 (QuantReg: 11.59635) QuantErr: 11.59635 batch_time=0.36320 
Train Epoch: 10 [226/1000 7232/32000 (23%)] Loss: 0.75236 (QuantReg: 12.04701) QuantErr: 12.04701 batch_time=0.35777 
Train Epoch: 10 [231/1000 7392/32000 (23%)] Loss: 1.00495 (QuantReg: 11.72699) QuantErr: 11.72699 batch_time=0.37623 
Train Epoch: 10 [236/1000 7552/32000 (24%)] Loss: 0.58295 (QuantReg: 11.44052) QuantErr: 11.44052 batch_time=0.36869 
Train Epoch: 10 [241/1000 7712/32000 (24%)] Loss: 0.49483 (QuantReg: 11.41033) QuantErr: 11.41033 batch_time=0.36265 
Train Epoch: 10 [246/1000 7872/32000 (25%)] Loss: 1.22977 (QuantReg: 12.01328) QuantErr: 12.01328 batch_time=0.36330 
Train Epoch: 10 [251/1000 8032/32000 (25%)] Loss: 1.14567 (QuantReg: 12.18231) QuantErr: 12.18231 batch_time=0.63159 
Train Epoch: 10 [256/1000 8192/32000 (26%)] Loss: 1.08634 (QuantReg: 12.17013) QuantErr: 12.17013 batch_time=0.33918 
Train Epoch: 10 [261/1000 8352/32000 (26%)] Loss: 0.51677 (QuantReg: 11.70358) QuantErr: 11.70358 batch_time=0.35421 
Train Epoch: 10 [266/1000 8512/32000 (27%)] Loss: 0.53337 (QuantReg: 12.30393) QuantErr: 12.30393 batch_time=0.43734 
Train Epoch: 10 [271/1000 8672/32000 (27%)] Loss: 0.37495 (QuantReg: 12.78648) QuantErr: 12.78648 batch_time=0.43721 
Train Epoch: 10 [276/1000 8832/32000 (28%)] Loss: 0.50134 (QuantReg: 11.71733) QuantErr: 11.71733 batch_time=0.36271 
Train Epoch: 10 [281/1000 8992/32000 (28%)] Loss: 1.05926 (QuantReg: 11.53231) QuantErr: 11.53231 batch_time=0.41582 
Train Epoch: 10 [286/1000 9152/32000 (29%)] Loss: 0.97012 (QuantReg: 12.26583) QuantErr: 12.26583 batch_time=0.43794 
Train Epoch: 10 [291/1000 9312/32000 (29%)] Loss: 0.77105 (QuantReg: 12.07026) QuantErr: 12.07026 batch_time=0.35653 
Train Epoch: 10 [296/1000 9472/32000 (30%)] Loss: 0.72705 (QuantReg: 11.53369) QuantErr: 11.53369 batch_time=0.87726 
Train Epoch: 10 [301/1000 9632/32000 (30%)] Loss: 0.42587 (QuantReg: 12.45392) QuantErr: 12.45392 batch_time=0.35194 
Train Epoch: 10 [306/1000 9792/32000 (31%)] Loss: 0.61065 (QuantReg: 12.05388) QuantErr: 12.05388 batch_time=0.51431 
Train Epoch: 10 [311/1000 9952/32000 (31%)] Loss: 0.38435 (QuantReg: 12.09170) QuantErr: 12.09170 batch_time=0.38233 
Train Epoch: 10 [316/1000 10112/32000 (32%)] Loss: 1.18328 (QuantReg: 12.02732) QuantErr: 12.02732 batch_time=0.46099 
Train Epoch: 10 [321/1000 10272/32000 (32%)] Loss: 0.80236 (QuantReg: 12.46778) QuantErr: 12.46778 batch_time=0.39329 
Train Epoch: 10 [326/1000 10432/32000 (33%)] Loss: 0.54603 (QuantReg: 12.13644) QuantErr: 12.13644 batch_time=0.40895 
Train Epoch: 10 [331/1000 10592/32000 (33%)] Loss: 0.95953 (QuantReg: 12.55860) QuantErr: 12.55860 batch_time=0.45860 
Train Epoch: 10 [336/1000 10752/32000 (34%)] Loss: 0.73589 (QuantReg: 12.07409) QuantErr: 12.07409 batch_time=0.33794 
Train Epoch: 10 [341/1000 10912/32000 (34%)] Loss: 0.36678 (QuantReg: 11.62024) QuantErr: 11.62024 batch_time=0.59441 
Train Epoch: 10 [346/1000 11072/32000 (35%)] Loss: 0.99074 (QuantReg: 11.73966) QuantErr: 11.73966 batch_time=0.33809 
Train Epoch: 10 [351/1000 11232/32000 (35%)] Loss: 1.13571 (QuantReg: 12.27611) QuantErr: 12.27611 batch_time=0.35835 
Train Epoch: 10 [356/1000 11392/32000 (36%)] Loss: 0.75563 (QuantReg: 11.05174) QuantErr: 11.05174 batch_time=0.35147 
Train Epoch: 10 [361/1000 11552/32000 (36%)] Loss: 0.67588 (QuantReg: 12.05196) QuantErr: 12.05196 batch_time=0.42569 
Train Epoch: 10 [366/1000 11712/32000 (37%)] Loss: 1.40494 (QuantReg: 12.18674) QuantErr: 12.18674 batch_time=0.47540 
Train Epoch: 10 [371/1000 11872/32000 (37%)] Loss: 0.32980 (QuantReg: 12.10359) QuantErr: 12.10359 batch_time=0.44227 
Train Epoch: 10 [376/1000 12032/32000 (38%)] Loss: 0.47878 (QuantReg: 11.92607) QuantErr: 11.92607 batch_time=0.34443 
Train Epoch: 10 [381/1000 12192/32000 (38%)] Loss: 0.68606 (QuantReg: 11.67639) QuantErr: 11.67639 batch_time=0.36406 
Train Epoch: 10 [386/1000 12352/32000 (39%)] Loss: 0.89047 (QuantReg: 12.03171) QuantErr: 12.03171 batch_time=0.95838 
Train Epoch: 10 [391/1000 12512/32000 (39%)] Loss: 0.71074 (QuantReg: 11.82310) QuantErr: 11.82310 batch_time=1.35766 
Train Epoch: 10 [396/1000 12672/32000 (40%)] Loss: 0.39369 (QuantReg: 11.92362) QuantErr: 11.92362 batch_time=0.36463 
Train Epoch: 10 [401/1000 12832/32000 (40%)] Loss: 0.60555 (QuantReg: 11.30948) QuantErr: 11.30948 batch_time=0.35570 
Train Epoch: 10 [406/1000 12992/32000 (41%)] Loss: 0.56690 (QuantReg: 11.76161) QuantErr: 11.76161 batch_time=0.44652 
Train Epoch: 10 [411/1000 13152/32000 (41%)] Loss: 0.54744 (QuantReg: 11.70930) QuantErr: 11.70930 batch_time=0.39476 
Train Epoch: 10 [416/1000 13312/32000 (42%)] Loss: 0.73663 (QuantReg: 11.74306) QuantErr: 11.74306 batch_time=0.35281 
Train Epoch: 10 [421/1000 13472/32000 (42%)] Loss: 0.51789 (QuantReg: 12.43359) QuantErr: 12.43359 batch_time=0.35254 
Train Epoch: 10 [426/1000 13632/32000 (43%)] Loss: 1.19605 (QuantReg: 12.22104) QuantErr: 12.22104 batch_time=0.34409 
Train Epoch: 10 [431/1000 13792/32000 (43%)] Loss: 0.72379 (QuantReg: 11.85464) QuantErr: 11.85464 batch_time=0.58692 
Train Epoch: 10 [436/1000 13952/32000 (44%)] Loss: 0.51503 (QuantReg: 11.64707) QuantErr: 11.64707 batch_time=0.35038 
Train Epoch: 10 [441/1000 14112/32000 (44%)] Loss: 0.59394 (QuantReg: 11.90331) QuantErr: 11.90331 batch_time=1.37684 
Train Epoch: 10 [446/1000 14272/32000 (45%)] Loss: 0.80835 (QuantReg: 12.24983) QuantErr: 12.24983 batch_time=0.37532 
Train Epoch: 10 [451/1000 14432/32000 (45%)] Loss: 0.67198 (QuantReg: 12.38456) QuantErr: 12.38456 batch_time=0.40553 
Train Epoch: 10 [456/1000 14592/32000 (46%)] Loss: 1.19129 (QuantReg: 11.24561) QuantErr: 11.24561 batch_time=0.41227 
Train Epoch: 10 [461/1000 14752/32000 (46%)] Loss: 0.48853 (QuantReg: 12.70503) QuantErr: 12.70503 batch_time=0.36376 
Train Epoch: 10 [466/1000 14912/32000 (47%)] Loss: 0.61784 (QuantReg: 11.91874) QuantErr: 11.91874 batch_time=0.48395 
Train Epoch: 10 [471/1000 15072/32000 (47%)] Loss: 0.78053 (QuantReg: 12.07800) QuantErr: 12.07800 batch_time=0.39099 
Train Epoch: 10 [476/1000 15232/32000 (48%)] Loss: 1.36038 (QuantReg: 12.21326) QuantErr: 12.21326 batch_time=0.70847 
Train Epoch: 10 [481/1000 15392/32000 (48%)] Loss: 0.97436 (QuantReg: 12.18563) QuantErr: 12.18563 batch_time=0.35000 
Train Epoch: 10 [486/1000 15552/32000 (49%)] Loss: 0.25321 (QuantReg: 12.68631) QuantErr: 12.68631 batch_time=0.46356 
Train Epoch: 10 [491/1000 15712/32000 (49%)] Loss: 0.83686 (QuantReg: 12.11407) QuantErr: 12.11407 batch_time=0.72527 
Train Epoch: 10 [496/1000 15872/32000 (50%)] Loss: 0.68192 (QuantReg: 11.30572) QuantErr: 11.30572 batch_time=0.34757 
Train Epoch: 10 [501/1000 16032/32000 (50%)] Loss: 0.50660 (QuantReg: 12.73793) QuantErr: 12.73793 batch_time=0.44967 
Train Epoch: 10 [506/1000 16192/32000 (51%)] Loss: 0.77485 (QuantReg: 12.41289) QuantErr: 12.41289 batch_time=0.40612 
Train Epoch: 10 [511/1000 16352/32000 (51%)] Loss: 0.53300 (QuantReg: 12.71961) QuantErr: 12.71961 batch_time=0.35710 
Train Epoch: 10 [516/1000 16512/32000 (52%)] Loss: 0.59440 (QuantReg: 12.33532) QuantErr: 12.33532 batch_time=0.40914 
Train Epoch: 10 [521/1000 16672/32000 (52%)] Loss: 0.92717 (QuantReg: 12.10426) QuantErr: 12.10426 batch_time=0.34899 
Train Epoch: 10 [526/1000 16832/32000 (53%)] Loss: 0.86039 (QuantReg: 12.27773) QuantErr: 12.27773 batch_time=0.45435 
Train Epoch: 10 [531/1000 16992/32000 (53%)] Loss: 0.97549 (QuantReg: 11.78185) QuantErr: 11.78185 batch_time=0.36542 
Train Epoch: 10 [536/1000 17152/32000 (54%)] Loss: 0.42153 (QuantReg: 13.13324) QuantErr: 13.13324 batch_time=0.46102 
Train Epoch: 10 [541/1000 17312/32000 (54%)] Loss: 0.97814 (QuantReg: 11.93612) QuantErr: 11.93612 batch_time=0.36867 
Train Epoch: 10 [546/1000 17472/32000 (55%)] Loss: 1.08507 (QuantReg: 12.58358) QuantErr: 12.58358 batch_time=0.42442 
Train Epoch: 10 [551/1000 17632/32000 (55%)] Loss: 1.30463 (QuantReg: 11.99483) QuantErr: 11.99483 batch_time=0.40509 
Train Epoch: 10 [556/1000 17792/32000 (56%)] Loss: 1.02124 (QuantReg: 12.01592) QuantErr: 12.01592 batch_time=0.46220 
Train Epoch: 10 [561/1000 17952/32000 (56%)] Loss: 0.58433 (QuantReg: 12.69319) QuantErr: 12.69319 batch_time=0.37618 
Train Epoch: 10 [566/1000 18112/32000 (57%)] Loss: 0.95077 (QuantReg: 12.82781) QuantErr: 12.82781 batch_time=0.85017 
Train Epoch: 10 [571/1000 18272/32000 (57%)] Loss: 0.67485 (QuantReg: 12.40840) QuantErr: 12.40840 batch_time=0.54387 
Train Epoch: 10 [576/1000 18432/32000 (58%)] Loss: 0.76166 (QuantReg: 12.36059) QuantErr: 12.36059 batch_time=0.38006 
Train Epoch: 10 [581/1000 18592/32000 (58%)] Loss: 0.43387 (QuantReg: 12.85298) QuantErr: 12.85298 batch_time=0.40935 
Train Epoch: 10 [586/1000 18752/32000 (59%)] Loss: 0.80445 (QuantReg: 12.34344) QuantErr: 12.34344 batch_time=0.35291 
Train Epoch: 10 [591/1000 18912/32000 (59%)] Loss: 0.77495 (QuantReg: 12.05934) QuantErr: 12.05934 batch_time=0.38092 
Train Epoch: 10 [596/1000 19072/32000 (60%)] Loss: 0.88734 (QuantReg: 11.72000) QuantErr: 11.72000 batch_time=0.87922 
Train Epoch: 10 [601/1000 19232/32000 (60%)] Loss: 1.05569 (QuantReg: 11.39214) QuantErr: 11.39214 batch_time=0.50510 
Train Epoch: 10 [606/1000 19392/32000 (61%)] Loss: 0.78804 (QuantReg: 12.09920) QuantErr: 12.09920 batch_time=0.37078 
Train Epoch: 10 [611/1000 19552/32000 (61%)] Loss: 1.05925 (QuantReg: 12.25837) QuantErr: 12.25837 batch_time=0.65982 
Train Epoch: 10 [616/1000 19712/32000 (62%)] Loss: 0.76249 (QuantReg: 12.29632) QuantErr: 12.29632 batch_time=0.35713 
Train Epoch: 10 [621/1000 19872/32000 (62%)] Loss: 0.97274 (QuantReg: 11.56181) QuantErr: 11.56181 batch_time=0.74865 
Train Epoch: 10 [626/1000 20032/32000 (63%)] Loss: 1.09794 (QuantReg: 11.68945) QuantErr: 11.68945 batch_time=0.39500 
Train Epoch: 10 [631/1000 20192/32000 (63%)] Loss: 0.91377 (QuantReg: 12.18212) QuantErr: 12.18212 batch_time=0.37195 
Train Epoch: 10 [636/1000 20352/32000 (64%)] Loss: 0.79810 (QuantReg: 12.00283) QuantErr: 12.00283 batch_time=0.37760 
Train Epoch: 10 [641/1000 20512/32000 (64%)] Loss: 0.39612 (QuantReg: 12.37700) QuantErr: 12.37700 batch_time=0.39092 
Train Epoch: 10 [646/1000 20672/32000 (65%)] Loss: 1.17715 (QuantReg: 11.90053) QuantErr: 11.90053 batch_time=0.47627 
Train Epoch: 10 [651/1000 20832/32000 (65%)] Loss: 0.57653 (QuantReg: 12.24759) QuantErr: 12.24759 batch_time=0.67827 
Train Epoch: 10 [656/1000 20992/32000 (66%)] Loss: 0.69123 (QuantReg: 11.90226) QuantErr: 11.90226 batch_time=0.59811 
Train Epoch: 10 [661/1000 21152/32000 (66%)] Loss: 0.44222 (QuantReg: 11.74628) QuantErr: 11.74628 batch_time=0.37023 
Train Epoch: 10 [666/1000 21312/32000 (67%)] Loss: 1.34070 (QuantReg: 12.32196) QuantErr: 12.32196 batch_time=0.43758 
Train Epoch: 10 [671/1000 21472/32000 (67%)] Loss: 0.83495 (QuantReg: 11.61407) QuantErr: 11.61407 batch_time=0.42599 
Train Epoch: 10 [676/1000 21632/32000 (68%)] Loss: 0.47492 (QuantReg: 12.19178) QuantErr: 12.19178 batch_time=0.34590 
Train Epoch: 10 [681/1000 21792/32000 (68%)] Loss: 0.53407 (QuantReg: 12.69087) QuantErr: 12.69087 batch_time=0.43863 
Train Epoch: 10 [686/1000 21952/32000 (69%)] Loss: 0.40908 (QuantReg: 12.32955) QuantErr: 12.32955 batch_time=0.68294 
Train Epoch: 10 [691/1000 22112/32000 (69%)] Loss: 1.97367 (QuantReg: 12.06238) QuantErr: 12.06238 batch_time=0.34398 
Train Epoch: 10 [696/1000 22272/32000 (70%)] Loss: 0.49991 (QuantReg: 12.12436) QuantErr: 12.12436 batch_time=0.53755 
Train Epoch: 10 [701/1000 22432/32000 (70%)] Loss: 0.58403 (QuantReg: 11.97558) QuantErr: 11.97558 batch_time=0.38978 
Train Epoch: 10 [706/1000 22592/32000 (71%)] Loss: 0.70061 (QuantReg: 12.18849) QuantErr: 12.18849 batch_time=0.53223 
Train Epoch: 10 [711/1000 22752/32000 (71%)] Loss: 0.54908 (QuantReg: 12.69329) QuantErr: 12.69329 batch_time=0.81903 
Train Epoch: 10 [716/1000 22912/32000 (72%)] Loss: 0.61169 (QuantReg: 12.45304) QuantErr: 12.45304 batch_time=0.36965 
Train Epoch: 10 [721/1000 23072/32000 (72%)] Loss: 0.93594 (QuantReg: 12.47432) QuantErr: 12.47432 batch_time=0.40913 
Train Epoch: 10 [726/1000 23232/32000 (73%)] Loss: 0.87007 (QuantReg: 11.88630) QuantErr: 11.88630 batch_time=0.43644 
Train Epoch: 10 [731/1000 23392/32000 (73%)] Loss: 0.76919 (QuantReg: 12.12514) QuantErr: 12.12514 batch_time=0.35747 
Train Epoch: 10 [736/1000 23552/32000 (74%)] Loss: 0.48194 (QuantReg: 12.27057) QuantErr: 12.27057 batch_time=0.45914 
Train Epoch: 10 [741/1000 23712/32000 (74%)] Loss: 0.69948 (QuantReg: 12.00434) QuantErr: 12.00434 batch_time=0.41186 
Train Epoch: 10 [746/1000 23872/32000 (75%)] Loss: 0.44937 (QuantReg: 11.94380) QuantErr: 11.94380 batch_time=0.36012 
Train Epoch: 10 [751/1000 24032/32000 (75%)] Loss: 0.32195 (QuantReg: 12.38342) QuantErr: 12.38342 batch_time=0.39459 
Train Epoch: 10 [756/1000 24192/32000 (76%)] Loss: 0.59883 (QuantReg: 12.88152) QuantErr: 12.88152 batch_time=0.37544 
Train Epoch: 10 [761/1000 24352/32000 (76%)] Loss: 0.90328 (QuantReg: 11.41338) QuantErr: 11.41338 batch_time=1.15955 
Train Epoch: 10 [766/1000 24512/32000 (77%)] Loss: 0.83511 (QuantReg: 13.02938) QuantErr: 13.02938 batch_time=0.38161 
Train Epoch: 10 [771/1000 24672/32000 (77%)] Loss: 0.81783 (QuantReg: 12.01721) QuantErr: 12.01721 batch_time=0.42450 
Train Epoch: 10 [776/1000 24832/32000 (78%)] Loss: 0.54595 (QuantReg: 12.20549) QuantErr: 12.20549 batch_time=0.35791 
Train Epoch: 10 [781/1000 24992/32000 (78%)] Loss: 1.18337 (QuantReg: 12.55170) QuantErr: 12.55170 batch_time=0.88598 
Train Epoch: 10 [786/1000 25152/32000 (79%)] Loss: 0.31511 (QuantReg: 12.32281) QuantErr: 12.32281 batch_time=0.35452 
Train Epoch: 10 [791/1000 25312/32000 (79%)] Loss: 0.58636 (QuantReg: 12.26669) QuantErr: 12.26669 batch_time=0.57187 
Train Epoch: 10 [796/1000 25472/32000 (80%)] Loss: 0.68347 (QuantReg: 12.26932) QuantErr: 12.26932 batch_time=0.35695 
Train Epoch: 10 [801/1000 25632/32000 (80%)] Loss: 0.14726 (QuantReg: 12.85790) QuantErr: 12.85790 batch_time=0.39494 
Train Epoch: 10 [806/1000 25792/32000 (81%)] Loss: 1.43486 (QuantReg: 12.85890) QuantErr: 12.85890 batch_time=0.36157 
Train Epoch: 10 [811/1000 25952/32000 (81%)] Loss: 1.02289 (QuantReg: 12.04084) QuantErr: 12.04084 batch_time=0.77987 
Train Epoch: 10 [816/1000 26112/32000 (82%)] Loss: 0.68948 (QuantReg: 12.49721) QuantErr: 12.49721 batch_time=0.55852 
Train Epoch: 10 [821/1000 26272/32000 (82%)] Loss: 1.03328 (QuantReg: 12.83903) QuantErr: 12.83903 batch_time=0.34274 
Train Epoch: 10 [826/1000 26432/32000 (83%)] Loss: 0.60925 (QuantReg: 12.38452) QuantErr: 12.38452 batch_time=0.50421 
Train Epoch: 10 [831/1000 26592/32000 (83%)] Loss: 0.36753 (QuantReg: 11.89529) QuantErr: 11.89529 batch_time=0.40583 
Train Epoch: 10 [836/1000 26752/32000 (84%)] Loss: 1.20548 (QuantReg: 12.44780) QuantErr: 12.44780 batch_time=0.44687 
Train Epoch: 10 [841/1000 26912/32000 (84%)] Loss: 1.05981 (QuantReg: 11.90872) QuantErr: 11.90872 batch_time=0.35525 
Train Epoch: 10 [846/1000 27072/32000 (85%)] Loss: 0.91988 (QuantReg: 11.62457) QuantErr: 11.62457 batch_time=0.43461 
Train Epoch: 10 [851/1000 27232/32000 (85%)] Loss: 0.66651 (QuantReg: 12.00558) QuantErr: 12.00558 batch_time=0.35718 
Train Epoch: 10 [856/1000 27392/32000 (86%)] Loss: 0.57615 (QuantReg: 12.76250) QuantErr: 12.76250 batch_time=0.39501 
Train Epoch: 10 [861/1000 27552/32000 (86%)] Loss: 0.40536 (QuantReg: 12.74323) QuantErr: 12.74323 batch_time=0.41418 
Train Epoch: 10 [866/1000 27712/32000 (87%)] Loss: 0.77782 (QuantReg: 12.36878) QuantErr: 12.36878 batch_time=0.45539 
Train Epoch: 10 [871/1000 27872/32000 (87%)] Loss: 1.21026 (QuantReg: 12.33434) QuantErr: 12.33434 batch_time=0.46919 
Train Epoch: 10 [876/1000 28032/32000 (88%)] Loss: 0.73127 (QuantReg: 12.58562) QuantErr: 12.58562 batch_time=0.34959 
Train Epoch: 10 [881/1000 28192/32000 (88%)] Loss: 0.65303 (QuantReg: 12.68681) QuantErr: 12.68681 batch_time=0.41163 
Train Epoch: 10 [886/1000 28352/32000 (89%)] Loss: 0.27435 (QuantReg: 11.95030) QuantErr: 11.95030 batch_time=0.35133 
Train Epoch: 10 [891/1000 28512/32000 (89%)] Loss: 0.38633 (QuantReg: 12.49518) QuantErr: 12.49518 batch_time=0.39849 
Train Epoch: 10 [896/1000 28672/32000 (90%)] Loss: 0.54200 (QuantReg: 11.27146) QuantErr: 11.27146 batch_time=0.35918 
Train Epoch: 10 [901/1000 28832/32000 (90%)] Loss: 0.56193 (QuantReg: 11.90461) QuantErr: 11.90461 batch_time=0.43870 
Train Epoch: 10 [906/1000 28992/32000 (91%)] Loss: 0.77618 (QuantReg: 11.99112) QuantErr: 11.99112 batch_time=0.35337 
Train Epoch: 10 [911/1000 29152/32000 (91%)] Loss: 0.59512 (QuantReg: 12.15056) QuantErr: 12.15056 batch_time=0.81716 
Train Epoch: 10 [916/1000 29312/32000 (92%)] Loss: 0.26315 (QuantReg: 12.16374) QuantErr: 12.16374 batch_time=1.37389 
Train Epoch: 10 [921/1000 29472/32000 (92%)] Loss: 0.56981 (QuantReg: 12.82917) QuantErr: 12.82917 batch_time=0.35919 
Train Epoch: 10 [926/1000 29632/32000 (93%)] Loss: 0.59905 (QuantReg: 12.44109) QuantErr: 12.44109 batch_time=0.51132 
Train Epoch: 10 [931/1000 29792/32000 (93%)] Loss: 0.73459 (QuantReg: 12.49688) QuantErr: 12.49688 batch_time=0.36296 
Train Epoch: 10 [936/1000 29952/32000 (94%)] Loss: 0.58933 (QuantReg: 12.31724) QuantErr: 12.31724 batch_time=0.36280 
Train Epoch: 10 [941/1000 30112/32000 (94%)] Loss: 0.84150 (QuantReg: 11.88223) QuantErr: 11.88223 batch_time=0.35985 
Train Epoch: 10 [946/1000 30272/32000 (95%)] Loss: 0.80139 (QuantReg: 12.71233) QuantErr: 12.71233 batch_time=0.41376 
Train Epoch: 10 [951/1000 30432/32000 (95%)] Loss: 0.77691 (QuantReg: 12.64715) QuantErr: 12.64715 batch_time=0.51623 
Train Epoch: 10 [956/1000 30592/32000 (96%)] Loss: 0.96777 (QuantReg: 12.42349) QuantErr: 12.42349 batch_time=0.65687 
Train Epoch: 10 [961/1000 30752/32000 (96%)] Loss: 0.57966 (QuantReg: 12.07009) QuantErr: 12.07009 batch_time=0.51289 
Train Epoch: 10 [966/1000 30912/32000 (97%)] Loss: 0.66566 (QuantReg: 12.58562) QuantErr: 12.58562 batch_time=0.38494 
Train Epoch: 10 [971/1000 31072/32000 (97%)] Loss: 0.58086 (QuantReg: 12.11278) QuantErr: 12.11278 batch_time=0.39303 
Train Epoch: 10 [976/1000 31232/32000 (98%)] Loss: 0.87401 (QuantReg: 12.05397) QuantErr: 12.05397 batch_time=0.39365 
Train Epoch: 10 [981/1000 31392/32000 (98%)] Loss: 0.66334 (QuantReg: 12.11013) QuantErr: 12.11013 batch_time=0.44949 
Train Epoch: 10 [986/1000 31552/32000 (99%)] Loss: 1.07066 (QuantReg: 12.72519) QuantErr: 12.72519 batch_time=0.40085 
Train Epoch: 10 [991/1000 31712/32000 (99%)] Loss: 0.42054 (QuantReg: 12.59677) QuantErr: 12.59677 batch_time=0.50842 
Train Epoch: 10 [996/1000 31872/32000 (100%)] Loss: 1.10704 (QuantReg: 11.60908) QuantErr: 11.60908 batch_time=0.34318 
Train Epoch: 10 codebook_update_time=1.98446
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch10.pth ...
Done in 7.939s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch10.pth ...
Done in 13.840s
removing stale ckpt [epoch 9] [took 0.03s]
 epoch          : 10
 loss           : 0.7678576910495758
 quant_reg      : 12.112621201515198
 quant_err      : 12.112621201515198
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 10000
 MSRVTT_miech_test/t2v_metrics/R1: 16.5
 MSRVTT_miech_test/t2v_metrics/R5: 45.9
 MSRVTT_miech_test/t2v_metrics/R10: 59.1
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.39
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.50542402079222
 MSRVTT_miech_test/v2t_metrics/R1: 16.8
 MSRVTT_miech_test/v2t_metrics/R5: 46.5
 MSRVTT_miech_test/v2t_metrics/R10: 60.1
 MSRVTT_miech_test/v2t_metrics/R50: 87.3
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.8355
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.075489740254916
 mnt_best       : 35.50542402079222
 not_improved_count: 0
Train Epoch: 11 [1/1000 32/32000 (0%)] Loss: 0.49494 (QuantReg: 12.36040) QuantErr: 12.36040 batch_time=27.86231 
Train Epoch: 11 [6/1000 192/32000 (1%)] Loss: 0.99279 (QuantReg: 11.60100) QuantErr: 11.60100 batch_time=0.33905 
Train Epoch: 11 [11/1000 352/32000 (1%)] Loss: 0.50907 (QuantReg: 11.21925) QuantErr: 11.21925 batch_time=0.36239 
Train Epoch: 11 [16/1000 512/32000 (2%)] Loss: 0.67561 (QuantReg: 11.32963) QuantErr: 11.32963 batch_time=0.36853 
Train Epoch: 11 [21/1000 672/32000 (2%)] Loss: 0.85386 (QuantReg: 11.54230) QuantErr: 11.54230 batch_time=0.33658 
Train Epoch: 11 [26/1000 832/32000 (3%)] Loss: 0.49936 (QuantReg: 12.33938) QuantErr: 12.33938 batch_time=0.40649 
Train Epoch: 11 [31/1000 992/32000 (3%)] Loss: 0.47475 (QuantReg: 12.34939) QuantErr: 12.34939 batch_time=0.40776 
Train Epoch: 11 [36/1000 1152/32000 (4%)] Loss: 0.92390 (QuantReg: 12.24399) QuantErr: 12.24399 batch_time=0.37719 
Train Epoch: 11 [41/1000 1312/32000 (4%)] Loss: 0.61369 (QuantReg: 11.35233) QuantErr: 11.35233 batch_time=0.44310 
Train Epoch: 11 [46/1000 1472/32000 (5%)] Loss: 1.25348 (QuantReg: 12.63268) QuantErr: 12.63268 batch_time=0.42198 
Train Epoch: 11 [51/1000 1632/32000 (5%)] Loss: 0.73366 (QuantReg: 11.69536) QuantErr: 11.69536 batch_time=0.37722 
Train Epoch: 11 [56/1000 1792/32000 (6%)] Loss: 1.22702 (QuantReg: 12.68156) QuantErr: 12.68156 batch_time=0.34739 
Train Epoch: 11 [61/1000 1952/32000 (6%)] Loss: 0.71099 (QuantReg: 12.04699) QuantErr: 12.04699 batch_time=0.49551 
Train Epoch: 11 [66/1000 2112/32000 (7%)] Loss: 1.56280 (QuantReg: 11.55971) QuantErr: 11.55971 batch_time=0.67279 
Train Epoch: 11 [71/1000 2272/32000 (7%)] Loss: 0.75522 (QuantReg: 11.58492) QuantErr: 11.58492 batch_time=0.34430 
Train Epoch: 11 [76/1000 2432/32000 (8%)] Loss: 0.96376 (QuantReg: 12.20419) QuantErr: 12.20419 batch_time=0.41519 
Train Epoch: 11 [81/1000 2592/32000 (8%)] Loss: 0.98001 (QuantReg: 11.60068) QuantErr: 11.60068 batch_time=2.04452 
Train Epoch: 11 [86/1000 2752/32000 (9%)] Loss: 0.71673 (QuantReg: 10.85970) QuantErr: 10.85970 batch_time=0.41197 
Train Epoch: 11 [91/1000 2912/32000 (9%)] Loss: 0.61857 (QuantReg: 12.42613) QuantErr: 12.42613 batch_time=0.36586 
Train Epoch: 11 [96/1000 3072/32000 (10%)] Loss: 0.42689 (QuantReg: 11.93549) QuantErr: 11.93549 batch_time=0.58829 
Train Epoch: 11 [101/1000 3232/32000 (10%)] Loss: 0.63087 (QuantReg: 11.97927) QuantErr: 11.97927 batch_time=0.35137 
Train Epoch: 11 [106/1000 3392/32000 (11%)] Loss: 0.36740 (QuantReg: 11.19996) QuantErr: 11.19996 batch_time=0.72523 
Train Epoch: 11 [111/1000 3552/32000 (11%)] Loss: 1.54022 (QuantReg: 12.09141) QuantErr: 12.09141 batch_time=0.34183 
Train Epoch: 11 [116/1000 3712/32000 (12%)] Loss: 0.28595 (QuantReg: 11.04136) QuantErr: 11.04136 batch_time=0.45455 
Train Epoch: 11 [121/1000 3872/32000 (12%)] Loss: 0.58736 (QuantReg: 12.53052) QuantErr: 12.53052 batch_time=0.39292 
Train Epoch: 11 [126/1000 4032/32000 (13%)] Loss: 0.75480 (QuantReg: 12.43031) QuantErr: 12.43031 batch_time=0.43632 
Train Epoch: 11 [131/1000 4192/32000 (13%)] Loss: 0.90761 (QuantReg: 11.62932) QuantErr: 11.62932 batch_time=0.37370 
Train Epoch: 11 [136/1000 4352/32000 (14%)] Loss: 0.88548 (QuantReg: 11.55618) QuantErr: 11.55618 batch_time=0.45317 
Train Epoch: 11 [141/1000 4512/32000 (14%)] Loss: 1.08226 (QuantReg: 11.80710) QuantErr: 11.80710 batch_time=0.37258 
Train Epoch: 11 [146/1000 4672/32000 (15%)] Loss: 0.76402 (QuantReg: 11.50018) QuantErr: 11.50018 batch_time=0.67675 
Train Epoch: 11 [151/1000 4832/32000 (15%)] Loss: 0.89342 (QuantReg: 11.94831) QuantErr: 11.94831 batch_time=0.49598 
Train Epoch: 11 [156/1000 4992/32000 (16%)] Loss: 0.53832 (QuantReg: 12.22968) QuantErr: 12.22968 batch_time=0.50432 
Train Epoch: 11 [161/1000 5152/32000 (16%)] Loss: 1.17231 (QuantReg: 11.97275) QuantErr: 11.97275 batch_time=0.51132 
Train Epoch: 11 [166/1000 5312/32000 (17%)] Loss: 0.55578 (QuantReg: 12.16436) QuantErr: 12.16436 batch_time=0.38800 
Train Epoch: 11 [171/1000 5472/32000 (17%)] Loss: 0.64735 (QuantReg: 12.34853) QuantErr: 12.34853 batch_time=0.35528 
Train Epoch: 11 [176/1000 5632/32000 (18%)] Loss: 0.72957 (QuantReg: 12.25905) QuantErr: 12.25905 batch_time=0.35463 
Train Epoch: 11 [181/1000 5792/32000 (18%)] Loss: 1.13427 (QuantReg: 12.45468) QuantErr: 12.45468 batch_time=0.36609 
Train Epoch: 11 [186/1000 5952/32000 (19%)] Loss: 0.55962 (QuantReg: 11.91803) QuantErr: 11.91803 batch_time=0.59958 
Train Epoch: 11 [191/1000 6112/32000 (19%)] Loss: 1.04382 (QuantReg: 11.43471) QuantErr: 11.43471 batch_time=0.34278 
Train Epoch: 11 [196/1000 6272/32000 (20%)] Loss: 0.56944 (QuantReg: 11.36275) QuantErr: 11.36275 batch_time=1.01367 
Train Epoch: 11 [201/1000 6432/32000 (20%)] Loss: 0.29308 (QuantReg: 12.54283) QuantErr: 12.54283 batch_time=0.36348 
Train Epoch: 11 [206/1000 6592/32000 (21%)] Loss: 0.80986 (QuantReg: 12.23198) QuantErr: 12.23198 batch_time=0.44074 
Train Epoch: 11 [211/1000 6752/32000 (21%)] Loss: 0.78124 (QuantReg: 11.84997) QuantErr: 11.84997 batch_time=0.40933 
Train Epoch: 11 [216/1000 6912/32000 (22%)] Loss: 0.41959 (QuantReg: 11.85333) QuantErr: 11.85333 batch_time=0.34884 
Train Epoch: 11 [221/1000 7072/32000 (22%)] Loss: 0.47767 (QuantReg: 11.88085) QuantErr: 11.88085 batch_time=0.41223 
Train Epoch: 11 [226/1000 7232/32000 (23%)] Loss: 1.11336 (QuantReg: 11.14148) QuantErr: 11.14148 batch_time=0.36677 
Train Epoch: 11 [231/1000 7392/32000 (23%)] Loss: 1.26220 (QuantReg: 12.32903) QuantErr: 12.32903 batch_time=0.37007 
Train Epoch: 11 [236/1000 7552/32000 (24%)] Loss: 1.06979 (QuantReg: 11.44859) QuantErr: 11.44859 batch_time=0.82869 
Train Epoch: 11 [241/1000 7712/32000 (24%)] Loss: 0.85405 (QuantReg: 11.21812) QuantErr: 11.21812 batch_time=0.36874 
Train Epoch: 11 [246/1000 7872/32000 (25%)] Loss: 0.83111 (QuantReg: 12.40662) QuantErr: 12.40662 batch_time=0.43176 
Train Epoch: 11 [251/1000 8032/32000 (25%)] Loss: 0.66463 (QuantReg: 11.99126) QuantErr: 11.99126 batch_time=0.43622 
Train Epoch: 11 [256/1000 8192/32000 (26%)] Loss: 0.36232 (QuantReg: 12.11736) QuantErr: 12.11736 batch_time=0.35814 
Train Epoch: 11 [261/1000 8352/32000 (26%)] Loss: 0.68692 (QuantReg: 11.72847) QuantErr: 11.72847 batch_time=0.35597 
Train Epoch: 11 [266/1000 8512/32000 (27%)] Loss: 0.94008 (QuantReg: 12.52159) QuantErr: 12.52159 batch_time=0.37624 
Train Epoch: 11 [271/1000 8672/32000 (27%)] Loss: 0.64946 (QuantReg: 11.93256) QuantErr: 11.93256 batch_time=0.37101 
Train Epoch: 11 [276/1000 8832/32000 (28%)] Loss: 1.06126 (QuantReg: 11.31445) QuantErr: 11.31445 batch_time=0.32900 
Train Epoch: 11 [281/1000 8992/32000 (28%)] Loss: 0.26019 (QuantReg: 12.43768) QuantErr: 12.43768 batch_time=0.64552 
Train Epoch: 11 [286/1000 9152/32000 (29%)] Loss: 0.85994 (QuantReg: 11.25447) QuantErr: 11.25447 batch_time=0.41215 
Train Epoch: 11 [291/1000 9312/32000 (29%)] Loss: 0.98658 (QuantReg: 12.18487) QuantErr: 12.18487 batch_time=0.36692 
Train Epoch: 11 [296/1000 9472/32000 (30%)] Loss: 0.39519 (QuantReg: 12.31277) QuantErr: 12.31277 batch_time=0.40197 
Train Epoch: 11 [301/1000 9632/32000 (30%)] Loss: 0.74168 (QuantReg: 11.90420) QuantErr: 11.90420 batch_time=0.34844 
Train Epoch: 11 [306/1000 9792/32000 (31%)] Loss: 0.46838 (QuantReg: 11.99578) QuantErr: 11.99578 batch_time=0.39961 
Train Epoch: 11 [311/1000 9952/32000 (31%)] Loss: 0.81566 (QuantReg: 11.45320) QuantErr: 11.45320 batch_time=0.35126 
Train Epoch: 11 [316/1000 10112/32000 (32%)] Loss: 0.69132 (QuantReg: 12.17866) QuantErr: 12.17866 batch_time=0.37796 
Train Epoch: 11 [321/1000 10272/32000 (32%)] Loss: 0.54286 (QuantReg: 12.12887) QuantErr: 12.12887 batch_time=0.48522 
Train Epoch: 11 [326/1000 10432/32000 (33%)] Loss: 1.00409 (QuantReg: 12.06206) QuantErr: 12.06206 batch_time=0.37106 
Train Epoch: 11 [331/1000 10592/32000 (33%)] Loss: 0.60948 (QuantReg: 12.55668) QuantErr: 12.55668 batch_time=0.39543 
Train Epoch: 11 [336/1000 10752/32000 (34%)] Loss: 0.57124 (QuantReg: 12.21247) QuantErr: 12.21247 batch_time=0.38928 
Train Epoch: 11 [341/1000 10912/32000 (34%)] Loss: 0.57908 (QuantReg: 12.29852) QuantErr: 12.29852 batch_time=0.36616 
Train Epoch: 11 [346/1000 11072/32000 (35%)] Loss: 0.88007 (QuantReg: 12.68322) QuantErr: 12.68322 batch_time=0.41550 
Train Epoch: 11 [351/1000 11232/32000 (35%)] Loss: 0.38661 (QuantReg: 12.23362) QuantErr: 12.23362 batch_time=0.36726 
Train Epoch: 11 [356/1000 11392/32000 (36%)] Loss: 1.36254 (QuantReg: 12.11316) QuantErr: 12.11316 batch_time=0.35727 
Train Epoch: 11 [361/1000 11552/32000 (36%)] Loss: 1.06356 (QuantReg: 12.57875) QuantErr: 12.57875 batch_time=0.48459 
Train Epoch: 11 [366/1000 11712/32000 (37%)] Loss: 0.43278 (QuantReg: 12.69788) QuantErr: 12.69788 batch_time=0.39073 
Train Epoch: 11 [371/1000 11872/32000 (37%)] Loss: 0.35290 (QuantReg: 12.65278) QuantErr: 12.65278 batch_time=0.77455 
Train Epoch: 11 [376/1000 12032/32000 (38%)] Loss: 0.73734 (QuantReg: 12.95078) QuantErr: 12.95078 batch_time=0.36980 
Train Epoch: 11 [381/1000 12192/32000 (38%)] Loss: 0.85954 (QuantReg: 11.99929) QuantErr: 11.99929 batch_time=0.43560 
Train Epoch: 11 [386/1000 12352/32000 (39%)] Loss: 0.74421 (QuantReg: 11.41509) QuantErr: 11.41509 batch_time=0.37116 
Train Epoch: 11 [391/1000 12512/32000 (39%)] Loss: 0.64322 (QuantReg: 12.33903) QuantErr: 12.33903 batch_time=0.40369 
Train Epoch: 11 [396/1000 12672/32000 (40%)] Loss: 1.49608 (QuantReg: 11.59399) QuantErr: 11.59399 batch_time=0.39922 
Train Epoch: 11 [401/1000 12832/32000 (40%)] Loss: 0.57506 (QuantReg: 12.38364) QuantErr: 12.38364 batch_time=3.97971 
Train Epoch: 11 [406/1000 12992/32000 (41%)] Loss: 0.61570 (QuantReg: 11.30779) QuantErr: 11.30779 batch_time=0.34631 
Train Epoch: 11 [411/1000 13152/32000 (41%)] Loss: 0.48489 (QuantReg: 12.16438) QuantErr: 12.16438 batch_time=0.54266 
Train Epoch: 11 [416/1000 13312/32000 (42%)] Loss: 1.07578 (QuantReg: 12.16206) QuantErr: 12.16206 batch_time=0.33939 
Train Epoch: 11 [421/1000 13472/32000 (42%)] Loss: 0.56639 (QuantReg: 12.42772) QuantErr: 12.42772 batch_time=0.36396 
Train Epoch: 11 [426/1000 13632/32000 (43%)] Loss: 0.26723 (QuantReg: 12.18056) QuantErr: 12.18056 batch_time=0.48546 
Train Epoch: 11 [431/1000 13792/32000 (43%)] Loss: 0.59915 (QuantReg: 12.19436) QuantErr: 12.19436 batch_time=0.43708 
Train Epoch: 11 [436/1000 13952/32000 (44%)] Loss: 0.30844 (QuantReg: 12.40944) QuantErr: 12.40944 batch_time=0.38194 
Train Epoch: 11 [441/1000 14112/32000 (44%)] Loss: 0.72435 (QuantReg: 12.42658) QuantErr: 12.42658 batch_time=0.41285 
Train Epoch: 11 [446/1000 14272/32000 (45%)] Loss: 1.33015 (QuantReg: 12.28082) QuantErr: 12.28082 batch_time=0.44397 
Train Epoch: 11 [451/1000 14432/32000 (45%)] Loss: 0.87775 (QuantReg: 11.87711) QuantErr: 11.87711 batch_time=0.48922 
Train Epoch: 11 [456/1000 14592/32000 (46%)] Loss: 0.53205 (QuantReg: 12.28553) QuantErr: 12.28553 batch_time=0.67989 
Train Epoch: 11 [461/1000 14752/32000 (46%)] Loss: 0.97286 (QuantReg: 11.97289) QuantErr: 11.97289 batch_time=0.36152 
Train Epoch: 11 [466/1000 14912/32000 (47%)] Loss: 0.44632 (QuantReg: 11.55808) QuantErr: 11.55808 batch_time=0.34684 
Train Epoch: 11 [471/1000 15072/32000 (47%)] Loss: 0.58876 (QuantReg: 11.68026) QuantErr: 11.68026 batch_time=0.34582 
Train Epoch: 11 [476/1000 15232/32000 (48%)] Loss: 0.53231 (QuantReg: 11.99000) QuantErr: 11.99000 batch_time=0.34862 
Train Epoch: 11 [481/1000 15392/32000 (48%)] Loss: 0.55636 (QuantReg: 10.96523) QuantErr: 10.96523 batch_time=0.35052 
Train Epoch: 11 [486/1000 15552/32000 (49%)] Loss: 0.56289 (QuantReg: 13.11544) QuantErr: 13.11544 batch_time=0.36023 
Train Epoch: 11 [491/1000 15712/32000 (49%)] Loss: 0.61087 (QuantReg: 11.81032) QuantErr: 11.81032 batch_time=0.37101 
Train Epoch: 11 [496/1000 15872/32000 (50%)] Loss: 0.74346 (QuantReg: 13.17717) QuantErr: 13.17717 batch_time=0.43642 
Train Epoch: 11 [501/1000 16032/32000 (50%)] Loss: 0.98091 (QuantReg: 11.93882) QuantErr: 11.93882 batch_time=0.35148 
Train Epoch: 11 [506/1000 16192/32000 (51%)] Loss: 0.45406 (QuantReg: 12.65759) QuantErr: 12.65759 batch_time=0.84727 
Train Epoch: 11 [511/1000 16352/32000 (51%)] Loss: 0.54935 (QuantReg: 12.17084) QuantErr: 12.17084 batch_time=0.34035 
Train Epoch: 11 [516/1000 16512/32000 (52%)] Loss: 0.66589 (QuantReg: 12.11643) QuantErr: 12.11643 batch_time=0.33693 
Train Epoch: 11 [521/1000 16672/32000 (52%)] Loss: 0.67343 (QuantReg: 11.77438) QuantErr: 11.77438 batch_time=0.39479 
Train Epoch: 11 [526/1000 16832/32000 (53%)] Loss: 0.83120 (QuantReg: 11.72150) QuantErr: 11.72150 batch_time=0.42112 
Train Epoch: 11 [531/1000 16992/32000 (53%)] Loss: 1.38773 (QuantReg: 11.91234) QuantErr: 11.91234 batch_time=0.40583 
Train Epoch: 11 [536/1000 17152/32000 (54%)] Loss: 0.62810 (QuantReg: 11.74264) QuantErr: 11.74264 batch_time=0.61688 
Train Epoch: 11 [541/1000 17312/32000 (54%)] Loss: 1.34128 (QuantReg: 12.63767) QuantErr: 12.63767 batch_time=0.41700 
Train Epoch: 11 [546/1000 17472/32000 (55%)] Loss: 0.58346 (QuantReg: 12.92299) QuantErr: 12.92299 batch_time=0.35763 
Train Epoch: 11 [551/1000 17632/32000 (55%)] Loss: 0.76154 (QuantReg: 11.71586) QuantErr: 11.71586 batch_time=0.76553 
Train Epoch: 11 [556/1000 17792/32000 (56%)] Loss: 1.36285 (QuantReg: 12.71998) QuantErr: 12.71998 batch_time=0.38109 
Train Epoch: 11 [561/1000 17952/32000 (56%)] Loss: 0.53794 (QuantReg: 11.98101) QuantErr: 11.98101 batch_time=0.37207 
Train Epoch: 11 [566/1000 18112/32000 (57%)] Loss: 0.42663 (QuantReg: 12.55923) QuantErr: 12.55923 batch_time=0.57264 
Train Epoch: 11 [571/1000 18272/32000 (57%)] Loss: 0.33282 (QuantReg: 12.34544) QuantErr: 12.34544 batch_time=0.36366 
Train Epoch: 11 [576/1000 18432/32000 (58%)] Loss: 0.60391 (QuantReg: 12.13203) QuantErr: 12.13203 batch_time=0.34711 
Train Epoch: 11 [581/1000 18592/32000 (58%)] Loss: 0.80494 (QuantReg: 12.64988) QuantErr: 12.64988 batch_time=0.37758 
Train Epoch: 11 [586/1000 18752/32000 (59%)] Loss: 0.60723 (QuantReg: 12.00453) QuantErr: 12.00453 batch_time=0.41106 
Train Epoch: 11 [591/1000 18912/32000 (59%)] Loss: 0.65955 (QuantReg: 12.06955) QuantErr: 12.06955 batch_time=0.40011 
Train Epoch: 11 [596/1000 19072/32000 (60%)] Loss: 0.29207 (QuantReg: 12.24513) QuantErr: 12.24513 batch_time=0.72479 
Train Epoch: 11 [601/1000 19232/32000 (60%)] Loss: 0.41417 (QuantReg: 12.53395) QuantErr: 12.53395 batch_time=0.33862 
Train Epoch: 11 [606/1000 19392/32000 (61%)] Loss: 0.48665 (QuantReg: 12.07588) QuantErr: 12.07588 batch_time=0.54813 
Train Epoch: 11 [611/1000 19552/32000 (61%)] Loss: 0.93025 (QuantReg: 12.17346) QuantErr: 12.17346 batch_time=0.46152 
Train Epoch: 11 [616/1000 19712/32000 (62%)] Loss: 1.03350 (QuantReg: 12.24563) QuantErr: 12.24563 batch_time=0.51886 
Train Epoch: 11 [621/1000 19872/32000 (62%)] Loss: 0.90637 (QuantReg: 12.00766) QuantErr: 12.00766 batch_time=0.43466 
Train Epoch: 11 [626/1000 20032/32000 (63%)] Loss: 0.70094 (QuantReg: 13.03348) QuantErr: 13.03348 batch_time=0.48094 
Train Epoch: 11 [631/1000 20192/32000 (63%)] Loss: 0.44365 (QuantReg: 12.00737) QuantErr: 12.00737 batch_time=0.37686 
Train Epoch: 11 [636/1000 20352/32000 (64%)] Loss: 0.74486 (QuantReg: 13.07151) QuantErr: 13.07151 batch_time=0.66289 
Train Epoch: 11 [641/1000 20512/32000 (64%)] Loss: 0.46656 (QuantReg: 12.06092) QuantErr: 12.06092 batch_time=0.34184 
Train Epoch: 11 [646/1000 20672/32000 (65%)] Loss: 0.50293 (QuantReg: 13.12573) QuantErr: 13.12573 batch_time=0.35502 
Train Epoch: 11 [651/1000 20832/32000 (65%)] Loss: 1.18477 (QuantReg: 12.07082) QuantErr: 12.07082 batch_time=0.38099 
Train Epoch: 11 [656/1000 20992/32000 (66%)] Loss: 0.99735 (QuantReg: 11.40215) QuantErr: 11.40215 batch_time=0.39290 
Train Epoch: 11 [661/1000 21152/32000 (66%)] Loss: 0.74130 (QuantReg: 12.53220) QuantErr: 12.53220 batch_time=0.35626 
Train Epoch: 11 [666/1000 21312/32000 (67%)] Loss: 0.85772 (QuantReg: 11.90965) QuantErr: 11.90965 batch_time=0.36596 
Train Epoch: 11 [671/1000 21472/32000 (67%)] Loss: 0.48703 (QuantReg: 12.62946) QuantErr: 12.62946 batch_time=0.34727 
Train Epoch: 11 [676/1000 21632/32000 (68%)] Loss: 0.86821 (QuantReg: 12.00679) QuantErr: 12.00679 batch_time=0.60102 
Train Epoch: 11 [681/1000 21792/32000 (68%)] Loss: 1.21525 (QuantReg: 12.76089) QuantErr: 12.76089 batch_time=0.35729 
Train Epoch: 11 [686/1000 21952/32000 (69%)] Loss: 1.20972 (QuantReg: 11.99749) QuantErr: 11.99749 batch_time=0.45471 
Train Epoch: 11 [691/1000 22112/32000 (69%)] Loss: 0.51712 (QuantReg: 12.79805) QuantErr: 12.79805 batch_time=0.42542 
Train Epoch: 11 [696/1000 22272/32000 (70%)] Loss: 1.06533 (QuantReg: 12.80696) QuantErr: 12.80696 batch_time=0.35475 
Train Epoch: 11 [701/1000 22432/32000 (70%)] Loss: 0.98546 (QuantReg: 11.94881) QuantErr: 11.94881 batch_time=0.45826 
Train Epoch: 11 [706/1000 22592/32000 (71%)] Loss: 0.90046 (QuantReg: 11.67915) QuantErr: 11.67915 batch_time=0.37145 
Train Epoch: 11 [711/1000 22752/32000 (71%)] Loss: 0.55790 (QuantReg: 12.12281) QuantErr: 12.12281 batch_time=0.41886 
Train Epoch: 11 [716/1000 22912/32000 (72%)] Loss: 0.54642 (QuantReg: 12.43480) QuantErr: 12.43480 batch_time=0.56722 
Train Epoch: 11 [721/1000 23072/32000 (72%)] Loss: 1.15576 (QuantReg: 11.85087) QuantErr: 11.85087 batch_time=0.90784 
Train Epoch: 11 [726/1000 23232/32000 (73%)] Loss: 0.40497 (QuantReg: 12.12293) QuantErr: 12.12293 batch_time=0.43437 
Train Epoch: 11 [731/1000 23392/32000 (73%)] Loss: 0.48374 (QuantReg: 12.53301) QuantErr: 12.53301 batch_time=0.55564 
Train Epoch: 11 [736/1000 23552/32000 (74%)] Loss: 0.81787 (QuantReg: 13.03176) QuantErr: 13.03176 batch_time=0.34883 
Train Epoch: 11 [741/1000 23712/32000 (74%)] Loss: 0.87390 (QuantReg: 12.26430) QuantErr: 12.26430 batch_time=0.38375 
Train Epoch: 11 [746/1000 23872/32000 (75%)] Loss: 0.44453 (QuantReg: 12.60822) QuantErr: 12.60822 batch_time=0.39118 
Train Epoch: 11 [751/1000 24032/32000 (75%)] Loss: 0.25580 (QuantReg: 12.42543) QuantErr: 12.42543 batch_time=0.44588 
Train Epoch: 11 [756/1000 24192/32000 (76%)] Loss: 0.31113 (QuantReg: 13.16810) QuantErr: 13.16810 batch_time=0.44760 
Train Epoch: 11 [761/1000 24352/32000 (76%)] Loss: 0.63776 (QuantReg: 12.51293) QuantErr: 12.51293 batch_time=0.35158 
Train Epoch: 11 [766/1000 24512/32000 (77%)] Loss: 0.70467 (QuantReg: 12.75117) QuantErr: 12.75117 batch_time=0.51325 
Train Epoch: 11 [771/1000 24672/32000 (77%)] Loss: 0.99506 (QuantReg: 12.23052) QuantErr: 12.23052 batch_time=0.41387 
Train Epoch: 11 [776/1000 24832/32000 (78%)] Loss: 0.63161 (QuantReg: 12.46528) QuantErr: 12.46528 batch_time=0.67842 
Train Epoch: 11 [781/1000 24992/32000 (78%)] Loss: 0.85488 (QuantReg: 12.68114) QuantErr: 12.68114 batch_time=0.48914 
Train Epoch: 11 [786/1000 25152/32000 (79%)] Loss: 0.88067 (QuantReg: 13.00424) QuantErr: 13.00424 batch_time=0.38330 
Train Epoch: 11 [791/1000 25312/32000 (79%)] Loss: 0.32985 (QuantReg: 12.66466) QuantErr: 12.66466 batch_time=0.41764 
Train Epoch: 11 [796/1000 25472/32000 (80%)] Loss: 0.49473 (QuantReg: 12.33528) QuantErr: 12.33528 batch_time=0.37261 
Train Epoch: 11 [801/1000 25632/32000 (80%)] Loss: 1.06556 (QuantReg: 11.97018) QuantErr: 11.97018 batch_time=0.36422 
Train Epoch: 11 [806/1000 25792/32000 (81%)] Loss: 0.82582 (QuantReg: 12.05290) QuantErr: 12.05290 batch_time=0.77257 
Train Epoch: 11 [811/1000 25952/32000 (81%)] Loss: 0.48128 (QuantReg: 12.38198) QuantErr: 12.38198 batch_time=0.54359 
Train Epoch: 11 [816/1000 26112/32000 (82%)] Loss: 0.35200 (QuantReg: 12.56087) QuantErr: 12.56087 batch_time=0.38255 
Train Epoch: 11 [821/1000 26272/32000 (82%)] Loss: 1.04104 (QuantReg: 12.39442) QuantErr: 12.39442 batch_time=0.43000 
Train Epoch: 11 [826/1000 26432/32000 (83%)] Loss: 0.86872 (QuantReg: 13.28474) QuantErr: 13.28474 batch_time=0.41712 
Train Epoch: 11 [831/1000 26592/32000 (83%)] Loss: 0.53701 (QuantReg: 12.44337) QuantErr: 12.44337 batch_time=0.41435 
Train Epoch: 11 [836/1000 26752/32000 (84%)] Loss: 0.69560 (QuantReg: 12.25324) QuantErr: 12.25324 batch_time=0.35184 
Train Epoch: 11 [841/1000 26912/32000 (84%)] Loss: 1.09964 (QuantReg: 12.41885) QuantErr: 12.41885 batch_time=0.39223 
Train Epoch: 11 [846/1000 27072/32000 (85%)] Loss: 0.52475 (QuantReg: 12.68248) QuantErr: 12.68248 batch_time=0.35724 
Train Epoch: 11 [851/1000 27232/32000 (85%)] Loss: 0.77940 (QuantReg: 12.55237) QuantErr: 12.55237 batch_time=0.76459 
Train Epoch: 11 [856/1000 27392/32000 (86%)] Loss: 0.94139 (QuantReg: 12.43177) QuantErr: 12.43177 batch_time=0.45808 
Train Epoch: 11 [861/1000 27552/32000 (86%)] Loss: 0.47352 (QuantReg: 12.78497) QuantErr: 12.78497 batch_time=0.44292 
Train Epoch: 11 [866/1000 27712/32000 (87%)] Loss: 0.69868 (QuantReg: 12.88833) QuantErr: 12.88833 batch_time=0.36823 
Train Epoch: 11 [871/1000 27872/32000 (87%)] Loss: 0.61542 (QuantReg: 12.61975) QuantErr: 12.61975 batch_time=0.40446 
Train Epoch: 11 [876/1000 28032/32000 (88%)] Loss: 0.79531 (QuantReg: 12.45756) QuantErr: 12.45756 batch_time=0.37841 
Train Epoch: 11 [881/1000 28192/32000 (88%)] Loss: 0.63382 (QuantReg: 11.97533) QuantErr: 11.97533 batch_time=0.42308 
Train Epoch: 11 [886/1000 28352/32000 (89%)] Loss: 0.45001 (QuantReg: 12.26081) QuantErr: 12.26081 batch_time=0.38366 
Train Epoch: 11 [891/1000 28512/32000 (89%)] Loss: 0.63657 (QuantReg: 12.50258) QuantErr: 12.50258 batch_time=0.34890 
Train Epoch: 11 [896/1000 28672/32000 (90%)] Loss: 1.78255 (QuantReg: 11.58859) QuantErr: 11.58859 batch_time=0.67653 
Train Epoch: 11 [901/1000 28832/32000 (90%)] Loss: 0.56169 (QuantReg: 12.52886) QuantErr: 12.52886 batch_time=0.33980 
Train Epoch: 11 [906/1000 28992/32000 (91%)] Loss: 0.59381 (QuantReg: 12.24699) QuantErr: 12.24699 batch_time=0.36755 
Train Epoch: 11 [911/1000 29152/32000 (91%)] Loss: 0.67985 (QuantReg: 12.31439) QuantErr: 12.31439 batch_time=0.36565 
Train Epoch: 11 [916/1000 29312/32000 (92%)] Loss: 1.22611 (QuantReg: 12.33428) QuantErr: 12.33428 batch_time=0.38587 
Train Epoch: 11 [921/1000 29472/32000 (92%)] Loss: 0.92140 (QuantReg: 12.60194) QuantErr: 12.60194 batch_time=0.34948 
Train Epoch: 11 [926/1000 29632/32000 (93%)] Loss: 0.48180 (QuantReg: 13.14001) QuantErr: 13.14001 batch_time=0.36371 
Train Epoch: 11 [931/1000 29792/32000 (93%)] Loss: 0.86598 (QuantReg: 12.80876) QuantErr: 12.80876 batch_time=0.41508 
Train Epoch: 11 [936/1000 29952/32000 (94%)] Loss: 1.13987 (QuantReg: 12.43340) QuantErr: 12.43340 batch_time=0.78728 
Train Epoch: 11 [941/1000 30112/32000 (94%)] Loss: 0.69800 (QuantReg: 12.45603) QuantErr: 12.45603 batch_time=0.47108 
Train Epoch: 11 [946/1000 30272/32000 (95%)] Loss: 0.60269 (QuantReg: 12.45901) QuantErr: 12.45901 batch_time=0.33695 
Train Epoch: 11 [951/1000 30432/32000 (95%)] Loss: 0.85496 (QuantReg: 12.83343) QuantErr: 12.83343 batch_time=0.44603 
Train Epoch: 11 [956/1000 30592/32000 (96%)] Loss: 0.46331 (QuantReg: 12.08823) QuantErr: 12.08823 batch_time=0.43108 
Train Epoch: 11 [961/1000 30752/32000 (96%)] Loss: 0.64018 (QuantReg: 12.57725) QuantErr: 12.57725 batch_time=0.42295 
Train Epoch: 11 [966/1000 30912/32000 (97%)] Loss: 0.61730 (QuantReg: 12.95896) QuantErr: 12.95896 batch_time=1.71931 
Train Epoch: 11 [971/1000 31072/32000 (97%)] Loss: 1.26135 (QuantReg: 12.96806) QuantErr: 12.96806 batch_time=0.42301 
Train Epoch: 11 [976/1000 31232/32000 (98%)] Loss: 0.90475 (QuantReg: 12.52797) QuantErr: 12.52797 batch_time=0.55535 
Train Epoch: 11 [981/1000 31392/32000 (98%)] Loss: 0.62379 (QuantReg: 12.85214) QuantErr: 12.85214 batch_time=0.33725 
Train Epoch: 11 [986/1000 31552/32000 (99%)] Loss: 1.46807 (QuantReg: 12.00641) QuantErr: 12.00641 batch_time=0.58737 
Train Epoch: 11 [991/1000 31712/32000 (99%)] Loss: 0.64204 (QuantReg: 12.78862) QuantErr: 12.78862 batch_time=0.36931 
Train Epoch: 11 [996/1000 31872/32000 (100%)] Loss: 0.49644 (QuantReg: 12.31767) QuantErr: 12.31767 batch_time=0.41081 
Train Epoch: 11 codebook_update_time=1.76504
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch11.pth ...
Done in 6.026s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch11.pth ...
Done in 10.778s
removing stale ckpt [epoch 10] [took 0.01s]
 epoch          : 11
 loss           : 0.7362615735083818
 quant_reg      : 12.209072584152223
 quant_err      : 12.209072584152223
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 11000
 MSRVTT_miech_test/t2v_metrics/R1: 16.5
 MSRVTT_miech_test/t2v_metrics/R5: 46.8
 MSRVTT_miech_test/t2v_metrics/R10: 59.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.308
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.83648060812609
 MSRVTT_miech_test/v2t_metrics/R1: 17.5
 MSRVTT_miech_test/v2t_metrics/R5: 46.4
 MSRVTT_miech_test/v2t_metrics/R10: 59.8
 MSRVTT_miech_test/v2t_metrics/R50: 86.9
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.888
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.48259631926541
 mnt_best       : 35.83648060812609
 not_improved_count: 0
Train Epoch: 12 [1/1000 32/32000 (0%)] Loss: 0.28289 (QuantReg: 12.02329) QuantErr: 12.02329 batch_time=33.02836 
Train Epoch: 12 [6/1000 192/32000 (1%)] Loss: 0.68579 (QuantReg: 12.03225) QuantErr: 12.03225 batch_time=0.34952 
Train Epoch: 12 [11/1000 352/32000 (1%)] Loss: 0.89049 (QuantReg: 11.41682) QuantErr: 11.41682 batch_time=0.37246 
Train Epoch: 12 [16/1000 512/32000 (2%)] Loss: 0.56220 (QuantReg: 11.39852) QuantErr: 11.39852 batch_time=0.39500 
Train Epoch: 12 [21/1000 672/32000 (2%)] Loss: 0.73821 (QuantReg: 11.65584) QuantErr: 11.65584 batch_time=0.40008 
Train Epoch: 12 [26/1000 832/32000 (3%)] Loss: 0.30127 (QuantReg: 12.19846) QuantErr: 12.19846 batch_time=0.42650 
Train Epoch: 12 [31/1000 992/32000 (3%)] Loss: 0.39300 (QuantReg: 12.67134) QuantErr: 12.67134 batch_time=0.46602 
Train Epoch: 12 [36/1000 1152/32000 (4%)] Loss: 0.52553 (QuantReg: 11.75397) QuantErr: 11.75397 batch_time=0.61403 
Train Epoch: 12 [41/1000 1312/32000 (4%)] Loss: 0.90621 (QuantReg: 12.23276) QuantErr: 12.23276 batch_time=0.45233 
Train Epoch: 12 [46/1000 1472/32000 (5%)] Loss: 0.73103 (QuantReg: 12.11473) QuantErr: 12.11473 batch_time=0.39777 
Train Epoch: 12 [51/1000 1632/32000 (5%)] Loss: 0.93333 (QuantReg: 12.09913) QuantErr: 12.09913 batch_time=0.48342 
Train Epoch: 12 [56/1000 1792/32000 (6%)] Loss: 0.85423 (QuantReg: 11.37999) QuantErr: 11.37999 batch_time=0.35695 
Train Epoch: 12 [61/1000 1952/32000 (6%)] Loss: 0.64251 (QuantReg: 12.75131) QuantErr: 12.75131 batch_time=0.34177 
Train Epoch: 12 [66/1000 2112/32000 (7%)] Loss: 0.43866 (QuantReg: 12.16385) QuantErr: 12.16385 batch_time=0.36116 
Train Epoch: 12 [71/1000 2272/32000 (7%)] Loss: 0.70565 (QuantReg: 11.78507) QuantErr: 11.78507 batch_time=0.39898 
Train Epoch: 12 [76/1000 2432/32000 (8%)] Loss: 0.75343 (QuantReg: 12.97618) QuantErr: 12.97618 batch_time=1.08315 
Train Epoch: 12 [81/1000 2592/32000 (8%)] Loss: 0.63055 (QuantReg: 12.18201) QuantErr: 12.18201 batch_time=0.85102 
Train Epoch: 12 [86/1000 2752/32000 (9%)] Loss: 1.13858 (QuantReg: 11.75389) QuantErr: 11.75389 batch_time=0.32821 
Train Epoch: 12 [91/1000 2912/32000 (9%)] Loss: 0.82029 (QuantReg: 11.78575) QuantErr: 11.78575 batch_time=0.44352 
Train Epoch: 12 [96/1000 3072/32000 (10%)] Loss: 0.50991 (QuantReg: 11.72907) QuantErr: 11.72907 batch_time=0.39083 
Train Epoch: 12 [101/1000 3232/32000 (10%)] Loss: 0.71292 (QuantReg: 11.80146) QuantErr: 11.80146 batch_time=0.45210 
Train Epoch: 12 [106/1000 3392/32000 (11%)] Loss: 0.37530 (QuantReg: 12.15268) QuantErr: 12.15268 batch_time=0.42697 
Train Epoch: 12 [111/1000 3552/32000 (11%)] Loss: 0.43817 (QuantReg: 12.38494) QuantErr: 12.38494 batch_time=0.45034 
Train Epoch: 12 [116/1000 3712/32000 (12%)] Loss: 0.42295 (QuantReg: 11.35047) QuantErr: 11.35047 batch_time=0.38422 
Train Epoch: 12 [121/1000 3872/32000 (12%)] Loss: 0.79612 (QuantReg: 11.80186) QuantErr: 11.80186 batch_time=0.34264 
Train Epoch: 12 [126/1000 4032/32000 (13%)] Loss: 0.42553 (QuantReg: 12.25333) QuantErr: 12.25333 batch_time=0.44510 
Train Epoch: 12 [131/1000 4192/32000 (13%)] Loss: 1.22174 (QuantReg: 12.11352) QuantErr: 12.11352 batch_time=0.39254 
Train Epoch: 12 [136/1000 4352/32000 (14%)] Loss: 0.99796 (QuantReg: 11.24045) QuantErr: 11.24045 batch_time=0.43459 
Train Epoch: 12 [141/1000 4512/32000 (14%)] Loss: 1.78876 (QuantReg: 12.34528) QuantErr: 12.34528 batch_time=0.34308 
Train Epoch: 12 [146/1000 4672/32000 (15%)] Loss: 0.91052 (QuantReg: 12.56965) QuantErr: 12.56965 batch_time=0.51992 
Train Epoch: 12 [151/1000 4832/32000 (15%)] Loss: 0.53385 (QuantReg: 12.61095) QuantErr: 12.61095 batch_time=0.43711 
Train Epoch: 12 [156/1000 4992/32000 (16%)] Loss: 0.71557 (QuantReg: 11.93637) QuantErr: 11.93637 batch_time=0.47752 
Train Epoch: 12 [161/1000 5152/32000 (16%)] Loss: 0.47249 (QuantReg: 12.07345) QuantErr: 12.07345 batch_time=0.37952 
Train Epoch: 12 [166/1000 5312/32000 (17%)] Loss: 0.56163 (QuantReg: 12.16823) QuantErr: 12.16823 batch_time=0.59577 
Train Epoch: 12 [171/1000 5472/32000 (17%)] Loss: 0.71971 (QuantReg: 11.82199) QuantErr: 11.82199 batch_time=0.58264 
Train Epoch: 12 [176/1000 5632/32000 (18%)] Loss: 0.21296 (QuantReg: 12.65542) QuantErr: 12.65542 batch_time=0.37351 
Train Epoch: 12 [181/1000 5792/32000 (18%)] Loss: 0.66796 (QuantReg: 12.18106) QuantErr: 12.18106 batch_time=0.54211 
Train Epoch: 12 [186/1000 5952/32000 (19%)] Loss: 0.87773 (QuantReg: 11.61605) QuantErr: 11.61605 batch_time=1.85476 
Train Epoch: 12 [191/1000 6112/32000 (19%)] Loss: 0.63250 (QuantReg: 11.92776) QuantErr: 11.92776 batch_time=0.37414 
Train Epoch: 12 [196/1000 6272/32000 (20%)] Loss: 0.52613 (QuantReg: 12.13973) QuantErr: 12.13973 batch_time=0.44651 
Train Epoch: 12 [201/1000 6432/32000 (20%)] Loss: 0.49852 (QuantReg: 13.09401) QuantErr: 13.09401 batch_time=0.34380 
Train Epoch: 12 [206/1000 6592/32000 (21%)] Loss: 0.84377 (QuantReg: 11.26321) QuantErr: 11.26321 batch_time=0.35067 
Train Epoch: 12 [211/1000 6752/32000 (21%)] Loss: 0.73737 (QuantReg: 12.22189) QuantErr: 12.22189 batch_time=2.06349 
Train Epoch: 12 [216/1000 6912/32000 (22%)] Loss: 0.66912 (QuantReg: 12.96168) QuantErr: 12.96168 batch_time=0.41118 
Train Epoch: 12 [221/1000 7072/32000 (22%)] Loss: 0.77754 (QuantReg: 12.15284) QuantErr: 12.15284 batch_time=0.36624 
Train Epoch: 12 [226/1000 7232/32000 (23%)] Loss: 0.66125 (QuantReg: 12.78996) QuantErr: 12.78996 batch_time=0.35474 
Train Epoch: 12 [231/1000 7392/32000 (23%)] Loss: 0.65257 (QuantReg: 12.75570) QuantErr: 12.75570 batch_time=0.36093 
Train Epoch: 12 [236/1000 7552/32000 (24%)] Loss: 0.67009 (QuantReg: 11.94658) QuantErr: 11.94658 batch_time=0.43944 
Train Epoch: 12 [241/1000 7712/32000 (24%)] Loss: 0.68034 (QuantReg: 11.35649) QuantErr: 11.35649 batch_time=0.38871 
Train Epoch: 12 [246/1000 7872/32000 (25%)] Loss: 0.50534 (QuantReg: 13.21276) QuantErr: 13.21276 batch_time=0.36899 
Train Epoch: 12 [251/1000 8032/32000 (25%)] Loss: 0.54707 (QuantReg: 11.98381) QuantErr: 11.98381 batch_time=0.34866 
Train Epoch: 12 [256/1000 8192/32000 (26%)] Loss: 0.60921 (QuantReg: 12.78451) QuantErr: 12.78451 batch_time=0.56483 
Train Epoch: 12 [261/1000 8352/32000 (26%)] Loss: 0.57363 (QuantReg: 11.91558) QuantErr: 11.91558 batch_time=0.33696 
Train Epoch: 12 [266/1000 8512/32000 (27%)] Loss: 0.55485 (QuantReg: 12.25212) QuantErr: 12.25212 batch_time=0.52415 
Train Epoch: 12 [271/1000 8672/32000 (27%)] Loss: 1.22978 (QuantReg: 12.28390) QuantErr: 12.28390 batch_time=0.34575 
Train Epoch: 12 [276/1000 8832/32000 (28%)] Loss: 0.68045 (QuantReg: 12.12480) QuantErr: 12.12480 batch_time=0.41223 
Train Epoch: 12 [281/1000 8992/32000 (28%)] Loss: 1.00779 (QuantReg: 12.59921) QuantErr: 12.59921 batch_time=0.35881 
Train Epoch: 12 [286/1000 9152/32000 (29%)] Loss: 0.79775 (QuantReg: 12.57917) QuantErr: 12.57917 batch_time=0.36898 
Train Epoch: 12 [291/1000 9312/32000 (29%)] Loss: 0.78149 (QuantReg: 11.70293) QuantErr: 11.70293 batch_time=0.47024 
Train Epoch: 12 [296/1000 9472/32000 (30%)] Loss: 0.36580 (QuantReg: 12.78385) QuantErr: 12.78385 batch_time=0.34238 
Train Epoch: 12 [301/1000 9632/32000 (30%)] Loss: 1.16224 (QuantReg: 12.36321) QuantErr: 12.36321 batch_time=0.39039 
Train Epoch: 12 [306/1000 9792/32000 (31%)] Loss: 0.50062 (QuantReg: 12.71916) QuantErr: 12.71916 batch_time=0.46432 
Train Epoch: 12 [311/1000 9952/32000 (31%)] Loss: 1.26376 (QuantReg: 12.31023) QuantErr: 12.31023 batch_time=0.34855 
Train Epoch: 12 [316/1000 10112/32000 (32%)] Loss: 0.47308 (QuantReg: 12.04111) QuantErr: 12.04111 batch_time=0.35653 
Train Epoch: 12 [321/1000 10272/32000 (32%)] Loss: 0.32924 (QuantReg: 12.12520) QuantErr: 12.12520 batch_time=0.41276 
Train Epoch: 12 [326/1000 10432/32000 (33%)] Loss: 0.76299 (QuantReg: 12.45765) QuantErr: 12.45765 batch_time=0.37681 
Train Epoch: 12 [331/1000 10592/32000 (33%)] Loss: 0.62495 (QuantReg: 11.58276) QuantErr: 11.58276 batch_time=0.48958 
Train Epoch: 12 [336/1000 10752/32000 (34%)] Loss: 0.38631 (QuantReg: 12.48850) QuantErr: 12.48850 batch_time=0.45552 
Train Epoch: 12 [341/1000 10912/32000 (34%)] Loss: 0.51379 (QuantReg: 12.58721) QuantErr: 12.58721 batch_time=0.45889 
Train Epoch: 12 [346/1000 11072/32000 (35%)] Loss: 0.72042 (QuantReg: 11.35141) QuantErr: 11.35141 batch_time=0.47084 
Train Epoch: 12 [351/1000 11232/32000 (35%)] Loss: 0.71208 (QuantReg: 13.06833) QuantErr: 13.06833 batch_time=0.37252 
Train Epoch: 12 [356/1000 11392/32000 (36%)] Loss: 0.54841 (QuantReg: 11.97554) QuantErr: 11.97554 batch_time=0.50919 
Train Epoch: 12 [361/1000 11552/32000 (36%)] Loss: 1.04490 (QuantReg: 12.24987) QuantErr: 12.24987 batch_time=1.15144 
Train Epoch: 12 [366/1000 11712/32000 (37%)] Loss: 0.49490 (QuantReg: 12.34704) QuantErr: 12.34704 batch_time=0.38098 
Train Epoch: 12 [371/1000 11872/32000 (37%)] Loss: 0.65818 (QuantReg: 11.94001) QuantErr: 11.94001 batch_time=0.38315 
Train Epoch: 12 [376/1000 12032/32000 (38%)] Loss: 0.69612 (QuantReg: 12.57951) QuantErr: 12.57951 batch_time=0.34796 
Train Epoch: 12 [381/1000 12192/32000 (38%)] Loss: 0.69850 (QuantReg: 11.41783) QuantErr: 11.41783 batch_time=0.49012 
Train Epoch: 12 [386/1000 12352/32000 (39%)] Loss: 1.69443 (QuantReg: 12.33280) QuantErr: 12.33280 batch_time=0.33352 
Train Epoch: 12 [391/1000 12512/32000 (39%)] Loss: 0.61255 (QuantReg: 12.79277) QuantErr: 12.79277 batch_time=0.47160 
Train Epoch: 12 [396/1000 12672/32000 (40%)] Loss: 0.46414 (QuantReg: 11.78262) QuantErr: 11.78262 batch_time=0.36158 
Train Epoch: 12 [401/1000 12832/32000 (40%)] Loss: 0.84681 (QuantReg: 12.22629) QuantErr: 12.22629 batch_time=0.33010 
Train Epoch: 12 [406/1000 12992/32000 (41%)] Loss: 0.75613 (QuantReg: 12.18925) QuantErr: 12.18925 batch_time=0.33279 
Train Epoch: 12 [411/1000 13152/32000 (41%)] Loss: 1.56071 (QuantReg: 11.67198) QuantErr: 11.67198 batch_time=0.67834 
Train Epoch: 12 [416/1000 13312/32000 (42%)] Loss: 0.45762 (QuantReg: 12.51043) QuantErr: 12.51043 batch_time=0.36527 
Train Epoch: 12 [421/1000 13472/32000 (42%)] Loss: 1.03507 (QuantReg: 11.83207) QuantErr: 11.83207 batch_time=0.37088 
Train Epoch: 12 [426/1000 13632/32000 (43%)] Loss: 0.59209 (QuantReg: 12.25211) QuantErr: 12.25211 batch_time=0.36376 
Train Epoch: 12 [431/1000 13792/32000 (43%)] Loss: 0.43863 (QuantReg: 12.85389) QuantErr: 12.85389 batch_time=0.34964 
Train Epoch: 12 [436/1000 13952/32000 (44%)] Loss: 1.26619 (QuantReg: 12.22380) QuantErr: 12.22380 batch_time=0.50230 
Train Epoch: 12 [441/1000 14112/32000 (44%)] Loss: 1.39512 (QuantReg: 12.35406) QuantErr: 12.35406 batch_time=0.40535 
Train Epoch: 12 [446/1000 14272/32000 (45%)] Loss: 1.12257 (QuantReg: 12.06665) QuantErr: 12.06665 batch_time=0.35070 
Train Epoch: 12 [451/1000 14432/32000 (45%)] Loss: 0.37989 (QuantReg: 12.94621) QuantErr: 12.94621 batch_time=0.55051 
Train Epoch: 12 [456/1000 14592/32000 (46%)] Loss: 0.69345 (QuantReg: 11.89485) QuantErr: 11.89485 batch_time=0.37720 
Train Epoch: 12 [461/1000 14752/32000 (46%)] Loss: 0.66208 (QuantReg: 12.21048) QuantErr: 12.21048 batch_time=0.41633 
Train Epoch: 12 [466/1000 14912/32000 (47%)] Loss: 0.42261 (QuantReg: 11.26060) QuantErr: 11.26060 batch_time=0.35230 
Train Epoch: 12 [471/1000 15072/32000 (47%)] Loss: 0.88141 (QuantReg: 12.44874) QuantErr: 12.44874 batch_time=0.36250 
Train Epoch: 12 [476/1000 15232/32000 (48%)] Loss: 0.71069 (QuantReg: 12.21066) QuantErr: 12.21066 batch_time=0.39401 
Train Epoch: 12 [481/1000 15392/32000 (48%)] Loss: 0.44988 (QuantReg: 13.20193) QuantErr: 13.20193 batch_time=0.35930 
Train Epoch: 12 [486/1000 15552/32000 (49%)] Loss: 0.50858 (QuantReg: 12.68852) QuantErr: 12.68852 batch_time=0.76124 
Train Epoch: 12 [491/1000 15712/32000 (49%)] Loss: 0.42256 (QuantReg: 12.27265) QuantErr: 12.27265 batch_time=0.36564 
Train Epoch: 12 [496/1000 15872/32000 (50%)] Loss: 0.54108 (QuantReg: 12.01641) QuantErr: 12.01641 batch_time=0.36867 
Train Epoch: 12 [501/1000 16032/32000 (50%)] Loss: 0.60412 (QuantReg: 12.85643) QuantErr: 12.85643 batch_time=0.36271 
Train Epoch: 12 [506/1000 16192/32000 (51%)] Loss: 0.53555 (QuantReg: 11.33602) QuantErr: 11.33602 batch_time=1.20411 
Train Epoch: 12 [511/1000 16352/32000 (51%)] Loss: 0.29801 (QuantReg: 12.58924) QuantErr: 12.58924 batch_time=0.33791 
Train Epoch: 12 [516/1000 16512/32000 (52%)] Loss: 0.69723 (QuantReg: 12.38742) QuantErr: 12.38742 batch_time=0.38291 
Train Epoch: 12 [521/1000 16672/32000 (52%)] Loss: 0.46272 (QuantReg: 11.12571) QuantErr: 11.12571 batch_time=0.38780 
Train Epoch: 12 [526/1000 16832/32000 (53%)] Loss: 0.29950 (QuantReg: 12.44771) QuantErr: 12.44771 batch_time=0.39214 
Train Epoch: 12 [531/1000 16992/32000 (53%)] Loss: 0.86972 (QuantReg: 11.76696) QuantErr: 11.76696 batch_time=1.56442 
Train Epoch: 12 [536/1000 17152/32000 (54%)] Loss: 0.62044 (QuantReg: 11.92447) QuantErr: 11.92447 batch_time=0.32879 
Train Epoch: 12 [541/1000 17312/32000 (54%)] Loss: 1.07409 (QuantReg: 11.97448) QuantErr: 11.97448 batch_time=0.51280 
Train Epoch: 12 [546/1000 17472/32000 (55%)] Loss: 0.81653 (QuantReg: 12.55566) QuantErr: 12.55566 batch_time=0.35697 
Train Epoch: 12 [551/1000 17632/32000 (55%)] Loss: 0.53717 (QuantReg: 12.78735) QuantErr: 12.78735 batch_time=0.38907 
Train Epoch: 12 [556/1000 17792/32000 (56%)] Loss: 0.68300 (QuantReg: 12.06365) QuantErr: 12.06365 batch_time=0.52525 
Train Epoch: 12 [561/1000 17952/32000 (56%)] Loss: 0.90291 (QuantReg: 12.26871) QuantErr: 12.26871 batch_time=0.44242 
Train Epoch: 12 [566/1000 18112/32000 (57%)] Loss: 0.23217 (QuantReg: 12.99785) QuantErr: 12.99785 batch_time=0.35123 
Train Epoch: 12 [571/1000 18272/32000 (57%)] Loss: 0.35456 (QuantReg: 12.06750) QuantErr: 12.06750 batch_time=0.34855 
Train Epoch: 12 [576/1000 18432/32000 (58%)] Loss: 0.71717 (QuantReg: 12.27530) QuantErr: 12.27530 batch_time=0.51651 
Train Epoch: 12 [581/1000 18592/32000 (58%)] Loss: 0.54599 (QuantReg: 12.25210) QuantErr: 12.25210 batch_time=0.39693 
Train Epoch: 12 [586/1000 18752/32000 (59%)] Loss: 1.13495 (QuantReg: 11.95775) QuantErr: 11.95775 batch_time=0.51640 
Train Epoch: 12 [591/1000 18912/32000 (59%)] Loss: 0.48836 (QuantReg: 12.44589) QuantErr: 12.44589 batch_time=0.50560 
Train Epoch: 12 [596/1000 19072/32000 (60%)] Loss: 0.82298 (QuantReg: 12.01478) QuantErr: 12.01478 batch_time=0.37167 
Train Epoch: 12 [601/1000 19232/32000 (60%)] Loss: 0.48740 (QuantReg: 12.23815) QuantErr: 12.23815 batch_time=0.34841 
Train Epoch: 12 [606/1000 19392/32000 (61%)] Loss: 0.70661 (QuantReg: 12.04419) QuantErr: 12.04419 batch_time=0.36881 
Train Epoch: 12 [611/1000 19552/32000 (61%)] Loss: 0.71315 (QuantReg: 12.15822) QuantErr: 12.15822 batch_time=0.43151 
Train Epoch: 12 [616/1000 19712/32000 (62%)] Loss: 0.60246 (QuantReg: 12.66478) QuantErr: 12.66478 batch_time=0.43309 
Train Epoch: 12 [621/1000 19872/32000 (62%)] Loss: 0.51935 (QuantReg: 12.36225) QuantErr: 12.36225 batch_time=0.78527 
Train Epoch: 12 [626/1000 20032/32000 (63%)] Loss: 0.66408 (QuantReg: 12.54851) QuantErr: 12.54851 batch_time=0.48702 
Train Epoch: 12 [631/1000 20192/32000 (63%)] Loss: 0.39972 (QuantReg: 12.41961) QuantErr: 12.41961 batch_time=0.38887 
Train Epoch: 12 [636/1000 20352/32000 (64%)] Loss: 1.02546 (QuantReg: 12.38777) QuantErr: 12.38777 batch_time=0.35672 
Train Epoch: 12 [641/1000 20512/32000 (64%)] Loss: 0.53880 (QuantReg: 12.71734) QuantErr: 12.71734 batch_time=0.39151 
Train Epoch: 12 [646/1000 20672/32000 (65%)] Loss: 0.25459 (QuantReg: 12.73936) QuantErr: 12.73936 batch_time=0.38764 
Train Epoch: 12 [651/1000 20832/32000 (65%)] Loss: 0.38238 (QuantReg: 12.92540) QuantErr: 12.92540 batch_time=0.41714 
Train Epoch: 12 [656/1000 20992/32000 (66%)] Loss: 0.40375 (QuantReg: 12.70395) QuantErr: 12.70395 batch_time=0.35368 
Train Epoch: 12 [661/1000 21152/32000 (66%)] Loss: 0.95482 (QuantReg: 12.67439) QuantErr: 12.67439 batch_time=0.78010 
Train Epoch: 12 [666/1000 21312/32000 (67%)] Loss: 1.70707 (QuantReg: 12.46405) QuantErr: 12.46405 batch_time=0.35606 
Train Epoch: 12 [671/1000 21472/32000 (67%)] Loss: 0.64829 (QuantReg: 12.07535) QuantErr: 12.07535 batch_time=0.37494 
Train Epoch: 12 [676/1000 21632/32000 (68%)] Loss: 0.59609 (QuantReg: 11.96866) QuantErr: 11.96866 batch_time=0.34985 
Train Epoch: 12 [681/1000 21792/32000 (68%)] Loss: 0.49340 (QuantReg: 13.10985) QuantErr: 13.10985 batch_time=0.74541 
Train Epoch: 12 [686/1000 21952/32000 (69%)] Loss: 0.50939 (QuantReg: 11.91129) QuantErr: 11.91129 batch_time=0.37240 
Train Epoch: 12 [691/1000 22112/32000 (69%)] Loss: 0.78908 (QuantReg: 12.12916) QuantErr: 12.12916 batch_time=0.43133 
Train Epoch: 12 [696/1000 22272/32000 (70%)] Loss: 0.70583 (QuantReg: 12.12953) QuantErr: 12.12953 batch_time=0.39561 
Train Epoch: 12 [701/1000 22432/32000 (70%)] Loss: 0.39356 (QuantReg: 12.45551) QuantErr: 12.45551 batch_time=0.68317 
Train Epoch: 12 [706/1000 22592/32000 (71%)] Loss: 0.82077 (QuantReg: 12.58687) QuantErr: 12.58687 batch_time=0.47378 
Train Epoch: 12 [711/1000 22752/32000 (71%)] Loss: 0.42848 (QuantReg: 12.90051) QuantErr: 12.90051 batch_time=0.38380 
Train Epoch: 12 [716/1000 22912/32000 (72%)] Loss: 0.96276 (QuantReg: 11.64177) QuantErr: 11.64177 batch_time=0.38708 
Train Epoch: 12 [721/1000 23072/32000 (72%)] Loss: 0.54218 (QuantReg: 12.03578) QuantErr: 12.03578 batch_time=0.47470 
Train Epoch: 12 [726/1000 23232/32000 (73%)] Loss: 0.95839 (QuantReg: 12.21562) QuantErr: 12.21562 batch_time=0.42915 
Train Epoch: 12 [731/1000 23392/32000 (73%)] Loss: 0.38962 (QuantReg: 12.57087) QuantErr: 12.57087 batch_time=0.38151 
Train Epoch: 12 [736/1000 23552/32000 (74%)] Loss: 0.63818 (QuantReg: 12.64622) QuantErr: 12.64622 batch_time=0.42967 
Train Epoch: 12 [741/1000 23712/32000 (74%)] Loss: 0.45739 (QuantReg: 11.83510) QuantErr: 11.83510 batch_time=0.36688 
Train Epoch: 12 [746/1000 23872/32000 (75%)] Loss: 1.03456 (QuantReg: 12.46183) QuantErr: 12.46183 batch_time=0.50506 
Train Epoch: 12 [751/1000 24032/32000 (75%)] Loss: 0.92197 (QuantReg: 11.70037) QuantErr: 11.70037 batch_time=0.48311 
Train Epoch: 12 [756/1000 24192/32000 (76%)] Loss: 0.57231 (QuantReg: 12.18767) QuantErr: 12.18767 batch_time=0.43459 
Train Epoch: 12 [761/1000 24352/32000 (76%)] Loss: 0.91072 (QuantReg: 12.26201) QuantErr: 12.26201 batch_time=0.40993 
Train Epoch: 12 [766/1000 24512/32000 (77%)] Loss: 1.14543 (QuantReg: 11.79903) QuantErr: 11.79903 batch_time=0.35975 
Train Epoch: 12 [771/1000 24672/32000 (77%)] Loss: 0.65395 (QuantReg: 12.88612) QuantErr: 12.88612 batch_time=0.35680 
Train Epoch: 12 [776/1000 24832/32000 (78%)] Loss: 0.40955 (QuantReg: 11.62676) QuantErr: 11.62676 batch_time=0.41750 
Train Epoch: 12 [781/1000 24992/32000 (78%)] Loss: 0.34494 (QuantReg: 12.06167) QuantErr: 12.06167 batch_time=0.39291 
Train Epoch: 12 [786/1000 25152/32000 (79%)] Loss: 1.07657 (QuantReg: 11.96934) QuantErr: 11.96934 batch_time=0.65350 
Train Epoch: 12 [791/1000 25312/32000 (79%)] Loss: 0.74552 (QuantReg: 12.62653) QuantErr: 12.62653 batch_time=0.32981 
Train Epoch: 12 [796/1000 25472/32000 (80%)] Loss: 0.47827 (QuantReg: 12.48166) QuantErr: 12.48166 batch_time=0.58397 
Train Epoch: 12 [801/1000 25632/32000 (80%)] Loss: 0.39738 (QuantReg: 12.71704) QuantErr: 12.71704 batch_time=0.40928 
Train Epoch: 12 [806/1000 25792/32000 (81%)] Loss: 1.15311 (QuantReg: 12.39963) QuantErr: 12.39963 batch_time=0.44499 
Train Epoch: 12 [811/1000 25952/32000 (81%)] Loss: 0.72220 (QuantReg: 11.33549) QuantErr: 11.33549 batch_time=0.41835 
Train Epoch: 12 [816/1000 26112/32000 (82%)] Loss: 0.73815 (QuantReg: 12.87520) QuantErr: 12.87520 batch_time=0.35263 
Train Epoch: 12 [821/1000 26272/32000 (82%)] Loss: 0.43583 (QuantReg: 12.46441) QuantErr: 12.46441 batch_time=0.37396 
Train Epoch: 12 [826/1000 26432/32000 (83%)] Loss: 0.80898 (QuantReg: 12.03056) QuantErr: 12.03056 batch_time=2.62094 
Train Epoch: 12 [831/1000 26592/32000 (83%)] Loss: 0.60600 (QuantReg: 12.05009) QuantErr: 12.05009 batch_time=0.37938 
Train Epoch: 12 [836/1000 26752/32000 (84%)] Loss: 0.42755 (QuantReg: 13.09122) QuantErr: 13.09122 batch_time=0.40324 
Train Epoch: 12 [841/1000 26912/32000 (84%)] Loss: 0.84805 (QuantReg: 12.74886) QuantErr: 12.74886 batch_time=0.52970 
Train Epoch: 12 [846/1000 27072/32000 (85%)] Loss: 0.44891 (QuantReg: 12.80308) QuantErr: 12.80308 batch_time=0.35575 
Train Epoch: 12 [851/1000 27232/32000 (85%)] Loss: 0.67840 (QuantReg: 12.81620) QuantErr: 12.81620 batch_time=0.47807 
Train Epoch: 12 [856/1000 27392/32000 (86%)] Loss: 1.13345 (QuantReg: 13.43301) QuantErr: 13.43301 batch_time=0.35753 
Train Epoch: 12 [861/1000 27552/32000 (86%)] Loss: 0.89172 (QuantReg: 12.30530) QuantErr: 12.30530 batch_time=0.43506 
Train Epoch: 12 [866/1000 27712/32000 (87%)] Loss: 0.40979 (QuantReg: 12.56344) QuantErr: 12.56344 batch_time=0.41277 
Train Epoch: 12 [871/1000 27872/32000 (87%)] Loss: 1.08455 (QuantReg: 12.43164) QuantErr: 12.43164 batch_time=0.42287 
Train Epoch: 12 [876/1000 28032/32000 (88%)] Loss: 0.75084 (QuantReg: 12.71732) QuantErr: 12.71732 batch_time=0.52250 
Train Epoch: 12 [881/1000 28192/32000 (88%)] Loss: 1.15348 (QuantReg: 11.62129) QuantErr: 11.62129 batch_time=0.34566 
Train Epoch: 12 [886/1000 28352/32000 (89%)] Loss: 0.59020 (QuantReg: 12.69641) QuantErr: 12.69641 batch_time=0.49731 
Train Epoch: 12 [891/1000 28512/32000 (89%)] Loss: 0.68024 (QuantReg: 12.32179) QuantErr: 12.32179 batch_time=0.35189 
Train Epoch: 12 [896/1000 28672/32000 (90%)] Loss: 0.42323 (QuantReg: 12.41860) QuantErr: 12.41860 batch_time=0.38082 
Train Epoch: 12 [901/1000 28832/32000 (90%)] Loss: 0.68098 (QuantReg: 13.04367) QuantErr: 13.04367 batch_time=0.44763 
Train Epoch: 12 [906/1000 28992/32000 (91%)] Loss: 0.67060 (QuantReg: 12.27266) QuantErr: 12.27266 batch_time=0.35444 
Train Epoch: 12 [911/1000 29152/32000 (91%)] Loss: 1.08983 (QuantReg: 12.31455) QuantErr: 12.31455 batch_time=0.41779 
Train Epoch: 12 [916/1000 29312/32000 (92%)] Loss: 1.12510 (QuantReg: 11.91693) QuantErr: 11.91693 batch_time=0.38383 
Train Epoch: 12 [921/1000 29472/32000 (92%)] Loss: 0.76079 (QuantReg: 12.37545) QuantErr: 12.37545 batch_time=0.34806 
Train Epoch: 12 [926/1000 29632/32000 (93%)] Loss: 1.20323 (QuantReg: 11.63061) QuantErr: 11.63061 batch_time=0.58792 
Train Epoch: 12 [931/1000 29792/32000 (93%)] Loss: 1.18145 (QuantReg: 12.61647) QuantErr: 12.61647 batch_time=0.35230 
Train Epoch: 12 [936/1000 29952/32000 (94%)] Loss: 0.45514 (QuantReg: 12.49933) QuantErr: 12.49933 batch_time=0.33352 
Train Epoch: 12 [941/1000 30112/32000 (94%)] Loss: 0.69090 (QuantReg: 12.91446) QuantErr: 12.91446 batch_time=0.39737 
Train Epoch: 12 [946/1000 30272/32000 (95%)] Loss: 0.57158 (QuantReg: 12.32041) QuantErr: 12.32041 batch_time=0.33784 
Train Epoch: 12 [951/1000 30432/32000 (95%)] Loss: 0.93212 (QuantReg: 12.07878) QuantErr: 12.07878 batch_time=0.44481 
Train Epoch: 12 [956/1000 30592/32000 (96%)] Loss: 0.56742 (QuantReg: 12.44298) QuantErr: 12.44298 batch_time=0.37927 
Train Epoch: 12 [961/1000 30752/32000 (96%)] Loss: 0.31873 (QuantReg: 12.89292) QuantErr: 12.89292 batch_time=0.66560 
Train Epoch: 12 [966/1000 30912/32000 (97%)] Loss: 0.84700 (QuantReg: 12.55169) QuantErr: 12.55169 batch_time=0.63027 
Train Epoch: 12 [971/1000 31072/32000 (97%)] Loss: 1.51233 (QuantReg: 13.25307) QuantErr: 13.25307 batch_time=0.62175 
Train Epoch: 12 [976/1000 31232/32000 (98%)] Loss: 0.67898 (QuantReg: 12.22041) QuantErr: 12.22041 batch_time=0.48894 
Train Epoch: 12 [981/1000 31392/32000 (98%)] Loss: 0.40942 (QuantReg: 12.61432) QuantErr: 12.61432 batch_time=0.36352 
Train Epoch: 12 [986/1000 31552/32000 (99%)] Loss: 0.85244 (QuantReg: 12.62370) QuantErr: 12.62370 batch_time=0.34355 
Train Epoch: 12 [991/1000 31712/32000 (99%)] Loss: 0.71111 (QuantReg: 11.81124) QuantErr: 11.81124 batch_time=0.39462 
Train Epoch: 12 [996/1000 31872/32000 (100%)] Loss: 0.75385 (QuantReg: 12.21032) QuantErr: 12.21032 batch_time=0.38958 
Train Epoch: 12 codebook_update_time=1.82812
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch12.pth ...
Done in 6.415s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch12.pth ...
Done in 12.406s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 0.7072332162857056
 quant_reg      : 12.236027137756349
 quant_err      : 12.236027137756349
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 12000
 MSRVTT_miech_test/t2v_metrics/R1: 17.7
 MSRVTT_miech_test/t2v_metrics/R5: 45.9
 MSRVTT_miech_test/t2v_metrics/R10: 59.0
 MSRVTT_miech_test/t2v_metrics/R50: 86.9
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.459
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.325588132943174
 MSRVTT_miech_test/v2t_metrics/R1: 17.4
 MSRVTT_miech_test/v2t_metrics/R5: 47.0
 MSRVTT_miech_test/v2t_metrics/R10: 60.9
 MSRVTT_miech_test/v2t_metrics/R50: 87.6
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.345
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.79211886206474
 mnt_best       : 36.325588132943174
 not_improved_count: 0
Train Epoch: 13 [1/1000 32/32000 (0%)] Loss: 0.80578 (QuantReg: 12.40480) QuantErr: 12.40480 batch_time=30.86963 
Train Epoch: 13 [6/1000 192/32000 (1%)] Loss: 0.56548 (QuantReg: 11.17990) QuantErr: 11.17990 batch_time=0.37637 
Train Epoch: 13 [11/1000 352/32000 (1%)] Loss: 1.23535 (QuantReg: 12.29594) QuantErr: 12.29594 batch_time=0.40762 
Train Epoch: 13 [16/1000 512/32000 (2%)] Loss: 1.15029 (QuantReg: 11.82949) QuantErr: 11.82949 batch_time=0.52218 
Train Epoch: 13 [21/1000 672/32000 (2%)] Loss: 0.90846 (QuantReg: 12.27151) QuantErr: 12.27151 batch_time=0.36737 
Train Epoch: 13 [26/1000 832/32000 (3%)] Loss: 0.68032 (QuantReg: 11.62279) QuantErr: 11.62279 batch_time=0.48969 
Train Epoch: 13 [31/1000 992/32000 (3%)] Loss: 0.69139 (QuantReg: 12.00326) QuantErr: 12.00326 batch_time=0.35488 
Train Epoch: 13 [36/1000 1152/32000 (4%)] Loss: 0.94184 (QuantReg: 12.77894) QuantErr: 12.77894 batch_time=0.40605 
Train Epoch: 13 [41/1000 1312/32000 (4%)] Loss: 0.77588 (QuantReg: 11.93845) QuantErr: 11.93845 batch_time=0.42936 
Train Epoch: 13 [46/1000 1472/32000 (5%)] Loss: 0.65995 (QuantReg: 12.90584) QuantErr: 12.90584 batch_time=0.42258 
Train Epoch: 13 [51/1000 1632/32000 (5%)] Loss: 0.94105 (QuantReg: 11.99949) QuantErr: 11.99949 batch_time=0.87089 
Train Epoch: 13 [56/1000 1792/32000 (6%)] Loss: 0.50431 (QuantReg: 12.03562) QuantErr: 12.03562 batch_time=0.42819 
Train Epoch: 13 [61/1000 1952/32000 (6%)] Loss: 0.62862 (QuantReg: 12.41102) QuantErr: 12.41102 batch_time=0.37559 
Train Epoch: 13 [66/1000 2112/32000 (7%)] Loss: 0.82724 (QuantReg: 12.11377) QuantErr: 12.11377 batch_time=0.49399 
Train Epoch: 13 [71/1000 2272/32000 (7%)] Loss: 0.50407 (QuantReg: 11.67911) QuantErr: 11.67911 batch_time=0.39105 
Train Epoch: 13 [76/1000 2432/32000 (8%)] Loss: 0.38112 (QuantReg: 11.64258) QuantErr: 11.64258 batch_time=0.78413 
Train Epoch: 13 [81/1000 2592/32000 (8%)] Loss: 0.49944 (QuantReg: 12.42757) QuantErr: 12.42757 batch_time=0.62565 
Train Epoch: 13 [86/1000 2752/32000 (9%)] Loss: 0.82734 (QuantReg: 12.22927) QuantErr: 12.22927 batch_time=0.36228 
Train Epoch: 13 [91/1000 2912/32000 (9%)] Loss: 0.30627 (QuantReg: 12.44024) QuantErr: 12.44024 batch_time=0.54497 
Train Epoch: 13 [96/1000 3072/32000 (10%)] Loss: 0.24688 (QuantReg: 12.21227) QuantErr: 12.21227 batch_time=0.40587 
Train Epoch: 13 [101/1000 3232/32000 (10%)] Loss: 0.84952 (QuantReg: 12.17402) QuantErr: 12.17402 batch_time=0.48055 
Train Epoch: 13 [106/1000 3392/32000 (11%)] Loss: 0.42004 (QuantReg: 12.04264) QuantErr: 12.04264 batch_time=0.42328 
Train Epoch: 13 [111/1000 3552/32000 (11%)] Loss: 0.56175 (QuantReg: 12.41802) QuantErr: 12.41802 batch_time=0.49150 
Train Epoch: 13 [116/1000 3712/32000 (12%)] Loss: 0.28350 (QuantReg: 12.62635) QuantErr: 12.62635 batch_time=0.33694 
Train Epoch: 13 [121/1000 3872/32000 (12%)] Loss: 0.66345 (QuantReg: 11.82316) QuantErr: 11.82316 batch_time=0.75767 
Train Epoch: 13 [126/1000 4032/32000 (13%)] Loss: 0.34379 (QuantReg: 12.53651) QuantErr: 12.53651 batch_time=0.34577 
Train Epoch: 13 [131/1000 4192/32000 (13%)] Loss: 1.02774 (QuantReg: 12.44984) QuantErr: 12.44984 batch_time=0.65072 
Train Epoch: 13 [136/1000 4352/32000 (14%)] Loss: 0.87196 (QuantReg: 12.26252) QuantErr: 12.26252 batch_time=0.35295 
Train Epoch: 13 [141/1000 4512/32000 (14%)] Loss: 0.21854 (QuantReg: 12.06304) QuantErr: 12.06304 batch_time=0.37453 
Train Epoch: 13 [146/1000 4672/32000 (15%)] Loss: 0.67903 (QuantReg: 11.75138) QuantErr: 11.75138 batch_time=0.36502 
Train Epoch: 13 [151/1000 4832/32000 (15%)] Loss: 0.55916 (QuantReg: 11.93558) QuantErr: 11.93558 batch_time=0.34500 
Train Epoch: 13 [156/1000 4992/32000 (16%)] Loss: 0.73119 (QuantReg: 12.03147) QuantErr: 12.03147 batch_time=0.40696 
Train Epoch: 13 [161/1000 5152/32000 (16%)] Loss: 1.04554 (QuantReg: 12.81422) QuantErr: 12.81422 batch_time=0.34049 
Train Epoch: 13 [166/1000 5312/32000 (17%)] Loss: 0.66783 (QuantReg: 12.19833) QuantErr: 12.19833 batch_time=0.48003 
Train Epoch: 13 [171/1000 5472/32000 (17%)] Loss: 0.29246 (QuantReg: 11.77748) QuantErr: 11.77748 batch_time=0.37604 
Train Epoch: 13 [176/1000 5632/32000 (18%)] Loss: 0.62586 (QuantReg: 11.97026) QuantErr: 11.97026 batch_time=0.38698 
Train Epoch: 13 [181/1000 5792/32000 (18%)] Loss: 0.79343 (QuantReg: 12.24637) QuantErr: 12.24637 batch_time=0.34158 
Train Epoch: 13 [186/1000 5952/32000 (19%)] Loss: 0.46812 (QuantReg: 13.01039) QuantErr: 13.01039 batch_time=0.41301 
Train Epoch: 13 [191/1000 6112/32000 (19%)] Loss: 0.80532 (QuantReg: 11.16826) QuantErr: 11.16826 batch_time=0.34141 
Train Epoch: 13 [196/1000 6272/32000 (20%)] Loss: 0.74067 (QuantReg: 11.87882) QuantErr: 11.87882 batch_time=0.34450 
Train Epoch: 13 [201/1000 6432/32000 (20%)] Loss: 1.57542 (QuantReg: 11.69091) QuantErr: 11.69091 batch_time=0.38358 
Train Epoch: 13 [206/1000 6592/32000 (21%)] Loss: 0.57620 (QuantReg: 12.08689) QuantErr: 12.08689 batch_time=0.40957 
Train Epoch: 13 [211/1000 6752/32000 (21%)] Loss: 0.35348 (QuantReg: 12.02365) QuantErr: 12.02365 batch_time=0.53750 
Train Epoch: 13 [216/1000 6912/32000 (22%)] Loss: 0.38526 (QuantReg: 12.20722) QuantErr: 12.20722 batch_time=0.35014 
Train Epoch: 13 [221/1000 7072/32000 (22%)] Loss: 0.78607 (QuantReg: 12.07587) QuantErr: 12.07587 batch_time=0.37306 
Train Epoch: 13 [226/1000 7232/32000 (23%)] Loss: 0.44874 (QuantReg: 12.37847) QuantErr: 12.37847 batch_time=0.37223 
Train Epoch: 13 [231/1000 7392/32000 (23%)] Loss: 0.50051 (QuantReg: 12.30152) QuantErr: 12.30152 batch_time=0.36124 
Train Epoch: 13 [236/1000 7552/32000 (24%)] Loss: 0.54937 (QuantReg: 12.41357) QuantErr: 12.41357 batch_time=0.37169 
Train Epoch: 13 [241/1000 7712/32000 (24%)] Loss: 0.97220 (QuantReg: 12.34289) QuantErr: 12.34289 batch_time=0.44020 
Train Epoch: 13 [246/1000 7872/32000 (25%)] Loss: 1.21173 (QuantReg: 11.42404) QuantErr: 11.42404 batch_time=0.37957 
Train Epoch: 13 [251/1000 8032/32000 (25%)] Loss: 0.64636 (QuantReg: 12.53229) QuantErr: 12.53229 batch_time=0.33879 
Train Epoch: 13 [256/1000 8192/32000 (26%)] Loss: 0.57938 (QuantReg: 11.79995) QuantErr: 11.79995 batch_time=0.39943 
Train Epoch: 13 [261/1000 8352/32000 (26%)] Loss: 0.88924 (QuantReg: 13.04607) QuantErr: 13.04607 batch_time=0.39887 
Train Epoch: 13 [266/1000 8512/32000 (27%)] Loss: 0.89588 (QuantReg: 12.72837) QuantErr: 12.72837 batch_time=0.50210 
Train Epoch: 13 [271/1000 8672/32000 (27%)] Loss: 0.64015 (QuantReg: 12.14074) QuantErr: 12.14074 batch_time=0.33886 
Train Epoch: 13 [276/1000 8832/32000 (28%)] Loss: 0.62794 (QuantReg: 11.51887) QuantErr: 11.51887 batch_time=0.35265 
Train Epoch: 13 [281/1000 8992/32000 (28%)] Loss: 0.75002 (QuantReg: 11.84804) QuantErr: 11.84804 batch_time=0.39504 
Train Epoch: 13 [286/1000 9152/32000 (29%)] Loss: 0.47336 (QuantReg: 12.41995) QuantErr: 12.41995 batch_time=0.35713 
Train Epoch: 13 [291/1000 9312/32000 (29%)] Loss: 0.50521 (QuantReg: 12.28171) QuantErr: 12.28171 batch_time=0.37859 
Train Epoch: 13 [296/1000 9472/32000 (30%)] Loss: 0.37797 (QuantReg: 12.88111) QuantErr: 12.88111 batch_time=0.40315 
Train Epoch: 13 [301/1000 9632/32000 (30%)] Loss: 0.68889 (QuantReg: 11.91623) QuantErr: 11.91623 batch_time=0.60334 
Train Epoch: 13 [306/1000 9792/32000 (31%)] Loss: 0.68707 (QuantReg: 12.33507) QuantErr: 12.33507 batch_time=0.37155 
Train Epoch: 13 [311/1000 9952/32000 (31%)] Loss: 1.03551 (QuantReg: 12.06005) QuantErr: 12.06005 batch_time=0.35045 
Train Epoch: 13 [316/1000 10112/32000 (32%)] Loss: 0.40472 (QuantReg: 12.40340) QuantErr: 12.40340 batch_time=0.40016 
Train Epoch: 13 [321/1000 10272/32000 (32%)] Loss: 0.40968 (QuantReg: 12.16792) QuantErr: 12.16792 batch_time=0.38165 
Train Epoch: 13 [326/1000 10432/32000 (33%)] Loss: 0.49138 (QuantReg: 12.62682) QuantErr: 12.62682 batch_time=0.39084 
Train Epoch: 13 [331/1000 10592/32000 (33%)] Loss: 1.46694 (QuantReg: 11.61515) QuantErr: 11.61515 batch_time=0.34543 
Train Epoch: 13 [336/1000 10752/32000 (34%)] Loss: 0.28055 (QuantReg: 12.36842) QuantErr: 12.36842 batch_time=1.74497 
Train Epoch: 13 [341/1000 10912/32000 (34%)] Loss: 0.73948 (QuantReg: 12.77320) QuantErr: 12.77320 batch_time=0.59648 
Train Epoch: 13 [346/1000 11072/32000 (35%)] Loss: 0.89821 (QuantReg: 11.71398) QuantErr: 11.71398 batch_time=0.50307 
Train Epoch: 13 [351/1000 11232/32000 (35%)] Loss: 0.43131 (QuantReg: 12.44359) QuantErr: 12.44359 batch_time=0.35062 
Train Epoch: 13 [356/1000 11392/32000 (36%)] Loss: 0.49078 (QuantReg: 11.87171) QuantErr: 11.87171 batch_time=0.38100 
Train Epoch: 13 [361/1000 11552/32000 (36%)] Loss: 0.52449 (QuantReg: 12.02497) QuantErr: 12.02497 batch_time=0.34895 
Train Epoch: 13 [366/1000 11712/32000 (37%)] Loss: 0.93250 (QuantReg: 11.80962) QuantErr: 11.80962 batch_time=1.44945 
Train Epoch: 13 [371/1000 11872/32000 (37%)] Loss: 0.24934 (QuantReg: 12.55628) QuantErr: 12.55628 batch_time=0.43229 
Train Epoch: 13 [376/1000 12032/32000 (38%)] Loss: 1.36058 (QuantReg: 10.97638) QuantErr: 10.97638 batch_time=0.34559 
Train Epoch: 13 [381/1000 12192/32000 (38%)] Loss: 0.74629 (QuantReg: 12.41154) QuantErr: 12.41154 batch_time=0.55247 
Train Epoch: 13 [386/1000 12352/32000 (39%)] Loss: 1.09081 (QuantReg: 12.61785) QuantErr: 12.61785 batch_time=0.35288 
Train Epoch: 13 [391/1000 12512/32000 (39%)] Loss: 0.38723 (QuantReg: 12.05971) QuantErr: 12.05971 batch_time=0.56995 
Train Epoch: 13 [396/1000 12672/32000 (40%)] Loss: 0.73715 (QuantReg: 12.38244) QuantErr: 12.38244 batch_time=0.37417 
Train Epoch: 13 [401/1000 12832/32000 (40%)] Loss: 0.45125 (QuantReg: 12.37364) QuantErr: 12.37364 batch_time=0.36583 
Train Epoch: 13 [406/1000 12992/32000 (41%)] Loss: 0.67254 (QuantReg: 13.11185) QuantErr: 13.11185 batch_time=0.34687 
Train Epoch: 13 [411/1000 13152/32000 (41%)] Loss: 0.33727 (QuantReg: 11.92415) QuantErr: 11.92415 batch_time=0.36655 
Train Epoch: 13 [416/1000 13312/32000 (42%)] Loss: 0.81679 (QuantReg: 11.97067) QuantErr: 11.97067 batch_time=0.41237 
Train Epoch: 13 [421/1000 13472/32000 (42%)] Loss: 0.96411 (QuantReg: 12.51608) QuantErr: 12.51608 batch_time=0.34925 
Train Epoch: 13 [426/1000 13632/32000 (43%)] Loss: 0.71872 (QuantReg: 12.57938) QuantErr: 12.57938 batch_time=0.44816 
Train Epoch: 13 [431/1000 13792/32000 (43%)] Loss: 1.12015 (QuantReg: 11.59347) QuantErr: 11.59347 batch_time=0.40486 
Train Epoch: 13 [436/1000 13952/32000 (44%)] Loss: 0.89756 (QuantReg: 11.38371) QuantErr: 11.38371 batch_time=0.48387 
Train Epoch: 13 [441/1000 14112/32000 (44%)] Loss: 0.40496 (QuantReg: 12.54169) QuantErr: 12.54169 batch_time=0.46360 
Train Epoch: 13 [446/1000 14272/32000 (45%)] Loss: 0.75984 (QuantReg: 12.22186) QuantErr: 12.22186 batch_time=0.33614 
Train Epoch: 13 [451/1000 14432/32000 (45%)] Loss: 0.47932 (QuantReg: 11.91717) QuantErr: 11.91717 batch_time=0.50969 
Train Epoch: 13 [456/1000 14592/32000 (46%)] Loss: 0.69147 (QuantReg: 12.44346) QuantErr: 12.44346 batch_time=0.34062 
Train Epoch: 13 [461/1000 14752/32000 (46%)] Loss: 0.61336 (QuantReg: 12.11607) QuantErr: 12.11607 batch_time=0.36457 
Train Epoch: 13 [466/1000 14912/32000 (47%)] Loss: 0.40741 (QuantReg: 12.31489) QuantErr: 12.31489 batch_time=0.42876 
Train Epoch: 13 [471/1000 15072/32000 (47%)] Loss: 0.61133 (QuantReg: 12.59935) QuantErr: 12.59935 batch_time=0.36360 
Train Epoch: 13 [476/1000 15232/32000 (48%)] Loss: 0.42479 (QuantReg: 12.69613) QuantErr: 12.69613 batch_time=0.44920 
Train Epoch: 13 [481/1000 15392/32000 (48%)] Loss: 0.41003 (QuantReg: 12.71009) QuantErr: 12.71009 batch_time=0.71342 
Train Epoch: 13 [486/1000 15552/32000 (49%)] Loss: 0.35884 (QuantReg: 12.55884) QuantErr: 12.55884 batch_time=0.55031 
Train Epoch: 13 [491/1000 15712/32000 (49%)] Loss: 0.48814 (QuantReg: 13.04330) QuantErr: 13.04330 batch_time=0.48028 
Train Epoch: 13 [496/1000 15872/32000 (50%)] Loss: 0.76051 (QuantReg: 11.70107) QuantErr: 11.70107 batch_time=0.35375 
Train Epoch: 13 [501/1000 16032/32000 (50%)] Loss: 0.58369 (QuantReg: 12.14600) QuantErr: 12.14600 batch_time=0.35176 
Train Epoch: 13 [506/1000 16192/32000 (51%)] Loss: 0.44129 (QuantReg: 12.42070) QuantErr: 12.42070 batch_time=0.43819 
Train Epoch: 13 [511/1000 16352/32000 (51%)] Loss: 0.90508 (QuantReg: 12.29441) QuantErr: 12.29441 batch_time=0.38490 
Train Epoch: 13 [516/1000 16512/32000 (52%)] Loss: 0.48667 (QuantReg: 12.30169) QuantErr: 12.30169 batch_time=0.36724 
Train Epoch: 13 [521/1000 16672/32000 (52%)] Loss: 0.49548 (QuantReg: 11.60776) QuantErr: 11.60776 batch_time=0.39905 
Train Epoch: 13 [526/1000 16832/32000 (53%)] Loss: 0.45851 (QuantReg: 12.04095) QuantErr: 12.04095 batch_time=0.35734 
Train Epoch: 13 [531/1000 16992/32000 (53%)] Loss: 1.05669 (QuantReg: 12.38285) QuantErr: 12.38285 batch_time=0.66457 
Train Epoch: 13 [536/1000 17152/32000 (54%)] Loss: 0.96318 (QuantReg: 11.95403) QuantErr: 11.95403 batch_time=0.35564 
Train Epoch: 13 [541/1000 17312/32000 (54%)] Loss: 0.54546 (QuantReg: 11.96037) QuantErr: 11.96037 batch_time=0.41683 
Train Epoch: 13 [546/1000 17472/32000 (55%)] Loss: 0.40542 (QuantReg: 12.59102) QuantErr: 12.59102 batch_time=0.40076 
Train Epoch: 13 [551/1000 17632/32000 (55%)] Loss: 0.55075 (QuantReg: 11.84716) QuantErr: 11.84716 batch_time=0.38225 
Train Epoch: 13 [556/1000 17792/32000 (56%)] Loss: 0.47829 (QuantReg: 12.47721) QuantErr: 12.47721 batch_time=0.38018 
Train Epoch: 13 [561/1000 17952/32000 (56%)] Loss: 0.53100 (QuantReg: 12.24515) QuantErr: 12.24515 batch_time=0.43632 
Train Epoch: 13 [566/1000 18112/32000 (57%)] Loss: 0.64520 (QuantReg: 12.09492) QuantErr: 12.09492 batch_time=0.35643 
Train Epoch: 13 [571/1000 18272/32000 (57%)] Loss: 0.66947 (QuantReg: 11.69367) QuantErr: 11.69367 batch_time=0.35485 
Train Epoch: 13 [576/1000 18432/32000 (58%)] Loss: 0.67813 (QuantReg: 12.07873) QuantErr: 12.07873 batch_time=0.58318 
Train Epoch: 13 [581/1000 18592/32000 (58%)] Loss: 0.67326 (QuantReg: 12.55291) QuantErr: 12.55291 batch_time=0.40102 
Train Epoch: 13 [586/1000 18752/32000 (59%)] Loss: 0.52472 (QuantReg: 12.58088) QuantErr: 12.58088 batch_time=0.35655 
Train Epoch: 13 [591/1000 18912/32000 (59%)] Loss: 1.09843 (QuantReg: 12.07747) QuantErr: 12.07747 batch_time=0.35676 
Train Epoch: 13 [596/1000 19072/32000 (60%)] Loss: 0.18284 (QuantReg: 12.62782) QuantErr: 12.62782 batch_time=0.39918 
Train Epoch: 13 [601/1000 19232/32000 (60%)] Loss: 0.86305 (QuantReg: 12.84158) QuantErr: 12.84158 batch_time=0.36096 
Train Epoch: 13 [606/1000 19392/32000 (61%)] Loss: 0.77975 (QuantReg: 12.48589) QuantErr: 12.48589 batch_time=0.46222 
Train Epoch: 13 [611/1000 19552/32000 (61%)] Loss: 0.45777 (QuantReg: 12.21128) QuantErr: 12.21128 batch_time=0.35012 
Train Epoch: 13 [616/1000 19712/32000 (62%)] Loss: 1.34412 (QuantReg: 12.23498) QuantErr: 12.23498 batch_time=0.67378 
Train Epoch: 13 [621/1000 19872/32000 (62%)] Loss: 0.86462 (QuantReg: 12.39912) QuantErr: 12.39912 batch_time=0.50574 
Train Epoch: 13 [626/1000 20032/32000 (63%)] Loss: 0.79209 (QuantReg: 12.35658) QuantErr: 12.35658 batch_time=0.52153 
Train Epoch: 13 [631/1000 20192/32000 (63%)] Loss: 0.47603 (QuantReg: 12.66599) QuantErr: 12.66599 batch_time=0.34852 
Train Epoch: 13 [636/1000 20352/32000 (64%)] Loss: 1.37840 (QuantReg: 12.34376) QuantErr: 12.34376 batch_time=0.39601 
Train Epoch: 13 [641/1000 20512/32000 (64%)] Loss: 0.62671 (QuantReg: 11.18054) QuantErr: 11.18054 batch_time=0.44472 
Train Epoch: 13 [646/1000 20672/32000 (65%)] Loss: 0.18891 (QuantReg: 11.97392) QuantErr: 11.97392 batch_time=0.38473 
Train Epoch: 13 [651/1000 20832/32000 (65%)] Loss: 0.44210 (QuantReg: 12.00782) QuantErr: 12.00782 batch_time=0.39002 
Train Epoch: 13 [656/1000 20992/32000 (66%)] Loss: 0.59673 (QuantReg: 11.99759) QuantErr: 11.99759 batch_time=0.79989 
Train Epoch: 13 [661/1000 21152/32000 (66%)] Loss: 0.63228 (QuantReg: 12.25343) QuantErr: 12.25343 batch_time=0.35677 
Train Epoch: 13 [666/1000 21312/32000 (67%)] Loss: 0.73050 (QuantReg: 11.48629) QuantErr: 11.48629 batch_time=0.55418 
Train Epoch: 13 [671/1000 21472/32000 (67%)] Loss: 0.26246 (QuantReg: 12.89485) QuantErr: 12.89485 batch_time=0.37487 
Train Epoch: 13 [676/1000 21632/32000 (68%)] Loss: 0.65033 (QuantReg: 12.72487) QuantErr: 12.72487 batch_time=0.68763 
Train Epoch: 13 [681/1000 21792/32000 (68%)] Loss: 0.82391 (QuantReg: 12.35210) QuantErr: 12.35210 batch_time=0.40484 
Train Epoch: 13 [686/1000 21952/32000 (69%)] Loss: 0.32055 (QuantReg: 12.15293) QuantErr: 12.15293 batch_time=0.53590 
Train Epoch: 13 [691/1000 22112/32000 (69%)] Loss: 0.77198 (QuantReg: 12.75868) QuantErr: 12.75868 batch_time=0.40874 
Train Epoch: 13 [696/1000 22272/32000 (70%)] Loss: 0.97966 (QuantReg: 11.98544) QuantErr: 11.98544 batch_time=0.41440 
Train Epoch: 13 [701/1000 22432/32000 (70%)] Loss: 0.53368 (QuantReg: 12.38502) QuantErr: 12.38502 batch_time=0.35005 
Train Epoch: 13 [706/1000 22592/32000 (71%)] Loss: 0.29213 (QuantReg: 12.35015) QuantErr: 12.35015 batch_time=0.34383 
Train Epoch: 13 [711/1000 22752/32000 (71%)] Loss: 0.65349 (QuantReg: 12.34020) QuantErr: 12.34020 batch_time=0.66428 
Train Epoch: 13 [716/1000 22912/32000 (72%)] Loss: 0.45633 (QuantReg: 12.87626) QuantErr: 12.87626 batch_time=0.53748 
Train Epoch: 13 [721/1000 23072/32000 (72%)] Loss: 0.73981 (QuantReg: 12.50581) QuantErr: 12.50581 batch_time=0.62331 
Train Epoch: 13 [726/1000 23232/32000 (73%)] Loss: 0.68254 (QuantReg: 11.61690) QuantErr: 11.61690 batch_time=0.42236 
Train Epoch: 13 [731/1000 23392/32000 (73%)] Loss: 0.68035 (QuantReg: 11.81027) QuantErr: 11.81027 batch_time=0.40184 
Train Epoch: 13 [736/1000 23552/32000 (74%)] Loss: 0.72997 (QuantReg: 12.97675) QuantErr: 12.97675 batch_time=0.46544 
Train Epoch: 13 [741/1000 23712/32000 (74%)] Loss: 0.74385 (QuantReg: 11.77440) QuantErr: 11.77440 batch_time=0.35002 
Train Epoch: 13 [746/1000 23872/32000 (75%)] Loss: 0.54034 (QuantReg: 11.56533) QuantErr: 11.56533 batch_time=0.69728 
Train Epoch: 13 [751/1000 24032/32000 (75%)] Loss: 0.60917 (QuantReg: 12.18681) QuantErr: 12.18681 batch_time=0.35443 
Train Epoch: 13 [756/1000 24192/32000 (76%)] Loss: 0.91760 (QuantReg: 12.16944) QuantErr: 12.16944 batch_time=0.87635 
Train Epoch: 13 [761/1000 24352/32000 (76%)] Loss: 0.50945 (QuantReg: 12.60188) QuantErr: 12.60188 batch_time=0.39936 
Train Epoch: 13 [766/1000 24512/32000 (77%)] Loss: 0.52178 (QuantReg: 11.94729) QuantErr: 11.94729 batch_time=0.88222 
Train Epoch: 13 [771/1000 24672/32000 (77%)] Loss: 0.54829 (QuantReg: 12.57287) QuantErr: 12.57287 batch_time=0.36625 
Train Epoch: 13 [776/1000 24832/32000 (78%)] Loss: 0.42672 (QuantReg: 12.48238) QuantErr: 12.48238 batch_time=0.41190 
Train Epoch: 13 [781/1000 24992/32000 (78%)] Loss: 0.23745 (QuantReg: 12.59956) QuantErr: 12.59956 batch_time=0.44085 
Train Epoch: 13 [786/1000 25152/32000 (79%)] Loss: 0.77136 (QuantReg: 12.09254) QuantErr: 12.09254 batch_time=0.38151 
Train Epoch: 13 [791/1000 25312/32000 (79%)] Loss: 0.29696 (QuantReg: 11.80700) QuantErr: 11.80700 batch_time=0.55255 
Train Epoch: 13 [796/1000 25472/32000 (80%)] Loss: 0.72518 (QuantReg: 12.03173) QuantErr: 12.03173 batch_time=1.01664 
Train Epoch: 13 [801/1000 25632/32000 (80%)] Loss: 0.27958 (QuantReg: 12.85813) QuantErr: 12.85813 batch_time=0.41159 
Train Epoch: 13 [806/1000 25792/32000 (81%)] Loss: 0.28279 (QuantReg: 12.67279) QuantErr: 12.67279 batch_time=0.67811 
Train Epoch: 13 [811/1000 25952/32000 (81%)] Loss: 0.37068 (QuantReg: 12.54568) QuantErr: 12.54568 batch_time=0.60742 
Train Epoch: 13 [816/1000 26112/32000 (82%)] Loss: 0.45625 (QuantReg: 11.97906) QuantErr: 11.97906 batch_time=0.43069 
Train Epoch: 13 [821/1000 26272/32000 (82%)] Loss: 0.28568 (QuantReg: 12.21682) QuantErr: 12.21682 batch_time=0.46484 
Train Epoch: 13 [826/1000 26432/32000 (83%)] Loss: 0.72196 (QuantReg: 12.16485) QuantErr: 12.16485 batch_time=0.36032 
Train Epoch: 13 [831/1000 26592/32000 (83%)] Loss: 0.53677 (QuantReg: 12.50309) QuantErr: 12.50309 batch_time=0.45324 
Train Epoch: 13 [836/1000 26752/32000 (84%)] Loss: 0.68537 (QuantReg: 12.80277) QuantErr: 12.80277 batch_time=0.96354 
Train Epoch: 13 [841/1000 26912/32000 (84%)] Loss: 0.95854 (QuantReg: 12.95837) QuantErr: 12.95837 batch_time=0.85790 
Train Epoch: 13 [846/1000 27072/32000 (85%)] Loss: 0.39322 (QuantReg: 13.26104) QuantErr: 13.26104 batch_time=0.46808 
Train Epoch: 13 [851/1000 27232/32000 (85%)] Loss: 1.61946 (QuantReg: 11.26658) QuantErr: 11.26658 batch_time=0.48727 
Train Epoch: 13 [856/1000 27392/32000 (86%)] Loss: 0.58291 (QuantReg: 13.05067) QuantErr: 13.05067 batch_time=0.36583 
Train Epoch: 13 [861/1000 27552/32000 (86%)] Loss: 0.48390 (QuantReg: 12.39905) QuantErr: 12.39905 batch_time=0.35773 
Train Epoch: 13 [866/1000 27712/32000 (87%)] Loss: 0.81956 (QuantReg: 11.68004) QuantErr: 11.68004 batch_time=0.41247 
Train Epoch: 13 [871/1000 27872/32000 (87%)] Loss: 1.05134 (QuantReg: 12.64245) QuantErr: 12.64245 batch_time=0.40400 
Train Epoch: 13 [876/1000 28032/32000 (88%)] Loss: 0.51598 (QuantReg: 12.90442) QuantErr: 12.90442 batch_time=0.45893 
Train Epoch: 13 [881/1000 28192/32000 (88%)] Loss: 0.89703 (QuantReg: 12.35431) QuantErr: 12.35431 batch_time=0.39504 
Train Epoch: 13 [886/1000 28352/32000 (89%)] Loss: 0.53327 (QuantReg: 12.27738) QuantErr: 12.27738 batch_time=0.72300 
Train Epoch: 13 [891/1000 28512/32000 (89%)] Loss: 0.64960 (QuantReg: 12.90420) QuantErr: 12.90420 batch_time=0.39020 
Train Epoch: 13 [896/1000 28672/32000 (90%)] Loss: 1.27448 (QuantReg: 12.20321) QuantErr: 12.20321 batch_time=0.38691 
Train Epoch: 13 [901/1000 28832/32000 (90%)] Loss: 1.02399 (QuantReg: 12.19948) QuantErr: 12.19948 batch_time=0.36812 
Train Epoch: 13 [906/1000 28992/32000 (91%)] Loss: 0.99559 (QuantReg: 12.30126) QuantErr: 12.30126 batch_time=0.41248 
Train Epoch: 13 [911/1000 29152/32000 (91%)] Loss: 0.63179 (QuantReg: 12.41684) QuantErr: 12.41684 batch_time=0.35822 
Train Epoch: 13 [916/1000 29312/32000 (92%)] Loss: 0.24937 (QuantReg: 12.38086) QuantErr: 12.38086 batch_time=0.36155 
Train Epoch: 13 [921/1000 29472/32000 (92%)] Loss: 0.47776 (QuantReg: 11.85701) QuantErr: 11.85701 batch_time=0.53547 
Train Epoch: 13 [926/1000 29632/32000 (93%)] Loss: 0.66365 (QuantReg: 12.16248) QuantErr: 12.16248 batch_time=0.34096 
Train Epoch: 13 [931/1000 29792/32000 (93%)] Loss: 0.73659 (QuantReg: 12.27724) QuantErr: 12.27724 batch_time=0.63713 
Train Epoch: 13 [936/1000 29952/32000 (94%)] Loss: 0.68320 (QuantReg: 12.44456) QuantErr: 12.44456 batch_time=0.40465 
Train Epoch: 13 [941/1000 30112/32000 (94%)] Loss: 0.64120 (QuantReg: 11.86240) QuantErr: 11.86240 batch_time=0.63882 
Train Epoch: 13 [946/1000 30272/32000 (95%)] Loss: 0.53648 (QuantReg: 13.13858) QuantErr: 13.13858 batch_time=0.36467 
Train Epoch: 13 [951/1000 30432/32000 (95%)] Loss: 0.48269 (QuantReg: 12.33182) QuantErr: 12.33182 batch_time=0.36616 
Train Epoch: 13 [956/1000 30592/32000 (96%)] Loss: 0.49300 (QuantReg: 12.90404) QuantErr: 12.90404 batch_time=0.41117 
Train Epoch: 13 [961/1000 30752/32000 (96%)] Loss: 0.50748 (QuantReg: 12.16768) QuantErr: 12.16768 batch_time=0.43949 
Train Epoch: 13 [966/1000 30912/32000 (97%)] Loss: 0.39253 (QuantReg: 12.47905) QuantErr: 12.47905 batch_time=0.35950 
Train Epoch: 13 [971/1000 31072/32000 (97%)] Loss: 0.79327 (QuantReg: 12.18894) QuantErr: 12.18894 batch_time=0.69744 
Train Epoch: 13 [976/1000 31232/32000 (98%)] Loss: 0.53408 (QuantReg: 12.90288) QuantErr: 12.90288 batch_time=0.73776 
Train Epoch: 13 [981/1000 31392/32000 (98%)] Loss: 0.24256 (QuantReg: 12.25467) QuantErr: 12.25467 batch_time=0.35440 
Train Epoch: 13 [986/1000 31552/32000 (99%)] Loss: 0.50982 (QuantReg: 12.02829) QuantErr: 12.02829 batch_time=0.41121 
Train Epoch: 13 [991/1000 31712/32000 (99%)] Loss: 0.34339 (QuantReg: 11.76887) QuantErr: 11.76887 batch_time=0.36008 
Train Epoch: 13 [996/1000 31872/32000 (100%)] Loss: 0.48216 (QuantReg: 12.61528) QuantErr: 12.61528 batch_time=0.60306 
Train Epoch: 13 codebook_update_time=1.86118
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch13.pth ...
Done in 5.783s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch13.pth ...
Done in 12.199s
removing stale ckpt [epoch 12] [took 0.01s]
 epoch          : 13
 loss           : 0.6522038859575987
 quant_reg      : 12.268838512420654
 quant_err      : 12.268838512420654
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 13000
 MSRVTT_miech_test/t2v_metrics/R1: 17.8
 MSRVTT_miech_test/t2v_metrics/R5: 46.9
 MSRVTT_miech_test/t2v_metrics/R10: 61.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.883
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.086115946003076
 MSRVTT_miech_test/v2t_metrics/R1: 18.8
 MSRVTT_miech_test/v2t_metrics/R5: 45.7
 MSRVTT_miech_test/v2t_metrics/R10: 59.9
 MSRVTT_miech_test/v2t_metrics/R50: 86.7
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.895
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.196347003221796
 mnt_best       : 37.086115946003076
 not_improved_count: 0
Train Epoch: 14 [1/1000 32/32000 (0%)] Loss: 0.70616 (QuantReg: 11.97413) QuantErr: 11.97413 batch_time=31.19697 
Train Epoch: 14 [6/1000 192/32000 (1%)] Loss: 0.90396 (QuantReg: 11.43340) QuantErr: 11.43340 batch_time=0.36277 
Train Epoch: 14 [11/1000 352/32000 (1%)] Loss: 0.62177 (QuantReg: 12.22768) QuantErr: 12.22768 batch_time=0.36005 
Train Epoch: 14 [16/1000 512/32000 (2%)] Loss: 0.54620 (QuantReg: 11.96663) QuantErr: 11.96663 batch_time=0.42628 
Train Epoch: 14 [21/1000 672/32000 (2%)] Loss: 0.81625 (QuantReg: 12.23765) QuantErr: 12.23765 batch_time=0.38446 
Train Epoch: 14 [26/1000 832/32000 (3%)] Loss: 0.61063 (QuantReg: 11.48140) QuantErr: 11.48140 batch_time=0.34111 
Train Epoch: 14 [31/1000 992/32000 (3%)] Loss: 0.45409 (QuantReg: 12.18781) QuantErr: 12.18781 batch_time=0.72020 
Train Epoch: 14 [36/1000 1152/32000 (4%)] Loss: 0.65230 (QuantReg: 12.40603) QuantErr: 12.40603 batch_time=0.34729 
Train Epoch: 14 [41/1000 1312/32000 (4%)] Loss: 0.99705 (QuantReg: 11.83203) QuantErr: 11.83203 batch_time=0.50472 
Train Epoch: 14 [46/1000 1472/32000 (5%)] Loss: 0.47695 (QuantReg: 12.36922) QuantErr: 12.36922 batch_time=0.39459 
Train Epoch: 14 [51/1000 1632/32000 (5%)] Loss: 1.34989 (QuantReg: 11.66883) QuantErr: 11.66883 batch_time=0.35555 
Train Epoch: 14 [56/1000 1792/32000 (6%)] Loss: 0.68418 (QuantReg: 11.78744) QuantErr: 11.78744 batch_time=0.33806 
Train Epoch: 14 [61/1000 1952/32000 (6%)] Loss: 0.43907 (QuantReg: 12.30171) QuantErr: 12.30171 batch_time=0.40657 
Train Epoch: 14 [66/1000 2112/32000 (7%)] Loss: 0.32911 (QuantReg: 12.52524) QuantErr: 12.52524 batch_time=0.50580 
Train Epoch: 14 [71/1000 2272/32000 (7%)] Loss: 0.28502 (QuantReg: 11.52126) QuantErr: 11.52126 batch_time=0.66980 
Train Epoch: 14 [76/1000 2432/32000 (8%)] Loss: 0.35955 (QuantReg: 11.09611) QuantErr: 11.09611 batch_time=0.34053 
Train Epoch: 14 [81/1000 2592/32000 (8%)] Loss: 0.47257 (QuantReg: 11.87629) QuantErr: 11.87629 batch_time=0.88088 
Train Epoch: 14 [86/1000 2752/32000 (9%)] Loss: 0.61407 (QuantReg: 11.97968) QuantErr: 11.97968 batch_time=0.54182 
Train Epoch: 14 [91/1000 2912/32000 (9%)] Loss: 0.86046 (QuantReg: 11.46781) QuantErr: 11.46781 batch_time=0.38525 
Train Epoch: 14 [96/1000 3072/32000 (10%)] Loss: 0.76944 (QuantReg: 12.26801) QuantErr: 12.26801 batch_time=1.14323 
Train Epoch: 14 [101/1000 3232/32000 (10%)] Loss: 0.71501 (QuantReg: 11.98310) QuantErr: 11.98310 batch_time=0.40321 
Train Epoch: 14 [106/1000 3392/32000 (11%)] Loss: 0.11327 (QuantReg: 12.57637) QuantErr: 12.57637 batch_time=0.41652 
Train Epoch: 14 [111/1000 3552/32000 (11%)] Loss: 0.82318 (QuantReg: 12.09290) QuantErr: 12.09290 batch_time=0.38192 
Train Epoch: 14 [116/1000 3712/32000 (12%)] Loss: 0.79734 (QuantReg: 12.24021) QuantErr: 12.24021 batch_time=0.40476 
Train Epoch: 14 [121/1000 3872/32000 (12%)] Loss: 0.77374 (QuantReg: 11.90723) QuantErr: 11.90723 batch_time=0.47279 
Train Epoch: 14 [126/1000 4032/32000 (13%)] Loss: 0.52535 (QuantReg: 12.44017) QuantErr: 12.44017 batch_time=0.41649 
Train Epoch: 14 [131/1000 4192/32000 (13%)] Loss: 0.17621 (QuantReg: 12.66706) QuantErr: 12.66706 batch_time=0.33369 
Train Epoch: 14 [136/1000 4352/32000 (14%)] Loss: 0.66144 (QuantReg: 12.55738) QuantErr: 12.55738 batch_time=0.48528 
Train Epoch: 14 [141/1000 4512/32000 (14%)] Loss: 0.51571 (QuantReg: 12.04222) QuantErr: 12.04222 batch_time=0.33646 
Train Epoch: 14 [146/1000 4672/32000 (15%)] Loss: 1.01085 (QuantReg: 12.23404) QuantErr: 12.23404 batch_time=0.35037 
Train Epoch: 14 [151/1000 4832/32000 (15%)] Loss: 0.89042 (QuantReg: 11.60908) QuantErr: 11.60908 batch_time=0.38855 
Train Epoch: 14 [156/1000 4992/32000 (16%)] Loss: 0.44700 (QuantReg: 12.57477) QuantErr: 12.57477 batch_time=0.56177 
Train Epoch: 14 [161/1000 5152/32000 (16%)] Loss: 0.38807 (QuantReg: 12.32338) QuantErr: 12.32338 batch_time=0.36024 
Train Epoch: 14 [166/1000 5312/32000 (17%)] Loss: 0.61010 (QuantReg: 12.83585) QuantErr: 12.83585 batch_time=0.74219 
Train Epoch: 14 [171/1000 5472/32000 (17%)] Loss: 0.66077 (QuantReg: 12.50714) QuantErr: 12.50714 batch_time=0.41712 
Train Epoch: 14 [176/1000 5632/32000 (18%)] Loss: 0.25511 (QuantReg: 12.54642) QuantErr: 12.54642 batch_time=0.35483 
Train Epoch: 14 [181/1000 5792/32000 (18%)] Loss: 0.78610 (QuantReg: 12.17204) QuantErr: 12.17204 batch_time=0.63508 
Train Epoch: 14 [186/1000 5952/32000 (19%)] Loss: 0.96926 (QuantReg: 11.74470) QuantErr: 11.74470 batch_time=0.38222 
Train Epoch: 14 [191/1000 6112/32000 (19%)] Loss: 0.57540 (QuantReg: 11.83491) QuantErr: 11.83491 batch_time=0.37420 
Train Epoch: 14 [196/1000 6272/32000 (20%)] Loss: 0.48505 (QuantReg: 12.03660) QuantErr: 12.03660 batch_time=0.34405 
Train Epoch: 14 [201/1000 6432/32000 (20%)] Loss: 0.74945 (QuantReg: 12.07706) QuantErr: 12.07706 batch_time=0.40109 
Train Epoch: 14 [206/1000 6592/32000 (21%)] Loss: 0.80747 (QuantReg: 11.97519) QuantErr: 11.97519 batch_time=0.38364 
Train Epoch: 14 [211/1000 6752/32000 (21%)] Loss: 0.40068 (QuantReg: 12.47405) QuantErr: 12.47405 batch_time=0.59047 
Train Epoch: 14 [216/1000 6912/32000 (22%)] Loss: 0.40830 (QuantReg: 12.02211) QuantErr: 12.02211 batch_time=0.66681 
Train Epoch: 14 [221/1000 7072/32000 (22%)] Loss: 0.42969 (QuantReg: 12.45856) QuantErr: 12.45856 batch_time=0.42897 
Train Epoch: 14 [226/1000 7232/32000 (23%)] Loss: 0.73068 (QuantReg: 11.68801) QuantErr: 11.68801 batch_time=0.42317 
Train Epoch: 14 [231/1000 7392/32000 (23%)] Loss: 0.36831 (QuantReg: 12.92070) QuantErr: 12.92070 batch_time=0.37534 
Train Epoch: 14 [236/1000 7552/32000 (24%)] Loss: 0.75953 (QuantReg: 11.85103) QuantErr: 11.85103 batch_time=0.38782 
Train Epoch: 14 [241/1000 7712/32000 (24%)] Loss: 0.57608 (QuantReg: 11.51458) QuantErr: 11.51458 batch_time=0.44138 
Train Epoch: 14 [246/1000 7872/32000 (25%)] Loss: 0.50444 (QuantReg: 12.12566) QuantErr: 12.12566 batch_time=0.36115 
Train Epoch: 14 [251/1000 8032/32000 (25%)] Loss: 0.66478 (QuantReg: 11.45284) QuantErr: 11.45284 batch_time=0.67545 
Train Epoch: 14 [256/1000 8192/32000 (26%)] Loss: 0.31268 (QuantReg: 11.92257) QuantErr: 11.92257 batch_time=0.34140 
Train Epoch: 14 [261/1000 8352/32000 (26%)] Loss: 0.65754 (QuantReg: 11.66578) QuantErr: 11.66578 batch_time=0.54445 
Train Epoch: 14 [266/1000 8512/32000 (27%)] Loss: 1.29081 (QuantReg: 11.00687) QuantErr: 11.00687 batch_time=0.35669 
Train Epoch: 14 [271/1000 8672/32000 (27%)] Loss: 0.61652 (QuantReg: 11.87133) QuantErr: 11.87133 batch_time=0.35172 
Train Epoch: 14 [276/1000 8832/32000 (28%)] Loss: 0.37855 (QuantReg: 12.39343) QuantErr: 12.39343 batch_time=0.37124 
Train Epoch: 14 [281/1000 8992/32000 (28%)] Loss: 1.21722 (QuantReg: 12.21123) QuantErr: 12.21123 batch_time=0.38898 
Train Epoch: 14 [286/1000 9152/32000 (29%)] Loss: 0.27249 (QuantReg: 11.90914) QuantErr: 11.90914 batch_time=0.96236 
Train Epoch: 14 [291/1000 9312/32000 (29%)] Loss: 0.55228 (QuantReg: 12.61398) QuantErr: 12.61398 batch_time=0.35455 
Train Epoch: 14 [296/1000 9472/32000 (30%)] Loss: 0.55941 (QuantReg: 12.20302) QuantErr: 12.20302 batch_time=0.40084 
Train Epoch: 14 [301/1000 9632/32000 (30%)] Loss: 0.55497 (QuantReg: 12.00147) QuantErr: 12.00147 batch_time=0.67457 
Train Epoch: 14 [306/1000 9792/32000 (31%)] Loss: 0.61343 (QuantReg: 12.26608) QuantErr: 12.26608 batch_time=0.38882 
Train Epoch: 14 [311/1000 9952/32000 (31%)] Loss: 0.44283 (QuantReg: 11.96418) QuantErr: 11.96418 batch_time=0.47917 
Train Epoch: 14 [316/1000 10112/32000 (32%)] Loss: 0.63147 (QuantReg: 12.44936) QuantErr: 12.44936 batch_time=0.38485 
Train Epoch: 14 [321/1000 10272/32000 (32%)] Loss: 0.80743 (QuantReg: 11.82914) QuantErr: 11.82914 batch_time=0.33107 
Train Epoch: 14 [326/1000 10432/32000 (33%)] Loss: 0.39736 (QuantReg: 12.57310) QuantErr: 12.57310 batch_time=1.74318 
Train Epoch: 14 [331/1000 10592/32000 (33%)] Loss: 0.28609 (QuantReg: 12.21367) QuantErr: 12.21367 batch_time=0.34194 
Train Epoch: 14 [336/1000 10752/32000 (34%)] Loss: 0.67533 (QuantReg: 12.22521) QuantErr: 12.22521 batch_time=0.42115 
Train Epoch: 14 [341/1000 10912/32000 (34%)] Loss: 1.14074 (QuantReg: 11.68820) QuantErr: 11.68820 batch_time=0.38051 
Train Epoch: 14 [346/1000 11072/32000 (35%)] Loss: 0.43705 (QuantReg: 11.61097) QuantErr: 11.61097 batch_time=0.47961 
Train Epoch: 14 [351/1000 11232/32000 (35%)] Loss: 0.51056 (QuantReg: 12.36594) QuantErr: 12.36594 batch_time=0.39990 
Train Epoch: 14 [356/1000 11392/32000 (36%)] Loss: 0.48243 (QuantReg: 12.32110) QuantErr: 12.32110 batch_time=0.46628 
Train Epoch: 14 [361/1000 11552/32000 (36%)] Loss: 0.49391 (QuantReg: 11.46563) QuantErr: 11.46563 batch_time=0.42314 
Train Epoch: 14 [366/1000 11712/32000 (37%)] Loss: 0.53316 (QuantReg: 12.75822) QuantErr: 12.75822 batch_time=0.34183 
Train Epoch: 14 [371/1000 11872/32000 (37%)] Loss: 0.92587 (QuantReg: 12.34893) QuantErr: 12.34893 batch_time=0.35194 
Train Epoch: 14 [376/1000 12032/32000 (38%)] Loss: 0.27023 (QuantReg: 12.99798) QuantErr: 12.99798 batch_time=0.33951 
Train Epoch: 14 [381/1000 12192/32000 (38%)] Loss: 1.03071 (QuantReg: 12.40632) QuantErr: 12.40632 batch_time=0.36077 
Train Epoch: 14 [386/1000 12352/32000 (39%)] Loss: 1.13198 (QuantReg: 12.20503) QuantErr: 12.20503 batch_time=0.45881 
Train Epoch: 14 [391/1000 12512/32000 (39%)] Loss: 0.51377 (QuantReg: 11.55331) QuantErr: 11.55331 batch_time=0.63718 
Train Epoch: 14 [396/1000 12672/32000 (40%)] Loss: 0.77750 (QuantReg: 12.59310) QuantErr: 12.59310 batch_time=0.51771 
Train Epoch: 14 [401/1000 12832/32000 (40%)] Loss: 0.37526 (QuantReg: 12.62159) QuantErr: 12.62159 batch_time=0.40987 
Train Epoch: 14 [406/1000 12992/32000 (41%)] Loss: 0.76619 (QuantReg: 12.07996) QuantErr: 12.07996 batch_time=0.45446 
Train Epoch: 14 [411/1000 13152/32000 (41%)] Loss: 0.62956 (QuantReg: 12.85837) QuantErr: 12.85837 batch_time=0.35097 
Train Epoch: 14 [416/1000 13312/32000 (42%)] Loss: 0.87214 (QuantReg: 11.12212) QuantErr: 11.12212 batch_time=0.35485 
Train Epoch: 14 [421/1000 13472/32000 (42%)] Loss: 0.82365 (QuantReg: 12.41774) QuantErr: 12.41774 batch_time=0.36910 
Train Epoch: 14 [426/1000 13632/32000 (43%)] Loss: 0.40765 (QuantReg: 12.14625) QuantErr: 12.14625 batch_time=0.37922 
Train Epoch: 14 [431/1000 13792/32000 (43%)] Loss: 0.30154 (QuantReg: 12.85649) QuantErr: 12.85649 batch_time=0.42798 
Train Epoch: 14 [436/1000 13952/32000 (44%)] Loss: 0.46916 (QuantReg: 12.08074) QuantErr: 12.08074 batch_time=0.33861 
Train Epoch: 14 [441/1000 14112/32000 (44%)] Loss: 0.84902 (QuantReg: 12.04318) QuantErr: 12.04318 batch_time=0.59735 
Train Epoch: 14 [446/1000 14272/32000 (45%)] Loss: 0.92181 (QuantReg: 12.36132) QuantErr: 12.36132 batch_time=0.38080 
Train Epoch: 14 [451/1000 14432/32000 (45%)] Loss: 0.96375 (QuantReg: 11.69823) QuantErr: 11.69823 batch_time=0.35073 
Train Epoch: 14 [456/1000 14592/32000 (46%)] Loss: 0.33042 (QuantReg: 13.66295) QuantErr: 13.66295 batch_time=0.36234 
Train Epoch: 14 [461/1000 14752/32000 (46%)] Loss: 0.60711 (QuantReg: 11.75319) QuantErr: 11.75319 batch_time=0.36010 
Train Epoch: 14 [466/1000 14912/32000 (47%)] Loss: 0.98173 (QuantReg: 11.96231) QuantErr: 11.96231 batch_time=0.39275 
Train Epoch: 14 [471/1000 15072/32000 (47%)] Loss: 1.29203 (QuantReg: 12.35146) QuantErr: 12.35146 batch_time=0.35984 
Train Epoch: 14 [476/1000 15232/32000 (48%)] Loss: 0.35591 (QuantReg: 12.39560) QuantErr: 12.39560 batch_time=0.40492 
Train Epoch: 14 [481/1000 15392/32000 (48%)] Loss: 0.54748 (QuantReg: 12.84567) QuantErr: 12.84567 batch_time=0.35909 
Train Epoch: 14 [486/1000 15552/32000 (49%)] Loss: 0.78482 (QuantReg: 12.62645) QuantErr: 12.62645 batch_time=0.61875 
Train Epoch: 14 [491/1000 15712/32000 (49%)] Loss: 0.79668 (QuantReg: 12.27961) QuantErr: 12.27961 batch_time=0.45963 
Train Epoch: 14 [496/1000 15872/32000 (50%)] Loss: 0.53759 (QuantReg: 11.88233) QuantErr: 11.88233 batch_time=0.39569 
Train Epoch: 14 [501/1000 16032/32000 (50%)] Loss: 0.21180 (QuantReg: 12.53445) QuantErr: 12.53445 batch_time=0.48120 
Train Epoch: 14 [506/1000 16192/32000 (51%)] Loss: 0.33209 (QuantReg: 12.63349) QuantErr: 12.63349 batch_time=0.34801 
Train Epoch: 14 [511/1000 16352/32000 (51%)] Loss: 0.51053 (QuantReg: 13.01397) QuantErr: 13.01397 batch_time=0.42586 
Train Epoch: 14 [516/1000 16512/32000 (52%)] Loss: 1.07103 (QuantReg: 12.92019) QuantErr: 12.92019 batch_time=0.36497 
Train Epoch: 14 [521/1000 16672/32000 (52%)] Loss: 0.53771 (QuantReg: 12.70653) QuantErr: 12.70653 batch_time=0.39157 
Train Epoch: 14 [526/1000 16832/32000 (53%)] Loss: 0.89919 (QuantReg: 11.72947) QuantErr: 11.72947 batch_time=0.38123 
Train Epoch: 14 [531/1000 16992/32000 (53%)] Loss: 0.30374 (QuantReg: 11.77300) QuantErr: 11.77300 batch_time=0.67266 
Train Epoch: 14 [536/1000 17152/32000 (54%)] Loss: 0.53980 (QuantReg: 12.39775) QuantErr: 12.39775 batch_time=0.35808 
Train Epoch: 14 [541/1000 17312/32000 (54%)] Loss: 0.57582 (QuantReg: 11.92386) QuantErr: 11.92386 batch_time=0.48590 
Train Epoch: 14 [546/1000 17472/32000 (55%)] Loss: 0.62591 (QuantReg: 12.60248) QuantErr: 12.60248 batch_time=0.39707 
Train Epoch: 14 [551/1000 17632/32000 (55%)] Loss: 0.64856 (QuantReg: 12.48784) QuantErr: 12.48784 batch_time=0.35947 
Train Epoch: 14 [556/1000 17792/32000 (56%)] Loss: 0.42394 (QuantReg: 12.51092) QuantErr: 12.51092 batch_time=0.37558 
Train Epoch: 14 [561/1000 17952/32000 (56%)] Loss: 0.64456 (QuantReg: 12.19138) QuantErr: 12.19138 batch_time=0.35321 
Train Epoch: 14 [566/1000 18112/32000 (57%)] Loss: 0.59656 (QuantReg: 12.01510) QuantErr: 12.01510 batch_time=0.35751 
Train Epoch: 14 [571/1000 18272/32000 (57%)] Loss: 0.28105 (QuantReg: 12.19216) QuantErr: 12.19216 batch_time=0.42945 
Train Epoch: 14 [576/1000 18432/32000 (58%)] Loss: 0.71417 (QuantReg: 12.74680) QuantErr: 12.74680 batch_time=0.69026 
Train Epoch: 14 [581/1000 18592/32000 (58%)] Loss: 1.22919 (QuantReg: 12.02859) QuantErr: 12.02859 batch_time=0.57540 
Train Epoch: 14 [586/1000 18752/32000 (59%)] Loss: 0.42063 (QuantReg: 12.89938) QuantErr: 12.89938 batch_time=0.33928 
Train Epoch: 14 [591/1000 18912/32000 (59%)] Loss: 0.75270 (QuantReg: 11.71887) QuantErr: 11.71887 batch_time=0.41490 
Train Epoch: 14 [596/1000 19072/32000 (60%)] Loss: 0.70773 (QuantReg: 11.97036) QuantErr: 11.97036 batch_time=0.41041 
Train Epoch: 14 [601/1000 19232/32000 (60%)] Loss: 0.60081 (QuantReg: 13.55136) QuantErr: 13.55136 batch_time=0.39891 
Train Epoch: 14 [606/1000 19392/32000 (61%)] Loss: 0.57270 (QuantReg: 12.33700) QuantErr: 12.33700 batch_time=1.09007 
Train Epoch: 14 [611/1000 19552/32000 (61%)] Loss: 0.60011 (QuantReg: 11.65605) QuantErr: 11.65605 batch_time=0.43073 
Train Epoch: 14 [616/1000 19712/32000 (62%)] Loss: 0.34969 (QuantReg: 12.64666) QuantErr: 12.64666 batch_time=0.37612 
Train Epoch: 14 [621/1000 19872/32000 (62%)] Loss: 1.18617 (QuantReg: 12.78863) QuantErr: 12.78863 batch_time=0.35881 
Train Epoch: 14 [626/1000 20032/32000 (63%)] Loss: 0.34619 (QuantReg: 12.42201) QuantErr: 12.42201 batch_time=0.51718 
Train Epoch: 14 [631/1000 20192/32000 (63%)] Loss: 0.60558 (QuantReg: 12.49963) QuantErr: 12.49963 batch_time=0.40337 
Train Epoch: 14 [636/1000 20352/32000 (64%)] Loss: 0.31736 (QuantReg: 12.85031) QuantErr: 12.85031 batch_time=0.38089 
Train Epoch: 14 [641/1000 20512/32000 (64%)] Loss: 1.48557 (QuantReg: 12.24605) QuantErr: 12.24605 batch_time=0.34175 
Train Epoch: 14 [646/1000 20672/32000 (65%)] Loss: 0.38675 (QuantReg: 13.16947) QuantErr: 13.16947 batch_time=1.40466 
Train Epoch: 14 [651/1000 20832/32000 (65%)] Loss: 0.46012 (QuantReg: 12.79835) QuantErr: 12.79835 batch_time=0.34548 
Train Epoch: 14 [656/1000 20992/32000 (66%)] Loss: 0.71647 (QuantReg: 12.30379) QuantErr: 12.30379 batch_time=0.36349 
Train Epoch: 14 [661/1000 21152/32000 (66%)] Loss: 0.61070 (QuantReg: 12.36579) QuantErr: 12.36579 batch_time=0.34835 
Train Epoch: 14 [666/1000 21312/32000 (67%)] Loss: 0.30603 (QuantReg: 13.06835) QuantErr: 13.06835 batch_time=0.39247 
Train Epoch: 14 [671/1000 21472/32000 (67%)] Loss: 0.87917 (QuantReg: 12.88621) QuantErr: 12.88621 batch_time=0.36075 
Train Epoch: 14 [676/1000 21632/32000 (68%)] Loss: 0.63439 (QuantReg: 12.14913) QuantErr: 12.14913 batch_time=0.77297 
Train Epoch: 14 [681/1000 21792/32000 (68%)] Loss: 0.45009 (QuantReg: 12.09701) QuantErr: 12.09701 batch_time=0.50758 
Train Epoch: 14 [686/1000 21952/32000 (69%)] Loss: 0.39559 (QuantReg: 12.83531) QuantErr: 12.83531 batch_time=0.61848 
Train Epoch: 14 [691/1000 22112/32000 (69%)] Loss: 0.58601 (QuantReg: 12.59531) QuantErr: 12.59531 batch_time=0.40489 
Train Epoch: 14 [696/1000 22272/32000 (70%)] Loss: 0.67595 (QuantReg: 12.19279) QuantErr: 12.19279 batch_time=0.35970 
Train Epoch: 14 [701/1000 22432/32000 (70%)] Loss: 0.39650 (QuantReg: 12.22817) QuantErr: 12.22817 batch_time=0.34672 
Train Epoch: 14 [706/1000 22592/32000 (71%)] Loss: 0.67093 (QuantReg: 12.28399) QuantErr: 12.28399 batch_time=0.36443 
Train Epoch: 14 [711/1000 22752/32000 (71%)] Loss: 0.72588 (QuantReg: 11.65583) QuantErr: 11.65583 batch_time=0.35434 
Train Epoch: 14 [716/1000 22912/32000 (72%)] Loss: 0.84235 (QuantReg: 11.38564) QuantErr: 11.38564 batch_time=0.56994 
Train Epoch: 14 [721/1000 23072/32000 (72%)] Loss: 0.76335 (QuantReg: 12.84328) QuantErr: 12.84328 batch_time=0.59549 
Train Epoch: 14 [726/1000 23232/32000 (73%)] Loss: 0.47692 (QuantReg: 11.96961) QuantErr: 11.96961 batch_time=0.58246 
Train Epoch: 14 [731/1000 23392/32000 (73%)] Loss: 0.48368 (QuantReg: 12.31529) QuantErr: 12.31529 batch_time=0.43242 
Train Epoch: 14 [736/1000 23552/32000 (74%)] Loss: 0.74530 (QuantReg: 12.98933) QuantErr: 12.98933 batch_time=0.38128 
Train Epoch: 14 [741/1000 23712/32000 (74%)] Loss: 0.74015 (QuantReg: 12.41660) QuantErr: 12.41660 batch_time=0.34286 
Train Epoch: 14 [746/1000 23872/32000 (75%)] Loss: 0.52567 (QuantReg: 12.94988) QuantErr: 12.94988 batch_time=0.37758 
Train Epoch: 14 [751/1000 24032/32000 (75%)] Loss: 0.35210 (QuantReg: 12.69697) QuantErr: 12.69697 batch_time=0.46489 
Train Epoch: 14 [756/1000 24192/32000 (76%)] Loss: 0.54127 (QuantReg: 12.76127) QuantErr: 12.76127 batch_time=0.39998 
Train Epoch: 14 [761/1000 24352/32000 (76%)] Loss: 0.25200 (QuantReg: 12.89833) QuantErr: 12.89833 batch_time=0.49930 
Train Epoch: 14 [766/1000 24512/32000 (77%)] Loss: 0.98764 (QuantReg: 12.57137) QuantErr: 12.57137 batch_time=0.35447 
Train Epoch: 14 [771/1000 24672/32000 (77%)] Loss: 0.54505 (QuantReg: 12.31225) QuantErr: 12.31225 batch_time=0.57829 
Train Epoch: 14 [776/1000 24832/32000 (78%)] Loss: 0.36398 (QuantReg: 12.92818) QuantErr: 12.92818 batch_time=0.34587 
Train Epoch: 14 [781/1000 24992/32000 (78%)] Loss: 0.51827 (QuantReg: 12.85654) QuantErr: 12.85654 batch_time=0.42851 
Train Epoch: 14 [786/1000 25152/32000 (79%)] Loss: 0.38004 (QuantReg: 12.89643) QuantErr: 12.89643 batch_time=0.36046 
Train Epoch: 14 [791/1000 25312/32000 (79%)] Loss: 1.39224 (QuantReg: 11.96655) QuantErr: 11.96655 batch_time=0.46200 
Train Epoch: 14 [796/1000 25472/32000 (80%)] Loss: 0.45720 (QuantReg: 12.04676) QuantErr: 12.04676 batch_time=0.37337 
Train Epoch: 14 [801/1000 25632/32000 (80%)] Loss: 0.21014 (QuantReg: 12.28786) QuantErr: 12.28786 batch_time=0.74581 
Train Epoch: 14 [806/1000 25792/32000 (81%)] Loss: 1.13088 (QuantReg: 12.58840) QuantErr: 12.58840 batch_time=0.36271 
Train Epoch: 14 [811/1000 25952/32000 (81%)] Loss: 0.52875 (QuantReg: 13.10498) QuantErr: 13.10498 batch_time=0.60803 
Train Epoch: 14 [816/1000 26112/32000 (82%)] Loss: 0.52811 (QuantReg: 12.29947) QuantErr: 12.29947 batch_time=0.51288 
Train Epoch: 14 [821/1000 26272/32000 (82%)] Loss: 1.04083 (QuantReg: 12.93279) QuantErr: 12.93279 batch_time=0.37908 
Train Epoch: 14 [826/1000 26432/32000 (83%)] Loss: 0.59159 (QuantReg: 12.55934) QuantErr: 12.55934 batch_time=0.50062 
Train Epoch: 14 [831/1000 26592/32000 (83%)] Loss: 0.18968 (QuantReg: 12.64445) QuantErr: 12.64445 batch_time=0.42661 
Train Epoch: 14 [836/1000 26752/32000 (84%)] Loss: 0.71638 (QuantReg: 12.37306) QuantErr: 12.37306 batch_time=0.42349 
Train Epoch: 14 [841/1000 26912/32000 (84%)] Loss: 0.64992 (QuantReg: 12.58850) QuantErr: 12.58850 batch_time=0.42610 
Train Epoch: 14 [846/1000 27072/32000 (85%)] Loss: 0.89888 (QuantReg: 12.66192) QuantErr: 12.66192 batch_time=0.61795 
Train Epoch: 14 [851/1000 27232/32000 (85%)] Loss: 0.32326 (QuantReg: 12.27284) QuantErr: 12.27284 batch_time=0.35414 
Train Epoch: 14 [856/1000 27392/32000 (86%)] Loss: 0.59830 (QuantReg: 12.76955) QuantErr: 12.76955 batch_time=0.70212 
Train Epoch: 14 [861/1000 27552/32000 (86%)] Loss: 0.97557 (QuantReg: 12.41539) QuantErr: 12.41539 batch_time=0.40490 
Train Epoch: 14 [866/1000 27712/32000 (87%)] Loss: 0.39781 (QuantReg: 11.98189) QuantErr: 11.98189 batch_time=0.40932 
Train Epoch: 14 [871/1000 27872/32000 (87%)] Loss: 0.70073 (QuantReg: 13.22355) QuantErr: 13.22355 batch_time=0.37366 
Train Epoch: 14 [876/1000 28032/32000 (88%)] Loss: 0.34952 (QuantReg: 12.33624) QuantErr: 12.33624 batch_time=0.37500 
Train Epoch: 14 [881/1000 28192/32000 (88%)] Loss: 0.54957 (QuantReg: 11.89928) QuantErr: 11.89928 batch_time=0.36311 
Train Epoch: 14 [886/1000 28352/32000 (89%)] Loss: 0.73008 (QuantReg: 12.93890) QuantErr: 12.93890 batch_time=0.42116 
Train Epoch: 14 [891/1000 28512/32000 (89%)] Loss: 0.34162 (QuantReg: 12.84059) QuantErr: 12.84059 batch_time=0.40337 
Train Epoch: 14 [896/1000 28672/32000 (90%)] Loss: 0.44120 (QuantReg: 12.57701) QuantErr: 12.57701 batch_time=0.34728 
Train Epoch: 14 [901/1000 28832/32000 (90%)] Loss: 0.35338 (QuantReg: 12.01348) QuantErr: 12.01348 batch_time=0.85572 
Train Epoch: 14 [906/1000 28992/32000 (91%)] Loss: 0.32049 (QuantReg: 12.54515) QuantErr: 12.54515 batch_time=0.36207 
Train Epoch: 14 [911/1000 29152/32000 (91%)] Loss: 0.35533 (QuantReg: 12.72121) QuantErr: 12.72121 batch_time=0.44517 
Train Epoch: 14 [916/1000 29312/32000 (92%)] Loss: 0.32565 (QuantReg: 12.47911) QuantErr: 12.47911 batch_time=0.52310 
Train Epoch: 14 [921/1000 29472/32000 (92%)] Loss: 0.75305 (QuantReg: 12.65073) QuantErr: 12.65073 batch_time=0.38256 
Train Epoch: 14 [926/1000 29632/32000 (93%)] Loss: 0.59902 (QuantReg: 12.34952) QuantErr: 12.34952 batch_time=0.44565 
Train Epoch: 14 [931/1000 29792/32000 (93%)] Loss: 0.62688 (QuantReg: 12.82326) QuantErr: 12.82326 batch_time=0.42124 
Train Epoch: 14 [936/1000 29952/32000 (94%)] Loss: 0.39043 (QuantReg: 12.38604) QuantErr: 12.38604 batch_time=0.56097 
Train Epoch: 14 [941/1000 30112/32000 (94%)] Loss: 0.38680 (QuantReg: 12.95448) QuantErr: 12.95448 batch_time=0.41963 
Train Epoch: 14 [946/1000 30272/32000 (95%)] Loss: 0.41085 (QuantReg: 11.58222) QuantErr: 11.58222 batch_time=0.37989 
Train Epoch: 14 [951/1000 30432/32000 (95%)] Loss: 0.50402 (QuantReg: 12.11867) QuantErr: 12.11867 batch_time=0.51633 
Train Epoch: 14 [956/1000 30592/32000 (96%)] Loss: 0.43186 (QuantReg: 12.11614) QuantErr: 12.11614 batch_time=0.40140 
Train Epoch: 14 [961/1000 30752/32000 (96%)] Loss: 0.46374 (QuantReg: 11.91036) QuantErr: 11.91036 batch_time=0.43831 
Train Epoch: 14 [966/1000 30912/32000 (97%)] Loss: 0.44864 (QuantReg: 13.13195) QuantErr: 13.13195 batch_time=0.75826 
Train Epoch: 14 [971/1000 31072/32000 (97%)] Loss: 0.50723 (QuantReg: 12.53381) QuantErr: 12.53381 batch_time=0.42366 
Train Epoch: 14 [976/1000 31232/32000 (98%)] Loss: 0.80541 (QuantReg: 12.80462) QuantErr: 12.80462 batch_time=0.50402 
Train Epoch: 14 [981/1000 31392/32000 (98%)] Loss: 0.41300 (QuantReg: 11.85147) QuantErr: 11.85147 batch_time=0.37195 
Train Epoch: 14 [986/1000 31552/32000 (99%)] Loss: 0.38310 (QuantReg: 12.72460) QuantErr: 12.72460 batch_time=0.76467 
Train Epoch: 14 [991/1000 31712/32000 (99%)] Loss: 0.61675 (QuantReg: 12.58387) QuantErr: 12.58387 batch_time=0.42469 
Train Epoch: 14 [996/1000 31872/32000 (100%)] Loss: 0.31495 (QuantReg: 12.38231) QuantErr: 12.38231 batch_time=0.35259 
Train Epoch: 14 codebook_update_time=1.89021
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch14.pth ...
Done in 6.097s
removing stale ckpt [epoch 13] [took 0.03s]
 epoch          : 14
 loss           : 0.6252803963124752
 quant_reg      : 12.30489703464508
 quant_err      : 12.30489703464508
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 14000
 MSRVTT_miech_test/t2v_metrics/R1: 17.5
 MSRVTT_miech_test/t2v_metrics/R5: 45.2
 MSRVTT_miech_test/t2v_metrics/R10: 58.7
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.62
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.942216973789535
 MSRVTT_miech_test/v2t_metrics/R1: 18.0
 MSRVTT_miech_test/v2t_metrics/R5: 45.8
 MSRVTT_miech_test/v2t_metrics/R10: 61.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.3
 MSRVTT_miech_test/v2t_metrics/MedR: 6.5
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.4855
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.991514976648865
 mnt_best       : 37.086115946003076
 not_improved_count: 1
Train Epoch: 15 [1/1000 32/32000 (0%)] Loss: 0.40396 (QuantReg: 11.59358) QuantErr: 11.59358 batch_time=29.62662 
Train Epoch: 15 [6/1000 192/32000 (1%)] Loss: 0.56017 (QuantReg: 11.74100) QuantErr: 11.74100 batch_time=0.34561 
Train Epoch: 15 [11/1000 352/32000 (1%)] Loss: 0.70663 (QuantReg: 12.27988) QuantErr: 12.27988 batch_time=0.74632 
Train Epoch: 15 [16/1000 512/32000 (2%)] Loss: 0.62235 (QuantReg: 11.72345) QuantErr: 11.72345 batch_time=0.80503 
Train Epoch: 15 [21/1000 672/32000 (2%)] Loss: 0.56600 (QuantReg: 12.70219) QuantErr: 12.70219 batch_time=0.47889 
Train Epoch: 15 [26/1000 832/32000 (3%)] Loss: 0.64379 (QuantReg: 11.82956) QuantErr: 11.82956 batch_time=0.36667 
Train Epoch: 15 [31/1000 992/32000 (3%)] Loss: 0.46800 (QuantReg: 11.68607) QuantErr: 11.68607 batch_time=0.39609 
Train Epoch: 15 [36/1000 1152/32000 (4%)] Loss: 0.30368 (QuantReg: 12.67972) QuantErr: 12.67972 batch_time=0.45640 
Train Epoch: 15 [41/1000 1312/32000 (4%)] Loss: 0.94364 (QuantReg: 12.27629) QuantErr: 12.27629 batch_time=0.37780 
Train Epoch: 15 [46/1000 1472/32000 (5%)] Loss: 0.20206 (QuantReg: 12.63871) QuantErr: 12.63871 batch_time=0.42727 
Train Epoch: 15 [51/1000 1632/32000 (5%)] Loss: 0.24032 (QuantReg: 12.17735) QuantErr: 12.17735 batch_time=0.34386 
Train Epoch: 15 [56/1000 1792/32000 (6%)] Loss: 0.52852 (QuantReg: 12.35126) QuantErr: 12.35126 batch_time=0.55270 
Train Epoch: 15 [61/1000 1952/32000 (6%)] Loss: 0.94482 (QuantReg: 12.15751) QuantErr: 12.15751 batch_time=0.49313 
Train Epoch: 15 [66/1000 2112/32000 (7%)] Loss: 0.32677 (QuantReg: 11.74021) QuantErr: 11.74021 batch_time=0.49234 
Train Epoch: 15 [71/1000 2272/32000 (7%)] Loss: 0.46845 (QuantReg: 12.47815) QuantErr: 12.47815 batch_time=0.45196 
Train Epoch: 15 [76/1000 2432/32000 (8%)] Loss: 0.91894 (QuantReg: 12.45927) QuantErr: 12.45927 batch_time=1.76168 
Train Epoch: 15 [81/1000 2592/32000 (8%)] Loss: 0.57439 (QuantReg: 11.84801) QuantErr: 11.84801 batch_time=0.43125 
Train Epoch: 15 [86/1000 2752/32000 (9%)] Loss: 0.48583 (QuantReg: 12.44765) QuantErr: 12.44765 batch_time=0.36488 
Train Epoch: 15 [91/1000 2912/32000 (9%)] Loss: 0.37668 (QuantReg: 13.07126) QuantErr: 13.07126 batch_time=0.42440 
Train Epoch: 15 [96/1000 3072/32000 (10%)] Loss: 0.48099 (QuantReg: 12.53647) QuantErr: 12.53647 batch_time=0.42142 
Train Epoch: 15 [101/1000 3232/32000 (10%)] Loss: 0.61623 (QuantReg: 11.89516) QuantErr: 11.89516 batch_time=1.02563 
Train Epoch: 15 [106/1000 3392/32000 (11%)] Loss: 0.61789 (QuantReg: 12.09756) QuantErr: 12.09756 batch_time=0.36607 
Train Epoch: 15 [111/1000 3552/32000 (11%)] Loss: 0.92355 (QuantReg: 12.31839) QuantErr: 12.31839 batch_time=0.33631 
Train Epoch: 15 [116/1000 3712/32000 (12%)] Loss: 0.30342 (QuantReg: 11.91432) QuantErr: 11.91432 batch_time=0.54853 
Train Epoch: 15 [121/1000 3872/32000 (12%)] Loss: 0.64615 (QuantReg: 12.18131) QuantErr: 12.18131 batch_time=0.59814 
Train Epoch: 15 [126/1000 4032/32000 (13%)] Loss: 0.83892 (QuantReg: 11.61043) QuantErr: 11.61043 batch_time=0.35643 
Train Epoch: 15 [131/1000 4192/32000 (13%)] Loss: 0.48877 (QuantReg: 12.63013) QuantErr: 12.63013 batch_time=0.37810 
Train Epoch: 15 [136/1000 4352/32000 (14%)] Loss: 0.96828 (QuantReg: 12.31537) QuantErr: 12.31537 batch_time=0.43265 
Train Epoch: 15 [141/1000 4512/32000 (14%)] Loss: 0.71285 (QuantReg: 12.38919) QuantErr: 12.38919 batch_time=0.36995 
Train Epoch: 15 [146/1000 4672/32000 (15%)] Loss: 0.50222 (QuantReg: 12.33006) QuantErr: 12.33006 batch_time=0.43585 
Train Epoch: 15 [151/1000 4832/32000 (15%)] Loss: 0.38537 (QuantReg: 12.48289) QuantErr: 12.48289 batch_time=0.60812 
Train Epoch: 15 [156/1000 4992/32000 (16%)] Loss: 0.55714 (QuantReg: 12.29739) QuantErr: 12.29739 batch_time=0.36710 
Train Epoch: 15 [161/1000 5152/32000 (16%)] Loss: 0.35542 (QuantReg: 12.38233) QuantErr: 12.38233 batch_time=0.43432 
Train Epoch: 15 [166/1000 5312/32000 (17%)] Loss: 0.63465 (QuantReg: 12.12566) QuantErr: 12.12566 batch_time=0.36732 
Train Epoch: 15 [171/1000 5472/32000 (17%)] Loss: 0.43076 (QuantReg: 12.73611) QuantErr: 12.73611 batch_time=0.39146 
Train Epoch: 15 [176/1000 5632/32000 (18%)] Loss: 0.50170 (QuantReg: 12.35856) QuantErr: 12.35856 batch_time=0.41295 
Train Epoch: 15 [181/1000 5792/32000 (18%)] Loss: 0.21570 (QuantReg: 11.82195) QuantErr: 11.82195 batch_time=0.38680 
Train Epoch: 15 [186/1000 5952/32000 (19%)] Loss: 0.48263 (QuantReg: 12.44324) QuantErr: 12.44324 batch_time=0.66118 
Train Epoch: 15 [191/1000 6112/32000 (19%)] Loss: 0.59458 (QuantReg: 12.53289) QuantErr: 12.53289 batch_time=0.33352 
Train Epoch: 15 [196/1000 6272/32000 (20%)] Loss: 0.30719 (QuantReg: 12.30919) QuantErr: 12.30919 batch_time=0.70057 
Train Epoch: 15 [201/1000 6432/32000 (20%)] Loss: 0.56408 (QuantReg: 12.83815) QuantErr: 12.83815 batch_time=0.35447 
Train Epoch: 15 [206/1000 6592/32000 (21%)] Loss: 0.58971 (QuantReg: 12.35479) QuantErr: 12.35479 batch_time=0.37035 
Train Epoch: 15 [211/1000 6752/32000 (21%)] Loss: 0.51546 (QuantReg: 12.13046) QuantErr: 12.13046 batch_time=0.35905 
Train Epoch: 15 [216/1000 6912/32000 (22%)] Loss: 0.45762 (QuantReg: 11.96419) QuantErr: 11.96419 batch_time=0.36276 
Train Epoch: 15 [221/1000 7072/32000 (22%)] Loss: 0.39021 (QuantReg: 12.34574) QuantErr: 12.34574 batch_time=0.44020 
Train Epoch: 15 [226/1000 7232/32000 (23%)] Loss: 0.33281 (QuantReg: 12.51223) QuantErr: 12.51223 batch_time=0.46127 
Train Epoch: 15 [231/1000 7392/32000 (23%)] Loss: 0.60348 (QuantReg: 12.70614) QuantErr: 12.70614 batch_time=0.34381 
Train Epoch: 15 [236/1000 7552/32000 (24%)] Loss: 0.52884 (QuantReg: 12.22369) QuantErr: 12.22369 batch_time=0.72649 
Train Epoch: 15 [241/1000 7712/32000 (24%)] Loss: 0.45304 (QuantReg: 12.52425) QuantErr: 12.52425 batch_time=0.41098 
Train Epoch: 15 [246/1000 7872/32000 (25%)] Loss: 0.61424 (QuantReg: 12.61397) QuantErr: 12.61397 batch_time=0.48004 
Train Epoch: 15 [251/1000 8032/32000 (25%)] Loss: 0.86556 (QuantReg: 12.06676) QuantErr: 12.06676 batch_time=0.35322 
Train Epoch: 15 [256/1000 8192/32000 (26%)] Loss: 0.64004 (QuantReg: 12.10894) QuantErr: 12.10894 batch_time=0.49059 
Train Epoch: 15 [261/1000 8352/32000 (26%)] Loss: 0.54662 (QuantReg: 12.61825) QuantErr: 12.61825 batch_time=0.36154 
Train Epoch: 15 [266/1000 8512/32000 (27%)] Loss: 0.64759 (QuantReg: 12.69585) QuantErr: 12.69585 batch_time=0.41977 
Train Epoch: 15 [271/1000 8672/32000 (27%)] Loss: 0.62108 (QuantReg: 12.16440) QuantErr: 12.16440 batch_time=0.41316 
Train Epoch: 15 [276/1000 8832/32000 (28%)] Loss: 0.34404 (QuantReg: 12.76317) QuantErr: 12.76317 batch_time=0.38403 
Train Epoch: 15 [281/1000 8992/32000 (28%)] Loss: 0.37833 (QuantReg: 12.13297) QuantErr: 12.13297 batch_time=0.87036 
Train Epoch: 15 [286/1000 9152/32000 (29%)] Loss: 0.43646 (QuantReg: 12.93619) QuantErr: 12.93619 batch_time=0.35427 
Train Epoch: 15 [291/1000 9312/32000 (29%)] Loss: 0.89158 (QuantReg: 12.06003) QuantErr: 12.06003 batch_time=0.45307 
Train Epoch: 15 [296/1000 9472/32000 (30%)] Loss: 0.50859 (QuantReg: 12.52746) QuantErr: 12.52746 batch_time=0.43370 
Train Epoch: 15 [301/1000 9632/32000 (30%)] Loss: 0.35553 (QuantReg: 12.37668) QuantErr: 12.37668 batch_time=0.50553 
Train Epoch: 15 [306/1000 9792/32000 (31%)] Loss: 0.59856 (QuantReg: 12.06122) QuantErr: 12.06122 batch_time=0.36397 
Train Epoch: 15 [311/1000 9952/32000 (31%)] Loss: 0.55598 (QuantReg: 12.37019) QuantErr: 12.37019 batch_time=0.36558 
Train Epoch: 15 [316/1000 10112/32000 (32%)] Loss: 0.55629 (QuantReg: 12.27637) QuantErr: 12.27637 batch_time=0.39029 
Train Epoch: 15 [321/1000 10272/32000 (32%)] Loss: 1.32499 (QuantReg: 12.43536) QuantErr: 12.43536 batch_time=0.37781 
Train Epoch: 15 [326/1000 10432/32000 (33%)] Loss: 0.50687 (QuantReg: 11.82062) QuantErr: 11.82062 batch_time=0.43369 
Train Epoch: 15 [331/1000 10592/32000 (33%)] Loss: 0.84488 (QuantReg: 12.11767) QuantErr: 12.11767 batch_time=0.45668 
Train Epoch: 15 [336/1000 10752/32000 (34%)] Loss: 0.63129 (QuantReg: 12.57819) QuantErr: 12.57819 batch_time=0.39556 
Train Epoch: 15 [341/1000 10912/32000 (34%)] Loss: 0.70727 (QuantReg: 12.46801) QuantErr: 12.46801 batch_time=0.42895 
Train Epoch: 15 [346/1000 11072/32000 (35%)] Loss: 0.58178 (QuantReg: 12.33695) QuantErr: 12.33695 batch_time=1.53255 
Train Epoch: 15 [351/1000 11232/32000 (35%)] Loss: 0.57673 (QuantReg: 12.40794) QuantErr: 12.40794 batch_time=0.35498 
Train Epoch: 15 [356/1000 11392/32000 (36%)] Loss: 0.46421 (QuantReg: 12.95823) QuantErr: 12.95823 batch_time=0.35853 
Train Epoch: 15 [361/1000 11552/32000 (36%)] Loss: 0.65913 (QuantReg: 12.28269) QuantErr: 12.28269 batch_time=0.37094 
Train Epoch: 15 [366/1000 11712/32000 (37%)] Loss: 0.45979 (QuantReg: 12.13502) QuantErr: 12.13502 batch_time=0.36548 
Train Epoch: 15 [371/1000 11872/32000 (37%)] Loss: 0.58675 (QuantReg: 13.03533) QuantErr: 13.03533 batch_time=0.42122 
Train Epoch: 15 [376/1000 12032/32000 (38%)] Loss: 0.53623 (QuantReg: 12.21655) QuantErr: 12.21655 batch_time=0.41083 
Train Epoch: 15 [381/1000 12192/32000 (38%)] Loss: 1.40661 (QuantReg: 12.41141) QuantErr: 12.41141 batch_time=0.42803 
Train Epoch: 15 [386/1000 12352/32000 (39%)] Loss: 0.68205 (QuantReg: 12.33089) QuantErr: 12.33089 batch_time=0.44634 
Train Epoch: 15 [391/1000 12512/32000 (39%)] Loss: 0.53332 (QuantReg: 12.71730) QuantErr: 12.71730 batch_time=0.37353 
Train Epoch: 15 [396/1000 12672/32000 (40%)] Loss: 1.21702 (QuantReg: 11.45880) QuantErr: 11.45880 batch_time=1.03214 
Train Epoch: 15 [401/1000 12832/32000 (40%)] Loss: 0.12149 (QuantReg: 12.68375) QuantErr: 12.68375 batch_time=0.41017 
Train Epoch: 15 [406/1000 12992/32000 (41%)] Loss: 0.36960 (QuantReg: 12.53611) QuantErr: 12.53611 batch_time=0.36456 
Train Epoch: 15 [411/1000 13152/32000 (41%)] Loss: 0.85928 (QuantReg: 11.85836) QuantErr: 11.85836 batch_time=0.36166 
Train Epoch: 15 [416/1000 13312/32000 (42%)] Loss: 0.44025 (QuantReg: 12.97881) QuantErr: 12.97881 batch_time=0.68203 
Train Epoch: 15 [421/1000 13472/32000 (42%)] Loss: 0.23205 (QuantReg: 12.58823) QuantErr: 12.58823 batch_time=0.36613 
Train Epoch: 15 [426/1000 13632/32000 (43%)] Loss: 0.72157 (QuantReg: 12.04408) QuantErr: 12.04408 batch_time=0.35617 
Train Epoch: 15 [431/1000 13792/32000 (43%)] Loss: 0.62316 (QuantReg: 12.69290) QuantErr: 12.69290 batch_time=0.77656 
Train Epoch: 15 [436/1000 13952/32000 (44%)] Loss: 0.46070 (QuantReg: 12.60076) QuantErr: 12.60076 batch_time=0.33928 
Train Epoch: 15 [441/1000 14112/32000 (44%)] Loss: 0.59306 (QuantReg: 12.32195) QuantErr: 12.32195 batch_time=0.35013 
Train Epoch: 15 [446/1000 14272/32000 (45%)] Loss: 0.82293 (QuantReg: 13.09144) QuantErr: 13.09144 batch_time=0.35388 
Train Epoch: 15 [451/1000 14432/32000 (45%)] Loss: 0.32288 (QuantReg: 12.41260) QuantErr: 12.41260 batch_time=0.37302 
Train Epoch: 15 [456/1000 14592/32000 (46%)] Loss: 0.51300 (QuantReg: 11.53716) QuantErr: 11.53716 batch_time=0.36054 
Train Epoch: 15 [461/1000 14752/32000 (46%)] Loss: 0.71718 (QuantReg: 12.74853) QuantErr: 12.74853 batch_time=0.36148 
Train Epoch: 15 [466/1000 14912/32000 (47%)] Loss: 0.60217 (QuantReg: 12.12929) QuantErr: 12.12929 batch_time=0.60999 
Train Epoch: 15 [471/1000 15072/32000 (47%)] Loss: 0.80588 (QuantReg: 12.15069) QuantErr: 12.15069 batch_time=1.45091 
Train Epoch: 15 [476/1000 15232/32000 (48%)] Loss: 0.81357 (QuantReg: 11.56809) QuantErr: 11.56809 batch_time=0.40734 
Train Epoch: 15 [481/1000 15392/32000 (48%)] Loss: 0.54598 (QuantReg: 12.72795) QuantErr: 12.72795 batch_time=0.51893 
Train Epoch: 15 [486/1000 15552/32000 (49%)] Loss: 0.60272 (QuantReg: 12.27341) QuantErr: 12.27341 batch_time=0.37460 
Train Epoch: 15 [491/1000 15712/32000 (49%)] Loss: 0.29651 (QuantReg: 12.64147) QuantErr: 12.64147 batch_time=0.36208 
Train Epoch: 15 [496/1000 15872/32000 (50%)] Loss: 0.46658 (QuantReg: 12.10059) QuantErr: 12.10059 batch_time=0.41139 
Train Epoch: 15 [501/1000 16032/32000 (50%)] Loss: 0.48611 (QuantReg: 12.41760) QuantErr: 12.41760 batch_time=0.36613 
Train Epoch: 15 [506/1000 16192/32000 (51%)] Loss: 0.77860 (QuantReg: 12.43082) QuantErr: 12.43082 batch_time=0.70410 
Train Epoch: 15 [511/1000 16352/32000 (51%)] Loss: 0.42260 (QuantReg: 12.29823) QuantErr: 12.29823 batch_time=0.37475 
Train Epoch: 15 [516/1000 16512/32000 (52%)] Loss: 0.72813 (QuantReg: 12.45600) QuantErr: 12.45600 batch_time=0.41835 
Train Epoch: 15 [521/1000 16672/32000 (52%)] Loss: 0.80602 (QuantReg: 12.00406) QuantErr: 12.00406 batch_time=0.39745 
Train Epoch: 15 [526/1000 16832/32000 (53%)] Loss: 1.01599 (QuantReg: 12.84183) QuantErr: 12.84183 batch_time=0.41370 
Train Epoch: 15 [531/1000 16992/32000 (53%)] Loss: 0.42465 (QuantReg: 12.63333) QuantErr: 12.63333 batch_time=0.35347 
Train Epoch: 15 [536/1000 17152/32000 (54%)] Loss: 0.72834 (QuantReg: 11.70264) QuantErr: 11.70264 batch_time=0.35666 
Train Epoch: 15 [541/1000 17312/32000 (54%)] Loss: 0.44486 (QuantReg: 11.89032) QuantErr: 11.89032 batch_time=0.37767 
Train Epoch: 15 [546/1000 17472/32000 (55%)] Loss: 0.56164 (QuantReg: 12.45117) QuantErr: 12.45117 batch_time=0.34856 
Train Epoch: 15 [551/1000 17632/32000 (55%)] Loss: 0.97389 (QuantReg: 12.36451) QuantErr: 12.36451 batch_time=0.36971 
Train Epoch: 15 [556/1000 17792/32000 (56%)] Loss: 0.25772 (QuantReg: 12.32402) QuantErr: 12.32402 batch_time=0.70293 
Train Epoch: 15 [561/1000 17952/32000 (56%)] Loss: 0.50229 (QuantReg: 12.45059) QuantErr: 12.45059 batch_time=0.37038 
Train Epoch: 15 [566/1000 18112/32000 (57%)] Loss: 0.54539 (QuantReg: 11.96525) QuantErr: 11.96525 batch_time=0.39779 
Train Epoch: 15 [571/1000 18272/32000 (57%)] Loss: 0.60705 (QuantReg: 12.38307) QuantErr: 12.38307 batch_time=0.40304 
Train Epoch: 15 [576/1000 18432/32000 (58%)] Loss: 0.49804 (QuantReg: 12.26302) QuantErr: 12.26302 batch_time=0.35631 
Train Epoch: 15 [581/1000 18592/32000 (58%)] Loss: 0.20075 (QuantReg: 12.64722) QuantErr: 12.64722 batch_time=0.46834 
Train Epoch: 15 [586/1000 18752/32000 (59%)] Loss: 0.47110 (QuantReg: 12.88982) QuantErr: 12.88982 batch_time=0.36630 
Train Epoch: 15 [591/1000 18912/32000 (59%)] Loss: 0.50913 (QuantReg: 12.76034) QuantErr: 12.76034 batch_time=0.36433 
Train Epoch: 15 [596/1000 19072/32000 (60%)] Loss: 0.64485 (QuantReg: 12.48608) QuantErr: 12.48608 batch_time=0.38447 
Train Epoch: 15 [601/1000 19232/32000 (60%)] Loss: 0.44271 (QuantReg: 12.54778) QuantErr: 12.54778 batch_time=0.34554 
Train Epoch: 15 [606/1000 19392/32000 (61%)] Loss: 0.68002 (QuantReg: 12.09975) QuantErr: 12.09975 batch_time=0.72924 
Train Epoch: 15 [611/1000 19552/32000 (61%)] Loss: 0.67646 (QuantReg: 13.22320) QuantErr: 13.22320 batch_time=0.35664 
Train Epoch: 15 [616/1000 19712/32000 (62%)] Loss: 0.34710 (QuantReg: 12.03484) QuantErr: 12.03484 batch_time=0.38432 
Train Epoch: 15 [621/1000 19872/32000 (62%)] Loss: 0.69620 (QuantReg: 11.85234) QuantErr: 11.85234 batch_time=0.35579 
Train Epoch: 15 [626/1000 20032/32000 (63%)] Loss: 0.38094 (QuantReg: 11.98888) QuantErr: 11.98888 batch_time=0.35836 
Train Epoch: 15 [631/1000 20192/32000 (63%)] Loss: 0.25101 (QuantReg: 12.40630) QuantErr: 12.40630 batch_time=0.44304 
Train Epoch: 15 [636/1000 20352/32000 (64%)] Loss: 0.82020 (QuantReg: 11.89598) QuantErr: 11.89598 batch_time=0.44751 
Train Epoch: 15 [641/1000 20512/32000 (64%)] Loss: 0.92238 (QuantReg: 12.03558) QuantErr: 12.03558 batch_time=0.37241 
Train Epoch: 15 [646/1000 20672/32000 (65%)] Loss: 0.29138 (QuantReg: 12.53088) QuantErr: 12.53088 batch_time=0.34818 
Train Epoch: 15 [651/1000 20832/32000 (65%)] Loss: 0.64141 (QuantReg: 12.49398) QuantErr: 12.49398 batch_time=0.62755 
Train Epoch: 15 [656/1000 20992/32000 (66%)] Loss: 0.47457 (QuantReg: 12.35154) QuantErr: 12.35154 batch_time=0.60115 
Train Epoch: 15 [661/1000 21152/32000 (66%)] Loss: 0.62525 (QuantReg: 12.18844) QuantErr: 12.18844 batch_time=0.37276 
Train Epoch: 15 [666/1000 21312/32000 (67%)] Loss: 0.35594 (QuantReg: 12.74093) QuantErr: 12.74093 batch_time=0.82646 
Train Epoch: 15 [671/1000 21472/32000 (67%)] Loss: 0.52973 (QuantReg: 11.81961) QuantErr: 11.81961 batch_time=0.41870 
Train Epoch: 15 [676/1000 21632/32000 (68%)] Loss: 0.30528 (QuantReg: 12.18144) QuantErr: 12.18144 batch_time=0.39809 
Train Epoch: 15 [681/1000 21792/32000 (68%)] Loss: 0.91221 (QuantReg: 12.10558) QuantErr: 12.10558 batch_time=0.36042 
Train Epoch: 15 [686/1000 21952/32000 (69%)] Loss: 0.43545 (QuantReg: 12.71024) QuantErr: 12.71024 batch_time=0.62988 
Train Epoch: 15 [691/1000 22112/32000 (69%)] Loss: 0.42792 (QuantReg: 12.49193) QuantErr: 12.49193 batch_time=0.33640 
Train Epoch: 15 [696/1000 22272/32000 (70%)] Loss: 0.50056 (QuantReg: 12.93406) QuantErr: 12.93406 batch_time=0.72904 
Train Epoch: 15 [701/1000 22432/32000 (70%)] Loss: 0.64431 (QuantReg: 11.52010) QuantErr: 11.52010 batch_time=0.34418 
Train Epoch: 15 [706/1000 22592/32000 (71%)] Loss: 0.61467 (QuantReg: 12.99608) QuantErr: 12.99608 batch_time=0.54223 
Train Epoch: 15 [711/1000 22752/32000 (71%)] Loss: 0.33665 (QuantReg: 11.99463) QuantErr: 11.99463 batch_time=0.52790 
Train Epoch: 15 [716/1000 22912/32000 (72%)] Loss: 0.40249 (QuantReg: 12.13824) QuantErr: 12.13824 batch_time=0.56837 
Train Epoch: 15 [721/1000 23072/32000 (72%)] Loss: 0.38163 (QuantReg: 13.03764) QuantErr: 13.03764 batch_time=0.67538 
Train Epoch: 15 [726/1000 23232/32000 (73%)] Loss: 0.95561 (QuantReg: 12.64049) QuantErr: 12.64049 batch_time=0.38445 
Train Epoch: 15 [731/1000 23392/32000 (73%)] Loss: 0.78534 (QuantReg: 12.50928) QuantErr: 12.50928 batch_time=0.61826 
Train Epoch: 15 [736/1000 23552/32000 (74%)] Loss: 0.45912 (QuantReg: 13.02488) QuantErr: 13.02488 batch_time=0.36431 
Train Epoch: 15 [741/1000 23712/32000 (74%)] Loss: 0.08329 (QuantReg: 12.20924) QuantErr: 12.20924 batch_time=0.61968 
Train Epoch: 15 [746/1000 23872/32000 (75%)] Loss: 0.45148 (QuantReg: 12.33131) QuantErr: 12.33131 batch_time=0.37904 
Train Epoch: 15 [751/1000 24032/32000 (75%)] Loss: 0.93237 (QuantReg: 12.11129) QuantErr: 12.11129 batch_time=0.38715 
Train Epoch: 15 [756/1000 24192/32000 (76%)] Loss: 0.82139 (QuantReg: 12.23830) QuantErr: 12.23830 batch_time=0.51227 
Train Epoch: 15 [761/1000 24352/32000 (76%)] Loss: 0.55946 (QuantReg: 11.73071) QuantErr: 11.73071 batch_time=0.37006 
Train Epoch: 15 [766/1000 24512/32000 (77%)] Loss: 0.35494 (QuantReg: 12.36078) QuantErr: 12.36078 batch_time=0.42261 
Train Epoch: 15 [771/1000 24672/32000 (77%)] Loss: 0.79830 (QuantReg: 12.39379) QuantErr: 12.39379 batch_time=0.44596 
Train Epoch: 15 [776/1000 24832/32000 (78%)] Loss: 0.71215 (QuantReg: 12.29883) QuantErr: 12.29883 batch_time=0.36152 
Train Epoch: 15 [781/1000 24992/32000 (78%)] Loss: 0.34825 (QuantReg: 12.20602) QuantErr: 12.20602 batch_time=0.45985 
Train Epoch: 15 [786/1000 25152/32000 (79%)] Loss: 0.61907 (QuantReg: 12.65937) QuantErr: 12.65937 batch_time=0.49832 
Train Epoch: 15 [791/1000 25312/32000 (79%)] Loss: 0.59191 (QuantReg: 12.43135) QuantErr: 12.43135 batch_time=0.42664 
Train Epoch: 15 [796/1000 25472/32000 (80%)] Loss: 0.46795 (QuantReg: 12.50382) QuantErr: 12.50382 batch_time=0.45892 
Train Epoch: 15 [801/1000 25632/32000 (80%)] Loss: 0.43175 (QuantReg: 12.87412) QuantErr: 12.87412 batch_time=0.34662 
Train Epoch: 15 [806/1000 25792/32000 (81%)] Loss: 0.35094 (QuantReg: 12.30241) QuantErr: 12.30241 batch_time=0.44910 
Train Epoch: 15 [811/1000 25952/32000 (81%)] Loss: 0.49806 (QuantReg: 11.86171) QuantErr: 11.86171 batch_time=0.36587 
Train Epoch: 15 [816/1000 26112/32000 (82%)] Loss: 0.42632 (QuantReg: 12.11364) QuantErr: 12.11364 batch_time=0.39976 
Train Epoch: 15 [821/1000 26272/32000 (82%)] Loss: 0.48047 (QuantReg: 12.43011) QuantErr: 12.43011 batch_time=0.43149 
Train Epoch: 15 [826/1000 26432/32000 (83%)] Loss: 0.41956 (QuantReg: 11.96529) QuantErr: 11.96529 batch_time=0.55647 
Train Epoch: 15 [831/1000 26592/32000 (83%)] Loss: 0.52746 (QuantReg: 13.07780) QuantErr: 13.07780 batch_time=0.48923 
Train Epoch: 15 [836/1000 26752/32000 (84%)] Loss: 0.26044 (QuantReg: 12.38177) QuantErr: 12.38177 batch_time=1.17494 
Train Epoch: 15 [841/1000 26912/32000 (84%)] Loss: 0.56430 (QuantReg: 12.51048) QuantErr: 12.51048 batch_time=0.45503 
Train Epoch: 15 [846/1000 27072/32000 (85%)] Loss: 0.27607 (QuantReg: 12.52616) QuantErr: 12.52616 batch_time=0.45781 
Train Epoch: 15 [851/1000 27232/32000 (85%)] Loss: 0.71057 (QuantReg: 12.32302) QuantErr: 12.32302 batch_time=0.36009 
Train Epoch: 15 [856/1000 27392/32000 (86%)] Loss: 0.40767 (QuantReg: 12.34453) QuantErr: 12.34453 batch_time=0.37333 
Train Epoch: 15 [861/1000 27552/32000 (86%)] Loss: 0.23445 (QuantReg: 12.59822) QuantErr: 12.59822 batch_time=0.42248 
Train Epoch: 15 [866/1000 27712/32000 (87%)] Loss: 0.74854 (QuantReg: 12.80920) QuantErr: 12.80920 batch_time=0.35242 
Train Epoch: 15 [871/1000 27872/32000 (87%)] Loss: 0.70708 (QuantReg: 12.42325) QuantErr: 12.42325 batch_time=0.75571 
Train Epoch: 15 [876/1000 28032/32000 (88%)] Loss: 0.67452 (QuantReg: 12.84151) QuantErr: 12.84151 batch_time=0.35287 
Train Epoch: 15 [881/1000 28192/32000 (88%)] Loss: 0.65821 (QuantReg: 12.77249) QuantErr: 12.77249 batch_time=0.38215 
Train Epoch: 15 [886/1000 28352/32000 (89%)] Loss: 1.07105 (QuantReg: 13.03866) QuantErr: 13.03866 batch_time=0.39336 
Train Epoch: 15 [891/1000 28512/32000 (89%)] Loss: 0.53883 (QuantReg: 12.32076) QuantErr: 12.32076 batch_time=0.44182 
Train Epoch: 15 [896/1000 28672/32000 (90%)] Loss: 0.40305 (QuantReg: 11.99512) QuantErr: 11.99512 batch_time=0.34996 
Train Epoch: 15 [901/1000 28832/32000 (90%)] Loss: 0.81207 (QuantReg: 12.30010) QuantErr: 12.30010 batch_time=0.36533 
Train Epoch: 15 [906/1000 28992/32000 (91%)] Loss: 1.07710 (QuantReg: 12.41878) QuantErr: 12.41878 batch_time=0.63975 
Train Epoch: 15 [911/1000 29152/32000 (91%)] Loss: 0.63230 (QuantReg: 12.78561) QuantErr: 12.78561 batch_time=0.34749 
Train Epoch: 15 [916/1000 29312/32000 (92%)] Loss: 0.26296 (QuantReg: 12.38903) QuantErr: 12.38903 batch_time=0.78368 
Train Epoch: 15 [921/1000 29472/32000 (92%)] Loss: 0.98357 (QuantReg: 11.48366) QuantErr: 11.48366 batch_time=0.47945 
Train Epoch: 15 [926/1000 29632/32000 (93%)] Loss: 0.79948 (QuantReg: 12.38688) QuantErr: 12.38688 batch_time=0.42802 
Train Epoch: 15 [931/1000 29792/32000 (93%)] Loss: 0.59225 (QuantReg: 11.01003) QuantErr: 11.01003 batch_time=0.34670 
Train Epoch: 15 [936/1000 29952/32000 (94%)] Loss: 0.76157 (QuantReg: 12.20805) QuantErr: 12.20805 batch_time=0.35517 
Train Epoch: 15 [941/1000 30112/32000 (94%)] Loss: 0.52409 (QuantReg: 12.72444) QuantErr: 12.72444 batch_time=0.35756 
Train Epoch: 15 [946/1000 30272/32000 (95%)] Loss: 0.41586 (QuantReg: 13.11424) QuantErr: 13.11424 batch_time=0.37651 
Train Epoch: 15 [951/1000 30432/32000 (95%)] Loss: 0.63756 (QuantReg: 12.48741) QuantErr: 12.48741 batch_time=0.72152 
Train Epoch: 15 [956/1000 30592/32000 (96%)] Loss: 0.57118 (QuantReg: 13.14612) QuantErr: 13.14612 batch_time=0.37242 
Train Epoch: 15 [961/1000 30752/32000 (96%)] Loss: 0.31462 (QuantReg: 12.45215) QuantErr: 12.45215 batch_time=0.75171 
Train Epoch: 15 [966/1000 30912/32000 (97%)] Loss: 0.45505 (QuantReg: 12.76256) QuantErr: 12.76256 batch_time=0.36514 
Train Epoch: 15 [971/1000 31072/32000 (97%)] Loss: 0.72221 (QuantReg: 12.64838) QuantErr: 12.64838 batch_time=0.39582 
Train Epoch: 15 [976/1000 31232/32000 (98%)] Loss: 0.45622 (QuantReg: 12.79629) QuantErr: 12.79629 batch_time=0.34611 
Train Epoch: 15 [981/1000 31392/32000 (98%)] Loss: 0.88586 (QuantReg: 13.21140) QuantErr: 13.21140 batch_time=0.35233 
Train Epoch: 15 [986/1000 31552/32000 (99%)] Loss: 0.30302 (QuantReg: 12.24869) QuantErr: 12.24869 batch_time=0.82807 
Train Epoch: 15 [991/1000 31712/32000 (99%)] Loss: 0.62841 (QuantReg: 11.88661) QuantErr: 11.88661 batch_time=0.36825 
Train Epoch: 15 [996/1000 31872/32000 (100%)] Loss: 0.26750 (QuantReg: 12.29169) QuantErr: 12.29169 batch_time=0.41209 
Train Epoch: 15 codebook_update_time=2.75508
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch15.pth ...
Done in 5.689s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch15.pth ...
Done in 12.287s
removing stale ckpt [epoch 14] [took 0.02s]
 epoch          : 15
 loss           : 0.5833102927356958
 quant_reg      : 12.361359029769897
 quant_err      : 12.361359029769897
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 15000
 MSRVTT_miech_test/t2v_metrics/R1: 18.0
 MSRVTT_miech_test/t2v_metrics/R5: 46.4
 MSRVTT_miech_test/t2v_metrics/R10: 61.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.55
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.132169142307625
 MSRVTT_miech_test/v2t_metrics/R1: 17.4
 MSRVTT_miech_test/v2t_metrics/R5: 48.6
 MSRVTT_miech_test/v2t_metrics/R10: 63.1
 MSRVTT_miech_test/v2t_metrics/R50: 87.7
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.032
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.64768640249008
 mnt_best       : 37.132169142307625
 not_improved_count: 0
Train Epoch: 16 [1/1000 32/32000 (0%)] Loss: 0.53291 (QuantReg: 12.05642) QuantErr: 12.05642 batch_time=29.88665 
Train Epoch: 16 [6/1000 192/32000 (1%)] Loss: 0.61869 (QuantReg: 11.34923) QuantErr: 11.34923 batch_time=0.40914 
Train Epoch: 16 [11/1000 352/32000 (1%)] Loss: 0.38045 (QuantReg: 12.51033) QuantErr: 12.51033 batch_time=0.57737 
Train Epoch: 16 [16/1000 512/32000 (2%)] Loss: 0.22365 (QuantReg: 12.47470) QuantErr: 12.47470 batch_time=0.75344 
Train Epoch: 16 [21/1000 672/32000 (2%)] Loss: 0.11109 (QuantReg: 11.87475) QuantErr: 11.87475 batch_time=0.66845 
Train Epoch: 16 [26/1000 832/32000 (3%)] Loss: 0.42716 (QuantReg: 11.52351) QuantErr: 11.52351 batch_time=0.38379 
Train Epoch: 16 [31/1000 992/32000 (3%)] Loss: 0.63903 (QuantReg: 12.01766) QuantErr: 12.01766 batch_time=0.42791 
Train Epoch: 16 [36/1000 1152/32000 (4%)] Loss: 0.43209 (QuantReg: 12.44110) QuantErr: 12.44110 batch_time=0.38351 
Train Epoch: 16 [41/1000 1312/32000 (4%)] Loss: 0.40937 (QuantReg: 11.75818) QuantErr: 11.75818 batch_time=0.42307 
Train Epoch: 16 [46/1000 1472/32000 (5%)] Loss: 0.60102 (QuantReg: 11.89567) QuantErr: 11.89567 batch_time=0.49073 
Train Epoch: 16 [51/1000 1632/32000 (5%)] Loss: 0.58394 (QuantReg: 12.25204) QuantErr: 12.25204 batch_time=0.49881 
Train Epoch: 16 [56/1000 1792/32000 (6%)] Loss: 0.97298 (QuantReg: 11.71120) QuantErr: 11.71120 batch_time=0.41221 
Train Epoch: 16 [61/1000 1952/32000 (6%)] Loss: 0.21151 (QuantReg: 12.25050) QuantErr: 12.25050 batch_time=0.37988 
Train Epoch: 16 [66/1000 2112/32000 (7%)] Loss: 1.19096 (QuantReg: 12.47468) QuantErr: 12.47468 batch_time=0.42479 
Train Epoch: 16 [71/1000 2272/32000 (7%)] Loss: 0.61527 (QuantReg: 11.53824) QuantErr: 11.53824 batch_time=0.46051 
Train Epoch: 16 [76/1000 2432/32000 (8%)] Loss: 1.00552 (QuantReg: 12.07452) QuantErr: 12.07452 batch_time=0.36225 
Train Epoch: 16 [81/1000 2592/32000 (8%)] Loss: 0.79987 (QuantReg: 12.08156) QuantErr: 12.08156 batch_time=0.35830 
Train Epoch: 16 [86/1000 2752/32000 (9%)] Loss: 0.57439 (QuantReg: 12.85800) QuantErr: 12.85800 batch_time=1.16275 
Train Epoch: 16 [91/1000 2912/32000 (9%)] Loss: 0.73625 (QuantReg: 12.22853) QuantErr: 12.22853 batch_time=0.37578 
Train Epoch: 16 [96/1000 3072/32000 (10%)] Loss: 0.57910 (QuantReg: 12.42843) QuantErr: 12.42843 batch_time=0.46756 
Train Epoch: 16 [101/1000 3232/32000 (10%)] Loss: 0.43204 (QuantReg: 11.86377) QuantErr: 11.86377 batch_time=0.38933 
Train Epoch: 16 [106/1000 3392/32000 (11%)] Loss: 0.26214 (QuantReg: 12.15822) QuantErr: 12.15822 batch_time=0.35462 
Train Epoch: 16 [111/1000 3552/32000 (11%)] Loss: 0.56306 (QuantReg: 12.35701) QuantErr: 12.35701 batch_time=0.57863 
Train Epoch: 16 [116/1000 3712/32000 (12%)] Loss: 0.48438 (QuantReg: 12.41617) QuantErr: 12.41617 batch_time=0.48724 
Train Epoch: 16 [121/1000 3872/32000 (12%)] Loss: 0.85703 (QuantReg: 12.43900) QuantErr: 12.43900 batch_time=0.60568 
Train Epoch: 16 [126/1000 4032/32000 (13%)] Loss: 0.63003 (QuantReg: 12.00026) QuantErr: 12.00026 batch_time=0.34546 
Train Epoch: 16 [131/1000 4192/32000 (13%)] Loss: 0.20641 (QuantReg: 12.57723) QuantErr: 12.57723 batch_time=1.01329 
Train Epoch: 16 [136/1000 4352/32000 (14%)] Loss: 1.11385 (QuantReg: 12.15823) QuantErr: 12.15823 batch_time=0.41771 
Train Epoch: 16 [141/1000 4512/32000 (14%)] Loss: 0.44227 (QuantReg: 11.92604) QuantErr: 11.92604 batch_time=0.43250 
Train Epoch: 16 [146/1000 4672/32000 (15%)] Loss: 0.55023 (QuantReg: 12.94958) QuantErr: 12.94958 batch_time=0.40591 
Train Epoch: 16 [151/1000 4832/32000 (15%)] Loss: 0.91884 (QuantReg: 11.78521) QuantErr: 11.78521 batch_time=0.38540 
Train Epoch: 16 [156/1000 4992/32000 (16%)] Loss: 0.62257 (QuantReg: 11.96500) QuantErr: 11.96500 batch_time=0.49945 
Train Epoch: 16 [161/1000 5152/32000 (16%)] Loss: 0.41991 (QuantReg: 12.48957) QuantErr: 12.48957 batch_time=0.35973 
Train Epoch: 16 [166/1000 5312/32000 (17%)] Loss: 0.93370 (QuantReg: 12.06517) QuantErr: 12.06517 batch_time=0.89473 
Train Epoch: 16 [171/1000 5472/32000 (17%)] Loss: 0.41055 (QuantReg: 11.42929) QuantErr: 11.42929 batch_time=0.41242 
Train Epoch: 16 [176/1000 5632/32000 (18%)] Loss: 0.17040 (QuantReg: 11.66475) QuantErr: 11.66475 batch_time=0.43902 
Train Epoch: 16 [181/1000 5792/32000 (18%)] Loss: 0.59655 (QuantReg: 12.02313) QuantErr: 12.02313 batch_time=0.38063 
Train Epoch: 16 [186/1000 5952/32000 (19%)] Loss: 0.99728 (QuantReg: 12.96143) QuantErr: 12.96143 batch_time=0.35788 
Train Epoch: 16 [191/1000 6112/32000 (19%)] Loss: 0.34909 (QuantReg: 11.82361) QuantErr: 11.82361 batch_time=0.36910 
Train Epoch: 16 [196/1000 6272/32000 (20%)] Loss: 0.66500 (QuantReg: 12.54564) QuantErr: 12.54564 batch_time=0.42050 
Train Epoch: 16 [201/1000 6432/32000 (20%)] Loss: 0.59023 (QuantReg: 12.59833) QuantErr: 12.59833 batch_time=0.71285 
Train Epoch: 16 [206/1000 6592/32000 (21%)] Loss: 0.98736 (QuantReg: 12.57994) QuantErr: 12.57994 batch_time=0.74315 
Train Epoch: 16 [211/1000 6752/32000 (21%)] Loss: 0.82446 (QuantReg: 12.58277) QuantErr: 12.58277 batch_time=0.45910 
Train Epoch: 16 [216/1000 6912/32000 (22%)] Loss: 0.74875 (QuantReg: 12.08724) QuantErr: 12.08724 batch_time=0.35977 
Train Epoch: 16 [221/1000 7072/32000 (22%)] Loss: 1.14794 (QuantReg: 12.44231) QuantErr: 12.44231 batch_time=0.44444 
Train Epoch: 16 [226/1000 7232/32000 (23%)] Loss: 0.76910 (QuantReg: 12.09845) QuantErr: 12.09845 batch_time=0.36836 
Train Epoch: 16 [231/1000 7392/32000 (23%)] Loss: 0.68858 (QuantReg: 12.79038) QuantErr: 12.79038 batch_time=0.37708 
Train Epoch: 16 [236/1000 7552/32000 (24%)] Loss: 0.79040 (QuantReg: 11.90936) QuantErr: 11.90936 batch_time=0.38751 
Train Epoch: 16 [241/1000 7712/32000 (24%)] Loss: 0.35519 (QuantReg: 12.24347) QuantErr: 12.24347 batch_time=0.38185 
Train Epoch: 16 [246/1000 7872/32000 (25%)] Loss: 0.76835 (QuantReg: 11.50710) QuantErr: 11.50710 batch_time=0.42516 
Train Epoch: 16 [251/1000 8032/32000 (25%)] Loss: 0.64460 (QuantReg: 11.84178) QuantErr: 11.84178 batch_time=0.62075 
Train Epoch: 16 [256/1000 8192/32000 (26%)] Loss: 0.66425 (QuantReg: 12.20043) QuantErr: 12.20043 batch_time=0.36551 
Train Epoch: 16 [261/1000 8352/32000 (26%)] Loss: 0.27707 (QuantReg: 11.79597) QuantErr: 11.79597 batch_time=0.36659 
Train Epoch: 16 [266/1000 8512/32000 (27%)] Loss: 0.28306 (QuantReg: 12.37614) QuantErr: 12.37614 batch_time=0.37104 
Train Epoch: 16 [271/1000 8672/32000 (27%)] Loss: 0.66668 (QuantReg: 11.94000) QuantErr: 11.94000 batch_time=0.37442 
Train Epoch: 16 [276/1000 8832/32000 (28%)] Loss: 0.27379 (QuantReg: 12.81293) QuantErr: 12.81293 batch_time=0.44890 
Train Epoch: 16 [281/1000 8992/32000 (28%)] Loss: 0.81901 (QuantReg: 11.54690) QuantErr: 11.54690 batch_time=0.43415 
Train Epoch: 16 [286/1000 9152/32000 (29%)] Loss: 0.49733 (QuantReg: 12.07979) QuantErr: 12.07979 batch_time=0.41571 
Train Epoch: 16 [291/1000 9312/32000 (29%)] Loss: 0.85763 (QuantReg: 11.47578) QuantErr: 11.47578 batch_time=0.35976 
Train Epoch: 16 [296/1000 9472/32000 (30%)] Loss: 0.58591 (QuantReg: 11.49410) QuantErr: 11.49410 batch_time=0.47687 
Train Epoch: 16 [301/1000 9632/32000 (30%)] Loss: 0.80958 (QuantReg: 12.28563) QuantErr: 12.28563 batch_time=0.36034 
Train Epoch: 16 [306/1000 9792/32000 (31%)] Loss: 0.84635 (QuantReg: 13.10705) QuantErr: 13.10705 batch_time=0.48999 
Train Epoch: 16 [311/1000 9952/32000 (31%)] Loss: 0.21123 (QuantReg: 12.91861) QuantErr: 12.91861 batch_time=0.36230 
Train Epoch: 16 [316/1000 10112/32000 (32%)] Loss: 0.30896 (QuantReg: 12.35182) QuantErr: 12.35182 batch_time=0.35206 
Train Epoch: 16 [321/1000 10272/32000 (32%)] Loss: 0.49443 (QuantReg: 11.78336) QuantErr: 11.78336 batch_time=0.40054 
Train Epoch: 16 [326/1000 10432/32000 (33%)] Loss: 0.27690 (QuantReg: 12.47704) QuantErr: 12.47704 batch_time=0.38414 
Train Epoch: 16 [331/1000 10592/32000 (33%)] Loss: 0.44071 (QuantReg: 12.44308) QuantErr: 12.44308 batch_time=0.43891 
Train Epoch: 16 [336/1000 10752/32000 (34%)] Loss: 0.69597 (QuantReg: 12.60545) QuantErr: 12.60545 batch_time=0.70748 
Train Epoch: 16 [341/1000 10912/32000 (34%)] Loss: 0.70076 (QuantReg: 13.13652) QuantErr: 13.13652 batch_time=0.45426 
Train Epoch: 16 [346/1000 11072/32000 (35%)] Loss: 0.84252 (QuantReg: 12.66456) QuantErr: 12.66456 batch_time=0.37272 
Train Epoch: 16 [351/1000 11232/32000 (35%)] Loss: 0.89318 (QuantReg: 12.43593) QuantErr: 12.43593 batch_time=0.37228 
Train Epoch: 16 [356/1000 11392/32000 (36%)] Loss: 0.53877 (QuantReg: 12.25578) QuantErr: 12.25578 batch_time=0.36024 
Train Epoch: 16 [361/1000 11552/32000 (36%)] Loss: 0.46059 (QuantReg: 11.93836) QuantErr: 11.93836 batch_time=0.38377 
Train Epoch: 16 [366/1000 11712/32000 (37%)] Loss: 0.69179 (QuantReg: 11.87980) QuantErr: 11.87980 batch_time=0.47484 
Train Epoch: 16 [371/1000 11872/32000 (37%)] Loss: 0.73473 (QuantReg: 12.97384) QuantErr: 12.97384 batch_time=0.35825 
Train Epoch: 16 [376/1000 12032/32000 (38%)] Loss: 0.71398 (QuantReg: 12.31473) QuantErr: 12.31473 batch_time=0.35858 
Train Epoch: 16 [381/1000 12192/32000 (38%)] Loss: 0.29218 (QuantReg: 12.44594) QuantErr: 12.44594 batch_time=0.37539 
Train Epoch: 16 [386/1000 12352/32000 (39%)] Loss: 0.48285 (QuantReg: 12.19266) QuantErr: 12.19266 batch_time=0.34579 
Train Epoch: 16 [391/1000 12512/32000 (39%)] Loss: 0.50684 (QuantReg: 12.57108) QuantErr: 12.57108 batch_time=0.45640 
Train Epoch: 16 [396/1000 12672/32000 (40%)] Loss: 0.20752 (QuantReg: 12.48387) QuantErr: 12.48387 batch_time=0.47171 
Train Epoch: 16 [401/1000 12832/32000 (40%)] Loss: 0.50155 (QuantReg: 12.78050) QuantErr: 12.78050 batch_time=0.48504 
Train Epoch: 16 [406/1000 12992/32000 (41%)] Loss: 0.71514 (QuantReg: 11.40959) QuantErr: 11.40959 batch_time=0.95833 
Train Epoch: 16 [411/1000 13152/32000 (41%)] Loss: 0.68490 (QuantReg: 12.86771) QuantErr: 12.86771 batch_time=0.40947 
Train Epoch: 16 [416/1000 13312/32000 (42%)] Loss: 0.55687 (QuantReg: 12.52643) QuantErr: 12.52643 batch_time=0.35610 
Train Epoch: 16 [421/1000 13472/32000 (42%)] Loss: 0.37572 (QuantReg: 12.03627) QuantErr: 12.03627 batch_time=0.39321 
Train Epoch: 16 [426/1000 13632/32000 (43%)] Loss: 0.40255 (QuantReg: 12.42809) QuantErr: 12.42809 batch_time=0.44133 
Train Epoch: 16 [431/1000 13792/32000 (43%)] Loss: 0.23678 (QuantReg: 12.33620) QuantErr: 12.33620 batch_time=0.64296 
Train Epoch: 16 [436/1000 13952/32000 (44%)] Loss: 0.76350 (QuantReg: 12.57255) QuantErr: 12.57255 batch_time=0.52347 
Train Epoch: 16 [441/1000 14112/32000 (44%)] Loss: 0.44520 (QuantReg: 13.49651) QuantErr: 13.49651 batch_time=0.35999 
Train Epoch: 16 [446/1000 14272/32000 (45%)] Loss: 0.50154 (QuantReg: 12.19868) QuantErr: 12.19868 batch_time=0.48294 
Train Epoch: 16 [451/1000 14432/32000 (45%)] Loss: 0.56856 (QuantReg: 11.78226) QuantErr: 11.78226 batch_time=0.84634 
Train Epoch: 16 [456/1000 14592/32000 (46%)] Loss: 0.53269 (QuantReg: 12.83834) QuantErr: 12.83834 batch_time=0.40278 
Train Epoch: 16 [461/1000 14752/32000 (46%)] Loss: 0.57973 (QuantReg: 12.96194) QuantErr: 12.96194 batch_time=0.38357 
Train Epoch: 16 [466/1000 14912/32000 (47%)] Loss: 0.39548 (QuantReg: 12.66074) QuantErr: 12.66074 batch_time=0.35057 
Train Epoch: 16 [471/1000 15072/32000 (47%)] Loss: 0.83323 (QuantReg: 12.58887) QuantErr: 12.58887 batch_time=0.34447 
Train Epoch: 16 [476/1000 15232/32000 (48%)] Loss: 0.60008 (QuantReg: 12.20017) QuantErr: 12.20017 batch_time=0.34715 
Train Epoch: 16 [481/1000 15392/32000 (48%)] Loss: 0.68401 (QuantReg: 12.71985) QuantErr: 12.71985 batch_time=0.74570 
Train Epoch: 16 [486/1000 15552/32000 (49%)] Loss: 0.67694 (QuantReg: 12.68418) QuantErr: 12.68418 batch_time=0.65110 
Train Epoch: 16 [491/1000 15712/32000 (49%)] Loss: 0.78162 (QuantReg: 12.51740) QuantErr: 12.51740 batch_time=0.49328 
Train Epoch: 16 [496/1000 15872/32000 (50%)] Loss: 0.40348 (QuantReg: 11.46763) QuantErr: 11.46763 batch_time=0.40808 
Train Epoch: 16 [501/1000 16032/32000 (50%)] Loss: 0.47830 (QuantReg: 12.38960) QuantErr: 12.38960 batch_time=0.40193 
Train Epoch: 16 [506/1000 16192/32000 (51%)] Loss: 0.89277 (QuantReg: 12.78932) QuantErr: 12.78932 batch_time=0.37247 
Train Epoch: 16 [511/1000 16352/32000 (51%)] Loss: 0.40082 (QuantReg: 11.75515) QuantErr: 11.75515 batch_time=0.36919 
Train Epoch: 16 [516/1000 16512/32000 (52%)] Loss: 0.28833 (QuantReg: 11.89512) QuantErr: 11.89512 batch_time=0.43958 
Train Epoch: 16 [521/1000 16672/32000 (52%)] Loss: 1.02474 (QuantReg: 12.31166) QuantErr: 12.31166 batch_time=0.40919 
Train Epoch: 16 [526/1000 16832/32000 (53%)] Loss: 0.35572 (QuantReg: 12.06643) QuantErr: 12.06643 batch_time=0.53620 
Train Epoch: 16 [531/1000 16992/32000 (53%)] Loss: 0.65942 (QuantReg: 12.72368) QuantErr: 12.72368 batch_time=0.36457 
Train Epoch: 16 [536/1000 17152/32000 (54%)] Loss: 1.16804 (QuantReg: 11.74497) QuantErr: 11.74497 batch_time=0.43091 
Train Epoch: 16 [541/1000 17312/32000 (54%)] Loss: 0.58612 (QuantReg: 12.68554) QuantErr: 12.68554 batch_time=0.34734 
Train Epoch: 16 [546/1000 17472/32000 (55%)] Loss: 0.20599 (QuantReg: 12.59447) QuantErr: 12.59447 batch_time=0.37466 
Train Epoch: 16 [551/1000 17632/32000 (55%)] Loss: 0.62648 (QuantReg: 12.39383) QuantErr: 12.39383 batch_time=0.47549 
Train Epoch: 16 [556/1000 17792/32000 (56%)] Loss: 0.42303 (QuantReg: 12.89905) QuantErr: 12.89905 batch_time=0.47007 
Train Epoch: 16 [561/1000 17952/32000 (56%)] Loss: 0.52932 (QuantReg: 12.14938) QuantErr: 12.14938 batch_time=0.56256 
Train Epoch: 16 [566/1000 18112/32000 (57%)] Loss: 0.43818 (QuantReg: 12.80677) QuantErr: 12.80677 batch_time=0.34988 
Train Epoch: 16 [571/1000 18272/32000 (57%)] Loss: 0.93530 (QuantReg: 12.21385) QuantErr: 12.21385 batch_time=0.66635 
Train Epoch: 16 [576/1000 18432/32000 (58%)] Loss: 0.76462 (QuantReg: 12.14981) QuantErr: 12.14981 batch_time=0.41096 
Train Epoch: 16 [581/1000 18592/32000 (58%)] Loss: 0.19518 (QuantReg: 12.58893) QuantErr: 12.58893 batch_time=0.39912 
Train Epoch: 16 [586/1000 18752/32000 (59%)] Loss: 0.88455 (QuantReg: 11.82503) QuantErr: 11.82503 batch_time=0.39831 
Train Epoch: 16 [591/1000 18912/32000 (59%)] Loss: 0.44492 (QuantReg: 12.60903) QuantErr: 12.60903 batch_time=0.42805 
Train Epoch: 16 [596/1000 19072/32000 (60%)] Loss: 0.75816 (QuantReg: 12.68161) QuantErr: 12.68161 batch_time=0.36117 
Train Epoch: 16 [601/1000 19232/32000 (60%)] Loss: 0.39846 (QuantReg: 12.48813) QuantErr: 12.48813 batch_time=0.37033 
Train Epoch: 16 [606/1000 19392/32000 (61%)] Loss: 0.29085 (QuantReg: 12.68841) QuantErr: 12.68841 batch_time=0.36498 
Train Epoch: 16 [611/1000 19552/32000 (61%)] Loss: 0.74211 (QuantReg: 12.76797) QuantErr: 12.76797 batch_time=0.35782 
Train Epoch: 16 [616/1000 19712/32000 (62%)] Loss: 0.74902 (QuantReg: 13.65378) QuantErr: 13.65378 batch_time=0.52005 
Train Epoch: 16 [621/1000 19872/32000 (62%)] Loss: 0.41784 (QuantReg: 12.34179) QuantErr: 12.34179 batch_time=0.45171 
Train Epoch: 16 [626/1000 20032/32000 (63%)] Loss: 1.33797 (QuantReg: 12.78068) QuantErr: 12.78068 batch_time=0.37280 
Train Epoch: 16 [631/1000 20192/32000 (63%)] Loss: 0.31361 (QuantReg: 12.22702) QuantErr: 12.22702 batch_time=0.42694 
Train Epoch: 16 [636/1000 20352/32000 (64%)] Loss: 0.52397 (QuantReg: 12.90104) QuantErr: 12.90104 batch_time=0.34657 
Train Epoch: 16 [641/1000 20512/32000 (64%)] Loss: 0.31794 (QuantReg: 12.36807) QuantErr: 12.36807 batch_time=0.36471 
Train Epoch: 16 [646/1000 20672/32000 (65%)] Loss: 0.45310 (QuantReg: 12.35999) QuantErr: 12.35999 batch_time=0.40370 
Train Epoch: 16 [651/1000 20832/32000 (65%)] Loss: 0.29490 (QuantReg: 13.60171) QuantErr: 13.60171 batch_time=0.41386 
Train Epoch: 16 [656/1000 20992/32000 (66%)] Loss: 0.59210 (QuantReg: 12.91407) QuantErr: 12.91407 batch_time=1.06393 
Train Epoch: 16 [661/1000 21152/32000 (66%)] Loss: 1.19668 (QuantReg: 11.96870) QuantErr: 11.96870 batch_time=0.36193 
Train Epoch: 16 [666/1000 21312/32000 (67%)] Loss: 0.55724 (QuantReg: 12.26688) QuantErr: 12.26688 batch_time=0.53794 
Train Epoch: 16 [671/1000 21472/32000 (67%)] Loss: 0.27669 (QuantReg: 13.18739) QuantErr: 13.18739 batch_time=0.35420 
Train Epoch: 16 [676/1000 21632/32000 (68%)] Loss: 0.40047 (QuantReg: 11.60682) QuantErr: 11.60682 batch_time=0.48888 
Train Epoch: 16 [681/1000 21792/32000 (68%)] Loss: 0.40419 (QuantReg: 12.24361) QuantErr: 12.24361 batch_time=0.37398 
Train Epoch: 16 [686/1000 21952/32000 (69%)] Loss: 0.62329 (QuantReg: 12.01450) QuantErr: 12.01450 batch_time=0.47851 
Train Epoch: 16 [691/1000 22112/32000 (69%)] Loss: 0.29104 (QuantReg: 12.83723) QuantErr: 12.83723 batch_time=0.40253 
Train Epoch: 16 [696/1000 22272/32000 (70%)] Loss: 0.66102 (QuantReg: 12.40363) QuantErr: 12.40363 batch_time=0.36416 
Train Epoch: 16 [701/1000 22432/32000 (70%)] Loss: 0.61880 (QuantReg: 12.76817) QuantErr: 12.76817 batch_time=0.76741 
Train Epoch: 16 [706/1000 22592/32000 (71%)] Loss: 0.43743 (QuantReg: 12.73369) QuantErr: 12.73369 batch_time=0.35564 
Train Epoch: 16 [711/1000 22752/32000 (71%)] Loss: 0.82240 (QuantReg: 12.25913) QuantErr: 12.25913 batch_time=0.40795 
Train Epoch: 16 [716/1000 22912/32000 (72%)] Loss: 0.85528 (QuantReg: 12.85619) QuantErr: 12.85619 batch_time=0.35933 
Train Epoch: 16 [721/1000 23072/32000 (72%)] Loss: 0.71038 (QuantReg: 12.85385) QuantErr: 12.85385 batch_time=0.42813 
Train Epoch: 16 [726/1000 23232/32000 (73%)] Loss: 0.96243 (QuantReg: 12.48058) QuantErr: 12.48058 batch_time=0.98578 
Train Epoch: 16 [731/1000 23392/32000 (73%)] Loss: 0.23693 (QuantReg: 12.82741) QuantErr: 12.82741 batch_time=0.43391 
Train Epoch: 16 [736/1000 23552/32000 (74%)] Loss: 0.42976 (QuantReg: 12.60788) QuantErr: 12.60788 batch_time=0.40041 
Train Epoch: 16 [741/1000 23712/32000 (74%)] Loss: 0.80628 (QuantReg: 13.02834) QuantErr: 13.02834 batch_time=0.37497 
Train Epoch: 16 [746/1000 23872/32000 (75%)] Loss: 0.99410 (QuantReg: 12.93313) QuantErr: 12.93313 batch_time=0.59678 
Train Epoch: 16 [751/1000 24032/32000 (75%)] Loss: 0.38181 (QuantReg: 11.69294) QuantErr: 11.69294 batch_time=0.48119 
Train Epoch: 16 [756/1000 24192/32000 (76%)] Loss: 0.12029 (QuantReg: 12.48527) QuantErr: 12.48527 batch_time=0.77112 
Train Epoch: 16 [761/1000 24352/32000 (76%)] Loss: 0.71471 (QuantReg: 12.42288) QuantErr: 12.42288 batch_time=0.50840 
Train Epoch: 16 [766/1000 24512/32000 (77%)] Loss: 0.42878 (QuantReg: 12.82053) QuantErr: 12.82053 batch_time=0.41025 
Train Epoch: 16 [771/1000 24672/32000 (77%)] Loss: 0.53086 (QuantReg: 12.91313) QuantErr: 12.91313 batch_time=0.35553 
Train Epoch: 16 [776/1000 24832/32000 (78%)] Loss: 0.29071 (QuantReg: 12.57869) QuantErr: 12.57869 batch_time=0.39644 
Train Epoch: 16 [781/1000 24992/32000 (78%)] Loss: 0.66058 (QuantReg: 12.78304) QuantErr: 12.78304 batch_time=0.35003 
Train Epoch: 16 [786/1000 25152/32000 (79%)] Loss: 0.57628 (QuantReg: 12.62354) QuantErr: 12.62354 batch_time=0.40752 
Train Epoch: 16 [791/1000 25312/32000 (79%)] Loss: 0.56554 (QuantReg: 12.69992) QuantErr: 12.69992 batch_time=0.38092 
Train Epoch: 16 [796/1000 25472/32000 (80%)] Loss: 0.54039 (QuantReg: 12.54576) QuantErr: 12.54576 batch_time=0.33735 
Train Epoch: 16 [801/1000 25632/32000 (80%)] Loss: 0.64692 (QuantReg: 12.19086) QuantErr: 12.19086 batch_time=0.64282 
Train Epoch: 16 [806/1000 25792/32000 (81%)] Loss: 0.33467 (QuantReg: 13.22533) QuantErr: 13.22533 batch_time=0.61877 
Train Epoch: 16 [811/1000 25952/32000 (81%)] Loss: 0.57522 (QuantReg: 13.36041) QuantErr: 13.36041 batch_time=0.42866 
Train Epoch: 16 [816/1000 26112/32000 (82%)] Loss: 0.63686 (QuantReg: 12.44129) QuantErr: 12.44129 batch_time=0.38625 
Train Epoch: 16 [821/1000 26272/32000 (82%)] Loss: 0.49426 (QuantReg: 12.54441) QuantErr: 12.54441 batch_time=0.35291 
Train Epoch: 16 [826/1000 26432/32000 (83%)] Loss: 0.50985 (QuantReg: 13.25913) QuantErr: 13.25913 batch_time=2.43857 
Train Epoch: 16 [831/1000 26592/32000 (83%)] Loss: 0.73731 (QuantReg: 12.31676) QuantErr: 12.31676 batch_time=0.40172 
Train Epoch: 16 [836/1000 26752/32000 (84%)] Loss: 0.50823 (QuantReg: 12.39406) QuantErr: 12.39406 batch_time=0.36264 
Train Epoch: 16 [841/1000 26912/32000 (84%)] Loss: 0.44679 (QuantReg: 12.37331) QuantErr: 12.37331 batch_time=0.45446 
Train Epoch: 16 [846/1000 27072/32000 (85%)] Loss: 0.68635 (QuantReg: 12.67221) QuantErr: 12.67221 batch_time=0.37490 
Train Epoch: 16 [851/1000 27232/32000 (85%)] Loss: 0.81202 (QuantReg: 12.58244) QuantErr: 12.58244 batch_time=0.79980 
Train Epoch: 16 [856/1000 27392/32000 (86%)] Loss: 0.46364 (QuantReg: 12.58336) QuantErr: 12.58336 batch_time=0.34151 
Train Epoch: 16 [861/1000 27552/32000 (86%)] Loss: 0.67533 (QuantReg: 13.06226) QuantErr: 13.06226 batch_time=0.51278 
Train Epoch: 16 [866/1000 27712/32000 (87%)] Loss: 0.59361 (QuantReg: 12.37755) QuantErr: 12.37755 batch_time=0.45472 
Train Epoch: 16 [871/1000 27872/32000 (87%)] Loss: 0.29221 (QuantReg: 12.37828) QuantErr: 12.37828 batch_time=0.36242 
Train Epoch: 16 [876/1000 28032/32000 (88%)] Loss: 0.62762 (QuantReg: 12.83640) QuantErr: 12.83640 batch_time=0.38626 
Train Epoch: 16 [881/1000 28192/32000 (88%)] Loss: 0.64811 (QuantReg: 12.07735) QuantErr: 12.07735 batch_time=0.35527 
Train Epoch: 16 [886/1000 28352/32000 (89%)] Loss: 0.64078 (QuantReg: 12.38577) QuantErr: 12.38577 batch_time=0.86313 
Train Epoch: 16 [891/1000 28512/32000 (89%)] Loss: 0.25521 (QuantReg: 13.15255) QuantErr: 13.15255 batch_time=0.74355 
Train Epoch: 16 [896/1000 28672/32000 (90%)] Loss: 1.32687 (QuantReg: 12.24658) QuantErr: 12.24658 batch_time=0.47189 
Train Epoch: 16 [901/1000 28832/32000 (90%)] Loss: 1.14837 (QuantReg: 12.90459) QuantErr: 12.90459 batch_time=0.44523 
Train Epoch: 16 [906/1000 28992/32000 (91%)] Loss: 0.32524 (QuantReg: 12.06534) QuantErr: 12.06534 batch_time=0.44076 
Train Epoch: 16 [911/1000 29152/32000 (91%)] Loss: 0.54067 (QuantReg: 12.81718) QuantErr: 12.81718 batch_time=0.40468 
Train Epoch: 16 [916/1000 29312/32000 (92%)] Loss: 0.45122 (QuantReg: 12.63100) QuantErr: 12.63100 batch_time=0.38256 
Train Epoch: 16 [921/1000 29472/32000 (92%)] Loss: 0.76710 (QuantReg: 12.74925) QuantErr: 12.74925 batch_time=0.36566 
Train Epoch: 16 [926/1000 29632/32000 (93%)] Loss: 0.25492 (QuantReg: 13.07242) QuantErr: 13.07242 batch_time=0.75137 
Train Epoch: 16 [931/1000 29792/32000 (93%)] Loss: 0.83846 (QuantReg: 12.45067) QuantErr: 12.45067 batch_time=0.44625 
Train Epoch: 16 [936/1000 29952/32000 (94%)] Loss: 1.11869 (QuantReg: 12.64090) QuantErr: 12.64090 batch_time=0.42068 
Train Epoch: 16 [941/1000 30112/32000 (94%)] Loss: 0.27424 (QuantReg: 12.65627) QuantErr: 12.65627 batch_time=0.41862 
Train Epoch: 16 [946/1000 30272/32000 (95%)] Loss: 0.23459 (QuantReg: 12.37931) QuantErr: 12.37931 batch_time=0.39572 
Train Epoch: 16 [951/1000 30432/32000 (95%)] Loss: 0.59695 (QuantReg: 12.84906) QuantErr: 12.84906 batch_time=0.36553 
Train Epoch: 16 [956/1000 30592/32000 (96%)] Loss: 0.50170 (QuantReg: 12.74807) QuantErr: 12.74807 batch_time=0.44806 
Train Epoch: 16 [961/1000 30752/32000 (96%)] Loss: 0.64613 (QuantReg: 12.54837) QuantErr: 12.54837 batch_time=0.37301 
Train Epoch: 16 [966/1000 30912/32000 (97%)] Loss: 0.77313 (QuantReg: 12.70421) QuantErr: 12.70421 batch_time=0.41320 
Train Epoch: 16 [971/1000 31072/32000 (97%)] Loss: 0.38122 (QuantReg: 12.53408) QuantErr: 12.53408 batch_time=0.45728 
Train Epoch: 16 [976/1000 31232/32000 (98%)] Loss: 0.60845 (QuantReg: 13.06455) QuantErr: 13.06455 batch_time=0.49947 
Train Epoch: 16 [981/1000 31392/32000 (98%)] Loss: 0.15507 (QuantReg: 12.17638) QuantErr: 12.17638 batch_time=0.43079 
Train Epoch: 16 [986/1000 31552/32000 (99%)] Loss: 0.35091 (QuantReg: 13.43959) QuantErr: 13.43959 batch_time=0.37685 
Train Epoch: 16 [991/1000 31712/32000 (99%)] Loss: 0.57651 (QuantReg: 12.70641) QuantErr: 12.70641 batch_time=0.55260 
Train Epoch: 16 [996/1000 31872/32000 (100%)] Loss: 0.40354 (QuantReg: 13.09406) QuantErr: 13.09406 batch_time=0.38035 
Train Epoch: 16 codebook_update_time=1.69347
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch16.pth ...
Done in 5.402s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch16.pth ...
Done in 10.292s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 0.567405754506588
 quant_reg      : 12.406714282035828
 quant_err      : 12.406714282035828
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 16000
 MSRVTT_miech_test/t2v_metrics/R1: 18.4
 MSRVTT_miech_test/t2v_metrics/R5: 46.3
 MSRVTT_miech_test/t2v_metrics/R10: 61.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.409
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.31724292441777
 MSRVTT_miech_test/v2t_metrics/R1: 16.2
 MSRVTT_miech_test/v2t_metrics/R5: 47.3
 MSRVTT_miech_test/v2t_metrics/R10: 61.2
 MSRVTT_miech_test/v2t_metrics/R50: 87.5
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.1645
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.06139523561806
 mnt_best       : 37.31724292441777
 not_improved_count: 0
Train Epoch: 17 [1/1000 32/32000 (0%)] Loss: 0.48453 (QuantReg: 12.11820) QuantErr: 12.11820 batch_time=29.16979 
Train Epoch: 17 [6/1000 192/32000 (1%)] Loss: 0.46764 (QuantReg: 12.05219) QuantErr: 12.05219 batch_time=0.40240 
Train Epoch: 17 [11/1000 352/32000 (1%)] Loss: 0.62515 (QuantReg: 12.25072) QuantErr: 12.25072 batch_time=0.37303 
Train Epoch: 17 [16/1000 512/32000 (2%)] Loss: 0.43350 (QuantReg: 11.95552) QuantErr: 11.95552 batch_time=1.23976 
Train Epoch: 17 [21/1000 672/32000 (2%)] Loss: 0.35713 (QuantReg: 12.64493) QuantErr: 12.64493 batch_time=0.33683 
Train Epoch: 17 [26/1000 832/32000 (3%)] Loss: 0.40925 (QuantReg: 12.81736) QuantErr: 12.81736 batch_time=0.41734 
Train Epoch: 17 [31/1000 992/32000 (3%)] Loss: 0.53786 (QuantReg: 12.00610) QuantErr: 12.00610 batch_time=0.38992 
Train Epoch: 17 [36/1000 1152/32000 (4%)] Loss: 1.03737 (QuantReg: 12.26147) QuantErr: 12.26147 batch_time=0.35878 
Train Epoch: 17 [41/1000 1312/32000 (4%)] Loss: 0.73086 (QuantReg: 12.50132) QuantErr: 12.50132 batch_time=0.67664 
Train Epoch: 17 [46/1000 1472/32000 (5%)] Loss: 0.53226 (QuantReg: 12.47283) QuantErr: 12.47283 batch_time=0.51807 
Train Epoch: 17 [51/1000 1632/32000 (5%)] Loss: 0.91464 (QuantReg: 11.39094) QuantErr: 11.39094 batch_time=0.36190 
Train Epoch: 17 [56/1000 1792/32000 (6%)] Loss: 0.87154 (QuantReg: 12.28928) QuantErr: 12.28928 batch_time=0.46778 
Train Epoch: 17 [61/1000 1952/32000 (6%)] Loss: 0.37725 (QuantReg: 12.03000) QuantErr: 12.03000 batch_time=0.41148 
Train Epoch: 17 [66/1000 2112/32000 (7%)] Loss: 0.24528 (QuantReg: 12.67646) QuantErr: 12.67646 batch_time=0.38055 
Train Epoch: 17 [71/1000 2272/32000 (7%)] Loss: 0.47136 (QuantReg: 12.65655) QuantErr: 12.65655 batch_time=0.35604 
Train Epoch: 17 [76/1000 2432/32000 (8%)] Loss: 0.33682 (QuantReg: 12.84089) QuantErr: 12.84089 batch_time=0.48586 
Train Epoch: 17 [81/1000 2592/32000 (8%)] Loss: 0.39898 (QuantReg: 12.14979) QuantErr: 12.14979 batch_time=0.52588 
Train Epoch: 17 [86/1000 2752/32000 (9%)] Loss: 0.72701 (QuantReg: 12.47736) QuantErr: 12.47736 batch_time=0.33641 
Train Epoch: 17 [91/1000 2912/32000 (9%)] Loss: 0.82375 (QuantReg: 12.76921) QuantErr: 12.76921 batch_time=0.53768 
Train Epoch: 17 [96/1000 3072/32000 (10%)] Loss: 0.75216 (QuantReg: 11.96492) QuantErr: 11.96492 batch_time=0.37561 
Train Epoch: 17 [101/1000 3232/32000 (10%)] Loss: 0.71172 (QuantReg: 11.85891) QuantErr: 11.85891 batch_time=0.37742 
Train Epoch: 17 [106/1000 3392/32000 (11%)] Loss: 0.57253 (QuantReg: 11.81291) QuantErr: 11.81291 batch_time=0.36297 
Train Epoch: 17 [111/1000 3552/32000 (11%)] Loss: 0.78281 (QuantReg: 12.44846) QuantErr: 12.44846 batch_time=0.38578 
Train Epoch: 17 [116/1000 3712/32000 (12%)] Loss: 0.75539 (QuantReg: 12.70671) QuantErr: 12.70671 batch_time=0.37707 
Train Epoch: 17 [121/1000 3872/32000 (12%)] Loss: 0.58388 (QuantReg: 12.08421) QuantErr: 12.08421 batch_time=0.41746 
Train Epoch: 17 [126/1000 4032/32000 (13%)] Loss: 0.33760 (QuantReg: 11.90048) QuantErr: 11.90048 batch_time=0.42324 
Train Epoch: 17 [131/1000 4192/32000 (13%)] Loss: 0.74554 (QuantReg: 11.91034) QuantErr: 11.91034 batch_time=0.40607 
Train Epoch: 17 [136/1000 4352/32000 (14%)] Loss: 0.37090 (QuantReg: 12.44593) QuantErr: 12.44593 batch_time=0.75912 
Train Epoch: 17 [141/1000 4512/32000 (14%)] Loss: 0.57484 (QuantReg: 12.67276) QuantErr: 12.67276 batch_time=0.41599 
Train Epoch: 17 [146/1000 4672/32000 (15%)] Loss: 0.88623 (QuantReg: 12.23260) QuantErr: 12.23260 batch_time=0.44290 
Train Epoch: 17 [151/1000 4832/32000 (15%)] Loss: 0.35306 (QuantReg: 12.51006) QuantErr: 12.51006 batch_time=0.56061 
Train Epoch: 17 [156/1000 4992/32000 (16%)] Loss: 0.63465 (QuantReg: 12.08558) QuantErr: 12.08558 batch_time=0.39159 
Train Epoch: 17 [161/1000 5152/32000 (16%)] Loss: 0.60140 (QuantReg: 13.33928) QuantErr: 13.33928 batch_time=0.45281 
Train Epoch: 17 [166/1000 5312/32000 (17%)] Loss: 0.52437 (QuantReg: 12.05750) QuantErr: 12.05750 batch_time=0.44093 
Train Epoch: 17 [171/1000 5472/32000 (17%)] Loss: 0.47135 (QuantReg: 13.08139) QuantErr: 13.08139 batch_time=0.55398 
Train Epoch: 17 [176/1000 5632/32000 (18%)] Loss: 0.62073 (QuantReg: 12.58897) QuantErr: 12.58897 batch_time=0.34307 
Train Epoch: 17 [181/1000 5792/32000 (18%)] Loss: 0.56420 (QuantReg: 11.78820) QuantErr: 11.78820 batch_time=0.64012 
Train Epoch: 17 [186/1000 5952/32000 (19%)] Loss: 0.60859 (QuantReg: 12.51531) QuantErr: 12.51531 batch_time=0.42553 
Train Epoch: 17 [191/1000 6112/32000 (19%)] Loss: 0.62482 (QuantReg: 12.45130) QuantErr: 12.45130 batch_time=0.34979 
Train Epoch: 17 [196/1000 6272/32000 (20%)] Loss: 0.59965 (QuantReg: 12.36805) QuantErr: 12.36805 batch_time=0.61262 
Train Epoch: 17 [201/1000 6432/32000 (20%)] Loss: 0.16285 (QuantReg: 12.12864) QuantErr: 12.12864 batch_time=0.36228 
Train Epoch: 17 [206/1000 6592/32000 (21%)] Loss: 0.55655 (QuantReg: 12.14949) QuantErr: 12.14949 batch_time=0.38118 
Train Epoch: 17 [211/1000 6752/32000 (21%)] Loss: 0.37240 (QuantReg: 12.50203) QuantErr: 12.50203 batch_time=0.39894 
Train Epoch: 17 [216/1000 6912/32000 (22%)] Loss: 0.77611 (QuantReg: 12.57185) QuantErr: 12.57185 batch_time=0.37365 
Train Epoch: 17 [221/1000 7072/32000 (22%)] Loss: 0.32144 (QuantReg: 12.92220) QuantErr: 12.92220 batch_time=0.35444 
Train Epoch: 17 [226/1000 7232/32000 (23%)] Loss: 0.26058 (QuantReg: 12.47961) QuantErr: 12.47961 batch_time=0.51283 
Train Epoch: 17 [231/1000 7392/32000 (23%)] Loss: 0.28223 (QuantReg: 12.71999) QuantErr: 12.71999 batch_time=0.43913 
Train Epoch: 17 [236/1000 7552/32000 (24%)] Loss: 0.51870 (QuantReg: 12.11379) QuantErr: 12.11379 batch_time=0.64948 
Train Epoch: 17 [241/1000 7712/32000 (24%)] Loss: 0.90867 (QuantReg: 12.21693) QuantErr: 12.21693 batch_time=0.67435 
Train Epoch: 17 [246/1000 7872/32000 (25%)] Loss: 0.64475 (QuantReg: 11.72118) QuantErr: 11.72118 batch_time=0.42998 
Train Epoch: 17 [251/1000 8032/32000 (25%)] Loss: 0.46105 (QuantReg: 11.81616) QuantErr: 11.81616 batch_time=0.37246 
Train Epoch: 17 [256/1000 8192/32000 (26%)] Loss: 0.68937 (QuantReg: 11.82306) QuantErr: 11.82306 batch_time=0.36290 
Train Epoch: 17 [261/1000 8352/32000 (26%)] Loss: 0.58708 (QuantReg: 12.14320) QuantErr: 12.14320 batch_time=0.36644 
Train Epoch: 17 [266/1000 8512/32000 (27%)] Loss: 0.70445 (QuantReg: 12.51802) QuantErr: 12.51802 batch_time=0.50464 
Train Epoch: 17 [271/1000 8672/32000 (27%)] Loss: 0.38366 (QuantReg: 12.25137) QuantErr: 12.25137 batch_time=0.40073 
Train Epoch: 17 [276/1000 8832/32000 (28%)] Loss: 0.33351 (QuantReg: 12.22182) QuantErr: 12.22182 batch_time=0.71736 
Train Epoch: 17 [281/1000 8992/32000 (28%)] Loss: 0.41739 (QuantReg: 12.45589) QuantErr: 12.45589 batch_time=0.36124 
Train Epoch: 17 [286/1000 9152/32000 (29%)] Loss: 0.37812 (QuantReg: 12.79497) QuantErr: 12.79497 batch_time=0.62548 
Train Epoch: 17 [291/1000 9312/32000 (29%)] Loss: 0.65974 (QuantReg: 12.68589) QuantErr: 12.68589 batch_time=1.65232 
Train Epoch: 17 [296/1000 9472/32000 (30%)] Loss: 0.71800 (QuantReg: 12.64201) QuantErr: 12.64201 batch_time=0.45480 
Train Epoch: 17 [301/1000 9632/32000 (30%)] Loss: 0.30935 (QuantReg: 12.63752) QuantErr: 12.63752 batch_time=0.35991 
Train Epoch: 17 [306/1000 9792/32000 (31%)] Loss: 0.57657 (QuantReg: 11.83969) QuantErr: 11.83969 batch_time=0.35337 
Train Epoch: 17 [311/1000 9952/32000 (31%)] Loss: 0.43824 (QuantReg: 12.44844) QuantErr: 12.44844 batch_time=0.41931 
Train Epoch: 17 [316/1000 10112/32000 (32%)] Loss: 0.52915 (QuantReg: 12.89938) QuantErr: 12.89938 batch_time=0.45085 
Train Epoch: 17 [321/1000 10272/32000 (32%)] Loss: 0.66070 (QuantReg: 12.21330) QuantErr: 12.21330 batch_time=0.56295 
Train Epoch: 17 [326/1000 10432/32000 (33%)] Loss: 0.74477 (QuantReg: 12.14158) QuantErr: 12.14158 batch_time=0.39233 
Train Epoch: 17 [331/1000 10592/32000 (33%)] Loss: 0.28658 (QuantReg: 12.48454) QuantErr: 12.48454 batch_time=0.38987 
Train Epoch: 17 [336/1000 10752/32000 (34%)] Loss: 0.73092 (QuantReg: 12.24800) QuantErr: 12.24800 batch_time=0.36620 
Train Epoch: 17 [341/1000 10912/32000 (34%)] Loss: 0.71355 (QuantReg: 12.35217) QuantErr: 12.35217 batch_time=0.37993 
Train Epoch: 17 [346/1000 11072/32000 (35%)] Loss: 0.35518 (QuantReg: 12.43001) QuantErr: 12.43001 batch_time=0.36775 
Train Epoch: 17 [351/1000 11232/32000 (35%)] Loss: 0.54796 (QuantReg: 12.54286) QuantErr: 12.54286 batch_time=0.42235 
Train Epoch: 17 [356/1000 11392/32000 (36%)] Loss: 0.20298 (QuantReg: 13.33276) QuantErr: 13.33276 batch_time=0.34709 
Train Epoch: 17 [361/1000 11552/32000 (36%)] Loss: 0.41609 (QuantReg: 12.54809) QuantErr: 12.54809 batch_time=0.80903 
Train Epoch: 17 [366/1000 11712/32000 (37%)] Loss: 0.23742 (QuantReg: 12.99558) QuantErr: 12.99558 batch_time=0.53546 
Train Epoch: 17 [371/1000 11872/32000 (37%)] Loss: 0.31638 (QuantReg: 12.99286) QuantErr: 12.99286 batch_time=0.42928 
Train Epoch: 17 [376/1000 12032/32000 (38%)] Loss: 0.69302 (QuantReg: 13.22762) QuantErr: 13.22762 batch_time=0.46157 
Train Epoch: 17 [381/1000 12192/32000 (38%)] Loss: 0.34793 (QuantReg: 12.52699) QuantErr: 12.52699 batch_time=0.36101 
Train Epoch: 17 [386/1000 12352/32000 (39%)] Loss: 0.78539 (QuantReg: 12.35694) QuantErr: 12.35694 batch_time=0.37349 
Train Epoch: 17 [391/1000 12512/32000 (39%)] Loss: 0.46286 (QuantReg: 13.11024) QuantErr: 13.11024 batch_time=0.36794 
Train Epoch: 17 [396/1000 12672/32000 (40%)] Loss: 1.08557 (QuantReg: 12.64585) QuantErr: 12.64585 batch_time=0.37096 
Train Epoch: 17 [401/1000 12832/32000 (40%)] Loss: 0.75297 (QuantReg: 12.78290) QuantErr: 12.78290 batch_time=1.91894 
Train Epoch: 17 [406/1000 12992/32000 (41%)] Loss: 0.23363 (QuantReg: 12.02712) QuantErr: 12.02712 batch_time=0.71618 
Train Epoch: 17 [411/1000 13152/32000 (41%)] Loss: 0.62867 (QuantReg: 12.95841) QuantErr: 12.95841 batch_time=0.45727 
Train Epoch: 17 [416/1000 13312/32000 (42%)] Loss: 0.42782 (QuantReg: 12.94602) QuantErr: 12.94602 batch_time=0.41084 
Train Epoch: 17 [421/1000 13472/32000 (42%)] Loss: 0.99771 (QuantReg: 12.33827) QuantErr: 12.33827 batch_time=0.43596 
Train Epoch: 17 [426/1000 13632/32000 (43%)] Loss: 0.49296 (QuantReg: 12.25396) QuantErr: 12.25396 batch_time=0.36735 
Train Epoch: 17 [431/1000 13792/32000 (43%)] Loss: 0.47870 (QuantReg: 12.64698) QuantErr: 12.64698 batch_time=0.35724 
Train Epoch: 17 [436/1000 13952/32000 (44%)] Loss: 0.34369 (QuantReg: 12.23873) QuantErr: 12.23873 batch_time=0.41856 
Train Epoch: 17 [441/1000 14112/32000 (44%)] Loss: 0.60422 (QuantReg: 12.43789) QuantErr: 12.43789 batch_time=0.42679 
Train Epoch: 17 [446/1000 14272/32000 (45%)] Loss: 0.41326 (QuantReg: 12.22222) QuantErr: 12.22222 batch_time=0.51629 
Train Epoch: 17 [451/1000 14432/32000 (45%)] Loss: 0.51381 (QuantReg: 12.48952) QuantErr: 12.48952 batch_time=0.35272 
Train Epoch: 17 [456/1000 14592/32000 (46%)] Loss: 0.30431 (QuantReg: 12.02104) QuantErr: 12.02104 batch_time=0.91134 
Train Epoch: 17 [461/1000 14752/32000 (46%)] Loss: 0.36745 (QuantReg: 12.87332) QuantErr: 12.87332 batch_time=0.35062 
Train Epoch: 17 [466/1000 14912/32000 (47%)] Loss: 0.26078 (QuantReg: 12.59671) QuantErr: 12.59671 batch_time=0.44667 
Train Epoch: 17 [471/1000 15072/32000 (47%)] Loss: 0.25593 (QuantReg: 12.68602) QuantErr: 12.68602 batch_time=0.37731 
Train Epoch: 17 [476/1000 15232/32000 (48%)] Loss: 0.48927 (QuantReg: 12.11194) QuantErr: 12.11194 batch_time=0.43469 
Train Epoch: 17 [481/1000 15392/32000 (48%)] Loss: 0.32119 (QuantReg: 12.60003) QuantErr: 12.60003 batch_time=0.41992 
Train Epoch: 17 [486/1000 15552/32000 (49%)] Loss: 0.68636 (QuantReg: 12.56296) QuantErr: 12.56296 batch_time=0.40276 
Train Epoch: 17 [491/1000 15712/32000 (49%)] Loss: 0.50224 (QuantReg: 12.83693) QuantErr: 12.83693 batch_time=0.46928 
Train Epoch: 17 [496/1000 15872/32000 (50%)] Loss: 1.08064 (QuantReg: 11.22489) QuantErr: 11.22489 batch_time=0.40121 
Train Epoch: 17 [501/1000 16032/32000 (50%)] Loss: 1.02799 (QuantReg: 12.78377) QuantErr: 12.78377 batch_time=0.46942 
Train Epoch: 17 [506/1000 16192/32000 (51%)] Loss: 0.38267 (QuantReg: 13.32152) QuantErr: 13.32152 batch_time=0.41626 
Train Epoch: 17 [511/1000 16352/32000 (51%)] Loss: 0.28446 (QuantReg: 12.08883) QuantErr: 12.08883 batch_time=0.40601 
Train Epoch: 17 [516/1000 16512/32000 (52%)] Loss: 0.59549 (QuantReg: 12.10536) QuantErr: 12.10536 batch_time=0.35350 
Train Epoch: 17 [521/1000 16672/32000 (52%)] Loss: 0.74457 (QuantReg: 12.04042) QuantErr: 12.04042 batch_time=0.37035 
Train Epoch: 17 [526/1000 16832/32000 (53%)] Loss: 0.78610 (QuantReg: 12.22355) QuantErr: 12.22355 batch_time=0.37347 
Train Epoch: 17 [531/1000 16992/32000 (53%)] Loss: 0.66880 (QuantReg: 11.88870) QuantErr: 11.88870 batch_time=0.39917 
Train Epoch: 17 [536/1000 17152/32000 (54%)] Loss: 0.55158 (QuantReg: 11.84255) QuantErr: 11.84255 batch_time=0.41591 
Train Epoch: 17 [541/1000 17312/32000 (54%)] Loss: 0.33456 (QuantReg: 12.94805) QuantErr: 12.94805 batch_time=0.57635 
Train Epoch: 17 [546/1000 17472/32000 (55%)] Loss: 0.50094 (QuantReg: 12.09092) QuantErr: 12.09092 batch_time=0.38784 
Train Epoch: 17 [551/1000 17632/32000 (55%)] Loss: 0.36720 (QuantReg: 12.39084) QuantErr: 12.39084 batch_time=0.41279 
Train Epoch: 17 [556/1000 17792/32000 (56%)] Loss: 0.33059 (QuantReg: 12.57759) QuantErr: 12.57759 batch_time=0.41182 
Train Epoch: 17 [561/1000 17952/32000 (56%)] Loss: 0.43563 (QuantReg: 12.77907) QuantErr: 12.77907 batch_time=0.69558 
Train Epoch: 17 [566/1000 18112/32000 (57%)] Loss: 0.70825 (QuantReg: 12.74800) QuantErr: 12.74800 batch_time=0.34161 
Train Epoch: 17 [571/1000 18272/32000 (57%)] Loss: 0.78906 (QuantReg: 11.85206) QuantErr: 11.85206 batch_time=0.34437 
Train Epoch: 17 [576/1000 18432/32000 (58%)] Loss: 0.80461 (QuantReg: 11.87152) QuantErr: 11.87152 batch_time=0.35124 
Train Epoch: 17 [581/1000 18592/32000 (58%)] Loss: 0.39420 (QuantReg: 12.28798) QuantErr: 12.28798 batch_time=0.35653 
Train Epoch: 17 [586/1000 18752/32000 (59%)] Loss: 0.26238 (QuantReg: 13.37685) QuantErr: 13.37685 batch_time=0.35749 
Train Epoch: 17 [591/1000 18912/32000 (59%)] Loss: 0.41080 (QuantReg: 12.79572) QuantErr: 12.79572 batch_time=0.40566 
Train Epoch: 17 [596/1000 19072/32000 (60%)] Loss: 0.34457 (QuantReg: 12.28717) QuantErr: 12.28717 batch_time=1.22991 
Train Epoch: 17 [601/1000 19232/32000 (60%)] Loss: 0.61270 (QuantReg: 12.29921) QuantErr: 12.29921 batch_time=0.35018 
Train Epoch: 17 [606/1000 19392/32000 (61%)] Loss: 0.88541 (QuantReg: 12.25127) QuantErr: 12.25127 batch_time=0.43907 
Train Epoch: 17 [611/1000 19552/32000 (61%)] Loss: 0.40722 (QuantReg: 11.99652) QuantErr: 11.99652 batch_time=0.52102 
Train Epoch: 17 [616/1000 19712/32000 (62%)] Loss: 0.70529 (QuantReg: 13.28837) QuantErr: 13.28837 batch_time=0.39916 
Train Epoch: 17 [621/1000 19872/32000 (62%)] Loss: 0.29736 (QuantReg: 12.27314) QuantErr: 12.27314 batch_time=0.34191 
Train Epoch: 17 [626/1000 20032/32000 (63%)] Loss: 0.59722 (QuantReg: 12.31897) QuantErr: 12.31897 batch_time=0.73428 
Train Epoch: 17 [631/1000 20192/32000 (63%)] Loss: 0.36034 (QuantReg: 12.73878) QuantErr: 12.73878 batch_time=0.36742 
Train Epoch: 17 [636/1000 20352/32000 (64%)] Loss: 0.51629 (QuantReg: 12.70587) QuantErr: 12.70587 batch_time=0.61259 
Train Epoch: 17 [641/1000 20512/32000 (64%)] Loss: 0.76846 (QuantReg: 12.08351) QuantErr: 12.08351 batch_time=0.69948 
Train Epoch: 17 [646/1000 20672/32000 (65%)] Loss: 0.31459 (QuantReg: 12.26327) QuantErr: 12.26327 batch_time=0.62859 
Train Epoch: 17 [651/1000 20832/32000 (65%)] Loss: 0.19178 (QuantReg: 12.13904) QuantErr: 12.13904 batch_time=0.39650 
Train Epoch: 17 [656/1000 20992/32000 (66%)] Loss: 0.65854 (QuantReg: 13.38144) QuantErr: 13.38144 batch_time=0.47305 
Train Epoch: 17 [661/1000 21152/32000 (66%)] Loss: 0.22639 (QuantReg: 12.05648) QuantErr: 12.05648 batch_time=0.63431 
Train Epoch: 17 [666/1000 21312/32000 (67%)] Loss: 0.22610 (QuantReg: 12.80739) QuantErr: 12.80739 batch_time=0.44557 
Train Epoch: 17 [671/1000 21472/32000 (67%)] Loss: 1.23830 (QuantReg: 12.34459) QuantErr: 12.34459 batch_time=0.43667 
Train Epoch: 17 [676/1000 21632/32000 (68%)] Loss: 0.35007 (QuantReg: 12.94166) QuantErr: 12.94166 batch_time=0.36032 
Train Epoch: 17 [681/1000 21792/32000 (68%)] Loss: 0.70519 (QuantReg: 12.36029) QuantErr: 12.36029 batch_time=0.67225 
Train Epoch: 17 [686/1000 21952/32000 (69%)] Loss: 0.85955 (QuantReg: 12.79802) QuantErr: 12.79802 batch_time=0.34082 
Train Epoch: 17 [691/1000 22112/32000 (69%)] Loss: 0.65218 (QuantReg: 12.27733) QuantErr: 12.27733 batch_time=0.71922 
Train Epoch: 17 [696/1000 22272/32000 (70%)] Loss: 0.33593 (QuantReg: 12.03852) QuantErr: 12.03852 batch_time=0.35017 
Train Epoch: 17 [701/1000 22432/32000 (70%)] Loss: 0.71146 (QuantReg: 12.43539) QuantErr: 12.43539 batch_time=0.35964 
Train Epoch: 17 [706/1000 22592/32000 (71%)] Loss: 0.51035 (QuantReg: 11.71100) QuantErr: 11.71100 batch_time=0.36002 
Train Epoch: 17 [711/1000 22752/32000 (71%)] Loss: 0.49819 (QuantReg: 11.96913) QuantErr: 11.96913 batch_time=0.36707 
Train Epoch: 17 [716/1000 22912/32000 (72%)] Loss: 0.32825 (QuantReg: 12.51792) QuantErr: 12.51792 batch_time=0.39708 
Train Epoch: 17 [721/1000 23072/32000 (72%)] Loss: 0.48030 (QuantReg: 12.67688) QuantErr: 12.67688 batch_time=1.57312 
Train Epoch: 17 [726/1000 23232/32000 (73%)] Loss: 0.35481 (QuantReg: 12.60820) QuantErr: 12.60820 batch_time=0.44657 
Train Epoch: 17 [731/1000 23392/32000 (73%)] Loss: 0.59828 (QuantReg: 11.73613) QuantErr: 11.73613 batch_time=0.36963 
Train Epoch: 17 [736/1000 23552/32000 (74%)] Loss: 0.30395 (QuantReg: 13.20671) QuantErr: 13.20671 batch_time=0.47759 
Train Epoch: 17 [741/1000 23712/32000 (74%)] Loss: 0.58009 (QuantReg: 12.26256) QuantErr: 12.26256 batch_time=0.46845 
Train Epoch: 17 [746/1000 23872/32000 (75%)] Loss: 0.37327 (QuantReg: 12.46661) QuantErr: 12.46661 batch_time=0.38026 
Train Epoch: 17 [751/1000 24032/32000 (75%)] Loss: 0.66145 (QuantReg: 11.88203) QuantErr: 11.88203 batch_time=0.48707 
Train Epoch: 17 [756/1000 24192/32000 (76%)] Loss: 0.38791 (QuantReg: 12.85912) QuantErr: 12.85912 batch_time=0.37769 
Train Epoch: 17 [761/1000 24352/32000 (76%)] Loss: 0.59139 (QuantReg: 12.54582) QuantErr: 12.54582 batch_time=0.36795 
Train Epoch: 17 [766/1000 24512/32000 (77%)] Loss: 0.05463 (QuantReg: 12.39722) QuantErr: 12.39722 batch_time=0.41993 
Train Epoch: 17 [771/1000 24672/32000 (77%)] Loss: 0.71305 (QuantReg: 13.01260) QuantErr: 13.01260 batch_time=0.42496 
Train Epoch: 17 [776/1000 24832/32000 (78%)] Loss: 1.10069 (QuantReg: 12.39388) QuantErr: 12.39388 batch_time=0.35382 
Train Epoch: 17 [781/1000 24992/32000 (78%)] Loss: 0.53187 (QuantReg: 11.94313) QuantErr: 11.94313 batch_time=0.35604 
Train Epoch: 17 [786/1000 25152/32000 (79%)] Loss: 0.48378 (QuantReg: 12.69754) QuantErr: 12.69754 batch_time=0.68371 
Train Epoch: 17 [791/1000 25312/32000 (79%)] Loss: 0.75282 (QuantReg: 12.34814) QuantErr: 12.34814 batch_time=0.35041 
Train Epoch: 17 [796/1000 25472/32000 (80%)] Loss: 0.52720 (QuantReg: 12.36713) QuantErr: 12.36713 batch_time=0.37592 
Train Epoch: 17 [801/1000 25632/32000 (80%)] Loss: 0.40456 (QuantReg: 12.16531) QuantErr: 12.16531 batch_time=0.35118 
Train Epoch: 17 [806/1000 25792/32000 (81%)] Loss: 0.55670 (QuantReg: 12.76081) QuantErr: 12.76081 batch_time=0.39253 
Train Epoch: 17 [811/1000 25952/32000 (81%)] Loss: 0.66330 (QuantReg: 12.44143) QuantErr: 12.44143 batch_time=1.46979 
Train Epoch: 17 [816/1000 26112/32000 (82%)] Loss: 0.79418 (QuantReg: 12.70406) QuantErr: 12.70406 batch_time=0.42501 
Train Epoch: 17 [821/1000 26272/32000 (82%)] Loss: 0.18612 (QuantReg: 12.41486) QuantErr: 12.41486 batch_time=0.58606 
Train Epoch: 17 [826/1000 26432/32000 (83%)] Loss: 0.77777 (QuantReg: 12.53607) QuantErr: 12.53607 batch_time=0.34394 
Train Epoch: 17 [831/1000 26592/32000 (83%)] Loss: 0.30087 (QuantReg: 12.42187) QuantErr: 12.42187 batch_time=0.56102 
Train Epoch: 17 [836/1000 26752/32000 (84%)] Loss: 0.70258 (QuantReg: 13.51217) QuantErr: 13.51217 batch_time=0.34678 
Train Epoch: 17 [841/1000 26912/32000 (84%)] Loss: 0.23154 (QuantReg: 12.82199) QuantErr: 12.82199 batch_time=0.44462 
Train Epoch: 17 [846/1000 27072/32000 (85%)] Loss: 0.10700 (QuantReg: 12.73466) QuantErr: 12.73466 batch_time=0.68643 
Train Epoch: 17 [851/1000 27232/32000 (85%)] Loss: 0.56797 (QuantReg: 12.13560) QuantErr: 12.13560 batch_time=0.34811 
Train Epoch: 17 [856/1000 27392/32000 (86%)] Loss: 0.66692 (QuantReg: 12.68486) QuantErr: 12.68486 batch_time=0.35788 
Train Epoch: 17 [861/1000 27552/32000 (86%)] Loss: 0.68618 (QuantReg: 12.30137) QuantErr: 12.30137 batch_time=0.39622 
Train Epoch: 17 [866/1000 27712/32000 (87%)] Loss: 0.19872 (QuantReg: 13.28126) QuantErr: 13.28126 batch_time=0.45588 
Train Epoch: 17 [871/1000 27872/32000 (87%)] Loss: 0.55942 (QuantReg: 12.89521) QuantErr: 12.89521 batch_time=0.38269 
Train Epoch: 17 [876/1000 28032/32000 (88%)] Loss: 0.47459 (QuantReg: 13.17698) QuantErr: 13.17698 batch_time=0.58097 
Train Epoch: 17 [881/1000 28192/32000 (88%)] Loss: 0.94828 (QuantReg: 12.41317) QuantErr: 12.41317 batch_time=0.36440 
Train Epoch: 17 [886/1000 28352/32000 (89%)] Loss: 0.57406 (QuantReg: 12.89513) QuantErr: 12.89513 batch_time=0.36523 
Train Epoch: 17 [891/1000 28512/32000 (89%)] Loss: 0.20281 (QuantReg: 12.84259) QuantErr: 12.84259 batch_time=0.38610 
Train Epoch: 17 [896/1000 28672/32000 (90%)] Loss: 0.23936 (QuantReg: 13.02286) QuantErr: 13.02286 batch_time=0.44863 
Train Epoch: 17 [901/1000 28832/32000 (90%)] Loss: 0.23442 (QuantReg: 12.36165) QuantErr: 12.36165 batch_time=0.45670 
Train Epoch: 17 [906/1000 28992/32000 (91%)] Loss: 0.55265 (QuantReg: 12.52231) QuantErr: 12.52231 batch_time=0.36743 
Train Epoch: 17 [911/1000 29152/32000 (91%)] Loss: 0.37688 (QuantReg: 12.61443) QuantErr: 12.61443 batch_time=0.38244 
Train Epoch: 17 [916/1000 29312/32000 (92%)] Loss: 0.24461 (QuantReg: 13.32684) QuantErr: 13.32684 batch_time=0.56134 
Train Epoch: 17 [921/1000 29472/32000 (92%)] Loss: 0.82269 (QuantReg: 11.79261) QuantErr: 11.79261 batch_time=0.35369 
Train Epoch: 17 [926/1000 29632/32000 (93%)] Loss: 0.44805 (QuantReg: 12.57269) QuantErr: 12.57269 batch_time=0.61628 
Train Epoch: 17 [931/1000 29792/32000 (93%)] Loss: 0.11983 (QuantReg: 13.51953) QuantErr: 13.51953 batch_time=1.02897 
Train Epoch: 17 [936/1000 29952/32000 (94%)] Loss: 0.35352 (QuantReg: 12.85489) QuantErr: 12.85489 batch_time=0.33665 
Train Epoch: 17 [941/1000 30112/32000 (94%)] Loss: 0.49704 (QuantReg: 12.07040) QuantErr: 12.07040 batch_time=0.36875 
Train Epoch: 17 [946/1000 30272/32000 (95%)] Loss: 0.47582 (QuantReg: 12.09347) QuantErr: 12.09347 batch_time=0.36183 
Train Epoch: 17 [951/1000 30432/32000 (95%)] Loss: 0.35244 (QuantReg: 13.02561) QuantErr: 13.02561 batch_time=0.35559 
Train Epoch: 17 [956/1000 30592/32000 (96%)] Loss: 0.28439 (QuantReg: 12.12265) QuantErr: 12.12265 batch_time=0.36072 
Train Epoch: 17 [961/1000 30752/32000 (96%)] Loss: 0.53637 (QuantReg: 12.68876) QuantErr: 12.68876 batch_time=0.41365 
Train Epoch: 17 [966/1000 30912/32000 (97%)] Loss: 0.81338 (QuantReg: 11.84150) QuantErr: 11.84150 batch_time=0.50776 
Train Epoch: 17 [971/1000 31072/32000 (97%)] Loss: 0.52823 (QuantReg: 12.34637) QuantErr: 12.34637 batch_time=0.66980 
Train Epoch: 17 [976/1000 31232/32000 (98%)] Loss: 0.25915 (QuantReg: 12.48879) QuantErr: 12.48879 batch_time=0.33951 
Train Epoch: 17 [981/1000 31392/32000 (98%)] Loss: 0.33797 (QuantReg: 12.45297) QuantErr: 12.45297 batch_time=0.56749 
Train Epoch: 17 [986/1000 31552/32000 (99%)] Loss: 0.48355 (QuantReg: 12.31115) QuantErr: 12.31115 batch_time=0.34523 
Train Epoch: 17 [991/1000 31712/32000 (99%)] Loss: 0.70966 (QuantReg: 11.80302) QuantErr: 11.80302 batch_time=0.44528 
Train Epoch: 17 [996/1000 31872/32000 (100%)] Loss: 0.57610 (QuantReg: 12.64376) QuantErr: 12.64376 batch_time=0.38816 
Train Epoch: 17 codebook_update_time=1.79411
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch17.pth ...
Done in 7.119s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 0.5370139400735497
 quant_reg      : 12.474938848495484
 quant_err      : 12.474938848495484
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 17000
 MSRVTT_miech_test/t2v_metrics/R1: 17.4
 MSRVTT_miech_test/t2v_metrics/R5: 45.8
 MSRVTT_miech_test/t2v_metrics/R10: 60.6
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.308
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.4162970939168
 MSRVTT_miech_test/v2t_metrics/R1: 16.2
 MSRVTT_miech_test/v2t_metrics/R5: 45.7
 MSRVTT_miech_test/v2t_metrics/R10: 60.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 7.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.402
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.53322393848362
 mnt_best       : 37.31724292441777
 not_improved_count: 1
Train Epoch: 18 [1/1000 32/32000 (0%)] Loss: 0.63092 (QuantReg: 11.78985) QuantErr: 11.78985 batch_time=28.40148 
Train Epoch: 18 [6/1000 192/32000 (1%)] Loss: 0.53725 (QuantReg: 11.32155) QuantErr: 11.32155 batch_time=0.33978 
Train Epoch: 18 [11/1000 352/32000 (1%)] Loss: 0.85973 (QuantReg: 12.15321) QuantErr: 12.15321 batch_time=0.48325 
Train Epoch: 18 [16/1000 512/32000 (2%)] Loss: 0.67055 (QuantReg: 12.02654) QuantErr: 12.02654 batch_time=0.37407 
Train Epoch: 18 [21/1000 672/32000 (2%)] Loss: 0.46690 (QuantReg: 12.66271) QuantErr: 12.66271 batch_time=0.36413 
Train Epoch: 18 [26/1000 832/32000 (3%)] Loss: 1.05497 (QuantReg: 11.61188) QuantErr: 11.61188 batch_time=0.36555 
Train Epoch: 18 [31/1000 992/32000 (3%)] Loss: 0.87961 (QuantReg: 12.37091) QuantErr: 12.37091 batch_time=0.36280 
Train Epoch: 18 [36/1000 1152/32000 (4%)] Loss: 0.52870 (QuantReg: 12.51432) QuantErr: 12.51432 batch_time=0.44684 
Train Epoch: 18 [41/1000 1312/32000 (4%)] Loss: 0.33371 (QuantReg: 12.87462) QuantErr: 12.87462 batch_time=0.38955 
Train Epoch: 18 [46/1000 1472/32000 (5%)] Loss: 0.44452 (QuantReg: 11.83857) QuantErr: 11.83857 batch_time=0.48074 
Train Epoch: 18 [51/1000 1632/32000 (5%)] Loss: 0.30258 (QuantReg: 12.51386) QuantErr: 12.51386 batch_time=0.79196 
Train Epoch: 18 [56/1000 1792/32000 (6%)] Loss: 0.30582 (QuantReg: 12.73415) QuantErr: 12.73415 batch_time=0.40044 
Train Epoch: 18 [61/1000 1952/32000 (6%)] Loss: 1.00766 (QuantReg: 11.53868) QuantErr: 11.53868 batch_time=0.38313 
Train Epoch: 18 [66/1000 2112/32000 (7%)] Loss: 0.17714 (QuantReg: 12.13237) QuantErr: 12.13237 batch_time=0.81535 
Train Epoch: 18 [71/1000 2272/32000 (7%)] Loss: 0.40251 (QuantReg: 11.55169) QuantErr: 11.55169 batch_time=0.36214 
Train Epoch: 18 [76/1000 2432/32000 (8%)] Loss: 0.39226 (QuantReg: 12.88686) QuantErr: 12.88686 batch_time=0.34389 
Train Epoch: 18 [81/1000 2592/32000 (8%)] Loss: 0.39239 (QuantReg: 12.45207) QuantErr: 12.45207 batch_time=0.34294 
Train Epoch: 18 [86/1000 2752/32000 (9%)] Loss: 0.75728 (QuantReg: 11.63055) QuantErr: 11.63055 batch_time=0.40158 
Train Epoch: 18 [91/1000 2912/32000 (9%)] Loss: 0.41438 (QuantReg: 12.74391) QuantErr: 12.74391 batch_time=0.33756 
Train Epoch: 18 [96/1000 3072/32000 (10%)] Loss: 0.26012 (QuantReg: 12.14150) QuantErr: 12.14150 batch_time=0.45385 
Train Epoch: 18 [101/1000 3232/32000 (10%)] Loss: 0.71985 (QuantReg: 12.84436) QuantErr: 12.84436 batch_time=0.33807 
Train Epoch: 18 [106/1000 3392/32000 (11%)] Loss: 0.60256 (QuantReg: 12.00875) QuantErr: 12.00875 batch_time=0.36661 
Train Epoch: 18 [111/1000 3552/32000 (11%)] Loss: 0.59722 (QuantReg: 12.39639) QuantErr: 12.39639 batch_time=0.73062 
Train Epoch: 18 [116/1000 3712/32000 (12%)] Loss: 0.41145 (QuantReg: 12.24109) QuantErr: 12.24109 batch_time=0.35791 
Train Epoch: 18 [121/1000 3872/32000 (12%)] Loss: 0.42422 (QuantReg: 12.81014) QuantErr: 12.81014 batch_time=0.36323 
Train Epoch: 18 [126/1000 4032/32000 (13%)] Loss: 0.34129 (QuantReg: 11.80877) QuantErr: 11.80877 batch_time=0.41206 
Train Epoch: 18 [131/1000 4192/32000 (13%)] Loss: 0.64734 (QuantReg: 11.68467) QuantErr: 11.68467 batch_time=0.35676 
Train Epoch: 18 [136/1000 4352/32000 (14%)] Loss: 0.79991 (QuantReg: 12.01830) QuantErr: 12.01830 batch_time=0.34920 
Train Epoch: 18 [141/1000 4512/32000 (14%)] Loss: 0.40116 (QuantReg: 12.12066) QuantErr: 12.12066 batch_time=0.44855 
Train Epoch: 18 [146/1000 4672/32000 (15%)] Loss: 0.80511 (QuantReg: 11.89537) QuantErr: 11.89537 batch_time=0.57809 
Train Epoch: 18 [151/1000 4832/32000 (15%)] Loss: 0.49488 (QuantReg: 12.02842) QuantErr: 12.02842 batch_time=0.36261 
Train Epoch: 18 [156/1000 4992/32000 (16%)] Loss: 0.44975 (QuantReg: 12.93660) QuantErr: 12.93660 batch_time=0.33890 
Train Epoch: 18 [161/1000 5152/32000 (16%)] Loss: 0.75148 (QuantReg: 12.07346) QuantErr: 12.07346 batch_time=0.37604 
Train Epoch: 18 [166/1000 5312/32000 (17%)] Loss: 0.56050 (QuantReg: 12.39745) QuantErr: 12.39745 batch_time=0.41484 
Train Epoch: 18 [171/1000 5472/32000 (17%)] Loss: 0.51410 (QuantReg: 12.06191) QuantErr: 12.06191 batch_time=0.45372 
Train Epoch: 18 [176/1000 5632/32000 (18%)] Loss: 0.20845 (QuantReg: 12.98272) QuantErr: 12.98272 batch_time=0.37467 
Train Epoch: 18 [181/1000 5792/32000 (18%)] Loss: 0.63581 (QuantReg: 12.40695) QuantErr: 12.40695 batch_time=0.39363 
Train Epoch: 18 [186/1000 5952/32000 (19%)] Loss: 0.44120 (QuantReg: 12.47864) QuantErr: 12.47864 batch_time=0.56935 
Train Epoch: 18 [191/1000 6112/32000 (19%)] Loss: 0.74771 (QuantReg: 12.84432) QuantErr: 12.84432 batch_time=0.34213 
Train Epoch: 18 [196/1000 6272/32000 (20%)] Loss: 0.54566 (QuantReg: 12.62148) QuantErr: 12.62148 batch_time=0.36592 
Train Epoch: 18 [201/1000 6432/32000 (20%)] Loss: 0.37530 (QuantReg: 12.30842) QuantErr: 12.30842 batch_time=0.34162 
Train Epoch: 18 [206/1000 6592/32000 (21%)] Loss: 0.95070 (QuantReg: 12.24936) QuantErr: 12.24936 batch_time=0.43733 
Train Epoch: 18 [211/1000 6752/32000 (21%)] Loss: 0.21163 (QuantReg: 12.84890) QuantErr: 12.84890 batch_time=0.36021 
Train Epoch: 18 [216/1000 6912/32000 (22%)] Loss: 0.54550 (QuantReg: 12.19053) QuantErr: 12.19053 batch_time=0.40969 
Train Epoch: 18 [221/1000 7072/32000 (22%)] Loss: 0.62278 (QuantReg: 12.91991) QuantErr: 12.91991 batch_time=0.35708 
Train Epoch: 18 [226/1000 7232/32000 (23%)] Loss: 0.33713 (QuantReg: 12.47657) QuantErr: 12.47657 batch_time=0.37623 
Train Epoch: 18 [231/1000 7392/32000 (23%)] Loss: 0.64887 (QuantReg: 12.19358) QuantErr: 12.19358 batch_time=0.38828 
Train Epoch: 18 [236/1000 7552/32000 (24%)] Loss: 0.42000 (QuantReg: 12.02641) QuantErr: 12.02641 batch_time=0.39504 
Train Epoch: 18 [241/1000 7712/32000 (24%)] Loss: 0.81839 (QuantReg: 12.16234) QuantErr: 12.16234 batch_time=0.35505 
Train Epoch: 18 [246/1000 7872/32000 (25%)] Loss: 0.51552 (QuantReg: 11.89769) QuantErr: 11.89769 batch_time=0.79235 
Train Epoch: 18 [251/1000 8032/32000 (25%)] Loss: 0.74617 (QuantReg: 11.88762) QuantErr: 11.88762 batch_time=0.39742 
Train Epoch: 18 [256/1000 8192/32000 (26%)] Loss: 0.59177 (QuantReg: 11.95152) QuantErr: 11.95152 batch_time=0.35790 
Train Epoch: 18 [261/1000 8352/32000 (26%)] Loss: 0.81200 (QuantReg: 12.09685) QuantErr: 12.09685 batch_time=0.38719 
Train Epoch: 18 [266/1000 8512/32000 (27%)] Loss: 0.60666 (QuantReg: 12.48430) QuantErr: 12.48430 batch_time=0.42444 
Train Epoch: 18 [271/1000 8672/32000 (27%)] Loss: 0.56591 (QuantReg: 11.99750) QuantErr: 11.99750 batch_time=0.36380 
Train Epoch: 18 [276/1000 8832/32000 (28%)] Loss: 0.41554 (QuantReg: 12.42956) QuantErr: 12.42956 batch_time=0.36545 
Train Epoch: 18 [281/1000 8992/32000 (28%)] Loss: 0.94623 (QuantReg: 12.68817) QuantErr: 12.68817 batch_time=0.55197 
Train Epoch: 18 [286/1000 9152/32000 (29%)] Loss: 0.45673 (QuantReg: 11.94961) QuantErr: 11.94961 batch_time=0.34728 
Train Epoch: 18 [291/1000 9312/32000 (29%)] Loss: 0.35706 (QuantReg: 12.69530) QuantErr: 12.69530 batch_time=0.97190 
Train Epoch: 18 [296/1000 9472/32000 (30%)] Loss: 0.56223 (QuantReg: 12.00059) QuantErr: 12.00059 batch_time=0.36205 
Train Epoch: 18 [301/1000 9632/32000 (30%)] Loss: 0.41291 (QuantReg: 12.32604) QuantErr: 12.32604 batch_time=0.34497 
Train Epoch: 18 [306/1000 9792/32000 (31%)] Loss: 0.12243 (QuantReg: 11.95748) QuantErr: 11.95748 batch_time=0.64889 
Train Epoch: 18 [311/1000 9952/32000 (31%)] Loss: 0.27943 (QuantReg: 12.89043) QuantErr: 12.89043 batch_time=0.42562 
Train Epoch: 18 [316/1000 10112/32000 (32%)] Loss: 0.46642 (QuantReg: 12.45883) QuantErr: 12.45883 batch_time=0.43271 
Train Epoch: 18 [321/1000 10272/32000 (32%)] Loss: 0.74088 (QuantReg: 12.07388) QuantErr: 12.07388 batch_time=0.45729 
Train Epoch: 18 [326/1000 10432/32000 (33%)] Loss: 0.23224 (QuantReg: 12.64256) QuantErr: 12.64256 batch_time=0.37040 
Train Epoch: 18 [331/1000 10592/32000 (33%)] Loss: 0.56993 (QuantReg: 12.23539) QuantErr: 12.23539 batch_time=0.48029 
Train Epoch: 18 [336/1000 10752/32000 (34%)] Loss: 0.75317 (QuantReg: 12.23823) QuantErr: 12.23823 batch_time=0.66055 
Train Epoch: 18 [341/1000 10912/32000 (34%)] Loss: 0.77693 (QuantReg: 12.29068) QuantErr: 12.29068 batch_time=0.62340 
Train Epoch: 18 [346/1000 11072/32000 (35%)] Loss: 0.68380 (QuantReg: 11.96597) QuantErr: 11.96597 batch_time=0.35108 
Train Epoch: 18 [351/1000 11232/32000 (35%)] Loss: 0.47273 (QuantReg: 12.71645) QuantErr: 12.71645 batch_time=0.42730 
Train Epoch: 18 [356/1000 11392/32000 (36%)] Loss: 0.26311 (QuantReg: 12.32130) QuantErr: 12.32130 batch_time=0.42584 
Train Epoch: 18 [361/1000 11552/32000 (36%)] Loss: 0.41841 (QuantReg: 12.07190) QuantErr: 12.07190 batch_time=0.49866 
Train Epoch: 18 [366/1000 11712/32000 (37%)] Loss: 0.31532 (QuantReg: 12.20497) QuantErr: 12.20497 batch_time=0.37523 
Train Epoch: 18 [371/1000 11872/32000 (37%)] Loss: 0.25739 (QuantReg: 12.52420) QuantErr: 12.52420 batch_time=0.36945 
Train Epoch: 18 [376/1000 12032/32000 (38%)] Loss: 0.72964 (QuantReg: 13.25336) QuantErr: 13.25336 batch_time=2.03703 
Train Epoch: 18 [381/1000 12192/32000 (38%)] Loss: 0.59305 (QuantReg: 12.36144) QuantErr: 12.36144 batch_time=0.38554 
Train Epoch: 18 [386/1000 12352/32000 (39%)] Loss: 0.40127 (QuantReg: 12.31839) QuantErr: 12.31839 batch_time=0.35517 
Train Epoch: 18 [391/1000 12512/32000 (39%)] Loss: 0.29711 (QuantReg: 12.75045) QuantErr: 12.75045 batch_time=0.50566 
Train Epoch: 18 [396/1000 12672/32000 (40%)] Loss: 0.67256 (QuantReg: 13.18093) QuantErr: 13.18093 batch_time=0.40501 
Train Epoch: 18 [401/1000 12832/32000 (40%)] Loss: 0.52755 (QuantReg: 12.73155) QuantErr: 12.73155 batch_time=0.38346 
Train Epoch: 18 [406/1000 12992/32000 (41%)] Loss: 0.29010 (QuantReg: 12.12754) QuantErr: 12.12754 batch_time=0.36364 
Train Epoch: 18 [411/1000 13152/32000 (41%)] Loss: 0.53391 (QuantReg: 12.74718) QuantErr: 12.74718 batch_time=0.35657 
Train Epoch: 18 [416/1000 13312/32000 (42%)] Loss: 0.32349 (QuantReg: 12.33939) QuantErr: 12.33939 batch_time=0.47849 
Train Epoch: 18 [421/1000 13472/32000 (42%)] Loss: 0.61239 (QuantReg: 11.94695) QuantErr: 11.94695 batch_time=0.42621 
Train Epoch: 18 [426/1000 13632/32000 (43%)] Loss: 0.53157 (QuantReg: 12.44661) QuantErr: 12.44661 batch_time=0.55713 
Train Epoch: 18 [431/1000 13792/32000 (43%)] Loss: 0.54535 (QuantReg: 12.67043) QuantErr: 12.67043 batch_time=0.43578 
Train Epoch: 18 [436/1000 13952/32000 (44%)] Loss: 0.65461 (QuantReg: 11.94180) QuantErr: 11.94180 batch_time=0.36281 
Train Epoch: 18 [441/1000 14112/32000 (44%)] Loss: 0.82138 (QuantReg: 12.56427) QuantErr: 12.56427 batch_time=0.35887 
Train Epoch: 18 [446/1000 14272/32000 (45%)] Loss: 0.39180 (QuantReg: 12.75357) QuantErr: 12.75357 batch_time=0.35573 
Train Epoch: 18 [451/1000 14432/32000 (45%)] Loss: 0.67428 (QuantReg: 12.90734) QuantErr: 12.90734 batch_time=0.44173 
Train Epoch: 18 [456/1000 14592/32000 (46%)] Loss: 0.55557 (QuantReg: 12.38016) QuantErr: 12.38016 batch_time=0.37413 
Train Epoch: 18 [461/1000 14752/32000 (46%)] Loss: 0.47899 (QuantReg: 11.83260) QuantErr: 11.83260 batch_time=0.42968 
Train Epoch: 18 [466/1000 14912/32000 (47%)] Loss: 0.39505 (QuantReg: 12.65324) QuantErr: 12.65324 batch_time=0.34781 
Train Epoch: 18 [471/1000 15072/32000 (47%)] Loss: 0.65298 (QuantReg: 12.55248) QuantErr: 12.55248 batch_time=0.45603 
Train Epoch: 18 [476/1000 15232/32000 (48%)] Loss: 0.34600 (QuantReg: 12.21342) QuantErr: 12.21342 batch_time=0.54550 
Train Epoch: 18 [481/1000 15392/32000 (48%)] Loss: 0.49115 (QuantReg: 12.03278) QuantErr: 12.03278 batch_time=0.42545 
Train Epoch: 18 [486/1000 15552/32000 (49%)] Loss: 0.53636 (QuantReg: 12.40856) QuantErr: 12.40856 batch_time=0.36422 
Train Epoch: 18 [491/1000 15712/32000 (49%)] Loss: 0.73493 (QuantReg: 12.40091) QuantErr: 12.40091 batch_time=0.52506 
Train Epoch: 18 [496/1000 15872/32000 (50%)] Loss: 0.37812 (QuantReg: 12.50019) QuantErr: 12.50019 batch_time=0.46520 
Train Epoch: 18 [501/1000 16032/32000 (50%)] Loss: 0.49014 (QuantReg: 12.17895) QuantErr: 12.17895 batch_time=0.36570 
Train Epoch: 18 [506/1000 16192/32000 (51%)] Loss: 0.17503 (QuantReg: 12.27378) QuantErr: 12.27378 batch_time=0.37278 
Train Epoch: 18 [511/1000 16352/32000 (51%)] Loss: 1.03275 (QuantReg: 11.67696) QuantErr: 11.67696 batch_time=0.42263 
Train Epoch: 18 [516/1000 16512/32000 (52%)] Loss: 0.21778 (QuantReg: 12.71041) QuantErr: 12.71041 batch_time=0.40923 
Train Epoch: 18 [521/1000 16672/32000 (52%)] Loss: 0.44728 (QuantReg: 13.03561) QuantErr: 13.03561 batch_time=0.48567 
Train Epoch: 18 [526/1000 16832/32000 (53%)] Loss: 0.49220 (QuantReg: 12.33490) QuantErr: 12.33490 batch_time=1.14245 
Train Epoch: 18 [531/1000 16992/32000 (53%)] Loss: 0.49666 (QuantReg: 12.57514) QuantErr: 12.57514 batch_time=0.40372 
Train Epoch: 18 [536/1000 17152/32000 (54%)] Loss: 0.53155 (QuantReg: 13.11101) QuantErr: 13.11101 batch_time=0.36553 
Train Epoch: 18 [541/1000 17312/32000 (54%)] Loss: 0.75578 (QuantReg: 12.00350) QuantErr: 12.00350 batch_time=0.35064 
Train Epoch: 18 [546/1000 17472/32000 (55%)] Loss: 0.49341 (QuantReg: 12.20093) QuantErr: 12.20093 batch_time=0.33608 
Train Epoch: 18 [551/1000 17632/32000 (55%)] Loss: 0.62179 (QuantReg: 12.51778) QuantErr: 12.51778 batch_time=0.45293 
Train Epoch: 18 [556/1000 17792/32000 (56%)] Loss: 0.34379 (QuantReg: 13.01714) QuantErr: 13.01714 batch_time=0.48385 
Train Epoch: 18 [561/1000 17952/32000 (56%)] Loss: 0.74104 (QuantReg: 12.44660) QuantErr: 12.44660 batch_time=0.34387 
Train Epoch: 18 [566/1000 18112/32000 (57%)] Loss: 0.57666 (QuantReg: 11.80425) QuantErr: 11.80425 batch_time=0.57382 
Train Epoch: 18 [571/1000 18272/32000 (57%)] Loss: 0.29617 (QuantReg: 12.76543) QuantErr: 12.76543 batch_time=0.40113 
Train Epoch: 18 [576/1000 18432/32000 (58%)] Loss: 0.44244 (QuantReg: 12.26689) QuantErr: 12.26689 batch_time=0.45052 
Train Epoch: 18 [581/1000 18592/32000 (58%)] Loss: 0.54699 (QuantReg: 12.45876) QuantErr: 12.45876 batch_time=0.66649 
Train Epoch: 18 [586/1000 18752/32000 (59%)] Loss: 0.47333 (QuantReg: 12.22437) QuantErr: 12.22437 batch_time=0.47367 
Train Epoch: 18 [591/1000 18912/32000 (59%)] Loss: 0.63458 (QuantReg: 12.08276) QuantErr: 12.08276 batch_time=0.37304 
Train Epoch: 18 [596/1000 19072/32000 (60%)] Loss: 0.47284 (QuantReg: 12.10933) QuantErr: 12.10933 batch_time=0.37955 
Train Epoch: 18 [601/1000 19232/32000 (60%)] Loss: 0.57879 (QuantReg: 12.26163) QuantErr: 12.26163 batch_time=0.35078 
Train Epoch: 18 [606/1000 19392/32000 (61%)] Loss: 0.89945 (QuantReg: 12.03668) QuantErr: 12.03668 batch_time=0.36665 
Train Epoch: 18 [611/1000 19552/32000 (61%)] Loss: 0.53551 (QuantReg: 12.61163) QuantErr: 12.61163 batch_time=0.54328 
Train Epoch: 18 [616/1000 19712/32000 (62%)] Loss: 0.25916 (QuantReg: 13.21789) QuantErr: 13.21789 batch_time=0.51656 
Train Epoch: 18 [621/1000 19872/32000 (62%)] Loss: 0.75825 (QuantReg: 12.64941) QuantErr: 12.64941 batch_time=0.43565 
Train Epoch: 18 [626/1000 20032/32000 (63%)] Loss: 0.52313 (QuantReg: 12.49343) QuantErr: 12.49343 batch_time=0.56376 
Train Epoch: 18 [631/1000 20192/32000 (63%)] Loss: 0.51593 (QuantReg: 12.15707) QuantErr: 12.15707 batch_time=0.37391 
Train Epoch: 18 [636/1000 20352/32000 (64%)] Loss: 1.09352 (QuantReg: 11.25093) QuantErr: 11.25093 batch_time=0.47335 
Train Epoch: 18 [641/1000 20512/32000 (64%)] Loss: 0.32612 (QuantReg: 12.76943) QuantErr: 12.76943 batch_time=0.37075 
Train Epoch: 18 [646/1000 20672/32000 (65%)] Loss: 0.55245 (QuantReg: 12.41496) QuantErr: 12.41496 batch_time=0.39832 
Train Epoch: 18 [651/1000 20832/32000 (65%)] Loss: 0.62140 (QuantReg: 12.38213) QuantErr: 12.38213 batch_time=0.38033 
Train Epoch: 18 [656/1000 20992/32000 (66%)] Loss: 0.84700 (QuantReg: 12.76336) QuantErr: 12.76336 batch_time=0.78370 
Train Epoch: 18 [661/1000 21152/32000 (66%)] Loss: 0.54560 (QuantReg: 12.31064) QuantErr: 12.31064 batch_time=0.41128 
Train Epoch: 18 [666/1000 21312/32000 (67%)] Loss: 0.56446 (QuantReg: 12.68212) QuantErr: 12.68212 batch_time=0.38793 
Train Epoch: 18 [671/1000 21472/32000 (67%)] Loss: 0.38520 (QuantReg: 12.07585) QuantErr: 12.07585 batch_time=0.34945 
Train Epoch: 18 [676/1000 21632/32000 (68%)] Loss: 0.35921 (QuantReg: 12.67237) QuantErr: 12.67237 batch_time=0.36776 
Train Epoch: 18 [681/1000 21792/32000 (68%)] Loss: 0.65692 (QuantReg: 12.12922) QuantErr: 12.12922 batch_time=0.40967 
Train Epoch: 18 [686/1000 21952/32000 (69%)] Loss: 0.71347 (QuantReg: 11.97656) QuantErr: 11.97656 batch_time=0.36708 
Train Epoch: 18 [691/1000 22112/32000 (69%)] Loss: 0.75547 (QuantReg: 12.84824) QuantErr: 12.84824 batch_time=0.45748 
Train Epoch: 18 [696/1000 22272/32000 (70%)] Loss: 0.47719 (QuantReg: 12.92353) QuantErr: 12.92353 batch_time=1.89691 
Train Epoch: 18 [701/1000 22432/32000 (70%)] Loss: 0.47028 (QuantReg: 12.73764) QuantErr: 12.73764 batch_time=0.67534 
Train Epoch: 18 [706/1000 22592/32000 (71%)] Loss: 0.47116 (QuantReg: 13.29325) QuantErr: 13.29325 batch_time=0.36378 
Train Epoch: 18 [711/1000 22752/32000 (71%)] Loss: 0.56854 (QuantReg: 12.42772) QuantErr: 12.42772 batch_time=0.63278 
Train Epoch: 18 [716/1000 22912/32000 (72%)] Loss: 0.50246 (QuantReg: 13.01040) QuantErr: 13.01040 batch_time=0.37860 
Train Epoch: 18 [721/1000 23072/32000 (72%)] Loss: 0.42406 (QuantReg: 12.26968) QuantErr: 12.26968 batch_time=0.44395 
Train Epoch: 18 [726/1000 23232/32000 (73%)] Loss: 0.52677 (QuantReg: 12.71629) QuantErr: 12.71629 batch_time=0.43844 
Train Epoch: 18 [731/1000 23392/32000 (73%)] Loss: 0.28719 (QuantReg: 13.12147) QuantErr: 13.12147 batch_time=0.42668 
Train Epoch: 18 [736/1000 23552/32000 (74%)] Loss: 0.49100 (QuantReg: 12.87512) QuantErr: 12.87512 batch_time=0.33750 
Train Epoch: 18 [741/1000 23712/32000 (74%)] Loss: 0.62695 (QuantReg: 11.98811) QuantErr: 11.98811 batch_time=0.34280 
Train Epoch: 18 [746/1000 23872/32000 (75%)] Loss: 0.38786 (QuantReg: 12.73290) QuantErr: 12.73290 batch_time=0.38879 
Train Epoch: 18 [751/1000 24032/32000 (75%)] Loss: 0.59662 (QuantReg: 12.07208) QuantErr: 12.07208 batch_time=0.61925 
Train Epoch: 18 [756/1000 24192/32000 (76%)] Loss: 0.39084 (QuantReg: 12.59613) QuantErr: 12.59613 batch_time=0.45416 
Train Epoch: 18 [761/1000 24352/32000 (76%)] Loss: 0.83821 (QuantReg: 11.67325) QuantErr: 11.67325 batch_time=0.35409 
Train Epoch: 18 [766/1000 24512/32000 (77%)] Loss: 0.31115 (QuantReg: 12.67489) QuantErr: 12.67489 batch_time=0.36045 
Train Epoch: 18 [771/1000 24672/32000 (77%)] Loss: 0.51445 (QuantReg: 11.91944) QuantErr: 11.91944 batch_time=0.44329 
Train Epoch: 18 [776/1000 24832/32000 (78%)] Loss: 0.29873 (QuantReg: 12.86458) QuantErr: 12.86458 batch_time=0.38006 
Train Epoch: 18 [781/1000 24992/32000 (78%)] Loss: 0.47930 (QuantReg: 11.85917) QuantErr: 11.85917 batch_time=0.36458 
Train Epoch: 18 [786/1000 25152/32000 (79%)] Loss: 0.73521 (QuantReg: 12.82497) QuantErr: 12.82497 batch_time=0.45155 
Train Epoch: 18 [791/1000 25312/32000 (79%)] Loss: 0.53842 (QuantReg: 12.72743) QuantErr: 12.72743 batch_time=0.34441 
Train Epoch: 18 [796/1000 25472/32000 (80%)] Loss: 0.37592 (QuantReg: 12.80202) QuantErr: 12.80202 batch_time=0.54242 
Train Epoch: 18 [801/1000 25632/32000 (80%)] Loss: 0.38971 (QuantReg: 12.77142) QuantErr: 12.77142 batch_time=0.39021 
Train Epoch: 18 [806/1000 25792/32000 (81%)] Loss: 0.21407 (QuantReg: 12.85444) QuantErr: 12.85444 batch_time=0.34735 
Train Epoch: 18 [811/1000 25952/32000 (81%)] Loss: 0.85842 (QuantReg: 12.63379) QuantErr: 12.63379 batch_time=0.45182 
Train Epoch: 18 [816/1000 26112/32000 (82%)] Loss: 0.57076 (QuantReg: 11.90999) QuantErr: 11.90999 batch_time=0.45480 
Train Epoch: 18 [821/1000 26272/32000 (82%)] Loss: 0.53958 (QuantReg: 11.99808) QuantErr: 11.99808 batch_time=0.35832 
Train Epoch: 18 [826/1000 26432/32000 (83%)] Loss: 0.54897 (QuantReg: 12.41615) QuantErr: 12.41615 batch_time=0.48264 
Train Epoch: 18 [831/1000 26592/32000 (83%)] Loss: 0.42767 (QuantReg: 12.57309) QuantErr: 12.57309 batch_time=0.41088 
Train Epoch: 18 [836/1000 26752/32000 (84%)] Loss: 0.51578 (QuantReg: 13.17752) QuantErr: 13.17752 batch_time=0.57585 
Train Epoch: 18 [841/1000 26912/32000 (84%)] Loss: 0.48703 (QuantReg: 12.44224) QuantErr: 12.44224 batch_time=0.35449 
Train Epoch: 18 [846/1000 27072/32000 (85%)] Loss: 0.50437 (QuantReg: 12.71995) QuantErr: 12.71995 batch_time=0.65773 
Train Epoch: 18 [851/1000 27232/32000 (85%)] Loss: 0.18679 (QuantReg: 12.66669) QuantErr: 12.66669 batch_time=0.76307 
Train Epoch: 18 [856/1000 27392/32000 (86%)] Loss: 0.45937 (QuantReg: 13.17462) QuantErr: 13.17462 batch_time=0.34696 
Train Epoch: 18 [861/1000 27552/32000 (86%)] Loss: 0.44838 (QuantReg: 12.53385) QuantErr: 12.53385 batch_time=0.34104 
Train Epoch: 18 [866/1000 27712/32000 (87%)] Loss: 0.47601 (QuantReg: 12.49817) QuantErr: 12.49817 batch_time=0.42927 
Train Epoch: 18 [871/1000 27872/32000 (87%)] Loss: 0.39170 (QuantReg: 12.15341) QuantErr: 12.15341 batch_time=0.39579 
Train Epoch: 18 [876/1000 28032/32000 (88%)] Loss: 0.69224 (QuantReg: 11.91295) QuantErr: 11.91295 batch_time=0.40287 
Train Epoch: 18 [881/1000 28192/32000 (88%)] Loss: 0.23977 (QuantReg: 12.34220) QuantErr: 12.34220 batch_time=0.39595 
Train Epoch: 18 [886/1000 28352/32000 (89%)] Loss: 0.58178 (QuantReg: 12.55338) QuantErr: 12.55338 batch_time=0.35913 
Train Epoch: 18 [891/1000 28512/32000 (89%)] Loss: 0.69692 (QuantReg: 12.84105) QuantErr: 12.84105 batch_time=0.58068 
Train Epoch: 18 [896/1000 28672/32000 (90%)] Loss: 0.43448 (QuantReg: 12.05629) QuantErr: 12.05629 batch_time=0.37661 
Train Epoch: 18 [901/1000 28832/32000 (90%)] Loss: 0.94264 (QuantReg: 12.67850) QuantErr: 12.67850 batch_time=0.68617 
Train Epoch: 18 [906/1000 28992/32000 (91%)] Loss: 0.28869 (QuantReg: 12.94091) QuantErr: 12.94091 batch_time=0.50026 
Train Epoch: 18 [911/1000 29152/32000 (91%)] Loss: 0.39127 (QuantReg: 12.75283) QuantErr: 12.75283 batch_time=0.37334 
Train Epoch: 18 [916/1000 29312/32000 (92%)] Loss: 0.48163 (QuantReg: 12.20934) QuantErr: 12.20934 batch_time=0.38120 
Train Epoch: 18 [921/1000 29472/32000 (92%)] Loss: 0.44589 (QuantReg: 12.62216) QuantErr: 12.62216 batch_time=0.35019 
Train Epoch: 18 [926/1000 29632/32000 (93%)] Loss: 0.33043 (QuantReg: 12.87230) QuantErr: 12.87230 batch_time=0.36299 
Train Epoch: 18 [931/1000 29792/32000 (93%)] Loss: 0.19296 (QuantReg: 12.51583) QuantErr: 12.51583 batch_time=0.59908 
Train Epoch: 18 [936/1000 29952/32000 (94%)] Loss: 0.32778 (QuantReg: 13.58058) QuantErr: 13.58058 batch_time=0.36196 
Train Epoch: 18 [941/1000 30112/32000 (94%)] Loss: 0.65599 (QuantReg: 12.54618) QuantErr: 12.54618 batch_time=0.44410 
Train Epoch: 18 [946/1000 30272/32000 (95%)] Loss: 0.24368 (QuantReg: 12.93983) QuantErr: 12.93983 batch_time=0.35378 
Train Epoch: 18 [951/1000 30432/32000 (95%)] Loss: 0.71285 (QuantReg: 12.23433) QuantErr: 12.23433 batch_time=0.47366 
Train Epoch: 18 [956/1000 30592/32000 (96%)] Loss: 0.40217 (QuantReg: 13.40234) QuantErr: 13.40234 batch_time=0.43228 
Train Epoch: 18 [961/1000 30752/32000 (96%)] Loss: 0.37632 (QuantReg: 12.73956) QuantErr: 12.73956 batch_time=0.95080 
Train Epoch: 18 [966/1000 30912/32000 (97%)] Loss: 0.29742 (QuantReg: 12.52737) QuantErr: 12.52737 batch_time=0.37196 
Train Epoch: 18 [971/1000 31072/32000 (97%)] Loss: 0.28343 (QuantReg: 12.46721) QuantErr: 12.46721 batch_time=0.35377 
Train Epoch: 18 [976/1000 31232/32000 (98%)] Loss: 0.15042 (QuantReg: 12.80130) QuantErr: 12.80130 batch_time=0.37858 
Train Epoch: 18 [981/1000 31392/32000 (98%)] Loss: 0.43226 (QuantReg: 12.65087) QuantErr: 12.65087 batch_time=0.47024 
Train Epoch: 18 [986/1000 31552/32000 (99%)] Loss: 0.17361 (QuantReg: 12.39333) QuantErr: 12.39333 batch_time=0.77474 
Train Epoch: 18 [991/1000 31712/32000 (99%)] Loss: 0.96276 (QuantReg: 12.06299) QuantErr: 12.06299 batch_time=0.35146 
Train Epoch: 18 [996/1000 31872/32000 (100%)] Loss: 0.16693 (QuantReg: 12.82050) QuantErr: 12.82050 batch_time=0.42455 
Train Epoch: 18 codebook_update_time=1.91742
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch18.pth ...
Done in 6.529s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch18.pth ...
Done in 11.699s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 0.5199198004454374
 quant_reg      : 12.431202806472779
 quant_err      : 12.431202806472779
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 18000
 MSRVTT_miech_test/t2v_metrics/R1: 19.1
 MSRVTT_miech_test/t2v_metrics/R5: 47.5
 MSRVTT_miech_test/t2v_metrics/R10: 61.4
 MSRVTT_miech_test/t2v_metrics/R50: 89.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.296
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.191359302198194
 MSRVTT_miech_test/v2t_metrics/R1: 18.2
 MSRVTT_miech_test/v2t_metrics/R5: 48.0
 MSRVTT_miech_test/v2t_metrics/R10: 61.8
 MSRVTT_miech_test/v2t_metrics/R50: 89.7
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 24.492
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.794943474115755
 mnt_best       : 38.191359302198194
 not_improved_count: 0
Train Epoch: 19 [1/1000 32/32000 (0%)] Loss: 0.40248 (QuantReg: 11.48901) QuantErr: 11.48901 batch_time=32.64521 
Train Epoch: 19 [6/1000 192/32000 (1%)] Loss: 0.45685 (QuantReg: 12.47972) QuantErr: 12.47972 batch_time=0.34512 
Train Epoch: 19 [11/1000 352/32000 (1%)] Loss: 0.36035 (QuantReg: 12.91194) QuantErr: 12.91194 batch_time=0.49137 
Train Epoch: 19 [16/1000 512/32000 (2%)] Loss: 0.67807 (QuantReg: 11.80956) QuantErr: 11.80956 batch_time=0.38684 
Train Epoch: 19 [21/1000 672/32000 (2%)] Loss: 0.26715 (QuantReg: 12.38107) QuantErr: 12.38107 batch_time=0.34726 
Train Epoch: 19 [26/1000 832/32000 (3%)] Loss: 0.33528 (QuantReg: 12.36205) QuantErr: 12.36205 batch_time=0.36173 
Train Epoch: 19 [31/1000 992/32000 (3%)] Loss: 0.82518 (QuantReg: 12.71139) QuantErr: 12.71139 batch_time=0.33272 
Train Epoch: 19 [36/1000 1152/32000 (4%)] Loss: 0.11601 (QuantReg: 12.35189) QuantErr: 12.35189 batch_time=0.35490 
Train Epoch: 19 [41/1000 1312/32000 (4%)] Loss: 0.74794 (QuantReg: 11.49969) QuantErr: 11.49969 batch_time=0.71438 
Train Epoch: 19 [46/1000 1472/32000 (5%)] Loss: 0.24255 (QuantReg: 12.61261) QuantErr: 12.61261 batch_time=0.53212 
Train Epoch: 19 [51/1000 1632/32000 (5%)] Loss: 0.81921 (QuantReg: 11.35175) QuantErr: 11.35175 batch_time=0.40902 
Train Epoch: 19 [56/1000 1792/32000 (6%)] Loss: 0.43439 (QuantReg: 12.65950) QuantErr: 12.65950 batch_time=0.46506 
Train Epoch: 19 [61/1000 1952/32000 (6%)] Loss: 0.31031 (QuantReg: 12.45370) QuantErr: 12.45370 batch_time=0.38709 
Train Epoch: 19 [66/1000 2112/32000 (7%)] Loss: 0.36060 (QuantReg: 12.74052) QuantErr: 12.74052 batch_time=0.35579 
Train Epoch: 19 [71/1000 2272/32000 (7%)] Loss: 0.64085 (QuantReg: 12.41397) QuantErr: 12.41397 batch_time=0.35874 
Train Epoch: 19 [76/1000 2432/32000 (8%)] Loss: 0.65937 (QuantReg: 11.82164) QuantErr: 11.82164 batch_time=0.38725 
Train Epoch: 19 [81/1000 2592/32000 (8%)] Loss: 0.40019 (QuantReg: 11.56075) QuantErr: 11.56075 batch_time=0.37896 
Train Epoch: 19 [86/1000 2752/32000 (9%)] Loss: 0.40426 (QuantReg: 11.87512) QuantErr: 11.87512 batch_time=0.41545 
Train Epoch: 19 [91/1000 2912/32000 (9%)] Loss: 0.64583 (QuantReg: 10.81963) QuantErr: 10.81963 batch_time=0.72694 
Train Epoch: 19 [96/1000 3072/32000 (10%)] Loss: 0.30754 (QuantReg: 12.71871) QuantErr: 12.71871 batch_time=2.27260 
Train Epoch: 19 [101/1000 3232/32000 (10%)] Loss: 0.61648 (QuantReg: 11.87110) QuantErr: 11.87110 batch_time=0.40619 
Train Epoch: 19 [106/1000 3392/32000 (11%)] Loss: 0.90651 (QuantReg: 12.48543) QuantErr: 12.48543 batch_time=0.42702 
Train Epoch: 19 [111/1000 3552/32000 (11%)] Loss: 0.87930 (QuantReg: 11.82215) QuantErr: 11.82215 batch_time=0.36744 
Train Epoch: 19 [116/1000 3712/32000 (12%)] Loss: 0.48195 (QuantReg: 12.63844) QuantErr: 12.63844 batch_time=0.39805 
Train Epoch: 19 [121/1000 3872/32000 (12%)] Loss: 0.77760 (QuantReg: 12.55037) QuantErr: 12.55037 batch_time=0.36942 
Train Epoch: 19 [126/1000 4032/32000 (13%)] Loss: 0.32853 (QuantReg: 13.14302) QuantErr: 13.14302 batch_time=0.35813 
Train Epoch: 19 [131/1000 4192/32000 (13%)] Loss: 0.60737 (QuantReg: 12.69064) QuantErr: 12.69064 batch_time=0.59740 
Train Epoch: 19 [136/1000 4352/32000 (14%)] Loss: 0.31027 (QuantReg: 12.45479) QuantErr: 12.45479 batch_time=0.62817 
Train Epoch: 19 [141/1000 4512/32000 (14%)] Loss: 0.41312 (QuantReg: 12.62041) QuantErr: 12.62041 batch_time=0.33285 
Train Epoch: 19 [146/1000 4672/32000 (15%)] Loss: 0.42551 (QuantReg: 12.57628) QuantErr: 12.57628 batch_time=0.42442 
Train Epoch: 19 [151/1000 4832/32000 (15%)] Loss: 0.39519 (QuantReg: 12.52292) QuantErr: 12.52292 batch_time=0.39004 
Train Epoch: 19 [156/1000 4992/32000 (16%)] Loss: 0.57275 (QuantReg: 12.66912) QuantErr: 12.66912 batch_time=0.47505 
Train Epoch: 19 [161/1000 5152/32000 (16%)] Loss: 0.45909 (QuantReg: 12.30007) QuantErr: 12.30007 batch_time=0.35975 
Train Epoch: 19 [166/1000 5312/32000 (17%)] Loss: 0.69984 (QuantReg: 12.57239) QuantErr: 12.57239 batch_time=0.39682 
Train Epoch: 19 [171/1000 5472/32000 (17%)] Loss: 0.43279 (QuantReg: 12.78100) QuantErr: 12.78100 batch_time=0.46893 
Train Epoch: 19 [176/1000 5632/32000 (18%)] Loss: 0.53237 (QuantReg: 12.11541) QuantErr: 12.11541 batch_time=0.39084 
Train Epoch: 19 [181/1000 5792/32000 (18%)] Loss: 0.48059 (QuantReg: 13.10656) QuantErr: 13.10656 batch_time=0.32954 
Train Epoch: 19 [186/1000 5952/32000 (19%)] Loss: 0.40522 (QuantReg: 12.25036) QuantErr: 12.25036 batch_time=0.70072 
Train Epoch: 19 [191/1000 6112/32000 (19%)] Loss: 0.81107 (QuantReg: 12.09098) QuantErr: 12.09098 batch_time=0.33469 
Train Epoch: 19 [196/1000 6272/32000 (20%)] Loss: 0.52350 (QuantReg: 12.48090) QuantErr: 12.48090 batch_time=0.37730 
Train Epoch: 19 [201/1000 6432/32000 (20%)] Loss: 0.41721 (QuantReg: 12.60204) QuantErr: 12.60204 batch_time=0.33639 
Train Epoch: 19 [206/1000 6592/32000 (21%)] Loss: 0.48683 (QuantReg: 12.81291) QuantErr: 12.81291 batch_time=0.36571 
Train Epoch: 19 [211/1000 6752/32000 (21%)] Loss: 0.30310 (QuantReg: 12.75263) QuantErr: 12.75263 batch_time=0.41674 
Train Epoch: 19 [216/1000 6912/32000 (22%)] Loss: 0.39873 (QuantReg: 13.35796) QuantErr: 13.35796 batch_time=0.37320 
Train Epoch: 19 [221/1000 7072/32000 (22%)] Loss: 0.60564 (QuantReg: 12.24413) QuantErr: 12.24413 batch_time=0.38108 
Train Epoch: 19 [226/1000 7232/32000 (23%)] Loss: 0.28392 (QuantReg: 12.77830) QuantErr: 12.77830 batch_time=0.34237 
Train Epoch: 19 [231/1000 7392/32000 (23%)] Loss: 0.51187 (QuantReg: 12.02643) QuantErr: 12.02643 batch_time=0.71303 
Train Epoch: 19 [236/1000 7552/32000 (24%)] Loss: 0.30680 (QuantReg: 12.54769) QuantErr: 12.54769 batch_time=0.45426 
Train Epoch: 19 [241/1000 7712/32000 (24%)] Loss: 0.60838 (QuantReg: 12.37361) QuantErr: 12.37361 batch_time=0.46032 
Train Epoch: 19 [246/1000 7872/32000 (25%)] Loss: 0.32035 (QuantReg: 12.35083) QuantErr: 12.35083 batch_time=0.34823 
Train Epoch: 19 [251/1000 8032/32000 (25%)] Loss: 0.78380 (QuantReg: 11.93705) QuantErr: 11.93705 batch_time=0.37649 
Train Epoch: 19 [256/1000 8192/32000 (26%)] Loss: 0.60377 (QuantReg: 13.10341) QuantErr: 13.10341 batch_time=0.46174 
Train Epoch: 19 [261/1000 8352/32000 (26%)] Loss: 0.52941 (QuantReg: 11.73067) QuantErr: 11.73067 batch_time=0.43696 
Train Epoch: 19 [266/1000 8512/32000 (27%)] Loss: 0.23905 (QuantReg: 12.65092) QuantErr: 12.65092 batch_time=0.44392 
Train Epoch: 19 [271/1000 8672/32000 (27%)] Loss: 1.03956 (QuantReg: 12.41418) QuantErr: 12.41418 batch_time=0.39773 
Train Epoch: 19 [276/1000 8832/32000 (28%)] Loss: 0.34626 (QuantReg: 12.74719) QuantErr: 12.74719 batch_time=0.35943 
Train Epoch: 19 [281/1000 8992/32000 (28%)] Loss: 0.39339 (QuantReg: 12.81608) QuantErr: 12.81608 batch_time=0.55474 
Train Epoch: 19 [286/1000 9152/32000 (29%)] Loss: 0.53931 (QuantReg: 12.50737) QuantErr: 12.50737 batch_time=0.34841 
Train Epoch: 19 [291/1000 9312/32000 (29%)] Loss: 0.26419 (QuantReg: 12.71470) QuantErr: 12.71470 batch_time=0.53807 
Train Epoch: 19 [296/1000 9472/32000 (30%)] Loss: 0.34116 (QuantReg: 12.87176) QuantErr: 12.87176 batch_time=0.41161 
Train Epoch: 19 [301/1000 9632/32000 (30%)] Loss: 0.91708 (QuantReg: 11.69386) QuantErr: 11.69386 batch_time=0.36004 
Train Epoch: 19 [306/1000 9792/32000 (31%)] Loss: 0.45942 (QuantReg: 12.26922) QuantErr: 12.26922 batch_time=0.43286 
Train Epoch: 19 [311/1000 9952/32000 (31%)] Loss: 0.55422 (QuantReg: 12.30595) QuantErr: 12.30595 batch_time=0.40204 
Train Epoch: 19 [316/1000 10112/32000 (32%)] Loss: 0.41555 (QuantReg: 12.58915) QuantErr: 12.58915 batch_time=0.36260 
Train Epoch: 19 [321/1000 10272/32000 (32%)] Loss: 0.60533 (QuantReg: 11.78603) QuantErr: 11.78603 batch_time=1.32843 
Train Epoch: 19 [326/1000 10432/32000 (33%)] Loss: 0.38817 (QuantReg: 12.45021) QuantErr: 12.45021 batch_time=0.60959 
Train Epoch: 19 [331/1000 10592/32000 (33%)] Loss: 0.28144 (QuantReg: 13.20285) QuantErr: 13.20285 batch_time=0.35226 
Train Epoch: 19 [336/1000 10752/32000 (34%)] Loss: 0.56571 (QuantReg: 12.61468) QuantErr: 12.61468 batch_time=0.33674 
Train Epoch: 19 [341/1000 10912/32000 (34%)] Loss: 0.38619 (QuantReg: 12.37042) QuantErr: 12.37042 batch_time=0.46020 
Train Epoch: 19 [346/1000 11072/32000 (35%)] Loss: 0.27474 (QuantReg: 11.90958) QuantErr: 11.90958 batch_time=0.35159 
Train Epoch: 19 [351/1000 11232/32000 (35%)] Loss: 0.43376 (QuantReg: 12.34700) QuantErr: 12.34700 batch_time=0.44202 
Train Epoch: 19 [356/1000 11392/32000 (36%)] Loss: 0.57671 (QuantReg: 11.99481) QuantErr: 11.99481 batch_time=0.57099 
Train Epoch: 19 [361/1000 11552/32000 (36%)] Loss: 0.44367 (QuantReg: 11.57892) QuantErr: 11.57892 batch_time=0.59704 
Train Epoch: 19 [366/1000 11712/32000 (37%)] Loss: 1.05694 (QuantReg: 12.83826) QuantErr: 12.83826 batch_time=0.36187 
Train Epoch: 19 [371/1000 11872/32000 (37%)] Loss: 0.68099 (QuantReg: 12.86688) QuantErr: 12.86688 batch_time=0.36061 
Train Epoch: 19 [376/1000 12032/32000 (38%)] Loss: 0.19499 (QuantReg: 12.91491) QuantErr: 12.91491 batch_time=0.74587 
Train Epoch: 19 [381/1000 12192/32000 (38%)] Loss: 0.56248 (QuantReg: 12.30642) QuantErr: 12.30642 batch_time=0.71489 
Train Epoch: 19 [386/1000 12352/32000 (39%)] Loss: 0.87341 (QuantReg: 12.50363) QuantErr: 12.50363 batch_time=0.77034 
Train Epoch: 19 [391/1000 12512/32000 (39%)] Loss: 0.50361 (QuantReg: 12.73063) QuantErr: 12.73063 batch_time=0.35215 
Train Epoch: 19 [396/1000 12672/32000 (40%)] Loss: 0.49181 (QuantReg: 12.72370) QuantErr: 12.72370 batch_time=0.36126 
Train Epoch: 19 [401/1000 12832/32000 (40%)] Loss: 0.45077 (QuantReg: 12.63445) QuantErr: 12.63445 batch_time=0.39732 
Train Epoch: 19 [406/1000 12992/32000 (41%)] Loss: 0.79386 (QuantReg: 12.73781) QuantErr: 12.73781 batch_time=0.37352 
Train Epoch: 19 [411/1000 13152/32000 (41%)] Loss: 0.53830 (QuantReg: 12.20839) QuantErr: 12.20839 batch_time=0.46257 
Train Epoch: 19 [416/1000 13312/32000 (42%)] Loss: 0.55925 (QuantReg: 11.74811) QuantErr: 11.74811 batch_time=0.52870 
Train Epoch: 19 [421/1000 13472/32000 (42%)] Loss: 0.62421 (QuantReg: 12.80266) QuantErr: 12.80266 batch_time=0.80446 
Train Epoch: 19 [426/1000 13632/32000 (43%)] Loss: 0.24936 (QuantReg: 11.96537) QuantErr: 11.96537 batch_time=0.55082 
Train Epoch: 19 [431/1000 13792/32000 (43%)] Loss: 0.39603 (QuantReg: 11.93976) QuantErr: 11.93976 batch_time=0.45223 
Train Epoch: 19 [436/1000 13952/32000 (44%)] Loss: 0.85548 (QuantReg: 12.16185) QuantErr: 12.16185 batch_time=0.40134 
Train Epoch: 19 [441/1000 14112/32000 (44%)] Loss: 0.81100 (QuantReg: 11.93351) QuantErr: 11.93351 batch_time=0.34938 
Train Epoch: 19 [446/1000 14272/32000 (45%)] Loss: 0.72573 (QuantReg: 12.13638) QuantErr: 12.13638 batch_time=0.53738 
Train Epoch: 19 [451/1000 14432/32000 (45%)] Loss: 0.19591 (QuantReg: 11.85562) QuantErr: 11.85562 batch_time=0.37239 
Train Epoch: 19 [456/1000 14592/32000 (46%)] Loss: 0.28673 (QuantReg: 12.34368) QuantErr: 12.34368 batch_time=0.95822 
Train Epoch: 19 [461/1000 14752/32000 (46%)] Loss: 0.38127 (QuantReg: 12.87269) QuantErr: 12.87269 batch_time=0.36083 
Train Epoch: 19 [466/1000 14912/32000 (47%)] Loss: 0.43595 (QuantReg: 12.10306) QuantErr: 12.10306 batch_time=1.13340 
Train Epoch: 19 [471/1000 15072/32000 (47%)] Loss: 0.45923 (QuantReg: 13.10534) QuantErr: 13.10534 batch_time=0.38559 
Train Epoch: 19 [476/1000 15232/32000 (48%)] Loss: 0.20388 (QuantReg: 12.78972) QuantErr: 12.78972 batch_time=0.35902 
Train Epoch: 19 [481/1000 15392/32000 (48%)] Loss: 0.55745 (QuantReg: 12.43670) QuantErr: 12.43670 batch_time=0.45087 
Train Epoch: 19 [486/1000 15552/32000 (49%)] Loss: 0.42070 (QuantReg: 11.84481) QuantErr: 11.84481 batch_time=0.42633 
Train Epoch: 19 [491/1000 15712/32000 (49%)] Loss: 0.23209 (QuantReg: 12.98433) QuantErr: 12.98433 batch_time=0.36351 
Train Epoch: 19 [496/1000 15872/32000 (50%)] Loss: 0.41974 (QuantReg: 12.51639) QuantErr: 12.51639 batch_time=0.38375 
Train Epoch: 19 [501/1000 16032/32000 (50%)] Loss: 0.56234 (QuantReg: 11.76482) QuantErr: 11.76482 batch_time=0.38288 
Train Epoch: 19 [506/1000 16192/32000 (51%)] Loss: 0.49683 (QuantReg: 12.26809) QuantErr: 12.26809 batch_time=0.45855 
Train Epoch: 19 [511/1000 16352/32000 (51%)] Loss: 0.41466 (QuantReg: 12.63684) QuantErr: 12.63684 batch_time=0.46105 
Train Epoch: 19 [516/1000 16512/32000 (52%)] Loss: 0.54530 (QuantReg: 12.31664) QuantErr: 12.31664 batch_time=0.38743 
Train Epoch: 19 [521/1000 16672/32000 (52%)] Loss: 0.44270 (QuantReg: 12.66353) QuantErr: 12.66353 batch_time=0.37868 
Train Epoch: 19 [526/1000 16832/32000 (53%)] Loss: 0.54047 (QuantReg: 12.51195) QuantErr: 12.51195 batch_time=0.36456 
Train Epoch: 19 [531/1000 16992/32000 (53%)] Loss: 0.61293 (QuantReg: 12.39535) QuantErr: 12.39535 batch_time=0.43426 
Train Epoch: 19 [536/1000 17152/32000 (54%)] Loss: 0.07534 (QuantReg: 12.72034) QuantErr: 12.72034 batch_time=0.36987 
Train Epoch: 19 [541/1000 17312/32000 (54%)] Loss: 0.29418 (QuantReg: 11.87056) QuantErr: 11.87056 batch_time=0.46674 
Train Epoch: 19 [546/1000 17472/32000 (55%)] Loss: 0.38608 (QuantReg: 13.23794) QuantErr: 13.23794 batch_time=0.47043 
Train Epoch: 19 [551/1000 17632/32000 (55%)] Loss: 0.36614 (QuantReg: 12.81223) QuantErr: 12.81223 batch_time=0.34577 
Train Epoch: 19 [556/1000 17792/32000 (56%)] Loss: 0.35514 (QuantReg: 12.54464) QuantErr: 12.54464 batch_time=0.83727 
Train Epoch: 19 [561/1000 17952/32000 (56%)] Loss: 0.34613 (QuantReg: 12.14251) QuantErr: 12.14251 batch_time=0.34931 
Train Epoch: 19 [566/1000 18112/32000 (57%)] Loss: 0.14794 (QuantReg: 12.93743) QuantErr: 12.93743 batch_time=0.55683 
Train Epoch: 19 [571/1000 18272/32000 (57%)] Loss: 0.56286 (QuantReg: 13.14600) QuantErr: 13.14600 batch_time=0.39746 
Train Epoch: 19 [576/1000 18432/32000 (58%)] Loss: 0.53087 (QuantReg: 13.09501) QuantErr: 13.09501 batch_time=0.47400 
Train Epoch: 19 [581/1000 18592/32000 (58%)] Loss: 0.41928 (QuantReg: 12.72420) QuantErr: 12.72420 batch_time=0.39322 
Train Epoch: 19 [586/1000 18752/32000 (59%)] Loss: 0.54312 (QuantReg: 12.40226) QuantErr: 12.40226 batch_time=0.41890 
Train Epoch: 19 [591/1000 18912/32000 (59%)] Loss: 0.61761 (QuantReg: 12.08951) QuantErr: 12.08951 batch_time=0.40593 
Train Epoch: 19 [596/1000 19072/32000 (60%)] Loss: 0.27272 (QuantReg: 13.36466) QuantErr: 13.36466 batch_time=0.47535 
Train Epoch: 19 [601/1000 19232/32000 (60%)] Loss: 0.26279 (QuantReg: 12.72408) QuantErr: 12.72408 batch_time=0.52207 
Train Epoch: 19 [606/1000 19392/32000 (61%)] Loss: 0.58107 (QuantReg: 11.52430) QuantErr: 11.52430 batch_time=0.39083 
Train Epoch: 19 [611/1000 19552/32000 (61%)] Loss: 0.56608 (QuantReg: 11.86329) QuantErr: 11.86329 batch_time=0.41862 
Train Epoch: 19 [616/1000 19712/32000 (62%)] Loss: 0.32933 (QuantReg: 12.45472) QuantErr: 12.45472 batch_time=0.36813 
Train Epoch: 19 [621/1000 19872/32000 (62%)] Loss: 0.51691 (QuantReg: 12.45032) QuantErr: 12.45032 batch_time=0.39254 
Train Epoch: 19 [626/1000 20032/32000 (63%)] Loss: 0.34279 (QuantReg: 12.28491) QuantErr: 12.28491 batch_time=0.35052 
Train Epoch: 19 [631/1000 20192/32000 (63%)] Loss: 0.85021 (QuantReg: 12.32943) QuantErr: 12.32943 batch_time=0.36438 
Train Epoch: 19 [636/1000 20352/32000 (64%)] Loss: 0.39122 (QuantReg: 13.29594) QuantErr: 13.29594 batch_time=0.34792 
Train Epoch: 19 [641/1000 20512/32000 (64%)] Loss: 0.24218 (QuantReg: 13.06801) QuantErr: 13.06801 batch_time=1.38165 
Train Epoch: 19 [646/1000 20672/32000 (65%)] Loss: 0.32833 (QuantReg: 12.78291) QuantErr: 12.78291 batch_time=0.71589 
Train Epoch: 19 [651/1000 20832/32000 (65%)] Loss: 0.33584 (QuantReg: 12.37801) QuantErr: 12.37801 batch_time=0.39146 
Train Epoch: 19 [656/1000 20992/32000 (66%)] Loss: 0.69799 (QuantReg: 11.58880) QuantErr: 11.58880 batch_time=0.39427 
Train Epoch: 19 [661/1000 21152/32000 (66%)] Loss: 0.64659 (QuantReg: 12.67895) QuantErr: 12.67895 batch_time=0.41196 
Train Epoch: 19 [666/1000 21312/32000 (67%)] Loss: 0.59953 (QuantReg: 12.73337) QuantErr: 12.73337 batch_time=0.37504 
Train Epoch: 19 [671/1000 21472/32000 (67%)] Loss: 0.23828 (QuantReg: 12.36814) QuantErr: 12.36814 batch_time=0.40931 
Train Epoch: 19 [676/1000 21632/32000 (68%)] Loss: 0.72443 (QuantReg: 12.32044) QuantErr: 12.32044 batch_time=0.36304 
Train Epoch: 19 [681/1000 21792/32000 (68%)] Loss: 0.59796 (QuantReg: 11.99201) QuantErr: 11.99201 batch_time=0.65330 
Train Epoch: 19 [686/1000 21952/32000 (69%)] Loss: 1.09045 (QuantReg: 12.18660) QuantErr: 12.18660 batch_time=0.36200 
Train Epoch: 19 [691/1000 22112/32000 (69%)] Loss: 0.66475 (QuantReg: 12.65464) QuantErr: 12.65464 batch_time=0.82630 
Train Epoch: 19 [696/1000 22272/32000 (70%)] Loss: 0.24779 (QuantReg: 13.43894) QuantErr: 13.43894 batch_time=0.35140 
Train Epoch: 19 [701/1000 22432/32000 (70%)] Loss: 0.53473 (QuantReg: 12.25189) QuantErr: 12.25189 batch_time=0.72910 
Train Epoch: 19 [706/1000 22592/32000 (71%)] Loss: 0.38081 (QuantReg: 11.94327) QuantErr: 11.94327 batch_time=0.40754 
Train Epoch: 19 [711/1000 22752/32000 (71%)] Loss: 0.43418 (QuantReg: 12.45605) QuantErr: 12.45605 batch_time=0.54343 
Train Epoch: 19 [716/1000 22912/32000 (72%)] Loss: 0.68975 (QuantReg: 12.16250) QuantErr: 12.16250 batch_time=0.33797 
Train Epoch: 19 [721/1000 23072/32000 (72%)] Loss: 0.40485 (QuantReg: 13.22729) QuantErr: 13.22729 batch_time=0.33828 
Train Epoch: 19 [726/1000 23232/32000 (73%)] Loss: 0.17454 (QuantReg: 12.72157) QuantErr: 12.72157 batch_time=0.36925 
Train Epoch: 19 [731/1000 23392/32000 (73%)] Loss: 0.93466 (QuantReg: 12.88113) QuantErr: 12.88113 batch_time=0.35042 
Train Epoch: 19 [736/1000 23552/32000 (74%)] Loss: 0.51442 (QuantReg: 12.16550) QuantErr: 12.16550 batch_time=0.92390 
Train Epoch: 19 [741/1000 23712/32000 (74%)] Loss: 0.15742 (QuantReg: 12.80266) QuantErr: 12.80266 batch_time=0.35920 
Train Epoch: 19 [746/1000 23872/32000 (75%)] Loss: 0.58437 (QuantReg: 13.12588) QuantErr: 13.12588 batch_time=0.39071 
Train Epoch: 19 [751/1000 24032/32000 (75%)] Loss: 0.41605 (QuantReg: 13.23214) QuantErr: 13.23214 batch_time=0.46612 
Train Epoch: 19 [756/1000 24192/32000 (76%)] Loss: 0.23753 (QuantReg: 12.44657) QuantErr: 12.44657 batch_time=0.36160 
Train Epoch: 19 [761/1000 24352/32000 (76%)] Loss: 0.68954 (QuantReg: 12.78811) QuantErr: 12.78811 batch_time=0.35870 
Train Epoch: 19 [766/1000 24512/32000 (77%)] Loss: 0.35810 (QuantReg: 12.72054) QuantErr: 12.72054 batch_time=0.36817 
Train Epoch: 19 [771/1000 24672/32000 (77%)] Loss: 0.38869 (QuantReg: 12.86938) QuantErr: 12.86938 batch_time=0.37973 
Train Epoch: 19 [776/1000 24832/32000 (78%)] Loss: 0.87614 (QuantReg: 12.39063) QuantErr: 12.39063 batch_time=0.48455 
Train Epoch: 19 [781/1000 24992/32000 (78%)] Loss: 0.56519 (QuantReg: 12.11866) QuantErr: 12.11866 batch_time=0.34700 
Train Epoch: 19 [786/1000 25152/32000 (79%)] Loss: 0.27940 (QuantReg: 12.37171) QuantErr: 12.37171 batch_time=1.28239 
Train Epoch: 19 [791/1000 25312/32000 (79%)] Loss: 0.49486 (QuantReg: 12.93748) QuantErr: 12.93748 batch_time=0.36902 
Train Epoch: 19 [796/1000 25472/32000 (80%)] Loss: 0.44198 (QuantReg: 12.95729) QuantErr: 12.95729 batch_time=0.43186 
Train Epoch: 19 [801/1000 25632/32000 (80%)] Loss: 0.48462 (QuantReg: 13.19038) QuantErr: 13.19038 batch_time=0.37550 
Train Epoch: 19 [806/1000 25792/32000 (81%)] Loss: 0.39111 (QuantReg: 12.23300) QuantErr: 12.23300 batch_time=0.36636 
Train Epoch: 19 [811/1000 25952/32000 (81%)] Loss: 0.33819 (QuantReg: 12.99430) QuantErr: 12.99430 batch_time=0.35885 
Train Epoch: 19 [816/1000 26112/32000 (82%)] Loss: 0.75363 (QuantReg: 12.77200) QuantErr: 12.77200 batch_time=0.38001 
Train Epoch: 19 [821/1000 26272/32000 (82%)] Loss: 0.75892 (QuantReg: 11.61214) QuantErr: 11.61214 batch_time=0.35717 
Train Epoch: 19 [826/1000 26432/32000 (83%)] Loss: 0.46777 (QuantReg: 12.17965) QuantErr: 12.17965 batch_time=0.56390 
Train Epoch: 19 [831/1000 26592/32000 (83%)] Loss: 0.87040 (QuantReg: 12.36326) QuantErr: 12.36326 batch_time=0.43984 
Train Epoch: 19 [836/1000 26752/32000 (84%)] Loss: 0.27493 (QuantReg: 13.11900) QuantErr: 13.11900 batch_time=0.35178 
Train Epoch: 19 [841/1000 26912/32000 (84%)] Loss: 0.47029 (QuantReg: 13.33518) QuantErr: 13.33518 batch_time=0.41424 
Train Epoch: 19 [846/1000 27072/32000 (85%)] Loss: 0.70551 (QuantReg: 13.18854) QuantErr: 13.18854 batch_time=0.46924 
Train Epoch: 19 [851/1000 27232/32000 (85%)] Loss: 0.30399 (QuantReg: 13.12584) QuantErr: 13.12584 batch_time=0.37409 
Train Epoch: 19 [856/1000 27392/32000 (86%)] Loss: 0.32598 (QuantReg: 12.96088) QuantErr: 12.96088 batch_time=0.44371 
Train Epoch: 19 [861/1000 27552/32000 (86%)] Loss: 0.43824 (QuantReg: 12.84905) QuantErr: 12.84905 batch_time=0.42689 
Train Epoch: 19 [866/1000 27712/32000 (87%)] Loss: 0.27298 (QuantReg: 12.60977) QuantErr: 12.60977 batch_time=0.38542 
Train Epoch: 19 [871/1000 27872/32000 (87%)] Loss: 0.45299 (QuantReg: 12.79173) QuantErr: 12.79173 batch_time=0.48718 
Train Epoch: 19 [876/1000 28032/32000 (88%)] Loss: 0.29493 (QuantReg: 12.39364) QuantErr: 12.39364 batch_time=0.35124 
Train Epoch: 19 [881/1000 28192/32000 (88%)] Loss: 0.39898 (QuantReg: 12.23839) QuantErr: 12.23839 batch_time=0.68416 
Train Epoch: 19 [886/1000 28352/32000 (89%)] Loss: 0.49650 (QuantReg: 12.75402) QuantErr: 12.75402 batch_time=0.48514 
Train Epoch: 19 [891/1000 28512/32000 (89%)] Loss: 0.26795 (QuantReg: 13.30895) QuantErr: 13.30895 batch_time=0.38543 
Train Epoch: 19 [896/1000 28672/32000 (90%)] Loss: 0.50623 (QuantReg: 13.06258) QuantErr: 13.06258 batch_time=0.38901 
Train Epoch: 19 [901/1000 28832/32000 (90%)] Loss: 0.43578 (QuantReg: 13.27658) QuantErr: 13.27658 batch_time=0.43763 
Train Epoch: 19 [906/1000 28992/32000 (91%)] Loss: 0.24677 (QuantReg: 12.64022) QuantErr: 12.64022 batch_time=0.36019 
Train Epoch: 19 [911/1000 29152/32000 (91%)] Loss: 0.90523 (QuantReg: 12.04785) QuantErr: 12.04785 batch_time=0.40360 
Train Epoch: 19 [916/1000 29312/32000 (92%)] Loss: 0.50177 (QuantReg: 12.47501) QuantErr: 12.47501 batch_time=0.35931 
Train Epoch: 19 [921/1000 29472/32000 (92%)] Loss: 0.34247 (QuantReg: 12.97244) QuantErr: 12.97244 batch_time=0.34569 
Train Epoch: 19 [926/1000 29632/32000 (93%)] Loss: 0.22415 (QuantReg: 13.34423) QuantErr: 13.34423 batch_time=0.70026 
Train Epoch: 19 [931/1000 29792/32000 (93%)] Loss: 0.28869 (QuantReg: 11.98221) QuantErr: 11.98221 batch_time=0.38575 
Train Epoch: 19 [936/1000 29952/32000 (94%)] Loss: 0.32548 (QuantReg: 12.68926) QuantErr: 12.68926 batch_time=0.34267 
Train Epoch: 19 [941/1000 30112/32000 (94%)] Loss: 0.91025 (QuantReg: 12.01662) QuantErr: 12.01662 batch_time=0.35021 
Train Epoch: 19 [946/1000 30272/32000 (95%)] Loss: 0.35210 (QuantReg: 13.36592) QuantErr: 13.36592 batch_time=0.37498 
Train Epoch: 19 [951/1000 30432/32000 (95%)] Loss: 0.55241 (QuantReg: 13.12311) QuantErr: 13.12311 batch_time=0.38432 
Train Epoch: 19 [956/1000 30592/32000 (96%)] Loss: 0.83412 (QuantReg: 12.40298) QuantErr: 12.40298 batch_time=0.69203 
Train Epoch: 19 [961/1000 30752/32000 (96%)] Loss: 0.43982 (QuantReg: 12.71420) QuantErr: 12.71420 batch_time=1.32928 
Train Epoch: 19 [966/1000 30912/32000 (97%)] Loss: 0.47670 (QuantReg: 12.05544) QuantErr: 12.05544 batch_time=0.38981 
Train Epoch: 19 [971/1000 31072/32000 (97%)] Loss: 0.40035 (QuantReg: 12.22293) QuantErr: 12.22293 batch_time=0.41130 
Train Epoch: 19 [976/1000 31232/32000 (98%)] Loss: 0.80026 (QuantReg: 12.62915) QuantErr: 12.62915 batch_time=0.66691 
Train Epoch: 19 [981/1000 31392/32000 (98%)] Loss: 0.58408 (QuantReg: 12.52759) QuantErr: 12.52759 batch_time=0.35646 
Train Epoch: 19 [986/1000 31552/32000 (99%)] Loss: 0.22921 (QuantReg: 12.54601) QuantErr: 12.54601 batch_time=0.53347 
Train Epoch: 19 [991/1000 31712/32000 (99%)] Loss: 0.23260 (QuantReg: 12.18396) QuantErr: 12.18396 batch_time=0.38476 
Train Epoch: 19 [996/1000 31872/32000 (100%)] Loss: 0.54184 (QuantReg: 12.89342) QuantErr: 12.89342 batch_time=0.42604 
Train Epoch: 19 codebook_update_time=1.91789
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch19.pth ...
Done in 5.265s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 0.49225175008922817
 quant_reg      : 12.52170135307312
 quant_err      : 12.52170135307312
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 19000
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 46.0
 MSRVTT_miech_test/t2v_metrics/R10: 60.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 7.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.229
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.095227459322416
 MSRVTT_miech_test/v2t_metrics/R1: 17.4
 MSRVTT_miech_test/v2t_metrics/R5: 48.6
 MSRVTT_miech_test/v2t_metrics/R10: 62.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.364
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.507953512990916
 mnt_best       : 38.191359302198194
 not_improved_count: 1
Train Epoch: 20 [1/1000 32/32000 (0%)] Loss: 0.70407 (QuantReg: 12.30389) QuantErr: 12.30389 batch_time=27.16805 
Train Epoch: 20 [6/1000 192/32000 (1%)] Loss: 0.38635 (QuantReg: 12.71841) QuantErr: 12.71841 batch_time=0.42072 
Train Epoch: 20 [11/1000 352/32000 (1%)] Loss: 0.34187 (QuantReg: 12.12249) QuantErr: 12.12249 batch_time=0.83218 
Train Epoch: 20 [16/1000 512/32000 (2%)] Loss: 1.00572 (QuantReg: 12.16878) QuantErr: 12.16878 batch_time=0.97816 
Train Epoch: 20 [21/1000 672/32000 (2%)] Loss: 0.38370 (QuantReg: 11.41807) QuantErr: 11.41807 batch_time=0.36415 
Train Epoch: 20 [26/1000 832/32000 (3%)] Loss: 0.48805 (QuantReg: 13.06466) QuantErr: 13.06466 batch_time=0.34237 
Train Epoch: 20 [31/1000 992/32000 (3%)] Loss: 0.58099 (QuantReg: 12.74582) QuantErr: 12.74582 batch_time=0.45629 
Train Epoch: 20 [36/1000 1152/32000 (4%)] Loss: 0.46476 (QuantReg: 12.01192) QuantErr: 12.01192 batch_time=0.36657 
Train Epoch: 20 [41/1000 1312/32000 (4%)] Loss: 0.38827 (QuantReg: 11.86885) QuantErr: 11.86885 batch_time=0.70488 
Train Epoch: 20 [46/1000 1472/32000 (5%)] Loss: 0.39528 (QuantReg: 13.02905) QuantErr: 13.02905 batch_time=0.44893 
Train Epoch: 20 [51/1000 1632/32000 (5%)] Loss: 0.96446 (QuantReg: 11.75677) QuantErr: 11.75677 batch_time=0.41293 
Train Epoch: 20 [56/1000 1792/32000 (6%)] Loss: 0.61488 (QuantReg: 12.90621) QuantErr: 12.90621 batch_time=0.57858 
Train Epoch: 20 [61/1000 1952/32000 (6%)] Loss: 0.40118 (QuantReg: 12.05371) QuantErr: 12.05371 batch_time=0.59117 
Train Epoch: 20 [66/1000 2112/32000 (7%)] Loss: 0.37228 (QuantReg: 12.56155) QuantErr: 12.56155 batch_time=0.62880 
Train Epoch: 20 [71/1000 2272/32000 (7%)] Loss: 0.66153 (QuantReg: 12.26455) QuantErr: 12.26455 batch_time=0.36399 
Train Epoch: 20 [76/1000 2432/32000 (8%)] Loss: 0.43420 (QuantReg: 12.21791) QuantErr: 12.21791 batch_time=0.35053 
Train Epoch: 20 [81/1000 2592/32000 (8%)] Loss: 0.36029 (QuantReg: 12.06533) QuantErr: 12.06533 batch_time=0.36854 
Train Epoch: 20 [86/1000 2752/32000 (9%)] Loss: 0.51093 (QuantReg: 12.21777) QuantErr: 12.21777 batch_time=0.34859 
Train Epoch: 20 [91/1000 2912/32000 (9%)] Loss: 0.50905 (QuantReg: 12.37725) QuantErr: 12.37725 batch_time=0.37046 
Train Epoch: 20 [96/1000 3072/32000 (10%)] Loss: 0.54771 (QuantReg: 11.80145) QuantErr: 11.80145 batch_time=0.37316 
Train Epoch: 20 [101/1000 3232/32000 (10%)] Loss: 0.33454 (QuantReg: 13.32202) QuantErr: 13.32202 batch_time=0.36233 
Train Epoch: 20 [106/1000 3392/32000 (11%)] Loss: 0.75245 (QuantReg: 12.29674) QuantErr: 12.29674 batch_time=0.36978 
Train Epoch: 20 [111/1000 3552/32000 (11%)] Loss: 0.58182 (QuantReg: 12.16226) QuantErr: 12.16226 batch_time=0.40242 
Train Epoch: 20 [116/1000 3712/32000 (12%)] Loss: 0.46950 (QuantReg: 11.82121) QuantErr: 11.82121 batch_time=0.34832 
Train Epoch: 20 [121/1000 3872/32000 (12%)] Loss: 0.35509 (QuantReg: 12.08197) QuantErr: 12.08197 batch_time=0.36273 
Train Epoch: 20 [126/1000 4032/32000 (13%)] Loss: 0.61054 (QuantReg: 12.36388) QuantErr: 12.36388 batch_time=0.37714 
Train Epoch: 20 [131/1000 4192/32000 (13%)] Loss: 0.37764 (QuantReg: 12.39667) QuantErr: 12.39667 batch_time=0.37759 
Train Epoch: 20 [136/1000 4352/32000 (14%)] Loss: 0.50772 (QuantReg: 12.39498) QuantErr: 12.39498 batch_time=0.36502 
Train Epoch: 20 [141/1000 4512/32000 (14%)] Loss: 0.40213 (QuantReg: 12.01766) QuantErr: 12.01766 batch_time=0.35081 
Train Epoch: 20 [146/1000 4672/32000 (15%)] Loss: 0.38317 (QuantReg: 12.76038) QuantErr: 12.76038 batch_time=0.46071 
Train Epoch: 20 [151/1000 4832/32000 (15%)] Loss: 0.53481 (QuantReg: 12.99636) QuantErr: 12.99636 batch_time=0.36969 
Train Epoch: 20 [156/1000 4992/32000 (16%)] Loss: 0.64264 (QuantReg: 12.36380) QuantErr: 12.36380 batch_time=0.46746 
Train Epoch: 20 [161/1000 5152/32000 (16%)] Loss: 0.51440 (QuantReg: 12.09064) QuantErr: 12.09064 batch_time=0.39854 
Train Epoch: 20 [166/1000 5312/32000 (17%)] Loss: 0.66301 (QuantReg: 13.39627) QuantErr: 13.39627 batch_time=0.35569 
Train Epoch: 20 [171/1000 5472/32000 (17%)] Loss: 0.70206 (QuantReg: 12.65558) QuantErr: 12.65558 batch_time=0.40198 
Train Epoch: 20 [176/1000 5632/32000 (18%)] Loss: 0.24424 (QuantReg: 12.33829) QuantErr: 12.33829 batch_time=0.35565 
Train Epoch: 20 [181/1000 5792/32000 (18%)] Loss: 0.17635 (QuantReg: 12.52321) QuantErr: 12.52321 batch_time=0.39014 
Train Epoch: 20 [186/1000 5952/32000 (19%)] Loss: 0.23937 (QuantReg: 12.98446) QuantErr: 12.98446 batch_time=0.33960 
Train Epoch: 20 [191/1000 6112/32000 (19%)] Loss: 0.37790 (QuantReg: 12.84193) QuantErr: 12.84193 batch_time=0.51549 
Train Epoch: 20 [196/1000 6272/32000 (20%)] Loss: 0.67009 (QuantReg: 11.41565) QuantErr: 11.41565 batch_time=0.43757 
Train Epoch: 20 [201/1000 6432/32000 (20%)] Loss: 0.32588 (QuantReg: 13.10775) QuantErr: 13.10775 batch_time=0.36110 
Train Epoch: 20 [206/1000 6592/32000 (21%)] Loss: 0.43253 (QuantReg: 12.44058) QuantErr: 12.44058 batch_time=0.50826 
Train Epoch: 20 [211/1000 6752/32000 (21%)] Loss: 0.46569 (QuantReg: 12.33401) QuantErr: 12.33401 batch_time=0.43859 
Train Epoch: 20 [216/1000 6912/32000 (22%)] Loss: 0.13547 (QuantReg: 12.42925) QuantErr: 12.42925 batch_time=0.40720 
Train Epoch: 20 [221/1000 7072/32000 (22%)] Loss: 0.21335 (QuantReg: 13.03332) QuantErr: 13.03332 batch_time=0.36724 
Train Epoch: 20 [226/1000 7232/32000 (23%)] Loss: 0.79863 (QuantReg: 12.55308) QuantErr: 12.55308 batch_time=0.35035 
Train Epoch: 20 [231/1000 7392/32000 (23%)] Loss: 0.49345 (QuantReg: 11.96761) QuantErr: 11.96761 batch_time=0.56239 
Train Epoch: 20 [236/1000 7552/32000 (24%)] Loss: 0.68386 (QuantReg: 11.89017) QuantErr: 11.89017 batch_time=0.64031 
Train Epoch: 20 [241/1000 7712/32000 (24%)] Loss: 0.40233 (QuantReg: 12.73967) QuantErr: 12.73967 batch_time=0.57995 
Train Epoch: 20 [246/1000 7872/32000 (25%)] Loss: 0.33426 (QuantReg: 11.59792) QuantErr: 11.59792 batch_time=0.42561 
Train Epoch: 20 [251/1000 8032/32000 (25%)] Loss: 0.57420 (QuantReg: 13.23975) QuantErr: 13.23975 batch_time=0.49347 
Train Epoch: 20 [256/1000 8192/32000 (26%)] Loss: 0.59513 (QuantReg: 12.55245) QuantErr: 12.55245 batch_time=0.38112 
Train Epoch: 20 [261/1000 8352/32000 (26%)] Loss: 0.47760 (QuantReg: 11.53668) QuantErr: 11.53668 batch_time=0.40902 
Train Epoch: 20 [266/1000 8512/32000 (27%)] Loss: 0.60739 (QuantReg: 12.03835) QuantErr: 12.03835 batch_time=0.48979 
Train Epoch: 20 [271/1000 8672/32000 (27%)] Loss: 0.36246 (QuantReg: 12.67805) QuantErr: 12.67805 batch_time=0.36081 
Train Epoch: 20 [276/1000 8832/32000 (28%)] Loss: 0.65113 (QuantReg: 12.28590) QuantErr: 12.28590 batch_time=0.62632 
Train Epoch: 20 [281/1000 8992/32000 (28%)] Loss: 0.88225 (QuantReg: 12.78657) QuantErr: 12.78657 batch_time=0.39700 
Train Epoch: 20 [286/1000 9152/32000 (29%)] Loss: 0.32918 (QuantReg: 13.01494) QuantErr: 13.01494 batch_time=0.49661 
Train Epoch: 20 [291/1000 9312/32000 (29%)] Loss: 0.47653 (QuantReg: 13.06599) QuantErr: 13.06599 batch_time=0.58814 
Train Epoch: 20 [296/1000 9472/32000 (30%)] Loss: 0.32169 (QuantReg: 12.99383) QuantErr: 12.99383 batch_time=0.36981 
Train Epoch: 20 [301/1000 9632/32000 (30%)] Loss: 0.50246 (QuantReg: 12.12852) QuantErr: 12.12852 batch_time=0.37918 
Train Epoch: 20 [306/1000 9792/32000 (31%)] Loss: 0.20051 (QuantReg: 12.88025) QuantErr: 12.88025 batch_time=0.71985 
Train Epoch: 20 [311/1000 9952/32000 (31%)] Loss: 0.47253 (QuantReg: 12.60535) QuantErr: 12.60535 batch_time=0.43783 
Train Epoch: 20 [316/1000 10112/32000 (32%)] Loss: 0.50085 (QuantReg: 11.91156) QuantErr: 11.91156 batch_time=0.48165 
Train Epoch: 20 [321/1000 10272/32000 (32%)] Loss: 0.35053 (QuantReg: 12.76750) QuantErr: 12.76750 batch_time=0.37277 
Train Epoch: 20 [326/1000 10432/32000 (33%)] Loss: 0.30003 (QuantReg: 12.70216) QuantErr: 12.70216 batch_time=0.41877 
Train Epoch: 20 [331/1000 10592/32000 (33%)] Loss: 0.50964 (QuantReg: 13.22208) QuantErr: 13.22208 batch_time=0.80111 
Train Epoch: 20 [336/1000 10752/32000 (34%)] Loss: 0.54480 (QuantReg: 13.13237) QuantErr: 13.13237 batch_time=0.34572 
Train Epoch: 20 [341/1000 10912/32000 (34%)] Loss: 0.73311 (QuantReg: 12.19090) QuantErr: 12.19090 batch_time=0.36863 
Train Epoch: 20 [346/1000 11072/32000 (35%)] Loss: 0.27877 (QuantReg: 12.67167) QuantErr: 12.67167 batch_time=0.41269 
Train Epoch: 20 [351/1000 11232/32000 (35%)] Loss: 0.92263 (QuantReg: 11.51068) QuantErr: 11.51068 batch_time=0.37248 
Train Epoch: 20 [356/1000 11392/32000 (36%)] Loss: 0.45756 (QuantReg: 12.21403) QuantErr: 12.21403 batch_time=0.37537 
Train Epoch: 20 [361/1000 11552/32000 (36%)] Loss: 0.33521 (QuantReg: 12.84855) QuantErr: 12.84855 batch_time=1.23296 
Train Epoch: 20 [366/1000 11712/32000 (37%)] Loss: 0.46672 (QuantReg: 13.03689) QuantErr: 13.03689 batch_time=0.38851 
Train Epoch: 20 [371/1000 11872/32000 (37%)] Loss: 0.38538 (QuantReg: 12.76418) QuantErr: 12.76418 batch_time=0.35391 
Train Epoch: 20 [376/1000 12032/32000 (38%)] Loss: 0.38514 (QuantReg: 11.77800) QuantErr: 11.77800 batch_time=0.74554 
Train Epoch: 20 [381/1000 12192/32000 (38%)] Loss: 0.42318 (QuantReg: 12.57687) QuantErr: 12.57687 batch_time=0.58545 
Train Epoch: 20 [386/1000 12352/32000 (39%)] Loss: 0.50595 (QuantReg: 12.89395) QuantErr: 12.89395 batch_time=0.35426 
Train Epoch: 20 [391/1000 12512/32000 (39%)] Loss: 0.65713 (QuantReg: 12.35459) QuantErr: 12.35459 batch_time=0.37319 
Train Epoch: 20 [396/1000 12672/32000 (40%)] Loss: 0.70750 (QuantReg: 12.09704) QuantErr: 12.09704 batch_time=0.36076 
Train Epoch: 20 [401/1000 12832/32000 (40%)] Loss: 0.61378 (QuantReg: 12.59864) QuantErr: 12.59864 batch_time=0.65982 
Train Epoch: 20 [406/1000 12992/32000 (41%)] Loss: 0.48082 (QuantReg: 12.66947) QuantErr: 12.66947 batch_time=1.61852 
Train Epoch: 20 [411/1000 13152/32000 (41%)] Loss: 0.37969 (QuantReg: 12.74974) QuantErr: 12.74974 batch_time=0.41890 
Train Epoch: 20 [416/1000 13312/32000 (42%)] Loss: 0.58425 (QuantReg: 12.72445) QuantErr: 12.72445 batch_time=0.43777 
Train Epoch: 20 [421/1000 13472/32000 (42%)] Loss: 0.41979 (QuantReg: 12.15284) QuantErr: 12.15284 batch_time=0.35118 
Train Epoch: 20 [426/1000 13632/32000 (43%)] Loss: 0.39810 (QuantReg: 11.92841) QuantErr: 11.92841 batch_time=0.71949 
Train Epoch: 20 [431/1000 13792/32000 (43%)] Loss: 0.30619 (QuantReg: 12.57010) QuantErr: 12.57010 batch_time=0.52541 
Train Epoch: 20 [436/1000 13952/32000 (44%)] Loss: 0.76131 (QuantReg: 12.70885) QuantErr: 12.70885 batch_time=0.40977 
Train Epoch: 20 [441/1000 14112/32000 (44%)] Loss: 0.37757 (QuantReg: 13.02933) QuantErr: 13.02933 batch_time=0.39539 
Train Epoch: 20 [446/1000 14272/32000 (45%)] Loss: 0.44997 (QuantReg: 13.34013) QuantErr: 13.34013 batch_time=0.43931 
Train Epoch: 20 [451/1000 14432/32000 (45%)] Loss: 0.30095 (QuantReg: 11.90035) QuantErr: 11.90035 batch_time=0.42492 
Train Epoch: 20 [456/1000 14592/32000 (46%)] Loss: 0.73337 (QuantReg: 12.26550) QuantErr: 12.26550 batch_time=0.37030 
Train Epoch: 20 [461/1000 14752/32000 (46%)] Loss: 0.92200 (QuantReg: 12.83507) QuantErr: 12.83507 batch_time=0.40495 
Train Epoch: 20 [466/1000 14912/32000 (47%)] Loss: 0.47793 (QuantReg: 12.64079) QuantErr: 12.64079 batch_time=0.41879 
Train Epoch: 20 [471/1000 15072/32000 (47%)] Loss: 0.31517 (QuantReg: 12.85822) QuantErr: 12.85822 batch_time=0.74469 
Train Epoch: 20 [476/1000 15232/32000 (48%)] Loss: 0.31379 (QuantReg: 11.99748) QuantErr: 11.99748 batch_time=0.35803 
Train Epoch: 20 [481/1000 15392/32000 (48%)] Loss: 0.18462 (QuantReg: 12.26693) QuantErr: 12.26693 batch_time=0.60909 
Train Epoch: 20 [486/1000 15552/32000 (49%)] Loss: 0.35365 (QuantReg: 12.97110) QuantErr: 12.97110 batch_time=0.38743 
Train Epoch: 20 [491/1000 15712/32000 (49%)] Loss: 0.43341 (QuantReg: 11.64291) QuantErr: 11.64291 batch_time=0.35735 
Train Epoch: 20 [496/1000 15872/32000 (50%)] Loss: 0.56963 (QuantReg: 12.24335) QuantErr: 12.24335 batch_time=0.37550 
Train Epoch: 20 [501/1000 16032/32000 (50%)] Loss: 0.67082 (QuantReg: 12.94606) QuantErr: 12.94606 batch_time=0.40192 
Train Epoch: 20 [506/1000 16192/32000 (51%)] Loss: 0.66113 (QuantReg: 12.08661) QuantErr: 12.08661 batch_time=0.45159 
Train Epoch: 20 [511/1000 16352/32000 (51%)] Loss: 0.31949 (QuantReg: 12.53140) QuantErr: 12.53140 batch_time=0.38465 
Train Epoch: 20 [516/1000 16512/32000 (52%)] Loss: 1.01293 (QuantReg: 12.59341) QuantErr: 12.59341 batch_time=0.71116 
Train Epoch: 20 [521/1000 16672/32000 (52%)] Loss: 0.48976 (QuantReg: 12.00763) QuantErr: 12.00763 batch_time=0.50219 
Train Epoch: 20 [526/1000 16832/32000 (53%)] Loss: 0.44138 (QuantReg: 12.83644) QuantErr: 12.83644 batch_time=0.45331 
Train Epoch: 20 [531/1000 16992/32000 (53%)] Loss: 0.29372 (QuantReg: 13.21909) QuantErr: 13.21909 batch_time=0.41954 
Train Epoch: 20 [536/1000 17152/32000 (54%)] Loss: 0.57165 (QuantReg: 12.22966) QuantErr: 12.22966 batch_time=0.35533 
Train Epoch: 20 [541/1000 17312/32000 (54%)] Loss: 0.25028 (QuantReg: 12.88879) QuantErr: 12.88879 batch_time=0.37842 
Train Epoch: 20 [546/1000 17472/32000 (55%)] Loss: 0.36606 (QuantReg: 12.41329) QuantErr: 12.41329 batch_time=0.46667 
Train Epoch: 20 [551/1000 17632/32000 (55%)] Loss: 0.19512 (QuantReg: 12.50764) QuantErr: 12.50764 batch_time=0.43897 
Train Epoch: 20 [556/1000 17792/32000 (56%)] Loss: 0.80189 (QuantReg: 11.94320) QuantErr: 11.94320 batch_time=0.53355 
Train Epoch: 20 [561/1000 17952/32000 (56%)] Loss: 0.45934 (QuantReg: 12.68612) QuantErr: 12.68612 batch_time=0.35446 
Train Epoch: 20 [566/1000 18112/32000 (57%)] Loss: 0.25845 (QuantReg: 12.86616) QuantErr: 12.86616 batch_time=0.65789 
Train Epoch: 20 [571/1000 18272/32000 (57%)] Loss: 0.68430 (QuantReg: 12.42403) QuantErr: 12.42403 batch_time=0.48930 
Train Epoch: 20 [576/1000 18432/32000 (58%)] Loss: 0.62707 (QuantReg: 12.70513) QuantErr: 12.70513 batch_time=0.44326 
Train Epoch: 20 [581/1000 18592/32000 (58%)] Loss: 0.41526 (QuantReg: 12.95018) QuantErr: 12.95018 batch_time=0.36541 
Train Epoch: 20 [586/1000 18752/32000 (59%)] Loss: 0.48658 (QuantReg: 12.72743) QuantErr: 12.72743 batch_time=0.34716 
Train Epoch: 20 [591/1000 18912/32000 (59%)] Loss: 0.29896 (QuantReg: 12.69159) QuantErr: 12.69159 batch_time=0.37095 
Train Epoch: 20 [596/1000 19072/32000 (60%)] Loss: 0.55326 (QuantReg: 13.00843) QuantErr: 13.00843 batch_time=0.37859 
Train Epoch: 20 [601/1000 19232/32000 (60%)] Loss: 0.39324 (QuantReg: 12.87933) QuantErr: 12.87933 batch_time=0.38847 
Train Epoch: 20 [606/1000 19392/32000 (61%)] Loss: 0.38109 (QuantReg: 12.90463) QuantErr: 12.90463 batch_time=0.57563 
Train Epoch: 20 [611/1000 19552/32000 (61%)] Loss: 0.33912 (QuantReg: 13.04538) QuantErr: 13.04538 batch_time=0.59621 
Train Epoch: 20 [616/1000 19712/32000 (62%)] Loss: 0.37374 (QuantReg: 12.21251) QuantErr: 12.21251 batch_time=0.43185 
Train Epoch: 20 [621/1000 19872/32000 (62%)] Loss: 0.24418 (QuantReg: 13.35208) QuantErr: 13.35208 batch_time=0.39533 
Train Epoch: 20 [626/1000 20032/32000 (63%)] Loss: 0.65772 (QuantReg: 12.53642) QuantErr: 12.53642 batch_time=0.72044 
Train Epoch: 20 [631/1000 20192/32000 (63%)] Loss: 0.17436 (QuantReg: 12.62344) QuantErr: 12.62344 batch_time=0.35458 
Train Epoch: 20 [636/1000 20352/32000 (64%)] Loss: 0.70569 (QuantReg: 12.93122) QuantErr: 12.93122 batch_time=0.36536 
Train Epoch: 20 [641/1000 20512/32000 (64%)] Loss: 0.67011 (QuantReg: 12.56155) QuantErr: 12.56155 batch_time=0.35684 
Train Epoch: 20 [646/1000 20672/32000 (65%)] Loss: 0.76687 (QuantReg: 12.19012) QuantErr: 12.19012 batch_time=0.37671 
Train Epoch: 20 [651/1000 20832/32000 (65%)] Loss: 0.62464 (QuantReg: 12.99987) QuantErr: 12.99987 batch_time=0.38725 
Train Epoch: 20 [656/1000 20992/32000 (66%)] Loss: 0.20812 (QuantReg: 13.19193) QuantErr: 13.19193 batch_time=0.43508 
Train Epoch: 20 [661/1000 21152/32000 (66%)] Loss: 0.21141 (QuantReg: 12.34194) QuantErr: 12.34194 batch_time=0.66909 
Train Epoch: 20 [666/1000 21312/32000 (67%)] Loss: 0.36324 (QuantReg: 12.67969) QuantErr: 12.67969 batch_time=0.36148 
Train Epoch: 20 [671/1000 21472/32000 (67%)] Loss: 0.92795 (QuantReg: 12.17633) QuantErr: 12.17633 batch_time=0.76701 
Train Epoch: 20 [676/1000 21632/32000 (68%)] Loss: 0.47716 (QuantReg: 13.17574) QuantErr: 13.17574 batch_time=0.34794 
Train Epoch: 20 [681/1000 21792/32000 (68%)] Loss: 0.28814 (QuantReg: 13.12041) QuantErr: 13.12041 batch_time=0.82352 
Train Epoch: 20 [686/1000 21952/32000 (69%)] Loss: 0.57776 (QuantReg: 12.50392) QuantErr: 12.50392 batch_time=0.34742 
Train Epoch: 20 [691/1000 22112/32000 (69%)] Loss: 0.34978 (QuantReg: 12.65303) QuantErr: 12.65303 batch_time=0.35628 
Train Epoch: 20 [696/1000 22272/32000 (70%)] Loss: 0.51680 (QuantReg: 12.35440) QuantErr: 12.35440 batch_time=0.36400 
Train Epoch: 20 [701/1000 22432/32000 (70%)] Loss: 0.53762 (QuantReg: 12.43014) QuantErr: 12.43014 batch_time=0.38643 
Train Epoch: 20 [706/1000 22592/32000 (71%)] Loss: 0.39496 (QuantReg: 12.55667) QuantErr: 12.55667 batch_time=0.39559 
Train Epoch: 20 [711/1000 22752/32000 (71%)] Loss: 0.53956 (QuantReg: 12.23143) QuantErr: 12.23143 batch_time=0.37593 
Train Epoch: 20 [716/1000 22912/32000 (72%)] Loss: 0.40083 (QuantReg: 13.09590) QuantErr: 13.09590 batch_time=0.35194 
Train Epoch: 20 [721/1000 23072/32000 (72%)] Loss: 0.28532 (QuantReg: 12.75314) QuantErr: 12.75314 batch_time=0.59059 
Train Epoch: 20 [726/1000 23232/32000 (73%)] Loss: 0.55827 (QuantReg: 12.65848) QuantErr: 12.65848 batch_time=0.58339 
Train Epoch: 20 [731/1000 23392/32000 (73%)] Loss: 0.62114 (QuantReg: 12.57870) QuantErr: 12.57870 batch_time=0.40328 
Train Epoch: 20 [736/1000 23552/32000 (74%)] Loss: 0.48789 (QuantReg: 13.44247) QuantErr: 13.44247 batch_time=0.39824 
Train Epoch: 20 [741/1000 23712/32000 (74%)] Loss: 0.51908 (QuantReg: 12.52450) QuantErr: 12.52450 batch_time=0.46255 
Train Epoch: 20 [746/1000 23872/32000 (75%)] Loss: 0.33620 (QuantReg: 13.55839) QuantErr: 13.55839 batch_time=0.74731 
Train Epoch: 20 [751/1000 24032/32000 (75%)] Loss: 0.28466 (QuantReg: 12.35107) QuantErr: 12.35107 batch_time=0.34745 
Train Epoch: 20 [756/1000 24192/32000 (76%)] Loss: 0.60441 (QuantReg: 11.68343) QuantErr: 11.68343 batch_time=0.64475 
Train Epoch: 20 [761/1000 24352/32000 (76%)] Loss: 0.25847 (QuantReg: 12.73374) QuantErr: 12.73374 batch_time=0.42906 
Train Epoch: 20 [766/1000 24512/32000 (77%)] Loss: 0.49184 (QuantReg: 13.09452) QuantErr: 13.09452 batch_time=0.34544 
Train Epoch: 20 [771/1000 24672/32000 (77%)] Loss: 0.46163 (QuantReg: 12.89025) QuantErr: 12.89025 batch_time=0.43285 
Train Epoch: 20 [776/1000 24832/32000 (78%)] Loss: 0.55731 (QuantReg: 12.35115) QuantErr: 12.35115 batch_time=0.42848 
Train Epoch: 20 [781/1000 24992/32000 (78%)] Loss: 0.54206 (QuantReg: 13.00718) QuantErr: 13.00718 batch_time=0.39023 
Train Epoch: 20 [786/1000 25152/32000 (79%)] Loss: 0.69453 (QuantReg: 12.74023) QuantErr: 12.74023 batch_time=0.37881 
Train Epoch: 20 [791/1000 25312/32000 (79%)] Loss: 0.68293 (QuantReg: 12.73062) QuantErr: 12.73062 batch_time=0.36678 
Train Epoch: 20 [796/1000 25472/32000 (80%)] Loss: 1.11044 (QuantReg: 12.32755) QuantErr: 12.32755 batch_time=0.39569 
Train Epoch: 20 [801/1000 25632/32000 (80%)] Loss: 0.69710 (QuantReg: 12.42671) QuantErr: 12.42671 batch_time=0.78548 
Train Epoch: 20 [806/1000 25792/32000 (81%)] Loss: 0.80504 (QuantReg: 12.55529) QuantErr: 12.55529 batch_time=0.55670 
Train Epoch: 20 [811/1000 25952/32000 (81%)] Loss: 0.61487 (QuantReg: 12.82327) QuantErr: 12.82327 batch_time=0.47408 
Train Epoch: 20 [816/1000 26112/32000 (82%)] Loss: 0.44436 (QuantReg: 13.02904) QuantErr: 13.02904 batch_time=0.42025 
Train Epoch: 20 [821/1000 26272/32000 (82%)] Loss: 0.65710 (QuantReg: 12.62669) QuantErr: 12.62669 batch_time=0.34950 
Train Epoch: 20 [826/1000 26432/32000 (83%)] Loss: 0.35710 (QuantReg: 12.74202) QuantErr: 12.74202 batch_time=0.37924 
Train Epoch: 20 [831/1000 26592/32000 (83%)] Loss: 0.26588 (QuantReg: 12.48915) QuantErr: 12.48915 batch_time=0.37888 
Train Epoch: 20 [836/1000 26752/32000 (84%)] Loss: 0.35027 (QuantReg: 12.46528) QuantErr: 12.46528 batch_time=0.98674 
Train Epoch: 20 [841/1000 26912/32000 (84%)] Loss: 0.41231 (QuantReg: 13.40129) QuantErr: 13.40129 batch_time=0.36623 
Train Epoch: 20 [846/1000 27072/32000 (85%)] Loss: 0.38003 (QuantReg: 12.91734) QuantErr: 12.91734 batch_time=0.35464 
Train Epoch: 20 [851/1000 27232/32000 (85%)] Loss: 0.20988 (QuantReg: 13.05783) QuantErr: 13.05783 batch_time=0.55593 
Train Epoch: 20 [856/1000 27392/32000 (86%)] Loss: 0.51431 (QuantReg: 13.31780) QuantErr: 13.31780 batch_time=0.38994 
Train Epoch: 20 [861/1000 27552/32000 (86%)] Loss: 0.48018 (QuantReg: 12.77239) QuantErr: 12.77239 batch_time=0.35096 
Train Epoch: 20 [866/1000 27712/32000 (87%)] Loss: 0.60847 (QuantReg: 12.50223) QuantErr: 12.50223 batch_time=0.51726 
Train Epoch: 20 [871/1000 27872/32000 (87%)] Loss: 0.27580 (QuantReg: 12.46933) QuantErr: 12.46933 batch_time=0.37769 
Train Epoch: 20 [876/1000 28032/32000 (88%)] Loss: 0.33640 (QuantReg: 12.37197) QuantErr: 12.37197 batch_time=0.43541 
Train Epoch: 20 [881/1000 28192/32000 (88%)] Loss: 1.02480 (QuantReg: 12.49348) QuantErr: 12.49348 batch_time=0.42151 
Train Epoch: 20 [886/1000 28352/32000 (89%)] Loss: 0.27230 (QuantReg: 12.32600) QuantErr: 12.32600 batch_time=0.40207 
Train Epoch: 20 [891/1000 28512/32000 (89%)] Loss: 0.25931 (QuantReg: 12.60338) QuantErr: 12.60338 batch_time=0.37433 
Train Epoch: 20 [896/1000 28672/32000 (90%)] Loss: 0.27472 (QuantReg: 12.74014) QuantErr: 12.74014 batch_time=0.36817 
Train Epoch: 20 [901/1000 28832/32000 (90%)] Loss: 0.19941 (QuantReg: 12.05873) QuantErr: 12.05873 batch_time=0.57779 
Train Epoch: 20 [906/1000 28992/32000 (91%)] Loss: 0.46761 (QuantReg: 12.83989) QuantErr: 12.83989 batch_time=0.42638 
Train Epoch: 20 [911/1000 29152/32000 (91%)] Loss: 0.27564 (QuantReg: 12.14427) QuantErr: 12.14427 batch_time=0.72973 
Train Epoch: 20 [916/1000 29312/32000 (92%)] Loss: 0.51649 (QuantReg: 11.97895) QuantErr: 11.97895 batch_time=0.96034 
Train Epoch: 20 [921/1000 29472/32000 (92%)] Loss: 0.83951 (QuantReg: 12.68363) QuantErr: 12.68363 batch_time=0.38162 
Train Epoch: 20 [926/1000 29632/32000 (93%)] Loss: 0.78446 (QuantReg: 13.25345) QuantErr: 13.25345 batch_time=0.46072 
Train Epoch: 20 [931/1000 29792/32000 (93%)] Loss: 0.14222 (QuantReg: 12.71201) QuantErr: 12.71201 batch_time=0.43833 
Train Epoch: 20 [936/1000 29952/32000 (94%)] Loss: 0.37162 (QuantReg: 12.45214) QuantErr: 12.45214 batch_time=0.35941 
Train Epoch: 20 [941/1000 30112/32000 (94%)] Loss: 0.25429 (QuantReg: 12.30066) QuantErr: 12.30066 batch_time=0.35653 
Train Epoch: 20 [946/1000 30272/32000 (95%)] Loss: 1.08080 (QuantReg: 12.44755) QuantErr: 12.44755 batch_time=1.25752 
Train Epoch: 20 [951/1000 30432/32000 (95%)] Loss: 0.29217 (QuantReg: 12.41503) QuantErr: 12.41503 batch_time=0.39889 
Train Epoch: 20 [956/1000 30592/32000 (96%)] Loss: 0.72014 (QuantReg: 13.05817) QuantErr: 13.05817 batch_time=0.40561 
Train Epoch: 20 [961/1000 30752/32000 (96%)] Loss: 0.19314 (QuantReg: 12.30043) QuantErr: 12.30043 batch_time=0.45212 
Train Epoch: 20 [966/1000 30912/32000 (97%)] Loss: 0.54368 (QuantReg: 12.80081) QuantErr: 12.80081 batch_time=0.42607 
Train Epoch: 20 [971/1000 31072/32000 (97%)] Loss: 0.36281 (QuantReg: 12.38171) QuantErr: 12.38171 batch_time=0.37074 
Train Epoch: 20 [976/1000 31232/32000 (98%)] Loss: 0.41456 (QuantReg: 12.98280) QuantErr: 12.98280 batch_time=0.38319 
Train Epoch: 20 [981/1000 31392/32000 (98%)] Loss: 0.53283 (QuantReg: 12.64471) QuantErr: 12.64471 batch_time=0.39829 
Train Epoch: 20 [986/1000 31552/32000 (99%)] Loss: 0.18786 (QuantReg: 12.75422) QuantErr: 12.75422 batch_time=0.35223 
Train Epoch: 20 [991/1000 31712/32000 (99%)] Loss: 0.58275 (QuantReg: 13.25828) QuantErr: 13.25828 batch_time=0.34540 
Train Epoch: 20 [996/1000 31872/32000 (100%)] Loss: 0.75072 (QuantReg: 12.97996) QuantErr: 12.97996 batch_time=0.62947 
Train Epoch: 20 codebook_update_time=3.66577
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch20.pth ...
Done in 9.132s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch20.pth ...
Done in 14.104s
removing stale ckpt [epoch 19] [took 0.03s]
 epoch          : 20
 loss           : 0.4809400080963969
 quant_reg      : 12.582315981864928
 quant_err      : 12.582315981864928
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 20000
 MSRVTT_miech_test/t2v_metrics/R1: 19.3
 MSRVTT_miech_test/t2v_metrics/R5: 47.6
 MSRVTT_miech_test/t2v_metrics/R10: 61.9
 MSRVTT_miech_test/t2v_metrics/R50: 88.6
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.857
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.45489562444897
 MSRVTT_miech_test/v2t_metrics/R1: 18.9
 MSRVTT_miech_test/v2t_metrics/R5: 49.0
 MSRVTT_miech_test/v2t_metrics/R10: 62.3
 MSRVTT_miech_test/v2t_metrics/R50: 89.3
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.4445
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.6410254926323
 mnt_best       : 38.45489562444897
 not_improved_count: 0
Train Epoch: 21 [1/1000 32/32000 (0%)] Loss: 0.72264 (QuantReg: 11.72808) QuantErr: 11.72808 batch_time=30.48194 
Train Epoch: 21 [6/1000 192/32000 (1%)] Loss: 0.36419 (QuantReg: 12.70418) QuantErr: 12.70418 batch_time=0.80697 
Train Epoch: 21 [11/1000 352/32000 (1%)] Loss: 0.54941 (QuantReg: 12.37185) QuantErr: 12.37185 batch_time=0.38559 
Train Epoch: 21 [16/1000 512/32000 (2%)] Loss: 0.17147 (QuantReg: 12.21962) QuantErr: 12.21962 batch_time=0.46741 
Train Epoch: 21 [21/1000 672/32000 (2%)] Loss: 0.51906 (QuantReg: 11.94527) QuantErr: 11.94527 batch_time=0.41280 
Train Epoch: 21 [26/1000 832/32000 (3%)] Loss: 0.32598 (QuantReg: 11.66804) QuantErr: 11.66804 batch_time=0.41427 
Train Epoch: 21 [31/1000 992/32000 (3%)] Loss: 0.15765 (QuantReg: 12.29032) QuantErr: 12.29032 batch_time=0.71387 
Train Epoch: 21 [36/1000 1152/32000 (4%)] Loss: 0.29987 (QuantReg: 12.06923) QuantErr: 12.06923 batch_time=0.36724 
Train Epoch: 21 [41/1000 1312/32000 (4%)] Loss: 0.58447 (QuantReg: 11.96890) QuantErr: 11.96890 batch_time=0.38965 
Train Epoch: 21 [46/1000 1472/32000 (5%)] Loss: 0.77216 (QuantReg: 12.56870) QuantErr: 12.56870 batch_time=0.85333 
Train Epoch: 21 [51/1000 1632/32000 (5%)] Loss: 0.78210 (QuantReg: 12.49138) QuantErr: 12.49138 batch_time=0.37025 
Train Epoch: 21 [56/1000 1792/32000 (6%)] Loss: 0.46144 (QuantReg: 12.73402) QuantErr: 12.73402 batch_time=0.38793 
Train Epoch: 21 [61/1000 1952/32000 (6%)] Loss: 0.35252 (QuantReg: 13.06786) QuantErr: 13.06786 batch_time=0.47750 
Train Epoch: 21 [66/1000 2112/32000 (7%)] Loss: 0.54241 (QuantReg: 12.52394) QuantErr: 12.52394 batch_time=0.43972 
Train Epoch: 21 [71/1000 2272/32000 (7%)] Loss: 0.24068 (QuantReg: 12.34879) QuantErr: 12.34879 batch_time=0.39914 
Train Epoch: 21 [76/1000 2432/32000 (8%)] Loss: 0.37212 (QuantReg: 12.98876) QuantErr: 12.98876 batch_time=0.36111 
Train Epoch: 21 [81/1000 2592/32000 (8%)] Loss: 0.65258 (QuantReg: 13.50369) QuantErr: 13.50369 batch_time=0.40167 
Train Epoch: 21 [86/1000 2752/32000 (9%)] Loss: 0.50687 (QuantReg: 13.01434) QuantErr: 13.01434 batch_time=0.91295 
Train Epoch: 21 [91/1000 2912/32000 (9%)] Loss: 0.44369 (QuantReg: 11.96745) QuantErr: 11.96745 batch_time=0.81086 
Train Epoch: 21 [96/1000 3072/32000 (10%)] Loss: 0.31706 (QuantReg: 12.29012) QuantErr: 12.29012 batch_time=0.36691 
Train Epoch: 21 [101/1000 3232/32000 (10%)] Loss: 0.74721 (QuantReg: 12.54215) QuantErr: 12.54215 batch_time=0.34853 
Train Epoch: 21 [106/1000 3392/32000 (11%)] Loss: 0.42601 (QuantReg: 13.07266) QuantErr: 13.07266 batch_time=0.43117 
Train Epoch: 21 [111/1000 3552/32000 (11%)] Loss: 0.22308 (QuantReg: 12.31676) QuantErr: 12.31676 batch_time=0.39033 
Train Epoch: 21 [116/1000 3712/32000 (12%)] Loss: 0.87736 (QuantReg: 12.45578) QuantErr: 12.45578 batch_time=0.36900 
Train Epoch: 21 [121/1000 3872/32000 (12%)] Loss: 0.36302 (QuantReg: 12.51915) QuantErr: 12.51915 batch_time=0.44651 
Train Epoch: 21 [126/1000 4032/32000 (13%)] Loss: 0.72488 (QuantReg: 11.72475) QuantErr: 11.72475 batch_time=1.72598 
Train Epoch: 21 [131/1000 4192/32000 (13%)] Loss: 0.27578 (QuantReg: 13.30988) QuantErr: 13.30988 batch_time=0.47413 
Train Epoch: 21 [136/1000 4352/32000 (14%)] Loss: 1.18419 (QuantReg: 11.92526) QuantErr: 11.92526 batch_time=0.41092 
Train Epoch: 21 [141/1000 4512/32000 (14%)] Loss: 0.18807 (QuantReg: 12.41478) QuantErr: 12.41478 batch_time=0.60525 
Train Epoch: 21 [146/1000 4672/32000 (15%)] Loss: 0.45356 (QuantReg: 11.56358) QuantErr: 11.56358 batch_time=0.38969 
Train Epoch: 21 [151/1000 4832/32000 (15%)] Loss: 0.48789 (QuantReg: 12.65873) QuantErr: 12.65873 batch_time=0.33768 
Train Epoch: 21 [156/1000 4992/32000 (16%)] Loss: 0.42994 (QuantReg: 11.98705) QuantErr: 11.98705 batch_time=0.42467 
Train Epoch: 21 [161/1000 5152/32000 (16%)] Loss: 0.51056 (QuantReg: 12.66625) QuantErr: 12.66625 batch_time=0.36299 
Train Epoch: 21 [166/1000 5312/32000 (17%)] Loss: 0.46241 (QuantReg: 11.97907) QuantErr: 11.97907 batch_time=0.39589 
Train Epoch: 21 [171/1000 5472/32000 (17%)] Loss: 0.26970 (QuantReg: 12.94824) QuantErr: 12.94824 batch_time=0.38266 
Train Epoch: 21 [176/1000 5632/32000 (18%)] Loss: 0.27838 (QuantReg: 12.15739) QuantErr: 12.15739 batch_time=0.37405 
Train Epoch: 21 [181/1000 5792/32000 (18%)] Loss: 0.92849 (QuantReg: 12.29700) QuantErr: 12.29700 batch_time=0.35197 
Train Epoch: 21 [186/1000 5952/32000 (19%)] Loss: 0.59887 (QuantReg: 12.00817) QuantErr: 12.00817 batch_time=0.43231 
Train Epoch: 21 [191/1000 6112/32000 (19%)] Loss: 0.18036 (QuantReg: 12.39303) QuantErr: 12.39303 batch_time=0.35674 
Train Epoch: 21 [196/1000 6272/32000 (20%)] Loss: 0.43021 (QuantReg: 12.78124) QuantErr: 12.78124 batch_time=0.34576 
Train Epoch: 21 [201/1000 6432/32000 (20%)] Loss: 0.19450 (QuantReg: 12.90512) QuantErr: 12.90512 batch_time=0.37629 
Train Epoch: 21 [206/1000 6592/32000 (21%)] Loss: 0.36266 (QuantReg: 13.04810) QuantErr: 13.04810 batch_time=0.36988 
Train Epoch: 21 [211/1000 6752/32000 (21%)] Loss: 0.33305 (QuantReg: 13.13924) QuantErr: 13.13924 batch_time=0.81673 
Train Epoch: 21 [216/1000 6912/32000 (22%)] Loss: 0.45101 (QuantReg: 12.41196) QuantErr: 12.41196 batch_time=0.42669 
Train Epoch: 21 [221/1000 7072/32000 (22%)] Loss: 0.54998 (QuantReg: 12.59778) QuantErr: 12.59778 batch_time=0.66540 
Train Epoch: 21 [226/1000 7232/32000 (23%)] Loss: 0.35820 (QuantReg: 13.10523) QuantErr: 13.10523 batch_time=0.41368 
Train Epoch: 21 [231/1000 7392/32000 (23%)] Loss: 0.53462 (QuantReg: 12.93847) QuantErr: 12.93847 batch_time=0.64550 
Train Epoch: 21 [236/1000 7552/32000 (24%)] Loss: 0.24299 (QuantReg: 13.01772) QuantErr: 13.01772 batch_time=0.37385 
Train Epoch: 21 [241/1000 7712/32000 (24%)] Loss: 0.32245 (QuantReg: 12.71681) QuantErr: 12.71681 batch_time=0.46276 
Train Epoch: 21 [246/1000 7872/32000 (25%)] Loss: 0.36929 (QuantReg: 12.01375) QuantErr: 12.01375 batch_time=0.44074 
Train Epoch: 21 [251/1000 8032/32000 (25%)] Loss: 0.38726 (QuantReg: 12.76931) QuantErr: 12.76931 batch_time=0.42378 
Train Epoch: 21 [256/1000 8192/32000 (26%)] Loss: 0.72483 (QuantReg: 12.34768) QuantErr: 12.34768 batch_time=0.41802 
Train Epoch: 21 [261/1000 8352/32000 (26%)] Loss: 0.55865 (QuantReg: 12.73904) QuantErr: 12.73904 batch_time=0.41006 
Train Epoch: 21 [266/1000 8512/32000 (27%)] Loss: 1.09605 (QuantReg: 12.52595) QuantErr: 12.52595 batch_time=0.34341 
Train Epoch: 21 [271/1000 8672/32000 (27%)] Loss: 0.45795 (QuantReg: 12.00085) QuantErr: 12.00085 batch_time=0.34380 
Train Epoch: 21 [276/1000 8832/32000 (28%)] Loss: 0.31643 (QuantReg: 12.37751) QuantErr: 12.37751 batch_time=0.37484 
Train Epoch: 21 [281/1000 8992/32000 (28%)] Loss: 0.56859 (QuantReg: 11.82455) QuantErr: 11.82455 batch_time=0.60560 
Train Epoch: 21 [286/1000 9152/32000 (29%)] Loss: 0.32441 (QuantReg: 13.48496) QuantErr: 13.48496 batch_time=0.38973 
Train Epoch: 21 [291/1000 9312/32000 (29%)] Loss: 0.55336 (QuantReg: 13.28611) QuantErr: 13.28611 batch_time=0.49382 
Train Epoch: 21 [296/1000 9472/32000 (30%)] Loss: 0.32108 (QuantReg: 12.84304) QuantErr: 12.84304 batch_time=0.35427 
Train Epoch: 21 [301/1000 9632/32000 (30%)] Loss: 0.36623 (QuantReg: 12.63238) QuantErr: 12.63238 batch_time=0.43232 
Train Epoch: 21 [306/1000 9792/32000 (31%)] Loss: 0.27969 (QuantReg: 12.32471) QuantErr: 12.32471 batch_time=0.37236 
Train Epoch: 21 [311/1000 9952/32000 (31%)] Loss: 0.43573 (QuantReg: 13.22911) QuantErr: 13.22911 batch_time=0.43170 
Train Epoch: 21 [316/1000 10112/32000 (32%)] Loss: 0.22342 (QuantReg: 12.71722) QuantErr: 12.71722 batch_time=0.44890 
Train Epoch: 21 [321/1000 10272/32000 (32%)] Loss: 0.42293 (QuantReg: 12.67113) QuantErr: 12.67113 batch_time=0.37743 
Train Epoch: 21 [326/1000 10432/32000 (33%)] Loss: 0.53543 (QuantReg: 12.46183) QuantErr: 12.46183 batch_time=0.45978 
Train Epoch: 21 [331/1000 10592/32000 (33%)] Loss: 0.54181 (QuantReg: 12.69150) QuantErr: 12.69150 batch_time=0.47159 
Train Epoch: 21 [336/1000 10752/32000 (34%)] Loss: 0.57884 (QuantReg: 12.19639) QuantErr: 12.19639 batch_time=0.35531 
Train Epoch: 21 [341/1000 10912/32000 (34%)] Loss: 0.31551 (QuantReg: 12.26075) QuantErr: 12.26075 batch_time=0.38132 
Train Epoch: 21 [346/1000 11072/32000 (35%)] Loss: 0.22930 (QuantReg: 12.97591) QuantErr: 12.97591 batch_time=0.35283 
Train Epoch: 21 [351/1000 11232/32000 (35%)] Loss: 0.57990 (QuantReg: 12.04201) QuantErr: 12.04201 batch_time=0.36552 
Train Epoch: 21 [356/1000 11392/32000 (36%)] Loss: 0.38667 (QuantReg: 12.36195) QuantErr: 12.36195 batch_time=0.39375 
Train Epoch: 21 [361/1000 11552/32000 (36%)] Loss: 0.52043 (QuantReg: 13.55679) QuantErr: 13.55679 batch_time=0.62394 
Train Epoch: 21 [366/1000 11712/32000 (37%)] Loss: 0.13467 (QuantReg: 12.97867) QuantErr: 12.97867 batch_time=0.43919 
Train Epoch: 21 [371/1000 11872/32000 (37%)] Loss: 0.77726 (QuantReg: 12.16252) QuantErr: 12.16252 batch_time=0.36220 
Train Epoch: 21 [376/1000 12032/32000 (38%)] Loss: 0.43606 (QuantReg: 12.51126) QuantErr: 12.51126 batch_time=0.66670 
Train Epoch: 21 [381/1000 12192/32000 (38%)] Loss: 0.72221 (QuantReg: 12.89743) QuantErr: 12.89743 batch_time=0.38606 
Train Epoch: 21 [386/1000 12352/32000 (39%)] Loss: 0.30994 (QuantReg: 12.88072) QuantErr: 12.88072 batch_time=0.54483 
Train Epoch: 21 [391/1000 12512/32000 (39%)] Loss: 0.51451 (QuantReg: 11.59105) QuantErr: 11.59105 batch_time=0.39711 
Train Epoch: 21 [396/1000 12672/32000 (40%)] Loss: 0.47147 (QuantReg: 12.76218) QuantErr: 12.76218 batch_time=0.41585 
Train Epoch: 21 [401/1000 12832/32000 (40%)] Loss: 0.30267 (QuantReg: 12.14965) QuantErr: 12.14965 batch_time=0.38340 
Train Epoch: 21 [406/1000 12992/32000 (41%)] Loss: 0.36824 (QuantReg: 12.77017) QuantErr: 12.77017 batch_time=0.91866 
Train Epoch: 21 [411/1000 13152/32000 (41%)] Loss: 0.21484 (QuantReg: 12.53656) QuantErr: 12.53656 batch_time=0.35817 
Train Epoch: 21 [416/1000 13312/32000 (42%)] Loss: 0.36053 (QuantReg: 12.40172) QuantErr: 12.40172 batch_time=0.34173 
Train Epoch: 21 [421/1000 13472/32000 (42%)] Loss: 0.21998 (QuantReg: 12.49578) QuantErr: 12.49578 batch_time=0.74178 
Train Epoch: 21 [426/1000 13632/32000 (43%)] Loss: 0.66667 (QuantReg: 11.96040) QuantErr: 11.96040 batch_time=0.54364 
Train Epoch: 21 [431/1000 13792/32000 (43%)] Loss: 0.34405 (QuantReg: 13.19770) QuantErr: 13.19770 batch_time=0.34472 
Train Epoch: 21 [436/1000 13952/32000 (44%)] Loss: 0.93059 (QuantReg: 12.90525) QuantErr: 12.90525 batch_time=0.39895 
Train Epoch: 21 [441/1000 14112/32000 (44%)] Loss: 0.72110 (QuantReg: 12.18843) QuantErr: 12.18843 batch_time=0.35630 
Train Epoch: 21 [446/1000 14272/32000 (45%)] Loss: 0.28133 (QuantReg: 12.44368) QuantErr: 12.44368 batch_time=1.24123 
Train Epoch: 21 [451/1000 14432/32000 (45%)] Loss: 0.26377 (QuantReg: 12.98673) QuantErr: 12.98673 batch_time=0.37682 
Train Epoch: 21 [456/1000 14592/32000 (46%)] Loss: 0.56489 (QuantReg: 12.48075) QuantErr: 12.48075 batch_time=0.37892 
Train Epoch: 21 [461/1000 14752/32000 (46%)] Loss: 0.13872 (QuantReg: 13.03186) QuantErr: 13.03186 batch_time=0.35698 
Train Epoch: 21 [466/1000 14912/32000 (47%)] Loss: 0.48063 (QuantReg: 13.16189) QuantErr: 13.16189 batch_time=0.37287 
Train Epoch: 21 [471/1000 15072/32000 (47%)] Loss: 0.39170 (QuantReg: 12.88646) QuantErr: 12.88646 batch_time=0.57318 
Train Epoch: 21 [476/1000 15232/32000 (48%)] Loss: 0.22120 (QuantReg: 13.34989) QuantErr: 13.34989 batch_time=0.42135 
Train Epoch: 21 [481/1000 15392/32000 (48%)] Loss: 0.37930 (QuantReg: 12.36332) QuantErr: 12.36332 batch_time=0.39528 
Train Epoch: 21 [486/1000 15552/32000 (49%)] Loss: 0.62188 (QuantReg: 12.64585) QuantErr: 12.64585 batch_time=0.36658 
Train Epoch: 21 [491/1000 15712/32000 (49%)] Loss: 0.47293 (QuantReg: 13.32828) QuantErr: 13.32828 batch_time=0.36720 
Train Epoch: 21 [496/1000 15872/32000 (50%)] Loss: 0.50232 (QuantReg: 12.76390) QuantErr: 12.76390 batch_time=0.34124 
Train Epoch: 21 [501/1000 16032/32000 (50%)] Loss: 0.18428 (QuantReg: 13.04474) QuantErr: 13.04474 batch_time=0.42862 
Train Epoch: 21 [506/1000 16192/32000 (51%)] Loss: 0.36299 (QuantReg: 12.65513) QuantErr: 12.65513 batch_time=0.41218 
Train Epoch: 21 [511/1000 16352/32000 (51%)] Loss: 0.35178 (QuantReg: 12.92324) QuantErr: 12.92324 batch_time=0.35461 
Train Epoch: 21 [516/1000 16512/32000 (52%)] Loss: 0.54254 (QuantReg: 12.71378) QuantErr: 12.71378 batch_time=0.49476 
Train Epoch: 21 [521/1000 16672/32000 (52%)] Loss: 0.59653 (QuantReg: 11.70366) QuantErr: 11.70366 batch_time=0.43338 
Train Epoch: 21 [526/1000 16832/32000 (53%)] Loss: 0.59795 (QuantReg: 13.29444) QuantErr: 13.29444 batch_time=0.43546 
Train Epoch: 21 [531/1000 16992/32000 (53%)] Loss: 0.35030 (QuantReg: 12.54975) QuantErr: 12.54975 batch_time=0.36632 
Train Epoch: 21 [536/1000 17152/32000 (54%)] Loss: 0.50100 (QuantReg: 13.35870) QuantErr: 13.35870 batch_time=1.13027 
Train Epoch: 21 [541/1000 17312/32000 (54%)] Loss: 0.86371 (QuantReg: 13.06581) QuantErr: 13.06581 batch_time=0.38167 
Train Epoch: 21 [546/1000 17472/32000 (55%)] Loss: 0.38975 (QuantReg: 12.91602) QuantErr: 12.91602 batch_time=0.43297 
Train Epoch: 21 [551/1000 17632/32000 (55%)] Loss: 0.41547 (QuantReg: 13.19705) QuantErr: 13.19705 batch_time=0.37527 
Train Epoch: 21 [556/1000 17792/32000 (56%)] Loss: 0.41303 (QuantReg: 13.20835) QuantErr: 13.20835 batch_time=0.35698 
Train Epoch: 21 [561/1000 17952/32000 (56%)] Loss: 0.43312 (QuantReg: 13.09714) QuantErr: 13.09714 batch_time=0.65287 
Train Epoch: 21 [566/1000 18112/32000 (57%)] Loss: 0.47463 (QuantReg: 12.50972) QuantErr: 12.50972 batch_time=0.44672 
Train Epoch: 21 [571/1000 18272/32000 (57%)] Loss: 0.41505 (QuantReg: 12.50040) QuantErr: 12.50040 batch_time=0.38769 
Train Epoch: 21 [576/1000 18432/32000 (58%)] Loss: 0.62846 (QuantReg: 13.38014) QuantErr: 13.38014 batch_time=0.41833 
Train Epoch: 21 [581/1000 18592/32000 (58%)] Loss: 0.49704 (QuantReg: 13.09731) QuantErr: 13.09731 batch_time=0.34096 
Train Epoch: 21 [586/1000 18752/32000 (59%)] Loss: 0.33673 (QuantReg: 12.33800) QuantErr: 12.33800 batch_time=0.42161 
Train Epoch: 21 [591/1000 18912/32000 (59%)] Loss: 0.92722 (QuantReg: 12.42048) QuantErr: 12.42048 batch_time=0.42613 
Train Epoch: 21 [596/1000 19072/32000 (60%)] Loss: 0.41073 (QuantReg: 12.16940) QuantErr: 12.16940 batch_time=0.36478 
Train Epoch: 21 [601/1000 19232/32000 (60%)] Loss: 0.49021 (QuantReg: 13.21088) QuantErr: 13.21088 batch_time=0.34609 
Train Epoch: 21 [606/1000 19392/32000 (61%)] Loss: 0.42806 (QuantReg: 12.66886) QuantErr: 12.66886 batch_time=0.59279 
Train Epoch: 21 [611/1000 19552/32000 (61%)] Loss: 0.46110 (QuantReg: 12.89844) QuantErr: 12.89844 batch_time=0.35760 
Train Epoch: 21 [616/1000 19712/32000 (62%)] Loss: 0.47177 (QuantReg: 13.17332) QuantErr: 13.17332 batch_time=0.45622 
Train Epoch: 21 [621/1000 19872/32000 (62%)] Loss: 0.90926 (QuantReg: 12.53981) QuantErr: 12.53981 batch_time=0.56564 
Train Epoch: 21 [626/1000 20032/32000 (63%)] Loss: 0.30763 (QuantReg: 13.30835) QuantErr: 13.30835 batch_time=0.43954 
Train Epoch: 21 [631/1000 20192/32000 (63%)] Loss: 0.61573 (QuantReg: 12.36707) QuantErr: 12.36707 batch_time=0.37600 
Train Epoch: 21 [636/1000 20352/32000 (64%)] Loss: 0.40244 (QuantReg: 13.14066) QuantErr: 13.14066 batch_time=0.41512 
Train Epoch: 21 [641/1000 20512/32000 (64%)] Loss: 0.90180 (QuantReg: 12.27453) QuantErr: 12.27453 batch_time=0.43206 
Train Epoch: 21 [646/1000 20672/32000 (65%)] Loss: 0.34643 (QuantReg: 12.40554) QuantErr: 12.40554 batch_time=0.34034 
Train Epoch: 21 [651/1000 20832/32000 (65%)] Loss: 0.53587 (QuantReg: 13.32958) QuantErr: 13.32958 batch_time=0.39316 
Train Epoch: 21 [656/1000 20992/32000 (66%)] Loss: 0.33962 (QuantReg: 12.14485) QuantErr: 12.14485 batch_time=0.68291 
Train Epoch: 21 [661/1000 21152/32000 (66%)] Loss: 0.22882 (QuantReg: 12.90114) QuantErr: 12.90114 batch_time=0.37742 
Train Epoch: 21 [666/1000 21312/32000 (67%)] Loss: 0.72479 (QuantReg: 12.43301) QuantErr: 12.43301 batch_time=0.41099 
Train Epoch: 21 [671/1000 21472/32000 (67%)] Loss: 0.24152 (QuantReg: 13.18774) QuantErr: 13.18774 batch_time=0.39867 
Train Epoch: 21 [676/1000 21632/32000 (68%)] Loss: 0.35476 (QuantReg: 13.10484) QuantErr: 13.10484 batch_time=0.38019 
Train Epoch: 21 [681/1000 21792/32000 (68%)] Loss: 0.34455 (QuantReg: 12.43456) QuantErr: 12.43456 batch_time=0.48288 
Train Epoch: 21 [686/1000 21952/32000 (69%)] Loss: 0.37832 (QuantReg: 12.45651) QuantErr: 12.45651 batch_time=0.46331 
Train Epoch: 21 [691/1000 22112/32000 (69%)] Loss: 0.53330 (QuantReg: 12.02291) QuantErr: 12.02291 batch_time=0.46024 
Train Epoch: 21 [696/1000 22272/32000 (70%)] Loss: 0.34380 (QuantReg: 12.55307) QuantErr: 12.55307 batch_time=0.33686 
Train Epoch: 21 [701/1000 22432/32000 (70%)] Loss: 0.76744 (QuantReg: 12.59807) QuantErr: 12.59807 batch_time=0.46366 
Train Epoch: 21 [706/1000 22592/32000 (71%)] Loss: 0.37307 (QuantReg: 12.80573) QuantErr: 12.80573 batch_time=0.36608 
Train Epoch: 21 [711/1000 22752/32000 (71%)] Loss: 1.25641 (QuantReg: 12.03063) QuantErr: 12.03063 batch_time=0.50923 
Train Epoch: 21 [716/1000 22912/32000 (72%)] Loss: 0.30436 (QuantReg: 12.69127) QuantErr: 12.69127 batch_time=0.36344 
Train Epoch: 21 [721/1000 23072/32000 (72%)] Loss: 0.57770 (QuantReg: 12.55241) QuantErr: 12.55241 batch_time=0.43609 
Train Epoch: 21 [726/1000 23232/32000 (73%)] Loss: 0.23902 (QuantReg: 12.92031) QuantErr: 12.92031 batch_time=1.17598 
Train Epoch: 21 [731/1000 23392/32000 (73%)] Loss: 0.34669 (QuantReg: 12.55821) QuantErr: 12.55821 batch_time=0.42143 
Train Epoch: 21 [736/1000 23552/32000 (74%)] Loss: 0.04518 (QuantReg: 12.05652) QuantErr: 12.05652 batch_time=0.40456 
Train Epoch: 21 [741/1000 23712/32000 (74%)] Loss: 0.56358 (QuantReg: 12.38059) QuantErr: 12.38059 batch_time=0.37464 
Train Epoch: 21 [746/1000 23872/32000 (75%)] Loss: 0.31331 (QuantReg: 12.63869) QuantErr: 12.63869 batch_time=0.44053 
Train Epoch: 21 [751/1000 24032/32000 (75%)] Loss: 0.46774 (QuantReg: 11.76167) QuantErr: 11.76167 batch_time=0.36017 
Train Epoch: 21 [756/1000 24192/32000 (76%)] Loss: 0.53418 (QuantReg: 12.92472) QuantErr: 12.92472 batch_time=0.38148 
Train Epoch: 21 [761/1000 24352/32000 (76%)] Loss: 0.49850 (QuantReg: 12.18553) QuantErr: 12.18553 batch_time=0.41345 
Train Epoch: 21 [766/1000 24512/32000 (77%)] Loss: 0.36796 (QuantReg: 13.04496) QuantErr: 13.04496 batch_time=0.35096 
Train Epoch: 21 [771/1000 24672/32000 (77%)] Loss: 0.33697 (QuantReg: 13.36298) QuantErr: 13.36298 batch_time=0.36401 
Train Epoch: 21 [776/1000 24832/32000 (78%)] Loss: 0.50229 (QuantReg: 12.71044) QuantErr: 12.71044 batch_time=0.41151 
Train Epoch: 21 [781/1000 24992/32000 (78%)] Loss: 0.38975 (QuantReg: 12.82404) QuantErr: 12.82404 batch_time=0.48350 
Train Epoch: 21 [786/1000 25152/32000 (79%)] Loss: 0.64809 (QuantReg: 13.01407) QuantErr: 13.01407 batch_time=0.35891 
Train Epoch: 21 [791/1000 25312/32000 (79%)] Loss: 0.48822 (QuantReg: 12.31268) QuantErr: 12.31268 batch_time=0.85156 
Train Epoch: 21 [796/1000 25472/32000 (80%)] Loss: 0.54309 (QuantReg: 13.26118) QuantErr: 13.26118 batch_time=0.38994 
Train Epoch: 21 [801/1000 25632/32000 (80%)] Loss: 0.72694 (QuantReg: 12.69966) QuantErr: 12.69966 batch_time=0.34009 
Train Epoch: 21 [806/1000 25792/32000 (81%)] Loss: 0.96523 (QuantReg: 12.77566) QuantErr: 12.77566 batch_time=0.83414 
Train Epoch: 21 [811/1000 25952/32000 (81%)] Loss: 0.54231 (QuantReg: 12.56869) QuantErr: 12.56869 batch_time=0.40342 
Train Epoch: 21 [816/1000 26112/32000 (82%)] Loss: 0.83097 (QuantReg: 12.39161) QuantErr: 12.39161 batch_time=0.44185 
Train Epoch: 21 [821/1000 26272/32000 (82%)] Loss: 0.59030 (QuantReg: 12.46036) QuantErr: 12.46036 batch_time=0.36346 
Train Epoch: 21 [826/1000 26432/32000 (83%)] Loss: 0.40085 (QuantReg: 12.72801) QuantErr: 12.72801 batch_time=0.44869 
Train Epoch: 21 [831/1000 26592/32000 (83%)] Loss: 0.45674 (QuantReg: 13.14006) QuantErr: 13.14006 batch_time=0.37213 
Train Epoch: 21 [836/1000 26752/32000 (84%)] Loss: 0.51492 (QuantReg: 12.77562) QuantErr: 12.77562 batch_time=0.91481 
Train Epoch: 21 [841/1000 26912/32000 (84%)] Loss: 0.32757 (QuantReg: 12.62260) QuantErr: 12.62260 batch_time=0.38895 
Train Epoch: 21 [846/1000 27072/32000 (85%)] Loss: 0.66320 (QuantReg: 12.52691) QuantErr: 12.52691 batch_time=0.50754 
Train Epoch: 21 [851/1000 27232/32000 (85%)] Loss: 0.25281 (QuantReg: 12.70410) QuantErr: 12.70410 batch_time=0.42658 
Train Epoch: 21 [856/1000 27392/32000 (86%)] Loss: 0.58106 (QuantReg: 12.78710) QuantErr: 12.78710 batch_time=0.45170 
Train Epoch: 21 [861/1000 27552/32000 (86%)] Loss: 0.52846 (QuantReg: 13.08142) QuantErr: 13.08142 batch_time=0.37362 
Train Epoch: 21 [866/1000 27712/32000 (87%)] Loss: 0.14571 (QuantReg: 11.47690) QuantErr: 11.47690 batch_time=0.41121 
Train Epoch: 21 [871/1000 27872/32000 (87%)] Loss: 0.54619 (QuantReg: 12.31912) QuantErr: 12.31912 batch_time=0.40911 
Train Epoch: 21 [876/1000 28032/32000 (88%)] Loss: 0.42574 (QuantReg: 12.45777) QuantErr: 12.45777 batch_time=0.52953 
Train Epoch: 21 [881/1000 28192/32000 (88%)] Loss: 0.44913 (QuantReg: 12.19022) QuantErr: 12.19022 batch_time=0.34329 
Train Epoch: 21 [886/1000 28352/32000 (89%)] Loss: 0.53706 (QuantReg: 12.70913) QuantErr: 12.70913 batch_time=0.60685 
Train Epoch: 21 [891/1000 28512/32000 (89%)] Loss: 0.68212 (QuantReg: 13.02041) QuantErr: 13.02041 batch_time=0.34866 
Train Epoch: 21 [896/1000 28672/32000 (90%)] Loss: 0.42172 (QuantReg: 12.89600) QuantErr: 12.89600 batch_time=0.40831 
Train Epoch: 21 [901/1000 28832/32000 (90%)] Loss: 0.45144 (QuantReg: 12.17203) QuantErr: 12.17203 batch_time=0.48389 
Train Epoch: 21 [906/1000 28992/32000 (91%)] Loss: 0.49425 (QuantReg: 12.93774) QuantErr: 12.93774 batch_time=0.40916 
Train Epoch: 21 [911/1000 29152/32000 (91%)] Loss: 0.20786 (QuantReg: 12.79684) QuantErr: 12.79684 batch_time=0.37779 
Train Epoch: 21 [916/1000 29312/32000 (92%)] Loss: 0.33051 (QuantReg: 13.12862) QuantErr: 13.12862 batch_time=0.41013 
Train Epoch: 21 [921/1000 29472/32000 (92%)] Loss: 0.32290 (QuantReg: 12.47360) QuantErr: 12.47360 batch_time=0.39853 
Train Epoch: 21 [926/1000 29632/32000 (93%)] Loss: 0.29269 (QuantReg: 13.08617) QuantErr: 13.08617 batch_time=0.43773 
Train Epoch: 21 [931/1000 29792/32000 (93%)] Loss: 0.31733 (QuantReg: 12.62505) QuantErr: 12.62505 batch_time=0.41443 
Train Epoch: 21 [936/1000 29952/32000 (94%)] Loss: 0.30565 (QuantReg: 13.47173) QuantErr: 13.47173 batch_time=0.62406 
Train Epoch: 21 [941/1000 30112/32000 (94%)] Loss: 0.31409 (QuantReg: 13.02088) QuantErr: 13.02088 batch_time=0.40199 
Train Epoch: 21 [946/1000 30272/32000 (95%)] Loss: 0.69304 (QuantReg: 12.60092) QuantErr: 12.60092 batch_time=0.51944 
Train Epoch: 21 [951/1000 30432/32000 (95%)] Loss: 0.67216 (QuantReg: 12.94397) QuantErr: 12.94397 batch_time=0.34565 
Train Epoch: 21 [956/1000 30592/32000 (96%)] Loss: 0.44411 (QuantReg: 12.03280) QuantErr: 12.03280 batch_time=0.36048 
Train Epoch: 21 [961/1000 30752/32000 (96%)] Loss: 0.47134 (QuantReg: 12.58323) QuantErr: 12.58323 batch_time=1.41393 
Train Epoch: 21 [966/1000 30912/32000 (97%)] Loss: 0.28212 (QuantReg: 12.91218) QuantErr: 12.91218 batch_time=0.42983 
Train Epoch: 21 [971/1000 31072/32000 (97%)] Loss: 0.54426 (QuantReg: 12.47526) QuantErr: 12.47526 batch_time=0.52505 
Train Epoch: 21 [976/1000 31232/32000 (98%)] Loss: 0.36882 (QuantReg: 12.93041) QuantErr: 12.93041 batch_time=1.08559 
Train Epoch: 21 [981/1000 31392/32000 (98%)] Loss: 0.52854 (QuantReg: 12.96701) QuantErr: 12.96701 batch_time=0.34970 
Train Epoch: 21 [986/1000 31552/32000 (99%)] Loss: 0.49453 (QuantReg: 12.60384) QuantErr: 12.60384 batch_time=0.43620 
Train Epoch: 21 [991/1000 31712/32000 (99%)] Loss: 0.77339 (QuantReg: 12.38118) QuantErr: 12.38118 batch_time=0.55048 
Train Epoch: 21 [996/1000 31872/32000 (100%)] Loss: 0.38364 (QuantReg: 13.25704) QuantErr: 13.25704 batch_time=0.35149 
Train Epoch: 21 codebook_update_time=2.21299
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch21.pth ...
Done in 7.292s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 0.4653441012464464
 quant_reg      : 12.660599459648132
 quant_err      : 12.660599459648132
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 21000
 MSRVTT_miech_test/t2v_metrics/R1: 18.9
 MSRVTT_miech_test/t2v_metrics/R5: 47.8
 MSRVTT_miech_test/t2v_metrics/R10: 60.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.277
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.88745184155794
 MSRVTT_miech_test/v2t_metrics/R1: 17.1
 MSRVTT_miech_test/v2t_metrics/R5: 46.1
 MSRVTT_miech_test/v2t_metrics/R10: 61.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.6285
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.384193162979436
 mnt_best       : 38.45489562444897
 not_improved_count: 1
Train Epoch: 22 [1/1000 32/32000 (0%)] Loss: 0.24128 (QuantReg: 13.06535) QuantErr: 13.06535 batch_time=29.04345 
Train Epoch: 22 [6/1000 192/32000 (1%)] Loss: 0.81093 (QuantReg: 12.59478) QuantErr: 12.59478 batch_time=0.41880 
Train Epoch: 22 [11/1000 352/32000 (1%)] Loss: 0.35706 (QuantReg: 12.54471) QuantErr: 12.54471 batch_time=0.44808 
Train Epoch: 22 [16/1000 512/32000 (2%)] Loss: 0.70362 (QuantReg: 12.28350) QuantErr: 12.28350 batch_time=0.43937 
Train Epoch: 22 [21/1000 672/32000 (2%)] Loss: 0.52951 (QuantReg: 11.82411) QuantErr: 11.82411 batch_time=1.24504 
Train Epoch: 22 [26/1000 832/32000 (3%)] Loss: 0.74035 (QuantReg: 12.56460) QuantErr: 12.56460 batch_time=0.63997 
Train Epoch: 22 [31/1000 992/32000 (3%)] Loss: 0.85699 (QuantReg: 12.94851) QuantErr: 12.94851 batch_time=0.43140 
Train Epoch: 22 [36/1000 1152/32000 (4%)] Loss: 0.20054 (QuantReg: 12.47174) QuantErr: 12.47174 batch_time=0.36763 
Train Epoch: 22 [41/1000 1312/32000 (4%)] Loss: 0.45791 (QuantReg: 11.96023) QuantErr: 11.96023 batch_time=0.44388 
Train Epoch: 22 [46/1000 1472/32000 (5%)] Loss: 0.46886 (QuantReg: 12.89201) QuantErr: 12.89201 batch_time=0.45390 
Train Epoch: 22 [51/1000 1632/32000 (5%)] Loss: 0.26835 (QuantReg: 12.63036) QuantErr: 12.63036 batch_time=0.33203 
Train Epoch: 22 [56/1000 1792/32000 (6%)] Loss: 0.38683 (QuantReg: 13.43702) QuantErr: 13.43702 batch_time=0.54233 
Train Epoch: 22 [61/1000 1952/32000 (6%)] Loss: 0.57492 (QuantReg: 11.92426) QuantErr: 11.92426 batch_time=0.35057 
Train Epoch: 22 [66/1000 2112/32000 (7%)] Loss: 0.31779 (QuantReg: 12.22746) QuantErr: 12.22746 batch_time=0.35597 
Train Epoch: 22 [71/1000 2272/32000 (7%)] Loss: 0.88293 (QuantReg: 12.84884) QuantErr: 12.84884 batch_time=0.41253 
Train Epoch: 22 [76/1000 2432/32000 (8%)] Loss: 1.02898 (QuantReg: 12.24338) QuantErr: 12.24338 batch_time=0.37502 
Train Epoch: 22 [81/1000 2592/32000 (8%)] Loss: 0.93892 (QuantReg: 12.90067) QuantErr: 12.90067 batch_time=0.62931 
Train Epoch: 22 [86/1000 2752/32000 (9%)] Loss: 0.16744 (QuantReg: 11.90337) QuantErr: 11.90337 batch_time=0.35322 
Train Epoch: 22 [91/1000 2912/32000 (9%)] Loss: 0.52679 (QuantReg: 12.58850) QuantErr: 12.58850 batch_time=0.48307 
Train Epoch: 22 [96/1000 3072/32000 (10%)] Loss: 0.48799 (QuantReg: 12.49805) QuantErr: 12.49805 batch_time=0.75617 
Train Epoch: 22 [101/1000 3232/32000 (10%)] Loss: 0.25017 (QuantReg: 12.13298) QuantErr: 12.13298 batch_time=0.38792 
Train Epoch: 22 [106/1000 3392/32000 (11%)] Loss: 0.67168 (QuantReg: 12.54960) QuantErr: 12.54960 batch_time=0.51931 
Train Epoch: 22 [111/1000 3552/32000 (11%)] Loss: 0.45982 (QuantReg: 12.83887) QuantErr: 12.83887 batch_time=0.39055 
Train Epoch: 22 [116/1000 3712/32000 (12%)] Loss: 0.29478 (QuantReg: 12.29869) QuantErr: 12.29869 batch_time=0.37559 
Train Epoch: 22 [121/1000 3872/32000 (12%)] Loss: 0.26034 (QuantReg: 12.55622) QuantErr: 12.55622 batch_time=0.42355 
Train Epoch: 22 [126/1000 4032/32000 (13%)] Loss: 0.67366 (QuantReg: 12.49597) QuantErr: 12.49597 batch_time=0.42683 
Train Epoch: 22 [131/1000 4192/32000 (13%)] Loss: 0.31973 (QuantReg: 12.95321) QuantErr: 12.95321 batch_time=0.37833 
Train Epoch: 22 [136/1000 4352/32000 (14%)] Loss: 0.51105 (QuantReg: 12.54827) QuantErr: 12.54827 batch_time=0.38785 
Train Epoch: 22 [141/1000 4512/32000 (14%)] Loss: 0.55912 (QuantReg: 12.40450) QuantErr: 12.40450 batch_time=0.96834 
Train Epoch: 22 [146/1000 4672/32000 (15%)] Loss: 0.57773 (QuantReg: 12.07466) QuantErr: 12.07466 batch_time=0.34077 
Train Epoch: 22 [151/1000 4832/32000 (15%)] Loss: 0.23773 (QuantReg: 12.83290) QuantErr: 12.83290 batch_time=0.44025 
Train Epoch: 22 [156/1000 4992/32000 (16%)] Loss: 0.27629 (QuantReg: 12.91350) QuantErr: 12.91350 batch_time=0.47081 
Train Epoch: 22 [161/1000 5152/32000 (16%)] Loss: 0.34957 (QuantReg: 12.83245) QuantErr: 12.83245 batch_time=0.38116 
Train Epoch: 22 [166/1000 5312/32000 (17%)] Loss: 0.30478 (QuantReg: 12.27186) QuantErr: 12.27186 batch_time=0.37517 
Train Epoch: 22 [171/1000 5472/32000 (17%)] Loss: 0.30468 (QuantReg: 13.26704) QuantErr: 13.26704 batch_time=0.38674 
Train Epoch: 22 [176/1000 5632/32000 (18%)] Loss: 0.76850 (QuantReg: 12.41843) QuantErr: 12.41843 batch_time=0.60020 
Train Epoch: 22 [181/1000 5792/32000 (18%)] Loss: 0.56191 (QuantReg: 12.79594) QuantErr: 12.79594 batch_time=0.34396 
Train Epoch: 22 [186/1000 5952/32000 (19%)] Loss: 0.20853 (QuantReg: 12.81700) QuantErr: 12.81700 batch_time=0.59408 
Train Epoch: 22 [191/1000 6112/32000 (19%)] Loss: 0.13930 (QuantReg: 13.36720) QuantErr: 13.36720 batch_time=0.39750 
Train Epoch: 22 [196/1000 6272/32000 (20%)] Loss: 0.63107 (QuantReg: 12.41514) QuantErr: 12.41514 batch_time=0.34615 
Train Epoch: 22 [201/1000 6432/32000 (20%)] Loss: 0.29201 (QuantReg: 12.84931) QuantErr: 12.84931 batch_time=0.39307 
Train Epoch: 22 [206/1000 6592/32000 (21%)] Loss: 0.37661 (QuantReg: 12.82135) QuantErr: 12.82135 batch_time=0.35151 
Train Epoch: 22 [211/1000 6752/32000 (21%)] Loss: 0.28222 (QuantReg: 12.49883) QuantErr: 12.49883 batch_time=0.39459 
Train Epoch: 22 [216/1000 6912/32000 (22%)] Loss: 0.52230 (QuantReg: 12.78365) QuantErr: 12.78365 batch_time=0.34802 
Train Epoch: 22 [221/1000 7072/32000 (22%)] Loss: 0.32854 (QuantReg: 12.54447) QuantErr: 12.54447 batch_time=0.34470 
Train Epoch: 22 [226/1000 7232/32000 (23%)] Loss: 0.41597 (QuantReg: 12.88515) QuantErr: 12.88515 batch_time=0.36089 
Train Epoch: 22 [231/1000 7392/32000 (23%)] Loss: 0.23244 (QuantReg: 12.39912) QuantErr: 12.39912 batch_time=0.50811 
Train Epoch: 22 [236/1000 7552/32000 (24%)] Loss: 0.34447 (QuantReg: 11.80114) QuantErr: 11.80114 batch_time=0.40458 
Train Epoch: 22 [241/1000 7712/32000 (24%)] Loss: 0.46110 (QuantReg: 12.74809) QuantErr: 12.74809 batch_time=0.34033 
Train Epoch: 22 [246/1000 7872/32000 (25%)] Loss: 0.31867 (QuantReg: 12.23559) QuantErr: 12.23559 batch_time=0.40981 
Train Epoch: 22 [251/1000 8032/32000 (25%)] Loss: 0.47291 (QuantReg: 12.85773) QuantErr: 12.85773 batch_time=0.35627 
Train Epoch: 22 [256/1000 8192/32000 (26%)] Loss: 0.44798 (QuantReg: 12.34170) QuantErr: 12.34170 batch_time=0.35804 
Train Epoch: 22 [261/1000 8352/32000 (26%)] Loss: 0.41289 (QuantReg: 12.86621) QuantErr: 12.86621 batch_time=0.43299 
Train Epoch: 22 [266/1000 8512/32000 (27%)] Loss: 0.25715 (QuantReg: 12.84362) QuantErr: 12.84362 batch_time=0.43341 
Train Epoch: 22 [271/1000 8672/32000 (27%)] Loss: 0.60802 (QuantReg: 12.41265) QuantErr: 12.41265 batch_time=0.46242 
Train Epoch: 22 [276/1000 8832/32000 (28%)] Loss: 0.12074 (QuantReg: 12.48649) QuantErr: 12.48649 batch_time=0.40021 
Train Epoch: 22 [281/1000 8992/32000 (28%)] Loss: 0.34955 (QuantReg: 12.83169) QuantErr: 12.83169 batch_time=0.40712 
Train Epoch: 22 [286/1000 9152/32000 (29%)] Loss: 0.41907 (QuantReg: 12.43427) QuantErr: 12.43427 batch_time=1.03922 
Train Epoch: 22 [291/1000 9312/32000 (29%)] Loss: 0.60627 (QuantReg: 12.62193) QuantErr: 12.62193 batch_time=1.45559 
Train Epoch: 22 [296/1000 9472/32000 (30%)] Loss: 0.40918 (QuantReg: 12.53418) QuantErr: 12.53418 batch_time=0.45246 
Train Epoch: 22 [301/1000 9632/32000 (30%)] Loss: 0.37291 (QuantReg: 12.62510) QuantErr: 12.62510 batch_time=0.36250 
Train Epoch: 22 [306/1000 9792/32000 (31%)] Loss: 0.37072 (QuantReg: 12.47273) QuantErr: 12.47273 batch_time=0.45380 
Train Epoch: 22 [311/1000 9952/32000 (31%)] Loss: 0.41390 (QuantReg: 12.88500) QuantErr: 12.88500 batch_time=0.38194 
Train Epoch: 22 [316/1000 10112/32000 (32%)] Loss: 0.37367 (QuantReg: 11.66343) QuantErr: 11.66343 batch_time=0.38242 
Train Epoch: 22 [321/1000 10272/32000 (32%)] Loss: 0.41683 (QuantReg: 12.41974) QuantErr: 12.41974 batch_time=2.75737 
Train Epoch: 22 [326/1000 10432/32000 (33%)] Loss: 0.52975 (QuantReg: 12.68604) QuantErr: 12.68604 batch_time=0.66737 
Train Epoch: 22 [331/1000 10592/32000 (33%)] Loss: 0.26326 (QuantReg: 13.33336) QuantErr: 13.33336 batch_time=0.61931 
Train Epoch: 22 [336/1000 10752/32000 (34%)] Loss: 0.48834 (QuantReg: 12.50965) QuantErr: 12.50965 batch_time=0.35747 
Train Epoch: 22 [341/1000 10912/32000 (34%)] Loss: 0.36241 (QuantReg: 11.96818) QuantErr: 11.96818 batch_time=0.42974 
Train Epoch: 22 [346/1000 11072/32000 (35%)] Loss: 0.17654 (QuantReg: 12.64223) QuantErr: 12.64223 batch_time=0.34187 
Train Epoch: 22 [351/1000 11232/32000 (35%)] Loss: 0.55854 (QuantReg: 12.42083) QuantErr: 12.42083 batch_time=0.41030 
Train Epoch: 22 [356/1000 11392/32000 (36%)] Loss: 0.40552 (QuantReg: 12.02842) QuantErr: 12.02842 batch_time=1.06356 
Train Epoch: 22 [361/1000 11552/32000 (36%)] Loss: 0.32017 (QuantReg: 12.67096) QuantErr: 12.67096 batch_time=0.36194 
Train Epoch: 22 [366/1000 11712/32000 (37%)] Loss: 0.23741 (QuantReg: 12.35398) QuantErr: 12.35398 batch_time=0.34810 
Train Epoch: 22 [371/1000 11872/32000 (37%)] Loss: 0.36313 (QuantReg: 12.62763) QuantErr: 12.62763 batch_time=0.36950 
Train Epoch: 22 [376/1000 12032/32000 (38%)] Loss: 0.23241 (QuantReg: 12.52254) QuantErr: 12.52254 batch_time=0.63702 
Train Epoch: 22 [381/1000 12192/32000 (38%)] Loss: 0.72803 (QuantReg: 12.34521) QuantErr: 12.34521 batch_time=0.76781 
Train Epoch: 22 [386/1000 12352/32000 (39%)] Loss: 0.42860 (QuantReg: 13.09199) QuantErr: 13.09199 batch_time=0.42757 
Train Epoch: 22 [391/1000 12512/32000 (39%)] Loss: 0.36475 (QuantReg: 12.23343) QuantErr: 12.23343 batch_time=0.40147 
Train Epoch: 22 [396/1000 12672/32000 (40%)] Loss: 0.31134 (QuantReg: 12.71394) QuantErr: 12.71394 batch_time=0.35946 
Train Epoch: 22 [401/1000 12832/32000 (40%)] Loss: 0.47607 (QuantReg: 12.64820) QuantErr: 12.64820 batch_time=0.47802 
Train Epoch: 22 [406/1000 12992/32000 (41%)] Loss: 0.19392 (QuantReg: 13.16425) QuantErr: 13.16425 batch_time=0.37384 
Train Epoch: 22 [411/1000 13152/32000 (41%)] Loss: 0.41736 (QuantReg: 12.79511) QuantErr: 12.79511 batch_time=0.36672 
Train Epoch: 22 [416/1000 13312/32000 (42%)] Loss: 0.47630 (QuantReg: 12.76908) QuantErr: 12.76908 batch_time=0.47706 
Train Epoch: 22 [421/1000 13472/32000 (42%)] Loss: 0.32867 (QuantReg: 12.27702) QuantErr: 12.27702 batch_time=0.65658 
Train Epoch: 22 [426/1000 13632/32000 (43%)] Loss: 0.23410 (QuantReg: 12.18100) QuantErr: 12.18100 batch_time=0.43401 
Train Epoch: 22 [431/1000 13792/32000 (43%)] Loss: 0.29527 (QuantReg: 12.70860) QuantErr: 12.70860 batch_time=0.33924 
Train Epoch: 22 [436/1000 13952/32000 (44%)] Loss: 0.29219 (QuantReg: 12.23168) QuantErr: 12.23168 batch_time=0.34880 
Train Epoch: 22 [441/1000 14112/32000 (44%)] Loss: 0.59184 (QuantReg: 12.41072) QuantErr: 12.41072 batch_time=0.43716 
Train Epoch: 22 [446/1000 14272/32000 (45%)] Loss: 0.50087 (QuantReg: 12.72153) QuantErr: 12.72153 batch_time=0.39635 
Train Epoch: 22 [451/1000 14432/32000 (45%)] Loss: 0.64774 (QuantReg: 12.46128) QuantErr: 12.46128 batch_time=0.34469 
Train Epoch: 22 [456/1000 14592/32000 (46%)] Loss: 0.43794 (QuantReg: 13.07892) QuantErr: 13.07892 batch_time=0.38283 
Train Epoch: 22 [461/1000 14752/32000 (46%)] Loss: 0.18635 (QuantReg: 12.17245) QuantErr: 12.17245 batch_time=0.44490 
Train Epoch: 22 [466/1000 14912/32000 (47%)] Loss: 0.71436 (QuantReg: 12.34271) QuantErr: 12.34271 batch_time=0.43978 
Train Epoch: 22 [471/1000 15072/32000 (47%)] Loss: 0.46390 (QuantReg: 12.25904) QuantErr: 12.25904 batch_time=0.76784 
Train Epoch: 22 [476/1000 15232/32000 (48%)] Loss: 0.20910 (QuantReg: 12.05914) QuantErr: 12.05914 batch_time=0.45297 
Train Epoch: 22 [481/1000 15392/32000 (48%)] Loss: 0.30051 (QuantReg: 12.96816) QuantErr: 12.96816 batch_time=0.50522 
Train Epoch: 22 [486/1000 15552/32000 (49%)] Loss: 0.18884 (QuantReg: 12.99866) QuantErr: 12.99866 batch_time=0.38351 
Train Epoch: 22 [491/1000 15712/32000 (49%)] Loss: 0.22492 (QuantReg: 12.74273) QuantErr: 12.74273 batch_time=0.36544 
Train Epoch: 22 [496/1000 15872/32000 (50%)] Loss: 0.50683 (QuantReg: 12.08345) QuantErr: 12.08345 batch_time=0.46431 
Train Epoch: 22 [501/1000 16032/32000 (50%)] Loss: 0.59146 (QuantReg: 11.79725) QuantErr: 11.79725 batch_time=0.40027 
Train Epoch: 22 [506/1000 16192/32000 (51%)] Loss: 0.33635 (QuantReg: 12.55158) QuantErr: 12.55158 batch_time=0.50575 
Train Epoch: 22 [511/1000 16352/32000 (51%)] Loss: 0.48290 (QuantReg: 12.91654) QuantErr: 12.91654 batch_time=0.35082 
Train Epoch: 22 [516/1000 16512/32000 (52%)] Loss: 0.66214 (QuantReg: 13.17908) QuantErr: 13.17908 batch_time=0.34903 
Train Epoch: 22 [521/1000 16672/32000 (52%)] Loss: 0.29938 (QuantReg: 12.93292) QuantErr: 12.93292 batch_time=0.46383 
Train Epoch: 22 [526/1000 16832/32000 (53%)] Loss: 0.20294 (QuantReg: 12.92425) QuantErr: 12.92425 batch_time=0.44674 
Train Epoch: 22 [531/1000 16992/32000 (53%)] Loss: 0.36430 (QuantReg: 11.77003) QuantErr: 11.77003 batch_time=0.46292 
Train Epoch: 22 [536/1000 17152/32000 (54%)] Loss: 0.50658 (QuantReg: 11.78491) QuantErr: 11.78491 batch_time=0.45526 
Train Epoch: 22 [541/1000 17312/32000 (54%)] Loss: 0.11167 (QuantReg: 13.29206) QuantErr: 13.29206 batch_time=0.53104 
Train Epoch: 22 [546/1000 17472/32000 (55%)] Loss: 0.17582 (QuantReg: 13.26917) QuantErr: 13.26917 batch_time=0.39557 
Train Epoch: 22 [551/1000 17632/32000 (55%)] Loss: 0.44985 (QuantReg: 13.45236) QuantErr: 13.45236 batch_time=0.37746 
Train Epoch: 22 [556/1000 17792/32000 (56%)] Loss: 0.34147 (QuantReg: 12.82394) QuantErr: 12.82394 batch_time=0.73168 
Train Epoch: 22 [561/1000 17952/32000 (56%)] Loss: 0.29036 (QuantReg: 12.88017) QuantErr: 12.88017 batch_time=0.40573 
Train Epoch: 22 [566/1000 18112/32000 (57%)] Loss: 0.32902 (QuantReg: 13.38921) QuantErr: 13.38921 batch_time=0.76830 
Train Epoch: 22 [571/1000 18272/32000 (57%)] Loss: 0.40982 (QuantReg: 13.54258) QuantErr: 13.54258 batch_time=0.42926 
Train Epoch: 22 [576/1000 18432/32000 (58%)] Loss: 0.30363 (QuantReg: 12.23318) QuantErr: 12.23318 batch_time=0.43469 
Train Epoch: 22 [581/1000 18592/32000 (58%)] Loss: 0.59219 (QuantReg: 12.64190) QuantErr: 12.64190 batch_time=0.42406 
Train Epoch: 22 [586/1000 18752/32000 (59%)] Loss: 0.46472 (QuantReg: 13.04976) QuantErr: 13.04976 batch_time=0.41327 
Train Epoch: 22 [591/1000 18912/32000 (59%)] Loss: 0.66220 (QuantReg: 12.78745) QuantErr: 12.78745 batch_time=0.36045 
Train Epoch: 22 [596/1000 19072/32000 (60%)] Loss: 0.60214 (QuantReg: 12.81689) QuantErr: 12.81689 batch_time=0.40462 
Train Epoch: 22 [601/1000 19232/32000 (60%)] Loss: 0.44504 (QuantReg: 13.03294) QuantErr: 13.03294 batch_time=0.39034 
Train Epoch: 22 [606/1000 19392/32000 (61%)] Loss: 0.54726 (QuantReg: 11.79341) QuantErr: 11.79341 batch_time=0.42313 
Train Epoch: 22 [611/1000 19552/32000 (61%)] Loss: 0.50445 (QuantReg: 12.58834) QuantErr: 12.58834 batch_time=1.30066 
Train Epoch: 22 [616/1000 19712/32000 (62%)] Loss: 0.58274 (QuantReg: 12.21345) QuantErr: 12.21345 batch_time=0.37903 
Train Epoch: 22 [621/1000 19872/32000 (62%)] Loss: 0.56975 (QuantReg: 12.19521) QuantErr: 12.19521 batch_time=0.48069 
Train Epoch: 22 [626/1000 20032/32000 (63%)] Loss: 0.50858 (QuantReg: 12.61873) QuantErr: 12.61873 batch_time=0.54095 
Train Epoch: 22 [631/1000 20192/32000 (63%)] Loss: 0.27378 (QuantReg: 12.93835) QuantErr: 12.93835 batch_time=0.39934 
Train Epoch: 22 [636/1000 20352/32000 (64%)] Loss: 0.68192 (QuantReg: 12.23121) QuantErr: 12.23121 batch_time=0.35563 
Train Epoch: 22 [641/1000 20512/32000 (64%)] Loss: 0.20478 (QuantReg: 12.16438) QuantErr: 12.16438 batch_time=0.82834 
Train Epoch: 22 [646/1000 20672/32000 (65%)] Loss: 0.49195 (QuantReg: 12.52105) QuantErr: 12.52105 batch_time=0.35714 
Train Epoch: 22 [651/1000 20832/32000 (65%)] Loss: 0.37613 (QuantReg: 12.96033) QuantErr: 12.96033 batch_time=0.51604 
Train Epoch: 22 [656/1000 20992/32000 (66%)] Loss: 0.47226 (QuantReg: 13.37845) QuantErr: 13.37845 batch_time=0.33995 
Train Epoch: 22 [661/1000 21152/32000 (66%)] Loss: 0.73944 (QuantReg: 12.70721) QuantErr: 12.70721 batch_time=0.74992 
Train Epoch: 22 [666/1000 21312/32000 (67%)] Loss: 0.55251 (QuantReg: 13.35071) QuantErr: 13.35071 batch_time=0.37549 
Train Epoch: 22 [671/1000 21472/32000 (67%)] Loss: 0.56538 (QuantReg: 13.24724) QuantErr: 13.24724 batch_time=0.34830 
Train Epoch: 22 [676/1000 21632/32000 (68%)] Loss: 0.33662 (QuantReg: 12.92487) QuantErr: 12.92487 batch_time=0.78040 
Train Epoch: 22 [681/1000 21792/32000 (68%)] Loss: 0.52552 (QuantReg: 11.69084) QuantErr: 11.69084 batch_time=0.44554 
Train Epoch: 22 [686/1000 21952/32000 (69%)] Loss: 0.66132 (QuantReg: 12.33691) QuantErr: 12.33691 batch_time=0.42188 
Train Epoch: 22 [691/1000 22112/32000 (69%)] Loss: 0.41939 (QuantReg: 12.84203) QuantErr: 12.84203 batch_time=0.42082 
Train Epoch: 22 [696/1000 22272/32000 (70%)] Loss: 0.53148 (QuantReg: 12.51153) QuantErr: 12.51153 batch_time=0.57004 
Train Epoch: 22 [701/1000 22432/32000 (70%)] Loss: 0.74307 (QuantReg: 11.86993) QuantErr: 11.86993 batch_time=0.94115 
Train Epoch: 22 [706/1000 22592/32000 (71%)] Loss: 0.45446 (QuantReg: 13.19240) QuantErr: 13.19240 batch_time=0.47947 
Train Epoch: 22 [711/1000 22752/32000 (71%)] Loss: 0.87696 (QuantReg: 12.54460) QuantErr: 12.54460 batch_time=0.41199 
Train Epoch: 22 [716/1000 22912/32000 (72%)] Loss: 0.24562 (QuantReg: 12.10757) QuantErr: 12.10757 batch_time=0.40061 
Train Epoch: 22 [721/1000 23072/32000 (72%)] Loss: 0.30445 (QuantReg: 12.43270) QuantErr: 12.43270 batch_time=0.37002 
Train Epoch: 22 [726/1000 23232/32000 (73%)] Loss: 0.34432 (QuantReg: 12.65909) QuantErr: 12.65909 batch_time=0.37251 
Train Epoch: 22 [731/1000 23392/32000 (73%)] Loss: 0.40594 (QuantReg: 12.34609) QuantErr: 12.34609 batch_time=0.42861 
Train Epoch: 22 [736/1000 23552/32000 (74%)] Loss: 0.46960 (QuantReg: 12.02876) QuantErr: 12.02876 batch_time=0.40531 
Train Epoch: 22 [741/1000 23712/32000 (74%)] Loss: 0.47951 (QuantReg: 13.11214) QuantErr: 13.11214 batch_time=0.38957 
Train Epoch: 22 [746/1000 23872/32000 (75%)] Loss: 0.37291 (QuantReg: 13.47966) QuantErr: 13.47966 batch_time=0.36537 
Train Epoch: 22 [751/1000 24032/32000 (75%)] Loss: 0.28907 (QuantReg: 11.98685) QuantErr: 11.98685 batch_time=0.34757 
Train Epoch: 22 [756/1000 24192/32000 (76%)] Loss: 0.48679 (QuantReg: 12.42936) QuantErr: 12.42936 batch_time=0.73845 
Train Epoch: 22 [761/1000 24352/32000 (76%)] Loss: 0.33848 (QuantReg: 11.91601) QuantErr: 11.91601 batch_time=0.34938 
Train Epoch: 22 [766/1000 24512/32000 (77%)] Loss: 0.56441 (QuantReg: 12.78186) QuantErr: 12.78186 batch_time=0.62348 
Train Epoch: 22 [771/1000 24672/32000 (77%)] Loss: 0.77716 (QuantReg: 12.55104) QuantErr: 12.55104 batch_time=0.38447 
Train Epoch: 22 [776/1000 24832/32000 (78%)] Loss: 0.54250 (QuantReg: 12.27434) QuantErr: 12.27434 batch_time=0.35749 
Train Epoch: 22 [781/1000 24992/32000 (78%)] Loss: 0.72617 (QuantReg: 12.14168) QuantErr: 12.14168 batch_time=0.41169 
Train Epoch: 22 [786/1000 25152/32000 (79%)] Loss: 0.49822 (QuantReg: 12.66313) QuantErr: 12.66313 batch_time=0.37818 
Train Epoch: 22 [791/1000 25312/32000 (79%)] Loss: 0.37142 (QuantReg: 12.58438) QuantErr: 12.58438 batch_time=0.41910 
Train Epoch: 22 [796/1000 25472/32000 (80%)] Loss: 0.30772 (QuantReg: 12.27192) QuantErr: 12.27192 batch_time=0.51455 
Train Epoch: 22 [801/1000 25632/32000 (80%)] Loss: 0.45778 (QuantReg: 12.91113) QuantErr: 12.91113 batch_time=0.34784 
Train Epoch: 22 [806/1000 25792/32000 (81%)] Loss: 0.47000 (QuantReg: 12.79271) QuantErr: 12.79271 batch_time=0.55725 
Train Epoch: 22 [811/1000 25952/32000 (81%)] Loss: 0.68483 (QuantReg: 12.76096) QuantErr: 12.76096 batch_time=0.35233 
Train Epoch: 22 [816/1000 26112/32000 (82%)] Loss: 0.44146 (QuantReg: 13.01777) QuantErr: 13.01777 batch_time=0.52933 
Train Epoch: 22 [821/1000 26272/32000 (82%)] Loss: 0.49400 (QuantReg: 12.80780) QuantErr: 12.80780 batch_time=0.40915 
Train Epoch: 22 [826/1000 26432/32000 (83%)] Loss: 0.52000 (QuantReg: 13.18321) QuantErr: 13.18321 batch_time=0.45591 
Train Epoch: 22 [831/1000 26592/32000 (83%)] Loss: 0.20354 (QuantReg: 13.07677) QuantErr: 13.07677 batch_time=0.37205 
Train Epoch: 22 [836/1000 26752/32000 (84%)] Loss: 0.85307 (QuantReg: 12.93151) QuantErr: 12.93151 batch_time=0.36226 
Train Epoch: 22 [841/1000 26912/32000 (84%)] Loss: 0.50695 (QuantReg: 12.85773) QuantErr: 12.85773 batch_time=0.65451 
Train Epoch: 22 [846/1000 27072/32000 (85%)] Loss: 0.56592 (QuantReg: 12.18203) QuantErr: 12.18203 batch_time=0.36068 
Train Epoch: 22 [851/1000 27232/32000 (85%)] Loss: 0.46965 (QuantReg: 12.95281) QuantErr: 12.95281 batch_time=0.45220 
Train Epoch: 22 [856/1000 27392/32000 (86%)] Loss: 0.27086 (QuantReg: 12.80814) QuantErr: 12.80814 batch_time=0.41496 
Train Epoch: 22 [861/1000 27552/32000 (86%)] Loss: 0.52259 (QuantReg: 12.91815) QuantErr: 12.91815 batch_time=0.48083 
Train Epoch: 22 [866/1000 27712/32000 (87%)] Loss: 0.67252 (QuantReg: 12.84775) QuantErr: 12.84775 batch_time=0.86078 
Train Epoch: 22 [871/1000 27872/32000 (87%)] Loss: 0.28022 (QuantReg: 13.43677) QuantErr: 13.43677 batch_time=0.39648 
Train Epoch: 22 [876/1000 28032/32000 (88%)] Loss: 0.24930 (QuantReg: 12.71840) QuantErr: 12.71840 batch_time=0.55801 
Train Epoch: 22 [881/1000 28192/32000 (88%)] Loss: 0.32992 (QuantReg: 13.13505) QuantErr: 13.13505 batch_time=0.43443 
Train Epoch: 22 [886/1000 28352/32000 (89%)] Loss: 0.43014 (QuantReg: 12.61454) QuantErr: 12.61454 batch_time=1.05231 
Train Epoch: 22 [891/1000 28512/32000 (89%)] Loss: 0.54258 (QuantReg: 12.67836) QuantErr: 12.67836 batch_time=0.35257 
Train Epoch: 22 [896/1000 28672/32000 (90%)] Loss: 0.53613 (QuantReg: 12.99033) QuantErr: 12.99033 batch_time=0.51131 
Train Epoch: 22 [901/1000 28832/32000 (90%)] Loss: 0.29547 (QuantReg: 12.32384) QuantErr: 12.32384 batch_time=0.37315 
Train Epoch: 22 [906/1000 28992/32000 (91%)] Loss: 0.36936 (QuantReg: 12.49349) QuantErr: 12.49349 batch_time=0.38986 
Train Epoch: 22 [911/1000 29152/32000 (91%)] Loss: 0.30123 (QuantReg: 12.06116) QuantErr: 12.06116 batch_time=0.46854 
Train Epoch: 22 [916/1000 29312/32000 (92%)] Loss: 0.34558 (QuantReg: 13.06006) QuantErr: 13.06006 batch_time=0.35849 
Train Epoch: 22 [921/1000 29472/32000 (92%)] Loss: 0.40920 (QuantReg: 13.27882) QuantErr: 13.27882 batch_time=0.41161 
Train Epoch: 22 [926/1000 29632/32000 (93%)] Loss: 0.96370 (QuantReg: 12.69548) QuantErr: 12.69548 batch_time=0.37546 
Train Epoch: 22 [931/1000 29792/32000 (93%)] Loss: 0.35512 (QuantReg: 13.25002) QuantErr: 13.25002 batch_time=0.37951 
Train Epoch: 22 [936/1000 29952/32000 (94%)] Loss: 0.41648 (QuantReg: 12.38251) QuantErr: 12.38251 batch_time=0.40613 
Train Epoch: 22 [941/1000 30112/32000 (94%)] Loss: 0.30127 (QuantReg: 13.33905) QuantErr: 13.33905 batch_time=0.44849 
Train Epoch: 22 [946/1000 30272/32000 (95%)] Loss: 0.43005 (QuantReg: 12.51102) QuantErr: 12.51102 batch_time=0.84776 
Train Epoch: 22 [951/1000 30432/32000 (95%)] Loss: 0.76172 (QuantReg: 11.45852) QuantErr: 11.45852 batch_time=0.35997 
Train Epoch: 22 [956/1000 30592/32000 (96%)] Loss: 0.30646 (QuantReg: 12.60397) QuantErr: 12.60397 batch_time=0.42446 
Train Epoch: 22 [961/1000 30752/32000 (96%)] Loss: 0.41148 (QuantReg: 12.62342) QuantErr: 12.62342 batch_time=0.56356 
Train Epoch: 22 [966/1000 30912/32000 (97%)] Loss: 0.45836 (QuantReg: 13.06865) QuantErr: 13.06865 batch_time=0.40223 
Train Epoch: 22 [971/1000 31072/32000 (97%)] Loss: 0.42173 (QuantReg: 12.33197) QuantErr: 12.33197 batch_time=0.41983 
Train Epoch: 22 [976/1000 31232/32000 (98%)] Loss: 0.70153 (QuantReg: 12.65715) QuantErr: 12.65715 batch_time=0.38375 
Train Epoch: 22 [981/1000 31392/32000 (98%)] Loss: 0.40337 (QuantReg: 12.04748) QuantErr: 12.04748 batch_time=0.44949 
Train Epoch: 22 [986/1000 31552/32000 (99%)] Loss: 0.11272 (QuantReg: 13.14991) QuantErr: 13.14991 batch_time=0.43643 
Train Epoch: 22 [991/1000 31712/32000 (99%)] Loss: 0.62144 (QuantReg: 12.84012) QuantErr: 12.84012 batch_time=0.35529 
Train Epoch: 22 [996/1000 31872/32000 (100%)] Loss: 0.74082 (QuantReg: 12.88477) QuantErr: 12.88477 batch_time=0.94306 
Train Epoch: 22 codebook_update_time=1.86286
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch22.pth ...
Done in 4.835s
removing stale ckpt [epoch 21] [took 0.03s]
 epoch          : 22
 loss           : 0.4472585091665387
 quant_reg      : 12.6512495470047
 quant_err      : 12.6512495470047
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 22000
 MSRVTT_miech_test/t2v_metrics/R1: 18.9
 MSRVTT_miech_test/t2v_metrics/R5: 47.8
 MSRVTT_miech_test/t2v_metrics/R10: 62.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.835
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.302462421241955
 MSRVTT_miech_test/v2t_metrics/R1: 18.4
 MSRVTT_miech_test/v2t_metrics/R5: 48.8
 MSRVTT_miech_test/v2t_metrics/R10: 63.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.054
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.44859299630267
 mnt_best       : 38.45489562444897
 not_improved_count: 2
Train Epoch: 23 [1/1000 32/32000 (0%)] Loss: 0.66748 (QuantReg: 12.23771) QuantErr: 12.23771 batch_time=27.97866 
Train Epoch: 23 [6/1000 192/32000 (1%)] Loss: 0.56115 (QuantReg: 12.33548) QuantErr: 12.33548 batch_time=0.41907 
Train Epoch: 23 [11/1000 352/32000 (1%)] Loss: 0.36367 (QuantReg: 12.49951) QuantErr: 12.49951 batch_time=0.42895 
Train Epoch: 23 [16/1000 512/32000 (2%)] Loss: 0.63690 (QuantReg: 11.93352) QuantErr: 11.93352 batch_time=1.03585 
Train Epoch: 23 [21/1000 672/32000 (2%)] Loss: 0.21268 (QuantReg: 11.83544) QuantErr: 11.83544 batch_time=0.44752 
Train Epoch: 23 [26/1000 832/32000 (3%)] Loss: 0.44003 (QuantReg: 12.55570) QuantErr: 12.55570 batch_time=0.35211 
Train Epoch: 23 [31/1000 992/32000 (3%)] Loss: 0.64078 (QuantReg: 11.81215) QuantErr: 11.81215 batch_time=0.35798 
Train Epoch: 23 [36/1000 1152/32000 (4%)] Loss: 0.43238 (QuantReg: 12.66151) QuantErr: 12.66151 batch_time=0.52928 
Train Epoch: 23 [41/1000 1312/32000 (4%)] Loss: 0.12257 (QuantReg: 12.65929) QuantErr: 12.65929 batch_time=0.38246 
Train Epoch: 23 [46/1000 1472/32000 (5%)] Loss: 0.65470 (QuantReg: 12.42889) QuantErr: 12.42889 batch_time=0.45176 
Train Epoch: 23 [51/1000 1632/32000 (5%)] Loss: 0.31901 (QuantReg: 12.95477) QuantErr: 12.95477 batch_time=0.42151 
Train Epoch: 23 [56/1000 1792/32000 (6%)] Loss: 0.28531 (QuantReg: 11.20890) QuantErr: 11.20890 batch_time=0.36951 
Train Epoch: 23 [61/1000 1952/32000 (6%)] Loss: 0.29465 (QuantReg: 11.67791) QuantErr: 11.67791 batch_time=2.35336 
Train Epoch: 23 [66/1000 2112/32000 (7%)] Loss: 0.29833 (QuantReg: 13.19847) QuantErr: 13.19847 batch_time=0.42844 
Train Epoch: 23 [71/1000 2272/32000 (7%)] Loss: 0.16727 (QuantReg: 12.58716) QuantErr: 12.58716 batch_time=0.41582 
Train Epoch: 23 [76/1000 2432/32000 (8%)] Loss: 0.12405 (QuantReg: 13.08269) QuantErr: 13.08269 batch_time=0.46134 
Train Epoch: 23 [81/1000 2592/32000 (8%)] Loss: 0.47286 (QuantReg: 12.11174) QuantErr: 12.11174 batch_time=0.46065 
Train Epoch: 23 [86/1000 2752/32000 (9%)] Loss: 0.28941 (QuantReg: 12.23525) QuantErr: 12.23525 batch_time=0.41317 
Train Epoch: 23 [91/1000 2912/32000 (9%)] Loss: 0.58872 (QuantReg: 12.96387) QuantErr: 12.96387 batch_time=0.34226 
Train Epoch: 23 [96/1000 3072/32000 (10%)] Loss: 0.62405 (QuantReg: 12.51701) QuantErr: 12.51701 batch_time=0.47099 
Train Epoch: 23 [101/1000 3232/32000 (10%)] Loss: 0.52967 (QuantReg: 12.47669) QuantErr: 12.47669 batch_time=0.35062 
Train Epoch: 23 [106/1000 3392/32000 (11%)] Loss: 0.60604 (QuantReg: 12.51160) QuantErr: 12.51160 batch_time=0.38150 
Train Epoch: 23 [111/1000 3552/32000 (11%)] Loss: 0.33057 (QuantReg: 12.60361) QuantErr: 12.60361 batch_time=0.38142 
Train Epoch: 23 [116/1000 3712/32000 (12%)] Loss: 0.87840 (QuantReg: 11.73192) QuantErr: 11.73192 batch_time=0.34983 
Train Epoch: 23 [121/1000 3872/32000 (12%)] Loss: 0.48428 (QuantReg: 12.01878) QuantErr: 12.01878 batch_time=0.36389 
Train Epoch: 23 [126/1000 4032/32000 (13%)] Loss: 0.52705 (QuantReg: 12.31691) QuantErr: 12.31691 batch_time=0.34733 
Train Epoch: 23 [131/1000 4192/32000 (13%)] Loss: 0.27501 (QuantReg: 13.08528) QuantErr: 13.08528 batch_time=0.55180 
Train Epoch: 23 [136/1000 4352/32000 (14%)] Loss: 0.16709 (QuantReg: 12.79800) QuantErr: 12.79800 batch_time=0.41726 
Train Epoch: 23 [141/1000 4512/32000 (14%)] Loss: 0.48247 (QuantReg: 12.50679) QuantErr: 12.50679 batch_time=0.41179 
Train Epoch: 23 [146/1000 4672/32000 (15%)] Loss: 0.63257 (QuantReg: 12.64939) QuantErr: 12.64939 batch_time=0.34539 
Train Epoch: 23 [151/1000 4832/32000 (15%)] Loss: 0.70146 (QuantReg: 13.55553) QuantErr: 13.55553 batch_time=0.48964 
Train Epoch: 23 [156/1000 4992/32000 (16%)] Loss: 0.59795 (QuantReg: 12.81489) QuantErr: 12.81489 batch_time=0.36620 
Train Epoch: 23 [161/1000 5152/32000 (16%)] Loss: 0.51455 (QuantReg: 12.85760) QuantErr: 12.85760 batch_time=0.43843 
Train Epoch: 23 [166/1000 5312/32000 (17%)] Loss: 0.37436 (QuantReg: 11.44551) QuantErr: 11.44551 batch_time=0.39860 
Train Epoch: 23 [171/1000 5472/32000 (17%)] Loss: 0.44972 (QuantReg: 12.94058) QuantErr: 12.94058 batch_time=0.48263 
Train Epoch: 23 [176/1000 5632/32000 (18%)] Loss: 0.33858 (QuantReg: 11.68876) QuantErr: 11.68876 batch_time=0.43305 
Train Epoch: 23 [181/1000 5792/32000 (18%)] Loss: 0.31388 (QuantReg: 12.33347) QuantErr: 12.33347 batch_time=0.35032 
Train Epoch: 23 [186/1000 5952/32000 (19%)] Loss: 0.77698 (QuantReg: 12.83012) QuantErr: 12.83012 batch_time=0.60647 
Train Epoch: 23 [191/1000 6112/32000 (19%)] Loss: 0.61350 (QuantReg: 12.84635) QuantErr: 12.84635 batch_time=0.35514 
Train Epoch: 23 [196/1000 6272/32000 (20%)] Loss: 0.44465 (QuantReg: 12.82812) QuantErr: 12.82812 batch_time=0.41760 
Train Epoch: 23 [201/1000 6432/32000 (20%)] Loss: 0.24004 (QuantReg: 12.75232) QuantErr: 12.75232 batch_time=0.36535 
Train Epoch: 23 [206/1000 6592/32000 (21%)] Loss: 0.35493 (QuantReg: 12.86218) QuantErr: 12.86218 batch_time=0.34991 
Train Epoch: 23 [211/1000 6752/32000 (21%)] Loss: 0.67887 (QuantReg: 12.70398) QuantErr: 12.70398 batch_time=0.40232 
Train Epoch: 23 [216/1000 6912/32000 (22%)] Loss: 0.38968 (QuantReg: 13.20074) QuantErr: 13.20074 batch_time=0.45007 
Train Epoch: 23 [221/1000 7072/32000 (22%)] Loss: 0.25523 (QuantReg: 12.67910) QuantErr: 12.67910 batch_time=0.38583 
Train Epoch: 23 [226/1000 7232/32000 (23%)] Loss: 0.17465 (QuantReg: 12.77130) QuantErr: 12.77130 batch_time=0.64226 
Train Epoch: 23 [231/1000 7392/32000 (23%)] Loss: 0.36930 (QuantReg: 11.88742) QuantErr: 11.88742 batch_time=0.48180 
Train Epoch: 23 [236/1000 7552/32000 (24%)] Loss: 0.34392 (QuantReg: 12.48769) QuantErr: 12.48769 batch_time=0.48244 
Train Epoch: 23 [241/1000 7712/32000 (24%)] Loss: 0.41430 (QuantReg: 12.43628) QuantErr: 12.43628 batch_time=0.44992 
Train Epoch: 23 [246/1000 7872/32000 (25%)] Loss: 0.56520 (QuantReg: 13.14131) QuantErr: 13.14131 batch_time=0.36368 
Train Epoch: 23 [251/1000 8032/32000 (25%)] Loss: 0.13209 (QuantReg: 12.73510) QuantErr: 12.73510 batch_time=0.40825 
Train Epoch: 23 [256/1000 8192/32000 (26%)] Loss: 0.68215 (QuantReg: 12.59405) QuantErr: 12.59405 batch_time=0.37338 
Train Epoch: 23 [261/1000 8352/32000 (26%)] Loss: 0.39175 (QuantReg: 12.69953) QuantErr: 12.69953 batch_time=0.37485 
Train Epoch: 23 [266/1000 8512/32000 (27%)] Loss: 0.33001 (QuantReg: 12.97648) QuantErr: 12.97648 batch_time=0.66386 
Train Epoch: 23 [271/1000 8672/32000 (27%)] Loss: 0.22992 (QuantReg: 12.79111) QuantErr: 12.79111 batch_time=0.46354 
Train Epoch: 23 [276/1000 8832/32000 (28%)] Loss: 0.88509 (QuantReg: 12.71642) QuantErr: 12.71642 batch_time=0.34635 
Train Epoch: 23 [281/1000 8992/32000 (28%)] Loss: 0.51053 (QuantReg: 12.54100) QuantErr: 12.54100 batch_time=0.35569 
Train Epoch: 23 [286/1000 9152/32000 (29%)] Loss: 0.37441 (QuantReg: 12.47664) QuantErr: 12.47664 batch_time=0.37547 
Train Epoch: 23 [291/1000 9312/32000 (29%)] Loss: 0.15673 (QuantReg: 13.05556) QuantErr: 13.05556 batch_time=0.38885 
Train Epoch: 23 [296/1000 9472/32000 (30%)] Loss: 0.69889 (QuantReg: 12.42915) QuantErr: 12.42915 batch_time=0.41605 
Train Epoch: 23 [301/1000 9632/32000 (30%)] Loss: 0.39894 (QuantReg: 12.97238) QuantErr: 12.97238 batch_time=0.45140 
Train Epoch: 23 [306/1000 9792/32000 (31%)] Loss: 0.79788 (QuantReg: 13.00853) QuantErr: 13.00853 batch_time=0.39115 
Train Epoch: 23 [311/1000 9952/32000 (31%)] Loss: 0.67971 (QuantReg: 12.03678) QuantErr: 12.03678 batch_time=0.55343 
Train Epoch: 23 [316/1000 10112/32000 (32%)] Loss: 0.52351 (QuantReg: 12.51305) QuantErr: 12.51305 batch_time=0.44607 
Train Epoch: 23 [321/1000 10272/32000 (32%)] Loss: 0.29091 (QuantReg: 12.90929) QuantErr: 12.90929 batch_time=0.37638 
Train Epoch: 23 [326/1000 10432/32000 (33%)] Loss: 0.47663 (QuantReg: 12.74717) QuantErr: 12.74717 batch_time=0.54980 
Train Epoch: 23 [331/1000 10592/32000 (33%)] Loss: 0.36707 (QuantReg: 13.08600) QuantErr: 13.08600 batch_time=0.37256 
Train Epoch: 23 [336/1000 10752/32000 (34%)] Loss: 0.46950 (QuantReg: 12.82176) QuantErr: 12.82176 batch_time=0.42829 
Train Epoch: 23 [341/1000 10912/32000 (34%)] Loss: 0.32436 (QuantReg: 12.21126) QuantErr: 12.21126 batch_time=0.46438 
Train Epoch: 23 [346/1000 11072/32000 (35%)] Loss: 0.49711 (QuantReg: 12.23854) QuantErr: 12.23854 batch_time=0.38935 
Train Epoch: 23 [351/1000 11232/32000 (35%)] Loss: 0.26548 (QuantReg: 12.02382) QuantErr: 12.02382 batch_time=0.44954 
Train Epoch: 23 [356/1000 11392/32000 (36%)] Loss: 0.99928 (QuantReg: 12.23032) QuantErr: 12.23032 batch_time=0.37304 
Train Epoch: 23 [361/1000 11552/32000 (36%)] Loss: 0.67847 (QuantReg: 11.84673) QuantErr: 11.84673 batch_time=0.69018 
Train Epoch: 23 [366/1000 11712/32000 (37%)] Loss: 0.29094 (QuantReg: 12.79634) QuantErr: 12.79634 batch_time=0.36403 
Train Epoch: 23 [371/1000 11872/32000 (37%)] Loss: 0.67343 (QuantReg: 12.75772) QuantErr: 12.75772 batch_time=0.40362 
Train Epoch: 23 [376/1000 12032/32000 (38%)] Loss: 0.35997 (QuantReg: 12.83928) QuantErr: 12.83928 batch_time=0.36690 
Train Epoch: 23 [381/1000 12192/32000 (38%)] Loss: 0.47342 (QuantReg: 13.03641) QuantErr: 13.03641 batch_time=0.96145 
Train Epoch: 23 [386/1000 12352/32000 (39%)] Loss: 0.92509 (QuantReg: 12.27899) QuantErr: 12.27899 batch_time=0.38660 
Train Epoch: 23 [391/1000 12512/32000 (39%)] Loss: 0.29135 (QuantReg: 13.23062) QuantErr: 13.23062 batch_time=0.41990 
Train Epoch: 23 [396/1000 12672/32000 (40%)] Loss: 0.36550 (QuantReg: 12.45768) QuantErr: 12.45768 batch_time=0.36975 
Train Epoch: 23 [401/1000 12832/32000 (40%)] Loss: 0.35339 (QuantReg: 12.43046) QuantErr: 12.43046 batch_time=0.34779 
Train Epoch: 23 [406/1000 12992/32000 (41%)] Loss: 0.64376 (QuantReg: 12.21993) QuantErr: 12.21993 batch_time=0.57109 
Train Epoch: 23 [411/1000 13152/32000 (41%)] Loss: 0.41346 (QuantReg: 13.27226) QuantErr: 13.27226 batch_time=0.56839 
Train Epoch: 23 [416/1000 13312/32000 (42%)] Loss: 0.48309 (QuantReg: 12.56773) QuantErr: 12.56773 batch_time=0.42966 
Train Epoch: 23 [421/1000 13472/32000 (42%)] Loss: 0.36556 (QuantReg: 12.31880) QuantErr: 12.31880 batch_time=2.00184 
Train Epoch: 23 [426/1000 13632/32000 (43%)] Loss: 0.28232 (QuantReg: 12.78140) QuantErr: 12.78140 batch_time=0.45459 
Train Epoch: 23 [431/1000 13792/32000 (43%)] Loss: 0.44909 (QuantReg: 12.51487) QuantErr: 12.51487 batch_time=0.38701 
Train Epoch: 23 [436/1000 13952/32000 (44%)] Loss: 0.61882 (QuantReg: 13.34527) QuantErr: 13.34527 batch_time=0.36391 
Train Epoch: 23 [441/1000 14112/32000 (44%)] Loss: 0.43036 (QuantReg: 12.95513) QuantErr: 12.95513 batch_time=0.41770 
Train Epoch: 23 [446/1000 14272/32000 (45%)] Loss: 0.37357 (QuantReg: 12.79785) QuantErr: 12.79785 batch_time=0.45161 
Train Epoch: 23 [451/1000 14432/32000 (45%)] Loss: 0.35932 (QuantReg: 12.72392) QuantErr: 12.72392 batch_time=0.35959 
Train Epoch: 23 [456/1000 14592/32000 (46%)] Loss: 0.49519 (QuantReg: 12.01233) QuantErr: 12.01233 batch_time=0.58387 
Train Epoch: 23 [461/1000 14752/32000 (46%)] Loss: 0.29802 (QuantReg: 12.44796) QuantErr: 12.44796 batch_time=0.33851 
Train Epoch: 23 [466/1000 14912/32000 (47%)] Loss: 0.28998 (QuantReg: 12.68141) QuantErr: 12.68141 batch_time=0.41218 
Train Epoch: 23 [471/1000 15072/32000 (47%)] Loss: 0.47812 (QuantReg: 12.67836) QuantErr: 12.67836 batch_time=0.33273 
Train Epoch: 23 [476/1000 15232/32000 (48%)] Loss: 0.22463 (QuantReg: 12.83570) QuantErr: 12.83570 batch_time=0.38714 
Train Epoch: 23 [481/1000 15392/32000 (48%)] Loss: 0.36053 (QuantReg: 12.83152) QuantErr: 12.83152 batch_time=0.34378 
Train Epoch: 23 [486/1000 15552/32000 (49%)] Loss: 0.46062 (QuantReg: 13.14499) QuantErr: 13.14499 batch_time=0.45405 
Train Epoch: 23 [491/1000 15712/32000 (49%)] Loss: 0.32188 (QuantReg: 12.69193) QuantErr: 12.69193 batch_time=0.55263 
Train Epoch: 23 [496/1000 15872/32000 (50%)] Loss: 0.67593 (QuantReg: 12.18499) QuantErr: 12.18499 batch_time=0.33257 
Train Epoch: 23 [501/1000 16032/32000 (50%)] Loss: 0.25915 (QuantReg: 12.36863) QuantErr: 12.36863 batch_time=0.82183 
Train Epoch: 23 [506/1000 16192/32000 (51%)] Loss: 0.45326 (QuantReg: 12.74103) QuantErr: 12.74103 batch_time=0.38198 
Train Epoch: 23 [511/1000 16352/32000 (51%)] Loss: 0.15703 (QuantReg: 12.88148) QuantErr: 12.88148 batch_time=0.69502 
Train Epoch: 23 [516/1000 16512/32000 (52%)] Loss: 0.38731 (QuantReg: 12.85750) QuantErr: 12.85750 batch_time=0.35892 
Train Epoch: 23 [521/1000 16672/32000 (52%)] Loss: 0.60074 (QuantReg: 12.57084) QuantErr: 12.57084 batch_time=0.34902 
Train Epoch: 23 [526/1000 16832/32000 (53%)] Loss: 0.39345 (QuantReg: 12.77577) QuantErr: 12.77577 batch_time=0.35033 
Train Epoch: 23 [531/1000 16992/32000 (53%)] Loss: 0.27946 (QuantReg: 12.75480) QuantErr: 12.75480 batch_time=0.81212 
Train Epoch: 23 [536/1000 17152/32000 (54%)] Loss: 0.53140 (QuantReg: 12.13440) QuantErr: 12.13440 batch_time=0.35376 
Train Epoch: 23 [541/1000 17312/32000 (54%)] Loss: 0.25346 (QuantReg: 13.10938) QuantErr: 13.10938 batch_time=0.75617 
Train Epoch: 23 [546/1000 17472/32000 (55%)] Loss: 0.98924 (QuantReg: 12.80047) QuantErr: 12.80047 batch_time=0.34958 
Train Epoch: 23 [551/1000 17632/32000 (55%)] Loss: 0.61307 (QuantReg: 12.35591) QuantErr: 12.35591 batch_time=0.37854 
Train Epoch: 23 [556/1000 17792/32000 (56%)] Loss: 0.59586 (QuantReg: 12.68622) QuantErr: 12.68622 batch_time=0.34611 
Train Epoch: 23 [561/1000 17952/32000 (56%)] Loss: 0.74456 (QuantReg: 13.00566) QuantErr: 13.00566 batch_time=0.34516 
Train Epoch: 23 [566/1000 18112/32000 (57%)] Loss: 0.34433 (QuantReg: 12.33626) QuantErr: 12.33626 batch_time=0.37015 
Train Epoch: 23 [571/1000 18272/32000 (57%)] Loss: 0.39085 (QuantReg: 12.79683) QuantErr: 12.79683 batch_time=0.40774 
Train Epoch: 23 [576/1000 18432/32000 (58%)] Loss: 0.21759 (QuantReg: 12.66465) QuantErr: 12.66465 batch_time=0.45980 
Train Epoch: 23 [581/1000 18592/32000 (58%)] Loss: 0.22996 (QuantReg: 12.87344) QuantErr: 12.87344 batch_time=0.38141 
Train Epoch: 23 [586/1000 18752/32000 (59%)] Loss: 0.77127 (QuantReg: 12.19189) QuantErr: 12.19189 batch_time=0.59791 
Train Epoch: 23 [591/1000 18912/32000 (59%)] Loss: 0.51293 (QuantReg: 13.08273) QuantErr: 13.08273 batch_time=0.33966 
Train Epoch: 23 [596/1000 19072/32000 (60%)] Loss: 0.38007 (QuantReg: 13.08875) QuantErr: 13.08875 batch_time=0.80523 
Train Epoch: 23 [601/1000 19232/32000 (60%)] Loss: 0.33709 (QuantReg: 12.65792) QuantErr: 12.65792 batch_time=0.49856 
Train Epoch: 23 [606/1000 19392/32000 (61%)] Loss: 0.17161 (QuantReg: 12.10563) QuantErr: 12.10563 batch_time=0.44995 
Train Epoch: 23 [611/1000 19552/32000 (61%)] Loss: 0.31244 (QuantReg: 13.08045) QuantErr: 13.08045 batch_time=0.35769 
Train Epoch: 23 [616/1000 19712/32000 (62%)] Loss: 0.82737 (QuantReg: 12.47027) QuantErr: 12.47027 batch_time=0.36190 
Train Epoch: 23 [621/1000 19872/32000 (62%)] Loss: 0.26598 (QuantReg: 13.11029) QuantErr: 13.11029 batch_time=0.37032 
Train Epoch: 23 [626/1000 20032/32000 (63%)] Loss: 0.48470 (QuantReg: 12.95282) QuantErr: 12.95282 batch_time=0.40128 
Train Epoch: 23 [631/1000 20192/32000 (63%)] Loss: 0.39664 (QuantReg: 12.63468) QuantErr: 12.63468 batch_time=0.44100 
Train Epoch: 23 [636/1000 20352/32000 (64%)] Loss: 0.62459 (QuantReg: 12.59541) QuantErr: 12.59541 batch_time=0.34883 
Train Epoch: 23 [641/1000 20512/32000 (64%)] Loss: 0.45298 (QuantReg: 12.58811) QuantErr: 12.58811 batch_time=0.57984 
Train Epoch: 23 [646/1000 20672/32000 (65%)] Loss: 0.74727 (QuantReg: 12.08065) QuantErr: 12.08065 batch_time=0.90198 
Train Epoch: 23 [651/1000 20832/32000 (65%)] Loss: 0.87630 (QuantReg: 11.81293) QuantErr: 11.81293 batch_time=0.34876 
Train Epoch: 23 [656/1000 20992/32000 (66%)] Loss: 0.32016 (QuantReg: 12.80201) QuantErr: 12.80201 batch_time=0.48440 
Train Epoch: 23 [661/1000 21152/32000 (66%)] Loss: 0.10733 (QuantReg: 12.91777) QuantErr: 12.91777 batch_time=0.37446 
Train Epoch: 23 [666/1000 21312/32000 (67%)] Loss: 0.16188 (QuantReg: 13.17808) QuantErr: 13.17808 batch_time=0.45653 
Train Epoch: 23 [671/1000 21472/32000 (67%)] Loss: 0.34967 (QuantReg: 12.30255) QuantErr: 12.30255 batch_time=0.38907 
Train Epoch: 23 [676/1000 21632/32000 (68%)] Loss: 0.26603 (QuantReg: 13.19875) QuantErr: 13.19875 batch_time=0.47198 
Train Epoch: 23 [681/1000 21792/32000 (68%)] Loss: 0.36082 (QuantReg: 12.52295) QuantErr: 12.52295 batch_time=0.35947 
Train Epoch: 23 [686/1000 21952/32000 (69%)] Loss: 1.10319 (QuantReg: 12.93649) QuantErr: 12.93649 batch_time=0.35335 
Train Epoch: 23 [691/1000 22112/32000 (69%)] Loss: 0.18930 (QuantReg: 12.62508) QuantErr: 12.62508 batch_time=0.52614 
Train Epoch: 23 [696/1000 22272/32000 (70%)] Loss: 0.47069 (QuantReg: 12.80473) QuantErr: 12.80473 batch_time=0.35506 
Train Epoch: 23 [701/1000 22432/32000 (70%)] Loss: 0.46239 (QuantReg: 12.13756) QuantErr: 12.13756 batch_time=1.10315 
Train Epoch: 23 [706/1000 22592/32000 (71%)] Loss: 0.17394 (QuantReg: 12.87797) QuantErr: 12.87797 batch_time=0.36502 
Train Epoch: 23 [711/1000 22752/32000 (71%)] Loss: 0.33541 (QuantReg: 12.64858) QuantErr: 12.64858 batch_time=0.45876 
Train Epoch: 23 [716/1000 22912/32000 (72%)] Loss: 0.22772 (QuantReg: 11.82605) QuantErr: 11.82605 batch_time=0.42120 
Train Epoch: 23 [721/1000 23072/32000 (72%)] Loss: 0.82274 (QuantReg: 12.65410) QuantErr: 12.65410 batch_time=0.35282 
Train Epoch: 23 [726/1000 23232/32000 (73%)] Loss: 0.38315 (QuantReg: 12.30544) QuantErr: 12.30544 batch_time=0.42481 
Train Epoch: 23 [731/1000 23392/32000 (73%)] Loss: 0.42225 (QuantReg: 12.94375) QuantErr: 12.94375 batch_time=0.37605 
Train Epoch: 23 [736/1000 23552/32000 (74%)] Loss: 0.31902 (QuantReg: 12.81610) QuantErr: 12.81610 batch_time=0.82950 
Train Epoch: 23 [741/1000 23712/32000 (74%)] Loss: 0.57934 (QuantReg: 12.75943) QuantErr: 12.75943 batch_time=1.18259 
Train Epoch: 23 [746/1000 23872/32000 (75%)] Loss: 0.53449 (QuantReg: 12.76788) QuantErr: 12.76788 batch_time=0.44569 
Train Epoch: 23 [751/1000 24032/32000 (75%)] Loss: 0.77868 (QuantReg: 12.80122) QuantErr: 12.80122 batch_time=0.41241 
Train Epoch: 23 [756/1000 24192/32000 (76%)] Loss: 0.51763 (QuantReg: 12.56384) QuantErr: 12.56384 batch_time=0.44581 
Train Epoch: 23 [761/1000 24352/32000 (76%)] Loss: 0.62121 (QuantReg: 13.14038) QuantErr: 13.14038 batch_time=0.40590 
Train Epoch: 23 [766/1000 24512/32000 (77%)] Loss: 0.15563 (QuantReg: 13.33443) QuantErr: 13.33443 batch_time=0.41235 
Train Epoch: 23 [771/1000 24672/32000 (77%)] Loss: 0.25823 (QuantReg: 12.78181) QuantErr: 12.78181 batch_time=0.37652 
Train Epoch: 23 [776/1000 24832/32000 (78%)] Loss: 0.35834 (QuantReg: 12.61085) QuantErr: 12.61085 batch_time=0.37474 
Train Epoch: 23 [781/1000 24992/32000 (78%)] Loss: 0.12509 (QuantReg: 13.07225) QuantErr: 13.07225 batch_time=0.82990 
Train Epoch: 23 [786/1000 25152/32000 (79%)] Loss: 0.20668 (QuantReg: 12.99758) QuantErr: 12.99758 batch_time=0.36273 
Train Epoch: 23 [791/1000 25312/32000 (79%)] Loss: 0.44767 (QuantReg: 12.58507) QuantErr: 12.58507 batch_time=0.41654 
Train Epoch: 23 [796/1000 25472/32000 (80%)] Loss: 0.53268 (QuantReg: 12.97322) QuantErr: 12.97322 batch_time=0.36696 
Train Epoch: 23 [801/1000 25632/32000 (80%)] Loss: 0.49115 (QuantReg: 12.39882) QuantErr: 12.39882 batch_time=0.49539 
Train Epoch: 23 [806/1000 25792/32000 (81%)] Loss: 0.30523 (QuantReg: 12.80724) QuantErr: 12.80724 batch_time=0.37906 
Train Epoch: 23 [811/1000 25952/32000 (81%)] Loss: 0.86417 (QuantReg: 12.52214) QuantErr: 12.52214 batch_time=0.45602 
Train Epoch: 23 [816/1000 26112/32000 (82%)] Loss: 0.25306 (QuantReg: 12.80099) QuantErr: 12.80099 batch_time=0.39342 
Train Epoch: 23 [821/1000 26272/32000 (82%)] Loss: 0.57740 (QuantReg: 12.21972) QuantErr: 12.21972 batch_time=0.36415 
Train Epoch: 23 [826/1000 26432/32000 (83%)] Loss: 0.25370 (QuantReg: 13.23236) QuantErr: 13.23236 batch_time=0.42656 
Train Epoch: 23 [831/1000 26592/32000 (83%)] Loss: 0.42892 (QuantReg: 13.10063) QuantErr: 13.10063 batch_time=0.38790 
Train Epoch: 23 [836/1000 26752/32000 (84%)] Loss: 0.22879 (QuantReg: 11.75393) QuantErr: 11.75393 batch_time=0.35542 
Train Epoch: 23 [841/1000 26912/32000 (84%)] Loss: 0.31332 (QuantReg: 12.52099) QuantErr: 12.52099 batch_time=0.51566 
Train Epoch: 23 [846/1000 27072/32000 (85%)] Loss: 0.24717 (QuantReg: 12.73770) QuantErr: 12.73770 batch_time=0.44663 
Train Epoch: 23 [851/1000 27232/32000 (85%)] Loss: 0.27442 (QuantReg: 12.95905) QuantErr: 12.95905 batch_time=0.41759 
Train Epoch: 23 [856/1000 27392/32000 (86%)] Loss: 0.58123 (QuantReg: 11.81704) QuantErr: 11.81704 batch_time=0.95261 
Train Epoch: 23 [861/1000 27552/32000 (86%)] Loss: 0.34741 (QuantReg: 12.54920) QuantErr: 12.54920 batch_time=0.38647 
Train Epoch: 23 [866/1000 27712/32000 (87%)] Loss: 0.38234 (QuantReg: 12.50126) QuantErr: 12.50126 batch_time=0.37317 
Train Epoch: 23 [871/1000 27872/32000 (87%)] Loss: 0.21016 (QuantReg: 12.46015) QuantErr: 12.46015 batch_time=0.70465 
Train Epoch: 23 [876/1000 28032/32000 (88%)] Loss: 0.32353 (QuantReg: 12.55198) QuantErr: 12.55198 batch_time=0.37920 
Train Epoch: 23 [881/1000 28192/32000 (88%)] Loss: 0.33463 (QuantReg: 12.60116) QuantErr: 12.60116 batch_time=0.41219 
Train Epoch: 23 [886/1000 28352/32000 (89%)] Loss: 0.34612 (QuantReg: 13.33988) QuantErr: 13.33988 batch_time=0.35816 
Train Epoch: 23 [891/1000 28512/32000 (89%)] Loss: 0.28130 (QuantReg: 13.35061) QuantErr: 13.35061 batch_time=0.38158 
Train Epoch: 23 [896/1000 28672/32000 (90%)] Loss: 0.59458 (QuantReg: 12.93135) QuantErr: 12.93135 batch_time=0.38956 
Train Epoch: 23 [901/1000 28832/32000 (90%)] Loss: 0.14654 (QuantReg: 13.05501) QuantErr: 13.05501 batch_time=0.39085 
Train Epoch: 23 [906/1000 28992/32000 (91%)] Loss: 0.32984 (QuantReg: 12.38463) QuantErr: 12.38463 batch_time=0.38008 
Train Epoch: 23 [911/1000 29152/32000 (91%)] Loss: 0.32879 (QuantReg: 12.18420) QuantErr: 12.18420 batch_time=0.36948 
Train Epoch: 23 [916/1000 29312/32000 (92%)] Loss: 0.43098 (QuantReg: 13.24860) QuantErr: 13.24860 batch_time=0.36543 
Train Epoch: 23 [921/1000 29472/32000 (92%)] Loss: 0.30295 (QuantReg: 12.76784) QuantErr: 12.76784 batch_time=0.65942 
Train Epoch: 23 [926/1000 29632/32000 (93%)] Loss: 0.25572 (QuantReg: 13.33075) QuantErr: 13.33075 batch_time=0.39723 
Train Epoch: 23 [931/1000 29792/32000 (93%)] Loss: 0.75358 (QuantReg: 12.70263) QuantErr: 12.70263 batch_time=0.40657 
Train Epoch: 23 [936/1000 29952/32000 (94%)] Loss: 0.53364 (QuantReg: 12.24993) QuantErr: 12.24993 batch_time=0.37794 
Train Epoch: 23 [941/1000 30112/32000 (94%)] Loss: 0.17298 (QuantReg: 13.28659) QuantErr: 13.28659 batch_time=0.48874 
Train Epoch: 23 [946/1000 30272/32000 (95%)] Loss: 0.29538 (QuantReg: 12.87615) QuantErr: 12.87615 batch_time=0.46425 
Train Epoch: 23 [951/1000 30432/32000 (95%)] Loss: 0.20631 (QuantReg: 12.55506) QuantErr: 12.55506 batch_time=0.41188 
Train Epoch: 23 [956/1000 30592/32000 (96%)] Loss: 0.68918 (QuantReg: 12.88557) QuantErr: 12.88557 batch_time=0.37872 
Train Epoch: 23 [961/1000 30752/32000 (96%)] Loss: 0.16094 (QuantReg: 13.36582) QuantErr: 13.36582 batch_time=0.35474 
Train Epoch: 23 [966/1000 30912/32000 (97%)] Loss: 0.44379 (QuantReg: 12.56199) QuantErr: 12.56199 batch_time=1.47239 
Train Epoch: 23 [971/1000 31072/32000 (97%)] Loss: 0.40036 (QuantReg: 13.34591) QuantErr: 13.34591 batch_time=0.39915 
Train Epoch: 23 [976/1000 31232/32000 (98%)] Loss: 0.35136 (QuantReg: 12.84097) QuantErr: 12.84097 batch_time=0.35576 
Train Epoch: 23 [981/1000 31392/32000 (98%)] Loss: 0.37833 (QuantReg: 13.21580) QuantErr: 13.21580 batch_time=0.41618 
Train Epoch: 23 [986/1000 31552/32000 (99%)] Loss: 0.19104 (QuantReg: 13.48399) QuantErr: 13.48399 batch_time=0.45670 
Train Epoch: 23 [991/1000 31712/32000 (99%)] Loss: 0.42075 (QuantReg: 12.03040) QuantErr: 12.03040 batch_time=0.35471 
Train Epoch: 23 [996/1000 31872/32000 (100%)] Loss: 0.41813 (QuantReg: 12.87801) QuantErr: 12.87801 batch_time=0.39794 
Train Epoch: 23 codebook_update_time=1.83490
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch23.pth ...
Done in 22.068s
removing stale ckpt [epoch 22] [took 0.02s]
 epoch          : 23
 loss           : 0.43351973737031224
 quant_reg      : 12.670734815597534
 quant_err      : 12.670734815597534
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 23000
 MSRVTT_miech_test/t2v_metrics/R1: 19.5
 MSRVTT_miech_test/t2v_metrics/R5: 47.2
 MSRVTT_miech_test/t2v_metrics/R10: 60.0
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.092
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.081082637581126
 MSRVTT_miech_test/v2t_metrics/R1: 19.9
 MSRVTT_miech_test/v2t_metrics/R5: 48.2
 MSRVTT_miech_test/v2t_metrics/R10: 62.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.068
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.13752673838105
 mnt_best       : 38.45489562444897
 not_improved_count: 3
Train Epoch: 24 [1/1000 32/32000 (0%)] Loss: 0.27756 (QuantReg: 12.67178) QuantErr: 12.67178 batch_time=30.06448 
Train Epoch: 24 [6/1000 192/32000 (1%)] Loss: 0.27518 (QuantReg: 12.58563) QuantErr: 12.58563 batch_time=0.78253 
Train Epoch: 24 [11/1000 352/32000 (1%)] Loss: 0.43736 (QuantReg: 12.47286) QuantErr: 12.47286 batch_time=0.33896 
Train Epoch: 24 [16/1000 512/32000 (2%)] Loss: 0.67095 (QuantReg: 12.75239) QuantErr: 12.75239 batch_time=0.98416 
Train Epoch: 24 [21/1000 672/32000 (2%)] Loss: 0.16158 (QuantReg: 12.74712) QuantErr: 12.74712 batch_time=0.57239 
Train Epoch: 24 [26/1000 832/32000 (3%)] Loss: 0.25555 (QuantReg: 13.14426) QuantErr: 13.14426 batch_time=0.58154 
Train Epoch: 24 [31/1000 992/32000 (3%)] Loss: 0.19227 (QuantReg: 12.39453) QuantErr: 12.39453 batch_time=2.20017 
Train Epoch: 24 [36/1000 1152/32000 (4%)] Loss: 0.30201 (QuantReg: 11.95584) QuantErr: 11.95584 batch_time=0.37022 
Train Epoch: 24 [41/1000 1312/32000 (4%)] Loss: 0.57334 (QuantReg: 12.88795) QuantErr: 12.88795 batch_time=0.39654 
Train Epoch: 24 [46/1000 1472/32000 (5%)] Loss: 0.50872 (QuantReg: 13.02851) QuantErr: 13.02851 batch_time=0.41851 
Train Epoch: 24 [51/1000 1632/32000 (5%)] Loss: 0.86814 (QuantReg: 11.92625) QuantErr: 11.92625 batch_time=0.34118 
Train Epoch: 24 [56/1000 1792/32000 (6%)] Loss: 0.44567 (QuantReg: 12.25316) QuantErr: 12.25316 batch_time=0.72657 
Train Epoch: 24 [61/1000 1952/32000 (6%)] Loss: 0.43317 (QuantReg: 12.52398) QuantErr: 12.52398 batch_time=0.35994 
Train Epoch: 24 [66/1000 2112/32000 (7%)] Loss: 0.39016 (QuantReg: 12.40416) QuantErr: 12.40416 batch_time=0.52456 
Train Epoch: 24 [71/1000 2272/32000 (7%)] Loss: 0.40647 (QuantReg: 12.95129) QuantErr: 12.95129 batch_time=0.35388 
Train Epoch: 24 [76/1000 2432/32000 (8%)] Loss: 0.16460 (QuantReg: 11.83560) QuantErr: 11.83560 batch_time=0.44365 
Train Epoch: 24 [81/1000 2592/32000 (8%)] Loss: 0.65681 (QuantReg: 12.48824) QuantErr: 12.48824 batch_time=0.41053 
Train Epoch: 24 [86/1000 2752/32000 (9%)] Loss: 0.66597 (QuantReg: 12.69587) QuantErr: 12.69587 batch_time=0.40497 
Train Epoch: 24 [91/1000 2912/32000 (9%)] Loss: 0.27370 (QuantReg: 12.33042) QuantErr: 12.33042 batch_time=0.43727 
Train Epoch: 24 [96/1000 3072/32000 (10%)] Loss: 0.31668 (QuantReg: 13.13889) QuantErr: 13.13889 batch_time=0.35574 
Train Epoch: 24 [101/1000 3232/32000 (10%)] Loss: 0.29146 (QuantReg: 12.76109) QuantErr: 12.76109 batch_time=0.59374 
Train Epoch: 24 [106/1000 3392/32000 (11%)] Loss: 0.35934 (QuantReg: 12.23010) QuantErr: 12.23010 batch_time=0.34466 
Train Epoch: 24 [111/1000 3552/32000 (11%)] Loss: 0.50970 (QuantReg: 12.16820) QuantErr: 12.16820 batch_time=0.45231 
Train Epoch: 24 [116/1000 3712/32000 (12%)] Loss: 0.80400 (QuantReg: 12.84905) QuantErr: 12.84905 batch_time=0.35623 
Train Epoch: 24 [121/1000 3872/32000 (12%)] Loss: 0.67998 (QuantReg: 12.15923) QuantErr: 12.15923 batch_time=0.43807 
Train Epoch: 24 [126/1000 4032/32000 (13%)] Loss: 0.20582 (QuantReg: 12.71842) QuantErr: 12.71842 batch_time=0.38947 
Train Epoch: 24 [131/1000 4192/32000 (13%)] Loss: 0.32242 (QuantReg: 13.17203) QuantErr: 13.17203 batch_time=0.44949 
Train Epoch: 24 [136/1000 4352/32000 (14%)] Loss: 0.38076 (QuantReg: 12.68130) QuantErr: 12.68130 batch_time=0.34779 
Train Epoch: 24 [141/1000 4512/32000 (14%)] Loss: 0.26441 (QuantReg: 12.78483) QuantErr: 12.78483 batch_time=0.37627 
Train Epoch: 24 [146/1000 4672/32000 (15%)] Loss: 0.18358 (QuantReg: 12.83574) QuantErr: 12.83574 batch_time=0.37507 
Train Epoch: 24 [151/1000 4832/32000 (15%)] Loss: 0.36534 (QuantReg: 12.47951) QuantErr: 12.47951 batch_time=0.53049 
Train Epoch: 24 [156/1000 4992/32000 (16%)] Loss: 0.31444 (QuantReg: 12.83064) QuantErr: 12.83064 batch_time=0.35831 
Train Epoch: 24 [161/1000 5152/32000 (16%)] Loss: 0.42816 (QuantReg: 12.52474) QuantErr: 12.52474 batch_time=0.39046 
Train Epoch: 24 [166/1000 5312/32000 (17%)] Loss: 0.35816 (QuantReg: 13.35799) QuantErr: 13.35799 batch_time=0.36812 
Train Epoch: 24 [171/1000 5472/32000 (17%)] Loss: 0.39099 (QuantReg: 13.00389) QuantErr: 13.00389 batch_time=0.39513 
Train Epoch: 24 [176/1000 5632/32000 (18%)] Loss: 0.30074 (QuantReg: 12.68151) QuantErr: 12.68151 batch_time=0.44343 
Train Epoch: 24 [181/1000 5792/32000 (18%)] Loss: 0.60998 (QuantReg: 12.32647) QuantErr: 12.32647 batch_time=0.37522 
Train Epoch: 24 [186/1000 5952/32000 (19%)] Loss: 0.27417 (QuantReg: 12.51738) QuantErr: 12.51738 batch_time=0.49449 
Train Epoch: 24 [191/1000 6112/32000 (19%)] Loss: 0.32369 (QuantReg: 12.44103) QuantErr: 12.44103 batch_time=0.34871 
Train Epoch: 24 [196/1000 6272/32000 (20%)] Loss: 0.60939 (QuantReg: 13.20379) QuantErr: 13.20379 batch_time=0.59334 
Train Epoch: 24 [201/1000 6432/32000 (20%)] Loss: 0.47952 (QuantReg: 13.51582) QuantErr: 13.51582 batch_time=0.42204 
Train Epoch: 24 [206/1000 6592/32000 (21%)] Loss: 0.36238 (QuantReg: 12.60433) QuantErr: 12.60433 batch_time=0.42386 
Train Epoch: 24 [211/1000 6752/32000 (21%)] Loss: 0.48969 (QuantReg: 11.78719) QuantErr: 11.78719 batch_time=0.39400 
Train Epoch: 24 [216/1000 6912/32000 (22%)] Loss: 0.30905 (QuantReg: 12.24910) QuantErr: 12.24910 batch_time=0.45542 
Train Epoch: 24 [221/1000 7072/32000 (22%)] Loss: 0.36139 (QuantReg: 12.64794) QuantErr: 12.64794 batch_time=1.57626 
Train Epoch: 24 [226/1000 7232/32000 (23%)] Loss: 0.42863 (QuantReg: 12.46303) QuantErr: 12.46303 batch_time=0.35587 
Train Epoch: 24 [231/1000 7392/32000 (23%)] Loss: 0.21690 (QuantReg: 12.92924) QuantErr: 12.92924 batch_time=0.36331 
Train Epoch: 24 [236/1000 7552/32000 (24%)] Loss: 0.22002 (QuantReg: 12.95822) QuantErr: 12.95822 batch_time=0.36513 
Train Epoch: 24 [241/1000 7712/32000 (24%)] Loss: 0.35098 (QuantReg: 12.78126) QuantErr: 12.78126 batch_time=0.58729 
Train Epoch: 24 [246/1000 7872/32000 (25%)] Loss: 0.88364 (QuantReg: 12.05688) QuantErr: 12.05688 batch_time=0.42468 
Train Epoch: 24 [251/1000 8032/32000 (25%)] Loss: 0.57055 (QuantReg: 12.67066) QuantErr: 12.67066 batch_time=0.44166 
Train Epoch: 24 [256/1000 8192/32000 (26%)] Loss: 0.37576 (QuantReg: 12.20295) QuantErr: 12.20295 batch_time=0.40375 
Train Epoch: 24 [261/1000 8352/32000 (26%)] Loss: 0.23829 (QuantReg: 12.32238) QuantErr: 12.32238 batch_time=0.37907 
Train Epoch: 24 [266/1000 8512/32000 (27%)] Loss: 0.20753 (QuantReg: 13.42634) QuantErr: 13.42634 batch_time=0.35904 
Train Epoch: 24 [271/1000 8672/32000 (27%)] Loss: 0.41663 (QuantReg: 12.35242) QuantErr: 12.35242 batch_time=0.36212 
Train Epoch: 24 [276/1000 8832/32000 (28%)] Loss: 0.18456 (QuantReg: 12.02946) QuantErr: 12.02946 batch_time=0.35701 
Train Epoch: 24 [281/1000 8992/32000 (28%)] Loss: 0.25321 (QuantReg: 12.48272) QuantErr: 12.48272 batch_time=0.46055 
Train Epoch: 24 [286/1000 9152/32000 (29%)] Loss: 0.38022 (QuantReg: 12.29453) QuantErr: 12.29453 batch_time=0.74685 
Train Epoch: 24 [291/1000 9312/32000 (29%)] Loss: 0.28275 (QuantReg: 12.15022) QuantErr: 12.15022 batch_time=0.38676 
Train Epoch: 24 [296/1000 9472/32000 (30%)] Loss: 0.56848 (QuantReg: 12.20441) QuantErr: 12.20441 batch_time=0.46096 
Train Epoch: 24 [301/1000 9632/32000 (30%)] Loss: 0.76654 (QuantReg: 12.70015) QuantErr: 12.70015 batch_time=0.37972 
Train Epoch: 24 [306/1000 9792/32000 (31%)] Loss: 0.65311 (QuantReg: 13.02314) QuantErr: 13.02314 batch_time=0.42993 
Train Epoch: 24 [311/1000 9952/32000 (31%)] Loss: 0.36768 (QuantReg: 12.81271) QuantErr: 12.81271 batch_time=0.42587 
Train Epoch: 24 [316/1000 10112/32000 (32%)] Loss: 0.16759 (QuantReg: 12.70794) QuantErr: 12.70794 batch_time=0.44127 
Train Epoch: 24 [321/1000 10272/32000 (32%)] Loss: 0.98050 (QuantReg: 12.61195) QuantErr: 12.61195 batch_time=0.49059 
Train Epoch: 24 [326/1000 10432/32000 (33%)] Loss: 0.29031 (QuantReg: 12.84961) QuantErr: 12.84961 batch_time=0.34341 
Train Epoch: 24 [331/1000 10592/32000 (33%)] Loss: 0.38608 (QuantReg: 11.47618) QuantErr: 11.47618 batch_time=0.36726 
Train Epoch: 24 [336/1000 10752/32000 (34%)] Loss: 0.28067 (QuantReg: 12.85945) QuantErr: 12.85945 batch_time=0.35546 
Train Epoch: 24 [341/1000 10912/32000 (34%)] Loss: 0.46221 (QuantReg: 12.53116) QuantErr: 12.53116 batch_time=0.38355 
Train Epoch: 24 [346/1000 11072/32000 (35%)] Loss: 0.32344 (QuantReg: 12.30663) QuantErr: 12.30663 batch_time=0.36048 
Train Epoch: 24 [351/1000 11232/32000 (35%)] Loss: 0.22877 (QuantReg: 12.28833) QuantErr: 12.28833 batch_time=1.11002 
Train Epoch: 24 [356/1000 11392/32000 (36%)] Loss: 0.19352 (QuantReg: 13.23678) QuantErr: 13.23678 batch_time=0.40830 
Train Epoch: 24 [361/1000 11552/32000 (36%)] Loss: 0.53634 (QuantReg: 12.54625) QuantErr: 12.54625 batch_time=0.37755 
Train Epoch: 24 [366/1000 11712/32000 (37%)] Loss: 0.23548 (QuantReg: 13.00517) QuantErr: 13.00517 batch_time=0.36496 
Train Epoch: 24 [371/1000 11872/32000 (37%)] Loss: 0.35187 (QuantReg: 12.70899) QuantErr: 12.70899 batch_time=0.37837 
Train Epoch: 24 [376/1000 12032/32000 (38%)] Loss: 0.32669 (QuantReg: 12.81644) QuantErr: 12.81644 batch_time=0.49202 
Train Epoch: 24 [381/1000 12192/32000 (38%)] Loss: 0.46057 (QuantReg: 12.47219) QuantErr: 12.47219 batch_time=0.65456 
Train Epoch: 24 [386/1000 12352/32000 (39%)] Loss: 0.36177 (QuantReg: 13.41561) QuantErr: 13.41561 batch_time=0.47127 
Train Epoch: 24 [391/1000 12512/32000 (39%)] Loss: 0.42593 (QuantReg: 12.62156) QuantErr: 12.62156 batch_time=0.45386 
Train Epoch: 24 [396/1000 12672/32000 (40%)] Loss: 1.01883 (QuantReg: 12.59007) QuantErr: 12.59007 batch_time=0.36967 
Train Epoch: 24 [401/1000 12832/32000 (40%)] Loss: 0.36727 (QuantReg: 13.02221) QuantErr: 13.02221 batch_time=0.45367 
Train Epoch: 24 [406/1000 12992/32000 (41%)] Loss: 0.69583 (QuantReg: 12.61550) QuantErr: 12.61550 batch_time=0.37337 
Train Epoch: 24 [411/1000 13152/32000 (41%)] Loss: 0.33474 (QuantReg: 12.43475) QuantErr: 12.43475 batch_time=0.48134 
Train Epoch: 24 [416/1000 13312/32000 (42%)] Loss: 0.47732 (QuantReg: 12.64736) QuantErr: 12.64736 batch_time=0.42579 
Train Epoch: 24 [421/1000 13472/32000 (42%)] Loss: 0.52003 (QuantReg: 12.47965) QuantErr: 12.47965 batch_time=0.47342 
Train Epoch: 24 [426/1000 13632/32000 (43%)] Loss: 0.31188 (QuantReg: 13.01191) QuantErr: 13.01191 batch_time=0.46658 
Train Epoch: 24 [431/1000 13792/32000 (43%)] Loss: 0.41122 (QuantReg: 12.76510) QuantErr: 12.76510 batch_time=0.37345 
Train Epoch: 24 [436/1000 13952/32000 (44%)] Loss: 0.32115 (QuantReg: 12.62829) QuantErr: 12.62829 batch_time=0.52995 
Train Epoch: 24 [441/1000 14112/32000 (44%)] Loss: 0.46902 (QuantReg: 12.05829) QuantErr: 12.05829 batch_time=0.37244 
Train Epoch: 24 [446/1000 14272/32000 (45%)] Loss: 0.37812 (QuantReg: 12.90177) QuantErr: 12.90177 batch_time=0.34478 
Train Epoch: 24 [451/1000 14432/32000 (45%)] Loss: 0.65616 (QuantReg: 12.57444) QuantErr: 12.57444 batch_time=0.41048 
Train Epoch: 24 [456/1000 14592/32000 (46%)] Loss: 0.45618 (QuantReg: 12.96232) QuantErr: 12.96232 batch_time=1.83925 
Train Epoch: 24 [461/1000 14752/32000 (46%)] Loss: 0.33068 (QuantReg: 13.26535) QuantErr: 13.26535 batch_time=0.38444 
Train Epoch: 24 [466/1000 14912/32000 (47%)] Loss: 1.35360 (QuantReg: 11.96322) QuantErr: 11.96322 batch_time=0.35268 
Train Epoch: 24 [471/1000 15072/32000 (47%)] Loss: 0.58919 (QuantReg: 12.44522) QuantErr: 12.44522 batch_time=0.43324 
Train Epoch: 24 [476/1000 15232/32000 (48%)] Loss: 0.30330 (QuantReg: 13.43624) QuantErr: 13.43624 batch_time=0.41617 
Train Epoch: 24 [481/1000 15392/32000 (48%)] Loss: 0.24634 (QuantReg: 13.28378) QuantErr: 13.28378 batch_time=0.43158 
Train Epoch: 24 [486/1000 15552/32000 (49%)] Loss: 0.28978 (QuantReg: 13.32379) QuantErr: 13.32379 batch_time=0.48784 
Train Epoch: 24 [491/1000 15712/32000 (49%)] Loss: 0.47634 (QuantReg: 12.83000) QuantErr: 12.83000 batch_time=0.41741 
Train Epoch: 24 [496/1000 15872/32000 (50%)] Loss: 0.76932 (QuantReg: 13.49471) QuantErr: 13.49471 batch_time=0.37018 
Train Epoch: 24 [501/1000 16032/32000 (50%)] Loss: 0.28774 (QuantReg: 12.74200) QuantErr: 12.74200 batch_time=0.35282 
Train Epoch: 24 [506/1000 16192/32000 (51%)] Loss: 0.40314 (QuantReg: 12.96757) QuantErr: 12.96757 batch_time=0.35350 
Train Epoch: 24 [511/1000 16352/32000 (51%)] Loss: 0.26807 (QuantReg: 12.83072) QuantErr: 12.83072 batch_time=0.36467 
Train Epoch: 24 [516/1000 16512/32000 (52%)] Loss: 0.53064 (QuantReg: 13.26633) QuantErr: 13.26633 batch_time=0.36930 
Train Epoch: 24 [521/1000 16672/32000 (52%)] Loss: 0.12997 (QuantReg: 13.40931) QuantErr: 13.40931 batch_time=0.75719 
Train Epoch: 24 [526/1000 16832/32000 (53%)] Loss: 0.39297 (QuantReg: 12.58932) QuantErr: 12.58932 batch_time=0.35305 
Train Epoch: 24 [531/1000 16992/32000 (53%)] Loss: 0.70863 (QuantReg: 12.41996) QuantErr: 12.41996 batch_time=0.47762 
Train Epoch: 24 [536/1000 17152/32000 (54%)] Loss: 0.41153 (QuantReg: 12.52642) QuantErr: 12.52642 batch_time=0.37207 
Train Epoch: 24 [541/1000 17312/32000 (54%)] Loss: 0.28054 (QuantReg: 12.96312) QuantErr: 12.96312 batch_time=3.92796 
Train Epoch: 24 [546/1000 17472/32000 (55%)] Loss: 0.37507 (QuantReg: 13.23083) QuantErr: 13.23083 batch_time=0.38876 
Train Epoch: 24 [551/1000 17632/32000 (55%)] Loss: 0.50582 (QuantReg: 13.12969) QuantErr: 13.12969 batch_time=0.37067 
Train Epoch: 24 [556/1000 17792/32000 (56%)] Loss: 0.54760 (QuantReg: 12.69062) QuantErr: 12.69062 batch_time=0.38213 
Train Epoch: 24 [561/1000 17952/32000 (56%)] Loss: 0.33449 (QuantReg: 13.09482) QuantErr: 13.09482 batch_time=0.39651 
Train Epoch: 24 [566/1000 18112/32000 (57%)] Loss: 0.30659 (QuantReg: 12.86038) QuantErr: 12.86038 batch_time=0.34239 
Train Epoch: 24 [571/1000 18272/32000 (57%)] Loss: 0.33826 (QuantReg: 12.15410) QuantErr: 12.15410 batch_time=0.75382 
Train Epoch: 24 [576/1000 18432/32000 (58%)] Loss: 0.37217 (QuantReg: 12.78742) QuantErr: 12.78742 batch_time=0.35823 
Train Epoch: 24 [581/1000 18592/32000 (58%)] Loss: 0.78447 (QuantReg: 12.45349) QuantErr: 12.45349 batch_time=0.42113 
Train Epoch: 24 [586/1000 18752/32000 (59%)] Loss: 0.18927 (QuantReg: 13.46208) QuantErr: 13.46208 batch_time=0.37239 
Train Epoch: 24 [591/1000 18912/32000 (59%)] Loss: 0.46204 (QuantReg: 12.74577) QuantErr: 12.74577 batch_time=0.38556 
Train Epoch: 24 [596/1000 19072/32000 (60%)] Loss: 0.79054 (QuantReg: 12.16630) QuantErr: 12.16630 batch_time=0.36738 
Train Epoch: 24 [601/1000 19232/32000 (60%)] Loss: 0.35883 (QuantReg: 12.88883) QuantErr: 12.88883 batch_time=0.40110 
Train Epoch: 24 [606/1000 19392/32000 (61%)] Loss: 0.39027 (QuantReg: 12.87658) QuantErr: 12.87658 batch_time=0.50626 
Train Epoch: 24 [611/1000 19552/32000 (61%)] Loss: 0.45947 (QuantReg: 12.69931) QuantErr: 12.69931 batch_time=0.35194 
Train Epoch: 24 [616/1000 19712/32000 (62%)] Loss: 0.10122 (QuantReg: 12.82082) QuantErr: 12.82082 batch_time=0.80326 
Train Epoch: 24 [621/1000 19872/32000 (62%)] Loss: 0.32342 (QuantReg: 13.30107) QuantErr: 13.30107 batch_time=0.35411 
Train Epoch: 24 [626/1000 20032/32000 (63%)] Loss: 0.18323 (QuantReg: 12.66675) QuantErr: 12.66675 batch_time=0.69447 
Train Epoch: 24 [631/1000 20192/32000 (63%)] Loss: 0.46909 (QuantReg: 12.56976) QuantErr: 12.56976 batch_time=1.57206 
Train Epoch: 24 [636/1000 20352/32000 (64%)] Loss: 0.52217 (QuantReg: 12.16898) QuantErr: 12.16898 batch_time=0.45669 
Train Epoch: 24 [641/1000 20512/32000 (64%)] Loss: 0.41364 (QuantReg: 12.65460) QuantErr: 12.65460 batch_time=0.35984 
Train Epoch: 24 [646/1000 20672/32000 (65%)] Loss: 0.46434 (QuantReg: 12.87102) QuantErr: 12.87102 batch_time=0.36188 
Train Epoch: 24 [651/1000 20832/32000 (65%)] Loss: 0.32538 (QuantReg: 12.96714) QuantErr: 12.96714 batch_time=0.44338 
Train Epoch: 24 [656/1000 20992/32000 (66%)] Loss: 0.08274 (QuantReg: 12.84791) QuantErr: 12.84791 batch_time=0.36958 
Train Epoch: 24 [661/1000 21152/32000 (66%)] Loss: 0.25107 (QuantReg: 12.35666) QuantErr: 12.35666 batch_time=0.70111 
Train Epoch: 24 [666/1000 21312/32000 (67%)] Loss: 0.39873 (QuantReg: 12.26386) QuantErr: 12.26386 batch_time=0.39644 
Train Epoch: 24 [671/1000 21472/32000 (67%)] Loss: 0.64594 (QuantReg: 12.93715) QuantErr: 12.93715 batch_time=0.42911 
Train Epoch: 24 [676/1000 21632/32000 (68%)] Loss: 0.45408 (QuantReg: 12.76943) QuantErr: 12.76943 batch_time=0.34832 
Train Epoch: 24 [681/1000 21792/32000 (68%)] Loss: 0.55096 (QuantReg: 12.30640) QuantErr: 12.30640 batch_time=0.37887 
Train Epoch: 24 [686/1000 21952/32000 (69%)] Loss: 0.78072 (QuantReg: 12.32467) QuantErr: 12.32467 batch_time=0.38127 
Train Epoch: 24 [691/1000 22112/32000 (69%)] Loss: 0.37428 (QuantReg: 12.57550) QuantErr: 12.57550 batch_time=0.43893 
Train Epoch: 24 [696/1000 22272/32000 (70%)] Loss: 0.40044 (QuantReg: 13.31261) QuantErr: 13.31261 batch_time=0.37798 
Train Epoch: 24 [701/1000 22432/32000 (70%)] Loss: 0.68373 (QuantReg: 13.15432) QuantErr: 13.15432 batch_time=0.42082 
Train Epoch: 24 [706/1000 22592/32000 (71%)] Loss: 0.12901 (QuantReg: 12.84055) QuantErr: 12.84055 batch_time=0.45233 
Train Epoch: 24 [711/1000 22752/32000 (71%)] Loss: 0.29107 (QuantReg: 11.84548) QuantErr: 11.84548 batch_time=0.41031 
Train Epoch: 24 [716/1000 22912/32000 (72%)] Loss: 0.58096 (QuantReg: 12.50930) QuantErr: 12.50930 batch_time=0.35701 
Train Epoch: 24 [721/1000 23072/32000 (72%)] Loss: 0.18255 (QuantReg: 13.07087) QuantErr: 13.07087 batch_time=0.46915 
Train Epoch: 24 [726/1000 23232/32000 (73%)] Loss: 0.82955 (QuantReg: 12.35317) QuantErr: 12.35317 batch_time=0.35384 
Train Epoch: 24 [731/1000 23392/32000 (73%)] Loss: 0.41771 (QuantReg: 12.66207) QuantErr: 12.66207 batch_time=0.35441 
Train Epoch: 24 [736/1000 23552/32000 (74%)] Loss: 0.31772 (QuantReg: 12.85894) QuantErr: 12.85894 batch_time=0.37967 
Train Epoch: 24 [741/1000 23712/32000 (74%)] Loss: 1.04782 (QuantReg: 12.49382) QuantErr: 12.49382 batch_time=0.37041 
Train Epoch: 24 [746/1000 23872/32000 (75%)] Loss: 0.35350 (QuantReg: 12.71435) QuantErr: 12.71435 batch_time=0.39396 
Train Epoch: 24 [751/1000 24032/32000 (75%)] Loss: 0.48626 (QuantReg: 12.77600) QuantErr: 12.77600 batch_time=0.38740 
Train Epoch: 24 [756/1000 24192/32000 (76%)] Loss: 0.85836 (QuantReg: 12.65928) QuantErr: 12.65928 batch_time=0.79088 
Train Epoch: 24 [761/1000 24352/32000 (76%)] Loss: 0.29358 (QuantReg: 12.54343) QuantErr: 12.54343 batch_time=0.41464 
Train Epoch: 24 [766/1000 24512/32000 (77%)] Loss: 0.34955 (QuantReg: 12.83483) QuantErr: 12.83483 batch_time=0.38269 
Train Epoch: 24 [771/1000 24672/32000 (77%)] Loss: 0.49147 (QuantReg: 12.77665) QuantErr: 12.77665 batch_time=0.43407 
Train Epoch: 24 [776/1000 24832/32000 (78%)] Loss: 0.38563 (QuantReg: 13.21637) QuantErr: 13.21637 batch_time=0.38754 
Train Epoch: 24 [781/1000 24992/32000 (78%)] Loss: 0.35890 (QuantReg: 12.49761) QuantErr: 12.49761 batch_time=0.36257 
Train Epoch: 24 [786/1000 25152/32000 (79%)] Loss: 0.36368 (QuantReg: 12.22717) QuantErr: 12.22717 batch_time=0.36555 
Train Epoch: 24 [791/1000 25312/32000 (79%)] Loss: 0.23967 (QuantReg: 12.93143) QuantErr: 12.93143 batch_time=0.39872 
Train Epoch: 24 [796/1000 25472/32000 (80%)] Loss: 0.69073 (QuantReg: 12.50997) QuantErr: 12.50997 batch_time=0.44963 
Train Epoch: 24 [801/1000 25632/32000 (80%)] Loss: 0.62361 (QuantReg: 12.88895) QuantErr: 12.88895 batch_time=0.46754 
Train Epoch: 24 [806/1000 25792/32000 (81%)] Loss: 0.53584 (QuantReg: 12.41283) QuantErr: 12.41283 batch_time=0.47456 
Train Epoch: 24 [811/1000 25952/32000 (81%)] Loss: 0.43343 (QuantReg: 12.90411) QuantErr: 12.90411 batch_time=0.51870 
Train Epoch: 24 [816/1000 26112/32000 (82%)] Loss: 0.20976 (QuantReg: 12.96484) QuantErr: 12.96484 batch_time=0.41202 
Train Epoch: 24 [821/1000 26272/32000 (82%)] Loss: 0.14453 (QuantReg: 13.11666) QuantErr: 13.11666 batch_time=0.41245 
Train Epoch: 24 [826/1000 26432/32000 (83%)] Loss: 0.30473 (QuantReg: 12.93989) QuantErr: 12.93989 batch_time=0.36232 
Train Epoch: 24 [831/1000 26592/32000 (83%)] Loss: 0.48493 (QuantReg: 12.70331) QuantErr: 12.70331 batch_time=0.37526 
Train Epoch: 24 [836/1000 26752/32000 (84%)] Loss: 0.51461 (QuantReg: 12.00956) QuantErr: 12.00956 batch_time=2.95613 
Train Epoch: 24 [841/1000 26912/32000 (84%)] Loss: 0.26917 (QuantReg: 12.93860) QuantErr: 12.93860 batch_time=0.43018 
Train Epoch: 24 [846/1000 27072/32000 (85%)] Loss: 0.69268 (QuantReg: 12.91712) QuantErr: 12.91712 batch_time=0.40089 
Train Epoch: 24 [851/1000 27232/32000 (85%)] Loss: 0.25548 (QuantReg: 12.83945) QuantErr: 12.83945 batch_time=0.85356 
Train Epoch: 24 [856/1000 27392/32000 (86%)] Loss: 0.27004 (QuantReg: 12.43735) QuantErr: 12.43735 batch_time=0.36148 
Train Epoch: 24 [861/1000 27552/32000 (86%)] Loss: 0.70713 (QuantReg: 12.15961) QuantErr: 12.15961 batch_time=0.46981 
Train Epoch: 24 [866/1000 27712/32000 (87%)] Loss: 0.42519 (QuantReg: 13.12348) QuantErr: 13.12348 batch_time=0.39978 
Train Epoch: 24 [871/1000 27872/32000 (87%)] Loss: 0.50178 (QuantReg: 12.84842) QuantErr: 12.84842 batch_time=0.35807 
Train Epoch: 24 [876/1000 28032/32000 (88%)] Loss: 0.35370 (QuantReg: 13.00781) QuantErr: 13.00781 batch_time=0.37358 
Train Epoch: 24 [881/1000 28192/32000 (88%)] Loss: 0.68886 (QuantReg: 11.83612) QuantErr: 11.83612 batch_time=0.38232 
Train Epoch: 24 [886/1000 28352/32000 (89%)] Loss: 0.40499 (QuantReg: 12.46490) QuantErr: 12.46490 batch_time=0.40101 
Train Epoch: 24 [891/1000 28512/32000 (89%)] Loss: 0.31533 (QuantReg: 12.78938) QuantErr: 12.78938 batch_time=0.52870 
Train Epoch: 24 [896/1000 28672/32000 (90%)] Loss: 0.72348 (QuantReg: 12.38611) QuantErr: 12.38611 batch_time=0.35331 
Train Epoch: 24 [901/1000 28832/32000 (90%)] Loss: 0.18055 (QuantReg: 13.09490) QuantErr: 13.09490 batch_time=0.42383 
Train Epoch: 24 [906/1000 28992/32000 (91%)] Loss: 0.61731 (QuantReg: 12.44852) QuantErr: 12.44852 batch_time=0.53981 
Train Epoch: 24 [911/1000 29152/32000 (91%)] Loss: 0.25638 (QuantReg: 12.70237) QuantErr: 12.70237 batch_time=0.34889 
Train Epoch: 24 [916/1000 29312/32000 (92%)] Loss: 0.27570 (QuantReg: 12.64126) QuantErr: 12.64126 batch_time=0.37749 
Train Epoch: 24 [921/1000 29472/32000 (92%)] Loss: 0.20548 (QuantReg: 12.93770) QuantErr: 12.93770 batch_time=0.38315 
Train Epoch: 24 [926/1000 29632/32000 (93%)] Loss: 0.49019 (QuantReg: 12.51439) QuantErr: 12.51439 batch_time=0.44276 
Train Epoch: 24 [931/1000 29792/32000 (93%)] Loss: 0.15938 (QuantReg: 12.18621) QuantErr: 12.18621 batch_time=0.42633 
Train Epoch: 24 [936/1000 29952/32000 (94%)] Loss: 0.47344 (QuantReg: 12.44715) QuantErr: 12.44715 batch_time=0.45149 
Train Epoch: 24 [941/1000 30112/32000 (94%)] Loss: 0.17633 (QuantReg: 12.84512) QuantErr: 12.84512 batch_time=0.80637 
Train Epoch: 24 [946/1000 30272/32000 (95%)] Loss: 0.64333 (QuantReg: 11.42647) QuantErr: 11.42647 batch_time=0.50512 
Train Epoch: 24 [951/1000 30432/32000 (95%)] Loss: 0.25165 (QuantReg: 13.21928) QuantErr: 13.21928 batch_time=0.37497 
Train Epoch: 24 [956/1000 30592/32000 (96%)] Loss: 0.33823 (QuantReg: 13.20837) QuantErr: 13.20837 batch_time=0.40687 
Train Epoch: 24 [961/1000 30752/32000 (96%)] Loss: 0.22497 (QuantReg: 13.14781) QuantErr: 13.14781 batch_time=0.37922 
Train Epoch: 24 [966/1000 30912/32000 (97%)] Loss: 0.17691 (QuantReg: 12.75667) QuantErr: 12.75667 batch_time=0.52752 
Train Epoch: 24 [971/1000 31072/32000 (97%)] Loss: 0.49233 (QuantReg: 13.50212) QuantErr: 13.50212 batch_time=0.37654 
Train Epoch: 24 [976/1000 31232/32000 (98%)] Loss: 0.40268 (QuantReg: 12.68117) QuantErr: 12.68117 batch_time=0.40184 
Train Epoch: 24 [981/1000 31392/32000 (98%)] Loss: 0.34195 (QuantReg: 13.00836) QuantErr: 13.00836 batch_time=0.42056 
Train Epoch: 24 [986/1000 31552/32000 (99%)] Loss: 0.62255 (QuantReg: 11.94603) QuantErr: 11.94603 batch_time=0.37624 
Train Epoch: 24 [991/1000 31712/32000 (99%)] Loss: 0.29324 (QuantReg: 12.72164) QuantErr: 12.72164 batch_time=0.39113 
Train Epoch: 24 [996/1000 31872/32000 (100%)] Loss: 0.36565 (QuantReg: 12.37088) QuantErr: 12.37088 batch_time=0.50906 
Train Epoch: 24 codebook_update_time=1.82756
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch24.pth ...
Done in 13.606s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 0.4216956590265036
 quant_reg      : 12.716325114250184
 quant_err      : 12.716325114250184
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 24000
 MSRVTT_miech_test/t2v_metrics/R1: 18.9
 MSRVTT_miech_test/t2v_metrics/R5: 46.5
 MSRVTT_miech_test/t2v_metrics/R10: 60.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.821
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.6651278075814
 MSRVTT_miech_test/v2t_metrics/R1: 18.0
 MSRVTT_miech_test/v2t_metrics/R5: 48.9
 MSRVTT_miech_test/v2t_metrics/R10: 63.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.0595
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.21409163687832
 mnt_best       : 38.45489562444897
 not_improved_count: 4
Train Epoch: 25 [1/1000 32/32000 (0%)] Loss: 0.52713 (QuantReg: 12.81115) QuantErr: 12.81115 batch_time=30.99495 
Train Epoch: 25 [6/1000 192/32000 (1%)] Loss: 0.52143 (QuantReg: 12.64362) QuantErr: 12.64362 batch_time=0.41299 
Train Epoch: 25 [11/1000 352/32000 (1%)] Loss: 0.27671 (QuantReg: 12.87325) QuantErr: 12.87325 batch_time=0.37680 
Train Epoch: 25 [16/1000 512/32000 (2%)] Loss: 0.11571 (QuantReg: 12.82963) QuantErr: 12.82963 batch_time=1.10030 
Train Epoch: 25 [21/1000 672/32000 (2%)] Loss: 0.59187 (QuantReg: 12.79727) QuantErr: 12.79727 batch_time=0.44904 
Train Epoch: 25 [26/1000 832/32000 (3%)] Loss: 0.51978 (QuantReg: 13.12311) QuantErr: 13.12311 batch_time=0.37575 
Train Epoch: 25 [31/1000 992/32000 (3%)] Loss: 0.21824 (QuantReg: 13.38616) QuantErr: 13.38616 batch_time=0.35458 
Train Epoch: 25 [36/1000 1152/32000 (4%)] Loss: 0.48776 (QuantReg: 12.32170) QuantErr: 12.32170 batch_time=0.39704 
Train Epoch: 25 [41/1000 1312/32000 (4%)] Loss: 0.31109 (QuantReg: 11.90576) QuantErr: 11.90576 batch_time=0.36322 
Train Epoch: 25 [46/1000 1472/32000 (5%)] Loss: 0.50214 (QuantReg: 11.70263) QuantErr: 11.70263 batch_time=0.71732 
Train Epoch: 25 [51/1000 1632/32000 (5%)] Loss: 0.53838 (QuantReg: 12.77687) QuantErr: 12.77687 batch_time=0.42851 
Train Epoch: 25 [56/1000 1792/32000 (6%)] Loss: 0.61788 (QuantReg: 12.38901) QuantErr: 12.38901 batch_time=0.35970 
Train Epoch: 25 [61/1000 1952/32000 (6%)] Loss: 0.59906 (QuantReg: 12.84840) QuantErr: 12.84840 batch_time=0.35772 
Train Epoch: 25 [66/1000 2112/32000 (7%)] Loss: 0.26392 (QuantReg: 12.65561) QuantErr: 12.65561 batch_time=0.70680 
Train Epoch: 25 [71/1000 2272/32000 (7%)] Loss: 0.25625 (QuantReg: 12.94134) QuantErr: 12.94134 batch_time=0.37591 
Train Epoch: 25 [76/1000 2432/32000 (8%)] Loss: 0.63180 (QuantReg: 13.08649) QuantErr: 13.08649 batch_time=0.42716 
Train Epoch: 25 [81/1000 2592/32000 (8%)] Loss: 0.38963 (QuantReg: 12.76712) QuantErr: 12.76712 batch_time=0.38047 
Train Epoch: 25 [86/1000 2752/32000 (9%)] Loss: 0.29589 (QuantReg: 12.67963) QuantErr: 12.67963 batch_time=1.21576 
Train Epoch: 25 [91/1000 2912/32000 (9%)] Loss: 0.33154 (QuantReg: 12.54951) QuantErr: 12.54951 batch_time=0.83665 
Train Epoch: 25 [96/1000 3072/32000 (10%)] Loss: 0.31862 (QuantReg: 12.68308) QuantErr: 12.68308 batch_time=0.36038 
Train Epoch: 25 [101/1000 3232/32000 (10%)] Loss: 0.51751 (QuantReg: 12.48436) QuantErr: 12.48436 batch_time=0.42010 
Train Epoch: 25 [106/1000 3392/32000 (11%)] Loss: 0.33575 (QuantReg: 12.98959) QuantErr: 12.98959 batch_time=0.40672 
Train Epoch: 25 [111/1000 3552/32000 (11%)] Loss: 0.80703 (QuantReg: 11.84564) QuantErr: 11.84564 batch_time=0.52876 
Train Epoch: 25 [116/1000 3712/32000 (12%)] Loss: 0.27473 (QuantReg: 13.16962) QuantErr: 13.16962 batch_time=0.36124 
Train Epoch: 25 [121/1000 3872/32000 (12%)] Loss: 0.38987 (QuantReg: 12.10100) QuantErr: 12.10100 batch_time=0.39239 
Train Epoch: 25 [126/1000 4032/32000 (13%)] Loss: 0.16805 (QuantReg: 13.33669) QuantErr: 13.33669 batch_time=0.46523 
Train Epoch: 25 [131/1000 4192/32000 (13%)] Loss: 0.46068 (QuantReg: 11.83963) QuantErr: 11.83963 batch_time=0.43254 
Train Epoch: 25 [136/1000 4352/32000 (14%)] Loss: 0.46638 (QuantReg: 12.56028) QuantErr: 12.56028 batch_time=0.81508 
Train Epoch: 25 [141/1000 4512/32000 (14%)] Loss: 0.68311 (QuantReg: 12.88958) QuantErr: 12.88958 batch_time=0.43529 
Train Epoch: 25 [146/1000 4672/32000 (15%)] Loss: 0.48533 (QuantReg: 12.25250) QuantErr: 12.25250 batch_time=0.36906 
Train Epoch: 25 [151/1000 4832/32000 (15%)] Loss: 0.72348 (QuantReg: 12.89670) QuantErr: 12.89670 batch_time=0.41800 
Train Epoch: 25 [156/1000 4992/32000 (16%)] Loss: 0.45791 (QuantReg: 12.80662) QuantErr: 12.80662 batch_time=0.36299 
Train Epoch: 25 [161/1000 5152/32000 (16%)] Loss: 0.45931 (QuantReg: 12.59626) QuantErr: 12.59626 batch_time=0.69636 
Train Epoch: 25 [166/1000 5312/32000 (17%)] Loss: 0.48296 (QuantReg: 12.24722) QuantErr: 12.24722 batch_time=0.38356 
Train Epoch: 25 [171/1000 5472/32000 (17%)] Loss: 0.47796 (QuantReg: 12.43186) QuantErr: 12.43186 batch_time=0.35228 
Train Epoch: 25 [176/1000 5632/32000 (18%)] Loss: 0.28420 (QuantReg: 12.58443) QuantErr: 12.58443 batch_time=0.52317 
Train Epoch: 25 [181/1000 5792/32000 (18%)] Loss: 0.26627 (QuantReg: 12.75186) QuantErr: 12.75186 batch_time=0.35607 
Train Epoch: 25 [186/1000 5952/32000 (19%)] Loss: 0.22456 (QuantReg: 12.57935) QuantErr: 12.57935 batch_time=0.42868 
Train Epoch: 25 [191/1000 6112/32000 (19%)] Loss: 0.55090 (QuantReg: 12.52808) QuantErr: 12.52808 batch_time=0.38942 
Train Epoch: 25 [196/1000 6272/32000 (20%)] Loss: 0.30284 (QuantReg: 13.06418) QuantErr: 13.06418 batch_time=0.54363 
Train Epoch: 25 [201/1000 6432/32000 (20%)] Loss: 0.36956 (QuantReg: 12.90426) QuantErr: 12.90426 batch_time=0.41146 
Train Epoch: 25 [206/1000 6592/32000 (21%)] Loss: 0.43796 (QuantReg: 12.18433) QuantErr: 12.18433 batch_time=0.37494 
Train Epoch: 25 [211/1000 6752/32000 (21%)] Loss: 0.38592 (QuantReg: 13.13371) QuantErr: 13.13371 batch_time=0.39142 
Train Epoch: 25 [216/1000 6912/32000 (22%)] Loss: 0.47658 (QuantReg: 13.12304) QuantErr: 13.12304 batch_time=2.99101 
Train Epoch: 25 [221/1000 7072/32000 (22%)] Loss: 0.29495 (QuantReg: 12.44359) QuantErr: 12.44359 batch_time=0.33794 
Train Epoch: 25 [226/1000 7232/32000 (23%)] Loss: 0.55686 (QuantReg: 12.49856) QuantErr: 12.49856 batch_time=0.84810 
Train Epoch: 25 [231/1000 7392/32000 (23%)] Loss: 0.51869 (QuantReg: 12.49510) QuantErr: 12.49510 batch_time=0.42029 
Train Epoch: 25 [236/1000 7552/32000 (24%)] Loss: 0.55568 (QuantReg: 12.14104) QuantErr: 12.14104 batch_time=0.40761 
Train Epoch: 25 [241/1000 7712/32000 (24%)] Loss: 0.36305 (QuantReg: 12.65019) QuantErr: 12.65019 batch_time=0.35128 
Train Epoch: 25 [246/1000 7872/32000 (25%)] Loss: 0.65083 (QuantReg: 11.86042) QuantErr: 11.86042 batch_time=0.36140 
Train Epoch: 25 [251/1000 8032/32000 (25%)] Loss: 0.65597 (QuantReg: 13.41147) QuantErr: 13.41147 batch_time=0.45102 
Train Epoch: 25 [256/1000 8192/32000 (26%)] Loss: 0.45123 (QuantReg: 12.65811) QuantErr: 12.65811 batch_time=0.36563 
Train Epoch: 25 [261/1000 8352/32000 (26%)] Loss: 0.39712 (QuantReg: 12.82140) QuantErr: 12.82140 batch_time=0.37804 
Train Epoch: 25 [266/1000 8512/32000 (27%)] Loss: 0.54322 (QuantReg: 12.61692) QuantErr: 12.61692 batch_time=0.38593 
Train Epoch: 25 [271/1000 8672/32000 (27%)] Loss: 0.43960 (QuantReg: 12.28386) QuantErr: 12.28386 batch_time=0.34018 
Train Epoch: 25 [276/1000 8832/32000 (28%)] Loss: 0.50725 (QuantReg: 12.85711) QuantErr: 12.85711 batch_time=0.49434 
Train Epoch: 25 [281/1000 8992/32000 (28%)] Loss: 0.37515 (QuantReg: 13.35496) QuantErr: 13.35496 batch_time=0.41934 
Train Epoch: 25 [286/1000 9152/32000 (29%)] Loss: 0.19017 (QuantReg: 13.01712) QuantErr: 13.01712 batch_time=0.38066 
Train Epoch: 25 [291/1000 9312/32000 (29%)] Loss: 0.54817 (QuantReg: 12.06674) QuantErr: 12.06674 batch_time=0.45454 
Train Epoch: 25 [296/1000 9472/32000 (30%)] Loss: 0.29818 (QuantReg: 12.81774) QuantErr: 12.81774 batch_time=0.46109 
Train Epoch: 25 [301/1000 9632/32000 (30%)] Loss: 0.21161 (QuantReg: 13.16819) QuantErr: 13.16819 batch_time=0.35803 
Train Epoch: 25 [306/1000 9792/32000 (31%)] Loss: 0.30944 (QuantReg: 12.01605) QuantErr: 12.01605 batch_time=0.45921 
Train Epoch: 25 [311/1000 9952/32000 (31%)] Loss: 0.38873 (QuantReg: 13.02148) QuantErr: 13.02148 batch_time=0.39049 
Train Epoch: 25 [316/1000 10112/32000 (32%)] Loss: 0.78576 (QuantReg: 13.15948) QuantErr: 13.15948 batch_time=0.35878 
Train Epoch: 25 [321/1000 10272/32000 (32%)] Loss: 0.31075 (QuantReg: 12.92736) QuantErr: 12.92736 batch_time=0.38429 
Train Epoch: 25 [326/1000 10432/32000 (33%)] Loss: 0.59610 (QuantReg: 12.86650) QuantErr: 12.86650 batch_time=0.39727 
Train Epoch: 25 [331/1000 10592/32000 (33%)] Loss: 0.37666 (QuantReg: 12.76493) QuantErr: 12.76493 batch_time=0.40968 
Train Epoch: 25 [336/1000 10752/32000 (34%)] Loss: 0.76991 (QuantReg: 12.84650) QuantErr: 12.84650 batch_time=0.38532 
Train Epoch: 25 [341/1000 10912/32000 (34%)] Loss: 0.48556 (QuantReg: 12.50654) QuantErr: 12.50654 batch_time=0.37502 
Train Epoch: 25 [346/1000 11072/32000 (35%)] Loss: 0.32326 (QuantReg: 12.74201) QuantErr: 12.74201 batch_time=0.36800 
Train Epoch: 25 [351/1000 11232/32000 (35%)] Loss: 0.31122 (QuantReg: 12.97553) QuantErr: 12.97553 batch_time=0.36856 
Train Epoch: 25 [356/1000 11392/32000 (36%)] Loss: 0.45326 (QuantReg: 12.62764) QuantErr: 12.62764 batch_time=0.35382 
Train Epoch: 25 [361/1000 11552/32000 (36%)] Loss: 0.29882 (QuantReg: 12.73503) QuantErr: 12.73503 batch_time=0.36471 
Train Epoch: 25 [366/1000 11712/32000 (37%)] Loss: 0.76959 (QuantReg: 12.71390) QuantErr: 12.71390 batch_time=0.60911 
Train Epoch: 25 [371/1000 11872/32000 (37%)] Loss: 0.56885 (QuantReg: 12.67904) QuantErr: 12.67904 batch_time=0.49043 
Train Epoch: 25 [376/1000 12032/32000 (38%)] Loss: 0.25285 (QuantReg: 13.21656) QuantErr: 13.21656 batch_time=0.36500 
Train Epoch: 25 [381/1000 12192/32000 (38%)] Loss: 0.36593 (QuantReg: 12.37933) QuantErr: 12.37933 batch_time=0.49451 
Train Epoch: 25 [386/1000 12352/32000 (39%)] Loss: 0.34315 (QuantReg: 12.84852) QuantErr: 12.84852 batch_time=0.36733 
Train Epoch: 25 [391/1000 12512/32000 (39%)] Loss: 0.30924 (QuantReg: 12.95519) QuantErr: 12.95519 batch_time=0.36679 
Train Epoch: 25 [396/1000 12672/32000 (40%)] Loss: 0.36576 (QuantReg: 13.05985) QuantErr: 13.05985 batch_time=0.46468 
Train Epoch: 25 [401/1000 12832/32000 (40%)] Loss: 0.30408 (QuantReg: 12.76030) QuantErr: 12.76030 batch_time=0.39555 
Train Epoch: 25 [406/1000 12992/32000 (41%)] Loss: 0.31289 (QuantReg: 12.20366) QuantErr: 12.20366 batch_time=0.36175 
Train Epoch: 25 [411/1000 13152/32000 (41%)] Loss: 0.89313 (QuantReg: 12.42509) QuantErr: 12.42509 batch_time=0.74288 
Train Epoch: 25 [416/1000 13312/32000 (42%)] Loss: 0.92215 (QuantReg: 13.13856) QuantErr: 13.13856 batch_time=0.60075 
Train Epoch: 25 [421/1000 13472/32000 (42%)] Loss: 0.40064 (QuantReg: 12.96027) QuantErr: 12.96027 batch_time=0.43886 
Train Epoch: 25 [426/1000 13632/32000 (43%)] Loss: 0.45712 (QuantReg: 13.17857) QuantErr: 13.17857 batch_time=0.43713 
Train Epoch: 25 [431/1000 13792/32000 (43%)] Loss: 0.30918 (QuantReg: 12.66773) QuantErr: 12.66773 batch_time=0.36822 
Train Epoch: 25 [436/1000 13952/32000 (44%)] Loss: 0.33744 (QuantReg: 12.48267) QuantErr: 12.48267 batch_time=0.36636 
Train Epoch: 25 [441/1000 14112/32000 (44%)] Loss: 0.28703 (QuantReg: 12.63482) QuantErr: 12.63482 batch_time=0.35146 
Train Epoch: 25 [446/1000 14272/32000 (45%)] Loss: 0.38437 (QuantReg: 12.93923) QuantErr: 12.93923 batch_time=0.36009 
Train Epoch: 25 [451/1000 14432/32000 (45%)] Loss: 0.33609 (QuantReg: 13.17523) QuantErr: 13.17523 batch_time=0.35694 
Train Epoch: 25 [456/1000 14592/32000 (46%)] Loss: 0.32108 (QuantReg: 12.27594) QuantErr: 12.27594 batch_time=0.44580 
Train Epoch: 25 [461/1000 14752/32000 (46%)] Loss: 0.30474 (QuantReg: 13.07948) QuantErr: 13.07948 batch_time=0.35668 
Train Epoch: 25 [466/1000 14912/32000 (47%)] Loss: 0.38170 (QuantReg: 13.14380) QuantErr: 13.14380 batch_time=0.66277 
Train Epoch: 25 [471/1000 15072/32000 (47%)] Loss: 0.39902 (QuantReg: 13.16494) QuantErr: 13.16494 batch_time=0.34170 
Train Epoch: 25 [476/1000 15232/32000 (48%)] Loss: 0.26488 (QuantReg: 12.90763) QuantErr: 12.90763 batch_time=0.36659 
Train Epoch: 25 [481/1000 15392/32000 (48%)] Loss: 0.55603 (QuantReg: 12.20529) QuantErr: 12.20529 batch_time=0.36083 
Train Epoch: 25 [486/1000 15552/32000 (49%)] Loss: 0.44858 (QuantReg: 12.68860) QuantErr: 12.68860 batch_time=0.39260 
Train Epoch: 25 [491/1000 15712/32000 (49%)] Loss: 0.12806 (QuantReg: 12.71313) QuantErr: 12.71313 batch_time=0.41033 
Train Epoch: 25 [496/1000 15872/32000 (50%)] Loss: 0.33587 (QuantReg: 13.06823) QuantErr: 13.06823 batch_time=0.47236 
Train Epoch: 25 [501/1000 16032/32000 (50%)] Loss: 0.17408 (QuantReg: 12.81128) QuantErr: 12.81128 batch_time=0.40767 
Train Epoch: 25 [506/1000 16192/32000 (51%)] Loss: 0.26767 (QuantReg: 12.55165) QuantErr: 12.55165 batch_time=0.35716 
Train Epoch: 25 [511/1000 16352/32000 (51%)] Loss: 0.26397 (QuantReg: 13.38627) QuantErr: 13.38627 batch_time=0.73698 
Train Epoch: 25 [516/1000 16512/32000 (52%)] Loss: 0.31196 (QuantReg: 12.92930) QuantErr: 12.92930 batch_time=0.43142 
Train Epoch: 25 [521/1000 16672/32000 (52%)] Loss: 0.23907 (QuantReg: 13.60083) QuantErr: 13.60083 batch_time=0.35186 
Train Epoch: 25 [526/1000 16832/32000 (53%)] Loss: 0.27156 (QuantReg: 12.67667) QuantErr: 12.67667 batch_time=0.37398 
Train Epoch: 25 [531/1000 16992/32000 (53%)] Loss: 0.26073 (QuantReg: 13.00202) QuantErr: 13.00202 batch_time=2.01426 
Train Epoch: 25 [536/1000 17152/32000 (54%)] Loss: 0.20814 (QuantReg: 13.44607) QuantErr: 13.44607 batch_time=0.61544 
Train Epoch: 25 [541/1000 17312/32000 (54%)] Loss: 0.51156 (QuantReg: 12.78477) QuantErr: 12.78477 batch_time=0.44048 
Train Epoch: 25 [546/1000 17472/32000 (55%)] Loss: 0.40625 (QuantReg: 13.12494) QuantErr: 13.12494 batch_time=1.06641 
Train Epoch: 25 [551/1000 17632/32000 (55%)] Loss: 0.55053 (QuantReg: 12.40501) QuantErr: 12.40501 batch_time=0.38964 
Train Epoch: 25 [556/1000 17792/32000 (56%)] Loss: 0.95336 (QuantReg: 13.49776) QuantErr: 13.49776 batch_time=0.79023 
Train Epoch: 25 [561/1000 17952/32000 (56%)] Loss: 0.62002 (QuantReg: 13.25998) QuantErr: 13.25998 batch_time=0.42199 
Train Epoch: 25 [566/1000 18112/32000 (57%)] Loss: 0.48276 (QuantReg: 13.06295) QuantErr: 13.06295 batch_time=0.43054 
Train Epoch: 25 [571/1000 18272/32000 (57%)] Loss: 0.52434 (QuantReg: 12.99953) QuantErr: 12.99953 batch_time=0.42287 
Train Epoch: 25 [576/1000 18432/32000 (58%)] Loss: 0.68493 (QuantReg: 13.02674) QuantErr: 13.02674 batch_time=0.36828 
Train Epoch: 25 [581/1000 18592/32000 (58%)] Loss: 0.58434 (QuantReg: 12.80255) QuantErr: 12.80255 batch_time=0.38930 
Train Epoch: 25 [586/1000 18752/32000 (59%)] Loss: 0.44055 (QuantReg: 12.93080) QuantErr: 12.93080 batch_time=0.42438 
Train Epoch: 25 [591/1000 18912/32000 (59%)] Loss: 0.54087 (QuantReg: 12.00338) QuantErr: 12.00338 batch_time=0.40013 
Train Epoch: 25 [596/1000 19072/32000 (60%)] Loss: 0.82030 (QuantReg: 12.58819) QuantErr: 12.58819 batch_time=0.48074 
Train Epoch: 25 [601/1000 19232/32000 (60%)] Loss: 0.64507 (QuantReg: 12.94435) QuantErr: 12.94435 batch_time=0.35374 
Train Epoch: 25 [606/1000 19392/32000 (61%)] Loss: 0.53310 (QuantReg: 12.16500) QuantErr: 12.16500 batch_time=0.70333 
Train Epoch: 25 [611/1000 19552/32000 (61%)] Loss: 1.27756 (QuantReg: 11.82263) QuantErr: 11.82263 batch_time=0.48552 
Train Epoch: 25 [616/1000 19712/32000 (62%)] Loss: 0.61481 (QuantReg: 11.99147) QuantErr: 11.99147 batch_time=0.63760 
Train Epoch: 25 [621/1000 19872/32000 (62%)] Loss: 0.34517 (QuantReg: 12.67200) QuantErr: 12.67200 batch_time=0.35948 
Train Epoch: 25 [626/1000 20032/32000 (63%)] Loss: 0.54922 (QuantReg: 12.89581) QuantErr: 12.89581 batch_time=0.38288 
Train Epoch: 25 [631/1000 20192/32000 (63%)] Loss: 0.43507 (QuantReg: 12.85584) QuantErr: 12.85584 batch_time=0.40183 
Train Epoch: 25 [636/1000 20352/32000 (64%)] Loss: 0.22782 (QuantReg: 12.97139) QuantErr: 12.97139 batch_time=0.42201 
Train Epoch: 25 [641/1000 20512/32000 (64%)] Loss: 0.44329 (QuantReg: 12.94047) QuantErr: 12.94047 batch_time=0.39895 
Train Epoch: 25 [646/1000 20672/32000 (65%)] Loss: 0.32409 (QuantReg: 12.69512) QuantErr: 12.69512 batch_time=0.38080 
Train Epoch: 25 [651/1000 20832/32000 (65%)] Loss: 0.36951 (QuantReg: 13.16775) QuantErr: 13.16775 batch_time=0.37017 
Train Epoch: 25 [656/1000 20992/32000 (66%)] Loss: 0.46081 (QuantReg: 12.49178) QuantErr: 12.49178 batch_time=0.69357 
Train Epoch: 25 [661/1000 21152/32000 (66%)] Loss: 0.38471 (QuantReg: 12.83482) QuantErr: 12.83482 batch_time=0.38878 
Train Epoch: 25 [666/1000 21312/32000 (67%)] Loss: 0.27775 (QuantReg: 13.13942) QuantErr: 13.13942 batch_time=0.51001 
Train Epoch: 25 [671/1000 21472/32000 (67%)] Loss: 0.40426 (QuantReg: 13.08790) QuantErr: 13.08790 batch_time=0.35687 
Train Epoch: 25 [676/1000 21632/32000 (68%)] Loss: 0.39248 (QuantReg: 12.52894) QuantErr: 12.52894 batch_time=0.36228 
Train Epoch: 25 [681/1000 21792/32000 (68%)] Loss: 0.46864 (QuantReg: 13.08388) QuantErr: 13.08388 batch_time=0.37428 
Train Epoch: 25 [686/1000 21952/32000 (69%)] Loss: 0.57873 (QuantReg: 12.88587) QuantErr: 12.88587 batch_time=0.39850 
Train Epoch: 25 [691/1000 22112/32000 (69%)] Loss: 0.58850 (QuantReg: 12.91857) QuantErr: 12.91857 batch_time=0.35852 
Train Epoch: 25 [696/1000 22272/32000 (70%)] Loss: 0.56056 (QuantReg: 12.74047) QuantErr: 12.74047 batch_time=0.89544 
Train Epoch: 25 [701/1000 22432/32000 (70%)] Loss: 0.44377 (QuantReg: 12.61648) QuantErr: 12.61648 batch_time=0.55603 
Train Epoch: 25 [706/1000 22592/32000 (71%)] Loss: 0.66668 (QuantReg: 12.12022) QuantErr: 12.12022 batch_time=0.38775 
Train Epoch: 25 [711/1000 22752/32000 (71%)] Loss: 0.45510 (QuantReg: 13.03934) QuantErr: 13.03934 batch_time=0.35037 
Train Epoch: 25 [716/1000 22912/32000 (72%)] Loss: 0.44828 (QuantReg: 12.67055) QuantErr: 12.67055 batch_time=0.38124 
Train Epoch: 25 [721/1000 23072/32000 (72%)] Loss: 0.35890 (QuantReg: 12.40265) QuantErr: 12.40265 batch_time=0.34705 
Train Epoch: 25 [726/1000 23232/32000 (73%)] Loss: 0.27357 (QuantReg: 13.01033) QuantErr: 13.01033 batch_time=0.43499 
Train Epoch: 25 [731/1000 23392/32000 (73%)] Loss: 0.22092 (QuantReg: 12.75455) QuantErr: 12.75455 batch_time=0.36140 
Train Epoch: 25 [736/1000 23552/32000 (74%)] Loss: 0.29659 (QuantReg: 12.79333) QuantErr: 12.79333 batch_time=0.40324 
Train Epoch: 25 [741/1000 23712/32000 (74%)] Loss: 0.19690 (QuantReg: 12.99119) QuantErr: 12.99119 batch_time=0.39644 
Train Epoch: 25 [746/1000 23872/32000 (75%)] Loss: 0.22592 (QuantReg: 12.06093) QuantErr: 12.06093 batch_time=0.34231 
Train Epoch: 25 [751/1000 24032/32000 (75%)] Loss: 0.33018 (QuantReg: 12.59329) QuantErr: 12.59329 batch_time=0.83701 
Train Epoch: 25 [756/1000 24192/32000 (76%)] Loss: 0.19604 (QuantReg: 13.03925) QuantErr: 13.03925 batch_time=0.37159 
Train Epoch: 25 [761/1000 24352/32000 (76%)] Loss: 0.22937 (QuantReg: 13.41770) QuantErr: 13.41770 batch_time=0.47395 
Train Epoch: 25 [766/1000 24512/32000 (77%)] Loss: 0.35689 (QuantReg: 12.75818) QuantErr: 12.75818 batch_time=0.35394 
Train Epoch: 25 [771/1000 24672/32000 (77%)] Loss: 0.41383 (QuantReg: 12.14798) QuantErr: 12.14798 batch_time=0.37480 
Train Epoch: 25 [776/1000 24832/32000 (78%)] Loss: 0.43322 (QuantReg: 13.24184) QuantErr: 13.24184 batch_time=0.48091 
Train Epoch: 25 [781/1000 24992/32000 (78%)] Loss: 0.50582 (QuantReg: 12.63920) QuantErr: 12.63920 batch_time=0.36000 
Train Epoch: 25 [786/1000 25152/32000 (79%)] Loss: 0.21395 (QuantReg: 13.05442) QuantErr: 13.05442 batch_time=0.41266 
Train Epoch: 25 [791/1000 25312/32000 (79%)] Loss: 0.29209 (QuantReg: 13.13874) QuantErr: 13.13874 batch_time=0.37743 
Train Epoch: 25 [796/1000 25472/32000 (80%)] Loss: 0.62659 (QuantReg: 12.38451) QuantErr: 12.38451 batch_time=0.61435 
Train Epoch: 25 [801/1000 25632/32000 (80%)] Loss: 0.55751 (QuantReg: 12.77065) QuantErr: 12.77065 batch_time=0.45154 
Train Epoch: 25 [806/1000 25792/32000 (81%)] Loss: 0.28111 (QuantReg: 13.08563) QuantErr: 13.08563 batch_time=0.58280 
Train Epoch: 25 [811/1000 25952/32000 (81%)] Loss: 0.28205 (QuantReg: 12.64054) QuantErr: 12.64054 batch_time=0.42043 
Train Epoch: 25 [816/1000 26112/32000 (82%)] Loss: 0.27492 (QuantReg: 12.20347) QuantErr: 12.20347 batch_time=0.43136 
Train Epoch: 25 [821/1000 26272/32000 (82%)] Loss: 0.56369 (QuantReg: 12.37594) QuantErr: 12.37594 batch_time=0.49127 
Train Epoch: 25 [826/1000 26432/32000 (83%)] Loss: 0.62601 (QuantReg: 12.59893) QuantErr: 12.59893 batch_time=0.41994 
Train Epoch: 25 [831/1000 26592/32000 (83%)] Loss: 0.23143 (QuantReg: 12.26530) QuantErr: 12.26530 batch_time=0.37704 
Train Epoch: 25 [836/1000 26752/32000 (84%)] Loss: 0.76892 (QuantReg: 13.27691) QuantErr: 13.27691 batch_time=0.41330 
Train Epoch: 25 [841/1000 26912/32000 (84%)] Loss: 0.50618 (QuantReg: 13.29548) QuantErr: 13.29548 batch_time=0.44315 
Train Epoch: 25 [846/1000 27072/32000 (85%)] Loss: 0.22009 (QuantReg: 12.78642) QuantErr: 12.78642 batch_time=0.47215 
Train Epoch: 25 [851/1000 27232/32000 (85%)] Loss: 0.46840 (QuantReg: 12.03417) QuantErr: 12.03417 batch_time=1.41868 
Train Epoch: 25 [856/1000 27392/32000 (86%)] Loss: 0.55747 (QuantReg: 12.59551) QuantErr: 12.59551 batch_time=0.64370 
Train Epoch: 25 [861/1000 27552/32000 (86%)] Loss: 0.16004 (QuantReg: 13.29074) QuantErr: 13.29074 batch_time=0.37132 
Train Epoch: 25 [866/1000 27712/32000 (87%)] Loss: 0.39529 (QuantReg: 12.23278) QuantErr: 12.23278 batch_time=0.79258 
Train Epoch: 25 [871/1000 27872/32000 (87%)] Loss: 0.61432 (QuantReg: 12.75122) QuantErr: 12.75122 batch_time=0.37140 
Train Epoch: 25 [876/1000 28032/32000 (88%)] Loss: 0.58361 (QuantReg: 12.82857) QuantErr: 12.82857 batch_time=0.36487 
Train Epoch: 25 [881/1000 28192/32000 (88%)] Loss: 0.32155 (QuantReg: 12.55467) QuantErr: 12.55467 batch_time=0.39777 
Train Epoch: 25 [886/1000 28352/32000 (89%)] Loss: 0.42693 (QuantReg: 12.72012) QuantErr: 12.72012 batch_time=0.37634 
Train Epoch: 25 [891/1000 28512/32000 (89%)] Loss: 0.32044 (QuantReg: 13.03176) QuantErr: 13.03176 batch_time=0.75876 
Train Epoch: 25 [896/1000 28672/32000 (90%)] Loss: 0.33750 (QuantReg: 13.15273) QuantErr: 13.15273 batch_time=0.47827 
Train Epoch: 25 [901/1000 28832/32000 (90%)] Loss: 0.51015 (QuantReg: 11.97233) QuantErr: 11.97233 batch_time=0.38398 
Train Epoch: 25 [906/1000 28992/32000 (91%)] Loss: 0.40549 (QuantReg: 13.03726) QuantErr: 13.03726 batch_time=0.42654 
Train Epoch: 25 [911/1000 29152/32000 (91%)] Loss: 0.28815 (QuantReg: 12.67790) QuantErr: 12.67790 batch_time=0.49434 
Train Epoch: 25 [916/1000 29312/32000 (92%)] Loss: 0.50947 (QuantReg: 13.16332) QuantErr: 13.16332 batch_time=0.36762 
Train Epoch: 25 [921/1000 29472/32000 (92%)] Loss: 0.55653 (QuantReg: 12.67131) QuantErr: 12.67131 batch_time=0.44035 
Train Epoch: 25 [926/1000 29632/32000 (93%)] Loss: 0.25346 (QuantReg: 13.09412) QuantErr: 13.09412 batch_time=0.47434 
Train Epoch: 25 [931/1000 29792/32000 (93%)] Loss: 0.73019 (QuantReg: 12.70947) QuantErr: 12.70947 batch_time=0.34775 
Train Epoch: 25 [936/1000 29952/32000 (94%)] Loss: 0.45236 (QuantReg: 12.59946) QuantErr: 12.59946 batch_time=0.52028 
Train Epoch: 25 [941/1000 30112/32000 (94%)] Loss: 0.51982 (QuantReg: 13.26506) QuantErr: 13.26506 batch_time=0.43457 
Train Epoch: 25 [946/1000 30272/32000 (95%)] Loss: 0.71533 (QuantReg: 12.01930) QuantErr: 12.01930 batch_time=0.36037 
Train Epoch: 25 [951/1000 30432/32000 (95%)] Loss: 0.42279 (QuantReg: 12.98691) QuantErr: 12.98691 batch_time=0.40869 
Train Epoch: 25 [956/1000 30592/32000 (96%)] Loss: 0.41856 (QuantReg: 13.57231) QuantErr: 13.57231 batch_time=0.37115 
Train Epoch: 25 [961/1000 30752/32000 (96%)] Loss: 0.47112 (QuantReg: 12.99164) QuantErr: 12.99164 batch_time=0.42666 
Train Epoch: 25 [966/1000 30912/32000 (97%)] Loss: 0.20075 (QuantReg: 12.91631) QuantErr: 12.91631 batch_time=0.41977 
Train Epoch: 25 [971/1000 31072/32000 (97%)] Loss: 0.54811 (QuantReg: 13.16620) QuantErr: 13.16620 batch_time=0.39649 
Train Epoch: 25 [976/1000 31232/32000 (98%)] Loss: 0.27127 (QuantReg: 13.09190) QuantErr: 13.09190 batch_time=0.43521 
Train Epoch: 25 [981/1000 31392/32000 (98%)] Loss: 0.34740 (QuantReg: 13.08823) QuantErr: 13.08823 batch_time=0.75805 
Train Epoch: 25 [986/1000 31552/32000 (99%)] Loss: 0.28481 (QuantReg: 12.50275) QuantErr: 12.50275 batch_time=0.36619 
Train Epoch: 25 [991/1000 31712/32000 (99%)] Loss: 0.23054 (QuantReg: 13.69613) QuantErr: 13.69613 batch_time=0.35112 
Train Epoch: 25 [996/1000 31872/32000 (100%)] Loss: 0.40250 (QuantReg: 12.12591) QuantErr: 12.12591 batch_time=0.40177 
Train Epoch: 25 codebook_update_time=1.77926
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch25.pth ...
Done in 6.603s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch25.pth ...
Done in 11.509s
removing stale ckpt [epoch 24] [took 0.01s]
 epoch          : 25
 loss           : 0.418364538051188
 quant_reg      : 12.737565384864807
 quant_err      : 12.737565384864807
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 25000
 MSRVTT_miech_test/t2v_metrics/R1: 20.2
 MSRVTT_miech_test/t2v_metrics/R5: 48.9
 MSRVTT_miech_test/t2v_metrics/R10: 61.2
 MSRVTT_miech_test/t2v_metrics/R50: 88.4
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.934
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.24676668836643
 MSRVTT_miech_test/v2t_metrics/R1: 18.6
 MSRVTT_miech_test/v2t_metrics/R5: 49.1
 MSRVTT_miech_test/v2t_metrics/R10: 62.2
 MSRVTT_miech_test/v2t_metrics/R50: 89.2
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.546
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.44102332432901
 mnt_best       : 39.24676668836643
 not_improved_count: 0
Train Epoch: 26 [1/1000 32/32000 (0%)] Loss: 0.45435 (QuantReg: 12.48390) QuantErr: 12.48390 batch_time=30.44329 
Train Epoch: 26 [6/1000 192/32000 (1%)] Loss: 0.28095 (QuantReg: 12.83770) QuantErr: 12.83770 batch_time=0.75088 
Train Epoch: 26 [11/1000 352/32000 (1%)] Loss: 0.51251 (QuantReg: 12.50591) QuantErr: 12.50591 batch_time=0.36880 
Train Epoch: 26 [16/1000 512/32000 (2%)] Loss: 0.43727 (QuantReg: 12.69291) QuantErr: 12.69291 batch_time=0.46007 
Train Epoch: 26 [21/1000 672/32000 (2%)] Loss: 0.24128 (QuantReg: 12.26734) QuantErr: 12.26734 batch_time=0.34862 
Train Epoch: 26 [26/1000 832/32000 (3%)] Loss: 0.32458 (QuantReg: 12.78447) QuantErr: 12.78447 batch_time=0.37801 
Train Epoch: 26 [31/1000 992/32000 (3%)] Loss: 0.30520 (QuantReg: 13.21630) QuantErr: 13.21630 batch_time=0.39648 
Train Epoch: 26 [36/1000 1152/32000 (4%)] Loss: 0.44452 (QuantReg: 12.59146) QuantErr: 12.59146 batch_time=0.83160 
Train Epoch: 26 [41/1000 1312/32000 (4%)] Loss: 0.53295 (QuantReg: 12.28966) QuantErr: 12.28966 batch_time=0.53892 
Train Epoch: 26 [46/1000 1472/32000 (5%)] Loss: 0.36317 (QuantReg: 12.07915) QuantErr: 12.07915 batch_time=0.49244 
Train Epoch: 26 [51/1000 1632/32000 (5%)] Loss: 0.44425 (QuantReg: 12.42265) QuantErr: 12.42265 batch_time=0.39572 
Train Epoch: 26 [56/1000 1792/32000 (6%)] Loss: 0.20155 (QuantReg: 13.55591) QuantErr: 13.55591 batch_time=0.92340 
Train Epoch: 26 [61/1000 1952/32000 (6%)] Loss: 0.36744 (QuantReg: 12.75646) QuantErr: 12.75646 batch_time=0.42624 
Train Epoch: 26 [66/1000 2112/32000 (7%)] Loss: 0.50980 (QuantReg: 11.97517) QuantErr: 11.97517 batch_time=0.33985 
Train Epoch: 26 [71/1000 2272/32000 (7%)] Loss: 0.73137 (QuantReg: 12.36621) QuantErr: 12.36621 batch_time=0.36192 
Train Epoch: 26 [76/1000 2432/32000 (8%)] Loss: 0.64310 (QuantReg: 12.61089) QuantErr: 12.61089 batch_time=0.50192 
Train Epoch: 26 [81/1000 2592/32000 (8%)] Loss: 0.39744 (QuantReg: 12.87084) QuantErr: 12.87084 batch_time=0.39943 
Train Epoch: 26 [86/1000 2752/32000 (9%)] Loss: 0.52260 (QuantReg: 12.32480) QuantErr: 12.32480 batch_time=0.34188 
Train Epoch: 26 [91/1000 2912/32000 (9%)] Loss: 0.62904 (QuantReg: 12.25355) QuantErr: 12.25355 batch_time=0.35241 
Train Epoch: 26 [96/1000 3072/32000 (10%)] Loss: 0.48603 (QuantReg: 12.64086) QuantErr: 12.64086 batch_time=0.41096 
Train Epoch: 26 [101/1000 3232/32000 (10%)] Loss: 0.37731 (QuantReg: 13.01599) QuantErr: 13.01599 batch_time=0.59515 
Train Epoch: 26 [106/1000 3392/32000 (11%)] Loss: 0.29402 (QuantReg: 12.52089) QuantErr: 12.52089 batch_time=0.39158 
Train Epoch: 26 [111/1000 3552/32000 (11%)] Loss: 0.22379 (QuantReg: 13.12601) QuantErr: 13.12601 batch_time=0.45279 
Train Epoch: 26 [116/1000 3712/32000 (12%)] Loss: 0.16441 (QuantReg: 12.54583) QuantErr: 12.54583 batch_time=0.40745 
Train Epoch: 26 [121/1000 3872/32000 (12%)] Loss: 0.39874 (QuantReg: 12.29466) QuantErr: 12.29466 batch_time=0.39198 
Train Epoch: 26 [126/1000 4032/32000 (13%)] Loss: 0.48252 (QuantReg: 13.63507) QuantErr: 13.63507 batch_time=0.45195 
Train Epoch: 26 [131/1000 4192/32000 (13%)] Loss: 0.63765 (QuantReg: 11.85304) QuantErr: 11.85304 batch_time=0.36643 
Train Epoch: 26 [136/1000 4352/32000 (14%)] Loss: 0.19451 (QuantReg: 12.94432) QuantErr: 12.94432 batch_time=0.35396 
Train Epoch: 26 [141/1000 4512/32000 (14%)] Loss: 0.22836 (QuantReg: 13.30861) QuantErr: 13.30861 batch_time=0.65541 
Train Epoch: 26 [146/1000 4672/32000 (15%)] Loss: 0.70720 (QuantReg: 12.63858) QuantErr: 12.63858 batch_time=0.39195 
Train Epoch: 26 [151/1000 4832/32000 (15%)] Loss: 0.12179 (QuantReg: 12.71930) QuantErr: 12.71930 batch_time=0.37544 
Train Epoch: 26 [156/1000 4992/32000 (16%)] Loss: 0.47786 (QuantReg: 12.42358) QuantErr: 12.42358 batch_time=0.34424 
Train Epoch: 26 [161/1000 5152/32000 (16%)] Loss: 0.44046 (QuantReg: 12.50529) QuantErr: 12.50529 batch_time=0.54063 
Train Epoch: 26 [166/1000 5312/32000 (17%)] Loss: 0.40401 (QuantReg: 12.31240) QuantErr: 12.31240 batch_time=0.36272 
Train Epoch: 26 [171/1000 5472/32000 (17%)] Loss: 0.46907 (QuantReg: 13.60837) QuantErr: 13.60837 batch_time=0.41418 
Train Epoch: 26 [176/1000 5632/32000 (18%)] Loss: 0.32376 (QuantReg: 13.17272) QuantErr: 13.17272 batch_time=0.38893 
Train Epoch: 26 [181/1000 5792/32000 (18%)] Loss: 0.37820 (QuantReg: 12.83672) QuantErr: 12.83672 batch_time=0.55885 
Train Epoch: 26 [186/1000 5952/32000 (19%)] Loss: 0.33911 (QuantReg: 12.49436) QuantErr: 12.49436 batch_time=0.39395 
Train Epoch: 26 [191/1000 6112/32000 (19%)] Loss: 0.72215 (QuantReg: 12.31279) QuantErr: 12.31279 batch_time=0.53077 
Train Epoch: 26 [196/1000 6272/32000 (20%)] Loss: 0.12757 (QuantReg: 12.00278) QuantErr: 12.00278 batch_time=0.81356 
Train Epoch: 26 [201/1000 6432/32000 (20%)] Loss: 0.55971 (QuantReg: 12.55167) QuantErr: 12.55167 batch_time=0.50003 
Train Epoch: 26 [206/1000 6592/32000 (21%)] Loss: 0.82796 (QuantReg: 13.03302) QuantErr: 13.03302 batch_time=0.57696 
Train Epoch: 26 [211/1000 6752/32000 (21%)] Loss: 0.37694 (QuantReg: 12.94676) QuantErr: 12.94676 batch_time=0.40379 
Train Epoch: 26 [216/1000 6912/32000 (22%)] Loss: 0.21341 (QuantReg: 12.86246) QuantErr: 12.86246 batch_time=0.44377 
Train Epoch: 26 [221/1000 7072/32000 (22%)] Loss: 0.89766 (QuantReg: 12.09556) QuantErr: 12.09556 batch_time=0.35109 
Train Epoch: 26 [226/1000 7232/32000 (23%)] Loss: 0.12369 (QuantReg: 13.19014) QuantErr: 13.19014 batch_time=0.38242 
Train Epoch: 26 [231/1000 7392/32000 (23%)] Loss: 0.08438 (QuantReg: 12.41857) QuantErr: 12.41857 batch_time=0.39910 
Train Epoch: 26 [236/1000 7552/32000 (24%)] Loss: 0.55525 (QuantReg: 13.09262) QuantErr: 13.09262 batch_time=0.36765 
Train Epoch: 26 [241/1000 7712/32000 (24%)] Loss: 0.50739 (QuantReg: 12.50947) QuantErr: 12.50947 batch_time=0.51742 
Train Epoch: 26 [246/1000 7872/32000 (25%)] Loss: 0.59842 (QuantReg: 12.92202) QuantErr: 12.92202 batch_time=0.49522 
Train Epoch: 26 [251/1000 8032/32000 (25%)] Loss: 0.45685 (QuantReg: 12.61033) QuantErr: 12.61033 batch_time=0.37716 
Train Epoch: 26 [256/1000 8192/32000 (26%)] Loss: 0.15305 (QuantReg: 13.34233) QuantErr: 13.34233 batch_time=0.39953 
Train Epoch: 26 [261/1000 8352/32000 (26%)] Loss: 0.48303 (QuantReg: 13.30496) QuantErr: 13.30496 batch_time=0.36742 
Train Epoch: 26 [266/1000 8512/32000 (27%)] Loss: 0.30102 (QuantReg: 12.76070) QuantErr: 12.76070 batch_time=0.41683 
Train Epoch: 26 [271/1000 8672/32000 (27%)] Loss: 0.43822 (QuantReg: 13.19330) QuantErr: 13.19330 batch_time=0.39029 
Train Epoch: 26 [276/1000 8832/32000 (28%)] Loss: 0.37096 (QuantReg: 12.51618) QuantErr: 12.51618 batch_time=0.59646 
Train Epoch: 26 [281/1000 8992/32000 (28%)] Loss: 0.50273 (QuantReg: 12.75836) QuantErr: 12.75836 batch_time=0.43822 
Train Epoch: 26 [286/1000 9152/32000 (29%)] Loss: 0.32245 (QuantReg: 12.59434) QuantErr: 12.59434 batch_time=0.38479 
Train Epoch: 26 [291/1000 9312/32000 (29%)] Loss: 0.81615 (QuantReg: 12.77118) QuantErr: 12.77118 batch_time=0.76253 
Train Epoch: 26 [296/1000 9472/32000 (30%)] Loss: 0.35102 (QuantReg: 13.15644) QuantErr: 13.15644 batch_time=0.45754 
Train Epoch: 26 [301/1000 9632/32000 (30%)] Loss: 0.19485 (QuantReg: 12.56835) QuantErr: 12.56835 batch_time=0.57109 
Train Epoch: 26 [306/1000 9792/32000 (31%)] Loss: 0.15721 (QuantReg: 12.46144) QuantErr: 12.46144 batch_time=0.39961 
Train Epoch: 26 [311/1000 9952/32000 (31%)] Loss: 0.30553 (QuantReg: 13.24431) QuantErr: 13.24431 batch_time=0.39230 
Train Epoch: 26 [316/1000 10112/32000 (32%)] Loss: 0.61464 (QuantReg: 12.46556) QuantErr: 12.46556 batch_time=0.35515 
Train Epoch: 26 [321/1000 10272/32000 (32%)] Loss: 0.27655 (QuantReg: 13.53621) QuantErr: 13.53621 batch_time=0.56602 
Train Epoch: 26 [326/1000 10432/32000 (33%)] Loss: 0.46271 (QuantReg: 12.32500) QuantErr: 12.32500 batch_time=0.67466 
Train Epoch: 26 [331/1000 10592/32000 (33%)] Loss: 0.38671 (QuantReg: 12.97347) QuantErr: 12.97347 batch_time=0.34517 
Train Epoch: 26 [336/1000 10752/32000 (34%)] Loss: 0.30759 (QuantReg: 13.35908) QuantErr: 13.35908 batch_time=0.78296 
Train Epoch: 26 [341/1000 10912/32000 (34%)] Loss: 0.10501 (QuantReg: 12.00765) QuantErr: 12.00765 batch_time=0.38310 
Train Epoch: 26 [346/1000 11072/32000 (35%)] Loss: 0.27410 (QuantReg: 12.80199) QuantErr: 12.80199 batch_time=0.40246 
Train Epoch: 26 [351/1000 11232/32000 (35%)] Loss: 0.22256 (QuantReg: 12.42113) QuantErr: 12.42113 batch_time=0.43196 
Train Epoch: 26 [356/1000 11392/32000 (36%)] Loss: 0.23677 (QuantReg: 13.14862) QuantErr: 13.14862 batch_time=0.77412 
Train Epoch: 26 [361/1000 11552/32000 (36%)] Loss: 0.16932 (QuantReg: 13.42525) QuantErr: 13.42525 batch_time=0.38300 
Train Epoch: 26 [366/1000 11712/32000 (37%)] Loss: 0.24536 (QuantReg: 12.52375) QuantErr: 12.52375 batch_time=0.46423 
Train Epoch: 26 [371/1000 11872/32000 (37%)] Loss: 0.52120 (QuantReg: 12.27707) QuantErr: 12.27707 batch_time=0.39552 
Train Epoch: 26 [376/1000 12032/32000 (38%)] Loss: 0.12665 (QuantReg: 12.99457) QuantErr: 12.99457 batch_time=0.49306 
Train Epoch: 26 [381/1000 12192/32000 (38%)] Loss: 0.38050 (QuantReg: 11.96070) QuantErr: 11.96070 batch_time=0.87050 
Train Epoch: 26 [386/1000 12352/32000 (39%)] Loss: 0.34747 (QuantReg: 12.80100) QuantErr: 12.80100 batch_time=0.41022 
Train Epoch: 26 [391/1000 12512/32000 (39%)] Loss: 0.22256 (QuantReg: 12.67035) QuantErr: 12.67035 batch_time=0.41263 
Train Epoch: 26 [396/1000 12672/32000 (40%)] Loss: 0.28487 (QuantReg: 13.01135) QuantErr: 13.01135 batch_time=0.47356 
Train Epoch: 26 [401/1000 12832/32000 (40%)] Loss: 0.21115 (QuantReg: 12.93002) QuantErr: 12.93002 batch_time=0.40176 
Train Epoch: 26 [406/1000 12992/32000 (41%)] Loss: 0.51648 (QuantReg: 13.27181) QuantErr: 13.27181 batch_time=0.37089 
Train Epoch: 26 [411/1000 13152/32000 (41%)] Loss: 0.43177 (QuantReg: 12.64926) QuantErr: 12.64926 batch_time=0.36001 
Train Epoch: 26 [416/1000 13312/32000 (42%)] Loss: 0.31136 (QuantReg: 12.99327) QuantErr: 12.99327 batch_time=0.38636 
Train Epoch: 26 [421/1000 13472/32000 (42%)] Loss: 0.35467 (QuantReg: 12.85926) QuantErr: 12.85926 batch_time=0.36044 
Train Epoch: 26 [426/1000 13632/32000 (43%)] Loss: 0.07402 (QuantReg: 12.76197) QuantErr: 12.76197 batch_time=0.50909 
Train Epoch: 26 [431/1000 13792/32000 (43%)] Loss: 0.27644 (QuantReg: 12.84742) QuantErr: 12.84742 batch_time=0.35657 
Train Epoch: 26 [436/1000 13952/32000 (44%)] Loss: 0.35014 (QuantReg: 12.49632) QuantErr: 12.49632 batch_time=0.35024 
Train Epoch: 26 [441/1000 14112/32000 (44%)] Loss: 0.48902 (QuantReg: 12.55508) QuantErr: 12.55508 batch_time=0.35064 
Train Epoch: 26 [446/1000 14272/32000 (45%)] Loss: 0.30487 (QuantReg: 12.86889) QuantErr: 12.86889 batch_time=0.43845 
Train Epoch: 26 [451/1000 14432/32000 (45%)] Loss: 0.28123 (QuantReg: 13.07804) QuantErr: 13.07804 batch_time=0.37647 
Train Epoch: 26 [456/1000 14592/32000 (46%)] Loss: 0.24128 (QuantReg: 12.86090) QuantErr: 12.86090 batch_time=0.38262 
Train Epoch: 26 [461/1000 14752/32000 (46%)] Loss: 0.44615 (QuantReg: 12.80123) QuantErr: 12.80123 batch_time=0.34097 
Train Epoch: 26 [466/1000 14912/32000 (47%)] Loss: 0.53414 (QuantReg: 12.97832) QuantErr: 12.97832 batch_time=0.34304 
Train Epoch: 26 [471/1000 15072/32000 (47%)] Loss: 0.38222 (QuantReg: 13.01435) QuantErr: 13.01435 batch_time=0.64700 
Train Epoch: 26 [476/1000 15232/32000 (48%)] Loss: 0.30879 (QuantReg: 12.92570) QuantErr: 12.92570 batch_time=0.54328 
Train Epoch: 26 [481/1000 15392/32000 (48%)] Loss: 1.06037 (QuantReg: 12.79731) QuantErr: 12.79731 batch_time=0.34236 
Train Epoch: 26 [486/1000 15552/32000 (49%)] Loss: 0.43409 (QuantReg: 12.99489) QuantErr: 12.99489 batch_time=0.39379 
Train Epoch: 26 [491/1000 15712/32000 (49%)] Loss: 0.25095 (QuantReg: 13.01755) QuantErr: 13.01755 batch_time=0.36065 
Train Epoch: 26 [496/1000 15872/32000 (50%)] Loss: 0.20892 (QuantReg: 13.33222) QuantErr: 13.33222 batch_time=0.36887 
Train Epoch: 26 [501/1000 16032/32000 (50%)] Loss: 0.37516 (QuantReg: 12.83969) QuantErr: 12.83969 batch_time=0.46626 
Train Epoch: 26 [506/1000 16192/32000 (51%)] Loss: 0.41293 (QuantReg: 12.51427) QuantErr: 12.51427 batch_time=0.35934 
Train Epoch: 26 [511/1000 16352/32000 (51%)] Loss: 0.55692 (QuantReg: 12.87718) QuantErr: 12.87718 batch_time=0.45049 
Train Epoch: 26 [516/1000 16512/32000 (52%)] Loss: 0.21260 (QuantReg: 12.91132) QuantErr: 12.91132 batch_time=0.37242 
Train Epoch: 26 [521/1000 16672/32000 (52%)] Loss: 0.45523 (QuantReg: 13.30524) QuantErr: 13.30524 batch_time=0.38058 
Train Epoch: 26 [526/1000 16832/32000 (53%)] Loss: 0.24736 (QuantReg: 12.98018) QuantErr: 12.98018 batch_time=0.41884 
Train Epoch: 26 [531/1000 16992/32000 (53%)] Loss: 0.73274 (QuantReg: 13.66060) QuantErr: 13.66060 batch_time=0.36209 
Train Epoch: 26 [536/1000 17152/32000 (54%)] Loss: 0.57467 (QuantReg: 12.27908) QuantErr: 12.27908 batch_time=0.48224 
Train Epoch: 26 [541/1000 17312/32000 (54%)] Loss: 0.74974 (QuantReg: 12.57400) QuantErr: 12.57400 batch_time=0.37652 
Train Epoch: 26 [546/1000 17472/32000 (55%)] Loss: 0.39950 (QuantReg: 12.21668) QuantErr: 12.21668 batch_time=0.42992 
Train Epoch: 26 [551/1000 17632/32000 (55%)] Loss: 0.46204 (QuantReg: 12.51687) QuantErr: 12.51687 batch_time=0.40455 
Train Epoch: 26 [556/1000 17792/32000 (56%)] Loss: 0.25515 (QuantReg: 12.37403) QuantErr: 12.37403 batch_time=0.61298 
Train Epoch: 26 [561/1000 17952/32000 (56%)] Loss: 0.37776 (QuantReg: 12.62756) QuantErr: 12.62756 batch_time=0.35090 
Train Epoch: 26 [566/1000 18112/32000 (57%)] Loss: 0.21483 (QuantReg: 13.00519) QuantErr: 13.00519 batch_time=0.78042 
Train Epoch: 26 [571/1000 18272/32000 (57%)] Loss: 0.49951 (QuantReg: 13.04870) QuantErr: 13.04870 batch_time=0.36876 
Train Epoch: 26 [576/1000 18432/32000 (58%)] Loss: 0.44019 (QuantReg: 12.89419) QuantErr: 12.89419 batch_time=0.42718 
Train Epoch: 26 [581/1000 18592/32000 (58%)] Loss: 0.61304 (QuantReg: 12.73012) QuantErr: 12.73012 batch_time=0.40924 
Train Epoch: 26 [586/1000 18752/32000 (59%)] Loss: 0.46874 (QuantReg: 12.98386) QuantErr: 12.98386 batch_time=0.39428 
Train Epoch: 26 [591/1000 18912/32000 (59%)] Loss: 0.26094 (QuantReg: 12.84871) QuantErr: 12.84871 batch_time=0.42041 
Train Epoch: 26 [596/1000 19072/32000 (60%)] Loss: 0.60799 (QuantReg: 12.30386) QuantErr: 12.30386 batch_time=0.39095 
Train Epoch: 26 [601/1000 19232/32000 (60%)] Loss: 0.64478 (QuantReg: 12.06415) QuantErr: 12.06415 batch_time=0.36683 
Train Epoch: 26 [606/1000 19392/32000 (61%)] Loss: 0.28119 (QuantReg: 13.05795) QuantErr: 13.05795 batch_time=0.41818 
Train Epoch: 26 [611/1000 19552/32000 (61%)] Loss: 0.29889 (QuantReg: 12.90122) QuantErr: 12.90122 batch_time=0.34551 
Train Epoch: 26 [616/1000 19712/32000 (62%)] Loss: 0.20961 (QuantReg: 13.30044) QuantErr: 13.30044 batch_time=0.85811 
Train Epoch: 26 [621/1000 19872/32000 (62%)] Loss: 0.15893 (QuantReg: 13.45054) QuantErr: 13.45054 batch_time=0.40732 
Train Epoch: 26 [626/1000 20032/32000 (63%)] Loss: 0.53040 (QuantReg: 13.16568) QuantErr: 13.16568 batch_time=0.40438 
Train Epoch: 26 [631/1000 20192/32000 (63%)] Loss: 0.21463 (QuantReg: 12.75992) QuantErr: 12.75992 batch_time=0.53203 
Train Epoch: 26 [636/1000 20352/32000 (64%)] Loss: 0.58787 (QuantReg: 12.54277) QuantErr: 12.54277 batch_time=0.63236 
Train Epoch: 26 [641/1000 20512/32000 (64%)] Loss: 0.28272 (QuantReg: 13.01831) QuantErr: 13.01831 batch_time=0.41024 
Train Epoch: 26 [646/1000 20672/32000 (65%)] Loss: 0.34820 (QuantReg: 13.18229) QuantErr: 13.18229 batch_time=2.56797 
Train Epoch: 26 [651/1000 20832/32000 (65%)] Loss: 0.31569 (QuantReg: 12.48201) QuantErr: 12.48201 batch_time=0.36873 
Train Epoch: 26 [656/1000 20992/32000 (66%)] Loss: 0.22009 (QuantReg: 12.66203) QuantErr: 12.66203 batch_time=0.39873 
Train Epoch: 26 [661/1000 21152/32000 (66%)] Loss: 0.44995 (QuantReg: 12.76532) QuantErr: 12.76532 batch_time=0.60650 
Train Epoch: 26 [666/1000 21312/32000 (67%)] Loss: 0.50948 (QuantReg: 12.71343) QuantErr: 12.71343 batch_time=0.39135 
Train Epoch: 26 [671/1000 21472/32000 (67%)] Loss: 0.38255 (QuantReg: 12.91542) QuantErr: 12.91542 batch_time=0.36326 
Train Epoch: 26 [676/1000 21632/32000 (68%)] Loss: 0.47111 (QuantReg: 13.35576) QuantErr: 13.35576 batch_time=0.41362 
Train Epoch: 26 [681/1000 21792/32000 (68%)] Loss: 0.34156 (QuantReg: 12.93187) QuantErr: 12.93187 batch_time=0.37034 
Train Epoch: 26 [686/1000 21952/32000 (69%)] Loss: 0.52042 (QuantReg: 12.58448) QuantErr: 12.58448 batch_time=0.42950 
Train Epoch: 26 [691/1000 22112/32000 (69%)] Loss: 0.30170 (QuantReg: 12.85446) QuantErr: 12.85446 batch_time=0.36022 
Train Epoch: 26 [696/1000 22272/32000 (70%)] Loss: 0.10239 (QuantReg: 12.80039) QuantErr: 12.80039 batch_time=0.41369 
Train Epoch: 26 [701/1000 22432/32000 (70%)] Loss: 0.48122 (QuantReg: 12.64691) QuantErr: 12.64691 batch_time=0.36455 
Train Epoch: 26 [706/1000 22592/32000 (71%)] Loss: 0.30913 (QuantReg: 12.86069) QuantErr: 12.86069 batch_time=0.65370 
Train Epoch: 26 [711/1000 22752/32000 (71%)] Loss: 0.42679 (QuantReg: 12.91404) QuantErr: 12.91404 batch_time=0.52930 
Train Epoch: 26 [716/1000 22912/32000 (72%)] Loss: 0.51185 (QuantReg: 11.81420) QuantErr: 11.81420 batch_time=0.35869 
Train Epoch: 26 [721/1000 23072/32000 (72%)] Loss: 0.31760 (QuantReg: 12.88910) QuantErr: 12.88910 batch_time=0.84795 
Train Epoch: 26 [726/1000 23232/32000 (73%)] Loss: 0.50576 (QuantReg: 12.95070) QuantErr: 12.95070 batch_time=0.43260 
Train Epoch: 26 [731/1000 23392/32000 (73%)] Loss: 0.25934 (QuantReg: 12.80949) QuantErr: 12.80949 batch_time=0.39072 
Train Epoch: 26 [736/1000 23552/32000 (74%)] Loss: 0.32817 (QuantReg: 12.68914) QuantErr: 12.68914 batch_time=0.39063 
Train Epoch: 26 [741/1000 23712/32000 (74%)] Loss: 0.45739 (QuantReg: 12.87897) QuantErr: 12.87897 batch_time=0.36193 
Train Epoch: 26 [746/1000 23872/32000 (75%)] Loss: 0.89744 (QuantReg: 13.09985) QuantErr: 13.09985 batch_time=0.37869 
Train Epoch: 26 [751/1000 24032/32000 (75%)] Loss: 0.40844 (QuantReg: 12.90098) QuantErr: 12.90098 batch_time=0.33821 
Train Epoch: 26 [756/1000 24192/32000 (76%)] Loss: 0.63142 (QuantReg: 12.58608) QuantErr: 12.58608 batch_time=0.69820 
Train Epoch: 26 [761/1000 24352/32000 (76%)] Loss: 0.34606 (QuantReg: 13.04085) QuantErr: 13.04085 batch_time=0.38388 
Train Epoch: 26 [766/1000 24512/32000 (77%)] Loss: 0.12827 (QuantReg: 13.08359) QuantErr: 13.08359 batch_time=0.36173 
Train Epoch: 26 [771/1000 24672/32000 (77%)] Loss: 0.75334 (QuantReg: 12.69548) QuantErr: 12.69548 batch_time=0.61966 
Train Epoch: 26 [776/1000 24832/32000 (78%)] Loss: 0.28554 (QuantReg: 12.87803) QuantErr: 12.87803 batch_time=0.45863 
Train Epoch: 26 [781/1000 24992/32000 (78%)] Loss: 0.33056 (QuantReg: 13.13855) QuantErr: 13.13855 batch_time=0.35880 
Train Epoch: 26 [786/1000 25152/32000 (79%)] Loss: 0.72152 (QuantReg: 13.02352) QuantErr: 13.02352 batch_time=0.39126 
Train Epoch: 26 [791/1000 25312/32000 (79%)] Loss: 0.84167 (QuantReg: 13.30675) QuantErr: 13.30675 batch_time=0.37350 
Train Epoch: 26 [796/1000 25472/32000 (80%)] Loss: 0.59498 (QuantReg: 13.44740) QuantErr: 13.44740 batch_time=0.47322 
Train Epoch: 26 [801/1000 25632/32000 (80%)] Loss: 0.31320 (QuantReg: 12.80760) QuantErr: 12.80760 batch_time=0.39675 
Train Epoch: 26 [806/1000 25792/32000 (81%)] Loss: 0.45385 (QuantReg: 12.18789) QuantErr: 12.18789 batch_time=0.50184 
Train Epoch: 26 [811/1000 25952/32000 (81%)] Loss: 0.45737 (QuantReg: 13.02385) QuantErr: 13.02385 batch_time=0.50181 
Train Epoch: 26 [816/1000 26112/32000 (82%)] Loss: 0.46594 (QuantReg: 12.78966) QuantErr: 12.78966 batch_time=0.36235 
Train Epoch: 26 [821/1000 26272/32000 (82%)] Loss: 0.22169 (QuantReg: 13.61104) QuantErr: 13.61104 batch_time=0.37350 
Train Epoch: 26 [826/1000 26432/32000 (83%)] Loss: 0.19632 (QuantReg: 12.88357) QuantErr: 12.88357 batch_time=0.37741 
Train Epoch: 26 [831/1000 26592/32000 (83%)] Loss: 0.44006 (QuantReg: 12.77118) QuantErr: 12.77118 batch_time=0.44242 
Train Epoch: 26 [836/1000 26752/32000 (84%)] Loss: 0.24942 (QuantReg: 12.67046) QuantErr: 12.67046 batch_time=0.41467 
Train Epoch: 26 [841/1000 26912/32000 (84%)] Loss: 0.15861 (QuantReg: 13.27328) QuantErr: 13.27328 batch_time=0.55535 
Train Epoch: 26 [846/1000 27072/32000 (85%)] Loss: 0.38080 (QuantReg: 13.39459) QuantErr: 13.39459 batch_time=0.37493 
Train Epoch: 26 [851/1000 27232/32000 (85%)] Loss: 0.45222 (QuantReg: 12.82020) QuantErr: 12.82020 batch_time=0.61612 
Train Epoch: 26 [856/1000 27392/32000 (86%)] Loss: 0.39173 (QuantReg: 13.10751) QuantErr: 13.10751 batch_time=0.40174 
Train Epoch: 26 [861/1000 27552/32000 (86%)] Loss: 0.57654 (QuantReg: 13.51407) QuantErr: 13.51407 batch_time=0.36484 
Train Epoch: 26 [866/1000 27712/32000 (87%)] Loss: 0.20696 (QuantReg: 13.06083) QuantErr: 13.06083 batch_time=0.43741 
Train Epoch: 26 [871/1000 27872/32000 (87%)] Loss: 0.42094 (QuantReg: 13.41361) QuantErr: 13.41361 batch_time=0.41157 
Train Epoch: 26 [876/1000 28032/32000 (88%)] Loss: 0.28543 (QuantReg: 13.04481) QuantErr: 13.04481 batch_time=1.35385 
Train Epoch: 26 [881/1000 28192/32000 (88%)] Loss: 0.77069 (QuantReg: 12.69007) QuantErr: 12.69007 batch_time=0.34112 
Train Epoch: 26 [886/1000 28352/32000 (89%)] Loss: 0.39220 (QuantReg: 13.82063) QuantErr: 13.82063 batch_time=0.40745 
Train Epoch: 26 [891/1000 28512/32000 (89%)] Loss: 0.35727 (QuantReg: 13.15483) QuantErr: 13.15483 batch_time=0.34174 
Train Epoch: 26 [896/1000 28672/32000 (90%)] Loss: 0.16973 (QuantReg: 13.13568) QuantErr: 13.13568 batch_time=0.67151 
Train Epoch: 26 [901/1000 28832/32000 (90%)] Loss: 0.45836 (QuantReg: 13.39025) QuantErr: 13.39025 batch_time=0.37506 
Train Epoch: 26 [906/1000 28992/32000 (91%)] Loss: 0.43327 (QuantReg: 12.89928) QuantErr: 12.89928 batch_time=0.42498 
Train Epoch: 26 [911/1000 29152/32000 (91%)] Loss: 0.45668 (QuantReg: 12.07086) QuantErr: 12.07086 batch_time=0.38970 
Train Epoch: 26 [916/1000 29312/32000 (92%)] Loss: 0.23109 (QuantReg: 12.91679) QuantErr: 12.91679 batch_time=0.36483 
Train Epoch: 26 [921/1000 29472/32000 (92%)] Loss: 0.36238 (QuantReg: 12.43441) QuantErr: 12.43441 batch_time=0.38984 
Train Epoch: 26 [926/1000 29632/32000 (93%)] Loss: 0.39398 (QuantReg: 13.52978) QuantErr: 13.52978 batch_time=0.36809 
Train Epoch: 26 [931/1000 29792/32000 (93%)] Loss: 0.20688 (QuantReg: 13.24143) QuantErr: 13.24143 batch_time=0.50684 
Train Epoch: 26 [936/1000 29952/32000 (94%)] Loss: 0.23777 (QuantReg: 13.61046) QuantErr: 13.61046 batch_time=0.43814 
Train Epoch: 26 [941/1000 30112/32000 (94%)] Loss: 0.33876 (QuantReg: 13.34578) QuantErr: 13.34578 batch_time=0.52621 
Train Epoch: 26 [946/1000 30272/32000 (95%)] Loss: 0.24357 (QuantReg: 13.33455) QuantErr: 13.33455 batch_time=0.39562 
Train Epoch: 26 [951/1000 30432/32000 (95%)] Loss: 0.28371 (QuantReg: 12.97892) QuantErr: 12.97892 batch_time=0.53598 
Train Epoch: 26 [956/1000 30592/32000 (96%)] Loss: 0.68205 (QuantReg: 12.36654) QuantErr: 12.36654 batch_time=0.41863 
Train Epoch: 26 [961/1000 30752/32000 (96%)] Loss: 0.46079 (QuantReg: 12.60228) QuantErr: 12.60228 batch_time=0.38246 
Train Epoch: 26 [966/1000 30912/32000 (97%)] Loss: 0.77413 (QuantReg: 13.03658) QuantErr: 13.03658 batch_time=1.34864 
Train Epoch: 26 [971/1000 31072/32000 (97%)] Loss: 1.02812 (QuantReg: 13.17018) QuantErr: 13.17018 batch_time=0.42242 
Train Epoch: 26 [976/1000 31232/32000 (98%)] Loss: 0.48369 (QuantReg: 13.18610) QuantErr: 13.18610 batch_time=0.44724 
Train Epoch: 26 [981/1000 31392/32000 (98%)] Loss: 0.45673 (QuantReg: 12.64662) QuantErr: 12.64662 batch_time=0.37676 
Train Epoch: 26 [986/1000 31552/32000 (99%)] Loss: 0.22840 (QuantReg: 13.05774) QuantErr: 13.05774 batch_time=0.75721 
Train Epoch: 26 [991/1000 31712/32000 (99%)] Loss: 0.29412 (QuantReg: 12.53937) QuantErr: 12.53937 batch_time=1.02987 
Train Epoch: 26 [996/1000 31872/32000 (100%)] Loss: 0.28301 (QuantReg: 13.38840) QuantErr: 13.38840 batch_time=0.41604 
Train Epoch: 26 codebook_update_time=1.78063
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch26.pth ...
Done in 6.527s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 0.4080504429191351
 quant_reg      : 12.785300775527954
 quant_err      : 12.785300775527954
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 26000
 MSRVTT_miech_test/t2v_metrics/R1: 19.3
 MSRVTT_miech_test/t2v_metrics/R5: 49.5
 MSRVTT_miech_test/t2v_metrics/R10: 62.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 29.691
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.085365279837006
 MSRVTT_miech_test/v2t_metrics/R1: 20.1
 MSRVTT_miech_test/v2t_metrics/R5: 50.7
 MSRVTT_miech_test/v2t_metrics/R10: 64.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 25.8465
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.25266728720128
 mnt_best       : 39.24676668836643
 not_improved_count: 1
Train Epoch: 27 [1/1000 32/32000 (0%)] Loss: 0.54963 (QuantReg: 12.39699) QuantErr: 12.39699 batch_time=30.30079 
Train Epoch: 27 [6/1000 192/32000 (1%)] Loss: 0.19339 (QuantReg: 12.76313) QuantErr: 12.76313 batch_time=0.35693 
Train Epoch: 27 [11/1000 352/32000 (1%)] Loss: 0.31717 (QuantReg: 12.52504) QuantErr: 12.52504 batch_time=0.44878 
Train Epoch: 27 [16/1000 512/32000 (2%)] Loss: 0.41635 (QuantReg: 12.93551) QuantErr: 12.93551 batch_time=1.74290 
Train Epoch: 27 [21/1000 672/32000 (2%)] Loss: 0.69430 (QuantReg: 13.67582) QuantErr: 13.67582 batch_time=0.77274 
Train Epoch: 27 [26/1000 832/32000 (3%)] Loss: 0.38885 (QuantReg: 12.72723) QuantErr: 12.72723 batch_time=0.37476 
Train Epoch: 27 [31/1000 992/32000 (3%)] Loss: 0.74004 (QuantReg: 12.07271) QuantErr: 12.07271 batch_time=0.38028 
Train Epoch: 27 [36/1000 1152/32000 (4%)] Loss: 0.44172 (QuantReg: 13.56975) QuantErr: 13.56975 batch_time=0.35992 
Train Epoch: 27 [41/1000 1312/32000 (4%)] Loss: 0.87931 (QuantReg: 12.42658) QuantErr: 12.42658 batch_time=0.39575 
Train Epoch: 27 [46/1000 1472/32000 (5%)] Loss: 0.15158 (QuantReg: 12.72342) QuantErr: 12.72342 batch_time=0.36040 
Train Epoch: 27 [51/1000 1632/32000 (5%)] Loss: 0.18551 (QuantReg: 13.00581) QuantErr: 13.00581 batch_time=0.37844 
Train Epoch: 27 [56/1000 1792/32000 (6%)] Loss: 0.10970 (QuantReg: 13.09550) QuantErr: 13.09550 batch_time=0.45527 
Train Epoch: 27 [61/1000 1952/32000 (6%)] Loss: 0.36943 (QuantReg: 13.25433) QuantErr: 13.25433 batch_time=0.35860 
Train Epoch: 27 [66/1000 2112/32000 (7%)] Loss: 0.25713 (QuantReg: 12.41380) QuantErr: 12.41380 batch_time=0.88855 
Train Epoch: 27 [71/1000 2272/32000 (7%)] Loss: 0.25289 (QuantReg: 12.42196) QuantErr: 12.42196 batch_time=0.34409 
Train Epoch: 27 [76/1000 2432/32000 (8%)] Loss: 0.11708 (QuantReg: 13.19579) QuantErr: 13.19579 batch_time=0.34385 
Train Epoch: 27 [81/1000 2592/32000 (8%)] Loss: 0.47478 (QuantReg: 12.53993) QuantErr: 12.53993 batch_time=0.33752 
Train Epoch: 27 [86/1000 2752/32000 (9%)] Loss: 0.59577 (QuantReg: 12.02095) QuantErr: 12.02095 batch_time=0.63050 
Train Epoch: 27 [91/1000 2912/32000 (9%)] Loss: 0.23239 (QuantReg: 12.70078) QuantErr: 12.70078 batch_time=0.58618 
Train Epoch: 27 [96/1000 3072/32000 (10%)] Loss: 0.33233 (QuantReg: 13.36570) QuantErr: 13.36570 batch_time=0.44982 
Train Epoch: 27 [101/1000 3232/32000 (10%)] Loss: 0.18830 (QuantReg: 12.92528) QuantErr: 12.92528 batch_time=0.37510 
Train Epoch: 27 [106/1000 3392/32000 (11%)] Loss: 0.30878 (QuantReg: 12.47768) QuantErr: 12.47768 batch_time=0.34374 
Train Epoch: 27 [111/1000 3552/32000 (11%)] Loss: 0.18527 (QuantReg: 12.81801) QuantErr: 12.81801 batch_time=0.59859 
Train Epoch: 27 [116/1000 3712/32000 (12%)] Loss: 0.13224 (QuantReg: 12.83321) QuantErr: 12.83321 batch_time=0.35571 
Train Epoch: 27 [121/1000 3872/32000 (12%)] Loss: 0.44061 (QuantReg: 13.35843) QuantErr: 13.35843 batch_time=0.43146 
Train Epoch: 27 [126/1000 4032/32000 (13%)] Loss: 0.39487 (QuantReg: 12.83374) QuantErr: 12.83374 batch_time=0.45028 
Train Epoch: 27 [131/1000 4192/32000 (13%)] Loss: 0.82659 (QuantReg: 12.87947) QuantErr: 12.87947 batch_time=0.36915 
Train Epoch: 27 [136/1000 4352/32000 (14%)] Loss: 0.56705 (QuantReg: 12.02409) QuantErr: 12.02409 batch_time=0.44080 
Train Epoch: 27 [141/1000 4512/32000 (14%)] Loss: 0.36266 (QuantReg: 12.57617) QuantErr: 12.57617 batch_time=0.47412 
Train Epoch: 27 [146/1000 4672/32000 (15%)] Loss: 0.20887 (QuantReg: 12.77368) QuantErr: 12.77368 batch_time=0.39520 
Train Epoch: 27 [151/1000 4832/32000 (15%)] Loss: 0.33928 (QuantReg: 13.73929) QuantErr: 13.73929 batch_time=0.42060 
Train Epoch: 27 [156/1000 4992/32000 (16%)] Loss: 0.22372 (QuantReg: 12.76251) QuantErr: 12.76251 batch_time=0.36778 
Train Epoch: 27 [161/1000 5152/32000 (16%)] Loss: 0.47215 (QuantReg: 12.42444) QuantErr: 12.42444 batch_time=0.75648 
Train Epoch: 27 [166/1000 5312/32000 (17%)] Loss: 0.33322 (QuantReg: 13.57682) QuantErr: 13.57682 batch_time=0.34095 
Train Epoch: 27 [171/1000 5472/32000 (17%)] Loss: 0.39190 (QuantReg: 12.38595) QuantErr: 12.38595 batch_time=0.39323 
Train Epoch: 27 [176/1000 5632/32000 (18%)] Loss: 0.82360 (QuantReg: 12.98946) QuantErr: 12.98946 batch_time=0.42993 
Train Epoch: 27 [181/1000 5792/32000 (18%)] Loss: 0.39688 (QuantReg: 12.91298) QuantErr: 12.91298 batch_time=0.36634 
Train Epoch: 27 [186/1000 5952/32000 (19%)] Loss: 0.19770 (QuantReg: 12.65533) QuantErr: 12.65533 batch_time=0.38015 
Train Epoch: 27 [191/1000 6112/32000 (19%)] Loss: 0.61434 (QuantReg: 12.53770) QuantErr: 12.53770 batch_time=0.45978 
Train Epoch: 27 [196/1000 6272/32000 (20%)] Loss: 0.11503 (QuantReg: 13.40713) QuantErr: 13.40713 batch_time=0.39800 
Train Epoch: 27 [201/1000 6432/32000 (20%)] Loss: 0.40279 (QuantReg: 12.45868) QuantErr: 12.45868 batch_time=0.36723 
Train Epoch: 27 [206/1000 6592/32000 (21%)] Loss: 0.27844 (QuantReg: 13.02715) QuantErr: 13.02715 batch_time=0.66973 
Train Epoch: 27 [211/1000 6752/32000 (21%)] Loss: 0.58359 (QuantReg: 12.68474) QuantErr: 12.68474 batch_time=0.34064 
Train Epoch: 27 [216/1000 6912/32000 (22%)] Loss: 0.39255 (QuantReg: 12.74688) QuantErr: 12.74688 batch_time=0.42704 
Train Epoch: 27 [221/1000 7072/32000 (22%)] Loss: 0.41522 (QuantReg: 12.67495) QuantErr: 12.67495 batch_time=0.36751 
Train Epoch: 27 [226/1000 7232/32000 (23%)] Loss: 0.30911 (QuantReg: 13.05372) QuantErr: 13.05372 batch_time=0.35009 
Train Epoch: 27 [231/1000 7392/32000 (23%)] Loss: 0.39588 (QuantReg: 12.68070) QuantErr: 12.68070 batch_time=0.47067 
Train Epoch: 27 [236/1000 7552/32000 (24%)] Loss: 0.44228 (QuantReg: 12.59767) QuantErr: 12.59767 batch_time=0.38692 
Train Epoch: 27 [241/1000 7712/32000 (24%)] Loss: 0.40051 (QuantReg: 12.45721) QuantErr: 12.45721 batch_time=0.44481 
Train Epoch: 27 [246/1000 7872/32000 (25%)] Loss: 0.18867 (QuantReg: 13.23599) QuantErr: 13.23599 batch_time=0.58183 
Train Epoch: 27 [251/1000 8032/32000 (25%)] Loss: 0.13613 (QuantReg: 12.67353) QuantErr: 12.67353 batch_time=0.39818 
Train Epoch: 27 [256/1000 8192/32000 (26%)] Loss: 0.49531 (QuantReg: 11.96152) QuantErr: 11.96152 batch_time=0.72818 
Train Epoch: 27 [261/1000 8352/32000 (26%)] Loss: 0.40992 (QuantReg: 12.82948) QuantErr: 12.82948 batch_time=1.78412 
Train Epoch: 27 [266/1000 8512/32000 (27%)] Loss: 0.34260 (QuantReg: 12.00504) QuantErr: 12.00504 batch_time=0.52576 
Train Epoch: 27 [271/1000 8672/32000 (27%)] Loss: 0.95377 (QuantReg: 11.96961) QuantErr: 11.96961 batch_time=0.37253 
Train Epoch: 27 [276/1000 8832/32000 (28%)] Loss: 0.88303 (QuantReg: 12.50234) QuantErr: 12.50234 batch_time=0.47690 
Train Epoch: 27 [281/1000 8992/32000 (28%)] Loss: 0.29797 (QuantReg: 12.91591) QuantErr: 12.91591 batch_time=0.36859 
Train Epoch: 27 [286/1000 9152/32000 (29%)] Loss: 0.30928 (QuantReg: 13.08690) QuantErr: 13.08690 batch_time=0.45095 
Train Epoch: 27 [291/1000 9312/32000 (29%)] Loss: 0.35297 (QuantReg: 13.20570) QuantErr: 13.20570 batch_time=0.46716 
Train Epoch: 27 [296/1000 9472/32000 (30%)] Loss: 0.28061 (QuantReg: 13.01695) QuantErr: 13.01695 batch_time=0.36897 
Train Epoch: 27 [301/1000 9632/32000 (30%)] Loss: 0.54002 (QuantReg: 13.15811) QuantErr: 13.15811 batch_time=0.66963 
Train Epoch: 27 [306/1000 9792/32000 (31%)] Loss: 0.44046 (QuantReg: 11.89620) QuantErr: 11.89620 batch_time=0.45120 
Train Epoch: 27 [311/1000 9952/32000 (31%)] Loss: 0.34463 (QuantReg: 13.37515) QuantErr: 13.37515 batch_time=0.34570 
Train Epoch: 27 [316/1000 10112/32000 (32%)] Loss: 0.40553 (QuantReg: 12.97652) QuantErr: 12.97652 batch_time=0.40604 
Train Epoch: 27 [321/1000 10272/32000 (32%)] Loss: 0.28268 (QuantReg: 12.59498) QuantErr: 12.59498 batch_time=0.36029 
Train Epoch: 27 [326/1000 10432/32000 (33%)] Loss: 0.18216 (QuantReg: 12.89331) QuantErr: 12.89331 batch_time=0.43633 
Train Epoch: 27 [331/1000 10592/32000 (33%)] Loss: 0.52261 (QuantReg: 13.28733) QuantErr: 13.28733 batch_time=0.38646 
Train Epoch: 27 [336/1000 10752/32000 (34%)] Loss: 0.28737 (QuantReg: 13.08945) QuantErr: 13.08945 batch_time=0.37271 
Train Epoch: 27 [341/1000 10912/32000 (34%)] Loss: 0.68845 (QuantReg: 12.46309) QuantErr: 12.46309 batch_time=0.66403 
Train Epoch: 27 [346/1000 11072/32000 (35%)] Loss: 0.40173 (QuantReg: 13.25045) QuantErr: 13.25045 batch_time=0.33904 
Train Epoch: 27 [351/1000 11232/32000 (35%)] Loss: 0.29249 (QuantReg: 12.38480) QuantErr: 12.38480 batch_time=0.75555 
Train Epoch: 27 [356/1000 11392/32000 (36%)] Loss: 0.37277 (QuantReg: 13.18372) QuantErr: 13.18372 batch_time=0.62585 
Train Epoch: 27 [361/1000 11552/32000 (36%)] Loss: 0.38734 (QuantReg: 12.66189) QuantErr: 12.66189 batch_time=1.30334 
Train Epoch: 27 [366/1000 11712/32000 (37%)] Loss: 0.41869 (QuantReg: 12.91867) QuantErr: 12.91867 batch_time=0.34594 
Train Epoch: 27 [371/1000 11872/32000 (37%)] Loss: 0.54308 (QuantReg: 12.75006) QuantErr: 12.75006 batch_time=0.39141 
Train Epoch: 27 [376/1000 12032/32000 (38%)] Loss: 0.40570 (QuantReg: 12.53840) QuantErr: 12.53840 batch_time=0.43012 
Train Epoch: 27 [381/1000 12192/32000 (38%)] Loss: 0.33240 (QuantReg: 13.01522) QuantErr: 13.01522 batch_time=0.42238 
Train Epoch: 27 [386/1000 12352/32000 (39%)] Loss: 0.52586 (QuantReg: 12.38956) QuantErr: 12.38956 batch_time=0.35946 
Train Epoch: 27 [391/1000 12512/32000 (39%)] Loss: 0.17802 (QuantReg: 13.44462) QuantErr: 13.44462 batch_time=0.33608 
Train Epoch: 27 [396/1000 12672/32000 (40%)] Loss: 0.24102 (QuantReg: 13.23132) QuantErr: 13.23132 batch_time=0.75604 
Train Epoch: 27 [401/1000 12832/32000 (40%)] Loss: 0.68907 (QuantReg: 13.11341) QuantErr: 13.11341 batch_time=0.36823 
Train Epoch: 27 [406/1000 12992/32000 (41%)] Loss: 0.20605 (QuantReg: 12.48273) QuantErr: 12.48273 batch_time=0.38354 
Train Epoch: 27 [411/1000 13152/32000 (41%)] Loss: 0.13815 (QuantReg: 13.28903) QuantErr: 13.28903 batch_time=0.38271 
Train Epoch: 27 [416/1000 13312/32000 (42%)] Loss: 0.32685 (QuantReg: 12.26412) QuantErr: 12.26412 batch_time=0.36509 
Train Epoch: 27 [421/1000 13472/32000 (42%)] Loss: 0.29340 (QuantReg: 12.45815) QuantErr: 12.45815 batch_time=0.37859 
Train Epoch: 27 [426/1000 13632/32000 (43%)] Loss: 0.29492 (QuantReg: 12.69807) QuantErr: 12.69807 batch_time=0.40579 
Train Epoch: 27 [431/1000 13792/32000 (43%)] Loss: 0.18163 (QuantReg: 13.34976) QuantErr: 13.34976 batch_time=0.40609 
Train Epoch: 27 [436/1000 13952/32000 (44%)] Loss: 0.36633 (QuantReg: 12.80260) QuantErr: 12.80260 batch_time=0.44407 
Train Epoch: 27 [441/1000 14112/32000 (44%)] Loss: 0.46769 (QuantReg: 12.84102) QuantErr: 12.84102 batch_time=0.76626 
Train Epoch: 27 [446/1000 14272/32000 (45%)] Loss: 0.69240 (QuantReg: 12.89850) QuantErr: 12.89850 batch_time=0.59987 
Train Epoch: 27 [451/1000 14432/32000 (45%)] Loss: 0.56808 (QuantReg: 12.82882) QuantErr: 12.82882 batch_time=0.34275 
Train Epoch: 27 [456/1000 14592/32000 (46%)] Loss: 0.44042 (QuantReg: 13.05752) QuantErr: 13.05752 batch_time=0.52956 
Train Epoch: 27 [461/1000 14752/32000 (46%)] Loss: 0.40431 (QuantReg: 12.29511) QuantErr: 12.29511 batch_time=0.37014 
Train Epoch: 27 [466/1000 14912/32000 (47%)] Loss: 0.18011 (QuantReg: 13.20662) QuantErr: 13.20662 batch_time=0.43834 
Train Epoch: 27 [471/1000 15072/32000 (47%)] Loss: 0.23482 (QuantReg: 12.50537) QuantErr: 12.50537 batch_time=0.37408 
Train Epoch: 27 [476/1000 15232/32000 (48%)] Loss: 0.28641 (QuantReg: 12.82257) QuantErr: 12.82257 batch_time=0.39247 
Train Epoch: 27 [481/1000 15392/32000 (48%)] Loss: 0.31797 (QuantReg: 13.26596) QuantErr: 13.26596 batch_time=0.36362 
Train Epoch: 27 [486/1000 15552/32000 (49%)] Loss: 0.63924 (QuantReg: 13.11487) QuantErr: 13.11487 batch_time=0.37728 
Train Epoch: 27 [491/1000 15712/32000 (49%)] Loss: 0.41129 (QuantReg: 12.59220) QuantErr: 12.59220 batch_time=0.72252 
Train Epoch: 27 [496/1000 15872/32000 (50%)] Loss: 0.14195 (QuantReg: 12.63566) QuantErr: 12.63566 batch_time=0.38386 
Train Epoch: 27 [501/1000 16032/32000 (50%)] Loss: 0.28807 (QuantReg: 12.64010) QuantErr: 12.64010 batch_time=0.33928 
Train Epoch: 27 [506/1000 16192/32000 (51%)] Loss: 0.68815 (QuantReg: 13.34123) QuantErr: 13.34123 batch_time=0.44758 
Train Epoch: 27 [511/1000 16352/32000 (51%)] Loss: 0.37828 (QuantReg: 11.94560) QuantErr: 11.94560 batch_time=0.35545 
Train Epoch: 27 [516/1000 16512/32000 (52%)] Loss: 0.36520 (QuantReg: 12.74517) QuantErr: 12.74517 batch_time=0.36433 
Train Epoch: 27 [521/1000 16672/32000 (52%)] Loss: 0.34966 (QuantReg: 12.78226) QuantErr: 12.78226 batch_time=0.38946 
Train Epoch: 27 [526/1000 16832/32000 (53%)] Loss: 0.29713 (QuantReg: 12.59487) QuantErr: 12.59487 batch_time=0.44549 
Train Epoch: 27 [531/1000 16992/32000 (53%)] Loss: 0.35244 (QuantReg: 12.80575) QuantErr: 12.80575 batch_time=0.39532 
Train Epoch: 27 [536/1000 17152/32000 (54%)] Loss: 0.65062 (QuantReg: 11.90104) QuantErr: 11.90104 batch_time=0.69731 
Train Epoch: 27 [541/1000 17312/32000 (54%)] Loss: 0.17378 (QuantReg: 13.16642) QuantErr: 13.16642 batch_time=0.54634 
Train Epoch: 27 [546/1000 17472/32000 (55%)] Loss: 0.58439 (QuantReg: 12.05175) QuantErr: 12.05175 batch_time=0.34669 
Train Epoch: 27 [551/1000 17632/32000 (55%)] Loss: 0.22166 (QuantReg: 12.72186) QuantErr: 12.72186 batch_time=0.48418 
Train Epoch: 27 [556/1000 17792/32000 (56%)] Loss: 0.53421 (QuantReg: 12.67908) QuantErr: 12.67908 batch_time=0.37726 
Train Epoch: 27 [561/1000 17952/32000 (56%)] Loss: 0.34871 (QuantReg: 13.07652) QuantErr: 13.07652 batch_time=0.43105 
Train Epoch: 27 [566/1000 18112/32000 (57%)] Loss: 0.11710 (QuantReg: 12.93980) QuantErr: 12.93980 batch_time=0.47174 
Train Epoch: 27 [571/1000 18272/32000 (57%)] Loss: 0.22946 (QuantReg: 12.88317) QuantErr: 12.88317 batch_time=0.68903 
Train Epoch: 27 [576/1000 18432/32000 (58%)] Loss: 0.43876 (QuantReg: 12.94890) QuantErr: 12.94890 batch_time=0.47871 
Train Epoch: 27 [581/1000 18592/32000 (58%)] Loss: 0.64475 (QuantReg: 13.19447) QuantErr: 13.19447 batch_time=1.02599 
Train Epoch: 27 [586/1000 18752/32000 (59%)] Loss: 0.15421 (QuantReg: 12.11039) QuantErr: 12.11039 batch_time=0.49455 
Train Epoch: 27 [591/1000 18912/32000 (59%)] Loss: 0.60168 (QuantReg: 12.34467) QuantErr: 12.34467 batch_time=0.55717 
Train Epoch: 27 [596/1000 19072/32000 (60%)] Loss: 0.35911 (QuantReg: 12.88457) QuantErr: 12.88457 batch_time=0.42427 
Train Epoch: 27 [601/1000 19232/32000 (60%)] Loss: 0.59975 (QuantReg: 13.14212) QuantErr: 13.14212 batch_time=0.39110 
Train Epoch: 27 [606/1000 19392/32000 (61%)] Loss: 0.36701 (QuantReg: 12.87094) QuantErr: 12.87094 batch_time=0.45189 
Train Epoch: 27 [611/1000 19552/32000 (61%)] Loss: 0.16881 (QuantReg: 13.55120) QuantErr: 13.55120 batch_time=0.34949 
Train Epoch: 27 [616/1000 19712/32000 (62%)] Loss: 0.33191 (QuantReg: 13.30610) QuantErr: 13.30610 batch_time=0.38281 
Train Epoch: 27 [621/1000 19872/32000 (62%)] Loss: 0.39218 (QuantReg: 12.88324) QuantErr: 12.88324 batch_time=0.36749 
Train Epoch: 27 [626/1000 20032/32000 (63%)] Loss: 0.58853 (QuantReg: 12.74572) QuantErr: 12.74572 batch_time=0.46725 
Train Epoch: 27 [631/1000 20192/32000 (63%)] Loss: 0.09723 (QuantReg: 12.73199) QuantErr: 12.73199 batch_time=0.58598 
Train Epoch: 27 [636/1000 20352/32000 (64%)] Loss: 0.41325 (QuantReg: 13.29349) QuantErr: 13.29349 batch_time=0.35556 
Train Epoch: 27 [641/1000 20512/32000 (64%)] Loss: 0.31179 (QuantReg: 13.45756) QuantErr: 13.45756 batch_time=0.41588 
Train Epoch: 27 [646/1000 20672/32000 (65%)] Loss: 0.64662 (QuantReg: 12.04919) QuantErr: 12.04919 batch_time=0.52409 
Train Epoch: 27 [651/1000 20832/32000 (65%)] Loss: 0.38324 (QuantReg: 12.85790) QuantErr: 12.85790 batch_time=0.37041 
Train Epoch: 27 [656/1000 20992/32000 (66%)] Loss: 0.30244 (QuantReg: 12.91718) QuantErr: 12.91718 batch_time=0.36295 
Train Epoch: 27 [661/1000 21152/32000 (66%)] Loss: 0.30403 (QuantReg: 12.26635) QuantErr: 12.26635 batch_time=0.44334 
Train Epoch: 27 [666/1000 21312/32000 (67%)] Loss: 0.42573 (QuantReg: 12.88638) QuantErr: 12.88638 batch_time=0.36791 
Train Epoch: 27 [671/1000 21472/32000 (67%)] Loss: 0.41211 (QuantReg: 12.72740) QuantErr: 12.72740 batch_time=0.46002 
Train Epoch: 27 [676/1000 21632/32000 (68%)] Loss: 0.24992 (QuantReg: 13.25800) QuantErr: 13.25800 batch_time=0.35118 
Train Epoch: 27 [681/1000 21792/32000 (68%)] Loss: 0.29331 (QuantReg: 12.59658) QuantErr: 12.59658 batch_time=2.11220 
Train Epoch: 27 [686/1000 21952/32000 (69%)] Loss: 0.38620 (QuantReg: 12.94119) QuantErr: 12.94119 batch_time=0.34765 
Train Epoch: 27 [691/1000 22112/32000 (69%)] Loss: 0.27490 (QuantReg: 12.58248) QuantErr: 12.58248 batch_time=0.57425 
Train Epoch: 27 [696/1000 22272/32000 (70%)] Loss: 0.84082 (QuantReg: 12.66061) QuantErr: 12.66061 batch_time=0.34212 
Train Epoch: 27 [701/1000 22432/32000 (70%)] Loss: 0.20137 (QuantReg: 12.40088) QuantErr: 12.40088 batch_time=0.36514 
Train Epoch: 27 [706/1000 22592/32000 (71%)] Loss: 0.43065 (QuantReg: 13.17753) QuantErr: 13.17753 batch_time=0.45149 
Train Epoch: 27 [711/1000 22752/32000 (71%)] Loss: 0.13939 (QuantReg: 12.90439) QuantErr: 12.90439 batch_time=0.37481 
Train Epoch: 27 [716/1000 22912/32000 (72%)] Loss: 0.32643 (QuantReg: 12.50986) QuantErr: 12.50986 batch_time=0.38563 
Train Epoch: 27 [721/1000 23072/32000 (72%)] Loss: 0.22969 (QuantReg: 12.96443) QuantErr: 12.96443 batch_time=0.37864 
Train Epoch: 27 [726/1000 23232/32000 (73%)] Loss: 0.90326 (QuantReg: 13.29196) QuantErr: 13.29196 batch_time=0.62986 
Train Epoch: 27 [731/1000 23392/32000 (73%)] Loss: 0.30980 (QuantReg: 12.16223) QuantErr: 12.16223 batch_time=0.47861 
Train Epoch: 27 [736/1000 23552/32000 (74%)] Loss: 0.37023 (QuantReg: 13.37610) QuantErr: 13.37610 batch_time=0.34581 
Train Epoch: 27 [741/1000 23712/32000 (74%)] Loss: 0.45898 (QuantReg: 13.05492) QuantErr: 13.05492 batch_time=0.46837 
Train Epoch: 27 [746/1000 23872/32000 (75%)] Loss: 0.24156 (QuantReg: 12.67929) QuantErr: 12.67929 batch_time=0.33856 
Train Epoch: 27 [751/1000 24032/32000 (75%)] Loss: 0.37539 (QuantReg: 13.41299) QuantErr: 13.41299 batch_time=0.45034 
Train Epoch: 27 [756/1000 24192/32000 (76%)] Loss: 0.94404 (QuantReg: 12.54411) QuantErr: 12.54411 batch_time=0.44959 
Train Epoch: 27 [761/1000 24352/32000 (76%)] Loss: 0.20858 (QuantReg: 12.70581) QuantErr: 12.70581 batch_time=0.77477 
Train Epoch: 27 [766/1000 24512/32000 (77%)] Loss: 0.32688 (QuantReg: 12.80310) QuantErr: 12.80310 batch_time=0.38192 
Train Epoch: 27 [771/1000 24672/32000 (77%)] Loss: 0.22401 (QuantReg: 12.42959) QuantErr: 12.42959 batch_time=0.36354 
Train Epoch: 27 [776/1000 24832/32000 (78%)] Loss: 0.18820 (QuantReg: 12.78623) QuantErr: 12.78623 batch_time=0.52029 
Train Epoch: 27 [781/1000 24992/32000 (78%)] Loss: 0.51674 (QuantReg: 12.48165) QuantErr: 12.48165 batch_time=0.42804 
Train Epoch: 27 [786/1000 25152/32000 (79%)] Loss: 0.49035 (QuantReg: 12.46198) QuantErr: 12.46198 batch_time=0.42443 
Train Epoch: 27 [791/1000 25312/32000 (79%)] Loss: 0.48997 (QuantReg: 12.82653) QuantErr: 12.82653 batch_time=0.37788 
Train Epoch: 27 [796/1000 25472/32000 (80%)] Loss: 0.38049 (QuantReg: 12.84856) QuantErr: 12.84856 batch_time=0.38239 
Train Epoch: 27 [801/1000 25632/32000 (80%)] Loss: 0.60430 (QuantReg: 11.66895) QuantErr: 11.66895 batch_time=0.36385 
Train Epoch: 27 [806/1000 25792/32000 (81%)] Loss: 0.38194 (QuantReg: 12.39963) QuantErr: 12.39963 batch_time=0.37475 
Train Epoch: 27 [811/1000 25952/32000 (81%)] Loss: 0.31414 (QuantReg: 12.89298) QuantErr: 12.89298 batch_time=0.33372 
Train Epoch: 27 [816/1000 26112/32000 (82%)] Loss: 0.37763 (QuantReg: 12.92838) QuantErr: 12.92838 batch_time=0.34917 
Train Epoch: 27 [821/1000 26272/32000 (82%)] Loss: 0.37404 (QuantReg: 12.74200) QuantErr: 12.74200 batch_time=0.65048 
Train Epoch: 27 [826/1000 26432/32000 (83%)] Loss: 0.31222 (QuantReg: 12.75861) QuantErr: 12.75861 batch_time=0.45979 
Train Epoch: 27 [831/1000 26592/32000 (83%)] Loss: 0.29459 (QuantReg: 13.33988) QuantErr: 13.33988 batch_time=0.33805 
Train Epoch: 27 [836/1000 26752/32000 (84%)] Loss: 0.45915 (QuantReg: 12.13620) QuantErr: 12.13620 batch_time=0.35182 
Train Epoch: 27 [841/1000 26912/32000 (84%)] Loss: 0.35061 (QuantReg: 13.69231) QuantErr: 13.69231 batch_time=0.35748 
Train Epoch: 27 [846/1000 27072/32000 (85%)] Loss: 0.49939 (QuantReg: 12.68340) QuantErr: 12.68340 batch_time=0.35876 
Train Epoch: 27 [851/1000 27232/32000 (85%)] Loss: 0.87681 (QuantReg: 12.47675) QuantErr: 12.47675 batch_time=0.42122 
Train Epoch: 27 [856/1000 27392/32000 (86%)] Loss: 0.48780 (QuantReg: 12.90970) QuantErr: 12.90970 batch_time=0.47143 
Train Epoch: 27 [861/1000 27552/32000 (86%)] Loss: 1.05622 (QuantReg: 11.87185) QuantErr: 11.87185 batch_time=0.37567 
Train Epoch: 27 [866/1000 27712/32000 (87%)] Loss: 0.29599 (QuantReg: 13.26407) QuantErr: 13.26407 batch_time=0.60492 
Train Epoch: 27 [871/1000 27872/32000 (87%)] Loss: 0.44205 (QuantReg: 12.52809) QuantErr: 12.52809 batch_time=0.44745 
Train Epoch: 27 [876/1000 28032/32000 (88%)] Loss: 0.61634 (QuantReg: 12.44767) QuantErr: 12.44767 batch_time=0.37185 
Train Epoch: 27 [881/1000 28192/32000 (88%)] Loss: 0.31419 (QuantReg: 12.86708) QuantErr: 12.86708 batch_time=0.41621 
Train Epoch: 27 [886/1000 28352/32000 (89%)] Loss: 0.44008 (QuantReg: 12.98764) QuantErr: 12.98764 batch_time=0.39450 
Train Epoch: 27 [891/1000 28512/32000 (89%)] Loss: 0.51431 (QuantReg: 13.19456) QuantErr: 13.19456 batch_time=0.40501 
Train Epoch: 27 [896/1000 28672/32000 (90%)] Loss: 0.43634 (QuantReg: 13.42430) QuantErr: 13.42430 batch_time=0.36442 
Train Epoch: 27 [901/1000 28832/32000 (90%)] Loss: 0.15740 (QuantReg: 12.93772) QuantErr: 12.93772 batch_time=0.40160 
Train Epoch: 27 [906/1000 28992/32000 (91%)] Loss: 0.52986 (QuantReg: 12.97164) QuantErr: 12.97164 batch_time=0.72485 
Train Epoch: 27 [911/1000 29152/32000 (91%)] Loss: 0.29227 (QuantReg: 13.20738) QuantErr: 13.20738 batch_time=0.34754 
Train Epoch: 27 [916/1000 29312/32000 (92%)] Loss: 0.46931 (QuantReg: 12.87337) QuantErr: 12.87337 batch_time=0.75691 
Train Epoch: 27 [921/1000 29472/32000 (92%)] Loss: 0.18775 (QuantReg: 12.91465) QuantErr: 12.91465 batch_time=0.41530 
Train Epoch: 27 [926/1000 29632/32000 (93%)] Loss: 0.50094 (QuantReg: 13.14207) QuantErr: 13.14207 batch_time=0.36453 
Train Epoch: 27 [931/1000 29792/32000 (93%)] Loss: 0.91882 (QuantReg: 12.54348) QuantErr: 12.54348 batch_time=0.42744 
Train Epoch: 27 [936/1000 29952/32000 (94%)] Loss: 0.22576 (QuantReg: 12.39371) QuantErr: 12.39371 batch_time=0.38923 
Train Epoch: 27 [941/1000 30112/32000 (94%)] Loss: 0.29679 (QuantReg: 13.77662) QuantErr: 13.77662 batch_time=0.39579 
Train Epoch: 27 [946/1000 30272/32000 (95%)] Loss: 0.47007 (QuantReg: 13.09636) QuantErr: 13.09636 batch_time=0.35479 
Train Epoch: 27 [951/1000 30432/32000 (95%)] Loss: 0.14745 (QuantReg: 13.03240) QuantErr: 13.03240 batch_time=0.34671 
Train Epoch: 27 [956/1000 30592/32000 (96%)] Loss: 0.53946 (QuantReg: 12.66890) QuantErr: 12.66890 batch_time=0.44116 
Train Epoch: 27 [961/1000 30752/32000 (96%)] Loss: 0.43526 (QuantReg: 12.56548) QuantErr: 12.56548 batch_time=0.40346 
Train Epoch: 27 [966/1000 30912/32000 (97%)] Loss: 0.69505 (QuantReg: 12.99574) QuantErr: 12.99574 batch_time=0.49704 
Train Epoch: 27 [971/1000 31072/32000 (97%)] Loss: 0.39173 (QuantReg: 12.21762) QuantErr: 12.21762 batch_time=0.45964 
Train Epoch: 27 [976/1000 31232/32000 (98%)] Loss: 0.36121 (QuantReg: 12.86553) QuantErr: 12.86553 batch_time=0.42390 
Train Epoch: 27 [981/1000 31392/32000 (98%)] Loss: 1.21991 (QuantReg: 12.48410) QuantErr: 12.48410 batch_time=0.37657 
Train Epoch: 27 [986/1000 31552/32000 (99%)] Loss: 0.40320 (QuantReg: 13.16717) QuantErr: 13.16717 batch_time=0.45388 
Train Epoch: 27 [991/1000 31712/32000 (99%)] Loss: 0.18601 (QuantReg: 12.32673) QuantErr: 12.32673 batch_time=0.34491 
Train Epoch: 27 [996/1000 31872/32000 (100%)] Loss: 0.69868 (QuantReg: 13.13357) QuantErr: 13.13357 batch_time=0.37138 
Train Epoch: 27 codebook_update_time=2.40424
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch27.pth ...
Done in 4.909s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 0.39070262987166643
 quant_reg      : 12.772665595054626
 quant_err      : 12.772665595054626
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 27000
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 48.6
 MSRVTT_miech_test/t2v_metrics/R10: 62.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.607
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.179644610281265
 MSRVTT_miech_test/v2t_metrics/R1: 20.2
 MSRVTT_miech_test/v2t_metrics/R5: 51.0
 MSRVTT_miech_test/v2t_metrics/R10: 64.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.132
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.398679824847115
 mnt_best       : 39.24676668836643
 not_improved_count: 2
Train Epoch: 28 [1/1000 32/32000 (0%)] Loss: 0.32823 (QuantReg: 12.61120) QuantErr: 12.61120 batch_time=29.24354 
Train Epoch: 28 [6/1000 192/32000 (1%)] Loss: 0.40472 (QuantReg: 13.03602) QuantErr: 13.03602 batch_time=0.97356 
Train Epoch: 28 [11/1000 352/32000 (1%)] Loss: 0.63921 (QuantReg: 12.46820) QuantErr: 12.46820 batch_time=0.41187 
Train Epoch: 28 [16/1000 512/32000 (2%)] Loss: 0.36789 (QuantReg: 12.25032) QuantErr: 12.25032 batch_time=0.37266 
Train Epoch: 28 [21/1000 672/32000 (2%)] Loss: 0.35937 (QuantReg: 13.20130) QuantErr: 13.20130 batch_time=0.47711 
Train Epoch: 28 [26/1000 832/32000 (3%)] Loss: 0.43421 (QuantReg: 12.43519) QuantErr: 12.43519 batch_time=0.42042 
Train Epoch: 28 [31/1000 992/32000 (3%)] Loss: 0.23415 (QuantReg: 12.74891) QuantErr: 12.74891 batch_time=0.37519 
Train Epoch: 28 [36/1000 1152/32000 (4%)] Loss: 0.52560 (QuantReg: 12.81335) QuantErr: 12.81335 batch_time=0.35048 
Train Epoch: 28 [41/1000 1312/32000 (4%)] Loss: 0.74594 (QuantReg: 12.55540) QuantErr: 12.55540 batch_time=0.44314 
Train Epoch: 28 [46/1000 1472/32000 (5%)] Loss: 0.45839 (QuantReg: 12.83233) QuantErr: 12.83233 batch_time=0.34572 
Train Epoch: 28 [51/1000 1632/32000 (5%)] Loss: 0.26335 (QuantReg: 12.84520) QuantErr: 12.84520 batch_time=0.87105 
Train Epoch: 28 [56/1000 1792/32000 (6%)] Loss: 0.44074 (QuantReg: 12.42710) QuantErr: 12.42710 batch_time=0.36791 
Train Epoch: 28 [61/1000 1952/32000 (6%)] Loss: 0.47024 (QuantReg: 12.66026) QuantErr: 12.66026 batch_time=0.55745 
Train Epoch: 28 [66/1000 2112/32000 (7%)] Loss: 0.34018 (QuantReg: 12.51231) QuantErr: 12.51231 batch_time=0.39721 
Train Epoch: 28 [71/1000 2272/32000 (7%)] Loss: 0.24425 (QuantReg: 12.58749) QuantErr: 12.58749 batch_time=0.45555 
Train Epoch: 28 [76/1000 2432/32000 (8%)] Loss: 0.41589 (QuantReg: 12.68551) QuantErr: 12.68551 batch_time=0.52443 
Train Epoch: 28 [81/1000 2592/32000 (8%)] Loss: 0.40015 (QuantReg: 13.01424) QuantErr: 13.01424 batch_time=0.75168 
Train Epoch: 28 [86/1000 2752/32000 (9%)] Loss: 0.55900 (QuantReg: 12.26686) QuantErr: 12.26686 batch_time=0.50835 
Train Epoch: 28 [91/1000 2912/32000 (9%)] Loss: 0.36300 (QuantReg: 12.52461) QuantErr: 12.52461 batch_time=0.61025 
Train Epoch: 28 [96/1000 3072/32000 (10%)] Loss: 0.30507 (QuantReg: 12.76973) QuantErr: 12.76973 batch_time=0.49869 
Train Epoch: 28 [101/1000 3232/32000 (10%)] Loss: 0.26391 (QuantReg: 12.55427) QuantErr: 12.55427 batch_time=0.36103 
Train Epoch: 28 [106/1000 3392/32000 (11%)] Loss: 0.66793 (QuantReg: 12.21429) QuantErr: 12.21429 batch_time=0.38360 
Train Epoch: 28 [111/1000 3552/32000 (11%)] Loss: 0.44047 (QuantReg: 12.57549) QuantErr: 12.57549 batch_time=0.40437 
Train Epoch: 28 [116/1000 3712/32000 (12%)] Loss: 0.16847 (QuantReg: 13.22942) QuantErr: 13.22942 batch_time=0.36339 
Train Epoch: 28 [121/1000 3872/32000 (12%)] Loss: 0.29405 (QuantReg: 13.30255) QuantErr: 13.30255 batch_time=0.36116 
Train Epoch: 28 [126/1000 4032/32000 (13%)] Loss: 0.32265 (QuantReg: 12.57479) QuantErr: 12.57479 batch_time=0.48067 
Train Epoch: 28 [131/1000 4192/32000 (13%)] Loss: 0.48949 (QuantReg: 13.04582) QuantErr: 13.04582 batch_time=0.53321 
Train Epoch: 28 [136/1000 4352/32000 (14%)] Loss: 0.36168 (QuantReg: 11.92851) QuantErr: 11.92851 batch_time=0.36387 
Train Epoch: 28 [141/1000 4512/32000 (14%)] Loss: 0.20045 (QuantReg: 13.02158) QuantErr: 13.02158 batch_time=0.45902 
Train Epoch: 28 [146/1000 4672/32000 (15%)] Loss: 0.27750 (QuantReg: 12.64963) QuantErr: 12.64963 batch_time=0.37450 
Train Epoch: 28 [151/1000 4832/32000 (15%)] Loss: 0.34547 (QuantReg: 12.28790) QuantErr: 12.28790 batch_time=0.39074 
Train Epoch: 28 [156/1000 4992/32000 (16%)] Loss: 0.33558 (QuantReg: 12.91579) QuantErr: 12.91579 batch_time=0.33239 
Train Epoch: 28 [161/1000 5152/32000 (16%)] Loss: 0.31441 (QuantReg: 13.00377) QuantErr: 13.00377 batch_time=0.73646 
Train Epoch: 28 [166/1000 5312/32000 (17%)] Loss: 0.33937 (QuantReg: 13.10249) QuantErr: 13.10249 batch_time=0.33940 
Train Epoch: 28 [171/1000 5472/32000 (17%)] Loss: 0.15190 (QuantReg: 12.96918) QuantErr: 12.96918 batch_time=0.35620 
Train Epoch: 28 [176/1000 5632/32000 (18%)] Loss: 0.10166 (QuantReg: 13.36368) QuantErr: 13.36368 batch_time=0.42377 
Train Epoch: 28 [181/1000 5792/32000 (18%)] Loss: 0.34103 (QuantReg: 12.59660) QuantErr: 12.59660 batch_time=0.35427 
Train Epoch: 28 [186/1000 5952/32000 (19%)] Loss: 0.14887 (QuantReg: 12.66136) QuantErr: 12.66136 batch_time=0.38310 
Train Epoch: 28 [191/1000 6112/32000 (19%)] Loss: 0.39264 (QuantReg: 12.99162) QuantErr: 12.99162 batch_time=0.34161 
Train Epoch: 28 [196/1000 6272/32000 (20%)] Loss: 0.30571 (QuantReg: 12.75679) QuantErr: 12.75679 batch_time=0.37591 
Train Epoch: 28 [201/1000 6432/32000 (20%)] Loss: 0.46200 (QuantReg: 12.42355) QuantErr: 12.42355 batch_time=0.75348 
Train Epoch: 28 [206/1000 6592/32000 (21%)] Loss: 0.22416 (QuantReg: 13.00268) QuantErr: 13.00268 batch_time=0.34530 
Train Epoch: 28 [211/1000 6752/32000 (21%)] Loss: 0.15374 (QuantReg: 12.93917) QuantErr: 12.93917 batch_time=0.34242 
Train Epoch: 28 [216/1000 6912/32000 (22%)] Loss: 0.40529 (QuantReg: 13.07405) QuantErr: 13.07405 batch_time=0.44426 
Train Epoch: 28 [221/1000 7072/32000 (22%)] Loss: 0.40691 (QuantReg: 12.40435) QuantErr: 12.40435 batch_time=0.44741 
Train Epoch: 28 [226/1000 7232/32000 (23%)] Loss: 0.60407 (QuantReg: 12.74111) QuantErr: 12.74111 batch_time=0.35313 
Train Epoch: 28 [231/1000 7392/32000 (23%)] Loss: 0.58072 (QuantReg: 12.12979) QuantErr: 12.12979 batch_time=0.39699 
Train Epoch: 28 [236/1000 7552/32000 (24%)] Loss: 0.44025 (QuantReg: 12.58323) QuantErr: 12.58323 batch_time=0.57240 
Train Epoch: 28 [241/1000 7712/32000 (24%)] Loss: 0.48441 (QuantReg: 13.02135) QuantErr: 13.02135 batch_time=0.33964 
Train Epoch: 28 [246/1000 7872/32000 (25%)] Loss: 0.51558 (QuantReg: 12.57675) QuantErr: 12.57675 batch_time=0.63794 
Train Epoch: 28 [251/1000 8032/32000 (25%)] Loss: 0.64429 (QuantReg: 12.75578) QuantErr: 12.75578 batch_time=0.58592 
Train Epoch: 28 [256/1000 8192/32000 (26%)] Loss: 0.89401 (QuantReg: 12.71674) QuantErr: 12.71674 batch_time=0.57695 
Train Epoch: 28 [261/1000 8352/32000 (26%)] Loss: 0.21858 (QuantReg: 12.71847) QuantErr: 12.71847 batch_time=0.36503 
Train Epoch: 28 [266/1000 8512/32000 (27%)] Loss: 0.51950 (QuantReg: 12.49155) QuantErr: 12.49155 batch_time=0.42359 
Train Epoch: 28 [271/1000 8672/32000 (27%)] Loss: 0.15984 (QuantReg: 12.71776) QuantErr: 12.71776 batch_time=0.36704 
Train Epoch: 28 [276/1000 8832/32000 (28%)] Loss: 0.46966 (QuantReg: 13.16784) QuantErr: 13.16784 batch_time=0.89957 
Train Epoch: 28 [281/1000 8992/32000 (28%)] Loss: 0.47189 (QuantReg: 12.40307) QuantErr: 12.40307 batch_time=0.34530 
Train Epoch: 28 [286/1000 9152/32000 (29%)] Loss: 0.37372 (QuantReg: 12.74327) QuantErr: 12.74327 batch_time=0.37155 
Train Epoch: 28 [291/1000 9312/32000 (29%)] Loss: 0.23731 (QuantReg: 12.67735) QuantErr: 12.67735 batch_time=0.36375 
Train Epoch: 28 [296/1000 9472/32000 (30%)] Loss: 0.55622 (QuantReg: 12.02348) QuantErr: 12.02348 batch_time=0.46865 
Train Epoch: 28 [301/1000 9632/32000 (30%)] Loss: 0.27596 (QuantReg: 13.13332) QuantErr: 13.13332 batch_time=0.36451 
Train Epoch: 28 [306/1000 9792/32000 (31%)] Loss: 0.41178 (QuantReg: 12.39564) QuantErr: 12.39564 batch_time=0.46697 
Train Epoch: 28 [311/1000 9952/32000 (31%)] Loss: 0.40590 (QuantReg: 12.75109) QuantErr: 12.75109 batch_time=0.35243 
Train Epoch: 28 [316/1000 10112/32000 (32%)] Loss: 0.20075 (QuantReg: 12.87734) QuantErr: 12.87734 batch_time=0.34718 
Train Epoch: 28 [321/1000 10272/32000 (32%)] Loss: 0.56197 (QuantReg: 12.62766) QuantErr: 12.62766 batch_time=0.41450 
Train Epoch: 28 [326/1000 10432/32000 (33%)] Loss: 0.39157 (QuantReg: 12.86391) QuantErr: 12.86391 batch_time=0.47154 
Train Epoch: 28 [331/1000 10592/32000 (33%)] Loss: 0.22087 (QuantReg: 12.53545) QuantErr: 12.53545 batch_time=0.33638 
Train Epoch: 28 [336/1000 10752/32000 (34%)] Loss: 0.23403 (QuantReg: 12.63427) QuantErr: 12.63427 batch_time=0.34106 
Train Epoch: 28 [341/1000 10912/32000 (34%)] Loss: 0.56692 (QuantReg: 12.24862) QuantErr: 12.24862 batch_time=0.36306 
Train Epoch: 28 [346/1000 11072/32000 (35%)] Loss: 0.28867 (QuantReg: 12.43597) QuantErr: 12.43597 batch_time=0.41075 
Train Epoch: 28 [351/1000 11232/32000 (35%)] Loss: 0.60594 (QuantReg: 12.66648) QuantErr: 12.66648 batch_time=0.42270 
Train Epoch: 28 [356/1000 11392/32000 (36%)] Loss: 0.51963 (QuantReg: 12.35580) QuantErr: 12.35580 batch_time=0.45749 
Train Epoch: 28 [361/1000 11552/32000 (36%)] Loss: 0.12299 (QuantReg: 12.43106) QuantErr: 12.43106 batch_time=0.35678 
Train Epoch: 28 [366/1000 11712/32000 (37%)] Loss: 0.54801 (QuantReg: 12.12083) QuantErr: 12.12083 batch_time=0.46772 
Train Epoch: 28 [371/1000 11872/32000 (37%)] Loss: 0.33471 (QuantReg: 12.60794) QuantErr: 12.60794 batch_time=0.34468 
Train Epoch: 28 [376/1000 12032/32000 (38%)] Loss: 0.48204 (QuantReg: 13.27221) QuantErr: 13.27221 batch_time=0.35303 
Train Epoch: 28 [381/1000 12192/32000 (38%)] Loss: 0.12349 (QuantReg: 13.10909) QuantErr: 13.10909 batch_time=0.42150 
Train Epoch: 28 [386/1000 12352/32000 (39%)] Loss: 0.18858 (QuantReg: 13.71528) QuantErr: 13.71528 batch_time=0.37059 
Train Epoch: 28 [391/1000 12512/32000 (39%)] Loss: 0.44575 (QuantReg: 11.72184) QuantErr: 11.72184 batch_time=0.50069 
Train Epoch: 28 [396/1000 12672/32000 (40%)] Loss: 0.77310 (QuantReg: 11.62214) QuantErr: 11.62214 batch_time=0.34110 
Train Epoch: 28 [401/1000 12832/32000 (40%)] Loss: 0.30582 (QuantReg: 12.99761) QuantErr: 12.99761 batch_time=0.74046 
Train Epoch: 28 [406/1000 12992/32000 (41%)] Loss: 0.20220 (QuantReg: 12.95035) QuantErr: 12.95035 batch_time=0.34847 
Train Epoch: 28 [411/1000 13152/32000 (41%)] Loss: 0.35159 (QuantReg: 13.40616) QuantErr: 13.40616 batch_time=0.37018 
Train Epoch: 28 [416/1000 13312/32000 (42%)] Loss: 0.30098 (QuantReg: 13.31217) QuantErr: 13.31217 batch_time=0.35217 
Train Epoch: 28 [421/1000 13472/32000 (42%)] Loss: 0.64456 (QuantReg: 13.22423) QuantErr: 13.22423 batch_time=0.33937 
Train Epoch: 28 [426/1000 13632/32000 (43%)] Loss: 0.25831 (QuantReg: 11.95352) QuantErr: 11.95352 batch_time=0.34899 
Train Epoch: 28 [431/1000 13792/32000 (43%)] Loss: 0.44149 (QuantReg: 13.16897) QuantErr: 13.16897 batch_time=0.38571 
Train Epoch: 28 [436/1000 13952/32000 (44%)] Loss: 0.72954 (QuantReg: 11.98342) QuantErr: 11.98342 batch_time=0.34245 
Train Epoch: 28 [441/1000 14112/32000 (44%)] Loss: 0.67557 (QuantReg: 13.24538) QuantErr: 13.24538 batch_time=0.39304 
Train Epoch: 28 [446/1000 14272/32000 (45%)] Loss: 0.26326 (QuantReg: 12.56292) QuantErr: 12.56292 batch_time=0.43347 
Train Epoch: 28 [451/1000 14432/32000 (45%)] Loss: 0.23039 (QuantReg: 13.20852) QuantErr: 13.20852 batch_time=2.28515 
Train Epoch: 28 [456/1000 14592/32000 (46%)] Loss: 0.32654 (QuantReg: 12.63801) QuantErr: 12.63801 batch_time=0.53808 
Train Epoch: 28 [461/1000 14752/32000 (46%)] Loss: 0.55498 (QuantReg: 12.92032) QuantErr: 12.92032 batch_time=0.36280 
Train Epoch: 28 [466/1000 14912/32000 (47%)] Loss: 0.40924 (QuantReg: 12.52391) QuantErr: 12.52391 batch_time=0.46570 
Train Epoch: 28 [471/1000 15072/32000 (47%)] Loss: 0.42513 (QuantReg: 12.40783) QuantErr: 12.40783 batch_time=0.37311 
Train Epoch: 28 [476/1000 15232/32000 (48%)] Loss: 0.64369 (QuantReg: 12.86366) QuantErr: 12.86366 batch_time=0.44432 
Train Epoch: 28 [481/1000 15392/32000 (48%)] Loss: 0.26428 (QuantReg: 13.11213) QuantErr: 13.11213 batch_time=0.36182 
Train Epoch: 28 [486/1000 15552/32000 (49%)] Loss: 0.43608 (QuantReg: 13.05161) QuantErr: 13.05161 batch_time=0.36621 
Train Epoch: 28 [491/1000 15712/32000 (49%)] Loss: 0.50673 (QuantReg: 12.76667) QuantErr: 12.76667 batch_time=0.71634 
Train Epoch: 28 [496/1000 15872/32000 (50%)] Loss: 0.56866 (QuantReg: 13.48338) QuantErr: 13.48338 batch_time=0.35628 
Train Epoch: 28 [501/1000 16032/32000 (50%)] Loss: 0.41576 (QuantReg: 13.01726) QuantErr: 13.01726 batch_time=0.79153 
Train Epoch: 28 [506/1000 16192/32000 (51%)] Loss: 0.44683 (QuantReg: 12.59668) QuantErr: 12.59668 batch_time=0.40763 
Train Epoch: 28 [511/1000 16352/32000 (51%)] Loss: 0.11425 (QuantReg: 13.51517) QuantErr: 13.51517 batch_time=0.34487 
Train Epoch: 28 [516/1000 16512/32000 (52%)] Loss: 0.14023 (QuantReg: 12.68560) QuantErr: 12.68560 batch_time=0.34328 
Train Epoch: 28 [521/1000 16672/32000 (52%)] Loss: 0.11094 (QuantReg: 13.46113) QuantErr: 13.46113 batch_time=0.35097 
Train Epoch: 28 [526/1000 16832/32000 (53%)] Loss: 0.92250 (QuantReg: 12.14712) QuantErr: 12.14712 batch_time=0.36243 
Train Epoch: 28 [531/1000 16992/32000 (53%)] Loss: 0.32279 (QuantReg: 12.70618) QuantErr: 12.70618 batch_time=0.38478 
Train Epoch: 28 [536/1000 17152/32000 (54%)] Loss: 0.72728 (QuantReg: 12.96622) QuantErr: 12.96622 batch_time=0.36799 
Train Epoch: 28 [541/1000 17312/32000 (54%)] Loss: 0.39126 (QuantReg: 13.18228) QuantErr: 13.18228 batch_time=0.36496 
Train Epoch: 28 [546/1000 17472/32000 (55%)] Loss: 0.34085 (QuantReg: 13.22127) QuantErr: 13.22127 batch_time=0.64369 
Train Epoch: 28 [551/1000 17632/32000 (55%)] Loss: 0.93063 (QuantReg: 12.52541) QuantErr: 12.52541 batch_time=0.56094 
Train Epoch: 28 [556/1000 17792/32000 (56%)] Loss: 0.50396 (QuantReg: 12.65415) QuantErr: 12.65415 batch_time=0.41376 
Train Epoch: 28 [561/1000 17952/32000 (56%)] Loss: 0.34826 (QuantReg: 12.76814) QuantErr: 12.76814 batch_time=0.44693 
Train Epoch: 28 [566/1000 18112/32000 (57%)] Loss: 0.20074 (QuantReg: 12.93200) QuantErr: 12.93200 batch_time=0.35032 
Train Epoch: 28 [571/1000 18272/32000 (57%)] Loss: 0.44577 (QuantReg: 12.80844) QuantErr: 12.80844 batch_time=0.36485 
Train Epoch: 28 [576/1000 18432/32000 (58%)] Loss: 0.18634 (QuantReg: 12.96212) QuantErr: 12.96212 batch_time=0.35952 
Train Epoch: 28 [581/1000 18592/32000 (58%)] Loss: 0.48547 (QuantReg: 13.35909) QuantErr: 13.35909 batch_time=0.34587 
Train Epoch: 28 [586/1000 18752/32000 (59%)] Loss: 0.32270 (QuantReg: 12.67847) QuantErr: 12.67847 batch_time=0.35689 
Train Epoch: 28 [591/1000 18912/32000 (59%)] Loss: 0.44766 (QuantReg: 13.07513) QuantErr: 13.07513 batch_time=0.34101 
Train Epoch: 28 [596/1000 19072/32000 (60%)] Loss: 0.53962 (QuantReg: 12.37514) QuantErr: 12.37514 batch_time=0.43506 
Train Epoch: 28 [601/1000 19232/32000 (60%)] Loss: 0.30427 (QuantReg: 12.99379) QuantErr: 12.99379 batch_time=0.39851 
Train Epoch: 28 [606/1000 19392/32000 (61%)] Loss: 0.54506 (QuantReg: 12.33973) QuantErr: 12.33973 batch_time=0.35158 
Train Epoch: 28 [611/1000 19552/32000 (61%)] Loss: 0.27530 (QuantReg: 12.93317) QuantErr: 12.93317 batch_time=0.36448 
Train Epoch: 28 [616/1000 19712/32000 (62%)] Loss: 0.51606 (QuantReg: 13.58702) QuantErr: 13.58702 batch_time=0.37414 
Train Epoch: 28 [621/1000 19872/32000 (62%)] Loss: 0.64786 (QuantReg: 12.46319) QuantErr: 12.46319 batch_time=0.44171 
Train Epoch: 28 [626/1000 20032/32000 (63%)] Loss: 0.33824 (QuantReg: 12.50591) QuantErr: 12.50591 batch_time=0.45343 
Train Epoch: 28 [631/1000 20192/32000 (63%)] Loss: 0.33628 (QuantReg: 12.62197) QuantErr: 12.62197 batch_time=0.36690 
Train Epoch: 28 [636/1000 20352/32000 (64%)] Loss: 0.32539 (QuantReg: 12.62912) QuantErr: 12.62912 batch_time=0.44321 
Train Epoch: 28 [641/1000 20512/32000 (64%)] Loss: 0.26430 (QuantReg: 11.99638) QuantErr: 11.99638 batch_time=0.43192 
Train Epoch: 28 [646/1000 20672/32000 (65%)] Loss: 0.28983 (QuantReg: 12.74339) QuantErr: 12.74339 batch_time=0.63928 
Train Epoch: 28 [651/1000 20832/32000 (65%)] Loss: 0.40880 (QuantReg: 12.84220) QuantErr: 12.84220 batch_time=0.40449 
Train Epoch: 28 [656/1000 20992/32000 (66%)] Loss: 0.36290 (QuantReg: 12.31314) QuantErr: 12.31314 batch_time=0.43775 
Train Epoch: 28 [661/1000 21152/32000 (66%)] Loss: 0.20811 (QuantReg: 13.01826) QuantErr: 13.01826 batch_time=0.37736 
Train Epoch: 28 [666/1000 21312/32000 (67%)] Loss: 0.83707 (QuantReg: 12.99067) QuantErr: 12.99067 batch_time=0.40712 
Train Epoch: 28 [671/1000 21472/32000 (67%)] Loss: 0.23511 (QuantReg: 13.21271) QuantErr: 13.21271 batch_time=0.39417 
Train Epoch: 28 [676/1000 21632/32000 (68%)] Loss: 0.15862 (QuantReg: 12.91854) QuantErr: 12.91854 batch_time=0.38197 
Train Epoch: 28 [681/1000 21792/32000 (68%)] Loss: 0.46205 (QuantReg: 12.30688) QuantErr: 12.30688 batch_time=0.37985 
Train Epoch: 28 [686/1000 21952/32000 (69%)] Loss: 0.32125 (QuantReg: 12.39233) QuantErr: 12.39233 batch_time=0.34043 
Train Epoch: 28 [691/1000 22112/32000 (69%)] Loss: 0.28414 (QuantReg: 12.80932) QuantErr: 12.80932 batch_time=0.65027 
Train Epoch: 28 [696/1000 22272/32000 (70%)] Loss: 0.35354 (QuantReg: 13.07957) QuantErr: 13.07957 batch_time=0.61534 
Train Epoch: 28 [701/1000 22432/32000 (70%)] Loss: 0.15817 (QuantReg: 13.08143) QuantErr: 13.08143 batch_time=0.36751 
Train Epoch: 28 [706/1000 22592/32000 (71%)] Loss: 0.63926 (QuantReg: 12.85097) QuantErr: 12.85097 batch_time=0.39908 
Train Epoch: 28 [711/1000 22752/32000 (71%)] Loss: 0.23803 (QuantReg: 13.78434) QuantErr: 13.78434 batch_time=0.41431 
Train Epoch: 28 [716/1000 22912/32000 (72%)] Loss: 0.84458 (QuantReg: 12.49000) QuantErr: 12.49000 batch_time=0.38725 
Train Epoch: 28 [721/1000 23072/32000 (72%)] Loss: 0.57276 (QuantReg: 12.53175) QuantErr: 12.53175 batch_time=0.38944 
Train Epoch: 28 [726/1000 23232/32000 (73%)] Loss: 0.46363 (QuantReg: 12.80700) QuantErr: 12.80700 batch_time=0.35384 
Train Epoch: 28 [731/1000 23392/32000 (73%)] Loss: 0.49733 (QuantReg: 11.89642) QuantErr: 11.89642 batch_time=0.39041 
Train Epoch: 28 [736/1000 23552/32000 (74%)] Loss: 0.15192 (QuantReg: 13.35720) QuantErr: 13.35720 batch_time=0.35276 
Train Epoch: 28 [741/1000 23712/32000 (74%)] Loss: 0.39785 (QuantReg: 12.97221) QuantErr: 12.97221 batch_time=0.73957 
Train Epoch: 28 [746/1000 23872/32000 (75%)] Loss: 0.19323 (QuantReg: 12.82170) QuantErr: 12.82170 batch_time=0.41732 
Train Epoch: 28 [751/1000 24032/32000 (75%)] Loss: 0.24695 (QuantReg: 12.29754) QuantErr: 12.29754 batch_time=0.42754 
Train Epoch: 28 [756/1000 24192/32000 (76%)] Loss: 0.62650 (QuantReg: 12.95813) QuantErr: 12.95813 batch_time=0.34719 
Train Epoch: 28 [761/1000 24352/32000 (76%)] Loss: 0.18593 (QuantReg: 12.81436) QuantErr: 12.81436 batch_time=0.36240 
Train Epoch: 28 [766/1000 24512/32000 (77%)] Loss: 0.61436 (QuantReg: 12.95885) QuantErr: 12.95885 batch_time=0.46201 
Train Epoch: 28 [771/1000 24672/32000 (77%)] Loss: 0.58451 (QuantReg: 12.59814) QuantErr: 12.59814 batch_time=2.07264 
Train Epoch: 28 [776/1000 24832/32000 (78%)] Loss: 0.68521 (QuantReg: 13.16451) QuantErr: 13.16451 batch_time=0.36686 
Train Epoch: 28 [781/1000 24992/32000 (78%)] Loss: 0.46980 (QuantReg: 12.91498) QuantErr: 12.91498 batch_time=0.37531 
Train Epoch: 28 [786/1000 25152/32000 (79%)] Loss: 0.36197 (QuantReg: 12.95928) QuantErr: 12.95928 batch_time=1.11669 
Train Epoch: 28 [791/1000 25312/32000 (79%)] Loss: 0.29326 (QuantReg: 13.01437) QuantErr: 13.01437 batch_time=0.51990 
Train Epoch: 28 [796/1000 25472/32000 (80%)] Loss: 0.28657 (QuantReg: 12.95214) QuantErr: 12.95214 batch_time=0.36074 
Train Epoch: 28 [801/1000 25632/32000 (80%)] Loss: 0.54751 (QuantReg: 12.65391) QuantErr: 12.65391 batch_time=0.42331 
Train Epoch: 28 [806/1000 25792/32000 (81%)] Loss: 0.51450 (QuantReg: 12.74067) QuantErr: 12.74067 batch_time=0.34121 
Train Epoch: 28 [811/1000 25952/32000 (81%)] Loss: 0.53201 (QuantReg: 13.14034) QuantErr: 13.14034 batch_time=0.33815 
Train Epoch: 28 [816/1000 26112/32000 (82%)] Loss: 0.44294 (QuantReg: 13.39483) QuantErr: 13.39483 batch_time=0.35604 
Train Epoch: 28 [821/1000 26272/32000 (82%)] Loss: 0.56165 (QuantReg: 12.61401) QuantErr: 12.61401 batch_time=0.35185 
Train Epoch: 28 [826/1000 26432/32000 (83%)] Loss: 0.26627 (QuantReg: 13.41671) QuantErr: 13.41671 batch_time=0.36063 
Train Epoch: 28 [831/1000 26592/32000 (83%)] Loss: 0.80152 (QuantReg: 12.63041) QuantErr: 12.63041 batch_time=0.46732 
Train Epoch: 28 [836/1000 26752/32000 (84%)] Loss: 0.52769 (QuantReg: 13.01073) QuantErr: 13.01073 batch_time=0.79094 
Train Epoch: 28 [841/1000 26912/32000 (84%)] Loss: 0.16251 (QuantReg: 12.98935) QuantErr: 12.98935 batch_time=0.38356 
Train Epoch: 28 [846/1000 27072/32000 (85%)] Loss: 0.41994 (QuantReg: 13.32758) QuantErr: 13.32758 batch_time=0.37857 
Train Epoch: 28 [851/1000 27232/32000 (85%)] Loss: 0.98336 (QuantReg: 13.26005) QuantErr: 13.26005 batch_time=0.36842 
Train Epoch: 28 [856/1000 27392/32000 (86%)] Loss: 0.35010 (QuantReg: 12.98042) QuantErr: 12.98042 batch_time=0.35171 
Train Epoch: 28 [861/1000 27552/32000 (86%)] Loss: 0.35789 (QuantReg: 12.88297) QuantErr: 12.88297 batch_time=0.34711 
Train Epoch: 28 [866/1000 27712/32000 (87%)] Loss: 0.38282 (QuantReg: 12.29597) QuantErr: 12.29597 batch_time=0.41339 
Train Epoch: 28 [871/1000 27872/32000 (87%)] Loss: 0.30145 (QuantReg: 12.75353) QuantErr: 12.75353 batch_time=0.49150 
Train Epoch: 28 [876/1000 28032/32000 (88%)] Loss: 0.28126 (QuantReg: 12.78799) QuantErr: 12.78799 batch_time=0.35719 
Train Epoch: 28 [881/1000 28192/32000 (88%)] Loss: 0.30675 (QuantReg: 12.95827) QuantErr: 12.95827 batch_time=0.37892 
Train Epoch: 28 [886/1000 28352/32000 (89%)] Loss: 0.38690 (QuantReg: 12.80673) QuantErr: 12.80673 batch_time=0.40360 
Train Epoch: 28 [891/1000 28512/32000 (89%)] Loss: 0.19224 (QuantReg: 12.85617) QuantErr: 12.85617 batch_time=0.64218 
Train Epoch: 28 [896/1000 28672/32000 (90%)] Loss: 0.50763 (QuantReg: 11.99064) QuantErr: 11.99064 batch_time=0.47191 
Train Epoch: 28 [901/1000 28832/32000 (90%)] Loss: 0.17328 (QuantReg: 13.16875) QuantErr: 13.16875 batch_time=0.43895 
Train Epoch: 28 [906/1000 28992/32000 (91%)] Loss: 0.36484 (QuantReg: 13.34339) QuantErr: 13.34339 batch_time=0.36238 
Train Epoch: 28 [911/1000 29152/32000 (91%)] Loss: 0.78837 (QuantReg: 12.48794) QuantErr: 12.48794 batch_time=0.35764 
Train Epoch: 28 [916/1000 29312/32000 (92%)] Loss: 0.33892 (QuantReg: 13.28722) QuantErr: 13.28722 batch_time=0.43742 
Train Epoch: 28 [921/1000 29472/32000 (92%)] Loss: 0.36476 (QuantReg: 12.92149) QuantErr: 12.92149 batch_time=0.35224 
Train Epoch: 28 [926/1000 29632/32000 (93%)] Loss: 0.29206 (QuantReg: 12.42063) QuantErr: 12.42063 batch_time=0.46597 
Train Epoch: 28 [931/1000 29792/32000 (93%)] Loss: 0.18489 (QuantReg: 13.30039) QuantErr: 13.30039 batch_time=0.35294 
Train Epoch: 28 [936/1000 29952/32000 (94%)] Loss: 0.70731 (QuantReg: 11.89559) QuantErr: 11.89559 batch_time=0.69040 
Train Epoch: 28 [941/1000 30112/32000 (94%)] Loss: 0.27884 (QuantReg: 12.59712) QuantErr: 12.59712 batch_time=0.37153 
Train Epoch: 28 [946/1000 30272/32000 (95%)] Loss: 0.31497 (QuantReg: 13.10780) QuantErr: 13.10780 batch_time=0.35321 
Train Epoch: 28 [951/1000 30432/32000 (95%)] Loss: 0.29041 (QuantReg: 12.45941) QuantErr: 12.45941 batch_time=0.37472 
Train Epoch: 28 [956/1000 30592/32000 (96%)] Loss: 0.25901 (QuantReg: 12.58818) QuantErr: 12.58818 batch_time=0.35505 
Train Epoch: 28 [961/1000 30752/32000 (96%)] Loss: 0.42083 (QuantReg: 12.50029) QuantErr: 12.50029 batch_time=0.41501 
Train Epoch: 28 [966/1000 30912/32000 (97%)] Loss: 0.30098 (QuantReg: 12.83735) QuantErr: 12.83735 batch_time=0.39646 
Train Epoch: 28 [971/1000 31072/32000 (97%)] Loss: 0.46030 (QuantReg: 12.64878) QuantErr: 12.64878 batch_time=0.35092 
Train Epoch: 28 [976/1000 31232/32000 (98%)] Loss: 0.32019 (QuantReg: 12.57596) QuantErr: 12.57596 batch_time=0.36410 
Train Epoch: 28 [981/1000 31392/32000 (98%)] Loss: 0.44258 (QuantReg: 13.34728) QuantErr: 13.34728 batch_time=0.43535 
Train Epoch: 28 [986/1000 31552/32000 (99%)] Loss: 0.20890 (QuantReg: 13.46725) QuantErr: 13.46725 batch_time=0.59988 
Train Epoch: 28 [991/1000 31712/32000 (99%)] Loss: 0.56653 (QuantReg: 12.20536) QuantErr: 12.20536 batch_time=0.36501 
Train Epoch: 28 [996/1000 31872/32000 (100%)] Loss: 0.33470 (QuantReg: 12.73853) QuantErr: 12.73853 batch_time=0.42928 
Train Epoch: 28 codebook_update_time=2.07394
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch28.pth ...
Done in 6.299s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch28.pth ...
Done in 11.127s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 0.38372540109604597
 quant_reg      : 12.817564968109131
 quant_err      : 12.817564968109131
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 28000
 MSRVTT_miech_test/t2v_metrics/R1: 20.2
 MSRVTT_miech_test/t2v_metrics/R5: 49.6
 MSRVTT_miech_test/t2v_metrics/R10: 62.9
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.318
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.79494392982631
 MSRVTT_miech_test/v2t_metrics/R1: 20.1
 MSRVTT_miech_test/v2t_metrics/R5: 50.2
 MSRVTT_miech_test/v2t_metrics/R10: 63.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.559
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.973099830243655
 mnt_best       : 39.79494392982631
 not_improved_count: 0
Train Epoch: 29 [1/1000 32/32000 (0%)] Loss: 0.51522 (QuantReg: 12.61002) QuantErr: 12.61002 batch_time=27.96311 
Train Epoch: 29 [6/1000 192/32000 (1%)] Loss: 0.32255 (QuantReg: 12.68781) QuantErr: 12.68781 batch_time=0.76797 
Train Epoch: 29 [11/1000 352/32000 (1%)] Loss: 0.38146 (QuantReg: 12.43865) QuantErr: 12.43865 batch_time=0.46071 
Train Epoch: 29 [16/1000 512/32000 (2%)] Loss: 0.58592 (QuantReg: 12.75273) QuantErr: 12.75273 batch_time=1.41565 
Train Epoch: 29 [21/1000 672/32000 (2%)] Loss: 0.52510 (QuantReg: 12.66846) QuantErr: 12.66846 batch_time=0.66978 
Train Epoch: 29 [26/1000 832/32000 (3%)] Loss: 0.43401 (QuantReg: 12.92418) QuantErr: 12.92418 batch_time=0.38681 
Train Epoch: 29 [31/1000 992/32000 (3%)] Loss: 0.17019 (QuantReg: 12.95258) QuantErr: 12.95258 batch_time=0.34922 
Train Epoch: 29 [36/1000 1152/32000 (4%)] Loss: 0.34834 (QuantReg: 12.83791) QuantErr: 12.83791 batch_time=0.46168 
Train Epoch: 29 [41/1000 1312/32000 (4%)] Loss: 0.49930 (QuantReg: 12.97109) QuantErr: 12.97109 batch_time=0.36746 
Train Epoch: 29 [46/1000 1472/32000 (5%)] Loss: 0.69916 (QuantReg: 13.16520) QuantErr: 13.16520 batch_time=0.42327 
Train Epoch: 29 [51/1000 1632/32000 (5%)] Loss: 0.28656 (QuantReg: 13.40714) QuantErr: 13.40714 batch_time=0.40806 
Train Epoch: 29 [56/1000 1792/32000 (6%)] Loss: 0.22497 (QuantReg: 12.95456) QuantErr: 12.95456 batch_time=0.50404 
Train Epoch: 29 [61/1000 1952/32000 (6%)] Loss: 0.72501 (QuantReg: 12.26464) QuantErr: 12.26464 batch_time=0.60488 
Train Epoch: 29 [66/1000 2112/32000 (7%)] Loss: 0.30310 (QuantReg: 12.25055) QuantErr: 12.25055 batch_time=0.44468 
Train Epoch: 29 [71/1000 2272/32000 (7%)] Loss: 0.34808 (QuantReg: 13.03950) QuantErr: 13.03950 batch_time=0.34127 
Train Epoch: 29 [76/1000 2432/32000 (8%)] Loss: 0.44362 (QuantReg: 12.71496) QuantErr: 12.71496 batch_time=0.36086 
Train Epoch: 29 [81/1000 2592/32000 (8%)] Loss: 0.13460 (QuantReg: 12.66835) QuantErr: 12.66835 batch_time=0.43588 
Train Epoch: 29 [86/1000 2752/32000 (9%)] Loss: 0.67073 (QuantReg: 12.33810) QuantErr: 12.33810 batch_time=0.35816 
Train Epoch: 29 [91/1000 2912/32000 (9%)] Loss: 0.60375 (QuantReg: 12.68917) QuantErr: 12.68917 batch_time=0.67193 
Train Epoch: 29 [96/1000 3072/32000 (10%)] Loss: 0.40992 (QuantReg: 12.39473) QuantErr: 12.39473 batch_time=0.61378 
Train Epoch: 29 [101/1000 3232/32000 (10%)] Loss: 0.29951 (QuantReg: 13.25512) QuantErr: 13.25512 batch_time=0.61184 
Train Epoch: 29 [106/1000 3392/32000 (11%)] Loss: 0.28034 (QuantReg: 12.95765) QuantErr: 12.95765 batch_time=0.43369 
Train Epoch: 29 [111/1000 3552/32000 (11%)] Loss: 0.28300 (QuantReg: 13.12596) QuantErr: 13.12596 batch_time=0.56972 
Train Epoch: 29 [116/1000 3712/32000 (12%)] Loss: 0.46942 (QuantReg: 12.85747) QuantErr: 12.85747 batch_time=0.36303 
Train Epoch: 29 [121/1000 3872/32000 (12%)] Loss: 0.38288 (QuantReg: 12.12515) QuantErr: 12.12515 batch_time=0.38163 
Train Epoch: 29 [126/1000 4032/32000 (13%)] Loss: 0.46754 (QuantReg: 12.68422) QuantErr: 12.68422 batch_time=0.37508 
Train Epoch: 29 [131/1000 4192/32000 (13%)] Loss: 0.42300 (QuantReg: 12.34501) QuantErr: 12.34501 batch_time=0.48486 
Train Epoch: 29 [136/1000 4352/32000 (14%)] Loss: 0.20200 (QuantReg: 13.46314) QuantErr: 13.46314 batch_time=0.42202 
Train Epoch: 29 [141/1000 4512/32000 (14%)] Loss: 0.22100 (QuantReg: 12.40811) QuantErr: 12.40811 batch_time=0.46610 
Train Epoch: 29 [146/1000 4672/32000 (15%)] Loss: 0.28585 (QuantReg: 12.87749) QuantErr: 12.87749 batch_time=0.40013 
Train Epoch: 29 [151/1000 4832/32000 (15%)] Loss: 0.49289 (QuantReg: 12.25857) QuantErr: 12.25857 batch_time=0.54709 
Train Epoch: 29 [156/1000 4992/32000 (16%)] Loss: 0.37566 (QuantReg: 12.85738) QuantErr: 12.85738 batch_time=0.35820 
Train Epoch: 29 [161/1000 5152/32000 (16%)] Loss: 0.32395 (QuantReg: 13.30773) QuantErr: 13.30773 batch_time=0.42753 
Train Epoch: 29 [166/1000 5312/32000 (17%)] Loss: 0.17954 (QuantReg: 13.24713) QuantErr: 13.24713 batch_time=0.35567 
Train Epoch: 29 [171/1000 5472/32000 (17%)] Loss: 0.30326 (QuantReg: 12.60225) QuantErr: 12.60225 batch_time=0.39626 
Train Epoch: 29 [176/1000 5632/32000 (18%)] Loss: 0.73525 (QuantReg: 12.52103) QuantErr: 12.52103 batch_time=0.45057 
Train Epoch: 29 [181/1000 5792/32000 (18%)] Loss: 0.37745 (QuantReg: 13.13656) QuantErr: 13.13656 batch_time=0.39387 
Train Epoch: 29 [186/1000 5952/32000 (19%)] Loss: 0.81400 (QuantReg: 12.71736) QuantErr: 12.71736 batch_time=0.48523 
Train Epoch: 29 [191/1000 6112/32000 (19%)] Loss: 0.31108 (QuantReg: 13.70842) QuantErr: 13.70842 batch_time=0.35154 
Train Epoch: 29 [196/1000 6272/32000 (20%)] Loss: 0.57378 (QuantReg: 12.74312) QuantErr: 12.74312 batch_time=0.69169 
Train Epoch: 29 [201/1000 6432/32000 (20%)] Loss: 0.22341 (QuantReg: 12.54732) QuantErr: 12.54732 batch_time=0.55926 
Train Epoch: 29 [206/1000 6592/32000 (21%)] Loss: 0.24834 (QuantReg: 12.83003) QuantErr: 12.83003 batch_time=0.40063 
Train Epoch: 29 [211/1000 6752/32000 (21%)] Loss: 0.08243 (QuantReg: 12.65522) QuantErr: 12.65522 batch_time=0.42790 
Train Epoch: 29 [216/1000 6912/32000 (22%)] Loss: 0.85861 (QuantReg: 12.41015) QuantErr: 12.41015 batch_time=0.88243 
Train Epoch: 29 [221/1000 7072/32000 (22%)] Loss: 0.40031 (QuantReg: 11.88282) QuantErr: 11.88282 batch_time=0.43638 
Train Epoch: 29 [226/1000 7232/32000 (23%)] Loss: 0.27460 (QuantReg: 12.68597) QuantErr: 12.68597 batch_time=0.36323 
Train Epoch: 29 [231/1000 7392/32000 (23%)] Loss: 0.38854 (QuantReg: 13.50378) QuantErr: 13.50378 batch_time=1.61014 
Train Epoch: 29 [236/1000 7552/32000 (24%)] Loss: 0.58225 (QuantReg: 13.23739) QuantErr: 13.23739 batch_time=0.40362 
Train Epoch: 29 [241/1000 7712/32000 (24%)] Loss: 0.65048 (QuantReg: 12.00642) QuantErr: 12.00642 batch_time=0.38493 
Train Epoch: 29 [246/1000 7872/32000 (25%)] Loss: 0.40888 (QuantReg: 12.40089) QuantErr: 12.40089 batch_time=0.59278 
Train Epoch: 29 [251/1000 8032/32000 (25%)] Loss: 0.35835 (QuantReg: 12.70583) QuantErr: 12.70583 batch_time=0.37155 
Train Epoch: 29 [256/1000 8192/32000 (26%)] Loss: 0.33954 (QuantReg: 12.83264) QuantErr: 12.83264 batch_time=0.42984 
Train Epoch: 29 [261/1000 8352/32000 (26%)] Loss: 0.46088 (QuantReg: 12.25419) QuantErr: 12.25419 batch_time=0.51484 
Train Epoch: 29 [266/1000 8512/32000 (27%)] Loss: 0.64338 (QuantReg: 12.89909) QuantErr: 12.89909 batch_time=0.38716 
Train Epoch: 29 [271/1000 8672/32000 (27%)] Loss: 0.66713 (QuantReg: 11.84982) QuantErr: 11.84982 batch_time=0.41177 
Train Epoch: 29 [276/1000 8832/32000 (28%)] Loss: 0.21288 (QuantReg: 12.68337) QuantErr: 12.68337 batch_time=0.41049 
Train Epoch: 29 [281/1000 8992/32000 (28%)] Loss: 0.17947 (QuantReg: 13.06880) QuantErr: 13.06880 batch_time=0.38981 
Train Epoch: 29 [286/1000 9152/32000 (29%)] Loss: 0.39920 (QuantReg: 12.07253) QuantErr: 12.07253 batch_time=0.45320 
Train Epoch: 29 [291/1000 9312/32000 (29%)] Loss: 0.12723 (QuantReg: 13.22107) QuantErr: 13.22107 batch_time=0.39392 
Train Epoch: 29 [296/1000 9472/32000 (30%)] Loss: 0.46203 (QuantReg: 12.83234) QuantErr: 12.83234 batch_time=0.38576 
Train Epoch: 29 [301/1000 9632/32000 (30%)] Loss: 0.21303 (QuantReg: 13.31484) QuantErr: 13.31484 batch_time=0.36204 
Train Epoch: 29 [306/1000 9792/32000 (31%)] Loss: 0.21705 (QuantReg: 13.13560) QuantErr: 13.13560 batch_time=0.51872 
Train Epoch: 29 [311/1000 9952/32000 (31%)] Loss: 0.10664 (QuantReg: 13.83293) QuantErr: 13.83293 batch_time=0.34997 
Train Epoch: 29 [316/1000 10112/32000 (32%)] Loss: 0.41436 (QuantReg: 13.21893) QuantErr: 13.21893 batch_time=0.47271 
Train Epoch: 29 [321/1000 10272/32000 (32%)] Loss: 0.14212 (QuantReg: 13.08129) QuantErr: 13.08129 batch_time=0.42324 
Train Epoch: 29 [326/1000 10432/32000 (33%)] Loss: 0.25028 (QuantReg: 13.27652) QuantErr: 13.27652 batch_time=0.44981 
Train Epoch: 29 [331/1000 10592/32000 (33%)] Loss: 0.32077 (QuantReg: 12.41634) QuantErr: 12.41634 batch_time=0.34276 
Train Epoch: 29 [336/1000 10752/32000 (34%)] Loss: 0.50886 (QuantReg: 12.65971) QuantErr: 12.65971 batch_time=0.46643 
Train Epoch: 29 [341/1000 10912/32000 (34%)] Loss: 0.37206 (QuantReg: 12.69468) QuantErr: 12.69468 batch_time=2.63104 
Train Epoch: 29 [346/1000 11072/32000 (35%)] Loss: 0.55717 (QuantReg: 12.90440) QuantErr: 12.90440 batch_time=0.65045 
Train Epoch: 29 [351/1000 11232/32000 (35%)] Loss: 0.81315 (QuantReg: 12.57196) QuantErr: 12.57196 batch_time=0.38820 
Train Epoch: 29 [356/1000 11392/32000 (36%)] Loss: 0.37822 (QuantReg: 12.91283) QuantErr: 12.91283 batch_time=0.36198 
Train Epoch: 29 [361/1000 11552/32000 (36%)] Loss: 0.38273 (QuantReg: 13.16033) QuantErr: 13.16033 batch_time=0.34788 
Train Epoch: 29 [366/1000 11712/32000 (37%)] Loss: 0.24801 (QuantReg: 13.57757) QuantErr: 13.57757 batch_time=0.36344 
Train Epoch: 29 [371/1000 11872/32000 (37%)] Loss: 0.77730 (QuantReg: 12.66148) QuantErr: 12.66148 batch_time=0.35375 
Train Epoch: 29 [376/1000 12032/32000 (38%)] Loss: 0.48347 (QuantReg: 13.59344) QuantErr: 13.59344 batch_time=0.36202 
Train Epoch: 29 [381/1000 12192/32000 (38%)] Loss: 0.14478 (QuantReg: 12.67166) QuantErr: 12.67166 batch_time=0.35459 
Train Epoch: 29 [386/1000 12352/32000 (39%)] Loss: 0.58051 (QuantReg: 12.46770) QuantErr: 12.46770 batch_time=0.39166 
Train Epoch: 29 [391/1000 12512/32000 (39%)] Loss: 0.76377 (QuantReg: 13.31559) QuantErr: 13.31559 batch_time=0.39991 
Train Epoch: 29 [396/1000 12672/32000 (40%)] Loss: 0.27085 (QuantReg: 12.69307) QuantErr: 12.69307 batch_time=0.83460 
Train Epoch: 29 [401/1000 12832/32000 (40%)] Loss: 0.51256 (QuantReg: 12.89615) QuantErr: 12.89615 batch_time=0.39601 
Train Epoch: 29 [406/1000 12992/32000 (41%)] Loss: 0.28220 (QuantReg: 12.64363) QuantErr: 12.64363 batch_time=0.34781 
Train Epoch: 29 [411/1000 13152/32000 (41%)] Loss: 0.41753 (QuantReg: 13.10257) QuantErr: 13.10257 batch_time=0.37450 
Train Epoch: 29 [416/1000 13312/32000 (42%)] Loss: 0.09286 (QuantReg: 12.72885) QuantErr: 12.72885 batch_time=0.36236 
Train Epoch: 29 [421/1000 13472/32000 (42%)] Loss: 0.28029 (QuantReg: 13.27930) QuantErr: 13.27930 batch_time=0.42891 
Train Epoch: 29 [426/1000 13632/32000 (43%)] Loss: 0.20306 (QuantReg: 12.88906) QuantErr: 12.88906 batch_time=0.35646 
Train Epoch: 29 [431/1000 13792/32000 (43%)] Loss: 0.43738 (QuantReg: 13.22817) QuantErr: 13.22817 batch_time=0.37803 
Train Epoch: 29 [436/1000 13952/32000 (44%)] Loss: 0.36578 (QuantReg: 12.54193) QuantErr: 12.54193 batch_time=0.35606 
Train Epoch: 29 [441/1000 14112/32000 (44%)] Loss: 0.31301 (QuantReg: 12.37917) QuantErr: 12.37917 batch_time=0.46424 
Train Epoch: 29 [446/1000 14272/32000 (45%)] Loss: 0.39715 (QuantReg: 12.39183) QuantErr: 12.39183 batch_time=0.47195 
Train Epoch: 29 [451/1000 14432/32000 (45%)] Loss: 0.39024 (QuantReg: 12.68734) QuantErr: 12.68734 batch_time=0.43473 
Train Epoch: 29 [456/1000 14592/32000 (46%)] Loss: 0.18082 (QuantReg: 13.60371) QuantErr: 13.60371 batch_time=0.47574 
Train Epoch: 29 [461/1000 14752/32000 (46%)] Loss: 0.65362 (QuantReg: 13.21223) QuantErr: 13.21223 batch_time=0.51417 
Train Epoch: 29 [466/1000 14912/32000 (47%)] Loss: 0.31755 (QuantReg: 12.83815) QuantErr: 12.83815 batch_time=0.35490 
Train Epoch: 29 [471/1000 15072/32000 (47%)] Loss: 0.37018 (QuantReg: 12.86238) QuantErr: 12.86238 batch_time=0.38492 
Train Epoch: 29 [476/1000 15232/32000 (48%)] Loss: 0.35301 (QuantReg: 12.86803) QuantErr: 12.86803 batch_time=0.45764 
Train Epoch: 29 [481/1000 15392/32000 (48%)] Loss: 0.58417 (QuantReg: 12.90643) QuantErr: 12.90643 batch_time=0.37064 
Train Epoch: 29 [486/1000 15552/32000 (49%)] Loss: 0.29796 (QuantReg: 12.45591) QuantErr: 12.45591 batch_time=0.37315 
Train Epoch: 29 [491/1000 15712/32000 (49%)] Loss: 0.40863 (QuantReg: 12.78834) QuantErr: 12.78834 batch_time=0.75346 
Train Epoch: 29 [496/1000 15872/32000 (50%)] Loss: 0.42105 (QuantReg: 12.50069) QuantErr: 12.50069 batch_time=0.34219 
Train Epoch: 29 [501/1000 16032/32000 (50%)] Loss: 0.35435 (QuantReg: 12.88055) QuantErr: 12.88055 batch_time=0.34737 
Train Epoch: 29 [506/1000 16192/32000 (51%)] Loss: 0.18671 (QuantReg: 12.76677) QuantErr: 12.76677 batch_time=0.38672 
Train Epoch: 29 [511/1000 16352/32000 (51%)] Loss: 0.18325 (QuantReg: 12.81261) QuantErr: 12.81261 batch_time=0.35530 
Train Epoch: 29 [516/1000 16512/32000 (52%)] Loss: 0.50043 (QuantReg: 12.68822) QuantErr: 12.68822 batch_time=0.42928 
Train Epoch: 29 [521/1000 16672/32000 (52%)] Loss: 0.42507 (QuantReg: 12.90322) QuantErr: 12.90322 batch_time=0.37314 
Train Epoch: 29 [526/1000 16832/32000 (53%)] Loss: 0.12710 (QuantReg: 13.11232) QuantErr: 13.11232 batch_time=0.45523 
Train Epoch: 29 [531/1000 16992/32000 (53%)] Loss: 0.19940 (QuantReg: 13.01367) QuantErr: 13.01367 batch_time=0.45646 
Train Epoch: 29 [536/1000 17152/32000 (54%)] Loss: 0.18214 (QuantReg: 12.75744) QuantErr: 12.75744 batch_time=0.32654 
Train Epoch: 29 [541/1000 17312/32000 (54%)] Loss: 0.21444 (QuantReg: 12.24698) QuantErr: 12.24698 batch_time=0.76314 
Train Epoch: 29 [546/1000 17472/32000 (55%)] Loss: 0.30689 (QuantReg: 12.80917) QuantErr: 12.80917 batch_time=0.35805 
Train Epoch: 29 [551/1000 17632/32000 (55%)] Loss: 0.31561 (QuantReg: 12.48511) QuantErr: 12.48511 batch_time=0.99768 
Train Epoch: 29 [556/1000 17792/32000 (56%)] Loss: 0.62845 (QuantReg: 12.30538) QuantErr: 12.30538 batch_time=0.33918 
Train Epoch: 29 [561/1000 17952/32000 (56%)] Loss: 0.51707 (QuantReg: 11.97906) QuantErr: 11.97906 batch_time=0.40780 
Train Epoch: 29 [566/1000 18112/32000 (57%)] Loss: 0.12290 (QuantReg: 13.16519) QuantErr: 13.16519 batch_time=0.40676 
Train Epoch: 29 [571/1000 18272/32000 (57%)] Loss: 0.43871 (QuantReg: 12.37566) QuantErr: 12.37566 batch_time=0.36763 
Train Epoch: 29 [576/1000 18432/32000 (58%)] Loss: 0.23745 (QuantReg: 12.57310) QuantErr: 12.57310 batch_time=0.38765 
Train Epoch: 29 [581/1000 18592/32000 (58%)] Loss: 0.33850 (QuantReg: 13.30123) QuantErr: 13.30123 batch_time=0.50250 
Train Epoch: 29 [586/1000 18752/32000 (59%)] Loss: 0.25918 (QuantReg: 12.79161) QuantErr: 12.79161 batch_time=0.34313 
Train Epoch: 29 [591/1000 18912/32000 (59%)] Loss: 0.11750 (QuantReg: 13.00385) QuantErr: 13.00385 batch_time=0.56997 
Train Epoch: 29 [596/1000 19072/32000 (60%)] Loss: 0.33302 (QuantReg: 13.10592) QuantErr: 13.10592 batch_time=1.86322 
Train Epoch: 29 [601/1000 19232/32000 (60%)] Loss: 0.18729 (QuantReg: 12.60825) QuantErr: 12.60825 batch_time=0.41271 
Train Epoch: 29 [606/1000 19392/32000 (61%)] Loss: 0.39640 (QuantReg: 12.59880) QuantErr: 12.59880 batch_time=0.36836 
Train Epoch: 29 [611/1000 19552/32000 (61%)] Loss: 0.25136 (QuantReg: 13.19727) QuantErr: 13.19727 batch_time=0.34022 
Train Epoch: 29 [616/1000 19712/32000 (62%)] Loss: 0.15575 (QuantReg: 12.68505) QuantErr: 12.68505 batch_time=0.34667 
Train Epoch: 29 [621/1000 19872/32000 (62%)] Loss: 0.21262 (QuantReg: 13.11441) QuantErr: 13.11441 batch_time=0.47495 
Train Epoch: 29 [626/1000 20032/32000 (63%)] Loss: 0.50165 (QuantReg: 12.96869) QuantErr: 12.96869 batch_time=0.37300 
Train Epoch: 29 [631/1000 20192/32000 (63%)] Loss: 0.18806 (QuantReg: 13.69586) QuantErr: 13.69586 batch_time=0.36315 
Train Epoch: 29 [636/1000 20352/32000 (64%)] Loss: 0.25090 (QuantReg: 12.97627) QuantErr: 12.97627 batch_time=0.43456 
Train Epoch: 29 [641/1000 20512/32000 (64%)] Loss: 0.41283 (QuantReg: 12.74813) QuantErr: 12.74813 batch_time=0.55205 
Train Epoch: 29 [646/1000 20672/32000 (65%)] Loss: 0.41010 (QuantReg: 13.61043) QuantErr: 13.61043 batch_time=0.34359 
Train Epoch: 29 [651/1000 20832/32000 (65%)] Loss: 0.23404 (QuantReg: 13.36101) QuantErr: 13.36101 batch_time=0.35457 
Train Epoch: 29 [656/1000 20992/32000 (66%)] Loss: 0.19300 (QuantReg: 12.62198) QuantErr: 12.62198 batch_time=0.42532 
Train Epoch: 29 [661/1000 21152/32000 (66%)] Loss: 0.15093 (QuantReg: 12.85026) QuantErr: 12.85026 batch_time=0.43962 
Train Epoch: 29 [666/1000 21312/32000 (67%)] Loss: 0.41517 (QuantReg: 12.31957) QuantErr: 12.31957 batch_time=0.36193 
Train Epoch: 29 [671/1000 21472/32000 (67%)] Loss: 0.42457 (QuantReg: 13.11234) QuantErr: 13.11234 batch_time=0.34656 
Train Epoch: 29 [676/1000 21632/32000 (68%)] Loss: 0.19647 (QuantReg: 13.18183) QuantErr: 13.18183 batch_time=0.47351 
Train Epoch: 29 [681/1000 21792/32000 (68%)] Loss: 0.57503 (QuantReg: 13.61653) QuantErr: 13.61653 batch_time=0.36599 
Train Epoch: 29 [686/1000 21952/32000 (69%)] Loss: 0.33894 (QuantReg: 12.66185) QuantErr: 12.66185 batch_time=0.36011 
Train Epoch: 29 [691/1000 22112/32000 (69%)] Loss: 0.43712 (QuantReg: 12.90534) QuantErr: 12.90534 batch_time=0.39145 
Train Epoch: 29 [696/1000 22272/32000 (70%)] Loss: 0.93892 (QuantReg: 12.25696) QuantErr: 12.25696 batch_time=0.33500 
Train Epoch: 29 [701/1000 22432/32000 (70%)] Loss: 0.13615 (QuantReg: 12.68942) QuantErr: 12.68942 batch_time=0.74207 
Train Epoch: 29 [706/1000 22592/32000 (71%)] Loss: 0.67913 (QuantReg: 12.55671) QuantErr: 12.55671 batch_time=0.39344 
Train Epoch: 29 [711/1000 22752/32000 (71%)] Loss: 0.33888 (QuantReg: 12.40353) QuantErr: 12.40353 batch_time=0.41199 
Train Epoch: 29 [716/1000 22912/32000 (72%)] Loss: 0.55185 (QuantReg: 12.51351) QuantErr: 12.51351 batch_time=0.34931 
Train Epoch: 29 [721/1000 23072/32000 (72%)] Loss: 0.83473 (QuantReg: 12.22095) QuantErr: 12.22095 batch_time=0.37554 
Train Epoch: 29 [726/1000 23232/32000 (73%)] Loss: 0.47120 (QuantReg: 12.64333) QuantErr: 12.64333 batch_time=0.37800 
Train Epoch: 29 [731/1000 23392/32000 (73%)] Loss: 0.55671 (QuantReg: 12.89997) QuantErr: 12.89997 batch_time=0.38371 
Train Epoch: 29 [736/1000 23552/32000 (74%)] Loss: 0.54758 (QuantReg: 12.82326) QuantErr: 12.82326 batch_time=0.62573 
Train Epoch: 29 [741/1000 23712/32000 (74%)] Loss: 0.41350 (QuantReg: 13.27143) QuantErr: 13.27143 batch_time=0.37701 
Train Epoch: 29 [746/1000 23872/32000 (75%)] Loss: 0.47124 (QuantReg: 13.15874) QuantErr: 13.15874 batch_time=0.42707 
Train Epoch: 29 [751/1000 24032/32000 (75%)] Loss: 0.29238 (QuantReg: 13.26552) QuantErr: 13.26552 batch_time=0.38548 
Train Epoch: 29 [756/1000 24192/32000 (76%)] Loss: 0.16550 (QuantReg: 13.11390) QuantErr: 13.11390 batch_time=0.34555 
Train Epoch: 29 [761/1000 24352/32000 (76%)] Loss: 0.52765 (QuantReg: 13.48970) QuantErr: 13.48970 batch_time=0.39144 
Train Epoch: 29 [766/1000 24512/32000 (77%)] Loss: 0.28307 (QuantReg: 12.54007) QuantErr: 12.54007 batch_time=0.35465 
Train Epoch: 29 [771/1000 24672/32000 (77%)] Loss: 0.64956 (QuantReg: 12.71272) QuantErr: 12.71272 batch_time=0.45926 
Train Epoch: 29 [776/1000 24832/32000 (78%)] Loss: 0.48172 (QuantReg: 12.77567) QuantErr: 12.77567 batch_time=0.42179 
Train Epoch: 29 [781/1000 24992/32000 (78%)] Loss: 0.20011 (QuantReg: 13.10913) QuantErr: 13.10913 batch_time=0.49145 
Train Epoch: 29 [786/1000 25152/32000 (79%)] Loss: 0.27334 (QuantReg: 13.68806) QuantErr: 13.68806 batch_time=0.35119 
Train Epoch: 29 [791/1000 25312/32000 (79%)] Loss: 0.13760 (QuantReg: 12.73194) QuantErr: 12.73194 batch_time=0.41925 
Train Epoch: 29 [796/1000 25472/32000 (80%)] Loss: 0.29205 (QuantReg: 12.56659) QuantErr: 12.56659 batch_time=0.43637 
Train Epoch: 29 [801/1000 25632/32000 (80%)] Loss: 0.14571 (QuantReg: 12.79764) QuantErr: 12.79764 batch_time=0.36451 
Train Epoch: 29 [806/1000 25792/32000 (81%)] Loss: 0.63763 (QuantReg: 13.50872) QuantErr: 13.50872 batch_time=0.35835 
Train Epoch: 29 [811/1000 25952/32000 (81%)] Loss: 0.40266 (QuantReg: 13.07191) QuantErr: 13.07191 batch_time=0.44853 
Train Epoch: 29 [816/1000 26112/32000 (82%)] Loss: 0.90263 (QuantReg: 13.32662) QuantErr: 13.32662 batch_time=0.34401 
Train Epoch: 29 [821/1000 26272/32000 (82%)] Loss: 0.51147 (QuantReg: 13.12376) QuantErr: 13.12376 batch_time=0.39048 
Train Epoch: 29 [826/1000 26432/32000 (83%)] Loss: 0.53660 (QuantReg: 12.50791) QuantErr: 12.50791 batch_time=0.36024 
Train Epoch: 29 [831/1000 26592/32000 (83%)] Loss: 0.19670 (QuantReg: 12.81535) QuantErr: 12.81535 batch_time=0.36412 
Train Epoch: 29 [836/1000 26752/32000 (84%)] Loss: 0.34773 (QuantReg: 12.60873) QuantErr: 12.60873 batch_time=0.83041 
Train Epoch: 29 [841/1000 26912/32000 (84%)] Loss: 0.35227 (QuantReg: 13.54668) QuantErr: 13.54668 batch_time=0.37297 
Train Epoch: 29 [846/1000 27072/32000 (85%)] Loss: 0.33929 (QuantReg: 12.82421) QuantErr: 12.82421 batch_time=0.34629 
Train Epoch: 29 [851/1000 27232/32000 (85%)] Loss: 0.42723 (QuantReg: 13.39690) QuantErr: 13.39690 batch_time=0.47336 
Train Epoch: 29 [856/1000 27392/32000 (86%)] Loss: 0.49618 (QuantReg: 13.30967) QuantErr: 13.30967 batch_time=0.35570 
Train Epoch: 29 [861/1000 27552/32000 (86%)] Loss: 0.44723 (QuantReg: 12.64036) QuantErr: 12.64036 batch_time=0.38525 
Train Epoch: 29 [866/1000 27712/32000 (87%)] Loss: 0.39230 (QuantReg: 13.03702) QuantErr: 13.03702 batch_time=0.38108 
Train Epoch: 29 [871/1000 27872/32000 (87%)] Loss: 0.42631 (QuantReg: 12.86468) QuantErr: 12.86468 batch_time=0.83034 
Train Epoch: 29 [876/1000 28032/32000 (88%)] Loss: 0.22958 (QuantReg: 12.78864) QuantErr: 12.78864 batch_time=0.47265 
Train Epoch: 29 [881/1000 28192/32000 (88%)] Loss: 0.41857 (QuantReg: 13.01188) QuantErr: 13.01188 batch_time=0.43561 
Train Epoch: 29 [886/1000 28352/32000 (89%)] Loss: 0.21121 (QuantReg: 12.92622) QuantErr: 12.92622 batch_time=0.41971 
Train Epoch: 29 [891/1000 28512/32000 (89%)] Loss: 0.43630 (QuantReg: 13.09461) QuantErr: 13.09461 batch_time=0.37443 
Train Epoch: 29 [896/1000 28672/32000 (90%)] Loss: 0.16677 (QuantReg: 13.76977) QuantErr: 13.76977 batch_time=0.38295 
Train Epoch: 29 [901/1000 28832/32000 (90%)] Loss: 0.28928 (QuantReg: 12.63912) QuantErr: 12.63912 batch_time=0.38923 
Train Epoch: 29 [906/1000 28992/32000 (91%)] Loss: 0.51373 (QuantReg: 13.62970) QuantErr: 13.62970 batch_time=0.47005 
Train Epoch: 29 [911/1000 29152/32000 (91%)] Loss: 0.68997 (QuantReg: 13.46689) QuantErr: 13.46689 batch_time=0.40998 
Train Epoch: 29 [916/1000 29312/32000 (92%)] Loss: 0.61397 (QuantReg: 12.29546) QuantErr: 12.29546 batch_time=1.87160 
Train Epoch: 29 [921/1000 29472/32000 (92%)] Loss: 0.47526 (QuantReg: 12.55972) QuantErr: 12.55972 batch_time=0.34991 
Train Epoch: 29 [926/1000 29632/32000 (93%)] Loss: 0.38797 (QuantReg: 12.91479) QuantErr: 12.91479 batch_time=0.33175 
Train Epoch: 29 [931/1000 29792/32000 (93%)] Loss: 0.32754 (QuantReg: 13.64974) QuantErr: 13.64974 batch_time=0.69396 
Train Epoch: 29 [936/1000 29952/32000 (94%)] Loss: 0.32347 (QuantReg: 13.35900) QuantErr: 13.35900 batch_time=0.34338 
Train Epoch: 29 [941/1000 30112/32000 (94%)] Loss: 0.23905 (QuantReg: 13.15680) QuantErr: 13.15680 batch_time=0.40852 
Train Epoch: 29 [946/1000 30272/32000 (95%)] Loss: 0.40447 (QuantReg: 13.13040) QuantErr: 13.13040 batch_time=0.36628 
Train Epoch: 29 [951/1000 30432/32000 (95%)] Loss: 0.58372 (QuantReg: 12.80603) QuantErr: 12.80603 batch_time=0.34837 
Train Epoch: 29 [956/1000 30592/32000 (96%)] Loss: 0.20640 (QuantReg: 12.52760) QuantErr: 12.52760 batch_time=0.35126 
Train Epoch: 29 [961/1000 30752/32000 (96%)] Loss: 0.40088 (QuantReg: 12.37733) QuantErr: 12.37733 batch_time=0.48816 
Train Epoch: 29 [966/1000 30912/32000 (97%)] Loss: 0.48279 (QuantReg: 12.68632) QuantErr: 12.68632 batch_time=0.36430 
Train Epoch: 29 [971/1000 31072/32000 (97%)] Loss: 0.33252 (QuantReg: 12.73594) QuantErr: 12.73594 batch_time=0.36633 
Train Epoch: 29 [976/1000 31232/32000 (98%)] Loss: 0.51650 (QuantReg: 13.55698) QuantErr: 13.55698 batch_time=0.40890 
Train Epoch: 29 [981/1000 31392/32000 (98%)] Loss: 0.43725 (QuantReg: 13.18409) QuantErr: 13.18409 batch_time=0.57973 
Train Epoch: 29 [986/1000 31552/32000 (99%)] Loss: 0.22163 (QuantReg: 13.24070) QuantErr: 13.24070 batch_time=0.35594 
Train Epoch: 29 [991/1000 31712/32000 (99%)] Loss: 0.36207 (QuantReg: 13.16037) QuantErr: 13.16037 batch_time=0.42050 
Train Epoch: 29 [996/1000 31872/32000 (100%)] Loss: 0.23781 (QuantReg: 12.87063) QuantErr: 12.87063 batch_time=0.34153 
Train Epoch: 29 codebook_update_time=1.96632
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch29.pth ...
Done in 5.493s
removing stale ckpt [epoch 28] [took 0.03s]
 epoch          : 29
 loss           : 0.37875368052721026
 quant_reg      : 12.848152013778687
 quant_err      : 12.848152013778687
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 29000
 MSRVTT_miech_test/t2v_metrics/R1: 19.8
 MSRVTT_miech_test/t2v_metrics/R5: 50.2
 MSRVTT_miech_test/t2v_metrics/R10: 62.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.6
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.022
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.668232533184394
 MSRVTT_miech_test/v2t_metrics/R1: 21.0
 MSRVTT_miech_test/v2t_metrics/R5: 49.0
 MSRVTT_miech_test/v2t_metrics/R10: 63.8
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.632
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.34087846156144
 mnt_best       : 39.79494392982631
 not_improved_count: 1
Train Epoch: 30 [1/1000 32/32000 (0%)] Loss: 0.45177 (QuantReg: 13.01276) QuantErr: 13.01276 batch_time=29.60028 
Train Epoch: 30 [6/1000 192/32000 (1%)] Loss: 0.67652 (QuantReg: 12.67161) QuantErr: 12.67161 batch_time=0.78662 
Train Epoch: 30 [11/1000 352/32000 (1%)] Loss: 0.30441 (QuantReg: 12.95861) QuantErr: 12.95861 batch_time=0.69863 
Train Epoch: 30 [16/1000 512/32000 (2%)] Loss: 0.40755 (QuantReg: 12.37444) QuantErr: 12.37444 batch_time=0.46487 
Train Epoch: 30 [21/1000 672/32000 (2%)] Loss: 0.26226 (QuantReg: 13.20194) QuantErr: 13.20194 batch_time=0.56303 
Train Epoch: 30 [26/1000 832/32000 (3%)] Loss: 0.71566 (QuantReg: 12.79218) QuantErr: 12.79218 batch_time=0.33993 
Train Epoch: 30 [31/1000 992/32000 (3%)] Loss: 0.50844 (QuantReg: 13.09774) QuantErr: 13.09774 batch_time=0.42551 
Train Epoch: 30 [36/1000 1152/32000 (4%)] Loss: 0.46492 (QuantReg: 12.06803) QuantErr: 12.06803 batch_time=0.37034 
Train Epoch: 30 [41/1000 1312/32000 (4%)] Loss: 0.42778 (QuantReg: 12.85415) QuantErr: 12.85415 batch_time=0.35293 
Train Epoch: 30 [46/1000 1472/32000 (5%)] Loss: 0.32736 (QuantReg: 13.67691) QuantErr: 13.67691 batch_time=0.41965 
Train Epoch: 30 [51/1000 1632/32000 (5%)] Loss: 0.50433 (QuantReg: 12.88709) QuantErr: 12.88709 batch_time=0.38989 
Train Epoch: 30 [56/1000 1792/32000 (6%)] Loss: 0.42908 (QuantReg: 12.69935) QuantErr: 12.69935 batch_time=0.34125 
Train Epoch: 30 [61/1000 1952/32000 (6%)] Loss: 0.28293 (QuantReg: 13.17552) QuantErr: 13.17552 batch_time=0.47187 
Train Epoch: 30 [66/1000 2112/32000 (7%)] Loss: 0.28590 (QuantReg: 13.14121) QuantErr: 13.14121 batch_time=0.33682 
Train Epoch: 30 [71/1000 2272/32000 (7%)] Loss: 0.10715 (QuantReg: 12.92296) QuantErr: 12.92296 batch_time=0.40067 
Train Epoch: 30 [76/1000 2432/32000 (8%)] Loss: 0.21978 (QuantReg: 13.53706) QuantErr: 13.53706 batch_time=0.32953 
Train Epoch: 30 [81/1000 2592/32000 (8%)] Loss: 0.38951 (QuantReg: 13.02264) QuantErr: 13.02264 batch_time=0.48329 
Train Epoch: 30 [86/1000 2752/32000 (9%)] Loss: 0.40849 (QuantReg: 13.18627) QuantErr: 13.18627 batch_time=0.61964 
Train Epoch: 30 [91/1000 2912/32000 (9%)] Loss: 0.25027 (QuantReg: 13.51455) QuantErr: 13.51455 batch_time=0.36934 
Train Epoch: 30 [96/1000 3072/32000 (10%)] Loss: 0.56686 (QuantReg: 12.97966) QuantErr: 12.97966 batch_time=0.63864 
Train Epoch: 30 [101/1000 3232/32000 (10%)] Loss: 0.36650 (QuantReg: 12.75284) QuantErr: 12.75284 batch_time=0.34412 
Train Epoch: 30 [106/1000 3392/32000 (11%)] Loss: 0.47028 (QuantReg: 12.52978) QuantErr: 12.52978 batch_time=0.70015 
Train Epoch: 30 [111/1000 3552/32000 (11%)] Loss: 0.13032 (QuantReg: 12.78288) QuantErr: 12.78288 batch_time=0.34509 
Train Epoch: 30 [116/1000 3712/32000 (12%)] Loss: 0.33526 (QuantReg: 12.85243) QuantErr: 12.85243 batch_time=0.38485 
Train Epoch: 30 [121/1000 3872/32000 (12%)] Loss: 0.49136 (QuantReg: 12.89918) QuantErr: 12.89918 batch_time=0.57139 
Train Epoch: 30 [126/1000 4032/32000 (13%)] Loss: 0.53903 (QuantReg: 12.98022) QuantErr: 12.98022 batch_time=0.41299 
Train Epoch: 30 [131/1000 4192/32000 (13%)] Loss: 0.42965 (QuantReg: 12.62232) QuantErr: 12.62232 batch_time=0.35952 
Train Epoch: 30 [136/1000 4352/32000 (14%)] Loss: 0.41680 (QuantReg: 12.05182) QuantErr: 12.05182 batch_time=0.35167 
Train Epoch: 30 [141/1000 4512/32000 (14%)] Loss: 0.32209 (QuantReg: 13.00971) QuantErr: 13.00971 batch_time=0.38496 
Train Epoch: 30 [146/1000 4672/32000 (15%)] Loss: 0.52908 (QuantReg: 12.41546) QuantErr: 12.41546 batch_time=0.52266 
Train Epoch: 30 [151/1000 4832/32000 (15%)] Loss: 0.34623 (QuantReg: 12.52076) QuantErr: 12.52076 batch_time=0.88172 
Train Epoch: 30 [156/1000 4992/32000 (16%)] Loss: 0.41192 (QuantReg: 12.23058) QuantErr: 12.23058 batch_time=0.40450 
Train Epoch: 30 [161/1000 5152/32000 (16%)] Loss: 0.21261 (QuantReg: 12.98636) QuantErr: 12.98636 batch_time=0.34510 
Train Epoch: 30 [166/1000 5312/32000 (17%)] Loss: 0.47649 (QuantReg: 12.88632) QuantErr: 12.88632 batch_time=0.41833 
Train Epoch: 30 [171/1000 5472/32000 (17%)] Loss: 0.25195 (QuantReg: 12.49365) QuantErr: 12.49365 batch_time=0.33499 
Train Epoch: 30 [176/1000 5632/32000 (18%)] Loss: 0.45467 (QuantReg: 13.56447) QuantErr: 13.56447 batch_time=0.35073 
Train Epoch: 30 [181/1000 5792/32000 (18%)] Loss: 0.28153 (QuantReg: 13.07710) QuantErr: 13.07710 batch_time=0.41092 
Train Epoch: 30 [186/1000 5952/32000 (19%)] Loss: 0.31198 (QuantReg: 13.16464) QuantErr: 13.16464 batch_time=0.40195 
Train Epoch: 30 [191/1000 6112/32000 (19%)] Loss: 0.30341 (QuantReg: 12.65545) QuantErr: 12.65545 batch_time=0.54760 
Train Epoch: 30 [196/1000 6272/32000 (20%)] Loss: 0.33649 (QuantReg: 13.13476) QuantErr: 13.13476 batch_time=0.60145 
Train Epoch: 30 [201/1000 6432/32000 (20%)] Loss: 0.42384 (QuantReg: 12.56401) QuantErr: 12.56401 batch_time=0.36446 
Train Epoch: 30 [206/1000 6592/32000 (21%)] Loss: 0.37843 (QuantReg: 12.45759) QuantErr: 12.45759 batch_time=0.45866 
Train Epoch: 30 [211/1000 6752/32000 (21%)] Loss: 0.45466 (QuantReg: 12.64575) QuantErr: 12.64575 batch_time=0.36223 
Train Epoch: 30 [216/1000 6912/32000 (22%)] Loss: 0.40986 (QuantReg: 13.42603) QuantErr: 13.42603 batch_time=1.75573 
Train Epoch: 30 [221/1000 7072/32000 (22%)] Loss: 0.13677 (QuantReg: 13.29631) QuantErr: 13.29631 batch_time=0.36999 
Train Epoch: 30 [226/1000 7232/32000 (23%)] Loss: 0.15676 (QuantReg: 12.23419) QuantErr: 12.23419 batch_time=0.38933 
Train Epoch: 30 [231/1000 7392/32000 (23%)] Loss: 0.14449 (QuantReg: 12.36528) QuantErr: 12.36528 batch_time=0.46860 
Train Epoch: 30 [236/1000 7552/32000 (24%)] Loss: 0.24220 (QuantReg: 12.87951) QuantErr: 12.87951 batch_time=0.35200 
Train Epoch: 30 [241/1000 7712/32000 (24%)] Loss: 0.42176 (QuantReg: 12.04005) QuantErr: 12.04005 batch_time=0.49031 
Train Epoch: 30 [246/1000 7872/32000 (25%)] Loss: 0.30774 (QuantReg: 13.09367) QuantErr: 13.09367 batch_time=0.43024 
Train Epoch: 30 [251/1000 8032/32000 (25%)] Loss: 0.57386 (QuantReg: 13.02416) QuantErr: 13.02416 batch_time=0.33541 
Train Epoch: 30 [256/1000 8192/32000 (26%)] Loss: 0.43988 (QuantReg: 12.98202) QuantErr: 12.98202 batch_time=0.34791 
Train Epoch: 30 [261/1000 8352/32000 (26%)] Loss: 0.36722 (QuantReg: 12.39621) QuantErr: 12.39621 batch_time=0.36063 
Train Epoch: 30 [266/1000 8512/32000 (27%)] Loss: 0.30187 (QuantReg: 12.62298) QuantErr: 12.62298 batch_time=0.35161 
Train Epoch: 30 [271/1000 8672/32000 (27%)] Loss: 0.51007 (QuantReg: 12.89140) QuantErr: 12.89140 batch_time=0.44575 
Train Epoch: 30 [276/1000 8832/32000 (28%)] Loss: 0.55200 (QuantReg: 13.10650) QuantErr: 13.10650 batch_time=0.36273 
Train Epoch: 30 [281/1000 8992/32000 (28%)] Loss: 0.35818 (QuantReg: 12.57973) QuantErr: 12.57973 batch_time=0.55104 
Train Epoch: 30 [286/1000 9152/32000 (29%)] Loss: 0.30704 (QuantReg: 12.66328) QuantErr: 12.66328 batch_time=0.35201 
Train Epoch: 30 [291/1000 9312/32000 (29%)] Loss: 0.30148 (QuantReg: 12.91123) QuantErr: 12.91123 batch_time=0.64784 
Train Epoch: 30 [296/1000 9472/32000 (30%)] Loss: 0.26069 (QuantReg: 12.85016) QuantErr: 12.85016 batch_time=0.35536 
Train Epoch: 30 [301/1000 9632/32000 (30%)] Loss: 0.19397 (QuantReg: 12.79252) QuantErr: 12.79252 batch_time=0.41321 
Train Epoch: 30 [306/1000 9792/32000 (31%)] Loss: 0.20010 (QuantReg: 13.54076) QuantErr: 13.54076 batch_time=0.51418 
Train Epoch: 30 [311/1000 9952/32000 (31%)] Loss: 0.34045 (QuantReg: 12.95942) QuantErr: 12.95942 batch_time=0.35562 
Train Epoch: 30 [316/1000 10112/32000 (32%)] Loss: 0.25566 (QuantReg: 12.37266) QuantErr: 12.37266 batch_time=0.49289 
Train Epoch: 30 [321/1000 10272/32000 (32%)] Loss: 0.24042 (QuantReg: 11.82893) QuantErr: 11.82893 batch_time=0.35127 
Train Epoch: 30 [326/1000 10432/32000 (33%)] Loss: 0.17748 (QuantReg: 13.43429) QuantErr: 13.43429 batch_time=0.37261 
Train Epoch: 30 [331/1000 10592/32000 (33%)] Loss: 0.39128 (QuantReg: 13.64175) QuantErr: 13.64175 batch_time=0.36707 
Train Epoch: 30 [336/1000 10752/32000 (34%)] Loss: 0.23231 (QuantReg: 13.51998) QuantErr: 13.51998 batch_time=0.34052 
Train Epoch: 30 [341/1000 10912/32000 (34%)] Loss: 0.32399 (QuantReg: 13.05948) QuantErr: 13.05948 batch_time=0.53695 
Train Epoch: 30 [346/1000 11072/32000 (35%)] Loss: 0.26324 (QuantReg: 12.55743) QuantErr: 12.55743 batch_time=0.34167 
Train Epoch: 30 [351/1000 11232/32000 (35%)] Loss: 0.58481 (QuantReg: 12.81639) QuantErr: 12.81639 batch_time=0.47343 
Train Epoch: 30 [356/1000 11392/32000 (36%)] Loss: 0.44706 (QuantReg: 13.13834) QuantErr: 13.13834 batch_time=0.42961 
Train Epoch: 30 [361/1000 11552/32000 (36%)] Loss: 0.47561 (QuantReg: 12.84299) QuantErr: 12.84299 batch_time=0.35806 
Train Epoch: 30 [366/1000 11712/32000 (37%)] Loss: 0.50002 (QuantReg: 12.70548) QuantErr: 12.70548 batch_time=0.41307 
Train Epoch: 30 [371/1000 11872/32000 (37%)] Loss: 0.59302 (QuantReg: 12.31422) QuantErr: 12.31422 batch_time=0.37788 
Train Epoch: 30 [376/1000 12032/32000 (38%)] Loss: 0.33981 (QuantReg: 12.19223) QuantErr: 12.19223 batch_time=0.41529 
Train Epoch: 30 [381/1000 12192/32000 (38%)] Loss: 0.38447 (QuantReg: 13.19664) QuantErr: 13.19664 batch_time=0.43336 
Train Epoch: 30 [386/1000 12352/32000 (39%)] Loss: 0.19621 (QuantReg: 12.97701) QuantErr: 12.97701 batch_time=0.34648 
Train Epoch: 30 [391/1000 12512/32000 (39%)] Loss: 0.47554 (QuantReg: 13.48189) QuantErr: 13.48189 batch_time=0.60807 
Train Epoch: 30 [396/1000 12672/32000 (40%)] Loss: 0.17350 (QuantReg: 13.44564) QuantErr: 13.44564 batch_time=0.39278 
Train Epoch: 30 [401/1000 12832/32000 (40%)] Loss: 0.34773 (QuantReg: 13.24604) QuantErr: 13.24604 batch_time=0.38602 
Train Epoch: 30 [406/1000 12992/32000 (41%)] Loss: 0.33363 (QuantReg: 13.03270) QuantErr: 13.03270 batch_time=0.38951 
Train Epoch: 30 [411/1000 13152/32000 (41%)] Loss: 0.26758 (QuantReg: 12.46755) QuantErr: 12.46755 batch_time=0.37393 
Train Epoch: 30 [416/1000 13312/32000 (42%)] Loss: 0.85823 (QuantReg: 11.86412) QuantErr: 11.86412 batch_time=0.36617 
Train Epoch: 30 [421/1000 13472/32000 (42%)] Loss: 0.87810 (QuantReg: 12.09300) QuantErr: 12.09300 batch_time=0.39045 
Train Epoch: 30 [426/1000 13632/32000 (43%)] Loss: 0.27311 (QuantReg: 12.63463) QuantErr: 12.63463 batch_time=0.42496 
Train Epoch: 30 [431/1000 13792/32000 (43%)] Loss: 0.26459 (QuantReg: 12.52389) QuantErr: 12.52389 batch_time=0.35359 
Train Epoch: 30 [436/1000 13952/32000 (44%)] Loss: 0.39005 (QuantReg: 12.50819) QuantErr: 12.50819 batch_time=0.45743 
Train Epoch: 30 [441/1000 14112/32000 (44%)] Loss: 0.24955 (QuantReg: 13.08303) QuantErr: 13.08303 batch_time=0.36726 
Train Epoch: 30 [446/1000 14272/32000 (45%)] Loss: 0.43306 (QuantReg: 12.03232) QuantErr: 12.03232 batch_time=0.36962 
Train Epoch: 30 [451/1000 14432/32000 (45%)] Loss: 0.21775 (QuantReg: 12.49541) QuantErr: 12.49541 batch_time=0.35683 
Train Epoch: 30 [456/1000 14592/32000 (46%)] Loss: 0.65460 (QuantReg: 12.20787) QuantErr: 12.20787 batch_time=0.34207 
Train Epoch: 30 [461/1000 14752/32000 (46%)] Loss: 0.36559 (QuantReg: 12.37996) QuantErr: 12.37996 batch_time=0.36274 
Train Epoch: 30 [466/1000 14912/32000 (47%)] Loss: 0.34350 (QuantReg: 12.63827) QuantErr: 12.63827 batch_time=0.42934 
Train Epoch: 30 [471/1000 15072/32000 (47%)] Loss: 0.34366 (QuantReg: 12.99585) QuantErr: 12.99585 batch_time=0.35416 
Train Epoch: 30 [476/1000 15232/32000 (48%)] Loss: 0.30655 (QuantReg: 13.27767) QuantErr: 13.27767 batch_time=0.42688 
Train Epoch: 30 [481/1000 15392/32000 (48%)] Loss: 0.49134 (QuantReg: 13.21248) QuantErr: 13.21248 batch_time=0.36167 
Train Epoch: 30 [486/1000 15552/32000 (49%)] Loss: 0.53775 (QuantReg: 12.37473) QuantErr: 12.37473 batch_time=0.46341 
Train Epoch: 30 [491/1000 15712/32000 (49%)] Loss: 0.43930 (QuantReg: 12.37310) QuantErr: 12.37310 batch_time=0.53670 
Train Epoch: 30 [496/1000 15872/32000 (50%)] Loss: 0.62995 (QuantReg: 12.59681) QuantErr: 12.59681 batch_time=0.37990 
Train Epoch: 30 [501/1000 16032/32000 (50%)] Loss: 0.43601 (QuantReg: 12.64018) QuantErr: 12.64018 batch_time=0.48184 
Train Epoch: 30 [506/1000 16192/32000 (51%)] Loss: 0.46114 (QuantReg: 12.18236) QuantErr: 12.18236 batch_time=0.33731 
Train Epoch: 30 [511/1000 16352/32000 (51%)] Loss: 0.32743 (QuantReg: 13.26224) QuantErr: 13.26224 batch_time=0.42338 
Train Epoch: 30 [516/1000 16512/32000 (52%)] Loss: 0.38904 (QuantReg: 12.72341) QuantErr: 12.72341 batch_time=0.36943 
Train Epoch: 30 [521/1000 16672/32000 (52%)] Loss: 0.20657 (QuantReg: 13.66074) QuantErr: 13.66074 batch_time=0.35462 
Train Epoch: 30 [526/1000 16832/32000 (53%)] Loss: 0.39581 (QuantReg: 12.82525) QuantErr: 12.82525 batch_time=0.43051 
Train Epoch: 30 [531/1000 16992/32000 (53%)] Loss: 0.23096 (QuantReg: 12.79335) QuantErr: 12.79335 batch_time=0.38691 
Train Epoch: 30 [536/1000 17152/32000 (54%)] Loss: 0.09478 (QuantReg: 13.47727) QuantErr: 13.47727 batch_time=3.01176 
Train Epoch: 30 [541/1000 17312/32000 (54%)] Loss: 0.31909 (QuantReg: 13.13589) QuantErr: 13.13589 batch_time=0.33849 
Train Epoch: 30 [546/1000 17472/32000 (55%)] Loss: 0.44535 (QuantReg: 12.29580) QuantErr: 12.29580 batch_time=0.39186 
Train Epoch: 30 [551/1000 17632/32000 (55%)] Loss: 0.35474 (QuantReg: 12.45104) QuantErr: 12.45104 batch_time=0.36013 
Train Epoch: 30 [556/1000 17792/32000 (56%)] Loss: 0.65869 (QuantReg: 12.17835) QuantErr: 12.17835 batch_time=0.34536 
Train Epoch: 30 [561/1000 17952/32000 (56%)] Loss: 0.31033 (QuantReg: 12.73468) QuantErr: 12.73468 batch_time=0.40304 
Train Epoch: 30 [566/1000 18112/32000 (57%)] Loss: 0.48390 (QuantReg: 12.74645) QuantErr: 12.74645 batch_time=0.35845 
Train Epoch: 30 [571/1000 18272/32000 (57%)] Loss: 0.06458 (QuantReg: 13.30449) QuantErr: 13.30449 batch_time=0.35481 
Train Epoch: 30 [576/1000 18432/32000 (58%)] Loss: 0.31836 (QuantReg: 12.69752) QuantErr: 12.69752 batch_time=0.40073 
Train Epoch: 30 [581/1000 18592/32000 (58%)] Loss: 0.25100 (QuantReg: 13.15166) QuantErr: 13.15166 batch_time=0.63837 
Train Epoch: 30 [586/1000 18752/32000 (59%)] Loss: 0.36479 (QuantReg: 12.96029) QuantErr: 12.96029 batch_time=0.66612 
Train Epoch: 30 [591/1000 18912/32000 (59%)] Loss: 0.25165 (QuantReg: 12.69574) QuantErr: 12.69574 batch_time=0.40468 
Train Epoch: 30 [596/1000 19072/32000 (60%)] Loss: 0.32957 (QuantReg: 12.72347) QuantErr: 12.72347 batch_time=0.44748 
Train Epoch: 30 [601/1000 19232/32000 (60%)] Loss: 0.48214 (QuantReg: 13.36872) QuantErr: 13.36872 batch_time=0.39866 
Train Epoch: 30 [606/1000 19392/32000 (61%)] Loss: 0.22557 (QuantReg: 12.60486) QuantErr: 12.60486 batch_time=0.35930 
Train Epoch: 30 [611/1000 19552/32000 (61%)] Loss: 0.47490 (QuantReg: 12.15011) QuantErr: 12.15011 batch_time=0.35608 
Train Epoch: 30 [616/1000 19712/32000 (62%)] Loss: 0.37791 (QuantReg: 13.55321) QuantErr: 13.55321 batch_time=0.48978 
Train Epoch: 30 [621/1000 19872/32000 (62%)] Loss: 0.77256 (QuantReg: 12.79226) QuantErr: 12.79226 batch_time=0.38328 
Train Epoch: 30 [626/1000 20032/32000 (63%)] Loss: 0.30948 (QuantReg: 12.54315) QuantErr: 12.54315 batch_time=0.51423 
Train Epoch: 30 [631/1000 20192/32000 (63%)] Loss: 0.27518 (QuantReg: 13.31502) QuantErr: 13.31502 batch_time=0.46817 
Train Epoch: 30 [636/1000 20352/32000 (64%)] Loss: 0.82309 (QuantReg: 12.35045) QuantErr: 12.35045 batch_time=0.39447 
Train Epoch: 30 [641/1000 20512/32000 (64%)] Loss: 0.75539 (QuantReg: 12.71307) QuantErr: 12.71307 batch_time=0.34036 
Train Epoch: 30 [646/1000 20672/32000 (65%)] Loss: 0.76598 (QuantReg: 12.83932) QuantErr: 12.83932 batch_time=0.48631 
Train Epoch: 30 [651/1000 20832/32000 (65%)] Loss: 0.25878 (QuantReg: 12.82687) QuantErr: 12.82687 batch_time=0.44256 
Train Epoch: 30 [656/1000 20992/32000 (66%)] Loss: 0.44954 (QuantReg: 13.25717) QuantErr: 13.25717 batch_time=0.36500 
Train Epoch: 30 [661/1000 21152/32000 (66%)] Loss: 0.26088 (QuantReg: 12.85884) QuantErr: 12.85884 batch_time=0.34173 
Train Epoch: 30 [666/1000 21312/32000 (67%)] Loss: 0.48594 (QuantReg: 12.90541) QuantErr: 12.90541 batch_time=0.49894 
Train Epoch: 30 [671/1000 21472/32000 (67%)] Loss: 0.55417 (QuantReg: 13.01730) QuantErr: 13.01730 batch_time=0.37351 
Train Epoch: 30 [676/1000 21632/32000 (68%)] Loss: 0.34893 (QuantReg: 12.99429) QuantErr: 12.99429 batch_time=0.73961 
Train Epoch: 30 [681/1000 21792/32000 (68%)] Loss: 0.15659 (QuantReg: 13.40611) QuantErr: 13.40611 batch_time=0.41100 
Train Epoch: 30 [686/1000 21952/32000 (69%)] Loss: 0.20485 (QuantReg: 13.30855) QuantErr: 13.30855 batch_time=0.38083 
Train Epoch: 30 [691/1000 22112/32000 (69%)] Loss: 0.35779 (QuantReg: 12.41716) QuantErr: 12.41716 batch_time=0.39795 
Train Epoch: 30 [696/1000 22272/32000 (70%)] Loss: 0.74630 (QuantReg: 12.33821) QuantErr: 12.33821 batch_time=0.35660 
Train Epoch: 30 [701/1000 22432/32000 (70%)] Loss: 0.47103 (QuantReg: 12.96396) QuantErr: 12.96396 batch_time=0.45642 
Train Epoch: 30 [706/1000 22592/32000 (71%)] Loss: 0.28322 (QuantReg: 12.79757) QuantErr: 12.79757 batch_time=0.36404 
Train Epoch: 30 [711/1000 22752/32000 (71%)] Loss: 0.26445 (QuantReg: 13.20094) QuantErr: 13.20094 batch_time=0.39661 
Train Epoch: 30 [716/1000 22912/32000 (72%)] Loss: 0.45341 (QuantReg: 12.61444) QuantErr: 12.61444 batch_time=0.35873 
Train Epoch: 30 [721/1000 23072/32000 (72%)] Loss: 0.32367 (QuantReg: 12.88115) QuantErr: 12.88115 batch_time=0.36246 
Train Epoch: 30 [726/1000 23232/32000 (73%)] Loss: 0.25670 (QuantReg: 13.23145) QuantErr: 13.23145 batch_time=0.54279 
Train Epoch: 30 [731/1000 23392/32000 (73%)] Loss: 0.33221 (QuantReg: 13.51661) QuantErr: 13.51661 batch_time=0.48226 
Train Epoch: 30 [736/1000 23552/32000 (74%)] Loss: 0.78527 (QuantReg: 12.99285) QuantErr: 12.99285 batch_time=0.50436 
Train Epoch: 30 [741/1000 23712/32000 (74%)] Loss: 0.34625 (QuantReg: 13.01523) QuantErr: 13.01523 batch_time=0.37176 
Train Epoch: 30 [746/1000 23872/32000 (75%)] Loss: 0.46356 (QuantReg: 13.04650) QuantErr: 13.04650 batch_time=0.41005 
Train Epoch: 30 [751/1000 24032/32000 (75%)] Loss: 0.12665 (QuantReg: 13.24204) QuantErr: 13.24204 batch_time=0.39839 
Train Epoch: 30 [756/1000 24192/32000 (76%)] Loss: 0.39910 (QuantReg: 12.89509) QuantErr: 12.89509 batch_time=0.35612 
Train Epoch: 30 [761/1000 24352/32000 (76%)] Loss: 0.29157 (QuantReg: 13.32114) QuantErr: 13.32114 batch_time=0.38912 
Train Epoch: 30 [766/1000 24512/32000 (77%)] Loss: 0.33724 (QuantReg: 12.40756) QuantErr: 12.40756 batch_time=0.56305 
Train Epoch: 30 [771/1000 24672/32000 (77%)] Loss: 0.40417 (QuantReg: 12.93678) QuantErr: 12.93678 batch_time=0.60806 
Train Epoch: 30 [776/1000 24832/32000 (78%)] Loss: 0.29733 (QuantReg: 13.19330) QuantErr: 13.19330 batch_time=0.61380 
Train Epoch: 30 [781/1000 24992/32000 (78%)] Loss: 0.65622 (QuantReg: 12.83055) QuantErr: 12.83055 batch_time=0.37407 
Train Epoch: 30 [786/1000 25152/32000 (79%)] Loss: 0.28576 (QuantReg: 12.23351) QuantErr: 12.23351 batch_time=0.34665 
Train Epoch: 30 [791/1000 25312/32000 (79%)] Loss: 0.14124 (QuantReg: 12.93933) QuantErr: 12.93933 batch_time=0.40007 
Train Epoch: 30 [796/1000 25472/32000 (80%)] Loss: 0.45678 (QuantReg: 13.27928) QuantErr: 13.27928 batch_time=0.35967 
Train Epoch: 30 [801/1000 25632/32000 (80%)] Loss: 0.22306 (QuantReg: 13.33759) QuantErr: 13.33759 batch_time=0.44551 
Train Epoch: 30 [806/1000 25792/32000 (81%)] Loss: 0.17188 (QuantReg: 12.63493) QuantErr: 12.63493 batch_time=0.46905 
Train Epoch: 30 [811/1000 25952/32000 (81%)] Loss: 0.23170 (QuantReg: 12.74022) QuantErr: 12.74022 batch_time=0.35062 
Train Epoch: 30 [816/1000 26112/32000 (82%)] Loss: 0.55549 (QuantReg: 12.26800) QuantErr: 12.26800 batch_time=0.40746 
Train Epoch: 30 [821/1000 26272/32000 (82%)] Loss: 0.66336 (QuantReg: 12.95865) QuantErr: 12.95865 batch_time=0.48828 
Train Epoch: 30 [826/1000 26432/32000 (83%)] Loss: 0.23208 (QuantReg: 13.20551) QuantErr: 13.20551 batch_time=0.38821 
Train Epoch: 30 [831/1000 26592/32000 (83%)] Loss: 0.69907 (QuantReg: 12.79601) QuantErr: 12.79601 batch_time=0.35767 
Train Epoch: 30 [836/1000 26752/32000 (84%)] Loss: 0.33264 (QuantReg: 12.68866) QuantErr: 12.68866 batch_time=0.55091 
Train Epoch: 30 [841/1000 26912/32000 (84%)] Loss: 0.31194 (QuantReg: 13.10395) QuantErr: 13.10395 batch_time=0.35183 
Train Epoch: 30 [846/1000 27072/32000 (85%)] Loss: 0.29350 (QuantReg: 12.75106) QuantErr: 12.75106 batch_time=0.36006 
Train Epoch: 30 [851/1000 27232/32000 (85%)] Loss: 0.24097 (QuantReg: 12.69814) QuantErr: 12.69814 batch_time=0.45380 
Train Epoch: 30 [856/1000 27392/32000 (86%)] Loss: 0.39152 (QuantReg: 12.85635) QuantErr: 12.85635 batch_time=1.97476 
Train Epoch: 30 [861/1000 27552/32000 (86%)] Loss: 0.18437 (QuantReg: 13.26749) QuantErr: 13.26749 batch_time=0.44970 
Train Epoch: 30 [866/1000 27712/32000 (87%)] Loss: 0.18630 (QuantReg: 12.84196) QuantErr: 12.84196 batch_time=0.35012 
Train Epoch: 30 [871/1000 27872/32000 (87%)] Loss: 0.43663 (QuantReg: 12.10750) QuantErr: 12.10750 batch_time=0.55773 
Train Epoch: 30 [876/1000 28032/32000 (88%)] Loss: 0.27438 (QuantReg: 12.88813) QuantErr: 12.88813 batch_time=0.52368 
Train Epoch: 30 [881/1000 28192/32000 (88%)] Loss: 0.27819 (QuantReg: 12.25913) QuantErr: 12.25913 batch_time=0.46587 
Train Epoch: 30 [886/1000 28352/32000 (89%)] Loss: 0.44296 (QuantReg: 12.52723) QuantErr: 12.52723 batch_time=0.38918 
Train Epoch: 30 [891/1000 28512/32000 (89%)] Loss: 0.38607 (QuantReg: 13.19561) QuantErr: 13.19561 batch_time=0.43942 
Train Epoch: 30 [896/1000 28672/32000 (90%)] Loss: 0.87327 (QuantReg: 12.93105) QuantErr: 12.93105 batch_time=0.39307 
Train Epoch: 30 [901/1000 28832/32000 (90%)] Loss: 0.35250 (QuantReg: 13.14138) QuantErr: 13.14138 batch_time=0.41139 
Train Epoch: 30 [906/1000 28992/32000 (91%)] Loss: 0.33905 (QuantReg: 13.04163) QuantErr: 13.04163 batch_time=0.36808 
Train Epoch: 30 [911/1000 29152/32000 (91%)] Loss: 0.17048 (QuantReg: 13.38249) QuantErr: 13.38249 batch_time=0.34879 
Train Epoch: 30 [916/1000 29312/32000 (92%)] Loss: 0.77911 (QuantReg: 12.73077) QuantErr: 12.73077 batch_time=0.79910 
Train Epoch: 30 [921/1000 29472/32000 (92%)] Loss: 0.12413 (QuantReg: 12.75727) QuantErr: 12.75727 batch_time=0.38745 
Train Epoch: 30 [926/1000 29632/32000 (93%)] Loss: 0.22954 (QuantReg: 13.37394) QuantErr: 13.37394 batch_time=0.59962 
Train Epoch: 30 [931/1000 29792/32000 (93%)] Loss: 0.46819 (QuantReg: 12.73668) QuantErr: 12.73668 batch_time=0.36610 
Train Epoch: 30 [936/1000 29952/32000 (94%)] Loss: 0.33575 (QuantReg: 13.07731) QuantErr: 13.07731 batch_time=0.38385 
Train Epoch: 30 [941/1000 30112/32000 (94%)] Loss: 0.46723 (QuantReg: 12.46905) QuantErr: 12.46905 batch_time=0.44701 
Train Epoch: 30 [946/1000 30272/32000 (95%)] Loss: 0.28071 (QuantReg: 13.13143) QuantErr: 13.13143 batch_time=0.43242 
Train Epoch: 30 [951/1000 30432/32000 (95%)] Loss: 0.20181 (QuantReg: 13.39603) QuantErr: 13.39603 batch_time=0.39437 
Train Epoch: 30 [956/1000 30592/32000 (96%)] Loss: 0.17111 (QuantReg: 12.84442) QuantErr: 12.84442 batch_time=0.40424 
Train Epoch: 30 [961/1000 30752/32000 (96%)] Loss: 0.21899 (QuantReg: 12.56627) QuantErr: 12.56627 batch_time=0.80811 
Train Epoch: 30 [966/1000 30912/32000 (97%)] Loss: 0.42906 (QuantReg: 13.32112) QuantErr: 13.32112 batch_time=0.38629 
Train Epoch: 30 [971/1000 31072/32000 (97%)] Loss: 0.21045 (QuantReg: 13.07518) QuantErr: 13.07518 batch_time=0.34957 
Train Epoch: 30 [976/1000 31232/32000 (98%)] Loss: 0.45490 (QuantReg: 13.21980) QuantErr: 13.21980 batch_time=0.42581 
Train Epoch: 30 [981/1000 31392/32000 (98%)] Loss: 0.47754 (QuantReg: 12.78173) QuantErr: 12.78173 batch_time=0.41679 
Train Epoch: 30 [986/1000 31552/32000 (99%)] Loss: 0.41813 (QuantReg: 12.95120) QuantErr: 12.95120 batch_time=0.41542 
Train Epoch: 30 [991/1000 31712/32000 (99%)] Loss: 0.32692 (QuantReg: 13.04793) QuantErr: 13.04793 batch_time=0.41452 
Train Epoch: 30 [996/1000 31872/32000 (100%)] Loss: 0.50677 (QuantReg: 13.06905) QuantErr: 13.06905 batch_time=0.37018 
Train Epoch: 30 codebook_update_time=3.52518
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch30.pth ...
Done in 15.013s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch30.pth ...
Done in 19.598s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 0.38075098068267105
 quant_reg      : 12.846118988990783
 quant_err      : 12.846118988990783
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 30000
 MSRVTT_miech_test/t2v_metrics/R1: 20.7
 MSRVTT_miech_test/t2v_metrics/R5: 49.3
 MSRVTT_miech_test/t2v_metrics/R10: 62.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.5
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.967
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.91184188808923
 MSRVTT_miech_test/v2t_metrics/R1: 20.4
 MSRVTT_miech_test/v2t_metrics/R5: 49.0
 MSRVTT_miech_test/v2t_metrics/R10: 62.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.767
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.76420440892475
 mnt_best       : 39.91184188808923
 not_improved_count: 0
Train Epoch: 31 [1/1000 32/32000 (0%)] Loss: 0.31973 (QuantReg: 13.52709) QuantErr: 13.52709 batch_time=29.39227 
Train Epoch: 31 [6/1000 192/32000 (1%)] Loss: 0.19803 (QuantReg: 13.40236) QuantErr: 13.40236 batch_time=0.46760 
Train Epoch: 31 [11/1000 352/32000 (1%)] Loss: 0.18958 (QuantReg: 13.04061) QuantErr: 13.04061 batch_time=0.34464 
Train Epoch: 31 [16/1000 512/32000 (2%)] Loss: 0.46097 (QuantReg: 13.26083) QuantErr: 13.26083 batch_time=2.20497 
Train Epoch: 31 [21/1000 672/32000 (2%)] Loss: 0.26403 (QuantReg: 13.51484) QuantErr: 13.51484 batch_time=0.34249 
Train Epoch: 31 [26/1000 832/32000 (3%)] Loss: 0.70428 (QuantReg: 13.23461) QuantErr: 13.23461 batch_time=0.33685 
Train Epoch: 31 [31/1000 992/32000 (3%)] Loss: 0.28021 (QuantReg: 12.63261) QuantErr: 12.63261 batch_time=0.35275 
Train Epoch: 31 [36/1000 1152/32000 (4%)] Loss: 0.30847 (QuantReg: 12.86904) QuantErr: 12.86904 batch_time=0.41188 
Train Epoch: 31 [41/1000 1312/32000 (4%)] Loss: 0.20381 (QuantReg: 13.09310) QuantErr: 13.09310 batch_time=0.37071 
Train Epoch: 31 [46/1000 1472/32000 (5%)] Loss: 0.12558 (QuantReg: 12.54766) QuantErr: 12.54766 batch_time=0.34696 
Train Epoch: 31 [51/1000 1632/32000 (5%)] Loss: 0.64150 (QuantReg: 12.06295) QuantErr: 12.06295 batch_time=0.47302 
Train Epoch: 31 [56/1000 1792/32000 (6%)] Loss: 0.24843 (QuantReg: 12.32819) QuantErr: 12.32819 batch_time=0.33634 
Train Epoch: 31 [61/1000 1952/32000 (6%)] Loss: 0.52660 (QuantReg: 12.64136) QuantErr: 12.64136 batch_time=0.68733 
Train Epoch: 31 [66/1000 2112/32000 (7%)] Loss: 0.27257 (QuantReg: 12.32394) QuantErr: 12.32394 batch_time=0.37196 
Train Epoch: 31 [71/1000 2272/32000 (7%)] Loss: 0.22413 (QuantReg: 12.19436) QuantErr: 12.19436 batch_time=0.44471 
Train Epoch: 31 [76/1000 2432/32000 (8%)] Loss: 0.73363 (QuantReg: 13.00222) QuantErr: 13.00222 batch_time=0.43788 
Train Epoch: 31 [81/1000 2592/32000 (8%)] Loss: 0.18455 (QuantReg: 12.63232) QuantErr: 12.63232 batch_time=0.40377 
Train Epoch: 31 [86/1000 2752/32000 (9%)] Loss: 0.15216 (QuantReg: 13.39373) QuantErr: 13.39373 batch_time=0.35910 
Train Epoch: 31 [91/1000 2912/32000 (9%)] Loss: 0.24388 (QuantReg: 13.12536) QuantErr: 13.12536 batch_time=0.46470 
Train Epoch: 31 [96/1000 3072/32000 (10%)] Loss: 0.28064 (QuantReg: 12.90694) QuantErr: 12.90694 batch_time=0.35661 
Train Epoch: 31 [101/1000 3232/32000 (10%)] Loss: 0.18508 (QuantReg: 12.93330) QuantErr: 12.93330 batch_time=0.35768 
Train Epoch: 31 [106/1000 3392/32000 (11%)] Loss: 0.39947 (QuantReg: 12.65765) QuantErr: 12.65765 batch_time=0.34520 
Train Epoch: 31 [111/1000 3552/32000 (11%)] Loss: 0.51689 (QuantReg: 12.38716) QuantErr: 12.38716 batch_time=0.55755 
Train Epoch: 31 [116/1000 3712/32000 (12%)] Loss: 0.26882 (QuantReg: 12.73982) QuantErr: 12.73982 batch_time=0.67228 
Train Epoch: 31 [121/1000 3872/32000 (12%)] Loss: 0.15412 (QuantReg: 12.77444) QuantErr: 12.77444 batch_time=0.36718 
Train Epoch: 31 [126/1000 4032/32000 (13%)] Loss: 0.15215 (QuantReg: 13.21015) QuantErr: 13.21015 batch_time=0.39934 
Train Epoch: 31 [131/1000 4192/32000 (13%)] Loss: 0.21945 (QuantReg: 12.87741) QuantErr: 12.87741 batch_time=0.34343 
Train Epoch: 31 [136/1000 4352/32000 (14%)] Loss: 0.63463 (QuantReg: 12.59986) QuantErr: 12.59986 batch_time=0.38393 
Train Epoch: 31 [141/1000 4512/32000 (14%)] Loss: 0.17915 (QuantReg: 13.20118) QuantErr: 13.20118 batch_time=0.35856 
Train Epoch: 31 [146/1000 4672/32000 (15%)] Loss: 0.32593 (QuantReg: 13.01931) QuantErr: 13.01931 batch_time=0.52926 
Train Epoch: 31 [151/1000 4832/32000 (15%)] Loss: 0.19464 (QuantReg: 13.03012) QuantErr: 13.03012 batch_time=1.11706 
Train Epoch: 31 [156/1000 4992/32000 (16%)] Loss: 0.47112 (QuantReg: 12.56541) QuantErr: 12.56541 batch_time=0.35327 
Train Epoch: 31 [161/1000 5152/32000 (16%)] Loss: 0.38684 (QuantReg: 13.00795) QuantErr: 13.00795 batch_time=0.42724 
Train Epoch: 31 [166/1000 5312/32000 (17%)] Loss: 0.29215 (QuantReg: 12.97977) QuantErr: 12.97977 batch_time=0.36821 
Train Epoch: 31 [171/1000 5472/32000 (17%)] Loss: 0.29206 (QuantReg: 13.42277) QuantErr: 13.42277 batch_time=0.48494 
Train Epoch: 31 [176/1000 5632/32000 (18%)] Loss: 0.27691 (QuantReg: 12.62764) QuantErr: 12.62764 batch_time=0.43266 
Train Epoch: 31 [181/1000 5792/32000 (18%)] Loss: 0.39051 (QuantReg: 13.26851) QuantErr: 13.26851 batch_time=0.52756 
Train Epoch: 31 [186/1000 5952/32000 (19%)] Loss: 0.40421 (QuantReg: 12.79971) QuantErr: 12.79971 batch_time=0.34569 
Train Epoch: 31 [191/1000 6112/32000 (19%)] Loss: 0.45778 (QuantReg: 13.23397) QuantErr: 13.23397 batch_time=0.44137 
Train Epoch: 31 [196/1000 6272/32000 (20%)] Loss: 0.21575 (QuantReg: 13.20243) QuantErr: 13.20243 batch_time=0.44727 
Train Epoch: 31 [201/1000 6432/32000 (20%)] Loss: 0.38386 (QuantReg: 12.87576) QuantErr: 12.87576 batch_time=0.33985 
Train Epoch: 31 [206/1000 6592/32000 (21%)] Loss: 0.25923 (QuantReg: 12.46535) QuantErr: 12.46535 batch_time=0.53664 
Train Epoch: 31 [211/1000 6752/32000 (21%)] Loss: 0.43119 (QuantReg: 13.06009) QuantErr: 13.06009 batch_time=0.33881 
Train Epoch: 31 [216/1000 6912/32000 (22%)] Loss: 0.42544 (QuantReg: 12.29077) QuantErr: 12.29077 batch_time=0.39982 
Train Epoch: 31 [221/1000 7072/32000 (22%)] Loss: 0.69464 (QuantReg: 12.49792) QuantErr: 12.49792 batch_time=0.36437 
Train Epoch: 31 [226/1000 7232/32000 (23%)] Loss: 0.33915 (QuantReg: 12.35543) QuantErr: 12.35543 batch_time=0.53286 
Train Epoch: 31 [231/1000 7392/32000 (23%)] Loss: 0.50436 (QuantReg: 13.12932) QuantErr: 13.12932 batch_time=0.36574 
Train Epoch: 31 [236/1000 7552/32000 (24%)] Loss: 0.35066 (QuantReg: 12.00676) QuantErr: 12.00676 batch_time=0.37056 
Train Epoch: 31 [241/1000 7712/32000 (24%)] Loss: 0.45294 (QuantReg: 12.52554) QuantErr: 12.52554 batch_time=0.34830 
Train Epoch: 31 [246/1000 7872/32000 (25%)] Loss: 0.26161 (QuantReg: 13.46433) QuantErr: 13.46433 batch_time=0.42126 
Train Epoch: 31 [251/1000 8032/32000 (25%)] Loss: 0.35040 (QuantReg: 12.67328) QuantErr: 12.67328 batch_time=0.41643 
Train Epoch: 31 [256/1000 8192/32000 (26%)] Loss: 0.29362 (QuantReg: 13.55979) QuantErr: 13.55979 batch_time=0.66806 
Train Epoch: 31 [261/1000 8352/32000 (26%)] Loss: 0.37808 (QuantReg: 12.90605) QuantErr: 12.90605 batch_time=0.53510 
Train Epoch: 31 [266/1000 8512/32000 (27%)] Loss: 0.13398 (QuantReg: 13.80004) QuantErr: 13.80004 batch_time=0.34244 
Train Epoch: 31 [271/1000 8672/32000 (27%)] Loss: 0.28048 (QuantReg: 13.38202) QuantErr: 13.38202 batch_time=0.47978 
Train Epoch: 31 [276/1000 8832/32000 (28%)] Loss: 0.37329 (QuantReg: 13.31754) QuantErr: 13.31754 batch_time=0.44703 
Train Epoch: 31 [281/1000 8992/32000 (28%)] Loss: 0.46052 (QuantReg: 12.61951) QuantErr: 12.61951 batch_time=0.35545 
Train Epoch: 31 [286/1000 9152/32000 (29%)] Loss: 0.48254 (QuantReg: 12.93336) QuantErr: 12.93336 batch_time=0.35142 
Train Epoch: 31 [291/1000 9312/32000 (29%)] Loss: 0.27752 (QuantReg: 13.35283) QuantErr: 13.35283 batch_time=0.34764 
Train Epoch: 31 [296/1000 9472/32000 (30%)] Loss: 0.19638 (QuantReg: 12.97729) QuantErr: 12.97729 batch_time=0.51225 
Train Epoch: 31 [301/1000 9632/32000 (30%)] Loss: 0.29910 (QuantReg: 13.42983) QuantErr: 13.42983 batch_time=0.39115 
Train Epoch: 31 [306/1000 9792/32000 (31%)] Loss: 0.13027 (QuantReg: 12.75502) QuantErr: 12.75502 batch_time=0.59353 
Train Epoch: 31 [311/1000 9952/32000 (31%)] Loss: 0.37282 (QuantReg: 12.52525) QuantErr: 12.52525 batch_time=0.43877 
Train Epoch: 31 [316/1000 10112/32000 (32%)] Loss: 0.36648 (QuantReg: 12.35010) QuantErr: 12.35010 batch_time=0.43767 
Train Epoch: 31 [321/1000 10272/32000 (32%)] Loss: 0.14021 (QuantReg: 13.60835) QuantErr: 13.60835 batch_time=0.34911 
Train Epoch: 31 [326/1000 10432/32000 (33%)] Loss: 0.55909 (QuantReg: 12.63475) QuantErr: 12.63475 batch_time=0.37906 
Train Epoch: 31 [331/1000 10592/32000 (33%)] Loss: 0.26078 (QuantReg: 13.36166) QuantErr: 13.36166 batch_time=0.34113 
Train Epoch: 31 [336/1000 10752/32000 (34%)] Loss: 0.12226 (QuantReg: 13.19490) QuantErr: 13.19490 batch_time=1.28905 
Train Epoch: 31 [341/1000 10912/32000 (34%)] Loss: 0.52906 (QuantReg: 12.53060) QuantErr: 12.53060 batch_time=2.63236 
Train Epoch: 31 [346/1000 11072/32000 (35%)] Loss: 0.30547 (QuantReg: 12.57214) QuantErr: 12.57214 batch_time=0.34276 
Train Epoch: 31 [351/1000 11232/32000 (35%)] Loss: 0.57777 (QuantReg: 12.17697) QuantErr: 12.17697 batch_time=0.77722 
Train Epoch: 31 [356/1000 11392/32000 (36%)] Loss: 0.26919 (QuantReg: 13.06591) QuantErr: 13.06591 batch_time=0.36384 
Train Epoch: 31 [361/1000 11552/32000 (36%)] Loss: 0.38713 (QuantReg: 12.47223) QuantErr: 12.47223 batch_time=0.40337 
Train Epoch: 31 [366/1000 11712/32000 (37%)] Loss: 0.43656 (QuantReg: 13.02672) QuantErr: 13.02672 batch_time=0.34476 
Train Epoch: 31 [371/1000 11872/32000 (37%)] Loss: 0.25447 (QuantReg: 12.26323) QuantErr: 12.26323 batch_time=0.45290 
Train Epoch: 31 [376/1000 12032/32000 (38%)] Loss: 0.40081 (QuantReg: 12.85938) QuantErr: 12.85938 batch_time=0.36444 
Train Epoch: 31 [381/1000 12192/32000 (38%)] Loss: 0.26259 (QuantReg: 13.31138) QuantErr: 13.31138 batch_time=0.37282 
Train Epoch: 31 [386/1000 12352/32000 (39%)] Loss: 0.31057 (QuantReg: 12.60498) QuantErr: 12.60498 batch_time=0.36393 
Train Epoch: 31 [391/1000 12512/32000 (39%)] Loss: 0.74489 (QuantReg: 12.52899) QuantErr: 12.52899 batch_time=0.37119 
Train Epoch: 31 [396/1000 12672/32000 (40%)] Loss: 0.25352 (QuantReg: 12.53083) QuantErr: 12.53083 batch_time=0.49616 
Train Epoch: 31 [401/1000 12832/32000 (40%)] Loss: 0.55366 (QuantReg: 12.59985) QuantErr: 12.59985 batch_time=0.45987 
Train Epoch: 31 [406/1000 12992/32000 (41%)] Loss: 0.64937 (QuantReg: 13.16977) QuantErr: 13.16977 batch_time=0.36123 
Train Epoch: 31 [411/1000 13152/32000 (41%)] Loss: 0.45882 (QuantReg: 12.66758) QuantErr: 12.66758 batch_time=0.34465 
Train Epoch: 31 [416/1000 13312/32000 (42%)] Loss: 0.41173 (QuantReg: 12.80453) QuantErr: 12.80453 batch_time=0.38214 
Train Epoch: 31 [421/1000 13472/32000 (42%)] Loss: 0.12365 (QuantReg: 13.01475) QuantErr: 13.01475 batch_time=0.40469 
Train Epoch: 31 [426/1000 13632/32000 (43%)] Loss: 0.23320 (QuantReg: 13.09926) QuantErr: 13.09926 batch_time=0.38244 
Train Epoch: 31 [431/1000 13792/32000 (43%)] Loss: 0.32000 (QuantReg: 12.96620) QuantErr: 12.96620 batch_time=0.35624 
Train Epoch: 31 [436/1000 13952/32000 (44%)] Loss: 0.27277 (QuantReg: 12.62393) QuantErr: 12.62393 batch_time=0.40350 
Train Epoch: 31 [441/1000 14112/32000 (44%)] Loss: 0.13411 (QuantReg: 13.48510) QuantErr: 13.48510 batch_time=0.45560 
Train Epoch: 31 [446/1000 14272/32000 (45%)] Loss: 0.79305 (QuantReg: 12.66370) QuantErr: 12.66370 batch_time=0.69918 
Train Epoch: 31 [451/1000 14432/32000 (45%)] Loss: 0.14855 (QuantReg: 13.06426) QuantErr: 13.06426 batch_time=0.36308 
Train Epoch: 31 [456/1000 14592/32000 (46%)] Loss: 0.51093 (QuantReg: 13.07944) QuantErr: 13.07944 batch_time=0.41580 
Train Epoch: 31 [461/1000 14752/32000 (46%)] Loss: 0.61401 (QuantReg: 12.24100) QuantErr: 12.24100 batch_time=0.39044 
Train Epoch: 31 [466/1000 14912/32000 (47%)] Loss: 0.49244 (QuantReg: 13.29699) QuantErr: 13.29699 batch_time=0.42862 
Train Epoch: 31 [471/1000 15072/32000 (47%)] Loss: 0.18202 (QuantReg: 13.15947) QuantErr: 13.15947 batch_time=0.47618 
Train Epoch: 31 [476/1000 15232/32000 (48%)] Loss: 0.40112 (QuantReg: 12.22864) QuantErr: 12.22864 batch_time=0.42899 
Train Epoch: 31 [481/1000 15392/32000 (48%)] Loss: 0.08399 (QuantReg: 13.07296) QuantErr: 13.07296 batch_time=0.37469 
Train Epoch: 31 [486/1000 15552/32000 (49%)] Loss: 0.36928 (QuantReg: 12.96153) QuantErr: 12.96153 batch_time=0.35613 
Train Epoch: 31 [491/1000 15712/32000 (49%)] Loss: 0.29735 (QuantReg: 12.54566) QuantErr: 12.54566 batch_time=0.56870 
Train Epoch: 31 [496/1000 15872/32000 (50%)] Loss: 0.49913 (QuantReg: 12.39650) QuantErr: 12.39650 batch_time=0.42799 
Train Epoch: 31 [501/1000 16032/32000 (50%)] Loss: 0.24799 (QuantReg: 13.22863) QuantErr: 13.22863 batch_time=0.50886 
Train Epoch: 31 [506/1000 16192/32000 (51%)] Loss: 0.20700 (QuantReg: 12.45295) QuantErr: 12.45295 batch_time=0.47340 
Train Epoch: 31 [511/1000 16352/32000 (51%)] Loss: 0.20579 (QuantReg: 12.93670) QuantErr: 12.93670 batch_time=0.38661 
Train Epoch: 31 [516/1000 16512/32000 (52%)] Loss: 0.35966 (QuantReg: 13.08777) QuantErr: 13.08777 batch_time=0.38870 
Train Epoch: 31 [521/1000 16672/32000 (52%)] Loss: 0.59492 (QuantReg: 13.35283) QuantErr: 13.35283 batch_time=0.39595 
Train Epoch: 31 [526/1000 16832/32000 (53%)] Loss: 0.32670 (QuantReg: 13.22089) QuantErr: 13.22089 batch_time=0.41993 
Train Epoch: 31 [531/1000 16992/32000 (53%)] Loss: 0.19526 (QuantReg: 12.52608) QuantErr: 12.52608 batch_time=0.38623 
Train Epoch: 31 [536/1000 17152/32000 (54%)] Loss: 0.46565 (QuantReg: 12.99613) QuantErr: 12.99613 batch_time=0.49439 
Train Epoch: 31 [541/1000 17312/32000 (54%)] Loss: 0.23461 (QuantReg: 12.73614) QuantErr: 12.73614 batch_time=0.37443 
Train Epoch: 31 [546/1000 17472/32000 (55%)] Loss: 0.22858 (QuantReg: 13.22276) QuantErr: 13.22276 batch_time=0.57605 
Train Epoch: 31 [551/1000 17632/32000 (55%)] Loss: 0.21613 (QuantReg: 13.17638) QuantErr: 13.17638 batch_time=0.33816 
Train Epoch: 31 [556/1000 17792/32000 (56%)] Loss: 0.32150 (QuantReg: 12.27082) QuantErr: 12.27082 batch_time=0.35526 
Train Epoch: 31 [561/1000 17952/32000 (56%)] Loss: 0.36578 (QuantReg: 13.05326) QuantErr: 13.05326 batch_time=0.40371 
Train Epoch: 31 [566/1000 18112/32000 (57%)] Loss: 0.49794 (QuantReg: 12.96928) QuantErr: 12.96928 batch_time=0.40070 
Train Epoch: 31 [571/1000 18272/32000 (57%)] Loss: 0.37008 (QuantReg: 12.44160) QuantErr: 12.44160 batch_time=0.39532 
Train Epoch: 31 [576/1000 18432/32000 (58%)] Loss: 0.33681 (QuantReg: 12.76952) QuantErr: 12.76952 batch_time=0.46828 
Train Epoch: 31 [581/1000 18592/32000 (58%)] Loss: 0.33042 (QuantReg: 12.58075) QuantErr: 12.58075 batch_time=0.33641 
Train Epoch: 31 [586/1000 18752/32000 (59%)] Loss: 0.35327 (QuantReg: 13.62433) QuantErr: 13.62433 batch_time=0.67509 
Train Epoch: 31 [591/1000 18912/32000 (59%)] Loss: 0.38753 (QuantReg: 12.27554) QuantErr: 12.27554 batch_time=0.35326 
Train Epoch: 31 [596/1000 19072/32000 (60%)] Loss: 0.32013 (QuantReg: 12.40255) QuantErr: 12.40255 batch_time=0.59484 
Train Epoch: 31 [601/1000 19232/32000 (60%)] Loss: 0.32424 (QuantReg: 13.45291) QuantErr: 13.45291 batch_time=0.37848 
Train Epoch: 31 [606/1000 19392/32000 (61%)] Loss: 0.28666 (QuantReg: 13.08580) QuantErr: 13.08580 batch_time=0.35483 
Train Epoch: 31 [611/1000 19552/32000 (61%)] Loss: 0.17474 (QuantReg: 13.42822) QuantErr: 13.42822 batch_time=0.35920 
Train Epoch: 31 [616/1000 19712/32000 (62%)] Loss: 0.23299 (QuantReg: 13.29881) QuantErr: 13.29881 batch_time=0.35032 
Train Epoch: 31 [621/1000 19872/32000 (62%)] Loss: 0.19572 (QuantReg: 13.12966) QuantErr: 13.12966 batch_time=0.40797 
Train Epoch: 31 [626/1000 20032/32000 (63%)] Loss: 0.17910 (QuantReg: 13.32033) QuantErr: 13.32033 batch_time=0.37847 
Train Epoch: 31 [631/1000 20192/32000 (63%)] Loss: 0.42968 (QuantReg: 12.92665) QuantErr: 12.92665 batch_time=0.41695 
Train Epoch: 31 [636/1000 20352/32000 (64%)] Loss: 0.26932 (QuantReg: 12.99434) QuantErr: 12.99434 batch_time=0.33422 
Train Epoch: 31 [641/1000 20512/32000 (64%)] Loss: 0.24968 (QuantReg: 12.77404) QuantErr: 12.77404 batch_time=0.41376 
Train Epoch: 31 [646/1000 20672/32000 (65%)] Loss: 0.28874 (QuantReg: 13.27936) QuantErr: 13.27936 batch_time=0.38002 
Train Epoch: 31 [651/1000 20832/32000 (65%)] Loss: 0.43043 (QuantReg: 12.69713) QuantErr: 12.69713 batch_time=0.39495 
Train Epoch: 31 [656/1000 20992/32000 (66%)] Loss: 0.44734 (QuantReg: 13.45317) QuantErr: 13.45317 batch_time=0.44316 
Train Epoch: 31 [661/1000 21152/32000 (66%)] Loss: 0.30149 (QuantReg: 13.12071) QuantErr: 13.12071 batch_time=0.36060 
Train Epoch: 31 [666/1000 21312/32000 (67%)] Loss: 0.84230 (QuantReg: 12.80834) QuantErr: 12.80834 batch_time=0.47355 
Train Epoch: 31 [671/1000 21472/32000 (67%)] Loss: 0.24329 (QuantReg: 12.38395) QuantErr: 12.38395 batch_time=0.42533 
Train Epoch: 31 [676/1000 21632/32000 (68%)] Loss: 0.27896 (QuantReg: 12.61526) QuantErr: 12.61526 batch_time=0.35401 
Train Epoch: 31 [681/1000 21792/32000 (68%)] Loss: 0.59378 (QuantReg: 13.27458) QuantErr: 13.27458 batch_time=0.39371 
Train Epoch: 31 [686/1000 21952/32000 (69%)] Loss: 0.15063 (QuantReg: 13.55258) QuantErr: 13.55258 batch_time=0.38796 
Train Epoch: 31 [691/1000 22112/32000 (69%)] Loss: 0.24631 (QuantReg: 12.63385) QuantErr: 12.63385 batch_time=0.71956 
Train Epoch: 31 [696/1000 22272/32000 (70%)] Loss: 0.44513 (QuantReg: 13.38607) QuantErr: 13.38607 batch_time=0.36002 
Train Epoch: 31 [701/1000 22432/32000 (70%)] Loss: 0.48401 (QuantReg: 13.50695) QuantErr: 13.50695 batch_time=0.40168 
Train Epoch: 31 [706/1000 22592/32000 (71%)] Loss: 0.34045 (QuantReg: 12.64239) QuantErr: 12.64239 batch_time=0.46194 
Train Epoch: 31 [711/1000 22752/32000 (71%)] Loss: 0.71272 (QuantReg: 13.52081) QuantErr: 13.52081 batch_time=2.03248 
Train Epoch: 31 [716/1000 22912/32000 (72%)] Loss: 0.37667 (QuantReg: 12.87864) QuantErr: 12.87864 batch_time=0.43864 
Train Epoch: 31 [721/1000 23072/32000 (72%)] Loss: 0.22403 (QuantReg: 13.22685) QuantErr: 13.22685 batch_time=0.34519 
Train Epoch: 31 [726/1000 23232/32000 (73%)] Loss: 0.50291 (QuantReg: 13.25317) QuantErr: 13.25317 batch_time=0.43285 
Train Epoch: 31 [731/1000 23392/32000 (73%)] Loss: 0.49591 (QuantReg: 12.25153) QuantErr: 12.25153 batch_time=0.34568 
Train Epoch: 31 [736/1000 23552/32000 (74%)] Loss: 0.21259 (QuantReg: 12.66371) QuantErr: 12.66371 batch_time=0.73584 
Train Epoch: 31 [741/1000 23712/32000 (74%)] Loss: 0.28035 (QuantReg: 12.96573) QuantErr: 12.96573 batch_time=0.88784 
Train Epoch: 31 [746/1000 23872/32000 (75%)] Loss: 0.37212 (QuantReg: 12.88067) QuantErr: 12.88067 batch_time=0.34480 
Train Epoch: 31 [751/1000 24032/32000 (75%)] Loss: 0.18228 (QuantReg: 13.24954) QuantErr: 13.24954 batch_time=0.43387 
Train Epoch: 31 [756/1000 24192/32000 (76%)] Loss: 0.26739 (QuantReg: 13.02838) QuantErr: 13.02838 batch_time=0.34206 
Train Epoch: 31 [761/1000 24352/32000 (76%)] Loss: 0.52187 (QuantReg: 12.22211) QuantErr: 12.22211 batch_time=0.34199 
Train Epoch: 31 [766/1000 24512/32000 (77%)] Loss: 0.23297 (QuantReg: 12.89514) QuantErr: 12.89514 batch_time=0.36242 
Train Epoch: 31 [771/1000 24672/32000 (77%)] Loss: 0.43894 (QuantReg: 12.36705) QuantErr: 12.36705 batch_time=0.34952 
Train Epoch: 31 [776/1000 24832/32000 (78%)] Loss: 0.19897 (QuantReg: 12.65332) QuantErr: 12.65332 batch_time=0.34564 
Train Epoch: 31 [781/1000 24992/32000 (78%)] Loss: 0.27915 (QuantReg: 12.87579) QuantErr: 12.87579 batch_time=0.47487 
Train Epoch: 31 [786/1000 25152/32000 (79%)] Loss: 0.30340 (QuantReg: 12.86054) QuantErr: 12.86054 batch_time=0.46591 
Train Epoch: 31 [791/1000 25312/32000 (79%)] Loss: 0.47972 (QuantReg: 13.18867) QuantErr: 13.18867 batch_time=0.36174 
Train Epoch: 31 [796/1000 25472/32000 (80%)] Loss: 0.48162 (QuantReg: 11.64356) QuantErr: 11.64356 batch_time=0.66590 
Train Epoch: 31 [801/1000 25632/32000 (80%)] Loss: 0.30481 (QuantReg: 12.97437) QuantErr: 12.97437 batch_time=0.37598 
Train Epoch: 31 [806/1000 25792/32000 (81%)] Loss: 0.31541 (QuantReg: 13.13403) QuantErr: 13.13403 batch_time=0.35084 
Train Epoch: 31 [811/1000 25952/32000 (81%)] Loss: 0.47681 (QuantReg: 12.43351) QuantErr: 12.43351 batch_time=0.39108 
Train Epoch: 31 [816/1000 26112/32000 (82%)] Loss: 0.42351 (QuantReg: 12.28636) QuantErr: 12.28636 batch_time=0.39034 
Train Epoch: 31 [821/1000 26272/32000 (82%)] Loss: 0.45949 (QuantReg: 11.47038) QuantErr: 11.47038 batch_time=0.40757 
Train Epoch: 31 [826/1000 26432/32000 (83%)] Loss: 0.42236 (QuantReg: 13.02244) QuantErr: 13.02244 batch_time=0.41377 
Train Epoch: 31 [831/1000 26592/32000 (83%)] Loss: 0.39339 (QuantReg: 12.20446) QuantErr: 12.20446 batch_time=0.42659 
Train Epoch: 31 [836/1000 26752/32000 (84%)] Loss: 0.10497 (QuantReg: 13.00713) QuantErr: 13.00713 batch_time=0.61522 
Train Epoch: 31 [841/1000 26912/32000 (84%)] Loss: 0.32667 (QuantReg: 12.22536) QuantErr: 12.22536 batch_time=0.34108 
Train Epoch: 31 [846/1000 27072/32000 (85%)] Loss: 0.33558 (QuantReg: 13.20639) QuantErr: 13.20639 batch_time=0.42000 
Train Epoch: 31 [851/1000 27232/32000 (85%)] Loss: 0.24083 (QuantReg: 13.02545) QuantErr: 13.02545 batch_time=0.36110 
Train Epoch: 31 [856/1000 27392/32000 (86%)] Loss: 0.38335 (QuantReg: 12.86850) QuantErr: 12.86850 batch_time=0.34840 
Train Epoch: 31 [861/1000 27552/32000 (86%)] Loss: 0.45994 (QuantReg: 13.30958) QuantErr: 13.30958 batch_time=0.37389 
Train Epoch: 31 [866/1000 27712/32000 (87%)] Loss: 0.09588 (QuantReg: 13.02103) QuantErr: 13.02103 batch_time=0.40039 
Train Epoch: 31 [871/1000 27872/32000 (87%)] Loss: 0.34353 (QuantReg: 12.81583) QuantErr: 12.81583 batch_time=0.34673 
Train Epoch: 31 [876/1000 28032/32000 (88%)] Loss: 0.27603 (QuantReg: 13.01588) QuantErr: 13.01588 batch_time=0.34624 
Train Epoch: 31 [881/1000 28192/32000 (88%)] Loss: 0.61478 (QuantReg: 12.28326) QuantErr: 12.28326 batch_time=0.34986 
Train Epoch: 31 [886/1000 28352/32000 (89%)] Loss: 0.68279 (QuantReg: 12.86739) QuantErr: 12.86739 batch_time=0.35565 
Train Epoch: 31 [891/1000 28512/32000 (89%)] Loss: 0.50797 (QuantReg: 12.78055) QuantErr: 12.78055 batch_time=0.43219 
Train Epoch: 31 [896/1000 28672/32000 (90%)] Loss: 0.33040 (QuantReg: 12.77445) QuantErr: 12.77445 batch_time=0.51170 
Train Epoch: 31 [901/1000 28832/32000 (90%)] Loss: 0.34717 (QuantReg: 13.44621) QuantErr: 13.44621 batch_time=0.42232 
Train Epoch: 31 [906/1000 28992/32000 (91%)] Loss: 0.34458 (QuantReg: 12.67448) QuantErr: 12.67448 batch_time=0.37874 
Train Epoch: 31 [911/1000 29152/32000 (91%)] Loss: 0.22426 (QuantReg: 13.49526) QuantErr: 13.49526 batch_time=0.43721 
Train Epoch: 31 [916/1000 29312/32000 (92%)] Loss: 0.45903 (QuantReg: 13.31560) QuantErr: 13.31560 batch_time=2.54306 
Train Epoch: 31 [921/1000 29472/32000 (92%)] Loss: 0.20959 (QuantReg: 11.88846) QuantErr: 11.88846 batch_time=0.39341 
Train Epoch: 31 [926/1000 29632/32000 (93%)] Loss: 0.37891 (QuantReg: 12.98187) QuantErr: 12.98187 batch_time=0.35110 
Train Epoch: 31 [931/1000 29792/32000 (93%)] Loss: 0.23189 (QuantReg: 12.78365) QuantErr: 12.78365 batch_time=0.35513 
Train Epoch: 31 [936/1000 29952/32000 (94%)] Loss: 0.32481 (QuantReg: 13.52541) QuantErr: 13.52541 batch_time=0.50288 
Train Epoch: 31 [941/1000 30112/32000 (94%)] Loss: 0.74054 (QuantReg: 12.72626) QuantErr: 12.72626 batch_time=0.38227 
Train Epoch: 31 [946/1000 30272/32000 (95%)] Loss: 0.39580 (QuantReg: 13.22832) QuantErr: 13.22832 batch_time=0.33452 
Train Epoch: 31 [951/1000 30432/32000 (95%)] Loss: 0.54253 (QuantReg: 12.69465) QuantErr: 12.69465 batch_time=0.34081 
Train Epoch: 31 [956/1000 30592/32000 (96%)] Loss: 0.28340 (QuantReg: 12.77281) QuantErr: 12.77281 batch_time=0.40496 
Train Epoch: 31 [961/1000 30752/32000 (96%)] Loss: 0.13722 (QuantReg: 12.90911) QuantErr: 12.90911 batch_time=0.40452 
Train Epoch: 31 [966/1000 30912/32000 (97%)] Loss: 0.57502 (QuantReg: 13.13727) QuantErr: 13.13727 batch_time=0.40881 
Train Epoch: 31 [971/1000 31072/32000 (97%)] Loss: 0.28060 (QuantReg: 13.23339) QuantErr: 13.23339 batch_time=0.38117 
Train Epoch: 31 [976/1000 31232/32000 (98%)] Loss: 0.36704 (QuantReg: 13.49299) QuantErr: 13.49299 batch_time=0.50355 
Train Epoch: 31 [981/1000 31392/32000 (98%)] Loss: 0.50523 (QuantReg: 12.94782) QuantErr: 12.94782 batch_time=0.49585 
Train Epoch: 31 [986/1000 31552/32000 (99%)] Loss: 0.31532 (QuantReg: 13.59892) QuantErr: 13.59892 batch_time=0.36902 
Train Epoch: 31 [991/1000 31712/32000 (99%)] Loss: 0.06751 (QuantReg: 12.70438) QuantErr: 12.70438 batch_time=0.43997 
Train Epoch: 31 [996/1000 31872/32000 (100%)] Loss: 0.23797 (QuantReg: 13.20627) QuantErr: 13.20627 batch_time=0.36934 
Train Epoch: 31 codebook_update_time=1.91982
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch31.pth ...
Done in 15.840s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 0.36199376844614745
 quant_reg      : 12.905087763786316
 quant_err      : 12.905087763786316
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 31000
 MSRVTT_miech_test/t2v_metrics/R1: 20.2
 MSRVTT_miech_test/t2v_metrics/R5: 48.9
 MSRVTT_miech_test/t2v_metrics/R10: 63.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.8
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.128
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.669717001339684
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.0
 MSRVTT_miech_test/v2t_metrics/R10: 64.3
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.4715
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.528363000623266
 mnt_best       : 39.91184188808923
 not_improved_count: 1
Train Epoch: 32 [1/1000 32/32000 (0%)] Loss: 0.08761 (QuantReg: 13.18694) QuantErr: 13.18694 batch_time=30.36035 
Train Epoch: 32 [6/1000 192/32000 (1%)] Loss: 0.19232 (QuantReg: 12.84512) QuantErr: 12.84512 batch_time=0.47343 
Train Epoch: 32 [11/1000 352/32000 (1%)] Loss: 0.54295 (QuantReg: 12.24868) QuantErr: 12.24868 batch_time=0.39869 
Train Epoch: 32 [16/1000 512/32000 (2%)] Loss: 0.13913 (QuantReg: 13.20312) QuantErr: 13.20312 batch_time=0.68140 
Train Epoch: 32 [21/1000 672/32000 (2%)] Loss: 0.21021 (QuantReg: 12.50288) QuantErr: 12.50288 batch_time=1.01544 
Train Epoch: 32 [26/1000 832/32000 (3%)] Loss: 0.28154 (QuantReg: 13.41263) QuantErr: 13.41263 batch_time=0.44629 
Train Epoch: 32 [31/1000 992/32000 (3%)] Loss: 0.13863 (QuantReg: 13.44894) QuantErr: 13.44894 batch_time=0.35748 
Train Epoch: 32 [36/1000 1152/32000 (4%)] Loss: 0.43261 (QuantReg: 12.59506) QuantErr: 12.59506 batch_time=1.24537 
Train Epoch: 32 [41/1000 1312/32000 (4%)] Loss: 0.62895 (QuantReg: 12.30953) QuantErr: 12.30953 batch_time=0.38969 
Train Epoch: 32 [46/1000 1472/32000 (5%)] Loss: 0.32197 (QuantReg: 12.10645) QuantErr: 12.10645 batch_time=0.42568 
Train Epoch: 32 [51/1000 1632/32000 (5%)] Loss: 0.26789 (QuantReg: 13.18482) QuantErr: 13.18482 batch_time=0.38254 
Train Epoch: 32 [56/1000 1792/32000 (6%)] Loss: 0.27608 (QuantReg: 12.97902) QuantErr: 12.97902 batch_time=0.33771 
Train Epoch: 32 [61/1000 1952/32000 (6%)] Loss: 0.22718 (QuantReg: 12.21844) QuantErr: 12.21844 batch_time=0.42978 
Train Epoch: 32 [66/1000 2112/32000 (7%)] Loss: 0.21158 (QuantReg: 12.60665) QuantErr: 12.60665 batch_time=0.35619 
Train Epoch: 32 [71/1000 2272/32000 (7%)] Loss: 0.19865 (QuantReg: 12.94066) QuantErr: 12.94066 batch_time=0.38105 
Train Epoch: 32 [76/1000 2432/32000 (8%)] Loss: 0.26872 (QuantReg: 12.31746) QuantErr: 12.31746 batch_time=0.44271 
Train Epoch: 32 [81/1000 2592/32000 (8%)] Loss: 0.42831 (QuantReg: 12.94642) QuantErr: 12.94642 batch_time=0.35724 
Train Epoch: 32 [86/1000 2752/32000 (9%)] Loss: 0.19595 (QuantReg: 13.29045) QuantErr: 13.29045 batch_time=0.52238 
Train Epoch: 32 [91/1000 2912/32000 (9%)] Loss: 0.43742 (QuantReg: 13.22520) QuantErr: 13.22520 batch_time=0.34203 
Train Epoch: 32 [96/1000 3072/32000 (10%)] Loss: 0.40008 (QuantReg: 12.58280) QuantErr: 12.58280 batch_time=0.54929 
Train Epoch: 32 [101/1000 3232/32000 (10%)] Loss: 0.24912 (QuantReg: 12.72106) QuantErr: 12.72106 batch_time=0.35181 
Train Epoch: 32 [106/1000 3392/32000 (11%)] Loss: 0.53424 (QuantReg: 13.00657) QuantErr: 13.00657 batch_time=0.74269 
Train Epoch: 32 [111/1000 3552/32000 (11%)] Loss: 0.24895 (QuantReg: 12.22674) QuantErr: 12.22674 batch_time=0.45389 
Train Epoch: 32 [116/1000 3712/32000 (12%)] Loss: 0.22412 (QuantReg: 12.84911) QuantErr: 12.84911 batch_time=0.36945 
Train Epoch: 32 [121/1000 3872/32000 (12%)] Loss: 0.26990 (QuantReg: 13.01449) QuantErr: 13.01449 batch_time=0.43628 
Train Epoch: 32 [126/1000 4032/32000 (13%)] Loss: 0.48530 (QuantReg: 12.93107) QuantErr: 12.93107 batch_time=0.37519 
Train Epoch: 32 [131/1000 4192/32000 (13%)] Loss: 0.34872 (QuantReg: 12.98639) QuantErr: 12.98639 batch_time=0.39513 
Train Epoch: 32 [136/1000 4352/32000 (14%)] Loss: 0.21657 (QuantReg: 13.76945) QuantErr: 13.76945 batch_time=0.38250 
Train Epoch: 32 [141/1000 4512/32000 (14%)] Loss: 0.27261 (QuantReg: 12.86755) QuantErr: 12.86755 batch_time=0.34166 
Train Epoch: 32 [146/1000 4672/32000 (15%)] Loss: 0.34660 (QuantReg: 12.63633) QuantErr: 12.63633 batch_time=0.49945 
Train Epoch: 32 [151/1000 4832/32000 (15%)] Loss: 0.21471 (QuantReg: 12.92503) QuantErr: 12.92503 batch_time=0.35368 
Train Epoch: 32 [156/1000 4992/32000 (16%)] Loss: 0.26452 (QuantReg: 13.07203) QuantErr: 13.07203 batch_time=0.33758 
Train Epoch: 32 [161/1000 5152/32000 (16%)] Loss: 0.35257 (QuantReg: 13.01114) QuantErr: 13.01114 batch_time=0.39026 
Train Epoch: 32 [166/1000 5312/32000 (17%)] Loss: 0.56359 (QuantReg: 12.15855) QuantErr: 12.15855 batch_time=0.36208 
Train Epoch: 32 [171/1000 5472/32000 (17%)] Loss: 0.23623 (QuantReg: 12.99598) QuantErr: 12.99598 batch_time=0.35606 
Train Epoch: 32 [176/1000 5632/32000 (18%)] Loss: 0.42933 (QuantReg: 12.57498) QuantErr: 12.57498 batch_time=0.37500 
Train Epoch: 32 [181/1000 5792/32000 (18%)] Loss: 0.27565 (QuantReg: 13.40709) QuantErr: 13.40709 batch_time=0.36058 
Train Epoch: 32 [186/1000 5952/32000 (19%)] Loss: 0.31340 (QuantReg: 12.76284) QuantErr: 12.76284 batch_time=0.68703 
Train Epoch: 32 [191/1000 6112/32000 (19%)] Loss: 0.32474 (QuantReg: 12.97090) QuantErr: 12.97090 batch_time=0.32726 
Train Epoch: 32 [196/1000 6272/32000 (20%)] Loss: 0.16887 (QuantReg: 13.12027) QuantErr: 13.12027 batch_time=0.80196 
Train Epoch: 32 [201/1000 6432/32000 (20%)] Loss: 0.15902 (QuantReg: 13.41634) QuantErr: 13.41634 batch_time=0.40626 
Train Epoch: 32 [206/1000 6592/32000 (21%)] Loss: 0.40031 (QuantReg: 13.50168) QuantErr: 13.50168 batch_time=0.39264 
Train Epoch: 32 [211/1000 6752/32000 (21%)] Loss: 0.29401 (QuantReg: 13.25442) QuantErr: 13.25442 batch_time=0.36274 
Train Epoch: 32 [216/1000 6912/32000 (22%)] Loss: 0.58996 (QuantReg: 12.41100) QuantErr: 12.41100 batch_time=0.35946 
Train Epoch: 32 [221/1000 7072/32000 (22%)] Loss: 0.38113 (QuantReg: 13.57576) QuantErr: 13.57576 batch_time=0.36472 
Train Epoch: 32 [226/1000 7232/32000 (23%)] Loss: 0.27824 (QuantReg: 12.93802) QuantErr: 12.93802 batch_time=0.34676 
Train Epoch: 32 [231/1000 7392/32000 (23%)] Loss: 0.10330 (QuantReg: 13.18144) QuantErr: 13.18144 batch_time=2.20918 
Train Epoch: 32 [236/1000 7552/32000 (24%)] Loss: 0.59422 (QuantReg: 12.89171) QuantErr: 12.89171 batch_time=0.35612 
Train Epoch: 32 [241/1000 7712/32000 (24%)] Loss: 0.24202 (QuantReg: 12.99328) QuantErr: 12.99328 batch_time=0.33419 
Train Epoch: 32 [246/1000 7872/32000 (25%)] Loss: 0.16586 (QuantReg: 13.63357) QuantErr: 13.63357 batch_time=0.64649 
Train Epoch: 32 [251/1000 8032/32000 (25%)] Loss: 0.09876 (QuantReg: 13.25638) QuantErr: 13.25638 batch_time=0.35073 
Train Epoch: 32 [256/1000 8192/32000 (26%)] Loss: 0.38195 (QuantReg: 12.28791) QuantErr: 12.28791 batch_time=0.36121 
Train Epoch: 32 [261/1000 8352/32000 (26%)] Loss: 0.17893 (QuantReg: 12.65227) QuantErr: 12.65227 batch_time=0.35338 
Train Epoch: 32 [266/1000 8512/32000 (27%)] Loss: 0.44826 (QuantReg: 12.93326) QuantErr: 12.93326 batch_time=0.40178 
Train Epoch: 32 [271/1000 8672/32000 (27%)] Loss: 0.31085 (QuantReg: 12.55507) QuantErr: 12.55507 batch_time=0.41429 
Train Epoch: 32 [276/1000 8832/32000 (28%)] Loss: 0.43967 (QuantReg: 12.70691) QuantErr: 12.70691 batch_time=0.35658 
Train Epoch: 32 [281/1000 8992/32000 (28%)] Loss: 0.20125 (QuantReg: 12.75554) QuantErr: 12.75554 batch_time=0.38685 
Train Epoch: 32 [286/1000 9152/32000 (29%)] Loss: 0.35823 (QuantReg: 13.41932) QuantErr: 13.41932 batch_time=0.36850 
Train Epoch: 32 [291/1000 9312/32000 (29%)] Loss: 0.28637 (QuantReg: 13.29476) QuantErr: 13.29476 batch_time=0.39840 
Train Epoch: 32 [296/1000 9472/32000 (30%)] Loss: 0.41192 (QuantReg: 12.88079) QuantErr: 12.88079 batch_time=0.63142 
Train Epoch: 32 [301/1000 9632/32000 (30%)] Loss: 0.45024 (QuantReg: 12.94198) QuantErr: 12.94198 batch_time=0.55363 
Train Epoch: 32 [306/1000 9792/32000 (31%)] Loss: 0.19726 (QuantReg: 13.20742) QuantErr: 13.20742 batch_time=0.45001 
Train Epoch: 32 [311/1000 9952/32000 (31%)] Loss: 0.34728 (QuantReg: 13.29576) QuantErr: 13.29576 batch_time=0.36587 
Train Epoch: 32 [316/1000 10112/32000 (32%)] Loss: 0.52754 (QuantReg: 12.67119) QuantErr: 12.67119 batch_time=0.40786 
Train Epoch: 32 [321/1000 10272/32000 (32%)] Loss: 0.39001 (QuantReg: 12.43936) QuantErr: 12.43936 batch_time=0.37638 
Train Epoch: 32 [326/1000 10432/32000 (33%)] Loss: 0.35876 (QuantReg: 13.17729) QuantErr: 13.17729 batch_time=0.45115 
Train Epoch: 32 [331/1000 10592/32000 (33%)] Loss: 0.32246 (QuantReg: 12.61290) QuantErr: 12.61290 batch_time=0.45005 
Train Epoch: 32 [336/1000 10752/32000 (34%)] Loss: 0.55702 (QuantReg: 13.51577) QuantErr: 13.51577 batch_time=0.35991 
Train Epoch: 32 [341/1000 10912/32000 (34%)] Loss: 0.24497 (QuantReg: 12.90752) QuantErr: 12.90752 batch_time=0.33701 
Train Epoch: 32 [346/1000 11072/32000 (35%)] Loss: 0.58347 (QuantReg: 12.45774) QuantErr: 12.45774 batch_time=0.59128 
Train Epoch: 32 [351/1000 11232/32000 (35%)] Loss: 0.96706 (QuantReg: 13.43866) QuantErr: 13.43866 batch_time=0.37782 
Train Epoch: 32 [356/1000 11392/32000 (36%)] Loss: 0.34851 (QuantReg: 12.73209) QuantErr: 12.73209 batch_time=0.36558 
Train Epoch: 32 [361/1000 11552/32000 (36%)] Loss: 0.33637 (QuantReg: 13.35170) QuantErr: 13.35170 batch_time=0.34102 
Train Epoch: 32 [366/1000 11712/32000 (37%)] Loss: 0.26675 (QuantReg: 13.06667) QuantErr: 13.06667 batch_time=0.46207 
Train Epoch: 32 [371/1000 11872/32000 (37%)] Loss: 0.30576 (QuantReg: 13.18176) QuantErr: 13.18176 batch_time=0.34680 
Train Epoch: 32 [376/1000 12032/32000 (38%)] Loss: 0.36301 (QuantReg: 12.47676) QuantErr: 12.47676 batch_time=0.36136 
Train Epoch: 32 [381/1000 12192/32000 (38%)] Loss: 0.35247 (QuantReg: 12.22996) QuantErr: 12.22996 batch_time=0.35774 
Train Epoch: 32 [386/1000 12352/32000 (39%)] Loss: 0.49432 (QuantReg: 12.37999) QuantErr: 12.37999 batch_time=0.52857 
Train Epoch: 32 [391/1000 12512/32000 (39%)] Loss: 0.52908 (QuantReg: 13.51330) QuantErr: 13.51330 batch_time=0.33771 
Train Epoch: 32 [396/1000 12672/32000 (40%)] Loss: 0.12113 (QuantReg: 13.78169) QuantErr: 13.78169 batch_time=0.38741 
Train Epoch: 32 [401/1000 12832/32000 (40%)] Loss: 0.33718 (QuantReg: 13.24321) QuantErr: 13.24321 batch_time=0.45327 
Train Epoch: 32 [406/1000 12992/32000 (41%)] Loss: 0.26110 (QuantReg: 13.32280) QuantErr: 13.32280 batch_time=0.36175 
Train Epoch: 32 [411/1000 13152/32000 (41%)] Loss: 0.57730 (QuantReg: 12.62673) QuantErr: 12.62673 batch_time=0.48400 
Train Epoch: 32 [416/1000 13312/32000 (42%)] Loss: 0.28504 (QuantReg: 13.37693) QuantErr: 13.37693 batch_time=0.35227 
Train Epoch: 32 [421/1000 13472/32000 (42%)] Loss: 0.31954 (QuantReg: 13.00381) QuantErr: 13.00381 batch_time=0.34921 
Train Epoch: 32 [426/1000 13632/32000 (43%)] Loss: 0.45781 (QuantReg: 13.33900) QuantErr: 13.33900 batch_time=0.35326 
Train Epoch: 32 [431/1000 13792/32000 (43%)] Loss: 0.43223 (QuantReg: 13.02249) QuantErr: 13.02249 batch_time=0.40734 
Train Epoch: 32 [436/1000 13952/32000 (44%)] Loss: 0.30371 (QuantReg: 12.90949) QuantErr: 12.90949 batch_time=0.60709 
Train Epoch: 32 [441/1000 14112/32000 (44%)] Loss: 0.31278 (QuantReg: 12.85337) QuantErr: 12.85337 batch_time=0.33742 
Train Epoch: 32 [446/1000 14272/32000 (45%)] Loss: 0.34314 (QuantReg: 13.24406) QuantErr: 13.24406 batch_time=0.79790 
Train Epoch: 32 [451/1000 14432/32000 (45%)] Loss: 0.34812 (QuantReg: 13.08985) QuantErr: 13.08985 batch_time=0.41575 
Train Epoch: 32 [456/1000 14592/32000 (46%)] Loss: 0.51680 (QuantReg: 13.49397) QuantErr: 13.49397 batch_time=0.44795 
Train Epoch: 32 [461/1000 14752/32000 (46%)] Loss: 0.28407 (QuantReg: 12.64497) QuantErr: 12.64497 batch_time=0.42001 
Train Epoch: 32 [466/1000 14912/32000 (47%)] Loss: 0.33018 (QuantReg: 12.25218) QuantErr: 12.25218 batch_time=0.45452 
Train Epoch: 32 [471/1000 15072/32000 (47%)] Loss: 0.42915 (QuantReg: 12.83513) QuantErr: 12.83513 batch_time=0.35913 
Train Epoch: 32 [476/1000 15232/32000 (48%)] Loss: 0.15822 (QuantReg: 13.39013) QuantErr: 13.39013 batch_time=0.47826 
Train Epoch: 32 [481/1000 15392/32000 (48%)] Loss: 0.37659 (QuantReg: 12.43052) QuantErr: 12.43052 batch_time=0.37189 
Train Epoch: 32 [486/1000 15552/32000 (49%)] Loss: 0.21412 (QuantReg: 13.00943) QuantErr: 13.00943 batch_time=0.39276 
Train Epoch: 32 [491/1000 15712/32000 (49%)] Loss: 0.15981 (QuantReg: 13.16772) QuantErr: 13.16772 batch_time=0.94953 
Train Epoch: 32 [496/1000 15872/32000 (50%)] Loss: 0.32032 (QuantReg: 12.30889) QuantErr: 12.30889 batch_time=0.35459 
Train Epoch: 32 [501/1000 16032/32000 (50%)] Loss: 0.23405 (QuantReg: 13.16507) QuantErr: 13.16507 batch_time=0.36358 
Train Epoch: 32 [506/1000 16192/32000 (51%)] Loss: 0.53620 (QuantReg: 12.43790) QuantErr: 12.43790 batch_time=0.49959 
Train Epoch: 32 [511/1000 16352/32000 (51%)] Loss: 0.34531 (QuantReg: 13.09053) QuantErr: 13.09053 batch_time=0.34269 
Train Epoch: 32 [516/1000 16512/32000 (52%)] Loss: 0.44344 (QuantReg: 13.08229) QuantErr: 13.08229 batch_time=0.37905 
Train Epoch: 32 [521/1000 16672/32000 (52%)] Loss: 0.30753 (QuantReg: 12.96061) QuantErr: 12.96061 batch_time=0.44946 
Train Epoch: 32 [526/1000 16832/32000 (53%)] Loss: 0.48534 (QuantReg: 13.15800) QuantErr: 13.15800 batch_time=0.37197 
Train Epoch: 32 [531/1000 16992/32000 (53%)] Loss: 0.27454 (QuantReg: 13.74741) QuantErr: 13.74741 batch_time=0.46797 
Train Epoch: 32 [536/1000 17152/32000 (54%)] Loss: 0.20164 (QuantReg: 13.35882) QuantErr: 13.35882 batch_time=0.35752 
Train Epoch: 32 [541/1000 17312/32000 (54%)] Loss: 0.32702 (QuantReg: 13.22803) QuantErr: 13.22803 batch_time=0.76886 
Train Epoch: 32 [546/1000 17472/32000 (55%)] Loss: 0.56451 (QuantReg: 12.25709) QuantErr: 12.25709 batch_time=0.57366 
Train Epoch: 32 [551/1000 17632/32000 (55%)] Loss: 0.42328 (QuantReg: 13.24699) QuantErr: 13.24699 batch_time=1.44682 
Train Epoch: 32 [556/1000 17792/32000 (56%)] Loss: 0.38967 (QuantReg: 12.91105) QuantErr: 12.91105 batch_time=0.37503 
Train Epoch: 32 [561/1000 17952/32000 (56%)] Loss: 0.65388 (QuantReg: 12.46080) QuantErr: 12.46080 batch_time=0.38091 
Train Epoch: 32 [566/1000 18112/32000 (57%)] Loss: 0.38111 (QuantReg: 13.66178) QuantErr: 13.66178 batch_time=0.36156 
Train Epoch: 32 [571/1000 18272/32000 (57%)] Loss: 0.28283 (QuantReg: 12.86519) QuantErr: 12.86519 batch_time=0.37055 
Train Epoch: 32 [576/1000 18432/32000 (58%)] Loss: 0.41984 (QuantReg: 13.26826) QuantErr: 13.26826 batch_time=0.34654 
Train Epoch: 32 [581/1000 18592/32000 (58%)] Loss: 0.44621 (QuantReg: 13.16862) QuantErr: 13.16862 batch_time=0.34935 
Train Epoch: 32 [586/1000 18752/32000 (59%)] Loss: 0.44691 (QuantReg: 13.10092) QuantErr: 13.10092 batch_time=0.45979 
Train Epoch: 32 [591/1000 18912/32000 (59%)] Loss: 0.24906 (QuantReg: 13.64694) QuantErr: 13.64694 batch_time=0.63467 
Train Epoch: 32 [596/1000 19072/32000 (60%)] Loss: 0.58755 (QuantReg: 12.53262) QuantErr: 12.53262 batch_time=0.35962 
Train Epoch: 32 [601/1000 19232/32000 (60%)] Loss: 0.26093 (QuantReg: 12.56902) QuantErr: 12.56902 batch_time=0.49502 
Train Epoch: 32 [606/1000 19392/32000 (61%)] Loss: 0.18371 (QuantReg: 13.77240) QuantErr: 13.77240 batch_time=0.35427 
Train Epoch: 32 [611/1000 19552/32000 (61%)] Loss: 0.41244 (QuantReg: 13.23848) QuantErr: 13.23848 batch_time=0.37649 
Train Epoch: 32 [616/1000 19712/32000 (62%)] Loss: 0.33186 (QuantReg: 13.61518) QuantErr: 13.61518 batch_time=0.37234 
Train Epoch: 32 [621/1000 19872/32000 (62%)] Loss: 0.62197 (QuantReg: 12.82530) QuantErr: 12.82530 batch_time=0.56082 
Train Epoch: 32 [626/1000 20032/32000 (63%)] Loss: 0.83038 (QuantReg: 13.11056) QuantErr: 13.11056 batch_time=0.41140 
Train Epoch: 32 [631/1000 20192/32000 (63%)] Loss: 0.28061 (QuantReg: 13.50184) QuantErr: 13.50184 batch_time=0.34469 
Train Epoch: 32 [636/1000 20352/32000 (64%)] Loss: 0.92179 (QuantReg: 12.15389) QuantErr: 12.15389 batch_time=1.25550 
Train Epoch: 32 [641/1000 20512/32000 (64%)] Loss: 0.16910 (QuantReg: 13.97696) QuantErr: 13.97696 batch_time=0.48189 
Train Epoch: 32 [646/1000 20672/32000 (65%)] Loss: 0.63836 (QuantReg: 12.95248) QuantErr: 12.95248 batch_time=0.39979 
Train Epoch: 32 [651/1000 20832/32000 (65%)] Loss: 0.26857 (QuantReg: 13.33387) QuantErr: 13.33387 batch_time=0.45945 
Train Epoch: 32 [656/1000 20992/32000 (66%)] Loss: 0.23920 (QuantReg: 12.97729) QuantErr: 12.97729 batch_time=0.44436 
Train Epoch: 32 [661/1000 21152/32000 (66%)] Loss: 0.24619 (QuantReg: 12.57469) QuantErr: 12.57469 batch_time=0.34421 
Train Epoch: 32 [666/1000 21312/32000 (67%)] Loss: 0.22892 (QuantReg: 12.84509) QuantErr: 12.84509 batch_time=0.38554 
Train Epoch: 32 [671/1000 21472/32000 (67%)] Loss: 0.46031 (QuantReg: 12.82152) QuantErr: 12.82152 batch_time=0.36711 
Train Epoch: 32 [676/1000 21632/32000 (68%)] Loss: 0.34253 (QuantReg: 13.56802) QuantErr: 13.56802 batch_time=0.36085 
Train Epoch: 32 [681/1000 21792/32000 (68%)] Loss: 0.47041 (QuantReg: 12.94464) QuantErr: 12.94464 batch_time=0.41599 
Train Epoch: 32 [686/1000 21952/32000 (69%)] Loss: 0.17536 (QuantReg: 12.68997) QuantErr: 12.68997 batch_time=0.55274 
Train Epoch: 32 [691/1000 22112/32000 (69%)] Loss: 0.28181 (QuantReg: 13.31385) QuantErr: 13.31385 batch_time=0.34642 
Train Epoch: 32 [696/1000 22272/32000 (70%)] Loss: 0.20842 (QuantReg: 13.35364) QuantErr: 13.35364 batch_time=0.38980 
Train Epoch: 32 [701/1000 22432/32000 (70%)] Loss: 0.48117 (QuantReg: 13.41232) QuantErr: 13.41232 batch_time=0.60785 
Train Epoch: 32 [706/1000 22592/32000 (71%)] Loss: 0.51693 (QuantReg: 12.69259) QuantErr: 12.69259 batch_time=0.41695 
Train Epoch: 32 [711/1000 22752/32000 (71%)] Loss: 0.21915 (QuantReg: 13.46787) QuantErr: 13.46787 batch_time=0.44217 
Train Epoch: 32 [716/1000 22912/32000 (72%)] Loss: 0.33669 (QuantReg: 12.44370) QuantErr: 12.44370 batch_time=0.34543 
Train Epoch: 32 [721/1000 23072/32000 (72%)] Loss: 0.47605 (QuantReg: 13.04529) QuantErr: 13.04529 batch_time=0.35840 
Train Epoch: 32 [726/1000 23232/32000 (73%)] Loss: 0.29409 (QuantReg: 12.87929) QuantErr: 12.87929 batch_time=0.37731 
Train Epoch: 32 [731/1000 23392/32000 (73%)] Loss: 0.42354 (QuantReg: 13.03352) QuantErr: 13.03352 batch_time=0.35125 
Train Epoch: 32 [736/1000 23552/32000 (74%)] Loss: 0.27984 (QuantReg: 12.56362) QuantErr: 12.56362 batch_time=0.78829 
Train Epoch: 32 [741/1000 23712/32000 (74%)] Loss: 0.33394 (QuantReg: 13.12945) QuantErr: 13.12945 batch_time=0.43468 
Train Epoch: 32 [746/1000 23872/32000 (75%)] Loss: 0.25919 (QuantReg: 12.13211) QuantErr: 12.13211 batch_time=0.34385 
Train Epoch: 32 [751/1000 24032/32000 (75%)] Loss: 0.23729 (QuantReg: 12.77155) QuantErr: 12.77155 batch_time=0.46135 
Train Epoch: 32 [756/1000 24192/32000 (76%)] Loss: 0.43806 (QuantReg: 12.94073) QuantErr: 12.94073 batch_time=0.42424 
Train Epoch: 32 [761/1000 24352/32000 (76%)] Loss: 0.19148 (QuantReg: 12.55247) QuantErr: 12.55247 batch_time=0.35813 
Train Epoch: 32 [766/1000 24512/32000 (77%)] Loss: 0.25300 (QuantReg: 12.71717) QuantErr: 12.71717 batch_time=0.34888 
Train Epoch: 32 [771/1000 24672/32000 (77%)] Loss: 0.40778 (QuantReg: 12.88125) QuantErr: 12.88125 batch_time=0.38090 
Train Epoch: 32 [776/1000 24832/32000 (78%)] Loss: 0.34944 (QuantReg: 13.59031) QuantErr: 13.59031 batch_time=0.38885 
Train Epoch: 32 [781/1000 24992/32000 (78%)] Loss: 0.55895 (QuantReg: 13.27468) QuantErr: 13.27468 batch_time=0.40025 
Train Epoch: 32 [786/1000 25152/32000 (79%)] Loss: 0.77785 (QuantReg: 12.13529) QuantErr: 12.13529 batch_time=0.51651 
Train Epoch: 32 [791/1000 25312/32000 (79%)] Loss: 0.24749 (QuantReg: 14.03247) QuantErr: 14.03247 batch_time=0.38282 
Train Epoch: 32 [796/1000 25472/32000 (80%)] Loss: 0.58983 (QuantReg: 12.58012) QuantErr: 12.58012 batch_time=0.54042 
Train Epoch: 32 [801/1000 25632/32000 (80%)] Loss: 0.22919 (QuantReg: 13.35118) QuantErr: 13.35118 batch_time=0.37673 
Train Epoch: 32 [806/1000 25792/32000 (81%)] Loss: 0.51519 (QuantReg: 12.83225) QuantErr: 12.83225 batch_time=0.40491 
Train Epoch: 32 [811/1000 25952/32000 (81%)] Loss: 0.42900 (QuantReg: 13.73531) QuantErr: 13.73531 batch_time=0.41739 
Train Epoch: 32 [816/1000 26112/32000 (82%)] Loss: 0.16902 (QuantReg: 13.93535) QuantErr: 13.93535 batch_time=0.44619 
Train Epoch: 32 [821/1000 26272/32000 (82%)] Loss: 0.28716 (QuantReg: 13.53563) QuantErr: 13.53563 batch_time=0.36584 
Train Epoch: 32 [826/1000 26432/32000 (83%)] Loss: 0.37603 (QuantReg: 12.98618) QuantErr: 12.98618 batch_time=0.40526 
Train Epoch: 32 [831/1000 26592/32000 (83%)] Loss: 0.23943 (QuantReg: 13.14732) QuantErr: 13.14732 batch_time=0.52523 
Train Epoch: 32 [836/1000 26752/32000 (84%)] Loss: 0.30825 (QuantReg: 12.91723) QuantErr: 12.91723 batch_time=0.41245 
Train Epoch: 32 [841/1000 26912/32000 (84%)] Loss: 0.30561 (QuantReg: 13.17589) QuantErr: 13.17589 batch_time=0.41405 
Train Epoch: 32 [846/1000 27072/32000 (85%)] Loss: 0.22450 (QuantReg: 12.82870) QuantErr: 12.82870 batch_time=0.50663 
Train Epoch: 32 [851/1000 27232/32000 (85%)] Loss: 0.60758 (QuantReg: 13.25107) QuantErr: 13.25107 batch_time=0.37530 
Train Epoch: 32 [856/1000 27392/32000 (86%)] Loss: 0.18932 (QuantReg: 13.78728) QuantErr: 13.78728 batch_time=0.44218 
Train Epoch: 32 [861/1000 27552/32000 (86%)] Loss: 0.35268 (QuantReg: 12.53097) QuantErr: 12.53097 batch_time=0.36277 
Train Epoch: 32 [866/1000 27712/32000 (87%)] Loss: 0.31363 (QuantReg: 13.30585) QuantErr: 13.30585 batch_time=0.36969 
Train Epoch: 32 [871/1000 27872/32000 (87%)] Loss: 0.33949 (QuantReg: 13.51683) QuantErr: 13.51683 batch_time=0.36428 
Train Epoch: 32 [876/1000 28032/32000 (88%)] Loss: 0.19228 (QuantReg: 13.06767) QuantErr: 13.06767 batch_time=0.37708 
Train Epoch: 32 [881/1000 28192/32000 (88%)] Loss: 0.51655 (QuantReg: 13.42443) QuantErr: 13.42443 batch_time=0.58332 
Train Epoch: 32 [886/1000 28352/32000 (89%)] Loss: 0.41577 (QuantReg: 13.59029) QuantErr: 13.59029 batch_time=0.44047 
Train Epoch: 32 [891/1000 28512/32000 (89%)] Loss: 0.55212 (QuantReg: 12.81512) QuantErr: 12.81512 batch_time=0.44630 
Train Epoch: 32 [896/1000 28672/32000 (90%)] Loss: 0.23932 (QuantReg: 12.54361) QuantErr: 12.54361 batch_time=0.35592 
Train Epoch: 32 [901/1000 28832/32000 (90%)] Loss: 0.22599 (QuantReg: 12.44152) QuantErr: 12.44152 batch_time=0.43630 
Train Epoch: 32 [906/1000 28992/32000 (91%)] Loss: 0.34211 (QuantReg: 13.43064) QuantErr: 13.43064 batch_time=0.38106 
Train Epoch: 32 [911/1000 29152/32000 (91%)] Loss: 0.22278 (QuantReg: 12.82734) QuantErr: 12.82734 batch_time=0.36838 
Train Epoch: 32 [916/1000 29312/32000 (92%)] Loss: 0.19580 (QuantReg: 13.04453) QuantErr: 13.04453 batch_time=0.39848 
Train Epoch: 32 [921/1000 29472/32000 (92%)] Loss: 0.31540 (QuantReg: 13.05433) QuantErr: 13.05433 batch_time=0.36879 
Train Epoch: 32 [926/1000 29632/32000 (93%)] Loss: 0.54706 (QuantReg: 12.73253) QuantErr: 12.73253 batch_time=0.41393 
Train Epoch: 32 [931/1000 29792/32000 (93%)] Loss: 0.19552 (QuantReg: 13.62207) QuantErr: 13.62207 batch_time=0.34838 
Train Epoch: 32 [936/1000 29952/32000 (94%)] Loss: 0.24644 (QuantReg: 13.08087) QuantErr: 13.08087 batch_time=0.34756 
Train Epoch: 32 [941/1000 30112/32000 (94%)] Loss: 0.53475 (QuantReg: 12.83586) QuantErr: 12.83586 batch_time=0.34172 
Train Epoch: 32 [946/1000 30272/32000 (95%)] Loss: 0.13811 (QuantReg: 13.49698) QuantErr: 13.49698 batch_time=0.35995 
Train Epoch: 32 [951/1000 30432/32000 (95%)] Loss: 0.33255 (QuantReg: 13.02262) QuantErr: 13.02262 batch_time=0.42903 
Train Epoch: 32 [956/1000 30592/32000 (96%)] Loss: 0.67581 (QuantReg: 13.56264) QuantErr: 13.56264 batch_time=0.34696 
Train Epoch: 32 [961/1000 30752/32000 (96%)] Loss: 0.25226 (QuantReg: 13.18340) QuantErr: 13.18340 batch_time=0.45258 
Train Epoch: 32 [966/1000 30912/32000 (97%)] Loss: 0.37006 (QuantReg: 13.27178) QuantErr: 13.27178 batch_time=0.39454 
Train Epoch: 32 [971/1000 31072/32000 (97%)] Loss: 0.36798 (QuantReg: 13.15400) QuantErr: 13.15400 batch_time=0.53987 
Train Epoch: 32 [976/1000 31232/32000 (98%)] Loss: 0.40164 (QuantReg: 13.43393) QuantErr: 13.43393 batch_time=0.47974 
Train Epoch: 32 [981/1000 31392/32000 (98%)] Loss: 0.22135 (QuantReg: 12.67536) QuantErr: 12.67536 batch_time=0.44558 
Train Epoch: 32 [986/1000 31552/32000 (99%)] Loss: 0.25966 (QuantReg: 12.77490) QuantErr: 12.77490 batch_time=0.46918 
Train Epoch: 32 [991/1000 31712/32000 (99%)] Loss: 0.16569 (QuantReg: 13.23458) QuantErr: 13.23458 batch_time=0.37656 
Train Epoch: 32 [996/1000 31872/32000 (100%)] Loss: 0.21377 (QuantReg: 13.62412) QuantErr: 13.62412 batch_time=0.39600 
Train Epoch: 32 codebook_update_time=1.97574
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch32.pth ...
Done in 14.973s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch32.pth ...
Done in 21.297s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 0.35492736439406875
 quant_reg      : 12.9779473361969
 quant_err      : 12.9779473361969
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 32000
 MSRVTT_miech_test/t2v_metrics/R1: 21.5
 MSRVTT_miech_test/t2v_metrics/R5: 49.6
 MSRVTT_miech_test/t2v_metrics/R10: 63.3
 MSRVTT_miech_test/t2v_metrics/R50: 87.9
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.332
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.71689157132969
 MSRVTT_miech_test/v2t_metrics/R1: 19.9
 MSRVTT_miech_test/v2t_metrics/R5: 50.5
 MSRVTT_miech_test/v2t_metrics/R10: 63.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.519
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.89824972483608
 mnt_best       : 40.71689157132969
 not_improved_count: 0
Train Epoch: 33 [1/1000 32/32000 (0%)] Loss: 0.45785 (QuantReg: 12.65496) QuantErr: 12.65496 batch_time=31.04275 
Train Epoch: 33 [6/1000 192/32000 (1%)] Loss: 0.36810 (QuantReg: 13.31255) QuantErr: 13.31255 batch_time=0.35639 
Train Epoch: 33 [11/1000 352/32000 (1%)] Loss: 0.18749 (QuantReg: 12.47561) QuantErr: 12.47561 batch_time=0.35758 
Train Epoch: 33 [16/1000 512/32000 (2%)] Loss: 0.14230 (QuantReg: 12.54518) QuantErr: 12.54518 batch_time=0.39708 
Train Epoch: 33 [21/1000 672/32000 (2%)] Loss: 0.35761 (QuantReg: 13.28685) QuantErr: 13.28685 batch_time=0.57160 
Train Epoch: 33 [26/1000 832/32000 (3%)] Loss: 0.37607 (QuantReg: 12.97505) QuantErr: 12.97505 batch_time=0.33932 
Train Epoch: 33 [31/1000 992/32000 (3%)] Loss: 0.25992 (QuantReg: 12.57069) QuantErr: 12.57069 batch_time=0.88283 
Train Epoch: 33 [36/1000 1152/32000 (4%)] Loss: 0.11317 (QuantReg: 13.57620) QuantErr: 13.57620 batch_time=0.41641 
Train Epoch: 33 [41/1000 1312/32000 (4%)] Loss: 0.37288 (QuantReg: 12.64575) QuantErr: 12.64575 batch_time=0.34863 
Train Epoch: 33 [46/1000 1472/32000 (5%)] Loss: 0.29903 (QuantReg: 13.04424) QuantErr: 13.04424 batch_time=0.38126 
Train Epoch: 33 [51/1000 1632/32000 (5%)] Loss: 0.46885 (QuantReg: 12.70239) QuantErr: 12.70239 batch_time=0.43307 
Train Epoch: 33 [56/1000 1792/32000 (6%)] Loss: 0.12067 (QuantReg: 12.89944) QuantErr: 12.89944 batch_time=0.37728 
Train Epoch: 33 [61/1000 1952/32000 (6%)] Loss: 0.25104 (QuantReg: 12.83993) QuantErr: 12.83993 batch_time=0.36203 
Train Epoch: 33 [66/1000 2112/32000 (7%)] Loss: 0.21307 (QuantReg: 12.87333) QuantErr: 12.87333 batch_time=0.34697 
Train Epoch: 33 [71/1000 2272/32000 (7%)] Loss: 0.54710 (QuantReg: 12.77823) QuantErr: 12.77823 batch_time=0.34531 
Train Epoch: 33 [76/1000 2432/32000 (8%)] Loss: 0.28908 (QuantReg: 13.36624) QuantErr: 13.36624 batch_time=0.80202 
Train Epoch: 33 [81/1000 2592/32000 (8%)] Loss: 0.29703 (QuantReg: 12.62515) QuantErr: 12.62515 batch_time=0.43285 
Train Epoch: 33 [86/1000 2752/32000 (9%)] Loss: 0.54499 (QuantReg: 12.82186) QuantErr: 12.82186 batch_time=0.39207 
Train Epoch: 33 [91/1000 2912/32000 (9%)] Loss: 0.22853 (QuantReg: 13.07159) QuantErr: 13.07159 batch_time=0.46699 
Train Epoch: 33 [96/1000 3072/32000 (10%)] Loss: 0.45457 (QuantReg: 12.30630) QuantErr: 12.30630 batch_time=0.38352 
Train Epoch: 33 [101/1000 3232/32000 (10%)] Loss: 0.23574 (QuantReg: 13.13691) QuantErr: 13.13691 batch_time=0.44230 
Train Epoch: 33 [106/1000 3392/32000 (11%)] Loss: 0.28914 (QuantReg: 11.90349) QuantErr: 11.90349 batch_time=0.35842 
Train Epoch: 33 [111/1000 3552/32000 (11%)] Loss: 0.33202 (QuantReg: 12.38017) QuantErr: 12.38017 batch_time=0.35920 
Train Epoch: 33 [116/1000 3712/32000 (12%)] Loss: 0.50894 (QuantReg: 12.35153) QuantErr: 12.35153 batch_time=0.39651 
Train Epoch: 33 [121/1000 3872/32000 (12%)] Loss: 0.49594 (QuantReg: 12.55471) QuantErr: 12.55471 batch_time=0.56836 
Train Epoch: 33 [126/1000 4032/32000 (13%)] Loss: 0.18106 (QuantReg: 13.36881) QuantErr: 13.36881 batch_time=0.54970 
Train Epoch: 33 [131/1000 4192/32000 (13%)] Loss: 0.41103 (QuantReg: 12.49099) QuantErr: 12.49099 batch_time=0.37049 
Train Epoch: 33 [136/1000 4352/32000 (14%)] Loss: 0.46711 (QuantReg: 13.52932) QuantErr: 13.52932 batch_time=0.46658 
Train Epoch: 33 [141/1000 4512/32000 (14%)] Loss: 0.06366 (QuantReg: 12.91110) QuantErr: 12.91110 batch_time=0.40037 
Train Epoch: 33 [146/1000 4672/32000 (15%)] Loss: 0.39081 (QuantReg: 12.75338) QuantErr: 12.75338 batch_time=0.35504 
Train Epoch: 33 [151/1000 4832/32000 (15%)] Loss: 0.26491 (QuantReg: 13.24900) QuantErr: 13.24900 batch_time=0.46522 
Train Epoch: 33 [156/1000 4992/32000 (16%)] Loss: 0.51671 (QuantReg: 13.04044) QuantErr: 13.04044 batch_time=0.46539 
Train Epoch: 33 [161/1000 5152/32000 (16%)] Loss: 0.45861 (QuantReg: 12.86510) QuantErr: 12.86510 batch_time=0.56331 
Train Epoch: 33 [166/1000 5312/32000 (17%)] Loss: 0.40238 (QuantReg: 13.61763) QuantErr: 13.61763 batch_time=0.36910 
Train Epoch: 33 [171/1000 5472/32000 (17%)] Loss: 0.17161 (QuantReg: 12.98396) QuantErr: 12.98396 batch_time=0.48542 
Train Epoch: 33 [176/1000 5632/32000 (18%)] Loss: 0.29694 (QuantReg: 13.04244) QuantErr: 13.04244 batch_time=0.33218 
Train Epoch: 33 [181/1000 5792/32000 (18%)] Loss: 0.74681 (QuantReg: 13.27174) QuantErr: 13.27174 batch_time=0.37184 
Train Epoch: 33 [186/1000 5952/32000 (19%)] Loss: 0.15555 (QuantReg: 13.28977) QuantErr: 13.28977 batch_time=0.44804 
Train Epoch: 33 [191/1000 6112/32000 (19%)] Loss: 0.29881 (QuantReg: 13.04305) QuantErr: 13.04305 batch_time=0.41477 
Train Epoch: 33 [196/1000 6272/32000 (20%)] Loss: 0.29730 (QuantReg: 13.30400) QuantErr: 13.30400 batch_time=0.43478 
Train Epoch: 33 [201/1000 6432/32000 (20%)] Loss: 0.13131 (QuantReg: 12.22849) QuantErr: 12.22849 batch_time=0.40512 
Train Epoch: 33 [206/1000 6592/32000 (21%)] Loss: 0.30765 (QuantReg: 12.98816) QuantErr: 12.98816 batch_time=0.46975 
Train Epoch: 33 [211/1000 6752/32000 (21%)] Loss: 0.23199 (QuantReg: 12.43481) QuantErr: 12.43481 batch_time=0.73688 
Train Epoch: 33 [216/1000 6912/32000 (22%)] Loss: 0.08482 (QuantReg: 13.20423) QuantErr: 13.20423 batch_time=0.80397 
Train Epoch: 33 [221/1000 7072/32000 (22%)] Loss: 0.51461 (QuantReg: 13.14636) QuantErr: 13.14636 batch_time=0.37578 
Train Epoch: 33 [226/1000 7232/32000 (23%)] Loss: 0.33770 (QuantReg: 12.95750) QuantErr: 12.95750 batch_time=0.34240 
Train Epoch: 33 [231/1000 7392/32000 (23%)] Loss: 0.32973 (QuantReg: 13.10518) QuantErr: 13.10518 batch_time=0.35986 
Train Epoch: 33 [236/1000 7552/32000 (24%)] Loss: 0.44407 (QuantReg: 13.05540) QuantErr: 13.05540 batch_time=0.38054 
Train Epoch: 33 [241/1000 7712/32000 (24%)] Loss: 0.49121 (QuantReg: 13.08265) QuantErr: 13.08265 batch_time=0.37730 
Train Epoch: 33 [246/1000 7872/32000 (25%)] Loss: 0.24587 (QuantReg: 13.89196) QuantErr: 13.89196 batch_time=0.45013 
Train Epoch: 33 [251/1000 8032/32000 (25%)] Loss: 0.56638 (QuantReg: 12.78838) QuantErr: 12.78838 batch_time=0.42959 
Train Epoch: 33 [256/1000 8192/32000 (26%)] Loss: 0.71969 (QuantReg: 12.94063) QuantErr: 12.94063 batch_time=0.35773 
Train Epoch: 33 [261/1000 8352/32000 (26%)] Loss: 0.29977 (QuantReg: 13.73177) QuantErr: 13.73177 batch_time=0.36971 
Train Epoch: 33 [266/1000 8512/32000 (27%)] Loss: 0.20489 (QuantReg: 12.81103) QuantErr: 12.81103 batch_time=0.64773 
Train Epoch: 33 [271/1000 8672/32000 (27%)] Loss: 0.63179 (QuantReg: 12.79932) QuantErr: 12.79932 batch_time=0.33530 
Train Epoch: 33 [276/1000 8832/32000 (28%)] Loss: 0.24678 (QuantReg: 12.80950) QuantErr: 12.80950 batch_time=0.34548 
Train Epoch: 33 [281/1000 8992/32000 (28%)] Loss: 0.29396 (QuantReg: 12.70521) QuantErr: 12.70521 batch_time=0.42141 
Train Epoch: 33 [286/1000 9152/32000 (29%)] Loss: 0.34690 (QuantReg: 13.08053) QuantErr: 13.08053 batch_time=0.35949 
Train Epoch: 33 [291/1000 9312/32000 (29%)] Loss: 0.24605 (QuantReg: 12.21919) QuantErr: 12.21919 batch_time=0.36497 
Train Epoch: 33 [296/1000 9472/32000 (30%)] Loss: 0.21844 (QuantReg: 12.44443) QuantErr: 12.44443 batch_time=0.44048 
Train Epoch: 33 [301/1000 9632/32000 (30%)] Loss: 0.40418 (QuantReg: 13.47793) QuantErr: 13.47793 batch_time=0.35139 
Train Epoch: 33 [306/1000 9792/32000 (31%)] Loss: 0.28201 (QuantReg: 13.17190) QuantErr: 13.17190 batch_time=0.37137 
Train Epoch: 33 [311/1000 9952/32000 (31%)] Loss: 0.15791 (QuantReg: 13.29855) QuantErr: 13.29855 batch_time=0.34795 
Train Epoch: 33 [316/1000 10112/32000 (32%)] Loss: 0.15490 (QuantReg: 13.14168) QuantErr: 13.14168 batch_time=0.51555 
Train Epoch: 33 [321/1000 10272/32000 (32%)] Loss: 0.22181 (QuantReg: 13.08144) QuantErr: 13.08144 batch_time=0.63081 
Train Epoch: 33 [326/1000 10432/32000 (33%)] Loss: 0.08481 (QuantReg: 13.12052) QuantErr: 13.12052 batch_time=0.59482 
Train Epoch: 33 [331/1000 10592/32000 (33%)] Loss: 0.28993 (QuantReg: 13.30684) QuantErr: 13.30684 batch_time=0.34808 
Train Epoch: 33 [336/1000 10752/32000 (34%)] Loss: 0.11880 (QuantReg: 12.85734) QuantErr: 12.85734 batch_time=0.40316 
Train Epoch: 33 [341/1000 10912/32000 (34%)] Loss: 0.49001 (QuantReg: 13.32207) QuantErr: 13.32207 batch_time=0.37046 
Train Epoch: 33 [346/1000 11072/32000 (35%)] Loss: 0.39100 (QuantReg: 13.37772) QuantErr: 13.37772 batch_time=0.37847 
Train Epoch: 33 [351/1000 11232/32000 (35%)] Loss: 0.82989 (QuantReg: 12.69517) QuantErr: 12.69517 batch_time=0.36017 
Train Epoch: 33 [356/1000 11392/32000 (36%)] Loss: 0.22341 (QuantReg: 13.58793) QuantErr: 13.58793 batch_time=0.33943 
Train Epoch: 33 [361/1000 11552/32000 (36%)] Loss: 0.22416 (QuantReg: 13.37172) QuantErr: 13.37172 batch_time=0.72213 
Train Epoch: 33 [366/1000 11712/32000 (37%)] Loss: 0.36043 (QuantReg: 12.35495) QuantErr: 12.35495 batch_time=0.51992 
Train Epoch: 33 [371/1000 11872/32000 (37%)] Loss: 0.35251 (QuantReg: 12.84643) QuantErr: 12.84643 batch_time=0.37845 
Train Epoch: 33 [376/1000 12032/32000 (38%)] Loss: 0.23446 (QuantReg: 13.00821) QuantErr: 13.00821 batch_time=0.47412 
Train Epoch: 33 [381/1000 12192/32000 (38%)] Loss: 0.21693 (QuantReg: 12.18232) QuantErr: 12.18232 batch_time=0.33528 
Train Epoch: 33 [386/1000 12352/32000 (39%)] Loss: 0.46046 (QuantReg: 13.05348) QuantErr: 13.05348 batch_time=0.35917 
Train Epoch: 33 [391/1000 12512/32000 (39%)] Loss: 0.38802 (QuantReg: 12.14385) QuantErr: 12.14385 batch_time=0.39910 
Train Epoch: 33 [396/1000 12672/32000 (40%)] Loss: 0.40890 (QuantReg: 12.67064) QuantErr: 12.67064 batch_time=0.43952 
Train Epoch: 33 [401/1000 12832/32000 (40%)] Loss: 0.23116 (QuantReg: 12.97531) QuantErr: 12.97531 batch_time=0.74749 
Train Epoch: 33 [406/1000 12992/32000 (41%)] Loss: 0.39747 (QuantReg: 12.59164) QuantErr: 12.59164 batch_time=0.34151 
Train Epoch: 33 [411/1000 13152/32000 (41%)] Loss: 0.41189 (QuantReg: 12.99983) QuantErr: 12.99983 batch_time=0.51308 
Train Epoch: 33 [416/1000 13312/32000 (42%)] Loss: 0.31829 (QuantReg: 12.31945) QuantErr: 12.31945 batch_time=0.42320 
Train Epoch: 33 [421/1000 13472/32000 (42%)] Loss: 0.29816 (QuantReg: 12.51033) QuantErr: 12.51033 batch_time=0.34406 
Train Epoch: 33 [426/1000 13632/32000 (43%)] Loss: 0.36853 (QuantReg: 12.28307) QuantErr: 12.28307 batch_time=0.35896 
Train Epoch: 33 [431/1000 13792/32000 (43%)] Loss: 0.52154 (QuantReg: 12.66312) QuantErr: 12.66312 batch_time=0.34490 
Train Epoch: 33 [436/1000 13952/32000 (44%)] Loss: 0.34713 (QuantReg: 13.10397) QuantErr: 13.10397 batch_time=0.39132 
Train Epoch: 33 [441/1000 14112/32000 (44%)] Loss: 0.27003 (QuantReg: 13.09325) QuantErr: 13.09325 batch_time=0.46645 
Train Epoch: 33 [446/1000 14272/32000 (45%)] Loss: 0.31686 (QuantReg: 13.25839) QuantErr: 13.25839 batch_time=0.45432 
Train Epoch: 33 [451/1000 14432/32000 (45%)] Loss: 0.32117 (QuantReg: 13.19619) QuantErr: 13.19619 batch_time=0.35653 
Train Epoch: 33 [456/1000 14592/32000 (46%)] Loss: 0.25999 (QuantReg: 13.03469) QuantErr: 13.03469 batch_time=0.48713 
Train Epoch: 33 [461/1000 14752/32000 (46%)] Loss: 0.12454 (QuantReg: 13.09243) QuantErr: 13.09243 batch_time=0.42352 
Train Epoch: 33 [466/1000 14912/32000 (47%)] Loss: 0.14126 (QuantReg: 12.76805) QuantErr: 12.76805 batch_time=0.42256 
Train Epoch: 33 [471/1000 15072/32000 (47%)] Loss: 0.32944 (QuantReg: 13.55613) QuantErr: 13.55613 batch_time=0.75978 
Train Epoch: 33 [476/1000 15232/32000 (48%)] Loss: 0.39232 (QuantReg: 12.54968) QuantErr: 12.54968 batch_time=0.37536 
Train Epoch: 33 [481/1000 15392/32000 (48%)] Loss: 0.42607 (QuantReg: 13.19654) QuantErr: 13.19654 batch_time=0.36054 
Train Epoch: 33 [486/1000 15552/32000 (49%)] Loss: 0.39451 (QuantReg: 13.05672) QuantErr: 13.05672 batch_time=0.35129 
Train Epoch: 33 [491/1000 15712/32000 (49%)] Loss: 0.35715 (QuantReg: 12.95574) QuantErr: 12.95574 batch_time=0.47562 
Train Epoch: 33 [496/1000 15872/32000 (50%)] Loss: 0.29638 (QuantReg: 12.71189) QuantErr: 12.71189 batch_time=0.45139 
Train Epoch: 33 [501/1000 16032/32000 (50%)] Loss: 0.26773 (QuantReg: 12.42715) QuantErr: 12.42715 batch_time=0.33511 
Train Epoch: 33 [506/1000 16192/32000 (51%)] Loss: 0.26857 (QuantReg: 12.56126) QuantErr: 12.56126 batch_time=0.48625 
Train Epoch: 33 [511/1000 16352/32000 (51%)] Loss: 0.34553 (QuantReg: 12.94367) QuantErr: 12.94367 batch_time=0.41074 
Train Epoch: 33 [516/1000 16512/32000 (52%)] Loss: 0.33459 (QuantReg: 12.99856) QuantErr: 12.99856 batch_time=0.57442 
Train Epoch: 33 [521/1000 16672/32000 (52%)] Loss: 0.40179 (QuantReg: 12.76513) QuantErr: 12.76513 batch_time=0.46039 
Train Epoch: 33 [526/1000 16832/32000 (53%)] Loss: 0.17800 (QuantReg: 13.29764) QuantErr: 13.29764 batch_time=0.46314 
Train Epoch: 33 [531/1000 16992/32000 (53%)] Loss: 0.62797 (QuantReg: 11.93458) QuantErr: 11.93458 batch_time=0.35746 
Train Epoch: 33 [536/1000 17152/32000 (54%)] Loss: 0.23572 (QuantReg: 12.19406) QuantErr: 12.19406 batch_time=0.45363 
Train Epoch: 33 [541/1000 17312/32000 (54%)] Loss: 0.55282 (QuantReg: 13.06079) QuantErr: 13.06079 batch_time=0.36181 
Train Epoch: 33 [546/1000 17472/32000 (55%)] Loss: 0.29588 (QuantReg: 13.29589) QuantErr: 13.29589 batch_time=0.39520 
Train Epoch: 33 [551/1000 17632/32000 (55%)] Loss: 0.17143 (QuantReg: 13.18667) QuantErr: 13.18667 batch_time=0.36990 
Train Epoch: 33 [556/1000 17792/32000 (56%)] Loss: 0.29018 (QuantReg: 13.09457) QuantErr: 13.09457 batch_time=0.56779 
Train Epoch: 33 [561/1000 17952/32000 (56%)] Loss: 0.55634 (QuantReg: 13.29228) QuantErr: 13.29228 batch_time=0.46135 
Train Epoch: 33 [566/1000 18112/32000 (57%)] Loss: 0.22180 (QuantReg: 12.34076) QuantErr: 12.34076 batch_time=0.70103 
Train Epoch: 33 [571/1000 18272/32000 (57%)] Loss: 0.20240 (QuantReg: 13.28149) QuantErr: 13.28149 batch_time=0.36091 
Train Epoch: 33 [576/1000 18432/32000 (58%)] Loss: 0.34346 (QuantReg: 12.76867) QuantErr: 12.76867 batch_time=0.45243 
Train Epoch: 33 [581/1000 18592/32000 (58%)] Loss: 0.30318 (QuantReg: 13.03401) QuantErr: 13.03401 batch_time=0.39298 
Train Epoch: 33 [586/1000 18752/32000 (59%)] Loss: 0.67553 (QuantReg: 13.45673) QuantErr: 13.45673 batch_time=0.41839 
Train Epoch: 33 [591/1000 18912/32000 (59%)] Loss: 0.21679 (QuantReg: 13.32245) QuantErr: 13.32245 batch_time=0.63981 
Train Epoch: 33 [596/1000 19072/32000 (60%)] Loss: 0.20220 (QuantReg: 13.62739) QuantErr: 13.62739 batch_time=0.33468 
Train Epoch: 33 [601/1000 19232/32000 (60%)] Loss: 0.33442 (QuantReg: 13.28941) QuantErr: 13.28941 batch_time=0.63370 
Train Epoch: 33 [606/1000 19392/32000 (61%)] Loss: 0.18596 (QuantReg: 13.09625) QuantErr: 13.09625 batch_time=0.37404 
Train Epoch: 33 [611/1000 19552/32000 (61%)] Loss: 0.32881 (QuantReg: 13.66939) QuantErr: 13.66939 batch_time=0.36432 
Train Epoch: 33 [616/1000 19712/32000 (62%)] Loss: 0.29281 (QuantReg: 13.59962) QuantErr: 13.59962 batch_time=0.46432 
Train Epoch: 33 [621/1000 19872/32000 (62%)] Loss: 0.15035 (QuantReg: 12.91154) QuantErr: 12.91154 batch_time=0.36863 
Train Epoch: 33 [626/1000 20032/32000 (63%)] Loss: 0.33142 (QuantReg: 12.55527) QuantErr: 12.55527 batch_time=0.46994 
Train Epoch: 33 [631/1000 20192/32000 (63%)] Loss: 0.52865 (QuantReg: 13.54340) QuantErr: 13.54340 batch_time=0.43736 
Train Epoch: 33 [636/1000 20352/32000 (64%)] Loss: 0.38584 (QuantReg: 12.87273) QuantErr: 12.87273 batch_time=0.36880 
Train Epoch: 33 [641/1000 20512/32000 (64%)] Loss: 0.39655 (QuantReg: 12.97015) QuantErr: 12.97015 batch_time=0.59309 
Train Epoch: 33 [646/1000 20672/32000 (65%)] Loss: 0.44886 (QuantReg: 13.36561) QuantErr: 13.36561 batch_time=0.36920 
Train Epoch: 33 [651/1000 20832/32000 (65%)] Loss: 0.19564 (QuantReg: 12.42017) QuantErr: 12.42017 batch_time=0.51750 
Train Epoch: 33 [656/1000 20992/32000 (66%)] Loss: 0.63058 (QuantReg: 12.33960) QuantErr: 12.33960 batch_time=0.46468 
Train Epoch: 33 [661/1000 21152/32000 (66%)] Loss: 0.82081 (QuantReg: 12.59937) QuantErr: 12.59937 batch_time=0.45600 
Train Epoch: 33 [666/1000 21312/32000 (67%)] Loss: 0.24477 (QuantReg: 12.94366) QuantErr: 12.94366 batch_time=0.36255 
Train Epoch: 33 [671/1000 21472/32000 (67%)] Loss: 0.95562 (QuantReg: 12.35441) QuantErr: 12.35441 batch_time=0.37673 
Train Epoch: 33 [676/1000 21632/32000 (68%)] Loss: 0.49209 (QuantReg: 13.10812) QuantErr: 13.10812 batch_time=0.42870 
Train Epoch: 33 [681/1000 21792/32000 (68%)] Loss: 0.54074 (QuantReg: 13.21524) QuantErr: 13.21524 batch_time=0.42829 
Train Epoch: 33 [686/1000 21952/32000 (69%)] Loss: 0.11716 (QuantReg: 13.33981) QuantErr: 13.33981 batch_time=0.35055 
Train Epoch: 33 [691/1000 22112/32000 (69%)] Loss: 0.65251 (QuantReg: 12.85550) QuantErr: 12.85550 batch_time=0.39068 
Train Epoch: 33 [696/1000 22272/32000 (70%)] Loss: 0.24778 (QuantReg: 13.38956) QuantErr: 13.38956 batch_time=0.33309 
Train Epoch: 33 [701/1000 22432/32000 (70%)] Loss: 0.60726 (QuantReg: 12.43373) QuantErr: 12.43373 batch_time=0.71888 
Train Epoch: 33 [706/1000 22592/32000 (71%)] Loss: 0.29365 (QuantReg: 12.62177) QuantErr: 12.62177 batch_time=0.34967 
Train Epoch: 33 [711/1000 22752/32000 (71%)] Loss: 0.47963 (QuantReg: 13.16939) QuantErr: 13.16939 batch_time=0.34711 
Train Epoch: 33 [716/1000 22912/32000 (72%)] Loss: 0.27038 (QuantReg: 12.44574) QuantErr: 12.44574 batch_time=0.33358 
Train Epoch: 33 [721/1000 23072/32000 (72%)] Loss: 0.77258 (QuantReg: 13.08528) QuantErr: 13.08528 batch_time=0.33828 
Train Epoch: 33 [726/1000 23232/32000 (73%)] Loss: 0.42268 (QuantReg: 12.78324) QuantErr: 12.78324 batch_time=0.35031 
Train Epoch: 33 [731/1000 23392/32000 (73%)] Loss: 0.24506 (QuantReg: 12.96867) QuantErr: 12.96867 batch_time=0.36062 
Train Epoch: 33 [736/1000 23552/32000 (74%)] Loss: 0.18062 (QuantReg: 12.35971) QuantErr: 12.35971 batch_time=0.36527 
Train Epoch: 33 [741/1000 23712/32000 (74%)] Loss: 0.37798 (QuantReg: 13.40066) QuantErr: 13.40066 batch_time=0.39819 
Train Epoch: 33 [746/1000 23872/32000 (75%)] Loss: 0.08030 (QuantReg: 12.06073) QuantErr: 12.06073 batch_time=0.50943 
Train Epoch: 33 [751/1000 24032/32000 (75%)] Loss: 0.24148 (QuantReg: 13.00199) QuantErr: 13.00199 batch_time=0.41964 
Train Epoch: 33 [756/1000 24192/32000 (76%)] Loss: 0.43365 (QuantReg: 13.02671) QuantErr: 13.02671 batch_time=0.50395 
Train Epoch: 33 [761/1000 24352/32000 (76%)] Loss: 0.19624 (QuantReg: 12.80499) QuantErr: 12.80499 batch_time=0.36118 
Train Epoch: 33 [766/1000 24512/32000 (77%)] Loss: 0.16827 (QuantReg: 12.64307) QuantErr: 12.64307 batch_time=0.45850 
Train Epoch: 33 [771/1000 24672/32000 (77%)] Loss: 0.21234 (QuantReg: 12.82316) QuantErr: 12.82316 batch_time=0.40682 
Train Epoch: 33 [776/1000 24832/32000 (78%)] Loss: 0.19901 (QuantReg: 12.47064) QuantErr: 12.47064 batch_time=1.90279 
Train Epoch: 33 [781/1000 24992/32000 (78%)] Loss: 0.29102 (QuantReg: 13.87900) QuantErr: 13.87900 batch_time=0.58561 
Train Epoch: 33 [786/1000 25152/32000 (79%)] Loss: 0.36624 (QuantReg: 12.70225) QuantErr: 12.70225 batch_time=0.35516 
Train Epoch: 33 [791/1000 25312/32000 (79%)] Loss: 0.37316 (QuantReg: 12.89008) QuantErr: 12.89008 batch_time=0.99635 
Train Epoch: 33 [796/1000 25472/32000 (80%)] Loss: 0.48771 (QuantReg: 12.87565) QuantErr: 12.87565 batch_time=0.47080 
Train Epoch: 33 [801/1000 25632/32000 (80%)] Loss: 0.53275 (QuantReg: 12.73846) QuantErr: 12.73846 batch_time=0.46801 
Train Epoch: 33 [806/1000 25792/32000 (81%)] Loss: 0.59026 (QuantReg: 12.50112) QuantErr: 12.50112 batch_time=0.32779 
Train Epoch: 33 [811/1000 25952/32000 (81%)] Loss: 0.43917 (QuantReg: 13.35622) QuantErr: 13.35622 batch_time=0.46393 
Train Epoch: 33 [816/1000 26112/32000 (82%)] Loss: 0.30783 (QuantReg: 13.50357) QuantErr: 13.50357 batch_time=0.47669 
Train Epoch: 33 [821/1000 26272/32000 (82%)] Loss: 0.33985 (QuantReg: 13.32329) QuantErr: 13.32329 batch_time=0.36838 
Train Epoch: 33 [826/1000 26432/32000 (83%)] Loss: 0.30588 (QuantReg: 13.01904) QuantErr: 13.01904 batch_time=0.35604 
Train Epoch: 33 [831/1000 26592/32000 (83%)] Loss: 0.14033 (QuantReg: 13.32724) QuantErr: 13.32724 batch_time=0.45528 
Train Epoch: 33 [836/1000 26752/32000 (84%)] Loss: 0.48110 (QuantReg: 13.36339) QuantErr: 13.36339 batch_time=0.49019 
Train Epoch: 33 [841/1000 26912/32000 (84%)] Loss: 0.66892 (QuantReg: 12.32180) QuantErr: 12.32180 batch_time=0.34526 
Train Epoch: 33 [846/1000 27072/32000 (85%)] Loss: 0.21503 (QuantReg: 12.22620) QuantErr: 12.22620 batch_time=0.82720 
Train Epoch: 33 [851/1000 27232/32000 (85%)] Loss: 0.20666 (QuantReg: 12.37090) QuantErr: 12.37090 batch_time=0.33382 
Train Epoch: 33 [856/1000 27392/32000 (86%)] Loss: 0.43406 (QuantReg: 13.70738) QuantErr: 13.70738 batch_time=0.41295 
Train Epoch: 33 [861/1000 27552/32000 (86%)] Loss: 0.41397 (QuantReg: 13.33362) QuantErr: 13.33362 batch_time=0.35209 
Train Epoch: 33 [866/1000 27712/32000 (87%)] Loss: 0.35757 (QuantReg: 12.68557) QuantErr: 12.68557 batch_time=0.44603 
Train Epoch: 33 [871/1000 27872/32000 (87%)] Loss: 0.58427 (QuantReg: 12.72869) QuantErr: 12.72869 batch_time=0.37236 
Train Epoch: 33 [876/1000 28032/32000 (88%)] Loss: 0.40136 (QuantReg: 13.14221) QuantErr: 13.14221 batch_time=0.39078 
Train Epoch: 33 [881/1000 28192/32000 (88%)] Loss: 0.27030 (QuantReg: 12.75267) QuantErr: 12.75267 batch_time=0.35698 
Train Epoch: 33 [886/1000 28352/32000 (89%)] Loss: 0.52284 (QuantReg: 12.85017) QuantErr: 12.85017 batch_time=0.51119 
Train Epoch: 33 [891/1000 28512/32000 (89%)] Loss: 0.38939 (QuantReg: 13.28635) QuantErr: 13.28635 batch_time=0.35712 
Train Epoch: 33 [896/1000 28672/32000 (90%)] Loss: 0.50462 (QuantReg: 12.38427) QuantErr: 12.38427 batch_time=0.40679 
Train Epoch: 33 [901/1000 28832/32000 (90%)] Loss: 0.28487 (QuantReg: 13.58475) QuantErr: 13.58475 batch_time=0.37475 
Train Epoch: 33 [906/1000 28992/32000 (91%)] Loss: 0.45418 (QuantReg: 12.75299) QuantErr: 12.75299 batch_time=0.40032 
Train Epoch: 33 [911/1000 29152/32000 (91%)] Loss: 0.19158 (QuantReg: 13.05206) QuantErr: 13.05206 batch_time=0.39002 
Train Epoch: 33 [916/1000 29312/32000 (92%)] Loss: 0.24394 (QuantReg: 13.49342) QuantErr: 13.49342 batch_time=0.46704 
Train Epoch: 33 [921/1000 29472/32000 (92%)] Loss: 0.39860 (QuantReg: 13.06952) QuantErr: 13.06952 batch_time=0.39284 
Train Epoch: 33 [926/1000 29632/32000 (93%)] Loss: 0.20628 (QuantReg: 12.74401) QuantErr: 12.74401 batch_time=0.35778 
Train Epoch: 33 [931/1000 29792/32000 (93%)] Loss: 0.17422 (QuantReg: 13.24070) QuantErr: 13.24070 batch_time=0.35475 
Train Epoch: 33 [936/1000 29952/32000 (94%)] Loss: 0.15737 (QuantReg: 12.97699) QuantErr: 12.97699 batch_time=0.60560 
Train Epoch: 33 [941/1000 30112/32000 (94%)] Loss: 0.14350 (QuantReg: 13.24689) QuantErr: 13.24689 batch_time=0.35795 
Train Epoch: 33 [946/1000 30272/32000 (95%)] Loss: 0.20208 (QuantReg: 12.92428) QuantErr: 12.92428 batch_time=0.63020 
Train Epoch: 33 [951/1000 30432/32000 (95%)] Loss: 0.35988 (QuantReg: 12.77338) QuantErr: 12.77338 batch_time=0.40073 
Train Epoch: 33 [956/1000 30592/32000 (96%)] Loss: 0.35190 (QuantReg: 12.77917) QuantErr: 12.77917 batch_time=0.34376 
Train Epoch: 33 [961/1000 30752/32000 (96%)] Loss: 0.19755 (QuantReg: 13.11523) QuantErr: 13.11523 batch_time=0.41346 
Train Epoch: 33 [966/1000 30912/32000 (97%)] Loss: 0.17433 (QuantReg: 13.46456) QuantErr: 13.46456 batch_time=0.38940 
Train Epoch: 33 [971/1000 31072/32000 (97%)] Loss: 0.22700 (QuantReg: 13.20764) QuantErr: 13.20764 batch_time=0.42366 
Train Epoch: 33 [976/1000 31232/32000 (98%)] Loss: 0.26731 (QuantReg: 13.01250) QuantErr: 13.01250 batch_time=0.41383 
Train Epoch: 33 [981/1000 31392/32000 (98%)] Loss: 0.27849 (QuantReg: 13.18576) QuantErr: 13.18576 batch_time=0.34391 
Train Epoch: 33 [986/1000 31552/32000 (99%)] Loss: 0.25186 (QuantReg: 12.82940) QuantErr: 12.82940 batch_time=0.33442 
Train Epoch: 33 [991/1000 31712/32000 (99%)] Loss: 0.41990 (QuantReg: 13.09001) QuantErr: 13.09001 batch_time=0.53298 
Train Epoch: 33 [996/1000 31872/32000 (100%)] Loss: 0.31292 (QuantReg: 13.19372) QuantErr: 13.19372 batch_time=0.34117 
Train Epoch: 33 codebook_update_time=2.05183
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch33.pth ...
Done in 6.021s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 0.3431512137502432
 quant_reg      : 12.947068902015687
 quant_err      : 12.947068902015687
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 33000
 MSRVTT_miech_test/t2v_metrics/R1: 20.5
 MSRVTT_miech_test/t2v_metrics/R5: 49.1
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 88.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.6775
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.982476699469466
 MSRVTT_miech_test/v2t_metrics/R1: 20.7
 MSRVTT_miech_test/v2t_metrics/R5: 49.6
 MSRVTT_miech_test/v2t_metrics/R10: 64.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 6.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.862
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.43703430191004
 mnt_best       : 40.71689157132969
 not_improved_count: 1
Train Epoch: 34 [1/1000 32/32000 (0%)] Loss: 0.20259 (QuantReg: 13.14120) QuantErr: 13.14120 batch_time=29.94568 
Train Epoch: 34 [6/1000 192/32000 (1%)] Loss: 0.35178 (QuantReg: 12.88874) QuantErr: 12.88874 batch_time=0.39284 
Train Epoch: 34 [11/1000 352/32000 (1%)] Loss: 0.26709 (QuantReg: 12.63589) QuantErr: 12.63589 batch_time=0.37470 
Train Epoch: 34 [16/1000 512/32000 (2%)] Loss: 0.20149 (QuantReg: 13.41971) QuantErr: 13.41971 batch_time=0.35390 
Train Epoch: 34 [21/1000 672/32000 (2%)] Loss: 0.52202 (QuantReg: 12.88548) QuantErr: 12.88548 batch_time=0.76850 
Train Epoch: 34 [26/1000 832/32000 (3%)] Loss: 0.31125 (QuantReg: 13.31483) QuantErr: 13.31483 batch_time=0.34192 
Train Epoch: 34 [31/1000 992/32000 (3%)] Loss: 0.29279 (QuantReg: 13.05330) QuantErr: 13.05330 batch_time=0.67667 
Train Epoch: 34 [36/1000 1152/32000 (4%)] Loss: 0.41320 (QuantReg: 13.20442) QuantErr: 13.20442 batch_time=0.52336 
Train Epoch: 34 [41/1000 1312/32000 (4%)] Loss: 0.46251 (QuantReg: 13.11397) QuantErr: 13.11397 batch_time=0.48775 
Train Epoch: 34 [46/1000 1472/32000 (5%)] Loss: 0.90107 (QuantReg: 12.39563) QuantErr: 12.39563 batch_time=0.47618 
Train Epoch: 34 [51/1000 1632/32000 (5%)] Loss: 0.29804 (QuantReg: 12.64918) QuantErr: 12.64918 batch_time=0.43153 
Train Epoch: 34 [56/1000 1792/32000 (6%)] Loss: 0.31116 (QuantReg: 13.26446) QuantErr: 13.26446 batch_time=0.33909 
Train Epoch: 34 [61/1000 1952/32000 (6%)] Loss: 0.34743 (QuantReg: 13.54856) QuantErr: 13.54856 batch_time=0.45020 
Train Epoch: 34 [66/1000 2112/32000 (7%)] Loss: 0.23349 (QuantReg: 13.15863) QuantErr: 13.15863 batch_time=0.73998 
Train Epoch: 34 [71/1000 2272/32000 (7%)] Loss: 0.32155 (QuantReg: 12.71402) QuantErr: 12.71402 batch_time=0.45874 
Train Epoch: 34 [76/1000 2432/32000 (8%)] Loss: 0.68936 (QuantReg: 12.94133) QuantErr: 12.94133 batch_time=0.37249 
Train Epoch: 34 [81/1000 2592/32000 (8%)] Loss: 0.41630 (QuantReg: 12.55718) QuantErr: 12.55718 batch_time=1.71065 
Train Epoch: 34 [86/1000 2752/32000 (9%)] Loss: 0.40463 (QuantReg: 13.18903) QuantErr: 13.18903 batch_time=0.34482 
Train Epoch: 34 [91/1000 2912/32000 (9%)] Loss: 0.32153 (QuantReg: 13.12138) QuantErr: 13.12138 batch_time=0.79704 
Train Epoch: 34 [96/1000 3072/32000 (10%)] Loss: 0.20332 (QuantReg: 13.63055) QuantErr: 13.63055 batch_time=0.40144 
Train Epoch: 34 [101/1000 3232/32000 (10%)] Loss: 0.45402 (QuantReg: 12.92121) QuantErr: 12.92121 batch_time=0.42318 
Train Epoch: 34 [106/1000 3392/32000 (11%)] Loss: 0.24285 (QuantReg: 13.46499) QuantErr: 13.46499 batch_time=0.41220 
Train Epoch: 34 [111/1000 3552/32000 (11%)] Loss: 0.12355 (QuantReg: 13.24936) QuantErr: 13.24936 batch_time=0.38363 
Train Epoch: 34 [116/1000 3712/32000 (12%)] Loss: 0.23632 (QuantReg: 13.30487) QuantErr: 13.30487 batch_time=0.37561 
Train Epoch: 34 [121/1000 3872/32000 (12%)] Loss: 0.36546 (QuantReg: 12.12369) QuantErr: 12.12369 batch_time=0.41848 
Train Epoch: 34 [126/1000 4032/32000 (13%)] Loss: 0.35936 (QuantReg: 13.19849) QuantErr: 13.19849 batch_time=0.68853 
Train Epoch: 34 [131/1000 4192/32000 (13%)] Loss: 0.37967 (QuantReg: 12.09733) QuantErr: 12.09733 batch_time=0.62169 
Train Epoch: 34 [136/1000 4352/32000 (14%)] Loss: 0.24551 (QuantReg: 13.09289) QuantErr: 13.09289 batch_time=0.36763 
Train Epoch: 34 [141/1000 4512/32000 (14%)] Loss: 0.66091 (QuantReg: 13.17667) QuantErr: 13.17667 batch_time=0.45881 
Train Epoch: 34 [146/1000 4672/32000 (15%)] Loss: 0.17952 (QuantReg: 13.26311) QuantErr: 13.26311 batch_time=0.37179 
Train Epoch: 34 [151/1000 4832/32000 (15%)] Loss: 0.40218 (QuantReg: 13.12244) QuantErr: 13.12244 batch_time=0.37369 
Train Epoch: 34 [156/1000 4992/32000 (16%)] Loss: 0.54378 (QuantReg: 12.64370) QuantErr: 12.64370 batch_time=0.45495 
Train Epoch: 34 [161/1000 5152/32000 (16%)] Loss: 0.25758 (QuantReg: 12.86913) QuantErr: 12.86913 batch_time=0.36116 
Train Epoch: 34 [166/1000 5312/32000 (17%)] Loss: 0.13744 (QuantReg: 12.68164) QuantErr: 12.68164 batch_time=0.58785 
Train Epoch: 34 [171/1000 5472/32000 (17%)] Loss: 0.10478 (QuantReg: 13.47660) QuantErr: 13.47660 batch_time=0.35512 
Train Epoch: 34 [176/1000 5632/32000 (18%)] Loss: 0.43426 (QuantReg: 13.28501) QuantErr: 13.28501 batch_time=0.78072 
Train Epoch: 34 [181/1000 5792/32000 (18%)] Loss: 0.35093 (QuantReg: 12.64331) QuantErr: 12.64331 batch_time=0.36232 
Train Epoch: 34 [186/1000 5952/32000 (19%)] Loss: 0.55435 (QuantReg: 13.33970) QuantErr: 13.33970 batch_time=0.38735 
Train Epoch: 34 [191/1000 6112/32000 (19%)] Loss: 0.10207 (QuantReg: 12.86854) QuantErr: 12.86854 batch_time=0.47755 
Train Epoch: 34 [196/1000 6272/32000 (20%)] Loss: 0.29413 (QuantReg: 12.36327) QuantErr: 12.36327 batch_time=0.39689 
Train Epoch: 34 [201/1000 6432/32000 (20%)] Loss: 0.59991 (QuantReg: 12.60690) QuantErr: 12.60690 batch_time=0.38011 
Train Epoch: 34 [206/1000 6592/32000 (21%)] Loss: 0.34961 (QuantReg: 12.79822) QuantErr: 12.79822 batch_time=0.36017 
Train Epoch: 34 [211/1000 6752/32000 (21%)] Loss: 0.50206 (QuantReg: 12.79706) QuantErr: 12.79706 batch_time=0.49683 
Train Epoch: 34 [216/1000 6912/32000 (22%)] Loss: 0.22787 (QuantReg: 12.81001) QuantErr: 12.81001 batch_time=0.40588 
Train Epoch: 34 [221/1000 7072/32000 (22%)] Loss: 0.34096 (QuantReg: 12.99687) QuantErr: 12.99687 batch_time=0.38965 
Train Epoch: 34 [226/1000 7232/32000 (23%)] Loss: 0.64847 (QuantReg: 12.73057) QuantErr: 12.73057 batch_time=0.60600 
Train Epoch: 34 [231/1000 7392/32000 (23%)] Loss: 0.35272 (QuantReg: 12.57628) QuantErr: 12.57628 batch_time=0.37234 
Train Epoch: 34 [236/1000 7552/32000 (24%)] Loss: 0.62083 (QuantReg: 12.85184) QuantErr: 12.85184 batch_time=0.48779 
Train Epoch: 34 [241/1000 7712/32000 (24%)] Loss: 0.53281 (QuantReg: 13.23019) QuantErr: 13.23019 batch_time=0.35880 
Train Epoch: 34 [246/1000 7872/32000 (25%)] Loss: 0.10717 (QuantReg: 13.07352) QuantErr: 13.07352 batch_time=0.37251 
Train Epoch: 34 [251/1000 8032/32000 (25%)] Loss: 0.20126 (QuantReg: 12.97859) QuantErr: 12.97859 batch_time=0.46672 
Train Epoch: 34 [256/1000 8192/32000 (26%)] Loss: 0.53519 (QuantReg: 13.51130) QuantErr: 13.51130 batch_time=0.44907 
Train Epoch: 34 [261/1000 8352/32000 (26%)] Loss: 0.44908 (QuantReg: 13.15602) QuantErr: 13.15602 batch_time=0.35066 
Train Epoch: 34 [266/1000 8512/32000 (27%)] Loss: 0.27383 (QuantReg: 12.44899) QuantErr: 12.44899 batch_time=0.34430 
Train Epoch: 34 [271/1000 8672/32000 (27%)] Loss: 0.35079 (QuantReg: 12.65935) QuantErr: 12.65935 batch_time=0.41396 
Train Epoch: 34 [276/1000 8832/32000 (28%)] Loss: 0.43067 (QuantReg: 13.33833) QuantErr: 13.33833 batch_time=0.39021 
Train Epoch: 34 [281/1000 8992/32000 (28%)] Loss: 0.16743 (QuantReg: 13.32642) QuantErr: 13.32642 batch_time=0.51464 
Train Epoch: 34 [286/1000 9152/32000 (29%)] Loss: 0.28721 (QuantReg: 13.08804) QuantErr: 13.08804 batch_time=0.41329 
Train Epoch: 34 [291/1000 9312/32000 (29%)] Loss: 0.21221 (QuantReg: 13.10392) QuantErr: 13.10392 batch_time=0.48445 
Train Epoch: 34 [296/1000 9472/32000 (30%)] Loss: 0.45418 (QuantReg: 12.99598) QuantErr: 12.99598 batch_time=0.34123 
Train Epoch: 34 [301/1000 9632/32000 (30%)] Loss: 0.53301 (QuantReg: 12.68659) QuantErr: 12.68659 batch_time=0.43276 
Train Epoch: 34 [306/1000 9792/32000 (31%)] Loss: 0.20265 (QuantReg: 13.25283) QuantErr: 13.25283 batch_time=0.46295 
Train Epoch: 34 [311/1000 9952/32000 (31%)] Loss: 0.43757 (QuantReg: 12.65738) QuantErr: 12.65738 batch_time=0.35210 
Train Epoch: 34 [316/1000 10112/32000 (32%)] Loss: 0.34455 (QuantReg: 13.18234) QuantErr: 13.18234 batch_time=0.44923 
Train Epoch: 34 [321/1000 10272/32000 (32%)] Loss: 0.29735 (QuantReg: 13.23364) QuantErr: 13.23364 batch_time=0.37758 
Train Epoch: 34 [326/1000 10432/32000 (33%)] Loss: 0.66440 (QuantReg: 12.72487) QuantErr: 12.72487 batch_time=0.80801 
Train Epoch: 34 [331/1000 10592/32000 (33%)] Loss: 0.24413 (QuantReg: 13.21428) QuantErr: 13.21428 batch_time=0.34681 
Train Epoch: 34 [336/1000 10752/32000 (34%)] Loss: 0.33930 (QuantReg: 12.92981) QuantErr: 12.92981 batch_time=0.33752 
Train Epoch: 34 [341/1000 10912/32000 (34%)] Loss: 0.38033 (QuantReg: 13.11551) QuantErr: 13.11551 batch_time=0.65072 
Train Epoch: 34 [346/1000 11072/32000 (35%)] Loss: 0.31391 (QuantReg: 12.80478) QuantErr: 12.80478 batch_time=0.43626 
Train Epoch: 34 [351/1000 11232/32000 (35%)] Loss: 0.26234 (QuantReg: 12.54188) QuantErr: 12.54188 batch_time=0.44328 
Train Epoch: 34 [356/1000 11392/32000 (36%)] Loss: 0.49050 (QuantReg: 12.80800) QuantErr: 12.80800 batch_time=1.74436 
Train Epoch: 34 [361/1000 11552/32000 (36%)] Loss: 0.23181 (QuantReg: 12.74289) QuantErr: 12.74289 batch_time=0.37396 
Train Epoch: 34 [366/1000 11712/32000 (37%)] Loss: 0.23775 (QuantReg: 12.66881) QuantErr: 12.66881 batch_time=0.43844 
Train Epoch: 34 [371/1000 11872/32000 (37%)] Loss: 0.30076 (QuantReg: 12.84625) QuantErr: 12.84625 batch_time=0.36729 
Train Epoch: 34 [376/1000 12032/32000 (38%)] Loss: 0.34684 (QuantReg: 13.30168) QuantErr: 13.30168 batch_time=1.39506 
Train Epoch: 34 [381/1000 12192/32000 (38%)] Loss: 0.35127 (QuantReg: 12.61679) QuantErr: 12.61679 batch_time=0.53109 
Train Epoch: 34 [386/1000 12352/32000 (39%)] Loss: 0.33319 (QuantReg: 12.90565) QuantErr: 12.90565 batch_time=0.41725 
Train Epoch: 34 [391/1000 12512/32000 (39%)] Loss: 0.25978 (QuantReg: 13.53630) QuantErr: 13.53630 batch_time=0.36421 
Train Epoch: 34 [396/1000 12672/32000 (40%)] Loss: 0.28591 (QuantReg: 12.54156) QuantErr: 12.54156 batch_time=0.34352 
Train Epoch: 34 [401/1000 12832/32000 (40%)] Loss: 0.53948 (QuantReg: 12.84324) QuantErr: 12.84324 batch_time=0.47230 
Train Epoch: 34 [406/1000 12992/32000 (41%)] Loss: 0.46511 (QuantReg: 12.83756) QuantErr: 12.83756 batch_time=0.37882 
Train Epoch: 34 [411/1000 13152/32000 (41%)] Loss: 0.33354 (QuantReg: 12.61382) QuantErr: 12.61382 batch_time=0.44674 
Train Epoch: 34 [416/1000 13312/32000 (42%)] Loss: 0.32059 (QuantReg: 12.47803) QuantErr: 12.47803 batch_time=0.39847 
Train Epoch: 34 [421/1000 13472/32000 (42%)] Loss: 0.22577 (QuantReg: 13.59549) QuantErr: 13.59549 batch_time=0.65571 
Train Epoch: 34 [426/1000 13632/32000 (43%)] Loss: 0.28980 (QuantReg: 12.94560) QuantErr: 12.94560 batch_time=0.38029 
Train Epoch: 34 [431/1000 13792/32000 (43%)] Loss: 0.48087 (QuantReg: 13.13007) QuantErr: 13.13007 batch_time=0.46045 
Train Epoch: 34 [436/1000 13952/32000 (44%)] Loss: 0.27747 (QuantReg: 12.87782) QuantErr: 12.87782 batch_time=0.52507 
Train Epoch: 34 [441/1000 14112/32000 (44%)] Loss: 0.39400 (QuantReg: 13.07882) QuantErr: 13.07882 batch_time=0.37461 
Train Epoch: 34 [446/1000 14272/32000 (45%)] Loss: 0.40254 (QuantReg: 12.60823) QuantErr: 12.60823 batch_time=0.35767 
Train Epoch: 34 [451/1000 14432/32000 (45%)] Loss: 0.16252 (QuantReg: 13.36901) QuantErr: 13.36901 batch_time=0.36884 
Train Epoch: 34 [456/1000 14592/32000 (46%)] Loss: 0.33202 (QuantReg: 12.88520) QuantErr: 12.88520 batch_time=0.34571 
Train Epoch: 34 [461/1000 14752/32000 (46%)] Loss: 0.39155 (QuantReg: 12.85106) QuantErr: 12.85106 batch_time=0.45250 
Train Epoch: 34 [466/1000 14912/32000 (47%)] Loss: 0.15819 (QuantReg: 13.57433) QuantErr: 13.57433 batch_time=0.35501 
Train Epoch: 34 [471/1000 15072/32000 (47%)] Loss: 0.12338 (QuantReg: 13.49209) QuantErr: 13.49209 batch_time=0.39920 
Train Epoch: 34 [476/1000 15232/32000 (48%)] Loss: 0.39914 (QuantReg: 12.71962) QuantErr: 12.71962 batch_time=0.54445 
Train Epoch: 34 [481/1000 15392/32000 (48%)] Loss: 0.19175 (QuantReg: 13.40639) QuantErr: 13.40639 batch_time=0.43505 
Train Epoch: 34 [486/1000 15552/32000 (49%)] Loss: 0.18899 (QuantReg: 12.96233) QuantErr: 12.96233 batch_time=0.52451 
Train Epoch: 34 [491/1000 15712/32000 (49%)] Loss: 1.24701 (QuantReg: 12.52217) QuantErr: 12.52217 batch_time=0.42723 
Train Epoch: 34 [496/1000 15872/32000 (50%)] Loss: 0.31670 (QuantReg: 12.92784) QuantErr: 12.92784 batch_time=0.40360 
Train Epoch: 34 [501/1000 16032/32000 (50%)] Loss: 0.30993 (QuantReg: 13.40142) QuantErr: 13.40142 batch_time=0.40609 
Train Epoch: 34 [506/1000 16192/32000 (51%)] Loss: 0.47681 (QuantReg: 12.95534) QuantErr: 12.95534 batch_time=0.38696 
Train Epoch: 34 [511/1000 16352/32000 (51%)] Loss: 0.41703 (QuantReg: 13.50379) QuantErr: 13.50379 batch_time=0.51365 
Train Epoch: 34 [516/1000 16512/32000 (52%)] Loss: 0.30013 (QuantReg: 12.67343) QuantErr: 12.67343 batch_time=0.37510 
Train Epoch: 34 [521/1000 16672/32000 (52%)] Loss: 0.49713 (QuantReg: 13.10887) QuantErr: 13.10887 batch_time=0.58830 
Train Epoch: 34 [526/1000 16832/32000 (53%)] Loss: 0.41067 (QuantReg: 12.89884) QuantErr: 12.89884 batch_time=0.31007 
Train Epoch: 34 [531/1000 16992/32000 (53%)] Loss: 0.44016 (QuantReg: 12.66386) QuantErr: 12.66386 batch_time=0.39299 
Train Epoch: 34 [536/1000 17152/32000 (54%)] Loss: 0.70354 (QuantReg: 12.83086) QuantErr: 12.83086 batch_time=0.36043 
Train Epoch: 34 [541/1000 17312/32000 (54%)] Loss: 0.21381 (QuantReg: 13.94212) QuantErr: 13.94212 batch_time=0.38169 
Train Epoch: 34 [546/1000 17472/32000 (55%)] Loss: 0.14029 (QuantReg: 12.59449) QuantErr: 12.59449 batch_time=0.35989 
Train Epoch: 34 [551/1000 17632/32000 (55%)] Loss: 0.27791 (QuantReg: 13.69985) QuantErr: 13.69985 batch_time=0.34746 
Train Epoch: 34 [556/1000 17792/32000 (56%)] Loss: 0.21950 (QuantReg: 12.83974) QuantErr: 12.83974 batch_time=0.44183 
Train Epoch: 34 [561/1000 17952/32000 (56%)] Loss: 0.39046 (QuantReg: 13.14425) QuantErr: 13.14425 batch_time=0.35478 
Train Epoch: 34 [566/1000 18112/32000 (57%)] Loss: 0.36861 (QuantReg: 12.90595) QuantErr: 12.90595 batch_time=0.34620 
Train Epoch: 34 [571/1000 18272/32000 (57%)] Loss: 0.32346 (QuantReg: 13.38907) QuantErr: 13.38907 batch_time=0.89276 
Train Epoch: 34 [576/1000 18432/32000 (58%)] Loss: 0.35267 (QuantReg: 12.51748) QuantErr: 12.51748 batch_time=0.41921 
Train Epoch: 34 [581/1000 18592/32000 (58%)] Loss: 0.17765 (QuantReg: 12.80354) QuantErr: 12.80354 batch_time=0.41209 
Train Epoch: 34 [586/1000 18752/32000 (59%)] Loss: 0.69104 (QuantReg: 13.30735) QuantErr: 13.30735 batch_time=0.34951 
Train Epoch: 34 [591/1000 18912/32000 (59%)] Loss: 0.49645 (QuantReg: 12.83945) QuantErr: 12.83945 batch_time=0.47182 
Train Epoch: 34 [596/1000 19072/32000 (60%)] Loss: 0.36456 (QuantReg: 12.23070) QuantErr: 12.23070 batch_time=0.34286 
Train Epoch: 34 [601/1000 19232/32000 (60%)] Loss: 0.36585 (QuantReg: 12.48047) QuantErr: 12.48047 batch_time=0.35291 
Train Epoch: 34 [606/1000 19392/32000 (61%)] Loss: 0.69796 (QuantReg: 13.41651) QuantErr: 13.41651 batch_time=0.43982 
Train Epoch: 34 [611/1000 19552/32000 (61%)] Loss: 0.37083 (QuantReg: 12.81891) QuantErr: 12.81891 batch_time=0.49264 
Train Epoch: 34 [616/1000 19712/32000 (62%)] Loss: 0.31363 (QuantReg: 12.90272) QuantErr: 12.90272 batch_time=0.74460 
Train Epoch: 34 [621/1000 19872/32000 (62%)] Loss: 0.39364 (QuantReg: 13.68270) QuantErr: 13.68270 batch_time=0.35907 
Train Epoch: 34 [626/1000 20032/32000 (63%)] Loss: 0.43342 (QuantReg: 13.44247) QuantErr: 13.44247 batch_time=0.34807 
Train Epoch: 34 [631/1000 20192/32000 (63%)] Loss: 0.37519 (QuantReg: 13.04613) QuantErr: 13.04613 batch_time=0.37066 
Train Epoch: 34 [636/1000 20352/32000 (64%)] Loss: 0.18595 (QuantReg: 13.07588) QuantErr: 13.07588 batch_time=0.34728 
Train Epoch: 34 [641/1000 20512/32000 (64%)] Loss: 0.42962 (QuantReg: 12.59699) QuantErr: 12.59699 batch_time=0.40266 
Train Epoch: 34 [646/1000 20672/32000 (65%)] Loss: 0.30896 (QuantReg: 13.22998) QuantErr: 13.22998 batch_time=0.35724 
Train Epoch: 34 [651/1000 20832/32000 (65%)] Loss: 0.34493 (QuantReg: 13.43531) QuantErr: 13.43531 batch_time=0.34998 
Train Epoch: 34 [656/1000 20992/32000 (66%)] Loss: 0.50102 (QuantReg: 12.66638) QuantErr: 12.66638 batch_time=0.36580 
Train Epoch: 34 [661/1000 21152/32000 (66%)] Loss: 0.21286 (QuantReg: 13.28749) QuantErr: 13.28749 batch_time=0.70420 
Train Epoch: 34 [666/1000 21312/32000 (67%)] Loss: 0.23760 (QuantReg: 13.07663) QuantErr: 13.07663 batch_time=0.35525 
Train Epoch: 34 [671/1000 21472/32000 (67%)] Loss: 0.37369 (QuantReg: 12.49116) QuantErr: 12.49116 batch_time=0.72961 
Train Epoch: 34 [676/1000 21632/32000 (68%)] Loss: 0.32428 (QuantReg: 12.48314) QuantErr: 12.48314 batch_time=1.73975 
Train Epoch: 34 [681/1000 21792/32000 (68%)] Loss: 0.32562 (QuantReg: 13.20777) QuantErr: 13.20777 batch_time=0.46299 
Train Epoch: 34 [686/1000 21952/32000 (69%)] Loss: 0.40118 (QuantReg: 13.20086) QuantErr: 13.20086 batch_time=0.37092 
Train Epoch: 34 [691/1000 22112/32000 (69%)] Loss: 0.40208 (QuantReg: 13.05486) QuantErr: 13.05486 batch_time=0.46152 
Train Epoch: 34 [696/1000 22272/32000 (70%)] Loss: 0.71808 (QuantReg: 12.91470) QuantErr: 12.91470 batch_time=0.60738 
Train Epoch: 34 [701/1000 22432/32000 (70%)] Loss: 0.53258 (QuantReg: 13.70288) QuantErr: 13.70288 batch_time=0.35501 
Train Epoch: 34 [706/1000 22592/32000 (71%)] Loss: 0.46165 (QuantReg: 13.39310) QuantErr: 13.39310 batch_time=0.45020 
Train Epoch: 34 [711/1000 22752/32000 (71%)] Loss: 0.49543 (QuantReg: 13.17171) QuantErr: 13.17171 batch_time=0.35124 
Train Epoch: 34 [716/1000 22912/32000 (72%)] Loss: 0.34471 (QuantReg: 13.21619) QuantErr: 13.21619 batch_time=0.58119 
Train Epoch: 34 [721/1000 23072/32000 (72%)] Loss: 0.30529 (QuantReg: 13.41429) QuantErr: 13.41429 batch_time=0.36056 
Train Epoch: 34 [726/1000 23232/32000 (73%)] Loss: 0.34280 (QuantReg: 12.77944) QuantErr: 12.77944 batch_time=0.38622 
Train Epoch: 34 [731/1000 23392/32000 (73%)] Loss: 0.45763 (QuantReg: 11.95611) QuantErr: 11.95611 batch_time=0.41153 
Train Epoch: 34 [736/1000 23552/32000 (74%)] Loss: 0.11383 (QuantReg: 13.18627) QuantErr: 13.18627 batch_time=0.40710 
Train Epoch: 34 [741/1000 23712/32000 (74%)] Loss: 0.26983 (QuantReg: 13.37740) QuantErr: 13.37740 batch_time=0.41328 
Train Epoch: 34 [746/1000 23872/32000 (75%)] Loss: 0.43758 (QuantReg: 13.51831) QuantErr: 13.51831 batch_time=0.36848 
Train Epoch: 34 [751/1000 24032/32000 (75%)] Loss: 0.14848 (QuantReg: 13.54889) QuantErr: 13.54889 batch_time=0.44273 
Train Epoch: 34 [756/1000 24192/32000 (76%)] Loss: 0.74613 (QuantReg: 12.95379) QuantErr: 12.95379 batch_time=0.47559 
Train Epoch: 34 [761/1000 24352/32000 (76%)] Loss: 0.34408 (QuantReg: 13.24670) QuantErr: 13.24670 batch_time=0.35867 
Train Epoch: 34 [766/1000 24512/32000 (77%)] Loss: 0.17535 (QuantReg: 12.74971) QuantErr: 12.74971 batch_time=0.48431 
Train Epoch: 34 [771/1000 24672/32000 (77%)] Loss: 0.18253 (QuantReg: 13.42090) QuantErr: 13.42090 batch_time=0.64048 
Train Epoch: 34 [776/1000 24832/32000 (78%)] Loss: 0.15837 (QuantReg: 12.82684) QuantErr: 12.82684 batch_time=0.34288 
Train Epoch: 34 [781/1000 24992/32000 (78%)] Loss: 0.53178 (QuantReg: 12.80995) QuantErr: 12.80995 batch_time=0.53050 
Train Epoch: 34 [786/1000 25152/32000 (79%)] Loss: 0.17534 (QuantReg: 13.32598) QuantErr: 13.32598 batch_time=0.43605 
Train Epoch: 34 [791/1000 25312/32000 (79%)] Loss: 0.59318 (QuantReg: 12.53960) QuantErr: 12.53960 batch_time=0.36465 
Train Epoch: 34 [796/1000 25472/32000 (80%)] Loss: 0.20520 (QuantReg: 13.88387) QuantErr: 13.88387 batch_time=0.43372 
Train Epoch: 34 [801/1000 25632/32000 (80%)] Loss: 0.43980 (QuantReg: 12.73695) QuantErr: 12.73695 batch_time=0.36157 
Train Epoch: 34 [806/1000 25792/32000 (81%)] Loss: 0.31435 (QuantReg: 12.58013) QuantErr: 12.58013 batch_time=0.56907 
Train Epoch: 34 [811/1000 25952/32000 (81%)] Loss: 0.32473 (QuantReg: 13.32599) QuantErr: 13.32599 batch_time=0.39333 
Train Epoch: 34 [816/1000 26112/32000 (82%)] Loss: 0.34200 (QuantReg: 12.98355) QuantErr: 12.98355 batch_time=0.60840 
Train Epoch: 34 [821/1000 26272/32000 (82%)] Loss: 0.37199 (QuantReg: 13.97353) QuantErr: 13.97353 batch_time=0.35960 
Train Epoch: 34 [826/1000 26432/32000 (83%)] Loss: 0.25608 (QuantReg: 13.42686) QuantErr: 13.42686 batch_time=0.38919 
Train Epoch: 34 [831/1000 26592/32000 (83%)] Loss: 0.22813 (QuantReg: 13.44241) QuantErr: 13.44241 batch_time=0.36682 
Train Epoch: 34 [836/1000 26752/32000 (84%)] Loss: 0.38775 (QuantReg: 13.07128) QuantErr: 13.07128 batch_time=0.35299 
Train Epoch: 34 [841/1000 26912/32000 (84%)] Loss: 0.14082 (QuantReg: 13.88895) QuantErr: 13.88895 batch_time=0.36072 
Train Epoch: 34 [846/1000 27072/32000 (85%)] Loss: 0.38663 (QuantReg: 12.35180) QuantErr: 12.35180 batch_time=0.36228 
Train Epoch: 34 [851/1000 27232/32000 (85%)] Loss: 0.35834 (QuantReg: 13.12568) QuantErr: 13.12568 batch_time=0.43343 
Train Epoch: 34 [856/1000 27392/32000 (86%)] Loss: 0.36522 (QuantReg: 13.45151) QuantErr: 13.45151 batch_time=0.44532 
Train Epoch: 34 [861/1000 27552/32000 (86%)] Loss: 0.87273 (QuantReg: 12.61176) QuantErr: 12.61176 batch_time=0.41839 
Train Epoch: 34 [866/1000 27712/32000 (87%)] Loss: 0.33156 (QuantReg: 13.03182) QuantErr: 13.03182 batch_time=0.74848 
Train Epoch: 34 [871/1000 27872/32000 (87%)] Loss: 0.50096 (QuantReg: 12.21921) QuantErr: 12.21921 batch_time=0.73445 
Train Epoch: 34 [876/1000 28032/32000 (88%)] Loss: 0.17886 (QuantReg: 13.49737) QuantErr: 13.49737 batch_time=0.38958 
Train Epoch: 34 [881/1000 28192/32000 (88%)] Loss: 0.28664 (QuantReg: 13.61044) QuantErr: 13.61044 batch_time=0.36814 
Train Epoch: 34 [886/1000 28352/32000 (89%)] Loss: 0.78971 (QuantReg: 12.80841) QuantErr: 12.80841 batch_time=0.38080 
Train Epoch: 34 [891/1000 28512/32000 (89%)] Loss: 0.27157 (QuantReg: 13.84933) QuantErr: 13.84933 batch_time=0.46834 
Train Epoch: 34 [896/1000 28672/32000 (90%)] Loss: 0.09201 (QuantReg: 12.64998) QuantErr: 12.64998 batch_time=0.35126 
Train Epoch: 34 [901/1000 28832/32000 (90%)] Loss: 0.25766 (QuantReg: 12.94363) QuantErr: 12.94363 batch_time=0.35436 
Train Epoch: 34 [906/1000 28992/32000 (91%)] Loss: 0.24872 (QuantReg: 12.59886) QuantErr: 12.59886 batch_time=0.35701 
Train Epoch: 34 [911/1000 29152/32000 (91%)] Loss: 0.56017 (QuantReg: 12.35340) QuantErr: 12.35340 batch_time=0.34351 
Train Epoch: 34 [916/1000 29312/32000 (92%)] Loss: 0.32907 (QuantReg: 12.58481) QuantErr: 12.58481 batch_time=0.84703 
Train Epoch: 34 [921/1000 29472/32000 (92%)] Loss: 0.35157 (QuantReg: 12.87351) QuantErr: 12.87351 batch_time=0.38760 
Train Epoch: 34 [926/1000 29632/32000 (93%)] Loss: 0.36268 (QuantReg: 12.82878) QuantErr: 12.82878 batch_time=0.47515 
Train Epoch: 34 [931/1000 29792/32000 (93%)] Loss: 0.31409 (QuantReg: 12.99773) QuantErr: 12.99773 batch_time=0.35887 
Train Epoch: 34 [936/1000 29952/32000 (94%)] Loss: 0.32380 (QuantReg: 12.26299) QuantErr: 12.26299 batch_time=0.34274 
Train Epoch: 34 [941/1000 30112/32000 (94%)] Loss: 0.33771 (QuantReg: 13.09506) QuantErr: 13.09506 batch_time=0.34204 
Train Epoch: 34 [946/1000 30272/32000 (95%)] Loss: 0.53219 (QuantReg: 12.96500) QuantErr: 12.96500 batch_time=0.35519 
Train Epoch: 34 [951/1000 30432/32000 (95%)] Loss: 0.32556 (QuantReg: 13.10494) QuantErr: 13.10494 batch_time=0.34820 
Train Epoch: 34 [956/1000 30592/32000 (96%)] Loss: 0.55480 (QuantReg: 13.14252) QuantErr: 13.14252 batch_time=0.37167 
Train Epoch: 34 [961/1000 30752/32000 (96%)] Loss: 0.32416 (QuantReg: 13.21964) QuantErr: 13.21964 batch_time=0.34038 
Train Epoch: 34 [966/1000 30912/32000 (97%)] Loss: 0.39821 (QuantReg: 12.74986) QuantErr: 12.74986 batch_time=0.53803 
Train Epoch: 34 [971/1000 31072/32000 (97%)] Loss: 0.17444 (QuantReg: 12.92916) QuantErr: 12.92916 batch_time=0.34587 
Train Epoch: 34 [976/1000 31232/32000 (98%)] Loss: 0.40804 (QuantReg: 12.97274) QuantErr: 12.97274 batch_time=1.52255 
Train Epoch: 34 [981/1000 31392/32000 (98%)] Loss: 0.12936 (QuantReg: 12.98421) QuantErr: 12.98421 batch_time=0.34253 
Train Epoch: 34 [986/1000 31552/32000 (99%)] Loss: 0.42219 (QuantReg: 13.53272) QuantErr: 13.53272 batch_time=0.37657 
Train Epoch: 34 [991/1000 31712/32000 (99%)] Loss: 0.32964 (QuantReg: 12.97474) QuantErr: 12.97474 batch_time=0.36852 
Train Epoch: 34 [996/1000 31872/32000 (100%)] Loss: 0.33235 (QuantReg: 13.29979) QuantErr: 13.29979 batch_time=0.77991 
Train Epoch: 34 codebook_update_time=1.77409
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch34.pth ...
Done in 4.781s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch34.pth ...
Done in 9.468s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 0.346505911834538
 quant_reg      : 13.001816172599792
 quant_err      : 13.001816172599792
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 34000
 MSRVTT_miech_test/t2v_metrics/R1: 21.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.3
 MSRVTT_miech_test/t2v_metrics/R10: 64.3
 MSRVTT_miech_test/t2v_metrics/R50: 88.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.399
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.036608587691525
 MSRVTT_miech_test/v2t_metrics/R1: 19.2
 MSRVTT_miech_test/v2t_metrics/R5: 51.0
 MSRVTT_miech_test/v2t_metrics/R10: 64.8
 MSRVTT_miech_test/v2t_metrics/R50: 89.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.689
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.88553944863213
 mnt_best       : 41.036608587691525
 not_improved_count: 0
Train Epoch: 35 [1/1000 32/32000 (0%)] Loss: 0.42942 (QuantReg: 12.72485) QuantErr: 12.72485 batch_time=29.60989 
Train Epoch: 35 [6/1000 192/32000 (1%)] Loss: 0.76258 (QuantReg: 13.75537) QuantErr: 13.75537 batch_time=0.45772 
Train Epoch: 35 [11/1000 352/32000 (1%)] Loss: 0.25086 (QuantReg: 12.75643) QuantErr: 12.75643 batch_time=0.57299 
Train Epoch: 35 [16/1000 512/32000 (2%)] Loss: 0.50663 (QuantReg: 13.10027) QuantErr: 13.10027 batch_time=0.48800 
Train Epoch: 35 [21/1000 672/32000 (2%)] Loss: 0.24985 (QuantReg: 12.96340) QuantErr: 12.96340 batch_time=0.39107 
Train Epoch: 35 [26/1000 832/32000 (3%)] Loss: 0.19039 (QuantReg: 13.01578) QuantErr: 13.01578 batch_time=0.35946 
Train Epoch: 35 [31/1000 992/32000 (3%)] Loss: 0.41471 (QuantReg: 12.85483) QuantErr: 12.85483 batch_time=0.34378 
Train Epoch: 35 [36/1000 1152/32000 (4%)] Loss: 0.14567 (QuantReg: 12.38109) QuantErr: 12.38109 batch_time=0.45236 
Train Epoch: 35 [41/1000 1312/32000 (4%)] Loss: 0.77452 (QuantReg: 12.17018) QuantErr: 12.17018 batch_time=0.34004 
Train Epoch: 35 [46/1000 1472/32000 (5%)] Loss: 0.39275 (QuantReg: 13.26122) QuantErr: 13.26122 batch_time=0.83501 
Train Epoch: 35 [51/1000 1632/32000 (5%)] Loss: 0.37981 (QuantReg: 13.36041) QuantErr: 13.36041 batch_time=0.55576 
Train Epoch: 35 [56/1000 1792/32000 (6%)] Loss: 0.10143 (QuantReg: 12.94386) QuantErr: 12.94386 batch_time=0.34025 
Train Epoch: 35 [61/1000 1952/32000 (6%)] Loss: 0.25549 (QuantReg: 12.70803) QuantErr: 12.70803 batch_time=0.43054 
Train Epoch: 35 [66/1000 2112/32000 (7%)] Loss: 0.29903 (QuantReg: 12.44978) QuantErr: 12.44978 batch_time=0.34258 
Train Epoch: 35 [71/1000 2272/32000 (7%)] Loss: 0.52701 (QuantReg: 12.95096) QuantErr: 12.95096 batch_time=0.52833 
Train Epoch: 35 [76/1000 2432/32000 (8%)] Loss: 0.45679 (QuantReg: 12.87214) QuantErr: 12.87214 batch_time=0.34549 
Train Epoch: 35 [81/1000 2592/32000 (8%)] Loss: 0.40527 (QuantReg: 12.51707) QuantErr: 12.51707 batch_time=0.68127 
Train Epoch: 35 [86/1000 2752/32000 (9%)] Loss: 0.14028 (QuantReg: 12.84472) QuantErr: 12.84472 batch_time=0.47943 
Train Epoch: 35 [91/1000 2912/32000 (9%)] Loss: 0.21231 (QuantReg: 12.77849) QuantErr: 12.77849 batch_time=0.58159 
Train Epoch: 35 [96/1000 3072/32000 (10%)] Loss: 0.23733 (QuantReg: 13.23762) QuantErr: 13.23762 batch_time=0.53261 
Train Epoch: 35 [101/1000 3232/32000 (10%)] Loss: 0.50899 (QuantReg: 12.70918) QuantErr: 12.70918 batch_time=0.48838 
Train Epoch: 35 [106/1000 3392/32000 (11%)] Loss: 0.69843 (QuantReg: 12.72685) QuantErr: 12.72685 batch_time=0.36138 
Train Epoch: 35 [111/1000 3552/32000 (11%)] Loss: 0.25338 (QuantReg: 13.60982) QuantErr: 13.60982 batch_time=0.37075 
Train Epoch: 35 [116/1000 3712/32000 (12%)] Loss: 0.46928 (QuantReg: 12.75474) QuantErr: 12.75474 batch_time=0.47850 
Train Epoch: 35 [121/1000 3872/32000 (12%)] Loss: 0.19187 (QuantReg: 13.28072) QuantErr: 13.28072 batch_time=0.38958 
Train Epoch: 35 [126/1000 4032/32000 (13%)] Loss: 0.22141 (QuantReg: 13.05923) QuantErr: 13.05923 batch_time=0.38721 
Train Epoch: 35 [131/1000 4192/32000 (13%)] Loss: 0.41965 (QuantReg: 12.57792) QuantErr: 12.57792 batch_time=0.40766 
Train Epoch: 35 [136/1000 4352/32000 (14%)] Loss: 0.15417 (QuantReg: 12.98486) QuantErr: 12.98486 batch_time=0.37000 
Train Epoch: 35 [141/1000 4512/32000 (14%)] Loss: 0.41833 (QuantReg: 13.20448) QuantErr: 13.20448 batch_time=0.43684 
Train Epoch: 35 [146/1000 4672/32000 (15%)] Loss: 0.36803 (QuantReg: 12.76574) QuantErr: 12.76574 batch_time=2.28401 
Train Epoch: 35 [151/1000 4832/32000 (15%)] Loss: 0.42658 (QuantReg: 12.41625) QuantErr: 12.41625 batch_time=0.35792 
Train Epoch: 35 [156/1000 4992/32000 (16%)] Loss: 0.14932 (QuantReg: 13.00962) QuantErr: 13.00962 batch_time=0.40571 
Train Epoch: 35 [161/1000 5152/32000 (16%)] Loss: 0.39742 (QuantReg: 13.10660) QuantErr: 13.10660 batch_time=0.39421 
Train Epoch: 35 [166/1000 5312/32000 (17%)] Loss: 0.71684 (QuantReg: 13.34990) QuantErr: 13.34990 batch_time=0.38739 
Train Epoch: 35 [171/1000 5472/32000 (17%)] Loss: 0.38954 (QuantReg: 13.17078) QuantErr: 13.17078 batch_time=0.42504 
Train Epoch: 35 [176/1000 5632/32000 (18%)] Loss: 0.48414 (QuantReg: 12.65782) QuantErr: 12.65782 batch_time=0.37943 
Train Epoch: 35 [181/1000 5792/32000 (18%)] Loss: 0.64942 (QuantReg: 13.29566) QuantErr: 13.29566 batch_time=0.37740 
Train Epoch: 35 [186/1000 5952/32000 (19%)] Loss: 0.50473 (QuantReg: 12.76307) QuantErr: 12.76307 batch_time=0.42342 
Train Epoch: 35 [191/1000 6112/32000 (19%)] Loss: 0.31067 (QuantReg: 12.66721) QuantErr: 12.66721 batch_time=0.60862 
Train Epoch: 35 [196/1000 6272/32000 (20%)] Loss: 0.37095 (QuantReg: 13.56572) QuantErr: 13.56572 batch_time=0.75221 
Train Epoch: 35 [201/1000 6432/32000 (20%)] Loss: 0.32266 (QuantReg: 12.67667) QuantErr: 12.67667 batch_time=0.36705 
Train Epoch: 35 [206/1000 6592/32000 (21%)] Loss: 0.36300 (QuantReg: 13.15017) QuantErr: 13.15017 batch_time=0.37544 
Train Epoch: 35 [211/1000 6752/32000 (21%)] Loss: 0.47761 (QuantReg: 13.14487) QuantErr: 13.14487 batch_time=0.41332 
Train Epoch: 35 [216/1000 6912/32000 (22%)] Loss: 0.57387 (QuantReg: 12.63518) QuantErr: 12.63518 batch_time=0.36935 
Train Epoch: 35 [221/1000 7072/32000 (22%)] Loss: 0.78944 (QuantReg: 12.79456) QuantErr: 12.79456 batch_time=0.37343 
Train Epoch: 35 [226/1000 7232/32000 (23%)] Loss: 0.19095 (QuantReg: 12.75527) QuantErr: 12.75527 batch_time=0.35123 
Train Epoch: 35 [231/1000 7392/32000 (23%)] Loss: 0.39373 (QuantReg: 12.91687) QuantErr: 12.91687 batch_time=0.54500 
Train Epoch: 35 [236/1000 7552/32000 (24%)] Loss: 0.72246 (QuantReg: 13.73875) QuantErr: 13.73875 batch_time=0.38731 
Train Epoch: 35 [241/1000 7712/32000 (24%)] Loss: 0.59767 (QuantReg: 13.09007) QuantErr: 13.09007 batch_time=0.82208 
Train Epoch: 35 [246/1000 7872/32000 (25%)] Loss: 0.26693 (QuantReg: 12.33514) QuantErr: 12.33514 batch_time=0.43605 
Train Epoch: 35 [251/1000 8032/32000 (25%)] Loss: 0.14736 (QuantReg: 13.23893) QuantErr: 13.23893 batch_time=0.39675 
Train Epoch: 35 [256/1000 8192/32000 (26%)] Loss: 0.21410 (QuantReg: 13.40833) QuantErr: 13.40833 batch_time=0.39517 
Train Epoch: 35 [261/1000 8352/32000 (26%)] Loss: 0.40654 (QuantReg: 13.56800) QuantErr: 13.56800 batch_time=0.39379 
Train Epoch: 35 [266/1000 8512/32000 (27%)] Loss: 0.53600 (QuantReg: 12.54814) QuantErr: 12.54814 batch_time=0.35823 
Train Epoch: 35 [271/1000 8672/32000 (27%)] Loss: 0.16437 (QuantReg: 13.38997) QuantErr: 13.38997 batch_time=0.36959 
Train Epoch: 35 [276/1000 8832/32000 (28%)] Loss: 0.29769 (QuantReg: 12.85309) QuantErr: 12.85309 batch_time=0.44149 
Train Epoch: 35 [281/1000 8992/32000 (28%)] Loss: 0.17573 (QuantReg: 13.36720) QuantErr: 13.36720 batch_time=0.38181 
Train Epoch: 35 [286/1000 9152/32000 (29%)] Loss: 0.49344 (QuantReg: 12.45186) QuantErr: 12.45186 batch_time=0.39170 
Train Epoch: 35 [291/1000 9312/32000 (29%)] Loss: 0.34563 (QuantReg: 13.19660) QuantErr: 13.19660 batch_time=0.37094 
Train Epoch: 35 [296/1000 9472/32000 (30%)] Loss: 0.43954 (QuantReg: 12.60252) QuantErr: 12.60252 batch_time=0.54728 
Train Epoch: 35 [301/1000 9632/32000 (30%)] Loss: 0.14009 (QuantReg: 12.86712) QuantErr: 12.86712 batch_time=0.34649 
Train Epoch: 35 [306/1000 9792/32000 (31%)] Loss: 0.34603 (QuantReg: 13.11965) QuantErr: 13.11965 batch_time=0.45623 
Train Epoch: 35 [311/1000 9952/32000 (31%)] Loss: 0.38623 (QuantReg: 13.29850) QuantErr: 13.29850 batch_time=0.39565 
Train Epoch: 35 [316/1000 10112/32000 (32%)] Loss: 0.21215 (QuantReg: 13.01591) QuantErr: 13.01591 batch_time=0.37646 
Train Epoch: 35 [321/1000 10272/32000 (32%)] Loss: 0.34886 (QuantReg: 12.77499) QuantErr: 12.77499 batch_time=0.37498 
Train Epoch: 35 [326/1000 10432/32000 (33%)] Loss: 0.55982 (QuantReg: 12.36320) QuantErr: 12.36320 batch_time=0.37388 
Train Epoch: 35 [331/1000 10592/32000 (33%)] Loss: 0.14213 (QuantReg: 13.30003) QuantErr: 13.30003 batch_time=0.36434 
Train Epoch: 35 [336/1000 10752/32000 (34%)] Loss: 0.50557 (QuantReg: 12.50727) QuantErr: 12.50727 batch_time=0.36419 
Train Epoch: 35 [341/1000 10912/32000 (34%)] Loss: 0.33446 (QuantReg: 12.57175) QuantErr: 12.57175 batch_time=0.36928 
Train Epoch: 35 [346/1000 11072/32000 (35%)] Loss: 0.62528 (QuantReg: 12.72135) QuantErr: 12.72135 batch_time=0.36169 
Train Epoch: 35 [351/1000 11232/32000 (35%)] Loss: 0.79256 (QuantReg: 12.42277) QuantErr: 12.42277 batch_time=0.33990 
Train Epoch: 35 [356/1000 11392/32000 (36%)] Loss: 0.24659 (QuantReg: 12.64978) QuantErr: 12.64978 batch_time=0.61266 
Train Epoch: 35 [361/1000 11552/32000 (36%)] Loss: 0.34056 (QuantReg: 12.45413) QuantErr: 12.45413 batch_time=0.41922 
Train Epoch: 35 [366/1000 11712/32000 (37%)] Loss: 0.09871 (QuantReg: 13.24853) QuantErr: 13.24853 batch_time=0.39938 
Train Epoch: 35 [371/1000 11872/32000 (37%)] Loss: 0.23212 (QuantReg: 12.88530) QuantErr: 12.88530 batch_time=0.38632 
Train Epoch: 35 [376/1000 12032/32000 (38%)] Loss: 0.61889 (QuantReg: 12.91006) QuantErr: 12.91006 batch_time=0.46633 
Train Epoch: 35 [381/1000 12192/32000 (38%)] Loss: 0.17246 (QuantReg: 12.30395) QuantErr: 12.30395 batch_time=0.38509 
Train Epoch: 35 [386/1000 12352/32000 (39%)] Loss: 0.12596 (QuantReg: 13.50593) QuantErr: 13.50593 batch_time=0.36317 
Train Epoch: 35 [391/1000 12512/32000 (39%)] Loss: 0.41323 (QuantReg: 12.68970) QuantErr: 12.68970 batch_time=0.38118 
Train Epoch: 35 [396/1000 12672/32000 (40%)] Loss: 0.55942 (QuantReg: 12.95749) QuantErr: 12.95749 batch_time=0.45991 
Train Epoch: 35 [401/1000 12832/32000 (40%)] Loss: 0.22300 (QuantReg: 12.79948) QuantErr: 12.79948 batch_time=0.37468 
Train Epoch: 35 [406/1000 12992/32000 (41%)] Loss: 0.36657 (QuantReg: 13.04624) QuantErr: 13.04624 batch_time=0.44045 
Train Epoch: 35 [411/1000 13152/32000 (41%)] Loss: 0.19178 (QuantReg: 12.85885) QuantErr: 12.85885 batch_time=2.26252 
Train Epoch: 35 [416/1000 13312/32000 (42%)] Loss: 0.61738 (QuantReg: 12.49109) QuantErr: 12.49109 batch_time=0.38410 
Train Epoch: 35 [421/1000 13472/32000 (42%)] Loss: 0.37755 (QuantReg: 13.14803) QuantErr: 13.14803 batch_time=0.34968 
Train Epoch: 35 [426/1000 13632/32000 (43%)] Loss: 0.37555 (QuantReg: 13.26533) QuantErr: 13.26533 batch_time=0.35428 
Train Epoch: 35 [431/1000 13792/32000 (43%)] Loss: 0.32895 (QuantReg: 12.65010) QuantErr: 12.65010 batch_time=0.35067 
Train Epoch: 35 [436/1000 13952/32000 (44%)] Loss: 0.36037 (QuantReg: 13.09950) QuantErr: 13.09950 batch_time=0.35094 
Train Epoch: 35 [441/1000 14112/32000 (44%)] Loss: 0.49484 (QuantReg: 13.09292) QuantErr: 13.09292 batch_time=0.36627 
Train Epoch: 35 [446/1000 14272/32000 (45%)] Loss: 0.09422 (QuantReg: 13.12190) QuantErr: 13.12190 batch_time=0.44851 
Train Epoch: 35 [451/1000 14432/32000 (45%)] Loss: 0.45047 (QuantReg: 13.02480) QuantErr: 13.02480 batch_time=0.43758 
Train Epoch: 35 [456/1000 14592/32000 (46%)] Loss: 0.63834 (QuantReg: 13.12296) QuantErr: 13.12296 batch_time=0.47895 
Train Epoch: 35 [461/1000 14752/32000 (46%)] Loss: 0.37939 (QuantReg: 13.09667) QuantErr: 13.09667 batch_time=0.44453 
Train Epoch: 35 [466/1000 14912/32000 (47%)] Loss: 0.27756 (QuantReg: 12.70033) QuantErr: 12.70033 batch_time=0.36852 
Train Epoch: 35 [471/1000 15072/32000 (47%)] Loss: 0.32464 (QuantReg: 13.80077) QuantErr: 13.80077 batch_time=0.37066 
Train Epoch: 35 [476/1000 15232/32000 (48%)] Loss: 0.35676 (QuantReg: 12.91056) QuantErr: 12.91056 batch_time=0.35554 
Train Epoch: 35 [481/1000 15392/32000 (48%)] Loss: 0.23335 (QuantReg: 13.30866) QuantErr: 13.30866 batch_time=0.37329 
Train Epoch: 35 [486/1000 15552/32000 (49%)] Loss: 0.35571 (QuantReg: 12.21252) QuantErr: 12.21252 batch_time=0.36238 
Train Epoch: 35 [491/1000 15712/32000 (49%)] Loss: 0.29546 (QuantReg: 12.66443) QuantErr: 12.66443 batch_time=0.38840 
Train Epoch: 35 [496/1000 15872/32000 (50%)] Loss: 0.34661 (QuantReg: 12.82070) QuantErr: 12.82070 batch_time=0.34260 
Train Epoch: 35 [501/1000 16032/32000 (50%)] Loss: 0.91284 (QuantReg: 13.26505) QuantErr: 13.26505 batch_time=0.60335 
Train Epoch: 35 [506/1000 16192/32000 (51%)] Loss: 0.68877 (QuantReg: 12.57681) QuantErr: 12.57681 batch_time=0.49627 
Train Epoch: 35 [511/1000 16352/32000 (51%)] Loss: 0.12928 (QuantReg: 13.24360) QuantErr: 13.24360 batch_time=0.34853 
Train Epoch: 35 [516/1000 16512/32000 (52%)] Loss: 0.20152 (QuantReg: 13.29563) QuantErr: 13.29563 batch_time=0.46823 
Train Epoch: 35 [521/1000 16672/32000 (52%)] Loss: 0.21487 (QuantReg: 12.67232) QuantErr: 12.67232 batch_time=0.34612 
Train Epoch: 35 [526/1000 16832/32000 (53%)] Loss: 0.65483 (QuantReg: 11.90820) QuantErr: 11.90820 batch_time=0.35680 
Train Epoch: 35 [531/1000 16992/32000 (53%)] Loss: 0.23069 (QuantReg: 13.04327) QuantErr: 13.04327 batch_time=0.41061 
Train Epoch: 35 [536/1000 17152/32000 (54%)] Loss: 0.45862 (QuantReg: 12.67317) QuantErr: 12.67317 batch_time=0.42063 
Train Epoch: 35 [541/1000 17312/32000 (54%)] Loss: 0.24179 (QuantReg: 12.54556) QuantErr: 12.54556 batch_time=0.50435 
Train Epoch: 35 [546/1000 17472/32000 (55%)] Loss: 0.82588 (QuantReg: 12.29927) QuantErr: 12.29927 batch_time=0.34868 
Train Epoch: 35 [551/1000 17632/32000 (55%)] Loss: 0.45911 (QuantReg: 12.84727) QuantErr: 12.84727 batch_time=0.54641 
Train Epoch: 35 [556/1000 17792/32000 (56%)] Loss: 0.49757 (QuantReg: 13.03262) QuantErr: 13.03262 batch_time=0.34959 
Train Epoch: 35 [561/1000 17952/32000 (56%)] Loss: 0.10241 (QuantReg: 12.92589) QuantErr: 12.92589 batch_time=0.35915 
Train Epoch: 35 [566/1000 18112/32000 (57%)] Loss: 0.20062 (QuantReg: 13.32091) QuantErr: 13.32091 batch_time=0.41643 
Train Epoch: 35 [571/1000 18272/32000 (57%)] Loss: 0.41702 (QuantReg: 12.43854) QuantErr: 12.43854 batch_time=0.37020 
Train Epoch: 35 [576/1000 18432/32000 (58%)] Loss: 0.39275 (QuantReg: 13.22856) QuantErr: 13.22856 batch_time=0.39970 
Train Epoch: 35 [581/1000 18592/32000 (58%)] Loss: 0.24828 (QuantReg: 12.98357) QuantErr: 12.98357 batch_time=0.36420 
Train Epoch: 35 [586/1000 18752/32000 (59%)] Loss: 0.20400 (QuantReg: 13.62966) QuantErr: 13.62966 batch_time=0.45443 
Train Epoch: 35 [591/1000 18912/32000 (59%)] Loss: 0.26400 (QuantReg: 13.14552) QuantErr: 13.14552 batch_time=0.43416 
Train Epoch: 35 [596/1000 19072/32000 (60%)] Loss: 0.37183 (QuantReg: 13.24451) QuantErr: 13.24451 batch_time=0.46387 
Train Epoch: 35 [601/1000 19232/32000 (60%)] Loss: 0.30515 (QuantReg: 12.50928) QuantErr: 12.50928 batch_time=0.38667 
Train Epoch: 35 [606/1000 19392/32000 (61%)] Loss: 0.44145 (QuantReg: 12.24278) QuantErr: 12.24278 batch_time=0.43019 
Train Epoch: 35 [611/1000 19552/32000 (61%)] Loss: 0.31872 (QuantReg: 13.24005) QuantErr: 13.24005 batch_time=0.36835 
Train Epoch: 35 [616/1000 19712/32000 (62%)] Loss: 0.70602 (QuantReg: 12.72803) QuantErr: 12.72803 batch_time=0.38720 
Train Epoch: 35 [621/1000 19872/32000 (62%)] Loss: 0.26818 (QuantReg: 13.56617) QuantErr: 13.56617 batch_time=0.35367 
Train Epoch: 35 [626/1000 20032/32000 (63%)] Loss: 0.46369 (QuantReg: 12.84344) QuantErr: 12.84344 batch_time=0.39281 
Train Epoch: 35 [631/1000 20192/32000 (63%)] Loss: 0.42320 (QuantReg: 12.93442) QuantErr: 12.93442 batch_time=0.35981 
Train Epoch: 35 [636/1000 20352/32000 (64%)] Loss: 0.27437 (QuantReg: 12.88118) QuantErr: 12.88118 batch_time=0.34926 
Train Epoch: 35 [641/1000 20512/32000 (64%)] Loss: 0.43045 (QuantReg: 12.73831) QuantErr: 12.73831 batch_time=0.37308 
Train Epoch: 35 [646/1000 20672/32000 (65%)] Loss: 0.58543 (QuantReg: 12.22427) QuantErr: 12.22427 batch_time=0.36375 
Train Epoch: 35 [651/1000 20832/32000 (65%)] Loss: 0.19693 (QuantReg: 13.38691) QuantErr: 13.38691 batch_time=0.36324 
Train Epoch: 35 [656/1000 20992/32000 (66%)] Loss: 0.12452 (QuantReg: 13.70415) QuantErr: 13.70415 batch_time=0.71485 
Train Epoch: 35 [661/1000 21152/32000 (66%)] Loss: 0.16727 (QuantReg: 13.57445) QuantErr: 13.57445 batch_time=0.41705 
Train Epoch: 35 [666/1000 21312/32000 (67%)] Loss: 0.40378 (QuantReg: 12.85316) QuantErr: 12.85316 batch_time=0.42219 
Train Epoch: 35 [671/1000 21472/32000 (67%)] Loss: 0.27019 (QuantReg: 13.19181) QuantErr: 13.19181 batch_time=0.37888 
Train Epoch: 35 [676/1000 21632/32000 (68%)] Loss: 0.10223 (QuantReg: 13.64510) QuantErr: 13.64510 batch_time=0.66596 
Train Epoch: 35 [681/1000 21792/32000 (68%)] Loss: 0.25644 (QuantReg: 13.29137) QuantErr: 13.29137 batch_time=0.44094 
Train Epoch: 35 [686/1000 21952/32000 (69%)] Loss: 0.23200 (QuantReg: 12.90078) QuantErr: 12.90078 batch_time=0.41168 
Train Epoch: 35 [691/1000 22112/32000 (69%)] Loss: 0.41023 (QuantReg: 13.44855) QuantErr: 13.44855 batch_time=0.65417 
Train Epoch: 35 [696/1000 22272/32000 (70%)] Loss: 0.24797 (QuantReg: 14.02344) QuantErr: 14.02344 batch_time=0.33392 
Train Epoch: 35 [701/1000 22432/32000 (70%)] Loss: 0.12991 (QuantReg: 13.28626) QuantErr: 13.28626 batch_time=0.60806 
Train Epoch: 35 [706/1000 22592/32000 (71%)] Loss: 0.32044 (QuantReg: 13.13676) QuantErr: 13.13676 batch_time=0.39891 
Train Epoch: 35 [711/1000 22752/32000 (71%)] Loss: 0.36057 (QuantReg: 12.54892) QuantErr: 12.54892 batch_time=0.34053 
Train Epoch: 35 [716/1000 22912/32000 (72%)] Loss: 0.50980 (QuantReg: 12.69115) QuantErr: 12.69115 batch_time=0.34574 
Train Epoch: 35 [721/1000 23072/32000 (72%)] Loss: 0.23265 (QuantReg: 13.40007) QuantErr: 13.40007 batch_time=1.89561 
Train Epoch: 35 [726/1000 23232/32000 (73%)] Loss: 0.32659 (QuantReg: 12.76473) QuantErr: 12.76473 batch_time=0.38313 
Train Epoch: 35 [731/1000 23392/32000 (73%)] Loss: 0.34376 (QuantReg: 13.03585) QuantErr: 13.03585 batch_time=0.68916 
Train Epoch: 35 [736/1000 23552/32000 (74%)] Loss: 0.33379 (QuantReg: 12.82674) QuantErr: 12.82674 batch_time=0.35867 
Train Epoch: 35 [741/1000 23712/32000 (74%)] Loss: 0.37346 (QuantReg: 12.04588) QuantErr: 12.04588 batch_time=0.46193 
Train Epoch: 35 [746/1000 23872/32000 (75%)] Loss: 0.33483 (QuantReg: 13.30960) QuantErr: 13.30960 batch_time=0.34914 
Train Epoch: 35 [751/1000 24032/32000 (75%)] Loss: 0.31949 (QuantReg: 13.54465) QuantErr: 13.54465 batch_time=0.72322 
Train Epoch: 35 [756/1000 24192/32000 (76%)] Loss: 0.34372 (QuantReg: 13.18246) QuantErr: 13.18246 batch_time=0.35279 
Train Epoch: 35 [761/1000 24352/32000 (76%)] Loss: 0.19022 (QuantReg: 13.26774) QuantErr: 13.26774 batch_time=0.34622 
Train Epoch: 35 [766/1000 24512/32000 (77%)] Loss: 0.32788 (QuantReg: 12.59618) QuantErr: 12.59618 batch_time=0.34839 
Train Epoch: 35 [771/1000 24672/32000 (77%)] Loss: 0.16186 (QuantReg: 12.55266) QuantErr: 12.55266 batch_time=0.34077 
Train Epoch: 35 [776/1000 24832/32000 (78%)] Loss: 0.33823 (QuantReg: 12.28002) QuantErr: 12.28002 batch_time=0.35019 
Train Epoch: 35 [781/1000 24992/32000 (78%)] Loss: 0.06333 (QuantReg: 12.48243) QuantErr: 12.48243 batch_time=0.35402 
Train Epoch: 35 [786/1000 25152/32000 (79%)] Loss: 0.47823 (QuantReg: 13.33181) QuantErr: 13.33181 batch_time=0.34818 
Train Epoch: 35 [791/1000 25312/32000 (79%)] Loss: 0.17275 (QuantReg: 13.64715) QuantErr: 13.64715 batch_time=0.34075 
Train Epoch: 35 [796/1000 25472/32000 (80%)] Loss: 0.09860 (QuantReg: 13.08791) QuantErr: 13.08791 batch_time=0.41182 
Train Epoch: 35 [801/1000 25632/32000 (80%)] Loss: 0.27819 (QuantReg: 12.89083) QuantErr: 12.89083 batch_time=0.63908 
Train Epoch: 35 [806/1000 25792/32000 (81%)] Loss: 0.58229 (QuantReg: 13.34444) QuantErr: 13.34444 batch_time=0.44460 
Train Epoch: 35 [811/1000 25952/32000 (81%)] Loss: 0.21200 (QuantReg: 12.87705) QuantErr: 12.87705 batch_time=0.34995 
Train Epoch: 35 [816/1000 26112/32000 (82%)] Loss: 0.16192 (QuantReg: 13.19648) QuantErr: 13.19648 batch_time=0.37698 
Train Epoch: 35 [821/1000 26272/32000 (82%)] Loss: 0.32419 (QuantReg: 13.40269) QuantErr: 13.40269 batch_time=0.36534 
Train Epoch: 35 [826/1000 26432/32000 (83%)] Loss: 0.31692 (QuantReg: 13.40043) QuantErr: 13.40043 batch_time=0.37353 
Train Epoch: 35 [831/1000 26592/32000 (83%)] Loss: 0.18937 (QuantReg: 13.20399) QuantErr: 13.20399 batch_time=0.47137 
Train Epoch: 35 [836/1000 26752/32000 (84%)] Loss: 0.60028 (QuantReg: 13.70128) QuantErr: 13.70128 batch_time=0.34910 
Train Epoch: 35 [841/1000 26912/32000 (84%)] Loss: 0.03377 (QuantReg: 12.73235) QuantErr: 12.73235 batch_time=0.35852 
Train Epoch: 35 [846/1000 27072/32000 (85%)] Loss: 0.49774 (QuantReg: 12.54074) QuantErr: 12.54074 batch_time=0.36586 
Train Epoch: 35 [851/1000 27232/32000 (85%)] Loss: 0.29131 (QuantReg: 13.35668) QuantErr: 13.35668 batch_time=0.60539 
Train Epoch: 35 [856/1000 27392/32000 (86%)] Loss: 0.20396 (QuantReg: 13.67725) QuantErr: 13.67725 batch_time=0.35585 
Train Epoch: 35 [861/1000 27552/32000 (86%)] Loss: 0.51499 (QuantReg: 12.25394) QuantErr: 12.25394 batch_time=0.36198 
Train Epoch: 35 [866/1000 27712/32000 (87%)] Loss: 0.18144 (QuantReg: 13.38173) QuantErr: 13.38173 batch_time=0.35758 
Train Epoch: 35 [871/1000 27872/32000 (87%)] Loss: 0.54120 (QuantReg: 12.97393) QuantErr: 12.97393 batch_time=0.36297 
Train Epoch: 35 [876/1000 28032/32000 (88%)] Loss: 0.39617 (QuantReg: 13.42618) QuantErr: 13.42618 batch_time=0.37997 
Train Epoch: 35 [881/1000 28192/32000 (88%)] Loss: 0.32213 (QuantReg: 12.46487) QuantErr: 12.46487 batch_time=0.45287 
Train Epoch: 35 [886/1000 28352/32000 (89%)] Loss: 0.27535 (QuantReg: 13.67963) QuantErr: 13.67963 batch_time=0.44452 
Train Epoch: 35 [891/1000 28512/32000 (89%)] Loss: 0.25762 (QuantReg: 12.65874) QuantErr: 12.65874 batch_time=0.40710 
Train Epoch: 35 [896/1000 28672/32000 (90%)] Loss: 0.32329 (QuantReg: 13.52993) QuantErr: 13.52993 batch_time=0.34824 
Train Epoch: 35 [901/1000 28832/32000 (90%)] Loss: 0.31265 (QuantReg: 12.53178) QuantErr: 12.53178 batch_time=0.79433 
Train Epoch: 35 [906/1000 28992/32000 (91%)] Loss: 0.16267 (QuantReg: 13.56830) QuantErr: 13.56830 batch_time=0.41918 
Train Epoch: 35 [911/1000 29152/32000 (91%)] Loss: 0.34174 (QuantReg: 12.76680) QuantErr: 12.76680 batch_time=0.41261 
Train Epoch: 35 [916/1000 29312/32000 (92%)] Loss: 0.18790 (QuantReg: 13.29976) QuantErr: 13.29976 batch_time=0.60348 
Train Epoch: 35 [921/1000 29472/32000 (92%)] Loss: 0.49036 (QuantReg: 12.92664) QuantErr: 12.92664 batch_time=0.37019 
Train Epoch: 35 [926/1000 29632/32000 (93%)] Loss: 0.45611 (QuantReg: 13.73675) QuantErr: 13.73675 batch_time=0.36799 
Train Epoch: 35 [931/1000 29792/32000 (93%)] Loss: 0.52352 (QuantReg: 12.73131) QuantErr: 12.73131 batch_time=0.47505 
Train Epoch: 35 [936/1000 29952/32000 (94%)] Loss: 0.54563 (QuantReg: 12.02049) QuantErr: 12.02049 batch_time=0.40285 
Train Epoch: 35 [941/1000 30112/32000 (94%)] Loss: 0.43494 (QuantReg: 12.34366) QuantErr: 12.34366 batch_time=0.48763 
Train Epoch: 35 [946/1000 30272/32000 (95%)] Loss: 0.09795 (QuantReg: 13.78292) QuantErr: 13.78292 batch_time=0.42605 
Train Epoch: 35 [951/1000 30432/32000 (95%)] Loss: 0.44065 (QuantReg: 13.06864) QuantErr: 13.06864 batch_time=0.51133 
Train Epoch: 35 [956/1000 30592/32000 (96%)] Loss: 0.34646 (QuantReg: 13.15694) QuantErr: 13.15694 batch_time=0.40791 
Train Epoch: 35 [961/1000 30752/32000 (96%)] Loss: 0.08184 (QuantReg: 12.57469) QuantErr: 12.57469 batch_time=0.45752 
Train Epoch: 35 [966/1000 30912/32000 (97%)] Loss: 0.10398 (QuantReg: 12.87891) QuantErr: 12.87891 batch_time=0.35544 
Train Epoch: 35 [971/1000 31072/32000 (97%)] Loss: 0.52981 (QuantReg: 12.94439) QuantErr: 12.94439 batch_time=0.42849 
Train Epoch: 35 [976/1000 31232/32000 (98%)] Loss: 0.46262 (QuantReg: 13.54399) QuantErr: 13.54399 batch_time=0.36064 
Train Epoch: 35 [981/1000 31392/32000 (98%)] Loss: 0.16659 (QuantReg: 13.13106) QuantErr: 13.13106 batch_time=0.45444 
Train Epoch: 35 [986/1000 31552/32000 (99%)] Loss: 0.42526 (QuantReg: 12.81065) QuantErr: 12.81065 batch_time=0.42618 
Train Epoch: 35 [991/1000 31712/32000 (99%)] Loss: 0.53037 (QuantReg: 12.60356) QuantErr: 12.60356 batch_time=0.37236 
Train Epoch: 35 [996/1000 31872/32000 (100%)] Loss: 0.13868 (QuantReg: 13.39069) QuantErr: 13.39069 batch_time=1.17172 
Train Epoch: 35 codebook_update_time=1.98931
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch35.pth ...
Done in 4.486s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 0.35512885669618843
 quant_reg      : 13.015797307014465
 quant_err      : 13.015797307014465
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 35000
 MSRVTT_miech_test/t2v_metrics/R1: 20.2
 MSRVTT_miech_test/t2v_metrics/R5: 49.4
 MSRVTT_miech_test/t2v_metrics/R10: 63.5
 MSRVTT_miech_test/t2v_metrics/R50: 88.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.102
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.86734807295087
 MSRVTT_miech_test/v2t_metrics/R1: 20.2
 MSRVTT_miech_test/v2t_metrics/R5: 50.7
 MSRVTT_miech_test/v2t_metrics/R10: 64.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.693
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.44491703907333
 mnt_best       : 41.036608587691525
 not_improved_count: 1
Train Epoch: 36 [1/1000 32/32000 (0%)] Loss: 0.47016 (QuantReg: 12.96181) QuantErr: 12.96181 batch_time=29.97180 
Train Epoch: 36 [6/1000 192/32000 (1%)] Loss: 0.16150 (QuantReg: 13.58959) QuantErr: 13.58959 batch_time=0.47332 
Train Epoch: 36 [11/1000 352/32000 (1%)] Loss: 0.34118 (QuantReg: 13.24075) QuantErr: 13.24075 batch_time=0.42399 
Train Epoch: 36 [16/1000 512/32000 (2%)] Loss: 0.09762 (QuantReg: 13.05394) QuantErr: 13.05394 batch_time=1.05143 
Train Epoch: 36 [21/1000 672/32000 (2%)] Loss: 0.16506 (QuantReg: 13.38728) QuantErr: 13.38728 batch_time=0.45042 
Train Epoch: 36 [26/1000 832/32000 (3%)] Loss: 0.24537 (QuantReg: 13.26189) QuantErr: 13.26189 batch_time=0.38003 
Train Epoch: 36 [31/1000 992/32000 (3%)] Loss: 0.10689 (QuantReg: 13.24406) QuantErr: 13.24406 batch_time=0.34222 
Train Epoch: 36 [36/1000 1152/32000 (4%)] Loss: 0.34645 (QuantReg: 13.08378) QuantErr: 13.08378 batch_time=0.64153 
Train Epoch: 36 [41/1000 1312/32000 (4%)] Loss: 0.14672 (QuantReg: 12.57907) QuantErr: 12.57907 batch_time=0.34951 
Train Epoch: 36 [46/1000 1472/32000 (5%)] Loss: 0.43677 (QuantReg: 13.29945) QuantErr: 13.29945 batch_time=0.37190 
Train Epoch: 36 [51/1000 1632/32000 (5%)] Loss: 0.29500 (QuantReg: 13.20588) QuantErr: 13.20588 batch_time=0.65316 
Train Epoch: 36 [56/1000 1792/32000 (6%)] Loss: 0.18486 (QuantReg: 13.54269) QuantErr: 13.54269 batch_time=0.43915 
Train Epoch: 36 [61/1000 1952/32000 (6%)] Loss: 0.15666 (QuantReg: 12.95977) QuantErr: 12.95977 batch_time=0.38709 
Train Epoch: 36 [66/1000 2112/32000 (7%)] Loss: 0.27912 (QuantReg: 12.78835) QuantErr: 12.78835 batch_time=0.44263 
Train Epoch: 36 [71/1000 2272/32000 (7%)] Loss: 0.27324 (QuantReg: 13.41679) QuantErr: 13.41679 batch_time=0.44710 
Train Epoch: 36 [76/1000 2432/32000 (8%)] Loss: 0.27416 (QuantReg: 13.52750) QuantErr: 13.52750 batch_time=0.34489 
Train Epoch: 36 [81/1000 2592/32000 (8%)] Loss: 0.16938 (QuantReg: 13.65566) QuantErr: 13.65566 batch_time=0.35529 
Train Epoch: 36 [86/1000 2752/32000 (9%)] Loss: 0.33856 (QuantReg: 13.22571) QuantErr: 13.22571 batch_time=0.68910 
Train Epoch: 36 [91/1000 2912/32000 (9%)] Loss: 0.22408 (QuantReg: 12.78112) QuantErr: 12.78112 batch_time=0.34806 
Train Epoch: 36 [96/1000 3072/32000 (10%)] Loss: 0.54494 (QuantReg: 13.09803) QuantErr: 13.09803 batch_time=0.37568 
Train Epoch: 36 [101/1000 3232/32000 (10%)] Loss: 0.35613 (QuantReg: 12.85247) QuantErr: 12.85247 batch_time=0.36159 
Train Epoch: 36 [106/1000 3392/32000 (11%)] Loss: 0.34485 (QuantReg: 13.50585) QuantErr: 13.50585 batch_time=0.34899 
Train Epoch: 36 [111/1000 3552/32000 (11%)] Loss: 0.46062 (QuantReg: 13.19426) QuantErr: 13.19426 batch_time=0.35296 
Train Epoch: 36 [116/1000 3712/32000 (12%)] Loss: 0.24629 (QuantReg: 13.04770) QuantErr: 13.04770 batch_time=0.43377 
Train Epoch: 36 [121/1000 3872/32000 (12%)] Loss: 0.34612 (QuantReg: 12.77331) QuantErr: 12.77331 batch_time=0.36913 
Train Epoch: 36 [126/1000 4032/32000 (13%)] Loss: 0.20474 (QuantReg: 12.88509) QuantErr: 12.88509 batch_time=0.41718 
Train Epoch: 36 [131/1000 4192/32000 (13%)] Loss: 0.11904 (QuantReg: 12.96833) QuantErr: 12.96833 batch_time=0.33537 
Train Epoch: 36 [136/1000 4352/32000 (14%)] Loss: 0.46453 (QuantReg: 13.33531) QuantErr: 13.33531 batch_time=0.71825 
Train Epoch: 36 [141/1000 4512/32000 (14%)] Loss: 0.27924 (QuantReg: 13.20415) QuantErr: 13.20415 batch_time=0.37592 
Train Epoch: 36 [146/1000 4672/32000 (15%)] Loss: 0.46548 (QuantReg: 13.01610) QuantErr: 13.01610 batch_time=0.33880 
Train Epoch: 36 [151/1000 4832/32000 (15%)] Loss: 0.32162 (QuantReg: 13.16059) QuantErr: 13.16059 batch_time=0.41475 
Train Epoch: 36 [156/1000 4992/32000 (16%)] Loss: 0.49937 (QuantReg: 13.47989) QuantErr: 13.47989 batch_time=1.16514 
Train Epoch: 36 [161/1000 5152/32000 (16%)] Loss: 0.39095 (QuantReg: 13.29172) QuantErr: 13.29172 batch_time=0.36047 
Train Epoch: 36 [166/1000 5312/32000 (17%)] Loss: 0.31822 (QuantReg: 13.53747) QuantErr: 13.53747 batch_time=0.33792 
Train Epoch: 36 [171/1000 5472/32000 (17%)] Loss: 0.23586 (QuantReg: 13.03183) QuantErr: 13.03183 batch_time=0.39084 
Train Epoch: 36 [176/1000 5632/32000 (18%)] Loss: 0.13523 (QuantReg: 13.24511) QuantErr: 13.24511 batch_time=0.38250 
Train Epoch: 36 [181/1000 5792/32000 (18%)] Loss: 0.35321 (QuantReg: 12.55366) QuantErr: 12.55366 batch_time=0.33535 
Train Epoch: 36 [186/1000 5952/32000 (19%)] Loss: 0.72601 (QuantReg: 13.04418) QuantErr: 13.04418 batch_time=0.68791 
Train Epoch: 36 [191/1000 6112/32000 (19%)] Loss: 0.18660 (QuantReg: 13.28818) QuantErr: 13.28818 batch_time=0.35757 
Train Epoch: 36 [196/1000 6272/32000 (20%)] Loss: 0.31708 (QuantReg: 12.91188) QuantErr: 12.91188 batch_time=0.41123 
Train Epoch: 36 [201/1000 6432/32000 (20%)] Loss: 0.17450 (QuantReg: 13.47868) QuantErr: 13.47868 batch_time=0.34341 
Train Epoch: 36 [206/1000 6592/32000 (21%)] Loss: 0.17564 (QuantReg: 13.05075) QuantErr: 13.05075 batch_time=0.35549 
Train Epoch: 36 [211/1000 6752/32000 (21%)] Loss: 0.20684 (QuantReg: 13.30802) QuantErr: 13.30802 batch_time=0.36214 
Train Epoch: 36 [216/1000 6912/32000 (22%)] Loss: 0.20614 (QuantReg: 13.29351) QuantErr: 13.29351 batch_time=0.35224 
Train Epoch: 36 [221/1000 7072/32000 (22%)] Loss: 0.33560 (QuantReg: 13.45330) QuantErr: 13.45330 batch_time=0.35106 
Train Epoch: 36 [226/1000 7232/32000 (23%)] Loss: 0.45902 (QuantReg: 13.57088) QuantErr: 13.57088 batch_time=0.66847 
Train Epoch: 36 [231/1000 7392/32000 (23%)] Loss: 0.62091 (QuantReg: 12.78494) QuantErr: 12.78494 batch_time=0.35320 
Train Epoch: 36 [236/1000 7552/32000 (24%)] Loss: 0.12995 (QuantReg: 13.28742) QuantErr: 13.28742 batch_time=0.77265 
Train Epoch: 36 [241/1000 7712/32000 (24%)] Loss: 0.51087 (QuantReg: 12.29733) QuantErr: 12.29733 batch_time=0.48084 
Train Epoch: 36 [246/1000 7872/32000 (25%)] Loss: 0.59405 (QuantReg: 13.06112) QuantErr: 13.06112 batch_time=0.39728 
Train Epoch: 36 [251/1000 8032/32000 (25%)] Loss: 0.29597 (QuantReg: 13.48432) QuantErr: 13.48432 batch_time=0.40827 
Train Epoch: 36 [256/1000 8192/32000 (26%)] Loss: 0.26911 (QuantReg: 13.01983) QuantErr: 13.01983 batch_time=0.41642 
Train Epoch: 36 [261/1000 8352/32000 (26%)] Loss: 0.59248 (QuantReg: 13.01470) QuantErr: 13.01470 batch_time=0.37831 
Train Epoch: 36 [266/1000 8512/32000 (27%)] Loss: 0.44716 (QuantReg: 13.19888) QuantErr: 13.19888 batch_time=0.45148 
Train Epoch: 36 [271/1000 8672/32000 (27%)] Loss: 0.28203 (QuantReg: 13.20802) QuantErr: 13.20802 batch_time=0.37284 
Train Epoch: 36 [276/1000 8832/32000 (28%)] Loss: 0.48011 (QuantReg: 12.74117) QuantErr: 12.74117 batch_time=0.60363 
Train Epoch: 36 [281/1000 8992/32000 (28%)] Loss: 0.43887 (QuantReg: 12.60492) QuantErr: 12.60492 batch_time=0.33136 
Train Epoch: 36 [286/1000 9152/32000 (29%)] Loss: 0.63963 (QuantReg: 13.05454) QuantErr: 13.05454 batch_time=0.56917 
Train Epoch: 36 [291/1000 9312/32000 (29%)] Loss: 0.37798 (QuantReg: 13.14428) QuantErr: 13.14428 batch_time=0.42897 
Train Epoch: 36 [296/1000 9472/32000 (30%)] Loss: 0.50604 (QuantReg: 12.74499) QuantErr: 12.74499 batch_time=0.35263 
Train Epoch: 36 [301/1000 9632/32000 (30%)] Loss: 0.79371 (QuantReg: 12.84652) QuantErr: 12.84652 batch_time=0.44561 
Train Epoch: 36 [306/1000 9792/32000 (31%)] Loss: 0.38617 (QuantReg: 13.24423) QuantErr: 13.24423 batch_time=0.72289 
Train Epoch: 36 [311/1000 9952/32000 (31%)] Loss: 0.31432 (QuantReg: 13.61976) QuantErr: 13.61976 batch_time=0.35072 
Train Epoch: 36 [316/1000 10112/32000 (32%)] Loss: 0.19458 (QuantReg: 12.96776) QuantErr: 12.96776 batch_time=0.45847 
Train Epoch: 36 [321/1000 10272/32000 (32%)] Loss: 0.53110 (QuantReg: 13.29826) QuantErr: 13.29826 batch_time=0.51468 
Train Epoch: 36 [326/1000 10432/32000 (33%)] Loss: 0.16604 (QuantReg: 12.41616) QuantErr: 12.41616 batch_time=0.33575 
Train Epoch: 36 [331/1000 10592/32000 (33%)] Loss: 0.20839 (QuantReg: 13.29629) QuantErr: 13.29629 batch_time=0.77193 
Train Epoch: 36 [336/1000 10752/32000 (34%)] Loss: 0.27164 (QuantReg: 12.87635) QuantErr: 12.87635 batch_time=0.37704 
Train Epoch: 36 [341/1000 10912/32000 (34%)] Loss: 0.24126 (QuantReg: 13.25750) QuantErr: 13.25750 batch_time=0.55032 
Train Epoch: 36 [346/1000 11072/32000 (35%)] Loss: 0.49709 (QuantReg: 12.78072) QuantErr: 12.78072 batch_time=0.42126 
Train Epoch: 36 [351/1000 11232/32000 (35%)] Loss: 0.19758 (QuantReg: 12.07435) QuantErr: 12.07435 batch_time=0.35048 
Train Epoch: 36 [356/1000 11392/32000 (36%)] Loss: 0.09449 (QuantReg: 13.15704) QuantErr: 13.15704 batch_time=0.35665 
Train Epoch: 36 [361/1000 11552/32000 (36%)] Loss: 0.44968 (QuantReg: 12.41772) QuantErr: 12.41772 batch_time=0.46367 
Train Epoch: 36 [366/1000 11712/32000 (37%)] Loss: 0.38316 (QuantReg: 13.09553) QuantErr: 13.09553 batch_time=1.66108 
Train Epoch: 36 [371/1000 11872/32000 (37%)] Loss: 0.61095 (QuantReg: 13.52438) QuantErr: 13.52438 batch_time=0.45917 
Train Epoch: 36 [376/1000 12032/32000 (38%)] Loss: 0.45743 (QuantReg: 13.00525) QuantErr: 13.00525 batch_time=0.36361 
Train Epoch: 36 [381/1000 12192/32000 (38%)] Loss: 0.54137 (QuantReg: 13.32175) QuantErr: 13.32175 batch_time=0.46422 
Train Epoch: 36 [386/1000 12352/32000 (39%)] Loss: 0.38431 (QuantReg: 13.05934) QuantErr: 13.05934 batch_time=0.34900 
Train Epoch: 36 [391/1000 12512/32000 (39%)] Loss: 0.16489 (QuantReg: 12.34282) QuantErr: 12.34282 batch_time=0.39122 
Train Epoch: 36 [396/1000 12672/32000 (40%)] Loss: 0.37709 (QuantReg: 13.00223) QuantErr: 13.00223 batch_time=0.35714 
Train Epoch: 36 [401/1000 12832/32000 (40%)] Loss: 0.14047 (QuantReg: 12.79777) QuantErr: 12.79777 batch_time=0.37305 
Train Epoch: 36 [406/1000 12992/32000 (41%)] Loss: 0.36714 (QuantReg: 12.84315) QuantErr: 12.84315 batch_time=0.45845 
Train Epoch: 36 [411/1000 13152/32000 (41%)] Loss: 0.30644 (QuantReg: 13.04631) QuantErr: 13.04631 batch_time=0.39446 
Train Epoch: 36 [416/1000 13312/32000 (42%)] Loss: 0.44401 (QuantReg: 13.09375) QuantErr: 13.09375 batch_time=0.44887 
Train Epoch: 36 [421/1000 13472/32000 (42%)] Loss: 0.24539 (QuantReg: 12.91135) QuantErr: 12.91135 batch_time=0.41123 
Train Epoch: 36 [426/1000 13632/32000 (43%)] Loss: 0.41512 (QuantReg: 13.22837) QuantErr: 13.22837 batch_time=0.34664 
Train Epoch: 36 [431/1000 13792/32000 (43%)] Loss: 0.23797 (QuantReg: 12.61313) QuantErr: 12.61313 batch_time=0.43647 
Train Epoch: 36 [436/1000 13952/32000 (44%)] Loss: 0.29981 (QuantReg: 13.21950) QuantErr: 13.21950 batch_time=0.52667 
Train Epoch: 36 [441/1000 14112/32000 (44%)] Loss: 0.73635 (QuantReg: 13.57830) QuantErr: 13.57830 batch_time=0.36296 
Train Epoch: 36 [446/1000 14272/32000 (45%)] Loss: 0.16872 (QuantReg: 13.14128) QuantErr: 13.14128 batch_time=0.36926 
Train Epoch: 36 [451/1000 14432/32000 (45%)] Loss: 0.09101 (QuantReg: 12.77428) QuantErr: 12.77428 batch_time=0.35147 
Train Epoch: 36 [456/1000 14592/32000 (46%)] Loss: 0.42651 (QuantReg: 12.63683) QuantErr: 12.63683 batch_time=0.38945 
Train Epoch: 36 [461/1000 14752/32000 (46%)] Loss: 0.58705 (QuantReg: 11.97425) QuantErr: 11.97425 batch_time=0.50940 
Train Epoch: 36 [466/1000 14912/32000 (47%)] Loss: 0.38636 (QuantReg: 12.81825) QuantErr: 12.81825 batch_time=0.40257 
Train Epoch: 36 [471/1000 15072/32000 (47%)] Loss: 0.23129 (QuantReg: 12.68228) QuantErr: 12.68228 batch_time=0.34458 
Train Epoch: 36 [476/1000 15232/32000 (48%)] Loss: 0.38260 (QuantReg: 13.43891) QuantErr: 13.43891 batch_time=0.76844 
Train Epoch: 36 [481/1000 15392/32000 (48%)] Loss: 0.25281 (QuantReg: 13.31476) QuantErr: 13.31476 batch_time=0.35490 
Train Epoch: 36 [486/1000 15552/32000 (49%)] Loss: 0.17585 (QuantReg: 12.94623) QuantErr: 12.94623 batch_time=0.36915 
Train Epoch: 36 [491/1000 15712/32000 (49%)] Loss: 0.35061 (QuantReg: 13.02074) QuantErr: 13.02074 batch_time=0.36474 
Train Epoch: 36 [496/1000 15872/32000 (50%)] Loss: 0.42422 (QuantReg: 13.27040) QuantErr: 13.27040 batch_time=0.40037 
Train Epoch: 36 [501/1000 16032/32000 (50%)] Loss: 0.26630 (QuantReg: 13.61422) QuantErr: 13.61422 batch_time=0.40530 
Train Epoch: 36 [506/1000 16192/32000 (51%)] Loss: 0.48320 (QuantReg: 13.70543) QuantErr: 13.70543 batch_time=0.35864 
Train Epoch: 36 [511/1000 16352/32000 (51%)] Loss: 0.20192 (QuantReg: 13.12287) QuantErr: 13.12287 batch_time=0.36150 
Train Epoch: 36 [516/1000 16512/32000 (52%)] Loss: 0.31014 (QuantReg: 13.39163) QuantErr: 13.39163 batch_time=0.70592 
Train Epoch: 36 [521/1000 16672/32000 (52%)] Loss: 0.09115 (QuantReg: 13.35546) QuantErr: 13.35546 batch_time=0.40906 
Train Epoch: 36 [526/1000 16832/32000 (53%)] Loss: 0.14499 (QuantReg: 12.86348) QuantErr: 12.86348 batch_time=2.22709 
Train Epoch: 36 [531/1000 16992/32000 (53%)] Loss: 0.42574 (QuantReg: 13.40394) QuantErr: 13.40394 batch_time=0.39634 
Train Epoch: 36 [536/1000 17152/32000 (54%)] Loss: 0.39296 (QuantReg: 12.70224) QuantErr: 12.70224 batch_time=0.55391 
Train Epoch: 36 [541/1000 17312/32000 (54%)] Loss: 0.36798 (QuantReg: 12.88827) QuantErr: 12.88827 batch_time=0.36183 
Train Epoch: 36 [546/1000 17472/32000 (55%)] Loss: 0.13468 (QuantReg: 13.04503) QuantErr: 13.04503 batch_time=0.46942 
Train Epoch: 36 [551/1000 17632/32000 (55%)] Loss: 0.25623 (QuantReg: 13.29730) QuantErr: 13.29730 batch_time=0.35520 
Train Epoch: 36 [556/1000 17792/32000 (56%)] Loss: 0.06998 (QuantReg: 13.42460) QuantErr: 13.42460 batch_time=0.36377 
Train Epoch: 36 [561/1000 17952/32000 (56%)] Loss: 0.37736 (QuantReg: 13.04440) QuantErr: 13.04440 batch_time=0.40059 
Train Epoch: 36 [566/1000 18112/32000 (57%)] Loss: 0.15863 (QuantReg: 13.03883) QuantErr: 13.03883 batch_time=0.38933 
Train Epoch: 36 [571/1000 18272/32000 (57%)] Loss: 0.34982 (QuantReg: 12.27895) QuantErr: 12.27895 batch_time=1.32491 
Train Epoch: 36 [576/1000 18432/32000 (58%)] Loss: 0.42259 (QuantReg: 13.29656) QuantErr: 13.29656 batch_time=0.56481 
Train Epoch: 36 [581/1000 18592/32000 (58%)] Loss: 0.63422 (QuantReg: 12.87850) QuantErr: 12.87850 batch_time=0.42833 
Train Epoch: 36 [586/1000 18752/32000 (59%)] Loss: 0.16792 (QuantReg: 13.30697) QuantErr: 13.30697 batch_time=0.42249 
Train Epoch: 36 [591/1000 18912/32000 (59%)] Loss: 0.28368 (QuantReg: 12.66710) QuantErr: 12.66710 batch_time=0.37819 
Train Epoch: 36 [596/1000 19072/32000 (60%)] Loss: 0.23507 (QuantReg: 13.43168) QuantErr: 13.43168 batch_time=0.44151 
Train Epoch: 36 [601/1000 19232/32000 (60%)] Loss: 0.30778 (QuantReg: 12.52383) QuantErr: 12.52383 batch_time=0.47205 
Train Epoch: 36 [606/1000 19392/32000 (61%)] Loss: 0.11177 (QuantReg: 13.55241) QuantErr: 13.55241 batch_time=0.35287 
Train Epoch: 36 [611/1000 19552/32000 (61%)] Loss: 0.21498 (QuantReg: 12.71511) QuantErr: 12.71511 batch_time=0.37841 
Train Epoch: 36 [616/1000 19712/32000 (62%)] Loss: 0.14908 (QuantReg: 12.65520) QuantErr: 12.65520 batch_time=0.42288 
Train Epoch: 36 [621/1000 19872/32000 (62%)] Loss: 0.39784 (QuantReg: 12.98308) QuantErr: 12.98308 batch_time=0.34792 
Train Epoch: 36 [626/1000 20032/32000 (63%)] Loss: 0.21657 (QuantReg: 12.91432) QuantErr: 12.91432 batch_time=0.33126 
Train Epoch: 36 [631/1000 20192/32000 (63%)] Loss: 0.43550 (QuantReg: 12.95621) QuantErr: 12.95621 batch_time=0.48746 
Train Epoch: 36 [636/1000 20352/32000 (64%)] Loss: 0.60616 (QuantReg: 13.28935) QuantErr: 13.28935 batch_time=0.38189 
Train Epoch: 36 [641/1000 20512/32000 (64%)] Loss: 0.38707 (QuantReg: 14.00298) QuantErr: 14.00298 batch_time=0.40718 
Train Epoch: 36 [646/1000 20672/32000 (65%)] Loss: 0.39009 (QuantReg: 12.70670) QuantErr: 12.70670 batch_time=0.34681 
Train Epoch: 36 [651/1000 20832/32000 (65%)] Loss: 0.14262 (QuantReg: 13.45957) QuantErr: 13.45957 batch_time=0.39211 
Train Epoch: 36 [656/1000 20992/32000 (66%)] Loss: 0.17687 (QuantReg: 12.84977) QuantErr: 12.84977 batch_time=0.36003 
Train Epoch: 36 [661/1000 21152/32000 (66%)] Loss: 0.53876 (QuantReg: 12.49038) QuantErr: 12.49038 batch_time=0.54199 
Train Epoch: 36 [666/1000 21312/32000 (67%)] Loss: 0.23518 (QuantReg: 13.16695) QuantErr: 13.16695 batch_time=0.34331 
Train Epoch: 36 [671/1000 21472/32000 (67%)] Loss: 0.20279 (QuantReg: 13.20052) QuantErr: 13.20052 batch_time=0.70181 
Train Epoch: 36 [676/1000 21632/32000 (68%)] Loss: 0.24448 (QuantReg: 13.43450) QuantErr: 13.43450 batch_time=0.34332 
Train Epoch: 36 [681/1000 21792/32000 (68%)] Loss: 0.38207 (QuantReg: 13.28236) QuantErr: 13.28236 batch_time=0.35482 
Train Epoch: 36 [686/1000 21952/32000 (69%)] Loss: 0.22601 (QuantReg: 13.53016) QuantErr: 13.53016 batch_time=0.57205 
Train Epoch: 36 [691/1000 22112/32000 (69%)] Loss: 0.25040 (QuantReg: 13.24737) QuantErr: 13.24737 batch_time=0.34582 
Train Epoch: 36 [696/1000 22272/32000 (70%)] Loss: 0.50169 (QuantReg: 13.25652) QuantErr: 13.25652 batch_time=0.38651 
Train Epoch: 36 [701/1000 22432/32000 (70%)] Loss: 0.20312 (QuantReg: 13.24228) QuantErr: 13.24228 batch_time=0.34113 
Train Epoch: 36 [706/1000 22592/32000 (71%)] Loss: 0.47053 (QuantReg: 13.37068) QuantErr: 13.37068 batch_time=0.43056 
Train Epoch: 36 [711/1000 22752/32000 (71%)] Loss: 0.85616 (QuantReg: 12.92383) QuantErr: 12.92383 batch_time=0.40789 
Train Epoch: 36 [716/1000 22912/32000 (72%)] Loss: 0.64674 (QuantReg: 12.65557) QuantErr: 12.65557 batch_time=0.34149 
Train Epoch: 36 [721/1000 23072/32000 (72%)] Loss: 0.41652 (QuantReg: 12.94763) QuantErr: 12.94763 batch_time=0.33536 
Train Epoch: 36 [726/1000 23232/32000 (73%)] Loss: 0.43091 (QuantReg: 13.23482) QuantErr: 13.23482 batch_time=0.36013 
Train Epoch: 36 [731/1000 23392/32000 (73%)] Loss: 0.31896 (QuantReg: 13.36640) QuantErr: 13.36640 batch_time=0.36187 
Train Epoch: 36 [736/1000 23552/32000 (74%)] Loss: 0.56692 (QuantReg: 13.33088) QuantErr: 13.33088 batch_time=0.39382 
Train Epoch: 36 [741/1000 23712/32000 (74%)] Loss: 0.24733 (QuantReg: 13.21292) QuantErr: 13.21292 batch_time=0.38692 
Train Epoch: 36 [746/1000 23872/32000 (75%)] Loss: 0.44085 (QuantReg: 12.97231) QuantErr: 12.97231 batch_time=0.37471 
Train Epoch: 36 [751/1000 24032/32000 (75%)] Loss: 0.13216 (QuantReg: 13.19843) QuantErr: 13.19843 batch_time=0.35067 
Train Epoch: 36 [756/1000 24192/32000 (76%)] Loss: 0.16632 (QuantReg: 13.59416) QuantErr: 13.59416 batch_time=0.37179 
Train Epoch: 36 [761/1000 24352/32000 (76%)] Loss: 0.40853 (QuantReg: 12.84603) QuantErr: 12.84603 batch_time=0.72690 
Train Epoch: 36 [766/1000 24512/32000 (77%)] Loss: 0.21285 (QuantReg: 13.52157) QuantErr: 13.52157 batch_time=0.56400 
Train Epoch: 36 [771/1000 24672/32000 (77%)] Loss: 0.48432 (QuantReg: 12.68679) QuantErr: 12.68679 batch_time=0.36952 
Train Epoch: 36 [776/1000 24832/32000 (78%)] Loss: 0.19572 (QuantReg: 13.25616) QuantErr: 13.25616 batch_time=0.40892 
Train Epoch: 36 [781/1000 24992/32000 (78%)] Loss: 0.17635 (QuantReg: 13.56969) QuantErr: 13.56969 batch_time=0.34549 
Train Epoch: 36 [786/1000 25152/32000 (79%)] Loss: 0.23633 (QuantReg: 13.60750) QuantErr: 13.60750 batch_time=0.34277 
Train Epoch: 36 [791/1000 25312/32000 (79%)] Loss: 0.32985 (QuantReg: 13.18307) QuantErr: 13.18307 batch_time=0.33957 
Train Epoch: 36 [796/1000 25472/32000 (80%)] Loss: 0.79787 (QuantReg: 13.14378) QuantErr: 13.14378 batch_time=0.37763 
Train Epoch: 36 [801/1000 25632/32000 (80%)] Loss: 0.12772 (QuantReg: 13.12607) QuantErr: 13.12607 batch_time=0.35248 
Train Epoch: 36 [806/1000 25792/32000 (81%)] Loss: 0.47090 (QuantReg: 12.12331) QuantErr: 12.12331 batch_time=0.51782 
Train Epoch: 36 [811/1000 25952/32000 (81%)] Loss: 0.20750 (QuantReg: 13.45627) QuantErr: 13.45627 batch_time=0.34394 
Train Epoch: 36 [816/1000 26112/32000 (82%)] Loss: 0.30973 (QuantReg: 12.76809) QuantErr: 12.76809 batch_time=0.63879 
Train Epoch: 36 [821/1000 26272/32000 (82%)] Loss: 0.29028 (QuantReg: 12.60172) QuantErr: 12.60172 batch_time=0.39375 
Train Epoch: 36 [826/1000 26432/32000 (83%)] Loss: 0.31602 (QuantReg: 13.22038) QuantErr: 13.22038 batch_time=0.42041 
Train Epoch: 36 [831/1000 26592/32000 (83%)] Loss: 0.27319 (QuantReg: 12.86187) QuantErr: 12.86187 batch_time=0.37217 
Train Epoch: 36 [836/1000 26752/32000 (84%)] Loss: 0.34947 (QuantReg: 12.80283) QuantErr: 12.80283 batch_time=0.35684 
Train Epoch: 36 [841/1000 26912/32000 (84%)] Loss: 0.17174 (QuantReg: 13.22965) QuantErr: 13.22965 batch_time=0.39397 
Train Epoch: 36 [846/1000 27072/32000 (85%)] Loss: 0.13278 (QuantReg: 12.88897) QuantErr: 12.88897 batch_time=2.64761 
Train Epoch: 36 [851/1000 27232/32000 (85%)] Loss: 0.31881 (QuantReg: 13.42700) QuantErr: 13.42700 batch_time=0.35330 
Train Epoch: 36 [856/1000 27392/32000 (86%)] Loss: 0.36271 (QuantReg: 12.93195) QuantErr: 12.93195 batch_time=0.37308 
Train Epoch: 36 [861/1000 27552/32000 (86%)] Loss: 0.56378 (QuantReg: 12.79523) QuantErr: 12.79523 batch_time=0.57811 
Train Epoch: 36 [866/1000 27712/32000 (87%)] Loss: 0.40484 (QuantReg: 13.34841) QuantErr: 13.34841 batch_time=0.43156 
Train Epoch: 36 [871/1000 27872/32000 (87%)] Loss: 0.14421 (QuantReg: 12.57916) QuantErr: 12.57916 batch_time=0.35078 
Train Epoch: 36 [876/1000 28032/32000 (88%)] Loss: 0.41992 (QuantReg: 13.39568) QuantErr: 13.39568 batch_time=0.46415 
Train Epoch: 36 [881/1000 28192/32000 (88%)] Loss: 0.26876 (QuantReg: 12.79414) QuantErr: 12.79414 batch_time=1.13819 
Train Epoch: 36 [886/1000 28352/32000 (89%)] Loss: 0.54016 (QuantReg: 13.35332) QuantErr: 13.35332 batch_time=0.42466 
Train Epoch: 36 [891/1000 28512/32000 (89%)] Loss: 0.72369 (QuantReg: 12.56363) QuantErr: 12.56363 batch_time=0.40945 
Train Epoch: 36 [896/1000 28672/32000 (90%)] Loss: 0.10955 (QuantReg: 13.31974) QuantErr: 13.31974 batch_time=0.41346 
Train Epoch: 36 [901/1000 28832/32000 (90%)] Loss: 0.34962 (QuantReg: 13.15385) QuantErr: 13.15385 batch_time=0.39934 
Train Epoch: 36 [906/1000 28992/32000 (91%)] Loss: 0.33228 (QuantReg: 12.88953) QuantErr: 12.88953 batch_time=0.35147 
Train Epoch: 36 [911/1000 29152/32000 (91%)] Loss: 0.44865 (QuantReg: 12.84221) QuantErr: 12.84221 batch_time=0.73675 
Train Epoch: 36 [916/1000 29312/32000 (92%)] Loss: 0.49375 (QuantReg: 13.68711) QuantErr: 13.68711 batch_time=0.53613 
Train Epoch: 36 [921/1000 29472/32000 (92%)] Loss: 0.22614 (QuantReg: 12.71366) QuantErr: 12.71366 batch_time=0.49455 
Train Epoch: 36 [926/1000 29632/32000 (93%)] Loss: 0.42974 (QuantReg: 13.64719) QuantErr: 13.64719 batch_time=0.38464 
Train Epoch: 36 [931/1000 29792/32000 (93%)] Loss: 0.45011 (QuantReg: 13.07877) QuantErr: 13.07877 batch_time=0.34923 
Train Epoch: 36 [936/1000 29952/32000 (94%)] Loss: 0.34647 (QuantReg: 13.26847) QuantErr: 13.26847 batch_time=0.35002 
Train Epoch: 36 [941/1000 30112/32000 (94%)] Loss: 0.14753 (QuantReg: 13.14359) QuantErr: 13.14359 batch_time=0.34752 
Train Epoch: 36 [946/1000 30272/32000 (95%)] Loss: 0.45276 (QuantReg: 12.70523) QuantErr: 12.70523 batch_time=0.38989 
Train Epoch: 36 [951/1000 30432/32000 (95%)] Loss: 0.30892 (QuantReg: 12.78757) QuantErr: 12.78757 batch_time=0.40434 
Train Epoch: 36 [956/1000 30592/32000 (96%)] Loss: 0.25124 (QuantReg: 13.20611) QuantErr: 13.20611 batch_time=0.39919 
Train Epoch: 36 [961/1000 30752/32000 (96%)] Loss: 0.16858 (QuantReg: 13.47044) QuantErr: 13.47044 batch_time=0.51319 
Train Epoch: 36 [966/1000 30912/32000 (97%)] Loss: 0.16748 (QuantReg: 13.44052) QuantErr: 13.44052 batch_time=0.38237 
Train Epoch: 36 [971/1000 31072/32000 (97%)] Loss: 0.56406 (QuantReg: 13.23112) QuantErr: 13.23112 batch_time=0.40052 
Train Epoch: 36 [976/1000 31232/32000 (98%)] Loss: 0.23271 (QuantReg: 13.37560) QuantErr: 13.37560 batch_time=0.44144 
Train Epoch: 36 [981/1000 31392/32000 (98%)] Loss: 0.30994 (QuantReg: 12.72501) QuantErr: 12.72501 batch_time=0.36780 
Train Epoch: 36 [986/1000 31552/32000 (99%)] Loss: 0.34102 (QuantReg: 13.59443) QuantErr: 13.59443 batch_time=0.34669 
Train Epoch: 36 [991/1000 31712/32000 (99%)] Loss: 0.34163 (QuantReg: 13.31668) QuantErr: 13.31668 batch_time=0.39708 
Train Epoch: 36 [996/1000 31872/32000 (100%)] Loss: 0.62615 (QuantReg: 12.88559) QuantErr: 12.88559 batch_time=0.35675 
Train Epoch: 36 codebook_update_time=2.14270
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch36.pth ...
Done in 4.697s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 0.3398080101832747
 quant_reg      : 13.06895890235901
 quant_err      : 13.06895890235901
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 36000
 MSRVTT_miech_test/t2v_metrics/R1: 21.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.2
 MSRVTT_miech_test/t2v_metrics/R10: 64.0
 MSRVTT_miech_test/t2v_metrics/R50: 88.0
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.249
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.944966813907016
 MSRVTT_miech_test/v2t_metrics/R1: 19.1
 MSRVTT_miech_test/v2t_metrics/R5: 51.4
 MSRVTT_miech_test/v2t_metrics/R10: 63.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.7
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.188
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.54689084971682
 mnt_best       : 41.036608587691525
 not_improved_count: 2
Train Epoch: 37 [1/1000 32/32000 (0%)] Loss: 0.42130 (QuantReg: 12.40769) QuantErr: 12.40769 batch_time=30.47483 
Train Epoch: 37 [6/1000 192/32000 (1%)] Loss: 0.52689 (QuantReg: 12.79150) QuantErr: 12.79150 batch_time=1.33201 
Train Epoch: 37 [11/1000 352/32000 (1%)] Loss: 0.29057 (QuantReg: 12.25857) QuantErr: 12.25857 batch_time=0.42010 
Train Epoch: 37 [16/1000 512/32000 (2%)] Loss: 0.34682 (QuantReg: 13.30532) QuantErr: 13.30532 batch_time=0.68744 
Train Epoch: 37 [21/1000 672/32000 (2%)] Loss: 0.11640 (QuantReg: 13.62007) QuantErr: 13.62007 batch_time=0.34699 
Train Epoch: 37 [26/1000 832/32000 (3%)] Loss: 0.52250 (QuantReg: 13.10244) QuantErr: 13.10244 batch_time=0.43775 
Train Epoch: 37 [31/1000 992/32000 (3%)] Loss: 0.42618 (QuantReg: 13.65502) QuantErr: 13.65502 batch_time=0.39169 
Train Epoch: 37 [36/1000 1152/32000 (4%)] Loss: 0.45327 (QuantReg: 13.55727) QuantErr: 13.55727 batch_time=0.35227 
Train Epoch: 37 [41/1000 1312/32000 (4%)] Loss: 0.86671 (QuantReg: 12.54562) QuantErr: 12.54562 batch_time=0.43644 
Train Epoch: 37 [46/1000 1472/32000 (5%)] Loss: 0.37888 (QuantReg: 12.80685) QuantErr: 12.80685 batch_time=0.34509 
Train Epoch: 37 [51/1000 1632/32000 (5%)] Loss: 0.18535 (QuantReg: 12.90741) QuantErr: 12.90741 batch_time=0.60309 
Train Epoch: 37 [56/1000 1792/32000 (6%)] Loss: 0.19052 (QuantReg: 12.90555) QuantErr: 12.90555 batch_time=0.36504 
Train Epoch: 37 [61/1000 1952/32000 (6%)] Loss: 0.30608 (QuantReg: 13.33669) QuantErr: 13.33669 batch_time=0.35295 
Train Epoch: 37 [66/1000 2112/32000 (7%)] Loss: 0.14815 (QuantReg: 12.88343) QuantErr: 12.88343 batch_time=0.48259 
Train Epoch: 37 [71/1000 2272/32000 (7%)] Loss: 0.33749 (QuantReg: 12.87373) QuantErr: 12.87373 batch_time=0.35688 
Train Epoch: 37 [76/1000 2432/32000 (8%)] Loss: 0.56472 (QuantReg: 12.65679) QuantErr: 12.65679 batch_time=0.46201 
Train Epoch: 37 [81/1000 2592/32000 (8%)] Loss: 0.42840 (QuantReg: 13.17171) QuantErr: 13.17171 batch_time=0.35693 
Train Epoch: 37 [86/1000 2752/32000 (9%)] Loss: 0.22190 (QuantReg: 12.69172) QuantErr: 12.69172 batch_time=2.22511 
Train Epoch: 37 [91/1000 2912/32000 (9%)] Loss: 0.20858 (QuantReg: 13.35419) QuantErr: 13.35419 batch_time=0.51378 
Train Epoch: 37 [96/1000 3072/32000 (10%)] Loss: 0.27502 (QuantReg: 12.94782) QuantErr: 12.94782 batch_time=0.36380 
Train Epoch: 37 [101/1000 3232/32000 (10%)] Loss: 0.65228 (QuantReg: 13.49820) QuantErr: 13.49820 batch_time=0.58436 
Train Epoch: 37 [106/1000 3392/32000 (11%)] Loss: 0.50688 (QuantReg: 13.15755) QuantErr: 13.15755 batch_time=0.32565 
Train Epoch: 37 [111/1000 3552/32000 (11%)] Loss: 0.54449 (QuantReg: 13.04807) QuantErr: 13.04807 batch_time=0.39948 
Train Epoch: 37 [116/1000 3712/32000 (12%)] Loss: 0.24906 (QuantReg: 12.67075) QuantErr: 12.67075 batch_time=0.44819 
Train Epoch: 37 [121/1000 3872/32000 (12%)] Loss: 0.32719 (QuantReg: 13.52797) QuantErr: 13.52797 batch_time=0.35069 
Train Epoch: 37 [126/1000 4032/32000 (13%)] Loss: 0.16330 (QuantReg: 13.81087) QuantErr: 13.81087 batch_time=0.40709 
Train Epoch: 37 [131/1000 4192/32000 (13%)] Loss: 0.17309 (QuantReg: 13.06625) QuantErr: 13.06625 batch_time=0.37275 
Train Epoch: 37 [136/1000 4352/32000 (14%)] Loss: 0.49122 (QuantReg: 13.07055) QuantErr: 13.07055 batch_time=0.33621 
Train Epoch: 37 [141/1000 4512/32000 (14%)] Loss: 0.23586 (QuantReg: 13.02933) QuantErr: 13.02933 batch_time=0.36055 
Train Epoch: 37 [146/1000 4672/32000 (15%)] Loss: 0.07737 (QuantReg: 13.77175) QuantErr: 13.77175 batch_time=0.47800 
Train Epoch: 37 [151/1000 4832/32000 (15%)] Loss: 0.17767 (QuantReg: 13.68363) QuantErr: 13.68363 batch_time=0.62630 
Train Epoch: 37 [156/1000 4992/32000 (16%)] Loss: 0.17644 (QuantReg: 12.97680) QuantErr: 12.97680 batch_time=0.42620 
Train Epoch: 37 [161/1000 5152/32000 (16%)] Loss: 0.39251 (QuantReg: 13.04355) QuantErr: 13.04355 batch_time=0.39148 
Train Epoch: 37 [166/1000 5312/32000 (17%)] Loss: 0.50499 (QuantReg: 12.63546) QuantErr: 12.63546 batch_time=0.39730 
Train Epoch: 37 [171/1000 5472/32000 (17%)] Loss: 0.48158 (QuantReg: 12.49716) QuantErr: 12.49716 batch_time=0.35072 
Train Epoch: 37 [176/1000 5632/32000 (18%)] Loss: 0.29704 (QuantReg: 12.94256) QuantErr: 12.94256 batch_time=0.35364 
Train Epoch: 37 [181/1000 5792/32000 (18%)] Loss: 0.41799 (QuantReg: 13.63621) QuantErr: 13.63621 batch_time=1.46012 
Train Epoch: 37 [186/1000 5952/32000 (19%)] Loss: 0.46333 (QuantReg: 13.36900) QuantErr: 13.36900 batch_time=0.35202 
Train Epoch: 37 [191/1000 6112/32000 (19%)] Loss: 0.28330 (QuantReg: 12.49458) QuantErr: 12.49458 batch_time=0.39473 
Train Epoch: 37 [196/1000 6272/32000 (20%)] Loss: 0.23178 (QuantReg: 12.91396) QuantErr: 12.91396 batch_time=0.34329 
Train Epoch: 37 [201/1000 6432/32000 (20%)] Loss: 0.30467 (QuantReg: 12.62494) QuantErr: 12.62494 batch_time=0.45959 
Train Epoch: 37 [206/1000 6592/32000 (21%)] Loss: 0.44665 (QuantReg: 13.16697) QuantErr: 13.16697 batch_time=0.35627 
Train Epoch: 37 [211/1000 6752/32000 (21%)] Loss: 0.26545 (QuantReg: 13.49662) QuantErr: 13.49662 batch_time=0.48518 
Train Epoch: 37 [216/1000 6912/32000 (22%)] Loss: 0.09359 (QuantReg: 13.03821) QuantErr: 13.03821 batch_time=0.35039 
Train Epoch: 37 [221/1000 7072/32000 (22%)] Loss: 0.76881 (QuantReg: 13.07903) QuantErr: 13.07903 batch_time=0.35664 
Train Epoch: 37 [226/1000 7232/32000 (23%)] Loss: 0.34753 (QuantReg: 12.87220) QuantErr: 12.87220 batch_time=0.33582 
Train Epoch: 37 [231/1000 7392/32000 (23%)] Loss: 0.33413 (QuantReg: 13.66484) QuantErr: 13.66484 batch_time=0.34668 
Train Epoch: 37 [236/1000 7552/32000 (24%)] Loss: 0.27326 (QuantReg: 13.49621) QuantErr: 13.49621 batch_time=0.38373 
Train Epoch: 37 [241/1000 7712/32000 (24%)] Loss: 0.28889 (QuantReg: 12.70875) QuantErr: 12.70875 batch_time=0.34782 
Train Epoch: 37 [246/1000 7872/32000 (25%)] Loss: 0.15194 (QuantReg: 12.89491) QuantErr: 12.89491 batch_time=0.36747 
Train Epoch: 37 [251/1000 8032/32000 (25%)] Loss: 0.24272 (QuantReg: 12.73900) QuantErr: 12.73900 batch_time=0.48590 
Train Epoch: 37 [256/1000 8192/32000 (26%)] Loss: 0.41756 (QuantReg: 12.90890) QuantErr: 12.90890 batch_time=0.50247 
Train Epoch: 37 [261/1000 8352/32000 (26%)] Loss: 0.19767 (QuantReg: 12.63101) QuantErr: 12.63101 batch_time=0.33517 
Train Epoch: 37 [266/1000 8512/32000 (27%)] Loss: 0.34105 (QuantReg: 13.10100) QuantErr: 13.10100 batch_time=0.42129 
Train Epoch: 37 [271/1000 8672/32000 (27%)] Loss: 0.56555 (QuantReg: 12.91308) QuantErr: 12.91308 batch_time=0.40706 
Train Epoch: 37 [276/1000 8832/32000 (28%)] Loss: 0.23104 (QuantReg: 13.27009) QuantErr: 13.27009 batch_time=0.40011 
Train Epoch: 37 [281/1000 8992/32000 (28%)] Loss: 0.18669 (QuantReg: 12.88445) QuantErr: 12.88445 batch_time=0.40925 
Train Epoch: 37 [286/1000 9152/32000 (29%)] Loss: 0.54597 (QuantReg: 13.25455) QuantErr: 13.25455 batch_time=0.40331 
Train Epoch: 37 [291/1000 9312/32000 (29%)] Loss: 0.57108 (QuantReg: 12.95473) QuantErr: 12.95473 batch_time=0.40210 
Train Epoch: 37 [296/1000 9472/32000 (30%)] Loss: 0.46169 (QuantReg: 13.20140) QuantErr: 13.20140 batch_time=0.42235 
Train Epoch: 37 [301/1000 9632/32000 (30%)] Loss: 0.19403 (QuantReg: 13.15695) QuantErr: 13.15695 batch_time=0.42384 
Train Epoch: 37 [306/1000 9792/32000 (31%)] Loss: 0.49507 (QuantReg: 13.28325) QuantErr: 13.28325 batch_time=0.52742 
Train Epoch: 37 [311/1000 9952/32000 (31%)] Loss: 0.61764 (QuantReg: 13.16420) QuantErr: 13.16420 batch_time=0.41565 
Train Epoch: 37 [316/1000 10112/32000 (32%)] Loss: 0.14699 (QuantReg: 12.74445) QuantErr: 12.74445 batch_time=0.42271 
Train Epoch: 37 [321/1000 10272/32000 (32%)] Loss: 0.41563 (QuantReg: 12.45500) QuantErr: 12.45500 batch_time=0.39412 
Train Epoch: 37 [326/1000 10432/32000 (33%)] Loss: 0.20964 (QuantReg: 13.41328) QuantErr: 13.41328 batch_time=0.34243 
Train Epoch: 37 [331/1000 10592/32000 (33%)] Loss: 0.28981 (QuantReg: 13.69221) QuantErr: 13.69221 batch_time=0.46440 
Train Epoch: 37 [336/1000 10752/32000 (34%)] Loss: 0.45267 (QuantReg: 13.68620) QuantErr: 13.68620 batch_time=0.39221 
Train Epoch: 37 [341/1000 10912/32000 (34%)] Loss: 0.29971 (QuantReg: 13.43234) QuantErr: 13.43234 batch_time=0.48984 
Train Epoch: 37 [346/1000 11072/32000 (35%)] Loss: 0.33507 (QuantReg: 12.71035) QuantErr: 12.71035 batch_time=0.51338 
Train Epoch: 37 [351/1000 11232/32000 (35%)] Loss: 0.38478 (QuantReg: 13.59559) QuantErr: 13.59559 batch_time=0.42828 
Train Epoch: 37 [356/1000 11392/32000 (36%)] Loss: 0.41421 (QuantReg: 13.27075) QuantErr: 13.27075 batch_time=0.35345 
Train Epoch: 37 [361/1000 11552/32000 (36%)] Loss: 0.29830 (QuantReg: 13.24176) QuantErr: 13.24176 batch_time=0.50945 
Train Epoch: 37 [366/1000 11712/32000 (37%)] Loss: 0.12169 (QuantReg: 12.83155) QuantErr: 12.83155 batch_time=0.34150 
Train Epoch: 37 [371/1000 11872/32000 (37%)] Loss: 0.74132 (QuantReg: 12.55436) QuantErr: 12.55436 batch_time=0.34896 
Train Epoch: 37 [376/1000 12032/32000 (38%)] Loss: 0.28642 (QuantReg: 13.02842) QuantErr: 13.02842 batch_time=0.44762 
Train Epoch: 37 [381/1000 12192/32000 (38%)] Loss: 0.31042 (QuantReg: 12.36689) QuantErr: 12.36689 batch_time=0.35384 
Train Epoch: 37 [386/1000 12352/32000 (39%)] Loss: 0.38367 (QuantReg: 13.15753) QuantErr: 13.15753 batch_time=0.35999 
Train Epoch: 37 [391/1000 12512/32000 (39%)] Loss: 0.56684 (QuantReg: 12.48192) QuantErr: 12.48192 batch_time=0.40178 
Train Epoch: 37 [396/1000 12672/32000 (40%)] Loss: 0.56226 (QuantReg: 12.60082) QuantErr: 12.60082 batch_time=0.45893 
Train Epoch: 37 [401/1000 12832/32000 (40%)] Loss: 0.62154 (QuantReg: 12.98047) QuantErr: 12.98047 batch_time=0.45178 
Train Epoch: 37 [406/1000 12992/32000 (41%)] Loss: 0.17705 (QuantReg: 13.17497) QuantErr: 13.17497 batch_time=1.57098 
Train Epoch: 37 [411/1000 13152/32000 (41%)] Loss: 0.78357 (QuantReg: 13.77616) QuantErr: 13.77616 batch_time=0.39383 
Train Epoch: 37 [416/1000 13312/32000 (42%)] Loss: 0.24176 (QuantReg: 13.11357) QuantErr: 13.11357 batch_time=0.38881 
Train Epoch: 37 [421/1000 13472/32000 (42%)] Loss: 0.56280 (QuantReg: 12.65125) QuantErr: 12.65125 batch_time=0.36030 
Train Epoch: 37 [426/1000 13632/32000 (43%)] Loss: 0.45541 (QuantReg: 13.17713) QuantErr: 13.17713 batch_time=0.91957 
Train Epoch: 37 [431/1000 13792/32000 (43%)] Loss: 0.27836 (QuantReg: 13.13560) QuantErr: 13.13560 batch_time=0.38349 
Train Epoch: 37 [436/1000 13952/32000 (44%)] Loss: 0.30058 (QuantReg: 13.00602) QuantErr: 13.00602 batch_time=0.36820 
Train Epoch: 37 [441/1000 14112/32000 (44%)] Loss: 0.19894 (QuantReg: 13.14105) QuantErr: 13.14105 batch_time=0.36724 
Train Epoch: 37 [446/1000 14272/32000 (45%)] Loss: 0.14174 (QuantReg: 13.16838) QuantErr: 13.16838 batch_time=0.86572 
Train Epoch: 37 [451/1000 14432/32000 (45%)] Loss: 0.11900 (QuantReg: 13.57935) QuantErr: 13.57935 batch_time=0.34613 
Train Epoch: 37 [456/1000 14592/32000 (46%)] Loss: 0.24766 (QuantReg: 13.08586) QuantErr: 13.08586 batch_time=0.43696 
Train Epoch: 37 [461/1000 14752/32000 (46%)] Loss: 0.27512 (QuantReg: 13.10714) QuantErr: 13.10714 batch_time=0.34308 
Train Epoch: 37 [466/1000 14912/32000 (47%)] Loss: 0.07083 (QuantReg: 13.56493) QuantErr: 13.56493 batch_time=0.34776 
Train Epoch: 37 [471/1000 15072/32000 (47%)] Loss: 0.06912 (QuantReg: 12.86908) QuantErr: 12.86908 batch_time=0.42727 
Train Epoch: 37 [476/1000 15232/32000 (48%)] Loss: 0.25070 (QuantReg: 13.17498) QuantErr: 13.17498 batch_time=0.42543 
Train Epoch: 37 [481/1000 15392/32000 (48%)] Loss: 0.22634 (QuantReg: 12.75346) QuantErr: 12.75346 batch_time=0.40608 
Train Epoch: 37 [486/1000 15552/32000 (49%)] Loss: 0.68767 (QuantReg: 12.82568) QuantErr: 12.82568 batch_time=0.64298 
Train Epoch: 37 [491/1000 15712/32000 (49%)] Loss: 0.10852 (QuantReg: 13.58270) QuantErr: 13.58270 batch_time=0.35368 
Train Epoch: 37 [496/1000 15872/32000 (50%)] Loss: 0.26749 (QuantReg: 12.99759) QuantErr: 12.99759 batch_time=0.59240 
Train Epoch: 37 [501/1000 16032/32000 (50%)] Loss: 0.46732 (QuantReg: 12.92557) QuantErr: 12.92557 batch_time=0.96300 
Train Epoch: 37 [506/1000 16192/32000 (51%)] Loss: 0.27211 (QuantReg: 12.94188) QuantErr: 12.94188 batch_time=0.36118 
Train Epoch: 37 [511/1000 16352/32000 (51%)] Loss: 0.62697 (QuantReg: 13.08725) QuantErr: 13.08725 batch_time=0.35732 
Train Epoch: 37 [516/1000 16512/32000 (52%)] Loss: 0.29279 (QuantReg: 13.20179) QuantErr: 13.20179 batch_time=0.36994 
Train Epoch: 37 [521/1000 16672/32000 (52%)] Loss: 0.15387 (QuantReg: 12.89722) QuantErr: 12.89722 batch_time=0.39574 
Train Epoch: 37 [526/1000 16832/32000 (53%)] Loss: 0.32777 (QuantReg: 13.31060) QuantErr: 13.31060 batch_time=0.37308 
Train Epoch: 37 [531/1000 16992/32000 (53%)] Loss: 0.45294 (QuantReg: 13.06231) QuantErr: 13.06231 batch_time=0.37218 
Train Epoch: 37 [536/1000 17152/32000 (54%)] Loss: 0.30938 (QuantReg: 12.66573) QuantErr: 12.66573 batch_time=0.39336 
Train Epoch: 37 [541/1000 17312/32000 (54%)] Loss: 0.21953 (QuantReg: 13.26158) QuantErr: 13.26158 batch_time=0.34465 
Train Epoch: 37 [546/1000 17472/32000 (55%)] Loss: 0.40945 (QuantReg: 12.99679) QuantErr: 12.99679 batch_time=0.71890 
Train Epoch: 37 [551/1000 17632/32000 (55%)] Loss: 0.32884 (QuantReg: 13.67363) QuantErr: 13.67363 batch_time=0.35534 
Train Epoch: 37 [556/1000 17792/32000 (56%)] Loss: 0.20882 (QuantReg: 12.98981) QuantErr: 12.98981 batch_time=0.47547 
Train Epoch: 37 [561/1000 17952/32000 (56%)] Loss: 0.44519 (QuantReg: 12.56971) QuantErr: 12.56971 batch_time=0.41851 
Train Epoch: 37 [566/1000 18112/32000 (57%)] Loss: 0.13446 (QuantReg: 13.20605) QuantErr: 13.20605 batch_time=0.44810 
Train Epoch: 37 [571/1000 18272/32000 (57%)] Loss: 0.57511 (QuantReg: 12.66293) QuantErr: 12.66293 batch_time=0.39915 
Train Epoch: 37 [576/1000 18432/32000 (58%)] Loss: 0.13621 (QuantReg: 13.72136) QuantErr: 13.72136 batch_time=0.34475 
Train Epoch: 37 [581/1000 18592/32000 (58%)] Loss: 0.34582 (QuantReg: 13.33459) QuantErr: 13.33459 batch_time=0.36492 
Train Epoch: 37 [586/1000 18752/32000 (59%)] Loss: 0.26825 (QuantReg: 13.65125) QuantErr: 13.65125 batch_time=0.36652 
Train Epoch: 37 [591/1000 18912/32000 (59%)] Loss: 0.21605 (QuantReg: 13.32220) QuantErr: 13.32220 batch_time=0.40044 
Train Epoch: 37 [596/1000 19072/32000 (60%)] Loss: 0.32459 (QuantReg: 13.16899) QuantErr: 13.16899 batch_time=0.62454 
Train Epoch: 37 [601/1000 19232/32000 (60%)] Loss: 0.18729 (QuantReg: 13.19080) QuantErr: 13.19080 batch_time=0.38841 
Train Epoch: 37 [606/1000 19392/32000 (61%)] Loss: 0.21995 (QuantReg: 12.76174) QuantErr: 12.76174 batch_time=0.42667 
Train Epoch: 37 [611/1000 19552/32000 (61%)] Loss: 0.20765 (QuantReg: 13.02198) QuantErr: 13.02198 batch_time=0.40969 
Train Epoch: 37 [616/1000 19712/32000 (62%)] Loss: 0.41506 (QuantReg: 12.95400) QuantErr: 12.95400 batch_time=0.36714 
Train Epoch: 37 [621/1000 19872/32000 (62%)] Loss: 0.44037 (QuantReg: 13.49957) QuantErr: 13.49957 batch_time=0.37639 
Train Epoch: 37 [626/1000 20032/32000 (63%)] Loss: 0.26786 (QuantReg: 13.39666) QuantErr: 13.39666 batch_time=0.39580 
Train Epoch: 37 [631/1000 20192/32000 (63%)] Loss: 0.17325 (QuantReg: 13.32157) QuantErr: 13.32157 batch_time=0.37207 
Train Epoch: 37 [636/1000 20352/32000 (64%)] Loss: 0.21540 (QuantReg: 13.08771) QuantErr: 13.08771 batch_time=0.48624 
Train Epoch: 37 [641/1000 20512/32000 (64%)] Loss: 0.42464 (QuantReg: 13.08215) QuantErr: 13.08215 batch_time=0.36131 
Train Epoch: 37 [646/1000 20672/32000 (65%)] Loss: 0.25098 (QuantReg: 13.48150) QuantErr: 13.48150 batch_time=0.62981 
Train Epoch: 37 [651/1000 20832/32000 (65%)] Loss: 0.24939 (QuantReg: 12.81606) QuantErr: 12.81606 batch_time=0.49746 
Train Epoch: 37 [656/1000 20992/32000 (66%)] Loss: 0.32580 (QuantReg: 13.25799) QuantErr: 13.25799 batch_time=0.35942 
Train Epoch: 37 [661/1000 21152/32000 (66%)] Loss: 0.16736 (QuantReg: 13.01394) QuantErr: 13.01394 batch_time=0.33491 
Train Epoch: 37 [666/1000 21312/32000 (67%)] Loss: 0.64779 (QuantReg: 12.97241) QuantErr: 12.97241 batch_time=0.36143 
Train Epoch: 37 [671/1000 21472/32000 (67%)] Loss: 0.20906 (QuantReg: 13.42214) QuantErr: 13.42214 batch_time=0.44198 
Train Epoch: 37 [676/1000 21632/32000 (68%)] Loss: 0.23681 (QuantReg: 13.53361) QuantErr: 13.53361 batch_time=0.46478 
Train Epoch: 37 [681/1000 21792/32000 (68%)] Loss: 0.38596 (QuantReg: 13.45836) QuantErr: 13.45836 batch_time=0.43853 
Train Epoch: 37 [686/1000 21952/32000 (69%)] Loss: 0.23247 (QuantReg: 12.94164) QuantErr: 12.94164 batch_time=0.40412 
Train Epoch: 37 [691/1000 22112/32000 (69%)] Loss: 0.27473 (QuantReg: 12.50772) QuantErr: 12.50772 batch_time=0.33139 
Train Epoch: 37 [696/1000 22272/32000 (70%)] Loss: 0.32423 (QuantReg: 13.44530) QuantErr: 13.44530 batch_time=0.74309 
Train Epoch: 37 [701/1000 22432/32000 (70%)] Loss: 0.15265 (QuantReg: 13.09733) QuantErr: 13.09733 batch_time=0.35513 
Train Epoch: 37 [706/1000 22592/32000 (71%)] Loss: 0.49142 (QuantReg: 13.51461) QuantErr: 13.51461 batch_time=0.42170 
Train Epoch: 37 [711/1000 22752/32000 (71%)] Loss: 0.29149 (QuantReg: 13.14261) QuantErr: 13.14261 batch_time=0.37292 
Train Epoch: 37 [716/1000 22912/32000 (72%)] Loss: 1.05844 (QuantReg: 12.69639) QuantErr: 12.69639 batch_time=0.40374 
Train Epoch: 37 [721/1000 23072/32000 (72%)] Loss: 0.25497 (QuantReg: 13.29392) QuantErr: 13.29392 batch_time=0.37394 
Train Epoch: 37 [726/1000 23232/32000 (73%)] Loss: 0.31874 (QuantReg: 13.36230) QuantErr: 13.36230 batch_time=0.73692 
Train Epoch: 37 [731/1000 23392/32000 (73%)] Loss: 0.27654 (QuantReg: 12.37265) QuantErr: 12.37265 batch_time=0.34981 
Train Epoch: 37 [736/1000 23552/32000 (74%)] Loss: 0.73195 (QuantReg: 12.83677) QuantErr: 12.83677 batch_time=0.39718 
Train Epoch: 37 [741/1000 23712/32000 (74%)] Loss: 0.49711 (QuantReg: 13.21632) QuantErr: 13.21632 batch_time=0.34971 
Train Epoch: 37 [746/1000 23872/32000 (75%)] Loss: 0.18283 (QuantReg: 13.14982) QuantErr: 13.14982 batch_time=0.51632 
Train Epoch: 37 [751/1000 24032/32000 (75%)] Loss: 0.23861 (QuantReg: 13.32393) QuantErr: 13.32393 batch_time=0.41532 
Train Epoch: 37 [756/1000 24192/32000 (76%)] Loss: 0.55256 (QuantReg: 12.16443) QuantErr: 12.16443 batch_time=0.45520 
Train Epoch: 37 [761/1000 24352/32000 (76%)] Loss: 0.42435 (QuantReg: 12.80619) QuantErr: 12.80619 batch_time=0.37044 
Train Epoch: 37 [766/1000 24512/32000 (77%)] Loss: 0.97787 (QuantReg: 13.19739) QuantErr: 13.19739 batch_time=0.35383 
Train Epoch: 37 [771/1000 24672/32000 (77%)] Loss: 0.17718 (QuantReg: 13.13330) QuantErr: 13.13330 batch_time=0.44529 
Train Epoch: 37 [776/1000 24832/32000 (78%)] Loss: 0.41117 (QuantReg: 13.38734) QuantErr: 13.38734 batch_time=0.45021 
Train Epoch: 37 [781/1000 24992/32000 (78%)] Loss: 0.34163 (QuantReg: 13.01371) QuantErr: 13.01371 batch_time=0.40290 
Train Epoch: 37 [786/1000 25152/32000 (79%)] Loss: 0.29170 (QuantReg: 13.06418) QuantErr: 13.06418 batch_time=0.37566 
Train Epoch: 37 [791/1000 25312/32000 (79%)] Loss: 0.05357 (QuantReg: 13.25902) QuantErr: 13.25902 batch_time=0.73494 
Train Epoch: 37 [796/1000 25472/32000 (80%)] Loss: 0.32474 (QuantReg: 13.49137) QuantErr: 13.49137 batch_time=0.34606 
Train Epoch: 37 [801/1000 25632/32000 (80%)] Loss: 0.35644 (QuantReg: 13.15711) QuantErr: 13.15711 batch_time=0.44895 
Train Epoch: 37 [806/1000 25792/32000 (81%)] Loss: 0.45709 (QuantReg: 12.73538) QuantErr: 12.73538 batch_time=0.45749 
Train Epoch: 37 [811/1000 25952/32000 (81%)] Loss: 0.19395 (QuantReg: 13.63588) QuantErr: 13.63588 batch_time=0.37828 
Train Epoch: 37 [816/1000 26112/32000 (82%)] Loss: 0.20960 (QuantReg: 13.22393) QuantErr: 13.22393 batch_time=0.34818 
Train Epoch: 37 [821/1000 26272/32000 (82%)] Loss: 0.39080 (QuantReg: 12.65503) QuantErr: 12.65503 batch_time=0.96561 
Train Epoch: 37 [826/1000 26432/32000 (83%)] Loss: 0.25769 (QuantReg: 13.76686) QuantErr: 13.76686 batch_time=0.46379 
Train Epoch: 37 [831/1000 26592/32000 (83%)] Loss: 0.48123 (QuantReg: 13.16937) QuantErr: 13.16937 batch_time=0.58910 
Train Epoch: 37 [836/1000 26752/32000 (84%)] Loss: 0.13878 (QuantReg: 13.39602) QuantErr: 13.39602 batch_time=0.33250 
Train Epoch: 37 [841/1000 26912/32000 (84%)] Loss: 0.33260 (QuantReg: 13.69556) QuantErr: 13.69556 batch_time=0.59178 
Train Epoch: 37 [846/1000 27072/32000 (85%)] Loss: 0.52030 (QuantReg: 13.21214) QuantErr: 13.21214 batch_time=0.58102 
Train Epoch: 37 [851/1000 27232/32000 (85%)] Loss: 0.33337 (QuantReg: 12.85911) QuantErr: 12.85911 batch_time=0.38425 
Train Epoch: 37 [856/1000 27392/32000 (86%)] Loss: 0.35072 (QuantReg: 13.29989) QuantErr: 13.29989 batch_time=0.37114 
Train Epoch: 37 [861/1000 27552/32000 (86%)] Loss: 0.17371 (QuantReg: 13.29447) QuantErr: 13.29447 batch_time=0.33928 
Train Epoch: 37 [866/1000 27712/32000 (87%)] Loss: 0.51637 (QuantReg: 12.69147) QuantErr: 12.69147 batch_time=0.35589 
Train Epoch: 37 [871/1000 27872/32000 (87%)] Loss: 0.30450 (QuantReg: 13.24351) QuantErr: 13.24351 batch_time=0.36920 
Train Epoch: 37 [876/1000 28032/32000 (88%)] Loss: 0.52542 (QuantReg: 12.96765) QuantErr: 12.96765 batch_time=0.33788 
Train Epoch: 37 [881/1000 28192/32000 (88%)] Loss: 0.17720 (QuantReg: 12.40772) QuantErr: 12.40772 batch_time=0.37814 
Train Epoch: 37 [886/1000 28352/32000 (89%)] Loss: 0.37761 (QuantReg: 12.84715) QuantErr: 12.84715 batch_time=0.78716 
Train Epoch: 37 [891/1000 28512/32000 (89%)] Loss: 0.39231 (QuantReg: 12.83764) QuantErr: 12.83764 batch_time=0.44045 
Train Epoch: 37 [896/1000 28672/32000 (90%)] Loss: 0.27672 (QuantReg: 13.91966) QuantErr: 13.91966 batch_time=0.33381 
Train Epoch: 37 [901/1000 28832/32000 (90%)] Loss: 0.24674 (QuantReg: 13.53201) QuantErr: 13.53201 batch_time=0.51480 
Train Epoch: 37 [906/1000 28992/32000 (91%)] Loss: 0.35272 (QuantReg: 12.75469) QuantErr: 12.75469 batch_time=0.34362 
Train Epoch: 37 [911/1000 29152/32000 (91%)] Loss: 0.39293 (QuantReg: 13.18640) QuantErr: 13.18640 batch_time=0.34947 
Train Epoch: 37 [916/1000 29312/32000 (92%)] Loss: 0.29162 (QuantReg: 12.49476) QuantErr: 12.49476 batch_time=0.37246 
Train Epoch: 37 [921/1000 29472/32000 (92%)] Loss: 0.29202 (QuantReg: 13.06680) QuantErr: 13.06680 batch_time=0.36834 
Train Epoch: 37 [926/1000 29632/32000 (93%)] Loss: 0.27498 (QuantReg: 13.16256) QuantErr: 13.16256 batch_time=0.95960 
Train Epoch: 37 [931/1000 29792/32000 (93%)] Loss: 0.39140 (QuantReg: 12.86989) QuantErr: 12.86989 batch_time=0.35046 
Train Epoch: 37 [936/1000 29952/32000 (94%)] Loss: 0.30442 (QuantReg: 13.25339) QuantErr: 13.25339 batch_time=0.82392 
Train Epoch: 37 [941/1000 30112/32000 (94%)] Loss: 0.25977 (QuantReg: 13.25022) QuantErr: 13.25022 batch_time=0.45026 
Train Epoch: 37 [946/1000 30272/32000 (95%)] Loss: 0.25545 (QuantReg: 13.55500) QuantErr: 13.55500 batch_time=0.41325 
Train Epoch: 37 [951/1000 30432/32000 (95%)] Loss: 0.28110 (QuantReg: 13.15272) QuantErr: 13.15272 batch_time=0.44641 
Train Epoch: 37 [956/1000 30592/32000 (96%)] Loss: 0.31898 (QuantReg: 13.53848) QuantErr: 13.53848 batch_time=0.34771 
Train Epoch: 37 [961/1000 30752/32000 (96%)] Loss: 0.11943 (QuantReg: 13.12015) QuantErr: 13.12015 batch_time=0.37136 
Train Epoch: 37 [966/1000 30912/32000 (97%)] Loss: 0.79991 (QuantReg: 12.98306) QuantErr: 12.98306 batch_time=0.34730 
Train Epoch: 37 [971/1000 31072/32000 (97%)] Loss: 0.31897 (QuantReg: 12.87242) QuantErr: 12.87242 batch_time=0.98268 
Train Epoch: 37 [976/1000 31232/32000 (98%)] Loss: 0.57759 (QuantReg: 12.70441) QuantErr: 12.70441 batch_time=0.34856 
Train Epoch: 37 [981/1000 31392/32000 (98%)] Loss: 0.24422 (QuantReg: 13.48429) QuantErr: 13.48429 batch_time=0.42007 
Train Epoch: 37 [986/1000 31552/32000 (99%)] Loss: 0.48333 (QuantReg: 13.06466) QuantErr: 13.06466 batch_time=0.41622 
Train Epoch: 37 [991/1000 31712/32000 (99%)] Loss: 0.52051 (QuantReg: 12.76830) QuantErr: 12.76830 batch_time=0.44754 
Train Epoch: 37 [996/1000 31872/32000 (100%)] Loss: 0.49796 (QuantReg: 13.24487) QuantErr: 13.24487 batch_time=0.36686 
Train Epoch: 37 codebook_update_time=1.66442
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch37.pth ...
Done in 6.658s
removing stale ckpt [epoch 36] [took 0.02s]
 epoch          : 37
 loss           : 0.3401937750764191
 quant_reg      : 13.063372043609618
 quant_err      : 13.063372043609618
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 37000
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 49.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.7
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.934
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.43286545676589
 MSRVTT_miech_test/v2t_metrics/R1: 18.4
 MSRVTT_miech_test/v2t_metrics/R5: 52.0
 MSRVTT_miech_test/v2t_metrics/R10: 64.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.2225
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.517878996901985
 mnt_best       : 41.036608587691525
 not_improved_count: 3
Train Epoch: 38 [1/1000 32/32000 (0%)] Loss: 0.31397 (QuantReg: 13.62631) QuantErr: 13.62631 batch_time=30.98272 
Train Epoch: 38 [6/1000 192/32000 (1%)] Loss: 0.43490 (QuantReg: 12.64834) QuantErr: 12.64834 batch_time=0.49914 
Train Epoch: 38 [11/1000 352/32000 (1%)] Loss: 0.08227 (QuantReg: 13.62039) QuantErr: 13.62039 batch_time=0.36953 
Train Epoch: 38 [16/1000 512/32000 (2%)] Loss: 0.23096 (QuantReg: 13.38455) QuantErr: 13.38455 batch_time=0.88037 
Train Epoch: 38 [21/1000 672/32000 (2%)] Loss: 0.30674 (QuantReg: 12.35951) QuantErr: 12.35951 batch_time=0.51358 
Train Epoch: 38 [26/1000 832/32000 (3%)] Loss: 0.44288 (QuantReg: 12.47867) QuantErr: 12.47867 batch_time=0.46814 
Train Epoch: 38 [31/1000 992/32000 (3%)] Loss: 0.22878 (QuantReg: 13.58645) QuantErr: 13.58645 batch_time=0.54868 
Train Epoch: 38 [36/1000 1152/32000 (4%)] Loss: 0.15192 (QuantReg: 13.01710) QuantErr: 13.01710 batch_time=0.40076 
Train Epoch: 38 [41/1000 1312/32000 (4%)] Loss: 0.16981 (QuantReg: 13.13116) QuantErr: 13.13116 batch_time=0.54081 
Train Epoch: 38 [46/1000 1472/32000 (5%)] Loss: 0.29996 (QuantReg: 13.11280) QuantErr: 13.11280 batch_time=0.39184 
Train Epoch: 38 [51/1000 1632/32000 (5%)] Loss: 0.36760 (QuantReg: 13.25248) QuantErr: 13.25248 batch_time=0.42434 
Train Epoch: 38 [56/1000 1792/32000 (6%)] Loss: 0.55540 (QuantReg: 12.87310) QuantErr: 12.87310 batch_time=0.44487 
Train Epoch: 38 [61/1000 1952/32000 (6%)] Loss: 0.16343 (QuantReg: 13.81013) QuantErr: 13.81013 batch_time=0.44688 
Train Epoch: 38 [66/1000 2112/32000 (7%)] Loss: 0.49750 (QuantReg: 12.95500) QuantErr: 12.95500 batch_time=0.41063 
Train Epoch: 38 [71/1000 2272/32000 (7%)] Loss: 0.42725 (QuantReg: 12.81456) QuantErr: 12.81456 batch_time=0.65477 
Train Epoch: 38 [76/1000 2432/32000 (8%)] Loss: 0.42709 (QuantReg: 13.20400) QuantErr: 13.20400 batch_time=0.33863 
Train Epoch: 38 [81/1000 2592/32000 (8%)] Loss: 0.35256 (QuantReg: 13.23800) QuantErr: 13.23800 batch_time=0.49974 
Train Epoch: 38 [86/1000 2752/32000 (9%)] Loss: 0.16147 (QuantReg: 13.46797) QuantErr: 13.46797 batch_time=0.46087 
Train Epoch: 38 [91/1000 2912/32000 (9%)] Loss: 0.34582 (QuantReg: 13.12634) QuantErr: 13.12634 batch_time=0.34890 
Train Epoch: 38 [96/1000 3072/32000 (10%)] Loss: 0.39650 (QuantReg: 13.09735) QuantErr: 13.09735 batch_time=0.38977 
Train Epoch: 38 [101/1000 3232/32000 (10%)] Loss: 0.63175 (QuantReg: 12.43395) QuantErr: 12.43395 batch_time=0.36697 
Train Epoch: 38 [106/1000 3392/32000 (11%)] Loss: 0.33003 (QuantReg: 13.88557) QuantErr: 13.88557 batch_time=0.34879 
Train Epoch: 38 [111/1000 3552/32000 (11%)] Loss: 0.18356 (QuantReg: 12.98470) QuantErr: 12.98470 batch_time=0.41340 
Train Epoch: 38 [116/1000 3712/32000 (12%)] Loss: 0.20006 (QuantReg: 12.82019) QuantErr: 12.82019 batch_time=0.38894 
Train Epoch: 38 [121/1000 3872/32000 (12%)] Loss: 0.37744 (QuantReg: 12.98287) QuantErr: 12.98287 batch_time=0.33578 
Train Epoch: 38 [126/1000 4032/32000 (13%)] Loss: 0.51946 (QuantReg: 12.86315) QuantErr: 12.86315 batch_time=0.75718 
Train Epoch: 38 [131/1000 4192/32000 (13%)] Loss: 0.27170 (QuantReg: 13.11705) QuantErr: 13.11705 batch_time=0.45197 
Train Epoch: 38 [136/1000 4352/32000 (14%)] Loss: 0.32897 (QuantReg: 13.56441) QuantErr: 13.56441 batch_time=0.35782 
Train Epoch: 38 [141/1000 4512/32000 (14%)] Loss: 0.33038 (QuantReg: 13.05408) QuantErr: 13.05408 batch_time=0.46544 
Train Epoch: 38 [146/1000 4672/32000 (15%)] Loss: 0.30351 (QuantReg: 13.14345) QuantErr: 13.14345 batch_time=2.29473 
Train Epoch: 38 [151/1000 4832/32000 (15%)] Loss: 0.52890 (QuantReg: 12.82352) QuantErr: 12.82352 batch_time=0.39419 
Train Epoch: 38 [156/1000 4992/32000 (16%)] Loss: 0.35554 (QuantReg: 12.77375) QuantErr: 12.77375 batch_time=0.35907 
Train Epoch: 38 [161/1000 5152/32000 (16%)] Loss: 0.29796 (QuantReg: 12.87993) QuantErr: 12.87993 batch_time=0.47135 
Train Epoch: 38 [166/1000 5312/32000 (17%)] Loss: 0.14674 (QuantReg: 12.83889) QuantErr: 12.83889 batch_time=0.36610 
Train Epoch: 38 [171/1000 5472/32000 (17%)] Loss: 0.31340 (QuantReg: 13.49365) QuantErr: 13.49365 batch_time=0.40194 
Train Epoch: 38 [176/1000 5632/32000 (18%)] Loss: 0.20921 (QuantReg: 13.14650) QuantErr: 13.14650 batch_time=0.61754 
Train Epoch: 38 [181/1000 5792/32000 (18%)] Loss: 0.30813 (QuantReg: 13.23528) QuantErr: 13.23528 batch_time=0.34410 
Train Epoch: 38 [186/1000 5952/32000 (19%)] Loss: 0.12862 (QuantReg: 13.15715) QuantErr: 13.15715 batch_time=0.37791 
Train Epoch: 38 [191/1000 6112/32000 (19%)] Loss: 0.40447 (QuantReg: 12.84741) QuantErr: 12.84741 batch_time=0.48067 
Train Epoch: 38 [196/1000 6272/32000 (20%)] Loss: 0.39179 (QuantReg: 12.89846) QuantErr: 12.89846 batch_time=0.37245 
Train Epoch: 38 [201/1000 6432/32000 (20%)] Loss: 0.27551 (QuantReg: 12.90309) QuantErr: 12.90309 batch_time=0.34820 
Train Epoch: 38 [206/1000 6592/32000 (21%)] Loss: 0.10675 (QuantReg: 12.67483) QuantErr: 12.67483 batch_time=0.41650 
Train Epoch: 38 [211/1000 6752/32000 (21%)] Loss: 0.08760 (QuantReg: 13.66213) QuantErr: 13.66213 batch_time=0.36835 
Train Epoch: 38 [216/1000 6912/32000 (22%)] Loss: 0.27377 (QuantReg: 13.54159) QuantErr: 13.54159 batch_time=0.36053 
Train Epoch: 38 [221/1000 7072/32000 (22%)] Loss: 0.10464 (QuantReg: 13.64751) QuantErr: 13.64751 batch_time=0.35006 
Train Epoch: 38 [226/1000 7232/32000 (23%)] Loss: 0.35818 (QuantReg: 12.92592) QuantErr: 12.92592 batch_time=0.76233 
Train Epoch: 38 [231/1000 7392/32000 (23%)] Loss: 0.42433 (QuantReg: 13.11865) QuantErr: 13.11865 batch_time=0.35143 
Train Epoch: 38 [236/1000 7552/32000 (24%)] Loss: 0.40311 (QuantReg: 13.04886) QuantErr: 13.04886 batch_time=0.40450 
Train Epoch: 38 [241/1000 7712/32000 (24%)] Loss: 0.29000 (QuantReg: 12.78085) QuantErr: 12.78085 batch_time=0.38244 
Train Epoch: 38 [246/1000 7872/32000 (25%)] Loss: 0.21555 (QuantReg: 12.64139) QuantErr: 12.64139 batch_time=0.41420 
Train Epoch: 38 [251/1000 8032/32000 (25%)] Loss: 0.09465 (QuantReg: 13.09222) QuantErr: 13.09222 batch_time=0.47659 
Train Epoch: 38 [256/1000 8192/32000 (26%)] Loss: 0.57178 (QuantReg: 12.43481) QuantErr: 12.43481 batch_time=0.35717 
Train Epoch: 38 [261/1000 8352/32000 (26%)] Loss: 0.46948 (QuantReg: 12.48613) QuantErr: 12.48613 batch_time=0.33747 
Train Epoch: 38 [266/1000 8512/32000 (27%)] Loss: 0.78968 (QuantReg: 13.14172) QuantErr: 13.14172 batch_time=0.36409 
Train Epoch: 38 [271/1000 8672/32000 (27%)] Loss: 0.35383 (QuantReg: 12.72730) QuantErr: 12.72730 batch_time=1.44401 
Train Epoch: 38 [276/1000 8832/32000 (28%)] Loss: 0.38208 (QuantReg: 13.27520) QuantErr: 13.27520 batch_time=0.49117 
Train Epoch: 38 [281/1000 8992/32000 (28%)] Loss: 0.10579 (QuantReg: 13.21302) QuantErr: 13.21302 batch_time=0.35967 
Train Epoch: 38 [286/1000 9152/32000 (29%)] Loss: 0.42169 (QuantReg: 12.97370) QuantErr: 12.97370 batch_time=0.39877 
Train Epoch: 38 [291/1000 9312/32000 (29%)] Loss: 0.80231 (QuantReg: 12.57103) QuantErr: 12.57103 batch_time=0.37093 
Train Epoch: 38 [296/1000 9472/32000 (30%)] Loss: 0.07331 (QuantReg: 13.82416) QuantErr: 13.82416 batch_time=0.35712 
Train Epoch: 38 [301/1000 9632/32000 (30%)] Loss: 0.26347 (QuantReg: 13.11609) QuantErr: 13.11609 batch_time=0.43526 
Train Epoch: 38 [306/1000 9792/32000 (31%)] Loss: 0.33353 (QuantReg: 13.15887) QuantErr: 13.15887 batch_time=0.37441 
Train Epoch: 38 [311/1000 9952/32000 (31%)] Loss: 0.50916 (QuantReg: 13.06457) QuantErr: 13.06457 batch_time=0.35775 
Train Epoch: 38 [316/1000 10112/32000 (32%)] Loss: 0.44534 (QuantReg: 13.02523) QuantErr: 13.02523 batch_time=0.40189 
Train Epoch: 38 [321/1000 10272/32000 (32%)] Loss: 0.29610 (QuantReg: 12.81474) QuantErr: 12.81474 batch_time=0.68742 
Train Epoch: 38 [326/1000 10432/32000 (33%)] Loss: 0.38388 (QuantReg: 13.35037) QuantErr: 13.35037 batch_time=0.70198 
Train Epoch: 38 [331/1000 10592/32000 (33%)] Loss: 0.51904 (QuantReg: 12.90240) QuantErr: 12.90240 batch_time=0.33743 
Train Epoch: 38 [336/1000 10752/32000 (34%)] Loss: 0.25117 (QuantReg: 13.22163) QuantErr: 13.22163 batch_time=0.41853 
Train Epoch: 38 [341/1000 10912/32000 (34%)] Loss: 0.55147 (QuantReg: 12.82798) QuantErr: 12.82798 batch_time=0.34959 
Train Epoch: 38 [346/1000 11072/32000 (35%)] Loss: 0.43503 (QuantReg: 13.11959) QuantErr: 13.11959 batch_time=0.42314 
Train Epoch: 38 [351/1000 11232/32000 (35%)] Loss: 0.08905 (QuantReg: 13.00617) QuantErr: 13.00617 batch_time=0.38377 
Train Epoch: 38 [356/1000 11392/32000 (36%)] Loss: 0.28984 (QuantReg: 13.28430) QuantErr: 13.28430 batch_time=0.37210 
Train Epoch: 38 [361/1000 11552/32000 (36%)] Loss: 0.61636 (QuantReg: 13.02467) QuantErr: 13.02467 batch_time=0.40602 
Train Epoch: 38 [366/1000 11712/32000 (37%)] Loss: 0.20000 (QuantReg: 13.14512) QuantErr: 13.14512 batch_time=0.36439 
Train Epoch: 38 [371/1000 11872/32000 (37%)] Loss: 0.32933 (QuantReg: 13.16209) QuantErr: 13.16209 batch_time=0.39026 
Train Epoch: 38 [376/1000 12032/32000 (38%)] Loss: 0.26274 (QuantReg: 13.39418) QuantErr: 13.39418 batch_time=0.93611 
Train Epoch: 38 [381/1000 12192/32000 (38%)] Loss: 0.57858 (QuantReg: 12.95635) QuantErr: 12.95635 batch_time=0.56979 
Train Epoch: 38 [386/1000 12352/32000 (39%)] Loss: 0.48530 (QuantReg: 12.68888) QuantErr: 12.68888 batch_time=0.43292 
Train Epoch: 38 [391/1000 12512/32000 (39%)] Loss: 0.46105 (QuantReg: 13.07051) QuantErr: 13.07051 batch_time=0.34422 
Train Epoch: 38 [396/1000 12672/32000 (40%)] Loss: 0.32284 (QuantReg: 12.58280) QuantErr: 12.58280 batch_time=0.44273 
Train Epoch: 38 [401/1000 12832/32000 (40%)] Loss: 0.49865 (QuantReg: 13.03790) QuantErr: 13.03790 batch_time=0.40057 
Train Epoch: 38 [406/1000 12992/32000 (41%)] Loss: 0.26162 (QuantReg: 13.31021) QuantErr: 13.31021 batch_time=0.39643 
Train Epoch: 38 [411/1000 13152/32000 (41%)] Loss: 0.68551 (QuantReg: 13.30047) QuantErr: 13.30047 batch_time=0.40871 
Train Epoch: 38 [416/1000 13312/32000 (42%)] Loss: 0.38867 (QuantReg: 13.04521) QuantErr: 13.04521 batch_time=0.36369 
Train Epoch: 38 [421/1000 13472/32000 (42%)] Loss: 0.43662 (QuantReg: 13.52140) QuantErr: 13.52140 batch_time=0.45334 
Train Epoch: 38 [426/1000 13632/32000 (43%)] Loss: 0.22789 (QuantReg: 12.79838) QuantErr: 12.79838 batch_time=0.45938 
Train Epoch: 38 [431/1000 13792/32000 (43%)] Loss: 0.22236 (QuantReg: 12.85113) QuantErr: 12.85113 batch_time=0.37352 
Train Epoch: 38 [436/1000 13952/32000 (44%)] Loss: 0.37933 (QuantReg: 12.67161) QuantErr: 12.67161 batch_time=0.44271 
Train Epoch: 38 [441/1000 14112/32000 (44%)] Loss: 0.53881 (QuantReg: 13.13623) QuantErr: 13.13623 batch_time=0.35487 
Train Epoch: 38 [446/1000 14272/32000 (45%)] Loss: 0.56213 (QuantReg: 13.18204) QuantErr: 13.18204 batch_time=0.41395 
Train Epoch: 38 [451/1000 14432/32000 (45%)] Loss: 0.26058 (QuantReg: 13.44111) QuantErr: 13.44111 batch_time=0.42002 
Train Epoch: 38 [456/1000 14592/32000 (46%)] Loss: 0.45384 (QuantReg: 13.53674) QuantErr: 13.53674 batch_time=0.38173 
Train Epoch: 38 [461/1000 14752/32000 (46%)] Loss: 0.40862 (QuantReg: 13.17205) QuantErr: 13.17205 batch_time=0.35623 
Train Epoch: 38 [466/1000 14912/32000 (47%)] Loss: 0.36541 (QuantReg: 12.56342) QuantErr: 12.56342 batch_time=0.99830 
Train Epoch: 38 [471/1000 15072/32000 (47%)] Loss: 0.32048 (QuantReg: 12.53112) QuantErr: 12.53112 batch_time=0.54915 
Train Epoch: 38 [476/1000 15232/32000 (48%)] Loss: 0.54487 (QuantReg: 12.54037) QuantErr: 12.54037 batch_time=0.54734 
Train Epoch: 38 [481/1000 15392/32000 (48%)] Loss: 0.24045 (QuantReg: 13.73425) QuantErr: 13.73425 batch_time=0.39839 
Train Epoch: 38 [486/1000 15552/32000 (49%)] Loss: 0.30249 (QuantReg: 13.28634) QuantErr: 13.28634 batch_time=0.51440 
Train Epoch: 38 [491/1000 15712/32000 (49%)] Loss: 0.15465 (QuantReg: 13.50615) QuantErr: 13.50615 batch_time=0.35949 
Train Epoch: 38 [496/1000 15872/32000 (50%)] Loss: 0.38239 (QuantReg: 13.18143) QuantErr: 13.18143 batch_time=0.46655 
Train Epoch: 38 [501/1000 16032/32000 (50%)] Loss: 0.26261 (QuantReg: 12.98586) QuantErr: 12.98586 batch_time=0.34365 
Train Epoch: 38 [506/1000 16192/32000 (51%)] Loss: 0.25296 (QuantReg: 13.11765) QuantErr: 13.11765 batch_time=0.44018 
Train Epoch: 38 [511/1000 16352/32000 (51%)] Loss: 0.20487 (QuantReg: 13.46464) QuantErr: 13.46464 batch_time=1.82527 
Train Epoch: 38 [516/1000 16512/32000 (52%)] Loss: 0.38233 (QuantReg: 13.18617) QuantErr: 13.18617 batch_time=0.39980 
Train Epoch: 38 [521/1000 16672/32000 (52%)] Loss: 0.31185 (QuantReg: 13.01496) QuantErr: 13.01496 batch_time=0.55325 
Train Epoch: 38 [526/1000 16832/32000 (53%)] Loss: 0.35944 (QuantReg: 13.18486) QuantErr: 13.18486 batch_time=0.39043 
Train Epoch: 38 [531/1000 16992/32000 (53%)] Loss: 0.27458 (QuantReg: 12.91733) QuantErr: 12.91733 batch_time=0.37221 
Train Epoch: 38 [536/1000 17152/32000 (54%)] Loss: 0.43750 (QuantReg: 13.62710) QuantErr: 13.62710 batch_time=0.34997 
Train Epoch: 38 [541/1000 17312/32000 (54%)] Loss: 0.40619 (QuantReg: 12.64286) QuantErr: 12.64286 batch_time=0.34667 
Train Epoch: 38 [546/1000 17472/32000 (55%)] Loss: 0.30362 (QuantReg: 12.93195) QuantErr: 12.93195 batch_time=0.46108 
Train Epoch: 38 [551/1000 17632/32000 (55%)] Loss: 0.28336 (QuantReg: 13.25390) QuantErr: 13.25390 batch_time=0.33410 
Train Epoch: 38 [556/1000 17792/32000 (56%)] Loss: 0.23816 (QuantReg: 13.25787) QuantErr: 13.25787 batch_time=0.47679 
Train Epoch: 38 [561/1000 17952/32000 (56%)] Loss: 0.22528 (QuantReg: 12.84969) QuantErr: 12.84969 batch_time=0.36349 
Train Epoch: 38 [566/1000 18112/32000 (57%)] Loss: 0.48675 (QuantReg: 13.03010) QuantErr: 13.03010 batch_time=0.40541 
Train Epoch: 38 [571/1000 18272/32000 (57%)] Loss: 0.26266 (QuantReg: 13.46952) QuantErr: 13.46952 batch_time=0.79996 
Train Epoch: 38 [576/1000 18432/32000 (58%)] Loss: 0.36338 (QuantReg: 12.97342) QuantErr: 12.97342 batch_time=0.42665 
Train Epoch: 38 [581/1000 18592/32000 (58%)] Loss: 0.22641 (QuantReg: 13.54739) QuantErr: 13.54739 batch_time=0.45447 
Train Epoch: 38 [586/1000 18752/32000 (59%)] Loss: 0.28750 (QuantReg: 13.63644) QuantErr: 13.63644 batch_time=0.35060 
Train Epoch: 38 [591/1000 18912/32000 (59%)] Loss: 0.19668 (QuantReg: 12.72046) QuantErr: 12.72046 batch_time=0.34927 
Train Epoch: 38 [596/1000 19072/32000 (60%)] Loss: 0.41249 (QuantReg: 13.83808) QuantErr: 13.83808 batch_time=0.45911 
Train Epoch: 38 [601/1000 19232/32000 (60%)] Loss: 0.08811 (QuantReg: 13.58870) QuantErr: 13.58870 batch_time=0.37639 
Train Epoch: 38 [606/1000 19392/32000 (61%)] Loss: 0.19487 (QuantReg: 13.18001) QuantErr: 13.18001 batch_time=0.37663 
Train Epoch: 38 [611/1000 19552/32000 (61%)] Loss: 0.45731 (QuantReg: 12.89363) QuantErr: 12.89363 batch_time=0.48550 
Train Epoch: 38 [616/1000 19712/32000 (62%)] Loss: 0.14054 (QuantReg: 13.16083) QuantErr: 13.16083 batch_time=0.40719 
Train Epoch: 38 [621/1000 19872/32000 (62%)] Loss: 0.34499 (QuantReg: 13.64322) QuantErr: 13.64322 batch_time=0.70400 
Train Epoch: 38 [626/1000 20032/32000 (63%)] Loss: 0.09099 (QuantReg: 13.44079) QuantErr: 13.44079 batch_time=0.40038 
Train Epoch: 38 [631/1000 20192/32000 (63%)] Loss: 0.37650 (QuantReg: 12.75804) QuantErr: 12.75804 batch_time=0.31733 
Train Epoch: 38 [636/1000 20352/32000 (64%)] Loss: 0.33248 (QuantReg: 12.57128) QuantErr: 12.57128 batch_time=0.51044 
Train Epoch: 38 [641/1000 20512/32000 (64%)] Loss: 0.08627 (QuantReg: 13.55757) QuantErr: 13.55757 batch_time=0.36122 
Train Epoch: 38 [646/1000 20672/32000 (65%)] Loss: 0.39613 (QuantReg: 13.22381) QuantErr: 13.22381 batch_time=0.36043 
Train Epoch: 38 [651/1000 20832/32000 (65%)] Loss: 0.39108 (QuantReg: 12.92714) QuantErr: 12.92714 batch_time=0.35729 
Train Epoch: 38 [656/1000 20992/32000 (66%)] Loss: 0.19541 (QuantReg: 13.77352) QuantErr: 13.77352 batch_time=0.38557 
Train Epoch: 38 [661/1000 21152/32000 (66%)] Loss: 0.29430 (QuantReg: 12.98981) QuantErr: 12.98981 batch_time=0.35351 
Train Epoch: 38 [666/1000 21312/32000 (67%)] Loss: 0.44366 (QuantReg: 12.94046) QuantErr: 12.94046 batch_time=0.36189 
Train Epoch: 38 [671/1000 21472/32000 (67%)] Loss: 0.25036 (QuantReg: 13.27722) QuantErr: 13.27722 batch_time=0.86295 
Train Epoch: 38 [676/1000 21632/32000 (68%)] Loss: 0.32646 (QuantReg: 13.24233) QuantErr: 13.24233 batch_time=0.63576 
Train Epoch: 38 [681/1000 21792/32000 (68%)] Loss: 0.31777 (QuantReg: 13.44265) QuantErr: 13.44265 batch_time=0.44846 
Train Epoch: 38 [686/1000 21952/32000 (69%)] Loss: 0.44371 (QuantReg: 12.79696) QuantErr: 12.79696 batch_time=0.55108 
Train Epoch: 38 [691/1000 22112/32000 (69%)] Loss: 0.11616 (QuantReg: 13.49853) QuantErr: 13.49853 batch_time=0.34745 
Train Epoch: 38 [696/1000 22272/32000 (70%)] Loss: 0.18125 (QuantReg: 13.19228) QuantErr: 13.19228 batch_time=0.47412 
Train Epoch: 38 [701/1000 22432/32000 (70%)] Loss: 0.60966 (QuantReg: 12.37162) QuantErr: 12.37162 batch_time=0.35574 
Train Epoch: 38 [706/1000 22592/32000 (71%)] Loss: 0.15859 (QuantReg: 12.72274) QuantErr: 12.72274 batch_time=0.44159 
Train Epoch: 38 [711/1000 22752/32000 (71%)] Loss: 0.20760 (QuantReg: 12.84526) QuantErr: 12.84526 batch_time=0.44708 
Train Epoch: 38 [716/1000 22912/32000 (72%)] Loss: 0.35588 (QuantReg: 12.97379) QuantErr: 12.97379 batch_time=0.33253 
Train Epoch: 38 [721/1000 23072/32000 (72%)] Loss: 0.37692 (QuantReg: 12.87778) QuantErr: 12.87778 batch_time=0.75888 
Train Epoch: 38 [726/1000 23232/32000 (73%)] Loss: 0.23370 (QuantReg: 12.89273) QuantErr: 12.89273 batch_time=0.33436 
Train Epoch: 38 [731/1000 23392/32000 (73%)] Loss: 0.23810 (QuantReg: 13.02089) QuantErr: 13.02089 batch_time=0.35601 
Train Epoch: 38 [736/1000 23552/32000 (74%)] Loss: 0.33674 (QuantReg: 12.64902) QuantErr: 12.64902 batch_time=0.43325 
Train Epoch: 38 [741/1000 23712/32000 (74%)] Loss: 0.13095 (QuantReg: 13.32010) QuantErr: 13.32010 batch_time=0.35314 
Train Epoch: 38 [746/1000 23872/32000 (75%)] Loss: 0.13713 (QuantReg: 13.32459) QuantErr: 13.32459 batch_time=0.37588 
Train Epoch: 38 [751/1000 24032/32000 (75%)] Loss: 0.46602 (QuantReg: 12.96319) QuantErr: 12.96319 batch_time=0.35146 
Train Epoch: 38 [756/1000 24192/32000 (76%)] Loss: 0.33828 (QuantReg: 12.69078) QuantErr: 12.69078 batch_time=0.38840 
Train Epoch: 38 [761/1000 24352/32000 (76%)] Loss: 0.22066 (QuantReg: 13.41899) QuantErr: 13.41899 batch_time=0.34479 
Train Epoch: 38 [766/1000 24512/32000 (77%)] Loss: 0.23118 (QuantReg: 12.75194) QuantErr: 12.75194 batch_time=0.35808 
Train Epoch: 38 [771/1000 24672/32000 (77%)] Loss: 0.22572 (QuantReg: 13.30535) QuantErr: 13.30535 batch_time=0.51653 
Train Epoch: 38 [776/1000 24832/32000 (78%)] Loss: 0.17932 (QuantReg: 13.00951) QuantErr: 13.00951 batch_time=0.36213 
Train Epoch: 38 [781/1000 24992/32000 (78%)] Loss: 0.29639 (QuantReg: 13.11437) QuantErr: 13.11437 batch_time=0.35384 
Train Epoch: 38 [786/1000 25152/32000 (79%)] Loss: 0.17236 (QuantReg: 12.81647) QuantErr: 12.81647 batch_time=0.98273 
Train Epoch: 38 [791/1000 25312/32000 (79%)] Loss: 0.59739 (QuantReg: 12.23879) QuantErr: 12.23879 batch_time=0.38599 
Train Epoch: 38 [796/1000 25472/32000 (80%)] Loss: 0.31619 (QuantReg: 13.54773) QuantErr: 13.54773 batch_time=0.38229 
Train Epoch: 38 [801/1000 25632/32000 (80%)] Loss: 0.72279 (QuantReg: 13.02755) QuantErr: 13.02755 batch_time=0.39755 
Train Epoch: 38 [806/1000 25792/32000 (81%)] Loss: 0.42137 (QuantReg: 12.96982) QuantErr: 12.96982 batch_time=0.42209 
Train Epoch: 38 [811/1000 25952/32000 (81%)] Loss: 0.46587 (QuantReg: 13.17013) QuantErr: 13.17013 batch_time=0.41342 
Train Epoch: 38 [816/1000 26112/32000 (82%)] Loss: 0.54065 (QuantReg: 13.08942) QuantErr: 13.08942 batch_time=0.36516 
Train Epoch: 38 [821/1000 26272/32000 (82%)] Loss: 0.39651 (QuantReg: 12.87600) QuantErr: 12.87600 batch_time=0.70785 
Train Epoch: 38 [826/1000 26432/32000 (83%)] Loss: 0.20401 (QuantReg: 12.95793) QuantErr: 12.95793 batch_time=0.36491 
Train Epoch: 38 [831/1000 26592/32000 (83%)] Loss: 0.41364 (QuantReg: 13.18440) QuantErr: 13.18440 batch_time=1.61609 
Train Epoch: 38 [836/1000 26752/32000 (84%)] Loss: 0.26541 (QuantReg: 13.11030) QuantErr: 13.11030 batch_time=0.35767 
Train Epoch: 38 [841/1000 26912/32000 (84%)] Loss: 0.27528 (QuantReg: 12.59469) QuantErr: 12.59469 batch_time=0.47234 
Train Epoch: 38 [846/1000 27072/32000 (85%)] Loss: 0.41524 (QuantReg: 13.76174) QuantErr: 13.76174 batch_time=0.35732 
Train Epoch: 38 [851/1000 27232/32000 (85%)] Loss: 0.37878 (QuantReg: 13.32258) QuantErr: 13.32258 batch_time=0.40767 
Train Epoch: 38 [856/1000 27392/32000 (86%)] Loss: 0.18346 (QuantReg: 12.53857) QuantErr: 12.53857 batch_time=0.36289 
Train Epoch: 38 [861/1000 27552/32000 (86%)] Loss: 0.25546 (QuantReg: 13.54135) QuantErr: 13.54135 batch_time=0.55891 
Train Epoch: 38 [866/1000 27712/32000 (87%)] Loss: 0.29060 (QuantReg: 13.06794) QuantErr: 13.06794 batch_time=0.34446 
Train Epoch: 38 [871/1000 27872/32000 (87%)] Loss: 0.22494 (QuantReg: 12.52751) QuantErr: 12.52751 batch_time=0.74221 
Train Epoch: 38 [876/1000 28032/32000 (88%)] Loss: 0.43165 (QuantReg: 12.18801) QuantErr: 12.18801 batch_time=0.36277 
Train Epoch: 38 [881/1000 28192/32000 (88%)] Loss: 0.08258 (QuantReg: 12.94975) QuantErr: 12.94975 batch_time=0.52374 
Train Epoch: 38 [886/1000 28352/32000 (89%)] Loss: 0.25660 (QuantReg: 12.69550) QuantErr: 12.69550 batch_time=0.49169 
Train Epoch: 38 [891/1000 28512/32000 (89%)] Loss: 0.78267 (QuantReg: 12.38797) QuantErr: 12.38797 batch_time=0.34869 
Train Epoch: 38 [896/1000 28672/32000 (90%)] Loss: 0.19675 (QuantReg: 12.97008) QuantErr: 12.97008 batch_time=0.42048 
Train Epoch: 38 [901/1000 28832/32000 (90%)] Loss: 0.31228 (QuantReg: 13.11982) QuantErr: 13.11982 batch_time=0.36004 
Train Epoch: 38 [906/1000 28992/32000 (91%)] Loss: 0.38996 (QuantReg: 13.45295) QuantErr: 13.45295 batch_time=0.38341 
Train Epoch: 38 [911/1000 29152/32000 (91%)] Loss: 0.33218 (QuantReg: 13.77918) QuantErr: 13.77918 batch_time=0.36555 
Train Epoch: 38 [916/1000 29312/32000 (92%)] Loss: 0.65976 (QuantReg: 13.69721) QuantErr: 13.69721 batch_time=0.47038 
Train Epoch: 38 [921/1000 29472/32000 (92%)] Loss: 0.18078 (QuantReg: 13.63972) QuantErr: 13.63972 batch_time=0.59538 
Train Epoch: 38 [926/1000 29632/32000 (93%)] Loss: 0.24418 (QuantReg: 13.18987) QuantErr: 13.18987 batch_time=0.33198 
Train Epoch: 38 [931/1000 29792/32000 (93%)] Loss: 0.29654 (QuantReg: 13.77989) QuantErr: 13.77989 batch_time=0.45308 
Train Epoch: 38 [936/1000 29952/32000 (94%)] Loss: 0.31462 (QuantReg: 13.02166) QuantErr: 13.02166 batch_time=0.39538 
Train Epoch: 38 [941/1000 30112/32000 (94%)] Loss: 0.55926 (QuantReg: 13.66627) QuantErr: 13.66627 batch_time=0.40350 
Train Epoch: 38 [946/1000 30272/32000 (95%)] Loss: 0.44802 (QuantReg: 12.81527) QuantErr: 12.81527 batch_time=0.35022 
Train Epoch: 38 [951/1000 30432/32000 (95%)] Loss: 0.81529 (QuantReg: 13.67530) QuantErr: 13.67530 batch_time=0.44112 
Train Epoch: 38 [956/1000 30592/32000 (96%)] Loss: 0.27543 (QuantReg: 12.94124) QuantErr: 12.94124 batch_time=0.45768 
Train Epoch: 38 [961/1000 30752/32000 (96%)] Loss: 0.44009 (QuantReg: 12.83109) QuantErr: 12.83109 batch_time=0.36674 
Train Epoch: 38 [966/1000 30912/32000 (97%)] Loss: 0.10929 (QuantReg: 12.69472) QuantErr: 12.69472 batch_time=0.68274 
Train Epoch: 38 [971/1000 31072/32000 (97%)] Loss: 0.26496 (QuantReg: 13.21208) QuantErr: 13.21208 batch_time=0.40707 
Train Epoch: 38 [976/1000 31232/32000 (98%)] Loss: 0.41975 (QuantReg: 12.46297) QuantErr: 12.46297 batch_time=0.34571 
Train Epoch: 38 [981/1000 31392/32000 (98%)] Loss: 0.25889 (QuantReg: 13.07265) QuantErr: 13.07265 batch_time=0.33358 
Train Epoch: 38 [986/1000 31552/32000 (99%)] Loss: 0.23990 (QuantReg: 13.44918) QuantErr: 13.44918 batch_time=0.34173 
Train Epoch: 38 [991/1000 31712/32000 (99%)] Loss: 0.10576 (QuantReg: 13.14087) QuantErr: 13.14087 batch_time=0.58936 
Train Epoch: 38 [996/1000 31872/32000 (100%)] Loss: 0.82342 (QuantReg: 12.87939) QuantErr: 12.87939 batch_time=0.33839 
Train Epoch: 38 codebook_update_time=1.87100
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch38.pth ...
Done in 4.852s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 0.33828530276566743
 quant_reg      : 13.089193881988525
 quant_err      : 13.089193881988525
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 38000
 MSRVTT_miech_test/t2v_metrics/R1: 21.1
 MSRVTT_miech_test/t2v_metrics/R5: 49.8
 MSRVTT_miech_test/t2v_metrics/R10: 64.2
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.57
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.70823522805125
 MSRVTT_miech_test/v2t_metrics/R1: 20.3
 MSRVTT_miech_test/v2t_metrics/R5: 51.6
 MSRVTT_miech_test/v2t_metrics/R10: 64.7
 MSRVTT_miech_test/v2t_metrics/R50: 89.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.3
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.770872617104224
 mnt_best       : 41.036608587691525
 not_improved_count: 4
Train Epoch: 39 [1/1000 32/32000 (0%)] Loss: 0.31904 (QuantReg: 12.90123) QuantErr: 12.90123 batch_time=28.48360 
Train Epoch: 39 [6/1000 192/32000 (1%)] Loss: 0.37967 (QuantReg: 12.94924) QuantErr: 12.94924 batch_time=0.37261 
Train Epoch: 39 [11/1000 352/32000 (1%)] Loss: 0.30029 (QuantReg: 13.04935) QuantErr: 13.04935 batch_time=0.33787 
Train Epoch: 39 [16/1000 512/32000 (2%)] Loss: 0.28723 (QuantReg: 13.98156) QuantErr: 13.98156 batch_time=0.43766 
Train Epoch: 39 [21/1000 672/32000 (2%)] Loss: 0.36300 (QuantReg: 12.80655) QuantErr: 12.80655 batch_time=0.47849 
Train Epoch: 39 [26/1000 832/32000 (3%)] Loss: 0.27499 (QuantReg: 13.46656) QuantErr: 13.46656 batch_time=0.41079 
Train Epoch: 39 [31/1000 992/32000 (3%)] Loss: 0.59711 (QuantReg: 13.13757) QuantErr: 13.13757 batch_time=0.32988 
Train Epoch: 39 [36/1000 1152/32000 (4%)] Loss: 0.52832 (QuantReg: 13.14655) QuantErr: 13.14655 batch_time=0.43862 
Train Epoch: 39 [41/1000 1312/32000 (4%)] Loss: 0.41347 (QuantReg: 12.92139) QuantErr: 12.92139 batch_time=0.34407 
Train Epoch: 39 [46/1000 1472/32000 (5%)] Loss: 0.22292 (QuantReg: 13.26234) QuantErr: 13.26234 batch_time=0.34416 
Train Epoch: 39 [51/1000 1632/32000 (5%)] Loss: 0.18793 (QuantReg: 13.52372) QuantErr: 13.52372 batch_time=0.36495 
Train Epoch: 39 [56/1000 1792/32000 (6%)] Loss: 0.54083 (QuantReg: 12.41901) QuantErr: 12.41901 batch_time=0.68626 
Train Epoch: 39 [61/1000 1952/32000 (6%)] Loss: 0.23882 (QuantReg: 12.90730) QuantErr: 12.90730 batch_time=0.51991 
Train Epoch: 39 [66/1000 2112/32000 (7%)] Loss: 0.05697 (QuantReg: 13.26103) QuantErr: 13.26103 batch_time=2.28889 
Train Epoch: 39 [71/1000 2272/32000 (7%)] Loss: 0.46662 (QuantReg: 12.94814) QuantErr: 12.94814 batch_time=0.35665 
Train Epoch: 39 [76/1000 2432/32000 (8%)] Loss: 0.44258 (QuantReg: 12.93786) QuantErr: 12.93786 batch_time=0.39656 
Train Epoch: 39 [81/1000 2592/32000 (8%)] Loss: 0.52540 (QuantReg: 12.75590) QuantErr: 12.75590 batch_time=0.34553 
Train Epoch: 39 [86/1000 2752/32000 (9%)] Loss: 0.25929 (QuantReg: 13.27790) QuantErr: 13.27790 batch_time=0.34525 
Train Epoch: 39 [91/1000 2912/32000 (9%)] Loss: 0.46045 (QuantReg: 12.62535) QuantErr: 12.62535 batch_time=0.38048 
Train Epoch: 39 [96/1000 3072/32000 (10%)] Loss: 0.32408 (QuantReg: 13.87022) QuantErr: 13.87022 batch_time=0.45134 
Train Epoch: 39 [101/1000 3232/32000 (10%)] Loss: 0.26462 (QuantReg: 13.02557) QuantErr: 13.02557 batch_time=0.42378 
Train Epoch: 39 [106/1000 3392/32000 (11%)] Loss: 0.24810 (QuantReg: 12.90764) QuantErr: 12.90764 batch_time=0.56993 
Train Epoch: 39 [111/1000 3552/32000 (11%)] Loss: 0.47984 (QuantReg: 13.64642) QuantErr: 13.64642 batch_time=0.56941 
Train Epoch: 39 [116/1000 3712/32000 (12%)] Loss: 0.36925 (QuantReg: 12.76690) QuantErr: 12.76690 batch_time=0.37227 
Train Epoch: 39 [121/1000 3872/32000 (12%)] Loss: 0.37570 (QuantReg: 12.97384) QuantErr: 12.97384 batch_time=0.39177 
Train Epoch: 39 [126/1000 4032/32000 (13%)] Loss: 0.26361 (QuantReg: 12.39797) QuantErr: 12.39797 batch_time=0.36383 
Train Epoch: 39 [131/1000 4192/32000 (13%)] Loss: 0.13851 (QuantReg: 12.55066) QuantErr: 12.55066 batch_time=0.37027 
Train Epoch: 39 [136/1000 4352/32000 (14%)] Loss: 0.56797 (QuantReg: 12.86744) QuantErr: 12.86744 batch_time=0.44849 
Train Epoch: 39 [141/1000 4512/32000 (14%)] Loss: 0.28239 (QuantReg: 13.12971) QuantErr: 13.12971 batch_time=0.35564 
Train Epoch: 39 [146/1000 4672/32000 (15%)] Loss: 0.41983 (QuantReg: 13.22036) QuantErr: 13.22036 batch_time=0.47733 
Train Epoch: 39 [151/1000 4832/32000 (15%)] Loss: 0.46947 (QuantReg: 13.48094) QuantErr: 13.48094 batch_time=0.34033 
Train Epoch: 39 [156/1000 4992/32000 (16%)] Loss: 0.38905 (QuantReg: 13.89468) QuantErr: 13.89468 batch_time=0.58664 
Train Epoch: 39 [161/1000 5152/32000 (16%)] Loss: 0.19139 (QuantReg: 12.62140) QuantErr: 12.62140 batch_time=0.49286 
Train Epoch: 39 [166/1000 5312/32000 (17%)] Loss: 0.84007 (QuantReg: 12.50628) QuantErr: 12.50628 batch_time=0.39155 
Train Epoch: 39 [171/1000 5472/32000 (17%)] Loss: 0.35556 (QuantReg: 13.65874) QuantErr: 13.65874 batch_time=0.36310 
Train Epoch: 39 [176/1000 5632/32000 (18%)] Loss: 0.36418 (QuantReg: 13.06263) QuantErr: 13.06263 batch_time=0.35006 
Train Epoch: 39 [181/1000 5792/32000 (18%)] Loss: 0.27265 (QuantReg: 12.81012) QuantErr: 12.81012 batch_time=0.40617 
Train Epoch: 39 [186/1000 5952/32000 (19%)] Loss: 0.05924 (QuantReg: 12.82407) QuantErr: 12.82407 batch_time=0.45203 
Train Epoch: 39 [191/1000 6112/32000 (19%)] Loss: 0.26911 (QuantReg: 12.92656) QuantErr: 12.92656 batch_time=0.45570 
Train Epoch: 39 [196/1000 6272/32000 (20%)] Loss: 0.27153 (QuantReg: 13.54225) QuantErr: 13.54225 batch_time=0.40389 
Train Epoch: 39 [201/1000 6432/32000 (20%)] Loss: 0.19583 (QuantReg: 13.43523) QuantErr: 13.43523 batch_time=0.34529 
Train Epoch: 39 [206/1000 6592/32000 (21%)] Loss: 0.45102 (QuantReg: 12.91373) QuantErr: 12.91373 batch_time=0.72226 
Train Epoch: 39 [211/1000 6752/32000 (21%)] Loss: 0.49817 (QuantReg: 12.30781) QuantErr: 12.30781 batch_time=0.67708 
Train Epoch: 39 [216/1000 6912/32000 (22%)] Loss: 0.18244 (QuantReg: 13.46163) QuantErr: 13.46163 batch_time=0.37182 
Train Epoch: 39 [221/1000 7072/32000 (22%)] Loss: 0.42063 (QuantReg: 13.23659) QuantErr: 13.23659 batch_time=0.33565 
Train Epoch: 39 [226/1000 7232/32000 (23%)] Loss: 0.35186 (QuantReg: 13.37799) QuantErr: 13.37799 batch_time=0.40058 
Train Epoch: 39 [231/1000 7392/32000 (23%)] Loss: 0.37633 (QuantReg: 13.50509) QuantErr: 13.50509 batch_time=0.37627 
Train Epoch: 39 [236/1000 7552/32000 (24%)] Loss: 0.34183 (QuantReg: 13.40313) QuantErr: 13.40313 batch_time=0.37130 
Train Epoch: 39 [241/1000 7712/32000 (24%)] Loss: 0.27666 (QuantReg: 13.52590) QuantErr: 13.52590 batch_time=0.35373 
Train Epoch: 39 [246/1000 7872/32000 (25%)] Loss: 0.29146 (QuantReg: 13.14669) QuantErr: 13.14669 batch_time=0.37877 
Train Epoch: 39 [251/1000 8032/32000 (25%)] Loss: 0.51718 (QuantReg: 13.11352) QuantErr: 13.11352 batch_time=0.44119 
Train Epoch: 39 [256/1000 8192/32000 (26%)] Loss: 0.15698 (QuantReg: 13.50500) QuantErr: 13.50500 batch_time=0.62269 
Train Epoch: 39 [261/1000 8352/32000 (26%)] Loss: 0.25120 (QuantReg: 12.96528) QuantErr: 12.96528 batch_time=0.39764 
Train Epoch: 39 [266/1000 8512/32000 (27%)] Loss: 0.19209 (QuantReg: 13.16115) QuantErr: 13.16115 batch_time=0.59043 
Train Epoch: 39 [271/1000 8672/32000 (27%)] Loss: 0.32150 (QuantReg: 12.50931) QuantErr: 12.50931 batch_time=0.34819 
Train Epoch: 39 [276/1000 8832/32000 (28%)] Loss: 0.23736 (QuantReg: 13.54138) QuantErr: 13.54138 batch_time=0.35382 
Train Epoch: 39 [281/1000 8992/32000 (28%)] Loss: 0.15489 (QuantReg: 13.17595) QuantErr: 13.17595 batch_time=0.41625 
Train Epoch: 39 [286/1000 9152/32000 (29%)] Loss: 0.50486 (QuantReg: 13.34582) QuantErr: 13.34582 batch_time=0.39979 
Train Epoch: 39 [291/1000 9312/32000 (29%)] Loss: 0.31889 (QuantReg: 12.92132) QuantErr: 12.92132 batch_time=0.38526 
Train Epoch: 39 [296/1000 9472/32000 (30%)] Loss: 0.32193 (QuantReg: 13.34767) QuantErr: 13.34767 batch_time=0.71658 
Train Epoch: 39 [301/1000 9632/32000 (30%)] Loss: 0.82725 (QuantReg: 13.23196) QuantErr: 13.23196 batch_time=1.75562 
Train Epoch: 39 [306/1000 9792/32000 (31%)] Loss: 0.19178 (QuantReg: 12.98470) QuantErr: 12.98470 batch_time=0.43188 
Train Epoch: 39 [311/1000 9952/32000 (31%)] Loss: 0.38597 (QuantReg: 13.70151) QuantErr: 13.70151 batch_time=0.39082 
Train Epoch: 39 [316/1000 10112/32000 (32%)] Loss: 0.31988 (QuantReg: 12.56005) QuantErr: 12.56005 batch_time=0.38592 
Train Epoch: 39 [321/1000 10272/32000 (32%)] Loss: 0.33378 (QuantReg: 12.86764) QuantErr: 12.86764 batch_time=0.35906 
Train Epoch: 39 [326/1000 10432/32000 (33%)] Loss: 0.20647 (QuantReg: 13.13061) QuantErr: 13.13061 batch_time=0.45395 
Train Epoch: 39 [331/1000 10592/32000 (33%)] Loss: 0.23105 (QuantReg: 12.81028) QuantErr: 12.81028 batch_time=0.47058 
Train Epoch: 39 [336/1000 10752/32000 (34%)] Loss: 0.25977 (QuantReg: 12.62871) QuantErr: 12.62871 batch_time=0.37579 
Train Epoch: 39 [341/1000 10912/32000 (34%)] Loss: 0.08846 (QuantReg: 12.83896) QuantErr: 12.83896 batch_time=0.35607 
Train Epoch: 39 [346/1000 11072/32000 (35%)] Loss: 0.31609 (QuantReg: 13.57724) QuantErr: 13.57724 batch_time=0.53795 
Train Epoch: 39 [351/1000 11232/32000 (35%)] Loss: 0.36362 (QuantReg: 12.66272) QuantErr: 12.66272 batch_time=0.32511 
Train Epoch: 39 [356/1000 11392/32000 (36%)] Loss: 0.23793 (QuantReg: 13.10524) QuantErr: 13.10524 batch_time=0.42369 
Train Epoch: 39 [361/1000 11552/32000 (36%)] Loss: 0.33154 (QuantReg: 13.28091) QuantErr: 13.28091 batch_time=0.38785 
Train Epoch: 39 [366/1000 11712/32000 (37%)] Loss: 0.26567 (QuantReg: 13.88678) QuantErr: 13.88678 batch_time=0.50487 
Train Epoch: 39 [371/1000 11872/32000 (37%)] Loss: 0.28407 (QuantReg: 12.93034) QuantErr: 12.93034 batch_time=0.42944 
Train Epoch: 39 [376/1000 12032/32000 (38%)] Loss: 0.07994 (QuantReg: 13.73903) QuantErr: 13.73903 batch_time=0.35006 
Train Epoch: 39 [381/1000 12192/32000 (38%)] Loss: 0.39195 (QuantReg: 12.86263) QuantErr: 12.86263 batch_time=0.36232 
Train Epoch: 39 [386/1000 12352/32000 (39%)] Loss: 0.26127 (QuantReg: 13.37320) QuantErr: 13.37320 batch_time=0.96798 
Train Epoch: 39 [391/1000 12512/32000 (39%)] Loss: 0.14641 (QuantReg: 12.96688) QuantErr: 12.96688 batch_time=0.40541 
Train Epoch: 39 [396/1000 12672/32000 (40%)] Loss: 0.14875 (QuantReg: 13.15395) QuantErr: 13.15395 batch_time=0.54240 
Train Epoch: 39 [401/1000 12832/32000 (40%)] Loss: 0.28058 (QuantReg: 12.76157) QuantErr: 12.76157 batch_time=0.33829 
Train Epoch: 39 [406/1000 12992/32000 (41%)] Loss: 0.11228 (QuantReg: 12.98256) QuantErr: 12.98256 batch_time=0.50552 
Train Epoch: 39 [411/1000 13152/32000 (41%)] Loss: 0.30624 (QuantReg: 13.29375) QuantErr: 13.29375 batch_time=0.40291 
Train Epoch: 39 [416/1000 13312/32000 (42%)] Loss: 0.51614 (QuantReg: 13.51296) QuantErr: 13.51296 batch_time=0.35473 
Train Epoch: 39 [421/1000 13472/32000 (42%)] Loss: 0.37126 (QuantReg: 13.55020) QuantErr: 13.55020 batch_time=0.47099 
Train Epoch: 39 [426/1000 13632/32000 (43%)] Loss: 0.64610 (QuantReg: 12.56789) QuantErr: 12.56789 batch_time=0.35631 
Train Epoch: 39 [431/1000 13792/32000 (43%)] Loss: 0.63553 (QuantReg: 12.55339) QuantErr: 12.55339 batch_time=0.41969 
Train Epoch: 39 [436/1000 13952/32000 (44%)] Loss: 0.39390 (QuantReg: 12.94202) QuantErr: 12.94202 batch_time=0.47400 
Train Epoch: 39 [441/1000 14112/32000 (44%)] Loss: 0.39983 (QuantReg: 13.10622) QuantErr: 13.10622 batch_time=0.36988 
Train Epoch: 39 [446/1000 14272/32000 (45%)] Loss: 0.23685 (QuantReg: 13.60919) QuantErr: 13.60919 batch_time=0.38549 
Train Epoch: 39 [451/1000 14432/32000 (45%)] Loss: 0.63307 (QuantReg: 12.80964) QuantErr: 12.80964 batch_time=0.34007 
Train Epoch: 39 [456/1000 14592/32000 (46%)] Loss: 0.32815 (QuantReg: 13.73443) QuantErr: 13.73443 batch_time=0.47626 
Train Epoch: 39 [461/1000 14752/32000 (46%)] Loss: 0.40355 (QuantReg: 13.26335) QuantErr: 13.26335 batch_time=0.34806 
Train Epoch: 39 [466/1000 14912/32000 (47%)] Loss: 0.32450 (QuantReg: 12.47898) QuantErr: 12.47898 batch_time=0.54683 
Train Epoch: 39 [471/1000 15072/32000 (47%)] Loss: 0.75762 (QuantReg: 12.53701) QuantErr: 12.53701 batch_time=0.42482 
Train Epoch: 39 [476/1000 15232/32000 (48%)] Loss: 0.97019 (QuantReg: 12.40084) QuantErr: 12.40084 batch_time=0.35330 
Train Epoch: 39 [481/1000 15392/32000 (48%)] Loss: 0.32042 (QuantReg: 12.49066) QuantErr: 12.49066 batch_time=0.33582 
Train Epoch: 39 [486/1000 15552/32000 (49%)] Loss: 0.30858 (QuantReg: 13.31278) QuantErr: 13.31278 batch_time=0.39193 
Train Epoch: 39 [491/1000 15712/32000 (49%)] Loss: 0.24735 (QuantReg: 13.47422) QuantErr: 13.47422 batch_time=0.36175 
Train Epoch: 39 [496/1000 15872/32000 (50%)] Loss: 0.30691 (QuantReg: 13.39313) QuantErr: 13.39313 batch_time=0.45506 
Train Epoch: 39 [501/1000 16032/32000 (50%)] Loss: 0.30176 (QuantReg: 13.17297) QuantErr: 13.17297 batch_time=0.37733 
Train Epoch: 39 [506/1000 16192/32000 (51%)] Loss: 0.61554 (QuantReg: 13.12061) QuantErr: 13.12061 batch_time=0.55426 
Train Epoch: 39 [511/1000 16352/32000 (51%)] Loss: 0.25692 (QuantReg: 13.28820) QuantErr: 13.28820 batch_time=0.39187 
Train Epoch: 39 [516/1000 16512/32000 (52%)] Loss: 0.38647 (QuantReg: 13.03300) QuantErr: 13.03300 batch_time=0.34678 
Train Epoch: 39 [521/1000 16672/32000 (52%)] Loss: 0.34565 (QuantReg: 13.44723) QuantErr: 13.44723 batch_time=0.38042 
Train Epoch: 39 [526/1000 16832/32000 (53%)] Loss: 0.27055 (QuantReg: 13.05517) QuantErr: 13.05517 batch_time=0.34075 
Train Epoch: 39 [531/1000 16992/32000 (53%)] Loss: 0.17881 (QuantReg: 13.24158) QuantErr: 13.24158 batch_time=0.76151 
Train Epoch: 39 [536/1000 17152/32000 (54%)] Loss: 0.30221 (QuantReg: 12.89529) QuantErr: 12.89529 batch_time=0.46197 
Train Epoch: 39 [541/1000 17312/32000 (54%)] Loss: 0.31784 (QuantReg: 13.37305) QuantErr: 13.37305 batch_time=0.40292 
Train Epoch: 39 [546/1000 17472/32000 (55%)] Loss: 0.20534 (QuantReg: 13.24660) QuantErr: 13.24660 batch_time=0.58900 
Train Epoch: 39 [551/1000 17632/32000 (55%)] Loss: 0.22269 (QuantReg: 13.47334) QuantErr: 13.47334 batch_time=0.36321 
Train Epoch: 39 [556/1000 17792/32000 (56%)] Loss: 0.42702 (QuantReg: 13.30073) QuantErr: 13.30073 batch_time=0.65606 
Train Epoch: 39 [561/1000 17952/32000 (56%)] Loss: 0.65012 (QuantReg: 12.88602) QuantErr: 12.88602 batch_time=0.37798 
Train Epoch: 39 [566/1000 18112/32000 (57%)] Loss: 0.19034 (QuantReg: 13.50700) QuantErr: 13.50700 batch_time=0.45940 
Train Epoch: 39 [571/1000 18272/32000 (57%)] Loss: 0.40568 (QuantReg: 13.16347) QuantErr: 13.16347 batch_time=0.38785 
Train Epoch: 39 [576/1000 18432/32000 (58%)] Loss: 0.30573 (QuantReg: 12.64556) QuantErr: 12.64556 batch_time=0.34747 
Train Epoch: 39 [581/1000 18592/32000 (58%)] Loss: 0.45484 (QuantReg: 12.33955) QuantErr: 12.33955 batch_time=0.41555 
Train Epoch: 39 [586/1000 18752/32000 (59%)] Loss: 0.28304 (QuantReg: 13.05083) QuantErr: 13.05083 batch_time=0.37361 
Train Epoch: 39 [591/1000 18912/32000 (59%)] Loss: 0.47111 (QuantReg: 13.34640) QuantErr: 13.34640 batch_time=0.37070 
Train Epoch: 39 [596/1000 19072/32000 (60%)] Loss: 0.15291 (QuantReg: 13.19602) QuantErr: 13.19602 batch_time=0.35362 
Train Epoch: 39 [601/1000 19232/32000 (60%)] Loss: 0.22287 (QuantReg: 12.84343) QuantErr: 12.84343 batch_time=0.36045 
Train Epoch: 39 [606/1000 19392/32000 (61%)] Loss: 0.28137 (QuantReg: 12.71426) QuantErr: 12.71426 batch_time=0.79381 
Train Epoch: 39 [611/1000 19552/32000 (61%)] Loss: 0.23602 (QuantReg: 13.23733) QuantErr: 13.23733 batch_time=0.42489 
Train Epoch: 39 [616/1000 19712/32000 (62%)] Loss: 0.17491 (QuantReg: 13.37996) QuantErr: 13.37996 batch_time=0.39468 
Train Epoch: 39 [621/1000 19872/32000 (62%)] Loss: 0.35510 (QuantReg: 13.44684) QuantErr: 13.44684 batch_time=1.53284 
Train Epoch: 39 [626/1000 20032/32000 (63%)] Loss: 0.24016 (QuantReg: 12.80472) QuantErr: 12.80472 batch_time=0.40691 
Train Epoch: 39 [631/1000 20192/32000 (63%)] Loss: 0.16994 (QuantReg: 13.49131) QuantErr: 13.49131 batch_time=0.48574 
Train Epoch: 39 [636/1000 20352/32000 (64%)] Loss: 0.49236 (QuantReg: 13.16913) QuantErr: 13.16913 batch_time=0.34260 
Train Epoch: 39 [641/1000 20512/32000 (64%)] Loss: 0.25436 (QuantReg: 12.92880) QuantErr: 12.92880 batch_time=0.35501 
Train Epoch: 39 [646/1000 20672/32000 (65%)] Loss: 0.20673 (QuantReg: 13.53223) QuantErr: 13.53223 batch_time=0.33926 
Train Epoch: 39 [651/1000 20832/32000 (65%)] Loss: 0.14286 (QuantReg: 13.13192) QuantErr: 13.13192 batch_time=0.37399 
Train Epoch: 39 [656/1000 20992/32000 (66%)] Loss: 0.31660 (QuantReg: 13.63016) QuantErr: 13.63016 batch_time=0.47024 
Train Epoch: 39 [661/1000 21152/32000 (66%)] Loss: 0.37461 (QuantReg: 13.53428) QuantErr: 13.53428 batch_time=0.43204 
Train Epoch: 39 [666/1000 21312/32000 (67%)] Loss: 0.33510 (QuantReg: 13.22789) QuantErr: 13.22789 batch_time=0.38214 
Train Epoch: 39 [671/1000 21472/32000 (67%)] Loss: 0.14790 (QuantReg: 13.58278) QuantErr: 13.58278 batch_time=0.41251 
Train Epoch: 39 [676/1000 21632/32000 (68%)] Loss: 0.26292 (QuantReg: 12.30810) QuantErr: 12.30810 batch_time=0.34862 
Train Epoch: 39 [681/1000 21792/32000 (68%)] Loss: 0.14393 (QuantReg: 13.49708) QuantErr: 13.49708 batch_time=0.40682 
Train Epoch: 39 [686/1000 21952/32000 (69%)] Loss: 0.26041 (QuantReg: 12.75799) QuantErr: 12.75799 batch_time=0.38566 
Train Epoch: 39 [691/1000 22112/32000 (69%)] Loss: 0.57995 (QuantReg: 13.76610) QuantErr: 13.76610 batch_time=0.35833 
Train Epoch: 39 [696/1000 22272/32000 (70%)] Loss: 0.30855 (QuantReg: 13.03117) QuantErr: 13.03117 batch_time=0.38829 
Train Epoch: 39 [701/1000 22432/32000 (70%)] Loss: 0.08448 (QuantReg: 13.54070) QuantErr: 13.54070 batch_time=0.35578 
Train Epoch: 39 [706/1000 22592/32000 (71%)] Loss: 0.26383 (QuantReg: 13.25843) QuantErr: 13.25843 batch_time=1.49880 
Train Epoch: 39 [711/1000 22752/32000 (71%)] Loss: 0.12070 (QuantReg: 12.93445) QuantErr: 12.93445 batch_time=0.43707 
Train Epoch: 39 [716/1000 22912/32000 (72%)] Loss: 0.34192 (QuantReg: 13.43368) QuantErr: 13.43368 batch_time=0.41795 
Train Epoch: 39 [721/1000 23072/32000 (72%)] Loss: 0.38447 (QuantReg: 13.30571) QuantErr: 13.30571 batch_time=0.35629 
Train Epoch: 39 [726/1000 23232/32000 (73%)] Loss: 0.34650 (QuantReg: 12.76743) QuantErr: 12.76743 batch_time=0.35351 
Train Epoch: 39 [731/1000 23392/32000 (73%)] Loss: 0.52157 (QuantReg: 12.86212) QuantErr: 12.86212 batch_time=0.35611 
Train Epoch: 39 [736/1000 23552/32000 (74%)] Loss: 0.19163 (QuantReg: 13.32480) QuantErr: 13.32480 batch_time=0.35063 
Train Epoch: 39 [741/1000 23712/32000 (74%)] Loss: 0.49671 (QuantReg: 13.26291) QuantErr: 13.26291 batch_time=0.43151 
Train Epoch: 39 [746/1000 23872/32000 (75%)] Loss: 0.32377 (QuantReg: 12.98245) QuantErr: 12.98245 batch_time=0.38289 
Train Epoch: 39 [751/1000 24032/32000 (75%)] Loss: 0.20399 (QuantReg: 13.83260) QuantErr: 13.83260 batch_time=0.36501 
Train Epoch: 39 [756/1000 24192/32000 (76%)] Loss: 0.22398 (QuantReg: 13.14612) QuantErr: 13.14612 batch_time=0.37872 
Train Epoch: 39 [761/1000 24352/32000 (76%)] Loss: 0.38485 (QuantReg: 12.49494) QuantErr: 12.49494 batch_time=0.39196 
Train Epoch: 39 [766/1000 24512/32000 (77%)] Loss: 0.41085 (QuantReg: 13.45868) QuantErr: 13.45868 batch_time=0.44023 
Train Epoch: 39 [771/1000 24672/32000 (77%)] Loss: 0.35354 (QuantReg: 12.82076) QuantErr: 12.82076 batch_time=0.49597 
Train Epoch: 39 [776/1000 24832/32000 (78%)] Loss: 0.45894 (QuantReg: 13.15819) QuantErr: 13.15819 batch_time=0.38632 
Train Epoch: 39 [781/1000 24992/32000 (78%)] Loss: 0.59502 (QuantReg: 13.55728) QuantErr: 13.55728 batch_time=0.43380 
Train Epoch: 39 [786/1000 25152/32000 (79%)] Loss: 0.22957 (QuantReg: 13.46742) QuantErr: 13.46742 batch_time=0.35450 
Train Epoch: 39 [791/1000 25312/32000 (79%)] Loss: 0.27985 (QuantReg: 13.10533) QuantErr: 13.10533 batch_time=0.34642 
Train Epoch: 39 [796/1000 25472/32000 (80%)] Loss: 0.32129 (QuantReg: 13.68249) QuantErr: 13.68249 batch_time=0.40740 
Train Epoch: 39 [801/1000 25632/32000 (80%)] Loss: 0.13874 (QuantReg: 13.24584) QuantErr: 13.24584 batch_time=0.52686 
Train Epoch: 39 [806/1000 25792/32000 (81%)] Loss: 0.53282 (QuantReg: 13.19358) QuantErr: 13.19358 batch_time=0.35112 
Train Epoch: 39 [811/1000 25952/32000 (81%)] Loss: 0.13823 (QuantReg: 13.35931) QuantErr: 13.35931 batch_time=0.61583 
Train Epoch: 39 [816/1000 26112/32000 (82%)] Loss: 0.13645 (QuantReg: 12.88276) QuantErr: 12.88276 batch_time=0.51126 
Train Epoch: 39 [821/1000 26272/32000 (82%)] Loss: 0.25854 (QuantReg: 13.53220) QuantErr: 13.53220 batch_time=0.54777 
Train Epoch: 39 [826/1000 26432/32000 (83%)] Loss: 0.77700 (QuantReg: 12.47743) QuantErr: 12.47743 batch_time=0.37859 
Train Epoch: 39 [831/1000 26592/32000 (83%)] Loss: 0.34887 (QuantReg: 13.19924) QuantErr: 13.19924 batch_time=0.44584 
Train Epoch: 39 [836/1000 26752/32000 (84%)] Loss: 0.43763 (QuantReg: 12.69482) QuantErr: 12.69482 batch_time=0.36040 
Train Epoch: 39 [841/1000 26912/32000 (84%)] Loss: 0.26516 (QuantReg: 13.37261) QuantErr: 13.37261 batch_time=0.36242 
Train Epoch: 39 [846/1000 27072/32000 (85%)] Loss: 0.50334 (QuantReg: 13.16930) QuantErr: 13.16930 batch_time=0.48795 
Train Epoch: 39 [851/1000 27232/32000 (85%)] Loss: 0.27663 (QuantReg: 13.69119) QuantErr: 13.69119 batch_time=0.45803 
Train Epoch: 39 [856/1000 27392/32000 (86%)] Loss: 0.31851 (QuantReg: 13.55015) QuantErr: 13.55015 batch_time=0.39905 
Train Epoch: 39 [861/1000 27552/32000 (86%)] Loss: 0.19581 (QuantReg: 13.01943) QuantErr: 13.01943 batch_time=0.62658 
Train Epoch: 39 [866/1000 27712/32000 (87%)] Loss: 0.22809 (QuantReg: 13.49924) QuantErr: 13.49924 batch_time=0.38018 
Train Epoch: 39 [871/1000 27872/32000 (87%)] Loss: 0.19442 (QuantReg: 13.43415) QuantErr: 13.43415 batch_time=0.39697 
Train Epoch: 39 [876/1000 28032/32000 (88%)] Loss: 0.32377 (QuantReg: 13.70053) QuantErr: 13.70053 batch_time=0.36506 
Train Epoch: 39 [881/1000 28192/32000 (88%)] Loss: 0.25830 (QuantReg: 12.77247) QuantErr: 12.77247 batch_time=0.38903 
Train Epoch: 39 [886/1000 28352/32000 (89%)] Loss: 0.53026 (QuantReg: 13.11285) QuantErr: 13.11285 batch_time=0.35764 
Train Epoch: 39 [891/1000 28512/32000 (89%)] Loss: 0.14572 (QuantReg: 13.00441) QuantErr: 13.00441 batch_time=0.35954 
Train Epoch: 39 [896/1000 28672/32000 (90%)] Loss: 0.25781 (QuantReg: 13.10007) QuantErr: 13.10007 batch_time=0.41189 
Train Epoch: 39 [901/1000 28832/32000 (90%)] Loss: 0.13441 (QuantReg: 13.45254) QuantErr: 13.45254 batch_time=0.62467 
Train Epoch: 39 [906/1000 28992/32000 (91%)] Loss: 0.57035 (QuantReg: 12.91249) QuantErr: 12.91249 batch_time=0.35965 
Train Epoch: 39 [911/1000 29152/32000 (91%)] Loss: 0.25628 (QuantReg: 12.93455) QuantErr: 12.93455 batch_time=0.34868 
Train Epoch: 39 [916/1000 29312/32000 (92%)] Loss: 0.26153 (QuantReg: 13.82009) QuantErr: 13.82009 batch_time=0.35225 
Train Epoch: 39 [921/1000 29472/32000 (92%)] Loss: 0.32351 (QuantReg: 13.54542) QuantErr: 13.54542 batch_time=0.35193 
Train Epoch: 39 [926/1000 29632/32000 (93%)] Loss: 0.63640 (QuantReg: 13.71117) QuantErr: 13.71117 batch_time=0.36770 
Train Epoch: 39 [931/1000 29792/32000 (93%)] Loss: 0.42775 (QuantReg: 14.06623) QuantErr: 14.06623 batch_time=0.37161 
Train Epoch: 39 [936/1000 29952/32000 (94%)] Loss: 0.35797 (QuantReg: 12.89214) QuantErr: 12.89214 batch_time=0.35829 
Train Epoch: 39 [941/1000 30112/32000 (94%)] Loss: 0.08559 (QuantReg: 13.23783) QuantErr: 13.23783 batch_time=0.39723 
Train Epoch: 39 [946/1000 30272/32000 (95%)] Loss: 0.24736 (QuantReg: 12.30729) QuantErr: 12.30729 batch_time=0.45739 
Train Epoch: 39 [951/1000 30432/32000 (95%)] Loss: 0.13177 (QuantReg: 13.51399) QuantErr: 13.51399 batch_time=0.34160 
Train Epoch: 39 [956/1000 30592/32000 (96%)] Loss: 0.15809 (QuantReg: 12.18562) QuantErr: 12.18562 batch_time=0.36038 
Train Epoch: 39 [961/1000 30752/32000 (96%)] Loss: 0.45334 (QuantReg: 12.99989) QuantErr: 12.99989 batch_time=2.81982 
Train Epoch: 39 [966/1000 30912/32000 (97%)] Loss: 0.27870 (QuantReg: 12.84291) QuantErr: 12.84291 batch_time=0.58288 
Train Epoch: 39 [971/1000 31072/32000 (97%)] Loss: 0.32993 (QuantReg: 12.81728) QuantErr: 12.81728 batch_time=0.62269 
Train Epoch: 39 [976/1000 31232/32000 (98%)] Loss: 0.41055 (QuantReg: 13.14341) QuantErr: 13.14341 batch_time=0.38325 
Train Epoch: 39 [981/1000 31392/32000 (98%)] Loss: 0.39425 (QuantReg: 13.51723) QuantErr: 13.51723 batch_time=0.39599 
Train Epoch: 39 [986/1000 31552/32000 (99%)] Loss: 0.35171 (QuantReg: 13.72999) QuantErr: 13.72999 batch_time=0.39924 
Train Epoch: 39 [991/1000 31712/32000 (99%)] Loss: 0.28250 (QuantReg: 13.20007) QuantErr: 13.20007 batch_time=0.38116 
Train Epoch: 39 [996/1000 31872/32000 (100%)] Loss: 0.38925 (QuantReg: 13.29863) QuantErr: 13.29863 batch_time=0.35568 
Train Epoch: 39 codebook_update_time=2.51230
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch39.pth ...
Done in 4.841s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 0.32827984092384577
 quant_reg      : 13.127016046524048
 quant_err      : 13.127016046524048
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 39000
 MSRVTT_miech_test/t2v_metrics/R1: 21.7
 MSRVTT_miech_test/t2v_metrics/R5: 49.2
 MSRVTT_miech_test/t2v_metrics/R10: 62.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.953
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.62513589855921
 MSRVTT_miech_test/v2t_metrics/R1: 20.6
 MSRVTT_miech_test/v2t_metrics/R5: 51.2
 MSRVTT_miech_test/v2t_metrics/R10: 65.4
 MSRVTT_miech_test/v2t_metrics/R50: 87.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.456
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.011436032562955
 mnt_best       : 41.036608587691525
 not_improved_count: 5
Train Epoch: 40 [1/1000 32/32000 (0%)] Loss: 0.18360 (QuantReg: 13.17813) QuantErr: 13.17813 batch_time=29.78486 
Train Epoch: 40 [6/1000 192/32000 (1%)] Loss: 0.31562 (QuantReg: 13.68253) QuantErr: 13.68253 batch_time=0.44214 
Train Epoch: 40 [11/1000 352/32000 (1%)] Loss: 0.17972 (QuantReg: 13.00285) QuantErr: 13.00285 batch_time=0.44326 
Train Epoch: 40 [16/1000 512/32000 (2%)] Loss: 0.22495 (QuantReg: 13.75915) QuantErr: 13.75915 batch_time=0.61567 
Train Epoch: 40 [21/1000 672/32000 (2%)] Loss: 0.43739 (QuantReg: 12.39376) QuantErr: 12.39376 batch_time=0.37054 
Train Epoch: 40 [26/1000 832/32000 (3%)] Loss: 0.19723 (QuantReg: 12.69334) QuantErr: 12.69334 batch_time=0.40817 
Train Epoch: 40 [31/1000 992/32000 (3%)] Loss: 0.15977 (QuantReg: 13.82851) QuantErr: 13.82851 batch_time=0.36500 
Train Epoch: 40 [36/1000 1152/32000 (4%)] Loss: 0.39244 (QuantReg: 12.99492) QuantErr: 12.99492 batch_time=0.35913 
Train Epoch: 40 [41/1000 1312/32000 (4%)] Loss: 0.25291 (QuantReg: 12.90738) QuantErr: 12.90738 batch_time=0.35693 
Train Epoch: 40 [46/1000 1472/32000 (5%)] Loss: 0.35413 (QuantReg: 12.88268) QuantErr: 12.88268 batch_time=0.45823 
Train Epoch: 40 [51/1000 1632/32000 (5%)] Loss: 0.38767 (QuantReg: 13.19986) QuantErr: 13.19986 batch_time=0.46719 
Train Epoch: 40 [56/1000 1792/32000 (6%)] Loss: 0.36547 (QuantReg: 13.17809) QuantErr: 13.17809 batch_time=0.35168 
Train Epoch: 40 [61/1000 1952/32000 (6%)] Loss: 0.65606 (QuantReg: 13.45661) QuantErr: 13.45661 batch_time=0.42324 
Train Epoch: 40 [66/1000 2112/32000 (7%)] Loss: 0.33088 (QuantReg: 13.32648) QuantErr: 13.32648 batch_time=0.35425 
Train Epoch: 40 [71/1000 2272/32000 (7%)] Loss: 0.20706 (QuantReg: 13.64209) QuantErr: 13.64209 batch_time=0.50663 
Train Epoch: 40 [76/1000 2432/32000 (8%)] Loss: 0.19950 (QuantReg: 12.37939) QuantErr: 12.37939 batch_time=0.57358 
Train Epoch: 40 [81/1000 2592/32000 (8%)] Loss: 0.47407 (QuantReg: 12.75984) QuantErr: 12.75984 batch_time=0.59796 
Train Epoch: 40 [86/1000 2752/32000 (9%)] Loss: 0.13729 (QuantReg: 13.24751) QuantErr: 13.24751 batch_time=0.37747 
Train Epoch: 40 [91/1000 2912/32000 (9%)] Loss: 0.29622 (QuantReg: 13.18391) QuantErr: 13.18391 batch_time=0.37052 
Train Epoch: 40 [96/1000 3072/32000 (10%)] Loss: 0.48791 (QuantReg: 12.95603) QuantErr: 12.95603 batch_time=0.36572 
Train Epoch: 40 [101/1000 3232/32000 (10%)] Loss: 0.25575 (QuantReg: 13.50666) QuantErr: 13.50666 batch_time=0.42308 
Train Epoch: 40 [106/1000 3392/32000 (11%)] Loss: 0.42492 (QuantReg: 12.69681) QuantErr: 12.69681 batch_time=0.38662 
Train Epoch: 40 [111/1000 3552/32000 (11%)] Loss: 0.19554 (QuantReg: 12.76646) QuantErr: 12.76646 batch_time=0.37947 
Train Epoch: 40 [116/1000 3712/32000 (12%)] Loss: 0.43462 (QuantReg: 13.66692) QuantErr: 13.66692 batch_time=0.39347 
Train Epoch: 40 [121/1000 3872/32000 (12%)] Loss: 0.22810 (QuantReg: 13.51489) QuantErr: 13.51489 batch_time=0.35788 
Train Epoch: 40 [126/1000 4032/32000 (13%)] Loss: 0.29919 (QuantReg: 13.39178) QuantErr: 13.39178 batch_time=0.37715 
Train Epoch: 40 [131/1000 4192/32000 (13%)] Loss: 0.37651 (QuantReg: 12.66437) QuantErr: 12.66437 batch_time=0.44274 
Train Epoch: 40 [136/1000 4352/32000 (14%)] Loss: 0.39384 (QuantReg: 13.43399) QuantErr: 13.43399 batch_time=0.40845 
Train Epoch: 40 [141/1000 4512/32000 (14%)] Loss: 0.34993 (QuantReg: 12.85264) QuantErr: 12.85264 batch_time=0.35201 
Train Epoch: 40 [146/1000 4672/32000 (15%)] Loss: 0.19917 (QuantReg: 12.90306) QuantErr: 12.90306 batch_time=0.51718 
Train Epoch: 40 [151/1000 4832/32000 (15%)] Loss: 0.25682 (QuantReg: 13.04944) QuantErr: 13.04944 batch_time=0.39781 
Train Epoch: 40 [156/1000 4992/32000 (16%)] Loss: 0.44236 (QuantReg: 13.34157) QuantErr: 13.34157 batch_time=0.35176 
Train Epoch: 40 [161/1000 5152/32000 (16%)] Loss: 0.37355 (QuantReg: 13.08812) QuantErr: 13.08812 batch_time=0.54169 
Train Epoch: 40 [166/1000 5312/32000 (17%)] Loss: 0.23313 (QuantReg: 12.43958) QuantErr: 12.43958 batch_time=0.36947 
Train Epoch: 40 [171/1000 5472/32000 (17%)] Loss: 0.18160 (QuantReg: 13.25401) QuantErr: 13.25401 batch_time=0.42983 
Train Epoch: 40 [176/1000 5632/32000 (18%)] Loss: 0.20892 (QuantReg: 13.41182) QuantErr: 13.41182 batch_time=0.45256 
Train Epoch: 40 [181/1000 5792/32000 (18%)] Loss: 0.63887 (QuantReg: 12.51074) QuantErr: 12.51074 batch_time=0.37322 
Train Epoch: 40 [186/1000 5952/32000 (19%)] Loss: 0.10410 (QuantReg: 12.87505) QuantErr: 12.87505 batch_time=0.35860 
Train Epoch: 40 [191/1000 6112/32000 (19%)] Loss: 0.11214 (QuantReg: 13.55710) QuantErr: 13.55710 batch_time=0.36692 
Train Epoch: 40 [196/1000 6272/32000 (20%)] Loss: 0.27298 (QuantReg: 12.59690) QuantErr: 12.59690 batch_time=0.35936 
Train Epoch: 40 [201/1000 6432/32000 (20%)] Loss: 0.37213 (QuantReg: 13.27747) QuantErr: 13.27747 batch_time=0.36548 
Train Epoch: 40 [206/1000 6592/32000 (21%)] Loss: 0.50482 (QuantReg: 12.80451) QuantErr: 12.80451 batch_time=0.35366 
Train Epoch: 40 [211/1000 6752/32000 (21%)] Loss: 0.16132 (QuantReg: 12.91191) QuantErr: 12.91191 batch_time=0.38496 
Train Epoch: 40 [216/1000 6912/32000 (22%)] Loss: 0.27234 (QuantReg: 12.92853) QuantErr: 12.92853 batch_time=0.38051 
Train Epoch: 40 [221/1000 7072/32000 (22%)] Loss: 0.52457 (QuantReg: 12.98765) QuantErr: 12.98765 batch_time=0.37499 
Train Epoch: 40 [226/1000 7232/32000 (23%)] Loss: 0.19482 (QuantReg: 13.56771) QuantErr: 13.56771 batch_time=0.34420 
Train Epoch: 40 [231/1000 7392/32000 (23%)] Loss: 0.22698 (QuantReg: 12.77178) QuantErr: 12.77178 batch_time=0.39445 
Train Epoch: 40 [236/1000 7552/32000 (24%)] Loss: 0.37810 (QuantReg: 13.22988) QuantErr: 13.22988 batch_time=0.44757 
Train Epoch: 40 [241/1000 7712/32000 (24%)] Loss: 0.35577 (QuantReg: 13.29133) QuantErr: 13.29133 batch_time=0.37174 
Train Epoch: 40 [246/1000 7872/32000 (25%)] Loss: 0.35464 (QuantReg: 12.54184) QuantErr: 12.54184 batch_time=0.34124 
Train Epoch: 40 [251/1000 8032/32000 (25%)] Loss: 0.37279 (QuantReg: 12.81969) QuantErr: 12.81969 batch_time=0.38570 
Train Epoch: 40 [256/1000 8192/32000 (26%)] Loss: 0.52216 (QuantReg: 13.66724) QuantErr: 13.66724 batch_time=0.41759 
Train Epoch: 40 [261/1000 8352/32000 (26%)] Loss: 0.60726 (QuantReg: 12.78393) QuantErr: 12.78393 batch_time=0.54078 
Train Epoch: 40 [266/1000 8512/32000 (27%)] Loss: 0.28386 (QuantReg: 12.43367) QuantErr: 12.43367 batch_time=0.54225 
Train Epoch: 40 [271/1000 8672/32000 (27%)] Loss: 0.39080 (QuantReg: 13.24023) QuantErr: 13.24023 batch_time=0.49912 
Train Epoch: 40 [276/1000 8832/32000 (28%)] Loss: 0.32375 (QuantReg: 13.51418) QuantErr: 13.51418 batch_time=1.95659 
Train Epoch: 40 [281/1000 8992/32000 (28%)] Loss: 0.29883 (QuantReg: 12.95909) QuantErr: 12.95909 batch_time=0.38848 
Train Epoch: 40 [286/1000 9152/32000 (29%)] Loss: 0.21021 (QuantReg: 13.63549) QuantErr: 13.63549 batch_time=0.37475 
Train Epoch: 40 [291/1000 9312/32000 (29%)] Loss: 0.27356 (QuantReg: 13.12655) QuantErr: 13.12655 batch_time=0.40672 
Train Epoch: 40 [296/1000 9472/32000 (30%)] Loss: 0.28553 (QuantReg: 13.30398) QuantErr: 13.30398 batch_time=0.35668 
Train Epoch: 40 [301/1000 9632/32000 (30%)] Loss: 0.21964 (QuantReg: 13.28422) QuantErr: 13.28422 batch_time=0.35004 
Train Epoch: 40 [306/1000 9792/32000 (31%)] Loss: 0.24641 (QuantReg: 13.01244) QuantErr: 13.01244 batch_time=0.46060 
Train Epoch: 40 [311/1000 9952/32000 (31%)] Loss: 0.40833 (QuantReg: 12.56992) QuantErr: 12.56992 batch_time=0.50734 
Train Epoch: 40 [316/1000 10112/32000 (32%)] Loss: 0.29826 (QuantReg: 13.27545) QuantErr: 13.27545 batch_time=0.71098 
Train Epoch: 40 [321/1000 10272/32000 (32%)] Loss: 0.12937 (QuantReg: 13.29601) QuantErr: 13.29601 batch_time=0.71238 
Train Epoch: 40 [326/1000 10432/32000 (33%)] Loss: 0.46027 (QuantReg: 13.09991) QuantErr: 13.09991 batch_time=0.41454 
Train Epoch: 40 [331/1000 10592/32000 (33%)] Loss: 0.44601 (QuantReg: 12.80410) QuantErr: 12.80410 batch_time=0.59694 
Train Epoch: 40 [336/1000 10752/32000 (34%)] Loss: 0.21870 (QuantReg: 13.23384) QuantErr: 13.23384 batch_time=0.62714 
Train Epoch: 40 [341/1000 10912/32000 (34%)] Loss: 0.39970 (QuantReg: 13.24798) QuantErr: 13.24798 batch_time=0.37337 
Train Epoch: 40 [346/1000 11072/32000 (35%)] Loss: 0.19688 (QuantReg: 12.92155) QuantErr: 12.92155 batch_time=0.35170 
Train Epoch: 40 [351/1000 11232/32000 (35%)] Loss: 0.21078 (QuantReg: 13.07049) QuantErr: 13.07049 batch_time=0.34369 
Train Epoch: 40 [356/1000 11392/32000 (36%)] Loss: 0.36804 (QuantReg: 12.39115) QuantErr: 12.39115 batch_time=0.37701 
Train Epoch: 40 [361/1000 11552/32000 (36%)] Loss: 0.47693 (QuantReg: 12.53845) QuantErr: 12.53845 batch_time=0.43603 
Train Epoch: 40 [366/1000 11712/32000 (37%)] Loss: 0.13495 (QuantReg: 13.45373) QuantErr: 13.45373 batch_time=0.39682 
Train Epoch: 40 [371/1000 11872/32000 (37%)] Loss: 0.48563 (QuantReg: 13.06002) QuantErr: 13.06002 batch_time=0.42011 
Train Epoch: 40 [376/1000 12032/32000 (38%)] Loss: 0.34239 (QuantReg: 12.60446) QuantErr: 12.60446 batch_time=0.40085 
Train Epoch: 40 [381/1000 12192/32000 (38%)] Loss: 0.39620 (QuantReg: 12.92914) QuantErr: 12.92914 batch_time=0.41229 
Train Epoch: 40 [386/1000 12352/32000 (39%)] Loss: 0.36996 (QuantReg: 13.18610) QuantErr: 13.18610 batch_time=0.42225 
Train Epoch: 40 [391/1000 12512/32000 (39%)] Loss: 0.52274 (QuantReg: 12.45593) QuantErr: 12.45593 batch_time=0.35420 
Train Epoch: 40 [396/1000 12672/32000 (40%)] Loss: 0.13361 (QuantReg: 14.16292) QuantErr: 14.16292 batch_time=0.36046 
Train Epoch: 40 [401/1000 12832/32000 (40%)] Loss: 0.23609 (QuantReg: 12.89944) QuantErr: 12.89944 batch_time=0.35253 
Train Epoch: 40 [406/1000 12992/32000 (41%)] Loss: 0.42949 (QuantReg: 12.72301) QuantErr: 12.72301 batch_time=0.38985 
Train Epoch: 40 [411/1000 13152/32000 (41%)] Loss: 0.32043 (QuantReg: 12.61437) QuantErr: 12.61437 batch_time=0.38373 
Train Epoch: 40 [416/1000 13312/32000 (42%)] Loss: 0.28351 (QuantReg: 12.99646) QuantErr: 12.99646 batch_time=0.35310 
Train Epoch: 40 [421/1000 13472/32000 (42%)] Loss: 0.25765 (QuantReg: 13.74690) QuantErr: 13.74690 batch_time=0.37523 
Train Epoch: 40 [426/1000 13632/32000 (43%)] Loss: 0.28294 (QuantReg: 13.46536) QuantErr: 13.46536 batch_time=0.38403 
Train Epoch: 40 [431/1000 13792/32000 (43%)] Loss: 0.30544 (QuantReg: 13.15833) QuantErr: 13.15833 batch_time=0.35511 
Train Epoch: 40 [436/1000 13952/32000 (44%)] Loss: 0.20789 (QuantReg: 13.96786) QuantErr: 13.96786 batch_time=0.35400 
Train Epoch: 40 [441/1000 14112/32000 (44%)] Loss: 0.17468 (QuantReg: 13.42088) QuantErr: 13.42088 batch_time=0.38913 
Train Epoch: 40 [446/1000 14272/32000 (45%)] Loss: 0.36216 (QuantReg: 12.73713) QuantErr: 12.73713 batch_time=0.36615 
Train Epoch: 40 [451/1000 14432/32000 (45%)] Loss: 0.15648 (QuantReg: 13.11505) QuantErr: 13.11505 batch_time=0.40889 
Train Epoch: 40 [456/1000 14592/32000 (46%)] Loss: 0.18076 (QuantReg: 12.79837) QuantErr: 12.79837 batch_time=0.36103 
Train Epoch: 40 [461/1000 14752/32000 (46%)] Loss: 0.51213 (QuantReg: 12.90458) QuantErr: 12.90458 batch_time=0.36341 
Train Epoch: 40 [466/1000 14912/32000 (47%)] Loss: 0.42462 (QuantReg: 12.93155) QuantErr: 12.93155 batch_time=0.35529 
Train Epoch: 40 [471/1000 15072/32000 (47%)] Loss: 0.37675 (QuantReg: 13.02352) QuantErr: 13.02352 batch_time=0.45321 
Train Epoch: 40 [476/1000 15232/32000 (48%)] Loss: 0.11373 (QuantReg: 13.06922) QuantErr: 13.06922 batch_time=0.37714 
Train Epoch: 40 [481/1000 15392/32000 (48%)] Loss: 0.15958 (QuantReg: 13.41687) QuantErr: 13.41687 batch_time=0.39005 
Train Epoch: 40 [486/1000 15552/32000 (49%)] Loss: 0.20658 (QuantReg: 13.19160) QuantErr: 13.19160 batch_time=0.46316 
Train Epoch: 40 [491/1000 15712/32000 (49%)] Loss: 0.34053 (QuantReg: 12.59584) QuantErr: 12.59584 batch_time=0.39604 
Train Epoch: 40 [496/1000 15872/32000 (50%)] Loss: 0.32729 (QuantReg: 12.75029) QuantErr: 12.75029 batch_time=0.46572 
Train Epoch: 40 [501/1000 16032/32000 (50%)] Loss: 0.71910 (QuantReg: 12.82599) QuantErr: 12.82599 batch_time=0.39731 
Train Epoch: 40 [506/1000 16192/32000 (51%)] Loss: 0.16129 (QuantReg: 13.82075) QuantErr: 13.82075 batch_time=0.35143 
Train Epoch: 40 [511/1000 16352/32000 (51%)] Loss: 0.17706 (QuantReg: 13.11747) QuantErr: 13.11747 batch_time=0.35707 
Train Epoch: 40 [516/1000 16512/32000 (52%)] Loss: 0.40243 (QuantReg: 13.28500) QuantErr: 13.28500 batch_time=0.38729 
Train Epoch: 40 [521/1000 16672/32000 (52%)] Loss: 0.14342 (QuantReg: 12.90633) QuantErr: 12.90633 batch_time=0.41516 
Train Epoch: 40 [526/1000 16832/32000 (53%)] Loss: 0.30193 (QuantReg: 12.43455) QuantErr: 12.43455 batch_time=0.41637 
Train Epoch: 40 [531/1000 16992/32000 (53%)] Loss: 0.40239 (QuantReg: 13.51159) QuantErr: 13.51159 batch_time=0.34700 
Train Epoch: 40 [536/1000 17152/32000 (54%)] Loss: 0.27638 (QuantReg: 13.73616) QuantErr: 13.73616 batch_time=0.41390 
Train Epoch: 40 [541/1000 17312/32000 (54%)] Loss: 0.36294 (QuantReg: 12.99522) QuantErr: 12.99522 batch_time=0.35074 
Train Epoch: 40 [546/1000 17472/32000 (55%)] Loss: 0.47933 (QuantReg: 13.50683) QuantErr: 13.50683 batch_time=0.52301 
Train Epoch: 40 [551/1000 17632/32000 (55%)] Loss: 0.11298 (QuantReg: 13.40056) QuantErr: 13.40056 batch_time=0.34554 
Train Epoch: 40 [556/1000 17792/32000 (56%)] Loss: 0.27931 (QuantReg: 13.30145) QuantErr: 13.30145 batch_time=0.39421 
Train Epoch: 40 [561/1000 17952/32000 (56%)] Loss: 0.26319 (QuantReg: 13.27086) QuantErr: 13.27086 batch_time=0.34189 
Train Epoch: 40 [566/1000 18112/32000 (57%)] Loss: 0.36022 (QuantReg: 13.37224) QuantErr: 13.37224 batch_time=0.35889 
Train Epoch: 40 [571/1000 18272/32000 (57%)] Loss: 0.32191 (QuantReg: 14.02296) QuantErr: 14.02296 batch_time=0.35452 
Train Epoch: 40 [576/1000 18432/32000 (58%)] Loss: 0.20871 (QuantReg: 12.66931) QuantErr: 12.66931 batch_time=0.45745 
Train Epoch: 40 [581/1000 18592/32000 (58%)] Loss: 0.45908 (QuantReg: 13.28121) QuantErr: 13.28121 batch_time=0.34694 
Train Epoch: 40 [586/1000 18752/32000 (59%)] Loss: 0.31485 (QuantReg: 12.56247) QuantErr: 12.56247 batch_time=0.51782 
Train Epoch: 40 [591/1000 18912/32000 (59%)] Loss: 0.19126 (QuantReg: 13.27634) QuantErr: 13.27634 batch_time=0.36357 
Train Epoch: 40 [596/1000 19072/32000 (60%)] Loss: 0.15938 (QuantReg: 13.36378) QuantErr: 13.36378 batch_time=0.34380 
Train Epoch: 40 [601/1000 19232/32000 (60%)] Loss: 0.26970 (QuantReg: 12.60730) QuantErr: 12.60730 batch_time=0.36608 
Train Epoch: 40 [606/1000 19392/32000 (61%)] Loss: 0.40264 (QuantReg: 13.10304) QuantErr: 13.10304 batch_time=0.35011 
Train Epoch: 40 [611/1000 19552/32000 (61%)] Loss: 0.23419 (QuantReg: 13.18446) QuantErr: 13.18446 batch_time=0.50351 
Train Epoch: 40 [616/1000 19712/32000 (62%)] Loss: 0.15404 (QuantReg: 13.07524) QuantErr: 13.07524 batch_time=0.35898 
Train Epoch: 40 [621/1000 19872/32000 (62%)] Loss: 0.28805 (QuantReg: 13.03539) QuantErr: 13.03539 batch_time=4.34718 
Train Epoch: 40 [626/1000 20032/32000 (63%)] Loss: 0.34653 (QuantReg: 12.67779) QuantErr: 12.67779 batch_time=0.53984 
Train Epoch: 40 [631/1000 20192/32000 (63%)] Loss: 0.26199 (QuantReg: 13.36475) QuantErr: 13.36475 batch_time=0.34917 
Train Epoch: 40 [636/1000 20352/32000 (64%)] Loss: 0.46747 (QuantReg: 12.36191) QuantErr: 12.36191 batch_time=0.36057 
Train Epoch: 40 [641/1000 20512/32000 (64%)] Loss: 0.26741 (QuantReg: 13.44725) QuantErr: 13.44725 batch_time=0.38203 
Train Epoch: 40 [646/1000 20672/32000 (65%)] Loss: 0.31233 (QuantReg: 13.57673) QuantErr: 13.57673 batch_time=0.36457 
Train Epoch: 40 [651/1000 20832/32000 (65%)] Loss: 0.37928 (QuantReg: 13.40774) QuantErr: 13.40774 batch_time=0.53192 
Train Epoch: 40 [656/1000 20992/32000 (66%)] Loss: 0.53164 (QuantReg: 13.02341) QuantErr: 13.02341 batch_time=0.41842 
Train Epoch: 40 [661/1000 21152/32000 (66%)] Loss: 0.28774 (QuantReg: 13.33770) QuantErr: 13.33770 batch_time=0.38097 
Train Epoch: 40 [666/1000 21312/32000 (67%)] Loss: 0.32136 (QuantReg: 13.31329) QuantErr: 13.31329 batch_time=0.37677 
Train Epoch: 40 [671/1000 21472/32000 (67%)] Loss: 0.55879 (QuantReg: 12.74487) QuantErr: 12.74487 batch_time=0.40143 
Train Epoch: 40 [676/1000 21632/32000 (68%)] Loss: 0.37315 (QuantReg: 13.64748) QuantErr: 13.64748 batch_time=0.34802 
Train Epoch: 40 [681/1000 21792/32000 (68%)] Loss: 0.46712 (QuantReg: 13.02677) QuantErr: 13.02677 batch_time=0.42947 
Train Epoch: 40 [686/1000 21952/32000 (69%)] Loss: 0.35902 (QuantReg: 13.37990) QuantErr: 13.37990 batch_time=0.55292 
Train Epoch: 40 [691/1000 22112/32000 (69%)] Loss: 0.36807 (QuantReg: 13.35254) QuantErr: 13.35254 batch_time=0.37744 
Train Epoch: 40 [696/1000 22272/32000 (70%)] Loss: 0.53848 (QuantReg: 12.55576) QuantErr: 12.55576 batch_time=0.34987 
Train Epoch: 40 [701/1000 22432/32000 (70%)] Loss: 0.16708 (QuantReg: 13.12094) QuantErr: 13.12094 batch_time=0.35494 
Train Epoch: 40 [706/1000 22592/32000 (71%)] Loss: 0.19378 (QuantReg: 12.77361) QuantErr: 12.77361 batch_time=0.39289 
Train Epoch: 40 [711/1000 22752/32000 (71%)] Loss: 0.38934 (QuantReg: 12.32232) QuantErr: 12.32232 batch_time=0.40615 
Train Epoch: 40 [716/1000 22912/32000 (72%)] Loss: 0.29768 (QuantReg: 12.52661) QuantErr: 12.52661 batch_time=0.42866 
Train Epoch: 40 [721/1000 23072/32000 (72%)] Loss: 0.55155 (QuantReg: 13.18536) QuantErr: 13.18536 batch_time=0.38184 
Train Epoch: 40 [726/1000 23232/32000 (73%)] Loss: 0.41777 (QuantReg: 13.25594) QuantErr: 13.25594 batch_time=0.38194 
Train Epoch: 40 [731/1000 23392/32000 (73%)] Loss: 0.35128 (QuantReg: 12.77122) QuantErr: 12.77122 batch_time=0.38413 
Train Epoch: 40 [736/1000 23552/32000 (74%)] Loss: 0.65152 (QuantReg: 13.19885) QuantErr: 13.19885 batch_time=0.37668 
Train Epoch: 40 [741/1000 23712/32000 (74%)] Loss: 0.44616 (QuantReg: 12.68049) QuantErr: 12.68049 batch_time=0.35975 
Train Epoch: 40 [746/1000 23872/32000 (75%)] Loss: 0.29087 (QuantReg: 13.31852) QuantErr: 13.31852 batch_time=0.43797 
Train Epoch: 40 [751/1000 24032/32000 (75%)] Loss: 0.29823 (QuantReg: 13.27963) QuantErr: 13.27963 batch_time=0.34707 
Train Epoch: 40 [756/1000 24192/32000 (76%)] Loss: 0.51266 (QuantReg: 13.41737) QuantErr: 13.41737 batch_time=0.39093 
Train Epoch: 40 [761/1000 24352/32000 (76%)] Loss: 0.19883 (QuantReg: 13.36954) QuantErr: 13.36954 batch_time=0.46025 
Train Epoch: 40 [766/1000 24512/32000 (77%)] Loss: 0.40757 (QuantReg: 13.14414) QuantErr: 13.14414 batch_time=0.41063 
Train Epoch: 40 [771/1000 24672/32000 (77%)] Loss: 0.32493 (QuantReg: 13.34727) QuantErr: 13.34727 batch_time=0.51919 
Train Epoch: 40 [776/1000 24832/32000 (78%)] Loss: 0.37538 (QuantReg: 13.32249) QuantErr: 13.32249 batch_time=0.50720 
Train Epoch: 40 [781/1000 24992/32000 (78%)] Loss: 0.55179 (QuantReg: 13.65753) QuantErr: 13.65753 batch_time=0.39455 
Train Epoch: 40 [786/1000 25152/32000 (79%)] Loss: 0.15973 (QuantReg: 12.94396) QuantErr: 12.94396 batch_time=0.34698 
Train Epoch: 40 [791/1000 25312/32000 (79%)] Loss: 0.38401 (QuantReg: 12.97368) QuantErr: 12.97368 batch_time=0.37590 
Train Epoch: 40 [796/1000 25472/32000 (80%)] Loss: 0.25077 (QuantReg: 12.57648) QuantErr: 12.57648 batch_time=0.44232 
Train Epoch: 40 [801/1000 25632/32000 (80%)] Loss: 0.36744 (QuantReg: 13.36071) QuantErr: 13.36071 batch_time=0.41638 
Train Epoch: 40 [806/1000 25792/32000 (81%)] Loss: 0.43666 (QuantReg: 12.81584) QuantErr: 12.81584 batch_time=0.37996 
Train Epoch: 40 [811/1000 25952/32000 (81%)] Loss: 0.28399 (QuantReg: 13.70279) QuantErr: 13.70279 batch_time=0.37290 
Train Epoch: 40 [816/1000 26112/32000 (82%)] Loss: 0.20569 (QuantReg: 13.52446) QuantErr: 13.52446 batch_time=0.41108 
Train Epoch: 40 [821/1000 26272/32000 (82%)] Loss: 0.27867 (QuantReg: 12.96994) QuantErr: 12.96994 batch_time=0.37933 
Train Epoch: 40 [826/1000 26432/32000 (83%)] Loss: 0.49646 (QuantReg: 13.52622) QuantErr: 13.52622 batch_time=0.49724 
Train Epoch: 40 [831/1000 26592/32000 (83%)] Loss: 0.75009 (QuantReg: 13.45082) QuantErr: 13.45082 batch_time=0.36606 
Train Epoch: 40 [836/1000 26752/32000 (84%)] Loss: 0.36596 (QuantReg: 13.55528) QuantErr: 13.55528 batch_time=0.38058 
Train Epoch: 40 [841/1000 26912/32000 (84%)] Loss: 0.41386 (QuantReg: 12.86992) QuantErr: 12.86992 batch_time=0.41499 
Train Epoch: 40 [846/1000 27072/32000 (85%)] Loss: 0.32700 (QuantReg: 13.36723) QuantErr: 13.36723 batch_time=0.38386 
Train Epoch: 40 [851/1000 27232/32000 (85%)] Loss: 0.68901 (QuantReg: 12.75749) QuantErr: 12.75749 batch_time=0.49569 
Train Epoch: 40 [856/1000 27392/32000 (86%)] Loss: 0.26727 (QuantReg: 12.86045) QuantErr: 12.86045 batch_time=0.38296 
Train Epoch: 40 [861/1000 27552/32000 (86%)] Loss: 0.39652 (QuantReg: 13.10397) QuantErr: 13.10397 batch_time=0.35832 
Train Epoch: 40 [866/1000 27712/32000 (87%)] Loss: 0.58009 (QuantReg: 12.94288) QuantErr: 12.94288 batch_time=0.39206 
Train Epoch: 40 [871/1000 27872/32000 (87%)] Loss: 0.38229 (QuantReg: 12.99437) QuantErr: 12.99437 batch_time=0.39010 
Train Epoch: 40 [876/1000 28032/32000 (88%)] Loss: 0.41951 (QuantReg: 13.07946) QuantErr: 13.07946 batch_time=0.39209 
Train Epoch: 40 [881/1000 28192/32000 (88%)] Loss: 0.38887 (QuantReg: 13.48065) QuantErr: 13.48065 batch_time=0.35650 
Train Epoch: 40 [886/1000 28352/32000 (89%)] Loss: 0.20166 (QuantReg: 13.53642) QuantErr: 13.53642 batch_time=0.61589 
Train Epoch: 40 [891/1000 28512/32000 (89%)] Loss: 0.35283 (QuantReg: 13.46020) QuantErr: 13.46020 batch_time=0.35060 
Train Epoch: 40 [896/1000 28672/32000 (90%)] Loss: 0.16908 (QuantReg: 13.41291) QuantErr: 13.41291 batch_time=0.34231 
Train Epoch: 40 [901/1000 28832/32000 (90%)] Loss: 0.12123 (QuantReg: 13.25687) QuantErr: 13.25687 batch_time=0.36096 
Train Epoch: 40 [906/1000 28992/32000 (91%)] Loss: 0.21493 (QuantReg: 12.72984) QuantErr: 12.72984 batch_time=0.34822 
Train Epoch: 40 [911/1000 29152/32000 (91%)] Loss: 0.27831 (QuantReg: 13.12511) QuantErr: 13.12511 batch_time=0.52417 
Train Epoch: 40 [916/1000 29312/32000 (92%)] Loss: 0.31996 (QuantReg: 13.25093) QuantErr: 13.25093 batch_time=0.39010 
Train Epoch: 40 [921/1000 29472/32000 (92%)] Loss: 0.17808 (QuantReg: 13.19311) QuantErr: 13.19311 batch_time=0.34778 
Train Epoch: 40 [926/1000 29632/32000 (93%)] Loss: 0.20849 (QuantReg: 13.23574) QuantErr: 13.23574 batch_time=0.35823 
Train Epoch: 40 [931/1000 29792/32000 (93%)] Loss: 0.28357 (QuantReg: 12.98262) QuantErr: 12.98262 batch_time=0.36910 
Train Epoch: 40 [936/1000 29952/32000 (94%)] Loss: 0.58295 (QuantReg: 12.80951) QuantErr: 12.80951 batch_time=0.39176 
Train Epoch: 40 [941/1000 30112/32000 (94%)] Loss: 0.60847 (QuantReg: 12.47186) QuantErr: 12.47186 batch_time=2.18519 
Train Epoch: 40 [946/1000 30272/32000 (95%)] Loss: 0.19609 (QuantReg: 13.38483) QuantErr: 13.38483 batch_time=0.43888 
Train Epoch: 40 [951/1000 30432/32000 (95%)] Loss: 0.39911 (QuantReg: 12.85287) QuantErr: 12.85287 batch_time=0.37976 
Train Epoch: 40 [956/1000 30592/32000 (96%)] Loss: 0.35210 (QuantReg: 13.05044) QuantErr: 13.05044 batch_time=0.38751 
Train Epoch: 40 [961/1000 30752/32000 (96%)] Loss: 0.21369 (QuantReg: 12.84781) QuantErr: 12.84781 batch_time=0.39326 
Train Epoch: 40 [966/1000 30912/32000 (97%)] Loss: 0.33208 (QuantReg: 13.42867) QuantErr: 13.42867 batch_time=0.38218 
Train Epoch: 40 [971/1000 31072/32000 (97%)] Loss: 0.50738 (QuantReg: 13.66733) QuantErr: 13.66733 batch_time=0.36673 
Train Epoch: 40 [976/1000 31232/32000 (98%)] Loss: 0.52383 (QuantReg: 13.55751) QuantErr: 13.55751 batch_time=0.36061 
Train Epoch: 40 [981/1000 31392/32000 (98%)] Loss: 0.45296 (QuantReg: 13.26138) QuantErr: 13.26138 batch_time=0.35163 
Train Epoch: 40 [986/1000 31552/32000 (99%)] Loss: 0.45104 (QuantReg: 13.84533) QuantErr: 13.84533 batch_time=0.38582 
Train Epoch: 40 [991/1000 31712/32000 (99%)] Loss: 0.39148 (QuantReg: 13.42790) QuantErr: 13.42790 batch_time=0.41393 
Train Epoch: 40 [996/1000 31872/32000 (100%)] Loss: 0.17583 (QuantReg: 13.34567) QuantErr: 13.34567 batch_time=0.44586 
Train Epoch: 40 codebook_update_time=1.75351
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch40.pth ...
Done in 15.988s
removing stale ckpt [epoch 39] [took 0.04s]
 epoch          : 40
 loss           : 0.32680582981184125
 quant_reg      : 13.124195921897888
 quant_err      : 13.124195921897888
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 40000
 MSRVTT_miech_test/t2v_metrics/R1: 19.9
 MSRVTT_miech_test/t2v_metrics/R5: 50.5
 MSRVTT_miech_test/t2v_metrics/R10: 64.9
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 30.364
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.252826724306466
 MSRVTT_miech_test/v2t_metrics/R1: 20.5
 MSRVTT_miech_test/v2t_metrics/R5: 51.6
 MSRVTT_miech_test/v2t_metrics/R10: 65.3
 MSRVTT_miech_test/v2t_metrics/R50: 87.8
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 26.457
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.03038398176269
 mnt_best       : 41.036608587691525
 not_improved_count: 6
Train Epoch: 41 [1/1000 32/32000 (0%)] Loss: 0.11569 (QuantReg: 13.50239) QuantErr: 13.50239 batch_time=29.36820 
Train Epoch: 41 [6/1000 192/32000 (1%)] Loss: 0.33408 (QuantReg: 13.39658) QuantErr: 13.39658 batch_time=0.39435 
Train Epoch: 41 [11/1000 352/32000 (1%)] Loss: 0.37842 (QuantReg: 12.85326) QuantErr: 12.85326 batch_time=0.52179 
Train Epoch: 41 [16/1000 512/32000 (2%)] Loss: 0.44388 (QuantReg: 13.48048) QuantErr: 13.48048 batch_time=0.37338 
Train Epoch: 41 [21/1000 672/32000 (2%)] Loss: 0.46479 (QuantReg: 13.05069) QuantErr: 13.05069 batch_time=0.35747 
Train Epoch: 41 [26/1000 832/32000 (3%)] Loss: 0.15405 (QuantReg: 13.49308) QuantErr: 13.49308 batch_time=0.35377 
Train Epoch: 41 [31/1000 992/32000 (3%)] Loss: 0.38804 (QuantReg: 12.79675) QuantErr: 12.79675 batch_time=0.37575 
Train Epoch: 41 [36/1000 1152/32000 (4%)] Loss: 0.39350 (QuantReg: 13.28632) QuantErr: 13.28632 batch_time=0.38929 
Train Epoch: 41 [41/1000 1312/32000 (4%)] Loss: 0.11499 (QuantReg: 13.21500) QuantErr: 13.21500 batch_time=0.37110 
Train Epoch: 41 [46/1000 1472/32000 (5%)] Loss: 0.22827 (QuantReg: 12.63823) QuantErr: 12.63823 batch_time=0.40967 
Train Epoch: 41 [51/1000 1632/32000 (5%)] Loss: 0.50107 (QuantReg: 12.84465) QuantErr: 12.84465 batch_time=0.36287 
Train Epoch: 41 [56/1000 1792/32000 (6%)] Loss: 0.66115 (QuantReg: 12.32462) QuantErr: 12.32462 batch_time=0.37086 
Train Epoch: 41 [61/1000 1952/32000 (6%)] Loss: 0.46726 (QuantReg: 12.20431) QuantErr: 12.20431 batch_time=0.38236 
Train Epoch: 41 [66/1000 2112/32000 (7%)] Loss: 0.52586 (QuantReg: 13.60371) QuantErr: 13.60371 batch_time=2.35477 
Train Epoch: 41 [71/1000 2272/32000 (7%)] Loss: 0.34045 (QuantReg: 13.03543) QuantErr: 13.03543 batch_time=0.37774 
Train Epoch: 41 [76/1000 2432/32000 (8%)] Loss: 0.12591 (QuantReg: 13.57838) QuantErr: 13.57838 batch_time=0.37877 
Train Epoch: 41 [81/1000 2592/32000 (8%)] Loss: 0.29063 (QuantReg: 13.07547) QuantErr: 13.07547 batch_time=0.36345 
Train Epoch: 41 [86/1000 2752/32000 (9%)] Loss: 0.27171 (QuantReg: 13.09502) QuantErr: 13.09502 batch_time=0.36963 
Train Epoch: 41 [91/1000 2912/32000 (9%)] Loss: 0.24212 (QuantReg: 12.77772) QuantErr: 12.77772 batch_time=0.35103 
Train Epoch: 41 [96/1000 3072/32000 (10%)] Loss: 0.42829 (QuantReg: 12.94775) QuantErr: 12.94775 batch_time=0.40719 
Train Epoch: 41 [101/1000 3232/32000 (10%)] Loss: 0.49435 (QuantReg: 12.96125) QuantErr: 12.96125 batch_time=0.35422 
Train Epoch: 41 [106/1000 3392/32000 (11%)] Loss: 0.30669 (QuantReg: 13.50624) QuantErr: 13.50624 batch_time=0.40915 
Train Epoch: 41 [111/1000 3552/32000 (11%)] Loss: 0.09334 (QuantReg: 13.24393) QuantErr: 13.24393 batch_time=0.39156 
Train Epoch: 41 [116/1000 3712/32000 (12%)] Loss: 0.20238 (QuantReg: 12.83862) QuantErr: 12.83862 batch_time=0.40221 
Train Epoch: 41 [121/1000 3872/32000 (12%)] Loss: 0.51533 (QuantReg: 13.14272) QuantErr: 13.14272 batch_time=0.34852 
Train Epoch: 41 [126/1000 4032/32000 (13%)] Loss: 0.23182 (QuantReg: 12.97724) QuantErr: 12.97724 batch_time=0.43796 
Train Epoch: 41 [131/1000 4192/32000 (13%)] Loss: 0.21462 (QuantReg: 13.67066) QuantErr: 13.67066 batch_time=0.37511 
Train Epoch: 41 [136/1000 4352/32000 (14%)] Loss: 0.15376 (QuantReg: 13.47695) QuantErr: 13.47695 batch_time=0.41435 
Train Epoch: 41 [141/1000 4512/32000 (14%)] Loss: 0.20120 (QuantReg: 13.07819) QuantErr: 13.07819 batch_time=0.39182 
Train Epoch: 41 [146/1000 4672/32000 (15%)] Loss: 0.12714 (QuantReg: 13.55373) QuantErr: 13.55373 batch_time=0.36437 
Train Epoch: 41 [151/1000 4832/32000 (15%)] Loss: 0.23182 (QuantReg: 13.47921) QuantErr: 13.47921 batch_time=0.44394 
Train Epoch: 41 [156/1000 4992/32000 (16%)] Loss: 0.56048 (QuantReg: 12.65471) QuantErr: 12.65471 batch_time=0.40000 
Train Epoch: 41 [161/1000 5152/32000 (16%)] Loss: 0.15483 (QuantReg: 13.32855) QuantErr: 13.32855 batch_time=0.35949 
Train Epoch: 41 [166/1000 5312/32000 (17%)] Loss: 0.39071 (QuantReg: 12.69942) QuantErr: 12.69942 batch_time=0.34580 
Train Epoch: 41 [171/1000 5472/32000 (17%)] Loss: 0.21753 (QuantReg: 12.97460) QuantErr: 12.97460 batch_time=0.37078 
Train Epoch: 41 [176/1000 5632/32000 (18%)] Loss: 0.31967 (QuantReg: 12.69897) QuantErr: 12.69897 batch_time=0.35663 
Train Epoch: 41 [181/1000 5792/32000 (18%)] Loss: 0.58903 (QuantReg: 12.96644) QuantErr: 12.96644 batch_time=0.36258 
Train Epoch: 41 [186/1000 5952/32000 (19%)] Loss: 0.19320 (QuantReg: 12.54250) QuantErr: 12.54250 batch_time=0.48328 
Train Epoch: 41 [191/1000 6112/32000 (19%)] Loss: 0.41872 (QuantReg: 12.77690) QuantErr: 12.77690 batch_time=0.39036 
Train Epoch: 41 [196/1000 6272/32000 (20%)] Loss: 0.24232 (QuantReg: 12.93667) QuantErr: 12.93667 batch_time=0.36737 
Train Epoch: 41 [201/1000 6432/32000 (20%)] Loss: 0.44780 (QuantReg: 12.95005) QuantErr: 12.95005 batch_time=0.43824 
Train Epoch: 41 [206/1000 6592/32000 (21%)] Loss: 0.34054 (QuantReg: 13.29079) QuantErr: 13.29079 batch_time=0.35465 
Train Epoch: 41 [211/1000 6752/32000 (21%)] Loss: 0.24586 (QuantReg: 13.20827) QuantErr: 13.20827 batch_time=0.37357 
Train Epoch: 41 [216/1000 6912/32000 (22%)] Loss: 0.32685 (QuantReg: 13.01942) QuantErr: 13.01942 batch_time=0.46275 
Train Epoch: 41 [221/1000 7072/32000 (22%)] Loss: 0.17703 (QuantReg: 13.38416) QuantErr: 13.38416 batch_time=0.42354 
Train Epoch: 41 [226/1000 7232/32000 (23%)] Loss: 0.10802 (QuantReg: 12.99738) QuantErr: 12.99738 batch_time=0.44083 
Train Epoch: 41 [231/1000 7392/32000 (23%)] Loss: 0.23089 (QuantReg: 13.05387) QuantErr: 13.05387 batch_time=0.42605 
Train Epoch: 41 [236/1000 7552/32000 (24%)] Loss: 0.28107 (QuantReg: 13.56054) QuantErr: 13.56054 batch_time=0.46959 
Train Epoch: 41 [241/1000 7712/32000 (24%)] Loss: 0.16599 (QuantReg: 13.75986) QuantErr: 13.75986 batch_time=0.43289 
Train Epoch: 41 [246/1000 7872/32000 (25%)] Loss: 0.24653 (QuantReg: 12.98693) QuantErr: 12.98693 batch_time=0.56233 
Train Epoch: 41 [251/1000 8032/32000 (25%)] Loss: 0.28972 (QuantReg: 12.71042) QuantErr: 12.71042 batch_time=0.37620 
Train Epoch: 41 [256/1000 8192/32000 (26%)] Loss: 0.50574 (QuantReg: 12.76452) QuantErr: 12.76452 batch_time=0.35851 
Train Epoch: 41 [261/1000 8352/32000 (26%)] Loss: 0.15589 (QuantReg: 13.09165) QuantErr: 13.09165 batch_time=0.35534 
Train Epoch: 41 [266/1000 8512/32000 (27%)] Loss: 0.27484 (QuantReg: 13.42529) QuantErr: 13.42529 batch_time=0.35338 
Train Epoch: 41 [271/1000 8672/32000 (27%)] Loss: 0.58362 (QuantReg: 12.89424) QuantErr: 12.89424 batch_time=0.35527 
Train Epoch: 41 [276/1000 8832/32000 (28%)] Loss: 0.11954 (QuantReg: 13.62453) QuantErr: 13.62453 batch_time=0.40287 
Train Epoch: 41 [281/1000 8992/32000 (28%)] Loss: 0.14432 (QuantReg: 12.87082) QuantErr: 12.87082 batch_time=0.43090 
Train Epoch: 41 [286/1000 9152/32000 (29%)] Loss: 0.08751 (QuantReg: 13.61781) QuantErr: 13.61781 batch_time=0.45442 
Train Epoch: 41 [291/1000 9312/32000 (29%)] Loss: 0.20527 (QuantReg: 13.21609) QuantErr: 13.21609 batch_time=0.34888 
Train Epoch: 41 [296/1000 9472/32000 (30%)] Loss: 0.37308 (QuantReg: 12.80960) QuantErr: 12.80960 batch_time=0.39869 
Train Epoch: 41 [301/1000 9632/32000 (30%)] Loss: 0.23457 (QuantReg: 12.92881) QuantErr: 12.92881 batch_time=0.53419 
Train Epoch: 41 [306/1000 9792/32000 (31%)] Loss: 0.33063 (QuantReg: 13.26199) QuantErr: 13.26199 batch_time=0.35797 
Train Epoch: 41 [311/1000 9952/32000 (31%)] Loss: 0.17887 (QuantReg: 13.12809) QuantErr: 13.12809 batch_time=0.39570 
Train Epoch: 41 [316/1000 10112/32000 (32%)] Loss: 0.13490 (QuantReg: 13.53315) QuantErr: 13.53315 batch_time=0.41401 
Train Epoch: 41 [321/1000 10272/32000 (32%)] Loss: 0.28305 (QuantReg: 13.01335) QuantErr: 13.01335 batch_time=0.70529 
Train Epoch: 41 [326/1000 10432/32000 (33%)] Loss: 0.28287 (QuantReg: 13.19975) QuantErr: 13.19975 batch_time=0.37937 
Train Epoch: 41 [331/1000 10592/32000 (33%)] Loss: 0.36206 (QuantReg: 13.29402) QuantErr: 13.29402 batch_time=0.37190 
Train Epoch: 41 [336/1000 10752/32000 (34%)] Loss: 0.39583 (QuantReg: 13.27547) QuantErr: 13.27547 batch_time=0.38985 
Train Epoch: 41 [341/1000 10912/32000 (34%)] Loss: 0.30916 (QuantReg: 12.49877) QuantErr: 12.49877 batch_time=0.35500 
Train Epoch: 41 [346/1000 11072/32000 (35%)] Loss: 0.55559 (QuantReg: 12.71105) QuantErr: 12.71105 batch_time=0.41499 
Train Epoch: 41 [351/1000 11232/32000 (35%)] Loss: 0.18953 (QuantReg: 13.17276) QuantErr: 13.17276 batch_time=0.37054 
Train Epoch: 41 [356/1000 11392/32000 (36%)] Loss: 0.33544 (QuantReg: 13.50808) QuantErr: 13.50808 batch_time=0.36081 
Train Epoch: 41 [361/1000 11552/32000 (36%)] Loss: 0.27060 (QuantReg: 13.26277) QuantErr: 13.26277 batch_time=0.40625 
Train Epoch: 41 [366/1000 11712/32000 (37%)] Loss: 0.27646 (QuantReg: 12.65170) QuantErr: 12.65170 batch_time=0.43094 
Train Epoch: 41 [371/1000 11872/32000 (37%)] Loss: 0.39228 (QuantReg: 13.77535) QuantErr: 13.77535 batch_time=0.53702 
Train Epoch: 41 [376/1000 12032/32000 (38%)] Loss: 0.39778 (QuantReg: 13.15785) QuantErr: 13.15785 batch_time=0.40170 
Train Epoch: 41 [381/1000 12192/32000 (38%)] Loss: 0.38784 (QuantReg: 13.37165) QuantErr: 13.37165 batch_time=0.40993 
Train Epoch: 41 [386/1000 12352/32000 (39%)] Loss: 0.28629 (QuantReg: 13.47939) QuantErr: 13.47939 batch_time=2.39644 
Train Epoch: 41 [391/1000 12512/32000 (39%)] Loss: 0.25937 (QuantReg: 13.50527) QuantErr: 13.50527 batch_time=0.39767 
Train Epoch: 41 [396/1000 12672/32000 (40%)] Loss: 0.43972 (QuantReg: 12.52926) QuantErr: 12.52926 batch_time=0.38750 
Train Epoch: 41 [401/1000 12832/32000 (40%)] Loss: 0.11444 (QuantReg: 13.33464) QuantErr: 13.33464 batch_time=0.36279 
Train Epoch: 41 [406/1000 12992/32000 (41%)] Loss: 0.16525 (QuantReg: 13.48860) QuantErr: 13.48860 batch_time=0.45949 
Train Epoch: 41 [411/1000 13152/32000 (41%)] Loss: 0.58282 (QuantReg: 13.52556) QuantErr: 13.52556 batch_time=0.39521 
Train Epoch: 41 [416/1000 13312/32000 (42%)] Loss: 0.19089 (QuantReg: 13.48325) QuantErr: 13.48325 batch_time=0.35342 
Train Epoch: 41 [421/1000 13472/32000 (42%)] Loss: 0.22094 (QuantReg: 13.69865) QuantErr: 13.69865 batch_time=0.41717 
Train Epoch: 41 [426/1000 13632/32000 (43%)] Loss: 0.82145 (QuantReg: 12.94106) QuantErr: 12.94106 batch_time=0.35829 
Train Epoch: 41 [431/1000 13792/32000 (43%)] Loss: 0.25133 (QuantReg: 12.81625) QuantErr: 12.81625 batch_time=0.35897 
Train Epoch: 41 [436/1000 13952/32000 (44%)] Loss: 0.24378 (QuantReg: 13.17616) QuantErr: 13.17616 batch_time=0.50001 
Train Epoch: 41 [441/1000 14112/32000 (44%)] Loss: 0.37526 (QuantReg: 13.01575) QuantErr: 13.01575 batch_time=0.40463 
Train Epoch: 41 [446/1000 14272/32000 (45%)] Loss: 0.35192 (QuantReg: 13.45311) QuantErr: 13.45311 batch_time=0.35319 
Train Epoch: 41 [451/1000 14432/32000 (45%)] Loss: 0.27832 (QuantReg: 12.49229) QuantErr: 12.49229 batch_time=0.43242 
Train Epoch: 41 [456/1000 14592/32000 (46%)] Loss: 0.23160 (QuantReg: 13.51287) QuantErr: 13.51287 batch_time=0.35523 
Train Epoch: 41 [461/1000 14752/32000 (46%)] Loss: 0.19429 (QuantReg: 12.79832) QuantErr: 12.79832 batch_time=0.36425 
Train Epoch: 41 [466/1000 14912/32000 (47%)] Loss: 0.33449 (QuantReg: 12.89194) QuantErr: 12.89194 batch_time=0.37484 
Train Epoch: 41 [471/1000 15072/32000 (47%)] Loss: 0.21627 (QuantReg: 13.35857) QuantErr: 13.35857 batch_time=0.35508 
Train Epoch: 41 [476/1000 15232/32000 (48%)] Loss: 0.33119 (QuantReg: 13.32501) QuantErr: 13.32501 batch_time=0.35929 
Train Epoch: 41 [481/1000 15392/32000 (48%)] Loss: 0.35229 (QuantReg: 12.82223) QuantErr: 12.82223 batch_time=0.34725 
Train Epoch: 41 [486/1000 15552/32000 (49%)] Loss: 0.40276 (QuantReg: 12.56405) QuantErr: 12.56405 batch_time=0.37492 
Train Epoch: 41 [491/1000 15712/32000 (49%)] Loss: 0.23961 (QuantReg: 13.60028) QuantErr: 13.60028 batch_time=0.37224 
Train Epoch: 41 [496/1000 15872/32000 (50%)] Loss: 0.34196 (QuantReg: 13.01688) QuantErr: 13.01688 batch_time=0.37885 
Train Epoch: 41 [501/1000 16032/32000 (50%)] Loss: 0.44495 (QuantReg: 13.50728) QuantErr: 13.50728 batch_time=0.36078 
Train Epoch: 41 [506/1000 16192/32000 (51%)] Loss: 0.19312 (QuantReg: 13.89647) QuantErr: 13.89647 batch_time=0.36851 
Train Epoch: 41 [511/1000 16352/32000 (51%)] Loss: 0.53765 (QuantReg: 13.48385) QuantErr: 13.48385 batch_time=0.35953 
Train Epoch: 41 [516/1000 16512/32000 (52%)] Loss: 0.39451 (QuantReg: 13.79601) QuantErr: 13.79601 batch_time=0.36069 
Train Epoch: 41 [521/1000 16672/32000 (52%)] Loss: 0.32175 (QuantReg: 13.56271) QuantErr: 13.56271 batch_time=0.38200 
Train Epoch: 41 [526/1000 16832/32000 (53%)] Loss: 0.37460 (QuantReg: 12.69104) QuantErr: 12.69104 batch_time=0.65900 
Train Epoch: 41 [531/1000 16992/32000 (53%)] Loss: 0.39945 (QuantReg: 13.22795) QuantErr: 13.22795 batch_time=0.38194 
Train Epoch: 41 [536/1000 17152/32000 (54%)] Loss: 0.29195 (QuantReg: 13.45326) QuantErr: 13.45326 batch_time=0.36749 
Train Epoch: 41 [541/1000 17312/32000 (54%)] Loss: 0.20920 (QuantReg: 13.64620) QuantErr: 13.64620 batch_time=0.39369 
Train Epoch: 41 [546/1000 17472/32000 (55%)] Loss: 0.25657 (QuantReg: 13.50573) QuantErr: 13.50573 batch_time=0.40039 
Train Epoch: 41 [551/1000 17632/32000 (55%)] Loss: 0.41502 (QuantReg: 13.35587) QuantErr: 13.35587 batch_time=0.39403 
Train Epoch: 41 [556/1000 17792/32000 (56%)] Loss: 0.28647 (QuantReg: 13.65066) QuantErr: 13.65066 batch_time=0.43745 
Train Epoch: 41 [561/1000 17952/32000 (56%)] Loss: 0.64458 (QuantReg: 12.82811) QuantErr: 12.82811 batch_time=0.54893 
Train Epoch: 41 [566/1000 18112/32000 (57%)] Loss: 0.34648 (QuantReg: 13.34814) QuantErr: 13.34814 batch_time=0.40518 
Train Epoch: 41 [571/1000 18272/32000 (57%)] Loss: 0.54622 (QuantReg: 13.00075) QuantErr: 13.00075 batch_time=0.37426 
Train Epoch: 41 [576/1000 18432/32000 (58%)] Loss: 0.34982 (QuantReg: 13.70671) QuantErr: 13.70671 batch_time=0.53532 
Train Epoch: 41 [581/1000 18592/32000 (58%)] Loss: 0.70964 (QuantReg: 13.09206) QuantErr: 13.09206 batch_time=0.40151 
Train Epoch: 41 [586/1000 18752/32000 (59%)] Loss: 0.33528 (QuantReg: 12.81930) QuantErr: 12.81930 batch_time=0.35188 
Train Epoch: 41 [591/1000 18912/32000 (59%)] Loss: 0.24609 (QuantReg: 13.15893) QuantErr: 13.15893 batch_time=1.41868 
Train Epoch: 41 [596/1000 19072/32000 (60%)] Loss: 0.43821 (QuantReg: 13.11156) QuantErr: 13.11156 batch_time=0.36020 
Train Epoch: 41 [601/1000 19232/32000 (60%)] Loss: 0.31451 (QuantReg: 13.14746) QuantErr: 13.14746 batch_time=0.39775 
Train Epoch: 41 [606/1000 19392/32000 (61%)] Loss: 0.21218 (QuantReg: 12.92647) QuantErr: 12.92647 batch_time=0.44443 
Train Epoch: 41 [611/1000 19552/32000 (61%)] Loss: 0.33056 (QuantReg: 12.81157) QuantErr: 12.81157 batch_time=0.41263 
Train Epoch: 41 [616/1000 19712/32000 (62%)] Loss: 0.48925 (QuantReg: 12.67992) QuantErr: 12.67992 batch_time=0.40424 
Train Epoch: 41 [621/1000 19872/32000 (62%)] Loss: 0.33563 (QuantReg: 13.13226) QuantErr: 13.13226 batch_time=0.41419 
Train Epoch: 41 [626/1000 20032/32000 (63%)] Loss: 0.44197 (QuantReg: 13.06529) QuantErr: 13.06529 batch_time=0.47535 
Train Epoch: 41 [631/1000 20192/32000 (63%)] Loss: 0.21951 (QuantReg: 13.21523) QuantErr: 13.21523 batch_time=0.41059 
Train Epoch: 41 [636/1000 20352/32000 (64%)] Loss: 0.16896 (QuantReg: 13.17721) QuantErr: 13.17721 batch_time=0.35461 
Train Epoch: 41 [641/1000 20512/32000 (64%)] Loss: 0.16399 (QuantReg: 13.09044) QuantErr: 13.09044 batch_time=0.37813 
Train Epoch: 41 [646/1000 20672/32000 (65%)] Loss: 0.40439 (QuantReg: 13.25033) QuantErr: 13.25033 batch_time=0.36611 
Train Epoch: 41 [651/1000 20832/32000 (65%)] Loss: 0.36660 (QuantReg: 12.77053) QuantErr: 12.77053 batch_time=0.34508 
Train Epoch: 41 [656/1000 20992/32000 (66%)] Loss: 0.25853 (QuantReg: 13.33539) QuantErr: 13.33539 batch_time=0.35289 
Train Epoch: 41 [661/1000 21152/32000 (66%)] Loss: 0.35420 (QuantReg: 13.07963) QuantErr: 13.07963 batch_time=0.36207 
Train Epoch: 41 [666/1000 21312/32000 (67%)] Loss: 0.25118 (QuantReg: 13.40406) QuantErr: 13.40406 batch_time=0.35504 
Train Epoch: 41 [671/1000 21472/32000 (67%)] Loss: 0.59501 (QuantReg: 12.87174) QuantErr: 12.87174 batch_time=0.34941 
Train Epoch: 41 [676/1000 21632/32000 (68%)] Loss: 0.38875 (QuantReg: 13.22815) QuantErr: 13.22815 batch_time=0.37556 
Train Epoch: 41 [681/1000 21792/32000 (68%)] Loss: 0.35736 (QuantReg: 13.12517) QuantErr: 13.12517 batch_time=0.36329 
Train Epoch: 41 [686/1000 21952/32000 (69%)] Loss: 0.41438 (QuantReg: 13.01327) QuantErr: 13.01327 batch_time=0.34383 
Train Epoch: 41 [691/1000 22112/32000 (69%)] Loss: 0.25398 (QuantReg: 13.12749) QuantErr: 13.12749 batch_time=0.35210 
Train Epoch: 41 [696/1000 22272/32000 (70%)] Loss: 0.39599 (QuantReg: 12.71451) QuantErr: 12.71451 batch_time=0.35723 
Train Epoch: 41 [701/1000 22432/32000 (70%)] Loss: 0.53278 (QuantReg: 13.27416) QuantErr: 13.27416 batch_time=1.03268 
Train Epoch: 41 [706/1000 22592/32000 (71%)] Loss: 0.35340 (QuantReg: 13.44312) QuantErr: 13.44312 batch_time=0.44358 
Train Epoch: 41 [711/1000 22752/32000 (71%)] Loss: 0.26721 (QuantReg: 13.49969) QuantErr: 13.49969 batch_time=0.37080 
Train Epoch: 41 [716/1000 22912/32000 (72%)] Loss: 0.18215 (QuantReg: 13.39804) QuantErr: 13.39804 batch_time=0.37997 
Train Epoch: 41 [721/1000 23072/32000 (72%)] Loss: 0.17109 (QuantReg: 12.78477) QuantErr: 12.78477 batch_time=0.37240 
Train Epoch: 41 [726/1000 23232/32000 (73%)] Loss: 0.47968 (QuantReg: 13.51575) QuantErr: 13.51575 batch_time=0.41632 
Train Epoch: 41 [731/1000 23392/32000 (73%)] Loss: 0.42732 (QuantReg: 13.44832) QuantErr: 13.44832 batch_time=0.39011 
Train Epoch: 41 [736/1000 23552/32000 (74%)] Loss: 0.66265 (QuantReg: 12.90177) QuantErr: 12.90177 batch_time=0.41495 
Train Epoch: 41 [741/1000 23712/32000 (74%)] Loss: 0.38543 (QuantReg: 12.78672) QuantErr: 12.78672 batch_time=0.55941 
Train Epoch: 41 [746/1000 23872/32000 (75%)] Loss: 0.36028 (QuantReg: 13.34348) QuantErr: 13.34348 batch_time=0.37764 
Train Epoch: 41 [751/1000 24032/32000 (75%)] Loss: 0.45089 (QuantReg: 12.99964) QuantErr: 12.99964 batch_time=0.40500 
Train Epoch: 41 [756/1000 24192/32000 (76%)] Loss: 0.54267 (QuantReg: 12.26706) QuantErr: 12.26706 batch_time=0.43178 
Train Epoch: 41 [761/1000 24352/32000 (76%)] Loss: 0.28389 (QuantReg: 13.58123) QuantErr: 13.58123 batch_time=0.49811 
Train Epoch: 41 [766/1000 24512/32000 (77%)] Loss: 0.55421 (QuantReg: 12.30443) QuantErr: 12.30443 batch_time=0.42849 
Train Epoch: 41 [771/1000 24672/32000 (77%)] Loss: 0.75225 (QuantReg: 13.32316) QuantErr: 13.32316 batch_time=0.38142 
Train Epoch: 41 [776/1000 24832/32000 (78%)] Loss: 0.21050 (QuantReg: 13.42967) QuantErr: 13.42967 batch_time=0.50063 
Train Epoch: 41 [781/1000 24992/32000 (78%)] Loss: 0.37315 (QuantReg: 13.18868) QuantErr: 13.18868 batch_time=0.40996 
Train Epoch: 41 [786/1000 25152/32000 (79%)] Loss: 0.25527 (QuantReg: 13.44948) QuantErr: 13.44948 batch_time=0.41013 
Train Epoch: 41 [791/1000 25312/32000 (79%)] Loss: 0.13085 (QuantReg: 13.30144) QuantErr: 13.30144 batch_time=0.36826 
Train Epoch: 41 [796/1000 25472/32000 (80%)] Loss: 0.16255 (QuantReg: 12.64626) QuantErr: 12.64626 batch_time=0.48442 
Train Epoch: 41 [801/1000 25632/32000 (80%)] Loss: 0.44516 (QuantReg: 12.99059) QuantErr: 12.99059 batch_time=0.36074 
Train Epoch: 41 [806/1000 25792/32000 (81%)] Loss: 0.24128 (QuantReg: 13.35869) QuantErr: 13.35869 batch_time=0.42849 
Train Epoch: 41 [811/1000 25952/32000 (81%)] Loss: 0.43794 (QuantReg: 13.78334) QuantErr: 13.78334 batch_time=1.32888 
Train Epoch: 41 [816/1000 26112/32000 (82%)] Loss: 0.56895 (QuantReg: 13.02292) QuantErr: 13.02292 batch_time=0.43236 
Train Epoch: 41 [821/1000 26272/32000 (82%)] Loss: 0.39722 (QuantReg: 13.58072) QuantErr: 13.58072 batch_time=0.38935 
Train Epoch: 41 [826/1000 26432/32000 (83%)] Loss: 0.45079 (QuantReg: 13.14013) QuantErr: 13.14013 batch_time=0.47912 
Train Epoch: 41 [831/1000 26592/32000 (83%)] Loss: 0.21016 (QuantReg: 13.30415) QuantErr: 13.30415 batch_time=0.36668 
Train Epoch: 41 [836/1000 26752/32000 (84%)] Loss: 0.26119 (QuantReg: 13.45788) QuantErr: 13.45788 batch_time=0.39398 
Train Epoch: 41 [841/1000 26912/32000 (84%)] Loss: 0.42995 (QuantReg: 13.16397) QuantErr: 13.16397 batch_time=0.42320 
Train Epoch: 41 [846/1000 27072/32000 (85%)] Loss: 0.71559 (QuantReg: 12.76317) QuantErr: 12.76317 batch_time=0.38848 
Train Epoch: 41 [851/1000 27232/32000 (85%)] Loss: 0.16398 (QuantReg: 13.06044) QuantErr: 13.06044 batch_time=0.36786 
Train Epoch: 41 [856/1000 27392/32000 (86%)] Loss: 0.21558 (QuantReg: 13.16233) QuantErr: 13.16233 batch_time=0.38500 
Train Epoch: 41 [861/1000 27552/32000 (86%)] Loss: 0.17149 (QuantReg: 13.77900) QuantErr: 13.77900 batch_time=0.48835 
Train Epoch: 41 [866/1000 27712/32000 (87%)] Loss: 0.34084 (QuantReg: 12.72809) QuantErr: 12.72809 batch_time=0.95884 
Train Epoch: 41 [871/1000 27872/32000 (87%)] Loss: 0.33251 (QuantReg: 13.03119) QuantErr: 13.03119 batch_time=0.35714 
Train Epoch: 41 [876/1000 28032/32000 (88%)] Loss: 0.36033 (QuantReg: 13.39042) QuantErr: 13.39042 batch_time=0.37581 
Train Epoch: 41 [881/1000 28192/32000 (88%)] Loss: 0.20055 (QuantReg: 13.66656) QuantErr: 13.66656 batch_time=0.38762 
Train Epoch: 41 [886/1000 28352/32000 (89%)] Loss: 0.21751 (QuantReg: 13.37653) QuantErr: 13.37653 batch_time=0.38240 
Train Epoch: 41 [891/1000 28512/32000 (89%)] Loss: 0.08071 (QuantReg: 13.66551) QuantErr: 13.66551 batch_time=0.36786 
Train Epoch: 41 [896/1000 28672/32000 (90%)] Loss: 0.50970 (QuantReg: 12.91399) QuantErr: 12.91399 batch_time=0.36429 
Train Epoch: 41 [901/1000 28832/32000 (90%)] Loss: 0.26517 (QuantReg: 12.90795) QuantErr: 12.90795 batch_time=0.52400 
Train Epoch: 41 [906/1000 28992/32000 (91%)] Loss: 0.56241 (QuantReg: 12.65849) QuantErr: 12.65849 batch_time=0.37355 
Train Epoch: 41 [911/1000 29152/32000 (91%)] Loss: 0.18715 (QuantReg: 13.58555) QuantErr: 13.58555 batch_time=0.57694 
Train Epoch: 41 [916/1000 29312/32000 (92%)] Loss: 0.14611 (QuantReg: 13.31890) QuantErr: 13.31890 batch_time=0.40705 
Train Epoch: 41 [921/1000 29472/32000 (92%)] Loss: 0.28291 (QuantReg: 13.57830) QuantErr: 13.57830 batch_time=0.37065 
Train Epoch: 41 [926/1000 29632/32000 (93%)] Loss: 0.29633 (QuantReg: 13.70648) QuantErr: 13.70648 batch_time=0.36701 
Train Epoch: 41 [931/1000 29792/32000 (93%)] Loss: 0.19530 (QuantReg: 13.19626) QuantErr: 13.19626 batch_time=0.52919 
Train Epoch: 41 [936/1000 29952/32000 (94%)] Loss: 0.44568 (QuantReg: 13.32286) QuantErr: 13.32286 batch_time=0.38704 
Train Epoch: 41 [941/1000 30112/32000 (94%)] Loss: 0.14881 (QuantReg: 12.38702) QuantErr: 12.38702 batch_time=0.40609 
Train Epoch: 41 [946/1000 30272/32000 (95%)] Loss: 0.56028 (QuantReg: 12.30721) QuantErr: 12.30721 batch_time=0.35696 
Train Epoch: 41 [951/1000 30432/32000 (95%)] Loss: 0.27961 (QuantReg: 13.02182) QuantErr: 13.02182 batch_time=0.35931 
Train Epoch: 41 [956/1000 30592/32000 (96%)] Loss: 0.45722 (QuantReg: 12.24668) QuantErr: 12.24668 batch_time=0.41760 
Train Epoch: 41 [961/1000 30752/32000 (96%)] Loss: 0.24349 (QuantReg: 12.98404) QuantErr: 12.98404 batch_time=0.35022 
Train Epoch: 41 [966/1000 30912/32000 (97%)] Loss: 0.06507 (QuantReg: 13.04055) QuantErr: 13.04055 batch_time=0.42360 
Train Epoch: 41 [971/1000 31072/32000 (97%)] Loss: 0.47118 (QuantReg: 12.79505) QuantErr: 12.79505 batch_time=0.36874 
Train Epoch: 41 [976/1000 31232/32000 (98%)] Loss: 0.51309 (QuantReg: 12.92812) QuantErr: 12.92812 batch_time=0.37289 
Train Epoch: 41 [981/1000 31392/32000 (98%)] Loss: 0.26713 (QuantReg: 13.64972) QuantErr: 13.64972 batch_time=0.35683 
Train Epoch: 41 [986/1000 31552/32000 (99%)] Loss: 0.14316 (QuantReg: 13.83575) QuantErr: 13.83575 batch_time=0.35806 
Train Epoch: 41 [991/1000 31712/32000 (99%)] Loss: 0.48079 (QuantReg: 12.25064) QuantErr: 12.25064 batch_time=0.36277 
Train Epoch: 41 [996/1000 31872/32000 (100%)] Loss: 0.24140 (QuantReg: 13.25899) QuantErr: 13.25899 batch_time=0.35295 
Train Epoch: 41 codebook_update_time=1.67610
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch41.pth ...
Done in 5.202s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 0.3196492147967219
 quant_reg      : 13.188111243247986
 quant_err      : 13.188111243247986
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 41000
 MSRVTT_miech_test/t2v_metrics/R1: 20.8
 MSRVTT_miech_test/t2v_metrics/R5: 50.9
 MSRVTT_miech_test/t2v_metrics/R10: 64.6
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.227
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.895094092571455
 MSRVTT_miech_test/v2t_metrics/R1: 21.4
 MSRVTT_miech_test/v2t_metrics/R5: 53.2
 MSRVTT_miech_test/v2t_metrics/R10: 66.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.012
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.19779717917656
 mnt_best       : 41.036608587691525
 not_improved_count: 7
Train Epoch: 42 [1/1000 32/32000 (0%)] Loss: 0.35287 (QuantReg: 13.17903) QuantErr: 13.17903 batch_time=28.54071 
Train Epoch: 42 [6/1000 192/32000 (1%)] Loss: 0.21648 (QuantReg: 12.69444) QuantErr: 12.69444 batch_time=0.62598 
Train Epoch: 42 [11/1000 352/32000 (1%)] Loss: 0.45690 (QuantReg: 13.23101) QuantErr: 13.23101 batch_time=0.39505 
Train Epoch: 42 [16/1000 512/32000 (2%)] Loss: 0.25232 (QuantReg: 12.75727) QuantErr: 12.75727 batch_time=0.46059 
Train Epoch: 42 [21/1000 672/32000 (2%)] Loss: 0.52643 (QuantReg: 13.53178) QuantErr: 13.53178 batch_time=0.46324 
Train Epoch: 42 [26/1000 832/32000 (3%)] Loss: 0.32570 (QuantReg: 13.38886) QuantErr: 13.38886 batch_time=0.38655 
Train Epoch: 42 [31/1000 992/32000 (3%)] Loss: 0.16936 (QuantReg: 12.92292) QuantErr: 12.92292 batch_time=0.44026 
Train Epoch: 42 [36/1000 1152/32000 (4%)] Loss: 0.21484 (QuantReg: 13.73797) QuantErr: 13.73797 batch_time=0.43956 
Train Epoch: 42 [41/1000 1312/32000 (4%)] Loss: 0.30335 (QuantReg: 12.95323) QuantErr: 12.95323 batch_time=0.44661 
Train Epoch: 42 [46/1000 1472/32000 (5%)] Loss: 0.42715 (QuantReg: 13.08381) QuantErr: 13.08381 batch_time=0.36596 
Train Epoch: 42 [51/1000 1632/32000 (5%)] Loss: 0.18115 (QuantReg: 13.16523) QuantErr: 13.16523 batch_time=0.38744 
Train Epoch: 42 [56/1000 1792/32000 (6%)] Loss: 0.45349 (QuantReg: 13.32362) QuantErr: 13.32362 batch_time=0.44960 
Train Epoch: 42 [61/1000 1952/32000 (6%)] Loss: 0.15493 (QuantReg: 13.12322) QuantErr: 13.12322 batch_time=0.49349 
Train Epoch: 42 [66/1000 2112/32000 (7%)] Loss: 0.66706 (QuantReg: 12.72359) QuantErr: 12.72359 batch_time=0.57629 
Train Epoch: 42 [71/1000 2272/32000 (7%)] Loss: 0.26333 (QuantReg: 13.41502) QuantErr: 13.41502 batch_time=1.63652 
Train Epoch: 42 [76/1000 2432/32000 (8%)] Loss: 0.22953 (QuantReg: 12.74089) QuantErr: 12.74089 batch_time=0.58522 
Train Epoch: 42 [81/1000 2592/32000 (8%)] Loss: 0.08084 (QuantReg: 12.94882) QuantErr: 12.94882 batch_time=0.37722 
Train Epoch: 42 [86/1000 2752/32000 (9%)] Loss: 0.19317 (QuantReg: 13.14119) QuantErr: 13.14119 batch_time=0.39630 
Train Epoch: 42 [91/1000 2912/32000 (9%)] Loss: 0.36414 (QuantReg: 12.51082) QuantErr: 12.51082 batch_time=0.42947 
Train Epoch: 42 [96/1000 3072/32000 (10%)] Loss: 0.32224 (QuantReg: 12.84369) QuantErr: 12.84369 batch_time=0.35824 
Train Epoch: 42 [101/1000 3232/32000 (10%)] Loss: 0.26842 (QuantReg: 13.14135) QuantErr: 13.14135 batch_time=0.36909 
Train Epoch: 42 [106/1000 3392/32000 (11%)] Loss: 0.69350 (QuantReg: 13.58297) QuantErr: 13.58297 batch_time=0.41966 
Train Epoch: 42 [111/1000 3552/32000 (11%)] Loss: 0.14896 (QuantReg: 13.56307) QuantErr: 13.56307 batch_time=0.36337 
Train Epoch: 42 [116/1000 3712/32000 (12%)] Loss: 0.46405 (QuantReg: 13.40843) QuantErr: 13.40843 batch_time=0.41128 
Train Epoch: 42 [121/1000 3872/32000 (12%)] Loss: 0.22208 (QuantReg: 13.15530) QuantErr: 13.15530 batch_time=0.33626 
Train Epoch: 42 [126/1000 4032/32000 (13%)] Loss: 0.47213 (QuantReg: 12.45230) QuantErr: 12.45230 batch_time=0.40309 
Train Epoch: 42 [131/1000 4192/32000 (13%)] Loss: 0.21342 (QuantReg: 13.16636) QuantErr: 13.16636 batch_time=0.43515 
Train Epoch: 42 [136/1000 4352/32000 (14%)] Loss: 0.22769 (QuantReg: 13.59346) QuantErr: 13.59346 batch_time=0.39917 
Train Epoch: 42 [141/1000 4512/32000 (14%)] Loss: 0.32485 (QuantReg: 13.66108) QuantErr: 13.66108 batch_time=0.44972 
Train Epoch: 42 [146/1000 4672/32000 (15%)] Loss: 0.05445 (QuantReg: 13.33924) QuantErr: 13.33924 batch_time=0.37434 
Train Epoch: 42 [151/1000 4832/32000 (15%)] Loss: 0.12611 (QuantReg: 12.77074) QuantErr: 12.77074 batch_time=0.38676 
Train Epoch: 42 [156/1000 4992/32000 (16%)] Loss: 0.20003 (QuantReg: 13.40686) QuantErr: 13.40686 batch_time=0.39171 
Train Epoch: 42 [161/1000 5152/32000 (16%)] Loss: 0.25513 (QuantReg: 13.53660) QuantErr: 13.53660 batch_time=0.36272 
Train Epoch: 42 [166/1000 5312/32000 (17%)] Loss: 0.67507 (QuantReg: 13.86256) QuantErr: 13.86256 batch_time=0.61815 
Train Epoch: 42 [171/1000 5472/32000 (17%)] Loss: 0.23809 (QuantReg: 13.08876) QuantErr: 13.08876 batch_time=0.38866 
Train Epoch: 42 [176/1000 5632/32000 (18%)] Loss: 0.32846 (QuantReg: 13.24898) QuantErr: 13.24898 batch_time=0.42471 
Train Epoch: 42 [181/1000 5792/32000 (18%)] Loss: 0.25659 (QuantReg: 13.05727) QuantErr: 13.05727 batch_time=0.53059 
Train Epoch: 42 [186/1000 5952/32000 (19%)] Loss: 0.72954 (QuantReg: 13.33675) QuantErr: 13.33675 batch_time=0.44335 
Train Epoch: 42 [191/1000 6112/32000 (19%)] Loss: 0.18687 (QuantReg: 12.70656) QuantErr: 12.70656 batch_time=0.36334 
Train Epoch: 42 [196/1000 6272/32000 (20%)] Loss: 0.64673 (QuantReg: 12.70516) QuantErr: 12.70516 batch_time=0.56956 
Train Epoch: 42 [201/1000 6432/32000 (20%)] Loss: 0.31933 (QuantReg: 12.95466) QuantErr: 12.95466 batch_time=0.35304 
Train Epoch: 42 [206/1000 6592/32000 (21%)] Loss: 0.19519 (QuantReg: 13.03186) QuantErr: 13.03186 batch_time=0.43777 
Train Epoch: 42 [211/1000 6752/32000 (21%)] Loss: 0.21774 (QuantReg: 13.30903) QuantErr: 13.30903 batch_time=0.35147 
Train Epoch: 42 [216/1000 6912/32000 (22%)] Loss: 0.21352 (QuantReg: 12.33313) QuantErr: 12.33313 batch_time=0.59109 
Train Epoch: 42 [221/1000 7072/32000 (22%)] Loss: 0.18809 (QuantReg: 13.41164) QuantErr: 13.41164 batch_time=0.36384 
Train Epoch: 42 [226/1000 7232/32000 (23%)] Loss: 0.24828 (QuantReg: 13.59727) QuantErr: 13.59727 batch_time=0.41640 
Train Epoch: 42 [231/1000 7392/32000 (23%)] Loss: 0.71872 (QuantReg: 13.11059) QuantErr: 13.11059 batch_time=0.46885 
Train Epoch: 42 [236/1000 7552/32000 (24%)] Loss: 0.57015 (QuantReg: 13.38394) QuantErr: 13.38394 batch_time=0.35795 
Train Epoch: 42 [241/1000 7712/32000 (24%)] Loss: 0.19612 (QuantReg: 13.28824) QuantErr: 13.28824 batch_time=0.44184 
Train Epoch: 42 [246/1000 7872/32000 (25%)] Loss: 0.19666 (QuantReg: 13.37550) QuantErr: 13.37550 batch_time=0.36042 
Train Epoch: 42 [251/1000 8032/32000 (25%)] Loss: 0.27368 (QuantReg: 13.13591) QuantErr: 13.13591 batch_time=0.43306 
Train Epoch: 42 [256/1000 8192/32000 (26%)] Loss: 0.34378 (QuantReg: 13.21352) QuantErr: 13.21352 batch_time=0.48187 
Train Epoch: 42 [261/1000 8352/32000 (26%)] Loss: 0.27431 (QuantReg: 13.79745) QuantErr: 13.79745 batch_time=0.46623 
Train Epoch: 42 [266/1000 8512/32000 (27%)] Loss: 0.43799 (QuantReg: 13.18355) QuantErr: 13.18355 batch_time=0.42688 
Train Epoch: 42 [271/1000 8672/32000 (27%)] Loss: 0.29635 (QuantReg: 13.30846) QuantErr: 13.30846 batch_time=0.37048 
Train Epoch: 42 [276/1000 8832/32000 (28%)] Loss: 0.39510 (QuantReg: 12.73431) QuantErr: 12.73431 batch_time=0.43785 
Train Epoch: 42 [281/1000 8992/32000 (28%)] Loss: 0.29021 (QuantReg: 13.48872) QuantErr: 13.48872 batch_time=0.45517 
Train Epoch: 42 [286/1000 9152/32000 (29%)] Loss: 0.59568 (QuantReg: 13.24331) QuantErr: 13.24331 batch_time=0.36472 
Train Epoch: 42 [291/1000 9312/32000 (29%)] Loss: 0.18447 (QuantReg: 13.17650) QuantErr: 13.17650 batch_time=0.45643 
Train Epoch: 42 [296/1000 9472/32000 (30%)] Loss: 0.17361 (QuantReg: 13.69816) QuantErr: 13.69816 batch_time=0.41308 
Train Epoch: 42 [301/1000 9632/32000 (30%)] Loss: 0.38742 (QuantReg: 13.59420) QuantErr: 13.59420 batch_time=0.34369 
Train Epoch: 42 [306/1000 9792/32000 (31%)] Loss: 0.31411 (QuantReg: 13.68439) QuantErr: 13.68439 batch_time=0.58450 
Train Epoch: 42 [311/1000 9952/32000 (31%)] Loss: 0.17255 (QuantReg: 13.48436) QuantErr: 13.48436 batch_time=0.38693 
Train Epoch: 42 [316/1000 10112/32000 (32%)] Loss: 0.12558 (QuantReg: 13.37190) QuantErr: 13.37190 batch_time=0.36956 
Train Epoch: 42 [321/1000 10272/32000 (32%)] Loss: 0.62232 (QuantReg: 13.55182) QuantErr: 13.55182 batch_time=0.82506 
Train Epoch: 42 [326/1000 10432/32000 (33%)] Loss: 0.14490 (QuantReg: 13.88267) QuantErr: 13.88267 batch_time=0.36486 
Train Epoch: 42 [331/1000 10592/32000 (33%)] Loss: 0.11020 (QuantReg: 13.15376) QuantErr: 13.15376 batch_time=0.37877 
Train Epoch: 42 [336/1000 10752/32000 (34%)] Loss: 0.49188 (QuantReg: 12.90413) QuantErr: 12.90413 batch_time=0.39609 
Train Epoch: 42 [341/1000 10912/32000 (34%)] Loss: 0.54429 (QuantReg: 12.95229) QuantErr: 12.95229 batch_time=0.37613 
Train Epoch: 42 [346/1000 11072/32000 (35%)] Loss: 0.15943 (QuantReg: 13.64618) QuantErr: 13.64618 batch_time=0.38173 
Train Epoch: 42 [351/1000 11232/32000 (35%)] Loss: 0.12600 (QuantReg: 13.29208) QuantErr: 13.29208 batch_time=0.47940 
Train Epoch: 42 [356/1000 11392/32000 (36%)] Loss: 0.25615 (QuantReg: 13.29008) QuantErr: 13.29008 batch_time=0.46567 
Train Epoch: 42 [361/1000 11552/32000 (36%)] Loss: 0.52568 (QuantReg: 13.26209) QuantErr: 13.26209 batch_time=0.38798 
Train Epoch: 42 [366/1000 11712/32000 (37%)] Loss: 0.32817 (QuantReg: 13.28098) QuantErr: 13.28098 batch_time=0.40852 
Train Epoch: 42 [371/1000 11872/32000 (37%)] Loss: 0.57617 (QuantReg: 12.17357) QuantErr: 12.17357 batch_time=0.36148 
Train Epoch: 42 [376/1000 12032/32000 (38%)] Loss: 0.34393 (QuantReg: 12.62743) QuantErr: 12.62743 batch_time=0.38874 
Train Epoch: 42 [381/1000 12192/32000 (38%)] Loss: 0.27121 (QuantReg: 13.74351) QuantErr: 13.74351 batch_time=0.35993 
Train Epoch: 42 [386/1000 12352/32000 (39%)] Loss: 0.49493 (QuantReg: 13.30686) QuantErr: 13.30686 batch_time=0.62763 
Train Epoch: 42 [391/1000 12512/32000 (39%)] Loss: 0.33479 (QuantReg: 13.30410) QuantErr: 13.30410 batch_time=0.52961 
Train Epoch: 42 [396/1000 12672/32000 (40%)] Loss: 0.25404 (QuantReg: 13.42888) QuantErr: 13.42888 batch_time=0.36147 
Train Epoch: 42 [401/1000 12832/32000 (40%)] Loss: 0.16752 (QuantReg: 13.53393) QuantErr: 13.53393 batch_time=0.38974 
Train Epoch: 42 [406/1000 12992/32000 (41%)] Loss: 0.11170 (QuantReg: 13.45614) QuantErr: 13.45614 batch_time=0.37313 
Train Epoch: 42 [411/1000 13152/32000 (41%)] Loss: 0.16915 (QuantReg: 13.74422) QuantErr: 13.74422 batch_time=0.40062 
Train Epoch: 42 [416/1000 13312/32000 (42%)] Loss: 0.23906 (QuantReg: 12.94417) QuantErr: 12.94417 batch_time=0.36302 
Train Epoch: 42 [421/1000 13472/32000 (42%)] Loss: 0.48512 (QuantReg: 13.49077) QuantErr: 13.49077 batch_time=0.37023 
Train Epoch: 42 [426/1000 13632/32000 (43%)] Loss: 0.24568 (QuantReg: 13.86116) QuantErr: 13.86116 batch_time=0.36940 
Train Epoch: 42 [431/1000 13792/32000 (43%)] Loss: 0.15216 (QuantReg: 13.05725) QuantErr: 13.05725 batch_time=0.35301 
Train Epoch: 42 [436/1000 13952/32000 (44%)] Loss: 0.30124 (QuantReg: 12.65762) QuantErr: 12.65762 batch_time=0.34770 
Train Epoch: 42 [441/1000 14112/32000 (44%)] Loss: 0.10536 (QuantReg: 13.67049) QuantErr: 13.67049 batch_time=0.34749 
Train Epoch: 42 [446/1000 14272/32000 (45%)] Loss: 0.40975 (QuantReg: 13.46264) QuantErr: 13.46264 batch_time=0.36100 
Train Epoch: 42 [451/1000 14432/32000 (45%)] Loss: 0.20182 (QuantReg: 13.41683) QuantErr: 13.41683 batch_time=0.37659 
Train Epoch: 42 [456/1000 14592/32000 (46%)] Loss: 0.19910 (QuantReg: 12.98108) QuantErr: 12.98108 batch_time=0.35270 
Train Epoch: 42 [461/1000 14752/32000 (46%)] Loss: 0.11989 (QuantReg: 12.90796) QuantErr: 12.90796 batch_time=0.36057 
Train Epoch: 42 [466/1000 14912/32000 (47%)] Loss: 0.62480 (QuantReg: 12.78653) QuantErr: 12.78653 batch_time=0.35547 
Train Epoch: 42 [471/1000 15072/32000 (47%)] Loss: 0.08823 (QuantReg: 13.08506) QuantErr: 13.08506 batch_time=0.38586 
Train Epoch: 42 [476/1000 15232/32000 (48%)] Loss: 0.39156 (QuantReg: 13.21008) QuantErr: 13.21008 batch_time=0.38029 
Train Epoch: 42 [481/1000 15392/32000 (48%)] Loss: 0.45926 (QuantReg: 12.51245) QuantErr: 12.51245 batch_time=0.42420 
Train Epoch: 42 [486/1000 15552/32000 (49%)] Loss: 0.23575 (QuantReg: 13.45854) QuantErr: 13.45854 batch_time=0.51690 
Train Epoch: 42 [491/1000 15712/32000 (49%)] Loss: 0.19020 (QuantReg: 13.36969) QuantErr: 13.36969 batch_time=0.35427 
Train Epoch: 42 [496/1000 15872/32000 (50%)] Loss: 0.57449 (QuantReg: 12.90631) QuantErr: 12.90631 batch_time=0.35856 
Train Epoch: 42 [501/1000 16032/32000 (50%)] Loss: 0.18712 (QuantReg: 13.99091) QuantErr: 13.99091 batch_time=0.38234 
Train Epoch: 42 [506/1000 16192/32000 (51%)] Loss: 0.32230 (QuantReg: 12.84537) QuantErr: 12.84537 batch_time=0.35862 
Train Epoch: 42 [511/1000 16352/32000 (51%)] Loss: 0.16887 (QuantReg: 13.55389) QuantErr: 13.55389 batch_time=0.37459 
Train Epoch: 42 [516/1000 16512/32000 (52%)] Loss: 0.18212 (QuantReg: 13.28740) QuantErr: 13.28740 batch_time=0.38341 
Train Epoch: 42 [521/1000 16672/32000 (52%)] Loss: 0.25543 (QuantReg: 13.62972) QuantErr: 13.62972 batch_time=0.36962 
Train Epoch: 42 [526/1000 16832/32000 (53%)] Loss: 0.63932 (QuantReg: 12.34388) QuantErr: 12.34388 batch_time=0.35606 
Train Epoch: 42 [531/1000 16992/32000 (53%)] Loss: 0.34367 (QuantReg: 13.17414) QuantErr: 13.17414 batch_time=0.36958 
Train Epoch: 42 [536/1000 17152/32000 (54%)] Loss: 0.50915 (QuantReg: 12.75616) QuantErr: 12.75616 batch_time=0.39142 
Train Epoch: 42 [541/1000 17312/32000 (54%)] Loss: 0.42956 (QuantReg: 13.49609) QuantErr: 13.49609 batch_time=0.47821 
Train Epoch: 42 [546/1000 17472/32000 (55%)] Loss: 0.46800 (QuantReg: 13.33535) QuantErr: 13.33535 batch_time=0.38910 
Train Epoch: 42 [551/1000 17632/32000 (55%)] Loss: 0.42159 (QuantReg: 13.75624) QuantErr: 13.75624 batch_time=0.37656 
Train Epoch: 42 [556/1000 17792/32000 (56%)] Loss: 0.22721 (QuantReg: 12.78263) QuantErr: 12.78263 batch_time=1.94538 
Train Epoch: 42 [561/1000 17952/32000 (56%)] Loss: 0.35974 (QuantReg: 13.15341) QuantErr: 13.15341 batch_time=0.41854 
Train Epoch: 42 [566/1000 18112/32000 (57%)] Loss: 0.24213 (QuantReg: 12.99630) QuantErr: 12.99630 batch_time=0.37422 
Train Epoch: 42 [571/1000 18272/32000 (57%)] Loss: 0.59256 (QuantReg: 13.17264) QuantErr: 13.17264 batch_time=0.36148 
Train Epoch: 42 [576/1000 18432/32000 (58%)] Loss: 0.20359 (QuantReg: 13.24216) QuantErr: 13.24216 batch_time=0.36724 
Train Epoch: 42 [581/1000 18592/32000 (58%)] Loss: 0.61435 (QuantReg: 13.38228) QuantErr: 13.38228 batch_time=0.35426 
Train Epoch: 42 [586/1000 18752/32000 (59%)] Loss: 0.47723 (QuantReg: 12.85372) QuantErr: 12.85372 batch_time=0.37952 
Train Epoch: 42 [591/1000 18912/32000 (59%)] Loss: 0.16710 (QuantReg: 13.01457) QuantErr: 13.01457 batch_time=0.35792 
Train Epoch: 42 [596/1000 19072/32000 (60%)] Loss: 0.31828 (QuantReg: 13.62603) QuantErr: 13.62603 batch_time=0.36190 
Train Epoch: 42 [601/1000 19232/32000 (60%)] Loss: 0.22826 (QuantReg: 13.04265) QuantErr: 13.04265 batch_time=0.35631 
Train Epoch: 42 [606/1000 19392/32000 (61%)] Loss: 0.24329 (QuantReg: 13.06427) QuantErr: 13.06427 batch_time=0.35837 
Train Epoch: 42 [611/1000 19552/32000 (61%)] Loss: 0.36516 (QuantReg: 13.02318) QuantErr: 13.02318 batch_time=0.36955 
Train Epoch: 42 [616/1000 19712/32000 (62%)] Loss: 0.44133 (QuantReg: 12.63577) QuantErr: 12.63577 batch_time=0.54508 
Train Epoch: 42 [621/1000 19872/32000 (62%)] Loss: 0.33759 (QuantReg: 13.20884) QuantErr: 13.20884 batch_time=0.43470 
Train Epoch: 42 [626/1000 20032/32000 (63%)] Loss: 0.59471 (QuantReg: 12.52260) QuantErr: 12.52260 batch_time=0.39241 
Train Epoch: 42 [631/1000 20192/32000 (63%)] Loss: 0.44185 (QuantReg: 13.40019) QuantErr: 13.40019 batch_time=0.39932 
Train Epoch: 42 [636/1000 20352/32000 (64%)] Loss: 0.41124 (QuantReg: 13.41626) QuantErr: 13.41626 batch_time=0.39769 
Train Epoch: 42 [641/1000 20512/32000 (64%)] Loss: 0.35553 (QuantReg: 12.95333) QuantErr: 12.95333 batch_time=0.39732 
Train Epoch: 42 [646/1000 20672/32000 (65%)] Loss: 0.09684 (QuantReg: 13.69429) QuantErr: 13.69429 batch_time=0.37128 
Train Epoch: 42 [651/1000 20832/32000 (65%)] Loss: 0.35838 (QuantReg: 12.58165) QuantErr: 12.58165 batch_time=0.36698 
Train Epoch: 42 [656/1000 20992/32000 (66%)] Loss: 0.31462 (QuantReg: 13.58308) QuantErr: 13.58308 batch_time=0.41952 
Train Epoch: 42 [661/1000 21152/32000 (66%)] Loss: 0.16631 (QuantReg: 13.18427) QuantErr: 13.18427 batch_time=0.39551 
Train Epoch: 42 [666/1000 21312/32000 (67%)] Loss: 0.27582 (QuantReg: 13.36006) QuantErr: 13.36006 batch_time=0.36617 
Train Epoch: 42 [671/1000 21472/32000 (67%)] Loss: 0.38616 (QuantReg: 13.20076) QuantErr: 13.20076 batch_time=0.50000 
Train Epoch: 42 [676/1000 21632/32000 (68%)] Loss: 0.64990 (QuantReg: 13.13344) QuantErr: 13.13344 batch_time=0.38084 
Train Epoch: 42 [681/1000 21792/32000 (68%)] Loss: 0.17399 (QuantReg: 13.34819) QuantErr: 13.34819 batch_time=0.39102 
Train Epoch: 42 [686/1000 21952/32000 (69%)] Loss: 0.40345 (QuantReg: 13.57855) QuantErr: 13.57855 batch_time=0.40078 
Train Epoch: 42 [691/1000 22112/32000 (69%)] Loss: 0.11739 (QuantReg: 12.94868) QuantErr: 12.94868 batch_time=0.43955 
Train Epoch: 42 [696/1000 22272/32000 (70%)] Loss: 0.32966 (QuantReg: 13.50617) QuantErr: 13.50617 batch_time=0.46185 
Train Epoch: 42 [701/1000 22432/32000 (70%)] Loss: 0.48778 (QuantReg: 12.52354) QuantErr: 12.52354 batch_time=0.36945 
Train Epoch: 42 [706/1000 22592/32000 (71%)] Loss: 0.23563 (QuantReg: 13.75900) QuantErr: 13.75900 batch_time=0.44775 
Train Epoch: 42 [711/1000 22752/32000 (71%)] Loss: 0.28338 (QuantReg: 13.17747) QuantErr: 13.17747 batch_time=1.04963 
Train Epoch: 42 [716/1000 22912/32000 (72%)] Loss: 0.39553 (QuantReg: 12.98499) QuantErr: 12.98499 batch_time=0.39052 
Train Epoch: 42 [721/1000 23072/32000 (72%)] Loss: 0.26579 (QuantReg: 13.58207) QuantErr: 13.58207 batch_time=0.50350 
Train Epoch: 42 [726/1000 23232/32000 (73%)] Loss: 0.39199 (QuantReg: 13.34617) QuantErr: 13.34617 batch_time=0.37281 
Train Epoch: 42 [731/1000 23392/32000 (73%)] Loss: 0.32179 (QuantReg: 12.83467) QuantErr: 12.83467 batch_time=0.42183 
Train Epoch: 42 [736/1000 23552/32000 (74%)] Loss: 0.41346 (QuantReg: 12.67727) QuantErr: 12.67727 batch_time=0.46082 
Train Epoch: 42 [741/1000 23712/32000 (74%)] Loss: 0.30116 (QuantReg: 12.95239) QuantErr: 12.95239 batch_time=0.39102 
Train Epoch: 42 [746/1000 23872/32000 (75%)] Loss: 0.33327 (QuantReg: 13.32100) QuantErr: 13.32100 batch_time=0.64119 
Train Epoch: 42 [751/1000 24032/32000 (75%)] Loss: 0.73932 (QuantReg: 12.34890) QuantErr: 12.34890 batch_time=0.44224 
Train Epoch: 42 [756/1000 24192/32000 (76%)] Loss: 0.20624 (QuantReg: 13.27546) QuantErr: 13.27546 batch_time=0.38660 
Train Epoch: 42 [761/1000 24352/32000 (76%)] Loss: 0.33990 (QuantReg: 13.25633) QuantErr: 13.25633 batch_time=0.39628 
Train Epoch: 42 [766/1000 24512/32000 (77%)] Loss: 0.47865 (QuantReg: 13.30369) QuantErr: 13.30369 batch_time=0.34867 
Train Epoch: 42 [771/1000 24672/32000 (77%)] Loss: 0.36390 (QuantReg: 12.68097) QuantErr: 12.68097 batch_time=0.45580 
Train Epoch: 42 [776/1000 24832/32000 (78%)] Loss: 0.38134 (QuantReg: 12.59291) QuantErr: 12.59291 batch_time=0.57799 
Train Epoch: 42 [781/1000 24992/32000 (78%)] Loss: 0.49972 (QuantReg: 11.97123) QuantErr: 11.97123 batch_time=0.35126 
Train Epoch: 42 [786/1000 25152/32000 (79%)] Loss: 0.36011 (QuantReg: 12.84975) QuantErr: 12.84975 batch_time=0.40439 
Train Epoch: 42 [791/1000 25312/32000 (79%)] Loss: 0.12510 (QuantReg: 13.29435) QuantErr: 13.29435 batch_time=0.34568 
Train Epoch: 42 [796/1000 25472/32000 (80%)] Loss: 0.30720 (QuantReg: 13.95822) QuantErr: 13.95822 batch_time=0.58420 
Train Epoch: 42 [801/1000 25632/32000 (80%)] Loss: 0.55463 (QuantReg: 13.07540) QuantErr: 13.07540 batch_time=0.37732 
Train Epoch: 42 [806/1000 25792/32000 (81%)] Loss: 0.41098 (QuantReg: 12.84596) QuantErr: 12.84596 batch_time=0.39498 
Train Epoch: 42 [811/1000 25952/32000 (81%)] Loss: 0.27595 (QuantReg: 13.02964) QuantErr: 13.02964 batch_time=0.38305 
Train Epoch: 42 [816/1000 26112/32000 (82%)] Loss: 0.29290 (QuantReg: 12.94194) QuantErr: 12.94194 batch_time=0.38209 
Train Epoch: 42 [821/1000 26272/32000 (82%)] Loss: 0.16124 (QuantReg: 12.62414) QuantErr: 12.62414 batch_time=0.33797 
Train Epoch: 42 [826/1000 26432/32000 (83%)] Loss: 0.56786 (QuantReg: 13.20430) QuantErr: 13.20430 batch_time=0.41237 
Train Epoch: 42 [831/1000 26592/32000 (83%)] Loss: 0.12784 (QuantReg: 13.79899) QuantErr: 13.79899 batch_time=0.60545 
Train Epoch: 42 [836/1000 26752/32000 (84%)] Loss: 0.29674 (QuantReg: 13.65483) QuantErr: 13.65483 batch_time=0.40057 
Train Epoch: 42 [841/1000 26912/32000 (84%)] Loss: 0.21546 (QuantReg: 13.52635) QuantErr: 13.52635 batch_time=0.43975 
Train Epoch: 42 [846/1000 27072/32000 (85%)] Loss: 0.13932 (QuantReg: 13.35012) QuantErr: 13.35012 batch_time=0.43651 
Train Epoch: 42 [851/1000 27232/32000 (85%)] Loss: 0.18966 (QuantReg: 12.85068) QuantErr: 12.85068 batch_time=0.38379 
Train Epoch: 42 [856/1000 27392/32000 (86%)] Loss: 0.26846 (QuantReg: 13.36511) QuantErr: 13.36511 batch_time=0.46058 
Train Epoch: 42 [861/1000 27552/32000 (86%)] Loss: 0.68942 (QuantReg: 13.23714) QuantErr: 13.23714 batch_time=0.34829 
Train Epoch: 42 [866/1000 27712/32000 (87%)] Loss: 0.27463 (QuantReg: 14.31741) QuantErr: 14.31741 batch_time=0.35589 
Train Epoch: 42 [871/1000 27872/32000 (87%)] Loss: 0.08049 (QuantReg: 12.72491) QuantErr: 12.72491 batch_time=0.40606 
Train Epoch: 42 [876/1000 28032/32000 (88%)] Loss: 0.24074 (QuantReg: 12.98074) QuantErr: 12.98074 batch_time=0.47787 
Train Epoch: 42 [881/1000 28192/32000 (88%)] Loss: 0.19228 (QuantReg: 13.42659) QuantErr: 13.42659 batch_time=0.37132 
Train Epoch: 42 [886/1000 28352/32000 (89%)] Loss: 0.36351 (QuantReg: 12.89089) QuantErr: 12.89089 batch_time=0.36394 
Train Epoch: 42 [891/1000 28512/32000 (89%)] Loss: 0.26324 (QuantReg: 13.28121) QuantErr: 13.28121 batch_time=0.38476 
Train Epoch: 42 [896/1000 28672/32000 (90%)] Loss: 0.24227 (QuantReg: 12.83505) QuantErr: 12.83505 batch_time=0.36450 
Train Epoch: 42 [901/1000 28832/32000 (90%)] Loss: 0.41171 (QuantReg: 13.71341) QuantErr: 13.71341 batch_time=0.36752 
Train Epoch: 42 [906/1000 28992/32000 (91%)] Loss: 0.21083 (QuantReg: 13.51872) QuantErr: 13.51872 batch_time=0.38090 
Train Epoch: 42 [911/1000 29152/32000 (91%)] Loss: 0.34021 (QuantReg: 13.42037) QuantErr: 13.42037 batch_time=0.36329 
Train Epoch: 42 [916/1000 29312/32000 (92%)] Loss: 0.76201 (QuantReg: 13.13020) QuantErr: 13.13020 batch_time=0.37309 
Train Epoch: 42 [921/1000 29472/32000 (92%)] Loss: 0.31948 (QuantReg: 13.04741) QuantErr: 13.04741 batch_time=1.04609 
Train Epoch: 42 [926/1000 29632/32000 (93%)] Loss: 0.09852 (QuantReg: 13.65075) QuantErr: 13.65075 batch_time=0.41980 
Train Epoch: 42 [931/1000 29792/32000 (93%)] Loss: 0.63451 (QuantReg: 13.18863) QuantErr: 13.18863 batch_time=0.39318 
Train Epoch: 42 [936/1000 29952/32000 (94%)] Loss: 0.09949 (QuantReg: 13.23640) QuantErr: 13.23640 batch_time=0.42671 
Train Epoch: 42 [941/1000 30112/32000 (94%)] Loss: 0.25902 (QuantReg: 13.15683) QuantErr: 13.15683 batch_time=0.43252 
Train Epoch: 42 [946/1000 30272/32000 (95%)] Loss: 0.68804 (QuantReg: 13.58913) QuantErr: 13.58913 batch_time=0.39940 
Train Epoch: 42 [951/1000 30432/32000 (95%)] Loss: 0.40070 (QuantReg: 12.68786) QuantErr: 12.68786 batch_time=0.37585 
Train Epoch: 42 [956/1000 30592/32000 (96%)] Loss: 0.27935 (QuantReg: 13.63727) QuantErr: 13.63727 batch_time=0.40004 
Train Epoch: 42 [961/1000 30752/32000 (96%)] Loss: 0.40358 (QuantReg: 13.56239) QuantErr: 13.56239 batch_time=0.42088 
Train Epoch: 42 [966/1000 30912/32000 (97%)] Loss: 0.16181 (QuantReg: 13.25327) QuantErr: 13.25327 batch_time=0.46337 
Train Epoch: 42 [971/1000 31072/32000 (97%)] Loss: 0.29329 (QuantReg: 13.24025) QuantErr: 13.24025 batch_time=0.35445 
Train Epoch: 42 [976/1000 31232/32000 (98%)] Loss: 0.33177 (QuantReg: 13.46354) QuantErr: 13.46354 batch_time=0.42184 
Train Epoch: 42 [981/1000 31392/32000 (98%)] Loss: 0.22723 (QuantReg: 13.43008) QuantErr: 13.43008 batch_time=0.37013 
Train Epoch: 42 [986/1000 31552/32000 (99%)] Loss: 0.34531 (QuantReg: 12.28351) QuantErr: 12.28351 batch_time=0.49289 
Train Epoch: 42 [991/1000 31712/32000 (99%)] Loss: 0.34497 (QuantReg: 13.57508) QuantErr: 13.57508 batch_time=0.59155 
Train Epoch: 42 [996/1000 31872/32000 (100%)] Loss: 0.47776 (QuantReg: 12.81595) QuantErr: 12.81595 batch_time=0.41182 
Train Epoch: 42 codebook_update_time=2.10469
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch42.pth ...
Done in 5.061s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch42.pth ...
Done in 9.836s
removing stale ckpt [epoch 41] [took 0.01s]
 epoch          : 42
 loss           : 0.32194636565074325
 quant_reg      : 13.195561212539673
 quant_err      : 13.195561212539673
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 42000
 MSRVTT_miech_test/t2v_metrics/R1: 21.3
 MSRVTT_miech_test/t2v_metrics/R5: 51.1
 MSRVTT_miech_test/t2v_metrics/R10: 64.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.421
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.31665652816386
 MSRVTT_miech_test/v2t_metrics/R1: 20.1
 MSRVTT_miech_test/v2t_metrics/R5: 51.7
 MSRVTT_miech_test/v2t_metrics/R10: 65.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.1
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.132
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.746395505886056
 mnt_best       : 41.31665652816386
 not_improved_count: 0
Train Epoch: 43 [1/1000 32/32000 (0%)] Loss: 0.09659 (QuantReg: 13.52303) QuantErr: 13.52303 batch_time=30.27956 
Train Epoch: 43 [6/1000 192/32000 (1%)] Loss: 0.70701 (QuantReg: 13.20607) QuantErr: 13.20607 batch_time=0.41634 
Train Epoch: 43 [11/1000 352/32000 (1%)] Loss: 0.24174 (QuantReg: 13.54757) QuantErr: 13.54757 batch_time=1.39707 
Train Epoch: 43 [16/1000 512/32000 (2%)] Loss: 0.21962 (QuantReg: 12.91175) QuantErr: 12.91175 batch_time=0.35957 
Train Epoch: 43 [21/1000 672/32000 (2%)] Loss: 0.56787 (QuantReg: 12.98448) QuantErr: 12.98448 batch_time=0.54339 
Train Epoch: 43 [26/1000 832/32000 (3%)] Loss: 0.31854 (QuantReg: 13.17777) QuantErr: 13.17777 batch_time=0.40780 
Train Epoch: 43 [31/1000 992/32000 (3%)] Loss: 0.33890 (QuantReg: 13.01087) QuantErr: 13.01087 batch_time=0.46513 
Train Epoch: 43 [36/1000 1152/32000 (4%)] Loss: 0.36610 (QuantReg: 13.94859) QuantErr: 13.94859 batch_time=0.46426 
Train Epoch: 43 [41/1000 1312/32000 (4%)] Loss: 0.24097 (QuantReg: 12.97669) QuantErr: 12.97669 batch_time=0.39812 
Train Epoch: 43 [46/1000 1472/32000 (5%)] Loss: 0.31613 (QuantReg: 12.91410) QuantErr: 12.91410 batch_time=0.51599 
Train Epoch: 43 [51/1000 1632/32000 (5%)] Loss: 0.49556 (QuantReg: 13.10278) QuantErr: 13.10278 batch_time=0.36995 
Train Epoch: 43 [56/1000 1792/32000 (6%)] Loss: 0.18176 (QuantReg: 13.50113) QuantErr: 13.50113 batch_time=0.37745 
Train Epoch: 43 [61/1000 1952/32000 (6%)] Loss: 0.30490 (QuantReg: 13.50472) QuantErr: 13.50472 batch_time=0.35661 
Train Epoch: 43 [66/1000 2112/32000 (7%)] Loss: 0.64333 (QuantReg: 12.86204) QuantErr: 12.86204 batch_time=0.47593 
Train Epoch: 43 [71/1000 2272/32000 (7%)] Loss: 0.39095 (QuantReg: 13.12193) QuantErr: 13.12193 batch_time=0.77075 
Train Epoch: 43 [76/1000 2432/32000 (8%)] Loss: 0.30032 (QuantReg: 13.37318) QuantErr: 13.37318 batch_time=0.34391 
Train Epoch: 43 [81/1000 2592/32000 (8%)] Loss: 0.46436 (QuantReg: 13.43563) QuantErr: 13.43563 batch_time=0.35522 
Train Epoch: 43 [86/1000 2752/32000 (9%)] Loss: 0.42836 (QuantReg: 12.41584) QuantErr: 12.41584 batch_time=0.39520 
Train Epoch: 43 [91/1000 2912/32000 (9%)] Loss: 0.38607 (QuantReg: 13.38231) QuantErr: 13.38231 batch_time=0.35714 
Train Epoch: 43 [96/1000 3072/32000 (10%)] Loss: 0.24672 (QuantReg: 13.31608) QuantErr: 13.31608 batch_time=0.81316 
Train Epoch: 43 [101/1000 3232/32000 (10%)] Loss: 0.48495 (QuantReg: 13.26129) QuantErr: 13.26129 batch_time=0.41398 
Train Epoch: 43 [106/1000 3392/32000 (11%)] Loss: 0.14909 (QuantReg: 12.83617) QuantErr: 12.83617 batch_time=0.53429 
Train Epoch: 43 [111/1000 3552/32000 (11%)] Loss: 0.18414 (QuantReg: 13.79479) QuantErr: 13.79479 batch_time=0.40621 
Train Epoch: 43 [116/1000 3712/32000 (12%)] Loss: 0.36642 (QuantReg: 13.23364) QuantErr: 13.23364 batch_time=0.41719 
Train Epoch: 43 [121/1000 3872/32000 (12%)] Loss: 0.36878 (QuantReg: 12.57506) QuantErr: 12.57506 batch_time=0.49579 
Train Epoch: 43 [126/1000 4032/32000 (13%)] Loss: 0.28451 (QuantReg: 13.19405) QuantErr: 13.19405 batch_time=0.37067 
Train Epoch: 43 [131/1000 4192/32000 (13%)] Loss: 0.30242 (QuantReg: 13.64164) QuantErr: 13.64164 batch_time=0.55145 
Train Epoch: 43 [136/1000 4352/32000 (14%)] Loss: 0.20473 (QuantReg: 13.01688) QuantErr: 13.01688 batch_time=0.39674 
Train Epoch: 43 [141/1000 4512/32000 (14%)] Loss: 0.49191 (QuantReg: 13.63508) QuantErr: 13.63508 batch_time=0.34227 
Train Epoch: 43 [146/1000 4672/32000 (15%)] Loss: 0.30235 (QuantReg: 13.24573) QuantErr: 13.24573 batch_time=0.40922 
Train Epoch: 43 [151/1000 4832/32000 (15%)] Loss: 0.29497 (QuantReg: 12.76783) QuantErr: 12.76783 batch_time=0.39929 
Train Epoch: 43 [156/1000 4992/32000 (16%)] Loss: 0.23343 (QuantReg: 12.97130) QuantErr: 12.97130 batch_time=0.42725 
Train Epoch: 43 [161/1000 5152/32000 (16%)] Loss: 0.20523 (QuantReg: 13.40366) QuantErr: 13.40366 batch_time=0.44247 
Train Epoch: 43 [166/1000 5312/32000 (17%)] Loss: 0.24561 (QuantReg: 13.57150) QuantErr: 13.57150 batch_time=0.34462 
Train Epoch: 43 [171/1000 5472/32000 (17%)] Loss: 0.35223 (QuantReg: 13.42547) QuantErr: 13.42547 batch_time=0.36751 
Train Epoch: 43 [176/1000 5632/32000 (18%)] Loss: 0.47224 (QuantReg: 13.38822) QuantErr: 13.38822 batch_time=0.43604 
Train Epoch: 43 [181/1000 5792/32000 (18%)] Loss: 0.24121 (QuantReg: 12.61415) QuantErr: 12.61415 batch_time=0.36408 
Train Epoch: 43 [186/1000 5952/32000 (19%)] Loss: 0.20018 (QuantReg: 13.51933) QuantErr: 13.51933 batch_time=0.35925 
Train Epoch: 43 [191/1000 6112/32000 (19%)] Loss: 0.20055 (QuantReg: 12.69036) QuantErr: 12.69036 batch_time=0.37168 
Train Epoch: 43 [196/1000 6272/32000 (20%)] Loss: 0.37014 (QuantReg: 12.91718) QuantErr: 12.91718 batch_time=0.36651 
Train Epoch: 43 [201/1000 6432/32000 (20%)] Loss: 0.22217 (QuantReg: 13.20334) QuantErr: 13.20334 batch_time=0.46821 
Train Epoch: 43 [206/1000 6592/32000 (21%)] Loss: 0.50762 (QuantReg: 13.29522) QuantErr: 13.29522 batch_time=0.44365 
Train Epoch: 43 [211/1000 6752/32000 (21%)] Loss: 0.28371 (QuantReg: 13.30066) QuantErr: 13.30066 batch_time=0.59696 
Train Epoch: 43 [216/1000 6912/32000 (22%)] Loss: 0.28580 (QuantReg: 13.11785) QuantErr: 13.11785 batch_time=0.65311 
Train Epoch: 43 [221/1000 7072/32000 (22%)] Loss: 0.14169 (QuantReg: 12.78597) QuantErr: 12.78597 batch_time=0.36029 
Train Epoch: 43 [226/1000 7232/32000 (23%)] Loss: 0.28952 (QuantReg: 13.26675) QuantErr: 13.26675 batch_time=0.36831 
Train Epoch: 43 [231/1000 7392/32000 (23%)] Loss: 0.29732 (QuantReg: 13.46454) QuantErr: 13.46454 batch_time=0.42495 
Train Epoch: 43 [236/1000 7552/32000 (24%)] Loss: 0.17434 (QuantReg: 13.55891) QuantErr: 13.55891 batch_time=0.39636 
Train Epoch: 43 [241/1000 7712/32000 (24%)] Loss: 0.07609 (QuantReg: 12.73512) QuantErr: 12.73512 batch_time=0.36996 
Train Epoch: 43 [246/1000 7872/32000 (25%)] Loss: 0.26307 (QuantReg: 13.05087) QuantErr: 13.05087 batch_time=0.40237 
Train Epoch: 43 [251/1000 8032/32000 (25%)] Loss: 0.34934 (QuantReg: 13.79268) QuantErr: 13.79268 batch_time=0.68427 
Train Epoch: 43 [256/1000 8192/32000 (26%)] Loss: 0.33223 (QuantReg: 13.06733) QuantErr: 13.06733 batch_time=0.40577 
Train Epoch: 43 [261/1000 8352/32000 (26%)] Loss: 0.37582 (QuantReg: 13.20063) QuantErr: 13.20063 batch_time=0.39822 
Train Epoch: 43 [266/1000 8512/32000 (27%)] Loss: 0.19226 (QuantReg: 14.02053) QuantErr: 14.02053 batch_time=0.40140 
Train Epoch: 43 [271/1000 8672/32000 (27%)] Loss: 0.26369 (QuantReg: 12.79576) QuantErr: 12.79576 batch_time=0.39123 
Train Epoch: 43 [276/1000 8832/32000 (28%)] Loss: 0.25663 (QuantReg: 12.97256) QuantErr: 12.97256 batch_time=0.46818 
Train Epoch: 43 [281/1000 8992/32000 (28%)] Loss: 0.12409 (QuantReg: 12.79001) QuantErr: 12.79001 batch_time=0.40338 
Train Epoch: 43 [286/1000 9152/32000 (29%)] Loss: 0.39422 (QuantReg: 12.71933) QuantErr: 12.71933 batch_time=0.36183 
Train Epoch: 43 [291/1000 9312/32000 (29%)] Loss: 0.19513 (QuantReg: 13.84532) QuantErr: 13.84532 batch_time=0.53641 
Train Epoch: 43 [296/1000 9472/32000 (30%)] Loss: 0.45538 (QuantReg: 13.03017) QuantErr: 13.03017 batch_time=0.38541 
Train Epoch: 43 [301/1000 9632/32000 (30%)] Loss: 0.46948 (QuantReg: 13.36409) QuantErr: 13.36409 batch_time=0.37981 
Train Epoch: 43 [306/1000 9792/32000 (31%)] Loss: 0.21207 (QuantReg: 13.27620) QuantErr: 13.27620 batch_time=0.39332 
Train Epoch: 43 [311/1000 9952/32000 (31%)] Loss: 0.29888 (QuantReg: 12.66291) QuantErr: 12.66291 batch_time=0.41432 
Train Epoch: 43 [316/1000 10112/32000 (32%)] Loss: 0.31603 (QuantReg: 13.78254) QuantErr: 13.78254 batch_time=0.38940 
Train Epoch: 43 [321/1000 10272/32000 (32%)] Loss: 0.56152 (QuantReg: 12.95587) QuantErr: 12.95587 batch_time=0.37149 
Train Epoch: 43 [326/1000 10432/32000 (33%)] Loss: 0.08065 (QuantReg: 13.14489) QuantErr: 13.14489 batch_time=0.35676 
Train Epoch: 43 [331/1000 10592/32000 (33%)] Loss: 0.21816 (QuantReg: 12.62776) QuantErr: 12.62776 batch_time=0.36160 
Train Epoch: 43 [336/1000 10752/32000 (34%)] Loss: 0.33361 (QuantReg: 12.96185) QuantErr: 12.96185 batch_time=0.43839 
Train Epoch: 43 [341/1000 10912/32000 (34%)] Loss: 0.20045 (QuantReg: 13.23463) QuantErr: 13.23463 batch_time=0.41599 
Train Epoch: 43 [346/1000 11072/32000 (35%)] Loss: 0.20201 (QuantReg: 13.82732) QuantErr: 13.82732 batch_time=0.36124 
Train Epoch: 43 [351/1000 11232/32000 (35%)] Loss: 0.26460 (QuantReg: 13.14223) QuantErr: 13.14223 batch_time=0.36915 
Train Epoch: 43 [356/1000 11392/32000 (36%)] Loss: 0.26227 (QuantReg: 12.27465) QuantErr: 12.27465 batch_time=0.39189 
Train Epoch: 43 [361/1000 11552/32000 (36%)] Loss: 0.33179 (QuantReg: 13.59910) QuantErr: 13.59910 batch_time=0.37773 
Train Epoch: 43 [366/1000 11712/32000 (37%)] Loss: 0.16564 (QuantReg: 13.56426) QuantErr: 13.56426 batch_time=0.44588 
Train Epoch: 43 [371/1000 11872/32000 (37%)] Loss: 0.33803 (QuantReg: 12.93493) QuantErr: 12.93493 batch_time=1.33690 
Train Epoch: 43 [376/1000 12032/32000 (38%)] Loss: 0.19223 (QuantReg: 13.45401) QuantErr: 13.45401 batch_time=0.56791 
Train Epoch: 43 [381/1000 12192/32000 (38%)] Loss: 0.37764 (QuantReg: 13.47767) QuantErr: 13.47767 batch_time=0.35427 
Train Epoch: 43 [386/1000 12352/32000 (39%)] Loss: 0.51254 (QuantReg: 13.93274) QuantErr: 13.93274 batch_time=0.43546 
Train Epoch: 43 [391/1000 12512/32000 (39%)] Loss: 0.14727 (QuantReg: 13.61025) QuantErr: 13.61025 batch_time=0.37612 
Train Epoch: 43 [396/1000 12672/32000 (40%)] Loss: 0.26834 (QuantReg: 13.11108) QuantErr: 13.11108 batch_time=0.37951 
Train Epoch: 43 [401/1000 12832/32000 (40%)] Loss: 0.33667 (QuantReg: 13.36828) QuantErr: 13.36828 batch_time=0.39577 
Train Epoch: 43 [406/1000 12992/32000 (41%)] Loss: 0.43032 (QuantReg: 12.91668) QuantErr: 12.91668 batch_time=0.45300 
Train Epoch: 43 [411/1000 13152/32000 (41%)] Loss: 0.26443 (QuantReg: 13.53342) QuantErr: 13.53342 batch_time=0.34559 
Train Epoch: 43 [416/1000 13312/32000 (42%)] Loss: 0.14955 (QuantReg: 13.83657) QuantErr: 13.83657 batch_time=0.36543 
Train Epoch: 43 [421/1000 13472/32000 (42%)] Loss: 0.32693 (QuantReg: 13.60119) QuantErr: 13.60119 batch_time=0.35639 
Train Epoch: 43 [426/1000 13632/32000 (43%)] Loss: 0.24489 (QuantReg: 13.89790) QuantErr: 13.89790 batch_time=0.35345 
Train Epoch: 43 [431/1000 13792/32000 (43%)] Loss: 0.22520 (QuantReg: 13.64010) QuantErr: 13.64010 batch_time=0.34471 
Train Epoch: 43 [436/1000 13952/32000 (44%)] Loss: 0.63179 (QuantReg: 13.54663) QuantErr: 13.54663 batch_time=0.35134 
Train Epoch: 43 [441/1000 14112/32000 (44%)] Loss: 0.13281 (QuantReg: 13.24306) QuantErr: 13.24306 batch_time=0.43565 
Train Epoch: 43 [446/1000 14272/32000 (45%)] Loss: 0.12308 (QuantReg: 13.26293) QuantErr: 13.26293 batch_time=0.36304 
Train Epoch: 43 [451/1000 14432/32000 (45%)] Loss: 0.17573 (QuantReg: 13.70200) QuantErr: 13.70200 batch_time=0.51708 
Train Epoch: 43 [456/1000 14592/32000 (46%)] Loss: 0.23037 (QuantReg: 13.23979) QuantErr: 13.23979 batch_time=0.36672 
Train Epoch: 43 [461/1000 14752/32000 (46%)] Loss: 0.27396 (QuantReg: 13.62796) QuantErr: 13.62796 batch_time=0.43039 
Train Epoch: 43 [466/1000 14912/32000 (47%)] Loss: 0.31584 (QuantReg: 12.89704) QuantErr: 12.89704 batch_time=0.35253 
Train Epoch: 43 [471/1000 15072/32000 (47%)] Loss: 0.35934 (QuantReg: 13.06526) QuantErr: 13.06526 batch_time=0.65262 
Train Epoch: 43 [476/1000 15232/32000 (48%)] Loss: 0.52669 (QuantReg: 13.19526) QuantErr: 13.19526 batch_time=1.52989 
Train Epoch: 43 [481/1000 15392/32000 (48%)] Loss: 0.10416 (QuantReg: 13.33215) QuantErr: 13.33215 batch_time=0.37800 
Train Epoch: 43 [486/1000 15552/32000 (49%)] Loss: 0.38309 (QuantReg: 12.72535) QuantErr: 12.72535 batch_time=0.39051 
Train Epoch: 43 [491/1000 15712/32000 (49%)] Loss: 0.45438 (QuantReg: 13.31252) QuantErr: 13.31252 batch_time=0.35316 
Train Epoch: 43 [496/1000 15872/32000 (50%)] Loss: 0.32725 (QuantReg: 13.03913) QuantErr: 13.03913 batch_time=0.38806 
Train Epoch: 43 [501/1000 16032/32000 (50%)] Loss: 0.46174 (QuantReg: 13.54945) QuantErr: 13.54945 batch_time=0.40732 
Train Epoch: 43 [506/1000 16192/32000 (51%)] Loss: 0.32290 (QuantReg: 12.93317) QuantErr: 12.93317 batch_time=0.41008 
Train Epoch: 43 [511/1000 16352/32000 (51%)] Loss: 0.51949 (QuantReg: 13.69711) QuantErr: 13.69711 batch_time=0.46562 
Train Epoch: 43 [516/1000 16512/32000 (52%)] Loss: 0.63637 (QuantReg: 12.91320) QuantErr: 12.91320 batch_time=0.37271 
Train Epoch: 43 [521/1000 16672/32000 (52%)] Loss: 0.24176 (QuantReg: 13.18446) QuantErr: 13.18446 batch_time=0.37825 
Train Epoch: 43 [526/1000 16832/32000 (53%)] Loss: 0.10419 (QuantReg: 13.36162) QuantErr: 13.36162 batch_time=0.36705 
Train Epoch: 43 [531/1000 16992/32000 (53%)] Loss: 0.30113 (QuantReg: 13.03490) QuantErr: 13.03490 batch_time=0.49784 
Train Epoch: 43 [536/1000 17152/32000 (54%)] Loss: 0.21235 (QuantReg: 13.72025) QuantErr: 13.72025 batch_time=0.37728 
Train Epoch: 43 [541/1000 17312/32000 (54%)] Loss: 0.39906 (QuantReg: 13.14270) QuantErr: 13.14270 batch_time=0.39935 
Train Epoch: 43 [546/1000 17472/32000 (55%)] Loss: 0.12050 (QuantReg: 13.14515) QuantErr: 13.14515 batch_time=0.38113 
Train Epoch: 43 [551/1000 17632/32000 (55%)] Loss: 0.52135 (QuantReg: 13.26520) QuantErr: 13.26520 batch_time=0.35193 
Train Epoch: 43 [556/1000 17792/32000 (56%)] Loss: 0.32336 (QuantReg: 13.25075) QuantErr: 13.25075 batch_time=0.35698 
Train Epoch: 43 [561/1000 17952/32000 (56%)] Loss: 0.21905 (QuantReg: 13.19790) QuantErr: 13.19790 batch_time=0.38020 
Train Epoch: 43 [566/1000 18112/32000 (57%)] Loss: 0.24416 (QuantReg: 12.83384) QuantErr: 12.83384 batch_time=0.34168 
Train Epoch: 43 [571/1000 18272/32000 (57%)] Loss: 0.35346 (QuantReg: 12.74792) QuantErr: 12.74792 batch_time=0.38040 
Train Epoch: 43 [576/1000 18432/32000 (58%)] Loss: 0.28833 (QuantReg: 13.00917) QuantErr: 13.00917 batch_time=0.43963 
Train Epoch: 43 [581/1000 18592/32000 (58%)] Loss: 0.21438 (QuantReg: 13.39129) QuantErr: 13.39129 batch_time=0.49230 
Train Epoch: 43 [586/1000 18752/32000 (59%)] Loss: 0.22049 (QuantReg: 13.47309) QuantErr: 13.47309 batch_time=0.41413 
Train Epoch: 43 [591/1000 18912/32000 (59%)] Loss: 0.24991 (QuantReg: 13.99170) QuantErr: 13.99170 batch_time=0.57756 
Train Epoch: 43 [596/1000 19072/32000 (60%)] Loss: 0.12145 (QuantReg: 13.52702) QuantErr: 13.52702 batch_time=0.36089 
Train Epoch: 43 [601/1000 19232/32000 (60%)] Loss: 0.13919 (QuantReg: 13.36007) QuantErr: 13.36007 batch_time=0.41136 
Train Epoch: 43 [606/1000 19392/32000 (61%)] Loss: 0.13826 (QuantReg: 13.27736) QuantErr: 13.27736 batch_time=0.40656 
Train Epoch: 43 [611/1000 19552/32000 (61%)] Loss: 0.21463 (QuantReg: 13.79199) QuantErr: 13.79199 batch_time=0.43969 
Train Epoch: 43 [616/1000 19712/32000 (62%)] Loss: 0.16169 (QuantReg: 13.23110) QuantErr: 13.23110 batch_time=0.39001 
Train Epoch: 43 [621/1000 19872/32000 (62%)] Loss: 0.24401 (QuantReg: 12.89042) QuantErr: 12.89042 batch_time=0.47219 
Train Epoch: 43 [626/1000 20032/32000 (63%)] Loss: 0.34142 (QuantReg: 12.52988) QuantErr: 12.52988 batch_time=0.40915 
Train Epoch: 43 [631/1000 20192/32000 (63%)] Loss: 0.46001 (QuantReg: 14.03095) QuantErr: 14.03095 batch_time=0.37263 
Train Epoch: 43 [636/1000 20352/32000 (64%)] Loss: 0.28621 (QuantReg: 12.92858) QuantErr: 12.92858 batch_time=0.37629 
Train Epoch: 43 [641/1000 20512/32000 (64%)] Loss: 0.41568 (QuantReg: 13.02112) QuantErr: 13.02112 batch_time=0.37093 
Train Epoch: 43 [646/1000 20672/32000 (65%)] Loss: 0.17228 (QuantReg: 13.47296) QuantErr: 13.47296 batch_time=0.34405 
Train Epoch: 43 [651/1000 20832/32000 (65%)] Loss: 0.36407 (QuantReg: 13.59875) QuantErr: 13.59875 batch_time=0.34278 
Train Epoch: 43 [656/1000 20992/32000 (66%)] Loss: 0.17985 (QuantReg: 13.45968) QuantErr: 13.45968 batch_time=0.35232 
Train Epoch: 43 [661/1000 21152/32000 (66%)] Loss: 0.66137 (QuantReg: 13.39245) QuantErr: 13.39245 batch_time=0.36275 
Train Epoch: 43 [666/1000 21312/32000 (67%)] Loss: 0.39960 (QuantReg: 13.55621) QuantErr: 13.55621 batch_time=0.37587 
Train Epoch: 43 [671/1000 21472/32000 (67%)] Loss: 0.12245 (QuantReg: 12.92124) QuantErr: 12.92124 batch_time=0.44177 
Train Epoch: 43 [676/1000 21632/32000 (68%)] Loss: 0.62763 (QuantReg: 12.99106) QuantErr: 12.99106 batch_time=0.36134 
Train Epoch: 43 [681/1000 21792/32000 (68%)] Loss: 0.12651 (QuantReg: 13.06170) QuantErr: 13.06170 batch_time=0.34726 
Train Epoch: 43 [686/1000 21952/32000 (69%)] Loss: 0.11464 (QuantReg: 13.04036) QuantErr: 13.04036 batch_time=0.43791 
Train Epoch: 43 [691/1000 22112/32000 (69%)] Loss: 0.25865 (QuantReg: 13.24662) QuantErr: 13.24662 batch_time=1.25749 
Train Epoch: 43 [696/1000 22272/32000 (70%)] Loss: 0.38179 (QuantReg: 13.25196) QuantErr: 13.25196 batch_time=0.35628 
Train Epoch: 43 [701/1000 22432/32000 (70%)] Loss: 0.17005 (QuantReg: 13.35973) QuantErr: 13.35973 batch_time=0.34704 
Train Epoch: 43 [706/1000 22592/32000 (71%)] Loss: 0.30783 (QuantReg: 13.32856) QuantErr: 13.32856 batch_time=0.42218 
Train Epoch: 43 [711/1000 22752/32000 (71%)] Loss: 0.29321 (QuantReg: 13.61830) QuantErr: 13.61830 batch_time=0.49671 
Train Epoch: 43 [716/1000 22912/32000 (72%)] Loss: 0.49233 (QuantReg: 12.86915) QuantErr: 12.86915 batch_time=0.38085 
Train Epoch: 43 [721/1000 23072/32000 (72%)] Loss: 0.40281 (QuantReg: 13.07456) QuantErr: 13.07456 batch_time=0.50041 
Train Epoch: 43 [726/1000 23232/32000 (73%)] Loss: 0.12506 (QuantReg: 13.60346) QuantErr: 13.60346 batch_time=0.40000 
Train Epoch: 43 [731/1000 23392/32000 (73%)] Loss: 0.41975 (QuantReg: 13.55802) QuantErr: 13.55802 batch_time=0.59527 
Train Epoch: 43 [736/1000 23552/32000 (74%)] Loss: 0.48278 (QuantReg: 13.56374) QuantErr: 13.56374 batch_time=0.41645 
Train Epoch: 43 [741/1000 23712/32000 (74%)] Loss: 0.63039 (QuantReg: 13.77714) QuantErr: 13.77714 batch_time=0.41516 
Train Epoch: 43 [746/1000 23872/32000 (75%)] Loss: 0.27883 (QuantReg: 13.16671) QuantErr: 13.16671 batch_time=0.48893 
Train Epoch: 43 [751/1000 24032/32000 (75%)] Loss: 0.16426 (QuantReg: 12.96813) QuantErr: 12.96813 batch_time=0.44041 
Train Epoch: 43 [756/1000 24192/32000 (76%)] Loss: 0.28370 (QuantReg: 13.54807) QuantErr: 13.54807 batch_time=0.38283 
Train Epoch: 43 [761/1000 24352/32000 (76%)] Loss: 0.20293 (QuantReg: 13.82719) QuantErr: 13.82719 batch_time=0.36720 
Train Epoch: 43 [766/1000 24512/32000 (77%)] Loss: 0.50738 (QuantReg: 12.88210) QuantErr: 12.88210 batch_time=0.35087 
Train Epoch: 43 [771/1000 24672/32000 (77%)] Loss: 0.44764 (QuantReg: 12.77362) QuantErr: 12.77362 batch_time=0.35539 
Train Epoch: 43 [776/1000 24832/32000 (78%)] Loss: 0.09908 (QuantReg: 12.86852) QuantErr: 12.86852 batch_time=0.34492 
Train Epoch: 43 [781/1000 24992/32000 (78%)] Loss: 0.05463 (QuantReg: 13.36592) QuantErr: 13.36592 batch_time=0.37840 
Train Epoch: 43 [786/1000 25152/32000 (79%)] Loss: 0.24165 (QuantReg: 13.37182) QuantErr: 13.37182 batch_time=0.35268 
Train Epoch: 43 [791/1000 25312/32000 (79%)] Loss: 0.33726 (QuantReg: 13.24172) QuantErr: 13.24172 batch_time=0.37383 
Train Epoch: 43 [796/1000 25472/32000 (80%)] Loss: 0.36169 (QuantReg: 12.93281) QuantErr: 12.93281 batch_time=0.81800 
Train Epoch: 43 [801/1000 25632/32000 (80%)] Loss: 0.22771 (QuantReg: 13.39531) QuantErr: 13.39531 batch_time=0.40855 
Train Epoch: 43 [806/1000 25792/32000 (81%)] Loss: 0.16531 (QuantReg: 12.46240) QuantErr: 12.46240 batch_time=0.36200 
Train Epoch: 43 [811/1000 25952/32000 (81%)] Loss: 0.14071 (QuantReg: 13.74955) QuantErr: 13.74955 batch_time=0.50873 
Train Epoch: 43 [816/1000 26112/32000 (82%)] Loss: 0.26546 (QuantReg: 13.65670) QuantErr: 13.65670 batch_time=0.38625 
Train Epoch: 43 [821/1000 26272/32000 (82%)] Loss: 0.33544 (QuantReg: 13.35820) QuantErr: 13.35820 batch_time=0.41307 
Train Epoch: 43 [826/1000 26432/32000 (83%)] Loss: 0.22555 (QuantReg: 13.20866) QuantErr: 13.20866 batch_time=0.41710 
Train Epoch: 43 [831/1000 26592/32000 (83%)] Loss: 0.41461 (QuantReg: 13.28660) QuantErr: 13.28660 batch_time=0.41003 
Train Epoch: 43 [836/1000 26752/32000 (84%)] Loss: 0.16992 (QuantReg: 13.54206) QuantErr: 13.54206 batch_time=0.90786 
Train Epoch: 43 [841/1000 26912/32000 (84%)] Loss: 0.82093 (QuantReg: 13.07297) QuantErr: 13.07297 batch_time=0.38650 
Train Epoch: 43 [846/1000 27072/32000 (85%)] Loss: 1.07449 (QuantReg: 12.64205) QuantErr: 12.64205 batch_time=0.34585 
Train Epoch: 43 [851/1000 27232/32000 (85%)] Loss: 0.51944 (QuantReg: 13.62953) QuantErr: 13.62953 batch_time=0.40931 
Train Epoch: 43 [856/1000 27392/32000 (86%)] Loss: 0.27691 (QuantReg: 13.20442) QuantErr: 13.20442 batch_time=0.38916 
Train Epoch: 43 [861/1000 27552/32000 (86%)] Loss: 0.25255 (QuantReg: 13.63176) QuantErr: 13.63176 batch_time=0.37022 
Train Epoch: 43 [866/1000 27712/32000 (87%)] Loss: 0.31677 (QuantReg: 13.38899) QuantErr: 13.38899 batch_time=0.61225 
Train Epoch: 43 [871/1000 27872/32000 (87%)] Loss: 0.41816 (QuantReg: 13.43824) QuantErr: 13.43824 batch_time=0.45425 
Train Epoch: 43 [876/1000 28032/32000 (88%)] Loss: 0.32268 (QuantReg: 13.19714) QuantErr: 13.19714 batch_time=0.45052 
Train Epoch: 43 [881/1000 28192/32000 (88%)] Loss: 0.23176 (QuantReg: 12.76904) QuantErr: 12.76904 batch_time=0.52015 
Train Epoch: 43 [886/1000 28352/32000 (89%)] Loss: 0.28298 (QuantReg: 13.05585) QuantErr: 13.05585 batch_time=0.40943 
Train Epoch: 43 [891/1000 28512/32000 (89%)] Loss: 0.46938 (QuantReg: 12.79188) QuantErr: 12.79188 batch_time=0.41146 
Train Epoch: 43 [896/1000 28672/32000 (90%)] Loss: 0.46501 (QuantReg: 13.27646) QuantErr: 13.27646 batch_time=0.34930 
Train Epoch: 43 [901/1000 28832/32000 (90%)] Loss: 0.41300 (QuantReg: 13.11321) QuantErr: 13.11321 batch_time=0.36346 
Train Epoch: 43 [906/1000 28992/32000 (91%)] Loss: 0.23451 (QuantReg: 13.15873) QuantErr: 13.15873 batch_time=0.48801 
Train Epoch: 43 [911/1000 29152/32000 (91%)] Loss: 0.41577 (QuantReg: 12.97492) QuantErr: 12.97492 batch_time=0.35754 
Train Epoch: 43 [916/1000 29312/32000 (92%)] Loss: 0.47248 (QuantReg: 13.11593) QuantErr: 13.11593 batch_time=0.35984 
Train Epoch: 43 [921/1000 29472/32000 (92%)] Loss: 0.40371 (QuantReg: 13.17554) QuantErr: 13.17554 batch_time=0.58888 
Train Epoch: 43 [926/1000 29632/32000 (93%)] Loss: 0.56232 (QuantReg: 12.58355) QuantErr: 12.58355 batch_time=0.35292 
Train Epoch: 43 [931/1000 29792/32000 (93%)] Loss: 0.29685 (QuantReg: 12.99789) QuantErr: 12.99789 batch_time=0.55853 
Train Epoch: 43 [936/1000 29952/32000 (94%)] Loss: 0.55072 (QuantReg: 13.34743) QuantErr: 13.34743 batch_time=0.38881 
Train Epoch: 43 [941/1000 30112/32000 (94%)] Loss: 0.22632 (QuantReg: 13.39901) QuantErr: 13.39901 batch_time=0.49903 
Train Epoch: 43 [946/1000 30272/32000 (95%)] Loss: 0.18056 (QuantReg: 13.54111) QuantErr: 13.54111 batch_time=0.45950 
Train Epoch: 43 [951/1000 30432/32000 (95%)] Loss: 0.31073 (QuantReg: 12.53349) QuantErr: 12.53349 batch_time=0.45259 
Train Epoch: 43 [956/1000 30592/32000 (96%)] Loss: 0.42501 (QuantReg: 13.82879) QuantErr: 13.82879 batch_time=0.40981 
Train Epoch: 43 [961/1000 30752/32000 (96%)] Loss: 0.25336 (QuantReg: 13.31987) QuantErr: 13.31987 batch_time=0.35625 
Train Epoch: 43 [966/1000 30912/32000 (97%)] Loss: 0.38659 (QuantReg: 13.10874) QuantErr: 13.10874 batch_time=0.38778 
Train Epoch: 43 [971/1000 31072/32000 (97%)] Loss: 0.27232 (QuantReg: 12.90441) QuantErr: 12.90441 batch_time=0.35530 
Train Epoch: 43 [976/1000 31232/32000 (98%)] Loss: 0.29992 (QuantReg: 13.50587) QuantErr: 13.50587 batch_time=0.37316 
Train Epoch: 43 [981/1000 31392/32000 (98%)] Loss: 0.40345 (QuantReg: 14.02320) QuantErr: 14.02320 batch_time=0.39101 
Train Epoch: 43 [986/1000 31552/32000 (99%)] Loss: 0.42207 (QuantReg: 13.46445) QuantErr: 13.46445 batch_time=0.54160 
Train Epoch: 43 [991/1000 31712/32000 (99%)] Loss: 0.08812 (QuantReg: 12.94128) QuantErr: 12.94128 batch_time=0.44744 
Train Epoch: 43 [996/1000 31872/32000 (100%)] Loss: 0.21585 (QuantReg: 13.19708) QuantErr: 13.19708 batch_time=0.39128 
Train Epoch: 43 codebook_update_time=2.16534
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch43.pth ...
Done in 15.261s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 0.316227797459811
 quant_reg      : 13.239803122520447
 quant_err      : 13.239803122520447
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 43000
 MSRVTT_miech_test/t2v_metrics/R1: 21.1
 MSRVTT_miech_test/t2v_metrics/R5: 50.0
 MSRVTT_miech_test/t2v_metrics/R10: 64.6
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.5
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.877
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.84714050178408
 MSRVTT_miech_test/v2t_metrics/R1: 22.7
 MSRVTT_miech_test/v2t_metrics/R5: 52.8
 MSRVTT_miech_test/v2t_metrics/R10: 65.4
 MSRVTT_miech_test/v2t_metrics/R50: 88.0
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.538
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.79691945103308
 mnt_best       : 41.31665652816386
 not_improved_count: 1
Train Epoch: 44 [1/1000 32/32000 (0%)] Loss: 0.41493 (QuantReg: 13.53033) QuantErr: 13.53033 batch_time=28.10959 
Train Epoch: 44 [6/1000 192/32000 (1%)] Loss: 0.44743 (QuantReg: 13.74573) QuantErr: 13.74573 batch_time=0.45662 
Train Epoch: 44 [11/1000 352/32000 (1%)] Loss: 0.20552 (QuantReg: 13.04229) QuantErr: 13.04229 batch_time=0.38871 
Train Epoch: 44 [16/1000 512/32000 (2%)] Loss: 0.19793 (QuantReg: 13.40056) QuantErr: 13.40056 batch_time=1.00304 
Train Epoch: 44 [21/1000 672/32000 (2%)] Loss: 0.10933 (QuantReg: 12.48723) QuantErr: 12.48723 batch_time=0.41537 
Train Epoch: 44 [26/1000 832/32000 (3%)] Loss: 0.16855 (QuantReg: 13.65852) QuantErr: 13.65852 batch_time=0.36324 
Train Epoch: 44 [31/1000 992/32000 (3%)] Loss: 0.31572 (QuantReg: 13.15346) QuantErr: 13.15346 batch_time=0.35600 
Train Epoch: 44 [36/1000 1152/32000 (4%)] Loss: 0.12406 (QuantReg: 13.47801) QuantErr: 13.47801 batch_time=0.36964 
Train Epoch: 44 [41/1000 1312/32000 (4%)] Loss: 0.09812 (QuantReg: 13.06261) QuantErr: 13.06261 batch_time=0.36917 
Train Epoch: 44 [46/1000 1472/32000 (5%)] Loss: 0.18614 (QuantReg: 13.53798) QuantErr: 13.53798 batch_time=0.38177 
Train Epoch: 44 [51/1000 1632/32000 (5%)] Loss: 0.16804 (QuantReg: 13.01776) QuantErr: 13.01776 batch_time=0.38937 
Train Epoch: 44 [56/1000 1792/32000 (6%)] Loss: 0.13626 (QuantReg: 13.34044) QuantErr: 13.34044 batch_time=0.45259 
Train Epoch: 44 [61/1000 1952/32000 (6%)] Loss: 0.37702 (QuantReg: 13.23559) QuantErr: 13.23559 batch_time=0.39927 
Train Epoch: 44 [66/1000 2112/32000 (7%)] Loss: 0.21494 (QuantReg: 13.86781) QuantErr: 13.86781 batch_time=0.63024 
Train Epoch: 44 [71/1000 2272/32000 (7%)] Loss: 0.49666 (QuantReg: 12.73898) QuantErr: 12.73898 batch_time=0.38854 
Train Epoch: 44 [76/1000 2432/32000 (8%)] Loss: 0.24320 (QuantReg: 13.32938) QuantErr: 13.32938 batch_time=0.39327 
Train Epoch: 44 [81/1000 2592/32000 (8%)] Loss: 0.24341 (QuantReg: 13.29245) QuantErr: 13.29245 batch_time=0.50283 
Train Epoch: 44 [86/1000 2752/32000 (9%)] Loss: 0.30061 (QuantReg: 13.28663) QuantErr: 13.28663 batch_time=0.34970 
Train Epoch: 44 [91/1000 2912/32000 (9%)] Loss: 0.30687 (QuantReg: 13.71207) QuantErr: 13.71207 batch_time=0.64616 
Train Epoch: 44 [96/1000 3072/32000 (10%)] Loss: 0.15950 (QuantReg: 13.62352) QuantErr: 13.62352 batch_time=0.41658 
Train Epoch: 44 [101/1000 3232/32000 (10%)] Loss: 0.55186 (QuantReg: 12.97703) QuantErr: 12.97703 batch_time=0.50897 
Train Epoch: 44 [106/1000 3392/32000 (11%)] Loss: 0.56608 (QuantReg: 13.28313) QuantErr: 13.28313 batch_time=0.47888 
Train Epoch: 44 [111/1000 3552/32000 (11%)] Loss: 0.39556 (QuantReg: 13.36856) QuantErr: 13.36856 batch_time=0.47702 
Train Epoch: 44 [116/1000 3712/32000 (12%)] Loss: 0.25323 (QuantReg: 13.35989) QuantErr: 13.35989 batch_time=0.43644 
Train Epoch: 44 [121/1000 3872/32000 (12%)] Loss: 0.30842 (QuantReg: 13.20784) QuantErr: 13.20784 batch_time=0.36446 
Train Epoch: 44 [126/1000 4032/32000 (13%)] Loss: 0.24637 (QuantReg: 13.14097) QuantErr: 13.14097 batch_time=0.42274 
Train Epoch: 44 [131/1000 4192/32000 (13%)] Loss: 0.43288 (QuantReg: 13.14259) QuantErr: 13.14259 batch_time=0.42838 
Train Epoch: 44 [136/1000 4352/32000 (14%)] Loss: 0.17120 (QuantReg: 13.00465) QuantErr: 13.00465 batch_time=0.37756 
Train Epoch: 44 [141/1000 4512/32000 (14%)] Loss: 0.26803 (QuantReg: 13.02884) QuantErr: 13.02884 batch_time=0.35597 
Train Epoch: 44 [146/1000 4672/32000 (15%)] Loss: 0.47089 (QuantReg: 12.71035) QuantErr: 12.71035 batch_time=0.99001 
Train Epoch: 44 [151/1000 4832/32000 (15%)] Loss: 0.12940 (QuantReg: 13.80951) QuantErr: 13.80951 batch_time=0.34927 
Train Epoch: 44 [156/1000 4992/32000 (16%)] Loss: 0.29187 (QuantReg: 13.29805) QuantErr: 13.29805 batch_time=0.38865 
Train Epoch: 44 [161/1000 5152/32000 (16%)] Loss: 0.22505 (QuantReg: 12.95040) QuantErr: 12.95040 batch_time=0.35578 
Train Epoch: 44 [166/1000 5312/32000 (17%)] Loss: 0.06989 (QuantReg: 13.95240) QuantErr: 13.95240 batch_time=0.37485 
Train Epoch: 44 [171/1000 5472/32000 (17%)] Loss: 0.09447 (QuantReg: 13.53605) QuantErr: 13.53605 batch_time=0.36058 
Train Epoch: 44 [176/1000 5632/32000 (18%)] Loss: 0.19538 (QuantReg: 12.85194) QuantErr: 12.85194 batch_time=0.36683 
Train Epoch: 44 [181/1000 5792/32000 (18%)] Loss: 0.29335 (QuantReg: 13.13396) QuantErr: 13.13396 batch_time=0.34835 
Train Epoch: 44 [186/1000 5952/32000 (19%)] Loss: 0.20859 (QuantReg: 13.10556) QuantErr: 13.10556 batch_time=0.34930 
Train Epoch: 44 [191/1000 6112/32000 (19%)] Loss: 0.32812 (QuantReg: 12.91949) QuantErr: 12.91949 batch_time=0.36158 
Train Epoch: 44 [196/1000 6272/32000 (20%)] Loss: 0.30959 (QuantReg: 13.30573) QuantErr: 13.30573 batch_time=0.61322 
Train Epoch: 44 [201/1000 6432/32000 (20%)] Loss: 0.47429 (QuantReg: 12.66315) QuantErr: 12.66315 batch_time=0.90950 
Train Epoch: 44 [206/1000 6592/32000 (21%)] Loss: 0.39462 (QuantReg: 12.88028) QuantErr: 12.88028 batch_time=0.40347 
Train Epoch: 44 [211/1000 6752/32000 (21%)] Loss: 0.12932 (QuantReg: 13.44638) QuantErr: 13.44638 batch_time=0.58759 
Train Epoch: 44 [216/1000 6912/32000 (22%)] Loss: 0.15628 (QuantReg: 13.57831) QuantErr: 13.57831 batch_time=0.54986 
Train Epoch: 44 [221/1000 7072/32000 (22%)] Loss: 0.17279 (QuantReg: 13.08344) QuantErr: 13.08344 batch_time=0.40016 
Train Epoch: 44 [226/1000 7232/32000 (23%)] Loss: 0.42659 (QuantReg: 13.60378) QuantErr: 13.60378 batch_time=0.37764 
Train Epoch: 44 [231/1000 7392/32000 (23%)] Loss: 0.13741 (QuantReg: 13.96890) QuantErr: 13.96890 batch_time=0.38594 
Train Epoch: 44 [236/1000 7552/32000 (24%)] Loss: 0.38017 (QuantReg: 13.09643) QuantErr: 13.09643 batch_time=0.51883 
Train Epoch: 44 [241/1000 7712/32000 (24%)] Loss: 0.13723 (QuantReg: 13.32036) QuantErr: 13.32036 batch_time=0.47541 
Train Epoch: 44 [246/1000 7872/32000 (25%)] Loss: 0.21614 (QuantReg: 13.08487) QuantErr: 13.08487 batch_time=0.58604 
Train Epoch: 44 [251/1000 8032/32000 (25%)] Loss: 0.21983 (QuantReg: 13.87912) QuantErr: 13.87912 batch_time=0.36291 
Train Epoch: 44 [256/1000 8192/32000 (26%)] Loss: 0.34938 (QuantReg: 13.05255) QuantErr: 13.05255 batch_time=0.38480 
Train Epoch: 44 [261/1000 8352/32000 (26%)] Loss: 0.46124 (QuantReg: 13.21790) QuantErr: 13.21790 batch_time=0.49480 
Train Epoch: 44 [266/1000 8512/32000 (27%)] Loss: 0.43296 (QuantReg: 13.29772) QuantErr: 13.29772 batch_time=0.38799 
Train Epoch: 44 [271/1000 8672/32000 (27%)] Loss: 0.36438 (QuantReg: 13.09122) QuantErr: 13.09122 batch_time=0.38949 
Train Epoch: 44 [276/1000 8832/32000 (28%)] Loss: 0.22530 (QuantReg: 13.37513) QuantErr: 13.37513 batch_time=0.49715 
Train Epoch: 44 [281/1000 8992/32000 (28%)] Loss: 0.09897 (QuantReg: 13.16345) QuantErr: 13.16345 batch_time=0.38707 
Train Epoch: 44 [286/1000 9152/32000 (29%)] Loss: 0.56816 (QuantReg: 13.61247) QuantErr: 13.61247 batch_time=0.39968 
Train Epoch: 44 [291/1000 9312/32000 (29%)] Loss: 0.26214 (QuantReg: 13.60045) QuantErr: 13.60045 batch_time=0.40424 
Train Epoch: 44 [296/1000 9472/32000 (30%)] Loss: 0.10164 (QuantReg: 13.34383) QuantErr: 13.34383 batch_time=0.39193 
Train Epoch: 44 [301/1000 9632/32000 (30%)] Loss: 0.10983 (QuantReg: 13.26333) QuantErr: 13.26333 batch_time=0.36067 
Train Epoch: 44 [306/1000 9792/32000 (31%)] Loss: 0.35135 (QuantReg: 13.44830) QuantErr: 13.44830 batch_time=0.36886 
Train Epoch: 44 [311/1000 9952/32000 (31%)] Loss: 0.11388 (QuantReg: 13.56877) QuantErr: 13.56877 batch_time=0.40083 
Train Epoch: 44 [316/1000 10112/32000 (32%)] Loss: 0.38591 (QuantReg: 13.21439) QuantErr: 13.21439 batch_time=0.43733 
Train Epoch: 44 [321/1000 10272/32000 (32%)] Loss: 0.23228 (QuantReg: 13.75657) QuantErr: 13.75657 batch_time=0.36233 
Train Epoch: 44 [326/1000 10432/32000 (33%)] Loss: 0.28200 (QuantReg: 13.61881) QuantErr: 13.61881 batch_time=0.39094 
Train Epoch: 44 [331/1000 10592/32000 (33%)] Loss: 0.41062 (QuantReg: 13.15863) QuantErr: 13.15863 batch_time=0.48176 
Train Epoch: 44 [336/1000 10752/32000 (34%)] Loss: 0.35073 (QuantReg: 13.40348) QuantErr: 13.40348 batch_time=0.96553 
Train Epoch: 44 [341/1000 10912/32000 (34%)] Loss: 0.40533 (QuantReg: 12.92535) QuantErr: 12.92535 batch_time=2.27485 
Train Epoch: 44 [346/1000 11072/32000 (35%)] Loss: 0.31845 (QuantReg: 13.31995) QuantErr: 13.31995 batch_time=0.41054 
Train Epoch: 44 [351/1000 11232/32000 (35%)] Loss: 0.18691 (QuantReg: 13.43311) QuantErr: 13.43311 batch_time=0.38975 
Train Epoch: 44 [356/1000 11392/32000 (36%)] Loss: 0.54562 (QuantReg: 13.51752) QuantErr: 13.51752 batch_time=0.39640 
Train Epoch: 44 [361/1000 11552/32000 (36%)] Loss: 0.29565 (QuantReg: 13.42343) QuantErr: 13.42343 batch_time=0.39466 
Train Epoch: 44 [366/1000 11712/32000 (37%)] Loss: 0.44841 (QuantReg: 13.29766) QuantErr: 13.29766 batch_time=0.38311 
Train Epoch: 44 [371/1000 11872/32000 (37%)] Loss: 0.59439 (QuantReg: 13.16385) QuantErr: 13.16385 batch_time=0.39820 
Train Epoch: 44 [376/1000 12032/32000 (38%)] Loss: 0.14442 (QuantReg: 12.74457) QuantErr: 12.74457 batch_time=0.79098 
Train Epoch: 44 [381/1000 12192/32000 (38%)] Loss: 0.20869 (QuantReg: 12.98336) QuantErr: 12.98336 batch_time=0.35772 
Train Epoch: 44 [386/1000 12352/32000 (39%)] Loss: 0.31947 (QuantReg: 13.07310) QuantErr: 13.07310 batch_time=0.38882 
Train Epoch: 44 [391/1000 12512/32000 (39%)] Loss: 0.72753 (QuantReg: 12.89878) QuantErr: 12.89878 batch_time=0.37001 
Train Epoch: 44 [396/1000 12672/32000 (40%)] Loss: 0.15297 (QuantReg: 13.41988) QuantErr: 13.41988 batch_time=0.38050 
Train Epoch: 44 [401/1000 12832/32000 (40%)] Loss: 0.67405 (QuantReg: 13.48801) QuantErr: 13.48801 batch_time=0.37788 
Train Epoch: 44 [406/1000 12992/32000 (41%)] Loss: 0.10032 (QuantReg: 13.52075) QuantErr: 13.52075 batch_time=0.53879 
Train Epoch: 44 [411/1000 13152/32000 (41%)] Loss: 0.28412 (QuantReg: 13.11017) QuantErr: 13.11017 batch_time=0.49265 
Train Epoch: 44 [416/1000 13312/32000 (42%)] Loss: 0.53428 (QuantReg: 13.36054) QuantErr: 13.36054 batch_time=0.46433 
Train Epoch: 44 [421/1000 13472/32000 (42%)] Loss: 0.12491 (QuantReg: 13.38694) QuantErr: 13.38694 batch_time=0.60221 
Train Epoch: 44 [426/1000 13632/32000 (43%)] Loss: 0.22577 (QuantReg: 13.89885) QuantErr: 13.89885 batch_time=0.51007 
Train Epoch: 44 [431/1000 13792/32000 (43%)] Loss: 0.45478 (QuantReg: 13.21557) QuantErr: 13.21557 batch_time=0.37310 
Train Epoch: 44 [436/1000 13952/32000 (44%)] Loss: 0.41736 (QuantReg: 13.08752) QuantErr: 13.08752 batch_time=0.53313 
Train Epoch: 44 [441/1000 14112/32000 (44%)] Loss: 0.24150 (QuantReg: 13.12018) QuantErr: 13.12018 batch_time=0.36771 
Train Epoch: 44 [446/1000 14272/32000 (45%)] Loss: 0.39615 (QuantReg: 13.23106) QuantErr: 13.23106 batch_time=0.42936 
Train Epoch: 44 [451/1000 14432/32000 (45%)] Loss: 0.42866 (QuantReg: 13.16209) QuantErr: 13.16209 batch_time=0.35029 
Train Epoch: 44 [456/1000 14592/32000 (46%)] Loss: 0.39268 (QuantReg: 12.90599) QuantErr: 12.90599 batch_time=0.37784 
Train Epoch: 44 [461/1000 14752/32000 (46%)] Loss: 0.39067 (QuantReg: 13.00891) QuantErr: 13.00891 batch_time=0.47555 
Train Epoch: 44 [466/1000 14912/32000 (47%)] Loss: 0.27154 (QuantReg: 13.86037) QuantErr: 13.86037 batch_time=0.72370 
Train Epoch: 44 [471/1000 15072/32000 (47%)] Loss: 0.58026 (QuantReg: 12.97505) QuantErr: 12.97505 batch_time=0.36572 
Train Epoch: 44 [476/1000 15232/32000 (48%)] Loss: 0.30360 (QuantReg: 13.29612) QuantErr: 13.29612 batch_time=0.38430 
Train Epoch: 44 [481/1000 15392/32000 (48%)] Loss: 0.22836 (QuantReg: 13.74840) QuantErr: 13.74840 batch_time=0.35987 
Train Epoch: 44 [486/1000 15552/32000 (49%)] Loss: 0.34111 (QuantReg: 12.87346) QuantErr: 12.87346 batch_time=0.36453 
Train Epoch: 44 [491/1000 15712/32000 (49%)] Loss: 0.19586 (QuantReg: 12.74724) QuantErr: 12.74724 batch_time=0.38817 
Train Epoch: 44 [496/1000 15872/32000 (50%)] Loss: 0.43969 (QuantReg: 13.38634) QuantErr: 13.38634 batch_time=0.41168 
Train Epoch: 44 [501/1000 16032/32000 (50%)] Loss: 0.18407 (QuantReg: 13.40110) QuantErr: 13.40110 batch_time=0.41433 
Train Epoch: 44 [506/1000 16192/32000 (51%)] Loss: 0.27000 (QuantReg: 13.15253) QuantErr: 13.15253 batch_time=0.43424 
Train Epoch: 44 [511/1000 16352/32000 (51%)] Loss: 0.16572 (QuantReg: 14.00764) QuantErr: 14.00764 batch_time=0.46780 
Train Epoch: 44 [516/1000 16512/32000 (52%)] Loss: 0.38247 (QuantReg: 12.66534) QuantErr: 12.66534 batch_time=0.46520 
Train Epoch: 44 [521/1000 16672/32000 (52%)] Loss: 0.14923 (QuantReg: 13.78562) QuantErr: 13.78562 batch_time=0.35517 
Train Epoch: 44 [526/1000 16832/32000 (53%)] Loss: 0.35810 (QuantReg: 12.73901) QuantErr: 12.73901 batch_time=0.34401 
Train Epoch: 44 [531/1000 16992/32000 (53%)] Loss: 0.54760 (QuantReg: 13.54238) QuantErr: 13.54238 batch_time=0.42514 
Train Epoch: 44 [536/1000 17152/32000 (54%)] Loss: 0.22158 (QuantReg: 13.15660) QuantErr: 13.15660 batch_time=0.41500 
Train Epoch: 44 [541/1000 17312/32000 (54%)] Loss: 0.10732 (QuantReg: 13.16683) QuantErr: 13.16683 batch_time=0.42625 
Train Epoch: 44 [546/1000 17472/32000 (55%)] Loss: 0.47819 (QuantReg: 13.05395) QuantErr: 13.05395 batch_time=0.41805 
Train Epoch: 44 [551/1000 17632/32000 (55%)] Loss: 0.27549 (QuantReg: 13.63840) QuantErr: 13.63840 batch_time=0.41087 
Train Epoch: 44 [556/1000 17792/32000 (56%)] Loss: 0.30116 (QuantReg: 13.49098) QuantErr: 13.49098 batch_time=0.44087 
Train Epoch: 44 [561/1000 17952/32000 (56%)] Loss: 0.14268 (QuantReg: 13.39400) QuantErr: 13.39400 batch_time=0.39318 
Train Epoch: 44 [566/1000 18112/32000 (57%)] Loss: 0.22667 (QuantReg: 13.70560) QuantErr: 13.70560 batch_time=0.39970 
Train Epoch: 44 [571/1000 18272/32000 (57%)] Loss: 0.10256 (QuantReg: 13.70782) QuantErr: 13.70782 batch_time=0.36659 
Train Epoch: 44 [576/1000 18432/32000 (58%)] Loss: 0.30464 (QuantReg: 13.31171) QuantErr: 13.31171 batch_time=0.35508 
Train Epoch: 44 [581/1000 18592/32000 (58%)] Loss: 0.29256 (QuantReg: 13.57072) QuantErr: 13.57072 batch_time=0.35111 
Train Epoch: 44 [586/1000 18752/32000 (59%)] Loss: 0.23364 (QuantReg: 13.60415) QuantErr: 13.60415 batch_time=0.43077 
Train Epoch: 44 [591/1000 18912/32000 (59%)] Loss: 0.33079 (QuantReg: 13.51111) QuantErr: 13.51111 batch_time=0.39229 
Train Epoch: 44 [596/1000 19072/32000 (60%)] Loss: 0.08539 (QuantReg: 13.45059) QuantErr: 13.45059 batch_time=0.38637 
Train Epoch: 44 [601/1000 19232/32000 (60%)] Loss: 0.28641 (QuantReg: 13.22508) QuantErr: 13.22508 batch_time=0.40572 
Train Epoch: 44 [606/1000 19392/32000 (61%)] Loss: 0.60616 (QuantReg: 13.13682) QuantErr: 13.13682 batch_time=0.63572 
Train Epoch: 44 [611/1000 19552/32000 (61%)] Loss: 0.25048 (QuantReg: 13.75970) QuantErr: 13.75970 batch_time=0.38052 
Train Epoch: 44 [616/1000 19712/32000 (62%)] Loss: 0.69138 (QuantReg: 12.80338) QuantErr: 12.80338 batch_time=0.36724 
Train Epoch: 44 [621/1000 19872/32000 (62%)] Loss: 0.43572 (QuantReg: 13.45314) QuantErr: 13.45314 batch_time=0.41187 
Train Epoch: 44 [626/1000 20032/32000 (63%)] Loss: 0.68869 (QuantReg: 12.66194) QuantErr: 12.66194 batch_time=0.37688 
Train Epoch: 44 [631/1000 20192/32000 (63%)] Loss: 0.33135 (QuantReg: 13.08803) QuantErr: 13.08803 batch_time=0.45993 
Train Epoch: 44 [636/1000 20352/32000 (64%)] Loss: 0.17758 (QuantReg: 13.44405) QuantErr: 13.44405 batch_time=0.34406 
Train Epoch: 44 [641/1000 20512/32000 (64%)] Loss: 0.11469 (QuantReg: 13.50523) QuantErr: 13.50523 batch_time=0.40253 
Train Epoch: 44 [646/1000 20672/32000 (65%)] Loss: 0.44515 (QuantReg: 13.70608) QuantErr: 13.70608 batch_time=0.40541 
Train Epoch: 44 [651/1000 20832/32000 (65%)] Loss: 0.16555 (QuantReg: 14.13589) QuantErr: 14.13589 batch_time=0.39177 
Train Epoch: 44 [656/1000 20992/32000 (66%)] Loss: 0.38072 (QuantReg: 12.76871) QuantErr: 12.76871 batch_time=0.36379 
Train Epoch: 44 [661/1000 21152/32000 (66%)] Loss: 0.21400 (QuantReg: 13.44576) QuantErr: 13.44576 batch_time=1.50207 
Train Epoch: 44 [666/1000 21312/32000 (67%)] Loss: 0.18896 (QuantReg: 13.09044) QuantErr: 13.09044 batch_time=0.44104 
Train Epoch: 44 [671/1000 21472/32000 (67%)] Loss: 0.12693 (QuantReg: 13.46075) QuantErr: 13.46075 batch_time=0.37655 
Train Epoch: 44 [676/1000 21632/32000 (68%)] Loss: 0.28454 (QuantReg: 13.10112) QuantErr: 13.10112 batch_time=0.34331 
Train Epoch: 44 [681/1000 21792/32000 (68%)] Loss: 0.07548 (QuantReg: 13.62759) QuantErr: 13.62759 batch_time=0.39230 
Train Epoch: 44 [686/1000 21952/32000 (69%)] Loss: 0.49196 (QuantReg: 13.14326) QuantErr: 13.14326 batch_time=0.36339 
Train Epoch: 44 [691/1000 22112/32000 (69%)] Loss: 0.54148 (QuantReg: 13.50523) QuantErr: 13.50523 batch_time=0.39174 
Train Epoch: 44 [696/1000 22272/32000 (70%)] Loss: 0.17429 (QuantReg: 13.15865) QuantErr: 13.15865 batch_time=0.99322 
Train Epoch: 44 [701/1000 22432/32000 (70%)] Loss: 0.35986 (QuantReg: 12.82742) QuantErr: 12.82742 batch_time=0.34762 
Train Epoch: 44 [706/1000 22592/32000 (71%)] Loss: 0.38155 (QuantReg: 13.36179) QuantErr: 13.36179 batch_time=0.35085 
Train Epoch: 44 [711/1000 22752/32000 (71%)] Loss: 0.29217 (QuantReg: 13.18465) QuantErr: 13.18465 batch_time=0.35206 
Train Epoch: 44 [716/1000 22912/32000 (72%)] Loss: 0.26987 (QuantReg: 12.70863) QuantErr: 12.70863 batch_time=0.43893 
Train Epoch: 44 [721/1000 23072/32000 (72%)] Loss: 0.66049 (QuantReg: 12.88090) QuantErr: 12.88090 batch_time=0.38921 
Train Epoch: 44 [726/1000 23232/32000 (73%)] Loss: 0.46960 (QuantReg: 13.73382) QuantErr: 13.73382 batch_time=0.37779 
Train Epoch: 44 [731/1000 23392/32000 (73%)] Loss: 0.40171 (QuantReg: 12.49634) QuantErr: 12.49634 batch_time=0.39811 
Train Epoch: 44 [736/1000 23552/32000 (74%)] Loss: 0.07412 (QuantReg: 12.92157) QuantErr: 12.92157 batch_time=0.41860 
Train Epoch: 44 [741/1000 23712/32000 (74%)] Loss: 0.05338 (QuantReg: 13.49710) QuantErr: 13.49710 batch_time=0.40726 
Train Epoch: 44 [746/1000 23872/32000 (75%)] Loss: 0.28696 (QuantReg: 13.06716) QuantErr: 13.06716 batch_time=0.39035 
Train Epoch: 44 [751/1000 24032/32000 (75%)] Loss: 0.16995 (QuantReg: 13.25161) QuantErr: 13.25161 batch_time=0.42674 
Train Epoch: 44 [756/1000 24192/32000 (76%)] Loss: 0.21633 (QuantReg: 12.88428) QuantErr: 12.88428 batch_time=0.54539 
Train Epoch: 44 [761/1000 24352/32000 (76%)] Loss: 0.34689 (QuantReg: 12.96969) QuantErr: 12.96969 batch_time=0.36384 
Train Epoch: 44 [766/1000 24512/32000 (77%)] Loss: 0.24211 (QuantReg: 13.68772) QuantErr: 13.68772 batch_time=0.54790 
Train Epoch: 44 [771/1000 24672/32000 (77%)] Loss: 0.16945 (QuantReg: 13.27596) QuantErr: 13.27596 batch_time=0.44684 
Train Epoch: 44 [776/1000 24832/32000 (78%)] Loss: 0.19613 (QuantReg: 13.38915) QuantErr: 13.38915 batch_time=0.40495 
Train Epoch: 44 [781/1000 24992/32000 (78%)] Loss: 0.21387 (QuantReg: 13.05974) QuantErr: 13.05974 batch_time=0.37234 
Train Epoch: 44 [786/1000 25152/32000 (79%)] Loss: 0.22164 (QuantReg: 13.12621) QuantErr: 13.12621 batch_time=0.75527 
Train Epoch: 44 [791/1000 25312/32000 (79%)] Loss: 0.24605 (QuantReg: 13.87264) QuantErr: 13.87264 batch_time=0.38069 
Train Epoch: 44 [796/1000 25472/32000 (80%)] Loss: 0.17975 (QuantReg: 12.83047) QuantErr: 12.83047 batch_time=0.38708 
Train Epoch: 44 [801/1000 25632/32000 (80%)] Loss: 0.31861 (QuantReg: 13.55184) QuantErr: 13.55184 batch_time=0.37865 
Train Epoch: 44 [806/1000 25792/32000 (81%)] Loss: 0.32607 (QuantReg: 13.44537) QuantErr: 13.44537 batch_time=0.38323 
Train Epoch: 44 [811/1000 25952/32000 (81%)] Loss: 0.47588 (QuantReg: 13.04834) QuantErr: 13.04834 batch_time=0.34914 
Train Epoch: 44 [816/1000 26112/32000 (82%)] Loss: 0.31173 (QuantReg: 13.75185) QuantErr: 13.75185 batch_time=0.39627 
Train Epoch: 44 [821/1000 26272/32000 (82%)] Loss: 0.38753 (QuantReg: 13.27479) QuantErr: 13.27479 batch_time=0.37889 
Train Epoch: 44 [826/1000 26432/32000 (83%)] Loss: 0.17032 (QuantReg: 13.53220) QuantErr: 13.53220 batch_time=0.36166 
Train Epoch: 44 [831/1000 26592/32000 (83%)] Loss: 0.19585 (QuantReg: 13.32463) QuantErr: 13.32463 batch_time=0.34786 
Train Epoch: 44 [836/1000 26752/32000 (84%)] Loss: 0.26430 (QuantReg: 12.94852) QuantErr: 12.94852 batch_time=0.48282 
Train Epoch: 44 [841/1000 26912/32000 (84%)] Loss: 0.28920 (QuantReg: 13.33495) QuantErr: 13.33495 batch_time=0.61017 
Train Epoch: 44 [846/1000 27072/32000 (85%)] Loss: 0.49927 (QuantReg: 13.19482) QuantErr: 13.19482 batch_time=0.53037 
Train Epoch: 44 [851/1000 27232/32000 (85%)] Loss: 0.54812 (QuantReg: 13.15691) QuantErr: 13.15691 batch_time=0.54865 
Train Epoch: 44 [856/1000 27392/32000 (86%)] Loss: 0.31971 (QuantReg: 12.68089) QuantErr: 12.68089 batch_time=0.35256 
Train Epoch: 44 [861/1000 27552/32000 (86%)] Loss: 0.48766 (QuantReg: 12.32954) QuantErr: 12.32954 batch_time=0.45956 
Train Epoch: 44 [866/1000 27712/32000 (87%)] Loss: 0.29776 (QuantReg: 13.52550) QuantErr: 13.52550 batch_time=0.45582 
Train Epoch: 44 [871/1000 27872/32000 (87%)] Loss: 0.08941 (QuantReg: 13.78696) QuantErr: 13.78696 batch_time=0.42004 
Train Epoch: 44 [876/1000 28032/32000 (88%)] Loss: 0.29292 (QuantReg: 13.54264) QuantErr: 13.54264 batch_time=0.38891 
Train Epoch: 44 [881/1000 28192/32000 (88%)] Loss: 0.43619 (QuantReg: 13.13484) QuantErr: 13.13484 batch_time=0.34246 
Train Epoch: 44 [886/1000 28352/32000 (89%)] Loss: 0.15224 (QuantReg: 13.45965) QuantErr: 13.45965 batch_time=0.34601 
Train Epoch: 44 [891/1000 28512/32000 (89%)] Loss: 0.46702 (QuantReg: 13.04379) QuantErr: 13.04379 batch_time=0.37752 
Train Epoch: 44 [896/1000 28672/32000 (90%)] Loss: 0.09290 (QuantReg: 13.91314) QuantErr: 13.91314 batch_time=0.36163 
Train Epoch: 44 [901/1000 28832/32000 (90%)] Loss: 0.63026 (QuantReg: 13.49606) QuantErr: 13.49606 batch_time=0.43323 
Train Epoch: 44 [906/1000 28992/32000 (91%)] Loss: 0.18566 (QuantReg: 13.49226) QuantErr: 13.49226 batch_time=0.51999 
Train Epoch: 44 [911/1000 29152/32000 (91%)] Loss: 0.33346 (QuantReg: 13.20284) QuantErr: 13.20284 batch_time=0.37924 
Train Epoch: 44 [916/1000 29312/32000 (92%)] Loss: 0.22903 (QuantReg: 13.66082) QuantErr: 13.66082 batch_time=0.42901 
Train Epoch: 44 [921/1000 29472/32000 (92%)] Loss: 0.16474 (QuantReg: 12.49453) QuantErr: 12.49453 batch_time=0.39801 
Train Epoch: 44 [926/1000 29632/32000 (93%)] Loss: 0.38608 (QuantReg: 12.58605) QuantErr: 12.58605 batch_time=0.63955 
Train Epoch: 44 [931/1000 29792/32000 (93%)] Loss: 0.25885 (QuantReg: 12.88359) QuantErr: 12.88359 batch_time=0.42649 
Train Epoch: 44 [936/1000 29952/32000 (94%)] Loss: 0.32332 (QuantReg: 13.84251) QuantErr: 13.84251 batch_time=0.50335 
Train Epoch: 44 [941/1000 30112/32000 (94%)] Loss: 0.37033 (QuantReg: 13.82171) QuantErr: 13.82171 batch_time=0.57367 
Train Epoch: 44 [946/1000 30272/32000 (95%)] Loss: 0.09340 (QuantReg: 13.29120) QuantErr: 13.29120 batch_time=0.55408 
Train Epoch: 44 [951/1000 30432/32000 (95%)] Loss: 0.17791 (QuantReg: 13.73037) QuantErr: 13.73037 batch_time=0.39508 
Train Epoch: 44 [956/1000 30592/32000 (96%)] Loss: 0.24784 (QuantReg: 14.19052) QuantErr: 14.19052 batch_time=0.43686 
Train Epoch: 44 [961/1000 30752/32000 (96%)] Loss: 0.16612 (QuantReg: 13.75380) QuantErr: 13.75380 batch_time=0.51831 
Train Epoch: 44 [966/1000 30912/32000 (97%)] Loss: 0.24810 (QuantReg: 13.43625) QuantErr: 13.43625 batch_time=0.41740 
Train Epoch: 44 [971/1000 31072/32000 (97%)] Loss: 0.07667 (QuantReg: 13.60523) QuantErr: 13.60523 batch_time=0.39871 
Train Epoch: 44 [976/1000 31232/32000 (98%)] Loss: 0.69104 (QuantReg: 13.04167) QuantErr: 13.04167 batch_time=0.54367 
Train Epoch: 44 [981/1000 31392/32000 (98%)] Loss: 0.25327 (QuantReg: 13.04798) QuantErr: 13.04798 batch_time=0.71317 
Train Epoch: 44 [986/1000 31552/32000 (99%)] Loss: 0.30010 (QuantReg: 13.69940) QuantErr: 13.69940 batch_time=0.58670 
Train Epoch: 44 [991/1000 31712/32000 (99%)] Loss: 0.82917 (QuantReg: 13.15248) QuantErr: 13.15248 batch_time=0.54581 
Train Epoch: 44 [996/1000 31872/32000 (100%)] Loss: 0.45047 (QuantReg: 13.62873) QuantErr: 13.62873 batch_time=0.55304 
Train Epoch: 44 codebook_update_time=2.14376
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch44.pth ...
Done in 5.565s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 0.31333057214319704
 quant_reg      : 13.267047981262207
 quant_err      : 13.267047981262207
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 44000
 MSRVTT_miech_test/t2v_metrics/R1: 22.0
 MSRVTT_miech_test/t2v_metrics/R5: 49.3
 MSRVTT_miech_test/t2v_metrics/R10: 64.4
 MSRVTT_miech_test/t2v_metrics/R50: 87.2
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.694
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.18304829373106
 MSRVTT_miech_test/v2t_metrics/R1: 20.8
 MSRVTT_miech_test/v2t_metrics/R5: 51.6
 MSRVTT_miech_test/v2t_metrics/R10: 66.1
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.649
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.39725062840584
 mnt_best       : 41.31665652816386
 not_improved_count: 2
Train Epoch: 45 [1/1000 32/32000 (0%)] Loss: 0.25626 (QuantReg: 13.39208) QuantErr: 13.39208 batch_time=28.66405 
Train Epoch: 45 [6/1000 192/32000 (1%)] Loss: 0.21982 (QuantReg: 13.83886) QuantErr: 13.83886 batch_time=0.45478 
Train Epoch: 45 [11/1000 352/32000 (1%)] Loss: 0.49831 (QuantReg: 13.13259) QuantErr: 13.13259 batch_time=0.48609 
Train Epoch: 45 [16/1000 512/32000 (2%)] Loss: 0.12818 (QuantReg: 13.32677) QuantErr: 13.32677 batch_time=0.53406 
Train Epoch: 45 [21/1000 672/32000 (2%)] Loss: 0.68232 (QuantReg: 13.35498) QuantErr: 13.35498 batch_time=0.54405 
Train Epoch: 45 [26/1000 832/32000 (3%)] Loss: 0.38109 (QuantReg: 13.30467) QuantErr: 13.30467 batch_time=0.39132 
Train Epoch: 45 [31/1000 992/32000 (3%)] Loss: 0.27950 (QuantReg: 13.35308) QuantErr: 13.35308 batch_time=0.46794 
Train Epoch: 45 [36/1000 1152/32000 (4%)] Loss: 0.31850 (QuantReg: 13.26508) QuantErr: 13.26508 batch_time=0.54993 
Train Epoch: 45 [41/1000 1312/32000 (4%)] Loss: 0.66434 (QuantReg: 12.93373) QuantErr: 12.93373 batch_time=0.36485 
Train Epoch: 45 [46/1000 1472/32000 (5%)] Loss: 0.37980 (QuantReg: 13.10869) QuantErr: 13.10869 batch_time=0.34907 
Train Epoch: 45 [51/1000 1632/32000 (5%)] Loss: 0.17084 (QuantReg: 12.34456) QuantErr: 12.34456 batch_time=0.36188 
Train Epoch: 45 [56/1000 1792/32000 (6%)] Loss: 0.09442 (QuantReg: 13.55846) QuantErr: 13.55846 batch_time=0.37346 
Train Epoch: 45 [61/1000 1952/32000 (6%)] Loss: 0.38523 (QuantReg: 13.68703) QuantErr: 13.68703 batch_time=0.52690 
Train Epoch: 45 [66/1000 2112/32000 (7%)] Loss: 0.28447 (QuantReg: 12.95491) QuantErr: 12.95491 batch_time=0.46443 
Train Epoch: 45 [71/1000 2272/32000 (7%)] Loss: 0.51959 (QuantReg: 13.10002) QuantErr: 13.10002 batch_time=0.58072 
Train Epoch: 45 [76/1000 2432/32000 (8%)] Loss: 0.51051 (QuantReg: 12.65058) QuantErr: 12.65058 batch_time=0.46105 
Train Epoch: 45 [81/1000 2592/32000 (8%)] Loss: 0.47459 (QuantReg: 13.02884) QuantErr: 13.02884 batch_time=0.66723 
Train Epoch: 45 [86/1000 2752/32000 (9%)] Loss: 0.25117 (QuantReg: 12.75980) QuantErr: 12.75980 batch_time=1.14506 
Train Epoch: 45 [91/1000 2912/32000 (9%)] Loss: 0.16375 (QuantReg: 13.39480) QuantErr: 13.39480 batch_time=0.35752 
Train Epoch: 45 [96/1000 3072/32000 (10%)] Loss: 0.16366 (QuantReg: 13.72727) QuantErr: 13.72727 batch_time=0.36074 
Train Epoch: 45 [101/1000 3232/32000 (10%)] Loss: 0.39661 (QuantReg: 13.83742) QuantErr: 13.83742 batch_time=0.43151 
Train Epoch: 45 [106/1000 3392/32000 (11%)] Loss: 0.39831 (QuantReg: 13.05907) QuantErr: 13.05907 batch_time=0.52887 
Train Epoch: 45 [111/1000 3552/32000 (11%)] Loss: 0.32339 (QuantReg: 13.13545) QuantErr: 13.13545 batch_time=0.42687 
Train Epoch: 45 [116/1000 3712/32000 (12%)] Loss: 0.36124 (QuantReg: 13.28645) QuantErr: 13.28645 batch_time=0.37380 
Train Epoch: 45 [121/1000 3872/32000 (12%)] Loss: 0.27757 (QuantReg: 13.64394) QuantErr: 13.64394 batch_time=0.34237 
Train Epoch: 45 [126/1000 4032/32000 (13%)] Loss: 0.15918 (QuantReg: 13.34697) QuantErr: 13.34697 batch_time=0.55778 
Train Epoch: 45 [131/1000 4192/32000 (13%)] Loss: 0.25662 (QuantReg: 12.47813) QuantErr: 12.47813 batch_time=0.49761 
Train Epoch: 45 [136/1000 4352/32000 (14%)] Loss: 0.16397 (QuantReg: 13.31318) QuantErr: 13.31318 batch_time=0.34750 
Train Epoch: 45 [141/1000 4512/32000 (14%)] Loss: 0.23048 (QuantReg: 12.60160) QuantErr: 12.60160 batch_time=0.34988 
Train Epoch: 45 [146/1000 4672/32000 (15%)] Loss: 0.25255 (QuantReg: 13.07231) QuantErr: 13.07231 batch_time=0.34872 
Train Epoch: 45 [151/1000 4832/32000 (15%)] Loss: 0.19158 (QuantReg: 13.60802) QuantErr: 13.60802 batch_time=0.40797 
Train Epoch: 45 [156/1000 4992/32000 (16%)] Loss: 0.24390 (QuantReg: 13.36866) QuantErr: 13.36866 batch_time=0.42775 
Train Epoch: 45 [161/1000 5152/32000 (16%)] Loss: 0.32010 (QuantReg: 13.46561) QuantErr: 13.46561 batch_time=0.39058 
Train Epoch: 45 [166/1000 5312/32000 (17%)] Loss: 0.19943 (QuantReg: 13.23905) QuantErr: 13.23905 batch_time=0.37684 
Train Epoch: 45 [171/1000 5472/32000 (17%)] Loss: 0.13376 (QuantReg: 13.83622) QuantErr: 13.83622 batch_time=0.38589 
Train Epoch: 45 [176/1000 5632/32000 (18%)] Loss: 0.07321 (QuantReg: 13.46993) QuantErr: 13.46993 batch_time=0.60379 
Train Epoch: 45 [181/1000 5792/32000 (18%)] Loss: 0.18492 (QuantReg: 13.50253) QuantErr: 13.50253 batch_time=0.35090 
Train Epoch: 45 [186/1000 5952/32000 (19%)] Loss: 0.45398 (QuantReg: 13.38095) QuantErr: 13.38095 batch_time=0.38041 
Train Epoch: 45 [191/1000 6112/32000 (19%)] Loss: 0.47890 (QuantReg: 12.97841) QuantErr: 12.97841 batch_time=0.41218 
Train Epoch: 45 [196/1000 6272/32000 (20%)] Loss: 0.48272 (QuantReg: 13.00834) QuantErr: 13.00834 batch_time=0.62083 
Train Epoch: 45 [201/1000 6432/32000 (20%)] Loss: 0.16997 (QuantReg: 12.91756) QuantErr: 12.91756 batch_time=0.41088 
Train Epoch: 45 [206/1000 6592/32000 (21%)] Loss: 0.25981 (QuantReg: 13.06070) QuantErr: 13.06070 batch_time=0.39054 
Train Epoch: 45 [211/1000 6752/32000 (21%)] Loss: 0.43741 (QuantReg: 13.07428) QuantErr: 13.07428 batch_time=0.51227 
Train Epoch: 45 [216/1000 6912/32000 (22%)] Loss: 0.16505 (QuantReg: 13.06163) QuantErr: 13.06163 batch_time=0.39666 
Train Epoch: 45 [221/1000 7072/32000 (22%)] Loss: 0.09867 (QuantReg: 13.53155) QuantErr: 13.53155 batch_time=0.37327 
Train Epoch: 45 [226/1000 7232/32000 (23%)] Loss: 0.16128 (QuantReg: 13.46185) QuantErr: 13.46185 batch_time=0.34700 
Train Epoch: 45 [231/1000 7392/32000 (23%)] Loss: 0.22484 (QuantReg: 13.16962) QuantErr: 13.16962 batch_time=0.35475 
Train Epoch: 45 [236/1000 7552/32000 (24%)] Loss: 0.39408 (QuantReg: 13.22279) QuantErr: 13.22279 batch_time=0.39583 
Train Epoch: 45 [241/1000 7712/32000 (24%)] Loss: 0.42774 (QuantReg: 13.14667) QuantErr: 13.14667 batch_time=0.37821 
Train Epoch: 45 [246/1000 7872/32000 (25%)] Loss: 0.22716 (QuantReg: 13.39956) QuantErr: 13.39956 batch_time=0.37800 
Train Epoch: 45 [251/1000 8032/32000 (25%)] Loss: 0.38163 (QuantReg: 12.84718) QuantErr: 12.84718 batch_time=0.35523 
Train Epoch: 45 [256/1000 8192/32000 (26%)] Loss: 0.47536 (QuantReg: 13.16219) QuantErr: 13.16219 batch_time=0.41992 
Train Epoch: 45 [261/1000 8352/32000 (26%)] Loss: 0.19513 (QuantReg: 13.26605) QuantErr: 13.26605 batch_time=0.35546 
Train Epoch: 45 [266/1000 8512/32000 (27%)] Loss: 0.17953 (QuantReg: 13.55697) QuantErr: 13.55697 batch_time=0.38205 
Train Epoch: 45 [271/1000 8672/32000 (27%)] Loss: 0.32305 (QuantReg: 13.45635) QuantErr: 13.45635 batch_time=0.42059 
Train Epoch: 45 [276/1000 8832/32000 (28%)] Loss: 0.20646 (QuantReg: 13.29440) QuantErr: 13.29440 batch_time=0.36970 
Train Epoch: 45 [281/1000 8992/32000 (28%)] Loss: 0.10919 (QuantReg: 12.89673) QuantErr: 12.89673 batch_time=0.36873 
Train Epoch: 45 [286/1000 9152/32000 (29%)] Loss: 0.11638 (QuantReg: 13.13694) QuantErr: 13.13694 batch_time=0.59940 
Train Epoch: 45 [291/1000 9312/32000 (29%)] Loss: 0.50783 (QuantReg: 12.41247) QuantErr: 12.41247 batch_time=0.43826 
Train Epoch: 45 [296/1000 9472/32000 (30%)] Loss: 0.53398 (QuantReg: 13.41162) QuantErr: 13.41162 batch_time=0.39507 
Train Epoch: 45 [301/1000 9632/32000 (30%)] Loss: 0.30896 (QuantReg: 13.22812) QuantErr: 13.22812 batch_time=0.34835 
Train Epoch: 45 [306/1000 9792/32000 (31%)] Loss: 0.16225 (QuantReg: 12.91096) QuantErr: 12.91096 batch_time=0.47169 
Train Epoch: 45 [311/1000 9952/32000 (31%)] Loss: 0.23044 (QuantReg: 13.32202) QuantErr: 13.32202 batch_time=0.42125 
Train Epoch: 45 [316/1000 10112/32000 (32%)] Loss: 0.51882 (QuantReg: 12.76126) QuantErr: 12.76126 batch_time=0.39113 
Train Epoch: 45 [321/1000 10272/32000 (32%)] Loss: 0.25923 (QuantReg: 12.80888) QuantErr: 12.80888 batch_time=0.45964 
Train Epoch: 45 [326/1000 10432/32000 (33%)] Loss: 0.44028 (QuantReg: 13.02631) QuantErr: 13.02631 batch_time=0.43901 
Train Epoch: 45 [331/1000 10592/32000 (33%)] Loss: 0.43715 (QuantReg: 13.21181) QuantErr: 13.21181 batch_time=0.55374 
Train Epoch: 45 [336/1000 10752/32000 (34%)] Loss: 0.50189 (QuantReg: 13.41298) QuantErr: 13.41298 batch_time=0.42564 
Train Epoch: 45 [341/1000 10912/32000 (34%)] Loss: 0.72464 (QuantReg: 12.93990) QuantErr: 12.93990 batch_time=0.41233 
Train Epoch: 45 [346/1000 11072/32000 (35%)] Loss: 0.30215 (QuantReg: 13.88925) QuantErr: 13.88925 batch_time=0.54184 
Train Epoch: 45 [351/1000 11232/32000 (35%)] Loss: 0.32317 (QuantReg: 13.31063) QuantErr: 13.31063 batch_time=0.42120 
Train Epoch: 45 [356/1000 11392/32000 (36%)] Loss: 0.28539 (QuantReg: 13.13508) QuantErr: 13.13508 batch_time=0.45500 
Train Epoch: 45 [361/1000 11552/32000 (36%)] Loss: 0.17172 (QuantReg: 13.43377) QuantErr: 13.43377 batch_time=0.38926 
Train Epoch: 45 [366/1000 11712/32000 (37%)] Loss: 0.20352 (QuantReg: 13.08067) QuantErr: 13.08067 batch_time=0.45722 
Train Epoch: 45 [371/1000 11872/32000 (37%)] Loss: 0.34074 (QuantReg: 13.92426) QuantErr: 13.92426 batch_time=0.36131 
Train Epoch: 45 [376/1000 12032/32000 (38%)] Loss: 0.15327 (QuantReg: 12.97909) QuantErr: 12.97909 batch_time=0.36227 
Train Epoch: 45 [381/1000 12192/32000 (38%)] Loss: 0.39279 (QuantReg: 13.34929) QuantErr: 13.34929 batch_time=0.40964 
Train Epoch: 45 [386/1000 12352/32000 (39%)] Loss: 0.32414 (QuantReg: 13.79673) QuantErr: 13.79673 batch_time=0.57664 
Train Epoch: 45 [391/1000 12512/32000 (39%)] Loss: 0.18360 (QuantReg: 12.96259) QuantErr: 12.96259 batch_time=0.40608 
Train Epoch: 45 [396/1000 12672/32000 (40%)] Loss: 0.39536 (QuantReg: 12.83914) QuantErr: 12.83914 batch_time=0.34930 
Train Epoch: 45 [401/1000 12832/32000 (40%)] Loss: 0.13962 (QuantReg: 13.33029) QuantErr: 13.33029 batch_time=2.93676 
Train Epoch: 45 [406/1000 12992/32000 (41%)] Loss: 0.34516 (QuantReg: 12.47030) QuantErr: 12.47030 batch_time=0.35517 
Train Epoch: 45 [411/1000 13152/32000 (41%)] Loss: 0.16111 (QuantReg: 13.50658) QuantErr: 13.50658 batch_time=0.38063 
Train Epoch: 45 [416/1000 13312/32000 (42%)] Loss: 0.38460 (QuantReg: 13.49417) QuantErr: 13.49417 batch_time=0.39035 
Train Epoch: 45 [421/1000 13472/32000 (42%)] Loss: 0.18475 (QuantReg: 13.65837) QuantErr: 13.65837 batch_time=0.44496 
Train Epoch: 45 [426/1000 13632/32000 (43%)] Loss: 0.24552 (QuantReg: 13.84025) QuantErr: 13.84025 batch_time=0.37260 
Train Epoch: 45 [431/1000 13792/32000 (43%)] Loss: 0.18949 (QuantReg: 13.75954) QuantErr: 13.75954 batch_time=1.10114 
Train Epoch: 45 [436/1000 13952/32000 (44%)] Loss: 0.29024 (QuantReg: 13.41276) QuantErr: 13.41276 batch_time=0.36960 
Train Epoch: 45 [441/1000 14112/32000 (44%)] Loss: 0.38064 (QuantReg: 14.31536) QuantErr: 14.31536 batch_time=0.36054 
Train Epoch: 45 [446/1000 14272/32000 (45%)] Loss: 0.30366 (QuantReg: 13.22418) QuantErr: 13.22418 batch_time=0.42505 
Train Epoch: 45 [451/1000 14432/32000 (45%)] Loss: 0.31836 (QuantReg: 13.61839) QuantErr: 13.61839 batch_time=0.35771 
Train Epoch: 45 [456/1000 14592/32000 (46%)] Loss: 0.30177 (QuantReg: 13.47188) QuantErr: 13.47188 batch_time=0.35817 
Train Epoch: 45 [461/1000 14752/32000 (46%)] Loss: 0.25876 (QuantReg: 12.67213) QuantErr: 12.67213 batch_time=0.56716 
Train Epoch: 45 [466/1000 14912/32000 (47%)] Loss: 0.21258 (QuantReg: 12.97756) QuantErr: 12.97756 batch_time=0.38995 
Train Epoch: 45 [471/1000 15072/32000 (47%)] Loss: 0.09125 (QuantReg: 13.50282) QuantErr: 13.50282 batch_time=0.66087 
Train Epoch: 45 [476/1000 15232/32000 (48%)] Loss: 0.09597 (QuantReg: 13.46023) QuantErr: 13.46023 batch_time=0.46169 
Train Epoch: 45 [481/1000 15392/32000 (48%)] Loss: 0.42013 (QuantReg: 13.49800) QuantErr: 13.49800 batch_time=0.37501 
Train Epoch: 45 [486/1000 15552/32000 (49%)] Loss: 0.15793 (QuantReg: 13.08883) QuantErr: 13.08883 batch_time=0.38628 
Train Epoch: 45 [491/1000 15712/32000 (49%)] Loss: 0.09133 (QuantReg: 13.46882) QuantErr: 13.46882 batch_time=0.39687 
Train Epoch: 45 [496/1000 15872/32000 (50%)] Loss: 0.17074 (QuantReg: 13.40973) QuantErr: 13.40973 batch_time=0.70497 
Train Epoch: 45 [501/1000 16032/32000 (50%)] Loss: 0.23149 (QuantReg: 13.69104) QuantErr: 13.69104 batch_time=0.34604 
Train Epoch: 45 [506/1000 16192/32000 (51%)] Loss: 0.30031 (QuantReg: 13.53472) QuantErr: 13.53472 batch_time=0.37510 
Train Epoch: 45 [511/1000 16352/32000 (51%)] Loss: 0.22181 (QuantReg: 13.78671) QuantErr: 13.78671 batch_time=0.42731 
Train Epoch: 45 [516/1000 16512/32000 (52%)] Loss: 0.21672 (QuantReg: 13.77410) QuantErr: 13.77410 batch_time=0.40605 
Train Epoch: 45 [521/1000 16672/32000 (52%)] Loss: 0.16688 (QuantReg: 13.30224) QuantErr: 13.30224 batch_time=0.43637 
Train Epoch: 45 [526/1000 16832/32000 (53%)] Loss: 0.26074 (QuantReg: 12.98889) QuantErr: 12.98889 batch_time=0.36616 
Train Epoch: 45 [531/1000 16992/32000 (53%)] Loss: 0.20689 (QuantReg: 13.08339) QuantErr: 13.08339 batch_time=0.37867 
Train Epoch: 45 [536/1000 17152/32000 (54%)] Loss: 0.61249 (QuantReg: 13.27807) QuantErr: 13.27807 batch_time=0.37840 
Train Epoch: 45 [541/1000 17312/32000 (54%)] Loss: 0.16081 (QuantReg: 13.50128) QuantErr: 13.50128 batch_time=0.45651 
Train Epoch: 45 [546/1000 17472/32000 (55%)] Loss: 0.10459 (QuantReg: 12.89171) QuantErr: 12.89171 batch_time=0.35997 
Train Epoch: 45 [551/1000 17632/32000 (55%)] Loss: 0.18409 (QuantReg: 13.44669) QuantErr: 13.44669 batch_time=0.36645 
Train Epoch: 45 [556/1000 17792/32000 (56%)] Loss: 0.22683 (QuantReg: 13.53757) QuantErr: 13.53757 batch_time=0.37444 
Train Epoch: 45 [561/1000 17952/32000 (56%)] Loss: 0.13781 (QuantReg: 13.20351) QuantErr: 13.20351 batch_time=0.41002 
Train Epoch: 45 [566/1000 18112/32000 (57%)] Loss: 0.49864 (QuantReg: 13.59514) QuantErr: 13.59514 batch_time=0.42574 
Train Epoch: 45 [571/1000 18272/32000 (57%)] Loss: 0.51334 (QuantReg: 12.60808) QuantErr: 12.60808 batch_time=0.36896 
Train Epoch: 45 [576/1000 18432/32000 (58%)] Loss: 0.13109 (QuantReg: 13.39254) QuantErr: 13.39254 batch_time=0.35732 
Train Epoch: 45 [581/1000 18592/32000 (58%)] Loss: 0.36375 (QuantReg: 14.04807) QuantErr: 14.04807 batch_time=0.49464 
Train Epoch: 45 [586/1000 18752/32000 (59%)] Loss: 0.23353 (QuantReg: 13.58558) QuantErr: 13.58558 batch_time=0.37200 
Train Epoch: 45 [591/1000 18912/32000 (59%)] Loss: 0.49688 (QuantReg: 13.32237) QuantErr: 13.32237 batch_time=0.37659 
Train Epoch: 45 [596/1000 19072/32000 (60%)] Loss: 0.50345 (QuantReg: 12.94855) QuantErr: 12.94855 batch_time=0.36860 
Train Epoch: 45 [601/1000 19232/32000 (60%)] Loss: 0.65794 (QuantReg: 12.70951) QuantErr: 12.70951 batch_time=0.37917 
Train Epoch: 45 [606/1000 19392/32000 (61%)] Loss: 0.32492 (QuantReg: 13.60342) QuantErr: 13.60342 batch_time=0.37447 
Train Epoch: 45 [611/1000 19552/32000 (61%)] Loss: 0.41838 (QuantReg: 12.92540) QuantErr: 12.92540 batch_time=0.48787 
Train Epoch: 45 [616/1000 19712/32000 (62%)] Loss: 0.31737 (QuantReg: 13.71197) QuantErr: 13.71197 batch_time=0.38567 
Train Epoch: 45 [621/1000 19872/32000 (62%)] Loss: 0.09637 (QuantReg: 13.44807) QuantErr: 13.44807 batch_time=0.40967 
Train Epoch: 45 [626/1000 20032/32000 (63%)] Loss: 0.30137 (QuantReg: 12.68795) QuantErr: 12.68795 batch_time=0.39493 
Train Epoch: 45 [631/1000 20192/32000 (63%)] Loss: 0.08231 (QuantReg: 13.27617) QuantErr: 13.27617 batch_time=0.37938 
Train Epoch: 45 [636/1000 20352/32000 (64%)] Loss: 0.23488 (QuantReg: 13.67286) QuantErr: 13.67286 batch_time=0.35611 
Train Epoch: 45 [641/1000 20512/32000 (64%)] Loss: 0.23414 (QuantReg: 13.59900) QuantErr: 13.59900 batch_time=0.37824 
Train Epoch: 45 [646/1000 20672/32000 (65%)] Loss: 0.29411 (QuantReg: 13.18821) QuantErr: 13.18821 batch_time=0.37423 
Train Epoch: 45 [651/1000 20832/32000 (65%)] Loss: 0.58747 (QuantReg: 12.62856) QuantErr: 12.62856 batch_time=0.45387 
Train Epoch: 45 [656/1000 20992/32000 (66%)] Loss: 0.31488 (QuantReg: 12.93149) QuantErr: 12.93149 batch_time=0.46000 
Train Epoch: 45 [661/1000 21152/32000 (66%)] Loss: 0.16288 (QuantReg: 13.13870) QuantErr: 13.13870 batch_time=0.94978 
Train Epoch: 45 [666/1000 21312/32000 (67%)] Loss: 0.20730 (QuantReg: 13.41643) QuantErr: 13.41643 batch_time=0.37072 
Train Epoch: 45 [671/1000 21472/32000 (67%)] Loss: 0.20323 (QuantReg: 13.80883) QuantErr: 13.80883 batch_time=0.38723 
Train Epoch: 45 [676/1000 21632/32000 (68%)] Loss: 0.15069 (QuantReg: 12.94778) QuantErr: 12.94778 batch_time=0.36908 
Train Epoch: 45 [681/1000 21792/32000 (68%)] Loss: 0.29242 (QuantReg: 12.73532) QuantErr: 12.73532 batch_time=0.35040 
Train Epoch: 45 [686/1000 21952/32000 (69%)] Loss: 0.15826 (QuantReg: 13.36238) QuantErr: 13.36238 batch_time=0.35622 
Train Epoch: 45 [691/1000 22112/32000 (69%)] Loss: 0.24744 (QuantReg: 13.35171) QuantErr: 13.35171 batch_time=0.53368 
Train Epoch: 45 [696/1000 22272/32000 (70%)] Loss: 0.25394 (QuantReg: 13.00930) QuantErr: 13.00930 batch_time=0.46549 
Train Epoch: 45 [701/1000 22432/32000 (70%)] Loss: 0.27374 (QuantReg: 13.05832) QuantErr: 13.05832 batch_time=1.16650 
Train Epoch: 45 [706/1000 22592/32000 (71%)] Loss: 0.27978 (QuantReg: 13.62162) QuantErr: 13.62162 batch_time=0.36241 
Train Epoch: 45 [711/1000 22752/32000 (71%)] Loss: 0.43720 (QuantReg: 12.61562) QuantErr: 12.61562 batch_time=0.40638 
Train Epoch: 45 [716/1000 22912/32000 (72%)] Loss: 1.05647 (QuantReg: 13.07887) QuantErr: 13.07887 batch_time=0.34949 
Train Epoch: 45 [721/1000 23072/32000 (72%)] Loss: 0.11279 (QuantReg: 12.84076) QuantErr: 12.84076 batch_time=0.95839 
Train Epoch: 45 [726/1000 23232/32000 (73%)] Loss: 0.34095 (QuantReg: 13.64047) QuantErr: 13.64047 batch_time=0.35197 
Train Epoch: 45 [731/1000 23392/32000 (73%)] Loss: 0.21192 (QuantReg: 13.14360) QuantErr: 13.14360 batch_time=0.39568 
Train Epoch: 45 [736/1000 23552/32000 (74%)] Loss: 0.11560 (QuantReg: 13.10918) QuantErr: 13.10918 batch_time=0.36363 
Train Epoch: 45 [741/1000 23712/32000 (74%)] Loss: 0.18801 (QuantReg: 12.85012) QuantErr: 12.85012 batch_time=0.38011 
Train Epoch: 45 [746/1000 23872/32000 (75%)] Loss: 0.19089 (QuantReg: 13.36631) QuantErr: 13.36631 batch_time=0.35411 
Train Epoch: 45 [751/1000 24032/32000 (75%)] Loss: 0.22315 (QuantReg: 13.08623) QuantErr: 13.08623 batch_time=0.88555 
Train Epoch: 45 [756/1000 24192/32000 (76%)] Loss: 0.13445 (QuantReg: 13.22288) QuantErr: 13.22288 batch_time=0.40683 
Train Epoch: 45 [761/1000 24352/32000 (76%)] Loss: 0.24602 (QuantReg: 13.11640) QuantErr: 13.11640 batch_time=0.35261 
Train Epoch: 45 [766/1000 24512/32000 (77%)] Loss: 0.26433 (QuantReg: 13.40873) QuantErr: 13.40873 batch_time=0.43466 
Train Epoch: 45 [771/1000 24672/32000 (77%)] Loss: 0.14985 (QuantReg: 13.44653) QuantErr: 13.44653 batch_time=0.43333 
Train Epoch: 45 [776/1000 24832/32000 (78%)] Loss: 0.50306 (QuantReg: 13.36806) QuantErr: 13.36806 batch_time=0.35723 
Train Epoch: 45 [781/1000 24992/32000 (78%)] Loss: 0.09864 (QuantReg: 13.10743) QuantErr: 13.10743 batch_time=0.35163 
Train Epoch: 45 [786/1000 25152/32000 (79%)] Loss: 0.42891 (QuantReg: 13.31193) QuantErr: 13.31193 batch_time=0.41113 
Train Epoch: 45 [791/1000 25312/32000 (79%)] Loss: 0.43375 (QuantReg: 13.38659) QuantErr: 13.38659 batch_time=0.43576 
Train Epoch: 45 [796/1000 25472/32000 (80%)] Loss: 0.17087 (QuantReg: 13.40506) QuantErr: 13.40506 batch_time=0.36469 
Train Epoch: 45 [801/1000 25632/32000 (80%)] Loss: 0.39387 (QuantReg: 13.13987) QuantErr: 13.13987 batch_time=0.37336 
Train Epoch: 45 [806/1000 25792/32000 (81%)] Loss: 0.38363 (QuantReg: 13.53342) QuantErr: 13.53342 batch_time=0.46294 
Train Epoch: 45 [811/1000 25952/32000 (81%)] Loss: 0.53021 (QuantReg: 13.43513) QuantErr: 13.43513 batch_time=0.38932 
Train Epoch: 45 [816/1000 26112/32000 (82%)] Loss: 0.17646 (QuantReg: 13.64761) QuantErr: 13.64761 batch_time=0.42632 
Train Epoch: 45 [821/1000 26272/32000 (82%)] Loss: 0.31780 (QuantReg: 13.10024) QuantErr: 13.10024 batch_time=0.42021 
Train Epoch: 45 [826/1000 26432/32000 (83%)] Loss: 0.23052 (QuantReg: 13.45753) QuantErr: 13.45753 batch_time=0.43496 
Train Epoch: 45 [831/1000 26592/32000 (83%)] Loss: 0.26305 (QuantReg: 12.75745) QuantErr: 12.75745 batch_time=0.41158 
Train Epoch: 45 [836/1000 26752/32000 (84%)] Loss: 0.29921 (QuantReg: 12.96949) QuantErr: 12.96949 batch_time=0.35637 
Train Epoch: 45 [841/1000 26912/32000 (84%)] Loss: 0.45364 (QuantReg: 13.82307) QuantErr: 13.82307 batch_time=0.35932 
Train Epoch: 45 [846/1000 27072/32000 (85%)] Loss: 0.20777 (QuantReg: 13.62886) QuantErr: 13.62886 batch_time=0.38196 
Train Epoch: 45 [851/1000 27232/32000 (85%)] Loss: 0.31065 (QuantReg: 13.39541) QuantErr: 13.39541 batch_time=0.35892 
Train Epoch: 45 [856/1000 27392/32000 (86%)] Loss: 0.23741 (QuantReg: 12.79549) QuantErr: 12.79549 batch_time=0.37784 
Train Epoch: 45 [861/1000 27552/32000 (86%)] Loss: 0.28444 (QuantReg: 13.06120) QuantErr: 13.06120 batch_time=0.37384 
Train Epoch: 45 [866/1000 27712/32000 (87%)] Loss: 0.13019 (QuantReg: 13.90193) QuantErr: 13.90193 batch_time=0.80711 
Train Epoch: 45 [871/1000 27872/32000 (87%)] Loss: 0.15111 (QuantReg: 13.37483) QuantErr: 13.37483 batch_time=0.36999 
Train Epoch: 45 [876/1000 28032/32000 (88%)] Loss: 0.35041 (QuantReg: 13.40093) QuantErr: 13.40093 batch_time=0.36858 
Train Epoch: 45 [881/1000 28192/32000 (88%)] Loss: 0.33807 (QuantReg: 13.33327) QuantErr: 13.33327 batch_time=0.46166 
Train Epoch: 45 [886/1000 28352/32000 (89%)] Loss: 0.28230 (QuantReg: 13.19384) QuantErr: 13.19384 batch_time=0.35833 
Train Epoch: 45 [891/1000 28512/32000 (89%)] Loss: 0.46094 (QuantReg: 13.16291) QuantErr: 13.16291 batch_time=0.37988 
Train Epoch: 45 [896/1000 28672/32000 (90%)] Loss: 0.21501 (QuantReg: 13.80132) QuantErr: 13.80132 batch_time=0.38121 
Train Epoch: 45 [901/1000 28832/32000 (90%)] Loss: 0.36455 (QuantReg: 12.93749) QuantErr: 12.93749 batch_time=0.37179 
Train Epoch: 45 [906/1000 28992/32000 (91%)] Loss: 0.10125 (QuantReg: 13.20428) QuantErr: 13.20428 batch_time=0.40697 
Train Epoch: 45 [911/1000 29152/32000 (91%)] Loss: 0.18213 (QuantReg: 13.45233) QuantErr: 13.45233 batch_time=0.39419 
Train Epoch: 45 [916/1000 29312/32000 (92%)] Loss: 0.21363 (QuantReg: 13.47586) QuantErr: 13.47586 batch_time=0.39725 
Train Epoch: 45 [921/1000 29472/32000 (92%)] Loss: 0.40565 (QuantReg: 13.17823) QuantErr: 13.17823 batch_time=0.37478 
Train Epoch: 45 [926/1000 29632/32000 (93%)] Loss: 0.44400 (QuantReg: 13.04318) QuantErr: 13.04318 batch_time=0.41062 
Train Epoch: 45 [931/1000 29792/32000 (93%)] Loss: 0.31117 (QuantReg: 13.46333) QuantErr: 13.46333 batch_time=0.39426 
Train Epoch: 45 [936/1000 29952/32000 (94%)] Loss: 0.53448 (QuantReg: 13.07770) QuantErr: 13.07770 batch_time=0.39494 
Train Epoch: 45 [941/1000 30112/32000 (94%)] Loss: 0.44980 (QuantReg: 13.31353) QuantErr: 13.31353 batch_time=0.46862 
Train Epoch: 45 [946/1000 30272/32000 (95%)] Loss: 0.32696 (QuantReg: 13.62412) QuantErr: 13.62412 batch_time=0.40615 
Train Epoch: 45 [951/1000 30432/32000 (95%)] Loss: 0.32806 (QuantReg: 13.40847) QuantErr: 13.40847 batch_time=0.39496 
Train Epoch: 45 [956/1000 30592/32000 (96%)] Loss: 0.50608 (QuantReg: 12.95439) QuantErr: 12.95439 batch_time=1.28393 
Train Epoch: 45 [961/1000 30752/32000 (96%)] Loss: 0.15088 (QuantReg: 13.57711) QuantErr: 13.57711 batch_time=0.50711 
Train Epoch: 45 [966/1000 30912/32000 (97%)] Loss: 0.28929 (QuantReg: 13.40679) QuantErr: 13.40679 batch_time=0.35239 
Train Epoch: 45 [971/1000 31072/32000 (97%)] Loss: 0.32705 (QuantReg: 13.32584) QuantErr: 13.32584 batch_time=0.34928 
Train Epoch: 45 [976/1000 31232/32000 (98%)] Loss: 0.14815 (QuantReg: 13.56030) QuantErr: 13.56030 batch_time=0.37763 
Train Epoch: 45 [981/1000 31392/32000 (98%)] Loss: 0.38007 (QuantReg: 13.46499) QuantErr: 13.46499 batch_time=0.48365 
Train Epoch: 45 [986/1000 31552/32000 (99%)] Loss: 0.28411 (QuantReg: 13.70058) QuantErr: 13.70058 batch_time=0.39425 
Train Epoch: 45 [991/1000 31712/32000 (99%)] Loss: 0.32713 (QuantReg: 13.00376) QuantErr: 13.00376 batch_time=0.37746 
Train Epoch: 45 [996/1000 31872/32000 (100%)] Loss: 0.22066 (QuantReg: 13.48381) QuantErr: 13.48381 batch_time=0.38359 
Train Epoch: 45 codebook_update_time=1.82150
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch45.pth ...
Done in 14.145s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 0.30467977875471114
 quant_reg      : 13.278884078025818
 quant_err      : 13.278884078025818
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 45000
 MSRVTT_miech_test/t2v_metrics/R1: 21.2
 MSRVTT_miech_test/t2v_metrics/R5: 50.8
 MSRVTT_miech_test/t2v_metrics/R10: 63.8
 MSRVTT_miech_test/t2v_metrics/R50: 87.0
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.902
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.95812659278318
 MSRVTT_miech_test/v2t_metrics/R1: 22.1
 MSRVTT_miech_test/v2t_metrics/R5: 51.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.3
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 27.65
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.086899631327825
 mnt_best       : 41.31665652816386
 not_improved_count: 3
Train Epoch: 46 [1/1000 32/32000 (0%)] Loss: 0.24876 (QuantReg: 13.46270) QuantErr: 13.46270 batch_time=26.50541 
Train Epoch: 46 [6/1000 192/32000 (1%)] Loss: 0.32569 (QuantReg: 13.00734) QuantErr: 13.00734 batch_time=0.52712 
Train Epoch: 46 [11/1000 352/32000 (1%)] Loss: 0.29445 (QuantReg: 13.14465) QuantErr: 13.14465 batch_time=0.38772 
Train Epoch: 46 [16/1000 512/32000 (2%)] Loss: 0.39029 (QuantReg: 13.16515) QuantErr: 13.16515 batch_time=0.40831 
Train Epoch: 46 [21/1000 672/32000 (2%)] Loss: 0.47755 (QuantReg: 13.54652) QuantErr: 13.54652 batch_time=0.43066 
Train Epoch: 46 [26/1000 832/32000 (3%)] Loss: 0.27092 (QuantReg: 13.09600) QuantErr: 13.09600 batch_time=0.38204 
Train Epoch: 46 [31/1000 992/32000 (3%)] Loss: 0.31269 (QuantReg: 12.70737) QuantErr: 12.70737 batch_time=0.37444 
Train Epoch: 46 [36/1000 1152/32000 (4%)] Loss: 0.43125 (QuantReg: 13.07146) QuantErr: 13.07146 batch_time=0.37689 
Train Epoch: 46 [41/1000 1312/32000 (4%)] Loss: 0.14315 (QuantReg: 13.35611) QuantErr: 13.35611 batch_time=0.38173 
Train Epoch: 46 [46/1000 1472/32000 (5%)] Loss: 0.47028 (QuantReg: 12.63430) QuantErr: 12.63430 batch_time=0.39658 
Train Epoch: 46 [51/1000 1632/32000 (5%)] Loss: 0.12970 (QuantReg: 13.14555) QuantErr: 13.14555 batch_time=0.38903 
Train Epoch: 46 [56/1000 1792/32000 (6%)] Loss: 0.30308 (QuantReg: 13.59486) QuantErr: 13.59486 batch_time=0.39087 
Train Epoch: 46 [61/1000 1952/32000 (6%)] Loss: 0.29126 (QuantReg: 13.77188) QuantErr: 13.77188 batch_time=0.39465 
Train Epoch: 46 [66/1000 2112/32000 (7%)] Loss: 0.10505 (QuantReg: 13.24244) QuantErr: 13.24244 batch_time=0.40845 
Train Epoch: 46 [71/1000 2272/32000 (7%)] Loss: 0.55167 (QuantReg: 12.83031) QuantErr: 12.83031 batch_time=0.39456 
Train Epoch: 46 [76/1000 2432/32000 (8%)] Loss: 0.32457 (QuantReg: 13.45415) QuantErr: 13.45415 batch_time=0.37959 
Train Epoch: 46 [81/1000 2592/32000 (8%)] Loss: 0.38251 (QuantReg: 13.40357) QuantErr: 13.40357 batch_time=0.36853 
Train Epoch: 46 [86/1000 2752/32000 (9%)] Loss: 0.27528 (QuantReg: 12.77609) QuantErr: 12.77609 batch_time=0.35763 
Train Epoch: 46 [91/1000 2912/32000 (9%)] Loss: 0.06950 (QuantReg: 13.17635) QuantErr: 13.17635 batch_time=0.38480 
Train Epoch: 46 [96/1000 3072/32000 (10%)] Loss: 0.27411 (QuantReg: 12.77571) QuantErr: 12.77571 batch_time=0.38995 
Train Epoch: 46 [101/1000 3232/32000 (10%)] Loss: 0.36374 (QuantReg: 13.83950) QuantErr: 13.83950 batch_time=0.38126 
Train Epoch: 46 [106/1000 3392/32000 (11%)] Loss: 0.19610 (QuantReg: 13.38724) QuantErr: 13.38724 batch_time=0.35797 
Train Epoch: 46 [111/1000 3552/32000 (11%)] Loss: 0.18583 (QuantReg: 12.80681) QuantErr: 12.80681 batch_time=0.35496 
Train Epoch: 46 [116/1000 3712/32000 (12%)] Loss: 0.31832 (QuantReg: 13.49099) QuantErr: 13.49099 batch_time=0.42699 
Train Epoch: 46 [121/1000 3872/32000 (12%)] Loss: 0.43354 (QuantReg: 12.48032) QuantErr: 12.48032 batch_time=0.39110 
Train Epoch: 46 [126/1000 4032/32000 (13%)] Loss: 0.26829 (QuantReg: 12.98984) QuantErr: 12.98984 batch_time=0.39981 
Train Epoch: 46 [131/1000 4192/32000 (13%)] Loss: 0.18768 (QuantReg: 13.03755) QuantErr: 13.03755 batch_time=0.43260 
Train Epoch: 46 [136/1000 4352/32000 (14%)] Loss: 0.22885 (QuantReg: 13.08360) QuantErr: 13.08360 batch_time=0.38398 
Train Epoch: 46 [141/1000 4512/32000 (14%)] Loss: 0.25784 (QuantReg: 13.52682) QuantErr: 13.52682 batch_time=1.85288 
Train Epoch: 46 [146/1000 4672/32000 (15%)] Loss: 0.44172 (QuantReg: 13.18225) QuantErr: 13.18225 batch_time=0.36250 
Train Epoch: 46 [151/1000 4832/32000 (15%)] Loss: 0.61427 (QuantReg: 13.20942) QuantErr: 13.20942 batch_time=0.53592 
Train Epoch: 46 [156/1000 4992/32000 (16%)] Loss: 0.49655 (QuantReg: 12.92834) QuantErr: 12.92834 batch_time=0.39720 
Train Epoch: 46 [161/1000 5152/32000 (16%)] Loss: 0.15635 (QuantReg: 13.01639) QuantErr: 13.01639 batch_time=0.38307 
Train Epoch: 46 [166/1000 5312/32000 (17%)] Loss: 0.57651 (QuantReg: 13.17034) QuantErr: 13.17034 batch_time=0.40487 
Train Epoch: 46 [171/1000 5472/32000 (17%)] Loss: 0.36017 (QuantReg: 13.33157) QuantErr: 13.33157 batch_time=0.35359 
Train Epoch: 46 [176/1000 5632/32000 (18%)] Loss: 0.11723 (QuantReg: 13.51301) QuantErr: 13.51301 batch_time=0.43422 
Train Epoch: 46 [181/1000 5792/32000 (18%)] Loss: 0.24852 (QuantReg: 13.02840) QuantErr: 13.02840 batch_time=0.39890 
Train Epoch: 46 [186/1000 5952/32000 (19%)] Loss: 0.15009 (QuantReg: 13.53475) QuantErr: 13.53475 batch_time=0.45340 
Train Epoch: 46 [191/1000 6112/32000 (19%)] Loss: 0.26440 (QuantReg: 13.27730) QuantErr: 13.27730 batch_time=0.37290 
Train Epoch: 46 [196/1000 6272/32000 (20%)] Loss: 0.42179 (QuantReg: 13.13819) QuantErr: 13.13819 batch_time=0.37726 
Train Epoch: 46 [201/1000 6432/32000 (20%)] Loss: 0.32405 (QuantReg: 13.34105) QuantErr: 13.34105 batch_time=0.41667 
Train Epoch: 46 [206/1000 6592/32000 (21%)] Loss: 0.44968 (QuantReg: 13.28591) QuantErr: 13.28591 batch_time=0.63646 
Train Epoch: 46 [211/1000 6752/32000 (21%)] Loss: 0.18591 (QuantReg: 12.89539) QuantErr: 12.89539 batch_time=0.36210 
Train Epoch: 46 [216/1000 6912/32000 (22%)] Loss: 0.18856 (QuantReg: 13.09473) QuantErr: 13.09473 batch_time=0.39220 
Train Epoch: 46 [221/1000 7072/32000 (22%)] Loss: 0.27693 (QuantReg: 13.59622) QuantErr: 13.59622 batch_time=1.06165 
Train Epoch: 46 [226/1000 7232/32000 (23%)] Loss: 0.50084 (QuantReg: 12.79092) QuantErr: 12.79092 batch_time=0.43105 
Train Epoch: 46 [231/1000 7392/32000 (23%)] Loss: 0.11269 (QuantReg: 13.03290) QuantErr: 13.03290 batch_time=0.37038 
Train Epoch: 46 [236/1000 7552/32000 (24%)] Loss: 0.25350 (QuantReg: 13.26417) QuantErr: 13.26417 batch_time=0.47166 
Train Epoch: 46 [241/1000 7712/32000 (24%)] Loss: 0.26157 (QuantReg: 13.65261) QuantErr: 13.65261 batch_time=0.34969 
Train Epoch: 46 [246/1000 7872/32000 (25%)] Loss: 0.26422 (QuantReg: 13.59441) QuantErr: 13.59441 batch_time=0.43673 
Train Epoch: 46 [251/1000 8032/32000 (25%)] Loss: 0.13869 (QuantReg: 13.35992) QuantErr: 13.35992 batch_time=0.40924 
Train Epoch: 46 [256/1000 8192/32000 (26%)] Loss: 0.08818 (QuantReg: 13.59539) QuantErr: 13.59539 batch_time=0.36823 
Train Epoch: 46 [261/1000 8352/32000 (26%)] Loss: 0.19853 (QuantReg: 13.21787) QuantErr: 13.21787 batch_time=0.41721 
Train Epoch: 46 [266/1000 8512/32000 (27%)] Loss: 0.24272 (QuantReg: 13.80276) QuantErr: 13.80276 batch_time=0.36451 
Train Epoch: 46 [271/1000 8672/32000 (27%)] Loss: 0.40026 (QuantReg: 13.22425) QuantErr: 13.22425 batch_time=0.37694 
Train Epoch: 46 [276/1000 8832/32000 (28%)] Loss: 0.08311 (QuantReg: 13.01625) QuantErr: 13.01625 batch_time=0.40867 
Train Epoch: 46 [281/1000 8992/32000 (28%)] Loss: 0.44112 (QuantReg: 13.32000) QuantErr: 13.32000 batch_time=0.44172 
Train Epoch: 46 [286/1000 9152/32000 (29%)] Loss: 0.20578 (QuantReg: 13.10924) QuantErr: 13.10924 batch_time=0.57917 
Train Epoch: 46 [291/1000 9312/32000 (29%)] Loss: 0.44808 (QuantReg: 13.17856) QuantErr: 13.17856 batch_time=0.38666 
Train Epoch: 46 [296/1000 9472/32000 (30%)] Loss: 0.09964 (QuantReg: 13.29644) QuantErr: 13.29644 batch_time=0.40002 
Train Epoch: 46 [301/1000 9632/32000 (30%)] Loss: 0.13920 (QuantReg: 13.70798) QuantErr: 13.70798 batch_time=0.43830 
Train Epoch: 46 [306/1000 9792/32000 (31%)] Loss: 0.24027 (QuantReg: 13.70170) QuantErr: 13.70170 batch_time=0.35935 
Train Epoch: 46 [311/1000 9952/32000 (31%)] Loss: 0.36507 (QuantReg: 12.98512) QuantErr: 12.98512 batch_time=0.34753 
Train Epoch: 46 [316/1000 10112/32000 (32%)] Loss: 0.27963 (QuantReg: 13.34786) QuantErr: 13.34786 batch_time=0.38089 
Train Epoch: 46 [321/1000 10272/32000 (32%)] Loss: 0.22196 (QuantReg: 13.80820) QuantErr: 13.80820 batch_time=0.38242 
Train Epoch: 46 [326/1000 10432/32000 (33%)] Loss: 0.32231 (QuantReg: 13.60485) QuantErr: 13.60485 batch_time=0.47053 
Train Epoch: 46 [331/1000 10592/32000 (33%)] Loss: 0.27959 (QuantReg: 13.21388) QuantErr: 13.21388 batch_time=0.40329 
Train Epoch: 46 [336/1000 10752/32000 (34%)] Loss: 0.26427 (QuantReg: 13.73162) QuantErr: 13.73162 batch_time=0.37571 
Train Epoch: 46 [341/1000 10912/32000 (34%)] Loss: 0.27006 (QuantReg: 13.99721) QuantErr: 13.99721 batch_time=0.35578 
Train Epoch: 46 [346/1000 11072/32000 (35%)] Loss: 0.13290 (QuantReg: 12.83744) QuantErr: 12.83744 batch_time=0.50256 
Train Epoch: 46 [351/1000 11232/32000 (35%)] Loss: 0.69825 (QuantReg: 13.04471) QuantErr: 13.04471 batch_time=0.35052 
Train Epoch: 46 [356/1000 11392/32000 (36%)] Loss: 1.04826 (QuantReg: 13.23507) QuantErr: 13.23507 batch_time=0.38063 
Train Epoch: 46 [361/1000 11552/32000 (36%)] Loss: 0.46859 (QuantReg: 13.11008) QuantErr: 13.11008 batch_time=0.36265 
Train Epoch: 46 [366/1000 11712/32000 (37%)] Loss: 0.42993 (QuantReg: 13.57760) QuantErr: 13.57760 batch_time=0.37253 
Train Epoch: 46 [371/1000 11872/32000 (37%)] Loss: 0.39825 (QuantReg: 12.94946) QuantErr: 12.94946 batch_time=0.39439 
Train Epoch: 46 [376/1000 12032/32000 (38%)] Loss: 0.23397 (QuantReg: 13.31683) QuantErr: 13.31683 batch_time=0.41231 
Train Epoch: 46 [381/1000 12192/32000 (38%)] Loss: 0.52815 (QuantReg: 13.16284) QuantErr: 13.16284 batch_time=0.35108 
Train Epoch: 46 [386/1000 12352/32000 (39%)] Loss: 0.52498 (QuantReg: 13.29457) QuantErr: 13.29457 batch_time=0.35621 
Train Epoch: 46 [391/1000 12512/32000 (39%)] Loss: 0.43119 (QuantReg: 13.39771) QuantErr: 13.39771 batch_time=0.43242 
Train Epoch: 46 [396/1000 12672/32000 (40%)] Loss: 0.30068 (QuantReg: 13.00054) QuantErr: 13.00054 batch_time=0.41363 
Train Epoch: 46 [401/1000 12832/32000 (40%)] Loss: 0.36708 (QuantReg: 13.41423) QuantErr: 13.41423 batch_time=0.41685 
Train Epoch: 46 [406/1000 12992/32000 (41%)] Loss: 0.62135 (QuantReg: 13.22705) QuantErr: 13.22705 batch_time=0.39577 
Train Epoch: 46 [411/1000 13152/32000 (41%)] Loss: 0.46383 (QuantReg: 12.91255) QuantErr: 12.91255 batch_time=0.35937 
Train Epoch: 46 [416/1000 13312/32000 (42%)] Loss: 0.25681 (QuantReg: 13.05229) QuantErr: 13.05229 batch_time=0.35832 
Train Epoch: 46 [421/1000 13472/32000 (42%)] Loss: 0.25906 (QuantReg: 13.23643) QuantErr: 13.23643 batch_time=0.76222 
Train Epoch: 46 [426/1000 13632/32000 (43%)] Loss: 0.19122 (QuantReg: 12.89110) QuantErr: 12.89110 batch_time=0.55781 
Train Epoch: 46 [431/1000 13792/32000 (43%)] Loss: 0.14593 (QuantReg: 13.20726) QuantErr: 13.20726 batch_time=0.39724 
Train Epoch: 46 [436/1000 13952/32000 (44%)] Loss: 0.30709 (QuantReg: 13.41494) QuantErr: 13.41494 batch_time=0.35674 
Train Epoch: 46 [441/1000 14112/32000 (44%)] Loss: 0.46667 (QuantReg: 13.33662) QuantErr: 13.33662 batch_time=0.53023 
Train Epoch: 46 [446/1000 14272/32000 (45%)] Loss: 0.59723 (QuantReg: 13.04321) QuantErr: 13.04321 batch_time=0.36726 
Train Epoch: 46 [451/1000 14432/32000 (45%)] Loss: 0.32108 (QuantReg: 13.46928) QuantErr: 13.46928 batch_time=0.36704 
Train Epoch: 46 [456/1000 14592/32000 (46%)] Loss: 0.40996 (QuantReg: 12.71727) QuantErr: 12.71727 batch_time=0.47245 
Train Epoch: 46 [461/1000 14752/32000 (46%)] Loss: 0.57750 (QuantReg: 13.07182) QuantErr: 13.07182 batch_time=0.43116 
Train Epoch: 46 [466/1000 14912/32000 (47%)] Loss: 0.12895 (QuantReg: 12.93607) QuantErr: 12.93607 batch_time=0.39022 
Train Epoch: 46 [471/1000 15072/32000 (47%)] Loss: 0.45740 (QuantReg: 13.65901) QuantErr: 13.65901 batch_time=0.38662 
Train Epoch: 46 [476/1000 15232/32000 (48%)] Loss: 0.32351 (QuantReg: 12.86612) QuantErr: 12.86612 batch_time=0.45150 
Train Epoch: 46 [481/1000 15392/32000 (48%)] Loss: 0.44117 (QuantReg: 13.85249) QuantErr: 13.85249 batch_time=0.40256 
Train Epoch: 46 [486/1000 15552/32000 (49%)] Loss: 0.26896 (QuantReg: 13.35446) QuantErr: 13.35446 batch_time=0.38089 
Train Epoch: 46 [491/1000 15712/32000 (49%)] Loss: 0.34716 (QuantReg: 13.62525) QuantErr: 13.62525 batch_time=0.47796 
Train Epoch: 46 [496/1000 15872/32000 (50%)] Loss: 0.50053 (QuantReg: 13.34636) QuantErr: 13.34636 batch_time=0.43685 
Train Epoch: 46 [501/1000 16032/32000 (50%)] Loss: 0.45889 (QuantReg: 13.56030) QuantErr: 13.56030 batch_time=0.37822 
Train Epoch: 46 [506/1000 16192/32000 (51%)] Loss: 0.26033 (QuantReg: 13.24085) QuantErr: 13.24085 batch_time=0.37232 
Train Epoch: 46 [511/1000 16352/32000 (51%)] Loss: 0.19488 (QuantReg: 14.03838) QuantErr: 14.03838 batch_time=0.35914 
Train Epoch: 46 [516/1000 16512/32000 (52%)] Loss: 0.16441 (QuantReg: 12.70663) QuantErr: 12.70663 batch_time=0.40112 
Train Epoch: 46 [521/1000 16672/32000 (52%)] Loss: 0.29170 (QuantReg: 13.33032) QuantErr: 13.33032 batch_time=0.35721 
Train Epoch: 46 [526/1000 16832/32000 (53%)] Loss: 0.48880 (QuantReg: 13.81701) QuantErr: 13.81701 batch_time=0.35888 
Train Epoch: 46 [531/1000 16992/32000 (53%)] Loss: 0.54739 (QuantReg: 13.32987) QuantErr: 13.32987 batch_time=0.36617 
Train Epoch: 46 [536/1000 17152/32000 (54%)] Loss: 0.25984 (QuantReg: 13.29169) QuantErr: 13.29169 batch_time=0.36774 
Train Epoch: 46 [541/1000 17312/32000 (54%)] Loss: 0.33366 (QuantReg: 13.31919) QuantErr: 13.31919 batch_time=0.86006 
Train Epoch: 46 [546/1000 17472/32000 (55%)] Loss: 0.56229 (QuantReg: 13.19462) QuantErr: 13.19462 batch_time=0.42359 
Train Epoch: 46 [551/1000 17632/32000 (55%)] Loss: 0.38139 (QuantReg: 13.14040) QuantErr: 13.14040 batch_time=0.39596 
Train Epoch: 46 [556/1000 17792/32000 (56%)] Loss: 0.36458 (QuantReg: 13.06982) QuantErr: 13.06982 batch_time=0.35390 
Train Epoch: 46 [561/1000 17952/32000 (56%)] Loss: 0.42558 (QuantReg: 12.57820) QuantErr: 12.57820 batch_time=0.41949 
Train Epoch: 46 [566/1000 18112/32000 (57%)] Loss: 0.36008 (QuantReg: 13.17143) QuantErr: 13.17143 batch_time=0.37725 
Train Epoch: 46 [571/1000 18272/32000 (57%)] Loss: 0.46092 (QuantReg: 13.31390) QuantErr: 13.31390 batch_time=0.36581 
Train Epoch: 46 [576/1000 18432/32000 (58%)] Loss: 0.38797 (QuantReg: 13.86978) QuantErr: 13.86978 batch_time=0.38385 
Train Epoch: 46 [581/1000 18592/32000 (58%)] Loss: 0.63307 (QuantReg: 13.55931) QuantErr: 13.55931 batch_time=1.03487 
Train Epoch: 46 [586/1000 18752/32000 (59%)] Loss: 0.45564 (QuantReg: 13.45182) QuantErr: 13.45182 batch_time=0.34530 
Train Epoch: 46 [591/1000 18912/32000 (59%)] Loss: 0.63569 (QuantReg: 13.61942) QuantErr: 13.61942 batch_time=0.47034 
Train Epoch: 46 [596/1000 19072/32000 (60%)] Loss: 0.53154 (QuantReg: 12.82002) QuantErr: 12.82002 batch_time=0.40918 
Train Epoch: 46 [601/1000 19232/32000 (60%)] Loss: 0.20783 (QuantReg: 13.04245) QuantErr: 13.04245 batch_time=0.35427 
Train Epoch: 46 [606/1000 19392/32000 (61%)] Loss: 0.15965 (QuantReg: 13.21523) QuantErr: 13.21523 batch_time=0.43429 
Train Epoch: 46 [611/1000 19552/32000 (61%)] Loss: 0.36871 (QuantReg: 13.80865) QuantErr: 13.80865 batch_time=0.37549 
Train Epoch: 46 [616/1000 19712/32000 (62%)] Loss: 0.10967 (QuantReg: 13.31168) QuantErr: 13.31168 batch_time=0.49041 
Train Epoch: 46 [621/1000 19872/32000 (62%)] Loss: 0.57091 (QuantReg: 13.93773) QuantErr: 13.93773 batch_time=0.42082 
Train Epoch: 46 [626/1000 20032/32000 (63%)] Loss: 0.43959 (QuantReg: 13.33702) QuantErr: 13.33702 batch_time=0.88359 
Train Epoch: 46 [631/1000 20192/32000 (63%)] Loss: 0.32607 (QuantReg: 13.26604) QuantErr: 13.26604 batch_time=0.39427 
Train Epoch: 46 [636/1000 20352/32000 (64%)] Loss: 0.19627 (QuantReg: 13.33774) QuantErr: 13.33774 batch_time=0.35652 
Train Epoch: 46 [641/1000 20512/32000 (64%)] Loss: 0.49067 (QuantReg: 13.53615) QuantErr: 13.53615 batch_time=0.34599 
Train Epoch: 46 [646/1000 20672/32000 (65%)] Loss: 0.24047 (QuantReg: 13.32605) QuantErr: 13.32605 batch_time=0.38825 
Train Epoch: 46 [651/1000 20832/32000 (65%)] Loss: 0.41792 (QuantReg: 12.93680) QuantErr: 12.93680 batch_time=0.49732 
Train Epoch: 46 [656/1000 20992/32000 (66%)] Loss: 0.40692 (QuantReg: 13.78965) QuantErr: 13.78965 batch_time=0.37554 
Train Epoch: 46 [661/1000 21152/32000 (66%)] Loss: 0.25919 (QuantReg: 13.39063) QuantErr: 13.39063 batch_time=0.57081 
Train Epoch: 46 [666/1000 21312/32000 (67%)] Loss: 0.39139 (QuantReg: 13.26180) QuantErr: 13.26180 batch_time=0.44155 
Train Epoch: 46 [671/1000 21472/32000 (67%)] Loss: 0.15988 (QuantReg: 13.36253) QuantErr: 13.36253 batch_time=0.59208 
Train Epoch: 46 [676/1000 21632/32000 (68%)] Loss: 0.24025 (QuantReg: 13.22098) QuantErr: 13.22098 batch_time=0.40505 
Train Epoch: 46 [681/1000 21792/32000 (68%)] Loss: 0.39975 (QuantReg: 13.17123) QuantErr: 13.17123 batch_time=0.47115 
Train Epoch: 46 [686/1000 21952/32000 (69%)] Loss: 0.31907 (QuantReg: 13.50144) QuantErr: 13.50144 batch_time=0.36909 
Train Epoch: 46 [691/1000 22112/32000 (69%)] Loss: 0.56931 (QuantReg: 13.48996) QuantErr: 13.48996 batch_time=0.41972 
Train Epoch: 46 [696/1000 22272/32000 (70%)] Loss: 0.23556 (QuantReg: 13.19783) QuantErr: 13.19783 batch_time=0.38526 
Train Epoch: 46 [701/1000 22432/32000 (70%)] Loss: 0.25209 (QuantReg: 13.22774) QuantErr: 13.22774 batch_time=0.52893 
Train Epoch: 46 [706/1000 22592/32000 (71%)] Loss: 0.32330 (QuantReg: 13.49012) QuantErr: 13.49012 batch_time=0.77465 
Train Epoch: 46 [711/1000 22752/32000 (71%)] Loss: 0.27177 (QuantReg: 13.25464) QuantErr: 13.25464 batch_time=0.35135 
Train Epoch: 46 [716/1000 22912/32000 (72%)] Loss: 0.32184 (QuantReg: 13.26766) QuantErr: 13.26766 batch_time=0.47221 
Train Epoch: 46 [721/1000 23072/32000 (72%)] Loss: 0.37358 (QuantReg: 13.48976) QuantErr: 13.48976 batch_time=0.42447 
Train Epoch: 46 [726/1000 23232/32000 (73%)] Loss: 0.12904 (QuantReg: 13.81463) QuantErr: 13.81463 batch_time=0.40234 
Train Epoch: 46 [731/1000 23392/32000 (73%)] Loss: 0.23244 (QuantReg: 13.76923) QuantErr: 13.76923 batch_time=0.51192 
Train Epoch: 46 [736/1000 23552/32000 (74%)] Loss: 0.44784 (QuantReg: 14.12389) QuantErr: 14.12389 batch_time=0.36520 
Train Epoch: 46 [741/1000 23712/32000 (74%)] Loss: 0.16887 (QuantReg: 13.07227) QuantErr: 13.07227 batch_time=0.38087 
Train Epoch: 46 [746/1000 23872/32000 (75%)] Loss: 0.12166 (QuantReg: 13.47923) QuantErr: 13.47923 batch_time=0.38385 
Train Epoch: 46 [751/1000 24032/32000 (75%)] Loss: 0.19242 (QuantReg: 13.02921) QuantErr: 13.02921 batch_time=0.35899 
Train Epoch: 46 [756/1000 24192/32000 (76%)] Loss: 0.10052 (QuantReg: 13.59012) QuantErr: 13.59012 batch_time=0.38952 
Train Epoch: 46 [761/1000 24352/32000 (76%)] Loss: 0.18380 (QuantReg: 13.62529) QuantErr: 13.62529 batch_time=0.35609 
Train Epoch: 46 [766/1000 24512/32000 (77%)] Loss: 0.30528 (QuantReg: 13.14284) QuantErr: 13.14284 batch_time=0.37978 
Train Epoch: 46 [771/1000 24672/32000 (77%)] Loss: 0.14081 (QuantReg: 13.42317) QuantErr: 13.42317 batch_time=0.41143 
Train Epoch: 46 [776/1000 24832/32000 (78%)] Loss: 0.35653 (QuantReg: 13.18204) QuantErr: 13.18204 batch_time=0.38475 
Train Epoch: 46 [781/1000 24992/32000 (78%)] Loss: 0.28001 (QuantReg: 12.99623) QuantErr: 12.99623 batch_time=0.48446 
Train Epoch: 46 [786/1000 25152/32000 (79%)] Loss: 0.79686 (QuantReg: 13.49860) QuantErr: 13.49860 batch_time=0.36374 
Train Epoch: 46 [791/1000 25312/32000 (79%)] Loss: 0.13486 (QuantReg: 13.49344) QuantErr: 13.49344 batch_time=0.37423 
Train Epoch: 46 [796/1000 25472/32000 (80%)] Loss: 0.23964 (QuantReg: 13.74998) QuantErr: 13.74998 batch_time=0.36188 
Train Epoch: 46 [801/1000 25632/32000 (80%)] Loss: 0.19350 (QuantReg: 13.40207) QuantErr: 13.40207 batch_time=0.38257 
Train Epoch: 46 [806/1000 25792/32000 (81%)] Loss: 0.26776 (QuantReg: 13.54545) QuantErr: 13.54545 batch_time=0.38087 
Train Epoch: 46 [811/1000 25952/32000 (81%)] Loss: 0.21225 (QuantReg: 13.16558) QuantErr: 13.16558 batch_time=0.35869 
Train Epoch: 46 [816/1000 26112/32000 (82%)] Loss: 0.40206 (QuantReg: 13.05704) QuantErr: 13.05704 batch_time=0.38709 
Train Epoch: 46 [821/1000 26272/32000 (82%)] Loss: 0.20152 (QuantReg: 12.88810) QuantErr: 12.88810 batch_time=0.60355 
Train Epoch: 46 [826/1000 26432/32000 (83%)] Loss: 0.15054 (QuantReg: 13.68575) QuantErr: 13.68575 batch_time=0.35667 
Train Epoch: 46 [831/1000 26592/32000 (83%)] Loss: 0.24486 (QuantReg: 13.35887) QuantErr: 13.35887 batch_time=0.51335 
Train Epoch: 46 [836/1000 26752/32000 (84%)] Loss: 0.21159 (QuantReg: 13.76944) QuantErr: 13.76944 batch_time=0.35384 
Train Epoch: 46 [841/1000 26912/32000 (84%)] Loss: 0.30564 (QuantReg: 13.09383) QuantErr: 13.09383 batch_time=0.36495 
Train Epoch: 46 [846/1000 27072/32000 (85%)] Loss: 0.62481 (QuantReg: 13.08440) QuantErr: 13.08440 batch_time=0.48288 
Train Epoch: 46 [851/1000 27232/32000 (85%)] Loss: 0.22459 (QuantReg: 12.94703) QuantErr: 12.94703 batch_time=0.38680 
Train Epoch: 46 [856/1000 27392/32000 (86%)] Loss: 0.28784 (QuantReg: 13.54690) QuantErr: 13.54690 batch_time=0.34585 
Train Epoch: 46 [861/1000 27552/32000 (86%)] Loss: 0.32226 (QuantReg: 12.80667) QuantErr: 12.80667 batch_time=0.35700 
Train Epoch: 46 [866/1000 27712/32000 (87%)] Loss: 0.36226 (QuantReg: 13.07567) QuantErr: 13.07567 batch_time=0.37144 
Train Epoch: 46 [871/1000 27872/32000 (87%)] Loss: 0.44764 (QuantReg: 13.21702) QuantErr: 13.21702 batch_time=0.59394 
Train Epoch: 46 [876/1000 28032/32000 (88%)] Loss: 0.33741 (QuantReg: 12.84592) QuantErr: 12.84592 batch_time=0.38616 
Train Epoch: 46 [881/1000 28192/32000 (88%)] Loss: 0.38334 (QuantReg: 13.78391) QuantErr: 13.78391 batch_time=0.37190 
Train Epoch: 46 [886/1000 28352/32000 (89%)] Loss: 0.27395 (QuantReg: 13.33317) QuantErr: 13.33317 batch_time=0.35760 
Train Epoch: 46 [891/1000 28512/32000 (89%)] Loss: 0.54352 (QuantReg: 13.91564) QuantErr: 13.91564 batch_time=0.67664 
Train Epoch: 46 [896/1000 28672/32000 (90%)] Loss: 0.27903 (QuantReg: 13.90969) QuantErr: 13.90969 batch_time=0.42799 
Train Epoch: 46 [901/1000 28832/32000 (90%)] Loss: 0.19570 (QuantReg: 13.45975) QuantErr: 13.45975 batch_time=0.48901 
Train Epoch: 46 [906/1000 28992/32000 (91%)] Loss: 0.21919 (QuantReg: 12.71402) QuantErr: 12.71402 batch_time=0.38477 
Train Epoch: 46 [911/1000 29152/32000 (91%)] Loss: 0.13619 (QuantReg: 13.57952) QuantErr: 13.57952 batch_time=0.37636 
Train Epoch: 46 [916/1000 29312/32000 (92%)] Loss: 0.27648 (QuantReg: 12.97338) QuantErr: 12.97338 batch_time=0.52222 
Train Epoch: 46 [921/1000 29472/32000 (92%)] Loss: 0.21261 (QuantReg: 13.58090) QuantErr: 13.58090 batch_time=0.37264 
Train Epoch: 46 [926/1000 29632/32000 (93%)] Loss: 0.39465 (QuantReg: 12.81545) QuantErr: 12.81545 batch_time=0.36620 
Train Epoch: 46 [931/1000 29792/32000 (93%)] Loss: 0.34268 (QuantReg: 13.23997) QuantErr: 13.23997 batch_time=0.42489 
Train Epoch: 46 [936/1000 29952/32000 (94%)] Loss: 0.27980 (QuantReg: 13.69158) QuantErr: 13.69158 batch_time=0.58805 
Train Epoch: 46 [941/1000 30112/32000 (94%)] Loss: 0.47037 (QuantReg: 13.57238) QuantErr: 13.57238 batch_time=0.36087 
Train Epoch: 46 [946/1000 30272/32000 (95%)] Loss: 0.25165 (QuantReg: 13.87163) QuantErr: 13.87163 batch_time=1.75244 
Train Epoch: 46 [951/1000 30432/32000 (95%)] Loss: 0.28060 (QuantReg: 13.65913) QuantErr: 13.65913 batch_time=0.60818 
Train Epoch: 46 [956/1000 30592/32000 (96%)] Loss: 0.29294 (QuantReg: 13.47439) QuantErr: 13.47439 batch_time=0.36524 
Train Epoch: 46 [961/1000 30752/32000 (96%)] Loss: 0.52365 (QuantReg: 12.97513) QuantErr: 12.97513 batch_time=0.35134 
Train Epoch: 46 [966/1000 30912/32000 (97%)] Loss: 0.25399 (QuantReg: 13.51407) QuantErr: 13.51407 batch_time=0.40117 
Train Epoch: 46 [971/1000 31072/32000 (97%)] Loss: 0.21788 (QuantReg: 13.07614) QuantErr: 13.07614 batch_time=0.42203 
Train Epoch: 46 [976/1000 31232/32000 (98%)] Loss: 0.38894 (QuantReg: 13.46886) QuantErr: 13.46886 batch_time=0.35922 
Train Epoch: 46 [981/1000 31392/32000 (98%)] Loss: 0.79506 (QuantReg: 13.29996) QuantErr: 13.29996 batch_time=0.56587 
Train Epoch: 46 [986/1000 31552/32000 (99%)] Loss: 0.34313 (QuantReg: 12.97306) QuantErr: 12.97306 batch_time=0.38848 
Train Epoch: 46 [991/1000 31712/32000 (99%)] Loss: 0.15744 (QuantReg: 13.15139) QuantErr: 13.15139 batch_time=0.37274 
Train Epoch: 46 [996/1000 31872/32000 (100%)] Loss: 0.40449 (QuantReg: 13.72121) QuantErr: 13.72121 batch_time=0.36139 
Train Epoch: 46 codebook_update_time=1.77927
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch46.pth ...
Done in 6.096s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch46.pth ...
Done in 10.816s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 0.31334931584447623
 quant_reg      : 13.267188925743103
 quant_err      : 13.267188925743103
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 46000
 MSRVTT_miech_test/t2v_metrics/R1: 21.5
 MSRVTT_miech_test/t2v_metrics/R5: 51.7
 MSRVTT_miech_test/t2v_metrics/R10: 64.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.3
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 31.894
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.54284538121151
 MSRVTT_miech_test/v2t_metrics/R1: 20.5
 MSRVTT_miech_test/v2t_metrics/R5: 53.2
 MSRVTT_miech_test/v2t_metrics/R10: 64.5
 MSRVTT_miech_test/v2t_metrics/R50: 88.9
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.095
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.280194605025734
 mnt_best       : 41.54284538121151
 not_improved_count: 0
Train Epoch: 47 [1/1000 32/32000 (0%)] Loss: 0.34288 (QuantReg: 12.98322) QuantErr: 12.98322 batch_time=27.98638 
Train Epoch: 47 [6/1000 192/32000 (1%)] Loss: 0.37152 (QuantReg: 13.06680) QuantErr: 13.06680 batch_time=0.34553 
Train Epoch: 47 [11/1000 352/32000 (1%)] Loss: 0.26607 (QuantReg: 12.23289) QuantErr: 12.23289 batch_time=0.57464 
Train Epoch: 47 [16/1000 512/32000 (2%)] Loss: 0.45542 (QuantReg: 13.37715) QuantErr: 13.37715 batch_time=1.07195 
Train Epoch: 47 [21/1000 672/32000 (2%)] Loss: 0.70610 (QuantReg: 12.93676) QuantErr: 12.93676 batch_time=0.38714 
Train Epoch: 47 [26/1000 832/32000 (3%)] Loss: 0.16839 (QuantReg: 13.71731) QuantErr: 13.71731 batch_time=0.68210 
Train Epoch: 47 [31/1000 992/32000 (3%)] Loss: 0.41586 (QuantReg: 12.81855) QuantErr: 12.81855 batch_time=0.44046 
Train Epoch: 47 [36/1000 1152/32000 (4%)] Loss: 0.14467 (QuantReg: 13.51270) QuantErr: 13.51270 batch_time=0.37002 
Train Epoch: 47 [41/1000 1312/32000 (4%)] Loss: 0.05990 (QuantReg: 13.57970) QuantErr: 13.57970 batch_time=0.36285 
Train Epoch: 47 [46/1000 1472/32000 (5%)] Loss: 0.28072 (QuantReg: 13.31240) QuantErr: 13.31240 batch_time=0.36687 
Train Epoch: 47 [51/1000 1632/32000 (5%)] Loss: 0.30785 (QuantReg: 13.16053) QuantErr: 13.16053 batch_time=0.36690 
Train Epoch: 47 [56/1000 1792/32000 (6%)] Loss: 0.28396 (QuantReg: 13.22786) QuantErr: 13.22786 batch_time=0.40117 
Train Epoch: 47 [61/1000 1952/32000 (6%)] Loss: 0.49022 (QuantReg: 12.85587) QuantErr: 12.85587 batch_time=0.48524 
Train Epoch: 47 [66/1000 2112/32000 (7%)] Loss: 0.06063 (QuantReg: 13.53404) QuantErr: 13.53404 batch_time=0.64457 
Train Epoch: 47 [71/1000 2272/32000 (7%)] Loss: 0.34048 (QuantReg: 13.55807) QuantErr: 13.55807 batch_time=0.38605 
Train Epoch: 47 [76/1000 2432/32000 (8%)] Loss: 0.18198 (QuantReg: 13.51756) QuantErr: 13.51756 batch_time=0.37524 
Train Epoch: 47 [81/1000 2592/32000 (8%)] Loss: 0.74143 (QuantReg: 12.62446) QuantErr: 12.62446 batch_time=0.52378 
Train Epoch: 47 [86/1000 2752/32000 (9%)] Loss: 0.33639 (QuantReg: 13.05635) QuantErr: 13.05635 batch_time=0.38138 
Train Epoch: 47 [91/1000 2912/32000 (9%)] Loss: 0.21030 (QuantReg: 13.04538) QuantErr: 13.04538 batch_time=0.37313 
Train Epoch: 47 [96/1000 3072/32000 (10%)] Loss: 0.22654 (QuantReg: 13.36083) QuantErr: 13.36083 batch_time=0.40728 
Train Epoch: 47 [101/1000 3232/32000 (10%)] Loss: 0.10411 (QuantReg: 13.19275) QuantErr: 13.19275 batch_time=0.37212 
Train Epoch: 47 [106/1000 3392/32000 (11%)] Loss: 0.32798 (QuantReg: 13.29704) QuantErr: 13.29704 batch_time=0.35437 
Train Epoch: 47 [111/1000 3552/32000 (11%)] Loss: 0.30060 (QuantReg: 13.25895) QuantErr: 13.25895 batch_time=0.34754 
Train Epoch: 47 [116/1000 3712/32000 (12%)] Loss: 0.19396 (QuantReg: 13.82986) QuantErr: 13.82986 batch_time=0.37563 
Train Epoch: 47 [121/1000 3872/32000 (12%)] Loss: 0.28544 (QuantReg: 13.44647) QuantErr: 13.44647 batch_time=0.40449 
Train Epoch: 47 [126/1000 4032/32000 (13%)] Loss: 0.31782 (QuantReg: 13.53109) QuantErr: 13.53109 batch_time=0.40814 
Train Epoch: 47 [131/1000 4192/32000 (13%)] Loss: 0.16270 (QuantReg: 13.84969) QuantErr: 13.84969 batch_time=0.34898 
Train Epoch: 47 [136/1000 4352/32000 (14%)] Loss: 0.33157 (QuantReg: 13.16560) QuantErr: 13.16560 batch_time=0.34058 
Train Epoch: 47 [141/1000 4512/32000 (14%)] Loss: 0.42066 (QuantReg: 13.12434) QuantErr: 13.12434 batch_time=0.39098 
Train Epoch: 47 [146/1000 4672/32000 (15%)] Loss: 0.27506 (QuantReg: 13.18441) QuantErr: 13.18441 batch_time=0.36426 
Train Epoch: 47 [151/1000 4832/32000 (15%)] Loss: 0.42485 (QuantReg: 13.75397) QuantErr: 13.75397 batch_time=0.42530 
Train Epoch: 47 [156/1000 4992/32000 (16%)] Loss: 0.29745 (QuantReg: 13.25551) QuantErr: 13.25551 batch_time=0.39548 
Train Epoch: 47 [161/1000 5152/32000 (16%)] Loss: 0.23460 (QuantReg: 13.66756) QuantErr: 13.66756 batch_time=0.64785 
Train Epoch: 47 [166/1000 5312/32000 (17%)] Loss: 0.22632 (QuantReg: 12.98491) QuantErr: 12.98491 batch_time=0.47704 
Train Epoch: 47 [171/1000 5472/32000 (17%)] Loss: 0.12877 (QuantReg: 13.60857) QuantErr: 13.60857 batch_time=0.46571 
Train Epoch: 47 [176/1000 5632/32000 (18%)] Loss: 0.29198 (QuantReg: 13.29577) QuantErr: 13.29577 batch_time=0.47893 
Train Epoch: 47 [181/1000 5792/32000 (18%)] Loss: 0.35249 (QuantReg: 12.47672) QuantErr: 12.47672 batch_time=0.41517 
Train Epoch: 47 [186/1000 5952/32000 (19%)] Loss: 0.17246 (QuantReg: 13.02483) QuantErr: 13.02483 batch_time=0.37619 
Train Epoch: 47 [191/1000 6112/32000 (19%)] Loss: 0.27971 (QuantReg: 13.40411) QuantErr: 13.40411 batch_time=0.38837 
Train Epoch: 47 [196/1000 6272/32000 (20%)] Loss: 0.26527 (QuantReg: 13.09191) QuantErr: 13.09191 batch_time=0.43173 
Train Epoch: 47 [201/1000 6432/32000 (20%)] Loss: 0.14354 (QuantReg: 13.18249) QuantErr: 13.18249 batch_time=0.40845 
Train Epoch: 47 [206/1000 6592/32000 (21%)] Loss: 0.37361 (QuantReg: 13.39159) QuantErr: 13.39159 batch_time=0.38347 
Train Epoch: 47 [211/1000 6752/32000 (21%)] Loss: 0.23898 (QuantReg: 13.03672) QuantErr: 13.03672 batch_time=0.40367 
Train Epoch: 47 [216/1000 6912/32000 (22%)] Loss: 0.11119 (QuantReg: 12.98466) QuantErr: 12.98466 batch_time=0.53655 
Train Epoch: 47 [221/1000 7072/32000 (22%)] Loss: 0.65960 (QuantReg: 12.94479) QuantErr: 12.94479 batch_time=0.53218 
Train Epoch: 47 [226/1000 7232/32000 (23%)] Loss: 0.42452 (QuantReg: 13.08224) QuantErr: 13.08224 batch_time=2.26392 
Train Epoch: 47 [231/1000 7392/32000 (23%)] Loss: 0.49670 (QuantReg: 13.30536) QuantErr: 13.30536 batch_time=0.40572 
Train Epoch: 47 [236/1000 7552/32000 (24%)] Loss: 0.19945 (QuantReg: 13.57362) QuantErr: 13.57362 batch_time=0.40337 
Train Epoch: 47 [241/1000 7712/32000 (24%)] Loss: 0.32266 (QuantReg: 13.51674) QuantErr: 13.51674 batch_time=0.36412 
Train Epoch: 47 [246/1000 7872/32000 (25%)] Loss: 0.34404 (QuantReg: 13.03073) QuantErr: 13.03073 batch_time=0.35401 
Train Epoch: 47 [251/1000 8032/32000 (25%)] Loss: 0.44921 (QuantReg: 13.18637) QuantErr: 13.18637 batch_time=0.38288 
Train Epoch: 47 [256/1000 8192/32000 (26%)] Loss: 0.09576 (QuantReg: 13.82949) QuantErr: 13.82949 batch_time=0.35825 
Train Epoch: 47 [261/1000 8352/32000 (26%)] Loss: 0.33690 (QuantReg: 13.52901) QuantErr: 13.52901 batch_time=0.43710 
Train Epoch: 47 [266/1000 8512/32000 (27%)] Loss: 0.40601 (QuantReg: 13.51194) QuantErr: 13.51194 batch_time=0.36310 
Train Epoch: 47 [271/1000 8672/32000 (27%)] Loss: 0.30429 (QuantReg: 13.36017) QuantErr: 13.36017 batch_time=0.42431 
Train Epoch: 47 [276/1000 8832/32000 (28%)] Loss: 0.18858 (QuantReg: 12.99784) QuantErr: 12.99784 batch_time=0.45457 
Train Epoch: 47 [281/1000 8992/32000 (28%)] Loss: 0.20252 (QuantReg: 13.18316) QuantErr: 13.18316 batch_time=0.36198 
Train Epoch: 47 [286/1000 9152/32000 (29%)] Loss: 0.23556 (QuantReg: 13.59891) QuantErr: 13.59891 batch_time=0.35606 
Train Epoch: 47 [291/1000 9312/32000 (29%)] Loss: 0.14510 (QuantReg: 13.27499) QuantErr: 13.27499 batch_time=0.34723 
Train Epoch: 47 [296/1000 9472/32000 (30%)] Loss: 0.34310 (QuantReg: 13.08472) QuantErr: 13.08472 batch_time=0.35284 
Train Epoch: 47 [301/1000 9632/32000 (30%)] Loss: 0.09556 (QuantReg: 13.55200) QuantErr: 13.55200 batch_time=0.38941 
Train Epoch: 47 [306/1000 9792/32000 (31%)] Loss: 0.44976 (QuantReg: 13.32307) QuantErr: 13.32307 batch_time=0.39378 
Train Epoch: 47 [311/1000 9952/32000 (31%)] Loss: 0.19971 (QuantReg: 13.29782) QuantErr: 13.29782 batch_time=0.43448 
Train Epoch: 47 [316/1000 10112/32000 (32%)] Loss: 0.41501 (QuantReg: 13.14019) QuantErr: 13.14019 batch_time=0.43795 
Train Epoch: 47 [321/1000 10272/32000 (32%)] Loss: 0.09844 (QuantReg: 13.27589) QuantErr: 13.27589 batch_time=0.39454 
Train Epoch: 47 [326/1000 10432/32000 (33%)] Loss: 0.23022 (QuantReg: 13.24859) QuantErr: 13.24859 batch_time=0.35636 
Train Epoch: 47 [331/1000 10592/32000 (33%)] Loss: 0.22888 (QuantReg: 13.43635) QuantErr: 13.43635 batch_time=0.35366 
Train Epoch: 47 [336/1000 10752/32000 (34%)] Loss: 0.21381 (QuantReg: 13.03573) QuantErr: 13.03573 batch_time=0.56293 
Train Epoch: 47 [341/1000 10912/32000 (34%)] Loss: 0.24394 (QuantReg: 13.05429) QuantErr: 13.05429 batch_time=0.38800 
Train Epoch: 47 [346/1000 11072/32000 (35%)] Loss: 0.44890 (QuantReg: 13.59181) QuantErr: 13.59181 batch_time=0.55265 
Train Epoch: 47 [351/1000 11232/32000 (35%)] Loss: 0.16928 (QuantReg: 13.70636) QuantErr: 13.70636 batch_time=0.41961 
Train Epoch: 47 [356/1000 11392/32000 (36%)] Loss: 0.10239 (QuantReg: 13.45811) QuantErr: 13.45811 batch_time=0.36422 
Train Epoch: 47 [361/1000 11552/32000 (36%)] Loss: 0.30248 (QuantReg: 13.20466) QuantErr: 13.20466 batch_time=0.36831 
Train Epoch: 47 [366/1000 11712/32000 (37%)] Loss: 0.45330 (QuantReg: 13.60451) QuantErr: 13.60451 batch_time=0.39522 
Train Epoch: 47 [371/1000 11872/32000 (37%)] Loss: 0.26801 (QuantReg: 13.66212) QuantErr: 13.66212 batch_time=0.38655 
Train Epoch: 47 [376/1000 12032/32000 (38%)] Loss: 0.26611 (QuantReg: 13.68423) QuantErr: 13.68423 batch_time=0.35534 
Train Epoch: 47 [381/1000 12192/32000 (38%)] Loss: 0.91597 (QuantReg: 13.46904) QuantErr: 13.46904 batch_time=0.38766 
Train Epoch: 47 [386/1000 12352/32000 (39%)] Loss: 0.12343 (QuantReg: 13.49602) QuantErr: 13.49602 batch_time=0.40466 
Train Epoch: 47 [391/1000 12512/32000 (39%)] Loss: 0.52065 (QuantReg: 13.24952) QuantErr: 13.24952 batch_time=0.52498 
Train Epoch: 47 [396/1000 12672/32000 (40%)] Loss: 0.12553 (QuantReg: 13.55299) QuantErr: 13.55299 batch_time=0.45638 
Train Epoch: 47 [401/1000 12832/32000 (40%)] Loss: 0.24793 (QuantReg: 13.14061) QuantErr: 13.14061 batch_time=0.42205 
Train Epoch: 47 [406/1000 12992/32000 (41%)] Loss: 0.33802 (QuantReg: 13.53723) QuantErr: 13.53723 batch_time=0.37403 
Train Epoch: 47 [411/1000 13152/32000 (41%)] Loss: 0.23031 (QuantReg: 12.94085) QuantErr: 12.94085 batch_time=0.36314 
Train Epoch: 47 [416/1000 13312/32000 (42%)] Loss: 0.23982 (QuantReg: 13.41517) QuantErr: 13.41517 batch_time=0.39556 
Train Epoch: 47 [421/1000 13472/32000 (42%)] Loss: 0.15168 (QuantReg: 13.20539) QuantErr: 13.20539 batch_time=0.40095 
Train Epoch: 47 [426/1000 13632/32000 (43%)] Loss: 0.35393 (QuantReg: 13.57368) QuantErr: 13.57368 batch_time=0.38570 
Train Epoch: 47 [431/1000 13792/32000 (43%)] Loss: 0.12297 (QuantReg: 13.74273) QuantErr: 13.74273 batch_time=0.39068 
Train Epoch: 47 [436/1000 13952/32000 (44%)] Loss: 0.32013 (QuantReg: 13.37771) QuantErr: 13.37771 batch_time=0.40783 
Train Epoch: 47 [441/1000 14112/32000 (44%)] Loss: 0.44223 (QuantReg: 13.72924) QuantErr: 13.72924 batch_time=0.49380 
Train Epoch: 47 [446/1000 14272/32000 (45%)] Loss: 0.32005 (QuantReg: 13.30222) QuantErr: 13.30222 batch_time=0.41369 
Train Epoch: 47 [451/1000 14432/32000 (45%)] Loss: 0.14549 (QuantReg: 13.65630) QuantErr: 13.65630 batch_time=0.42443 
Train Epoch: 47 [456/1000 14592/32000 (46%)] Loss: 0.42597 (QuantReg: 12.98838) QuantErr: 12.98838 batch_time=0.37771 
Train Epoch: 47 [461/1000 14752/32000 (46%)] Loss: 0.15748 (QuantReg: 13.26410) QuantErr: 13.26410 batch_time=0.34686 
Train Epoch: 47 [466/1000 14912/32000 (47%)] Loss: 0.51815 (QuantReg: 13.46017) QuantErr: 13.46017 batch_time=0.34772 
Train Epoch: 47 [471/1000 15072/32000 (47%)] Loss: 0.35842 (QuantReg: 13.25132) QuantErr: 13.25132 batch_time=0.37328 
Train Epoch: 47 [476/1000 15232/32000 (48%)] Loss: 0.15101 (QuantReg: 13.50400) QuantErr: 13.50400 batch_time=0.41113 
Train Epoch: 47 [481/1000 15392/32000 (48%)] Loss: 0.32885 (QuantReg: 13.63751) QuantErr: 13.63751 batch_time=0.34334 
Train Epoch: 47 [486/1000 15552/32000 (49%)] Loss: 0.54215 (QuantReg: 13.79816) QuantErr: 13.79816 batch_time=0.36706 
Train Epoch: 47 [491/1000 15712/32000 (49%)] Loss: 0.14100 (QuantReg: 12.61363) QuantErr: 12.61363 batch_time=0.39489 
Train Epoch: 47 [496/1000 15872/32000 (50%)] Loss: 0.13030 (QuantReg: 12.65664) QuantErr: 12.65664 batch_time=0.35073 
Train Epoch: 47 [501/1000 16032/32000 (50%)] Loss: 0.35177 (QuantReg: 13.38905) QuantErr: 13.38905 batch_time=0.40474 
Train Epoch: 47 [506/1000 16192/32000 (51%)] Loss: 0.29695 (QuantReg: 13.02926) QuantErr: 13.02926 batch_time=0.36295 
Train Epoch: 47 [511/1000 16352/32000 (51%)] Loss: 0.24550 (QuantReg: 13.28329) QuantErr: 13.28329 batch_time=0.36662 
Train Epoch: 47 [516/1000 16512/32000 (52%)] Loss: 0.24241 (QuantReg: 13.18829) QuantErr: 13.18829 batch_time=0.35505 
Train Epoch: 47 [521/1000 16672/32000 (52%)] Loss: 0.32463 (QuantReg: 13.25878) QuantErr: 13.25878 batch_time=0.35930 
Train Epoch: 47 [526/1000 16832/32000 (53%)] Loss: 0.53929 (QuantReg: 13.08248) QuantErr: 13.08248 batch_time=0.37272 
Train Epoch: 47 [531/1000 16992/32000 (53%)] Loss: 0.38949 (QuantReg: 13.35771) QuantErr: 13.35771 batch_time=0.35499 
Train Epoch: 47 [536/1000 17152/32000 (54%)] Loss: 0.55176 (QuantReg: 13.53231) QuantErr: 13.53231 batch_time=0.34947 
Train Epoch: 47 [541/1000 17312/32000 (54%)] Loss: 0.38585 (QuantReg: 13.40792) QuantErr: 13.40792 batch_time=0.39831 
Train Epoch: 47 [546/1000 17472/32000 (55%)] Loss: 0.19372 (QuantReg: 13.43590) QuantErr: 13.43590 batch_time=1.00680 
Train Epoch: 47 [551/1000 17632/32000 (55%)] Loss: 0.33058 (QuantReg: 13.41425) QuantErr: 13.41425 batch_time=0.46167 
Train Epoch: 47 [556/1000 17792/32000 (56%)] Loss: 0.61306 (QuantReg: 12.85690) QuantErr: 12.85690 batch_time=0.35880 
Train Epoch: 47 [561/1000 17952/32000 (56%)] Loss: 0.30692 (QuantReg: 13.68604) QuantErr: 13.68604 batch_time=0.39020 
Train Epoch: 47 [566/1000 18112/32000 (57%)] Loss: 0.20040 (QuantReg: 13.57083) QuantErr: 13.57083 batch_time=0.36236 
Train Epoch: 47 [571/1000 18272/32000 (57%)] Loss: 0.13479 (QuantReg: 13.83779) QuantErr: 13.83779 batch_time=0.38247 
Train Epoch: 47 [576/1000 18432/32000 (58%)] Loss: 0.61342 (QuantReg: 13.66105) QuantErr: 13.66105 batch_time=0.37044 
Train Epoch: 47 [581/1000 18592/32000 (58%)] Loss: 0.30338 (QuantReg: 13.58371) QuantErr: 13.58371 batch_time=0.35472 
Train Epoch: 47 [586/1000 18752/32000 (59%)] Loss: 0.46033 (QuantReg: 11.96272) QuantErr: 11.96272 batch_time=0.36010 
Train Epoch: 47 [591/1000 18912/32000 (59%)] Loss: 0.49132 (QuantReg: 13.32132) QuantErr: 13.32132 batch_time=0.35551 
Train Epoch: 47 [596/1000 19072/32000 (60%)] Loss: 0.09845 (QuantReg: 13.43760) QuantErr: 13.43760 batch_time=0.35429 
Train Epoch: 47 [601/1000 19232/32000 (60%)] Loss: 0.22628 (QuantReg: 13.27465) QuantErr: 13.27465 batch_time=0.34710 
Train Epoch: 47 [606/1000 19392/32000 (61%)] Loss: 0.35295 (QuantReg: 14.11211) QuantErr: 14.11211 batch_time=0.35417 
Train Epoch: 47 [611/1000 19552/32000 (61%)] Loss: 0.44171 (QuantReg: 12.76884) QuantErr: 12.76884 batch_time=0.34742 
Train Epoch: 47 [616/1000 19712/32000 (62%)] Loss: 0.72368 (QuantReg: 13.34208) QuantErr: 13.34208 batch_time=0.37538 
Train Epoch: 47 [621/1000 19872/32000 (62%)] Loss: 0.56128 (QuantReg: 12.92583) QuantErr: 12.92583 batch_time=0.89143 
Train Epoch: 47 [626/1000 20032/32000 (63%)] Loss: 0.27545 (QuantReg: 12.89837) QuantErr: 12.89837 batch_time=0.41067 
Train Epoch: 47 [631/1000 20192/32000 (63%)] Loss: 0.22142 (QuantReg: 13.31309) QuantErr: 13.31309 batch_time=0.41467 
Train Epoch: 47 [636/1000 20352/32000 (64%)] Loss: 0.26763 (QuantReg: 13.48548) QuantErr: 13.48548 batch_time=0.44819 
Train Epoch: 47 [641/1000 20512/32000 (64%)] Loss: 0.23790 (QuantReg: 13.20845) QuantErr: 13.20845 batch_time=0.47379 
Train Epoch: 47 [646/1000 20672/32000 (65%)] Loss: 0.72254 (QuantReg: 12.79778) QuantErr: 12.79778 batch_time=0.38390 
Train Epoch: 47 [651/1000 20832/32000 (65%)] Loss: 0.30962 (QuantReg: 13.28041) QuantErr: 13.28041 batch_time=1.29868 
Train Epoch: 47 [656/1000 20992/32000 (66%)] Loss: 0.40825 (QuantReg: 13.20996) QuantErr: 13.20996 batch_time=0.35549 
Train Epoch: 47 [661/1000 21152/32000 (66%)] Loss: 0.45537 (QuantReg: 13.37583) QuantErr: 13.37583 batch_time=0.34887 
Train Epoch: 47 [666/1000 21312/32000 (67%)] Loss: 0.31046 (QuantReg: 13.38639) QuantErr: 13.38639 batch_time=0.35859 
Train Epoch: 47 [671/1000 21472/32000 (67%)] Loss: 0.33262 (QuantReg: 13.02440) QuantErr: 13.02440 batch_time=0.36419 
Train Epoch: 47 [676/1000 21632/32000 (68%)] Loss: 0.21619 (QuantReg: 13.71474) QuantErr: 13.71474 batch_time=0.43243 
Train Epoch: 47 [681/1000 21792/32000 (68%)] Loss: 0.21139 (QuantReg: 13.36640) QuantErr: 13.36640 batch_time=0.39809 
Train Epoch: 47 [686/1000 21952/32000 (69%)] Loss: 0.14480 (QuantReg: 13.62096) QuantErr: 13.62096 batch_time=0.35038 
Train Epoch: 47 [691/1000 22112/32000 (69%)] Loss: 0.51734 (QuantReg: 13.17592) QuantErr: 13.17592 batch_time=0.38455 
Train Epoch: 47 [696/1000 22272/32000 (70%)] Loss: 0.49760 (QuantReg: 13.09974) QuantErr: 13.09974 batch_time=0.36299 
Train Epoch: 47 [701/1000 22432/32000 (70%)] Loss: 0.24317 (QuantReg: 13.45493) QuantErr: 13.45493 batch_time=0.38221 
Train Epoch: 47 [706/1000 22592/32000 (71%)] Loss: 0.21040 (QuantReg: 13.42342) QuantErr: 13.42342 batch_time=0.35399 
Train Epoch: 47 [711/1000 22752/32000 (71%)] Loss: 0.14076 (QuantReg: 13.45592) QuantErr: 13.45592 batch_time=0.35524 
Train Epoch: 47 [716/1000 22912/32000 (72%)] Loss: 0.35557 (QuantReg: 12.49735) QuantErr: 12.49735 batch_time=0.36352 
Train Epoch: 47 [721/1000 23072/32000 (72%)] Loss: 0.16548 (QuantReg: 13.42622) QuantErr: 13.42622 batch_time=0.35461 
Train Epoch: 47 [726/1000 23232/32000 (73%)] Loss: 0.32844 (QuantReg: 13.18036) QuantErr: 13.18036 batch_time=0.39377 
Train Epoch: 47 [731/1000 23392/32000 (73%)] Loss: 0.56564 (QuantReg: 12.23320) QuantErr: 12.23320 batch_time=0.36026 
Train Epoch: 47 [736/1000 23552/32000 (74%)] Loss: 0.18646 (QuantReg: 13.99195) QuantErr: 13.99195 batch_time=0.35248 
Train Epoch: 47 [741/1000 23712/32000 (74%)] Loss: 0.25018 (QuantReg: 13.55956) QuantErr: 13.55956 batch_time=0.34622 
Train Epoch: 47 [746/1000 23872/32000 (75%)] Loss: 0.18448 (QuantReg: 13.33400) QuantErr: 13.33400 batch_time=0.40633 
Train Epoch: 47 [751/1000 24032/32000 (75%)] Loss: 0.22803 (QuantReg: 13.62622) QuantErr: 13.62622 batch_time=0.45896 
Train Epoch: 47 [756/1000 24192/32000 (76%)] Loss: 0.27690 (QuantReg: 13.40352) QuantErr: 13.40352 batch_time=0.52506 
Train Epoch: 47 [761/1000 24352/32000 (76%)] Loss: 0.22179 (QuantReg: 12.79291) QuantErr: 12.79291 batch_time=0.35374 
Train Epoch: 47 [766/1000 24512/32000 (77%)] Loss: 0.38018 (QuantReg: 12.53600) QuantErr: 12.53600 batch_time=0.36611 
Train Epoch: 47 [771/1000 24672/32000 (77%)] Loss: 0.16908 (QuantReg: 13.49624) QuantErr: 13.49624 batch_time=0.39544 
Train Epoch: 47 [776/1000 24832/32000 (78%)] Loss: 0.17875 (QuantReg: 13.35684) QuantErr: 13.35684 batch_time=0.38092 
Train Epoch: 47 [781/1000 24992/32000 (78%)] Loss: 0.55139 (QuantReg: 12.93135) QuantErr: 12.93135 batch_time=0.39181 
Train Epoch: 47 [786/1000 25152/32000 (79%)] Loss: 0.15181 (QuantReg: 13.67987) QuantErr: 13.67987 batch_time=0.36817 
Train Epoch: 47 [791/1000 25312/32000 (79%)] Loss: 0.38074 (QuantReg: 13.42061) QuantErr: 13.42061 batch_time=0.40818 
Train Epoch: 47 [796/1000 25472/32000 (80%)] Loss: 0.16746 (QuantReg: 13.46024) QuantErr: 13.46024 batch_time=0.62892 
Train Epoch: 47 [801/1000 25632/32000 (80%)] Loss: 0.49294 (QuantReg: 13.70749) QuantErr: 13.70749 batch_time=0.65292 
Train Epoch: 47 [806/1000 25792/32000 (81%)] Loss: 0.36744 (QuantReg: 13.73266) QuantErr: 13.73266 batch_time=0.48781 
Train Epoch: 47 [811/1000 25952/32000 (81%)] Loss: 0.26178 (QuantReg: 13.95346) QuantErr: 13.95346 batch_time=0.35266 
Train Epoch: 47 [816/1000 26112/32000 (82%)] Loss: 0.40985 (QuantReg: 13.15289) QuantErr: 13.15289 batch_time=0.55631 
Train Epoch: 47 [821/1000 26272/32000 (82%)] Loss: 0.28348 (QuantReg: 13.15541) QuantErr: 13.15541 batch_time=0.40519 
Train Epoch: 47 [826/1000 26432/32000 (83%)] Loss: 0.24618 (QuantReg: 13.52487) QuantErr: 13.52487 batch_time=0.39818 
Train Epoch: 47 [831/1000 26592/32000 (83%)] Loss: 0.18761 (QuantReg: 13.22908) QuantErr: 13.22908 batch_time=0.43423 
Train Epoch: 47 [836/1000 26752/32000 (84%)] Loss: 0.21532 (QuantReg: 13.53255) QuantErr: 13.53255 batch_time=0.37125 
Train Epoch: 47 [841/1000 26912/32000 (84%)] Loss: 0.41549 (QuantReg: 12.97301) QuantErr: 12.97301 batch_time=0.36898 
Train Epoch: 47 [846/1000 27072/32000 (85%)] Loss: 0.21049 (QuantReg: 13.83753) QuantErr: 13.83753 batch_time=0.35117 
Train Epoch: 47 [851/1000 27232/32000 (85%)] Loss: 0.24033 (QuantReg: 12.67083) QuantErr: 12.67083 batch_time=0.40893 
Train Epoch: 47 [856/1000 27392/32000 (86%)] Loss: 0.44640 (QuantReg: 13.70633) QuantErr: 13.70633 batch_time=0.53518 
Train Epoch: 47 [861/1000 27552/32000 (86%)] Loss: 0.22044 (QuantReg: 14.05093) QuantErr: 14.05093 batch_time=0.34976 
Train Epoch: 47 [866/1000 27712/32000 (87%)] Loss: 0.21636 (QuantReg: 13.25495) QuantErr: 13.25495 batch_time=1.27999 
Train Epoch: 47 [871/1000 27872/32000 (87%)] Loss: 0.29071 (QuantReg: 13.58829) QuantErr: 13.58829 batch_time=0.42732 
Train Epoch: 47 [876/1000 28032/32000 (88%)] Loss: 0.36223 (QuantReg: 13.43239) QuantErr: 13.43239 batch_time=0.39686 
Train Epoch: 47 [881/1000 28192/32000 (88%)] Loss: 0.37712 (QuantReg: 14.16042) QuantErr: 14.16042 batch_time=0.48923 
Train Epoch: 47 [886/1000 28352/32000 (89%)] Loss: 0.22620 (QuantReg: 13.14870) QuantErr: 13.14870 batch_time=0.59761 
Train Epoch: 47 [891/1000 28512/32000 (89%)] Loss: 0.27429 (QuantReg: 13.28585) QuantErr: 13.28585 batch_time=0.46766 
Train Epoch: 47 [896/1000 28672/32000 (90%)] Loss: 0.39496 (QuantReg: 13.76957) QuantErr: 13.76957 batch_time=0.42894 
Train Epoch: 47 [901/1000 28832/32000 (90%)] Loss: 0.14709 (QuantReg: 13.44800) QuantErr: 13.44800 batch_time=0.39851 
Train Epoch: 47 [906/1000 28992/32000 (91%)] Loss: 0.31824 (QuantReg: 13.01442) QuantErr: 13.01442 batch_time=0.39673 
Train Epoch: 47 [911/1000 29152/32000 (91%)] Loss: 0.64957 (QuantReg: 13.11954) QuantErr: 13.11954 batch_time=0.42385 
Train Epoch: 47 [916/1000 29312/32000 (92%)] Loss: 0.83573 (QuantReg: 12.70913) QuantErr: 12.70913 batch_time=0.36746 
Train Epoch: 47 [921/1000 29472/32000 (92%)] Loss: 0.19821 (QuantReg: 14.19143) QuantErr: 14.19143 batch_time=0.37861 
Train Epoch: 47 [926/1000 29632/32000 (93%)] Loss: 0.33768 (QuantReg: 12.85862) QuantErr: 12.85862 batch_time=0.46206 
Train Epoch: 47 [931/1000 29792/32000 (93%)] Loss: 0.06906 (QuantReg: 13.63767) QuantErr: 13.63767 batch_time=0.38815 
Train Epoch: 47 [936/1000 29952/32000 (94%)] Loss: 0.27090 (QuantReg: 13.51060) QuantErr: 13.51060 batch_time=0.37268 
Train Epoch: 47 [941/1000 30112/32000 (94%)] Loss: 0.17272 (QuantReg: 13.10670) QuantErr: 13.10670 batch_time=0.42795 
Train Epoch: 47 [946/1000 30272/32000 (95%)] Loss: 0.13701 (QuantReg: 13.34695) QuantErr: 13.34695 batch_time=0.38316 
Train Epoch: 47 [951/1000 30432/32000 (95%)] Loss: 0.25436 (QuantReg: 13.69874) QuantErr: 13.69874 batch_time=0.36468 
Train Epoch: 47 [956/1000 30592/32000 (96%)] Loss: 0.25983 (QuantReg: 14.17183) QuantErr: 14.17183 batch_time=0.35788 
Train Epoch: 47 [961/1000 30752/32000 (96%)] Loss: 0.34821 (QuantReg: 12.82778) QuantErr: 12.82778 batch_time=0.39807 
Train Epoch: 47 [966/1000 30912/32000 (97%)] Loss: 0.40075 (QuantReg: 13.30667) QuantErr: 13.30667 batch_time=0.35271 
Train Epoch: 47 [971/1000 31072/32000 (97%)] Loss: 0.19396 (QuantReg: 13.31052) QuantErr: 13.31052 batch_time=1.41708 
Train Epoch: 47 [976/1000 31232/32000 (98%)] Loss: 0.23386 (QuantReg: 14.02563) QuantErr: 14.02563 batch_time=0.42615 
Train Epoch: 47 [981/1000 31392/32000 (98%)] Loss: 0.43490 (QuantReg: 13.23250) QuantErr: 13.23250 batch_time=0.37072 
Train Epoch: 47 [986/1000 31552/32000 (99%)] Loss: 0.19211 (QuantReg: 13.96176) QuantErr: 13.96176 batch_time=0.38916 
Train Epoch: 47 [991/1000 31712/32000 (99%)] Loss: 0.43891 (QuantReg: 12.67888) QuantErr: 12.67888 batch_time=0.46725 
Train Epoch: 47 [996/1000 31872/32000 (100%)] Loss: 0.21540 (QuantReg: 13.46768) QuantErr: 13.46768 batch_time=0.39651 
Train Epoch: 47 codebook_update_time=1.80496
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch47.pth ...
Done in 8.924s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 0.30007824931293725
 quant_reg      : 13.311279722213746
 quant_err      : 13.311279722213746
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 47000
 MSRVTT_miech_test/t2v_metrics/R1: 21.3
 MSRVTT_miech_test/t2v_metrics/R5: 50.6
 MSRVTT_miech_test/t2v_metrics/R10: 63.7
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.744
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.947103308871
 MSRVTT_miech_test/v2t_metrics/R1: 21.0
 MSRVTT_miech_test/v2t_metrics/R5: 52.6
 MSRVTT_miech_test/v2t_metrics/R10: 66.0
 MSRVTT_miech_test/v2t_metrics/R50: 88.4
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.798
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.774987133986244
 mnt_best       : 41.54284538121151
 not_improved_count: 1
Train Epoch: 48 [1/1000 32/32000 (0%)] Loss: 0.20326 (QuantReg: 13.78086) QuantErr: 13.78086 batch_time=25.44657 
Train Epoch: 48 [6/1000 192/32000 (1%)] Loss: 0.43592 (QuantReg: 13.41243) QuantErr: 13.41243 batch_time=0.33752 
Train Epoch: 48 [11/1000 352/32000 (1%)] Loss: 0.20044 (QuantReg: 13.33042) QuantErr: 13.33042 batch_time=0.36719 
Train Epoch: 48 [16/1000 512/32000 (2%)] Loss: 0.63335 (QuantReg: 12.80747) QuantErr: 12.80747 batch_time=0.34031 
Train Epoch: 48 [21/1000 672/32000 (2%)] Loss: 0.17030 (QuantReg: 13.12255) QuantErr: 13.12255 batch_time=0.35633 
Train Epoch: 48 [26/1000 832/32000 (3%)] Loss: 0.17925 (QuantReg: 13.53004) QuantErr: 13.53004 batch_time=0.33700 
Train Epoch: 48 [31/1000 992/32000 (3%)] Loss: 0.25147 (QuantReg: 13.29549) QuantErr: 13.29549 batch_time=0.43860 
Train Epoch: 48 [36/1000 1152/32000 (4%)] Loss: 0.23993 (QuantReg: 13.66602) QuantErr: 13.66602 batch_time=0.40594 
Train Epoch: 48 [41/1000 1312/32000 (4%)] Loss: 0.35131 (QuantReg: 13.49939) QuantErr: 13.49939 batch_time=0.40396 
Train Epoch: 48 [46/1000 1472/32000 (5%)] Loss: 0.28893 (QuantReg: 13.65607) QuantErr: 13.65607 batch_time=0.43593 
Train Epoch: 48 [51/1000 1632/32000 (5%)] Loss: 0.19464 (QuantReg: 14.12561) QuantErr: 14.12561 batch_time=0.40287 
Train Epoch: 48 [56/1000 1792/32000 (6%)] Loss: 0.50504 (QuantReg: 13.52576) QuantErr: 13.52576 batch_time=0.35188 
Train Epoch: 48 [61/1000 1952/32000 (6%)] Loss: 0.22477 (QuantReg: 13.65497) QuantErr: 13.65497 batch_time=0.35450 
Train Epoch: 48 [66/1000 2112/32000 (7%)] Loss: 0.08905 (QuantReg: 13.59537) QuantErr: 13.59537 batch_time=1.13990 
Train Epoch: 48 [71/1000 2272/32000 (7%)] Loss: 0.40710 (QuantReg: 13.11464) QuantErr: 13.11464 batch_time=2.16644 
Train Epoch: 48 [76/1000 2432/32000 (8%)] Loss: 0.47289 (QuantReg: 12.63066) QuantErr: 12.63066 batch_time=0.35463 
Train Epoch: 48 [81/1000 2592/32000 (8%)] Loss: 0.22275 (QuantReg: 13.74332) QuantErr: 13.74332 batch_time=0.39368 
Train Epoch: 48 [86/1000 2752/32000 (9%)] Loss: 0.15172 (QuantReg: 13.58995) QuantErr: 13.58995 batch_time=1.94626 
Train Epoch: 48 [91/1000 2912/32000 (9%)] Loss: 0.56269 (QuantReg: 12.56343) QuantErr: 12.56343 batch_time=0.38621 
Train Epoch: 48 [96/1000 3072/32000 (10%)] Loss: 0.26711 (QuantReg: 13.59248) QuantErr: 13.59248 batch_time=0.41349 
Train Epoch: 48 [101/1000 3232/32000 (10%)] Loss: 0.57257 (QuantReg: 13.66777) QuantErr: 13.66777 batch_time=0.36074 
Train Epoch: 48 [106/1000 3392/32000 (11%)] Loss: 0.20711 (QuantReg: 13.51394) QuantErr: 13.51394 batch_time=0.39230 
Train Epoch: 48 [111/1000 3552/32000 (11%)] Loss: 0.13314 (QuantReg: 13.39565) QuantErr: 13.39565 batch_time=0.39632 
Train Epoch: 48 [116/1000 3712/32000 (12%)] Loss: 0.17298 (QuantReg: 13.85254) QuantErr: 13.85254 batch_time=0.42205 
Train Epoch: 48 [121/1000 3872/32000 (12%)] Loss: 0.23097 (QuantReg: 13.18874) QuantErr: 13.18874 batch_time=0.35836 
Train Epoch: 48 [126/1000 4032/32000 (13%)] Loss: 0.19823 (QuantReg: 13.51749) QuantErr: 13.51749 batch_time=0.36346 
Train Epoch: 48 [131/1000 4192/32000 (13%)] Loss: 0.26963 (QuantReg: 13.74545) QuantErr: 13.74545 batch_time=0.35018 
Train Epoch: 48 [136/1000 4352/32000 (14%)] Loss: 0.35196 (QuantReg: 13.23349) QuantErr: 13.23349 batch_time=0.36424 
Train Epoch: 48 [141/1000 4512/32000 (14%)] Loss: 0.36524 (QuantReg: 13.17216) QuantErr: 13.17216 batch_time=0.47486 
Train Epoch: 48 [146/1000 4672/32000 (15%)] Loss: 0.58370 (QuantReg: 12.88788) QuantErr: 12.88788 batch_time=0.40819 
Train Epoch: 48 [151/1000 4832/32000 (15%)] Loss: 0.79134 (QuantReg: 13.06092) QuantErr: 13.06092 batch_time=0.39086 
Train Epoch: 48 [156/1000 4992/32000 (16%)] Loss: 0.24783 (QuantReg: 13.42731) QuantErr: 13.42731 batch_time=0.42360 
Train Epoch: 48 [161/1000 5152/32000 (16%)] Loss: 0.30612 (QuantReg: 13.27577) QuantErr: 13.27577 batch_time=0.35997 
Train Epoch: 48 [166/1000 5312/32000 (17%)] Loss: 0.18133 (QuantReg: 13.69646) QuantErr: 13.69646 batch_time=0.42627 
Train Epoch: 48 [171/1000 5472/32000 (17%)] Loss: 0.35677 (QuantReg: 13.35398) QuantErr: 13.35398 batch_time=0.43053 
Train Epoch: 48 [176/1000 5632/32000 (18%)] Loss: 0.71463 (QuantReg: 12.87568) QuantErr: 12.87568 batch_time=0.38351 
Train Epoch: 48 [181/1000 5792/32000 (18%)] Loss: 0.19255 (QuantReg: 13.32685) QuantErr: 13.32685 batch_time=0.34646 
Train Epoch: 48 [186/1000 5952/32000 (19%)] Loss: 0.31956 (QuantReg: 13.23691) QuantErr: 13.23691 batch_time=0.43370 
Train Epoch: 48 [191/1000 6112/32000 (19%)] Loss: 0.15092 (QuantReg: 13.60874) QuantErr: 13.60874 batch_time=0.38334 
Train Epoch: 48 [196/1000 6272/32000 (20%)] Loss: 0.25660 (QuantReg: 13.37307) QuantErr: 13.37307 batch_time=0.37503 
Train Epoch: 48 [201/1000 6432/32000 (20%)] Loss: 0.38991 (QuantReg: 13.29002) QuantErr: 13.29002 batch_time=0.44747 
Train Epoch: 48 [206/1000 6592/32000 (21%)] Loss: 0.39143 (QuantReg: 13.33821) QuantErr: 13.33821 batch_time=0.35048 
Train Epoch: 48 [211/1000 6752/32000 (21%)] Loss: 0.15104 (QuantReg: 13.67134) QuantErr: 13.67134 batch_time=0.37936 
Train Epoch: 48 [216/1000 6912/32000 (22%)] Loss: 0.38347 (QuantReg: 13.56788) QuantErr: 13.56788 batch_time=0.38356 
Train Epoch: 48 [221/1000 7072/32000 (22%)] Loss: 0.20132 (QuantReg: 13.45254) QuantErr: 13.45254 batch_time=0.46958 
Train Epoch: 48 [226/1000 7232/32000 (23%)] Loss: 0.19695 (QuantReg: 13.22594) QuantErr: 13.22594 batch_time=0.34128 
Train Epoch: 48 [231/1000 7392/32000 (23%)] Loss: 0.32299 (QuantReg: 13.15708) QuantErr: 13.15708 batch_time=0.41677 
Train Epoch: 48 [236/1000 7552/32000 (24%)] Loss: 0.21587 (QuantReg: 13.83050) QuantErr: 13.83050 batch_time=0.36811 
Train Epoch: 48 [241/1000 7712/32000 (24%)] Loss: 0.28622 (QuantReg: 13.40862) QuantErr: 13.40862 batch_time=0.41677 
Train Epoch: 48 [246/1000 7872/32000 (25%)] Loss: 0.40945 (QuantReg: 13.72787) QuantErr: 13.72787 batch_time=0.36774 
Train Epoch: 48 [251/1000 8032/32000 (25%)] Loss: 0.08709 (QuantReg: 13.74150) QuantErr: 13.74150 batch_time=0.39671 
Train Epoch: 48 [256/1000 8192/32000 (26%)] Loss: 0.23950 (QuantReg: 13.36015) QuantErr: 13.36015 batch_time=0.40922 
Train Epoch: 48 [261/1000 8352/32000 (26%)] Loss: 0.34552 (QuantReg: 13.26776) QuantErr: 13.26776 batch_time=0.43132 
Train Epoch: 48 [266/1000 8512/32000 (27%)] Loss: 0.28582 (QuantReg: 12.93758) QuantErr: 12.93758 batch_time=0.49058 
Train Epoch: 48 [271/1000 8672/32000 (27%)] Loss: 0.45570 (QuantReg: 13.36535) QuantErr: 13.36535 batch_time=0.37837 
Train Epoch: 48 [276/1000 8832/32000 (28%)] Loss: 0.44070 (QuantReg: 13.42164) QuantErr: 13.42164 batch_time=0.36534 
Train Epoch: 48 [281/1000 8992/32000 (28%)] Loss: 0.21544 (QuantReg: 12.84444) QuantErr: 12.84444 batch_time=0.37743 
Train Epoch: 48 [286/1000 9152/32000 (29%)] Loss: 0.25297 (QuantReg: 13.32012) QuantErr: 13.32012 batch_time=0.39747 
Train Epoch: 48 [291/1000 9312/32000 (29%)] Loss: 0.49350 (QuantReg: 13.17256) QuantErr: 13.17256 batch_time=0.55157 
Train Epoch: 48 [296/1000 9472/32000 (30%)] Loss: 0.20299 (QuantReg: 13.24756) QuantErr: 13.24756 batch_time=0.43395 
Train Epoch: 48 [301/1000 9632/32000 (30%)] Loss: 0.26503 (QuantReg: 13.21287) QuantErr: 13.21287 batch_time=0.39629 
Train Epoch: 48 [306/1000 9792/32000 (31%)] Loss: 0.24972 (QuantReg: 13.14866) QuantErr: 13.14866 batch_time=0.38745 
Train Epoch: 48 [311/1000 9952/32000 (31%)] Loss: 0.39272 (QuantReg: 13.30178) QuantErr: 13.30178 batch_time=0.47864 
Train Epoch: 48 [316/1000 10112/32000 (32%)] Loss: 0.16449 (QuantReg: 13.25251) QuantErr: 13.25251 batch_time=0.44371 
Train Epoch: 48 [321/1000 10272/32000 (32%)] Loss: 0.16806 (QuantReg: 13.69028) QuantErr: 13.69028 batch_time=0.40344 
Train Epoch: 48 [326/1000 10432/32000 (33%)] Loss: 0.24401 (QuantReg: 13.33824) QuantErr: 13.33824 batch_time=0.39910 
Train Epoch: 48 [331/1000 10592/32000 (33%)] Loss: 0.11829 (QuantReg: 13.21689) QuantErr: 13.21689 batch_time=0.36900 
Train Epoch: 48 [336/1000 10752/32000 (34%)] Loss: 0.69532 (QuantReg: 13.03061) QuantErr: 13.03061 batch_time=0.74579 
Train Epoch: 48 [341/1000 10912/32000 (34%)] Loss: 0.39848 (QuantReg: 13.27959) QuantErr: 13.27959 batch_time=0.45281 
Train Epoch: 48 [346/1000 11072/32000 (35%)] Loss: 0.07815 (QuantReg: 13.65703) QuantErr: 13.65703 batch_time=0.38618 
Train Epoch: 48 [351/1000 11232/32000 (35%)] Loss: 0.25192 (QuantReg: 13.48818) QuantErr: 13.48818 batch_time=0.39407 
Train Epoch: 48 [356/1000 11392/32000 (36%)] Loss: 0.23002 (QuantReg: 12.97431) QuantErr: 12.97431 batch_time=0.42060 
Train Epoch: 48 [361/1000 11552/32000 (36%)] Loss: 0.35250 (QuantReg: 13.49311) QuantErr: 13.49311 batch_time=0.36271 
Train Epoch: 48 [366/1000 11712/32000 (37%)] Loss: 0.28963 (QuantReg: 13.24574) QuantErr: 13.24574 batch_time=0.38745 
Train Epoch: 48 [371/1000 11872/32000 (37%)] Loss: 0.30060 (QuantReg: 13.96097) QuantErr: 13.96097 batch_time=0.42315 
Train Epoch: 48 [376/1000 12032/32000 (38%)] Loss: 0.25375 (QuantReg: 13.26369) QuantErr: 13.26369 batch_time=0.44077 
Train Epoch: 48 [381/1000 12192/32000 (38%)] Loss: 0.28391 (QuantReg: 13.48206) QuantErr: 13.48206 batch_time=0.41496 
Train Epoch: 48 [386/1000 12352/32000 (39%)] Loss: 0.22266 (QuantReg: 13.23915) QuantErr: 13.23915 batch_time=0.39245 
Train Epoch: 48 [391/1000 12512/32000 (39%)] Loss: 0.13137 (QuantReg: 13.67574) QuantErr: 13.67574 batch_time=1.91180 
Train Epoch: 48 [396/1000 12672/32000 (40%)] Loss: 0.26877 (QuantReg: 13.33381) QuantErr: 13.33381 batch_time=0.37114 
Train Epoch: 48 [401/1000 12832/32000 (40%)] Loss: 0.47826 (QuantReg: 12.77896) QuantErr: 12.77896 batch_time=0.36928 
Train Epoch: 48 [406/1000 12992/32000 (41%)] Loss: 0.50301 (QuantReg: 13.29739) QuantErr: 13.29739 batch_time=0.67805 
Train Epoch: 48 [411/1000 13152/32000 (41%)] Loss: 0.23483 (QuantReg: 13.07466) QuantErr: 13.07466 batch_time=0.45960 
Train Epoch: 48 [416/1000 13312/32000 (42%)] Loss: 0.26300 (QuantReg: 13.27829) QuantErr: 13.27829 batch_time=0.39023 
Train Epoch: 48 [421/1000 13472/32000 (42%)] Loss: 0.07862 (QuantReg: 13.47670) QuantErr: 13.47670 batch_time=0.38407 
Train Epoch: 48 [426/1000 13632/32000 (43%)] Loss: 0.10840 (QuantReg: 13.45271) QuantErr: 13.45271 batch_time=0.56013 
Train Epoch: 48 [431/1000 13792/32000 (43%)] Loss: 0.22859 (QuantReg: 13.67658) QuantErr: 13.67658 batch_time=0.39407 
Train Epoch: 48 [436/1000 13952/32000 (44%)] Loss: 0.38226 (QuantReg: 13.43550) QuantErr: 13.43550 batch_time=0.40740 
Train Epoch: 48 [441/1000 14112/32000 (44%)] Loss: 0.31430 (QuantReg: 13.83073) QuantErr: 13.83073 batch_time=0.36156 
Train Epoch: 48 [446/1000 14272/32000 (45%)] Loss: 0.24315 (QuantReg: 13.59868) QuantErr: 13.59868 batch_time=0.42305 
Train Epoch: 48 [451/1000 14432/32000 (45%)] Loss: 0.30897 (QuantReg: 13.11410) QuantErr: 13.11410 batch_time=0.38570 
Train Epoch: 48 [456/1000 14592/32000 (46%)] Loss: 0.39596 (QuantReg: 13.91216) QuantErr: 13.91216 batch_time=0.37528 
Train Epoch: 48 [461/1000 14752/32000 (46%)] Loss: 0.31761 (QuantReg: 13.57984) QuantErr: 13.57984 batch_time=0.38366 
Train Epoch: 48 [466/1000 14912/32000 (47%)] Loss: 0.28933 (QuantReg: 13.28684) QuantErr: 13.28684 batch_time=0.42231 
Train Epoch: 48 [471/1000 15072/32000 (47%)] Loss: 0.39092 (QuantReg: 13.68807) QuantErr: 13.68807 batch_time=0.40981 
Train Epoch: 48 [476/1000 15232/32000 (48%)] Loss: 0.34151 (QuantReg: 12.59478) QuantErr: 12.59478 batch_time=0.37528 
Train Epoch: 48 [481/1000 15392/32000 (48%)] Loss: 0.17858 (QuantReg: 13.41165) QuantErr: 13.41165 batch_time=0.38163 
Train Epoch: 48 [486/1000 15552/32000 (49%)] Loss: 0.18961 (QuantReg: 13.47442) QuantErr: 13.47442 batch_time=0.35608 
Train Epoch: 48 [491/1000 15712/32000 (49%)] Loss: 0.19152 (QuantReg: 13.54349) QuantErr: 13.54349 batch_time=0.39599 
Train Epoch: 48 [496/1000 15872/32000 (50%)] Loss: 0.38475 (QuantReg: 13.11150) QuantErr: 13.11150 batch_time=0.36758 
Train Epoch: 48 [501/1000 16032/32000 (50%)] Loss: 0.55553 (QuantReg: 12.96020) QuantErr: 12.96020 batch_time=0.36254 
Train Epoch: 48 [506/1000 16192/32000 (51%)] Loss: 0.19742 (QuantReg: 12.77229) QuantErr: 12.77229 batch_time=0.46020 
Train Epoch: 48 [511/1000 16352/32000 (51%)] Loss: 0.40726 (QuantReg: 13.28965) QuantErr: 13.28965 batch_time=0.41745 
Train Epoch: 48 [516/1000 16512/32000 (52%)] Loss: 0.14309 (QuantReg: 13.93428) QuantErr: 13.93428 batch_time=0.40009 
Train Epoch: 48 [521/1000 16672/32000 (52%)] Loss: 0.27442 (QuantReg: 13.45288) QuantErr: 13.45288 batch_time=0.44758 
Train Epoch: 48 [526/1000 16832/32000 (53%)] Loss: 0.34488 (QuantReg: 13.95860) QuantErr: 13.95860 batch_time=0.39424 
Train Epoch: 48 [531/1000 16992/32000 (53%)] Loss: 0.25741 (QuantReg: 13.90917) QuantErr: 13.90917 batch_time=0.44026 
Train Epoch: 48 [536/1000 17152/32000 (54%)] Loss: 0.18398 (QuantReg: 13.53489) QuantErr: 13.53489 batch_time=0.38266 
Train Epoch: 48 [541/1000 17312/32000 (54%)] Loss: 0.23740 (QuantReg: 14.30161) QuantErr: 14.30161 batch_time=0.49856 
Train Epoch: 48 [546/1000 17472/32000 (55%)] Loss: 0.39661 (QuantReg: 13.35289) QuantErr: 13.35289 batch_time=0.40712 
Train Epoch: 48 [551/1000 17632/32000 (55%)] Loss: 0.40091 (QuantReg: 12.83713) QuantErr: 12.83713 batch_time=0.35579 
Train Epoch: 48 [556/1000 17792/32000 (56%)] Loss: 0.27919 (QuantReg: 12.45232) QuantErr: 12.45232 batch_time=0.38756 
Train Epoch: 48 [561/1000 17952/32000 (56%)] Loss: 0.38695 (QuantReg: 13.46100) QuantErr: 13.46100 batch_time=0.37220 
Train Epoch: 48 [566/1000 18112/32000 (57%)] Loss: 0.22861 (QuantReg: 13.66820) QuantErr: 13.66820 batch_time=0.36299 
Train Epoch: 48 [571/1000 18272/32000 (57%)] Loss: 0.41771 (QuantReg: 13.80324) QuantErr: 13.80324 batch_time=0.35621 
Train Epoch: 48 [576/1000 18432/32000 (58%)] Loss: 0.16905 (QuantReg: 13.46239) QuantErr: 13.46239 batch_time=0.34705 
Train Epoch: 48 [581/1000 18592/32000 (58%)] Loss: 0.21432 (QuantReg: 13.05465) QuantErr: 13.05465 batch_time=0.37943 
Train Epoch: 48 [586/1000 18752/32000 (59%)] Loss: 0.27736 (QuantReg: 13.84759) QuantErr: 13.84759 batch_time=0.35969 
Train Epoch: 48 [591/1000 18912/32000 (59%)] Loss: 0.12537 (QuantReg: 13.56492) QuantErr: 13.56492 batch_time=0.36379 
Train Epoch: 48 [596/1000 19072/32000 (60%)] Loss: 0.23110 (QuantReg: 13.47399) QuantErr: 13.47399 batch_time=0.35796 
Train Epoch: 48 [601/1000 19232/32000 (60%)] Loss: 0.20566 (QuantReg: 13.48711) QuantErr: 13.48711 batch_time=0.37963 
Train Epoch: 48 [606/1000 19392/32000 (61%)] Loss: 0.14854 (QuantReg: 13.35993) QuantErr: 13.35993 batch_time=0.38641 
Train Epoch: 48 [611/1000 19552/32000 (61%)] Loss: 0.25250 (QuantReg: 13.81869) QuantErr: 13.81869 batch_time=0.40354 
Train Epoch: 48 [616/1000 19712/32000 (62%)] Loss: 0.07206 (QuantReg: 13.60614) QuantErr: 13.60614 batch_time=0.38292 
Train Epoch: 48 [621/1000 19872/32000 (62%)] Loss: 0.21112 (QuantReg: 13.48326) QuantErr: 13.48326 batch_time=0.35456 
Train Epoch: 48 [626/1000 20032/32000 (63%)] Loss: 0.18976 (QuantReg: 13.58808) QuantErr: 13.58808 batch_time=0.34968 
Train Epoch: 48 [631/1000 20192/32000 (63%)] Loss: 0.37318 (QuantReg: 12.77495) QuantErr: 12.77495 batch_time=0.35810 
Train Epoch: 48 [636/1000 20352/32000 (64%)] Loss: 0.37789 (QuantReg: 12.27234) QuantErr: 12.27234 batch_time=0.35984 
Train Epoch: 48 [641/1000 20512/32000 (64%)] Loss: 0.54246 (QuantReg: 13.25430) QuantErr: 13.25430 batch_time=0.37344 
Train Epoch: 48 [646/1000 20672/32000 (65%)] Loss: 0.42170 (QuantReg: 12.85862) QuantErr: 12.85862 batch_time=0.36130 
Train Epoch: 48 [651/1000 20832/32000 (65%)] Loss: 0.31139 (QuantReg: 13.67209) QuantErr: 13.67209 batch_time=0.35764 
Train Epoch: 48 [656/1000 20992/32000 (66%)] Loss: 0.36014 (QuantReg: 13.52839) QuantErr: 13.52839 batch_time=0.81920 
Train Epoch: 48 [661/1000 21152/32000 (66%)] Loss: 0.10850 (QuantReg: 13.77713) QuantErr: 13.77713 batch_time=0.37603 
Train Epoch: 48 [666/1000 21312/32000 (67%)] Loss: 0.73324 (QuantReg: 13.65578) QuantErr: 13.65578 batch_time=0.46305 
Train Epoch: 48 [671/1000 21472/32000 (67%)] Loss: 0.28500 (QuantReg: 13.60411) QuantErr: 13.60411 batch_time=0.35381 
Train Epoch: 48 [676/1000 21632/32000 (68%)] Loss: 0.12120 (QuantReg: 13.79892) QuantErr: 13.79892 batch_time=0.46828 
Train Epoch: 48 [681/1000 21792/32000 (68%)] Loss: 0.12449 (QuantReg: 13.49438) QuantErr: 13.49438 batch_time=0.39625 
Train Epoch: 48 [686/1000 21952/32000 (69%)] Loss: 0.12022 (QuantReg: 14.00936) QuantErr: 14.00936 batch_time=0.42979 
Train Epoch: 48 [691/1000 22112/32000 (69%)] Loss: 0.19811 (QuantReg: 13.69019) QuantErr: 13.69019 batch_time=0.35205 
Train Epoch: 48 [696/1000 22272/32000 (70%)] Loss: 0.21570 (QuantReg: 13.26555) QuantErr: 13.26555 batch_time=0.43276 
Train Epoch: 48 [701/1000 22432/32000 (70%)] Loss: 0.31115 (QuantReg: 12.96857) QuantErr: 12.96857 batch_time=0.36472 
Train Epoch: 48 [706/1000 22592/32000 (71%)] Loss: 0.23264 (QuantReg: 12.85694) QuantErr: 12.85694 batch_time=0.40142 
Train Epoch: 48 [711/1000 22752/32000 (71%)] Loss: 0.36497 (QuantReg: 12.92483) QuantErr: 12.92483 batch_time=1.43539 
Train Epoch: 48 [716/1000 22912/32000 (72%)] Loss: 0.19172 (QuantReg: 13.29314) QuantErr: 13.29314 batch_time=0.37660 
Train Epoch: 48 [721/1000 23072/32000 (72%)] Loss: 0.33186 (QuantReg: 12.96911) QuantErr: 12.96911 batch_time=0.43126 
Train Epoch: 48 [726/1000 23232/32000 (73%)] Loss: 0.18088 (QuantReg: 12.83236) QuantErr: 12.83236 batch_time=0.58082 
Train Epoch: 48 [731/1000 23392/32000 (73%)] Loss: 0.50382 (QuantReg: 12.77589) QuantErr: 12.77589 batch_time=0.36087 
Train Epoch: 48 [736/1000 23552/32000 (74%)] Loss: 0.16192 (QuantReg: 13.63657) QuantErr: 13.63657 batch_time=0.37276 
Train Epoch: 48 [741/1000 23712/32000 (74%)] Loss: 0.35616 (QuantReg: 13.65934) QuantErr: 13.65934 batch_time=0.36014 
Train Epoch: 48 [746/1000 23872/32000 (75%)] Loss: 0.10964 (QuantReg: 12.88898) QuantErr: 12.88898 batch_time=0.38149 
Train Epoch: 48 [751/1000 24032/32000 (75%)] Loss: 0.34532 (QuantReg: 13.33179) QuantErr: 13.33179 batch_time=0.50449 
Train Epoch: 48 [756/1000 24192/32000 (76%)] Loss: 0.32131 (QuantReg: 13.59470) QuantErr: 13.59470 batch_time=0.44957 
Train Epoch: 48 [761/1000 24352/32000 (76%)] Loss: 0.51295 (QuantReg: 13.07335) QuantErr: 13.07335 batch_time=0.37756 
Train Epoch: 48 [766/1000 24512/32000 (77%)] Loss: 0.41550 (QuantReg: 13.00347) QuantErr: 13.00347 batch_time=0.37224 
Train Epoch: 48 [771/1000 24672/32000 (77%)] Loss: 0.48345 (QuantReg: 13.70960) QuantErr: 13.70960 batch_time=0.36778 
Train Epoch: 48 [776/1000 24832/32000 (78%)] Loss: 0.05637 (QuantReg: 13.51658) QuantErr: 13.51658 batch_time=0.35450 
Train Epoch: 48 [781/1000 24992/32000 (78%)] Loss: 0.14669 (QuantReg: 13.79073) QuantErr: 13.79073 batch_time=0.36969 
Train Epoch: 48 [786/1000 25152/32000 (79%)] Loss: 0.23282 (QuantReg: 13.53989) QuantErr: 13.53989 batch_time=0.41337 
Train Epoch: 48 [791/1000 25312/32000 (79%)] Loss: 0.30538 (QuantReg: 13.22159) QuantErr: 13.22159 batch_time=0.39679 
Train Epoch: 48 [796/1000 25472/32000 (80%)] Loss: 0.39345 (QuantReg: 13.55148) QuantErr: 13.55148 batch_time=0.35843 
Train Epoch: 48 [801/1000 25632/32000 (80%)] Loss: 0.36462 (QuantReg: 13.61409) QuantErr: 13.61409 batch_time=0.35313 
Train Epoch: 48 [806/1000 25792/32000 (81%)] Loss: 0.90016 (QuantReg: 12.98699) QuantErr: 12.98699 batch_time=0.34767 
Train Epoch: 48 [811/1000 25952/32000 (81%)] Loss: 0.27815 (QuantReg: 13.64629) QuantErr: 13.64629 batch_time=0.45611 
Train Epoch: 48 [816/1000 26112/32000 (82%)] Loss: 0.12696 (QuantReg: 13.66735) QuantErr: 13.66735 batch_time=0.40906 
Train Epoch: 48 [821/1000 26272/32000 (82%)] Loss: 0.30758 (QuantReg: 13.70731) QuantErr: 13.70731 batch_time=0.38135 
Train Epoch: 48 [826/1000 26432/32000 (83%)] Loss: 0.37427 (QuantReg: 13.44811) QuantErr: 13.44811 batch_time=0.77998 
Train Epoch: 48 [831/1000 26592/32000 (83%)] Loss: 0.18581 (QuantReg: 13.42227) QuantErr: 13.42227 batch_time=0.59481 
Train Epoch: 48 [836/1000 26752/32000 (84%)] Loss: 0.29483 (QuantReg: 13.08124) QuantErr: 13.08124 batch_time=0.42316 
Train Epoch: 48 [841/1000 26912/32000 (84%)] Loss: 0.29818 (QuantReg: 12.86772) QuantErr: 12.86772 batch_time=0.39808 
Train Epoch: 48 [846/1000 27072/32000 (85%)] Loss: 0.21190 (QuantReg: 13.11072) QuantErr: 13.11072 batch_time=0.39664 
Train Epoch: 48 [851/1000 27232/32000 (85%)] Loss: 0.12552 (QuantReg: 13.53411) QuantErr: 13.53411 batch_time=0.37915 
Train Epoch: 48 [856/1000 27392/32000 (86%)] Loss: 0.32838 (QuantReg: 13.48489) QuantErr: 13.48489 batch_time=0.38845 
Train Epoch: 48 [861/1000 27552/32000 (86%)] Loss: 0.22327 (QuantReg: 13.35978) QuantErr: 13.35978 batch_time=0.45347 
Train Epoch: 48 [866/1000 27712/32000 (87%)] Loss: 0.18531 (QuantReg: 13.70249) QuantErr: 13.70249 batch_time=0.41728 
Train Epoch: 48 [871/1000 27872/32000 (87%)] Loss: 0.61767 (QuantReg: 13.40010) QuantErr: 13.40010 batch_time=0.37997 
Train Epoch: 48 [876/1000 28032/32000 (88%)] Loss: 0.15431 (QuantReg: 13.51358) QuantErr: 13.51358 batch_time=0.39097 
Train Epoch: 48 [881/1000 28192/32000 (88%)] Loss: 0.30097 (QuantReg: 13.52316) QuantErr: 13.52316 batch_time=0.45587 
Train Epoch: 48 [886/1000 28352/32000 (89%)] Loss: 0.10469 (QuantReg: 13.93550) QuantErr: 13.93550 batch_time=0.37564 
Train Epoch: 48 [891/1000 28512/32000 (89%)] Loss: 0.18969 (QuantReg: 13.46195) QuantErr: 13.46195 batch_time=0.34721 
Train Epoch: 48 [896/1000 28672/32000 (90%)] Loss: 0.35784 (QuantReg: 13.61407) QuantErr: 13.61407 batch_time=0.35989 
Train Epoch: 48 [901/1000 28832/32000 (90%)] Loss: 0.37522 (QuantReg: 13.07832) QuantErr: 13.07832 batch_time=0.35035 
Train Epoch: 48 [906/1000 28992/32000 (91%)] Loss: 0.16276 (QuantReg: 13.65756) QuantErr: 13.65756 batch_time=0.44359 
Train Epoch: 48 [911/1000 29152/32000 (91%)] Loss: 0.24390 (QuantReg: 13.69693) QuantErr: 13.69693 batch_time=0.37655 
Train Epoch: 48 [916/1000 29312/32000 (92%)] Loss: 0.57728 (QuantReg: 13.58690) QuantErr: 13.58690 batch_time=0.39921 
Train Epoch: 48 [921/1000 29472/32000 (92%)] Loss: 0.42073 (QuantReg: 13.33155) QuantErr: 13.33155 batch_time=0.36199 
Train Epoch: 48 [926/1000 29632/32000 (93%)] Loss: 0.32236 (QuantReg: 12.94117) QuantErr: 12.94117 batch_time=0.37518 
Train Epoch: 48 [931/1000 29792/32000 (93%)] Loss: 0.31710 (QuantReg: 13.38581) QuantErr: 13.38581 batch_time=0.36455 
Train Epoch: 48 [936/1000 29952/32000 (94%)] Loss: 0.30592 (QuantReg: 13.46821) QuantErr: 13.46821 batch_time=0.35794 
Train Epoch: 48 [941/1000 30112/32000 (94%)] Loss: 0.20083 (QuantReg: 13.18318) QuantErr: 13.18318 batch_time=0.36157 
Train Epoch: 48 [946/1000 30272/32000 (95%)] Loss: 0.39055 (QuantReg: 12.96480) QuantErr: 12.96480 batch_time=0.35896 
Train Epoch: 48 [951/1000 30432/32000 (95%)] Loss: 0.23878 (QuantReg: 13.57683) QuantErr: 13.57683 batch_time=0.41772 
Train Epoch: 48 [956/1000 30592/32000 (96%)] Loss: 0.53695 (QuantReg: 12.49982) QuantErr: 12.49982 batch_time=0.46122 
Train Epoch: 48 [961/1000 30752/32000 (96%)] Loss: 0.52979 (QuantReg: 12.99423) QuantErr: 12.99423 batch_time=0.41131 
Train Epoch: 48 [966/1000 30912/32000 (97%)] Loss: 0.20480 (QuantReg: 14.04691) QuantErr: 14.04691 batch_time=0.49060 
Train Epoch: 48 [971/1000 31072/32000 (97%)] Loss: 0.26816 (QuantReg: 13.57215) QuantErr: 13.57215 batch_time=0.35752 
Train Epoch: 48 [976/1000 31232/32000 (98%)] Loss: 0.13349 (QuantReg: 13.47396) QuantErr: 13.47396 batch_time=0.93569 
Train Epoch: 48 [981/1000 31392/32000 (98%)] Loss: 0.23065 (QuantReg: 13.17801) QuantErr: 13.17801 batch_time=0.36408 
Train Epoch: 48 [986/1000 31552/32000 (99%)] Loss: 0.38610 (QuantReg: 13.30840) QuantErr: 13.30840 batch_time=0.46684 
Train Epoch: 48 [991/1000 31712/32000 (99%)] Loss: 0.15193 (QuantReg: 13.76404) QuantErr: 13.76404 batch_time=0.42543 
Train Epoch: 48 [996/1000 31872/32000 (100%)] Loss: 0.38625 (QuantReg: 13.46279) QuantErr: 13.46279 batch_time=0.39932 
Train Epoch: 48 codebook_update_time=1.74895
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch48.pth ...
Done in 14.023s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 0.3062266915254295
 quant_reg      : 13.336890204429626
 quant_err      : 13.336890204429626
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 48000
 MSRVTT_miech_test/t2v_metrics/R1: 21.5
 MSRVTT_miech_test/t2v_metrics/R5: 51.2
 MSRVTT_miech_test/t2v_metrics/R10: 63.9
 MSRVTT_miech_test/t2v_metrics/R50: 86.8
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 33.028
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.27968992015142
 MSRVTT_miech_test/v2t_metrics/R1: 22.7
 MSRVTT_miech_test/v2t_metrics/R5: 53.5
 MSRVTT_miech_test/v2t_metrics/R10: 65.2
 MSRVTT_miech_test/v2t_metrics/R50: 88.5
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.817
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.9413550642181
 mnt_best       : 41.54284538121151
 not_improved_count: 2
Train Epoch: 49 [1/1000 32/32000 (0%)] Loss: 0.19255 (QuantReg: 13.72061) QuantErr: 13.72061 batch_time=29.48250 
Train Epoch: 49 [6/1000 192/32000 (1%)] Loss: 0.44837 (QuantReg: 13.81685) QuantErr: 13.81685 batch_time=0.42196 
Train Epoch: 49 [11/1000 352/32000 (1%)] Loss: 0.21075 (QuantReg: 12.05131) QuantErr: 12.05131 batch_time=0.38301 
Train Epoch: 49 [16/1000 512/32000 (2%)] Loss: 0.24752 (QuantReg: 13.79779) QuantErr: 13.79779 batch_time=0.35544 
Train Epoch: 49 [21/1000 672/32000 (2%)] Loss: 0.33463 (QuantReg: 13.21029) QuantErr: 13.21029 batch_time=0.34516 
Train Epoch: 49 [26/1000 832/32000 (3%)] Loss: 0.14213 (QuantReg: 13.83329) QuantErr: 13.83329 batch_time=0.37536 
Train Epoch: 49 [31/1000 992/32000 (3%)] Loss: 0.23671 (QuantReg: 13.38566) QuantErr: 13.38566 batch_time=0.58962 
Train Epoch: 49 [36/1000 1152/32000 (4%)] Loss: 0.63050 (QuantReg: 12.73845) QuantErr: 12.73845 batch_time=0.38794 
Train Epoch: 49 [41/1000 1312/32000 (4%)] Loss: 0.58202 (QuantReg: 13.16322) QuantErr: 13.16322 batch_time=0.39823 
Train Epoch: 49 [46/1000 1472/32000 (5%)] Loss: 0.41964 (QuantReg: 13.27086) QuantErr: 13.27086 batch_time=0.59292 
Train Epoch: 49 [51/1000 1632/32000 (5%)] Loss: 0.39356 (QuantReg: 13.35673) QuantErr: 13.35673 batch_time=0.39855 
Train Epoch: 49 [56/1000 1792/32000 (6%)] Loss: 0.34624 (QuantReg: 13.26070) QuantErr: 13.26070 batch_time=0.58670 
Train Epoch: 49 [61/1000 1952/32000 (6%)] Loss: 0.41469 (QuantReg: 12.90458) QuantErr: 12.90458 batch_time=0.40911 
Train Epoch: 49 [66/1000 2112/32000 (7%)] Loss: 0.14679 (QuantReg: 13.06812) QuantErr: 13.06812 batch_time=0.39333 
Train Epoch: 49 [71/1000 2272/32000 (7%)] Loss: 0.36010 (QuantReg: 13.50143) QuantErr: 13.50143 batch_time=0.43173 
Train Epoch: 49 [76/1000 2432/32000 (8%)] Loss: 0.46032 (QuantReg: 12.41055) QuantErr: 12.41055 batch_time=0.37249 
Train Epoch: 49 [81/1000 2592/32000 (8%)] Loss: 0.35046 (QuantReg: 13.39196) QuantErr: 13.39196 batch_time=0.40274 
Train Epoch: 49 [86/1000 2752/32000 (9%)] Loss: 0.25410 (QuantReg: 12.69726) QuantErr: 12.69726 batch_time=0.45121 
Train Epoch: 49 [91/1000 2912/32000 (9%)] Loss: 0.10362 (QuantReg: 13.65598) QuantErr: 13.65598 batch_time=0.57096 
Train Epoch: 49 [96/1000 3072/32000 (10%)] Loss: 0.17743 (QuantReg: 13.54308) QuantErr: 13.54308 batch_time=0.40114 
Train Epoch: 49 [101/1000 3232/32000 (10%)] Loss: 0.36463 (QuantReg: 13.76120) QuantErr: 13.76120 batch_time=0.56622 
Train Epoch: 49 [106/1000 3392/32000 (11%)] Loss: 0.22723 (QuantReg: 13.24297) QuantErr: 13.24297 batch_time=0.44543 
Train Epoch: 49 [111/1000 3552/32000 (11%)] Loss: 0.21264 (QuantReg: 13.67898) QuantErr: 13.67898 batch_time=0.46005 
Train Epoch: 49 [116/1000 3712/32000 (12%)] Loss: 0.23097 (QuantReg: 13.60956) QuantErr: 13.60956 batch_time=0.46893 
Train Epoch: 49 [121/1000 3872/32000 (12%)] Loss: 0.33276 (QuantReg: 13.58090) QuantErr: 13.58090 batch_time=0.45126 
Train Epoch: 49 [126/1000 4032/32000 (13%)] Loss: 0.45926 (QuantReg: 13.18307) QuantErr: 13.18307 batch_time=0.37927 
Train Epoch: 49 [131/1000 4192/32000 (13%)] Loss: 0.24477 (QuantReg: 12.83394) QuantErr: 12.83394 batch_time=0.49712 
Train Epoch: 49 [136/1000 4352/32000 (14%)] Loss: 0.33213 (QuantReg: 13.29145) QuantErr: 13.29145 batch_time=0.36826 
Train Epoch: 49 [141/1000 4512/32000 (14%)] Loss: 0.81661 (QuantReg: 13.28276) QuantErr: 13.28276 batch_time=0.41013 
Train Epoch: 49 [146/1000 4672/32000 (15%)] Loss: 0.11842 (QuantReg: 13.27885) QuantErr: 13.27885 batch_time=0.59714 
Train Epoch: 49 [151/1000 4832/32000 (15%)] Loss: 0.31935 (QuantReg: 13.43180) QuantErr: 13.43180 batch_time=2.39950 
Train Epoch: 49 [156/1000 4992/32000 (16%)] Loss: 0.34355 (QuantReg: 12.94198) QuantErr: 12.94198 batch_time=0.49598 
Train Epoch: 49 [161/1000 5152/32000 (16%)] Loss: 0.30932 (QuantReg: 12.63778) QuantErr: 12.63778 batch_time=0.40213 
Train Epoch: 49 [166/1000 5312/32000 (17%)] Loss: 0.33771 (QuantReg: 13.68123) QuantErr: 13.68123 batch_time=0.40445 
Train Epoch: 49 [171/1000 5472/32000 (17%)] Loss: 0.10554 (QuantReg: 13.66012) QuantErr: 13.66012 batch_time=0.39243 
Train Epoch: 49 [176/1000 5632/32000 (18%)] Loss: 0.14687 (QuantReg: 13.36318) QuantErr: 13.36318 batch_time=0.39833 
Train Epoch: 49 [181/1000 5792/32000 (18%)] Loss: 0.45635 (QuantReg: 13.38206) QuantErr: 13.38206 batch_time=0.44280 
Train Epoch: 49 [186/1000 5952/32000 (19%)] Loss: 0.31887 (QuantReg: 13.13716) QuantErr: 13.13716 batch_time=0.42679 
Train Epoch: 49 [191/1000 6112/32000 (19%)] Loss: 0.31263 (QuantReg: 13.36244) QuantErr: 13.36244 batch_time=0.39142 
Train Epoch: 49 [196/1000 6272/32000 (20%)] Loss: 0.41479 (QuantReg: 13.46167) QuantErr: 13.46167 batch_time=0.39117 
Train Epoch: 49 [201/1000 6432/32000 (20%)] Loss: 0.47067 (QuantReg: 12.80115) QuantErr: 12.80115 batch_time=0.58228 
Train Epoch: 49 [206/1000 6592/32000 (21%)] Loss: 0.20028 (QuantReg: 12.80347) QuantErr: 12.80347 batch_time=0.38474 
Train Epoch: 49 [211/1000 6752/32000 (21%)] Loss: 0.39534 (QuantReg: 13.40386) QuantErr: 13.40386 batch_time=0.41282 
Train Epoch: 49 [216/1000 6912/32000 (22%)] Loss: 0.20312 (QuantReg: 13.25723) QuantErr: 13.25723 batch_time=0.38034 
Train Epoch: 49 [221/1000 7072/32000 (22%)] Loss: 0.21528 (QuantReg: 13.32784) QuantErr: 13.32784 batch_time=0.40684 
Train Epoch: 49 [226/1000 7232/32000 (23%)] Loss: 0.44002 (QuantReg: 13.25025) QuantErr: 13.25025 batch_time=0.39830 
Train Epoch: 49 [231/1000 7392/32000 (23%)] Loss: 0.17190 (QuantReg: 13.24498) QuantErr: 13.24498 batch_time=0.41573 
Train Epoch: 49 [236/1000 7552/32000 (24%)] Loss: 0.41352 (QuantReg: 13.32562) QuantErr: 13.32562 batch_time=0.40400 
Train Epoch: 49 [241/1000 7712/32000 (24%)] Loss: 0.49787 (QuantReg: 13.26783) QuantErr: 13.26783 batch_time=0.35534 
Train Epoch: 49 [246/1000 7872/32000 (25%)] Loss: 0.36992 (QuantReg: 13.78067) QuantErr: 13.78067 batch_time=0.41836 
Train Epoch: 49 [251/1000 8032/32000 (25%)] Loss: 0.32456 (QuantReg: 13.85094) QuantErr: 13.85094 batch_time=0.53785 
Train Epoch: 49 [256/1000 8192/32000 (26%)] Loss: 0.19909 (QuantReg: 13.66475) QuantErr: 13.66475 batch_time=0.42662 
Train Epoch: 49 [261/1000 8352/32000 (26%)] Loss: 0.08065 (QuantReg: 13.70053) QuantErr: 13.70053 batch_time=0.35445 
Train Epoch: 49 [266/1000 8512/32000 (27%)] Loss: 0.08395 (QuantReg: 13.07204) QuantErr: 13.07204 batch_time=0.38657 
Train Epoch: 49 [271/1000 8672/32000 (27%)] Loss: 0.38068 (QuantReg: 13.80064) QuantErr: 13.80064 batch_time=0.45709 
Train Epoch: 49 [276/1000 8832/32000 (28%)] Loss: 0.25657 (QuantReg: 13.18987) QuantErr: 13.18987 batch_time=0.50089 
Train Epoch: 49 [281/1000 8992/32000 (28%)] Loss: 0.27916 (QuantReg: 13.41070) QuantErr: 13.41070 batch_time=0.37395 
Train Epoch: 49 [286/1000 9152/32000 (29%)] Loss: 0.16228 (QuantReg: 13.71628) QuantErr: 13.71628 batch_time=0.53430 
Train Epoch: 49 [291/1000 9312/32000 (29%)] Loss: 0.16644 (QuantReg: 13.55507) QuantErr: 13.55507 batch_time=0.51219 
Train Epoch: 49 [296/1000 9472/32000 (30%)] Loss: 0.32469 (QuantReg: 13.55813) QuantErr: 13.55813 batch_time=0.40045 
Train Epoch: 49 [301/1000 9632/32000 (30%)] Loss: 0.23581 (QuantReg: 13.40870) QuantErr: 13.40870 batch_time=0.37080 
Train Epoch: 49 [306/1000 9792/32000 (31%)] Loss: 0.23849 (QuantReg: 13.90131) QuantErr: 13.90131 batch_time=0.41916 
Train Epoch: 49 [311/1000 9952/32000 (31%)] Loss: 0.09701 (QuantReg: 13.25929) QuantErr: 13.25929 batch_time=0.61854 
Train Epoch: 49 [316/1000 10112/32000 (32%)] Loss: 0.59212 (QuantReg: 13.03175) QuantErr: 13.03175 batch_time=0.38795 
Train Epoch: 49 [321/1000 10272/32000 (32%)] Loss: 0.70005 (QuantReg: 13.67714) QuantErr: 13.67714 batch_time=0.37289 
Train Epoch: 49 [326/1000 10432/32000 (33%)] Loss: 0.31975 (QuantReg: 13.52634) QuantErr: 13.52634 batch_time=0.37964 
Train Epoch: 49 [331/1000 10592/32000 (33%)] Loss: 0.09927 (QuantReg: 13.69249) QuantErr: 13.69249 batch_time=0.59264 
Train Epoch: 49 [336/1000 10752/32000 (34%)] Loss: 0.33393 (QuantReg: 13.37581) QuantErr: 13.37581 batch_time=0.52672 
Train Epoch: 49 [341/1000 10912/32000 (34%)] Loss: 0.08773 (QuantReg: 13.25825) QuantErr: 13.25825 batch_time=0.45921 
Train Epoch: 49 [346/1000 11072/32000 (35%)] Loss: 0.19137 (QuantReg: 13.03178) QuantErr: 13.03178 batch_time=0.37073 
Train Epoch: 49 [351/1000 11232/32000 (35%)] Loss: 0.26000 (QuantReg: 13.20578) QuantErr: 13.20578 batch_time=0.36866 
Train Epoch: 49 [356/1000 11392/32000 (36%)] Loss: 0.18896 (QuantReg: 13.10618) QuantErr: 13.10618 batch_time=0.35428 
Train Epoch: 49 [361/1000 11552/32000 (36%)] Loss: 0.31607 (QuantReg: 13.55970) QuantErr: 13.55970 batch_time=0.39792 
Train Epoch: 49 [366/1000 11712/32000 (37%)] Loss: 0.18814 (QuantReg: 13.69289) QuantErr: 13.69289 batch_time=0.38813 
Train Epoch: 49 [371/1000 11872/32000 (37%)] Loss: 0.29092 (QuantReg: 13.45491) QuantErr: 13.45491 batch_time=0.50460 
Train Epoch: 49 [376/1000 12032/32000 (38%)] Loss: 0.47114 (QuantReg: 13.48478) QuantErr: 13.48478 batch_time=0.59842 
Train Epoch: 49 [381/1000 12192/32000 (38%)] Loss: 0.17833 (QuantReg: 13.32393) QuantErr: 13.32393 batch_time=0.36724 
Train Epoch: 49 [386/1000 12352/32000 (39%)] Loss: 0.37729 (QuantReg: 13.66240) QuantErr: 13.66240 batch_time=0.37937 
Train Epoch: 49 [391/1000 12512/32000 (39%)] Loss: 0.45111 (QuantReg: 13.12215) QuantErr: 13.12215 batch_time=0.35445 
Train Epoch: 49 [396/1000 12672/32000 (40%)] Loss: 0.20893 (QuantReg: 13.73480) QuantErr: 13.73480 batch_time=0.35580 
Train Epoch: 49 [401/1000 12832/32000 (40%)] Loss: 0.24431 (QuantReg: 13.22872) QuantErr: 13.22872 batch_time=0.42420 
Train Epoch: 49 [406/1000 12992/32000 (41%)] Loss: 0.14489 (QuantReg: 13.29115) QuantErr: 13.29115 batch_time=2.59845 
Train Epoch: 49 [411/1000 13152/32000 (41%)] Loss: 0.13922 (QuantReg: 12.80421) QuantErr: 12.80421 batch_time=0.45618 
Train Epoch: 49 [416/1000 13312/32000 (42%)] Loss: 0.22426 (QuantReg: 13.67642) QuantErr: 13.67642 batch_time=0.39811 
Train Epoch: 49 [421/1000 13472/32000 (42%)] Loss: 0.26522 (QuantReg: 13.96306) QuantErr: 13.96306 batch_time=0.38727 
Train Epoch: 49 [426/1000 13632/32000 (43%)] Loss: 0.29348 (QuantReg: 13.63885) QuantErr: 13.63885 batch_time=0.42039 
Train Epoch: 49 [431/1000 13792/32000 (43%)] Loss: 0.49879 (QuantReg: 12.68888) QuantErr: 12.68888 batch_time=0.51587 
Train Epoch: 49 [436/1000 13952/32000 (44%)] Loss: 0.40592 (QuantReg: 12.73767) QuantErr: 12.73767 batch_time=0.47143 
Train Epoch: 49 [441/1000 14112/32000 (44%)] Loss: 0.15862 (QuantReg: 13.63021) QuantErr: 13.63021 batch_time=0.51365 
Train Epoch: 49 [446/1000 14272/32000 (45%)] Loss: 0.25247 (QuantReg: 13.45337) QuantErr: 13.45337 batch_time=0.45060 
Train Epoch: 49 [451/1000 14432/32000 (45%)] Loss: 0.10663 (QuantReg: 13.46499) QuantErr: 13.46499 batch_time=0.45708 
Train Epoch: 49 [456/1000 14592/32000 (46%)] Loss: 0.23513 (QuantReg: 13.67330) QuantErr: 13.67330 batch_time=0.38967 
Train Epoch: 49 [461/1000 14752/32000 (46%)] Loss: 0.34469 (QuantReg: 13.15370) QuantErr: 13.15370 batch_time=0.41754 
Train Epoch: 49 [466/1000 14912/32000 (47%)] Loss: 0.27735 (QuantReg: 13.55614) QuantErr: 13.55614 batch_time=0.37462 
Train Epoch: 49 [471/1000 15072/32000 (47%)] Loss: 0.21994 (QuantReg: 13.06104) QuantErr: 13.06104 batch_time=0.35600 
Train Epoch: 49 [476/1000 15232/32000 (48%)] Loss: 0.20934 (QuantReg: 14.06334) QuantErr: 14.06334 batch_time=0.38134 
Train Epoch: 49 [481/1000 15392/32000 (48%)] Loss: 0.32338 (QuantReg: 13.22876) QuantErr: 13.22876 batch_time=0.36453 
Train Epoch: 49 [486/1000 15552/32000 (49%)] Loss: 0.08708 (QuantReg: 13.82088) QuantErr: 13.82088 batch_time=0.37580 
Train Epoch: 49 [491/1000 15712/32000 (49%)] Loss: 0.54666 (QuantReg: 13.21453) QuantErr: 13.21453 batch_time=0.38991 
Train Epoch: 49 [496/1000 15872/32000 (50%)] Loss: 0.40509 (QuantReg: 13.50425) QuantErr: 13.50425 batch_time=0.35909 
Train Epoch: 49 [501/1000 16032/32000 (50%)] Loss: 0.11155 (QuantReg: 13.60318) QuantErr: 13.60318 batch_time=0.34447 
Train Epoch: 49 [506/1000 16192/32000 (51%)] Loss: 0.22195 (QuantReg: 13.42802) QuantErr: 13.42802 batch_time=0.36069 
Train Epoch: 49 [511/1000 16352/32000 (51%)] Loss: 0.52867 (QuantReg: 12.72087) QuantErr: 12.72087 batch_time=0.37055 
Train Epoch: 49 [516/1000 16512/32000 (52%)] Loss: 0.40561 (QuantReg: 13.89141) QuantErr: 13.89141 batch_time=0.35562 
Train Epoch: 49 [521/1000 16672/32000 (52%)] Loss: 0.15242 (QuantReg: 13.21734) QuantErr: 13.21734 batch_time=0.34334 
Train Epoch: 49 [526/1000 16832/32000 (53%)] Loss: 0.40126 (QuantReg: 13.63155) QuantErr: 13.63155 batch_time=0.37204 
Train Epoch: 49 [531/1000 16992/32000 (53%)] Loss: 0.08480 (QuantReg: 13.52620) QuantErr: 13.52620 batch_time=0.36278 
Train Epoch: 49 [536/1000 17152/32000 (54%)] Loss: 0.10811 (QuantReg: 13.22095) QuantErr: 13.22095 batch_time=0.34751 
Train Epoch: 49 [541/1000 17312/32000 (54%)] Loss: 0.26191 (QuantReg: 12.98575) QuantErr: 12.98575 batch_time=0.34266 
Train Epoch: 49 [546/1000 17472/32000 (55%)] Loss: 0.15278 (QuantReg: 13.31691) QuantErr: 13.31691 batch_time=0.35207 
Train Epoch: 49 [551/1000 17632/32000 (55%)] Loss: 0.17476 (QuantReg: 13.79793) QuantErr: 13.79793 batch_time=0.35235 
Train Epoch: 49 [556/1000 17792/32000 (56%)] Loss: 0.55177 (QuantReg: 13.78413) QuantErr: 13.78413 batch_time=0.34923 
Train Epoch: 49 [561/1000 17952/32000 (56%)] Loss: 0.37877 (QuantReg: 13.06540) QuantErr: 13.06540 batch_time=0.34738 
Train Epoch: 49 [566/1000 18112/32000 (57%)] Loss: 0.35116 (QuantReg: 12.87572) QuantErr: 12.87572 batch_time=0.37354 
Train Epoch: 49 [571/1000 18272/32000 (57%)] Loss: 0.28123 (QuantReg: 12.92522) QuantErr: 12.92522 batch_time=0.40046 
Train Epoch: 49 [576/1000 18432/32000 (58%)] Loss: 0.34287 (QuantReg: 13.31987) QuantErr: 13.31987 batch_time=0.38093 
Train Epoch: 49 [581/1000 18592/32000 (58%)] Loss: 0.53178 (QuantReg: 12.90140) QuantErr: 12.90140 batch_time=1.78487 
Train Epoch: 49 [586/1000 18752/32000 (59%)] Loss: 0.27210 (QuantReg: 14.12272) QuantErr: 14.12272 batch_time=0.49802 
Train Epoch: 49 [591/1000 18912/32000 (59%)] Loss: 0.17536 (QuantReg: 13.86240) QuantErr: 13.86240 batch_time=0.48560 
Train Epoch: 49 [596/1000 19072/32000 (60%)] Loss: 0.22492 (QuantReg: 13.64393) QuantErr: 13.64393 batch_time=0.37320 
Train Epoch: 49 [601/1000 19232/32000 (60%)] Loss: 0.47047 (QuantReg: 13.17242) QuantErr: 13.17242 batch_time=0.39726 
Train Epoch: 49 [606/1000 19392/32000 (61%)] Loss: 0.25583 (QuantReg: 13.67240) QuantErr: 13.67240 batch_time=0.37513 
Train Epoch: 49 [611/1000 19552/32000 (61%)] Loss: 0.24182 (QuantReg: 13.16008) QuantErr: 13.16008 batch_time=0.39200 
Train Epoch: 49 [616/1000 19712/32000 (62%)] Loss: 0.36397 (QuantReg: 13.51582) QuantErr: 13.51582 batch_time=0.36010 
Train Epoch: 49 [621/1000 19872/32000 (62%)] Loss: 0.32378 (QuantReg: 13.47463) QuantErr: 13.47463 batch_time=0.35729 
Train Epoch: 49 [626/1000 20032/32000 (63%)] Loss: 0.27304 (QuantReg: 13.69407) QuantErr: 13.69407 batch_time=0.36592 
Train Epoch: 49 [631/1000 20192/32000 (63%)] Loss: 0.30441 (QuantReg: 13.46669) QuantErr: 13.46669 batch_time=0.38919 
Train Epoch: 49 [636/1000 20352/32000 (64%)] Loss: 0.21211 (QuantReg: 13.64939) QuantErr: 13.64939 batch_time=0.44116 
Train Epoch: 49 [641/1000 20512/32000 (64%)] Loss: 0.34365 (QuantReg: 14.11104) QuantErr: 14.11104 batch_time=0.43254 
Train Epoch: 49 [646/1000 20672/32000 (65%)] Loss: 0.37094 (QuantReg: 13.46725) QuantErr: 13.46725 batch_time=0.52869 
Train Epoch: 49 [651/1000 20832/32000 (65%)] Loss: 0.09081 (QuantReg: 13.62865) QuantErr: 13.62865 batch_time=0.57049 
Train Epoch: 49 [656/1000 20992/32000 (66%)] Loss: 0.55740 (QuantReg: 13.10108) QuantErr: 13.10108 batch_time=0.57595 
Train Epoch: 49 [661/1000 21152/32000 (66%)] Loss: 0.19121 (QuantReg: 13.54758) QuantErr: 13.54758 batch_time=0.44794 
Train Epoch: 49 [666/1000 21312/32000 (67%)] Loss: 0.38772 (QuantReg: 13.54013) QuantErr: 13.54013 batch_time=0.35941 
Train Epoch: 49 [671/1000 21472/32000 (67%)] Loss: 0.24418 (QuantReg: 13.71877) QuantErr: 13.71877 batch_time=0.45205 
Train Epoch: 49 [676/1000 21632/32000 (68%)] Loss: 0.41849 (QuantReg: 13.88681) QuantErr: 13.88681 batch_time=0.38073 
Train Epoch: 49 [681/1000 21792/32000 (68%)] Loss: 0.35367 (QuantReg: 13.68780) QuantErr: 13.68780 batch_time=0.46383 
Train Epoch: 49 [686/1000 21952/32000 (69%)] Loss: 0.20863 (QuantReg: 13.33217) QuantErr: 13.33217 batch_time=0.60053 
Train Epoch: 49 [691/1000 22112/32000 (69%)] Loss: 0.13409 (QuantReg: 13.41601) QuantErr: 13.41601 batch_time=0.52765 
Train Epoch: 49 [696/1000 22272/32000 (70%)] Loss: 0.49739 (QuantReg: 13.35932) QuantErr: 13.35932 batch_time=1.36054 
Train Epoch: 49 [701/1000 22432/32000 (70%)] Loss: 0.23034 (QuantReg: 13.17769) QuantErr: 13.17769 batch_time=0.35695 
Train Epoch: 49 [706/1000 22592/32000 (71%)] Loss: 0.32903 (QuantReg: 13.48116) QuantErr: 13.48116 batch_time=0.35877 
Train Epoch: 49 [711/1000 22752/32000 (71%)] Loss: 0.56802 (QuantReg: 13.33930) QuantErr: 13.33930 batch_time=0.37581 
Train Epoch: 49 [716/1000 22912/32000 (72%)] Loss: 0.44721 (QuantReg: 13.93873) QuantErr: 13.93873 batch_time=0.40074 
Train Epoch: 49 [721/1000 23072/32000 (72%)] Loss: 0.08420 (QuantReg: 14.00221) QuantErr: 14.00221 batch_time=0.41047 
Train Epoch: 49 [726/1000 23232/32000 (73%)] Loss: 0.11874 (QuantReg: 13.48745) QuantErr: 13.48745 batch_time=0.72400 
Train Epoch: 49 [731/1000 23392/32000 (73%)] Loss: 0.41445 (QuantReg: 13.86407) QuantErr: 13.86407 batch_time=0.49022 
Train Epoch: 49 [736/1000 23552/32000 (74%)] Loss: 0.22932 (QuantReg: 13.32008) QuantErr: 13.32008 batch_time=0.36606 
Train Epoch: 49 [741/1000 23712/32000 (74%)] Loss: 0.27435 (QuantReg: 12.70159) QuantErr: 12.70159 batch_time=0.39083 
Train Epoch: 49 [746/1000 23872/32000 (75%)] Loss: 0.24658 (QuantReg: 13.19678) QuantErr: 13.19678 batch_time=0.37441 
Train Epoch: 49 [751/1000 24032/32000 (75%)] Loss: 0.34810 (QuantReg: 13.04560) QuantErr: 13.04560 batch_time=0.37238 
Train Epoch: 49 [756/1000 24192/32000 (76%)] Loss: 0.39395 (QuantReg: 13.22774) QuantErr: 13.22774 batch_time=0.41584 
Train Epoch: 49 [761/1000 24352/32000 (76%)] Loss: 0.43801 (QuantReg: 12.75714) QuantErr: 12.75714 batch_time=0.44337 
Train Epoch: 49 [766/1000 24512/32000 (77%)] Loss: 0.49574 (QuantReg: 13.32651) QuantErr: 13.32651 batch_time=0.36788 
Train Epoch: 49 [771/1000 24672/32000 (77%)] Loss: 0.13620 (QuantReg: 13.65869) QuantErr: 13.65869 batch_time=0.41159 
Train Epoch: 49 [776/1000 24832/32000 (78%)] Loss: 0.43279 (QuantReg: 13.41247) QuantErr: 13.41247 batch_time=0.36916 
Train Epoch: 49 [781/1000 24992/32000 (78%)] Loss: 0.61778 (QuantReg: 13.51532) QuantErr: 13.51532 batch_time=0.38095 
Train Epoch: 49 [786/1000 25152/32000 (79%)] Loss: 0.53703 (QuantReg: 13.12899) QuantErr: 13.12899 batch_time=0.77418 
Train Epoch: 49 [791/1000 25312/32000 (79%)] Loss: 0.57722 (QuantReg: 13.32089) QuantErr: 13.32089 batch_time=0.38057 
Train Epoch: 49 [796/1000 25472/32000 (80%)] Loss: 0.56287 (QuantReg: 13.25737) QuantErr: 13.25737 batch_time=0.37648 
Train Epoch: 49 [801/1000 25632/32000 (80%)] Loss: 0.35219 (QuantReg: 13.37133) QuantErr: 13.37133 batch_time=0.37421 
Train Epoch: 49 [806/1000 25792/32000 (81%)] Loss: 0.26088 (QuantReg: 13.47597) QuantErr: 13.47597 batch_time=0.40293 
Train Epoch: 49 [811/1000 25952/32000 (81%)] Loss: 0.26483 (QuantReg: 13.63764) QuantErr: 13.63764 batch_time=0.38338 
Train Epoch: 49 [816/1000 26112/32000 (82%)] Loss: 0.37365 (QuantReg: 13.01858) QuantErr: 13.01858 batch_time=0.39697 
Train Epoch: 49 [821/1000 26272/32000 (82%)] Loss: 0.28923 (QuantReg: 13.20185) QuantErr: 13.20185 batch_time=0.40967 
Train Epoch: 49 [826/1000 26432/32000 (83%)] Loss: 0.32900 (QuantReg: 13.54434) QuantErr: 13.54434 batch_time=0.38678 
Train Epoch: 49 [831/1000 26592/32000 (83%)] Loss: 0.34443 (QuantReg: 13.35457) QuantErr: 13.35457 batch_time=0.41312 
Train Epoch: 49 [836/1000 26752/32000 (84%)] Loss: 0.17196 (QuantReg: 13.29270) QuantErr: 13.29270 batch_time=0.34432 
Train Epoch: 49 [841/1000 26912/32000 (84%)] Loss: 0.18814 (QuantReg: 13.64076) QuantErr: 13.64076 batch_time=0.38534 
Train Epoch: 49 [846/1000 27072/32000 (85%)] Loss: 0.12650 (QuantReg: 13.49196) QuantErr: 13.49196 batch_time=0.37525 
Train Epoch: 49 [851/1000 27232/32000 (85%)] Loss: 0.26099 (QuantReg: 13.13970) QuantErr: 13.13970 batch_time=0.35454 
Train Epoch: 49 [856/1000 27392/32000 (86%)] Loss: 0.19977 (QuantReg: 13.31276) QuantErr: 13.31276 batch_time=0.39767 
Train Epoch: 49 [861/1000 27552/32000 (86%)] Loss: 0.23633 (QuantReg: 13.28737) QuantErr: 13.28737 batch_time=0.35275 
Train Epoch: 49 [866/1000 27712/32000 (87%)] Loss: 0.43408 (QuantReg: 12.63289) QuantErr: 12.63289 batch_time=0.36912 
Train Epoch: 49 [871/1000 27872/32000 (87%)] Loss: 0.21614 (QuantReg: 13.74523) QuantErr: 13.74523 batch_time=0.45917 
Train Epoch: 49 [876/1000 28032/32000 (88%)] Loss: 0.13823 (QuantReg: 12.65889) QuantErr: 12.65889 batch_time=0.42379 
Train Epoch: 49 [881/1000 28192/32000 (88%)] Loss: 0.17541 (QuantReg: 13.20393) QuantErr: 13.20393 batch_time=0.49208 
Train Epoch: 49 [886/1000 28352/32000 (89%)] Loss: 0.19311 (QuantReg: 12.84279) QuantErr: 12.84279 batch_time=0.45823 
Train Epoch: 49 [891/1000 28512/32000 (89%)] Loss: 0.28143 (QuantReg: 12.99229) QuantErr: 12.99229 batch_time=0.39459 
Train Epoch: 49 [896/1000 28672/32000 (90%)] Loss: 0.37662 (QuantReg: 13.01875) QuantErr: 13.01875 batch_time=0.37246 
Train Epoch: 49 [901/1000 28832/32000 (90%)] Loss: 0.14070 (QuantReg: 13.77821) QuantErr: 13.77821 batch_time=0.69344 
Train Epoch: 49 [906/1000 28992/32000 (91%)] Loss: 0.28613 (QuantReg: 13.20101) QuantErr: 13.20101 batch_time=0.38970 
Train Epoch: 49 [911/1000 29152/32000 (91%)] Loss: 0.34915 (QuantReg: 13.32485) QuantErr: 13.32485 batch_time=0.38798 
Train Epoch: 49 [916/1000 29312/32000 (92%)] Loss: 0.19700 (QuantReg: 13.53778) QuantErr: 13.53778 batch_time=0.40708 
Train Epoch: 49 [921/1000 29472/32000 (92%)] Loss: 0.26144 (QuantReg: 13.41818) QuantErr: 13.41818 batch_time=0.42509 
Train Epoch: 49 [926/1000 29632/32000 (93%)] Loss: 0.39725 (QuantReg: 13.41447) QuantErr: 13.41447 batch_time=0.42416 
Train Epoch: 49 [931/1000 29792/32000 (93%)] Loss: 0.18563 (QuantReg: 13.52614) QuantErr: 13.52614 batch_time=0.41434 
Train Epoch: 49 [936/1000 29952/32000 (94%)] Loss: 0.07121 (QuantReg: 13.58062) QuantErr: 13.58062 batch_time=1.03016 
Train Epoch: 49 [941/1000 30112/32000 (94%)] Loss: 0.29600 (QuantReg: 13.86985) QuantErr: 13.86985 batch_time=0.53916 
Train Epoch: 49 [946/1000 30272/32000 (95%)] Loss: 0.30322 (QuantReg: 13.69777) QuantErr: 13.69777 batch_time=0.38758 
Train Epoch: 49 [951/1000 30432/32000 (95%)] Loss: 0.23648 (QuantReg: 13.30783) QuantErr: 13.30783 batch_time=0.38100 
Train Epoch: 49 [956/1000 30592/32000 (96%)] Loss: 0.24173 (QuantReg: 13.66499) QuantErr: 13.66499 batch_time=0.37028 
Train Epoch: 49 [961/1000 30752/32000 (96%)] Loss: 0.18296 (QuantReg: 13.82827) QuantErr: 13.82827 batch_time=0.35442 
Train Epoch: 49 [966/1000 30912/32000 (97%)] Loss: 0.16245 (QuantReg: 13.14466) QuantErr: 13.14466 batch_time=0.36163 
Train Epoch: 49 [971/1000 31072/32000 (97%)] Loss: 0.33225 (QuantReg: 13.00805) QuantErr: 13.00805 batch_time=0.35346 
Train Epoch: 49 [976/1000 31232/32000 (98%)] Loss: 0.11017 (QuantReg: 13.80970) QuantErr: 13.80970 batch_time=0.36891 
Train Epoch: 49 [981/1000 31392/32000 (98%)] Loss: 0.22578 (QuantReg: 13.81916) QuantErr: 13.81916 batch_time=0.38868 
Train Epoch: 49 [986/1000 31552/32000 (99%)] Loss: 0.24375 (QuantReg: 13.46323) QuantErr: 13.46323 batch_time=0.38319 
Train Epoch: 49 [991/1000 31712/32000 (99%)] Loss: 0.06924 (QuantReg: 13.09415) QuantErr: 13.09415 batch_time=0.37709 
Train Epoch: 49 [996/1000 31872/32000 (100%)] Loss: 0.20011 (QuantReg: 13.88921) QuantErr: 13.88921 batch_time=0.38404 
Train Epoch: 49 codebook_update_time=1.98766
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch49.pth ...
Done in 16.885s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch49.pth ...
Done in 22.105s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 0.30072248566523196
 quant_reg      : 13.355284580230713
 quant_err      : 13.355284580230713
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 49000
 MSRVTT_miech_test/t2v_metrics/R1: 22.6
 MSRVTT_miech_test/t2v_metrics/R5: 49.2
 MSRVTT_miech_test/t2v_metrics/R10: 65.1
 MSRVTT_miech_test/t2v_metrics/R50: 87.1
 MSRVTT_miech_test/t2v_metrics/MedR: 6.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.033
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.67588620163152
 MSRVTT_miech_test/v2t_metrics/R1: 21.4
 MSRVTT_miech_test/v2t_metrics/R5: 52.3
 MSRVTT_miech_test/v2t_metrics/R10: 65.9
 MSRVTT_miech_test/v2t_metrics/R50: 88.2
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 28.199
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.93728318943704
 mnt_best       : 41.67588620163152
 not_improved_count: 0
Train Epoch: 50 [1/1000 32/32000 (0%)] Loss: 0.14010 (QuantReg: 13.23452) QuantErr: 13.23452 batch_time=27.76930 
Train Epoch: 50 [6/1000 192/32000 (1%)] Loss: 0.15174 (QuantReg: 13.33857) QuantErr: 13.33857 batch_time=0.40720 
Train Epoch: 50 [11/1000 352/32000 (1%)] Loss: 0.32838 (QuantReg: 13.10691) QuantErr: 13.10691 batch_time=0.42725 
Train Epoch: 50 [16/1000 512/32000 (2%)] Loss: 0.24969 (QuantReg: 13.53177) QuantErr: 13.53177 batch_time=0.75572 
Train Epoch: 50 [21/1000 672/32000 (2%)] Loss: 0.13495 (QuantReg: 13.74708) QuantErr: 13.74708 batch_time=0.38509 
Train Epoch: 50 [26/1000 832/32000 (3%)] Loss: 0.29599 (QuantReg: 13.68590) QuantErr: 13.68590 batch_time=0.38234 
Train Epoch: 50 [31/1000 992/32000 (3%)] Loss: 0.46549 (QuantReg: 13.52783) QuantErr: 13.52783 batch_time=0.41242 
Train Epoch: 50 [36/1000 1152/32000 (4%)] Loss: 0.32451 (QuantReg: 13.68128) QuantErr: 13.68128 batch_time=0.38485 
Train Epoch: 50 [41/1000 1312/32000 (4%)] Loss: 0.20793 (QuantReg: 13.85985) QuantErr: 13.85985 batch_time=0.43926 
Train Epoch: 50 [46/1000 1472/32000 (5%)] Loss: 0.54545 (QuantReg: 13.66779) QuantErr: 13.66779 batch_time=0.40994 
Train Epoch: 50 [51/1000 1632/32000 (5%)] Loss: 0.16469 (QuantReg: 13.32015) QuantErr: 13.32015 batch_time=0.45952 
Train Epoch: 50 [56/1000 1792/32000 (6%)] Loss: 0.23698 (QuantReg: 13.82114) QuantErr: 13.82114 batch_time=0.37984 
Train Epoch: 50 [61/1000 1952/32000 (6%)] Loss: 0.18127 (QuantReg: 13.63102) QuantErr: 13.63102 batch_time=0.43441 
Train Epoch: 50 [66/1000 2112/32000 (7%)] Loss: 0.42469 (QuantReg: 12.96747) QuantErr: 12.96747 batch_time=0.37633 
Train Epoch: 50 [71/1000 2272/32000 (7%)] Loss: 0.29224 (QuantReg: 13.69059) QuantErr: 13.69059 batch_time=0.51499 
Train Epoch: 50 [76/1000 2432/32000 (8%)] Loss: 0.37973 (QuantReg: 13.11486) QuantErr: 13.11486 batch_time=0.40657 
Train Epoch: 50 [81/1000 2592/32000 (8%)] Loss: 0.31621 (QuantReg: 13.52403) QuantErr: 13.52403 batch_time=0.56931 
Train Epoch: 50 [86/1000 2752/32000 (9%)] Loss: 0.37235 (QuantReg: 14.14425) QuantErr: 14.14425 batch_time=0.42800 
Train Epoch: 50 [91/1000 2912/32000 (9%)] Loss: 0.13968 (QuantReg: 13.68235) QuantErr: 13.68235 batch_time=0.37794 
Train Epoch: 50 [96/1000 3072/32000 (10%)] Loss: 0.12542 (QuantReg: 13.74520) QuantErr: 13.74520 batch_time=0.38067 
Train Epoch: 50 [101/1000 3232/32000 (10%)] Loss: 0.25157 (QuantReg: 12.88971) QuantErr: 12.88971 batch_time=0.42994 
Train Epoch: 50 [106/1000 3392/32000 (11%)] Loss: 0.29203 (QuantReg: 13.46988) QuantErr: 13.46988 batch_time=0.37563 
Train Epoch: 50 [111/1000 3552/32000 (11%)] Loss: 0.21373 (QuantReg: 13.50133) QuantErr: 13.50133 batch_time=0.37048 
Train Epoch: 50 [116/1000 3712/32000 (12%)] Loss: 0.31156 (QuantReg: 13.44842) QuantErr: 13.44842 batch_time=0.38823 
Train Epoch: 50 [121/1000 3872/32000 (12%)] Loss: 0.38867 (QuantReg: 13.45127) QuantErr: 13.45127 batch_time=0.47874 
Train Epoch: 50 [126/1000 4032/32000 (13%)] Loss: 0.18235 (QuantReg: 13.11760) QuantErr: 13.11760 batch_time=0.40696 
Train Epoch: 50 [131/1000 4192/32000 (13%)] Loss: 0.14437 (QuantReg: 13.62336) QuantErr: 13.62336 batch_time=0.39347 
Train Epoch: 50 [136/1000 4352/32000 (14%)] Loss: 0.28344 (QuantReg: 13.49489) QuantErr: 13.49489 batch_time=0.37540 
Train Epoch: 50 [141/1000 4512/32000 (14%)] Loss: 0.34295 (QuantReg: 13.20804) QuantErr: 13.20804 batch_time=0.38323 
Train Epoch: 50 [146/1000 4672/32000 (15%)] Loss: 0.31396 (QuantReg: 12.96603) QuantErr: 12.96603 batch_time=0.42888 
Train Epoch: 50 [151/1000 4832/32000 (15%)] Loss: 0.23941 (QuantReg: 13.68740) QuantErr: 13.68740 batch_time=0.39391 
Train Epoch: 50 [156/1000 4992/32000 (16%)] Loss: 0.28511 (QuantReg: 14.03135) QuantErr: 14.03135 batch_time=0.40238 
Train Epoch: 50 [161/1000 5152/32000 (16%)] Loss: 0.20733 (QuantReg: 13.34901) QuantErr: 13.34901 batch_time=0.38325 
Train Epoch: 50 [166/1000 5312/32000 (17%)] Loss: 0.26452 (QuantReg: 13.52262) QuantErr: 13.52262 batch_time=0.36948 
Train Epoch: 50 [171/1000 5472/32000 (17%)] Loss: 0.16521 (QuantReg: 13.29834) QuantErr: 13.29834 batch_time=0.37491 
Train Epoch: 50 [176/1000 5632/32000 (18%)] Loss: 0.47039 (QuantReg: 13.18055) QuantErr: 13.18055 batch_time=0.37768 
Train Epoch: 50 [181/1000 5792/32000 (18%)] Loss: 0.35344 (QuantReg: 12.76830) QuantErr: 12.76830 batch_time=0.47639 
Train Epoch: 50 [186/1000 5952/32000 (19%)] Loss: 0.51218 (QuantReg: 13.29076) QuantErr: 13.29076 batch_time=0.42912 
Train Epoch: 50 [191/1000 6112/32000 (19%)] Loss: 0.35313 (QuantReg: 13.67246) QuantErr: 13.67246 batch_time=0.39221 
Train Epoch: 50 [196/1000 6272/32000 (20%)] Loss: 0.21673 (QuantReg: 13.36348) QuantErr: 13.36348 batch_time=0.37808 
Train Epoch: 50 [201/1000 6432/32000 (20%)] Loss: 0.30253 (QuantReg: 13.23935) QuantErr: 13.23935 batch_time=0.38291 
Train Epoch: 50 [206/1000 6592/32000 (21%)] Loss: 0.29588 (QuantReg: 13.46870) QuantErr: 13.46870 batch_time=0.39569 
Train Epoch: 50 [211/1000 6752/32000 (21%)] Loss: 0.29861 (QuantReg: 12.90438) QuantErr: 12.90438 batch_time=0.42443 
Train Epoch: 50 [216/1000 6912/32000 (22%)] Loss: 0.25828 (QuantReg: 13.56934) QuantErr: 13.56934 batch_time=0.40260 
Train Epoch: 50 [221/1000 7072/32000 (22%)] Loss: 0.34138 (QuantReg: 13.70575) QuantErr: 13.70575 batch_time=0.35373 
Train Epoch: 50 [226/1000 7232/32000 (23%)] Loss: 0.54316 (QuantReg: 13.44460) QuantErr: 13.44460 batch_time=0.45152 
Train Epoch: 50 [231/1000 7392/32000 (23%)] Loss: 0.19745 (QuantReg: 13.36606) QuantErr: 13.36606 batch_time=1.29979 
Train Epoch: 50 [236/1000 7552/32000 (24%)] Loss: 0.37856 (QuantReg: 13.30948) QuantErr: 13.30948 batch_time=0.38286 
Train Epoch: 50 [241/1000 7712/32000 (24%)] Loss: 0.15263 (QuantReg: 13.46602) QuantErr: 13.46602 batch_time=0.38162 
Train Epoch: 50 [246/1000 7872/32000 (25%)] Loss: 0.77043 (QuantReg: 12.86351) QuantErr: 12.86351 batch_time=0.43572 
Train Epoch: 50 [251/1000 8032/32000 (25%)] Loss: 0.13105 (QuantReg: 13.55498) QuantErr: 13.55498 batch_time=0.45734 
Train Epoch: 50 [256/1000 8192/32000 (26%)] Loss: 0.20147 (QuantReg: 13.49226) QuantErr: 13.49226 batch_time=0.45333 
Train Epoch: 50 [261/1000 8352/32000 (26%)] Loss: 0.16305 (QuantReg: 13.69811) QuantErr: 13.69811 batch_time=0.44895 
Train Epoch: 50 [266/1000 8512/32000 (27%)] Loss: 0.29707 (QuantReg: 13.12358) QuantErr: 13.12358 batch_time=0.40425 
Train Epoch: 50 [271/1000 8672/32000 (27%)] Loss: 0.24103 (QuantReg: 13.16904) QuantErr: 13.16904 batch_time=0.49226 
Train Epoch: 50 [276/1000 8832/32000 (28%)] Loss: 0.70701 (QuantReg: 13.62012) QuantErr: 13.62012 batch_time=0.37391 
Train Epoch: 50 [281/1000 8992/32000 (28%)] Loss: 0.36628 (QuantReg: 13.06150) QuantErr: 13.06150 batch_time=0.38029 
Train Epoch: 50 [286/1000 9152/32000 (29%)] Loss: 0.26031 (QuantReg: 12.67161) QuantErr: 12.67161 batch_time=0.34871 
Train Epoch: 50 [291/1000 9312/32000 (29%)] Loss: 0.38109 (QuantReg: 13.55908) QuantErr: 13.55908 batch_time=0.45675 
Train Epoch: 50 [296/1000 9472/32000 (30%)] Loss: 0.22657 (QuantReg: 13.63787) QuantErr: 13.63787 batch_time=0.40858 
Train Epoch: 50 [301/1000 9632/32000 (30%)] Loss: 0.21669 (QuantReg: 14.16876) QuantErr: 14.16876 batch_time=0.50420 
Train Epoch: 50 [306/1000 9792/32000 (31%)] Loss: 0.19120 (QuantReg: 13.22372) QuantErr: 13.22372 batch_time=0.39767 
Train Epoch: 50 [311/1000 9952/32000 (31%)] Loss: 0.18893 (QuantReg: 13.18768) QuantErr: 13.18768 batch_time=0.38876 
Train Epoch: 50 [316/1000 10112/32000 (32%)] Loss: 0.34873 (QuantReg: 13.42877) QuantErr: 13.42877 batch_time=0.39076 
Train Epoch: 50 [321/1000 10272/32000 (32%)] Loss: 0.16661 (QuantReg: 13.10721) QuantErr: 13.10721 batch_time=0.41972 
Train Epoch: 50 [326/1000 10432/32000 (33%)] Loss: 0.39706 (QuantReg: 13.03300) QuantErr: 13.03300 batch_time=0.37028 
Train Epoch: 50 [331/1000 10592/32000 (33%)] Loss: 0.57374 (QuantReg: 13.69934) QuantErr: 13.69934 batch_time=1.56665 
Train Epoch: 50 [336/1000 10752/32000 (34%)] Loss: 0.21520 (QuantReg: 13.32361) QuantErr: 13.32361 batch_time=0.35021 
Train Epoch: 50 [341/1000 10912/32000 (34%)] Loss: 0.18196 (QuantReg: 13.18176) QuantErr: 13.18176 batch_time=1.01619 
Train Epoch: 50 [346/1000 11072/32000 (35%)] Loss: 0.54273 (QuantReg: 13.15943) QuantErr: 13.15943 batch_time=0.33319 
Train Epoch: 50 [351/1000 11232/32000 (35%)] Loss: 0.50161 (QuantReg: 13.20919) QuantErr: 13.20919 batch_time=0.38052 
Train Epoch: 50 [356/1000 11392/32000 (36%)] Loss: 0.50668 (QuantReg: 13.74771) QuantErr: 13.74771 batch_time=0.40724 
Train Epoch: 50 [361/1000 11552/32000 (36%)] Loss: 0.38356 (QuantReg: 13.26372) QuantErr: 13.26372 batch_time=0.39209 
Train Epoch: 50 [366/1000 11712/32000 (37%)] Loss: 0.10453 (QuantReg: 13.55897) QuantErr: 13.55897 batch_time=0.36172 
Train Epoch: 50 [371/1000 11872/32000 (37%)] Loss: 0.43048 (QuantReg: 13.54736) QuantErr: 13.54736 batch_time=0.40000 
Train Epoch: 50 [376/1000 12032/32000 (38%)] Loss: 0.36177 (QuantReg: 13.49366) QuantErr: 13.49366 batch_time=0.38962 
Train Epoch: 50 [381/1000 12192/32000 (38%)] Loss: 0.54981 (QuantReg: 13.87543) QuantErr: 13.87543 batch_time=0.40527 
Train Epoch: 50 [386/1000 12352/32000 (39%)] Loss: 0.38850 (QuantReg: 13.29249) QuantErr: 13.29249 batch_time=0.39133 
Train Epoch: 50 [391/1000 12512/32000 (39%)] Loss: 0.15293 (QuantReg: 13.15200) QuantErr: 13.15200 batch_time=0.37604 
Train Epoch: 50 [396/1000 12672/32000 (40%)] Loss: 0.64788 (QuantReg: 13.17942) QuantErr: 13.17942 batch_time=0.50318 
Train Epoch: 50 [401/1000 12832/32000 (40%)] Loss: 0.32321 (QuantReg: 13.12191) QuantErr: 13.12191 batch_time=0.42160 
Train Epoch: 50 [406/1000 12992/32000 (41%)] Loss: 0.46058 (QuantReg: 13.69723) QuantErr: 13.69723 batch_time=0.40880 
Train Epoch: 50 [411/1000 13152/32000 (41%)] Loss: 0.29508 (QuantReg: 13.83122) QuantErr: 13.83122 batch_time=0.38107 
Train Epoch: 50 [416/1000 13312/32000 (42%)] Loss: 0.39693 (QuantReg: 13.31722) QuantErr: 13.31722 batch_time=0.35507 
Train Epoch: 50 [421/1000 13472/32000 (42%)] Loss: 0.29056 (QuantReg: 13.16935) QuantErr: 13.16935 batch_time=0.57365 
Train Epoch: 50 [426/1000 13632/32000 (43%)] Loss: 0.56955 (QuantReg: 13.38451) QuantErr: 13.38451 batch_time=0.40554 
Train Epoch: 50 [431/1000 13792/32000 (43%)] Loss: 0.32303 (QuantReg: 13.88877) QuantErr: 13.88877 batch_time=0.35719 
Train Epoch: 50 [436/1000 13952/32000 (44%)] Loss: 0.29350 (QuantReg: 13.38657) QuantErr: 13.38657 batch_time=0.38344 
Train Epoch: 50 [441/1000 14112/32000 (44%)] Loss: 0.23754 (QuantReg: 13.66600) QuantErr: 13.66600 batch_time=0.40944 
Train Epoch: 50 [446/1000 14272/32000 (45%)] Loss: 0.31378 (QuantReg: 12.90679) QuantErr: 12.90679 batch_time=0.52631 
Train Epoch: 50 [451/1000 14432/32000 (45%)] Loss: 0.27637 (QuantReg: 13.26777) QuantErr: 13.26777 batch_time=0.40593 
Train Epoch: 50 [456/1000 14592/32000 (46%)] Loss: 0.13851 (QuantReg: 13.51711) QuantErr: 13.51711 batch_time=0.40479 
Train Epoch: 50 [461/1000 14752/32000 (46%)] Loss: 0.21534 (QuantReg: 13.17237) QuantErr: 13.17237 batch_time=0.44672 
Train Epoch: 50 [466/1000 14912/32000 (47%)] Loss: 0.13414 (QuantReg: 13.35151) QuantErr: 13.35151 batch_time=0.44226 
Train Epoch: 50 [471/1000 15072/32000 (47%)] Loss: 0.18153 (QuantReg: 13.09031) QuantErr: 13.09031 batch_time=0.38537 
Train Epoch: 50 [476/1000 15232/32000 (48%)] Loss: 0.28441 (QuantReg: 13.70832) QuantErr: 13.70832 batch_time=0.38733 
Train Epoch: 50 [481/1000 15392/32000 (48%)] Loss: 0.20516 (QuantReg: 13.70475) QuantErr: 13.70475 batch_time=0.38095 
Train Epoch: 50 [486/1000 15552/32000 (49%)] Loss: 0.16333 (QuantReg: 13.79896) QuantErr: 13.79896 batch_time=0.42368 
Train Epoch: 50 [491/1000 15712/32000 (49%)] Loss: 0.27935 (QuantReg: 13.08129) QuantErr: 13.08129 batch_time=0.41554 
Train Epoch: 50 [496/1000 15872/32000 (50%)] Loss: 0.23137 (QuantReg: 13.29136) QuantErr: 13.29136 batch_time=0.57448 
Train Epoch: 50 [501/1000 16032/32000 (50%)] Loss: 0.60401 (QuantReg: 13.26398) QuantErr: 13.26398 batch_time=0.38936 
Train Epoch: 50 [506/1000 16192/32000 (51%)] Loss: 0.31302 (QuantReg: 13.90898) QuantErr: 13.90898 batch_time=0.36340 
Train Epoch: 50 [511/1000 16352/32000 (51%)] Loss: 0.36562 (QuantReg: 13.40678) QuantErr: 13.40678 batch_time=0.39648 
Train Epoch: 50 [516/1000 16512/32000 (52%)] Loss: 0.47783 (QuantReg: 13.18362) QuantErr: 13.18362 batch_time=0.36146 
Train Epoch: 50 [521/1000 16672/32000 (52%)] Loss: 0.36157 (QuantReg: 13.74767) QuantErr: 13.74767 batch_time=0.38484 
Train Epoch: 50 [526/1000 16832/32000 (53%)] Loss: 0.32434 (QuantReg: 13.60126) QuantErr: 13.60126 batch_time=0.35179 
Train Epoch: 50 [531/1000 16992/32000 (53%)] Loss: 0.21021 (QuantReg: 13.75455) QuantErr: 13.75455 batch_time=0.38982 
Train Epoch: 50 [536/1000 17152/32000 (54%)] Loss: 0.21328 (QuantReg: 13.57793) QuantErr: 13.57793 batch_time=0.43857 
Train Epoch: 50 [541/1000 17312/32000 (54%)] Loss: 0.64370 (QuantReg: 13.56857) QuantErr: 13.56857 batch_time=0.36135 
Train Epoch: 50 [546/1000 17472/32000 (55%)] Loss: 0.56642 (QuantReg: 13.30152) QuantErr: 13.30152 batch_time=0.45752 
Train Epoch: 50 [551/1000 17632/32000 (55%)] Loss: 0.28126 (QuantReg: 12.66382) QuantErr: 12.66382 batch_time=0.91325 
Train Epoch: 50 [556/1000 17792/32000 (56%)] Loss: 0.53797 (QuantReg: 13.50574) QuantErr: 13.50574 batch_time=0.37328 
Train Epoch: 50 [561/1000 17952/32000 (56%)] Loss: 0.20639 (QuantReg: 13.74694) QuantErr: 13.74694 batch_time=0.36656 
Train Epoch: 50 [566/1000 18112/32000 (57%)] Loss: 0.55273 (QuantReg: 13.09000) QuantErr: 13.09000 batch_time=0.44410 
Train Epoch: 50 [571/1000 18272/32000 (57%)] Loss: 0.29906 (QuantReg: 13.21871) QuantErr: 13.21871 batch_time=0.49980 
Train Epoch: 50 [576/1000 18432/32000 (58%)] Loss: 0.12398 (QuantReg: 13.60471) QuantErr: 13.60471 batch_time=0.44696 
Train Epoch: 50 [581/1000 18592/32000 (58%)] Loss: 0.33765 (QuantReg: 13.65619) QuantErr: 13.65619 batch_time=0.44582 
Train Epoch: 50 [586/1000 18752/32000 (59%)] Loss: 0.31839 (QuantReg: 13.92149) QuantErr: 13.92149 batch_time=0.34430 
Train Epoch: 50 [591/1000 18912/32000 (59%)] Loss: 0.11025 (QuantReg: 12.93751) QuantErr: 12.93751 batch_time=0.37633 
Train Epoch: 50 [596/1000 19072/32000 (60%)] Loss: 0.17268 (QuantReg: 13.33847) QuantErr: 13.33847 batch_time=0.35240 
Train Epoch: 50 [601/1000 19232/32000 (60%)] Loss: 0.18127 (QuantReg: 13.26207) QuantErr: 13.26207 batch_time=0.51188 
Train Epoch: 50 [606/1000 19392/32000 (61%)] Loss: 0.28975 (QuantReg: 13.00451) QuantErr: 13.00451 batch_time=0.35668 
Train Epoch: 50 [611/1000 19552/32000 (61%)] Loss: 0.14387 (QuantReg: 13.62105) QuantErr: 13.62105 batch_time=0.34313 
Train Epoch: 50 [616/1000 19712/32000 (62%)] Loss: 0.52515 (QuantReg: 13.70630) QuantErr: 13.70630 batch_time=0.35024 
Train Epoch: 50 [621/1000 19872/32000 (62%)] Loss: 0.32891 (QuantReg: 13.44620) QuantErr: 13.44620 batch_time=0.41222 
Train Epoch: 50 [626/1000 20032/32000 (63%)] Loss: 0.39308 (QuantReg: 13.47708) QuantErr: 13.47708 batch_time=0.36071 
Train Epoch: 50 [631/1000 20192/32000 (63%)] Loss: 0.25251 (QuantReg: 13.09060) QuantErr: 13.09060 batch_time=0.35334 
Train Epoch: 50 [636/1000 20352/32000 (64%)] Loss: 0.41058 (QuantReg: 13.26031) QuantErr: 13.26031 batch_time=0.51028 
Train Epoch: 50 [641/1000 20512/32000 (64%)] Loss: 0.33681 (QuantReg: 13.13745) QuantErr: 13.13745 batch_time=0.36527 
Train Epoch: 50 [646/1000 20672/32000 (65%)] Loss: 0.26886 (QuantReg: 12.91491) QuantErr: 12.91491 batch_time=0.34994 
Train Epoch: 50 [651/1000 20832/32000 (65%)] Loss: 0.55920 (QuantReg: 13.56931) QuantErr: 13.56931 batch_time=1.54925 
Train Epoch: 50 [656/1000 20992/32000 (66%)] Loss: 0.16936 (QuantReg: 13.51433) QuantErr: 13.51433 batch_time=0.37757 
Train Epoch: 50 [661/1000 21152/32000 (66%)] Loss: 0.28087 (QuantReg: 13.12566) QuantErr: 13.12566 batch_time=0.67565 
Train Epoch: 50 [666/1000 21312/32000 (67%)] Loss: 0.38464 (QuantReg: 13.39380) QuantErr: 13.39380 batch_time=0.43096 
Train Epoch: 50 [671/1000 21472/32000 (67%)] Loss: 0.44862 (QuantReg: 13.52083) QuantErr: 13.52083 batch_time=0.35605 
Train Epoch: 50 [676/1000 21632/32000 (68%)] Loss: 0.22253 (QuantReg: 13.41840) QuantErr: 13.41840 batch_time=0.35525 
Train Epoch: 50 [681/1000 21792/32000 (68%)] Loss: 0.31232 (QuantReg: 13.60186) QuantErr: 13.60186 batch_time=0.59425 
Train Epoch: 50 [686/1000 21952/32000 (69%)] Loss: 0.08654 (QuantReg: 13.12844) QuantErr: 13.12844 batch_time=0.44999 
Train Epoch: 50 [691/1000 22112/32000 (69%)] Loss: 0.37979 (QuantReg: 12.88746) QuantErr: 12.88746 batch_time=0.39760 
Train Epoch: 50 [696/1000 22272/32000 (70%)] Loss: 0.29434 (QuantReg: 13.20670) QuantErr: 13.20670 batch_time=0.38169 
Train Epoch: 50 [701/1000 22432/32000 (70%)] Loss: 0.14335 (QuantReg: 13.42696) QuantErr: 13.42696 batch_time=0.50369 
Train Epoch: 50 [706/1000 22592/32000 (71%)] Loss: 0.37509 (QuantReg: 13.98099) QuantErr: 13.98099 batch_time=0.46727 
Train Epoch: 50 [711/1000 22752/32000 (71%)] Loss: 0.18730 (QuantReg: 13.39935) QuantErr: 13.39935 batch_time=0.40684 
Train Epoch: 50 [716/1000 22912/32000 (72%)] Loss: 0.39205 (QuantReg: 13.66959) QuantErr: 13.66959 batch_time=0.42673 
Train Epoch: 50 [721/1000 23072/32000 (72%)] Loss: 0.17030 (QuantReg: 13.88585) QuantErr: 13.88585 batch_time=0.37694 
Train Epoch: 50 [726/1000 23232/32000 (73%)] Loss: 0.19731 (QuantReg: 12.83103) QuantErr: 12.83103 batch_time=0.38890 
Train Epoch: 50 [731/1000 23392/32000 (73%)] Loss: 0.43471 (QuantReg: 13.95490) QuantErr: 13.95490 batch_time=0.41774 
Train Epoch: 50 [736/1000 23552/32000 (74%)] Loss: 0.46175 (QuantReg: 13.30827) QuantErr: 13.30827 batch_time=0.46751 
Train Epoch: 50 [741/1000 23712/32000 (74%)] Loss: 0.32884 (QuantReg: 13.30407) QuantErr: 13.30407 batch_time=0.41386 
Train Epoch: 50 [746/1000 23872/32000 (75%)] Loss: 0.33849 (QuantReg: 13.19038) QuantErr: 13.19038 batch_time=0.36604 
Train Epoch: 50 [751/1000 24032/32000 (75%)] Loss: 0.34652 (QuantReg: 13.70691) QuantErr: 13.70691 batch_time=0.37878 
Train Epoch: 50 [756/1000 24192/32000 (76%)] Loss: 0.21540 (QuantReg: 13.69207) QuantErr: 13.69207 batch_time=0.36646 
Train Epoch: 50 [761/1000 24352/32000 (76%)] Loss: 0.45822 (QuantReg: 12.79169) QuantErr: 12.79169 batch_time=0.38234 
Train Epoch: 50 [766/1000 24512/32000 (77%)] Loss: 0.33644 (QuantReg: 12.79811) QuantErr: 12.79811 batch_time=0.36994 
Train Epoch: 50 [771/1000 24672/32000 (77%)] Loss: 0.60742 (QuantReg: 13.32309) QuantErr: 13.32309 batch_time=0.34602 
Train Epoch: 50 [776/1000 24832/32000 (78%)] Loss: 0.37601 (QuantReg: 13.25397) QuantErr: 13.25397 batch_time=0.36426 
Train Epoch: 50 [781/1000 24992/32000 (78%)] Loss: 0.36143 (QuantReg: 13.87984) QuantErr: 13.87984 batch_time=0.41069 
Train Epoch: 50 [786/1000 25152/32000 (79%)] Loss: 0.28141 (QuantReg: 13.51412) QuantErr: 13.51412 batch_time=0.39533 
Train Epoch: 50 [791/1000 25312/32000 (79%)] Loss: 0.22929 (QuantReg: 13.13314) QuantErr: 13.13314 batch_time=0.46843 
Train Epoch: 50 [796/1000 25472/32000 (80%)] Loss: 0.13938 (QuantReg: 13.66829) QuantErr: 13.66829 batch_time=0.41862 
Train Epoch: 50 [801/1000 25632/32000 (80%)] Loss: 0.60044 (QuantReg: 12.79976) QuantErr: 12.79976 batch_time=0.35527 
Train Epoch: 50 [806/1000 25792/32000 (81%)] Loss: 0.18991 (QuantReg: 13.74426) QuantErr: 13.74426 batch_time=0.37593 
Train Epoch: 50 [811/1000 25952/32000 (81%)] Loss: 0.23913 (QuantReg: 13.22853) QuantErr: 13.22853 batch_time=0.43449 
Train Epoch: 50 [816/1000 26112/32000 (82%)] Loss: 0.21050 (QuantReg: 13.56402) QuantErr: 13.56402 batch_time=0.38019 
Train Epoch: 50 [821/1000 26272/32000 (82%)] Loss: 0.40269 (QuantReg: 13.98225) QuantErr: 13.98225 batch_time=0.40409 
Train Epoch: 50 [826/1000 26432/32000 (83%)] Loss: 0.48217 (QuantReg: 12.75323) QuantErr: 12.75323 batch_time=0.38940 
Train Epoch: 50 [831/1000 26592/32000 (83%)] Loss: 0.35022 (QuantReg: 12.84941) QuantErr: 12.84941 batch_time=0.39335 
Train Epoch: 50 [836/1000 26752/32000 (84%)] Loss: 0.40337 (QuantReg: 13.27034) QuantErr: 13.27034 batch_time=0.55690 
Train Epoch: 50 [841/1000 26912/32000 (84%)] Loss: 0.32351 (QuantReg: 13.59862) QuantErr: 13.59862 batch_time=0.38994 
Train Epoch: 50 [846/1000 27072/32000 (85%)] Loss: 0.24950 (QuantReg: 13.61724) QuantErr: 13.61724 batch_time=0.38030 
Train Epoch: 50 [851/1000 27232/32000 (85%)] Loss: 0.50235 (QuantReg: 13.70978) QuantErr: 13.70978 batch_time=0.38473 
Train Epoch: 50 [856/1000 27392/32000 (86%)] Loss: 0.07666 (QuantReg: 14.04480) QuantErr: 14.04480 batch_time=0.43812 
Train Epoch: 50 [861/1000 27552/32000 (86%)] Loss: 0.16014 (QuantReg: 13.61751) QuantErr: 13.61751 batch_time=0.42715 
Train Epoch: 50 [866/1000 27712/32000 (87%)] Loss: 0.38767 (QuantReg: 13.08728) QuantErr: 13.08728 batch_time=0.42041 
Train Epoch: 50 [871/1000 27872/32000 (87%)] Loss: 0.39188 (QuantReg: 12.64828) QuantErr: 12.64828 batch_time=0.94190 
Train Epoch: 50 [876/1000 28032/32000 (88%)] Loss: 0.23983 (QuantReg: 13.42313) QuantErr: 13.42313 batch_time=0.36576 
Train Epoch: 50 [881/1000 28192/32000 (88%)] Loss: 0.40670 (QuantReg: 13.52276) QuantErr: 13.52276 batch_time=0.38136 
Train Epoch: 50 [886/1000 28352/32000 (89%)] Loss: 0.63316 (QuantReg: 12.98495) QuantErr: 12.98495 batch_time=0.80461 
Train Epoch: 50 [891/1000 28512/32000 (89%)] Loss: 0.47511 (QuantReg: 13.22655) QuantErr: 13.22655 batch_time=0.35212 
Train Epoch: 50 [896/1000 28672/32000 (90%)] Loss: 0.29167 (QuantReg: 13.76134) QuantErr: 13.76134 batch_time=0.36317 
Train Epoch: 50 [901/1000 28832/32000 (90%)] Loss: 0.16913 (QuantReg: 13.37711) QuantErr: 13.37711 batch_time=0.38435 
Train Epoch: 50 [906/1000 28992/32000 (91%)] Loss: 0.25428 (QuantReg: 13.54204) QuantErr: 13.54204 batch_time=0.36283 
Train Epoch: 50 [911/1000 29152/32000 (91%)] Loss: 0.19106 (QuantReg: 13.32400) QuantErr: 13.32400 batch_time=0.52718 
Train Epoch: 50 [916/1000 29312/32000 (92%)] Loss: 0.24893 (QuantReg: 13.28961) QuantErr: 13.28961 batch_time=0.40643 
Train Epoch: 50 [921/1000 29472/32000 (92%)] Loss: 0.11764 (QuantReg: 13.79781) QuantErr: 13.79781 batch_time=0.38326 
Train Epoch: 50 [926/1000 29632/32000 (93%)] Loss: 0.43877 (QuantReg: 13.01640) QuantErr: 13.01640 batch_time=0.39920 
Train Epoch: 50 [931/1000 29792/32000 (93%)] Loss: 0.11353 (QuantReg: 13.70206) QuantErr: 13.70206 batch_time=0.38172 
Train Epoch: 50 [936/1000 29952/32000 (94%)] Loss: 0.20879 (QuantReg: 13.60483) QuantErr: 13.60483 batch_time=0.52535 
Train Epoch: 50 [941/1000 30112/32000 (94%)] Loss: 0.19416 (QuantReg: 13.81994) QuantErr: 13.81994 batch_time=0.39188 
Train Epoch: 50 [946/1000 30272/32000 (95%)] Loss: 0.11672 (QuantReg: 13.65948) QuantErr: 13.65948 batch_time=0.39764 
Train Epoch: 50 [951/1000 30432/32000 (95%)] Loss: 0.06947 (QuantReg: 13.63011) QuantErr: 13.63011 batch_time=0.37510 
Train Epoch: 50 [956/1000 30592/32000 (96%)] Loss: 0.36223 (QuantReg: 13.40393) QuantErr: 13.40393 batch_time=0.41805 
Train Epoch: 50 [961/1000 30752/32000 (96%)] Loss: 0.16203 (QuantReg: 13.62912) QuantErr: 13.62912 batch_time=0.51092 
Train Epoch: 50 [966/1000 30912/32000 (97%)] Loss: 0.21136 (QuantReg: 12.87013) QuantErr: 12.87013 batch_time=0.38691 
Train Epoch: 50 [971/1000 31072/32000 (97%)] Loss: 0.19178 (QuantReg: 13.80058) QuantErr: 13.80058 batch_time=1.37215 
Train Epoch: 50 [976/1000 31232/32000 (98%)] Loss: 0.25509 (QuantReg: 13.46628) QuantErr: 13.46628 batch_time=0.43716 
Train Epoch: 50 [981/1000 31392/32000 (98%)] Loss: 0.19110 (QuantReg: 13.74171) QuantErr: 13.74171 batch_time=0.72243 
Train Epoch: 50 [986/1000 31552/32000 (99%)] Loss: 0.12679 (QuantReg: 13.81883) QuantErr: 13.81883 batch_time=0.41741 
Train Epoch: 50 [991/1000 31712/32000 (99%)] Loss: 0.53998 (QuantReg: 13.09655) QuantErr: 13.09655 batch_time=0.35106 
Train Epoch: 50 [996/1000 31872/32000 (100%)] Loss: 0.31021 (QuantReg: 13.46636) QuantErr: 13.46636 batch_time=0.35380 
Train Epoch: 50 codebook_update_time=2.17229
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/checkpoint-epoch50.pth ...
Done in 6.776s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 0.3120296236500144
 quant_reg      : 13.388337648391724
 quant_err      : 13.388337648391724
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 50000
 MSRVTT_miech_test/t2v_metrics/R1: 20.9
 MSRVTT_miech_test/t2v_metrics/R5: 50.4
 MSRVTT_miech_test/t2v_metrics/R10: 64.5
 MSRVTT_miech_test/t2v_metrics/R50: 87.4
 MSRVTT_miech_test/t2v_metrics/MedR: 5.0
 MSRVTT_miech_test/t2v_metrics/MeanR: 32.783
 MSRVTT_miech_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.804886957877315
 MSRVTT_miech_test/v2t_metrics/R1: 21.2
 MSRVTT_miech_test/v2t_metrics/R5: 51.9
 MSRVTT_miech_test/v2t_metrics/R10: 65.6
 MSRVTT_miech_test/v2t_metrics/R50: 88.6
 MSRVTT_miech_test/v2t_metrics/MedR: 5.0
 MSRVTT_miech_test/v2t_metrics/MeanR: 29.596
 MSRVTT_miech_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.63600187140205
 mnt_best       : 41.67588620163152
 not_improved_count: 1
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/trained_model.pth ...
Ckpt loaded at epoch 49.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/MSRVTT-test-qt-sims.npy
MSRVTT_miech_test:
 t2v_metrics/R1/final_eval: 22.6
 t2v_metrics/R5/final_eval: 49.2
 t2v_metrics/R10/final_eval: 65.1
 t2v_metrics/R50/final_eval: 87.1
 t2v_metrics/MedR/final_eval: 6.0
 t2v_metrics/MeanR/final_eval: 32.033
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 41.67588620163152
 v2t_metrics/R1/final_eval: 21.4
 v2t_metrics/R5/final_eval: 52.3
 v2t_metrics/R10/final_eval: 65.9
 v2t_metrics/R50/final_eval: 88.2
 v2t_metrics/MedR/final_eval: 5.0
 v2t_metrics/MeanR/final_eval: 28.199
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 41.93728318943704
Best epoch for the monitored metric: 49
Script took 07h43m34s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kB_bs32/trained_model.pth
