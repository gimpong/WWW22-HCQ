Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 1020.7898154258728 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 66.1305000782013 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 354.94786858558655 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 100.95828795433044 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch0.pth ...
Done in 1.648s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch0.pth ...
Done in 3.185s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.0
 MSRVTT_full_val/t2v_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R10: 1.6096579476861168
 MSRVTT_full_val/t2v_metrics/R50: 8.450704225352112
 MSRVTT_full_val/t2v_metrics/MedR: 252.0
 MSRVTT_full_val/t2v_metrics/MeanR: 251.21730382293762
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_val/v2t_metrics/R1: 0.0
 MSRVTT_full_val/v2t_metrics/R5: 0.8048289738430584
 MSRVTT_full_val/v2t_metrics/R10: 2.0120724346076457
 MSRVTT_full_val/v2t_metrics/R50: 9.054325955734406
 MSRVTT_full_val/v2t_metrics/MedR: 243.0
 MSRVTT_full_val/v2t_metrics/MeanR: 247.7344064386318
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/t2v_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.26755852842809363
 MSRVTT_full_test/t2v_metrics/R50: 1.705685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 1515.0
 MSRVTT_full_test/t2v_metrics/MeanR: 1498.5565217391304
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.12154652794863813
 MSRVTT_full_test/v2t_metrics/R1: 0.06688963210702341
 MSRVTT_full_test/v2t_metrics/R5: 0.16722408026755853
 MSRVTT_full_test/v2t_metrics/R10: 0.3010033444816054
 MSRVTT_full_test/v2t_metrics/R50: 1.806020066889632
 MSRVTT_full_test/v2t_metrics/MedR: 1471.5
 MSRVTT_full_test/v2t_metrics/MeanR: 1495.3264214046824
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.14987975740993859
 mnt_best       : 0.12154652794863813
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.77391 (QuantReg: 22.44805) QuantErr: 22.44805 batch_time=47.01011 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.58264 (QuantReg: 22.55249) QuantErr: 22.55249 batch_time=0.57426 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.11818 (QuantReg: 22.59467) QuantErr: 22.59467 batch_time=0.52202 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.95232 (QuantReg: 22.61903) QuantErr: 22.61903 batch_time=0.51765 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.37375 (QuantReg: 22.62500) QuantErr: 22.62500 batch_time=0.52267 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.12799 (QuantReg: 22.66029) QuantErr: 22.66029 batch_time=0.51865 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 6.07767 (QuantReg: 22.62787) QuantErr: 22.62787 batch_time=0.52308 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.79228 (QuantReg: 22.61881) QuantErr: 22.61881 batch_time=0.57342 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.43413 (QuantReg: 22.65380) QuantErr: 22.65380 batch_time=0.55716 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.68314 (QuantReg: 22.64840) QuantErr: 22.64840 batch_time=0.55230 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.19744 (QuantReg: 22.65308) QuantErr: 22.65308 batch_time=0.53924 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 4.93246 (QuantReg: 22.62785) QuantErr: 22.62785 batch_time=0.52654 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 4.95023 (QuantReg: 22.60018) QuantErr: 22.60018 batch_time=0.52566 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.78616 (QuantReg: 22.64834) QuantErr: 22.64834 batch_time=0.52936 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.82764 (QuantReg: 22.64358) QuantErr: 22.64358 batch_time=0.56887 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 5.11477 (QuantReg: 22.62901) QuantErr: 22.62901 batch_time=0.61115 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.82254 (QuantReg: 22.62661) QuantErr: 22.62661 batch_time=0.49754 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.53074 (QuantReg: 22.61680) QuantErr: 22.61680 batch_time=0.53478 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.60178 (QuantReg: 22.57908) QuantErr: 22.57908 batch_time=0.63469 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.24386 (QuantReg: 22.59327) QuantErr: 22.59327 batch_time=0.56167 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.51081 (QuantReg: 22.60149) QuantErr: 22.60149 batch_time=0.55768 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.32607 (QuantReg: 22.63106) QuantErr: 22.63106 batch_time=0.50867 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 4.11226 (QuantReg: 22.57971) QuantErr: 22.57971 batch_time=0.54619 
Train Epoch: 1 codebook_update_time=1.93654
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch1.pth ...
Done in 4.736s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch1.pth ...
Done in 9.889s
 epoch          : 1
 loss           : 5.412819831848145
 quant_reg      : 22.618492904663086
 quant_err      : 22.618492904663086
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 17.10261569416499
 MSRVTT_full_val/t2v_metrics/R5: 51.7102615694165
 MSRVTT_full_val/t2v_metrics/R10: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R50: 95.37223340040241
 MSRVTT_full_val/t2v_metrics/MedR: 5.0
 MSRVTT_full_val/t2v_metrics/MeanR: 13.89738430583501
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 38.8686038266997
 MSRVTT_full_val/v2t_metrics/R1: 20.120724346076457
 MSRVTT_full_val/v2t_metrics/R5: 52.91750503018109
 MSRVTT_full_val/v2t_metrics/R10: 69.81891348088531
 MSRVTT_full_val/v2t_metrics/R50: 93.96378269617706
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.798792756539235
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 42.04735539789754
 MSRVTT_full_test/t2v_metrics/R1: 5.852842809364549
 MSRVTT_full_test/t2v_metrics/R5: 19.531772575250837
 MSRVTT_full_test/t2v_metrics/R10: 31.103678929765888
 MSRVTT_full_test/t2v_metrics/R50: 65.58528428093645
 MSRVTT_full_test/t2v_metrics/MedR: 25.0
 MSRVTT_full_test/t2v_metrics/MeanR: 74.11371237458194
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.263006638949394
 MSRVTT_full_test/v2t_metrics/R1: 6.354515050167224
 MSRVTT_full_test/v2t_metrics/R5: 22.107023411371237
 MSRVTT_full_test/v2t_metrics/R10: 33.84615384615385
 MSRVTT_full_test/v2t_metrics/R50: 69.66555183946488
 MSRVTT_full_test/v2t_metrics/MedR: 22.0
 MSRVTT_full_test/v2t_metrics/MeanR: 67.39498327759198
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 16.815405162827243
 mnt_best       : 15.263006638949394
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 3.88770 (QuantReg: 12.20144) QuantErr: 12.20144 batch_time=37.17690 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.04224 (QuantReg: 12.18251) QuantErr: 12.18251 batch_time=0.54047 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.00097 (QuantReg: 12.61269) QuantErr: 12.61269 batch_time=0.51413 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.92518 (QuantReg: 12.70034) QuantErr: 12.70034 batch_time=0.80676 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.84010 (QuantReg: 12.84592) QuantErr: 12.84592 batch_time=0.51040 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 3.82373 (QuantReg: 12.56346) QuantErr: 12.56346 batch_time=0.51869 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.06285 (QuantReg: 13.02727) QuantErr: 13.02727 batch_time=0.51798 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.60486 (QuantReg: 13.12265) QuantErr: 13.12265 batch_time=0.52420 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 4.26026 (QuantReg: 13.39605) QuantErr: 13.39605 batch_time=0.50165 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 3.68304 (QuantReg: 13.30996) QuantErr: 13.30996 batch_time=0.57867 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.73385 (QuantReg: 13.30649) QuantErr: 13.30649 batch_time=0.59075 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.50423 (QuantReg: 13.67502) QuantErr: 13.67502 batch_time=0.49957 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.37078 (QuantReg: 13.50175) QuantErr: 13.50175 batch_time=0.59874 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 3.50311 (QuantReg: 13.73877) QuantErr: 13.73877 batch_time=0.92752 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.43155 (QuantReg: 13.62914) QuantErr: 13.62914 batch_time=0.51909 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.36669 (QuantReg: 14.21064) QuantErr: 14.21064 batch_time=0.53329 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.52532 (QuantReg: 13.93039) QuantErr: 13.93039 batch_time=0.51698 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.60874 (QuantReg: 14.14732) QuantErr: 14.14732 batch_time=0.61615 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.29943 (QuantReg: 13.94801) QuantErr: 13.94801 batch_time=0.51125 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.26050 (QuantReg: 14.08821) QuantErr: 14.08821 batch_time=0.50686 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 2.96536 (QuantReg: 14.25895) QuantErr: 14.25895 batch_time=0.54116 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.96756 (QuantReg: 14.25811) QuantErr: 14.25811 batch_time=0.56252 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.56164 (QuantReg: 14.60070) QuantErr: 14.60070 batch_time=0.52196 
Train Epoch: 2 codebook_update_time=1.71778
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch2.pth ...
Done in 22.146s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch2.pth ...
Done in 26.949s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 3.6862801761627195
 quant_reg      : 13.442541538238526
 quant_err      : 13.442541538238526
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 23.34004024144869
 MSRVTT_full_val/t2v_metrics/R5: 59.356136820925556
 MSRVTT_full_val/t2v_metrics/R10: 72.83702213279678
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.26559356136821
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 46.55572953691834
 MSRVTT_full_val/v2t_metrics/R1: 26.961770623742456
 MSRVTT_full_val/v2t_metrics/R5: 63.38028169014085
 MSRVTT_full_val/v2t_metrics/R10: 80.6841046277666
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.619718309859154
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.661084574415966
 MSRVTT_full_test/t2v_metrics/R1: 8.193979933110368
 MSRVTT_full_test/t2v_metrics/R5: 26.287625418060202
 MSRVTT_full_test/t2v_metrics/R10: 37.85953177257525
 MSRVTT_full_test/t2v_metrics/R50: 71.60535117056857
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 60.189632107023414
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.128303123206496
 MSRVTT_full_test/v2t_metrics/R1: 9.531772575250836
 MSRVTT_full_test/v2t_metrics/R5: 29.899665551839465
 MSRVTT_full_test/v2t_metrics/R10: 42.77591973244147
 MSRVTT_full_test/v2t_metrics/R50: 77.82608695652173
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 48.60702341137124
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.015113418379524
 mnt_best       : 20.128303123206496
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.13781 (QuantReg: 11.65062) QuantErr: 11.65062 batch_time=33.49385 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.44036 (QuantReg: 11.78328) QuantErr: 11.78328 batch_time=0.56207 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.58301 (QuantReg: 12.14386) QuantErr: 12.14386 batch_time=0.50526 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 2.87982 (QuantReg: 11.41515) QuantErr: 11.41515 batch_time=0.51140 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.28991 (QuantReg: 11.79025) QuantErr: 11.79025 batch_time=0.56818 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 2.86980 (QuantReg: 12.08874) QuantErr: 12.08874 batch_time=0.50715 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 2.94241 (QuantReg: 12.07496) QuantErr: 12.07496 batch_time=5.03373 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.26625 (QuantReg: 11.93898) QuantErr: 11.93898 batch_time=0.53173 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.20390 (QuantReg: 11.84624) QuantErr: 11.84624 batch_time=0.51965 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 3.04278 (QuantReg: 11.79964) QuantErr: 11.79964 batch_time=0.54556 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.14330 (QuantReg: 11.81054) QuantErr: 11.81054 batch_time=0.51118 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 2.74002 (QuantReg: 12.04723) QuantErr: 12.04723 batch_time=0.55221 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.24083 (QuantReg: 12.24439) QuantErr: 12.24439 batch_time=0.51721 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.01740 (QuantReg: 12.40362) QuantErr: 12.40362 batch_time=0.51486 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.75673 (QuantReg: 12.04416) QuantErr: 12.04416 batch_time=0.69472 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.52386 (QuantReg: 12.66013) QuantErr: 12.66013 batch_time=0.52123 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 2.68481 (QuantReg: 12.23236) QuantErr: 12.23236 batch_time=0.55950 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.24790 (QuantReg: 12.17422) QuantErr: 12.17422 batch_time=0.56592 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 2.80571 (QuantReg: 12.17754) QuantErr: 12.17754 batch_time=0.52969 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.05248 (QuantReg: 12.53262) QuantErr: 12.53262 batch_time=0.56546 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 2.74809 (QuantReg: 12.57468) QuantErr: 12.57468 batch_time=0.52147 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 2.52702 (QuantReg: 12.72495) QuantErr: 12.72495 batch_time=0.54532 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 2.81293 (QuantReg: 12.58868) QuantErr: 12.58868 batch_time=0.55076 
Train Epoch: 3 codebook_update_time=1.84101
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch3.pth ...
Done in 5.628s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch3.pth ...
Done in 18.520s
removing stale ckpt [epoch 2] [took 0.20s]
 epoch          : 3
 loss           : 3.099186414718628
 quant_reg      : 12.171798236846923
 quant_err      : 12.171798236846923
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 23.943661971830984
 MSRVTT_full_val/t2v_metrics/R5: 61.3682092555332
 MSRVTT_full_val/t2v_metrics/R10: 75.45271629778672
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.651911468812877
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.03999653677077
 MSRVTT_full_val/v2t_metrics/R1: 27.96780684104628
 MSRVTT_full_val/v2t_metrics/R5: 66.19718309859155
 MSRVTT_full_val/v2t_metrics/R10: 80.6841046277666
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.935613682092555
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.05935523203142
 MSRVTT_full_test/t2v_metrics/R1: 8.896321070234114
 MSRVTT_full_test/t2v_metrics/R5: 27.692307692307693
 MSRVTT_full_test/t2v_metrics/R10: 40.53511705685619
 MSRVTT_full_test/t2v_metrics/R50: 74.71571906354515
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 56.203678929765886
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.534444641678324
 MSRVTT_full_test/v2t_metrics/R1: 10.334448160535118
 MSRVTT_full_test/v2t_metrics/R5: 31.471571906354516
 MSRVTT_full_test/v2t_metrics/R10: 46.15384615384615
 MSRVTT_full_test/v2t_metrics/R50: 80.16722408026756
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 46.300334448160534
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.668223510004257
 mnt_best       : 21.534444641678324
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 3.35870 (QuantReg: 11.40896) QuantErr: 11.40896 batch_time=41.38342 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.92728 (QuantReg: 11.45858) QuantErr: 11.45858 batch_time=0.75363 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.44317 (QuantReg: 11.50343) QuantErr: 11.50343 batch_time=0.52056 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.70272 (QuantReg: 11.45753) QuantErr: 11.45753 batch_time=0.55409 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.83132 (QuantReg: 11.53209) QuantErr: 11.53209 batch_time=0.55282 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.14459 (QuantReg: 11.58107) QuantErr: 11.58107 batch_time=0.53815 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 3.17282 (QuantReg: 11.62832) QuantErr: 11.62832 batch_time=0.56101 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.99388 (QuantReg: 11.69040) QuantErr: 11.69040 batch_time=0.49911 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 2.70363 (QuantReg: 11.56804) QuantErr: 11.56804 batch_time=0.57363 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.66612 (QuantReg: 11.49324) QuantErr: 11.49324 batch_time=0.51852 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 2.87745 (QuantReg: 11.86169) QuantErr: 11.86169 batch_time=0.52468 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.77251 (QuantReg: 11.65112) QuantErr: 11.65112 batch_time=0.53124 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 2.65643 (QuantReg: 11.66679) QuantErr: 11.66679 batch_time=0.57443 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.83904 (QuantReg: 11.78616) QuantErr: 11.78616 batch_time=0.52772 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 3.01342 (QuantReg: 12.01978) QuantErr: 12.01978 batch_time=0.51490 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 3.20527 (QuantReg: 12.32074) QuantErr: 12.32074 batch_time=0.52205 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 3.06108 (QuantReg: 11.85444) QuantErr: 11.85444 batch_time=0.60050 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.91079 (QuantReg: 12.22481) QuantErr: 12.22481 batch_time=0.51295 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.85279 (QuantReg: 11.88989) QuantErr: 11.88989 batch_time=0.53867 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.52997 (QuantReg: 11.95353) QuantErr: 11.95353 batch_time=0.61798 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.45242 (QuantReg: 12.22916) QuantErr: 12.22916 batch_time=0.56432 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.85980 (QuantReg: 11.60314) QuantErr: 11.60314 batch_time=0.55492 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.65181 (QuantReg: 11.76749) QuantErr: 11.76749 batch_time=0.54694 
Train Epoch: 4 codebook_update_time=1.76299
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch4.pth ...
Done in 19.853s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 2.7865691423416137
 quant_reg      : 11.793484714508057
 quant_err      : 11.793484714508057
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 61.16700201207244
 MSRVTT_full_val/t2v_metrics/R10: 73.8430583501006
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.193158953722333
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.301882332188484
 MSRVTT_full_val/v2t_metrics/R1: 28.973843058350102
 MSRVTT_full_val/v2t_metrics/R5: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 96.78068410462777
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.175050301810865
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.163062165704936
 MSRVTT_full_test/t2v_metrics/R1: 9.163879598662207
 MSRVTT_full_test/t2v_metrics/R5: 26.956521739130434
 MSRVTT_full_test/t2v_metrics/R10: 39.86622073578595
 MSRVTT_full_test/t2v_metrics/R50: 74.24749163879599
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 55.63846153846154
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.43463528786568
 MSRVTT_full_test/v2t_metrics/R1: 10.668896321070234
 MSRVTT_full_test/v2t_metrics/R5: 32.74247491638796
 MSRVTT_full_test/v2t_metrics/R10: 47.625418060200666
 MSRVTT_full_test/v2t_metrics/R50: 80.96989966555184
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.916053511705684
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.52838061825068
 mnt_best       : 21.534444641678324
 not_improved_count: 1
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.70300 (QuantReg: 11.49697) QuantErr: 11.49697 batch_time=43.69156 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 2.85977 (QuantReg: 11.61374) QuantErr: 11.61374 batch_time=0.54188 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 3.02633 (QuantReg: 11.47749) QuantErr: 11.47749 batch_time=0.50933 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.27905 (QuantReg: 11.70121) QuantErr: 11.70121 batch_time=0.52437 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.49064 (QuantReg: 11.30599) QuantErr: 11.30599 batch_time=0.50953 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.63152 (QuantReg: 12.04444) QuantErr: 12.04444 batch_time=0.55109 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.51641 (QuantReg: 11.48363) QuantErr: 11.48363 batch_time=0.52173 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 2.85428 (QuantReg: 11.38153) QuantErr: 11.38153 batch_time=0.58248 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.35424 (QuantReg: 11.63548) QuantErr: 11.63548 batch_time=0.59841 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.76929 (QuantReg: 11.70386) QuantErr: 11.70386 batch_time=0.52125 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.52469 (QuantReg: 11.78701) QuantErr: 11.78701 batch_time=0.52129 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.58646 (QuantReg: 11.73017) QuantErr: 11.73017 batch_time=0.56573 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.57594 (QuantReg: 11.82214) QuantErr: 11.82214 batch_time=0.51905 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 1.94951 (QuantReg: 11.86550) QuantErr: 11.86550 batch_time=0.51793 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.48398 (QuantReg: 11.92948) QuantErr: 11.92948 batch_time=0.58810 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.56561 (QuantReg: 11.93442) QuantErr: 11.93442 batch_time=0.52003 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.42811 (QuantReg: 12.21174) QuantErr: 12.21174 batch_time=0.51306 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.76697 (QuantReg: 11.71444) QuantErr: 11.71444 batch_time=0.52858 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.39045 (QuantReg: 11.81081) QuantErr: 11.81081 batch_time=0.58086 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.55335 (QuantReg: 11.58211) QuantErr: 11.58211 batch_time=0.55310 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.62877 (QuantReg: 11.98074) QuantErr: 11.98074 batch_time=1.40256 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.06765 (QuantReg: 11.95234) QuantErr: 11.95234 batch_time=0.50256 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.32088 (QuantReg: 11.72560) QuantErr: 11.72560 batch_time=0.59435 
Train Epoch: 5 codebook_update_time=1.79114
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch5.pth ...
Done in 5.365s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch5.pth ...
Done in 10.695s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 2.516263931274414
 quant_reg      : 11.703462162017821
 quant_err      : 11.703462162017821
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 63.78269617706238
 MSRVTT_full_val/t2v_metrics/R10: 77.66599597585513
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.780684104627767
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.59891093693319
 MSRVTT_full_val/v2t_metrics/R1: 30.18108651911469
 MSRVTT_full_val/v2t_metrics/R5: 71.0261569416499
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.762575452716298
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.627357781521646
 MSRVTT_full_test/t2v_metrics/R1: 10.167224080267559
 MSRVTT_full_test/t2v_metrics/R5: 29.464882943143813
 MSRVTT_full_test/t2v_metrics/R10: 42.441471571906355
 MSRVTT_full_test/t2v_metrics/R50: 77.29096989966555
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.92943143812709
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.339910322381222
 MSRVTT_full_test/v2t_metrics/R1: 11.939799331103679
 MSRVTT_full_test/v2t_metrics/R5: 34.71571906354515
 MSRVTT_full_test/v2t_metrics/R10: 50.13377926421405
 MSRVTT_full_test/v2t_metrics/R50: 83.1438127090301
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.7376254180602
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.49273077126585
 mnt_best       : 23.339910322381222
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.59335 (QuantReg: 11.24922) QuantErr: 11.24922 batch_time=40.28222 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.54465 (QuantReg: 11.12907) QuantErr: 11.12907 batch_time=0.50393 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.11548 (QuantReg: 11.45550) QuantErr: 11.45550 batch_time=0.54189 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.38774 (QuantReg: 11.46848) QuantErr: 11.46848 batch_time=0.51004 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 1.94801 (QuantReg: 11.43239) QuantErr: 11.43239 batch_time=0.54848 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.19195 (QuantReg: 11.68954) QuantErr: 11.68954 batch_time=0.51024 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.21751 (QuantReg: 11.96029) QuantErr: 11.96029 batch_time=0.82264 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 1.99474 (QuantReg: 11.60527) QuantErr: 11.60527 batch_time=0.55292 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.62937 (QuantReg: 11.65399) QuantErr: 11.65399 batch_time=0.58037 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.22124 (QuantReg: 11.60020) QuantErr: 11.60020 batch_time=0.52090 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.30212 (QuantReg: 11.20187) QuantErr: 11.20187 batch_time=0.50994 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.17442 (QuantReg: 11.78745) QuantErr: 11.78745 batch_time=0.51065 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.28933 (QuantReg: 11.55613) QuantErr: 11.55613 batch_time=0.50987 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.40699 (QuantReg: 11.40170) QuantErr: 11.40170 batch_time=1.14983 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 1.94824 (QuantReg: 11.82324) QuantErr: 11.82324 batch_time=0.55997 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.08924 (QuantReg: 11.66867) QuantErr: 11.66867 batch_time=0.61838 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.51469 (QuantReg: 11.95981) QuantErr: 11.95981 batch_time=0.56255 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.27581 (QuantReg: 12.19253) QuantErr: 12.19253 batch_time=0.52008 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.28193 (QuantReg: 11.71165) QuantErr: 11.71165 batch_time=0.56838 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.13461 (QuantReg: 11.67261) QuantErr: 11.67261 batch_time=0.51778 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.13761 (QuantReg: 11.85642) QuantErr: 11.85642 batch_time=0.54045 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.30751 (QuantReg: 11.67204) QuantErr: 11.67204 batch_time=0.51481 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.35966 (QuantReg: 11.77254) QuantErr: 11.77254 batch_time=0.55472 
Train Epoch: 6 codebook_update_time=1.82769
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch6.pth ...
Done in 5.446s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch6.pth ...
Done in 10.584s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 2.340284837245941
 quant_reg      : 11.62506506729126
 quant_err      : 11.62506506729126
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 78.06841046277665
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.098591549295774
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.531258900456436
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R10: 83.5010060362173
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.253521126760563
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.30483174355487
 MSRVTT_full_test/t2v_metrics/R1: 11.33779264214047
 MSRVTT_full_test/t2v_metrics/R5: 30.468227424749163
 MSRVTT_full_test/t2v_metrics/R10: 43.779264214046826
 MSRVTT_full_test/t2v_metrics/R50: 77.55852842809365
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.29197324414716
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.729464887831178
 MSRVTT_full_test/v2t_metrics/R1: 12.54180602006689
 MSRVTT_full_test/v2t_metrics/R5: 36.220735785953174
 MSRVTT_full_test/v2t_metrics/R10: 50.836120401337794
 MSRVTT_full_test/v2t_metrics/R50: 82.876254180602
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.61153846153846
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.477153907888326
 mnt_best       : 24.729464887831178
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.40661 (QuantReg: 11.05707) QuantErr: 11.05707 batch_time=37.95921 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.09211 (QuantReg: 11.71162) QuantErr: 11.71162 batch_time=0.57302 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.38495 (QuantReg: 11.74564) QuantErr: 11.74564 batch_time=0.50994 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.19113 (QuantReg: 11.68282) QuantErr: 11.68282 batch_time=0.51298 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.06068 (QuantReg: 11.36801) QuantErr: 11.36801 batch_time=0.58407 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.30894 (QuantReg: 11.47174) QuantErr: 11.47174 batch_time=0.60897 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.37163 (QuantReg: 11.65036) QuantErr: 11.65036 batch_time=0.53639 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.40344 (QuantReg: 11.53265) QuantErr: 11.53265 batch_time=0.51026 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.37457 (QuantReg: 11.52960) QuantErr: 11.52960 batch_time=0.53480 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.14176 (QuantReg: 11.60627) QuantErr: 11.60627 batch_time=0.51494 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.41357 (QuantReg: 11.49462) QuantErr: 11.49462 batch_time=0.52106 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 1.76194 (QuantReg: 11.83174) QuantErr: 11.83174 batch_time=0.58945 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 1.92903 (QuantReg: 11.49373) QuantErr: 11.49373 batch_time=0.58696 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.19344 (QuantReg: 11.50199) QuantErr: 11.50199 batch_time=0.57280 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.23140 (QuantReg: 11.29274) QuantErr: 11.29274 batch_time=0.54816 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.01688 (QuantReg: 11.65135) QuantErr: 11.65135 batch_time=0.51560 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 1.93831 (QuantReg: 11.81394) QuantErr: 11.81394 batch_time=0.55879 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.17347 (QuantReg: 11.41331) QuantErr: 11.41331 batch_time=0.60742 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.67495 (QuantReg: 11.68602) QuantErr: 11.68602 batch_time=0.52103 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.00729 (QuantReg: 11.72759) QuantErr: 11.72759 batch_time=4.34511 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.59461 (QuantReg: 11.63562) QuantErr: 11.63562 batch_time=0.58016 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.12326 (QuantReg: 11.59038) QuantErr: 11.59038 batch_time=0.53123 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.27963 (QuantReg: 11.57055) QuantErr: 11.57055 batch_time=0.66934 
Train Epoch: 7 codebook_update_time=1.79426
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch7.pth ...
Done in 6.666s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 2.179917585849762
 quant_reg      : 11.621173519134521
 quant_err      : 11.621173519134521
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 27.766599597585515
 MSRVTT_full_val/t2v_metrics/R5: 64.78873239436619
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.164989939637827
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.20187640760736
 MSRVTT_full_val/v2t_metrics/R1: 34.80885311871227
 MSRVTT_full_val/v2t_metrics/R5: 71.83098591549296
 MSRVTT_full_val/v2t_metrics/R10: 85.71428571428571
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.255533199195171
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.843674313186014
 MSRVTT_full_test/t2v_metrics/R1: 10.735785953177258
 MSRVTT_full_test/t2v_metrics/R5: 30.401337792642142
 MSRVTT_full_test/t2v_metrics/R10: 44.280936454849495
 MSRVTT_full_test/t2v_metrics/R50: 78.39464882943143
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.08277591973244
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.358345071023688
 MSRVTT_full_test/v2t_metrics/R1: 12.575250836120402
 MSRVTT_full_test/v2t_metrics/R5: 36.98996655518395
 MSRVTT_full_test/v2t_metrics/R10: 52.04013377926422
 MSRVTT_full_test/v2t_metrics/R50: 83.64548494983278
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.42675585284281
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.92763971741934
 mnt_best       : 24.729464887831178
 not_improved_count: 1
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.19907 (QuantReg: 11.65493) QuantErr: 11.65493 batch_time=40.49276 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.30966 (QuantReg: 11.70714) QuantErr: 11.70714 batch_time=0.55615 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.60621 (QuantReg: 11.38847) QuantErr: 11.38847 batch_time=0.59805 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.18723 (QuantReg: 11.78175) QuantErr: 11.78175 batch_time=0.59635 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.30704 (QuantReg: 11.69215) QuantErr: 11.69215 batch_time=0.54663 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.22150 (QuantReg: 11.57495) QuantErr: 11.57495 batch_time=0.54189 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 1.93148 (QuantReg: 11.93077) QuantErr: 11.93077 batch_time=2.09630 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 1.95852 (QuantReg: 11.95084) QuantErr: 11.95084 batch_time=0.61754 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.32653 (QuantReg: 11.73135) QuantErr: 11.73135 batch_time=0.51594 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.05029 (QuantReg: 11.48753) QuantErr: 11.48753 batch_time=0.51642 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.02202 (QuantReg: 11.86049) QuantErr: 11.86049 batch_time=0.60723 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.50456 (QuantReg: 11.76438) QuantErr: 11.76438 batch_time=0.50318 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 1.97397 (QuantReg: 11.57116) QuantErr: 11.57116 batch_time=0.57570 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 1.84985 (QuantReg: 11.57576) QuantErr: 11.57576 batch_time=0.52209 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.43257 (QuantReg: 11.89294) QuantErr: 11.89294 batch_time=0.53008 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 1.75947 (QuantReg: 11.62036) QuantErr: 11.62036 batch_time=1.69112 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.30339 (QuantReg: 11.66820) QuantErr: 11.66820 batch_time=0.51382 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.33217 (QuantReg: 11.92832) QuantErr: 11.92832 batch_time=0.61069 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 1.66953 (QuantReg: 11.77697) QuantErr: 11.77697 batch_time=0.54617 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 1.66003 (QuantReg: 11.64679) QuantErr: 11.64679 batch_time=0.50075 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 1.69062 (QuantReg: 11.99554) QuantErr: 11.99554 batch_time=0.52610 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 1.34522 (QuantReg: 11.52314) QuantErr: 11.52314 batch_time=0.53232 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 1.67697 (QuantReg: 11.66985) QuantErr: 11.66985 batch_time=0.54570 
Train Epoch: 8 codebook_update_time=1.73764
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch8.pth ...
Done in 5.635s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch8.pth ...
Done in 10.762s
removing stale ckpt [epoch 7] [took 0.01s]
 epoch          : 8
 loss           : 2.093755865573883
 quant_reg      : 11.635057960510254
 quant_err      : 11.635057960510254
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 27.16297786720322
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 78.87323943661971
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.945674044265594
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.93713751882282
 MSRVTT_full_val/v2t_metrics/R1: 32.59557344064386
 MSRVTT_full_val/v2t_metrics/R5: 70.62374245472837
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.03420523138833
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.758436936976274
 MSRVTT_full_test/t2v_metrics/R1: 11.003344481605351
 MSRVTT_full_test/t2v_metrics/R5: 31.103678929765888
 MSRVTT_full_test/t2v_metrics/R10: 44.81605351170568
 MSRVTT_full_test/t2v_metrics/R50: 78.09364548494983
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.64448160535117
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.84601215212569
 MSRVTT_full_test/v2t_metrics/R1: 13.377926421404682
 MSRVTT_full_test/v2t_metrics/R5: 37.558528428093645
 MSRVTT_full_test/v2t_metrics/R10: 52.207357859531776
 MSRVTT_full_test/v2t_metrics/R50: 84.04682274247492
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.40200668896321
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.712762294322726
 mnt_best       : 24.84601215212569
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 2.20690 (QuantReg: 11.19340) QuantErr: 11.19340 batch_time=34.10919 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 1.92060 (QuantReg: 11.29930) QuantErr: 11.29930 batch_time=0.52632 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.27796 (QuantReg: 11.43930) QuantErr: 11.43930 batch_time=0.58279 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.20597 (QuantReg: 11.48434) QuantErr: 11.48434 batch_time=0.58015 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.50008 (QuantReg: 11.32133) QuantErr: 11.32133 batch_time=0.51108 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 2.25727 (QuantReg: 11.47133) QuantErr: 11.47133 batch_time=0.52125 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 2.00697 (QuantReg: 11.40488) QuantErr: 11.40488 batch_time=1.99377 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.67452 (QuantReg: 11.54734) QuantErr: 11.54734 batch_time=0.60118 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.21268 (QuantReg: 11.37899) QuantErr: 11.37899 batch_time=0.51152 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.99844 (QuantReg: 11.60079) QuantErr: 11.60079 batch_time=0.58359 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 2.05236 (QuantReg: 11.50801) QuantErr: 11.50801 batch_time=0.60021 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.81980 (QuantReg: 11.75173) QuantErr: 11.75173 batch_time=0.50084 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 2.03514 (QuantReg: 11.66919) QuantErr: 11.66919 batch_time=0.61991 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.07255 (QuantReg: 11.77496) QuantErr: 11.77496 batch_time=0.52930 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.14344 (QuantReg: 11.77888) QuantErr: 11.77888 batch_time=0.56192 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 2.15623 (QuantReg: 11.49101) QuantErr: 11.49101 batch_time=0.55401 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 1.60514 (QuantReg: 11.71663) QuantErr: 11.71663 batch_time=0.69276 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.66495 (QuantReg: 11.75121) QuantErr: 11.75121 batch_time=0.57874 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 1.71295 (QuantReg: 11.95378) QuantErr: 11.95378 batch_time=0.57642 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.83185 (QuantReg: 11.50524) QuantErr: 11.50524 batch_time=0.52228 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.87430 (QuantReg: 11.67666) QuantErr: 11.67666 batch_time=0.62233 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.97577 (QuantReg: 11.67441) QuantErr: 11.67441 batch_time=0.56674 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.38473 (QuantReg: 11.74274) QuantErr: 11.74274 batch_time=0.57726 
Train Epoch: 9 codebook_update_time=1.71423
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch9.pth ...
Done in 22.899s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch9.pth ...
Done in 28.001s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 1.9617829852104187
 quant_reg      : 11.606198234558105
 quant_err      : 11.606198234558105
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.724346076458753
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.19574515597089
 MSRVTT_full_val/v2t_metrics/R1: 35.010060362173036
 MSRVTT_full_val/v2t_metrics/R5: 73.2394366197183
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.2716297786720325
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.7760576346889
 MSRVTT_full_test/t2v_metrics/R1: 11.57190635451505
 MSRVTT_full_test/t2v_metrics/R5: 31.839464882943144
 MSRVTT_full_test/t2v_metrics/R10: 46.98996655518395
 MSRVTT_full_test/t2v_metrics/R50: 80.03344481605352
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.63511705685619
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.86973234892621
 MSRVTT_full_test/v2t_metrics/R1: 13.678929765886288
 MSRVTT_full_test/v2t_metrics/R5: 38.32775919732441
 MSRVTT_full_test/v2t_metrics/R10: 53.27759197324415
 MSRVTT_full_test/v2t_metrics/R50: 83.91304347826087
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.54013377926422
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.341476585392563
 mnt_best       : 25.86973234892621
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.61102 (QuantReg: 11.21761) QuantErr: 11.21761 batch_time=33.05160 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 1.85247 (QuantReg: 11.52294) QuantErr: 11.52294 batch_time=0.54785 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 1.60490 (QuantReg: 11.27076) QuantErr: 11.27076 batch_time=0.52569 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 1.55053 (QuantReg: 11.17906) QuantErr: 11.17906 batch_time=0.51907 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 1.70939 (QuantReg: 11.79498) QuantErr: 11.79498 batch_time=0.92530 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 2.35118 (QuantReg: 11.56734) QuantErr: 11.56734 batch_time=0.61147 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 1.69214 (QuantReg: 11.72706) QuantErr: 11.72706 batch_time=0.68005 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 1.81977 (QuantReg: 11.30351) QuantErr: 11.30351 batch_time=0.50060 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 1.88532 (QuantReg: 11.57197) QuantErr: 11.57197 batch_time=0.55531 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.40111 (QuantReg: 11.40131) QuantErr: 11.40131 batch_time=0.53897 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.67090 (QuantReg: 11.52390) QuantErr: 11.52390 batch_time=0.53221 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.04337 (QuantReg: 11.66258) QuantErr: 11.66258 batch_time=0.51648 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 2.21206 (QuantReg: 11.57865) QuantErr: 11.57865 batch_time=0.52171 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 2.34095 (QuantReg: 11.71697) QuantErr: 11.71697 batch_time=0.51092 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.61739 (QuantReg: 11.83615) QuantErr: 11.83615 batch_time=0.51268 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 1.50930 (QuantReg: 11.71652) QuantErr: 11.71652 batch_time=0.51993 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 2.79344 (QuantReg: 11.55478) QuantErr: 11.55478 batch_time=0.57464 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 1.68820 (QuantReg: 11.85641) QuantErr: 11.85641 batch_time=0.54505 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.67413 (QuantReg: 11.95765) QuantErr: 11.95765 batch_time=2.26941 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.65237 (QuantReg: 11.52663) QuantErr: 11.52663 batch_time=1.48524 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.64814 (QuantReg: 11.48932) QuantErr: 11.48932 batch_time=0.59003 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 2.34367 (QuantReg: 11.61227) QuantErr: 11.61227 batch_time=0.53725 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 2.10852 (QuantReg: 11.44310) QuantErr: 11.44310 batch_time=0.50585 
Train Epoch: 10 codebook_update_time=1.70695
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch10.pth ...
Done in 23.035s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 1.8629838514328003
 quant_reg      : 11.587866710662842
 quant_err      : 11.587866710662842
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.028169014084508
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.25802894351553
 MSRVTT_full_val/v2t_metrics/R1: 35.2112676056338
 MSRVTT_full_val/v2t_metrics/R5: 73.64185110663983
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.160965794768612
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.62139802120216
 MSRVTT_full_test/t2v_metrics/R1: 11.404682274247492
 MSRVTT_full_test/t2v_metrics/R5: 31.93979933110368
 MSRVTT_full_test/t2v_metrics/R10: 46.15384615384615
 MSRVTT_full_test/t2v_metrics/R50: 79.79933110367892
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.37157190635452
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.617756344080327
 MSRVTT_full_test/v2t_metrics/R1: 13.545150501672241
 MSRVTT_full_test/v2t_metrics/R5: 38.96321070234114
 MSRVTT_full_test/v2t_metrics/R10: 53.779264214046826
 MSRVTT_full_test/v2t_metrics/R50: 85.15050167224081
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.496989966555184
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.50360318610667
 mnt_best       : 25.86973234892621
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 1.72795 (QuantReg: 11.40042) QuantErr: 11.40042 batch_time=36.16041 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 1.48746 (QuantReg: 11.60921) QuantErr: 11.60921 batch_time=0.85130 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 1.83301 (QuantReg: 11.26380) QuantErr: 11.26380 batch_time=0.51712 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 1.90048 (QuantReg: 11.61469) QuantErr: 11.61469 batch_time=0.61636 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 1.85194 (QuantReg: 11.90867) QuantErr: 11.90867 batch_time=0.57019 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 1.58865 (QuantReg: 11.68125) QuantErr: 11.68125 batch_time=0.52841 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 2.00478 (QuantReg: 11.40169) QuantErr: 11.40169 batch_time=0.52727 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 1.63320 (QuantReg: 11.82310) QuantErr: 11.82310 batch_time=0.52199 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.66200 (QuantReg: 11.47217) QuantErr: 11.47217 batch_time=0.52191 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 2.04585 (QuantReg: 11.43656) QuantErr: 11.43656 batch_time=0.51302 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 2.07096 (QuantReg: 11.40209) QuantErr: 11.40209 batch_time=0.63289 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.80540 (QuantReg: 11.90274) QuantErr: 11.90274 batch_time=1.07458 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 2.30232 (QuantReg: 11.37877) QuantErr: 11.37877 batch_time=0.56912 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 2.00121 (QuantReg: 11.47518) QuantErr: 11.47518 batch_time=0.52806 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.71700 (QuantReg: 11.36317) QuantErr: 11.36317 batch_time=0.50673 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 1.75484 (QuantReg: 11.45068) QuantErr: 11.45068 batch_time=0.51403 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.74273 (QuantReg: 11.30688) QuantErr: 11.30688 batch_time=0.51988 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.49201 (QuantReg: 11.52070) QuantErr: 11.52070 batch_time=0.53791 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.56417 (QuantReg: 11.99835) QuantErr: 11.99835 batch_time=5.17426 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.87757 (QuantReg: 11.74767) QuantErr: 11.74767 batch_time=0.60105 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.91059 (QuantReg: 12.07938) QuantErr: 12.07938 batch_time=0.53966 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.61798 (QuantReg: 11.73509) QuantErr: 11.73509 batch_time=0.53427 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.45647 (QuantReg: 12.17063) QuantErr: 12.17063 batch_time=0.59776 
Train Epoch: 11 codebook_update_time=2.29293
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch11.pth ...
Done in 4.569s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch11.pth ...
Done in 8.770s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 1.7771258697509766
 quant_reg      : 11.6400193901062
 quant_err      : 11.6400193901062
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 27.96780684104628
 MSRVTT_full_val/t2v_metrics/R5: 65.79476861167002
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.853118712273641
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.50774668213979
 MSRVTT_full_val/v2t_metrics/R1: 37.02213279678068
 MSRVTT_full_val/v2t_metrics/R5: 72.63581488933602
 MSRVTT_full_val/v2t_metrics/R10: 85.31187122736418
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.2434607645875255
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.217262512921465
 MSRVTT_full_test/t2v_metrics/R1: 11.605351170568563
 MSRVTT_full_test/t2v_metrics/R5: 33.64548494983278
 MSRVTT_full_test/t2v_metrics/R10: 45.48494983277592
 MSRVTT_full_test/t2v_metrics/R50: 78.72909698996655
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.78829431438127
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.09061199770579
 MSRVTT_full_test/v2t_metrics/R1: 13.812709030100335
 MSRVTT_full_test/v2t_metrics/R5: 39.264214046822744
 MSRVTT_full_test/v2t_metrics/R10: 53.37792642140468
 MSRVTT_full_test/v2t_metrics/R50: 84.44816053511705
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.09548494983277
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.705239569786624
 mnt_best       : 26.09061199770579
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.72793 (QuantReg: 11.52650) QuantErr: 11.52650 batch_time=37.75331 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.99751 (QuantReg: 11.66045) QuantErr: 11.66045 batch_time=0.55933 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.53140 (QuantReg: 11.41864) QuantErr: 11.41864 batch_time=0.50598 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 1.57125 (QuantReg: 11.52532) QuantErr: 11.52532 batch_time=0.55336 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.44005 (QuantReg: 11.76022) QuantErr: 11.76022 batch_time=0.60451 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.83135 (QuantReg: 11.51352) QuantErr: 11.51352 batch_time=0.58667 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.48991 (QuantReg: 11.56724) QuantErr: 11.56724 batch_time=0.49573 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.70737 (QuantReg: 11.53901) QuantErr: 11.53901 batch_time=3.57606 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.54656 (QuantReg: 11.47422) QuantErr: 11.47422 batch_time=0.50763 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.94682 (QuantReg: 11.50401) QuantErr: 11.50401 batch_time=0.58889 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.39847 (QuantReg: 11.51711) QuantErr: 11.51711 batch_time=0.52796 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.83876 (QuantReg: 11.58532) QuantErr: 11.58532 batch_time=0.62877 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.52568 (QuantReg: 11.69342) QuantErr: 11.69342 batch_time=0.51515 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.45302 (QuantReg: 11.98818) QuantErr: 11.98818 batch_time=0.50574 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.80402 (QuantReg: 11.46289) QuantErr: 11.46289 batch_time=0.56898 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.28027 (QuantReg: 11.75695) QuantErr: 11.75695 batch_time=0.52403 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.42436 (QuantReg: 11.62524) QuantErr: 11.62524 batch_time=0.56984 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 2.17225 (QuantReg: 11.40473) QuantErr: 11.40473 batch_time=0.51355 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.82361 (QuantReg: 11.45098) QuantErr: 11.45098 batch_time=0.65373 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 2.03339 (QuantReg: 11.49326) QuantErr: 11.49326 batch_time=0.52173 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.75164 (QuantReg: 11.19897) QuantErr: 11.19897 batch_time=0.59891 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.65719 (QuantReg: 11.78705) QuantErr: 11.78705 batch_time=0.51029 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.83213 (QuantReg: 11.99819) QuantErr: 11.99819 batch_time=0.58788 
Train Epoch: 12 codebook_update_time=2.07048
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch12.pth ...
Done in 4.426s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch12.pth ...
Done in 8.628s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 1.7092913761138917
 quant_reg      : 11.60410792541504
 quant_err      : 11.60410792541504
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 65.79476861167002
 MSRVTT_full_val/t2v_metrics/R10: 78.87323943661971
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.251509054325956
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.61304821720724
 MSRVTT_full_val/v2t_metrics/R1: 35.412474849094565
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 85.71428571428571
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.442655935613682
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.23696363283803
 MSRVTT_full_test/t2v_metrics/R1: 12.006688963210703
 MSRVTT_full_test/t2v_metrics/R5: 33.47826086956522
 MSRVTT_full_test/t2v_metrics/R10: 46.78929765886288
 MSRVTT_full_test/t2v_metrics/R50: 79.6989966555184
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.39163879598662
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.593626108500633
 MSRVTT_full_test/v2t_metrics/R1: 13.210702341137123
 MSRVTT_full_test/v2t_metrics/R5: 40.03344481605351
 MSRVTT_full_test/v2t_metrics/R10: 55.1505016722408
 MSRVTT_full_test/v2t_metrics/R50: 85.35117056856187
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.436120401337796
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.782185114839322
 mnt_best       : 26.593626108500633
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.59158 (QuantReg: 11.61705) QuantErr: 11.61705 batch_time=36.25209 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 2.28670 (QuantReg: 11.02643) QuantErr: 11.02643 batch_time=0.50242 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.81709 (QuantReg: 11.71812) QuantErr: 11.71812 batch_time=0.54697 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.46106 (QuantReg: 11.67252) QuantErr: 11.67252 batch_time=0.53171 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.57473 (QuantReg: 11.65146) QuantErr: 11.65146 batch_time=0.54950 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.63882 (QuantReg: 11.89000) QuantErr: 11.89000 batch_time=0.55349 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.75302 (QuantReg: 11.79594) QuantErr: 11.79594 batch_time=0.72011 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 2.03178 (QuantReg: 11.92260) QuantErr: 11.92260 batch_time=1.35448 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.36340 (QuantReg: 11.31789) QuantErr: 11.31789 batch_time=0.50800 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.75147 (QuantReg: 11.54757) QuantErr: 11.54757 batch_time=0.53378 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.69149 (QuantReg: 11.45167) QuantErr: 11.45167 batch_time=0.51272 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.32511 (QuantReg: 11.65325) QuantErr: 11.65325 batch_time=0.52319 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.60727 (QuantReg: 11.65968) QuantErr: 11.65968 batch_time=0.96482 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.55614 (QuantReg: 11.80621) QuantErr: 11.80621 batch_time=0.61875 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.86800 (QuantReg: 11.36281) QuantErr: 11.36281 batch_time=0.51603 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.45794 (QuantReg: 11.49675) QuantErr: 11.49675 batch_time=0.51974 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.30106 (QuantReg: 11.84064) QuantErr: 11.84064 batch_time=0.54628 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.97968 (QuantReg: 11.45084) QuantErr: 11.45084 batch_time=0.51940 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.39861 (QuantReg: 12.00076) QuantErr: 12.00076 batch_time=0.52664 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.93260 (QuantReg: 11.79449) QuantErr: 11.79449 batch_time=2.51369 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.97482 (QuantReg: 11.84524) QuantErr: 11.84524 batch_time=0.56618 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.62955 (QuantReg: 11.66097) QuantErr: 11.66097 batch_time=0.92027 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.67232 (QuantReg: 11.76225) QuantErr: 11.76225 batch_time=0.53727 
Train Epoch: 13 codebook_update_time=1.79681
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch13.pth ...
Done in 4.248s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch13.pth ...
Done in 8.613s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 1.6453655591011047
 quant_reg      : 11.64262022781372
 quant_err      : 11.64262022781372
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 30.58350100603622
 MSRVTT_full_val/t2v_metrics/R5: 67.00201207243461
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.046277665995976
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.56384405460885
 MSRVTT_full_val/v2t_metrics/R1: 36.82092555331992
 MSRVTT_full_val/v2t_metrics/R5: 74.44668008048289
 MSRVTT_full_val/v2t_metrics/R10: 84.30583501006036
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.3762575452716295
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.366669926534655
 MSRVTT_full_test/t2v_metrics/R1: 11.438127090301004
 MSRVTT_full_test/t2v_metrics/R5: 34.54849498327759
 MSRVTT_full_test/t2v_metrics/R10: 47.65886287625418
 MSRVTT_full_test/t2v_metrics/R50: 80.50167224080268
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.04113712374582
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.605774691678516
 MSRVTT_full_test/v2t_metrics/R1: 14.347826086956522
 MSRVTT_full_test/v2t_metrics/R5: 39.83277591973244
 MSRVTT_full_test/v2t_metrics/R10: 54.98327759197324
 MSRVTT_full_test/v2t_metrics/R50: 85.75250836120401
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.15351170568562
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.556277557393592
 mnt_best       : 26.605774691678516
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.47511 (QuantReg: 11.62300) QuantErr: 11.62300 batch_time=39.65243 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 2.11674 (QuantReg: 11.89652) QuantErr: 11.89652 batch_time=0.52499 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.52221 (QuantReg: 11.76492) QuantErr: 11.76492 batch_time=0.60097 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.54415 (QuantReg: 11.61810) QuantErr: 11.61810 batch_time=1.54147 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.88749 (QuantReg: 11.58026) QuantErr: 11.58026 batch_time=1.03392 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.54973 (QuantReg: 11.58943) QuantErr: 11.58943 batch_time=0.51481 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.94067 (QuantReg: 11.60915) QuantErr: 11.60915 batch_time=0.58672 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.73766 (QuantReg: 11.31845) QuantErr: 11.31845 batch_time=0.51110 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.27546 (QuantReg: 11.38786) QuantErr: 11.38786 batch_time=0.53649 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.56218 (QuantReg: 11.39961) QuantErr: 11.39961 batch_time=0.52510 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.44905 (QuantReg: 11.67322) QuantErr: 11.67322 batch_time=0.58031 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.73960 (QuantReg: 11.33343) QuantErr: 11.33343 batch_time=0.54800 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.44818 (QuantReg: 11.93923) QuantErr: 11.93923 batch_time=0.50962 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.32034 (QuantReg: 11.71851) QuantErr: 11.71851 batch_time=0.50672 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.53741 (QuantReg: 11.72583) QuantErr: 11.72583 batch_time=0.51615 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.30552 (QuantReg: 11.73163) QuantErr: 11.73163 batch_time=0.59152 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.30808 (QuantReg: 11.38637) QuantErr: 11.38637 batch_time=0.51731 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.77235 (QuantReg: 11.86670) QuantErr: 11.86670 batch_time=0.51240 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.44524 (QuantReg: 11.57985) QuantErr: 11.57985 batch_time=0.58448 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.85285 (QuantReg: 11.32318) QuantErr: 11.32318 batch_time=0.78479 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.61649 (QuantReg: 11.72989) QuantErr: 11.72989 batch_time=0.55199 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.45945 (QuantReg: 11.84936) QuantErr: 11.84936 batch_time=0.52450 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.48618 (QuantReg: 11.66719) QuantErr: 11.66719 batch_time=0.56006 
Train Epoch: 14 codebook_update_time=2.10078
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch14.pth ...
Done in 4.882s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 1.5956147027015686
 quant_reg      : 11.635172561645508
 quant_err      : 11.635172561645508
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 29.77867203219316
 MSRVTT_full_val/t2v_metrics/R5: 65.99597585513078
 MSRVTT_full_val/t2v_metrics/R10: 77.8672032193159
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.768611670020121
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.488339931925964
 MSRVTT_full_val/v2t_metrics/R1: 38.83299798792756
 MSRVTT_full_val/v2t_metrics/R5: 71.0261569416499
 MSRVTT_full_val/v2t_metrics/R10: 82.897384305835
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.301810865191147
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.14862390531215
 MSRVTT_full_test/t2v_metrics/R1: 11.605351170568563
 MSRVTT_full_test/t2v_metrics/R5: 31.57190635451505
 MSRVTT_full_test/t2v_metrics/R10: 45.752508361204015
 MSRVTT_full_test/t2v_metrics/R50: 78.72909698996655
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.73076923076923
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.593204517047404
 MSRVTT_full_test/v2t_metrics/R1: 13.779264214046822
 MSRVTT_full_test/v2t_metrics/R5: 38.09364548494983
 MSRVTT_full_test/v2t_metrics/R10: 52.90969899665552
 MSRVTT_full_test/v2t_metrics/R50: 84.21404682274247
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.28494983277592
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.28339896154844
 mnt_best       : 26.605774691678516
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.95249 (QuantReg: 11.33286) QuantErr: 11.33286 batch_time=35.52925 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.56161 (QuantReg: 11.50145) QuantErr: 11.50145 batch_time=0.56127 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.58614 (QuantReg: 11.60115) QuantErr: 11.60115 batch_time=0.55623 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.63981 (QuantReg: 11.47667) QuantErr: 11.47667 batch_time=0.51336 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.59922 (QuantReg: 11.81721) QuantErr: 11.81721 batch_time=0.50904 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.71815 (QuantReg: 11.21412) QuantErr: 11.21412 batch_time=0.60266 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.89546 (QuantReg: 11.46809) QuantErr: 11.46809 batch_time=2.35477 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.40888 (QuantReg: 11.62913) QuantErr: 11.62913 batch_time=0.50947 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.85109 (QuantReg: 11.64462) QuantErr: 11.64462 batch_time=0.57524 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.51165 (QuantReg: 11.70871) QuantErr: 11.70871 batch_time=0.52838 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.76771 (QuantReg: 11.51316) QuantErr: 11.51316 batch_time=0.50157 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.30209 (QuantReg: 11.43328) QuantErr: 11.43328 batch_time=0.56658 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.47371 (QuantReg: 11.55328) QuantErr: 11.55328 batch_time=0.54371 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.85570 (QuantReg: 11.71335) QuantErr: 11.71335 batch_time=0.54578 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.58508 (QuantReg: 11.38414) QuantErr: 11.38414 batch_time=0.52603 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.60457 (QuantReg: 11.81451) QuantErr: 11.81451 batch_time=0.83264 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.82673 (QuantReg: 11.87243) QuantErr: 11.87243 batch_time=0.54491 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.44265 (QuantReg: 11.70019) QuantErr: 11.70019 batch_time=0.50604 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.42991 (QuantReg: 11.71539) QuantErr: 11.71539 batch_time=0.52293 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.71918 (QuantReg: 11.37422) QuantErr: 11.37422 batch_time=0.58122 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.82907 (QuantReg: 11.75482) QuantErr: 11.75482 batch_time=0.61090 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.71728 (QuantReg: 11.71305) QuantErr: 11.71305 batch_time=0.72839 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.67209 (QuantReg: 11.51295) QuantErr: 11.51295 batch_time=0.54545 
Train Epoch: 15 codebook_update_time=1.75584
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch15.pth ...
Done in 8.110s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch15.pth ...
Done in 12.466s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 1.5406653852462768
 quant_reg      : 11.637196418762207
 quant_err      : 11.637196418762207
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 31.58953722334004
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.301810865191147
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.87466755615601
 MSRVTT_full_val/v2t_metrics/R1: 38.6317907444668
 MSRVTT_full_val/v2t_metrics/R5: 74.64788732394366
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.480885311871227
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.807467512900466
 MSRVTT_full_test/t2v_metrics/R1: 12.74247491638796
 MSRVTT_full_test/t2v_metrics/R5: 34.34782608695652
 MSRVTT_full_test/t2v_metrics/R10: 48.82943143812709
 MSRVTT_full_test/t2v_metrics/R50: 80.36789297658864
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.25183946488294
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.750974393517776
 MSRVTT_full_test/v2t_metrics/R1: 14.648829431438127
 MSRVTT_full_test/v2t_metrics/R5: 40.53511705685619
 MSRVTT_full_test/v2t_metrics/R10: 54.91638795986622
 MSRVTT_full_test/v2t_metrics/R50: 85.61872909698997
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.24264214046823
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.948129737499723
 mnt_best       : 27.750974393517776
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.38967 (QuantReg: 11.19700) QuantErr: 11.19700 batch_time=38.60719 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.48405 (QuantReg: 11.88180) QuantErr: 11.88180 batch_time=0.57206 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.70023 (QuantReg: 11.55248) QuantErr: 11.55248 batch_time=0.59053 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 1.35903 (QuantReg: 11.83343) QuantErr: 11.83343 batch_time=0.53501 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.41448 (QuantReg: 11.56145) QuantErr: 11.56145 batch_time=0.52743 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.55022 (QuantReg: 11.52520) QuantErr: 11.52520 batch_time=0.56503 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.64824 (QuantReg: 11.95065) QuantErr: 11.95065 batch_time=0.54926 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.42914 (QuantReg: 11.58575) QuantErr: 11.58575 batch_time=0.51184 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.46573 (QuantReg: 11.88034) QuantErr: 11.88034 batch_time=0.59204 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.31095 (QuantReg: 11.64007) QuantErr: 11.64007 batch_time=0.57505 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.58008 (QuantReg: 12.04154) QuantErr: 12.04154 batch_time=0.56147 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.66370 (QuantReg: 11.83114) QuantErr: 11.83114 batch_time=0.52506 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.62895 (QuantReg: 11.61180) QuantErr: 11.61180 batch_time=3.94442 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.34983 (QuantReg: 11.73126) QuantErr: 11.73126 batch_time=0.54137 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.68036 (QuantReg: 11.73254) QuantErr: 11.73254 batch_time=0.52233 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.40918 (QuantReg: 11.71939) QuantErr: 11.71939 batch_time=0.50571 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.67310 (QuantReg: 11.38258) QuantErr: 11.38258 batch_time=0.54823 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.21411 (QuantReg: 11.75091) QuantErr: 11.75091 batch_time=0.53391 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.58045 (QuantReg: 11.74327) QuantErr: 11.74327 batch_time=0.50219 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.37752 (QuantReg: 11.78267) QuantErr: 11.78267 batch_time=2.96375 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.35506 (QuantReg: 11.87697) QuantErr: 11.87697 batch_time=0.56308 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.41183 (QuantReg: 11.50495) QuantErr: 11.50495 batch_time=0.60393 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.54017 (QuantReg: 11.90303) QuantErr: 11.90303 batch_time=0.49755 
Train Epoch: 16 codebook_update_time=2.04082
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch16.pth ...
Done in 4.199s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 1.5120905299186707
 quant_reg      : 11.660480098724365
 quant_err      : 11.660480098724365
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.03420523138833
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.83266327875582
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 74.04426559356136
 MSRVTT_full_val/v2t_metrics/R10: 85.31187122736418
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.046277665995976
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.83283385908818
 MSRVTT_full_test/t2v_metrics/R1: 12.54180602006689
 MSRVTT_full_test/t2v_metrics/R5: 33.57859531772575
 MSRVTT_full_test/t2v_metrics/R10: 49.297658862876254
 MSRVTT_full_test/t2v_metrics/R50: 81.1371237458194
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.00066889632107
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.484191530021
 MSRVTT_full_test/v2t_metrics/R1: 14.983277591973245
 MSRVTT_full_test/v2t_metrics/R5: 41.03678929765886
 MSRVTT_full_test/v2t_metrics/R10: 57.05685618729097
 MSRVTT_full_test/v2t_metrics/R50: 85.25083612040133
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.99264214046823
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.73628147275771
 mnt_best       : 27.750974393517776
 not_improved_count: 1
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.52924 (QuantReg: 11.44215) QuantErr: 11.44215 batch_time=34.80615 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.67568 (QuantReg: 11.59070) QuantErr: 11.59070 batch_time=0.50262 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.31534 (QuantReg: 11.58313) QuantErr: 11.58313 batch_time=0.88688 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.34856 (QuantReg: 11.48173) QuantErr: 11.48173 batch_time=0.64843 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.68378 (QuantReg: 11.50370) QuantErr: 11.50370 batch_time=0.62673 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.32750 (QuantReg: 11.39568) QuantErr: 11.39568 batch_time=0.53891 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.25057 (QuantReg: 12.01171) QuantErr: 12.01171 batch_time=0.61510 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.53549 (QuantReg: 11.61375) QuantErr: 11.61375 batch_time=0.53108 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.36977 (QuantReg: 11.97284) QuantErr: 11.97284 batch_time=0.56336 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.43253 (QuantReg: 11.85774) QuantErr: 11.85774 batch_time=0.54370 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.49243 (QuantReg: 11.80580) QuantErr: 11.80580 batch_time=1.34016 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.57051 (QuantReg: 11.51021) QuantErr: 11.51021 batch_time=0.57928 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.27199 (QuantReg: 11.59122) QuantErr: 11.59122 batch_time=0.52312 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.88669 (QuantReg: 11.55232) QuantErr: 11.55232 batch_time=0.54071 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.48271 (QuantReg: 11.93392) QuantErr: 11.93392 batch_time=0.54082 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.29242 (QuantReg: 11.38958) QuantErr: 11.38958 batch_time=0.53928 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.35910 (QuantReg: 11.53206) QuantErr: 11.53206 batch_time=0.56153 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.29088 (QuantReg: 11.70455) QuantErr: 11.70455 batch_time=0.51683 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.70843 (QuantReg: 12.02853) QuantErr: 12.02853 batch_time=0.52682 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.46244 (QuantReg: 11.95339) QuantErr: 11.95339 batch_time=0.54919 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.22254 (QuantReg: 11.70555) QuantErr: 11.70555 batch_time=1.63801 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.57041 (QuantReg: 12.03079) QuantErr: 12.03079 batch_time=0.53801 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.39473 (QuantReg: 11.65862) QuantErr: 11.65862 batch_time=0.52626 
Train Epoch: 17 codebook_update_time=2.16975
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch17.pth ...
Done in 16.467s
removing stale ckpt [epoch 16] [took 0.27s]
 epoch          : 17
 loss           : 1.4610001926422118
 quant_reg      : 11.691161998748779
 quant_err      : 11.691161998748779
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.267605633802816
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.79943274378571
 MSRVTT_full_val/v2t_metrics/R1: 35.2112676056338
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.663983903420523
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.10753303652451
 MSRVTT_full_test/t2v_metrics/R1: 12.575250836120402
 MSRVTT_full_test/t2v_metrics/R5: 34.448160535117054
 MSRVTT_full_test/t2v_metrics/R10: 47.85953177257525
 MSRVTT_full_test/t2v_metrics/R50: 80.5351170568562
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.42274247491639
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.471584722785813
 MSRVTT_full_test/v2t_metrics/R1: 13.946488294314381
 MSRVTT_full_test/v2t_metrics/R5: 40.702341137123746
 MSRVTT_full_test/v2t_metrics/R10: 55.551839464882946
 MSRVTT_full_test/v2t_metrics/R50: 84.54849498327759
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.44632107023411
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.593244867866183
 mnt_best       : 27.750974393517776
 not_improved_count: 2
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.72300 (QuantReg: 11.63003) QuantErr: 11.63003 batch_time=42.39730 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.41220 (QuantReg: 11.68285) QuantErr: 11.68285 batch_time=0.55535 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.41356 (QuantReg: 11.44371) QuantErr: 11.44371 batch_time=0.55627 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.34176 (QuantReg: 11.40932) QuantErr: 11.40932 batch_time=0.50838 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.57469 (QuantReg: 11.55636) QuantErr: 11.55636 batch_time=0.57799 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.45809 (QuantReg: 11.72166) QuantErr: 11.72166 batch_time=0.53117 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.76195 (QuantReg: 11.63643) QuantErr: 11.63643 batch_time=0.57680 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.64957 (QuantReg: 11.75714) QuantErr: 11.75714 batch_time=0.54093 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.27843 (QuantReg: 11.45759) QuantErr: 11.45759 batch_time=0.57772 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.30038 (QuantReg: 11.62817) QuantErr: 11.62817 batch_time=0.53296 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.21069 (QuantReg: 11.63849) QuantErr: 11.63849 batch_time=0.58769 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.74048 (QuantReg: 11.53030) QuantErr: 11.53030 batch_time=0.51412 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.79855 (QuantReg: 11.81742) QuantErr: 11.81742 batch_time=3.90459 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.27902 (QuantReg: 11.64670) QuantErr: 11.64670 batch_time=0.53890 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.50494 (QuantReg: 11.86849) QuantErr: 11.86849 batch_time=0.79129 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.70347 (QuantReg: 11.81804) QuantErr: 11.81804 batch_time=0.51134 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.34031 (QuantReg: 11.75602) QuantErr: 11.75602 batch_time=0.50899 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.18616 (QuantReg: 11.82136) QuantErr: 11.82136 batch_time=0.55189 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.38459 (QuantReg: 11.64558) QuantErr: 11.64558 batch_time=0.53461 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.79130 (QuantReg: 11.81494) QuantErr: 11.81494 batch_time=0.53861 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.42554 (QuantReg: 11.72934) QuantErr: 11.72934 batch_time=1.74542 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 0.98439 (QuantReg: 11.76814) QuantErr: 11.76814 batch_time=0.57916 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.34402 (QuantReg: 11.71633) QuantErr: 11.71633 batch_time=0.59113 
Train Epoch: 18 codebook_update_time=1.89318
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch18.pth ...
Done in 4.472s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch18.pth ...
Done in 8.672s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 1.4215717062950135
 quant_reg      : 11.666987941741944
 quant_err      : 11.666987941741944
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 31.58953722334004
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.577464788732394
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.63330529206978
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 86.31790744466801
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.774647887323944
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.29903745599961
 MSRVTT_full_test/t2v_metrics/R1: 12.775919732441471
 MSRVTT_full_test/t2v_metrics/R5: 34.78260869565217
 MSRVTT_full_test/t2v_metrics/R10: 49.130434782608695
 MSRVTT_full_test/t2v_metrics/R50: 81.00334448160535
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.205016722408025
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.94913111250171
 MSRVTT_full_test/v2t_metrics/R1: 15.384615384615385
 MSRVTT_full_test/v2t_metrics/R5: 41.23745819397993
 MSRVTT_full_test/v2t_metrics/R10: 56.32107023411371
 MSRVTT_full_test/v2t_metrics/R50: 84.98327759197325
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.3133779264214
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.93693202356661
 mnt_best       : 27.94913111250171
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.25910 (QuantReg: 11.75850) QuantErr: 11.75850 batch_time=51.10414 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.47284 (QuantReg: 11.70111) QuantErr: 11.70111 batch_time=0.52050 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.54458 (QuantReg: 11.50561) QuantErr: 11.50561 batch_time=0.55386 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.46339 (QuantReg: 11.81046) QuantErr: 11.81046 batch_time=0.52297 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.38886 (QuantReg: 11.79627) QuantErr: 11.79627 batch_time=0.54547 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.47496 (QuantReg: 11.77521) QuantErr: 11.77521 batch_time=0.52511 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.37728 (QuantReg: 11.61907) QuantErr: 11.61907 batch_time=0.52766 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.66728 (QuantReg: 11.95691) QuantErr: 11.95691 batch_time=0.62645 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.49210 (QuantReg: 11.46635) QuantErr: 11.46635 batch_time=0.52548 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.33761 (QuantReg: 11.68888) QuantErr: 11.68888 batch_time=0.53369 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.24513 (QuantReg: 11.76822) QuantErr: 11.76822 batch_time=0.55294 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.41632 (QuantReg: 11.83393) QuantErr: 11.83393 batch_time=0.61036 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.41254 (QuantReg: 11.72943) QuantErr: 11.72943 batch_time=0.50472 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.05644 (QuantReg: 11.47269) QuantErr: 11.47269 batch_time=0.55269 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.44609 (QuantReg: 11.75911) QuantErr: 11.75911 batch_time=0.51839 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.02083 (QuantReg: 11.52413) QuantErr: 11.52413 batch_time=0.55555 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.50618 (QuantReg: 11.82954) QuantErr: 11.82954 batch_time=0.50324 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.54362 (QuantReg: 11.78333) QuantErr: 11.78333 batch_time=0.52321 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.35565 (QuantReg: 11.64542) QuantErr: 11.64542 batch_time=0.55942 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.05600 (QuantReg: 11.81439) QuantErr: 11.81439 batch_time=0.57911 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.08895 (QuantReg: 11.78739) QuantErr: 11.78739 batch_time=0.52855 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.19149 (QuantReg: 11.77252) QuantErr: 11.77252 batch_time=0.58759 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.38824 (QuantReg: 11.52080) QuantErr: 11.52080 batch_time=0.51834 
Train Epoch: 19 codebook_update_time=1.69034
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch19.pth ...
Done in 4.086s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 1.3767446472644806
 quant_reg      : 11.682059490203857
 quant_err      : 11.682059490203857
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_full_val/t2v_metrics/R1: 29.577464788732396
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.476861167002012
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.24903483419409
 MSRVTT_full_val/v2t_metrics/R1: 35.010060362173036
 MSRVTT_full_val/v2t_metrics/R5: 74.64788732394366
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.7364185110663986
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.493961999366235
 MSRVTT_full_test/t2v_metrics/R1: 12.240802675585284
 MSRVTT_full_test/t2v_metrics/R5: 34.280936454849495
 MSRVTT_full_test/t2v_metrics/R10: 48.99665551839465
 MSRVTT_full_test/t2v_metrics/R50: 80.40133779264214
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.35317725752508
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.395317420982874
 MSRVTT_full_test/v2t_metrics/R1: 14.715719063545151
 MSRVTT_full_test/v2t_metrics/R5: 40.5685618729097
 MSRVTT_full_test/v2t_metrics/R10: 56.45484949832776
 MSRVTT_full_test/v2t_metrics/R50: 85.95317725752508
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.370903010033445
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.301606201971346
 mnt_best       : 27.94913111250171
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.51670 (QuantReg: 11.55888) QuantErr: 11.55888 batch_time=38.34090 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.43652 (QuantReg: 11.45706) QuantErr: 11.45706 batch_time=3.53617 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.35765 (QuantReg: 11.54569) QuantErr: 11.54569 batch_time=0.54871 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.30655 (QuantReg: 11.90720) QuantErr: 11.90720 batch_time=0.57826 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.51208 (QuantReg: 11.87092) QuantErr: 11.87092 batch_time=0.56111 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.32893 (QuantReg: 11.42790) QuantErr: 11.42790 batch_time=1.33818 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.29875 (QuantReg: 11.77080) QuantErr: 11.77080 batch_time=4.32904 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.15880 (QuantReg: 11.68704) QuantErr: 11.68704 batch_time=0.51423 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.69009 (QuantReg: 11.40436) QuantErr: 11.40436 batch_time=0.53583 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.36289 (QuantReg: 11.90532) QuantErr: 11.90532 batch_time=0.50902 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.20004 (QuantReg: 11.87488) QuantErr: 11.87488 batch_time=0.62753 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.08714 (QuantReg: 11.68755) QuantErr: 11.68755 batch_time=0.54318 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.44204 (QuantReg: 11.59716) QuantErr: 11.59716 batch_time=0.51560 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.45642 (QuantReg: 11.62528) QuantErr: 11.62528 batch_time=0.59874 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.55455 (QuantReg: 11.48706) QuantErr: 11.48706 batch_time=0.58738 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.64822 (QuantReg: 11.84748) QuantErr: 11.84748 batch_time=0.57043 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.40385 (QuantReg: 12.02460) QuantErr: 12.02460 batch_time=0.50677 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.32397 (QuantReg: 11.98233) QuantErr: 11.98233 batch_time=0.51979 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.22049 (QuantReg: 11.59809) QuantErr: 11.59809 batch_time=0.51523 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.73062 (QuantReg: 11.44642) QuantErr: 11.44642 batch_time=0.50422 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.93272 (QuantReg: 11.47687) QuantErr: 11.47687 batch_time=0.51704 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.33116 (QuantReg: 11.68010) QuantErr: 11.68010 batch_time=0.58098 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.06629 (QuantReg: 11.97194) QuantErr: 11.97194 batch_time=0.56690 
Train Epoch: 20 codebook_update_time=2.06062
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch20.pth ...
Done in 13.198s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 1.3697604122161866
 quant_reg      : 11.665368759155273
 quant_err      : 11.665368759155273
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.517102615694165
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.8448724430479
 MSRVTT_full_val/v2t_metrics/R1: 39.436619718309856
 MSRVTT_full_val/v2t_metrics/R5: 73.44064386317908
 MSRVTT_full_val/v2t_metrics/R10: 84.90945674044265
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.565392354124748
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.65139423899649
 MSRVTT_full_test/t2v_metrics/R1: 12.408026755852843
 MSRVTT_full_test/t2v_metrics/R5: 35.51839464882943
 MSRVTT_full_test/t2v_metrics/R10: 48.46153846153846
 MSRVTT_full_test/t2v_metrics/R50: 81.60535117056857
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.61538461538461
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.744979970026893
 MSRVTT_full_test/v2t_metrics/R1: 14.949832775919733
 MSRVTT_full_test/v2t_metrics/R5: 41.30434782608695
 MSRVTT_full_test/v2t_metrics/R10: 56.2876254180602
 MSRVTT_full_test/v2t_metrics/R50: 86.05351170568562
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.812207357859535
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.63485423517324
 mnt_best       : 27.94913111250171
 not_improved_count: 2
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.26921 (QuantReg: 11.58078) QuantErr: 11.58078 batch_time=40.48818 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.38600 (QuantReg: 11.71951) QuantErr: 11.71951 batch_time=0.51101 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.37118 (QuantReg: 11.45020) QuantErr: 11.45020 batch_time=0.53449 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.15126 (QuantReg: 11.87770) QuantErr: 11.87770 batch_time=0.55585 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.03547 (QuantReg: 11.64807) QuantErr: 11.64807 batch_time=0.50160 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.07700 (QuantReg: 12.05324) QuantErr: 12.05324 batch_time=0.53595 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.39284 (QuantReg: 11.60637) QuantErr: 11.60637 batch_time=0.69213 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.44135 (QuantReg: 11.50941) QuantErr: 11.50941 batch_time=1.57483 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.49841 (QuantReg: 11.73981) QuantErr: 11.73981 batch_time=0.50064 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.44430 (QuantReg: 11.40116) QuantErr: 11.40116 batch_time=0.51481 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.23488 (QuantReg: 11.52743) QuantErr: 11.52743 batch_time=0.57707 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.30189 (QuantReg: 11.76119) QuantErr: 11.76119 batch_time=0.51221 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.04696 (QuantReg: 11.39847) QuantErr: 11.39847 batch_time=0.52325 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.49980 (QuantReg: 11.79015) QuantErr: 11.79015 batch_time=5.68684 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.35336 (QuantReg: 11.50655) QuantErr: 11.50655 batch_time=0.54701 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.24445 (QuantReg: 11.89352) QuantErr: 11.89352 batch_time=0.51219 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.49518 (QuantReg: 11.90899) QuantErr: 11.90899 batch_time=0.55759 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.28781 (QuantReg: 11.49859) QuantErr: 11.49859 batch_time=0.62049 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.27457 (QuantReg: 11.69631) QuantErr: 11.69631 batch_time=0.55688 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.57961 (QuantReg: 11.52098) QuantErr: 11.52098 batch_time=0.53931 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.24593 (QuantReg: 11.90243) QuantErr: 11.90243 batch_time=0.51785 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.33273 (QuantReg: 11.95102) QuantErr: 11.95102 batch_time=0.52427 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.08762 (QuantReg: 11.62959) QuantErr: 11.62959 batch_time=0.65099 
Train Epoch: 21 codebook_update_time=1.74677
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch21.pth ...
Done in 4.770s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 1.331643209695816
 quant_reg      : 11.662853439331055
 quant_err      : 11.662853439331055
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_full_val/t2v_metrics/R1: 29.577464788732396
 MSRVTT_full_val/t2v_metrics/R5: 68.2092555331992
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.09456740442656
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.372714791136275
 MSRVTT_full_val/v2t_metrics/R1: 38.028169014084504
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 85.51307847082495
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.295774647887324
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.54861870972016
 MSRVTT_full_test/t2v_metrics/R1: 12.642140468227424
 MSRVTT_full_test/t2v_metrics/R5: 34.046822742474916
 MSRVTT_full_test/t2v_metrics/R10: 48.26086956521739
 MSRVTT_full_test/t2v_metrics/R50: 80.06688963210702
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.072575250836124
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.4893274542211
 MSRVTT_full_test/v2t_metrics/R1: 14.347826086956522
 MSRVTT_full_test/v2t_metrics/R5: 40.06688963210702
 MSRVTT_full_test/v2t_metrics/R10: 55.38461538461539
 MSRVTT_full_test/v2t_metrics/R50: 85.31772575250837
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.531438127090304
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.694722903979248
 mnt_best       : 27.94913111250171
 not_improved_count: 3
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.59623 (QuantReg: 11.52365) QuantErr: 11.52365 batch_time=38.46716 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.33204 (QuantReg: 11.76856) QuantErr: 11.76856 batch_time=0.63708 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.25141 (QuantReg: 11.69373) QuantErr: 11.69373 batch_time=0.51314 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.26058 (QuantReg: 11.33568) QuantErr: 11.33568 batch_time=0.50697 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.21690 (QuantReg: 11.82423) QuantErr: 11.82423 batch_time=0.51845 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.14258 (QuantReg: 11.58776) QuantErr: 11.58776 batch_time=0.56981 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.33915 (QuantReg: 11.42769) QuantErr: 11.42769 batch_time=0.55361 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.24101 (QuantReg: 11.49738) QuantErr: 11.49738 batch_time=0.51342 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.56696 (QuantReg: 11.30383) QuantErr: 11.30383 batch_time=0.52018 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.43282 (QuantReg: 11.62892) QuantErr: 11.62892 batch_time=0.51204 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.51920 (QuantReg: 11.63573) QuantErr: 11.63573 batch_time=0.50145 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.21321 (QuantReg: 11.68600) QuantErr: 11.68600 batch_time=0.53364 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.41665 (QuantReg: 11.61913) QuantErr: 11.61913 batch_time=0.59004 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.48618 (QuantReg: 11.63830) QuantErr: 11.63830 batch_time=0.51946 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.37978 (QuantReg: 11.79378) QuantErr: 11.79378 batch_time=0.52596 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.46141 (QuantReg: 11.60640) QuantErr: 11.60640 batch_time=0.59051 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.51411 (QuantReg: 11.59782) QuantErr: 11.59782 batch_time=0.53896 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.37194 (QuantReg: 11.77363) QuantErr: 11.77363 batch_time=0.50621 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.35092 (QuantReg: 11.38178) QuantErr: 11.38178 batch_time=0.54406 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.34821 (QuantReg: 11.72890) QuantErr: 11.72890 batch_time=0.53830 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.43477 (QuantReg: 11.65241) QuantErr: 11.65241 batch_time=0.51049 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.28695 (QuantReg: 11.47681) QuantErr: 11.47681 batch_time=0.66102 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.05007 (QuantReg: 11.81364) QuantErr: 11.81364 batch_time=0.56301 
Train Epoch: 22 codebook_update_time=1.80785
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch22.pth ...
Done in 20.152s
removing stale ckpt [epoch 21] [took 0.02s]
 epoch          : 22
 loss           : 1.2981075179576873
 quant_reg      : 11.66078441619873
 quant_err      : 11.66078441619873
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.6579476861167
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.65903402419703
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.698189134808853
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.3688362068769
 MSRVTT_full_test/t2v_metrics/R1: 12.775919732441471
 MSRVTT_full_test/t2v_metrics/R5: 34.64882943143812
 MSRVTT_full_test/t2v_metrics/R10: 48.72909698996656
 MSRVTT_full_test/t2v_metrics/R50: 80.5685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.096989966555185
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.837038816996085
 MSRVTT_full_test/v2t_metrics/R1: 14.749163879598662
 MSRVTT_full_test/v2t_metrics/R5: 41.73913043478261
 MSRVTT_full_test/v2t_metrics/R10: 55.88628762541806
 MSRVTT_full_test/v2t_metrics/R50: 85.58528428093645
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.196989966555186
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.524104908986416
 mnt_best       : 27.94913111250171
 not_improved_count: 4
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.33790 (QuantReg: 11.36460) QuantErr: 11.36460 batch_time=35.13782 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.40928 (QuantReg: 11.88279) QuantErr: 11.88279 batch_time=0.50618 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.04624 (QuantReg: 11.79956) QuantErr: 11.79956 batch_time=0.55616 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.34259 (QuantReg: 11.67479) QuantErr: 11.67479 batch_time=0.57478 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.30420 (QuantReg: 11.66927) QuantErr: 11.66927 batch_time=0.51403 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.35628 (QuantReg: 11.70538) QuantErr: 11.70538 batch_time=0.52263 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.17231 (QuantReg: 11.62671) QuantErr: 11.62671 batch_time=3.41180 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.42476 (QuantReg: 11.77363) QuantErr: 11.77363 batch_time=0.52568 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.40774 (QuantReg: 11.42404) QuantErr: 11.42404 batch_time=2.33384 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.09148 (QuantReg: 11.69231) QuantErr: 11.69231 batch_time=0.52649 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.48734 (QuantReg: 11.55856) QuantErr: 11.55856 batch_time=0.53536 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.41689 (QuantReg: 11.43867) QuantErr: 11.43867 batch_time=0.58029 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.22079 (QuantReg: 11.55489) QuantErr: 11.55489 batch_time=2.06913 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.47064 (QuantReg: 11.78599) QuantErr: 11.78599 batch_time=0.53975 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.44235 (QuantReg: 11.55184) QuantErr: 11.55184 batch_time=0.57081 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.40472 (QuantReg: 11.39525) QuantErr: 11.39525 batch_time=0.52252 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.06524 (QuantReg: 11.91311) QuantErr: 11.91311 batch_time=0.56731 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.32975 (QuantReg: 11.69080) QuantErr: 11.69080 batch_time=0.56951 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 0.99869 (QuantReg: 11.97180) QuantErr: 11.97180 batch_time=0.53965 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.07598 (QuantReg: 11.72780) QuantErr: 11.72780 batch_time=0.54503 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 0.99437 (QuantReg: 11.95646) QuantErr: 11.95646 batch_time=0.52757 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.24066 (QuantReg: 11.81856) QuantErr: 11.81856 batch_time=0.51063 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.39560 (QuantReg: 11.23127) QuantErr: 11.23127 batch_time=0.54178 
Train Epoch: 23 codebook_update_time=1.67251
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch23.pth ...
Done in 4.627s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 1.310271471977234
 quant_reg      : 11.654258777618407
 quant_err      : 11.654258777618407
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_full_val/t2v_metrics/R1: 30.18108651911469
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.438631790744466
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.724065654863615
 MSRVTT_full_val/v2t_metrics/R1: 36.01609657947686
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 86.31790744466801
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.094567404426559
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.99957477310633
 MSRVTT_full_test/t2v_metrics/R1: 12.876254180602007
 MSRVTT_full_test/t2v_metrics/R5: 34.61538461538461
 MSRVTT_full_test/t2v_metrics/R10: 48.49498327759197
 MSRVTT_full_test/t2v_metrics/R50: 80.03344481605352
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.41772575250836
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.855984076906314
 MSRVTT_full_test/v2t_metrics/R1: 15.384615384615385
 MSRVTT_full_test/v2t_metrics/R5: 41.37123745819398
 MSRVTT_full_test/v2t_metrics/R10: 56.05351170568562
 MSRVTT_full_test/v2t_metrics/R50: 85.35117056856187
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.52876254180602
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.92021479603179
 mnt_best       : 27.94913111250171
 not_improved_count: 5
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.61996 (QuantReg: 11.39007) QuantErr: 11.39007 batch_time=39.46082 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.23609 (QuantReg: 11.78292) QuantErr: 11.78292 batch_time=0.60998 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.11029 (QuantReg: 11.72626) QuantErr: 11.72626 batch_time=0.61180 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.44625 (QuantReg: 11.76090) QuantErr: 11.76090 batch_time=0.62800 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.47687 (QuantReg: 11.48554) QuantErr: 11.48554 batch_time=0.51767 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 0.86460 (QuantReg: 11.73031) QuantErr: 11.73031 batch_time=0.55400 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 0.95309 (QuantReg: 11.77139) QuantErr: 11.77139 batch_time=0.59225 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.33938 (QuantReg: 11.53041) QuantErr: 11.53041 batch_time=0.61482 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.20415 (QuantReg: 11.69708) QuantErr: 11.69708 batch_time=0.54105 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.26981 (QuantReg: 11.70861) QuantErr: 11.70861 batch_time=0.54626 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.36442 (QuantReg: 11.42876) QuantErr: 11.42876 batch_time=0.53952 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.50927 (QuantReg: 11.53979) QuantErr: 11.53979 batch_time=0.57390 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.12298 (QuantReg: 11.73975) QuantErr: 11.73975 batch_time=0.53110 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.69740 (QuantReg: 11.95446) QuantErr: 11.95446 batch_time=0.53338 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.39903 (QuantReg: 11.33364) QuantErr: 11.33364 batch_time=0.61342 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.04970 (QuantReg: 11.86823) QuantErr: 11.86823 batch_time=0.54363 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.10265 (QuantReg: 11.91358) QuantErr: 11.91358 batch_time=0.55797 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.11526 (QuantReg: 11.72879) QuantErr: 11.72879 batch_time=0.53166 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.27704 (QuantReg: 11.64128) QuantErr: 11.64128 batch_time=0.50865 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.07158 (QuantReg: 11.84054) QuantErr: 11.84054 batch_time=0.62289 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.40532 (QuantReg: 11.45810) QuantErr: 11.45810 batch_time=0.55187 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.40070 (QuantReg: 11.47108) QuantErr: 11.47108 batch_time=0.50531 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.31398 (QuantReg: 11.66191) QuantErr: 11.66191 batch_time=0.53716 
Train Epoch: 24 codebook_update_time=2.08153
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch24.pth ...
Done in 13.610s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch24.pth ...
Done in 18.104s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 1.2586833772659303
 quant_reg      : 11.69012294769287
 quant_err      : 11.69012294769287
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.044265593561368
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.01955224823254
 MSRVTT_full_val/v2t_metrics/R1: 37.02213279678068
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.3199195171026155
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.22691245813832
 MSRVTT_full_test/t2v_metrics/R1: 13.244147157190636
 MSRVTT_full_test/t2v_metrics/R5: 34.98327759197324
 MSRVTT_full_test/t2v_metrics/R10: 48.76254180602007
 MSRVTT_full_test/t2v_metrics/R50: 80.10033444816054
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.15819397993311
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.269856880109327
 MSRVTT_full_test/v2t_metrics/R1: 15.451505016722408
 MSRVTT_full_test/v2t_metrics/R5: 42.10702341137124
 MSRVTT_full_test/v2t_metrics/R10: 56.58862876254181
 MSRVTT_full_test/v2t_metrics/R50: 85.78595317725753
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.15250836120401
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.26734686777723
 mnt_best       : 28.269856880109327
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.49728 (QuantReg: 11.57706) QuantErr: 11.57706 batch_time=35.47614 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.22415 (QuantReg: 11.68224) QuantErr: 11.68224 batch_time=0.56118 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.12052 (QuantReg: 11.98501) QuantErr: 11.98501 batch_time=0.52103 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.41230 (QuantReg: 11.44375) QuantErr: 11.44375 batch_time=0.53422 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.20955 (QuantReg: 11.62433) QuantErr: 11.62433 batch_time=0.53604 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.22402 (QuantReg: 11.60769) QuantErr: 11.60769 batch_time=0.61110 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.39020 (QuantReg: 11.45159) QuantErr: 11.45159 batch_time=0.62819 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.31676 (QuantReg: 11.85068) QuantErr: 11.85068 batch_time=0.60143 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.06592 (QuantReg: 11.74065) QuantErr: 11.74065 batch_time=0.51377 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.36391 (QuantReg: 11.57068) QuantErr: 11.57068 batch_time=0.54563 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.41800 (QuantReg: 11.52611) QuantErr: 11.52611 batch_time=1.41347 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.07071 (QuantReg: 11.60564) QuantErr: 11.60564 batch_time=0.57173 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.22533 (QuantReg: 11.66261) QuantErr: 11.66261 batch_time=0.53608 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.19540 (QuantReg: 11.84318) QuantErr: 11.84318 batch_time=0.51420 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.31352 (QuantReg: 11.65842) QuantErr: 11.65842 batch_time=0.60180 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.44115 (QuantReg: 11.42860) QuantErr: 11.42860 batch_time=0.58490 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.21963 (QuantReg: 11.90587) QuantErr: 11.90587 batch_time=0.51942 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.16198 (QuantReg: 11.89156) QuantErr: 11.89156 batch_time=0.54315 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 1.12605 (QuantReg: 11.61844) QuantErr: 11.61844 batch_time=0.54496 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.33350 (QuantReg: 11.72711) QuantErr: 11.72711 batch_time=0.57016 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.35768 (QuantReg: 11.75138) QuantErr: 11.75138 batch_time=0.55453 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.26041 (QuantReg: 11.55859) QuantErr: 11.55859 batch_time=0.55857 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.23166 (QuantReg: 11.52994) QuantErr: 11.52994 batch_time=0.53607 
Train Epoch: 25 codebook_update_time=1.80466
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch25.pth ...
Done in 22.659s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch25.pth ...
Done in 26.807s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.26078409075737
 quant_reg      : 11.664297996520997
 quant_err      : 11.664297996520997
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.835010060362173
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.460280111269455
 MSRVTT_full_val/v2t_metrics/R1: 38.6317907444668
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.128772635814889
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.91288345809203
 MSRVTT_full_test/t2v_metrics/R1: 13.143812709030101
 MSRVTT_full_test/t2v_metrics/R5: 36.38795986622073
 MSRVTT_full_test/t2v_metrics/R10: 50.468227424749166
 MSRVTT_full_test/t2v_metrics/R50: 81.17056856187291
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.332441471571904
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.900079682302785
 MSRVTT_full_test/v2t_metrics/R1: 15.719063545150501
 MSRVTT_full_test/v2t_metrics/R5: 42.207357859531776
 MSRVTT_full_test/v2t_metrics/R10: 56.25418060200669
 MSRVTT_full_test/v2t_metrics/R50: 85.85284280936455
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.58963210702341
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.418725247894216
 mnt_best       : 28.900079682302785
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.36854 (QuantReg: 11.62487) QuantErr: 11.62487 batch_time=44.26732 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.29564 (QuantReg: 11.49483) QuantErr: 11.49483 batch_time=0.50732 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 0.88908 (QuantReg: 11.68052) QuantErr: 11.68052 batch_time=0.53506 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.09469 (QuantReg: 11.64347) QuantErr: 11.64347 batch_time=0.56770 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.17679 (QuantReg: 11.68325) QuantErr: 11.68325 batch_time=0.50519 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.30876 (QuantReg: 11.63544) QuantErr: 11.63544 batch_time=0.59343 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.24102 (QuantReg: 11.97854) QuantErr: 11.97854 batch_time=0.62759 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.32981 (QuantReg: 11.77965) QuantErr: 11.77965 batch_time=0.52639 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.25689 (QuantReg: 11.61661) QuantErr: 11.61661 batch_time=0.52851 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.09859 (QuantReg: 11.52281) QuantErr: 11.52281 batch_time=0.52460 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.97473 (QuantReg: 11.81280) QuantErr: 11.81280 batch_time=0.50756 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.07292 (QuantReg: 11.68747) QuantErr: 11.68747 batch_time=0.55689 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.07943 (QuantReg: 11.28828) QuantErr: 11.28828 batch_time=0.53050 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.14302 (QuantReg: 11.55574) QuantErr: 11.55574 batch_time=0.55352 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.47839 (QuantReg: 11.51967) QuantErr: 11.51967 batch_time=0.50939 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.20115 (QuantReg: 11.76915) QuantErr: 11.76915 batch_time=0.58791 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.15360 (QuantReg: 11.44322) QuantErr: 11.44322 batch_time=0.58754 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.11578 (QuantReg: 11.79166) QuantErr: 11.79166 batch_time=0.55964 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.20046 (QuantReg: 11.88049) QuantErr: 11.88049 batch_time=0.58082 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 0.99974 (QuantReg: 11.86601) QuantErr: 11.86601 batch_time=0.52392 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.79514 (QuantReg: 11.65968) QuantErr: 11.65968 batch_time=0.60619 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.18699 (QuantReg: 11.78621) QuantErr: 11.78621 batch_time=0.55274 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 0.99132 (QuantReg: 11.66619) QuantErr: 11.66619 batch_time=0.50422 
Train Epoch: 26 codebook_update_time=2.03068
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch26.pth ...
Done in 5.047s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 1.2534456717967988
 quant_reg      : 11.685984294891357
 quant_err      : 11.685984294891357
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.762575452716298
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.96995693343287
 MSRVTT_full_val/v2t_metrics/R1: 38.22937625754527
 MSRVTT_full_val/v2t_metrics/R5: 73.64185110663983
 MSRVTT_full_val/v2t_metrics/R10: 85.71428571428571
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.132796780684105
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.25750418080128
 MSRVTT_full_test/t2v_metrics/R1: 12.842809364548495
 MSRVTT_full_test/t2v_metrics/R5: 35.719063545150505
 MSRVTT_full_test/t2v_metrics/R10: 49.56521739130435
 MSRVTT_full_test/t2v_metrics/R50: 80.3010033444816
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.14096989966555
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.32994329516976
 MSRVTT_full_test/v2t_metrics/R1: 14.882943143812708
 MSRVTT_full_test/v2t_metrics/R5: 41.50501672240803
 MSRVTT_full_test/v2t_metrics/R10: 56.52173913043478
 MSRVTT_full_test/v2t_metrics/R50: 85.31772575250837
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.8371237458194
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.68398310815774
 mnt_best       : 28.900079682302785
 not_improved_count: 1
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 0.96545 (QuantReg: 11.91392) QuantErr: 11.91392 batch_time=35.05353 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.43017 (QuantReg: 11.78479) QuantErr: 11.78479 batch_time=0.52757 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.23229 (QuantReg: 11.82321) QuantErr: 11.82321 batch_time=0.50782 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.16423 (QuantReg: 11.75331) QuantErr: 11.75331 batch_time=0.52054 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.25574 (QuantReg: 11.66808) QuantErr: 11.66808 batch_time=0.52039 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 0.93110 (QuantReg: 11.96970) QuantErr: 11.96970 batch_time=0.50679 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.02677 (QuantReg: 11.66729) QuantErr: 11.66729 batch_time=6.38274 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.12129 (QuantReg: 11.52439) QuantErr: 11.52439 batch_time=0.54235 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.23726 (QuantReg: 11.71860) QuantErr: 11.71860 batch_time=0.53452 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.31085 (QuantReg: 11.45761) QuantErr: 11.45761 batch_time=0.52049 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.05614 (QuantReg: 11.85183) QuantErr: 11.85183 batch_time=0.56045 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.28178 (QuantReg: 11.68285) QuantErr: 11.68285 batch_time=0.54071 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.32410 (QuantReg: 11.67390) QuantErr: 11.67390 batch_time=0.53953 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.05302 (QuantReg: 11.71082) QuantErr: 11.71082 batch_time=0.51254 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.13961 (QuantReg: 11.88796) QuantErr: 11.88796 batch_time=0.51262 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.26998 (QuantReg: 11.74621) QuantErr: 11.74621 batch_time=0.56064 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.40210 (QuantReg: 11.61635) QuantErr: 11.61635 batch_time=0.55159 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.18559 (QuantReg: 11.50242) QuantErr: 11.50242 batch_time=0.63322 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.42205 (QuantReg: 11.72146) QuantErr: 11.72146 batch_time=0.52346 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.04694 (QuantReg: 11.98281) QuantErr: 11.98281 batch_time=0.49813 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.12730 (QuantReg: 11.57868) QuantErr: 11.57868 batch_time=0.54599 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.15275 (QuantReg: 11.67926) QuantErr: 11.67926 batch_time=0.64397 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.25739 (QuantReg: 11.65335) QuantErr: 11.65335 batch_time=0.53174 
Train Epoch: 27 codebook_update_time=1.86995
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch27.pth ...
Done in 15.837s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 1.206399167776108
 quant_reg      : 11.652723903656005
 quant_err      : 11.652723903656005
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_full_val/t2v_metrics/R1: 32.99798792756539
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.678068410462776
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.33008567340174
 MSRVTT_full_val/v2t_metrics/R1: 38.22937625754527
 MSRVTT_full_val/v2t_metrics/R5: 74.44668008048289
 MSRVTT_full_val/v2t_metrics/R10: 85.71428571428571
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.698189134808853
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.483486213597295
 MSRVTT_full_test/t2v_metrics/R1: 12.842809364548495
 MSRVTT_full_test/t2v_metrics/R5: 36.05351170568562
 MSRVTT_full_test/t2v_metrics/R10: 50.16722408026756
 MSRVTT_full_test/t2v_metrics/R50: 80.66889632107024
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.09030100334448
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.532679609040546
 MSRVTT_full_test/v2t_metrics/R1: 15.986622073578594
 MSRVTT_full_test/v2t_metrics/R5: 42.274247491638796
 MSRVTT_full_test/v2t_metrics/R10: 57.02341137123746
 MSRVTT_full_test/v2t_metrics/R50: 85.55183946488295
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.53344481605351
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.77758505939598
 mnt_best       : 28.900079682302785
 not_improved_count: 2
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 0.98225 (QuantReg: 11.61420) QuantErr: 11.61420 batch_time=45.81743 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.41447 (QuantReg: 11.59767) QuantErr: 11.59767 batch_time=0.50686 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.16785 (QuantReg: 11.47802) QuantErr: 11.47802 batch_time=0.52319 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.24244 (QuantReg: 11.85810) QuantErr: 11.85810 batch_time=0.56400 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.63063 (QuantReg: 11.63836) QuantErr: 11.63836 batch_time=0.52715 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.24949 (QuantReg: 11.86108) QuantErr: 11.86108 batch_time=0.51424 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.59150 (QuantReg: 11.74212) QuantErr: 11.74212 batch_time=0.56080 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.09521 (QuantReg: 11.83644) QuantErr: 11.83644 batch_time=0.54863 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.31649 (QuantReg: 11.63564) QuantErr: 11.63564 batch_time=0.53584 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.23524 (QuantReg: 11.65029) QuantErr: 11.65029 batch_time=0.54194 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.19910 (QuantReg: 11.68832) QuantErr: 11.68832 batch_time=0.59086 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.23151 (QuantReg: 11.70683) QuantErr: 11.70683 batch_time=0.54467 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.33632 (QuantReg: 11.83282) QuantErr: 11.83282 batch_time=0.53213 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.41351 (QuantReg: 11.41175) QuantErr: 11.41175 batch_time=0.61762 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.35457 (QuantReg: 11.58906) QuantErr: 11.58906 batch_time=0.52929 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 0.98756 (QuantReg: 11.52036) QuantErr: 11.52036 batch_time=0.52010 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.42665 (QuantReg: 11.58829) QuantErr: 11.58829 batch_time=0.56916 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.20292 (QuantReg: 11.48782) QuantErr: 11.48782 batch_time=0.54177 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.02421 (QuantReg: 11.70949) QuantErr: 11.70949 batch_time=0.54442 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.20784 (QuantReg: 11.84861) QuantErr: 11.84861 batch_time=0.50193 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.24228 (QuantReg: 11.59586) QuantErr: 11.59586 batch_time=1.08834 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.53723 (QuantReg: 11.36941) QuantErr: 11.36941 batch_time=0.64661 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.18422 (QuantReg: 11.78017) QuantErr: 11.78017 batch_time=0.54812 
Train Epoch: 28 codebook_update_time=2.06328
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch28.pth ...
Done in 4.525s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch28.pth ...
Done in 8.502s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 1.2105279269218445
 quant_reg      : 11.678411739349364
 quant_err      : 11.678411739349364
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_full_val/t2v_metrics/R1: 31.187122736418512
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.448692152917506
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.10036466803814
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 86.31790744466801
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.917505030181086
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.179705704392724
 MSRVTT_full_test/t2v_metrics/R1: 13.511705685618729
 MSRVTT_full_test/t2v_metrics/R5: 36.32107023411371
 MSRVTT_full_test/t2v_metrics/R10: 50.06688963210702
 MSRVTT_full_test/t2v_metrics/R50: 80.5685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.323076923076925
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.071881645447416
 MSRVTT_full_test/v2t_metrics/R1: 16.421404682274247
 MSRVTT_full_test/v2t_metrics/R5: 42.274247491638796
 MSRVTT_full_test/v2t_metrics/R10: 56.95652173913044
 MSRVTT_full_test/v2t_metrics/R50: 85.75250836120401
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.17725752508361
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.06773154678013
 mnt_best       : 29.071881645447416
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.28002 (QuantReg: 11.72315) QuantErr: 11.72315 batch_time=33.64341 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.37417 (QuantReg: 11.64175) QuantErr: 11.64175 batch_time=0.52608 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.38448 (QuantReg: 11.48403) QuantErr: 11.48403 batch_time=1.86254 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.22501 (QuantReg: 11.49883) QuantErr: 11.49883 batch_time=0.75943 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.20821 (QuantReg: 11.75547) QuantErr: 11.75547 batch_time=0.62993 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.38530 (QuantReg: 11.80783) QuantErr: 11.80783 batch_time=0.53773 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.15318 (QuantReg: 11.78583) QuantErr: 11.78583 batch_time=0.51806 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.29467 (QuantReg: 11.57774) QuantErr: 11.57774 batch_time=0.50865 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.04692 (QuantReg: 11.85301) QuantErr: 11.85301 batch_time=0.53729 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 0.99457 (QuantReg: 11.63560) QuantErr: 11.63560 batch_time=0.52646 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.41221 (QuantReg: 11.46195) QuantErr: 11.46195 batch_time=0.54318 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.05460 (QuantReg: 11.92533) QuantErr: 11.92533 batch_time=0.56323 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.41722 (QuantReg: 11.62203) QuantErr: 11.62203 batch_time=0.63478 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.26835 (QuantReg: 11.71938) QuantErr: 11.71938 batch_time=0.53627 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.06977 (QuantReg: 11.52684) QuantErr: 11.52684 batch_time=0.52899 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.12862 (QuantReg: 11.70195) QuantErr: 11.70195 batch_time=0.54263 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.31343 (QuantReg: 11.46525) QuantErr: 11.46525 batch_time=0.50031 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.13829 (QuantReg: 11.64896) QuantErr: 11.64896 batch_time=0.52157 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.28741 (QuantReg: 11.68843) QuantErr: 11.68843 batch_time=0.60056 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.01869 (QuantReg: 11.92826) QuantErr: 11.92826 batch_time=0.57492 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.11436 (QuantReg: 11.48472) QuantErr: 11.48472 batch_time=0.50402 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.17260 (QuantReg: 11.59370) QuantErr: 11.59370 batch_time=1.24542 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 0.98218 (QuantReg: 11.73922) QuantErr: 11.73922 batch_time=0.57192 
Train Epoch: 29 codebook_update_time=2.04596
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch29.pth ...
Done in 4.881s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 1.2008666014671325
 quant_reg      : 11.67371754837036
 quant_err      : 11.67371754837036
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.676056338028168
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.74445012241968
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 85.51307847082495
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.28169014084507
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.20766973465364
 MSRVTT_full_test/t2v_metrics/R1: 12.575250836120402
 MSRVTT_full_test/t2v_metrics/R5: 35.08361204013378
 MSRVTT_full_test/t2v_metrics/R10: 49.56521739130435
 MSRVTT_full_test/t2v_metrics/R50: 80.40133779264214
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.68528428093646
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.964001962169494
 MSRVTT_full_test/v2t_metrics/R1: 15.48494983277592
 MSRVTT_full_test/v2t_metrics/R5: 41.50501672240803
 MSRVTT_full_test/v2t_metrics/R10: 56.38795986622073
 MSRVTT_full_test/v2t_metrics/R50: 85.38461538461539
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.60066889632107
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.09270434511252
 mnt_best       : 29.071881645447416
 not_improved_count: 1
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.07434 (QuantReg: 11.60720) QuantErr: 11.60720 batch_time=34.48486 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.23953 (QuantReg: 11.64435) QuantErr: 11.64435 batch_time=0.51119 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.26185 (QuantReg: 11.62210) QuantErr: 11.62210 batch_time=0.51803 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.29227 (QuantReg: 11.61239) QuantErr: 11.61239 batch_time=0.56556 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.14089 (QuantReg: 11.66441) QuantErr: 11.66441 batch_time=0.66138 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.16373 (QuantReg: 11.92419) QuantErr: 11.92419 batch_time=0.55498 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.24127 (QuantReg: 11.74118) QuantErr: 11.74118 batch_time=4.61880 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 0.93719 (QuantReg: 11.90232) QuantErr: 11.90232 batch_time=0.57599 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.30937 (QuantReg: 11.45194) QuantErr: 11.45194 batch_time=0.59242 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.02243 (QuantReg: 11.81634) QuantErr: 11.81634 batch_time=0.54022 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.12904 (QuantReg: 11.77819) QuantErr: 11.77819 batch_time=0.58334 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.13611 (QuantReg: 11.60065) QuantErr: 11.60065 batch_time=0.58114 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.12251 (QuantReg: 11.75643) QuantErr: 11.75643 batch_time=0.52075 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.20499 (QuantReg: 11.54229) QuantErr: 11.54229 batch_time=0.53363 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.21480 (QuantReg: 11.69461) QuantErr: 11.69461 batch_time=0.61645 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.18639 (QuantReg: 11.70280) QuantErr: 11.70280 batch_time=0.57872 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.09386 (QuantReg: 11.62325) QuantErr: 11.62325 batch_time=0.51248 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 0.91273 (QuantReg: 11.75650) QuantErr: 11.75650 batch_time=0.52687 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.58170 (QuantReg: 11.62244) QuantErr: 11.62244 batch_time=0.51873 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.19722 (QuantReg: 11.62841) QuantErr: 11.62841 batch_time=0.54104 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.21059 (QuantReg: 11.85981) QuantErr: 11.85981 batch_time=0.50995 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.43356 (QuantReg: 11.83386) QuantErr: 11.83386 batch_time=0.60357 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.44777 (QuantReg: 11.75773) QuantErr: 11.75773 batch_time=0.53560 
Train Epoch: 30 codebook_update_time=1.70319
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch30.pth ...
Done in 4.279s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 1.1690773079395294
 quant_reg      : 11.686251335144043
 quant_err      : 11.686251335144043
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_full_val/t2v_metrics/R1: 34.20523138832998
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.694164989939637
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.99901729937534
 MSRVTT_full_val/v2t_metrics/R1: 39.23541247484909
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.989939637826962
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.991640294731525
 MSRVTT_full_test/t2v_metrics/R1: 13.377926421404682
 MSRVTT_full_test/t2v_metrics/R5: 35.88628762541806
 MSRVTT_full_test/t2v_metrics/R10: 49.93311036789298
 MSRVTT_full_test/t2v_metrics/R50: 80.36789297658864
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.99531772575251
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.833806879345758
 MSRVTT_full_test/v2t_metrics/R1: 16.153846153846153
 MSRVTT_full_test/v2t_metrics/R5: 42.04013377926422
 MSRVTT_full_test/v2t_metrics/R10: 56.92307692307692
 MSRVTT_full_test/v2t_metrics/R50: 85.41806020066889
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.513377926421406
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.81241051382819
 mnt_best       : 29.071881645447416
 not_improved_count: 2
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.44405 (QuantReg: 11.66653) QuantErr: 11.66653 batch_time=35.52645 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.25184 (QuantReg: 11.63662) QuantErr: 11.63662 batch_time=1.88957 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.40769 (QuantReg: 11.57929) QuantErr: 11.57929 batch_time=0.53424 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.06196 (QuantReg: 11.51718) QuantErr: 11.51718 batch_time=0.56600 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.25730 (QuantReg: 11.52397) QuantErr: 11.52397 batch_time=0.51227 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.37801 (QuantReg: 11.06442) QuantErr: 11.06442 batch_time=0.64853 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.27682 (QuantReg: 11.65580) QuantErr: 11.65580 batch_time=0.55932 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.24852 (QuantReg: 11.77551) QuantErr: 11.77551 batch_time=0.52223 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.26341 (QuantReg: 11.59984) QuantErr: 11.59984 batch_time=0.63268 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.12663 (QuantReg: 11.52909) QuantErr: 11.52909 batch_time=0.55518 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.02315 (QuantReg: 11.81179) QuantErr: 11.81179 batch_time=0.55625 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.04817 (QuantReg: 11.66058) QuantErr: 11.66058 batch_time=0.53826 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.15073 (QuantReg: 11.70998) QuantErr: 11.70998 batch_time=0.51838 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.48971 (QuantReg: 11.84096) QuantErr: 11.84096 batch_time=1.93555 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.21716 (QuantReg: 11.61308) QuantErr: 11.61308 batch_time=0.56212 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.11770 (QuantReg: 11.42959) QuantErr: 11.42959 batch_time=0.49897 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.48913 (QuantReg: 11.38670) QuantErr: 11.38670 batch_time=0.55551 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.17194 (QuantReg: 11.84399) QuantErr: 11.84399 batch_time=0.57070 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.08108 (QuantReg: 11.70060) QuantErr: 11.70060 batch_time=0.56044 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.45710 (QuantReg: 11.60289) QuantErr: 11.60289 batch_time=0.59769 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 0.98660 (QuantReg: 11.97897) QuantErr: 11.97897 batch_time=0.58442 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.16271 (QuantReg: 11.66581) QuantErr: 11.66581 batch_time=0.89078 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.18602 (QuantReg: 11.72545) QuantErr: 11.72545 batch_time=0.52025 
Train Epoch: 31 codebook_update_time=1.87947
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch31.pth ...
Done in 4.432s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.1863536603450775
 quant_reg      : 11.690604629516601
 quant_err      : 11.690604629516601
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 71.0261569416499
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.728370221327967
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.32882828753316
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.983903420523139
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.0241822647976
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 36.2876254180602
 MSRVTT_full_test/t2v_metrics/R10: 50.30100334448161
 MSRVTT_full_test/t2v_metrics/R50: 81.03678929765886
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.14882943143812
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.963365656719517
 MSRVTT_full_test/v2t_metrics/R1: 15.652173913043478
 MSRVTT_full_test/v2t_metrics/R5: 42.240802675585286
 MSRVTT_full_test/v2t_metrics/R10: 57.19063545150502
 MSRVTT_full_test/v2t_metrics/R50: 85.55183946488295
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.436120401337796
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.56427337487495
 mnt_best       : 29.071881645447416
 not_improved_count: 3
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 0.92615 (QuantReg: 11.78200) QuantErr: 11.78200 batch_time=36.92209 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.25816 (QuantReg: 11.77789) QuantErr: 11.77789 batch_time=0.86744 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.06978 (QuantReg: 11.61710) QuantErr: 11.61710 batch_time=0.53379 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.08163 (QuantReg: 11.89060) QuantErr: 11.89060 batch_time=1.02067 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.88491 (QuantReg: 11.80574) QuantErr: 11.80574 batch_time=0.57625 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.21598 (QuantReg: 11.54769) QuantErr: 11.54769 batch_time=0.54223 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 0.89449 (QuantReg: 11.81989) QuantErr: 11.81989 batch_time=0.52859 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.11712 (QuantReg: 11.60482) QuantErr: 11.60482 batch_time=0.58116 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.28076 (QuantReg: 11.65432) QuantErr: 11.65432 batch_time=0.53346 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.13481 (QuantReg: 11.55172) QuantErr: 11.55172 batch_time=0.50130 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.20676 (QuantReg: 12.09809) QuantErr: 12.09809 batch_time=0.54022 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 0.93228 (QuantReg: 11.43712) QuantErr: 11.43712 batch_time=0.60673 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.26844 (QuantReg: 11.70898) QuantErr: 11.70898 batch_time=0.58216 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.12412 (QuantReg: 11.64504) QuantErr: 11.64504 batch_time=2.39672 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 0.95860 (QuantReg: 11.73081) QuantErr: 11.73081 batch_time=0.55186 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.19154 (QuantReg: 11.76283) QuantErr: 11.76283 batch_time=0.58528 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.28184 (QuantReg: 11.86104) QuantErr: 11.86104 batch_time=0.52051 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.29536 (QuantReg: 11.90113) QuantErr: 11.90113 batch_time=0.50307 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.11772 (QuantReg: 11.94325) QuantErr: 11.94325 batch_time=2.99676 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.49689 (QuantReg: 11.77011) QuantErr: 11.77011 batch_time=0.56053 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.08503 (QuantReg: 11.84067) QuantErr: 11.84067 batch_time=0.54296 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.18172 (QuantReg: 11.52164) QuantErr: 11.52164 batch_time=0.67428 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 0.93184 (QuantReg: 11.89684) QuantErr: 11.89684 batch_time=0.61053 
Train Epoch: 32 codebook_update_time=1.86371
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch32.pth ...
Done in 18.561s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch32.pth ...
Done in 23.270s
removing stale ckpt [epoch 31] [took 0.10s]
 epoch          : 32
 loss           : 1.1517472789287566
 quant_reg      : 11.701025802612305
 quant_err      : 11.701025802612305
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_full_val/t2v_metrics/R1: 34.60764587525151
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.893360160965795
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.95700623661616
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.979879275653923
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.31933471787379
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 37.05685618729097
 MSRVTT_full_test/t2v_metrics/R10: 50.468227424749166
 MSRVTT_full_test/t2v_metrics/R50: 81.1371237458194
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.79933110367893
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.198878375052068
 MSRVTT_full_test/v2t_metrics/R1: 16.153846153846153
 MSRVTT_full_test/v2t_metrics/R5: 42.14046822742475
 MSRVTT_full_test/v2t_metrics/R10: 58.19397993311037
 MSRVTT_full_test/v2t_metrics/R50: 85.51839464882943
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.46789297658863
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.08927668795485
 mnt_best       : 29.198878375052068
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.08638 (QuantReg: 11.96474) QuantErr: 11.96474 batch_time=33.04242 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.02790 (QuantReg: 11.60440) QuantErr: 11.60440 batch_time=0.57941 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.28144 (QuantReg: 11.83310) QuantErr: 11.83310 batch_time=0.54155 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 0.93602 (QuantReg: 11.31287) QuantErr: 11.31287 batch_time=0.52024 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.02021 (QuantReg: 11.87778) QuantErr: 11.87778 batch_time=0.52307 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.25218 (QuantReg: 11.73132) QuantErr: 11.73132 batch_time=0.54367 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 1.36666 (QuantReg: 11.66978) QuantErr: 11.66978 batch_time=2.38026 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.09646 (QuantReg: 11.46990) QuantErr: 11.46990 batch_time=0.50487 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.27059 (QuantReg: 11.51232) QuantErr: 11.51232 batch_time=1.10305 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.20800 (QuantReg: 11.69642) QuantErr: 11.69642 batch_time=0.61421 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.30839 (QuantReg: 11.63536) QuantErr: 11.63536 batch_time=0.54791 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.08293 (QuantReg: 11.67386) QuantErr: 11.67386 batch_time=0.52082 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.50973 (QuantReg: 11.55934) QuantErr: 11.55934 batch_time=0.54116 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.19295 (QuantReg: 11.75715) QuantErr: 11.75715 batch_time=0.63278 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.09388 (QuantReg: 11.40236) QuantErr: 11.40236 batch_time=0.51614 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.19357 (QuantReg: 11.82804) QuantErr: 11.82804 batch_time=0.54531 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.93437 (QuantReg: 11.66059) QuantErr: 11.66059 batch_time=0.55660 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.20402 (QuantReg: 11.73335) QuantErr: 11.73335 batch_time=0.51026 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.08642 (QuantReg: 11.61299) QuantErr: 11.61299 batch_time=0.50941 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.05210 (QuantReg: 11.91986) QuantErr: 11.91986 batch_time=0.56224 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 1.46803 (QuantReg: 11.58191) QuantErr: 11.58191 batch_time=0.58438 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.05779 (QuantReg: 11.66448) QuantErr: 11.66448 batch_time=0.56224 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.10134 (QuantReg: 11.75193) QuantErr: 11.75193 batch_time=0.50817 
Train Epoch: 33 codebook_update_time=1.82369
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch33.pth ...
Done in 4.576s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch33.pth ...
Done in 9.284s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.1390594668388367
 quant_reg      : 11.693104202270508
 quant_err      : 11.693104202270508
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.096579476861168
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.033608765625154
 MSRVTT_full_val/v2t_metrics/R1: 37.625754527162975
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.4044265593561365
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.39522942982786
 MSRVTT_full_test/t2v_metrics/R1: 13.277591973244148
 MSRVTT_full_test/t2v_metrics/R5: 37.123745819397996
 MSRVTT_full_test/t2v_metrics/R10: 50.735785953177256
 MSRVTT_full_test/t2v_metrics/R50: 80.90301003344482
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.301672240802674
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.243442808253466
 MSRVTT_full_test/v2t_metrics/R1: 15.719063545150501
 MSRVTT_full_test/v2t_metrics/R5: 42.709030100334445
 MSRVTT_full_test/v2t_metrics/R10: 57.19063545150502
 MSRVTT_full_test/v2t_metrics/R50: 85.68561872909699
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.861872909698995
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.73575496182275
 mnt_best       : 29.243442808253466
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.10580 (QuantReg: 11.80131) QuantErr: 11.80131 batch_time=38.29618 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.15974 (QuantReg: 11.95595) QuantErr: 11.95595 batch_time=0.81269 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.13135 (QuantReg: 11.75136) QuantErr: 11.75136 batch_time=0.53692 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.20337 (QuantReg: 11.68941) QuantErr: 11.68941 batch_time=0.54002 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.26071 (QuantReg: 11.77783) QuantErr: 11.77783 batch_time=0.80938 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.22292 (QuantReg: 11.62774) QuantErr: 11.62774 batch_time=0.55706 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.12404 (QuantReg: 11.71462) QuantErr: 11.71462 batch_time=3.44619 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.39640 (QuantReg: 11.52411) QuantErr: 11.52411 batch_time=0.57205 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.27255 (QuantReg: 11.60381) QuantErr: 11.60381 batch_time=1.87763 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.51907 (QuantReg: 11.62286) QuantErr: 11.62286 batch_time=0.55013 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.24945 (QuantReg: 11.45716) QuantErr: 11.45716 batch_time=0.52583 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.10322 (QuantReg: 11.65984) QuantErr: 11.65984 batch_time=0.56298 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.19225 (QuantReg: 11.72460) QuantErr: 11.72460 batch_time=0.51756 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.17742 (QuantReg: 11.60010) QuantErr: 11.60010 batch_time=0.55123 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.19082 (QuantReg: 12.03946) QuantErr: 12.03946 batch_time=0.50853 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.30027 (QuantReg: 11.40399) QuantErr: 11.40399 batch_time=0.51780 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.04719 (QuantReg: 11.65955) QuantErr: 11.65955 batch_time=0.54532 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.32324 (QuantReg: 11.50206) QuantErr: 11.50206 batch_time=0.56297 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 0.99674 (QuantReg: 11.74214) QuantErr: 11.74214 batch_time=0.51792 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.21208 (QuantReg: 11.58987) QuantErr: 11.58987 batch_time=0.82182 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.04148 (QuantReg: 11.87845) QuantErr: 11.87845 batch_time=0.64214 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.01675 (QuantReg: 11.79537) QuantErr: 11.79537 batch_time=0.54955 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.40704 (QuantReg: 11.86884) QuantErr: 11.86884 batch_time=0.51953 
Train Epoch: 34 codebook_update_time=1.77546
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch34.pth ...
Done in 4.465s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 1.168559190750122
 quant_reg      : 11.691075634002685
 quant_err      : 11.691075634002685
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.804828973843058
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.864166093311894
 MSRVTT_full_val/v2t_metrics/R1: 39.23541247484909
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.71830985915493
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.495594834277355
 MSRVTT_full_test/t2v_metrics/R1: 13.043478260869565
 MSRVTT_full_test/t2v_metrics/R5: 36.020066889632105
 MSRVTT_full_test/t2v_metrics/R10: 48.66220735785953
 MSRVTT_full_test/t2v_metrics/R50: 80.5351170568562
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.348829431438126
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.382016371297794
 MSRVTT_full_test/v2t_metrics/R1: 16.02006688963211
 MSRVTT_full_test/v2t_metrics/R5: 42.240802675585286
 MSRVTT_full_test/v2t_metrics/R10: 57.22408026755853
 MSRVTT_full_test/v2t_metrics/R50: 85.38461538461539
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.285953177257525
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.83179984995131
 mnt_best       : 29.243442808253466
 not_improved_count: 1
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.05678 (QuantReg: 11.75442) QuantErr: 11.75442 batch_time=38.92002 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.24650 (QuantReg: 11.75449) QuantErr: 11.75449 batch_time=0.55576 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.19351 (QuantReg: 11.64919) QuantErr: 11.64919 batch_time=0.62860 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.34282 (QuantReg: 11.73278) QuantErr: 11.73278 batch_time=0.56763 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.22697 (QuantReg: 11.68930) QuantErr: 11.68930 batch_time=0.57954 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.01855 (QuantReg: 11.65598) QuantErr: 11.65598 batch_time=0.52342 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.02883 (QuantReg: 11.86298) QuantErr: 11.86298 batch_time=5.72375 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.45448 (QuantReg: 11.90768) QuantErr: 11.90768 batch_time=0.53176 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.14912 (QuantReg: 11.67033) QuantErr: 11.67033 batch_time=0.57265 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.23903 (QuantReg: 11.76030) QuantErr: 11.76030 batch_time=0.57215 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.14653 (QuantReg: 11.64577) QuantErr: 11.64577 batch_time=0.65897 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.15048 (QuantReg: 11.71041) QuantErr: 11.71041 batch_time=0.52968 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.34638 (QuantReg: 11.53376) QuantErr: 11.53376 batch_time=0.56452 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.10445 (QuantReg: 11.90765) QuantErr: 11.90765 batch_time=0.57005 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.08424 (QuantReg: 11.56870) QuantErr: 11.56870 batch_time=0.53342 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 1.30596 (QuantReg: 11.84049) QuantErr: 11.84049 batch_time=0.54339 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.05099 (QuantReg: 12.29471) QuantErr: 12.29471 batch_time=0.56653 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.00430 (QuantReg: 11.49458) QuantErr: 11.49458 batch_time=0.78199 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.00566 (QuantReg: 11.92876) QuantErr: 11.92876 batch_time=2.36324 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.11966 (QuantReg: 11.82978) QuantErr: 11.82978 batch_time=0.50619 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.11868 (QuantReg: 11.81221) QuantErr: 11.81221 batch_time=0.55577 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.13975 (QuantReg: 11.89982) QuantErr: 11.89982 batch_time=0.57922 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.93109 (QuantReg: 11.81934) QuantErr: 11.81934 batch_time=0.53430 
Train Epoch: 35 codebook_update_time=1.68210
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch35.pth ...
Done in 4.424s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 1.1332325866222381
 quant_reg      : 11.72554638671875
 quant_err      : 11.72554638671875
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.64989939637827
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.15505413370227
 MSRVTT_full_val/v2t_metrics/R1: 37.02213279678068
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.118712273641851
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.89471138001434
 MSRVTT_full_test/t2v_metrics/R1: 13.612040133779264
 MSRVTT_full_test/t2v_metrics/R5: 35.953177257525084
 MSRVTT_full_test/t2v_metrics/R10: 49.46488294314381
 MSRVTT_full_test/t2v_metrics/R50: 80.46822742474916
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.815384615384616
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.928050092693258
 MSRVTT_full_test/v2t_metrics/R1: 15.384615384615385
 MSRVTT_full_test/v2t_metrics/R5: 41.20401337792642
 MSRVTT_full_test/v2t_metrics/R10: 56.42140468227425
 MSRVTT_full_test/v2t_metrics/R50: 85.45150501672241
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.6752508361204
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.94756719457206
 mnt_best       : 29.243442808253466
 not_improved_count: 2
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.00522 (QuantReg: 11.59180) QuantErr: 11.59180 batch_time=32.43709 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.25126 (QuantReg: 11.72480) QuantErr: 11.72480 batch_time=0.61937 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.84127 (QuantReg: 11.48710) QuantErr: 11.48710 batch_time=1.22791 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.04598 (QuantReg: 11.59501) QuantErr: 11.59501 batch_time=0.51171 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.12546 (QuantReg: 11.64016) QuantErr: 11.64016 batch_time=0.53412 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.86602 (QuantReg: 11.51644) QuantErr: 11.51644 batch_time=0.52245 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.12580 (QuantReg: 11.80745) QuantErr: 11.80745 batch_time=0.60765 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.24950 (QuantReg: 11.79666) QuantErr: 11.79666 batch_time=0.53602 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.25430 (QuantReg: 11.56860) QuantErr: 11.56860 batch_time=0.70330 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.14581 (QuantReg: 11.69713) QuantErr: 11.69713 batch_time=0.60939 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.42576 (QuantReg: 11.56852) QuantErr: 11.56852 batch_time=0.53602 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.32041 (QuantReg: 11.67585) QuantErr: 11.67585 batch_time=0.53885 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.09576 (QuantReg: 11.40672) QuantErr: 11.40672 batch_time=4.38575 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.21337 (QuantReg: 11.91952) QuantErr: 11.91952 batch_time=0.51182 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.92559 (QuantReg: 11.66663) QuantErr: 11.66663 batch_time=0.52390 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 1.32069 (QuantReg: 11.81095) QuantErr: 11.81095 batch_time=0.55487 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.33913 (QuantReg: 11.69143) QuantErr: 11.69143 batch_time=0.54724 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.93115 (QuantReg: 11.76695) QuantErr: 11.76695 batch_time=0.67755 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.96298 (QuantReg: 11.62344) QuantErr: 11.62344 batch_time=0.62593 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.22388 (QuantReg: 11.66916) QuantErr: 11.66916 batch_time=0.55105 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 1.38150 (QuantReg: 11.39409) QuantErr: 11.39409 batch_time=0.57826 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.21200 (QuantReg: 11.57475) QuantErr: 11.57475 batch_time=0.51506 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 1.02551 (QuantReg: 11.48159) QuantErr: 11.48159 batch_time=0.57638 
Train Epoch: 36 codebook_update_time=1.82021
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch36.pth ...
Done in 4.603s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch36.pth ...
Done in 9.686s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 1.1379546766281128
 quant_reg      : 11.717156833648682
 quant_err      : 11.717156833648682
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.020120724346077
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.618068625315196
 MSRVTT_full_val/v2t_metrics/R1: 40.643863179074444
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 85.51307847082495
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.0321931589537225
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.00798176469848
 MSRVTT_full_test/t2v_metrics/R1: 13.779264214046822
 MSRVTT_full_test/t2v_metrics/R5: 37.65886287625418
 MSRVTT_full_test/t2v_metrics/R10: 50.96989966555184
 MSRVTT_full_test/t2v_metrics/R50: 81.20401337792642
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.9
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.794470353979584
 MSRVTT_full_test/v2t_metrics/R1: 16.08695652173913
 MSRVTT_full_test/v2t_metrics/R5: 41.97324414715719
 MSRVTT_full_test/v2t_metrics/R10: 57.15719063545151
 MSRVTT_full_test/v2t_metrics/R50: 86.15384615384616
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.53344481605351
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.79396111193666
 mnt_best       : 29.794470353979584
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.16163 (QuantReg: 11.66897) QuantErr: 11.66897 batch_time=36.95275 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.04803 (QuantReg: 11.58090) QuantErr: 11.58090 batch_time=0.50696 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 1.24433 (QuantReg: 11.49437) QuantErr: 11.49437 batch_time=0.55916 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.02541 (QuantReg: 11.67326) QuantErr: 11.67326 batch_time=0.54125 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.18391 (QuantReg: 11.67080) QuantErr: 11.67080 batch_time=0.50885 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.47929 (QuantReg: 11.50983) QuantErr: 11.50983 batch_time=0.62780 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.38030 (QuantReg: 11.69455) QuantErr: 11.69455 batch_time=0.61568 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.08144 (QuantReg: 11.71957) QuantErr: 11.71957 batch_time=0.52001 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.16544 (QuantReg: 11.84721) QuantErr: 11.84721 batch_time=0.56004 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.01557 (QuantReg: 11.51254) QuantErr: 11.51254 batch_time=0.53796 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.10948 (QuantReg: 11.61394) QuantErr: 11.61394 batch_time=0.65641 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.01558 (QuantReg: 11.69523) QuantErr: 11.69523 batch_time=0.50918 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.15955 (QuantReg: 11.50576) QuantErr: 11.50576 batch_time=0.80857 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.37022 (QuantReg: 11.56675) QuantErr: 11.56675 batch_time=0.57672 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 1.02345 (QuantReg: 11.45491) QuantErr: 11.45491 batch_time=0.50620 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 1.26068 (QuantReg: 11.84991) QuantErr: 11.84991 batch_time=0.54894 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.18709 (QuantReg: 11.85817) QuantErr: 11.85817 batch_time=0.58238 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 1.25991 (QuantReg: 11.54499) QuantErr: 11.54499 batch_time=0.50992 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.13281 (QuantReg: 11.78935) QuantErr: 11.78935 batch_time=0.65546 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.30188 (QuantReg: 11.72638) QuantErr: 11.72638 batch_time=0.54004 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.11636 (QuantReg: 12.09366) QuantErr: 12.09366 batch_time=0.66102 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.50150 (QuantReg: 11.38163) QuantErr: 11.38163 batch_time=0.54220 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 0.99846 (QuantReg: 11.77883) QuantErr: 11.77883 batch_time=0.51461 
Train Epoch: 37 codebook_update_time=1.90127
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch37.pth ...
Done in 21.734s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch37.pth ...
Done in 25.905s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 1.1428174018859862
 quant_reg      : 11.679096221923828
 quant_err      : 11.679096221923828
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 70.82494969818913
 MSRVTT_full_val/t2v_metrics/R10: 80.28169014084507
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.794768611670019
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.595376469866885
 MSRVTT_full_val/v2t_metrics/R1: 39.839034205231385
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.17102615694165
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.53915166789445
 MSRVTT_full_test/t2v_metrics/R1: 14.147157190635452
 MSRVTT_full_test/t2v_metrics/R5: 37.89297658862876
 MSRVTT_full_test/t2v_metrics/R10: 51.17056856187291
 MSRVTT_full_test/t2v_metrics/R50: 81.30434782608695
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.218060200668894
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.158938224344737
 MSRVTT_full_test/v2t_metrics/R1: 16.722408026755854
 MSRVTT_full_test/v2t_metrics/R5: 43.17725752508361
 MSRVTT_full_test/v2t_metrics/R10: 58.09364548494983
 MSRVTT_full_test/v2t_metrics/R50: 85.95317725752508
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.70267558528428
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.745148060587034
 mnt_best       : 30.158938224344737
 not_improved_count: 0
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 1.23766 (QuantReg: 11.59453) QuantErr: 11.59453 batch_time=32.48228 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 1.14638 (QuantReg: 11.79953) QuantErr: 11.79953 batch_time=0.50634 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.88825 (QuantReg: 11.79539) QuantErr: 11.79539 batch_time=0.56407 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.17150 (QuantReg: 11.67767) QuantErr: 11.67767 batch_time=0.65043 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.20067 (QuantReg: 11.57516) QuantErr: 11.57516 batch_time=0.56323 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 1.35938 (QuantReg: 11.73953) QuantErr: 11.73953 batch_time=0.54051 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.07955 (QuantReg: 11.52502) QuantErr: 11.52502 batch_time=5.63631 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.97278 (QuantReg: 11.89965) QuantErr: 11.89965 batch_time=0.52028 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 0.89674 (QuantReg: 11.63631) QuantErr: 11.63631 batch_time=0.55054 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.99576 (QuantReg: 12.00884) QuantErr: 12.00884 batch_time=0.51309 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.20526 (QuantReg: 11.62928) QuantErr: 11.62928 batch_time=0.51162 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.16082 (QuantReg: 11.65363) QuantErr: 11.65363 batch_time=0.55680 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.09995 (QuantReg: 11.72327) QuantErr: 11.72327 batch_time=0.50869 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.13692 (QuantReg: 11.67582) QuantErr: 11.67582 batch_time=0.54864 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.00237 (QuantReg: 11.84500) QuantErr: 11.84500 batch_time=0.62796 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 1.23852 (QuantReg: 11.51476) QuantErr: 11.51476 batch_time=0.59790 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.08000 (QuantReg: 11.76337) QuantErr: 11.76337 batch_time=0.58430 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.97922 (QuantReg: 11.62205) QuantErr: 11.62205 batch_time=0.52823 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.08438 (QuantReg: 11.57776) QuantErr: 11.57776 batch_time=0.54054 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.15339 (QuantReg: 11.70086) QuantErr: 11.70086 batch_time=0.53279 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.14974 (QuantReg: 11.79913) QuantErr: 11.79913 batch_time=0.53205 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.04741 (QuantReg: 11.60136) QuantErr: 11.60136 batch_time=0.50467 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.06513 (QuantReg: 11.79200) QuantErr: 11.79200 batch_time=0.59545 
Train Epoch: 38 codebook_update_time=1.76846
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch38.pth ...
Done in 4.316s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.133741459131241
 quant_reg      : 11.688789951324463
 quant_err      : 11.688789951324463
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.283702213279678
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.0767735507128
 MSRVTT_full_val/v2t_metrics/R1: 38.43058350100603
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 84.50704225352112
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.440643863179075
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.688076921567635
 MSRVTT_full_test/t2v_metrics/R1: 14.381270903010034
 MSRVTT_full_test/t2v_metrics/R5: 36.92307692307692
 MSRVTT_full_test/t2v_metrics/R10: 50.20066889632107
 MSRVTT_full_test/t2v_metrics/R50: 80.96989966555184
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.79933110367893
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.872269502118936
 MSRVTT_full_test/v2t_metrics/R1: 16.421404682274247
 MSRVTT_full_test/v2t_metrics/R5: 43.11036789297659
 MSRVTT_full_test/v2t_metrics/R10: 57.792642140468224
 MSRVTT_full_test/v2t_metrics/R50: 85.95317725752508
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.30434782608695
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.457851435539354
 mnt_best       : 30.158938224344737
 not_improved_count: 1
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 1.18032 (QuantReg: 11.75984) QuantErr: 11.75984 batch_time=37.95080 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.29712 (QuantReg: 11.57773) QuantErr: 11.57773 batch_time=0.59603 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 0.93209 (QuantReg: 11.65860) QuantErr: 11.65860 batch_time=0.54828 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.29460 (QuantReg: 11.70834) QuantErr: 11.70834 batch_time=0.62506 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 0.92941 (QuantReg: 11.62034) QuantErr: 11.62034 batch_time=0.53739 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.02319 (QuantReg: 11.78582) QuantErr: 11.78582 batch_time=0.57882 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.05937 (QuantReg: 11.52534) QuantErr: 11.52534 batch_time=0.57780 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 0.99608 (QuantReg: 11.87606) QuantErr: 11.87606 batch_time=0.52321 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 0.88120 (QuantReg: 11.61360) QuantErr: 11.61360 batch_time=0.55644 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 0.91392 (QuantReg: 11.86258) QuantErr: 11.86258 batch_time=0.61329 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.95888 (QuantReg: 11.56486) QuantErr: 11.56486 batch_time=0.61627 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.96357 (QuantReg: 11.92871) QuantErr: 11.92871 batch_time=0.51691 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.22585 (QuantReg: 11.62741) QuantErr: 11.62741 batch_time=0.54932 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.13643 (QuantReg: 11.54791) QuantErr: 11.54791 batch_time=0.53618 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 0.95902 (QuantReg: 11.49485) QuantErr: 11.49485 batch_time=0.51461 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 0.90066 (QuantReg: 11.73614) QuantErr: 11.73614 batch_time=0.57427 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.06805 (QuantReg: 11.83068) QuantErr: 11.83068 batch_time=0.55234 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.15941 (QuantReg: 11.61987) QuantErr: 11.61987 batch_time=0.58834 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 1.10624 (QuantReg: 11.73060) QuantErr: 11.73060 batch_time=0.52319 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.01095 (QuantReg: 12.05053) QuantErr: 12.05053 batch_time=0.55565 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.11066 (QuantReg: 11.75407) QuantErr: 11.75407 batch_time=0.56747 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.08535 (QuantReg: 12.04223) QuantErr: 12.04223 batch_time=0.57698 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 0.99125 (QuantReg: 11.62440) QuantErr: 11.62440 batch_time=0.56439 
Train Epoch: 39 codebook_update_time=1.88758
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch39.pth ...
Done in 4.533s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 1.10646262383461
 quant_reg      : 11.72302470779419
 quant_err      : 11.72302470779419
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_full_val/t2v_metrics/R1: 34.20523138832998
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.289738430583501
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.29583069776726
 MSRVTT_full_val/v2t_metrics/R1: 38.83299798792756
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 85.51307847082495
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.2635814889336014
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.15476755369015
 MSRVTT_full_test/t2v_metrics/R1: 14.51505016722408
 MSRVTT_full_test/t2v_metrics/R5: 36.05351170568562
 MSRVTT_full_test/t2v_metrics/R10: 49.163879598662206
 MSRVTT_full_test/t2v_metrics/R50: 79.96655518394648
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 50.025083612040135
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.521432000292737
 MSRVTT_full_test/v2t_metrics/R1: 16.187290969899667
 MSRVTT_full_test/v2t_metrics/R5: 43.11036789297659
 MSRVTT_full_test/v2t_metrics/R10: 57.25752508361204
 MSRVTT_full_test/v2t_metrics/R50: 85.65217391304348
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 36.03244147157191
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.18714427659398
 mnt_best       : 30.158938224344737
 not_improved_count: 2
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.15264 (QuantReg: 11.80222) QuantErr: 11.80222 batch_time=34.57673 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.08044 (QuantReg: 11.66975) QuantErr: 11.66975 batch_time=0.61173 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.11220 (QuantReg: 11.57333) QuantErr: 11.57333 batch_time=0.53828 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.07478 (QuantReg: 11.53693) QuantErr: 11.53693 batch_time=0.53280 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.24790 (QuantReg: 11.57441) QuantErr: 11.57441 batch_time=0.61937 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.37937 (QuantReg: 11.76660) QuantErr: 11.76660 batch_time=0.52490 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.15086 (QuantReg: 11.75707) QuantErr: 11.75707 batch_time=0.51106 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.06912 (QuantReg: 11.91842) QuantErr: 11.91842 batch_time=0.56758 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.36595 (QuantReg: 11.53049) QuantErr: 11.53049 batch_time=0.54763 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.88734 (QuantReg: 11.58994) QuantErr: 11.58994 batch_time=0.51422 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.04672 (QuantReg: 11.76278) QuantErr: 11.76278 batch_time=0.51218 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 0.95042 (QuantReg: 11.64726) QuantErr: 11.64726 batch_time=0.68500 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.13225 (QuantReg: 11.89186) QuantErr: 11.89186 batch_time=0.58976 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.04215 (QuantReg: 11.66203) QuantErr: 11.66203 batch_time=2.38502 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.08591 (QuantReg: 11.61329) QuantErr: 11.61329 batch_time=0.53583 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.22432 (QuantReg: 11.59502) QuantErr: 11.59502 batch_time=0.57445 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.19361 (QuantReg: 11.68402) QuantErr: 11.68402 batch_time=0.51880 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.37799 (QuantReg: 11.73250) QuantErr: 11.73250 batch_time=0.50442 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.25698 (QuantReg: 11.78520) QuantErr: 11.78520 batch_time=0.51635 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.08853 (QuantReg: 11.62685) QuantErr: 11.62685 batch_time=2.07061 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.11540 (QuantReg: 11.82450) QuantErr: 11.82450 batch_time=0.58676 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 1.35197 (QuantReg: 11.67607) QuantErr: 11.67607 batch_time=0.50843 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.99978 (QuantReg: 11.49517) QuantErr: 11.49517 batch_time=0.58186 
Train Epoch: 40 codebook_update_time=2.04988
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch40.pth ...
Done in 4.523s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 1.126239370584488
 quant_reg      : 11.71056851196289
 quant_err      : 11.71056851196289
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_full_val/t2v_metrics/R1: 34.80885311871227
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.340040241448692
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.4702126163642
 MSRVTT_full_val/v2t_metrics/R1: 40.44265593561368
 MSRVTT_full_val/v2t_metrics/R5: 74.64788732394366
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.2635814889336014
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.57412469403785
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 36.62207357859532
 MSRVTT_full_test/t2v_metrics/R10: 50.2675585284281
 MSRVTT_full_test/t2v_metrics/R50: 80.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.57725752508361
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.04563456044931
 MSRVTT_full_test/v2t_metrics/R1: 15.852842809364548
 MSRVTT_full_test/v2t_metrics/R5: 42.675585284280935
 MSRVTT_full_test/v2t_metrics/R10: 58.12709030100334
 MSRVTT_full_test/v2t_metrics/R50: 85.88628762541806
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.95852842809364
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.0059627218423
 mnt_best       : 30.158938224344737
 not_improved_count: 3
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.17598 (QuantReg: 11.55154) QuantErr: 11.55154 batch_time=38.37934 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.21880 (QuantReg: 11.58418) QuantErr: 11.58418 batch_time=0.52572 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.12375 (QuantReg: 11.71112) QuantErr: 11.71112 batch_time=0.67763 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.22920 (QuantReg: 11.81068) QuantErr: 11.81068 batch_time=0.60951 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 0.72602 (QuantReg: 11.76308) QuantErr: 11.76308 batch_time=0.62956 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 1.28315 (QuantReg: 11.39165) QuantErr: 11.39165 batch_time=0.58240 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 1.44724 (QuantReg: 11.49581) QuantErr: 11.49581 batch_time=0.55033 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.18783 (QuantReg: 11.75858) QuantErr: 11.75858 batch_time=0.52379 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.12923 (QuantReg: 11.95788) QuantErr: 11.95788 batch_time=0.58652 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.03610 (QuantReg: 11.84627) QuantErr: 11.84627 batch_time=0.91727 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.24706 (QuantReg: 11.74389) QuantErr: 11.74389 batch_time=0.52224 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.03919 (QuantReg: 11.71887) QuantErr: 11.71887 batch_time=0.49760 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 0.97428 (QuantReg: 11.72095) QuantErr: 11.72095 batch_time=0.68356 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 0.95160 (QuantReg: 11.70524) QuantErr: 11.70524 batch_time=0.55389 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.11596 (QuantReg: 11.75342) QuantErr: 11.75342 batch_time=0.64458 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.05236 (QuantReg: 11.81576) QuantErr: 11.81576 batch_time=0.53792 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.20042 (QuantReg: 11.65996) QuantErr: 11.65996 batch_time=0.59955 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 1.29728 (QuantReg: 11.60940) QuantErr: 11.60940 batch_time=0.58114 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.02538 (QuantReg: 11.62468) QuantErr: 11.62468 batch_time=0.54946 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 0.95660 (QuantReg: 11.92292) QuantErr: 11.92292 batch_time=0.61861 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.20891 (QuantReg: 11.78999) QuantErr: 11.78999 batch_time=0.51067 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.13820 (QuantReg: 11.81433) QuantErr: 11.81433 batch_time=0.51781 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.22372 (QuantReg: 11.70535) QuantErr: 11.70535 batch_time=0.50582 
Train Epoch: 41 codebook_update_time=1.78585
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch41.pth ...
Done in 4.299s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.129557876586914
 quant_reg      : 11.757852504730225
 quant_err      : 11.757852504730225
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_full_val/t2v_metrics/R1: 33.80281690140845
 MSRVTT_full_val/t2v_metrics/R5: 68.81287726358148
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.346076458752515
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.870396651688644
 MSRVTT_full_val/v2t_metrics/R1: 40.44265593561368
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 84.90945674044265
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.074446680080483
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.6379319670447
 MSRVTT_full_test/t2v_metrics/R1: 13.879598662207357
 MSRVTT_full_test/t2v_metrics/R5: 36.75585284280937
 MSRVTT_full_test/t2v_metrics/R10: 49.89966555183946
 MSRVTT_full_test/t2v_metrics/R50: 81.20401337792642
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.43311036789298
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.417133343940392
 MSRVTT_full_test/v2t_metrics/R1: 16.153846153846153
 MSRVTT_full_test/v2t_metrics/R5: 42.709030100334445
 MSRVTT_full_test/v2t_metrics/R10: 57.792642140468224
 MSRVTT_full_test/v2t_metrics/R50: 85.91973244147157
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.21872909698997
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.16300519988584
 mnt_best       : 30.158938224344737
 not_improved_count: 4
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.07524 (QuantReg: 11.52616) QuantErr: 11.52616 batch_time=40.39076 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.14357 (QuantReg: 11.66053) QuantErr: 11.66053 batch_time=0.55795 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.16192 (QuantReg: 11.67731) QuantErr: 11.67731 batch_time=0.54216 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 0.98504 (QuantReg: 11.73303) QuantErr: 11.73303 batch_time=0.52446 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.34078 (QuantReg: 11.89984) QuantErr: 11.89984 batch_time=0.52348 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.15697 (QuantReg: 11.78016) QuantErr: 11.78016 batch_time=0.56603 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 0.93978 (QuantReg: 11.79663) QuantErr: 11.79663 batch_time=0.52656 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.24351 (QuantReg: 11.42487) QuantErr: 11.42487 batch_time=0.54091 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 1.22340 (QuantReg: 11.74488) QuantErr: 11.74488 batch_time=0.58519 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 0.99737 (QuantReg: 11.88628) QuantErr: 11.88628 batch_time=0.65808 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.36657 (QuantReg: 11.71967) QuantErr: 11.71967 batch_time=0.59508 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.30803 (QuantReg: 12.01927) QuantErr: 12.01927 batch_time=0.52066 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.04607 (QuantReg: 11.86813) QuantErr: 11.86813 batch_time=0.61796 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 1.00851 (QuantReg: 11.63515) QuantErr: 11.63515 batch_time=0.55121 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.36961 (QuantReg: 11.58900) QuantErr: 11.58900 batch_time=0.55455 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 0.98531 (QuantReg: 11.81740) QuantErr: 11.81740 batch_time=0.51183 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 1.43906 (QuantReg: 11.71944) QuantErr: 11.71944 batch_time=0.56470 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 1.04205 (QuantReg: 11.71274) QuantErr: 11.71274 batch_time=0.53749 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 1.18839 (QuantReg: 11.89388) QuantErr: 11.89388 batch_time=0.51536 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.14019 (QuantReg: 11.70590) QuantErr: 11.70590 batch_time=0.60965 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.98556 (QuantReg: 11.67487) QuantErr: 11.67487 batch_time=0.52528 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 1.25288 (QuantReg: 11.78743) QuantErr: 11.78743 batch_time=0.51885 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.04067 (QuantReg: 11.80041) QuantErr: 11.80041 batch_time=0.52109 
Train Epoch: 42 codebook_update_time=2.24285
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch42.pth ...
Done in 4.699s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.1276831209659577
 quant_reg      : 11.726924339294433
 quant_err      : 11.726924339294433
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.10261569416499
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.96784494764108
 MSRVTT_full_val/v2t_metrics/R1: 40.84507042253521
 MSRVTT_full_val/v2t_metrics/R5: 74.44668008048289
 MSRVTT_full_val/v2t_metrics/R10: 84.90945674044265
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.372233400402415
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.67667076464458
 MSRVTT_full_test/t2v_metrics/R1: 14.147157190635452
 MSRVTT_full_test/t2v_metrics/R5: 37.458193979933114
 MSRVTT_full_test/t2v_metrics/R10: 50.36789297658863
 MSRVTT_full_test/t2v_metrics/R50: 81.20401337792642
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.3752508361204
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.885229753542387
 MSRVTT_full_test/v2t_metrics/R1: 15.953177257525084
 MSRVTT_full_test/v2t_metrics/R5: 43.04347826086956
 MSRVTT_full_test/v2t_metrics/R10: 57.558528428093645
 MSRVTT_full_test/v2t_metrics/R50: 85.41806020066889
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.8571906354515
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.06340648598783
 mnt_best       : 30.158938224344737
 not_improved_count: 5
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 1.26288 (QuantReg: 11.79570) QuantErr: 11.79570 batch_time=35.39569 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.20206 (QuantReg: 11.73860) QuantErr: 11.73860 batch_time=0.53520 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.04281 (QuantReg: 11.56088) QuantErr: 11.56088 batch_time=0.55854 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 0.90917 (QuantReg: 11.67197) QuantErr: 11.67197 batch_time=0.50780 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 0.98758 (QuantReg: 11.74519) QuantErr: 11.74519 batch_time=0.55529 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.15515 (QuantReg: 11.98506) QuantErr: 11.98506 batch_time=0.57689 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.01182 (QuantReg: 11.67254) QuantErr: 11.67254 batch_time=0.57260 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.03300 (QuantReg: 11.66815) QuantErr: 11.66815 batch_time=0.77909 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.16608 (QuantReg: 11.70862) QuantErr: 11.70862 batch_time=0.54907 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.17534 (QuantReg: 11.59877) QuantErr: 11.59877 batch_time=0.62660 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.28722 (QuantReg: 11.80734) QuantErr: 11.80734 batch_time=0.50411 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 1.38769 (QuantReg: 11.55924) QuantErr: 11.55924 batch_time=0.62878 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.27090 (QuantReg: 11.93178) QuantErr: 11.93178 batch_time=0.57244 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.88103 (QuantReg: 11.75616) QuantErr: 11.75616 batch_time=0.53180 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.38265 (QuantReg: 11.62369) QuantErr: 11.62369 batch_time=0.52168 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.29308 (QuantReg: 11.76009) QuantErr: 11.76009 batch_time=0.52985 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.01906 (QuantReg: 11.73163) QuantErr: 11.73163 batch_time=0.74618 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.14637 (QuantReg: 11.87205) QuantErr: 11.87205 batch_time=0.60416 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 0.89390 (QuantReg: 11.93500) QuantErr: 11.93500 batch_time=0.73628 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.24673 (QuantReg: 11.90129) QuantErr: 11.90129 batch_time=0.54232 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.21107 (QuantReg: 11.85378) QuantErr: 11.85378 batch_time=0.55067 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.97115 (QuantReg: 11.69280) QuantErr: 11.69280 batch_time=0.55622 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.17851 (QuantReg: 11.74293) QuantErr: 11.74293 batch_time=0.58763 
Train Epoch: 43 codebook_update_time=1.70050
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch43.pth ...
Done in 4.228s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 1.1117286336421968
 quant_reg      : 11.72758417892456
 quant_err      : 11.72758417892456
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 96.17706237424547
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.070422535211268
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.10791089194545
 MSRVTT_full_val/v2t_metrics/R1: 39.436619718309856
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.062374245472837
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.112231255907446
 MSRVTT_full_test/t2v_metrics/R1: 13.946488294314381
 MSRVTT_full_test/t2v_metrics/R5: 37.15719063545151
 MSRVTT_full_test/t2v_metrics/R10: 50.635451505016725
 MSRVTT_full_test/t2v_metrics/R50: 80.96989966555184
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.99531772575251
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.715803284467647
 MSRVTT_full_test/v2t_metrics/R1: 16.45484949832776
 MSRVTT_full_test/v2t_metrics/R5: 43.64548494983278
 MSRVTT_full_test/v2t_metrics/R10: 57.792642140468224
 MSRVTT_full_test/v2t_metrics/R50: 85.31772575250837
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.29531772575251
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.62331092867795
 mnt_best       : 30.158938224344737
 not_improved_count: 6
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.83798 (QuantReg: 11.89224) QuantErr: 11.89224 batch_time=40.79699 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 0.94885 (QuantReg: 11.72211) QuantErr: 11.72211 batch_time=0.56242 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.03327 (QuantReg: 11.72992) QuantErr: 11.72992 batch_time=0.53432 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.02190 (QuantReg: 11.70609) QuantErr: 11.70609 batch_time=0.55802 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.31387 (QuantReg: 11.74849) QuantErr: 11.74849 batch_time=0.50656 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 0.92184 (QuantReg: 11.44203) QuantErr: 11.44203 batch_time=0.53118 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.04326 (QuantReg: 11.78201) QuantErr: 11.78201 batch_time=0.61552 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.41879 (QuantReg: 11.71158) QuantErr: 11.71158 batch_time=0.51209 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.04560 (QuantReg: 11.83090) QuantErr: 11.83090 batch_time=0.52040 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.09718 (QuantReg: 11.66341) QuantErr: 11.66341 batch_time=0.53626 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.26774 (QuantReg: 12.02689) QuantErr: 12.02689 batch_time=0.54748 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.30836 (QuantReg: 11.66553) QuantErr: 11.66553 batch_time=0.50724 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.10525 (QuantReg: 11.85226) QuantErr: 11.85226 batch_time=6.32695 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.16205 (QuantReg: 11.54658) QuantErr: 11.54658 batch_time=0.51792 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.21329 (QuantReg: 11.81979) QuantErr: 11.81979 batch_time=0.56552 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 0.98110 (QuantReg: 11.87810) QuantErr: 11.87810 batch_time=0.51802 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.09074 (QuantReg: 11.52760) QuantErr: 11.52760 batch_time=0.56628 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.97225 (QuantReg: 11.49414) QuantErr: 11.49414 batch_time=0.52987 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.11324 (QuantReg: 11.60441) QuantErr: 11.60441 batch_time=0.55337 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.11716 (QuantReg: 11.88117) QuantErr: 11.88117 batch_time=0.50599 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.09387 (QuantReg: 11.84916) QuantErr: 11.84916 batch_time=0.54276 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.88309 (QuantReg: 11.63558) QuantErr: 11.63558 batch_time=0.57738 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.02261 (QuantReg: 11.90376) QuantErr: 11.90376 batch_time=0.59105 
Train Epoch: 44 codebook_update_time=1.84936
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch44.pth ...
Done in 9.715s
removing stale ckpt [epoch 43] [took 0.07s]
 epoch          : 44
 loss           : 1.1192629420757294
 quant_reg      : 11.729387065887451
 quant_err      : 11.729387065887451
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.209255533199196
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.288236816870125
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.23943661971831
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.490487431897115
 MSRVTT_full_test/t2v_metrics/R1: 13.578595317725753
 MSRVTT_full_test/t2v_metrics/R5: 37.22408026755853
 MSRVTT_full_test/t2v_metrics/R10: 50.23411371237458
 MSRVTT_full_test/t2v_metrics/R50: 80.0
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.41371237458194
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.391777763941903
 MSRVTT_full_test/v2t_metrics/R1: 16.48829431438127
 MSRVTT_full_test/v2t_metrics/R5: 42.84280936454849
 MSRVTT_full_test/v2t_metrics/R10: 57.558528428093645
 MSRVTT_full_test/v2t_metrics/R50: 85.61872909698997
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.08628762541806
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.38648503592412
 mnt_best       : 30.158938224344737
 not_improved_count: 7
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.10506 (QuantReg: 11.67512) QuantErr: 11.67512 batch_time=35.79876 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.95575 (QuantReg: 11.77177) QuantErr: 11.77177 batch_time=0.53279 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 1.23496 (QuantReg: 11.75064) QuantErr: 11.75064 batch_time=0.50723 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 0.83030 (QuantReg: 11.82831) QuantErr: 11.82831 batch_time=0.56830 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.13062 (QuantReg: 11.76624) QuantErr: 11.76624 batch_time=0.57916 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 0.84163 (QuantReg: 11.71407) QuantErr: 11.71407 batch_time=0.53460 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 1.22499 (QuantReg: 11.52922) QuantErr: 11.52922 batch_time=1.88061 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.51637 (QuantReg: 11.67684) QuantErr: 11.67684 batch_time=0.51213 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.16152 (QuantReg: 11.81961) QuantErr: 11.81961 batch_time=0.52194 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.92771 (QuantReg: 11.51991) QuantErr: 11.51991 batch_time=0.56357 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 1.24730 (QuantReg: 11.81285) QuantErr: 11.81285 batch_time=0.50081 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.03676 (QuantReg: 11.62866) QuantErr: 11.62866 batch_time=0.52710 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.14224 (QuantReg: 11.80138) QuantErr: 11.80138 batch_time=0.54137 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.10174 (QuantReg: 11.87803) QuantErr: 11.87803 batch_time=0.52791 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.21531 (QuantReg: 11.86717) QuantErr: 11.86717 batch_time=0.50741 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.98485 (QuantReg: 11.61821) QuantErr: 11.61821 batch_time=0.55287 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.11603 (QuantReg: 11.79194) QuantErr: 11.79194 batch_time=0.61973 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.08593 (QuantReg: 11.96662) QuantErr: 11.96662 batch_time=0.59515 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.85698 (QuantReg: 11.90866) QuantErr: 11.90866 batch_time=0.56481 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 1.13260 (QuantReg: 11.68913) QuantErr: 11.68913 batch_time=1.02478 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.14316 (QuantReg: 11.60869) QuantErr: 11.60869 batch_time=0.58039 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.91957 (QuantReg: 11.68965) QuantErr: 11.68965 batch_time=0.59753 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.14380 (QuantReg: 11.54728) QuantErr: 11.54728 batch_time=0.65357 
Train Epoch: 45 codebook_update_time=2.23054
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch45.pth ...
Done in 15.262s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 1.0984520080089568
 quant_reg      : 11.752697002410889
 quant_err      : 11.752697002410889
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.06841046277666
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.023476310907164
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.0523138832997985
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.387968777214724
 MSRVTT_full_test/t2v_metrics/R1: 13.946488294314381
 MSRVTT_full_test/t2v_metrics/R5: 37.591973244147155
 MSRVTT_full_test/t2v_metrics/R10: 50.836120401337794
 MSRVTT_full_test/t2v_metrics/R50: 81.30434782608695
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.84080267558529
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.870612622247243
 MSRVTT_full_test/v2t_metrics/R1: 16.421404682274247
 MSRVTT_full_test/v2t_metrics/R5: 43.91304347826087
 MSRVTT_full_test/v2t_metrics/R10: 58.02675585284281
 MSRVTT_full_test/v2t_metrics/R50: 85.58528428093645
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.54080267558528
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.71714826159442
 mnt_best       : 30.158938224344737
 not_improved_count: 8
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 1.06708 (QuantReg: 11.46798) QuantErr: 11.46798 batch_time=42.54300 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.07528 (QuantReg: 11.76397) QuantErr: 11.76397 batch_time=0.56639 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.87096 (QuantReg: 11.75111) QuantErr: 11.75111 batch_time=1.13835 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.95884 (QuantReg: 11.74774) QuantErr: 11.74774 batch_time=0.63138 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.32459 (QuantReg: 11.75256) QuantErr: 11.75256 batch_time=0.53582 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 0.91987 (QuantReg: 11.65023) QuantErr: 11.65023 batch_time=0.57429 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.19300 (QuantReg: 11.84503) QuantErr: 11.84503 batch_time=0.54765 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.19994 (QuantReg: 11.77963) QuantErr: 11.77963 batch_time=0.51350 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 1.15240 (QuantReg: 11.77492) QuantErr: 11.77492 batch_time=1.00987 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 1.14237 (QuantReg: 11.71564) QuantErr: 11.71564 batch_time=1.08989 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 0.96893 (QuantReg: 11.49588) QuantErr: 11.49588 batch_time=0.56614 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.11912 (QuantReg: 11.74785) QuantErr: 11.74785 batch_time=0.61656 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.43919 (QuantReg: 11.66416) QuantErr: 11.66416 batch_time=0.52103 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.16731 (QuantReg: 11.62227) QuantErr: 11.62227 batch_time=0.55268 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.02769 (QuantReg: 11.78655) QuantErr: 11.78655 batch_time=0.57167 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 0.94240 (QuantReg: 11.96901) QuantErr: 11.96901 batch_time=0.61025 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.15417 (QuantReg: 11.82758) QuantErr: 11.82758 batch_time=0.60337 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.03792 (QuantReg: 11.80394) QuantErr: 11.80394 batch_time=0.55666 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.96842 (QuantReg: 11.78895) QuantErr: 11.78895 batch_time=0.55336 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.99291 (QuantReg: 12.00864) QuantErr: 12.00864 batch_time=0.56928 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.90411 (QuantReg: 11.61661) QuantErr: 11.61661 batch_time=0.57781 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.05769 (QuantReg: 11.80723) QuantErr: 11.80723 batch_time=0.53936 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.98441 (QuantReg: 11.79470) QuantErr: 11.79470 batch_time=0.50566 
Train Epoch: 46 codebook_update_time=1.68046
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch46.pth ...
Done in 5.280s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 1.10452845788002
 quant_reg      : 11.730848438262939
 quant_err      : 11.730848438262939
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.088531187122737
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.774445450883135
 MSRVTT_full_val/v2t_metrics/R1: 41.04627766599597
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.8913480885311875
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.1866878140469
 MSRVTT_full_test/t2v_metrics/R1: 13.7123745819398
 MSRVTT_full_test/t2v_metrics/R5: 37.25752508361204
 MSRVTT_full_test/t2v_metrics/R10: 50.735785953177256
 MSRVTT_full_test/t2v_metrics/R50: 81.03678929765886
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.58327759197324
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.594682683283747
 MSRVTT_full_test/v2t_metrics/R1: 16.45484949832776
 MSRVTT_full_test/v2t_metrics/R5: 43.67892976588629
 MSRVTT_full_test/v2t_metrics/R10: 58.12709030100334
 MSRVTT_full_test/v2t_metrics/R50: 85.78595317725753
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.4819397993311
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.69882982128671
 mnt_best       : 30.158938224344737
 not_improved_count: 9
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.03291 (QuantReg: 11.92286) QuantErr: 11.92286 batch_time=36.21532 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.24591 (QuantReg: 11.64245) QuantErr: 11.64245 batch_time=0.87082 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.08835 (QuantReg: 11.63738) QuantErr: 11.63738 batch_time=0.53013 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.09275 (QuantReg: 11.74699) QuantErr: 11.74699 batch_time=0.61007 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.18351 (QuantReg: 11.89230) QuantErr: 11.89230 batch_time=0.57819 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.95657 (QuantReg: 11.64275) QuantErr: 11.64275 batch_time=0.54564 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.35047 (QuantReg: 11.61943) QuantErr: 11.61943 batch_time=0.57621 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 0.92447 (QuantReg: 11.53135) QuantErr: 11.53135 batch_time=0.51305 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.10412 (QuantReg: 11.87886) QuantErr: 11.87886 batch_time=0.54345 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.97675 (QuantReg: 11.73514) QuantErr: 11.73514 batch_time=0.55142 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 1.28042 (QuantReg: 11.47438) QuantErr: 11.47438 batch_time=0.59491 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 1.00156 (QuantReg: 11.80829) QuantErr: 11.80829 batch_time=0.51766 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.11120 (QuantReg: 12.00377) QuantErr: 12.00377 batch_time=0.55847 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.10393 (QuantReg: 11.59502) QuantErr: 11.59502 batch_time=1.25071 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.20334 (QuantReg: 11.66329) QuantErr: 11.66329 batch_time=0.62522 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.11675 (QuantReg: 11.83122) QuantErr: 11.83122 batch_time=0.61450 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.34382 (QuantReg: 11.50447) QuantErr: 11.50447 batch_time=0.52388 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 0.99751 (QuantReg: 11.90438) QuantErr: 11.90438 batch_time=0.53766 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.04331 (QuantReg: 11.77774) QuantErr: 11.77774 batch_time=3.12214 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.11437 (QuantReg: 11.87112) QuantErr: 11.87112 batch_time=0.53881 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 1.22843 (QuantReg: 11.75581) QuantErr: 11.75581 batch_time=0.57649 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 0.98880 (QuantReg: 11.75890) QuantErr: 11.75890 batch_time=0.60308 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.11382 (QuantReg: 11.76179) QuantErr: 11.76179 batch_time=0.53646 
Train Epoch: 47 codebook_update_time=1.79381
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch47.pth ...
Done in 4.405s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 1.1099998471736907
 quant_reg      : 11.748084701538087
 quant_err      : 11.748084701538087
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_full_val/t2v_metrics/R1: 34.20523138832998
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 95.77464788732394
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.227364185110664
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.05349145779203
 MSRVTT_full_val/v2t_metrics/R1: 40.44265593561368
 MSRVTT_full_val/v2t_metrics/R5: 74.04426559356136
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.450704225352113
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.40230189753806
 MSRVTT_full_test/t2v_metrics/R1: 13.678929765886288
 MSRVTT_full_test/t2v_metrics/R5: 37.591973244147155
 MSRVTT_full_test/t2v_metrics/R10: 51.137123745819395
 MSRVTT_full_test/t2v_metrics/R50: 81.17056856187291
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.54314381270903
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.736819260394757
 MSRVTT_full_test/v2t_metrics/R1: 16.321070234113712
 MSRVTT_full_test/v2t_metrics/R5: 42.876254180602004
 MSRVTT_full_test/v2t_metrics/R10: 58.06020066889632
 MSRVTT_full_test/v2t_metrics/R50: 85.7190635451505
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.22107023411371
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.37805755622565
 mnt_best       : 30.158938224344737
 not_improved_count: 10
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.26323 (QuantReg: 11.50202) QuantErr: 11.50202 batch_time=37.85525 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.13091 (QuantReg: 11.83484) QuantErr: 11.83484 batch_time=0.52130 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 0.99686 (QuantReg: 11.75888) QuantErr: 11.75888 batch_time=2.53800 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.06344 (QuantReg: 11.79201) QuantErr: 11.79201 batch_time=0.55552 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.05494 (QuantReg: 11.58480) QuantErr: 11.58480 batch_time=0.55028 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.03157 (QuantReg: 11.84411) QuantErr: 11.84411 batch_time=0.58020 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.19602 (QuantReg: 11.84700) QuantErr: 11.84700 batch_time=0.60775 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.07707 (QuantReg: 11.58941) QuantErr: 11.58941 batch_time=0.50942 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.02804 (QuantReg: 11.72231) QuantErr: 11.72231 batch_time=0.53936 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 0.94602 (QuantReg: 11.58512) QuantErr: 11.58512 batch_time=0.50637 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.03536 (QuantReg: 11.85171) QuantErr: 11.85171 batch_time=0.59043 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.17862 (QuantReg: 11.63255) QuantErr: 11.63255 batch_time=0.54716 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.06523 (QuantReg: 11.75775) QuantErr: 11.75775 batch_time=0.83370 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.01144 (QuantReg: 11.71566) QuantErr: 11.71566 batch_time=0.56747 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.08399 (QuantReg: 12.02034) QuantErr: 12.02034 batch_time=0.56587 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.30902 (QuantReg: 11.56682) QuantErr: 11.56682 batch_time=0.50321 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.97672 (QuantReg: 11.94663) QuantErr: 11.94663 batch_time=0.54353 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.19958 (QuantReg: 11.70558) QuantErr: 11.70558 batch_time=0.50883 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.33605 (QuantReg: 11.81601) QuantErr: 11.81601 batch_time=0.63832 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.23388 (QuantReg: 11.80481) QuantErr: 11.80481 batch_time=0.58123 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.04921 (QuantReg: 11.71770) QuantErr: 11.71770 batch_time=0.59413 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.28869 (QuantReg: 11.91387) QuantErr: 11.91387 batch_time=0.63845 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.34617 (QuantReg: 11.62700) QuantErr: 11.62700 batch_time=0.62278 
Train Epoch: 48 codebook_update_time=1.81753
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch48.pth ...
Done in 4.467s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 1.119965913772583
 quant_reg      : 11.747066822052002
 quant_err      : 11.747066822052002
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 96.37826961770624
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.14486921529175
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.91510358736039
 MSRVTT_full_val/v2t_metrics/R1: 41.4486921529175
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 85.11066398390342
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.344064386317908
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.21193407148786
 MSRVTT_full_test/t2v_metrics/R1: 14.046822742474916
 MSRVTT_full_test/t2v_metrics/R5: 37.725752508361204
 MSRVTT_full_test/t2v_metrics/R10: 51.67224080267559
 MSRVTT_full_test/t2v_metrics/R50: 81.37123745819397
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.33277591973244
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.141007816893367
 MSRVTT_full_test/v2t_metrics/R1: 16.588628762541806
 MSRVTT_full_test/v2t_metrics/R5: 43.51170568561873
 MSRVTT_full_test/v2t_metrics/R10: 58.62876254180602
 MSRVTT_full_test/v2t_metrics/R50: 85.9866220735786
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.92240802675585
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.84783283125873
 mnt_best       : 30.158938224344737
 not_improved_count: 11
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 0.95020 (QuantReg: 11.64492) QuantErr: 11.64492 batch_time=37.79518 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 0.98963 (QuantReg: 11.71346) QuantErr: 11.71346 batch_time=0.53336 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.05117 (QuantReg: 11.76798) QuantErr: 11.76798 batch_time=0.52322 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.08887 (QuantReg: 11.93575) QuantErr: 11.93575 batch_time=0.54162 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 0.89826 (QuantReg: 11.83628) QuantErr: 11.83628 batch_time=0.55868 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.28655 (QuantReg: 11.82965) QuantErr: 11.82965 batch_time=0.50503 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.16790 (QuantReg: 11.90777) QuantErr: 11.90777 batch_time=0.76573 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 1.01431 (QuantReg: 11.71487) QuantErr: 11.71487 batch_time=0.55162 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 1.25437 (QuantReg: 11.66230) QuantErr: 11.66230 batch_time=0.50561 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.04670 (QuantReg: 11.67120) QuantErr: 11.67120 batch_time=0.50487 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.17031 (QuantReg: 11.81774) QuantErr: 11.81774 batch_time=0.54924 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.28293 (QuantReg: 11.51462) QuantErr: 11.51462 batch_time=1.43495 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.29490 (QuantReg: 11.57631) QuantErr: 11.57631 batch_time=0.54442 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.05028 (QuantReg: 11.80342) QuantErr: 11.80342 batch_time=0.62153 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.20804 (QuantReg: 11.80523) QuantErr: 11.80523 batch_time=0.53980 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 1.11745 (QuantReg: 11.75361) QuantErr: 11.75361 batch_time=0.52611 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.95598 (QuantReg: 11.62069) QuantErr: 11.62069 batch_time=0.53010 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.15038 (QuantReg: 11.68714) QuantErr: 11.68714 batch_time=0.58374 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.09149 (QuantReg: 11.94292) QuantErr: 11.94292 batch_time=0.55983 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.20603 (QuantReg: 11.78191) QuantErr: 11.78191 batch_time=0.52518 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.04228 (QuantReg: 11.85271) QuantErr: 11.85271 batch_time=0.51015 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.79382 (QuantReg: 11.83509) QuantErr: 11.83509 batch_time=0.53462 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.06946 (QuantReg: 11.70649) QuantErr: 11.70649 batch_time=0.53051 
Train Epoch: 49 codebook_update_time=1.64638
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch49.pth ...
Done in 4.159s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 1.1083824548721313
 quant_reg      : 11.74505866241455
 quant_err      : 11.74505866241455
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.346076458752515
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.29043991140055
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 97.1830985915493
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.446680080482897
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.33187320032387
 MSRVTT_full_test/t2v_metrics/R1: 13.678929765886288
 MSRVTT_full_test/t2v_metrics/R5: 36.8561872909699
 MSRVTT_full_test/t2v_metrics/R10: 49.79933110367893
 MSRVTT_full_test/t2v_metrics/R50: 80.40133779264214
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.45551839464883
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.281636504642943
 MSRVTT_full_test/v2t_metrics/R1: 15.919732441471572
 MSRVTT_full_test/v2t_metrics/R5: 43.04347826086956
 MSRVTT_full_test/v2t_metrics/R10: 57.391304347826086
 MSRVTT_full_test/v2t_metrics/R50: 85.58528428093645
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.293645484949835
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.00658900919391
 mnt_best       : 30.158938224344737
 not_improved_count: 12
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.14726 (QuantReg: 11.74226) QuantErr: 11.74226 batch_time=37.17584 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 0.97977 (QuantReg: 11.74633) QuantErr: 11.74633 batch_time=0.52438 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.08017 (QuantReg: 11.74189) QuantErr: 11.74189 batch_time=0.55646 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.10196 (QuantReg: 11.96302) QuantErr: 11.96302 batch_time=0.57199 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.26741 (QuantReg: 11.54764) QuantErr: 11.54764 batch_time=0.52596 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.99652 (QuantReg: 11.83009) QuantErr: 11.83009 batch_time=0.51685 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.05420 (QuantReg: 11.78810) QuantErr: 11.78810 batch_time=0.50802 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 1.24470 (QuantReg: 11.62364) QuantErr: 11.62364 batch_time=0.53961 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 1.09843 (QuantReg: 11.64237) QuantErr: 11.64237 batch_time=0.55441 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 0.93089 (QuantReg: 11.69249) QuantErr: 11.69249 batch_time=0.52893 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.11563 (QuantReg: 11.77711) QuantErr: 11.77711 batch_time=0.51054 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 1.19903 (QuantReg: 11.96036) QuantErr: 11.96036 batch_time=0.55293 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.20585 (QuantReg: 11.79002) QuantErr: 11.79002 batch_time=0.56328 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.12407 (QuantReg: 11.46965) QuantErr: 11.46965 batch_time=0.50351 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.27132 (QuantReg: 11.63759) QuantErr: 11.63759 batch_time=0.57318 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.90366 (QuantReg: 12.03313) QuantErr: 12.03313 batch_time=0.63979 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.30933 (QuantReg: 11.78071) QuantErr: 11.78071 batch_time=0.52772 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.42450 (QuantReg: 11.70592) QuantErr: 11.70592 batch_time=0.50552 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 0.85379 (QuantReg: 11.97537) QuantErr: 11.97537 batch_time=2.43679 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 1.05947 (QuantReg: 11.87670) QuantErr: 11.87670 batch_time=0.52865 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.07499 (QuantReg: 11.85729) QuantErr: 11.85729 batch_time=0.50860 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.16174 (QuantReg: 11.85588) QuantErr: 11.85588 batch_time=0.54243 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.12730 (QuantReg: 11.69399) QuantErr: 11.69399 batch_time=0.55182 
Train Epoch: 50 codebook_update_time=1.68950
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/checkpoint-epoch50.pth ...
Done in 4.622s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 1.1057440257072448
 quant_reg      : 11.766554386138916
 quant_err      : 11.766554386138916
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 95.97585513078471
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.295774647887324
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.5992036594901
 MSRVTT_full_val/v2t_metrics/R1: 40.241448692152915
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 84.30583501006036
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.48692152917505
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.153933605403935
 MSRVTT_full_test/t2v_metrics/R1: 14.080267558528428
 MSRVTT_full_test/t2v_metrics/R5: 37.19063545150502
 MSRVTT_full_test/t2v_metrics/R10: 51.103678929765884
 MSRVTT_full_test/t2v_metrics/R50: 80.46822742474916
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.46120401337792
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.91108893428765
 MSRVTT_full_test/v2t_metrics/R1: 16.45484949832776
 MSRVTT_full_test/v2t_metrics/R5: 43.1438127090301
 MSRVTT_full_test/v2t_metrics/R10: 57.89297658862876
 MSRVTT_full_test/v2t_metrics/R50: 85.51839464882943
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.19765886287625
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.51009106631114
 mnt_best       : 30.158938224344737
 not_improved_count: 13
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/trained_model.pth ...
Ckpt loaded at epoch 37.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 14.147157190635452
 t2v_metrics/R5/final_eval: 37.89297658862876
 t2v_metrics/R10/final_eval: 51.17056856187291
 t2v_metrics/R50/final_eval: 81.30434782608695
 t2v_metrics/MedR/final_eval: 10.0
 t2v_metrics/MeanR/final_eval: 46.218060200668894
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 30.158938224344737
 v2t_metrics/R1/final_eval: 16.722408026755854
 v2t_metrics/R5/final_eval: 43.17725752508361
 v2t_metrics/R10/final_eval: 58.09364548494983
 v2t_metrics/R50/final_eval: 85.95317725752508
 v2t_metrics/MedR/final_eval: 8.0
 v2t_metrics/MeanR/final_eval: 33.70267558528428
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 34.745148060587034
Best epoch for the monitored metric: 37
Script took 04h41m55s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_t0.07/trained_model.pth
