Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 811.0574376583099 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 85.74456357955933 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 43.33994388580322 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch0.pth ...
Done in 1.796s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch0.pth ...
Done in 3.460s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 1.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 5.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 485.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 494.112
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.43795191398878897
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 0.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 496.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 493.702
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3419951893353394
 mnt_best       : 0.43795191398878897
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.83321 batch_time=38.75356 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.55884 batch_time=0.35242 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.21513 batch_time=0.37434 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.86139 batch_time=0.40733 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.04398 batch_time=0.37499 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.03013 batch_time=0.42627 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.40366 batch_time=0.35981 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.25276 batch_time=0.35951 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 4.87718 batch_time=0.38997 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 4.70524 batch_time=0.36327 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.56746 batch_time=0.58475 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 4.97241 batch_time=0.42418 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 4.97422 batch_time=0.35297 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.36990 batch_time=0.38948 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.17327 batch_time=0.39357 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.89374 batch_time=0.37422 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.63553 batch_time=0.36188 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.59982 batch_time=0.42226 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 3.85584 batch_time=0.35819 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.60516 batch_time=0.36817 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.15196 batch_time=0.37183 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 3.92010 batch_time=0.37986 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.73537 batch_time=0.35597 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch1.pth ...
Done in 4.126s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch1.pth ...
Done in 8.502s
 epoch          : 1
 loss           : 5.302695032119751
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 34.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 49.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 82.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.672
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.91325535010279
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 34.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 48.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 81.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 37.2315
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.42785098554119
 mnt_best       : 27.91325535010279
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.48345 batch_time=31.92820 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.11689 batch_time=0.39453 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.57470 batch_time=0.36320 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.81072 batch_time=0.42364 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.87468 batch_time=0.35144 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 3.69815 batch_time=0.41721 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.41010 batch_time=0.44249 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.57313 batch_time=0.38652 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 3.52725 batch_time=0.35560 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.05465 batch_time=0.37835 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.68691 batch_time=0.35020 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.46495 batch_time=0.40442 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.97822 batch_time=1.73874 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 3.89005 batch_time=0.35638 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.72030 batch_time=0.38227 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.35849 batch_time=0.36510 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.84977 batch_time=0.38461 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.31270 batch_time=0.34766 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.49002 batch_time=0.36189 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.57378 batch_time=0.37143 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.46337 batch_time=0.41013 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.48213 batch_time=0.37758 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.50868 batch_time=0.37029 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch2.pth ...
Done in 4.186s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch2.pth ...
Done in 8.286s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 3.6919657735824587
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.568
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.423900996623196
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.77
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.900188746179474
 mnt_best       : 35.423900996623196
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 4.30686 batch_time=42.35107 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.34729 batch_time=0.38585 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.30795 batch_time=0.39040 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 2.86696 batch_time=0.39476 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.28791 batch_time=0.36316 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 3.65286 batch_time=0.41073 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.19888 batch_time=0.38404 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 2.94013 batch_time=0.36728 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.38472 batch_time=0.36927 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 3.64630 batch_time=0.36033 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.26321 batch_time=0.36882 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.22797 batch_time=0.37745 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.60693 batch_time=0.45761 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.11865 batch_time=0.36660 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 2.80921 batch_time=0.40589 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.40696 batch_time=0.35698 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.27922 batch_time=0.36042 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 2.73623 batch_time=0.37222 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 2.90951 batch_time=0.42052 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.20368 batch_time=0.35311 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.39794 batch_time=0.37377 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.25729 batch_time=0.57094 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 2.46572 batch_time=0.35881 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch3.pth ...
Done in 4.253s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch3.pth ...
Done in 8.341s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 3.1655610761642454
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.116
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.24801168698227
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.171
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.07317387000417
 mnt_best       : 38.24801168698227
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 2.83390 batch_time=43.50732 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.80178 batch_time=0.35623 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 3.26701 batch_time=0.37690 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.93273 batch_time=0.34819 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.94012 batch_time=0.37733 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.02576 batch_time=0.39380 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.93515 batch_time=0.35187 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 3.40838 batch_time=0.39157 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 2.98446 batch_time=0.36540 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.61285 batch_time=0.38110 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 3.01557 batch_time=0.35123 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.20144 batch_time=0.39062 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 2.47856 batch_time=0.37460 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.84249 batch_time=0.37567 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.97859 batch_time=0.40732 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.66374 batch_time=0.36577 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.72174 batch_time=0.35409 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.99025 batch_time=0.40720 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.99927 batch_time=0.35390 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.81732 batch_time=0.35180 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.51219 batch_time=0.37375 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.52766 batch_time=0.40159 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.63529 batch_time=0.36974 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch4.pth ...
Done in 18.243s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch4.pth ...
Done in 22.505s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 2.8254437160491945
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.151
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.91908008108104
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 28.1335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.7647862399525
 mnt_best       : 38.91908008108104
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.59049 batch_time=39.10443 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 2.94171 batch_time=0.36357 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.85674 batch_time=0.37489 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.81189 batch_time=0.38330 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.52726 batch_time=0.35864 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.91179 batch_time=0.35434 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.84990 batch_time=0.39726 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 2.37548 batch_time=0.40316 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 3.08638 batch_time=0.39901 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.35250 batch_time=0.42160 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.99537 batch_time=0.37258 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.37393 batch_time=0.40340 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.64540 batch_time=0.40923 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.83497 batch_time=1.13229 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.28067 batch_time=0.43056 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.43073 batch_time=0.38158 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.34828 batch_time=0.36250 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.54340 batch_time=0.37629 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.59220 batch_time=0.35462 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.89580 batch_time=1.36577 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.42801 batch_time=0.42308 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.63119 batch_time=0.41570 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.76872 batch_time=0.38079 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch5.pth ...
Done in 4.197s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch5.pth ...
Done in 8.343s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 2.5774898014068603
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.723
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.65454340169327
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.8675
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.91914717383457
 mnt_best       : 40.65454340169327
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.42454 batch_time=39.69702 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.51535 batch_time=0.36039 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.80334 batch_time=0.38636 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.18764 batch_time=0.38054 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.20137 batch_time=0.35658 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.49996 batch_time=0.37270 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.95828 batch_time=2.78382 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.32905 batch_time=0.36778 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.06817 batch_time=0.37680 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 1.90410 batch_time=0.40872 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.06331 batch_time=0.63070 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.49625 batch_time=0.37598 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.42265 batch_time=0.38102 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.76486 batch_time=0.36792 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.60260 batch_time=0.35022 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.32519 batch_time=0.35155 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.44845 batch_time=0.35803 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.30875 batch_time=0.38925 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.12375 batch_time=0.37961 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.16032 batch_time=0.61598 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.38276 batch_time=0.44698 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.18665 batch_time=0.35463 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.42034 batch_time=0.37835 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch6.pth ...
Done in 4.324s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch6.pth ...
Done in 8.690s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 2.3731786994934083
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.904
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.28298188640817
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2955
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.07537485248506
 mnt_best       : 41.28298188640817
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 1.96023 batch_time=34.09252 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.51897 batch_time=0.36024 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.05731 batch_time=0.38048 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.12541 batch_time=0.35483 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.24662 batch_time=0.36544 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.35509 batch_time=0.40301 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 1.90875 batch_time=0.72055 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.40559 batch_time=0.37460 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.14536 batch_time=0.40174 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.35103 batch_time=0.35168 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 1.82102 batch_time=0.36234 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 1.67242 batch_time=0.36109 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.03380 batch_time=1.34078 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.17350 batch_time=0.51817 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.17110 batch_time=0.38220 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.62749 batch_time=0.36934 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 2.43636 batch_time=0.36299 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.06778 batch_time=0.37888 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 2.08706 batch_time=1.39519 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.49924 batch_time=5.00832 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.44782 batch_time=1.08144 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.22771 batch_time=0.35770 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.15007 batch_time=0.38142 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch7.pth ...
Done in 20.554s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch7.pth ...
Done in 24.617s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 2.2314032526016234
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.055
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.56526296048757
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.344
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.53141167138888
 mnt_best       : 42.56526296048757
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.27780 batch_time=39.33666 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.27694 batch_time=0.35876 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.44124 batch_time=0.39673 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 1.82519 batch_time=0.37228 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.29133 batch_time=0.36466 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.13005 batch_time=0.36365 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.22669 batch_time=0.38860 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 1.94836 batch_time=0.35713 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.04634 batch_time=0.37664 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.48791 batch_time=0.41149 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.14099 batch_time=0.36338 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.03263 batch_time=0.35025 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 1.80880 batch_time=0.35730 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.32796 batch_time=0.46623 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.15042 batch_time=0.35425 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 1.90972 batch_time=0.37332 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.11083 batch_time=0.40516 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.36849 batch_time=0.39018 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 1.82632 batch_time=0.39233 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 1.46730 batch_time=0.34991 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.38083 batch_time=0.36437 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 2.22674 batch_time=0.65903 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.05873 batch_time=0.37337 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch8.pth ...
Done in 4.163s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch8.pth ...
Done in 8.243s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 2.0387398314476015
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.289
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.19297993353577
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9885
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.42454104118724
 mnt_best       : 43.19297993353577
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 2.10056 batch_time=36.79518 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.13755 batch_time=0.35224 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.00896 batch_time=0.35619 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 1.92719 batch_time=0.38314 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.06796 batch_time=0.37803 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 2.28668 batch_time=0.36540 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.91023 batch_time=1.20750 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 1.86906 batch_time=0.35667 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 1.91710 batch_time=0.37228 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.72770 batch_time=0.36222 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 1.74314 batch_time=0.35348 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.83060 batch_time=0.37538 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 1.91458 batch_time=0.38937 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.18217 batch_time=0.35448 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.71556 batch_time=0.35239 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.73763 batch_time=0.35420 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 1.95137 batch_time=0.35571 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 2.28158 batch_time=0.41648 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 2.28091 batch_time=3.40867 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.66280 batch_time=0.36306 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.85249 batch_time=0.37293 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.79646 batch_time=0.36875 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.52774 batch_time=0.35564 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch9.pth ...
Done in 4.170s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch9.pth ...
Done in 8.649s
removing stale ckpt [epoch 8] [took 0.03s]
 epoch          : 9
 loss           : 1.9539781589508056
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.617
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.61210299805952
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.9385
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.89339342918998
 mnt_best       : 44.61210299805952
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.91294 batch_time=34.09649 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 1.80691 batch_time=0.38173 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 1.95778 batch_time=0.35062 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 1.71577 batch_time=0.37537 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 2.14858 batch_time=0.39592 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 1.51504 batch_time=0.36005 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 1.87744 batch_time=5.69672 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 1.58626 batch_time=3.59265 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 1.75398 batch_time=0.37976 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.01943 batch_time=0.35104 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 2.21270 batch_time=0.36168 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 1.63608 batch_time=0.37878 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 1.68242 batch_time=0.38667 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.76991 batch_time=0.35413 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.43864 batch_time=0.35522 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.08949 batch_time=0.44136 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 1.93165 batch_time=0.37956 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 2.39225 batch_time=0.39943 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.77183 batch_time=0.35822 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.86170 batch_time=0.35924 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 2.29743 batch_time=0.34765 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 1.90152 batch_time=0.37360 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 1.56638 batch_time=0.35755 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch10.pth ...
Done in 19.521s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 1.8737136840820312
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.373
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.13295247868025
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.723
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.33162869935166
 mnt_best       : 44.61210299805952
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 2.11127 batch_time=39.14476 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 1.96242 batch_time=0.37230 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 1.72921 batch_time=0.38849 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 1.88077 batch_time=0.45563 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.03925 batch_time=0.43405 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 1.78557 batch_time=0.35742 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 2.14616 batch_time=0.37211 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 1.91828 batch_time=0.36916 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.91288 batch_time=0.35796 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.92178 batch_time=0.33460 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.52664 batch_time=0.42348 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.97055 batch_time=0.36122 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 1.77863 batch_time=0.39846 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.73898 batch_time=0.36635 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.96476 batch_time=0.49959 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 1.31436 batch_time=0.36275 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.98204 batch_time=0.36466 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.85941 batch_time=0.38425 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.74116 batch_time=0.36171 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.80701 batch_time=0.34850 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 2.04118 batch_time=0.37167 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.99631 batch_time=0.37926 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.89518 batch_time=0.37364 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch11.pth ...
Done in 4.065s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch11.pth ...
Done in 8.064s
removing stale ckpt [epoch 10] [took 0.02s]
 epoch          : 11
 loss           : 1.7867639369964599
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.34
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.82444589506789
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3775
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.697094536614166
 mnt_best       : 44.82444589506789
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.75476 batch_time=34.07459 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.63487 batch_time=0.35712 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.42055 batch_time=0.35178 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 1.71682 batch_time=0.35087 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.80134 batch_time=0.36086 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.54045 batch_time=0.35756 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.72028 batch_time=7.84085 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.51408 batch_time=0.35896 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.59222 batch_time=0.37034 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.47071 batch_time=0.36532 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.69703 batch_time=0.36406 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.63674 batch_time=0.35154 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.83569 batch_time=0.36651 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.53272 batch_time=0.40335 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.50840 batch_time=0.35411 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.71666 batch_time=0.36752 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.54746 batch_time=0.36085 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.63810 batch_time=0.39738 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.42327 batch_time=0.36927 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.45149 batch_time=0.38784 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.61746 batch_time=0.38862 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.69266 batch_time=0.34940 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.57327 batch_time=0.36960 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch12.pth ...
Done in 7.512s
removing stale ckpt [epoch 11] [took 0.02s]
 epoch          : 12
 loss           : 1.7035935010910035
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.019
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.72859153043614
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.626
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.56720865041276
 mnt_best       : 44.82444589506789
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.73763 batch_time=32.49984 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.86104 batch_time=0.36984 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.29918 batch_time=0.35641 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.52552 batch_time=0.39127 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.62600 batch_time=0.35786 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.49613 batch_time=0.43792 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.53747 batch_time=1.72250 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.39630 batch_time=0.37351 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.23408 batch_time=1.02031 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.51523 batch_time=1.36479 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.96268 batch_time=0.35328 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.36894 batch_time=0.36613 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.84339 batch_time=0.37320 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.38315 batch_time=0.39300 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.47841 batch_time=0.36388 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.54123 batch_time=0.48199 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.44729 batch_time=0.38589 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.57733 batch_time=0.38845 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.50552 batch_time=3.46757 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.75414 batch_time=0.37010 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.73100 batch_time=0.36272 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.64619 batch_time=0.37503 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 2.14631 batch_time=0.35519 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch13.pth ...
Done in 6.925s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch13.pth ...
Done in 11.941s
removing stale ckpt [epoch 12] [took 0.13s]
 epoch          : 13
 loss           : 1.6251713590621948
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.738
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.50278805924026
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.671
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.2739248021565
 mnt_best       : 45.50278805924026
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.40430 batch_time=32.78223 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.43993 batch_time=0.37688 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 2.11524 batch_time=0.38631 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.29140 batch_time=0.36277 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.37409 batch_time=0.35969 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.98651 batch_time=0.36369 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.46346 batch_time=0.41644 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.28478 batch_time=0.37642 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.52690 batch_time=0.40103 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.74992 batch_time=0.38023 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.58391 batch_time=0.37523 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.08242 batch_time=0.35517 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.73367 batch_time=0.50436 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.93263 batch_time=0.68757 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.50001 batch_time=0.35903 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.19114 batch_time=0.38971 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.99932 batch_time=0.45595 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.35090 batch_time=0.35450 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.69836 batch_time=0.37160 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.39257 batch_time=0.41847 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.50650 batch_time=0.37300 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.49460 batch_time=0.35914 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.60031 batch_time=0.36092 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch14.pth ...
Done in 5.075s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch14.pth ...
Done in 9.668s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 1.5650616292953492
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.806
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.578573728935154
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4315
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.46542000703125
 mnt_best       : 45.578573728935154
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.44267 batch_time=42.57187 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.42290 batch_time=0.35135 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.44833 batch_time=0.35583 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.45924 batch_time=0.36855 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.64505 batch_time=0.39926 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.52716 batch_time=0.37516 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.59578 batch_time=1.53152 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.41712 batch_time=0.36294 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.53713 batch_time=0.37440 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.79870 batch_time=1.08888 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.45569 batch_time=0.36357 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.36685 batch_time=0.36794 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.41648 batch_time=0.35087 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.51751 batch_time=0.37014 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.44387 batch_time=0.38907 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.39268 batch_time=0.36262 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.64912 batch_time=0.36459 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.23378 batch_time=0.36661 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.44646 batch_time=0.38376 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.39017 batch_time=0.38676 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.41335 batch_time=0.36483 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.38948 batch_time=0.38549 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.09535 batch_time=0.36071 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch15.pth ...
Done in 6.481s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch15.pth ...
Done in 11.455s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 1.5172546339035033
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.502
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.82945544564452
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.794
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.65626710699324
 mnt_best       : 45.82945544564452
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.47936 batch_time=34.39687 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.15618 batch_time=0.35238 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.48692 batch_time=0.39737 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 1.53267 batch_time=0.37418 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.42071 batch_time=0.40829 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.64815 batch_time=0.36100 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.43254 batch_time=1.06561 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.39022 batch_time=4.05128 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.66595 batch_time=0.35809 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.49323 batch_time=0.38756 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.66975 batch_time=0.36979 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.53927 batch_time=0.36081 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.43782 batch_time=0.36224 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.67688 batch_time=4.30638 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.29240 batch_time=0.37280 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.53380 batch_time=0.35831 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.31881 batch_time=0.37229 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.35126 batch_time=0.36101 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.80574 batch_time=0.39367 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.59771 batch_time=0.39497 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.67869 batch_time=0.37626 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.19000 batch_time=0.36943 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.11683 batch_time=0.35042 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch16.pth ...
Done in 5.065s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch16.pth ...
Done in 10.345s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 1.460527706384659
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.967
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.314878744506856
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.6575
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.199449029241954
 mnt_best       : 46.314878744506856
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.25544 batch_time=37.47306 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.32854 batch_time=0.34744 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.42796 batch_time=1.23132 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.31730 batch_time=0.40464 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.49102 batch_time=0.36826 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.48241 batch_time=0.36528 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.08310 batch_time=2.98730 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.49767 batch_time=0.35182 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.24127 batch_time=0.38126 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.66470 batch_time=0.36251 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.31352 batch_time=0.34889 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.44432 batch_time=0.36687 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.59064 batch_time=0.36715 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.66286 batch_time=1.21952 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.40728 batch_time=0.35193 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.60768 batch_time=0.72111 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.28823 batch_time=0.38362 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.38039 batch_time=0.36770 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.25106 batch_time=0.35754 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.32114 batch_time=0.39465 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.22484 batch_time=0.35022 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.24412 batch_time=0.72095 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.42454 batch_time=0.53073 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch17.pth ...
Done in 5.043s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 1.413589924812317
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.677
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.68687654560711
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.0535
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.95050833746019
 mnt_best       : 46.314878744506856
 not_improved_count: 1
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.02980 batch_time=34.45534 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.45808 batch_time=0.42349 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.53514 batch_time=0.35022 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.27926 batch_time=0.35136 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.44183 batch_time=0.37472 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.75537 batch_time=0.36090 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.16025 batch_time=0.36639 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.47294 batch_time=0.36454 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 0.92999 batch_time=0.41759 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.33920 batch_time=0.35320 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.38328 batch_time=0.41112 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.05986 batch_time=0.35936 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.56310 batch_time=0.36013 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.25662 batch_time=5.14445 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.34121 batch_time=0.35375 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.40369 batch_time=0.36782 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.29296 batch_time=0.37803 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.68552 batch_time=0.39853 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.48863 batch_time=0.40488 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.47688 batch_time=0.35115 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.16056 batch_time=0.37222 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.23532 batch_time=0.38748 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.23750 batch_time=0.35069 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch18.pth ...
Done in 5.419s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch18.pth ...
Done in 10.589s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 1.3662463321685792
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.362
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.10210546797157
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.941
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.138063331692514
 mnt_best       : 47.10210546797157
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.26612 batch_time=39.12228 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.86411 batch_time=0.36443 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.46279 batch_time=0.36492 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.16430 batch_time=0.41871 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.26067 batch_time=0.39975 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 0.99713 batch_time=0.37354 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.42771 batch_time=2.30329 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.54425 batch_time=0.34999 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.38502 batch_time=0.36253 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.12996 batch_time=0.35883 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.59157 batch_time=0.36171 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.43926 batch_time=0.39747 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.12032 batch_time=0.36471 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.26980 batch_time=0.36763 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.56774 batch_time=0.35949 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.18614 batch_time=0.35948 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 0.93085 batch_time=0.37848 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.49278 batch_time=0.35399 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.37062 batch_time=0.38653 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.21452 batch_time=0.35700 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.14198 batch_time=0.61774 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.32254 batch_time=0.37988 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.55101 batch_time=0.38252 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch19.pth ...
Done in 6.426s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 1.3272122967243194
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 24.69
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.813101744905865
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.3825
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.29821931031878
 mnt_best       : 47.10210546797157
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.53449 batch_time=33.16536 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.64583 batch_time=0.36341 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.43726 batch_time=0.37941 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.21544 batch_time=0.40462 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.25533 batch_time=0.38123 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.22357 batch_time=0.35465 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.54546 batch_time=0.37298 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.52539 batch_time=0.36119 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.54243 batch_time=0.37792 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.32289 batch_time=0.36729 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.00312 batch_time=0.43272 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.81984 batch_time=0.37316 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.45555 batch_time=1.90843 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.37705 batch_time=0.38196 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.18312 batch_time=0.83473 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.04211 batch_time=0.36303 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 0.97765 batch_time=0.34799 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 0.94044 batch_time=0.36544 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.07064 batch_time=0.39672 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.68341 batch_time=0.38309 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.21299 batch_time=0.37445 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.20565 batch_time=0.37757 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.21295 batch_time=0.39616 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch20.pth ...
Done in 5.260s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch20.pth ...
Done in 9.655s
removing stale ckpt [epoch 19] [took 0.02s]
 epoch          : 20
 loss           : 1.3004664158821106
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.829
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.308443680007734
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.722
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.21257130582009
 mnt_best       : 47.308443680007734
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.36533 batch_time=33.94539 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.54933 batch_time=0.35863 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.19335 batch_time=0.39042 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.49993 batch_time=0.36983 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.21370 batch_time=0.36806 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.69426 batch_time=0.37455 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.42770 batch_time=1.00852 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.57983 batch_time=0.40702 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.45080 batch_time=0.37267 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.51738 batch_time=0.40096 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.32226 batch_time=0.38127 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 0.94718 batch_time=0.39356 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.15396 batch_time=0.36406 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.53858 batch_time=3.64226 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.16024 batch_time=0.36194 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.24451 batch_time=0.37277 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.59353 batch_time=0.34899 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.16378 batch_time=0.36897 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.22064 batch_time=0.37663 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.44503 batch_time=0.35677 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.11907 batch_time=0.35860 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.07875 batch_time=0.36219 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.33962 batch_time=0.38938 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch21.pth ...
Done in 4.654s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 1.2507766733169556
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.836
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.123293007610606
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.5615
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.181956499787496
 mnt_best       : 47.308443680007734
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.30959 batch_time=31.36937 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.05994 batch_time=0.36817 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.28131 batch_time=0.35738 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.30660 batch_time=0.38336 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.25090 batch_time=0.36589 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.35807 batch_time=0.38812 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.42275 batch_time=0.37563 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.14648 batch_time=0.38962 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.20566 batch_time=0.36816 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.00406 batch_time=0.35792 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.18318 batch_time=0.40605 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.40007 batch_time=0.36225 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.56772 batch_time=0.38741 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.25865 batch_time=0.41541 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.13753 batch_time=0.44022 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.10500 batch_time=0.36271 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.17566 batch_time=0.36361 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.61031 batch_time=0.35252 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.38232 batch_time=0.44940 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.39647 batch_time=0.37447 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.16225 batch_time=0.37997 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.11868 batch_time=0.38031 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.19452 batch_time=0.36942 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch22.pth ...
Done in 7.251s
removing stale ckpt [epoch 21] [took 0.21s]
 epoch          : 22
 loss           : 1.2392244358062745
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.658
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.69108190665608
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.097
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.807431604224384
 mnt_best       : 47.308443680007734
 not_improved_count: 2
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.56022 batch_time=34.32889 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 0.91786 batch_time=0.41853 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.57608 batch_time=0.36722 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.55620 batch_time=0.35980 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.38505 batch_time=0.35747 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.05335 batch_time=0.38873 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.09081 batch_time=0.38239 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.34830 batch_time=0.36225 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.37815 batch_time=0.36927 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.17140 batch_time=0.44563 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.31038 batch_time=0.35863 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 0.96727 batch_time=0.36948 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.63293 batch_time=0.35015 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.00914 batch_time=0.37637 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 0.86993 batch_time=0.36943 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.61387 batch_time=0.36318 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.27517 batch_time=0.37754 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.13417 batch_time=0.40975 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.11418 batch_time=0.39348 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.34323 batch_time=0.36177 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 0.88800 batch_time=0.35754 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.25771 batch_time=0.42264 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 0.99295 batch_time=0.36058 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch23.pth ...
Done in 4.974s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch23.pth ...
Done in 9.490s
removing stale ckpt [epoch 22] [took 0.02s]
 epoch          : 23
 loss           : 1.2149687752723695
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.093
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.88561275129476
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.144
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.71456878376088
 mnt_best       : 47.88561275129476
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.30036 batch_time=37.14457 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.32310 batch_time=0.36409 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.49075 batch_time=0.34841 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.17911 batch_time=0.37568 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.20863 batch_time=0.35034 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.08632 batch_time=0.37051 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 0.90019 batch_time=0.44619 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.43945 batch_time=0.38018 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.06577 batch_time=0.36591 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 0.94836 batch_time=0.37909 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.18939 batch_time=0.41605 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 0.92363 batch_time=0.35660 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.10430 batch_time=4.69277 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 0.85014 batch_time=0.35989 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.39892 batch_time=0.38832 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.07584 batch_time=0.37262 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.93547 batch_time=0.38400 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 0.76547 batch_time=0.37540 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.24536 batch_time=0.38636 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.20015 batch_time=0.36437 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.18325 batch_time=0.35944 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 0.91695 batch_time=0.35426 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.24519 batch_time=0.95566 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch24.pth ...
Done in 4.875s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 1.1863082854747773
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.251
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.19295206217575
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9895
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.08421148195521
 mnt_best       : 47.88561275129476
 not_improved_count: 1
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.65414 batch_time=40.39021 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.12340 batch_time=0.37133 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.01241 batch_time=0.38160 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.17780 batch_time=0.34842 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.07265 batch_time=0.37611 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.20981 batch_time=0.44404 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.27154 batch_time=0.37538 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.29549 batch_time=0.39214 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 0.97862 batch_time=1.40620 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.31473 batch_time=0.34637 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.17860 batch_time=0.36966 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.40580 batch_time=0.42060 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 0.99237 batch_time=0.47020 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 0.92925 batch_time=0.37178 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.16829 batch_time=0.41382 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.15813 batch_time=0.35077 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.25634 batch_time=0.35875 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 0.86428 batch_time=0.41527 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.79232 batch_time=0.37417 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.13236 batch_time=0.39092 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.24346 batch_time=0.38974 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.26095 batch_time=0.36729 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.15540 batch_time=0.36282 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch25.pth ...
Done in 4.329s
removing stale ckpt [epoch 24] [took 0.01s]
 epoch          : 25
 loss           : 1.153589231967926
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.866
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.76301153960311
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9365
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.8965480287157
 mnt_best       : 47.88561275129476
 not_improved_count: 2
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.16615 batch_time=34.35920 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.10871 batch_time=0.37930 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.03805 batch_time=0.40835 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.02818 batch_time=0.66261 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.17840 batch_time=0.41830 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.15056 batch_time=0.38955 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.02693 batch_time=0.35378 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.28320 batch_time=0.38042 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.15968 batch_time=0.36179 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.06373 batch_time=0.39450 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 0.85784 batch_time=0.35793 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.03202 batch_time=0.35123 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.09805 batch_time=0.39312 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.26573 batch_time=1.00985 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 0.95308 batch_time=0.35516 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.11378 batch_time=0.35790 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.08714 batch_time=0.37721 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 0.89089 batch_time=0.41630 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.52824 batch_time=0.36031 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 0.99362 batch_time=0.40441 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.04356 batch_time=0.36937 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 0.86141 batch_time=0.34942 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 0.98885 batch_time=0.36365 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch26.pth ...
Done in 5.483s
removing stale ckpt [epoch 25] [took 0.03s]
 epoch          : 26
 loss           : 1.133606855869293
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 28.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.829
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.83776244833942
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 22.934
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.7947678704785
 mnt_best       : 47.88561275129476
 not_improved_count: 3
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.16892 batch_time=36.31043 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.39610 batch_time=0.35930 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.24351 batch_time=0.79516 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 0.94313 batch_time=0.35471 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.15736 batch_time=0.36996 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.25430 batch_time=0.40203 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.12234 batch_time=0.61399 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 0.81416 batch_time=0.37942 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.07922 batch_time=1.21543 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.22302 batch_time=0.37956 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 0.84531 batch_time=0.40303 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.05230 batch_time=0.35748 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 0.98217 batch_time=0.38369 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.08471 batch_time=0.62025 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.01784 batch_time=0.37709 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.10486 batch_time=0.37999 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 0.92609 batch_time=0.36296 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.15799 batch_time=0.39833 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.10628 batch_time=0.35154 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.31206 batch_time=0.89572 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.29361 batch_time=1.24735 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.18331 batch_time=0.38056 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.13546 batch_time=0.37984 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch27.pth ...
Done in 24.808s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 1.1138440034389496
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.039
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.98493556741867
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.209
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.267051701784176
 mnt_best       : 47.88561275129476
 not_improved_count: 4
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.10964 batch_time=41.81415 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.05874 batch_time=0.41012 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.05177 batch_time=0.39660 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.35623 batch_time=0.36880 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.05729 batch_time=0.36171 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 0.98452 batch_time=0.71701 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.19546 batch_time=0.35581 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.17599 batch_time=0.36803 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.04242 batch_time=0.35351 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.30953 batch_time=0.44189 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 0.93076 batch_time=0.36239 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.35676 batch_time=0.36618 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.17129 batch_time=0.37010 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.31473 batch_time=0.35657 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.03634 batch_time=0.39855 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.03654 batch_time=0.83027 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.02401 batch_time=0.35364 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 0.95807 batch_time=0.41282 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.05866 batch_time=0.38520 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.24224 batch_time=0.37099 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.34124 batch_time=0.37333 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 0.92474 batch_time=0.35938 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 0.97758 batch_time=0.36138 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch28.pth ...
Done in 5.521s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch28.pth ...
Done in 10.656s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 1.0975145421028136
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.807
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.96820811456595
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.027
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.667475157580164
 mnt_best       : 47.96820811456595
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.01445 batch_time=33.74291 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.17484 batch_time=0.35095 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.08129 batch_time=0.41020 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.33721 batch_time=0.40003 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.21459 batch_time=0.40907 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.48489 batch_time=0.37718 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.03153 batch_time=0.35409 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.16477 batch_time=0.35939 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.05474 batch_time=0.37431 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.27637 batch_time=0.36842 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 0.86203 batch_time=0.37954 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 0.98892 batch_time=0.40255 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.37774 batch_time=0.37319 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 0.95783 batch_time=0.36601 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 0.97412 batch_time=0.36937 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.00588 batch_time=0.39450 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.08109 batch_time=0.36854 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.08911 batch_time=0.37588 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.05974 batch_time=0.63869 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.48799 batch_time=0.39171 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.10930 batch_time=0.39486 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.16544 batch_time=0.38501 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.38070 batch_time=0.39013 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch29.pth ...
Done in 4.841s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch29.pth ...
Done in 10.173s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 1.0809392457008362
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 58.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.789
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 48.32704899136895
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 72.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3765
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.45537028807405
 mnt_best       : 48.32704899136895
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.17565 batch_time=40.27257 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.08856 batch_time=0.34941 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 0.96523 batch_time=0.35993 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 0.90057 batch_time=0.35735 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.20101 batch_time=0.40644 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.01805 batch_time=0.35273 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 0.90309 batch_time=1.04794 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.27528 batch_time=0.35660 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 0.96042 batch_time=0.38656 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 0.77442 batch_time=0.35443 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.22714 batch_time=0.35974 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.24677 batch_time=0.37795 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.08824 batch_time=0.37699 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 0.75760 batch_time=0.38419 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 0.98229 batch_time=0.38568 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 0.99704 batch_time=0.37405 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.06825 batch_time=0.35957 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.05813 batch_time=0.37017 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.03613 batch_time=0.41328 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.08908 batch_time=0.35679 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.05371 batch_time=0.36092 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 0.75303 batch_time=0.40527 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 0.90824 batch_time=0.43331 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch30.pth ...
Done in 5.639s
removing stale ckpt [epoch 29] [took 0.01s]
 epoch          : 30
 loss           : 1.052516443014145
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.199
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.572828630452406
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.973
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.58398033660086
 mnt_best       : 48.32704899136895
 not_improved_count: 1
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.00325 batch_time=34.47752 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 0.92432 batch_time=0.35825 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 0.94613 batch_time=0.40593 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.07099 batch_time=0.38028 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.06463 batch_time=0.37951 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 0.85105 batch_time=0.38671 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.14133 batch_time=0.40474 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.22406 batch_time=0.34812 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.02322 batch_time=0.36043 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.29964 batch_time=0.39389 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.25785 batch_time=0.36717 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.24046 batch_time=0.36286 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 0.99518 batch_time=0.44724 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 0.89807 batch_time=1.58479 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.15168 batch_time=0.36671 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 0.95208 batch_time=1.04685 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 0.85145 batch_time=0.35175 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.10693 batch_time=0.36829 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.14448 batch_time=0.60503 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.08961 batch_time=0.57441 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.18473 batch_time=0.39045 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.15413 batch_time=0.38996 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.04953 batch_time=0.37121 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch31.pth ...
Done in 4.377s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 31
 loss           : 1.0440448091030121
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.841
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.57390511780097
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.2175
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.4556403124706
 mnt_best       : 48.32704899136895
 not_improved_count: 2
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 0.92069 batch_time=33.60432 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 0.83549 batch_time=0.36324 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.03874 batch_time=0.35643 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 0.92637 batch_time=0.38284 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 1.03445 batch_time=0.38071 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.08763 batch_time=0.36303 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.02520 batch_time=3.99745 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.07518 batch_time=0.35303 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 0.94744 batch_time=0.42942 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.06161 batch_time=0.37547 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.16518 batch_time=0.36688 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.39762 batch_time=0.37498 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 0.89234 batch_time=0.38989 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 0.71865 batch_time=0.35746 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.02500 batch_time=0.40388 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 0.85018 batch_time=0.34821 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.06623 batch_time=0.34912 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.93628 batch_time=0.40595 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 0.92236 batch_time=0.36578 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.11017 batch_time=0.39689 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 0.86353 batch_time=0.36127 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.04409 batch_time=0.51214 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 0.96342 batch_time=0.40887 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch32.pth ...
Done in 4.426s
removing stale ckpt [epoch 31] [took 0.01s]
 epoch          : 32
 loss           : 1.0277834815979003
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.295
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.76304178542644
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.655
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.29868442850139
 mnt_best       : 48.32704899136895
 not_improved_count: 3
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 0.84761 batch_time=40.95808 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 0.96645 batch_time=0.35254 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.11830 batch_time=0.34835 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.18385 batch_time=0.40437 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 0.88507 batch_time=0.35920 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 0.97881 batch_time=0.35943 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.96808 batch_time=0.39117 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.06321 batch_time=0.40694 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.24452 batch_time=0.37022 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.07627 batch_time=0.37138 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.15642 batch_time=0.35241 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.04272 batch_time=0.38477 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.14428 batch_time=0.36996 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 0.75819 batch_time=1.41717 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.24449 batch_time=0.34994 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.01606 batch_time=0.35276 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.84823 batch_time=0.36378 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 0.80692 batch_time=0.35266 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 0.89274 batch_time=0.35886 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.02827 batch_time=0.43128 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.86052 batch_time=0.38951 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.01376 batch_time=0.38666 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 0.99259 batch_time=0.36021 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch33.pth ...
Done in 5.795s
removing stale ckpt [epoch 32] [took 0.24s]
 epoch          : 33
 loss           : 1.00518696641922
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.89
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.969670654910026
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.354
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.16858544230743
 mnt_best       : 48.32704899136895
 not_improved_count: 4
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.00259 batch_time=39.36284 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.15386 batch_time=0.36943 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 0.76143 batch_time=0.44210 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.13146 batch_time=0.35291 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 0.87578 batch_time=0.38392 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 0.98664 batch_time=0.37143 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.90093 batch_time=0.37117 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.01502 batch_time=0.37022 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 0.97360 batch_time=0.36393 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 0.90442 batch_time=0.36475 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.00568 batch_time=0.47460 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.20175 batch_time=0.39248 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 0.83312 batch_time=0.35539 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 0.96196 batch_time=0.38562 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.17132 batch_time=0.38438 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 0.91708 batch_time=0.37743 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 0.95703 batch_time=0.35262 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.21072 batch_time=0.35767 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.12611 batch_time=0.35307 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.14829 batch_time=3.36315 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.08531 batch_time=0.35950 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 0.94246 batch_time=0.34885 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 0.86509 batch_time=0.38144 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch34.pth ...
Done in 5.175s
removing stale ckpt [epoch 33] [took 0.01s]
 epoch          : 34
 loss           : 0.9964554340839386
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.528
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.423714744036616
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.364
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.88613636090239
 mnt_best       : 48.32704899136895
 not_improved_count: 5
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.06394 batch_time=36.92840 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.15033 batch_time=0.43479 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.00497 batch_time=0.42897 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 0.83775 batch_time=0.38108 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.14220 batch_time=0.35215 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 0.70572 batch_time=0.38597 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.25881 batch_time=0.39468 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 0.74170 batch_time=0.42640 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.04533 batch_time=0.37325 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 0.97270 batch_time=0.35614 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.08640 batch_time=0.34793 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.00639 batch_time=0.38917 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 0.98412 batch_time=0.81775 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.17750 batch_time=0.39284 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.07357 batch_time=0.38015 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 1.02323 batch_time=0.37161 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.15970 batch_time=0.87631 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 0.88142 batch_time=0.37317 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.07622 batch_time=4.29599 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 0.86314 batch_time=0.35174 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.90369 batch_time=0.39015 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.08885 batch_time=0.36746 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 0.82366 batch_time=0.37919 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch35.pth ...
Done in 5.416s
removing stale ckpt [epoch 34] [took 0.01s]
 epoch          : 35
 loss           : 0.9872035443782806
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.275
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 48.02066644798536
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.091
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.118756147271014
 mnt_best       : 48.32704899136895
 not_improved_count: 6
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 0.89911 batch_time=47.03642 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 0.90188 batch_time=0.35023 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 1.07215 batch_time=0.35604 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.34637 batch_time=0.35565 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 0.94169 batch_time=0.36249 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.80323 batch_time=0.34653 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 0.93559 batch_time=0.37510 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.09840 batch_time=0.37809 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 0.99995 batch_time=0.34989 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 0.83608 batch_time=0.36521 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 0.78465 batch_time=0.37438 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 0.91491 batch_time=0.37925 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 0.87778 batch_time=0.40623 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 0.87801 batch_time=0.34833 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.83410 batch_time=0.35961 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.93760 batch_time=0.36905 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 0.72493 batch_time=0.37786 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 0.84458 batch_time=0.37149 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 0.99877 batch_time=0.36730 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 0.95024 batch_time=0.35875 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 1.25199 batch_time=0.35518 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.92086 batch_time=0.34501 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.86412 batch_time=0.35884 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch36.pth ...
Done in 5.874s
removing stale ckpt [epoch 35] [took 0.03s]
 epoch          : 36
 loss           : 0.9840640070438385
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.979
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 48.07455081870971
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 72.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.847
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 49.38614788608851
 mnt_best       : 48.32704899136895
 not_improved_count: 7
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.03142 batch_time=36.09999 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.23280 batch_time=0.35063 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.99690 batch_time=1.61347 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 0.95179 batch_time=0.38662 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.36005 batch_time=0.39076 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.04756 batch_time=0.38392 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 0.99616 batch_time=0.36479 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.33660 batch_time=0.38203 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 0.82506 batch_time=0.44077 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.08000 batch_time=0.38950 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 0.96904 batch_time=0.38338 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.26239 batch_time=0.46786 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 0.85362 batch_time=0.36022 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 0.91787 batch_time=0.35893 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.78925 batch_time=0.37539 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 0.96187 batch_time=0.35261 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.17099 batch_time=0.35246 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.83944 batch_time=0.34708 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 0.90376 batch_time=1.09355 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 0.92200 batch_time=0.39810 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.02619 batch_time=0.36318 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.32028 batch_time=0.35866 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 0.89175 batch_time=0.39509 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch37.pth ...
Done in 5.008s
removing stale ckpt [epoch 36] [took 0.02s]
 epoch          : 37
 loss           : 0.9900144600868225
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 58.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.336
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.57318240824593
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4565
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.30331240223066
 mnt_best       : 48.32704899136895
 not_improved_count: 8
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.93955 batch_time=35.99517 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.58959 batch_time=0.37611 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 1.08122 batch_time=0.35604 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.13294 batch_time=0.37180 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 0.97383 batch_time=0.36470 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.85087 batch_time=0.91637 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.38241 batch_time=0.35191 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 0.94064 batch_time=0.36630 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.24608 batch_time=0.38306 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.89618 batch_time=0.35751 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.01132 batch_time=0.36565 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 0.75767 batch_time=0.37185 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 0.80362 batch_time=3.32042 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 0.89212 batch_time=0.37240 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 0.85750 batch_time=0.37736 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.81542 batch_time=0.85648 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 0.95018 batch_time=0.34944 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.08665 batch_time=0.38690 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 0.86041 batch_time=0.40970 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 0.77143 batch_time=0.37176 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.01031 batch_time=0.35690 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 0.88596 batch_time=0.38422 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.11837 batch_time=0.36002 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch38.pth ...
Done in 4.999s
removing stale ckpt [epoch 37] [took 0.03s]
 epoch          : 38
 loss           : 0.9493770835399628
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.884
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.3008341790377
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1385
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.55590506720362
 mnt_best       : 48.32704899136895
 not_improved_count: 9
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 1.22608 batch_time=36.76624 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.16204 batch_time=0.35503 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 0.83675 batch_time=0.36932 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.02419 batch_time=0.35214 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 0.98202 batch_time=0.37364 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.08723 batch_time=0.37044 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 0.91309 batch_time=0.35208 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.02934 batch_time=0.36340 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 0.65517 batch_time=0.38007 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 0.71554 batch_time=0.39889 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 0.83865 batch_time=0.37933 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 0.91879 batch_time=0.36041 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 0.79295 batch_time=0.73386 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 0.99597 batch_time=0.99029 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 0.74479 batch_time=0.37064 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 0.87154 batch_time=0.36178 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 0.86715 batch_time=0.35694 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 0.65805 batch_time=0.35978 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.97135 batch_time=0.93602 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.06145 batch_time=0.36679 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 0.89565 batch_time=0.37007 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 0.84592 batch_time=0.35056 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 1.00624 batch_time=0.36857 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch39.pth ...
Done in 5.440s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 0.9371043107509613
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.813
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.85632034907974
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1345
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.98798053102793
 mnt_best       : 48.32704899136895
 not_improved_count: 10
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 0.88508 batch_time=37.02054 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.16470 batch_time=0.40259 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 0.81707 batch_time=0.34935 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 0.88336 batch_time=0.36260 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.32326 batch_time=0.39528 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 0.87667 batch_time=0.38552 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 0.71830 batch_time=0.37445 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 0.79861 batch_time=0.35526 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 0.78532 batch_time=0.36938 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.92944 batch_time=0.39557 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 0.95291 batch_time=0.36568 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 0.88792 batch_time=0.36650 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 0.84657 batch_time=0.36511 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.15214 batch_time=0.36422 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.00911 batch_time=0.39275 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.00079 batch_time=0.36165 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.01053 batch_time=0.35282 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 0.83395 batch_time=0.87316 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.00423 batch_time=0.38838 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 0.80735 batch_time=0.35449 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.04479 batch_time=0.43148 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 0.98927 batch_time=0.38102 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.80237 batch_time=0.37359 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch40.pth ...
Done in 4.717s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 0.9353555583953858
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.295
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.40657092286121
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4305
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.15450215566736
 mnt_best       : 48.32704899136895
 not_improved_count: 11
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 0.75011 batch_time=37.08738 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.20282 batch_time=0.36413 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 0.65922 batch_time=1.09457 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.11325 batch_time=0.38768 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.10320 batch_time=0.36166 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.99677 batch_time=0.37090 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.98377 batch_time=0.39435 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.72146 batch_time=0.39152 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 0.66570 batch_time=0.35518 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.02412 batch_time=0.35687 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.16506 batch_time=0.35019 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.08336 batch_time=0.38239 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 0.79289 batch_time=0.37097 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 0.92989 batch_time=0.37871 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 0.94831 batch_time=0.39533 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.02464 batch_time=0.36642 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 0.76402 batch_time=0.44119 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 0.99612 batch_time=0.36040 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 0.77830 batch_time=0.35819 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.04568 batch_time=0.34810 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 0.72044 batch_time=0.35962 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 0.98624 batch_time=0.40921 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 0.71207 batch_time=0.38101 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch41.pth ...
Done in 4.432s
removing stale ckpt [epoch 40] [took 0.03s]
 epoch          : 41
 loss           : 0.9128578026294708
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.102
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 48.16481968841301
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4925
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.71187204148495
 mnt_best       : 48.32704899136895
 not_improved_count: 12
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 0.76933 batch_time=32.51224 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 0.86679 batch_time=0.35350 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.10303 batch_time=0.40431 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.13026 batch_time=0.35508 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.02575 batch_time=0.37930 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 0.95038 batch_time=0.37520 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 0.90223 batch_time=0.35284 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 0.99810 batch_time=0.42814 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.75734 batch_time=0.41812 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.16182 batch_time=0.36698 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.04023 batch_time=0.36607 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.17684 batch_time=0.39671 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 0.89272 batch_time=0.35759 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.61979 batch_time=0.35718 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 0.99358 batch_time=0.36776 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 0.82647 batch_time=0.39363 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 0.75276 batch_time=0.34916 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.86088 batch_time=0.35315 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.78423 batch_time=2.97801 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 0.75789 batch_time=0.38193 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.05587 batch_time=0.34922 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 0.91536 batch_time=0.35651 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 0.98423 batch_time=0.37523 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch42.pth ...
Done in 4.909s
removing stale ckpt [epoch 41] [took 0.01s]
 epoch          : 42
 loss           : 0.9151093783378601
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.047
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.38732592119711
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3275
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.94767703768758
 mnt_best       : 48.32704899136895
 not_improved_count: 13
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 0.93340 batch_time=34.07980 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.25823 batch_time=0.36097 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 0.93957 batch_time=0.39593 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 0.92953 batch_time=0.39901 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 0.72255 batch_time=0.38226 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.00878 batch_time=0.37586 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 0.94935 batch_time=0.50906 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.01022 batch_time=0.36720 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.74349 batch_time=0.38185 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 0.92289 batch_time=0.42415 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 0.97271 batch_time=0.35554 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 0.97158 batch_time=0.40279 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.01971 batch_time=0.39488 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 0.84370 batch_time=0.34811 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 0.91071 batch_time=0.35275 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.02901 batch_time=0.38959 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.68998 batch_time=0.35859 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 0.98124 batch_time=0.35889 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 0.90890 batch_time=6.78963 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 0.91455 batch_time=0.35514 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 0.65732 batch_time=0.38650 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.68505 batch_time=0.36181 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 0.55293 batch_time=0.39713 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch43.pth ...
Done in 4.228s
removing stale ckpt [epoch 42] [took 0.03s]
 epoch          : 43
 loss           : 0.9258556048870087
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.64
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.12438067419865
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1305
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.983037409119504
 mnt_best       : 48.32704899136895
 not_improved_count: 14
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.82553 batch_time=40.85442 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 0.71386 batch_time=1.92434 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 0.63233 batch_time=0.36687 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.86545 batch_time=0.36044 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 0.83028 batch_time=0.37451 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 0.86166 batch_time=0.36217 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.04312 batch_time=1.60276 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 0.90633 batch_time=0.40039 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 0.78935 batch_time=0.36062 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 0.96629 batch_time=0.39683 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.00645 batch_time=0.39675 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 0.75609 batch_time=0.37831 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 0.75941 batch_time=0.43806 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.01734 batch_time=0.36521 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 0.89828 batch_time=0.36622 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.05238 batch_time=0.35562 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.13887 batch_time=0.37991 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 0.76644 batch_time=0.35182 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 0.81505 batch_time=0.43248 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 0.90596 batch_time=0.42538 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 0.74316 batch_time=0.36196 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 0.85101 batch_time=0.35569 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 0.83579 batch_time=0.35283 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch44.pth ...
Done in 5.024s
removing stale ckpt [epoch 43] [took 0.01s]
 epoch          : 44
 loss           : 0.8892813377380371
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.852
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.30909243892213
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.229
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.78547981287167
 mnt_best       : 48.32704899136895
 not_improved_count: 15
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.08079 batch_time=34.81148 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 0.85541 batch_time=0.35987 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.74616 batch_time=0.38520 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.04609 batch_time=0.36869 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.14571 batch_time=0.39099 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.28833 batch_time=0.36034 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.81851 batch_time=0.47610 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 0.87592 batch_time=4.62711 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 0.76733 batch_time=0.35553 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 0.92695 batch_time=0.37931 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.95156 batch_time=0.47963 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.15964 batch_time=0.37779 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.90815 batch_time=0.36224 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.25577 batch_time=0.37098 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 0.91918 batch_time=0.35429 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 0.81502 batch_time=0.35443 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 0.84850 batch_time=0.35529 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 0.61052 batch_time=0.36332 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.84060 batch_time=0.66446 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.81249 batch_time=0.35563 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 0.84823 batch_time=0.37241 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.71085 batch_time=0.38486 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 0.76437 batch_time=0.38259 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch45.pth ...
Done in 4.129s
removing stale ckpt [epoch 44] [took 0.01s]
 epoch          : 45
 loss           : 0.8889075317382813
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.161
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.90130066217419
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4785
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.62659470101665
 mnt_best       : 48.32704899136895
 not_improved_count: 16
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.82503 batch_time=31.96550 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 0.77941 batch_time=0.35888 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 0.71691 batch_time=0.35928 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 0.67175 batch_time=0.49388 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.10913 batch_time=0.35870 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.04162 batch_time=0.38175 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.55060 batch_time=0.38784 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 0.77455 batch_time=0.39298 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.87976 batch_time=0.35358 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 1.29716 batch_time=0.35062 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.07458 batch_time=0.36186 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 0.91164 batch_time=0.37582 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.05754 batch_time=5.39342 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 0.97651 batch_time=0.36174 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 0.90505 batch_time=0.35393 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 0.60719 batch_time=0.34636 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 0.63559 batch_time=0.43890 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.01889 batch_time=0.63387 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.73631 batch_time=0.36207 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 0.78485 batch_time=0.37144 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 0.74826 batch_time=0.34770 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.19108 batch_time=0.35416 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 0.84828 batch_time=0.34935 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch46.pth ...
Done in 5.516s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 0.8831466436386108
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.199
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 48.15982603146102
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 72.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.056
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 49.0440032321234
 mnt_best       : 48.32704899136895
 not_improved_count: 17
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 0.86861 batch_time=30.92960 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 0.94993 batch_time=0.38569 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 0.73552 batch_time=0.39079 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 0.84210 batch_time=0.36371 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 0.86885 batch_time=0.37758 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.50488 batch_time=0.35486 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 0.73347 batch_time=0.37419 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 0.72489 batch_time=0.36465 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 0.81239 batch_time=0.38773 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.79557 batch_time=0.36372 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 0.82776 batch_time=0.44424 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.80542 batch_time=0.36333 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 0.78842 batch_time=1.47839 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.84184 batch_time=2.41565 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 0.58379 batch_time=0.40902 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.78635 batch_time=0.35608 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 0.92191 batch_time=0.61871 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 0.61153 batch_time=0.37109 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 0.79021 batch_time=0.45471 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 0.83485 batch_time=0.84735 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.70100 batch_time=0.36048 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 0.82729 batch_time=0.35250 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 0.88308 batch_time=0.35941 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch47.pth ...
Done in 4.965s
removing stale ckpt [epoch 46] [took 0.01s]
 epoch          : 47
 loss           : 0.8634291559457778
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 70.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.767
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.26690573910014
 MSRVTT_jsfusion_test/v2t_metrics/R1: 27.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.7095
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 48.81879203249527
 mnt_best       : 48.32704899136895
 not_improved_count: 18
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 0.82323 batch_time=32.57372 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 0.94880 batch_time=0.36715 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 0.69431 batch_time=0.37254 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 0.60806 batch_time=0.36822 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 0.78652 batch_time=0.35581 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 0.92336 batch_time=0.35406 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 0.89060 batch_time=0.36564 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.28905 batch_time=0.35125 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 0.96278 batch_time=0.36929 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.08294 batch_time=0.70811 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 0.80230 batch_time=0.37039 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 0.85773 batch_time=0.35483 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 0.91443 batch_time=1.49255 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 0.77455 batch_time=0.40728 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 0.77863 batch_time=0.36893 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 0.90606 batch_time=0.36275 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.70946 batch_time=0.38746 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.20105 batch_time=0.35622 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 0.97968 batch_time=0.36588 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.06907 batch_time=0.35904 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 0.84949 batch_time=0.39130 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 0.76085 batch_time=0.35133 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 0.59692 batch_time=0.37043 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch48.pth ...
Done in 10.540s
removing stale ckpt [epoch 47] [took 0.45s]
 epoch          : 48
 loss           : 0.859372962474823
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 58.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.648
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.813337547804274
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.786
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 49.03192449659329
 mnt_best       : 48.32704899136895
 not_improved_count: 19
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 0.79425 batch_time=39.17783 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.12928 batch_time=0.38445 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 0.99688 batch_time=0.36636 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 0.88101 batch_time=0.36044 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 0.87645 batch_time=0.35938 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.17698 batch_time=0.37828 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.02420 batch_time=0.36611 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.86052 batch_time=0.35361 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 1.12009 batch_time=0.40788 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 0.88222 batch_time=0.36709 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 0.82313 batch_time=0.38485 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.93329 batch_time=0.47136 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 0.86790 batch_time=0.36373 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 0.94592 batch_time=0.42430 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 0.79086 batch_time=0.35347 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.80388 batch_time=0.36739 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.62480 batch_time=0.34965 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 0.95691 batch_time=0.60360 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 0.80274 batch_time=0.37715 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 0.81927 batch_time=0.35941 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.09742 batch_time=0.40997 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.86526 batch_time=0.37845 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 0.61575 batch_time=0.36850 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch49.pth ...
Done in 4.991s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 0.8734674022197724
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.41
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.97768059558469
 MSRVTT_jsfusion_test/v2t_metrics/R1: 29.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 58.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.702
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 49.67689955264717
 mnt_best       : 48.32704899136895
 not_improved_count: 20
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 0.92816 batch_time=32.20272 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 0.92708 batch_time=0.35903 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.03558 batch_time=0.34833 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 0.79943 batch_time=0.37423 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 0.88590 batch_time=0.36123 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 0.74221 batch_time=0.36758 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 0.91711 batch_time=0.38838 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 0.77684 batch_time=0.41291 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.94303 batch_time=0.36559 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 0.79388 batch_time=0.35993 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.98107 batch_time=0.40054 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 0.82894 batch_time=0.41574 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 0.89487 batch_time=0.40775 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 0.78988 batch_time=0.41503 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 0.77469 batch_time=0.42426 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.98012 batch_time=0.35352 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 0.81981 batch_time=0.34911 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 0.76457 batch_time=0.39958 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.17624 batch_time=0.35620 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.68339 batch_time=0.36429 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.06176 batch_time=0.37453 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.12319 batch_time=0.39454 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 0.60728 batch_time=0.35523 
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/checkpoint-epoch50.pth ...
Done in 4.858s
removing stale ckpt [epoch 49] [took 0.15s]
 epoch          : 50
 loss           : 0.8651452951431274
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 27.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 57.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.21
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 47.730731880390216
 MSRVTT_jsfusion_test/v2t_metrics/R1: 28.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 71.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2365
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 49.16706158960131
 mnt_best       : 48.32704899136895
 not_improved_count: 21
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/trained_model.pth ...
Ckpt loaded at epoch 29.
Saved v2t similarity matrix to /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/MSRVTT-test-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 27.8
 t2v_metrics/R5/final_eval: 58.0
 t2v_metrics/R10/final_eval: 70.0
 t2v_metrics/R50/final_eval: 89.5
 t2v_metrics/MedR/final_eval: 4.0
 t2v_metrics/MeanR/final_eval: 26.789
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 48.32704899136895
 v2t_metrics/R1/final_eval: 27.3
 v2t_metrics/R5/final_eval: 57.8
 v2t_metrics/R10/final_eval: 72.1
 v2t_metrics/R50/final_eval: 90.6
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 24.3765
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 48.45537028807405
Best epoch for the monitored metric: 29
Script took 03h10m16s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCT_MSRVTT_1kA/trained_model.pth
