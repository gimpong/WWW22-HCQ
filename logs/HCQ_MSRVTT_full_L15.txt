Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 719.9239161014557 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 32.56615161895752 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 194.66587805747986 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 199.53826427459717 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch0.pth ...
Done in 2.687s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch0.pth ...
Done in 4.246s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.2012072434607646
 MSRVTT_full_val/t2v_metrics/R5: 0.4024144869215292
 MSRVTT_full_val/t2v_metrics/R10: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R50: 8.853118712273641
 MSRVTT_full_val/t2v_metrics/MedR: 260.0
 MSRVTT_full_val/t2v_metrics/MeanR: 249.96378269617705
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.4606495945888659
 MSRVTT_full_val/v2t_metrics/R1: 0.0
 MSRVTT_full_val/v2t_metrics/R5: 1.0060362173038229
 MSRVTT_full_val/v2t_metrics/R10: 2.0120724346076457
 MSRVTT_full_val/v2t_metrics/R50: 9.054325955734406
 MSRVTT_full_val/v2t_metrics/MedR: 257.0
 MSRVTT_full_val/v2t_metrics/MeanR: 252.0
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/t2v_metrics/R1: 0.06688963210702341
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.33444816053511706
 MSRVTT_full_test/t2v_metrics/R50: 1.7725752508361203
 MSRVTT_full_test/t2v_metrics/MedR: 1512.5
 MSRVTT_full_test/t2v_metrics/MeanR: 1502.0033444816054
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.16496401834986424
 MSRVTT_full_test/v2t_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/v2t_metrics/R5: 0.10033444816053512
 MSRVTT_full_test/v2t_metrics/R10: 0.36789297658862874
 MSRVTT_full_test/v2t_metrics/R50: 1.705685618729097
 MSRVTT_full_test/v2t_metrics/MedR: 1513.0
 MSRVTT_full_test/v2t_metrics/MeanR: 1505.0903010033444
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.10727539565203431
 mnt_best       : 0.16496401834986424
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 30.22406 (QuantReg: 22.46453) QuantErr: 22.46453 batch_time=31.83892 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 28.18055 (QuantReg: 22.51739) QuantErr: 22.51739 batch_time=0.67098 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 24.85711 (QuantReg: 22.60228) QuantErr: 22.60228 batch_time=0.65935 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 21.45746 (QuantReg: 22.65877) QuantErr: 22.65877 batch_time=0.65819 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 20.20119 (QuantReg: 22.57300) QuantErr: 22.57300 batch_time=0.65108 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 20.04578 (QuantReg: 22.61002) QuantErr: 22.61002 batch_time=0.64761 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 18.42118 (QuantReg: 22.65223) QuantErr: 22.65223 batch_time=0.65893 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 18.37778 (QuantReg: 22.64981) QuantErr: 22.64981 batch_time=0.67034 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 16.41802 (QuantReg: 22.67469) QuantErr: 22.67469 batch_time=2.39628 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 16.64783 (QuantReg: 22.63917) QuantErr: 22.63917 batch_time=0.65906 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 15.58957 (QuantReg: 22.63890) QuantErr: 22.63890 batch_time=0.66841 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 15.78522 (QuantReg: 22.65351) QuantErr: 22.65351 batch_time=0.67178 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 15.07550 (QuantReg: 22.63795) QuantErr: 22.63795 batch_time=0.69992 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 15.11686 (QuantReg: 22.66456) QuantErr: 22.66456 batch_time=0.65482 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 14.13446 (QuantReg: 22.66284) QuantErr: 22.66284 batch_time=0.65740 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 14.48722 (QuantReg: 22.66940) QuantErr: 22.66940 batch_time=0.68683 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 13.65892 (QuantReg: 22.64358) QuantErr: 22.64358 batch_time=0.87520 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 15.07883 (QuantReg: 22.64701) QuantErr: 22.64701 batch_time=0.65935 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 14.02477 (QuantReg: 22.63174) QuantErr: 22.63174 batch_time=0.64918 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 13.02130 (QuantReg: 22.67042) QuantErr: 22.67042 batch_time=0.66426 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 12.47948 (QuantReg: 22.67752) QuantErr: 22.67752 batch_time=0.67565 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 13.83792 (QuantReg: 22.66639) QuantErr: 22.66639 batch_time=0.73079 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 13.17884 (QuantReg: 22.65432) QuantErr: 22.65432 batch_time=0.66894 
Train Epoch: 1 codebook_update_time=5.18685
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch1.pth ...
Done in 21.582s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch1.pth ...
Done in 25.774s
 epoch          : 1
 loss           : 16.959559432983397
 quant_reg      : 22.636399383544923
 quant_err      : 22.636399383544923
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 16.901408450704224
 MSRVTT_full_val/t2v_metrics/R5: 47.08249496981891
 MSRVTT_full_val/t2v_metrics/R10: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R50: 94.56740442655935
 MSRVTT_full_val/t2v_metrics/MedR: 6.0
 MSRVTT_full_val/t2v_metrics/MeanR: 14.404426559356137
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 37.33387875646294
 MSRVTT_full_val/v2t_metrics/R1: 20.523138832997986
 MSRVTT_full_val/v2t_metrics/R5: 54.72837022132797
 MSRVTT_full_val/v2t_metrics/R10: 70.4225352112676
 MSRVTT_full_val/v2t_metrics/R50: 94.16498993963782
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 13.044265593561368
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 42.92622042356838
 MSRVTT_full_test/t2v_metrics/R1: 5.451505016722408
 MSRVTT_full_test/t2v_metrics/R5: 17.725752508361204
 MSRVTT_full_test/t2v_metrics/R10: 28.127090301003346
 MSRVTT_full_test/t2v_metrics/R50: 63.91304347826087
 MSRVTT_full_test/t2v_metrics/MedR: 27.0
 MSRVTT_full_test/t2v_metrics/MeanR: 81.25919732441471
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 13.955603916488062
 MSRVTT_full_test/v2t_metrics/R1: 6.321070234113712
 MSRVTT_full_test/v2t_metrics/R5: 22.441471571906355
 MSRVTT_full_test/v2t_metrics/R10: 33.27759197324415
 MSRVTT_full_test/v2t_metrics/R50: 68.56187290969899
 MSRVTT_full_test/v2t_metrics/MedR: 23.0
 MSRVTT_full_test/v2t_metrics/MeanR: 70.45351170568561
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 16.775080516987856
 mnt_best       : 13.955603916488062
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 11.69033 (QuantReg: 10.99460) QuantErr: 10.99460 batch_time=34.86775 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 11.85889 (QuantReg: 11.64627) QuantErr: 11.64627 batch_time=0.65523 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 13.62033 (QuantReg: 11.66126) QuantErr: 11.66126 batch_time=1.55495 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 12.58152 (QuantReg: 11.67921) QuantErr: 11.67921 batch_time=0.73321 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 11.39927 (QuantReg: 12.24615) QuantErr: 12.24615 batch_time=0.66403 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 11.12123 (QuantReg: 11.90173) QuantErr: 11.90173 batch_time=0.66003 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 13.24261 (QuantReg: 12.25074) QuantErr: 12.25074 batch_time=0.65283 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 11.79319 (QuantReg: 12.23535) QuantErr: 12.23535 batch_time=0.69307 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 11.31834 (QuantReg: 12.55606) QuantErr: 12.55606 batch_time=0.64902 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 11.41414 (QuantReg: 12.80252) QuantErr: 12.80252 batch_time=0.65663 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 12.48219 (QuantReg: 13.20720) QuantErr: 13.20720 batch_time=0.66976 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 11.82295 (QuantReg: 12.89741) QuantErr: 12.89741 batch_time=0.66121 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 11.01320 (QuantReg: 13.04761) QuantErr: 13.04761 batch_time=0.65424 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 12.36839 (QuantReg: 13.53391) QuantErr: 13.53391 batch_time=0.64616 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 9.61655 (QuantReg: 13.33284) QuantErr: 13.33284 batch_time=0.64917 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 9.96245 (QuantReg: 13.76616) QuantErr: 13.76616 batch_time=0.64520 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 10.18381 (QuantReg: 13.62154) QuantErr: 13.62154 batch_time=0.67574 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 10.81396 (QuantReg: 13.83472) QuantErr: 13.83472 batch_time=0.67223 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 9.85376 (QuantReg: 14.23500) QuantErr: 14.23500 batch_time=0.65112 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 9.98802 (QuantReg: 13.97876) QuantErr: 13.97876 batch_time=0.66928 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 10.63222 (QuantReg: 14.10003) QuantErr: 14.10003 batch_time=1.53439 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 8.73113 (QuantReg: 14.01359) QuantErr: 14.01359 batch_time=0.84193 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 8.68554 (QuantReg: 14.41790) QuantErr: 14.41790 batch_time=0.67182 
Train Epoch: 2 codebook_update_time=3.82160
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch2.pth ...
Done in 4.817s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch2.pth ...
Done in 9.109s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 11.214131484985352
 quant_reg      : 13.067063232421875
 quant_err      : 13.067063232421875
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 22.132796780684103
 MSRVTT_full_val/t2v_metrics/R5: 56.74044265593562
 MSRVTT_full_val/t2v_metrics/R10: 72.03219315895372
 MSRVTT_full_val/t2v_metrics/R50: 96.579476861167
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 11.412474849094567
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 44.89023558968411
 MSRVTT_full_val/v2t_metrics/R1: 25.35211267605634
 MSRVTT_full_val/v2t_metrics/R5: 61.56941649899397
 MSRVTT_full_val/v2t_metrics/R10: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R50: 95.77464788732394
 MSRVTT_full_val/v2t_metrics/MedR: 4.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.800804828973844
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.36364189815923
 MSRVTT_full_test/t2v_metrics/R1: 6.956521739130435
 MSRVTT_full_test/t2v_metrics/R5: 23.47826086956522
 MSRVTT_full_test/t2v_metrics/R10: 35.21739130434783
 MSRVTT_full_test/t2v_metrics/R50: 70.46822742474916
 MSRVTT_full_test/t2v_metrics/MedR: 20.0
 MSRVTT_full_test/t2v_metrics/MeanR: 65.65886287625418
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 17.917266405182588
 MSRVTT_full_test/v2t_metrics/R1: 8.361204013377927
 MSRVTT_full_test/v2t_metrics/R5: 28.160535117056856
 MSRVTT_full_test/v2t_metrics/R10: 40.50167224080268
 MSRVTT_full_test/v2t_metrics/R50: 76.18729096989966
 MSRVTT_full_test/v2t_metrics/MedR: 16.0
 MSRVTT_full_test/v2t_metrics/MeanR: 51.804013377926424
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.20610428399126
 mnt_best       : 17.917266405182588
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 10.43762 (QuantReg: 11.08461) QuantErr: 11.08461 batch_time=35.15280 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 10.01959 (QuantReg: 11.41312) QuantErr: 11.41312 batch_time=0.65839 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 10.45292 (QuantReg: 11.39809) QuantErr: 11.39809 batch_time=0.65639 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 10.61764 (QuantReg: 11.40616) QuantErr: 11.40616 batch_time=0.72585 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 11.02250 (QuantReg: 11.30192) QuantErr: 11.30192 batch_time=0.67326 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 9.23523 (QuantReg: 11.64298) QuantErr: 11.64298 batch_time=0.64890 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 8.37086 (QuantReg: 11.67804) QuantErr: 11.67804 batch_time=2.89280 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 10.27629 (QuantReg: 11.67211) QuantErr: 11.67211 batch_time=0.65284 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 10.01065 (QuantReg: 11.81654) QuantErr: 11.81654 batch_time=0.64987 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 8.93736 (QuantReg: 11.98932) QuantErr: 11.98932 batch_time=1.06513 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 9.72359 (QuantReg: 12.13228) QuantErr: 12.13228 batch_time=0.66371 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 10.16076 (QuantReg: 12.22856) QuantErr: 12.22856 batch_time=1.19253 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 8.94362 (QuantReg: 12.10999) QuantErr: 12.10999 batch_time=0.65813 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 9.40571 (QuantReg: 12.35909) QuantErr: 12.35909 batch_time=0.64037 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 8.49874 (QuantReg: 12.49096) QuantErr: 12.49096 batch_time=0.69958 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 9.20203 (QuantReg: 12.41439) QuantErr: 12.41439 batch_time=0.68120 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 10.25584 (QuantReg: 12.16437) QuantErr: 12.16437 batch_time=0.67518 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 8.79304 (QuantReg: 12.54235) QuantErr: 12.54235 batch_time=1.01456 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 9.37960 (QuantReg: 12.47418) QuantErr: 12.47418 batch_time=0.65826 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 7.75955 (QuantReg: 12.63808) QuantErr: 12.63808 batch_time=0.68705 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 9.43395 (QuantReg: 12.63933) QuantErr: 12.63933 batch_time=0.65326 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 10.07651 (QuantReg: 12.62622) QuantErr: 12.62622 batch_time=0.75622 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 9.05775 (QuantReg: 12.75195) QuantErr: 12.75195 batch_time=0.67878 
Train Epoch: 3 codebook_update_time=4.17890
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch3.pth ...
Done in 5.374s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch3.pth ...
Done in 10.372s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 9.42644087600708
 quant_reg      : 12.124122676849366
 quant_err      : 12.124122676849366
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 59.15492957746479
 MSRVTT_full_val/t2v_metrics/R10: 73.64185110663983
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.750503018108652
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 47.72291664534341
 MSRVTT_full_val/v2t_metrics/R1: 29.37625754527163
 MSRVTT_full_val/v2t_metrics/R5: 65.99597585513078
 MSRVTT_full_val/v2t_metrics/R10: 79.07444668008048
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.59758551307847
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 53.52007268335295
 MSRVTT_full_test/t2v_metrics/R1: 7.892976588628763
 MSRVTT_full_test/t2v_metrics/R5: 25.51839464882943
 MSRVTT_full_test/t2v_metrics/R10: 37.792642140468224
 MSRVTT_full_test/t2v_metrics/R50: 72.3076923076923
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 58.28963210702341
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.671333734314143
 MSRVTT_full_test/v2t_metrics/R1: 10.0
 MSRVTT_full_test/v2t_metrics/R5: 30.702341137123746
 MSRVTT_full_test/v2t_metrics/R10: 44.247491638795985
 MSRVTT_full_test/v2t_metrics/R50: 78.92976588628763
 MSRVTT_full_test/v2t_metrics/MedR: 13.0
 MSRVTT_full_test/v2t_metrics/MeanR: 45.87056856187291
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.86089426511658
 mnt_best       : 19.671333734314143
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 9.19483 (QuantReg: 11.64003) QuantErr: 11.64003 batch_time=32.91900 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 8.07011 (QuantReg: 11.38294) QuantErr: 11.38294 batch_time=0.66270 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 7.67151 (QuantReg: 11.46375) QuantErr: 11.46375 batch_time=0.64377 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 9.08913 (QuantReg: 11.88083) QuantErr: 11.88083 batch_time=1.13230 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 7.42820 (QuantReg: 12.00424) QuantErr: 12.00424 batch_time=0.64167 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 7.98694 (QuantReg: 11.41479) QuantErr: 11.41479 batch_time=0.64453 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 7.68390 (QuantReg: 11.79613) QuantErr: 11.79613 batch_time=1.88194 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 8.34204 (QuantReg: 11.95331) QuantErr: 11.95331 batch_time=0.66247 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 8.84249 (QuantReg: 11.86487) QuantErr: 11.86487 batch_time=0.61741 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 9.03078 (QuantReg: 12.07779) QuantErr: 12.07779 batch_time=0.68197 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 10.24974 (QuantReg: 11.85093) QuantErr: 11.85093 batch_time=0.65487 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 8.21029 (QuantReg: 12.23484) QuantErr: 12.23484 batch_time=0.67059 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 7.32377 (QuantReg: 12.26030) QuantErr: 12.26030 batch_time=0.70837 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 8.92410 (QuantReg: 12.03196) QuantErr: 12.03196 batch_time=0.65322 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 7.14796 (QuantReg: 12.06317) QuantErr: 12.06317 batch_time=1.26609 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 8.44700 (QuantReg: 11.89851) QuantErr: 11.89851 batch_time=0.64840 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 7.71095 (QuantReg: 12.01020) QuantErr: 12.01020 batch_time=0.65549 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 8.09692 (QuantReg: 11.96916) QuantErr: 11.96916 batch_time=0.66282 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 9.47150 (QuantReg: 12.34290) QuantErr: 12.34290 batch_time=0.66291 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 7.03797 (QuantReg: 12.27872) QuantErr: 12.27872 batch_time=0.65353 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 7.58328 (QuantReg: 12.32439) QuantErr: 12.32439 batch_time=0.71068 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 8.30504 (QuantReg: 12.40103) QuantErr: 12.40103 batch_time=0.65319 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 7.48157 (QuantReg: 12.36613) QuantErr: 12.36613 batch_time=0.96807 
Train Epoch: 4 codebook_update_time=5.04089
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch4.pth ...
Done in 6.518s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch4.pth ...
Done in 12.022s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 8.289624794006347
 quant_reg      : 12.05293967819214
 quant_err      : 12.05293967819214
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 25.75452716297787
 MSRVTT_full_val/t2v_metrics/R5: 60.36217303822938
 MSRVTT_full_val/t2v_metrics/R10: 74.64788732394366
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.07645875251509
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.77665222144213
 MSRVTT_full_val/v2t_metrics/R1: 29.37625754527163
 MSRVTT_full_val/v2t_metrics/R5: 67.40442655935614
 MSRVTT_full_val/v2t_metrics/R10: 80.0804828973843
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.464788732394366
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 54.125741148157985
 MSRVTT_full_test/t2v_metrics/R1: 8.695652173913043
 MSRVTT_full_test/t2v_metrics/R5: 27.45819397993311
 MSRVTT_full_test/t2v_metrics/R10: 39.86622073578595
 MSRVTT_full_test/t2v_metrics/R50: 75.15050167224081
 MSRVTT_full_test/t2v_metrics/MedR: 17.0
 MSRVTT_full_test/t2v_metrics/MeanR: 52.65317725752509
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.19303059904077
 MSRVTT_full_test/v2t_metrics/R1: 10.702341137123746
 MSRVTT_full_test/v2t_metrics/R5: 32.240802675585286
 MSRVTT_full_test/v2t_metrics/R10: 46.68896321070234
 MSRVTT_full_test/v2t_metrics/R50: 80.60200668896321
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 42.2133779264214
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.256100003600007
 mnt_best       : 21.19303059904077
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 6.98592 (QuantReg: 12.17013) QuantErr: 12.17013 batch_time=36.67542 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 7.90343 (QuantReg: 12.08517) QuantErr: 12.08517 batch_time=0.66514 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 9.75839 (QuantReg: 11.71979) QuantErr: 11.71979 batch_time=0.64681 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 7.87336 (QuantReg: 11.59543) QuantErr: 11.59543 batch_time=0.64972 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 8.43007 (QuantReg: 12.06126) QuantErr: 12.06126 batch_time=0.73738 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 7.80469 (QuantReg: 11.78869) QuantErr: 11.78869 batch_time=0.67294 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 8.42627 (QuantReg: 11.96771) QuantErr: 11.96771 batch_time=0.65069 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 9.29566 (QuantReg: 12.09125) QuantErr: 12.09125 batch_time=0.66588 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 7.09722 (QuantReg: 12.19587) QuantErr: 12.19587 batch_time=0.64686 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 6.75599 (QuantReg: 12.18743) QuantErr: 12.18743 batch_time=0.73865 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 8.32687 (QuantReg: 12.05125) QuantErr: 12.05125 batch_time=0.64892 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 8.88459 (QuantReg: 11.98284) QuantErr: 11.98284 batch_time=0.65486 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 8.04697 (QuantReg: 12.34089) QuantErr: 12.34089 batch_time=4.93766 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 6.89594 (QuantReg: 12.48104) QuantErr: 12.48104 batch_time=3.48781 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 9.09505 (QuantReg: 12.10082) QuantErr: 12.10082 batch_time=0.64724 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 8.66294 (QuantReg: 12.08711) QuantErr: 12.08711 batch_time=0.64547 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 6.95216 (QuantReg: 12.19081) QuantErr: 12.19081 batch_time=0.64489 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 6.68034 (QuantReg: 12.27691) QuantErr: 12.27691 batch_time=0.64885 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 5.86392 (QuantReg: 12.50078) QuantErr: 12.50078 batch_time=0.66081 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 7.68140 (QuantReg: 12.56306) QuantErr: 12.56306 batch_time=0.65973 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 8.05901 (QuantReg: 12.34086) QuantErr: 12.34086 batch_time=0.64501 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 7.02866 (QuantReg: 11.95921) QuantErr: 11.95921 batch_time=0.71595 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 5.89627 (QuantReg: 12.44866) QuantErr: 12.44866 batch_time=0.66184 
Train Epoch: 5 codebook_update_time=3.89533
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch5.pth ...
Done in 5.776s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch5.pth ...
Done in 30.299s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 7.60461877822876
 quant_reg      : 12.108809020996095
 quant_err      : 12.108809020996095
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 27.56539235412475
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 77.46478873239437
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.458752515090543
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.879824365318235
 MSRVTT_full_val/v2t_metrics/R1: 33.601609657947684
 MSRVTT_full_val/v2t_metrics/R5: 72.23340040241449
 MSRVTT_full_val/v2t_metrics/R10: 84.10462776659959
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.472837022132797
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.880661223017945
 MSRVTT_full_test/t2v_metrics/R1: 10.568561872909699
 MSRVTT_full_test/t2v_metrics/R5: 31.37123745819398
 MSRVTT_full_test/t2v_metrics/R10: 44.381270903010034
 MSRVTT_full_test/t2v_metrics/R50: 78.29431438127091
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.51939799331104
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.504683239397316
 MSRVTT_full_test/v2t_metrics/R1: 12.709030100334449
 MSRVTT_full_test/v2t_metrics/R5: 36.92307692307692
 MSRVTT_full_test/v2t_metrics/R10: 51.103678929765884
 MSRVTT_full_test/v2t_metrics/R50: 83.04347826086956
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.57625418060201
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.837270623538416
 mnt_best       : 24.504683239397316
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 6.93695 (QuantReg: 12.08805) QuantErr: 12.08805 batch_time=37.10896 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 7.02010 (QuantReg: 12.22331) QuantErr: 12.22331 batch_time=0.68092 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 7.53520 (QuantReg: 12.28310) QuantErr: 12.28310 batch_time=0.65096 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 5.86789 (QuantReg: 12.45268) QuantErr: 12.45268 batch_time=0.66786 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 7.08267 (QuantReg: 11.94166) QuantErr: 11.94166 batch_time=0.65822 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 6.47857 (QuantReg: 12.33970) QuantErr: 12.33970 batch_time=0.65750 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 6.87050 (QuantReg: 12.30424) QuantErr: 12.30424 batch_time=0.65187 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 5.81473 (QuantReg: 11.92217) QuantErr: 11.92217 batch_time=0.70262 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 6.50766 (QuantReg: 12.19209) QuantErr: 12.19209 batch_time=0.65424 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 6.60541 (QuantReg: 11.80881) QuantErr: 11.80881 batch_time=0.65060 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 7.11903 (QuantReg: 11.97234) QuantErr: 11.97234 batch_time=0.67715 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 7.13247 (QuantReg: 11.78378) QuantErr: 11.78378 batch_time=0.71996 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 7.08436 (QuantReg: 12.02715) QuantErr: 12.02715 batch_time=0.64679 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 6.21363 (QuantReg: 11.89062) QuantErr: 11.89062 batch_time=0.66136 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 6.18275 (QuantReg: 12.14766) QuantErr: 12.14766 batch_time=0.67409 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 6.75239 (QuantReg: 12.13513) QuantErr: 12.13513 batch_time=0.66497 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 6.05737 (QuantReg: 12.51633) QuantErr: 12.51633 batch_time=0.64119 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 6.21368 (QuantReg: 12.48586) QuantErr: 12.48586 batch_time=0.65940 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 6.33040 (QuantReg: 12.55907) QuantErr: 12.55907 batch_time=3.05250 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 7.66629 (QuantReg: 12.03336) QuantErr: 12.03336 batch_time=0.71499 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 5.59387 (QuantReg: 12.80289) QuantErr: 12.80289 batch_time=0.73301 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 6.55969 (QuantReg: 12.25301) QuantErr: 12.25301 batch_time=0.66572 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 6.65024 (QuantReg: 12.39625) QuantErr: 12.39625 batch_time=0.66395 
Train Epoch: 6 codebook_update_time=3.64385
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch6.pth ...
Done in 21.407s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 6.88165478515625
 quant_reg      : 12.258991916656495
 quant_err      : 12.258991916656495
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 29.77867203219316
 MSRVTT_full_val/t2v_metrics/R5: 64.58752515090544
 MSRVTT_full_val/t2v_metrics/R10: 76.45875251509054
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.85513078470825
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.78295815670375
 MSRVTT_full_val/v2t_metrics/R1: 33.40040241448692
 MSRVTT_full_val/v2t_metrics/R5: 71.22736418511066
 MSRVTT_full_val/v2t_metrics/R10: 84.10462776659959
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.189134808853119
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.48881491345232
 MSRVTT_full_test/t2v_metrics/R1: 9.799331103678929
 MSRVTT_full_test/t2v_metrics/R5: 29.06354515050167
 MSRVTT_full_test/t2v_metrics/R10: 42.207357859531776
 MSRVTT_full_test/t2v_metrics/R50: 76.45484949832776
 MSRVTT_full_test/t2v_metrics/MedR: 15.0
 MSRVTT_full_test/t2v_metrics/MeanR: 49.764715719063545
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.90750177626291
 MSRVTT_full_test/v2t_metrics/R1: 11.77257525083612
 MSRVTT_full_test/v2t_metrics/R5: 34.98327759197324
 MSRVTT_full_test/v2t_metrics/R10: 49.264214046822744
 MSRVTT_full_test/v2t_metrics/R50: 82.8428093645485
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 36.667056856187294
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.274356320670837
 mnt_best       : 24.504683239397316
 not_improved_count: 1
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 6.90019 (QuantReg: 11.88745) QuantErr: 11.88745 batch_time=36.74015 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 5.34315 (QuantReg: 12.12065) QuantErr: 12.12065 batch_time=0.65876 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 5.87720 (QuantReg: 12.15375) QuantErr: 12.15375 batch_time=0.64566 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 6.45516 (QuantReg: 12.26369) QuantErr: 12.26369 batch_time=0.64755 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 6.32988 (QuantReg: 12.28052) QuantErr: 12.28052 batch_time=0.68293 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 6.08345 (QuantReg: 12.31438) QuantErr: 12.31438 batch_time=0.66170 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 7.59598 (QuantReg: 11.97076) QuantErr: 11.97076 batch_time=0.90312 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 4.75267 (QuantReg: 12.18462) QuantErr: 12.18462 batch_time=0.72538 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 7.62264 (QuantReg: 12.43488) QuantErr: 12.43488 batch_time=0.71428 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 5.94939 (QuantReg: 12.37844) QuantErr: 12.37844 batch_time=0.66703 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 7.50563 (QuantReg: 12.41978) QuantErr: 12.41978 batch_time=0.64542 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 6.95159 (QuantReg: 12.46640) QuantErr: 12.46640 batch_time=0.63442 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 6.30190 (QuantReg: 12.43758) QuantErr: 12.43758 batch_time=0.70348 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 5.79864 (QuantReg: 12.51967) QuantErr: 12.51967 batch_time=0.67746 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 7.29400 (QuantReg: 11.91293) QuantErr: 11.91293 batch_time=0.65352 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 5.84851 (QuantReg: 12.18345) QuantErr: 12.18345 batch_time=0.67630 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 6.87969 (QuantReg: 12.70492) QuantErr: 12.70492 batch_time=0.68062 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 6.51617 (QuantReg: 12.50688) QuantErr: 12.50688 batch_time=0.67021 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 7.81855 (QuantReg: 12.39478) QuantErr: 12.39478 batch_time=0.66281 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 7.09069 (QuantReg: 12.40698) QuantErr: 12.40698 batch_time=0.67302 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 6.76995 (QuantReg: 12.57722) QuantErr: 12.57722 batch_time=0.69040 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 4.98156 (QuantReg: 12.63820) QuantErr: 12.63820 batch_time=0.66635 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 7.54990 (QuantReg: 12.69033) QuantErr: 12.69033 batch_time=0.67086 
Train Epoch: 7 codebook_update_time=4.46556
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch7.pth ...
Done in 7.134s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch7.pth ...
Done in 13.017s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 6.354806377410888
 quant_reg      : 12.34421549987793
 quant_err      : 12.34421549987793
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 29.175050301810867
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 77.66599597585513
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.020120724346077
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.55976718309932
 MSRVTT_full_val/v2t_metrics/R1: 31.58953722334004
 MSRVTT_full_val/v2t_metrics/R5: 70.82494969818913
 MSRVTT_full_val/v2t_metrics/R10: 84.90945674044265
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.440643863179075
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 57.48597039407435
 MSRVTT_full_test/t2v_metrics/R1: 11.137123745819398
 MSRVTT_full_test/t2v_metrics/R5: 32.207357859531776
 MSRVTT_full_test/t2v_metrics/R10: 46.220735785953174
 MSRVTT_full_test/t2v_metrics/R50: 80.60200668896321
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.26387959866221
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.498912944767554
 MSRVTT_full_test/v2t_metrics/R1: 12.37458193979933
 MSRVTT_full_test/v2t_metrics/R5: 36.95652173913044
 MSRVTT_full_test/v2t_metrics/R10: 51.33779264214047
 MSRVTT_full_test/v2t_metrics/R50: 84.24749163879599
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 35.010535117056854
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.634280324481992
 mnt_best       : 25.498912944767554
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 6.59379 (QuantReg: 12.09336) QuantErr: 12.09336 batch_time=38.95687 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 6.29193 (QuantReg: 12.20411) QuantErr: 12.20411 batch_time=0.68181 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 5.30420 (QuantReg: 12.49452) QuantErr: 12.49452 batch_time=0.65198 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 5.45353 (QuantReg: 11.96650) QuantErr: 11.96650 batch_time=0.68906 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 5.75841 (QuantReg: 12.26715) QuantErr: 12.26715 batch_time=0.66784 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 6.86543 (QuantReg: 12.23590) QuantErr: 12.23590 batch_time=0.68995 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 6.17583 (QuantReg: 12.30212) QuantErr: 12.30212 batch_time=1.11508 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 5.98143 (QuantReg: 12.60720) QuantErr: 12.60720 batch_time=0.66211 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 5.80875 (QuantReg: 12.44730) QuantErr: 12.44730 batch_time=0.65373 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 4.26558 (QuantReg: 12.34812) QuantErr: 12.34812 batch_time=0.66042 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 7.47528 (QuantReg: 12.34738) QuantErr: 12.34738 batch_time=0.65394 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 7.43379 (QuantReg: 12.41968) QuantErr: 12.41968 batch_time=0.66121 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 6.07026 (QuantReg: 12.50053) QuantErr: 12.50053 batch_time=0.65252 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 6.66241 (QuantReg: 12.40073) QuantErr: 12.40073 batch_time=0.64694 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 7.06434 (QuantReg: 12.53465) QuantErr: 12.53465 batch_time=0.67033 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 5.77747 (QuantReg: 12.62553) QuantErr: 12.62553 batch_time=0.66321 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 6.22566 (QuantReg: 12.37666) QuantErr: 12.37666 batch_time=0.79232 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 6.24723 (QuantReg: 12.35840) QuantErr: 12.35840 batch_time=0.66038 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 5.75154 (QuantReg: 12.82601) QuantErr: 12.82601 batch_time=1.30781 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 5.53132 (QuantReg: 12.67509) QuantErr: 12.67509 batch_time=0.80446 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 5.80165 (QuantReg: 12.48300) QuantErr: 12.48300 batch_time=0.64967 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 5.53930 (QuantReg: 12.73578) QuantErr: 12.73578 batch_time=0.65748 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 4.67160 (QuantReg: 12.39731) QuantErr: 12.39731 batch_time=0.66231 
Train Epoch: 8 codebook_update_time=3.80874
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch8.pth ...
Done in 12.636s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch8.pth ...
Done in 17.230s
removing stale ckpt [epoch 7] [took 0.14s]
 epoch          : 8
 loss           : 6.01211333656311
 quant_reg      : 12.428482440948486
 quant_err      : 12.428482440948486
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.893360160965795
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.84855678540881
 MSRVTT_full_val/v2t_metrics/R1: 35.2112676056338
 MSRVTT_full_val/v2t_metrics/R5: 72.83702213279678
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.392354124748491
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.6345836682103
 MSRVTT_full_test/t2v_metrics/R1: 11.438127090301004
 MSRVTT_full_test/t2v_metrics/R5: 34.11371237458194
 MSRVTT_full_test/t2v_metrics/R10: 47.525083612040135
 MSRVTT_full_test/t2v_metrics/R50: 80.2675585284281
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.92073578595318
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.46888194432237
 MSRVTT_full_test/v2t_metrics/R1: 13.177257525083611
 MSRVTT_full_test/v2t_metrics/R5: 38.99665551839465
 MSRVTT_full_test/v2t_metrics/R10: 53.979933110367895
 MSRVTT_full_test/v2t_metrics/R50: 84.51505016722408
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.73879598662207
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.27110300589757
 mnt_best       : 26.46888194432237
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 5.90718 (QuantReg: 12.56265) QuantErr: 12.56265 batch_time=35.52193 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 6.39916 (QuantReg: 12.51087) QuantErr: 12.51087 batch_time=0.70911 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 6.67739 (QuantReg: 12.56993) QuantErr: 12.56993 batch_time=0.70431 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 5.32266 (QuantReg: 12.71124) QuantErr: 12.71124 batch_time=0.68807 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 4.74409 (QuantReg: 12.57355) QuantErr: 12.57355 batch_time=0.94710 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 7.06995 (QuantReg: 12.70261) QuantErr: 12.70261 batch_time=0.66474 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 4.64696 (QuantReg: 12.60329) QuantErr: 12.60329 batch_time=2.33781 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 6.18899 (QuantReg: 12.51410) QuantErr: 12.51410 batch_time=0.67700 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 5.83601 (QuantReg: 12.53768) QuantErr: 12.53768 batch_time=0.64786 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 5.87233 (QuantReg: 12.62067) QuantErr: 12.62067 batch_time=0.66894 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 6.07590 (QuantReg: 12.19263) QuantErr: 12.19263 batch_time=0.66226 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 5.06074 (QuantReg: 12.67200) QuantErr: 12.67200 batch_time=0.66727 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 6.19927 (QuantReg: 12.72467) QuantErr: 12.72467 batch_time=0.65515 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 5.03000 (QuantReg: 12.74304) QuantErr: 12.74304 batch_time=1.74089 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 5.26810 (QuantReg: 12.61468) QuantErr: 12.61468 batch_time=0.66324 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 5.09084 (QuantReg: 12.56045) QuantErr: 12.56045 batch_time=0.66029 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 5.51254 (QuantReg: 12.94240) QuantErr: 12.94240 batch_time=0.78421 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 5.00432 (QuantReg: 12.76025) QuantErr: 12.76025 batch_time=0.67578 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 6.26070 (QuantReg: 12.10260) QuantErr: 12.10260 batch_time=0.65403 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 5.07520 (QuantReg: 12.64127) QuantErr: 12.64127 batch_time=0.95354 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 5.19661 (QuantReg: 12.72699) QuantErr: 12.72699 batch_time=0.68230 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 5.84787 (QuantReg: 12.74856) QuantErr: 12.74856 batch_time=0.66007 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 6.00022 (QuantReg: 12.70980) QuantErr: 12.70980 batch_time=0.84835 
Train Epoch: 9 codebook_update_time=3.61515
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch9.pth ...
Done in 4.122s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 5.571092814445495
 quant_reg      : 12.526452926635741
 quant_err      : 12.526452926635741
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 67.00201207243461
 MSRVTT_full_val/t2v_metrics/R10: 78.26961770623743
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.120724346076459
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.804525546395446
 MSRVTT_full_val/v2t_metrics/R1: 36.61971830985915
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.484909456740443
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.94517401252433
 MSRVTT_full_test/t2v_metrics/R1: 10.836120401337793
 MSRVTT_full_test/t2v_metrics/R5: 33.91304347826087
 MSRVTT_full_test/t2v_metrics/R10: 47.725752508361204
 MSRVTT_full_test/t2v_metrics/R50: 80.03344481605352
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.66321070234114
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.98151418019949
 MSRVTT_full_test/v2t_metrics/R1: 14.11371237458194
 MSRVTT_full_test/v2t_metrics/R5: 39.59866220735786
 MSRVTT_full_test/v2t_metrics/R10: 54.8494983277592
 MSRVTT_full_test/v2t_metrics/R50: 85.81939799331104
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.9257525083612
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.296671072207424
 mnt_best       : 26.46888194432237
 not_improved_count: 1
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 7.16021 (QuantReg: 12.28944) QuantErr: 12.28944 batch_time=34.16766 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 6.64067 (QuantReg: 12.38687) QuantErr: 12.38687 batch_time=0.65212 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 5.57212 (QuantReg: 12.08895) QuantErr: 12.08895 batch_time=0.64006 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 5.34287 (QuantReg: 12.60885) QuantErr: 12.60885 batch_time=0.66651 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 4.29839 (QuantReg: 12.38473) QuantErr: 12.38473 batch_time=0.64721 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 4.42987 (QuantReg: 12.46323) QuantErr: 12.46323 batch_time=0.71444 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 5.37227 (QuantReg: 12.48413) QuantErr: 12.48413 batch_time=0.65784 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 4.29616 (QuantReg: 12.37182) QuantErr: 12.37182 batch_time=0.65851 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 5.60082 (QuantReg: 12.79851) QuantErr: 12.79851 batch_time=0.64949 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 5.19975 (QuantReg: 12.46279) QuantErr: 12.46279 batch_time=0.67065 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 7.90143 (QuantReg: 12.37281) QuantErr: 12.37281 batch_time=0.67739 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 6.40589 (QuantReg: 12.34039) QuantErr: 12.34039 batch_time=0.63900 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 5.92442 (QuantReg: 12.41160) QuantErr: 12.41160 batch_time=0.65910 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 4.15519 (QuantReg: 12.78792) QuantErr: 12.78792 batch_time=0.68972 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 5.10535 (QuantReg: 12.78312) QuantErr: 12.78312 batch_time=0.65792 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 5.11178 (QuantReg: 12.47515) QuantErr: 12.47515 batch_time=0.65438 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 4.59982 (QuantReg: 12.33244) QuantErr: 12.33244 batch_time=0.65080 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 4.52139 (QuantReg: 12.30775) QuantErr: 12.30775 batch_time=0.65159 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 4.80490 (QuantReg: 12.37235) QuantErr: 12.37235 batch_time=0.69156 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 5.12978 (QuantReg: 13.08595) QuantErr: 13.08595 batch_time=0.67401 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 6.30447 (QuantReg: 12.32524) QuantErr: 12.32524 batch_time=0.64624 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 4.62406 (QuantReg: 12.56967) QuantErr: 12.56967 batch_time=0.65204 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 4.41183 (QuantReg: 12.64544) QuantErr: 12.64544 batch_time=0.65943 
Train Epoch: 10 codebook_update_time=3.75590
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch10.pth ...
Done in 4.039s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 5.257122255325317
 quant_reg      : 12.523717567443848
 quant_err      : 12.523717567443848
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.523138832997988
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.77478007626008
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 73.44064386317908
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.358148893360161
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.517000760737176
 MSRVTT_full_test/t2v_metrics/R1: 11.070234113712374
 MSRVTT_full_test/t2v_metrics/R5: 32.94314381270903
 MSRVTT_full_test/t2v_metrics/R10: 46.220735785953174
 MSRVTT_full_test/t2v_metrics/R50: 80.03344481605352
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.044147157190636
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.640091308727506
 MSRVTT_full_test/v2t_metrics/R1: 13.91304347826087
 MSRVTT_full_test/v2t_metrics/R5: 38.39464882943144
 MSRVTT_full_test/v2t_metrics/R10: 54.247491638795985
 MSRVTT_full_test/v2t_metrics/R50: 84.78260869565217
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.0371237458194
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.715493765803043
 mnt_best       : 26.46888194432237
 not_improved_count: 2
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 3.98264 (QuantReg: 12.33634) QuantErr: 12.33634 batch_time=33.40487 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 5.90357 (QuantReg: 12.87723) QuantErr: 12.87723 batch_time=0.65754 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 6.18482 (QuantReg: 11.99457) QuantErr: 11.99457 batch_time=0.68016 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 4.52961 (QuantReg: 12.84622) QuantErr: 12.84622 batch_time=0.66834 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 7.07877 (QuantReg: 12.34781) QuantErr: 12.34781 batch_time=0.65771 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 5.10946 (QuantReg: 12.58791) QuantErr: 12.58791 batch_time=0.65983 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 5.17622 (QuantReg: 12.46057) QuantErr: 12.46057 batch_time=0.71077 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 5.55323 (QuantReg: 12.18427) QuantErr: 12.18427 batch_time=0.63997 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 5.77301 (QuantReg: 12.63644) QuantErr: 12.63644 batch_time=0.67643 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 4.67010 (QuantReg: 12.92912) QuantErr: 12.92912 batch_time=0.70634 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 5.03835 (QuantReg: 12.34464) QuantErr: 12.34464 batch_time=0.73569 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 5.38710 (QuantReg: 12.55240) QuantErr: 12.55240 batch_time=0.64212 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 4.95132 (QuantReg: 12.65883) QuantErr: 12.65883 batch_time=0.72425 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 7.32768 (QuantReg: 12.64789) QuantErr: 12.64789 batch_time=0.67859 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 5.40028 (QuantReg: 12.27488) QuantErr: 12.27488 batch_time=0.71721 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 5.05215 (QuantReg: 12.42103) QuantErr: 12.42103 batch_time=0.64785 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 4.66182 (QuantReg: 12.79947) QuantErr: 12.79947 batch_time=0.63629 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 5.00033 (QuantReg: 12.44386) QuantErr: 12.44386 batch_time=0.68110 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 5.24351 (QuantReg: 12.50256) QuantErr: 12.50256 batch_time=0.65595 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 4.24048 (QuantReg: 12.71098) QuantErr: 12.71098 batch_time=2.94689 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 5.59818 (QuantReg: 12.61190) QuantErr: 12.61190 batch_time=0.64552 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 4.02276 (QuantReg: 12.76032) QuantErr: 12.76032 batch_time=0.65108 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 4.09940 (QuantReg: 12.66693) QuantErr: 12.66693 batch_time=0.65194 
Train Epoch: 11 codebook_update_time=3.45925
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch11.pth ...
Done in 9.485s
removing stale ckpt [epoch 10] [took 0.01s]
 epoch          : 11
 loss           : 5.097822701454162
 quant_reg      : 12.599963302612304
 quant_err      : 12.599963302612304
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.861167002012072
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.197310982539044
 MSRVTT_full_val/v2t_metrics/R1: 35.412474849094565
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.44466800804829
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.902143876767774
 MSRVTT_full_test/t2v_metrics/R1: 11.270903010033445
 MSRVTT_full_test/t2v_metrics/R5: 33.94648829431438
 MSRVTT_full_test/t2v_metrics/R10: 47.15719063545151
 MSRVTT_full_test/t2v_metrics/R50: 80.13377926421404
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.25752508361204
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.228120096594573
 MSRVTT_full_test/v2t_metrics/R1: 14.247491638795987
 MSRVTT_full_test/v2t_metrics/R5: 39.89966555183946
 MSRVTT_full_test/v2t_metrics/R10: 54.414715719063544
 MSRVTT_full_test/v2t_metrics/R50: 85.9866220735786
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.54013377926421
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.39120667399078
 mnt_best       : 26.46888194432237
 not_improved_count: 3
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 4.35738 (QuantReg: 12.93200) QuantErr: 12.93200 batch_time=35.14712 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 3.87667 (QuantReg: 12.88986) QuantErr: 12.88986 batch_time=1.16860 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 4.07923 (QuantReg: 12.68835) QuantErr: 12.68835 batch_time=0.66551 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 6.29497 (QuantReg: 12.61306) QuantErr: 12.61306 batch_time=0.67107 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 4.76223 (QuantReg: 12.39881) QuantErr: 12.39881 batch_time=0.65459 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 6.31555 (QuantReg: 12.69371) QuantErr: 12.69371 batch_time=0.66098 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 6.29505 (QuantReg: 12.59874) QuantErr: 12.59874 batch_time=0.65424 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 4.79445 (QuantReg: 12.49307) QuantErr: 12.49307 batch_time=0.66477 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 5.50983 (QuantReg: 12.52477) QuantErr: 12.52477 batch_time=0.66593 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 5.73387 (QuantReg: 12.64420) QuantErr: 12.64420 batch_time=0.65717 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 5.43734 (QuantReg: 12.51141) QuantErr: 12.51141 batch_time=0.73005 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 5.31474 (QuantReg: 12.19806) QuantErr: 12.19806 batch_time=0.67475 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 4.56275 (QuantReg: 12.48438) QuantErr: 12.48438 batch_time=2.84971 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 5.14506 (QuantReg: 12.72722) QuantErr: 12.72722 batch_time=0.70012 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 5.10805 (QuantReg: 12.95004) QuantErr: 12.95004 batch_time=0.65640 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 4.44867 (QuantReg: 12.76476) QuantErr: 12.76476 batch_time=0.63852 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 4.99650 (QuantReg: 12.73656) QuantErr: 12.73656 batch_time=0.64355 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 5.25477 (QuantReg: 12.57556) QuantErr: 12.57556 batch_time=0.63929 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 4.86784 (QuantReg: 12.55995) QuantErr: 12.55995 batch_time=0.66997 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 4.69216 (QuantReg: 12.65412) QuantErr: 12.65412 batch_time=0.67783 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 4.51802 (QuantReg: 12.63733) QuantErr: 12.63733 batch_time=0.66058 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 5.70962 (QuantReg: 12.52655) QuantErr: 12.52655 batch_time=0.64508 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 4.22965 (QuantReg: 12.62915) QuantErr: 12.62915 batch_time=0.64849 
Train Epoch: 12 codebook_update_time=3.72672
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch12.pth ...
Done in 15.629s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch12.pth ...
Done in 19.741s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 4.820311190605164
 quant_reg      : 12.6691937789917
 quant_err      : 12.6691937789917
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.989939637826962
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.968953046528554
 MSRVTT_full_val/v2t_metrics/R1: 33.40040241448692
 MSRVTT_full_val/v2t_metrics/R5: 72.63581488933602
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.100603621730382
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.56776972992103
 MSRVTT_full_test/t2v_metrics/R1: 11.839464882943144
 MSRVTT_full_test/t2v_metrics/R5: 34.91638795986622
 MSRVTT_full_test/t2v_metrics/R10: 48.79598662207358
 MSRVTT_full_test/t2v_metrics/R50: 80.50167224080268
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.753846153846155
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.221694926384952
 MSRVTT_full_test/v2t_metrics/R1: 14.448160535117056
 MSRVTT_full_test/v2t_metrics/R5: 40.668896321070235
 MSRVTT_full_test/v2t_metrics/R10: 55.65217391304348
 MSRVTT_full_test/v2t_metrics/R50: 86.45484949832776
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.037123745819397
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.978078152960645
 mnt_best       : 27.221694926384952
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 5.76813 (QuantReg: 12.69024) QuantErr: 12.69024 batch_time=32.57215 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 4.00674 (QuantReg: 12.60750) QuantErr: 12.60750 batch_time=0.64901 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 4.88706 (QuantReg: 12.41300) QuantErr: 12.41300 batch_time=0.66577 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 5.54092 (QuantReg: 12.40975) QuantErr: 12.40975 batch_time=0.66328 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 3.77787 (QuantReg: 12.51169) QuantErr: 12.51169 batch_time=0.72981 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 6.42746 (QuantReg: 12.22791) QuantErr: 12.22791 batch_time=0.66197 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 4.69343 (QuantReg: 12.71428) QuantErr: 12.71428 batch_time=1.14612 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 4.47018 (QuantReg: 12.49517) QuantErr: 12.49517 batch_time=0.64024 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 4.60867 (QuantReg: 12.67342) QuantErr: 12.67342 batch_time=0.64309 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 4.47449 (QuantReg: 12.84652) QuantErr: 12.84652 batch_time=0.65013 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 3.87998 (QuantReg: 13.03908) QuantErr: 13.03908 batch_time=0.66482 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 5.52034 (QuantReg: 13.06094) QuantErr: 13.06094 batch_time=0.66862 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 4.65533 (QuantReg: 12.69566) QuantErr: 12.69566 batch_time=0.63961 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 4.82085 (QuantReg: 12.52406) QuantErr: 12.52406 batch_time=0.66676 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 5.56571 (QuantReg: 12.88251) QuantErr: 12.88251 batch_time=0.69176 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 4.54747 (QuantReg: 12.45250) QuantErr: 12.45250 batch_time=0.65288 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 4.24719 (QuantReg: 13.08645) QuantErr: 13.08645 batch_time=0.65868 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 4.63648 (QuantReg: 12.44086) QuantErr: 12.44086 batch_time=0.64845 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 5.84295 (QuantReg: 12.75785) QuantErr: 12.75785 batch_time=0.65004 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 4.51115 (QuantReg: 12.62789) QuantErr: 12.62789 batch_time=0.67945 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 4.98097 (QuantReg: 13.01386) QuantErr: 13.01386 batch_time=0.64337 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 3.93708 (QuantReg: 12.96794) QuantErr: 12.96794 batch_time=0.64514 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 4.25523 (QuantReg: 12.95286) QuantErr: 12.95286 batch_time=0.68837 
Train Epoch: 13 codebook_update_time=3.44183
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch13.pth ...
Done in 4.149s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 4.643458377838135
 quant_reg      : 12.721188537597657
 quant_err      : 12.721188537597657
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 29.979879275653925
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.006036217303823
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.557368014109436
 MSRVTT_full_val/v2t_metrics/R1: 35.2112676056338
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.128772635814889
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.78510671008183
 MSRVTT_full_test/t2v_metrics/R1: 11.638795986622073
 MSRVTT_full_test/t2v_metrics/R5: 35.08361204013378
 MSRVTT_full_test/t2v_metrics/R10: 48.02675585284281
 MSRVTT_full_test/t2v_metrics/R50: 80.2675585284281
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.6314381270903
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.966952428554176
 MSRVTT_full_test/v2t_metrics/R1: 15.284280936454849
 MSRVTT_full_test/v2t_metrics/R5: 41.67224080267559
 MSRVTT_full_test/v2t_metrics/R10: 56.25418060200669
 MSRVTT_full_test/v2t_metrics/R50: 86.5886287625418
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.526421404682274
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.96721215635933
 mnt_best       : 27.221694926384952
 not_improved_count: 1
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 4.11215 (QuantReg: 12.61652) QuantErr: 12.61652 batch_time=37.71633 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 4.34097 (QuantReg: 12.58669) QuantErr: 12.58669 batch_time=0.65256 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 4.75905 (QuantReg: 12.30185) QuantErr: 12.30185 batch_time=0.64982 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 4.07784 (QuantReg: 12.64100) QuantErr: 12.64100 batch_time=0.64537 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 4.10984 (QuantReg: 12.61882) QuantErr: 12.61882 batch_time=0.77364 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 4.57853 (QuantReg: 12.71968) QuantErr: 12.71968 batch_time=0.65305 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 4.18081 (QuantReg: 12.75585) QuantErr: 12.75585 batch_time=0.66899 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 4.70702 (QuantReg: 12.73335) QuantErr: 12.73335 batch_time=0.65160 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 5.16447 (QuantReg: 12.61242) QuantErr: 12.61242 batch_time=0.76162 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 4.20237 (QuantReg: 12.93852) QuantErr: 12.93852 batch_time=1.19513 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 4.52975 (QuantReg: 12.65513) QuantErr: 12.65513 batch_time=0.66206 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 4.13596 (QuantReg: 12.79441) QuantErr: 12.79441 batch_time=0.67810 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 4.12073 (QuantReg: 12.53889) QuantErr: 12.53889 batch_time=0.68882 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 3.44840 (QuantReg: 12.69290) QuantErr: 12.69290 batch_time=0.64679 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 4.61153 (QuantReg: 12.91985) QuantErr: 12.91985 batch_time=0.66005 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 3.71267 (QuantReg: 12.86851) QuantErr: 12.86851 batch_time=0.75004 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 4.34525 (QuantReg: 12.91361) QuantErr: 12.91361 batch_time=0.66717 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 3.73887 (QuantReg: 13.09082) QuantErr: 13.09082 batch_time=0.66379 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 5.86465 (QuantReg: 12.47352) QuantErr: 12.47352 batch_time=0.65231 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 3.48795 (QuantReg: 12.82178) QuantErr: 12.82178 batch_time=0.66736 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 4.28815 (QuantReg: 13.13678) QuantErr: 13.13678 batch_time=0.64656 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 3.84465 (QuantReg: 12.83103) QuantErr: 12.83103 batch_time=0.66150 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 4.26599 (QuantReg: 12.89506) QuantErr: 12.89506 batch_time=0.67513 
Train Epoch: 14 codebook_update_time=3.51894
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch14.pth ...
Done in 4.366s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 4.420340289115906
 quant_reg      : 12.773668334960938
 quant_err      : 12.773668334960938
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.925553319919517
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.58672680646643
 MSRVTT_full_val/v2t_metrics/R1: 38.6317907444668
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.160965794768612
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.01072635828423
 MSRVTT_full_test/t2v_metrics/R1: 11.638795986622073
 MSRVTT_full_test/t2v_metrics/R5: 34.31438127090301
 MSRVTT_full_test/t2v_metrics/R10: 48.26086956521739
 MSRVTT_full_test/t2v_metrics/R50: 79.76588628762542
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.82775919732441
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.811829991027306
 MSRVTT_full_test/v2t_metrics/R1: 14.481605351170568
 MSRVTT_full_test/v2t_metrics/R5: 39.83277591973244
 MSRVTT_full_test/v2t_metrics/R10: 55.48494983277592
 MSRVTT_full_test/v2t_metrics/R50: 85.81939799331104
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.427090301003346
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.750031436137288
 mnt_best       : 27.221694926384952
 not_improved_count: 2
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 3.36498 (QuantReg: 13.00903) QuantErr: 13.00903 batch_time=37.60110 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 4.45029 (QuantReg: 12.53061) QuantErr: 12.53061 batch_time=0.63972 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 4.55981 (QuantReg: 12.61777) QuantErr: 12.61777 batch_time=0.66503 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 4.33157 (QuantReg: 12.52645) QuantErr: 12.52645 batch_time=0.66580 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 4.34146 (QuantReg: 12.50065) QuantErr: 12.50065 batch_time=0.67164 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 3.74199 (QuantReg: 12.90717) QuantErr: 12.90717 batch_time=0.65620 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 4.56977 (QuantReg: 12.77883) QuantErr: 12.77883 batch_time=0.67040 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 3.72148 (QuantReg: 12.93677) QuantErr: 12.93677 batch_time=0.64286 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 3.76211 (QuantReg: 12.81335) QuantErr: 12.81335 batch_time=0.63683 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 4.25202 (QuantReg: 12.99773) QuantErr: 12.99773 batch_time=0.66885 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 3.58056 (QuantReg: 13.04730) QuantErr: 13.04730 batch_time=0.66784 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 3.78501 (QuantReg: 12.87010) QuantErr: 12.87010 batch_time=0.66210 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 5.15882 (QuantReg: 12.65645) QuantErr: 12.65645 batch_time=0.64441 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 3.99746 (QuantReg: 12.67653) QuantErr: 12.67653 batch_time=0.66837 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 4.78631 (QuantReg: 12.73375) QuantErr: 12.73375 batch_time=0.69579 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 3.38799 (QuantReg: 12.86488) QuantErr: 12.86488 batch_time=0.66333 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 4.74216 (QuantReg: 12.95142) QuantErr: 12.95142 batch_time=0.66245 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 4.73442 (QuantReg: 12.86222) QuantErr: 12.86222 batch_time=0.83615 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 5.15327 (QuantReg: 12.78578) QuantErr: 12.78578 batch_time=0.85552 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 4.37167 (QuantReg: 13.08946) QuantErr: 13.08946 batch_time=0.65214 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 3.28407 (QuantReg: 13.00840) QuantErr: 13.00840 batch_time=0.67470 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 4.46280 (QuantReg: 12.94159) QuantErr: 12.94159 batch_time=0.64916 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 4.19433 (QuantReg: 12.90249) QuantErr: 12.90249 batch_time=0.67511 
Train Epoch: 15 codebook_update_time=3.52327
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch15.pth ...
Done in 4.242s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 4.283002407073974
 quant_reg      : 12.797748889923096
 quant_err      : 12.797748889923096
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 80.28169014084507
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.651911468812877
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.214795819595814
 MSRVTT_full_val/v2t_metrics/R1: 35.814889336016094
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.770623742454728
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.29718779708805
 MSRVTT_full_test/t2v_metrics/R1: 11.939799331103679
 MSRVTT_full_test/t2v_metrics/R5: 34.046822742474916
 MSRVTT_full_test/t2v_metrics/R10: 48.36120401337793
 MSRVTT_full_test/t2v_metrics/R50: 80.10033444816054
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.593311036789295
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.98921423653621
 MSRVTT_full_test/v2t_metrics/R1: 13.7123745819398
 MSRVTT_full_test/v2t_metrics/R5: 39.4314381270903
 MSRVTT_full_test/v2t_metrics/R10: 55.25083612040134
 MSRVTT_full_test/v2t_metrics/R50: 85.48494983277592
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.931103678929766
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.02878093536512
 mnt_best       : 27.221694926384952
 not_improved_count: 3
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 5.00132 (QuantReg: 12.57807) QuantErr: 12.57807 batch_time=36.68589 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 3.31885 (QuantReg: 12.66751) QuantErr: 12.66751 batch_time=0.71040 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 4.09524 (QuantReg: 12.75918) QuantErr: 12.75918 batch_time=0.65672 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 4.92449 (QuantReg: 12.90380) QuantErr: 12.90380 batch_time=0.69536 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 4.14734 (QuantReg: 12.80866) QuantErr: 12.80866 batch_time=0.66119 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 4.23102 (QuantReg: 12.74104) QuantErr: 12.74104 batch_time=0.69758 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 3.92947 (QuantReg: 12.49037) QuantErr: 12.49037 batch_time=0.66315 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 3.69031 (QuantReg: 12.99262) QuantErr: 12.99262 batch_time=0.65963 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 3.61360 (QuantReg: 12.77281) QuantErr: 12.77281 batch_time=0.65184 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 4.03914 (QuantReg: 12.75846) QuantErr: 12.75846 batch_time=0.67149 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 3.30042 (QuantReg: 12.85579) QuantErr: 12.85579 batch_time=0.68882 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 3.56600 (QuantReg: 12.85134) QuantErr: 12.85134 batch_time=0.64952 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 4.26214 (QuantReg: 12.72429) QuantErr: 12.72429 batch_time=0.66280 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 3.99917 (QuantReg: 12.78483) QuantErr: 12.78483 batch_time=0.68361 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 4.75966 (QuantReg: 12.76422) QuantErr: 12.76422 batch_time=0.66186 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 3.65756 (QuantReg: 13.02518) QuantErr: 13.02518 batch_time=0.66451 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 4.00708 (QuantReg: 12.83405) QuantErr: 12.83405 batch_time=0.73312 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 3.61351 (QuantReg: 12.96544) QuantErr: 12.96544 batch_time=0.65808 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 3.79989 (QuantReg: 12.72466) QuantErr: 12.72466 batch_time=0.95633 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 4.09731 (QuantReg: 13.03822) QuantErr: 13.03822 batch_time=0.69104 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 3.90880 (QuantReg: 12.73082) QuantErr: 12.73082 batch_time=0.64801 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 4.60487 (QuantReg: 12.64195) QuantErr: 12.64195 batch_time=0.63905 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 4.28879 (QuantReg: 12.95665) QuantErr: 12.95665 batch_time=0.66301 
Train Epoch: 16 codebook_update_time=3.50893
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch16.pth ...
Done in 4.736s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch16.pth ...
Done in 9.296s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 4.157512748718262
 quant_reg      : 12.826395557403565
 quant_err      : 12.826395557403565
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 30.18108651911469
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.73440643863179
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.29926949830392
 MSRVTT_full_val/v2t_metrics/R1: 36.82092555331992
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.877263581488934
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.53471155241614
 MSRVTT_full_test/t2v_metrics/R1: 11.872909698996656
 MSRVTT_full_test/t2v_metrics/R5: 35.48494983277592
 MSRVTT_full_test/t2v_metrics/R10: 49.56521739130435
 MSRVTT_full_test/t2v_metrics/R50: 81.23745819397993
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.42173913043478
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.537602406371178
 MSRVTT_full_test/v2t_metrics/R1: 14.448160535117056
 MSRVTT_full_test/v2t_metrics/R5: 41.53846153846154
 MSRVTT_full_test/v2t_metrics/R10: 55.919732441471574
 MSRVTT_full_test/v2t_metrics/R50: 86.35451505016722
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.55284280936455
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.25591383192644
 mnt_best       : 27.537602406371178
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 3.12799 (QuantReg: 13.09767) QuantErr: 13.09767 batch_time=31.02728 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 3.58721 (QuantReg: 12.80173) QuantErr: 12.80173 batch_time=0.74467 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 4.79251 (QuantReg: 12.85333) QuantErr: 12.85333 batch_time=0.68056 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 3.84261 (QuantReg: 13.03004) QuantErr: 13.03004 batch_time=0.70584 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 3.55585 (QuantReg: 12.83900) QuantErr: 12.83900 batch_time=0.65918 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 3.35201 (QuantReg: 13.11759) QuantErr: 13.11759 batch_time=0.66084 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 4.32557 (QuantReg: 12.68365) QuantErr: 12.68365 batch_time=3.99646 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 3.77656 (QuantReg: 12.82995) QuantErr: 12.82995 batch_time=0.72231 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 4.39870 (QuantReg: 12.78573) QuantErr: 12.78573 batch_time=0.65194 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 5.39047 (QuantReg: 12.94296) QuantErr: 12.94296 batch_time=0.65676 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 3.66952 (QuantReg: 12.92081) QuantErr: 12.92081 batch_time=0.67042 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 5.22233 (QuantReg: 12.38774) QuantErr: 12.38774 batch_time=0.72657 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 4.14284 (QuantReg: 12.73292) QuantErr: 12.73292 batch_time=1.39424 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 3.22380 (QuantReg: 13.15531) QuantErr: 13.15531 batch_time=0.66261 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 3.88823 (QuantReg: 12.86822) QuantErr: 12.86822 batch_time=0.66395 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 3.61881 (QuantReg: 12.79761) QuantErr: 12.79761 batch_time=0.66957 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 3.75514 (QuantReg: 12.97452) QuantErr: 12.97452 batch_time=0.65170 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 4.66403 (QuantReg: 13.12005) QuantErr: 13.12005 batch_time=0.64923 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 4.31667 (QuantReg: 12.83448) QuantErr: 12.83448 batch_time=0.65987 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 3.88656 (QuantReg: 13.07221) QuantErr: 13.07221 batch_time=0.66080 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 3.34711 (QuantReg: 12.99372) QuantErr: 12.99372 batch_time=0.66059 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 3.82104 (QuantReg: 12.96443) QuantErr: 12.96443 batch_time=0.65944 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 3.71775 (QuantReg: 12.97037) QuantErr: 12.97037 batch_time=0.74986 
Train Epoch: 17 codebook_update_time=3.41708
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch17.pth ...
Done in 14.485s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch17.pth ...
Done in 19.291s
removing stale ckpt [epoch 16] [took 0.06s]
 epoch          : 17
 loss           : 4.093192211151123
 quant_reg      : 12.85997857284546
 quant_err      : 12.85997857284546
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 68.81287726358148
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.020120724346077
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.576715614445696
 MSRVTT_full_val/v2t_metrics/R1: 36.82092555331992
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.3843058350100605
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.57534523472261
 MSRVTT_full_test/t2v_metrics/R1: 11.906354515050166
 MSRVTT_full_test/t2v_metrics/R5: 35.68561872909699
 MSRVTT_full_test/t2v_metrics/R10: 49.63210702341137
 MSRVTT_full_test/t2v_metrics/R50: 80.90301003344482
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.42909698996655
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.627711850773345
 MSRVTT_full_test/v2t_metrics/R1: 15.384615384615385
 MSRVTT_full_test/v2t_metrics/R5: 41.77257525083612
 MSRVTT_full_test/v2t_metrics/R10: 56.68896321070234
 MSRVTT_full_test/v2t_metrics/R50: 86.5551839464883
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.847658862876255
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.150656689636264
 mnt_best       : 27.627711850773345
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 5.08716 (QuantReg: 12.91859) QuantErr: 12.91859 batch_time=33.64714 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 3.29053 (QuantReg: 12.90911) QuantErr: 12.90911 batch_time=0.64713 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 3.57428 (QuantReg: 12.79348) QuantErr: 12.79348 batch_time=0.64862 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 5.42980 (QuantReg: 12.59118) QuantErr: 12.59118 batch_time=0.70640 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 4.44676 (QuantReg: 12.93547) QuantErr: 12.93547 batch_time=0.65602 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 4.43675 (QuantReg: 12.71373) QuantErr: 12.71373 batch_time=0.67399 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 3.90424 (QuantReg: 12.83362) QuantErr: 12.83362 batch_time=0.64294 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 4.02251 (QuantReg: 12.67597) QuantErr: 12.67597 batch_time=0.66735 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 4.00172 (QuantReg: 12.62065) QuantErr: 12.62065 batch_time=0.67084 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 3.70868 (QuantReg: 13.11220) QuantErr: 13.11220 batch_time=0.68272 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 4.21967 (QuantReg: 12.72572) QuantErr: 12.72572 batch_time=0.67159 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 3.82080 (QuantReg: 12.79361) QuantErr: 12.79361 batch_time=0.72299 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 3.86011 (QuantReg: 12.99674) QuantErr: 12.99674 batch_time=0.71721 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 3.32580 (QuantReg: 12.84287) QuantErr: 12.84287 batch_time=2.54893 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 3.19338 (QuantReg: 13.09579) QuantErr: 13.09579 batch_time=0.65434 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 3.92913 (QuantReg: 12.70612) QuantErr: 12.70612 batch_time=0.68367 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 3.49673 (QuantReg: 13.02593) QuantErr: 13.02593 batch_time=0.91065 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 4.58593 (QuantReg: 13.17542) QuantErr: 13.17542 batch_time=0.80902 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 4.61345 (QuantReg: 12.76489) QuantErr: 12.76489 batch_time=2.14367 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 3.71027 (QuantReg: 13.17206) QuantErr: 13.17206 batch_time=0.65045 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 3.70484 (QuantReg: 12.99503) QuantErr: 12.99503 batch_time=0.65483 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 3.78792 (QuantReg: 12.78885) QuantErr: 12.78885 batch_time=0.65576 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 4.51261 (QuantReg: 12.88878) QuantErr: 12.88878 batch_time=0.66449 
Train Epoch: 18 codebook_update_time=3.69062
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch18.pth ...
Done in 4.340s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch18.pth ...
Done in 8.455s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 3.927380103111267
 quant_reg      : 12.919013732910157
 quant_err      : 12.919013732910157
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 30.784708249496983
 MSRVTT_full_val/t2v_metrics/R5: 68.2092555331992
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.100603621730382
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.102636987934
 MSRVTT_full_val/v2t_metrics/R1: 37.82696177062374
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.2152917505030185
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.82744430930031
 MSRVTT_full_test/t2v_metrics/R1: 12.307692307692308
 MSRVTT_full_test/t2v_metrics/R5: 35.35117056856188
 MSRVTT_full_test/t2v_metrics/R10: 49.83277591973244
 MSRVTT_full_test/t2v_metrics/R50: 81.40468227424749
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.572909698996654
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.884648207514843
 MSRVTT_full_test/v2t_metrics/R1: 14.782608695652174
 MSRVTT_full_test/v2t_metrics/R5: 42.10702341137124
 MSRVTT_full_test/v2t_metrics/R10: 56.45484949832776
 MSRVTT_full_test/v2t_metrics/R50: 86.75585284280936
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.39531772575251
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.75434800223528
 mnt_best       : 27.884648207514843
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 3.75206 (QuantReg: 12.97328) QuantErr: 12.97328 batch_time=33.85530 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 3.29350 (QuantReg: 13.23477) QuantErr: 13.23477 batch_time=0.66417 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 3.45600 (QuantReg: 12.91120) QuantErr: 12.91120 batch_time=2.62862 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 4.14246 (QuantReg: 12.59211) QuantErr: 12.59211 batch_time=0.64161 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 4.36877 (QuantReg: 12.79908) QuantErr: 12.79908 batch_time=0.68553 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 3.28958 (QuantReg: 12.97592) QuantErr: 12.97592 batch_time=0.68936 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 2.93702 (QuantReg: 12.56892) QuantErr: 12.56892 batch_time=0.65401 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 4.19882 (QuantReg: 12.90303) QuantErr: 12.90303 batch_time=0.65257 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 3.98388 (QuantReg: 13.10893) QuantErr: 13.10893 batch_time=2.69572 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 3.29057 (QuantReg: 12.95149) QuantErr: 12.95149 batch_time=0.66420 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 3.18408 (QuantReg: 13.01882) QuantErr: 13.01882 batch_time=0.65940 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 4.19817 (QuantReg: 13.18408) QuantErr: 13.18408 batch_time=0.66341 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 4.26097 (QuantReg: 13.24507) QuantErr: 13.24507 batch_time=0.64493 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 3.81987 (QuantReg: 13.13735) QuantErr: 13.13735 batch_time=0.68346 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 3.93160 (QuantReg: 13.15365) QuantErr: 13.15365 batch_time=0.66448 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 3.55299 (QuantReg: 13.15341) QuantErr: 13.15341 batch_time=0.66022 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 3.51645 (QuantReg: 12.90695) QuantErr: 12.90695 batch_time=0.64805 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 3.40931 (QuantReg: 13.20363) QuantErr: 13.20363 batch_time=0.65702 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 3.04208 (QuantReg: 13.44847) QuantErr: 13.44847 batch_time=0.67308 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 4.90957 (QuantReg: 13.10580) QuantErr: 13.10580 batch_time=0.66336 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 3.28021 (QuantReg: 13.08286) QuantErr: 13.08286 batch_time=0.65107 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 3.93654 (QuantReg: 13.07576) QuantErr: 13.07576 batch_time=0.67252 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 4.40548 (QuantReg: 13.20938) QuantErr: 13.20938 batch_time=0.72820 
Train Epoch: 19 codebook_update_time=3.68449
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch19.pth ...
Done in 9.271s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 3.8346514768600466
 quant_reg      : 12.951646423339843
 quant_err      : 12.951646423339843
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 67.20321931589537
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.235412474849095
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.636338229416715
 MSRVTT_full_val/v2t_metrics/R1: 37.625754527162975
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.2997987927565395
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.92402777312397
 MSRVTT_full_test/t2v_metrics/R1: 12.006688963210703
 MSRVTT_full_test/t2v_metrics/R5: 34.381270903010034
 MSRVTT_full_test/t2v_metrics/R10: 47.25752508361204
 MSRVTT_full_test/t2v_metrics/R50: 79.96655518394648
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.265551839464884
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.919813908681096
 MSRVTT_full_test/v2t_metrics/R1: 14.381270903010034
 MSRVTT_full_test/v2t_metrics/R5: 41.7056856187291
 MSRVTT_full_test/v2t_metrics/R10: 56.88963210702341
 MSRVTT_full_test/v2t_metrics/R50: 86.05351170568562
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.23361204013378
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.43460046357395
 mnt_best       : 27.884648207514843
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 4.57601 (QuantReg: 12.87939) QuantErr: 12.87939 batch_time=33.79941 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 3.90515 (QuantReg: 12.74789) QuantErr: 12.74789 batch_time=0.65942 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 3.60163 (QuantReg: 13.11542) QuantErr: 13.11542 batch_time=0.68052 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 3.66792 (QuantReg: 12.59033) QuantErr: 12.59033 batch_time=0.66225 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 2.97168 (QuantReg: 12.70502) QuantErr: 12.70502 batch_time=0.65306 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 3.28134 (QuantReg: 12.89265) QuantErr: 12.89265 batch_time=0.68615 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 4.64307 (QuantReg: 12.67793) QuantErr: 12.67793 batch_time=1.29145 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 3.61034 (QuantReg: 12.78122) QuantErr: 12.78122 batch_time=0.71737 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 4.03537 (QuantReg: 12.91193) QuantErr: 12.91193 batch_time=0.67281 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 3.46800 (QuantReg: 12.97497) QuantErr: 12.97497 batch_time=0.74668 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 4.70600 (QuantReg: 13.09864) QuantErr: 13.09864 batch_time=0.68587 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 3.73122 (QuantReg: 12.96574) QuantErr: 12.96574 batch_time=0.68198 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 3.53936 (QuantReg: 12.74229) QuantErr: 12.74229 batch_time=0.68932 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 4.27713 (QuantReg: 12.95906) QuantErr: 12.95906 batch_time=5.00024 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 3.68291 (QuantReg: 13.18811) QuantErr: 13.18811 batch_time=0.71591 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 5.08784 (QuantReg: 13.15257) QuantErr: 13.15257 batch_time=0.70144 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 4.96916 (QuantReg: 12.69156) QuantErr: 12.69156 batch_time=0.64528 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 3.69811 (QuantReg: 13.05669) QuantErr: 13.05669 batch_time=0.65173 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 3.13796 (QuantReg: 13.13817) QuantErr: 13.13817 batch_time=0.65130 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 3.05170 (QuantReg: 13.02913) QuantErr: 13.02913 batch_time=0.67836 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 3.53039 (QuantReg: 12.80799) QuantErr: 12.80799 batch_time=0.64868 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 2.72406 (QuantReg: 13.24144) QuantErr: 13.24144 batch_time=0.67835 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 3.78898 (QuantReg: 13.13872) QuantErr: 13.13872 batch_time=1.11256 
Train Epoch: 20 codebook_update_time=3.57012
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch20.pth ...
Done in 20.804s
removing stale ckpt [epoch 19] [took 0.07s]
 epoch          : 20
 loss           : 3.7058447551727296
 quant_reg      : 12.947567962646485
 quant_err      : 12.947567962646485
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 78.87323943661971
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.549295774647888
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.699016873754104
 MSRVTT_full_val/v2t_metrics/R1: 37.82696177062374
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 97.38430583501005
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.591549295774648
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.015431109019175
 MSRVTT_full_test/t2v_metrics/R1: 12.474916387959865
 MSRVTT_full_test/t2v_metrics/R5: 35.28428093645485
 MSRVTT_full_test/t2v_metrics/R10: 48.99665551839465
 MSRVTT_full_test/t2v_metrics/R50: 80.63545150501672
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.46755852842809
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.835249411149675
 MSRVTT_full_test/v2t_metrics/R1: 14.080267558528428
 MSRVTT_full_test/v2t_metrics/R5: 40.76923076923077
 MSRVTT_full_test/v2t_metrics/R10: 56.88963210702341
 MSRVTT_full_test/v2t_metrics/R50: 86.05351170568562
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.255183946488295
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.96383278431878
 mnt_best       : 27.884648207514843
 not_improved_count: 2
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 3.21737 (QuantReg: 12.94201) QuantErr: 12.94201 batch_time=36.37441 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 3.75135 (QuantReg: 13.05633) QuantErr: 13.05633 batch_time=0.65988 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 4.56917 (QuantReg: 13.22605) QuantErr: 13.22605 batch_time=0.65488 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 4.17506 (QuantReg: 13.23921) QuantErr: 13.23921 batch_time=0.65489 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 3.29026 (QuantReg: 12.96871) QuantErr: 12.96871 batch_time=0.65741 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 3.18365 (QuantReg: 13.19798) QuantErr: 13.19798 batch_time=0.64516 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 3.77146 (QuantReg: 13.02493) QuantErr: 13.02493 batch_time=0.69118 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 3.35418 (QuantReg: 12.81992) QuantErr: 12.81992 batch_time=0.66337 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 3.72153 (QuantReg: 13.00556) QuantErr: 13.00556 batch_time=0.65549 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 3.71546 (QuantReg: 13.10832) QuantErr: 13.10832 batch_time=0.65674 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 2.61895 (QuantReg: 13.12066) QuantErr: 13.12066 batch_time=0.65569 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 4.40495 (QuantReg: 12.92426) QuantErr: 12.92426 batch_time=0.64579 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 4.50147 (QuantReg: 12.96604) QuantErr: 12.96604 batch_time=0.82344 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 3.41622 (QuantReg: 12.78295) QuantErr: 12.78295 batch_time=0.64145 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 4.21877 (QuantReg: 12.93030) QuantErr: 12.93030 batch_time=0.66656 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 3.32080 (QuantReg: 13.14130) QuantErr: 13.14130 batch_time=0.65158 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 3.49381 (QuantReg: 12.93935) QuantErr: 12.93935 batch_time=0.79970 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 2.66573 (QuantReg: 13.44320) QuantErr: 13.44320 batch_time=0.65749 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 3.71835 (QuantReg: 12.96162) QuantErr: 12.96162 batch_time=0.65077 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 3.12732 (QuantReg: 13.23762) QuantErr: 13.23762 batch_time=0.69183 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 4.84043 (QuantReg: 12.94041) QuantErr: 12.94041 batch_time=0.65733 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 3.59536 (QuantReg: 13.16851) QuantErr: 13.16851 batch_time=0.64417 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 4.12044 (QuantReg: 12.55969) QuantErr: 12.55969 batch_time=0.65478 
Train Epoch: 21 codebook_update_time=3.96484
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch21.pth ...
Done in 4.179s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch21.pth ...
Done in 8.776s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 3.565179388999939
 quant_reg      : 12.984175952911377
 quant_err      : 12.984175952911377
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_full_val/t2v_metrics/R1: 31.388329979879277
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.329979879275655
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.53691796261137
 MSRVTT_full_val/v2t_metrics/R1: 39.839034205231385
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 88.53118712273641
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.951710261569416
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.83258055133905
 MSRVTT_full_test/t2v_metrics/R1: 12.408026755852843
 MSRVTT_full_test/t2v_metrics/R5: 35.38461538461539
 MSRVTT_full_test/t2v_metrics/R10: 49.69899665551839
 MSRVTT_full_test/t2v_metrics/R50: 80.96989966555184
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.991638795986624
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.9439807801222
 MSRVTT_full_test/v2t_metrics/R1: 14.849498327759198
 MSRVTT_full_test/v2t_metrics/R5: 42.34113712374582
 MSRVTT_full_test/v2t_metrics/R10: 57.82608695652174
 MSRVTT_full_test/v2t_metrics/R50: 86.62207357859532
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.700334448160536
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.128316604703706
 mnt_best       : 27.9439807801222
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 2.97735 (QuantReg: 12.81450) QuantErr: 12.81450 batch_time=39.15130 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 3.42270 (QuantReg: 12.93517) QuantErr: 12.93517 batch_time=0.64442 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 2.80160 (QuantReg: 12.82872) QuantErr: 12.82872 batch_time=0.64168 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 4.19750 (QuantReg: 12.85274) QuantErr: 12.85274 batch_time=0.66143 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 3.54601 (QuantReg: 12.91214) QuantErr: 12.91214 batch_time=0.72901 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 3.35152 (QuantReg: 12.89740) QuantErr: 12.89740 batch_time=0.69071 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 4.39514 (QuantReg: 13.00031) QuantErr: 13.00031 batch_time=0.67258 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 4.06748 (QuantReg: 12.95448) QuantErr: 12.95448 batch_time=0.63597 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 3.51180 (QuantReg: 12.86164) QuantErr: 12.86164 batch_time=0.65602 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 3.45685 (QuantReg: 12.87507) QuantErr: 12.87507 batch_time=0.66466 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 3.48312 (QuantReg: 13.15743) QuantErr: 13.15743 batch_time=0.66570 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 3.69879 (QuantReg: 13.20875) QuantErr: 13.20875 batch_time=0.66448 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 2.75937 (QuantReg: 13.17871) QuantErr: 13.17871 batch_time=0.78138 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 2.54294 (QuantReg: 13.01039) QuantErr: 13.01039 batch_time=0.66717 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 2.96538 (QuantReg: 12.99231) QuantErr: 12.99231 batch_time=0.66314 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 3.67103 (QuantReg: 12.83697) QuantErr: 12.83697 batch_time=0.66781 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 3.90640 (QuantReg: 12.98459) QuantErr: 12.98459 batch_time=0.65203 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 3.23464 (QuantReg: 12.87286) QuantErr: 12.87286 batch_time=0.67463 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 3.54544 (QuantReg: 12.86299) QuantErr: 12.86299 batch_time=0.71756 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 3.47174 (QuantReg: 12.89930) QuantErr: 12.89930 batch_time=0.66319 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 3.37868 (QuantReg: 13.06433) QuantErr: 13.06433 batch_time=0.64439 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 3.84489 (QuantReg: 13.19896) QuantErr: 13.19896 batch_time=0.65145 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 3.84722 (QuantReg: 13.16894) QuantErr: 13.16894 batch_time=0.64043 
Train Epoch: 22 codebook_update_time=3.87446
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch22.pth ...
Done in 3.999s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch22.pth ...
Done in 8.164s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 3.500640478134155
 quant_reg      : 13.010971031188966
 quant_err      : 13.010971031188966
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_full_val/t2v_metrics/R1: 30.58350100603622
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 80.28169014084507
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.22334004024145
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.957739974597025
 MSRVTT_full_val/v2t_metrics/R1: 38.6317907444668
 MSRVTT_full_val/v2t_metrics/R5: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R10: 87.92756539235413
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.818913480885312
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.13576333946543
 MSRVTT_full_test/t2v_metrics/R1: 12.575250836120402
 MSRVTT_full_test/t2v_metrics/R5: 35.852842809364546
 MSRVTT_full_test/t2v_metrics/R10: 48.862876254180605
 MSRVTT_full_test/t2v_metrics/R50: 80.73578595317726
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.76822742474916
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.033226999822155
 MSRVTT_full_test/v2t_metrics/R1: 15.418060200668897
 MSRVTT_full_test/v2t_metrics/R5: 42.74247491638796
 MSRVTT_full_test/v2t_metrics/R10: 58.72909698996656
 MSRVTT_full_test/v2t_metrics/R50: 87.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.20685618729097
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.82576094442642
 mnt_best       : 28.033226999822155
 not_improved_count: 0
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 4.87309 (QuantReg: 12.80030) QuantErr: 12.80030 batch_time=36.72848 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 3.82362 (QuantReg: 12.90475) QuantErr: 12.90475 batch_time=0.69713 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 3.68798 (QuantReg: 12.93601) QuantErr: 12.93601 batch_time=0.67627 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 3.34432 (QuantReg: 13.08785) QuantErr: 13.08785 batch_time=0.64951 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 3.22599 (QuantReg: 13.14018) QuantErr: 13.14018 batch_time=0.80100 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 3.17752 (QuantReg: 13.04860) QuantErr: 13.04860 batch_time=0.66061 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 3.34254 (QuantReg: 12.89480) QuantErr: 12.89480 batch_time=1.59705 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 3.59109 (QuantReg: 12.82607) QuantErr: 12.82607 batch_time=0.68741 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 3.39531 (QuantReg: 12.84671) QuantErr: 12.84671 batch_time=0.82071 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 3.64349 (QuantReg: 13.03751) QuantErr: 13.03751 batch_time=0.66959 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 3.34359 (QuantReg: 13.34182) QuantErr: 13.34182 batch_time=0.65538 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 2.27198 (QuantReg: 13.28276) QuantErr: 13.28276 batch_time=0.66049 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 3.71693 (QuantReg: 13.02360) QuantErr: 13.02360 batch_time=4.95763 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 3.96736 (QuantReg: 13.10212) QuantErr: 13.10212 batch_time=0.66544 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 3.42148 (QuantReg: 12.97134) QuantErr: 12.97134 batch_time=0.64760 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 3.00291 (QuantReg: 13.00690) QuantErr: 13.00690 batch_time=0.65216 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 3.88139 (QuantReg: 12.83906) QuantErr: 12.83906 batch_time=0.68658 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 4.07570 (QuantReg: 13.03099) QuantErr: 13.03099 batch_time=0.65800 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 4.68718 (QuantReg: 12.88843) QuantErr: 12.88843 batch_time=0.70944 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 3.90505 (QuantReg: 12.90428) QuantErr: 12.90428 batch_time=0.67569 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 4.08316 (QuantReg: 13.10771) QuantErr: 13.10771 batch_time=0.66264 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 3.96805 (QuantReg: 12.77885) QuantErr: 12.77885 batch_time=0.67973 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 4.95174 (QuantReg: 12.95030) QuantErr: 12.95030 batch_time=0.67309 
Train Epoch: 23 codebook_update_time=4.06836
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch23.pth ...
Done in 4.499s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch23.pth ...
Done in 8.823s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 3.53719686126709
 quant_reg      : 13.006616024017333
 quant_err      : 13.006616024017333
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 70.62374245472837
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.855130784708249
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.91424682961239
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.112676056338028
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.67880018537646
 MSRVTT_full_test/t2v_metrics/R1: 12.608695652173912
 MSRVTT_full_test/t2v_metrics/R5: 36.12040133779264
 MSRVTT_full_test/t2v_metrics/R10: 49.83277591973244
 MSRVTT_full_test/t2v_metrics/R50: 80.3010033444816
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.48595317725753
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.31256847467662
 MSRVTT_full_test/v2t_metrics/R1: 16.153846153846153
 MSRVTT_full_test/v2t_metrics/R5: 43.01003344481605
 MSRVTT_full_test/v2t_metrics/R10: 58.19397993311037
 MSRVTT_full_test/v2t_metrics/R50: 86.62207357859532
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.847324414715718
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.32215863125581
 mnt_best       : 28.31256847467662
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 2.77842 (QuantReg: 12.95749) QuantErr: 12.95749 batch_time=35.83269 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 3.07941 (QuantReg: 13.11693) QuantErr: 13.11693 batch_time=0.65306 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 2.98202 (QuantReg: 13.23588) QuantErr: 13.23588 batch_time=0.66792 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 3.32912 (QuantReg: 12.99392) QuantErr: 12.99392 batch_time=0.66511 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 3.40983 (QuantReg: 12.94436) QuantErr: 12.94436 batch_time=0.67597 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 3.44416 (QuantReg: 12.83674) QuantErr: 12.83674 batch_time=0.89126 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 2.66606 (QuantReg: 13.25699) QuantErr: 13.25699 batch_time=0.64489 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 4.01922 (QuantReg: 13.19028) QuantErr: 13.19028 batch_time=0.69986 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 4.43920 (QuantReg: 12.76862) QuantErr: 12.76862 batch_time=0.66696 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 3.62983 (QuantReg: 13.17893) QuantErr: 13.17893 batch_time=0.71821 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 3.46029 (QuantReg: 13.05203) QuantErr: 13.05203 batch_time=0.65506 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 3.49889 (QuantReg: 13.23099) QuantErr: 13.23099 batch_time=0.67061 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 3.02935 (QuantReg: 13.25838) QuantErr: 13.25838 batch_time=0.92527 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 2.69677 (QuantReg: 13.12090) QuantErr: 13.12090 batch_time=1.63771 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 2.57260 (QuantReg: 13.28766) QuantErr: 13.28766 batch_time=0.70680 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 3.56497 (QuantReg: 12.81009) QuantErr: 12.81009 batch_time=0.66623 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 2.88755 (QuantReg: 13.22066) QuantErr: 13.22066 batch_time=0.73650 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 3.85887 (QuantReg: 13.05416) QuantErr: 13.05416 batch_time=0.64690 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 2.65067 (QuantReg: 13.26190) QuantErr: 13.26190 batch_time=0.68060 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 3.10788 (QuantReg: 13.33265) QuantErr: 13.33265 batch_time=0.68046 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 3.43400 (QuantReg: 13.04291) QuantErr: 13.04291 batch_time=0.73363 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 3.88375 (QuantReg: 12.93406) QuantErr: 12.93406 batch_time=0.69566 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 3.49598 (QuantReg: 12.89636) QuantErr: 12.89636 batch_time=0.71645 
Train Epoch: 24 codebook_update_time=4.27119
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch24.pth ...
Done in 4.707s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch24.pth ...
Done in 9.163s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 3.4120313787460326
 quant_reg      : 13.062492042541503
 quant_err      : 13.062492042541503
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.963782696177063
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.35405798133832
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.225352112676056
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.46817991772446
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 35.785953177257525
 MSRVTT_full_test/t2v_metrics/R10: 50.23411371237458
 MSRVTT_full_test/t2v_metrics/R50: 81.27090301003345
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.73645484949833
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.8164894782442
 MSRVTT_full_test/v2t_metrics/R1: 15.953177257525084
 MSRVTT_full_test/v2t_metrics/R5: 43.01003344481605
 MSRVTT_full_test/v2t_metrics/R10: 57.759197324414714
 MSRVTT_full_test/v2t_metrics/R50: 86.75585284280936
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.85418060200669
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.09411120863225
 mnt_best       : 28.8164894782442
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 2.88919 (QuantReg: 13.11344) QuantErr: 13.11344 batch_time=39.46094 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 3.28334 (QuantReg: 13.11040) QuantErr: 13.11040 batch_time=0.66730 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 3.37776 (QuantReg: 12.69563) QuantErr: 12.69563 batch_time=0.67119 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 3.83021 (QuantReg: 13.22846) QuantErr: 13.22846 batch_time=0.67111 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 2.73382 (QuantReg: 13.14684) QuantErr: 13.14684 batch_time=0.67102 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 2.20813 (QuantReg: 13.28858) QuantErr: 13.28858 batch_time=0.70268 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 3.39211 (QuantReg: 13.42407) QuantErr: 13.42407 batch_time=0.69593 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 3.62384 (QuantReg: 13.15002) QuantErr: 13.15002 batch_time=0.64823 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 3.26447 (QuantReg: 12.92588) QuantErr: 12.92588 batch_time=0.64998 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 3.52815 (QuantReg: 12.89309) QuantErr: 12.89309 batch_time=0.64844 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 3.19126 (QuantReg: 13.05381) QuantErr: 13.05381 batch_time=0.70523 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 3.66707 (QuantReg: 13.08828) QuantErr: 13.08828 batch_time=0.67757 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 3.25629 (QuantReg: 13.16226) QuantErr: 13.16226 batch_time=0.66205 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 2.81775 (QuantReg: 13.22711) QuantErr: 13.22711 batch_time=5.80047 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 2.80999 (QuantReg: 13.21137) QuantErr: 13.21137 batch_time=0.69656 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 3.16122 (QuantReg: 13.01765) QuantErr: 13.01765 batch_time=0.68720 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 3.36723 (QuantReg: 12.95990) QuantErr: 12.95990 batch_time=0.72692 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 3.10371 (QuantReg: 13.04537) QuantErr: 13.04537 batch_time=0.78797 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 2.85676 (QuantReg: 12.99791) QuantErr: 12.99791 batch_time=0.66753 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 2.86478 (QuantReg: 13.14049) QuantErr: 13.14049 batch_time=0.66350 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 4.08227 (QuantReg: 13.11276) QuantErr: 13.11276 batch_time=0.66990 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 2.82653 (QuantReg: 13.20763) QuantErr: 13.20763 batch_time=0.65221 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 2.92308 (QuantReg: 13.12243) QuantErr: 13.12243 batch_time=0.72307 
Train Epoch: 25 codebook_update_time=3.72230
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch25.pth ...
Done in 4.366s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 3.330002105712891
 quant_reg      : 13.070375183105469
 quant_err      : 13.070375183105469
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 68.81287726358148
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.046277665995976
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.86027519435991
 MSRVTT_full_val/v2t_metrics/R1: 38.83299798792756
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.062374245472837
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.65363713469593
 MSRVTT_full_test/t2v_metrics/R1: 12.54180602006689
 MSRVTT_full_test/t2v_metrics/R5: 35.45150501672241
 MSRVTT_full_test/t2v_metrics/R10: 49.4314381270903
 MSRVTT_full_test/t2v_metrics/R50: 80.5685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.03160535117057
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.01126146415802
 MSRVTT_full_test/v2t_metrics/R1: 15.585284280936454
 MSRVTT_full_test/v2t_metrics/R5: 42.709030100334445
 MSRVTT_full_test/v2t_metrics/R10: 57.9933110367893
 MSRVTT_full_test/v2t_metrics/R50: 86.82274247491638
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.937458193979932
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.79642638921355
 mnt_best       : 28.8164894782442
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 3.07445 (QuantReg: 12.76811) QuantErr: 12.76811 batch_time=33.10085 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 3.51244 (QuantReg: 13.10300) QuantErr: 13.10300 batch_time=0.64204 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 3.94263 (QuantReg: 13.01419) QuantErr: 13.01419 batch_time=0.70829 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 2.66097 (QuantReg: 13.12513) QuantErr: 13.12513 batch_time=0.68913 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 3.56057 (QuantReg: 12.85257) QuantErr: 12.85257 batch_time=0.81638 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 3.08733 (QuantReg: 12.99279) QuantErr: 12.99279 batch_time=0.65775 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 3.26074 (QuantReg: 13.08133) QuantErr: 13.08133 batch_time=2.07576 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 4.29566 (QuantReg: 12.94681) QuantErr: 12.94681 batch_time=0.66665 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 3.88951 (QuantReg: 13.05579) QuantErr: 13.05579 batch_time=0.67875 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 3.10444 (QuantReg: 13.10786) QuantErr: 13.10786 batch_time=0.66855 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 2.08112 (QuantReg: 13.41157) QuantErr: 13.41157 batch_time=0.68114 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 2.86166 (QuantReg: 13.11244) QuantErr: 13.11244 batch_time=0.66766 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 3.56089 (QuantReg: 13.02741) QuantErr: 13.02741 batch_time=0.67457 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 3.71738 (QuantReg: 13.20608) QuantErr: 13.20608 batch_time=0.65482 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 3.64005 (QuantReg: 13.22692) QuantErr: 13.22692 batch_time=0.67765 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 2.77052 (QuantReg: 12.96390) QuantErr: 12.96390 batch_time=0.69155 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 3.85956 (QuantReg: 13.28264) QuantErr: 13.28264 batch_time=0.73736 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 3.38958 (QuantReg: 12.95467) QuantErr: 12.95467 batch_time=0.65524 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 3.58170 (QuantReg: 12.89679) QuantErr: 12.89679 batch_time=0.73410 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 3.06481 (QuantReg: 13.03094) QuantErr: 13.03094 batch_time=1.64328 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 3.73729 (QuantReg: 13.12964) QuantErr: 13.12964 batch_time=0.66297 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 3.71315 (QuantReg: 13.44914) QuantErr: 13.44914 batch_time=0.67892 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 3.31598 (QuantReg: 13.20856) QuantErr: 13.20856 batch_time=0.64803 
Train Epoch: 26 codebook_update_time=3.59407
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch26.pth ...
Done in 3.953s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 3.297860549926758
 quant_reg      : 13.113215049743653
 quant_err      : 13.113215049743653
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 68.81287726358148
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.810865191146881
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.94924523073153
 MSRVTT_full_val/v2t_metrics/R1: 38.6317907444668
 MSRVTT_full_val/v2t_metrics/R5: 78.26961770623743
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.798792756539235
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.15400856441872
 MSRVTT_full_test/t2v_metrics/R1: 13.010033444816054
 MSRVTT_full_test/t2v_metrics/R5: 35.551839464882946
 MSRVTT_full_test/t2v_metrics/R10: 49.39799331103679
 MSRVTT_full_test/t2v_metrics/R50: 81.17056856187291
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.01638795986622
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.37591875856788
 MSRVTT_full_test/v2t_metrics/R1: 15.48494983277592
 MSRVTT_full_test/v2t_metrics/R5: 43.24414715719063
 MSRVTT_full_test/v2t_metrics/R10: 58.896321070234116
 MSRVTT_full_test/v2t_metrics/R50: 86.62207357859532
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.94916387959866
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.03886749724715
 mnt_best       : 28.8164894782442
 not_improved_count: 2
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 3.78955 (QuantReg: 12.84258) QuantErr: 12.84258 batch_time=38.40161 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 3.05722 (QuantReg: 12.82261) QuantErr: 12.82261 batch_time=0.64548 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 2.56947 (QuantReg: 13.46316) QuantErr: 13.46316 batch_time=1.71546 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 3.12193 (QuantReg: 13.31099) QuantErr: 13.31099 batch_time=1.13758 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 3.63124 (QuantReg: 13.19611) QuantErr: 13.19611 batch_time=0.66805 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 3.54209 (QuantReg: 13.09734) QuantErr: 13.09734 batch_time=0.74088 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 3.11161 (QuantReg: 12.92428) QuantErr: 12.92428 batch_time=0.66657 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 2.96621 (QuantReg: 12.89015) QuantErr: 12.89015 batch_time=0.65213 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 3.51172 (QuantReg: 13.07069) QuantErr: 13.07069 batch_time=0.91301 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 3.10868 (QuantReg: 13.14648) QuantErr: 13.14648 batch_time=0.70172 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 3.32814 (QuantReg: 13.22474) QuantErr: 13.22474 batch_time=0.67809 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 2.39181 (QuantReg: 12.98478) QuantErr: 12.98478 batch_time=0.70786 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 3.68294 (QuantReg: 13.30879) QuantErr: 13.30879 batch_time=0.65717 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 3.81113 (QuantReg: 13.04980) QuantErr: 13.04980 batch_time=0.65389 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 2.67804 (QuantReg: 13.28459) QuantErr: 13.28459 batch_time=0.69448 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 2.78242 (QuantReg: 13.26456) QuantErr: 13.26456 batch_time=0.65924 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 3.32697 (QuantReg: 13.26683) QuantErr: 13.26683 batch_time=0.64068 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 3.53813 (QuantReg: 12.92033) QuantErr: 12.92033 batch_time=0.66606 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 3.56903 (QuantReg: 13.03026) QuantErr: 13.03026 batch_time=0.81044 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 3.73843 (QuantReg: 13.14979) QuantErr: 13.14979 batch_time=0.65266 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 3.29002 (QuantReg: 13.36204) QuantErr: 13.36204 batch_time=1.62313 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 3.59964 (QuantReg: 13.22648) QuantErr: 13.22648 batch_time=0.69341 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 3.20551 (QuantReg: 13.18702) QuantErr: 13.18702 batch_time=0.64617 
Train Epoch: 27 codebook_update_time=4.40410
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch27.pth ...
Done in 4.210s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 3.2933053302764894
 quant_reg      : 13.082120620727538
 quant_err      : 13.082120620727538
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.317907444668009
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.99159837520365
 MSRVTT_full_val/v2t_metrics/R1: 40.44265593561368
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.189134808853119
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.45668969980665
 MSRVTT_full_test/t2v_metrics/R1: 12.307692307692308
 MSRVTT_full_test/t2v_metrics/R5: 35.45150501672241
 MSRVTT_full_test/t2v_metrics/R10: 48.69565217391305
 MSRVTT_full_test/t2v_metrics/R50: 80.2675585284281
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.662541806020066
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.6970701714062
 MSRVTT_full_test/v2t_metrics/R1: 15.351170568561873
 MSRVTT_full_test/v2t_metrics/R5: 42.675585284280935
 MSRVTT_full_test/v2t_metrics/R10: 57.424749163879596
 MSRVTT_full_test/v2t_metrics/R50: 86.65551839464882
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.958528428093647
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.507345983814766
 mnt_best       : 28.8164894782442
 not_improved_count: 3
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 3.55526 (QuantReg: 12.62631) QuantErr: 12.62631 batch_time=35.73781 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 2.66081 (QuantReg: 13.20810) QuantErr: 13.20810 batch_time=1.89536 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 3.37335 (QuantReg: 12.72032) QuantErr: 12.72032 batch_time=0.65765 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 2.85360 (QuantReg: 13.27231) QuantErr: 13.27231 batch_time=0.64790 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 2.70549 (QuantReg: 13.13537) QuantErr: 13.13537 batch_time=0.68505 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 2.83365 (QuantReg: 13.32455) QuantErr: 13.32455 batch_time=0.78006 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 2.69464 (QuantReg: 13.13422) QuantErr: 13.13422 batch_time=0.66347 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 3.25214 (QuantReg: 13.24548) QuantErr: 13.24548 batch_time=0.65829 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 3.46590 (QuantReg: 12.73953) QuantErr: 12.73953 batch_time=0.64374 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 3.16441 (QuantReg: 12.94461) QuantErr: 12.94461 batch_time=0.67640 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 2.25035 (QuantReg: 13.27023) QuantErr: 13.27023 batch_time=0.65778 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 3.25831 (QuantReg: 13.00960) QuantErr: 13.00960 batch_time=0.66088 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 3.13478 (QuantReg: 13.16747) QuantErr: 13.16747 batch_time=0.71150 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 4.26485 (QuantReg: 12.95348) QuantErr: 12.95348 batch_time=0.66669 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 3.74351 (QuantReg: 13.08612) QuantErr: 13.08612 batch_time=0.64614 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 3.41251 (QuantReg: 13.16856) QuantErr: 13.16856 batch_time=0.65957 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 2.93821 (QuantReg: 13.08513) QuantErr: 13.08513 batch_time=0.71689 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 2.81090 (QuantReg: 13.31059) QuantErr: 13.31059 batch_time=0.68646 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 3.88744 (QuantReg: 12.93466) QuantErr: 12.93466 batch_time=0.64035 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 3.24489 (QuantReg: 13.05190) QuantErr: 13.05190 batch_time=0.66827 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 2.94590 (QuantReg: 13.27729) QuantErr: 13.27729 batch_time=0.67936 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 3.30733 (QuantReg: 13.23450) QuantErr: 13.23450 batch_time=0.72754 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 4.02256 (QuantReg: 12.89594) QuantErr: 12.89594 batch_time=0.65006 
Train Epoch: 28 codebook_update_time=4.32727
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch28.pth ...
Done in 4.080s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 3.1806678891181948
 quant_reg      : 13.120435611724854
 quant_err      : 13.120435611724854
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.420523138832998
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.251389574323696
 MSRVTT_full_val/v2t_metrics/R1: 37.223340040241446
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.368209255533199
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.87893028445838
 MSRVTT_full_test/t2v_metrics/R1: 12.909698996655518
 MSRVTT_full_test/t2v_metrics/R5: 35.25083612040134
 MSRVTT_full_test/t2v_metrics/R10: 49.4314381270903
 MSRVTT_full_test/t2v_metrics/R50: 80.70234113712375
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.94581939799331
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.229049907937892
 MSRVTT_full_test/v2t_metrics/R1: 15.451505016722408
 MSRVTT_full_test/v2t_metrics/R5: 43.44481605351171
 MSRVTT_full_test/v2t_metrics/R10: 57.82608695652174
 MSRVTT_full_test/v2t_metrics/R50: 86.2876254180602
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.64782608695652
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.8592643671068
 mnt_best       : 28.8164894782442
 not_improved_count: 4
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 2.53316 (QuantReg: 12.85109) QuantErr: 12.85109 batch_time=39.08572 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 2.66671 (QuantReg: 13.03734) QuantErr: 13.03734 batch_time=0.66071 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 2.25598 (QuantReg: 13.20638) QuantErr: 13.20638 batch_time=0.65773 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 3.21637 (QuantReg: 13.11862) QuantErr: 13.11862 batch_time=0.64824 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 3.57521 (QuantReg: 13.10024) QuantErr: 13.10024 batch_time=0.65425 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 2.87843 (QuantReg: 13.05859) QuantErr: 13.05859 batch_time=0.65004 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 2.53795 (QuantReg: 12.89716) QuantErr: 12.89716 batch_time=1.82227 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 3.77905 (QuantReg: 12.67674) QuantErr: 12.67674 batch_time=0.74720 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 2.82216 (QuantReg: 13.07065) QuantErr: 13.07065 batch_time=0.66322 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 3.05659 (QuantReg: 13.30284) QuantErr: 13.30284 batch_time=0.64778 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 3.40186 (QuantReg: 13.02780) QuantErr: 13.02780 batch_time=0.65697 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 4.48077 (QuantReg: 12.83409) QuantErr: 12.83409 batch_time=0.64660 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 2.81660 (QuantReg: 13.17486) QuantErr: 13.17486 batch_time=4.61766 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 2.50186 (QuantReg: 13.30391) QuantErr: 13.30391 batch_time=2.45048 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 4.68956 (QuantReg: 12.80962) QuantErr: 12.80962 batch_time=0.66542 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 3.16834 (QuantReg: 13.06885) QuantErr: 13.06885 batch_time=0.65931 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 3.97843 (QuantReg: 13.21927) QuantErr: 13.21927 batch_time=0.71124 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 2.87064 (QuantReg: 13.22737) QuantErr: 13.22737 batch_time=0.64175 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 2.84197 (QuantReg: 13.38875) QuantErr: 13.38875 batch_time=0.63811 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 3.00505 (QuantReg: 12.96751) QuantErr: 12.96751 batch_time=0.65265 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 3.04032 (QuantReg: 13.47640) QuantErr: 13.47640 batch_time=0.65768 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 2.76897 (QuantReg: 13.30405) QuantErr: 13.30405 batch_time=0.65797 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 3.12019 (QuantReg: 12.95764) QuantErr: 12.95764 batch_time=0.63246 
Train Epoch: 29 codebook_update_time=3.86990
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch29.pth ...
Done in 4.298s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 3.1386214838027953
 quant_reg      : 13.120940437316895
 quant_err      : 13.120940437316895
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 68.2092555331992
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.193158953722335
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.60253774588769
 MSRVTT_full_val/v2t_metrics/R1: 37.625754527162975
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.064386317907445
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.88309309331717
 MSRVTT_full_test/t2v_metrics/R1: 13.177257525083611
 MSRVTT_full_test/t2v_metrics/R5: 36.05351170568562
 MSRVTT_full_test/t2v_metrics/R10: 50.0
 MSRVTT_full_test/t2v_metrics/R50: 80.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 10.5
 MSRVTT_full_test/t2v_metrics/MeanR: 44.73478260869565
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.746228282614524
 MSRVTT_full_test/v2t_metrics/R1: 15.217391304347826
 MSRVTT_full_test/v2t_metrics/R5: 42.709030100334445
 MSRVTT_full_test/v2t_metrics/R10: 58.19397993311037
 MSRVTT_full_test/v2t_metrics/R50: 86.32107023411372
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.02876254180602
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.56701008712065
 mnt_best       : 28.8164894782442
 not_improved_count: 5
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 2.82000 (QuantReg: 13.23915) QuantErr: 13.23915 batch_time=37.24648 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 3.96861 (QuantReg: 13.16025) QuantErr: 13.16025 batch_time=0.65608 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 3.14594 (QuantReg: 13.16323) QuantErr: 13.16323 batch_time=1.85885 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 3.06761 (QuantReg: 12.89965) QuantErr: 12.89965 batch_time=0.66723 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 3.41168 (QuantReg: 13.09325) QuantErr: 13.09325 batch_time=0.67213 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 2.93198 (QuantReg: 13.45848) QuantErr: 13.45848 batch_time=0.64607 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 3.64563 (QuantReg: 13.19932) QuantErr: 13.19932 batch_time=0.65174 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 3.12791 (QuantReg: 13.09787) QuantErr: 13.09787 batch_time=0.72172 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 2.40034 (QuantReg: 13.44146) QuantErr: 13.44146 batch_time=0.65056 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 3.12779 (QuantReg: 13.29349) QuantErr: 13.29349 batch_time=0.81138 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 3.20252 (QuantReg: 13.32023) QuantErr: 13.32023 batch_time=0.67358 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 2.08256 (QuantReg: 13.31295) QuantErr: 13.31295 batch_time=0.80506 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 3.55023 (QuantReg: 13.23768) QuantErr: 13.23768 batch_time=0.65014 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 2.94660 (QuantReg: 13.11044) QuantErr: 13.11044 batch_time=0.66544 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 3.03183 (QuantReg: 13.27565) QuantErr: 13.27565 batch_time=0.68638 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 3.56618 (QuantReg: 13.24401) QuantErr: 13.24401 batch_time=1.42955 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 3.04522 (QuantReg: 13.21899) QuantErr: 13.21899 batch_time=0.71862 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 2.89947 (QuantReg: 13.17750) QuantErr: 13.17750 batch_time=0.66616 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 2.01993 (QuantReg: 13.19893) QuantErr: 13.19893 batch_time=0.63263 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 3.52675 (QuantReg: 13.18117) QuantErr: 13.18117 batch_time=0.63167 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 3.40162 (QuantReg: 13.10817) QuantErr: 13.10817 batch_time=0.65494 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 2.79919 (QuantReg: 13.42829) QuantErr: 13.42829 batch_time=0.67635 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 3.29338 (QuantReg: 13.20074) QuantErr: 13.20074 batch_time=0.66234 
Train Epoch: 30 codebook_update_time=4.21607
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch30.pth ...
Done in 4.333s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch30.pth ...
Done in 8.385s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 3.124083101272583
 quant_reg      : 13.150203582763671
 quant_err      : 13.150203582763671
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.086519114688128
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.043886657158694
 MSRVTT_full_val/v2t_metrics/R1: 41.24748490945674
 MSRVTT_full_val/v2t_metrics/R5: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.016096579476861
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 65.3743508434318
 MSRVTT_full_test/t2v_metrics/R1: 13.143812709030101
 MSRVTT_full_test/t2v_metrics/R5: 37.19063545150502
 MSRVTT_full_test/t2v_metrics/R10: 50.2675585284281
 MSRVTT_full_test/t2v_metrics/R50: 81.40468227424749
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.626421404682276
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.072402168175255
 MSRVTT_full_test/v2t_metrics/R1: 16.08695652173913
 MSRVTT_full_test/v2t_metrics/R5: 44.31438127090301
 MSRVTT_full_test/v2t_metrics/R10: 58.561872909699
 MSRVTT_full_test/v2t_metrics/R50: 86.65551839464882
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.044816053511706
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.69054945552685
 mnt_best       : 29.072402168175255
 not_improved_count: 0
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 2.48077 (QuantReg: 13.06833) QuantErr: 13.06833 batch_time=30.88849 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 3.14892 (QuantReg: 13.27478) QuantErr: 13.27478 batch_time=0.66653 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 3.60132 (QuantReg: 12.93014) QuantErr: 12.93014 batch_time=3.45180 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 3.20893 (QuantReg: 12.86651) QuantErr: 12.86651 batch_time=0.71945 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 2.90023 (QuantReg: 12.80861) QuantErr: 12.80861 batch_time=0.67745 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 2.11469 (QuantReg: 13.17612) QuantErr: 13.17612 batch_time=0.69120 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 3.55329 (QuantReg: 12.97718) QuantErr: 12.97718 batch_time=0.65190 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 3.34777 (QuantReg: 13.08033) QuantErr: 13.08033 batch_time=0.66711 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 3.49257 (QuantReg: 13.13977) QuantErr: 13.13977 batch_time=0.67632 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 2.86509 (QuantReg: 12.88587) QuantErr: 12.88587 batch_time=0.65955 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 2.99158 (QuantReg: 13.20148) QuantErr: 13.20148 batch_time=0.66690 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 3.36002 (QuantReg: 13.31865) QuantErr: 13.31865 batch_time=0.65183 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 2.20243 (QuantReg: 13.20089) QuantErr: 13.20089 batch_time=2.37426 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 2.69657 (QuantReg: 13.08108) QuantErr: 13.08108 batch_time=0.66071 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 3.36268 (QuantReg: 13.23159) QuantErr: 13.23159 batch_time=0.69415 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 3.14815 (QuantReg: 13.37639) QuantErr: 13.37639 batch_time=0.65967 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 2.91430 (QuantReg: 13.23576) QuantErr: 13.23576 batch_time=0.65385 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 3.60688 (QuantReg: 12.91431) QuantErr: 12.91431 batch_time=0.68919 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 3.30101 (QuantReg: 13.00058) QuantErr: 13.00058 batch_time=0.74311 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 3.01666 (QuantReg: 13.55718) QuantErr: 13.55718 batch_time=0.65500 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 2.67019 (QuantReg: 13.13123) QuantErr: 13.13123 batch_time=0.68537 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 2.42483 (QuantReg: 13.41358) QuantErr: 13.41358 batch_time=0.64632 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 3.15560 (QuantReg: 13.09500) QuantErr: 13.09500 batch_time=0.65731 
Train Epoch: 31 codebook_update_time=4.10364
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch31.pth ...
Done in 16.219s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 3.0906187410354615
 quant_reg      : 13.143021926879882
 quant_err      : 13.143021926879882
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.388329979879277
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.124373840421946
 MSRVTT_full_val/v2t_metrics/R1: 38.43058350100603
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.006036217303823
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.41649688488532
 MSRVTT_full_test/t2v_metrics/R1: 12.37458193979933
 MSRVTT_full_test/t2v_metrics/R5: 36.020066889632105
 MSRVTT_full_test/t2v_metrics/R10: 49.83277591973244
 MSRVTT_full_test/t2v_metrics/R50: 81.03678929765886
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.09799331103679
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.110163842319665
 MSRVTT_full_test/v2t_metrics/R1: 15.652173913043478
 MSRVTT_full_test/v2t_metrics/R5: 43.34448160535117
 MSRVTT_full_test/v2t_metrics/R10: 58.46153846153846
 MSRVTT_full_test/v2t_metrics/R50: 86.45484949832776
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.211705685618725
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.10302520186906
 mnt_best       : 29.072402168175255
 not_improved_count: 1
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 2.62726 (QuantReg: 13.12774) QuantErr: 13.12774 batch_time=32.61124 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 3.27893 (QuantReg: 13.00528) QuantErr: 13.00528 batch_time=0.66240 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 2.93993 (QuantReg: 12.95461) QuantErr: 12.95461 batch_time=0.66740 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 4.10040 (QuantReg: 12.89370) QuantErr: 12.89370 batch_time=0.64237 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 3.08814 (QuantReg: 13.07877) QuantErr: 13.07877 batch_time=0.67827 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 3.41013 (QuantReg: 13.07359) QuantErr: 13.07359 batch_time=0.64345 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 2.60841 (QuantReg: 13.31119) QuantErr: 13.31119 batch_time=0.64707 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 2.87494 (QuantReg: 13.00303) QuantErr: 13.00303 batch_time=0.66364 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 2.45232 (QuantReg: 13.34898) QuantErr: 13.34898 batch_time=0.67619 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 2.87159 (QuantReg: 13.19895) QuantErr: 13.19895 batch_time=0.68453 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 3.39410 (QuantReg: 13.07499) QuantErr: 13.07499 batch_time=0.79347 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 3.09709 (QuantReg: 12.99649) QuantErr: 12.99649 batch_time=0.66092 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 3.30887 (QuantReg: 13.46192) QuantErr: 13.46192 batch_time=0.67383 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 2.45970 (QuantReg: 13.28619) QuantErr: 13.28619 batch_time=1.04748 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 3.19626 (QuantReg: 13.49378) QuantErr: 13.49378 batch_time=2.04797 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 2.73045 (QuantReg: 13.15006) QuantErr: 13.15006 batch_time=0.68354 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 2.92577 (QuantReg: 13.07561) QuantErr: 13.07561 batch_time=0.67307 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 2.95505 (QuantReg: 13.35783) QuantErr: 13.35783 batch_time=0.64824 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 2.64491 (QuantReg: 13.28575) QuantErr: 13.28575 batch_time=0.65165 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 2.57267 (QuantReg: 13.27357) QuantErr: 13.27357 batch_time=0.66568 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 2.59485 (QuantReg: 13.08319) QuantErr: 13.08319 batch_time=0.66852 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 3.20772 (QuantReg: 12.96731) QuantErr: 12.96731 batch_time=1.00753 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 2.58932 (QuantReg: 13.38849) QuantErr: 13.38849 batch_time=0.65002 
Train Epoch: 32 codebook_update_time=3.62950
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch32.pth ...
Done in 4.458s
removing stale ckpt [epoch 31] [took 0.87s]
 epoch          : 32
 loss           : 3.042608394622803
 quant_reg      : 13.170657867431641
 quant_err      : 13.170657867431641
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 71.22736418511066
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.887323943661972
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.69573520042427
 MSRVTT_full_val/v2t_metrics/R1: 42.25352112676056
 MSRVTT_full_val/v2t_metrics/R5: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.388329979879276
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 65.87820791117656
 MSRVTT_full_test/t2v_metrics/R1: 12.976588628762542
 MSRVTT_full_test/t2v_metrics/R5: 36.32107023411371
 MSRVTT_full_test/t2v_metrics/R10: 50.43478260869565
 MSRVTT_full_test/t2v_metrics/R50: 81.40468227424749
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.05518394648829
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.752996344711484
 MSRVTT_full_test/v2t_metrics/R1: 16.08695652173913
 MSRVTT_full_test/v2t_metrics/R5: 43.57859531772575
 MSRVTT_full_test/v2t_metrics/R10: 58.12709030100334
 MSRVTT_full_test/v2t_metrics/R50: 86.95652173913044
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.527759197324414
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.41189320354135
 mnt_best       : 29.072402168175255
 not_improved_count: 2
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 2.75090 (QuantReg: 13.06856) QuantErr: 13.06856 batch_time=30.91162 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 3.93204 (QuantReg: 12.90760) QuantErr: 12.90760 batch_time=0.69396 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 2.99282 (QuantReg: 13.28732) QuantErr: 13.28732 batch_time=0.73423 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 2.12593 (QuantReg: 13.14369) QuantErr: 13.14369 batch_time=0.65094 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.89897 (QuantReg: 13.29052) QuantErr: 13.29052 batch_time=0.65610 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 3.09199 (QuantReg: 13.27613) QuantErr: 13.27613 batch_time=0.65402 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 3.41412 (QuantReg: 13.17127) QuantErr: 13.17127 batch_time=1.02410 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 2.31811 (QuantReg: 13.23037) QuantErr: 13.23037 batch_time=0.67285 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 2.74516 (QuantReg: 13.22971) QuantErr: 13.22971 batch_time=0.66486 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 2.93012 (QuantReg: 13.14575) QuantErr: 13.14575 batch_time=0.67747 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 3.63486 (QuantReg: 13.15610) QuantErr: 13.15610 batch_time=0.75419 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 3.50983 (QuantReg: 13.26773) QuantErr: 13.26773 batch_time=0.66864 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 3.50029 (QuantReg: 13.00838) QuantErr: 13.00838 batch_time=0.72021 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 2.12088 (QuantReg: 13.15538) QuantErr: 13.15538 batch_time=0.70447 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 3.10507 (QuantReg: 13.35268) QuantErr: 13.35268 batch_time=0.67634 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 3.82730 (QuantReg: 13.30085) QuantErr: 13.30085 batch_time=0.66107 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 3.15212 (QuantReg: 13.20071) QuantErr: 13.20071 batch_time=0.67474 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 3.62728 (QuantReg: 13.16889) QuantErr: 13.16889 batch_time=0.66744 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 3.47359 (QuantReg: 13.17065) QuantErr: 13.17065 batch_time=0.67541 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 3.65778 (QuantReg: 13.09427) QuantErr: 13.09427 batch_time=0.69021 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 3.28728 (QuantReg: 13.03056) QuantErr: 13.03056 batch_time=1.54733 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 3.50445 (QuantReg: 13.25852) QuantErr: 13.25852 batch_time=0.66421 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 2.81370 (QuantReg: 13.11827) QuantErr: 13.11827 batch_time=0.67492 
Train Epoch: 33 codebook_update_time=4.12158
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch33.pth ...
Done in 9.619s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch33.pth ...
Done in 13.615s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 3.0397318439483643
 quant_reg      : 13.205804397583007
 quant_err      : 13.205804397583007
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_full_val/t2v_metrics/R1: 32.99798792756539
 MSRVTT_full_val/t2v_metrics/R5: 70.82494969818913
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.7283702213279675
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.533940893519215
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.649899396378269
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.14818135679717
 MSRVTT_full_test/t2v_metrics/R1: 14.013377926421406
 MSRVTT_full_test/t2v_metrics/R5: 37.525083612040135
 MSRVTT_full_test/t2v_metrics/R10: 51.47157190635451
 MSRVTT_full_test/t2v_metrics/R50: 81.73913043478261
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.03879598662208
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.024605621769005
 MSRVTT_full_test/v2t_metrics/R1: 16.187290969899667
 MSRVTT_full_test/v2t_metrics/R5: 44.080267558528426
 MSRVTT_full_test/v2t_metrics/R10: 59.79933110367893
 MSRVTT_full_test/v2t_metrics/R50: 86.98996655518394
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.86521739130435
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.94391608738811
 mnt_best       : 30.024605621769005
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 2.83406 (QuantReg: 13.22262) QuantErr: 13.22262 batch_time=36.92351 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 2.22157 (QuantReg: 13.42795) QuantErr: 13.42795 batch_time=0.66421 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 2.42111 (QuantReg: 13.31997) QuantErr: 13.31997 batch_time=0.68095 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 2.98427 (QuantReg: 13.01720) QuantErr: 13.01720 batch_time=0.69373 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 3.43476 (QuantReg: 13.27037) QuantErr: 13.27037 batch_time=0.66364 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 3.05091 (QuantReg: 13.21298) QuantErr: 13.21298 batch_time=0.65699 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 2.52570 (QuantReg: 13.40387) QuantErr: 13.40387 batch_time=0.69813 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 2.79922 (QuantReg: 13.01564) QuantErr: 13.01564 batch_time=0.67359 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 3.33236 (QuantReg: 13.40537) QuantErr: 13.40537 batch_time=1.37878 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 2.22124 (QuantReg: 13.25299) QuantErr: 13.25299 batch_time=0.66478 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 3.49572 (QuantReg: 13.21888) QuantErr: 13.21888 batch_time=0.80950 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 3.60960 (QuantReg: 13.28383) QuantErr: 13.28383 batch_time=0.66574 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 2.81323 (QuantReg: 13.05370) QuantErr: 13.05370 batch_time=1.52119 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 3.91032 (QuantReg: 13.28460) QuantErr: 13.28460 batch_time=0.66129 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 3.42744 (QuantReg: 12.95810) QuantErr: 12.95810 batch_time=0.67519 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 3.52011 (QuantReg: 13.12083) QuantErr: 13.12083 batch_time=0.66814 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 2.60782 (QuantReg: 13.27651) QuantErr: 13.27651 batch_time=0.69901 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 2.76293 (QuantReg: 13.46408) QuantErr: 13.46408 batch_time=0.69103 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 3.14340 (QuantReg: 13.04510) QuantErr: 13.04510 batch_time=0.69467 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 2.89748 (QuantReg: 13.04559) QuantErr: 13.04559 batch_time=1.00185 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 3.33451 (QuantReg: 13.34715) QuantErr: 13.34715 batch_time=0.65265 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 2.88204 (QuantReg: 13.32510) QuantErr: 13.32510 batch_time=0.64838 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 2.53717 (QuantReg: 13.40869) QuantErr: 13.40869 batch_time=0.64249 
Train Epoch: 34 codebook_update_time=4.50593
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch34.pth ...
Done in 4.130s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 2.9978822722435
 quant_reg      : 13.227622459411622
 quant_err      : 13.227622459411622
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 68.81287726358148
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.716297786720322
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.25888331053418
 MSRVTT_full_val/v2t_metrics/R1: 40.241448692152915
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.806841046277666
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.3988909048171
 MSRVTT_full_test/t2v_metrics/R1: 12.876254180602007
 MSRVTT_full_test/t2v_metrics/R5: 35.986622073578594
 MSRVTT_full_test/t2v_metrics/R10: 49.89966555183946
 MSRVTT_full_test/t2v_metrics/R50: 80.63545150501672
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.07324414715719
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.488926603002675
 MSRVTT_full_test/v2t_metrics/R1: 15.953177257525084
 MSRVTT_full_test/v2t_metrics/R5: 43.41137123745819
 MSRVTT_full_test/v2t_metrics/R10: 58.02675585284281
 MSRVTT_full_test/v2t_metrics/R50: 86.38795986622074
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.04230769230769
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.25255680334308
 mnt_best       : 30.024605621769005
 not_improved_count: 1
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 2.33042 (QuantReg: 13.15523) QuantErr: 13.15523 batch_time=34.35155 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 2.57728 (QuantReg: 13.29524) QuantErr: 13.29524 batch_time=0.66953 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 2.89844 (QuantReg: 13.08961) QuantErr: 13.08961 batch_time=0.68675 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 2.63118 (QuantReg: 13.07967) QuantErr: 13.07967 batch_time=0.67659 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 3.82112 (QuantReg: 13.16827) QuantErr: 13.16827 batch_time=0.65664 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 2.60904 (QuantReg: 12.85168) QuantErr: 12.85168 batch_time=0.68102 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 3.08363 (QuantReg: 13.32695) QuantErr: 13.32695 batch_time=0.66254 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 2.61746 (QuantReg: 13.33453) QuantErr: 13.33453 batch_time=0.65836 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 3.72139 (QuantReg: 13.11419) QuantErr: 13.11419 batch_time=0.65162 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 3.57314 (QuantReg: 13.16642) QuantErr: 13.16642 batch_time=0.66313 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 2.93220 (QuantReg: 13.08720) QuantErr: 13.08720 batch_time=0.66014 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 3.37144 (QuantReg: 12.86680) QuantErr: 12.86680 batch_time=0.66638 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 2.48555 (QuantReg: 13.23774) QuantErr: 13.23774 batch_time=0.66073 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 2.74435 (QuantReg: 13.21061) QuantErr: 13.21061 batch_time=0.66905 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 3.14637 (QuantReg: 13.13866) QuantErr: 13.13866 batch_time=1.59287 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 2.58860 (QuantReg: 13.36828) QuantErr: 13.36828 batch_time=0.69164 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 2.48351 (QuantReg: 13.65827) QuantErr: 13.65827 batch_time=0.67995 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 3.76940 (QuantReg: 13.06690) QuantErr: 13.06690 batch_time=0.65721 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 3.07996 (QuantReg: 13.26134) QuantErr: 13.26134 batch_time=0.67052 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 2.33717 (QuantReg: 13.13881) QuantErr: 13.13881 batch_time=0.65646 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 2.18926 (QuantReg: 13.15074) QuantErr: 13.15074 batch_time=0.71410 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 2.99137 (QuantReg: 13.36652) QuantErr: 13.36652 batch_time=0.64912 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 2.77416 (QuantReg: 13.49946) QuantErr: 13.49946 batch_time=0.66287 
Train Epoch: 35 codebook_update_time=3.92574
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch35.pth ...
Done in 4.352s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 2.9760429086685183
 quant_reg      : 13.212969062805175
 quant_err      : 13.212969062805175
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.571428571428571
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.884503999590045
 MSRVTT_full_val/v2t_metrics/R1: 40.04024144869215
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.022132796780684
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.930916071919796
 MSRVTT_full_test/t2v_metrics/R1: 13.210702341137123
 MSRVTT_full_test/t2v_metrics/R5: 36.72240802675585
 MSRVTT_full_test/t2v_metrics/R10: 51.03678929765886
 MSRVTT_full_test/t2v_metrics/R50: 81.93979933110369
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.37391304347826
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.146078803998115
 MSRVTT_full_test/v2t_metrics/R1: 15.618729096989966
 MSRVTT_full_test/v2t_metrics/R5: 43.74581939799331
 MSRVTT_full_test/v2t_metrics/R10: 57.759197324414714
 MSRVTT_full_test/v2t_metrics/R50: 86.92307692307692
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.01939799331104
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.04613360205078
 mnt_best       : 30.024605621769005
 not_improved_count: 2
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 2.87755 (QuantReg: 13.20077) QuantErr: 13.20077 batch_time=33.13592 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 2.03468 (QuantReg: 13.11962) QuantErr: 13.11962 batch_time=0.91846 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 2.44327 (QuantReg: 13.22643) QuantErr: 13.22643 batch_time=0.64741 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 3.25925 (QuantReg: 13.20112) QuantErr: 13.20112 batch_time=0.68225 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 3.64588 (QuantReg: 13.11996) QuantErr: 13.11996 batch_time=0.67351 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 2.68373 (QuantReg: 13.34769) QuantErr: 13.34769 batch_time=0.78390 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 2.43993 (QuantReg: 13.26701) QuantErr: 13.26701 batch_time=0.64705 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 2.35264 (QuantReg: 13.13079) QuantErr: 13.13079 batch_time=0.64739 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 3.54195 (QuantReg: 13.38889) QuantErr: 13.38889 batch_time=1.64844 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 2.34718 (QuantReg: 13.34696) QuantErr: 13.34696 batch_time=0.69070 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 3.90031 (QuantReg: 12.95383) QuantErr: 12.95383 batch_time=0.63903 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 2.86623 (QuantReg: 13.54520) QuantErr: 13.54520 batch_time=0.68459 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 2.83985 (QuantReg: 13.34062) QuantErr: 13.34062 batch_time=0.64534 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 2.84608 (QuantReg: 13.17531) QuantErr: 13.17531 batch_time=3.01159 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 3.31807 (QuantReg: 13.39252) QuantErr: 13.39252 batch_time=0.70963 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 2.79201 (QuantReg: 13.18881) QuantErr: 13.18881 batch_time=0.68982 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 2.73956 (QuantReg: 13.25510) QuantErr: 13.25510 batch_time=0.67067 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 2.71607 (QuantReg: 13.34727) QuantErr: 13.34727 batch_time=0.65110 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 3.24590 (QuantReg: 13.23037) QuantErr: 13.23037 batch_time=0.68871 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 3.35309 (QuantReg: 12.98415) QuantErr: 12.98415 batch_time=0.65671 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 2.77332 (QuantReg: 13.25883) QuantErr: 13.25883 batch_time=0.75544 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 2.31017 (QuantReg: 13.51325) QuantErr: 13.51325 batch_time=0.70930 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 3.04468 (QuantReg: 13.09089) QuantErr: 13.09089 batch_time=0.67232 
Train Epoch: 36 codebook_update_time=4.83339
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch36.pth ...
Done in 4.323s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 2.9913878345489504
 quant_reg      : 13.250213634490967
 quant_err      : 13.250213634490967
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 79.07444668008048
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.943661971830986
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.898383462041245
 MSRVTT_full_val/v2t_metrics/R1: 41.24748490945674
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.046277665995976
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.53836715043734
 MSRVTT_full_test/t2v_metrics/R1: 12.675585284280936
 MSRVTT_full_test/t2v_metrics/R5: 36.95652173913044
 MSRVTT_full_test/t2v_metrics/R10: 50.20066889632107
 MSRVTT_full_test/t2v_metrics/R50: 80.73578595317726
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.22341137123746
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.649884254191544
 MSRVTT_full_test/v2t_metrics/R1: 16.588628762541806
 MSRVTT_full_test/v2t_metrics/R5: 44.247491638795985
 MSRVTT_full_test/v2t_metrics/R10: 58.99665551839465
 MSRVTT_full_test/v2t_metrics/R50: 86.65551839464882
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.232608695652175
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.11630767632496
 mnt_best       : 30.024605621769005
 not_improved_count: 3
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 4.13640 (QuantReg: 13.13401) QuantErr: 13.13401 batch_time=34.65796 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 3.52729 (QuantReg: 13.17735) QuantErr: 13.17735 batch_time=0.64738 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 2.77721 (QuantReg: 13.21595) QuantErr: 13.21595 batch_time=0.64929 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 2.68174 (QuantReg: 13.03917) QuantErr: 13.03917 batch_time=0.70156 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 2.55863 (QuantReg: 13.02061) QuantErr: 13.02061 batch_time=0.66214 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 3.37476 (QuantReg: 13.06641) QuantErr: 13.06641 batch_time=1.26091 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 2.84416 (QuantReg: 13.37774) QuantErr: 13.37774 batch_time=0.64788 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 2.45142 (QuantReg: 13.27675) QuantErr: 13.27675 batch_time=0.63783 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 2.36752 (QuantReg: 13.27093) QuantErr: 13.27093 batch_time=0.70731 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 2.87577 (QuantReg: 13.23384) QuantErr: 13.23384 batch_time=0.68104 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 2.88332 (QuantReg: 13.02439) QuantErr: 13.02439 batch_time=0.68809 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 3.64749 (QuantReg: 13.35232) QuantErr: 13.35232 batch_time=0.68296 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 3.19476 (QuantReg: 13.30210) QuantErr: 13.30210 batch_time=2.68879 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 2.04905 (QuantReg: 13.45929) QuantErr: 13.45929 batch_time=3.16470 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 2.92914 (QuantReg: 12.94593) QuantErr: 12.94593 batch_time=0.65941 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 3.26660 (QuantReg: 13.32459) QuantErr: 13.32459 batch_time=0.64565 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 2.74005 (QuantReg: 13.19793) QuantErr: 13.19793 batch_time=0.65350 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 2.47205 (QuantReg: 13.03745) QuantErr: 13.03745 batch_time=0.68544 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 2.54212 (QuantReg: 13.38733) QuantErr: 13.38733 batch_time=0.63950 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 2.16301 (QuantReg: 13.20630) QuantErr: 13.20630 batch_time=0.65943 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 3.28251 (QuantReg: 13.53285) QuantErr: 13.53285 batch_time=0.69189 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 2.77651 (QuantReg: 13.56657) QuantErr: 13.56657 batch_time=0.65875 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 3.22193 (QuantReg: 12.95369) QuantErr: 12.95369 batch_time=0.65943 
Train Epoch: 37 codebook_update_time=3.73821
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch37.pth ...
Done in 4.629s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 2.943931950569153
 quant_reg      : 13.245599151611328
 quant_err      : 13.245599151611328
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.859154929577465
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.266762707500526
 MSRVTT_full_val/v2t_metrics/R1: 40.643863179074444
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.945674044265593
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.67007246271378
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 37.759197324414714
 MSRVTT_full_test/t2v_metrics/R10: 51.20401337792642
 MSRVTT_full_test/t2v_metrics/R50: 81.33779264214047
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.979933110367895
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.524295715621086
 MSRVTT_full_test/v2t_metrics/R1: 16.923076923076923
 MSRVTT_full_test/v2t_metrics/R5: 44.214046822742475
 MSRVTT_full_test/v2t_metrics/R10: 58.561872909699
 MSRVTT_full_test/v2t_metrics/R50: 86.42140468227424
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.968896321070233
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.254794243982914
 mnt_best       : 30.024605621769005
 not_improved_count: 4
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 2.33809 (QuantReg: 13.28161) QuantErr: 13.28161 batch_time=43.86149 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 2.72081 (QuantReg: 13.35952) QuantErr: 13.35952 batch_time=0.66275 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 3.24566 (QuantReg: 13.21739) QuantErr: 13.21739 batch_time=0.67753 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 2.81265 (QuantReg: 13.30810) QuantErr: 13.30810 batch_time=0.65424 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 3.27249 (QuantReg: 13.08628) QuantErr: 13.08628 batch_time=0.66351 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 3.23111 (QuantReg: 13.03863) QuantErr: 13.03863 batch_time=0.66275 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 3.09564 (QuantReg: 13.18388) QuantErr: 13.18388 batch_time=0.66725 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 2.70580 (QuantReg: 13.31401) QuantErr: 13.31401 batch_time=0.66284 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 2.84391 (QuantReg: 13.37476) QuantErr: 13.37476 batch_time=0.71226 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 2.92589 (QuantReg: 13.21878) QuantErr: 13.21878 batch_time=0.67511 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 2.98916 (QuantReg: 13.39165) QuantErr: 13.39165 batch_time=0.66425 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 3.11452 (QuantReg: 13.30108) QuantErr: 13.30108 batch_time=0.65140 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 3.15775 (QuantReg: 13.39488) QuantErr: 13.39488 batch_time=0.69627 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 3.07096 (QuantReg: 13.50549) QuantErr: 13.50549 batch_time=0.66365 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 3.05082 (QuantReg: 13.39185) QuantErr: 13.39185 batch_time=1.41101 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 3.20273 (QuantReg: 13.29855) QuantErr: 13.29855 batch_time=0.69280 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 2.53346 (QuantReg: 13.37136) QuantErr: 13.37136 batch_time=0.68275 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 2.53435 (QuantReg: 13.47309) QuantErr: 13.47309 batch_time=0.70678 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 2.59066 (QuantReg: 13.57505) QuantErr: 13.57505 batch_time=0.65938 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 2.29340 (QuantReg: 13.29407) QuantErr: 13.29407 batch_time=0.66182 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 3.26787 (QuantReg: 13.33761) QuantErr: 13.33761 batch_time=0.66577 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 2.94106 (QuantReg: 13.19377) QuantErr: 13.19377 batch_time=0.74349 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 2.75243 (QuantReg: 13.02818) QuantErr: 13.02818 batch_time=0.65075 
Train Epoch: 38 codebook_update_time=4.42249
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch38.pth ...
Done in 4.541s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 2.9457830142974855
 quant_reg      : 13.263963302612305
 quant_err      : 13.263963302612305
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.843058350100604
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.8124687512276
 MSRVTT_full_val/v2t_metrics/R1: 40.643863179074444
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.955734406438632
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.59234077899006
 MSRVTT_full_test/t2v_metrics/R1: 13.277591973244148
 MSRVTT_full_test/t2v_metrics/R5: 37.357859531772576
 MSRVTT_full_test/t2v_metrics/R10: 50.16722408026756
 MSRVTT_full_test/t2v_metrics/R50: 81.07023411371237
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.62107023411371
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.19490891612394
 MSRVTT_full_test/v2t_metrics/R1: 16.923076923076923
 MSRVTT_full_test/v2t_metrics/R5: 44.214046822742475
 MSRVTT_full_test/v2t_metrics/R10: 58.62876254180602
 MSRVTT_full_test/v2t_metrics/R50: 86.65551839464882
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.742809364548496
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.26821186440068
 mnt_best       : 30.024605621769005
 not_improved_count: 5
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 2.88505 (QuantReg: 13.50585) QuantErr: 13.50585 batch_time=36.11890 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 2.76047 (QuantReg: 12.97388) QuantErr: 12.97388 batch_time=0.66950 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 2.73806 (QuantReg: 13.14875) QuantErr: 13.14875 batch_time=0.65711 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 2.06134 (QuantReg: 13.32889) QuantErr: 13.32889 batch_time=0.67738 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 2.71070 (QuantReg: 13.58092) QuantErr: 13.58092 batch_time=0.68517 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 3.32818 (QuantReg: 13.39950) QuantErr: 13.39950 batch_time=0.67228 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 3.57902 (QuantReg: 13.58469) QuantErr: 13.58469 batch_time=2.04350 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 2.60699 (QuantReg: 13.07117) QuantErr: 13.07117 batch_time=0.71617 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 2.57188 (QuantReg: 13.36309) QuantErr: 13.36309 batch_time=0.66003 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 2.69925 (QuantReg: 13.13314) QuantErr: 13.13314 batch_time=0.68255 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 2.98386 (QuantReg: 13.51654) QuantErr: 13.51654 batch_time=0.66098 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 2.26181 (QuantReg: 13.36835) QuantErr: 13.36835 batch_time=0.66385 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 2.89776 (QuantReg: 13.18267) QuantErr: 13.18267 batch_time=0.72893 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 2.92622 (QuantReg: 13.23561) QuantErr: 13.23561 batch_time=0.76833 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 2.31246 (QuantReg: 13.67908) QuantErr: 13.67908 batch_time=0.65770 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 3.25415 (QuantReg: 13.31145) QuantErr: 13.31145 batch_time=0.66412 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 2.45301 (QuantReg: 13.32783) QuantErr: 13.32783 batch_time=0.65395 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 2.84387 (QuantReg: 13.41343) QuantErr: 13.41343 batch_time=0.65803 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 3.42067 (QuantReg: 13.22857) QuantErr: 13.22857 batch_time=0.64412 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 4.05915 (QuantReg: 12.90906) QuantErr: 12.90906 batch_time=1.61429 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 3.84900 (QuantReg: 13.31212) QuantErr: 13.31212 batch_time=0.69330 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 2.56721 (QuantReg: 13.42110) QuantErr: 13.42110 batch_time=0.76889 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 3.52139 (QuantReg: 13.27176) QuantErr: 13.27176 batch_time=0.68757 
Train Epoch: 39 codebook_update_time=3.68298
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch39.pth ...
Done in 4.168s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 2.949149191379547
 quant_reg      : 13.274417343139648
 quant_err      : 13.274417343139648
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.016096579476862
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.135090289911815
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.816901408450704
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.833270399033196
 MSRVTT_full_test/t2v_metrics/R1: 12.608695652173912
 MSRVTT_full_test/t2v_metrics/R5: 36.2876254180602
 MSRVTT_full_test/t2v_metrics/R10: 49.76588628762542
 MSRVTT_full_test/t2v_metrics/R50: 80.23411371237458
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.40869565217391
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.34350044079935
 MSRVTT_full_test/v2t_metrics/R1: 16.354515050167223
 MSRVTT_full_test/v2t_metrics/R5: 44.180602006688964
 MSRVTT_full_test/v2t_metrics/R10: 58.19397993311037
 MSRVTT_full_test/v2t_metrics/R50: 86.15384615384616
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.151170568561874
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.77355723357984
 mnt_best       : 30.024605621769005
 not_improved_count: 6
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 2.62403 (QuantReg: 13.12043) QuantErr: 13.12043 batch_time=34.87092 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 3.09686 (QuantReg: 13.11122) QuantErr: 13.11122 batch_time=0.67378 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 2.70711 (QuantReg: 13.43774) QuantErr: 13.43774 batch_time=0.64983 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 3.51599 (QuantReg: 13.36570) QuantErr: 13.36570 batch_time=0.66098 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 2.31569 (QuantReg: 13.37411) QuantErr: 13.37411 batch_time=0.66213 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 2.42087 (QuantReg: 13.54182) QuantErr: 13.54182 batch_time=0.65863 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 2.12929 (QuantReg: 13.46074) QuantErr: 13.46074 batch_time=2.64776 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 3.60516 (QuantReg: 13.43747) QuantErr: 13.43747 batch_time=0.65711 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 2.74238 (QuantReg: 13.52912) QuantErr: 13.52912 batch_time=0.70513 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 2.91408 (QuantReg: 13.09870) QuantErr: 13.09870 batch_time=0.65831 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 3.06813 (QuantReg: 13.19432) QuantErr: 13.19432 batch_time=0.67031 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 2.85556 (QuantReg: 13.36807) QuantErr: 13.36807 batch_time=0.87584 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 2.54197 (QuantReg: 13.17619) QuantErr: 13.17619 batch_time=0.74773 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 2.84093 (QuantReg: 13.07692) QuantErr: 13.07692 batch_time=5.17219 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 3.37169 (QuantReg: 13.26001) QuantErr: 13.26001 batch_time=0.65320 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 3.65744 (QuantReg: 12.94706) QuantErr: 12.94706 batch_time=0.67082 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 2.34269 (QuantReg: 13.52809) QuantErr: 13.52809 batch_time=0.66341 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 3.35958 (QuantReg: 13.23394) QuantErr: 13.23394 batch_time=0.66766 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 2.57219 (QuantReg: 13.16110) QuantErr: 13.16110 batch_time=0.67397 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 2.86233 (QuantReg: 13.45124) QuantErr: 13.45124 batch_time=0.65094 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 3.62468 (QuantReg: 13.25203) QuantErr: 13.25203 batch_time=0.65909 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 3.53428 (QuantReg: 13.10790) QuantErr: 13.10790 batch_time=0.64599 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 2.14777 (QuantReg: 13.50265) QuantErr: 13.50265 batch_time=0.63847 
Train Epoch: 40 codebook_update_time=3.61210
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch40.pth ...
Done in 4.130s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 2.9302579121589662
 quant_reg      : 13.295377449035644
 quant_err      : 13.295377449035644
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.835010060362173
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.8995687291789
 MSRVTT_full_val/v2t_metrics/R1: 40.241448692152915
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.837022132796781
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.10211761095645
 MSRVTT_full_test/t2v_metrics/R1: 13.076923076923077
 MSRVTT_full_test/t2v_metrics/R5: 36.65551839464883
 MSRVTT_full_test/t2v_metrics/R10: 50.468227424749166
 MSRVTT_full_test/t2v_metrics/R50: 80.5351170568562
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.88595317725753
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.921512104373164
 MSRVTT_full_test/v2t_metrics/R1: 16.755852842809364
 MSRVTT_full_test/v2t_metrics/R5: 44.51505016722408
 MSRVTT_full_test/v2t_metrics/R10: 58.929765886287626
 MSRVTT_full_test/v2t_metrics/R50: 86.75585284280936
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.34498327759197
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.29143952874696
 mnt_best       : 30.024605621769005
 not_improved_count: 7
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 2.80587 (QuantReg: 13.25922) QuantErr: 13.25922 batch_time=36.72108 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 2.97194 (QuantReg: 13.29322) QuantErr: 13.29322 batch_time=0.64590 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 2.68309 (QuantReg: 13.49201) QuantErr: 13.49201 batch_time=1.58928 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 2.60076 (QuantReg: 13.42401) QuantErr: 13.42401 batch_time=0.65711 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 2.34341 (QuantReg: 13.45247) QuantErr: 13.45247 batch_time=0.64344 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 3.42755 (QuantReg: 13.30910) QuantErr: 13.30910 batch_time=0.71493 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 2.77213 (QuantReg: 13.24163) QuantErr: 13.24163 batch_time=0.64067 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 2.22627 (QuantReg: 13.41850) QuantErr: 13.41850 batch_time=0.65614 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 2.50539 (QuantReg: 13.52531) QuantErr: 13.52531 batch_time=1.88127 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 3.11504 (QuantReg: 13.29817) QuantErr: 13.29817 batch_time=0.65402 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 2.69503 (QuantReg: 13.46023) QuantErr: 13.46023 batch_time=0.66505 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 2.73165 (QuantReg: 13.59354) QuantErr: 13.59354 batch_time=0.65595 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 3.07351 (QuantReg: 13.46276) QuantErr: 13.46276 batch_time=0.64360 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 2.90401 (QuantReg: 13.57104) QuantErr: 13.57104 batch_time=0.63996 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 4.17894 (QuantReg: 12.89072) QuantErr: 12.89072 batch_time=0.64378 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 2.71550 (QuantReg: 13.24575) QuantErr: 13.24575 batch_time=0.66360 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 2.44328 (QuantReg: 13.66767) QuantErr: 13.66767 batch_time=0.66097 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 2.83563 (QuantReg: 13.14264) QuantErr: 13.14264 batch_time=0.65906 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 3.23328 (QuantReg: 13.33703) QuantErr: 13.33703 batch_time=0.71084 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 2.53519 (QuantReg: 13.48757) QuantErr: 13.48757 batch_time=0.68768 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 2.58009 (QuantReg: 13.23186) QuantErr: 13.23186 batch_time=0.64873 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 3.00391 (QuantReg: 13.26238) QuantErr: 13.26238 batch_time=0.65598 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 2.57946 (QuantReg: 13.52492) QuantErr: 13.52492 batch_time=0.64659 
Train Epoch: 41 codebook_update_time=3.68347
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch41.pth ...
Done in 4.291s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 2.898994542121887
 quant_reg      : 13.315711906433105
 quant_err      : 13.315711906433105
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_full_val/t2v_metrics/R1: 32.59557344064386
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.4124748490945676
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.93248273179899
 MSRVTT_full_val/v2t_metrics/R1: 41.64989939637827
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.871227364185111
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 65.17126850015558
 MSRVTT_full_test/t2v_metrics/R1: 13.7123745819398
 MSRVTT_full_test/t2v_metrics/R5: 37.357859531772576
 MSRVTT_full_test/t2v_metrics/R10: 51.070234113712374
 MSRVTT_full_test/t2v_metrics/R50: 81.47157190635451
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.545484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.686169806271373
 MSRVTT_full_test/v2t_metrics/R1: 16.755852842809364
 MSRVTT_full_test/v2t_metrics/R5: 44.68227424749164
 MSRVTT_full_test/v2t_metrics/R10: 58.69565217391305
 MSRVTT_full_test/v2t_metrics/R50: 86.8561872909699
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.329598662207356
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.28872060576845
 mnt_best       : 30.024605621769005
 not_improved_count: 8
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 2.77046 (QuantReg: 13.32779) QuantErr: 13.32779 batch_time=38.03081 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 3.36021 (QuantReg: 13.16850) QuantErr: 13.16850 batch_time=0.70316 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 2.69107 (QuantReg: 13.16377) QuantErr: 13.16377 batch_time=0.64983 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 2.33866 (QuantReg: 13.36860) QuantErr: 13.36860 batch_time=0.65198 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 2.92096 (QuantReg: 13.36590) QuantErr: 13.36590 batch_time=0.66553 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 3.46739 (QuantReg: 13.19502) QuantErr: 13.19502 batch_time=0.72454 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 2.34584 (QuantReg: 13.25601) QuantErr: 13.25601 batch_time=0.70509 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 2.54982 (QuantReg: 13.42421) QuantErr: 13.42421 batch_time=0.65584 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 3.10297 (QuantReg: 13.06634) QuantErr: 13.06634 batch_time=0.64789 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 2.66700 (QuantReg: 13.46511) QuantErr: 13.46511 batch_time=1.65802 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 2.28649 (QuantReg: 13.40137) QuantErr: 13.40137 batch_time=0.65659 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 2.37705 (QuantReg: 13.53209) QuantErr: 13.53209 batch_time=0.67072 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 2.88811 (QuantReg: 13.14755) QuantErr: 13.14755 batch_time=0.66769 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 3.26546 (QuantReg: 13.11930) QuantErr: 13.11930 batch_time=0.64694 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 2.44112 (QuantReg: 13.52946) QuantErr: 13.52946 batch_time=0.64634 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 3.19980 (QuantReg: 13.29972) QuantErr: 13.29972 batch_time=0.65805 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 2.72291 (QuantReg: 13.41787) QuantErr: 13.41787 batch_time=0.65683 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 3.87905 (QuantReg: 13.38907) QuantErr: 13.38907 batch_time=0.71294 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 2.78625 (QuantReg: 12.90624) QuantErr: 12.90624 batch_time=0.63956 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 2.61981 (QuantReg: 13.26649) QuantErr: 13.26649 batch_time=0.69051 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 2.69165 (QuantReg: 13.30766) QuantErr: 13.30766 batch_time=1.15553 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 2.93562 (QuantReg: 13.42107) QuantErr: 13.42107 batch_time=0.67066 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 2.24956 (QuantReg: 13.35737) QuantErr: 13.35737 batch_time=0.66638 
Train Epoch: 42 codebook_update_time=4.22610
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch42.pth ...
Done in 4.443s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 2.8742743039131167
 quant_reg      : 13.335233158111572
 quant_err      : 13.335233158111572
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_full_val/t2v_metrics/R1: 32.59557344064386
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 98.79275653923541
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.702213279678069
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.58691335922753
 MSRVTT_full_val/v2t_metrics/R1: 39.23541247484909
 MSRVTT_full_val/v2t_metrics/R5: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.782696177062374
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.949235863327395
 MSRVTT_full_test/t2v_metrics/R1: 13.210702341137123
 MSRVTT_full_test/t2v_metrics/R5: 37.82608695652174
 MSRVTT_full_test/t2v_metrics/R10: 51.103678929765884
 MSRVTT_full_test/t2v_metrics/R50: 82.14046822742475
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.705016722408025
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.44804693351011
 MSRVTT_full_test/v2t_metrics/R1: 17.558528428093645
 MSRVTT_full_test/v2t_metrics/R5: 44.98327759197324
 MSRVTT_full_test/v2t_metrics/R10: 59.063545150501675
 MSRVTT_full_test/v2t_metrics/R50: 86.48829431438126
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.157190635451506
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.99865217603018
 mnt_best       : 30.024605621769005
 not_improved_count: 9
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 3.40871 (QuantReg: 13.40930) QuantErr: 13.40930 batch_time=34.46906 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 3.73854 (QuantReg: 13.19447) QuantErr: 13.19447 batch_time=0.67173 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 2.87980 (QuantReg: 13.35111) QuantErr: 13.35111 batch_time=0.67874 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 3.00187 (QuantReg: 13.16480) QuantErr: 13.16480 batch_time=0.86578 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 2.75429 (QuantReg: 13.42971) QuantErr: 13.42971 batch_time=0.81115 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 2.79930 (QuantReg: 13.26587) QuantErr: 13.26587 batch_time=0.71340 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 2.97757 (QuantReg: 13.19401) QuantErr: 13.19401 batch_time=0.77157 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 2.68657 (QuantReg: 13.40716) QuantErr: 13.40716 batch_time=0.66759 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 2.19827 (QuantReg: 13.44482) QuantErr: 13.44482 batch_time=0.67112 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 3.14734 (QuantReg: 13.19843) QuantErr: 13.19843 batch_time=0.66034 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 3.16118 (QuantReg: 13.41872) QuantErr: 13.41872 batch_time=0.65405 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 2.82242 (QuantReg: 13.26223) QuantErr: 13.26223 batch_time=0.66234 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 3.28143 (QuantReg: 13.10429) QuantErr: 13.10429 batch_time=0.66332 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 2.85392 (QuantReg: 13.31212) QuantErr: 13.31212 batch_time=0.66542 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 3.68150 (QuantReg: 13.25616) QuantErr: 13.25616 batch_time=0.64738 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 2.81996 (QuantReg: 13.42288) QuantErr: 13.42288 batch_time=0.72208 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 4.08847 (QuantReg: 13.30396) QuantErr: 13.30396 batch_time=0.65908 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 3.25132 (QuantReg: 13.25654) QuantErr: 13.25654 batch_time=0.66532 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 2.42799 (QuantReg: 13.23184) QuantErr: 13.23184 batch_time=0.64999 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 3.54191 (QuantReg: 13.29732) QuantErr: 13.29732 batch_time=0.67145 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 3.14267 (QuantReg: 13.33494) QuantErr: 13.33494 batch_time=0.76244 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 2.23964 (QuantReg: 13.57838) QuantErr: 13.57838 batch_time=0.66137 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 3.21634 (QuantReg: 13.38639) QuantErr: 13.38639 batch_time=0.67234 
Train Epoch: 43 codebook_update_time=3.83288
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch43.pth ...
Done in 4.283s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 2.8956141862869265
 quant_reg      : 13.325870059967041
 quant_err      : 13.325870059967041
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.806841046277666
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.34434678105842
 MSRVTT_full_val/v2t_metrics/R1: 41.04627766599597
 MSRVTT_full_val/v2t_metrics/R5: 74.64788732394366
 MSRVTT_full_val/v2t_metrics/R10: 86.31790744466801
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.905432595573441
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.18951106840795
 MSRVTT_full_test/t2v_metrics/R1: 12.642140468227424
 MSRVTT_full_test/t2v_metrics/R5: 37.95986622073578
 MSRVTT_full_test/t2v_metrics/R10: 51.50501672240803
 MSRVTT_full_test/t2v_metrics/R50: 81.17056856187291
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.255183946488295
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.129404461092612
 MSRVTT_full_test/v2t_metrics/R1: 16.82274247491639
 MSRVTT_full_test/v2t_metrics/R5: 44.214046822742475
 MSRVTT_full_test/v2t_metrics/R10: 58.82943143812709
 MSRVTT_full_test/v2t_metrics/R50: 86.5551839464883
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.013210702341137
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.23848577977726
 mnt_best       : 30.024605621769005
 not_improved_count: 10
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 2.53997 (QuantReg: 13.10098) QuantErr: 13.10098 batch_time=34.86579 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 2.45769 (QuantReg: 13.45337) QuantErr: 13.45337 batch_time=0.64795 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 2.50734 (QuantReg: 13.52185) QuantErr: 13.52185 batch_time=0.66163 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 2.85336 (QuantReg: 13.12829) QuantErr: 13.12829 batch_time=0.63434 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 2.38569 (QuantReg: 13.42800) QuantErr: 13.42800 batch_time=0.64374 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 2.78000 (QuantReg: 13.35802) QuantErr: 13.35802 batch_time=1.21156 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 2.82630 (QuantReg: 13.39350) QuantErr: 13.39350 batch_time=0.63463 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 3.01128 (QuantReg: 13.39113) QuantErr: 13.39113 batch_time=0.67023 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 3.17231 (QuantReg: 13.36172) QuantErr: 13.36172 batch_time=0.65072 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 2.69238 (QuantReg: 13.10658) QuantErr: 13.10658 batch_time=0.71285 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 2.75669 (QuantReg: 13.34620) QuantErr: 13.34620 batch_time=0.65371 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 2.85671 (QuantReg: 13.18472) QuantErr: 13.18472 batch_time=0.65573 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 2.79522 (QuantReg: 13.32580) QuantErr: 13.32580 batch_time=1.71118 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 2.90349 (QuantReg: 13.51451) QuantErr: 13.51451 batch_time=0.70730 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 2.62209 (QuantReg: 13.39363) QuantErr: 13.39363 batch_time=0.65844 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 3.03447 (QuantReg: 13.50987) QuantErr: 13.50987 batch_time=0.64135 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 2.04136 (QuantReg: 13.43717) QuantErr: 13.43717 batch_time=0.67075 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 2.83108 (QuantReg: 13.51830) QuantErr: 13.51830 batch_time=0.98602 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 3.39610 (QuantReg: 13.49306) QuantErr: 13.49306 batch_time=0.64168 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 2.95663 (QuantReg: 13.21718) QuantErr: 13.21718 batch_time=1.67046 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 2.74076 (QuantReg: 13.43560) QuantErr: 13.43560 batch_time=0.63963 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 3.17907 (QuantReg: 13.34013) QuantErr: 13.34013 batch_time=0.65529 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 2.98339 (QuantReg: 13.10670) QuantErr: 13.10670 batch_time=0.66825 
Train Epoch: 44 codebook_update_time=3.69535
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch44.pth ...
Done in 14.525s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 2.856858383178711
 quant_reg      : 13.355963455200195
 quant_err      : 13.355963455200195
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 70.62374245472837
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.798792756539235
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.315089281694014
 MSRVTT_full_val/v2t_metrics/R1: 41.04627766599597
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.826961770623742
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.51174410614816
 MSRVTT_full_test/t2v_metrics/R1: 12.876254180602007
 MSRVTT_full_test/t2v_metrics/R5: 37.95986622073578
 MSRVTT_full_test/t2v_metrics/R10: 51.37123745819398
 MSRVTT_full_test/t2v_metrics/R50: 81.47157190635451
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.08494983277592
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.28271994007591
 MSRVTT_full_test/v2t_metrics/R1: 16.82274247491639
 MSRVTT_full_test/v2t_metrics/R5: 44.214046822742475
 MSRVTT_full_test/v2t_metrics/R10: 58.79598662207358
 MSRVTT_full_test/v2t_metrics/R50: 86.42140468227424
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.838127090301004
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.23180676411694
 mnt_best       : 30.024605621769005
 not_improved_count: 11
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 3.02036 (QuantReg: 13.14977) QuantErr: 13.14977 batch_time=38.81995 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 2.85154 (QuantReg: 13.27017) QuantErr: 13.27017 batch_time=0.65536 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 2.18203 (QuantReg: 13.44092) QuantErr: 13.44092 batch_time=0.66356 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 3.07556 (QuantReg: 13.43021) QuantErr: 13.43021 batch_time=0.69415 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 2.60667 (QuantReg: 13.19465) QuantErr: 13.19465 batch_time=0.65973 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 3.84180 (QuantReg: 13.29145) QuantErr: 13.29145 batch_time=0.66364 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 2.53465 (QuantReg: 13.52563) QuantErr: 13.52563 batch_time=0.64186 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 3.34273 (QuantReg: 13.11731) QuantErr: 13.11731 batch_time=0.65211 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 3.63555 (QuantReg: 13.08454) QuantErr: 13.08454 batch_time=0.65886 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 2.93459 (QuantReg: 13.54659) QuantErr: 13.54659 batch_time=0.66079 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 2.89726 (QuantReg: 13.37274) QuantErr: 13.37274 batch_time=0.65798 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 3.48528 (QuantReg: 13.47626) QuantErr: 13.47626 batch_time=0.64661 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 2.93245 (QuantReg: 13.42065) QuantErr: 13.42065 batch_time=0.64695 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 3.47592 (QuantReg: 13.26613) QuantErr: 13.26613 batch_time=0.64731 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 3.41499 (QuantReg: 13.21161) QuantErr: 13.21161 batch_time=0.64574 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 2.64390 (QuantReg: 13.51580) QuantErr: 13.51580 batch_time=0.65908 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 2.34644 (QuantReg: 13.37349) QuantErr: 13.37349 batch_time=0.64041 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 3.53325 (QuantReg: 13.19197) QuantErr: 13.19197 batch_time=0.73831 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 2.89442 (QuantReg: 13.10449) QuantErr: 13.10449 batch_time=0.63999 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 3.04372 (QuantReg: 13.26052) QuantErr: 13.26052 batch_time=0.66552 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 2.14162 (QuantReg: 13.43414) QuantErr: 13.43414 batch_time=0.67030 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 2.92510 (QuantReg: 13.33797) QuantErr: 13.33797 batch_time=0.67131 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 2.98583 (QuantReg: 13.29968) QuantErr: 13.29968 batch_time=1.05213 
Train Epoch: 45 codebook_update_time=4.07532
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch45.pth ...
Done in 4.293s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 2.8869185566902162
 quant_reg      : 13.351761444091796
 quant_err      : 13.351761444091796
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_full_val/t2v_metrics/R1: 32.99798792756539
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.054325955734406
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.763878983813555
 MSRVTT_full_val/v2t_metrics/R1: 41.04627766599597
 MSRVTT_full_val/v2t_metrics/R5: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.841046277665996
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.76733753538846
 MSRVTT_full_test/t2v_metrics/R1: 13.34448160535117
 MSRVTT_full_test/t2v_metrics/R5: 37.324414715719065
 MSRVTT_full_test/t2v_metrics/R10: 50.635451505016725
 MSRVTT_full_test/t2v_metrics/R50: 80.8695652173913
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.927090301003346
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.32579539295692
 MSRVTT_full_test/v2t_metrics/R1: 16.555183946488295
 MSRVTT_full_test/v2t_metrics/R5: 45.01672240802676
 MSRVTT_full_test/v2t_metrics/R10: 59.03010033444816
 MSRVTT_full_test/v2t_metrics/R50: 86.68896321070234
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.27892976588629
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.301552164923166
 mnt_best       : 30.024605621769005
 not_improved_count: 12
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 3.09899 (QuantReg: 13.41305) QuantErr: 13.41305 batch_time=36.16004 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 2.46934 (QuantReg: 13.20502) QuantErr: 13.20502 batch_time=0.65573 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 3.21612 (QuantReg: 13.20257) QuantErr: 13.20257 batch_time=0.67194 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 2.23770 (QuantReg: 13.35642) QuantErr: 13.35642 batch_time=0.66980 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 2.81943 (QuantReg: 13.36477) QuantErr: 13.36477 batch_time=0.66841 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 2.37370 (QuantReg: 13.42623) QuantErr: 13.42623 batch_time=0.69247 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 2.16982 (QuantReg: 13.15983) QuantErr: 13.15983 batch_time=5.17669 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 3.22040 (QuantReg: 13.34814) QuantErr: 13.34814 batch_time=0.67053 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 2.38240 (QuantReg: 13.38795) QuantErr: 13.38795 batch_time=0.66739 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 3.35445 (QuantReg: 13.37288) QuantErr: 13.37288 batch_time=0.66319 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 2.37684 (QuantReg: 13.35436) QuantErr: 13.35436 batch_time=0.66331 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 2.37254 (QuantReg: 13.08854) QuantErr: 13.08854 batch_time=0.67279 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 2.57473 (QuantReg: 13.43458) QuantErr: 13.43458 batch_time=0.65505 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 2.98393 (QuantReg: 13.50152) QuantErr: 13.50152 batch_time=0.67316 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 3.01649 (QuantReg: 13.42745) QuantErr: 13.42745 batch_time=0.67439 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 2.69190 (QuantReg: 13.32312) QuantErr: 13.32312 batch_time=0.67942 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 3.49969 (QuantReg: 13.31689) QuantErr: 13.31689 batch_time=0.63593 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 3.15789 (QuantReg: 13.37665) QuantErr: 13.37665 batch_time=0.65812 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 3.10242 (QuantReg: 13.29932) QuantErr: 13.29932 batch_time=0.65561 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 2.21895 (QuantReg: 13.38350) QuantErr: 13.38350 batch_time=0.65021 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 2.44314 (QuantReg: 13.22146) QuantErr: 13.22146 batch_time=0.67124 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 3.34142 (QuantReg: 13.53687) QuantErr: 13.53687 batch_time=0.65980 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 2.57383 (QuantReg: 13.37070) QuantErr: 13.37070 batch_time=0.65282 
Train Epoch: 46 codebook_update_time=3.75092
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch46.pth ...
Done in 17.667s
removing stale ckpt [epoch 45] [took 0.95s]
 epoch          : 46
 loss           : 2.8319335165023802
 quant_reg      : 13.364197513580322
 quant_err      : 13.364197513580322
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.873239436619718
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.457854159469704
 MSRVTT_full_val/v2t_metrics/R1: 40.44265593561368
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.647887323943662
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.57810204162205
 MSRVTT_full_test/t2v_metrics/R1: 13.076923076923077
 MSRVTT_full_test/t2v_metrics/R5: 37.558528428093645
 MSRVTT_full_test/t2v_metrics/R10: 51.23745819397993
 MSRVTT_full_test/t2v_metrics/R50: 81.23745819397993
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.97190635451505
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.304472261256322
 MSRVTT_full_test/v2t_metrics/R1: 16.354515050167223
 MSRVTT_full_test/v2t_metrics/R5: 44.414715719063544
 MSRVTT_full_test/v2t_metrics/R10: 59.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 86.5886287625418
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.236789297658863
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.119492986565255
 mnt_best       : 30.024605621769005
 not_improved_count: 13
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 2.61813 (QuantReg: 13.18000) QuantErr: 13.18000 batch_time=37.73461 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 2.75187 (QuantReg: 13.34682) QuantErr: 13.34682 batch_time=0.69323 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 2.41946 (QuantReg: 13.45304) QuantErr: 13.45304 batch_time=0.64199 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 2.56356 (QuantReg: 13.54907) QuantErr: 13.54907 batch_time=0.65200 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.96109 (QuantReg: 13.42375) QuantErr: 13.42375 batch_time=0.64170 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 2.15985 (QuantReg: 13.36827) QuantErr: 13.36827 batch_time=0.63859 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 3.72467 (QuantReg: 13.21130) QuantErr: 13.21130 batch_time=0.90128 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 3.10828 (QuantReg: 13.24216) QuantErr: 13.24216 batch_time=0.64320 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 3.10687 (QuantReg: 13.64632) QuantErr: 13.64632 batch_time=0.66318 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 2.23350 (QuantReg: 13.18380) QuantErr: 13.18380 batch_time=0.64115 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 2.98407 (QuantReg: 13.45087) QuantErr: 13.45087 batch_time=0.65273 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 3.41716 (QuantReg: 13.08475) QuantErr: 13.08475 batch_time=0.63981 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 2.84299 (QuantReg: 13.25980) QuantErr: 13.25980 batch_time=0.66898 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 2.52861 (QuantReg: 13.37215) QuantErr: 13.37215 batch_time=0.72807 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 2.44378 (QuantReg: 13.26742) QuantErr: 13.26742 batch_time=0.66485 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 2.44100 (QuantReg: 13.22938) QuantErr: 13.22938 batch_time=0.65945 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 3.56848 (QuantReg: 13.55575) QuantErr: 13.55575 batch_time=0.71230 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 2.49388 (QuantReg: 13.51856) QuantErr: 13.51856 batch_time=0.64890 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 3.46628 (QuantReg: 13.41359) QuantErr: 13.41359 batch_time=0.63377 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 2.76906 (QuantReg: 13.41872) QuantErr: 13.41872 batch_time=0.67835 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 2.84754 (QuantReg: 13.07910) QuantErr: 13.07910 batch_time=0.66625 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 2.94076 (QuantReg: 13.47734) QuantErr: 13.47734 batch_time=0.65880 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 2.46964 (QuantReg: 13.21376) QuantErr: 13.21376 batch_time=0.63857 
Train Epoch: 47 codebook_update_time=3.88091
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch47.pth ...
Done in 4.065s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 2.8681862282752992
 quant_reg      : 13.368238662719726
 quant_err      : 13.368238662719726
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 70.62374245472837
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.54728370221328
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.22064450494144
 MSRVTT_full_val/v2t_metrics/R1: 42.857142857142854
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.92756539235413
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.682092555331992
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 66.27875870635184
 MSRVTT_full_test/t2v_metrics/R1: 12.976588628762542
 MSRVTT_full_test/t2v_metrics/R5: 37.92642140468227
 MSRVTT_full_test/t2v_metrics/R10: 52.04013377926422
 MSRVTT_full_test/t2v_metrics/R50: 81.33779264214047
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.02842809364549
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.476795555646255
 MSRVTT_full_test/v2t_metrics/R1: 16.153846153846153
 MSRVTT_full_test/v2t_metrics/R5: 44.98327759197324
 MSRVTT_full_test/v2t_metrics/R10: 59.59866220735786
 MSRVTT_full_test/v2t_metrics/R50: 86.5551839464883
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.368227424749165
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.117305301634545
 mnt_best       : 30.024605621769005
 not_improved_count: 14
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 2.92632 (QuantReg: 13.25015) QuantErr: 13.25015 batch_time=33.93518 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 2.87953 (QuantReg: 13.30521) QuantErr: 13.30521 batch_time=1.07775 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 2.36343 (QuantReg: 13.46111) QuantErr: 13.46111 batch_time=0.66177 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 3.07215 (QuantReg: 13.34995) QuantErr: 13.34995 batch_time=0.63775 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 3.44168 (QuantReg: 13.71957) QuantErr: 13.71957 batch_time=0.64018 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 3.11077 (QuantReg: 13.07569) QuantErr: 13.07569 batch_time=0.64156 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 2.95932 (QuantReg: 13.45779) QuantErr: 13.45779 batch_time=0.66376 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 2.49727 (QuantReg: 13.56856) QuantErr: 13.56856 batch_time=0.67058 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 3.19272 (QuantReg: 13.23433) QuantErr: 13.23433 batch_time=0.65216 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 2.92275 (QuantReg: 13.28051) QuantErr: 13.28051 batch_time=0.64396 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 2.78533 (QuantReg: 13.54978) QuantErr: 13.54978 batch_time=1.26555 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 2.56902 (QuantReg: 13.10330) QuantErr: 13.10330 batch_time=0.66981 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 3.57148 (QuantReg: 13.37709) QuantErr: 13.37709 batch_time=0.65068 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 3.09592 (QuantReg: 13.44690) QuantErr: 13.44690 batch_time=0.69120 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 2.90224 (QuantReg: 13.50438) QuantErr: 13.50438 batch_time=3.58641 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 2.78890 (QuantReg: 13.24611) QuantErr: 13.24611 batch_time=0.67018 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 3.00740 (QuantReg: 13.36748) QuantErr: 13.36748 batch_time=0.67016 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 2.87584 (QuantReg: 13.38650) QuantErr: 13.38650 batch_time=0.64911 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 3.34755 (QuantReg: 13.15900) QuantErr: 13.15900 batch_time=0.65373 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 2.77848 (QuantReg: 13.53477) QuantErr: 13.53477 batch_time=0.64426 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 2.91830 (QuantReg: 13.32721) QuantErr: 13.32721 batch_time=0.68451 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 2.90408 (QuantReg: 13.38555) QuantErr: 13.38555 batch_time=0.65891 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 2.83611 (QuantReg: 13.22914) QuantErr: 13.22914 batch_time=0.67197 
Train Epoch: 48 codebook_update_time=4.81442
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch48.pth ...
Done in 4.091s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 2.849870138168335
 quant_reg      : 13.399060283660889
 quant_err      : 13.399060283660889
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.871227364185111
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.19184800245736
 MSRVTT_full_val/v2t_metrics/R1: 40.241448692152915
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.901408450704225
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.42127440336373
 MSRVTT_full_test/t2v_metrics/R1: 13.612040133779264
 MSRVTT_full_test/t2v_metrics/R5: 37.792642140468224
 MSRVTT_full_test/t2v_metrics/R10: 52.17391304347826
 MSRVTT_full_test/t2v_metrics/R50: 81.27090301003345
 MSRVTT_full_test/t2v_metrics/MedR: 9.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.724414715719064
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.940654887059562
 MSRVTT_full_test/v2t_metrics/R1: 16.755852842809364
 MSRVTT_full_test/v2t_metrics/R5: 45.08361204013378
 MSRVTT_full_test/v2t_metrics/R10: 58.862876254180605
 MSRVTT_full_test/v2t_metrics/R50: 86.82274247491638
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.687290969899667
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.42764141799036
 mnt_best       : 30.024605621769005
 not_improved_count: 15
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 2.96172 (QuantReg: 13.49754) QuantErr: 13.49754 batch_time=38.82885 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 2.62094 (QuantReg: 13.57031) QuantErr: 13.57031 batch_time=0.64576 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 2.96601 (QuantReg: 13.46678) QuantErr: 13.46678 batch_time=0.63818 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 2.39856 (QuantReg: 13.34814) QuantErr: 13.34814 batch_time=0.69352 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 2.53959 (QuantReg: 13.58231) QuantErr: 13.58231 batch_time=0.66781 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 2.41304 (QuantReg: 13.52355) QuantErr: 13.52355 batch_time=0.67820 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 2.66197 (QuantReg: 13.45697) QuantErr: 13.45697 batch_time=0.67363 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 3.12840 (QuantReg: 13.28833) QuantErr: 13.28833 batch_time=0.63900 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 2.55586 (QuantReg: 13.52151) QuantErr: 13.52151 batch_time=0.66145 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 2.72251 (QuantReg: 13.46391) QuantErr: 13.46391 batch_time=0.66292 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 2.40860 (QuantReg: 13.44505) QuantErr: 13.44505 batch_time=0.66033 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 3.44957 (QuantReg: 13.16035) QuantErr: 13.16035 batch_time=0.65231 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 3.27806 (QuantReg: 13.48150) QuantErr: 13.48150 batch_time=2.11120 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 2.97851 (QuantReg: 13.35521) QuantErr: 13.35521 batch_time=0.66082 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 2.88862 (QuantReg: 13.35377) QuantErr: 13.35377 batch_time=0.65915 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 3.18541 (QuantReg: 13.48981) QuantErr: 13.48981 batch_time=0.65235 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 2.59984 (QuantReg: 13.21002) QuantErr: 13.21002 batch_time=0.65121 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 3.28314 (QuantReg: 13.39724) QuantErr: 13.39724 batch_time=0.66469 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 2.93977 (QuantReg: 13.47143) QuantErr: 13.47143 batch_time=0.66388 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 2.75948 (QuantReg: 13.47049) QuantErr: 13.47049 batch_time=0.69406 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 3.44424 (QuantReg: 13.39062) QuantErr: 13.39062 batch_time=1.30401 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 3.35375 (QuantReg: 13.32462) QuantErr: 13.32462 batch_time=0.63529 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 3.37475 (QuantReg: 13.30971) QuantErr: 13.30971 batch_time=0.67273 
Train Epoch: 49 codebook_update_time=4.25345
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch49.pth ...
Done in 19.754s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 2.8448729934692385
 quant_reg      : 13.393176677703858
 quant_err      : 13.393176677703858
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.688128772635815
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.36678826883543
 MSRVTT_full_val/v2t_metrics/R1: 40.643863179074444
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.943661971830986
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.44833242670528
 MSRVTT_full_test/t2v_metrics/R1: 13.545150501672241
 MSRVTT_full_test/t2v_metrics/R5: 37.792642140468224
 MSRVTT_full_test/t2v_metrics/R10: 50.903010033444815
 MSRVTT_full_test/t2v_metrics/R50: 81.63879598662207
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.478595317725755
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.646824652210796
 MSRVTT_full_test/v2t_metrics/R1: 17.123745819397993
 MSRVTT_full_test/v2t_metrics/R5: 44.48160535117057
 MSRVTT_full_test/v2t_metrics/R10: 58.99665551839465
 MSRVTT_full_test/v2t_metrics/R50: 86.72240802675586
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.264548494983277
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.55239582940752
 mnt_best       : 30.024605621769005
 not_improved_count: 16
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 3.03456 (QuantReg: 13.54459) QuantErr: 13.54459 batch_time=32.41765 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 2.99620 (QuantReg: 13.27767) QuantErr: 13.27767 batch_time=0.76071 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 2.13307 (QuantReg: 13.39747) QuantErr: 13.39747 batch_time=0.65603 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 2.68815 (QuantReg: 13.28161) QuantErr: 13.28161 batch_time=0.95618 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 4.07734 (QuantReg: 13.66031) QuantErr: 13.66031 batch_time=0.64027 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 2.17945 (QuantReg: 13.51157) QuantErr: 13.51157 batch_time=0.65069 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 3.50323 (QuantReg: 13.40705) QuantErr: 13.40705 batch_time=0.65478 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 2.09298 (QuantReg: 13.40188) QuantErr: 13.40188 batch_time=0.64696 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 2.13967 (QuantReg: 13.32129) QuantErr: 13.32129 batch_time=0.98093 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 2.50853 (QuantReg: 13.07583) QuantErr: 13.07583 batch_time=0.64669 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 2.70316 (QuantReg: 13.31375) QuantErr: 13.31375 batch_time=0.65649 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 2.14611 (QuantReg: 13.38872) QuantErr: 13.38872 batch_time=0.64789 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 3.39486 (QuantReg: 13.38330) QuantErr: 13.38330 batch_time=0.63915 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 3.02690 (QuantReg: 13.22681) QuantErr: 13.22681 batch_time=1.41415 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 2.83186 (QuantReg: 13.29512) QuantErr: 13.29512 batch_time=0.66287 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 3.50080 (QuantReg: 13.42631) QuantErr: 13.42631 batch_time=0.65515 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 3.28683 (QuantReg: 13.21097) QuantErr: 13.21097 batch_time=0.68704 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 2.20337 (QuantReg: 13.42661) QuantErr: 13.42661 batch_time=0.67369 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 2.60566 (QuantReg: 13.46464) QuantErr: 13.46464 batch_time=0.65477 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 3.75323 (QuantReg: 13.21085) QuantErr: 13.21085 batch_time=0.66509 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 2.96634 (QuantReg: 13.22528) QuantErr: 13.22528 batch_time=0.90150 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 2.36796 (QuantReg: 13.46711) QuantErr: 13.46711 batch_time=0.92587 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 2.49637 (QuantReg: 13.33602) QuantErr: 13.33602 batch_time=0.68356 
Train Epoch: 50 codebook_update_time=4.12998
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/checkpoint-epoch50.pth ...
Done in 15.978s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 2.826349497795105
 quant_reg      : 13.41968867111206
 quant_err      : 13.41968867111206
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.9738430583501
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.02382400970578
 MSRVTT_full_val/v2t_metrics/R1: 39.436619718309856
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.921529175050302
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.74793565411443
 MSRVTT_full_test/t2v_metrics/R1: 13.34448160535117
 MSRVTT_full_test/t2v_metrics/R5: 37.123745819397996
 MSRVTT_full_test/t2v_metrics/R10: 51.33779264214047
 MSRVTT_full_test/t2v_metrics/R50: 81.43812709030101
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.355183946488296
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.407869541576403
 MSRVTT_full_test/v2t_metrics/R1: 16.287625418060202
 MSRVTT_full_test/v2t_metrics/R5: 43.64548494983278
 MSRVTT_full_test/v2t_metrics/R10: 59.531772575250834
 MSRVTT_full_test/v2t_metrics/R50: 86.92307692307692
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.3438127090301
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.848329950370704
 mnt_best       : 30.024605621769005
 not_improved_count: 17
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/trained_model.pth ...
Ckpt loaded at epoch 33.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 14.013377926421406
 t2v_metrics/R5/final_eval: 37.525083612040135
 t2v_metrics/R10/final_eval: 51.47157190635451
 t2v_metrics/R50/final_eval: 81.73913043478261
 t2v_metrics/MedR/final_eval: 10.0
 t2v_metrics/MeanR/final_eval: 41.03879598662208
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 30.024605621769005
 v2t_metrics/R1/final_eval: 16.187290969899667
 v2t_metrics/R5/final_eval: 44.080267558528426
 v2t_metrics/R10/final_eval: 59.79933110367893
 v2t_metrics/R50/final_eval: 86.98996655518394
 v2t_metrics/MedR/final_eval: 7.0
 v2t_metrics/MeanR/final_eval: 29.86521739130435
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 34.94391608738811
Best epoch for the monitored metric: 33
Script took 04h57m46s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_L15/trained_model.pth
