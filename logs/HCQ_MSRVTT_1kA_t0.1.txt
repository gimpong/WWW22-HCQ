Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 580.3060283660889 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 65.0928795337677 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 49.843714475631714 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch0.pth ...
Done in 1.351s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch0.pth ...
Done in 2.713s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 486.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 496.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 6.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 509.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.537
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.5192494101851104
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.72864 (QuantReg: 22.50035) QuantErr: 22.50035 batch_time=22.11962 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.86061 (QuantReg: 22.54588) QuantErr: 22.54588 batch_time=2.04117 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.64189 (QuantReg: 22.61770) QuantErr: 22.61770 batch_time=0.52358 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.60854 (QuantReg: 22.64102) QuantErr: 22.64102 batch_time=0.49055 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.68131 (QuantReg: 22.60759) QuantErr: 22.60759 batch_time=0.53055 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 5.95207 (QuantReg: 22.64045) QuantErr: 22.64045 batch_time=0.50141 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.95502 (QuantReg: 22.56469) QuantErr: 22.56469 batch_time=0.48731 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.41967 (QuantReg: 22.62769) QuantErr: 22.62769 batch_time=4.00723 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.83567 (QuantReg: 22.62117) QuantErr: 22.62117 batch_time=0.52938 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.71617 (QuantReg: 22.64704) QuantErr: 22.64704 batch_time=0.49819 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 4.95678 (QuantReg: 22.59793) QuantErr: 22.59793 batch_time=0.49593 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 5.11035 (QuantReg: 22.62016) QuantErr: 22.62016 batch_time=0.48839 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.43605 (QuantReg: 22.58220) QuantErr: 22.58220 batch_time=0.51601 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.77678 (QuantReg: 22.63476) QuantErr: 22.63476 batch_time=0.50135 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 5.05562 (QuantReg: 22.59694) QuantErr: 22.59694 batch_time=0.48688 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.56300 (QuantReg: 22.59225) QuantErr: 22.59225 batch_time=0.49077 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 5.10718 (QuantReg: 22.60695) QuantErr: 22.60695 batch_time=0.49167 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.85250 (QuantReg: 22.63480) QuantErr: 22.63480 batch_time=0.56775 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.41987 (QuantReg: 22.60013) QuantErr: 22.60013 batch_time=0.49231 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.74180 (QuantReg: 22.60040) QuantErr: 22.60040 batch_time=0.49168 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.04404 (QuantReg: 22.64661) QuantErr: 22.64661 batch_time=0.48757 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.60436 (QuantReg: 22.61704) QuantErr: 22.61704 batch_time=0.50754 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 4.06083 (QuantReg: 22.62713) QuantErr: 22.62713 batch_time=0.50419 
Train Epoch: 1 codebook_update_time=1.96918
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch1.pth ...
Done in 3.953s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch1.pth ...
Done in 7.723s
 epoch          : 1
 loss           : 5.663895118713379
 quant_reg      : 22.609122581481934
 quant_err      : 22.609122581481934
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 29.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 43.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 76.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 45.172
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.051837083783767
 MSRVTT_jsfusion_test/v2t_metrics/R1: 9.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 31.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 43.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 78.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 14.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 44.163
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.71693141099112
 mnt_best       : 23.051837083783767
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.46940 (QuantReg: 10.86223) QuantErr: 10.86223 batch_time=38.72787 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.27772 (QuantReg: 10.91354) QuantErr: 10.91354 batch_time=0.50085 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.36496 (QuantReg: 11.35099) QuantErr: 11.35099 batch_time=0.51473 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 4.24285 (QuantReg: 11.16632) QuantErr: 11.16632 batch_time=0.49120 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 4.33462 (QuantReg: 11.80266) QuantErr: 11.80266 batch_time=0.48644 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 4.34793 (QuantReg: 11.64189) QuantErr: 11.64189 batch_time=0.48990 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.11213 (QuantReg: 11.64567) QuantErr: 11.64567 batch_time=0.49327 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 4.32143 (QuantReg: 11.84380) QuantErr: 11.84380 batch_time=0.49913 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 4.02476 (QuantReg: 12.07098) QuantErr: 12.07098 batch_time=0.50578 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.61000 (QuantReg: 11.94986) QuantErr: 11.94986 batch_time=0.49530 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 4.06172 (QuantReg: 11.73707) QuantErr: 11.73707 batch_time=0.50625 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.81086 (QuantReg: 12.27945) QuantErr: 12.27945 batch_time=0.48795 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 4.04186 (QuantReg: 11.94534) QuantErr: 11.94534 batch_time=0.49434 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.46046 (QuantReg: 12.17510) QuantErr: 12.17510 batch_time=0.49717 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 4.34639 (QuantReg: 12.02823) QuantErr: 12.02823 batch_time=0.51608 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.96196 (QuantReg: 12.57843) QuantErr: 12.57843 batch_time=0.49779 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 4.26900 (QuantReg: 12.45613) QuantErr: 12.45613 batch_time=0.49432 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 4.02385 (QuantReg: 12.51158) QuantErr: 12.51158 batch_time=0.48752 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.76392 (QuantReg: 12.69954) QuantErr: 12.69954 batch_time=0.49539 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.76611 (QuantReg: 12.39642) QuantErr: 12.39642 batch_time=0.49920 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.85370 (QuantReg: 12.56629) QuantErr: 12.56629 batch_time=0.49037 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 4.01635 (QuantReg: 12.64751) QuantErr: 12.64751 batch_time=0.53676 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 4.11317 (QuantReg: 12.73294) QuantErr: 12.73294 batch_time=0.48627 
Train Epoch: 2 codebook_update_time=1.65689
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch2.pth ...
Done in 3.829s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch2.pth ...
Done in 7.560s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 4.116101954460144
 quant_reg      : 12.002482055664062
 quant_err      : 12.002482055664062
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 36.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 82.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 37.039
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.46320274117325
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 37.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 52.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 81.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 36.162
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.238325386929816
 mnt_best       : 28.46320274117325
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.83240 (QuantReg: 10.22933) QuantErr: 10.22933 batch_time=30.13282 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.70056 (QuantReg: 10.24414) QuantErr: 10.24414 batch_time=0.49743 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.65039 (QuantReg: 10.31859) QuantErr: 10.31859 batch_time=0.49127 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 3.50884 (QuantReg: 10.16239) QuantErr: 10.16239 batch_time=0.49027 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 3.47312 (QuantReg: 10.34955) QuantErr: 10.34955 batch_time=0.49189 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 2.94839 (QuantReg: 9.89073) QuantErr: 9.89073 batch_time=0.49423 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 4.16334 (QuantReg: 10.57747) QuantErr: 10.57747 batch_time=0.51448 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.94964 (QuantReg: 10.36439) QuantErr: 10.36439 batch_time=0.49239 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.89070 (QuantReg: 10.44915) QuantErr: 10.44915 batch_time=0.48424 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 3.22798 (QuantReg: 10.56716) QuantErr: 10.56716 batch_time=0.47793 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.67764 (QuantReg: 10.28881) QuantErr: 10.28881 batch_time=0.47769 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.60479 (QuantReg: 10.28554) QuantErr: 10.28554 batch_time=0.49121 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 3.35686 (QuantReg: 10.13151) QuantErr: 10.13151 batch_time=0.49282 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.63934 (QuantReg: 10.32685) QuantErr: 10.32685 batch_time=0.82457 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.97062 (QuantReg: 9.97324) QuantErr: 9.97324 batch_time=0.48843 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 3.35433 (QuantReg: 10.23594) QuantErr: 10.23594 batch_time=0.50344 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.72913 (QuantReg: 10.59612) QuantErr: 10.59612 batch_time=0.81510 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.62170 (QuantReg: 10.68999) QuantErr: 10.68999 batch_time=0.62583 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.36511 (QuantReg: 10.55196) QuantErr: 10.55196 batch_time=0.48970 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.46933 (QuantReg: 10.64839) QuantErr: 10.64839 batch_time=2.68237 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.41722 (QuantReg: 10.34787) QuantErr: 10.34787 batch_time=0.49211 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.50849 (QuantReg: 10.89046) QuantErr: 10.89046 batch_time=0.48387 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.59092 (QuantReg: 10.92802) QuantErr: 10.92802 batch_time=0.48653 
Train Epoch: 3 codebook_update_time=2.04356
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch3.pth ...
Done in 3.974s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch3.pth ...
Done in 7.679s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 3.6068576641082766
 quant_reg      : 10.399535919189454
 quant_err      : 10.399535919189454
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 38.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 84.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.911
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.950283124694202
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.4475
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.10901362090149
 mnt_best       : 30.950283124694202
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 3.50324 (QuantReg: 9.94679) QuantErr: 9.94679 batch_time=30.70904 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 3.33671 (QuantReg: 9.67413) QuantErr: 9.67413 batch_time=0.49112 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 3.43165 (QuantReg: 9.87329) QuantErr: 9.87329 batch_time=0.49221 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 3.30565 (QuantReg: 9.95428) QuantErr: 9.95428 batch_time=0.50202 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 3.24870 (QuantReg: 9.99899) QuantErr: 9.99899 batch_time=0.50269 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.41778 (QuantReg: 9.78777) QuantErr: 9.78777 batch_time=0.52077 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 3.13041 (QuantReg: 9.69898) QuantErr: 9.69898 batch_time=0.60303 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 3.34425 (QuantReg: 10.06032) QuantErr: 10.06032 batch_time=0.49697 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 3.46784 (QuantReg: 9.82000) QuantErr: 9.82000 batch_time=0.51102 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.93857 (QuantReg: 9.94440) QuantErr: 9.94440 batch_time=0.53095 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 3.30972 (QuantReg: 10.38466) QuantErr: 10.38466 batch_time=0.52912 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 3.04727 (QuantReg: 10.50649) QuantErr: 10.50649 batch_time=0.76014 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.50061 (QuantReg: 9.94403) QuantErr: 9.94403 batch_time=0.54207 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 3.16112 (QuantReg: 10.19647) QuantErr: 10.19647 batch_time=0.49334 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 3.24569 (QuantReg: 10.03594) QuantErr: 10.03594 batch_time=0.49811 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 3.30750 (QuantReg: 9.87351) QuantErr: 9.87351 batch_time=0.49647 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 3.20334 (QuantReg: 9.90902) QuantErr: 9.90902 batch_time=0.49277 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 3.29682 (QuantReg: 10.04535) QuantErr: 10.04535 batch_time=0.50072 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 3.11456 (QuantReg: 10.51437) QuantErr: 10.51437 batch_time=0.59659 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.91948 (QuantReg: 9.88520) QuantErr: 9.88520 batch_time=0.48843 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.77324 (QuantReg: 10.32974) QuantErr: 10.32974 batch_time=0.50303 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.77930 (QuantReg: 10.36792) QuantErr: 10.36792 batch_time=0.49099 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 3.35477 (QuantReg: 10.03122) QuantErr: 10.03122 batch_time=0.50103 
Train Epoch: 4 codebook_update_time=1.62712
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch4.pth ...
Done in 3.492s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch4.pth ...
Done in 6.939s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 3.3383344812393188
 quant_reg      : 9.977731983184814
 quant_err      : 9.977731983184814
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.846
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.639069338644518
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.5875
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.740157642114326
 mnt_best       : 31.639069338644518
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 3.14830 (QuantReg: 9.41833) QuantErr: 9.41833 batch_time=29.80333 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.52173 (QuantReg: 9.85665) QuantErr: 9.85665 batch_time=0.51369 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.78275 (QuantReg: 9.28660) QuantErr: 9.28660 batch_time=0.51251 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 3.11033 (QuantReg: 9.93257) QuantErr: 9.93257 batch_time=0.49030 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 3.25154 (QuantReg: 9.48491) QuantErr: 9.48491 batch_time=0.48996 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.96880 (QuantReg: 9.94692) QuantErr: 9.94692 batch_time=0.52163 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 3.12894 (QuantReg: 9.42271) QuantErr: 9.42271 batch_time=0.51311 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 3.58075 (QuantReg: 9.43358) QuantErr: 9.43358 batch_time=0.51356 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 3.11928 (QuantReg: 10.07358) QuantErr: 10.07358 batch_time=2.19666 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 3.09499 (QuantReg: 9.68175) QuantErr: 9.68175 batch_time=0.49090 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 3.07181 (QuantReg: 9.80957) QuantErr: 9.80957 batch_time=0.53847 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 3.06838 (QuantReg: 9.57728) QuantErr: 9.57728 batch_time=0.49265 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.94772 (QuantReg: 10.10006) QuantErr: 10.10006 batch_time=1.49301 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.67988 (QuantReg: 9.62407) QuantErr: 9.62407 batch_time=0.50160 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 3.45801 (QuantReg: 10.03938) QuantErr: 10.03938 batch_time=0.50913 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.88268 (QuantReg: 9.95325) QuantErr: 9.95325 batch_time=0.51005 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 3.26959 (QuantReg: 9.80315) QuantErr: 9.80315 batch_time=0.54445 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 3.17817 (QuantReg: 9.78887) QuantErr: 9.78887 batch_time=0.50211 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 3.05656 (QuantReg: 10.03403) QuantErr: 10.03403 batch_time=0.48499 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 3.02377 (QuantReg: 9.56311) QuantErr: 9.56311 batch_time=0.49600 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 3.28042 (QuantReg: 9.98679) QuantErr: 9.98679 batch_time=0.49576 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.91465 (QuantReg: 9.58417) QuantErr: 9.58417 batch_time=0.49492 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 3.27439 (QuantReg: 10.06102) QuantErr: 10.06102 batch_time=0.50187 
Train Epoch: 5 codebook_update_time=1.95443
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch5.pth ...
Done in 3.814s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch5.pth ...
Done in 7.650s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 3.0971610994338987
 quant_reg      : 9.785357196807862
 quant_err      : 9.785357196807862
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.451
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.81473810936049
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.6115
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.71628849720981
 mnt_best       : 34.81473810936049
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 3.19242 (QuantReg: 9.63910) QuantErr: 9.63910 batch_time=30.58430 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 3.03627 (QuantReg: 9.18069) QuantErr: 9.18069 batch_time=0.48443 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 3.10491 (QuantReg: 9.42623) QuantErr: 9.42623 batch_time=0.48509 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 3.02023 (QuantReg: 9.59474) QuantErr: 9.59474 batch_time=0.49440 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 3.04169 (QuantReg: 9.44382) QuantErr: 9.44382 batch_time=0.49112 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.76882 (QuantReg: 9.43145) QuantErr: 9.43145 batch_time=0.47997 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 3.11898 (QuantReg: 9.85089) QuantErr: 9.85089 batch_time=2.08841 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.89750 (QuantReg: 9.67994) QuantErr: 9.67994 batch_time=0.52669 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.94661 (QuantReg: 9.67858) QuantErr: 9.67858 batch_time=1.01307 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.88180 (QuantReg: 9.38548) QuantErr: 9.38548 batch_time=0.51711 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.78970 (QuantReg: 10.10207) QuantErr: 10.10207 batch_time=0.48739 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.89566 (QuantReg: 9.58099) QuantErr: 9.58099 batch_time=0.50003 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.76434 (QuantReg: 9.60081) QuantErr: 9.60081 batch_time=0.49116 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.80948 (QuantReg: 9.66283) QuantErr: 9.66283 batch_time=0.49524 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 3.27386 (QuantReg: 9.88485) QuantErr: 9.88485 batch_time=0.49933 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.98981 (QuantReg: 9.91644) QuantErr: 9.91644 batch_time=0.75296 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.64511 (QuantReg: 9.94577) QuantErr: 9.94577 batch_time=0.49283 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 3.06818 (QuantReg: 9.61636) QuantErr: 9.61636 batch_time=0.49318 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 3.10139 (QuantReg: 9.88909) QuantErr: 9.88909 batch_time=0.49112 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.93314 (QuantReg: 9.78315) QuantErr: 9.78315 batch_time=1.02790 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.69122 (QuantReg: 9.72777) QuantErr: 9.72777 batch_time=0.49884 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.65570 (QuantReg: 9.47333) QuantErr: 9.47333 batch_time=0.49540 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.60243 (QuantReg: 9.76058) QuantErr: 9.76058 batch_time=0.49203 
Train Epoch: 6 codebook_update_time=1.73493
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch6.pth ...
Done in 3.791s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch6.pth ...
Done in 7.532s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 2.9326532077789307
 quant_reg      : 9.70142077255249
 quant_err      : 9.70142077255249
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.763000000000005
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.38471788686317
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.713
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.37631041204469
 mnt_best       : 35.38471788686317
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.83880 (QuantReg: 9.18692) QuantErr: 9.18692 batch_time=29.86332 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.90276 (QuantReg: 9.47926) QuantErr: 9.47926 batch_time=0.52197 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.84201 (QuantReg: 9.21509) QuantErr: 9.21509 batch_time=0.49985 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.57911 (QuantReg: 9.51920) QuantErr: 9.51920 batch_time=0.48829 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.53867 (QuantReg: 9.45364) QuantErr: 9.45364 batch_time=1.24061 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.58127 (QuantReg: 9.65558) QuantErr: 9.65558 batch_time=0.49448 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.85877 (QuantReg: 9.88630) QuantErr: 9.88630 batch_time=1.16467 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.76005 (QuantReg: 9.74204) QuantErr: 9.74204 batch_time=0.50279 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.80723 (QuantReg: 9.90124) QuantErr: 9.90124 batch_time=0.48816 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.44116 (QuantReg: 9.59467) QuantErr: 9.59467 batch_time=0.49076 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 3.21275 (QuantReg: 9.84635) QuantErr: 9.84635 batch_time=0.50068 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.85899 (QuantReg: 9.65301) QuantErr: 9.65301 batch_time=0.49457 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.64719 (QuantReg: 9.60212) QuantErr: 9.60212 batch_time=0.48299 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.78005 (QuantReg: 9.43339) QuantErr: 9.43339 batch_time=1.61390 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.38550 (QuantReg: 9.44075) QuantErr: 9.44075 batch_time=1.41016 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.95449 (QuantReg: 9.60253) QuantErr: 9.60253 batch_time=0.48273 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 2.36094 (QuantReg: 9.72150) QuantErr: 9.72150 batch_time=0.61092 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.70890 (QuantReg: 9.33549) QuantErr: 9.33549 batch_time=0.48530 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 2.26723 (QuantReg: 9.70781) QuantErr: 9.70781 batch_time=0.48618 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.93541 (QuantReg: 9.81332) QuantErr: 9.81332 batch_time=0.48061 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.78007 (QuantReg: 9.85630) QuantErr: 9.85630 batch_time=0.54903 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.65252 (QuantReg: 10.34734) QuantErr: 10.34734 batch_time=0.50183 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.72946 (QuantReg: 9.86432) QuantErr: 9.86432 batch_time=0.50082 
Train Epoch: 7 codebook_update_time=1.64240
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch7.pth ...
Done in 3.535s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch7.pth ...
Done in 7.100s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 2.7711694765090944
 quant_reg      : 9.641656204223633
 quant_err      : 9.641656204223633
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.565
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.47067137970474
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.4675
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.5744582834143
 mnt_best       : 36.47067137970474
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.81027 (QuantReg: 9.31973) QuantErr: 9.31973 batch_time=33.75843 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 3.01110 (QuantReg: 9.41481) QuantErr: 9.41481 batch_time=0.48920 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 3.27391 (QuantReg: 9.70032) QuantErr: 9.70032 batch_time=0.48062 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.72711 (QuantReg: 9.34221) QuantErr: 9.34221 batch_time=0.48887 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.90792 (QuantReg: 9.86984) QuantErr: 9.86984 batch_time=0.49438 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.53216 (QuantReg: 9.14048) QuantErr: 9.14048 batch_time=0.48563 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.72600 (QuantReg: 9.71461) QuantErr: 9.71461 batch_time=0.49060 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.91482 (QuantReg: 9.71495) QuantErr: 9.71495 batch_time=0.49295 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.83563 (QuantReg: 9.48641) QuantErr: 9.48641 batch_time=0.48799 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.97491 (QuantReg: 9.68197) QuantErr: 9.68197 batch_time=0.48575 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 3.01283 (QuantReg: 9.90831) QuantErr: 9.90831 batch_time=0.52762 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.63054 (QuantReg: 9.42866) QuantErr: 9.42866 batch_time=0.54909 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.71033 (QuantReg: 9.44931) QuantErr: 9.44931 batch_time=0.49327 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.87027 (QuantReg: 9.98133) QuantErr: 9.98133 batch_time=0.49827 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.67672 (QuantReg: 9.81962) QuantErr: 9.81962 batch_time=0.48880 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 2.52597 (QuantReg: 9.49983) QuantErr: 9.49983 batch_time=0.48696 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.47114 (QuantReg: 9.37856) QuantErr: 9.37856 batch_time=0.48682 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 3.05070 (QuantReg: 9.64623) QuantErr: 9.64623 batch_time=0.49604 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.83044 (QuantReg: 9.58219) QuantErr: 9.58219 batch_time=0.47348 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.91903 (QuantReg: 9.39868) QuantErr: 9.39868 batch_time=0.50604 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.73754 (QuantReg: 9.61070) QuantErr: 9.61070 batch_time=0.71522 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 2.23604 (QuantReg: 9.61161) QuantErr: 9.61161 batch_time=0.48959 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.94983 (QuantReg: 9.63801) QuantErr: 9.63801 batch_time=0.49282 
Train Epoch: 8 codebook_update_time=1.63170
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch8.pth ...
Done in 3.856s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch8.pth ...
Done in 7.492s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 2.6848056564331055
 quant_reg      : 9.5786618309021
 quant_err      : 9.5786618309021
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.65
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.51330372417762
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.319
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.07619554756409
 mnt_best       : 37.51330372417762
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 2.29839 (QuantReg: 9.73059) QuantErr: 9.73059 batch_time=28.06571 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.85137 (QuantReg: 9.61797) QuantErr: 9.61797 batch_time=0.52087 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.24530 (QuantReg: 9.19103) QuantErr: 9.19103 batch_time=0.48336 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.79197 (QuantReg: 9.56480) QuantErr: 9.56480 batch_time=0.48811 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.58608 (QuantReg: 9.67307) QuantErr: 9.67307 batch_time=0.48747 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 2.28615 (QuantReg: 9.67513) QuantErr: 9.67513 batch_time=0.50463 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 2.36056 (QuantReg: 9.64466) QuantErr: 9.64466 batch_time=0.53814 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 2.56422 (QuantReg: 9.80729) QuantErr: 9.80729 batch_time=0.48612 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.82083 (QuantReg: 9.36161) QuantErr: 9.36161 batch_time=0.52272 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 2.36693 (QuantReg: 9.61005) QuantErr: 9.61005 batch_time=0.50500 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 2.53910 (QuantReg: 9.73296) QuantErr: 9.73296 batch_time=0.49701 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 2.25059 (QuantReg: 9.49848) QuantErr: 9.49848 batch_time=0.48783 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 2.60499 (QuantReg: 9.60397) QuantErr: 9.60397 batch_time=0.49648 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.42434 (QuantReg: 9.29066) QuantErr: 9.29066 batch_time=0.51271 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.55375 (QuantReg: 9.13209) QuantErr: 9.13209 batch_time=0.49068 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 2.28059 (QuantReg: 9.83150) QuantErr: 9.83150 batch_time=0.85509 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 2.78970 (QuantReg: 9.74045) QuantErr: 9.74045 batch_time=0.48938 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 2.19370 (QuantReg: 9.78735) QuantErr: 9.78735 batch_time=0.48432 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 2.70947 (QuantReg: 9.63132) QuantErr: 9.63132 batch_time=1.93840 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 2.38146 (QuantReg: 9.75740) QuantErr: 9.75740 batch_time=0.49558 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 2.43722 (QuantReg: 9.87451) QuantErr: 9.87451 batch_time=0.49004 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 2.30521 (QuantReg: 9.10001) QuantErr: 9.10001 batch_time=0.52780 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 2.50077 (QuantReg: 9.33168) QuantErr: 9.33168 batch_time=0.48591 
Train Epoch: 9 codebook_update_time=2.14416
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch9.pth ...
Done in 3.674s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch9.pth ...
Done in 7.984s
removing stale ckpt [epoch 8] [took 0.12s]
 epoch          : 9
 loss           : 2.5567427854537965
 quant_reg      : 9.542099376678467
 quant_err      : 9.542099376678467
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.221
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.59147799923033
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.1705
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.738190186156004
 mnt_best       : 37.59147799923033
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 2.38536 (QuantReg: 9.67764) QuantErr: 9.67764 batch_time=30.48762 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 2.56422 (QuantReg: 9.45977) QuantErr: 9.45977 batch_time=0.51807 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.90116 (QuantReg: 9.69552) QuantErr: 9.69552 batch_time=0.48710 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.47518 (QuantReg: 9.30733) QuantErr: 9.30733 batch_time=0.50133 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 2.25215 (QuantReg: 9.46809) QuantErr: 9.46809 batch_time=0.48898 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 2.43461 (QuantReg: 9.43931) QuantErr: 9.43931 batch_time=0.50053 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.77915 (QuantReg: 9.33525) QuantErr: 9.33525 batch_time=4.14909 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 2.61005 (QuantReg: 9.61377) QuantErr: 9.61377 batch_time=0.49732 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 2.63868 (QuantReg: 9.47823) QuantErr: 9.47823 batch_time=0.50273 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.48730 (QuantReg: 9.59982) QuantErr: 9.59982 batch_time=0.48974 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 2.33769 (QuantReg: 9.39418) QuantErr: 9.39418 batch_time=0.49459 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.64018 (QuantReg: 9.64541) QuantErr: 9.64541 batch_time=0.49581 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 2.53596 (QuantReg: 9.22797) QuantErr: 9.22797 batch_time=0.48364 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 2.22587 (QuantReg: 9.73843) QuantErr: 9.73843 batch_time=0.48809 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 2.45415 (QuantReg: 9.22719) QuantErr: 9.22719 batch_time=0.49005 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.76764 (QuantReg: 9.75758) QuantErr: 9.75758 batch_time=0.49151 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 2.55755 (QuantReg: 9.50246) QuantErr: 9.50246 batch_time=0.50408 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 2.37079 (QuantReg: 9.54652) QuantErr: 9.54652 batch_time=0.49466 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 2.25566 (QuantReg: 9.67558) QuantErr: 9.67558 batch_time=0.49350 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 2.03592 (QuantReg: 9.92904) QuantErr: 9.92904 batch_time=0.50396 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 2.58172 (QuantReg: 9.41388) QuantErr: 9.41388 batch_time=0.50041 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 2.84317 (QuantReg: 9.64842) QuantErr: 9.64842 batch_time=0.51022 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 2.54267 (QuantReg: 9.78411) QuantErr: 9.78411 batch_time=1.17927 
Train Epoch: 10 codebook_update_time=1.65519
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch10.pth ...
Done in 3.785s
removing stale ckpt [epoch 9] [took 0.01s]
 epoch          : 10
 loss           : 2.4656791424751283
 quant_reg      : 9.525885345458985
 quant_err      : 9.525885345458985
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.984
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.31868671490555
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.885999999999996
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.599735926921575
 mnt_best       : 37.59147799923033
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 2.40934 (QuantReg: 9.30815) QuantErr: 9.30815 batch_time=31.18437 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.73987 (QuantReg: 8.96557) QuantErr: 8.96557 batch_time=0.74532 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 2.60405 (QuantReg: 9.38265) QuantErr: 9.38265 batch_time=0.48804 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 2.54224 (QuantReg: 9.50514) QuantErr: 9.50514 batch_time=0.84103 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.51277 (QuantReg: 9.55641) QuantErr: 9.55641 batch_time=0.49259 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 2.89642 (QuantReg: 10.03425) QuantErr: 10.03425 batch_time=0.48720 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 2.14247 (QuantReg: 9.46838) QuantErr: 9.46838 batch_time=0.54095 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 2.50295 (QuantReg: 9.18902) QuantErr: 9.18902 batch_time=0.49979 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 2.43287 (QuantReg: 9.37777) QuantErr: 9.37777 batch_time=0.50168 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 2.49761 (QuantReg: 9.62738) QuantErr: 9.62738 batch_time=0.49599 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 2.16467 (QuantReg: 9.65242) QuantErr: 9.65242 batch_time=0.49375 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 2.20811 (QuantReg: 9.62554) QuantErr: 9.62554 batch_time=0.85216 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 2.40849 (QuantReg: 9.31787) QuantErr: 9.31787 batch_time=0.50651 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 2.26398 (QuantReg: 9.33727) QuantErr: 9.33727 batch_time=2.99346 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 2.25032 (QuantReg: 9.61778) QuantErr: 9.61778 batch_time=0.49616 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.64244 (QuantReg: 9.08008) QuantErr: 9.08008 batch_time=0.62551 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 2.29360 (QuantReg: 9.31682) QuantErr: 9.31682 batch_time=0.49683 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 2.40968 (QuantReg: 9.71679) QuantErr: 9.71679 batch_time=0.48735 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 2.37158 (QuantReg: 9.28170) QuantErr: 9.28170 batch_time=0.49609 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 2.14555 (QuantReg: 9.52020) QuantErr: 9.52020 batch_time=0.53417 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 2.27736 (QuantReg: 9.44239) QuantErr: 9.44239 batch_time=0.49734 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 2.32141 (QuantReg: 9.65203) QuantErr: 9.65203 batch_time=0.49788 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 2.29963 (QuantReg: 9.75886) QuantErr: 9.75886 batch_time=0.49351 
Train Epoch: 11 codebook_update_time=1.69097
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch11.pth ...
Done in 3.708s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch11.pth ...
Done in 7.362s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 2.384103579521179
 quant_reg      : 9.48477638244629
 quant_err      : 9.48477638244629
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.384
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.252522709432625
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.3045
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.88933717790115
 mnt_best       : 38.252522709432625
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 2.11449 (QuantReg: 9.27649) QuantErr: 9.27649 batch_time=30.78999 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 2.25001 (QuantReg: 9.34333) QuantErr: 9.34333 batch_time=0.52104 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 2.47443 (QuantReg: 9.64352) QuantErr: 9.64352 batch_time=0.50813 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 2.50630 (QuantReg: 9.45511) QuantErr: 9.45511 batch_time=0.49679 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 2.21741 (QuantReg: 9.38172) QuantErr: 9.38172 batch_time=0.48484 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 2.37237 (QuantReg: 9.46223) QuantErr: 9.46223 batch_time=0.48659 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 2.69746 (QuantReg: 9.84826) QuantErr: 9.84826 batch_time=0.71062 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 2.43956 (QuantReg: 9.05841) QuantErr: 9.05841 batch_time=0.49862 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 2.30345 (QuantReg: 9.44781) QuantErr: 9.44781 batch_time=0.48836 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 2.12838 (QuantReg: 9.48652) QuantErr: 9.48652 batch_time=0.50522 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 2.16181 (QuantReg: 9.60023) QuantErr: 9.60023 batch_time=0.51380 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 2.16175 (QuantReg: 9.61017) QuantErr: 9.61017 batch_time=0.51581 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 2.20014 (QuantReg: 9.31535) QuantErr: 9.31535 batch_time=0.49197 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 2.22725 (QuantReg: 9.21107) QuantErr: 9.21107 batch_time=0.49896 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 2.47065 (QuantReg: 9.90779) QuantErr: 9.90779 batch_time=0.49610 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 2.35254 (QuantReg: 9.59808) QuantErr: 9.59808 batch_time=0.49744 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 2.43036 (QuantReg: 9.62940) QuantErr: 9.62940 batch_time=0.49085 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 2.10412 (QuantReg: 9.58029) QuantErr: 9.58029 batch_time=0.57937 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 2.43190 (QuantReg: 9.39917) QuantErr: 9.39917 batch_time=1.76646 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 2.11855 (QuantReg: 9.59662) QuantErr: 9.59662 batch_time=0.49682 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 2.24742 (QuantReg: 9.69092) QuantErr: 9.69092 batch_time=0.49410 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 2.40626 (QuantReg: 9.74696) QuantErr: 9.74696 batch_time=0.49646 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 2.18498 (QuantReg: 9.62266) QuantErr: 9.62266 batch_time=0.48589 
Train Epoch: 12 codebook_update_time=1.64617
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch12.pth ...
Done in 4.551s
removing stale ckpt [epoch 11] [took 0.14s]
 epoch          : 12
 loss           : 2.331424171447754
 quant_reg      : 9.486841495513916
 quant_err      : 9.486841495513916
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.74
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.127640952949946
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.04
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.02531426884725
 mnt_best       : 38.252522709432625
 not_improved_count: 1
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 2.53322 (QuantReg: 9.27503) QuantErr: 9.27503 batch_time=29.79680 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.91094 (QuantReg: 9.88780) QuantErr: 9.88780 batch_time=0.49981 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 2.36599 (QuantReg: 9.18738) QuantErr: 9.18738 batch_time=0.49843 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 2.04824 (QuantReg: 9.56615) QuantErr: 9.56615 batch_time=0.55694 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 2.36082 (QuantReg: 9.64798) QuantErr: 9.64798 batch_time=0.51492 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 2.44866 (QuantReg: 9.24005) QuantErr: 9.24005 batch_time=0.49525 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 2.22392 (QuantReg: 9.64757) QuantErr: 9.64757 batch_time=0.49521 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 2.44642 (QuantReg: 9.65150) QuantErr: 9.65150 batch_time=0.49092 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 2.17700 (QuantReg: 9.80140) QuantErr: 9.80140 batch_time=0.52906 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 2.08176 (QuantReg: 9.42358) QuantErr: 9.42358 batch_time=0.49890 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 2.10235 (QuantReg: 9.74873) QuantErr: 9.74873 batch_time=0.48889 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 2.18536 (QuantReg: 9.88563) QuantErr: 9.88563 batch_time=0.50800 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 2.27006 (QuantReg: 9.52752) QuantErr: 9.52752 batch_time=0.49232 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 2.30005 (QuantReg: 9.55157) QuantErr: 9.55157 batch_time=0.49338 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 2.07592 (QuantReg: 9.52597) QuantErr: 9.52597 batch_time=0.49616 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 2.51921 (QuantReg: 9.69378) QuantErr: 9.69378 batch_time=0.53395 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 2.30076 (QuantReg: 9.66043) QuantErr: 9.66043 batch_time=0.49613 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 2.44190 (QuantReg: 9.38868) QuantErr: 9.38868 batch_time=0.50388 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 2.05023 (QuantReg: 9.64091) QuantErr: 9.64091 batch_time=0.49461 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 2.42604 (QuantReg: 9.64409) QuantErr: 9.64409 batch_time=0.49675 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.87210 (QuantReg: 9.54976) QuantErr: 9.54976 batch_time=0.49919 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 2.23656 (QuantReg: 9.40701) QuantErr: 9.40701 batch_time=0.51592 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 2.39542 (QuantReg: 9.44969) QuantErr: 9.44969 batch_time=0.50727 
Train Epoch: 13 codebook_update_time=1.77833
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch13.pth ...
Done in 4.854s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch13.pth ...
Done in 9.376s
removing stale ckpt [epoch 12] [took 0.01s]
 epoch          : 13
 loss           : 2.2748138079643248
 quant_reg      : 9.52313892364502
 quant_err      : 9.52313892364502
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.326
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.46663892564602
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.472
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.284249849161974
 mnt_best       : 39.46663892564602
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 2.14093 (QuantReg: 9.54477) QuantErr: 9.54477 batch_time=30.30536 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 2.00832 (QuantReg: 9.31634) QuantErr: 9.31634 batch_time=0.48724 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 2.24190 (QuantReg: 9.31850) QuantErr: 9.31850 batch_time=0.49035 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 2.15006 (QuantReg: 9.74110) QuantErr: 9.74110 batch_time=0.48642 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.92766 (QuantReg: 9.53401) QuantErr: 9.53401 batch_time=0.50626 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 2.57036 (QuantReg: 9.23355) QuantErr: 9.23355 batch_time=0.51831 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 2.31130 (QuantReg: 9.23649) QuantErr: 9.23649 batch_time=0.86958 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 2.22358 (QuantReg: 9.49637) QuantErr: 9.49637 batch_time=0.51594 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.97408 (QuantReg: 9.14165) QuantErr: 9.14165 batch_time=0.50223 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.96732 (QuantReg: 9.47742) QuantErr: 9.47742 batch_time=0.49345 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 2.55068 (QuantReg: 9.39376) QuantErr: 9.39376 batch_time=0.49380 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.97406 (QuantReg: 9.32196) QuantErr: 9.32196 batch_time=0.49529 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 2.10132 (QuantReg: 9.80006) QuantErr: 9.80006 batch_time=0.91310 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 2.41854 (QuantReg: 9.20525) QuantErr: 9.20525 batch_time=2.77479 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 2.24475 (QuantReg: 9.51583) QuantErr: 9.51583 batch_time=0.50153 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 2.34531 (QuantReg: 9.36305) QuantErr: 9.36305 batch_time=0.49557 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 2.14856 (QuantReg: 9.65460) QuantErr: 9.65460 batch_time=0.49186 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 2.36306 (QuantReg: 9.46800) QuantErr: 9.46800 batch_time=0.48726 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 2.27717 (QuantReg: 9.63980) QuantErr: 9.63980 batch_time=0.50036 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 2.21962 (QuantReg: 9.51023) QuantErr: 9.51023 batch_time=1.62546 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 2.41130 (QuantReg: 9.47942) QuantErr: 9.47942 batch_time=0.49960 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 2.05001 (QuantReg: 9.82123) QuantErr: 9.82123 batch_time=1.92620 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.90021 (QuantReg: 9.53992) QuantErr: 9.53992 batch_time=0.61971 
Train Epoch: 14 codebook_update_time=1.68330
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch14.pth ...
Done in 4.870s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch14.pth ...
Done in 10.037s
removing stale ckpt [epoch 13] [took 0.18s]
 epoch          : 14
 loss           : 2.205806387901306
 quant_reg      : 9.485227931976318
 quant_err      : 9.485227931976318
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.269
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.797119392872006
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.6965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.30940225219971
 mnt_best       : 39.797119392872006
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 2.02397 (QuantReg: 9.46259) QuantErr: 9.46259 batch_time=33.43825 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.70135 (QuantReg: 9.58187) QuantErr: 9.58187 batch_time=0.49253 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 2.19857 (QuantReg: 9.48112) QuantErr: 9.48112 batch_time=0.50931 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.89863 (QuantReg: 9.17630) QuantErr: 9.17630 batch_time=0.69466 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 2.30843 (QuantReg: 9.40145) QuantErr: 9.40145 batch_time=0.54421 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 2.18355 (QuantReg: 9.54176) QuantErr: 9.54176 batch_time=0.50502 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 2.19086 (QuantReg: 9.86026) QuantErr: 9.86026 batch_time=0.49174 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.94932 (QuantReg: 9.21495) QuantErr: 9.21495 batch_time=0.49121 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 2.39852 (QuantReg: 9.42834) QuantErr: 9.42834 batch_time=0.48774 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 2.13463 (QuantReg: 9.34700) QuantErr: 9.34700 batch_time=0.48868 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 2.46101 (QuantReg: 9.71591) QuantErr: 9.71591 batch_time=1.54644 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 2.00486 (QuantReg: 9.80306) QuantErr: 9.80306 batch_time=0.48997 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 2.20157 (QuantReg: 9.52336) QuantErr: 9.52336 batch_time=0.53900 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.89040 (QuantReg: 9.48224) QuantErr: 9.48224 batch_time=0.53125 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 2.07387 (QuantReg: 9.55949) QuantErr: 9.55949 batch_time=1.19777 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 2.00111 (QuantReg: 9.40024) QuantErr: 9.40024 batch_time=0.59826 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.99941 (QuantReg: 9.52767) QuantErr: 9.52767 batch_time=0.48583 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 2.05889 (QuantReg: 9.40068) QuantErr: 9.40068 batch_time=0.48759 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 2.50238 (QuantReg: 9.41088) QuantErr: 9.41088 batch_time=0.50027 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 2.01197 (QuantReg: 9.64679) QuantErr: 9.64679 batch_time=0.49679 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.98682 (QuantReg: 9.52711) QuantErr: 9.52711 batch_time=0.49581 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 2.17119 (QuantReg: 9.73941) QuantErr: 9.73941 batch_time=0.50142 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.97192 (QuantReg: 9.49454) QuantErr: 9.49454 batch_time=0.51135 
Train Epoch: 15 codebook_update_time=2.13022
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch15.pth ...
Done in 6.144s
removing stale ckpt [epoch 14] [took 0.22s]
 epoch          : 15
 loss           : 2.1482748951911925
 quant_reg      : 9.47901425933838
 quant_err      : 9.47901425933838
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.546
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.63505723589466
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.696
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.000677363387794
 mnt_best       : 39.797119392872006
 not_improved_count: 1
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 2.44750 (QuantReg: 9.31842) QuantErr: 9.31842 batch_time=37.84227 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 2.23178 (QuantReg: 9.22139) QuantErr: 9.22139 batch_time=0.49032 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 2.10834 (QuantReg: 9.50517) QuantErr: 9.50517 batch_time=0.49695 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 2.64229 (QuantReg: 9.09835) QuantErr: 9.09835 batch_time=0.49586 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 2.10152 (QuantReg: 9.48261) QuantErr: 9.48261 batch_time=0.95199 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 2.34849 (QuantReg: 9.75940) QuantErr: 9.75940 batch_time=0.50179 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.92237 (QuantReg: 9.58540) QuantErr: 9.58540 batch_time=1.98563 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 2.17433 (QuantReg: 9.22745) QuantErr: 9.22745 batch_time=0.50053 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 2.18947 (QuantReg: 9.42910) QuantErr: 9.42910 batch_time=0.56263 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 2.12650 (QuantReg: 9.64673) QuantErr: 9.64673 batch_time=0.50710 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.94268 (QuantReg: 9.53347) QuantErr: 9.53347 batch_time=0.49295 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.95502 (QuantReg: 9.45826) QuantErr: 9.45826 batch_time=0.50716 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 2.01072 (QuantReg: 9.46668) QuantErr: 9.46668 batch_time=0.50822 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 2.51658 (QuantReg: 9.65252) QuantErr: 9.65252 batch_time=0.53732 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 2.46942 (QuantReg: 9.51564) QuantErr: 9.51564 batch_time=0.54738 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 2.14655 (QuantReg: 9.57120) QuantErr: 9.57120 batch_time=0.49841 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.89608 (QuantReg: 9.72315) QuantErr: 9.72315 batch_time=0.49623 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 2.28223 (QuantReg: 9.36240) QuantErr: 9.36240 batch_time=0.49851 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 2.07459 (QuantReg: 9.36920) QuantErr: 9.36920 batch_time=0.49308 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.93003 (QuantReg: 9.74138) QuantErr: 9.74138 batch_time=0.50459 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 2.12055 (QuantReg: 9.56170) QuantErr: 9.56170 batch_time=0.49991 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 2.26580 (QuantReg: 9.35172) QuantErr: 9.35172 batch_time=0.50967 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 2.17557 (QuantReg: 9.55688) QuantErr: 9.55688 batch_time=0.50385 
Train Epoch: 16 codebook_update_time=1.65593
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch16.pth ...
Done in 5.005s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 2.127503707408905
 quant_reg      : 9.473912899017334
 quant_err      : 9.473912899017334
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.598
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.965081170632054
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.9165
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.66359677026227
 mnt_best       : 39.797119392872006
 not_improved_count: 2
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.88900 (QuantReg: 9.62059) QuantErr: 9.62059 batch_time=33.19253 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 2.19476 (QuantReg: 9.24748) QuantErr: 9.24748 batch_time=0.49178 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.95346 (QuantReg: 9.24429) QuantErr: 9.24429 batch_time=0.48510 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 2.43746 (QuantReg: 9.51454) QuantErr: 9.51454 batch_time=0.49398 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 2.13720 (QuantReg: 9.12741) QuantErr: 9.12741 batch_time=0.49333 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 2.24557 (QuantReg: 9.60202) QuantErr: 9.60202 batch_time=0.49173 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 2.23497 (QuantReg: 9.60245) QuantErr: 9.60245 batch_time=1.83264 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.86802 (QuantReg: 9.41389) QuantErr: 9.41389 batch_time=0.48955 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 2.08113 (QuantReg: 9.17775) QuantErr: 9.17775 batch_time=0.50133 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 2.21117 (QuantReg: 9.62494) QuantErr: 9.62494 batch_time=0.49688 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 2.24049 (QuantReg: 9.50612) QuantErr: 9.50612 batch_time=0.86306 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 2.02219 (QuantReg: 9.42718) QuantErr: 9.42718 batch_time=0.48525 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 2.28850 (QuantReg: 9.35152) QuantErr: 9.35152 batch_time=0.50459 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 2.16225 (QuantReg: 9.71611) QuantErr: 9.71611 batch_time=0.54698 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 2.39480 (QuantReg: 9.09637) QuantErr: 9.09637 batch_time=0.51261 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 2.04353 (QuantReg: 9.41478) QuantErr: 9.41478 batch_time=0.49347 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 2.37721 (QuantReg: 9.61967) QuantErr: 9.61967 batch_time=0.52710 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.87382 (QuantReg: 9.76468) QuantErr: 9.76468 batch_time=0.51114 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 2.15212 (QuantReg: 9.12536) QuantErr: 9.12536 batch_time=0.49487 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.86842 (QuantReg: 9.61090) QuantErr: 9.61090 batch_time=0.53287 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 2.06366 (QuantReg: 9.25966) QuantErr: 9.25966 batch_time=0.50542 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 2.18535 (QuantReg: 9.75673) QuantErr: 9.75673 batch_time=0.49644 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.91888 (QuantReg: 9.32607) QuantErr: 9.32607 batch_time=0.48644 
Train Epoch: 17 codebook_update_time=1.63388
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch17.pth ...
Done in 5.023s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch17.pth ...
Done in 9.491s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 2.079463959693909
 quant_reg      : 9.487652618408204
 quant_err      : 9.487652618408204
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.648
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.92841362787737
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.469
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.427390137881574
 mnt_best       : 39.92841362787737
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 2.18817 (QuantReg: 9.27655) QuantErr: 9.27655 batch_time=30.79454 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 2.09474 (QuantReg: 9.33127) QuantErr: 9.33127 batch_time=0.50976 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.89985 (QuantReg: 9.37823) QuantErr: 9.37823 batch_time=0.49531 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.81998 (QuantReg: 9.59665) QuantErr: 9.59665 batch_time=0.50920 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 2.06309 (QuantReg: 9.35103) QuantErr: 9.35103 batch_time=0.48677 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.95872 (QuantReg: 9.69836) QuantErr: 9.69836 batch_time=0.48628 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.70346 (QuantReg: 9.75180) QuantErr: 9.75180 batch_time=0.48810 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.90102 (QuantReg: 9.50720) QuantErr: 9.50720 batch_time=0.48890 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 2.26679 (QuantReg: 9.67892) QuantErr: 9.67892 batch_time=0.51207 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.89577 (QuantReg: 9.31644) QuantErr: 9.31644 batch_time=0.48638 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 2.23298 (QuantReg: 9.32967) QuantErr: 9.32967 batch_time=0.48857 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 2.22017 (QuantReg: 9.55166) QuantErr: 9.55166 batch_time=0.47840 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.89814 (QuantReg: 9.39357) QuantErr: 9.39357 batch_time=0.51812 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 2.24644 (QuantReg: 9.40077) QuantErr: 9.40077 batch_time=0.51818 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 2.02180 (QuantReg: 9.07625) QuantErr: 9.07625 batch_time=0.51660 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 2.05266 (QuantReg: 9.72806) QuantErr: 9.72806 batch_time=0.50239 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.92145 (QuantReg: 9.21167) QuantErr: 9.21167 batch_time=0.50027 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.90495 (QuantReg: 9.38070) QuantErr: 9.38070 batch_time=0.51938 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 2.07466 (QuantReg: 9.54251) QuantErr: 9.54251 batch_time=0.49664 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.77834 (QuantReg: 9.51788) QuantErr: 9.51788 batch_time=0.48003 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 2.36863 (QuantReg: 9.21364) QuantErr: 9.21364 batch_time=0.48803 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 2.05046 (QuantReg: 9.60699) QuantErr: 9.60699 batch_time=0.49744 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 2.05010 (QuantReg: 9.49549) QuantErr: 9.49549 batch_time=0.49906 
Train Epoch: 18 codebook_update_time=1.70037
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch18.pth ...
Done in 4.776s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch18.pth ...
Done in 9.919s
removing stale ckpt [epoch 17] [took 0.02s]
 epoch          : 18
 loss           : 2.034042736053467
 quant_reg      : 9.484231956481933
 quant_err      : 9.484231956481933
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.32
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.604534101760294
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.546
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.035774447244314
 mnt_best       : 40.604534101760294
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.97753 (QuantReg: 9.57644) QuantErr: 9.57644 batch_time=30.80254 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.85638 (QuantReg: 9.44366) QuantErr: 9.44366 batch_time=0.48385 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 2.23271 (QuantReg: 9.29142) QuantErr: 9.29142 batch_time=0.53151 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 2.25988 (QuantReg: 9.57191) QuantErr: 9.57191 batch_time=0.53448 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.92459 (QuantReg: 9.39207) QuantErr: 9.39207 batch_time=0.49019 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.77733 (QuantReg: 9.66562) QuantErr: 9.66562 batch_time=0.48691 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.73160 (QuantReg: 9.48920) QuantErr: 9.48920 batch_time=0.49881 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.93183 (QuantReg: 9.32518) QuantErr: 9.32518 batch_time=0.49891 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.78948 (QuantReg: 9.35692) QuantErr: 9.35692 batch_time=0.48650 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 2.12482 (QuantReg: 8.96240) QuantErr: 8.96240 batch_time=0.48659 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 2.01671 (QuantReg: 9.31042) QuantErr: 9.31042 batch_time=0.48571 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.94538 (QuantReg: 9.62839) QuantErr: 9.62839 batch_time=0.49131 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 2.11849 (QuantReg: 9.80778) QuantErr: 9.80778 batch_time=0.49908 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 2.02845 (QuantReg: 9.56951) QuantErr: 9.56951 batch_time=0.51334 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 2.33820 (QuantReg: 9.36170) QuantErr: 9.36170 batch_time=0.50369 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.55194 (QuantReg: 9.37651) QuantErr: 9.37651 batch_time=0.52312 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.91818 (QuantReg: 9.45245) QuantErr: 9.45245 batch_time=0.50144 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 2.01264 (QuantReg: 9.30678) QuantErr: 9.30678 batch_time=0.48849 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.93326 (QuantReg: 9.18018) QuantErr: 9.18018 batch_time=1.06320 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.83884 (QuantReg: 9.33594) QuantErr: 9.33594 batch_time=0.50763 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 2.15902 (QuantReg: 9.78810) QuantErr: 9.78810 batch_time=0.49448 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 2.19399 (QuantReg: 9.38041) QuantErr: 9.38041 batch_time=0.47834 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.99786 (QuantReg: 9.70623) QuantErr: 9.70623 batch_time=0.53011 
Train Epoch: 19 codebook_update_time=1.61517
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch19.pth ...
Done in 5.609s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch19.pth ...
Done in 10.541s
removing stale ckpt [epoch 18] [took 0.02s]
 epoch          : 19
 loss           : 2.006883062839508
 quant_reg      : 9.462685665130616
 quant_err      : 9.462685665130616
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.749
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.86004231581379
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.367
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.44202210210032
 mnt_best       : 40.86004231581379
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.61899 (QuantReg: 9.62282) QuantErr: 9.62282 batch_time=32.28357 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.94015 (QuantReg: 9.36260) QuantErr: 9.36260 batch_time=4.51364 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.91872 (QuantReg: 9.34573) QuantErr: 9.34573 batch_time=0.52729 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.73643 (QuantReg: 9.07722) QuantErr: 9.07722 batch_time=0.49334 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 2.17595 (QuantReg: 9.22953) QuantErr: 9.22953 batch_time=0.49963 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.84616 (QuantReg: 9.41869) QuantErr: 9.41869 batch_time=0.49761 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.71338 (QuantReg: 9.56713) QuantErr: 9.56713 batch_time=0.48745 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 2.11192 (QuantReg: 9.28812) QuantErr: 9.28812 batch_time=0.52835 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 2.13654 (QuantReg: 9.53224) QuantErr: 9.53224 batch_time=0.50945 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.69370 (QuantReg: 9.37673) QuantErr: 9.37673 batch_time=0.49975 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 2.02301 (QuantReg: 9.10962) QuantErr: 9.10962 batch_time=0.50496 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 2.05880 (QuantReg: 9.68352) QuantErr: 9.68352 batch_time=0.51824 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.85295 (QuantReg: 9.14353) QuantErr: 9.14353 batch_time=0.49304 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.82074 (QuantReg: 9.57878) QuantErr: 9.57878 batch_time=0.70882 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.96626 (QuantReg: 9.46618) QuantErr: 9.46618 batch_time=0.48780 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 2.12898 (QuantReg: 9.80989) QuantErr: 9.80989 batch_time=0.49035 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.92592 (QuantReg: 9.47130) QuantErr: 9.47130 batch_time=0.49502 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.84165 (QuantReg: 9.67792) QuantErr: 9.67792 batch_time=0.50250 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.96246 (QuantReg: 9.30137) QuantErr: 9.30137 batch_time=0.49702 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.84513 (QuantReg: 9.46029) QuantErr: 9.46029 batch_time=0.49846 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 2.07737 (QuantReg: 9.65017) QuantErr: 9.65017 batch_time=0.49430 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 2.10293 (QuantReg: 9.72498) QuantErr: 9.72498 batch_time=0.49323 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.99714 (QuantReg: 9.46366) QuantErr: 9.46366 batch_time=0.52625 
Train Epoch: 20 codebook_update_time=1.65703
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch20.pth ...
Done in 4.441s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch20.pth ...
Done in 8.498s
removing stale ckpt [epoch 19] [took 0.01s]
 epoch          : 20
 loss           : 1.993133816242218
 quant_reg      : 9.46375605392456
 quant_err      : 9.46375605392456
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.222
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.90717688194189
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.6125
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.05104607686846
 mnt_best       : 40.90717688194189
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 2.09262 (QuantReg: 9.59138) QuantErr: 9.59138 batch_time=32.24708 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.91930 (QuantReg: 9.65305) QuantErr: 9.65305 batch_time=0.55315 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 2.26347 (QuantReg: 9.74432) QuantErr: 9.74432 batch_time=0.57650 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 2.25154 (QuantReg: 9.41801) QuantErr: 9.41801 batch_time=0.49352 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.83558 (QuantReg: 9.14084) QuantErr: 9.14084 batch_time=0.50046 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.88349 (QuantReg: 9.58222) QuantErr: 9.58222 batch_time=0.82630 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 2.42084 (QuantReg: 9.48765) QuantErr: 9.48765 batch_time=0.49032 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.94384 (QuantReg: 9.45594) QuantErr: 9.45594 batch_time=4.11898 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.92909 (QuantReg: 9.33567) QuantErr: 9.33567 batch_time=0.49337 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.94541 (QuantReg: 9.15241) QuantErr: 9.15241 batch_time=0.51079 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.71048 (QuantReg: 9.62222) QuantErr: 9.62222 batch_time=0.52020 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.67834 (QuantReg: 9.00269) QuantErr: 9.00269 batch_time=0.51612 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.96663 (QuantReg: 9.68721) QuantErr: 9.68721 batch_time=0.51767 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.68243 (QuantReg: 9.33800) QuantErr: 9.33800 batch_time=0.50483 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 2.06136 (QuantReg: 9.10852) QuantErr: 9.10852 batch_time=0.50925 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 2.00573 (QuantReg: 9.78096) QuantErr: 9.78096 batch_time=0.49266 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 2.07592 (QuantReg: 9.03156) QuantErr: 9.03156 batch_time=0.50822 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.91384 (QuantReg: 9.27300) QuantErr: 9.27300 batch_time=0.51122 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 2.00906 (QuantReg: 9.64262) QuantErr: 9.64262 batch_time=0.96002 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 2.07127 (QuantReg: 9.07264) QuantErr: 9.07264 batch_time=1.33867 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.97151 (QuantReg: 9.80742) QuantErr: 9.80742 batch_time=1.04073 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.85774 (QuantReg: 9.56694) QuantErr: 9.56694 batch_time=0.48749 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 2.10023 (QuantReg: 9.70990) QuantErr: 9.70990 batch_time=0.49818 
Train Epoch: 21 codebook_update_time=1.65690
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch21.pth ...
Done in 4.647s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch21.pth ...
Done in 9.062s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 1.96373752784729
 quant_reg      : 9.463543537139893
 quant_err      : 9.463543537139893
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.868
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.64921558983619
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.12
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.31000701409417
 mnt_best       : 41.64921558983619
 not_improved_count: 0
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 2.17240 (QuantReg: 9.34841) QuantErr: 9.34841 batch_time=31.97296 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.77125 (QuantReg: 9.70306) QuantErr: 9.70306 batch_time=1.09740 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.99948 (QuantReg: 9.48976) QuantErr: 9.48976 batch_time=0.55642 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 2.14206 (QuantReg: 9.45483) QuantErr: 9.45483 batch_time=0.49125 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 2.56038 (QuantReg: 9.72574) QuantErr: 9.72574 batch_time=0.49509 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.95478 (QuantReg: 9.24904) QuantErr: 9.24904 batch_time=0.49752 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 2.32451 (QuantReg: 9.68085) QuantErr: 9.68085 batch_time=0.49658 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.76199 (QuantReg: 9.44411) QuantErr: 9.44411 batch_time=0.49680 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 2.02440 (QuantReg: 9.64137) QuantErr: 9.64137 batch_time=0.55167 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.98233 (QuantReg: 9.19145) QuantErr: 9.19145 batch_time=0.49599 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.94381 (QuantReg: 9.70890) QuantErr: 9.70890 batch_time=0.51339 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.88958 (QuantReg: 9.24287) QuantErr: 9.24287 batch_time=0.50076 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.73729 (QuantReg: 9.29069) QuantErr: 9.29069 batch_time=2.08008 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 2.11232 (QuantReg: 9.41792) QuantErr: 9.41792 batch_time=0.49944 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.70839 (QuantReg: 9.12803) QuantErr: 9.12803 batch_time=0.54192 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 2.38636 (QuantReg: 9.37806) QuantErr: 9.37806 batch_time=0.49151 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.80214 (QuantReg: 9.52702) QuantErr: 9.52702 batch_time=0.49795 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.66577 (QuantReg: 9.43505) QuantErr: 9.43505 batch_time=0.50688 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.79114 (QuantReg: 9.31142) QuantErr: 9.31142 batch_time=0.53046 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.83568 (QuantReg: 9.40538) QuantErr: 9.40538 batch_time=0.50116 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 2.30013 (QuantReg: 9.46229) QuantErr: 9.46229 batch_time=1.85679 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.63835 (QuantReg: 9.50591) QuantErr: 9.50591 batch_time=0.50358 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.88850 (QuantReg: 9.63116) QuantErr: 9.63116 batch_time=0.50788 
Train Epoch: 22 codebook_update_time=1.65327
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch22.pth ...
Done in 5.082s
removing stale ckpt [epoch 21] [took 0.01s]
 epoch          : 22
 loss           : 1.9375106739997863
 quant_reg      : 9.464231666564942
 quant_err      : 9.464231666564942
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.074
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.34093501071141
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.6245
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.67675133676717
 mnt_best       : 41.64921558983619
 not_improved_count: 1
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.79463 (QuantReg: 9.60340) QuantErr: 9.60340 batch_time=31.30730 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.74812 (QuantReg: 9.38808) QuantErr: 9.38808 batch_time=0.48522 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 2.28709 (QuantReg: 9.60799) QuantErr: 9.60799 batch_time=0.49433 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 2.02431 (QuantReg: 9.24936) QuantErr: 9.24936 batch_time=0.49592 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.85426 (QuantReg: 9.17530) QuantErr: 9.17530 batch_time=1.16013 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 2.02926 (QuantReg: 9.26516) QuantErr: 9.26516 batch_time=0.50339 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.79388 (QuantReg: 9.33650) QuantErr: 9.33650 batch_time=5.63081 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.89334 (QuantReg: 9.06386) QuantErr: 9.06386 batch_time=0.49719 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.92485 (QuantReg: 9.52577) QuantErr: 9.52577 batch_time=0.49612 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 2.17714 (QuantReg: 9.30059) QuantErr: 9.30059 batch_time=0.51546 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.80098 (QuantReg: 9.20217) QuantErr: 9.20217 batch_time=0.54674 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.86822 (QuantReg: 9.17254) QuantErr: 9.17254 batch_time=0.49220 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.95507 (QuantReg: 9.66023) QuantErr: 9.66023 batch_time=0.51026 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.65134 (QuantReg: 9.50915) QuantErr: 9.50915 batch_time=0.48906 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 2.10715 (QuantReg: 9.32437) QuantErr: 9.32437 batch_time=0.49179 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.97885 (QuantReg: 9.25724) QuantErr: 9.25724 batch_time=0.49320 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.87418 (QuantReg: 9.53664) QuantErr: 9.53664 batch_time=0.52496 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.66448 (QuantReg: 9.50933) QuantErr: 9.50933 batch_time=0.49832 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.74268 (QuantReg: 9.37344) QuantErr: 9.37344 batch_time=0.51052 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 2.01732 (QuantReg: 9.46360) QuantErr: 9.46360 batch_time=0.49138 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.87587 (QuantReg: 9.55526) QuantErr: 9.55526 batch_time=0.49603 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.78012 (QuantReg: 9.71680) QuantErr: 9.71680 batch_time=0.49216 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.85489 (QuantReg: 9.43094) QuantErr: 9.43094 batch_time=0.51035 
Train Epoch: 23 codebook_update_time=1.70243
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch23.pth ...
Done in 5.311s
removing stale ckpt [epoch 22] [took 0.10s]
 epoch          : 23
 loss           : 1.9041410093307496
 quant_reg      : 9.449392974853515
 quant_err      : 9.449392974853515
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.565
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.39465994837
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.6185
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.66602058375967
 mnt_best       : 41.64921558983619
 not_improved_count: 2
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.96339 (QuantReg: 9.54641) QuantErr: 9.54641 batch_time=40.39267 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.73062 (QuantReg: 9.30005) QuantErr: 9.30005 batch_time=0.48678 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.86560 (QuantReg: 9.10682) QuantErr: 9.10682 batch_time=0.49904 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.86748 (QuantReg: 9.38678) QuantErr: 9.38678 batch_time=0.49003 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 2.12840 (QuantReg: 9.19096) QuantErr: 9.19096 batch_time=0.48421 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.83527 (QuantReg: 9.56822) QuantErr: 9.56822 batch_time=0.48665 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.89731 (QuantReg: 9.08060) QuantErr: 9.08060 batch_time=0.50840 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.93593 (QuantReg: 9.45880) QuantErr: 9.45880 batch_time=0.48880 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.93854 (QuantReg: 9.54921) QuantErr: 9.54921 batch_time=0.52982 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.89280 (QuantReg: 9.36378) QuantErr: 9.36378 batch_time=0.48858 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 2.10797 (QuantReg: 9.45265) QuantErr: 9.45265 batch_time=0.49980 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.89202 (QuantReg: 9.51095) QuantErr: 9.51095 batch_time=0.49259 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.65033 (QuantReg: 9.23062) QuantErr: 9.23062 batch_time=0.51922 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.66148 (QuantReg: 9.24115) QuantErr: 9.24115 batch_time=0.52318 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.77619 (QuantReg: 9.60320) QuantErr: 9.60320 batch_time=0.50383 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 2.22272 (QuantReg: 9.50496) QuantErr: 9.50496 batch_time=0.48828 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.61197 (QuantReg: 9.71442) QuantErr: 9.71442 batch_time=0.49008 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 2.03923 (QuantReg: 9.65832) QuantErr: 9.65832 batch_time=0.51887 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.91256 (QuantReg: 9.58195) QuantErr: 9.58195 batch_time=0.49073 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.59664 (QuantReg: 9.36238) QuantErr: 9.36238 batch_time=0.50983 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.87653 (QuantReg: 9.76276) QuantErr: 9.76276 batch_time=0.50935 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.69348 (QuantReg: 9.37582) QuantErr: 9.37582 batch_time=0.52248 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.66600 (QuantReg: 9.32611) QuantErr: 9.32611 batch_time=0.53239 
Train Epoch: 24 codebook_update_time=1.66347
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch24.pth ...
Done in 4.739s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 1.8774871640205384
 quant_reg      : 9.464736076354981
 quant_err      : 9.464736076354981
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.708
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.39373811333822
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.5815
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.62160105352271
 mnt_best       : 41.64921558983619
 not_improved_count: 3
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.80470 (QuantReg: 9.22261) QuantErr: 9.22261 batch_time=35.10872 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.65016 (QuantReg: 9.24692) QuantErr: 9.24692 batch_time=0.52517 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.93912 (QuantReg: 9.78138) QuantErr: 9.78138 batch_time=0.50384 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.83085 (QuantReg: 9.49272) QuantErr: 9.49272 batch_time=0.50716 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.67640 (QuantReg: 9.63372) QuantErr: 9.63372 batch_time=0.51708 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.64591 (QuantReg: 9.66182) QuantErr: 9.66182 batch_time=0.50674 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 2.18422 (QuantReg: 9.58791) QuantErr: 9.58791 batch_time=0.50838 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 2.08900 (QuantReg: 9.42553) QuantErr: 9.42553 batch_time=0.50764 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.94497 (QuantReg: 9.34942) QuantErr: 9.34942 batch_time=0.49514 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.77906 (QuantReg: 9.35152) QuantErr: 9.35152 batch_time=0.48862 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 2.07279 (QuantReg: 9.71888) QuantErr: 9.71888 batch_time=0.51006 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 2.26650 (QuantReg: 9.56534) QuantErr: 9.56534 batch_time=0.48368 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.56321 (QuantReg: 8.99335) QuantErr: 8.99335 batch_time=0.57049 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.68766 (QuantReg: 9.50208) QuantErr: 9.50208 batch_time=0.52060 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.71423 (QuantReg: 9.37955) QuantErr: 9.37955 batch_time=0.50380 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 2.15984 (QuantReg: 9.20874) QuantErr: 9.20874 batch_time=0.48982 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.75654 (QuantReg: 9.50191) QuantErr: 9.50191 batch_time=0.51322 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.63728 (QuantReg: 9.44177) QuantErr: 9.44177 batch_time=1.07067 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 1.60970 (QuantReg: 9.52643) QuantErr: 9.52643 batch_time=0.55592 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.79517 (QuantReg: 9.32673) QuantErr: 9.32673 batch_time=0.49596 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 2.03269 (QuantReg: 9.60695) QuantErr: 9.60695 batch_time=0.77192 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.59466 (QuantReg: 9.62016) QuantErr: 9.62016 batch_time=0.53141 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.74198 (QuantReg: 9.58545) QuantErr: 9.58545 batch_time=0.52903 
Train Epoch: 25 codebook_update_time=1.63710
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch25.pth ...
Done in 4.106s
removing stale ckpt [epoch 24] [took 0.02s]
 epoch          : 25
 loss           : 1.8619934873580932
 quant_reg      : 9.455987426757812
 quant_err      : 9.455987426757812
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.585
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.33005575594531
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.428
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.318088955734915
 mnt_best       : 41.64921558983619
 not_improved_count: 4
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.98522 (QuantReg: 9.14621) QuantErr: 9.14621 batch_time=35.27245 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.79804 (QuantReg: 9.29517) QuantErr: 9.29517 batch_time=0.50935 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.94775 (QuantReg: 9.56287) QuantErr: 9.56287 batch_time=0.49110 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 2.08925 (QuantReg: 9.60897) QuantErr: 9.60897 batch_time=0.54054 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.98728 (QuantReg: 9.40438) QuantErr: 9.40438 batch_time=0.49381 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.61681 (QuantReg: 9.68463) QuantErr: 9.68463 batch_time=0.51869 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.44357 (QuantReg: 9.50572) QuantErr: 9.50572 batch_time=0.49062 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.88336 (QuantReg: 9.55875) QuantErr: 9.55875 batch_time=0.49905 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.88217 (QuantReg: 9.23389) QuantErr: 9.23389 batch_time=0.48678 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.62856 (QuantReg: 9.53844) QuantErr: 9.53844 batch_time=0.48429 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.72760 (QuantReg: 9.70742) QuantErr: 9.70742 batch_time=0.48921 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.80405 (QuantReg: 9.36207) QuantErr: 9.36207 batch_time=0.49927 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.83642 (QuantReg: 9.46485) QuantErr: 9.46485 batch_time=0.49122 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 2.01212 (QuantReg: 8.95732) QuantErr: 8.95732 batch_time=0.49819 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.99924 (QuantReg: 9.69573) QuantErr: 9.69573 batch_time=0.48866 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.87809 (QuantReg: 9.77035) QuantErr: 9.77035 batch_time=0.49441 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.86992 (QuantReg: 9.64775) QuantErr: 9.64775 batch_time=0.49622 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 2.05535 (QuantReg: 9.64357) QuantErr: 9.64357 batch_time=0.51969 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.74687 (QuantReg: 9.02713) QuantErr: 9.02713 batch_time=0.49245 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.93780 (QuantReg: 9.55034) QuantErr: 9.55034 batch_time=0.50727 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.88657 (QuantReg: 9.58500) QuantErr: 9.58500 batch_time=0.50123 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 2.00481 (QuantReg: 9.76704) QuantErr: 9.76704 batch_time=0.49483 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.93130 (QuantReg: 9.69140) QuantErr: 9.69140 batch_time=0.49873 
Train Epoch: 26 codebook_update_time=1.61246
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch26.pth ...
Done in 4.155s
removing stale ckpt [epoch 25] [took 0.01s]
 epoch          : 26
 loss           : 1.8743101954460144
 quant_reg      : 9.455464046478271
 quant_err      : 9.455464046478271
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.598
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.20737370771547
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.559
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.927136101860796
 mnt_best       : 41.64921558983619
 not_improved_count: 5
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.83885 (QuantReg: 9.58448) QuantErr: 9.58448 batch_time=40.23617 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.85546 (QuantReg: 9.26194) QuantErr: 9.26194 batch_time=0.63558 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.84543 (QuantReg: 9.36816) QuantErr: 9.36816 batch_time=0.50757 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.73907 (QuantReg: 9.54534) QuantErr: 9.54534 batch_time=0.54061 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.82541 (QuantReg: 9.38805) QuantErr: 9.38805 batch_time=0.53863 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.77971 (QuantReg: 9.52472) QuantErr: 9.52472 batch_time=0.49256 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.73272 (QuantReg: 9.65002) QuantErr: 9.65002 batch_time=0.52420 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.79546 (QuantReg: 9.43627) QuantErr: 9.43627 batch_time=0.49618 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 2.05529 (QuantReg: 9.46149) QuantErr: 9.46149 batch_time=0.48757 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.88683 (QuantReg: 9.88789) QuantErr: 9.88789 batch_time=0.48763 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.87255 (QuantReg: 9.67490) QuantErr: 9.67490 batch_time=0.62842 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.73283 (QuantReg: 9.14725) QuantErr: 9.14725 batch_time=0.49588 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.70535 (QuantReg: 9.51190) QuantErr: 9.51190 batch_time=0.49651 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.80338 (QuantReg: 9.49411) QuantErr: 9.49411 batch_time=0.49031 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.87403 (QuantReg: 9.47724) QuantErr: 9.47724 batch_time=0.49690 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 2.03165 (QuantReg: 9.50091) QuantErr: 9.50091 batch_time=0.57541 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.79486 (QuantReg: 9.47725) QuantErr: 9.47725 batch_time=0.49146 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.67411 (QuantReg: 9.62259) QuantErr: 9.62259 batch_time=0.48921 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.95560 (QuantReg: 9.26616) QuantErr: 9.26616 batch_time=0.57711 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 2.02654 (QuantReg: 9.58981) QuantErr: 9.58981 batch_time=0.50779 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.71909 (QuantReg: 9.33978) QuantErr: 9.33978 batch_time=0.52200 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 2.08022 (QuantReg: 9.20518) QuantErr: 9.20518 batch_time=0.48463 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.65291 (QuantReg: 9.37168) QuantErr: 9.37168 batch_time=0.51282 
Train Epoch: 27 codebook_update_time=1.65143
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch27.pth ...
Done in 5.044s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch27.pth ...
Done in 9.025s
removing stale ckpt [epoch 26] [took 0.02s]
 epoch          : 27
 loss           : 1.8506055207252503
 quant_reg      : 9.465319118499757
 quant_err      : 9.465319118499757
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.119
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.61552770659113
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.1875
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.23566091142257
 mnt_best       : 42.61552770659113
 not_improved_count: 0
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.61402 (QuantReg: 9.10814) QuantErr: 9.10814 batch_time=32.46134 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.91464 (QuantReg: 9.84517) QuantErr: 9.84517 batch_time=0.95574 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.40882 (QuantReg: 9.42305) QuantErr: 9.42305 batch_time=0.50573 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.67258 (QuantReg: 9.49599) QuantErr: 9.49599 batch_time=0.48827 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.62909 (QuantReg: 9.62280) QuantErr: 9.62280 batch_time=0.48865 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.71700 (QuantReg: 9.47126) QuantErr: 9.47126 batch_time=0.51652 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.97154 (QuantReg: 9.28663) QuantErr: 9.28663 batch_time=0.48181 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.86843 (QuantReg: 9.51612) QuantErr: 9.51612 batch_time=0.49640 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 2.39692 (QuantReg: 9.43223) QuantErr: 9.43223 batch_time=0.49358 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 2.03543 (QuantReg: 9.70336) QuantErr: 9.70336 batch_time=0.49123 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.88050 (QuantReg: 9.67800) QuantErr: 9.67800 batch_time=0.64024 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.55236 (QuantReg: 9.39261) QuantErr: 9.39261 batch_time=0.52994 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 2.00621 (QuantReg: 9.57781) QuantErr: 9.57781 batch_time=0.65772 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.88248 (QuantReg: 9.34904) QuantErr: 9.34904 batch_time=1.39488 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.86244 (QuantReg: 9.61433) QuantErr: 9.61433 batch_time=0.50440 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.82547 (QuantReg: 9.80136) QuantErr: 9.80136 batch_time=0.50034 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.94108 (QuantReg: 9.56771) QuantErr: 9.56771 batch_time=0.51946 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.72378 (QuantReg: 9.79607) QuantErr: 9.79607 batch_time=0.52959 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.91453 (QuantReg: 9.25635) QuantErr: 9.25635 batch_time=0.88792 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.52756 (QuantReg: 9.51820) QuantErr: 9.51820 batch_time=0.49439 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.69531 (QuantReg: 9.43192) QuantErr: 9.43192 batch_time=0.49142 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.93150 (QuantReg: 9.53111) QuantErr: 9.53111 batch_time=0.49869 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.93218 (QuantReg: 9.73361) QuantErr: 9.73361 batch_time=0.49365 
Train Epoch: 28 codebook_update_time=1.84889
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch28.pth ...
Done in 26.270s
removing stale ckpt [epoch 27] [took 0.34s]
 epoch          : 28
 loss           : 1.82543349981308
 quant_reg      : 9.460168060302735
 quant_err      : 9.460168060302735
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.202
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.5799201141205
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.379
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.19505941950362
 mnt_best       : 42.61552770659113
 not_improved_count: 1
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 2.40296 (QuantReg: 9.46730) QuantErr: 9.46730 batch_time=34.62653 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 2.01097 (QuantReg: 9.57021) QuantErr: 9.57021 batch_time=0.48827 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.97167 (QuantReg: 9.65154) QuantErr: 9.65154 batch_time=0.49858 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.84451 (QuantReg: 9.44068) QuantErr: 9.44068 batch_time=0.50352 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 2.01887 (QuantReg: 9.41136) QuantErr: 9.41136 batch_time=0.49286 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.65863 (QuantReg: 9.52330) QuantErr: 9.52330 batch_time=0.49679 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.68678 (QuantReg: 9.27907) QuantErr: 9.27907 batch_time=1.17228 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.72977 (QuantReg: 9.65464) QuantErr: 9.65464 batch_time=0.52277 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.83814 (QuantReg: 9.34966) QuantErr: 9.34966 batch_time=0.49985 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.96684 (QuantReg: 9.64790) QuantErr: 9.64790 batch_time=0.49675 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 2.28126 (QuantReg: 9.49093) QuantErr: 9.49093 batch_time=0.49977 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.90861 (QuantReg: 9.27826) QuantErr: 9.27826 batch_time=0.51430 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.97849 (QuantReg: 9.38172) QuantErr: 9.38172 batch_time=0.50576 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.73523 (QuantReg: 9.53901) QuantErr: 9.53901 batch_time=0.49968 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.73806 (QuantReg: 9.84061) QuantErr: 9.84061 batch_time=0.50066 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.77707 (QuantReg: 9.41055) QuantErr: 9.41055 batch_time=0.51994 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.83126 (QuantReg: 9.65927) QuantErr: 9.65927 batch_time=0.49625 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.92511 (QuantReg: 9.76911) QuantErr: 9.76911 batch_time=0.49573 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 2.04050 (QuantReg: 9.22833) QuantErr: 9.22833 batch_time=0.49955 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.67033 (QuantReg: 9.47960) QuantErr: 9.47960 batch_time=0.48475 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.79386 (QuantReg: 9.31012) QuantErr: 9.31012 batch_time=0.48741 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.46049 (QuantReg: 9.56007) QuantErr: 9.56007 batch_time=0.48779 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.93143 (QuantReg: 9.40379) QuantErr: 9.40379 batch_time=0.48750 
Train Epoch: 29 codebook_update_time=1.62249
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch29.pth ...
Done in 5.626s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch29.pth ...
Done in 10.680s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 1.8082072563171387
 quant_reg      : 9.434904922485352
 quant_err      : 9.434904922485352
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.027
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.796415689589914
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.002
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.83458063436915
 mnt_best       : 42.796415689589914
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.77868 (QuantReg: 9.43213) QuantErr: 9.43213 batch_time=30.38782 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.73148 (QuantReg: 9.15441) QuantErr: 9.15441 batch_time=0.51004 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.71420 (QuantReg: 9.36575) QuantErr: 9.36575 batch_time=0.49500 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.74062 (QuantReg: 9.48388) QuantErr: 9.48388 batch_time=0.54680 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.78908 (QuantReg: 9.42826) QuantErr: 9.42826 batch_time=0.96814 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.74952 (QuantReg: 9.40167) QuantErr: 9.40167 batch_time=0.49692 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 2.04210 (QuantReg: 9.69848) QuantErr: 9.69848 batch_time=0.49951 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.81085 (QuantReg: 9.70226) QuantErr: 9.70226 batch_time=1.42791 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.79371 (QuantReg: 9.35817) QuantErr: 9.35817 batch_time=0.73706 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.91322 (QuantReg: 9.57838) QuantErr: 9.57838 batch_time=0.54283 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.67785 (QuantReg: 9.54318) QuantErr: 9.54318 batch_time=0.51266 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.63461 (QuantReg: 9.46478) QuantErr: 9.46478 batch_time=0.51232 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.54987 (QuantReg: 9.55569) QuantErr: 9.55569 batch_time=0.50722 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 2.02133 (QuantReg: 9.61365) QuantErr: 9.61365 batch_time=0.49223 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.94475 (QuantReg: 9.35288) QuantErr: 9.35288 batch_time=0.48745 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.60121 (QuantReg: 9.49927) QuantErr: 9.49927 batch_time=0.49815 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.94247 (QuantReg: 8.83448) QuantErr: 8.83448 batch_time=0.48917 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.98381 (QuantReg: 9.22642) QuantErr: 9.22642 batch_time=0.51740 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.63182 (QuantReg: 9.42048) QuantErr: 9.42048 batch_time=0.49607 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 2.02577 (QuantReg: 9.26775) QuantErr: 9.26775 batch_time=0.79656 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.81162 (QuantReg: 9.41919) QuantErr: 9.41919 batch_time=0.50797 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.68511 (QuantReg: 9.33793) QuantErr: 9.33793 batch_time=0.49047 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.77000 (QuantReg: 9.66832) QuantErr: 9.66832 batch_time=0.50186 
Train Epoch: 30 codebook_update_time=1.68503
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch30.pth ...
Done in 4.692s
removing stale ckpt [epoch 29] [took 0.28s]
 epoch          : 30
 loss           : 1.8117922778129578
 quant_reg      : 9.43046856689453
 quant_err      : 9.43046856689453
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.433
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.97522348202071
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.474
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.29846058513674
 mnt_best       : 42.796415689589914
 not_improved_count: 1
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 2.05325 (QuantReg: 9.34446) QuantErr: 9.34446 batch_time=29.99263 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.72300 (QuantReg: 9.22791) QuantErr: 9.22791 batch_time=0.49470 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.52741 (QuantReg: 9.16916) QuantErr: 9.16916 batch_time=0.49222 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.93047 (QuantReg: 9.37631) QuantErr: 9.37631 batch_time=0.49525 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.79004 (QuantReg: 9.54569) QuantErr: 9.54569 batch_time=0.51127 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.94562 (QuantReg: 9.49970) QuantErr: 9.49970 batch_time=0.52974 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.80685 (QuantReg: 9.53273) QuantErr: 9.53273 batch_time=0.51721 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.52661 (QuantReg: 9.50517) QuantErr: 9.50517 batch_time=0.53885 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.81092 (QuantReg: 9.41584) QuantErr: 9.41584 batch_time=0.52541 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.72058 (QuantReg: 9.58834) QuantErr: 9.58834 batch_time=0.49411 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.96427 (QuantReg: 9.78143) QuantErr: 9.78143 batch_time=0.49547 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.61363 (QuantReg: 9.41391) QuantErr: 9.41391 batch_time=0.48968 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.55624 (QuantReg: 9.41095) QuantErr: 9.41095 batch_time=0.63444 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.87377 (QuantReg: 9.26639) QuantErr: 9.26639 batch_time=3.31761 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.78840 (QuantReg: 9.43070) QuantErr: 9.43070 batch_time=0.48762 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.67610 (QuantReg: 9.58538) QuantErr: 9.58538 batch_time=0.48491 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.68935 (QuantReg: 9.66453) QuantErr: 9.66453 batch_time=0.50870 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.76562 (QuantReg: 9.49619) QuantErr: 9.49619 batch_time=0.51195 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.69330 (QuantReg: 9.26525) QuantErr: 9.26525 batch_time=0.50387 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.77775 (QuantReg: 9.37342) QuantErr: 9.37342 batch_time=0.52257 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.81460 (QuantReg: 9.43211) QuantErr: 9.43211 batch_time=0.48752 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.65829 (QuantReg: 9.49636) QuantErr: 9.49636 batch_time=0.48872 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.90958 (QuantReg: 9.06530) QuantErr: 9.06530 batch_time=0.50313 
Train Epoch: 31 codebook_update_time=1.71357
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch31.pth ...
Done in 4.768s
removing stale ckpt [epoch 30] [took 0.02s]
 epoch          : 31
 loss           : 1.807407645702362
 quant_reg      : 9.483953136444091
 quant_err      : 9.483953136444091
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.584
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.152590641572814
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.259
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.94522320176023
 mnt_best       : 42.796415689589914
 not_improved_count: 2
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.77161 (QuantReg: 9.39928) QuantErr: 9.39928 batch_time=29.75680 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.86131 (QuantReg: 9.42060) QuantErr: 9.42060 batch_time=0.48719 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 2.06007 (QuantReg: 9.58774) QuantErr: 9.58774 batch_time=3.21390 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.72925 (QuantReg: 9.23470) QuantErr: 9.23470 batch_time=0.59988 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 1.69236 (QuantReg: 9.58942) QuantErr: 9.58942 batch_time=0.49898 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.55663 (QuantReg: 9.60916) QuantErr: 9.60916 batch_time=0.49562 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.74795 (QuantReg: 9.42678) QuantErr: 9.42678 batch_time=0.51586 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.99861 (QuantReg: 9.65183) QuantErr: 9.65183 batch_time=0.50233 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.58747 (QuantReg: 9.49358) QuantErr: 9.49358 batch_time=0.50567 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.99443 (QuantReg: 9.27352) QuantErr: 9.27352 batch_time=0.50917 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.95178 (QuantReg: 9.24210) QuantErr: 9.24210 batch_time=0.50603 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.85145 (QuantReg: 9.27846) QuantErr: 9.27846 batch_time=0.52575 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.95019 (QuantReg: 9.48881) QuantErr: 9.48881 batch_time=0.50386 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.76127 (QuantReg: 9.44989) QuantErr: 9.44989 batch_time=0.49985 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 2.01243 (QuantReg: 9.40570) QuantErr: 9.40570 batch_time=0.49840 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.95123 (QuantReg: 9.36928) QuantErr: 9.36928 batch_time=0.49481 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.85898 (QuantReg: 9.17522) QuantErr: 9.17522 batch_time=0.49249 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.54303 (QuantReg: 9.48469) QuantErr: 9.48469 batch_time=0.50012 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 2.06822 (QuantReg: 9.51195) QuantErr: 9.51195 batch_time=0.49778 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.71013 (QuantReg: 9.50000) QuantErr: 9.50000 batch_time=0.50787 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.76072 (QuantReg: 9.55612) QuantErr: 9.55612 batch_time=0.50528 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.48931 (QuantReg: 9.50449) QuantErr: 9.50449 batch_time=0.89858 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 2.05157 (QuantReg: 9.37791) QuantErr: 9.37791 batch_time=0.51075 
Train Epoch: 32 codebook_update_time=2.05734
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch32.pth ...
Done in 4.202s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch32.pth ...
Done in 9.081s
removing stale ckpt [epoch 31] [took 0.01s]
 epoch          : 32
 loss           : 1.796507634162903
 quant_reg      : 9.462558437347413
 quant_err      : 9.462558437347413
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.861
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.92455926646922
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.194
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.086235629958836
 mnt_best       : 42.92455926646922
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.81571 (QuantReg: 9.38306) QuantErr: 9.38306 batch_time=40.16074 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.91485 (QuantReg: 9.49480) QuantErr: 9.49480 batch_time=0.50085 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.87045 (QuantReg: 9.36744) QuantErr: 9.36744 batch_time=0.47986 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.88561 (QuantReg: 9.47574) QuantErr: 9.47574 batch_time=0.49558 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 2.15396 (QuantReg: 9.35333) QuantErr: 9.35333 batch_time=0.48206 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.82343 (QuantReg: 9.38193) QuantErr: 9.38193 batch_time=0.49486 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 1.41592 (QuantReg: 9.07981) QuantErr: 9.07981 batch_time=0.50367 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.78284 (QuantReg: 9.48611) QuantErr: 9.48611 batch_time=0.48046 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.85681 (QuantReg: 9.41311) QuantErr: 9.41311 batch_time=0.53003 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.71726 (QuantReg: 9.44307) QuantErr: 9.44307 batch_time=0.48151 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.88891 (QuantReg: 9.38459) QuantErr: 9.38459 batch_time=0.49993 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.78347 (QuantReg: 9.55477) QuantErr: 9.55477 batch_time=0.51403 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.83705 (QuantReg: 9.47676) QuantErr: 9.47676 batch_time=0.49716 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.66244 (QuantReg: 9.37565) QuantErr: 9.37565 batch_time=0.50054 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.70756 (QuantReg: 9.66513) QuantErr: 9.66513 batch_time=0.52349 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.52859 (QuantReg: 9.75329) QuantErr: 9.75329 batch_time=0.48672 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 1.57308 (QuantReg: 9.24599) QuantErr: 9.24599 batch_time=0.49822 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 2.17771 (QuantReg: 9.52849) QuantErr: 9.52849 batch_time=0.51224 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.83935 (QuantReg: 9.26674) QuantErr: 9.26674 batch_time=0.49211 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.71437 (QuantReg: 9.12589) QuantErr: 9.12589 batch_time=0.50461 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 1.55935 (QuantReg: 9.21743) QuantErr: 9.21743 batch_time=0.50042 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.80254 (QuantReg: 9.25879) QuantErr: 9.25879 batch_time=0.50214 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.87359 (QuantReg: 9.53220) QuantErr: 9.53220 batch_time=0.49551 
Train Epoch: 33 codebook_update_time=1.74408
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch33.pth ...
Done in 3.998s
removing stale ckpt [epoch 32] [took 0.02s]
 epoch          : 33
 loss           : 1.7954665756225585
 quant_reg      : 9.450297760009766
 quant_err      : 9.450297760009766
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.582
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.8477198701215
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.877
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.45794146832731
 mnt_best       : 42.92455926646922
 not_improved_count: 1
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.70850 (QuantReg: 9.34546) QuantErr: 9.34546 batch_time=30.11862 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.70711 (QuantReg: 9.36725) QuantErr: 9.36725 batch_time=0.49676 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.98539 (QuantReg: 9.57599) QuantErr: 9.57599 batch_time=0.49275 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.61906 (QuantReg: 9.51009) QuantErr: 9.51009 batch_time=0.53523 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.40844 (QuantReg: 9.00588) QuantErr: 9.00588 batch_time=0.50374 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.98980 (QuantReg: 9.66382) QuantErr: 9.66382 batch_time=0.52066 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.64544 (QuantReg: 9.29630) QuantErr: 9.29630 batch_time=0.48960 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.87797 (QuantReg: 9.48353) QuantErr: 9.48353 batch_time=0.50276 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 2.06112 (QuantReg: 9.56582) QuantErr: 9.56582 batch_time=0.54605 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.91357 (QuantReg: 9.61196) QuantErr: 9.61196 batch_time=0.49577 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.59148 (QuantReg: 9.40967) QuantErr: 9.40967 batch_time=0.49690 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.70202 (QuantReg: 9.43685) QuantErr: 9.43685 batch_time=0.49468 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.84311 (QuantReg: 9.73607) QuantErr: 9.73607 batch_time=0.49200 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.78700 (QuantReg: 9.44815) QuantErr: 9.44815 batch_time=0.49661 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.97309 (QuantReg: 9.40242) QuantErr: 9.40242 batch_time=0.49695 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.71832 (QuantReg: 9.19084) QuantErr: 9.19084 batch_time=0.57145 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.92822 (QuantReg: 9.52271) QuantErr: 9.52271 batch_time=0.51271 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.84473 (QuantReg: 9.64356) QuantErr: 9.64356 batch_time=0.49352 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.91479 (QuantReg: 9.24230) QuantErr: 9.24230 batch_time=0.62594 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.72461 (QuantReg: 9.37220) QuantErr: 9.37220 batch_time=0.51880 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.65911 (QuantReg: 9.12689) QuantErr: 9.12689 batch_time=0.52782 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.53367 (QuantReg: 9.36623) QuantErr: 9.36623 batch_time=0.50378 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.87410 (QuantReg: 9.58095) QuantErr: 9.58095 batch_time=0.50568 
Train Epoch: 34 codebook_update_time=1.70918
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch34.pth ...
Done in 3.939s
removing stale ckpt [epoch 33] [took 0.01s]
 epoch          : 34
 loss           : 1.7766690530776978
 quant_reg      : 9.43704139328003
 quant_err      : 9.43704139328003
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.346000000000004
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.19999850257927
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.4545
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.996135698889276
 mnt_best       : 42.92455926646922
 not_improved_count: 2
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.61504 (QuantReg: 9.52361) QuantErr: 9.52361 batch_time=30.80468 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 2.02504 (QuantReg: 9.63392) QuantErr: 9.63392 batch_time=0.54730 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.86405 (QuantReg: 9.50273) QuantErr: 9.50273 batch_time=0.53300 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.92382 (QuantReg: 9.61157) QuantErr: 9.61157 batch_time=0.55905 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.76019 (QuantReg: 9.69128) QuantErr: 9.69128 batch_time=0.51765 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.57744 (QuantReg: 9.24536) QuantErr: 9.24536 batch_time=0.52782 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.96259 (QuantReg: 9.33511) QuantErr: 9.33511 batch_time=2.58537 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.89973 (QuantReg: 9.57374) QuantErr: 9.57374 batch_time=0.49658 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.80714 (QuantReg: 9.21822) QuantErr: 9.21822 batch_time=0.49314 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 2.04868 (QuantReg: 9.56334) QuantErr: 9.56334 batch_time=0.52356 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.56809 (QuantReg: 9.24745) QuantErr: 9.24745 batch_time=0.50379 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.88416 (QuantReg: 9.53860) QuantErr: 9.53860 batch_time=0.49104 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.84788 (QuantReg: 9.62638) QuantErr: 9.62638 batch_time=3.82938 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.66270 (QuantReg: 9.46262) QuantErr: 9.46262 batch_time=0.49915 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.97129 (QuantReg: 9.48465) QuantErr: 9.48465 batch_time=0.50144 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 1.52721 (QuantReg: 9.30955) QuantErr: 9.30955 batch_time=0.50073 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.57637 (QuantReg: 9.26764) QuantErr: 9.26764 batch_time=0.53867 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.94067 (QuantReg: 9.06309) QuantErr: 9.06309 batch_time=0.51933 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 2.05044 (QuantReg: 9.35700) QuantErr: 9.35700 batch_time=0.56380 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.82487 (QuantReg: 9.64795) QuantErr: 9.64795 batch_time=0.51667 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.51084 (QuantReg: 9.47094) QuantErr: 9.47094 batch_time=0.51583 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.72899 (QuantReg: 9.58016) QuantErr: 9.58016 batch_time=0.54410 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.78520 (QuantReg: 9.46029) QuantErr: 9.46029 batch_time=0.49160 
Train Epoch: 35 codebook_update_time=1.70191
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch35.pth ...
Done in 4.147s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch35.pth ...
Done in 8.757s
removing stale ckpt [epoch 34] [took 0.04s]
 epoch          : 35
 loss           : 1.7627422814369202
 quant_reg      : 9.452181739807129
 quant_err      : 9.452181739807129
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.936
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.11210803886884
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.2475
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.73314812197447
 mnt_best       : 43.11210803886884
 not_improved_count: 0
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.84829 (QuantReg: 9.49323) QuantErr: 9.49323 batch_time=31.78339 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.87959 (QuantReg: 9.48234) QuantErr: 9.48234 batch_time=1.02640 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 1.56749 (QuantReg: 9.49441) QuantErr: 9.49441 batch_time=0.60923 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.86323 (QuantReg: 9.38190) QuantErr: 9.38190 batch_time=0.50540 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.77167 (QuantReg: 9.19431) QuantErr: 9.19431 batch_time=0.49291 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 1.46315 (QuantReg: 9.24514) QuantErr: 9.24514 batch_time=0.51046 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.76258 (QuantReg: 9.06891) QuantErr: 9.06891 batch_time=0.48807 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.61517 (QuantReg: 9.22095) QuantErr: 9.22095 batch_time=0.53328 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.93331 (QuantReg: 9.44396) QuantErr: 9.44396 batch_time=0.49169 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.72903 (QuantReg: 9.30941) QuantErr: 9.30941 batch_time=0.88695 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.83459 (QuantReg: 9.44497) QuantErr: 9.44497 batch_time=0.48892 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 2.01558 (QuantReg: 9.51763) QuantErr: 9.51763 batch_time=0.51266 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.66967 (QuantReg: 9.48152) QuantErr: 9.48152 batch_time=0.51099 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.73718 (QuantReg: 9.47237) QuantErr: 9.47237 batch_time=0.59559 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.98675 (QuantReg: 9.42756) QuantErr: 9.42756 batch_time=0.49891 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 1.65044 (QuantReg: 9.45014) QuantErr: 9.45014 batch_time=0.56877 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.78885 (QuantReg: 9.62633) QuantErr: 9.62633 batch_time=0.52056 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.75841 (QuantReg: 8.96219) QuantErr: 8.96219 batch_time=0.52213 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.64423 (QuantReg: 9.58866) QuantErr: 9.58866 batch_time=0.51244 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.78600 (QuantReg: 9.51457) QuantErr: 9.51457 batch_time=0.50995 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 1.66379 (QuantReg: 9.60633) QuantErr: 9.60633 batch_time=0.49784 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.60368 (QuantReg: 9.30064) QuantErr: 9.30064 batch_time=0.53890 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 1.45369 (QuantReg: 9.34687) QuantErr: 9.34687 batch_time=0.49471 
Train Epoch: 36 codebook_update_time=1.77732
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch36.pth ...
Done in 5.719s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch36.pth ...
Done in 9.573s
removing stale ckpt [epoch 35] [took 0.01s]
 epoch          : 36
 loss           : 1.7655662183761596
 quant_reg      : 9.461513401031494
 quant_err      : 9.461513401031494
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.472
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.2599184264705
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.6755
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.80066016392275
 mnt_best       : 43.2599184264705
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.88157 (QuantReg: 9.31495) QuantErr: 9.31495 batch_time=38.66428 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.63762 (QuantReg: 9.40439) QuantErr: 9.40439 batch_time=0.49948 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 1.62263 (QuantReg: 9.42041) QuantErr: 9.42041 batch_time=0.49561 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.76289 (QuantReg: 9.26993) QuantErr: 9.26993 batch_time=0.49394 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.58085 (QuantReg: 9.69427) QuantErr: 9.69427 batch_time=0.48728 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.62349 (QuantReg: 9.32570) QuantErr: 9.32570 batch_time=0.49052 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.70464 (QuantReg: 9.02596) QuantErr: 9.02596 batch_time=0.50591 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 2.03221 (QuantReg: 9.71491) QuantErr: 9.71491 batch_time=0.48931 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.82102 (QuantReg: 9.50200) QuantErr: 9.50200 batch_time=0.51924 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.49165 (QuantReg: 9.53327) QuantErr: 9.53327 batch_time=0.49878 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.69746 (QuantReg: 9.56326) QuantErr: 9.56326 batch_time=0.48779 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.51164 (QuantReg: 9.45479) QuantErr: 9.45479 batch_time=0.80163 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.68696 (QuantReg: 9.35564) QuantErr: 9.35564 batch_time=0.71845 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.92123 (QuantReg: 9.56179) QuantErr: 9.56179 batch_time=0.48744 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 1.47904 (QuantReg: 9.60497) QuantErr: 9.60497 batch_time=0.50893 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 1.57539 (QuantReg: 9.34689) QuantErr: 9.34689 batch_time=0.50258 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.73200 (QuantReg: 9.58291) QuantErr: 9.58291 batch_time=0.49223 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 1.29278 (QuantReg: 9.51189) QuantErr: 9.51189 batch_time=0.51314 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.73034 (QuantReg: 9.16892) QuantErr: 9.16892 batch_time=0.49488 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.63044 (QuantReg: 9.79603) QuantErr: 9.79603 batch_time=0.48893 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.77400 (QuantReg: 9.28646) QuantErr: 9.28646 batch_time=0.48221 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.84165 (QuantReg: 9.29606) QuantErr: 9.29606 batch_time=0.49518 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.80721 (QuantReg: 9.64063) QuantErr: 9.64063 batch_time=0.50435 
Train Epoch: 37 codebook_update_time=1.66356
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch37.pth ...
Done in 3.806s
removing stale ckpt [epoch 36] [took 0.91s]
 epoch          : 37
 loss           : 1.7468260979652406
 quant_reg      : 9.466196712493897
 quant_err      : 9.466196712493897
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.547
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.00580415612459
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.27
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.5273988033942
 mnt_best       : 43.2599184264705
 not_improved_count: 1
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 1.46634 (QuantReg: 9.82883) QuantErr: 9.82883 batch_time=30.23482 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 1.51413 (QuantReg: 9.63111) QuantErr: 9.63111 batch_time=0.50417 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 1.58525 (QuantReg: 9.20933) QuantErr: 9.20933 batch_time=0.52298 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.57958 (QuantReg: 9.18278) QuantErr: 9.18278 batch_time=0.51965 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.91266 (QuantReg: 9.49484) QuantErr: 9.49484 batch_time=0.53583 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 1.72061 (QuantReg: 9.59772) QuantErr: 9.59772 batch_time=0.48563 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.54924 (QuantReg: 9.45384) QuantErr: 9.45384 batch_time=0.72823 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.94891 (QuantReg: 9.48571) QuantErr: 9.48571 batch_time=0.48693 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.91738 (QuantReg: 9.58932) QuantErr: 9.58932 batch_time=0.48217 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.79918 (QuantReg: 9.79042) QuantErr: 9.79042 batch_time=0.49268 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.74949 (QuantReg: 9.66852) QuantErr: 9.66852 batch_time=0.49345 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.87884 (QuantReg: 9.42204) QuantErr: 9.42204 batch_time=0.50868 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.81279 (QuantReg: 9.57218) QuantErr: 9.57218 batch_time=0.48339 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.93311 (QuantReg: 9.61106) QuantErr: 9.61106 batch_time=0.49873 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.80425 (QuantReg: 9.20527) QuantErr: 9.20527 batch_time=0.49746 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 1.62128 (QuantReg: 9.85299) QuantErr: 9.85299 batch_time=0.80468 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.64608 (QuantReg: 9.35414) QuantErr: 9.35414 batch_time=0.53027 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.44865 (QuantReg: 9.31129) QuantErr: 9.31129 batch_time=0.70545 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.70602 (QuantReg: 9.81779) QuantErr: 9.81779 batch_time=0.51296 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.61141 (QuantReg: 9.58540) QuantErr: 9.58540 batch_time=0.50134 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.68112 (QuantReg: 9.55717) QuantErr: 9.55717 batch_time=0.50427 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.77478 (QuantReg: 9.12620) QuantErr: 9.12620 batch_time=0.51663 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.74927 (QuantReg: 9.36250) QuantErr: 9.36250 batch_time=0.53343 
Train Epoch: 38 codebook_update_time=1.68512
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch38.pth ...
Done in 4.407s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.7409519276618957
 quant_reg      : 9.436954765319824
 quant_err      : 9.436954765319824
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.132000000000005
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.68213414900883
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.181
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.48858009202606
 mnt_best       : 43.2599184264705
 not_improved_count: 2
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 1.56387 (QuantReg: 9.27455) QuantErr: 9.27455 batch_time=31.77811 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.61343 (QuantReg: 9.90170) QuantErr: 9.90170 batch_time=0.50289 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 2.18965 (QuantReg: 9.55167) QuantErr: 9.55167 batch_time=1.02389 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.66067 (QuantReg: 9.53736) QuantErr: 9.53736 batch_time=0.80329 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 2.11234 (QuantReg: 9.50525) QuantErr: 9.50525 batch_time=0.50303 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.72319 (QuantReg: 9.38820) QuantErr: 9.38820 batch_time=0.48960 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.94539 (QuantReg: 9.33261) QuantErr: 9.33261 batch_time=0.50025 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.85933 (QuantReg: 9.31997) QuantErr: 9.31997 batch_time=0.48508 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.82438 (QuantReg: 9.76866) QuantErr: 9.76866 batch_time=0.49982 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.84057 (QuantReg: 9.49499) QuantErr: 9.49499 batch_time=0.49689 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.94116 (QuantReg: 9.80000) QuantErr: 9.80000 batch_time=0.50447 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.78510 (QuantReg: 9.48017) QuantErr: 9.48017 batch_time=0.49514 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 2.21072 (QuantReg: 9.27241) QuantErr: 9.27241 batch_time=0.49180 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.85794 (QuantReg: 9.54250) QuantErr: 9.54250 batch_time=0.49625 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.87806 (QuantReg: 9.64301) QuantErr: 9.64301 batch_time=0.50185 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.88473 (QuantReg: 9.56849) QuantErr: 9.56849 batch_time=0.70257 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.96071 (QuantReg: 9.57538) QuantErr: 9.57538 batch_time=0.49307 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.76247 (QuantReg: 9.69251) QuantErr: 9.69251 batch_time=0.50208 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 1.61822 (QuantReg: 9.39551) QuantErr: 9.39551 batch_time=0.49470 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 2.15202 (QuantReg: 9.32410) QuantErr: 9.32410 batch_time=0.51623 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.90523 (QuantReg: 9.35741) QuantErr: 9.35741 batch_time=0.50291 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.93167 (QuantReg: 9.43801) QuantErr: 9.43801 batch_time=0.50149 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 1.79692 (QuantReg: 9.51322) QuantErr: 9.51322 batch_time=0.49392 
Train Epoch: 39 codebook_update_time=1.61708
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch39.pth ...
Done in 3.848s
removing stale ckpt [epoch 38] [took 0.05s]
 epoch          : 39
 loss           : 1.7789502005577087
 quant_reg      : 9.491659622192383
 quant_err      : 9.491659622192383
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.556
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.34578480665262
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.864
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.54366575551955
 mnt_best       : 43.2599184264705
 not_improved_count: 3
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 2.05103 (QuantReg: 9.30715) QuantErr: 9.30715 batch_time=36.79135 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.49814 (QuantReg: 9.34852) QuantErr: 9.34852 batch_time=0.54100 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.66115 (QuantReg: 9.51362) QuantErr: 9.51362 batch_time=0.50491 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.67394 (QuantReg: 9.58178) QuantErr: 9.58178 batch_time=0.48959 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.86563 (QuantReg: 9.14746) QuantErr: 9.14746 batch_time=0.48890 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 2.02183 (QuantReg: 9.37164) QuantErr: 9.37164 batch_time=0.48749 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.82881 (QuantReg: 9.19579) QuantErr: 9.19579 batch_time=1.25750 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.85227 (QuantReg: 9.19864) QuantErr: 9.19864 batch_time=0.50681 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.89173 (QuantReg: 9.65807) QuantErr: 9.65807 batch_time=0.48983 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 1.59736 (QuantReg: 9.76347) QuantErr: 9.76347 batch_time=0.50658 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 2.09793 (QuantReg: 9.32435) QuantErr: 9.32435 batch_time=0.50640 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.79726 (QuantReg: 9.58480) QuantErr: 9.58480 batch_time=0.54051 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.89547 (QuantReg: 9.24939) QuantErr: 9.24939 batch_time=0.49079 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.86538 (QuantReg: 9.13756) QuantErr: 9.13756 batch_time=0.49479 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.50397 (QuantReg: 9.43466) QuantErr: 9.43466 batch_time=0.48768 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.71096 (QuantReg: 9.66769) QuantErr: 9.66769 batch_time=0.50016 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.96920 (QuantReg: 9.02909) QuantErr: 9.02909 batch_time=0.51565 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.82082 (QuantReg: 9.47147) QuantErr: 9.47147 batch_time=0.49420 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.68321 (QuantReg: 9.41170) QuantErr: 9.41170 batch_time=0.49749 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.86328 (QuantReg: 9.30535) QuantErr: 9.30535 batch_time=0.50454 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.85462 (QuantReg: 9.30199) QuantErr: 9.30199 batch_time=0.49004 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 1.79688 (QuantReg: 9.74058) QuantErr: 9.74058 batch_time=0.49384 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 1.59372 (QuantReg: 9.52285) QuantErr: 9.52285 batch_time=0.50013 
Train Epoch: 40 codebook_update_time=1.70498
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch40.pth ...
Done in 5.440s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 1.769378631591797
 quant_reg      : 9.455743545532227
 quant_err      : 9.455743545532227
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.268
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.84845881191912
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.2015
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.80777674072579
 mnt_best       : 43.2599184264705
 not_improved_count: 4
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.71202 (QuantReg: 9.63844) QuantErr: 9.63844 batch_time=34.56427 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.87751 (QuantReg: 9.60106) QuantErr: 9.60106 batch_time=2.35271 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.80534 (QuantReg: 9.11034) QuantErr: 9.11034 batch_time=0.52844 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.88801 (QuantReg: 9.47628) QuantErr: 9.47628 batch_time=0.49386 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.81881 (QuantReg: 9.57821) QuantErr: 9.57821 batch_time=0.49625 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 1.53003 (QuantReg: 9.50636) QuantErr: 9.50636 batch_time=0.49343 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 1.58996 (QuantReg: 9.51634) QuantErr: 9.51634 batch_time=0.48623 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.58573 (QuantReg: 9.10055) QuantErr: 9.10055 batch_time=0.49361 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.81448 (QuantReg: 9.69296) QuantErr: 9.69296 batch_time=0.50261 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.80167 (QuantReg: 9.49932) QuantErr: 9.49932 batch_time=0.49886 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.71178 (QuantReg: 9.58029) QuantErr: 9.58029 batch_time=0.53176 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.72661 (QuantReg: 9.32516) QuantErr: 9.32516 batch_time=0.49578 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.89192 (QuantReg: 9.42114) QuantErr: 9.42114 batch_time=0.73024 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.85305 (QuantReg: 9.58493) QuantErr: 9.58493 batch_time=0.50339 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.87939 (QuantReg: 9.50998) QuantErr: 9.50998 batch_time=0.49577 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.75840 (QuantReg: 9.48031) QuantErr: 9.48031 batch_time=0.51616 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.75516 (QuantReg: 9.55570) QuantErr: 9.55570 batch_time=0.50316 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 1.74643 (QuantReg: 9.63736) QuantErr: 9.63736 batch_time=0.51050 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 2.06538 (QuantReg: 9.42170) QuantErr: 9.42170 batch_time=0.49908 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.74844 (QuantReg: 9.27605) QuantErr: 9.27605 batch_time=0.48676 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.76238 (QuantReg: 9.65861) QuantErr: 9.65861 batch_time=0.49840 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 2.00790 (QuantReg: 9.37607) QuantErr: 9.37607 batch_time=0.50001 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.79043 (QuantReg: 9.18491) QuantErr: 9.18491 batch_time=0.49757 
Train Epoch: 41 codebook_update_time=1.67087
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch41.pth ...
Done in 4.538s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch41.pth ...
Done in 8.850s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.7708984727859498
 quant_reg      : 9.458342147827148
 quant_err      : 9.458342147827148
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.19
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.28395987368516
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.41
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.48479142102073
 mnt_best       : 43.28395987368516
 not_improved_count: 0
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.67032 (QuantReg: 9.50661) QuantErr: 9.50661 batch_time=31.41843 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.74211 (QuantReg: 9.84693) QuantErr: 9.84693 batch_time=0.49117 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.88343 (QuantReg: 9.47560) QuantErr: 9.47560 batch_time=0.55213 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.97354 (QuantReg: 9.33489) QuantErr: 9.33489 batch_time=0.49240 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.94751 (QuantReg: 9.37769) QuantErr: 9.37769 batch_time=0.49363 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.51641 (QuantReg: 9.41008) QuantErr: 9.41008 batch_time=0.48442 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.74960 (QuantReg: 9.45245) QuantErr: 9.45245 batch_time=0.49215 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.78760 (QuantReg: 9.71967) QuantErr: 9.71967 batch_time=0.51369 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 1.58122 (QuantReg: 9.40830) QuantErr: 9.40830 batch_time=0.50608 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.79102 (QuantReg: 9.60129) QuantErr: 9.60129 batch_time=0.49574 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.69140 (QuantReg: 9.23073) QuantErr: 9.23073 batch_time=0.70328 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.87371 (QuantReg: 9.31899) QuantErr: 9.31899 batch_time=0.50758 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.69497 (QuantReg: 9.40117) QuantErr: 9.40117 batch_time=0.49730 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 1.54337 (QuantReg: 9.56977) QuantErr: 9.56977 batch_time=0.49764 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.80544 (QuantReg: 9.51517) QuantErr: 9.51517 batch_time=0.48822 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.91661 (QuantReg: 9.62107) QuantErr: 9.62107 batch_time=0.49776 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 1.71321 (QuantReg: 9.49926) QuantErr: 9.49926 batch_time=0.49633 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 1.60812 (QuantReg: 9.66018) QuantErr: 9.66018 batch_time=0.50155 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 1.66363 (QuantReg: 9.64508) QuantErr: 9.64508 batch_time=0.48658 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.66879 (QuantReg: 9.34968) QuantErr: 9.34968 batch_time=0.52695 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.64319 (QuantReg: 9.31973) QuantErr: 9.31973 batch_time=0.49597 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 1.79316 (QuantReg: 9.24486) QuantErr: 9.24486 batch_time=0.48934 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.98638 (QuantReg: 9.75914) QuantErr: 9.75914 batch_time=0.49066 
Train Epoch: 42 codebook_update_time=1.61048
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch42.pth ...
Done in 5.937s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.7597213459014893
 quant_reg      : 9.477054641723633
 quant_err      : 9.477054641723633
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.678
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.84105589670684
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.8565
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.014453407022714
 mnt_best       : 43.28395987368516
 not_improved_count: 1
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 1.66354 (QuantReg: 9.68097) QuantErr: 9.68097 batch_time=29.05267 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.46568 (QuantReg: 9.51449) QuantErr: 9.51449 batch_time=0.50573 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.72085 (QuantReg: 9.55869) QuantErr: 9.55869 batch_time=0.50043 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.98313 (QuantReg: 9.66476) QuantErr: 9.66476 batch_time=3.04781 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.87934 (QuantReg: 9.43340) QuantErr: 9.43340 batch_time=0.51244 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.69077 (QuantReg: 9.61887) QuantErr: 9.61887 batch_time=0.49555 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.85765 (QuantReg: 9.51538) QuantErr: 9.51538 batch_time=0.49777 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.66678 (QuantReg: 9.53413) QuantErr: 9.53413 batch_time=0.86596 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.62324 (QuantReg: 9.47402) QuantErr: 9.47402 batch_time=0.49403 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.78214 (QuantReg: 9.49597) QuantErr: 9.49597 batch_time=0.49960 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.73314 (QuantReg: 9.66570) QuantErr: 9.66570 batch_time=0.49306 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 1.70726 (QuantReg: 9.59645) QuantErr: 9.59645 batch_time=0.49822 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.54414 (QuantReg: 9.55281) QuantErr: 9.55281 batch_time=0.72164 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 1.71426 (QuantReg: 9.20604) QuantErr: 9.20604 batch_time=0.48863 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.77833 (QuantReg: 9.65168) QuantErr: 9.65168 batch_time=0.62367 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.65530 (QuantReg: 9.60382) QuantErr: 9.60382 batch_time=0.72066 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.57381 (QuantReg: 9.82151) QuantErr: 9.82151 batch_time=0.49736 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.63942 (QuantReg: 9.55898) QuantErr: 9.55898 batch_time=0.61552 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 2.05929 (QuantReg: 9.78296) QuantErr: 9.78296 batch_time=0.55388 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.99146 (QuantReg: 9.74665) QuantErr: 9.74665 batch_time=0.49627 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.69812 (QuantReg: 9.66962) QuantErr: 9.66962 batch_time=0.49633 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 1.67672 (QuantReg: 9.44019) QuantErr: 9.44019 batch_time=0.50102 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.74115 (QuantReg: 9.16877) QuantErr: 9.16877 batch_time=0.50254 
Train Epoch: 43 codebook_update_time=1.68797
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch43.pth ...
Done in 3.919s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 1.7568592844009399
 quant_reg      : 9.47843616104126
 quant_err      : 9.47843616104126
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.739000000000004
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.55111322074157
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.3705
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.72036974178156
 mnt_best       : 43.28395987368516
 not_improved_count: 2
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 1.65605 (QuantReg: 9.51156) QuantErr: 9.51156 batch_time=29.61040 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.93208 (QuantReg: 9.57550) QuantErr: 9.57550 batch_time=0.50107 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.70197 (QuantReg: 9.47784) QuantErr: 9.47784 batch_time=0.52313 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.45043 (QuantReg: 9.47489) QuantErr: 9.47489 batch_time=0.76658 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.86348 (QuantReg: 9.42619) QuantErr: 9.42619 batch_time=0.49306 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 2.01875 (QuantReg: 9.20222) QuantErr: 9.20222 batch_time=0.50570 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.85496 (QuantReg: 9.47291) QuantErr: 9.47291 batch_time=1.22757 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.85132 (QuantReg: 9.37369) QuantErr: 9.37369 batch_time=0.57269 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.88457 (QuantReg: 9.38617) QuantErr: 9.38617 batch_time=0.52921 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.73507 (QuantReg: 9.17109) QuantErr: 9.17109 batch_time=0.49395 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.85891 (QuantReg: 9.51866) QuantErr: 9.51866 batch_time=0.48469 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.74949 (QuantReg: 9.39418) QuantErr: 9.39418 batch_time=0.52901 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.96453 (QuantReg: 9.65750) QuantErr: 9.65750 batch_time=0.51160 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.89274 (QuantReg: 9.32204) QuantErr: 9.32204 batch_time=1.55653 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.86133 (QuantReg: 9.42483) QuantErr: 9.42483 batch_time=0.50261 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 2.07136 (QuantReg: 9.48340) QuantErr: 9.48340 batch_time=0.51666 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.81776 (QuantReg: 9.48896) QuantErr: 9.48896 batch_time=0.49696 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.72374 (QuantReg: 9.44312) QuantErr: 9.44312 batch_time=0.50374 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.76829 (QuantReg: 9.54142) QuantErr: 9.54142 batch_time=0.49839 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.75520 (QuantReg: 9.46906) QuantErr: 9.46906 batch_time=0.52095 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.80231 (QuantReg: 9.48495) QuantErr: 9.48495 batch_time=0.50145 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.97056 (QuantReg: 9.52021) QuantErr: 9.52021 batch_time=0.49060 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.87489 (QuantReg: 9.42487) QuantErr: 9.42487 batch_time=0.49852 
Train Epoch: 44 codebook_update_time=1.64418
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch44.pth ...
Done in 3.610s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.7652318544387817
 quant_reg      : 9.480499389648438
 quant_err      : 9.480499389648438
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.382999999999996
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.92118372832221
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.422
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.65739152561464
 mnt_best       : 43.28395987368516
 not_improved_count: 3
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.93828 (QuantReg: 9.87171) QuantErr: 9.87171 batch_time=30.18534 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.77854 (QuantReg: 9.43236) QuantErr: 9.43236 batch_time=0.72079 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 1.44593 (QuantReg: 9.89225) QuantErr: 9.89225 batch_time=0.49086 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.90774 (QuantReg: 9.23899) QuantErr: 9.23899 batch_time=0.49634 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.79641 (QuantReg: 9.27486) QuantErr: 9.27486 batch_time=0.48806 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.83993 (QuantReg: 9.43657) QuantErr: 9.43657 batch_time=0.50419 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 1.54901 (QuantReg: 9.59754) QuantErr: 9.59754 batch_time=0.49411 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.84554 (QuantReg: 9.74140) QuantErr: 9.74140 batch_time=0.49921 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.74709 (QuantReg: 9.28757) QuantErr: 9.28757 batch_time=0.50453 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 1.62557 (QuantReg: 9.84872) QuantErr: 9.84872 batch_time=0.49055 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 1.55595 (QuantReg: 9.54813) QuantErr: 9.54813 batch_time=0.48254 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.73685 (QuantReg: 9.68573) QuantErr: 9.68573 batch_time=0.48490 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.44325 (QuantReg: 9.55326) QuantErr: 9.55326 batch_time=0.49900 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.85593 (QuantReg: 9.45901) QuantErr: 9.45901 batch_time=1.56786 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.90245 (QuantReg: 9.52604) QuantErr: 9.52604 batch_time=0.49561 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 1.61430 (QuantReg: 9.61302) QuantErr: 9.61302 batch_time=0.51021 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.95882 (QuantReg: 9.04633) QuantErr: 9.04633 batch_time=0.49431 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.88425 (QuantReg: 9.53099) QuantErr: 9.53099 batch_time=0.48610 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 1.59866 (QuantReg: 9.62139) QuantErr: 9.62139 batch_time=1.05623 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 1.49014 (QuantReg: 9.40103) QuantErr: 9.40103 batch_time=0.48645 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.84403 (QuantReg: 9.33050) QuantErr: 9.33050 batch_time=0.51899 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 1.54877 (QuantReg: 9.76622) QuantErr: 9.76622 batch_time=0.50354 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.76735 (QuantReg: 9.58385) QuantErr: 9.58385 batch_time=0.50073 
Train Epoch: 45 codebook_update_time=1.70879
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch45.pth ...
Done in 12.281s
removing stale ckpt [epoch 44] [took 0.02s]
 epoch          : 45
 loss           : 1.7491010637283326
 quant_reg      : 9.472578903198242
 quant_err      : 9.472578903198242
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.606
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.26466011535946
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.265
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.08198240942726
 mnt_best       : 43.28395987368516
 not_improved_count: 4
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 1.80690 (QuantReg: 9.62577) QuantErr: 9.62577 batch_time=36.24369 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 2.06063 (QuantReg: 8.96951) QuantErr: 8.96951 batch_time=0.49652 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.93022 (QuantReg: 9.71365) QuantErr: 9.71365 batch_time=0.52714 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.78942 (QuantReg: 9.51382) QuantErr: 9.51382 batch_time=0.48097 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.87751 (QuantReg: 9.42757) QuantErr: 9.42757 batch_time=0.48737 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.73889 (QuantReg: 9.42729) QuantErr: 9.42729 batch_time=0.48952 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.78443 (QuantReg: 9.48231) QuantErr: 9.48231 batch_time=0.48856 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.60266 (QuantReg: 9.20100) QuantErr: 9.20100 batch_time=0.48163 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 1.47731 (QuantReg: 9.29315) QuantErr: 9.29315 batch_time=0.49275 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 1.72257 (QuantReg: 9.96737) QuantErr: 9.96737 batch_time=0.49479 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.97264 (QuantReg: 9.47369) QuantErr: 9.47369 batch_time=0.49095 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.71415 (QuantReg: 9.41043) QuantErr: 9.41043 batch_time=0.53095 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.79716 (QuantReg: 9.22845) QuantErr: 9.22845 batch_time=0.83911 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.94290 (QuantReg: 9.18006) QuantErr: 9.18006 batch_time=0.52084 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.95585 (QuantReg: 9.44929) QuantErr: 9.44929 batch_time=0.49571 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.91218 (QuantReg: 9.48879) QuantErr: 9.48879 batch_time=0.51846 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.71486 (QuantReg: 9.23382) QuantErr: 9.23382 batch_time=0.49802 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.83993 (QuantReg: 9.73547) QuantErr: 9.73547 batch_time=0.49464 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 1.70288 (QuantReg: 9.65504) QuantErr: 9.65504 batch_time=0.53340 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 1.74377 (QuantReg: 9.70689) QuantErr: 9.70689 batch_time=0.49329 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.55171 (QuantReg: 9.32738) QuantErr: 9.32738 batch_time=0.50923 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.39428 (QuantReg: 9.46369) QuantErr: 9.46369 batch_time=1.88706 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.84577 (QuantReg: 9.74038) QuantErr: 9.74038 batch_time=0.51508 
Train Epoch: 46 codebook_update_time=1.65928
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch46.pth ...
Done in 6.287s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 1.7553404564857482
 quant_reg      : 9.459983497619628
 quant_err      : 9.459983497619628
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.951
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.62319924855043
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.232
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.61118025433685
 mnt_best       : 43.28395987368516
 not_improved_count: 5
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.97125 (QuantReg: 9.18914) QuantErr: 9.18914 batch_time=31.65840 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.74499 (QuantReg: 9.41317) QuantErr: 9.41317 batch_time=2.89541 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.87468 (QuantReg: 9.44626) QuantErr: 9.44626 batch_time=0.46530 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.92543 (QuantReg: 9.43048) QuantErr: 9.43048 batch_time=0.52004 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.75910 (QuantReg: 9.68436) QuantErr: 9.68436 batch_time=0.49338 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 1.62711 (QuantReg: 9.84568) QuantErr: 9.84568 batch_time=0.49498 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.69968 (QuantReg: 9.87756) QuantErr: 9.87756 batch_time=0.50048 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.82587 (QuantReg: 9.64564) QuantErr: 9.64564 batch_time=0.49583 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.87649 (QuantReg: 9.31429) QuantErr: 9.31429 batch_time=0.49572 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 1.61190 (QuantReg: 9.80557) QuantErr: 9.80557 batch_time=0.49745 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 1.69874 (QuantReg: 9.36773) QuantErr: 9.36773 batch_time=0.49137 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 1.68331 (QuantReg: 9.55746) QuantErr: 9.55746 batch_time=0.51035 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.80538 (QuantReg: 9.58697) QuantErr: 9.58697 batch_time=0.49501 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.48984 (QuantReg: 9.49767) QuantErr: 9.49767 batch_time=0.48053 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.89699 (QuantReg: 9.70151) QuantErr: 9.70151 batch_time=0.52379 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.66100 (QuantReg: 9.63182) QuantErr: 9.63182 batch_time=0.50195 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.93642 (QuantReg: 9.69848) QuantErr: 9.69848 batch_time=0.51429 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.90717 (QuantReg: 9.54011) QuantErr: 9.54011 batch_time=0.49461 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.66585 (QuantReg: 9.43735) QuantErr: 9.43735 batch_time=0.48752 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.66987 (QuantReg: 9.34323) QuantErr: 9.34323 batch_time=0.51626 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 1.45856 (QuantReg: 9.54670) QuantErr: 9.54670 batch_time=0.51188 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.91226 (QuantReg: 9.47200) QuantErr: 9.47200 batch_time=0.50024 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.76603 (QuantReg: 9.31845) QuantErr: 9.31845 batch_time=0.49112 
Train Epoch: 47 codebook_update_time=1.64347
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch47.pth ...
Done in 4.893s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 1.7590543050765992
 quant_reg      : 9.495568935394287
 quant_err      : 9.495568935394287
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.595
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.42641124746143
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.064
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.07630313611023
 mnt_best       : 43.28395987368516
 not_improved_count: 6
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.78702 (QuantReg: 9.34420) QuantErr: 9.34420 batch_time=31.19371 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.83315 (QuantReg: 9.65226) QuantErr: 9.65226 batch_time=0.49031 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.90465 (QuantReg: 9.45219) QuantErr: 9.45219 batch_time=0.49934 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.83484 (QuantReg: 9.37036) QuantErr: 9.37036 batch_time=0.50139 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.74042 (QuantReg: 9.32181) QuantErr: 9.32181 batch_time=0.48946 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.86204 (QuantReg: 9.81634) QuantErr: 9.81634 batch_time=0.51001 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.74762 (QuantReg: 9.57314) QuantErr: 9.57314 batch_time=0.48563 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.85316 (QuantReg: 9.55535) QuantErr: 9.55535 batch_time=0.49116 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.59050 (QuantReg: 9.82746) QuantErr: 9.82746 batch_time=0.56129 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.68048 (QuantReg: 9.57516) QuantErr: 9.57516 batch_time=0.50120 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.83581 (QuantReg: 9.54638) QuantErr: 9.54638 batch_time=0.50854 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.66643 (QuantReg: 9.24919) QuantErr: 9.24919 batch_time=0.49807 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.76549 (QuantReg: 9.44105) QuantErr: 9.44105 batch_time=0.50800 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 2.23347 (QuantReg: 9.53022) QuantErr: 9.53022 batch_time=0.49711 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.77123 (QuantReg: 9.42333) QuantErr: 9.42333 batch_time=0.50474 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.86604 (QuantReg: 9.35363) QuantErr: 9.35363 batch_time=0.51796 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 1.54111 (QuantReg: 9.62844) QuantErr: 9.62844 batch_time=0.62009 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.61515 (QuantReg: 9.75896) QuantErr: 9.75896 batch_time=0.50137 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.85401 (QuantReg: 9.47864) QuantErr: 9.47864 batch_time=0.51163 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.64280 (QuantReg: 9.51369) QuantErr: 9.51369 batch_time=0.53930 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.85019 (QuantReg: 9.60996) QuantErr: 9.60996 batch_time=0.60190 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.80243 (QuantReg: 9.34206) QuantErr: 9.34206 batch_time=0.49471 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.61411 (QuantReg: 9.46142) QuantErr: 9.46142 batch_time=0.49409 
Train Epoch: 48 codebook_update_time=1.63260
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch48.pth ...
Done in 5.283s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch48.pth ...
Done in 9.594s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 1.760073570251465
 quant_reg      : 9.493525302886964
 quant_err      : 9.493525302886964
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.387
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.29488211711958
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.664
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.79623805989453
 mnt_best       : 43.29488211711958
 not_improved_count: 0
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.78090 (QuantReg: 9.35080) QuantErr: 9.35080 batch_time=29.23280 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.85861 (QuantReg: 9.58329) QuantErr: 9.58329 batch_time=0.49612 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.67110 (QuantReg: 9.44759) QuantErr: 9.44759 batch_time=2.32535 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.98428 (QuantReg: 9.63810) QuantErr: 9.63810 batch_time=0.50980 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.83576 (QuantReg: 9.27963) QuantErr: 9.27963 batch_time=0.54148 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.76366 (QuantReg: 9.53032) QuantErr: 9.53032 batch_time=0.50818 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.57803 (QuantReg: 9.20972) QuantErr: 9.20972 batch_time=3.72783 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 1.58862 (QuantReg: 9.68836) QuantErr: 9.68836 batch_time=0.50145 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 1.49712 (QuantReg: 9.15619) QuantErr: 9.15619 batch_time=0.51643 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.76319 (QuantReg: 9.47458) QuantErr: 9.47458 batch_time=0.52498 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.82994 (QuantReg: 9.51510) QuantErr: 9.51510 batch_time=0.53637 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.60764 (QuantReg: 9.41719) QuantErr: 9.41719 batch_time=0.48941 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.88211 (QuantReg: 9.38486) QuantErr: 9.38486 batch_time=0.50086 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.76783 (QuantReg: 9.30844) QuantErr: 9.30844 batch_time=0.49382 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.68154 (QuantReg: 9.27870) QuantErr: 9.27870 batch_time=0.50614 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 1.51509 (QuantReg: 9.41490) QuantErr: 9.41490 batch_time=0.49520 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 1.61314 (QuantReg: 9.22328) QuantErr: 9.22328 batch_time=0.48913 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.83488 (QuantReg: 9.54801) QuantErr: 9.54801 batch_time=0.49786 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.90926 (QuantReg: 9.55993) QuantErr: 9.55993 batch_time=0.50409 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.90499 (QuantReg: 9.33594) QuantErr: 9.33594 batch_time=0.49630 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.56322 (QuantReg: 9.38768) QuantErr: 9.38768 batch_time=0.50593 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 1.36326 (QuantReg: 9.24808) QuantErr: 9.24808 batch_time=0.50076 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.74649 (QuantReg: 9.44708) QuantErr: 9.44708 batch_time=0.50233 
Train Epoch: 49 codebook_update_time=2.07869
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch49.pth ...
Done in 4.635s
removing stale ckpt [epoch 48] [took 0.11s]
 epoch          : 49
 loss           : 1.7687216787338256
 quant_reg      : 9.483260692596435
 quant_err      : 9.483260692596435
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.93
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.280448515526956
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.0205
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.33855831802443
 mnt_best       : 43.29488211711958
 not_improved_count: 1
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.72353 (QuantReg: 9.62251) QuantErr: 9.62251 batch_time=31.49939 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 2.32133 (QuantReg: 9.48341) QuantErr: 9.48341 batch_time=0.50451 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.59991 (QuantReg: 9.68081) QuantErr: 9.68081 batch_time=0.57337 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.79706 (QuantReg: 9.46504) QuantErr: 9.46504 batch_time=0.85730 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.82688 (QuantReg: 9.34844) QuantErr: 9.34844 batch_time=0.49686 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 1.80228 (QuantReg: 9.56275) QuantErr: 9.56275 batch_time=0.49757 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.87953 (QuantReg: 9.57673) QuantErr: 9.57673 batch_time=0.49768 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 1.70203 (QuantReg: 9.63347) QuantErr: 9.63347 batch_time=0.49120 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 1.60238 (QuantReg: 9.53541) QuantErr: 9.53541 batch_time=0.49071 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.78699 (QuantReg: 9.70091) QuantErr: 9.70091 batch_time=0.53032 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.51206 (QuantReg: 9.76349) QuantErr: 9.76349 batch_time=0.48908 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 1.59619 (QuantReg: 9.34005) QuantErr: 9.34005 batch_time=0.48810 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.78789 (QuantReg: 9.57847) QuantErr: 9.57847 batch_time=1.27506 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.94025 (QuantReg: 9.31647) QuantErr: 9.31647 batch_time=0.48951 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.76404 (QuantReg: 9.32162) QuantErr: 9.32162 batch_time=0.49489 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 1.54795 (QuantReg: 9.59413) QuantErr: 9.59413 batch_time=0.50335 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.89353 (QuantReg: 9.60212) QuantErr: 9.60212 batch_time=0.49774 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.87647 (QuantReg: 9.63506) QuantErr: 9.63506 batch_time=0.50530 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.82592 (QuantReg: 9.73092) QuantErr: 9.73092 batch_time=3.12588 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 1.74248 (QuantReg: 9.59853) QuantErr: 9.59853 batch_time=0.50176 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.78589 (QuantReg: 9.52522) QuantErr: 9.52522 batch_time=0.49432 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.74971 (QuantReg: 9.39967) QuantErr: 9.39967 batch_time=0.50558 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.84755 (QuantReg: 9.51939) QuantErr: 9.51939 batch_time=0.49224 
Train Epoch: 50 codebook_update_time=1.65569
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch50.pth ...
Done in 20.716s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/checkpoint-epoch50.pth ...
Done in 25.361s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 1.7602269382476807
 quant_reg      : 9.529721549987793
 quant_err      : 9.529721549987793
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.739000000000004
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.52090033651817
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.088
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.3610309447918
 mnt_best       : 43.52090033651817
 not_improved_count: 0
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/trained_model.pth ...
Ckpt loaded at epoch 50.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 23.9
 t2v_metrics/R5/final_eval: 52.1
 t2v_metrics/R10/final_eval: 66.2
 t2v_metrics/R50/final_eval: 87.1
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 32.739000000000004
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 43.52090033651817
 v2t_metrics/R1/final_eval: 22.5
 v2t_metrics/R5/final_eval: 54.0
 v2t_metrics/R10/final_eval: 67.1
 v2t_metrics/R50/final_eval: 87.7
 v2t_metrics/MedR/final_eval: 5.0
 v2t_metrics/MeanR/final_eval: 31.088
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 43.3610309447918
Best epoch for the monitored metric: 50
Script took 03h25m23s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.1/trained_model.pth
