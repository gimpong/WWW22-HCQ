Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 1399.2535359859467 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 83.5559434890747 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 61.18525171279907 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch0.pth ...
Done in 3.281s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch0.pth ...
Done in 5.054s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 486.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 496.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 6.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 509.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.537
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.5192494101851104
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.81458 (QuantReg: 22.49638) QuantErr: 22.49638 batch_time=40.98641 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.64904 (QuantReg: 22.50508) QuantErr: 22.50508 batch_time=0.54485 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.56301 (QuantReg: 22.53892) QuantErr: 22.53892 batch_time=0.51973 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.38077 (QuantReg: 22.57972) QuantErr: 22.57972 batch_time=0.54121 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.49565 (QuantReg: 22.64288) QuantErr: 22.64288 batch_time=0.50928 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 5.81904 (QuantReg: 22.60749) QuantErr: 22.60749 batch_time=0.51402 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 5.80113 (QuantReg: 22.57744) QuantErr: 22.57744 batch_time=0.55247 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.03843 (QuantReg: 22.62452) QuantErr: 22.62452 batch_time=0.54264 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 5.44199 (QuantReg: 22.60307) QuantErr: 22.60307 batch_time=0.51067 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 5.45282 (QuantReg: 22.62855) QuantErr: 22.62855 batch_time=0.51000 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 4.69521 (QuantReg: 22.58858) QuantErr: 22.58858 batch_time=0.52496 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 4.70020 (QuantReg: 22.61821) QuantErr: 22.61821 batch_time=0.52932 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.18677 (QuantReg: 22.63303) QuantErr: 22.63303 batch_time=0.55527 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 4.36814 (QuantReg: 22.64074) QuantErr: 22.64074 batch_time=0.51266 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 4.76453 (QuantReg: 22.65092) QuantErr: 22.65092 batch_time=0.58619 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 4.14957 (QuantReg: 22.68394) QuantErr: 22.68394 batch_time=0.51902 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 4.88900 (QuantReg: 22.67934) QuantErr: 22.67934 batch_time=0.77711 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 4.55495 (QuantReg: 22.66296) QuantErr: 22.66296 batch_time=0.51214 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 4.07463 (QuantReg: 22.65596) QuantErr: 22.65596 batch_time=0.55729 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 4.50904 (QuantReg: 22.63895) QuantErr: 22.63895 batch_time=0.49454 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 3.64325 (QuantReg: 22.69133) QuantErr: 22.69133 batch_time=0.49577 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 4.24828 (QuantReg: 22.66160) QuantErr: 22.66160 batch_time=0.50824 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 3.72175 (QuantReg: 22.68702) QuantErr: 22.68702 batch_time=0.82706 
Train Epoch: 1 codebook_update_time=1.99262
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch1.pth ...
Done in 3.863s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch1.pth ...
Done in 8.040s
 epoch          : 1
 loss           : 5.387369966506958
 quant_reg      : 22.620893562316894
 quant_err      : 22.620893562316894
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 11.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 33.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 46.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 78.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 13.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 42.634
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.050338866040132
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 32.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 44.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 13.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 40.342
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.649340267538104
 mnt_best       : 26.050338866040132
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 4.19658 (QuantReg: 11.69272) QuantErr: 11.69272 batch_time=34.68535 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.08692 (QuantReg: 11.80013) QuantErr: 11.80013 batch_time=0.52338 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.10345 (QuantReg: 12.24447) QuantErr: 12.24447 batch_time=0.50852 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 3.88845 (QuantReg: 12.18617) QuantErr: 12.18617 batch_time=0.52599 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 3.90425 (QuantReg: 12.89029) QuantErr: 12.89029 batch_time=0.52091 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 3.98323 (QuantReg: 12.80228) QuantErr: 12.80228 batch_time=0.50537 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 3.79906 (QuantReg: 12.67745) QuantErr: 12.67745 batch_time=0.53147 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 3.79444 (QuantReg: 12.96687) QuantErr: 12.96687 batch_time=0.50427 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 3.69514 (QuantReg: 13.12283) QuantErr: 13.12283 batch_time=0.60399 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 4.19967 (QuantReg: 13.11597) QuantErr: 13.11597 batch_time=0.51678 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 3.76746 (QuantReg: 13.01554) QuantErr: 13.01554 batch_time=0.51986 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 3.22834 (QuantReg: 13.54878) QuantErr: 13.54878 batch_time=0.54412 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 3.69089 (QuantReg: 13.49959) QuantErr: 13.49959 batch_time=0.52241 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.14207 (QuantReg: 13.48767) QuantErr: 13.48767 batch_time=0.50457 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 3.99794 (QuantReg: 13.62113) QuantErr: 13.62113 batch_time=0.54836 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 3.50833 (QuantReg: 13.92481) QuantErr: 13.92481 batch_time=0.50225 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 3.88538 (QuantReg: 13.81016) QuantErr: 13.81016 batch_time=0.50137 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 3.65736 (QuantReg: 14.21573) QuantErr: 14.21573 batch_time=0.52261 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 3.36101 (QuantReg: 14.32304) QuantErr: 14.32304 batch_time=0.50739 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 3.37064 (QuantReg: 14.35914) QuantErr: 14.35914 batch_time=0.51500 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 3.51937 (QuantReg: 14.32075) QuantErr: 14.32075 batch_time=0.49866 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 3.59926 (QuantReg: 14.26386) QuantErr: 14.26386 batch_time=0.51978 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 3.73343 (QuantReg: 14.39434) QuantErr: 14.39434 batch_time=0.52182 
Train Epoch: 2 codebook_update_time=1.72824
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch2.pth ...
Done in 22.141s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch2.pth ...
Done in 26.327s
removing stale ckpt [epoch 1] [took 0.01s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 3.718916591644287
 quant_reg      : 13.33253591156006
 quant_err      : 13.33253591156006
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 37.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.867
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.622781957921966
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 40.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 83.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.832499999999996
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.57993734634045
 mnt_best       : 30.622781957921966
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 3.37596 (QuantReg: 11.77480) QuantErr: 11.77480 batch_time=33.83422 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 3.23580 (QuantReg: 12.03973) QuantErr: 12.03973 batch_time=0.62434 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 3.32750 (QuantReg: 12.19064) QuantErr: 12.19064 batch_time=0.51522 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 2.93345 (QuantReg: 12.11860) QuantErr: 12.11860 batch_time=0.52485 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 2.86843 (QuantReg: 12.29593) QuantErr: 12.29593 batch_time=0.50227 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 2.37298 (QuantReg: 12.23400) QuantErr: 12.23400 batch_time=0.53396 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 3.76295 (QuantReg: 12.56815) QuantErr: 12.56815 batch_time=0.76102 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 3.46972 (QuantReg: 12.46091) QuantErr: 12.46091 batch_time=0.56047 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.37315 (QuantReg: 12.39373) QuantErr: 12.39373 batch_time=0.52684 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 2.67958 (QuantReg: 12.73173) QuantErr: 12.73173 batch_time=0.52088 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 3.45570 (QuantReg: 12.54875) QuantErr: 12.54875 batch_time=0.49698 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 3.17721 (QuantReg: 12.36061) QuantErr: 12.36061 batch_time=0.59451 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 2.89164 (QuantReg: 12.41958) QuantErr: 12.41958 batch_time=0.55876 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.39695 (QuantReg: 12.33929) QuantErr: 12.33929 batch_time=6.25142 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 3.56052 (QuantReg: 12.17668) QuantErr: 12.17668 batch_time=0.49652 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 2.88025 (QuantReg: 12.49620) QuantErr: 12.49620 batch_time=0.56279 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.23894 (QuantReg: 13.00611) QuantErr: 13.00611 batch_time=0.51808 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 2.86648 (QuantReg: 12.89405) QuantErr: 12.89405 batch_time=0.54912 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 2.96565 (QuantReg: 12.80971) QuantErr: 12.80971 batch_time=0.52220 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.03003 (QuantReg: 12.87893) QuantErr: 12.87893 batch_time=0.51312 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.13053 (QuantReg: 12.89266) QuantErr: 12.89266 batch_time=0.56557 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 3.10683 (QuantReg: 13.08313) QuantErr: 13.08313 batch_time=0.49616 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.14659 (QuantReg: 13.10741) QuantErr: 13.10741 batch_time=0.50104 
Train Epoch: 3 codebook_update_time=2.43907
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch3.pth ...
Done in 6.756s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch3.pth ...
Done in 11.010s
removing stale ckpt [epoch 2] [took 0.03s]
 epoch          : 3
 loss           : 3.155210781097412
 quant_reg      : 12.529800701141358
 quant_err      : 12.529800701141358
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 32.938
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.823669213496345
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.176
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.268330744522984
 mnt_best       : 32.823669213496345
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 3.03607 (QuantReg: 12.06786) QuantErr: 12.06786 batch_time=41.24024 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 2.79767 (QuantReg: 12.17486) QuantErr: 12.17486 batch_time=0.60257 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 2.89486 (QuantReg: 12.09010) QuantErr: 12.09010 batch_time=1.21130 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 2.76069 (QuantReg: 12.33063) QuantErr: 12.33063 batch_time=0.54612 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 2.80003 (QuantReg: 12.38696) QuantErr: 12.38696 batch_time=0.60028 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 2.94900 (QuantReg: 12.18429) QuantErr: 12.18429 batch_time=0.54614 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 2.73061 (QuantReg: 12.15209) QuantErr: 12.15209 batch_time=0.52881 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 2.85024 (QuantReg: 12.31035) QuantErr: 12.31035 batch_time=0.51099 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 3.12169 (QuantReg: 12.09410) QuantErr: 12.09410 batch_time=0.58615 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 2.47755 (QuantReg: 12.46868) QuantErr: 12.46868 batch_time=0.68268 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 2.82683 (QuantReg: 12.99284) QuantErr: 12.99284 batch_time=0.53642 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 2.53026 (QuantReg: 12.95136) QuantErr: 12.95136 batch_time=0.51298 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.02232 (QuantReg: 12.59953) QuantErr: 12.59953 batch_time=0.50035 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 2.58850 (QuantReg: 12.67277) QuantErr: 12.67277 batch_time=0.50990 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 2.71110 (QuantReg: 12.69187) QuantErr: 12.69187 batch_time=0.50513 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 2.81785 (QuantReg: 12.68870) QuantErr: 12.68870 batch_time=0.51365 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 2.83058 (QuantReg: 12.52363) QuantErr: 12.52363 batch_time=0.60428 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 2.84934 (QuantReg: 12.80585) QuantErr: 12.80585 batch_time=0.50648 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.62535 (QuantReg: 13.07942) QuantErr: 13.07942 batch_time=0.49043 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 2.45501 (QuantReg: 12.70068) QuantErr: 12.70068 batch_time=1.16511 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 2.36078 (QuantReg: 13.22988) QuantErr: 13.22988 batch_time=0.51655 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 2.19325 (QuantReg: 13.33150) QuantErr: 13.33150 batch_time=0.56919 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 2.81677 (QuantReg: 12.83376) QuantErr: 12.83376 batch_time=0.50384 
Train Epoch: 4 codebook_update_time=1.73079
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch4.pth ...
Done in 4.012s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch4.pth ...
Done in 8.038s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 2.866916563987732
 quant_reg      : 12.485093025207519
 quant_err      : 12.485093025207519
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.796
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.48854990116877
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 29.794
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.079917350058416
 mnt_best       : 35.48854990116877
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 2.82537 (QuantReg: 11.96408) QuantErr: 11.96408 batch_time=33.83733 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.11318 (QuantReg: 12.27521) QuantErr: 12.27521 batch_time=0.53577 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 2.28027 (QuantReg: 12.16227) QuantErr: 12.16227 batch_time=0.51489 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 2.49882 (QuantReg: 12.44869) QuantErr: 12.44869 batch_time=0.50700 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 2.79789 (QuantReg: 12.29080) QuantErr: 12.29080 batch_time=0.52406 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 2.31733 (QuantReg: 12.52358) QuantErr: 12.52358 batch_time=0.57910 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 2.72152 (QuantReg: 12.21903) QuantErr: 12.21903 batch_time=0.69052 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 3.10786 (QuantReg: 11.92643) QuantErr: 11.92643 batch_time=1.17099 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 2.54501 (QuantReg: 12.46864) QuantErr: 12.46864 batch_time=0.55696 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.55883 (QuantReg: 12.26512) QuantErr: 12.26512 batch_time=0.51544 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.67278 (QuantReg: 12.57944) QuantErr: 12.57944 batch_time=0.57013 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 2.64775 (QuantReg: 12.36477) QuantErr: 12.36477 batch_time=0.51175 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.50785 (QuantReg: 12.76540) QuantErr: 12.76540 batch_time=0.51734 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.15512 (QuantReg: 12.20837) QuantErr: 12.20837 batch_time=0.52803 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.94461 (QuantReg: 12.56945) QuantErr: 12.56945 batch_time=0.53352 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 2.38922 (QuantReg: 12.82874) QuantErr: 12.82874 batch_time=0.73363 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.73729 (QuantReg: 12.53836) QuantErr: 12.53836 batch_time=0.50853 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.60717 (QuantReg: 12.50694) QuantErr: 12.50694 batch_time=0.52248 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 2.75713 (QuantReg: 12.85807) QuantErr: 12.85807 batch_time=0.50809 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 2.53191 (QuantReg: 12.55009) QuantErr: 12.55009 batch_time=0.54240 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 2.91462 (QuantReg: 12.79526) QuantErr: 12.79526 batch_time=0.49465 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.37830 (QuantReg: 12.66305) QuantErr: 12.66305 batch_time=0.61701 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 2.81025 (QuantReg: 12.90572) QuantErr: 12.90572 batch_time=0.57941 
Train Epoch: 5 codebook_update_time=1.77200
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch5.pth ...
Done in 6.035s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch5.pth ...
Done in 10.442s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 2.588942636489868
 quant_reg      : 12.527422508239747
 quant_err      : 12.527422508239747
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 30.199
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.72792739157029
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.729
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.20867651929111
 mnt_best       : 37.72792739157029
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.64731 (QuantReg: 12.32998) QuantErr: 12.32998 batch_time=30.75415 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.77840 (QuantReg: 11.87980) QuantErr: 11.87980 batch_time=6.01338 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.48231 (QuantReg: 12.17228) QuantErr: 12.17228 batch_time=0.49526 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 2.41979 (QuantReg: 12.20150) QuantErr: 12.20150 batch_time=0.73608 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 2.30403 (QuantReg: 12.28919) QuantErr: 12.28919 batch_time=0.50220 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.28398 (QuantReg: 12.23595) QuantErr: 12.23595 batch_time=0.52644 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.68087 (QuantReg: 12.61078) QuantErr: 12.61078 batch_time=1.74055 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.32833 (QuantReg: 12.60358) QuantErr: 12.60358 batch_time=0.54129 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.39458 (QuantReg: 12.55585) QuantErr: 12.55585 batch_time=0.50488 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.25170 (QuantReg: 12.48586) QuantErr: 12.48586 batch_time=0.51651 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 2.39836 (QuantReg: 12.94824) QuantErr: 12.94824 batch_time=0.49918 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.33754 (QuantReg: 12.49436) QuantErr: 12.49436 batch_time=0.52215 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 2.25037 (QuantReg: 12.62291) QuantErr: 12.62291 batch_time=0.53254 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.27850 (QuantReg: 12.42533) QuantErr: 12.42533 batch_time=0.49630 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.74347 (QuantReg: 12.86352) QuantErr: 12.86352 batch_time=0.51824 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.42150 (QuantReg: 12.64217) QuantErr: 12.64217 batch_time=0.57578 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 2.14150 (QuantReg: 12.86792) QuantErr: 12.86792 batch_time=0.51411 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.51212 (QuantReg: 12.70982) QuantErr: 12.70982 batch_time=0.49700 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.57361 (QuantReg: 12.79829) QuantErr: 12.79829 batch_time=0.57286 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.39796 (QuantReg: 12.67519) QuantErr: 12.67519 batch_time=0.50309 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 2.21239 (QuantReg: 12.88302) QuantErr: 12.88302 batch_time=0.84431 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.12788 (QuantReg: 12.57896) QuantErr: 12.57896 batch_time=0.50831 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.11004 (QuantReg: 12.72260) QuantErr: 12.72260 batch_time=0.49867 
Train Epoch: 6 codebook_update_time=2.14175
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch6.pth ...
Done in 4.362s
removing stale ckpt [epoch 5] [took 0.01s]
 epoch          : 6
 loss           : 2.4067695913314817
 quant_reg      : 12.605543056488036
 quant_err      : 12.605543056488036
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.621
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.161529003105684
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.65
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 38.18496914197272
 mnt_best       : 37.72792739157029
 not_improved_count: 1
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.47082 (QuantReg: 11.97619) QuantErr: 11.97619 batch_time=30.32288 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.43290 (QuantReg: 12.26441) QuantErr: 12.26441 batch_time=0.51194 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.18147 (QuantReg: 12.00715) QuantErr: 12.00715 batch_time=0.52136 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 1.99112 (QuantReg: 12.34341) QuantErr: 12.34341 batch_time=0.79836 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 1.99277 (QuantReg: 12.38013) QuantErr: 12.38013 batch_time=0.50708 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.03983 (QuantReg: 12.84535) QuantErr: 12.84535 batch_time=0.56860 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.29332 (QuantReg: 12.73936) QuantErr: 12.73936 batch_time=3.95737 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.26983 (QuantReg: 12.61518) QuantErr: 12.61518 batch_time=3.25310 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.27202 (QuantReg: 12.77270) QuantErr: 12.77270 batch_time=0.99757 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 1.80869 (QuantReg: 12.59822) QuantErr: 12.59822 batch_time=0.50026 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.68588 (QuantReg: 12.62483) QuantErr: 12.62483 batch_time=0.49954 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.29057 (QuantReg: 12.68415) QuantErr: 12.68415 batch_time=0.50469 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.06912 (QuantReg: 12.85257) QuantErr: 12.85257 batch_time=0.56780 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 2.31588 (QuantReg: 12.47264) QuantErr: 12.47264 batch_time=0.50639 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 1.69449 (QuantReg: 12.52145) QuantErr: 12.52145 batch_time=0.51150 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 2.25441 (QuantReg: 12.76181) QuantErr: 12.76181 batch_time=0.53487 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 1.72349 (QuantReg: 13.01724) QuantErr: 13.01724 batch_time=0.50631 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 2.25830 (QuantReg: 12.63743) QuantErr: 12.63743 batch_time=0.60682 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 1.73332 (QuantReg: 12.85003) QuantErr: 12.85003 batch_time=0.51054 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.58362 (QuantReg: 13.06465) QuantErr: 13.06465 batch_time=0.61514 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.17005 (QuantReg: 13.06131) QuantErr: 13.06131 batch_time=0.53218 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.16754 (QuantReg: 13.35697) QuantErr: 13.35697 batch_time=0.51544 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.20638 (QuantReg: 12.96198) QuantErr: 12.96198 batch_time=0.50546 
Train Epoch: 7 codebook_update_time=2.75125
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch7.pth ...
Done in 5.462s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch7.pth ...
Done in 9.780s
removing stale ckpt [epoch 6] [took 0.35s]
 epoch          : 7
 loss           : 2.2300485882759093
 quant_reg      : 12.68372780227661
 quant_err      : 12.68372780227661
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.942
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.75221827473922
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.258
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.20736480495823
 mnt_best       : 39.75221827473922
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.53389 (QuantReg: 12.53685) QuantErr: 12.53685 batch_time=33.19570 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.47009 (QuantReg: 12.39980) QuantErr: 12.39980 batch_time=0.96457 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.67688 (QuantReg: 12.69475) QuantErr: 12.69475 batch_time=0.49622 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.22794 (QuantReg: 12.40773) QuantErr: 12.40773 batch_time=0.49417 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.27063 (QuantReg: 12.87241) QuantErr: 12.87241 batch_time=0.50775 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.04921 (QuantReg: 12.51608) QuantErr: 12.51608 batch_time=0.49513 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.17923 (QuantReg: 12.80977) QuantErr: 12.80977 batch_time=0.50707 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.32581 (QuantReg: 12.90642) QuantErr: 12.90642 batch_time=0.54992 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.36457 (QuantReg: 12.76330) QuantErr: 12.76330 batch_time=0.52031 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.49935 (QuantReg: 12.79101) QuantErr: 12.79101 batch_time=0.50896 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.31545 (QuantReg: 12.91959) QuantErr: 12.91959 batch_time=0.49841 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.09882 (QuantReg: 12.64058) QuantErr: 12.64058 batch_time=0.49948 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.22117 (QuantReg: 12.66529) QuantErr: 12.66529 batch_time=0.51257 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.40001 (QuantReg: 13.04595) QuantErr: 13.04595 batch_time=0.50379 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.14566 (QuantReg: 13.02846) QuantErr: 13.02846 batch_time=0.50670 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 1.95753 (QuantReg: 12.59322) QuantErr: 12.59322 batch_time=0.56547 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.00679 (QuantReg: 12.63303) QuantErr: 12.63303 batch_time=0.50748 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.69475 (QuantReg: 12.75607) QuantErr: 12.75607 batch_time=0.49847 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.29155 (QuantReg: 12.89427) QuantErr: 12.89427 batch_time=0.50734 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 2.23891 (QuantReg: 12.43404) QuantErr: 12.43404 batch_time=1.42005 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.23447 (QuantReg: 12.81945) QuantErr: 12.81945 batch_time=0.49647 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 1.73028 (QuantReg: 12.95338) QuantErr: 12.95338 batch_time=0.50102 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.38933 (QuantReg: 12.99076) QuantErr: 12.99076 batch_time=0.74051 
Train Epoch: 8 codebook_update_time=1.77842
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch8.pth ...
Done in 4.315s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch8.pth ...
Done in 9.263s
removing stale ckpt [epoch 7] [took 0.01s]
 epoch          : 8
 loss           : 2.1322562732696535
 quant_reg      : 12.752060535430909
 quant_err      : 12.752060535430909
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.043
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.9862619488556
 MSRVTT_jsfusion_test/v2t_metrics/R1: 19.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.892
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.84922719474521
 mnt_best       : 39.9862619488556
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 1.82339 (QuantReg: 12.93335) QuantErr: 12.93335 batch_time=30.38642 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.23885 (QuantReg: 12.76204) QuantErr: 12.76204 batch_time=0.74528 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 1.73723 (QuantReg: 12.53764) QuantErr: 12.53764 batch_time=0.52847 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.13993 (QuantReg: 12.76345) QuantErr: 12.76345 batch_time=0.50059 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.03680 (QuantReg: 12.94506) QuantErr: 12.94506 batch_time=0.52549 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 1.70624 (QuantReg: 13.06028) QuantErr: 13.06028 batch_time=0.58768 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.79052 (QuantReg: 13.06783) QuantErr: 13.06783 batch_time=0.50035 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 2.03294 (QuantReg: 13.04399) QuantErr: 13.04399 batch_time=0.50023 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.19338 (QuantReg: 12.48172) QuantErr: 12.48172 batch_time=0.49916 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 1.87888 (QuantReg: 12.78055) QuantErr: 12.78055 batch_time=0.50723 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 2.03764 (QuantReg: 12.77623) QuantErr: 12.77623 batch_time=0.63670 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.62678 (QuantReg: 12.78890) QuantErr: 12.78890 batch_time=0.50435 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 2.04734 (QuantReg: 12.78833) QuantErr: 12.78833 batch_time=0.49647 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 1.84069 (QuantReg: 12.78615) QuantErr: 12.78615 batch_time=0.50432 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.08001 (QuantReg: 12.53236) QuantErr: 12.53236 batch_time=0.54031 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 1.70368 (QuantReg: 13.33237) QuantErr: 13.33237 batch_time=0.52942 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 2.09938 (QuantReg: 13.22252) QuantErr: 13.22252 batch_time=0.50290 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 1.53831 (QuantReg: 13.02651) QuantErr: 13.02651 batch_time=0.58628 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 1.98562 (QuantReg: 12.98660) QuantErr: 12.98660 batch_time=0.50340 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.97043 (QuantReg: 13.06014) QuantErr: 13.06014 batch_time=0.49683 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.81939 (QuantReg: 13.27875) QuantErr: 13.27875 batch_time=0.50781 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 1.79601 (QuantReg: 12.62325) QuantErr: 12.62325 batch_time=0.52728 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 1.89790 (QuantReg: 12.73822) QuantErr: 12.73822 batch_time=0.63443 
Train Epoch: 9 codebook_update_time=1.69831
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch9.pth ...
Done in 6.812s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch9.pth ...
Done in 11.511s
removing stale ckpt [epoch 8] [took 0.02s]
 epoch          : 9
 loss           : 1.995203962802887
 quant_reg      : 12.837140064239502
 quant_err      : 12.837140064239502
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.316
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.05332554473255
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6165
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.70806505672913
 mnt_best       : 40.05332554473255
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.87910 (QuantReg: 12.87447) QuantErr: 12.87447 batch_time=28.37710 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 2.00996 (QuantReg: 12.72718) QuantErr: 12.72718 batch_time=0.50234 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.30265 (QuantReg: 13.04019) QuantErr: 13.04019 batch_time=0.50285 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 1.96246 (QuantReg: 12.46269) QuantErr: 12.46269 batch_time=0.50478 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 1.71743 (QuantReg: 12.66632) QuantErr: 12.66632 batch_time=0.53056 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 1.93186 (QuantReg: 12.95106) QuantErr: 12.95106 batch_time=0.52373 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.37833 (QuantReg: 12.58035) QuantErr: 12.58035 batch_time=6.67884 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 1.91559 (QuantReg: 12.90808) QuantErr: 12.90808 batch_time=0.52282 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 1.94528 (QuantReg: 12.68948) QuantErr: 12.68948 batch_time=0.53117 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 1.92994 (QuantReg: 12.84000) QuantErr: 12.84000 batch_time=0.53358 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.74436 (QuantReg: 12.78447) QuantErr: 12.78447 batch_time=0.51308 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.01395 (QuantReg: 13.02710) QuantErr: 13.02710 batch_time=0.52369 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 1.97468 (QuantReg: 12.63715) QuantErr: 12.63715 batch_time=0.51723 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 1.57597 (QuantReg: 13.29128) QuantErr: 13.29128 batch_time=0.63372 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 1.92282 (QuantReg: 12.70790) QuantErr: 12.70790 batch_time=0.72756 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.19231 (QuantReg: 13.13998) QuantErr: 13.13998 batch_time=0.50262 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 2.04979 (QuantReg: 12.91085) QuantErr: 12.91085 batch_time=0.51369 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 1.84842 (QuantReg: 13.18928) QuantErr: 13.18928 batch_time=0.51452 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 1.60941 (QuantReg: 13.14783) QuantErr: 13.14783 batch_time=0.54568 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 1.56005 (QuantReg: 13.34696) QuantErr: 13.34696 batch_time=0.52365 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 2.00270 (QuantReg: 13.00635) QuantErr: 13.00635 batch_time=0.52458 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 2.21499 (QuantReg: 12.86511) QuantErr: 12.86511 batch_time=0.51325 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 2.08929 (QuantReg: 13.19392) QuantErr: 13.19392 batch_time=0.54891 
Train Epoch: 10 codebook_update_time=1.72298
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch10.pth ...
Done in 19.264s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch10.pth ...
Done in 24.302s
removing stale ckpt [epoch 9] [took 0.05s]
 epoch          : 10
 loss           : 1.8956627707481384
 quant_reg      : 12.942074924468994
 quant_err      : 12.942074924468994
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.7
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.51607834924003
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.4055
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.365891638799816
 mnt_best       : 41.51607834924003
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 1.86138 (QuantReg: 12.62964) QuantErr: 12.62964 batch_time=32.98681 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.05196 (QuantReg: 12.47084) QuantErr: 12.47084 batch_time=0.62538 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 2.12654 (QuantReg: 12.80230) QuantErr: 12.80230 batch_time=0.52633 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 1.87351 (QuantReg: 12.99411) QuantErr: 12.99411 batch_time=0.58182 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.03000 (QuantReg: 12.76749) QuantErr: 12.76749 batch_time=0.72576 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 2.26246 (QuantReg: 13.43856) QuantErr: 13.43856 batch_time=0.51544 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 1.57301 (QuantReg: 12.96789) QuantErr: 12.96789 batch_time=1.26942 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 2.02185 (QuantReg: 12.57992) QuantErr: 12.57992 batch_time=1.12497 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 1.85354 (QuantReg: 12.81263) QuantErr: 12.81263 batch_time=0.59828 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 1.75443 (QuantReg: 13.05260) QuantErr: 13.05260 batch_time=0.49396 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 1.53761 (QuantReg: 13.09379) QuantErr: 13.09379 batch_time=0.49670 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 1.61454 (QuantReg: 12.96810) QuantErr: 12.96810 batch_time=0.56001 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 1.94963 (QuantReg: 12.81832) QuantErr: 12.81832 batch_time=0.51398 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.73258 (QuantReg: 12.82299) QuantErr: 12.82299 batch_time=0.50496 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.48138 (QuantReg: 13.04627) QuantErr: 13.04627 batch_time=0.54805 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.25940 (QuantReg: 12.57858) QuantErr: 12.57858 batch_time=0.54038 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 1.68288 (QuantReg: 12.98174) QuantErr: 12.98174 batch_time=0.51589 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.79031 (QuantReg: 13.21716) QuantErr: 13.21716 batch_time=0.51272 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 1.85951 (QuantReg: 12.79563) QuantErr: 12.79563 batch_time=0.50137 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 1.64026 (QuantReg: 13.10490) QuantErr: 13.10490 batch_time=1.95829 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.82683 (QuantReg: 12.84767) QuantErr: 12.84767 batch_time=0.64714 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.86949 (QuantReg: 13.17120) QuantErr: 13.17120 batch_time=0.50487 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.72755 (QuantReg: 13.35550) QuantErr: 13.35550 batch_time=0.50751 
Train Epoch: 11 codebook_update_time=1.62366
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch11.pth ...
Done in 5.174s
removing stale ckpt [epoch 10] [took 0.14s]
 epoch          : 11
 loss           : 1.811429819583893
 quant_reg      : 12.947463226318359
 quant_err      : 12.947463226318359
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.286
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.263266843765344
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.2365
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.88753585626039
 mnt_best       : 41.51607834924003
 not_improved_count: 1
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 1.63459 (QuantReg: 12.74696) QuantErr: 12.74696 batch_time=39.83725 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 1.78996 (QuantReg: 12.86919) QuantErr: 12.86919 batch_time=0.49634 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.84005 (QuantReg: 12.93579) QuantErr: 12.93579 batch_time=0.57913 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 2.03123 (QuantReg: 12.95473) QuantErr: 12.95473 batch_time=0.49227 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 1.70738 (QuantReg: 12.86690) QuantErr: 12.86690 batch_time=0.51011 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 1.78375 (QuantReg: 12.99863) QuantErr: 12.99863 batch_time=0.51716 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 1.97031 (QuantReg: 13.24503) QuantErr: 13.24503 batch_time=0.57142 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 1.89689 (QuantReg: 12.61271) QuantErr: 12.61271 batch_time=0.53565 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 1.75875 (QuantReg: 12.94433) QuantErr: 12.94433 batch_time=0.50797 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 1.62599 (QuantReg: 12.99584) QuantErr: 12.99584 batch_time=0.51605 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.60447 (QuantReg: 13.03265) QuantErr: 13.03265 batch_time=0.49388 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.52329 (QuantReg: 13.23173) QuantErr: 13.23173 batch_time=0.51400 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.61105 (QuantReg: 12.85604) QuantErr: 12.85604 batch_time=0.54188 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 1.77008 (QuantReg: 12.69160) QuantErr: 12.69160 batch_time=0.54665 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 1.96272 (QuantReg: 13.38324) QuantErr: 13.38324 batch_time=0.49976 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.76983 (QuantReg: 13.08876) QuantErr: 13.08876 batch_time=0.51099 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.86110 (QuantReg: 13.23419) QuantErr: 13.23419 batch_time=0.53491 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 1.46604 (QuantReg: 13.07193) QuantErr: 13.07193 batch_time=0.50845 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.91896 (QuantReg: 13.06465) QuantErr: 13.06465 batch_time=0.49904 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 1.52780 (QuantReg: 13.24373) QuantErr: 13.24373 batch_time=0.51291 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 1.32368 (QuantReg: 13.44944) QuantErr: 13.44944 batch_time=0.52984 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 1.77890 (QuantReg: 13.33694) QuantErr: 13.33694 batch_time=0.50127 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.60484 (QuantReg: 13.09478) QuantErr: 13.09478 batch_time=0.53044 
Train Epoch: 12 codebook_update_time=1.63596
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch12.pth ...
Done in 5.244s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch12.pth ...
Done in 10.747s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 1.7439429616928102
 quant_reg      : 12.995950000762939
 quant_err      : 12.995950000762939
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.684
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.36375655617999
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.988
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.58649247108604
 mnt_best       : 42.36375655617999
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 1.82434 (QuantReg: 12.68026) QuantErr: 12.68026 batch_time=31.92564 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.27408 (QuantReg: 13.29690) QuantErr: 13.29690 batch_time=0.51605 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 1.76175 (QuantReg: 12.81292) QuantErr: 12.81292 batch_time=0.50191 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.36757 (QuantReg: 13.17158) QuantErr: 13.17158 batch_time=0.58721 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.88309 (QuantReg: 13.12911) QuantErr: 13.12911 batch_time=0.53157 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.90915 (QuantReg: 12.66866) QuantErr: 12.66866 batch_time=0.56042 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.67356 (QuantReg: 13.18871) QuantErr: 13.18871 batch_time=1.61532 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.78581 (QuantReg: 13.19065) QuantErr: 13.19065 batch_time=0.48897 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.62998 (QuantReg: 13.21118) QuantErr: 13.21118 batch_time=0.52410 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.58014 (QuantReg: 13.05722) QuantErr: 13.05722 batch_time=0.51456 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.61380 (QuantReg: 13.19659) QuantErr: 13.19659 batch_time=0.54141 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.52323 (QuantReg: 13.49472) QuantErr: 13.49472 batch_time=0.52137 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 1.67205 (QuantReg: 13.02525) QuantErr: 13.02525 batch_time=0.52000 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 1.64906 (QuantReg: 13.14489) QuantErr: 13.14489 batch_time=2.52048 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.44369 (QuantReg: 13.18837) QuantErr: 13.18837 batch_time=0.52496 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.98255 (QuantReg: 13.12223) QuantErr: 13.12223 batch_time=0.51748 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.65386 (QuantReg: 13.46721) QuantErr: 13.46721 batch_time=0.51705 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.95480 (QuantReg: 13.11663) QuantErr: 13.11663 batch_time=0.53962 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.49160 (QuantReg: 13.32869) QuantErr: 13.32869 batch_time=0.52462 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 1.79606 (QuantReg: 13.08666) QuantErr: 13.08666 batch_time=1.55560 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.24853 (QuantReg: 13.40336) QuantErr: 13.40336 batch_time=0.49416 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.73606 (QuantReg: 13.25838) QuantErr: 13.25838 batch_time=0.55262 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.99832 (QuantReg: 13.17021) QuantErr: 13.17021 batch_time=0.50937 
Train Epoch: 13 codebook_update_time=1.96136
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch13.pth ...
Done in 5.974s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 1.6922753291130066
 quant_reg      : 13.110749290466309
 quant_err      : 13.110749290466309
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.82
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.809422263354584
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.273
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.32970600839254
 mnt_best       : 42.36375655617999
 not_improved_count: 1
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.64319 (QuantReg: 13.20434) QuantErr: 13.20434 batch_time=35.33237 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.46260 (QuantReg: 12.91609) QuantErr: 12.91609 batch_time=0.51640 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 1.62972 (QuantReg: 12.97278) QuantErr: 12.97278 batch_time=0.54454 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.49006 (QuantReg: 13.31707) QuantErr: 13.31707 batch_time=0.50038 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 1.49693 (QuantReg: 13.11675) QuantErr: 13.11675 batch_time=0.52010 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.95173 (QuantReg: 12.71265) QuantErr: 12.71265 batch_time=0.78497 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.89828 (QuantReg: 13.03141) QuantErr: 13.03141 batch_time=0.50034 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.60909 (QuantReg: 13.00791) QuantErr: 13.00791 batch_time=0.50083 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 1.52758 (QuantReg: 12.67600) QuantErr: 12.67600 batch_time=0.51988 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.38736 (QuantReg: 13.09623) QuantErr: 13.09623 batch_time=0.54416 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 2.10081 (QuantReg: 12.99480) QuantErr: 12.99480 batch_time=0.50651 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.40130 (QuantReg: 12.99684) QuantErr: 12.99684 batch_time=0.50820 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.49203 (QuantReg: 13.27675) QuantErr: 13.27675 batch_time=0.54188 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 1.83428 (QuantReg: 12.86754) QuantErr: 12.86754 batch_time=0.52364 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.52097 (QuantReg: 13.01545) QuantErr: 13.01545 batch_time=0.51456 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.91072 (QuantReg: 12.98574) QuantErr: 12.98574 batch_time=0.51402 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.50682 (QuantReg: 13.36252) QuantErr: 13.36252 batch_time=0.53199 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.79663 (QuantReg: 13.01803) QuantErr: 13.01803 batch_time=0.50876 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 1.58587 (QuantReg: 13.40602) QuantErr: 13.40602 batch_time=0.53923 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.71300 (QuantReg: 13.00551) QuantErr: 13.00551 batch_time=0.49646 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 1.78043 (QuantReg: 12.98787) QuantErr: 12.98787 batch_time=0.51022 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.39349 (QuantReg: 13.63028) QuantErr: 13.63028 batch_time=0.57180 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.23144 (QuantReg: 13.28108) QuantErr: 13.28108 batch_time=0.52248 
Train Epoch: 14 codebook_update_time=1.94754
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch14.pth ...
Done in 6.679s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch14.pth ...
Done in 11.758s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 1.6245474772453308
 quant_reg      : 13.09201619720459
 quant_err      : 13.09201619720459
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.365
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.46161683320754
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.922
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.55312310225605
 mnt_best       : 42.46161683320754
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.49312 (QuantReg: 13.04050) QuantErr: 13.04050 batch_time=32.72462 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 1.12232 (QuantReg: 13.15921) QuantErr: 13.15921 batch_time=0.50573 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.58191 (QuantReg: 13.11031) QuantErr: 13.11031 batch_time=5.71491 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.34619 (QuantReg: 12.78996) QuantErr: 12.78996 batch_time=0.50041 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 1.76038 (QuantReg: 13.14167) QuantErr: 13.14167 batch_time=0.50856 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.70350 (QuantReg: 13.03809) QuantErr: 13.03809 batch_time=0.50951 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.77842 (QuantReg: 13.41546) QuantErr: 13.41546 batch_time=0.58950 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.25502 (QuantReg: 12.96999) QuantErr: 12.96999 batch_time=0.52590 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.87502 (QuantReg: 13.29750) QuantErr: 13.29750 batch_time=0.50935 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.44259 (QuantReg: 13.24115) QuantErr: 13.24115 batch_time=0.51260 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.83708 (QuantReg: 13.25389) QuantErr: 13.25389 batch_time=0.50855 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 1.30827 (QuantReg: 13.52037) QuantErr: 13.52037 batch_time=0.50458 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.59541 (QuantReg: 13.27620) QuantErr: 13.27620 batch_time=0.51809 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.45120 (QuantReg: 13.10831) QuantErr: 13.10831 batch_time=0.55253 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.65641 (QuantReg: 13.25088) QuantErr: 13.25088 batch_time=3.29773 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.40417 (QuantReg: 13.04260) QuantErr: 13.04260 batch_time=0.52250 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.38191 (QuantReg: 13.34822) QuantErr: 13.34822 batch_time=0.52983 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.63103 (QuantReg: 13.21704) QuantErr: 13.21704 batch_time=0.52396 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 1.87798 (QuantReg: 12.94954) QuantErr: 12.94954 batch_time=0.53485 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.40997 (QuantReg: 13.36344) QuantErr: 13.36344 batch_time=0.51920 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.28958 (QuantReg: 13.19466) QuantErr: 13.19466 batch_time=0.50506 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 1.61242 (QuantReg: 13.46070) QuantErr: 13.46070 batch_time=0.51074 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.44614 (QuantReg: 13.14462) QuantErr: 13.14462 batch_time=0.52270 
Train Epoch: 15 codebook_update_time=4.23576
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch15.pth ...
Done in 6.766s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch15.pth ...
Done in 11.753s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 1.5585461993217469
 quant_reg      : 13.161257621765136
 quant_err      : 13.161257621765136
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.0
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.092600154720905
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0965
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.468949869588805
 mnt_best       : 43.092600154720905
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.76745 (QuantReg: 12.92055) QuantErr: 12.92055 batch_time=33.67066 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.55195 (QuantReg: 12.71341) QuantErr: 12.71341 batch_time=0.49832 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.46570 (QuantReg: 13.01558) QuantErr: 13.01558 batch_time=0.49451 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 2.13783 (QuantReg: 12.58011) QuantErr: 12.58011 batch_time=0.50101 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.55003 (QuantReg: 13.32420) QuantErr: 13.32420 batch_time=0.54155 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.71898 (QuantReg: 13.36809) QuantErr: 13.36809 batch_time=0.63714 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.27222 (QuantReg: 13.31476) QuantErr: 13.31476 batch_time=1.26919 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.50812 (QuantReg: 12.89217) QuantErr: 12.89217 batch_time=0.50871 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.45471 (QuantReg: 13.06726) QuantErr: 13.06726 batch_time=0.50517 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.38398 (QuantReg: 13.40417) QuantErr: 13.40417 batch_time=0.54770 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.31187 (QuantReg: 13.42413) QuantErr: 13.42413 batch_time=0.50480 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.45777 (QuantReg: 13.30160) QuantErr: 13.30160 batch_time=0.49137 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.42767 (QuantReg: 13.21803) QuantErr: 13.21803 batch_time=1.40514 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.92268 (QuantReg: 13.20474) QuantErr: 13.20474 batch_time=0.51220 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.79577 (QuantReg: 13.40750) QuantErr: 13.40750 batch_time=0.51108 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.69654 (QuantReg: 13.33849) QuantErr: 13.33849 batch_time=0.51541 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 1.29746 (QuantReg: 13.58767) QuantErr: 13.58767 batch_time=0.50074 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.74167 (QuantReg: 13.22700) QuantErr: 13.22700 batch_time=0.50155 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.47839 (QuantReg: 13.33908) QuantErr: 13.33908 batch_time=0.52758 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.34898 (QuantReg: 13.45551) QuantErr: 13.45551 batch_time=2.26507 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.56185 (QuantReg: 13.21165) QuantErr: 13.21165 batch_time=0.51745 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.70120 (QuantReg: 13.06703) QuantErr: 13.06703 batch_time=0.50741 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.56317 (QuantReg: 13.13631) QuantErr: 13.13631 batch_time=0.61929 
Train Epoch: 16 codebook_update_time=1.71108
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch16.pth ...
Done in 7.006s
removing stale ckpt [epoch 15] [took 0.04s]
 epoch          : 16
 loss           : 1.5521403017044066
 quant_reg      : 13.176825359344482
 quant_err      : 13.176825359344482
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.678
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.779626079069274
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.978
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.23745893639233
 mnt_best       : 43.092600154720905
 not_improved_count: 1
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.28528 (QuantReg: 13.32855) QuantErr: 13.32855 batch_time=33.28939 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.60200 (QuantReg: 12.86671) QuantErr: 12.86671 batch_time=0.50271 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.39617 (QuantReg: 12.94753) QuantErr: 12.94753 batch_time=0.53685 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.97128 (QuantReg: 13.38254) QuantErr: 13.38254 batch_time=0.51378 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.60953 (QuantReg: 12.78701) QuantErr: 12.78701 batch_time=0.53504 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.45637 (QuantReg: 13.25560) QuantErr: 13.25560 batch_time=0.50495 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.68254 (QuantReg: 13.26466) QuantErr: 13.26466 batch_time=1.57467 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.33985 (QuantReg: 13.16271) QuantErr: 13.16271 batch_time=0.56060 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.46258 (QuantReg: 12.99123) QuantErr: 12.99123 batch_time=0.57802 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.61564 (QuantReg: 13.22685) QuantErr: 13.22685 batch_time=0.50514 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.51236 (QuantReg: 13.32696) QuantErr: 13.32696 batch_time=0.52707 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.48458 (QuantReg: 13.13571) QuantErr: 13.13571 batch_time=0.49749 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.66280 (QuantReg: 13.10326) QuantErr: 13.10326 batch_time=0.99052 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.49411 (QuantReg: 13.34410) QuantErr: 13.34410 batch_time=0.52218 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 1.85567 (QuantReg: 12.75261) QuantErr: 12.75261 batch_time=0.50890 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.39774 (QuantReg: 13.17993) QuantErr: 13.17993 batch_time=0.62233 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.61816 (QuantReg: 13.45013) QuantErr: 13.45013 batch_time=0.50168 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.29776 (QuantReg: 13.51090) QuantErr: 13.51090 batch_time=0.49678 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.45260 (QuantReg: 12.79092) QuantErr: 12.79092 batch_time=0.49769 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.29048 (QuantReg: 13.39479) QuantErr: 13.39479 batch_time=0.53237 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.49098 (QuantReg: 13.03592) QuantErr: 13.03592 batch_time=0.69488 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.56229 (QuantReg: 13.59987) QuantErr: 13.59987 batch_time=0.50388 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.22309 (QuantReg: 13.19243) QuantErr: 13.19243 batch_time=0.53171 
Train Epoch: 17 codebook_update_time=1.73962
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch17.pth ...
Done in 8.939s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch17.pth ...
Done in 14.270s
removing stale ckpt [epoch 16] [took 0.30s]
 epoch          : 17
 loss           : 1.493693069934845
 quant_reg      : 13.231121612548828
 quant_err      : 13.231121612548828
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.127
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.652531861063295
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4535
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.31800466282661
 mnt_best       : 43.652531861063295
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.56048 (QuantReg: 13.02396) QuantErr: 13.02396 batch_time=33.07595 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.41757 (QuantReg: 13.10549) QuantErr: 13.10549 batch_time=0.52066 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 1.33457 (QuantReg: 13.31039) QuantErr: 13.31039 batch_time=0.53672 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.21595 (QuantReg: 13.40996) QuantErr: 13.40996 batch_time=0.54469 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.38985 (QuantReg: 13.01509) QuantErr: 13.01509 batch_time=0.50585 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.24819 (QuantReg: 13.50473) QuantErr: 13.50473 batch_time=0.51286 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.06654 (QuantReg: 13.61776) QuantErr: 13.61776 batch_time=0.52579 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.26837 (QuantReg: 13.41543) QuantErr: 13.41543 batch_time=0.50736 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.69281 (QuantReg: 13.42345) QuantErr: 13.42345 batch_time=1.42209 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.39458 (QuantReg: 13.01768) QuantErr: 13.01768 batch_time=0.50871 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.79054 (QuantReg: 13.22392) QuantErr: 13.22392 batch_time=0.51251 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.54860 (QuantReg: 13.31817) QuantErr: 13.31817 batch_time=0.54129 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.54745 (QuantReg: 13.12117) QuantErr: 13.12117 batch_time=0.53399 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.68308 (QuantReg: 13.07404) QuantErr: 13.07404 batch_time=2.09911 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.54057 (QuantReg: 13.02049) QuantErr: 13.02049 batch_time=0.49897 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.47556 (QuantReg: 13.63540) QuantErr: 13.63540 batch_time=0.54850 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.32337 (QuantReg: 13.18001) QuantErr: 13.18001 batch_time=0.59974 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.21012 (QuantReg: 13.36845) QuantErr: 13.36845 batch_time=0.52037 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.32662 (QuantReg: 13.45258) QuantErr: 13.45258 batch_time=0.49835 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.04337 (QuantReg: 13.46272) QuantErr: 13.46272 batch_time=0.56057 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 1.82702 (QuantReg: 13.05875) QuantErr: 13.05875 batch_time=0.49827 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.30668 (QuantReg: 13.31885) QuantErr: 13.31885 batch_time=0.50353 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.39367 (QuantReg: 13.42600) QuantErr: 13.42600 batch_time=0.54164 
Train Epoch: 18 codebook_update_time=1.70092
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch18.pth ...
Done in 4.799s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch18.pth ...
Done in 9.270s
removing stale ckpt [epoch 17] [took 0.31s]
 epoch          : 18
 loss           : 1.434643602371216
 quant_reg      : 13.281886882781983
 quant_err      : 13.281886882781983
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.008
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.28350273282908
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.544
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.74175040130827
 mnt_best       : 44.28350273282908
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.20656 (QuantReg: 13.33627) QuantErr: 13.33627 batch_time=31.80370 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.34155 (QuantReg: 13.27732) QuantErr: 13.27732 batch_time=0.56856 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.58979 (QuantReg: 12.98961) QuantErr: 12.98961 batch_time=0.49279 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.73395 (QuantReg: 13.19019) QuantErr: 13.19019 batch_time=0.50870 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.28592 (QuantReg: 13.14472) QuantErr: 13.14472 batch_time=0.59577 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.05359 (QuantReg: 13.46574) QuantErr: 13.46574 batch_time=0.50907 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.09192 (QuantReg: 13.38394) QuantErr: 13.38394 batch_time=0.51480 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.31405 (QuantReg: 13.09302) QuantErr: 13.09302 batch_time=0.50098 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.25222 (QuantReg: 13.28266) QuantErr: 13.28266 batch_time=0.51451 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.61876 (QuantReg: 13.01996) QuantErr: 13.01996 batch_time=0.49546 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.41761 (QuantReg: 13.08382) QuantErr: 13.08382 batch_time=0.70011 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 1.29076 (QuantReg: 13.50783) QuantErr: 13.50783 batch_time=0.51046 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.44972 (QuantReg: 13.59852) QuantErr: 13.59852 batch_time=0.51112 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 1.39768 (QuantReg: 13.36952) QuantErr: 13.36952 batch_time=4.90578 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.71348 (QuantReg: 13.08947) QuantErr: 13.08947 batch_time=0.48582 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.01028 (QuantReg: 13.28108) QuantErr: 13.28108 batch_time=0.79188 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.25263 (QuantReg: 13.29260) QuantErr: 13.29260 batch_time=0.50502 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.44840 (QuantReg: 13.23565) QuantErr: 13.23565 batch_time=0.51327 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.49570 (QuantReg: 13.02288) QuantErr: 13.02288 batch_time=0.49986 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.41359 (QuantReg: 13.32381) QuantErr: 13.32381 batch_time=0.52422 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.46004 (QuantReg: 13.47262) QuantErr: 13.47262 batch_time=0.49561 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.74302 (QuantReg: 13.17885) QuantErr: 13.17885 batch_time=0.50101 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.46851 (QuantReg: 13.67100) QuantErr: 13.67100 batch_time=0.51716 
Train Epoch: 19 codebook_update_time=1.75533
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch19.pth ...
Done in 4.828s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch19.pth ...
Done in 10.383s
removing stale ckpt [epoch 18] [took 0.01s]
 epoch          : 19
 loss           : 1.4106206090450286
 quant_reg      : 13.308876224517823
 quant_err      : 13.308876224517823
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.22
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.69479592484011
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9925
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.4008819455254
 mnt_best       : 44.69479592484011
 not_improved_count: 0
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.05415 (QuantReg: 13.46377) QuantErr: 13.46377 batch_time=35.65354 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.37124 (QuantReg: 13.14875) QuantErr: 13.14875 batch_time=0.56801 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.27116 (QuantReg: 13.27049) QuantErr: 13.27049 batch_time=0.50617 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.14035 (QuantReg: 13.00829) QuantErr: 13.00829 batch_time=0.53095 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.45661 (QuantReg: 13.08366) QuantErr: 13.08366 batch_time=0.49855 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.21566 (QuantReg: 13.33468) QuantErr: 13.33468 batch_time=0.55389 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.09409 (QuantReg: 13.56756) QuantErr: 13.56756 batch_time=2.18050 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.46108 (QuantReg: 13.30024) QuantErr: 13.30024 batch_time=0.51587 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.43958 (QuantReg: 13.44699) QuantErr: 13.44699 batch_time=0.52895 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.03935 (QuantReg: 13.44333) QuantErr: 13.44333 batch_time=0.51216 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.41778 (QuantReg: 13.24335) QuantErr: 13.24335 batch_time=0.49996 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.49613 (QuantReg: 13.57147) QuantErr: 13.57147 batch_time=0.49941 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.26897 (QuantReg: 13.15577) QuantErr: 13.15577 batch_time=0.55588 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.31167 (QuantReg: 13.46555) QuantErr: 13.46555 batch_time=0.52374 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.41277 (QuantReg: 13.37571) QuantErr: 13.37571 batch_time=0.52205 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.53687 (QuantReg: 13.55386) QuantErr: 13.55386 batch_time=0.52017 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.39482 (QuantReg: 13.35571) QuantErr: 13.35571 batch_time=0.50538 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.27573 (QuantReg: 13.34023) QuantErr: 13.34023 batch_time=0.52754 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.35346 (QuantReg: 13.35087) QuantErr: 13.35087 batch_time=0.53874 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.22658 (QuantReg: 13.34149) QuantErr: 13.34149 batch_time=0.50043 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.54351 (QuantReg: 13.53010) QuantErr: 13.53010 batch_time=0.51614 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.44407 (QuantReg: 13.68159) QuantErr: 13.68159 batch_time=0.50684 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.44468 (QuantReg: 13.39418) QuantErr: 13.39418 batch_time=0.50057 
Train Epoch: 20 codebook_update_time=2.31167
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch20.pth ...
Done in 4.932s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 1.393269650220871
 quant_reg      : 13.34464007949829
 quant_err      : 13.34464007949829
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.742
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.97639505227325
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.8615
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.67852416144181
 mnt_best       : 44.69479592484011
 not_improved_count: 1
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.57659 (QuantReg: 13.42004) QuantErr: 13.42004 batch_time=31.69219 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.27854 (QuantReg: 13.56391) QuantErr: 13.56391 batch_time=0.50341 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.46880 (QuantReg: 13.48886) QuantErr: 13.48886 batch_time=0.50336 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.59346 (QuantReg: 13.32073) QuantErr: 13.32073 batch_time=0.50576 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.24810 (QuantReg: 12.96137) QuantErr: 12.96137 batch_time=0.52285 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.24514 (QuantReg: 13.37088) QuantErr: 13.37088 batch_time=0.50279 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.80218 (QuantReg: 13.22277) QuantErr: 13.22277 batch_time=3.63692 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.34222 (QuantReg: 13.23157) QuantErr: 13.23157 batch_time=0.51798 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.21475 (QuantReg: 13.25176) QuantErr: 13.25176 batch_time=0.55539 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.37457 (QuantReg: 13.06198) QuantErr: 13.06198 batch_time=1.23676 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.15397 (QuantReg: 13.55921) QuantErr: 13.55921 batch_time=0.51771 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.17295 (QuantReg: 13.08873) QuantErr: 13.08873 batch_time=0.51588 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.28886 (QuantReg: 13.33873) QuantErr: 13.33873 batch_time=0.91717 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.10126 (QuantReg: 13.37704) QuantErr: 13.37704 batch_time=0.56225 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.54234 (QuantReg: 13.08043) QuantErr: 13.08043 batch_time=1.72006 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.37494 (QuantReg: 13.57364) QuantErr: 13.57364 batch_time=0.50283 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.48305 (QuantReg: 13.13996) QuantErr: 13.13996 batch_time=0.50143 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.35549 (QuantReg: 13.21922) QuantErr: 13.21922 batch_time=0.50598 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.49327 (QuantReg: 13.50506) QuantErr: 13.50506 batch_time=0.50761 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.65620 (QuantReg: 12.99611) QuantErr: 12.99611 batch_time=0.51879 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.41198 (QuantReg: 13.74411) QuantErr: 13.74411 batch_time=0.49695 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.36240 (QuantReg: 13.57509) QuantErr: 13.57509 batch_time=0.50924 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.45115 (QuantReg: 13.56708) QuantErr: 13.56708 batch_time=0.52514 
Train Epoch: 21 codebook_update_time=1.66669
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch21.pth ...
Done in 6.526s
removing stale ckpt [epoch 20] [took 0.03s]
 epoch          : 21
 loss           : 1.3717195789813996
 quant_reg      : 13.360749446868896
 quant_err      : 13.360749446868896
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.173
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.04890962792287
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.38
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.87018620885974
 mnt_best       : 44.69479592484011
 not_improved_count: 2
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.44653 (QuantReg: 13.40108) QuantErr: 13.40108 batch_time=35.32273 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.11432 (QuantReg: 13.49605) QuantErr: 13.49605 batch_time=0.49131 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.39969 (QuantReg: 13.46771) QuantErr: 13.46771 batch_time=0.52601 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.58966 (QuantReg: 13.31477) QuantErr: 13.31477 batch_time=0.51701 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.91838 (QuantReg: 13.43315) QuantErr: 13.43315 batch_time=0.51551 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.50656 (QuantReg: 13.17026) QuantErr: 13.17026 batch_time=0.51221 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.70188 (QuantReg: 13.55014) QuantErr: 13.55014 batch_time=0.50838 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.29606 (QuantReg: 13.38851) QuantErr: 13.38851 batch_time=0.51120 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.40046 (QuantReg: 13.49769) QuantErr: 13.49769 batch_time=0.53689 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.46669 (QuantReg: 13.12482) QuantErr: 13.12482 batch_time=0.52474 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.35857 (QuantReg: 13.62096) QuantErr: 13.62096 batch_time=0.52867 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.28391 (QuantReg: 13.20881) QuantErr: 13.20881 batch_time=0.52384 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.13699 (QuantReg: 13.24783) QuantErr: 13.24783 batch_time=0.51938 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.44684 (QuantReg: 13.29236) QuantErr: 13.29236 batch_time=0.52215 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.22643 (QuantReg: 13.21678) QuantErr: 13.21678 batch_time=0.49205 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.76037 (QuantReg: 13.37456) QuantErr: 13.37456 batch_time=0.51056 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.13805 (QuantReg: 13.47444) QuantErr: 13.47444 batch_time=0.51471 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.12536 (QuantReg: 13.38132) QuantErr: 13.38132 batch_time=0.57226 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.08372 (QuantReg: 13.38463) QuantErr: 13.38463 batch_time=0.74188 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.15367 (QuantReg: 13.50669) QuantErr: 13.50669 batch_time=1.96902 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.75956 (QuantReg: 13.42140) QuantErr: 13.42140 batch_time=0.52270 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.03346 (QuantReg: 13.73314) QuantErr: 13.73314 batch_time=0.52378 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.32883 (QuantReg: 13.68772) QuantErr: 13.68772 batch_time=0.57099 
Train Epoch: 22 codebook_update_time=2.01277
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch22.pth ...
Done in 6.974s
removing stale ckpt [epoch 21] [took 0.24s]
 epoch          : 22
 loss           : 1.3448237318992615
 quant_reg      : 13.424721183776855
 quant_err      : 13.424721183776855
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.91
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.679049684214405
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 91.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.813
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.86917559021014
 mnt_best       : 44.69479592484011
 not_improved_count: 3
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.25495 (QuantReg: 13.42028) QuantErr: 13.42028 batch_time=34.38471 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.22016 (QuantReg: 13.24754) QuantErr: 13.24754 batch_time=0.51015 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.63910 (QuantReg: 13.53147) QuantErr: 13.53147 batch_time=0.50605 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.46512 (QuantReg: 13.25536) QuantErr: 13.25536 batch_time=0.50897 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.24331 (QuantReg: 13.19724) QuantErr: 13.19724 batch_time=0.50190 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.47928 (QuantReg: 13.28794) QuantErr: 13.28794 batch_time=0.49207 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.22597 (QuantReg: 13.24174) QuantErr: 13.24174 batch_time=1.59514 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.43769 (QuantReg: 13.09624) QuantErr: 13.09624 batch_time=0.50654 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.35802 (QuantReg: 13.57014) QuantErr: 13.57014 batch_time=0.55536 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.65230 (QuantReg: 13.18622) QuantErr: 13.18622 batch_time=0.55130 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.15220 (QuantReg: 13.19509) QuantErr: 13.19509 batch_time=0.50773 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.22464 (QuantReg: 13.05632) QuantErr: 13.05632 batch_time=0.50818 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.38496 (QuantReg: 13.61957) QuantErr: 13.61957 batch_time=0.51915 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.09406 (QuantReg: 13.37982) QuantErr: 13.37982 batch_time=4.39972 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.49296 (QuantReg: 13.32327) QuantErr: 13.32327 batch_time=0.53722 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.24331 (QuantReg: 13.31995) QuantErr: 13.31995 batch_time=0.51938 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.35038 (QuantReg: 13.61090) QuantErr: 13.61090 batch_time=0.51660 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.00975 (QuantReg: 13.41047) QuantErr: 13.41047 batch_time=0.54417 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.21714 (QuantReg: 13.36054) QuantErr: 13.36054 batch_time=0.49218 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.43366 (QuantReg: 13.41914) QuantErr: 13.41914 batch_time=0.52611 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.38049 (QuantReg: 13.41915) QuantErr: 13.41915 batch_time=0.89884 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.06848 (QuantReg: 13.64530) QuantErr: 13.64530 batch_time=0.53485 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.22257 (QuantReg: 13.35783) QuantErr: 13.35783 batch_time=0.52876 
Train Epoch: 23 codebook_update_time=1.63377
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch23.pth ...
Done in 7.663s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch23.pth ...
Done in 12.182s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 1.310539566040039
 quant_reg      : 13.415542762756347
 quant_err      : 13.415542762756347
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.386
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.7200396610429
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.845
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.53897691832925
 mnt_best       : 44.7200396610429
 not_improved_count: 0
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.39652 (QuantReg: 13.36461) QuantErr: 13.36461 batch_time=28.17346 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.04617 (QuantReg: 13.21356) QuantErr: 13.21356 batch_time=0.98474 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.21156 (QuantReg: 12.99444) QuantErr: 12.99444 batch_time=0.50494 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.35125 (QuantReg: 13.36518) QuantErr: 13.36518 batch_time=0.51868 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.52333 (QuantReg: 13.26840) QuantErr: 13.26840 batch_time=0.50942 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.26787 (QuantReg: 13.53466) QuantErr: 13.53466 batch_time=1.23130 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.27066 (QuantReg: 13.05032) QuantErr: 13.05032 batch_time=2.98021 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.33882 (QuantReg: 13.43568) QuantErr: 13.43568 batch_time=4.80558 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.26686 (QuantReg: 13.58540) QuantErr: 13.58540 batch_time=0.51497 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.23783 (QuantReg: 13.26605) QuantErr: 13.26605 batch_time=0.52537 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.50977 (QuantReg: 13.55649) QuantErr: 13.55649 batch_time=0.50331 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.29283 (QuantReg: 13.50470) QuantErr: 13.50470 batch_time=0.53479 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.06873 (QuantReg: 13.42860) QuantErr: 13.42860 batch_time=0.50980 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.18362 (QuantReg: 13.30511) QuantErr: 13.30511 batch_time=0.56579 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.26652 (QuantReg: 13.60221) QuantErr: 13.60221 batch_time=0.50811 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.66250 (QuantReg: 13.39985) QuantErr: 13.39985 batch_time=0.52085 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 0.99370 (QuantReg: 13.77547) QuantErr: 13.77547 batch_time=0.50207 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.45034 (QuantReg: 13.62642) QuantErr: 13.62642 batch_time=0.51225 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.31871 (QuantReg: 13.30369) QuantErr: 13.30369 batch_time=0.50385 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.03445 (QuantReg: 13.42235) QuantErr: 13.42235 batch_time=0.51765 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.29464 (QuantReg: 13.68719) QuantErr: 13.68719 batch_time=0.50741 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.09097 (QuantReg: 13.52966) QuantErr: 13.52966 batch_time=0.49532 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.09332 (QuantReg: 13.38533) QuantErr: 13.38533 batch_time=0.51664 
Train Epoch: 24 codebook_update_time=1.72903
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch24.pth ...
Done in 5.988s
removing stale ckpt [epoch 23] [took 0.35s]
 epoch          : 24
 loss           : 1.2813339302539826
 quant_reg      : 13.465863052368164
 quant_err      : 13.465863052368164
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.324
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.380118354263814
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5795
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.60843580168241
 mnt_best       : 44.7200396610429
 not_improved_count: 1
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.27417 (QuantReg: 13.37068) QuantErr: 13.37068 batch_time=28.10472 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.11422 (QuantReg: 13.42661) QuantErr: 13.42661 batch_time=0.50326 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.23868 (QuantReg: 13.71962) QuantErr: 13.71962 batch_time=0.76801 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.21765 (QuantReg: 13.45615) QuantErr: 13.45615 batch_time=0.52363 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.14719 (QuantReg: 13.64166) QuantErr: 13.64166 batch_time=0.54681 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 0.92028 (QuantReg: 13.63448) QuantErr: 13.63448 batch_time=0.54082 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.52707 (QuantReg: 13.64893) QuantErr: 13.64893 batch_time=6.52792 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.47819 (QuantReg: 13.39832) QuantErr: 13.39832 batch_time=0.50335 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.39728 (QuantReg: 13.29775) QuantErr: 13.29775 batch_time=0.54123 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.30640 (QuantReg: 13.38470) QuantErr: 13.38470 batch_time=0.51304 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.48838 (QuantReg: 13.49728) QuantErr: 13.49728 batch_time=0.56350 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.65117 (QuantReg: 13.53472) QuantErr: 13.53472 batch_time=0.52739 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.08464 (QuantReg: 13.33978) QuantErr: 13.33978 batch_time=0.50147 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.08997 (QuantReg: 13.63169) QuantErr: 13.63169 batch_time=0.51220 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.09030 (QuantReg: 13.45385) QuantErr: 13.45385 batch_time=0.53313 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.65261 (QuantReg: 13.31388) QuantErr: 13.31388 batch_time=0.54332 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.14601 (QuantReg: 13.62585) QuantErr: 13.62585 batch_time=0.54948 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.14539 (QuantReg: 13.55760) QuantErr: 13.55760 batch_time=0.50397 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 0.89264 (QuantReg: 13.57862) QuantErr: 13.57862 batch_time=0.53756 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.23240 (QuantReg: 13.44418) QuantErr: 13.44418 batch_time=0.50477 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.56516 (QuantReg: 13.59198) QuantErr: 13.59198 batch_time=0.51598 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 0.94222 (QuantReg: 13.71305) QuantErr: 13.71305 batch_time=0.53409 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.27499 (QuantReg: 13.51534) QuantErr: 13.51534 batch_time=0.49795 
Train Epoch: 25 codebook_update_time=2.26360
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch25.pth ...
Done in 4.367s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch25.pth ...
Done in 9.244s
removing stale ckpt [epoch 24] [took 0.06s]
 epoch          : 25
 loss           : 1.2639004898071289
 quant_reg      : 13.484097202301026
 quant_err      : 13.484097202301026
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.197
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.98311267576689
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.4335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.95398753622949
 mnt_best       : 44.98311267576689
 not_improved_count: 0
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.26419 (QuantReg: 13.29698) QuantErr: 13.29698 batch_time=36.99956 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.23551 (QuantReg: 13.29430) QuantErr: 13.29430 batch_time=2.97531 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.41507 (QuantReg: 13.55917) QuantErr: 13.55917 batch_time=1.47148 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.42428 (QuantReg: 13.51125) QuantErr: 13.51125 batch_time=0.55643 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 1.33148 (QuantReg: 13.41833) QuantErr: 13.41833 batch_time=0.56074 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.14553 (QuantReg: 13.75319) QuantErr: 13.75319 batch_time=0.53280 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 0.95354 (QuantReg: 13.46792) QuantErr: 13.46792 batch_time=0.54204 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.38372 (QuantReg: 13.62570) QuantErr: 13.62570 batch_time=0.50398 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.32472 (QuantReg: 13.17747) QuantErr: 13.17747 batch_time=0.50387 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 0.99705 (QuantReg: 13.54775) QuantErr: 13.54775 batch_time=0.55705 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.11613 (QuantReg: 13.60808) QuantErr: 13.60808 batch_time=0.56249 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.35770 (QuantReg: 13.54032) QuantErr: 13.54032 batch_time=0.54441 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.43993 (QuantReg: 13.55199) QuantErr: 13.55199 batch_time=0.50313 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.33962 (QuantReg: 12.91037) QuantErr: 12.91037 batch_time=0.49911 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.43967 (QuantReg: 13.69309) QuantErr: 13.69309 batch_time=0.51409 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.24421 (QuantReg: 13.70740) QuantErr: 13.70740 batch_time=0.50406 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.22775 (QuantReg: 13.70612) QuantErr: 13.70612 batch_time=0.53592 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.40745 (QuantReg: 13.57464) QuantErr: 13.57464 batch_time=0.54270 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.14503 (QuantReg: 13.25017) QuantErr: 13.25017 batch_time=0.50655 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.34925 (QuantReg: 13.73444) QuantErr: 13.73444 batch_time=0.58644 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.22301 (QuantReg: 13.69286) QuantErr: 13.69286 batch_time=0.50868 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.27846 (QuantReg: 13.74584) QuantErr: 13.74584 batch_time=0.51198 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.17857 (QuantReg: 13.71046) QuantErr: 13.71046 batch_time=0.50713 
Train Epoch: 26 codebook_update_time=1.69628
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch26.pth ...
Done in 6.403s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch26.pth ...
Done in 11.372s
removing stale ckpt [epoch 25] [took 0.02s]
 epoch          : 26
 loss           : 1.269704270362854
 quant_reg      : 13.480295574188233
 quant_err      : 13.480295574188233
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.089
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.29951317401475
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7175
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.59538517944212
 mnt_best       : 45.29951317401475
 not_improved_count: 0
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.25566 (QuantReg: 13.53570) QuantErr: 13.53570 batch_time=33.88625 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.30621 (QuantReg: 13.22350) QuantErr: 13.22350 batch_time=0.52273 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.32298 (QuantReg: 13.42411) QuantErr: 13.42411 batch_time=0.51842 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.30241 (QuantReg: 13.56842) QuantErr: 13.56842 batch_time=0.49214 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.11706 (QuantReg: 13.26682) QuantErr: 13.26682 batch_time=0.50614 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.21165 (QuantReg: 13.47598) QuantErr: 13.47598 batch_time=0.49898 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.21185 (QuantReg: 13.70041) QuantErr: 13.70041 batch_time=0.85776 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.31133 (QuantReg: 13.38622) QuantErr: 13.38622 batch_time=1.01934 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.37732 (QuantReg: 13.44866) QuantErr: 13.44866 batch_time=0.50667 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.20476 (QuantReg: 13.84627) QuantErr: 13.84627 batch_time=0.54176 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.28893 (QuantReg: 13.63256) QuantErr: 13.63256 batch_time=0.57860 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.19793 (QuantReg: 13.17623) QuantErr: 13.17623 batch_time=0.53555 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.04477 (QuantReg: 13.53212) QuantErr: 13.53212 batch_time=0.64595 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.28470 (QuantReg: 13.56977) QuantErr: 13.56977 batch_time=4.04166 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.19331 (QuantReg: 13.75027) QuantErr: 13.75027 batch_time=0.50371 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.43656 (QuantReg: 13.30571) QuantErr: 13.30571 batch_time=0.53925 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.36568 (QuantReg: 13.45188) QuantErr: 13.45188 batch_time=0.50229 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 0.99285 (QuantReg: 13.67253) QuantErr: 13.67253 batch_time=0.49988 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.29814 (QuantReg: 13.22553) QuantErr: 13.22553 batch_time=0.51671 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.48816 (QuantReg: 13.78786) QuantErr: 13.78786 batch_time=0.50401 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.09446 (QuantReg: 13.49848) QuantErr: 13.49848 batch_time=0.49767 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.38969 (QuantReg: 13.23183) QuantErr: 13.23183 batch_time=0.50170 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.06526 (QuantReg: 13.70026) QuantErr: 13.70026 batch_time=0.57765 
Train Epoch: 27 codebook_update_time=1.87503
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch27.pth ...
Done in 23.251s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch27.pth ...
Done in 28.074s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 1.2430559067726135
 quant_reg      : 13.517199333190918
 quant_err      : 13.517199333190918
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 25.996
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.305077668133194
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.3835
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.19091644677638
 mnt_best       : 45.305077668133194
 not_improved_count: 0
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.03886 (QuantReg: 13.25173) QuantErr: 13.25173 batch_time=32.15680 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.33800 (QuantReg: 13.78641) QuantErr: 13.78641 batch_time=0.49955 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 0.89879 (QuantReg: 13.41420) QuantErr: 13.41420 batch_time=0.52600 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.05001 (QuantReg: 13.52217) QuantErr: 13.52217 batch_time=0.58253 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.02636 (QuantReg: 13.73700) QuantErr: 13.73700 batch_time=0.54861 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.16763 (QuantReg: 13.51774) QuantErr: 13.51774 batch_time=0.57559 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.45051 (QuantReg: 13.41822) QuantErr: 13.41822 batch_time=1.07665 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.21989 (QuantReg: 13.49831) QuantErr: 13.49831 batch_time=0.81011 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.74692 (QuantReg: 13.42765) QuantErr: 13.42765 batch_time=0.51699 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.41749 (QuantReg: 13.76224) QuantErr: 13.76224 batch_time=1.05354 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.30545 (QuantReg: 13.69147) QuantErr: 13.69147 batch_time=0.50610 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 0.95993 (QuantReg: 13.43946) QuantErr: 13.43946 batch_time=0.49084 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.46020 (QuantReg: 13.67916) QuantErr: 13.67916 batch_time=0.75370 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 1.15978 (QuantReg: 13.41411) QuantErr: 13.41411 batch_time=4.83540 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 1.30449 (QuantReg: 13.59379) QuantErr: 13.59379 batch_time=0.51127 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.24879 (QuantReg: 13.80066) QuantErr: 13.80066 batch_time=0.49782 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.32895 (QuantReg: 13.68473) QuantErr: 13.68473 batch_time=0.49398 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.05124 (QuantReg: 13.88081) QuantErr: 13.88081 batch_time=0.59486 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.22958 (QuantReg: 13.31690) QuantErr: 13.31690 batch_time=0.51548 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.00254 (QuantReg: 13.74685) QuantErr: 13.74685 batch_time=0.50342 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.10206 (QuantReg: 13.64044) QuantErr: 13.64044 batch_time=0.52207 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.21929 (QuantReg: 13.70461) QuantErr: 13.70461 batch_time=0.54293 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.37192 (QuantReg: 13.68395) QuantErr: 13.68395 batch_time=0.50106 
Train Epoch: 28 codebook_update_time=2.30069
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch28.pth ...
Done in 4.236s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch28.pth ...
Done in 9.197s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 1.2199001743793487
 quant_reg      : 13.551771900177002
 quant_err      : 13.551771900177002
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.489
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.42992069844317
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.611
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.35155875218299
 mnt_best       : 45.42992069844317
 not_improved_count: 0
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.71939 (QuantReg: 13.46034) QuantErr: 13.46034 batch_time=26.54720 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.40363 (QuantReg: 13.52338) QuantErr: 13.52338 batch_time=6.95808 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.22752 (QuantReg: 13.85418) QuantErr: 13.85418 batch_time=0.49703 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.27306 (QuantReg: 13.42162) QuantErr: 13.42162 batch_time=0.52712 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.50879 (QuantReg: 13.38116) QuantErr: 13.38116 batch_time=0.53343 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.09671 (QuantReg: 13.61199) QuantErr: 13.61199 batch_time=0.51115 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.16751 (QuantReg: 13.43162) QuantErr: 13.43162 batch_time=1.27601 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.13763 (QuantReg: 13.77358) QuantErr: 13.77358 batch_time=0.50730 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.23314 (QuantReg: 13.64609) QuantErr: 13.64609 batch_time=0.60100 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.26543 (QuantReg: 13.96289) QuantErr: 13.96289 batch_time=0.54119 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.75286 (QuantReg: 13.62756) QuantErr: 13.62756 batch_time=0.51823 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.16219 (QuantReg: 13.38474) QuantErr: 13.38474 batch_time=0.54358 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.51474 (QuantReg: 13.40577) QuantErr: 13.40577 batch_time=0.49994 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.11708 (QuantReg: 13.68889) QuantErr: 13.68889 batch_time=0.49935 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.04059 (QuantReg: 13.97956) QuantErr: 13.97956 batch_time=0.51205 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.31177 (QuantReg: 13.52868) QuantErr: 13.52868 batch_time=0.50226 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.21178 (QuantReg: 13.69684) QuantErr: 13.69684 batch_time=0.51484 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.24692 (QuantReg: 13.72284) QuantErr: 13.72284 batch_time=0.53716 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.39530 (QuantReg: 13.44718) QuantErr: 13.44718 batch_time=0.49989 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.25509 (QuantReg: 13.61001) QuantErr: 13.61001 batch_time=0.52184 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.21269 (QuantReg: 13.37462) QuantErr: 13.37462 batch_time=0.49463 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 0.75330 (QuantReg: 13.76903) QuantErr: 13.76903 batch_time=0.54069 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.35392 (QuantReg: 13.48585) QuantErr: 13.48585 batch_time=0.51799 
Train Epoch: 29 codebook_update_time=1.68671
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch29.pth ...
Done in 6.255s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 1.2063816847801208
 quant_reg      : 13.55509871673584
 quant_err      : 13.55509871673584
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.622
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.92401993211262
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.791
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.8104052050257
 mnt_best       : 45.42992069844317
 not_improved_count: 1
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.04795 (QuantReg: 13.59855) QuantErr: 13.59855 batch_time=37.02635 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.27468 (QuantReg: 13.15996) QuantErr: 13.15996 batch_time=0.51367 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.13008 (QuantReg: 13.27482) QuantErr: 13.27482 batch_time=0.50689 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.06264 (QuantReg: 13.70742) QuantErr: 13.70742 batch_time=0.50707 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.21953 (QuantReg: 13.57994) QuantErr: 13.57994 batch_time=0.50485 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.14293 (QuantReg: 13.53140) QuantErr: 13.53140 batch_time=0.51795 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.43711 (QuantReg: 13.69393) QuantErr: 13.69393 batch_time=0.52357 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.10296 (QuantReg: 13.80050) QuantErr: 13.80050 batch_time=0.49553 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 1.25199 (QuantReg: 13.43467) QuantErr: 13.43467 batch_time=0.49877 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.28024 (QuantReg: 13.83320) QuantErr: 13.83320 batch_time=0.49846 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.10972 (QuantReg: 13.79610) QuantErr: 13.79610 batch_time=0.50457 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.02714 (QuantReg: 13.63019) QuantErr: 13.63019 batch_time=0.78592 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.02679 (QuantReg: 13.73167) QuantErr: 13.73167 batch_time=2.28589 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.44176 (QuantReg: 13.76194) QuantErr: 13.76194 batch_time=0.51033 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.53861 (QuantReg: 13.54422) QuantErr: 13.54422 batch_time=0.50903 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.09467 (QuantReg: 13.58715) QuantErr: 13.58715 batch_time=0.50016 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.39089 (QuantReg: 13.07916) QuantErr: 13.07916 batch_time=0.49623 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.36656 (QuantReg: 13.38274) QuantErr: 13.38274 batch_time=0.50469 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.01178 (QuantReg: 13.56758) QuantErr: 13.56758 batch_time=0.65823 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.53993 (QuantReg: 13.63759) QuantErr: 13.63759 batch_time=0.55606 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.16213 (QuantReg: 13.58969) QuantErr: 13.58969 batch_time=4.37165 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.17268 (QuantReg: 13.69217) QuantErr: 13.69217 batch_time=0.54502 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.05060 (QuantReg: 13.79342) QuantErr: 13.79342 batch_time=0.50366 
Train Epoch: 30 codebook_update_time=1.73118
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch30.pth ...
Done in 4.333s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 1.2133750660419464
 quant_reg      : 13.561498336791992
 quant_err      : 13.561498336791992
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.254
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.016968415629975
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.973
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.69248706368835
 mnt_best       : 45.42992069844317
 not_improved_count: 2
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.37037 (QuantReg: 13.51097) QuantErr: 13.51097 batch_time=30.64753 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.14446 (QuantReg: 13.34378) QuantErr: 13.34378 batch_time=0.51186 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.04676 (QuantReg: 13.24260) QuantErr: 13.24260 batch_time=0.53897 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.40316 (QuantReg: 13.38521) QuantErr: 13.38521 batch_time=0.50475 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.17011 (QuantReg: 13.66885) QuantErr: 13.66885 batch_time=0.53133 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.39428 (QuantReg: 13.56024) QuantErr: 13.56024 batch_time=0.53645 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.12270 (QuantReg: 13.68629) QuantErr: 13.68629 batch_time=0.50540 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 0.98188 (QuantReg: 13.65263) QuantErr: 13.65263 batch_time=1.30694 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.13429 (QuantReg: 13.35081) QuantErr: 13.35081 batch_time=0.49919 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.20441 (QuantReg: 13.76660) QuantErr: 13.76660 batch_time=0.51395 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.20150 (QuantReg: 13.92068) QuantErr: 13.92068 batch_time=0.50722 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.02007 (QuantReg: 13.56020) QuantErr: 13.56020 batch_time=0.49008 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.05386 (QuantReg: 13.65149) QuantErr: 13.65149 batch_time=0.52953 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.31296 (QuantReg: 13.31906) QuantErr: 13.31906 batch_time=0.50770 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.03565 (QuantReg: 13.70892) QuantErr: 13.70892 batch_time=0.49503 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.05508 (QuantReg: 13.55339) QuantErr: 13.55339 batch_time=0.50425 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.10474 (QuantReg: 13.73883) QuantErr: 13.73883 batch_time=0.85906 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.26029 (QuantReg: 13.45111) QuantErr: 13.45111 batch_time=0.55531 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.06105 (QuantReg: 13.59004) QuantErr: 13.59004 batch_time=0.51083 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.20020 (QuantReg: 13.38562) QuantErr: 13.38562 batch_time=0.54241 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.12553 (QuantReg: 13.47338) QuantErr: 13.47338 batch_time=0.50835 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.21845 (QuantReg: 13.80385) QuantErr: 13.80385 batch_time=2.04602 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.34660 (QuantReg: 13.21685) QuantErr: 13.21685 batch_time=0.54055 
Train Epoch: 31 codebook_update_time=1.67799
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch31.pth ...
Done in 3.936s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch31.pth ...
Done in 8.306s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.1995339674949645
 quant_reg      : 13.619958488464356
 quant_err      : 13.619958488464356
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 26.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.686
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.95672805314334
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7285
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.938891762174336
 mnt_best       : 45.95672805314334
 not_improved_count: 0
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.21056 (QuantReg: 13.34172) QuantErr: 13.34172 batch_time=32.34653 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.27375 (QuantReg: 13.51385) QuantErr: 13.51385 batch_time=0.49946 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.38422 (QuantReg: 13.79762) QuantErr: 13.79762 batch_time=0.51936 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.15409 (QuantReg: 13.26747) QuantErr: 13.26747 batch_time=0.85084 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 0.91268 (QuantReg: 13.68165) QuantErr: 13.68165 batch_time=0.69829 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 0.95044 (QuantReg: 13.54174) QuantErr: 13.54174 batch_time=0.51428 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.17672 (QuantReg: 13.52973) QuantErr: 13.52973 batch_time=0.53151 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.39259 (QuantReg: 13.76564) QuantErr: 13.76564 batch_time=0.54277 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.06879 (QuantReg: 13.78305) QuantErr: 13.78305 batch_time=0.50721 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.55359 (QuantReg: 13.35978) QuantErr: 13.35978 batch_time=1.02803 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.45855 (QuantReg: 13.39772) QuantErr: 13.39772 batch_time=0.49609 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.31700 (QuantReg: 13.51597) QuantErr: 13.51597 batch_time=0.49633 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.36118 (QuantReg: 13.63203) QuantErr: 13.63203 batch_time=1.38486 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.17973 (QuantReg: 13.58896) QuantErr: 13.58896 batch_time=0.54858 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.40084 (QuantReg: 13.46940) QuantErr: 13.46940 batch_time=1.70750 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 1.29788 (QuantReg: 13.53566) QuantErr: 13.53566 batch_time=0.50709 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.34220 (QuantReg: 13.40911) QuantErr: 13.40911 batch_time=0.56301 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 0.93566 (QuantReg: 13.77281) QuantErr: 13.77281 batch_time=0.52925 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.38471 (QuantReg: 13.51806) QuantErr: 13.51806 batch_time=0.52975 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 0.97917 (QuantReg: 13.62946) QuantErr: 13.62946 batch_time=0.51275 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.08522 (QuantReg: 13.66532) QuantErr: 13.66532 batch_time=0.49582 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 0.97245 (QuantReg: 13.85142) QuantErr: 13.85142 batch_time=0.55908 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.35398 (QuantReg: 13.64321) QuantErr: 13.64321 batch_time=0.51080 
Train Epoch: 32 codebook_update_time=1.73405
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch32.pth ...
Done in 3.757s
removing stale ckpt [epoch 31] [took 0.01s]
 epoch          : 32
 loss           : 1.190196896314621
 quant_reg      : 13.617940227508544
 quant_err      : 13.617940227508544
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.011
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.04521085837967
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.637
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.199264482771206
 mnt_best       : 45.95672805314334
 not_improved_count: 1
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.21544 (QuantReg: 13.48162) QuantErr: 13.48162 batch_time=34.18867 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 1.20977 (QuantReg: 13.78836) QuantErr: 13.78836 batch_time=0.65880 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.33005 (QuantReg: 13.40934) QuantErr: 13.40934 batch_time=0.55449 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.24323 (QuantReg: 13.65473) QuantErr: 13.65473 batch_time=0.50505 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.51121 (QuantReg: 13.34477) QuantErr: 13.34477 batch_time=0.98744 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.28322 (QuantReg: 13.64964) QuantErr: 13.64964 batch_time=0.51907 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 0.90833 (QuantReg: 13.55818) QuantErr: 13.55818 batch_time=3.40945 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.04197 (QuantReg: 13.69978) QuantErr: 13.69978 batch_time=0.51458 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.23527 (QuantReg: 13.62473) QuantErr: 13.62473 batch_time=0.52593 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.03913 (QuantReg: 13.66988) QuantErr: 13.66988 batch_time=0.55649 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.26577 (QuantReg: 13.47715) QuantErr: 13.47715 batch_time=0.54029 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.13698 (QuantReg: 13.69550) QuantErr: 13.69550 batch_time=0.50854 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.30724 (QuantReg: 13.54383) QuantErr: 13.54383 batch_time=0.50570 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.07610 (QuantReg: 13.54539) QuantErr: 13.54539 batch_time=0.51391 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.17138 (QuantReg: 13.86200) QuantErr: 13.86200 batch_time=0.51688 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 0.93221 (QuantReg: 13.90402) QuantErr: 13.90402 batch_time=0.51625 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 0.89434 (QuantReg: 13.65741) QuantErr: 13.65741 batch_time=0.50839 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.75962 (QuantReg: 13.78647) QuantErr: 13.78647 batch_time=0.53713 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.33049 (QuantReg: 13.34020) QuantErr: 13.34020 batch_time=0.52475 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.10367 (QuantReg: 13.39186) QuantErr: 13.39186 batch_time=0.52420 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 1.09574 (QuantReg: 13.55455) QuantErr: 13.55455 batch_time=0.51751 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.09545 (QuantReg: 13.60136) QuantErr: 13.60136 batch_time=0.50058 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.13087 (QuantReg: 13.62725) QuantErr: 13.62725 batch_time=0.50624 
Train Epoch: 33 codebook_update_time=1.64035
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch33.pth ...
Done in 4.160s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.1770562624931336
 quant_reg      : 13.659090202331543
 quant_err      : 13.659090202331543
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.333
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.73898608507225
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.975
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.04405168847542
 mnt_best       : 45.95672805314334
 not_improved_count: 2
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.14222 (QuantReg: 13.78288) QuantErr: 13.78288 batch_time=31.41728 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.12918 (QuantReg: 13.72597) QuantErr: 13.72597 batch_time=0.52453 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 1.30553 (QuantReg: 13.72399) QuantErr: 13.72399 batch_time=0.76865 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 0.81511 (QuantReg: 13.65700) QuantErr: 13.65700 batch_time=0.55341 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 0.87143 (QuantReg: 13.33405) QuantErr: 13.33405 batch_time=0.50267 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.24473 (QuantReg: 13.78771) QuantErr: 13.78771 batch_time=0.50315 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 0.93183 (QuantReg: 13.73989) QuantErr: 13.73989 batch_time=2.86980 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.22413 (QuantReg: 13.64768) QuantErr: 13.64768 batch_time=0.49680 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.41550 (QuantReg: 13.73959) QuantErr: 13.73959 batch_time=0.54978 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.32033 (QuantReg: 13.85677) QuantErr: 13.85677 batch_time=1.08171 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 1.14482 (QuantReg: 13.66320) QuantErr: 13.66320 batch_time=0.53671 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.03487 (QuantReg: 13.55532) QuantErr: 13.55532 batch_time=0.50468 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.15309 (QuantReg: 13.91267) QuantErr: 13.91267 batch_time=0.50279 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.19212 (QuantReg: 13.51612) QuantErr: 13.51612 batch_time=0.49745 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.25090 (QuantReg: 13.56819) QuantErr: 13.56819 batch_time=0.53269 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.01172 (QuantReg: 13.48951) QuantErr: 13.48951 batch_time=0.51050 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.37447 (QuantReg: 13.70187) QuantErr: 13.70187 batch_time=0.56406 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.18783 (QuantReg: 13.82592) QuantErr: 13.82592 batch_time=0.51868 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.25725 (QuantReg: 13.59052) QuantErr: 13.59052 batch_time=0.49608 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 1.13821 (QuantReg: 13.64283) QuantErr: 13.64283 batch_time=0.49050 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.07431 (QuantReg: 13.47764) QuantErr: 13.47764 batch_time=0.52309 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.06797 (QuantReg: 13.61738) QuantErr: 13.61738 batch_time=0.51255 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.32411 (QuantReg: 13.65808) QuantErr: 13.65808 batch_time=0.50211 
Train Epoch: 34 codebook_update_time=1.66462
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch34.pth ...
Done in 5.872s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 1.1568240029811858
 quant_reg      : 13.664371257781982
 quant_err      : 13.664371257781982
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.253
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.12208821945852
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.069
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.61359500255706
 mnt_best       : 45.95672805314334
 not_improved_count: 3
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 0.94405 (QuantReg: 13.69373) QuantErr: 13.69373 batch_time=33.29777 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.33253 (QuantReg: 13.86399) QuantErr: 13.86399 batch_time=0.51821 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.35024 (QuantReg: 13.74931) QuantErr: 13.74931 batch_time=0.54035 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.25800 (QuantReg: 13.72841) QuantErr: 13.72841 batch_time=0.62738 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.28325 (QuantReg: 13.89695) QuantErr: 13.89695 batch_time=0.51466 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.05598 (QuantReg: 13.56875) QuantErr: 13.56875 batch_time=0.50619 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.24201 (QuantReg: 13.74347) QuantErr: 13.74347 batch_time=1.09276 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.20166 (QuantReg: 13.66604) QuantErr: 13.66604 batch_time=4.70395 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.18366 (QuantReg: 13.54216) QuantErr: 13.54216 batch_time=0.52198 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.40832 (QuantReg: 13.85515) QuantErr: 13.85515 batch_time=0.49652 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 0.99643 (QuantReg: 13.53885) QuantErr: 13.53885 batch_time=0.50399 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.23305 (QuantReg: 13.64237) QuantErr: 13.64237 batch_time=0.51153 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.24884 (QuantReg: 13.79451) QuantErr: 13.79451 batch_time=0.53779 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.07713 (QuantReg: 13.73261) QuantErr: 13.73261 batch_time=0.53155 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.41702 (QuantReg: 13.67430) QuantErr: 13.67430 batch_time=0.50649 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 0.96569 (QuantReg: 13.75888) QuantErr: 13.75888 batch_time=0.51592 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.02065 (QuantReg: 13.58526) QuantErr: 13.58526 batch_time=0.50929 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.29367 (QuantReg: 13.16529) QuantErr: 13.16529 batch_time=0.49892 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.31744 (QuantReg: 13.59058) QuantErr: 13.59058 batch_time=0.51846 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.15698 (QuantReg: 13.97368) QuantErr: 13.97368 batch_time=0.50692 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 0.88722 (QuantReg: 13.81165) QuantErr: 13.81165 batch_time=0.50330 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 1.09630 (QuantReg: 13.81920) QuantErr: 13.81920 batch_time=0.53223 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.08666 (QuantReg: 13.69411) QuantErr: 13.69411 batch_time=0.53432 
Train Epoch: 35 codebook_update_time=1.71656
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch35.pth ...
Done in 18.500s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 1.1452598774433136
 quant_reg      : 13.689994331359863
 quant_err      : 13.689994331359863
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.157
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.55331823927965
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7175
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.79123291570004
 mnt_best       : 45.95672805314334
 not_improved_count: 4
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.22987 (QuantReg: 13.62202) QuantErr: 13.62202 batch_time=33.64657 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.20732 (QuantReg: 13.75976) QuantErr: 13.75976 batch_time=0.50309 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 0.89377 (QuantReg: 13.72568) QuantErr: 13.72568 batch_time=0.49929 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.36259 (QuantReg: 13.55284) QuantErr: 13.55284 batch_time=0.50498 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.23099 (QuantReg: 13.36012) QuantErr: 13.36012 batch_time=0.51533 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 0.82767 (QuantReg: 13.50759) QuantErr: 13.50759 batch_time=0.51640 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.26229 (QuantReg: 13.22043) QuantErr: 13.22043 batch_time=0.51625 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.09762 (QuantReg: 13.51652) QuantErr: 13.51652 batch_time=0.51654 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.27929 (QuantReg: 13.66861) QuantErr: 13.66861 batch_time=0.77214 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.05286 (QuantReg: 13.52313) QuantErr: 13.52313 batch_time=0.50592 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.26004 (QuantReg: 13.57007) QuantErr: 13.57007 batch_time=0.53002 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.37952 (QuantReg: 13.69278) QuantErr: 13.69278 batch_time=0.50231 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.05454 (QuantReg: 13.59019) QuantErr: 13.59019 batch_time=0.51696 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.15840 (QuantReg: 13.74745) QuantErr: 13.74745 batch_time=0.50071 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 1.46985 (QuantReg: 13.67274) QuantErr: 13.67274 batch_time=0.49686 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 0.95323 (QuantReg: 13.66332) QuantErr: 13.66332 batch_time=0.50202 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.24189 (QuantReg: 13.81437) QuantErr: 13.81437 batch_time=0.56917 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.21600 (QuantReg: 13.31068) QuantErr: 13.31068 batch_time=0.55493 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.03927 (QuantReg: 13.65238) QuantErr: 13.65238 batch_time=0.51742 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.14003 (QuantReg: 13.80921) QuantErr: 13.80921 batch_time=0.52443 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 0.95377 (QuantReg: 13.91632) QuantErr: 13.91632 batch_time=0.51102 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 0.99557 (QuantReg: 13.65522) QuantErr: 13.65522 batch_time=0.54082 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 0.86574 (QuantReg: 13.62935) QuantErr: 13.62935 batch_time=0.55404 
Train Epoch: 36 codebook_update_time=1.67434
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch36.pth ...
Done in 11.155s
removing stale ckpt [epoch 35] [took 0.03s]
 epoch          : 36
 loss           : 1.1490511243343353
 quant_reg      : 13.69261975479126
 quant_err      : 13.69261975479126
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.355
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.172021574919306
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.7225
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.29619860969808
 mnt_best       : 45.95672805314334
 not_improved_count: 5
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.27753 (QuantReg: 13.56316) QuantErr: 13.56316 batch_time=32.24907 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 0.98094 (QuantReg: 13.73041) QuantErr: 13.73041 batch_time=0.49742 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 0.95375 (QuantReg: 13.71798) QuantErr: 13.71798 batch_time=0.55403 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.15019 (QuantReg: 13.64369) QuantErr: 13.64369 batch_time=0.50116 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.00225 (QuantReg: 13.97184) QuantErr: 13.97184 batch_time=1.71022 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.04780 (QuantReg: 13.48159) QuantErr: 13.48159 batch_time=0.51070 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.16058 (QuantReg: 13.35765) QuantErr: 13.35765 batch_time=1.53399 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.25861 (QuantReg: 13.96603) QuantErr: 13.96603 batch_time=0.53986 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.15419 (QuantReg: 13.73825) QuantErr: 13.73825 batch_time=0.55826 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 0.92653 (QuantReg: 13.76805) QuantErr: 13.76805 batch_time=0.51901 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.17910 (QuantReg: 13.77001) QuantErr: 13.77001 batch_time=0.53721 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 0.94152 (QuantReg: 13.71451) QuantErr: 13.71451 batch_time=0.52190 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.05068 (QuantReg: 13.59129) QuantErr: 13.59129 batch_time=0.52751 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.25642 (QuantReg: 13.77944) QuantErr: 13.77944 batch_time=0.52084 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 0.87952 (QuantReg: 13.81698) QuantErr: 13.81698 batch_time=0.54137 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 1.00978 (QuantReg: 13.57004) QuantErr: 13.57004 batch_time=0.50691 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 0.94725 (QuantReg: 13.85937) QuantErr: 13.85937 batch_time=0.53522 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 0.72410 (QuantReg: 13.73738) QuantErr: 13.73738 batch_time=0.50838 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.14374 (QuantReg: 13.53185) QuantErr: 13.53185 batch_time=0.54426 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.22942 (QuantReg: 14.07011) QuantErr: 14.07011 batch_time=0.50917 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.25842 (QuantReg: 13.55020) QuantErr: 13.55020 batch_time=0.51153 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.26533 (QuantReg: 13.88626) QuantErr: 13.88626 batch_time=0.53335 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.13620 (QuantReg: 14.14596) QuantErr: 14.14596 batch_time=0.53248 
Train Epoch: 37 codebook_update_time=1.66341
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch37.pth ...
Done in 5.982s
removing stale ckpt [epoch 36] [took 0.04s]
 epoch          : 37
 loss           : 1.1298083329200745
 quant_reg      : 13.72084030532837
 quant_err      : 13.72084030532837
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.407
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.01210785303879
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6715
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.867965743789355
 mnt_best       : 45.95672805314334
 not_improved_count: 6
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 0.79974 (QuantReg: 14.09552) QuantErr: 14.09552 batch_time=28.91848 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 0.86654 (QuantReg: 13.92778) QuantErr: 13.92778 batch_time=0.51516 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 0.99288 (QuantReg: 13.54653) QuantErr: 13.54653 batch_time=0.50416 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.00198 (QuantReg: 13.46510) QuantErr: 13.46510 batch_time=0.52091 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.12596 (QuantReg: 13.70667) QuantErr: 13.70667 batch_time=0.51029 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 0.93937 (QuantReg: 14.04640) QuantErr: 14.04640 batch_time=0.54617 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 0.92997 (QuantReg: 13.88376) QuantErr: 13.88376 batch_time=1.53500 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.31653 (QuantReg: 13.66184) QuantErr: 13.66184 batch_time=0.50479 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.29707 (QuantReg: 13.85051) QuantErr: 13.85051 batch_time=0.50027 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 1.17362 (QuantReg: 14.10138) QuantErr: 14.10138 batch_time=0.53414 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 1.03145 (QuantReg: 13.99428) QuantErr: 13.99428 batch_time=0.52500 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.25542 (QuantReg: 13.70624) QuantErr: 13.70624 batch_time=0.53171 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 1.29327 (QuantReg: 13.72882) QuantErr: 13.72882 batch_time=0.63399 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.19639 (QuantReg: 13.95852) QuantErr: 13.95852 batch_time=0.49603 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.30285 (QuantReg: 13.50392) QuantErr: 13.50392 batch_time=0.52829 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 0.95148 (QuantReg: 14.09474) QuantErr: 14.09474 batch_time=1.70546 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.10136 (QuantReg: 13.76906) QuantErr: 13.76906 batch_time=0.51512 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 0.80118 (QuantReg: 13.78009) QuantErr: 13.78009 batch_time=0.50865 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.07463 (QuantReg: 14.02034) QuantErr: 14.02034 batch_time=0.68066 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.04258 (QuantReg: 13.78262) QuantErr: 13.78262 batch_time=0.62160 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.02968 (QuantReg: 13.90629) QuantErr: 13.90629 batch_time=0.50534 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.21524 (QuantReg: 13.33840) QuantErr: 13.33840 batch_time=0.51806 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.20315 (QuantReg: 13.75383) QuantErr: 13.75383 batch_time=0.51262 
Train Epoch: 38 codebook_update_time=2.12753
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch38.pth ...
Done in 4.250s
removing stale ckpt [epoch 37] [took 0.03s]
 epoch          : 38
 loss           : 1.1188594336509705
 quant_reg      : 13.721503337860108
 quant_err      : 13.721503337860108
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.438
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.02672914083334
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.613
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.004804161130146
 mnt_best       : 45.95672805314334
 not_improved_count: 7
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 0.98309 (QuantReg: 13.65513) QuantErr: 13.65513 batch_time=37.05705 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.06607 (QuantReg: 14.22956) QuantErr: 14.22956 batch_time=0.50441 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.49986 (QuantReg: 13.67872) QuantErr: 13.67872 batch_time=0.53518 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.04133 (QuantReg: 13.59854) QuantErr: 13.59854 batch_time=1.63838 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.47983 (QuantReg: 13.78842) QuantErr: 13.78842 batch_time=0.62543 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 0.97106 (QuantReg: 13.67178) QuantErr: 13.67178 batch_time=0.51601 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.36783 (QuantReg: 13.48308) QuantErr: 13.48308 batch_time=0.49874 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.23919 (QuantReg: 13.60365) QuantErr: 13.60365 batch_time=0.51173 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.23591 (QuantReg: 13.98910) QuantErr: 13.98910 batch_time=0.51570 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.22492 (QuantReg: 13.62311) QuantErr: 13.62311 batch_time=0.52241 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.41074 (QuantReg: 14.01304) QuantErr: 14.01304 batch_time=0.51362 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.36439 (QuantReg: 13.81618) QuantErr: 13.81618 batch_time=0.53393 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.59257 (QuantReg: 13.42833) QuantErr: 13.42833 batch_time=2.11831 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.23658 (QuantReg: 13.87494) QuantErr: 13.87494 batch_time=0.51097 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.20003 (QuantReg: 13.96412) QuantErr: 13.96412 batch_time=0.50377 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.26319 (QuantReg: 13.85694) QuantErr: 13.85694 batch_time=0.50845 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.30406 (QuantReg: 13.76833) QuantErr: 13.76833 batch_time=0.51541 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.05705 (QuantReg: 13.88582) QuantErr: 13.88582 batch_time=0.52639 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 0.93353 (QuantReg: 13.79535) QuantErr: 13.79535 batch_time=0.51298 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.40911 (QuantReg: 13.67634) QuantErr: 13.67634 batch_time=0.49709 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.20044 (QuantReg: 13.64382) QuantErr: 13.64382 batch_time=0.52872 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.25645 (QuantReg: 13.67049) QuantErr: 13.67049 batch_time=0.55186 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 1.17206 (QuantReg: 13.80377) QuantErr: 13.80377 batch_time=0.53815 
Train Epoch: 39 codebook_update_time=1.67209
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch39.pth ...
Done in 4.547s
removing stale ckpt [epoch 38] [took 0.11s]
 epoch          : 39
 loss           : 1.1509599306583405
 quant_reg      : 13.769480209350586
 quant_err      : 13.769480209350586
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.232
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.01477111797151
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2445
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.53070181635902
 mnt_best       : 45.95672805314334
 not_improved_count: 8
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.60179 (QuantReg: 13.52249) QuantErr: 13.52249 batch_time=28.81575 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 0.89458 (QuantReg: 13.69224) QuantErr: 13.69224 batch_time=0.51934 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.06575 (QuantReg: 13.69261) QuantErr: 13.69261 batch_time=0.49780 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.01682 (QuantReg: 14.00305) QuantErr: 14.00305 batch_time=0.48934 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.27974 (QuantReg: 13.49932) QuantErr: 13.49932 batch_time=0.54390 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.26775 (QuantReg: 13.65745) QuantErr: 13.65745 batch_time=0.50721 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.14552 (QuantReg: 13.61619) QuantErr: 13.61619 batch_time=0.53967 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.38422 (QuantReg: 13.48273) QuantErr: 13.48273 batch_time=0.56960 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.27574 (QuantReg: 13.89508) QuantErr: 13.89508 batch_time=0.52112 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 0.88344 (QuantReg: 14.11571) QuantErr: 14.11571 batch_time=0.53087 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.39663 (QuantReg: 13.50510) QuantErr: 13.50510 batch_time=0.51892 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.10903 (QuantReg: 13.74115) QuantErr: 13.74115 batch_time=0.50825 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.21528 (QuantReg: 13.68326) QuantErr: 13.68326 batch_time=0.51630 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.32310 (QuantReg: 13.52192) QuantErr: 13.52192 batch_time=0.49762 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 0.77856 (QuantReg: 13.96047) QuantErr: 13.96047 batch_time=0.51315 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.02691 (QuantReg: 13.87369) QuantErr: 13.87369 batch_time=1.03415 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.47384 (QuantReg: 13.32465) QuantErr: 13.32465 batch_time=0.49278 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.17463 (QuantReg: 13.74822) QuantErr: 13.74822 batch_time=0.51624 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.09245 (QuantReg: 13.78855) QuantErr: 13.78855 batch_time=0.51167 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.29949 (QuantReg: 13.64581) QuantErr: 13.64581 batch_time=0.60873 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.38839 (QuantReg: 13.87930) QuantErr: 13.87930 batch_time=0.52577 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 1.21752 (QuantReg: 13.99730) QuantErr: 13.99730 batch_time=0.52037 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 0.88897 (QuantReg: 13.88906) QuantErr: 13.88906 batch_time=0.50668 
Train Epoch: 40 codebook_update_time=1.87135
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch40.pth ...
Done in 4.424s
removing stale ckpt [epoch 39] [took 0.04s]
 epoch          : 40
 loss           : 1.1455622963905334
 quant_reg      : 13.777939918518067
 quant_err      : 13.777939918518067
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.024
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.52038518185148
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 55.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4005
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.55836361785974
 mnt_best       : 45.95672805314334
 not_improved_count: 9
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.07845 (QuantReg: 13.91994) QuantErr: 13.91994 batch_time=43.49905 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.18998 (QuantReg: 13.88445) QuantErr: 13.88445 batch_time=0.51777 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.21842 (QuantReg: 13.43991) QuantErr: 13.43991 batch_time=0.58356 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.24611 (QuantReg: 13.73736) QuantErr: 13.73736 batch_time=0.57877 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.22248 (QuantReg: 13.94069) QuantErr: 13.94069 batch_time=0.59316 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 0.88495 (QuantReg: 13.91474) QuantErr: 13.91474 batch_time=0.50840 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 0.96325 (QuantReg: 13.84274) QuantErr: 13.84274 batch_time=0.53819 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 0.99128 (QuantReg: 13.46705) QuantErr: 13.46705 batch_time=0.53982 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.26423 (QuantReg: 13.98500) QuantErr: 13.98500 batch_time=0.56719 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.14818 (QuantReg: 13.85209) QuantErr: 13.85209 batch_time=0.54242 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.00136 (QuantReg: 13.96695) QuantErr: 13.96695 batch_time=0.53085 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.08435 (QuantReg: 13.66692) QuantErr: 13.66692 batch_time=0.52076 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.23447 (QuantReg: 13.81127) QuantErr: 13.81127 batch_time=0.52114 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.25377 (QuantReg: 13.75281) QuantErr: 13.75281 batch_time=0.50422 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.14016 (QuantReg: 13.92472) QuantErr: 13.92472 batch_time=0.62468 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.12148 (QuantReg: 14.01851) QuantErr: 14.01851 batch_time=0.51355 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.24245 (QuantReg: 13.95835) QuantErr: 13.95835 batch_time=0.49879 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 1.06017 (QuantReg: 13.84649) QuantErr: 13.84649 batch_time=0.88793 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.57029 (QuantReg: 13.68495) QuantErr: 13.68495 batch_time=0.50361 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.21045 (QuantReg: 13.70999) QuantErr: 13.70999 batch_time=0.50017 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.11359 (QuantReg: 14.02639) QuantErr: 14.02639 batch_time=0.52490 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.29209 (QuantReg: 13.67486) QuantErr: 13.67486 batch_time=0.52232 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.25294 (QuantReg: 13.66698) QuantErr: 13.66698 batch_time=0.50480 
Train Epoch: 41 codebook_update_time=1.88101
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch41.pth ...
Done in 4.788s
removing stale ckpt [epoch 40] [took 0.02s]
 epoch          : 41
 loss           : 1.1382647614479064
 quant_reg      : 13.795820262908936
 quant_err      : 13.795820262908936
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.602
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.47485790457443
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.4475
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.551676161040405
 mnt_best       : 45.95672805314334
 not_improved_count: 10
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.01502 (QuantReg: 13.97229) QuantErr: 13.97229 batch_time=38.08740 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.03535 (QuantReg: 14.17410) QuantErr: 14.17410 batch_time=0.50278 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.29143 (QuantReg: 13.83582) QuantErr: 13.83582 batch_time=0.53023 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.27126 (QuantReg: 13.54388) QuantErr: 13.54388 batch_time=0.51298 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.36387 (QuantReg: 13.61678) QuantErr: 13.61678 batch_time=0.51248 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.01249 (QuantReg: 13.91042) QuantErr: 13.91042 batch_time=0.50887 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.14687 (QuantReg: 13.73074) QuantErr: 13.73074 batch_time=0.52047 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.22690 (QuantReg: 14.02013) QuantErr: 14.02013 batch_time=0.50604 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 0.90627 (QuantReg: 13.71266) QuantErr: 13.71266 batch_time=0.78184 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.14573 (QuantReg: 13.83984) QuantErr: 13.83984 batch_time=0.58259 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.03204 (QuantReg: 13.62647) QuantErr: 13.62647 batch_time=0.53249 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.22790 (QuantReg: 13.44956) QuantErr: 13.44956 batch_time=0.52845 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.00802 (QuantReg: 13.83708) QuantErr: 13.83708 batch_time=0.51687 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 0.91029 (QuantReg: 13.93539) QuantErr: 13.93539 batch_time=0.50036 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.10621 (QuantReg: 13.88777) QuantErr: 13.88777 batch_time=0.51061 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.25747 (QuantReg: 13.94261) QuantErr: 13.94261 batch_time=0.53279 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 1.11425 (QuantReg: 13.80338) QuantErr: 13.80338 batch_time=0.51375 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 0.94130 (QuantReg: 13.94086) QuantErr: 13.94086 batch_time=0.53002 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 0.92057 (QuantReg: 14.02480) QuantErr: 14.02480 batch_time=0.53424 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.11355 (QuantReg: 13.56947) QuantErr: 13.56947 batch_time=0.50208 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 0.93456 (QuantReg: 13.77845) QuantErr: 13.77845 batch_time=0.52193 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 1.09652 (QuantReg: 13.67868) QuantErr: 13.67868 batch_time=0.51720 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.33159 (QuantReg: 13.99309) QuantErr: 13.99309 batch_time=0.50547 
Train Epoch: 42 codebook_update_time=1.95390
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch42.pth ...
Done in 4.665s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.1218946995735168
 quant_reg      : 13.808434513092042
 quant_err      : 13.808434513092042
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.321
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.628946302805765
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.477
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.24977067332112
 mnt_best       : 45.95672805314334
 not_improved_count: 11
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 1.01807 (QuantReg: 14.04409) QuantErr: 14.04409 batch_time=35.59273 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 0.98807 (QuantReg: 13.80022) QuantErr: 13.80022 batch_time=0.50813 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.04916 (QuantReg: 13.90753) QuantErr: 13.90753 batch_time=0.49853 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.12958 (QuantReg: 13.89727) QuantErr: 13.89727 batch_time=0.49086 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.11465 (QuantReg: 13.89566) QuantErr: 13.89566 batch_time=0.50062 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 0.92125 (QuantReg: 13.95021) QuantErr: 13.95021 batch_time=4.20017 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.33401 (QuantReg: 13.81397) QuantErr: 13.81397 batch_time=0.49611 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.08753 (QuantReg: 13.86771) QuantErr: 13.86771 batch_time=0.51436 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 0.97963 (QuantReg: 13.73157) QuantErr: 13.73157 batch_time=0.49711 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.07030 (QuantReg: 13.71028) QuantErr: 13.71028 batch_time=0.51672 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.07353 (QuantReg: 13.94840) QuantErr: 13.94840 batch_time=0.55586 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 1.02914 (QuantReg: 13.98233) QuantErr: 13.98233 batch_time=0.54908 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 0.96230 (QuantReg: 13.90023) QuantErr: 13.90023 batch_time=0.50023 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 1.09140 (QuantReg: 13.50003) QuantErr: 13.50003 batch_time=0.52052 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.17917 (QuantReg: 13.96820) QuantErr: 13.96820 batch_time=0.55919 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.01780 (QuantReg: 13.88047) QuantErr: 13.88047 batch_time=0.51695 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 0.86115 (QuantReg: 14.11457) QuantErr: 14.11457 batch_time=0.50230 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.06237 (QuantReg: 13.92817) QuantErr: 13.92817 batch_time=0.51314 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.35393 (QuantReg: 13.91675) QuantErr: 13.91675 batch_time=0.49578 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.36786 (QuantReg: 13.94923) QuantErr: 13.94923 batch_time=2.46126 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.12933 (QuantReg: 14.03129) QuantErr: 14.03129 batch_time=0.49671 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 1.00104 (QuantReg: 13.85728) QuantErr: 13.85728 batch_time=0.51353 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.18615 (QuantReg: 13.64171) QuantErr: 13.64171 batch_time=0.52161 
Train Epoch: 43 codebook_update_time=1.67683
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch43.pth ...
Done in 5.543s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 1.1193573124408722
 quant_reg      : 13.809548721313476
 quant_err      : 13.809548721313476
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 56.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 90.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.912
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.797954435314765
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.88
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.680210853236126
 mnt_best       : 45.95672805314334
 not_improved_count: 12
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 0.98156 (QuantReg: 13.71030) QuantErr: 13.71030 batch_time=33.88774 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.19207 (QuantReg: 13.98578) QuantErr: 13.98578 batch_time=0.77264 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.09910 (QuantReg: 13.78620) QuantErr: 13.78620 batch_time=0.53358 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 0.94933 (QuantReg: 13.76938) QuantErr: 13.76938 batch_time=0.97630 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.20736 (QuantReg: 13.68238) QuantErr: 13.68238 batch_time=0.51345 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.35503 (QuantReg: 13.53706) QuantErr: 13.53706 batch_time=0.51910 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.09273 (QuantReg: 13.82074) QuantErr: 13.82074 batch_time=0.50301 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.26585 (QuantReg: 13.72315) QuantErr: 13.72315 batch_time=0.51700 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.30355 (QuantReg: 13.70554) QuantErr: 13.70554 batch_time=1.20443 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.15836 (QuantReg: 13.43932) QuantErr: 13.43932 batch_time=0.51878 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.17059 (QuantReg: 13.83855) QuantErr: 13.83855 batch_time=0.50774 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.12914 (QuantReg: 13.74380) QuantErr: 13.74380 batch_time=0.55131 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.32687 (QuantReg: 13.92737) QuantErr: 13.92737 batch_time=0.80548 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.17050 (QuantReg: 13.73352) QuantErr: 13.73352 batch_time=0.55612 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.28366 (QuantReg: 13.82911) QuantErr: 13.82911 batch_time=0.53497 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.29933 (QuantReg: 13.84930) QuantErr: 13.84930 batch_time=0.60116 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 1.18599 (QuantReg: 13.83774) QuantErr: 13.83774 batch_time=0.66882 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.03535 (QuantReg: 13.89936) QuantErr: 13.89936 batch_time=0.53821 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.13300 (QuantReg: 13.86857) QuantErr: 13.86857 batch_time=0.50496 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.11378 (QuantReg: 13.90256) QuantErr: 13.90256 batch_time=1.73455 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.20212 (QuantReg: 13.83612) QuantErr: 13.83612 batch_time=0.53611 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.40442 (QuantReg: 13.85534) QuantErr: 13.85534 batch_time=0.51396 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.23834 (QuantReg: 13.78522) QuantErr: 13.78522 batch_time=0.55223 
Train Epoch: 44 codebook_update_time=1.66395
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch44.pth ...
Done in 4.681s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.1172862384319306
 quant_reg      : 13.830477390289307
 quant_err      : 13.830477390289307
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.972
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.674344906269155
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.1095
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.43621423463079
 mnt_best       : 45.95672805314334
 not_improved_count: 13
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.35064 (QuantReg: 14.10211) QuantErr: 14.10211 batch_time=39.55762 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.10260 (QuantReg: 13.63528) QuantErr: 13.63528 batch_time=0.55205 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 0.81393 (QuantReg: 14.19644) QuantErr: 14.19644 batch_time=1.39112 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.25374 (QuantReg: 13.73164) QuantErr: 13.73164 batch_time=0.49726 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.16604 (QuantReg: 13.73759) QuantErr: 13.73759 batch_time=0.49680 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.21737 (QuantReg: 13.87022) QuantErr: 13.87022 batch_time=0.52138 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 0.72630 (QuantReg: 14.05386) QuantErr: 14.05386 batch_time=0.58266 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.12492 (QuantReg: 14.08688) QuantErr: 14.08688 batch_time=0.50824 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.17944 (QuantReg: 13.74077) QuantErr: 13.74077 batch_time=0.50384 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 1.01264 (QuantReg: 14.20382) QuantErr: 14.20382 batch_time=0.51280 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 0.98476 (QuantReg: 13.92086) QuantErr: 13.92086 batch_time=0.50200 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.12539 (QuantReg: 14.02996) QuantErr: 14.02996 batch_time=0.50044 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 0.86662 (QuantReg: 13.87185) QuantErr: 13.87185 batch_time=0.51686 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.27451 (QuantReg: 13.81901) QuantErr: 13.81901 batch_time=1.25369 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.23814 (QuantReg: 13.76885) QuantErr: 13.76885 batch_time=0.55726 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 1.00600 (QuantReg: 13.96770) QuantErr: 13.96770 batch_time=0.57559 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.25785 (QuantReg: 13.56051) QuantErr: 13.56051 batch_time=0.55396 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.15211 (QuantReg: 14.08314) QuantErr: 14.08314 batch_time=0.57002 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 0.88767 (QuantReg: 14.01466) QuantErr: 14.01466 batch_time=0.54147 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 0.93489 (QuantReg: 13.88801) QuantErr: 13.88801 batch_time=1.65416 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.20027 (QuantReg: 13.65301) QuantErr: 13.65301 batch_time=0.97885 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 0.88896 (QuantReg: 14.14921) QuantErr: 14.14921 batch_time=0.55977 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 1.23205 (QuantReg: 13.84800) QuantErr: 13.84800 batch_time=0.50182 
Train Epoch: 45 codebook_update_time=1.64139
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch45.pth ...
Done in 4.936s
removing stale ckpt [epoch 44] [took 0.01s]
 epoch          : 45
 loss           : 1.1143287427425383
 quant_reg      : 13.848391704559326
 quant_err      : 13.848391704559326
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.537
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.036450466771925
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.017
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.582130721080674
 mnt_best       : 45.95672805314334
 not_improved_count: 14
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 1.11251 (QuantReg: 13.94205) QuantErr: 13.94205 batch_time=33.31615 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.37817 (QuantReg: 13.53302) QuantErr: 13.53302 batch_time=0.50790 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.26464 (QuantReg: 14.06868) QuantErr: 14.06868 batch_time=0.49025 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.13018 (QuantReg: 13.85672) QuantErr: 13.85672 batch_time=0.51212 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.10017 (QuantReg: 13.69027) QuantErr: 13.69027 batch_time=0.51189 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.07464 (QuantReg: 13.82878) QuantErr: 13.82878 batch_time=0.51275 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 1.09120 (QuantReg: 13.87578) QuantErr: 13.87578 batch_time=0.50101 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.02143 (QuantReg: 13.44316) QuantErr: 13.44316 batch_time=0.49976 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 0.82477 (QuantReg: 13.76193) QuantErr: 13.76193 batch_time=0.52175 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 0.92840 (QuantReg: 14.24805) QuantErr: 14.24805 batch_time=0.55128 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.43564 (QuantReg: 13.88598) QuantErr: 13.88598 batch_time=0.53042 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.10664 (QuantReg: 13.81775) QuantErr: 13.81775 batch_time=0.49399 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.24528 (QuantReg: 13.54930) QuantErr: 13.54930 batch_time=0.50692 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.43982 (QuantReg: 13.66970) QuantErr: 13.66970 batch_time=0.49645 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.40419 (QuantReg: 13.80357) QuantErr: 13.80357 batch_time=0.50018 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 1.27736 (QuantReg: 13.72157) QuantErr: 13.72157 batch_time=0.52961 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.10496 (QuantReg: 13.69688) QuantErr: 13.69688 batch_time=0.52548 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.05529 (QuantReg: 14.00170) QuantErr: 14.00170 batch_time=0.65757 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 1.08271 (QuantReg: 13.96252) QuantErr: 13.96252 batch_time=0.50565 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 1.09544 (QuantReg: 14.03118) QuantErr: 14.03118 batch_time=0.51051 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.02932 (QuantReg: 13.79769) QuantErr: 13.79769 batch_time=0.51628 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 0.77543 (QuantReg: 14.03395) QuantErr: 14.03395 batch_time=0.54866 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.25326 (QuantReg: 14.15261) QuantErr: 14.15261 batch_time=0.54764 
Train Epoch: 46 codebook_update_time=1.68328
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch46.pth ...
Done in 4.672s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 1.1125040955543517
 quant_reg      : 13.847593421936034
 quant_err      : 13.847593421936034
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.16
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.23330112437541
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 69.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.346
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.8167414901788
 mnt_best       : 45.95672805314334
 not_improved_count: 15
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.32919 (QuantReg: 13.51287) QuantErr: 13.51287 batch_time=30.61453 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.01668 (QuantReg: 13.68140) QuantErr: 13.68140 batch_time=0.49884 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.30119 (QuantReg: 13.89577) QuantErr: 13.89577 batch_time=0.49101 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.29025 (QuantReg: 13.77741) QuantErr: 13.77741 batch_time=0.58932 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.09632 (QuantReg: 14.12327) QuantErr: 14.12327 batch_time=0.60278 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 0.94894 (QuantReg: 14.06449) QuantErr: 14.06449 batch_time=0.50117 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.06000 (QuantReg: 14.15002) QuantErr: 14.15002 batch_time=0.51278 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.21404 (QuantReg: 13.89915) QuantErr: 13.89915 batch_time=0.52745 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.32101 (QuantReg: 13.74662) QuantErr: 13.74662 batch_time=0.50733 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 0.83472 (QuantReg: 14.02805) QuantErr: 14.02805 batch_time=0.50228 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 1.01096 (QuantReg: 13.95196) QuantErr: 13.95196 batch_time=0.56243 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 0.99670 (QuantReg: 13.77666) QuantErr: 13.77666 batch_time=0.53985 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.13655 (QuantReg: 14.05537) QuantErr: 14.05537 batch_time=3.46951 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 0.76585 (QuantReg: 13.78544) QuantErr: 13.78544 batch_time=0.49531 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.29105 (QuantReg: 14.04531) QuantErr: 14.04531 batch_time=0.83881 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 0.91974 (QuantReg: 13.96872) QuantErr: 13.96872 batch_time=0.49672 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.34322 (QuantReg: 14.09044) QuantErr: 14.09044 batch_time=0.49850 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.36906 (QuantReg: 13.86550) QuantErr: 13.86550 batch_time=0.53063 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 0.96597 (QuantReg: 13.87286) QuantErr: 13.87286 batch_time=0.50650 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.08317 (QuantReg: 13.73416) QuantErr: 13.73416 batch_time=0.51211 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 0.81536 (QuantReg: 14.06304) QuantErr: 14.06304 batch_time=0.55798 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.15719 (QuantReg: 13.95834) QuantErr: 13.95834 batch_time=0.50686 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 1.09660 (QuantReg: 13.78112) QuantErr: 13.78112 batch_time=0.60779 
Train Epoch: 47 codebook_update_time=1.76501
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch47.pth ...
Done in 10.438s
removing stale ckpt [epoch 46] [took 0.10s]
 epoch          : 47
 loss           : 1.114073738336563
 quant_reg      : 13.882613555908204
 quant_err      : 13.882613555908204
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.267
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.26408128857819
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.012
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.46418423705017
 mnt_best       : 45.95672805314334
 not_improved_count: 16
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.23461 (QuantReg: 13.68660) QuantErr: 13.68660 batch_time=27.73676 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.21662 (QuantReg: 13.96063) QuantErr: 13.96063 batch_time=0.49807 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.23031 (QuantReg: 13.90692) QuantErr: 13.90692 batch_time=0.51459 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.10891 (QuantReg: 13.67835) QuantErr: 13.67835 batch_time=0.52883 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.16407 (QuantReg: 13.75190) QuantErr: 13.75190 batch_time=0.49193 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.13726 (QuantReg: 14.04818) QuantErr: 14.04818 batch_time=0.49523 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.02933 (QuantReg: 13.85793) QuantErr: 13.85793 batch_time=4.36818 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.27064 (QuantReg: 13.94935) QuantErr: 13.94935 batch_time=0.55296 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.01980 (QuantReg: 14.20375) QuantErr: 14.20375 batch_time=0.53826 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.07724 (QuantReg: 13.99008) QuantErr: 13.99008 batch_time=0.51760 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.10146 (QuantReg: 13.93283) QuantErr: 13.93283 batch_time=0.51301 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.06285 (QuantReg: 13.64051) QuantErr: 13.64051 batch_time=0.54744 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.24218 (QuantReg: 13.76383) QuantErr: 13.76383 batch_time=0.51410 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.44619 (QuantReg: 13.78945) QuantErr: 13.78945 batch_time=0.53339 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 1.24758 (QuantReg: 13.83018) QuantErr: 13.83018 batch_time=0.51053 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.27305 (QuantReg: 13.77603) QuantErr: 13.77603 batch_time=0.56922 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.80882 (QuantReg: 13.89024) QuantErr: 13.89024 batch_time=0.53037 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.00557 (QuantReg: 14.08402) QuantErr: 14.08402 batch_time=0.50111 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.15784 (QuantReg: 13.89569) QuantErr: 13.89569 batch_time=0.59157 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 0.97692 (QuantReg: 13.84960) QuantErr: 13.84960 batch_time=0.60053 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.23529 (QuantReg: 13.97651) QuantErr: 13.97651 batch_time=0.52024 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.13948 (QuantReg: 13.75401) QuantErr: 13.75401 batch_time=0.54955 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.00111 (QuantReg: 13.82036) QuantErr: 13.82036 batch_time=0.51072 
Train Epoch: 48 codebook_update_time=1.81710
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch48.pth ...
Done in 5.597s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 1.1096858274936676
 quant_reg      : 13.879004173278808
 quant_err      : 13.879004173278808
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.599
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.789996734747405
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.113
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.099081756883066
 mnt_best       : 45.95672805314334
 not_improved_count: 17
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.15743 (QuantReg: 13.86558) QuantErr: 13.86558 batch_time=36.57867 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.15136 (QuantReg: 13.96013) QuantErr: 13.96013 batch_time=0.49752 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.11090 (QuantReg: 13.88331) QuantErr: 13.88331 batch_time=0.53025 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.30226 (QuantReg: 13.97480) QuantErr: 13.97480 batch_time=0.50267 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.23860 (QuantReg: 13.73228) QuantErr: 13.73228 batch_time=0.57398 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.15900 (QuantReg: 13.88549) QuantErr: 13.88549 batch_time=0.84181 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.05563 (QuantReg: 13.65218) QuantErr: 13.65218 batch_time=0.52166 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.86705 (QuantReg: 14.02184) QuantErr: 14.02184 batch_time=0.71261 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 0.88244 (QuantReg: 13.69827) QuantErr: 13.69827 batch_time=0.49209 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.04037 (QuantReg: 13.87366) QuantErr: 13.87366 batch_time=0.49596 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.16757 (QuantReg: 14.06232) QuantErr: 14.06232 batch_time=0.52336 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 0.90806 (QuantReg: 13.78238) QuantErr: 13.78238 batch_time=0.63913 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.23010 (QuantReg: 13.64897) QuantErr: 13.64897 batch_time=6.16229 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.17163 (QuantReg: 13.78506) QuantErr: 13.78506 batch_time=0.54369 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.07339 (QuantReg: 13.83093) QuantErr: 13.83093 batch_time=0.49684 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 0.87347 (QuantReg: 13.85686) QuantErr: 13.85686 batch_time=0.49201 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 0.97774 (QuantReg: 13.82022) QuantErr: 13.82022 batch_time=0.50363 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.12688 (QuantReg: 14.16953) QuantErr: 14.16953 batch_time=0.53607 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.21441 (QuantReg: 13.93134) QuantErr: 13.93134 batch_time=0.50263 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.28613 (QuantReg: 13.72893) QuantErr: 13.72893 batch_time=0.53843 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 0.94335 (QuantReg: 13.93921) QuantErr: 13.93921 batch_time=0.50558 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 0.76213 (QuantReg: 13.84329) QuantErr: 13.84329 batch_time=0.49575 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.13982 (QuantReg: 13.87756) QuantErr: 13.87756 batch_time=0.48681 
Train Epoch: 49 codebook_update_time=1.68383
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch49.pth ...
Done in 4.613s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch49.pth ...
Done in 9.378s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 1.1100695459842682
 quant_reg      : 13.8956859664917
 quant_err      : 13.8956859664917
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 69.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.062
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 46.09386629981193
 MSRVTT_jsfusion_test/v2t_metrics/R1: 26.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.1535
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 47.18995255588879
 mnt_best       : 46.09386629981193
 not_improved_count: 0
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.09277 (QuantReg: 14.06434) QuantErr: 14.06434 batch_time=33.34507 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.71634 (QuantReg: 13.83265) QuantErr: 13.83265 batch_time=0.50692 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 0.91062 (QuantReg: 14.05782) QuantErr: 14.05782 batch_time=0.50897 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.00634 (QuantReg: 14.05888) QuantErr: 14.05888 batch_time=0.51204 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.25720 (QuantReg: 13.79329) QuantErr: 13.79329 batch_time=0.49715 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 1.08100 (QuantReg: 13.96092) QuantErr: 13.96092 batch_time=0.54664 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.23311 (QuantReg: 13.88281) QuantErr: 13.88281 batch_time=0.57302 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 1.01423 (QuantReg: 13.85368) QuantErr: 13.85368 batch_time=0.49994 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 0.99615 (QuantReg: 13.87470) QuantErr: 13.87470 batch_time=0.50298 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.08887 (QuantReg: 14.10569) QuantErr: 14.10569 batch_time=0.54729 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 0.89911 (QuantReg: 14.22617) QuantErr: 14.22617 batch_time=0.53206 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 1.00588 (QuantReg: 13.84958) QuantErr: 13.84958 batch_time=0.54446 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.10305 (QuantReg: 13.91885) QuantErr: 13.91885 batch_time=0.50051 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.31833 (QuantReg: 13.73726) QuantErr: 13.73726 batch_time=0.98193 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.23018 (QuantReg: 13.74822) QuantErr: 13.74822 batch_time=0.50915 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 0.80235 (QuantReg: 13.82958) QuantErr: 13.82958 batch_time=0.87082 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.25802 (QuantReg: 14.15468) QuantErr: 14.15468 batch_time=0.51180 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.21685 (QuantReg: 13.97730) QuantErr: 13.97730 batch_time=0.55129 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.17393 (QuantReg: 13.83476) QuantErr: 13.83476 batch_time=0.50646 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 0.90308 (QuantReg: 14.05465) QuantErr: 14.05465 batch_time=0.76467 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.11747 (QuantReg: 14.03314) QuantErr: 14.03314 batch_time=0.56206 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 1.18906 (QuantReg: 13.83643) QuantErr: 13.83643 batch_time=0.51214 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.15344 (QuantReg: 13.80908) QuantErr: 13.80908 batch_time=0.50929 
Train Epoch: 50 codebook_update_time=1.72840
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/checkpoint-epoch50.pth ...
Done in 4.423s
removing stale ckpt [epoch 49] [took 0.12s]
 epoch          : 50
 loss           : 1.0978270320892334
 quant_reg      : 13.94278651046753
 quant_err      : 13.94278651046753
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 55.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 68.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 89.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.105
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 45.86593130759851
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 56.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 70.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 90.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.4405
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 46.81200975658354
 mnt_best       : 46.09386629981193
 not_improved_count: 1
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/trained_model.pth ...
Ckpt loaded at epoch 49.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 25.9
 t2v_metrics/R5/final_eval: 54.8
 t2v_metrics/R10/final_eval: 69.0
 t2v_metrics/R50/final_eval: 88.8
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 28.062
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 46.09386629981193
 v2t_metrics/R1/final_eval: 26.3
 v2t_metrics/R5/final_eval: 57.0
 v2t_metrics/R10/final_eval: 70.1
 v2t_metrics/R50/final_eval: 90.0
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 25.1535
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 47.18995255588879
Best epoch for the monitored metric: 49
Script took 03h53m18s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA/trained_model.pth

