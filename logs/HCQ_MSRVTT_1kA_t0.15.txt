Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 1061.3292739391327 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 105.40812158584595 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 51.872172117233276 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch0.pth ...
Done in 1.577s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch0.pth ...
Done in 3.182s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 0.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 486.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 496.278
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 6.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 509.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 503.537
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.5192494101851104
 mnt_best       : 0.0
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 9.71507 (QuantReg: 22.49939) QuantErr: 22.49939 batch_time=28.48106 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 8.85176 (QuantReg: 22.56552) QuantErr: 22.56552 batch_time=2.24332 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 7.75011 (QuantReg: 22.65800) QuantErr: 22.65800 batch_time=0.59002 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 6.84697 (QuantReg: 22.59103) QuantErr: 22.59103 batch_time=0.55223 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 6.85477 (QuantReg: 22.62226) QuantErr: 22.62226 batch_time=0.51272 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 6.29332 (QuantReg: 22.65170) QuantErr: 22.65170 batch_time=0.52012 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 6.27988 (QuantReg: 22.56371) QuantErr: 22.56371 batch_time=0.54950 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 5.75210 (QuantReg: 22.67065) QuantErr: 22.67065 batch_time=3.49432 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 6.13905 (QuantReg: 22.62144) QuantErr: 22.62144 batch_time=1.35790 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 6.12419 (QuantReg: 22.65138) QuantErr: 22.65138 batch_time=0.53434 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 5.35198 (QuantReg: 22.62474) QuantErr: 22.62474 batch_time=0.52625 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 5.62460 (QuantReg: 22.62566) QuantErr: 22.62566 batch_time=0.55886 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 5.69483 (QuantReg: 22.61768) QuantErr: 22.61768 batch_time=0.55872 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 5.20831 (QuantReg: 22.64135) QuantErr: 22.64135 batch_time=0.52341 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 5.53101 (QuantReg: 22.61454) QuantErr: 22.61454 batch_time=0.50006 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 5.13933 (QuantReg: 22.56819) QuantErr: 22.56819 batch_time=0.49983 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 5.58292 (QuantReg: 22.62955) QuantErr: 22.62955 batch_time=0.55275 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 5.38089 (QuantReg: 22.63545) QuantErr: 22.63545 batch_time=0.51261 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 5.06450 (QuantReg: 22.62148) QuantErr: 22.62148 batch_time=0.51185 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 5.40943 (QuantReg: 22.61671) QuantErr: 22.61671 batch_time=2.46414 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 4.76435 (QuantReg: 22.64377) QuantErr: 22.64377 batch_time=0.51474 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 5.24297 (QuantReg: 22.60773) QuantErr: 22.60773 batch_time=1.75231 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 4.70873 (QuantReg: 22.61424) QuantErr: 22.61424 batch_time=0.50207 
Train Epoch: 1 codebook_update_time=1.90364
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch1.pth ...
Done in 4.210s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch1.pth ...
Done in 8.264s
 epoch          : 1
 loss           : 6.03826442527771
 quant_reg      : 22.61514631652832
 quant_err      : 22.61514631652832
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 8.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 26.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 37.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 74.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 18.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 50.945
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.560586183179254
 MSRVTT_jsfusion_test/v2t_metrics/R1: 7.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 28.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 40.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 75.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 16.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 49.68
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.212233220009455
 mnt_best       : 20.560586183179254
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 5.06309 (QuantReg: 8.66524) QuantErr: 8.66524 batch_time=32.67218 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 4.79457 (QuantReg: 8.56861) QuantErr: 8.56861 batch_time=0.51715 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 4.99548 (QuantReg: 9.16455) QuantErr: 9.16455 batch_time=0.51250 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 4.81524 (QuantReg: 9.01130) QuantErr: 9.01130 batch_time=0.49618 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 4.89360 (QuantReg: 9.63269) QuantErr: 9.63269 batch_time=0.51970 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 4.88446 (QuantReg: 9.62346) QuantErr: 9.62346 batch_time=0.51584 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 4.66308 (QuantReg: 9.56269) QuantErr: 9.56269 batch_time=0.51863 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 4.95229 (QuantReg: 9.68114) QuantErr: 9.68114 batch_time=0.51159 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 4.50444 (QuantReg: 9.94881) QuantErr: 9.94881 batch_time=0.51301 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 5.11892 (QuantReg: 9.78800) QuantErr: 9.78800 batch_time=0.52773 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 4.63643 (QuantReg: 9.77652) QuantErr: 9.77652 batch_time=0.50790 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 4.50555 (QuantReg: 10.15730) QuantErr: 10.15730 batch_time=0.53657 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 4.63996 (QuantReg: 10.03140) QuantErr: 10.03140 batch_time=0.54106 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 4.96574 (QuantReg: 10.04242) QuantErr: 10.04242 batch_time=4.55594 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 4.84687 (QuantReg: 9.91009) QuantErr: 9.91009 batch_time=0.55265 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 4.57052 (QuantReg: 10.51773) QuantErr: 10.51773 batch_time=0.51187 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 4.75338 (QuantReg: 10.54191) QuantErr: 10.54191 batch_time=0.51131 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 4.61558 (QuantReg: 10.34643) QuantErr: 10.34643 batch_time=0.51655 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 4.42830 (QuantReg: 10.73341) QuantErr: 10.73341 batch_time=0.52143 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 4.41489 (QuantReg: 10.40721) QuantErr: 10.40721 batch_time=0.51072 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 4.43219 (QuantReg: 10.62118) QuantErr: 10.62118 batch_time=0.51228 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 4.59575 (QuantReg: 10.59253) QuantErr: 10.59253 batch_time=0.52139 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 4.59020 (QuantReg: 10.86197) QuantErr: 10.86197 batch_time=0.49799 
Train Epoch: 2 codebook_update_time=1.78157
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch2.pth ...
Done in 4.354s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch2.pth ...
Done in 8.465s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.02s]
 epoch          : 2
 loss           : 4.7098689422607425
 quant_reg      : 9.970110786437989
 quant_err      : 9.970110786437989
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 10.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 32.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 46.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 79.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 42.209
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.9760795197247
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 35.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 49.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 41.6245
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.797683025356136
 mnt_best       : 24.9760795197247
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 4.49590 (QuantReg: 7.97601) QuantErr: 7.97601 batch_time=29.51515 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 4.38398 (QuantReg: 8.09098) QuantErr: 8.09098 batch_time=0.51243 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 4.39496 (QuantReg: 8.25556) QuantErr: 8.25556 batch_time=0.53417 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 4.32706 (QuantReg: 8.03897) QuantErr: 8.03897 batch_time=0.52716 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 4.17080 (QuantReg: 8.22381) QuantErr: 8.22381 batch_time=0.56657 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 3.77491 (QuantReg: 7.77047) QuantErr: 7.77047 batch_time=0.52220 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 4.72790 (QuantReg: 8.41699) QuantErr: 8.41699 batch_time=0.58270 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 4.57654 (QuantReg: 8.33924) QuantErr: 8.33924 batch_time=0.49660 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 4.50961 (QuantReg: 8.17006) QuantErr: 8.17006 batch_time=0.52330 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 4.01199 (QuantReg: 8.43796) QuantErr: 8.43796 batch_time=0.51418 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 4.25547 (QuantReg: 8.13152) QuantErr: 8.13152 batch_time=0.53115 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 4.26216 (QuantReg: 8.28319) QuantErr: 8.28319 batch_time=0.52226 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 4.05685 (QuantReg: 7.91246) QuantErr: 7.91246 batch_time=0.53207 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 4.26420 (QuantReg: 8.20767) QuantErr: 8.20767 batch_time=0.51404 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 4.45824 (QuantReg: 7.86393) QuantErr: 7.86393 batch_time=0.56656 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 4.06341 (QuantReg: 8.24768) QuantErr: 8.24768 batch_time=0.58705 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 4.31144 (QuantReg: 8.57831) QuantErr: 8.57831 batch_time=0.53451 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 4.29223 (QuantReg: 8.56605) QuantErr: 8.56605 batch_time=0.58653 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 4.02453 (QuantReg: 8.49747) QuantErr: 8.49747 batch_time=0.51930 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 4.08301 (QuantReg: 8.54397) QuantErr: 8.54397 batch_time=0.51129 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 4.15385 (QuantReg: 8.32943) QuantErr: 8.32943 batch_time=0.51170 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 4.26902 (QuantReg: 8.87136) QuantErr: 8.87136 batch_time=0.50018 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 4.26446 (QuantReg: 8.89293) QuantErr: 8.89293 batch_time=0.52240 
Train Epoch: 3 codebook_update_time=1.72864
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch3.pth ...
Done in 4.171s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch3.pth ...
Done in 8.310s
removing stale ckpt [epoch 2] [took 0.04s]
 epoch          : 3
 loss           : 4.273318289756775
 quant_reg      : 8.268850830078126
 quant_err      : 8.268850830078126
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 35.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 49.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 81.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 39.914
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.284980813840267
 MSRVTT_jsfusion_test/v2t_metrics/R1: 12.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 36.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 82.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 38.881
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.732911937422493
 mnt_best       : 28.284980813840267
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 4.13281 (QuantReg: 7.67988) QuantErr: 7.67988 batch_time=35.91327 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 4.07429 (QuantReg: 7.61803) QuantErr: 7.61803 batch_time=0.51657 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 4.14953 (QuantReg: 7.49242) QuantErr: 7.49242 batch_time=0.52307 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 4.02136 (QuantReg: 7.72889) QuantErr: 7.72889 batch_time=0.50979 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 3.98344 (QuantReg: 7.71693) QuantErr: 7.71693 batch_time=0.51496 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 4.11124 (QuantReg: 7.52727) QuantErr: 7.52727 batch_time=0.52904 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 3.86746 (QuantReg: 7.32280) QuantErr: 7.32280 batch_time=0.53121 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 4.06157 (QuantReg: 7.85078) QuantErr: 7.85078 batch_time=0.50358 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 4.16517 (QuantReg: 7.54091) QuantErr: 7.54091 batch_time=0.59390 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 3.76125 (QuantReg: 7.63397) QuantErr: 7.63397 batch_time=0.51445 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 4.04575 (QuantReg: 7.99628) QuantErr: 7.99628 batch_time=0.50667 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 3.84107 (QuantReg: 8.12198) QuantErr: 8.12198 batch_time=0.52981 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 4.17054 (QuantReg: 7.53461) QuantErr: 7.53461 batch_time=0.51795 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 4.01932 (QuantReg: 7.80580) QuantErr: 7.80580 batch_time=0.51938 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 3.91901 (QuantReg: 7.66427) QuantErr: 7.66427 batch_time=0.52032 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 4.04186 (QuantReg: 7.57764) QuantErr: 7.57764 batch_time=0.52469 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 3.91900 (QuantReg: 7.61988) QuantErr: 7.61988 batch_time=0.51222 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 3.96446 (QuantReg: 7.68022) QuantErr: 7.68022 batch_time=0.54362 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 3.82236 (QuantReg: 8.19657) QuantErr: 8.19657 batch_time=0.50667 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 3.68894 (QuantReg: 7.55926) QuantErr: 7.55926 batch_time=0.50689 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 3.52991 (QuantReg: 7.97103) QuantErr: 7.97103 batch_time=0.52609 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 3.56731 (QuantReg: 7.91212) QuantErr: 7.91212 batch_time=0.55230 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 4.08286 (QuantReg: 7.68884) QuantErr: 7.68884 batch_time=0.51766 
Train Epoch: 4 codebook_update_time=1.77274
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch4.pth ...
Done in 4.441s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch4.pth ...
Done in 27.270s
removing stale ckpt [epoch 3] [took 0.03s]
 epoch          : 4
 loss           : 4.04977656841278
 quant_reg      : 7.673007284164429
 quant_err      : 7.673007284164429
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 12.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 35.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 38.454
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.51926306217149
 MSRVTT_jsfusion_test/v2t_metrics/R1: 13.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 38.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 53.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 83.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 37.303
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.149603827482718
 mnt_best       : 28.51926306217149
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 3.85327 (QuantReg: 7.08745) QuantErr: 7.08745 batch_time=34.08916 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 4.18763 (QuantReg: 7.56980) QuantErr: 7.56980 batch_time=0.53919 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 3.55704 (QuantReg: 6.83779) QuantErr: 6.83779 batch_time=0.50079 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 4.00665 (QuantReg: 7.58658) QuantErr: 7.58658 batch_time=0.55190 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 3.92468 (QuantReg: 7.24151) QuantErr: 7.24151 batch_time=0.50102 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 3.70855 (QuantReg: 7.71350) QuantErr: 7.71350 batch_time=0.49035 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 3.82062 (QuantReg: 7.03762) QuantErr: 7.03762 batch_time=1.61406 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 4.25748 (QuantReg: 7.12534) QuantErr: 7.12534 batch_time=1.84314 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 3.87764 (QuantReg: 7.66295) QuantErr: 7.66295 batch_time=0.52212 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 3.80814 (QuantReg: 7.44403) QuantErr: 7.44403 batch_time=0.50858 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 3.84239 (QuantReg: 7.51245) QuantErr: 7.51245 batch_time=0.51687 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 3.81031 (QuantReg: 7.34043) QuantErr: 7.34043 batch_time=0.53224 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 3.72192 (QuantReg: 7.80602) QuantErr: 7.80602 batch_time=0.52891 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 3.59789 (QuantReg: 7.26705) QuantErr: 7.26705 batch_time=0.51625 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 4.19476 (QuantReg: 7.76666) QuantErr: 7.76666 batch_time=0.56869 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 3.67321 (QuantReg: 7.56805) QuantErr: 7.56805 batch_time=0.56934 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 4.01544 (QuantReg: 7.51322) QuantErr: 7.51322 batch_time=0.52179 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 3.90477 (QuantReg: 7.60936) QuantErr: 7.60936 batch_time=0.51857 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 3.85764 (QuantReg: 7.63617) QuantErr: 7.63617 batch_time=0.51685 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 3.74896 (QuantReg: 7.35072) QuantErr: 7.35072 batch_time=0.50285 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 3.97909 (QuantReg: 7.54272) QuantErr: 7.54272 batch_time=1.01350 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 3.71212 (QuantReg: 7.29323) QuantErr: 7.29323 batch_time=0.50387 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 3.95998 (QuantReg: 8.11188) QuantErr: 8.11188 batch_time=0.55190 
Train Epoch: 5 codebook_update_time=1.88929
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch5.pth ...
Done in 19.773s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch5.pth ...
Done in 23.811s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 3.8486186122894286
 quant_reg      : 7.475792219161987
 quant_err      : 7.475792219161987
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 37.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 54.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.164
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.754192192229116
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 39.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 53.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.6435
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.31721298695106
 mnt_best       : 29.754192192229116
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 4.02394 (QuantReg: 7.28264) QuantErr: 7.28264 batch_time=31.08013 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 3.83569 (QuantReg: 6.93141) QuantErr: 6.93141 batch_time=0.49888 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 3.78752 (QuantReg: 6.92115) QuantErr: 6.92115 batch_time=0.49674 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 3.74653 (QuantReg: 7.22028) QuantErr: 7.22028 batch_time=0.53949 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 3.79417 (QuantReg: 7.11781) QuantErr: 7.11781 batch_time=0.52429 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 3.61123 (QuantReg: 7.02565) QuantErr: 7.02565 batch_time=0.51923 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 3.88072 (QuantReg: 7.35820) QuantErr: 7.35820 batch_time=1.24431 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 3.68741 (QuantReg: 7.23973) QuantErr: 7.23973 batch_time=0.56938 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 3.68009 (QuantReg: 7.26092) QuantErr: 7.26092 batch_time=0.55558 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 3.58052 (QuantReg: 6.97990) QuantErr: 6.97990 batch_time=0.51739 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 3.60481 (QuantReg: 7.86545) QuantErr: 7.86545 batch_time=0.49721 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 3.70723 (QuantReg: 7.30094) QuantErr: 7.30094 batch_time=0.50453 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 3.65898 (QuantReg: 7.23934) QuantErr: 7.23934 batch_time=0.52891 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 3.50983 (QuantReg: 7.35311) QuantErr: 7.35311 batch_time=0.50305 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 4.08382 (QuantReg: 7.49063) QuantErr: 7.49063 batch_time=0.49486 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 3.84546 (QuantReg: 7.59605) QuantErr: 7.59605 batch_time=0.50205 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 3.51516 (QuantReg: 7.55375) QuantErr: 7.55375 batch_time=0.64886 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 3.81879 (QuantReg: 7.03323) QuantErr: 7.03323 batch_time=0.54901 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 3.85540 (QuantReg: 7.59175) QuantErr: 7.59175 batch_time=0.50895 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 3.72830 (QuantReg: 7.43437) QuantErr: 7.43437 batch_time=0.50625 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 3.55501 (QuantReg: 7.26368) QuantErr: 7.26368 batch_time=0.54653 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 3.41963 (QuantReg: 7.08561) QuantErr: 7.08561 batch_time=0.51501 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 3.45550 (QuantReg: 7.37444) QuantErr: 7.37444 batch_time=0.53666 
Train Epoch: 6 codebook_update_time=1.94946
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch6.pth ...
Done in 20.882s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch6.pth ...
Done in 24.948s
removing stale ckpt [epoch 5] [took 0.02s]
 epoch          : 6
 loss           : 3.716225005149841
 quant_reg      : 7.322885129928589
 quant_err      : 7.322885129928589
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 38.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 55.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 84.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.796
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.60884660273868
 MSRVTT_jsfusion_test/v2t_metrics/R1: 13.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 36.943
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.243733868956568
 mnt_best       : 30.60884660273868
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 3.57141 (QuantReg: 6.71905) QuantErr: 6.71905 batch_time=32.84574 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 3.78450 (QuantReg: 6.95573) QuantErr: 6.95573 batch_time=0.51277 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 3.66731 (QuantReg: 6.66461) QuantErr: 6.66461 batch_time=0.56989 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 3.50497 (QuantReg: 7.21003) QuantErr: 7.21003 batch_time=0.50626 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 3.37387 (QuantReg: 7.12838) QuantErr: 7.12838 batch_time=0.50860 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 3.54470 (QuantReg: 7.16479) QuantErr: 7.16479 batch_time=0.53297 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 3.83147 (QuantReg: 7.34689) QuantErr: 7.34689 batch_time=0.50683 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 3.68385 (QuantReg: 7.31663) QuantErr: 7.31663 batch_time=0.51346 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 3.66877 (QuantReg: 7.41896) QuantErr: 7.41896 batch_time=0.55152 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 3.40443 (QuantReg: 7.15665) QuantErr: 7.15665 batch_time=0.51590 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 3.78429 (QuantReg: 7.35336) QuantErr: 7.35336 batch_time=0.51489 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 3.63312 (QuantReg: 7.22058) QuantErr: 7.22058 batch_time=0.51691 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 3.44121 (QuantReg: 7.23562) QuantErr: 7.23562 batch_time=0.53157 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 3.57691 (QuantReg: 6.98342) QuantErr: 6.98342 batch_time=0.51753 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 3.18668 (QuantReg: 7.14998) QuantErr: 7.14998 batch_time=0.51576 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 3.70757 (QuantReg: 7.19606) QuantErr: 7.19606 batch_time=1.62608 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 3.26135 (QuantReg: 7.37905) QuantErr: 7.37905 batch_time=0.51047 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 3.51647 (QuantReg: 6.87287) QuantErr: 6.87287 batch_time=0.54241 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 3.21276 (QuantReg: 7.41629) QuantErr: 7.41629 batch_time=0.50918 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 3.67671 (QuantReg: 7.41125) QuantErr: 7.41125 batch_time=0.51672 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 3.58751 (QuantReg: 7.34896) QuantErr: 7.34896 batch_time=0.50396 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 3.63554 (QuantReg: 8.10933) QuantErr: 8.10933 batch_time=0.51202 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 3.48628 (QuantReg: 7.34700) QuantErr: 7.34700 batch_time=0.55428 
Train Epoch: 7 codebook_update_time=1.87850
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch7.pth ...
Done in 16.502s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch7.pth ...
Done in 20.942s
removing stale ckpt [epoch 6] [took 0.01s]
 epoch          : 7
 loss           : 3.57391588973999
 quant_reg      : 7.223409271240234
 quant_err      : 7.223409271240234
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 54.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 84.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.415
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.84483477081878
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 54.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.985
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.17676139210542
 mnt_best       : 31.84483477081878
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 3.48720 (QuantReg: 6.85562) QuantErr: 6.85562 batch_time=32.39706 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 3.66974 (QuantReg: 6.90665) QuantErr: 6.90665 batch_time=0.53214 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 4.07353 (QuantReg: 7.21252) QuantErr: 7.21252 batch_time=0.49839 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 3.51128 (QuantReg: 6.89243) QuantErr: 6.89243 batch_time=0.53573 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 3.68991 (QuantReg: 7.40212) QuantErr: 7.40212 batch_time=0.50568 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 3.35106 (QuantReg: 6.49298) QuantErr: 6.49298 batch_time=0.55469 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 3.64329 (QuantReg: 7.14043) QuantErr: 7.14043 batch_time=0.49299 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 3.77253 (QuantReg: 7.21690) QuantErr: 7.21690 batch_time=0.53728 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 3.57891 (QuantReg: 7.05550) QuantErr: 7.05550 batch_time=0.50654 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 3.73580 (QuantReg: 7.13678) QuantErr: 7.13678 batch_time=0.51774 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 3.70367 (QuantReg: 7.27505) QuantErr: 7.27505 batch_time=0.52028 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 3.41677 (QuantReg: 6.93877) QuantErr: 6.93877 batch_time=0.51495 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 3.41062 (QuantReg: 7.09456) QuantErr: 7.09456 batch_time=0.57023 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 3.63194 (QuantReg: 7.57217) QuantErr: 7.57217 batch_time=0.51465 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 3.53120 (QuantReg: 7.53636) QuantErr: 7.53636 batch_time=0.51323 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 3.42935 (QuantReg: 7.15578) QuantErr: 7.15578 batch_time=0.49950 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 3.32648 (QuantReg: 6.82556) QuantErr: 6.82556 batch_time=0.53560 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 3.72825 (QuantReg: 7.23181) QuantErr: 7.23181 batch_time=0.52367 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 3.66552 (QuantReg: 7.07004) QuantErr: 7.07004 batch_time=0.50114 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 3.73672 (QuantReg: 7.01182) QuantErr: 7.01182 batch_time=0.50060 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 3.59768 (QuantReg: 7.17315) QuantErr: 7.17315 batch_time=0.56490 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 3.15524 (QuantReg: 7.06060) QuantErr: 7.06060 batch_time=0.56241 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 3.78524 (QuantReg: 7.19863) QuantErr: 7.19863 batch_time=0.51087 
Train Epoch: 8 codebook_update_time=1.85591
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch8.pth ...
Done in 4.362s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch8.pth ...
Done in 8.440s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 3.5046350536346433
 quant_reg      : 7.119911645889283
 quant_err      : 7.119911645889283
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 41.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 84.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.1
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.78520922459328
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 56.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.815
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.822694610057006
 mnt_best       : 32.78520922459328
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 3.17733 (QuantReg: 7.30120) QuantErr: 7.30120 batch_time=31.77847 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 3.57027 (QuantReg: 7.15511) QuantErr: 7.15511 batch_time=0.51388 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 3.11727 (QuantReg: 6.62091) QuantErr: 6.62091 batch_time=0.54103 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 3.55238 (QuantReg: 7.27541) QuantErr: 7.27541 batch_time=0.53678 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 3.53798 (QuantReg: 7.06443) QuantErr: 7.06443 batch_time=0.57141 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 3.19428 (QuantReg: 7.26830) QuantErr: 7.26830 batch_time=0.53006 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 3.26070 (QuantReg: 7.18226) QuantErr: 7.18226 batch_time=0.52982 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 3.42971 (QuantReg: 7.29643) QuantErr: 7.29643 batch_time=0.54553 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 3.62878 (QuantReg: 6.85673) QuantErr: 6.85673 batch_time=0.50907 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 3.19140 (QuantReg: 7.15928) QuantErr: 7.15928 batch_time=0.50708 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 3.45521 (QuantReg: 7.22764) QuantErr: 7.22764 batch_time=0.55978 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 3.21472 (QuantReg: 6.96545) QuantErr: 6.96545 batch_time=0.53573 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 3.43587 (QuantReg: 7.12041) QuantErr: 7.12041 batch_time=0.52207 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 3.31913 (QuantReg: 6.78116) QuantErr: 6.78116 batch_time=0.51350 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 3.36338 (QuantReg: 6.62581) QuantErr: 6.62581 batch_time=0.52679 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 3.24097 (QuantReg: 7.23701) QuantErr: 7.23701 batch_time=0.52926 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 3.57738 (QuantReg: 7.26919) QuantErr: 7.26919 batch_time=0.50429 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 3.17492 (QuantReg: 7.35696) QuantErr: 7.35696 batch_time=0.58133 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 3.52726 (QuantReg: 6.97239) QuantErr: 6.97239 batch_time=0.52874 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 3.26134 (QuantReg: 7.29229) QuantErr: 7.29229 batch_time=1.71229 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 3.36996 (QuantReg: 7.34140) QuantErr: 7.34140 batch_time=1.53365 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 3.08996 (QuantReg: 6.63038) QuantErr: 6.63038 batch_time=0.56241 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 3.34577 (QuantReg: 6.82710) QuantErr: 6.82710 batch_time=0.51788 
Train Epoch: 9 codebook_update_time=1.77508
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch9.pth ...
Done in 6.016s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch9.pth ...
Done in 11.315s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 3.397524713516235
 quant_reg      : 7.043995719909668
 quant_err      : 7.043995719909668
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.934
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.28020238027201
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.7895
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.10351334697459
 mnt_best       : 33.28020238027201
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 3.21166 (QuantReg: 7.03927) QuantErr: 7.03927 batch_time=32.91061 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 3.42553 (QuantReg: 6.80705) QuantErr: 6.80705 batch_time=1.64332 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 3.68113 (QuantReg: 7.24539) QuantErr: 7.24539 batch_time=0.50960 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 3.33232 (QuantReg: 6.69922) QuantErr: 6.69922 batch_time=0.68183 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 3.13117 (QuantReg: 6.95322) QuantErr: 6.95322 batch_time=0.50416 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 3.28497 (QuantReg: 6.85774) QuantErr: 6.85774 batch_time=0.52481 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 3.50016 (QuantReg: 6.86462) QuantErr: 6.86462 batch_time=1.18906 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 3.49407 (QuantReg: 7.04715) QuantErr: 7.04715 batch_time=0.54480 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 3.41706 (QuantReg: 7.04074) QuantErr: 7.04074 batch_time=0.51176 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 3.42021 (QuantReg: 7.10258) QuantErr: 7.10258 batch_time=0.52215 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 3.33643 (QuantReg: 6.92522) QuantErr: 6.92522 batch_time=0.50610 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 3.40667 (QuantReg: 7.03640) QuantErr: 7.03640 batch_time=0.58223 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 3.34615 (QuantReg: 6.74104) QuantErr: 6.74104 batch_time=0.51505 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 3.06764 (QuantReg: 7.06162) QuantErr: 7.06162 batch_time=0.50919 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 3.33225 (QuantReg: 6.72858) QuantErr: 6.72858 batch_time=0.50922 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 3.59440 (QuantReg: 7.18615) QuantErr: 7.18615 batch_time=0.64916 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 3.37914 (QuantReg: 6.90296) QuantErr: 6.90296 batch_time=0.54234 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 3.21163 (QuantReg: 7.00194) QuantErr: 7.00194 batch_time=0.56203 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 3.11430 (QuantReg: 7.18399) QuantErr: 7.18399 batch_time=0.52775 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 3.01692 (QuantReg: 7.52719) QuantErr: 7.52719 batch_time=0.53105 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 3.40255 (QuantReg: 7.01763) QuantErr: 7.01763 batch_time=0.51519 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 3.56079 (QuantReg: 7.10333) QuantErr: 7.10333 batch_time=0.60062 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 3.37247 (QuantReg: 7.28011) QuantErr: 7.28011 batch_time=0.51841 
Train Epoch: 10 codebook_update_time=1.81227
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch10.pth ...
Done in 7.062s
removing stale ckpt [epoch 9] [took 0.02s]
 epoch          : 10
 loss           : 3.3129789476394653
 quant_reg      : 7.0308165340423585
 quant_err      : 7.0308165340423585
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 56.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.517
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.1696140182992
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 41.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 37.381
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.21282104563246
 mnt_best       : 33.28020238027201
 not_improved_count: 1
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 3.20914 (QuantReg: 6.95418) QuantErr: 6.95418 batch_time=33.48198 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 3.55665 (QuantReg: 6.39429) QuantErr: 6.39429 batch_time=0.51135 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 3.41120 (QuantReg: 6.85001) QuantErr: 6.85001 batch_time=0.50877 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 3.42650 (QuantReg: 7.05592) QuantErr: 7.05592 batch_time=0.53990 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 3.28962 (QuantReg: 7.03101) QuantErr: 7.03101 batch_time=0.52462 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 3.62868 (QuantReg: 7.50763) QuantErr: 7.50763 batch_time=0.50910 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 3.13994 (QuantReg: 6.85125) QuantErr: 6.85125 batch_time=4.45121 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 3.29249 (QuantReg: 6.81768) QuantErr: 6.81768 batch_time=0.50694 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 3.19206 (QuantReg: 6.87482) QuantErr: 6.87482 batch_time=0.52164 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 3.43935 (QuantReg: 7.10592) QuantErr: 7.10592 batch_time=0.51185 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 2.98908 (QuantReg: 7.08011) QuantErr: 7.08011 batch_time=0.50032 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 3.07649 (QuantReg: 7.10711) QuantErr: 7.10711 batch_time=0.51255 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 3.21479 (QuantReg: 6.74666) QuantErr: 6.74666 batch_time=0.49638 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 3.08054 (QuantReg: 6.93082) QuantErr: 6.93082 batch_time=0.51478 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 3.16781 (QuantReg: 7.19581) QuantErr: 7.19581 batch_time=0.50871 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 3.38699 (QuantReg: 6.70138) QuantErr: 6.70138 batch_time=0.51626 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 3.15345 (QuantReg: 6.78534) QuantErr: 6.78534 batch_time=0.50673 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 3.24272 (QuantReg: 7.25403) QuantErr: 7.25403 batch_time=0.50944 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 3.25328 (QuantReg: 6.74006) QuantErr: 6.74006 batch_time=0.50513 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 3.10921 (QuantReg: 6.94169) QuantErr: 6.94169 batch_time=0.52400 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 3.15133 (QuantReg: 6.98879) QuantErr: 6.98879 batch_time=0.52565 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 3.10652 (QuantReg: 7.16563) QuantErr: 7.16563 batch_time=0.50828 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 3.24513 (QuantReg: 7.32199) QuantErr: 7.32199 batch_time=0.80168 
Train Epoch: 11 codebook_update_time=1.78177
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch11.pth ...
Done in 5.357s
removing stale ckpt [epoch 10] [took 0.01s]
 epoch          : 11
 loss           : 3.239279425621033
 quant_reg      : 6.971584667205811
 quant_err      : 6.971584667205811
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 14.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.681
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 32.97232144998274
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.9235
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.87505615704576
 mnt_best       : 33.28020238027201
 not_improved_count: 2
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 3.01485 (QuantReg: 6.63919) QuantErr: 6.63919 batch_time=33.55152 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 3.22794 (QuantReg: 6.70701) QuantErr: 6.70701 batch_time=0.51642 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 3.36400 (QuantReg: 7.07095) QuantErr: 7.07095 batch_time=1.23370 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 3.34435 (QuantReg: 6.96092) QuantErr: 6.96092 batch_time=0.50312 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 3.05006 (QuantReg: 6.76103) QuantErr: 6.76103 batch_time=0.50997 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 3.25594 (QuantReg: 6.98496) QuantErr: 6.98496 batch_time=0.52781 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 3.52095 (QuantReg: 7.13793) QuantErr: 7.13793 batch_time=0.74705 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 3.26830 (QuantReg: 6.35515) QuantErr: 6.35515 batch_time=0.53188 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 3.23822 (QuantReg: 7.00738) QuantErr: 7.00738 batch_time=0.51098 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 3.00116 (QuantReg: 6.91140) QuantErr: 6.91140 batch_time=0.52421 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 3.06002 (QuantReg: 7.14084) QuantErr: 7.14084 batch_time=0.52896 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 3.11324 (QuantReg: 7.15399) QuantErr: 7.15399 batch_time=0.52890 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 3.07877 (QuantReg: 6.77955) QuantErr: 6.77955 batch_time=0.51262 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 3.05713 (QuantReg: 6.58191) QuantErr: 6.58191 batch_time=0.51779 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 3.31143 (QuantReg: 7.37680) QuantErr: 7.37680 batch_time=0.53374 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 3.21629 (QuantReg: 7.03291) QuantErr: 7.03291 batch_time=0.56134 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 3.35466 (QuantReg: 7.05344) QuantErr: 7.05344 batch_time=0.50375 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 3.03964 (QuantReg: 6.96469) QuantErr: 6.96469 batch_time=0.49864 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 3.21304 (QuantReg: 6.74234) QuantErr: 6.74234 batch_time=0.51372 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 3.01539 (QuantReg: 6.96645) QuantErr: 6.96645 batch_time=0.51246 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 3.25743 (QuantReg: 7.27577) QuantErr: 7.27577 batch_time=0.51037 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 3.26618 (QuantReg: 7.17205) QuantErr: 7.17205 batch_time=0.51107 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 3.06202 (QuantReg: 7.11320) QuantErr: 7.11320 batch_time=0.53158 
Train Epoch: 12 codebook_update_time=1.83295
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch12.pth ...
Done in 25.663s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch12.pth ...
Done in 30.166s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 3.2003123331069947
 quant_reg      : 6.936793483734131
 quant_err      : 6.936793483734131
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.557
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.64483809759762
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.2435
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.347080551862305
 mnt_best       : 33.64483809759762
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 3.37718 (QuantReg: 6.79311) QuantErr: 6.79311 batch_time=32.62399 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 2.85897 (QuantReg: 7.23212) QuantErr: 7.23212 batch_time=0.50529 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 3.22837 (QuantReg: 6.55874) QuantErr: 6.55874 batch_time=0.51283 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 3.05378 (QuantReg: 6.92041) QuantErr: 6.92041 batch_time=0.49723 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 3.18072 (QuantReg: 6.96427) QuantErr: 6.96427 batch_time=0.49129 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 3.21817 (QuantReg: 6.64375) QuantErr: 6.64375 batch_time=0.51550 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 3.12469 (QuantReg: 6.98047) QuantErr: 6.98047 batch_time=0.55638 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 3.19676 (QuantReg: 7.06510) QuantErr: 7.06510 batch_time=0.53174 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 3.14908 (QuantReg: 7.26294) QuantErr: 7.26294 batch_time=0.50609 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 3.02152 (QuantReg: 6.88249) QuantErr: 6.88249 batch_time=0.52081 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 3.05353 (QuantReg: 7.19138) QuantErr: 7.19138 batch_time=0.66494 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 3.08051 (QuantReg: 7.38111) QuantErr: 7.38111 batch_time=0.54106 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 3.21022 (QuantReg: 6.92375) QuantErr: 6.92375 batch_time=0.54501 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 3.20004 (QuantReg: 7.01305) QuantErr: 7.01305 batch_time=5.27854 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 3.00726 (QuantReg: 6.88146) QuantErr: 6.88146 batch_time=0.51260 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 3.31194 (QuantReg: 6.94437) QuantErr: 6.94437 batch_time=0.50321 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 3.12383 (QuantReg: 7.05071) QuantErr: 7.05071 batch_time=0.52215 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 3.15613 (QuantReg: 6.76084) QuantErr: 6.76084 batch_time=0.51112 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 2.95129 (QuantReg: 7.13727) QuantErr: 7.13727 batch_time=0.51621 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 3.33615 (QuantReg: 7.09679) QuantErr: 7.09679 batch_time=0.51222 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 2.75537 (QuantReg: 6.90849) QuantErr: 6.90849 batch_time=0.55192 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 3.14764 (QuantReg: 6.80653) QuantErr: 6.80653 batch_time=0.49538 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 3.22779 (QuantReg: 6.82058) QuantErr: 6.82058 batch_time=0.52059 
Train Epoch: 13 codebook_update_time=1.82313
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch13.pth ...
Done in 4.727s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch13.pth ...
Done in 9.653s
removing stale ckpt [epoch 12] [took 0.01s]
 epoch          : 13
 loss           : 3.143215871810913
 quant_reg      : 6.952013240814209
 quant_err      : 6.952013240814209
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.098
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.69284835048767
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.411
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.653048288492
 mnt_best       : 33.69284835048767
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 3.10034 (QuantReg: 7.12100) QuantErr: 7.12100 batch_time=33.40425 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 2.85527 (QuantReg: 6.78726) QuantErr: 6.78726 batch_time=1.19486 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 3.19949 (QuantReg: 6.79755) QuantErr: 6.79755 batch_time=0.51525 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 3.04353 (QuantReg: 7.28233) QuantErr: 7.28233 batch_time=0.51151 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 2.88449 (QuantReg: 6.96367) QuantErr: 6.96367 batch_time=0.52998 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 3.35520 (QuantReg: 6.64213) QuantErr: 6.64213 batch_time=0.55038 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 3.27812 (QuantReg: 6.63042) QuantErr: 6.63042 batch_time=0.53127 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 3.09518 (QuantReg: 6.99877) QuantErr: 6.99877 batch_time=0.73764 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 2.89850 (QuantReg: 6.46109) QuantErr: 6.46109 batch_time=0.51983 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 2.91496 (QuantReg: 6.86912) QuantErr: 6.86912 batch_time=0.51300 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 3.29122 (QuantReg: 6.76457) QuantErr: 6.76457 batch_time=0.55413 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 2.80191 (QuantReg: 6.74225) QuantErr: 6.74225 batch_time=0.51844 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 3.00227 (QuantReg: 7.24475) QuantErr: 7.24475 batch_time=0.49729 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 3.05879 (QuantReg: 6.67765) QuantErr: 6.67765 batch_time=0.51133 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 3.00146 (QuantReg: 6.94500) QuantErr: 6.94500 batch_time=0.53378 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 3.33329 (QuantReg: 6.77485) QuantErr: 6.77485 batch_time=0.52196 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 3.07533 (QuantReg: 7.02362) QuantErr: 7.02362 batch_time=0.51385 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 3.28498 (QuantReg: 6.75783) QuantErr: 6.75783 batch_time=0.52583 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 3.18260 (QuantReg: 6.94094) QuantErr: 6.94094 batch_time=0.55315 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 3.16065 (QuantReg: 6.92604) QuantErr: 6.92604 batch_time=0.50195 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 3.23535 (QuantReg: 6.93281) QuantErr: 6.93281 batch_time=0.52313 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 3.04397 (QuantReg: 7.24716) QuantErr: 7.24716 batch_time=0.54442 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 2.81312 (QuantReg: 6.97534) QuantErr: 6.97534 batch_time=0.52667 
Train Epoch: 14 codebook_update_time=1.79512
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch14.pth ...
Done in 6.907s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch14.pth ...
Done in 12.327s
removing stale ckpt [epoch 13] [took 0.04s]
 epoch          : 14
 loss           : 3.0883258876800537
 quant_reg      : 6.897167345046997
 quant_err      : 6.897167345046997
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.541
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.84795574812987
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.6065
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.186819173793275
 mnt_best       : 33.84795574812987
 not_improved_count: 0
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 2.91195 (QuantReg: 6.90467) QuantErr: 6.90467 batch_time=29.81757 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 2.72922 (QuantReg: 6.98019) QuantErr: 6.98019 batch_time=0.88966 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 3.11417 (QuantReg: 6.92674) QuantErr: 6.92674 batch_time=0.51571 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 2.81557 (QuantReg: 6.61687) QuantErr: 6.61687 batch_time=0.53787 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 3.15738 (QuantReg: 6.74887) QuantErr: 6.74887 batch_time=0.52237 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 2.96615 (QuantReg: 6.98841) QuantErr: 6.98841 batch_time=0.51580 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 3.04589 (QuantReg: 7.38915) QuantErr: 7.38915 batch_time=0.49513 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 2.89299 (QuantReg: 6.61277) QuantErr: 6.61277 batch_time=0.53790 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 3.12048 (QuantReg: 6.92479) QuantErr: 6.92479 batch_time=0.52368 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 3.02828 (QuantReg: 6.55526) QuantErr: 6.55526 batch_time=0.52799 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 3.35949 (QuantReg: 7.17267) QuantErr: 7.17267 batch_time=0.51679 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 2.94360 (QuantReg: 7.14673) QuantErr: 7.14673 batch_time=0.49155 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 3.04906 (QuantReg: 6.86336) QuantErr: 6.86336 batch_time=0.51146 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 2.86442 (QuantReg: 6.85388) QuantErr: 6.85388 batch_time=0.52820 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 2.96902 (QuantReg: 6.99212) QuantErr: 6.99212 batch_time=0.50411 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 2.93123 (QuantReg: 6.80412) QuantErr: 6.80412 batch_time=0.50458 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 2.87849 (QuantReg: 6.91731) QuantErr: 6.91731 batch_time=0.51253 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 2.93384 (QuantReg: 6.79874) QuantErr: 6.79874 batch_time=0.51797 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 3.36147 (QuantReg: 6.87949) QuantErr: 6.87949 batch_time=0.51353 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 3.03620 (QuantReg: 7.08871) QuantErr: 7.08871 batch_time=0.50577 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 2.90520 (QuantReg: 6.90737) QuantErr: 6.90737 batch_time=0.52117 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 2.92617 (QuantReg: 7.18755) QuantErr: 7.18755 batch_time=0.55266 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 2.83905 (QuantReg: 6.93127) QuantErr: 6.93127 batch_time=0.51462 
Train Epoch: 15 codebook_update_time=1.85220
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch15.pth ...
Done in 5.178s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch15.pth ...
Done in 9.907s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 3.0278290615081787
 quant_reg      : 6.883938499450684
 quant_err      : 6.883938499450684
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 33.942
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.87007856863598
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 58.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.1225
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.50538150316447
 mnt_best       : 33.87007856863598
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 3.22680 (QuantReg: 6.76144) QuantErr: 6.76144 batch_time=31.22638 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 3.10617 (QuantReg: 6.62492) QuantErr: 6.62492 batch_time=0.51324 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 3.01008 (QuantReg: 6.92096) QuantErr: 6.92096 batch_time=1.28436 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 3.41099 (QuantReg: 6.67121) QuantErr: 6.67121 batch_time=0.51344 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 2.97284 (QuantReg: 7.05748) QuantErr: 7.05748 batch_time=0.55769 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 3.22566 (QuantReg: 7.26915) QuantErr: 7.26915 batch_time=0.52728 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 2.76348 (QuantReg: 6.83340) QuantErr: 6.83340 batch_time=2.34949 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 3.06597 (QuantReg: 6.57380) QuantErr: 6.57380 batch_time=0.51144 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 3.02015 (QuantReg: 7.07009) QuantErr: 7.07009 batch_time=0.50278 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 3.10977 (QuantReg: 7.06473) QuantErr: 7.06473 batch_time=0.51873 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 2.82934 (QuantReg: 6.79749) QuantErr: 6.79749 batch_time=0.51071 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 2.78289 (QuantReg: 6.73649) QuantErr: 6.73649 batch_time=0.51696 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 2.93314 (QuantReg: 6.84845) QuantErr: 6.84845 batch_time=0.50806 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 3.40845 (QuantReg: 7.04376) QuantErr: 7.04376 batch_time=1.99245 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 3.25622 (QuantReg: 6.76800) QuantErr: 6.76800 batch_time=0.51188 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 2.95782 (QuantReg: 6.87981) QuantErr: 6.87981 batch_time=0.50529 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 2.83050 (QuantReg: 7.06299) QuantErr: 7.06299 batch_time=0.51329 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 3.16526 (QuantReg: 6.72507) QuantErr: 6.72507 batch_time=0.58187 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 2.92092 (QuantReg: 6.64168) QuantErr: 6.64168 batch_time=0.52169 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 2.82068 (QuantReg: 7.19313) QuantErr: 7.19313 batch_time=0.51535 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 2.95458 (QuantReg: 6.94986) QuantErr: 6.94986 batch_time=0.50284 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 3.14744 (QuantReg: 6.65771) QuantErr: 6.65771 batch_time=0.57986 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 3.16273 (QuantReg: 7.05456) QuantErr: 7.05456 batch_time=0.52657 
Train Epoch: 16 codebook_update_time=1.72582
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch16.pth ...
Done in 4.702s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch16.pth ...
Done in 9.541s
removing stale ckpt [epoch 15] [took 0.01s]
 epoch          : 16
 loss           : 3.006816719055176
 quant_reg      : 6.871023414611816
 quant_err      : 6.871023414611816
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.9295
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.114020888069206
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.258
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.339392108450326
 mnt_best       : 34.114020888069206
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 2.81625 (QuantReg: 7.01766) QuantErr: 7.01766 batch_time=30.84253 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 3.02491 (QuantReg: 6.68846) QuantErr: 6.68846 batch_time=5.05287 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 2.73664 (QuantReg: 6.65548) QuantErr: 6.65548 batch_time=0.51794 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 3.19341 (QuantReg: 6.92401) QuantErr: 6.92401 batch_time=0.58757 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 2.98095 (QuantReg: 6.49658) QuantErr: 6.49658 batch_time=0.50797 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 3.19430 (QuantReg: 7.01073) QuantErr: 7.01073 batch_time=0.50837 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 3.13584 (QuantReg: 7.01363) QuantErr: 7.01363 batch_time=2.27778 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 2.70476 (QuantReg: 6.82582) QuantErr: 6.82582 batch_time=0.50248 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 2.97159 (QuantReg: 6.60636) QuantErr: 6.60636 batch_time=0.54857 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 3.21025 (QuantReg: 6.98959) QuantErr: 6.98959 batch_time=0.49570 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 3.15038 (QuantReg: 7.00864) QuantErr: 7.00864 batch_time=0.51486 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 2.91345 (QuantReg: 6.84889) QuantErr: 6.84889 batch_time=0.51209 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 3.13889 (QuantReg: 6.63216) QuantErr: 6.63216 batch_time=0.50634 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 3.14282 (QuantReg: 7.09276) QuantErr: 7.09276 batch_time=0.59450 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 3.17620 (QuantReg: 6.51013) QuantErr: 6.51013 batch_time=0.52045 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 2.88196 (QuantReg: 6.93620) QuantErr: 6.93620 batch_time=0.51044 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 3.29300 (QuantReg: 7.12457) QuantErr: 7.12457 batch_time=0.51267 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 2.80780 (QuantReg: 7.21634) QuantErr: 7.21634 batch_time=0.56060 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 2.94278 (QuantReg: 6.57120) QuantErr: 6.57120 batch_time=0.54498 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 2.76909 (QuantReg: 7.08401) QuantErr: 7.08401 batch_time=0.54921 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 2.88635 (QuantReg: 6.65954) QuantErr: 6.65954 batch_time=0.74749 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 3.01896 (QuantReg: 7.23598) QuantErr: 7.23598 batch_time=0.52800 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 2.78035 (QuantReg: 6.60602) QuantErr: 6.60602 batch_time=0.51231 
Train Epoch: 17 codebook_update_time=1.76523
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch17.pth ...
Done in 5.454s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch17.pth ...
Done in 10.805s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 2.9643670711517336
 quant_reg      : 6.903344284057617
 quant_err      : 6.903344284057617
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.122
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.65520412247051
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.51
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.93819432441713
 mnt_best       : 34.65520412247051
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 3.04325 (QuantReg: 6.75817) QuantErr: 6.75817 batch_time=33.55771 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 2.94647 (QuantReg: 6.61390) QuantErr: 6.61390 batch_time=0.51386 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 2.82956 (QuantReg: 6.69372) QuantErr: 6.69372 batch_time=0.53252 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 2.75711 (QuantReg: 6.83082) QuantErr: 6.83082 batch_time=0.55652 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 2.92192 (QuantReg: 6.71916) QuantErr: 6.71916 batch_time=0.50486 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 2.85192 (QuantReg: 7.13906) QuantErr: 7.13906 batch_time=0.53162 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 2.71564 (QuantReg: 7.12041) QuantErr: 7.12041 batch_time=0.51213 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 2.82030 (QuantReg: 6.98926) QuantErr: 6.98926 batch_time=0.53154 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 3.11645 (QuantReg: 7.09558) QuantErr: 7.09558 batch_time=0.51133 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 2.83613 (QuantReg: 6.66077) QuantErr: 6.66077 batch_time=0.53744 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 3.08718 (QuantReg: 6.67527) QuantErr: 6.67527 batch_time=0.55645 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 3.07752 (QuantReg: 6.93102) QuantErr: 6.93102 batch_time=0.51167 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 2.86399 (QuantReg: 6.83555) QuantErr: 6.83555 batch_time=0.50668 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 3.07167 (QuantReg: 7.00388) QuantErr: 7.00388 batch_time=2.67081 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 2.92670 (QuantReg: 6.52277) QuantErr: 6.52277 batch_time=0.51981 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 3.00026 (QuantReg: 7.05078) QuantErr: 7.05078 batch_time=0.51142 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 2.83574 (QuantReg: 6.51515) QuantErr: 6.51515 batch_time=0.56962 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 2.86510 (QuantReg: 6.88496) QuantErr: 6.88496 batch_time=0.51027 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 2.94692 (QuantReg: 7.00771) QuantErr: 7.00771 batch_time=0.56909 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 2.79350 (QuantReg: 6.87029) QuantErr: 6.87029 batch_time=2.08659 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 3.10792 (QuantReg: 6.56371) QuantErr: 6.56371 batch_time=0.58966 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 2.95883 (QuantReg: 6.96671) QuantErr: 6.96671 batch_time=0.51747 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 2.92395 (QuantReg: 6.87437) QuantErr: 6.87437 batch_time=0.51831 
Train Epoch: 18 codebook_update_time=2.11923
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch18.pth ...
Done in 5.363s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch18.pth ...
Done in 10.322s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 2.926634873390198
 quant_reg      : 6.891225193023682
 quant_err      : 6.891225193023682
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 33.067
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.85369012899472
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.3925
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.20423771724695
 mnt_best       : 35.85369012899472
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 2.93109 (QuantReg: 7.09022) QuantErr: 7.09022 batch_time=31.15749 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 2.75334 (QuantReg: 6.88160) QuantErr: 6.88160 batch_time=0.50868 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 3.06831 (QuantReg: 6.66698) QuantErr: 6.66698 batch_time=0.51234 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 3.11880 (QuantReg: 7.04509) QuantErr: 7.04509 batch_time=0.52142 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 2.89868 (QuantReg: 6.87422) QuantErr: 6.87422 batch_time=0.51299 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 2.79093 (QuantReg: 7.20234) QuantErr: 7.20234 batch_time=0.52266 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 2.61689 (QuantReg: 6.97545) QuantErr: 6.97545 batch_time=0.51399 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 2.84560 (QuantReg: 6.72297) QuantErr: 6.72297 batch_time=0.95428 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 2.69878 (QuantReg: 6.63540) QuantErr: 6.63540 batch_time=0.54153 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 2.87663 (QuantReg: 6.39129) QuantErr: 6.39129 batch_time=0.51488 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 2.81783 (QuantReg: 6.63494) QuantErr: 6.63494 batch_time=0.52366 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 2.83920 (QuantReg: 7.06076) QuantErr: 7.06076 batch_time=0.52160 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 3.01198 (QuantReg: 7.30746) QuantErr: 7.30746 batch_time=0.51883 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 2.97408 (QuantReg: 7.03889) QuantErr: 7.03889 batch_time=0.56537 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 3.15652 (QuantReg: 6.88818) QuantErr: 6.88818 batch_time=0.51521 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 2.45122 (QuantReg: 6.75204) QuantErr: 6.75204 batch_time=0.54288 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 2.89873 (QuantReg: 6.91830) QuantErr: 6.91830 batch_time=0.50834 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 2.85003 (QuantReg: 6.58664) QuantErr: 6.58664 batch_time=0.50512 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 2.81593 (QuantReg: 6.58558) QuantErr: 6.58558 batch_time=0.49480 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 2.80126 (QuantReg: 6.79658) QuantErr: 6.79658 batch_time=0.53523 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 3.14131 (QuantReg: 7.20835) QuantErr: 7.20835 batch_time=0.49842 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 2.97297 (QuantReg: 6.95053) QuantErr: 6.95053 batch_time=0.51221 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 2.85695 (QuantReg: 7.04283) QuantErr: 7.04283 batch_time=0.51742 
Train Epoch: 19 codebook_update_time=1.67104
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch19.pth ...
Done in 14.205s
removing stale ckpt [epoch 18] [took 0.02s]
 epoch          : 19
 loss           : 2.895226366043091
 quant_reg      : 6.868426816940308
 quant_err      : 6.868426816940308
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.467
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.616055007972484
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.2285
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.18689034885214
 mnt_best       : 35.85369012899472
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 2.52246 (QuantReg: 7.10097) QuantErr: 7.10097 batch_time=32.70677 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 2.86232 (QuantReg: 6.71757) QuantErr: 6.71757 batch_time=6.46000 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 2.87841 (QuantReg: 6.77724) QuantErr: 6.77724 batch_time=0.50824 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 2.65790 (QuantReg: 6.59831) QuantErr: 6.59831 batch_time=0.50221 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 3.11166 (QuantReg: 6.77092) QuantErr: 6.77092 batch_time=0.54189 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 2.77293 (QuantReg: 6.80322) QuantErr: 6.80322 batch_time=0.50910 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 2.61742 (QuantReg: 6.96367) QuantErr: 6.96367 batch_time=0.54894 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 3.12643 (QuantReg: 6.65895) QuantErr: 6.65895 batch_time=0.54913 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 3.07214 (QuantReg: 6.94721) QuantErr: 6.94721 batch_time=0.55577 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 2.64010 (QuantReg: 6.78278) QuantErr: 6.78278 batch_time=0.52857 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 2.83854 (QuantReg: 6.57986) QuantErr: 6.57986 batch_time=0.52856 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 2.94080 (QuantReg: 7.03723) QuantErr: 7.03723 batch_time=0.54632 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 2.85726 (QuantReg: 6.54259) QuantErr: 6.54259 batch_time=0.50967 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 2.72474 (QuantReg: 6.98192) QuantErr: 6.98192 batch_time=0.54955 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 2.87520 (QuantReg: 6.84838) QuantErr: 6.84838 batch_time=0.50316 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 3.10311 (QuantReg: 7.20641) QuantErr: 7.20641 batch_time=0.50379 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 2.86055 (QuantReg: 6.92423) QuantErr: 6.92423 batch_time=0.51426 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 2.73292 (QuantReg: 6.96857) QuantErr: 6.96857 batch_time=0.50203 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 2.92603 (QuantReg: 6.68945) QuantErr: 6.68945 batch_time=0.73654 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 2.84475 (QuantReg: 6.82259) QuantErr: 6.82259 batch_time=1.25046 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 2.97715 (QuantReg: 7.03433) QuantErr: 7.03433 batch_time=0.49965 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 2.95769 (QuantReg: 7.20247) QuantErr: 7.20247 batch_time=0.58179 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 2.81191 (QuantReg: 6.92087) QuantErr: 6.92087 batch_time=0.53161 
Train Epoch: 20 codebook_update_time=1.91437
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch20.pth ...
Done in 4.875s
removing stale ckpt [epoch 19] [took 0.04s]
 epoch          : 20
 loss           : 2.8825787658691406
 quant_reg      : 6.8746126289367675
 quant_err      : 6.8746126289367675
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 33.271
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.85389982753875
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.3565
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.95304990686166
 mnt_best       : 35.85369012899472
 not_improved_count: 2
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 2.93961 (QuantReg: 6.95381) QuantErr: 6.95381 batch_time=32.16546 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 2.84586 (QuantReg: 7.08982) QuantErr: 7.08982 batch_time=0.51948 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 3.13020 (QuantReg: 7.12612) QuantErr: 7.12612 batch_time=0.55656 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 3.11483 (QuantReg: 6.95613) QuantErr: 6.95613 batch_time=0.49501 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 2.71699 (QuantReg: 6.70131) QuantErr: 6.70131 batch_time=0.53695 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 2.82972 (QuantReg: 7.13337) QuantErr: 7.13337 batch_time=0.50828 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 3.35377 (QuantReg: 7.14272) QuantErr: 7.14272 batch_time=0.50626 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 2.92833 (QuantReg: 6.94158) QuantErr: 6.94158 batch_time=0.60315 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 2.83005 (QuantReg: 6.61733) QuantErr: 6.61733 batch_time=0.50776 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 2.76732 (QuantReg: 6.56681) QuantErr: 6.56681 batch_time=0.55966 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 2.68725 (QuantReg: 6.96854) QuantErr: 6.96854 batch_time=0.51981 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 2.63635 (QuantReg: 6.39762) QuantErr: 6.39762 batch_time=0.52024 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 2.92548 (QuantReg: 7.12544) QuantErr: 7.12544 batch_time=1.51734 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 2.59991 (QuantReg: 6.82957) QuantErr: 6.82957 batch_time=0.61668 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 2.93261 (QuantReg: 6.62954) QuantErr: 6.62954 batch_time=0.51574 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 2.86960 (QuantReg: 7.18305) QuantErr: 7.18305 batch_time=0.53274 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 2.91987 (QuantReg: 6.50879) QuantErr: 6.50879 batch_time=0.57488 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 2.68381 (QuantReg: 6.58694) QuantErr: 6.58694 batch_time=0.50752 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 2.89676 (QuantReg: 7.07268) QuantErr: 7.07268 batch_time=0.53570 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 2.93393 (QuantReg: 6.68173) QuantErr: 6.68173 batch_time=0.50583 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 2.89666 (QuantReg: 7.27834) QuantErr: 7.27834 batch_time=0.52665 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 2.80655 (QuantReg: 6.94568) QuantErr: 6.94568 batch_time=0.53371 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 3.12555 (QuantReg: 7.22217) QuantErr: 7.22217 batch_time=0.52040 
Train Epoch: 21 codebook_update_time=1.78799
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch21.pth ...
Done in 4.057s
removing stale ckpt [epoch 20] [took 0.01s]
 epoch          : 21
 loss           : 2.857798629760742
 quant_reg      : 6.9000439453125
 quant_err      : 6.9000439453125
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 33.421
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.33063117660702
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.75
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 32.6415
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.84598996687893
 mnt_best       : 35.85369012899472
 not_improved_count: 3
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 3.01225 (QuantReg: 6.79869) QuantErr: 6.79869 batch_time=34.47942 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 2.69768 (QuantReg: 7.18020) QuantErr: 7.18020 batch_time=0.52591 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 2.87534 (QuantReg: 6.92258) QuantErr: 6.92258 batch_time=0.54963 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 3.03732 (QuantReg: 6.91583) QuantErr: 6.91583 batch_time=0.50200 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 3.33734 (QuantReg: 7.19112) QuantErr: 7.19112 batch_time=0.53437 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 2.76584 (QuantReg: 6.77272) QuantErr: 6.77272 batch_time=0.50712 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 3.19287 (QuantReg: 7.13163) QuantErr: 7.13163 batch_time=0.52766 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 2.67768 (QuantReg: 6.93317) QuantErr: 6.93317 batch_time=0.51548 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 2.99017 (QuantReg: 6.97779) QuantErr: 6.97779 batch_time=0.56643 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 2.85468 (QuantReg: 6.78373) QuantErr: 6.78373 batch_time=0.50776 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 2.80503 (QuantReg: 7.09216) QuantErr: 7.09216 batch_time=0.53449 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 2.78293 (QuantReg: 6.71428) QuantErr: 6.71428 batch_time=0.51375 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 2.62555 (QuantReg: 6.66942) QuantErr: 6.66942 batch_time=0.50713 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 2.97930 (QuantReg: 7.11931) QuantErr: 7.11931 batch_time=0.53936 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 2.53670 (QuantReg: 6.64362) QuantErr: 6.64362 batch_time=0.51857 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 3.18030 (QuantReg: 6.95499) QuantErr: 6.95499 batch_time=0.75268 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 2.77416 (QuantReg: 7.02176) QuantErr: 7.02176 batch_time=0.53684 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 2.54192 (QuantReg: 6.93417) QuantErr: 6.93417 batch_time=0.52169 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 2.67678 (QuantReg: 6.82480) QuantErr: 6.82480 batch_time=0.54818 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 2.73709 (QuantReg: 6.90387) QuantErr: 6.90387 batch_time=0.50925 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 3.03287 (QuantReg: 7.00044) QuantErr: 7.00044 batch_time=0.50775 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 2.60605 (QuantReg: 6.93578) QuantErr: 6.93578 batch_time=0.51666 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 2.86925 (QuantReg: 7.10567) QuantErr: 7.10567 batch_time=0.53852 
Train Epoch: 22 codebook_update_time=1.79030
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch22.pth ...
Done in 5.162s
removing stale ckpt [epoch 21] [took 0.02s]
 epoch          : 22
 loss           : 2.827703448295593
 quant_reg      : 6.921598609924317
 quant_err      : 6.921598609924317
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.023
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.14918632405465
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.334
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.87456344291046
 mnt_best       : 35.85369012899472
 not_improved_count: 4
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 2.71844 (QuantReg: 7.02291) QuantErr: 7.02291 batch_time=34.35882 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 2.53552 (QuantReg: 6.90474) QuantErr: 6.90474 batch_time=0.57457 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 3.14179 (QuantReg: 7.07103) QuantErr: 7.07103 batch_time=0.50439 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 2.88974 (QuantReg: 6.67728) QuantErr: 6.67728 batch_time=0.54796 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 2.74047 (QuantReg: 6.53411) QuantErr: 6.53411 batch_time=0.55403 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 2.82264 (QuantReg: 6.77302) QuantErr: 6.77302 batch_time=0.50741 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 2.75181 (QuantReg: 6.64033) QuantErr: 6.64033 batch_time=0.50674 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 2.73324 (QuantReg: 6.53043) QuantErr: 6.53043 batch_time=0.52049 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 2.83123 (QuantReg: 6.91379) QuantErr: 6.91379 batch_time=0.50864 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 3.01114 (QuantReg: 6.74266) QuantErr: 6.74266 batch_time=0.54620 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 2.69795 (QuantReg: 6.64232) QuantErr: 6.64232 batch_time=0.50540 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 2.79657 (QuantReg: 6.62758) QuantErr: 6.62758 batch_time=0.52112 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 2.83767 (QuantReg: 7.09629) QuantErr: 7.09629 batch_time=0.54426 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 2.56940 (QuantReg: 6.81246) QuantErr: 6.81246 batch_time=0.51897 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 3.01064 (QuantReg: 6.70091) QuantErr: 6.70091 batch_time=0.58211 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 2.94246 (QuantReg: 6.76254) QuantErr: 6.76254 batch_time=0.50615 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 2.76258 (QuantReg: 6.99205) QuantErr: 6.99205 batch_time=0.50386 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 2.64118 (QuantReg: 7.11473) QuantErr: 7.11473 batch_time=0.55257 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 2.66761 (QuantReg: 6.89411) QuantErr: 6.89411 batch_time=0.50369 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 2.77672 (QuantReg: 6.94611) QuantErr: 6.94611 batch_time=0.50320 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 2.79053 (QuantReg: 6.85477) QuantErr: 6.85477 batch_time=0.50236 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 2.71718 (QuantReg: 7.09274) QuantErr: 7.09274 batch_time=0.73752 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 2.79840 (QuantReg: 6.93485) QuantErr: 6.93485 batch_time=0.50456 
Train Epoch: 23 codebook_update_time=1.81052
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch23.pth ...
Done in 6.544s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 2.795336100578308
 quant_reg      : 6.9051681308746335
 quant_err      : 6.9051681308746335
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.472
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.15623488591944
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.318
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.62673452551704
 mnt_best       : 35.85369012899472
 not_improved_count: 5
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 2.84489 (QuantReg: 6.81169) QuantErr: 6.81169 batch_time=34.87508 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 2.55821 (QuantReg: 6.84856) QuantErr: 6.84856 batch_time=0.51219 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 2.85274 (QuantReg: 6.69379) QuantErr: 6.69379 batch_time=0.50894 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 2.64328 (QuantReg: 6.83364) QuantErr: 6.83364 batch_time=0.53982 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 2.96084 (QuantReg: 6.61392) QuantErr: 6.61392 batch_time=0.54068 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 2.66801 (QuantReg: 7.16046) QuantErr: 7.16046 batch_time=0.55463 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 2.76910 (QuantReg: 6.63527) QuantErr: 6.63527 batch_time=0.53898 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 2.82302 (QuantReg: 7.03785) QuantErr: 7.03785 batch_time=0.88037 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 2.84900 (QuantReg: 6.96043) QuantErr: 6.96043 batch_time=0.51971 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 2.74059 (QuantReg: 6.81715) QuantErr: 6.81715 batch_time=0.49122 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 2.88872 (QuantReg: 6.88952) QuantErr: 6.88952 batch_time=0.50914 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 2.80062 (QuantReg: 6.88889) QuantErr: 6.88889 batch_time=0.52606 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 2.62493 (QuantReg: 6.82635) QuantErr: 6.82635 batch_time=0.52668 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 2.45763 (QuantReg: 6.65044) QuantErr: 6.65044 batch_time=0.56152 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 2.72713 (QuantReg: 7.02126) QuantErr: 7.02126 batch_time=0.51066 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 3.08345 (QuantReg: 6.98310) QuantErr: 6.98310 batch_time=0.51656 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 2.51516 (QuantReg: 7.13794) QuantErr: 7.13794 batch_time=0.51118 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 2.98988 (QuantReg: 7.13828) QuantErr: 7.13828 batch_time=0.50068 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 2.78094 (QuantReg: 6.91710) QuantErr: 6.91710 batch_time=0.51544 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 2.48805 (QuantReg: 6.77795) QuantErr: 6.77795 batch_time=0.52183 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 2.82859 (QuantReg: 7.28298) QuantErr: 7.28298 batch_time=0.50831 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 2.63217 (QuantReg: 6.90710) QuantErr: 6.90710 batch_time=0.51856 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 2.58753 (QuantReg: 6.94547) QuantErr: 6.94547 batch_time=0.50912 
Train Epoch: 24 codebook_update_time=1.96629
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch24.pth ...
Done in 5.152s
removing stale ckpt [epoch 23] [took 0.03s]
 epoch          : 24
 loss           : 2.77455739402771
 quant_reg      : 6.937149452209472
 quant_err      : 6.937149452209472
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.767
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.036557720303655
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.0465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.78121756958927
 mnt_best       : 35.85369012899472
 not_improved_count: 6
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 2.65906 (QuantReg: 6.63747) QuantErr: 6.63747 batch_time=35.11594 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 2.49686 (QuantReg: 6.63825) QuantErr: 6.63825 batch_time=0.50516 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 2.82703 (QuantReg: 7.15823) QuantErr: 7.15823 batch_time=0.50301 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 2.71287 (QuantReg: 6.86983) QuantErr: 6.86983 batch_time=0.52886 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 2.59446 (QuantReg: 7.12360) QuantErr: 7.12360 batch_time=0.62432 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 2.47597 (QuantReg: 7.06778) QuantErr: 7.06778 batch_time=0.50572 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 3.12959 (QuantReg: 7.14345) QuantErr: 7.14345 batch_time=1.38441 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 2.99992 (QuantReg: 6.87851) QuantErr: 6.87851 batch_time=0.50236 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 2.82701 (QuantReg: 7.03628) QuantErr: 7.03628 batch_time=0.52011 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 2.69264 (QuantReg: 6.78218) QuantErr: 6.78218 batch_time=0.53603 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 2.91630 (QuantReg: 7.18512) QuantErr: 7.18512 batch_time=0.52141 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 3.11251 (QuantReg: 6.87838) QuantErr: 6.87838 batch_time=0.49860 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 2.45956 (QuantReg: 6.48662) QuantErr: 6.48662 batch_time=2.14713 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 2.49540 (QuantReg: 6.93217) QuantErr: 6.93217 batch_time=0.50181 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 2.57552 (QuantReg: 6.69025) QuantErr: 6.69025 batch_time=0.51131 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 2.89842 (QuantReg: 6.70765) QuantErr: 6.70765 batch_time=0.50563 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 2.77598 (QuantReg: 7.09603) QuantErr: 7.09603 batch_time=0.54854 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 2.50985 (QuantReg: 7.04123) QuantErr: 7.04123 batch_time=0.51960 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 2.55951 (QuantReg: 6.94951) QuantErr: 6.94951 batch_time=2.24825 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 2.64184 (QuantReg: 6.85149) QuantErr: 6.85149 batch_time=0.51009 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 2.96952 (QuantReg: 7.15246) QuantErr: 7.15246 batch_time=0.73757 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 2.61397 (QuantReg: 7.03255) QuantErr: 7.03255 batch_time=0.52495 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 2.51283 (QuantReg: 7.04098) QuantErr: 7.04098 batch_time=0.52677 
Train Epoch: 25 codebook_update_time=1.71218
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch25.pth ...
Done in 5.359s
removing stale ckpt [epoch 24] [took 0.01s]
 epoch          : 25
 loss           : 2.754665358543396
 quant_reg      : 6.9450892658233645
 quant_err      : 6.9450892658233645
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.711
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.55095683530975
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.819
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.02882875965101
 mnt_best       : 35.85369012899472
 not_improved_count: 7
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 2.81919 (QuantReg: 6.66562) QuantErr: 6.66562 batch_time=40.69106 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 2.67805 (QuantReg: 6.71748) QuantErr: 6.71748 batch_time=0.58797 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 2.77312 (QuantReg: 7.01728) QuantErr: 7.01728 batch_time=0.51347 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 2.94286 (QuantReg: 7.15547) QuantErr: 7.15547 batch_time=0.51485 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 2.88896 (QuantReg: 6.96131) QuantErr: 6.96131 batch_time=0.51239 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 2.62706 (QuantReg: 7.11385) QuantErr: 7.11385 batch_time=0.55163 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 2.34437 (QuantReg: 7.10332) QuantErr: 7.10332 batch_time=1.45342 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 2.83321 (QuantReg: 6.97798) QuantErr: 6.97798 batch_time=0.50911 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 2.75610 (QuantReg: 6.70291) QuantErr: 6.70291 batch_time=0.50580 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 2.60731 (QuantReg: 7.01882) QuantErr: 7.01882 batch_time=0.53122 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 2.66307 (QuantReg: 7.23700) QuantErr: 7.23700 batch_time=0.50927 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 2.63782 (QuantReg: 6.81722) QuantErr: 6.81722 batch_time=0.56836 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 2.62306 (QuantReg: 6.95278) QuantErr: 6.95278 batch_time=0.52085 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 2.88847 (QuantReg: 6.38796) QuantErr: 6.38796 batch_time=0.49680 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 2.92380 (QuantReg: 7.05350) QuantErr: 7.05350 batch_time=0.51996 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 2.70456 (QuantReg: 7.23659) QuantErr: 7.23659 batch_time=0.49914 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 2.73898 (QuantReg: 7.21529) QuantErr: 7.21529 batch_time=0.49840 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 2.93492 (QuantReg: 6.96739) QuantErr: 6.96739 batch_time=0.49813 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 2.65365 (QuantReg: 6.36015) QuantErr: 6.36015 batch_time=0.54118 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 2.86727 (QuantReg: 7.13636) QuantErr: 7.13636 batch_time=0.49242 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 2.74206 (QuantReg: 7.14318) QuantErr: 7.14318 batch_time=0.76812 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 2.88336 (QuantReg: 7.29551) QuantErr: 7.29551 batch_time=0.52256 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 2.95293 (QuantReg: 7.17991) QuantErr: 7.17991 batch_time=0.51685 
Train Epoch: 26 codebook_update_time=1.73960
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch26.pth ...
Done in 5.924s
removing stale ckpt [epoch 25] [took 0.05s]
 epoch          : 26
 loss           : 2.7664517288208006
 quant_reg      : 6.948668392181396
 quant_err      : 6.948668392181396
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.317
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.22189097592323
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.3465
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.97324246266734
 mnt_best       : 35.85369012899472
 not_improved_count: 8
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 2.73408 (QuantReg: 7.06412) QuantErr: 7.06412 batch_time=33.34395 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 2.73190 (QuantReg: 6.78320) QuantErr: 6.78320 batch_time=0.52082 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 2.69686 (QuantReg: 6.87422) QuantErr: 6.87422 batch_time=0.52508 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 2.68540 (QuantReg: 6.92254) QuantErr: 6.92254 batch_time=0.56766 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 2.72153 (QuantReg: 7.00000) QuantErr: 7.00000 batch_time=0.52558 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 2.59311 (QuantReg: 6.94254) QuantErr: 6.94254 batch_time=0.50984 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 2.71376 (QuantReg: 7.27068) QuantErr: 7.27068 batch_time=2.77614 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 2.70471 (QuantReg: 7.06460) QuantErr: 7.06460 batch_time=0.50730 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 2.94423 (QuantReg: 7.00755) QuantErr: 7.00755 batch_time=0.51075 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 2.81565 (QuantReg: 7.39832) QuantErr: 7.39832 batch_time=0.56580 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 2.81921 (QuantReg: 7.30750) QuantErr: 7.30750 batch_time=0.52536 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 2.59378 (QuantReg: 6.71870) QuantErr: 6.71870 batch_time=0.50081 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 2.61391 (QuantReg: 7.16246) QuantErr: 7.16246 batch_time=0.50503 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 2.73084 (QuantReg: 7.02360) QuantErr: 7.02360 batch_time=0.57769 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 2.74663 (QuantReg: 7.08647) QuantErr: 7.08647 batch_time=0.54835 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 2.92192 (QuantReg: 6.95271) QuantErr: 6.95271 batch_time=0.52723 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 2.70351 (QuantReg: 6.91277) QuantErr: 6.91277 batch_time=0.62175 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 2.62001 (QuantReg: 7.19059) QuantErr: 7.19059 batch_time=0.50125 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 2.77515 (QuantReg: 6.87256) QuantErr: 6.87256 batch_time=0.53484 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 2.87043 (QuantReg: 7.14913) QuantErr: 7.14913 batch_time=0.51799 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 2.70099 (QuantReg: 6.96859) QuantErr: 6.96859 batch_time=0.50746 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 2.92839 (QuantReg: 6.71088) QuantErr: 6.71088 batch_time=1.96779 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 2.56041 (QuantReg: 6.92374) QuantErr: 6.92374 batch_time=0.49945 
Train Epoch: 27 codebook_update_time=1.72307
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch27.pth ...
Done in 4.248s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch27.pth ...
Done in 8.835s
removing stale ckpt [epoch 26] [took 0.01s]
 epoch          : 27
 loss           : 2.746368847846985
 quant_reg      : 6.992371559143066
 quant_err      : 6.992371559143066
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.591
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.98569390410879
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 44.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.3335
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.5798216179042
 mnt_best       : 35.98569390410879
 not_improved_count: 0
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 2.44216 (QuantReg: 6.61301) QuantErr: 6.61301 batch_time=30.30174 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 2.79389 (QuantReg: 7.31241) QuantErr: 7.31241 batch_time=0.51467 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 2.38675 (QuantReg: 6.70437) QuantErr: 6.70437 batch_time=0.57245 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 2.61518 (QuantReg: 7.06560) QuantErr: 7.06560 batch_time=0.55154 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 2.50996 (QuantReg: 7.11487) QuantErr: 7.11487 batch_time=0.50006 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 2.62124 (QuantReg: 6.99109) QuantErr: 6.99109 batch_time=0.51459 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 2.82281 (QuantReg: 6.99168) QuantErr: 6.99168 batch_time=2.17517 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 2.80225 (QuantReg: 7.06578) QuantErr: 7.06578 batch_time=0.50711 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 3.15660 (QuantReg: 7.05122) QuantErr: 7.05122 batch_time=0.50592 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 2.79635 (QuantReg: 7.01205) QuantErr: 7.01205 batch_time=0.55901 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 2.79353 (QuantReg: 7.19853) QuantErr: 7.19853 batch_time=0.53433 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 2.44897 (QuantReg: 6.85651) QuantErr: 6.85651 batch_time=0.50848 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 2.91426 (QuantReg: 7.08189) QuantErr: 7.08189 batch_time=0.50260 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 2.81419 (QuantReg: 6.85508) QuantErr: 6.85508 batch_time=0.51469 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 2.69698 (QuantReg: 7.10003) QuantErr: 7.10003 batch_time=0.52866 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 2.74902 (QuantReg: 7.30578) QuantErr: 7.30578 batch_time=0.52214 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 2.85476 (QuantReg: 7.04482) QuantErr: 7.04482 batch_time=0.88466 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 2.75139 (QuantReg: 7.41242) QuantErr: 7.41242 batch_time=0.51081 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 2.85071 (QuantReg: 6.85747) QuantErr: 6.85747 batch_time=0.51906 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 2.40779 (QuantReg: 6.90925) QuantErr: 6.90925 batch_time=0.50669 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 2.64051 (QuantReg: 6.97243) QuantErr: 6.97243 batch_time=0.50472 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 2.79052 (QuantReg: 7.02510) QuantErr: 7.02510 batch_time=0.51389 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 2.90478 (QuantReg: 7.23420) QuantErr: 7.23420 batch_time=0.52628 
Train Epoch: 28 codebook_update_time=1.75979
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch28.pth ...
Done in 5.067s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 28
 loss           : 2.7207206783294677
 quant_reg      : 6.997800554275512
 quant_err      : 6.997800554275512
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.8695
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.32825222611276
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.8685
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.964626261242955
 mnt_best       : 35.98569390410879
 not_improved_count: 1
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 3.23228 (QuantReg: 6.97693) QuantErr: 6.97693 batch_time=31.76270 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 2.90621 (QuantReg: 7.10854) QuantErr: 7.10854 batch_time=0.50215 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 2.87349 (QuantReg: 7.34488) QuantErr: 7.34488 batch_time=1.80785 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 2.78664 (QuantReg: 6.95606) QuantErr: 6.95606 batch_time=0.57427 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 2.91701 (QuantReg: 7.05404) QuantErr: 7.05404 batch_time=0.52170 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 2.50574 (QuantReg: 7.11304) QuantErr: 7.11304 batch_time=0.58777 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 2.56768 (QuantReg: 6.82066) QuantErr: 6.82066 batch_time=1.34065 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 2.66026 (QuantReg: 7.32437) QuantErr: 7.32437 batch_time=0.52723 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 2.70131 (QuantReg: 6.90954) QuantErr: 6.90954 batch_time=0.51389 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 2.77763 (QuantReg: 7.05071) QuantErr: 7.05071 batch_time=0.55208 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 3.16394 (QuantReg: 6.96901) QuantErr: 6.96901 batch_time=0.56602 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 2.84138 (QuantReg: 6.93752) QuantErr: 6.93752 batch_time=0.55282 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 2.77171 (QuantReg: 7.03395) QuantErr: 7.03395 batch_time=0.64189 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 2.52856 (QuantReg: 7.03351) QuantErr: 7.03351 batch_time=1.13316 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 2.64617 (QuantReg: 7.38298) QuantErr: 7.38298 batch_time=0.51136 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 2.64748 (QuantReg: 7.07503) QuantErr: 7.07503 batch_time=0.52244 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 2.76746 (QuantReg: 7.14788) QuantErr: 7.14788 batch_time=0.51453 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 2.83021 (QuantReg: 7.15897) QuantErr: 7.15897 batch_time=0.53734 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 2.82056 (QuantReg: 6.62237) QuantErr: 6.62237 batch_time=0.53287 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 2.61374 (QuantReg: 7.01681) QuantErr: 7.01681 batch_time=0.53765 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 2.81550 (QuantReg: 6.84992) QuantErr: 6.84992 batch_time=0.53647 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 2.40514 (QuantReg: 7.01798) QuantErr: 7.01798 batch_time=0.51010 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 2.84258 (QuantReg: 7.00729) QuantErr: 7.00729 batch_time=0.51044 
Train Epoch: 29 codebook_update_time=1.81691
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch29.pth ...
Done in 4.250s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 2.706496437072754
 quant_reg      : 6.966790294647216
 quant_err      : 6.966790294647216
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.138
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.84396977678053
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.458
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.15050570429807
 mnt_best       : 35.98569390410879
 not_improved_count: 2
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 2.74911 (QuantReg: 6.96511) QuantErr: 6.96511 batch_time=34.83890 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 2.58235 (QuantReg: 6.68668) QuantErr: 6.68668 batch_time=4.13922 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 2.68024 (QuantReg: 6.85113) QuantErr: 6.85113 batch_time=0.50028 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 2.70032 (QuantReg: 6.97711) QuantErr: 6.97711 batch_time=0.51431 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 2.70445 (QuantReg: 7.01692) QuantErr: 7.01692 batch_time=0.50247 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 2.67073 (QuantReg: 6.94624) QuantErr: 6.94624 batch_time=0.53028 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 2.87464 (QuantReg: 7.16123) QuantErr: 7.16123 batch_time=0.54481 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 2.65471 (QuantReg: 7.33921) QuantErr: 7.33921 batch_time=0.55018 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 2.67247 (QuantReg: 6.79838) QuantErr: 6.79838 batch_time=0.55603 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 2.81669 (QuantReg: 7.09036) QuantErr: 7.09036 batch_time=0.50305 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 2.60554 (QuantReg: 7.10060) QuantErr: 7.10060 batch_time=0.54140 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 2.53091 (QuantReg: 6.89033) QuantErr: 6.89033 batch_time=0.54373 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 2.41239 (QuantReg: 6.98135) QuantErr: 6.98135 batch_time=0.51583 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 2.92532 (QuantReg: 7.33541) QuantErr: 7.33541 batch_time=0.54841 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 2.73969 (QuantReg: 6.85345) QuantErr: 6.85345 batch_time=0.50807 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 2.54800 (QuantReg: 6.94605) QuantErr: 6.94605 batch_time=0.53829 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 2.66916 (QuantReg: 6.52947) QuantErr: 6.52947 batch_time=0.50618 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 2.86003 (QuantReg: 6.83402) QuantErr: 6.83402 batch_time=0.50962 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 2.60748 (QuantReg: 6.93984) QuantErr: 6.93984 batch_time=0.57076 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 2.95817 (QuantReg: 6.81930) QuantErr: 6.81930 batch_time=0.55344 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 2.73445 (QuantReg: 7.03124) QuantErr: 7.03124 batch_time=0.50394 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 2.52397 (QuantReg: 6.96647) QuantErr: 6.96647 batch_time=0.49694 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 2.69610 (QuantReg: 7.25373) QuantErr: 7.25373 batch_time=0.55442 
Train Epoch: 30 codebook_update_time=1.89158
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch30.pth ...
Done in 13.190s
removing stale ckpt [epoch 29] [took 0.02s]
 epoch          : 30
 loss           : 2.705440462112427
 quant_reg      : 6.995270908355713
 quant_err      : 6.995270908355713
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.5925
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.41850033658789
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.861
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.77642299765058
 mnt_best       : 35.98569390410879
 not_improved_count: 3
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 2.94727 (QuantReg: 6.83374) QuantErr: 6.83374 batch_time=32.87349 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 2.63848 (QuantReg: 6.75988) QuantErr: 6.75988 batch_time=0.52340 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 2.41909 (QuantReg: 6.83421) QuantErr: 6.83421 batch_time=0.50921 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 2.80251 (QuantReg: 6.86100) QuantErr: 6.86100 batch_time=0.51134 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 2.57600 (QuantReg: 6.93449) QuantErr: 6.93449 batch_time=0.52143 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 2.72688 (QuantReg: 7.03210) QuantErr: 7.03210 batch_time=0.50792 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 2.78031 (QuantReg: 6.99303) QuantErr: 6.99303 batch_time=1.06057 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 2.43975 (QuantReg: 7.06418) QuantErr: 7.06418 batch_time=0.51186 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 2.65456 (QuantReg: 6.99274) QuantErr: 6.99274 batch_time=3.18366 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 2.60620 (QuantReg: 7.04484) QuantErr: 7.04484 batch_time=0.52499 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 2.89657 (QuantReg: 7.21778) QuantErr: 7.21778 batch_time=0.53460 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 2.47115 (QuantReg: 6.98010) QuantErr: 6.98010 batch_time=0.51033 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 2.39355 (QuantReg: 7.05867) QuantErr: 7.05867 batch_time=3.95051 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 2.77821 (QuantReg: 6.80143) QuantErr: 6.80143 batch_time=0.52993 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 2.71604 (QuantReg: 6.99752) QuantErr: 6.99752 batch_time=0.51275 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 2.60431 (QuantReg: 7.17375) QuantErr: 7.17375 batch_time=0.51511 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 2.59248 (QuantReg: 7.33141) QuantErr: 7.33141 batch_time=0.54345 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 2.67942 (QuantReg: 6.91873) QuantErr: 6.91873 batch_time=0.56942 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 2.59098 (QuantReg: 6.80787) QuantErr: 6.80787 batch_time=0.49748 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 2.66492 (QuantReg: 6.97096) QuantErr: 6.97096 batch_time=0.50693 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 2.66526 (QuantReg: 6.89140) QuantErr: 6.89140 batch_time=0.57808 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 2.46738 (QuantReg: 6.95786) QuantErr: 6.95786 batch_time=0.51494 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 2.75712 (QuantReg: 6.64526) QuantErr: 6.64526 batch_time=0.52226 
Train Epoch: 31 codebook_update_time=1.93717
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch31.pth ...
Done in 5.119s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 31
 loss           : 2.703782278060913
 quant_reg      : 7.059186634063721
 quant_err      : 7.059186634063721
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.2145
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.835139701018804
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.971
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.03147247762511
 mnt_best       : 35.98569390410879
 not_improved_count: 4
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 2.61655 (QuantReg: 7.01504) QuantErr: 7.01504 batch_time=34.00372 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 2.60130 (QuantReg: 7.10868) QuantErr: 7.10868 batch_time=0.52264 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 2.89333 (QuantReg: 7.05487) QuantErr: 7.05487 batch_time=0.51294 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 2.59259 (QuantReg: 6.80666) QuantErr: 6.80666 batch_time=0.50816 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 2.60766 (QuantReg: 7.28766) QuantErr: 7.28766 batch_time=0.51487 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 2.43413 (QuantReg: 7.04918) QuantErr: 7.04918 batch_time=0.53321 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 2.59749 (QuantReg: 7.05965) QuantErr: 7.05965 batch_time=0.50018 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 2.89727 (QuantReg: 7.24514) QuantErr: 7.24514 batch_time=0.62135 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 2.58342 (QuantReg: 7.25347) QuantErr: 7.25347 batch_time=0.50454 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 2.83714 (QuantReg: 6.88506) QuantErr: 6.88506 batch_time=0.51620 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 2.81780 (QuantReg: 6.90789) QuantErr: 6.90789 batch_time=0.51030 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 2.71873 (QuantReg: 6.85990) QuantErr: 6.85990 batch_time=0.51091 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 3.01273 (QuantReg: 7.33133) QuantErr: 7.33133 batch_time=0.52138 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 2.60363 (QuantReg: 7.17614) QuantErr: 7.17614 batch_time=0.53458 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 2.86668 (QuantReg: 7.02592) QuantErr: 7.02592 batch_time=1.32665 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 2.77007 (QuantReg: 6.96338) QuantErr: 6.96338 batch_time=0.50323 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 2.66020 (QuantReg: 6.84861) QuantErr: 6.84861 batch_time=0.50357 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 2.40692 (QuantReg: 7.02558) QuantErr: 7.02558 batch_time=0.50514 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 2.89569 (QuantReg: 7.13932) QuantErr: 7.13932 batch_time=0.53073 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 2.58398 (QuantReg: 6.94619) QuantErr: 6.94619 batch_time=0.52792 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 2.73368 (QuantReg: 7.16442) QuantErr: 7.16442 batch_time=0.51437 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 2.37605 (QuantReg: 6.79655) QuantErr: 6.79655 batch_time=0.60809 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 2.89724 (QuantReg: 6.94639) QuantErr: 6.94639 batch_time=0.53773 
Train Epoch: 32 codebook_update_time=1.79371
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch32.pth ...
Done in 4.631s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch32.pth ...
Done in 9.016s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 2.6896471061706544
 quant_reg      : 7.053550266265869
 quant_err      : 7.053550266265869
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.581
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.194039697143445
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.1525
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.82353456007775
 mnt_best       : 36.194039697143445
 not_improved_count: 0
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 2.75073 (QuantReg: 7.03202) QuantErr: 7.03202 batch_time=30.68194 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 2.83003 (QuantReg: 7.06151) QuantErr: 7.06151 batch_time=0.51196 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 2.76784 (QuantReg: 6.97562) QuantErr: 6.97562 batch_time=0.97615 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 2.79279 (QuantReg: 7.11369) QuantErr: 7.11369 batch_time=0.50963 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 2.93655 (QuantReg: 6.87389) QuantErr: 6.87389 batch_time=0.56067 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 2.74950 (QuantReg: 7.04140) QuantErr: 7.04140 batch_time=0.53049 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 2.31604 (QuantReg: 6.60564) QuantErr: 6.60564 batch_time=0.51912 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 2.70665 (QuantReg: 7.07924) QuantErr: 7.07924 batch_time=0.81877 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 2.70945 (QuantReg: 7.08085) QuantErr: 7.08085 batch_time=0.57072 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 2.66695 (QuantReg: 7.00427) QuantErr: 7.00427 batch_time=0.51300 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 2.70912 (QuantReg: 7.01799) QuantErr: 7.01799 batch_time=0.64047 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 2.74093 (QuantReg: 7.18107) QuantErr: 7.18107 batch_time=0.52746 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 2.64857 (QuantReg: 7.11442) QuantErr: 7.11442 batch_time=0.51688 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 2.53183 (QuantReg: 6.98611) QuantErr: 6.98611 batch_time=0.51654 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 2.63588 (QuantReg: 7.26601) QuantErr: 7.26601 batch_time=0.51739 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 2.53830 (QuantReg: 7.56381) QuantErr: 7.56381 batch_time=0.51577 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 2.49860 (QuantReg: 6.83314) QuantErr: 6.83314 batch_time=0.50805 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 2.94669 (QuantReg: 7.27557) QuantErr: 7.27557 batch_time=0.63519 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 2.73580 (QuantReg: 6.94112) QuantErr: 6.94112 batch_time=0.52488 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 2.60312 (QuantReg: 6.62975) QuantErr: 6.62975 batch_time=0.53207 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 2.45497 (QuantReg: 6.81131) QuantErr: 6.81131 batch_time=0.56584 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 2.73058 (QuantReg: 6.85318) QuantErr: 6.85318 batch_time=0.51046 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 2.81581 (QuantReg: 7.17435) QuantErr: 7.17435 batch_time=0.52732 
Train Epoch: 33 codebook_update_time=1.87333
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch33.pth ...
Done in 4.045s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch33.pth ...
Done in 8.445s
removing stale ckpt [epoch 32] [took 0.01s]
 epoch          : 33
 loss           : 2.6923546056747436
 quant_reg      : 7.059756465911866
 quant_err      : 7.059756465911866
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.479
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.23355937787467
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.1865
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.96562974759851
 mnt_best       : 36.23355937787467
 not_improved_count: 0
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 2.55072 (QuantReg: 6.91735) QuantErr: 6.91735 batch_time=27.80077 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 2.59667 (QuantReg: 6.92390) QuantErr: 6.92390 batch_time=0.58155 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 2.85158 (QuantReg: 7.20995) QuantErr: 7.20995 batch_time=0.51721 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 2.53071 (QuantReg: 7.23484) QuantErr: 7.23484 batch_time=0.50944 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 2.27701 (QuantReg: 6.63763) QuantErr: 6.63763 batch_time=0.51689 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 2.82839 (QuantReg: 7.37947) QuantErr: 7.37947 batch_time=0.51308 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 2.63564 (QuantReg: 6.98925) QuantErr: 6.98925 batch_time=1.22515 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 2.77979 (QuantReg: 7.21595) QuantErr: 7.21595 batch_time=1.20129 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 2.88717 (QuantReg: 7.13371) QuantErr: 7.13371 batch_time=0.51186 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 2.84626 (QuantReg: 7.30531) QuantErr: 7.30531 batch_time=0.51946 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 2.48921 (QuantReg: 7.02451) QuantErr: 7.02451 batch_time=0.52320 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 2.67257 (QuantReg: 7.06882) QuantErr: 7.06882 batch_time=0.50773 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 2.72530 (QuantReg: 7.44494) QuantErr: 7.44494 batch_time=0.51286 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 2.69870 (QuantReg: 7.18640) QuantErr: 7.18640 batch_time=2.60027 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 2.90474 (QuantReg: 6.97143) QuantErr: 6.97143 batch_time=0.56078 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 2.62192 (QuantReg: 6.73051) QuantErr: 6.73051 batch_time=0.52612 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 2.81834 (QuantReg: 7.30732) QuantErr: 7.30732 batch_time=0.51632 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 2.69340 (QuantReg: 7.05161) QuantErr: 7.05161 batch_time=0.54631 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 2.70565 (QuantReg: 6.86211) QuantErr: 6.86211 batch_time=0.53448 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 2.57569 (QuantReg: 6.92495) QuantErr: 6.92495 batch_time=0.52596 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 2.61177 (QuantReg: 6.81411) QuantErr: 6.81411 batch_time=0.50794 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 2.35465 (QuantReg: 7.04005) QuantErr: 7.04005 batch_time=0.49887 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 2.73546 (QuantReg: 7.15677) QuantErr: 7.15677 batch_time=0.51951 
Train Epoch: 34 codebook_update_time=1.77220
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch34.pth ...
Done in 4.365s
removing stale ckpt [epoch 33] [took 0.03s]
 epoch          : 34
 loss           : 2.678329604148865
 quant_reg      : 7.068032577514648
 quant_err      : 7.068032577514648
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.5525
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.80191203129147
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.142
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.12977850526857
 mnt_best       : 36.23355937787467
 not_improved_count: 1
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 2.56095 (QuantReg: 7.28633) QuantErr: 7.28633 batch_time=31.47308 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 2.88316 (QuantReg: 7.40827) QuantErr: 7.40827 batch_time=0.51275 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 2.80437 (QuantReg: 7.11417) QuantErr: 7.11417 batch_time=0.51442 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 2.80380 (QuantReg: 7.32571) QuantErr: 7.32571 batch_time=0.51240 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 2.68239 (QuantReg: 7.44391) QuantErr: 7.44391 batch_time=0.57026 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 2.45405 (QuantReg: 6.86650) QuantErr: 6.86650 batch_time=0.51128 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 2.90447 (QuantReg: 6.96885) QuantErr: 6.96885 batch_time=0.50489 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 2.71907 (QuantReg: 7.22564) QuantErr: 7.22564 batch_time=0.54780 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 2.70555 (QuantReg: 6.99052) QuantErr: 6.99052 batch_time=0.51360 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 2.84956 (QuantReg: 7.29055) QuantErr: 7.29055 batch_time=0.51747 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 2.45893 (QuantReg: 6.98110) QuantErr: 6.98110 batch_time=0.50212 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 2.78970 (QuantReg: 7.28496) QuantErr: 7.28496 batch_time=0.51292 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 2.72353 (QuantReg: 7.26418) QuantErr: 7.26418 batch_time=0.75362 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 2.48840 (QuantReg: 6.92478) QuantErr: 6.92478 batch_time=2.75598 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 2.81882 (QuantReg: 7.13724) QuantErr: 7.13724 batch_time=0.51870 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 2.32145 (QuantReg: 6.75106) QuantErr: 6.75106 batch_time=0.53111 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 2.42054 (QuantReg: 6.74209) QuantErr: 6.74209 batch_time=0.54043 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 2.79948 (QuantReg: 6.69570) QuantErr: 6.69570 batch_time=0.52974 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 2.85970 (QuantReg: 6.91063) QuantErr: 6.91063 batch_time=1.94957 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 2.72385 (QuantReg: 7.40278) QuantErr: 7.40278 batch_time=0.50127 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 2.54928 (QuantReg: 7.17200) QuantErr: 7.17200 batch_time=0.50301 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 2.58064 (QuantReg: 7.16287) QuantErr: 7.16287 batch_time=0.50252 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 2.69564 (QuantReg: 7.12254) QuantErr: 7.12254 batch_time=0.55604 
Train Epoch: 35 codebook_update_time=1.79428
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch35.pth ...
Done in 4.485s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 2.6698326358795166
 quant_reg      : 7.107539157867432
 quant_err      : 7.107539157867432
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.595
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.887756886396396
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.818
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.663107145670544
 mnt_best       : 36.23355937787467
 not_improved_count: 2
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 2.76364 (QuantReg: 7.30833) QuantErr: 7.30833 batch_time=34.08267 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 2.76082 (QuantReg: 7.27015) QuantErr: 7.27015 batch_time=0.54507 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 2.53616 (QuantReg: 7.16009) QuantErr: 7.16009 batch_time=0.65452 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 2.64800 (QuantReg: 7.00309) QuantErr: 7.00309 batch_time=0.54135 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 2.75263 (QuantReg: 6.91904) QuantErr: 6.91904 batch_time=0.55019 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 2.34977 (QuantReg: 6.84346) QuantErr: 6.84346 batch_time=0.55163 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 2.59044 (QuantReg: 6.60489) QuantErr: 6.60489 batch_time=0.51990 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 2.51409 (QuantReg: 6.91388) QuantErr: 6.91388 batch_time=0.57523 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 2.78875 (QuantReg: 7.12287) QuantErr: 7.12287 batch_time=0.51568 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 2.57909 (QuantReg: 6.98344) QuantErr: 6.98344 batch_time=0.53023 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 2.70982 (QuantReg: 6.95750) QuantErr: 6.95750 batch_time=0.54405 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 2.85082 (QuantReg: 7.14378) QuantErr: 7.14378 batch_time=0.52701 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 2.60185 (QuantReg: 7.08762) QuantErr: 7.08762 batch_time=0.56112 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 2.65771 (QuantReg: 7.24553) QuantErr: 7.24553 batch_time=0.52935 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 2.84996 (QuantReg: 7.00160) QuantErr: 7.00160 batch_time=0.56383 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 2.62878 (QuantReg: 7.10082) QuantErr: 7.10082 batch_time=0.50671 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 2.66762 (QuantReg: 7.26488) QuantErr: 7.26488 batch_time=0.53626 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 2.60502 (QuantReg: 6.44246) QuantErr: 6.44246 batch_time=0.51957 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 2.56752 (QuantReg: 7.42439) QuantErr: 7.42439 batch_time=0.52231 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 2.70997 (QuantReg: 7.31675) QuantErr: 7.31675 batch_time=0.51834 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 2.56841 (QuantReg: 7.21534) QuantErr: 7.21534 batch_time=0.51594 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 2.40285 (QuantReg: 6.80173) QuantErr: 6.80173 batch_time=1.67894 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 2.40894 (QuantReg: 6.89786) QuantErr: 6.89786 batch_time=0.51308 
Train Epoch: 36 codebook_update_time=1.90151
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch36.pth ...
Done in 4.624s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch36.pth ...
Done in 9.482s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 2.662294939041138
 quant_reg      : 7.123170072555542
 quant_err      : 7.123170072555542
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.106
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.35801674484916
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.652
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.41796802393824
 mnt_best       : 36.35801674484916
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 2.77984 (QuantReg: 6.87059) QuantErr: 6.87059 batch_time=35.42359 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 2.60377 (QuantReg: 7.16636) QuantErr: 7.16636 batch_time=0.50914 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 2.53494 (QuantReg: 7.09743) QuantErr: 7.09743 batch_time=0.50124 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 2.69931 (QuantReg: 6.99566) QuantErr: 6.99566 batch_time=0.50236 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 2.49978 (QuantReg: 7.19922) QuantErr: 7.19922 batch_time=0.53479 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 2.59299 (QuantReg: 7.12021) QuantErr: 7.12021 batch_time=0.55900 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 2.59603 (QuantReg: 6.66614) QuantErr: 6.66614 batch_time=0.55150 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 2.94264 (QuantReg: 7.53428) QuantErr: 7.53428 batch_time=0.52545 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 2.75773 (QuantReg: 7.34336) QuantErr: 7.34336 batch_time=0.50854 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 2.37786 (QuantReg: 7.08043) QuantErr: 7.08043 batch_time=0.52526 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 2.69489 (QuantReg: 7.31813) QuantErr: 7.31813 batch_time=0.50966 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 2.44900 (QuantReg: 7.41775) QuantErr: 7.41775 batch_time=0.51884 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 2.60198 (QuantReg: 6.94511) QuantErr: 6.94511 batch_time=0.52557 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 2.75983 (QuantReg: 7.22479) QuantErr: 7.22479 batch_time=0.59289 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 2.34491 (QuantReg: 7.14326) QuantErr: 7.14326 batch_time=0.50253 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 2.43357 (QuantReg: 7.05313) QuantErr: 7.05313 batch_time=0.58838 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 2.68194 (QuantReg: 7.43106) QuantErr: 7.43106 batch_time=0.52207 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 2.27363 (QuantReg: 7.08897) QuantErr: 7.08897 batch_time=0.52945 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 2.67838 (QuantReg: 6.83165) QuantErr: 6.83165 batch_time=0.52267 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 2.51330 (QuantReg: 7.41228) QuantErr: 7.41228 batch_time=2.21259 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 2.60875 (QuantReg: 6.86078) QuantErr: 6.86078 batch_time=0.50873 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 2.70257 (QuantReg: 6.89118) QuantErr: 6.89118 batch_time=0.51849 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 2.64217 (QuantReg: 7.32567) QuantErr: 7.32567 batch_time=0.50729 
Train Epoch: 37 codebook_update_time=1.72176
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch37.pth ...
Done in 4.659s
removing stale ckpt [epoch 36] [took 0.01s]
 epoch          : 37
 loss           : 2.653707194328308
 quant_reg      : 7.146470262527465
 quant_err      : 7.146470262527465
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.282
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.06698126506771
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.75
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.182
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.12417612054469
 mnt_best       : 36.35801674484916
 not_improved_count: 1
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 2.47510 (QuantReg: 7.52304) QuantErr: 7.52304 batch_time=33.61831 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 2.49415 (QuantReg: 7.31852) QuantErr: 7.31852 batch_time=0.52829 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 2.44762 (QuantReg: 6.90204) QuantErr: 6.90204 batch_time=0.52067 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 2.46043 (QuantReg: 6.87718) QuantErr: 6.87718 batch_time=0.51165 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 2.80087 (QuantReg: 7.19673) QuantErr: 7.19673 batch_time=0.52956 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 2.63275 (QuantReg: 7.31450) QuantErr: 7.31450 batch_time=0.50670 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 2.51543 (QuantReg: 7.01922) QuantErr: 7.01922 batch_time=2.32511 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 2.88322 (QuantReg: 7.31462) QuantErr: 7.31462 batch_time=0.52839 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 2.74096 (QuantReg: 7.27841) QuantErr: 7.27841 batch_time=0.50643 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 2.64965 (QuantReg: 7.44845) QuantErr: 7.44845 batch_time=0.56103 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 2.63170 (QuantReg: 7.31570) QuantErr: 7.31570 batch_time=0.53744 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 2.71893 (QuantReg: 7.12923) QuantErr: 7.12923 batch_time=0.51824 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 2.74480 (QuantReg: 7.37547) QuantErr: 7.37547 batch_time=0.51059 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 2.82310 (QuantReg: 7.28063) QuantErr: 7.28063 batch_time=2.98951 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 2.70128 (QuantReg: 7.07707) QuantErr: 7.07707 batch_time=0.53130 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 2.65704 (QuantReg: 7.54560) QuantErr: 7.54560 batch_time=0.51338 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 2.49645 (QuantReg: 6.99503) QuantErr: 6.99503 batch_time=0.57163 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 2.35782 (QuantReg: 6.92065) QuantErr: 6.92065 batch_time=0.51923 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 2.62918 (QuantReg: 7.69977) QuantErr: 7.69977 batch_time=0.51492 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 2.56192 (QuantReg: 7.38144) QuantErr: 7.38144 batch_time=0.54277 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 2.64044 (QuantReg: 7.31894) QuantErr: 7.31894 batch_time=0.51357 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 2.62570 (QuantReg: 6.83216) QuantErr: 6.83216 batch_time=0.50269 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 2.63174 (QuantReg: 6.90753) QuantErr: 6.90753 batch_time=0.50753 
Train Epoch: 38 codebook_update_time=1.73547
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch38.pth ...
Done in 5.975s
removing stale ckpt [epoch 37] [took 0.03s]
 epoch          : 38
 loss           : 2.6456321420669555
 quant_reg      : 7.113233932495117
 quant_err      : 7.113233932495117
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.2455
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.22118912511943
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.25
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.8165
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.5871097547717
 mnt_best       : 36.35801674484916
 not_improved_count: 2
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 2.55398 (QuantReg: 6.95982) QuantErr: 6.95982 batch_time=32.68646 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 2.61025 (QuantReg: 7.52258) QuantErr: 7.52258 batch_time=2.45115 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 3.08779 (QuantReg: 7.09731) QuantErr: 7.09731 batch_time=1.96452 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 2.59466 (QuantReg: 7.24552) QuantErr: 7.24552 batch_time=0.50630 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 3.00739 (QuantReg: 7.16852) QuantErr: 7.16852 batch_time=0.50693 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 2.62839 (QuantReg: 7.10773) QuantErr: 7.10773 batch_time=0.50441 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 2.79798 (QuantReg: 6.86608) QuantErr: 6.86608 batch_time=1.76253 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 2.69577 (QuantReg: 7.05638) QuantErr: 7.05638 batch_time=0.85333 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 2.75124 (QuantReg: 7.57307) QuantErr: 7.57307 batch_time=0.53557 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 2.72376 (QuantReg: 7.21713) QuantErr: 7.21713 batch_time=1.02932 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 2.78155 (QuantReg: 7.52601) QuantErr: 7.52601 batch_time=0.51411 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 2.66561 (QuantReg: 7.11877) QuantErr: 7.11877 batch_time=0.51090 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 3.07406 (QuantReg: 6.99437) QuantErr: 6.99437 batch_time=0.50508 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 2.82924 (QuantReg: 7.29020) QuantErr: 7.29020 batch_time=0.50620 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 2.78515 (QuantReg: 7.32888) QuantErr: 7.32888 batch_time=0.50580 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 2.81319 (QuantReg: 7.26471) QuantErr: 7.26471 batch_time=0.51119 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 2.90966 (QuantReg: 7.29029) QuantErr: 7.29029 batch_time=0.50860 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 2.67159 (QuantReg: 7.45500) QuantErr: 7.45500 batch_time=0.51067 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 2.62468 (QuantReg: 7.04860) QuantErr: 7.04860 batch_time=0.52522 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 2.98364 (QuantReg: 6.99489) QuantErr: 6.99489 batch_time=0.52479 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 2.88779 (QuantReg: 7.07931) QuantErr: 7.07931 batch_time=0.50604 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 2.91685 (QuantReg: 7.05332) QuantErr: 7.05332 batch_time=0.51587 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 2.66458 (QuantReg: 7.10258) QuantErr: 7.10258 batch_time=0.50156 
Train Epoch: 39 codebook_update_time=1.74102
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch39.pth ...
Done in 4.323s
removing stale ckpt [epoch 38] [took 0.02s]
 epoch          : 39
 loss           : 2.6884194107055666
 quant_reg      : 7.186535869598389
 quant_err      : 7.186535869598389
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.4985
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.90225542739005
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 33.789
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.01785483559639
 mnt_best       : 36.35801674484916
 not_improved_count: 3
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 2.80871 (QuantReg: 6.88917) QuantErr: 6.88917 batch_time=29.68855 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 2.35701 (QuantReg: 7.07058) QuantErr: 7.07058 batch_time=0.50271 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 2.55633 (QuantReg: 7.09024) QuantErr: 7.09024 batch_time=0.50538 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 2.56954 (QuantReg: 7.30945) QuantErr: 7.30945 batch_time=0.51156 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 2.71633 (QuantReg: 6.70507) QuantErr: 6.70507 batch_time=0.53646 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 3.03403 (QuantReg: 6.95842) QuantErr: 6.95842 batch_time=0.54177 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 2.71045 (QuantReg: 6.81718) QuantErr: 6.81718 batch_time=0.51841 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 2.67065 (QuantReg: 6.75565) QuantErr: 6.75565 batch_time=0.50527 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 2.74989 (QuantReg: 7.36875) QuantErr: 7.36875 batch_time=0.54027 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 2.56292 (QuantReg: 7.56531) QuantErr: 7.56531 batch_time=0.52812 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 2.95418 (QuantReg: 6.90930) QuantErr: 6.90930 batch_time=0.52039 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 2.78222 (QuantReg: 7.33651) QuantErr: 7.33651 batch_time=0.56871 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 2.72888 (QuantReg: 6.76287) QuantErr: 6.76287 batch_time=1.75408 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 2.74778 (QuantReg: 6.83912) QuantErr: 6.83912 batch_time=0.51801 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 2.43616 (QuantReg: 6.98377) QuantErr: 6.98377 batch_time=0.53422 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 2.58758 (QuantReg: 7.24211) QuantErr: 7.24211 batch_time=0.57504 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 2.79533 (QuantReg: 6.58271) QuantErr: 6.58271 batch_time=0.60202 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 2.76054 (QuantReg: 7.13119) QuantErr: 7.13119 batch_time=0.51356 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 2.60989 (QuantReg: 7.05758) QuantErr: 7.05758 batch_time=0.51328 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 2.83679 (QuantReg: 6.85505) QuantErr: 6.85505 batch_time=0.51620 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 2.70372 (QuantReg: 6.87981) QuantErr: 6.87981 batch_time=1.23306 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 2.68148 (QuantReg: 7.41343) QuantErr: 7.41343 batch_time=0.52361 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 2.57657 (QuantReg: 7.19338) QuantErr: 7.19338 batch_time=0.51188 
Train Epoch: 40 codebook_update_time=1.83671
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch40.pth ...
Done in 4.187s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 2.677777579307556
 quant_reg      : 7.138519361495971
 quant_err      : 7.138519361495971
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.791
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.560059939678716
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.688
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.98262124150055
 mnt_best       : 36.35801674484916
 not_improved_count: 4
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 2.71890 (QuantReg: 7.32177) QuantErr: 7.32177 batch_time=33.75464 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 2.77712 (QuantReg: 7.38842) QuantErr: 7.38842 batch_time=0.54001 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 2.65851 (QuantReg: 6.81719) QuantErr: 6.81719 batch_time=0.51038 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 2.69853 (QuantReg: 7.31565) QuantErr: 7.31565 batch_time=2.30257 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 2.78456 (QuantReg: 7.35841) QuantErr: 7.35841 batch_time=0.56518 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 2.42850 (QuantReg: 7.18610) QuantErr: 7.18610 batch_time=0.50769 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 2.42755 (QuantReg: 7.21450) QuantErr: 7.21450 batch_time=0.49902 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 2.49775 (QuantReg: 6.72746) QuantErr: 6.72746 batch_time=0.53053 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 2.70249 (QuantReg: 7.36300) QuantErr: 7.36300 batch_time=0.50411 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 2.80316 (QuantReg: 7.22058) QuantErr: 7.22058 batch_time=0.54097 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 2.50658 (QuantReg: 7.22448) QuantErr: 7.22448 batch_time=0.50591 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 2.73108 (QuantReg: 7.08758) QuantErr: 7.08758 batch_time=0.52528 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 2.72610 (QuantReg: 7.24581) QuantErr: 7.24581 batch_time=0.56520 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 2.79587 (QuantReg: 7.39131) QuantErr: 7.39131 batch_time=0.86226 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 2.79865 (QuantReg: 7.12863) QuantErr: 7.12863 batch_time=0.51294 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 2.63256 (QuantReg: 7.09785) QuantErr: 7.09785 batch_time=0.88477 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 2.67363 (QuantReg: 7.32736) QuantErr: 7.32736 batch_time=0.65022 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 2.76282 (QuantReg: 7.40969) QuantErr: 7.40969 batch_time=0.50657 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 2.88857 (QuantReg: 7.13594) QuantErr: 7.13594 batch_time=0.50791 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 2.63447 (QuantReg: 6.99283) QuantErr: 6.99283 batch_time=0.59127 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 2.72907 (QuantReg: 7.41461) QuantErr: 7.41461 batch_time=0.56663 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 2.82809 (QuantReg: 6.81735) QuantErr: 6.81735 batch_time=0.53006 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 2.59294 (QuantReg: 6.81351) QuantErr: 6.81351 batch_time=0.55022 
Train Epoch: 41 codebook_update_time=2.10672
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch41.pth ...
Done in 5.963s
removing stale ckpt [epoch 40] [took 0.01s]
 epoch          : 41
 loss           : 2.682883749961853
 quant_reg      : 7.173330535888672
 quant_err      : 7.173330535888672
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.624
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.49027360331225
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.9145
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.80545051891379
 mnt_best       : 36.35801674484916
 not_improved_count: 5
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 2.65366 (QuantReg: 7.17613) QuantErr: 7.17613 batch_time=32.72490 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 2.69195 (QuantReg: 7.60168) QuantErr: 7.60168 batch_time=0.52259 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 2.80306 (QuantReg: 7.16511) QuantErr: 7.16511 batch_time=0.81017 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 2.81516 (QuantReg: 6.93703) QuantErr: 6.93703 batch_time=0.54781 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 2.92454 (QuantReg: 7.15365) QuantErr: 7.15365 batch_time=0.56285 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 2.44190 (QuantReg: 7.17889) QuantErr: 7.17889 batch_time=0.51994 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 2.58096 (QuantReg: 7.08398) QuantErr: 7.08398 batch_time=1.09723 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 2.68130 (QuantReg: 7.50722) QuantErr: 7.50722 batch_time=0.49299 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 2.53268 (QuantReg: 7.23562) QuantErr: 7.23562 batch_time=1.07293 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 2.78880 (QuantReg: 7.44104) QuantErr: 7.44104 batch_time=0.52218 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 2.63198 (QuantReg: 6.99312) QuantErr: 6.99312 batch_time=0.65057 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 2.73197 (QuantReg: 7.09602) QuantErr: 7.09602 batch_time=0.60675 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 2.61371 (QuantReg: 6.80984) QuantErr: 6.80984 batch_time=0.52870 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 2.51391 (QuantReg: 7.29702) QuantErr: 7.29702 batch_time=2.35839 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 2.65310 (QuantReg: 7.18893) QuantErr: 7.18893 batch_time=0.52694 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 2.75504 (QuantReg: 7.33863) QuantErr: 7.33863 batch_time=0.53804 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 2.65426 (QuantReg: 7.25137) QuantErr: 7.25137 batch_time=0.51023 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 2.57738 (QuantReg: 7.37552) QuantErr: 7.37552 batch_time=0.52671 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 2.66866 (QuantReg: 7.30880) QuantErr: 7.30880 batch_time=0.52354 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 2.47113 (QuantReg: 6.85628) QuantErr: 6.85628 batch_time=0.54277 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 2.61582 (QuantReg: 7.05024) QuantErr: 7.05024 batch_time=0.53182 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 2.71662 (QuantReg: 7.08272) QuantErr: 7.08272 batch_time=0.55777 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 2.77860 (QuantReg: 7.55930) QuantErr: 7.55930 batch_time=0.52304 
Train Epoch: 42 codebook_update_time=2.21971
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch42.pth ...
Done in 4.395s
removing stale ckpt [epoch 41] [took 0.06s]
 epoch          : 42
 loss           : 2.6767241439819336
 quant_reg      : 7.199988388061524
 quant_err      : 7.199988388061524
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 35.862
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.242998061010745
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.896
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.11121164539181
 mnt_best       : 36.35801674484916
 not_improved_count: 6
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 2.66932 (QuantReg: 7.44317) QuantErr: 7.44317 batch_time=31.54956 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 2.42352 (QuantReg: 7.33490) QuantErr: 7.33490 batch_time=0.75123 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 2.62803 (QuantReg: 7.39569) QuantErr: 7.39569 batch_time=0.52087 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 3.00104 (QuantReg: 7.35752) QuantErr: 7.35752 batch_time=0.53458 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 2.70871 (QuantReg: 7.29753) QuantErr: 7.29753 batch_time=0.50685 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 2.69307 (QuantReg: 7.47964) QuantErr: 7.47964 batch_time=0.55168 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 2.75964 (QuantReg: 7.07760) QuantErr: 7.07760 batch_time=0.89974 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 2.53449 (QuantReg: 7.19336) QuantErr: 7.19336 batch_time=0.58735 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 2.44314 (QuantReg: 7.18625) QuantErr: 7.18625 batch_time=0.49828 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 2.70086 (QuantReg: 7.23635) QuantErr: 7.23635 batch_time=0.59390 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 2.63826 (QuantReg: 7.43439) QuantErr: 7.43439 batch_time=0.53599 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 2.56637 (QuantReg: 7.29076) QuantErr: 7.29076 batch_time=0.51046 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 2.40406 (QuantReg: 7.19464) QuantErr: 7.19464 batch_time=0.53506 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 2.62299 (QuantReg: 6.88951) QuantErr: 6.88951 batch_time=5.81382 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 2.73139 (QuantReg: 7.35205) QuantErr: 7.35205 batch_time=0.51461 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 2.62063 (QuantReg: 7.29183) QuantErr: 7.29183 batch_time=0.57416 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 2.61547 (QuantReg: 7.56807) QuantErr: 7.56807 batch_time=0.49904 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 2.60784 (QuantReg: 7.46243) QuantErr: 7.46243 batch_time=0.53295 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 2.93679 (QuantReg: 7.44634) QuantErr: 7.44634 batch_time=0.50421 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 2.85134 (QuantReg: 7.41349) QuantErr: 7.41349 batch_time=0.50193 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 2.59552 (QuantReg: 7.53781) QuantErr: 7.53781 batch_time=0.52467 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 2.63503 (QuantReg: 7.25194) QuantErr: 7.25194 batch_time=0.54365 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 2.54656 (QuantReg: 6.78443) QuantErr: 6.78443 batch_time=0.51154 
Train Epoch: 43 codebook_update_time=2.26204
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch43.pth ...
Done in 23.607s
removing stale ckpt [epoch 42] [took 1.31s]
 epoch          : 43
 loss           : 2.6698033609390257
 quant_reg      : 7.22204986000061
 quant_err      : 7.22204986000061
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.184
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.241480994563325
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.9775
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.45016680985152
 mnt_best       : 36.35801674484916
 not_improved_count: 7
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 2.57461 (QuantReg: 7.18310) QuantErr: 7.18310 batch_time=30.83388 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 2.85710 (QuantReg: 7.34103) QuantErr: 7.34103 batch_time=0.52897 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 2.67728 (QuantReg: 7.02107) QuantErr: 7.02107 batch_time=0.51345 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 2.34037 (QuantReg: 7.23755) QuantErr: 7.23755 batch_time=8.67299 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 2.89496 (QuantReg: 7.43174) QuantErr: 7.43174 batch_time=0.50969 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 2.95420 (QuantReg: 6.74293) QuantErr: 6.74293 batch_time=0.53901 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 2.85040 (QuantReg: 7.08544) QuantErr: 7.08544 batch_time=0.51327 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 2.75242 (QuantReg: 7.11802) QuantErr: 7.11802 batch_time=0.50666 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 2.85424 (QuantReg: 7.12272) QuantErr: 7.12272 batch_time=0.52205 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 2.58548 (QuantReg: 6.95338) QuantErr: 6.95338 batch_time=0.78295 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 2.82351 (QuantReg: 7.13171) QuantErr: 7.13171 batch_time=0.50819 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 2.63308 (QuantReg: 7.04801) QuantErr: 7.04801 batch_time=0.51426 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 2.87131 (QuantReg: 7.32829) QuantErr: 7.32829 batch_time=0.58605 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 2.76212 (QuantReg: 7.13310) QuantErr: 7.13310 batch_time=0.50874 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 2.76253 (QuantReg: 7.26972) QuantErr: 7.26972 batch_time=0.58102 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 2.96365 (QuantReg: 7.34515) QuantErr: 7.34515 batch_time=0.52397 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 2.71055 (QuantReg: 7.15422) QuantErr: 7.15422 batch_time=0.59891 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 2.74764 (QuantReg: 7.11592) QuantErr: 7.11592 batch_time=0.50797 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 2.68304 (QuantReg: 7.29622) QuantErr: 7.29622 batch_time=0.51263 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 2.67829 (QuantReg: 7.09826) QuantErr: 7.09826 batch_time=0.54521 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 2.68311 (QuantReg: 7.24421) QuantErr: 7.24421 batch_time=0.50568 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 2.79308 (QuantReg: 7.11465) QuantErr: 7.11465 batch_time=0.51924 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 2.74633 (QuantReg: 7.30851) QuantErr: 7.30851 batch_time=0.52004 
Train Epoch: 44 codebook_update_time=1.87941
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch44.pth ...
Done in 5.262s
removing stale ckpt [epoch 43] [took 0.01s]
 epoch          : 44
 loss           : 2.683573085784912
 quant_reg      : 7.223033504486084
 quant_err      : 7.223033504486084
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.494
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.126264448104436
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.285
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.80463842564713
 mnt_best       : 36.35801674484916
 not_improved_count: 8
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 2.93581 (QuantReg: 7.60796) QuantErr: 7.60796 batch_time=32.41791 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 2.68366 (QuantReg: 7.06678) QuantErr: 7.06678 batch_time=0.51174 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 2.45636 (QuantReg: 7.63442) QuantErr: 7.63442 batch_time=0.52499 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 2.77306 (QuantReg: 6.95821) QuantErr: 6.95821 batch_time=0.51043 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 2.65664 (QuantReg: 7.04210) QuantErr: 7.04210 batch_time=0.52497 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 2.78063 (QuantReg: 7.33660) QuantErr: 7.33660 batch_time=0.56827 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 2.55638 (QuantReg: 7.37413) QuantErr: 7.37413 batch_time=0.51902 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 2.74745 (QuantReg: 7.35991) QuantErr: 7.35991 batch_time=0.51053 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 2.71556 (QuantReg: 7.10064) QuantErr: 7.10064 batch_time=0.51378 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 2.54701 (QuantReg: 7.89339) QuantErr: 7.89339 batch_time=0.51265 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 2.49283 (QuantReg: 7.18732) QuantErr: 7.18732 batch_time=0.54010 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 2.74597 (QuantReg: 7.59679) QuantErr: 7.59679 batch_time=0.53003 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 2.47668 (QuantReg: 7.26901) QuantErr: 7.26901 batch_time=1.37088 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 2.68818 (QuantReg: 7.15921) QuantErr: 7.15921 batch_time=0.51342 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 2.77392 (QuantReg: 7.27931) QuantErr: 7.27931 batch_time=0.51214 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 2.60274 (QuantReg: 7.26527) QuantErr: 7.26527 batch_time=0.54160 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 2.82498 (QuantReg: 6.74945) QuantErr: 6.74945 batch_time=0.52851 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 2.77690 (QuantReg: 7.31777) QuantErr: 7.31777 batch_time=0.50822 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 2.55806 (QuantReg: 7.36085) QuantErr: 7.36085 batch_time=0.49889 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 2.44153 (QuantReg: 7.22283) QuantErr: 7.22283 batch_time=2.49327 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 2.81297 (QuantReg: 7.00914) QuantErr: 7.00914 batch_time=0.53017 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 2.61132 (QuantReg: 7.72002) QuantErr: 7.72002 batch_time=0.64126 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 2.74808 (QuantReg: 7.35073) QuantErr: 7.35073 batch_time=0.52890 
Train Epoch: 45 codebook_update_time=2.31651
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch45.pth ...
Done in 6.227s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 2.6667896928787234
 quant_reg      : 7.219618017196655
 quant_err      : 7.219618017196655
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.589
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.253625638152975
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.5315
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.28064598292162
 mnt_best       : 36.35801674484916
 not_improved_count: 9
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 2.69718 (QuantReg: 7.33723) QuantErr: 7.33723 batch_time=38.44380 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 2.90481 (QuantReg: 6.63309) QuantErr: 6.63309 batch_time=0.50784 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 2.87084 (QuantReg: 7.39984) QuantErr: 7.39984 batch_time=0.51134 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 2.82763 (QuantReg: 7.15731) QuantErr: 7.15731 batch_time=0.51073 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 2.73981 (QuantReg: 7.18648) QuantErr: 7.18648 batch_time=0.53206 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 2.78477 (QuantReg: 7.30113) QuantErr: 7.30113 batch_time=0.50788 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 2.67832 (QuantReg: 7.33527) QuantErr: 7.33527 batch_time=0.55625 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 2.47095 (QuantReg: 6.91675) QuantErr: 6.91675 batch_time=0.80281 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 2.44239 (QuantReg: 6.90996) QuantErr: 6.90996 batch_time=0.52002 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 2.73316 (QuantReg: 7.85812) QuantErr: 7.85812 batch_time=0.53192 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 2.86438 (QuantReg: 7.25162) QuantErr: 7.25162 batch_time=0.53346 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 2.58626 (QuantReg: 7.19938) QuantErr: 7.19938 batch_time=0.52441 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 2.73714 (QuantReg: 7.05214) QuantErr: 7.05214 batch_time=0.50905 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 2.72748 (QuantReg: 6.92474) QuantErr: 6.92474 batch_time=0.49525 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 2.82233 (QuantReg: 7.28701) QuantErr: 7.28701 batch_time=0.54931 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 2.78685 (QuantReg: 7.43596) QuantErr: 7.43596 batch_time=0.51086 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 2.62959 (QuantReg: 6.88285) QuantErr: 6.88285 batch_time=0.52026 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 2.82396 (QuantReg: 7.50512) QuantErr: 7.50512 batch_time=0.51459 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 2.52447 (QuantReg: 7.40270) QuantErr: 7.40270 batch_time=0.51432 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 2.63661 (QuantReg: 7.50324) QuantErr: 7.50324 batch_time=2.66771 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 2.53987 (QuantReg: 7.07695) QuantErr: 7.07695 batch_time=0.51750 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 2.48023 (QuantReg: 7.33157) QuantErr: 7.33157 batch_time=0.49999 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 2.83891 (QuantReg: 7.63088) QuantErr: 7.63088 batch_time=0.54057 
Train Epoch: 46 codebook_update_time=1.70727
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch46.pth ...
Done in 4.754s
removing stale ckpt [epoch 45] [took 0.20s]
 epoch          : 46
 loss           : 2.6692878293991087
 quant_reg      : 7.223621686935425
 quant_err      : 7.223621686935425
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.401
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.19849204670579
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.5725
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.93260332728793
 mnt_best       : 36.35801674484916
 not_improved_count: 10
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 2.82382 (QuantReg: 7.08472) QuantErr: 7.08472 batch_time=32.29709 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 2.72822 (QuantReg: 6.96709) QuantErr: 6.96709 batch_time=2.09645 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 2.78217 (QuantReg: 7.34326) QuantErr: 7.34326 batch_time=0.50189 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 2.86722 (QuantReg: 7.17305) QuantErr: 7.17305 batch_time=0.51931 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 2.69113 (QuantReg: 7.48617) QuantErr: 7.48617 batch_time=0.53539 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 2.66800 (QuantReg: 7.53983) QuantErr: 7.53983 batch_time=0.57463 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 2.63398 (QuantReg: 7.57527) QuantErr: 7.57527 batch_time=0.96771 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 2.74515 (QuantReg: 7.41755) QuantErr: 7.41755 batch_time=0.51278 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 2.71519 (QuantReg: 7.16992) QuantErr: 7.16992 batch_time=0.52236 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 2.62210 (QuantReg: 7.60555) QuantErr: 7.60555 batch_time=0.53411 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 2.62627 (QuantReg: 7.12592) QuantErr: 7.12592 batch_time=0.51464 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 2.56643 (QuantReg: 7.25768) QuantErr: 7.25768 batch_time=0.56858 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 2.75383 (QuantReg: 7.40603) QuantErr: 7.40603 batch_time=0.51576 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 2.42600 (QuantReg: 7.41289) QuantErr: 7.41289 batch_time=0.58468 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 2.84197 (QuantReg: 7.60632) QuantErr: 7.60632 batch_time=0.53626 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 2.69980 (QuantReg: 7.40768) QuantErr: 7.40768 batch_time=0.50043 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 2.75967 (QuantReg: 7.64899) QuantErr: 7.64899 batch_time=0.66278 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 2.78570 (QuantReg: 7.26942) QuantErr: 7.26942 batch_time=0.52746 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 2.63273 (QuantReg: 7.13822) QuantErr: 7.13822 batch_time=0.51097 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 2.64230 (QuantReg: 7.01579) QuantErr: 7.01579 batch_time=0.53384 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 2.42672 (QuantReg: 7.26520) QuantErr: 7.26520 batch_time=0.54488 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 2.87676 (QuantReg: 7.26236) QuantErr: 7.26236 batch_time=0.56766 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 2.67747 (QuantReg: 7.16519) QuantErr: 7.16519 batch_time=0.52009 
Train Epoch: 47 codebook_update_time=1.71489
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch47.pth ...
Done in 5.168s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch47.pth ...
Done in 10.391s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 2.683320590019226
 quant_reg      : 7.27320574760437
 quant_err      : 7.27320574760437
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.7
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.417
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.38870458202483
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.75
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.104
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.67910964288192
 mnt_best       : 36.38870458202483
 not_improved_count: 0
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 2.67220 (QuantReg: 7.14389) QuantErr: 7.14389 batch_time=31.81616 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 2.77770 (QuantReg: 7.48892) QuantErr: 7.48892 batch_time=0.51223 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 2.79707 (QuantReg: 7.25135) QuantErr: 7.25135 batch_time=2.15976 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 2.70651 (QuantReg: 7.26980) QuantErr: 7.26980 batch_time=0.54394 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 2.70907 (QuantReg: 7.15918) QuantErr: 7.15918 batch_time=0.54294 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 2.69004 (QuantReg: 7.64086) QuantErr: 7.64086 batch_time=0.66981 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 2.67869 (QuantReg: 7.45446) QuantErr: 7.45446 batch_time=0.56403 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 2.69673 (QuantReg: 7.24584) QuantErr: 7.24584 batch_time=0.51887 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 2.61872 (QuantReg: 7.74139) QuantErr: 7.74139 batch_time=0.51993 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 2.60254 (QuantReg: 7.44773) QuantErr: 7.44773 batch_time=0.50996 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 2.78906 (QuantReg: 7.23108) QuantErr: 7.23108 batch_time=0.53565 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 2.51106 (QuantReg: 6.83001) QuantErr: 6.83001 batch_time=0.49782 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 2.77892 (QuantReg: 7.23189) QuantErr: 7.23189 batch_time=0.53155 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 3.20292 (QuantReg: 7.36575) QuantErr: 7.36575 batch_time=0.50834 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 2.79620 (QuantReg: 7.17168) QuantErr: 7.17168 batch_time=0.51877 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 2.73833 (QuantReg: 7.18212) QuantErr: 7.18212 batch_time=0.54443 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 2.56524 (QuantReg: 7.34926) QuantErr: 7.34926 batch_time=0.50936 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 2.64026 (QuantReg: 7.53098) QuantErr: 7.53098 batch_time=0.53110 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 2.74664 (QuantReg: 7.31289) QuantErr: 7.31289 batch_time=0.52862 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 2.61805 (QuantReg: 7.29211) QuantErr: 7.29211 batch_time=0.49735 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 2.74675 (QuantReg: 7.38668) QuantErr: 7.38668 batch_time=0.54408 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 2.69145 (QuantReg: 7.08870) QuantErr: 7.08870 batch_time=0.51433 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 2.63279 (QuantReg: 7.36159) QuantErr: 7.36159 batch_time=0.52917 
Train Epoch: 48 codebook_update_time=1.74085
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch48.pth ...
Done in 6.017s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch48.pth ...
Done in 10.467s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 2.6853650703430176
 quant_reg      : 7.273408060073852
 quant_err      : 7.273408060073852
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 45.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.403
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.494781764798745
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.3745
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.307503249030276
 mnt_best       : 36.494781764798745
 not_improved_count: 0
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 2.72912 (QuantReg: 7.23889) QuantErr: 7.23889 batch_time=32.02719 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 2.77974 (QuantReg: 7.38502) QuantErr: 7.38502 batch_time=0.50444 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 2.57278 (QuantReg: 7.19672) QuantErr: 7.19672 batch_time=0.51465 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 2.87920 (QuantReg: 7.55335) QuantErr: 7.55335 batch_time=0.51331 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 2.73408 (QuantReg: 6.98088) QuantErr: 6.98088 batch_time=0.56578 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 2.83009 (QuantReg: 7.54857) QuantErr: 7.54857 batch_time=0.75856 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 2.54820 (QuantReg: 7.00745) QuantErr: 7.00745 batch_time=4.18626 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 2.51922 (QuantReg: 7.61211) QuantErr: 7.61211 batch_time=0.50191 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 2.34393 (QuantReg: 6.85587) QuantErr: 6.85587 batch_time=0.53665 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 2.73299 (QuantReg: 7.36716) QuantErr: 7.36716 batch_time=0.52824 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 2.77000 (QuantReg: 7.34863) QuantErr: 7.34863 batch_time=0.50627 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 2.59257 (QuantReg: 7.18611) QuantErr: 7.18611 batch_time=0.52969 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 2.85264 (QuantReg: 7.26229) QuantErr: 7.26229 batch_time=0.50951 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 2.60970 (QuantReg: 6.87145) QuantErr: 6.87145 batch_time=0.51615 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 2.65027 (QuantReg: 7.07501) QuantErr: 7.07501 batch_time=0.52512 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 2.44781 (QuantReg: 7.15716) QuantErr: 7.15716 batch_time=0.53713 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 2.50825 (QuantReg: 6.84332) QuantErr: 6.84332 batch_time=0.52267 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 2.73847 (QuantReg: 7.22753) QuantErr: 7.22753 batch_time=0.51684 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 2.88157 (QuantReg: 7.43608) QuantErr: 7.43608 batch_time=0.51742 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 2.80607 (QuantReg: 7.16060) QuantErr: 7.16060 batch_time=0.51808 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 2.59739 (QuantReg: 7.23364) QuantErr: 7.23364 batch_time=0.52212 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 2.31069 (QuantReg: 6.97971) QuantErr: 6.97971 batch_time=0.50919 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 2.63500 (QuantReg: 7.14015) QuantErr: 7.14015 batch_time=0.51335 
Train Epoch: 49 codebook_update_time=1.72677
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch49.pth ...
Done in 5.738s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch49.pth ...
Done in 10.497s
removing stale ckpt [epoch 48] [took 0.02s]
 epoch          : 49
 loss           : 2.6966898012161256
 quant_reg      : 7.285919054031372
 quant_err      : 7.285919054031372
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.735
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.53221150970647
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 61.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.199
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.193678372728215
 mnt_best       : 36.53221150970647
 not_improved_count: 0
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 2.70878 (QuantReg: 7.55451) QuantErr: 7.55451 batch_time=31.34309 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 3.11560 (QuantReg: 7.34517) QuantErr: 7.34517 batch_time=0.49594 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 2.55189 (QuantReg: 7.47108) QuantErr: 7.47108 batch_time=0.50961 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 2.82756 (QuantReg: 7.31506) QuantErr: 7.31506 batch_time=0.51829 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 2.71333 (QuantReg: 7.09961) QuantErr: 7.09961 batch_time=0.51845 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 2.76066 (QuantReg: 7.36305) QuantErr: 7.36305 batch_time=0.51180 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 2.82656 (QuantReg: 7.58977) QuantErr: 7.58977 batch_time=0.51153 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 2.61304 (QuantReg: 7.38286) QuantErr: 7.38286 batch_time=0.49748 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 2.54324 (QuantReg: 7.25032) QuantErr: 7.25032 batch_time=0.52040 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 2.78305 (QuantReg: 7.53248) QuantErr: 7.53248 batch_time=0.51817 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 2.53865 (QuantReg: 7.76793) QuantErr: 7.76793 batch_time=0.51241 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 2.50459 (QuantReg: 6.98120) QuantErr: 6.98120 batch_time=0.51962 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 2.77302 (QuantReg: 7.45427) QuantErr: 7.45427 batch_time=0.61825 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 2.82376 (QuantReg: 7.14733) QuantErr: 7.14733 batch_time=0.51194 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 2.60987 (QuantReg: 6.96208) QuantErr: 6.96208 batch_time=0.54881 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 2.47035 (QuantReg: 7.32546) QuantErr: 7.32546 batch_time=0.54724 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 2.75869 (QuantReg: 7.39062) QuantErr: 7.39062 batch_time=0.50927 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 2.74578 (QuantReg: 7.51809) QuantErr: 7.51809 batch_time=0.51576 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 2.72012 (QuantReg: 7.60391) QuantErr: 7.60391 batch_time=0.51881 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 2.67337 (QuantReg: 7.38124) QuantErr: 7.38124 batch_time=0.50419 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 2.71259 (QuantReg: 7.32541) QuantErr: 7.32541 batch_time=0.50250 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 2.68806 (QuantReg: 7.25218) QuantErr: 7.25218 batch_time=0.51215 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 2.72159 (QuantReg: 7.34174) QuantErr: 7.34174 batch_time=0.50815 
Train Epoch: 50 codebook_update_time=1.70152
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/checkpoint-epoch50.pth ...
Done in 5.010s
removing stale ckpt [epoch 49] [took 0.00s]
 epoch          : 50
 loss           : 2.697507507324219
 quant_reg      : 7.334388751983642
 quant_err      : 7.334388751983642
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 36.8235
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.29793895312021
 MSRVTT_jsfusion_test/v2t_metrics/R1: 16.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 35.6505
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.87981319193641
 mnt_best       : 36.53221150970647
 not_improved_count: 1
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/trained_model.pth ...
Ckpt loaded at epoch 49.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 18.2
 t2v_metrics/R5/final_eval: 44.5
 t2v_metrics/R10/final_eval: 60.2
 t2v_metrics/R50/final_eval: 86.8
 t2v_metrics/MedR/final_eval: 7.0
 t2v_metrics/MeanR/final_eval: 36.735
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 36.53221150970647
 v2t_metrics/R1/final_eval: 16.5
 v2t_metrics/R5/final_eval: 46.8
 v2t_metrics/R10/final_eval: 61.4
 v2t_metrics/R50/final_eval: 85.8
 v2t_metrics/MedR/final_eval: 6.0
 v2t_metrics/MeanR/final_eval: 35.199
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 36.193678372728215
Best epoch for the monitored metric: 49
Script took 03h44m03s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_t0.15/trained_model.pth
