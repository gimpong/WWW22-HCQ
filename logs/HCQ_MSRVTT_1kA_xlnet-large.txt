Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large
Preparing the dataloaders ...
Loading dataset MSRVTT_jsfusion_trainval in ram ...
Finish loading dataset MSRVTT_jsfusion_trainval in ram, taking 420.19769644737244 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 34.35290241241455 s.
Loading dataset MSRVTT_jsfusion_test in ram ...
Finish loading dataset MSRVTT_jsfusion_test in ram, taking 28.41338062286377 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch0.pth ...
Done in 4.224s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch0.pth ...
Done in 8.362s
 epoch          : 0
 loss           : 0
 learning_rate  : 2e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_jsfusion_test/t2v_metrics/R1: 0.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 0.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 1.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 4.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 503.5
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 500.71
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.42726586816979173
 MSRVTT_jsfusion_test/v2t_metrics/R1: 0.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 0.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 1.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 5.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 496.5
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 497.417
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.3914867641168864
 mnt_best       : 0.42726586816979173
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 10.01799 (QuantReg: 22.50723) QuantErr: 22.50723 batch_time=34.81228 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 9.77463 (QuantReg: 22.58473) QuantErr: 22.58473 batch_time=0.96884 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 9.73438 (QuantReg: 22.63482) QuantErr: 22.63482 batch_time=1.00548 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 9.71679 (QuantReg: 22.64890) QuantErr: 22.64890 batch_time=0.93058 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 9.71577 (QuantReg: 22.63837) QuantErr: 22.63837 batch_time=0.93643 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 9.70845 (QuantReg: 22.62885) QuantErr: 22.62885 batch_time=0.96476 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 9.69755 (QuantReg: 22.62171) QuantErr: 22.62171 batch_time=10.24880 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 9.68985 (QuantReg: 22.63718) QuantErr: 22.63718 batch_time=0.93780 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 9.62693 (QuantReg: 22.70801) QuantErr: 22.70801 batch_time=0.97945 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 9.63578 (QuantReg: 22.69494) QuantErr: 22.69494 batch_time=1.28777 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 9.50666 (QuantReg: 22.74500) QuantErr: 22.74500 batch_time=0.96756 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 9.25584 (QuantReg: 22.71401) QuantErr: 22.71401 batch_time=0.85694 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 9.15487 (QuantReg: 22.71056) QuantErr: 22.71056 batch_time=1.61352 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 8.98874 (QuantReg: 22.73242) QuantErr: 22.73242 batch_time=0.91312 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 8.60274 (QuantReg: 22.77786) QuantErr: 22.77786 batch_time=0.88188 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 8.18565 (QuantReg: 22.83610) QuantErr: 22.83610 batch_time=0.97522 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 7.72776 (QuantReg: 22.79393) QuantErr: 22.79393 batch_time=0.99146 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 8.05658 (QuantReg: 22.73022) QuantErr: 22.73022 batch_time=0.92927 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 7.48474 (QuantReg: 22.77823) QuantErr: 22.77823 batch_time=0.99301 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 7.43995 (QuantReg: 22.74429) QuantErr: 22.74429 batch_time=0.98067 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 7.24783 (QuantReg: 22.77491) QuantErr: 22.77491 batch_time=0.99212 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 6.88897 (QuantReg: 22.77134) QuantErr: 22.77134 batch_time=0.94361 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 6.76353 (QuantReg: 22.71180) QuantErr: 22.71180 batch_time=1.47008 
Train Epoch: 1 codebook_update_time=2.32706
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch1.pth ...
Done in 11.364s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch1.pth ...
Done in 22.164s
 epoch          : 1
 loss           : 8.78908115196228
 quant_reg      : 22.709373641967773
 quant_err      : 22.709373641967773
 learning_rate  : 2e-05
 n_samples      : 32000
 n_steps        : 250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 1.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 9.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 17.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 49.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 51.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 105.679
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 5.652232391128106
 MSRVTT_jsfusion_test/v2t_metrics/R1: 1.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 8.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 16.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 49.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 53.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 109.039
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 6.206791032688915
 mnt_best       : 5.652232391128106
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 7.01702 (QuantReg: 3.59413) QuantErr: 3.59413 batch_time=32.75300 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 6.90289 (QuantReg: 3.77754) QuantErr: 3.77754 batch_time=0.98641 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 6.44556 (QuantReg: 4.57808) QuantErr: 4.57808 batch_time=2.70837 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 6.13177 (QuantReg: 5.49128) QuantErr: 5.49128 batch_time=1.00531 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 6.14934 (QuantReg: 6.06904) QuantErr: 6.06904 batch_time=0.92511 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 5.84079 (QuantReg: 6.98664) QuantErr: 6.98664 batch_time=1.00397 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 5.61914 (QuantReg: 7.20684) QuantErr: 7.20684 batch_time=0.91712 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 5.98795 (QuantReg: 10.03718) QuantErr: 10.03718 batch_time=0.92204 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 5.08508 (QuantReg: 9.38529) QuantErr: 9.38529 batch_time=0.96653 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 5.45357 (QuantReg: 9.84642) QuantErr: 9.84642 batch_time=0.98214 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 5.42742 (QuantReg: 9.84158) QuantErr: 9.84158 batch_time=1.03121 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 5.03619 (QuantReg: 10.40193) QuantErr: 10.40193 batch_time=0.98885 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 5.08599 (QuantReg: 10.49106) QuantErr: 10.49106 batch_time=0.98140 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 5.18431 (QuantReg: 12.86250) QuantErr: 12.86250 batch_time=0.97506 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 5.30022 (QuantReg: 12.02941) QuantErr: 12.02941 batch_time=0.95761 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 4.56831 (QuantReg: 14.11454) QuantErr: 14.11454 batch_time=1.00046 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 4.74184 (QuantReg: 12.51161) QuantErr: 12.51161 batch_time=0.92933 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 4.95900 (QuantReg: 13.35147) QuantErr: 13.35147 batch_time=0.95013 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 5.02757 (QuantReg: 12.85251) QuantErr: 12.85251 batch_time=1.49267 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 4.92415 (QuantReg: 14.26878) QuantErr: 14.26878 batch_time=6.91202 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 4.75378 (QuantReg: 14.55404) QuantErr: 14.55404 batch_time=0.94807 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 4.63703 (QuantReg: 14.80769) QuantErr: 14.80769 batch_time=0.93746 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 4.55476 (QuantReg: 14.50089) QuantErr: 14.50089 batch_time=0.90195 
Train Epoch: 2 codebook_update_time=1.83773
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch2.pth ...
Done in 11.612s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch2.pth ...
Done in 23.464s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 5.424358850479126
 quant_reg      : 10.23915901851654
 quant_err      : 10.23915901851654
 learning_rate  : 1.9e-05
 n_samples      : 64000
 n_steps        : 500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 6.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 24.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 38.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 73.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 18.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 51.525
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 18.672528700292037
 MSRVTT_jsfusion_test/v2t_metrics/R1: 6.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 25.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 38.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 73.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 52.911
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 18.673077446590145
 mnt_best       : 18.672528700292037
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 4.53523 (QuantReg: 8.12148) QuantErr: 8.12148 batch_time=32.39993 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 4.07147 (QuantReg: 8.23518) QuantErr: 8.23518 batch_time=0.97431 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 4.70174 (QuantReg: 8.27071) QuantErr: 8.27071 batch_time=0.96165 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 4.73052 (QuantReg: 8.66160) QuantErr: 8.66160 batch_time=0.96992 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 4.53682 (QuantReg: 9.09087) QuantErr: 9.09087 batch_time=1.00190 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 4.00258 (QuantReg: 9.56769) QuantErr: 9.56769 batch_time=0.95984 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 4.08891 (QuantReg: 8.97258) QuantErr: 8.97258 batch_time=5.35488 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 4.02429 (QuantReg: 9.63496) QuantErr: 9.63496 batch_time=0.96027 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 3.93850 (QuantReg: 9.53036) QuantErr: 9.53036 batch_time=0.96930 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 4.34660 (QuantReg: 9.33809) QuantErr: 9.33809 batch_time=0.97623 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 4.63871 (QuantReg: 10.57006) QuantErr: 10.57006 batch_time=0.97366 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 4.09245 (QuantReg: 9.83315) QuantErr: 9.83315 batch_time=0.94604 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 4.28288 (QuantReg: 10.63818) QuantErr: 10.63818 batch_time=1.02557 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 3.74670 (QuantReg: 10.10635) QuantErr: 10.10635 batch_time=1.05611 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 4.05089 (QuantReg: 11.13665) QuantErr: 11.13665 batch_time=1.04554 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 4.06136 (QuantReg: 10.62087) QuantErr: 10.62087 batch_time=0.95320 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 3.67122 (QuantReg: 10.96291) QuantErr: 10.96291 batch_time=0.90715 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 3.84146 (QuantReg: 10.78650) QuantErr: 10.78650 batch_time=0.92799 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 3.37843 (QuantReg: 11.78949) QuantErr: 11.78949 batch_time=0.97374 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 3.76073 (QuantReg: 11.21923) QuantErr: 11.21923 batch_time=0.99026 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 3.87638 (QuantReg: 11.69628) QuantErr: 11.69628 batch_time=0.92347 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 4.63682 (QuantReg: 11.54513) QuantErr: 11.54513 batch_time=0.94461 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 3.48229 (QuantReg: 12.09723) QuantErr: 12.09723 batch_time=0.94675 
Train Epoch: 3 codebook_update_time=1.87231
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch3.pth ...
Done in 11.451s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch3.pth ...
Done in 22.856s
removing stale ckpt [epoch 2] [took 0.03s]
 epoch          : 3
 loss           : 4.098606305122376
 quant_reg      : 10.114148504257201
 quant_err      : 10.114148504257201
 learning_rate  : 1.805e-05
 n_samples      : 96000
 n_steps        : 750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 9.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 32.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 47.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 80.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 11.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 40.018
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.73248088514102
 MSRVTT_jsfusion_test/v2t_metrics/R1: 10.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 33.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 46.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 79.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 12.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 41.1415
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.405951134132213
 mnt_best       : 24.73248088514102
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 4.41904 (QuantReg: 9.02146) QuantErr: 9.02146 batch_time=44.57084 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 3.95179 (QuantReg: 9.57405) QuantErr: 9.57405 batch_time=1.10719 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 3.51215 (QuantReg: 9.01416) QuantErr: 9.01416 batch_time=0.90060 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 3.74746 (QuantReg: 9.61735) QuantErr: 9.61735 batch_time=0.96038 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 3.67254 (QuantReg: 9.76642) QuantErr: 9.76642 batch_time=0.93926 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 3.75506 (QuantReg: 10.25710) QuantErr: 10.25710 batch_time=0.98238 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 3.92846 (QuantReg: 9.74849) QuantErr: 9.74849 batch_time=0.97028 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 3.43258 (QuantReg: 9.75816) QuantErr: 9.75816 batch_time=0.96509 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 3.40402 (QuantReg: 10.56158) QuantErr: 10.56158 batch_time=0.93015 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 3.06566 (QuantReg: 10.94719) QuantErr: 10.94719 batch_time=0.97041 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 3.33523 (QuantReg: 10.51681) QuantErr: 10.51681 batch_time=0.86529 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 3.09144 (QuantReg: 10.54238) QuantErr: 10.54238 batch_time=0.97562 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 3.37573 (QuantReg: 10.25210) QuantErr: 10.25210 batch_time=0.91491 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 3.61729 (QuantReg: 10.64485) QuantErr: 10.64485 batch_time=0.93936 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 3.84124 (QuantReg: 10.61423) QuantErr: 10.61423 batch_time=0.94563 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 3.59680 (QuantReg: 11.01027) QuantErr: 11.01027 batch_time=0.91574 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 3.31980 (QuantReg: 10.59215) QuantErr: 10.59215 batch_time=0.93221 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 3.13286 (QuantReg: 11.25523) QuantErr: 11.25523 batch_time=1.20074 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 2.93578 (QuantReg: 11.06846) QuantErr: 11.06846 batch_time=1.10409 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 3.16489 (QuantReg: 11.34843) QuantErr: 11.34843 batch_time=0.90699 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 3.17752 (QuantReg: 11.70614) QuantErr: 11.70614 batch_time=0.95648 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 3.22727 (QuantReg: 11.43022) QuantErr: 11.43022 batch_time=0.92019 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 3.04438 (QuantReg: 11.56193) QuantErr: 11.56193 batch_time=0.91485 
Train Epoch: 4 codebook_update_time=1.70999
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch4.pth ...
Done in 29.248s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch4.pth ...
Done in 40.458s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 4
 loss           : 3.5073723478317262
 quant_reg      : 10.505402263641358
 quant_err      : 10.505402263641358
 learning_rate  : 1.71475e-05
 n_samples      : 128000
 n_steps        : 1000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 13.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 36.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 51.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 82.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.919
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.82959919863306
 MSRVTT_jsfusion_test/v2t_metrics/R1: 11.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 36.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 51.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 82.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 10.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 34.678
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.90685203167781
 mnt_best       : 28.82959919863306
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 3.17781 (QuantReg: 11.10160) QuantErr: 11.10160 batch_time=29.27460 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 3.54663 (QuantReg: 10.32556) QuantErr: 10.32556 batch_time=0.99139 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 3.42772 (QuantReg: 10.79662) QuantErr: 10.79662 batch_time=0.90961 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 3.14198 (QuantReg: 10.99249) QuantErr: 10.99249 batch_time=0.91040 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 3.52512 (QuantReg: 10.33237) QuantErr: 10.33237 batch_time=0.92445 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 3.21850 (QuantReg: 10.85848) QuantErr: 10.85848 batch_time=0.92558 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 3.34921 (QuantReg: 10.32959) QuantErr: 10.32959 batch_time=1.06501 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 2.88913 (QuantReg: 10.97242) QuantErr: 10.97242 batch_time=0.96011 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 3.17454 (QuantReg: 10.94588) QuantErr: 10.94588 batch_time=0.92760 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 2.86925 (QuantReg: 10.87292) QuantErr: 10.87292 batch_time=1.19848 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 2.95381 (QuantReg: 11.36944) QuantErr: 11.36944 batch_time=0.99583 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 3.04091 (QuantReg: 11.23054) QuantErr: 11.23054 batch_time=0.89951 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 2.78175 (QuantReg: 10.96769) QuantErr: 10.96769 batch_time=0.95991 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 2.83699 (QuantReg: 11.68920) QuantErr: 11.68920 batch_time=0.98194 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 2.80254 (QuantReg: 11.46029) QuantErr: 11.46029 batch_time=0.88352 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 3.12340 (QuantReg: 11.73655) QuantErr: 11.73655 batch_time=0.94855 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 2.74646 (QuantReg: 11.74212) QuantErr: 11.74212 batch_time=0.95308 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 2.88388 (QuantReg: 11.74543) QuantErr: 11.74543 batch_time=0.96605 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 3.51582 (QuantReg: 11.75576) QuantErr: 11.75576 batch_time=0.95817 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 3.03463 (QuantReg: 11.52388) QuantErr: 11.52388 batch_time=2.01277 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 3.12859 (QuantReg: 11.53335) QuantErr: 11.53335 batch_time=0.90964 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 2.50921 (QuantReg: 11.71417) QuantErr: 11.71417 batch_time=0.92327 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 3.70886 (QuantReg: 11.97993) QuantErr: 11.97993 batch_time=0.93461 
Train Epoch: 5 codebook_update_time=2.00216
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch5.pth ...
Done in 11.348s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch5.pth ...
Done in 24.708s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 5
 loss           : 3.103938196182251
 quant_reg      : 11.28231481552124
 quant_err      : 11.28231481552124
 learning_rate  : 1.6290125e-05
 n_samples      : 160000
 n_steps        : 1250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 15.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 39.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 53.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 83.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 34.187
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 31.908999272420818
 MSRVTT_jsfusion_test/v2t_metrics/R1: 14.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 38.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 9.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 31.719
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.76557687893297
 mnt_best       : 31.908999272420818
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 2.46487 (QuantReg: 11.07335) QuantErr: 11.07335 batch_time=37.01370 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 2.73939 (QuantReg: 11.70261) QuantErr: 11.70261 batch_time=0.88205 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 2.54660 (QuantReg: 11.77385) QuantErr: 11.77385 batch_time=1.53580 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 3.02294 (QuantReg: 11.61400) QuantErr: 11.61400 batch_time=0.95926 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 3.33153 (QuantReg: 11.79185) QuantErr: 11.79185 batch_time=0.93230 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 2.87068 (QuantReg: 11.54889) QuantErr: 11.54889 batch_time=0.96097 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 2.99848 (QuantReg: 12.17841) QuantErr: 12.17841 batch_time=0.97459 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 2.86316 (QuantReg: 11.85867) QuantErr: 11.85867 batch_time=0.92374 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 2.78977 (QuantReg: 11.71375) QuantErr: 11.71375 batch_time=1.01895 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 2.57292 (QuantReg: 12.01605) QuantErr: 12.01605 batch_time=0.97451 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 3.25211 (QuantReg: 11.82637) QuantErr: 11.82637 batch_time=0.91109 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 2.76665 (QuantReg: 11.99751) QuantErr: 11.99751 batch_time=0.96865 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 3.03396 (QuantReg: 11.69678) QuantErr: 11.69678 batch_time=0.94832 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 2.77629 (QuantReg: 11.59154) QuantErr: 11.59154 batch_time=0.93235 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 2.47759 (QuantReg: 12.70865) QuantErr: 12.70865 batch_time=0.94280 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 2.83831 (QuantReg: 11.74438) QuantErr: 11.74438 batch_time=0.93798 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 3.05024 (QuantReg: 12.01515) QuantErr: 12.01515 batch_time=0.94891 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 2.84345 (QuantReg: 11.95888) QuantErr: 11.95888 batch_time=0.92935 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 2.54374 (QuantReg: 12.39259) QuantErr: 12.39259 batch_time=0.91901 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 2.59466 (QuantReg: 12.75879) QuantErr: 12.75879 batch_time=0.91943 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 3.12606 (QuantReg: 12.19607) QuantErr: 12.19607 batch_time=0.98761 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 2.97998 (QuantReg: 12.30149) QuantErr: 12.30149 batch_time=1.00170 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 2.56905 (QuantReg: 12.22343) QuantErr: 12.22343 batch_time=0.94753 
Train Epoch: 6 codebook_update_time=1.85564
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch6.pth ...
Done in 11.366s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch6.pth ...
Done in 22.482s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 6
 loss           : 2.845298850059509
 quant_reg      : 11.994772911071777
 quant_err      : 11.994772911071777
 learning_rate  : 1.547561875e-05
 n_samples      : 192000
 n_steps        : 1500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.702
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 34.07134671876686
 MSRVTT_jsfusion_test/v2t_metrics/R1: 15.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 56.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 84.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.6805
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.42644349499048
 mnt_best       : 34.07134671876686
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 2.71637 (QuantReg: 12.19452) QuantErr: 12.19452 batch_time=34.66906 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 2.85204 (QuantReg: 12.31967) QuantErr: 12.31967 batch_time=1.00488 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 2.29233 (QuantReg: 12.18498) QuantErr: 12.18498 batch_time=0.89078 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 2.42701 (QuantReg: 12.39354) QuantErr: 12.39354 batch_time=0.94108 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 2.88019 (QuantReg: 11.88167) QuantErr: 11.88167 batch_time=0.90732 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 2.44305 (QuantReg: 12.50069) QuantErr: 12.50069 batch_time=0.90071 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 2.43266 (QuantReg: 12.15127) QuantErr: 12.15127 batch_time=0.95499 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 2.69548 (QuantReg: 12.58985) QuantErr: 12.58985 batch_time=0.92488 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 2.58117 (QuantReg: 12.77910) QuantErr: 12.77910 batch_time=0.94150 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 2.20056 (QuantReg: 12.15302) QuantErr: 12.15302 batch_time=1.16455 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 2.48988 (QuantReg: 12.76624) QuantErr: 12.76624 batch_time=1.11312 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 2.36966 (QuantReg: 12.66845) QuantErr: 12.66845 batch_time=0.97560 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 2.79817 (QuantReg: 13.21059) QuantErr: 13.21059 batch_time=0.92996 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 3.09839 (QuantReg: 12.28126) QuantErr: 12.28126 batch_time=0.94610 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 2.71945 (QuantReg: 12.65611) QuantErr: 12.65611 batch_time=0.95961 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 3.25871 (QuantReg: 13.28324) QuantErr: 13.28324 batch_time=1.06571 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 2.57939 (QuantReg: 13.06782) QuantErr: 13.06782 batch_time=0.94125 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 3.22869 (QuantReg: 12.85829) QuantErr: 12.85829 batch_time=1.00216 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 2.36239 (QuantReg: 12.92698) QuantErr: 12.92698 batch_time=0.96886 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 2.63610 (QuantReg: 12.69041) QuantErr: 12.69041 batch_time=0.90592 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 2.67159 (QuantReg: 12.87861) QuantErr: 12.87861 batch_time=0.90005 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 2.47842 (QuantReg: 13.49173) QuantErr: 13.49173 batch_time=0.90290 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 2.62980 (QuantReg: 12.74806) QuantErr: 12.74806 batch_time=0.93308 
Train Epoch: 7 codebook_update_time=1.67448
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch7.pth ...
Done in 23.893s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 7
 loss           : 2.6123549194335935
 quant_reg      : 12.605710403442384
 quant_err      : 12.605710403442384
 learning_rate  : 1.47018378125e-05
 n_samples      : 224000
 n_steps        : 1750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 42.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 57.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 86.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 31.306
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 33.821719639555056
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 42.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 55.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 85.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.2765
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.221301550039655
 mnt_best       : 34.07134671876686
 not_improved_count: 1
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 2.50877 (QuantReg: 12.63520) QuantErr: 12.63520 batch_time=30.35329 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 2.33659 (QuantReg: 12.34136) QuantErr: 12.34136 batch_time=0.91303 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 2.48395 (QuantReg: 12.30443) QuantErr: 12.30443 batch_time=0.97640 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 2.85807 (QuantReg: 12.60335) QuantErr: 12.60335 batch_time=0.98031 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 2.41956 (QuantReg: 12.85806) QuantErr: 12.85806 batch_time=1.04252 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 2.72266 (QuantReg: 12.84640) QuantErr: 12.84640 batch_time=0.93676 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 2.74498 (QuantReg: 12.81339) QuantErr: 12.81339 batch_time=3.29873 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 2.44502 (QuantReg: 13.04124) QuantErr: 13.04124 batch_time=0.91732 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 2.32284 (QuantReg: 13.20116) QuantErr: 13.20116 batch_time=0.94816 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 2.43589 (QuantReg: 12.85992) QuantErr: 12.85992 batch_time=1.00351 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 2.28442 (QuantReg: 12.98008) QuantErr: 12.98008 batch_time=0.98476 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 2.68094 (QuantReg: 13.58034) QuantErr: 13.58034 batch_time=0.98002 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 2.84370 (QuantReg: 13.17529) QuantErr: 13.17529 batch_time=6.52749 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 2.77426 (QuantReg: 12.77742) QuantErr: 12.77742 batch_time=0.89138 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 2.67675 (QuantReg: 13.08780) QuantErr: 13.08780 batch_time=1.08885 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 2.58307 (QuantReg: 13.09278) QuantErr: 13.09278 batch_time=0.89856 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 2.23800 (QuantReg: 13.51679) QuantErr: 13.51679 batch_time=0.96024 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 2.79332 (QuantReg: 12.67534) QuantErr: 12.67534 batch_time=0.92204 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 2.18047 (QuantReg: 13.40542) QuantErr: 13.40542 batch_time=0.91099 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 1.90916 (QuantReg: 13.38227) QuantErr: 13.38227 batch_time=0.96513 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 2.58002 (QuantReg: 13.38357) QuantErr: 13.38357 batch_time=0.96817 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 2.82008 (QuantReg: 13.10613) QuantErr: 13.10613 batch_time=0.92485 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 2.26333 (QuantReg: 13.44009) QuantErr: 13.44009 batch_time=0.94789 
Train Epoch: 8 codebook_update_time=1.69230
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch8.pth ...
Done in 15.007s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch8.pth ...
Done in 26.277s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 2.4663368978500366
 quant_reg      : 12.98315299987793
 quant_err      : 12.98315299987793
 learning_rate  : 1.3966745921874999e-05
 n_samples      : 256000
 n_steps        : 2000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 16.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 43.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 58.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 85.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 29.81
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.04252138122261
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 43.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 57.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 8.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 30.804
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.564221513252704
 mnt_best       : 35.04252138122261
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 1.84487 (QuantReg: 13.19439) QuantErr: 13.19439 batch_time=28.90711 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 2.25644 (QuantReg: 13.55181) QuantErr: 13.55181 batch_time=0.91249 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 2.34637 (QuantReg: 13.47284) QuantErr: 13.47284 batch_time=0.95897 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 2.54107 (QuantReg: 13.16794) QuantErr: 13.16794 batch_time=1.32197 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 2.24901 (QuantReg: 12.78832) QuantErr: 12.78832 batch_time=0.94984 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 2.22648 (QuantReg: 13.51905) QuantErr: 13.51905 batch_time=0.94195 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 1.95843 (QuantReg: 13.23476) QuantErr: 13.23476 batch_time=1.84099 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 2.26064 (QuantReg: 13.83502) QuantErr: 13.83502 batch_time=0.89368 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 2.10003 (QuantReg: 13.09937) QuantErr: 13.09937 batch_time=0.86626 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 2.70611 (QuantReg: 13.00881) QuantErr: 13.00881 batch_time=0.99041 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 2.19677 (QuantReg: 13.15735) QuantErr: 13.15735 batch_time=0.96739 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 1.82602 (QuantReg: 13.62952) QuantErr: 13.62952 batch_time=0.90574 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 2.55937 (QuantReg: 13.13681) QuantErr: 13.13681 batch_time=2.45273 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 2.24416 (QuantReg: 13.40150) QuantErr: 13.40150 batch_time=0.93711 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 2.21582 (QuantReg: 13.39546) QuantErr: 13.39546 batch_time=0.99605 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 2.50154 (QuantReg: 13.73148) QuantErr: 13.73148 batch_time=0.99129 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 3.14302 (QuantReg: 13.13132) QuantErr: 13.13132 batch_time=0.94032 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 2.59679 (QuantReg: 13.22370) QuantErr: 13.22370 batch_time=1.29286 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 2.42437 (QuantReg: 13.73668) QuantErr: 13.73668 batch_time=0.97024 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 1.96389 (QuantReg: 14.04005) QuantErr: 14.04005 batch_time=0.96865 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 1.50417 (QuantReg: 14.18342) QuantErr: 14.18342 batch_time=1.01799 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 2.13043 (QuantReg: 14.29761) QuantErr: 14.29761 batch_time=0.94445 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 2.42467 (QuantReg: 13.47423) QuantErr: 13.47423 batch_time=0.96066 
Train Epoch: 9 codebook_update_time=1.84155
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch9.pth ...
Done in 11.042s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch9.pth ...
Done in 21.521s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 2.3228577609062193
 quant_reg      : 13.401194896697998
 quant_err      : 13.401194896697998
 learning_rate  : 1.3268408625781248e-05
 n_samples      : 288000
 n_steps        : 2250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 44.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 59.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.354
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 35.877546914162934
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 46.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 59.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 86.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 27.712
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.97879476431726
 mnt_best       : 35.877546914162934
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 1.87299 (QuantReg: 13.76980) QuantErr: 13.76980 batch_time=29.08093 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 2.22026 (QuantReg: 13.82216) QuantErr: 13.82216 batch_time=0.91185 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 2.32318 (QuantReg: 13.61902) QuantErr: 13.61902 batch_time=0.95536 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 2.47852 (QuantReg: 13.36021) QuantErr: 13.36021 batch_time=0.91227 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 2.29465 (QuantReg: 13.84867) QuantErr: 13.84867 batch_time=1.45828 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 2.06031 (QuantReg: 13.81310) QuantErr: 13.81310 batch_time=0.90589 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 2.30968 (QuantReg: 13.77792) QuantErr: 13.77792 batch_time=0.90241 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 2.35116 (QuantReg: 13.40857) QuantErr: 13.40857 batch_time=0.91210 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 2.10802 (QuantReg: 13.50336) QuantErr: 13.50336 batch_time=0.97662 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 2.00886 (QuantReg: 13.88383) QuantErr: 13.88383 batch_time=0.94425 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 1.83483 (QuantReg: 14.19246) QuantErr: 14.19246 batch_time=0.90253 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 2.47413 (QuantReg: 13.81083) QuantErr: 13.81083 batch_time=0.97600 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 2.09193 (QuantReg: 13.54428) QuantErr: 13.54428 batch_time=0.97331 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 2.24514 (QuantReg: 14.17810) QuantErr: 14.17810 batch_time=0.94910 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 2.11032 (QuantReg: 13.52281) QuantErr: 13.52281 batch_time=0.95867 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 2.13632 (QuantReg: 13.43034) QuantErr: 13.43034 batch_time=1.42452 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 1.92969 (QuantReg: 14.28326) QuantErr: 14.28326 batch_time=0.92161 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 2.09987 (QuantReg: 14.41071) QuantErr: 14.41071 batch_time=0.90833 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 2.12729 (QuantReg: 14.34742) QuantErr: 14.34742 batch_time=1.02915 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 2.01988 (QuantReg: 14.45647) QuantErr: 14.45647 batch_time=0.90758 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 1.81555 (QuantReg: 14.34044) QuantErr: 14.34044 batch_time=0.95171 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 1.80815 (QuantReg: 14.33976) QuantErr: 14.33976 batch_time=0.97766 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 1.77354 (QuantReg: 14.03878) QuantErr: 14.03878 batch_time=0.92165 
Train Epoch: 10 codebook_update_time=1.69209
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch10.pth ...
Done in 11.276s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch10.pth ...
Done in 23.720s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 2.1712232708930967
 quant_reg      : 13.841436546325683
 quant_err      : 13.841436546325683
 learning_rate  : 1.2604988194492186e-05
 n_samples      : 320000
 n_steps        : 2500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 17.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 60.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.617
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 36.773179693749526
 MSRVTT_jsfusion_test/v2t_metrics/R1: 18.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.961
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.324728742588945
 mnt_best       : 36.773179693749526
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 1.93156 (QuantReg: 13.83332) QuantErr: 13.83332 batch_time=28.41601 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 2.14626 (QuantReg: 13.75519) QuantErr: 13.75519 batch_time=1.40088 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 1.86565 (QuantReg: 13.79788) QuantErr: 13.79788 batch_time=0.93204 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 2.31121 (QuantReg: 13.96164) QuantErr: 13.96164 batch_time=1.19698 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 2.39499 (QuantReg: 14.25036) QuantErr: 14.25036 batch_time=0.98372 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 1.87954 (QuantReg: 14.01311) QuantErr: 14.01311 batch_time=0.99482 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 2.18965 (QuantReg: 14.19204) QuantErr: 14.19204 batch_time=0.92575 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 2.46704 (QuantReg: 14.06478) QuantErr: 14.06478 batch_time=0.91950 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 2.24659 (QuantReg: 14.34724) QuantErr: 14.34724 batch_time=0.97037 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 2.54108 (QuantReg: 14.22346) QuantErr: 14.22346 batch_time=1.07552 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 2.22436 (QuantReg: 13.89672) QuantErr: 13.89672 batch_time=0.93197 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 2.67775 (QuantReg: 14.07904) QuantErr: 14.07904 batch_time=1.00819 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 2.32204 (QuantReg: 14.15905) QuantErr: 14.15905 batch_time=0.91625 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 1.69969 (QuantReg: 14.41447) QuantErr: 14.41447 batch_time=1.27421 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 1.97584 (QuantReg: 14.09743) QuantErr: 14.09743 batch_time=0.94383 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 2.70536 (QuantReg: 13.76459) QuantErr: 13.76459 batch_time=2.66208 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 2.07422 (QuantReg: 14.19648) QuantErr: 14.19648 batch_time=0.92173 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 1.99970 (QuantReg: 14.12578) QuantErr: 14.12578 batch_time=1.11221 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 2.19947 (QuantReg: 13.93186) QuantErr: 13.93186 batch_time=0.91376 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 2.10473 (QuantReg: 14.36239) QuantErr: 14.36239 batch_time=0.91321 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 1.89015 (QuantReg: 14.81385) QuantErr: 14.81385 batch_time=0.87831 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 1.65221 (QuantReg: 14.59063) QuantErr: 14.59063 batch_time=0.97922 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 1.70619 (QuantReg: 14.49242) QuantErr: 14.49242 batch_time=0.96081 
Train Epoch: 11 codebook_update_time=1.82280
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch11.pth ...
Done in 10.994s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch11.pth ...
Done in 21.880s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 2.094702980518341
 quant_reg      : 14.13588438796997
 quant_err      : 14.13588438796997
 learning_rate  : 1.1974738784767577e-05
 n_samples      : 352000
 n_steps        : 2750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 46.5
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.436
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 37.946221248839265
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 45.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 7.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.597
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.62439473736401
 mnt_best       : 37.946221248839265
 not_improved_count: 0
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 2.61214 (QuantReg: 13.69654) QuantErr: 13.69654 batch_time=37.91902 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 2.12480 (QuantReg: 13.99149) QuantErr: 13.99149 batch_time=1.03643 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 1.82070 (QuantReg: 14.50130) QuantErr: 14.50130 batch_time=0.90662 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 2.03084 (QuantReg: 14.07161) QuantErr: 14.07161 batch_time=0.96260 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 2.01642 (QuantReg: 14.40558) QuantErr: 14.40558 batch_time=0.96244 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 2.20106 (QuantReg: 13.75885) QuantErr: 13.75885 batch_time=0.94466 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 2.12748 (QuantReg: 14.50060) QuantErr: 14.50060 batch_time=0.90100 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 2.29096 (QuantReg: 14.61816) QuantErr: 14.61816 batch_time=1.23547 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 2.51499 (QuantReg: 14.04959) QuantErr: 14.04959 batch_time=0.96400 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 2.16783 (QuantReg: 14.01913) QuantErr: 14.01913 batch_time=0.95526 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 1.92830 (QuantReg: 14.70532) QuantErr: 14.70532 batch_time=0.91334 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 1.93278 (QuantReg: 14.61211) QuantErr: 14.61211 batch_time=0.93634 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 1.94828 (QuantReg: 14.52110) QuantErr: 14.52110 batch_time=2.01315 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 2.01007 (QuantReg: 14.47675) QuantErr: 14.47675 batch_time=0.89979 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 2.00971 (QuantReg: 14.38321) QuantErr: 14.38321 batch_time=1.08931 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 1.95146 (QuantReg: 14.28090) QuantErr: 14.28090 batch_time=1.04071 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 1.79982 (QuantReg: 14.66872) QuantErr: 14.66872 batch_time=0.93374 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 2.22600 (QuantReg: 14.64910) QuantErr: 14.64910 batch_time=0.90087 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 1.95171 (QuantReg: 14.51005) QuantErr: 14.51005 batch_time=0.89492 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 2.13262 (QuantReg: 14.33471) QuantErr: 14.33471 batch_time=1.02417 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 2.06069 (QuantReg: 14.44377) QuantErr: 14.44377 batch_time=0.90103 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 2.17394 (QuantReg: 14.68787) QuantErr: 14.68787 batch_time=0.98363 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 1.33653 (QuantReg: 15.10424) QuantErr: 15.10424 batch_time=0.97659 
Train Epoch: 12 codebook_update_time=1.68966
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch12.pth ...
Done in 11.614s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch12.pth ...
Done in 23.038s
removing stale ckpt [epoch 11] [took 0.00s]
 epoch          : 12
 loss           : 1.978166717529297
 quant_reg      : 14.472517227172851
 quant_err      : 14.472517227172851
 learning_rate  : 1.1376001845529198e-05
 n_samples      : 384000
 n_steps        : 3000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 61.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.433
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.04415918975242
 MSRVTT_jsfusion_test/v2t_metrics/R1: 17.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 60.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.3375
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.94093327016191
 mnt_best       : 38.04415918975242
 not_improved_count: 0
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 2.08975 (QuantReg: 14.48830) QuantErr: 14.48830 batch_time=34.36180 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 1.86515 (QuantReg: 14.62930) QuantErr: 14.62930 batch_time=0.92812 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 2.20327 (QuantReg: 14.17117) QuantErr: 14.17117 batch_time=0.90182 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 1.53398 (QuantReg: 14.47392) QuantErr: 14.47392 batch_time=0.88538 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 1.88404 (QuantReg: 14.43652) QuantErr: 14.43652 batch_time=0.94481 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 1.71366 (QuantReg: 14.46061) QuantErr: 14.46061 batch_time=0.86657 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 1.59654 (QuantReg: 14.85097) QuantErr: 14.85097 batch_time=0.92520 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 1.70285 (QuantReg: 14.74530) QuantErr: 14.74530 batch_time=0.94129 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 1.74269 (QuantReg: 14.77121) QuantErr: 14.77121 batch_time=0.94569 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 1.51969 (QuantReg: 14.68976) QuantErr: 14.68976 batch_time=0.95864 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 1.74121 (QuantReg: 14.56892) QuantErr: 14.56892 batch_time=0.89569 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 1.81192 (QuantReg: 14.48050) QuantErr: 14.48050 batch_time=0.91139 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 2.07973 (QuantReg: 14.59914) QuantErr: 14.59914 batch_time=0.92707 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 2.03637 (QuantReg: 14.56265) QuantErr: 14.56265 batch_time=0.90598 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 1.82887 (QuantReg: 14.49787) QuantErr: 14.49787 batch_time=0.99445 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 1.82484 (QuantReg: 14.50947) QuantErr: 14.50947 batch_time=0.98652 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 1.74567 (QuantReg: 14.99789) QuantErr: 14.99789 batch_time=1.05720 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 1.66173 (QuantReg: 14.56537) QuantErr: 14.56537 batch_time=1.01333 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 1.57669 (QuantReg: 14.87376) QuantErr: 14.87376 batch_time=0.93978 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 2.02000 (QuantReg: 15.04495) QuantErr: 15.04495 batch_time=0.96430 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 1.71071 (QuantReg: 14.96191) QuantErr: 14.96191 batch_time=0.92662 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 1.67830 (QuantReg: 14.86715) QuantErr: 14.86715 batch_time=0.96325 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 1.99515 (QuantReg: 14.71180) QuantErr: 14.71180 batch_time=1.06752 
Train Epoch: 13 codebook_update_time=1.74308
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch13.pth ...
Done in 11.844s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch13.pth ...
Done in 23.168s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 1.9190941877365113
 quant_reg      : 14.678930751800538
 quant_err      : 14.678930751800538
 learning_rate  : 1.0807201753252737e-05
 n_samples      : 416000
 n_steps        : 3250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 19.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 47.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.533
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.67225853861698
 MSRVTT_jsfusion_test/v2t_metrics/R1: 20.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.4635
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.562013363485256
 mnt_best       : 38.67225853861698
 not_improved_count: 0
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 1.97708 (QuantReg: 15.04557) QuantErr: 15.04557 batch_time=31.18802 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 1.85914 (QuantReg: 14.69805) QuantErr: 14.69805 batch_time=0.89683 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 2.07560 (QuantReg: 14.71085) QuantErr: 14.71085 batch_time=0.94611 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 1.35986 (QuantReg: 15.11191) QuantErr: 15.11191 batch_time=0.94874 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 2.36284 (QuantReg: 14.86612) QuantErr: 14.86612 batch_time=0.88854 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 1.75122 (QuantReg: 14.83032) QuantErr: 14.83032 batch_time=0.92299 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 1.96486 (QuantReg: 14.29847) QuantErr: 14.29847 batch_time=1.25382 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 1.46403 (QuantReg: 14.87214) QuantErr: 14.87214 batch_time=0.96061 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 2.20416 (QuantReg: 15.09789) QuantErr: 15.09789 batch_time=0.95149 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 1.51158 (QuantReg: 14.31876) QuantErr: 14.31876 batch_time=0.93196 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 1.70800 (QuantReg: 14.68949) QuantErr: 14.68949 batch_time=0.95651 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 1.87077 (QuantReg: 14.60644) QuantErr: 14.60644 batch_time=0.91819 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 1.88194 (QuantReg: 14.58100) QuantErr: 14.58100 batch_time=1.05136 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 2.10262 (QuantReg: 15.10540) QuantErr: 15.10540 batch_time=4.01646 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 1.90144 (QuantReg: 14.90787) QuantErr: 14.90787 batch_time=0.92675 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 1.59332 (QuantReg: 14.86272) QuantErr: 14.86272 batch_time=0.94295 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 1.87387 (QuantReg: 14.55794) QuantErr: 14.55794 batch_time=0.91704 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 1.95408 (QuantReg: 15.23730) QuantErr: 15.23730 batch_time=1.05210 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 2.00114 (QuantReg: 14.46506) QuantErr: 14.46506 batch_time=0.95303 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 1.89136 (QuantReg: 15.22893) QuantErr: 15.22893 batch_time=4.34654 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 2.05614 (QuantReg: 14.87249) QuantErr: 14.87249 batch_time=0.96867 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 1.73657 (QuantReg: 15.13330) QuantErr: 15.13330 batch_time=0.93654 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 1.91568 (QuantReg: 15.41397) QuantErr: 15.41397 batch_time=0.94119 
Train Epoch: 14 codebook_update_time=2.34460
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch14.pth ...
Done in 12.517s
removing stale ckpt [epoch 13] [took 0.04s]
 epoch          : 14
 loss           : 1.8867003774642945
 quant_reg      : 14.862853115081787
 quant_err      : 14.862853115081787
 learning_rate  : 1.02668416655901e-05
 n_samples      : 448000
 n_steps        : 3500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 18.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 62.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 28.104
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 38.57335561800797
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 48.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.7515
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.12774989807129
 mnt_best       : 38.67225853861698
 not_improved_count: 1
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 1.72287 (QuantReg: 14.77785) QuantErr: 14.77785 batch_time=34.83907 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 2.06146 (QuantReg: 14.83519) QuantErr: 14.83519 batch_time=0.98207 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 1.73976 (QuantReg: 14.87178) QuantErr: 14.87178 batch_time=0.87408 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 1.74861 (QuantReg: 15.06234) QuantErr: 15.06234 batch_time=0.95377 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 2.10499 (QuantReg: 14.39252) QuantErr: 14.39252 batch_time=0.90304 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 1.84365 (QuantReg: 15.06769) QuantErr: 15.06769 batch_time=0.90069 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 1.86830 (QuantReg: 14.85887) QuantErr: 14.85887 batch_time=2.27287 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 1.40855 (QuantReg: 15.14871) QuantErr: 15.14871 batch_time=1.00578 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 1.93237 (QuantReg: 14.94285) QuantErr: 14.94285 batch_time=0.93953 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 1.69258 (QuantReg: 15.22314) QuantErr: 15.22314 batch_time=0.98876 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 1.88024 (QuantReg: 15.02106) QuantErr: 15.02106 batch_time=0.95843 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 2.10314 (QuantReg: 14.54384) QuantErr: 14.54384 batch_time=0.90515 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 1.71156 (QuantReg: 14.94934) QuantErr: 14.94934 batch_time=0.87156 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 1.49333 (QuantReg: 14.90578) QuantErr: 14.90578 batch_time=0.95615 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 1.45383 (QuantReg: 15.00553) QuantErr: 15.00553 batch_time=0.92860 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 1.89123 (QuantReg: 15.19379) QuantErr: 15.19379 batch_time=0.90638 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 1.93097 (QuantReg: 14.78199) QuantErr: 14.78199 batch_time=0.98288 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 1.36193 (QuantReg: 15.24311) QuantErr: 15.24311 batch_time=0.91576 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 2.02105 (QuantReg: 15.41585) QuantErr: 15.41585 batch_time=0.97174 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 1.58718 (QuantReg: 15.55374) QuantErr: 15.55374 batch_time=2.65106 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 1.69585 (QuantReg: 15.25782) QuantErr: 15.25782 batch_time=0.95054 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 2.13562 (QuantReg: 15.19802) QuantErr: 15.19802 batch_time=0.92414 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 1.47935 (QuantReg: 15.24244) QuantErr: 15.24244 batch_time=0.88458 
Train Epoch: 15 codebook_update_time=1.77994
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch15.pth ...
Done in 11.106s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch15.pth ...
Done in 22.770s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 1.7913374891281129
 quant_reg      : 15.101330867767334
 quant_err      : 15.101330867767334
 learning_rate  : 9.753499582310594e-06
 n_samples      : 480000
 n_steps        : 3750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 48.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.961
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.65730488607522
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 47.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 26.019
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 39.790632712124214
 mnt_best       : 39.65730488607522
 not_improved_count: 0
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 1.27851 (QuantReg: 15.18181) QuantErr: 15.18181 batch_time=31.52558 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 1.68363 (QuantReg: 14.91276) QuantErr: 14.91276 batch_time=0.96897 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 1.70073 (QuantReg: 15.36941) QuantErr: 15.36941 batch_time=0.94821 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 1.63916 (QuantReg: 15.28623) QuantErr: 15.28623 batch_time=0.97291 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 1.76896 (QuantReg: 14.94155) QuantErr: 14.94155 batch_time=0.93717 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 1.74493 (QuantReg: 15.49982) QuantErr: 15.49982 batch_time=0.93187 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 1.80134 (QuantReg: 15.25446) QuantErr: 15.25446 batch_time=2.70575 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 1.87192 (QuantReg: 15.03439) QuantErr: 15.03439 batch_time=0.95583 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 1.45895 (QuantReg: 15.34309) QuantErr: 15.34309 batch_time=0.92678 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 1.86412 (QuantReg: 15.51902) QuantErr: 15.51902 batch_time=0.96324 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 1.59912 (QuantReg: 15.13201) QuantErr: 15.13201 batch_time=0.91256 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 1.95489 (QuantReg: 15.52283) QuantErr: 15.52283 batch_time=0.91391 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 1.71647 (QuantReg: 14.83457) QuantErr: 14.83457 batch_time=1.19118 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 1.48730 (QuantReg: 15.42063) QuantErr: 15.42063 batch_time=1.28721 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 1.50335 (QuantReg: 15.43275) QuantErr: 15.43275 batch_time=0.93493 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 1.58167 (QuantReg: 15.38560) QuantErr: 15.38560 batch_time=0.90934 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 2.34808 (QuantReg: 15.34752) QuantErr: 15.34752 batch_time=0.94473 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 1.44029 (QuantReg: 15.13417) QuantErr: 15.13417 batch_time=0.95359 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 1.67327 (QuantReg: 15.57219) QuantErr: 15.57219 batch_time=0.87845 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 1.79176 (QuantReg: 15.58656) QuantErr: 15.58656 batch_time=0.91614 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 1.61074 (QuantReg: 15.84409) QuantErr: 15.84409 batch_time=0.92915 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 1.91418 (QuantReg: 15.58796) QuantErr: 15.58796 batch_time=0.91899 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 1.51808 (QuantReg: 15.14534) QuantErr: 15.14534 batch_time=0.90151 
Train Epoch: 16 codebook_update_time=1.73735
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch16.pth ...
Done in 14.220s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch16.pth ...
Done in 25.650s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 1.7432164211273193
 quant_reg      : 15.328203147888184
 quant_err      : 15.328203147888184
 learning_rate  : 9.265824603195063e-06
 n_samples      : 512000
 n_steps        : 4000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.852
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 39.86412375544485
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.0605
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.383689049977136
 mnt_best       : 39.86412375544485
 not_improved_count: 0
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 1.56231 (QuantReg: 15.47337) QuantErr: 15.47337 batch_time=39.37867 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 1.67722 (QuantReg: 15.34550) QuantErr: 15.34550 batch_time=0.91431 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 1.58657 (QuantReg: 15.47903) QuantErr: 15.47903 batch_time=0.95475 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 1.97195 (QuantReg: 15.20479) QuantErr: 15.20479 batch_time=0.94783 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 1.42481 (QuantReg: 15.24973) QuantErr: 15.24973 batch_time=0.94439 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 1.46853 (QuantReg: 15.07724) QuantErr: 15.07724 batch_time=0.93448 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 1.68763 (QuantReg: 15.58274) QuantErr: 15.58274 batch_time=0.96582 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 1.81766 (QuantReg: 15.89675) QuantErr: 15.89675 batch_time=0.92199 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 1.28922 (QuantReg: 15.76390) QuantErr: 15.76390 batch_time=0.95391 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 1.58214 (QuantReg: 15.80774) QuantErr: 15.80774 batch_time=0.91981 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 1.76779 (QuantReg: 15.26629) QuantErr: 15.26629 batch_time=0.92594 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 1.50217 (QuantReg: 15.46128) QuantErr: 15.46128 batch_time=0.97848 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 1.42301 (QuantReg: 15.87632) QuantErr: 15.87632 batch_time=0.92259 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 1.65101 (QuantReg: 15.69044) QuantErr: 15.69044 batch_time=0.92639 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 2.00600 (QuantReg: 15.43097) QuantErr: 15.43097 batch_time=1.03675 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 1.84027 (QuantReg: 15.24996) QuantErr: 15.24996 batch_time=0.97850 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 1.91138 (QuantReg: 15.60410) QuantErr: 15.60410 batch_time=0.94043 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 1.29958 (QuantReg: 15.90351) QuantErr: 15.90351 batch_time=0.95002 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 1.58560 (QuantReg: 15.76266) QuantErr: 15.76266 batch_time=0.92739 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 1.75143 (QuantReg: 15.67547) QuantErr: 15.67547 batch_time=0.88482 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 1.73899 (QuantReg: 15.80598) QuantErr: 15.80598 batch_time=1.34648 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 1.83879 (QuantReg: 15.65211) QuantErr: 15.65211 batch_time=0.94578 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 1.47779 (QuantReg: 15.78644) QuantErr: 15.78644 batch_time=1.04794 
Train Epoch: 17 codebook_update_time=1.82680
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch17.pth ...
Done in 11.404s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch17.pth ...
Done in 23.114s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 1.6884302434921266
 quant_reg      : 15.492783779144288
 quant_err      : 15.492783779144288
 learning_rate  : 8.80253337303531e-06
 n_samples      : 544000
 n_steps        : 4250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 49.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.152
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.207967283007825
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.2
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.8255
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 40.82123718157939
 mnt_best       : 40.207967283007825
 not_improved_count: 0
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 1.28361 (QuantReg: 15.38119) QuantErr: 15.38119 batch_time=31.08124 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 1.23270 (QuantReg: 15.45279) QuantErr: 15.45279 batch_time=1.04871 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 2.14332 (QuantReg: 14.98877) QuantErr: 14.98877 batch_time=2.85377 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 1.58846 (QuantReg: 15.36753) QuantErr: 15.36753 batch_time=0.99053 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 1.62132 (QuantReg: 15.70231) QuantErr: 15.70231 batch_time=0.98637 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 1.98683 (QuantReg: 15.38814) QuantErr: 15.38814 batch_time=0.97374 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 1.62664 (QuantReg: 15.57914) QuantErr: 15.57914 batch_time=2.87385 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 1.53184 (QuantReg: 15.42665) QuantErr: 15.42665 batch_time=0.89814 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 1.48272 (QuantReg: 15.80005) QuantErr: 15.80005 batch_time=0.93235 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 1.69230 (QuantReg: 15.44788) QuantErr: 15.44788 batch_time=0.90289 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 1.55759 (QuantReg: 16.04316) QuantErr: 16.04316 batch_time=0.97982 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 1.61362 (QuantReg: 15.82780) QuantErr: 15.82780 batch_time=0.91792 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 1.79851 (QuantReg: 15.95078) QuantErr: 15.95078 batch_time=0.92411 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 1.51063 (QuantReg: 15.62129) QuantErr: 15.62129 batch_time=0.94302 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 1.81548 (QuantReg: 15.49172) QuantErr: 15.49172 batch_time=0.96976 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 1.61639 (QuantReg: 15.39183) QuantErr: 15.39183 batch_time=0.93099 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 1.84064 (QuantReg: 15.27461) QuantErr: 15.27461 batch_time=1.00845 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 1.62528 (QuantReg: 15.36502) QuantErr: 15.36502 batch_time=0.91242 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 1.54520 (QuantReg: 15.51767) QuantErr: 15.51767 batch_time=0.92610 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 1.72827 (QuantReg: 15.61959) QuantErr: 15.61959 batch_time=0.98559 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 2.00565 (QuantReg: 15.78315) QuantErr: 15.78315 batch_time=0.92627 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 1.49198 (QuantReg: 16.04692) QuantErr: 16.04692 batch_time=0.96335 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 1.79945 (QuantReg: 15.65147) QuantErr: 15.65147 batch_time=0.92138 
Train Epoch: 18 codebook_update_time=1.80065
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch18.pth ...
Done in 12.084s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch18.pth ...
Done in 38.875s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 1.6545728011131287
 quant_reg      : 15.64542448425293
 quant_err      : 15.64542448425293
 learning_rate  : 8.362406704383544e-06
 n_samples      : 576000
 n_steps        : 4500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.053
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.930820733928286
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3035
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.93178476934956
 mnt_best       : 41.930820733928286
 not_improved_count: 0
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 1.92468 (QuantReg: 15.29653) QuantErr: 15.29653 batch_time=31.43363 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 1.74730 (QuantReg: 15.04210) QuantErr: 15.04210 batch_time=0.92388 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 1.46651 (QuantReg: 15.39216) QuantErr: 15.39216 batch_time=0.94551 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 1.79476 (QuantReg: 15.21726) QuantErr: 15.21726 batch_time=0.90137 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 1.37357 (QuantReg: 15.47638) QuantErr: 15.47638 batch_time=0.90945 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 1.22115 (QuantReg: 15.64889) QuantErr: 15.64889 batch_time=0.89606 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 1.44654 (QuantReg: 15.70459) QuantErr: 15.70459 batch_time=0.93422 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 1.33010 (QuantReg: 15.72937) QuantErr: 15.72937 batch_time=0.93470 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 1.40101 (QuantReg: 16.25807) QuantErr: 16.25807 batch_time=0.96029 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 1.60099 (QuantReg: 15.76589) QuantErr: 15.76589 batch_time=0.89154 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 1.41880 (QuantReg: 15.84074) QuantErr: 15.84074 batch_time=0.98230 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 2.27468 (QuantReg: 15.10261) QuantErr: 15.10261 batch_time=0.94567 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 1.37711 (QuantReg: 15.46016) QuantErr: 15.46016 batch_time=0.90875 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 2.09365 (QuantReg: 15.67321) QuantErr: 15.67321 batch_time=1.18388 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 1.47882 (QuantReg: 15.86937) QuantErr: 15.86937 batch_time=0.91208 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 1.57935 (QuantReg: 15.85233) QuantErr: 15.85233 batch_time=0.94699 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 1.81412 (QuantReg: 16.11547) QuantErr: 16.11547 batch_time=0.90509 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 1.59920 (QuantReg: 15.98169) QuantErr: 15.98169 batch_time=1.03687 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 1.50413 (QuantReg: 16.42700) QuantErr: 16.42700 batch_time=0.94374 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 1.20764 (QuantReg: 16.16178) QuantErr: 16.16178 batch_time=0.95028 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 1.68380 (QuantReg: 15.63519) QuantErr: 15.63519 batch_time=0.92179 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 1.13377 (QuantReg: 16.20352) QuantErr: 16.20352 batch_time=0.91693 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 1.79107 (QuantReg: 15.79208) QuantErr: 15.79208 batch_time=0.90657 
Train Epoch: 19 codebook_update_time=1.99010
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch19.pth ...
Done in 11.495s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 1.6140804972648621
 quant_reg      : 15.734696117401123
 quant_err      : 15.734696117401123
 learning_rate  : 7.944286369164366e-06
 n_samples      : 608000
 n_steps        : 4750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 20.7
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 63.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.567
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 40.47295496633019
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3795
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.63523657131759
 mnt_best       : 41.930820733928286
 not_improved_count: 1
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 1.92548 (QuantReg: 15.46391) QuantErr: 15.46391 batch_time=28.91891 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 1.58022 (QuantReg: 16.01576) QuantErr: 16.01576 batch_time=0.96686 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 1.40880 (QuantReg: 16.21427) QuantErr: 16.21427 batch_time=1.12032 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 1.86234 (QuantReg: 15.67772) QuantErr: 15.67772 batch_time=0.93211 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 1.43529 (QuantReg: 16.19282) QuantErr: 16.19282 batch_time=0.97645 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 1.71490 (QuantReg: 15.93748) QuantErr: 15.93748 batch_time=0.92452 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 1.38038 (QuantReg: 15.53966) QuantErr: 15.53966 batch_time=0.89871 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 1.67586 (QuantReg: 15.63176) QuantErr: 15.63176 batch_time=0.92894 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 1.51779 (QuantReg: 15.73704) QuantErr: 15.73704 batch_time=0.91807 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 1.75528 (QuantReg: 16.17886) QuantErr: 16.17886 batch_time=0.98304 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 1.59510 (QuantReg: 16.20007) QuantErr: 16.20007 batch_time=0.92675 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 1.29309 (QuantReg: 16.30291) QuantErr: 16.30291 batch_time=0.95104 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 1.90681 (QuantReg: 15.59248) QuantErr: 15.59248 batch_time=0.94686 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 1.35190 (QuantReg: 15.72393) QuantErr: 15.72393 batch_time=0.88342 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 1.48616 (QuantReg: 16.17701) QuantErr: 16.17701 batch_time=0.94482 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 1.75633 (QuantReg: 15.74025) QuantErr: 15.74025 batch_time=0.93344 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 1.57509 (QuantReg: 16.27229) QuantErr: 16.27229 batch_time=0.92437 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 1.20493 (QuantReg: 16.32878) QuantErr: 16.32878 batch_time=0.91058 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 1.71553 (QuantReg: 16.12684) QuantErr: 16.12684 batch_time=0.94023 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 1.19196 (QuantReg: 15.92677) QuantErr: 15.92677 batch_time=0.92879 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 1.61989 (QuantReg: 15.70903) QuantErr: 15.70903 batch_time=0.89170 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 1.67721 (QuantReg: 16.10487) QuantErr: 16.10487 batch_time=0.92002 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 1.37372 (QuantReg: 16.28457) QuantErr: 16.28457 batch_time=0.91619 
Train Epoch: 20 codebook_update_time=1.85855
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch20.pth ...
Done in 21.111s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch20.pth ...
Done in 32.616s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 1.5603972206115722
 quant_reg      : 15.948006698608399
 quant_err      : 15.948006698608399
 learning_rate  : 7.547072050706148e-06
 n_samples      : 640000
 n_steps        : 5000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.068
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.172523161485564
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 49.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 6.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.405
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.465374902751364
 mnt_best       : 42.172523161485564
 not_improved_count: 0
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 1.60655 (QuantReg: 15.88121) QuantErr: 15.88121 batch_time=33.66781 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 1.54914 (QuantReg: 16.06882) QuantErr: 16.06882 batch_time=0.93542 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 1.07694 (QuantReg: 16.01432) QuantErr: 16.01432 batch_time=0.92858 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 1.66785 (QuantReg: 15.66467) QuantErr: 15.66467 batch_time=0.93852 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 1.45677 (QuantReg: 16.41640) QuantErr: 16.41640 batch_time=0.93348 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 1.34659 (QuantReg: 15.87054) QuantErr: 15.87054 batch_time=1.01161 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 1.65647 (QuantReg: 15.89969) QuantErr: 15.89969 batch_time=0.88423 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 1.77035 (QuantReg: 16.03624) QuantErr: 16.03624 batch_time=0.91770 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 1.24492 (QuantReg: 16.34150) QuantErr: 16.34150 batch_time=1.03135 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 1.58453 (QuantReg: 16.02433) QuantErr: 16.02433 batch_time=0.93815 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 1.74762 (QuantReg: 15.99719) QuantErr: 15.99719 batch_time=0.91436 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 1.30679 (QuantReg: 15.89610) QuantErr: 15.89610 batch_time=0.89936 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 1.19648 (QuantReg: 16.22608) QuantErr: 16.22608 batch_time=0.87676 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 1.82097 (QuantReg: 16.32351) QuantErr: 16.32351 batch_time=2.80309 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 1.78234 (QuantReg: 15.71559) QuantErr: 15.71559 batch_time=0.89033 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 1.36065 (QuantReg: 15.71303) QuantErr: 15.71303 batch_time=0.91852 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 1.81466 (QuantReg: 15.97472) QuantErr: 15.97472 batch_time=1.17084 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 1.93109 (QuantReg: 16.18947) QuantErr: 16.18947 batch_time=0.90677 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 1.16417 (QuantReg: 16.05465) QuantErr: 16.05465 batch_time=0.89344 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 1.93916 (QuantReg: 16.26908) QuantErr: 16.26908 batch_time=0.89334 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 1.63014 (QuantReg: 16.09752) QuantErr: 16.09752 batch_time=0.88582 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 1.86399 (QuantReg: 16.28568) QuantErr: 16.28568 batch_time=0.93333 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 1.65677 (QuantReg: 16.44102) QuantErr: 16.44102 batch_time=1.21276 
Train Epoch: 21 codebook_update_time=2.12762
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch21.pth ...
Done in 11.050s
removing stale ckpt [epoch 20] [took 0.02s]
 epoch          : 21
 loss           : 1.5575629215240478
 quant_reg      : 16.03377265548706
 quant_err      : 16.03377265548706
 learning_rate  : 7.16971844817084e-06
 n_samples      : 672000
 n_steps        : 5250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.404
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.831451493718205
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 62.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.753
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.40880839306508
 mnt_best       : 42.172523161485564
 not_improved_count: 1
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 1.15432 (QuantReg: 16.21258) QuantErr: 16.21258 batch_time=31.27637 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 1.62906 (QuantReg: 15.80134) QuantErr: 15.80134 batch_time=0.89587 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 1.18795 (QuantReg: 16.24984) QuantErr: 16.24984 batch_time=0.95621 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 1.73688 (QuantReg: 16.08637) QuantErr: 16.08637 batch_time=0.88910 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 1.20729 (QuantReg: 16.08548) QuantErr: 16.08548 batch_time=1.01077 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 1.59207 (QuantReg: 16.44903) QuantErr: 16.44903 batch_time=1.16576 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 1.75131 (QuantReg: 16.37448) QuantErr: 16.37448 batch_time=0.91600 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 1.74416 (QuantReg: 15.90126) QuantErr: 15.90126 batch_time=0.93608 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 1.69943 (QuantReg: 15.93094) QuantErr: 15.93094 batch_time=1.26500 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 1.57603 (QuantReg: 16.05492) QuantErr: 16.05492 batch_time=0.89933 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 1.86012 (QuantReg: 16.13420) QuantErr: 16.13420 batch_time=0.93725 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 1.55264 (QuantReg: 16.10003) QuantErr: 16.10003 batch_time=0.89718 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 1.42155 (QuantReg: 16.19395) QuantErr: 16.19395 batch_time=0.92544 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 1.81726 (QuantReg: 15.81889) QuantErr: 15.81889 batch_time=0.91677 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 1.42410 (QuantReg: 16.35722) QuantErr: 16.35722 batch_time=0.93964 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 1.64028 (QuantReg: 16.60163) QuantErr: 16.60163 batch_time=0.96234 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 1.55616 (QuantReg: 15.99783) QuantErr: 15.99783 batch_time=0.93134 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 1.53128 (QuantReg: 16.39507) QuantErr: 16.39507 batch_time=0.97061 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 1.43232 (QuantReg: 16.43001) QuantErr: 16.43001 batch_time=0.96717 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 1.69026 (QuantReg: 16.04193) QuantErr: 16.04193 batch_time=0.90797 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 1.36306 (QuantReg: 16.68883) QuantErr: 16.68883 batch_time=0.91684 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 1.35750 (QuantReg: 16.31016) QuantErr: 16.31016 batch_time=0.88566 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 1.41590 (QuantReg: 16.53087) QuantErr: 16.53087 batch_time=0.90424 
Train Epoch: 22 codebook_update_time=1.65996
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch22.pth ...
Done in 11.261s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 22
 loss           : 1.4801256201267243
 quant_reg      : 16.18995958328247
 quant_err      : 16.18995958328247
 learning_rate  : 6.811232525762298e-06
 n_samples      : 704000
 n_steps        : 5500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.642
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.470126272401465
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.3415
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.79688014059562
 mnt_best       : 42.172523161485564
 not_improved_count: 2
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 1.45265 (QuantReg: 16.23305) QuantErr: 16.23305 batch_time=29.17629 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 1.70190 (QuantReg: 16.16772) QuantErr: 16.16772 batch_time=0.97254 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 1.49694 (QuantReg: 16.06723) QuantErr: 16.06723 batch_time=2.37056 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 1.58724 (QuantReg: 16.29306) QuantErr: 16.29306 batch_time=0.98521 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 1.09072 (QuantReg: 16.28408) QuantErr: 16.28408 batch_time=0.94242 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 1.47318 (QuantReg: 16.25527) QuantErr: 16.25527 batch_time=0.95459 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 1.21181 (QuantReg: 16.43834) QuantErr: 16.43834 batch_time=4.42452 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 1.17141 (QuantReg: 16.39582) QuantErr: 16.39582 batch_time=0.98222 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 1.34416 (QuantReg: 16.33458) QuantErr: 16.33458 batch_time=0.89731 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 1.74207 (QuantReg: 16.18061) QuantErr: 16.18061 batch_time=0.94036 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 1.38037 (QuantReg: 16.02196) QuantErr: 16.02196 batch_time=0.94526 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 1.61894 (QuantReg: 16.23028) QuantErr: 16.23028 batch_time=0.92801 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 1.50238 (QuantReg: 15.91372) QuantErr: 15.91372 batch_time=0.93602 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 1.82043 (QuantReg: 16.21957) QuantErr: 16.21957 batch_time=1.42583 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 1.40320 (QuantReg: 16.05189) QuantErr: 16.05189 batch_time=1.18711 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 1.94559 (QuantReg: 16.00594) QuantErr: 16.00594 batch_time=0.99606 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 1.59221 (QuantReg: 16.33071) QuantErr: 16.33071 batch_time=0.95802 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 1.44027 (QuantReg: 16.02079) QuantErr: 16.02079 batch_time=0.91252 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 1.32046 (QuantReg: 16.20584) QuantErr: 16.20584 batch_time=1.59513 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 1.70945 (QuantReg: 16.18575) QuantErr: 16.18575 batch_time=0.95678 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 1.44696 (QuantReg: 16.21686) QuantErr: 16.21686 batch_time=0.94321 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 1.73956 (QuantReg: 16.57857) QuantErr: 16.57857 batch_time=1.16984 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 1.25949 (QuantReg: 16.29730) QuantErr: 16.29730 batch_time=1.30268 
Train Epoch: 23 codebook_update_time=1.95133
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch23.pth ...
Done in 11.841s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 1.4948783383369446
 quant_reg      : 16.220315616607667
 quant_err      : 16.220315616607667
 learning_rate  : 6.470670899474183e-06
 n_samples      : 736000
 n_steps        : 5750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.641
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.015366439162165
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 63.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.9925
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.0268968862018
 mnt_best       : 42.172523161485564
 not_improved_count: 3
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 1.61082 (QuantReg: 16.14776) QuantErr: 16.14776 batch_time=31.66792 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 1.64995 (QuantReg: 15.92779) QuantErr: 15.92779 batch_time=0.96345 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 1.18528 (QuantReg: 16.60801) QuantErr: 16.60801 batch_time=0.93382 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 1.51578 (QuantReg: 17.03149) QuantErr: 17.03149 batch_time=0.98009 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 1.19974 (QuantReg: 16.19763) QuantErr: 16.19763 batch_time=0.90260 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 1.21999 (QuantReg: 16.45719) QuantErr: 16.45719 batch_time=0.93583 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 1.55530 (QuantReg: 16.06426) QuantErr: 16.06426 batch_time=0.98651 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 1.50357 (QuantReg: 16.28567) QuantErr: 16.28567 batch_time=0.92935 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 1.38999 (QuantReg: 16.44751) QuantErr: 16.44751 batch_time=0.92700 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 1.36526 (QuantReg: 16.46135) QuantErr: 16.46135 batch_time=0.92301 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 1.68409 (QuantReg: 16.67160) QuantErr: 16.67160 batch_time=0.92555 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 1.34957 (QuantReg: 16.31949) QuantErr: 16.31949 batch_time=0.95574 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 1.37507 (QuantReg: 16.48802) QuantErr: 16.48802 batch_time=0.96694 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 1.19311 (QuantReg: 16.36184) QuantErr: 16.36184 batch_time=0.91007 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 1.34566 (QuantReg: 16.55050) QuantErr: 16.55050 batch_time=2.45524 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 1.45739 (QuantReg: 16.40568) QuantErr: 16.40568 batch_time=0.93211 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 1.46129 (QuantReg: 16.20190) QuantErr: 16.20190 batch_time=0.92793 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 1.59602 (QuantReg: 16.03116) QuantErr: 16.03116 batch_time=0.93185 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 1.34500 (QuantReg: 16.25913) QuantErr: 16.25913 batch_time=2.89283 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 1.44903 (QuantReg: 16.83712) QuantErr: 16.83712 batch_time=0.90023 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 1.24704 (QuantReg: 16.76221) QuantErr: 16.76221 batch_time=0.90296 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 1.43523 (QuantReg: 16.58915) QuantErr: 16.58915 batch_time=0.97458 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 1.68867 (QuantReg: 16.41155) QuantErr: 16.41155 batch_time=0.93634 
Train Epoch: 24 codebook_update_time=1.69559
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch24.pth ...
Done in 25.609s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch24.pth ...
Done in 37.141s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 1.4622784082889557
 quant_reg      : 16.443870281219482
 quant_err      : 16.443870281219482
 learning_rate  : 6.147137354500473e-06
 n_samples      : 768000
 n_steps        : 6000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 50.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.116
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.42699123941296
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.8
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.402
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.116625889229226
 mnt_best       : 42.42699123941296
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 1.63433 (QuantReg: 16.27795) QuantErr: 16.27795 batch_time=31.54654 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 1.02397 (QuantReg: 16.82468) QuantErr: 16.82468 batch_time=0.94198 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 1.76157 (QuantReg: 16.65122) QuantErr: 16.65122 batch_time=0.93073 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 1.22582 (QuantReg: 16.32481) QuantErr: 16.32481 batch_time=0.96154 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 1.51019 (QuantReg: 16.49466) QuantErr: 16.49466 batch_time=0.94966 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 1.26333 (QuantReg: 16.32890) QuantErr: 16.32890 batch_time=0.89870 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 1.22767 (QuantReg: 16.37668) QuantErr: 16.37668 batch_time=3.05779 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 1.29936 (QuantReg: 16.86224) QuantErr: 16.86224 batch_time=0.93348 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 1.56458 (QuantReg: 16.34213) QuantErr: 16.34213 batch_time=0.94503 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 1.51041 (QuantReg: 16.83844) QuantErr: 16.83844 batch_time=0.91567 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 1.34568 (QuantReg: 16.81727) QuantErr: 16.81727 batch_time=1.68188 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 1.85909 (QuantReg: 16.25990) QuantErr: 16.25990 batch_time=0.93263 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 1.37304 (QuantReg: 16.46579) QuantErr: 16.46579 batch_time=0.92376 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 1.39750 (QuantReg: 16.15973) QuantErr: 16.15973 batch_time=0.89486 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 1.56129 (QuantReg: 16.51681) QuantErr: 16.51681 batch_time=0.89417 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 1.04776 (QuantReg: 16.82064) QuantErr: 16.82064 batch_time=0.90033 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 1.30486 (QuantReg: 16.63713) QuantErr: 16.63713 batch_time=0.90303 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 1.19002 (QuantReg: 16.86651) QuantErr: 16.86651 batch_time=1.22150 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 1.19859 (QuantReg: 16.96485) QuantErr: 16.96485 batch_time=0.98296 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 1.28710 (QuantReg: 17.05484) QuantErr: 17.05484 batch_time=0.93211 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 1.19593 (QuantReg: 16.99418) QuantErr: 16.99418 batch_time=0.91929 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 1.46656 (QuantReg: 16.58520) QuantErr: 16.58520 batch_time=0.91835 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 1.51145 (QuantReg: 16.48334) QuantErr: 16.48334 batch_time=0.89972 
Train Epoch: 25 codebook_update_time=1.76425
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch25.pth ...
Done in 11.099s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.4351468889713288
 quant_reg      : 16.517418724060057
 quant_err      : 16.517418724060057
 learning_rate  : 5.8397804867754495e-06
 n_samples      : 800000
 n_steps        : 6250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.7
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.137
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.08793932746539
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.656
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.111605518788465
 mnt_best       : 42.42699123941296
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 1.33242 (QuantReg: 16.48010) QuantErr: 16.48010 batch_time=29.02811 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 1.22831 (QuantReg: 16.86912) QuantErr: 16.86912 batch_time=0.98164 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 1.61645 (QuantReg: 16.33151) QuantErr: 16.33151 batch_time=0.93668 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 1.32042 (QuantReg: 16.63930) QuantErr: 16.63930 batch_time=1.27018 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 0.98693 (QuantReg: 16.83419) QuantErr: 16.83419 batch_time=1.01172 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 1.39270 (QuantReg: 16.60005) QuantErr: 16.60005 batch_time=0.91144 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 1.55170 (QuantReg: 16.52100) QuantErr: 16.52100 batch_time=0.92708 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 1.61836 (QuantReg: 17.01905) QuantErr: 17.01905 batch_time=1.00985 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 1.92957 (QuantReg: 16.49349) QuantErr: 16.49349 batch_time=1.00141 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 1.18463 (QuantReg: 16.81029) QuantErr: 16.81029 batch_time=0.96319 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 1.57029 (QuantReg: 16.59678) QuantErr: 16.59678 batch_time=0.91347 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 1.47486 (QuantReg: 16.61746) QuantErr: 16.61746 batch_time=0.95127 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 1.70044 (QuantReg: 16.52618) QuantErr: 16.52618 batch_time=0.98908 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 1.42094 (QuantReg: 16.76416) QuantErr: 16.76416 batch_time=0.95627 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 1.36756 (QuantReg: 16.90783) QuantErr: 16.90783 batch_time=0.96496 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 1.51937 (QuantReg: 16.62306) QuantErr: 16.62306 batch_time=0.92678 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 1.47543 (QuantReg: 16.64741) QuantErr: 16.64741 batch_time=1.44714 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 1.03479 (QuantReg: 16.69888) QuantErr: 16.69888 batch_time=0.90397 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 1.24434 (QuantReg: 16.64858) QuantErr: 16.64858 batch_time=0.86873 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 1.92839 (QuantReg: 16.60338) QuantErr: 16.60338 batch_time=0.91887 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 1.15197 (QuantReg: 16.83817) QuantErr: 16.83817 batch_time=0.89542 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 1.14099 (QuantReg: 16.52767) QuantErr: 16.52767 batch_time=0.92285 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 1.50363 (QuantReg: 16.55416) QuantErr: 16.55416 batch_time=0.94582 
Train Epoch: 26 codebook_update_time=1.75979
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch26.pth ...
Done in 11.352s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 1.4042806100845338
 quant_reg      : 16.622258476257326
 quant_err      : 16.622258476257326
 learning_rate  : 5.547791462436677e-06
 n_samples      : 832000
 n_steps        : 6500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.499
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.91078113177823
 MSRVTT_jsfusion_test/v2t_metrics/R1: 21.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.7
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.385
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 41.60132207336788
 mnt_best       : 42.42699123941296
 not_improved_count: 2
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 1.38880 (QuantReg: 16.35086) QuantErr: 16.35086 batch_time=27.34970 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 1.53808 (QuantReg: 16.37210) QuantErr: 16.37210 batch_time=1.38845 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 1.43645 (QuantReg: 16.65414) QuantErr: 16.65414 batch_time=0.92532 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 1.75441 (QuantReg: 16.71266) QuantErr: 16.71266 batch_time=0.88199 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 1.29654 (QuantReg: 16.86671) QuantErr: 16.86671 batch_time=0.95076 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 1.40580 (QuantReg: 16.68328) QuantErr: 16.68328 batch_time=1.74297 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 1.34762 (QuantReg: 16.80277) QuantErr: 16.80277 batch_time=2.30303 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 1.18771 (QuantReg: 16.82912) QuantErr: 16.82912 batch_time=0.91673 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 1.52435 (QuantReg: 16.19602) QuantErr: 16.19602 batch_time=0.96130 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 1.61230 (QuantReg: 16.77795) QuantErr: 16.77795 batch_time=0.88834 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 1.41607 (QuantReg: 17.09093) QuantErr: 17.09093 batch_time=0.93381 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 1.24368 (QuantReg: 17.02122) QuantErr: 17.02122 batch_time=0.93253 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 1.25302 (QuantReg: 16.66333) QuantErr: 16.66333 batch_time=0.93820 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 1.61302 (QuantReg: 16.08165) QuantErr: 16.08165 batch_time=5.12350 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 1.96799 (QuantReg: 16.52761) QuantErr: 16.52761 batch_time=0.89903 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 1.23540 (QuantReg: 16.91600) QuantErr: 16.91600 batch_time=0.92673 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 1.10675 (QuantReg: 16.68058) QuantErr: 16.68058 batch_time=0.93188 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 1.51306 (QuantReg: 16.71525) QuantErr: 16.71525 batch_time=1.42018 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 1.27663 (QuantReg: 17.11609) QuantErr: 17.11609 batch_time=1.30080 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 1.43388 (QuantReg: 16.97031) QuantErr: 16.97031 batch_time=0.93668 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 1.30111 (QuantReg: 16.46663) QuantErr: 16.46663 batch_time=0.93445 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 1.03588 (QuantReg: 16.81725) QuantErr: 16.81725 batch_time=0.90915 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 1.36449 (QuantReg: 16.35245) QuantErr: 16.35245 batch_time=0.97970 
Train Epoch: 27 codebook_update_time=1.64716
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch27.pth ...
Done in 11.643s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 1.3789147748947144
 quant_reg      : 16.710623378753663
 quant_err      : 16.710623378753663
 learning_rate  : 5.270401889314843e-06
 n_samples      : 864000
 n_steps        : 6750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 64.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.643
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.85866780035115
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.92
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.015993908628964
 mnt_best       : 42.42699123941296
 not_improved_count: 3
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 1.64593 (QuantReg: 16.61676) QuantErr: 16.61676 batch_time=34.67889 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 1.31496 (QuantReg: 16.80277) QuantErr: 16.80277 batch_time=0.91235 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 1.25163 (QuantReg: 16.83115) QuantErr: 16.83115 batch_time=0.98428 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 1.09607 (QuantReg: 17.37663) QuantErr: 17.37663 batch_time=0.90969 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 1.50855 (QuantReg: 16.29837) QuantErr: 16.29837 batch_time=0.90540 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 1.26114 (QuantReg: 16.77071) QuantErr: 16.77071 batch_time=0.91922 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 1.37223 (QuantReg: 16.82716) QuantErr: 16.82716 batch_time=0.96808 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 1.28417 (QuantReg: 16.80885) QuantErr: 16.80885 batch_time=1.65800 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 1.46118 (QuantReg: 16.86386) QuantErr: 16.86386 batch_time=0.90243 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 1.55210 (QuantReg: 16.72338) QuantErr: 16.72338 batch_time=1.00691 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 1.14900 (QuantReg: 16.86927) QuantErr: 16.86927 batch_time=0.93969 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 1.40325 (QuantReg: 17.02129) QuantErr: 17.02129 batch_time=0.96749 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 1.40630 (QuantReg: 16.60080) QuantErr: 16.60080 batch_time=0.94108 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 0.97464 (QuantReg: 17.14967) QuantErr: 17.14967 batch_time=0.98604 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 0.95174 (QuantReg: 17.17689) QuantErr: 17.17689 batch_time=0.92836 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 1.51366 (QuantReg: 16.73796) QuantErr: 16.73796 batch_time=0.89629 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 1.15368 (QuantReg: 16.80182) QuantErr: 16.80182 batch_time=0.93267 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 1.01393 (QuantReg: 17.00625) QuantErr: 17.00625 batch_time=1.03901 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 1.11720 (QuantReg: 17.09143) QuantErr: 17.09143 batch_time=1.04037 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 1.68610 (QuantReg: 16.62045) QuantErr: 16.62045 batch_time=0.96800 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 1.55780 (QuantReg: 16.88047) QuantErr: 16.88047 batch_time=2.17300 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 1.16674 (QuantReg: 16.88434) QuantErr: 16.88434 batch_time=0.98365 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 1.60567 (QuantReg: 16.10061) QuantErr: 16.10061 batch_time=0.92265 
Train Epoch: 28 codebook_update_time=1.73960
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch28.pth ...
Done in 11.451s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 1.3983279190063476
 quant_reg      : 16.79164688873291
 quant_err      : 16.79164688873291
 learning_rate  : 5.006881794849101e-06
 n_samples      : 896000
 n_steps        : 7000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.348
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.62655613765903
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.9
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.1675
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.56747280074238
 mnt_best       : 42.42699123941296
 not_improved_count: 4
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 1.63011 (QuantReg: 16.27115) QuantErr: 16.27115 batch_time=30.91309 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 1.55079 (QuantReg: 16.41435) QuantErr: 16.41435 batch_time=0.93338 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 1.35239 (QuantReg: 16.72189) QuantErr: 16.72189 batch_time=0.90888 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 1.14818 (QuantReg: 17.06322) QuantErr: 17.06322 batch_time=0.94096 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 1.78013 (QuantReg: 16.58769) QuantErr: 16.58769 batch_time=0.93452 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 1.39438 (QuantReg: 16.78012) QuantErr: 16.78012 batch_time=0.91127 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 1.54085 (QuantReg: 17.00923) QuantErr: 17.00923 batch_time=1.08448 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 1.82874 (QuantReg: 16.35453) QuantErr: 16.35453 batch_time=0.92547 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 1.17524 (QuantReg: 17.18552) QuantErr: 17.18552 batch_time=1.52357 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 1.21309 (QuantReg: 17.14208) QuantErr: 17.14208 batch_time=0.93621 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 1.34873 (QuantReg: 16.57711) QuantErr: 16.57711 batch_time=0.99725 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 1.65687 (QuantReg: 16.68121) QuantErr: 16.68121 batch_time=0.93214 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 1.19166 (QuantReg: 16.78207) QuantErr: 16.78207 batch_time=0.93326 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 1.55523 (QuantReg: 16.62497) QuantErr: 16.62497 batch_time=0.93940 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 1.38405 (QuantReg: 16.72277) QuantErr: 16.72277 batch_time=0.97643 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 1.20459 (QuantReg: 17.29528) QuantErr: 17.29528 batch_time=0.95032 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 1.16453 (QuantReg: 16.66258) QuantErr: 16.66258 batch_time=0.90765 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 1.70509 (QuantReg: 16.74695) QuantErr: 16.74695 batch_time=0.98652 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 1.44002 (QuantReg: 16.69320) QuantErr: 16.69320 batch_time=0.99186 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 1.42092 (QuantReg: 16.61867) QuantErr: 16.61867 batch_time=0.89197 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 1.65711 (QuantReg: 16.71810) QuantErr: 16.71810 batch_time=0.96965 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 1.56076 (QuantReg: 17.04119) QuantErr: 17.04119 batch_time=0.92781 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 1.34581 (QuantReg: 17.15713) QuantErr: 17.15713 batch_time=0.94359 
Train Epoch: 29 codebook_update_time=1.65372
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch29.pth ...
Done in 10.868s
removing stale ckpt [epoch 28] [took 0.00s]
 epoch          : 29
 loss           : 1.3619353373050689
 quant_reg      : 16.847474029541015
 quant_err      : 16.847474029541015
 learning_rate  : 4.756537705106646e-06
 n_samples      : 928000
 n_steps        : 7250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.821
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.33113896631193
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.9
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0185
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.43646886093783
 mnt_best       : 42.42699123941296
 not_improved_count: 5
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 1.51905 (QuantReg: 16.75034) QuantErr: 16.75034 batch_time=34.01952 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 1.46832 (QuantReg: 16.55245) QuantErr: 16.55245 batch_time=0.95107 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 1.28718 (QuantReg: 17.32200) QuantErr: 17.32200 batch_time=0.88850 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 1.25788 (QuantReg: 16.61779) QuantErr: 16.61779 batch_time=0.92070 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 1.35379 (QuantReg: 16.93071) QuantErr: 16.93071 batch_time=0.99180 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 1.26440 (QuantReg: 16.89112) QuantErr: 16.89112 batch_time=1.03038 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 1.28860 (QuantReg: 17.10832) QuantErr: 17.10832 batch_time=1.06656 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 1.30439 (QuantReg: 17.11996) QuantErr: 17.11996 batch_time=1.38382 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 0.90554 (QuantReg: 17.32343) QuantErr: 17.32343 batch_time=1.01161 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 1.10124 (QuantReg: 16.81516) QuantErr: 16.81516 batch_time=0.92598 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 1.87187 (QuantReg: 16.76291) QuantErr: 16.76291 batch_time=0.89280 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 1.12503 (QuantReg: 16.81365) QuantErr: 16.81365 batch_time=0.93242 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 1.30557 (QuantReg: 16.83158) QuantErr: 16.83158 batch_time=0.94412 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 1.10605 (QuantReg: 17.41651) QuantErr: 17.41651 batch_time=0.94524 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 1.20440 (QuantReg: 16.65011) QuantErr: 16.65011 batch_time=0.90400 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 1.44639 (QuantReg: 16.88798) QuantErr: 16.88798 batch_time=0.90700 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 1.70662 (QuantReg: 16.60113) QuantErr: 16.60113 batch_time=0.96795 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 1.16682 (QuantReg: 16.84115) QuantErr: 16.84115 batch_time=0.91450 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 1.66509 (QuantReg: 16.86304) QuantErr: 16.86304 batch_time=1.03479 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 1.19541 (QuantReg: 17.27621) QuantErr: 17.27621 batch_time=1.65581 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 1.14806 (QuantReg: 17.01300) QuantErr: 17.01300 batch_time=1.03554 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 1.67137 (QuantReg: 16.50413) QuantErr: 16.50413 batch_time=0.92334 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 1.52056 (QuantReg: 16.93966) QuantErr: 16.93966 batch_time=1.03014 
Train Epoch: 30 codebook_update_time=1.87638
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch30.pth ...
Done in 11.150s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 1.3469307925701142
 quant_reg      : 16.900839836120607
 quant_err      : 16.900839836120607
 learning_rate  : 4.518710819851313e-06
 n_samples      : 960000
 n_steps        : 7500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.472
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.777311160809504
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.6715
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.521358583833106
 mnt_best       : 42.42699123941296
 not_improved_count: 6
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 1.61442 (QuantReg: 17.04272) QuantErr: 17.04272 batch_time=31.15431 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 1.56205 (QuantReg: 16.72314) QuantErr: 16.72314 batch_time=0.91946 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 1.12117 (QuantReg: 16.91082) QuantErr: 16.91082 batch_time=0.93103 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 1.34861 (QuantReg: 16.94092) QuantErr: 16.94092 batch_time=0.94163 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 1.60105 (QuantReg: 16.89075) QuantErr: 16.89075 batch_time=0.99281 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 1.29447 (QuantReg: 17.03611) QuantErr: 17.03611 batch_time=0.96656 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 1.33948 (QuantReg: 16.88510) QuantErr: 16.88510 batch_time=1.01421 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 1.33684 (QuantReg: 16.78856) QuantErr: 16.78856 batch_time=1.24554 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 1.14794 (QuantReg: 17.24620) QuantErr: 17.24620 batch_time=0.89244 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 1.34604 (QuantReg: 16.86705) QuantErr: 16.86705 batch_time=0.95966 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 1.46818 (QuantReg: 16.59706) QuantErr: 16.59706 batch_time=0.94299 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 1.17120 (QuantReg: 17.16418) QuantErr: 17.16418 batch_time=0.96646 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 1.02582 (QuantReg: 17.34350) QuantErr: 17.34350 batch_time=0.89574 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 1.22316 (QuantReg: 16.54983) QuantErr: 16.54983 batch_time=3.80533 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 1.35734 (QuantReg: 16.99488) QuantErr: 16.99488 batch_time=0.98848 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 1.27749 (QuantReg: 16.65062) QuantErr: 16.65062 batch_time=0.92851 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 1.27855 (QuantReg: 17.12176) QuantErr: 17.12176 batch_time=0.91606 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 1.36342 (QuantReg: 17.05358) QuantErr: 17.05358 batch_time=0.91587 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 1.22804 (QuantReg: 16.87032) QuantErr: 16.87032 batch_time=0.92674 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 1.14899 (QuantReg: 16.83320) QuantErr: 16.83320 batch_time=0.92705 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 1.32311 (QuantReg: 16.82108) QuantErr: 16.82108 batch_time=1.28711 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 1.52808 (QuantReg: 16.52929) QuantErr: 16.52929 batch_time=0.91855 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 1.39341 (QuantReg: 16.83906) QuantErr: 16.83906 batch_time=0.91913 
Train Epoch: 31 codebook_update_time=1.65815
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch31.pth ...
Done in 28.132s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.3428111836910248
 quant_reg      : 16.95360651397705
 quant_err      : 16.95360651397705
 learning_rate  : 4.2927752788587475e-06
 n_samples      : 992000
 n_steps        : 7750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.709
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.61643288773491
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 50.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.8
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0065
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.34651051269508
 mnt_best       : 42.42699123941296
 not_improved_count: 7
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 1.56717 (QuantReg: 16.80707) QuantErr: 16.80707 batch_time=31.67459 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 1.33477 (QuantReg: 16.95589) QuantErr: 16.95589 batch_time=0.92797 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 1.10145 (QuantReg: 16.75521) QuantErr: 16.75521 batch_time=0.99037 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 1.35654 (QuantReg: 17.02025) QuantErr: 17.02025 batch_time=0.96868 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 1.44274 (QuantReg: 16.71717) QuantErr: 16.71717 batch_time=0.96112 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 1.10094 (QuantReg: 17.26041) QuantErr: 17.26041 batch_time=1.05266 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 1.24095 (QuantReg: 17.39043) QuantErr: 17.39043 batch_time=0.90627 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 1.37782 (QuantReg: 16.71398) QuantErr: 16.71398 batch_time=0.92503 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 1.07447 (QuantReg: 17.17099) QuantErr: 17.17099 batch_time=1.58180 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 1.12071 (QuantReg: 17.14922) QuantErr: 17.14922 batch_time=0.91424 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 1.43939 (QuantReg: 17.09587) QuantErr: 17.09587 batch_time=1.01317 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 1.55388 (QuantReg: 17.08966) QuantErr: 17.08966 batch_time=0.92573 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 1.35621 (QuantReg: 17.38921) QuantErr: 17.38921 batch_time=0.93502 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 1.28874 (QuantReg: 17.17324) QuantErr: 17.17324 batch_time=0.93203 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 1.38718 (QuantReg: 16.71784) QuantErr: 16.71784 batch_time=0.98052 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 0.91958 (QuantReg: 17.32618) QuantErr: 17.32618 batch_time=0.91843 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 1.12789 (QuantReg: 17.07704) QuantErr: 17.07704 batch_time=0.94726 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 1.31846 (QuantReg: 17.32150) QuantErr: 17.32150 batch_time=0.97826 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 1.32854 (QuantReg: 17.28455) QuantErr: 17.28455 batch_time=0.97854 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 1.43957 (QuantReg: 16.73927) QuantErr: 16.73927 batch_time=1.22065 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 1.39165 (QuantReg: 17.09299) QuantErr: 17.09299 batch_time=1.17965 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 1.55087 (QuantReg: 16.60282) QuantErr: 16.60282 batch_time=0.99590 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 1.19546 (QuantReg: 17.08711) QuantErr: 17.08711 batch_time=0.98661 
Train Epoch: 32 codebook_update_time=1.83039
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch32.pth ...
Done in 11.362s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 1.3084560558795928
 quant_reg      : 17.053082717895506
 quant_err      : 17.053082717895506
 learning_rate  : 4.0781365149158096e-06
 n_samples      : 1024000
 n_steps        : 8000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.5
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.33
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.04590219573417
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.8455
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.89048316126564
 mnt_best       : 42.42699123941296
 not_improved_count: 8
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 1.26240 (QuantReg: 16.74730) QuantErr: 16.74730 batch_time=34.57184 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 0.97483 (QuantReg: 17.00768) QuantErr: 17.00768 batch_time=0.90854 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 1.10776 (QuantReg: 17.51106) QuantErr: 17.51106 batch_time=0.95062 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 1.14724 (QuantReg: 17.09756) QuantErr: 17.09756 batch_time=0.92073 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 1.70437 (QuantReg: 17.04093) QuantErr: 17.04093 batch_time=0.98335 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 1.10674 (QuantReg: 16.95844) QuantErr: 16.95844 batch_time=0.95291 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 1.33838 (QuantReg: 17.43375) QuantErr: 17.43375 batch_time=0.96152 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 1.37252 (QuantReg: 17.03168) QuantErr: 17.03168 batch_time=0.96292 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 1.32164 (QuantReg: 17.18426) QuantErr: 17.18426 batch_time=1.65954 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 1.05031 (QuantReg: 17.02724) QuantErr: 17.02724 batch_time=0.92607 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 1.27088 (QuantReg: 17.20235) QuantErr: 17.20235 batch_time=0.90861 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 1.54031 (QuantReg: 17.37141) QuantErr: 17.37141 batch_time=0.93646 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 1.54027 (QuantReg: 17.42749) QuantErr: 17.42749 batch_time=0.93122 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 1.33981 (QuantReg: 17.61369) QuantErr: 17.61369 batch_time=0.93203 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 1.53771 (QuantReg: 17.08415) QuantErr: 17.08415 batch_time=0.94436 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 1.37657 (QuantReg: 17.01796) QuantErr: 17.01796 batch_time=0.96121 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 1.32552 (QuantReg: 17.06813) QuantErr: 17.06813 batch_time=0.96532 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 1.16923 (QuantReg: 17.26971) QuantErr: 17.26971 batch_time=0.96174 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 1.29583 (QuantReg: 17.36501) QuantErr: 17.36501 batch_time=0.93546 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 1.60157 (QuantReg: 17.18555) QuantErr: 17.18555 batch_time=0.94067 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 0.98211 (QuantReg: 17.25749) QuantErr: 17.25749 batch_time=0.92791 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 1.28492 (QuantReg: 17.17413) QuantErr: 17.17413 batch_time=0.99177 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 1.53918 (QuantReg: 16.99809) QuantErr: 16.99809 batch_time=0.93410 
Train Epoch: 33 codebook_update_time=1.70392
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch33.pth ...
Done in 17.451s
removing stale ckpt [epoch 32] [took 0.01s]
 epoch          : 33
 loss           : 1.3376081433296203
 quant_reg      : 17.14455438232422
 quant_err      : 17.14455438232422
 learning_rate  : 3.874229689170019e-06
 n_samples      : 1056000
 n_steps        : 8250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.6
 MSRVTT_jsfusion_test/t2v_metrics/R5: 51.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.5
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.931
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.82107558024017
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 64.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 25.3815
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.22680028332021
 mnt_best       : 42.42699123941296
 not_improved_count: 9
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 1.39181 (QuantReg: 17.23814) QuantErr: 17.23814 batch_time=31.77967 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 1.40450 (QuantReg: 16.90095) QuantErr: 16.90095 batch_time=0.94928 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 0.84896 (QuantReg: 17.41772) QuantErr: 17.41772 batch_time=2.82147 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 1.08890 (QuantReg: 17.46668) QuantErr: 17.46668 batch_time=0.92750 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 1.40451 (QuantReg: 17.35296) QuantErr: 17.35296 batch_time=0.91889 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 1.28088 (QuantReg: 17.08477) QuantErr: 17.08477 batch_time=0.90410 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 1.44119 (QuantReg: 17.10437) QuantErr: 17.10437 batch_time=0.90272 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 1.15881 (QuantReg: 17.10666) QuantErr: 17.10666 batch_time=0.92002 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 1.43362 (QuantReg: 17.47729) QuantErr: 17.47729 batch_time=2.16661 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 1.52505 (QuantReg: 17.05553) QuantErr: 17.05553 batch_time=0.92429 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 0.98942 (QuantReg: 17.48300) QuantErr: 17.48300 batch_time=0.94620 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 1.23320 (QuantReg: 17.38825) QuantErr: 17.38825 batch_time=0.94305 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 1.18684 (QuantReg: 17.23457) QuantErr: 17.23457 batch_time=0.97768 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 1.07030 (QuantReg: 17.43619) QuantErr: 17.43619 batch_time=0.91278 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 1.42378 (QuantReg: 17.16138) QuantErr: 17.16138 batch_time=0.98046 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 1.66029 (QuantReg: 17.14646) QuantErr: 17.14646 batch_time=0.94249 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 1.30862 (QuantReg: 16.99751) QuantErr: 16.99751 batch_time=0.90884 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 1.20490 (QuantReg: 17.27117) QuantErr: 17.27117 batch_time=0.91035 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 1.04421 (QuantReg: 17.61310) QuantErr: 17.61310 batch_time=0.88963 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 0.97249 (QuantReg: 17.12825) QuantErr: 17.12825 batch_time=1.01422 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 1.61664 (QuantReg: 17.02341) QuantErr: 17.02341 batch_time=0.96264 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 1.16151 (QuantReg: 17.21928) QuantErr: 17.21928 batch_time=0.98265 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 1.07007 (QuantReg: 17.19279) QuantErr: 17.19279 batch_time=0.92075 
Train Epoch: 34 codebook_update_time=1.78491
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch34.pth ...
Done in 11.122s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 1.305273384332657
 quant_reg      : 17.213548736572264
 quant_err      : 17.213548736572264
 learning_rate  : 3.6805182047115176e-06
 n_samples      : 1088000
 n_steps        : 8500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.3
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.36
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 41.67896352431575
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.0
 MSRVTT_jsfusion_test/v2t_metrics/R5: 51.0
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.1
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.0
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.306
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.0143941592684
 mnt_best       : 42.42699123941296
 not_improved_count: 10
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 1.18503 (QuantReg: 17.44049) QuantErr: 17.44049 batch_time=27.58770 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 1.28672 (QuantReg: 16.71682) QuantErr: 16.71682 batch_time=0.98855 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 1.11526 (QuantReg: 17.36874) QuantErr: 17.36874 batch_time=1.11882 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 1.31325 (QuantReg: 17.09724) QuantErr: 17.09724 batch_time=0.89118 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 1.44639 (QuantReg: 16.88460) QuantErr: 16.88460 batch_time=0.92430 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 1.25731 (QuantReg: 17.61118) QuantErr: 17.61118 batch_time=1.01285 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 1.49951 (QuantReg: 16.97725) QuantErr: 16.97725 batch_time=0.89811 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 1.30874 (QuantReg: 16.92861) QuantErr: 16.92861 batch_time=1.02783 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 1.46729 (QuantReg: 17.20739) QuantErr: 17.20739 batch_time=0.97468 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 1.71844 (QuantReg: 16.98861) QuantErr: 16.98861 batch_time=1.34068 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 1.56846 (QuantReg: 17.27264) QuantErr: 17.27264 batch_time=0.92621 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 1.28075 (QuantReg: 17.36805) QuantErr: 17.36805 batch_time=0.95746 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 1.26993 (QuantReg: 17.61792) QuantErr: 17.61792 batch_time=1.01742 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 1.29847 (QuantReg: 17.51722) QuantErr: 17.51722 batch_time=0.97499 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 1.03437 (QuantReg: 17.45602) QuantErr: 17.45602 batch_time=0.98067 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 1.03483 (QuantReg: 17.41104) QuantErr: 17.41104 batch_time=0.95509 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 1.43717 (QuantReg: 17.25672) QuantErr: 17.25672 batch_time=0.92721 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 1.30405 (QuantReg: 17.37111) QuantErr: 17.37111 batch_time=0.96237 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 1.34095 (QuantReg: 17.29220) QuantErr: 17.29220 batch_time=0.94977 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 1.04994 (QuantReg: 17.26457) QuantErr: 17.26457 batch_time=0.92302 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 1.41050 (QuantReg: 17.42191) QuantErr: 17.42191 batch_time=0.99820 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 0.91893 (QuantReg: 17.57296) QuantErr: 17.57296 batch_time=1.01537 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 1.00129 (QuantReg: 17.42400) QuantErr: 17.42400 batch_time=0.95473 
Train Epoch: 35 codebook_update_time=1.86352
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch35.pth ...
Done in 11.302s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch35.pth ...
Done in 22.397s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 1.2948187298774718
 quant_reg      : 17.258671279907226
 quant_err      : 17.258671279907226
 learning_rate  : 3.4964922944759416e-06
 n_samples      : 1120000
 n_steps        : 8750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 21.8
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.794
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.558178592411835
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.415
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.94147509541057
 mnt_best       : 42.558178592411835
 not_improved_count: 0
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 1.14998 (QuantReg: 17.57332) QuantErr: 17.57332 batch_time=34.46445 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 1.47993 (QuantReg: 17.19946) QuantErr: 17.19946 batch_time=0.89929 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 1.19671 (QuantReg: 17.47154) QuantErr: 17.47154 batch_time=1.01768 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 1.06439 (QuantReg: 17.21653) QuantErr: 17.21653 batch_time=0.94874 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 1.10644 (QuantReg: 17.61723) QuantErr: 17.61723 batch_time=0.94613 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 1.60568 (QuantReg: 17.05577) QuantErr: 17.05577 batch_time=0.99659 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 1.21399 (QuantReg: 17.21337) QuantErr: 17.21337 batch_time=1.04217 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 1.41270 (QuantReg: 17.43840) QuantErr: 17.43840 batch_time=0.96805 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 1.15680 (QuantReg: 17.47044) QuantErr: 17.47044 batch_time=0.94090 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 1.09901 (QuantReg: 17.43774) QuantErr: 17.43774 batch_time=0.94793 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 1.53583 (QuantReg: 17.52027) QuantErr: 17.52027 batch_time=0.89859 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 1.16139 (QuantReg: 17.32273) QuantErr: 17.32273 batch_time=1.27093 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 1.13733 (QuantReg: 17.52991) QuantErr: 17.52991 batch_time=1.01966 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 1.24050 (QuantReg: 17.59369) QuantErr: 17.59369 batch_time=0.97279 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 0.88146 (QuantReg: 17.44023) QuantErr: 17.44023 batch_time=0.99309 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 1.32341 (QuantReg: 17.58565) QuantErr: 17.58565 batch_time=1.00710 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 1.17968 (QuantReg: 17.32676) QuantErr: 17.32676 batch_time=0.91630 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 1.57526 (QuantReg: 17.59306) QuantErr: 17.59306 batch_time=0.95662 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 1.25665 (QuantReg: 17.48658) QuantErr: 17.48658 batch_time=0.94753 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 1.17297 (QuantReg: 17.22892) QuantErr: 17.22892 batch_time=1.03447 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 1.12303 (QuantReg: 17.26998) QuantErr: 17.26998 batch_time=0.89157 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 1.26477 (QuantReg: 17.54204) QuantErr: 17.54204 batch_time=0.87949 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 1.15627 (QuantReg: 17.54829) QuantErr: 17.54829 batch_time=0.96479 
Train Epoch: 36 codebook_update_time=1.75097
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch36.pth ...
Done in 25.678s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch36.pth ...
Done in 37.096s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 1.2905023996829987
 quant_reg      : 17.31603119659424
 quant_err      : 17.31603119659424
 learning_rate  : 3.321667679752144e-06
 n_samples      : 1152000
 n_steps        : 9000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 22.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.8
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.267
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.714313092251054
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.4
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 87.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.231
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.13133965573258
 mnt_best       : 42.714313092251054
 not_improved_count: 0
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 1.13541 (QuantReg: 17.15718) QuantErr: 17.15718 batch_time=33.16307 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 1.19531 (QuantReg: 17.48869) QuantErr: 17.48869 batch_time=0.90179 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 1.33652 (QuantReg: 17.24008) QuantErr: 17.24008 batch_time=1.14496 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 1.31071 (QuantReg: 17.35412) QuantErr: 17.35412 batch_time=0.92490 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 1.15211 (QuantReg: 17.33311) QuantErr: 17.33311 batch_time=1.01186 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 1.30468 (QuantReg: 17.00535) QuantErr: 17.00535 batch_time=0.95001 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 1.05101 (QuantReg: 17.54873) QuantErr: 17.54873 batch_time=2.14472 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 1.27322 (QuantReg: 17.54917) QuantErr: 17.54917 batch_time=0.96082 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 1.33264 (QuantReg: 17.49604) QuantErr: 17.49604 batch_time=0.95056 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 1.06577 (QuantReg: 17.34264) QuantErr: 17.34264 batch_time=0.99079 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 1.19791 (QuantReg: 17.36885) QuantErr: 17.36885 batch_time=0.97900 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 1.21455 (QuantReg: 17.32087) QuantErr: 17.32087 batch_time=0.89976 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 1.34713 (QuantReg: 17.63890) QuantErr: 17.63890 batch_time=0.92900 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 1.23764 (QuantReg: 17.59458) QuantErr: 17.59458 batch_time=0.94192 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 1.84529 (QuantReg: 17.18633) QuantErr: 17.18633 batch_time=0.92069 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 1.13935 (QuantReg: 17.13347) QuantErr: 17.13347 batch_time=0.95118 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 1.10576 (QuantReg: 17.41848) QuantErr: 17.41848 batch_time=0.96767 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 1.17128 (QuantReg: 17.37763) QuantErr: 17.37763 batch_time=0.90584 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 1.07917 (QuantReg: 17.49582) QuantErr: 17.49582 batch_time=1.46752 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 1.31155 (QuantReg: 17.65322) QuantErr: 17.65322 batch_time=4.43175 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 1.30948 (QuantReg: 17.58833) QuantErr: 17.58833 batch_time=0.94119 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 1.20026 (QuantReg: 17.76688) QuantErr: 17.76688 batch_time=0.91227 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 1.35168 (QuantReg: 17.49837) QuantErr: 17.49837 batch_time=0.95925 
Train Epoch: 37 codebook_update_time=2.06746
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch37.pth ...
Done in 11.180s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch37.pth ...
Done in 22.970s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 1.2798170247077942
 quant_reg      : 17.386954917907715
 quant_err      : 17.386954917907715
 learning_rate  : 3.155584295764537e-06
 n_samples      : 1184000
 n_steps        : 9250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.1
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.488
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.190352784062185
 MSRVTT_jsfusion_test/v2t_metrics/R1: 22.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.2695
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 42.94027222237537
 mnt_best       : 43.190352784062185
 not_improved_count: 0
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 1.29224 (QuantReg: 17.18365) QuantErr: 17.18365 batch_time=33.44651 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 1.54571 (QuantReg: 16.90309) QuantErr: 16.90309 batch_time=0.94517 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 1.28010 (QuantReg: 17.47615) QuantErr: 17.47615 batch_time=0.95912 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 1.16134 (QuantReg: 17.70324) QuantErr: 17.70324 batch_time=0.92650 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 1.23216 (QuantReg: 17.19071) QuantErr: 17.19071 batch_time=0.91521 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 1.45146 (QuantReg: 17.20023) QuantErr: 17.20023 batch_time=1.01293 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 1.37891 (QuantReg: 17.44330) QuantErr: 17.44330 batch_time=0.94627 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 1.62596 (QuantReg: 17.52633) QuantErr: 17.52633 batch_time=0.90700 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 1.39231 (QuantReg: 17.19180) QuantErr: 17.19180 batch_time=0.93499 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 0.99427 (QuantReg: 17.33740) QuantErr: 17.33740 batch_time=0.88108 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 0.81436 (QuantReg: 17.69972) QuantErr: 17.69972 batch_time=0.88745 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 1.03929 (QuantReg: 17.39437) QuantErr: 17.39437 batch_time=0.95175 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 0.86145 (QuantReg: 17.57569) QuantErr: 17.57569 batch_time=0.94680 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 1.43730 (QuantReg: 17.39553) QuantErr: 17.39553 batch_time=0.90001 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 1.76393 (QuantReg: 17.46362) QuantErr: 17.46362 batch_time=0.96119 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 1.13404 (QuantReg: 17.45635) QuantErr: 17.45635 batch_time=0.92148 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 1.02906 (QuantReg: 17.26150) QuantErr: 17.26150 batch_time=1.00622 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 1.38565 (QuantReg: 17.16531) QuantErr: 17.16531 batch_time=0.94524 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 1.27129 (QuantReg: 17.58937) QuantErr: 17.58937 batch_time=3.98821 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 1.16205 (QuantReg: 17.58273) QuantErr: 17.58273 batch_time=0.90555 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 1.04854 (QuantReg: 17.51839) QuantErr: 17.51839 batch_time=0.94883 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 1.34700 (QuantReg: 17.23050) QuantErr: 17.23050 batch_time=0.93811 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 1.00716 (QuantReg: 17.68786) QuantErr: 17.68786 batch_time=0.94475 
Train Epoch: 38 codebook_update_time=1.65918
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch38.pth ...
Done in 11.704s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch38.pth ...
Done in 22.527s
removing stale ckpt [epoch 37] [took 0.01s]
 epoch          : 38
 loss           : 1.297915860414505
 quant_reg      : 17.42899676513672
 quant_err      : 17.42899676513672
 learning_rate  : 2.9978050809763098e-06
 n_samples      : 1216000
 n_steps        : 9500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.2
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.461
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.66986456259252
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.439
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.602201232746886
 mnt_best       : 43.66986456259252
 not_improved_count: 0
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 1.12799 (QuantReg: 17.46900) QuantErr: 17.46900 batch_time=29.21287 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 1.19706 (QuantReg: 17.38817) QuantErr: 17.38817 batch_time=0.94077 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 1.35238 (QuantReg: 17.30345) QuantErr: 17.30345 batch_time=0.92536 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 1.53069 (QuantReg: 17.54175) QuantErr: 17.54175 batch_time=0.90234 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 1.52885 (QuantReg: 17.34590) QuantErr: 17.34590 batch_time=0.93279 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 1.17129 (QuantReg: 17.73761) QuantErr: 17.73761 batch_time=0.95578 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 1.29065 (QuantReg: 17.74599) QuantErr: 17.74599 batch_time=0.93519 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 1.39797 (QuantReg: 17.54202) QuantErr: 17.54202 batch_time=0.95722 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 1.86697 (QuantReg: 17.27266) QuantErr: 17.27266 batch_time=0.93610 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 1.48231 (QuantReg: 17.38457) QuantErr: 17.38457 batch_time=0.91656 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 1.18119 (QuantReg: 17.28129) QuantErr: 17.28129 batch_time=0.90149 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 1.15971 (QuantReg: 17.40223) QuantErr: 17.40223 batch_time=0.90370 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 1.13643 (QuantReg: 17.39871) QuantErr: 17.39871 batch_time=0.95969 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 1.14197 (QuantReg: 17.62862) QuantErr: 17.62862 batch_time=0.88136 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 1.50091 (QuantReg: 17.35096) QuantErr: 17.35096 batch_time=0.90482 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 1.34381 (QuantReg: 17.78543) QuantErr: 17.78543 batch_time=0.92638 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 1.24387 (QuantReg: 17.05811) QuantErr: 17.05811 batch_time=0.89954 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 1.12617 (QuantReg: 17.76703) QuantErr: 17.76703 batch_time=1.04638 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 1.33245 (QuantReg: 17.38186) QuantErr: 17.38186 batch_time=0.97513 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 1.40183 (QuantReg: 17.21843) QuantErr: 17.21843 batch_time=0.88785 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 1.35168 (QuantReg: 17.46024) QuantErr: 17.46024 batch_time=0.96443 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 1.10485 (QuantReg: 17.45207) QuantErr: 17.45207 batch_time=0.89271 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 1.28025 (QuantReg: 17.59054) QuantErr: 17.59054 batch_time=0.90663 
Train Epoch: 39 codebook_update_time=1.79341
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch39.pth ...
Done in 22.869s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch39.pth ...
Done in 34.273s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 1.286035008907318
 quant_reg      : 17.46959752655029
 quant_err      : 17.46959752655029
 learning_rate  : 2.847914826927494e-06
 n_samples      : 1248000
 n_steps        : 9750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.7
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.6
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.771
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.951814157080086
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 52.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 65.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.9
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0585
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.52548434051418
 mnt_best       : 43.951814157080086
 not_improved_count: 0
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 1.23433 (QuantReg: 17.36168) QuantErr: 17.36168 batch_time=29.81252 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 1.36902 (QuantReg: 17.51571) QuantErr: 17.51571 batch_time=0.91424 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 1.17887 (QuantReg: 17.73923) QuantErr: 17.73923 batch_time=0.94064 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 1.53732 (QuantReg: 17.26492) QuantErr: 17.26492 batch_time=0.93966 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 1.19930 (QuantReg: 17.70378) QuantErr: 17.70378 batch_time=0.99142 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 1.27038 (QuantReg: 17.47294) QuantErr: 17.47294 batch_time=0.92370 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 1.19287 (QuantReg: 17.90695) QuantErr: 17.90695 batch_time=0.93723 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 1.10125 (QuantReg: 17.92772) QuantErr: 17.92772 batch_time=0.92846 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 1.20982 (QuantReg: 17.52909) QuantErr: 17.52909 batch_time=1.02728 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 1.04467 (QuantReg: 17.38728) QuantErr: 17.38728 batch_time=0.96525 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 1.34624 (QuantReg: 17.16920) QuantErr: 17.16920 batch_time=0.93294 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 1.42104 (QuantReg: 17.75364) QuantErr: 17.75364 batch_time=0.94427 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 1.21630 (QuantReg: 17.54208) QuantErr: 17.54208 batch_time=0.90919 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 1.13150 (QuantReg: 17.78207) QuantErr: 17.78207 batch_time=0.94768 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 1.35211 (QuantReg: 17.60582) QuantErr: 17.60582 batch_time=0.90789 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 1.13768 (QuantReg: 17.90158) QuantErr: 17.90158 batch_time=0.92824 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 1.11952 (QuantReg: 17.62653) QuantErr: 17.62653 batch_time=0.97298 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 1.20587 (QuantReg: 17.39495) QuantErr: 17.39495 batch_time=0.94030 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 1.25665 (QuantReg: 17.51040) QuantErr: 17.51040 batch_time=0.94784 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 1.19536 (QuantReg: 17.67299) QuantErr: 17.67299 batch_time=0.96414 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 1.40921 (QuantReg: 17.80575) QuantErr: 17.80575 batch_time=0.95384 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 1.47743 (QuantReg: 17.53510) QuantErr: 17.53510 batch_time=0.95730 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 1.52274 (QuantReg: 17.53416) QuantErr: 17.53416 batch_time=0.98205 
Train Epoch: 40 codebook_update_time=1.72332
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch40.pth ...
Done in 12.716s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 1.2712743680477143
 quant_reg      : 17.55271324157715
 quant_err      : 17.55271324157715
 learning_rate  : 2.705519085581119e-06
 n_samples      : 1280000
 n_steps        : 10000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.2
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.206
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 42.79555009490557
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.5
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.7
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.5775
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.95910887625434
 mnt_best       : 43.951814157080086
 not_improved_count: 1
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 1.46482 (QuantReg: 17.17638) QuantErr: 17.17638 batch_time=46.76513 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 1.39298 (QuantReg: 17.19394) QuantErr: 17.19394 batch_time=0.92537 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 1.18092 (QuantReg: 17.63094) QuantErr: 17.63094 batch_time=0.93554 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 1.66953 (QuantReg: 17.21636) QuantErr: 17.21636 batch_time=0.92482 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 1.93522 (QuantReg: 17.70569) QuantErr: 17.70569 batch_time=1.00642 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 1.36731 (QuantReg: 17.71816) QuantErr: 17.71816 batch_time=0.95724 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 1.00803 (QuantReg: 17.46862) QuantErr: 17.46862 batch_time=0.93809 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 1.26491 (QuantReg: 17.44391) QuantErr: 17.44391 batch_time=0.96376 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 1.16413 (QuantReg: 17.43326) QuantErr: 17.43326 batch_time=0.97868 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 1.38534 (QuantReg: 17.50636) QuantErr: 17.50636 batch_time=1.01282 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 1.10810 (QuantReg: 17.68118) QuantErr: 17.68118 batch_time=0.91165 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 1.20919 (QuantReg: 17.33266) QuantErr: 17.33266 batch_time=1.00459 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 1.17129 (QuantReg: 17.59060) QuantErr: 17.59060 batch_time=0.94783 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 1.58479 (QuantReg: 17.60738) QuantErr: 17.60738 batch_time=0.94656 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 1.35808 (QuantReg: 17.51684) QuantErr: 17.51684 batch_time=1.10309 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 1.31343 (QuantReg: 17.60349) QuantErr: 17.60349 batch_time=0.94963 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 1.27628 (QuantReg: 17.60496) QuantErr: 17.60496 batch_time=0.93083 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 1.52022 (QuantReg: 17.51591) QuantErr: 17.51591 batch_time=0.91063 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 1.03095 (QuantReg: 17.95601) QuantErr: 17.95601 batch_time=0.96061 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 1.32116 (QuantReg: 17.40680) QuantErr: 17.40680 batch_time=0.91341 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 1.13263 (QuantReg: 17.60010) QuantErr: 17.60010 batch_time=0.93123 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 1.48036 (QuantReg: 17.63260) QuantErr: 17.63260 batch_time=0.92623 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 1.36053 (QuantReg: 17.84410) QuantErr: 17.84410 batch_time=0.95270 
Train Epoch: 41 codebook_update_time=1.79299
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch41.pth ...
Done in 11.150s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch41.pth ...
Done in 22.171s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.2995283749103546
 quant_reg      : 17.562919578552247
 quant_err      : 17.562919578552247
 learning_rate  : 2.5702431313020632e-06
 n_samples      : 1312000
 n_steps        : 10250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 67.4
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.454
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.03296083973012
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.3
 MSRVTT_jsfusion_test/v2t_metrics/R50: 88.8
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.96
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.050881212686456
 mnt_best       : 44.03296083973012
 not_improved_count: 0
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 1.30865 (QuantReg: 17.55376) QuantErr: 17.55376 batch_time=32.23731 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 1.20268 (QuantReg: 17.62446) QuantErr: 17.62446 batch_time=0.91752 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 1.18183 (QuantReg: 17.50982) QuantErr: 17.50982 batch_time=0.88913 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 1.07269 (QuantReg: 17.92924) QuantErr: 17.92924 batch_time=1.26183 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 1.16145 (QuantReg: 17.20461) QuantErr: 17.20461 batch_time=1.02402 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 1.37539 (QuantReg: 17.65470) QuantErr: 17.65470 batch_time=0.96190 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 1.30257 (QuantReg: 17.70903) QuantErr: 17.70903 batch_time=0.89418 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 1.29501 (QuantReg: 17.24157) QuantErr: 17.24157 batch_time=0.96825 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 1.12789 (QuantReg: 17.84622) QuantErr: 17.84622 batch_time=0.98693 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 1.26932 (QuantReg: 17.62047) QuantErr: 17.62047 batch_time=0.90751 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 1.07753 (QuantReg: 17.53397) QuantErr: 17.53397 batch_time=0.93850 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 1.13876 (QuantReg: 17.71816) QuantErr: 17.71816 batch_time=0.92797 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 1.08293 (QuantReg: 18.02952) QuantErr: 18.02952 batch_time=0.94833 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 1.01090 (QuantReg: 18.04838) QuantErr: 18.04838 batch_time=1.00583 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 1.25295 (QuantReg: 17.70820) QuantErr: 17.70820 batch_time=0.92708 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 1.29606 (QuantReg: 17.82382) QuantErr: 17.82382 batch_time=0.92954 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 1.00261 (QuantReg: 17.91649) QuantErr: 17.91649 batch_time=0.92414 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 1.06519 (QuantReg: 17.63575) QuantErr: 17.63575 batch_time=0.90440 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 1.76016 (QuantReg: 17.37007) QuantErr: 17.37007 batch_time=0.96095 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 1.20660 (QuantReg: 17.65970) QuantErr: 17.65970 batch_time=0.90617 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 1.05828 (QuantReg: 17.58604) QuantErr: 17.58604 batch_time=1.17918 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 1.10177 (QuantReg: 17.63371) QuantErr: 17.63371 batch_time=0.89845 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 1.25136 (QuantReg: 17.97440) QuantErr: 17.97440 batch_time=0.89302 
Train Epoch: 42 codebook_update_time=1.89028
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch42.pth ...
Done in 14.115s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.2787479426860808
 quant_reg      : 17.632617584228516
 quant_err      : 17.632617584228516
 learning_rate  : 2.44173097473696e-06
 n_samples      : 1344000
 n_steps        : 10500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.4
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.872
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.46622295372178
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.1
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.7
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.681
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.14177344683362
 mnt_best       : 44.03296083973012
 not_improved_count: 1
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 1.52679 (QuantReg: 17.88219) QuantErr: 17.88219 batch_time=29.10165 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 1.65368 (QuantReg: 17.44133) QuantErr: 17.44133 batch_time=0.89154 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 1.14962 (QuantReg: 17.63600) QuantErr: 17.63600 batch_time=0.89660 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 1.15690 (QuantReg: 17.50740) QuantErr: 17.50740 batch_time=0.91626 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 1.27212 (QuantReg: 17.41498) QuantErr: 17.41498 batch_time=0.96585 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 1.56454 (QuantReg: 17.61103) QuantErr: 17.61103 batch_time=0.87657 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 1.26035 (QuantReg: 17.80813) QuantErr: 17.80813 batch_time=1.64841 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 1.09481 (QuantReg: 17.65661) QuantErr: 17.65661 batch_time=0.93830 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 1.11317 (QuantReg: 17.59638) QuantErr: 17.59638 batch_time=0.94560 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 1.57517 (QuantReg: 17.61458) QuantErr: 17.61458 batch_time=1.29744 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 1.27937 (QuantReg: 17.59916) QuantErr: 17.59916 batch_time=0.89314 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 1.10257 (QuantReg: 17.73128) QuantErr: 17.73128 batch_time=0.91276 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 1.02875 (QuantReg: 17.71314) QuantErr: 17.71314 batch_time=0.94233 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 1.27741 (QuantReg: 17.64034) QuantErr: 17.64034 batch_time=0.93070 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 1.61454 (QuantReg: 17.34137) QuantErr: 17.34137 batch_time=0.93762 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 1.13115 (QuantReg: 17.68974) QuantErr: 17.68974 batch_time=1.02130 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 1.31951 (QuantReg: 17.84702) QuantErr: 17.84702 batch_time=0.92279 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 1.21321 (QuantReg: 17.85254) QuantErr: 17.85254 batch_time=1.42623 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 1.49814 (QuantReg: 17.96076) QuantErr: 17.96076 batch_time=0.91005 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 1.26612 (QuantReg: 17.61024) QuantErr: 17.61024 batch_time=1.09129 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 1.22479 (QuantReg: 17.58079) QuantErr: 17.58079 batch_time=0.95628 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 0.91012 (QuantReg: 17.72340) QuantErr: 17.72340 batch_time=0.89696 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 1.07273 (QuantReg: 17.72479) QuantErr: 17.72479 batch_time=0.95001 
Train Epoch: 43 codebook_update_time=1.65804
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch43.pth ...
Done in 25.155s
removing stale ckpt [epoch 42] [took 0.00s]
 epoch          : 43
 loss           : 1.2638245079517365
 quant_reg      : 17.67895440673828
 quant_err      : 17.67895440673828
 learning_rate  : 2.319644426000112e-06
 n_samples      : 1376000
 n_steps        : 10750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.2
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.8
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.8
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.872
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.30438861267449
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.6
 MSRVTT_jsfusion_test/v2t_metrics/R5: 53.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.2
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.887
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.37638444665638
 mnt_best       : 44.03296083973012
 not_improved_count: 2
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 1.27544 (QuantReg: 17.85733) QuantErr: 17.85733 batch_time=32.14146 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 1.57163 (QuantReg: 17.45064) QuantErr: 17.45064 batch_time=1.26324 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 1.15924 (QuantReg: 17.72601) QuantErr: 17.72601 batch_time=0.98976 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 1.12850 (QuantReg: 17.54651) QuantErr: 17.54651 batch_time=0.98035 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 1.32472 (QuantReg: 17.37649) QuantErr: 17.37649 batch_time=0.93071 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 1.28187 (QuantReg: 17.59057) QuantErr: 17.59057 batch_time=0.94106 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 1.23184 (QuantReg: 17.59946) QuantErr: 17.59946 batch_time=0.92353 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 1.32985 (QuantReg: 17.39228) QuantErr: 17.39228 batch_time=0.96592 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 1.13557 (QuantReg: 17.78068) QuantErr: 17.78068 batch_time=0.97052 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 1.29780 (QuantReg: 17.53238) QuantErr: 17.53238 batch_time=0.89978 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 1.27466 (QuantReg: 17.65424) QuantErr: 17.65424 batch_time=1.79239 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 1.21819 (QuantReg: 17.57215) QuantErr: 17.57215 batch_time=0.92845 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 1.44646 (QuantReg: 17.73384) QuantErr: 17.73384 batch_time=0.90754 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 1.31428 (QuantReg: 17.77498) QuantErr: 17.77498 batch_time=0.88037 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 1.52422 (QuantReg: 17.39894) QuantErr: 17.39894 batch_time=0.95010 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 1.29380 (QuantReg: 17.51509) QuantErr: 17.51509 batch_time=0.99185 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 0.90270 (QuantReg: 17.82331) QuantErr: 17.82331 batch_time=0.92651 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 1.39413 (QuantReg: 17.91953) QuantErr: 17.91953 batch_time=0.91164 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 1.48834 (QuantReg: 17.41172) QuantErr: 17.41172 batch_time=0.96770 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 1.47820 (QuantReg: 17.53078) QuantErr: 17.53078 batch_time=0.90031 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 1.16796 (QuantReg: 17.77603) QuantErr: 17.77603 batch_time=0.92799 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 1.25483 (QuantReg: 17.91951) QuantErr: 17.91951 batch_time=0.90879 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 1.25208 (QuantReg: 17.81282) QuantErr: 17.81282 batch_time=0.92347 
Train Epoch: 44 codebook_update_time=1.64683
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch44.pth ...
Done in 11.785s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.2592648680210115
 quant_reg      : 17.70757674407959
 quant_err      : 17.70757674407959
 learning_rate  : 2.2036622047001065e-06
 n_samples      : 1408000
 n_steps        : 11000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.9
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 26.814
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.73127954447364
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.4
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.9185
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.07480693184734
 mnt_best       : 44.03296083973012
 not_improved_count: 3
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 1.47664 (QuantReg: 17.75787) QuantErr: 17.75787 batch_time=27.98605 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 1.16322 (QuantReg: 17.77028) QuantErr: 17.77028 batch_time=0.91363 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 1.27075 (QuantReg: 17.65405) QuantErr: 17.65405 batch_time=0.99675 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 1.37548 (QuantReg: 17.75591) QuantErr: 17.75591 batch_time=0.92480 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 1.32604 (QuantReg: 17.73054) QuantErr: 17.73054 batch_time=0.93174 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 1.17083 (QuantReg: 17.85310) QuantErr: 17.85310 batch_time=0.92467 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 1.16144 (QuantReg: 17.70109) QuantErr: 17.70109 batch_time=0.96524 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 1.39008 (QuantReg: 17.66506) QuantErr: 17.66506 batch_time=0.97464 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 1.09543 (QuantReg: 17.61581) QuantErr: 17.61581 batch_time=0.89678 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 1.69363 (QuantReg: 17.73581) QuantErr: 17.73581 batch_time=0.90721 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 1.27523 (QuantReg: 17.59502) QuantErr: 17.59502 batch_time=0.92320 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 1.26968 (QuantReg: 17.76825) QuantErr: 17.76825 batch_time=0.94122 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 1.54736 (QuantReg: 17.50787) QuantErr: 17.50787 batch_time=0.90547 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 1.25420 (QuantReg: 17.96568) QuantErr: 17.96568 batch_time=3.11664 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 1.26235 (QuantReg: 17.85926) QuantErr: 17.85926 batch_time=0.93389 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 1.24586 (QuantReg: 17.84595) QuantErr: 17.84595 batch_time=0.99118 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 1.31666 (QuantReg: 17.76494) QuantErr: 17.76494 batch_time=0.92795 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 1.49858 (QuantReg: 17.79810) QuantErr: 17.79810 batch_time=0.91613 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 1.33069 (QuantReg: 17.89224) QuantErr: 17.89224 batch_time=1.32056 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 1.00094 (QuantReg: 17.64710) QuantErr: 17.64710 batch_time=0.92586 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 1.36691 (QuantReg: 17.51383) QuantErr: 17.51383 batch_time=0.91928 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 1.32881 (QuantReg: 17.75443) QuantErr: 17.75443 batch_time=0.88843 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 0.99204 (QuantReg: 17.82551) QuantErr: 17.82551 batch_time=0.88493 
Train Epoch: 45 codebook_update_time=1.63399
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch45.pth ...
Done in 11.594s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 1.2791468245983124
 quant_reg      : 17.747653579711915
 quant_err      : 17.747653579711915
 learning_rate  : 2.0934790944651013e-06
 n_samples      : 1440000
 n_steps        : 11250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.3
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.252
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.968538114826735
 MSRVTT_jsfusion_test/v2t_metrics/R1: 23.2
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.3
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.7245
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 43.995828805685754
 mnt_best       : 44.03296083973012
 not_improved_count: 4
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 0.88999 (QuantReg: 17.91348) QuantErr: 17.91348 batch_time=28.23993 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 1.53309 (QuantReg: 17.56332) QuantErr: 17.56332 batch_time=0.95182 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 1.31839 (QuantReg: 17.58936) QuantErr: 17.58936 batch_time=0.89544 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 1.18606 (QuantReg: 17.86241) QuantErr: 17.86241 batch_time=1.52817 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 1.43701 (QuantReg: 17.89735) QuantErr: 17.89735 batch_time=0.99757 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 1.11954 (QuantReg: 18.11816) QuantErr: 18.11816 batch_time=0.99665 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 0.99737 (QuantReg: 17.68438) QuantErr: 17.68438 batch_time=0.94271 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 1.18802 (QuantReg: 17.70074) QuantErr: 17.70074 batch_time=0.94883 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 1.24167 (QuantReg: 17.74811) QuantErr: 17.74811 batch_time=0.94833 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 1.15541 (QuantReg: 17.70287) QuantErr: 17.70287 batch_time=0.90510 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 1.16091 (QuantReg: 18.01615) QuantErr: 18.01615 batch_time=0.90718 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 1.15796 (QuantReg: 17.84498) QuantErr: 17.84498 batch_time=0.90918 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 1.19280 (QuantReg: 17.58254) QuantErr: 17.58254 batch_time=0.93262 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 1.10613 (QuantReg: 17.82474) QuantErr: 17.82474 batch_time=4.17584 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 1.44411 (QuantReg: 17.48489) QuantErr: 17.48489 batch_time=0.94758 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 0.90236 (QuantReg: 17.81471) QuantErr: 17.81471 batch_time=1.13467 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 1.14772 (QuantReg: 17.91213) QuantErr: 17.91213 batch_time=0.90256 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 1.25445 (QuantReg: 17.70912) QuantErr: 17.70912 batch_time=0.92215 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 0.97937 (QuantReg: 17.91044) QuantErr: 17.91044 batch_time=0.91711 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 1.18938 (QuantReg: 17.91012) QuantErr: 17.91012 batch_time=0.87879 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 1.13523 (QuantReg: 17.77503) QuantErr: 17.77503 batch_time=0.94959 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 1.04152 (QuantReg: 17.96982) QuantErr: 17.96982 batch_time=0.93805 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 1.47874 (QuantReg: 17.45233) QuantErr: 17.45233 batch_time=0.93649 
Train Epoch: 46 codebook_update_time=1.80814
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch46.pth ...
Done in 11.551s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 1.244900591135025
 quant_reg      : 17.798363220214842
 quant_err      : 17.798363220214842
 learning_rate  : 1.9888051397418463e-06
 n_samples      : 1472000
 n_steps        : 11500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.1
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.6
 MSRVTT_jsfusion_test/t2v_metrics/R10: 65.9
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.1
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.138
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.71489106017249
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.8
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.5
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.342
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.88398759057002
 mnt_best       : 44.03296083973012
 not_improved_count: 5
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 1.02830 (QuantReg: 17.89874) QuantErr: 17.89874 batch_time=30.38857 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 1.84734 (QuantReg: 17.43781) QuantErr: 17.43781 batch_time=0.95668 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 1.47577 (QuantReg: 17.78486) QuantErr: 17.78486 batch_time=2.08286 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 1.33846 (QuantReg: 17.63112) QuantErr: 17.63112 batch_time=0.95990 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 1.43102 (QuantReg: 17.49257) QuantErr: 17.49257 batch_time=0.98803 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 1.38178 (QuantReg: 18.14342) QuantErr: 18.14342 batch_time=0.92441 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 1.45802 (QuantReg: 17.72974) QuantErr: 17.72974 batch_time=0.93498 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 1.22323 (QuantReg: 17.92934) QuantErr: 17.92934 batch_time=0.91442 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 1.63136 (QuantReg: 17.70456) QuantErr: 17.70456 batch_time=0.89777 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 1.50601 (QuantReg: 17.82992) QuantErr: 17.82992 batch_time=0.87679 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 1.38908 (QuantReg: 18.00079) QuantErr: 18.00079 batch_time=0.90153 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 1.23284 (QuantReg: 17.75105) QuantErr: 17.75105 batch_time=0.95219 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 1.38372 (QuantReg: 17.79674) QuantErr: 17.79674 batch_time=0.98362 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 1.49443 (QuantReg: 18.01045) QuantErr: 18.01045 batch_time=0.94315 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 1.42788 (QuantReg: 17.72170) QuantErr: 17.72170 batch_time=2.15729 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 1.05616 (QuantReg: 17.80208) QuantErr: 17.80208 batch_time=0.94331 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 1.39759 (QuantReg: 17.70766) QuantErr: 17.70766 batch_time=0.94654 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 1.44491 (QuantReg: 17.80700) QuantErr: 17.80700 batch_time=0.94550 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 1.27688 (QuantReg: 17.94501) QuantErr: 17.94501 batch_time=0.91810 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 1.49300 (QuantReg: 17.57241) QuantErr: 17.57241 batch_time=0.92004 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 1.16959 (QuantReg: 17.89764) QuantErr: 17.89764 batch_time=0.91229 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 1.28789 (QuantReg: 17.97404) QuantErr: 17.97404 batch_time=0.93164 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 0.96960 (QuantReg: 17.82203) QuantErr: 17.82203 batch_time=0.97460 
Train Epoch: 47 codebook_update_time=1.73744
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch47.pth ...
Done in 11.285s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 1.2762269792556762
 quant_reg      : 17.834414138793946
 quant_err      : 17.834414138793946
 learning_rate  : 1.889364882754754e-06
 n_samples      : 1504000
 n_steps        : 11750
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.9
 MSRVTT_jsfusion_test/t2v_metrics/R5: 52.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.0
 MSRVTT_jsfusion_test/t2v_metrics/R50: 87.9
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.407
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.5603179615232
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.1
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.4
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.3
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.349
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.303572173704644
 mnt_best       : 44.03296083973012
 not_improved_count: 6
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 1.52355 (QuantReg: 17.59661) QuantErr: 17.59661 batch_time=29.37335 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 1.39407 (QuantReg: 17.74628) QuantErr: 17.74628 batch_time=0.93552 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 1.47260 (QuantReg: 17.97911) QuantErr: 17.97911 batch_time=0.93841 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 1.38194 (QuantReg: 17.44614) QuantErr: 17.44614 batch_time=1.00937 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 1.44175 (QuantReg: 18.06798) QuantErr: 18.06798 batch_time=0.88747 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 1.10908 (QuantReg: 17.92463) QuantErr: 17.92463 batch_time=1.01504 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 1.36526 (QuantReg: 17.69761) QuantErr: 17.69761 batch_time=1.89614 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 1.51064 (QuantReg: 17.31366) QuantErr: 17.31366 batch_time=0.93448 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 1.42431 (QuantReg: 18.12604) QuantErr: 18.12604 batch_time=0.90498 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 1.26338 (QuantReg: 17.86432) QuantErr: 17.86432 batch_time=0.94068 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 1.18635 (QuantReg: 17.83950) QuantErr: 17.83950 batch_time=0.87056 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 1.02041 (QuantReg: 17.94697) QuantErr: 17.94697 batch_time=0.93016 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 1.25722 (QuantReg: 17.72844) QuantErr: 17.72844 batch_time=1.12807 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 1.21725 (QuantReg: 17.86387) QuantErr: 17.86387 batch_time=1.05162 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 0.95890 (QuantReg: 17.89851) QuantErr: 17.89851 batch_time=1.00467 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 1.41449 (QuantReg: 17.44633) QuantErr: 17.44633 batch_time=0.91892 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 0.92524 (QuantReg: 18.09281) QuantErr: 18.09281 batch_time=0.91892 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 1.15790 (QuantReg: 18.02950) QuantErr: 18.02950 batch_time=1.03102 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 1.36064 (QuantReg: 17.80402) QuantErr: 17.80402 batch_time=0.96356 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 1.17456 (QuantReg: 17.96807) QuantErr: 17.96807 batch_time=0.99854 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 1.29272 (QuantReg: 17.86945) QuantErr: 17.86945 batch_time=0.93357 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 1.00320 (QuantReg: 18.15762) QuantErr: 18.15762 batch_time=0.91448 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 1.37984 (QuantReg: 17.63383) QuantErr: 17.63383 batch_time=0.95296 
Train Epoch: 48 codebook_update_time=1.66967
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch48.pth ...
Done in 10.924s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch48.pth ...
Done in 22.432s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 1.2799576630592346
 quant_reg      : 17.85642007446289
 quant_err      : 17.85642007446289
 learning_rate  : 1.7948966386170161e-06
 n_samples      : 1536000
 n_steps        : 12000
 MSRVTT_jsfusion_test/t2v_metrics/R1: 25.0
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.6
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.2
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.587
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.520841981252225
 MSRVTT_jsfusion_test/v2t_metrics/R1: 25.3
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.5
 MSRVTT_jsfusion_test/v2t_metrics/R10: 68.0
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.1
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 4.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 23.688
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 45.42992069844317
 mnt_best       : 44.520841981252225
 not_improved_count: 0
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 1.41562 (QuantReg: 17.58548) QuantErr: 17.58548 batch_time=29.81525 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 1.48709 (QuantReg: 17.95672) QuantErr: 17.95672 batch_time=0.97293 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 1.23991 (QuantReg: 17.79861) QuantErr: 17.79861 batch_time=1.23740 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 1.25241 (QuantReg: 17.99379) QuantErr: 17.99379 batch_time=0.98350 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 1.39712 (QuantReg: 17.68513) QuantErr: 17.68513 batch_time=1.00292 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 1.00497 (QuantReg: 17.98961) QuantErr: 17.98961 batch_time=1.04572 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 1.52402 (QuantReg: 17.86861) QuantErr: 17.86861 batch_time=5.44592 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 0.95777 (QuantReg: 17.89971) QuantErr: 17.89971 batch_time=0.98707 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 1.12496 (QuantReg: 17.85859) QuantErr: 17.85859 batch_time=0.86078 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 1.29899 (QuantReg: 17.76359) QuantErr: 17.76359 batch_time=0.94361 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 1.36698 (QuantReg: 17.88155) QuantErr: 17.88155 batch_time=0.93201 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 1.11502 (QuantReg: 18.10902) QuantErr: 18.10902 batch_time=0.99245 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 1.56475 (QuantReg: 18.08268) QuantErr: 18.08268 batch_time=0.88898 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 1.22814 (QuantReg: 17.79704) QuantErr: 17.79704 batch_time=0.96270 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 1.63854 (QuantReg: 17.83662) QuantErr: 17.83662 batch_time=0.97871 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 1.14555 (QuantReg: 17.98210) QuantErr: 17.98210 batch_time=0.95235 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 1.53285 (QuantReg: 17.87066) QuantErr: 17.87066 batch_time=0.96544 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 1.46362 (QuantReg: 17.91110) QuantErr: 17.91110 batch_time=1.01854 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 1.11730 (QuantReg: 18.08888) QuantErr: 18.08888 batch_time=0.98979 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 1.26916 (QuantReg: 17.87608) QuantErr: 17.87608 batch_time=0.96791 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 1.24914 (QuantReg: 17.88154) QuantErr: 17.88154 batch_time=1.01573 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 1.11272 (QuantReg: 17.85786) QuantErr: 17.85786 batch_time=1.01243 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 1.31400 (QuantReg: 17.79965) QuantErr: 17.79965 batch_time=0.94512 
Train Epoch: 49 codebook_update_time=1.84268
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch49.pth ...
Done in 11.316s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 1.268243914604187
 quant_reg      : 17.92393315887451
 quant_err      : 17.92393315887451
 learning_rate  : 1.7051518066861652e-06
 n_samples      : 1568000
 n_steps        : 12250
 MSRVTT_jsfusion_test/t2v_metrics/R1: 24.5
 MSRVTT_jsfusion_test/t2v_metrics/R5: 53.4
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.1
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.0
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.57
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 44.22178481545459
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.5
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.6
 MSRVTT_jsfusion_test/v2t_metrics/R10: 66.6
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.4
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.0725
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.66263261505894
 mnt_best       : 44.520841981252225
 not_improved_count: 1
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 1.22411 (QuantReg: 17.77697) QuantErr: 17.77697 batch_time=32.67562 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 1.54980 (QuantReg: 17.73855) QuantErr: 17.73855 batch_time=1.78547 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 1.42249 (QuantReg: 17.70304) QuantErr: 17.70304 batch_time=3.95142 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 1.27295 (QuantReg: 17.63283) QuantErr: 17.63283 batch_time=0.92555 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 1.07211 (QuantReg: 18.14008) QuantErr: 18.14008 batch_time=0.93501 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 1.38973 (QuantReg: 17.63318) QuantErr: 17.63318 batch_time=1.47986 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 1.19911 (QuantReg: 17.78819) QuantErr: 17.78819 batch_time=1.03905 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 1.10415 (QuantReg: 17.74857) QuantErr: 17.74857 batch_time=0.92381 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 1.08318 (QuantReg: 18.05165) QuantErr: 18.05165 batch_time=0.90684 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 1.22890 (QuantReg: 17.77096) QuantErr: 17.77096 batch_time=0.92379 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 1.15919 (QuantReg: 18.21033) QuantErr: 18.21033 batch_time=0.95916 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 1.51061 (QuantReg: 18.27232) QuantErr: 18.27232 batch_time=0.91412 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 1.37034 (QuantReg: 18.04386) QuantErr: 18.04386 batch_time=1.00657 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 1.43667 (QuantReg: 17.86997) QuantErr: 17.86997 batch_time=1.21315 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 1.36945 (QuantReg: 17.94283) QuantErr: 17.94283 batch_time=0.96209 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 1.60057 (QuantReg: 17.96600) QuantErr: 17.96600 batch_time=0.95212 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 1.38427 (QuantReg: 17.83964) QuantErr: 17.83964 batch_time=0.95018 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 1.31698 (QuantReg: 18.17289) QuantErr: 18.17289 batch_time=1.04121 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 1.12459 (QuantReg: 18.09631) QuantErr: 18.09631 batch_time=1.02611 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 1.15253 (QuantReg: 18.05404) QuantErr: 18.05404 batch_time=0.97997 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 1.01406 (QuantReg: 18.12332) QuantErr: 18.12332 batch_time=0.95758 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 0.97565 (QuantReg: 18.09637) QuantErr: 18.09637 batch_time=0.91379 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 1.21935 (QuantReg: 17.96652) QuantErr: 17.96652 batch_time=0.94630 
Train Epoch: 50 codebook_update_time=1.69657
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/checkpoint-epoch50.pth ...
Done in 28.470s
removing stale ckpt [epoch 49] [took 0.01s]
 epoch          : 50
 loss           : 1.270112888097763
 quant_reg      : 17.958469017028808
 quant_err      : 17.958469017028808
 learning_rate  : 1.6198942163518568e-06
 n_samples      : 1600000
 n_steps        : 12500
 MSRVTT_jsfusion_test/t2v_metrics/R1: 23.4
 MSRVTT_jsfusion_test/t2v_metrics/R5: 54.0
 MSRVTT_jsfusion_test/t2v_metrics/R10: 66.3
 MSRVTT_jsfusion_test/t2v_metrics/R50: 88.3
 MSRVTT_jsfusion_test/t2v_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/t2v_metrics/MeanR: 27.936
 MSRVTT_jsfusion_test/t2v_metrics/geometric_mean_R1-R5-R10: 43.75634607263534
 MSRVTT_jsfusion_test/v2t_metrics/R1: 24.7
 MSRVTT_jsfusion_test/v2t_metrics/R5: 54.2
 MSRVTT_jsfusion_test/v2t_metrics/R10: 67.9
 MSRVTT_jsfusion_test/v2t_metrics/R50: 89.6
 MSRVTT_jsfusion_test/v2t_metrics/MedR: 5.0
 MSRVTT_jsfusion_test/v2t_metrics/MeanR: 24.104
 MSRVTT_jsfusion_test/v2t_metrics/geometric_mean_R1-R5-R10: 44.96300597453651
 mnt_best       : 44.520841981252225
 not_improved_count: 2
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/trained_model.pth ...
Ckpt loaded at epoch 48.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/MSRVTT-test-qt-sims.npy
MSRVTT_jsfusion_test:
 t2v_metrics/R1/final_eval: 25.0
 t2v_metrics/R5/final_eval: 53.0
 t2v_metrics/R10/final_eval: 66.6
 t2v_metrics/R50/final_eval: 88.2
 t2v_metrics/MedR/final_eval: 5.0
 t2v_metrics/MeanR/final_eval: 27.587
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 44.520841981252225
 v2t_metrics/R1/final_eval: 25.3
 v2t_metrics/R5/final_eval: 54.5
 v2t_metrics/R10/final_eval: 68.0
 v2t_metrics/R50/final_eval: 89.1
 v2t_metrics/MedR/final_eval: 4.0
 v2t_metrics/MeanR/final_eval: 23.688
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 45.42992069844317
Best epoch for the monitored metric: 48
Script took 05h12m01s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_1kA_xlnet-large/trained_model.pth
