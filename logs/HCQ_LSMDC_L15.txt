Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15
Preparing the dataloaders ...
Loading dataset LSMDC_full_trainval in ram ...
Finish loading dataset LSMDC_full_trainval in ram, taking 3034.4266057014465 s.
Loading dataset LSMDC_full_test in ram ...
Finish loading dataset LSMDC_full_test in ram, taking 20.605026960372925 s.
Loading dataset LSMDC_full_test in ram ...
Finish loading dataset LSMDC_full_test in ram, taking 12.207675695419312 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch0.pth ...
Done in 1.403s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch0.pth ...
Done in 2.791s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 LSMDC_full_test/t2v_metrics/R1: 0.1
 LSMDC_full_test/t2v_metrics/R5: 0.4
 LSMDC_full_test/t2v_metrics/R10: 1.0
 LSMDC_full_test/t2v_metrics/R50: 5.0
 LSMDC_full_test/t2v_metrics/MedR: 507.5
 LSMDC_full_test/t2v_metrics/MeanR: 503.113
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.3419951893353394
 LSMDC_full_test/v2t_metrics/R1: 0.0
 LSMDC_full_test/v2t_metrics/R5: 0.4
 LSMDC_full_test/v2t_metrics/R10: 0.8
 LSMDC_full_test/v2t_metrics/R50: 4.9
 LSMDC_full_test/v2t_metrics/MedR: 502.0
 LSMDC_full_test/v2t_metrics/MeanR: 501.174
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 mnt_best       : 0.3419951893353394
 not_improved_count: 0
Train Epoch: 1 [1/250 128/32000 (0%)] Loss: 30.02033 (QuantReg: 22.58315) QuantErr: 22.58315 batch_time=12.60700 
Train Epoch: 1 [12/250 1536/32000 (5%)] Loss: 28.79362 (QuantReg: 22.55443) QuantErr: 22.55443 batch_time=0.61300 
Train Epoch: 1 [23/250 2944/32000 (9%)] Loss: 27.06283 (QuantReg: 22.60485) QuantErr: 22.60485 batch_time=0.60132 
Train Epoch: 1 [34/250 4352/32000 (14%)] Loss: 25.57468 (QuantReg: 22.57915) QuantErr: 22.57915 batch_time=0.59912 
Train Epoch: 1 [45/250 5760/32000 (18%)] Loss: 23.66705 (QuantReg: 22.67790) QuantErr: 22.67790 batch_time=0.60067 
Train Epoch: 1 [56/250 7168/32000 (22%)] Loss: 24.16905 (QuantReg: 22.65990) QuantErr: 22.65990 batch_time=0.61120 
Train Epoch: 1 [67/250 8576/32000 (27%)] Loss: 23.28362 (QuantReg: 22.65965) QuantErr: 22.65965 batch_time=0.71622 
Train Epoch: 1 [78/250 9984/32000 (31%)] Loss: 21.58935 (QuantReg: 22.62969) QuantErr: 22.62969 batch_time=0.60445 
Train Epoch: 1 [89/250 11392/32000 (36%)] Loss: 21.79805 (QuantReg: 22.64266) QuantErr: 22.64266 batch_time=0.59220 
Train Epoch: 1 [100/250 12800/32000 (40%)] Loss: 21.24980 (QuantReg: 22.66575) QuantErr: 22.66575 batch_time=0.60704 
Train Epoch: 1 [111/250 14208/32000 (44%)] Loss: 20.97132 (QuantReg: 22.65705) QuantErr: 22.65705 batch_time=0.60671 
Train Epoch: 1 [122/250 15616/32000 (49%)] Loss: 20.97261 (QuantReg: 22.67165) QuantErr: 22.67165 batch_time=0.61113 
Train Epoch: 1 [133/250 17024/32000 (53%)] Loss: 20.60770 (QuantReg: 22.65073) QuantErr: 22.65073 batch_time=1.13039 
Train Epoch: 1 [144/250 18432/32000 (58%)] Loss: 18.88217 (QuantReg: 22.65574) QuantErr: 22.65574 batch_time=1.05986 
Train Epoch: 1 [155/250 19840/32000 (62%)] Loss: 21.36782 (QuantReg: 22.64678) QuantErr: 22.64678 batch_time=0.61462 
Train Epoch: 1 [166/250 21248/32000 (66%)] Loss: 20.75636 (QuantReg: 22.61313) QuantErr: 22.61313 batch_time=0.62615 
Train Epoch: 1 [177/250 22656/32000 (71%)] Loss: 20.31746 (QuantReg: 22.65374) QuantErr: 22.65374 batch_time=0.59760 
Train Epoch: 1 [188/250 24064/32000 (75%)] Loss: 19.05165 (QuantReg: 22.68221) QuantErr: 22.68221 batch_time=0.60733 
Train Epoch: 1 [199/250 25472/32000 (80%)] Loss: 19.85156 (QuantReg: 22.68022) QuantErr: 22.68022 batch_time=0.61493 
Train Epoch: 1 [210/250 26880/32000 (84%)] Loss: 18.29740 (QuantReg: 22.65934) QuantErr: 22.65934 batch_time=2.22822 
Train Epoch: 1 [221/250 28288/32000 (88%)] Loss: 20.54351 (QuantReg: 22.65409) QuantErr: 22.65409 batch_time=0.60221 
Train Epoch: 1 [232/250 29696/32000 (93%)] Loss: 18.74141 (QuantReg: 22.67156) QuantErr: 22.67156 batch_time=0.62261 
Train Epoch: 1 [243/250 31104/32000 (97%)] Loss: 19.72237 (QuantReg: 22.66283) QuantErr: 22.66283 batch_time=0.62462 
Train Epoch: 1 codebook_update_time=3.70383
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch1.pth ...
Done in 4.219s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch1.pth ...
Done in 8.043s
 epoch          : 1
 loss           : 21.857082893371583
 quant_reg      : 22.645687774658203
 quant_err      : 22.645687774658203
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 250
 LSMDC_full_test/t2v_metrics/R1: 8.1
 LSMDC_full_test/t2v_metrics/R5: 18.6
 LSMDC_full_test/t2v_metrics/R10: 26.4
 LSMDC_full_test/t2v_metrics/R50: 55.7
 LSMDC_full_test/t2v_metrics/MedR: 37.0
 LSMDC_full_test/t2v_metrics/MeanR: 99.792
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 15.844089853009011
 LSMDC_full_test/v2t_metrics/R1: 7.0
 LSMDC_full_test/v2t_metrics/R5: 19.3
 LSMDC_full_test/v2t_metrics/R10: 27.1
 LSMDC_full_test/v2t_metrics/R50: 56.4
 LSMDC_full_test/v2t_metrics/MedR: 38.0
 LSMDC_full_test/v2t_metrics/MeanR: 101.976
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 15.412563537547877
 mnt_best       : 15.844089853009011
 not_improved_count: 0
Train Epoch: 2 [1/250 128/32000 (0%)] Loss: 19.84324 (QuantReg: 10.07362) QuantErr: 10.07362 batch_time=14.90569 
Train Epoch: 2 [12/250 1536/32000 (5%)] Loss: 19.32517 (QuantReg: 10.75407) QuantErr: 10.75407 batch_time=0.59524 
Train Epoch: 2 [23/250 2944/32000 (9%)] Loss: 17.44719 (QuantReg: 10.61300) QuantErr: 10.61300 batch_time=0.59313 
Train Epoch: 2 [34/250 4352/32000 (14%)] Loss: 19.89004 (QuantReg: 10.62928) QuantErr: 10.62928 batch_time=0.60890 
Train Epoch: 2 [45/250 5760/32000 (18%)] Loss: 19.07211 (QuantReg: 10.84240) QuantErr: 10.84240 batch_time=0.59211 
Train Epoch: 2 [56/250 7168/32000 (22%)] Loss: 18.13961 (QuantReg: 11.21694) QuantErr: 11.21694 batch_time=0.71144 
Train Epoch: 2 [67/250 8576/32000 (27%)] Loss: 18.68906 (QuantReg: 11.56114) QuantErr: 11.56114 batch_time=3.56899 
Train Epoch: 2 [78/250 9984/32000 (31%)] Loss: 18.34225 (QuantReg: 11.63389) QuantErr: 11.63389 batch_time=0.67172 
Train Epoch: 2 [89/250 11392/32000 (36%)] Loss: 16.91823 (QuantReg: 11.88288) QuantErr: 11.88288 batch_time=0.68101 
Train Epoch: 2 [100/250 12800/32000 (40%)] Loss: 17.47526 (QuantReg: 11.92499) QuantErr: 11.92499 batch_time=0.68004 
Train Epoch: 2 [111/250 14208/32000 (44%)] Loss: 17.08789 (QuantReg: 11.86138) QuantErr: 11.86138 batch_time=0.68433 
Train Epoch: 2 [122/250 15616/32000 (49%)] Loss: 16.46786 (QuantReg: 12.17782) QuantErr: 12.17782 batch_time=1.18291 
Train Epoch: 2 [133/250 17024/32000 (53%)] Loss: 18.88050 (QuantReg: 12.08986) QuantErr: 12.08986 batch_time=0.62020 
Train Epoch: 2 [144/250 18432/32000 (58%)] Loss: 18.51267 (QuantReg: 12.58485) QuantErr: 12.58485 batch_time=0.65308 
Train Epoch: 2 [155/250 19840/32000 (62%)] Loss: 16.40243 (QuantReg: 12.16273) QuantErr: 12.16273 batch_time=0.61900 
Train Epoch: 2 [166/250 21248/32000 (66%)] Loss: 18.42101 (QuantReg: 12.67813) QuantErr: 12.67813 batch_time=0.65433 
Train Epoch: 2 [177/250 22656/32000 (71%)] Loss: 17.41228 (QuantReg: 12.96694) QuantErr: 12.96694 batch_time=0.71770 
Train Epoch: 2 [188/250 24064/32000 (75%)] Loss: 17.12171 (QuantReg: 12.64137) QuantErr: 12.64137 batch_time=0.62077 
Train Epoch: 2 [199/250 25472/32000 (80%)] Loss: 16.30536 (QuantReg: 13.45646) QuantErr: 13.45646 batch_time=0.62808 
Train Epoch: 2 [210/250 26880/32000 (84%)] Loss: 16.94847 (QuantReg: 13.16302) QuantErr: 13.16302 batch_time=0.62548 
Train Epoch: 2 [221/250 28288/32000 (88%)] Loss: 17.08389 (QuantReg: 12.88763) QuantErr: 12.88763 batch_time=0.60713 
Train Epoch: 2 [232/250 29696/32000 (93%)] Loss: 17.16109 (QuantReg: 13.06465) QuantErr: 13.06465 batch_time=0.61670 
Train Epoch: 2 [243/250 31104/32000 (97%)] Loss: 16.37511 (QuantReg: 13.37994) QuantErr: 13.37994 batch_time=0.72046 
Train Epoch: 2 codebook_update_time=3.61679
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch2.pth ...
Done in 5.412s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch2.pth ...
Done in 10.381s
removing stale ckpt [epoch 1] [took 0.04s]
removing stale ckpt [epoch 0] [took 0.01s]
 epoch          : 2
 loss           : 17.86625744628906
 quant_reg      : 12.045957820892333
 quant_err      : 12.045957820892333
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 500
 LSMDC_full_test/t2v_metrics/R1: 8.1
 LSMDC_full_test/t2v_metrics/R5: 21.5
 LSMDC_full_test/t2v_metrics/R10: 30.0
 LSMDC_full_test/t2v_metrics/R50: 60.7
 LSMDC_full_test/t2v_metrics/MedR: 32.0
 LSMDC_full_test/t2v_metrics/MeanR: 87.669
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 17.35194827897326
 LSMDC_full_test/v2t_metrics/R1: 7.7
 LSMDC_full_test/v2t_metrics/R5: 22.2
 LSMDC_full_test/v2t_metrics/R10: 31.2
 LSMDC_full_test/v2t_metrics/R50: 59.7
 LSMDC_full_test/v2t_metrics/MedR: 31.0
 LSMDC_full_test/v2t_metrics/MeanR: 84.663
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.471603470854273
 mnt_best       : 17.35194827897326
 not_improved_count: 0
Train Epoch: 3 [1/250 128/32000 (0%)] Loss: 17.03244 (QuantReg: 10.76640) QuantErr: 10.76640 batch_time=15.48008 
Train Epoch: 3 [12/250 1536/32000 (5%)] Loss: 15.69376 (QuantReg: 11.73874) QuantErr: 11.73874 batch_time=0.61964 
Train Epoch: 3 [23/250 2944/32000 (9%)] Loss: 15.14131 (QuantReg: 11.58997) QuantErr: 11.58997 batch_time=0.60807 
Train Epoch: 3 [34/250 4352/32000 (14%)] Loss: 16.71890 (QuantReg: 11.52647) QuantErr: 11.52647 batch_time=0.60527 
Train Epoch: 3 [45/250 5760/32000 (18%)] Loss: 16.54562 (QuantReg: 12.13310) QuantErr: 12.13310 batch_time=0.60531 
Train Epoch: 3 [56/250 7168/32000 (22%)] Loss: 16.34896 (QuantReg: 11.73885) QuantErr: 11.73885 batch_time=0.60657 
Train Epoch: 3 [67/250 8576/32000 (27%)] Loss: 16.08957 (QuantReg: 11.37755) QuantErr: 11.37755 batch_time=0.62120 
Train Epoch: 3 [78/250 9984/32000 (31%)] Loss: 16.67953 (QuantReg: 12.11074) QuantErr: 12.11074 batch_time=0.61115 
Train Epoch: 3 [89/250 11392/32000 (36%)] Loss: 15.90207 (QuantReg: 11.84967) QuantErr: 11.84967 batch_time=0.60727 
Train Epoch: 3 [100/250 12800/32000 (40%)] Loss: 15.56297 (QuantReg: 11.74323) QuantErr: 11.74323 batch_time=0.60764 
Train Epoch: 3 [111/250 14208/32000 (44%)] Loss: 15.29020 (QuantReg: 11.86427) QuantErr: 11.86427 batch_time=0.60481 
Train Epoch: 3 [122/250 15616/32000 (49%)] Loss: 16.08958 (QuantReg: 12.23417) QuantErr: 12.23417 batch_time=0.63860 
Train Epoch: 3 [133/250 17024/32000 (53%)] Loss: 16.54810 (QuantReg: 11.74092) QuantErr: 11.74092 batch_time=0.61927 
Train Epoch: 3 [144/250 18432/32000 (58%)] Loss: 18.60180 (QuantReg: 12.05889) QuantErr: 12.05889 batch_time=0.64283 
Train Epoch: 3 [155/250 19840/32000 (62%)] Loss: 15.23124 (QuantReg: 12.01852) QuantErr: 12.01852 batch_time=0.60450 
Train Epoch: 3 [166/250 21248/32000 (66%)] Loss: 16.37903 (QuantReg: 12.13189) QuantErr: 12.13189 batch_time=0.60083 
Train Epoch: 3 [177/250 22656/32000 (71%)] Loss: 16.54672 (QuantReg: 12.33619) QuantErr: 12.33619 batch_time=0.61085 
Train Epoch: 3 [188/250 24064/32000 (75%)] Loss: 17.02144 (QuantReg: 12.51968) QuantErr: 12.51968 batch_time=0.82983 
Train Epoch: 3 [199/250 25472/32000 (80%)] Loss: 15.24991 (QuantReg: 12.75379) QuantErr: 12.75379 batch_time=0.60484 
Train Epoch: 3 [210/250 26880/32000 (84%)] Loss: 17.06058 (QuantReg: 12.80133) QuantErr: 12.80133 batch_time=0.60948 
Train Epoch: 3 [221/250 28288/32000 (88%)] Loss: 15.40405 (QuantReg: 12.56951) QuantErr: 12.56951 batch_time=0.60881 
Train Epoch: 3 [232/250 29696/32000 (93%)] Loss: 15.18246 (QuantReg: 12.60635) QuantErr: 12.60635 batch_time=0.71551 
Train Epoch: 3 [243/250 31104/32000 (97%)] Loss: 15.11765 (QuantReg: 12.73829) QuantErr: 12.73829 batch_time=0.61552 
Train Epoch: 3 codebook_update_time=3.32349
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch3.pth ...
Done in 4.300s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch3.pth ...
Done in 10.574s
removing stale ckpt [epoch 2] [took 0.01s]
 epoch          : 3
 loss           : 16.228526695251464
 quant_reg      : 12.037349704742432
 quant_err      : 12.037349704742432
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 750
 LSMDC_full_test/t2v_metrics/R1: 8.4
 LSMDC_full_test/t2v_metrics/R5: 25.1
 LSMDC_full_test/t2v_metrics/R10: 33.7
 LSMDC_full_test/t2v_metrics/R50: 62.2
 LSMDC_full_test/t2v_metrics/MedR: 26.0
 LSMDC_full_test/t2v_metrics/MeanR: 84.617
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 19.224761888123616
 LSMDC_full_test/v2t_metrics/R1: 9.6
 LSMDC_full_test/v2t_metrics/R5: 25.6
 LSMDC_full_test/v2t_metrics/R10: 34.6
 LSMDC_full_test/v2t_metrics/R50: 63.0
 LSMDC_full_test/v2t_metrics/MedR: 25.0
 LSMDC_full_test/v2t_metrics/MeanR: 81.638
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.410913038352767
 mnt_best       : 19.224761888123616
 not_improved_count: 0
Train Epoch: 4 [1/250 128/32000 (0%)] Loss: 16.52729 (QuantReg: 11.37473) QuantErr: 11.37473 batch_time=20.54268 
Train Epoch: 4 [12/250 1536/32000 (5%)] Loss: 14.93070 (QuantReg: 11.96233) QuantErr: 11.96233 batch_time=0.61232 
Train Epoch: 4 [23/250 2944/32000 (9%)] Loss: 14.96355 (QuantReg: 12.23533) QuantErr: 12.23533 batch_time=1.41581 
Train Epoch: 4 [34/250 4352/32000 (14%)] Loss: 14.58323 (QuantReg: 12.54834) QuantErr: 12.54834 batch_time=0.84814 
Train Epoch: 4 [45/250 5760/32000 (18%)] Loss: 16.28649 (QuantReg: 12.25591) QuantErr: 12.25591 batch_time=0.62302 
Train Epoch: 4 [56/250 7168/32000 (22%)] Loss: 14.58000 (QuantReg: 12.18186) QuantErr: 12.18186 batch_time=0.64327 
Train Epoch: 4 [67/250 8576/32000 (27%)] Loss: 15.29297 (QuantReg: 12.21440) QuantErr: 12.21440 batch_time=0.60191 
Train Epoch: 4 [78/250 9984/32000 (31%)] Loss: 14.27994 (QuantReg: 12.66849) QuantErr: 12.66849 batch_time=0.61997 
Train Epoch: 4 [89/250 11392/32000 (36%)] Loss: 16.18463 (QuantReg: 12.43404) QuantErr: 12.43404 batch_time=0.60926 
Train Epoch: 4 [100/250 12800/32000 (40%)] Loss: 17.21956 (QuantReg: 12.16849) QuantErr: 12.16849 batch_time=0.68046 
Train Epoch: 4 [111/250 14208/32000 (44%)] Loss: 14.50321 (QuantReg: 12.38297) QuantErr: 12.38297 batch_time=0.58934 
Train Epoch: 4 [122/250 15616/32000 (49%)] Loss: 14.72744 (QuantReg: 12.41598) QuantErr: 12.41598 batch_time=0.61262 
Train Epoch: 4 [133/250 17024/32000 (53%)] Loss: 14.87195 (QuantReg: 12.56675) QuantErr: 12.56675 batch_time=0.61064 
Train Epoch: 4 [144/250 18432/32000 (58%)] Loss: 14.68629 (QuantReg: 12.86652) QuantErr: 12.86652 batch_time=0.81990 
Train Epoch: 4 [155/250 19840/32000 (62%)] Loss: 14.53106 (QuantReg: 12.57062) QuantErr: 12.57062 batch_time=0.62694 
Train Epoch: 4 [166/250 21248/32000 (66%)] Loss: 15.15368 (QuantReg: 13.11463) QuantErr: 13.11463 batch_time=0.65318 
Train Epoch: 4 [177/250 22656/32000 (71%)] Loss: 15.96990 (QuantReg: 12.64156) QuantErr: 12.64156 batch_time=0.67502 
Train Epoch: 4 [188/250 24064/32000 (75%)] Loss: 13.72798 (QuantReg: 12.98936) QuantErr: 12.98936 batch_time=0.59455 
Train Epoch: 4 [199/250 25472/32000 (80%)] Loss: 14.34755 (QuantReg: 12.75610) QuantErr: 12.75610 batch_time=0.59274 
Train Epoch: 4 [210/250 26880/32000 (84%)] Loss: 12.52170 (QuantReg: 12.50914) QuantErr: 12.50914 batch_time=0.58968 
Train Epoch: 4 [221/250 28288/32000 (88%)] Loss: 15.34996 (QuantReg: 12.64208) QuantErr: 12.64208 batch_time=0.60834 
Train Epoch: 4 [232/250 29696/32000 (93%)] Loss: 14.83895 (QuantReg: 12.78320) QuantErr: 12.78320 batch_time=0.80668 
Train Epoch: 4 [243/250 31104/32000 (97%)] Loss: 15.49538 (QuantReg: 13.30893) QuantErr: 13.30893 batch_time=0.59330 
Train Epoch: 4 codebook_update_time=3.26337
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch4.pth ...
Done in 3.957s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch4.pth ...
Done in 8.819s
removing stale ckpt [epoch 3] [took 0.09s]
 epoch          : 4
 loss           : 15.125331176757813
 quant_reg      : 12.496103546142578
 quant_err      : 12.496103546142578
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 1000
 LSMDC_full_test/t2v_metrics/R1: 10.0
 LSMDC_full_test/t2v_metrics/R5: 26.3
 LSMDC_full_test/t2v_metrics/R10: 34.5
 LSMDC_full_test/t2v_metrics/R50: 64.5
 LSMDC_full_test/t2v_metrics/MedR: 23.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.017
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.857309285681975
 LSMDC_full_test/v2t_metrics/R1: 9.9
 LSMDC_full_test/v2t_metrics/R5: 27.4
 LSMDC_full_test/v2t_metrics/R10: 36.4
 LSMDC_full_test/v2t_metrics/R50: 63.6
 LSMDC_full_test/v2t_metrics/MedR: 22.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.462
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.453379420928414
 mnt_best       : 20.857309285681975
 not_improved_count: 0
Train Epoch: 5 [1/250 128/32000 (0%)] Loss: 15.65095 (QuantReg: 12.47552) QuantErr: 12.47552 batch_time=19.10624 
Train Epoch: 5 [12/250 1536/32000 (5%)] Loss: 15.50409 (QuantReg: 11.80375) QuantErr: 11.80375 batch_time=0.60717 
Train Epoch: 5 [23/250 2944/32000 (9%)] Loss: 14.02215 (QuantReg: 12.69596) QuantErr: 12.69596 batch_time=0.61524 
Train Epoch: 5 [34/250 4352/32000 (14%)] Loss: 14.00186 (QuantReg: 11.84037) QuantErr: 11.84037 batch_time=0.60917 
Train Epoch: 5 [45/250 5760/32000 (18%)] Loss: 13.28046 (QuantReg: 12.77787) QuantErr: 12.77787 batch_time=0.59801 
Train Epoch: 5 [56/250 7168/32000 (22%)] Loss: 14.56681 (QuantReg: 12.76479) QuantErr: 12.76479 batch_time=0.62169 
Train Epoch: 5 [67/250 8576/32000 (27%)] Loss: 15.03531 (QuantReg: 12.29852) QuantErr: 12.29852 batch_time=0.60472 
Train Epoch: 5 [78/250 9984/32000 (31%)] Loss: 15.18400 (QuantReg: 12.62734) QuantErr: 12.62734 batch_time=0.60470 
Train Epoch: 5 [89/250 11392/32000 (36%)] Loss: 14.41819 (QuantReg: 12.86208) QuantErr: 12.86208 batch_time=0.60241 
Train Epoch: 5 [100/250 12800/32000 (40%)] Loss: 14.55834 (QuantReg: 12.68379) QuantErr: 12.68379 batch_time=0.61629 
Train Epoch: 5 [111/250 14208/32000 (44%)] Loss: 15.22928 (QuantReg: 13.00969) QuantErr: 13.00969 batch_time=0.61914 
Train Epoch: 5 [122/250 15616/32000 (49%)] Loss: 15.14270 (QuantReg: 13.33170) QuantErr: 13.33170 batch_time=0.61723 
Train Epoch: 5 [133/250 17024/32000 (53%)] Loss: 14.70173 (QuantReg: 13.18095) QuantErr: 13.18095 batch_time=0.62107 
Train Epoch: 5 [144/250 18432/32000 (58%)] Loss: 15.48029 (QuantReg: 13.07189) QuantErr: 13.07189 batch_time=0.60433 
Train Epoch: 5 [155/250 19840/32000 (62%)] Loss: 13.96784 (QuantReg: 12.90397) QuantErr: 12.90397 batch_time=0.60342 
Train Epoch: 5 [166/250 21248/32000 (66%)] Loss: 14.37729 (QuantReg: 12.76911) QuantErr: 12.76911 batch_time=0.60352 
Train Epoch: 5 [177/250 22656/32000 (71%)] Loss: 14.11780 (QuantReg: 13.01279) QuantErr: 13.01279 batch_time=0.61032 
Train Epoch: 5 [188/250 24064/32000 (75%)] Loss: 15.22858 (QuantReg: 12.84350) QuantErr: 12.84350 batch_time=0.60704 
Train Epoch: 5 [199/250 25472/32000 (80%)] Loss: 13.51091 (QuantReg: 12.92829) QuantErr: 12.92829 batch_time=0.61251 
Train Epoch: 5 [210/250 26880/32000 (84%)] Loss: 13.28470 (QuantReg: 13.10967) QuantErr: 13.10967 batch_time=0.60687 
Train Epoch: 5 [221/250 28288/32000 (88%)] Loss: 15.86467 (QuantReg: 13.05913) QuantErr: 13.05913 batch_time=0.61385 
Train Epoch: 5 [232/250 29696/32000 (93%)] Loss: 14.19203 (QuantReg: 13.26529) QuantErr: 13.26529 batch_time=1.20047 
Train Epoch: 5 [243/250 31104/32000 (97%)] Loss: 12.49185 (QuantReg: 12.82064) QuantErr: 12.82064 batch_time=0.61996 
Train Epoch: 5 codebook_update_time=3.60669
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch5.pth ...
Done in 4.063s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch5.pth ...
Done in 8.351s
removing stale ckpt [epoch 4] [took 0.01s]
 epoch          : 5
 loss           : 14.279127712249755
 quant_reg      : 12.787982315063477
 quant_err      : 12.787982315063477
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 1250
 LSMDC_full_test/t2v_metrics/R1: 11.0
 LSMDC_full_test/t2v_metrics/R5: 25.3
 LSMDC_full_test/t2v_metrics/R10: 35.0
 LSMDC_full_test/t2v_metrics/R50: 65.2
 LSMDC_full_test/t2v_metrics/MedR: 23.0
 LSMDC_full_test/t2v_metrics/MeanR: 77.194
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.35635264818574
 LSMDC_full_test/v2t_metrics/R1: 9.1
 LSMDC_full_test/v2t_metrics/R5: 26.9
 LSMDC_full_test/v2t_metrics/R10: 37.2
 LSMDC_full_test/v2t_metrics/R50: 64.7
 LSMDC_full_test/v2t_metrics/MedR: 24.0
 LSMDC_full_test/v2t_metrics/MeanR: 75.829
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 20.8823259692134
 mnt_best       : 21.35635264818574
 not_improved_count: 0
Train Epoch: 6 [1/250 128/32000 (0%)] Loss: 14.54017 (QuantReg: 12.53513) QuantErr: 12.53513 batch_time=20.63973 
Train Epoch: 6 [12/250 1536/32000 (5%)] Loss: 12.26367 (QuantReg: 12.91728) QuantErr: 12.91728 batch_time=0.60945 
Train Epoch: 6 [23/250 2944/32000 (9%)] Loss: 15.01377 (QuantReg: 13.03047) QuantErr: 13.03047 batch_time=0.60607 
Train Epoch: 6 [34/250 4352/32000 (14%)] Loss: 13.88177 (QuantReg: 12.78374) QuantErr: 12.78374 batch_time=0.61935 
Train Epoch: 6 [45/250 5760/32000 (18%)] Loss: 12.16513 (QuantReg: 12.80488) QuantErr: 12.80488 batch_time=0.60574 
Train Epoch: 6 [56/250 7168/32000 (22%)] Loss: 15.34412 (QuantReg: 12.73779) QuantErr: 12.73779 batch_time=0.61511 
Train Epoch: 6 [67/250 8576/32000 (27%)] Loss: 12.70683 (QuantReg: 13.00432) QuantErr: 13.00432 batch_time=1.50923 
Train Epoch: 6 [78/250 9984/32000 (31%)] Loss: 11.84818 (QuantReg: 13.37119) QuantErr: 13.37119 batch_time=0.60673 
Train Epoch: 6 [89/250 11392/32000 (36%)] Loss: 13.87495 (QuantReg: 12.73455) QuantErr: 12.73455 batch_time=0.64532 
Train Epoch: 6 [100/250 12800/32000 (40%)] Loss: 12.89394 (QuantReg: 12.79802) QuantErr: 12.79802 batch_time=0.65273 
Train Epoch: 6 [111/250 14208/32000 (44%)] Loss: 12.93491 (QuantReg: 12.75261) QuantErr: 12.75261 batch_time=0.60906 
Train Epoch: 6 [122/250 15616/32000 (49%)] Loss: 13.97346 (QuantReg: 12.74315) QuantErr: 12.74315 batch_time=0.60671 
Train Epoch: 6 [133/250 17024/32000 (53%)] Loss: 14.30153 (QuantReg: 13.37123) QuantErr: 13.37123 batch_time=0.83242 
Train Epoch: 6 [144/250 18432/32000 (58%)] Loss: 13.87436 (QuantReg: 13.03050) QuantErr: 13.03050 batch_time=1.12896 
Train Epoch: 6 [155/250 19840/32000 (62%)] Loss: 13.07190 (QuantReg: 12.93735) QuantErr: 12.93735 batch_time=0.64458 
Train Epoch: 6 [166/250 21248/32000 (66%)] Loss: 13.26043 (QuantReg: 13.31617) QuantErr: 13.31617 batch_time=0.60286 
Train Epoch: 6 [177/250 22656/32000 (71%)] Loss: 13.32164 (QuantReg: 13.58489) QuantErr: 13.58489 batch_time=0.60946 
Train Epoch: 6 [188/250 24064/32000 (75%)] Loss: 13.90484 (QuantReg: 13.09283) QuantErr: 13.09283 batch_time=0.61628 
Train Epoch: 6 [199/250 25472/32000 (80%)] Loss: 14.31351 (QuantReg: 13.59076) QuantErr: 13.59076 batch_time=0.93056 
Train Epoch: 6 [210/250 26880/32000 (84%)] Loss: 15.01466 (QuantReg: 13.21178) QuantErr: 13.21178 batch_time=0.60851 
Train Epoch: 6 [221/250 28288/32000 (88%)] Loss: 13.13561 (QuantReg: 13.09336) QuantErr: 13.09336 batch_time=0.61521 
Train Epoch: 6 [232/250 29696/32000 (93%)] Loss: 14.43031 (QuantReg: 13.30154) QuantErr: 13.30154 batch_time=0.81547 
Train Epoch: 6 [243/250 31104/32000 (97%)] Loss: 12.13791 (QuantReg: 13.57454) QuantErr: 13.57454 batch_time=0.81974 
Train Epoch: 6 codebook_update_time=3.34280
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch6.pth ...
Done in 5.863s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch6.pth ...
Done in 10.281s
removing stale ckpt [epoch 5] [took 0.25s]
 epoch          : 6
 loss           : 13.578512992858887
 quant_reg      : 13.13257447052002
 quant_err      : 13.13257447052002
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 1500
 LSMDC_full_test/t2v_metrics/R1: 11.2
 LSMDC_full_test/t2v_metrics/R5: 27.7
 LSMDC_full_test/t2v_metrics/R10: 37.4
 LSMDC_full_test/t2v_metrics/R50: 65.8
 LSMDC_full_test/t2v_metrics/MedR: 21.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.007
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.638959609572165
 LSMDC_full_test/v2t_metrics/R1: 10.9
 LSMDC_full_test/v2t_metrics/R5: 27.6
 LSMDC_full_test/v2t_metrics/R10: 37.7
 LSMDC_full_test/v2t_metrics/R50: 66.4
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.983
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.467718645494752
 mnt_best       : 22.638959609572165
 not_improved_count: 0
Train Epoch: 7 [1/250 128/32000 (0%)] Loss: 15.01007 (QuantReg: 12.67152) QuantErr: 12.67152 batch_time=18.90801 
Train Epoch: 7 [12/250 1536/32000 (5%)] Loss: 13.05971 (QuantReg: 13.09090) QuantErr: 13.09090 batch_time=0.61504 
Train Epoch: 7 [23/250 2944/32000 (9%)] Loss: 14.67229 (QuantReg: 13.48520) QuantErr: 13.48520 batch_time=1.19895 
Train Epoch: 7 [34/250 4352/32000 (14%)] Loss: 12.46377 (QuantReg: 13.46013) QuantErr: 13.46013 batch_time=0.71262 
Train Epoch: 7 [45/250 5760/32000 (18%)] Loss: 12.98610 (QuantReg: 13.15007) QuantErr: 13.15007 batch_time=0.61332 
Train Epoch: 7 [56/250 7168/32000 (22%)] Loss: 13.14126 (QuantReg: 13.60259) QuantErr: 13.60259 batch_time=0.92313 
Train Epoch: 7 [67/250 8576/32000 (27%)] Loss: 12.89764 (QuantReg: 13.41224) QuantErr: 13.41224 batch_time=1.64396 
Train Epoch: 7 [78/250 9984/32000 (31%)] Loss: 13.59983 (QuantReg: 13.22202) QuantErr: 13.22202 batch_time=0.59521 
Train Epoch: 7 [89/250 11392/32000 (36%)] Loss: 13.62476 (QuantReg: 13.39924) QuantErr: 13.39924 batch_time=0.59154 
Train Epoch: 7 [100/250 12800/32000 (40%)] Loss: 13.86290 (QuantReg: 13.35893) QuantErr: 13.35893 batch_time=1.25807 
Train Epoch: 7 [111/250 14208/32000 (44%)] Loss: 12.20646 (QuantReg: 13.17483) QuantErr: 13.17483 batch_time=0.60923 
Train Epoch: 7 [122/250 15616/32000 (49%)] Loss: 13.42391 (QuantReg: 13.73861) QuantErr: 13.73861 batch_time=0.59864 
Train Epoch: 7 [133/250 17024/32000 (53%)] Loss: 12.25331 (QuantReg: 13.52029) QuantErr: 13.52029 batch_time=0.59895 
Train Epoch: 7 [144/250 18432/32000 (58%)] Loss: 11.80625 (QuantReg: 13.56979) QuantErr: 13.56979 batch_time=1.46676 
Train Epoch: 7 [155/250 19840/32000 (62%)] Loss: 12.78524 (QuantReg: 13.47581) QuantErr: 13.47581 batch_time=0.61298 
Train Epoch: 7 [166/250 21248/32000 (66%)] Loss: 11.96917 (QuantReg: 13.40262) QuantErr: 13.40262 batch_time=0.61147 
Train Epoch: 7 [177/250 22656/32000 (71%)] Loss: 11.48593 (QuantReg: 13.66244) QuantErr: 13.66244 batch_time=0.59752 
Train Epoch: 7 [188/250 24064/32000 (75%)] Loss: 13.32694 (QuantReg: 14.06351) QuantErr: 14.06351 batch_time=0.60738 
Train Epoch: 7 [199/250 25472/32000 (80%)] Loss: 11.33280 (QuantReg: 13.77400) QuantErr: 13.77400 batch_time=0.59295 
Train Epoch: 7 [210/250 26880/32000 (84%)] Loss: 11.65698 (QuantReg: 13.98858) QuantErr: 13.98858 batch_time=1.64654 
Train Epoch: 7 [221/250 28288/32000 (88%)] Loss: 14.04742 (QuantReg: 13.73846) QuantErr: 13.73846 batch_time=0.61092 
Train Epoch: 7 [232/250 29696/32000 (93%)] Loss: 14.68911 (QuantReg: 13.45441) QuantErr: 13.45441 batch_time=0.61951 
Train Epoch: 7 [243/250 31104/32000 (97%)] Loss: 14.99003 (QuantReg: 13.22573) QuantErr: 13.22573 batch_time=0.60616 
Train Epoch: 7 codebook_update_time=3.55067
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch7.pth ...
Done in 5.550s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch7.pth ...
Done in 10.896s
removing stale ckpt [epoch 6] [took 0.35s]
 epoch          : 7
 loss           : 12.928705284118653
 quant_reg      : 13.498936592102051
 quant_err      : 13.498936592102051
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 1750
 LSMDC_full_test/t2v_metrics/R1: 11.6
 LSMDC_full_test/t2v_metrics/R5: 27.6
 LSMDC_full_test/t2v_metrics/R10: 37.0
 LSMDC_full_test/t2v_metrics/R50: 66.7
 LSMDC_full_test/t2v_metrics/MedR: 19.5
 LSMDC_full_test/t2v_metrics/MeanR: 72.2
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.795874907759682
 LSMDC_full_test/v2t_metrics/R1: 10.8
 LSMDC_full_test/v2t_metrics/R5: 28.6
 LSMDC_full_test/v2t_metrics/R10: 37.5
 LSMDC_full_test/v2t_metrics/R50: 66.7
 LSMDC_full_test/v2t_metrics/MedR: 21.0
 LSMDC_full_test/v2t_metrics/MeanR: 68.999
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.625960196523028
 mnt_best       : 22.795874907759682
 not_improved_count: 0
Train Epoch: 8 [1/250 128/32000 (0%)] Loss: 12.41065 (QuantReg: 13.60769) QuantErr: 13.60769 batch_time=21.63289 
Train Epoch: 8 [12/250 1536/32000 (5%)] Loss: 12.13455 (QuantReg: 13.07468) QuantErr: 13.07468 batch_time=0.60979 
Train Epoch: 8 [23/250 2944/32000 (9%)] Loss: 13.06882 (QuantReg: 13.51929) QuantErr: 13.51929 batch_time=0.61246 
Train Epoch: 8 [34/250 4352/32000 (14%)] Loss: 12.55411 (QuantReg: 13.44745) QuantErr: 13.44745 batch_time=0.60850 
Train Epoch: 8 [45/250 5760/32000 (18%)] Loss: 11.46028 (QuantReg: 13.31032) QuantErr: 13.31032 batch_time=1.25257 
Train Epoch: 8 [56/250 7168/32000 (22%)] Loss: 12.71348 (QuantReg: 13.35769) QuantErr: 13.35769 batch_time=0.61989 
Train Epoch: 8 [67/250 8576/32000 (27%)] Loss: 13.63869 (QuantReg: 13.62466) QuantErr: 13.62466 batch_time=0.61941 
Train Epoch: 8 [78/250 9984/32000 (31%)] Loss: 12.73510 (QuantReg: 13.68738) QuantErr: 13.68738 batch_time=0.60818 
Train Epoch: 8 [89/250 11392/32000 (36%)] Loss: 12.15156 (QuantReg: 13.73698) QuantErr: 13.73698 batch_time=0.61504 
Train Epoch: 8 [100/250 12800/32000 (40%)] Loss: 13.79112 (QuantReg: 13.36001) QuantErr: 13.36001 batch_time=0.61082 
Train Epoch: 8 [111/250 14208/32000 (44%)] Loss: 11.56484 (QuantReg: 13.77110) QuantErr: 13.77110 batch_time=0.61073 
Train Epoch: 8 [122/250 15616/32000 (49%)] Loss: 13.39492 (QuantReg: 13.85875) QuantErr: 13.85875 batch_time=0.72651 
Train Epoch: 8 [133/250 17024/32000 (53%)] Loss: 11.64097 (QuantReg: 13.71339) QuantErr: 13.71339 batch_time=0.62064 
Train Epoch: 8 [144/250 18432/32000 (58%)] Loss: 10.32263 (QuantReg: 13.89477) QuantErr: 13.89477 batch_time=1.25314 
Train Epoch: 8 [155/250 19840/32000 (62%)] Loss: 12.38623 (QuantReg: 14.10328) QuantErr: 14.10328 batch_time=0.61379 
Train Epoch: 8 [166/250 21248/32000 (66%)] Loss: 11.51237 (QuantReg: 13.87586) QuantErr: 13.87586 batch_time=0.61624 
Train Epoch: 8 [177/250 22656/32000 (71%)] Loss: 11.91717 (QuantReg: 13.97981) QuantErr: 13.97981 batch_time=0.61448 
Train Epoch: 8 [188/250 24064/32000 (75%)] Loss: 13.43176 (QuantReg: 13.89652) QuantErr: 13.89652 batch_time=1.02758 
Train Epoch: 8 [199/250 25472/32000 (80%)] Loss: 12.03799 (QuantReg: 13.71345) QuantErr: 13.71345 batch_time=0.61738 
Train Epoch: 8 [210/250 26880/32000 (84%)] Loss: 13.25762 (QuantReg: 13.79625) QuantErr: 13.79625 batch_time=0.82901 
Train Epoch: 8 [221/250 28288/32000 (88%)] Loss: 13.26049 (QuantReg: 13.73072) QuantErr: 13.73072 batch_time=0.60055 
Train Epoch: 8 [232/250 29696/32000 (93%)] Loss: 13.04654 (QuantReg: 13.61915) QuantErr: 13.61915 batch_time=0.61533 
Train Epoch: 8 [243/250 31104/32000 (97%)] Loss: 12.60939 (QuantReg: 14.07697) QuantErr: 14.07697 batch_time=0.61206 
Train Epoch: 8 codebook_update_time=3.29834
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch8.pth ...
Done in 5.877s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch8.pth ...
Done in 10.560s
removing stale ckpt [epoch 7] [took 0.39s]
 epoch          : 8
 loss           : 12.399544597625733
 quant_reg      : 13.713250854492188
 quant_err      : 13.713250854492188
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 2000
 LSMDC_full_test/t2v_metrics/R1: 11.9
 LSMDC_full_test/t2v_metrics/R5: 28.8
 LSMDC_full_test/t2v_metrics/R10: 39.0
 LSMDC_full_test/t2v_metrics/R50: 68.7
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.047
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.73201889226039
 LSMDC_full_test/v2t_metrics/R1: 9.7
 LSMDC_full_test/v2t_metrics/R5: 27.9
 LSMDC_full_test/v2t_metrics/R10: 37.1
 LSMDC_full_test/v2t_metrics/R50: 67.9
 LSMDC_full_test/v2t_metrics/MedR: 22.5
 LSMDC_full_test/v2t_metrics/MeanR: 71.026
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 21.573301632807873
 mnt_best       : 23.73201889226039
 not_improved_count: 0
Train Epoch: 9 [1/250 128/32000 (0%)] Loss: 11.23595 (QuantReg: 13.35666) QuantErr: 13.35666 batch_time=19.43113 
Train Epoch: 9 [12/250 1536/32000 (5%)] Loss: 11.59472 (QuantReg: 13.61144) QuantErr: 13.61144 batch_time=0.61849 
Train Epoch: 9 [23/250 2944/32000 (9%)] Loss: 12.51466 (QuantReg: 13.56451) QuantErr: 13.56451 batch_time=0.60675 
Train Epoch: 9 [34/250 4352/32000 (14%)] Loss: 12.07237 (QuantReg: 13.61566) QuantErr: 13.61566 batch_time=0.61992 
Train Epoch: 9 [45/250 5760/32000 (18%)] Loss: 12.21066 (QuantReg: 13.76993) QuantErr: 13.76993 batch_time=0.60593 
Train Epoch: 9 [56/250 7168/32000 (22%)] Loss: 11.08503 (QuantReg: 13.71949) QuantErr: 13.71949 batch_time=0.61172 
Train Epoch: 9 [67/250 8576/32000 (27%)] Loss: 10.54916 (QuantReg: 14.08582) QuantErr: 14.08582 batch_time=1.47449 
Train Epoch: 9 [78/250 9984/32000 (31%)] Loss: 11.73991 (QuantReg: 14.03170) QuantErr: 14.03170 batch_time=0.61303 
Train Epoch: 9 [89/250 11392/32000 (36%)] Loss: 10.85295 (QuantReg: 14.12393) QuantErr: 14.12393 batch_time=0.60963 
Train Epoch: 9 [100/250 12800/32000 (40%)] Loss: 13.15962 (QuantReg: 13.87573) QuantErr: 13.87573 batch_time=0.61195 
Train Epoch: 9 [111/250 14208/32000 (44%)] Loss: 11.72135 (QuantReg: 13.97695) QuantErr: 13.97695 batch_time=0.60642 
Train Epoch: 9 [122/250 15616/32000 (49%)] Loss: 9.49249 (QuantReg: 14.28274) QuantErr: 14.28274 batch_time=0.63031 
Train Epoch: 9 [133/250 17024/32000 (53%)] Loss: 12.23348 (QuantReg: 14.09309) QuantErr: 14.09309 batch_time=0.62194 
Train Epoch: 9 [144/250 18432/32000 (58%)] Loss: 10.47746 (QuantReg: 13.93010) QuantErr: 13.93010 batch_time=0.61588 
Train Epoch: 9 [155/250 19840/32000 (62%)] Loss: 11.99329 (QuantReg: 13.93053) QuantErr: 13.93053 batch_time=0.61060 
Train Epoch: 9 [166/250 21248/32000 (66%)] Loss: 11.79040 (QuantReg: 14.15835) QuantErr: 14.15835 batch_time=0.68859 
Train Epoch: 9 [177/250 22656/32000 (71%)] Loss: 11.04743 (QuantReg: 13.95826) QuantErr: 13.95826 batch_time=0.60987 
Train Epoch: 9 [188/250 24064/32000 (75%)] Loss: 12.34173 (QuantReg: 14.29207) QuantErr: 14.29207 batch_time=1.02962 
Train Epoch: 9 [199/250 25472/32000 (80%)] Loss: 9.84372 (QuantReg: 13.97729) QuantErr: 13.97729 batch_time=0.60935 
Train Epoch: 9 [210/250 26880/32000 (84%)] Loss: 12.99015 (QuantReg: 13.95601) QuantErr: 13.95601 batch_time=0.59660 
Train Epoch: 9 [221/250 28288/32000 (88%)] Loss: 11.93090 (QuantReg: 14.00999) QuantErr: 14.00999 batch_time=0.60960 
Train Epoch: 9 [232/250 29696/32000 (93%)] Loss: 12.65433 (QuantReg: 13.79640) QuantErr: 13.79640 batch_time=0.61240 
Train Epoch: 9 [243/250 31104/32000 (97%)] Loss: 11.93162 (QuantReg: 14.21034) QuantErr: 14.21034 batch_time=0.61458 
Train Epoch: 9 codebook_update_time=3.33379
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch9.pth ...
Done in 4.375s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch9.pth ...
Done in 8.972s
removing stale ckpt [epoch 8] [took 0.02s]
 epoch          : 9
 loss           : 11.834897148132324
 quant_reg      : 13.94833836364746
 quant_err      : 13.94833836364746
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 2250
 LSMDC_full_test/t2v_metrics/R1: 12.3
 LSMDC_full_test/t2v_metrics/R5: 27.7
 LSMDC_full_test/t2v_metrics/R10: 39.7
 LSMDC_full_test/t2v_metrics/R50: 67.8
 LSMDC_full_test/t2v_metrics/MedR: 19.0
 LSMDC_full_test/t2v_metrics/MeanR: 69.419
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.826401861705648
 LSMDC_full_test/v2t_metrics/R1: 11.5
 LSMDC_full_test/v2t_metrics/R5: 30.4
 LSMDC_full_test/v2t_metrics/R10: 39.5
 LSMDC_full_test/v2t_metrics/R50: 68.5
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 66.369
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.99143212686374
 mnt_best       : 23.826401861705648
 not_improved_count: 0
Train Epoch: 10 [1/250 128/32000 (0%)] Loss: 12.24192 (QuantReg: 13.81917) QuantErr: 13.81917 batch_time=19.18655 
Train Epoch: 10 [12/250 1536/32000 (5%)] Loss: 12.18634 (QuantReg: 13.94332) QuantErr: 13.94332 batch_time=0.58875 
Train Epoch: 10 [23/250 2944/32000 (9%)] Loss: 10.69821 (QuantReg: 14.08848) QuantErr: 14.08848 batch_time=0.58762 
Train Epoch: 10 [34/250 4352/32000 (14%)] Loss: 12.42309 (QuantReg: 14.36632) QuantErr: 14.36632 batch_time=0.58916 
Train Epoch: 10 [45/250 5760/32000 (18%)] Loss: 10.32032 (QuantReg: 14.33670) QuantErr: 14.33670 batch_time=0.59389 
Train Epoch: 10 [56/250 7168/32000 (22%)] Loss: 12.14022 (QuantReg: 13.87764) QuantErr: 13.87764 batch_time=0.59089 
Train Epoch: 10 [67/250 8576/32000 (27%)] Loss: 11.40136 (QuantReg: 14.24421) QuantErr: 14.24421 batch_time=0.61753 
Train Epoch: 10 [78/250 9984/32000 (31%)] Loss: 10.55774 (QuantReg: 14.16905) QuantErr: 14.16905 batch_time=0.62581 
Train Epoch: 10 [89/250 11392/32000 (36%)] Loss: 12.02978 (QuantReg: 14.19364) QuantErr: 14.19364 batch_time=0.79570 
Train Epoch: 10 [100/250 12800/32000 (40%)] Loss: 11.40669 (QuantReg: 14.32292) QuantErr: 14.32292 batch_time=0.60647 
Train Epoch: 10 [111/250 14208/32000 (44%)] Loss: 9.71675 (QuantReg: 14.44164) QuantErr: 14.44164 batch_time=0.60648 
Train Epoch: 10 [122/250 15616/32000 (49%)] Loss: 13.28952 (QuantReg: 14.35420) QuantErr: 14.35420 batch_time=0.60934 
Train Epoch: 10 [133/250 17024/32000 (53%)] Loss: 11.14601 (QuantReg: 14.32770) QuantErr: 14.32770 batch_time=0.60574 
Train Epoch: 10 [144/250 18432/32000 (58%)] Loss: 12.05831 (QuantReg: 14.19058) QuantErr: 14.19058 batch_time=2.53834 
Train Epoch: 10 [155/250 19840/32000 (62%)] Loss: 11.16356 (QuantReg: 14.22740) QuantErr: 14.22740 batch_time=0.77431 
Train Epoch: 10 [166/250 21248/32000 (66%)] Loss: 11.80405 (QuantReg: 14.33746) QuantErr: 14.33746 batch_time=0.63248 
Train Epoch: 10 [177/250 22656/32000 (71%)] Loss: 11.31391 (QuantReg: 14.21816) QuantErr: 14.21816 batch_time=0.68064 
Train Epoch: 10 [188/250 24064/32000 (75%)] Loss: 11.25687 (QuantReg: 14.34811) QuantErr: 14.34811 batch_time=0.68806 
Train Epoch: 10 [199/250 25472/32000 (80%)] Loss: 11.58539 (QuantReg: 14.30680) QuantErr: 14.30680 batch_time=0.69193 
Train Epoch: 10 [210/250 26880/32000 (84%)] Loss: 10.02174 (QuantReg: 14.21518) QuantErr: 14.21518 batch_time=0.68688 
Train Epoch: 10 [221/250 28288/32000 (88%)] Loss: 11.31804 (QuantReg: 14.27033) QuantErr: 14.27033 batch_time=0.61629 
Train Epoch: 10 [232/250 29696/32000 (93%)] Loss: 10.45927 (QuantReg: 14.41690) QuantErr: 14.41690 batch_time=1.00871 
Train Epoch: 10 [243/250 31104/32000 (97%)] Loss: 10.66495 (QuantReg: 14.47048) QuantErr: 14.47048 batch_time=0.61068 
Train Epoch: 10 codebook_update_time=3.28288
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch10.pth ...
Done in 4.212s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch10.pth ...
Done in 9.264s
removing stale ckpt [epoch 9] [took 0.01s]
 epoch          : 10
 loss           : 11.294474807739258
 quant_reg      : 14.206634197235108
 quant_err      : 14.206634197235108
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 2500
 LSMDC_full_test/t2v_metrics/R1: 13.4
 LSMDC_full_test/t2v_metrics/R5: 31.1
 LSMDC_full_test/t2v_metrics/R10: 40.8
 LSMDC_full_test/t2v_metrics/R50: 70.1
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 66.19
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.71432430329307
 LSMDC_full_test/v2t_metrics/R1: 12.5
 LSMDC_full_test/v2t_metrics/R5: 31.5
 LSMDC_full_test/v2t_metrics/R10: 40.1
 LSMDC_full_test/v2t_metrics/R50: 68.2
 LSMDC_full_test/v2t_metrics/MedR: 20.0
 LSMDC_full_test/v2t_metrics/MeanR: 67.4
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.087361033070675
 mnt_best       : 25.71432430329307
 not_improved_count: 0
Train Epoch: 11 [1/250 128/32000 (0%)] Loss: 11.84523 (QuantReg: 13.72637) QuantErr: 13.72637 batch_time=16.74976 
Train Epoch: 11 [12/250 1536/32000 (5%)] Loss: 10.84587 (QuantReg: 14.00431) QuantErr: 14.00431 batch_time=0.60156 
Train Epoch: 11 [23/250 2944/32000 (9%)] Loss: 12.06230 (QuantReg: 14.11533) QuantErr: 14.11533 batch_time=0.60444 
Train Epoch: 11 [34/250 4352/32000 (14%)] Loss: 11.33605 (QuantReg: 14.19374) QuantErr: 14.19374 batch_time=0.59553 
Train Epoch: 11 [45/250 5760/32000 (18%)] Loss: 10.87994 (QuantReg: 14.53439) QuantErr: 14.53439 batch_time=0.69978 
Train Epoch: 11 [56/250 7168/32000 (22%)] Loss: 11.32503 (QuantReg: 13.95476) QuantErr: 13.95476 batch_time=0.59013 
Train Epoch: 11 [67/250 8576/32000 (27%)] Loss: 9.75440 (QuantReg: 14.47373) QuantErr: 14.47373 batch_time=0.59620 
Train Epoch: 11 [78/250 9984/32000 (31%)] Loss: 11.66253 (QuantReg: 14.22247) QuantErr: 14.22247 batch_time=0.59999 
Train Epoch: 11 [89/250 11392/32000 (36%)] Loss: 11.33386 (QuantReg: 14.44188) QuantErr: 14.44188 batch_time=0.61801 
Train Epoch: 11 [100/250 12800/32000 (40%)] Loss: 9.94281 (QuantReg: 14.48088) QuantErr: 14.48088 batch_time=0.62027 
Train Epoch: 11 [111/250 14208/32000 (44%)] Loss: 9.68110 (QuantReg: 14.13640) QuantErr: 14.13640 batch_time=0.63052 
Train Epoch: 11 [122/250 15616/32000 (49%)] Loss: 13.20342 (QuantReg: 14.41563) QuantErr: 14.41563 batch_time=0.61294 
Train Epoch: 11 [133/250 17024/32000 (53%)] Loss: 10.50571 (QuantReg: 14.24971) QuantErr: 14.24971 batch_time=1.91628 
Train Epoch: 11 [144/250 18432/32000 (58%)] Loss: 9.84334 (QuantReg: 14.56043) QuantErr: 14.56043 batch_time=0.69031 
Train Epoch: 11 [155/250 19840/32000 (62%)] Loss: 10.15594 (QuantReg: 14.38477) QuantErr: 14.38477 batch_time=1.08507 
Train Epoch: 11 [166/250 21248/32000 (66%)] Loss: 9.98536 (QuantReg: 14.35139) QuantErr: 14.35139 batch_time=0.60772 
Train Epoch: 11 [177/250 22656/32000 (71%)] Loss: 11.19665 (QuantReg: 14.51437) QuantErr: 14.51437 batch_time=0.61784 
Train Epoch: 11 [188/250 24064/32000 (75%)] Loss: 10.37062 (QuantReg: 14.24046) QuantErr: 14.24046 batch_time=0.60750 
Train Epoch: 11 [199/250 25472/32000 (80%)] Loss: 11.39776 (QuantReg: 14.25868) QuantErr: 14.25868 batch_time=0.62479 
Train Epoch: 11 [210/250 26880/32000 (84%)] Loss: 10.88501 (QuantReg: 14.47835) QuantErr: 14.47835 batch_time=0.59094 
Train Epoch: 11 [221/250 28288/32000 (88%)] Loss: 10.85540 (QuantReg: 14.52073) QuantErr: 14.52073 batch_time=0.62801 
Train Epoch: 11 [232/250 29696/32000 (93%)] Loss: 12.45994 (QuantReg: 14.60864) QuantErr: 14.60864 batch_time=0.59328 
Train Epoch: 11 [243/250 31104/32000 (97%)] Loss: 9.88872 (QuantReg: 14.63180) QuantErr: 14.63180 batch_time=0.59919 
Train Epoch: 11 codebook_update_time=3.26398
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch11.pth ...
Done in 5.773s
removing stale ckpt [epoch 10] [took 0.04s]
 epoch          : 11
 loss           : 10.962527809143067
 quant_reg      : 14.36484125137329
 quant_err      : 14.36484125137329
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 2750
 LSMDC_full_test/t2v_metrics/R1: 13.0
 LSMDC_full_test/t2v_metrics/R5: 30.3
 LSMDC_full_test/t2v_metrics/R10: 40.5
 LSMDC_full_test/t2v_metrics/R50: 69.2
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.222
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.173697045163998
 LSMDC_full_test/v2t_metrics/R1: 12.8
 LSMDC_full_test/v2t_metrics/R5: 30.9
 LSMDC_full_test/v2t_metrics/R10: 39.6
 LSMDC_full_test/v2t_metrics/R50: 69.0
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 67.14
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.020033009520017
 mnt_best       : 25.71432430329307
 not_improved_count: 1
Train Epoch: 12 [1/250 128/32000 (0%)] Loss: 9.80194 (QuantReg: 14.51896) QuantErr: 14.51896 batch_time=20.95578 
Train Epoch: 12 [12/250 1536/32000 (5%)] Loss: 10.38375 (QuantReg: 14.44790) QuantErr: 14.44790 batch_time=0.67142 
Train Epoch: 12 [23/250 2944/32000 (9%)] Loss: 8.75633 (QuantReg: 14.58842) QuantErr: 14.58842 batch_time=0.61385 
Train Epoch: 12 [34/250 4352/32000 (14%)] Loss: 11.23824 (QuantReg: 14.45596) QuantErr: 14.45596 batch_time=1.00071 
Train Epoch: 12 [45/250 5760/32000 (18%)] Loss: 10.64482 (QuantReg: 14.47220) QuantErr: 14.47220 batch_time=0.60155 
Train Epoch: 12 [56/250 7168/32000 (22%)] Loss: 9.83745 (QuantReg: 14.69620) QuantErr: 14.69620 batch_time=0.60410 
Train Epoch: 12 [67/250 8576/32000 (27%)] Loss: 10.73915 (QuantReg: 14.44820) QuantErr: 14.44820 batch_time=0.60728 
Train Epoch: 12 [78/250 9984/32000 (31%)] Loss: 11.37879 (QuantReg: 14.38101) QuantErr: 14.38101 batch_time=0.61066 
Train Epoch: 12 [89/250 11392/32000 (36%)] Loss: 10.50496 (QuantReg: 14.73816) QuantErr: 14.73816 batch_time=0.66039 
Train Epoch: 12 [100/250 12800/32000 (40%)] Loss: 11.41503 (QuantReg: 14.40325) QuantErr: 14.40325 batch_time=0.60155 
Train Epoch: 12 [111/250 14208/32000 (44%)] Loss: 8.92809 (QuantReg: 14.31859) QuantErr: 14.31859 batch_time=0.60159 
Train Epoch: 12 [122/250 15616/32000 (49%)] Loss: 8.76371 (QuantReg: 14.43271) QuantErr: 14.43271 batch_time=0.60388 
Train Epoch: 12 [133/250 17024/32000 (53%)] Loss: 10.81063 (QuantReg: 14.76064) QuantErr: 14.76064 batch_time=0.60156 
Train Epoch: 12 [144/250 18432/32000 (58%)] Loss: 11.02927 (QuantReg: 14.57891) QuantErr: 14.57891 batch_time=0.61140 
Train Epoch: 12 [155/250 19840/32000 (62%)] Loss: 10.25170 (QuantReg: 14.55741) QuantErr: 14.55741 batch_time=0.61119 
Train Epoch: 12 [166/250 21248/32000 (66%)] Loss: 10.64407 (QuantReg: 14.45388) QuantErr: 14.45388 batch_time=0.61841 
Train Epoch: 12 [177/250 22656/32000 (71%)] Loss: 11.37710 (QuantReg: 14.42478) QuantErr: 14.42478 batch_time=0.61644 
Train Epoch: 12 [188/250 24064/32000 (75%)] Loss: 10.88657 (QuantReg: 15.04616) QuantErr: 15.04616 batch_time=0.60357 
Train Epoch: 12 [199/250 25472/32000 (80%)] Loss: 10.86959 (QuantReg: 14.84975) QuantErr: 14.84975 batch_time=0.60919 
Train Epoch: 12 [210/250 26880/32000 (84%)] Loss: 12.38786 (QuantReg: 14.40894) QuantErr: 14.40894 batch_time=0.60777 
Train Epoch: 12 [221/250 28288/32000 (88%)] Loss: 10.98099 (QuantReg: 14.24279) QuantErr: 14.24279 batch_time=0.61175 
Train Epoch: 12 [232/250 29696/32000 (93%)] Loss: 11.14709 (QuantReg: 14.50889) QuantErr: 14.50889 batch_time=0.61182 
Train Epoch: 12 [243/250 31104/32000 (97%)] Loss: 9.14912 (QuantReg: 14.96441) QuantErr: 14.96441 batch_time=0.61046 
Train Epoch: 12 codebook_update_time=3.27866
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch12.pth ...
Done in 4.675s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 10.553606601715089
 quant_reg      : 14.526742370605469
 quant_err      : 14.526742370605469
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 3000
 LSMDC_full_test/t2v_metrics/R1: 12.1
 LSMDC_full_test/t2v_metrics/R5: 29.9
 LSMDC_full_test/t2v_metrics/R10: 40.2
 LSMDC_full_test/t2v_metrics/R50: 68.5
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.118
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.40961168400568
 LSMDC_full_test/v2t_metrics/R1: 12.1
 LSMDC_full_test/v2t_metrics/R5: 29.5
 LSMDC_full_test/v2t_metrics/R10: 39.1
 LSMDC_full_test/v2t_metrics/R50: 68.2
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 70.012
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.07657543839008
 mnt_best       : 25.71432430329307
 not_improved_count: 2
Train Epoch: 13 [1/250 128/32000 (0%)] Loss: 9.82759 (QuantReg: 14.19587) QuantErr: 14.19587 batch_time=19.79354 
Train Epoch: 13 [12/250 1536/32000 (5%)] Loss: 9.97946 (QuantReg: 14.56673) QuantErr: 14.56673 batch_time=0.61401 
Train Epoch: 13 [23/250 2944/32000 (9%)] Loss: 11.14087 (QuantReg: 14.72980) QuantErr: 14.72980 batch_time=0.61917 
Train Epoch: 13 [34/250 4352/32000 (14%)] Loss: 9.85460 (QuantReg: 14.60537) QuantErr: 14.60537 batch_time=0.61096 
Train Epoch: 13 [45/250 5760/32000 (18%)] Loss: 11.47962 (QuantReg: 14.46252) QuantErr: 14.46252 batch_time=0.62184 
Train Epoch: 13 [56/250 7168/32000 (22%)] Loss: 8.91585 (QuantReg: 14.64670) QuantErr: 14.64670 batch_time=0.62393 
Train Epoch: 13 [67/250 8576/32000 (27%)] Loss: 10.81782 (QuantReg: 14.27063) QuantErr: 14.27063 batch_time=0.61525 
Train Epoch: 13 [78/250 9984/32000 (31%)] Loss: 9.86942 (QuantReg: 14.75755) QuantErr: 14.75755 batch_time=0.60826 
Train Epoch: 13 [89/250 11392/32000 (36%)] Loss: 9.18625 (QuantReg: 14.48078) QuantErr: 14.48078 batch_time=0.59940 
Train Epoch: 13 [100/250 12800/32000 (40%)] Loss: 9.84595 (QuantReg: 14.64207) QuantErr: 14.64207 batch_time=0.61529 
Train Epoch: 13 [111/250 14208/32000 (44%)] Loss: 10.53617 (QuantReg: 14.63520) QuantErr: 14.63520 batch_time=0.61644 
Train Epoch: 13 [122/250 15616/32000 (49%)] Loss: 10.18975 (QuantReg: 14.67469) QuantErr: 14.67469 batch_time=0.60894 
Train Epoch: 13 [133/250 17024/32000 (53%)] Loss: 9.88774 (QuantReg: 14.66884) QuantErr: 14.66884 batch_time=0.82214 
Train Epoch: 13 [144/250 18432/32000 (58%)] Loss: 12.01293 (QuantReg: 14.62941) QuantErr: 14.62941 batch_time=0.60764 
Train Epoch: 13 [155/250 19840/32000 (62%)] Loss: 10.60888 (QuantReg: 14.74747) QuantErr: 14.74747 batch_time=0.63996 
Train Epoch: 13 [166/250 21248/32000 (66%)] Loss: 10.63278 (QuantReg: 14.68929) QuantErr: 14.68929 batch_time=0.60467 
Train Epoch: 13 [177/250 22656/32000 (71%)] Loss: 10.91287 (QuantReg: 14.93070) QuantErr: 14.93070 batch_time=0.60331 
Train Epoch: 13 [188/250 24064/32000 (75%)] Loss: 9.61338 (QuantReg: 14.77398) QuantErr: 14.77398 batch_time=0.61365 
Train Epoch: 13 [199/250 25472/32000 (80%)] Loss: 10.42229 (QuantReg: 14.79181) QuantErr: 14.79181 batch_time=0.60454 
Train Epoch: 13 [210/250 26880/32000 (84%)] Loss: 10.13615 (QuantReg: 14.67936) QuantErr: 14.67936 batch_time=0.61563 
Train Epoch: 13 [221/250 28288/32000 (88%)] Loss: 10.28155 (QuantReg: 14.42514) QuantErr: 14.42514 batch_time=0.61471 
Train Epoch: 13 [232/250 29696/32000 (93%)] Loss: 9.68196 (QuantReg: 14.71345) QuantErr: 14.71345 batch_time=0.60600 
Train Epoch: 13 [243/250 31104/32000 (97%)] Loss: 9.47473 (QuantReg: 14.55245) QuantErr: 14.55245 batch_time=0.61155 
Train Epoch: 13 codebook_update_time=3.23061
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch13.pth ...
Done in 4.547s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 10.25339986038208
 quant_reg      : 14.662595268249511
 quant_err      : 14.662595268249511
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 3250
 LSMDC_full_test/t2v_metrics/R1: 11.9
 LSMDC_full_test/t2v_metrics/R5: 30.1
 LSMDC_full_test/t2v_metrics/R10: 40.1
 LSMDC_full_test/t2v_metrics/R50: 69.8
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 69.687
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.308189306300076
 LSMDC_full_test/v2t_metrics/R1: 13.1
 LSMDC_full_test/v2t_metrics/R5: 30.4
 LSMDC_full_test/v2t_metrics/R10: 40.3
 LSMDC_full_test/v2t_metrics/R50: 70.1
 LSMDC_full_test/v2t_metrics/MedR: 18.25
 LSMDC_full_test/v2t_metrics/MeanR: 67.93
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.224155891895037
 mnt_best       : 25.71432430329307
 not_improved_count: 3
Train Epoch: 14 [1/250 128/32000 (0%)] Loss: 10.08391 (QuantReg: 14.88337) QuantErr: 14.88337 batch_time=18.25756 
Train Epoch: 14 [12/250 1536/32000 (5%)] Loss: 8.45153 (QuantReg: 14.39071) QuantErr: 14.39071 batch_time=0.59703 
Train Epoch: 14 [23/250 2944/32000 (9%)] Loss: 10.07166 (QuantReg: 14.60140) QuantErr: 14.60140 batch_time=0.60463 
Train Epoch: 14 [34/250 4352/32000 (14%)] Loss: 9.42451 (QuantReg: 14.55158) QuantErr: 14.55158 batch_time=0.65513 
Train Epoch: 14 [45/250 5760/32000 (18%)] Loss: 10.85618 (QuantReg: 14.64555) QuantErr: 14.64555 batch_time=0.61202 
Train Epoch: 14 [56/250 7168/32000 (22%)] Loss: 10.06082 (QuantReg: 14.79963) QuantErr: 14.79963 batch_time=0.73458 
Train Epoch: 14 [67/250 8576/32000 (27%)] Loss: 9.97566 (QuantReg: 14.71584) QuantErr: 14.71584 batch_time=0.61891 
Train Epoch: 14 [78/250 9984/32000 (31%)] Loss: 9.73566 (QuantReg: 14.60666) QuantErr: 14.60666 batch_time=0.60851 
Train Epoch: 14 [89/250 11392/32000 (36%)] Loss: 10.00991 (QuantReg: 14.32896) QuantErr: 14.32896 batch_time=0.61083 
Train Epoch: 14 [100/250 12800/32000 (40%)] Loss: 10.52678 (QuantReg: 14.82185) QuantErr: 14.82185 batch_time=0.61067 
Train Epoch: 14 [111/250 14208/32000 (44%)] Loss: 8.88665 (QuantReg: 15.14307) QuantErr: 15.14307 batch_time=0.60780 
Train Epoch: 14 [122/250 15616/32000 (49%)] Loss: 9.48354 (QuantReg: 14.79430) QuantErr: 14.79430 batch_time=0.60030 
Train Epoch: 14 [133/250 17024/32000 (53%)] Loss: 9.11712 (QuantReg: 14.93866) QuantErr: 14.93866 batch_time=0.71355 
Train Epoch: 14 [144/250 18432/32000 (58%)] Loss: 8.74027 (QuantReg: 14.84952) QuantErr: 14.84952 batch_time=2.09037 
Train Epoch: 14 [155/250 19840/32000 (62%)] Loss: 11.58798 (QuantReg: 14.81262) QuantErr: 14.81262 batch_time=0.61680 
Train Epoch: 14 [166/250 21248/32000 (66%)] Loss: 12.11215 (QuantReg: 14.57476) QuantErr: 14.57476 batch_time=0.83467 
Train Epoch: 14 [177/250 22656/32000 (71%)] Loss: 9.43113 (QuantReg: 15.00649) QuantErr: 15.00649 batch_time=0.60690 
Train Epoch: 14 [188/250 24064/32000 (75%)] Loss: 10.95165 (QuantReg: 14.87674) QuantErr: 14.87674 batch_time=0.59132 
Train Epoch: 14 [199/250 25472/32000 (80%)] Loss: 10.54159 (QuantReg: 14.77240) QuantErr: 14.77240 batch_time=0.60320 
Train Epoch: 14 [210/250 26880/32000 (84%)] Loss: 9.07549 (QuantReg: 14.94482) QuantErr: 14.94482 batch_time=0.63985 
Train Epoch: 14 [221/250 28288/32000 (88%)] Loss: 9.01534 (QuantReg: 14.86050) QuantErr: 14.86050 batch_time=0.61459 
Train Epoch: 14 [232/250 29696/32000 (93%)] Loss: 10.96878 (QuantReg: 15.05782) QuantErr: 15.05782 batch_time=0.61165 
Train Epoch: 14 [243/250 31104/32000 (97%)] Loss: 10.03456 (QuantReg: 14.97967) QuantErr: 14.97967 batch_time=0.60613 
Train Epoch: 14 codebook_update_time=3.24240
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch14.pth ...
Done in 4.050s
removing stale ckpt [epoch 13] [took 0.01s]
 epoch          : 14
 loss           : 9.815399806976318
 quant_reg      : 14.801168251037598
 quant_err      : 14.801168251037598
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 3500
 LSMDC_full_test/t2v_metrics/R1: 12.2
 LSMDC_full_test/t2v_metrics/R5: 30.4
 LSMDC_full_test/t2v_metrics/R10: 42.2
 LSMDC_full_test/t2v_metrics/R50: 69.5
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.668
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.013931435162498
 LSMDC_full_test/v2t_metrics/R1: 12.0
 LSMDC_full_test/v2t_metrics/R5: 30.6
 LSMDC_full_test/v2t_metrics/R10: 40.3
 LSMDC_full_test/v2t_metrics/R50: 70.0
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 67.501
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.551003010553774
 mnt_best       : 25.71432430329307
 not_improved_count: 4
Train Epoch: 15 [1/250 128/32000 (0%)] Loss: 10.44200 (QuantReg: 14.65564) QuantErr: 14.65564 batch_time=19.43765 
Train Epoch: 15 [12/250 1536/32000 (5%)] Loss: 10.50081 (QuantReg: 14.65644) QuantErr: 14.65644 batch_time=0.68898 
Train Epoch: 15 [23/250 2944/32000 (9%)] Loss: 9.22588 (QuantReg: 14.82695) QuantErr: 14.82695 batch_time=1.44944 
Train Epoch: 15 [34/250 4352/32000 (14%)] Loss: 9.50589 (QuantReg: 14.82378) QuantErr: 14.82378 batch_time=0.61369 
Train Epoch: 15 [45/250 5760/32000 (18%)] Loss: 9.31036 (QuantReg: 14.80741) QuantErr: 14.80741 batch_time=1.24249 
Train Epoch: 15 [56/250 7168/32000 (22%)] Loss: 7.90524 (QuantReg: 14.85456) QuantErr: 14.85456 batch_time=0.60748 
Train Epoch: 15 [67/250 8576/32000 (27%)] Loss: 10.84799 (QuantReg: 14.77393) QuantErr: 14.77393 batch_time=0.90798 
Train Epoch: 15 [78/250 9984/32000 (31%)] Loss: 9.90963 (QuantReg: 14.98727) QuantErr: 14.98727 batch_time=0.60605 
Train Epoch: 15 [89/250 11392/32000 (36%)] Loss: 10.61770 (QuantReg: 14.77788) QuantErr: 14.77788 batch_time=0.60492 
Train Epoch: 15 [100/250 12800/32000 (40%)] Loss: 7.88240 (QuantReg: 15.08949) QuantErr: 15.08949 batch_time=0.60736 
Train Epoch: 15 [111/250 14208/32000 (44%)] Loss: 11.00048 (QuantReg: 14.86855) QuantErr: 14.86855 batch_time=0.60429 
Train Epoch: 15 [122/250 15616/32000 (49%)] Loss: 11.18736 (QuantReg: 14.98083) QuantErr: 14.98083 batch_time=0.60763 
Train Epoch: 15 [133/250 17024/32000 (53%)] Loss: 10.20367 (QuantReg: 15.00632) QuantErr: 15.00632 batch_time=0.61049 
Train Epoch: 15 [144/250 18432/32000 (58%)] Loss: 9.58632 (QuantReg: 15.00262) QuantErr: 15.00262 batch_time=0.61785 
Train Epoch: 15 [155/250 19840/32000 (62%)] Loss: 8.64438 (QuantReg: 15.15105) QuantErr: 15.15105 batch_time=0.60748 
Train Epoch: 15 [166/250 21248/32000 (66%)] Loss: 9.93977 (QuantReg: 14.97813) QuantErr: 14.97813 batch_time=0.61296 
Train Epoch: 15 [177/250 22656/32000 (71%)] Loss: 10.42943 (QuantReg: 15.08980) QuantErr: 15.08980 batch_time=0.60643 
Train Epoch: 15 [188/250 24064/32000 (75%)] Loss: 10.30455 (QuantReg: 15.02501) QuantErr: 15.02501 batch_time=0.62148 
Train Epoch: 15 [199/250 25472/32000 (80%)] Loss: 8.16834 (QuantReg: 14.89663) QuantErr: 14.89663 batch_time=0.61485 
Train Epoch: 15 [210/250 26880/32000 (84%)] Loss: 9.82557 (QuantReg: 15.05450) QuantErr: 15.05450 batch_time=0.61435 
Train Epoch: 15 [221/250 28288/32000 (88%)] Loss: 8.20494 (QuantReg: 15.02327) QuantErr: 15.02327 batch_time=0.61602 
Train Epoch: 15 [232/250 29696/32000 (93%)] Loss: 7.98553 (QuantReg: 14.95657) QuantErr: 14.95657 batch_time=0.61166 
Train Epoch: 15 [243/250 31104/32000 (97%)] Loss: 9.24749 (QuantReg: 14.84180) QuantErr: 14.84180 batch_time=0.61457 
Train Epoch: 15 codebook_update_time=3.56151
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch15.pth ...
Done in 3.930s
removing stale ckpt [epoch 14] [took 0.01s]
 epoch          : 15
 loss           : 9.503763656616211
 quant_reg      : 14.91536022567749
 quant_err      : 14.91536022567749
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 3750
 LSMDC_full_test/t2v_metrics/R1: 12.1
 LSMDC_full_test/t2v_metrics/R5: 31.0
 LSMDC_full_test/t2v_metrics/R10: 41.2
 LSMDC_full_test/t2v_metrics/R50: 69.5
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 69.985
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.908529735798282
 LSMDC_full_test/v2t_metrics/R1: 12.2
 LSMDC_full_test/v2t_metrics/R5: 31.1
 LSMDC_full_test/v2t_metrics/R10: 40.3
 LSMDC_full_test/v2t_metrics/R50: 70.2
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 67.341
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.82037975343605
 mnt_best       : 25.71432430329307
 not_improved_count: 5
Train Epoch: 16 [1/250 128/32000 (0%)] Loss: 9.55281 (QuantReg: 14.63623) QuantErr: 14.63623 batch_time=18.42443 
Train Epoch: 16 [12/250 1536/32000 (5%)] Loss: 8.99454 (QuantReg: 14.73616) QuantErr: 14.73616 batch_time=0.60745 
Train Epoch: 16 [23/250 2944/32000 (9%)] Loss: 10.24321 (QuantReg: 14.80350) QuantErr: 14.80350 batch_time=0.60413 
Train Epoch: 16 [34/250 4352/32000 (14%)] Loss: 9.15388 (QuantReg: 15.02309) QuantErr: 15.02309 batch_time=0.60424 
Train Epoch: 16 [45/250 5760/32000 (18%)] Loss: 8.36614 (QuantReg: 15.07002) QuantErr: 15.07002 batch_time=0.58863 
Train Epoch: 16 [56/250 7168/32000 (22%)] Loss: 10.99701 (QuantReg: 14.92884) QuantErr: 14.92884 batch_time=0.59430 
Train Epoch: 16 [67/250 8576/32000 (27%)] Loss: 10.22569 (QuantReg: 14.85420) QuantErr: 14.85420 batch_time=1.19715 
Train Epoch: 16 [78/250 9984/32000 (31%)] Loss: 10.48994 (QuantReg: 14.95541) QuantErr: 14.95541 batch_time=0.59917 
Train Epoch: 16 [89/250 11392/32000 (36%)] Loss: 9.13636 (QuantReg: 14.77908) QuantErr: 14.77908 batch_time=0.60553 
Train Epoch: 16 [100/250 12800/32000 (40%)] Loss: 8.02680 (QuantReg: 14.98653) QuantErr: 14.98653 batch_time=0.62039 
Train Epoch: 16 [111/250 14208/32000 (44%)] Loss: 8.92604 (QuantReg: 15.03503) QuantErr: 15.03503 batch_time=0.61845 
Train Epoch: 16 [122/250 15616/32000 (49%)] Loss: 8.34885 (QuantReg: 14.84573) QuantErr: 14.84573 batch_time=0.61974 
Train Epoch: 16 [133/250 17024/32000 (53%)] Loss: 9.25324 (QuantReg: 15.19661) QuantErr: 15.19661 batch_time=0.59871 
Train Epoch: 16 [144/250 18432/32000 (58%)] Loss: 9.04737 (QuantReg: 15.10884) QuantErr: 15.10884 batch_time=2.55423 
Train Epoch: 16 [155/250 19840/32000 (62%)] Loss: 9.07604 (QuantReg: 15.18359) QuantErr: 15.18359 batch_time=1.31493 
Train Epoch: 16 [166/250 21248/32000 (66%)] Loss: 10.36550 (QuantReg: 14.79603) QuantErr: 14.79603 batch_time=0.59654 
Train Epoch: 16 [177/250 22656/32000 (71%)] Loss: 8.80256 (QuantReg: 15.14528) QuantErr: 15.14528 batch_time=0.60676 
Train Epoch: 16 [188/250 24064/32000 (75%)] Loss: 9.88279 (QuantReg: 15.15038) QuantErr: 15.15038 batch_time=0.59720 
Train Epoch: 16 [199/250 25472/32000 (80%)] Loss: 9.65215 (QuantReg: 15.11207) QuantErr: 15.11207 batch_time=0.61712 
Train Epoch: 16 [210/250 26880/32000 (84%)] Loss: 8.59362 (QuantReg: 14.92806) QuantErr: 14.92806 batch_time=0.59845 
Train Epoch: 16 [221/250 28288/32000 (88%)] Loss: 10.60663 (QuantReg: 15.14914) QuantErr: 15.14914 batch_time=0.65254 
Train Epoch: 16 [232/250 29696/32000 (93%)] Loss: 9.28027 (QuantReg: 15.00292) QuantErr: 15.00292 batch_time=0.59551 
Train Epoch: 16 [243/250 31104/32000 (97%)] Loss: 9.73251 (QuantReg: 14.99439) QuantErr: 14.99439 batch_time=0.62622 
Train Epoch: 16 codebook_update_time=3.25264
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch16.pth ...
Done in 4.379s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 9.234854656219483
 quant_reg      : 15.004243679046631
 quant_err      : 15.004243679046631
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 4000
 LSMDC_full_test/t2v_metrics/R1: 12.2
 LSMDC_full_test/t2v_metrics/R5: 32.4
 LSMDC_full_test/t2v_metrics/R10: 42.7
 LSMDC_full_test/t2v_metrics/R50: 69.5
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.418
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.651390095997474
 LSMDC_full_test/v2t_metrics/R1: 11.9
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 40.9
 LSMDC_full_test/v2t_metrics/R50: 69.7
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 69.498
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.816087160379848
 mnt_best       : 25.71432430329307
 not_improved_count: 6
Train Epoch: 17 [1/250 128/32000 (0%)] Loss: 10.06749 (QuantReg: 14.92666) QuantErr: 14.92666 batch_time=22.50546 
Train Epoch: 17 [12/250 1536/32000 (5%)] Loss: 9.78600 (QuantReg: 14.72776) QuantErr: 14.72776 batch_time=0.60304 
Train Epoch: 17 [23/250 2944/32000 (9%)] Loss: 8.70359 (QuantReg: 15.01295) QuantErr: 15.01295 batch_time=0.61170 
Train Epoch: 17 [34/250 4352/32000 (14%)] Loss: 8.69114 (QuantReg: 14.74804) QuantErr: 14.74804 batch_time=0.60691 
Train Epoch: 17 [45/250 5760/32000 (18%)] Loss: 10.43168 (QuantReg: 15.04595) QuantErr: 15.04595 batch_time=0.63037 
Train Epoch: 17 [56/250 7168/32000 (22%)] Loss: 9.27435 (QuantReg: 14.86040) QuantErr: 14.86040 batch_time=0.61588 
Train Epoch: 17 [67/250 8576/32000 (27%)] Loss: 9.42183 (QuantReg: 15.14607) QuantErr: 15.14607 batch_time=0.61806 
Train Epoch: 17 [78/250 9984/32000 (31%)] Loss: 9.35505 (QuantReg: 15.01781) QuantErr: 15.01781 batch_time=0.60722 
Train Epoch: 17 [89/250 11392/32000 (36%)] Loss: 11.50849 (QuantReg: 15.00099) QuantErr: 15.00099 batch_time=0.59687 
Train Epoch: 17 [100/250 12800/32000 (40%)] Loss: 9.22188 (QuantReg: 15.02057) QuantErr: 15.02057 batch_time=1.35313 
Train Epoch: 17 [111/250 14208/32000 (44%)] Loss: 8.30336 (QuantReg: 15.38585) QuantErr: 15.38585 batch_time=0.61063 
Train Epoch: 17 [122/250 15616/32000 (49%)] Loss: 9.10856 (QuantReg: 15.23095) QuantErr: 15.23095 batch_time=0.59454 
Train Epoch: 17 [133/250 17024/32000 (53%)] Loss: 8.57568 (QuantReg: 14.93578) QuantErr: 14.93578 batch_time=0.61689 
Train Epoch: 17 [144/250 18432/32000 (58%)] Loss: 7.97439 (QuantReg: 15.68605) QuantErr: 15.68605 batch_time=0.61699 
Train Epoch: 17 [155/250 19840/32000 (62%)] Loss: 8.79490 (QuantReg: 15.20608) QuantErr: 15.20608 batch_time=0.93407 
Train Epoch: 17 [166/250 21248/32000 (66%)] Loss: 7.14728 (QuantReg: 15.22594) QuantErr: 15.22594 batch_time=0.60777 
Train Epoch: 17 [177/250 22656/32000 (71%)] Loss: 9.21318 (QuantReg: 15.00214) QuantErr: 15.00214 batch_time=0.61785 
Train Epoch: 17 [188/250 24064/32000 (75%)] Loss: 9.22752 (QuantReg: 15.11580) QuantErr: 15.11580 batch_time=0.60496 
Train Epoch: 17 [199/250 25472/32000 (80%)] Loss: 8.09451 (QuantReg: 15.23189) QuantErr: 15.23189 batch_time=0.61125 
Train Epoch: 17 [210/250 26880/32000 (84%)] Loss: 8.17847 (QuantReg: 14.78099) QuantErr: 14.78099 batch_time=0.59907 
Train Epoch: 17 [221/250 28288/32000 (88%)] Loss: 9.18122 (QuantReg: 15.31404) QuantErr: 15.31404 batch_time=1.13038 
Train Epoch: 17 [232/250 29696/32000 (93%)] Loss: 8.75016 (QuantReg: 15.20883) QuantErr: 15.20883 batch_time=0.61160 
Train Epoch: 17 [243/250 31104/32000 (97%)] Loss: 9.50711 (QuantReg: 15.15883) QuantErr: 15.15883 batch_time=0.61429 
Train Epoch: 17 codebook_update_time=3.56888
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch17.pth ...
Done in 5.878s
removing stale ckpt [epoch 16] [took 0.01s]
 epoch          : 17
 loss           : 9.002302356719971
 quant_reg      : 15.115643875122071
 quant_err      : 15.115643875122071
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 4250
 LSMDC_full_test/t2v_metrics/R1: 12.5
 LSMDC_full_test/t2v_metrics/R5: 31.6
 LSMDC_full_test/t2v_metrics/R10: 42.2
 LSMDC_full_test/t2v_metrics/R50: 69.2
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.51
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.54483972772254
 LSMDC_full_test/v2t_metrics/R1: 12.0
 LSMDC_full_test/v2t_metrics/R5: 31.2
 LSMDC_full_test/v2t_metrics/R10: 40.3
 LSMDC_full_test/v2t_metrics/R50: 68.8
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 69.666
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.71042957517801
 mnt_best       : 25.71432430329307
 not_improved_count: 7
Train Epoch: 18 [1/250 128/32000 (0%)] Loss: 8.91108 (QuantReg: 15.12999) QuantErr: 15.12999 batch_time=16.02931 
Train Epoch: 18 [12/250 1536/32000 (5%)] Loss: 8.28392 (QuantReg: 15.08936) QuantErr: 15.08936 batch_time=0.60529 
Train Epoch: 18 [23/250 2944/32000 (9%)] Loss: 8.76417 (QuantReg: 14.91497) QuantErr: 14.91497 batch_time=0.62991 
Train Epoch: 18 [34/250 4352/32000 (14%)] Loss: 8.21286 (QuantReg: 15.20816) QuantErr: 15.20816 batch_time=0.59614 
Train Epoch: 18 [45/250 5760/32000 (18%)] Loss: 8.64304 (QuantReg: 14.89986) QuantErr: 14.89986 batch_time=0.61029 
Train Epoch: 18 [56/250 7168/32000 (22%)] Loss: 8.94984 (QuantReg: 15.07481) QuantErr: 15.07481 batch_time=0.61159 
Train Epoch: 18 [67/250 8576/32000 (27%)] Loss: 9.05601 (QuantReg: 15.14301) QuantErr: 15.14301 batch_time=0.60828 
Train Epoch: 18 [78/250 9984/32000 (31%)] Loss: 9.01465 (QuantReg: 15.04358) QuantErr: 15.04358 batch_time=1.10107 
Train Epoch: 18 [89/250 11392/32000 (36%)] Loss: 9.15671 (QuantReg: 15.04396) QuantErr: 15.04396 batch_time=0.61360 
Train Epoch: 18 [100/250 12800/32000 (40%)] Loss: 9.16819 (QuantReg: 15.11815) QuantErr: 15.11815 batch_time=0.61776 
Train Epoch: 18 [111/250 14208/32000 (44%)] Loss: 8.68681 (QuantReg: 15.02298) QuantErr: 15.02298 batch_time=0.62186 
Train Epoch: 18 [122/250 15616/32000 (49%)] Loss: 8.46416 (QuantReg: 15.26700) QuantErr: 15.26700 batch_time=0.61334 
Train Epoch: 18 [133/250 17024/32000 (53%)] Loss: 8.73122 (QuantReg: 15.35999) QuantErr: 15.35999 batch_time=0.60009 
Train Epoch: 18 [144/250 18432/32000 (58%)] Loss: 7.97505 (QuantReg: 15.03097) QuantErr: 15.03097 batch_time=2.50130 
Train Epoch: 18 [155/250 19840/32000 (62%)] Loss: 8.64121 (QuantReg: 15.09871) QuantErr: 15.09871 batch_time=0.61905 
Train Epoch: 18 [166/250 21248/32000 (66%)] Loss: 7.81922 (QuantReg: 15.40516) QuantErr: 15.40516 batch_time=0.61250 
Train Epoch: 18 [177/250 22656/32000 (71%)] Loss: 8.81807 (QuantReg: 15.41683) QuantErr: 15.41683 batch_time=0.62211 
Train Epoch: 18 [188/250 24064/32000 (75%)] Loss: 7.28024 (QuantReg: 15.42583) QuantErr: 15.42583 batch_time=0.61172 
Train Epoch: 18 [199/250 25472/32000 (80%)] Loss: 8.94115 (QuantReg: 15.53478) QuantErr: 15.53478 batch_time=0.61913 
Train Epoch: 18 [210/250 26880/32000 (84%)] Loss: 8.92296 (QuantReg: 15.02388) QuantErr: 15.02388 batch_time=0.61868 
Train Epoch: 18 [221/250 28288/32000 (88%)] Loss: 9.11698 (QuantReg: 15.24296) QuantErr: 15.24296 batch_time=0.62482 
Train Epoch: 18 [232/250 29696/32000 (93%)] Loss: 8.10173 (QuantReg: 15.27768) QuantErr: 15.27768 batch_time=0.61688 
Train Epoch: 18 [243/250 31104/32000 (97%)] Loss: 7.27042 (QuantReg: 15.27654) QuantErr: 15.27654 batch_time=0.61200 
Train Epoch: 18 codebook_update_time=3.23683
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch18.pth ...
Done in 5.779s
removing stale ckpt [epoch 17] [took 0.01s]
 epoch          : 18
 loss           : 8.658070558547974
 quant_reg      : 15.202107158660889
 quant_err      : 15.202107158660889
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 4500
 LSMDC_full_test/t2v_metrics/R1: 12.0
 LSMDC_full_test/t2v_metrics/R5: 33.0
 LSMDC_full_test/t2v_metrics/R10: 42.3
 LSMDC_full_test/t2v_metrics/R50: 69.2
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.181
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.586557069762687
 LSMDC_full_test/v2t_metrics/R1: 11.9
 LSMDC_full_test/v2t_metrics/R5: 32.2
 LSMDC_full_test/v2t_metrics/R10: 41.5
 LSMDC_full_test/v2t_metrics/R50: 68.5
 LSMDC_full_test/v2t_metrics/MedR: 16.0
 LSMDC_full_test/v2t_metrics/MeanR: 68.625
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.146853011979573
 mnt_best       : 25.71432430329307
 not_improved_count: 8
Train Epoch: 19 [1/250 128/32000 (0%)] Loss: 8.48782 (QuantReg: 15.16522) QuantErr: 15.16522 batch_time=19.31856 
Train Epoch: 19 [12/250 1536/32000 (5%)] Loss: 7.22813 (QuantReg: 15.28173) QuantErr: 15.28173 batch_time=0.65235 
Train Epoch: 19 [23/250 2944/32000 (9%)] Loss: 9.74058 (QuantReg: 15.10396) QuantErr: 15.10396 batch_time=0.63933 
Train Epoch: 19 [34/250 4352/32000 (14%)] Loss: 10.50120 (QuantReg: 15.06824) QuantErr: 15.06824 batch_time=0.60365 
Train Epoch: 19 [45/250 5760/32000 (18%)] Loss: 8.10951 (QuantReg: 15.23589) QuantErr: 15.23589 batch_time=0.60764 
Train Epoch: 19 [56/250 7168/32000 (22%)] Loss: 9.85583 (QuantReg: 15.42675) QuantErr: 15.42675 batch_time=0.60536 
Train Epoch: 19 [67/250 8576/32000 (27%)] Loss: 8.07201 (QuantReg: 15.19647) QuantErr: 15.19647 batch_time=0.60799 
Train Epoch: 19 [78/250 9984/32000 (31%)] Loss: 8.07157 (QuantReg: 15.28503) QuantErr: 15.28503 batch_time=0.60422 
Train Epoch: 19 [89/250 11392/32000 (36%)] Loss: 9.00005 (QuantReg: 15.36798) QuantErr: 15.36798 batch_time=0.60670 
Train Epoch: 19 [100/250 12800/32000 (40%)] Loss: 7.71981 (QuantReg: 15.33989) QuantErr: 15.33989 batch_time=0.60424 
Train Epoch: 19 [111/250 14208/32000 (44%)] Loss: 7.87836 (QuantReg: 15.22970) QuantErr: 15.22970 batch_time=0.94474 
Train Epoch: 19 [122/250 15616/32000 (49%)] Loss: 8.48847 (QuantReg: 15.23149) QuantErr: 15.23149 batch_time=1.03116 
Train Epoch: 19 [133/250 17024/32000 (53%)] Loss: 10.15406 (QuantReg: 15.23305) QuantErr: 15.23305 batch_time=1.22446 
Train Epoch: 19 [144/250 18432/32000 (58%)] Loss: 8.72519 (QuantReg: 15.21094) QuantErr: 15.21094 batch_time=0.61728 
Train Epoch: 19 [155/250 19840/32000 (62%)] Loss: 8.57622 (QuantReg: 15.14652) QuantErr: 15.14652 batch_time=0.63151 
Train Epoch: 19 [166/250 21248/32000 (66%)] Loss: 7.77417 (QuantReg: 15.17074) QuantErr: 15.17074 batch_time=0.60332 
Train Epoch: 19 [177/250 22656/32000 (71%)] Loss: 10.08864 (QuantReg: 15.64270) QuantErr: 15.64270 batch_time=0.60594 
Train Epoch: 19 [188/250 24064/32000 (75%)] Loss: 8.14049 (QuantReg: 15.48792) QuantErr: 15.48792 batch_time=0.60474 
Train Epoch: 19 [199/250 25472/32000 (80%)] Loss: 7.05603 (QuantReg: 15.54663) QuantErr: 15.54663 batch_time=0.60874 
Train Epoch: 19 [210/250 26880/32000 (84%)] Loss: 8.29399 (QuantReg: 15.36980) QuantErr: 15.36980 batch_time=1.79434 
Train Epoch: 19 [221/250 28288/32000 (88%)] Loss: 9.15397 (QuantReg: 15.28071) QuantErr: 15.28071 batch_time=0.60452 
Train Epoch: 19 [232/250 29696/32000 (93%)] Loss: 9.11727 (QuantReg: 15.37587) QuantErr: 15.37587 batch_time=0.60122 
Train Epoch: 19 [243/250 31104/32000 (97%)] Loss: 8.82041 (QuantReg: 15.27108) QuantErr: 15.27108 batch_time=0.62814 
Train Epoch: 19 codebook_update_time=3.25101
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch19.pth ...
Done in 4.196s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 8.375077934265137
 quant_reg      : 15.301295967102051
 quant_err      : 15.301295967102051
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 4750
 LSMDC_full_test/t2v_metrics/R1: 12.5
 LSMDC_full_test/t2v_metrics/R5: 30.8
 LSMDC_full_test/t2v_metrics/R10: 40.8
 LSMDC_full_test/t2v_metrics/R50: 69.7
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.963
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.04418851565213
 LSMDC_full_test/v2t_metrics/R1: 12.3
 LSMDC_full_test/v2t_metrics/R5: 31.6
 LSMDC_full_test/v2t_metrics/R10: 40.7
 LSMDC_full_test/v2t_metrics/R50: 68.7
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 69.005
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.103187375315578
 mnt_best       : 25.71432430329307
 not_improved_count: 9
Train Epoch: 20 [1/250 128/32000 (0%)] Loss: 9.78646 (QuantReg: 15.09412) QuantErr: 15.09412 batch_time=21.16814 
Train Epoch: 20 [12/250 1536/32000 (5%)] Loss: 8.00336 (QuantReg: 15.27592) QuantErr: 15.27592 batch_time=0.61830 
Train Epoch: 20 [23/250 2944/32000 (9%)] Loss: 7.75568 (QuantReg: 15.45753) QuantErr: 15.45753 batch_time=0.60475 
Train Epoch: 20 [34/250 4352/32000 (14%)] Loss: 7.46322 (QuantReg: 15.20500) QuantErr: 15.20500 batch_time=0.61198 
Train Epoch: 20 [45/250 5760/32000 (18%)] Loss: 8.37990 (QuantReg: 15.11658) QuantErr: 15.11658 batch_time=0.60929 
Train Epoch: 20 [56/250 7168/32000 (22%)] Loss: 8.17623 (QuantReg: 15.49039) QuantErr: 15.49039 batch_time=0.61022 
Train Epoch: 20 [67/250 8576/32000 (27%)] Loss: 7.96142 (QuantReg: 15.35418) QuantErr: 15.35418 batch_time=0.62806 
Train Epoch: 20 [78/250 9984/32000 (31%)] Loss: 7.81420 (QuantReg: 15.31308) QuantErr: 15.31308 batch_time=0.62226 
Train Epoch: 20 [89/250 11392/32000 (36%)] Loss: 8.54663 (QuantReg: 15.30946) QuantErr: 15.30946 batch_time=0.60848 
Train Epoch: 20 [100/250 12800/32000 (40%)] Loss: 10.23873 (QuantReg: 15.43670) QuantErr: 15.43670 batch_time=0.61307 
Train Epoch: 20 [111/250 14208/32000 (44%)] Loss: 9.53328 (QuantReg: 15.23212) QuantErr: 15.23212 batch_time=0.60930 
Train Epoch: 20 [122/250 15616/32000 (49%)] Loss: 8.02096 (QuantReg: 15.26871) QuantErr: 15.26871 batch_time=0.60955 
Train Epoch: 20 [133/250 17024/32000 (53%)] Loss: 7.22981 (QuantReg: 15.27218) QuantErr: 15.27218 batch_time=0.60883 
Train Epoch: 20 [144/250 18432/32000 (58%)] Loss: 9.25788 (QuantReg: 15.41224) QuantErr: 15.41224 batch_time=0.61575 
Train Epoch: 20 [155/250 19840/32000 (62%)] Loss: 7.88961 (QuantReg: 15.15290) QuantErr: 15.15290 batch_time=0.60844 
Train Epoch: 20 [166/250 21248/32000 (66%)] Loss: 7.54663 (QuantReg: 15.38405) QuantErr: 15.38405 batch_time=0.60739 
Train Epoch: 20 [177/250 22656/32000 (71%)] Loss: 9.57621 (QuantReg: 15.37306) QuantErr: 15.37306 batch_time=0.60415 
Train Epoch: 20 [188/250 24064/32000 (75%)] Loss: 8.03470 (QuantReg: 15.41839) QuantErr: 15.41839 batch_time=0.68613 
Train Epoch: 20 [199/250 25472/32000 (80%)] Loss: 6.74515 (QuantReg: 15.42111) QuantErr: 15.42111 batch_time=0.67005 
Train Epoch: 20 [210/250 26880/32000 (84%)] Loss: 8.22140 (QuantReg: 15.26787) QuantErr: 15.26787 batch_time=1.40819 
Train Epoch: 20 [221/250 28288/32000 (88%)] Loss: 7.34658 (QuantReg: 15.13209) QuantErr: 15.13209 batch_time=0.61658 
Train Epoch: 20 [232/250 29696/32000 (93%)] Loss: 8.72122 (QuantReg: 15.32086) QuantErr: 15.32086 batch_time=1.13580 
Train Epoch: 20 [243/250 31104/32000 (97%)] Loss: 6.50920 (QuantReg: 15.44427) QuantErr: 15.44427 batch_time=0.61697 
Train Epoch: 20 codebook_update_time=3.26184
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch20.pth ...
Done in 23.702s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 20
 loss           : 8.145360593795777
 quant_reg      : 15.326747428894043
 quant_err      : 15.326747428894043
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 5000
 LSMDC_full_test/t2v_metrics/R1: 12.1
 LSMDC_full_test/t2v_metrics/R5: 31.5
 LSMDC_full_test/t2v_metrics/R10: 41.7
 LSMDC_full_test/t2v_metrics/R50: 70.4
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.84
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.142627416055785
 LSMDC_full_test/v2t_metrics/R1: 12.2
 LSMDC_full_test/v2t_metrics/R5: 32.2
 LSMDC_full_test/v2t_metrics/R10: 41.6
 LSMDC_full_test/v2t_metrics/R50: 69.2
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 68.78
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.376770048090844
 mnt_best       : 25.71432430329307
 not_improved_count: 10
Train Epoch: 21 [1/250 128/32000 (0%)] Loss: 7.76369 (QuantReg: 15.41406) QuantErr: 15.41406 batch_time=20.25088 
Train Epoch: 21 [12/250 1536/32000 (5%)] Loss: 7.74684 (QuantReg: 15.25438) QuantErr: 15.25438 batch_time=0.63963 
Train Epoch: 21 [23/250 2944/32000 (9%)] Loss: 9.29821 (QuantReg: 15.20857) QuantErr: 15.20857 batch_time=0.60879 
Train Epoch: 21 [34/250 4352/32000 (14%)] Loss: 8.04711 (QuantReg: 15.29482) QuantErr: 15.29482 batch_time=0.59851 
Train Epoch: 21 [45/250 5760/32000 (18%)] Loss: 8.52299 (QuantReg: 15.49488) QuantErr: 15.49488 batch_time=0.64252 
Train Epoch: 21 [56/250 7168/32000 (22%)] Loss: 7.43205 (QuantReg: 15.37463) QuantErr: 15.37463 batch_time=0.61697 
Train Epoch: 21 [67/250 8576/32000 (27%)] Loss: 8.10272 (QuantReg: 15.38558) QuantErr: 15.38558 batch_time=0.61510 
Train Epoch: 21 [78/250 9984/32000 (31%)] Loss: 7.52463 (QuantReg: 15.34394) QuantErr: 15.34394 batch_time=0.62198 
Train Epoch: 21 [89/250 11392/32000 (36%)] Loss: 7.04799 (QuantReg: 15.28308) QuantErr: 15.28308 batch_time=0.59435 
Train Epoch: 21 [100/250 12800/32000 (40%)] Loss: 8.25712 (QuantReg: 15.35428) QuantErr: 15.35428 batch_time=0.59011 
Train Epoch: 21 [111/250 14208/32000 (44%)] Loss: 8.11751 (QuantReg: 15.32696) QuantErr: 15.32696 batch_time=0.61192 
Train Epoch: 21 [122/250 15616/32000 (49%)] Loss: 9.17449 (QuantReg: 15.24118) QuantErr: 15.24118 batch_time=0.60844 
Train Epoch: 21 [133/250 17024/32000 (53%)] Loss: 8.25028 (QuantReg: 15.40617) QuantErr: 15.40617 batch_time=1.23795 
Train Epoch: 21 [144/250 18432/32000 (58%)] Loss: 6.93198 (QuantReg: 15.44237) QuantErr: 15.44237 batch_time=0.60462 
Train Epoch: 21 [155/250 19840/32000 (62%)] Loss: 6.96664 (QuantReg: 15.33129) QuantErr: 15.33129 batch_time=0.59506 
Train Epoch: 21 [166/250 21248/32000 (66%)] Loss: 7.82051 (QuantReg: 15.42652) QuantErr: 15.42652 batch_time=0.60142 
Train Epoch: 21 [177/250 22656/32000 (71%)] Loss: 9.17197 (QuantReg: 15.32218) QuantErr: 15.32218 batch_time=0.59527 
Train Epoch: 21 [188/250 24064/32000 (75%)] Loss: 7.90954 (QuantReg: 15.13763) QuantErr: 15.13763 batch_time=0.59924 
Train Epoch: 21 [199/250 25472/32000 (80%)] Loss: 9.46817 (QuantReg: 15.13796) QuantErr: 15.13796 batch_time=0.59789 
Train Epoch: 21 [210/250 26880/32000 (84%)] Loss: 8.21368 (QuantReg: 15.46644) QuantErr: 15.46644 batch_time=0.64131 
Train Epoch: 21 [221/250 28288/32000 (88%)] Loss: 6.52777 (QuantReg: 15.60207) QuantErr: 15.60207 batch_time=0.61057 
Train Epoch: 21 [232/250 29696/32000 (93%)] Loss: 7.24874 (QuantReg: 15.27832) QuantErr: 15.27832 batch_time=0.64320 
Train Epoch: 21 [243/250 31104/32000 (97%)] Loss: 7.25814 (QuantReg: 15.40532) QuantErr: 15.40532 batch_time=0.61322 
Train Epoch: 21 codebook_update_time=3.30086
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch21.pth ...
Done in 5.277s
removing stale ckpt [epoch 20] [took 0.04s]
 epoch          : 21
 loss           : 8.039105613708497
 quant_reg      : 15.350527359008789
 quant_err      : 15.350527359008789
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 5250
 LSMDC_full_test/t2v_metrics/R1: 12.1
 LSMDC_full_test/t2v_metrics/R5: 32.2
 LSMDC_full_test/t2v_metrics/R10: 42.2
 LSMDC_full_test/t2v_metrics/R50: 69.9
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.088
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.428333439317417
 LSMDC_full_test/v2t_metrics/R1: 12.5
 LSMDC_full_test/v2t_metrics/R5: 32.5
 LSMDC_full_test/v2t_metrics/R10: 42.1
 LSMDC_full_test/v2t_metrics/R50: 69.7
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 67.622
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.764703953191407
 mnt_best       : 25.71432430329307
 not_improved_count: 11
Train Epoch: 22 [1/250 128/32000 (0%)] Loss: 8.08856 (QuantReg: 15.31125) QuantErr: 15.31125 batch_time=18.32402 
Train Epoch: 22 [12/250 1536/32000 (5%)] Loss: 7.60501 (QuantReg: 15.58988) QuantErr: 15.58988 batch_time=0.59696 
Train Epoch: 22 [23/250 2944/32000 (9%)] Loss: 7.13543 (QuantReg: 15.45387) QuantErr: 15.45387 batch_time=0.65897 
Train Epoch: 22 [34/250 4352/32000 (14%)] Loss: 8.39772 (QuantReg: 15.19473) QuantErr: 15.19473 batch_time=0.61217 
Train Epoch: 22 [45/250 5760/32000 (18%)] Loss: 7.29564 (QuantReg: 15.31832) QuantErr: 15.31832 batch_time=0.60973 
Train Epoch: 22 [56/250 7168/32000 (22%)] Loss: 8.73960 (QuantReg: 15.23988) QuantErr: 15.23988 batch_time=0.61651 
Train Epoch: 22 [67/250 8576/32000 (27%)] Loss: 6.81316 (QuantReg: 15.28940) QuantErr: 15.28940 batch_time=0.61960 
Train Epoch: 22 [78/250 9984/32000 (31%)] Loss: 7.29781 (QuantReg: 15.40989) QuantErr: 15.40989 batch_time=0.62086 
Train Epoch: 22 [89/250 11392/32000 (36%)] Loss: 8.22605 (QuantReg: 15.38532) QuantErr: 15.38532 batch_time=0.62240 
Train Epoch: 22 [100/250 12800/32000 (40%)] Loss: 9.53015 (QuantReg: 15.48735) QuantErr: 15.48735 batch_time=0.61022 
Train Epoch: 22 [111/250 14208/32000 (44%)] Loss: 7.47874 (QuantReg: 15.41785) QuantErr: 15.41785 batch_time=0.61145 
Train Epoch: 22 [122/250 15616/32000 (49%)] Loss: 8.63278 (QuantReg: 15.30557) QuantErr: 15.30557 batch_time=0.61780 
Train Epoch: 22 [133/250 17024/32000 (53%)] Loss: 7.56572 (QuantReg: 15.33340) QuantErr: 15.33340 batch_time=0.61786 
Train Epoch: 22 [144/250 18432/32000 (58%)] Loss: 7.52474 (QuantReg: 15.44496) QuantErr: 15.44496 batch_time=0.59571 
Train Epoch: 22 [155/250 19840/32000 (62%)] Loss: 6.99256 (QuantReg: 15.34485) QuantErr: 15.34485 batch_time=0.65687 
Train Epoch: 22 [166/250 21248/32000 (66%)] Loss: 8.72636 (QuantReg: 15.54423) QuantErr: 15.54423 batch_time=0.61201 
Train Epoch: 22 [177/250 22656/32000 (71%)] Loss: 8.91451 (QuantReg: 15.32300) QuantErr: 15.32300 batch_time=0.60321 
Train Epoch: 22 [188/250 24064/32000 (75%)] Loss: 8.51107 (QuantReg: 15.31184) QuantErr: 15.31184 batch_time=0.60293 
Train Epoch: 22 [199/250 25472/32000 (80%)] Loss: 8.45606 (QuantReg: 15.28509) QuantErr: 15.28509 batch_time=0.63344 
Train Epoch: 22 [210/250 26880/32000 (84%)] Loss: 7.95829 (QuantReg: 15.26900) QuantErr: 15.26900 batch_time=1.26197 
Train Epoch: 22 [221/250 28288/32000 (88%)] Loss: 7.07918 (QuantReg: 15.47801) QuantErr: 15.47801 batch_time=1.62403 
Train Epoch: 22 [232/250 29696/32000 (93%)] Loss: 6.84153 (QuantReg: 15.57748) QuantErr: 15.57748 batch_time=0.71766 
Train Epoch: 22 [243/250 31104/32000 (97%)] Loss: 7.71995 (QuantReg: 15.52350) QuantErr: 15.52350 batch_time=0.64970 
Train Epoch: 22 codebook_update_time=3.72982
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch22.pth ...
Done in 3.648s
removing stale ckpt [epoch 21] [took 0.01s]
 epoch          : 22
 loss           : 7.830251636505127
 quant_reg      : 15.402957794189453
 quant_err      : 15.402957794189453
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 5500
 LSMDC_full_test/t2v_metrics/R1: 11.8
 LSMDC_full_test/t2v_metrics/R5: 31.9
 LSMDC_full_test/t2v_metrics/R10: 42.6
 LSMDC_full_test/t2v_metrics/R50: 70.7
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.23
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.217039370400766
 LSMDC_full_test/v2t_metrics/R1: 13.8
 LSMDC_full_test/v2t_metrics/R5: 30.8
 LSMDC_full_test/v2t_metrics/R10: 41.7
 LSMDC_full_test/v2t_metrics/R50: 69.4
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 67.521
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.07285679511125
 mnt_best       : 25.71432430329307
 not_improved_count: 12
Train Epoch: 23 [1/250 128/32000 (0%)] Loss: 8.28068 (QuantReg: 15.39373) QuantErr: 15.39373 batch_time=18.56067 
Train Epoch: 23 [12/250 1536/32000 (5%)] Loss: 7.42505 (QuantReg: 15.35949) QuantErr: 15.35949 batch_time=0.60867 
Train Epoch: 23 [23/250 2944/32000 (9%)] Loss: 8.49648 (QuantReg: 15.35327) QuantErr: 15.35327 batch_time=0.60750 
Train Epoch: 23 [34/250 4352/32000 (14%)] Loss: 7.81109 (QuantReg: 15.29927) QuantErr: 15.29927 batch_time=0.67401 
Train Epoch: 23 [45/250 5760/32000 (18%)] Loss: 9.04717 (QuantReg: 15.36140) QuantErr: 15.36140 batch_time=0.77028 
Train Epoch: 23 [56/250 7168/32000 (22%)] Loss: 8.75984 (QuantReg: 15.15807) QuantErr: 15.15807 batch_time=0.59533 
Train Epoch: 23 [67/250 8576/32000 (27%)] Loss: 7.17738 (QuantReg: 15.51985) QuantErr: 15.51985 batch_time=0.62583 
Train Epoch: 23 [78/250 9984/32000 (31%)] Loss: 7.68049 (QuantReg: 15.43995) QuantErr: 15.43995 batch_time=0.65371 
Train Epoch: 23 [89/250 11392/32000 (36%)] Loss: 7.11110 (QuantReg: 15.53324) QuantErr: 15.53324 batch_time=0.61112 
Train Epoch: 23 [100/250 12800/32000 (40%)] Loss: 6.89628 (QuantReg: 15.59769) QuantErr: 15.59769 batch_time=0.61563 
Train Epoch: 23 [111/250 14208/32000 (44%)] Loss: 6.90552 (QuantReg: 15.42301) QuantErr: 15.42301 batch_time=1.22620 
Train Epoch: 23 [122/250 15616/32000 (49%)] Loss: 8.13282 (QuantReg: 15.57227) QuantErr: 15.57227 batch_time=0.60664 
Train Epoch: 23 [133/250 17024/32000 (53%)] Loss: 8.52045 (QuantReg: 15.33687) QuantErr: 15.33687 batch_time=1.51108 
Train Epoch: 23 [144/250 18432/32000 (58%)] Loss: 7.82538 (QuantReg: 15.61396) QuantErr: 15.61396 batch_time=2.36783 
Train Epoch: 23 [155/250 19840/32000 (62%)] Loss: 7.59441 (QuantReg: 15.27592) QuantErr: 15.27592 batch_time=0.61450 
Train Epoch: 23 [166/250 21248/32000 (66%)] Loss: 7.10240 (QuantReg: 15.67115) QuantErr: 15.67115 batch_time=0.61148 
Train Epoch: 23 [177/250 22656/32000 (71%)] Loss: 8.79378 (QuantReg: 15.73267) QuantErr: 15.73267 batch_time=0.61562 
Train Epoch: 23 [188/250 24064/32000 (75%)] Loss: 7.55164 (QuantReg: 15.44936) QuantErr: 15.44936 batch_time=0.61029 
Train Epoch: 23 [199/250 25472/32000 (80%)] Loss: 7.34829 (QuantReg: 15.35301) QuantErr: 15.35301 batch_time=0.60731 
Train Epoch: 23 [210/250 26880/32000 (84%)] Loss: 7.79061 (QuantReg: 15.54838) QuantErr: 15.54838 batch_time=0.60258 
Train Epoch: 23 [221/250 28288/32000 (88%)] Loss: 8.07758 (QuantReg: 15.59367) QuantErr: 15.59367 batch_time=0.61953 
Train Epoch: 23 [232/250 29696/32000 (93%)] Loss: 8.80776 (QuantReg: 15.32985) QuantErr: 15.32985 batch_time=0.60162 
Train Epoch: 23 [243/250 31104/32000 (97%)] Loss: 8.39929 (QuantReg: 15.50310) QuantErr: 15.50310 batch_time=0.61512 
Train Epoch: 23 codebook_update_time=3.31674
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch23.pth ...
Done in 4.463s
removing stale ckpt [epoch 22] [took 0.01s]
 epoch          : 23
 loss           : 7.675814193725586
 quant_reg      : 15.457437400817872
 quant_err      : 15.457437400817872
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 5750
 LSMDC_full_test/t2v_metrics/R1: 12.3
 LSMDC_full_test/t2v_metrics/R5: 31.9
 LSMDC_full_test/t2v_metrics/R10: 41.5
 LSMDC_full_test/t2v_metrics/R50: 71.1
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.446
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.346303473075643
 LSMDC_full_test/v2t_metrics/R1: 13.3
 LSMDC_full_test/v2t_metrics/R5: 30.5
 LSMDC_full_test/v2t_metrics/R10: 42.0
 LSMDC_full_test/v2t_metrics/R50: 69.4
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 69.404
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.73160781710085
 mnt_best       : 25.71432430329307
 not_improved_count: 13
Train Epoch: 24 [1/250 128/32000 (0%)] Loss: 7.18598 (QuantReg: 15.62033) QuantErr: 15.62033 batch_time=16.61472 
Train Epoch: 24 [12/250 1536/32000 (5%)] Loss: 8.78988 (QuantReg: 15.19758) QuantErr: 15.19758 batch_time=0.59849 
Train Epoch: 24 [23/250 2944/32000 (9%)] Loss: 7.27870 (QuantReg: 15.33224) QuantErr: 15.33224 batch_time=0.59947 
Train Epoch: 24 [34/250 4352/32000 (14%)] Loss: 8.00848 (QuantReg: 15.47781) QuantErr: 15.47781 batch_time=0.59943 
Train Epoch: 24 [45/250 5760/32000 (18%)] Loss: 6.64049 (QuantReg: 15.35698) QuantErr: 15.35698 batch_time=0.60168 
Train Epoch: 24 [56/250 7168/32000 (22%)] Loss: 7.73922 (QuantReg: 15.37729) QuantErr: 15.37729 batch_time=0.59844 
Train Epoch: 24 [67/250 8576/32000 (27%)] Loss: 7.49779 (QuantReg: 15.44563) QuantErr: 15.44563 batch_time=1.13020 
Train Epoch: 24 [78/250 9984/32000 (31%)] Loss: 7.37224 (QuantReg: 15.53212) QuantErr: 15.53212 batch_time=0.61705 
Train Epoch: 24 [89/250 11392/32000 (36%)] Loss: 7.33861 (QuantReg: 15.56375) QuantErr: 15.56375 batch_time=0.60132 
Train Epoch: 24 [100/250 12800/32000 (40%)] Loss: 7.83784 (QuantReg: 15.49713) QuantErr: 15.49713 batch_time=0.60321 
Train Epoch: 24 [111/250 14208/32000 (44%)] Loss: 8.11707 (QuantReg: 15.31317) QuantErr: 15.31317 batch_time=0.60648 
Train Epoch: 24 [122/250 15616/32000 (49%)] Loss: 8.28653 (QuantReg: 15.36886) QuantErr: 15.36886 batch_time=0.60705 
Train Epoch: 24 [133/250 17024/32000 (53%)] Loss: 7.63008 (QuantReg: 15.44598) QuantErr: 15.44598 batch_time=0.61037 
Train Epoch: 24 [144/250 18432/32000 (58%)] Loss: 7.80665 (QuantReg: 15.50667) QuantErr: 15.50667 batch_time=0.60434 
Train Epoch: 24 [155/250 19840/32000 (62%)] Loss: 6.91500 (QuantReg: 15.73006) QuantErr: 15.73006 batch_time=0.60474 
Train Epoch: 24 [166/250 21248/32000 (66%)] Loss: 8.94410 (QuantReg: 15.42049) QuantErr: 15.42049 batch_time=0.60478 
Train Epoch: 24 [177/250 22656/32000 (71%)] Loss: 8.49568 (QuantReg: 15.50483) QuantErr: 15.50483 batch_time=0.59911 
Train Epoch: 24 [188/250 24064/32000 (75%)] Loss: 6.18431 (QuantReg: 15.33446) QuantErr: 15.33446 batch_time=0.59989 
Train Epoch: 24 [199/250 25472/32000 (80%)] Loss: 7.53905 (QuantReg: 15.41870) QuantErr: 15.41870 batch_time=0.60467 
Train Epoch: 24 [210/250 26880/32000 (84%)] Loss: 7.45710 (QuantReg: 15.60338) QuantErr: 15.60338 batch_time=3.81293 
Train Epoch: 24 [221/250 28288/32000 (88%)] Loss: 7.43663 (QuantReg: 15.47374) QuantErr: 15.47374 batch_time=0.60669 
Train Epoch: 24 [232/250 29696/32000 (93%)] Loss: 6.92752 (QuantReg: 15.36854) QuantErr: 15.36854 batch_time=1.12165 
Train Epoch: 24 [243/250 31104/32000 (97%)] Loss: 8.03657 (QuantReg: 15.45504) QuantErr: 15.45504 batch_time=0.64008 
Train Epoch: 24 codebook_update_time=3.56610
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch24.pth ...
Done in 3.555s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch24.pth ...
Done in 7.008s
removing stale ckpt [epoch 23] [took 0.01s]
 epoch          : 24
 loss           : 7.468407884597778
 quant_reg      : 15.498932285308838
 quant_err      : 15.498932285308838
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 6000
 LSMDC_full_test/t2v_metrics/R1: 13.1
 LSMDC_full_test/t2v_metrics/R5: 32.4
 LSMDC_full_test/t2v_metrics/R10: 42.8
 LSMDC_full_test/t2v_metrics/R50: 70.0
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 70.641
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.287746512245672
 LSMDC_full_test/v2t_metrics/R1: 12.4
 LSMDC_full_test/v2t_metrics/R5: 32.0
 LSMDC_full_test/v2t_metrics/R10: 41.7
 LSMDC_full_test/v2t_metrics/R50: 70.3
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 69.863
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.48214051270438
 mnt_best       : 26.287746512245672
 not_improved_count: 0
Train Epoch: 25 [1/250 128/32000 (0%)] Loss: 8.37755 (QuantReg: 15.58223) QuantErr: 15.58223 batch_time=17.05106 
Train Epoch: 25 [12/250 1536/32000 (5%)] Loss: 8.46775 (QuantReg: 15.45425) QuantErr: 15.45425 batch_time=0.61260 
Train Epoch: 25 [23/250 2944/32000 (9%)] Loss: 7.13358 (QuantReg: 15.60893) QuantErr: 15.60893 batch_time=0.81019 
Train Epoch: 25 [34/250 4352/32000 (14%)] Loss: 8.08558 (QuantReg: 15.44014) QuantErr: 15.44014 batch_time=0.61464 
Train Epoch: 25 [45/250 5760/32000 (18%)] Loss: 7.37465 (QuantReg: 15.48475) QuantErr: 15.48475 batch_time=0.60574 
Train Epoch: 25 [56/250 7168/32000 (22%)] Loss: 6.96929 (QuantReg: 15.61073) QuantErr: 15.61073 batch_time=0.59057 
Train Epoch: 25 [67/250 8576/32000 (27%)] Loss: 7.61132 (QuantReg: 15.54958) QuantErr: 15.54958 batch_time=0.60998 
Train Epoch: 25 [78/250 9984/32000 (31%)] Loss: 7.27953 (QuantReg: 15.44399) QuantErr: 15.44399 batch_time=0.59918 
Train Epoch: 25 [89/250 11392/32000 (36%)] Loss: 7.31864 (QuantReg: 15.42716) QuantErr: 15.42716 batch_time=0.61085 
Train Epoch: 25 [100/250 12800/32000 (40%)] Loss: 6.91009 (QuantReg: 15.45145) QuantErr: 15.45145 batch_time=0.59932 
Train Epoch: 25 [111/250 14208/32000 (44%)] Loss: 6.87417 (QuantReg: 15.48698) QuantErr: 15.48698 batch_time=0.59536 
Train Epoch: 25 [122/250 15616/32000 (49%)] Loss: 6.98015 (QuantReg: 15.56986) QuantErr: 15.56986 batch_time=0.82031 
Train Epoch: 25 [133/250 17024/32000 (53%)] Loss: 7.91423 (QuantReg: 15.48085) QuantErr: 15.48085 batch_time=0.60804 
Train Epoch: 25 [144/250 18432/32000 (58%)] Loss: 6.60177 (QuantReg: 15.56681) QuantErr: 15.56681 batch_time=1.46827 
Train Epoch: 25 [155/250 19840/32000 (62%)] Loss: 6.27354 (QuantReg: 15.60353) QuantErr: 15.60353 batch_time=0.59657 
Train Epoch: 25 [166/250 21248/32000 (66%)] Loss: 8.02307 (QuantReg: 15.58828) QuantErr: 15.58828 batch_time=0.61269 
Train Epoch: 25 [177/250 22656/32000 (71%)] Loss: 7.23452 (QuantReg: 15.66727) QuantErr: 15.66727 batch_time=0.59360 
Train Epoch: 25 [188/250 24064/32000 (75%)] Loss: 7.13299 (QuantReg: 15.51372) QuantErr: 15.51372 batch_time=0.61562 
Train Epoch: 25 [199/250 25472/32000 (80%)] Loss: 8.53579 (QuantReg: 15.64410) QuantErr: 15.64410 batch_time=0.81616 
Train Epoch: 25 [210/250 26880/32000 (84%)] Loss: 5.99187 (QuantReg: 15.62576) QuantErr: 15.62576 batch_time=0.60865 
Train Epoch: 25 [221/250 28288/32000 (88%)] Loss: 6.89623 (QuantReg: 15.70859) QuantErr: 15.70859 batch_time=0.73365 
Train Epoch: 25 [232/250 29696/32000 (93%)] Loss: 7.81437 (QuantReg: 15.71713) QuantErr: 15.71713 batch_time=0.66882 
Train Epoch: 25 [243/250 31104/32000 (97%)] Loss: 7.23378 (QuantReg: 15.69956) QuantErr: 15.69956 batch_time=0.78720 
Train Epoch: 25 codebook_update_time=3.40434
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch25.pth ...
Done in 4.320s
removing stale ckpt [epoch 24] [took 0.01s]
 epoch          : 25
 loss           : 7.384522281646729
 quant_reg      : 15.55256602859497
 quant_err      : 15.55256602859497
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 6250
 LSMDC_full_test/t2v_metrics/R1: 12.1
 LSMDC_full_test/t2v_metrics/R5: 31.5
 LSMDC_full_test/t2v_metrics/R10: 42.4
 LSMDC_full_test/t2v_metrics/R50: 70.8
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.604
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.282533628188215
 LSMDC_full_test/v2t_metrics/R1: 12.6
 LSMDC_full_test/v2t_metrics/R5: 30.1
 LSMDC_full_test/v2t_metrics/R10: 41.2
 LSMDC_full_test/v2t_metrics/R50: 69.8
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 70.3565
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.000273063684116
 mnt_best       : 26.287746512245672
 not_improved_count: 1
Train Epoch: 26 [1/250 128/32000 (0%)] Loss: 6.77890 (QuantReg: 15.49588) QuantErr: 15.49588 batch_time=15.43889 
Train Epoch: 26 [12/250 1536/32000 (5%)] Loss: 7.00773 (QuantReg: 15.53033) QuantErr: 15.53033 batch_time=1.30369 
Train Epoch: 26 [23/250 2944/32000 (9%)] Loss: 7.15415 (QuantReg: 15.42939) QuantErr: 15.42939 batch_time=0.79580 
Train Epoch: 26 [34/250 4352/32000 (14%)] Loss: 7.63822 (QuantReg: 15.60642) QuantErr: 15.60642 batch_time=0.60946 
Train Epoch: 26 [45/250 5760/32000 (18%)] Loss: 7.29278 (QuantReg: 15.54135) QuantErr: 15.54135 batch_time=0.60169 
Train Epoch: 26 [56/250 7168/32000 (22%)] Loss: 7.80487 (QuantReg: 15.71807) QuantErr: 15.71807 batch_time=0.63564 
Train Epoch: 26 [67/250 8576/32000 (27%)] Loss: 7.12601 (QuantReg: 15.62749) QuantErr: 15.62749 batch_time=0.60305 
Train Epoch: 26 [78/250 9984/32000 (31%)] Loss: 7.70573 (QuantReg: 15.51268) QuantErr: 15.51268 batch_time=0.61771 
Train Epoch: 26 [89/250 11392/32000 (36%)] Loss: 6.97148 (QuantReg: 15.57824) QuantErr: 15.57824 batch_time=0.61352 
Train Epoch: 26 [100/250 12800/32000 (40%)] Loss: 7.19136 (QuantReg: 15.71949) QuantErr: 15.71949 batch_time=0.63308 
Train Epoch: 26 [111/250 14208/32000 (44%)] Loss: 6.50428 (QuantReg: 15.71143) QuantErr: 15.71143 batch_time=0.61352 
Train Epoch: 26 [122/250 15616/32000 (49%)] Loss: 6.69528 (QuantReg: 15.71530) QuantErr: 15.71530 batch_time=0.79057 
Train Epoch: 26 [133/250 17024/32000 (53%)] Loss: 7.74694 (QuantReg: 15.46960) QuantErr: 15.46960 batch_time=1.43100 
Train Epoch: 26 [144/250 18432/32000 (58%)] Loss: 7.42137 (QuantReg: 15.63670) QuantErr: 15.63670 batch_time=1.66046 
Train Epoch: 26 [155/250 19840/32000 (62%)] Loss: 7.90899 (QuantReg: 15.62056) QuantErr: 15.62056 batch_time=0.78126 
Train Epoch: 26 [166/250 21248/32000 (66%)] Loss: 5.86138 (QuantReg: 15.75581) QuantErr: 15.75581 batch_time=0.67132 
Train Epoch: 26 [177/250 22656/32000 (71%)] Loss: 7.16087 (QuantReg: 15.71201) QuantErr: 15.71201 batch_time=0.67790 
Train Epoch: 26 [188/250 24064/32000 (75%)] Loss: 7.44547 (QuantReg: 15.44214) QuantErr: 15.44214 batch_time=0.61814 
Train Epoch: 26 [199/250 25472/32000 (80%)] Loss: 8.80358 (QuantReg: 15.53599) QuantErr: 15.53599 batch_time=0.60745 
Train Epoch: 26 [210/250 26880/32000 (84%)] Loss: 7.19924 (QuantReg: 15.70109) QuantErr: 15.70109 batch_time=0.61356 
Train Epoch: 26 [221/250 28288/32000 (88%)] Loss: 8.13733 (QuantReg: 15.55353) QuantErr: 15.55353 batch_time=0.93617 
Train Epoch: 26 [232/250 29696/32000 (93%)] Loss: 6.57469 (QuantReg: 15.81132) QuantErr: 15.81132 batch_time=0.61369 
Train Epoch: 26 [243/250 31104/32000 (97%)] Loss: 6.26310 (QuantReg: 15.75036) QuantErr: 15.75036 batch_time=0.63406 
Train Epoch: 26 codebook_update_time=3.65669
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch26.pth ...
Done in 3.803s
removing stale ckpt [epoch 25] [took 0.07s]
 epoch          : 26
 loss           : 7.222637336730957
 quant_reg      : 15.60414697265625
 quant_err      : 15.60414697265625
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 6500
 LSMDC_full_test/t2v_metrics/R1: 12.8
 LSMDC_full_test/t2v_metrics/R5: 31.0
 LSMDC_full_test/t2v_metrics/R10: 41.8
 LSMDC_full_test/t2v_metrics/R50: 69.6
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.012
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.50249366873159
 LSMDC_full_test/v2t_metrics/R1: 12.3
 LSMDC_full_test/v2t_metrics/R5: 30.0
 LSMDC_full_test/v2t_metrics/R10: 40.0
 LSMDC_full_test/v2t_metrics/R50: 68.2
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 70.468
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 24.52988162948906
 mnt_best       : 26.287746512245672
 not_improved_count: 2
Train Epoch: 27 [1/250 128/32000 (0%)] Loss: 6.58671 (QuantReg: 15.53070) QuantErr: 15.53070 batch_time=15.32671 
Train Epoch: 27 [12/250 1536/32000 (5%)] Loss: 8.13325 (QuantReg: 15.66184) QuantErr: 15.66184 batch_time=0.65675 
Train Epoch: 27 [23/250 2944/32000 (9%)] Loss: 6.25152 (QuantReg: 15.54888) QuantErr: 15.54888 batch_time=0.60562 
Train Epoch: 27 [34/250 4352/32000 (14%)] Loss: 7.51454 (QuantReg: 15.58538) QuantErr: 15.58538 batch_time=1.12180 
Train Epoch: 27 [45/250 5760/32000 (18%)] Loss: 7.25018 (QuantReg: 15.45784) QuantErr: 15.45784 batch_time=0.60235 
Train Epoch: 27 [56/250 7168/32000 (22%)] Loss: 7.60903 (QuantReg: 15.76875) QuantErr: 15.76875 batch_time=0.61032 
Train Epoch: 27 [67/250 8576/32000 (27%)] Loss: 6.63981 (QuantReg: 15.49859) QuantErr: 15.49859 batch_time=0.61262 
Train Epoch: 27 [78/250 9984/32000 (31%)] Loss: 6.13303 (QuantReg: 15.54576) QuantErr: 15.54576 batch_time=0.64185 
Train Epoch: 27 [89/250 11392/32000 (36%)] Loss: 6.41633 (QuantReg: 15.92623) QuantErr: 15.92623 batch_time=0.61281 
Train Epoch: 27 [100/250 12800/32000 (40%)] Loss: 6.35068 (QuantReg: 15.67803) QuantErr: 15.67803 batch_time=0.82966 
Train Epoch: 27 [111/250 14208/32000 (44%)] Loss: 7.59978 (QuantReg: 15.59069) QuantErr: 15.59069 batch_time=0.61693 
Train Epoch: 27 [122/250 15616/32000 (49%)] Loss: 7.35002 (QuantReg: 15.61177) QuantErr: 15.61177 batch_time=0.61061 
Train Epoch: 27 [133/250 17024/32000 (53%)] Loss: 7.01821 (QuantReg: 15.72412) QuantErr: 15.72412 batch_time=0.59246 
Train Epoch: 27 [144/250 18432/32000 (58%)] Loss: 7.58203 (QuantReg: 15.65742) QuantErr: 15.65742 batch_time=4.17564 
Train Epoch: 27 [155/250 19840/32000 (62%)] Loss: 6.28037 (QuantReg: 15.83453) QuantErr: 15.83453 batch_time=0.61506 
Train Epoch: 27 [166/250 21248/32000 (66%)] Loss: 8.49300 (QuantReg: 15.57121) QuantErr: 15.57121 batch_time=2.56204 
Train Epoch: 27 [177/250 22656/32000 (71%)] Loss: 5.32035 (QuantReg: 15.71572) QuantErr: 15.71572 batch_time=0.61503 
Train Epoch: 27 [188/250 24064/32000 (75%)] Loss: 6.84684 (QuantReg: 15.65125) QuantErr: 15.65125 batch_time=0.60894 
Train Epoch: 27 [199/250 25472/32000 (80%)] Loss: 7.07267 (QuantReg: 15.63562) QuantErr: 15.63562 batch_time=0.59495 
Train Epoch: 27 [210/250 26880/32000 (84%)] Loss: 7.87406 (QuantReg: 15.37076) QuantErr: 15.37076 batch_time=0.66304 
Train Epoch: 27 [221/250 28288/32000 (88%)] Loss: 6.68409 (QuantReg: 15.40850) QuantErr: 15.40850 batch_time=0.62136 
Train Epoch: 27 [232/250 29696/32000 (93%)] Loss: 7.87210 (QuantReg: 15.63346) QuantErr: 15.63346 batch_time=0.60837 
Train Epoch: 27 [243/250 31104/32000 (97%)] Loss: 7.91990 (QuantReg: 15.45253) QuantErr: 15.45253 batch_time=0.61051 
Train Epoch: 27 codebook_update_time=3.25333
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch27.pth ...
Done in 3.538s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 7.061583175659179
 quant_reg      : 15.598489349365234
 quant_err      : 15.598489349365234
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 6750
 LSMDC_full_test/t2v_metrics/R1: 12.8
 LSMDC_full_test/t2v_metrics/R5: 32.0
 LSMDC_full_test/t2v_metrics/R10: 40.9
 LSMDC_full_test/t2v_metrics/R50: 70.0
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.944
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.587493891512466
 LSMDC_full_test/v2t_metrics/R1: 12.4
 LSMDC_full_test/v2t_metrics/R5: 31.3
 LSMDC_full_test/v2t_metrics/R10: 41.1
 LSMDC_full_test/v2t_metrics/R50: 69.6
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 69.609
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.173056362335938
 mnt_best       : 26.287746512245672
 not_improved_count: 3
Train Epoch: 28 [1/250 128/32000 (0%)] Loss: 6.76194 (QuantReg: 15.64943) QuantErr: 15.64943 batch_time=17.00000 
Train Epoch: 28 [12/250 1536/32000 (5%)] Loss: 6.40738 (QuantReg: 15.47003) QuantErr: 15.47003 batch_time=1.37866 
Train Epoch: 28 [23/250 2944/32000 (9%)] Loss: 6.02486 (QuantReg: 15.63502) QuantErr: 15.63502 batch_time=0.60083 
Train Epoch: 28 [34/250 4352/32000 (14%)] Loss: 6.60274 (QuantReg: 15.69448) QuantErr: 15.69448 batch_time=0.59279 
Train Epoch: 28 [45/250 5760/32000 (18%)] Loss: 6.95827 (QuantReg: 15.51133) QuantErr: 15.51133 batch_time=0.70407 
Train Epoch: 28 [56/250 7168/32000 (22%)] Loss: 6.82292 (QuantReg: 15.61923) QuantErr: 15.61923 batch_time=0.61037 
Train Epoch: 28 [67/250 8576/32000 (27%)] Loss: 7.36018 (QuantReg: 15.42026) QuantErr: 15.42026 batch_time=2.22742 
Train Epoch: 28 [78/250 9984/32000 (31%)] Loss: 6.77421 (QuantReg: 15.59351) QuantErr: 15.59351 batch_time=0.93774 
Train Epoch: 28 [89/250 11392/32000 (36%)] Loss: 8.29204 (QuantReg: 15.69852) QuantErr: 15.69852 batch_time=0.61000 
Train Epoch: 28 [100/250 12800/32000 (40%)] Loss: 6.48663 (QuantReg: 15.57410) QuantErr: 15.57410 batch_time=0.61049 
Train Epoch: 28 [111/250 14208/32000 (44%)] Loss: 7.95587 (QuantReg: 15.57986) QuantErr: 15.57986 batch_time=0.60033 
Train Epoch: 28 [122/250 15616/32000 (49%)] Loss: 6.81001 (QuantReg: 15.78451) QuantErr: 15.78451 batch_time=0.62154 
Train Epoch: 28 [133/250 17024/32000 (53%)] Loss: 6.40194 (QuantReg: 15.73693) QuantErr: 15.73693 batch_time=0.61862 
Train Epoch: 28 [144/250 18432/32000 (58%)] Loss: 6.84373 (QuantReg: 15.69419) QuantErr: 15.69419 batch_time=2.23703 
Train Epoch: 28 [155/250 19840/32000 (62%)] Loss: 6.66596 (QuantReg: 15.58388) QuantErr: 15.58388 batch_time=0.61945 
Train Epoch: 28 [166/250 21248/32000 (66%)] Loss: 8.65618 (QuantReg: 15.55896) QuantErr: 15.55896 batch_time=0.58987 
Train Epoch: 28 [177/250 22656/32000 (71%)] Loss: 7.20793 (QuantReg: 15.62897) QuantErr: 15.62897 batch_time=0.59439 
Train Epoch: 28 [188/250 24064/32000 (75%)] Loss: 6.51600 (QuantReg: 15.71592) QuantErr: 15.71592 batch_time=0.60135 
Train Epoch: 28 [199/250 25472/32000 (80%)] Loss: 8.12073 (QuantReg: 15.70946) QuantErr: 15.70946 batch_time=0.61473 
Train Epoch: 28 [210/250 26880/32000 (84%)] Loss: 6.57360 (QuantReg: 15.60653) QuantErr: 15.60653 batch_time=0.60500 
Train Epoch: 28 [221/250 28288/32000 (88%)] Loss: 6.71181 (QuantReg: 15.53216) QuantErr: 15.53216 batch_time=0.61745 
Train Epoch: 28 [232/250 29696/32000 (93%)] Loss: 7.35085 (QuantReg: 15.49776) QuantErr: 15.49776 batch_time=0.60321 
Train Epoch: 28 [243/250 31104/32000 (97%)] Loss: 6.68836 (QuantReg: 15.27049) QuantErr: 15.27049 batch_time=0.79151 
Train Epoch: 28 codebook_update_time=3.24131
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch28.pth ...
Done in 3.577s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 7.034050722122192
 quant_reg      : 15.632192272186279
 quant_err      : 15.632192272186279
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 7000
 LSMDC_full_test/t2v_metrics/R1: 12.7
 LSMDC_full_test/t2v_metrics/R5: 30.9
 LSMDC_full_test/t2v_metrics/R10: 42.5
 LSMDC_full_test/t2v_metrics/R50: 69.4
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.632
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.549576753698712
 LSMDC_full_test/v2t_metrics/R1: 12.9
 LSMDC_full_test/v2t_metrics/R5: 31.8
 LSMDC_full_test/v2t_metrics/R10: 40.9
 LSMDC_full_test/v2t_metrics/R50: 68.9
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 70.528
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.600397739588644
 mnt_best       : 26.287746512245672
 not_improved_count: 4
Train Epoch: 29 [1/250 128/32000 (0%)] Loss: 7.02105 (QuantReg: 15.54086) QuantErr: 15.54086 batch_time=16.78779 
Train Epoch: 29 [12/250 1536/32000 (5%)] Loss: 7.66866 (QuantReg: 15.36461) QuantErr: 15.36461 batch_time=0.65834 
Train Epoch: 29 [23/250 2944/32000 (9%)] Loss: 6.71442 (QuantReg: 15.52105) QuantErr: 15.52105 batch_time=0.67521 
Train Epoch: 29 [34/250 4352/32000 (14%)] Loss: 7.04297 (QuantReg: 15.53300) QuantErr: 15.53300 batch_time=1.36200 
Train Epoch: 29 [45/250 5760/32000 (18%)] Loss: 6.65761 (QuantReg: 15.55955) QuantErr: 15.55955 batch_time=0.61518 
Train Epoch: 29 [56/250 7168/32000 (22%)] Loss: 7.99137 (QuantReg: 15.51788) QuantErr: 15.51788 batch_time=0.81530 
Train Epoch: 29 [67/250 8576/32000 (27%)] Loss: 8.32260 (QuantReg: 15.66110) QuantErr: 15.66110 batch_time=0.61255 
Train Epoch: 29 [78/250 9984/32000 (31%)] Loss: 7.55444 (QuantReg: 15.51861) QuantErr: 15.51861 batch_time=0.61442 
Train Epoch: 29 [89/250 11392/32000 (36%)] Loss: 7.46466 (QuantReg: 15.54605) QuantErr: 15.54605 batch_time=0.60406 
Train Epoch: 29 [100/250 12800/32000 (40%)] Loss: 7.36561 (QuantReg: 15.63953) QuantErr: 15.63953 batch_time=1.96875 
Train Epoch: 29 [111/250 14208/32000 (44%)] Loss: 6.27840 (QuantReg: 15.67006) QuantErr: 15.67006 batch_time=0.60153 
Train Epoch: 29 [122/250 15616/32000 (49%)] Loss: 6.93015 (QuantReg: 15.74175) QuantErr: 15.74175 batch_time=0.60662 
Train Epoch: 29 [133/250 17024/32000 (53%)] Loss: 6.80871 (QuantReg: 15.57542) QuantErr: 15.57542 batch_time=0.61094 
Train Epoch: 29 [144/250 18432/32000 (58%)] Loss: 7.10211 (QuantReg: 15.47544) QuantErr: 15.47544 batch_time=0.61179 
Train Epoch: 29 [155/250 19840/32000 (62%)] Loss: 6.34106 (QuantReg: 15.63554) QuantErr: 15.63554 batch_time=0.60899 
Train Epoch: 29 [166/250 21248/32000 (66%)] Loss: 6.57150 (QuantReg: 15.81490) QuantErr: 15.81490 batch_time=0.61228 
Train Epoch: 29 [177/250 22656/32000 (71%)] Loss: 7.41766 (QuantReg: 15.58441) QuantErr: 15.58441 batch_time=0.61125 
Train Epoch: 29 [188/250 24064/32000 (75%)] Loss: 5.62802 (QuantReg: 15.62881) QuantErr: 15.62881 batch_time=0.59985 
Train Epoch: 29 [199/250 25472/32000 (80%)] Loss: 6.93740 (QuantReg: 15.56565) QuantErr: 15.56565 batch_time=0.61700 
Train Epoch: 29 [210/250 26880/32000 (84%)] Loss: 7.54892 (QuantReg: 15.69995) QuantErr: 15.69995 batch_time=0.60005 
Train Epoch: 29 [221/250 28288/32000 (88%)] Loss: 7.10417 (QuantReg: 15.62873) QuantErr: 15.62873 batch_time=0.61555 
Train Epoch: 29 [232/250 29696/32000 (93%)] Loss: 6.27599 (QuantReg: 15.75919) QuantErr: 15.75919 batch_time=0.59724 
Train Epoch: 29 [243/250 31104/32000 (97%)] Loss: 6.62170 (QuantReg: 15.68706) QuantErr: 15.68706 batch_time=0.61445 
Train Epoch: 29 codebook_update_time=3.31182
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch29.pth ...
Done in 3.453s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch29.pth ...
Done in 6.739s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 29
 loss           : 6.8408091850280766
 quant_reg      : 15.641864353179932
 quant_err      : 15.641864353179932
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 7250
 LSMDC_full_test/t2v_metrics/R1: 14.1
 LSMDC_full_test/t2v_metrics/R5: 32.6
 LSMDC_full_test/t2v_metrics/R10: 41.9
 LSMDC_full_test/t2v_metrics/R50: 69.8
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.275
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.80506791364838
 LSMDC_full_test/v2t_metrics/R1: 13.1
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 40.7
 LSMDC_full_test/v2t_metrics/R50: 68.3
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.209
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.581840352089724
 mnt_best       : 26.80506791364838
 not_improved_count: 0
Train Epoch: 30 [1/250 128/32000 (0%)] Loss: 6.69831 (QuantReg: 15.50361) QuantErr: 15.50361 batch_time=17.38589 
Train Epoch: 30 [12/250 1536/32000 (5%)] Loss: 6.14422 (QuantReg: 15.58348) QuantErr: 15.58348 batch_time=3.18062 
Train Epoch: 30 [23/250 2944/32000 (9%)] Loss: 6.91637 (QuantReg: 15.61753) QuantErr: 15.61753 batch_time=0.61586 
Train Epoch: 30 [34/250 4352/32000 (14%)] Loss: 7.42296 (QuantReg: 15.48084) QuantErr: 15.48084 batch_time=0.61399 
Train Epoch: 30 [45/250 5760/32000 (18%)] Loss: 7.67174 (QuantReg: 15.46173) QuantErr: 15.46173 batch_time=0.61807 
Train Epoch: 30 [56/250 7168/32000 (22%)] Loss: 6.82603 (QuantReg: 15.59368) QuantErr: 15.59368 batch_time=0.60855 
Train Epoch: 30 [67/250 8576/32000 (27%)] Loss: 5.77895 (QuantReg: 15.60780) QuantErr: 15.60780 batch_time=0.61156 
Train Epoch: 30 [78/250 9984/32000 (31%)] Loss: 6.64483 (QuantReg: 15.76285) QuantErr: 15.76285 batch_time=0.61754 
Train Epoch: 30 [89/250 11392/32000 (36%)] Loss: 7.42305 (QuantReg: 15.70012) QuantErr: 15.70012 batch_time=0.63475 
Train Epoch: 30 [100/250 12800/32000 (40%)] Loss: 7.13751 (QuantReg: 15.58524) QuantErr: 15.58524 batch_time=0.61210 
Train Epoch: 30 [111/250 14208/32000 (44%)] Loss: 6.65287 (QuantReg: 15.78207) QuantErr: 15.78207 batch_time=0.62357 
Train Epoch: 30 [122/250 15616/32000 (49%)] Loss: 6.95472 (QuantReg: 15.56813) QuantErr: 15.56813 batch_time=0.60776 
Train Epoch: 30 [133/250 17024/32000 (53%)] Loss: 5.80860 (QuantReg: 15.75058) QuantErr: 15.75058 batch_time=1.28851 
Train Epoch: 30 [144/250 18432/32000 (58%)] Loss: 7.56226 (QuantReg: 15.64879) QuantErr: 15.64879 batch_time=2.22204 
Train Epoch: 30 [155/250 19840/32000 (62%)] Loss: 6.28313 (QuantReg: 15.56034) QuantErr: 15.56034 batch_time=0.68130 
Train Epoch: 30 [166/250 21248/32000 (66%)] Loss: 7.11389 (QuantReg: 15.84042) QuantErr: 15.84042 batch_time=0.61909 
Train Epoch: 30 [177/250 22656/32000 (71%)] Loss: 6.61019 (QuantReg: 15.61816) QuantErr: 15.61816 batch_time=0.61007 
Train Epoch: 30 [188/250 24064/32000 (75%)] Loss: 7.06830 (QuantReg: 15.64311) QuantErr: 15.64311 batch_time=0.60873 
Train Epoch: 30 [199/250 25472/32000 (80%)] Loss: 7.54473 (QuantReg: 15.54012) QuantErr: 15.54012 batch_time=0.60776 
Train Epoch: 30 [210/250 26880/32000 (84%)] Loss: 7.17102 (QuantReg: 15.97734) QuantErr: 15.97734 batch_time=0.62360 
Train Epoch: 30 [221/250 28288/32000 (88%)] Loss: 7.26449 (QuantReg: 15.82476) QuantErr: 15.82476 batch_time=0.62000 
Train Epoch: 30 [232/250 29696/32000 (93%)] Loss: 6.34699 (QuantReg: 15.71162) QuantErr: 15.71162 batch_time=0.61300 
Train Epoch: 30 [243/250 31104/32000 (97%)] Loss: 6.62966 (QuantReg: 15.91987) QuantErr: 15.91987 batch_time=0.61406 
Train Epoch: 30 codebook_update_time=3.28165
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch30.pth ...
Done in 4.118s
removing stale ckpt [epoch 29] [took 0.02s]
 epoch          : 30
 loss           : 6.775666297912598
 quant_reg      : 15.698066207885741
 quant_err      : 15.698066207885741
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 7500
 LSMDC_full_test/t2v_metrics/R1: 12.6
 LSMDC_full_test/t2v_metrics/R5: 31.5
 LSMDC_full_test/t2v_metrics/R10: 40.8
 LSMDC_full_test/t2v_metrics/R50: 69.6
 LSMDC_full_test/t2v_metrics/MedR: 18.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.63
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.29960577846053
 LSMDC_full_test/v2t_metrics/R1: 12.9
 LSMDC_full_test/v2t_metrics/R5: 31.7
 LSMDC_full_test/v2t_metrics/R10: 41.4
 LSMDC_full_test/v2t_metrics/R50: 68.5
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.2255
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.677324596814824
 mnt_best       : 26.80506791364838
 not_improved_count: 1
Train Epoch: 31 [1/250 128/32000 (0%)] Loss: 6.32968 (QuantReg: 15.50395) QuantErr: 15.50395 batch_time=19.58057 
Train Epoch: 31 [12/250 1536/32000 (5%)] Loss: 7.31877 (QuantReg: 15.73058) QuantErr: 15.73058 batch_time=0.62455 
Train Epoch: 31 [23/250 2944/32000 (9%)] Loss: 6.60535 (QuantReg: 15.60993) QuantErr: 15.60993 batch_time=0.63732 
Train Epoch: 31 [34/250 4352/32000 (14%)] Loss: 6.12799 (QuantReg: 15.61068) QuantErr: 15.61068 batch_time=0.61756 
Train Epoch: 31 [45/250 5760/32000 (18%)] Loss: 6.61080 (QuantReg: 15.44676) QuantErr: 15.44676 batch_time=0.61923 
Train Epoch: 31 [56/250 7168/32000 (22%)] Loss: 6.79001 (QuantReg: 15.63445) QuantErr: 15.63445 batch_time=0.61115 
Train Epoch: 31 [67/250 8576/32000 (27%)] Loss: 6.07358 (QuantReg: 15.76507) QuantErr: 15.76507 batch_time=0.61340 
Train Epoch: 31 [78/250 9984/32000 (31%)] Loss: 8.08241 (QuantReg: 15.62491) QuantErr: 15.62491 batch_time=0.62342 
Train Epoch: 31 [89/250 11392/32000 (36%)] Loss: 6.34969 (QuantReg: 15.63317) QuantErr: 15.63317 batch_time=0.61903 
Train Epoch: 31 [100/250 12800/32000 (40%)] Loss: 6.08578 (QuantReg: 15.77488) QuantErr: 15.77488 batch_time=0.62428 
Train Epoch: 31 [111/250 14208/32000 (44%)] Loss: 7.29092 (QuantReg: 15.65909) QuantErr: 15.65909 batch_time=0.61938 
Train Epoch: 31 [122/250 15616/32000 (49%)] Loss: 7.41764 (QuantReg: 15.73260) QuantErr: 15.73260 batch_time=0.71771 
Train Epoch: 31 [133/250 17024/32000 (53%)] Loss: 6.23879 (QuantReg: 15.57245) QuantErr: 15.57245 batch_time=1.14425 
Train Epoch: 31 [144/250 18432/32000 (58%)] Loss: 7.85554 (QuantReg: 15.73818) QuantErr: 15.73818 batch_time=0.62062 
Train Epoch: 31 [155/250 19840/32000 (62%)] Loss: 7.68241 (QuantReg: 15.80877) QuantErr: 15.80877 batch_time=0.72874 
Train Epoch: 31 [166/250 21248/32000 (66%)] Loss: 7.42746 (QuantReg: 15.74981) QuantErr: 15.74981 batch_time=0.62303 
Train Epoch: 31 [177/250 22656/32000 (71%)] Loss: 7.31930 (QuantReg: 15.72909) QuantErr: 15.72909 batch_time=0.61113 
Train Epoch: 31 [188/250 24064/32000 (75%)] Loss: 6.57334 (QuantReg: 15.68634) QuantErr: 15.68634 batch_time=0.61546 
Train Epoch: 31 [199/250 25472/32000 (80%)] Loss: 6.45206 (QuantReg: 15.93375) QuantErr: 15.93375 batch_time=0.60856 
Train Epoch: 31 [210/250 26880/32000 (84%)] Loss: 7.63508 (QuantReg: 15.58587) QuantErr: 15.58587 batch_time=0.59604 
Train Epoch: 31 [221/250 28288/32000 (88%)] Loss: 5.77472 (QuantReg: 15.60696) QuantErr: 15.60696 batch_time=0.60668 
Train Epoch: 31 [232/250 29696/32000 (93%)] Loss: 7.19955 (QuantReg: 15.59286) QuantErr: 15.59286 batch_time=0.60918 
Train Epoch: 31 [243/250 31104/32000 (97%)] Loss: 5.86825 (QuantReg: 15.67892) QuantErr: 15.67892 batch_time=0.60571 
Train Epoch: 31 codebook_update_time=3.26495
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch31.pth ...
Done in 3.842s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 6.740023155212402
 quant_reg      : 15.701641246795655
 quant_err      : 15.701641246795655
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 7750
 LSMDC_full_test/t2v_metrics/R1: 13.4
 LSMDC_full_test/t2v_metrics/R5: 31.9
 LSMDC_full_test/t2v_metrics/R10: 41.5
 LSMDC_full_test/t2v_metrics/R50: 69.5
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.685
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.080416699214815
 LSMDC_full_test/v2t_metrics/R1: 12.7
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 42.4
 LSMDC_full_test/v2t_metrics/R50: 68.3
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 70.465
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.666485709261863
 mnt_best       : 26.80506791364838
 not_improved_count: 2
Train Epoch: 32 [1/250 128/32000 (0%)] Loss: 7.81443 (QuantReg: 15.76850) QuantErr: 15.76850 batch_time=18.41695 
Train Epoch: 32 [12/250 1536/32000 (5%)] Loss: 6.97458 (QuantReg: 15.63194) QuantErr: 15.63194 batch_time=1.02234 
Train Epoch: 32 [23/250 2944/32000 (9%)] Loss: 5.72778 (QuantReg: 15.73613) QuantErr: 15.73613 batch_time=0.60226 
Train Epoch: 32 [34/250 4352/32000 (14%)] Loss: 6.33068 (QuantReg: 15.75517) QuantErr: 15.75517 batch_time=0.90248 
Train Epoch: 32 [45/250 5760/32000 (18%)] Loss: 7.22097 (QuantReg: 15.68674) QuantErr: 15.68674 batch_time=0.61548 
Train Epoch: 32 [56/250 7168/32000 (22%)] Loss: 6.27824 (QuantReg: 15.79294) QuantErr: 15.79294 batch_time=0.60139 
Train Epoch: 32 [67/250 8576/32000 (27%)] Loss: 8.00456 (QuantReg: 15.88913) QuantErr: 15.88913 batch_time=1.80893 
Train Epoch: 32 [78/250 9984/32000 (31%)] Loss: 6.24583 (QuantReg: 15.56728) QuantErr: 15.56728 batch_time=0.60524 
Train Epoch: 32 [89/250 11392/32000 (36%)] Loss: 5.87861 (QuantReg: 15.78388) QuantErr: 15.78388 batch_time=0.60316 
Train Epoch: 32 [100/250 12800/32000 (40%)] Loss: 5.70517 (QuantReg: 15.62696) QuantErr: 15.62696 batch_time=0.65067 
Train Epoch: 32 [111/250 14208/32000 (44%)] Loss: 6.32268 (QuantReg: 15.62245) QuantErr: 15.62245 batch_time=0.89837 
Train Epoch: 32 [122/250 15616/32000 (49%)] Loss: 6.78499 (QuantReg: 15.69285) QuantErr: 15.69285 batch_time=0.59975 
Train Epoch: 32 [133/250 17024/32000 (53%)] Loss: 6.50683 (QuantReg: 15.81352) QuantErr: 15.81352 batch_time=0.80257 
Train Epoch: 32 [144/250 18432/32000 (58%)] Loss: 6.52541 (QuantReg: 15.49690) QuantErr: 15.49690 batch_time=2.25889 
Train Epoch: 32 [155/250 19840/32000 (62%)] Loss: 6.07291 (QuantReg: 15.74278) QuantErr: 15.74278 batch_time=0.59935 
Train Epoch: 32 [166/250 21248/32000 (66%)] Loss: 6.35868 (QuantReg: 15.80860) QuantErr: 15.80860 batch_time=0.69944 
Train Epoch: 32 [177/250 22656/32000 (71%)] Loss: 6.09837 (QuantReg: 15.82201) QuantErr: 15.82201 batch_time=0.60830 
Train Epoch: 32 [188/250 24064/32000 (75%)] Loss: 6.89842 (QuantReg: 15.86580) QuantErr: 15.86580 batch_time=0.60073 
Train Epoch: 32 [199/250 25472/32000 (80%)] Loss: 6.84521 (QuantReg: 15.65674) QuantErr: 15.65674 batch_time=0.61300 
Train Epoch: 32 [210/250 26880/32000 (84%)] Loss: 7.69851 (QuantReg: 15.70877) QuantErr: 15.70877 batch_time=0.61123 
Train Epoch: 32 [221/250 28288/32000 (88%)] Loss: 6.55528 (QuantReg: 15.53146) QuantErr: 15.53146 batch_time=0.60639 
Train Epoch: 32 [232/250 29696/32000 (93%)] Loss: 6.81499 (QuantReg: 15.59808) QuantErr: 15.59808 batch_time=1.06927 
Train Epoch: 32 [243/250 31104/32000 (97%)] Loss: 6.20707 (QuantReg: 15.63313) QuantErr: 15.63313 batch_time=0.61816 
Train Epoch: 32 codebook_update_time=3.60105
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch32.pth ...
Done in 5.971s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 6.557895149230957
 quant_reg      : 15.689541828155518
 quant_err      : 15.689541828155518
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 8000
 LSMDC_full_test/t2v_metrics/R1: 12.9
 LSMDC_full_test/t2v_metrics/R5: 32.1
 LSMDC_full_test/t2v_metrics/R10: 42.1
 LSMDC_full_test/t2v_metrics/R50: 70.3
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.049
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.92938878126981
 LSMDC_full_test/v2t_metrics/R1: 13.2
 LSMDC_full_test/v2t_metrics/R5: 30.8
 LSMDC_full_test/v2t_metrics/R10: 41.5
 LSMDC_full_test/v2t_metrics/R50: 69.1
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 70.425
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.64824074357617
 mnt_best       : 26.80506791364838
 not_improved_count: 3
Train Epoch: 33 [1/250 128/32000 (0%)] Loss: 6.26034 (QuantReg: 15.69892) QuantErr: 15.69892 batch_time=17.74125 
Train Epoch: 33 [12/250 1536/32000 (5%)] Loss: 6.96451 (QuantReg: 15.56854) QuantErr: 15.56854 batch_time=0.71923 
Train Epoch: 33 [23/250 2944/32000 (9%)] Loss: 5.80511 (QuantReg: 15.71799) QuantErr: 15.71799 batch_time=0.81028 
Train Epoch: 33 [34/250 4352/32000 (14%)] Loss: 6.46966 (QuantReg: 15.70406) QuantErr: 15.70406 batch_time=0.61492 
Train Epoch: 33 [45/250 5760/32000 (18%)] Loss: 6.75482 (QuantReg: 15.71003) QuantErr: 15.71003 batch_time=0.60694 
Train Epoch: 33 [56/250 7168/32000 (22%)] Loss: 6.26944 (QuantReg: 15.68750) QuantErr: 15.68750 batch_time=0.60464 
Train Epoch: 33 [67/250 8576/32000 (27%)] Loss: 5.95619 (QuantReg: 15.80423) QuantErr: 15.80423 batch_time=0.61719 
Train Epoch: 33 [78/250 9984/32000 (31%)] Loss: 6.24339 (QuantReg: 15.71943) QuantErr: 15.71943 batch_time=0.81809 
Train Epoch: 33 [89/250 11392/32000 (36%)] Loss: 7.00173 (QuantReg: 15.81616) QuantErr: 15.81616 batch_time=0.61850 
Train Epoch: 33 [100/250 12800/32000 (40%)] Loss: 6.68142 (QuantReg: 15.50520) QuantErr: 15.50520 batch_time=0.61524 
Train Epoch: 33 [111/250 14208/32000 (44%)] Loss: 7.06951 (QuantReg: 15.76139) QuantErr: 15.76139 batch_time=0.61533 
Train Epoch: 33 [122/250 15616/32000 (49%)] Loss: 6.88765 (QuantReg: 15.67677) QuantErr: 15.67677 batch_time=0.61871 
Train Epoch: 33 [133/250 17024/32000 (53%)] Loss: 6.93571 (QuantReg: 15.48882) QuantErr: 15.48882 batch_time=0.61159 
Train Epoch: 33 [144/250 18432/32000 (58%)] Loss: 6.51844 (QuantReg: 15.61212) QuantErr: 15.61212 batch_time=0.62021 
Train Epoch: 33 [155/250 19840/32000 (62%)] Loss: 6.95757 (QuantReg: 15.84066) QuantErr: 15.84066 batch_time=0.61959 
Train Epoch: 33 [166/250 21248/32000 (66%)] Loss: 6.39795 (QuantReg: 15.66240) QuantErr: 15.66240 batch_time=0.61298 
Train Epoch: 33 [177/250 22656/32000 (71%)] Loss: 6.95160 (QuantReg: 15.63839) QuantErr: 15.63839 batch_time=0.60338 
Train Epoch: 33 [188/250 24064/32000 (75%)] Loss: 5.99076 (QuantReg: 15.75209) QuantErr: 15.75209 batch_time=0.65142 
Train Epoch: 33 [199/250 25472/32000 (80%)] Loss: 6.47062 (QuantReg: 15.67454) QuantErr: 15.67454 batch_time=1.15970 
Train Epoch: 33 [210/250 26880/32000 (84%)] Loss: 6.93524 (QuantReg: 15.58025) QuantErr: 15.58025 batch_time=1.24872 
Train Epoch: 33 [221/250 28288/32000 (88%)] Loss: 7.38838 (QuantReg: 15.69751) QuantErr: 15.69751 batch_time=0.67016 
Train Epoch: 33 [232/250 29696/32000 (93%)] Loss: 6.47480 (QuantReg: 15.65189) QuantErr: 15.65189 batch_time=0.61813 
Train Epoch: 33 [243/250 31104/32000 (97%)] Loss: 5.83561 (QuantReg: 15.91121) QuantErr: 15.91121 batch_time=0.62168 
Train Epoch: 33 codebook_update_time=3.25543
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch33.pth ...
Done in 4.285s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 6.454007253646851
 quant_reg      : 15.685342334747315
 quant_err      : 15.685342334747315
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 8250
 LSMDC_full_test/t2v_metrics/R1: 13.0
 LSMDC_full_test/t2v_metrics/R5: 32.8
 LSMDC_full_test/t2v_metrics/R10: 42.1
 LSMDC_full_test/t2v_metrics/R50: 69.9
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.79
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.183825457543158
 LSMDC_full_test/v2t_metrics/R1: 13.1
 LSMDC_full_test/v2t_metrics/R5: 30.9
 LSMDC_full_test/v2t_metrics/R10: 41.4
 LSMDC_full_test/v2t_metrics/R50: 68.4
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.581
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.59037826075778
 mnt_best       : 26.80506791364838
 not_improved_count: 4
Train Epoch: 34 [1/250 128/32000 (0%)] Loss: 6.39318 (QuantReg: 15.56515) QuantErr: 15.56515 batch_time=21.13146 
Train Epoch: 34 [12/250 1536/32000 (5%)] Loss: 6.71074 (QuantReg: 15.80829) QuantErr: 15.80829 batch_time=0.60895 
Train Epoch: 34 [23/250 2944/32000 (9%)] Loss: 6.95295 (QuantReg: 15.48772) QuantErr: 15.48772 batch_time=0.60310 
Train Epoch: 34 [34/250 4352/32000 (14%)] Loss: 5.60081 (QuantReg: 15.64601) QuantErr: 15.64601 batch_time=0.60675 
Train Epoch: 34 [45/250 5760/32000 (18%)] Loss: 7.55674 (QuantReg: 15.72802) QuantErr: 15.72802 batch_time=0.60237 
Train Epoch: 34 [56/250 7168/32000 (22%)] Loss: 6.05325 (QuantReg: 15.58383) QuantErr: 15.58383 batch_time=0.60534 
Train Epoch: 34 [67/250 8576/32000 (27%)] Loss: 6.35774 (QuantReg: 15.73251) QuantErr: 15.73251 batch_time=0.61977 
Train Epoch: 34 [78/250 9984/32000 (31%)] Loss: 6.89783 (QuantReg: 15.73215) QuantErr: 15.73215 batch_time=0.80936 
Train Epoch: 34 [89/250 11392/32000 (36%)] Loss: 6.58517 (QuantReg: 15.81081) QuantErr: 15.81081 batch_time=0.62720 
Train Epoch: 34 [100/250 12800/32000 (40%)] Loss: 6.66111 (QuantReg: 15.84208) QuantErr: 15.84208 batch_time=0.61913 
Train Epoch: 34 [111/250 14208/32000 (44%)] Loss: 6.06472 (QuantReg: 15.80423) QuantErr: 15.80423 batch_time=0.61000 
Train Epoch: 34 [122/250 15616/32000 (49%)] Loss: 6.38135 (QuantReg: 15.76326) QuantErr: 15.76326 batch_time=0.60345 
Train Epoch: 34 [133/250 17024/32000 (53%)] Loss: 7.68472 (QuantReg: 15.54596) QuantErr: 15.54596 batch_time=0.60880 
Train Epoch: 34 [144/250 18432/32000 (58%)] Loss: 6.68517 (QuantReg: 15.69510) QuantErr: 15.69510 batch_time=0.96407 
Train Epoch: 34 [155/250 19840/32000 (62%)] Loss: 6.49071 (QuantReg: 15.68069) QuantErr: 15.68069 batch_time=0.59476 
Train Epoch: 34 [166/250 21248/32000 (66%)] Loss: 7.08071 (QuantReg: 15.63936) QuantErr: 15.63936 batch_time=1.66055 
Train Epoch: 34 [177/250 22656/32000 (71%)] Loss: 5.86174 (QuantReg: 15.86072) QuantErr: 15.86072 batch_time=0.60585 
Train Epoch: 34 [188/250 24064/32000 (75%)] Loss: 6.24315 (QuantReg: 15.57526) QuantErr: 15.57526 batch_time=0.60187 
Train Epoch: 34 [199/250 25472/32000 (80%)] Loss: 6.05667 (QuantReg: 15.96087) QuantErr: 15.96087 batch_time=0.62669 
Train Epoch: 34 [210/250 26880/32000 (84%)] Loss: 7.08555 (QuantReg: 15.83467) QuantErr: 15.83467 batch_time=0.63653 
Train Epoch: 34 [221/250 28288/32000 (88%)] Loss: 7.58855 (QuantReg: 15.73712) QuantErr: 15.73712 batch_time=0.61895 
Train Epoch: 34 [232/250 29696/32000 (93%)] Loss: 6.33859 (QuantReg: 15.86626) QuantErr: 15.86626 batch_time=0.62972 
Train Epoch: 34 [243/250 31104/32000 (97%)] Loss: 6.71383 (QuantReg: 15.85722) QuantErr: 15.85722 batch_time=0.66990 
Train Epoch: 34 codebook_update_time=3.21345
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch34.pth ...
Done in 4.120s
removing stale ckpt [epoch 33] [took 0.04s]
 epoch          : 34
 loss           : 6.470245973587036
 quant_reg      : 15.724765872955322
 quant_err      : 15.724765872955322
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 8500
 LSMDC_full_test/t2v_metrics/R1: 13.6
 LSMDC_full_test/t2v_metrics/R5: 30.6
 LSMDC_full_test/t2v_metrics/R10: 41.0
 LSMDC_full_test/t2v_metrics/R50: 69.3
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.12
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.744318349308056
 LSMDC_full_test/v2t_metrics/R1: 13.9
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 40.3
 LSMDC_full_test/v2t_metrics/R50: 69.1
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.87
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.006575260088855
 mnt_best       : 26.80506791364838
 not_improved_count: 5
Train Epoch: 35 [1/250 128/32000 (0%)] Loss: 5.85678 (QuantReg: 15.80505) QuantErr: 15.80505 batch_time=15.45688 
Train Epoch: 35 [12/250 1536/32000 (5%)] Loss: 5.59395 (QuantReg: 15.79017) QuantErr: 15.79017 batch_time=0.60848 
Train Epoch: 35 [23/250 2944/32000 (9%)] Loss: 6.53959 (QuantReg: 15.93126) QuantErr: 15.93126 batch_time=0.60814 
Train Epoch: 35 [34/250 4352/32000 (14%)] Loss: 5.97383 (QuantReg: 15.85187) QuantErr: 15.85187 batch_time=0.60032 
Train Epoch: 35 [45/250 5760/32000 (18%)] Loss: 5.82688 (QuantReg: 15.66792) QuantErr: 15.66792 batch_time=0.60552 
Train Epoch: 35 [56/250 7168/32000 (22%)] Loss: 6.97440 (QuantReg: 15.67866) QuantErr: 15.67866 batch_time=1.10685 
Train Epoch: 35 [67/250 8576/32000 (27%)] Loss: 6.91942 (QuantReg: 15.65745) QuantErr: 15.65745 batch_time=0.61092 
Train Epoch: 35 [78/250 9984/32000 (31%)] Loss: 7.07101 (QuantReg: 15.80637) QuantErr: 15.80637 batch_time=0.61416 
Train Epoch: 35 [89/250 11392/32000 (36%)] Loss: 5.47425 (QuantReg: 15.77622) QuantErr: 15.77622 batch_time=0.60375 
Train Epoch: 35 [100/250 12800/32000 (40%)] Loss: 6.90752 (QuantReg: 15.47683) QuantErr: 15.47683 batch_time=0.61394 
Train Epoch: 35 [111/250 14208/32000 (44%)] Loss: 6.20075 (QuantReg: 15.93141) QuantErr: 15.93141 batch_time=0.60164 
Train Epoch: 35 [122/250 15616/32000 (49%)] Loss: 7.55959 (QuantReg: 15.61584) QuantErr: 15.61584 batch_time=0.60195 
Train Epoch: 35 [133/250 17024/32000 (53%)] Loss: 7.39549 (QuantReg: 15.51416) QuantErr: 15.51416 batch_time=0.60672 
Train Epoch: 35 [144/250 18432/32000 (58%)] Loss: 7.61880 (QuantReg: 15.79012) QuantErr: 15.79012 batch_time=0.60471 
Train Epoch: 35 [155/250 19840/32000 (62%)] Loss: 5.78010 (QuantReg: 15.80718) QuantErr: 15.80718 batch_time=0.59987 
Train Epoch: 35 [166/250 21248/32000 (66%)] Loss: 7.41720 (QuantReg: 15.76945) QuantErr: 15.76945 batch_time=0.60622 
Train Epoch: 35 [177/250 22656/32000 (71%)] Loss: 6.58030 (QuantReg: 15.68149) QuantErr: 15.68149 batch_time=0.60524 
Train Epoch: 35 [188/250 24064/32000 (75%)] Loss: 5.90400 (QuantReg: 15.77979) QuantErr: 15.77979 batch_time=0.60268 
Train Epoch: 35 [199/250 25472/32000 (80%)] Loss: 7.09714 (QuantReg: 15.74605) QuantErr: 15.74605 batch_time=0.60096 
Train Epoch: 35 [210/250 26880/32000 (84%)] Loss: 6.06235 (QuantReg: 15.80448) QuantErr: 15.80448 batch_time=0.60267 
Train Epoch: 35 [221/250 28288/32000 (88%)] Loss: 7.64668 (QuantReg: 15.76979) QuantErr: 15.76979 batch_time=0.60450 
Train Epoch: 35 [232/250 29696/32000 (93%)] Loss: 6.98658 (QuantReg: 15.85974) QuantErr: 15.85974 batch_time=0.60625 
Train Epoch: 35 [243/250 31104/32000 (97%)] Loss: 6.33300 (QuantReg: 15.91522) QuantErr: 15.91522 batch_time=0.61229 
Train Epoch: 35 codebook_update_time=3.29405
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch35.pth ...
Done in 5.009s
removing stale ckpt [epoch 34] [took 0.02s]
 epoch          : 35
 loss           : 6.370210729598999
 quant_reg      : 15.736875038146973
 quant_err      : 15.736875038146973
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 8750
 LSMDC_full_test/t2v_metrics/R1: 13.6
 LSMDC_full_test/t2v_metrics/R5: 31.4
 LSMDC_full_test/t2v_metrics/R10: 42.5
 LSMDC_full_test/t2v_metrics/R50: 68.9
 LSMDC_full_test/t2v_metrics/MedR: 16.5
 LSMDC_full_test/t2v_metrics/MeanR: 72.346
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.279624905936128
 LSMDC_full_test/v2t_metrics/R1: 13.2
 LSMDC_full_test/v2t_metrics/R5: 30.9
 LSMDC_full_test/v2t_metrics/R10: 40.7
 LSMDC_full_test/v2t_metrics/R50: 68.4
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 69.99
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.50991079579661
 mnt_best       : 26.80506791364838
 not_improved_count: 6
Train Epoch: 36 [1/250 128/32000 (0%)] Loss: 6.30054 (QuantReg: 15.71027) QuantErr: 15.71027 batch_time=17.68899 
Train Epoch: 36 [12/250 1536/32000 (5%)] Loss: 7.80590 (QuantReg: 15.60602) QuantErr: 15.60602 batch_time=0.60039 
Train Epoch: 36 [23/250 2944/32000 (9%)] Loss: 6.24234 (QuantReg: 15.75464) QuantErr: 15.75464 batch_time=0.61881 
Train Epoch: 36 [34/250 4352/32000 (14%)] Loss: 6.26676 (QuantReg: 15.70031) QuantErr: 15.70031 batch_time=0.60781 
Train Epoch: 36 [45/250 5760/32000 (18%)] Loss: 6.62312 (QuantReg: 15.79057) QuantErr: 15.79057 batch_time=0.70149 
Train Epoch: 36 [56/250 7168/32000 (22%)] Loss: 6.57235 (QuantReg: 15.54156) QuantErr: 15.54156 batch_time=0.82345 
Train Epoch: 36 [67/250 8576/32000 (27%)] Loss: 7.47135 (QuantReg: 15.81464) QuantErr: 15.81464 batch_time=1.36404 
Train Epoch: 36 [78/250 9984/32000 (31%)] Loss: 7.16496 (QuantReg: 15.57411) QuantErr: 15.57411 batch_time=0.60580 
Train Epoch: 36 [89/250 11392/32000 (36%)] Loss: 6.79537 (QuantReg: 15.75006) QuantErr: 15.75006 batch_time=0.59931 
Train Epoch: 36 [100/250 12800/32000 (40%)] Loss: 6.23531 (QuantReg: 15.68545) QuantErr: 15.68545 batch_time=0.60098 
Train Epoch: 36 [111/250 14208/32000 (44%)] Loss: 4.96541 (QuantReg: 15.71620) QuantErr: 15.71620 batch_time=0.60297 
Train Epoch: 36 [122/250 15616/32000 (49%)] Loss: 7.07538 (QuantReg: 15.55541) QuantErr: 15.55541 batch_time=0.63174 
Train Epoch: 36 [133/250 17024/32000 (53%)] Loss: 6.76568 (QuantReg: 15.92864) QuantErr: 15.92864 batch_time=0.83616 
Train Epoch: 36 [144/250 18432/32000 (58%)] Loss: 5.94185 (QuantReg: 15.59078) QuantErr: 15.59078 batch_time=1.11101 
Train Epoch: 36 [155/250 19840/32000 (62%)] Loss: 6.42202 (QuantReg: 15.78894) QuantErr: 15.78894 batch_time=0.60129 
Train Epoch: 36 [166/250 21248/32000 (66%)] Loss: 5.87870 (QuantReg: 15.65674) QuantErr: 15.65674 batch_time=0.59979 
Train Epoch: 36 [177/250 22656/32000 (71%)] Loss: 6.13085 (QuantReg: 15.64227) QuantErr: 15.64227 batch_time=0.62771 
Train Epoch: 36 [188/250 24064/32000 (75%)] Loss: 5.20127 (QuantReg: 15.84549) QuantErr: 15.84549 batch_time=0.71111 
Train Epoch: 36 [199/250 25472/32000 (80%)] Loss: 6.49163 (QuantReg: 15.53461) QuantErr: 15.53461 batch_time=0.59838 
Train Epoch: 36 [210/250 26880/32000 (84%)] Loss: 7.48162 (QuantReg: 15.75789) QuantErr: 15.75789 batch_time=0.60764 
Train Epoch: 36 [221/250 28288/32000 (88%)] Loss: 7.37667 (QuantReg: 15.76553) QuantErr: 15.76553 batch_time=0.60762 
Train Epoch: 36 [232/250 29696/32000 (93%)] Loss: 6.45682 (QuantReg: 15.89153) QuantErr: 15.89153 batch_time=0.61207 
Train Epoch: 36 [243/250 31104/32000 (97%)] Loss: 6.23623 (QuantReg: 15.94090) QuantErr: 15.94090 batch_time=0.61559 
Train Epoch: 36 codebook_update_time=3.22750
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch36.pth ...
Done in 3.515s
removing stale ckpt [epoch 35] [took 0.02s]
 epoch          : 36
 loss           : 6.33698582649231
 quant_reg      : 15.731440589904786
 quant_err      : 15.731440589904786
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 9000
 LSMDC_full_test/t2v_metrics/R1: 12.5
 LSMDC_full_test/t2v_metrics/R5: 32.2
 LSMDC_full_test/t2v_metrics/R10: 43.1
 LSMDC_full_test/t2v_metrics/R50: 69.8
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 72.332
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.88695993891031
 LSMDC_full_test/v2t_metrics/R1: 13.8
 LSMDC_full_test/v2t_metrics/R5: 31.7
 LSMDC_full_test/v2t_metrics/R10: 41.0
 LSMDC_full_test/v2t_metrics/R50: 68.9
 LSMDC_full_test/v2t_metrics/MedR: 19.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.465
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.176248310986498
 mnt_best       : 26.80506791364838
 not_improved_count: 7
Train Epoch: 37 [1/250 128/32000 (0%)] Loss: 6.85114 (QuantReg: 15.83297) QuantErr: 15.83297 batch_time=17.84656 
Train Epoch: 37 [12/250 1536/32000 (5%)] Loss: 6.75351 (QuantReg: 15.73879) QuantErr: 15.73879 batch_time=0.59903 
Train Epoch: 37 [23/250 2944/32000 (9%)] Loss: 6.25075 (QuantReg: 15.74175) QuantErr: 15.74175 batch_time=0.59472 
Train Epoch: 37 [34/250 4352/32000 (14%)] Loss: 6.06203 (QuantReg: 15.67212) QuantErr: 15.67212 batch_time=0.60517 
Train Epoch: 37 [45/250 5760/32000 (18%)] Loss: 5.75620 (QuantReg: 15.89166) QuantErr: 15.89166 batch_time=0.60149 
Train Epoch: 37 [56/250 7168/32000 (22%)] Loss: 6.32291 (QuantReg: 15.70596) QuantErr: 15.70596 batch_time=0.59225 
Train Epoch: 37 [67/250 8576/32000 (27%)] Loss: 6.16641 (QuantReg: 15.75710) QuantErr: 15.75710 batch_time=0.62273 
Train Epoch: 37 [78/250 9984/32000 (31%)] Loss: 6.65085 (QuantReg: 15.69010) QuantErr: 15.69010 batch_time=0.61335 
Train Epoch: 37 [89/250 11392/32000 (36%)] Loss: 7.01026 (QuantReg: 15.86400) QuantErr: 15.86400 batch_time=0.61955 
Train Epoch: 37 [100/250 12800/32000 (40%)] Loss: 5.51419 (QuantReg: 15.65716) QuantErr: 15.65716 batch_time=0.61515 
Train Epoch: 37 [111/250 14208/32000 (44%)] Loss: 5.45658 (QuantReg: 15.89258) QuantErr: 15.89258 batch_time=0.60575 
Train Epoch: 37 [122/250 15616/32000 (49%)] Loss: 5.44549 (QuantReg: 15.78078) QuantErr: 15.78078 batch_time=0.61327 
Train Epoch: 37 [133/250 17024/32000 (53%)] Loss: 6.34877 (QuantReg: 15.67318) QuantErr: 15.67318 batch_time=0.70324 
Train Epoch: 37 [144/250 18432/32000 (58%)] Loss: 5.93697 (QuantReg: 15.80965) QuantErr: 15.80965 batch_time=1.66582 
Train Epoch: 37 [155/250 19840/32000 (62%)] Loss: 6.78583 (QuantReg: 15.75964) QuantErr: 15.75964 batch_time=0.58818 
Train Epoch: 37 [166/250 21248/32000 (66%)] Loss: 5.95063 (QuantReg: 15.78926) QuantErr: 15.78926 batch_time=0.60226 
Train Epoch: 37 [177/250 22656/32000 (71%)] Loss: 5.87243 (QuantReg: 15.52997) QuantErr: 15.52997 batch_time=0.59657 
Train Epoch: 37 [188/250 24064/32000 (75%)] Loss: 7.14902 (QuantReg: 15.72641) QuantErr: 15.72641 batch_time=0.62314 
Train Epoch: 37 [199/250 25472/32000 (80%)] Loss: 5.68256 (QuantReg: 15.73724) QuantErr: 15.73724 batch_time=0.61570 
Train Epoch: 37 [210/250 26880/32000 (84%)] Loss: 6.10212 (QuantReg: 15.67053) QuantErr: 15.67053 batch_time=1.58216 
Train Epoch: 37 [221/250 28288/32000 (88%)] Loss: 6.55736 (QuantReg: 15.64433) QuantErr: 15.64433 batch_time=0.60550 
Train Epoch: 37 [232/250 29696/32000 (93%)] Loss: 6.25570 (QuantReg: 15.99813) QuantErr: 15.99813 batch_time=0.61200 
Train Epoch: 37 [243/250 31104/32000 (97%)] Loss: 5.91760 (QuantReg: 15.83558) QuantErr: 15.83558 batch_time=0.62193 
Train Epoch: 37 codebook_update_time=3.26362
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch37.pth ...
Done in 11.912s
removing stale ckpt [epoch 36] [took 1.13s]
 epoch          : 37
 loss           : 6.249050397872924
 quant_reg      : 15.77308381652832
 quant_err      : 15.77308381652832
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 9250
 LSMDC_full_test/t2v_metrics/R1: 13.4
 LSMDC_full_test/t2v_metrics/R5: 32.2
 LSMDC_full_test/t2v_metrics/R10: 43.3
 LSMDC_full_test/t2v_metrics/R50: 69.4
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.001
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.534822620097966
 LSMDC_full_test/v2t_metrics/R1: 14.5
 LSMDC_full_test/v2t_metrics/R5: 31.7
 LSMDC_full_test/v2t_metrics/R10: 41.8
 LSMDC_full_test/v2t_metrics/R50: 68.5
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 71.524
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.783532060103038
 mnt_best       : 26.80506791364838
 not_improved_count: 8
Train Epoch: 38 [1/250 128/32000 (0%)] Loss: 7.11022 (QuantReg: 15.88866) QuantErr: 15.88866 batch_time=16.36478 
Train Epoch: 38 [12/250 1536/32000 (5%)] Loss: 5.65556 (QuantReg: 15.66073) QuantErr: 15.66073 batch_time=0.61916 
Train Epoch: 38 [23/250 2944/32000 (9%)] Loss: 6.98911 (QuantReg: 15.82472) QuantErr: 15.82472 batch_time=0.61808 
Train Epoch: 38 [34/250 4352/32000 (14%)] Loss: 6.91457 (QuantReg: 15.70325) QuantErr: 15.70325 batch_time=0.61674 
Train Epoch: 38 [45/250 5760/32000 (18%)] Loss: 6.72742 (QuantReg: 15.71732) QuantErr: 15.71732 batch_time=0.62264 
Train Epoch: 38 [56/250 7168/32000 (22%)] Loss: 6.07318 (QuantReg: 15.77062) QuantErr: 15.77062 batch_time=0.60799 
Train Epoch: 38 [67/250 8576/32000 (27%)] Loss: 6.57161 (QuantReg: 15.86163) QuantErr: 15.86163 batch_time=0.71229 
Train Epoch: 38 [78/250 9984/32000 (31%)] Loss: 6.33094 (QuantReg: 15.78413) QuantErr: 15.78413 batch_time=0.59522 
Train Epoch: 38 [89/250 11392/32000 (36%)] Loss: 6.57317 (QuantReg: 15.61525) QuantErr: 15.61525 batch_time=0.60287 
Train Epoch: 38 [100/250 12800/32000 (40%)] Loss: 6.37952 (QuantReg: 15.99454) QuantErr: 15.99454 batch_time=0.72062 
Train Epoch: 38 [111/250 14208/32000 (44%)] Loss: 6.13362 (QuantReg: 15.84004) QuantErr: 15.84004 batch_time=0.60974 
Train Epoch: 38 [122/250 15616/32000 (49%)] Loss: 6.84759 (QuantReg: 15.69122) QuantErr: 15.69122 batch_time=0.60346 
Train Epoch: 38 [133/250 17024/32000 (53%)] Loss: 5.81650 (QuantReg: 15.77804) QuantErr: 15.77804 batch_time=0.60895 
Train Epoch: 38 [144/250 18432/32000 (58%)] Loss: 6.21338 (QuantReg: 15.78674) QuantErr: 15.78674 batch_time=0.60176 
Train Epoch: 38 [155/250 19840/32000 (62%)] Loss: 6.39301 (QuantReg: 15.72035) QuantErr: 15.72035 batch_time=0.60715 
Train Epoch: 38 [166/250 21248/32000 (66%)] Loss: 5.29722 (QuantReg: 15.54076) QuantErr: 15.54076 batch_time=0.61004 
Train Epoch: 38 [177/250 22656/32000 (71%)] Loss: 6.23256 (QuantReg: 15.84758) QuantErr: 15.84758 batch_time=0.59808 
Train Epoch: 38 [188/250 24064/32000 (75%)] Loss: 5.18834 (QuantReg: 15.78866) QuantErr: 15.78866 batch_time=0.60440 
Train Epoch: 38 [199/250 25472/32000 (80%)] Loss: 6.15530 (QuantReg: 15.79341) QuantErr: 15.79341 batch_time=0.61777 
Train Epoch: 38 [210/250 26880/32000 (84%)] Loss: 5.35464 (QuantReg: 15.82000) QuantErr: 15.82000 batch_time=0.91757 
Train Epoch: 38 [221/250 28288/32000 (88%)] Loss: 5.41710 (QuantReg: 15.69419) QuantErr: 15.69419 batch_time=0.60902 
Train Epoch: 38 [232/250 29696/32000 (93%)] Loss: 6.88581 (QuantReg: 15.56874) QuantErr: 15.56874 batch_time=0.60725 
Train Epoch: 38 [243/250 31104/32000 (97%)] Loss: 6.87739 (QuantReg: 15.59138) QuantErr: 15.59138 batch_time=0.84173 
Train Epoch: 38 codebook_update_time=3.83162
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch38.pth ...
Done in 4.978s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 6.206500144958496
 quant_reg      : 15.738521068572998
 quant_err      : 15.738521068572998
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 9500
 LSMDC_full_test/t2v_metrics/R1: 13.0
 LSMDC_full_test/t2v_metrics/R5: 32.0
 LSMDC_full_test/t2v_metrics/R10: 41.9
 LSMDC_full_test/t2v_metrics/R50: 69.1
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 71.836
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.928005960602576
 LSMDC_full_test/v2t_metrics/R1: 13.9
 LSMDC_full_test/v2t_metrics/R5: 31.6
 LSMDC_full_test/v2t_metrics/R10: 41.8
 LSMDC_full_test/v2t_metrics/R50: 70.1
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 72.621
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.381089150616553
 mnt_best       : 26.80506791364838
 not_improved_count: 9
Train Epoch: 39 [1/250 128/32000 (0%)] Loss: 6.53806 (QuantReg: 15.66231) QuantErr: 15.66231 batch_time=16.68033 
Train Epoch: 39 [12/250 1536/32000 (5%)] Loss: 6.06402 (QuantReg: 15.69594) QuantErr: 15.69594 batch_time=0.60474 
Train Epoch: 39 [23/250 2944/32000 (9%)] Loss: 6.41460 (QuantReg: 15.77605) QuantErr: 15.77605 batch_time=0.60433 
Train Epoch: 39 [34/250 4352/32000 (14%)] Loss: 5.61801 (QuantReg: 15.67415) QuantErr: 15.67415 batch_time=0.61838 
Train Epoch: 39 [45/250 5760/32000 (18%)] Loss: 5.22746 (QuantReg: 15.75930) QuantErr: 15.75930 batch_time=0.60650 
Train Epoch: 39 [56/250 7168/32000 (22%)] Loss: 5.71563 (QuantReg: 15.90199) QuantErr: 15.90199 batch_time=0.91991 
Train Epoch: 39 [67/250 8576/32000 (27%)] Loss: 6.04128 (QuantReg: 15.77029) QuantErr: 15.77029 batch_time=0.60463 
Train Epoch: 39 [78/250 9984/32000 (31%)] Loss: 6.05068 (QuantReg: 15.88469) QuantErr: 15.88469 batch_time=1.32384 
Train Epoch: 39 [89/250 11392/32000 (36%)] Loss: 6.23667 (QuantReg: 15.61325) QuantErr: 15.61325 batch_time=1.67921 
Train Epoch: 39 [100/250 12800/32000 (40%)] Loss: 6.39959 (QuantReg: 15.85632) QuantErr: 15.85632 batch_time=0.60541 
Train Epoch: 39 [111/250 14208/32000 (44%)] Loss: 6.75695 (QuantReg: 15.81900) QuantErr: 15.81900 batch_time=0.60804 
Train Epoch: 39 [122/250 15616/32000 (49%)] Loss: 6.00985 (QuantReg: 15.78571) QuantErr: 15.78571 batch_time=0.60868 
Train Epoch: 39 [133/250 17024/32000 (53%)] Loss: 6.77000 (QuantReg: 15.92302) QuantErr: 15.92302 batch_time=0.71279 
Train Epoch: 39 [144/250 18432/32000 (58%)] Loss: 6.89883 (QuantReg: 15.89090) QuantErr: 15.89090 batch_time=0.59585 
Train Epoch: 39 [155/250 19840/32000 (62%)] Loss: 5.84650 (QuantReg: 15.60821) QuantErr: 15.60821 batch_time=0.60448 
Train Epoch: 39 [166/250 21248/32000 (66%)] Loss: 6.04430 (QuantReg: 15.87159) QuantErr: 15.87159 batch_time=0.60801 
Train Epoch: 39 [177/250 22656/32000 (71%)] Loss: 6.47166 (QuantReg: 15.92107) QuantErr: 15.92107 batch_time=0.91957 
Train Epoch: 39 [188/250 24064/32000 (75%)] Loss: 5.77329 (QuantReg: 15.79498) QuantErr: 15.79498 batch_time=0.60990 
Train Epoch: 39 [199/250 25472/32000 (80%)] Loss: 6.41576 (QuantReg: 15.64413) QuantErr: 15.64413 batch_time=1.35780 
Train Epoch: 39 [210/250 26880/32000 (84%)] Loss: 6.08718 (QuantReg: 15.84559) QuantErr: 15.84559 batch_time=0.60501 
Train Epoch: 39 [221/250 28288/32000 (88%)] Loss: 6.11295 (QuantReg: 15.70052) QuantErr: 15.70052 batch_time=0.67414 
Train Epoch: 39 [232/250 29696/32000 (93%)] Loss: 6.48129 (QuantReg: 15.70299) QuantErr: 15.70299 batch_time=0.68429 
Train Epoch: 39 [243/250 31104/32000 (97%)] Loss: 5.59639 (QuantReg: 15.78252) QuantErr: 15.78252 batch_time=0.67005 
Train Epoch: 39 codebook_update_time=3.29251
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch39.pth ...
Done in 4.590s
removing stale ckpt [epoch 38] [took 0.01s]
 epoch          : 39
 loss           : 6.185971366882324
 quant_reg      : 15.769332695007325
 quant_err      : 15.769332695007325
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 9750
 LSMDC_full_test/t2v_metrics/R1: 12.6
 LSMDC_full_test/t2v_metrics/R5: 31.8
 LSMDC_full_test/t2v_metrics/R10: 41.9
 LSMDC_full_test/t2v_metrics/R50: 69.2
 LSMDC_full_test/t2v_metrics/MedR: 17.5
 LSMDC_full_test/t2v_metrics/MeanR: 73.221
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.605733985766374
 LSMDC_full_test/v2t_metrics/R1: 14.0
 LSMDC_full_test/v2t_metrics/R5: 32.7
 LSMDC_full_test/v2t_metrics/R10: 41.0
 LSMDC_full_test/v2t_metrics/R50: 69.1
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 70.485
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.575812335212657
 mnt_best       : 26.80506791364838
 not_improved_count: 10
Train Epoch: 40 [1/250 128/32000 (0%)] Loss: 6.19369 (QuantReg: 15.76462) QuantErr: 15.76462 batch_time=16.50781 
Train Epoch: 40 [12/250 1536/32000 (5%)] Loss: 6.11149 (QuantReg: 15.83055) QuantErr: 15.83055 batch_time=0.60539 
Train Epoch: 40 [23/250 2944/32000 (9%)] Loss: 5.88461 (QuantReg: 15.87083) QuantErr: 15.87083 batch_time=0.62360 
Train Epoch: 40 [34/250 4352/32000 (14%)] Loss: 6.92610 (QuantReg: 15.76345) QuantErr: 15.76345 batch_time=0.60926 
Train Epoch: 40 [45/250 5760/32000 (18%)] Loss: 5.35828 (QuantReg: 15.91060) QuantErr: 15.91060 batch_time=0.61506 
Train Epoch: 40 [56/250 7168/32000 (22%)] Loss: 6.02105 (QuantReg: 15.70801) QuantErr: 15.70801 batch_time=0.61521 
Train Epoch: 40 [67/250 8576/32000 (27%)] Loss: 6.10813 (QuantReg: 15.86759) QuantErr: 15.86759 batch_time=0.60075 
Train Epoch: 40 [78/250 9984/32000 (31%)] Loss: 6.00722 (QuantReg: 15.59711) QuantErr: 15.59711 batch_time=0.61534 
Train Epoch: 40 [89/250 11392/32000 (36%)] Loss: 5.81462 (QuantReg: 15.74280) QuantErr: 15.74280 batch_time=0.60909 
Train Epoch: 40 [100/250 12800/32000 (40%)] Loss: 7.49967 (QuantReg: 15.80108) QuantErr: 15.80108 batch_time=0.61035 
Train Epoch: 40 [111/250 14208/32000 (44%)] Loss: 6.14106 (QuantReg: 15.73366) QuantErr: 15.73366 batch_time=0.62292 
Train Epoch: 40 [122/250 15616/32000 (49%)] Loss: 6.36453 (QuantReg: 15.62029) QuantErr: 15.62029 batch_time=0.60279 
Train Epoch: 40 [133/250 17024/32000 (53%)] Loss: 6.56078 (QuantReg: 15.82119) QuantErr: 15.82119 batch_time=0.60593 
Train Epoch: 40 [144/250 18432/32000 (58%)] Loss: 5.86929 (QuantReg: 15.65182) QuantErr: 15.65182 batch_time=1.17618 
Train Epoch: 40 [155/250 19840/32000 (62%)] Loss: 6.84267 (QuantReg: 15.70181) QuantErr: 15.70181 batch_time=0.61129 
Train Epoch: 40 [166/250 21248/32000 (66%)] Loss: 6.85584 (QuantReg: 15.86246) QuantErr: 15.86246 batch_time=0.60706 
Train Epoch: 40 [177/250 22656/32000 (71%)] Loss: 6.96103 (QuantReg: 15.69442) QuantErr: 15.69442 batch_time=0.62912 
Train Epoch: 40 [188/250 24064/32000 (75%)] Loss: 7.28052 (QuantReg: 15.91793) QuantErr: 15.91793 batch_time=0.60979 
Train Epoch: 40 [199/250 25472/32000 (80%)] Loss: 5.91687 (QuantReg: 15.82816) QuantErr: 15.82816 batch_time=0.62101 
Train Epoch: 40 [210/250 26880/32000 (84%)] Loss: 4.96012 (QuantReg: 15.71232) QuantErr: 15.71232 batch_time=0.61702 
Train Epoch: 40 [221/250 28288/32000 (88%)] Loss: 5.87362 (QuantReg: 15.64196) QuantErr: 15.64196 batch_time=0.61287 
Train Epoch: 40 [232/250 29696/32000 (93%)] Loss: 6.18785 (QuantReg: 15.70013) QuantErr: 15.70013 batch_time=0.61274 
Train Epoch: 40 [243/250 31104/32000 (97%)] Loss: 5.65516 (QuantReg: 15.80532) QuantErr: 15.80532 batch_time=0.60655 
Train Epoch: 40 codebook_update_time=3.57851
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch40.pth ...
Done in 4.376s
removing stale ckpt [epoch 39] [took 0.00s]
 epoch          : 40
 loss           : 6.199547077178955
 quant_reg      : 15.760670574188232
 quant_err      : 15.760670574188232
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 10000
 LSMDC_full_test/t2v_metrics/R1: 13.6
 LSMDC_full_test/t2v_metrics/R5: 31.8
 LSMDC_full_test/t2v_metrics/R10: 42.1
 LSMDC_full_test/t2v_metrics/R50: 69.7
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.685
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.30768954023957
 LSMDC_full_test/v2t_metrics/R1: 13.7
 LSMDC_full_test/v2t_metrics/R5: 31.5
 LSMDC_full_test/v2t_metrics/R10: 41.1
 LSMDC_full_test/v2t_metrics/R50: 68.7
 LSMDC_full_test/v2t_metrics/MedR: 17.0
 LSMDC_full_test/v2t_metrics/MeanR: 72.226
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.07900279803992
 mnt_best       : 26.80506791364838
 not_improved_count: 11
Train Epoch: 41 [1/250 128/32000 (0%)] Loss: 5.49842 (QuantReg: 15.51390) QuantErr: 15.51390 batch_time=18.10980 
Train Epoch: 41 [12/250 1536/32000 (5%)] Loss: 6.55808 (QuantReg: 15.93966) QuantErr: 15.93966 batch_time=0.61985 
Train Epoch: 41 [23/250 2944/32000 (9%)] Loss: 5.99160 (QuantReg: 15.81639) QuantErr: 15.81639 batch_time=0.61786 
Train Epoch: 41 [34/250 4352/32000 (14%)] Loss: 5.41899 (QuantReg: 15.80134) QuantErr: 15.80134 batch_time=0.68341 
Train Epoch: 41 [45/250 5760/32000 (18%)] Loss: 5.24737 (QuantReg: 15.76514) QuantErr: 15.76514 batch_time=0.60307 
Train Epoch: 41 [56/250 7168/32000 (22%)] Loss: 6.85597 (QuantReg: 15.78283) QuantErr: 15.78283 batch_time=0.60541 
Train Epoch: 41 [67/250 8576/32000 (27%)] Loss: 6.43127 (QuantReg: 15.77665) QuantErr: 15.77665 batch_time=1.13350 
Train Epoch: 41 [78/250 9984/32000 (31%)] Loss: 5.86541 (QuantReg: 15.98003) QuantErr: 15.98003 batch_time=0.72255 
Train Epoch: 41 [89/250 11392/32000 (36%)] Loss: 6.55662 (QuantReg: 15.69390) QuantErr: 15.69390 batch_time=0.60628 
Train Epoch: 41 [100/250 12800/32000 (40%)] Loss: 5.82284 (QuantReg: 15.70072) QuantErr: 15.70072 batch_time=0.60440 
Train Epoch: 41 [111/250 14208/32000 (44%)] Loss: 6.36998 (QuantReg: 15.67679) QuantErr: 15.67679 batch_time=0.60614 
Train Epoch: 41 [122/250 15616/32000 (49%)] Loss: 5.54678 (QuantReg: 15.84744) QuantErr: 15.84744 batch_time=0.61384 
Train Epoch: 41 [133/250 17024/32000 (53%)] Loss: 5.73274 (QuantReg: 15.79699) QuantErr: 15.79699 batch_time=0.60249 
Train Epoch: 41 [144/250 18432/32000 (58%)] Loss: 6.77988 (QuantReg: 15.76969) QuantErr: 15.76969 batch_time=1.93293 
Train Epoch: 41 [155/250 19840/32000 (62%)] Loss: 5.56974 (QuantReg: 15.69555) QuantErr: 15.69555 batch_time=0.61504 
Train Epoch: 41 [166/250 21248/32000 (66%)] Loss: 6.61515 (QuantReg: 15.91081) QuantErr: 15.91081 batch_time=0.61446 
Train Epoch: 41 [177/250 22656/32000 (71%)] Loss: 6.16133 (QuantReg: 15.80211) QuantErr: 15.80211 batch_time=0.61501 
Train Epoch: 41 [188/250 24064/32000 (75%)] Loss: 5.97062 (QuantReg: 15.92838) QuantErr: 15.92838 batch_time=0.61366 
Train Epoch: 41 [199/250 25472/32000 (80%)] Loss: 6.10009 (QuantReg: 15.79880) QuantErr: 15.79880 batch_time=0.61360 
Train Epoch: 41 [210/250 26880/32000 (84%)] Loss: 5.13509 (QuantReg: 15.77574) QuantErr: 15.77574 batch_time=0.61378 
Train Epoch: 41 [221/250 28288/32000 (88%)] Loss: 5.79005 (QuantReg: 15.94459) QuantErr: 15.94459 batch_time=0.61691 
Train Epoch: 41 [232/250 29696/32000 (93%)] Loss: 5.70801 (QuantReg: 15.89002) QuantErr: 15.89002 batch_time=0.60571 
Train Epoch: 41 [243/250 31104/32000 (97%)] Loss: 6.01195 (QuantReg: 15.78958) QuantErr: 15.78958 batch_time=1.46868 
Train Epoch: 41 codebook_update_time=3.24568
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch41.pth ...
Done in 3.865s
removing stale ckpt [epoch 40] [took 2.22s]
 epoch          : 41
 loss           : 6.140703069686889
 quant_reg      : 15.794607292175293
 quant_err      : 15.794607292175293
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 10250
 LSMDC_full_test/t2v_metrics/R1: 13.3
 LSMDC_full_test/t2v_metrics/R5: 32.1
 LSMDC_full_test/t2v_metrics/R10: 41.7
 LSMDC_full_test/t2v_metrics/R50: 68.7
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 74.413
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.111445193988516
 LSMDC_full_test/v2t_metrics/R1: 13.4
 LSMDC_full_test/v2t_metrics/R5: 31.9
 LSMDC_full_test/v2t_metrics/R10: 41.7
 LSMDC_full_test/v2t_metrics/R50: 68.8
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 72.771
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.122245827343967
 mnt_best       : 26.80506791364838
 not_improved_count: 12
Train Epoch: 42 [1/250 128/32000 (0%)] Loss: 6.57469 (QuantReg: 15.73943) QuantErr: 15.73943 batch_time=20.33746 
Train Epoch: 42 [12/250 1536/32000 (5%)] Loss: 5.15420 (QuantReg: 15.79893) QuantErr: 15.79893 batch_time=0.61391 
Train Epoch: 42 [23/250 2944/32000 (9%)] Loss: 5.44915 (QuantReg: 15.86966) QuantErr: 15.86966 batch_time=0.60287 
Train Epoch: 42 [34/250 4352/32000 (14%)] Loss: 5.01889 (QuantReg: 15.92439) QuantErr: 15.92439 batch_time=0.61302 
Train Epoch: 42 [45/250 5760/32000 (18%)] Loss: 5.92520 (QuantReg: 15.82951) QuantErr: 15.82951 batch_time=0.60151 
Train Epoch: 42 [56/250 7168/32000 (22%)] Loss: 5.73938 (QuantReg: 15.84830) QuantErr: 15.84830 batch_time=0.60808 
Train Epoch: 42 [67/250 8576/32000 (27%)] Loss: 6.70402 (QuantReg: 15.66678) QuantErr: 15.66678 batch_time=0.60378 
Train Epoch: 42 [78/250 9984/32000 (31%)] Loss: 6.12572 (QuantReg: 15.73791) QuantErr: 15.73791 batch_time=0.61696 
Train Epoch: 42 [89/250 11392/32000 (36%)] Loss: 6.48502 (QuantReg: 15.76453) QuantErr: 15.76453 batch_time=0.61151 
Train Epoch: 42 [100/250 12800/32000 (40%)] Loss: 6.81417 (QuantReg: 15.71220) QuantErr: 15.71220 batch_time=0.72925 
Train Epoch: 42 [111/250 14208/32000 (44%)] Loss: 6.56443 (QuantReg: 15.63425) QuantErr: 15.63425 batch_time=0.61567 
Train Epoch: 42 [122/250 15616/32000 (49%)] Loss: 5.41687 (QuantReg: 15.69884) QuantErr: 15.69884 batch_time=0.60971 
Train Epoch: 42 [133/250 17024/32000 (53%)] Loss: 5.51366 (QuantReg: 15.83726) QuantErr: 15.83726 batch_time=0.61210 
Train Epoch: 42 [144/250 18432/32000 (58%)] Loss: 5.66832 (QuantReg: 15.98730) QuantErr: 15.98730 batch_time=1.59802 
Train Epoch: 42 [155/250 19840/32000 (62%)] Loss: 4.90942 (QuantReg: 15.70874) QuantErr: 15.70874 batch_time=0.67888 
Train Epoch: 42 [166/250 21248/32000 (66%)] Loss: 6.26154 (QuantReg: 15.62874) QuantErr: 15.62874 batch_time=0.67582 
Train Epoch: 42 [177/250 22656/32000 (71%)] Loss: 5.95142 (QuantReg: 15.75855) QuantErr: 15.75855 batch_time=0.60659 
Train Epoch: 42 [188/250 24064/32000 (75%)] Loss: 5.81309 (QuantReg: 15.59557) QuantErr: 15.59557 batch_time=0.60381 
Train Epoch: 42 [199/250 25472/32000 (80%)] Loss: 6.05034 (QuantReg: 15.85517) QuantErr: 15.85517 batch_time=0.90299 
Train Epoch: 42 [210/250 26880/32000 (84%)] Loss: 5.39390 (QuantReg: 15.68604) QuantErr: 15.68604 batch_time=0.60521 
Train Epoch: 42 [221/250 28288/32000 (88%)] Loss: 6.26153 (QuantReg: 15.86500) QuantErr: 15.86500 batch_time=0.60618 
Train Epoch: 42 [232/250 29696/32000 (93%)] Loss: 6.06466 (QuantReg: 15.67243) QuantErr: 15.67243 batch_time=0.61757 
Train Epoch: 42 [243/250 31104/32000 (97%)] Loss: 7.01213 (QuantReg: 15.64002) QuantErr: 15.64002 batch_time=0.61668 
Train Epoch: 42 codebook_update_time=3.22528
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch42.pth ...
Done in 4.287s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 6.112715539932251
 quant_reg      : 15.80489764022827
 quant_err      : 15.80489764022827
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 10500
 LSMDC_full_test/t2v_metrics/R1: 12.4
 LSMDC_full_test/t2v_metrics/R5: 31.4
 LSMDC_full_test/t2v_metrics/R10: 42.3
 LSMDC_full_test/t2v_metrics/R50: 69.0
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 74.312
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.44274119032359
 LSMDC_full_test/v2t_metrics/R1: 14.3
 LSMDC_full_test/v2t_metrics/R5: 31.3
 LSMDC_full_test/v2t_metrics/R10: 41.1
 LSMDC_full_test/v2t_metrics/R50: 68.5
 LSMDC_full_test/v2t_metrics/MedR: 18.5
 LSMDC_full_test/v2t_metrics/MeanR: 73.233
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.398184849948443
 mnt_best       : 26.80506791364838
 not_improved_count: 13
Train Epoch: 43 [1/250 128/32000 (0%)] Loss: 6.68090 (QuantReg: 15.92905) QuantErr: 15.92905 batch_time=19.05333 
Train Epoch: 43 [12/250 1536/32000 (5%)] Loss: 6.63773 (QuantReg: 15.84738) QuantErr: 15.84738 batch_time=0.60463 
Train Epoch: 43 [23/250 2944/32000 (9%)] Loss: 5.80088 (QuantReg: 15.81186) QuantErr: 15.81186 batch_time=0.71619 
Train Epoch: 43 [34/250 4352/32000 (14%)] Loss: 5.53862 (QuantReg: 15.65107) QuantErr: 15.65107 batch_time=0.61127 
Train Epoch: 43 [45/250 5760/32000 (18%)] Loss: 5.56033 (QuantReg: 15.77088) QuantErr: 15.77088 batch_time=0.60780 
Train Epoch: 43 [56/250 7168/32000 (22%)] Loss: 5.74873 (QuantReg: 15.70574) QuantErr: 15.70574 batch_time=0.72601 
Train Epoch: 43 [67/250 8576/32000 (27%)] Loss: 6.30561 (QuantReg: 15.69930) QuantErr: 15.69930 batch_time=0.62711 
Train Epoch: 43 [78/250 9984/32000 (31%)] Loss: 6.02832 (QuantReg: 15.86662) QuantErr: 15.86662 batch_time=0.60882 
Train Epoch: 43 [89/250 11392/32000 (36%)] Loss: 5.99281 (QuantReg: 15.87280) QuantErr: 15.87280 batch_time=0.61691 
Train Epoch: 43 [100/250 12800/32000 (40%)] Loss: 6.35983 (QuantReg: 15.60778) QuantErr: 15.60778 batch_time=0.61282 
Train Epoch: 43 [111/250 14208/32000 (44%)] Loss: 5.77269 (QuantReg: 15.63657) QuantErr: 15.63657 batch_time=0.62020 
Train Epoch: 43 [122/250 15616/32000 (49%)] Loss: 6.60430 (QuantReg: 15.80890) QuantErr: 15.80890 batch_time=0.61369 
Train Epoch: 43 [133/250 17024/32000 (53%)] Loss: 5.63350 (QuantReg: 15.80450) QuantErr: 15.80450 batch_time=0.61402 
Train Epoch: 43 [144/250 18432/32000 (58%)] Loss: 6.22472 (QuantReg: 15.74893) QuantErr: 15.74893 batch_time=0.61040 
Train Epoch: 43 [155/250 19840/32000 (62%)] Loss: 6.24657 (QuantReg: 15.66614) QuantErr: 15.66614 batch_time=0.61808 
Train Epoch: 43 [166/250 21248/32000 (66%)] Loss: 5.87344 (QuantReg: 15.82425) QuantErr: 15.82425 batch_time=0.61108 
Train Epoch: 43 [177/250 22656/32000 (71%)] Loss: 6.28311 (QuantReg: 15.70576) QuantErr: 15.70576 batch_time=0.61269 
Train Epoch: 43 [188/250 24064/32000 (75%)] Loss: 6.65920 (QuantReg: 15.96115) QuantErr: 15.96115 batch_time=0.61391 
Train Epoch: 43 [199/250 25472/32000 (80%)] Loss: 5.61833 (QuantReg: 15.55409) QuantErr: 15.55409 batch_time=0.62341 
Train Epoch: 43 [210/250 26880/32000 (84%)] Loss: 5.31002 (QuantReg: 15.93638) QuantErr: 15.93638 batch_time=0.71540 
Train Epoch: 43 [221/250 28288/32000 (88%)] Loss: 5.96604 (QuantReg: 15.95655) QuantErr: 15.95655 batch_time=0.61419 
Train Epoch: 43 [232/250 29696/32000 (93%)] Loss: 5.72475 (QuantReg: 15.91868) QuantErr: 15.91868 batch_time=0.61683 
Train Epoch: 43 [243/250 31104/32000 (97%)] Loss: 4.93529 (QuantReg: 15.83504) QuantErr: 15.83504 batch_time=0.61274 
Train Epoch: 43 codebook_update_time=3.53586
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch43.pth ...
Done in 4.751s
removing stale ckpt [epoch 42] [took 0.01s]
 epoch          : 43
 loss           : 6.006252828598022
 quant_reg      : 15.801785930633544
 quant_err      : 15.801785930633544
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 10750
 LSMDC_full_test/t2v_metrics/R1: 12.7
 LSMDC_full_test/t2v_metrics/R5: 31.2
 LSMDC_full_test/t2v_metrics/R10: 41.4
 LSMDC_full_test/t2v_metrics/R50: 69.5
 LSMDC_full_test/t2v_metrics/MedR: 16.5
 LSMDC_full_test/t2v_metrics/MeanR: 75.651
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.408920751084665
 LSMDC_full_test/v2t_metrics/R1: 13.7
 LSMDC_full_test/v2t_metrics/R5: 32.0
 LSMDC_full_test/v2t_metrics/R10: 42.0
 LSMDC_full_test/v2t_metrics/R50: 68.4
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.823
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 26.40624278444769
 mnt_best       : 26.80506791364838
 not_improved_count: 14
Train Epoch: 44 [1/250 128/32000 (0%)] Loss: 6.04651 (QuantReg: 15.81030) QuantErr: 15.81030 batch_time=20.48393 
Train Epoch: 44 [12/250 1536/32000 (5%)] Loss: 5.73633 (QuantReg: 15.87669) QuantErr: 15.87669 batch_time=0.61461 
Train Epoch: 44 [23/250 2944/32000 (9%)] Loss: 5.80775 (QuantReg: 15.72730) QuantErr: 15.72730 batch_time=0.61487 
Train Epoch: 44 [34/250 4352/32000 (14%)] Loss: 6.74319 (QuantReg: 15.70010) QuantErr: 15.70010 batch_time=0.61505 
Train Epoch: 44 [45/250 5760/32000 (18%)] Loss: 6.89515 (QuantReg: 15.61006) QuantErr: 15.61006 batch_time=0.61198 
Train Epoch: 44 [56/250 7168/32000 (22%)] Loss: 5.52266 (QuantReg: 15.71374) QuantErr: 15.71374 batch_time=0.60832 
Train Epoch: 44 [67/250 8576/32000 (27%)] Loss: 5.77069 (QuantReg: 15.68971) QuantErr: 15.68971 batch_time=0.81964 
Train Epoch: 44 [78/250 9984/32000 (31%)] Loss: 6.31865 (QuantReg: 15.57565) QuantErr: 15.57565 batch_time=0.61300 
Train Epoch: 44 [89/250 11392/32000 (36%)] Loss: 6.60103 (QuantReg: 15.55483) QuantErr: 15.55483 batch_time=0.61511 
Train Epoch: 44 [100/250 12800/32000 (40%)] Loss: 4.84464 (QuantReg: 15.75988) QuantErr: 15.75988 batch_time=0.61350 
Train Epoch: 44 [111/250 14208/32000 (44%)] Loss: 6.59446 (QuantReg: 15.86454) QuantErr: 15.86454 batch_time=1.31562 
Train Epoch: 44 [122/250 15616/32000 (49%)] Loss: 6.46816 (QuantReg: 15.90215) QuantErr: 15.90215 batch_time=0.61421 
Train Epoch: 44 [133/250 17024/32000 (53%)] Loss: 6.16156 (QuantReg: 15.71731) QuantErr: 15.71731 batch_time=0.61760 
Train Epoch: 44 [144/250 18432/32000 (58%)] Loss: 5.65993 (QuantReg: 15.75709) QuantErr: 15.75709 batch_time=2.19008 
Train Epoch: 44 [155/250 19840/32000 (62%)] Loss: 6.13962 (QuantReg: 15.92418) QuantErr: 15.92418 batch_time=0.61488 
Train Epoch: 44 [166/250 21248/32000 (66%)] Loss: 5.57838 (QuantReg: 15.97593) QuantErr: 15.97593 batch_time=0.62136 
Train Epoch: 44 [177/250 22656/32000 (71%)] Loss: 5.47087 (QuantReg: 15.87664) QuantErr: 15.87664 batch_time=0.61903 
Train Epoch: 44 [188/250 24064/32000 (75%)] Loss: 6.82074 (QuantReg: 15.66823) QuantErr: 15.66823 batch_time=0.61371 
Train Epoch: 44 [199/250 25472/32000 (80%)] Loss: 5.24805 (QuantReg: 15.85968) QuantErr: 15.85968 batch_time=0.62189 
Train Epoch: 44 [210/250 26880/32000 (84%)] Loss: 6.17138 (QuantReg: 15.70383) QuantErr: 15.70383 batch_time=1.64447 
Train Epoch: 44 [221/250 28288/32000 (88%)] Loss: 5.42772 (QuantReg: 15.89234) QuantErr: 15.89234 batch_time=0.62418 
Train Epoch: 44 [232/250 29696/32000 (93%)] Loss: 6.75736 (QuantReg: 15.80909) QuantErr: 15.80909 batch_time=0.62553 
Train Epoch: 44 [243/250 31104/32000 (97%)] Loss: 4.82132 (QuantReg: 15.75457) QuantErr: 15.75457 batch_time=0.61508 
Train Epoch: 44 codebook_update_time=3.33194
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch44.pth ...
Done in 4.259s
removing stale ckpt [epoch 43] [took 0.04s]
 epoch          : 44
 loss           : 6.050948448181153
 quant_reg      : 15.781976291656495
 quant_err      : 15.781976291656495
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 11000
 LSMDC_full_test/t2v_metrics/R1: 13.3
 LSMDC_full_test/t2v_metrics/R5: 31.1
 LSMDC_full_test/t2v_metrics/R10: 43.1
 LSMDC_full_test/t2v_metrics/R50: 69.4
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.322
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.123403991234056
 LSMDC_full_test/v2t_metrics/R1: 13.1
 LSMDC_full_test/v2t_metrics/R5: 31.5
 LSMDC_full_test/v2t_metrics/R10: 41.4
 LSMDC_full_test/v2t_metrics/R50: 68.1
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 75.259
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.75495113265801
 mnt_best       : 26.80506791364838
 not_improved_count: 15
Train Epoch: 45 [1/250 128/32000 (0%)] Loss: 5.65038 (QuantReg: 15.56827) QuantErr: 15.56827 batch_time=18.87886 
Train Epoch: 45 [12/250 1536/32000 (5%)] Loss: 5.85203 (QuantReg: 15.78806) QuantErr: 15.78806 batch_time=0.59194 
Train Epoch: 45 [23/250 2944/32000 (9%)] Loss: 5.21232 (QuantReg: 15.89218) QuantErr: 15.89218 batch_time=0.59472 
Train Epoch: 45 [34/250 4352/32000 (14%)] Loss: 5.57422 (QuantReg: 15.78927) QuantErr: 15.78927 batch_time=0.59564 
Train Epoch: 45 [45/250 5760/32000 (18%)] Loss: 6.22264 (QuantReg: 15.81876) QuantErr: 15.81876 batch_time=0.58687 
Train Epoch: 45 [56/250 7168/32000 (22%)] Loss: 6.73230 (QuantReg: 15.89152) QuantErr: 15.89152 batch_time=0.59149 
Train Epoch: 45 [67/250 8576/32000 (27%)] Loss: 5.57158 (QuantReg: 15.84813) QuantErr: 15.84813 batch_time=2.00686 
Train Epoch: 45 [78/250 9984/32000 (31%)] Loss: 6.04898 (QuantReg: 15.93151) QuantErr: 15.93151 batch_time=0.58586 
Train Epoch: 45 [89/250 11392/32000 (36%)] Loss: 6.21820 (QuantReg: 15.66718) QuantErr: 15.66718 batch_time=0.60080 
Train Epoch: 45 [100/250 12800/32000 (40%)] Loss: 6.12644 (QuantReg: 15.70140) QuantErr: 15.70140 batch_time=0.61798 
Train Epoch: 45 [111/250 14208/32000 (44%)] Loss: 5.99144 (QuantReg: 15.66953) QuantErr: 15.66953 batch_time=0.59320 
Train Epoch: 45 [122/250 15616/32000 (49%)] Loss: 6.36806 (QuantReg: 15.88496) QuantErr: 15.88496 batch_time=0.61922 
Train Epoch: 45 [133/250 17024/32000 (53%)] Loss: 6.42290 (QuantReg: 15.69558) QuantErr: 15.69558 batch_time=0.62308 
Train Epoch: 45 [144/250 18432/32000 (58%)] Loss: 5.25004 (QuantReg: 15.74063) QuantErr: 15.74063 batch_time=1.58584 
Train Epoch: 45 [155/250 19840/32000 (62%)] Loss: 6.03739 (QuantReg: 15.84385) QuantErr: 15.84385 batch_time=0.60446 
Train Epoch: 45 [166/250 21248/32000 (66%)] Loss: 6.29048 (QuantReg: 15.88595) QuantErr: 15.88595 batch_time=0.59779 
Train Epoch: 45 [177/250 22656/32000 (71%)] Loss: 6.89082 (QuantReg: 15.73292) QuantErr: 15.73292 batch_time=0.58691 
Train Epoch: 45 [188/250 24064/32000 (75%)] Loss: 6.34877 (QuantReg: 15.78409) QuantErr: 15.78409 batch_time=0.61497 
Train Epoch: 45 [199/250 25472/32000 (80%)] Loss: 6.50691 (QuantReg: 15.61881) QuantErr: 15.61881 batch_time=0.60056 
Train Epoch: 45 [210/250 26880/32000 (84%)] Loss: 5.82914 (QuantReg: 15.85324) QuantErr: 15.85324 batch_time=0.83540 
Train Epoch: 45 [221/250 28288/32000 (88%)] Loss: 6.12086 (QuantReg: 15.84797) QuantErr: 15.84797 batch_time=0.62133 
Train Epoch: 45 [232/250 29696/32000 (93%)] Loss: 5.89831 (QuantReg: 15.72968) QuantErr: 15.72968 batch_time=0.62337 
Train Epoch: 45 [243/250 31104/32000 (97%)] Loss: 5.76821 (QuantReg: 15.76196) QuantErr: 15.76196 batch_time=0.62146 
Train Epoch: 45 codebook_update_time=3.51108
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch45.pth ...
Done in 4.200s
removing stale ckpt [epoch 44] [took 0.00s]
 epoch          : 45
 loss           : 5.976296224594116
 quant_reg      : 15.772970783233642
 quant_err      : 15.772970783233642
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 11250
 LSMDC_full_test/t2v_metrics/R1: 13.2
 LSMDC_full_test/t2v_metrics/R5: 32.7
 LSMDC_full_test/t2v_metrics/R10: 42.0
 LSMDC_full_test/t2v_metrics/R50: 68.9
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.418
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.269813612266496
 LSMDC_full_test/v2t_metrics/R1: 13.4
 LSMDC_full_test/v2t_metrics/R5: 32.1
 LSMDC_full_test/v2t_metrics/R10: 40.8
 LSMDC_full_test/v2t_metrics/R50: 69.0
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.506
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.987031007391174
 mnt_best       : 26.80506791364838
 not_improved_count: 16
Train Epoch: 46 [1/250 128/32000 (0%)] Loss: 5.78636 (QuantReg: 15.72645) QuantErr: 15.72645 batch_time=15.89958 
Train Epoch: 46 [12/250 1536/32000 (5%)] Loss: 5.96626 (QuantReg: 15.72931) QuantErr: 15.72931 batch_time=0.61398 
Train Epoch: 46 [23/250 2944/32000 (9%)] Loss: 6.24672 (QuantReg: 15.79274) QuantErr: 15.79274 batch_time=0.60437 
Train Epoch: 46 [34/250 4352/32000 (14%)] Loss: 6.57076 (QuantReg: 15.79832) QuantErr: 15.79832 batch_time=0.60738 
Train Epoch: 46 [45/250 5760/32000 (18%)] Loss: 5.81749 (QuantReg: 15.70248) QuantErr: 15.70248 batch_time=0.94112 
Train Epoch: 46 [56/250 7168/32000 (22%)] Loss: 6.26498 (QuantReg: 15.77415) QuantErr: 15.77415 batch_time=0.61552 
Train Epoch: 46 [67/250 8576/32000 (27%)] Loss: 6.13512 (QuantReg: 15.86422) QuantErr: 15.86422 batch_time=0.60810 
Train Epoch: 46 [78/250 9984/32000 (31%)] Loss: 5.71962 (QuantReg: 15.90363) QuantErr: 15.90363 batch_time=0.61133 
Train Epoch: 46 [89/250 11392/32000 (36%)] Loss: 6.66792 (QuantReg: 15.78716) QuantErr: 15.78716 batch_time=0.71376 
Train Epoch: 46 [100/250 12800/32000 (40%)] Loss: 5.42775 (QuantReg: 15.76292) QuantErr: 15.76292 batch_time=0.60851 
Train Epoch: 46 [111/250 14208/32000 (44%)] Loss: 5.58183 (QuantReg: 15.86299) QuantErr: 15.86299 batch_time=0.74007 
Train Epoch: 46 [122/250 15616/32000 (49%)] Loss: 6.06152 (QuantReg: 15.80489) QuantErr: 15.80489 batch_time=0.62766 
Train Epoch: 46 [133/250 17024/32000 (53%)] Loss: 5.19925 (QuantReg: 15.76316) QuantErr: 15.76316 batch_time=0.81773 
Train Epoch: 46 [144/250 18432/32000 (58%)] Loss: 5.69732 (QuantReg: 15.70698) QuantErr: 15.70698 batch_time=0.60750 
Train Epoch: 46 [155/250 19840/32000 (62%)] Loss: 6.45269 (QuantReg: 15.85786) QuantErr: 15.85786 batch_time=0.60603 
Train Epoch: 46 [166/250 21248/32000 (66%)] Loss: 5.74605 (QuantReg: 15.78769) QuantErr: 15.78769 batch_time=0.63218 
Train Epoch: 46 [177/250 22656/32000 (71%)] Loss: 5.35999 (QuantReg: 15.80834) QuantErr: 15.80834 batch_time=0.72100 
Train Epoch: 46 [188/250 24064/32000 (75%)] Loss: 5.14930 (QuantReg: 15.81492) QuantErr: 15.81492 batch_time=0.72651 
Train Epoch: 46 [199/250 25472/32000 (80%)] Loss: 5.71549 (QuantReg: 15.90967) QuantErr: 15.90967 batch_time=0.61753 
Train Epoch: 46 [210/250 26880/32000 (84%)] Loss: 4.94287 (QuantReg: 15.91846) QuantErr: 15.91846 batch_time=0.84430 
Train Epoch: 46 [221/250 28288/32000 (88%)] Loss: 6.40129 (QuantReg: 15.77867) QuantErr: 15.77867 batch_time=0.60629 
Train Epoch: 46 [232/250 29696/32000 (93%)] Loss: 5.16380 (QuantReg: 15.67429) QuantErr: 15.67429 batch_time=0.60564 
Train Epoch: 46 [243/250 31104/32000 (97%)] Loss: 6.74274 (QuantReg: 15.75561) QuantErr: 15.75561 batch_time=0.71539 
Train Epoch: 46 codebook_update_time=3.23092
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch46.pth ...
Done in 4.668s
removing stale ckpt [epoch 45] [took 0.01s]
 epoch          : 46
 loss           : 5.947514614105224
 quant_reg      : 15.795746234893798
 quant_err      : 15.795746234893798
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 11500
 LSMDC_full_test/t2v_metrics/R1: 13.2
 LSMDC_full_test/t2v_metrics/R5: 32.0
 LSMDC_full_test/t2v_metrics/R10: 42.9
 LSMDC_full_test/t2v_metrics/R50: 69.8
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 73.812
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.265987539737527
 LSMDC_full_test/v2t_metrics/R1: 12.8
 LSMDC_full_test/v2t_metrics/R5: 31.8
 LSMDC_full_test/v2t_metrics/R10: 40.6
 LSMDC_full_test/v2t_metrics/R50: 68.2
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.16
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.47149139999442
 mnt_best       : 26.80506791364838
 not_improved_count: 17
Train Epoch: 47 [1/250 128/32000 (0%)] Loss: 5.96400 (QuantReg: 15.71708) QuantErr: 15.71708 batch_time=20.74855 
Train Epoch: 47 [12/250 1536/32000 (5%)] Loss: 5.87064 (QuantReg: 15.84049) QuantErr: 15.84049 batch_time=0.62290 
Train Epoch: 47 [23/250 2944/32000 (9%)] Loss: 5.63647 (QuantReg: 15.88317) QuantErr: 15.88317 batch_time=0.61217 
Train Epoch: 47 [34/250 4352/32000 (14%)] Loss: 6.67365 (QuantReg: 15.83293) QuantErr: 15.83293 batch_time=0.60891 
Train Epoch: 47 [45/250 5760/32000 (18%)] Loss: 5.96213 (QuantReg: 15.78281) QuantErr: 15.78281 batch_time=0.91266 
Train Epoch: 47 [56/250 7168/32000 (22%)] Loss: 5.54167 (QuantReg: 15.69465) QuantErr: 15.69465 batch_time=0.62978 
Train Epoch: 47 [67/250 8576/32000 (27%)] Loss: 5.36824 (QuantReg: 16.05314) QuantErr: 16.05314 batch_time=0.61005 
Train Epoch: 47 [78/250 9984/32000 (31%)] Loss: 6.62855 (QuantReg: 15.66693) QuantErr: 15.66693 batch_time=0.61711 
Train Epoch: 47 [89/250 11392/32000 (36%)] Loss: 4.95015 (QuantReg: 16.04025) QuantErr: 16.04025 batch_time=0.61712 
Train Epoch: 47 [100/250 12800/32000 (40%)] Loss: 5.46847 (QuantReg: 15.85396) QuantErr: 15.85396 batch_time=0.60590 
Train Epoch: 47 [111/250 14208/32000 (44%)] Loss: 6.17764 (QuantReg: 15.65844) QuantErr: 15.65844 batch_time=0.62112 
Train Epoch: 47 [122/250 15616/32000 (49%)] Loss: 6.77563 (QuantReg: 15.84061) QuantErr: 15.84061 batch_time=0.63175 
Train Epoch: 47 [133/250 17024/32000 (53%)] Loss: 5.47181 (QuantReg: 15.83601) QuantErr: 15.83601 batch_time=0.61323 
Train Epoch: 47 [144/250 18432/32000 (58%)] Loss: 5.73251 (QuantReg: 15.64650) QuantErr: 15.64650 batch_time=1.07941 
Train Epoch: 47 [155/250 19840/32000 (62%)] Loss: 5.76355 (QuantReg: 15.96652) QuantErr: 15.96652 batch_time=0.61182 
Train Epoch: 47 [166/250 21248/32000 (66%)] Loss: 5.56497 (QuantReg: 15.81867) QuantErr: 15.81867 batch_time=0.60855 
Train Epoch: 47 [177/250 22656/32000 (71%)] Loss: 6.59902 (QuantReg: 15.77898) QuantErr: 15.77898 batch_time=0.60828 
Train Epoch: 47 [188/250 24064/32000 (75%)] Loss: 5.81189 (QuantReg: 15.78497) QuantErr: 15.78497 batch_time=0.60694 
Train Epoch: 47 [199/250 25472/32000 (80%)] Loss: 6.05058 (QuantReg: 15.74882) QuantErr: 15.74882 batch_time=0.61814 
Train Epoch: 47 [210/250 26880/32000 (84%)] Loss: 6.68874 (QuantReg: 15.79989) QuantErr: 15.79989 batch_time=0.61440 
Train Epoch: 47 [221/250 28288/32000 (88%)] Loss: 6.39862 (QuantReg: 15.81903) QuantErr: 15.81903 batch_time=0.61617 
Train Epoch: 47 [232/250 29696/32000 (93%)] Loss: 5.64300 (QuantReg: 15.79554) QuantErr: 15.79554 batch_time=0.60932 
Train Epoch: 47 [243/250 31104/32000 (97%)] Loss: 5.57638 (QuantReg: 15.77337) QuantErr: 15.77337 batch_time=0.73183 
Train Epoch: 47 codebook_update_time=3.29402
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch47.pth ...
Done in 4.399s
removing stale ckpt [epoch 46] [took 0.02s]
 epoch          : 47
 loss           : 5.946938302993774
 quant_reg      : 15.815427249908447
 quant_err      : 15.815427249908447
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 11750
 LSMDC_full_test/t2v_metrics/R1: 12.8
 LSMDC_full_test/t2v_metrics/R5: 32.1
 LSMDC_full_test/t2v_metrics/R10: 42.2
 LSMDC_full_test/t2v_metrics/R50: 69.3
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.34
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.8826745187723
 LSMDC_full_test/v2t_metrics/R1: 13.6
 LSMDC_full_test/v2t_metrics/R5: 31.4
 LSMDC_full_test/v2t_metrics/R10: 40.3
 LSMDC_full_test/v2t_metrics/R50: 68.4
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 73.792
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.81811519462468
 mnt_best       : 26.80506791364838
 not_improved_count: 18
Train Epoch: 48 [1/250 128/32000 (0%)] Loss: 5.39488 (QuantReg: 15.75955) QuantErr: 15.75955 batch_time=17.97685 
Train Epoch: 48 [12/250 1536/32000 (5%)] Loss: 5.54439 (QuantReg: 15.82468) QuantErr: 15.82468 batch_time=0.61188 
Train Epoch: 48 [23/250 2944/32000 (9%)] Loss: 5.32749 (QuantReg: 15.84661) QuantErr: 15.84661 batch_time=0.60646 
Train Epoch: 48 [34/250 4352/32000 (14%)] Loss: 6.07973 (QuantReg: 16.05934) QuantErr: 16.05934 batch_time=0.66218 
Train Epoch: 48 [45/250 5760/32000 (18%)] Loss: 5.70342 (QuantReg: 15.98777) QuantErr: 15.98777 batch_time=0.71856 
Train Epoch: 48 [56/250 7168/32000 (22%)] Loss: 5.88102 (QuantReg: 15.85658) QuantErr: 15.85658 batch_time=0.59274 
Train Epoch: 48 [67/250 8576/32000 (27%)] Loss: 5.60498 (QuantReg: 15.90027) QuantErr: 15.90027 batch_time=0.59479 
Train Epoch: 48 [78/250 9984/32000 (31%)] Loss: 6.80982 (QuantReg: 15.95841) QuantErr: 15.95841 batch_time=0.61230 
Train Epoch: 48 [89/250 11392/32000 (36%)] Loss: 5.61752 (QuantReg: 15.72065) QuantErr: 15.72065 batch_time=0.71506 
Train Epoch: 48 [100/250 12800/32000 (40%)] Loss: 6.38567 (QuantReg: 15.89970) QuantErr: 15.89970 batch_time=0.61420 
Train Epoch: 48 [111/250 14208/32000 (44%)] Loss: 6.08988 (QuantReg: 16.03979) QuantErr: 16.03979 batch_time=0.89271 
Train Epoch: 48 [122/250 15616/32000 (49%)] Loss: 6.17955 (QuantReg: 15.87468) QuantErr: 15.87468 batch_time=0.61779 
Train Epoch: 48 [133/250 17024/32000 (53%)] Loss: 5.68045 (QuantReg: 15.90786) QuantErr: 15.90786 batch_time=0.61996 
Train Epoch: 48 [144/250 18432/32000 (58%)] Loss: 6.24634 (QuantReg: 15.95754) QuantErr: 15.95754 batch_time=3.25730 
Train Epoch: 48 [155/250 19840/32000 (62%)] Loss: 6.34203 (QuantReg: 15.84825) QuantErr: 15.84825 batch_time=0.61369 
Train Epoch: 48 [166/250 21248/32000 (66%)] Loss: 6.51618 (QuantReg: 15.88758) QuantErr: 15.88758 batch_time=0.60777 
Train Epoch: 48 [177/250 22656/32000 (71%)] Loss: 5.50991 (QuantReg: 15.74232) QuantErr: 15.74232 batch_time=0.70302 
Train Epoch: 48 [188/250 24064/32000 (75%)] Loss: 6.61862 (QuantReg: 15.79224) QuantErr: 15.79224 batch_time=0.59850 
Train Epoch: 48 [199/250 25472/32000 (80%)] Loss: 5.82315 (QuantReg: 15.80119) QuantErr: 15.80119 batch_time=0.59370 
Train Epoch: 48 [210/250 26880/32000 (84%)] Loss: 5.52302 (QuantReg: 15.86822) QuantErr: 15.86822 batch_time=0.62074 
Train Epoch: 48 [221/250 28288/32000 (88%)] Loss: 6.38484 (QuantReg: 15.84150) QuantErr: 15.84150 batch_time=0.60426 
Train Epoch: 48 [232/250 29696/32000 (93%)] Loss: 5.94034 (QuantReg: 15.86401) QuantErr: 15.86401 batch_time=0.60856 
Train Epoch: 48 [243/250 31104/32000 (97%)] Loss: 5.36407 (QuantReg: 15.90623) QuantErr: 15.90623 batch_time=0.60978 
Train Epoch: 48 codebook_update_time=3.34654
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch48.pth ...
Done in 4.571s
removing stale ckpt [epoch 47] [took 0.01s]
 epoch          : 48
 loss           : 5.941080396652222
 quant_reg      : 15.837869213104248
 quant_err      : 15.837869213104248
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 12000
 LSMDC_full_test/t2v_metrics/R1: 13.0
 LSMDC_full_test/t2v_metrics/R5: 32.2
 LSMDC_full_test/t2v_metrics/R10: 41.7
 LSMDC_full_test/t2v_metrics/R50: 68.5
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 76.789
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.94050498885429
 LSMDC_full_test/v2t_metrics/R1: 13.0
 LSMDC_full_test/v2t_metrics/R5: 32.1
 LSMDC_full_test/v2t_metrics/R10: 41.1
 LSMDC_full_test/v2t_metrics/R50: 68.3
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.583
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.78873674578628
 mnt_best       : 26.80506791364838
 not_improved_count: 19
Train Epoch: 49 [1/250 128/32000 (0%)] Loss: 5.34854 (QuantReg: 15.98871) QuantErr: 15.98871 batch_time=16.84495 
Train Epoch: 49 [12/250 1536/32000 (5%)] Loss: 4.72178 (QuantReg: 15.77843) QuantErr: 15.77843 batch_time=0.61751 
Train Epoch: 49 [23/250 2944/32000 (9%)] Loss: 6.97551 (QuantReg: 15.90866) QuantErr: 15.90866 batch_time=1.15486 
Train Epoch: 49 [34/250 4352/32000 (14%)] Loss: 6.14813 (QuantReg: 15.75927) QuantErr: 15.75927 batch_time=0.61409 
Train Epoch: 49 [45/250 5760/32000 (18%)] Loss: 6.00741 (QuantReg: 15.84817) QuantErr: 15.84817 batch_time=0.82715 
Train Epoch: 49 [56/250 7168/32000 (22%)] Loss: 6.01171 (QuantReg: 15.86672) QuantErr: 15.86672 batch_time=1.24582 
Train Epoch: 49 [67/250 8576/32000 (27%)] Loss: 4.99101 (QuantReg: 15.71474) QuantErr: 15.71474 batch_time=0.91848 
Train Epoch: 49 [78/250 9984/32000 (31%)] Loss: 5.98745 (QuantReg: 15.83181) QuantErr: 15.83181 batch_time=0.61854 
Train Epoch: 49 [89/250 11392/32000 (36%)] Loss: 5.75467 (QuantReg: 15.82678) QuantErr: 15.82678 batch_time=0.61549 
Train Epoch: 49 [100/250 12800/32000 (40%)] Loss: 6.67047 (QuantReg: 15.76042) QuantErr: 15.76042 batch_time=0.60546 
Train Epoch: 49 [111/250 14208/32000 (44%)] Loss: 5.48336 (QuantReg: 15.70341) QuantErr: 15.70341 batch_time=0.61085 
Train Epoch: 49 [122/250 15616/32000 (49%)] Loss: 5.52997 (QuantReg: 15.85562) QuantErr: 15.85562 batch_time=0.60724 
Train Epoch: 49 [133/250 17024/32000 (53%)] Loss: 6.68206 (QuantReg: 15.72954) QuantErr: 15.72954 batch_time=0.60842 
Train Epoch: 49 [144/250 18432/32000 (58%)] Loss: 5.87489 (QuantReg: 15.84034) QuantErr: 15.84034 batch_time=0.60398 
Train Epoch: 49 [155/250 19840/32000 (62%)] Loss: 5.55285 (QuantReg: 15.86212) QuantErr: 15.86212 batch_time=0.60639 
Train Epoch: 49 [166/250 21248/32000 (66%)] Loss: 7.43968 (QuantReg: 15.66100) QuantErr: 15.66100 batch_time=0.61293 
Train Epoch: 49 [177/250 22656/32000 (71%)] Loss: 6.46476 (QuantReg: 15.86484) QuantErr: 15.86484 batch_time=0.62388 
Train Epoch: 49 [188/250 24064/32000 (75%)] Loss: 5.93898 (QuantReg: 15.95893) QuantErr: 15.95893 batch_time=0.81283 
Train Epoch: 49 [199/250 25472/32000 (80%)] Loss: 5.40923 (QuantReg: 15.89498) QuantErr: 15.89498 batch_time=0.60884 
Train Epoch: 49 [210/250 26880/32000 (84%)] Loss: 5.74600 (QuantReg: 15.80810) QuantErr: 15.80810 batch_time=0.61126 
Train Epoch: 49 [221/250 28288/32000 (88%)] Loss: 5.97020 (QuantReg: 15.57889) QuantErr: 15.57889 batch_time=0.60464 
Train Epoch: 49 [232/250 29696/32000 (93%)] Loss: 6.18434 (QuantReg: 15.80486) QuantErr: 15.80486 batch_time=0.71260 
Train Epoch: 49 [243/250 31104/32000 (97%)] Loss: 5.94650 (QuantReg: 15.80615) QuantErr: 15.80615 batch_time=0.71071 
Train Epoch: 49 codebook_update_time=3.23750
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch49.pth ...
Done in 3.888s
removing stale ckpt [epoch 48] [took 0.01s]
 epoch          : 49
 loss           : 5.966300748825073
 quant_reg      : 15.81726295852661
 quant_err      : 15.81726295852661
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 12250
 LSMDC_full_test/t2v_metrics/R1: 12.6
 LSMDC_full_test/t2v_metrics/R5: 32.5
 LSMDC_full_test/t2v_metrics/R10: 42.5
 LSMDC_full_test/t2v_metrics/R50: 68.5
 LSMDC_full_test/t2v_metrics/MedR: 16.0
 LSMDC_full_test/t2v_metrics/MeanR: 75.959
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.91478511628932
 LSMDC_full_test/v2t_metrics/R1: 13.2
 LSMDC_full_test/v2t_metrics/R5: 31.9
 LSMDC_full_test/v2t_metrics/R10: 41.2
 LSMDC_full_test/v2t_metrics/R50: 67.9
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 75.469
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.88733100327125
 mnt_best       : 26.80506791364838
 not_improved_count: 20
Train Epoch: 50 [1/250 128/32000 (0%)] Loss: 5.09051 (QuantReg: 15.76827) QuantErr: 15.76827 batch_time=16.82202 
Train Epoch: 50 [12/250 1536/32000 (5%)] Loss: 6.05660 (QuantReg: 15.75280) QuantErr: 15.75280 batch_time=0.61972 
Train Epoch: 50 [23/250 2944/32000 (9%)] Loss: 6.16261 (QuantReg: 15.82565) QuantErr: 15.82565 batch_time=0.63238 
Train Epoch: 50 [34/250 4352/32000 (14%)] Loss: 6.70002 (QuantReg: 15.78561) QuantErr: 15.78561 batch_time=0.62203 
Train Epoch: 50 [45/250 5760/32000 (18%)] Loss: 5.93182 (QuantReg: 15.78514) QuantErr: 15.78514 batch_time=0.61451 
Train Epoch: 50 [56/250 7168/32000 (22%)] Loss: 7.30478 (QuantReg: 15.83618) QuantErr: 15.83618 batch_time=0.60634 
Train Epoch: 50 [67/250 8576/32000 (27%)] Loss: 6.20735 (QuantReg: 15.80811) QuantErr: 15.80811 batch_time=0.60796 
Train Epoch: 50 [78/250 9984/32000 (31%)] Loss: 5.12339 (QuantReg: 15.87878) QuantErr: 15.87878 batch_time=0.59070 
Train Epoch: 50 [89/250 11392/32000 (36%)] Loss: 6.40501 (QuantReg: 15.90058) QuantErr: 15.90058 batch_time=0.60785 
Train Epoch: 50 [100/250 12800/32000 (40%)] Loss: 5.82447 (QuantReg: 16.04448) QuantErr: 16.04448 batch_time=0.60959 
Train Epoch: 50 [111/250 14208/32000 (44%)] Loss: 5.47213 (QuantReg: 15.81163) QuantErr: 15.81163 batch_time=0.64519 
Train Epoch: 50 [122/250 15616/32000 (49%)] Loss: 6.19119 (QuantReg: 15.63390) QuantErr: 15.63390 batch_time=0.60580 
Train Epoch: 50 [133/250 17024/32000 (53%)] Loss: 5.36668 (QuantReg: 15.72493) QuantErr: 15.72493 batch_time=0.82582 
Train Epoch: 50 [144/250 18432/32000 (58%)] Loss: 5.34448 (QuantReg: 15.71671) QuantErr: 15.71671 batch_time=0.73037 
Train Epoch: 50 [155/250 19840/32000 (62%)] Loss: 5.60705 (QuantReg: 15.90046) QuantErr: 15.90046 batch_time=0.60822 
Train Epoch: 50 [166/250 21248/32000 (66%)] Loss: 6.13955 (QuantReg: 15.67690) QuantErr: 15.67690 batch_time=0.61110 
Train Epoch: 50 [177/250 22656/32000 (71%)] Loss: 7.04978 (QuantReg: 15.76647) QuantErr: 15.76647 batch_time=0.60751 
Train Epoch: 50 [188/250 24064/32000 (75%)] Loss: 5.55538 (QuantReg: 15.95473) QuantErr: 15.95473 batch_time=0.97352 
Train Epoch: 50 [199/250 25472/32000 (80%)] Loss: 6.30998 (QuantReg: 15.89147) QuantErr: 15.89147 batch_time=0.61341 
Train Epoch: 50 [210/250 26880/32000 (84%)] Loss: 6.46922 (QuantReg: 15.78457) QuantErr: 15.78457 batch_time=0.71578 
Train Epoch: 50 [221/250 28288/32000 (88%)] Loss: 6.42921 (QuantReg: 15.81610) QuantErr: 15.81610 batch_time=0.60780 
Train Epoch: 50 [232/250 29696/32000 (93%)] Loss: 6.33143 (QuantReg: 15.91894) QuantErr: 15.91894 batch_time=0.61333 
Train Epoch: 50 [243/250 31104/32000 (97%)] Loss: 6.17498 (QuantReg: 15.74218) QuantErr: 15.74218 batch_time=0.61250 
Train Epoch: 50 codebook_update_time=3.37988
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/checkpoint-epoch50.pth ...
Done in 4.153s
removing stale ckpt [epoch 49] [took 0.01s]
 epoch          : 50
 loss           : 6.008467809677124
 quant_reg      : 15.81741626739502
 quant_err      : 15.81741626739502
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 12500
 LSMDC_full_test/t2v_metrics/R1: 13.4
 LSMDC_full_test/t2v_metrics/R5: 31.3
 LSMDC_full_test/t2v_metrics/R10: 41.7
 LSMDC_full_test/t2v_metrics/R50: 68.7
 LSMDC_full_test/t2v_metrics/MedR: 17.0
 LSMDC_full_test/t2v_metrics/MeanR: 76.65
 LSMDC_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.9574323178219
 LSMDC_full_test/v2t_metrics/R1: 13.0
 LSMDC_full_test/v2t_metrics/R5: 32.4
 LSMDC_full_test/v2t_metrics/R10: 41.0
 LSMDC_full_test/v2t_metrics/R50: 68.3
 LSMDC_full_test/v2t_metrics/MedR: 18.0
 LSMDC_full_test/v2t_metrics/MeanR: 74.842
 LSMDC_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.847829071166352
 mnt_best       : 26.80506791364838
 not_improved_count: 21
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/trained_model.pth ...
Ckpt loaded at epoch 29.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/LSMDC-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/LSMDC-test-qt-sims.npy
LSMDC_full_test:
 t2v_metrics/R1/final_eval: 14.1
 t2v_metrics/R5/final_eval: 32.6
 t2v_metrics/R10/final_eval: 41.9
 t2v_metrics/R50/final_eval: 69.8
 t2v_metrics/MedR/final_eval: 17.0
 t2v_metrics/MeanR/final_eval: 71.275
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 26.80506791364838
 v2t_metrics/R1/final_eval: 13.1
 v2t_metrics/R5/final_eval: 31.4
 v2t_metrics/R10/final_eval: 40.7
 v2t_metrics/R50/final_eval: 68.3
 v2t_metrics/MedR/final_eval: 18.0
 v2t_metrics/MeanR/final_eval: 71.209
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 25.581840352089724
Best epoch for the monitored metric: 29
Script took 04h02m43s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_LSMDC_L15/trained_model.pth
