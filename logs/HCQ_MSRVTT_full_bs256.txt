Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 721.2272913455963 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 37.05474376678467 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 235.09013748168945 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 153.15345907211304 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch0.pth ...
Done in 1.756s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch0.pth ...
Done in 4.421s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.0
 MSRVTT_full_val/t2v_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R10: 1.6096579476861168
 MSRVTT_full_val/t2v_metrics/R50: 8.450704225352112
 MSRVTT_full_val/t2v_metrics/MedR: 252.0
 MSRVTT_full_val/t2v_metrics/MeanR: 251.21730382293762
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_val/v2t_metrics/R1: 0.0
 MSRVTT_full_val/v2t_metrics/R5: 0.8048289738430584
 MSRVTT_full_val/v2t_metrics/R10: 2.0120724346076457
 MSRVTT_full_val/v2t_metrics/R50: 9.054325955734406
 MSRVTT_full_val/v2t_metrics/MedR: 243.0
 MSRVTT_full_val/v2t_metrics/MeanR: 247.7344064386318
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/t2v_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.26755852842809363
 MSRVTT_full_test/t2v_metrics/R50: 1.705685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 1515.0
 MSRVTT_full_test/t2v_metrics/MeanR: 1498.5294314381272
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.12154652794863813
 MSRVTT_full_test/v2t_metrics/R1: 0.06688963210702341
 MSRVTT_full_test/v2t_metrics/R5: 0.16722408026755853
 MSRVTT_full_test/v2t_metrics/R10: 0.3010033444816054
 MSRVTT_full_test/v2t_metrics/R50: 1.806020066889632
 MSRVTT_full_test/v2t_metrics/MedR: 1471.5
 MSRVTT_full_test/v2t_metrics/MeanR: 1495.3260869565217
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.14987975740993859
 mnt_best       : 0.12154652794863813
 not_improved_count: 0
Train Epoch: 1 [1/125 256/32000 (1%)] Loss: 11.22009 (QuantReg: 22.46302) QuantErr: 22.46302 batch_time=29.62151 
Train Epoch: 1 [17/125 4352/32000 (14%)] Loss: 8.86114 (QuantReg: 22.61963) QuantErr: 22.61963 batch_time=0.72778 
Train Epoch: 1 [33/125 8448/32000 (26%)] Loss: 7.70387 (QuantReg: 22.65079) QuantErr: 22.65079 batch_time=0.75476 
Train Epoch: 1 [49/125 12544/32000 (39%)] Loss: 7.14685 (QuantReg: 22.62908) QuantErr: 22.62908 batch_time=0.77014 
Train Epoch: 1 [65/125 16640/32000 (52%)] Loss: 6.48895 (QuantReg: 22.64130) QuantErr: 22.64130 batch_time=0.77264 
Train Epoch: 1 [81/125 20736/32000 (65%)] Loss: 6.38125 (QuantReg: 22.64185) QuantErr: 22.64185 batch_time=0.86151 
Train Epoch: 1 [97/125 24832/32000 (78%)] Loss: 5.89802 (QuantReg: 22.64419) QuantErr: 22.64419 batch_time=0.80036 
Train Epoch: 1 [113/125 28928/32000 (90%)] Loss: 5.77948 (QuantReg: 22.67823) QuantErr: 22.67823 batch_time=0.93882 
Train Epoch: 1 codebook_update_time=1.81953
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch1.pth ...
Done in 5.000s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch1.pth ...
Done in 10.040s
 epoch          : 1
 loss           : 7.1198236198425295
 quant_reg      : 22.622706283569336
 quant_err      : 22.622706283569336
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 125
 MSRVTT_full_val/t2v_metrics/R1: 17.10261569416499
 MSRVTT_full_val/t2v_metrics/R5: 47.48490945674044
 MSRVTT_full_val/t2v_metrics/R10: 61.971830985915496
 MSRVTT_full_val/t2v_metrics/R50: 93.158953722334
 MSRVTT_full_val/t2v_metrics/MedR: 6.0
 MSRVTT_full_val/t2v_metrics/MeanR: 15.396378269617706
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 36.920776500497816
 MSRVTT_full_val/v2t_metrics/R1: 20.321931589537222
 MSRVTT_full_val/v2t_metrics/R5: 53.72233400402415
 MSRVTT_full_val/v2t_metrics/R10: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.472837022132797
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 42.27730585320558
 MSRVTT_full_test/t2v_metrics/R1: 5.919732441471572
 MSRVTT_full_test/t2v_metrics/R5: 19.163879598662206
 MSRVTT_full_test/t2v_metrics/R10: 29.39799331103679
 MSRVTT_full_test/t2v_metrics/R50: 63.24414715719063
 MSRVTT_full_test/t2v_metrics/MedR: 29.0
 MSRVTT_full_test/t2v_metrics/MeanR: 80.16923076923077
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 14.940589477644663
 MSRVTT_full_test/v2t_metrics/R1: 6.789297658862877
 MSRVTT_full_test/v2t_metrics/R5: 22.040133779264213
 MSRVTT_full_test/v2t_metrics/R10: 33.37792642140468
 MSRVTT_full_test/v2t_metrics/R50: 68.96321070234114
 MSRVTT_full_test/v2t_metrics/MedR: 23.0
 MSRVTT_full_test/v2t_metrics/MeanR: 68.71973244147158
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.09357137010099
 mnt_best       : 14.940589477644663
 not_improved_count: 0
Train Epoch: 2 [1/125 256/32000 (1%)] Loss: 5.23188 (QuantReg: 11.77032) QuantErr: 11.77032 batch_time=37.84993 
Train Epoch: 2 [17/125 4352/32000 (14%)] Loss: 5.21253 (QuantReg: 12.31350) QuantErr: 12.31350 batch_time=0.75476 
Train Epoch: 2 [33/125 8448/32000 (26%)] Loss: 5.12016 (QuantReg: 12.70065) QuantErr: 12.70065 batch_time=0.73138 
Train Epoch: 2 [49/125 12544/32000 (39%)] Loss: 5.04035 (QuantReg: 13.15375) QuantErr: 13.15375 batch_time=0.75140 
Train Epoch: 2 [65/125 16640/32000 (52%)] Loss: 4.75050 (QuantReg: 14.02011) QuantErr: 14.02011 batch_time=4.09410 
Train Epoch: 2 [81/125 20736/32000 (65%)] Loss: 4.46351 (QuantReg: 14.15531) QuantErr: 14.15531 batch_time=0.88543 
Train Epoch: 2 [97/125 24832/32000 (78%)] Loss: 4.63671 (QuantReg: 14.45342) QuantErr: 14.45342 batch_time=0.74318 
Train Epoch: 2 [113/125 28928/32000 (90%)] Loss: 4.60893 (QuantReg: 15.28817) QuantErr: 15.28817 batch_time=0.93086 
Train Epoch: 2 codebook_update_time=1.61281
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch2.pth ...
Done in 21.621s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch2.pth ...
Done in 25.344s
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 4.942960472106933
 quant_reg      : 13.67909097290039
 quant_err      : 13.67909097290039
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 22.736418511066397
 MSRVTT_full_val/t2v_metrics/R5: 56.33802816901409
 MSRVTT_full_val/t2v_metrics/R10: 72.43460764587525
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.613682092555331
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 45.27133169190418
 MSRVTT_full_val/v2t_metrics/R1: 26.760563380281692
 MSRVTT_full_val/v2t_metrics/R5: 64.58752515090544
 MSRVTT_full_val/v2t_metrics/R10: 78.47082494969818
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.95774647887324
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 51.37880962661494
 MSRVTT_full_test/t2v_metrics/R1: 8.729096989966555
 MSRVTT_full_test/t2v_metrics/R5: 25.986622073578594
 MSRVTT_full_test/t2v_metrics/R10: 38.862876254180605
 MSRVTT_full_test/t2v_metrics/R50: 72.10702341137124
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 60.19565217391305
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.657829869393094
 MSRVTT_full_test/v2t_metrics/R1: 9.899665551839465
 MSRVTT_full_test/v2t_metrics/R5: 29.765886287625417
 MSRVTT_full_test/v2t_metrics/R10: 42.508361204013376
 MSRVTT_full_test/v2t_metrics/R50: 76.72240802675586
 MSRVTT_full_test/v2t_metrics/MedR: 14.5
 MSRVTT_full_test/v2t_metrics/MeanR: 51.20200668896321
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 23.224046965809478
 mnt_best       : 20.657829869393094
 not_improved_count: 0
Train Epoch: 3 [1/125 256/32000 (1%)] Loss: 4.55657 (QuantReg: 11.97677) QuantErr: 11.97677 batch_time=36.24997 
Train Epoch: 3 [17/125 4352/32000 (14%)] Loss: 4.41748 (QuantReg: 12.37944) QuantErr: 12.37944 batch_time=2.86910 
Train Epoch: 3 [33/125 8448/32000 (26%)] Loss: 4.43360 (QuantReg: 12.47073) QuantErr: 12.47073 batch_time=0.89022 
Train Epoch: 3 [49/125 12544/32000 (39%)] Loss: 4.12300 (QuantReg: 12.75680) QuantErr: 12.75680 batch_time=0.75958 
Train Epoch: 3 [65/125 16640/32000 (52%)] Loss: 4.22704 (QuantReg: 12.95197) QuantErr: 12.95197 batch_time=0.75180 
Train Epoch: 3 [81/125 20736/32000 (65%)] Loss: 4.05506 (QuantReg: 13.24821) QuantErr: 13.24821 batch_time=2.86447 
Train Epoch: 3 [97/125 24832/32000 (78%)] Loss: 3.69180 (QuantReg: 13.35273) QuantErr: 13.35273 batch_time=0.73935 
Train Epoch: 3 [113/125 28928/32000 (90%)] Loss: 4.22632 (QuantReg: 13.55894) QuantErr: 13.55894 batch_time=0.74957 
Train Epoch: 3 codebook_update_time=1.81088
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch3.pth ...
Done in 4.459s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch3.pth ...
Done in 8.518s
removing stale ckpt [epoch 2] [took 0.00s]
 epoch          : 3
 loss           : 4.211776826858521
 quant_reg      : 12.919039520263672
 quant_err      : 12.919039520263672
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 375
 MSRVTT_full_val/t2v_metrics/R1: 24.949698189134807
 MSRVTT_full_val/t2v_metrics/R5: 61.16700201207244
 MSRVTT_full_val/t2v_metrics/R10: 75.25150905432595
 MSRVTT_full_val/t2v_metrics/R50: 97.1830985915493
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.523138832997988
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 48.607046723187516
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 68.41046277665995
 MSRVTT_full_val/v2t_metrics/R10: 83.70221327967806
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.800804828973843
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.434224298216506
 MSRVTT_full_test/t2v_metrics/R1: 8.996655518394649
 MSRVTT_full_test/t2v_metrics/R5: 28.62876254180602
 MSRVTT_full_test/t2v_metrics/R10: 40.53511705685619
 MSRVTT_full_test/t2v_metrics/R50: 74.81605351170569
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.336120401337794
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.856051223368222
 MSRVTT_full_test/v2t_metrics/R1: 11.070234113712374
 MSRVTT_full_test/v2t_metrics/R5: 32.675585284280935
 MSRVTT_full_test/v2t_metrics/R10: 46.65551839464883
 MSRVTT_full_test/v2t_metrics/R50: 80.13377926421404
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 43.615050167224084
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.65041523954077
 mnt_best       : 21.856051223368222
 not_improved_count: 0
Train Epoch: 4 [1/125 256/32000 (1%)] Loss: 4.25866 (QuantReg: 12.29319) QuantErr: 12.29319 batch_time=45.59648 
Train Epoch: 4 [17/125 4352/32000 (14%)] Loss: 3.76131 (QuantReg: 12.46964) QuantErr: 12.46964 batch_time=0.84708 
Train Epoch: 4 [33/125 8448/32000 (26%)] Loss: 3.54967 (QuantReg: 12.69598) QuantErr: 12.69598 batch_time=0.73501 
Train Epoch: 4 [49/125 12544/32000 (39%)] Loss: 3.74672 (QuantReg: 12.77463) QuantErr: 12.77463 batch_time=0.75831 
Train Epoch: 4 [65/125 16640/32000 (52%)] Loss: 3.94518 (QuantReg: 12.93646) QuantErr: 12.93646 batch_time=1.69216 
Train Epoch: 4 [81/125 20736/32000 (65%)] Loss: 3.99261 (QuantReg: 12.83701) QuantErr: 12.83701 batch_time=0.84018 
Train Epoch: 4 [97/125 24832/32000 (78%)] Loss: 3.40698 (QuantReg: 13.13470) QuantErr: 13.13470 batch_time=0.84378 
Train Epoch: 4 [113/125 28928/32000 (90%)] Loss: 3.40417 (QuantReg: 13.04777) QuantErr: 13.04777 batch_time=0.75109 
Train Epoch: 4 codebook_update_time=1.66647
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch4.pth ...
Done in 5.182s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch4.pth ...
Done in 11.070s
removing stale ckpt [epoch 3] [took 0.01s]
 epoch          : 4
 loss           : 3.781222272872925
 quant_reg      : 12.842113235473633
 quant_err      : 12.842113235473633
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 26.961770623742456
 MSRVTT_full_val/t2v_metrics/R5: 62.97786720321932
 MSRVTT_full_val/t2v_metrics/R10: 77.2635814889336
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.847082494969818
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.81248070529641
 MSRVTT_full_val/v2t_metrics/R1: 30.18108651911469
 MSRVTT_full_val/v2t_metrics/R5: 71.42857142857143
 MSRVTT_full_val/v2t_metrics/R10: 83.29979879275653
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.482897384305835
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.41790159773574
 MSRVTT_full_test/t2v_metrics/R1: 9.59866220735786
 MSRVTT_full_test/t2v_metrics/R5: 29.698996655518396
 MSRVTT_full_test/t2v_metrics/R10: 43.24414715719063
 MSRVTT_full_test/t2v_metrics/R50: 77.1571906354515
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.84314381270903
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.10077804998149
 MSRVTT_full_test/v2t_metrics/R1: 12.14046822742475
 MSRVTT_full_test/v2t_metrics/R5: 35.25083612040134
 MSRVTT_full_test/v2t_metrics/R10: 49.56521739130435
 MSRVTT_full_test/v2t_metrics/R50: 82.74247491638796
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 37.07006688963211
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.68177652050579
 mnt_best       : 23.10077804998149
 not_improved_count: 0
Train Epoch: 5 [1/125 256/32000 (1%)] Loss: 3.55801 (QuantReg: 12.42609) QuantErr: 12.42609 batch_time=37.26921 
Train Epoch: 5 [17/125 4352/32000 (14%)] Loss: 3.51526 (QuantReg: 12.81252) QuantErr: 12.81252 batch_time=0.74224 
Train Epoch: 5 [33/125 8448/32000 (26%)] Loss: 3.24577 (QuantReg: 12.87114) QuantErr: 12.87114 batch_time=0.77548 
Train Epoch: 5 [49/125 12544/32000 (39%)] Loss: 3.20709 (QuantReg: 12.79152) QuantErr: 12.79152 batch_time=0.77892 
Train Epoch: 5 [65/125 16640/32000 (52%)] Loss: 3.08974 (QuantReg: 13.06595) QuantErr: 13.06595 batch_time=0.97878 
Train Epoch: 5 [81/125 20736/32000 (65%)] Loss: 3.28793 (QuantReg: 13.06563) QuantErr: 13.06563 batch_time=0.95083 
Train Epoch: 5 [97/125 24832/32000 (78%)] Loss: 3.13906 (QuantReg: 12.95514) QuantErr: 12.95514 batch_time=0.75231 
Train Epoch: 5 [113/125 28928/32000 (90%)] Loss: 3.55830 (QuantReg: 13.29980) QuantErr: 13.29980 batch_time=0.73709 
Train Epoch: 5 codebook_update_time=1.63723
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch5.pth ...
Done in 4.353s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch5.pth ...
Done in 16.948s
removing stale ckpt [epoch 4] [took 0.16s]
 epoch          : 5
 loss           : 3.4096395950317384
 quant_reg      : 13.011991203308105
 quant_err      : 13.011991203308105
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 625
 MSRVTT_full_val/t2v_metrics/R1: 28.37022132796781
 MSRVTT_full_val/t2v_metrics/R5: 64.1851106639839
 MSRVTT_full_val/t2v_metrics/R10: 77.2635814889336
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.794768611670019
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.01045079117703
 MSRVTT_full_val/v2t_metrics/R1: 30.784708249496983
 MSRVTT_full_val/v2t_metrics/R5: 72.03219315895372
 MSRVTT_full_val/v2t_metrics/R10: 82.09255533199195
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.132796780684105
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.67460276047788
 MSRVTT_full_test/t2v_metrics/R1: 10.535117056856187
 MSRVTT_full_test/t2v_metrics/R5: 29.598662207357858
 MSRVTT_full_test/t2v_metrics/R10: 43.17725752508361
 MSRVTT_full_test/t2v_metrics/R50: 77.89297658862876
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.489297658862874
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.789692798110735
 MSRVTT_full_test/v2t_metrics/R1: 12.37458193979933
 MSRVTT_full_test/v2t_metrics/R5: 35.35117056856188
 MSRVTT_full_test/v2t_metrics/R10: 50.23411371237458
 MSRVTT_full_test/v2t_metrics/R50: 83.47826086956522
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.11672240802675
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 28.009865690753163
 mnt_best       : 23.789692798110735
 not_improved_count: 0
Train Epoch: 6 [1/125 256/32000 (1%)] Loss: 3.40289 (QuantReg: 12.84797) QuantErr: 12.84797 batch_time=42.81861 
Train Epoch: 6 [17/125 4352/32000 (14%)] Loss: 3.39512 (QuantReg: 12.81523) QuantErr: 12.81523 batch_time=4.06002 
Train Epoch: 6 [33/125 8448/32000 (26%)] Loss: 3.43623 (QuantReg: 12.99560) QuantErr: 12.99560 batch_time=0.75743 
Train Epoch: 6 [49/125 12544/32000 (39%)] Loss: 2.94881 (QuantReg: 13.33653) QuantErr: 13.33653 batch_time=0.73456 
Train Epoch: 6 [65/125 16640/32000 (52%)] Loss: 3.45603 (QuantReg: 12.93412) QuantErr: 12.93412 batch_time=3.70007 
Train Epoch: 6 [81/125 20736/32000 (65%)] Loss: 3.11369 (QuantReg: 13.32969) QuantErr: 13.32969 batch_time=3.52348 
Train Epoch: 6 [97/125 24832/32000 (78%)] Loss: 3.11262 (QuantReg: 13.54766) QuantErr: 13.54766 batch_time=0.74327 
Train Epoch: 6 [113/125 28928/32000 (90%)] Loss: 2.78031 (QuantReg: 13.48894) QuantErr: 13.48894 batch_time=0.73746 
Train Epoch: 6 codebook_update_time=1.63220
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch6.pth ...
Done in 3.831s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch6.pth ...
Done in 8.356s
removing stale ckpt [epoch 5] [took 0.06s]
 epoch          : 6
 loss           : 3.154381580352783
 quant_reg      : 13.051425605773925
 quant_err      : 13.051425605773925
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 28.169014084507044
 MSRVTT_full_val/t2v_metrics/R5: 62.57545271629779
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.567404426559357
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.89256764337161
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 70.4225352112676
 MSRVTT_full_val/v2t_metrics/R10: 84.70824949698189
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.901408450704225
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.6403767535992
 MSRVTT_full_test/t2v_metrics/R1: 10.735785953177258
 MSRVTT_full_test/t2v_metrics/R5: 31.137123745819398
 MSRVTT_full_test/t2v_metrics/R10: 45.1505016722408
 MSRVTT_full_test/t2v_metrics/R50: 79.4648829431438
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.14163879598662
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.712971726253034
 MSRVTT_full_test/v2t_metrics/R1: 13.311036789297658
 MSRVTT_full_test/v2t_metrics/R5: 38.32775919732441
 MSRVTT_full_test/v2t_metrics/R10: 51.90635451505017
 MSRVTT_full_test/v2t_metrics/R50: 84.64882943143813
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.788628762541805
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.806794991589733
 mnt_best       : 24.712971726253034
 not_improved_count: 0
Train Epoch: 7 [1/125 256/32000 (1%)] Loss: 2.64780 (QuantReg: 12.82744) QuantErr: 12.82744 batch_time=55.32466 
Train Epoch: 7 [17/125 4352/32000 (14%)] Loss: 2.76277 (QuantReg: 12.94643) QuantErr: 12.94643 batch_time=1.04641 
Train Epoch: 7 [33/125 8448/32000 (26%)] Loss: 3.27648 (QuantReg: 13.02782) QuantErr: 13.02782 batch_time=0.74685 
Train Epoch: 7 [49/125 12544/32000 (39%)] Loss: 3.18682 (QuantReg: 13.19938) QuantErr: 13.19938 batch_time=1.99944 
Train Epoch: 7 [65/125 16640/32000 (52%)] Loss: 2.92595 (QuantReg: 13.13552) QuantErr: 13.13552 batch_time=13.33293 
Train Epoch: 7 [81/125 20736/32000 (65%)] Loss: 2.96854 (QuantReg: 13.23915) QuantErr: 13.23915 batch_time=0.98241 
Train Epoch: 7 [97/125 24832/32000 (78%)] Loss: 2.93184 (QuantReg: 13.30652) QuantErr: 13.30652 batch_time=0.75448 
Train Epoch: 7 [113/125 28928/32000 (90%)] Loss: 2.69038 (QuantReg: 13.16595) QuantErr: 13.16595 batch_time=2.01076 
Train Epoch: 7 codebook_update_time=1.68812
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch7.pth ...
Done in 4.266s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch7.pth ...
Done in 9.280s
removing stale ckpt [epoch 6] [took 0.43s]
 epoch          : 7
 loss           : 2.970870113372803
 quant_reg      : 13.143326766967773
 quant_err      : 13.143326766967773
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 875
 MSRVTT_full_val/t2v_metrics/R1: 29.37625754527163
 MSRVTT_full_val/t2v_metrics/R5: 62.17303822937626
 MSRVTT_full_val/t2v_metrics/R10: 78.26961770623743
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.038229376257545
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.287425256709916
 MSRVTT_full_val/v2t_metrics/R1: 32.796780684104625
 MSRVTT_full_val/v2t_metrics/R5: 71.62977867203219
 MSRVTT_full_val/v2t_metrics/R10: 86.31790744466801
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.788732394366197
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.75009539418348
 MSRVTT_full_test/t2v_metrics/R1: 11.17056856187291
 MSRVTT_full_test/t2v_metrics/R5: 32.441471571906355
 MSRVTT_full_test/t2v_metrics/R10: 45.38461538461539
 MSRVTT_full_test/t2v_metrics/R50: 78.39464882943143
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.12675585284281
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.43088620700667
 MSRVTT_full_test/v2t_metrics/R1: 13.177257525083611
 MSRVTT_full_test/v2t_metrics/R5: 38.12709030100334
 MSRVTT_full_test/v2t_metrics/R10: 52.90969899665552
 MSRVTT_full_test/v2t_metrics/R50: 84.68227424749163
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.49280936454849
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.844524403442886
 mnt_best       : 25.43088620700667
 not_improved_count: 0
Train Epoch: 8 [1/125 256/32000 (1%)] Loss: 2.97525 (QuantReg: 13.14789) QuantErr: 13.14789 batch_time=50.78277 
Train Epoch: 8 [17/125 4352/32000 (14%)] Loss: 2.83680 (QuantReg: 13.07020) QuantErr: 13.07020 batch_time=0.89752 
Train Epoch: 8 [33/125 8448/32000 (26%)] Loss: 2.79471 (QuantReg: 12.83999) QuantErr: 12.83999 batch_time=0.75163 
Train Epoch: 8 [49/125 12544/32000 (39%)] Loss: 3.03696 (QuantReg: 12.91600) QuantErr: 12.91600 batch_time=0.73972 
Train Epoch: 8 [65/125 16640/32000 (52%)] Loss: 3.00537 (QuantReg: 13.06215) QuantErr: 13.06215 batch_time=8.81928 
Train Epoch: 8 [81/125 20736/32000 (65%)] Loss: 2.99956 (QuantReg: 13.14621) QuantErr: 13.14621 batch_time=0.75193 
Train Epoch: 8 [97/125 24832/32000 (78%)] Loss: 2.70725 (QuantReg: 13.13393) QuantErr: 13.13393 batch_time=0.79249 
Train Epoch: 8 [113/125 28928/32000 (90%)] Loss: 2.74703 (QuantReg: 13.05886) QuantErr: 13.05886 batch_time=0.74951 
Train Epoch: 8 codebook_update_time=1.78971
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch8.pth ...
Done in 4.819s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch8.pth ...
Done in 9.511s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 8
 loss           : 2.7841379928588865
 quant_reg      : 13.160666114807128
 quant_err      : 13.160666114807128
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 30.58350100603622
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.909456740442656
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.87563003940867
 MSRVTT_full_val/v2t_metrics/R1: 35.010060362173036
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.064386317907445
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.09944031287618
 MSRVTT_full_test/t2v_metrics/R1: 12.040133779264215
 MSRVTT_full_test/t2v_metrics/R5: 32.94314381270903
 MSRVTT_full_test/t2v_metrics/R10: 47.625418060200666
 MSRVTT_full_test/t2v_metrics/R50: 80.60200668896321
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.21103678929766
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.632486682817603
 MSRVTT_full_test/v2t_metrics/R1: 14.280936454849499
 MSRVTT_full_test/v2t_metrics/R5: 38.929765886287626
 MSRVTT_full_test/v2t_metrics/R10: 53.31103678929766
 MSRVTT_full_test/v2t_metrics/R50: 85.35117056856187
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 32.967224080267556
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.94699863814622
 mnt_best       : 26.632486682817603
 not_improved_count: 0
Train Epoch: 9 [1/125 256/32000 (1%)] Loss: 3.04971 (QuantReg: 12.99928) QuantErr: 12.99928 batch_time=44.21777 
Train Epoch: 9 [17/125 4352/32000 (14%)] Loss: 3.10184 (QuantReg: 13.06532) QuantErr: 13.06532 batch_time=1.74077 
Train Epoch: 9 [33/125 8448/32000 (26%)] Loss: 2.75977 (QuantReg: 13.27556) QuantErr: 13.27556 batch_time=1.61944 
Train Epoch: 9 [49/125 12544/32000 (39%)] Loss: 2.65655 (QuantReg: 13.16294) QuantErr: 13.16294 batch_time=0.74571 
Train Epoch: 9 [65/125 16640/32000 (52%)] Loss: 2.74634 (QuantReg: 13.05528) QuantErr: 13.05528 batch_time=2.19704 
Train Epoch: 9 [81/125 20736/32000 (65%)] Loss: 2.65549 (QuantReg: 13.31017) QuantErr: 13.31017 batch_time=1.70364 
Train Epoch: 9 [97/125 24832/32000 (78%)] Loss: 2.60720 (QuantReg: 13.35579) QuantErr: 13.35579 batch_time=1.51848 
Train Epoch: 9 [113/125 28928/32000 (90%)] Loss: 2.47861 (QuantReg: 13.33753) QuantErr: 13.33753 batch_time=0.78452 
Train Epoch: 9 codebook_update_time=1.77836
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch9.pth ...
Done in 4.088s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 9
 loss           : 2.6520782585144045
 quant_reg      : 13.261753967285156
 quant_err      : 13.261753967285156
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 1125
 MSRVTT_full_val/t2v_metrics/R1: 32.394366197183096
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 79.27565392354124
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.209255533199194
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.17115774417963
 MSRVTT_full_val/v2t_metrics/R1: 32.394366197183096
 MSRVTT_full_val/v2t_metrics/R5: 73.44064386317908
 MSRVTT_full_val/v2t_metrics/R10: 85.51307847082495
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.47887323943662
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.81383535550033
 MSRVTT_full_test/t2v_metrics/R1: 11.57190635451505
 MSRVTT_full_test/t2v_metrics/R5: 33.87959866220736
 MSRVTT_full_test/t2v_metrics/R10: 46.92307692307692
 MSRVTT_full_test/t2v_metrics/R50: 79.49832775919732
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.30468227424749
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.39833586475874
 MSRVTT_full_test/v2t_metrics/R1: 14.481605351170568
 MSRVTT_full_test/v2t_metrics/R5: 38.69565217391305
 MSRVTT_full_test/v2t_metrics/R10: 54.147157190635454
 MSRVTT_full_test/v2t_metrics/R50: 84.84949832775919
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.63327759197325
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.190201444641787
 mnt_best       : 26.632486682817603
 not_improved_count: 1
Train Epoch: 10 [1/125 256/32000 (1%)] Loss: 2.87962 (QuantReg: 12.87302) QuantErr: 12.87302 batch_time=39.66266 
Train Epoch: 10 [17/125 4352/32000 (14%)] Loss: 2.69879 (QuantReg: 13.15061) QuantErr: 13.15061 batch_time=0.76510 
Train Epoch: 10 [33/125 8448/32000 (26%)] Loss: 2.12039 (QuantReg: 12.98295) QuantErr: 12.98295 batch_time=0.85966 
Train Epoch: 10 [49/125 12544/32000 (39%)] Loss: 2.47367 (QuantReg: 13.19082) QuantErr: 13.19082 batch_time=0.76362 
Train Epoch: 10 [65/125 16640/32000 (52%)] Loss: 2.56730 (QuantReg: 13.36712) QuantErr: 13.36712 batch_time=5.10368 
Train Epoch: 10 [81/125 20736/32000 (65%)] Loss: 2.49105 (QuantReg: 13.24953) QuantErr: 13.24953 batch_time=0.76815 
Train Epoch: 10 [97/125 24832/32000 (78%)] Loss: 2.75520 (QuantReg: 13.28102) QuantErr: 13.28102 batch_time=0.86606 
Train Epoch: 10 [113/125 28928/32000 (90%)] Loss: 2.75627 (QuantReg: 13.30014) QuantErr: 13.30014 batch_time=0.74222 
Train Epoch: 10 codebook_update_time=1.70740
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch10.pth ...
Done in 13.463s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 10
 loss           : 2.536181224822998
 quant_reg      : 13.30095012664795
 quant_err      : 13.30095012664795
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 64.1851106639839
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.474849094567404
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.62478033376326
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.674044265593562
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.22787940200011
 MSRVTT_full_test/t2v_metrics/R1: 11.438127090301004
 MSRVTT_full_test/t2v_metrics/R5: 33.34448160535117
 MSRVTT_full_test/t2v_metrics/R10: 46.020066889632105
 MSRVTT_full_test/t2v_metrics/R50: 79.1638795986622
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.792642140468224
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.988150776515248
 MSRVTT_full_test/v2t_metrics/R1: 14.548494983277592
 MSRVTT_full_test/v2t_metrics/R5: 39.86622073578595
 MSRVTT_full_test/v2t_metrics/R10: 54.48160535117057
 MSRVTT_full_test/v2t_metrics/R50: 85.75250836120401
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.09364548494983
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.614841626048708
 mnt_best       : 26.632486682817603
 not_improved_count: 2
Train Epoch: 11 [1/125 256/32000 (1%)] Loss: 2.56824 (QuantReg: 13.24133) QuantErr: 13.24133 batch_time=45.62533 
Train Epoch: 11 [17/125 4352/32000 (14%)] Loss: 2.25104 (QuantReg: 13.34244) QuantErr: 13.34244 batch_time=0.75695 
Train Epoch: 11 [33/125 8448/32000 (26%)] Loss: 2.11745 (QuantReg: 13.63294) QuantErr: 13.63294 batch_time=0.74868 
Train Epoch: 11 [49/125 12544/32000 (39%)] Loss: 2.38136 (QuantReg: 13.40882) QuantErr: 13.40882 batch_time=1.18530 
Train Epoch: 11 [65/125 16640/32000 (52%)] Loss: 2.31578 (QuantReg: 13.45031) QuantErr: 13.45031 batch_time=10.12938 
Train Epoch: 11 [81/125 20736/32000 (65%)] Loss: 2.15176 (QuantReg: 13.45653) QuantErr: 13.45653 batch_time=0.75413 
Train Epoch: 11 [97/125 24832/32000 (78%)] Loss: 2.33216 (QuantReg: 13.61406) QuantErr: 13.61406 batch_time=0.85616 
Train Epoch: 11 [113/125 28928/32000 (90%)] Loss: 2.55033 (QuantReg: 13.40026) QuantErr: 13.40026 batch_time=0.96672 
Train Epoch: 11 codebook_update_time=1.75658
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch11.pth ...
Done in 4.411s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 11
 loss           : 2.4074890842437746
 quant_reg      : 13.366433380126953
 quant_err      : 13.366433380126953
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 1375
 MSRVTT_full_val/t2v_metrics/R1: 27.56539235412475
 MSRVTT_full_val/t2v_metrics/R5: 64.98993963782696
 MSRVTT_full_val/t2v_metrics/R10: 79.47686116700201
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.253521126760564
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.2176119263171
 MSRVTT_full_val/v2t_metrics/R1: 35.412474849094565
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.346076458752515
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.26422297765961
 MSRVTT_full_test/t2v_metrics/R1: 10.501672240802675
 MSRVTT_full_test/t2v_metrics/R5: 32.0066889632107
 MSRVTT_full_test/t2v_metrics/R10: 45.719063545150505
 MSRVTT_full_test/t2v_metrics/R50: 78.62876254180603
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.36120401337793
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.861777674934743
 MSRVTT_full_test/v2t_metrics/R1: 14.347826086956522
 MSRVTT_full_test/v2t_metrics/R5: 39.531772575250834
 MSRVTT_full_test/v2t_metrics/R10: 53.812709030100336
 MSRVTT_full_test/v2t_metrics/R50: 85.08361204013377
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.94899665551839
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.251611438934773
 mnt_best       : 26.632486682817603
 not_improved_count: 3
Train Epoch: 12 [1/125 256/32000 (1%)] Loss: 2.43776 (QuantReg: 13.13254) QuantErr: 13.13254 batch_time=36.86617 
Train Epoch: 12 [17/125 4352/32000 (14%)] Loss: 2.62807 (QuantReg: 13.37611) QuantErr: 13.37611 batch_time=0.93156 
Train Epoch: 12 [33/125 8448/32000 (26%)] Loss: 2.06361 (QuantReg: 13.48146) QuantErr: 13.48146 batch_time=0.99717 
Train Epoch: 12 [49/125 12544/32000 (39%)] Loss: 2.38954 (QuantReg: 13.41766) QuantErr: 13.41766 batch_time=0.74566 
Train Epoch: 12 [65/125 16640/32000 (52%)] Loss: 2.36757 (QuantReg: 13.55765) QuantErr: 13.55765 batch_time=1.98633 
Train Epoch: 12 [81/125 20736/32000 (65%)] Loss: 2.24145 (QuantReg: 13.52949) QuantErr: 13.52949 batch_time=0.77344 
Train Epoch: 12 [97/125 24832/32000 (78%)] Loss: 2.36366 (QuantReg: 13.41046) QuantErr: 13.41046 batch_time=1.14446 
Train Epoch: 12 [113/125 28928/32000 (90%)] Loss: 2.31451 (QuantReg: 13.37399) QuantErr: 13.37399 batch_time=0.74556 
Train Epoch: 12 codebook_update_time=1.59254
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch12.pth ...
Done in 4.380s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch12.pth ...
Done in 9.512s
removing stale ckpt [epoch 11] [took 0.01s]
 epoch          : 12
 loss           : 2.347339246749878
 quant_reg      : 13.422491744995117
 quant_err      : 13.422491744995117
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 31.58953722334004
 MSRVTT_full_val/t2v_metrics/R5: 65.3923541247485
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.865191146881288
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.26030703404006
 MSRVTT_full_val/v2t_metrics/R1: 35.2112676056338
 MSRVTT_full_val/v2t_metrics/R5: 74.44668008048289
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.72635814889336
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.265930221758836
 MSRVTT_full_test/t2v_metrics/R1: 12.54180602006689
 MSRVTT_full_test/t2v_metrics/R5: 34.247491638795985
 MSRVTT_full_test/t2v_metrics/R10: 47.69230769230769
 MSRVTT_full_test/t2v_metrics/R50: 80.10033444816054
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.42307692307692
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.361867047091895
 MSRVTT_full_test/v2t_metrics/R1: 14.280936454849499
 MSRVTT_full_test/v2t_metrics/R5: 41.37123745819398
 MSRVTT_full_test/v2t_metrics/R10: 55.35117056856188
 MSRVTT_full_test/v2t_metrics/R50: 86.35451505016722
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.707859531772574
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.978690019696508
 mnt_best       : 27.361867047091895
 not_improved_count: 0
Train Epoch: 13 [1/125 256/32000 (1%)] Loss: 2.31656 (QuantReg: 13.48718) QuantErr: 13.48718 batch_time=41.61112 
Train Epoch: 13 [17/125 4352/32000 (14%)] Loss: 2.05901 (QuantReg: 13.40941) QuantErr: 13.40941 batch_time=3.14408 
Train Epoch: 13 [33/125 8448/32000 (26%)] Loss: 2.39475 (QuantReg: 13.55238) QuantErr: 13.55238 batch_time=0.95801 
Train Epoch: 13 [49/125 12544/32000 (39%)] Loss: 2.21443 (QuantReg: 13.48490) QuantErr: 13.48490 batch_time=0.73362 
Train Epoch: 13 [65/125 16640/32000 (52%)] Loss: 2.25883 (QuantReg: 13.18168) QuantErr: 13.18168 batch_time=5.07854 
Train Epoch: 13 [81/125 20736/32000 (65%)] Loss: 2.64793 (QuantReg: 13.36213) QuantErr: 13.36213 batch_time=3.63918 
Train Epoch: 13 [97/125 24832/32000 (78%)] Loss: 2.33002 (QuantReg: 13.50118) QuantErr: 13.50118 batch_time=0.98904 
Train Epoch: 13 [113/125 28928/32000 (90%)] Loss: 2.39035 (QuantReg: 13.62226) QuantErr: 13.62226 batch_time=0.74860 
Train Epoch: 13 codebook_update_time=1.65125
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch13.pth ...
Done in 3.940s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch13.pth ...
Done in 8.371s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 13
 loss           : 2.2696165857315065
 quant_reg      : 13.494962272644043
 quant_err      : 13.494962272644043
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 1625
 MSRVTT_full_val/t2v_metrics/R1: 32.59557344064386
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.635814889336016
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.50023742628318
 MSRVTT_full_val/v2t_metrics/R1: 36.41851106639839
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 88.32997987927565
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.830985915492958
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.32302294111043
 MSRVTT_full_test/t2v_metrics/R1: 12.37458193979933
 MSRVTT_full_test/t2v_metrics/R5: 34.51505016722408
 MSRVTT_full_test/t2v_metrics/R10: 48.2943143812709
 MSRVTT_full_test/t2v_metrics/R50: 81.00334448160535
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.20535117056856
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.42489771827609
 MSRVTT_full_test/v2t_metrics/R1: 14.68227424749164
 MSRVTT_full_test/v2t_metrics/R5: 40.96989966555184
 MSRVTT_full_test/v2t_metrics/R10: 56.38795986622073
 MSRVTT_full_test/v2t_metrics/R50: 86.08695652173913
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.610702341137124
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.370410342108066
 mnt_best       : 27.42489771827609
 not_improved_count: 0
Train Epoch: 14 [1/125 256/32000 (1%)] Loss: 2.09460 (QuantReg: 13.50841) QuantErr: 13.50841 batch_time=46.51388 
Train Epoch: 14 [17/125 4352/32000 (14%)] Loss: 2.31007 (QuantReg: 13.21856) QuantErr: 13.21856 batch_time=0.73553 
Train Epoch: 14 [33/125 8448/32000 (26%)] Loss: 2.28561 (QuantReg: 13.44373) QuantErr: 13.44373 batch_time=0.73653 
Train Epoch: 14 [49/125 12544/32000 (39%)] Loss: 2.26397 (QuantReg: 13.48887) QuantErr: 13.48887 batch_time=0.77770 
Train Epoch: 14 [65/125 16640/32000 (52%)] Loss: 2.43147 (QuantReg: 13.64102) QuantErr: 13.64102 batch_time=8.10784 
Train Epoch: 14 [81/125 20736/32000 (65%)] Loss: 2.33766 (QuantReg: 13.51908) QuantErr: 13.51908 batch_time=0.82544 
Train Epoch: 14 [97/125 24832/32000 (78%)] Loss: 2.05150 (QuantReg: 13.41814) QuantErr: 13.41814 batch_time=0.82469 
Train Epoch: 14 [113/125 28928/32000 (90%)] Loss: 2.01952 (QuantReg: 13.63159) QuantErr: 13.63159 batch_time=0.74893 
Train Epoch: 14 codebook_update_time=1.64450
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch14.pth ...
Done in 16.268s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch14.pth ...
Done in 19.969s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 14
 loss           : 2.206376944541931
 quant_reg      : 13.530414100646972
 quant_err      : 13.530414100646972
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 67.00201207243461
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.03420523138833
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.598543157742654
 MSRVTT_full_val/v2t_metrics/R1: 36.82092555331992
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 88.93360160965794
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.82897384305835
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.80545206292597
 MSRVTT_full_test/t2v_metrics/R1: 12.876254180602007
 MSRVTT_full_test/t2v_metrics/R5: 34.74916387959866
 MSRVTT_full_test/t2v_metrics/R10: 48.36120401337793
 MSRVTT_full_test/t2v_metrics/R50: 80.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 11.5
 MSRVTT_full_test/t2v_metrics/MeanR: 42.855183946488296
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.866151998684543
 MSRVTT_full_test/v2t_metrics/R1: 15.418060200668897
 MSRVTT_full_test/v2t_metrics/R5: 42.541806020066886
 MSRVTT_full_test/v2t_metrics/R10: 57.458193979933114
 MSRVTT_full_test/v2t_metrics/R50: 86.5551839464883
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.88494983277592
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.52734862862026
 mnt_best       : 27.866151998684543
 not_improved_count: 0
Train Epoch: 15 [1/125 256/32000 (1%)] Loss: 2.49299 (QuantReg: 13.23431) QuantErr: 13.23431 batch_time=41.75253 
Train Epoch: 15 [17/125 4352/32000 (14%)] Loss: 2.15547 (QuantReg: 13.27426) QuantErr: 13.27426 batch_time=0.74653 
Train Epoch: 15 [33/125 8448/32000 (26%)] Loss: 2.11740 (QuantReg: 13.35264) QuantErr: 13.35264 batch_time=0.74219 
Train Epoch: 15 [49/125 12544/32000 (39%)] Loss: 1.95543 (QuantReg: 13.46893) QuantErr: 13.46893 batch_time=0.73045 
Train Epoch: 15 [65/125 16640/32000 (52%)] Loss: 2.01758 (QuantReg: 13.43160) QuantErr: 13.43160 batch_time=6.58724 
Train Epoch: 15 [81/125 20736/32000 (65%)] Loss: 2.02260 (QuantReg: 13.61464) QuantErr: 13.61464 batch_time=0.88546 
Train Epoch: 15 [97/125 24832/32000 (78%)] Loss: 2.10495 (QuantReg: 13.63645) QuantErr: 13.63645 batch_time=0.73662 
Train Epoch: 15 [113/125 28928/32000 (90%)] Loss: 1.90299 (QuantReg: 13.68564) QuantErr: 13.68564 batch_time=0.74098 
Train Epoch: 15 codebook_update_time=1.70331
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch15.pth ...
Done in 10.872s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 15
 loss           : 2.1380276861190795
 quant_reg      : 13.508374969482421
 quant_err      : 13.508374969482421
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 1875
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 67.20321931589537
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.002012072434606
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.22571637902403
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 75.0503018108652
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.776659959758551
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.91567806186523
 MSRVTT_full_test/t2v_metrics/R1: 12.341137123745819
 MSRVTT_full_test/t2v_metrics/R5: 34.147157190635454
 MSRVTT_full_test/t2v_metrics/R10: 48.79598662207358
 MSRVTT_full_test/t2v_metrics/R50: 80.63545150501672
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.325752508361205
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.396680502545337
 MSRVTT_full_test/v2t_metrics/R1: 16.153846153846153
 MSRVTT_full_test/v2t_metrics/R5: 42.541806020066886
 MSRVTT_full_test/v2t_metrics/R10: 56.62207357859532
 MSRVTT_full_test/v2t_metrics/R50: 86.5551839464883
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.556521739130435
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.88643475212785
 mnt_best       : 27.866151998684543
 not_improved_count: 1
Train Epoch: 16 [1/125 256/32000 (1%)] Loss: 2.05611 (QuantReg: 13.51428) QuantErr: 13.51428 batch_time=54.77479 
Train Epoch: 16 [17/125 4352/32000 (14%)] Loss: 2.15506 (QuantReg: 13.44423) QuantErr: 13.44423 batch_time=0.74232 
Train Epoch: 16 [33/125 8448/32000 (26%)] Loss: 1.94737 (QuantReg: 13.60122) QuantErr: 13.60122 batch_time=0.76274 
Train Epoch: 16 [49/125 12544/32000 (39%)] Loss: 1.77963 (QuantReg: 13.54796) QuantErr: 13.54796 batch_time=0.73750 
Train Epoch: 16 [65/125 16640/32000 (52%)] Loss: 1.97634 (QuantReg: 13.57346) QuantErr: 13.57346 batch_time=12.45718 
Train Epoch: 16 [81/125 20736/32000 (65%)] Loss: 2.07200 (QuantReg: 13.65373) QuantErr: 13.65373 batch_time=0.75078 
Train Epoch: 16 [97/125 24832/32000 (78%)] Loss: 1.92398 (QuantReg: 13.93964) QuantErr: 13.93964 batch_time=0.87035 
Train Epoch: 16 [113/125 28928/32000 (90%)] Loss: 1.89852 (QuantReg: 13.46017) QuantErr: 13.46017 batch_time=0.73997 
Train Epoch: 16 codebook_update_time=1.74844
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch16.pth ...
Done in 14.379s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch16.pth ...
Done in 18.167s
removing stale ckpt [epoch 15] [took 0.00s]
 epoch          : 16
 loss           : 2.0726689710617063
 quant_reg      : 13.587524971008301
 quant_err      : 13.587524971008301
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 31.99195171026157
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.006036217303823
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.46195634942725
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 88.53118712273641
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.830985915492958
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.6576746839343
 MSRVTT_full_test/t2v_metrics/R1: 12.642140468227424
 MSRVTT_full_test/t2v_metrics/R5: 35.752508361204015
 MSRVTT_full_test/t2v_metrics/R10: 49.66555183946488
 MSRVTT_full_test/t2v_metrics/R50: 82.04013377926421
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.84615384615385
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.20941833131043
 MSRVTT_full_test/v2t_metrics/R1: 16.08695652173913
 MSRVTT_full_test/v2t_metrics/R5: 42.94314381270903
 MSRVTT_full_test/v2t_metrics/R10: 57.05685618729097
 MSRVTT_full_test/v2t_metrics/R50: 87.62541806020067
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.891638795986623
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.032343337463125
 mnt_best       : 28.20941833131043
 not_improved_count: 0
Train Epoch: 17 [1/125 256/32000 (1%)] Loss: 1.96222 (QuantReg: 13.48277) QuantErr: 13.48277 batch_time=39.67730 
Train Epoch: 17 [17/125 4352/32000 (14%)] Loss: 1.94576 (QuantReg: 13.60441) QuantErr: 13.60441 batch_time=1.75576 
Train Epoch: 17 [33/125 8448/32000 (26%)] Loss: 1.91727 (QuantReg: 13.51670) QuantErr: 13.51670 batch_time=0.73464 
Train Epoch: 17 [49/125 12544/32000 (39%)] Loss: 2.29541 (QuantReg: 13.65309) QuantErr: 13.65309 batch_time=0.98498 
Train Epoch: 17 [65/125 16640/32000 (52%)] Loss: 1.97408 (QuantReg: 13.87374) QuantErr: 13.87374 batch_time=3.13784 
Train Epoch: 17 [81/125 20736/32000 (65%)] Loss: 1.91609 (QuantReg: 13.75805) QuantErr: 13.75805 batch_time=1.77229 
Train Epoch: 17 [97/125 24832/32000 (78%)] Loss: 2.02721 (QuantReg: 13.63551) QuantErr: 13.63551 batch_time=0.77353 
Train Epoch: 17 [113/125 28928/32000 (90%)] Loss: 1.85816 (QuantReg: 13.76242) QuantErr: 13.76242 batch_time=0.74031 
Train Epoch: 17 codebook_update_time=1.63715
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch17.pth ...
Done in 3.805s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch17.pth ...
Done in 7.512s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 17
 loss           : 1.9942949647903443
 quant_reg      : 13.642178482055664
 quant_err      : 13.642178482055664
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 2125
 MSRVTT_full_val/t2v_metrics/R1: 32.59557344064386
 MSRVTT_full_val/t2v_metrics/R5: 66.80080482897384
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.851106639839034
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.14638065454504
 MSRVTT_full_val/v2t_metrics/R1: 38.22937625754527
 MSRVTT_full_val/v2t_metrics/R5: 75.65392354124748
 MSRVTT_full_val/v2t_metrics/R10: 90.3420523138833
 MSRVTT_full_val/v2t_metrics/R50: 98.99396378269617
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.800804828973843
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.930221169011666
 MSRVTT_full_test/t2v_metrics/R1: 13.311036789297658
 MSRVTT_full_test/t2v_metrics/R5: 36.52173913043478
 MSRVTT_full_test/t2v_metrics/R10: 50.13377926421405
 MSRVTT_full_test/t2v_metrics/R50: 81.83946488294315
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 39.57123745819398
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.993318479064907
 MSRVTT_full_test/v2t_metrics/R1: 15.585284280936454
 MSRVTT_full_test/v2t_metrics/R5: 43.47826086956522
 MSRVTT_full_test/v2t_metrics/R10: 57.725752508361204
 MSRVTT_full_test/v2t_metrics/R50: 87.59197324414716
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 27.868729096989966
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.94575703589024
 mnt_best       : 28.993318479064907
 not_improved_count: 0
Train Epoch: 18 [1/125 256/32000 (1%)] Loss: 2.25817 (QuantReg: 13.45359) QuantErr: 13.45359 batch_time=40.69848 
Train Epoch: 18 [17/125 4352/32000 (14%)] Loss: 2.09223 (QuantReg: 13.42003) QuantErr: 13.42003 batch_time=0.83575 
Train Epoch: 18 [33/125 8448/32000 (26%)] Loss: 2.03725 (QuantReg: 13.58267) QuantErr: 13.58267 batch_time=0.73863 
Train Epoch: 18 [49/125 12544/32000 (39%)] Loss: 2.08691 (QuantReg: 13.68881) QuantErr: 13.68881 batch_time=0.75846 
Train Epoch: 18 [65/125 16640/32000 (52%)] Loss: 1.92127 (QuantReg: 13.76549) QuantErr: 13.76549 batch_time=2.27340 
Train Epoch: 18 [81/125 20736/32000 (65%)] Loss: 2.04262 (QuantReg: 13.65627) QuantErr: 13.65627 batch_time=0.90319 
Train Epoch: 18 [97/125 24832/32000 (78%)] Loss: 1.92782 (QuantReg: 13.77163) QuantErr: 13.77163 batch_time=0.74914 
Train Epoch: 18 [113/125 28928/32000 (90%)] Loss: 1.95159 (QuantReg: 13.86889) QuantErr: 13.86889 batch_time=0.89859 
Train Epoch: 18 codebook_update_time=1.67084
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch18.pth ...
Done in 3.573s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 18
 loss           : 1.9642371282577515
 quant_reg      : 13.664888031005859
 quant_err      : 13.664888031005859
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 34.20523138832998
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.812877263581489
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.67909179559059
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.084507042253521
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.067153449339706
 MSRVTT_full_test/t2v_metrics/R1: 13.34448160535117
 MSRVTT_full_test/t2v_metrics/R5: 36.52173913043478
 MSRVTT_full_test/t2v_metrics/R10: 49.264214046822744
 MSRVTT_full_test/t2v_metrics/R50: 81.57190635451505
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.72809364548495
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.848832268002198
 MSRVTT_full_test/v2t_metrics/R1: 16.354515050167223
 MSRVTT_full_test/v2t_metrics/R5: 43.41137123745819
 MSRVTT_full_test/v2t_metrics/R10: 57.65886287625418
 MSRVTT_full_test/v2t_metrics/R50: 87.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.896989966555186
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.46426989841355
 mnt_best       : 28.993318479064907
 not_improved_count: 1
Train Epoch: 19 [1/125 256/32000 (1%)] Loss: 1.85557 (QuantReg: 13.43442) QuantErr: 13.43442 batch_time=46.73158 
Train Epoch: 19 [17/125 4352/32000 (14%)] Loss: 1.87466 (QuantReg: 13.64847) QuantErr: 13.64847 batch_time=0.73304 
Train Epoch: 19 [33/125 8448/32000 (26%)] Loss: 1.73319 (QuantReg: 13.57274) QuantErr: 13.57274 batch_time=0.73731 
Train Epoch: 19 [49/125 12544/32000 (39%)] Loss: 1.72682 (QuantReg: 13.59343) QuantErr: 13.59343 batch_time=0.75036 
Train Epoch: 19 [65/125 16640/32000 (52%)] Loss: 2.13074 (QuantReg: 13.47211) QuantErr: 13.47211 batch_time=6.92884 
Train Epoch: 19 [81/125 20736/32000 (65%)] Loss: 2.01865 (QuantReg: 13.81827) QuantErr: 13.81827 batch_time=0.78000 
Train Epoch: 19 [97/125 24832/32000 (78%)] Loss: 1.66375 (QuantReg: 13.78869) QuantErr: 13.78869 batch_time=0.86811 
Train Epoch: 19 [113/125 28928/32000 (90%)] Loss: 1.95648 (QuantReg: 13.77504) QuantErr: 13.77504 batch_time=0.75411 
Train Epoch: 19 codebook_update_time=1.61423
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch19.pth ...
Done in 16.292s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 19
 loss           : 1.929776969909668
 quant_reg      : 13.700823638916015
 quant_err      : 13.700823638916015
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 2375
 MSRVTT_full_val/t2v_metrics/R1: 32.99798792756539
 MSRVTT_full_val/t2v_metrics/R5: 67.20321931589537
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.104627766599599
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.628951326700495
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.875251509054326
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.35520069349817
 MSRVTT_full_test/t2v_metrics/R1: 13.244147157190636
 MSRVTT_full_test/t2v_metrics/R5: 36.187290969899664
 MSRVTT_full_test/t2v_metrics/R10: 48.99665551839465
 MSRVTT_full_test/t2v_metrics/R50: 81.43812709030101
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.52608695652174
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.636207595719526
 MSRVTT_full_test/v2t_metrics/R1: 16.555183946488295
 MSRVTT_full_test/v2t_metrics/R5: 43.84615384615385
 MSRVTT_full_test/v2t_metrics/R10: 58.52842809364549
 MSRVTT_full_test/v2t_metrics/R50: 87.05685618729098
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.437290969899667
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.89346715043658
 mnt_best       : 28.993318479064907
 not_improved_count: 2
Train Epoch: 20 [1/125 256/32000 (1%)] Loss: 1.60246 (QuantReg: 13.50150) QuantErr: 13.50150 batch_time=50.44253 
Train Epoch: 20 [17/125 4352/32000 (14%)] Loss: 2.06475 (QuantReg: 13.70436) QuantErr: 13.70436 batch_time=0.74099 
Train Epoch: 20 [33/125 8448/32000 (26%)] Loss: 1.66108 (QuantReg: 13.85845) QuantErr: 13.85845 batch_time=0.74059 
Train Epoch: 20 [49/125 12544/32000 (39%)] Loss: 1.67301 (QuantReg: 13.99974) QuantErr: 13.99974 batch_time=0.89852 
Train Epoch: 20 [65/125 16640/32000 (52%)] Loss: 2.05398 (QuantReg: 13.92016) QuantErr: 13.92016 batch_time=8.05000 
Train Epoch: 20 [81/125 20736/32000 (65%)] Loss: 2.00828 (QuantReg: 13.65425) QuantErr: 13.65425 batch_time=0.74248 
Train Epoch: 20 [97/125 24832/32000 (78%)] Loss: 1.68348 (QuantReg: 13.84905) QuantErr: 13.84905 batch_time=0.74501 
Train Epoch: 20 [113/125 28928/32000 (90%)] Loss: 1.96500 (QuantReg: 13.88235) QuantErr: 13.88235 batch_time=0.74159 
Train Epoch: 20 codebook_update_time=1.62246
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch20.pth ...
Done in 15.261s
removing stale ckpt [epoch 19] [took 0.72s]
 epoch          : 20
 loss           : 1.8884977855682372
 quant_reg      : 13.736488929748536
 quant_err      : 13.736488929748536
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 33.80281690140845
 MSRVTT_full_val/t2v_metrics/R5: 66.59959758551308
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.126760563380282
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.680201754827294
 MSRVTT_full_val/v2t_metrics/R1: 37.223340040241446
 MSRVTT_full_val/v2t_metrics/R5: 75.85513078470825
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.837022132796781
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.75443008159596
 MSRVTT_full_test/t2v_metrics/R1: 13.143812709030101
 MSRVTT_full_test/t2v_metrics/R5: 35.31772575250836
 MSRVTT_full_test/t2v_metrics/R10: 49.264214046822744
 MSRVTT_full_test/t2v_metrics/R50: 81.40468227424749
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.06822742474916
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.38454150590832
 MSRVTT_full_test/v2t_metrics/R1: 16.52173913043478
 MSRVTT_full_test/v2t_metrics/R5: 42.77591973244147
 MSRVTT_full_test/v2t_metrics/R10: 57.25752508361204
 MSRVTT_full_test/v2t_metrics/R50: 87.49163879598662
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.344816053511707
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.33174643291662
 mnt_best       : 28.993318479064907
 not_improved_count: 3
Train Epoch: 21 [1/125 256/32000 (1%)] Loss: 1.69233 (QuantReg: 13.67919) QuantErr: 13.67919 batch_time=34.58481 
Train Epoch: 21 [17/125 4352/32000 (14%)] Loss: 1.65981 (QuantReg: 13.99258) QuantErr: 13.99258 batch_time=10.21079 
Train Epoch: 21 [33/125 8448/32000 (26%)] Loss: 1.83038 (QuantReg: 13.61838) QuantErr: 13.61838 batch_time=0.77864 
Train Epoch: 21 [49/125 12544/32000 (39%)] Loss: 2.06211 (QuantReg: 13.82126) QuantErr: 13.82126 batch_time=0.73645 
Train Epoch: 21 [65/125 16640/32000 (52%)] Loss: 1.91583 (QuantReg: 13.75046) QuantErr: 13.75046 batch_time=0.88362 
Train Epoch: 21 [81/125 20736/32000 (65%)] Loss: 1.90095 (QuantReg: 13.75060) QuantErr: 13.75060 batch_time=8.48450 
Train Epoch: 21 [97/125 24832/32000 (78%)] Loss: 1.52042 (QuantReg: 13.71639) QuantErr: 13.71639 batch_time=0.80370 
Train Epoch: 21 [113/125 28928/32000 (90%)] Loss: 1.93161 (QuantReg: 13.85185) QuantErr: 13.85185 batch_time=0.74005 
Train Epoch: 21 codebook_update_time=1.98470
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch21.pth ...
Done in 3.826s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 21
 loss           : 1.8636714506149292
 quant_reg      : 13.756854301452636
 quant_err      : 13.756854301452636
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 2625
 MSRVTT_full_val/t2v_metrics/R1: 32.59557344064386
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 80.6841046277666
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.9678068410462775
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.34243864238063
 MSRVTT_full_val/v2t_metrics/R1: 38.43058350100603
 MSRVTT_full_val/v2t_metrics/R5: 74.84909456740442
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.9738430583501
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.998512609895634
 MSRVTT_full_test/t2v_metrics/R1: 13.076923076923077
 MSRVTT_full_test/t2v_metrics/R5: 36.08695652173913
 MSRVTT_full_test/t2v_metrics/R10: 49.59866220735786
 MSRVTT_full_test/t2v_metrics/R50: 81.50501672240803
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.33545150501672
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.604998503291416
 MSRVTT_full_test/v2t_metrics/R1: 16.05351170568562
 MSRVTT_full_test/v2t_metrics/R5: 43.34448160535117
 MSRVTT_full_test/v2t_metrics/R10: 58.561872909699
 MSRVTT_full_test/v2t_metrics/R50: 87.05685618729098
 MSRVTT_full_test/v2t_metrics/MedR: 7.5
 MSRVTT_full_test/v2t_metrics/MeanR: 29.205016722408025
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.411711509730374
 mnt_best       : 28.993318479064907
 not_improved_count: 4
Train Epoch: 22 [1/125 256/32000 (1%)] Loss: 1.95826 (QuantReg: 13.72997) QuantErr: 13.72997 batch_time=56.11420 
Train Epoch: 22 [17/125 4352/32000 (14%)] Loss: 1.76811 (QuantReg: 13.44722) QuantErr: 13.44722 batch_time=0.74399 
Train Epoch: 22 [33/125 8448/32000 (26%)] Loss: 1.98326 (QuantReg: 13.76440) QuantErr: 13.76440 batch_time=0.77528 
Train Epoch: 22 [49/125 12544/32000 (39%)] Loss: 1.90867 (QuantReg: 13.58683) QuantErr: 13.58683 batch_time=0.73861 
Train Epoch: 22 [65/125 16640/32000 (52%)] Loss: 1.38017 (QuantReg: 13.75181) QuantErr: 13.75181 batch_time=12.39059 
Train Epoch: 22 [81/125 20736/32000 (65%)] Loss: 2.13044 (QuantReg: 13.73774) QuantErr: 13.73774 batch_time=0.73665 
Train Epoch: 22 [97/125 24832/32000 (78%)] Loss: 1.70643 (QuantReg: 13.71242) QuantErr: 13.71242 batch_time=0.88865 
Train Epoch: 22 [113/125 28928/32000 (90%)] Loss: 1.78367 (QuantReg: 13.79747) QuantErr: 13.79747 batch_time=0.78551 
Train Epoch: 22 codebook_update_time=1.73145
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch22.pth ...
Done in 8.816s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch22.pth ...
Done in 12.646s
removing stale ckpt [epoch 21] [took 0.02s]
 epoch          : 22
 loss           : 1.798920690536499
 quant_reg      : 13.782275230407715
 quant_err      : 13.782275230407715
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 98.79275653923541
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.541247484909457
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.01810605408414
 MSRVTT_full_val/v2t_metrics/R1: 38.22937625754527
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.380281690140845
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.6488881947205
 MSRVTT_full_test/t2v_metrics/R1: 13.277591973244148
 MSRVTT_full_test/t2v_metrics/R5: 37.123745819397996
 MSRVTT_full_test/t2v_metrics/R10: 50.43478260869565
 MSRVTT_full_test/t2v_metrics/R50: 82.5752508361204
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 39.276923076923076
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.185496600661303
 MSRVTT_full_test/v2t_metrics/R1: 15.618729096989966
 MSRVTT_full_test/v2t_metrics/R5: 44.414715719063544
 MSRVTT_full_test/v2t_metrics/R10: 58.99665551839465
 MSRVTT_full_test/v2t_metrics/R50: 87.19063545150502
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 27.890969899665553
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.461432299736416
 mnt_best       : 29.185496600661303
 not_improved_count: 0
Train Epoch: 23 [1/125 256/32000 (1%)] Loss: 1.82754 (QuantReg: 13.67514) QuantErr: 13.67514 batch_time=47.60483 
Train Epoch: 23 [17/125 4352/32000 (14%)] Loss: 1.82995 (QuantReg: 13.79614) QuantErr: 13.79614 batch_time=0.78080 
Train Epoch: 23 [33/125 8448/32000 (26%)] Loss: 1.96258 (QuantReg: 13.61578) QuantErr: 13.61578 batch_time=0.77423 
Train Epoch: 23 [49/125 12544/32000 (39%)] Loss: 1.81915 (QuantReg: 13.69120) QuantErr: 13.69120 batch_time=0.90123 
Train Epoch: 23 [65/125 16640/32000 (52%)] Loss: 1.54995 (QuantReg: 13.79159) QuantErr: 13.79159 batch_time=7.09555 
Train Epoch: 23 [81/125 20736/32000 (65%)] Loss: 1.85652 (QuantReg: 13.94284) QuantErr: 13.94284 batch_time=0.79643 
Train Epoch: 23 [97/125 24832/32000 (78%)] Loss: 1.83129 (QuantReg: 13.71310) QuantErr: 13.71310 batch_time=0.84026 
Train Epoch: 23 [113/125 28928/32000 (90%)] Loss: 1.77001 (QuantReg: 13.86428) QuantErr: 13.86428 batch_time=0.79304 
Train Epoch: 23 codebook_update_time=1.73276
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch23.pth ...
Done in 4.091s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 23
 loss           : 1.8174326877593994
 quant_reg      : 13.787254684448243
 quant_err      : 13.787254684448243
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 2875
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 82.49496981891348
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.557344064386318
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.22421269807494
 MSRVTT_full_val/v2t_metrics/R1: 37.82696177062374
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.649899396378269
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.21022502531524
 MSRVTT_full_test/t2v_metrics/R1: 13.043478260869565
 MSRVTT_full_test/t2v_metrics/R5: 36.8561872909699
 MSRVTT_full_test/t2v_metrics/R10: 51.070234113712374
 MSRVTT_full_test/t2v_metrics/R50: 82.67558528428094
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 39.67759197324415
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.06412311641648
 MSRVTT_full_test/v2t_metrics/R1: 16.321070234113712
 MSRVTT_full_test/v2t_metrics/R5: 44.381270903010034
 MSRVTT_full_test/v2t_metrics/R10: 58.19397993311037
 MSRVTT_full_test/v2t_metrics/R50: 87.65886287625418
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.07458193979933
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.80236915864919
 mnt_best       : 29.185496600661303
 not_improved_count: 1
Train Epoch: 24 [1/125 256/32000 (1%)] Loss: 1.92667 (QuantReg: 13.64971) QuantErr: 13.64971 batch_time=55.40334 
Train Epoch: 24 [17/125 4352/32000 (14%)] Loss: 1.87248 (QuantReg: 13.78452) QuantErr: 13.78452 batch_time=0.87814 
Train Epoch: 24 [33/125 8448/32000 (26%)] Loss: 1.78952 (QuantReg: 13.90253) QuantErr: 13.90253 batch_time=0.73754 
Train Epoch: 24 [49/125 12544/32000 (39%)] Loss: 1.57407 (QuantReg: 13.86139) QuantErr: 13.86139 batch_time=0.73746 
Train Epoch: 24 [65/125 16640/32000 (52%)] Loss: 1.74265 (QuantReg: 13.81827) QuantErr: 13.81827 batch_time=6.50301 
Train Epoch: 24 [81/125 20736/32000 (65%)] Loss: 1.85911 (QuantReg: 13.46597) QuantErr: 13.46597 batch_time=0.74796 
Train Epoch: 24 [97/125 24832/32000 (78%)] Loss: 1.44004 (QuantReg: 13.90195) QuantErr: 13.90195 batch_time=0.74415 
Train Epoch: 24 [113/125 28928/32000 (90%)] Loss: 1.47844 (QuantReg: 13.83330) QuantErr: 13.83330 batch_time=0.89455 
Train Epoch: 24 codebook_update_time=1.73696
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch24.pth ...
Done in 3.638s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch24.pth ...
Done in 7.476s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 24
 loss           : 1.764312699317932
 quant_reg      : 13.80001123046875
 quant_err      : 13.80001123046875
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.627766599597585
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.733116357165045
 MSRVTT_full_val/v2t_metrics/R1: 38.22937625754527
 MSRVTT_full_val/v2t_metrics/R5: 78.26961770623743
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.577464788732394
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.0285266484516
 MSRVTT_full_test/t2v_metrics/R1: 13.34448160535117
 MSRVTT_full_test/t2v_metrics/R5: 37.02341137123746
 MSRVTT_full_test/t2v_metrics/R10: 50.76923076923077
 MSRVTT_full_test/t2v_metrics/R50: 82.04013377926421
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.15919732441471
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.272483803939316
 MSRVTT_full_test/v2t_metrics/R1: 16.68896321070234
 MSRVTT_full_test/v2t_metrics/R5: 43.31103678929766
 MSRVTT_full_test/v2t_metrics/R10: 58.02675585284281
 MSRVTT_full_test/v2t_metrics/R50: 87.65886287625418
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 27.994983277591974
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.74444745207963
 mnt_best       : 29.272483803939316
 not_improved_count: 0
Train Epoch: 25 [1/125 256/32000 (1%)] Loss: 2.12577 (QuantReg: 13.83749) QuantErr: 13.83749 batch_time=42.90261 
Train Epoch: 25 [17/125 4352/32000 (14%)] Loss: 1.90554 (QuantReg: 13.89017) QuantErr: 13.89017 batch_time=0.83384 
Train Epoch: 25 [33/125 8448/32000 (26%)] Loss: 1.58354 (QuantReg: 13.94155) QuantErr: 13.94155 batch_time=0.74152 
Train Epoch: 25 [49/125 12544/32000 (39%)] Loss: 1.91226 (QuantReg: 13.93770) QuantErr: 13.93770 batch_time=0.79178 
Train Epoch: 25 [65/125 16640/32000 (52%)] Loss: 1.73594 (QuantReg: 13.91515) QuantErr: 13.91515 batch_time=5.43235 
Train Epoch: 25 [81/125 20736/32000 (65%)] Loss: 1.87307 (QuantReg: 13.86305) QuantErr: 13.86305 batch_time=0.85434 
Train Epoch: 25 [97/125 24832/32000 (78%)] Loss: 1.92832 (QuantReg: 13.71863) QuantErr: 13.71863 batch_time=0.74746 
Train Epoch: 25 [113/125 28928/32000 (90%)] Loss: 1.70140 (QuantReg: 13.93020) QuantErr: 13.93020 batch_time=0.85815 
Train Epoch: 25 codebook_update_time=1.59259
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch25.pth ...
Done in 3.629s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch25.pth ...
Done in 7.320s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 25
 loss           : 1.7736927270889282
 quant_reg      : 13.847445175170899
 quant_err      : 13.847445175170899
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 3125
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.663983903420523
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.17013209781891
 MSRVTT_full_val/v2t_metrics/R1: 39.436619718309856
 MSRVTT_full_val/v2t_metrics/R5: 77.8672032193159
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.637826961770624
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.2868444276868
 MSRVTT_full_test/t2v_metrics/R1: 13.645484949832776
 MSRVTT_full_test/t2v_metrics/R5: 36.95652173913044
 MSRVTT_full_test/t2v_metrics/R10: 50.30100334448161
 MSRVTT_full_test/t2v_metrics/R50: 82.10702341137124
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.09866220735786
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.382285259775248
 MSRVTT_full_test/v2t_metrics/R1: 16.622073578595316
 MSRVTT_full_test/v2t_metrics/R5: 44.247491638795985
 MSRVTT_full_test/v2t_metrics/R10: 58.59531772575251
 MSRVTT_full_test/v2t_metrics/R50: 86.8561872909699
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.673076923076923
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.06002783810373
 mnt_best       : 29.382285259775248
 not_improved_count: 0
Train Epoch: 26 [1/125 256/32000 (1%)] Loss: 1.77546 (QuantReg: 13.93924) QuantErr: 13.93924 batch_time=45.21531 
Train Epoch: 26 [17/125 4352/32000 (14%)] Loss: 1.79086 (QuantReg: 13.73975) QuantErr: 13.73975 batch_time=0.93188 
Train Epoch: 26 [33/125 8448/32000 (26%)] Loss: 1.71188 (QuantReg: 13.95429) QuantErr: 13.95429 batch_time=0.74685 
Train Epoch: 26 [49/125 12544/32000 (39%)] Loss: 1.70064 (QuantReg: 14.06056) QuantErr: 14.06056 batch_time=0.97713 
Train Epoch: 26 [65/125 16640/32000 (52%)] Loss: 1.40770 (QuantReg: 13.88475) QuantErr: 13.88475 batch_time=4.95570 
Train Epoch: 26 [81/125 20736/32000 (65%)] Loss: 1.92008 (QuantReg: 13.77176) QuantErr: 13.77176 batch_time=0.73179 
Train Epoch: 26 [97/125 24832/32000 (78%)] Loss: 1.57435 (QuantReg: 13.99923) QuantErr: 13.99923 batch_time=0.78567 
Train Epoch: 26 [113/125 28928/32000 (90%)] Loss: 1.76247 (QuantReg: 14.12698) QuantErr: 14.12698 batch_time=0.97933 
Train Epoch: 26 codebook_update_time=1.74340
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch26.pth ...
Done in 3.965s
removing stale ckpt [epoch 25] [took 0.00s]
 epoch          : 26
 loss           : 1.7442207040786744
 quant_reg      : 13.881998443603516
 quant_err      : 13.881998443603516
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.619718309859155
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.87566784042755
 MSRVTT_full_val/v2t_metrics/R1: 36.82092555331992
 MSRVTT_full_val/v2t_metrics/R5: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.75251509054326
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.014870405254165
 MSRVTT_full_test/t2v_metrics/R1: 13.545150501672241
 MSRVTT_full_test/t2v_metrics/R5: 36.98996655518395
 MSRVTT_full_test/t2v_metrics/R10: 50.10033444816054
 MSRVTT_full_test/t2v_metrics/R50: 81.1371237458194
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.52608695652174
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.279891711016322
 MSRVTT_full_test/v2t_metrics/R1: 16.8561872909699
 MSRVTT_full_test/v2t_metrics/R5: 43.74581939799331
 MSRVTT_full_test/v2t_metrics/R10: 58.82943143812709
 MSRVTT_full_test/v2t_metrics/R50: 86.42140468227424
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.808026755852843
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.13690612198243
 mnt_best       : 29.382285259775248
 not_improved_count: 1
Train Epoch: 27 [1/125 256/32000 (1%)] Loss: 1.73908 (QuantReg: 13.98757) QuantErr: 13.98757 batch_time=56.05255 
Train Epoch: 27 [17/125 4352/32000 (14%)] Loss: 1.62054 (QuantReg: 13.99072) QuantErr: 13.99072 batch_time=0.74089 
Train Epoch: 27 [33/125 8448/32000 (26%)] Loss: 1.66453 (QuantReg: 14.01213) QuantErr: 14.01213 batch_time=0.83336 
Train Epoch: 27 [49/125 12544/32000 (39%)] Loss: 1.73308 (QuantReg: 13.96509) QuantErr: 13.96509 batch_time=0.73944 
Train Epoch: 27 [65/125 16640/32000 (52%)] Loss: 1.85506 (QuantReg: 13.95325) QuantErr: 13.95325 batch_time=7.46451 
Train Epoch: 27 [81/125 20736/32000 (65%)] Loss: 1.44198 (QuantReg: 13.93267) QuantErr: 13.93267 batch_time=0.73242 
Train Epoch: 27 [97/125 24832/32000 (78%)] Loss: 1.63296 (QuantReg: 13.81111) QuantErr: 13.81111 batch_time=0.89083 
Train Epoch: 27 [113/125 28928/32000 (90%)] Loss: 1.79135 (QuantReg: 13.99131) QuantErr: 13.99131 batch_time=0.88939 
Train Epoch: 27 codebook_update_time=1.58639
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch27.pth ...
Done in 3.914s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch27.pth ...
Done in 7.565s
removing stale ckpt [epoch 26] [took 0.00s]
 epoch          : 27
 loss           : 1.711608702659607
 quant_reg      : 13.892842803955078
 quant_err      : 13.892842803955078
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 3375
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 82.29376257545272
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.553319919517103
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.17765107239103
 MSRVTT_full_val/v2t_metrics/R1: 37.82696177062374
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.678068410462776
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.25873634522017
 MSRVTT_full_test/t2v_metrics/R1: 13.210702341137123
 MSRVTT_full_test/t2v_metrics/R5: 37.725752508361204
 MSRVTT_full_test/t2v_metrics/R10: 50.903010033444815
 MSRVTT_full_test/t2v_metrics/R50: 81.70568561872909
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.15785953177257
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.383425730971922
 MSRVTT_full_test/v2t_metrics/R1: 16.65551839464883
 MSRVTT_full_test/v2t_metrics/R5: 44.74916387959866
 MSRVTT_full_test/v2t_metrics/R10: 58.76254180602007
 MSRVTT_full_test/v2t_metrics/R50: 87.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.72943143812709
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.24908794078777
 mnt_best       : 29.383425730971922
 not_improved_count: 0
Train Epoch: 28 [1/125 256/32000 (1%)] Loss: 1.62846 (QuantReg: 13.78236) QuantErr: 13.78236 batch_time=48.61843 
Train Epoch: 28 [17/125 4352/32000 (14%)] Loss: 1.69686 (QuantReg: 13.79621) QuantErr: 13.79621 batch_time=0.73851 
Train Epoch: 28 [33/125 8448/32000 (26%)] Loss: 1.68510 (QuantReg: 13.97121) QuantErr: 13.97121 batch_time=0.74898 
Train Epoch: 28 [49/125 12544/32000 (39%)] Loss: 1.32321 (QuantReg: 13.91361) QuantErr: 13.91361 batch_time=0.75570 
Train Epoch: 28 [65/125 16640/32000 (52%)] Loss: 1.62807 (QuantReg: 13.92341) QuantErr: 13.92341 batch_time=5.52303 
Train Epoch: 28 [81/125 20736/32000 (65%)] Loss: 2.05538 (QuantReg: 13.61453) QuantErr: 13.61453 batch_time=0.75275 
Train Epoch: 28 [97/125 24832/32000 (78%)] Loss: 1.58768 (QuantReg: 14.00750) QuantErr: 14.00750 batch_time=0.75659 
Train Epoch: 28 [113/125 28928/32000 (90%)] Loss: 1.59338 (QuantReg: 14.09158) QuantErr: 14.09158 batch_time=0.74343 
Train Epoch: 28 codebook_update_time=1.60586
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch28.pth ...
Done in 3.748s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch28.pth ...
Done in 7.537s
removing stale ckpt [epoch 27] [took 0.00s]
 epoch          : 28
 loss           : 1.7112453899383544
 quant_reg      : 13.92122576904297
 quant_err      : 13.92122576904297
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 34.20523138832998
 MSRVTT_full_val/t2v_metrics/R5: 67.6056338028169
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.961770623742455
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.378389645819304
 MSRVTT_full_val/v2t_metrics/R1: 37.223340040241446
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.770623742454728
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.06476132532787
 MSRVTT_full_test/t2v_metrics/R1: 13.478260869565217
 MSRVTT_full_test/t2v_metrics/R5: 37.25752508361204
 MSRVTT_full_test/t2v_metrics/R10: 51.40468227424749
 MSRVTT_full_test/t2v_metrics/R50: 81.87290969899665
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.94180602006689
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.554039300327094
 MSRVTT_full_test/v2t_metrics/R1: 17.190635451505017
 MSRVTT_full_test/v2t_metrics/R5: 45.05016722408027
 MSRVTT_full_test/v2t_metrics/R10: 58.862876254180605
 MSRVTT_full_test/v2t_metrics/R50: 87.45819397993311
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.953177257525084
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.72261742749078
 mnt_best       : 29.554039300327094
 not_improved_count: 0
Train Epoch: 29 [1/125 256/32000 (1%)] Loss: 1.66930 (QuantReg: 13.73250) QuantErr: 13.73250 batch_time=49.33122 
Train Epoch: 29 [17/125 4352/32000 (14%)] Loss: 1.56611 (QuantReg: 13.84168) QuantErr: 13.84168 batch_time=3.56754 
Train Epoch: 29 [33/125 8448/32000 (26%)] Loss: 1.52306 (QuantReg: 14.00000) QuantErr: 14.00000 batch_time=0.74175 
Train Epoch: 29 [49/125 12544/32000 (39%)] Loss: 1.79649 (QuantReg: 14.11930) QuantErr: 14.11930 batch_time=0.73973 
Train Epoch: 29 [65/125 16640/32000 (52%)] Loss: 1.80433 (QuantReg: 13.90053) QuantErr: 13.90053 batch_time=4.84993 
Train Epoch: 29 [81/125 20736/32000 (65%)] Loss: 1.84735 (QuantReg: 14.00781) QuantErr: 14.00781 batch_time=3.23298 
Train Epoch: 29 [97/125 24832/32000 (78%)] Loss: 1.92879 (QuantReg: 13.75951) QuantErr: 13.75951 batch_time=0.74213 
Train Epoch: 29 [113/125 28928/32000 (90%)] Loss: 1.73856 (QuantReg: 13.80577) QuantErr: 13.80577 batch_time=0.89465 
Train Epoch: 29 codebook_update_time=1.66331
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch29.pth ...
Done in 7.435s
removing stale ckpt [epoch 28] [took 0.09s]
 epoch          : 29
 loss           : 1.6945104284286499
 quant_reg      : 13.933883354187012
 quant_err      : 13.933883354187012
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 3625
 MSRVTT_full_val/t2v_metrics/R1: 33.80281690140845
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.130784708249497
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.83935061734161
 MSRVTT_full_val/v2t_metrics/R1: 38.43058350100603
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.957746478873239
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.69791573745086
 MSRVTT_full_test/t2v_metrics/R1: 13.377926421404682
 MSRVTT_full_test/t2v_metrics/R5: 36.75585284280937
 MSRVTT_full_test/t2v_metrics/R10: 49.83277591973244
 MSRVTT_full_test/t2v_metrics/R50: 80.96989966555184
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.85585284280936
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.045362144299332
 MSRVTT_full_test/v2t_metrics/R1: 16.82274247491639
 MSRVTT_full_test/v2t_metrics/R5: 44.046822742474916
 MSRVTT_full_test/v2t_metrics/R10: 58.16053511705686
 MSRVTT_full_test/v2t_metrics/R50: 87.25752508361204
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.250334448160537
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.060108762460615
 mnt_best       : 29.554039300327094
 not_improved_count: 1
Train Epoch: 30 [1/125 256/32000 (1%)] Loss: 1.57967 (QuantReg: 13.92776) QuantErr: 13.92776 batch_time=39.63285 
Train Epoch: 30 [17/125 4352/32000 (14%)] Loss: 1.68672 (QuantReg: 14.00238) QuantErr: 14.00238 batch_time=9.73605 
Train Epoch: 30 [33/125 8448/32000 (26%)] Loss: 1.74269 (QuantReg: 14.02657) QuantErr: 14.02657 batch_time=0.87272 
Train Epoch: 30 [49/125 12544/32000 (39%)] Loss: 1.57135 (QuantReg: 13.82880) QuantErr: 13.82880 batch_time=0.82397 
Train Epoch: 30 [65/125 16640/32000 (52%)] Loss: 1.58007 (QuantReg: 13.93315) QuantErr: 13.93315 batch_time=2.16594 
Train Epoch: 30 [81/125 20736/32000 (65%)] Loss: 1.75416 (QuantReg: 13.99439) QuantErr: 13.99439 batch_time=6.95976 
Train Epoch: 30 [97/125 24832/32000 (78%)] Loss: 1.88689 (QuantReg: 13.85918) QuantErr: 13.85918 batch_time=0.73903 
Train Epoch: 30 [113/125 28928/32000 (90%)] Loss: 1.58936 (QuantReg: 13.84942) QuantErr: 13.84942 batch_time=0.74788 
Train Epoch: 30 codebook_update_time=1.99348
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch30.pth ...
Done in 10.773s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 30
 loss           : 1.6438640747070312
 quant_reg      : 13.960674446105957
 quant_err      : 13.960674446105957
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.943661971830986
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.546385564980866
 MSRVTT_full_val/v2t_metrics/R1: 36.41851106639839
 MSRVTT_full_val/v2t_metrics/R5: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.96579476861167
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.93471569285136
 MSRVTT_full_test/t2v_metrics/R1: 13.812709030100335
 MSRVTT_full_test/t2v_metrics/R5: 36.55518394648829
 MSRVTT_full_test/t2v_metrics/R10: 50.06688963210702
 MSRVTT_full_test/t2v_metrics/R50: 81.73913043478261
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.43311036789298
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.348966756769215
 MSRVTT_full_test/v2t_metrics/R1: 17.157190635451506
 MSRVTT_full_test/v2t_metrics/R5: 45.618729096989966
 MSRVTT_full_test/v2t_metrics/R10: 59.197324414715716
 MSRVTT_full_test/v2t_metrics/R50: 87.19063545150502
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.387792642140468
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.91675941565048
 mnt_best       : 29.554039300327094
 not_improved_count: 2
Train Epoch: 31 [1/125 256/32000 (1%)] Loss: 1.68212 (QuantReg: 13.94982) QuantErr: 13.94982 batch_time=39.19012 
Train Epoch: 31 [17/125 4352/32000 (14%)] Loss: 1.48969 (QuantReg: 13.72672) QuantErr: 13.72672 batch_time=1.23305 
Train Epoch: 31 [33/125 8448/32000 (26%)] Loss: 1.68091 (QuantReg: 13.89290) QuantErr: 13.89290 batch_time=0.77294 
Train Epoch: 31 [49/125 12544/32000 (39%)] Loss: 1.70054 (QuantReg: 13.96504) QuantErr: 13.96504 batch_time=0.75046 
Train Epoch: 31 [65/125 16640/32000 (52%)] Loss: 1.50454 (QuantReg: 13.99962) QuantErr: 13.99962 batch_time=1.15781 
Train Epoch: 31 [81/125 20736/32000 (65%)] Loss: 1.54987 (QuantReg: 14.05998) QuantErr: 14.05998 batch_time=1.21598 
Train Epoch: 31 [97/125 24832/32000 (78%)] Loss: 1.70211 (QuantReg: 14.02545) QuantErr: 14.02545 batch_time=0.75974 
Train Epoch: 31 [113/125 28928/32000 (90%)] Loss: 1.67085 (QuantReg: 13.99919) QuantErr: 13.99919 batch_time=0.73070 
Train Epoch: 31 codebook_update_time=1.82704
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch31.pth ...
Done in 9.662s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch31.pth ...
Done in 13.710s
removing stale ckpt [epoch 30] [took 0.00s]
 epoch          : 31
 loss           : 1.6790308895111083
 quant_reg      : 13.976708381652832
 quant_err      : 13.976708381652832
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 3875
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.768611670020121
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.1453847515846
 MSRVTT_full_val/v2t_metrics/R1: 38.43058350100603
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 88.53118712273641
 MSRVTT_full_val/v2t_metrics/R50: 98.99396378269617
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.9195171026156945
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.892117901654075
 MSRVTT_full_test/t2v_metrics/R1: 13.879598662207357
 MSRVTT_full_test/t2v_metrics/R5: 38.09364548494983
 MSRVTT_full_test/t2v_metrics/R10: 51.87290969899666
 MSRVTT_full_test/t2v_metrics/R50: 82.0066889632107
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.97792642140468
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.157130676349745
 MSRVTT_full_test/v2t_metrics/R1: 17.525083612040135
 MSRVTT_full_test/v2t_metrics/R5: 45.65217391304348
 MSRVTT_full_test/v2t_metrics/R10: 59.197324414715716
 MSRVTT_full_test/v2t_metrics/R50: 87.65886287625418
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.209866220735787
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.18049852061878
 mnt_best       : 30.157130676349745
 not_improved_count: 0
Train Epoch: 32 [1/125 256/32000 (1%)] Loss: 1.42290 (QuantReg: 13.89226) QuantErr: 13.89226 batch_time=40.95595 
Train Epoch: 32 [17/125 4352/32000 (14%)] Loss: 1.71681 (QuantReg: 14.04884) QuantErr: 14.04884 batch_time=0.73582 
Train Epoch: 32 [33/125 8448/32000 (26%)] Loss: 1.32561 (QuantReg: 14.03423) QuantErr: 14.03423 batch_time=0.91661 
Train Epoch: 32 [49/125 12544/32000 (39%)] Loss: 1.42390 (QuantReg: 14.14445) QuantErr: 14.14445 batch_time=0.73096 
Train Epoch: 32 [65/125 16640/32000 (52%)] Loss: 1.57009 (QuantReg: 14.05142) QuantErr: 14.05142 batch_time=2.04619 
Train Epoch: 32 [81/125 20736/32000 (65%)] Loss: 1.70870 (QuantReg: 13.91892) QuantErr: 13.91892 batch_time=0.78574 
Train Epoch: 32 [97/125 24832/32000 (78%)] Loss: 1.64207 (QuantReg: 14.04300) QuantErr: 14.04300 batch_time=0.87256 
Train Epoch: 32 [113/125 28928/32000 (90%)] Loss: 1.54752 (QuantReg: 14.12749) QuantErr: 14.12749 batch_time=0.90617 
Train Epoch: 32 codebook_update_time=1.68461
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch32.pth ...
Done in 4.072s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 32
 loss           : 1.6388022289276123
 quant_reg      : 13.983860717773437
 quant_err      : 13.983860717773437
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 32.59557344064386
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.024144869215291
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.72094371951349
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.839034205231388
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.39985986958062
 MSRVTT_full_test/t2v_metrics/R1: 13.578595317725753
 MSRVTT_full_test/t2v_metrics/R5: 37.491638795986624
 MSRVTT_full_test/t2v_metrics/R10: 51.03678929765886
 MSRVTT_full_test/t2v_metrics/R50: 81.73913043478261
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.77742474916388
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.61812340348069
 MSRVTT_full_test/v2t_metrics/R1: 16.923076923076923
 MSRVTT_full_test/v2t_metrics/R5: 45.35117056856188
 MSRVTT_full_test/v2t_metrics/R10: 59.4314381270903
 MSRVTT_full_test/v2t_metrics/R50: 87.32441471571906
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.086789297658864
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.729589210342226
 mnt_best       : 30.157130676349745
 not_improved_count: 1
Train Epoch: 33 [1/125 256/32000 (1%)] Loss: 1.61391 (QuantReg: 14.16443) QuantErr: 14.16443 batch_time=45.31471 
Train Epoch: 33 [17/125 4352/32000 (14%)] Loss: 1.61391 (QuantReg: 13.92185) QuantErr: 13.92185 batch_time=0.74833 
Train Epoch: 33 [33/125 8448/32000 (26%)] Loss: 1.55964 (QuantReg: 14.10931) QuantErr: 14.10931 batch_time=0.85209 
Train Epoch: 33 [49/125 12544/32000 (39%)] Loss: 1.51172 (QuantReg: 14.08645) QuantErr: 14.08645 batch_time=0.73426 
Train Epoch: 33 [65/125 16640/32000 (52%)] Loss: 1.86133 (QuantReg: 13.74399) QuantErr: 13.74399 batch_time=5.54051 
Train Epoch: 33 [81/125 20736/32000 (65%)] Loss: 1.67817 (QuantReg: 14.06059) QuantErr: 14.06059 batch_time=0.75385 
Train Epoch: 33 [97/125 24832/32000 (78%)] Loss: 1.61264 (QuantReg: 14.04563) QuantErr: 14.04563 batch_time=0.76039 
Train Epoch: 33 [113/125 28928/32000 (90%)] Loss: 1.80325 (QuantReg: 13.94052) QuantErr: 13.94052 batch_time=0.76366 
Train Epoch: 33 codebook_update_time=1.76483
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch33.pth ...
Done in 22.043s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 33
 loss           : 1.6311241693496703
 quant_reg      : 14.01979695892334
 quant_err      : 14.01979695892334
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 4125
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.603621730382294
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.677549221007546
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 99.19517102615694
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.780684104627767
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.949169467725646
 MSRVTT_full_test/t2v_metrics/R1: 13.91304347826087
 MSRVTT_full_test/t2v_metrics/R5: 37.792642140468224
 MSRVTT_full_test/t2v_metrics/R10: 51.93979933110368
 MSRVTT_full_test/t2v_metrics/R50: 81.87290969899665
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.235785953177256
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.11456227602833
 MSRVTT_full_test/v2t_metrics/R1: 16.588628762541806
 MSRVTT_full_test/v2t_metrics/R5: 45.28428093645485
 MSRVTT_full_test/v2t_metrics/R10: 59.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 87.123745819398
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.327926421404683
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.51507256338745
 mnt_best       : 30.157130676349745
 not_improved_count: 2
Train Epoch: 34 [1/125 256/32000 (1%)] Loss: 1.65741 (QuantReg: 14.02847) QuantErr: 14.02847 batch_time=67.44410 
Train Epoch: 34 [17/125 4352/32000 (14%)] Loss: 1.48001 (QuantReg: 13.96968) QuantErr: 13.96968 batch_time=0.77207 
Train Epoch: 34 [33/125 8448/32000 (26%)] Loss: 1.43682 (QuantReg: 14.17159) QuantErr: 14.17159 batch_time=0.75321 
Train Epoch: 34 [49/125 12544/32000 (39%)] Loss: 1.73100 (QuantReg: 14.08591) QuantErr: 14.08591 batch_time=0.96240 
Train Epoch: 34 [65/125 16640/32000 (52%)] Loss: 1.78612 (QuantReg: 13.99058) QuantErr: 13.99058 batch_time=16.88261 
Train Epoch: 34 [81/125 20736/32000 (65%)] Loss: 1.55330 (QuantReg: 14.07964) QuantErr: 14.07964 batch_time=0.75583 
Train Epoch: 34 [97/125 24832/32000 (78%)] Loss: 1.67720 (QuantReg: 14.09897) QuantErr: 14.09897 batch_time=0.93240 
Train Epoch: 34 [113/125 28928/32000 (90%)] Loss: 1.70375 (QuantReg: 13.97654) QuantErr: 13.97654 batch_time=0.92036 
Train Epoch: 34 codebook_update_time=1.73524
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch34.pth ...
Done in 20.664s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 34
 loss           : 1.6227258930206299
 quant_reg      : 14.032693336486817
 quant_err      : 14.032693336486817
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 32.59557344064386
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.921529175050302
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.86169105515735
 MSRVTT_full_val/v2t_metrics/R1: 39.436619718309856
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 99.19517102615694
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.754527162977867
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.21323135688324
 MSRVTT_full_test/t2v_metrics/R1: 13.979933110367893
 MSRVTT_full_test/t2v_metrics/R5: 37.725752508361204
 MSRVTT_full_test/t2v_metrics/R10: 50.903010033444815
 MSRVTT_full_test/t2v_metrics/R50: 81.83946488294315
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.16588628762542
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.943012363435237
 MSRVTT_full_test/v2t_metrics/R1: 17.49163879598662
 MSRVTT_full_test/v2t_metrics/R5: 45.68561872909699
 MSRVTT_full_test/v2t_metrics/R10: 59.531772575250834
 MSRVTT_full_test/v2t_metrics/R50: 87.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.380434782608695
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.234277706054264
 mnt_best       : 30.157130676349745
 not_improved_count: 3
Train Epoch: 35 [1/125 256/32000 (1%)] Loss: 1.73204 (QuantReg: 13.94590) QuantErr: 13.94590 batch_time=53.57809 
Train Epoch: 35 [17/125 4352/32000 (14%)] Loss: 1.68577 (QuantReg: 13.91148) QuantErr: 13.91148 batch_time=0.89498 
Train Epoch: 35 [33/125 8448/32000 (26%)] Loss: 1.90132 (QuantReg: 13.93800) QuantErr: 13.93800 batch_time=0.73649 
Train Epoch: 35 [49/125 12544/32000 (39%)] Loss: 1.71538 (QuantReg: 13.94640) QuantErr: 13.94640 batch_time=0.78996 
Train Epoch: 35 [65/125 16640/32000 (52%)] Loss: 1.39712 (QuantReg: 14.18345) QuantErr: 14.18345 batch_time=10.35394 
Train Epoch: 35 [81/125 20736/32000 (65%)] Loss: 1.69391 (QuantReg: 14.15298) QuantErr: 14.15298 batch_time=0.80220 
Train Epoch: 35 [97/125 24832/32000 (78%)] Loss: 1.71715 (QuantReg: 14.02819) QuantErr: 14.02819 batch_time=0.83241 
Train Epoch: 35 [113/125 28928/32000 (90%)] Loss: 1.64874 (QuantReg: 13.91641) QuantErr: 13.91641 batch_time=0.81247 
Train Epoch: 35 codebook_update_time=1.69975
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch35.pth ...
Done in 12.337s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch35.pth ...
Done in 16.590s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 35
 loss           : 1.6188684329986571
 quant_reg      : 14.028840309143066
 quant_err      : 14.028840309143066
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 4375
 MSRVTT_full_val/t2v_metrics/R1: 35.61368209255533
 MSRVTT_full_val/t2v_metrics/R5: 70.62374245472837
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.79275653923541
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.450704225352113
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.91115360801367
 MSRVTT_full_val/v2t_metrics/R1: 37.625754527162975
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 88.53118712273641
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.883299798792756
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.38739504725432
 MSRVTT_full_test/t2v_metrics/R1: 14.214046822742475
 MSRVTT_full_test/t2v_metrics/R5: 39.063545150501675
 MSRVTT_full_test/t2v_metrics/R10: 52.474916387959865
 MSRVTT_full_test/t2v_metrics/R50: 82.80936454849498
 MSRVTT_full_test/t2v_metrics/MedR: 9.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.739799331103676
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.77138545919774
 MSRVTT_full_test/v2t_metrics/R1: 16.923076923076923
 MSRVTT_full_test/v2t_metrics/R5: 46.15384615384615
 MSRVTT_full_test/v2t_metrics/R10: 59.69899665551839
 MSRVTT_full_test/v2t_metrics/R50: 87.62541806020067
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.235785953177256
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.99300330113236
 mnt_best       : 30.77138545919774
 not_improved_count: 0
Train Epoch: 36 [1/125 256/32000 (1%)] Loss: 1.55606 (QuantReg: 14.03208) QuantErr: 14.03208 batch_time=47.19430 
Train Epoch: 36 [17/125 4352/32000 (14%)] Loss: 1.54057 (QuantReg: 14.04533) QuantErr: 14.04533 batch_time=0.82929 
Train Epoch: 36 [33/125 8448/32000 (26%)] Loss: 2.02789 (QuantReg: 13.91998) QuantErr: 13.91998 batch_time=0.86942 
Train Epoch: 36 [49/125 12544/32000 (39%)] Loss: 1.67687 (QuantReg: 13.87457) QuantErr: 13.87457 batch_time=0.98079 
Train Epoch: 36 [65/125 16640/32000 (52%)] Loss: 1.55952 (QuantReg: 14.12015) QuantErr: 14.12015 batch_time=1.48211 
Train Epoch: 36 [81/125 20736/32000 (65%)] Loss: 1.55697 (QuantReg: 14.04586) QuantErr: 14.04586 batch_time=0.77463 
Train Epoch: 36 [97/125 24832/32000 (78%)] Loss: 1.59878 (QuantReg: 14.06134) QuantErr: 14.06134 batch_time=0.91158 
Train Epoch: 36 [113/125 28928/32000 (90%)] Loss: 1.43060 (QuantReg: 14.04538) QuantErr: 14.04538 batch_time=0.99168 
Train Epoch: 36 codebook_update_time=1.64068
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch36.pth ...
Done in 9.899s
removing stale ckpt [epoch 35] [took 0.00s]
 epoch          : 36
 loss           : 1.6544981822967528
 quant_reg      : 14.028065139770508
 quant_err      : 14.028065139770508
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.937625754527163
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.35405798133832
 MSRVTT_full_val/v2t_metrics/R1: 40.241448692152915
 MSRVTT_full_val/v2t_metrics/R5: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.889336016096579
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.6404901086056
 MSRVTT_full_test/t2v_metrics/R1: 13.74581939799331
 MSRVTT_full_test/t2v_metrics/R5: 37.424749163879596
 MSRVTT_full_test/t2v_metrics/R10: 50.635451505016725
 MSRVTT_full_test/t2v_metrics/R50: 82.04013377926421
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.55484949832776
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.64340399705046
 MSRVTT_full_test/v2t_metrics/R1: 16.923076923076923
 MSRVTT_full_test/v2t_metrics/R5: 44.91638795986622
 MSRVTT_full_test/v2t_metrics/R10: 59.76588628762542
 MSRVTT_full_test/v2t_metrics/R50: 87.02341137123746
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.076421404682275
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.68172477298175
 mnt_best       : 30.77138545919774
 not_improved_count: 1
Train Epoch: 37 [1/125 256/32000 (1%)] Loss: 1.51641 (QuantReg: 14.03754) QuantErr: 14.03754 batch_time=39.19984 
Train Epoch: 37 [17/125 4352/32000 (14%)] Loss: 1.58644 (QuantReg: 13.97517) QuantErr: 13.97517 batch_time=0.89359 
Train Epoch: 37 [33/125 8448/32000 (26%)] Loss: 1.57578 (QuantReg: 14.04620) QuantErr: 14.04620 batch_time=0.78139 
Train Epoch: 37 [49/125 12544/32000 (39%)] Loss: 1.44708 (QuantReg: 14.11815) QuantErr: 14.11815 batch_time=0.74222 
Train Epoch: 37 [65/125 16640/32000 (52%)] Loss: 1.72995 (QuantReg: 13.93878) QuantErr: 13.93878 batch_time=2.38385 
Train Epoch: 37 [81/125 20736/32000 (65%)] Loss: 1.66667 (QuantReg: 13.95168) QuantErr: 13.95168 batch_time=0.83869 
Train Epoch: 37 [97/125 24832/32000 (78%)] Loss: 1.54333 (QuantReg: 14.06727) QuantErr: 14.06727 batch_time=0.95059 
Train Epoch: 37 [113/125 28928/32000 (90%)] Loss: 1.50976 (QuantReg: 14.07677) QuantErr: 14.07677 batch_time=0.80946 
Train Epoch: 37 codebook_update_time=1.83378
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch37.pth ...
Done in 3.903s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 37
 loss           : 1.6005879402160645
 quant_reg      : 14.05296922302246
 quant_err      : 14.05296922302246
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 4625
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 98.79275653923541
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.808853118712274
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.409419075536285
 MSRVTT_full_val/v2t_metrics/R1: 38.22937625754527
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 99.3963782696177
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.748490945674044
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.65538212173379
 MSRVTT_full_test/t2v_metrics/R1: 14.046822742474916
 MSRVTT_full_test/t2v_metrics/R5: 37.92642140468227
 MSRVTT_full_test/t2v_metrics/R10: 50.836120401337794
 MSRVTT_full_test/t2v_metrics/R50: 81.70568561872909
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.47157190635451
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.03060783567174
 MSRVTT_full_test/v2t_metrics/R1: 16.8561872909699
 MSRVTT_full_test/v2t_metrics/R5: 45.752508361204015
 MSRVTT_full_test/v2t_metrics/R10: 59.96655518394649
 MSRVTT_full_test/v2t_metrics/R50: 87.19063545150502
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.587290969899666
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.89448991872864
 mnt_best       : 30.77138545919774
 not_improved_count: 2
Train Epoch: 38 [1/125 256/32000 (1%)] Loss: 1.77181 (QuantReg: 13.91971) QuantErr: 13.91971 batch_time=59.63534 
Train Epoch: 38 [17/125 4352/32000 (14%)] Loss: 1.53272 (QuantReg: 14.07445) QuantErr: 14.07445 batch_time=0.79252 
Train Epoch: 38 [33/125 8448/32000 (26%)] Loss: 1.84821 (QuantReg: 13.94532) QuantErr: 13.94532 batch_time=0.74507 
Experiment directory: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256
Preparing the dataloaders ...
Loading dataset MSRVTT_full_train in ram ...
Finish loading dataset MSRVTT_full_train in ram, taking 366.2486181259155 s.
Loading dataset MSRVTT_full_val in ram ...
Finish loading dataset MSRVTT_full_val in ram, taking 44.50757122039795 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 127.13040518760681 s.
Loading dataset MSRVTT_full_test in ram ...
Finish loading dataset MSRVTT_full_test in ram, taking 64.77634572982788 s.
Training ...
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch0.pth ...
Done in 2.014s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch0.pth ...
Done in 3.536s
 epoch          : 0
 loss           : 0
 learning_rate  : 5e-05
 n_samples      : 0
 n_steps        : 0
 MSRVTT_full_val/t2v_metrics/R1: 0.0
 MSRVTT_full_val/t2v_metrics/R5: 1.2072434607645874
 MSRVTT_full_val/t2v_metrics/R10: 1.6096579476861168
 MSRVTT_full_val/t2v_metrics/R50: 8.450704225352112
 MSRVTT_full_val/t2v_metrics/MedR: 252.0
 MSRVTT_full_val/t2v_metrics/MeanR: 251.21730382293762
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_val/v2t_metrics/R1: 0.0
 MSRVTT_full_val/v2t_metrics/R5: 0.8048289738430584
 MSRVTT_full_val/v2t_metrics/R10: 2.0120724346076457
 MSRVTT_full_val/v2t_metrics/R50: 9.054325955734406
 MSRVTT_full_val/v2t_metrics/MedR: 243.0
 MSRVTT_full_val/v2t_metrics/MeanR: 247.7344064386318
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 0.0
 MSRVTT_full_test/t2v_metrics/R1: 0.033444816053511704
 MSRVTT_full_test/t2v_metrics/R5: 0.20066889632107024
 MSRVTT_full_test/t2v_metrics/R10: 0.26755852842809363
 MSRVTT_full_test/t2v_metrics/R50: 1.705685618729097
 MSRVTT_full_test/t2v_metrics/MedR: 1515.0
 MSRVTT_full_test/t2v_metrics/MeanR: 1498.5294314381272
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 0.12154652794863813
 MSRVTT_full_test/v2t_metrics/R1: 0.06688963210702341
 MSRVTT_full_test/v2t_metrics/R5: 0.16722408026755853
 MSRVTT_full_test/v2t_metrics/R10: 0.3010033444816054
 MSRVTT_full_test/v2t_metrics/R50: 1.806020066889632
 MSRVTT_full_test/v2t_metrics/MedR: 1471.5
 MSRVTT_full_test/v2t_metrics/MeanR: 1495.3260869565217
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 0.14987975740993859
 mnt_best       : 0.12154652794863813
 not_improved_count: 0
Train Epoch: 1 [1/125 256/32000 (1%)] Loss: 11.22134 (QuantReg: 22.46188) QuantErr: 22.46188 batch_time=39.20657 
Train Epoch: 1 [17/125 4352/32000 (14%)] Loss: 8.98686 (QuantReg: 22.61262) QuantErr: 22.61262 batch_time=0.94578 
Train Epoch: 1 [33/125 8448/32000 (26%)] Loss: 7.74635 (QuantReg: 22.65466) QuantErr: 22.65466 batch_time=1.18601 
Train Epoch: 1 [49/125 12544/32000 (39%)] Loss: 7.18498 (QuantReg: 22.63954) QuantErr: 22.63954 batch_time=0.76679 
Train Epoch: 1 [65/125 16640/32000 (52%)] Loss: 6.52794 (QuantReg: 22.65663) QuantErr: 22.65663 batch_time=4.16196 
Train Epoch: 1 [81/125 20736/32000 (65%)] Loss: 6.41155 (QuantReg: 22.64420) QuantErr: 22.64420 batch_time=0.73507 
Train Epoch: 1 [97/125 24832/32000 (78%)] Loss: 5.94021 (QuantReg: 22.64495) QuantErr: 22.64495 batch_time=1.33032 
Train Epoch: 1 [113/125 28928/32000 (90%)] Loss: 5.76745 (QuantReg: 22.67547) QuantErr: 22.67547 batch_time=0.86874 
Train Epoch: 1 codebook_update_time=1.79820
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch1.pth ...
Done in 3.844s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch1.pth ...
Done in 7.587s
 epoch          : 1
 loss           : 7.12170470046997
 quant_reg      : 22.627142547607423
 quant_err      : 22.627142547607423
 learning_rate  : 5e-05
 n_samples      : 32000
 n_steps        : 125
 MSRVTT_full_val/t2v_metrics/R1: 17.907444668008047
 MSRVTT_full_val/t2v_metrics/R5: 47.48490945674044
 MSRVTT_full_val/t2v_metrics/R10: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R50: 93.36016096579476
 MSRVTT_full_val/t2v_metrics/MedR: 6.0
 MSRVTT_full_val/t2v_metrics/MeanR: 15.720321931589536
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 37.572046032172075
 MSRVTT_full_val/v2t_metrics/R1: 20.523138832997986
 MSRVTT_full_val/v2t_metrics/R5: 53.92354124748491
 MSRVTT_full_val/v2t_metrics/R10: 69.21529175050301
 MSRVTT_full_val/v2t_metrics/R50: 95.37223340040241
 MSRVTT_full_val/v2t_metrics/MedR: 5.0
 MSRVTT_full_val/v2t_metrics/MeanR: 12.704225352112676
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 42.46926524516503
 MSRVTT_full_test/t2v_metrics/R1: 5.953177257525083
 MSRVTT_full_test/t2v_metrics/R5: 18.59531772575251
 MSRVTT_full_test/t2v_metrics/R10: 29.431438127090303
 MSRVTT_full_test/t2v_metrics/R50: 62.94314381270903
 MSRVTT_full_test/t2v_metrics/MedR: 29.0
 MSRVTT_full_test/t2v_metrics/MeanR: 80.84983277591974
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 14.824770096540696
 MSRVTT_full_test/v2t_metrics/R1: 6.622073578595318
 MSRVTT_full_test/v2t_metrics/R5: 22.140468227424748
 MSRVTT_full_test/v2t_metrics/R10: 33.812709030100336
 MSRVTT_full_test/v2t_metrics/R50: 68.96321070234114
 MSRVTT_full_test/v2t_metrics/MedR: 22.0
 MSRVTT_full_test/v2t_metrics/MeanR: 68.25284280936455
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 17.05114666966144
 mnt_best       : 14.824770096540696
 not_improved_count: 0
Train Epoch: 2 [1/125 256/32000 (1%)] Loss: 5.21186 (QuantReg: 11.77199) QuantErr: 11.77199 batch_time=39.67019 
Train Epoch: 2 [17/125 4352/32000 (14%)] Loss: 5.21456 (QuantReg: 12.34156) QuantErr: 12.34156 batch_time=0.88120 
Train Epoch: 2 [33/125 8448/32000 (26%)] Loss: 5.12078 (QuantReg: 12.66629) QuantErr: 12.66629 batch_time=0.83099 
Train Epoch: 2 [49/125 12544/32000 (39%)] Loss: 5.04507 (QuantReg: 13.17696) QuantErr: 13.17696 batch_time=0.73788 
Train Epoch: 2 [65/125 16640/32000 (52%)] Loss: 4.76792 (QuantReg: 13.95499) QuantErr: 13.95499 batch_time=2.70272 
Train Epoch: 2 [81/125 20736/32000 (65%)] Loss: 4.47043 (QuantReg: 14.16134) QuantErr: 14.16134 batch_time=0.75722 
Train Epoch: 2 [97/125 24832/32000 (78%)] Loss: 4.66351 (QuantReg: 14.38500) QuantErr: 14.38500 batch_time=0.84865 
Train Epoch: 2 [113/125 28928/32000 (90%)] Loss: 4.60316 (QuantReg: 15.27249) QuantErr: 15.27249 batch_time=0.74806 
Train Epoch: 2 codebook_update_time=1.64648
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch2.pth ...
Done in 4.277s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch2.pth ...
Done in 8.129s
removing stale ckpt [epoch 2] [took 0.00s]
removing stale ckpt [epoch 1] [took 0.00s]
removing stale ckpt [epoch 0] [took 0.00s]
 epoch          : 2
 loss           : 4.944092803955078
 quant_reg      : 13.665620971679688
 quant_err      : 13.665620971679688
 learning_rate  : 4.75e-05
 n_samples      : 64000
 n_steps        : 250
 MSRVTT_full_val/t2v_metrics/R1: 20.321931589537222
 MSRVTT_full_val/t2v_metrics/R5: 56.13682092555332
 MSRVTT_full_val/t2v_metrics/R10: 73.2394366197183
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 10.81287726358149
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 43.71722614214907
 MSRVTT_full_val/v2t_metrics/R1: 24.949698189134807
 MSRVTT_full_val/v2t_metrics/R5: 63.38028169014085
 MSRVTT_full_val/v2t_metrics/R10: 78.47082494969818
 MSRVTT_full_val/v2t_metrics/R50: 96.98189134808852
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 9.064386317907445
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 49.878022476656774
 MSRVTT_full_test/t2v_metrics/R1: 8.963210702341136
 MSRVTT_full_test/t2v_metrics/R5: 25.85284280936455
 MSRVTT_full_test/t2v_metrics/R10: 38.26086956521739
 MSRVTT_full_test/t2v_metrics/R50: 71.33779264214047
 MSRVTT_full_test/t2v_metrics/MedR: 18.0
 MSRVTT_full_test/t2v_metrics/MeanR: 61.0180602006689
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 20.69707225440077
 MSRVTT_full_test/v2t_metrics/R1: 9.632107023411372
 MSRVTT_full_test/v2t_metrics/R5: 29.431438127090303
 MSRVTT_full_test/v2t_metrics/R10: 42.274247491638796
 MSRVTT_full_test/v2t_metrics/R50: 76.12040133779264
 MSRVTT_full_test/v2t_metrics/MedR: 15.0
 MSRVTT_full_test/v2t_metrics/MeanR: 52.31304347826087
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 22.88422572817403
 mnt_best       : 20.69707225440077
 not_improved_count: 0
Train Epoch: 3 [1/125 256/32000 (1%)] Loss: 4.56989 (QuantReg: 11.98175) QuantErr: 11.98175 batch_time=36.40208 
Train Epoch: 3 [17/125 4352/32000 (14%)] Loss: 4.38508 (QuantReg: 12.31957) QuantErr: 12.31957 batch_time=0.73168 
Train Epoch: 3 [33/125 8448/32000 (26%)] Loss: 4.44577 (QuantReg: 12.44833) QuantErr: 12.44833 batch_time=0.83819 
Train Epoch: 3 [49/125 12544/32000 (39%)] Loss: 4.11959 (QuantReg: 12.70544) QuantErr: 12.70544 batch_time=0.82382 
Train Epoch: 3 [65/125 16640/32000 (52%)] Loss: 4.25407 (QuantReg: 12.91172) QuantErr: 12.91172 batch_time=2.49210 
Train Epoch: 3 [81/125 20736/32000 (65%)] Loss: 4.07934 (QuantReg: 13.21762) QuantErr: 13.21762 batch_time=0.80562 
Train Epoch: 3 [97/125 24832/32000 (78%)] Loss: 3.68972 (QuantReg: 13.35049) QuantErr: 13.35049 batch_time=0.75204 
Train Epoch: 3 [113/125 28928/32000 (90%)] Loss: 4.25824 (QuantReg: 13.54145) QuantErr: 13.54145 batch_time=0.81908 
Train Epoch: 3 codebook_update_time=1.66059
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch3.pth ...
Done in 3.820s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch3.pth ...
Done in 7.458s
removing stale ckpt [epoch 3] [took 0.00s]
 epoch          : 3
 loss           : 4.214698406219482
 quant_reg      : 12.89522590637207
 quant_err      : 12.89522590637207
 learning_rate  : 4.5125e-05
 n_samples      : 96000
 n_steps        : 375
 MSRVTT_full_val/t2v_metrics/R1: 25.35211267605634
 MSRVTT_full_val/t2v_metrics/R5: 61.56941649899397
 MSRVTT_full_val/t2v_metrics/R10: 75.85513078470825
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.559356136820925
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 49.104510396079476
 MSRVTT_full_val/v2t_metrics/R1: 29.175050301810867
 MSRVTT_full_val/v2t_metrics/R5: 68.81287726358148
 MSRVTT_full_val/v2t_metrics/R10: 83.09859154929578
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 8.060362173038229
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 55.050127764088245
 MSRVTT_full_test/t2v_metrics/R1: 8.996655518394649
 MSRVTT_full_test/t2v_metrics/R5: 28.160535117056856
 MSRVTT_full_test/t2v_metrics/R10: 40.5685618729097
 MSRVTT_full_test/t2v_metrics/R50: 74.61538461538461
 MSRVTT_full_test/t2v_metrics/MedR: 16.0
 MSRVTT_full_test/t2v_metrics/MeanR: 53.447826086956525
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 21.742219162297193
 MSRVTT_full_test/v2t_metrics/R1: 11.103678929765886
 MSRVTT_full_test/v2t_metrics/R5: 31.638795986622075
 MSRVTT_full_test/v2t_metrics/R10: 45.953177257525084
 MSRVTT_full_test/v2t_metrics/R50: 80.13377926421404
 MSRVTT_full_test/v2t_metrics/MedR: 12.0
 MSRVTT_full_test/v2t_metrics/MeanR: 44.33996655518395
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 25.27362065317586
 mnt_best       : 21.742219162297193
 not_improved_count: 0
Train Epoch: 4 [1/125 256/32000 (1%)] Loss: 4.26656 (QuantReg: 12.26596) QuantErr: 12.26596 batch_time=37.69283 
Train Epoch: 4 [17/125 4352/32000 (14%)] Loss: 3.78208 (QuantReg: 12.46762) QuantErr: 12.46762 batch_time=10.98621 
Train Epoch: 4 [33/125 8448/32000 (26%)] Loss: 3.59534 (QuantReg: 12.69804) QuantErr: 12.69804 batch_time=0.88164 
Train Epoch: 4 [49/125 12544/32000 (39%)] Loss: 3.77295 (QuantReg: 12.78337) QuantErr: 12.78337 batch_time=0.77152 
Train Epoch: 4 [65/125 16640/32000 (52%)] Loss: 3.92793 (QuantReg: 12.93852) QuantErr: 12.93852 batch_time=3.00448 
Train Epoch: 4 [81/125 20736/32000 (65%)] Loss: 3.97746 (QuantReg: 12.81505) QuantErr: 12.81505 batch_time=8.20824 
Train Epoch: 4 [97/125 24832/32000 (78%)] Loss: 3.44764 (QuantReg: 13.10114) QuantErr: 13.10114 batch_time=0.76676 
Train Epoch: 4 [113/125 28928/32000 (90%)] Loss: 3.43089 (QuantReg: 13.06529) QuantErr: 13.06529 batch_time=0.76075 
Train Epoch: 4 codebook_update_time=1.66739
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch4.pth ...
Done in 3.844s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch4.pth ...
Done in 8.041s
removing stale ckpt [epoch 4] [took 0.00s]
 epoch          : 4
 loss           : 3.7874321060180662
 quant_reg      : 12.81953385925293
 quant_err      : 12.81953385925293
 learning_rate  : 4.2868749999999995e-05
 n_samples      : 128000
 n_steps        : 500
 MSRVTT_full_val/t2v_metrics/R1: 28.169014084507044
 MSRVTT_full_val/t2v_metrics/R5: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R10: 77.2635814889336
 MSRVTT_full_val/t2v_metrics/R50: 96.98189134808852
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 9.022132796780683
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.394573045622224
 MSRVTT_full_val/v2t_metrics/R1: 30.18108651911469
 MSRVTT_full_val/v2t_metrics/R5: 71.0261569416499
 MSRVTT_full_val/v2t_metrics/R10: 82.29376257545272
 MSRVTT_full_val/v2t_metrics/R50: 97.58551307847083
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.893360160965795
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.084136212686424
 MSRVTT_full_test/t2v_metrics/R1: 9.464882943143813
 MSRVTT_full_test/t2v_metrics/R5: 29.297658862876254
 MSRVTT_full_test/t2v_metrics/R10: 42.508361204013376
 MSRVTT_full_test/t2v_metrics/R50: 76.75585284280936
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 47.964548494983276
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 22.758353683117218
 MSRVTT_full_test/v2t_metrics/R1: 12.341137123745819
 MSRVTT_full_test/v2t_metrics/R5: 34.71571906354515
 MSRVTT_full_test/v2t_metrics/R10: 48.69565217391305
 MSRVTT_full_test/v2t_metrics/R50: 82.07357859531773
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.07759197324415
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.529004697174866
 mnt_best       : 22.758353683117218
 not_improved_count: 0
Train Epoch: 5 [1/125 256/32000 (1%)] Loss: 3.56435 (QuantReg: 12.44653) QuantErr: 12.44653 batch_time=37.05913 
Train Epoch: 5 [17/125 4352/32000 (14%)] Loss: 3.49995 (QuantReg: 12.79310) QuantErr: 12.79310 batch_time=0.75670 
Train Epoch: 5 [33/125 8448/32000 (26%)] Loss: 3.22854 (QuantReg: 12.86845) QuantErr: 12.86845 batch_time=0.87699 
Train Epoch: 5 [49/125 12544/32000 (39%)] Loss: 3.21373 (QuantReg: 12.78412) QuantErr: 12.78412 batch_time=0.84699 
Train Epoch: 5 [65/125 16640/32000 (52%)] Loss: 3.09911 (QuantReg: 13.06060) QuantErr: 13.06060 batch_time=2.28266 
Train Epoch: 5 [81/125 20736/32000 (65%)] Loss: 3.30309 (QuantReg: 13.06666) QuantErr: 13.06666 batch_time=0.95475 
Train Epoch: 5 [97/125 24832/32000 (78%)] Loss: 3.14402 (QuantReg: 12.97140) QuantErr: 12.97140 batch_time=0.75192 
Train Epoch: 5 [113/125 28928/32000 (90%)] Loss: 3.58648 (QuantReg: 13.33518) QuantErr: 13.33518 batch_time=0.74616 
Train Epoch: 5 codebook_update_time=1.66415
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch5.pth ...
Done in 3.741s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch5.pth ...
Done in 7.721s
removing stale ckpt [epoch 5] [took 0.00s]
 epoch          : 5
 loss           : 3.414145818710327
 quant_reg      : 13.009403526306153
 quant_err      : 13.009403526306153
 learning_rate  : 4.072531249999999e-05
 n_samples      : 160000
 n_steps        : 625
 MSRVTT_full_val/t2v_metrics/R1: 27.364185110663986
 MSRVTT_full_val/t2v_metrics/R5: 62.374245472837025
 MSRVTT_full_val/t2v_metrics/R10: 76.05633802816901
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 4.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.967806841046277
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 50.63386491369052
 MSRVTT_full_val/v2t_metrics/R1: 31.388329979879277
 MSRVTT_full_val/v2t_metrics/R5: 70.4225352112676
 MSRVTT_full_val/v2t_metrics/R10: 82.49496981891348
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 7.17907444668008
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 56.706883210064035
 MSRVTT_full_test/t2v_metrics/R1: 10.40133779264214
 MSRVTT_full_test/t2v_metrics/R5: 29.23076923076923
 MSRVTT_full_test/t2v_metrics/R10: 42.94314381270903
 MSRVTT_full_test/t2v_metrics/R50: 77.72575250836121
 MSRVTT_full_test/t2v_metrics/MedR: 14.0
 MSRVTT_full_test/t2v_metrics/MeanR: 48.53745819397993
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 23.547298730568162
 MSRVTT_full_test/v2t_metrics/R1: 12.173913043478262
 MSRVTT_full_test/v2t_metrics/R5: 35.05016722408027
 MSRVTT_full_test/v2t_metrics/R10: 49.49832775919732
 MSRVTT_full_test/v2t_metrics/R50: 83.31103678929766
 MSRVTT_full_test/v2t_metrics/MedR: 11.0
 MSRVTT_full_test/v2t_metrics/MeanR: 38.29197324414716
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 27.64205152971584
 mnt_best       : 23.547298730568162
 not_improved_count: 0
Train Epoch: 6 [1/125 256/32000 (1%)] Loss: 3.38436 (QuantReg: 12.78809) QuantErr: 12.78809 batch_time=42.51968 
Train Epoch: 6 [17/125 4352/32000 (14%)] Loss: 3.42154 (QuantReg: 12.80726) QuantErr: 12.80726 batch_time=4.54429 
Train Epoch: 6 [33/125 8448/32000 (26%)] Loss: 3.44249 (QuantReg: 12.98632) QuantErr: 12.98632 batch_time=0.76866 
Train Epoch: 6 [49/125 12544/32000 (39%)] Loss: 2.95373 (QuantReg: 13.30221) QuantErr: 13.30221 batch_time=0.86678 
Train Epoch: 6 [65/125 16640/32000 (52%)] Loss: 3.48899 (QuantReg: 12.93325) QuantErr: 12.93325 batch_time=1.98789 
Train Epoch: 6 [81/125 20736/32000 (65%)] Loss: 3.08131 (QuantReg: 13.31856) QuantErr: 13.31856 batch_time=3.34381 
Train Epoch: 6 [97/125 24832/32000 (78%)] Loss: 3.09166 (QuantReg: 13.51982) QuantErr: 13.51982 batch_time=0.78855 
Train Epoch: 6 [113/125 28928/32000 (90%)] Loss: 2.82371 (QuantReg: 13.49463) QuantErr: 13.49463 batch_time=0.74999 
Train Epoch: 6 codebook_update_time=1.77740
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch6.pth ...
Done in 17.050s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch6.pth ...
Done in 20.790s
removing stale ckpt [epoch 6] [took 0.00s]
 epoch          : 6
 loss           : 3.162008642196655
 quant_reg      : 13.03935897064209
 quant_err      : 13.03935897064209
 learning_rate  : 3.868904687499999e-05
 n_samples      : 192000
 n_steps        : 750
 MSRVTT_full_val/t2v_metrics/R1: 28.772635814889338
 MSRVTT_full_val/t2v_metrics/R5: 61.3682092555332
 MSRVTT_full_val/t2v_metrics/R10: 78.47082494969818
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.732394366197184
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.74603833084819
 MSRVTT_full_val/v2t_metrics/R1: 33.601609657947684
 MSRVTT_full_val/v2t_metrics/R5: 70.22132796780684
 MSRVTT_full_val/v2t_metrics/R10: 84.50704225352112
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.839034205231388
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.42167540626314
 MSRVTT_full_test/t2v_metrics/R1: 10.568561872909699
 MSRVTT_full_test/t2v_metrics/R5: 30.63545150501672
 MSRVTT_full_test/t2v_metrics/R10: 44.5819397993311
 MSRVTT_full_test/t2v_metrics/R50: 79.1304347826087
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.41438127090301
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.34817307719467
 MSRVTT_full_test/v2t_metrics/R1: 12.876254180602007
 MSRVTT_full_test/v2t_metrics/R5: 37.725752508361204
 MSRVTT_full_test/v2t_metrics/R10: 51.97324414715719
 MSRVTT_full_test/v2t_metrics/R50: 84.38127090301003
 MSRVTT_full_test/v2t_metrics/MedR: 10.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.68043478260869
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.336103299829873
 mnt_best       : 24.34817307719467
 not_improved_count: 0
Train Epoch: 7 [1/125 256/32000 (1%)] Loss: 2.65910 (QuantReg: 12.79456) QuantErr: 12.79456 batch_time=41.82828 
Train Epoch: 7 [17/125 4352/32000 (14%)] Loss: 2.76224 (QuantReg: 12.94311) QuantErr: 12.94311 batch_time=0.75208 
Train Epoch: 7 [33/125 8448/32000 (26%)] Loss: 3.26003 (QuantReg: 13.01853) QuantErr: 13.01853 batch_time=0.76359 
Train Epoch: 7 [49/125 12544/32000 (39%)] Loss: 3.21922 (QuantReg: 13.19448) QuantErr: 13.19448 batch_time=0.75091 
Train Epoch: 7 [65/125 16640/32000 (52%)] Loss: 2.92725 (QuantReg: 13.11774) QuantErr: 13.11774 batch_time=3.68479 
Train Epoch: 7 [81/125 20736/32000 (65%)] Loss: 2.99469 (QuantReg: 13.21366) QuantErr: 13.21366 batch_time=0.73902 
Train Epoch: 7 [97/125 24832/32000 (78%)] Loss: 2.90670 (QuantReg: 13.25217) QuantErr: 13.25217 batch_time=0.86713 
Train Epoch: 7 [113/125 28928/32000 (90%)] Loss: 2.72104 (QuantReg: 13.13455) QuantErr: 13.13455 batch_time=0.89094 
Train Epoch: 7 codebook_update_time=1.70350
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch7.pth ...
Done in 10.743s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch7.pth ...
Done in 25.227s
removing stale ckpt [epoch 7] [took 0.00s]
 epoch          : 7
 loss           : 2.976426305770874
 quant_reg      : 13.126849670410156
 quant_err      : 13.126849670410156
 learning_rate  : 3.675459453124999e-05
 n_samples      : 224000
 n_steps        : 875
 MSRVTT_full_val/t2v_metrics/R1: 28.571428571428573
 MSRVTT_full_val/t2v_metrics/R5: 61.971830985915496
 MSRVTT_full_val/t2v_metrics/R10: 78.67203219315896
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.967806841046277
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 51.838077188152404
 MSRVTT_full_val/v2t_metrics/R1: 33.80281690140845
 MSRVTT_full_val/v2t_metrics/R5: 72.63581488933602
 MSRVTT_full_val/v2t_metrics/R10: 84.90945674044265
 MSRVTT_full_val/v2t_metrics/R50: 97.78672032193158
 MSRVTT_full_val/v2t_metrics/MedR: 3.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.979879275653923
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 59.29525250229181
 MSRVTT_full_test/t2v_metrics/R1: 10.96989966555184
 MSRVTT_full_test/t2v_metrics/R5: 31.97324414715719
 MSRVTT_full_test/t2v_metrics/R10: 44.88294314381271
 MSRVTT_full_test/t2v_metrics/R50: 78.26086956521739
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.75752508361204
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.062452235739904
 MSRVTT_full_test/v2t_metrics/R1: 13.411371237458194
 MSRVTT_full_test/v2t_metrics/R5: 38.26086956521739
 MSRVTT_full_test/v2t_metrics/R10: 52.240802675585286
 MSRVTT_full_test/v2t_metrics/R50: 84.64882943143813
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 34.780602006688966
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 29.928109709450307
 mnt_best       : 25.062452235739904
 not_improved_count: 0
Train Epoch: 8 [1/125 256/32000 (1%)] Loss: 2.97162 (QuantReg: 13.14156) QuantErr: 13.14156 batch_time=48.47927 
Train Epoch: 8 [17/125 4352/32000 (14%)] Loss: 2.84997 (QuantReg: 13.02657) QuantErr: 13.02657 batch_time=2.72327 
Train Epoch: 8 [33/125 8448/32000 (26%)] Loss: 2.79355 (QuantReg: 12.80705) QuantErr: 12.80705 batch_time=0.92976 
Train Epoch: 8 [49/125 12544/32000 (39%)] Loss: 3.04708 (QuantReg: 12.92851) QuantErr: 12.92851 batch_time=0.76795 
Train Epoch: 8 [65/125 16640/32000 (52%)] Loss: 2.99254 (QuantReg: 13.03808) QuantErr: 13.03808 batch_time=6.95750 
Train Epoch: 8 [81/125 20736/32000 (65%)] Loss: 3.02072 (QuantReg: 13.14801) QuantErr: 13.14801 batch_time=2.60796 
Train Epoch: 8 [97/125 24832/32000 (78%)] Loss: 2.71894 (QuantReg: 13.11927) QuantErr: 13.11927 batch_time=0.73901 
Train Epoch: 8 [113/125 28928/32000 (90%)] Loss: 2.75020 (QuantReg: 13.05408) QuantErr: 13.05408 batch_time=0.92340 
Train Epoch: 8 codebook_update_time=1.74064
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch8.pth ...
Done in 3.657s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch8.pth ...
Done in 7.227s
removing stale ckpt [epoch 8] [took 0.00s]
 epoch          : 8
 loss           : 2.7871152629852296
 quant_reg      : 13.150903244018554
 quant_err      : 13.150903244018554
 learning_rate  : 3.4916864804687486e-05
 n_samples      : 256000
 n_steps        : 1000
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 64.58752515090544
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.987927565392354
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.40918151348864
 MSRVTT_full_val/v2t_metrics/R1: 35.61368209255533
 MSRVTT_full_val/v2t_metrics/R5: 73.2394366197183
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.126760563380282
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.88233677981203
 MSRVTT_full_test/t2v_metrics/R1: 11.638795986622073
 MSRVTT_full_test/t2v_metrics/R5: 32.97658862876254
 MSRVTT_full_test/t2v_metrics/R10: 47.05685618729097
 MSRVTT_full_test/t2v_metrics/R50: 80.5351170568562
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.54515050167224
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 26.236882506491042
 MSRVTT_full_test/v2t_metrics/R1: 13.846153846153847
 MSRVTT_full_test/v2t_metrics/R5: 38.66220735785953
 MSRVTT_full_test/v2t_metrics/R10: 53.7123745819398
 MSRVTT_full_test/v2t_metrics/R50: 85.48494983277592
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.1257525083612
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 30.635858178445346
 mnt_best       : 26.236882506491042
 not_improved_count: 0
Train Epoch: 9 [1/125 256/32000 (1%)] Loss: 3.06239 (QuantReg: 12.95770) QuantErr: 12.95770 batch_time=46.75037 
Train Epoch: 9 [17/125 4352/32000 (14%)] Loss: 3.09374 (QuantReg: 13.04815) QuantErr: 13.04815 batch_time=0.77717 
Train Epoch: 9 [33/125 8448/32000 (26%)] Loss: 2.78579 (QuantReg: 13.30294) QuantErr: 13.30294 batch_time=1.51661 
Train Epoch: 9 [49/125 12544/32000 (39%)] Loss: 2.65629 (QuantReg: 13.16641) QuantErr: 13.16641 batch_time=0.76004 
Train Epoch: 9 [65/125 16640/32000 (52%)] Loss: 2.74266 (QuantReg: 13.04513) QuantErr: 13.04513 batch_time=7.14166 
Train Epoch: 9 [81/125 20736/32000 (65%)] Loss: 2.69304 (QuantReg: 13.30696) QuantErr: 13.30696 batch_time=0.75040 
Train Epoch: 9 [97/125 24832/32000 (78%)] Loss: 2.62903 (QuantReg: 13.33737) QuantErr: 13.33737 batch_time=1.46428 
Train Epoch: 9 [113/125 28928/32000 (90%)] Loss: 2.48593 (QuantReg: 13.32668) QuantErr: 13.32668 batch_time=0.91529 
Train Epoch: 9 codebook_update_time=1.75366
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch9.pth ...
Done in 3.570s
removing stale ckpt [epoch 9] [took 0.00s]
 epoch          : 9
 loss           : 2.657047325134277
 quant_reg      : 13.259191780090331
 quant_err      : 13.259191780090331
 learning_rate  : 3.317102156445311e-05
 n_samples      : 288000
 n_steps        : 1125
 MSRVTT_full_val/t2v_metrics/R1: 30.985915492957748
 MSRVTT_full_val/t2v_metrics/R5: 65.19114688128772
 MSRVTT_full_val/t2v_metrics/R10: 78.06841046277665
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.331991951710261
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.026823020189234
 MSRVTT_full_val/v2t_metrics/R1: 33.40040241448692
 MSRVTT_full_val/v2t_metrics/R5: 71.83098591549296
 MSRVTT_full_val/v2t_metrics/R10: 84.10462776659959
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.674044265593562
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 58.65357300890189
 MSRVTT_full_test/t2v_metrics/R1: 11.070234113712374
 MSRVTT_full_test/t2v_metrics/R5: 33.87959866220736
 MSRVTT_full_test/t2v_metrics/R10: 46.15384615384615
 MSRVTT_full_test/t2v_metrics/R50: 78.79598662207358
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 46.06722408026756
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.8682859795124
 MSRVTT_full_test/v2t_metrics/R1: 14.414715719063546
 MSRVTT_full_test/v2t_metrics/R5: 38.561872909699
 MSRVTT_full_test/v2t_metrics/R10: 54.5819397993311
 MSRVTT_full_test/v2t_metrics/R50: 84.94983277591973
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.95685618729097
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.18921103655304
 mnt_best       : 26.236882506491042
 not_improved_count: 1
Train Epoch: 10 [1/125 256/32000 (1%)] Loss: 2.86900 (QuantReg: 12.86818) QuantErr: 12.86818 batch_time=36.06474 
Train Epoch: 10 [17/125 4352/32000 (14%)] Loss: 2.68093 (QuantReg: 13.16669) QuantErr: 13.16669 batch_time=0.75503 
Train Epoch: 10 [33/125 8448/32000 (26%)] Loss: 2.10976 (QuantReg: 12.97365) QuantErr: 12.97365 batch_time=0.80960 
Train Epoch: 10 [49/125 12544/32000 (39%)] Loss: 2.45312 (QuantReg: 13.17625) QuantErr: 13.17625 batch_time=1.17440 
Train Epoch: 10 [65/125 16640/32000 (52%)] Loss: 2.59879 (QuantReg: 13.35075) QuantErr: 13.35075 batch_time=0.99557 
Train Epoch: 10 [81/125 20736/32000 (65%)] Loss: 2.45460 (QuantReg: 13.22851) QuantErr: 13.22851 batch_time=0.85968 
Train Epoch: 10 [97/125 24832/32000 (78%)] Loss: 2.75444 (QuantReg: 13.26907) QuantErr: 13.26907 batch_time=0.76317 
Train Epoch: 10 [113/125 28928/32000 (90%)] Loss: 2.75551 (QuantReg: 13.32358) QuantErr: 13.32358 batch_time=1.34058 
Train Epoch: 10 codebook_update_time=1.89441
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch10.pth ...
Done in 3.779s
removing stale ckpt [epoch 10] [took 0.00s]
 epoch          : 10
 loss           : 2.539417579650879
 quant_reg      : 13.291521789550782
 quant_err      : 13.291521789550782
 learning_rate  : 3.151247048623045e-05
 n_samples      : 320000
 n_steps        : 1250
 MSRVTT_full_val/t2v_metrics/R1: 30.382293762575454
 MSRVTT_full_val/t2v_metrics/R5: 63.17907444668008
 MSRVTT_full_val/t2v_metrics/R10: 79.67806841046277
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.388329979879277
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 53.478293247811685
 MSRVTT_full_val/v2t_metrics/R1: 35.814889336016094
 MSRVTT_full_val/v2t_metrics/R5: 74.24547283702213
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.742454728370221
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.131965465297
 MSRVTT_full_test/t2v_metrics/R1: 11.137123745819398
 MSRVTT_full_test/t2v_metrics/R5: 32.675585284280935
 MSRVTT_full_test/t2v_metrics/R10: 45.752508361204015
 MSRVTT_full_test/t2v_metrics/R50: 79.06354515050167
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.297658862876254
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 25.535073359751394
 MSRVTT_full_test/v2t_metrics/R1: 14.816053511705686
 MSRVTT_full_test/v2t_metrics/R5: 39.69899665551839
 MSRVTT_full_test/v2t_metrics/R10: 53.7123745819398
 MSRVTT_full_test/v2t_metrics/R50: 85.31772575250837
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.21839464882943
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.61274006606095
 mnt_best       : 26.236882506491042
 not_improved_count: 2
Train Epoch: 11 [1/125 256/32000 (1%)] Loss: 2.55988 (QuantReg: 13.21829) QuantErr: 13.21829 batch_time=59.71601 
Train Epoch: 11 [17/125 4352/32000 (14%)] Loss: 2.20920 (QuantReg: 13.31472) QuantErr: 13.31472 batch_time=3.49748 
Train Epoch: 11 [33/125 8448/32000 (26%)] Loss: 2.10394 (QuantReg: 13.63039) QuantErr: 13.63039 batch_time=0.92384 
Train Epoch: 11 [49/125 12544/32000 (39%)] Loss: 2.40242 (QuantReg: 13.41568) QuantErr: 13.41568 batch_time=0.73753 
Train Epoch: 11 [65/125 16640/32000 (52%)] Loss: 2.31237 (QuantReg: 13.43983) QuantErr: 13.43983 batch_time=11.58851 
Train Epoch: 11 [81/125 20736/32000 (65%)] Loss: 2.16257 (QuantReg: 13.44294) QuantErr: 13.44294 batch_time=3.21352 
Train Epoch: 11 [97/125 24832/32000 (78%)] Loss: 2.34264 (QuantReg: 13.63794) QuantErr: 13.63794 batch_time=0.95866 
Train Epoch: 11 [113/125 28928/32000 (90%)] Loss: 2.53670 (QuantReg: 13.37396) QuantErr: 13.37396 batch_time=0.73645 
Train Epoch: 11 codebook_update_time=1.70016
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch11.pth ...
Done in 3.807s
removing stale ckpt [epoch 11] [took 0.09s]
 epoch          : 11
 loss           : 2.4100657787323
 quant_reg      : 13.360765968322754
 quant_err      : 13.360765968322754
 learning_rate  : 2.993684696191893e-05
 n_samples      : 352000
 n_steps        : 1375
 MSRVTT_full_val/t2v_metrics/R1: 28.772635814889338
 MSRVTT_full_val/t2v_metrics/R5: 64.58752515090544
 MSRVTT_full_val/t2v_metrics/R10: 79.87927565392354
 MSRVTT_full_val/t2v_metrics/R50: 96.78068410462777
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.028169014084508
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 52.948557972439616
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 74.04426559356136
 MSRVTT_full_val/v2t_metrics/R10: 85.51307847082495
 MSRVTT_full_val/v2t_metrics/R50: 98.18913480885311
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.350100603621731
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.208729152177625
 MSRVTT_full_test/t2v_metrics/R1: 10.501672240802675
 MSRVTT_full_test/t2v_metrics/R5: 31.672240802675585
 MSRVTT_full_test/t2v_metrics/R10: 44.8494983277592
 MSRVTT_full_test/t2v_metrics/R50: 78.8628762541806
 MSRVTT_full_test/t2v_metrics/MedR: 13.0
 MSRVTT_full_test/t2v_metrics/MeanR: 45.77391304347826
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 24.616800912040688
 MSRVTT_full_test/v2t_metrics/R1: 14.11371237458194
 MSRVTT_full_test/v2t_metrics/R5: 39.66555183946488
 MSRVTT_full_test/v2t_metrics/R10: 53.91304347826087
 MSRVTT_full_test/v2t_metrics/R50: 84.58193979933111
 MSRVTT_full_test/v2t_metrics/MedR: 9.0
 MSRVTT_full_test/v2t_metrics/MeanR: 33.790468227424746
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.135047849312382
 mnt_best       : 26.236882506491042
 not_improved_count: 3
Train Epoch: 12 [1/125 256/32000 (1%)] Loss: 2.42050 (QuantReg: 13.13348) QuantErr: 13.13348 batch_time=37.89850 
Train Epoch: 12 [17/125 4352/32000 (14%)] Loss: 2.61922 (QuantReg: 13.34245) QuantErr: 13.34245 batch_time=0.75730 
Train Epoch: 12 [33/125 8448/32000 (26%)] Loss: 2.05962 (QuantReg: 13.49205) QuantErr: 13.49205 batch_time=0.87550 
Train Epoch: 12 [49/125 12544/32000 (39%)] Loss: 2.41152 (QuantReg: 13.39932) QuantErr: 13.39932 batch_time=0.90029 
Train Epoch: 12 [65/125 16640/32000 (52%)] Loss: 2.37514 (QuantReg: 13.53620) QuantErr: 13.53620 batch_time=1.46538 
Train Epoch: 12 [81/125 20736/32000 (65%)] Loss: 2.23634 (QuantReg: 13.52458) QuantErr: 13.52458 batch_time=0.75142 
Train Epoch: 12 [97/125 24832/32000 (78%)] Loss: 2.37673 (QuantReg: 13.42593) QuantErr: 13.42593 batch_time=0.75167 
Train Epoch: 12 [113/125 28928/32000 (90%)] Loss: 2.33082 (QuantReg: 13.38109) QuantErr: 13.38109 batch_time=0.74585 
Train Epoch: 12 codebook_update_time=1.74229
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch12.pth ...
Done in 3.727s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch12.pth ...
Done in 7.517s
removing stale ckpt [epoch 12] [took 0.00s]
 epoch          : 12
 loss           : 2.351352560997009
 quant_reg      : 13.417943977355957
 quant_err      : 13.417943977355957
 learning_rate  : 2.844000461382298e-05
 n_samples      : 384000
 n_steps        : 1500
 MSRVTT_full_val/t2v_metrics/R1: 30.18108651911469
 MSRVTT_full_val/t2v_metrics/R5: 65.59356136820925
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.772635814889336
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 54.57159139258155
 MSRVTT_full_val/v2t_metrics/R1: 34.00402414486921
 MSRVTT_full_val/v2t_metrics/R5: 74.44668008048289
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.7565392354124745
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 60.37182944105579
 MSRVTT_full_test/t2v_metrics/R1: 11.97324414715719
 MSRVTT_full_test/t2v_metrics/R5: 34.5819397993311
 MSRVTT_full_test/t2v_metrics/R10: 47.558528428093645
 MSRVTT_full_test/t2v_metrics/R50: 80.33444816053512
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.96889632107023
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.004109826422667
 MSRVTT_full_test/v2t_metrics/R1: 14.280936454849499
 MSRVTT_full_test/v2t_metrics/R5: 41.103678929765884
 MSRVTT_full_test/v2t_metrics/R10: 55.11705685618729
 MSRVTT_full_test/v2t_metrics/R50: 86.12040133779264
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.81438127090301
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 31.864550768010847
 mnt_best       : 27.004109826422667
 not_improved_count: 0
Train Epoch: 13 [1/125 256/32000 (1%)] Loss: 2.33187 (QuantReg: 13.50914) QuantErr: 13.50914 batch_time=48.83573 
Train Epoch: 13 [17/125 4352/32000 (14%)] Loss: 2.04971 (QuantReg: 13.39210) QuantErr: 13.39210 batch_time=0.95275 
Train Epoch: 13 [33/125 8448/32000 (26%)] Loss: 2.40874 (QuantReg: 13.54152) QuantErr: 13.54152 batch_time=0.87843 
Train Epoch: 13 [49/125 12544/32000 (39%)] Loss: 2.24089 (QuantReg: 13.48107) QuantErr: 13.48107 batch_time=0.89150 
Train Epoch: 13 [65/125 16640/32000 (52%)] Loss: 2.28328 (QuantReg: 13.18745) QuantErr: 13.18745 batch_time=8.15813 
Train Epoch: 13 [81/125 20736/32000 (65%)] Loss: 2.63259 (QuantReg: 13.35830) QuantErr: 13.35830 batch_time=0.85649 
Train Epoch: 13 [97/125 24832/32000 (78%)] Loss: 2.32445 (QuantReg: 13.51176) QuantErr: 13.51176 batch_time=0.76683 
Train Epoch: 13 [113/125 28928/32000 (90%)] Loss: 2.38799 (QuantReg: 13.60891) QuantErr: 13.60891 batch_time=0.77850 
Train Epoch: 13 codebook_update_time=1.69624
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch13.pth ...
Done in 9.663s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch13.pth ...
Done in 13.528s
removing stale ckpt [epoch 13] [took 0.00s]
 epoch          : 13
 loss           : 2.2731000270843507
 quant_reg      : 13.488464920043945
 quant_err      : 13.488464920043945
 learning_rate  : 2.7018004383131832e-05
 n_samples      : 416000
 n_steps        : 1625
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.6519114688128775
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.24919272639527
 MSRVTT_full_val/v2t_metrics/R1: 35.814889336016094
 MSRVTT_full_val/v2t_metrics/R5: 75.25150905432595
 MSRVTT_full_val/v2t_metrics/R10: 85.91549295774648
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.9738430583501
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.406843107385086
 MSRVTT_full_test/t2v_metrics/R1: 12.274247491638796
 MSRVTT_full_test/t2v_metrics/R5: 34.68227424749164
 MSRVTT_full_test/t2v_metrics/R10: 47.458193979933114
 MSRVTT_full_test/t2v_metrics/R50: 80.8361204013378
 MSRVTT_full_test/t2v_metrics/MedR: 12.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.20200668896321
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.235658729538784
 MSRVTT_full_test/v2t_metrics/R1: 14.51505016722408
 MSRVTT_full_test/v2t_metrics/R5: 41.03678929765886
 MSRVTT_full_test/v2t_metrics/R10: 56.68896321070234
 MSRVTT_full_test/v2t_metrics/R50: 86.0200668896321
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 30.432441471571906
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.3218946159779
 mnt_best       : 27.235658729538784
 not_improved_count: 0
Train Epoch: 14 [1/125 256/32000 (1%)] Loss: 2.10333 (QuantReg: 13.49851) QuantErr: 13.49851 batch_time=38.34023 
Train Epoch: 14 [17/125 4352/32000 (14%)] Loss: 2.31082 (QuantReg: 13.23415) QuantErr: 13.23415 batch_time=0.78062 
Train Epoch: 14 [33/125 8448/32000 (26%)] Loss: 2.29499 (QuantReg: 13.43507) QuantErr: 13.43507 batch_time=0.88974 
Train Epoch: 14 [49/125 12544/32000 (39%)] Loss: 2.26375 (QuantReg: 13.48636) QuantErr: 13.48636 batch_time=0.75240 
Train Epoch: 14 [65/125 16640/32000 (52%)] Loss: 2.44182 (QuantReg: 13.62775) QuantErr: 13.62775 batch_time=2.61349 
Train Epoch: 14 [81/125 20736/32000 (65%)] Loss: 2.36940 (QuantReg: 13.54488) QuantErr: 13.54488 batch_time=0.77968 
Train Epoch: 14 [97/125 24832/32000 (78%)] Loss: 2.06067 (QuantReg: 13.41710) QuantErr: 13.41710 batch_time=0.75648 
Train Epoch: 14 [113/125 28928/32000 (90%)] Loss: 2.04906 (QuantReg: 13.63879) QuantErr: 13.63879 batch_time=0.85913 
Train Epoch: 14 codebook_update_time=1.73921
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch14.pth ...
Done in 3.798s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch14.pth ...
Done in 7.928s
removing stale ckpt [epoch 14] [took 0.00s]
 epoch          : 14
 loss           : 2.212415168762207
 quant_reg      : 13.526489524841308
 quant_err      : 13.526489524841308
 learning_rate  : 2.566710416397524e-05
 n_samples      : 448000
 n_steps        : 1750
 MSRVTT_full_val/t2v_metrics/R1: 31.790744466800806
 MSRVTT_full_val/t2v_metrics/R5: 66.39839034205231
 MSRVTT_full_val/t2v_metrics/R10: 80.48289738430583
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.955734406438632
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 55.3843781658773
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 88.32997987927565
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.774647887323944
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.17072133841844
 MSRVTT_full_test/t2v_metrics/R1: 12.675585284280936
 MSRVTT_full_test/t2v_metrics/R5: 34.8494983277592
 MSRVTT_full_test/t2v_metrics/R10: 48.06020066889632
 MSRVTT_full_test/t2v_metrics/R50: 81.07023411371237
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.98461538461538
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.689601827458226
 MSRVTT_full_test/v2t_metrics/R1: 14.749163879598662
 MSRVTT_full_test/v2t_metrics/R5: 42.541806020066886
 MSRVTT_full_test/v2t_metrics/R10: 56.75585284280937
 MSRVTT_full_test/v2t_metrics/R50: 86.65551839464882
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.32441471571906
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 32.90015868889642
 mnt_best       : 27.689601827458226
 not_improved_count: 0
Train Epoch: 15 [1/125 256/32000 (1%)] Loss: 2.50985 (QuantReg: 13.21621) QuantErr: 13.21621 batch_time=54.80839 
Train Epoch: 15 [17/125 4352/32000 (14%)] Loss: 2.17909 (QuantReg: 13.26431) QuantErr: 13.26431 batch_time=0.77803 
Train Epoch: 15 [33/125 8448/32000 (26%)] Loss: 2.11949 (QuantReg: 13.32649) QuantErr: 13.32649 batch_time=0.74628 
Train Epoch: 15 [49/125 12544/32000 (39%)] Loss: 1.96287 (QuantReg: 13.48161) QuantErr: 13.48161 batch_time=1.80152 
Train Epoch: 15 [65/125 16640/32000 (52%)] Loss: 1.99651 (QuantReg: 13.42059) QuantErr: 13.42059 batch_time=13.86759 
Train Epoch: 15 [81/125 20736/32000 (65%)] Loss: 2.02987 (QuantReg: 13.60085) QuantErr: 13.60085 batch_time=0.77881 
Train Epoch: 15 [97/125 24832/32000 (78%)] Loss: 2.09648 (QuantReg: 13.63208) QuantErr: 13.63208 batch_time=0.76083 
Train Epoch: 15 [113/125 28928/32000 (90%)] Loss: 1.89911 (QuantReg: 13.67863) QuantErr: 13.67863 batch_time=1.73595 
Train Epoch: 15 codebook_update_time=1.75614
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch15.pth ...
Done in 11.748s
removing stale ckpt [epoch 15] [took 0.95s]
 epoch          : 15
 loss           : 2.139866475105286
 quant_reg      : 13.499765548706055
 quant_err      : 13.499765548706055
 learning_rate  : 2.4383748955776477e-05
 n_samples      : 480000
 n_steps        : 1875
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 68.2092555331992
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.006036217303823
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.56069402780417
 MSRVTT_full_val/v2t_metrics/R1: 34.60764587525151
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.723340040241449
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.093277700288105
 MSRVTT_full_test/t2v_metrics/R1: 12.274247491638796
 MSRVTT_full_test/t2v_metrics/R5: 34.71571906354515
 MSRVTT_full_test/t2v_metrics/R10: 48.12709030100334
 MSRVTT_full_test/t2v_metrics/R50: 80.5351170568562
 MSRVTT_full_test/t2v_metrics/MedR: 11.5
 MSRVTT_full_test/t2v_metrics/MeanR: 44.05936454849498
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.371812029886964
 MSRVTT_full_test/v2t_metrics/R1: 15.953177257525084
 MSRVTT_full_test/v2t_metrics/R5: 41.90635451505017
 MSRVTT_full_test/v2t_metrics/R10: 56.32107023411371
 MSRVTT_full_test/v2t_metrics/R50: 86.82274247491638
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 31.442140468227425
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.517065704455405
 mnt_best       : 27.689601827458226
 not_improved_count: 1
Train Epoch: 16 [1/125 256/32000 (1%)] Loss: 2.06303 (QuantReg: 13.47079) QuantErr: 13.47079 batch_time=46.33420 
Train Epoch: 16 [17/125 4352/32000 (14%)] Loss: 2.15650 (QuantReg: 13.43416) QuantErr: 13.43416 batch_time=0.78984 
Train Epoch: 16 [33/125 8448/32000 (26%)] Loss: 1.93030 (QuantReg: 13.60502) QuantErr: 13.60502 batch_time=0.85394 
Train Epoch: 16 [49/125 12544/32000 (39%)] Loss: 1.78277 (QuantReg: 13.52702) QuantErr: 13.52702 batch_time=0.75249 
Train Epoch: 16 [65/125 16640/32000 (52%)] Loss: 1.99588 (QuantReg: 13.55496) QuantErr: 13.55496 batch_time=8.92136 
Train Epoch: 16 [81/125 20736/32000 (65%)] Loss: 2.07905 (QuantReg: 13.64021) QuantErr: 13.64021 batch_time=0.78486 
Train Epoch: 16 [97/125 24832/32000 (78%)] Loss: 1.91037 (QuantReg: 13.93704) QuantErr: 13.93704 batch_time=0.76610 
Train Epoch: 16 [113/125 28928/32000 (90%)] Loss: 1.91753 (QuantReg: 13.44263) QuantErr: 13.44263 batch_time=0.76246 
Train Epoch: 16 codebook_update_time=1.78158
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch16.pth ...
Done in 20.639s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch16.pth ...
Done in 24.362s
removing stale ckpt [epoch 16] [took 0.00s]
 epoch          : 16
 loss           : 2.0787034835815428
 quant_reg      : 13.57663848876953
 quant_err      : 13.57663848876953
 learning_rate  : 2.3164561507987653e-05
 n_samples      : 512000
 n_steps        : 2000
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 68.2092555331992
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.9195171026156945
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.35102835814928
 MSRVTT_full_val/v2t_metrics/R1: 37.02213279678068
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 88.73239436619718
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.859154929577465
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.09432245032559
 MSRVTT_full_test/t2v_metrics/R1: 12.775919732441471
 MSRVTT_full_test/t2v_metrics/R5: 35.18394648829432
 MSRVTT_full_test/t2v_metrics/R10: 49.03010033444816
 MSRVTT_full_test/t2v_metrics/R50: 81.80602006688963
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.12307692307692
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.03710508171455
 MSRVTT_full_test/v2t_metrics/R1: 15.752508361204013
 MSRVTT_full_test/v2t_metrics/R5: 43.11036789297659
 MSRVTT_full_test/v2t_metrics/R10: 57.290969899665555
 MSRVTT_full_test/v2t_metrics/R50: 87.3913043478261
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.930434782608696
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.88487392912189
 mnt_best       : 28.03710508171455
 not_improved_count: 0
Train Epoch: 17 [1/125 256/32000 (1%)] Loss: 1.97212 (QuantReg: 13.44636) QuantErr: 13.44636 batch_time=50.47307 
Train Epoch: 17 [17/125 4352/32000 (14%)] Loss: 1.92452 (QuantReg: 13.59351) QuantErr: 13.59351 batch_time=7.40166 
Train Epoch: 17 [33/125 8448/32000 (26%)] Loss: 1.92164 (QuantReg: 13.51311) QuantErr: 13.51311 batch_time=1.90184 
Train Epoch: 17 [49/125 12544/32000 (39%)] Loss: 2.30105 (QuantReg: 13.68033) QuantErr: 13.68033 batch_time=0.74749 
Train Epoch: 17 [65/125 16640/32000 (52%)] Loss: 2.00664 (QuantReg: 13.84996) QuantErr: 13.84996 batch_time=4.07224 
Train Epoch: 17 [81/125 20736/32000 (65%)] Loss: 1.93277 (QuantReg: 13.71432) QuantErr: 13.71432 batch_time=4.92145 
Train Epoch: 17 [97/125 24832/32000 (78%)] Loss: 2.00555 (QuantReg: 13.59595) QuantErr: 13.59595 batch_time=2.07330 
Train Epoch: 17 [113/125 28928/32000 (90%)] Loss: 1.85708 (QuantReg: 13.76159) QuantErr: 13.76159 batch_time=0.78802 
Train Epoch: 17 codebook_update_time=1.79178
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch17.pth ...
Done in 3.758s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch17.pth ...
Done in 7.461s
removing stale ckpt [epoch 17] [took 0.00s]
 epoch          : 17
 loss           : 1.997726245880127
 quant_reg      : 13.634037361145019
 quant_err      : 13.634037361145019
 learning_rate  : 2.2006333432588268e-05
 n_samples      : 544000
 n_steps        : 2125
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.627766599597585
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.500367813842026
 MSRVTT_full_val/v2t_metrics/R1: 36.61971830985915
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 89.93963782696177
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.783702213279678
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.20404983897965
 MSRVTT_full_test/t2v_metrics/R1: 12.909698996655518
 MSRVTT_full_test/t2v_metrics/R5: 37.123745819397996
 MSRVTT_full_test/t2v_metrics/R10: 50.10033444816054
 MSRVTT_full_test/t2v_metrics/R50: 81.43812709030101
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.59632107023411
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.849359612080256
 MSRVTT_full_test/v2t_metrics/R1: 15.618729096989966
 MSRVTT_full_test/v2t_metrics/R5: 43.24414715719063
 MSRVTT_full_test/v2t_metrics/R10: 58.52842809364549
 MSRVTT_full_test/v2t_metrics/R50: 87.45819397993311
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.217558528428093
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.06538459024694
 mnt_best       : 28.849359612080256
 not_improved_count: 0
Train Epoch: 18 [1/125 256/32000 (1%)] Loss: 2.27171 (QuantReg: 13.43532) QuantErr: 13.43532 batch_time=47.53438 
Train Epoch: 18 [17/125 4352/32000 (14%)] Loss: 2.08587 (QuantReg: 13.42957) QuantErr: 13.42957 batch_time=0.95906 
Train Epoch: 18 [33/125 8448/32000 (26%)] Loss: 2.03163 (QuantReg: 13.60437) QuantErr: 13.60437 batch_time=1.42417 
Train Epoch: 18 [49/125 12544/32000 (39%)] Loss: 2.05431 (QuantReg: 13.68778) QuantErr: 13.68778 batch_time=0.74521 
Train Epoch: 18 [65/125 16640/32000 (52%)] Loss: 1.90965 (QuantReg: 13.76745) QuantErr: 13.76745 batch_time=8.68595 
Train Epoch: 18 [81/125 20736/32000 (65%)] Loss: 2.06310 (QuantReg: 13.64002) QuantErr: 13.64002 batch_time=0.76146 
Train Epoch: 18 [97/125 24832/32000 (78%)] Loss: 1.93963 (QuantReg: 13.75740) QuantErr: 13.75740 batch_time=1.35197 
Train Epoch: 18 [113/125 28928/32000 (90%)] Loss: 1.97963 (QuantReg: 13.86246) QuantErr: 13.86246 batch_time=0.75890 
Train Epoch: 18 codebook_update_time=1.68978
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch18.pth ...
Done in 14.741s
removing stale ckpt [epoch 18] [took 0.00s]
 epoch          : 18
 loss           : 1.9664590902328491
 quant_reg      : 13.656531997680665
 quant_err      : 13.656531997680665
 learning_rate  : 2.0906016760958855e-05
 n_samples      : 576000
 n_steps        : 2250
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.758551307847083
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.05579152840914
 MSRVTT_full_val/v2t_metrics/R1: 34.80885311871227
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.175050301810865
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 61.475462007600825
 MSRVTT_full_test/t2v_metrics/R1: 13.210702341137123
 MSRVTT_full_test/t2v_metrics/R5: 35.719063545150505
 MSRVTT_full_test/t2v_metrics/R10: 49.93311036789298
 MSRVTT_full_test/t2v_metrics/R50: 81.57190635451505
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.81923076923077
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.66849296364275
 MSRVTT_full_test/v2t_metrics/R1: 16.65551839464883
 MSRVTT_full_test/v2t_metrics/R5: 42.97658862876254
 MSRVTT_full_test/v2t_metrics/R10: 57.85953177257525
 MSRVTT_full_test/v2t_metrics/R50: 86.98996655518394
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.121739130434783
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.59831933964735
 mnt_best       : 28.849359612080256
 not_improved_count: 1
Train Epoch: 19 [1/125 256/32000 (1%)] Loss: 1.88280 (QuantReg: 13.44551) QuantErr: 13.44551 batch_time=43.94798 
Train Epoch: 19 [17/125 4352/32000 (14%)] Loss: 1.85317 (QuantReg: 13.65724) QuantErr: 13.65724 batch_time=0.87109 
Train Epoch: 19 [33/125 8448/32000 (26%)] Loss: 1.72043 (QuantReg: 13.58656) QuantErr: 13.58656 batch_time=0.75065 
Train Epoch: 19 [49/125 12544/32000 (39%)] Loss: 1.72219 (QuantReg: 13.58233) QuantErr: 13.58233 batch_time=0.88387 
Train Epoch: 19 [65/125 16640/32000 (52%)] Loss: 2.15049 (QuantReg: 13.46101) QuantErr: 13.46101 batch_time=5.87605 
Train Epoch: 19 [81/125 20736/32000 (65%)] Loss: 1.98868 (QuantReg: 13.81953) QuantErr: 13.81953 batch_time=0.76427 
Train Epoch: 19 [97/125 24832/32000 (78%)] Loss: 1.64462 (QuantReg: 13.79147) QuantErr: 13.79147 batch_time=0.74609 
Train Epoch: 19 [113/125 28928/32000 (90%)] Loss: 1.96811 (QuantReg: 13.76028) QuantErr: 13.76028 batch_time=0.75623 
Train Epoch: 19 codebook_update_time=1.63618
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch19.pth ...
Done in 24.380s
removing stale ckpt [epoch 19] [took 0.00s]
 epoch          : 19
 loss           : 1.9335513830184936
 quant_reg      : 13.69672386932373
 quant_err      : 13.69672386932373
 learning_rate  : 1.986071592291091e-05
 n_samples      : 608000
 n_steps        : 2375
 MSRVTT_full_val/t2v_metrics/R1: 32.99798792756539
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.981891348088531
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.54579113256531
 MSRVTT_full_val/v2t_metrics/R1: 37.02213279678068
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.8631790744466805
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.5037262106486
 MSRVTT_full_test/t2v_metrics/R1: 12.474916387959865
 MSRVTT_full_test/t2v_metrics/R5: 35.65217391304348
 MSRVTT_full_test/t2v_metrics/R10: 48.99665551839465
 MSRVTT_full_test/t2v_metrics/R50: 81.00334448160535
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.38729096989967
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 27.931656901056336
 MSRVTT_full_test/v2t_metrics/R1: 16.220735785953178
 MSRVTT_full_test/v2t_metrics/R5: 43.27759197324415
 MSRVTT_full_test/v2t_metrics/R10: 57.69230769230769
 MSRVTT_full_test/v2t_metrics/R50: 87.55852842809365
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.73896321070234
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.3413357130815
 mnt_best       : 28.849359612080256
 not_improved_count: 2
Train Epoch: 20 [1/125 256/32000 (1%)] Loss: 1.62561 (QuantReg: 13.50475) QuantErr: 13.50475 batch_time=61.16456 
Train Epoch: 20 [17/125 4352/32000 (14%)] Loss: 2.06880 (QuantReg: 13.70219) QuantErr: 13.70219 batch_time=0.82238 
Train Epoch: 20 [33/125 8448/32000 (26%)] Loss: 1.67896 (QuantReg: 13.86868) QuantErr: 13.86868 batch_time=0.76420 
Train Epoch: 20 [49/125 12544/32000 (39%)] Loss: 1.68607 (QuantReg: 14.01292) QuantErr: 14.01292 batch_time=0.91601 
Train Epoch: 20 [65/125 16640/32000 (52%)] Loss: 2.04692 (QuantReg: 13.88981) QuantErr: 13.88981 batch_time=17.22920 
Train Epoch: 20 [81/125 20736/32000 (65%)] Loss: 1.97954 (QuantReg: 13.68754) QuantErr: 13.68754 batch_time=0.89709 
Train Epoch: 20 [97/125 24832/32000 (78%)] Loss: 1.70452 (QuantReg: 13.82246) QuantErr: 13.82246 batch_time=0.88942 
Train Epoch: 20 [113/125 28928/32000 (90%)] Loss: 1.96203 (QuantReg: 13.89271) QuantErr: 13.89271 batch_time=0.85892 
Train Epoch: 20 codebook_update_time=1.72149
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch20.pth ...
Done in 9.230s
removing stale ckpt [epoch 20] [took 0.00s]
 epoch          : 20
 loss           : 1.8928457040786744
 quant_reg      : 13.726667442321776
 quant_err      : 13.726667442321776
 learning_rate  : 1.8867680126765363e-05
 n_samples      : 640000
 n_steps        : 2500
 MSRVTT_full_val/t2v_metrics/R1: 33.80281690140845
 MSRVTT_full_val/t2v_metrics/R5: 68.00804828973843
 MSRVTT_full_val/t2v_metrics/R10: 80.28169014084507
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.913480885311872
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.93463889399778
 MSRVTT_full_val/v2t_metrics/R1: 36.21730382293762
 MSRVTT_full_val/v2t_metrics/R5: 76.86116700201207
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.002012072434607
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.36173643016318
 MSRVTT_full_test/t2v_metrics/R1: 12.94314381270903
 MSRVTT_full_test/t2v_metrics/R5: 35.785953177257525
 MSRVTT_full_test/t2v_metrics/R10: 49.130434782608695
 MSRVTT_full_test/t2v_metrics/R50: 80.73578595317726
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.34080267558529
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.337899636839406
 MSRVTT_full_test/v2t_metrics/R1: 15.719063545150501
 MSRVTT_full_test/v2t_metrics/R5: 43.01003344481605
 MSRVTT_full_test/v2t_metrics/R10: 57.357859531772576
 MSRVTT_full_test/v2t_metrics/R50: 87.25752508361204
 MSRVTT_full_test/v2t_metrics/MedR: 8.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.010535117056858
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 33.847749273656774
 mnt_best       : 28.849359612080256
 not_improved_count: 3
Train Epoch: 21 [1/125 256/32000 (1%)] Loss: 1.68658 (QuantReg: 13.67121) QuantErr: 13.67121 batch_time=53.40129 
Train Epoch: 21 [17/125 4352/32000 (14%)] Loss: 1.64418 (QuantReg: 13.97068) QuantErr: 13.97068 batch_time=0.94982 
Train Epoch: 21 [33/125 8448/32000 (26%)] Loss: 1.81472 (QuantReg: 13.60456) QuantErr: 13.60456 batch_time=0.92226 
Train Epoch: 21 [49/125 12544/32000 (39%)] Loss: 2.04699 (QuantReg: 13.83082) QuantErr: 13.83082 batch_time=0.75311 
Train Epoch: 21 [65/125 16640/32000 (52%)] Loss: 1.92393 (QuantReg: 13.74644) QuantErr: 13.74644 batch_time=7.06498 
Train Epoch: 21 [81/125 20736/32000 (65%)] Loss: 1.91206 (QuantReg: 13.76449) QuantErr: 13.76449 batch_time=0.74595 
Train Epoch: 21 [97/125 24832/32000 (78%)] Loss: 1.53483 (QuantReg: 13.74615) QuantErr: 13.74615 batch_time=0.78519 
Train Epoch: 21 [113/125 28928/32000 (90%)] Loss: 1.90110 (QuantReg: 13.85935) QuantErr: 13.85935 batch_time=0.87943 
Train Epoch: 21 codebook_update_time=1.66027
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch21.pth ...
Done in 3.641s
removing stale ckpt [epoch 21] [took 0.00s]
 epoch          : 21
 loss           : 1.863599594116211
 quant_reg      : 13.753848625183105
 quant_err      : 13.753848625183105
 learning_rate  : 1.7924296120427095e-05
 n_samples      : 672000
 n_steps        : 2625
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 80.0804828973843
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.851106639839034
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.492257971683294
 MSRVTT_full_val/v2t_metrics/R1: 39.839034205231385
 MSRVTT_full_val/v2t_metrics/R5: 74.64788732394366
 MSRVTT_full_val/v2t_metrics/R10: 86.11670020120724
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.012072434607646
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.50450973671561
 MSRVTT_full_test/t2v_metrics/R1: 13.110367892976589
 MSRVTT_full_test/t2v_metrics/R5: 35.819397993311036
 MSRVTT_full_test/t2v_metrics/R10: 49.83277591973244
 MSRVTT_full_test/t2v_metrics/R50: 81.23745819397993
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.535451505016724
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.60329600157451
 MSRVTT_full_test/v2t_metrics/R1: 15.852842809364548
 MSRVTT_full_test/v2t_metrics/R5: 43.24414715719063
 MSRVTT_full_test/v2t_metrics/R10: 57.92642140468227
 MSRVTT_full_test/v2t_metrics/R50: 87.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.286789297658864
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.116965508161584
 mnt_best       : 28.849359612080256
 not_improved_count: 4
Train Epoch: 22 [1/125 256/32000 (1%)] Loss: 1.95428 (QuantReg: 13.75676) QuantErr: 13.75676 batch_time=56.01786 
Train Epoch: 22 [17/125 4352/32000 (14%)] Loss: 1.75128 (QuantReg: 13.45392) QuantErr: 13.45392 batch_time=0.75657 
Train Epoch: 22 [33/125 8448/32000 (26%)] Loss: 1.97639 (QuantReg: 13.76750) QuantErr: 13.76750 batch_time=0.75609 
Train Epoch: 22 [49/125 12544/32000 (39%)] Loss: 1.89493 (QuantReg: 13.59683) QuantErr: 13.59683 batch_time=0.90973 
Train Epoch: 22 [65/125 16640/32000 (52%)] Loss: 1.36841 (QuantReg: 13.73163) QuantErr: 13.73163 batch_time=11.04700 
Train Epoch: 22 [81/125 20736/32000 (65%)] Loss: 2.12036 (QuantReg: 13.75212) QuantErr: 13.75212 batch_time=0.92408 
Train Epoch: 22 [97/125 24832/32000 (78%)] Loss: 1.71544 (QuantReg: 13.72785) QuantErr: 13.72785 batch_time=0.75313 
Train Epoch: 22 [113/125 28928/32000 (90%)] Loss: 1.80785 (QuantReg: 13.77794) QuantErr: 13.77794 batch_time=0.77997 
Train Epoch: 22 codebook_update_time=1.72947
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch22.pth ...
Done in 3.610s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch22.pth ...
Done in 7.260s
removing stale ckpt [epoch 22] [took 0.00s]
 epoch          : 22
 loss           : 1.8008504219055175
 quant_reg      : 13.77790397644043
 quant_err      : 13.77790397644043
 learning_rate  : 1.702808131440574e-05
 n_samples      : 704000
 n_steps        : 2750
 MSRVTT_full_val/t2v_metrics/R1: 34.20523138832998
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 82.49496981891348
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.52112676056338
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.850350818648636
 MSRVTT_full_val/v2t_metrics/R1: 36.82092555331992
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 87.92756539235413
 MSRVTT_full_val/v2t_metrics/R50: 98.99396378269617
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.597585513078471
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.788819662776774
 MSRVTT_full_test/t2v_metrics/R1: 13.110367892976589
 MSRVTT_full_test/t2v_metrics/R5: 36.95652173913044
 MSRVTT_full_test/t2v_metrics/R10: 50.468227424749166
 MSRVTT_full_test/t2v_metrics/R50: 82.47491638795987
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 39.03076923076923
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.025163397358973
 MSRVTT_full_test/v2t_metrics/R1: 16.05351170568562
 MSRVTT_full_test/v2t_metrics/R5: 43.84615384615385
 MSRVTT_full_test/v2t_metrics/R10: 59.297658862876254
 MSRVTT_full_test/v2t_metrics/R50: 87.1571906354515
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 27.920066889632107
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 34.68803509384862
 mnt_best       : 29.025163397358973
 not_improved_count: 0
Train Epoch: 23 [1/125 256/32000 (1%)] Loss: 1.84178 (QuantReg: 13.67409) QuantErr: 13.67409 batch_time=48.30666 
Train Epoch: 23 [17/125 4352/32000 (14%)] Loss: 1.84937 (QuantReg: 13.78347) QuantErr: 13.78347 batch_time=0.91062 
Train Epoch: 23 [33/125 8448/32000 (26%)] Loss: 1.99362 (QuantReg: 13.59422) QuantErr: 13.59422 batch_time=0.75910 
Train Epoch: 23 [49/125 12544/32000 (39%)] Loss: 1.81719 (QuantReg: 13.68710) QuantErr: 13.68710 batch_time=0.76853 
Train Epoch: 23 [65/125 16640/32000 (52%)] Loss: 1.52766 (QuantReg: 13.78804) QuantErr: 13.78804 batch_time=5.53104 
Train Epoch: 23 [81/125 20736/32000 (65%)] Loss: 1.84179 (QuantReg: 13.93334) QuantErr: 13.93334 batch_time=0.74974 
Train Epoch: 23 [97/125 24832/32000 (78%)] Loss: 1.80689 (QuantReg: 13.69412) QuantErr: 13.69412 batch_time=0.74991 
Train Epoch: 23 [113/125 28928/32000 (90%)] Loss: 1.77666 (QuantReg: 13.87916) QuantErr: 13.87916 batch_time=0.75459 
Train Epoch: 23 codebook_update_time=1.72171
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch23.pth ...
Done in 11.188s
removing stale ckpt [epoch 23] [took 0.00s]
 epoch          : 23
 loss           : 1.8215296897888185
 quant_reg      : 13.776388648986817
 quant_err      : 13.776388648986817
 learning_rate  : 1.6176677248685452e-05
 n_samples      : 736000
 n_steps        : 2875
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 67.80684104627767
 MSRVTT_full_val/t2v_metrics/R10: 83.09859154929578
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.583501006036217
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.42166121000518
 MSRVTT_full_val/v2t_metrics/R1: 37.82696177062374
 MSRVTT_full_val/v2t_metrics/R5: 75.45271629778672
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.617706237424548
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.12451006909437
 MSRVTT_full_test/t2v_metrics/R1: 13.043478260869565
 MSRVTT_full_test/t2v_metrics/R5: 36.020066889632105
 MSRVTT_full_test/t2v_metrics/R10: 49.79933110367893
 MSRVTT_full_test/t2v_metrics/R50: 81.90635451505017
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.15183946488294
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.601390511430726
 MSRVTT_full_test/v2t_metrics/R1: 17.190635451505017
 MSRVTT_full_test/v2t_metrics/R5: 43.27759197324415
 MSRVTT_full_test/v2t_metrics/R10: 58.66220735785953
 MSRVTT_full_test/v2t_metrics/R50: 87.35785953177258
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.142809364548494
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.20771227825261
 mnt_best       : 29.025163397358973
 not_improved_count: 1
Train Epoch: 24 [1/125 256/32000 (1%)] Loss: 1.90755 (QuantReg: 13.65254) QuantErr: 13.65254 batch_time=41.85394 
Train Epoch: 24 [17/125 4352/32000 (14%)] Loss: 1.89669 (QuantReg: 13.77505) QuantErr: 13.77505 batch_time=0.76508 
Train Epoch: 24 [33/125 8448/32000 (26%)] Loss: 1.79570 (QuantReg: 13.91344) QuantErr: 13.91344 batch_time=0.74726 
Train Epoch: 24 [49/125 12544/32000 (39%)] Loss: 1.57820 (QuantReg: 13.85937) QuantErr: 13.85937 batch_time=0.76211 
Train Epoch: 24 [65/125 16640/32000 (52%)] Loss: 1.73915 (QuantReg: 13.83104) QuantErr: 13.83104 batch_time=3.76076 
Train Epoch: 24 [81/125 20736/32000 (65%)] Loss: 1.87251 (QuantReg: 13.46058) QuantErr: 13.46058 batch_time=0.85959 
Train Epoch: 24 [97/125 24832/32000 (78%)] Loss: 1.44500 (QuantReg: 13.90953) QuantErr: 13.90953 batch_time=0.95251 
Train Epoch: 24 [113/125 28928/32000 (90%)] Loss: 1.48277 (QuantReg: 13.83261) QuantErr: 13.83261 batch_time=0.78836 
Train Epoch: 24 codebook_update_time=1.68015
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch24.pth ...
Done in 10.817s
removing stale ckpt [epoch 24] [took 0.00s]
 epoch          : 24
 loss           : 1.7683615121841432
 quant_reg      : 13.793629859924316
 quant_err      : 13.793629859924316
 learning_rate  : 1.5367843386251178e-05
 n_samples      : 768000
 n_steps        : 3000
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 70.82494969818913
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.553319919517103
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.78720262037449
 MSRVTT_full_val/v2t_metrics/R1: 38.028169014084504
 MSRVTT_full_val/v2t_metrics/R5: 78.67203219315896
 MSRVTT_full_val/v2t_metrics/R10: 88.32997987927565
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.609657947686117
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.17186165233501
 MSRVTT_full_test/t2v_metrics/R1: 12.876254180602007
 MSRVTT_full_test/t2v_metrics/R5: 36.58862876254181
 MSRVTT_full_test/t2v_metrics/R10: 50.33444816053512
 MSRVTT_full_test/t2v_metrics/R50: 82.24080267558529
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.42675585284281
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.729870086003025
 MSRVTT_full_test/v2t_metrics/R1: 16.722408026755854
 MSRVTT_full_test/v2t_metrics/R5: 44.78260869565217
 MSRVTT_full_test/v2t_metrics/R10: 58.69565217391305
 MSRVTT_full_test/v2t_metrics/R50: 87.65886287625418
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.27458193979933
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.29160250542898
 mnt_best       : 29.025163397358973
 not_improved_count: 2
Train Epoch: 25 [1/125 256/32000 (1%)] Loss: 2.14944 (QuantReg: 13.83877) QuantErr: 13.83877 batch_time=51.04468 
Train Epoch: 25 [17/125 4352/32000 (14%)] Loss: 1.92050 (QuantReg: 13.86018) QuantErr: 13.86018 batch_time=0.75687 
Train Epoch: 25 [33/125 8448/32000 (26%)] Loss: 1.58054 (QuantReg: 13.93644) QuantErr: 13.93644 batch_time=0.73586 
Train Epoch: 25 [49/125 12544/32000 (39%)] Loss: 1.91213 (QuantReg: 13.92571) QuantErr: 13.92571 batch_time=0.76403 
Train Epoch: 25 [65/125 16640/32000 (52%)] Loss: 1.70794 (QuantReg: 13.90573) QuantErr: 13.90573 batch_time=9.56409 
Train Epoch: 25 [81/125 20736/32000 (65%)] Loss: 1.89041 (QuantReg: 13.88267) QuantErr: 13.88267 batch_time=0.76808 
Train Epoch: 25 [97/125 24832/32000 (78%)] Loss: 1.93080 (QuantReg: 13.69051) QuantErr: 13.69051 batch_time=0.87468 
Train Epoch: 25 [113/125 28928/32000 (90%)] Loss: 1.66777 (QuantReg: 13.93767) QuantErr: 13.93767 batch_time=0.74592 
Train Epoch: 25 codebook_update_time=1.64558
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch25.pth ...
Done in 10.628s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch25.pth ...
Done in 14.186s
removing stale ckpt [epoch 25] [took 0.04s]
 epoch          : 25
 loss           : 1.7757736387252807
 quant_reg      : 13.834847961425782
 quant_err      : 13.834847961425782
 learning_rate  : 1.4599451216938618e-05
 n_samples      : 800000
 n_steps        : 3125
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.645875251509055
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.47866665801108
 MSRVTT_full_val/v2t_metrics/R1: 41.4486921529175
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 86.51911468812877
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.663983903420523
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.85141202649724
 MSRVTT_full_test/t2v_metrics/R1: 13.578595317725753
 MSRVTT_full_test/t2v_metrics/R5: 36.48829431438127
 MSRVTT_full_test/t2v_metrics/R10: 49.59866220735786
 MSRVTT_full_test/t2v_metrics/R50: 82.0066889632107
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.3190635451505
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.073196932652966
 MSRVTT_full_test/v2t_metrics/R1: 17.525083612040135
 MSRVTT_full_test/v2t_metrics/R5: 44.013377926421406
 MSRVTT_full_test/v2t_metrics/R10: 58.862876254180605
 MSRVTT_full_test/v2t_metrics/R50: 87.1571906354515
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.407023411371238
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.6748448492853
 mnt_best       : 29.073196932652966
 not_improved_count: 0
Train Epoch: 26 [1/125 256/32000 (1%)] Loss: 1.75528 (QuantReg: 13.89924) QuantErr: 13.89924 batch_time=44.47937 
Train Epoch: 26 [17/125 4352/32000 (14%)] Loss: 1.78106 (QuantReg: 13.71524) QuantErr: 13.71524 batch_time=0.77400 
Train Epoch: 26 [33/125 8448/32000 (26%)] Loss: 1.73541 (QuantReg: 13.93842) QuantErr: 13.93842 batch_time=0.77815 
Train Epoch: 26 [49/125 12544/32000 (39%)] Loss: 1.67811 (QuantReg: 14.00923) QuantErr: 14.00923 batch_time=0.92031 
Train Epoch: 26 [65/125 16640/32000 (52%)] Loss: 1.43267 (QuantReg: 13.85236) QuantErr: 13.85236 batch_time=4.87926 
Train Epoch: 26 [81/125 20736/32000 (65%)] Loss: 1.89111 (QuantReg: 13.75782) QuantErr: 13.75782 batch_time=0.92929 
Train Epoch: 26 [97/125 24832/32000 (78%)] Loss: 1.59867 (QuantReg: 13.99536) QuantErr: 13.99536 batch_time=0.75634 
Train Epoch: 26 [113/125 28928/32000 (90%)] Loss: 1.77325 (QuantReg: 14.12392) QuantErr: 14.12392 batch_time=0.88601 
Train Epoch: 26 codebook_update_time=2.21939
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch26.pth ...
Done in 19.814s
removing stale ckpt [epoch 26] [took 0.02s]
 epoch          : 26
 loss           : 1.7445583086013794
 quant_reg      : 13.869452484130859
 quant_err      : 13.869452484130859
 learning_rate  : 1.3869478656091687e-05
 n_samples      : 832000
 n_steps        : 3250
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 68.61167002012073
 MSRVTT_full_val/t2v_metrics/R10: 82.49496981891348
 MSRVTT_full_val/t2v_metrics/R50: 99.19517102615694
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.5875251509054324
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.73669561270337
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 97.98792756539235
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.824949698189135
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.02649544546896
 MSRVTT_full_test/t2v_metrics/R1: 12.94314381270903
 MSRVTT_full_test/t2v_metrics/R5: 36.020066889632105
 MSRVTT_full_test/t2v_metrics/R10: 49.86622073578595
 MSRVTT_full_test/t2v_metrics/R50: 81.40468227424749
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.58862876254181
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.540631764768868
 MSRVTT_full_test/v2t_metrics/R1: 16.622073578595316
 MSRVTT_full_test/v2t_metrics/R5: 43.979933110367895
 MSRVTT_full_test/v2t_metrics/R10: 58.929765886287626
 MSRVTT_full_test/v2t_metrics/R50: 87.09030100334448
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.837123745819397
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.0556609803844
 mnt_best       : 29.073196932652966
 not_improved_count: 1
Train Epoch: 27 [1/125 256/32000 (1%)] Loss: 1.76445 (QuantReg: 13.96985) QuantErr: 13.96985 batch_time=50.57529 
Train Epoch: 27 [17/125 4352/32000 (14%)] Loss: 1.59142 (QuantReg: 13.98640) QuantErr: 13.98640 batch_time=0.85019 
Train Epoch: 27 [33/125 8448/32000 (26%)] Loss: 1.67605 (QuantReg: 13.97738) QuantErr: 13.97738 batch_time=0.85156 
Train Epoch: 27 [49/125 12544/32000 (39%)] Loss: 1.73554 (QuantReg: 13.96126) QuantErr: 13.96126 batch_time=0.75782 
Train Epoch: 27 [65/125 16640/32000 (52%)] Loss: 1.89066 (QuantReg: 13.93734) QuantErr: 13.93734 batch_time=4.44033 
Train Epoch: 27 [81/125 20736/32000 (65%)] Loss: 1.42735 (QuantReg: 13.93203) QuantErr: 13.93203 batch_time=0.76623 
Train Epoch: 27 [97/125 24832/32000 (78%)] Loss: 1.63662 (QuantReg: 13.81920) QuantErr: 13.81920 batch_time=0.80023 
Train Epoch: 27 [113/125 28928/32000 (90%)] Loss: 1.78241 (QuantReg: 13.99331) QuantErr: 13.99331 batch_time=0.74666 
Train Epoch: 27 codebook_update_time=1.80587
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch27.pth ...
Done in 21.572s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch27.pth ...
Done in 25.297s
removing stale ckpt [epoch 27] [took 0.01s]
 epoch          : 27
 loss           : 1.7154794912338256
 quant_reg      : 13.887841606140137
 quant_err      : 13.887841606140137
 learning_rate  : 1.3176004723287102e-05
 n_samples      : 864000
 n_steps        : 3375
 MSRVTT_full_val/t2v_metrics/R1: 32.99798792756539
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.317907444668008
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.012653428436074
 MSRVTT_full_val/v2t_metrics/R1: 37.02213279678068
 MSRVTT_full_val/v2t_metrics/R5: 76.65995975855131
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.766599597585513
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.910051481649845
 MSRVTT_full_test/t2v_metrics/R1: 13.812709030100335
 MSRVTT_full_test/t2v_metrics/R5: 37.424749163879596
 MSRVTT_full_test/t2v_metrics/R10: 50.10033444816054
 MSRVTT_full_test/t2v_metrics/R50: 81.17056856187291
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.36471571906355
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.586445713982496
 MSRVTT_full_test/v2t_metrics/R1: 17.05685618729097
 MSRVTT_full_test/v2t_metrics/R5: 43.779264214046826
 MSRVTT_full_test/v2t_metrics/R10: 58.39464882943144
 MSRVTT_full_test/v2t_metrics/R50: 87.25752508361204
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.869230769230768
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.1976362706028
 mnt_best       : 29.586445713982496
 not_improved_count: 0
Train Epoch: 28 [1/125 256/32000 (1%)] Loss: 1.62094 (QuantReg: 13.79082) QuantErr: 13.79082 batch_time=54.58499 
Train Epoch: 28 [17/125 4352/32000 (14%)] Loss: 1.70202 (QuantReg: 13.79827) QuantErr: 13.79827 batch_time=0.74511 
Train Epoch: 28 [33/125 8448/32000 (26%)] Loss: 1.67673 (QuantReg: 13.94488) QuantErr: 13.94488 batch_time=0.89994 
Train Epoch: 28 [49/125 12544/32000 (39%)] Loss: 1.32808 (QuantReg: 13.90035) QuantErr: 13.90035 batch_time=0.88073 
Train Epoch: 28 [65/125 16640/32000 (52%)] Loss: 1.63224 (QuantReg: 13.93083) QuantErr: 13.93083 batch_time=8.48453 
Train Epoch: 28 [81/125 20736/32000 (65%)] Loss: 2.06579 (QuantReg: 13.61116) QuantErr: 13.61116 batch_time=0.75794 
Train Epoch: 28 [97/125 24832/32000 (78%)] Loss: 1.58044 (QuantReg: 14.02000) QuantErr: 14.02000 batch_time=0.78195 
Train Epoch: 28 [113/125 28928/32000 (90%)] Loss: 1.60424 (QuantReg: 14.09330) QuantErr: 14.09330 batch_time=0.76322 
Train Epoch: 28 codebook_update_time=1.75013
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch28.pth ...
Done in 3.766s
removing stale ckpt [epoch 28] [took 0.01s]
 epoch          : 28
 loss           : 1.7147071809768677
 quant_reg      : 13.910705535888672
 quant_err      : 13.910705535888672
 learning_rate  : 1.2517204487122746e-05
 n_samples      : 896000
 n_steps        : 3500
 MSRVTT_full_val/t2v_metrics/R1: 33.80281690140845
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.76056338028169
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.64978019535144
 MSRVTT_full_val/v2t_metrics/R1: 37.82696177062374
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 88.53118712273641
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.647887323943662
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.66685215895803
 MSRVTT_full_test/t2v_metrics/R1: 13.779264214046822
 MSRVTT_full_test/t2v_metrics/R5: 36.48829431438127
 MSRVTT_full_test/t2v_metrics/R10: 50.76923076923077
 MSRVTT_full_test/t2v_metrics/R50: 81.47157190635451
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.725752508361204
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.44376827033941
 MSRVTT_full_test/v2t_metrics/R1: 17.090301003344482
 MSRVTT_full_test/v2t_metrics/R5: 44.88294314381271
 MSRVTT_full_test/v2t_metrics/R10: 59.297658862876254
 MSRVTT_full_test/v2t_metrics/R50: 87.32441471571906
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.694983277591973
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.696271999191055
 mnt_best       : 29.586445713982496
 not_improved_count: 1
Train Epoch: 29 [1/125 256/32000 (1%)] Loss: 1.66946 (QuantReg: 13.70654) QuantErr: 13.70654 batch_time=46.76898 
Train Epoch: 29 [17/125 4352/32000 (14%)] Loss: 1.58193 (QuantReg: 13.83068) QuantErr: 13.83068 batch_time=8.12852 
Train Epoch: 29 [33/125 8448/32000 (26%)] Loss: 1.53636 (QuantReg: 14.00569) QuantErr: 14.00569 batch_time=0.91133 
Train Epoch: 29 [49/125 12544/32000 (39%)] Loss: 1.81736 (QuantReg: 14.11224) QuantErr: 14.11224 batch_time=0.75580 
Train Epoch: 29 [65/125 16640/32000 (52%)] Loss: 1.83611 (QuantReg: 13.91157) QuantErr: 13.91157 batch_time=2.65538 
Train Epoch: 29 [81/125 20736/32000 (65%)] Loss: 1.86685 (QuantReg: 14.01256) QuantErr: 14.01256 batch_time=6.18824 
Train Epoch: 29 [97/125 24832/32000 (78%)] Loss: 1.94524 (QuantReg: 13.70776) QuantErr: 13.70776 batch_time=0.75990 
Train Epoch: 29 [113/125 28928/32000 (90%)] Loss: 1.75076 (QuantReg: 13.79589) QuantErr: 13.79589 batch_time=0.76089 
Train Epoch: 29 codebook_update_time=1.62951
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch29.pth ...
Done in 8.623s
removing stale ckpt [epoch 29] [took 0.00s]
 epoch          : 29
 loss           : 1.6973219728469848
 quant_reg      : 13.918547180175782
 quant_err      : 13.918547180175782
 learning_rate  : 1.1891344262766608e-05
 n_samples      : 928000
 n_steps        : 3625
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 68.2092555331992
 MSRVTT_full_val/t2v_metrics/R10: 81.28772635814889
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.173038229376257
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.99979954786118
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.887323943661972
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.62503603686537
 MSRVTT_full_test/t2v_metrics/R1: 13.478260869565217
 MSRVTT_full_test/t2v_metrics/R5: 35.585284280936456
 MSRVTT_full_test/t2v_metrics/R10: 49.83277591973244
 MSRVTT_full_test/t2v_metrics/R50: 81.1371237458194
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.99966555183946
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.805347966932025
 MSRVTT_full_test/v2t_metrics/R1: 17.090301003344482
 MSRVTT_full_test/v2t_metrics/R5: 44.414715719063544
 MSRVTT_full_test/v2t_metrics/R10: 58.22742474916388
 MSRVTT_full_test/v2t_metrics/R50: 87.02341137123746
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.921070234113714
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.35640177870074
 mnt_best       : 29.586445713982496
 not_improved_count: 2
Train Epoch: 30 [1/125 256/32000 (1%)] Loss: 1.58512 (QuantReg: 13.93356) QuantErr: 13.93356 batch_time=46.91621 
Train Epoch: 30 [17/125 4352/32000 (14%)] Loss: 1.67828 (QuantReg: 13.97998) QuantErr: 13.97998 batch_time=0.73357 
Train Epoch: 30 [33/125 8448/32000 (26%)] Loss: 1.74288 (QuantReg: 14.02306) QuantErr: 14.02306 batch_time=0.85106 
Train Epoch: 30 [49/125 12544/32000 (39%)] Loss: 1.57041 (QuantReg: 13.80299) QuantErr: 13.80299 batch_time=0.77033 
Train Epoch: 30 [65/125 16640/32000 (52%)] Loss: 1.59781 (QuantReg: 13.95662) QuantErr: 13.95662 batch_time=4.69065 
Train Epoch: 30 [81/125 20736/32000 (65%)] Loss: 1.75146 (QuantReg: 13.97842) QuantErr: 13.97842 batch_time=0.89881 
Train Epoch: 30 [97/125 24832/32000 (78%)] Loss: 1.92119 (QuantReg: 13.82778) QuantErr: 13.82778 batch_time=0.74818 
Train Epoch: 30 [113/125 28928/32000 (90%)] Loss: 1.58538 (QuantReg: 13.77330) QuantErr: 13.77330 batch_time=0.96596 
Train Epoch: 30 codebook_update_time=1.76378
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch30.pth ...
Done in 12.860s
removing stale ckpt [epoch 30] [took 0.01s]
 epoch          : 30
 loss           : 1.6465990228652954
 quant_reg      : 13.94663230895996
 quant_err      : 13.94663230895996
 learning_rate  : 1.1296777049628277e-05
 n_samples      : 960000
 n_steps        : 3750
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 68.41046277665995
 MSRVTT_full_val/t2v_metrics/R10: 80.88531187122736
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.768611670020121
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.30257912463662
 MSRVTT_full_val/v2t_metrics/R1: 38.22937625754527
 MSRVTT_full_val/v2t_metrics/R5: 79.07444668008048
 MSRVTT_full_val/v2t_metrics/R10: 88.12877263581488
 MSRVTT_full_val/v2t_metrics/R50: 98.39034205231388
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.780684104627767
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.34532990288757
 MSRVTT_full_test/t2v_metrics/R1: 13.645484949832776
 MSRVTT_full_test/t2v_metrics/R5: 35.88628762541806
 MSRVTT_full_test/t2v_metrics/R10: 49.63210702341137
 MSRVTT_full_test/t2v_metrics/R50: 81.70568561872909
 MSRVTT_full_test/t2v_metrics/MedR: 11.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.37123745819398
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 28.96632552594947
 MSRVTT_full_test/v2t_metrics/R1: 16.622073578595316
 MSRVTT_full_test/v2t_metrics/R5: 45.21739130434783
 MSRVTT_full_test/v2t_metrics/R10: 59.59866220735786
 MSRVTT_full_test/v2t_metrics/R50: 87.52508361204013
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.846822742474917
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.51477533508235
 mnt_best       : 29.586445713982496
 not_improved_count: 3
Train Epoch: 31 [1/125 256/32000 (1%)] Loss: 1.69901 (QuantReg: 13.93810) QuantErr: 13.93810 batch_time=47.77038 
Train Epoch: 31 [17/125 4352/32000 (14%)] Loss: 1.46945 (QuantReg: 13.71914) QuantErr: 13.71914 batch_time=0.75607 
Train Epoch: 31 [33/125 8448/32000 (26%)] Loss: 1.67938 (QuantReg: 13.88300) QuantErr: 13.88300 batch_time=1.20857 
Train Epoch: 31 [49/125 12544/32000 (39%)] Loss: 1.69981 (QuantReg: 13.96328) QuantErr: 13.96328 batch_time=0.78959 
Train Epoch: 31 [65/125 16640/32000 (52%)] Loss: 1.51717 (QuantReg: 13.94439) QuantErr: 13.94439 batch_time=4.61786 
Train Epoch: 31 [81/125 20736/32000 (65%)] Loss: 1.56030 (QuantReg: 14.04853) QuantErr: 14.04853 batch_time=0.88000 
Train Epoch: 31 [97/125 24832/32000 (78%)] Loss: 1.71731 (QuantReg: 14.02523) QuantErr: 14.02523 batch_time=1.08075 
Train Epoch: 31 [113/125 28928/32000 (90%)] Loss: 1.65713 (QuantReg: 13.95842) QuantErr: 13.95842 batch_time=0.82605 
Train Epoch: 31 codebook_update_time=1.66454
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch31.pth ...
Done in 3.619s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch31.pth ...
Done in 7.223s
removing stale ckpt [epoch 31] [took 0.00s]
 epoch          : 31
 loss           : 1.6806411266326904
 quant_reg      : 13.962272598266601
 quant_err      : 13.962272598266601
 learning_rate  : 1.0731938197146863e-05
 n_samples      : 992000
 n_steps        : 3875
 MSRVTT_full_val/t2v_metrics/R1: 35.412474849094565
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 82.897384305835
 MSRVTT_full_val/t2v_metrics/R50: 98.79275653923541
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.668008048289739
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 59.12932491757618
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 78.06841046277665
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.0241448692152915
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.52148819666891
 MSRVTT_full_test/t2v_metrics/R1: 13.979933110367893
 MSRVTT_full_test/t2v_metrics/R5: 37.89297658862876
 MSRVTT_full_test/t2v_metrics/R10: 51.63879598662207
 MSRVTT_full_test/t2v_metrics/R50: 82.27424749163879
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 40.93177257525084
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.130983494613016
 MSRVTT_full_test/v2t_metrics/R1: 18.160535117056856
 MSRVTT_full_test/v2t_metrics/R5: 45.18394648829432
 MSRVTT_full_test/v2t_metrics/R10: 59.531772575250834
 MSRVTT_full_test/v2t_metrics/R50: 87.29096989966555
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 27.621739130434783
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.55559625047635
 mnt_best       : 30.130983494613016
 not_improved_count: 0
Train Epoch: 32 [1/125 256/32000 (1%)] Loss: 1.39876 (QuantReg: 13.90730) QuantErr: 13.90730 batch_time=43.61100 
Train Epoch: 32 [17/125 4352/32000 (14%)] Loss: 1.70226 (QuantReg: 14.03899) QuantErr: 14.03899 batch_time=0.79161 
Train Epoch: 32 [33/125 8448/32000 (26%)] Loss: 1.29254 (QuantReg: 14.02343) QuantErr: 14.02343 batch_time=0.74325 
Train Epoch: 32 [49/125 12544/32000 (39%)] Loss: 1.38524 (QuantReg: 14.12596) QuantErr: 14.12596 batch_time=1.10259 
Train Epoch: 32 [65/125 16640/32000 (52%)] Loss: 1.56475 (QuantReg: 14.05349) QuantErr: 14.05349 batch_time=4.21063 
Train Epoch: 32 [81/125 20736/32000 (65%)] Loss: 1.69350 (QuantReg: 13.90508) QuantErr: 13.90508 batch_time=0.75118 
Train Epoch: 32 [97/125 24832/32000 (78%)] Loss: 1.63615 (QuantReg: 14.05071) QuantErr: 14.05071 batch_time=0.87765 
Train Epoch: 32 [113/125 28928/32000 (90%)] Loss: 1.56368 (QuantReg: 14.11514) QuantErr: 14.11514 batch_time=1.09969 
Train Epoch: 32 codebook_update_time=1.64995
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch32.pth ...
Done in 5.898s
removing stale ckpt [epoch 32] [took 0.00s]
 epoch          : 32
 loss           : 1.6407827396392822
 quant_reg      : 13.975562690734863
 quant_err      : 13.975562690734863
 learning_rate  : 1.019534128728952e-05
 n_samples      : 1024000
 n_steps        : 4000
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.696177062374246
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.15505413370227
 MSRVTT_full_val/v2t_metrics/R1: 37.42454728370221
 MSRVTT_full_val/v2t_metrics/R5: 76.05633802816901
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.036217303822937
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 62.72937338866334
 MSRVTT_full_test/t2v_metrics/R1: 13.779264214046822
 MSRVTT_full_test/t2v_metrics/R5: 37.558528428093645
 MSRVTT_full_test/t2v_metrics/R10: 50.836120401337794
 MSRVTT_full_test/t2v_metrics/R50: 81.47157190635451
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.012040133779266
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.74191981507028
 MSRVTT_full_test/v2t_metrics/R1: 17.224080267558527
 MSRVTT_full_test/v2t_metrics/R5: 44.88294314381271
 MSRVTT_full_test/v2t_metrics/R10: 59.297658862876254
 MSRVTT_full_test/v2t_metrics/R50: 87.05685618729098
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 27.945484949832775
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.7891709789396
 mnt_best       : 30.130983494613016
 not_improved_count: 1
Train Epoch: 33 [1/125 256/32000 (1%)] Loss: 1.63490 (QuantReg: 14.17151) QuantErr: 14.17151 batch_time=45.26354 
Train Epoch: 33 [17/125 4352/32000 (14%)] Loss: 1.59959 (QuantReg: 13.90974) QuantErr: 13.90974 batch_time=1.05570 
Train Epoch: 33 [33/125 8448/32000 (26%)] Loss: 1.57216 (QuantReg: 14.09578) QuantErr: 14.09578 batch_time=0.77004 
Train Epoch: 33 [49/125 12544/32000 (39%)] Loss: 1.50556 (QuantReg: 14.07556) QuantErr: 14.07556 batch_time=0.74706 
Train Epoch: 33 [65/125 16640/32000 (52%)] Loss: 1.89959 (QuantReg: 13.73013) QuantErr: 13.73013 batch_time=2.40234 
Train Epoch: 33 [81/125 20736/32000 (65%)] Loss: 1.67873 (QuantReg: 14.01923) QuantErr: 14.01923 batch_time=1.04008 
Train Epoch: 33 [97/125 24832/32000 (78%)] Loss: 1.61263 (QuantReg: 14.04360) QuantErr: 14.04360 batch_time=0.80442 
Train Epoch: 33 [113/125 28928/32000 (90%)] Loss: 1.82616 (QuantReg: 13.93065) QuantErr: 13.93065 batch_time=0.76763 
Train Epoch: 33 codebook_update_time=1.77637
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch33.pth ...
Done in 4.497s
removing stale ckpt [epoch 33] [took 0.00s]
 epoch          : 33
 loss           : 1.6319673986434937
 quant_reg      : 14.0088857421875
 quant_err      : 14.0088857421875
 learning_rate  : 9.685574222925043e-06
 n_samples      : 1056000
 n_steps        : 4125
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.494969818913481
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.701937539646046
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.99396378269617
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.943661971830986
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.25249125414258
 MSRVTT_full_test/t2v_metrics/R1: 13.74581939799331
 MSRVTT_full_test/t2v_metrics/R5: 37.759197324414714
 MSRVTT_full_test/t2v_metrics/R10: 51.17056856187291
 MSRVTT_full_test/t2v_metrics/R50: 81.83946488294315
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.97290969899665
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.835813004089566
 MSRVTT_full_test/v2t_metrics/R1: 16.8561872909699
 MSRVTT_full_test/v2t_metrics/R5: 44.61538461538461
 MSRVTT_full_test/v2t_metrics/R10: 59.4314381270903
 MSRVTT_full_test/v2t_metrics/R50: 87.35785953177258
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.07391304347826
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 35.48842642646219
 mnt_best       : 30.130983494613016
 not_improved_count: 2
Train Epoch: 34 [1/125 256/32000 (1%)] Loss: 1.66117 (QuantReg: 14.02068) QuantErr: 14.02068 batch_time=38.32472 
Train Epoch: 34 [17/125 4352/32000 (14%)] Loss: 1.49117 (QuantReg: 13.97593) QuantErr: 13.97593 batch_time=2.18348 
Train Epoch: 34 [33/125 8448/32000 (26%)] Loss: 1.43872 (QuantReg: 14.12328) QuantErr: 14.12328 batch_time=0.76735 
Train Epoch: 34 [49/125 12544/32000 (39%)] Loss: 1.77186 (QuantReg: 14.06639) QuantErr: 14.06639 batch_time=0.74918 
Train Epoch: 34 [65/125 16640/32000 (52%)] Loss: 1.77998 (QuantReg: 13.99152) QuantErr: 13.99152 batch_time=1.41799 
Train Epoch: 34 [81/125 20736/32000 (65%)] Loss: 1.53362 (QuantReg: 14.06117) QuantErr: 14.06117 batch_time=1.89724 
Train Epoch: 34 [97/125 24832/32000 (78%)] Loss: 1.70384 (QuantReg: 14.09246) QuantErr: 14.09246 batch_time=0.75997 
Train Epoch: 34 [113/125 28928/32000 (90%)] Loss: 1.71985 (QuantReg: 13.96716) QuantErr: 13.96716 batch_time=0.76376 
Train Epoch: 34 codebook_update_time=1.76416
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch34.pth ...
Done in 3.991s
removing stale ckpt [epoch 34] [took 0.00s]
 epoch          : 34
 loss           : 1.6259503555297852
 quant_reg      : 14.02079249572754
 quant_err      : 14.02079249572754
 learning_rate  : 9.20129551177879e-06
 n_samples      : 1088000
 n_steps        : 4250
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.885311871227364
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.88388636453524
 MSRVTT_full_val/v2t_metrics/R1: 39.839034205231385
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.12273641851107
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.605633802816901
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.48693189442918
 MSRVTT_full_test/t2v_metrics/R1: 14.180602006688963
 MSRVTT_full_test/t2v_metrics/R5: 37.15719063545151
 MSRVTT_full_test/t2v_metrics/R10: 50.06688963210702
 MSRVTT_full_test/t2v_metrics/R50: 81.53846153846153
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.55752508361204
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.768895186518883
 MSRVTT_full_test/v2t_metrics/R1: 17.892976588628763
 MSRVTT_full_test/v2t_metrics/R5: 45.752508361204015
 MSRVTT_full_test/v2t_metrics/R10: 59.297658862876254
 MSRVTT_full_test/v2t_metrics/R50: 87.49163879598662
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.107357859531774
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.47917573574012
 mnt_best       : 30.130983494613016
 not_improved_count: 3
Train Epoch: 35 [1/125 256/32000 (1%)] Loss: 1.72449 (QuantReg: 13.93894) QuantErr: 13.93894 batch_time=42.22377 
Train Epoch: 35 [17/125 4352/32000 (14%)] Loss: 1.68760 (QuantReg: 13.90881) QuantErr: 13.90881 batch_time=0.89509 
Train Epoch: 35 [33/125 8448/32000 (26%)] Loss: 1.86208 (QuantReg: 13.95692) QuantErr: 13.95692 batch_time=0.76257 
Train Epoch: 35 [49/125 12544/32000 (39%)] Loss: 1.74208 (QuantReg: 13.95728) QuantErr: 13.95728 batch_time=0.87470 
Train Epoch: 35 [65/125 16640/32000 (52%)] Loss: 1.41148 (QuantReg: 14.17385) QuantErr: 14.17385 batch_time=6.36439 
Train Epoch: 35 [81/125 20736/32000 (65%)] Loss: 1.69885 (QuantReg: 14.14090) QuantErr: 14.14090 batch_time=0.97066 
Train Epoch: 35 [97/125 24832/32000 (78%)] Loss: 1.68599 (QuantReg: 14.02665) QuantErr: 14.02665 batch_time=0.81302 
Train Epoch: 35 [113/125 28928/32000 (90%)] Loss: 1.61940 (QuantReg: 13.88306) QuantErr: 13.88306 batch_time=0.75017 
Train Epoch: 35 codebook_update_time=1.70663
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch35.pth ...
Done in 11.087s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch35.pth ...
Done in 14.890s
removing stale ckpt [epoch 35] [took 0.04s]
 epoch          : 35
 loss           : 1.6208217439651489
 quant_reg      : 14.01992586517334
 quant_err      : 14.01992586517334
 learning_rate  : 8.74123073618985e-06
 n_samples      : 1120000
 n_steps        : 4375
 MSRVTT_full_val/t2v_metrics/R1: 35.010060362173036
 MSRVTT_full_val/t2v_metrics/R5: 70.62374245472837
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 98.79275653923541
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.519114688128773
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.76911091232763
 MSRVTT_full_val/v2t_metrics/R1: 38.83299798792756
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.841046277665996
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.93306844778112
 MSRVTT_full_test/t2v_metrics/R1: 14.180602006688963
 MSRVTT_full_test/t2v_metrics/R5: 38.79598662207358
 MSRVTT_full_test/t2v_metrics/R10: 51.50501672240803
 MSRVTT_full_test/t2v_metrics/R50: 82.67558528428094
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 41.014715719063545
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.486694154115447
 MSRVTT_full_test/v2t_metrics/R1: 17.62541806020067
 MSRVTT_full_test/v2t_metrics/R5: 45.88628762541806
 MSRVTT_full_test/v2t_metrics/R10: 60.0
 MSRVTT_full_test/v2t_metrics/R50: 86.78929765886288
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.02675585284281
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.47465561719235
 mnt_best       : 30.486694154115447
 not_improved_count: 0
Train Epoch: 36 [1/125 256/32000 (1%)] Loss: 1.55896 (QuantReg: 14.03392) QuantErr: 14.03392 batch_time=39.55177 
Train Epoch: 36 [17/125 4352/32000 (14%)] Loss: 1.52865 (QuantReg: 14.01593) QuantErr: 14.01593 batch_time=0.87722 
Train Epoch: 36 [33/125 8448/32000 (26%)] Loss: 2.01713 (QuantReg: 13.91055) QuantErr: 13.91055 batch_time=0.83805 
Train Epoch: 36 [49/125 12544/32000 (39%)] Loss: 1.70028 (QuantReg: 13.87955) QuantErr: 13.87955 batch_time=0.74193 
Train Epoch: 36 [65/125 16640/32000 (52%)] Loss: 1.55979 (QuantReg: 14.10315) QuantErr: 14.10315 batch_time=0.76689 
Train Epoch: 36 [81/125 20736/32000 (65%)] Loss: 1.56434 (QuantReg: 14.05218) QuantErr: 14.05218 batch_time=0.86543 
Train Epoch: 36 [97/125 24832/32000 (78%)] Loss: 1.60946 (QuantReg: 14.04436) QuantErr: 14.04436 batch_time=0.86800 
Train Epoch: 36 [113/125 28928/32000 (90%)] Loss: 1.42559 (QuantReg: 14.05354) QuantErr: 14.05354 batch_time=0.86710 
Train Epoch: 36 codebook_update_time=1.70691
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch36.pth ...
Done in 4.178s
removing stale ckpt [epoch 36] [took 0.00s]
 epoch          : 36
 loss           : 1.6570886058807373
 quant_reg      : 14.019045707702636
 quant_err      : 14.019045707702636
 learning_rate  : 8.304169199380357e-06
 n_samples      : 1152000
 n_steps        : 4500
 MSRVTT_full_val/t2v_metrics/R1: 33.199195171026155
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.7002012072434605
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.336743446736854
 MSRVTT_full_val/v2t_metrics/R1: 37.625754527162975
 MSRVTT_full_val/v2t_metrics/R5: 76.25754527162978
 MSRVTT_full_val/v2t_metrics/R10: 88.32997987927565
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.963782696177063
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.28372823643442
 MSRVTT_full_test/t2v_metrics/R1: 13.34448160535117
 MSRVTT_full_test/t2v_metrics/R5: 37.525083612040135
 MSRVTT_full_test/t2v_metrics/R10: 50.13377926421405
 MSRVTT_full_test/t2v_metrics/R50: 81.60535117056857
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.6247491638796
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.28091250205171
 MSRVTT_full_test/v2t_metrics/R1: 17.49163879598662
 MSRVTT_full_test/v2t_metrics/R5: 45.45150501672241
 MSRVTT_full_test/v2t_metrics/R10: 59.297658862876254
 MSRVTT_full_test/v2t_metrics/R50: 87.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.483946488294315
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.124798950515356
 mnt_best       : 30.486694154115447
 not_improved_count: 1
Train Epoch: 37 [1/125 256/32000 (1%)] Loss: 1.51598 (QuantReg: 14.04560) QuantErr: 14.04560 batch_time=39.67750 
Train Epoch: 37 [17/125 4352/32000 (14%)] Loss: 1.60902 (QuantReg: 13.93598) QuantErr: 13.93598 batch_time=0.77199 
Train Epoch: 37 [33/125 8448/32000 (26%)] Loss: 1.57965 (QuantReg: 14.02796) QuantErr: 14.02796 batch_time=0.74763 
Train Epoch: 37 [49/125 12544/32000 (39%)] Loss: 1.45167 (QuantReg: 14.09881) QuantErr: 14.09881 batch_time=0.77367 
Train Epoch: 37 [65/125 16640/32000 (52%)] Loss: 1.73169 (QuantReg: 13.93475) QuantErr: 13.93475 batch_time=2.43455 
Train Epoch: 37 [81/125 20736/32000 (65%)] Loss: 1.66239 (QuantReg: 13.93997) QuantErr: 13.93997 batch_time=0.80388 
Train Epoch: 37 [97/125 24832/32000 (78%)] Loss: 1.54177 (QuantReg: 14.08778) QuantErr: 14.08778 batch_time=0.74834 
Train Epoch: 37 [113/125 28928/32000 (90%)] Loss: 1.51319 (QuantReg: 14.06759) QuantErr: 14.06759 batch_time=0.76550 
Train Epoch: 37 codebook_update_time=1.68034
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch37.pth ...
Done in 20.028s
 epoch          : 37
 loss           : 1.5995278053283692
 quant_reg      : 14.04149476623535
 quant_err      : 14.04149476623535
 learning_rate  : 7.888960739411339e-06
 n_samples      : 1184000
 n_steps        : 4625
 MSRVTT_full_val/t2v_metrics/R1: 32.19315895372233
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 82.09255533199195
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.748490945674044
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.98537464272701
 MSRVTT_full_val/v2t_metrics/R1: 40.643863179074444
 MSRVTT_full_val/v2t_metrics/R5: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R10: 87.92756539235413
 MSRVTT_full_val/v2t_metrics/R50: 99.19517102615694
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.778672032193159
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 65.17406207332974
 MSRVTT_full_test/t2v_metrics/R1: 13.545150501672241
 MSRVTT_full_test/t2v_metrics/R5: 37.357859531772576
 MSRVTT_full_test/t2v_metrics/R10: 51.070234113712374
 MSRVTT_full_test/t2v_metrics/R50: 81.73913043478261
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.97257525083612
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.56500041771472
 MSRVTT_full_test/v2t_metrics/R1: 18.127090301003346
 MSRVTT_full_test/v2t_metrics/R5: 45.1505016722408
 MSRVTT_full_test/v2t_metrics/R10: 60.10033444816054
 MSRVTT_full_test/v2t_metrics/R50: 87.22408026755853
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 27.801003344481604
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.640032964387366
 mnt_best       : 30.486694154115447
 not_improved_count: 2
Train Epoch: 38 [1/125 256/32000 (1%)] Loss: 1.78706 (QuantReg: 13.90910) QuantErr: 13.90910 batch_time=52.93023 
Train Epoch: 38 [17/125 4352/32000 (14%)] Loss: 1.54064 (QuantReg: 14.07771) QuantErr: 14.07771 batch_time=0.75397 
Train Epoch: 38 [33/125 8448/32000 (26%)] Loss: 1.81816 (QuantReg: 13.92810) QuantErr: 13.92810 batch_time=0.73981 
Train Epoch: 38 [49/125 12544/32000 (39%)] Loss: 1.75813 (QuantReg: 14.06349) QuantErr: 14.06349 batch_time=0.80732 
Train Epoch: 38 [65/125 16640/32000 (52%)] Loss: 1.43268 (QuantReg: 14.16113) QuantErr: 14.16113 batch_time=10.01002 
Train Epoch: 38 [81/125 20736/32000 (65%)] Loss: 1.54055 (QuantReg: 14.16458) QuantErr: 14.16458 batch_time=0.77825 
Train Epoch: 38 [97/125 24832/32000 (78%)] Loss: 1.35071 (QuantReg: 14.02511) QuantErr: 14.02511 batch_time=0.73795 
Train Epoch: 38 [113/125 28928/32000 (90%)] Loss: 1.69110 (QuantReg: 14.15875) QuantErr: 14.15875 batch_time=0.75091 
Train Epoch: 38 codebook_update_time=1.68136
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch38.pth ...
Done in 11.339s
removing stale ckpt [epoch 37] [took 0.00s]
 epoch          : 38
 loss           : 1.6050857706069945
 quant_reg      : 14.060773490905762
 quant_err      : 14.060773490905762
 learning_rate  : 7.494512702440772e-06
 n_samples      : 1216000
 n_steps        : 4750
 MSRVTT_full_val/t2v_metrics/R1: 35.010060362173036
 MSRVTT_full_val/t2v_metrics/R5: 69.61770623742454
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.89738430583501
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.39299327778581
 MSRVTT_full_val/v2t_metrics/R1: 39.839034205231385
 MSRVTT_full_val/v2t_metrics/R5: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R10: 88.32997987927565
 MSRVTT_full_val/v2t_metrics/R50: 98.99396378269617
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.8631790744466805
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.89570423332373
 MSRVTT_full_test/t2v_metrics/R1: 13.645484949832776
 MSRVTT_full_test/t2v_metrics/R5: 38.49498327759197
 MSRVTT_full_test/t2v_metrics/R10: 51.438127090301
 MSRVTT_full_test/t2v_metrics/R50: 81.87290969899665
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.07625418060201
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.00724234420427
 MSRVTT_full_test/v2t_metrics/R1: 17.29096989966555
 MSRVTT_full_test/v2t_metrics/R5: 45.618729096989966
 MSRVTT_full_test/v2t_metrics/R10: 59.89966555183946
 MSRVTT_full_test/v2t_metrics/R50: 87.123745819398
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.462040133779265
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.15172111798838
 mnt_best       : 30.486694154115447
 not_improved_count: 3
Train Epoch: 39 [1/125 256/32000 (1%)] Loss: 1.77759 (QuantReg: 14.04965) QuantErr: 14.04965 batch_time=49.31684 
Train Epoch: 39 [17/125 4352/32000 (14%)] Loss: 1.92129 (QuantReg: 14.15484) QuantErr: 14.15484 batch_time=0.76335 
Train Epoch: 39 [33/125 8448/32000 (26%)] Loss: 1.70295 (QuantReg: 14.06779) QuantErr: 14.06779 batch_time=0.75214 
Train Epoch: 39 [49/125 12544/32000 (39%)] Loss: 1.51178 (QuantReg: 14.23756) QuantErr: 14.23756 batch_time=0.75237 
Train Epoch: 39 [65/125 16640/32000 (52%)] Loss: 1.77585 (QuantReg: 14.08535) QuantErr: 14.08535 batch_time=5.26876 
Train Epoch: 39 [81/125 20736/32000 (65%)] Loss: 1.77562 (QuantReg: 14.04827) QuantErr: 14.04827 batch_time=0.80071 
Train Epoch: 39 [97/125 24832/32000 (78%)] Loss: 1.80612 (QuantReg: 14.08071) QuantErr: 14.08071 batch_time=0.88358 
Train Epoch: 39 [113/125 28928/32000 (90%)] Loss: 1.44214 (QuantReg: 14.09812) QuantErr: 14.09812 batch_time=0.90773 
Train Epoch: 39 codebook_update_time=1.64085
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch39.pth ...
Done in 3.619s
removing stale ckpt [epoch 38] [took 0.00s]
 epoch          : 39
 loss           : 1.6000247049331664
 quant_reg      : 14.101772880554199
 quant_err      : 14.101772880554199
 learning_rate  : 7.119787067318733e-06
 n_samples      : 1248000
 n_steps        : 4875
 MSRVTT_full_val/t2v_metrics/R1: 34.00402414486921
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 82.69617706237425
 MSRVTT_full_val/t2v_metrics/R50: 98.39034205231388
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.6800804828973845
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.28755007236151
 MSRVTT_full_val/v2t_metrics/R1: 40.44265593561368
 MSRVTT_full_val/v2t_metrics/R5: 77.46478873239437
 MSRVTT_full_val/v2t_metrics/R10: 88.32997987927565
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.054325955734407
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 65.16544725387432
 MSRVTT_full_test/t2v_metrics/R1: 13.812709030100335
 MSRVTT_full_test/t2v_metrics/R5: 38.12709030100334
 MSRVTT_full_test/t2v_metrics/R10: 51.23745819397993
 MSRVTT_full_test/t2v_metrics/R50: 82.27424749163879
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.79933110367893
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.993929598982895
 MSRVTT_full_test/v2t_metrics/R1: 17.959866220735787
 MSRVTT_full_test/v2t_metrics/R5: 46.187290969899664
 MSRVTT_full_test/v2t_metrics/R10: 59.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 87.05685618729098
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.54113712374582
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.70866417267557
 mnt_best       : 30.486694154115447
 not_improved_count: 4
Train Epoch: 40 [1/125 256/32000 (1%)] Loss: 1.50815 (QuantReg: 14.13697) QuantErr: 14.13697 batch_time=56.16162 
Train Epoch: 40 [17/125 4352/32000 (14%)] Loss: 1.66169 (QuantReg: 13.98275) QuantErr: 13.98275 batch_time=0.75533 
Train Epoch: 40 [33/125 8448/32000 (26%)] Loss: 1.56572 (QuantReg: 14.14803) QuantErr: 14.14803 batch_time=0.77803 
Train Epoch: 40 [49/125 12544/32000 (39%)] Loss: 1.71276 (QuantReg: 14.15648) QuantErr: 14.15648 batch_time=0.74901 
Train Epoch: 40 [65/125 16640/32000 (52%)] Loss: 1.57852 (QuantReg: 13.96631) QuantErr: 13.96631 batch_time=8.08725 
Train Epoch: 40 [81/125 20736/32000 (65%)] Loss: 1.61723 (QuantReg: 14.02762) QuantErr: 14.02762 batch_time=0.75509 
Train Epoch: 40 [97/125 24832/32000 (78%)] Loss: 1.41473 (QuantReg: 14.24170) QuantErr: 14.24170 batch_time=0.74443 
Train Epoch: 40 [113/125 28928/32000 (90%)] Loss: 1.56215 (QuantReg: 14.01176) QuantErr: 14.01176 batch_time=0.75777 
Train Epoch: 40 codebook_update_time=1.68500
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch40.pth ...
Done in 4.288s
removing stale ckpt [epoch 39] [took 0.01s]
 epoch          : 40
 loss           : 1.6158103914260864
 quant_reg      : 14.093331840515138
 quant_err      : 14.093331840515138
 learning_rate  : 6.763797713952796e-06
 n_samples      : 1280000
 n_steps        : 5000
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 67.40442655935614
 MSRVTT_full_val/t2v_metrics/R10: 81.08651911468813
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.816901408450704
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.84152477573617
 MSRVTT_full_val/v2t_metrics/R1: 38.43058350100603
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 86.9215291750503
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.899396378269618
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.61344379175661
 MSRVTT_full_test/t2v_metrics/R1: 13.7123745819398
 MSRVTT_full_test/t2v_metrics/R5: 37.525083612040135
 MSRVTT_full_test/t2v_metrics/R10: 50.936454849498325
 MSRVTT_full_test/t2v_metrics/R50: 81.1371237458194
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.223076923076924
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 29.704415926853898
 MSRVTT_full_test/v2t_metrics/R1: 17.4247491638796
 MSRVTT_full_test/v2t_metrics/R5: 45.08361204013378
 MSRVTT_full_test/v2t_metrics/R10: 59.63210702341137
 MSRVTT_full_test/v2t_metrics/R50: 86.8561872909699
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.5314381270903
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.04860511677015
 mnt_best       : 30.486694154115447
 not_improved_count: 5
Train Epoch: 41 [1/125 256/32000 (1%)] Loss: 1.79672 (QuantReg: 13.97599) QuantErr: 13.97599 batch_time=57.48325 
Train Epoch: 41 [17/125 4352/32000 (14%)] Loss: 1.54023 (QuantReg: 14.23122) QuantErr: 14.23122 batch_time=1.10910 
Train Epoch: 41 [33/125 8448/32000 (26%)] Loss: 1.72244 (QuantReg: 13.97161) QuantErr: 13.97161 batch_time=0.78080 
Train Epoch: 41 [49/125 12544/32000 (39%)] Loss: 1.69990 (QuantReg: 14.06753) QuantErr: 14.06753 batch_time=0.78113 
Train Epoch: 41 [65/125 16640/32000 (52%)] Loss: 1.58551 (QuantReg: 13.98711) QuantErr: 13.98711 batch_time=8.68805 
Train Epoch: 41 [81/125 20736/32000 (65%)] Loss: 1.52619 (QuantReg: 13.97818) QuantErr: 13.97818 batch_time=1.22136 
Train Epoch: 41 [97/125 24832/32000 (78%)] Loss: 1.78192 (QuantReg: 14.11520) QuantErr: 14.11520 batch_time=0.74223 
Train Epoch: 41 [113/125 28928/32000 (90%)] Loss: 1.98637 (QuantReg: 14.16899) QuantErr: 14.16899 batch_time=0.82431 
Train Epoch: 41 codebook_update_time=1.76601
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch41.pth ...
Done in 3.872s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch41.pth ...
Done in 16.307s
removing stale ckpt [epoch 40] [took 0.00s]
 epoch          : 41
 loss           : 1.6085265045166015
 quant_reg      : 14.09186102294922
 quant_err      : 14.09186102294922
 learning_rate  : 6.425607828255156e-06
 n_samples      : 1312000
 n_steps        : 5125
 MSRVTT_full_val/t2v_metrics/R1: 34.20523138832998
 MSRVTT_full_val/t2v_metrics/R5: 69.21529175050301
 MSRVTT_full_val/t2v_metrics/R10: 82.49496981891348
 MSRVTT_full_val/t2v_metrics/R50: 97.78672032193158
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.82897384305835
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.01950485395242
 MSRVTT_full_val/v2t_metrics/R1: 40.241448692152915
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.92756539235413
 MSRVTT_full_val/v2t_metrics/R50: 98.99396378269617
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.782696177062374
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.9019626657219
 MSRVTT_full_test/t2v_metrics/R1: 14.581939799331103
 MSRVTT_full_test/t2v_metrics/R5: 38.39464882943144
 MSRVTT_full_test/t2v_metrics/R10: 51.50501672240803
 MSRVTT_full_test/t2v_metrics/R50: 82.10702341137124
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.432441471571906
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.665155954536573
 MSRVTT_full_test/v2t_metrics/R1: 18.26086956521739
 MSRVTT_full_test/v2t_metrics/R5: 46.187290969899664
 MSRVTT_full_test/v2t_metrics/R10: 60.16722408026756
 MSRVTT_full_test/v2t_metrics/R50: 87.123745819398
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.515719063545152
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.022690223651644
 mnt_best       : 30.665155954536573
 not_improved_count: 0
Train Epoch: 42 [1/125 256/32000 (1%)] Loss: 1.72465 (QuantReg: 13.90876) QuantErr: 13.90876 batch_time=53.28361 
Train Epoch: 42 [17/125 4352/32000 (14%)] Loss: 1.49642 (QuantReg: 14.04340) QuantErr: 14.04340 batch_time=0.80639 
Train Epoch: 42 [33/125 8448/32000 (26%)] Loss: 1.52335 (QuantReg: 14.06409) QuantErr: 14.06409 batch_time=0.74217 
Train Epoch: 42 [49/125 12544/32000 (39%)] Loss: 1.72397 (QuantReg: 14.14773) QuantErr: 14.14773 batch_time=0.77381 
Train Epoch: 42 [65/125 16640/32000 (52%)] Loss: 1.39749 (QuantReg: 14.14602) QuantErr: 14.14602 batch_time=8.51012 
Train Epoch: 42 [81/125 20736/32000 (65%)] Loss: 1.66400 (QuantReg: 14.22995) QuantErr: 14.22995 batch_time=0.75240 
Train Epoch: 42 [97/125 24832/32000 (78%)] Loss: 1.70114 (QuantReg: 14.21566) QuantErr: 14.21566 batch_time=0.83392 
Train Epoch: 42 [113/125 28928/32000 (90%)] Loss: 1.49153 (QuantReg: 14.18322) QuantErr: 14.18322 batch_time=0.83291 
Train Epoch: 42 codebook_update_time=1.65960
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch42.pth ...
Done in 3.844s
removing stale ckpt [epoch 41] [took 0.00s]
 epoch          : 42
 loss           : 1.5990022926330567
 quant_reg      : 14.108455795288085
 quant_err      : 14.108455795288085
 learning_rate  : 6.104327436842398e-06
 n_samples      : 1344000
 n_steps        : 5250
 MSRVTT_full_val/t2v_metrics/R1: 33.80281690140845
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.951710261569416
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.59386378762146
 MSRVTT_full_val/v2t_metrics/R1: 39.03420523138833
 MSRVTT_full_val/v2t_metrics/R5: 78.47082494969818
 MSRVTT_full_val/v2t_metrics/R10: 88.53118712273641
 MSRVTT_full_val/v2t_metrics/R50: 99.3963782696177
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.841046277665996
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.72667268521236
 MSRVTT_full_test/t2v_metrics/R1: 14.280936454849499
 MSRVTT_full_test/t2v_metrics/R5: 38.42809364548495
 MSRVTT_full_test/t2v_metrics/R10: 51.80602006688963
 MSRVTT_full_test/t2v_metrics/R50: 81.90635451505017
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.124080267558526
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.520753558841328
 MSRVTT_full_test/v2t_metrics/R1: 17.959866220735787
 MSRVTT_full_test/v2t_metrics/R5: 46.82274247491639
 MSRVTT_full_test/v2t_metrics/R10: 60.60200668896321
 MSRVTT_full_test/v2t_metrics/R50: 87.19063545150502
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.601170568561873
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.07509876117437
 mnt_best       : 30.665155954536573
 not_improved_count: 1
Train Epoch: 43 [1/125 256/32000 (1%)] Loss: 1.70330 (QuantReg: 14.09622) QuantErr: 14.09622 batch_time=56.30934 
Train Epoch: 43 [17/125 4352/32000 (14%)] Loss: 1.53325 (QuantReg: 14.28569) QuantErr: 14.28569 batch_time=0.84193 
Train Epoch: 43 [33/125 8448/32000 (26%)] Loss: 1.65405 (QuantReg: 14.16238) QuantErr: 14.16238 batch_time=0.86130 
Train Epoch: 43 [49/125 12544/32000 (39%)] Loss: 1.53408 (QuantReg: 14.06038) QuantErr: 14.06038 batch_time=0.75972 
Train Epoch: 43 [65/125 16640/32000 (52%)] Loss: 1.68055 (QuantReg: 14.03984) QuantErr: 14.03984 batch_time=12.16164 
Train Epoch: 43 [81/125 20736/32000 (65%)] Loss: 1.62687 (QuantReg: 14.19264) QuantErr: 14.19264 batch_time=0.77590 
Train Epoch: 43 [97/125 24832/32000 (78%)] Loss: 1.61130 (QuantReg: 14.08122) QuantErr: 14.08122 batch_time=0.74567 
Train Epoch: 43 [113/125 28928/32000 (90%)] Loss: 1.41465 (QuantReg: 14.23701) QuantErr: 14.23701 batch_time=0.75084 
Train Epoch: 43 codebook_update_time=1.65118
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch43.pth ...
Done in 10.833s
removing stale ckpt [epoch 42] [took 0.02s]
 epoch          : 43
 loss           : 1.5852113800048828
 quant_reg      : 14.138144767761231
 quant_err      : 14.138144767761231
 learning_rate  : 5.799111065000278e-06
 n_samples      : 1376000
 n_steps        : 5375
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.81891348088531
 MSRVTT_full_val/t2v_metrics/R10: 82.49496981891348
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.808853118712274
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.84336442285018
 MSRVTT_full_val/v2t_metrics/R1: 41.24748490945674
 MSRVTT_full_val/v2t_metrics/R5: 78.26961770623743
 MSRVTT_full_val/v2t_metrics/R10: 88.53118712273641
 MSRVTT_full_val/v2t_metrics/R50: 99.19517102615694
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.810865191146881
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 65.8712124887188
 MSRVTT_full_test/t2v_metrics/R1: 14.147157190635452
 MSRVTT_full_test/t2v_metrics/R5: 39.130434782608695
 MSRVTT_full_test/t2v_metrics/R10: 51.60535117056856
 MSRVTT_full_test/t2v_metrics/R50: 81.53846153846153
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.328428093645485
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.569818723525962
 MSRVTT_full_test/v2t_metrics/R1: 17.25752508361204
 MSRVTT_full_test/v2t_metrics/R5: 45.88628762541806
 MSRVTT_full_test/v2t_metrics/R10: 60.635451505016725
 MSRVTT_full_test/v2t_metrics/R50: 87.35785953177258
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.00066889632107
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.34650731319546
 mnt_best       : 30.665155954536573
 not_improved_count: 2
Train Epoch: 44 [1/125 256/32000 (1%)] Loss: 1.56817 (QuantReg: 14.20008) QuantErr: 14.20008 batch_time=41.59523 
Train Epoch: 44 [17/125 4352/32000 (14%)] Loss: 1.73226 (QuantReg: 14.07815) QuantErr: 14.07815 batch_time=0.74790 
Train Epoch: 44 [33/125 8448/32000 (26%)] Loss: 1.58521 (QuantReg: 13.97674) QuantErr: 13.97674 batch_time=0.74011 
Train Epoch: 44 [49/125 12544/32000 (39%)] Loss: 1.88507 (QuantReg: 14.00415) QuantErr: 14.00415 batch_time=0.93176 
Train Epoch: 44 [65/125 16640/32000 (52%)] Loss: 1.67919 (QuantReg: 14.29392) QuantErr: 14.29392 batch_time=3.84646 
Train Epoch: 44 [81/125 20736/32000 (65%)] Loss: 1.79245 (QuantReg: 14.11299) QuantErr: 14.11299 batch_time=1.01031 
Train Epoch: 44 [97/125 24832/32000 (78%)] Loss: 1.53438 (QuantReg: 14.09955) QuantErr: 14.09955 batch_time=0.76234 
Train Epoch: 44 [113/125 28928/32000 (90%)] Loss: 1.68581 (QuantReg: 14.11005) QuantErr: 14.11005 batch_time=0.75050 
Train Epoch: 44 codebook_update_time=1.64797
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch44.pth ...
Done in 4.863s
removing stale ckpt [epoch 43] [took 0.00s]
 epoch          : 44
 loss           : 1.6057304334640503
 quant_reg      : 14.116806495666504
 quant_err      : 14.116806495666504
 learning_rate  : 5.5091555117502635e-06
 n_samples      : 1408000
 n_steps        : 5500
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 98.59154929577464
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.879275653923541
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.47568316258418
 MSRVTT_full_val/v2t_metrics/R1: 39.23541247484909
 MSRVTT_full_val/v2t_metrics/R5: 78.87323943661971
 MSRVTT_full_val/v2t_metrics/R10: 87.5251509054326
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.780684104627767
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.70138685066595
 MSRVTT_full_test/t2v_metrics/R1: 14.280936454849499
 MSRVTT_full_test/t2v_metrics/R5: 38.76254180602007
 MSRVTT_full_test/t2v_metrics/R10: 51.97324414715719
 MSRVTT_full_test/t2v_metrics/R50: 81.80602006688963
 MSRVTT_full_test/t2v_metrics/MedR: 9.0
 MSRVTT_full_test/t2v_metrics/MeanR: 42.28294314381271
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.641939692776766
 MSRVTT_full_test/v2t_metrics/R1: 17.993311036789297
 MSRVTT_full_test/v2t_metrics/R5: 46.72240802675585
 MSRVTT_full_test/v2t_metrics/R10: 60.76923076923077
 MSRVTT_full_test/v2t_metrics/R50: 87.3913043478261
 MSRVTT_full_test/v2t_metrics/MedR: 6.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.30267558528428
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 37.10564751707306
 mnt_best       : 30.665155954536573
 not_improved_count: 3
Train Epoch: 45 [1/125 256/32000 (1%)] Loss: 1.62284 (QuantReg: 14.06568) QuantErr: 14.06568 batch_time=48.41523 
Train Epoch: 45 [17/125 4352/32000 (14%)] Loss: 1.57918 (QuantReg: 14.26922) QuantErr: 14.26922 batch_time=1.01146 
Train Epoch: 45 [33/125 8448/32000 (26%)] Loss: 1.78319 (QuantReg: 13.97075) QuantErr: 13.97075 batch_time=0.74786 
Train Epoch: 45 [49/125 12544/32000 (39%)] Loss: 1.56038 (QuantReg: 14.23875) QuantErr: 14.23875 batch_time=0.76208 
Train Epoch: 45 [65/125 16640/32000 (52%)] Loss: 1.58337 (QuantReg: 14.15277) QuantErr: 14.15277 batch_time=3.50013 
Train Epoch: 45 [81/125 20736/32000 (65%)] Loss: 1.50571 (QuantReg: 14.07743) QuantErr: 14.07743 batch_time=1.13515 
Train Epoch: 45 [97/125 24832/32000 (78%)] Loss: 1.86699 (QuantReg: 14.22059) QuantErr: 14.22059 batch_time=0.78605 
Train Epoch: 45 [113/125 28928/32000 (90%)] Loss: 1.62425 (QuantReg: 14.08296) QuantErr: 14.08296 batch_time=1.01390 
Train Epoch: 45 codebook_update_time=1.83102
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch45.pth ...
Done in 3.988s
removing stale ckpt [epoch 44] [took 0.03s]
 epoch          : 45
 loss           : 1.5834785842895507
 quant_reg      : 14.157083503723145
 quant_err      : 14.157083503723145
 learning_rate  : 5.23369773616275e-06
 n_samples      : 1440000
 n_steps        : 5625
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 70.22132796780684
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.175050301810865
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.649665817175915
 MSRVTT_full_val/v2t_metrics/R1: 38.6317907444668
 MSRVTT_full_val/v2t_metrics/R5: 79.07444668008048
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.979879275653923
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.47188489295088
 MSRVTT_full_test/t2v_metrics/R1: 13.979933110367893
 MSRVTT_full_test/t2v_metrics/R5: 37.85953177257525
 MSRVTT_full_test/t2v_metrics/R10: 51.070234113712374
 MSRVTT_full_test/t2v_metrics/R50: 81.80602006688963
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.851505016722406
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.011156177125304
 MSRVTT_full_test/v2t_metrics/R1: 18.06020066889632
 MSRVTT_full_test/v2t_metrics/R5: 45.65217391304348
 MSRVTT_full_test/v2t_metrics/R10: 60.50167224080268
 MSRVTT_full_test/v2t_metrics/R50: 87.25752508361204
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.83076923076923
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.81152456937714
 mnt_best       : 30.665155954536573
 not_improved_count: 4
Train Epoch: 46 [1/125 256/32000 (1%)] Loss: 1.62717 (QuantReg: 13.93981) QuantErr: 13.93981 batch_time=43.96713 
Train Epoch: 46 [17/125 4352/32000 (14%)] Loss: 1.65268 (QuantReg: 14.18432) QuantErr: 14.18432 batch_time=0.86894 
Train Epoch: 46 [33/125 8448/32000 (26%)] Loss: 1.33834 (QuantReg: 14.16286) QuantErr: 14.16286 batch_time=0.83477 
Train Epoch: 46 [49/125 12544/32000 (39%)] Loss: 1.46551 (QuantReg: 14.13900) QuantErr: 14.13900 batch_time=0.73915 
Train Epoch: 46 [65/125 16640/32000 (52%)] Loss: 1.55327 (QuantReg: 14.31901) QuantErr: 14.31901 batch_time=2.17389 
Train Epoch: 46 [81/125 20736/32000 (65%)] Loss: 1.55900 (QuantReg: 14.21300) QuantErr: 14.21300 batch_time=0.75388 
Train Epoch: 46 [97/125 24832/32000 (78%)] Loss: 1.53692 (QuantReg: 13.97003) QuantErr: 13.97003 batch_time=0.75911 
Train Epoch: 46 [113/125 28928/32000 (90%)] Loss: 1.52856 (QuantReg: 14.05202) QuantErr: 14.05202 batch_time=0.75581 
Train Epoch: 46 codebook_update_time=1.74077
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch46.pth ...
Done in 4.018s
removing stale ckpt [epoch 45] [took 0.00s]
 epoch          : 46
 loss           : 1.6069182586669921
 quant_reg      : 14.155698822021485
 quant_err      : 14.155698822021485
 learning_rate  : 4.972012849354612e-06
 n_samples      : 1472000
 n_steps        : 5750
 MSRVTT_full_val/t2v_metrics/R1: 32.796780684104625
 MSRVTT_full_val/t2v_metrics/R5: 69.01408450704226
 MSRVTT_full_val/t2v_metrics/R10: 81.48893360160966
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.050301810865191
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 56.923185239135336
 MSRVTT_full_val/v2t_metrics/R1: 38.83299798792756
 MSRVTT_full_val/v2t_metrics/R5: 77.66599597585513
 MSRVTT_full_val/v2t_metrics/R10: 87.92756539235413
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.106639839034205
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.24691739779486
 MSRVTT_full_test/t2v_metrics/R1: 14.381270903010034
 MSRVTT_full_test/t2v_metrics/R5: 38.06020066889632
 MSRVTT_full_test/t2v_metrics/R10: 52.240802675585286
 MSRVTT_full_test/t2v_metrics/R50: 81.20401337792642
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.75351170568562
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.5791958695236
 MSRVTT_full_test/v2t_metrics/R1: 17.25752508361204
 MSRVTT_full_test/v2t_metrics/R5: 45.785953177257525
 MSRVTT_full_test/v2t_metrics/R10: 60.20066889632107
 MSRVTT_full_test/v2t_metrics/R50: 86.98996655518394
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.295652173913044
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.23297797167339
 mnt_best       : 30.665155954536573
 not_improved_count: 5
Train Epoch: 47 [1/125 256/32000 (1%)] Loss: 1.54658 (QuantReg: 14.18345) QuantErr: 14.18345 batch_time=55.17706 
Train Epoch: 47 [17/125 4352/32000 (14%)] Loss: 1.63392 (QuantReg: 13.90294) QuantErr: 13.90294 batch_time=0.75985 
Train Epoch: 47 [33/125 8448/32000 (26%)] Loss: 1.69109 (QuantReg: 14.16017) QuantErr: 14.16017 batch_time=0.73947 
Train Epoch: 47 [49/125 12544/32000 (39%)] Loss: 1.60608 (QuantReg: 14.17882) QuantErr: 14.17882 batch_time=0.90546 
Train Epoch: 47 [65/125 16640/32000 (52%)] Loss: 1.81567 (QuantReg: 14.06987) QuantErr: 14.06987 batch_time=3.67289 
Train Epoch: 47 [81/125 20736/32000 (65%)] Loss: 1.92759 (QuantReg: 14.06039) QuantErr: 14.06039 batch_time=0.75044 
Train Epoch: 47 [97/125 24832/32000 (78%)] Loss: 1.60715 (QuantReg: 14.15408) QuantErr: 14.15408 batch_time=0.74747 
Train Epoch: 47 [113/125 28928/32000 (90%)] Loss: 1.61483 (QuantReg: 14.15844) QuantErr: 14.15844 batch_time=0.74033 
Train Epoch: 47 codebook_update_time=1.63526
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch47.pth ...
Done in 8.904s
Updating 'best' checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch47.pth ...
Done in 12.712s
removing stale ckpt [epoch 46] [took 0.00s]
 epoch          : 47
 loss           : 1.6114614191055299
 quant_reg      : 14.153843254089356
 quant_err      : 14.153843254089356
 learning_rate  : 4.723412206886882e-06
 n_samples      : 1504000
 n_steps        : 5875
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 82.897384305835
 MSRVTT_full_val/t2v_metrics/R50: 98.18913480885311
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 7.804828973843058
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.99286817031051
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 77.06237424547284
 MSRVTT_full_val/v2t_metrics/R10: 88.32997987927565
 MSRVTT_full_val/v2t_metrics/R50: 99.19517102615694
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.010060362173038
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.61799098421113
 MSRVTT_full_test/t2v_metrics/R1: 14.414715719063546
 MSRVTT_full_test/t2v_metrics/R5: 38.62876254180602
 MSRVTT_full_test/t2v_metrics/R10: 51.93979933110368
 MSRVTT_full_test/t2v_metrics/R50: 81.33779264214047
 MSRVTT_full_test/t2v_metrics/MedR: 9.5
 MSRVTT_full_test/t2v_metrics/MeanR: 43.348829431438126
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.695335297436277
 MSRVTT_full_test/v2t_metrics/R1: 17.993311036789297
 MSRVTT_full_test/v2t_metrics/R5: 46.187290969899664
 MSRVTT_full_test/v2t_metrics/R10: 59.93311036789298
 MSRVTT_full_test/v2t_metrics/R50: 86.82274247491638
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.414046822742474
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.79313535980917
 mnt_best       : 30.695335297436277
 not_improved_count: 0
Train Epoch: 48 [1/125 256/32000 (1%)] Loss: 1.65103 (QuantReg: 14.11128) QuantErr: 14.11128 batch_time=50.27807 
Train Epoch: 48 [17/125 4352/32000 (14%)] Loss: 1.36713 (QuantReg: 14.12707) QuantErr: 14.12707 batch_time=0.74766 
Train Epoch: 48 [33/125 8448/32000 (26%)] Loss: 1.56095 (QuantReg: 14.14368) QuantErr: 14.14368 batch_time=0.75360 
Train Epoch: 48 [49/125 12544/32000 (39%)] Loss: 1.48814 (QuantReg: 14.30109) QuantErr: 14.30109 batch_time=0.88227 
Train Epoch: 48 [65/125 16640/32000 (52%)] Loss: 1.62023 (QuantReg: 14.20170) QuantErr: 14.20170 batch_time=7.29659 
Train Epoch: 48 [81/125 20736/32000 (65%)] Loss: 1.56192 (QuantReg: 14.24001) QuantErr: 14.24001 batch_time=0.75884 
Train Epoch: 48 [97/125 24832/32000 (78%)] Loss: 1.64286 (QuantReg: 14.05214) QuantErr: 14.05214 batch_time=0.85610 
Train Epoch: 48 [113/125 28928/32000 (90%)] Loss: 1.73622 (QuantReg: 14.13268) QuantErr: 14.13268 batch_time=0.76346 
Train Epoch: 48 codebook_update_time=1.61371
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch48.pth ...
Done in 13.264s
removing stale ckpt [epoch 47] [took 0.00s]
 epoch          : 48
 loss           : 1.590082127571106
 quant_reg      : 14.181682510375976
 quant_err      : 14.181682510375976
 learning_rate  : 4.487241596542537e-06
 n_samples      : 1536000
 n_steps        : 6000
 MSRVTT_full_val/t2v_metrics/R1: 33.601609657947684
 MSRVTT_full_val/t2v_metrics/R5: 69.41649899396378
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 97.38430583501005
 MSRVTT_full_val/t2v_metrics/MedR: 2.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.028169014084508
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.590865200445364
 MSRVTT_full_val/v2t_metrics/R1: 38.43058350100603
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 86.72032193158954
 MSRVTT_full_val/v2t_metrics/R50: 98.59154929577464
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.140845070422535
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 63.61959477262957
 MSRVTT_full_test/t2v_metrics/R1: 14.347826086956522
 MSRVTT_full_test/t2v_metrics/R5: 37.92642140468227
 MSRVTT_full_test/t2v_metrics/R10: 51.47157190635451
 MSRVTT_full_test/t2v_metrics/R50: 81.37123745819397
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.189632107023414
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.369091532410227
 MSRVTT_full_test/v2t_metrics/R1: 17.45819397993311
 MSRVTT_full_test/v2t_metrics/R5: 46.68896321070234
 MSRVTT_full_test/v2t_metrics/R10: 60.735785953177256
 MSRVTT_full_test/v2t_metrics/R50: 86.88963210702342
 MSRVTT_full_test/v2t_metrics/MedR: 6.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.878929765886287
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.718595999935374
 mnt_best       : 30.695335297436277
 not_improved_count: 1
Train Epoch: 49 [1/125 256/32000 (1%)] Loss: 1.59525 (QuantReg: 14.09017) QuantErr: 14.09017 batch_time=48.32645 
Train Epoch: 49 [17/125 4352/32000 (14%)] Loss: 1.73134 (QuantReg: 14.20741) QuantErr: 14.20741 batch_time=0.94408 
Train Epoch: 49 [33/125 8448/32000 (26%)] Loss: 1.74373 (QuantReg: 14.02402) QuantErr: 14.02402 batch_time=1.06136 
Train Epoch: 49 [49/125 12544/32000 (39%)] Loss: 1.65302 (QuantReg: 14.14522) QuantErr: 14.14522 batch_time=0.93696 
Train Epoch: 49 [65/125 16640/32000 (52%)] Loss: 1.61479 (QuantReg: 14.18296) QuantErr: 14.18296 batch_time=9.40906 
Train Epoch: 49 [81/125 20736/32000 (65%)] Loss: 1.65391 (QuantReg: 14.07969) QuantErr: 14.07969 batch_time=0.75418 
Train Epoch: 49 [97/125 24832/32000 (78%)] Loss: 1.64919 (QuantReg: 14.32917) QuantErr: 14.32917 batch_time=0.75786 
Train Epoch: 49 [113/125 28928/32000 (90%)] Loss: 1.50306 (QuantReg: 14.28861) QuantErr: 14.28861 batch_time=0.90311 
Train Epoch: 49 codebook_update_time=1.69882
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch49.pth ...
Done in 8.736s
removing stale ckpt [epoch 48] [took 0.00s]
 epoch          : 49
 loss           : 1.6102887144088744
 quant_reg      : 14.16691860961914
 quant_err      : 14.16691860961914
 learning_rate  : 4.26287951671541e-06
 n_samples      : 1568000
 n_steps        : 6125
 MSRVTT_full_val/t2v_metrics/R1: 34.40643863179074
 MSRVTT_full_val/t2v_metrics/R5: 70.4225352112676
 MSRVTT_full_val/t2v_metrics/R10: 81.89134808853119
 MSRVTT_full_val/t2v_metrics/R50: 97.98792756539235
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.110663983903422
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 58.32612611848774
 MSRVTT_full_val/v2t_metrics/R1: 39.63782696177062
 MSRVTT_full_val/v2t_metrics/R5: 76.45875251509054
 MSRVTT_full_val/v2t_metrics/R10: 87.72635814889335
 MSRVTT_full_val/v2t_metrics/R50: 98.79275653923541
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 5.9959758551307845
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.30168919928683
 MSRVTT_full_test/t2v_metrics/R1: 14.347826086956522
 MSRVTT_full_test/t2v_metrics/R5: 38.42809364548495
 MSRVTT_full_test/t2v_metrics/R10: 51.33779264214047
 MSRVTT_full_test/t2v_metrics/R50: 81.43812709030101
 MSRVTT_full_test/t2v_metrics/MedR: 10.0
 MSRVTT_full_test/t2v_metrics/MeanR: 43.49397993311037
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.475958855150807
 MSRVTT_full_test/v2t_metrics/R1: 17.892976588628763
 MSRVTT_full_test/v2t_metrics/R5: 46.8561872909699
 MSRVTT_full_test/v2t_metrics/R10: 59.93311036789298
 MSRVTT_full_test/v2t_metrics/R50: 87.19063545150502
 MSRVTT_full_test/v2t_metrics/MedR: 7.0
 MSRVTT_full_test/v2t_metrics/MeanR: 28.744816053511705
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.901055262082664
 mnt_best       : 30.695335297436277
 not_improved_count: 2
Train Epoch: 50 [1/125 256/32000 (1%)] Loss: 1.52522 (QuantReg: 14.28120) QuantErr: 14.28120 batch_time=40.57458 
Train Epoch: 50 [17/125 4352/32000 (14%)] Loss: 1.61059 (QuantReg: 14.17852) QuantErr: 14.17852 batch_time=0.74510 
Train Epoch: 50 [33/125 8448/32000 (26%)] Loss: 1.90520 (QuantReg: 14.25042) QuantErr: 14.25042 batch_time=0.76907 
Train Epoch: 50 [49/125 12544/32000 (39%)] Loss: 1.37503 (QuantReg: 14.32550) QuantErr: 14.32550 batch_time=0.75731 
Train Epoch: 50 [65/125 16640/32000 (52%)] Loss: 1.51499 (QuantReg: 13.98576) QuantErr: 13.98576 batch_time=2.67833 
Train Epoch: 50 [81/125 20736/32000 (65%)] Loss: 1.51213 (QuantReg: 14.21601) QuantErr: 14.21601 batch_time=0.74028 
Train Epoch: 50 [97/125 24832/32000 (78%)] Loss: 1.58610 (QuantReg: 14.08586) QuantErr: 14.08586 batch_time=0.88767 
Train Epoch: 50 [113/125 28928/32000 (90%)] Loss: 1.65601 (QuantReg: 14.33357) QuantErr: 14.33357 batch_time=0.96871 
Train Epoch: 50 codebook_update_time=1.67668
Saving checkpoint: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/checkpoint-epoch50.pth ...
Done in 6.359s
removing stale ckpt [epoch 49] [took 0.01s]
 epoch          : 50
 loss           : 1.5848735876083373
 quant_reg      : 14.215378341674805
 quant_err      : 14.215378341674805
 learning_rate  : 4.04973554087964e-06
 n_samples      : 1600000
 n_steps        : 6250
 MSRVTT_full_val/t2v_metrics/R1: 33.40040241448692
 MSRVTT_full_val/t2v_metrics/R5: 70.02012072434607
 MSRVTT_full_val/t2v_metrics/R10: 81.69014084507042
 MSRVTT_full_val/t2v_metrics/R50: 97.58551307847083
 MSRVTT_full_val/t2v_metrics/MedR: 3.0
 MSRVTT_full_val/t2v_metrics/MeanR: 8.102615694164989
 MSRVTT_full_val/t2v_metrics/geometric_mean_R1-R5-R10: 57.59455138031059
 MSRVTT_full_val/v2t_metrics/R1: 39.436619718309856
 MSRVTT_full_val/v2t_metrics/R5: 77.2635814889336
 MSRVTT_full_val/v2t_metrics/R10: 87.32394366197182
 MSRVTT_full_val/v2t_metrics/R50: 98.99396378269617
 MSRVTT_full_val/v2t_metrics/MedR: 2.0
 MSRVTT_full_val/v2t_metrics/MeanR: 6.094567404426559
 MSRVTT_full_val/v2t_metrics/geometric_mean_R1-R5-R10: 64.31850674236463
 MSRVTT_full_test/t2v_metrics/R1: 14.046822742474916
 MSRVTT_full_test/t2v_metrics/R5: 38.66220735785953
 MSRVTT_full_test/t2v_metrics/R10: 51.67224080267559
 MSRVTT_full_test/t2v_metrics/R50: 81.37123745819397
 MSRVTT_full_test/t2v_metrics/MedR: 9.0
 MSRVTT_full_test/t2v_metrics/MeanR: 44.72207357859532
 MSRVTT_full_test/t2v_metrics/geometric_mean_R1-R5-R10: 30.388365952010435
 MSRVTT_full_test/v2t_metrics/R1: 17.558528428093645
 MSRVTT_full_test/v2t_metrics/R5: 47.324414715719065
 MSRVTT_full_test/v2t_metrics/R10: 60.33444816053512
 MSRVTT_full_test/v2t_metrics/R50: 87.123745819398
 MSRVTT_full_test/v2t_metrics/MedR: 6.0
 MSRVTT_full_test/v2t_metrics/MeanR: 29.56421404682274
 MSRVTT_full_test/v2t_metrics/geometric_mean_R1-R5-R10: 36.8733761605837
 mnt_best       : 30.695335297436277
 not_improved_count: 3
Final evaluation ...
Loading checkpoint from: /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/trained_model.pth ...
Ckpt loaded at epoch 47.
Saved similarity matrix (quantize videos) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/MSRVTT-test-qv-sims.npy
Saved v2t similarity matrix (quantize texts) to /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/MSRVTT-test-qt-sims.npy
MSRVTT_full_test:
 t2v_metrics/R1/final_eval: 14.414715719063546
 t2v_metrics/R5/final_eval: 38.62876254180602
 t2v_metrics/R10/final_eval: 51.93979933110368
 t2v_metrics/R50/final_eval: 81.33779264214047
 t2v_metrics/MedR/final_eval: 9.5
 t2v_metrics/MeanR/final_eval: 43.348829431438126
 t2v_metrics/geometric_mean_R1-R5-R10/final_eval: 30.695335297436277
 v2t_metrics/R1/final_eval: 17.993311036789297
 v2t_metrics/R5/final_eval: 46.187290969899664
 v2t_metrics/R10/final_eval: 59.93311036789298
 v2t_metrics/R50/final_eval: 86.82274247491638
 v2t_metrics/MedR/final_eval: 7.0
 v2t_metrics/MeanR/final_eval: 28.414046822742474
 v2t_metrics/geometric_mean_R1-R5-R10/final_eval: 36.79313535980917
Best epoch for the monitored metric: 47
Script took 04h02m55s
The best performing ckpt can be found at /apdcephfs/share_47076/gimwang/HCQ/exps/HCQ_MSRVTT_full_bs256/trained_model.pth
